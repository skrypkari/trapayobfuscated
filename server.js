'use strict';const a37_0x543838=a37_0x1068;function a37_0x371f(){const _0x29ffda=['❌\x20Scheduled\x20cleanup\x20failed:','🧹\x20Running\x20scheduled\x20payment\x20cleanup...','cleanupStaleProcessingPayments','nodeEnv','__esModule','🔄\x20Initializing\x20currency\x20rates\x20service...','127.1.1.159','listen','./services/paymentCleanupService','10GMNsGO','🕐\x20Payment\x20cleanup\x20scheduled\x20to\x20run\x20every\x20','\x20processed,\x20','__importDefault','failed','❌\x20Initial\x20cleanup\x20failed:','coinToPayStatusService','stopMonitoring','31580LHSHIZ','$disconnect','stopPeriodicStatusCheck','./config/config','default','./config/database','./services/domainMonitoringService','./services/coinToPayStatusService','\x20failed','4258770gsnLqr','🧹\x20Initializing\x20payment\x20cleanup\x20service...','\x20is\x20active','isActive','1333328KOsOEH','SIGINT','\x20hours','getBotInfo','SIGTERM','✅\x20Telegram\x20bot\x20@','$connect','2817EayvBA','log','./services/currencyService','./app','error','⚠️\x20Telegram\x20bot\x20is\x20not\x20configured','stopBot','stopPeriodicUpdates','config','processed','defineProperty','exit','domainMonitoringService','12868970lgiLMj','38656mNfRcR','currencyService','startPeriodicStatusCheck','✅\x20Scheduled\x20cleanup\x20completed:\x20','12NgGPQl','/api/health','1037236nVTmzL','paymentCleanupService','✅\x20Database\x20connected\x20successfully','telegramBotService','4029046pHeXig'];a37_0x371f=function(){return _0x29ffda;};return a37_0x371f();}(function(_0x5139ff,_0x1acc0a){const _0x32ae4f=a37_0x1068,_0x3fc1c9=_0x5139ff();while(!![]){try{const _0x58f431=-parseInt(_0x32ae4f(0x1f1))/0x1+parseInt(_0x32ae4f(0x1fe))/0x2+-parseInt(_0x32ae4f(0x217))/0x3*(-parseInt(_0x32ae4f(0x219))/0x4)+parseInt(_0x32ae4f(0x1e9))/0x5*(parseInt(_0x32ae4f(0x1fa))/0x6)+parseInt(_0x32ae4f(0x1df))/0x7+parseInt(_0x32ae4f(0x213))/0x8*(-parseInt(_0x32ae4f(0x205))/0x9)+-parseInt(_0x32ae4f(0x212))/0xa;if(_0x58f431===_0x1acc0a)break;else _0x3fc1c9['push'](_0x3fc1c9['shift']());}catch(_0x3cd064){_0x3fc1c9['push'](_0x3fc1c9['shift']());}}}(a37_0x371f,0xd3f4f));var __importDefault=this&&this[a37_0x543838(0x1ec)]||function(_0x163f0d){const _0x3bdb9a=a37_0x543838;return _0x163f0d&&_0x163f0d[_0x3bdb9a(0x1e4)]?_0x163f0d:{'default':_0x163f0d};};function a37_0x1068(_0x437b3e,_0x28eeec){const _0x371f2b=a37_0x371f();return a37_0x1068=function(_0x106845,_0x3f77f9){_0x106845=_0x106845-0x1dc;let _0xb2f062=_0x371f2b[_0x106845];return _0xb2f062;},a37_0x1068(_0x437b3e,_0x28eeec);}Object[a37_0x543838(0x20f)](exports,'__esModule',{'value':!![]});const app_1=__importDefault(require(a37_0x543838(0x208))),config_1=require(a37_0x543838(0x1f4)),database_1=__importDefault(require(a37_0x543838(0x1f6))),telegramBotService_1=require('./services/telegramBotService'),currencyService_1=require(a37_0x543838(0x207)),coinToPayStatusService_1=require(a37_0x543838(0x1f8)),domainMonitoringService_1=require(a37_0x543838(0x1f7)),paymentCleanupService_1=require(a37_0x543838(0x1e8));let paymentCleanupInterval=null;function startPaymentCleanupScheduler(){const _0xd2e22a=a37_0x543838,_0x13c6af=0x18,_0x241796=_0x13c6af*0x3c*0x3c*0x3e8;console[_0xd2e22a(0x206)](_0xd2e22a(0x1ea)+_0x13c6af+_0xd2e22a(0x200)),setTimeout(async()=>{const _0x355ab9=_0xd2e22a;console[_0x355ab9(0x206)]('🧹\x20Running\x20initial\x20payment\x20cleanup...');try{const _0x331178=await paymentCleanupService_1[_0x355ab9(0x1dc)][_0x355ab9(0x1e2)]();console[_0x355ab9(0x206)]('✅\x20Initial\x20cleanup\x20completed:\x20'+_0x331178[_0x355ab9(0x20e)]+_0x355ab9(0x1eb)+_0x331178[_0x355ab9(0x1ed)]+_0x355ab9(0x1f9));}catch(_0xaf05cb){console[_0x355ab9(0x209)](_0x355ab9(0x1ee),_0xaf05cb);}},0x5*0x3c*0x3e8),paymentCleanupInterval=setInterval(async()=>{const _0x5d843f=_0xd2e22a;console[_0x5d843f(0x206)](_0x5d843f(0x1e1));try{const _0x22c5de=await paymentCleanupService_1[_0x5d843f(0x1dc)]['cleanupStaleProcessingPayments']();console[_0x5d843f(0x206)](_0x5d843f(0x216)+_0x22c5de['processed']+'\x20processed,\x20'+_0x22c5de[_0x5d843f(0x1ed)]+_0x5d843f(0x1f9));}catch(_0x402980){console[_0x5d843f(0x209)](_0x5d843f(0x1e0),_0x402980);}},_0x241796);}function stopPaymentCleanupScheduler(){paymentCleanupInterval&&(clearInterval(paymentCleanupInterval),paymentCleanupInterval=null,console['log']('🛑\x20Payment\x20cleanup\x20scheduler\x20stopped'));}async function startServer(){const _0x4e9bb3=a37_0x543838;try{await database_1['default'][_0x4e9bb3(0x204)](),console[_0x4e9bb3(0x206)](_0x4e9bb3(0x1dd));const _0x235f2a=telegramBotService_1[_0x4e9bb3(0x1de)][_0x4e9bb3(0x201)]();_0x235f2a[_0x4e9bb3(0x1fd)]?console['log'](_0x4e9bb3(0x203)+_0x235f2a['username']+_0x4e9bb3(0x1fc)):console[_0x4e9bb3(0x206)](_0x4e9bb3(0x20a)),console[_0x4e9bb3(0x206)](_0x4e9bb3(0x1e5)),console['log']('🪙\x20Initializing\x20CoinToPay\x20status\x20checking\x20service...'),coinToPayStatusService_1[_0x4e9bb3(0x1ef)][_0x4e9bb3(0x215)](),console[_0x4e9bb3(0x206)]('🔍\x20Initializing\x20domain\x20monitoring\x20service...'),domainMonitoringService_1[_0x4e9bb3(0x211)]['startMonitoring'](),console[_0x4e9bb3(0x206)](_0x4e9bb3(0x1fb)),startPaymentCleanupScheduler(),app_1['default'][_0x4e9bb3(0x1e7)](config_1[_0x4e9bb3(0x20d)]['port'],_0x4e9bb3(0x1e6),()=>{const _0x4986c9=_0x4e9bb3;console[_0x4986c9(0x206)]('🚀\x20Server\x20running\x20on\x20port\x20'+config_1[_0x4986c9(0x20d)]['port']),console['log']('🌍\x20Environment:\x20'+config_1[_0x4986c9(0x20d)][_0x4986c9(0x1e3)]),console[_0x4986c9(0x206)]('📊\x20Health\x20check:\x20http://localhost:'+config_1[_0x4986c9(0x20d)]['port']+_0x4986c9(0x218));});}catch(_0xf486f7){console[_0x4e9bb3(0x209)]('❌\x20Failed\x20to\x20start\x20server:',_0xf486f7),process[_0x4e9bb3(0x210)](0x1);}}process['on'](a37_0x543838(0x1ff),async()=>{const _0x21589b=a37_0x543838;console['log']('\x0a🔄\x20Gracefully\x20shutting\x20down...'),stopPaymentCleanupScheduler(),currencyService_1['currencyService'][_0x21589b(0x20c)](),coinToPayStatusService_1[_0x21589b(0x1ef)]['stopPeriodicStatusCheck'](),domainMonitoringService_1[_0x21589b(0x211)]['stopMonitoring'](),telegramBotService_1['telegramBotService'][_0x21589b(0x20b)](),await database_1['default'][_0x21589b(0x1f2)](),process[_0x21589b(0x210)](0x0);}),process['on'](a37_0x543838(0x202),async()=>{const _0x46ad93=a37_0x543838;console['log']('\x0a🔄\x20Gracefully\x20shutting\x20down...'),stopPaymentCleanupScheduler(),currencyService_1[_0x46ad93(0x214)][_0x46ad93(0x20c)](),coinToPayStatusService_1[_0x46ad93(0x1ef)][_0x46ad93(0x1f3)](),domainMonitoringService_1[_0x46ad93(0x211)][_0x46ad93(0x1f0)](),telegramBotService_1[_0x46ad93(0x1de)][_0x46ad93(0x20b)](),await database_1[_0x46ad93(0x1f5)][_0x46ad93(0x1f2)](),process['exit'](0x0);}),startServer();