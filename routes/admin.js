'use strict';const a19_0x1de1fc=a19_0x21cb;(function(_0x551eea,_0x85811f){const _0x5b2778=a19_0x21cb,_0x58ee50=_0x551eea();while(!![]){try{const _0x2449bd=-parseInt(_0x5b2778(0xae))/0x1*(parseInt(_0x5b2778(0xa9))/0x2)+-parseInt(_0x5b2778(0xbb))/0x3*(-parseInt(_0x5b2778(0x87))/0x4)+-parseInt(_0x5b2778(0x8f))/0x5*(-parseInt(_0x5b2778(0xc3))/0x6)+parseInt(_0x5b2778(0xa1))/0x7*(-parseInt(_0x5b2778(0xe0))/0x8)+parseInt(_0x5b2778(0x7a))/0x9*(parseInt(_0x5b2778(0x86))/0xa)+parseInt(_0x5b2778(0x7e))/0xb*(-parseInt(_0x5b2778(0xb6))/0xc)+parseInt(_0x5b2778(0xcc))/0xd*(-parseInt(_0x5b2778(0xc2))/0xe);if(_0x2449bd===_0x85811f)break;else _0x58ee50['push'](_0x58ee50['shift']());}catch(_0x2d8094){_0x58ee50['push'](_0x58ee50['shift']());}}}(a19_0x2e0a,0x93190));function a19_0x21cb(_0x4267b0,_0xc9a706){const _0x2e0aec=a19_0x2e0a();return a19_0x21cb=function(_0x21cbb7,_0x93c3f){_0x21cbb7=_0x21cbb7-0x79;let _0x5d4552=_0x2e0aec[_0x21cbb7];return _0x5d4552;},a19_0x21cb(_0x4267b0,_0xc9a706);}var __createBinding=this&&this[a19_0x1de1fc(0xc5)]||(Object[a19_0x1de1fc(0x8b)]?function(_0x49b437,_0x2625c7,_0x9c58a9,_0xb1151d){const _0x58c2cf=a19_0x1de1fc;if(_0xb1151d===undefined)_0xb1151d=_0x9c58a9;var _0x14817d=Object['getOwnPropertyDescriptor'](_0x2625c7,_0x9c58a9);(!_0x14817d||(_0x58c2cf(0x7d)in _0x14817d?!_0x2625c7[_0x58c2cf(0xe1)]:_0x14817d[_0x58c2cf(0xdd)]||_0x14817d[_0x58c2cf(0xe6)]))&&(_0x14817d={'enumerable':!![],'get':function(){return _0x2625c7[_0x9c58a9];}}),Object[_0x58c2cf(0x9e)](_0x49b437,_0xb1151d,_0x14817d);}:function(_0x4777bd,_0x50d411,_0x2cf8b3,_0x5e2643){if(_0x5e2643===undefined)_0x5e2643=_0x2cf8b3;_0x4777bd[_0x5e2643]=_0x50d411[_0x2cf8b3];}),__setModuleDefault=this&&this[a19_0x1de1fc(0xdc)]||(Object[a19_0x1de1fc(0x8b)]?function(_0x3f97f8,_0x5f5526){const _0x41b722=a19_0x1de1fc;Object[_0x41b722(0x9e)](_0x3f97f8,'default',{'enumerable':!![],'value':_0x5f5526});}:function(_0x1c4092,_0x3171f8){_0x1c4092['default']=_0x3171f8;}),__importStar=this&&this[a19_0x1de1fc(0xba)]||(function(){var _0x250117=function(_0x4e30b9){const _0x3f0560=a19_0x21cb;return _0x250117=Object[_0x3f0560(0xd6)]||function(_0x22450e){const _0x48df9d=_0x3f0560;var _0x3e763d=[];for(var _0x2280e9 in _0x22450e)if(Object['prototype'][_0x48df9d(0xe9)][_0x48df9d(0xf0)](_0x22450e,_0x2280e9))_0x3e763d[_0x3e763d[_0x48df9d(0xc4)]]=_0x2280e9;return _0x3e763d;},_0x250117(_0x4e30b9);};return function(_0x36acb9){const _0x1488c4=a19_0x21cb;if(_0x36acb9&&_0x36acb9['__esModule'])return _0x36acb9;var _0x23d1f2={};if(_0x36acb9!=null){for(var _0x1b71d5=_0x250117(_0x36acb9),_0x4882ad=0x0;_0x4882ad<_0x1b71d5[_0x1488c4(0xc4)];_0x4882ad++)if(_0x1b71d5[_0x4882ad]!==_0x1488c4(0x93))__createBinding(_0x23d1f2,_0x36acb9,_0x1b71d5[_0x4882ad]);}return __setModuleDefault(_0x23d1f2,_0x36acb9),_0x23d1f2;};}());Object[a19_0x1de1fc(0x9e)](exports,a19_0x1de1fc(0xe1),{'value':!![]});const express_1=require('express'),adminController_1=require(a19_0x1de1fc(0x81)),validation_1=require(a19_0x1de1fc(0xe2)),auth_1=require(a19_0x1de1fc(0xe8)),loggerService_1=require(a19_0x1de1fc(0x9a)),coinToPayStatusService_1=require(a19_0x1de1fc(0xcd)),domainMonitoringService_1=require(a19_0x1de1fc(0xea)),router=(0x0,express_1[a19_0x1de1fc(0x79)])(),adminController=new adminController_1[(a19_0x1de1fc(0x8a))]();function a19_0x2e0a(){const _0x179a69=['gatewayPaymentId','payment','domainMonitoringService','65698TBDuOa','requireAdmin','/logs/clean','findUnique','message','21IENOue','coinToPayStatusService','/merchants/selection','\x20days)','EXPIRED','post','getPayoutStats','getPayments','49668mCBIHA','createPayoutSchema','\x20days\x20if\x20not\x20paid','put','__importStar','3QNRaNH','/users','/statistics','createPayout','/payments/:id','getPayoutById','getUsers','1582adhzrK','3560682eVKAip','length','__createBinding','../config/database','params','PENDING','/payout/stats','activateUser','Server\x20crashes\x20if\x20domain\x20is\x20not\x20responding\x20after\x20consecutive\x20failures','7553taRrOe','../services/coinToPayStatusService','deleteUser','updateUser','checkAuth','/domain-monitoring/check','expiryDays','/auth','updatePayment','json','getOwnPropertyNames','Failed\x20to\x20get\x20CoinToPay\x20service\x20statistics','updateUserSchema','createdAt','delete','toISOString','__setModuleDefault','writable','Old\x20logs\x20cleaned\x20(kept\x20last\x20','/domain-monitoring/stats','9808qFkcsH','__esModule','../middleware/validation','loggerService','suspendUser','Domain\x20is\x20responding\x20correctly','configurable','Failed\x20to\x20get\x20payment\x20information','../middleware/auth','hasOwnProperty','../services/domainMonitoringService','body','Failed\x20to\x20get\x20domain\x20monitoring\x20statistics','Each\x20new\x20payment\x20gets\x20individual\x20timers:\x201min,\x202min,\x207min,\x2012min,\x20then\x20hourly','now','updatedAt','call','/cointopay/payment/:paymentId','cointopay','/users/:id','Router','963veBXXZ','❌\x20[ADMIN]\x20Manual\x20CoinToPay\x20check\x20failed\x20for\x20payment\x20','/logs/stats','get','759VENntJ','getUserById','/payouts','../controllers/adminController','createUserSchema','gateway','shop','checkPaymentById','87690JqYIfA','3894932urrVdF','validate','Failed\x20to\x20get\x20log\x20statistics','AdminController','create','updateCustomerData','/users/:id/activate','Payments\x20automatically\x20expire\x20after\x20','5zbpekE','getTime','/users/:id/suspend','floor','default','Domain\x20check\x20failed','/payout','getServiceStats','Payment\x20not\x20found','Domain\x20monitoring\x20service\x20for\x20amaterasy884.icu','getMonitoringStats','../services/loggerService','paymentId','/payments','/payouts/:id','defineProperty','status','updateCustomerDataSchema','4921aGTMUu','error','manualCheck','🔍\x20[ADMIN]\x20Manual\x20CoinToPay\x20check\x20requested\x20for\x20payment:\x20','currency'];a19_0x2e0a=function(){return _0x179a69;};return a19_0x2e0a();}router['use'](auth_1['authenticateToken'],auth_1[a19_0x1de1fc(0xaa)]),router['get'](a19_0x1de1fc(0xd3),adminController[a19_0x1de1fc(0xd0)]),router[a19_0x1de1fc(0x7d)](a19_0x1de1fc(0xbd),adminController['getStatistics']),router[a19_0x1de1fc(0x7d)]('/merchant-statistics',adminController['getMerchantStatistics']),router[a19_0x1de1fc(0x7d)](a19_0x1de1fc(0xc9),adminController[a19_0x1de1fc(0xb4)]),router[a19_0x1de1fc(0x7d)]('/payout/merchants',adminController['getMerchantsAwaitingPayout']),router['get'](a19_0x1de1fc(0xb0),adminController['getMerchantsSelection']),router[a19_0x1de1fc(0xb3)](a19_0x1de1fc(0x95),(0x0,validation_1[a19_0x1de1fc(0x88)])(validation_1[a19_0x1de1fc(0xb7)]),adminController[a19_0x1de1fc(0xbe)]),router[a19_0x1de1fc(0x7d)](a19_0x1de1fc(0x80),adminController['getPayouts']),router[a19_0x1de1fc(0x7d)](a19_0x1de1fc(0x9d),adminController[a19_0x1de1fc(0xc0)]),router[a19_0x1de1fc(0xda)](a19_0x1de1fc(0x9d),adminController['deletePayout']),router['get'](a19_0x1de1fc(0x9c),adminController[a19_0x1de1fc(0xb5)]),router[a19_0x1de1fc(0x7d)](a19_0x1de1fc(0xbf),adminController['getPaymentById']),router[a19_0x1de1fc(0xb9)](a19_0x1de1fc(0xbf),adminController[a19_0x1de1fc(0xd4)]),router[a19_0x1de1fc(0xb9)]('/payments/:id/customer',(0x0,validation_1['validate'])(validation_1[a19_0x1de1fc(0xa0)]),adminController[a19_0x1de1fc(0x8c)]),router[a19_0x1de1fc(0x7d)]('/users',adminController[a19_0x1de1fc(0xc1)]),router[a19_0x1de1fc(0x7d)](a19_0x1de1fc(0xf3),adminController[a19_0x1de1fc(0x7f)]),router[a19_0x1de1fc(0xb3)](a19_0x1de1fc(0xbc),(0x0,validation_1[a19_0x1de1fc(0x88)])(validation_1[a19_0x1de1fc(0x82)]),adminController['createUser']),router[a19_0x1de1fc(0xb9)]('/users/:id',(0x0,validation_1[a19_0x1de1fc(0x88)])(validation_1[a19_0x1de1fc(0xd8)]),adminController[a19_0x1de1fc(0xcf)]),router[a19_0x1de1fc(0xda)]('/users/:id',adminController[a19_0x1de1fc(0xce)]),router[a19_0x1de1fc(0xb3)](a19_0x1de1fc(0x91),adminController[a19_0x1de1fc(0xe4)]),router[a19_0x1de1fc(0xb3)](a19_0x1de1fc(0x8d),adminController[a19_0x1de1fc(0xca)]),router[a19_0x1de1fc(0x7d)](a19_0x1de1fc(0x7c),(_0x126dfe,_0x57305f)=>{const _0x15d0db=a19_0x1de1fc;try{const _0x647a90=loggerService_1['loggerService']['getLogStats']();_0x57305f['json']({'success':!![],'result':_0x647a90});}catch(_0x1f029d){_0x57305f[_0x15d0db(0x9f)](0x1f4)['json']({'success':![],'message':_0x15d0db(0x89)});}}),router['post'](a19_0x1de1fc(0xab),(_0x228e9d,_0x170be5)=>{const _0xa34d34=a19_0x1de1fc;try{const {daysToKeep:daysToKeep=0x1e}=_0x228e9d[_0xa34d34(0xeb)];loggerService_1[_0xa34d34(0xe3)]['cleanOldLogs'](daysToKeep),_0x170be5[_0xa34d34(0xd5)]({'success':!![],'message':_0xa34d34(0xde)+daysToKeep+_0xa34d34(0xb1)});}catch(_0x52e63f){_0x170be5['status'](0x1f4)['json']({'success':![],'message':'Failed\x20to\x20clean\x20old\x20logs'});}}),router[a19_0x1de1fc(0xb3)]('/cointopay/check/:paymentId',async(_0x58092f,_0x474694)=>{const _0x4db0e1=a19_0x1de1fc;try{const {paymentId:_0x3e7268}=_0x58092f[_0x4db0e1(0xc7)];console['log'](_0x4db0e1(0xa4)+_0x3e7268),await coinToPayStatusService_1[_0x4db0e1(0xaf)][_0x4db0e1(0x85)](_0x3e7268),_0x474694[_0x4db0e1(0xd5)]({'success':!![],'message':'CoinToPay\x20payment\x20status\x20checked\x20successfully'});}catch(_0x8ab4aa){console[_0x4db0e1(0xa2)](_0x4db0e1(0x7b)+_0x58092f[_0x4db0e1(0xc7)][_0x4db0e1(0x9b)]+':',_0x8ab4aa),_0x474694[_0x4db0e1(0x9f)](0x1f4)[_0x4db0e1(0xd5)]({'success':![],'message':_0x8ab4aa instanceof Error?_0x8ab4aa[_0x4db0e1(0xad)]:'Failed\x20to\x20check\x20CoinToPay\x20payment\x20status'});}}),router['get']('/cointopay/stats',(_0x5132c8,_0x65a0d1)=>{const _0x512f76=a19_0x1de1fc;try{const _0x4f2e2d=coinToPayStatusService_1[_0x512f76(0xaf)][_0x512f76(0x96)]();_0x65a0d1['json']({'success':!![],'result':{..._0x4f2e2d,'description':'CoinToPay\x20automatic\x20status\x20checking\x20service','statusMapping':{'Paid':'PAID','Awaiting\x20Fiat':_0x512f76(0xc8),'waiting':_0x512f76(0xc8),'expired':_0x512f76(0xb2),'failed':'FAILED'},'autoExpiryNote':_0x512f76(0x8e)+_0x4f2e2d[_0x512f76(0xd2)]+_0x512f76(0xb8),'individualTimersNote':_0x512f76(0xed)}});}catch(_0x123942){_0x65a0d1[_0x512f76(0x9f)](0x1f4)[_0x512f76(0xd5)]({'success':![],'message':_0x512f76(0xd7)});}}),router[a19_0x1de1fc(0x7d)](a19_0x1de1fc(0xf1),async(_0x202d1a,_0x5b440b)=>{const _0x231633=a19_0x1de1fc;try{const {paymentId:_0x556ba4}=_0x202d1a[_0x231633(0xc7)],_0x1dda5f=coinToPayStatusService_1['coinToPayStatusService']['getPaymentTimerInfo'](_0x556ba4),_0x59c3ad=(await Promise['resolve']()['then'](()=>__importStar(require(_0x231633(0xc6)))))[_0x231633(0x93)],_0x13a027=await _0x59c3ad[_0x231633(0xa7)][_0x231633(0xac)]({'where':{'id':_0x556ba4},'select':{'id':!![],'gateway':!![],'gatewayPaymentId':!![],'status':!![],'amount':!![],'currency':!![],'createdAt':!![],'updatedAt':!![],'shopId':!![],'shop':{'select':{'name':!![],'username':!![]}}}});if(!_0x13a027)return _0x5b440b[_0x231633(0x9f)](0x194)[_0x231633(0xd5)]({'success':![],'message':_0x231633(0x97)});_0x5b440b[_0x231633(0xd5)]({'success':!![],'result':{'payment':{'id':_0x13a027['id'],'gateway':_0x13a027[_0x231633(0x83)],'gatewayPaymentId':_0x13a027[_0x231633(0xa6)],'status':_0x13a027[_0x231633(0x9f)],'amount':_0x13a027['amount'],'currency':_0x13a027[_0x231633(0xa5)],'createdAt':_0x13a027[_0x231633(0xd9)],'updatedAt':_0x13a027[_0x231633(0xef)],'shop':_0x13a027[_0x231633(0x84)]},'timers':_0x1dda5f,'isCoinToPay':_0x13a027['gateway']===_0x231633(0xf2),'ageInMinutes':Math[_0x231633(0x92)]((Date[_0x231633(0xee)]()-_0x13a027[_0x231633(0xd9)][_0x231633(0x90)]())/(0x3e8*0x3c))}});}catch(_0x2a9fac){_0x5b440b[_0x231633(0x9f)](0x1f4)[_0x231633(0xd5)]({'success':![],'message':_0x2a9fac instanceof Error?_0x2a9fac[_0x231633(0xad)]:_0x231633(0xe7)});}}),router['get'](a19_0x1de1fc(0xdf),(_0x32d118,_0x4ac1f1)=>{const _0x43b478=a19_0x1de1fc;try{const _0x24f93a=domainMonitoringService_1[_0x43b478(0xa8)][_0x43b478(0x99)]();_0x4ac1f1[_0x43b478(0xd5)]({'success':!![],'result':{..._0x24f93a,'description':_0x43b478(0x98),'behavior':_0x43b478(0xcb),'encoding':'Requests\x20are\x20made\x20with\x20base64\x20encoded\x20URLs'}});}catch(_0xe857a4){_0x4ac1f1[_0x43b478(0x9f)](0x1f4)[_0x43b478(0xd5)]({'success':![],'message':_0x43b478(0xec)});}}),router['post'](a19_0x1de1fc(0xd1),async(_0x172673,_0x47209a)=>{const _0x447d88=a19_0x1de1fc;try{const _0x49063b=await domainMonitoringService_1[_0x447d88(0xa8)][_0x447d88(0xa3)]();_0x47209a['json']({'success':!![],'result':{'domainAvailable':_0x49063b,'message':_0x49063b?_0x447d88(0xe5):_0x447d88(0x94),'timestamp':new Date()[_0x447d88(0xdb)]()}});}catch(_0x15ffa2){_0x47209a['status'](0x1f4)[_0x447d88(0xd5)]({'success':![],'message':_0x15ffa2 instanceof Error?_0x15ffa2['message']:'Failed\x20to\x20perform\x20manual\x20domain\x20check'});}}),exports['default']=router;