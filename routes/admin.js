'use strict';const a25_0x218942=a25_0x2b14;(function(_0x351d47,_0x282a0f){const _0x195943=a25_0x2b14,_0x2a0aa0=_0x351d47();while(!![]){try{const _0x52e3ea=parseInt(_0x195943(0x18b))/0x1+-parseInt(_0x195943(0x1eb))/0x2+parseInt(_0x195943(0x180))/0x3*(parseInt(_0x195943(0x1b3))/0x4)+-parseInt(_0x195943(0x196))/0x5*(parseInt(_0x195943(0x1ad))/0x6)+-parseInt(_0x195943(0x189))/0x7+-parseInt(_0x195943(0x1d8))/0x8*(-parseInt(_0x195943(0x1a6))/0x9)+parseInt(_0x195943(0x1a1))/0xa*(parseInt(_0x195943(0x1d0))/0xb);if(_0x52e3ea===_0x282a0f)break;else _0x2a0aa0['push'](_0x2a0aa0['shift']());}catch(_0x1f041e){_0x2a0aa0['push'](_0x2a0aa0['shift']());}}}(a25_0x21db,0x4f912));function a25_0x2b14(_0x138af3,_0x39d2d7){_0x138af3=_0x138af3-0x16b;const _0x21db36=a25_0x21db();let _0x2b1486=_0x21db36[_0x138af3];return _0x2b1486;}var __createBinding=this&&this['__createBinding']||(Object[a25_0x218942(0x171)]?function(_0x2e0d0b,_0x32c024,_0x1e4377,_0x38b57a){const _0x91cc60=a25_0x218942;if(_0x38b57a===undefined)_0x38b57a=_0x1e4377;var _0x4e5370=Object[_0x91cc60(0x193)](_0x32c024,_0x1e4377);(!_0x4e5370||(_0x91cc60(0x1bc)in _0x4e5370?!_0x32c024[_0x91cc60(0x1e3)]:_0x4e5370[_0x91cc60(0x1db)]||_0x4e5370[_0x91cc60(0x1c9)]))&&(_0x4e5370={'enumerable':!![],'get':function(){return _0x32c024[_0x1e4377];}}),Object['defineProperty'](_0x2e0d0b,_0x38b57a,_0x4e5370);}:function(_0x1dffdc,_0x3da881,_0x43c34b,_0x38c7c1){if(_0x38c7c1===undefined)_0x38c7c1=_0x43c34b;_0x1dffdc[_0x38c7c1]=_0x3da881[_0x43c34b];}),__setModuleDefault=this&&this['__setModuleDefault']||(Object['create']?function(_0x3e1f7c,_0x22abdc){const _0x2994dd=a25_0x218942;Object['defineProperty'](_0x3e1f7c,_0x2994dd(0x1b0),{'enumerable':!![],'value':_0x22abdc});}:function(_0x29388e,_0x13add8){_0x29388e['default']=_0x13add8;}),__importStar=this&&this[a25_0x218942(0x1a8)]||(function(){var _0x3a7373=function(_0x540ca2){const _0x416c22=a25_0x2b14;return _0x3a7373=Object[_0x416c22(0x1c5)]||function(_0x39357c){const _0x1b0aed=_0x416c22;var _0x3d44c2=[];for(var _0x195b68 in _0x39357c)if(Object['prototype'][_0x1b0aed(0x1d5)][_0x1b0aed(0x19e)](_0x39357c,_0x195b68))_0x3d44c2[_0x3d44c2[_0x1b0aed(0x1aa)]]=_0x195b68;return _0x3d44c2;},_0x3a7373(_0x540ca2);};return function(_0x57fb0f){const _0x457fc8=a25_0x2b14;if(_0x57fb0f&&_0x57fb0f['__esModule'])return _0x57fb0f;var _0x389991={};if(_0x57fb0f!=null){for(var _0x215267=_0x3a7373(_0x57fb0f),_0x388d13=0x0;_0x388d13<_0x215267['length'];_0x388d13++)if(_0x215267[_0x388d13]!==_0x457fc8(0x1b0))__createBinding(_0x389991,_0x57fb0f,_0x215267[_0x388d13]);}return __setModuleDefault(_0x389991,_0x57fb0f),_0x389991;};}());function a25_0x21db(){const _0x481d13=['/statistics','cleanupStalePayments','domainMonitoringService','../config/database','resolve','Failed\x20to\x20clean\x20old\x20logs','Failed\x20to\x20perform\x20manual\x20domain\x20check','getOwnPropertyDescriptor','\x20days)','/users/:id/suspend','140ZdvFSt','../services/loggerService','activateUser','updateCustomerDataSchema','updatePayment','/logs/clean','/users/:id/activate','getMerchantsSelection','call','getLogStats','Payment\x20not\x20found','318770aGozzV','updatedAt','/payments','/payments/cleanup-with-report','/payments/:id','99PdqrCt','/shops/:shopId/2fa/setup','__importStar','use','length','params','getMerchantStatistics','31494MTFSdv','Failed\x20to\x20get\x20log\x20statistics','validate','default','deleteUser','error','107596PVYshB','getPayments','getShopWallets','CoinToPay\x20payment\x20status\x20checked\x20successfully','updateUser','/auth','/shops/:shopId/2fa/disable','../middleware/auth','then','get','getUserById','FAILED','Server\x20crashes\x20if\x20domain\x20is\x20not\x20responding\x20after\x20consecutive\x20failures','payment','gateway','getProcessingPaymentsStats','/payout/:id','authenticateToken','getOwnPropertyNames','getPayoutById','delete','âŒ\x20[ADMIN]\x20Manual\x20CoinToPay\x20check\x20failed\x20for\x20payment\x20','configurable','disable2FA','getMonitoringStats','/domain-monitoring/stats','createUserSchema','body','/merchant-statistics','209jiBnYk','now','/payouts/:id','getServiceStats','Requests\x20are\x20made\x20with\x20base64\x20encoded\x20URLs','hasOwnProperty','cleanOldLogs','/cointopay/stats','238808SznYnu','log','cointopay','writable','PAID','post','createUser','createdAt','floor','updatePayoutSchema','json','__esModule','checkPaymentById','updateCustomerData','getUsers','express','/users/:id','put','deletePayout','1090860QaCpUZ','expiryDays','createPayout','cleanupStalePendingPayments','requireAdmin','Failed\x20to\x20get\x20payment\x20information','/payments/processing-stats','/shops/:shopId/wallets','getPayoutStats','status','/merchants/selection','paymentId','getPaymentTimerInfo','create','amount','message','/logs/stats','Router','suspendUser','ðŸ”\x20[ADMIN]\x20Manual\x20CoinToPay\x20check\x20requested\x20for\x20payment:\x20','\x20days\x20if\x20not\x20paid','../services/domainMonitoringService','defineProperty','getPaymentById','Failed\x20to\x20check\x20CoinToPay\x20payment\x20status','cleanupStalePaymentsWithReport','findUnique','/users','15SoqAuv','enable2FA','getMerchantsAwaitingPayout','/payout/merchants','CoinToPay\x20automatic\x20status\x20checking\x20service','PENDING','gatewayPaymentId','currency','coinToPayStatusService','2008713lVxuyj','/cointopay/payment/:paymentId','236748ACDsQz'];a25_0x21db=function(){return _0x481d13;};return a25_0x21db();}Object[a25_0x218942(0x17a)](exports,a25_0x218942(0x1e3),{'value':!![]});const express_1=require(a25_0x218942(0x1e7)),adminController_1=require('../controllers/adminController'),validation_1=require('../middleware/validation'),auth_1=require(a25_0x218942(0x1ba)),loggerService_1=require(a25_0x218942(0x197)),coinToPayStatusService_1=require('../services/coinToPayStatusService'),domainMonitoringService_1=require(a25_0x218942(0x179)),router=(0x0,express_1[a25_0x218942(0x175)])(),adminController=new adminController_1['AdminController']();router[a25_0x218942(0x1a9)](auth_1[a25_0x218942(0x1c4)],auth_1[a25_0x218942(0x1ef)]),router[a25_0x218942(0x1bc)](a25_0x218942(0x1b8),adminController['checkAuth']),router[a25_0x218942(0x1bc)](a25_0x218942(0x18c),adminController['getStatistics']),router['get'](a25_0x218942(0x1cf),adminController[a25_0x218942(0x1ac)]),router['get']('/payout/stats',adminController[a25_0x218942(0x16c)]),router['get'](a25_0x218942(0x183),adminController[a25_0x218942(0x182)]),router['get'](a25_0x218942(0x16e),adminController[a25_0x218942(0x19d)]),router[a25_0x218942(0x1dd)]('/payout',(0x0,validation_1[a25_0x218942(0x1af)])(validation_1['createPayoutSchema']),adminController[a25_0x218942(0x1ed)]),router[a25_0x218942(0x1e9)](a25_0x218942(0x1c3),(0x0,validation_1[a25_0x218942(0x1af)])(validation_1[a25_0x218942(0x1e1)]),adminController['updatePayout']),router[a25_0x218942(0x1bc)]('/payouts',adminController['getPayouts']),router[a25_0x218942(0x1bc)](a25_0x218942(0x1d2),adminController[a25_0x218942(0x1c6)]),router['delete'](a25_0x218942(0x1d2),adminController[a25_0x218942(0x1ea)]),router[a25_0x218942(0x1bc)](a25_0x218942(0x1a3),adminController[a25_0x218942(0x1b4)]),router[a25_0x218942(0x1bc)](a25_0x218942(0x1a5),adminController[a25_0x218942(0x17b)]),router[a25_0x218942(0x1e9)](a25_0x218942(0x1a5),adminController[a25_0x218942(0x19a)]),router[a25_0x218942(0x1e9)]('/payments/:id/customer',(0x0,validation_1[a25_0x218942(0x1af)])(validation_1[a25_0x218942(0x199)]),adminController[a25_0x218942(0x1e5)]),router[a25_0x218942(0x1bc)](a25_0x218942(0x1f1),adminController[a25_0x218942(0x1c2)]),router[a25_0x218942(0x1dd)]('/payments/cleanup',adminController[a25_0x218942(0x18d)]),router[a25_0x218942(0x1dd)]('/payments/cleanup-pending',adminController[a25_0x218942(0x1ee)]),router['post'](a25_0x218942(0x1a4),adminController[a25_0x218942(0x17d)]),router[a25_0x218942(0x1dd)]('/payment-links/expire',adminController['expirePaymentLinks']),router[a25_0x218942(0x1bc)](a25_0x218942(0x17f),adminController[a25_0x218942(0x1e6)]),router[a25_0x218942(0x1bc)]('/users/:id',adminController[a25_0x218942(0x1bd)]),router[a25_0x218942(0x1dd)]('/users',(0x0,validation_1[a25_0x218942(0x1af)])(validation_1[a25_0x218942(0x1cd)]),adminController[a25_0x218942(0x1de)]),router[a25_0x218942(0x1e9)](a25_0x218942(0x1e8),(0x0,validation_1[a25_0x218942(0x1af)])(validation_1['updateUserSchema']),adminController[a25_0x218942(0x1b7)]),router[a25_0x218942(0x1c7)]('/users/:id',adminController[a25_0x218942(0x1b1)]),router['get'](a25_0x218942(0x16b),adminController[a25_0x218942(0x1b5)]),router['post'](a25_0x218942(0x1a7),adminController['setup2FA']),router['post']('/shops/:shopId/2fa/enable',adminController[a25_0x218942(0x181)]),router['post'](a25_0x218942(0x1b9),adminController[a25_0x218942(0x1ca)]),router[a25_0x218942(0x1dd)](a25_0x218942(0x195),adminController[a25_0x218942(0x176)]),router[a25_0x218942(0x1dd)](a25_0x218942(0x19c),adminController[a25_0x218942(0x198)]),router[a25_0x218942(0x1bc)](a25_0x218942(0x174),(_0x5e258b,_0x39817a)=>{const _0x265b52=a25_0x218942;try{const _0x3d70f7=loggerService_1['loggerService'][_0x265b52(0x19f)]();_0x39817a[_0x265b52(0x1e2)]({'success':!![],'result':_0x3d70f7});}catch(_0x509c97){_0x39817a[_0x265b52(0x16d)](0x1f4)[_0x265b52(0x1e2)]({'success':![],'message':_0x265b52(0x1ae)});}}),router[a25_0x218942(0x1dd)](a25_0x218942(0x19b),(_0x396d27,_0x2eb7cd)=>{const _0x5281c1=a25_0x218942;try{const {daysToKeep:daysToKeep=0x1e}=_0x396d27[_0x5281c1(0x1ce)];loggerService_1['loggerService'][_0x5281c1(0x1d6)](daysToKeep),_0x2eb7cd[_0x5281c1(0x1e2)]({'success':!![],'message':'Old\x20logs\x20cleaned\x20(kept\x20last\x20'+daysToKeep+_0x5281c1(0x194)});}catch(_0x10ea42){_0x2eb7cd['status'](0x1f4)[_0x5281c1(0x1e2)]({'success':![],'message':_0x5281c1(0x191)});}}),router['post']('/cointopay/check/:paymentId',async(_0x156e71,_0x47ec80)=>{const _0x175ab4=a25_0x218942;try{const {paymentId:_0x22ae6c}=_0x156e71[_0x175ab4(0x1ab)];console[_0x175ab4(0x1d9)](_0x175ab4(0x177)+_0x22ae6c),await coinToPayStatusService_1[_0x175ab4(0x188)][_0x175ab4(0x1e4)](_0x22ae6c),_0x47ec80[_0x175ab4(0x1e2)]({'success':!![],'message':_0x175ab4(0x1b6)});}catch(_0x2ef2f8){console[_0x175ab4(0x1b2)](_0x175ab4(0x1c8)+_0x156e71['params'][_0x175ab4(0x16f)]+':',_0x2ef2f8),_0x47ec80[_0x175ab4(0x16d)](0x1f4)['json']({'success':![],'message':_0x2ef2f8 instanceof Error?_0x2ef2f8['message']:_0x175ab4(0x17c)});}}),router[a25_0x218942(0x1bc)](a25_0x218942(0x1d7),(_0x452c9f,_0x16abf6)=>{const _0x31b9aa=a25_0x218942;try{const _0x37be76=coinToPayStatusService_1[_0x31b9aa(0x188)][_0x31b9aa(0x1d3)]();_0x16abf6['json']({'success':!![],'result':{..._0x37be76,'description':_0x31b9aa(0x184),'statusMapping':{'Paid':_0x31b9aa(0x1dc),'Awaiting\x20Fiat':_0x31b9aa(0x185),'waiting':_0x31b9aa(0x185),'expired':'EXPIRED','failed':_0x31b9aa(0x1be)},'autoExpiryNote':'Payments\x20automatically\x20expire\x20after\x20'+_0x37be76[_0x31b9aa(0x1ec)]+_0x31b9aa(0x178),'individualTimersNote':'Each\x20new\x20payment\x20gets\x20individual\x20timers:\x201min,\x202min,\x207min,\x2012min,\x20then\x20hourly'}});}catch(_0x3703a7){_0x16abf6[_0x31b9aa(0x16d)](0x1f4)['json']({'success':![],'message':'Failed\x20to\x20get\x20CoinToPay\x20service\x20statistics'});}}),router[a25_0x218942(0x1bc)](a25_0x218942(0x18a),async(_0xf8f180,_0x334eb7)=>{const _0x5aead1=a25_0x218942;try{const {paymentId:_0x2c7c92}=_0xf8f180['params'],_0x4153c7=coinToPayStatusService_1[_0x5aead1(0x188)][_0x5aead1(0x170)](_0x2c7c92),_0x1e72bc=(await Promise[_0x5aead1(0x190)]()[_0x5aead1(0x1bb)](()=>__importStar(require(_0x5aead1(0x18f)))))[_0x5aead1(0x1b0)],_0x326394=await _0x1e72bc[_0x5aead1(0x1c0)][_0x5aead1(0x17e)]({'where':{'id':_0x2c7c92},'select':{'id':!![],'gateway':!![],'gatewayPaymentId':!![],'status':!![],'amount':!![],'currency':!![],'createdAt':!![],'updatedAt':!![],'shopId':!![],'shop':{'select':{'name':!![],'username':!![]}}}});if(!_0x326394)return _0x334eb7[_0x5aead1(0x16d)](0x194)[_0x5aead1(0x1e2)]({'success':![],'message':_0x5aead1(0x1a0)});_0x334eb7[_0x5aead1(0x1e2)]({'success':!![],'result':{'payment':{'id':_0x326394['id'],'gateway':_0x326394[_0x5aead1(0x1c1)],'gatewayPaymentId':_0x326394[_0x5aead1(0x186)],'status':_0x326394[_0x5aead1(0x16d)],'amount':_0x326394[_0x5aead1(0x172)],'currency':_0x326394[_0x5aead1(0x187)],'createdAt':_0x326394['createdAt'],'updatedAt':_0x326394[_0x5aead1(0x1a2)],'shop':_0x326394['shop']},'timers':_0x4153c7,'isCoinToPay':_0x326394[_0x5aead1(0x1c1)]===_0x5aead1(0x1da),'ageInMinutes':Math[_0x5aead1(0x1e0)]((Date[_0x5aead1(0x1d1)]()-_0x326394[_0x5aead1(0x1df)]['getTime']())/(0x3e8*0x3c))}});}catch(_0xef563d){_0x334eb7[_0x5aead1(0x16d)](0x1f4)[_0x5aead1(0x1e2)]({'success':![],'message':_0xef563d instanceof Error?_0xef563d['message']:_0x5aead1(0x1f0)});}}),router[a25_0x218942(0x1bc)](a25_0x218942(0x1cc),(_0x440e32,_0x12a5ea)=>{const _0x3823d0=a25_0x218942;try{const _0x54a1ec=domainMonitoringService_1[_0x3823d0(0x18e)][_0x3823d0(0x1cb)]();_0x12a5ea['json']({'success':!![],'result':{..._0x54a1ec,'description':'Domain\x20monitoring\x20service\x20for\x20amaterasy884.icu','behavior':_0x3823d0(0x1bf),'encoding':_0x3823d0(0x1d4)}});}catch(_0x4e4c35){_0x12a5ea['status'](0x1f4)[_0x3823d0(0x1e2)]({'success':![],'message':'Failed\x20to\x20get\x20domain\x20monitoring\x20statistics'});}}),router[a25_0x218942(0x1dd)]('/domain-monitoring/check',async(_0x12fc36,_0x555407)=>{const _0x5a9608=a25_0x218942;try{const _0x41b646=await domainMonitoringService_1['domainMonitoringService']['manualCheck']();_0x555407[_0x5a9608(0x1e2)]({'success':!![],'result':{'domainAvailable':_0x41b646,'message':_0x41b646?'Domain\x20is\x20responding\x20correctly':'Domain\x20check\x20failed','timestamp':new Date()['toISOString']()}});}catch(_0x2f99b7){_0x555407['status'](0x1f4)[_0x5a9608(0x1e2)]({'success':![],'message':_0x2f99b7 instanceof Error?_0x2f99b7[_0x5a9608(0x173)]:_0x5a9608(0x192)});}}),exports['default']=router;