'use strict';function a19_0x3025(){const _0x2bbcaa=['create','Each\x20new\x20payment\x20gets\x20individual\x20timers:\x201min,\x202min,\x207min,\x2012min,\x20then\x20hourly','../config/database','findUnique','/logs/stats','/payout/stats','coinToPayStatusService','createUserSchema','/payments/:id/customer','getPayoutStats','\x20days\x20if\x20not\x20paid','1750490cuROPF','createUser','post','cleanOldLogs','FAILED','getOwnPropertyNames','1534540yABliC','defineProperty','expiryDays','/auth','getPaymentTimerInfo','getMonitoringStats','getPayoutById','error','call','hasOwnProperty','gateway','__importStar','Server\x20crashes\x20if\x20domain\x20is\x20not\x20responding\x20after\x20consecutive\x20failures','json','createPayoutSchema','/payments','Payments\x20automatically\x20expire\x20after\x20','getLogStats','‚ùå\x20[ADMIN]\x20Manual\x20CoinToPay\x20check\x20failed\x20for\x20payment\x20','/cointopay/check/:paymentId','/merchants/selection','Router','112115TsxPLz','checkAuth','log','/payouts','toISOString','validate','__createBinding','Failed\x20to\x20check\x20CoinToPay\x20payment\x20status','../services/loggerService','/payout','default','../controllers/adminController','\x20days)','status','/payouts/:id','1254549pfqqiQ','domainMonitoringService','get','manualCheck','1001456oUlsWG','updateCustomerData','../services/coinToPayStatusService','2728452HnoLUE','floor','getUserById','now','gatewayPaymentId','paymentId','Payment\x20not\x20found','getMerchantsAwaitingPayout','authenticateToken','/users/:id','/domain-monitoring/check','payment','PENDING','9SEfLiR','/statistics','CoinToPay\x20automatic\x20status\x20checking\x20service','/payout/merchants','params','loggerService','Domain\x20monitoring\x20service\x20for\x20amaterasy884.icu','getMerchantStatistics','createPayout','deletePayout','PAID','delete','getPaymentById','activateUser','updateCustomerDataSchema','/users/:id/suspend','prototype','Failed\x20to\x20get\x20domain\x20monitoring\x20statistics','message','requireAdmin','Failed\x20to\x20get\x20payment\x20information','Failed\x20to\x20get\x20CoinToPay\x20service\x20statistics','express','__esModule','/payments/:id','cointopay','then','Requests\x20are\x20made\x20with\x20base64\x20encoded\x20URLs','/users','Failed\x20to\x20clean\x20old\x20logs','getMerchantsSelection','15716urGNfv','checkPaymentById','currency','body','updatePayment','EXPIRED','deleteUser','updateUserSchema','createdAt','2JKJARN','put','length'];a19_0x3025=function(){return _0x2bbcaa;};return a19_0x3025();}const a19_0x5726be=a19_0x3f78;(function(_0x53e9a8,_0xfeaab4){const _0x2799c6=a19_0x3f78,_0xb7f005=_0x53e9a8();while(!![]){try{const _0x4e69c6=parseInt(_0x2799c6(0x13c))/0x1+-parseInt(_0x2799c6(0x145))/0x2*(parseInt(_0x2799c6(0x109))/0x3)+parseInt(_0x2799c6(0xe4))/0x4+-parseInt(_0x2799c6(0xfa))/0x5+parseInt(_0x2799c6(0x110))/0x6+parseInt(_0x2799c6(0xde))/0x7+parseInt(_0x2799c6(0x10d))/0x8*(-parseInt(_0x2799c6(0x11d))/0x9);if(_0x4e69c6===_0xfeaab4)break;else _0xb7f005['push'](_0xb7f005['shift']());}catch(_0x486946){_0xb7f005['push'](_0xb7f005['shift']());}}}(a19_0x3025,0x83707));var __createBinding=this&&this[a19_0x5726be(0x100)]||(Object[a19_0x5726be(0x148)]?function(_0x4c81e7,_0x5806de,_0x47befc,_0x307dde){const _0x1586a0=a19_0x5726be;if(_0x307dde===undefined)_0x307dde=_0x47befc;var _0x18ed02=Object['getOwnPropertyDescriptor'](_0x5806de,_0x47befc);(!_0x18ed02||(_0x1586a0(0x10b)in _0x18ed02?!_0x5806de[_0x1586a0(0x134)]:_0x18ed02['writable']||_0x18ed02['configurable']))&&(_0x18ed02={'enumerable':!![],'get':function(){return _0x5806de[_0x47befc];}}),Object['defineProperty'](_0x4c81e7,_0x307dde,_0x18ed02);}:function(_0x307307,_0x2b6072,_0x48b985,_0x28cbc0){if(_0x28cbc0===undefined)_0x28cbc0=_0x48b985;_0x307307[_0x28cbc0]=_0x2b6072[_0x48b985];}),__setModuleDefault=this&&this['__setModuleDefault']||(Object[a19_0x5726be(0x148)]?function(_0x52aa63,_0x22e092){const _0x4d5c95=a19_0x5726be;Object[_0x4d5c95(0xe5)](_0x52aa63,_0x4d5c95(0x104),{'enumerable':!![],'value':_0x22e092});}:function(_0x3cb117,_0x4ea934){const _0x59bdda=a19_0x5726be;_0x3cb117[_0x59bdda(0x104)]=_0x4ea934;}),__importStar=this&&this[a19_0x5726be(0xef)]||(function(){var _0x6a674c=function(_0x57d226){const _0x1ddb79=a19_0x3f78;return _0x6a674c=Object[_0x1ddb79(0xe3)]||function(_0x560b95){const _0x573100=_0x1ddb79;var _0x528922=[];for(var _0x1d8f28 in _0x560b95)if(Object[_0x573100(0x12d)][_0x573100(0xed)][_0x573100(0xec)](_0x560b95,_0x1d8f28))_0x528922[_0x528922[_0x573100(0x147)]]=_0x1d8f28;return _0x528922;},_0x6a674c(_0x57d226);};return function(_0x438e05){const _0x169362=a19_0x3f78;if(_0x438e05&&_0x438e05['__esModule'])return _0x438e05;var _0x4ecd0e={};if(_0x438e05!=null){for(var _0x1be3b3=_0x6a674c(_0x438e05),_0x4401cf=0x0;_0x4401cf<_0x1be3b3[_0x169362(0x147)];_0x4401cf++)if(_0x1be3b3[_0x4401cf]!==_0x169362(0x104))__createBinding(_0x4ecd0e,_0x438e05,_0x1be3b3[_0x4401cf]);}return __setModuleDefault(_0x4ecd0e,_0x438e05),_0x4ecd0e;};}());Object['defineProperty'](exports,a19_0x5726be(0x134),{'value':!![]});function a19_0x3f78(_0x12bc0e,_0x17fc2d){const _0x302534=a19_0x3025();return a19_0x3f78=function(_0x3f78e4,_0x1bcc1d){_0x3f78e4=_0x3f78e4-0xd6;let _0x34ef92=_0x302534[_0x3f78e4];return _0x34ef92;},a19_0x3f78(_0x12bc0e,_0x17fc2d);}const express_1=require(a19_0x5726be(0x133)),adminController_1=require(a19_0x5726be(0x105)),validation_1=require('../middleware/validation'),auth_1=require('../middleware/auth'),loggerService_1=require(a19_0x5726be(0x102)),coinToPayStatusService_1=require(a19_0x5726be(0x10f)),domainMonitoringService_1=require('../services/domainMonitoringService'),router=(0x0,express_1[a19_0x5726be(0xf9)])(),adminController=new adminController_1['AdminController']();router['use'](auth_1[a19_0x5726be(0x118)],auth_1[a19_0x5726be(0x130)]),router['get'](a19_0x5726be(0xe7),adminController[a19_0x5726be(0xfb)]),router[a19_0x5726be(0x10b)](a19_0x5726be(0x11e),adminController['getStatistics']),router['get']('/merchant-statistics',adminController[a19_0x5726be(0x124)]),router[a19_0x5726be(0x10b)](a19_0x5726be(0xd8),adminController[a19_0x5726be(0xdc)]),router[a19_0x5726be(0x10b)](a19_0x5726be(0x120),adminController[a19_0x5726be(0x117)]),router[a19_0x5726be(0x10b)](a19_0x5726be(0xf8),adminController[a19_0x5726be(0x13b)]),router[a19_0x5726be(0xe0)](a19_0x5726be(0x103),(0x0,validation_1['validate'])(validation_1[a19_0x5726be(0xf2)]),adminController[a19_0x5726be(0x125)]),router[a19_0x5726be(0x10b)](a19_0x5726be(0xfd),adminController['getPayouts']),router[a19_0x5726be(0x10b)](a19_0x5726be(0x108),adminController[a19_0x5726be(0xea)]),router[a19_0x5726be(0x128)](a19_0x5726be(0x108),adminController[a19_0x5726be(0x126)]),router[a19_0x5726be(0x10b)](a19_0x5726be(0xf3),adminController['getPayments']),router[a19_0x5726be(0x10b)](a19_0x5726be(0x135),adminController[a19_0x5726be(0x129)]),router[a19_0x5726be(0x146)](a19_0x5726be(0x135),adminController[a19_0x5726be(0x140)]),router[a19_0x5726be(0x146)](a19_0x5726be(0xdb),(0x0,validation_1['validate'])(validation_1[a19_0x5726be(0x12b)]),adminController[a19_0x5726be(0x10e)]),router[a19_0x5726be(0x10b)](a19_0x5726be(0x139),adminController['getUsers']),router['get'](a19_0x5726be(0x119),adminController[a19_0x5726be(0x112)]),router['post'](a19_0x5726be(0x139),(0x0,validation_1[a19_0x5726be(0xff)])(validation_1[a19_0x5726be(0xda)]),adminController[a19_0x5726be(0xdf)]),router[a19_0x5726be(0x146)]('/users/:id',(0x0,validation_1['validate'])(validation_1[a19_0x5726be(0x143)]),adminController['updateUser']),router[a19_0x5726be(0x128)](a19_0x5726be(0x119),adminController[a19_0x5726be(0x142)]),router[a19_0x5726be(0xe0)](a19_0x5726be(0x12c),adminController['suspendUser']),router[a19_0x5726be(0xe0)]('/users/:id/activate',adminController[a19_0x5726be(0x12a)]),router[a19_0x5726be(0x10b)](a19_0x5726be(0xd7),(_0x915be6,_0x403498)=>{const _0x53d951=a19_0x5726be;try{const _0x595b5a=loggerService_1[_0x53d951(0x122)][_0x53d951(0xf5)]();_0x403498[_0x53d951(0xf1)]({'success':!![],'result':_0x595b5a});}catch(_0x140ea7){_0x403498['status'](0x1f4)[_0x53d951(0xf1)]({'success':![],'message':'Failed\x20to\x20get\x20log\x20statistics'});}}),router[a19_0x5726be(0xe0)]('/logs/clean',(_0xb9e1b1,_0x17c0d6)=>{const _0x3074c6=a19_0x5726be;try{const {daysToKeep:daysToKeep=0x1e}=_0xb9e1b1[_0x3074c6(0x13f)];loggerService_1[_0x3074c6(0x122)][_0x3074c6(0xe1)](daysToKeep),_0x17c0d6['json']({'success':!![],'message':'Old\x20logs\x20cleaned\x20(kept\x20last\x20'+daysToKeep+_0x3074c6(0x106)});}catch(_0x5a7f1b){_0x17c0d6[_0x3074c6(0x107)](0x1f4)[_0x3074c6(0xf1)]({'success':![],'message':_0x3074c6(0x13a)});}}),router[a19_0x5726be(0xe0)](a19_0x5726be(0xf7),async(_0x33265a,_0x61b57c)=>{const _0x4cbc79=a19_0x5726be;try{const {paymentId:_0x340bd0}=_0x33265a['params'];console[_0x4cbc79(0xfc)]('üîç\x20[ADMIN]\x20Manual\x20CoinToPay\x20check\x20requested\x20for\x20payment:\x20'+_0x340bd0),await coinToPayStatusService_1['coinToPayStatusService'][_0x4cbc79(0x13d)](_0x340bd0),_0x61b57c[_0x4cbc79(0xf1)]({'success':!![],'message':'CoinToPay\x20payment\x20status\x20checked\x20successfully'});}catch(_0x461069){console[_0x4cbc79(0xeb)](_0x4cbc79(0xf6)+_0x33265a[_0x4cbc79(0x121)][_0x4cbc79(0x115)]+':',_0x461069),_0x61b57c[_0x4cbc79(0x107)](0x1f4)[_0x4cbc79(0xf1)]({'success':![],'message':_0x461069 instanceof Error?_0x461069[_0x4cbc79(0x12f)]:_0x4cbc79(0x101)});}}),router[a19_0x5726be(0x10b)]('/cointopay/stats',(_0x5d491e,_0xc3ef55)=>{const _0x39f2f1=a19_0x5726be;try{const _0x5deb43=coinToPayStatusService_1[_0x39f2f1(0xd9)]['getServiceStats']();_0xc3ef55['json']({'success':!![],'result':{..._0x5deb43,'description':_0x39f2f1(0x11f),'statusMapping':{'Paid':_0x39f2f1(0x127),'Awaiting\x20Fiat':_0x39f2f1(0x11c),'waiting':_0x39f2f1(0x11c),'expired':_0x39f2f1(0x141),'failed':_0x39f2f1(0xe2)},'autoExpiryNote':_0x39f2f1(0xf4)+_0x5deb43[_0x39f2f1(0xe6)]+_0x39f2f1(0xdd),'individualTimersNote':_0x39f2f1(0x149)}});}catch(_0x4ca1f1){_0xc3ef55[_0x39f2f1(0x107)](0x1f4)[_0x39f2f1(0xf1)]({'success':![],'message':_0x39f2f1(0x132)});}}),router[a19_0x5726be(0x10b)]('/cointopay/payment/:paymentId',async(_0x2736c6,_0x192d9b)=>{const _0x2ddc23=a19_0x5726be;try{const {paymentId:_0x48173a}=_0x2736c6[_0x2ddc23(0x121)],_0x10caed=coinToPayStatusService_1[_0x2ddc23(0xd9)][_0x2ddc23(0xe8)](_0x48173a),_0x5295ee=(await Promise['resolve']()[_0x2ddc23(0x137)](()=>__importStar(require(_0x2ddc23(0x14a)))))[_0x2ddc23(0x104)],_0x151920=await _0x5295ee[_0x2ddc23(0x11b)][_0x2ddc23(0xd6)]({'where':{'id':_0x48173a},'select':{'id':!![],'gateway':!![],'gatewayPaymentId':!![],'status':!![],'amount':!![],'currency':!![],'createdAt':!![],'updatedAt':!![],'shopId':!![],'shop':{'select':{'name':!![],'username':!![]}}}});if(!_0x151920)return _0x192d9b[_0x2ddc23(0x107)](0x194)[_0x2ddc23(0xf1)]({'success':![],'message':_0x2ddc23(0x116)});_0x192d9b[_0x2ddc23(0xf1)]({'success':!![],'result':{'payment':{'id':_0x151920['id'],'gateway':_0x151920[_0x2ddc23(0xee)],'gatewayPaymentId':_0x151920[_0x2ddc23(0x114)],'status':_0x151920[_0x2ddc23(0x107)],'amount':_0x151920['amount'],'currency':_0x151920[_0x2ddc23(0x13e)],'createdAt':_0x151920[_0x2ddc23(0x144)],'updatedAt':_0x151920['updatedAt'],'shop':_0x151920['shop']},'timers':_0x10caed,'isCoinToPay':_0x151920[_0x2ddc23(0xee)]===_0x2ddc23(0x136),'ageInMinutes':Math[_0x2ddc23(0x111)]((Date[_0x2ddc23(0x113)]()-_0x151920[_0x2ddc23(0x144)]['getTime']())/(0x3e8*0x3c))}});}catch(_0x3c8747){_0x192d9b[_0x2ddc23(0x107)](0x1f4)[_0x2ddc23(0xf1)]({'success':![],'message':_0x3c8747 instanceof Error?_0x3c8747[_0x2ddc23(0x12f)]:_0x2ddc23(0x131)});}}),router[a19_0x5726be(0x10b)]('/domain-monitoring/stats',(_0x307cc4,_0x5cc511)=>{const _0xe71c6d=a19_0x5726be;try{const _0x22dcff=domainMonitoringService_1[_0xe71c6d(0x10a)][_0xe71c6d(0xe9)]();_0x5cc511['json']({'success':!![],'result':{..._0x22dcff,'description':_0xe71c6d(0x123),'behavior':_0xe71c6d(0xf0),'encoding':_0xe71c6d(0x138)}});}catch(_0x434cb5){_0x5cc511[_0xe71c6d(0x107)](0x1f4)[_0xe71c6d(0xf1)]({'success':![],'message':_0xe71c6d(0x12e)});}}),router[a19_0x5726be(0xe0)](a19_0x5726be(0x11a),async(_0x2a7f16,_0x287276)=>{const _0xdbf42e=a19_0x5726be;try{const _0x38846d=await domainMonitoringService_1[_0xdbf42e(0x10a)][_0xdbf42e(0x10c)]();_0x287276['json']({'success':!![],'result':{'domainAvailable':_0x38846d,'message':_0x38846d?'Domain\x20is\x20responding\x20correctly':'Domain\x20check\x20failed','timestamp':new Date()[_0xdbf42e(0xfe)]()}});}catch(_0xd32cae){_0x287276['status'](0x1f4)[_0xdbf42e(0xf1)]({'success':![],'message':_0xd32cae instanceof Error?_0xd32cae[_0xdbf42e(0x12f)]:'Failed\x20to\x20perform\x20manual\x20domain\x20check'});}}),exports[a19_0x5726be(0x104)]=router;