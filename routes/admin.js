'use strict';const a19_0xdcc3c3=a19_0x6480;(function(_0x4b4054,_0x5c1ca8){const _0x1591d7=a19_0x6480,_0x26a48c=_0x4b4054();while(!![]){try{const _0x2ca711=-parseInt(_0x1591d7(0xc2))/0x1*(parseInt(_0x1591d7(0x117))/0x2)+parseInt(_0x1591d7(0xfb))/0x3+parseInt(_0x1591d7(0x10c))/0x4+-parseInt(_0x1591d7(0x115))/0x5+-parseInt(_0x1591d7(0xcc))/0x6+parseInt(_0x1591d7(0x148))/0x7+-parseInt(_0x1591d7(0x116))/0x8*(parseInt(_0x1591d7(0xd1))/0x9);if(_0x2ca711===_0x5c1ca8)break;else _0x26a48c['push'](_0x26a48c['shift']());}catch(_0x4c8da6){_0x26a48c['push'](_0x26a48c['shift']());}}}(a19_0x29f3,0xbce38));function a19_0x6480(_0x11193d,_0x219295){const _0x29f322=a19_0x29f3();return a19_0x6480=function(_0x6480a2,_0x5e19f1){_0x6480a2=_0x6480a2-0xc1;let _0x450472=_0x29f322[_0x6480a2];return _0x450472;},a19_0x6480(_0x11193d,_0x219295);}var __createBinding=this&&this[a19_0xdcc3c3(0xd2)]||(Object['create']?function(_0x5628ce,_0x574129,_0x1d49c9,_0x2d4ec2){const _0x48aa63=a19_0xdcc3c3;if(_0x2d4ec2===undefined)_0x2d4ec2=_0x1d49c9;var _0x1dbe98=Object['getOwnPropertyDescriptor'](_0x574129,_0x1d49c9);(!_0x1dbe98||(_0x48aa63(0xfa)in _0x1dbe98?!_0x574129[_0x48aa63(0x118)]:_0x1dbe98['writable']||_0x1dbe98['configurable']))&&(_0x1dbe98={'enumerable':!![],'get':function(){return _0x574129[_0x1d49c9];}}),Object[_0x48aa63(0x13a)](_0x5628ce,_0x2d4ec2,_0x1dbe98);}:function(_0x5c23a8,_0x8ee8f5,_0x41a8bf,_0x17072e){if(_0x17072e===undefined)_0x17072e=_0x41a8bf;_0x5c23a8[_0x17072e]=_0x8ee8f5[_0x41a8bf];}),__setModuleDefault=this&&this[a19_0xdcc3c3(0x141)]||(Object['create']?function(_0x1ec90e,_0x2c77ed){const _0x4e8f32=a19_0xdcc3c3;Object[_0x4e8f32(0x13a)](_0x1ec90e,'default',{'enumerable':!![],'value':_0x2c77ed});}:function(_0x2e102f,_0x4e5256){_0x2e102f['default']=_0x4e5256;}),__importStar=this&&this[a19_0xdcc3c3(0x126)]||(function(){var _0x27603d=function(_0x10f2b6){const _0x378e70=a19_0x6480;return _0x27603d=Object[_0x378e70(0x11c)]||function(_0x52bda6){const _0x58a73b=_0x378e70;var _0x511f5e=[];for(var _0x192539 in _0x52bda6)if(Object[_0x58a73b(0xda)][_0x58a73b(0x149)][_0x58a73b(0x10d)](_0x52bda6,_0x192539))_0x511f5e[_0x511f5e[_0x58a73b(0x105)]]=_0x192539;return _0x511f5e;},_0x27603d(_0x10f2b6);};return function(_0x953780){const _0x357016=a19_0x6480;if(_0x953780&&_0x953780['__esModule'])return _0x953780;var _0x2fb9b0={};if(_0x953780!=null){for(var _0x96d926=_0x27603d(_0x953780),_0x35c541=0x0;_0x35c541<_0x96d926[_0x357016(0x105)];_0x35c541++)if(_0x96d926[_0x35c541]!==_0x357016(0xc7))__createBinding(_0x2fb9b0,_0x953780,_0x96d926[_0x35c541]);}return __setModuleDefault(_0x2fb9b0,_0x953780),_0x2fb9b0;};}()),__importDefault=this&&this[a19_0xdcc3c3(0x136)]||function(_0x4ecb67){return _0x4ecb67&&_0x4ecb67['__esModule']?_0x4ecb67:{'default':_0x4ecb67};};Object['defineProperty'](exports,a19_0xdcc3c3(0x118),{'value':!![]});const express_1=require('express'),adminController_1=require(a19_0xdcc3c3(0xee)),validation_1=require('../middleware/validation'),auth_1=require('../middleware/auth'),loggerService_1=require(a19_0xdcc3c3(0xfd)),coinToPayStatusService_1=require('../services/coinToPayStatusService'),rapydStatusService_1=require(a19_0xdcc3c3(0x12f)),domainMonitoringService_1=require(a19_0xdcc3c3(0xc5)),database_1=__importDefault(require(a19_0xdcc3c3(0x145))),router=(0x0,express_1['Router'])(),adminController=new adminController_1[(a19_0xdcc3c3(0xf4))]();router['use'](auth_1[a19_0xdcc3c3(0xe2)],auth_1[a19_0xdcc3c3(0xef)]),router[a19_0xdcc3c3(0xfa)](a19_0xdcc3c3(0x108),adminController['checkAuth']),router['get'](a19_0xdcc3c3(0x119),adminController[a19_0xdcc3c3(0x130)]),router['get']('/merchant-statistics',adminController['getMerchantStatistics']),router[a19_0xdcc3c3(0xfa)](a19_0xdcc3c3(0xe7),adminController[a19_0xdcc3c3(0x13d)]),router[a19_0xdcc3c3(0xfa)](a19_0xdcc3c3(0xc9),adminController[a19_0xdcc3c3(0xd5)]),router[a19_0xdcc3c3(0xfa)]('/payout/merchants',adminController[a19_0xdcc3c3(0x134)]),router[a19_0xdcc3c3(0xed)](a19_0xdcc3c3(0x106),(0x0,validation_1[a19_0xdcc3c3(0xe1)])(validation_1[a19_0xdcc3c3(0xd6)]),adminController[a19_0xdcc3c3(0xf1)]),router['get'](a19_0xdcc3c3(0x12c),adminController[a19_0xdcc3c3(0xe3)]),router[a19_0xdcc3c3(0xfa)](a19_0xdcc3c3(0x102),adminController[a19_0xdcc3c3(0x128)]),router[a19_0xdcc3c3(0x138)](a19_0xdcc3c3(0x102),adminController['deletePayout']),router[a19_0xdcc3c3(0xfa)](a19_0xdcc3c3(0x135),(0x0,validation_1['validateQuery'])(validation_1[a19_0xdcc3c3(0x110)]),adminController[a19_0xdcc3c3(0x11e)]),router[a19_0xdcc3c3(0xfa)](a19_0xdcc3c3(0xec),adminController[a19_0xdcc3c3(0xe9)]),router[a19_0xdcc3c3(0x14a)](a19_0xdcc3c3(0xec),adminController[a19_0xdcc3c3(0xce)]),router[a19_0xdcc3c3(0x14a)]('/payments/:id/customer',(0x0,validation_1[a19_0xdcc3c3(0xe1)])(validation_1[a19_0xdcc3c3(0x103)]),adminController[a19_0xdcc3c3(0xd7)]),router[a19_0xdcc3c3(0xfa)](a19_0xdcc3c3(0x139),adminController[a19_0xdcc3c3(0xe8)]),router['get'](a19_0xdcc3c3(0xcd),adminController['getUserById']),router['post'](a19_0xdcc3c3(0x139),(0x0,validation_1[a19_0xdcc3c3(0xe1)])(validation_1[a19_0xdcc3c3(0x112)]),adminController[a19_0xdcc3c3(0xdc)]),router[a19_0xdcc3c3(0x14a)]('/users/:id',(0x0,validation_1['validate'])(validation_1[a19_0xdcc3c3(0x143)]),adminController[a19_0xdcc3c3(0x12e)]),router['delete']('/users/:id',adminController[a19_0xdcc3c3(0x133)]),router[a19_0xdcc3c3(0xed)](a19_0xdcc3c3(0x122),adminController[a19_0xdcc3c3(0x113)]),router[a19_0xdcc3c3(0xed)](a19_0xdcc3c3(0xf0),adminController[a19_0xdcc3c3(0xd4)]),router['get']('/logs/stats',(_0x593ce0,_0x32049a)=>{const _0x509513=a19_0xdcc3c3;try{const _0x53675f=loggerService_1[_0x509513(0x14b)][_0x509513(0xf5)]();_0x32049a[_0x509513(0xe0)]({'success':!![],'result':_0x53675f});}catch(_0x30d5dd){_0x32049a[_0x509513(0x10a)](0x1f4)[_0x509513(0xe0)]({'success':![],'message':_0x509513(0x101)});}}),router[a19_0xdcc3c3(0xed)](a19_0xdcc3c3(0xea),(_0x112ebb,_0x5a5509)=>{const _0xb569b0=a19_0xdcc3c3;try{const {daysToKeep:daysToKeep=0x1e}=_0x112ebb[_0xb569b0(0x109)];loggerService_1[_0xb569b0(0x14b)]['cleanOldLogs'](daysToKeep),_0x5a5509[_0xb569b0(0xe0)]({'success':!![],'message':_0xb569b0(0xc3)+daysToKeep+_0xb569b0(0xf2)});}catch(_0x4daf41){_0x5a5509[_0xb569b0(0x10a)](0x1f4)[_0xb569b0(0xe0)]({'success':![],'message':'Failed\x20to\x20clean\x20old\x20logs'});}}),router[a19_0xdcc3c3(0xed)]('/cointopay/check/:paymentId',async(_0x279e81,_0x3baf4a)=>{const _0x16b180=a19_0xdcc3c3;try{const {paymentId:_0x534d6c}=_0x279e81[_0x16b180(0xd0)];console[_0x16b180(0xdd)](_0x16b180(0x13e)+_0x534d6c),await coinToPayStatusService_1[_0x16b180(0x129)][_0x16b180(0x123)](_0x534d6c),_0x3baf4a[_0x16b180(0xe0)]({'success':!![],'message':_0x16b180(0x11f)});}catch(_0x324973){console[_0x16b180(0x11d)](_0x16b180(0x104)+_0x279e81[_0x16b180(0xd0)]['paymentId']+':',_0x324973),_0x3baf4a[_0x16b180(0x10a)](0x1f4)[_0x16b180(0xe0)]({'success':![],'message':_0x324973 instanceof Error?_0x324973['message']:'Failed\x20to\x20check\x20CoinToPay\x20payment\x20status'});}}),router['get'](a19_0xdcc3c3(0xcb),(_0x214f6d,_0xa060)=>{const _0x165f6a=a19_0xdcc3c3;try{const _0x59eb3a=coinToPayStatusService_1[_0x165f6a(0x129)][_0x165f6a(0xdf)]();_0xa060[_0x165f6a(0xe0)]({'success':!![],'result':{..._0x59eb3a,'description':_0x165f6a(0x144),'statusMapping':{'Paid':_0x165f6a(0xfe),'Awaiting\x20Fiat':'PENDING','waiting':'PENDING','expired':_0x165f6a(0x12a),'failed':'FAILED'},'autoExpiryNote':'Payments\x20automatically\x20expire\x20after\x20'+_0x59eb3a['expiryDays']+_0x165f6a(0xf8),'individualTimersNote':'Each\x20new\x20payment\x20gets\x20individual\x20timers:\x201min,\x202min,\x207min,\x2012min,\x20then\x20hourly'}});}catch(_0x415ae9){_0xa060[_0x165f6a(0x10a)](0x1f4)[_0x165f6a(0xe0)]({'success':![],'message':_0x165f6a(0x131)});}}),router['get'](a19_0xdcc3c3(0xe4),async(_0x949924,_0x1057ef)=>{const _0x3ae10b=a19_0xdcc3c3;try{const {paymentId:_0x4bba2a}=_0x949924['params'],_0x3a1df6=coinToPayStatusService_1[_0x3ae10b(0x129)]['getPaymentTimerInfo'](_0x4bba2a),_0x3f3fe1=(await Promise[_0x3ae10b(0xf9)]()[_0x3ae10b(0x146)](()=>__importStar(require(_0x3ae10b(0x145)))))[_0x3ae10b(0xc7)],_0x3e3409=await _0x3f3fe1[_0x3ae10b(0xf6)]['findUnique']({'where':{'id':_0x4bba2a},'select':{'id':!![],'gateway':!![],'gatewayPaymentId':!![],'status':!![],'amount':!![],'currency':!![],'createdAt':!![],'updatedAt':!![],'shopId':!![],'shop':{'select':{'name':!![],'username':!![]}}}});if(!_0x3e3409)return _0x1057ef['status'](0x194)[_0x3ae10b(0xe0)]({'success':![],'message':_0x3ae10b(0x121)});_0x1057ef[_0x3ae10b(0xe0)]({'success':!![],'result':{'payment':{'id':_0x3e3409['id'],'gateway':_0x3e3409['gateway'],'gatewayPaymentId':_0x3e3409[_0x3ae10b(0x124)],'status':_0x3e3409[_0x3ae10b(0x10a)],'amount':_0x3e3409[_0x3ae10b(0x107)],'currency':_0x3e3409['currency'],'createdAt':_0x3e3409[_0x3ae10b(0xde)],'updatedAt':_0x3e3409[_0x3ae10b(0xe6)],'shop':_0x3e3409[_0x3ae10b(0x10b)]},'timers':_0x3a1df6,'isCoinToPay':_0x3e3409[_0x3ae10b(0x10f)]===_0x3ae10b(0x120),'ageInMinutes':Math[_0x3ae10b(0xd8)]((Date[_0x3ae10b(0x13f)]()-_0x3e3409[_0x3ae10b(0xde)][_0x3ae10b(0x114)]())/(0x3e8*0x3c))}});}catch(_0x4bc690){_0x1057ef['status'](0x1f4)[_0x3ae10b(0xe0)]({'success':![],'message':_0x4bc690 instanceof Error?_0x4bc690[_0x3ae10b(0xc6)]:_0x3ae10b(0x132)});}}),router[a19_0xdcc3c3(0xed)](a19_0xdcc3c3(0x11b),async(_0x4dabf5,_0x3c7bce)=>{const _0x27c3ca=a19_0xdcc3c3;try{const {paymentId:_0x23cd4d}=_0x4dabf5[_0x27c3ca(0xd0)];console[_0x27c3ca(0xdd)]('üîç\x20[ADMIN]\x20Manual\x20Rapyd\x20check\x20requested\x20for\x20payment:\x20'+_0x23cd4d),await rapydStatusService_1[_0x27c3ca(0xc1)][_0x27c3ca(0x123)](_0x23cd4d),_0x3c7bce[_0x27c3ca(0xe0)]({'success':!![],'message':'Rapyd\x20payment\x20status\x20checked\x20successfully'});}catch(_0x110a95){console['error']('‚ùå\x20[ADMIN]\x20Manual\x20Rapyd\x20check\x20failed\x20for\x20payment\x20'+_0x4dabf5[_0x27c3ca(0xd0)]['paymentId']+':',_0x110a95),_0x3c7bce['status'](0x1f4)[_0x27c3ca(0xe0)]({'success':![],'message':_0x110a95 instanceof Error?_0x110a95[_0x27c3ca(0xc6)]:_0x27c3ca(0x13b)});}}),router[a19_0xdcc3c3(0xfa)](a19_0xdcc3c3(0xfc),(_0xee001b,_0x48e863)=>{const _0x1ae01e=a19_0xdcc3c3;try{const _0x1556eb=rapydStatusService_1[_0x1ae01e(0xc1)][_0x1ae01e(0xdf)]();_0x48e863['json']({'success':!![],'result':{..._0x1556eb,'description':_0x1ae01e(0x147),'statusMapping':{'paid:\x20true':_0x1ae01e(0xfe),'paid:\x20false\x20+\x20CAN':_0x1ae01e(0x127),'paid:\x20false\x20+\x20ERR':_0x1ae01e(0x127),'paid:\x20false\x20+\x20EXP':_0x1ae01e(0x12a),'paid:\x20false\x20+\x20other':_0x1ae01e(0x142)},'checkSchedule':'Payments\x20are\x20checked\x20after\x2030\x20minutes\x20and\x2060\x20minutes,\x20then\x20forgotten','note':_0x1ae01e(0xe5)}});}catch(_0xcb2bed){_0x48e863[_0x1ae01e(0x10a)](0x1f4)[_0x1ae01e(0xe0)]({'success':![],'message':_0x1ae01e(0xc4)});}}),router['get'](a19_0xdcc3c3(0x13c),async(_0x4cd776,_0x1c31e5)=>{const _0x1f7ae0=a19_0xdcc3c3;try{const {paymentId:_0x1ee2f2}=_0x4cd776[_0x1f7ae0(0xd0)],_0x32157d=await database_1['default'][_0x1f7ae0(0xf6)][_0x1f7ae0(0xd9)]({'where':{'id':_0x1ee2f2},'include':{'shop':{'select':{'id':!![],'name':!![],'username':!![]}}}});if(!_0x32157d)return _0x1c31e5['status'](0x194)[_0x1f7ae0(0xe0)]({'success':![],'message':_0x1f7ae0(0x121)});const _0x5d6b7c=rapydStatusService_1['rapydStatusService'][_0x1f7ae0(0x137)](_0x1ee2f2);_0x1c31e5[_0x1f7ae0(0xe0)]({'success':!![],'result':{'payment':{'id':_0x32157d['id'],'gateway':_0x32157d[_0x1f7ae0(0x10f)],'gatewayPaymentId':_0x32157d[_0x1f7ae0(0x124)],'status':_0x32157d[_0x1f7ae0(0x10a)],'amount':_0x32157d[_0x1f7ae0(0x107)],'currency':_0x32157d[_0x1f7ae0(0x10e)],'createdAt':_0x32157d[_0x1f7ae0(0xde)],'updatedAt':_0x32157d[_0x1f7ae0(0xe6)],'shop':_0x32157d['shop']},'timers':_0x5d6b7c,'isRapyd':_0x32157d[_0x1f7ae0(0x10f)]===_0x1f7ae0(0xca),'ageInMinutes':Math[_0x1f7ae0(0xd8)]((Date['now']()-_0x32157d['createdAt'][_0x1f7ae0(0x114)]())/(0x3e8*0x3c)),'nextCheck':_0x5d6b7c['hasTimers']?Math[_0x1f7ae0(0xd8)]((Date[_0x1f7ae0(0x13f)]()-_0x32157d[_0x1f7ae0(0xde)][_0x1f7ae0(0x114)]())/(0x3e8*0x3c))<0x1e?0x1e-Math['floor']((Date['now']()-_0x32157d[_0x1f7ae0(0xde)][_0x1f7ae0(0x114)]())/(0x3e8*0x3c))+_0x1f7ae0(0x140):Math[_0x1f7ae0(0xd8)]((Date['now']()-_0x32157d[_0x1f7ae0(0xde)][_0x1f7ae0(0x114)]())/(0x3e8*0x3c))<0x3c?0x3c-Math[_0x1f7ae0(0xd8)]((Date[_0x1f7ae0(0x13f)]()-_0x32157d[_0x1f7ae0(0xde)][_0x1f7ae0(0x114)]())/(0x3e8*0x3c))+_0x1f7ae0(0x140):_0x1f7ae0(0xcf):_0x1f7ae0(0xf3)}});}catch(_0x6e938a){_0x1c31e5[_0x1f7ae0(0x10a)](0x1f4)[_0x1f7ae0(0xe0)]({'success':![],'message':_0x6e938a instanceof Error?_0x6e938a['message']:_0x1f7ae0(0x132)});}}),router['get'](a19_0xdcc3c3(0xdb),(_0x193484,_0xa14576)=>{const _0x3ffb75=a19_0xdcc3c3;try{const _0x581b15=domainMonitoringService_1[_0x3ffb75(0xeb)][_0x3ffb75(0x100)]();_0xa14576['json']({'success':!![],'result':{..._0x581b15,'description':_0x3ffb75(0x125),'behavior':_0x3ffb75(0xf7),'encoding':_0x3ffb75(0xd3)}});}catch(_0x3eed82){_0xa14576['status'](0x1f4)[_0x3ffb75(0xe0)]({'success':![],'message':_0x3ffb75(0x12b)});}}),router[a19_0xdcc3c3(0xed)](a19_0xdcc3c3(0x11a),async(_0x4fe731,_0x1388af)=>{const _0x4910b7=a19_0xdcc3c3;try{const _0x3d3a6d=await domainMonitoringService_1[_0x4910b7(0xeb)][_0x4910b7(0xc8)]();_0x1388af[_0x4910b7(0xe0)]({'success':!![],'result':{'domainAvailable':_0x3d3a6d,'message':_0x3d3a6d?_0x4910b7(0x111):_0x4910b7(0xff),'timestamp':new Date()['toISOString']()}});}catch(_0x1d0908){_0x1388af[_0x4910b7(0x10a)](0x1f4)['json']({'success':![],'message':_0x1d0908 instanceof Error?_0x1d0908[_0x4910b7(0xc6)]:_0x4910b7(0x12d)});}}),exports['default']=router;function a19_0x29f3(){const _0xf7dac9=['updatePayment','No\x20more\x20checks\x20scheduled','params','747mzsfDl','__createBinding','Requests\x20are\x20made\x20with\x20base64\x20encoded\x20URLs','activateUser','getPayoutStats','createPayoutSchema','updateCustomerData','floor','findUnique','prototype','/domain-monitoring/stats','createUser','log','createdAt','getServiceStats','json','validate','authenticateToken','getPayouts','/cointopay/payment/:paymentId','Only\x20checks\x20payments\x20with\x20status\x20PENDING\x20at\x20check\x20time','updatedAt','/merchants/selection','getUsers','getPaymentById','/logs/clean','domainMonitoringService','/payments/:id','post','../controllers/adminController','requireAdmin','/users/:id/activate','createPayout','\x20days)','No\x20checks\x20scheduled','AdminController','getLogStats','payment','Server\x20crashes\x20if\x20domain\x20is\x20not\x20responding\x20after\x20consecutive\x20failures','\x20days\x20if\x20not\x20paid','resolve','get','2664240OFcSmS','/rapyd/stats','../services/loggerService','PAID','Domain\x20check\x20failed','getMonitoringStats','Failed\x20to\x20get\x20log\x20statistics','/payouts/:id','updateCustomerDataSchema','‚ùå\x20[ADMIN]\x20Manual\x20CoinToPay\x20check\x20failed\x20for\x20payment\x20','length','/payout','amount','/auth','body','status','shop','2288360XFsRey','call','currency','gateway','adminPaymentsQuerySchema','Domain\x20is\x20responding\x20correctly','createUserSchema','suspendUser','getTime','6403570bFCQNJ','44536tHBBGb','142htYrbl','__esModule','/statistics','/domain-monitoring/check','/rapyd/check/:paymentId','getOwnPropertyNames','error','getPayments','CoinToPay\x20payment\x20status\x20checked\x20successfully','cointopay','Payment\x20not\x20found','/users/:id/suspend','checkPaymentById','gatewayPaymentId','Domain\x20monitoring\x20service\x20for\x20amaterasy884.icu','__importStar','FAILED','getPayoutById','coinToPayStatusService','EXPIRED','Failed\x20to\x20get\x20domain\x20monitoring\x20statistics','/payouts','Failed\x20to\x20perform\x20manual\x20domain\x20check','updateUser','../services/rapydStatusService','getStatistics','Failed\x20to\x20get\x20CoinToPay\x20service\x20statistics','Failed\x20to\x20get\x20payment\x20information','deleteUser','getMerchantsAwaitingPayout','/payments','__importDefault','getPaymentTimerInfo','delete','/users','defineProperty','Failed\x20to\x20check\x20Rapyd\x20payment\x20status','/rapyd/payment/:paymentId','getMerchantsSelection','üîç\x20[ADMIN]\x20Manual\x20CoinToPay\x20check\x20requested\x20for\x20payment:\x20','now','\x20minutes','__setModuleDefault','PENDING','updateUserSchema','CoinToPay\x20automatic\x20status\x20checking\x20service','../config/database','then','Rapyd\x20automatic\x20status\x20checking\x20service','10364326bOoBmr','hasOwnProperty','put','loggerService','rapydStatusService','5879WiSbEz','Old\x20logs\x20cleaned\x20(kept\x20last\x20','Failed\x20to\x20get\x20Rapyd\x20service\x20statistics','../services/domainMonitoringService','message','default','manualCheck','/payout/stats','rapyd','/cointopay/stats','41496xagVtg','/users/:id'];a19_0x29f3=function(){return _0xf7dac9;};return a19_0x29f3();}