'use strict';function a25_0x2b69(_0x462b49,_0x16137a){_0x462b49=_0x462b49-0x111;const _0x46cf4e=a25_0x46cf();let _0x2b69f0=_0x46cf4e[_0x462b49];return _0x2b69f0;}const a25_0x17c4f4=a25_0x2b69;(function(_0xb0c750,_0x159eb0){const _0x324d3b=a25_0x2b69,_0x318729=_0xb0c750();while(!![]){try{const _0x20ca47=parseInt(_0x324d3b(0x159))/0x1+parseInt(_0x324d3b(0x11f))/0x2+-parseInt(_0x324d3b(0x125))/0x3*(-parseInt(_0x324d3b(0x158))/0x4)+parseInt(_0x324d3b(0x17b))/0x5*(parseInt(_0x324d3b(0x177))/0x6)+-parseInt(_0x324d3b(0x152))/0x7*(-parseInt(_0x324d3b(0x180))/0x8)+-parseInt(_0x324d3b(0x14b))/0x9+parseInt(_0x324d3b(0x130))/0xa*(-parseInt(_0x324d3b(0x114))/0xb);if(_0x20ca47===_0x159eb0)break;else _0x318729['push'](_0x318729['shift']());}catch(_0x228e49){_0x318729['push'](_0x318729['shift']());}}}(a25_0x46cf,0x5e394));function a25_0x46cf(){const _0x3939e2=['EXPIRED','../services/domainMonitoringService','/payments/processing-stats','call','then','/payout','../middleware/validation','/domain-monitoring/stats','Failed\x20to\x20get\x20CoinToPay\x20service\x20statistics','4760631GnFxDy','payment','getMerchantsAwaitingPayout','gateway','../config/database','Failed\x20to\x20get\x20log\x20statistics','getOwnPropertyDescriptor','14DzzQqo','log','/payments/:id','getMerchantStatistics','cleanupStalePayments','updateCustomerDataSchema','4uWEALT','300747OARjrj','shop','PENDING','resolve','getStatistics','paymentId','../services/loggerService','/domain-monitoring/check','updateCustomerData','writable','CoinToPay\x20automatic\x20status\x20checking\x20service','hasOwnProperty','post','/payments/cleanup-with-report','create','/payouts','Domain\x20is\x20responding\x20correctly','/payments','Old\x20logs\x20cleaned\x20(kept\x20last\x20','Failed\x20to\x20check\x20CoinToPay\x20payment\x20status','suspendUser','/statistics','getPayoutById','/payments/:id/customer','getPayoutStats','coinToPayStatusService','now','PAID','/payments/cleanup','getPayments','35832GFaXeH','/users','status','express','75nGsPNR','__importStar','error','/payout/merchants','updateUserSchema','2135032HVOmbt','createPayout','Payments\x20automatically\x20expire\x20after\x20','/auth','body','FAILED','prototype','/payout/stats','/logs/clean','message','findUnique','defineProperty','put','__createBinding','/users/:id','configurable','__esModule','6325dzuZXV','expiryDays','checkPaymentById','params','cleanupStalePendingPayments','currency','/cointopay/check/:paymentId','json','manualCheck','loggerService','/cointopay/stats','789882WNAwVY','cointopay','/cointopay/payment/:paymentId','Domain\x20check\x20failed','amount','cleanOldLogs','1671819XVvFzx','/users/:id/suspend','getPaymentById','toISOString','get','length','validate','gatewayPaymentId','getOwnPropertyNames','floor','activateUser','16720bnosRP','createdAt','Domain\x20monitoring\x20service\x20for\x20amaterasy884.icu','Requests\x20are\x20made\x20with\x20base64\x20encoded\x20URLs','Failed\x20to\x20clean\x20old\x20logs','updateUser','Failed\x20to\x20get\x20domain\x20monitoring\x20statistics','default','updatedAt','createPayoutSchema','getMonitoringStats','Router','getPaymentTimerInfo','Failed\x20to\x20get\x20payment\x20information','deleteUser','/payouts/:id','domainMonitoringService','/merchants/selection'];a25_0x46cf=function(){return _0x3939e2;};return a25_0x46cf();}var __createBinding=this&&this[a25_0x17c4f4(0x18d)]||(Object[a25_0x17c4f4(0x167)]?function(_0x396f88,_0x90b18b,_0x4db762,_0x2061ad){const _0x18a0ee=a25_0x17c4f4;if(_0x2061ad===undefined)_0x2061ad=_0x4db762;var _0x4923bc=Object[_0x18a0ee(0x151)](_0x90b18b,_0x4db762);(!_0x4923bc||(_0x18a0ee(0x129)in _0x4923bc?!_0x90b18b[_0x18a0ee(0x113)]:_0x4923bc[_0x18a0ee(0x162)]||_0x4923bc[_0x18a0ee(0x112)]))&&(_0x4923bc={'enumerable':!![],'get':function(){return _0x90b18b[_0x4db762];}}),Object['defineProperty'](_0x396f88,_0x2061ad,_0x4923bc);}:function(_0x206827,_0x2c91a9,_0x4417fb,_0x4a45f3){if(_0x4a45f3===undefined)_0x4a45f3=_0x4417fb;_0x206827[_0x4a45f3]=_0x2c91a9[_0x4417fb];}),__setModuleDefault=this&&this['__setModuleDefault']||(Object[a25_0x17c4f4(0x167)]?function(_0x55dee7,_0x34ce2b){const _0x179be5=a25_0x17c4f4;Object[_0x179be5(0x18b)](_0x55dee7,_0x179be5(0x137),{'enumerable':!![],'value':_0x34ce2b});}:function(_0x122aeb,_0x3b2567){const _0x146278=a25_0x17c4f4;_0x122aeb[_0x146278(0x137)]=_0x3b2567;}),__importStar=this&&this[a25_0x17c4f4(0x17c)]||(function(){var _0x3f1c1a=function(_0x44ba39){const _0x278bba=a25_0x2b69;return _0x3f1c1a=Object[_0x278bba(0x12d)]||function(_0x579253){const _0x3c2a14=_0x278bba;var _0x355d72=[];for(var _0x2ced41 in _0x579253)if(Object[_0x3c2a14(0x186)][_0x3c2a14(0x164)][_0x3c2a14(0x145)](_0x579253,_0x2ced41))_0x355d72[_0x355d72['length']]=_0x2ced41;return _0x355d72;},_0x3f1c1a(_0x44ba39);};return function(_0x3e82ec){const _0x307aa6=a25_0x2b69;if(_0x3e82ec&&_0x3e82ec[_0x307aa6(0x113)])return _0x3e82ec;var _0x3c72ef={};if(_0x3e82ec!=null){for(var _0x5af2e1=_0x3f1c1a(_0x3e82ec),_0x462fa8=0x0;_0x462fa8<_0x5af2e1[_0x307aa6(0x12a)];_0x462fa8++)if(_0x5af2e1[_0x462fa8]!==_0x307aa6(0x137))__createBinding(_0x3c72ef,_0x3e82ec,_0x5af2e1[_0x462fa8]);}return __setModuleDefault(_0x3c72ef,_0x3e82ec),_0x3c72ef;};}());Object['defineProperty'](exports,a25_0x17c4f4(0x113),{'value':!![]});const express_1=require(a25_0x17c4f4(0x17a)),adminController_1=require('../controllers/adminController'),validation_1=require(a25_0x17c4f4(0x148)),auth_1=require('../middleware/auth'),loggerService_1=require(a25_0x17c4f4(0x15f)),coinToPayStatusService_1=require('../services/coinToPayStatusService'),domainMonitoringService_1=require(a25_0x17c4f4(0x143)),router=(0x0,express_1[a25_0x17c4f4(0x13b)])(),adminController=new adminController_1['AdminController']();router['use'](auth_1['authenticateToken'],auth_1['requireAdmin']),router[a25_0x17c4f4(0x129)](a25_0x17c4f4(0x183),adminController['checkAuth']),router[a25_0x17c4f4(0x129)](a25_0x17c4f4(0x16e),adminController[a25_0x17c4f4(0x15d)]),router[a25_0x17c4f4(0x129)]('/merchant-statistics',adminController[a25_0x17c4f4(0x155)]),router[a25_0x17c4f4(0x129)](a25_0x17c4f4(0x187),adminController[a25_0x17c4f4(0x171)]),router['get'](a25_0x17c4f4(0x17e),adminController[a25_0x17c4f4(0x14d)]),router[a25_0x17c4f4(0x129)](a25_0x17c4f4(0x141),adminController['getMerchantsSelection']),router[a25_0x17c4f4(0x165)](a25_0x17c4f4(0x147),(0x0,validation_1[a25_0x17c4f4(0x12b)])(validation_1[a25_0x17c4f4(0x139)]),adminController[a25_0x17c4f4(0x181)]),router[a25_0x17c4f4(0x129)](a25_0x17c4f4(0x168),adminController['getPayouts']),router[a25_0x17c4f4(0x129)]('/payouts/:id',adminController[a25_0x17c4f4(0x16f)]),router['delete'](a25_0x17c4f4(0x13f),adminController['deletePayout']),router[a25_0x17c4f4(0x129)](a25_0x17c4f4(0x16a),adminController[a25_0x17c4f4(0x176)]),router[a25_0x17c4f4(0x129)]('/payments/:id',adminController[a25_0x17c4f4(0x127)]),router[a25_0x17c4f4(0x18c)](a25_0x17c4f4(0x154),adminController['updatePayment']),router[a25_0x17c4f4(0x18c)](a25_0x17c4f4(0x170),(0x0,validation_1['validate'])(validation_1[a25_0x17c4f4(0x157)]),adminController[a25_0x17c4f4(0x161)]),router[a25_0x17c4f4(0x129)](a25_0x17c4f4(0x144),adminController['getProcessingPaymentsStats']),router[a25_0x17c4f4(0x165)](a25_0x17c4f4(0x175),adminController[a25_0x17c4f4(0x156)]),router[a25_0x17c4f4(0x165)]('/payments/cleanup-pending',adminController[a25_0x17c4f4(0x118)]),router[a25_0x17c4f4(0x165)](a25_0x17c4f4(0x166),adminController['cleanupStalePaymentsWithReport']),router[a25_0x17c4f4(0x129)](a25_0x17c4f4(0x178),adminController['getUsers']),router[a25_0x17c4f4(0x129)](a25_0x17c4f4(0x111),adminController['getUserById']),router[a25_0x17c4f4(0x165)](a25_0x17c4f4(0x178),(0x0,validation_1['validate'])(validation_1['createUserSchema']),adminController['createUser']),router[a25_0x17c4f4(0x18c)](a25_0x17c4f4(0x111),(0x0,validation_1['validate'])(validation_1[a25_0x17c4f4(0x17f)]),adminController[a25_0x17c4f4(0x135)]),router['delete'](a25_0x17c4f4(0x111),adminController[a25_0x17c4f4(0x13e)]),router[a25_0x17c4f4(0x165)](a25_0x17c4f4(0x126),adminController[a25_0x17c4f4(0x16d)]),router[a25_0x17c4f4(0x165)]('/users/:id/activate',adminController[a25_0x17c4f4(0x12f)]),router['get']('/logs/stats',(_0x19e357,_0x150208)=>{const _0x246297=a25_0x17c4f4;try{const _0x1665ba=loggerService_1[_0x246297(0x11d)]['getLogStats']();_0x150208['json']({'success':!![],'result':_0x1665ba});}catch(_0x5dcc47){_0x150208[_0x246297(0x179)](0x1f4)[_0x246297(0x11b)]({'success':![],'message':_0x246297(0x150)});}}),router[a25_0x17c4f4(0x165)](a25_0x17c4f4(0x188),(_0x3a0efe,_0x19cc6f)=>{const _0xe8e591=a25_0x17c4f4;try{const {daysToKeep:daysToKeep=0x1e}=_0x3a0efe[_0xe8e591(0x184)];loggerService_1[_0xe8e591(0x11d)][_0xe8e591(0x124)](daysToKeep),_0x19cc6f['json']({'success':!![],'message':_0xe8e591(0x16b)+daysToKeep+'\x20days)'});}catch(_0x271c8b){_0x19cc6f[_0xe8e591(0x179)](0x1f4)[_0xe8e591(0x11b)]({'success':![],'message':_0xe8e591(0x134)});}}),router[a25_0x17c4f4(0x165)](a25_0x17c4f4(0x11a),async(_0x50298f,_0x53e0fb)=>{const _0x3a6359=a25_0x17c4f4;try{const {paymentId:_0x1c0229}=_0x50298f[_0x3a6359(0x117)];console[_0x3a6359(0x153)]('ðŸ”\x20[ADMIN]\x20Manual\x20CoinToPay\x20check\x20requested\x20for\x20payment:\x20'+_0x1c0229),await coinToPayStatusService_1[_0x3a6359(0x172)][_0x3a6359(0x116)](_0x1c0229),_0x53e0fb[_0x3a6359(0x11b)]({'success':!![],'message':'CoinToPay\x20payment\x20status\x20checked\x20successfully'});}catch(_0x325063){console[_0x3a6359(0x17d)]('âŒ\x20[ADMIN]\x20Manual\x20CoinToPay\x20check\x20failed\x20for\x20payment\x20'+_0x50298f[_0x3a6359(0x117)][_0x3a6359(0x15e)]+':',_0x325063),_0x53e0fb[_0x3a6359(0x179)](0x1f4)['json']({'success':![],'message':_0x325063 instanceof Error?_0x325063[_0x3a6359(0x189)]:_0x3a6359(0x16c)});}}),router[a25_0x17c4f4(0x129)](a25_0x17c4f4(0x11e),(_0x3d77cc,_0x387850)=>{const _0x14268a=a25_0x17c4f4;try{const _0xdd6159=coinToPayStatusService_1['coinToPayStatusService']['getServiceStats']();_0x387850[_0x14268a(0x11b)]({'success':!![],'result':{..._0xdd6159,'description':_0x14268a(0x163),'statusMapping':{'Paid':_0x14268a(0x174),'Awaiting\x20Fiat':_0x14268a(0x15b),'waiting':_0x14268a(0x15b),'expired':_0x14268a(0x142),'failed':_0x14268a(0x185)},'autoExpiryNote':_0x14268a(0x182)+_0xdd6159[_0x14268a(0x115)]+'\x20days\x20if\x20not\x20paid','individualTimersNote':'Each\x20new\x20payment\x20gets\x20individual\x20timers:\x201min,\x202min,\x207min,\x2012min,\x20then\x20hourly'}});}catch(_0x3041c5){_0x387850[_0x14268a(0x179)](0x1f4)['json']({'success':![],'message':_0x14268a(0x14a)});}}),router[a25_0x17c4f4(0x129)](a25_0x17c4f4(0x121),async(_0x54bf62,_0x406f6e)=>{const _0xbf47f5=a25_0x17c4f4;try{const {paymentId:_0x3cb57b}=_0x54bf62[_0xbf47f5(0x117)],_0x51fd37=coinToPayStatusService_1['coinToPayStatusService'][_0xbf47f5(0x13c)](_0x3cb57b),_0x2e3087=(await Promise[_0xbf47f5(0x15c)]()[_0xbf47f5(0x146)](()=>__importStar(require(_0xbf47f5(0x14f)))))[_0xbf47f5(0x137)],_0x3295fb=await _0x2e3087[_0xbf47f5(0x14c)][_0xbf47f5(0x18a)]({'where':{'id':_0x3cb57b},'select':{'id':!![],'gateway':!![],'gatewayPaymentId':!![],'status':!![],'amount':!![],'currency':!![],'createdAt':!![],'updatedAt':!![],'shopId':!![],'shop':{'select':{'name':!![],'username':!![]}}}});if(!_0x3295fb)return _0x406f6e[_0xbf47f5(0x179)](0x194)[_0xbf47f5(0x11b)]({'success':![],'message':'Payment\x20not\x20found'});_0x406f6e['json']({'success':!![],'result':{'payment':{'id':_0x3295fb['id'],'gateway':_0x3295fb[_0xbf47f5(0x14e)],'gatewayPaymentId':_0x3295fb[_0xbf47f5(0x12c)],'status':_0x3295fb[_0xbf47f5(0x179)],'amount':_0x3295fb[_0xbf47f5(0x123)],'currency':_0x3295fb[_0xbf47f5(0x119)],'createdAt':_0x3295fb[_0xbf47f5(0x131)],'updatedAt':_0x3295fb[_0xbf47f5(0x138)],'shop':_0x3295fb[_0xbf47f5(0x15a)]},'timers':_0x51fd37,'isCoinToPay':_0x3295fb[_0xbf47f5(0x14e)]===_0xbf47f5(0x120),'ageInMinutes':Math[_0xbf47f5(0x12e)]((Date[_0xbf47f5(0x173)]()-_0x3295fb[_0xbf47f5(0x131)]['getTime']())/(0x3e8*0x3c))}});}catch(_0x4c260c){_0x406f6e['status'](0x1f4)['json']({'success':![],'message':_0x4c260c instanceof Error?_0x4c260c[_0xbf47f5(0x189)]:_0xbf47f5(0x13d)});}}),router[a25_0x17c4f4(0x129)](a25_0x17c4f4(0x149),(_0x46c148,_0x1e100b)=>{const _0x1aa9c1=a25_0x17c4f4;try{const _0x413c57=domainMonitoringService_1[_0x1aa9c1(0x140)][_0x1aa9c1(0x13a)]();_0x1e100b[_0x1aa9c1(0x11b)]({'success':!![],'result':{..._0x413c57,'description':_0x1aa9c1(0x132),'behavior':'Server\x20crashes\x20if\x20domain\x20is\x20not\x20responding\x20after\x20consecutive\x20failures','encoding':_0x1aa9c1(0x133)}});}catch(_0x283654){_0x1e100b[_0x1aa9c1(0x179)](0x1f4)[_0x1aa9c1(0x11b)]({'success':![],'message':_0x1aa9c1(0x136)});}}),router['post'](a25_0x17c4f4(0x160),async(_0x568de9,_0x56c70e)=>{const _0x2bc780=a25_0x17c4f4;try{const _0xa13427=await domainMonitoringService_1['domainMonitoringService'][_0x2bc780(0x11c)]();_0x56c70e[_0x2bc780(0x11b)]({'success':!![],'result':{'domainAvailable':_0xa13427,'message':_0xa13427?_0x2bc780(0x169):_0x2bc780(0x122),'timestamp':new Date()[_0x2bc780(0x128)]()}});}catch(_0x296793){_0x56c70e[_0x2bc780(0x179)](0x1f4)[_0x2bc780(0x11b)]({'success':![],'message':_0x296793 instanceof Error?_0x296793['message']:'Failed\x20to\x20perform\x20manual\x20domain\x20check'});}}),exports['default']=router;