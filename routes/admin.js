'use strict';const a19_0x2b929b=a19_0x319e;(function(_0x42dd2a,_0x3d6a9e){const _0x23fb03=a19_0x319e,_0x19f566=_0x42dd2a();while(!![]){try{const _0x277dee=-parseInt(_0x23fb03(0x1f7))/0x1*(-parseInt(_0x23fb03(0x1d8))/0x2)+-parseInt(_0x23fb03(0x1db))/0x3*(-parseInt(_0x23fb03(0x1d6))/0x4)+-parseInt(_0x23fb03(0x1c6))/0x5*(-parseInt(_0x23fb03(0x1af))/0x6)+-parseInt(_0x23fb03(0x1fc))/0x7*(-parseInt(_0x23fb03(0x1ea))/0x8)+-parseInt(_0x23fb03(0x1de))/0x9+-parseInt(_0x23fb03(0x1aa))/0xa+-parseInt(_0x23fb03(0x1ad))/0xb;if(_0x277dee===_0x3d6a9e)break;else _0x19f566['push'](_0x19f566['shift']());}catch(_0x3b3b13){_0x19f566['push'](_0x19f566['shift']());}}}(a19_0x1226,0xde8a9));var __createBinding=this&&this[a19_0x2b929b(0x1d2)]||(Object[a19_0x2b929b(0x1cd)]?function(_0xd51a9b,_0x971ca0,_0x806779,_0x361e9a){const _0x3dc013=a19_0x2b929b;if(_0x361e9a===undefined)_0x361e9a=_0x806779;var _0x2e825f=Object[_0x3dc013(0x1c8)](_0x971ca0,_0x806779);(!_0x2e825f||(_0x3dc013(0x1e7)in _0x2e825f?!_0x971ca0['__esModule']:_0x2e825f[_0x3dc013(0x1b1)]||_0x2e825f[_0x3dc013(0x1ce)]))&&(_0x2e825f={'enumerable':!![],'get':function(){return _0x971ca0[_0x806779];}}),Object[_0x3dc013(0x1fd)](_0xd51a9b,_0x361e9a,_0x2e825f);}:function(_0x40f80e,_0x22a0c9,_0x1e6f9c,_0xa340ca){if(_0xa340ca===undefined)_0xa340ca=_0x1e6f9c;_0x40f80e[_0xa340ca]=_0x22a0c9[_0x1e6f9c];}),__setModuleDefault=this&&this[a19_0x2b929b(0x1e1)]||(Object[a19_0x2b929b(0x1cd)]?function(_0x24a9d9,_0x20b3d6){const _0x4ecd6e=a19_0x2b929b;Object[_0x4ecd6e(0x1fd)](_0x24a9d9,_0x4ecd6e(0x1d9),{'enumerable':!![],'value':_0x20b3d6});}:function(_0x1f72c2,_0x1d185a){const _0x3ccdb3=a19_0x2b929b;_0x1f72c2[_0x3ccdb3(0x1d9)]=_0x1d185a;}),__importStar=this&&this['__importStar']||(function(){var _0x3e5326=function(_0x45f033){const _0x3410a1=a19_0x319e;return _0x3e5326=Object[_0x3410a1(0x1f2)]||function(_0x4f516){const _0x3d0ae9=_0x3410a1;var _0x195056=[];for(var _0xc2642e in _0x4f516)if(Object[_0x3d0ae9(0x1e8)]['hasOwnProperty']['call'](_0x4f516,_0xc2642e))_0x195056[_0x195056['length']]=_0xc2642e;return _0x195056;},_0x3e5326(_0x45f033);};return function(_0x1bc1fe){const _0x48fd0e=a19_0x319e;if(_0x1bc1fe&&_0x1bc1fe[_0x48fd0e(0x209)])return _0x1bc1fe;var _0x35becf={};if(_0x1bc1fe!=null){for(var _0x54eb93=_0x3e5326(_0x1bc1fe),_0x57035a=0x0;_0x57035a<_0x54eb93[_0x48fd0e(0x1e9)];_0x57035a++)if(_0x54eb93[_0x57035a]!=='default')__createBinding(_0x35becf,_0x1bc1fe,_0x54eb93[_0x57035a]);}return __setModuleDefault(_0x35becf,_0x1bc1fe),_0x35becf;};}());function a19_0x1226(){const _0x2a734b=['getMerchantsSelection','__esModule','updateUser','../services/coinToPayStatusService','/cointopay/stats','getMerchantsAwaitingPayout','Domain\x20is\x20responding\x20correctly','body','getMonitoringStats','params','gatewayPaymentId','createUserSchema','/users/:id/suspend','PAID','put','Each\x20new\x20payment\x20gets\x20individual\x20timers:\x201min,\x202min,\x207min,\x2012min,\x20then\x20hourly','Failed\x20to\x20clean\x20old\x20logs','Payments\x20automatically\x20expire\x20after\x20','EXPIRED','12779440FUdxWb','gateway','toISOString','1669448eOfxXw','/cointopay/check/:paymentId','3918zRaXNE','/logs/clean','writable','loggerService','updateCustomerData','Failed\x20to\x20get\x20CoinToPay\x20service\x20statistics','message','shop','updatePayment','post','createPayoutSchema','../controllers/adminController','FAILED','/payout','/logs/stats','Requests\x20are\x20made\x20with\x20base64\x20encoded\x20URLs','then','/payments','checkAuth','paymentId','/payout/stats','/merchants/selection','❌\x20[ADMIN]\x20Manual\x20CoinToPay\x20check\x20failed\x20for\x20payment\x20','4120fopXza','updateUserSchema','getOwnPropertyDescriptor','updatedAt','getTime','json','validate','create','configurable','/users/:id','expiryDays','domainMonitoringService','__createBinding','Failed\x20to\x20perform\x20manual\x20domain\x20check','getPayouts','/domain-monitoring/stats','1507404MDVgSY','now','344XUymhj','default','/payments/:id/customer','6jwfcyG','../middleware/validation','/domain-monitoring/check','13364352MKlRpk','/payout/merchants','error','__setModuleDefault','updateCustomerDataSchema','../services/loggerService','../config/database','/payouts/:id','express','get','prototype','length','108024WDLFyh','Failed\x20to\x20check\x20CoinToPay\x20payment\x20status','Old\x20logs\x20cleaned\x20(kept\x20last\x20','getMerchantStatistics','getPayoutById','/auth','Domain\x20monitoring\x20service\x20for\x20amaterasy884.icu','Server\x20crashes\x20if\x20domain\x20is\x20not\x20responding\x20after\x20consecutive\x20failures','getOwnPropertyNames','checkPaymentById','coinToPayStatusService','getPayments','/cointopay/payment/:paymentId','9946FdEPNV','amount','getUserById','status','/merchant-statistics','427mqnnhD','defineProperty','CoinToPay\x20payment\x20status\x20checked\x20successfully','/users','log','getPayoutStats','getLogStats','Domain\x20check\x20failed','getPaymentById','authenticateToken','createUser','CoinToPay\x20automatic\x20status\x20checking\x20service'];a19_0x1226=function(){return _0x2a734b;};return a19_0x1226();}function a19_0x319e(_0x1c4ed8,_0x26a0ec){const _0x122696=a19_0x1226();return a19_0x319e=function(_0x319e96,_0x2c3ffc){_0x319e96=_0x319e96-0x19a;let _0x563bf6=_0x122696[_0x319e96];return _0x563bf6;},a19_0x319e(_0x1c4ed8,_0x26a0ec);}Object[a19_0x2b929b(0x1fd)](exports,a19_0x2b929b(0x209),{'value':!![]});const express_1=require(a19_0x2b929b(0x1e6)),adminController_1=require(a19_0x2b929b(0x1ba)),validation_1=require(a19_0x2b929b(0x1dc)),auth_1=require('../middleware/auth'),loggerService_1=require(a19_0x2b929b(0x1e3)),coinToPayStatusService_1=require(a19_0x2b929b(0x19a)),domainMonitoringService_1=require('../services/domainMonitoringService'),router=(0x0,express_1['Router'])(),adminController=new adminController_1['AdminController']();router['use'](auth_1[a19_0x2b929b(0x205)],auth_1['requireAdmin']),router[a19_0x2b929b(0x1e7)](a19_0x2b929b(0x1ef),adminController[a19_0x2b929b(0x1c1)]),router[a19_0x2b929b(0x1e7)]('/statistics',adminController['getStatistics']),router[a19_0x2b929b(0x1e7)](a19_0x2b929b(0x1fb),adminController[a19_0x2b929b(0x1ed)]),router['get'](a19_0x2b929b(0x1c3),adminController[a19_0x2b929b(0x201)]),router[a19_0x2b929b(0x1e7)](a19_0x2b929b(0x1df),adminController[a19_0x2b929b(0x19c)]),router[a19_0x2b929b(0x1e7)](a19_0x2b929b(0x1c4),adminController[a19_0x2b929b(0x208)]),router[a19_0x2b929b(0x1b8)](a19_0x2b929b(0x1bc),(0x0,validation_1[a19_0x2b929b(0x1cc)])(validation_1[a19_0x2b929b(0x1b9)]),adminController['createPayout']),router[a19_0x2b929b(0x1e7)]('/payouts',adminController[a19_0x2b929b(0x1d4)]),router[a19_0x2b929b(0x1e7)]('/payouts/:id',adminController[a19_0x2b929b(0x1ee)]),router['delete'](a19_0x2b929b(0x1e5),adminController['deletePayout']),router['get'](a19_0x2b929b(0x1c0),adminController[a19_0x2b929b(0x1f5)]),router[a19_0x2b929b(0x1e7)]('/payments/:id',adminController[a19_0x2b929b(0x204)]),router[a19_0x2b929b(0x1a5)]('/payments/:id',adminController[a19_0x2b929b(0x1b7)]),router[a19_0x2b929b(0x1a5)](a19_0x2b929b(0x1da),(0x0,validation_1[a19_0x2b929b(0x1cc)])(validation_1[a19_0x2b929b(0x1e2)]),adminController[a19_0x2b929b(0x1b3)]),router[a19_0x2b929b(0x1e7)]('/users',adminController['getUsers']),router[a19_0x2b929b(0x1e7)](a19_0x2b929b(0x1cf),adminController[a19_0x2b929b(0x1f9)]),router['post'](a19_0x2b929b(0x1ff),(0x0,validation_1[a19_0x2b929b(0x1cc)])(validation_1[a19_0x2b929b(0x1a2)]),adminController[a19_0x2b929b(0x206)]),router[a19_0x2b929b(0x1a5)](a19_0x2b929b(0x1cf),(0x0,validation_1['validate'])(validation_1[a19_0x2b929b(0x1c7)]),adminController[a19_0x2b929b(0x20a)]),router['delete']('/users/:id',adminController['deleteUser']),router['post'](a19_0x2b929b(0x1a3),adminController['suspendUser']),router['post']('/users/:id/activate',adminController['activateUser']),router[a19_0x2b929b(0x1e7)](a19_0x2b929b(0x1bd),(_0x34d6c3,_0x4128ac)=>{const _0x47a354=a19_0x2b929b;try{const _0x2abd9a=loggerService_1[_0x47a354(0x1b2)][_0x47a354(0x202)]();_0x4128ac[_0x47a354(0x1cb)]({'success':!![],'result':_0x2abd9a});}catch(_0x200011){_0x4128ac[_0x47a354(0x1fa)](0x1f4)[_0x47a354(0x1cb)]({'success':![],'message':'Failed\x20to\x20get\x20log\x20statistics'});}}),router[a19_0x2b929b(0x1b8)](a19_0x2b929b(0x1b0),(_0xf6d221,_0x3fd546)=>{const _0x477249=a19_0x2b929b;try{const {daysToKeep:daysToKeep=0x1e}=_0xf6d221[_0x477249(0x19e)];loggerService_1['loggerService']['cleanOldLogs'](daysToKeep),_0x3fd546['json']({'success':!![],'message':_0x477249(0x1ec)+daysToKeep+'\x20days)'});}catch(_0x390b50){_0x3fd546['status'](0x1f4)[_0x477249(0x1cb)]({'success':![],'message':_0x477249(0x1a7)});}}),router[a19_0x2b929b(0x1b8)](a19_0x2b929b(0x1ae),async(_0xd4413d,_0x5d7218)=>{const _0x3f90f7=a19_0x2b929b;try{const {paymentId:_0x1247b1}=_0xd4413d[_0x3f90f7(0x1a0)];console[_0x3f90f7(0x200)]('🔍\x20[ADMIN]\x20Manual\x20CoinToPay\x20check\x20requested\x20for\x20payment:\x20'+_0x1247b1),await coinToPayStatusService_1['coinToPayStatusService'][_0x3f90f7(0x1f3)](_0x1247b1),_0x5d7218[_0x3f90f7(0x1cb)]({'success':!![],'message':_0x3f90f7(0x1fe)});}catch(_0x3f0824){console[_0x3f90f7(0x1e0)](_0x3f90f7(0x1c5)+_0xd4413d[_0x3f90f7(0x1a0)][_0x3f90f7(0x1c2)]+':',_0x3f0824),_0x5d7218[_0x3f90f7(0x1fa)](0x1f4)[_0x3f90f7(0x1cb)]({'success':![],'message':_0x3f0824 instanceof Error?_0x3f0824[_0x3f90f7(0x1b5)]:_0x3f90f7(0x1eb)});}}),router['get'](a19_0x2b929b(0x19b),(_0x61de56,_0x2a5615)=>{const _0x376c8a=a19_0x2b929b;try{const _0x53157a=coinToPayStatusService_1[_0x376c8a(0x1f4)]['getServiceStats']();_0x2a5615[_0x376c8a(0x1cb)]({'success':!![],'result':{..._0x53157a,'description':_0x376c8a(0x207),'statusMapping':{'Paid':_0x376c8a(0x1a4),'Awaiting\x20Fiat':'PENDING','waiting':'PENDING','expired':_0x376c8a(0x1a9),'failed':_0x376c8a(0x1bb)},'autoExpiryNote':_0x376c8a(0x1a8)+_0x53157a[_0x376c8a(0x1d0)]+'\x20days\x20if\x20not\x20paid','individualTimersNote':_0x376c8a(0x1a6)}});}catch(_0x56f03b){_0x2a5615[_0x376c8a(0x1fa)](0x1f4)['json']({'success':![],'message':_0x376c8a(0x1b4)});}}),router[a19_0x2b929b(0x1e7)](a19_0x2b929b(0x1f6),async(_0x45dfe6,_0x573dd3)=>{const _0x4fcf9f=a19_0x2b929b;try{const {paymentId:_0x197af2}=_0x45dfe6[_0x4fcf9f(0x1a0)],_0x56e8dd=coinToPayStatusService_1[_0x4fcf9f(0x1f4)]['getPaymentTimerInfo'](_0x197af2),_0x35d664=(await Promise['resolve']()[_0x4fcf9f(0x1bf)](()=>__importStar(require(_0x4fcf9f(0x1e4)))))[_0x4fcf9f(0x1d9)],_0x3c09e2=await _0x35d664['payment']['findUnique']({'where':{'id':_0x197af2},'select':{'id':!![],'gateway':!![],'gatewayPaymentId':!![],'status':!![],'amount':!![],'currency':!![],'createdAt':!![],'updatedAt':!![],'shopId':!![],'shop':{'select':{'name':!![],'username':!![]}}}});if(!_0x3c09e2)return _0x573dd3[_0x4fcf9f(0x1fa)](0x194)[_0x4fcf9f(0x1cb)]({'success':![],'message':'Payment\x20not\x20found'});_0x573dd3[_0x4fcf9f(0x1cb)]({'success':!![],'result':{'payment':{'id':_0x3c09e2['id'],'gateway':_0x3c09e2[_0x4fcf9f(0x1ab)],'gatewayPaymentId':_0x3c09e2[_0x4fcf9f(0x1a1)],'status':_0x3c09e2[_0x4fcf9f(0x1fa)],'amount':_0x3c09e2[_0x4fcf9f(0x1f8)],'currency':_0x3c09e2['currency'],'createdAt':_0x3c09e2['createdAt'],'updatedAt':_0x3c09e2[_0x4fcf9f(0x1c9)],'shop':_0x3c09e2[_0x4fcf9f(0x1b6)]},'timers':_0x56e8dd,'isCoinToPay':_0x3c09e2[_0x4fcf9f(0x1ab)]==='cointopay','ageInMinutes':Math['floor']((Date[_0x4fcf9f(0x1d7)]()-_0x3c09e2['createdAt'][_0x4fcf9f(0x1ca)]())/(0x3e8*0x3c))}});}catch(_0x4fd299){_0x573dd3[_0x4fcf9f(0x1fa)](0x1f4)[_0x4fcf9f(0x1cb)]({'success':![],'message':_0x4fd299 instanceof Error?_0x4fd299[_0x4fcf9f(0x1b5)]:'Failed\x20to\x20get\x20payment\x20information'});}}),router[a19_0x2b929b(0x1e7)](a19_0x2b929b(0x1d5),(_0x5c9c29,_0x3074f3)=>{const _0x409ea0=a19_0x2b929b;try{const _0x531c38=domainMonitoringService_1[_0x409ea0(0x1d1)][_0x409ea0(0x19f)]();_0x3074f3[_0x409ea0(0x1cb)]({'success':!![],'result':{..._0x531c38,'description':_0x409ea0(0x1f0),'behavior':_0x409ea0(0x1f1),'encoding':_0x409ea0(0x1be)}});}catch(_0x3037b4){_0x3074f3[_0x409ea0(0x1fa)](0x1f4)['json']({'success':![],'message':'Failed\x20to\x20get\x20domain\x20monitoring\x20statistics'});}}),router[a19_0x2b929b(0x1b8)](a19_0x2b929b(0x1dd),async(_0xa48c4e,_0x499a7d)=>{const _0x47ddf9=a19_0x2b929b;try{const _0x297cb9=await domainMonitoringService_1['domainMonitoringService']['manualCheck']();_0x499a7d[_0x47ddf9(0x1cb)]({'success':!![],'result':{'domainAvailable':_0x297cb9,'message':_0x297cb9?_0x47ddf9(0x19d):_0x47ddf9(0x203),'timestamp':new Date()[_0x47ddf9(0x1ac)]()}});}catch(_0x2c18f2){_0x499a7d[_0x47ddf9(0x1fa)](0x1f4)[_0x47ddf9(0x1cb)]({'success':![],'message':_0x2c18f2 instanceof Error?_0x2c18f2[_0x47ddf9(0x1b5)]:_0x47ddf9(0x1d3)});}}),exports[a19_0x2b929b(0x1d9)]=router;