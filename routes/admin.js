'use strict';const a19_0x111a95=a19_0x3819;function a19_0x260c(){const _0x5c2834=['__importStar','PENDING','findUnique','then','üîç\x20[ADMIN]\x20Manual\x20CoinToPay\x20check\x20requested\x20for\x20payment:\x20','/payout/merchants','get','/payments','1066152bchnAJ','/auth','\x20days\x20if\x20not\x20paid','use','/payments/:id/customer','updateUserSchema','../services/coinToPayStatusService','log','Failed\x20to\x20check\x20CoinToPay\x20payment\x20status','getPaymentById','message','AdminController','length','/domain-monitoring/check','2NsQvbQ','coinToPayStatusService','createUser','Requests\x20are\x20made\x20with\x20base64\x20encoded\x20URLs','domainMonitoringService','getLogStats','loggerService','getPayouts','Domain\x20monitoring\x20service\x20for\x20amaterasy884.icu','updateUser','CoinToPay\x20automatic\x20status\x20checking\x20service','1618446ASGFzk','../services/loggerService','EXPIRED','/domain-monitoring/stats','createdAt','CoinToPay\x20payment\x20status\x20checked\x20successfully','call','activateUser','/cointopay/stats','manualCheck','defineProperty','Failed\x20to\x20clean\x20old\x20logs','Server\x20crashes\x20if\x20domain\x20is\x20not\x20responding\x20after\x20consecutive\x20failures','gateway','status','getOwnPropertyDescriptor','getUserById','updatedAt','Payments\x20automatically\x20expire\x20after\x20','2451396nYETIK','__setModuleDefault','expiryDays','payment','deleteUser','params','206040zKiEyV','/cointopay/check/:paymentId','updatePayment','/payouts/:id','getServiceStats','paymentId','cleanOldLogs','getMerchantsAwaitingPayout','updateCustomerDataSchema','delete','/payouts','__createBinding','Old\x20logs\x20cleaned\x20(kept\x20last\x20','‚ùå\x20[ADMIN]\x20Manual\x20CoinToPay\x20check\x20failed\x20for\x20payment\x20','/users/:id','requireAdmin','getUsers','../middleware/auth','toISOString','\x20days)','__esModule','/payments/:id','suspendUser','create','configurable','/users/:id/suspend','getStatistics','/payout','getPayoutStats','getMonitoringStats','hasOwnProperty','../middleware/validation','shop','PAID','../services/domainMonitoringService','getTime','amount','Payment\x20not\x20found','put','updateCustomerData','prototype','checkPaymentById','json','475466dJLnlz','express','Failed\x20to\x20get\x20payment\x20information','3564930hmdHyH','/payout/stats','body','deletePayout','getMerchantStatistics','Failed\x20to\x20perform\x20manual\x20domain\x20check','createPayoutSchema','1212876HTrTjC','getPayments','default','/logs/stats','Failed\x20to\x20get\x20domain\x20monitoring\x20statistics','post','validate'];a19_0x260c=function(){return _0x5c2834;};return a19_0x260c();}(function(_0x52b515,_0xb15bac){const _0x20a382=a19_0x3819,_0xb7a3e9=_0x52b515();while(!![]){try{const _0x2c1a78=-parseInt(_0x20a382(0xfa))/0x1*(parseInt(_0x20a382(0x121))/0x2)+parseInt(_0x20a382(0x12c))/0x3+-parseInt(_0x20a382(0x145))/0x4+parseInt(_0x20a382(0xfd))/0x5+-parseInt(_0x20a382(0x13f))/0x6+parseInt(_0x20a382(0x104))/0x7+-parseInt(_0x20a382(0x113))/0x8;if(_0x2c1a78===_0xb15bac)break;else _0xb7a3e9['push'](_0xb7a3e9['shift']());}catch(_0x430888){_0xb7a3e9['push'](_0xb7a3e9['shift']());}}}(a19_0x260c,0x5723d));function a19_0x3819(_0xc9f353,_0x181800){const _0x260c1a=a19_0x260c();return a19_0x3819=function(_0x38194a,_0x2313c7){_0x38194a=_0x38194a-0xf4;let _0x54127f=_0x260c1a[_0x38194a];return _0x54127f;},a19_0x3819(_0xc9f353,_0x181800);}var __createBinding=this&&this[a19_0x111a95(0x150)]||(Object[a19_0x111a95(0x15c)]?function(_0x5168e3,_0x3d2268,_0x4dfb42,_0x395149){const _0x4ce342=a19_0x111a95;if(_0x395149===undefined)_0x395149=_0x4dfb42;var _0x60246e=Object[_0x4ce342(0x13b)](_0x3d2268,_0x4dfb42);(!_0x60246e||('get'in _0x60246e?!_0x3d2268[_0x4ce342(0x159)]:_0x60246e['writable']||_0x60246e[_0x4ce342(0x15d)]))&&(_0x60246e={'enumerable':!![],'get':function(){return _0x3d2268[_0x4dfb42];}}),Object['defineProperty'](_0x5168e3,_0x395149,_0x60246e);}:function(_0x2e2f26,_0x6cd8da,_0x192e0a,_0x1e9dd7){if(_0x1e9dd7===undefined)_0x1e9dd7=_0x192e0a;_0x2e2f26[_0x1e9dd7]=_0x6cd8da[_0x192e0a];}),__setModuleDefault=this&&this[a19_0x111a95(0x140)]||(Object[a19_0x111a95(0x15c)]?function(_0x3dd218,_0xe9437b){const _0x1efc95=a19_0x111a95;Object[_0x1efc95(0x136)](_0x3dd218,_0x1efc95(0x106),{'enumerable':!![],'value':_0xe9437b});}:function(_0x16c8ad,_0x46a767){_0x16c8ad['default']=_0x46a767;}),__importStar=this&&this[a19_0x111a95(0x10b)]||(function(){var _0x3613d1=function(_0x2e0f7e){return _0x3613d1=Object['getOwnPropertyNames']||function(_0x5040d4){const _0x62551e=a19_0x3819;var _0x1f262f=[];for(var _0x49d6ac in _0x5040d4)if(Object[_0x62551e(0xf7)][_0x62551e(0x163)][_0x62551e(0x132)](_0x5040d4,_0x49d6ac))_0x1f262f[_0x1f262f['length']]=_0x49d6ac;return _0x1f262f;},_0x3613d1(_0x2e0f7e);};return function(_0x13f750){const _0x2c2b51=a19_0x3819;if(_0x13f750&&_0x13f750[_0x2c2b51(0x159)])return _0x13f750;var _0x1970d4={};if(_0x13f750!=null){for(var _0x1b1338=_0x3613d1(_0x13f750),_0x176d95=0x0;_0x176d95<_0x1b1338[_0x2c2b51(0x11f)];_0x176d95++)if(_0x1b1338[_0x176d95]!=='default')__createBinding(_0x1970d4,_0x13f750,_0x1b1338[_0x176d95]);}return __setModuleDefault(_0x1970d4,_0x13f750),_0x1970d4;};}());Object[a19_0x111a95(0x136)](exports,'__esModule',{'value':!![]});const express_1=require(a19_0x111a95(0xfb)),adminController_1=require('../controllers/adminController'),validation_1=require(a19_0x111a95(0x164)),auth_1=require(a19_0x111a95(0x156)),loggerService_1=require(a19_0x111a95(0x12d)),coinToPayStatusService_1=require(a19_0x111a95(0x119)),domainMonitoringService_1=require(a19_0x111a95(0x167)),router=(0x0,express_1['Router'])(),adminController=new adminController_1[(a19_0x111a95(0x11e))]();router[a19_0x111a95(0x116)](auth_1['authenticateToken'],auth_1[a19_0x111a95(0x154)]),router[a19_0x111a95(0x111)](a19_0x111a95(0x114),adminController['checkAuth']),router[a19_0x111a95(0x111)]('/statistics',adminController[a19_0x111a95(0x15f)]),router[a19_0x111a95(0x111)]('/merchant-statistics',adminController[a19_0x111a95(0x101)]),router[a19_0x111a95(0x111)](a19_0x111a95(0xfe),adminController[a19_0x111a95(0x161)]),router[a19_0x111a95(0x111)](a19_0x111a95(0x110),adminController[a19_0x111a95(0x14c)]),router['post'](a19_0x111a95(0x160),(0x0,validation_1[a19_0x111a95(0x10a)])(validation_1[a19_0x111a95(0x103)]),adminController['createPayout']),router['get'](a19_0x111a95(0x14f),adminController[a19_0x111a95(0x128)]),router[a19_0x111a95(0x111)](a19_0x111a95(0x148),adminController['getPayoutById']),router['delete'](a19_0x111a95(0x148),adminController[a19_0x111a95(0x100)]),router[a19_0x111a95(0x111)](a19_0x111a95(0x112),adminController[a19_0x111a95(0x105)]),router['get'](a19_0x111a95(0x15a),adminController[a19_0x111a95(0x11c)]),router[a19_0x111a95(0xf5)](a19_0x111a95(0x15a),adminController[a19_0x111a95(0x147)]),router[a19_0x111a95(0xf5)](a19_0x111a95(0x117),(0x0,validation_1[a19_0x111a95(0x10a)])(validation_1[a19_0x111a95(0x14d)]),adminController[a19_0x111a95(0xf6)]),router[a19_0x111a95(0x111)]('/users',adminController[a19_0x111a95(0x155)]),router['get'](a19_0x111a95(0x153),adminController[a19_0x111a95(0x13c)]),router[a19_0x111a95(0x109)]('/users',(0x0,validation_1[a19_0x111a95(0x10a)])(validation_1['createUserSchema']),adminController[a19_0x111a95(0x123)]),router[a19_0x111a95(0xf5)](a19_0x111a95(0x153),(0x0,validation_1[a19_0x111a95(0x10a)])(validation_1[a19_0x111a95(0x118)]),adminController[a19_0x111a95(0x12a)]),router[a19_0x111a95(0x14e)](a19_0x111a95(0x153),adminController[a19_0x111a95(0x143)]),router[a19_0x111a95(0x109)](a19_0x111a95(0x15e),adminController[a19_0x111a95(0x15b)]),router[a19_0x111a95(0x109)]('/users/:id/activate',adminController[a19_0x111a95(0x133)]),router[a19_0x111a95(0x111)](a19_0x111a95(0x107),(_0x154a57,_0x24ce75)=>{const _0x8a0fc5=a19_0x111a95;try{const _0x16efaa=loggerService_1['loggerService'][_0x8a0fc5(0x126)]();_0x24ce75[_0x8a0fc5(0xf9)]({'success':!![],'result':_0x16efaa});}catch(_0x5c1f3e){_0x24ce75[_0x8a0fc5(0x13a)](0x1f4)[_0x8a0fc5(0xf9)]({'success':![],'message':'Failed\x20to\x20get\x20log\x20statistics'});}}),router[a19_0x111a95(0x109)]('/logs/clean',(_0x37efca,_0x4f6716)=>{const _0x217126=a19_0x111a95;try{const {daysToKeep:daysToKeep=0x1e}=_0x37efca[_0x217126(0xff)];loggerService_1[_0x217126(0x127)][_0x217126(0x14b)](daysToKeep),_0x4f6716[_0x217126(0xf9)]({'success':!![],'message':_0x217126(0x151)+daysToKeep+_0x217126(0x158)});}catch(_0x28daab){_0x4f6716['status'](0x1f4)[_0x217126(0xf9)]({'success':![],'message':_0x217126(0x137)});}}),router[a19_0x111a95(0x109)](a19_0x111a95(0x146),async(_0x4ced92,_0x2629a0)=>{const _0x24a460=a19_0x111a95;try{const {paymentId:_0x230d4d}=_0x4ced92[_0x24a460(0x144)];console[_0x24a460(0x11a)](_0x24a460(0x10f)+_0x230d4d),await coinToPayStatusService_1[_0x24a460(0x122)][_0x24a460(0xf8)](_0x230d4d),_0x2629a0[_0x24a460(0xf9)]({'success':!![],'message':_0x24a460(0x131)});}catch(_0x2a5dc1){console['error'](_0x24a460(0x152)+_0x4ced92[_0x24a460(0x144)][_0x24a460(0x14a)]+':',_0x2a5dc1),_0x2629a0['status'](0x1f4)['json']({'success':![],'message':_0x2a5dc1 instanceof Error?_0x2a5dc1[_0x24a460(0x11d)]:_0x24a460(0x11b)});}}),router[a19_0x111a95(0x111)](a19_0x111a95(0x134),(_0x2c8e87,_0x27d421)=>{const _0x365bf0=a19_0x111a95;try{const _0x3460ca=coinToPayStatusService_1[_0x365bf0(0x122)][_0x365bf0(0x149)]();_0x27d421['json']({'success':!![],'result':{..._0x3460ca,'description':_0x365bf0(0x12b),'statusMapping':{'Paid':_0x365bf0(0x166),'Awaiting\x20Fiat':_0x365bf0(0x10c),'waiting':_0x365bf0(0x10c),'expired':_0x365bf0(0x12e),'failed':'FAILED'},'autoExpiryNote':_0x365bf0(0x13e)+_0x3460ca[_0x365bf0(0x141)]+_0x365bf0(0x115),'individualTimersNote':'Each\x20new\x20payment\x20gets\x20individual\x20timers:\x201min,\x202min,\x207min,\x2012min,\x20then\x20hourly'}});}catch(_0xbb9b84){_0x27d421['status'](0x1f4)[_0x365bf0(0xf9)]({'success':![],'message':'Failed\x20to\x20get\x20CoinToPay\x20service\x20statistics'});}}),router[a19_0x111a95(0x111)]('/cointopay/payment/:paymentId',async(_0x57e5ea,_0x12a2af)=>{const _0x6fb3b=a19_0x111a95;try{const {paymentId:_0xe3ba71}=_0x57e5ea[_0x6fb3b(0x144)],_0x3de377=coinToPayStatusService_1[_0x6fb3b(0x122)]['getPaymentTimerInfo'](_0xe3ba71),_0xa7442d=(await Promise['resolve']()[_0x6fb3b(0x10e)](()=>__importStar(require('../config/database'))))[_0x6fb3b(0x106)],_0x26baf1=await _0xa7442d[_0x6fb3b(0x142)][_0x6fb3b(0x10d)]({'where':{'id':_0xe3ba71},'select':{'id':!![],'gateway':!![],'gatewayPaymentId':!![],'status':!![],'amount':!![],'currency':!![],'createdAt':!![],'updatedAt':!![],'shopId':!![],'shop':{'select':{'name':!![],'username':!![]}}}});if(!_0x26baf1)return _0x12a2af['status'](0x194)[_0x6fb3b(0xf9)]({'success':![],'message':_0x6fb3b(0xf4)});_0x12a2af[_0x6fb3b(0xf9)]({'success':!![],'result':{'payment':{'id':_0x26baf1['id'],'gateway':_0x26baf1[_0x6fb3b(0x139)],'gatewayPaymentId':_0x26baf1['gatewayPaymentId'],'status':_0x26baf1['status'],'amount':_0x26baf1[_0x6fb3b(0x169)],'currency':_0x26baf1['currency'],'createdAt':_0x26baf1[_0x6fb3b(0x130)],'updatedAt':_0x26baf1[_0x6fb3b(0x13d)],'shop':_0x26baf1[_0x6fb3b(0x165)]},'timers':_0x3de377,'isCoinToPay':_0x26baf1[_0x6fb3b(0x139)]==='cointopay','ageInMinutes':Math['floor']((Date['now']()-_0x26baf1['createdAt'][_0x6fb3b(0x168)]())/(0x3e8*0x3c))}});}catch(_0x131321){_0x12a2af[_0x6fb3b(0x13a)](0x1f4)['json']({'success':![],'message':_0x131321 instanceof Error?_0x131321[_0x6fb3b(0x11d)]:_0x6fb3b(0xfc)});}}),router[a19_0x111a95(0x111)](a19_0x111a95(0x12f),(_0x268657,_0x28b0ca)=>{const _0x27c808=a19_0x111a95;try{const _0x191198=domainMonitoringService_1[_0x27c808(0x125)][_0x27c808(0x162)]();_0x28b0ca[_0x27c808(0xf9)]({'success':!![],'result':{..._0x191198,'description':_0x27c808(0x129),'behavior':_0x27c808(0x138),'encoding':_0x27c808(0x124)}});}catch(_0x1a9b4c){_0x28b0ca['status'](0x1f4)[_0x27c808(0xf9)]({'success':![],'message':_0x27c808(0x108)});}}),router[a19_0x111a95(0x109)](a19_0x111a95(0x120),async(_0x5ae20b,_0x37c15a)=>{const _0x5f3716=a19_0x111a95;try{const _0x1fdfb2=await domainMonitoringService_1[_0x5f3716(0x125)][_0x5f3716(0x135)]();_0x37c15a[_0x5f3716(0xf9)]({'success':!![],'result':{'domainAvailable':_0x1fdfb2,'message':_0x1fdfb2?'Domain\x20is\x20responding\x20correctly':'Domain\x20check\x20failed','timestamp':new Date()[_0x5f3716(0x157)]()}});}catch(_0x383420){_0x37c15a[_0x5f3716(0x13a)](0x1f4)[_0x5f3716(0xf9)]({'success':![],'message':_0x383420 instanceof Error?_0x383420[_0x5f3716(0x11d)]:_0x5f3716(0x102)});}}),exports[a19_0x111a95(0x106)]=router;