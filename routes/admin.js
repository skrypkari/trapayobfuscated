'use strict';const a21_0x42fbf9=a21_0xbb64;(function(_0x4d85ce,_0x20c5dd){const _0x441973=a21_0xbb64,_0x45c834=_0x4d85ce();while(!![]){try{const _0x4680c6=parseInt(_0x441973(0x11d))/0x1+-parseInt(_0x441973(0xb8))/0x2+parseInt(_0x441973(0xe4))/0x3*(parseInt(_0x441973(0xb5))/0x4)+parseInt(_0x441973(0xf9))/0x5+parseInt(_0x441973(0xdb))/0x6+-parseInt(_0x441973(0x107))/0x7+parseInt(_0x441973(0xd4))/0x8*(-parseInt(_0x441973(0xf3))/0x9);if(_0x4680c6===_0x20c5dd)break;else _0x45c834['push'](_0x45c834['shift']());}catch(_0x379347){_0x45c834['push'](_0x45c834['shift']());}}}(a21_0x1f39,0xd364c));function a21_0x1f39(){const _0x389ae8=['Old\x20logs\x20cleaned\x20(kept\x20last\x20','getPayoutById','1518kSoeLZ','updatePayment','updateUserSchema','activateUser','__createBinding','expiryDays','gateway','Each\x20new\x20payment\x20gets\x20individual\x20timers:\x201min,\x202min,\x207min,\x2012min,\x20then\x20hourly','/statistics','create','createdAt','currency','post','getUsers','/payments/cleanup-pending','279765cLxxSN','getServiceStats','/users/:id/suspend','/payments','createPayout','deletePayout','6464615mZuXFf','\x20days\x20if\x20not\x20paid','getPaymentById','/merchant-statistics','üîç\x20[ADMIN]\x20Manual\x20CoinToPay\x20check\x20requested\x20for\x20payment:\x20','getMerchantsSelection','PAID','findUnique','createUser','Domain\x20check\x20failed','/payout','/logs/clean','createUserSchema','updateCustomerData','4252871qWPVtE','../controllers/adminController','Failed\x20to\x20get\x20log\x20statistics','/users/:id','EXPIRED','cleanupStalePendingPayments','updatedAt','Payment\x20not\x20found','domainMonitoringService','requireAdmin','../config/database','loggerService','Payments\x20automatically\x20expire\x20after\x20','Router','getStatistics','Requests\x20are\x20made\x20with\x20base64\x20encoded\x20URLs','createPayoutSchema','status','toISOString','/payments/cleanup','validate','getMerchantsAwaitingPayout','1430118wMHbka','/logs/stats','../services/loggerService','Failed\x20to\x20get\x20payment\x20information','updateCustomerDataSchema','getUserById','delete','prototype','length','/payments/:id','getMerchantStatistics','CoinToPay\x20automatic\x20status\x20checking\x20service','log','__importStar','/users','coinToPayStatusService','writable','FAILED','/cointopay/check/:paymentId','/domain-monitoring/check','getPayoutStats','error','Failed\x20to\x20get\x20domain\x20monitoring\x20statistics','‚ùå\x20[ADMIN]\x20Manual\x20CoinToPay\x20check\x20failed\x20for\x20payment\x20','2692gPHLwC','/domain-monitoring/stats','getPayments','206766OBHdbt','manualCheck','amount','body','/payments/:id/customer','deleteUser','call','__esModule','defineProperty','CoinToPay\x20payment\x20status\x20checked\x20successfully','getOwnPropertyDescriptor','cleanOldLogs','/auth','cleanupStalePaymentsWithReport','checkAuth','../services/domainMonitoringService','Server\x20crashes\x20if\x20domain\x20is\x20not\x20responding\x20after\x20consecutive\x20failures','getTime','configurable','json','/payments/cleanup-with-report','/cointopay/stats','Failed\x20to\x20perform\x20manual\x20domain\x20check','suspendUser','default','put','PENDING','/payouts','488SMSTxS','Domain\x20monitoring\x20service\x20for\x20amaterasy884.icu','params','Failed\x20to\x20check\x20CoinToPay\x20payment\x20status','use','paymentId','get','2456460xoALNC','message','/users/:id/activate','floor','Domain\x20is\x20responding\x20correctly','/payout/merchants','gatewayPaymentId'];a21_0x1f39=function(){return _0x389ae8;};return a21_0x1f39();}var __createBinding=this&&this[a21_0x42fbf9(0xe8)]||(Object[a21_0x42fbf9(0xed)]?function(_0x33bbef,_0x217242,_0x1b46fd,_0x16e6d6){const _0x40f3fd=a21_0x42fbf9;if(_0x16e6d6===undefined)_0x16e6d6=_0x1b46fd;var _0x55e3f5=Object[_0x40f3fd(0xc2)](_0x217242,_0x1b46fd);(!_0x55e3f5||(_0x40f3fd(0xda)in _0x55e3f5?!_0x217242[_0x40f3fd(0xbf)]:_0x55e3f5[_0x40f3fd(0xad)]||_0x55e3f5[_0x40f3fd(0xca)]))&&(_0x55e3f5={'enumerable':!![],'get':function(){return _0x217242[_0x1b46fd];}}),Object[_0x40f3fd(0xc0)](_0x33bbef,_0x16e6d6,_0x55e3f5);}:function(_0x238b16,_0xa38a9,_0x2e979f,_0x5dbf5d){if(_0x5dbf5d===undefined)_0x5dbf5d=_0x2e979f;_0x238b16[_0x5dbf5d]=_0xa38a9[_0x2e979f];}),__setModuleDefault=this&&this['__setModuleDefault']||(Object[a21_0x42fbf9(0xed)]?function(_0x1a6254,_0x65b058){const _0x901494=a21_0x42fbf9;Object[_0x901494(0xc0)](_0x1a6254,'default',{'enumerable':!![],'value':_0x65b058});}:function(_0x4fbda2,_0x223e49){const _0x35f63c=a21_0x42fbf9;_0x4fbda2[_0x35f63c(0xd0)]=_0x223e49;}),__importStar=this&&this[a21_0x42fbf9(0xaa)]||(function(){var _0x5eba5=function(_0xf6588e){return _0x5eba5=Object['getOwnPropertyNames']||function(_0xfcaba3){const _0x6f080e=a21_0xbb64;var _0x395f02=[];for(var _0xa053ad in _0xfcaba3)if(Object[_0x6f080e(0x124)]['hasOwnProperty'][_0x6f080e(0xbe)](_0xfcaba3,_0xa053ad))_0x395f02[_0x395f02[_0x6f080e(0x125)]]=_0xa053ad;return _0x395f02;},_0x5eba5(_0xf6588e);};return function(_0x417f3a){const _0xf5f3ba=a21_0xbb64;if(_0x417f3a&&_0x417f3a[_0xf5f3ba(0xbf)])return _0x417f3a;var _0x5ec23e={};if(_0x417f3a!=null){for(var _0xd63952=_0x5eba5(_0x417f3a),_0x14d49a=0x0;_0x14d49a<_0xd63952[_0xf5f3ba(0x125)];_0x14d49a++)if(_0xd63952[_0x14d49a]!==_0xf5f3ba(0xd0))__createBinding(_0x5ec23e,_0x417f3a,_0xd63952[_0x14d49a]);}return __setModuleDefault(_0x5ec23e,_0x417f3a),_0x5ec23e;};}());function a21_0xbb64(_0x4f4168,_0x2e0d4e){const _0x1f39b=a21_0x1f39();return a21_0xbb64=function(_0xbb64c1,_0x2755cd){_0xbb64c1=_0xbb64c1-0xaa;let _0x228622=_0x1f39b[_0xbb64c1];return _0x228622;},a21_0xbb64(_0x4f4168,_0x2e0d4e);}Object[a21_0x42fbf9(0xc0)](exports,a21_0x42fbf9(0xbf),{'value':!![]});const express_1=require('express'),adminController_1=require(a21_0x42fbf9(0x108)),validation_1=require('../middleware/validation'),auth_1=require('../middleware/auth'),loggerService_1=require(a21_0x42fbf9(0x11f)),coinToPayStatusService_1=require('../services/coinToPayStatusService'),domainMonitoringService_1=require(a21_0x42fbf9(0xc7)),router=(0x0,express_1[a21_0x42fbf9(0x114)])(),adminController=new adminController_1['AdminController']();router[a21_0x42fbf9(0xd8)](auth_1['authenticateToken'],auth_1[a21_0x42fbf9(0x110)]),router[a21_0x42fbf9(0xda)](a21_0x42fbf9(0xc4),adminController[a21_0x42fbf9(0xc6)]),router['get'](a21_0x42fbf9(0xec),adminController[a21_0x42fbf9(0x115)]),router[a21_0x42fbf9(0xda)](a21_0x42fbf9(0xfc),adminController[a21_0x42fbf9(0x127)]),router[a21_0x42fbf9(0xda)]('/payout/stats',adminController[a21_0x42fbf9(0xb1)]),router[a21_0x42fbf9(0xda)](a21_0x42fbf9(0xe0),adminController[a21_0x42fbf9(0x11c)]),router[a21_0x42fbf9(0xda)]('/merchants/selection',adminController[a21_0x42fbf9(0xfe)]),router[a21_0x42fbf9(0xf0)](a21_0x42fbf9(0x103),(0x0,validation_1[a21_0x42fbf9(0x11b)])(validation_1[a21_0x42fbf9(0x117)]),adminController[a21_0x42fbf9(0xf7)]),router[a21_0x42fbf9(0xda)](a21_0x42fbf9(0xd3),adminController['getPayouts']),router['get']('/payouts/:id',adminController[a21_0x42fbf9(0xe3)]),router[a21_0x42fbf9(0x123)]('/payouts/:id',adminController[a21_0x42fbf9(0xf8)]),router[a21_0x42fbf9(0xda)](a21_0x42fbf9(0xf6),adminController[a21_0x42fbf9(0xb7)]),router['get'](a21_0x42fbf9(0x126),adminController[a21_0x42fbf9(0xfb)]),router[a21_0x42fbf9(0xd1)]('/payments/:id',adminController[a21_0x42fbf9(0xe5)]),router['put'](a21_0x42fbf9(0xbc),(0x0,validation_1[a21_0x42fbf9(0x11b)])(validation_1[a21_0x42fbf9(0x121)]),adminController[a21_0x42fbf9(0x106)]),router[a21_0x42fbf9(0xda)]('/payments/processing-stats',adminController['getProcessingPaymentsStats']),router[a21_0x42fbf9(0xf0)](a21_0x42fbf9(0x11a),adminController['cleanupStalePayments']),router[a21_0x42fbf9(0xf0)](a21_0x42fbf9(0xf2),adminController[a21_0x42fbf9(0x10c)]),router[a21_0x42fbf9(0xf0)](a21_0x42fbf9(0xcc),adminController[a21_0x42fbf9(0xc5)]),router[a21_0x42fbf9(0xda)](a21_0x42fbf9(0xab),adminController[a21_0x42fbf9(0xf1)]),router[a21_0x42fbf9(0xda)](a21_0x42fbf9(0x10a),adminController[a21_0x42fbf9(0x122)]),router[a21_0x42fbf9(0xf0)](a21_0x42fbf9(0xab),(0x0,validation_1[a21_0x42fbf9(0x11b)])(validation_1[a21_0x42fbf9(0x105)]),adminController[a21_0x42fbf9(0x101)]),router['put'](a21_0x42fbf9(0x10a),(0x0,validation_1[a21_0x42fbf9(0x11b)])(validation_1[a21_0x42fbf9(0xe6)]),adminController['updateUser']),router['delete']('/users/:id',adminController[a21_0x42fbf9(0xbd)]),router[a21_0x42fbf9(0xf0)](a21_0x42fbf9(0xf5),adminController[a21_0x42fbf9(0xcf)]),router['post'](a21_0x42fbf9(0xdd),adminController[a21_0x42fbf9(0xe7)]),router['get'](a21_0x42fbf9(0x11e),(_0x4ee128,_0xcca0a3)=>{const _0x1fce95=a21_0x42fbf9;try{const _0x2c7578=loggerService_1[_0x1fce95(0x112)]['getLogStats']();_0xcca0a3[_0x1fce95(0xcb)]({'success':!![],'result':_0x2c7578});}catch(_0x2073c0){_0xcca0a3[_0x1fce95(0x118)](0x1f4)['json']({'success':![],'message':_0x1fce95(0x109)});}}),router['post'](a21_0x42fbf9(0x104),(_0x25a660,_0x1cb896)=>{const _0x2ad15e=a21_0x42fbf9;try{const {daysToKeep:daysToKeep=0x1e}=_0x25a660[_0x2ad15e(0xbb)];loggerService_1['loggerService'][_0x2ad15e(0xc3)](daysToKeep),_0x1cb896[_0x2ad15e(0xcb)]({'success':!![],'message':_0x2ad15e(0xe2)+daysToKeep+'\x20days)'});}catch(_0x346d3){_0x1cb896[_0x2ad15e(0x118)](0x1f4)[_0x2ad15e(0xcb)]({'success':![],'message':'Failed\x20to\x20clean\x20old\x20logs'});}}),router[a21_0x42fbf9(0xf0)](a21_0x42fbf9(0xaf),async(_0x23eae1,_0x11e6e3)=>{const _0x37f2d6=a21_0x42fbf9;try{const {paymentId:_0x191bc8}=_0x23eae1[_0x37f2d6(0xd6)];console[_0x37f2d6(0x129)](_0x37f2d6(0xfd)+_0x191bc8),await coinToPayStatusService_1[_0x37f2d6(0xac)]['checkPaymentById'](_0x191bc8),_0x11e6e3['json']({'success':!![],'message':_0x37f2d6(0xc1)});}catch(_0x566934){console[_0x37f2d6(0xb2)](_0x37f2d6(0xb4)+_0x23eae1['params'][_0x37f2d6(0xd9)]+':',_0x566934),_0x11e6e3['status'](0x1f4)[_0x37f2d6(0xcb)]({'success':![],'message':_0x566934 instanceof Error?_0x566934[_0x37f2d6(0xdc)]:_0x37f2d6(0xd7)});}}),router['get'](a21_0x42fbf9(0xcd),(_0x22e2fb,_0x31d531)=>{const _0x766017=a21_0x42fbf9;try{const _0x4c20a5=coinToPayStatusService_1[_0x766017(0xac)][_0x766017(0xf4)]();_0x31d531[_0x766017(0xcb)]({'success':!![],'result':{..._0x4c20a5,'description':_0x766017(0x128),'statusMapping':{'Paid':_0x766017(0xff),'Awaiting\x20Fiat':'PENDING','waiting':_0x766017(0xd2),'expired':_0x766017(0x10b),'failed':_0x766017(0xae)},'autoExpiryNote':_0x766017(0x113)+_0x4c20a5[_0x766017(0xe9)]+_0x766017(0xfa),'individualTimersNote':_0x766017(0xeb)}});}catch(_0xeca3a8){_0x31d531[_0x766017(0x118)](0x1f4)[_0x766017(0xcb)]({'success':![],'message':'Failed\x20to\x20get\x20CoinToPay\x20service\x20statistics'});}}),router['get']('/cointopay/payment/:paymentId',async(_0x3fdffe,_0x194b9d)=>{const _0xeb7663=a21_0x42fbf9;try{const {paymentId:_0x41a5d7}=_0x3fdffe['params'],_0x4d8323=coinToPayStatusService_1[_0xeb7663(0xac)]['getPaymentTimerInfo'](_0x41a5d7),_0x1ff41e=(await Promise['resolve']()['then'](()=>__importStar(require(_0xeb7663(0x111)))))[_0xeb7663(0xd0)],_0x31123c=await _0x1ff41e['payment'][_0xeb7663(0x100)]({'where':{'id':_0x41a5d7},'select':{'id':!![],'gateway':!![],'gatewayPaymentId':!![],'status':!![],'amount':!![],'currency':!![],'createdAt':!![],'updatedAt':!![],'shopId':!![],'shop':{'select':{'name':!![],'username':!![]}}}});if(!_0x31123c)return _0x194b9d['status'](0x194)[_0xeb7663(0xcb)]({'success':![],'message':_0xeb7663(0x10e)});_0x194b9d[_0xeb7663(0xcb)]({'success':!![],'result':{'payment':{'id':_0x31123c['id'],'gateway':_0x31123c[_0xeb7663(0xea)],'gatewayPaymentId':_0x31123c[_0xeb7663(0xe1)],'status':_0x31123c[_0xeb7663(0x118)],'amount':_0x31123c[_0xeb7663(0xba)],'currency':_0x31123c[_0xeb7663(0xef)],'createdAt':_0x31123c[_0xeb7663(0xee)],'updatedAt':_0x31123c[_0xeb7663(0x10d)],'shop':_0x31123c['shop']},'timers':_0x4d8323,'isCoinToPay':_0x31123c[_0xeb7663(0xea)]==='cointopay','ageInMinutes':Math[_0xeb7663(0xde)]((Date['now']()-_0x31123c[_0xeb7663(0xee)][_0xeb7663(0xc9)]())/(0x3e8*0x3c))}});}catch(_0x18002f){_0x194b9d[_0xeb7663(0x118)](0x1f4)[_0xeb7663(0xcb)]({'success':![],'message':_0x18002f instanceof Error?_0x18002f[_0xeb7663(0xdc)]:_0xeb7663(0x120)});}}),router['get'](a21_0x42fbf9(0xb6),(_0x12f384,_0x4a4e14)=>{const _0x20fe0d=a21_0x42fbf9;try{const _0x229343=domainMonitoringService_1[_0x20fe0d(0x10f)]['getMonitoringStats']();_0x4a4e14[_0x20fe0d(0xcb)]({'success':!![],'result':{..._0x229343,'description':_0x20fe0d(0xd5),'behavior':_0x20fe0d(0xc8),'encoding':_0x20fe0d(0x116)}});}catch(_0x39073c){_0x4a4e14['status'](0x1f4)[_0x20fe0d(0xcb)]({'success':![],'message':_0x20fe0d(0xb3)});}}),router[a21_0x42fbf9(0xf0)](a21_0x42fbf9(0xb0),async(_0xf6ae1c,_0x4bdd2a)=>{const _0x301f39=a21_0x42fbf9;try{const _0x43588b=await domainMonitoringService_1[_0x301f39(0x10f)][_0x301f39(0xb9)]();_0x4bdd2a['json']({'success':!![],'result':{'domainAvailable':_0x43588b,'message':_0x43588b?_0x301f39(0xdf):_0x301f39(0x102),'timestamp':new Date()[_0x301f39(0x119)]()}});}catch(_0x140a24){_0x4bdd2a[_0x301f39(0x118)](0x1f4)[_0x301f39(0xcb)]({'success':![],'message':_0x140a24 instanceof Error?_0x140a24[_0x301f39(0xdc)]:_0x301f39(0xce)});}}),exports[a21_0x42fbf9(0xd0)]=router;