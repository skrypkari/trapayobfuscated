'use strict';function a24_0x3401(_0xbe5bda,_0x5eadcf){_0xbe5bda=_0xbe5bda-0xb7;const _0x470c05=a24_0x470c();let _0x340110=_0x470c05[_0xbe5bda];return _0x340110;}function a24_0x470c(){const _0x4db1ec=['createPayoutSchema','getOwnPropertyDescriptor','/cointopay/stats','coinToPayStatusService','paymentId','findUnique','checkAuth','3203319vDwLFX','/logs/clean','floor','/merchants/selection','10vWVsXD','/payout/stats','domainMonitoringService','Server\x20crashes\x20if\x20domain\x20is\x20not\x20responding\x20after\x20consecutive\x20failures','configurable','toISOString','PAID','../middleware/validation','Domain\x20is\x20responding\x20correctly','/domain-monitoring/check','getPayouts','createPayout','updatePayment','updateUser','cleanOldLogs','currency','put','EXPIRED','__importStar','updateCustomerDataSchema','cleanupStalePayments','authenticateToken','default','/payouts/:id','deletePayout','/logs/stats','../controllers/adminController','PENDING','post','../services/domainMonitoringService','/payout/merchants','/payments/:id','hasOwnProperty','7731999Extkzw','Failed\x20to\x20perform\x20manual\x20domain\x20check','checkPaymentById','/users/:id','24ynUQPi','FAILED','getPayoutStats','updateUserSchema','getPaymentById','now','/payments/cleanup-with-report','/users/:id/suspend','/users','cointopay','createUserSchema','5smNomo','Failed\x20to\x20get\x20payment\x20information','getOwnPropertyNames','10821414NXyttr','Failed\x20to\x20get\x20CoinToPay\x20service\x20statistics','updateCustomerData','/merchant-statistics','delete','writable','\x20days\x20if\x20not\x20paid','getMerchantStatistics','use','expiryDays','__setModuleDefault','AdminController','/payouts','message','requireAdmin','Payments\x20automatically\x20expire\x20after\x20','body','__esModule','/payout','\x20days)','Payment\x20not\x20found','../services/loggerService','createdAt','getPaymentTimerInfo','activateUser','manualCheck','67042NskkHB','resolve','create','status','/payments','Requests\x20are\x20made\x20with\x20base64\x20encoded\x20URLs','3159057OPCadA','Each\x20new\x20payment\x20gets\x20individual\x20timers:\x201min,\x202min,\x207min,\x2012min,\x20then\x20hourly','defineProperty','suspendUser','/payments/cleanup','getLogStats','/statistics','getPayoutById','getPayments','41144508PfvXWg','../config/database','CoinToPay\x20payment\x20status\x20checked\x20successfully','gateway','getUserById','Router','getMerchantsAwaitingPayout','/cointopay/payment/:paymentId','log','json','length','getServiceStats','getUsers','getMerchantsSelection','833397fhXUXI','__createBinding','getProcessingPaymentsStats','validate','deleteUser','cleanupStalePaymentsWithReport','get','/payments/cleanup-pending','1LunStd','/auth','call','loggerService','error','32LmDoXL','Domain\x20check\x20failed','Old\x20logs\x20cleaned\x20(kept\x20last\x20','‚ùå\x20[ADMIN]\x20Manual\x20CoinToPay\x20check\x20failed\x20for\x20payment\x20','getStatistics','params'];a24_0x470c=function(){return _0x4db1ec;};return a24_0x470c();}const a24_0xfed9f3=a24_0x3401;(function(_0x17d9cb,_0x752de4){const _0x4262f8=a24_0x3401,_0x207f5b=_0x17d9cb();while(!![]){try{const _0x4fd93f=-parseInt(_0x4262f8(0x13c))/0x1*(-parseInt(_0x4262f8(0x117))/0x2)+parseInt(_0x4262f8(0x134))/0x3*(parseInt(_0x4262f8(0xef))/0x4)+parseInt(_0x4262f8(0xfa))/0x5*(-parseInt(_0x4262f8(0xfd))/0x6)+-parseInt(_0x4262f8(0xc6))/0x7*(parseInt(_0x4262f8(0xb9))/0x8)+-parseInt(_0x4262f8(0xeb))/0x9*(parseInt(_0x4262f8(0xca))/0xa)+parseInt(_0x4262f8(0x11d))/0xb+parseInt(_0x4262f8(0x126))/0xc;if(_0x4fd93f===_0x752de4)break;else _0x207f5b['push'](_0x207f5b['shift']());}catch(_0x53d9eb){_0x207f5b['push'](_0x207f5b['shift']());}}}(a24_0x470c,0xe15b7));var __createBinding=this&&this[a24_0xfed9f3(0x135)]||(Object[a24_0xfed9f3(0x119)]?function(_0x5abd5d,_0x4c92a8,_0xc1c1ea,_0x50abce){const _0x45e206=a24_0xfed9f3;if(_0x50abce===undefined)_0x50abce=_0xc1c1ea;var _0x4ca698=Object[_0x45e206(0xc0)](_0x4c92a8,_0xc1c1ea);(!_0x4ca698||(_0x45e206(0x13a)in _0x4ca698?!_0x4c92a8[_0x45e206(0x10e)]:_0x4ca698[_0x45e206(0x102)]||_0x4ca698[_0x45e206(0xce)]))&&(_0x4ca698={'enumerable':!![],'get':function(){return _0x4c92a8[_0xc1c1ea];}}),Object['defineProperty'](_0x5abd5d,_0x50abce,_0x4ca698);}:function(_0x9031ad,_0x560669,_0xe61db6,_0x4a4725){if(_0x4a4725===undefined)_0x4a4725=_0xe61db6;_0x9031ad[_0x4a4725]=_0x560669[_0xe61db6];}),__setModuleDefault=this&&this[a24_0xfed9f3(0x107)]||(Object[a24_0xfed9f3(0x119)]?function(_0x4e8801,_0x469209){const _0x502483=a24_0xfed9f3;Object[_0x502483(0x11f)](_0x4e8801,'default',{'enumerable':!![],'value':_0x469209});}:function(_0xf15dfc,_0x3d1354){const _0x207f5c=a24_0xfed9f3;_0xf15dfc[_0x207f5c(0xe0)]=_0x3d1354;}),__importStar=this&&this[a24_0xfed9f3(0xdc)]||(function(){var _0x4965be=function(_0x4a229e){const _0x388062=a24_0x3401;return _0x4965be=Object[_0x388062(0xfc)]||function(_0x57b1f7){const _0x2a8293=_0x388062;var _0x3b9511=[];for(var _0x25c298 in _0x57b1f7)if(Object['prototype'][_0x2a8293(0xea)][_0x2a8293(0x13e)](_0x57b1f7,_0x25c298))_0x3b9511[_0x3b9511[_0x2a8293(0x130)]]=_0x25c298;return _0x3b9511;},_0x4965be(_0x4a229e);};return function(_0x226708){const _0x480cdf=a24_0x3401;if(_0x226708&&_0x226708[_0x480cdf(0x10e)])return _0x226708;var _0x3e39d2={};if(_0x226708!=null){for(var _0x15d1f1=_0x4965be(_0x226708),_0x2572b7=0x0;_0x2572b7<_0x15d1f1[_0x480cdf(0x130)];_0x2572b7++)if(_0x15d1f1[_0x2572b7]!==_0x480cdf(0xe0))__createBinding(_0x3e39d2,_0x226708,_0x15d1f1[_0x2572b7]);}return __setModuleDefault(_0x3e39d2,_0x226708),_0x3e39d2;};}());Object[a24_0xfed9f3(0x11f)](exports,a24_0xfed9f3(0x10e),{'value':!![]});const express_1=require('express'),adminController_1=require(a24_0xfed9f3(0xe4)),validation_1=require(a24_0xfed9f3(0xd1)),auth_1=require('../middleware/auth'),loggerService_1=require(a24_0xfed9f3(0x112)),coinToPayStatusService_1=require('../services/coinToPayStatusService'),domainMonitoringService_1=require(a24_0xfed9f3(0xe7)),router=(0x0,express_1[a24_0xfed9f3(0x12b)])(),adminController=new adminController_1[(a24_0xfed9f3(0x108))]();router[a24_0xfed9f3(0x105)](auth_1[a24_0xfed9f3(0xdf)],auth_1[a24_0xfed9f3(0x10b)]),router[a24_0xfed9f3(0x13a)](a24_0xfed9f3(0x13d),adminController[a24_0xfed9f3(0xc5)]),router[a24_0xfed9f3(0x13a)](a24_0xfed9f3(0x123),adminController[a24_0xfed9f3(0xbd)]),router[a24_0xfed9f3(0x13a)](a24_0xfed9f3(0x100),adminController[a24_0xfed9f3(0x104)]),router[a24_0xfed9f3(0x13a)](a24_0xfed9f3(0xcb),adminController[a24_0xfed9f3(0xf1)]),router[a24_0xfed9f3(0x13a)](a24_0xfed9f3(0xe8),adminController[a24_0xfed9f3(0x12c)]),router[a24_0xfed9f3(0x13a)](a24_0xfed9f3(0xc9),adminController[a24_0xfed9f3(0x133)]),router[a24_0xfed9f3(0xe6)](a24_0xfed9f3(0x10f),(0x0,validation_1[a24_0xfed9f3(0x137)])(validation_1[a24_0xfed9f3(0xbf)]),adminController[a24_0xfed9f3(0xd5)]),router['get'](a24_0xfed9f3(0x109),adminController[a24_0xfed9f3(0xd4)]),router['get'](a24_0xfed9f3(0xe1),adminController[a24_0xfed9f3(0x124)]),router[a24_0xfed9f3(0x101)](a24_0xfed9f3(0xe1),adminController[a24_0xfed9f3(0xe2)]),router[a24_0xfed9f3(0x13a)](a24_0xfed9f3(0x11b),adminController[a24_0xfed9f3(0x125)]),router[a24_0xfed9f3(0x13a)](a24_0xfed9f3(0xe9),adminController[a24_0xfed9f3(0xf3)]),router[a24_0xfed9f3(0xda)](a24_0xfed9f3(0xe9),adminController[a24_0xfed9f3(0xd6)]),router[a24_0xfed9f3(0xda)]('/payments/:id/customer',(0x0,validation_1['validate'])(validation_1[a24_0xfed9f3(0xdd)]),adminController[a24_0xfed9f3(0xff)]),router[a24_0xfed9f3(0x13a)]('/payments/processing-stats',adminController[a24_0xfed9f3(0x136)]),router['post'](a24_0xfed9f3(0x121),adminController[a24_0xfed9f3(0xde)]),router[a24_0xfed9f3(0xe6)](a24_0xfed9f3(0x13b),adminController['cleanupStalePendingPayments']),router[a24_0xfed9f3(0xe6)](a24_0xfed9f3(0xf5),adminController[a24_0xfed9f3(0x139)]),router[a24_0xfed9f3(0x13a)](a24_0xfed9f3(0xf7),adminController[a24_0xfed9f3(0x132)]),router[a24_0xfed9f3(0x13a)](a24_0xfed9f3(0xee),adminController[a24_0xfed9f3(0x12a)]),router['post'](a24_0xfed9f3(0xf7),(0x0,validation_1[a24_0xfed9f3(0x137)])(validation_1[a24_0xfed9f3(0xf9)]),adminController['createUser']),router[a24_0xfed9f3(0xda)](a24_0xfed9f3(0xee),(0x0,validation_1[a24_0xfed9f3(0x137)])(validation_1[a24_0xfed9f3(0xf2)]),adminController[a24_0xfed9f3(0xd7)]),router['delete'](a24_0xfed9f3(0xee),adminController[a24_0xfed9f3(0x138)]),router[a24_0xfed9f3(0xe6)](a24_0xfed9f3(0xf6),adminController[a24_0xfed9f3(0x120)]),router[a24_0xfed9f3(0xe6)]('/users/:id/activate',adminController[a24_0xfed9f3(0x115)]),router[a24_0xfed9f3(0x13a)](a24_0xfed9f3(0xe3),(_0x1b5231,_0x5643e8)=>{const _0x2a62bb=a24_0xfed9f3;try{const _0x42578d=loggerService_1[_0x2a62bb(0xb7)][_0x2a62bb(0x122)]();_0x5643e8[_0x2a62bb(0x12f)]({'success':!![],'result':_0x42578d});}catch(_0x58b535){_0x5643e8[_0x2a62bb(0x11a)](0x1f4)[_0x2a62bb(0x12f)]({'success':![],'message':'Failed\x20to\x20get\x20log\x20statistics'});}}),router[a24_0xfed9f3(0xe6)](a24_0xfed9f3(0xc7),(_0x2ab430,_0x12fcd7)=>{const _0x2c2ab6=a24_0xfed9f3;try{const {daysToKeep:daysToKeep=0x1e}=_0x2ab430[_0x2c2ab6(0x10d)];loggerService_1['loggerService'][_0x2c2ab6(0xd8)](daysToKeep),_0x12fcd7[_0x2c2ab6(0x12f)]({'success':!![],'message':_0x2c2ab6(0xbb)+daysToKeep+_0x2c2ab6(0x110)});}catch(_0x3749db){_0x12fcd7[_0x2c2ab6(0x11a)](0x1f4)[_0x2c2ab6(0x12f)]({'success':![],'message':'Failed\x20to\x20clean\x20old\x20logs'});}}),router[a24_0xfed9f3(0xe6)]('/cointopay/check/:paymentId',async(_0x501e49,_0x21d7fc)=>{const _0x19a8bb=a24_0xfed9f3;try{const {paymentId:_0x5352f6}=_0x501e49[_0x19a8bb(0xbe)];console[_0x19a8bb(0x12e)]('üîç\x20[ADMIN]\x20Manual\x20CoinToPay\x20check\x20requested\x20for\x20payment:\x20'+_0x5352f6),await coinToPayStatusService_1[_0x19a8bb(0xc2)][_0x19a8bb(0xed)](_0x5352f6),_0x21d7fc[_0x19a8bb(0x12f)]({'success':!![],'message':_0x19a8bb(0x128)});}catch(_0x54c73d){console[_0x19a8bb(0xb8)](_0x19a8bb(0xbc)+_0x501e49[_0x19a8bb(0xbe)][_0x19a8bb(0xc3)]+':',_0x54c73d),_0x21d7fc[_0x19a8bb(0x11a)](0x1f4)[_0x19a8bb(0x12f)]({'success':![],'message':_0x54c73d instanceof Error?_0x54c73d[_0x19a8bb(0x10a)]:'Failed\x20to\x20check\x20CoinToPay\x20payment\x20status'});}}),router[a24_0xfed9f3(0x13a)](a24_0xfed9f3(0xc1),(_0x598762,_0x4ff791)=>{const _0x16f818=a24_0xfed9f3;try{const _0x391056=coinToPayStatusService_1[_0x16f818(0xc2)][_0x16f818(0x131)]();_0x4ff791[_0x16f818(0x12f)]({'success':!![],'result':{..._0x391056,'description':'CoinToPay\x20automatic\x20status\x20checking\x20service','statusMapping':{'Paid':_0x16f818(0xd0),'Awaiting\x20Fiat':_0x16f818(0xe5),'waiting':_0x16f818(0xe5),'expired':_0x16f818(0xdb),'failed':_0x16f818(0xf0)},'autoExpiryNote':_0x16f818(0x10c)+_0x391056[_0x16f818(0x106)]+_0x16f818(0x103),'individualTimersNote':_0x16f818(0x11e)}});}catch(_0x5be403){_0x4ff791[_0x16f818(0x11a)](0x1f4)[_0x16f818(0x12f)]({'success':![],'message':_0x16f818(0xfe)});}}),router[a24_0xfed9f3(0x13a)](a24_0xfed9f3(0x12d),async(_0x5f0674,_0x19fc80)=>{const _0x2944ce=a24_0xfed9f3;try{const {paymentId:_0x390bb3}=_0x5f0674[_0x2944ce(0xbe)],_0x4066f1=coinToPayStatusService_1[_0x2944ce(0xc2)][_0x2944ce(0x114)](_0x390bb3),_0x8e4349=(await Promise[_0x2944ce(0x118)]()['then'](()=>__importStar(require(_0x2944ce(0x127)))))[_0x2944ce(0xe0)],_0x27684e=await _0x8e4349['payment'][_0x2944ce(0xc4)]({'where':{'id':_0x390bb3},'select':{'id':!![],'gateway':!![],'gatewayPaymentId':!![],'status':!![],'amount':!![],'currency':!![],'createdAt':!![],'updatedAt':!![],'shopId':!![],'shop':{'select':{'name':!![],'username':!![]}}}});if(!_0x27684e)return _0x19fc80[_0x2944ce(0x11a)](0x194)[_0x2944ce(0x12f)]({'success':![],'message':_0x2944ce(0x111)});_0x19fc80['json']({'success':!![],'result':{'payment':{'id':_0x27684e['id'],'gateway':_0x27684e[_0x2944ce(0x129)],'gatewayPaymentId':_0x27684e['gatewayPaymentId'],'status':_0x27684e[_0x2944ce(0x11a)],'amount':_0x27684e['amount'],'currency':_0x27684e[_0x2944ce(0xd9)],'createdAt':_0x27684e[_0x2944ce(0x113)],'updatedAt':_0x27684e['updatedAt'],'shop':_0x27684e['shop']},'timers':_0x4066f1,'isCoinToPay':_0x27684e[_0x2944ce(0x129)]===_0x2944ce(0xf8),'ageInMinutes':Math[_0x2944ce(0xc8)]((Date[_0x2944ce(0xf4)]()-_0x27684e[_0x2944ce(0x113)]['getTime']())/(0x3e8*0x3c))}});}catch(_0x47443a){_0x19fc80['status'](0x1f4)[_0x2944ce(0x12f)]({'success':![],'message':_0x47443a instanceof Error?_0x47443a[_0x2944ce(0x10a)]:_0x2944ce(0xfb)});}}),router[a24_0xfed9f3(0x13a)]('/domain-monitoring/stats',(_0x54b42f,_0x375cba)=>{const _0x45211a=a24_0xfed9f3;try{const _0x53fc72=domainMonitoringService_1[_0x45211a(0xcc)]['getMonitoringStats']();_0x375cba['json']({'success':!![],'result':{..._0x53fc72,'description':'Domain\x20monitoring\x20service\x20for\x20amaterasy884.icu','behavior':_0x45211a(0xcd),'encoding':_0x45211a(0x11c)}});}catch(_0x592c0d){_0x375cba[_0x45211a(0x11a)](0x1f4)[_0x45211a(0x12f)]({'success':![],'message':'Failed\x20to\x20get\x20domain\x20monitoring\x20statistics'});}}),router[a24_0xfed9f3(0xe6)](a24_0xfed9f3(0xd3),async(_0x56e94c,_0x5eb8f2)=>{const _0x468592=a24_0xfed9f3;try{const _0x20521e=await domainMonitoringService_1[_0x468592(0xcc)][_0x468592(0x116)]();_0x5eb8f2[_0x468592(0x12f)]({'success':!![],'result':{'domainAvailable':_0x20521e,'message':_0x20521e?_0x468592(0xd2):_0x468592(0xba),'timestamp':new Date()[_0x468592(0xcf)]()}});}catch(_0x2f2480){_0x5eb8f2['status'](0x1f4)['json']({'success':![],'message':_0x2f2480 instanceof Error?_0x2f2480['message']:_0x468592(0xec)});}}),exports[a24_0xfed9f3(0xe0)]=router;