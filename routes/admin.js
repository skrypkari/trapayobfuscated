'use strict';const a18_0x21efea=a18_0x16ec;(function(_0x4eb59d,_0x490367){const _0x56f7f8=a18_0x16ec,_0x2b28fa=_0x4eb59d();while(!![]){try{const _0x2cff3f=-parseInt(_0x56f7f8(0x1d1))/0x1+parseInt(_0x56f7f8(0x1c8))/0x2+parseInt(_0x56f7f8(0x1cc))/0x3*(parseInt(_0x56f7f8(0x1d9))/0x4)+-parseInt(_0x56f7f8(0x1fe))/0x5+-parseInt(_0x56f7f8(0x1fb))/0x6*(-parseInt(_0x56f7f8(0x21e))/0x7)+parseInt(_0x56f7f8(0x1b7))/0x8*(-parseInt(_0x56f7f8(0x1e1))/0x9)+parseInt(_0x56f7f8(0x21a))/0xa*(parseInt(_0x56f7f8(0x215))/0xb);if(_0x2cff3f===_0x490367)break;else _0x2b28fa['push'](_0x2b28fa['shift']());}catch(_0x150795){_0x2b28fa['push'](_0x2b28fa['shift']());}}}(a18_0x3711,0x3d033));var __createBinding=this&&this[a18_0x21efea(0x1bf)]||(Object[a18_0x21efea(0x1ee)]?function(_0x506375,_0x4eda55,_0x1faa46,_0x363006){const _0x33b92c=a18_0x21efea;if(_0x363006===undefined)_0x363006=_0x1faa46;var _0x2fd1c2=Object[_0x33b92c(0x227)](_0x4eda55,_0x1faa46);(!_0x2fd1c2||(_0x33b92c(0x1e5)in _0x2fd1c2?!_0x4eda55[_0x33b92c(0x204)]:_0x2fd1c2[_0x33b92c(0x210)]||_0x2fd1c2[_0x33b92c(0x206)]))&&(_0x2fd1c2={'enumerable':!![],'get':function(){return _0x4eda55[_0x1faa46];}}),Object['defineProperty'](_0x506375,_0x363006,_0x2fd1c2);}:function(_0x46ba98,_0x412ec6,_0x4375e5,_0x5ada5c){if(_0x5ada5c===undefined)_0x5ada5c=_0x4375e5;_0x46ba98[_0x5ada5c]=_0x412ec6[_0x4375e5];}),__setModuleDefault=this&&this[a18_0x21efea(0x1b9)]||(Object['create']?function(_0x895cdc,_0x3f9662){const _0x3d634e=a18_0x21efea;Object['defineProperty'](_0x895cdc,_0x3d634e(0x205),{'enumerable':!![],'value':_0x3f9662});}:function(_0x1d1a7d,_0x26bb4a){const _0x366449=a18_0x21efea;_0x1d1a7d[_0x366449(0x205)]=_0x26bb4a;}),__importStar=this&&this['__importStar']||(function(){var _0x3ee708=function(_0x11fa27){const _0x25b487=a18_0x16ec;return _0x3ee708=Object[_0x25b487(0x225)]||function(_0x5de382){var _0x204e51=[];for(var _0x5a39a3 in _0x5de382)if(Object['prototype']['hasOwnProperty']['call'](_0x5de382,_0x5a39a3))_0x204e51[_0x204e51['length']]=_0x5a39a3;return _0x204e51;},_0x3ee708(_0x11fa27);};return function(_0x4d18cd){const _0x5470d9=a18_0x16ec;if(_0x4d18cd&&_0x4d18cd[_0x5470d9(0x204)])return _0x4d18cd;var _0x13ca5a={};if(_0x4d18cd!=null){for(var _0x1ab682=_0x3ee708(_0x4d18cd),_0x54ef2f=0x0;_0x54ef2f<_0x1ab682['length'];_0x54ef2f++)if(_0x1ab682[_0x54ef2f]!==_0x5470d9(0x205))__createBinding(_0x13ca5a,_0x4d18cd,_0x1ab682[_0x54ef2f]);}return __setModuleDefault(_0x13ca5a,_0x4d18cd),_0x13ca5a;};}());function a18_0x3711(){const _0x3e448f=['getPayoutById','/users/:id/activate','271300ylOJJI','getTime','domainMonitoringService','Failed\x20to\x20get\x20payment\x20information','7urwfvH','Failed\x20to\x20get\x20domain\x20monitoring\x20statistics','currency','/merchant-statistics','/payout','/cointopay/stats','use','getOwnPropertyNames','AdminController','getOwnPropertyDescriptor','/auth','16nKjQJL','coinToPayStatusService','__setModuleDefault','toISOString','getMerchantsAwaitingPayout','/logs/clean','getPaymentById','/users/:id/suspend','__createBinding','status','getMerchantStatistics','../services/loggerService','loggerService','authenticateToken','deletePayout','checkPaymentById','/payout/merchants','253718IZLSAp','\x20days)','../config/database','Domain\x20monitoring\x20service\x20for\x20amaterasy884.icu','15cBFEGP','EXPIRED','/domain-monitoring/check','expiryDays','getMonitoringStats','409241vFcZCR','Domain\x20check\x20failed','/payments','FAILED','message','suspendUser','../middleware/auth','PAID','10988nwDSSj','CoinToPay\x20automatic\x20status\x20checking\x20service','Failed\x20to\x20get\x20log\x20statistics','\x20days\x20if\x20not\x20paid','params','/payouts/:id','amount','gateway','800577Hvdhbc','createdAt','getLogStats','Domain\x20is\x20responding\x20correctly','get','paymentId','delete','manualCheck','requireAdmin','/payout/stats','âŒ\x20[ADMIN]\x20Manual\x20CoinToPay\x20check\x20failed\x20for\x20payment\x20','floor','cointopay','create','CoinToPay\x20payment\x20status\x20checked\x20successfully','../controllers/adminController','Failed\x20to\x20check\x20CoinToPay\x20payment\x20status','Payment\x20not\x20found','/cointopay/payment/:paymentId','/users/:id','../services/coinToPayStatusService','getUserById','findUnique','/cointopay/check/:paymentId','Failed\x20to\x20clean\x20old\x20logs','ðŸ”\x20[ADMIN]\x20Manual\x20CoinToPay\x20check\x20requested\x20for\x20payment:\x20','1952754yHUgRB','PENDING','Failed\x20to\x20get\x20CoinToPay\x20service\x20statistics','2078845sfDUpk','put','body','getPayouts','createUserSchema','createUser','__esModule','default','configurable','/users','payment','deleteUser','/logs/stats','shop','getPaymentTimerInfo','createPayout','../middleware/validation','json','writable','Payments\x20automatically\x20expire\x20after\x20','defineProperty','gatewayPaymentId','/payments/:id','319etTMDq','post','Failed\x20to\x20perform\x20manual\x20domain\x20check'];a18_0x3711=function(){return _0x3e448f;};return a18_0x3711();}Object[a18_0x21efea(0x212)](exports,a18_0x21efea(0x204),{'value':!![]});function a18_0x16ec(_0x41cb1d,_0x87d813){const _0x3711b0=a18_0x3711();return a18_0x16ec=function(_0x16ec3e,_0x220fa8){_0x16ec3e=_0x16ec3e-0x1b6;let _0x173ab9=_0x3711b0[_0x16ec3e];return _0x173ab9;},a18_0x16ec(_0x41cb1d,_0x87d813);}const express_1=require('express'),adminController_1=require(a18_0x21efea(0x1f0)),validation_1=require(a18_0x21efea(0x20e)),auth_1=require(a18_0x21efea(0x1d7)),loggerService_1=require(a18_0x21efea(0x1c2)),coinToPayStatusService_1=require(a18_0x21efea(0x1f5)),domainMonitoringService_1=require('../services/domainMonitoringService'),router=(0x0,express_1['Router'])(),adminController=new adminController_1[(a18_0x21efea(0x226))]();router[a18_0x21efea(0x224)](auth_1[a18_0x21efea(0x1c4)],auth_1[a18_0x21efea(0x1e9)]),router[a18_0x21efea(0x1e5)](a18_0x21efea(0x1b6),adminController['checkAuth']),router['get']('/statistics',adminController['getStatistics']),router[a18_0x21efea(0x1e5)](a18_0x21efea(0x221),adminController[a18_0x21efea(0x1c1)]),router[a18_0x21efea(0x1e5)](a18_0x21efea(0x1ea),adminController['getPayoutStats']),router[a18_0x21efea(0x1e5)](a18_0x21efea(0x1c7),adminController[a18_0x21efea(0x1bb)]),router[a18_0x21efea(0x216)](a18_0x21efea(0x222),(0x0,validation_1['validate'])(validation_1['createPayoutSchema']),adminController[a18_0x21efea(0x20d)]),router[a18_0x21efea(0x1e5)]('/payouts',adminController[a18_0x21efea(0x201)]),router[a18_0x21efea(0x1e5)](a18_0x21efea(0x1de),adminController[a18_0x21efea(0x218)]),router[a18_0x21efea(0x1e7)](a18_0x21efea(0x1de),adminController[a18_0x21efea(0x1c5)]),router[a18_0x21efea(0x1e5)](a18_0x21efea(0x1d3),adminController['getPayments']),router['get'](a18_0x21efea(0x214),adminController[a18_0x21efea(0x1bd)]),router[a18_0x21efea(0x1ff)]('/payments/:id',adminController['updatePayment']),router[a18_0x21efea(0x1e5)](a18_0x21efea(0x207),adminController['getUsers']),router[a18_0x21efea(0x1e5)]('/users/:id',adminController[a18_0x21efea(0x1f6)]),router[a18_0x21efea(0x216)](a18_0x21efea(0x207),(0x0,validation_1['validate'])(validation_1[a18_0x21efea(0x202)]),adminController[a18_0x21efea(0x203)]),router[a18_0x21efea(0x1ff)](a18_0x21efea(0x1f4),(0x0,validation_1['validate'])(validation_1['updateUserSchema']),adminController['updateUser']),router[a18_0x21efea(0x1e7)](a18_0x21efea(0x1f4),adminController[a18_0x21efea(0x209)]),router[a18_0x21efea(0x216)](a18_0x21efea(0x1be),adminController[a18_0x21efea(0x1d6)]),router[a18_0x21efea(0x216)](a18_0x21efea(0x219),adminController['activateUser']),router[a18_0x21efea(0x1e5)](a18_0x21efea(0x20a),(_0x56f4e9,_0xc2e38f)=>{const _0x1d28ed=a18_0x21efea;try{const _0x355891=loggerService_1['loggerService'][_0x1d28ed(0x1e3)]();_0xc2e38f['json']({'success':!![],'result':_0x355891});}catch(_0x4b1107){_0xc2e38f[_0x1d28ed(0x1c0)](0x1f4)[_0x1d28ed(0x20f)]({'success':![],'message':_0x1d28ed(0x1db)});}}),router[a18_0x21efea(0x216)](a18_0x21efea(0x1bc),(_0x42113e,_0x448b37)=>{const _0x30d64f=a18_0x21efea;try{const {daysToKeep:daysToKeep=0x1e}=_0x42113e[_0x30d64f(0x200)];loggerService_1[_0x30d64f(0x1c3)]['cleanOldLogs'](daysToKeep),_0x448b37[_0x30d64f(0x20f)]({'success':!![],'message':'Old\x20logs\x20cleaned\x20(kept\x20last\x20'+daysToKeep+_0x30d64f(0x1c9)});}catch(_0x1e0fec){_0x448b37['status'](0x1f4)['json']({'success':![],'message':_0x30d64f(0x1f9)});}}),router[a18_0x21efea(0x216)](a18_0x21efea(0x1f8),async(_0x4684f3,_0x3103b5)=>{const _0x2738c3=a18_0x21efea;try{const {paymentId:_0x4b76f3}=_0x4684f3[_0x2738c3(0x1dd)];console['log'](_0x2738c3(0x1fa)+_0x4b76f3),await coinToPayStatusService_1[_0x2738c3(0x1b8)][_0x2738c3(0x1c6)](_0x4b76f3),_0x3103b5['json']({'success':!![],'message':_0x2738c3(0x1ef)});}catch(_0x5af71a){console['error'](_0x2738c3(0x1eb)+_0x4684f3[_0x2738c3(0x1dd)][_0x2738c3(0x1e6)]+':',_0x5af71a),_0x3103b5[_0x2738c3(0x1c0)](0x1f4)[_0x2738c3(0x20f)]({'success':![],'message':_0x5af71a instanceof Error?_0x5af71a[_0x2738c3(0x1d5)]:_0x2738c3(0x1f1)});}}),router[a18_0x21efea(0x1e5)](a18_0x21efea(0x223),(_0x50438e,_0x4ef862)=>{const _0x3f1d71=a18_0x21efea;try{const _0x4c4b69=coinToPayStatusService_1[_0x3f1d71(0x1b8)]['getServiceStats']();_0x4ef862[_0x3f1d71(0x20f)]({'success':!![],'result':{..._0x4c4b69,'description':_0x3f1d71(0x1da),'statusMapping':{'Paid':_0x3f1d71(0x1d8),'Awaiting\x20Fiat':_0x3f1d71(0x1fc),'waiting':_0x3f1d71(0x1fc),'expired':_0x3f1d71(0x1cd),'failed':_0x3f1d71(0x1d4)},'autoExpiryNote':_0x3f1d71(0x211)+_0x4c4b69[_0x3f1d71(0x1cf)]+_0x3f1d71(0x1dc),'individualTimersNote':'Each\x20new\x20payment\x20gets\x20individual\x20timers:\x201min,\x202min,\x207min,\x2012min,\x20then\x20hourly'}});}catch(_0x5a6618){_0x4ef862[_0x3f1d71(0x1c0)](0x1f4)[_0x3f1d71(0x20f)]({'success':![],'message':_0x3f1d71(0x1fd)});}}),router[a18_0x21efea(0x1e5)](a18_0x21efea(0x1f3),async(_0x32e24d,_0x471bed)=>{const _0x3b96c6=a18_0x21efea;try{const {paymentId:_0x2df11b}=_0x32e24d[_0x3b96c6(0x1dd)],_0x4a2a48=coinToPayStatusService_1[_0x3b96c6(0x1b8)][_0x3b96c6(0x20c)](_0x2df11b),_0x105e4c=(await Promise['resolve']()['then'](()=>__importStar(require(_0x3b96c6(0x1ca)))))[_0x3b96c6(0x205)],_0x4e6f3d=await _0x105e4c[_0x3b96c6(0x208)][_0x3b96c6(0x1f7)]({'where':{'id':_0x2df11b},'select':{'id':!![],'gateway':!![],'gatewayPaymentId':!![],'status':!![],'amount':!![],'currency':!![],'createdAt':!![],'updatedAt':!![],'shopId':!![],'shop':{'select':{'name':!![],'username':!![]}}}});if(!_0x4e6f3d)return _0x471bed[_0x3b96c6(0x1c0)](0x194)[_0x3b96c6(0x20f)]({'success':![],'message':_0x3b96c6(0x1f2)});_0x471bed[_0x3b96c6(0x20f)]({'success':!![],'result':{'payment':{'id':_0x4e6f3d['id'],'gateway':_0x4e6f3d['gateway'],'gatewayPaymentId':_0x4e6f3d[_0x3b96c6(0x213)],'status':_0x4e6f3d[_0x3b96c6(0x1c0)],'amount':_0x4e6f3d[_0x3b96c6(0x1df)],'currency':_0x4e6f3d[_0x3b96c6(0x220)],'createdAt':_0x4e6f3d['createdAt'],'updatedAt':_0x4e6f3d['updatedAt'],'shop':_0x4e6f3d[_0x3b96c6(0x20b)]},'timers':_0x4a2a48,'isCoinToPay':_0x4e6f3d[_0x3b96c6(0x1e0)]===_0x3b96c6(0x1ed),'ageInMinutes':Math[_0x3b96c6(0x1ec)]((Date['now']()-_0x4e6f3d[_0x3b96c6(0x1e2)][_0x3b96c6(0x21b)]())/(0x3e8*0x3c))}});}catch(_0x548d1b){_0x471bed['status'](0x1f4)['json']({'success':![],'message':_0x548d1b instanceof Error?_0x548d1b[_0x3b96c6(0x1d5)]:_0x3b96c6(0x21d)});}}),router[a18_0x21efea(0x1e5)]('/domain-monitoring/stats',(_0x534008,_0x5b8cef)=>{const _0x1980b7=a18_0x21efea;try{const _0x2d9b06=domainMonitoringService_1['domainMonitoringService'][_0x1980b7(0x1d0)]();_0x5b8cef[_0x1980b7(0x20f)]({'success':!![],'result':{..._0x2d9b06,'description':_0x1980b7(0x1cb),'behavior':'Server\x20crashes\x20if\x20domain\x20is\x20not\x20responding\x20after\x20consecutive\x20failures','encoding':'Requests\x20are\x20made\x20with\x20base64\x20encoded\x20URLs'}});}catch(_0x24f0c4){_0x5b8cef[_0x1980b7(0x1c0)](0x1f4)['json']({'success':![],'message':_0x1980b7(0x21f)});}}),router['post'](a18_0x21efea(0x1ce),async(_0x2da478,_0x2a758a)=>{const _0x165848=a18_0x21efea;try{const _0xfb0398=await domainMonitoringService_1[_0x165848(0x21c)][_0x165848(0x1e8)]();_0x2a758a[_0x165848(0x20f)]({'success':!![],'result':{'domainAvailable':_0xfb0398,'message':_0xfb0398?_0x165848(0x1e4):_0x165848(0x1d2),'timestamp':new Date()[_0x165848(0x1ba)]()}});}catch(_0x1405d6){_0x2a758a['status'](0x1f4)['json']({'success':![],'message':_0x1405d6 instanceof Error?_0x1405d6[_0x165848(0x1d5)]:_0x165848(0x217)});}}),exports['default']=router;