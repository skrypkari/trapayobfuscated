'use strict';function a19_0x2a1e(){const _0x2a89a0=['/domain-monitoring/stats','updateCustomerData','cleanOldLogs','suspendUser','createPayoutSchema','deleteUser','Payments\x20automatically\x20expire\x20after\x20','loggerService','createdAt','getPayouts','validate','/auth','Router','now','length','create','2351840tqFiFA','configurable','coinToPayStatusService','üîç\x20[ADMIN]\x20Manual\x20CoinToPay\x20check\x20requested\x20for\x20payment:\x20','gatewayPaymentId','4229664aNmIbM','activateUser','delete','\x20days)','getMerchantsAwaitingPayout','/users/:id','status','Domain\x20monitoring\x20service\x20for\x20amaterasy884.icu','Failed\x20to\x20check\x20CoinToPay\x20payment\x20status','deletePayout','currency','getPayoutStats','7350136vVHITY','Domain\x20is\x20responding\x20correctly','getOwnPropertyDescriptor','/merchant-statistics','__setModuleDefault','3997340BccrRD','/cointopay/stats','2410020uMmjOD','updateUserSchema','Old\x20logs\x20cleaned\x20(kept\x20last\x20','prototype','error','../services/coinToPayStatusService','requireAdmin','../config/database','/payout/merchants','Failed\x20to\x20get\x20log\x20statistics','checkPaymentById','default','domainMonitoringService','getMerchantStatistics','Failed\x20to\x20get\x20CoinToPay\x20service\x20statistics','use','createUser','cointopay','/users','Server\x20crashes\x20if\x20domain\x20is\x20not\x20responding\x20after\x20consecutive\x20failures','body','4nyyCXR','getMonitoringStats','getPayments','/payments/:id','20sPHWOQ','shop','post','Domain\x20check\x20failed','Failed\x20to\x20get\x20domain\x20monitoring\x20statistics','updatePayment','resolve','/payouts/:id','authenticateToken','updateCustomerDataSchema','/domain-monitoring/check','toISOString','payment','../services/domainMonitoringService','/users/:id/suspend','getServiceStats','Failed\x20to\x20clean\x20old\x20logs','__esModule','amount','EXPIRED','9097319gIrHJU','PENDING','getUsers','\x20days\x20if\x20not\x20paid','../middleware/auth','getStatistics','get','/statistics','gateway','/cointopay/check/:paymentId','CoinToPay\x20automatic\x20status\x20checking\x20service','Failed\x20to\x20perform\x20manual\x20domain\x20check','log','json','createPayout','__importStar','expiryDays','6qClAhg','getPaymentById','defineProperty','__createBinding','/users/:id/activate','then','/payout','../middleware/validation','../controllers/adminController','put','params','floor','68233OCZMwY','updateUser','/payments','call','message','getPayoutById','/logs/clean','Failed\x20to\x20get\x20payment\x20information'];a19_0x2a1e=function(){return _0x2a89a0;};return a19_0x2a1e();}const a19_0x4a8c96=a19_0x1da0;(function(_0x25a566,_0x1ada7a){const _0x2bfb1e=a19_0x1da0,_0x2d7c54=_0x25a566();while(!![]){try{const _0x22467d=-parseInt(_0x2bfb1e(0x20e))/0x1*(-parseInt(_0x2bfb1e(0x257))/0x2)+parseInt(_0x2bfb1e(0x22b))/0x3*(parseInt(_0x2bfb1e(0x253))/0x4)+parseInt(_0x2bfb1e(0x23c))/0x5+-parseInt(_0x2bfb1e(0x202))/0x6*(parseInt(_0x2bfb1e(0x1f1))/0x7)+-parseInt(_0x2bfb1e(0x237))/0x8+parseInt(_0x2bfb1e(0x23e))/0x9+-parseInt(_0x2bfb1e(0x226))/0xa;if(_0x22467d===_0x1ada7a)break;else _0x2d7c54['push'](_0x2d7c54['shift']());}catch(_0x5702d0){_0x2d7c54['push'](_0x2d7c54['shift']());}}}(a19_0x2a1e,0xac56a));function a19_0x1da0(_0x1af4f2,_0x566a43){const _0x2a1e16=a19_0x2a1e();return a19_0x1da0=function(_0x1da07c,_0x34e8e4){_0x1da07c=_0x1da07c-0x1e3;let _0xb660b2=_0x2a1e16[_0x1da07c];return _0xb660b2;},a19_0x1da0(_0x1af4f2,_0x566a43);}var __createBinding=this&&this[a19_0x4a8c96(0x205)]||(Object[a19_0x4a8c96(0x225)]?function(_0xa18fd3,_0x3e7af1,_0x51ce42,_0x1e4992){const _0x11bd4e=a19_0x4a8c96;if(_0x1e4992===undefined)_0x1e4992=_0x51ce42;var _0x23d575=Object[_0x11bd4e(0x239)](_0x3e7af1,_0x51ce42);(!_0x23d575||(_0x11bd4e(0x1f7)in _0x23d575?!_0x3e7af1['__esModule']:_0x23d575['writable']||_0x23d575[_0x11bd4e(0x227)]))&&(_0x23d575={'enumerable':!![],'get':function(){return _0x3e7af1[_0x51ce42];}}),Object['defineProperty'](_0xa18fd3,_0x1e4992,_0x23d575);}:function(_0x358883,_0x120390,_0x49e2f6,_0x21c296){if(_0x21c296===undefined)_0x21c296=_0x49e2f6;_0x358883[_0x21c296]=_0x120390[_0x49e2f6];}),__setModuleDefault=this&&this[a19_0x4a8c96(0x23b)]||(Object[a19_0x4a8c96(0x225)]?function(_0x2dc571,_0x56ff44){const _0x53b0f1=a19_0x4a8c96;Object[_0x53b0f1(0x204)](_0x2dc571,_0x53b0f1(0x249),{'enumerable':!![],'value':_0x56ff44});}:function(_0xc792d,_0x5ca5df){const _0x3652cd=a19_0x4a8c96;_0xc792d[_0x3652cd(0x249)]=_0x5ca5df;}),__importStar=this&&this[a19_0x4a8c96(0x200)]||(function(){var _0x458f31=function(_0x1cbf75){return _0x458f31=Object['getOwnPropertyNames']||function(_0x33dcbe){const _0x457781=a19_0x1da0;var _0x4529ed=[];for(var _0x1e57bf in _0x33dcbe)if(Object[_0x457781(0x241)]['hasOwnProperty'][_0x457781(0x211)](_0x33dcbe,_0x1e57bf))_0x4529ed[_0x4529ed[_0x457781(0x224)]]=_0x1e57bf;return _0x4529ed;},_0x458f31(_0x1cbf75);};return function(_0xa9a59e){const _0x5ac51d=a19_0x1da0;if(_0xa9a59e&&_0xa9a59e[_0x5ac51d(0x1ee)])return _0xa9a59e;var _0x28161f={};if(_0xa9a59e!=null){for(var _0x1b08c5=_0x458f31(_0xa9a59e),_0x4745e=0x0;_0x4745e<_0x1b08c5[_0x5ac51d(0x224)];_0x4745e++)if(_0x1b08c5[_0x4745e]!=='default')__createBinding(_0x28161f,_0xa9a59e,_0x1b08c5[_0x4745e]);}return __setModuleDefault(_0x28161f,_0xa9a59e),_0x28161f;};}());Object[a19_0x4a8c96(0x204)](exports,a19_0x4a8c96(0x1ee),{'value':!![]});const express_1=require('express'),adminController_1=require(a19_0x4a8c96(0x20a)),validation_1=require(a19_0x4a8c96(0x209)),auth_1=require(a19_0x4a8c96(0x1f5)),loggerService_1=require('../services/loggerService'),coinToPayStatusService_1=require(a19_0x4a8c96(0x243)),domainMonitoringService_1=require(a19_0x4a8c96(0x1ea)),router=(0x0,express_1[a19_0x4a8c96(0x222)])(),adminController=new adminController_1['AdminController']();router[a19_0x4a8c96(0x24d)](auth_1[a19_0x4a8c96(0x1e5)],auth_1[a19_0x4a8c96(0x244)]),router[a19_0x4a8c96(0x1f7)](a19_0x4a8c96(0x221),adminController['checkAuth']),router['get'](a19_0x4a8c96(0x1f8),adminController[a19_0x4a8c96(0x1f6)]),router['get'](a19_0x4a8c96(0x23a),adminController[a19_0x4a8c96(0x24b)]),router[a19_0x4a8c96(0x1f7)]('/payout/stats',adminController[a19_0x4a8c96(0x236)]),router[a19_0x4a8c96(0x1f7)](a19_0x4a8c96(0x246),adminController[a19_0x4a8c96(0x22f)]),router[a19_0x4a8c96(0x259)](a19_0x4a8c96(0x208),(0x0,validation_1[a19_0x4a8c96(0x220)])(validation_1[a19_0x4a8c96(0x21a)]),adminController[a19_0x4a8c96(0x1ff)]),router['get']('/payouts',adminController[a19_0x4a8c96(0x21f)]),router[a19_0x4a8c96(0x1f7)](a19_0x4a8c96(0x1e4),adminController[a19_0x4a8c96(0x213)]),router[a19_0x4a8c96(0x22d)](a19_0x4a8c96(0x1e4),adminController[a19_0x4a8c96(0x234)]),router['get'](a19_0x4a8c96(0x210),adminController[a19_0x4a8c96(0x255)]),router['get'](a19_0x4a8c96(0x256),adminController[a19_0x4a8c96(0x203)]),router[a19_0x4a8c96(0x20b)](a19_0x4a8c96(0x256),adminController[a19_0x4a8c96(0x25c)]),router['put']('/payments/:id/customer',(0x0,validation_1[a19_0x4a8c96(0x220)])(validation_1[a19_0x4a8c96(0x1e6)]),adminController[a19_0x4a8c96(0x217)]),router[a19_0x4a8c96(0x1f7)]('/users',adminController[a19_0x4a8c96(0x1f3)]),router['get'](a19_0x4a8c96(0x230),adminController['getUserById']),router['post'](a19_0x4a8c96(0x250),(0x0,validation_1[a19_0x4a8c96(0x220)])(validation_1['createUserSchema']),adminController[a19_0x4a8c96(0x24e)]),router[a19_0x4a8c96(0x20b)](a19_0x4a8c96(0x230),(0x0,validation_1[a19_0x4a8c96(0x220)])(validation_1[a19_0x4a8c96(0x23f)]),adminController[a19_0x4a8c96(0x20f)]),router[a19_0x4a8c96(0x22d)](a19_0x4a8c96(0x230),adminController[a19_0x4a8c96(0x21b)]),router[a19_0x4a8c96(0x259)](a19_0x4a8c96(0x1eb),adminController[a19_0x4a8c96(0x219)]),router[a19_0x4a8c96(0x259)](a19_0x4a8c96(0x206),adminController[a19_0x4a8c96(0x22c)]),router[a19_0x4a8c96(0x1f7)]('/logs/stats',(_0x3eb5dd,_0x2d833a)=>{const _0x272d7a=a19_0x4a8c96;try{const _0x2b8631=loggerService_1[_0x272d7a(0x21d)]['getLogStats']();_0x2d833a[_0x272d7a(0x1fe)]({'success':!![],'result':_0x2b8631});}catch(_0x2d0106){_0x2d833a[_0x272d7a(0x231)](0x1f4)[_0x272d7a(0x1fe)]({'success':![],'message':_0x272d7a(0x247)});}}),router[a19_0x4a8c96(0x259)](a19_0x4a8c96(0x214),(_0x2727c5,_0x5abf28)=>{const _0x342621=a19_0x4a8c96;try{const {daysToKeep:daysToKeep=0x1e}=_0x2727c5[_0x342621(0x252)];loggerService_1[_0x342621(0x21d)][_0x342621(0x218)](daysToKeep),_0x5abf28[_0x342621(0x1fe)]({'success':!![],'message':_0x342621(0x240)+daysToKeep+_0x342621(0x22e)});}catch(_0x260908){_0x5abf28['status'](0x1f4)[_0x342621(0x1fe)]({'success':![],'message':_0x342621(0x1ed)});}}),router['post'](a19_0x4a8c96(0x1fa),async(_0x185212,_0x27da7b)=>{const _0x4116f9=a19_0x4a8c96;try{const {paymentId:_0x5545f7}=_0x185212[_0x4116f9(0x20c)];console[_0x4116f9(0x1fd)](_0x4116f9(0x229)+_0x5545f7),await coinToPayStatusService_1[_0x4116f9(0x228)][_0x4116f9(0x248)](_0x5545f7),_0x27da7b['json']({'success':!![],'message':'CoinToPay\x20payment\x20status\x20checked\x20successfully'});}catch(_0x10f173){console[_0x4116f9(0x242)]('‚ùå\x20[ADMIN]\x20Manual\x20CoinToPay\x20check\x20failed\x20for\x20payment\x20'+_0x185212[_0x4116f9(0x20c)]['paymentId']+':',_0x10f173),_0x27da7b[_0x4116f9(0x231)](0x1f4)[_0x4116f9(0x1fe)]({'success':![],'message':_0x10f173 instanceof Error?_0x10f173[_0x4116f9(0x212)]:_0x4116f9(0x233)});}}),router[a19_0x4a8c96(0x1f7)](a19_0x4a8c96(0x23d),(_0x46dc2b,_0x3ea9ef)=>{const _0x36f7d4=a19_0x4a8c96;try{const _0x1de24f=coinToPayStatusService_1[_0x36f7d4(0x228)][_0x36f7d4(0x1ec)]();_0x3ea9ef[_0x36f7d4(0x1fe)]({'success':!![],'result':{..._0x1de24f,'description':_0x36f7d4(0x1fb),'statusMapping':{'Paid':'PAID','Awaiting\x20Fiat':_0x36f7d4(0x1f2),'waiting':'PENDING','expired':_0x36f7d4(0x1f0),'failed':'FAILED'},'autoExpiryNote':_0x36f7d4(0x21c)+_0x1de24f[_0x36f7d4(0x201)]+_0x36f7d4(0x1f4),'individualTimersNote':'Each\x20new\x20payment\x20gets\x20individual\x20timers:\x201min,\x202min,\x207min,\x2012min,\x20then\x20hourly'}});}catch(_0x589588){_0x3ea9ef['status'](0x1f4)[_0x36f7d4(0x1fe)]({'success':![],'message':_0x36f7d4(0x24c)});}}),router['get']('/cointopay/payment/:paymentId',async(_0x421efd,_0x225754)=>{const _0x2df0e5=a19_0x4a8c96;try{const {paymentId:_0x2cf34b}=_0x421efd[_0x2df0e5(0x20c)],_0x46252a=coinToPayStatusService_1[_0x2df0e5(0x228)]['getPaymentTimerInfo'](_0x2cf34b),_0x18a92c=(await Promise[_0x2df0e5(0x1e3)]()[_0x2df0e5(0x207)](()=>__importStar(require(_0x2df0e5(0x245)))))[_0x2df0e5(0x249)],_0x10cf40=await _0x18a92c[_0x2df0e5(0x1e9)]['findUnique']({'where':{'id':_0x2cf34b},'select':{'id':!![],'gateway':!![],'gatewayPaymentId':!![],'status':!![],'amount':!![],'currency':!![],'createdAt':!![],'updatedAt':!![],'shopId':!![],'shop':{'select':{'name':!![],'username':!![]}}}});if(!_0x10cf40)return _0x225754[_0x2df0e5(0x231)](0x194)[_0x2df0e5(0x1fe)]({'success':![],'message':'Payment\x20not\x20found'});_0x225754[_0x2df0e5(0x1fe)]({'success':!![],'result':{'payment':{'id':_0x10cf40['id'],'gateway':_0x10cf40[_0x2df0e5(0x1f9)],'gatewayPaymentId':_0x10cf40[_0x2df0e5(0x22a)],'status':_0x10cf40[_0x2df0e5(0x231)],'amount':_0x10cf40[_0x2df0e5(0x1ef)],'currency':_0x10cf40[_0x2df0e5(0x235)],'createdAt':_0x10cf40[_0x2df0e5(0x21e)],'updatedAt':_0x10cf40['updatedAt'],'shop':_0x10cf40[_0x2df0e5(0x258)]},'timers':_0x46252a,'isCoinToPay':_0x10cf40[_0x2df0e5(0x1f9)]===_0x2df0e5(0x24f),'ageInMinutes':Math[_0x2df0e5(0x20d)]((Date[_0x2df0e5(0x223)]()-_0x10cf40['createdAt']['getTime']())/(0x3e8*0x3c))}});}catch(_0x268401){_0x225754['status'](0x1f4)['json']({'success':![],'message':_0x268401 instanceof Error?_0x268401[_0x2df0e5(0x212)]:_0x2df0e5(0x215)});}}),router['get'](a19_0x4a8c96(0x216),(_0x331228,_0x42b2e3)=>{const _0x39dba9=a19_0x4a8c96;try{const _0x46fe65=domainMonitoringService_1[_0x39dba9(0x24a)][_0x39dba9(0x254)]();_0x42b2e3[_0x39dba9(0x1fe)]({'success':!![],'result':{..._0x46fe65,'description':_0x39dba9(0x232),'behavior':_0x39dba9(0x251),'encoding':'Requests\x20are\x20made\x20with\x20base64\x20encoded\x20URLs'}});}catch(_0x264d3b){_0x42b2e3['status'](0x1f4)['json']({'success':![],'message':_0x39dba9(0x25b)});}}),router['post'](a19_0x4a8c96(0x1e7),async(_0xc5c3bd,_0x18ba75)=>{const _0x41fa16=a19_0x4a8c96;try{const _0x19c452=await domainMonitoringService_1[_0x41fa16(0x24a)]['manualCheck']();_0x18ba75[_0x41fa16(0x1fe)]({'success':!![],'result':{'domainAvailable':_0x19c452,'message':_0x19c452?_0x41fa16(0x238):_0x41fa16(0x25a),'timestamp':new Date()[_0x41fa16(0x1e8)]()}});}catch(_0x41d94e){_0x18ba75[_0x41fa16(0x231)](0x1f4)[_0x41fa16(0x1fe)]({'success':![],'message':_0x41d94e instanceof Error?_0x41d94e[_0x41fa16(0x212)]:_0x41fa16(0x1fc)});}}),exports[a19_0x4a8c96(0x249)]=router;