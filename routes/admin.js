'use strict';const a19_0x3d2e4c=a19_0x1614;function a19_0x39af(){const _0x3444cc=['PAID','/payout/merchants','Each\x20new\x20payment\x20gets\x20individual\x20timers:\x201min,\x202min,\x207min,\x2012min,\x20then\x20hourly','Failed\x20to\x20get\x20payment\x20information','/payout','call','Failed\x20to\x20get\x20log\x20statistics','üîç\x20[ADMIN]\x20Manual\x20CoinToPay\x20check\x20requested\x20for\x20payment:\x20','length','Failed\x20to\x20clean\x20old\x20logs','getMerchantsAwaitingPayout','updatePayment','‚ùå\x20[ADMIN]\x20Manual\x20CoinToPay\x20check\x20failed\x20for\x20payment\x20','Old\x20logs\x20cleaned\x20(kept\x20last\x20','findUnique','__createBinding','/logs/stats','getPaymentById','84633DLvmiI','/users/:id/suspend','getMerchantsSelection','json','../middleware/validation','\x20days\x20if\x20not\x20paid','CoinToPay\x20automatic\x20status\x20checking\x20service','delete','updatedAt','toISOString','/cointopay/stats','3545305yezrXF','getPaymentTimerInfo','gateway','Domain\x20check\x20failed','loggerService','/users','resolve','cleanOldLogs','PENDING','amount','domainMonitoringService','/logs/clean','then','Server\x20crashes\x20if\x20domain\x20is\x20not\x20responding\x20after\x20consecutive\x20failures','/payouts/:id','updateCustomerDataSchema','__esModule','coinToPayStatusService','../controllers/adminController','getMonitoringStats','Failed\x20to\x20get\x20CoinToPay\x20service\x20statistics','createPayoutSchema','put','/users/:id/activate','../middleware/auth','1993821YPETBi','../services/coinToPayStatusService','/payouts','getPayoutStats','getPayoutById','Payment\x20not\x20found','Payments\x20automatically\x20expire\x20after\x20','getServiceStats','authenticateToken','log','../services/domainMonitoringService','message','3789632krdYCX','/auth','deletePayout','\x20days)','get','requireAdmin','configurable','/payments/:id','Router','/payments/:id/customer','__importStar','status','createdAt','default','createUser','/cointopay/payment/:paymentId','904216oaiUEf','6sBvXuq','/payout/stats','Domain\x20is\x20responding\x20correctly','updateUser','floor','body','getMerchantStatistics','8291763lFgtHM','getPayouts','updateUserSchema','4SEIIHy','../config/database','/payments','manualCheck','params','expiryDays','cointopay','3900512iVRVAB','Domain\x20monitoring\x20service\x20for\x20amaterasy884.icu','prototype','validate','getStatistics','error','checkPaymentById','Failed\x20to\x20check\x20CoinToPay\x20payment\x20status','deleteUser','gatewayPaymentId','getPayments','createUserSchema','/domain-monitoring/check','__setModuleDefault','create','defineProperty','/domain-monitoring/stats','../services/loggerService','hasOwnProperty','post','FAILED','activateUser','payment','/merchants/selection'];a19_0x39af=function(){return _0x3444cc;};return a19_0x39af();}function a19_0x1614(_0x5c6723,_0x4fc1e1){const _0x39af50=a19_0x39af();return a19_0x1614=function(_0x161477,_0x407503){_0x161477=_0x161477-0x1cd;let _0xcd40c4=_0x39af50[_0x161477];return _0xcd40c4;},a19_0x1614(_0x5c6723,_0x4fc1e1);}(function(_0x1b4195,_0x42bdd7){const _0x24db4a=a19_0x1614,_0x41f911=_0x1b4195();while(!![]){try{const _0x2c303b=parseInt(_0x24db4a(0x233))/0x1*(-parseInt(_0x24db4a(0x202))/0x2)+parseInt(_0x24db4a(0x1db))/0x3+parseInt(_0x24db4a(0x1e7))/0x4+-parseInt(_0x24db4a(0x23e))/0x5+-parseInt(_0x24db4a(0x1f8))/0x6*(-parseInt(_0x24db4a(0x209))/0x7)+parseInt(_0x24db4a(0x1f7))/0x8+-parseInt(_0x24db4a(0x1ff))/0x9;if(_0x2c303b===_0x42bdd7)break;else _0x41f911['push'](_0x41f911['shift']());}catch(_0x366817){_0x41f911['push'](_0x41f911['shift']());}}}(a19_0x39af,0x75d40));var __createBinding=this&&this[a19_0x3d2e4c(0x230)]||(Object[a19_0x3d2e4c(0x217)]?function(_0x2e633f,_0x128efb,_0x2c00f2,_0x1d5f3e){const _0xe65253=a19_0x3d2e4c;if(_0x1d5f3e===undefined)_0x1d5f3e=_0x2c00f2;var _0x1209fe=Object['getOwnPropertyDescriptor'](_0x128efb,_0x2c00f2);(!_0x1209fe||(_0xe65253(0x1eb)in _0x1209fe?!_0x128efb[_0xe65253(0x1d2)]:_0x1209fe['writable']||_0x1209fe[_0xe65253(0x1ed)]))&&(_0x1209fe={'enumerable':!![],'get':function(){return _0x128efb[_0x2c00f2];}}),Object['defineProperty'](_0x2e633f,_0x1d5f3e,_0x1209fe);}:function(_0x4c75b6,_0xdd62dc,_0x16a6b5,_0x2314ab){if(_0x2314ab===undefined)_0x2314ab=_0x16a6b5;_0x4c75b6[_0x2314ab]=_0xdd62dc[_0x16a6b5];}),__setModuleDefault=this&&this[a19_0x3d2e4c(0x216)]||(Object[a19_0x3d2e4c(0x217)]?function(_0x3a2de0,_0x426466){const _0x571f37=a19_0x3d2e4c;Object['defineProperty'](_0x3a2de0,_0x571f37(0x1f4),{'enumerable':!![],'value':_0x426466});}:function(_0x5c198d,_0x1cbdf8){const _0x5005b6=a19_0x3d2e4c;_0x5c198d[_0x5005b6(0x1f4)]=_0x1cbdf8;}),__importStar=this&&this[a19_0x3d2e4c(0x1f1)]||(function(){var _0x52bc40=function(_0x3b1e80){return _0x52bc40=Object['getOwnPropertyNames']||function(_0x1df960){const _0x33765f=a19_0x1614;var _0x3b925b=[];for(var _0x58ea42 in _0x1df960)if(Object[_0x33765f(0x20b)][_0x33765f(0x21b)][_0x33765f(0x226)](_0x1df960,_0x58ea42))_0x3b925b[_0x3b925b[_0x33765f(0x229)]]=_0x58ea42;return _0x3b925b;},_0x52bc40(_0x3b1e80);};return function(_0x1e86d3){const _0x79a132=a19_0x1614;if(_0x1e86d3&&_0x1e86d3[_0x79a132(0x1d2)])return _0x1e86d3;var _0x4e0449={};if(_0x1e86d3!=null){for(var _0x2119f0=_0x52bc40(_0x1e86d3),_0x4c0641=0x0;_0x4c0641<_0x2119f0[_0x79a132(0x229)];_0x4c0641++)if(_0x2119f0[_0x4c0641]!==_0x79a132(0x1f4))__createBinding(_0x4e0449,_0x1e86d3,_0x2119f0[_0x4c0641]);}return __setModuleDefault(_0x4e0449,_0x1e86d3),_0x4e0449;};}());Object[a19_0x3d2e4c(0x218)](exports,a19_0x3d2e4c(0x1d2),{'value':!![]});const express_1=require('express'),adminController_1=require(a19_0x3d2e4c(0x1d4)),validation_1=require(a19_0x3d2e4c(0x237)),auth_1=require(a19_0x3d2e4c(0x1da)),loggerService_1=require(a19_0x3d2e4c(0x21a)),coinToPayStatusService_1=require(a19_0x3d2e4c(0x1dc)),domainMonitoringService_1=require(a19_0x3d2e4c(0x1e5)),router=(0x0,express_1[a19_0x3d2e4c(0x1ef)])(),adminController=new adminController_1['AdminController']();router['use'](auth_1[a19_0x3d2e4c(0x1e3)],auth_1[a19_0x3d2e4c(0x1ec)]),router[a19_0x3d2e4c(0x1eb)](a19_0x3d2e4c(0x1e8),adminController['checkAuth']),router[a19_0x3d2e4c(0x1eb)]('/statistics',adminController[a19_0x3d2e4c(0x20d)]),router['get']('/merchant-statistics',adminController[a19_0x3d2e4c(0x1fe)]),router[a19_0x3d2e4c(0x1eb)](a19_0x3d2e4c(0x1f9),adminController[a19_0x3d2e4c(0x1de)]),router[a19_0x3d2e4c(0x1eb)](a19_0x3d2e4c(0x222),adminController[a19_0x3d2e4c(0x22b)]),router[a19_0x3d2e4c(0x1eb)](a19_0x3d2e4c(0x220),adminController[a19_0x3d2e4c(0x235)]),router[a19_0x3d2e4c(0x21c)](a19_0x3d2e4c(0x225),(0x0,validation_1[a19_0x3d2e4c(0x20c)])(validation_1[a19_0x3d2e4c(0x1d7)]),adminController['createPayout']),router[a19_0x3d2e4c(0x1eb)](a19_0x3d2e4c(0x1dd),adminController[a19_0x3d2e4c(0x200)]),router['get'](a19_0x3d2e4c(0x1d0),adminController[a19_0x3d2e4c(0x1df)]),router['delete'](a19_0x3d2e4c(0x1d0),adminController[a19_0x3d2e4c(0x1e9)]),router['get'](a19_0x3d2e4c(0x204),adminController[a19_0x3d2e4c(0x213)]),router['get'](a19_0x3d2e4c(0x1ee),adminController[a19_0x3d2e4c(0x232)]),router[a19_0x3d2e4c(0x1d8)](a19_0x3d2e4c(0x1ee),adminController[a19_0x3d2e4c(0x22c)]),router['put'](a19_0x3d2e4c(0x1f0),(0x0,validation_1[a19_0x3d2e4c(0x20c)])(validation_1[a19_0x3d2e4c(0x1d1)]),adminController['updateCustomerData']),router[a19_0x3d2e4c(0x1eb)](a19_0x3d2e4c(0x243),adminController['getUsers']),router[a19_0x3d2e4c(0x1eb)]('/users/:id',adminController['getUserById']),router[a19_0x3d2e4c(0x21c)](a19_0x3d2e4c(0x243),(0x0,validation_1['validate'])(validation_1[a19_0x3d2e4c(0x214)]),adminController[a19_0x3d2e4c(0x1f5)]),router[a19_0x3d2e4c(0x1d8)]('/users/:id',(0x0,validation_1[a19_0x3d2e4c(0x20c)])(validation_1[a19_0x3d2e4c(0x201)]),adminController[a19_0x3d2e4c(0x1fb)]),router[a19_0x3d2e4c(0x23a)]('/users/:id',adminController[a19_0x3d2e4c(0x211)]),router[a19_0x3d2e4c(0x21c)](a19_0x3d2e4c(0x234),adminController['suspendUser']),router[a19_0x3d2e4c(0x21c)](a19_0x3d2e4c(0x1d9),adminController[a19_0x3d2e4c(0x21e)]),router[a19_0x3d2e4c(0x1eb)](a19_0x3d2e4c(0x231),(_0x33938e,_0x1459ee)=>{const _0x6f795b=a19_0x3d2e4c;try{const _0x39b711=loggerService_1[_0x6f795b(0x242)]['getLogStats']();_0x1459ee['json']({'success':!![],'result':_0x39b711});}catch(_0x22dcde){_0x1459ee[_0x6f795b(0x1f2)](0x1f4)[_0x6f795b(0x236)]({'success':![],'message':_0x6f795b(0x227)});}}),router['post'](a19_0x3d2e4c(0x1cd),(_0x4ccc49,_0x360d4d)=>{const _0x17e2d6=a19_0x3d2e4c;try{const {daysToKeep:daysToKeep=0x1e}=_0x4ccc49[_0x17e2d6(0x1fd)];loggerService_1['loggerService'][_0x17e2d6(0x245)](daysToKeep),_0x360d4d[_0x17e2d6(0x236)]({'success':!![],'message':_0x17e2d6(0x22e)+daysToKeep+_0x17e2d6(0x1ea)});}catch(_0x33c109){_0x360d4d['status'](0x1f4)[_0x17e2d6(0x236)]({'success':![],'message':_0x17e2d6(0x22a)});}}),router['post']('/cointopay/check/:paymentId',async(_0x120d44,_0x31b95f)=>{const _0x41aa43=a19_0x3d2e4c;try{const {paymentId:_0x351039}=_0x120d44[_0x41aa43(0x206)];console[_0x41aa43(0x1e4)](_0x41aa43(0x228)+_0x351039),await coinToPayStatusService_1[_0x41aa43(0x1d3)][_0x41aa43(0x20f)](_0x351039),_0x31b95f[_0x41aa43(0x236)]({'success':!![],'message':'CoinToPay\x20payment\x20status\x20checked\x20successfully'});}catch(_0x166881){console[_0x41aa43(0x20e)](_0x41aa43(0x22d)+_0x120d44['params']['paymentId']+':',_0x166881),_0x31b95f[_0x41aa43(0x1f2)](0x1f4)['json']({'success':![],'message':_0x166881 instanceof Error?_0x166881['message']:_0x41aa43(0x210)});}}),router[a19_0x3d2e4c(0x1eb)](a19_0x3d2e4c(0x23d),(_0x47d978,_0x499f4e)=>{const _0x4321f1=a19_0x3d2e4c;try{const _0x2f4f0c=coinToPayStatusService_1['coinToPayStatusService'][_0x4321f1(0x1e2)]();_0x499f4e['json']({'success':!![],'result':{..._0x2f4f0c,'description':_0x4321f1(0x239),'statusMapping':{'Paid':_0x4321f1(0x221),'Awaiting\x20Fiat':_0x4321f1(0x246),'waiting':_0x4321f1(0x246),'expired':'EXPIRED','failed':_0x4321f1(0x21d)},'autoExpiryNote':_0x4321f1(0x1e1)+_0x2f4f0c[_0x4321f1(0x207)]+_0x4321f1(0x238),'individualTimersNote':_0x4321f1(0x223)}});}catch(_0x133586){_0x499f4e['status'](0x1f4)[_0x4321f1(0x236)]({'success':![],'message':_0x4321f1(0x1d6)});}}),router[a19_0x3d2e4c(0x1eb)](a19_0x3d2e4c(0x1f6),async(_0x3d8af7,_0x3cae55)=>{const _0x22c400=a19_0x3d2e4c;try{const {paymentId:_0x443b28}=_0x3d8af7[_0x22c400(0x206)],_0x3374d8=coinToPayStatusService_1[_0x22c400(0x1d3)][_0x22c400(0x23f)](_0x443b28),_0x864d9f=(await Promise[_0x22c400(0x244)]()[_0x22c400(0x1ce)](()=>__importStar(require(_0x22c400(0x203)))))[_0x22c400(0x1f4)],_0x171c08=await _0x864d9f[_0x22c400(0x21f)][_0x22c400(0x22f)]({'where':{'id':_0x443b28},'select':{'id':!![],'gateway':!![],'gatewayPaymentId':!![],'status':!![],'amount':!![],'currency':!![],'createdAt':!![],'updatedAt':!![],'shopId':!![],'shop':{'select':{'name':!![],'username':!![]}}}});if(!_0x171c08)return _0x3cae55[_0x22c400(0x1f2)](0x194)['json']({'success':![],'message':_0x22c400(0x1e0)});_0x3cae55[_0x22c400(0x236)]({'success':!![],'result':{'payment':{'id':_0x171c08['id'],'gateway':_0x171c08[_0x22c400(0x240)],'gatewayPaymentId':_0x171c08[_0x22c400(0x212)],'status':_0x171c08[_0x22c400(0x1f2)],'amount':_0x171c08[_0x22c400(0x247)],'currency':_0x171c08['currency'],'createdAt':_0x171c08[_0x22c400(0x1f3)],'updatedAt':_0x171c08[_0x22c400(0x23b)],'shop':_0x171c08['shop']},'timers':_0x3374d8,'isCoinToPay':_0x171c08[_0x22c400(0x240)]===_0x22c400(0x208),'ageInMinutes':Math[_0x22c400(0x1fc)]((Date['now']()-_0x171c08[_0x22c400(0x1f3)]['getTime']())/(0x3e8*0x3c))}});}catch(_0x4d1d39){_0x3cae55[_0x22c400(0x1f2)](0x1f4)[_0x22c400(0x236)]({'success':![],'message':_0x4d1d39 instanceof Error?_0x4d1d39[_0x22c400(0x1e6)]:_0x22c400(0x224)});}}),router[a19_0x3d2e4c(0x1eb)](a19_0x3d2e4c(0x219),(_0x484b74,_0x3cc178)=>{const _0x16120b=a19_0x3d2e4c;try{const _0x1a4e9a=domainMonitoringService_1[_0x16120b(0x248)][_0x16120b(0x1d5)]();_0x3cc178[_0x16120b(0x236)]({'success':!![],'result':{..._0x1a4e9a,'description':_0x16120b(0x20a),'behavior':_0x16120b(0x1cf),'encoding':'Requests\x20are\x20made\x20with\x20base64\x20encoded\x20URLs'}});}catch(_0x19aa2e){_0x3cc178[_0x16120b(0x1f2)](0x1f4)[_0x16120b(0x236)]({'success':![],'message':'Failed\x20to\x20get\x20domain\x20monitoring\x20statistics'});}}),router[a19_0x3d2e4c(0x21c)](a19_0x3d2e4c(0x215),async(_0x2da63e,_0x14bc88)=>{const _0x3ad0e8=a19_0x3d2e4c;try{const _0x386cde=await domainMonitoringService_1[_0x3ad0e8(0x248)][_0x3ad0e8(0x205)]();_0x14bc88[_0x3ad0e8(0x236)]({'success':!![],'result':{'domainAvailable':_0x386cde,'message':_0x386cde?_0x3ad0e8(0x1fa):_0x3ad0e8(0x241),'timestamp':new Date()[_0x3ad0e8(0x23c)]()}});}catch(_0x54fb5d){_0x14bc88[_0x3ad0e8(0x1f2)](0x1f4)[_0x3ad0e8(0x236)]({'success':![],'message':_0x54fb5d instanceof Error?_0x54fb5d[_0x3ad0e8(0x1e6)]:'Failed\x20to\x20perform\x20manual\x20domain\x20check'});}}),exports[a19_0x3d2e4c(0x1f4)]=router;