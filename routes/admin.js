'use strict';const a19_0x278df6=a19_0x21b2;(function(_0x4fff0b,_0x1fbc88){const _0x25a23f=a19_0x21b2,_0x5d15fe=_0x4fff0b();while(!![]){try{const _0x5b8385=-parseInt(_0x25a23f(0x1fe))/0x1*(parseInt(_0x25a23f(0x1ef))/0x2)+parseInt(_0x25a23f(0x1e8))/0x3*(parseInt(_0x25a23f(0x24a))/0x4)+parseInt(_0x25a23f(0x1f2))/0x5*(-parseInt(_0x25a23f(0x203))/0x6)+-parseInt(_0x25a23f(0x217))/0x7*(-parseInt(_0x25a23f(0x239))/0x8)+parseInt(_0x25a23f(0x22f))/0x9+parseInt(_0x25a23f(0x238))/0xa+-parseInt(_0x25a23f(0x20f))/0xb*(parseInt(_0x25a23f(0x252))/0xc);if(_0x5b8385===_0x1fbc88)break;else _0x5d15fe['push'](_0x5d15fe['shift']());}catch(_0x1f9009){_0x5d15fe['push'](_0x5d15fe['shift']());}}}(a19_0x3e20,0x47e43));function a19_0x21b2(_0x4de897,_0x49f0d3){const _0x3e208c=a19_0x3e20();return a19_0x21b2=function(_0x21b248,_0xb6fae4){_0x21b248=_0x21b248-0x1dc;let _0x19fc65=_0x3e208c[_0x21b248];return _0x19fc65;},a19_0x21b2(_0x4de897,_0x49f0d3);}var __createBinding=this&&this[a19_0x278df6(0x1fb)]||(Object[a19_0x278df6(0x246)]?function(_0x4a13df,_0xd348bd,_0x590bf9,_0x3bd0ac){const _0x4fbc8e=a19_0x278df6;if(_0x3bd0ac===undefined)_0x3bd0ac=_0x590bf9;var _0x2b5ce5=Object[_0x4fbc8e(0x24c)](_0xd348bd,_0x590bf9);(!_0x2b5ce5||(_0x4fbc8e(0x255)in _0x2b5ce5?!_0xd348bd[_0x4fbc8e(0x250)]:_0x2b5ce5[_0x4fbc8e(0x228)]||_0x2b5ce5[_0x4fbc8e(0x206)]))&&(_0x2b5ce5={'enumerable':!![],'get':function(){return _0xd348bd[_0x590bf9];}}),Object['defineProperty'](_0x4a13df,_0x3bd0ac,_0x2b5ce5);}:function(_0x2e449e,_0x8e67cf,_0x44dbef,_0x37e676){if(_0x37e676===undefined)_0x37e676=_0x44dbef;_0x2e449e[_0x37e676]=_0x8e67cf[_0x44dbef];}),__setModuleDefault=this&&this['__setModuleDefault']||(Object[a19_0x278df6(0x246)]?function(_0x4ddf49,_0x23ba89){const _0x345161=a19_0x278df6;Object[_0x345161(0x245)](_0x4ddf49,_0x345161(0x212),{'enumerable':!![],'value':_0x23ba89});}:function(_0x13bce0,_0x11f372){_0x13bce0['default']=_0x11f372;}),__importStar=this&&this['__importStar']||(function(){var _0x2e96fa=function(_0x3c53aa){return _0x2e96fa=Object['getOwnPropertyNames']||function(_0x472f50){const _0x408be6=a19_0x21b2;var _0x5d530f=[];for(var _0x2c939e in _0x472f50)if(Object[_0x408be6(0x251)][_0x408be6(0x21b)][_0x408be6(0x200)](_0x472f50,_0x2c939e))_0x5d530f[_0x5d530f[_0x408be6(0x220)]]=_0x2c939e;return _0x5d530f;},_0x2e96fa(_0x3c53aa);};return function(_0x15d99e){const _0x45aa88=a19_0x21b2;if(_0x15d99e&&_0x15d99e[_0x45aa88(0x250)])return _0x15d99e;var _0x540b14={};if(_0x15d99e!=null){for(var _0x4095ba=_0x2e96fa(_0x15d99e),_0x55d740=0x0;_0x55d740<_0x4095ba[_0x45aa88(0x220)];_0x55d740++)if(_0x4095ba[_0x55d740]!=='default')__createBinding(_0x540b14,_0x15d99e,_0x4095ba[_0x55d740]);}return __setModuleDefault(_0x540b14,_0x15d99e),_0x540b14;};}());Object['defineProperty'](exports,'__esModule',{'value':!![]});function a19_0x3e20(){const _0x1ee3bf=['getUsers','5yRSrFs','now','getPayoutStats','post','Failed\x20to\x20clean\x20old\x20logs','/payouts','resolve','/merchant-statistics','status','__createBinding','currency','then','1tgiQCk','getPaymentTimerInfo','call','put','gateway','1087974vqfAiG','Failed\x20to\x20get\x20log\x20statistics','/auth','configurable','getMonitoringStats','🔍\x20[ADMIN]\x20Manual\x20CoinToPay\x20check\x20requested\x20for\x20payment:\x20','/logs/clean','getMerchantsSelection','suspendUser','PENDING','Failed\x20to\x20get\x20payment\x20information','params','117997noxmby','Router','floor','default','getStatistics','/payout/stats','/payments/:id','Failed\x20to\x20get\x20CoinToPay\x20service\x20statistics','329gguEEQ','FAILED','deletePayout','PAID','hasOwnProperty','/users/:id/activate','Server\x20crashes\x20if\x20domain\x20is\x20not\x20responding\x20after\x20consecutive\x20failures','Failed\x20to\x20get\x20domain\x20monitoring\x20statistics','/users/:id/suspend','length','getPayments','../config/database','../services/coinToPayStatusService','/users','CoinToPay\x20payment\x20status\x20checked\x20successfully','updateUserSchema','Domain\x20monitoring\x20service\x20for\x20amaterasy884.icu','writable','use','/cointopay/stats','updateUser','activateUser','getLogStats','/payments/:id/customer','2785590bMlxeC','Payment\x20not\x20found','createUserSchema','Old\x20logs\x20cleaned\x20(kept\x20last\x20','cointopay','Failed\x20to\x20perform\x20manual\x20domain\x20check','error','shop','/payments','765710AYJKIB','36488EvpDWW','Domain\x20check\x20failed','updatePayment','/cointopay/check/:paymentId','EXPIRED','/users/:id','/merchants/selection','manualCheck','updatedAt','../services/loggerService','updateCustomerData','message','defineProperty','create','toISOString','body','validate','1643632zMadZc','createPayout','getOwnPropertyDescriptor','paymentId','delete','getTime','__esModule','prototype','108qaaHyn','updateCustomerDataSchema','getPayoutById','get','Payments\x20automatically\x20expire\x20after\x20','getServiceStats','createdAt','authenticateToken','/payout','checkPaymentById','../middleware/auth','Each\x20new\x20payment\x20gets\x20individual\x20timers:\x201min,\x202min,\x207min,\x2012min,\x20then\x20hourly','requireAdmin','getPayouts','loggerService','findUnique','getMerchantStatistics','/statistics','Requests\x20are\x20made\x20with\x20base64\x20encoded\x20URLs','coinToPayStatusService','3DmPuuG','getUserById','createUser','getMerchantsAwaitingPayout','domainMonitoringService','❌\x20[ADMIN]\x20Manual\x20CoinToPay\x20check\x20failed\x20for\x20payment\x20','amount','878034gAbqtY','json'];a19_0x3e20=function(){return _0x1ee3bf;};return a19_0x3e20();}const express_1=require('express'),adminController_1=require('../controllers/adminController'),validation_1=require('../middleware/validation'),auth_1=require(a19_0x278df6(0x1de)),loggerService_1=require(a19_0x278df6(0x242)),coinToPayStatusService_1=require(a19_0x278df6(0x223)),domainMonitoringService_1=require('../services/domainMonitoringService'),router=(0x0,express_1[a19_0x278df6(0x210)])(),adminController=new adminController_1['AdminController']();router[a19_0x278df6(0x229)](auth_1[a19_0x278df6(0x259)],auth_1[a19_0x278df6(0x1e0)]),router[a19_0x278df6(0x255)](a19_0x278df6(0x205),adminController['checkAuth']),router[a19_0x278df6(0x255)](a19_0x278df6(0x1e5),adminController[a19_0x278df6(0x213)]),router[a19_0x278df6(0x255)](a19_0x278df6(0x1f9),adminController[a19_0x278df6(0x1e4)]),router[a19_0x278df6(0x255)](a19_0x278df6(0x214),adminController[a19_0x278df6(0x1f4)]),router[a19_0x278df6(0x255)]('/payout/merchants',adminController[a19_0x278df6(0x1eb)]),router[a19_0x278df6(0x255)](a19_0x278df6(0x23f),adminController[a19_0x278df6(0x20a)]),router[a19_0x278df6(0x1f5)](a19_0x278df6(0x1dc),(0x0,validation_1['validate'])(validation_1['createPayoutSchema']),adminController[a19_0x278df6(0x24b)]),router[a19_0x278df6(0x255)](a19_0x278df6(0x1f7),adminController[a19_0x278df6(0x1e1)]),router[a19_0x278df6(0x255)]('/payouts/:id',adminController[a19_0x278df6(0x254)]),router[a19_0x278df6(0x24e)]('/payouts/:id',adminController[a19_0x278df6(0x219)]),router[a19_0x278df6(0x255)](a19_0x278df6(0x237),adminController[a19_0x278df6(0x221)]),router[a19_0x278df6(0x255)]('/payments/:id',adminController['getPaymentById']),router[a19_0x278df6(0x201)](a19_0x278df6(0x215),adminController[a19_0x278df6(0x23b)]),router[a19_0x278df6(0x201)](a19_0x278df6(0x22e),(0x0,validation_1['validate'])(validation_1[a19_0x278df6(0x253)]),adminController[a19_0x278df6(0x243)]),router[a19_0x278df6(0x255)](a19_0x278df6(0x224),adminController[a19_0x278df6(0x1f1)]),router[a19_0x278df6(0x255)]('/users/:id',adminController[a19_0x278df6(0x1e9)]),router[a19_0x278df6(0x1f5)](a19_0x278df6(0x224),(0x0,validation_1[a19_0x278df6(0x249)])(validation_1[a19_0x278df6(0x231)]),adminController[a19_0x278df6(0x1ea)]),router[a19_0x278df6(0x201)](a19_0x278df6(0x23e),(0x0,validation_1[a19_0x278df6(0x249)])(validation_1[a19_0x278df6(0x226)]),adminController[a19_0x278df6(0x22b)]),router['delete'](a19_0x278df6(0x23e),adminController['deleteUser']),router[a19_0x278df6(0x1f5)](a19_0x278df6(0x21f),adminController[a19_0x278df6(0x20b)]),router['post'](a19_0x278df6(0x21c),adminController[a19_0x278df6(0x22c)]),router[a19_0x278df6(0x255)]('/logs/stats',(_0x3c6543,_0xf351f7)=>{const _0x137b50=a19_0x278df6;try{const _0x284f23=loggerService_1[_0x137b50(0x1e2)][_0x137b50(0x22d)]();_0xf351f7['json']({'success':!![],'result':_0x284f23});}catch(_0x1aa9e9){_0xf351f7['status'](0x1f4)['json']({'success':![],'message':_0x137b50(0x204)});}}),router[a19_0x278df6(0x1f5)](a19_0x278df6(0x209),(_0x1cb80e,_0x3018cd)=>{const _0x60bd15=a19_0x278df6;try{const {daysToKeep:daysToKeep=0x1e}=_0x1cb80e[_0x60bd15(0x248)];loggerService_1[_0x60bd15(0x1e2)]['cleanOldLogs'](daysToKeep),_0x3018cd['json']({'success':!![],'message':_0x60bd15(0x232)+daysToKeep+'\x20days)'});}catch(_0x1068e0){_0x3018cd[_0x60bd15(0x1fa)](0x1f4)['json']({'success':![],'message':_0x60bd15(0x1f6)});}}),router['post'](a19_0x278df6(0x23c),async(_0x1a09c7,_0x5663f0)=>{const _0x40a1d7=a19_0x278df6;try{const {paymentId:_0x4edd0b}=_0x1a09c7[_0x40a1d7(0x20e)];console['log'](_0x40a1d7(0x208)+_0x4edd0b),await coinToPayStatusService_1[_0x40a1d7(0x1e7)][_0x40a1d7(0x1dd)](_0x4edd0b),_0x5663f0[_0x40a1d7(0x1f0)]({'success':!![],'message':_0x40a1d7(0x225)});}catch(_0x5b7c38){console[_0x40a1d7(0x235)](_0x40a1d7(0x1ed)+_0x1a09c7[_0x40a1d7(0x20e)][_0x40a1d7(0x24d)]+':',_0x5b7c38),_0x5663f0[_0x40a1d7(0x1fa)](0x1f4)['json']({'success':![],'message':_0x5b7c38 instanceof Error?_0x5b7c38[_0x40a1d7(0x244)]:'Failed\x20to\x20check\x20CoinToPay\x20payment\x20status'});}}),router[a19_0x278df6(0x255)](a19_0x278df6(0x22a),(_0x120325,_0x2ccfa8)=>{const _0x38339d=a19_0x278df6;try{const _0x173eca=coinToPayStatusService_1[_0x38339d(0x1e7)][_0x38339d(0x257)]();_0x2ccfa8[_0x38339d(0x1f0)]({'success':!![],'result':{..._0x173eca,'description':'CoinToPay\x20automatic\x20status\x20checking\x20service','statusMapping':{'Paid':_0x38339d(0x21a),'Awaiting\x20Fiat':_0x38339d(0x20c),'waiting':_0x38339d(0x20c),'expired':_0x38339d(0x23d),'failed':_0x38339d(0x218)},'autoExpiryNote':_0x38339d(0x256)+_0x173eca['expiryDays']+'\x20days\x20if\x20not\x20paid','individualTimersNote':_0x38339d(0x1df)}});}catch(_0x1a137f){_0x2ccfa8[_0x38339d(0x1fa)](0x1f4)['json']({'success':![],'message':_0x38339d(0x216)});}}),router['get']('/cointopay/payment/:paymentId',async(_0x424791,_0x52392a)=>{const _0x154628=a19_0x278df6;try{const {paymentId:_0x2b1b22}=_0x424791[_0x154628(0x20e)],_0x364f11=coinToPayStatusService_1[_0x154628(0x1e7)][_0x154628(0x1ff)](_0x2b1b22),_0x4b6441=(await Promise[_0x154628(0x1f8)]()[_0x154628(0x1fd)](()=>__importStar(require(_0x154628(0x222)))))[_0x154628(0x212)],_0x2cdd73=await _0x4b6441['payment'][_0x154628(0x1e3)]({'where':{'id':_0x2b1b22},'select':{'id':!![],'gateway':!![],'gatewayPaymentId':!![],'status':!![],'amount':!![],'currency':!![],'createdAt':!![],'updatedAt':!![],'shopId':!![],'shop':{'select':{'name':!![],'username':!![]}}}});if(!_0x2cdd73)return _0x52392a['status'](0x194)[_0x154628(0x1f0)]({'success':![],'message':_0x154628(0x230)});_0x52392a['json']({'success':!![],'result':{'payment':{'id':_0x2cdd73['id'],'gateway':_0x2cdd73[_0x154628(0x202)],'gatewayPaymentId':_0x2cdd73['gatewayPaymentId'],'status':_0x2cdd73[_0x154628(0x1fa)],'amount':_0x2cdd73[_0x154628(0x1ee)],'currency':_0x2cdd73[_0x154628(0x1fc)],'createdAt':_0x2cdd73[_0x154628(0x258)],'updatedAt':_0x2cdd73[_0x154628(0x241)],'shop':_0x2cdd73[_0x154628(0x236)]},'timers':_0x364f11,'isCoinToPay':_0x2cdd73[_0x154628(0x202)]===_0x154628(0x233),'ageInMinutes':Math[_0x154628(0x211)]((Date[_0x154628(0x1f3)]()-_0x2cdd73[_0x154628(0x258)][_0x154628(0x24f)]())/(0x3e8*0x3c))}});}catch(_0x6041ad){_0x52392a[_0x154628(0x1fa)](0x1f4)[_0x154628(0x1f0)]({'success':![],'message':_0x6041ad instanceof Error?_0x6041ad[_0x154628(0x244)]:_0x154628(0x20d)});}}),router['get']('/domain-monitoring/stats',(_0x26f0d2,_0x398de7)=>{const _0x195678=a19_0x278df6;try{const _0x5b5024=domainMonitoringService_1[_0x195678(0x1ec)][_0x195678(0x207)]();_0x398de7[_0x195678(0x1f0)]({'success':!![],'result':{..._0x5b5024,'description':_0x195678(0x227),'behavior':_0x195678(0x21d),'encoding':_0x195678(0x1e6)}});}catch(_0x476dfd){_0x398de7['status'](0x1f4)['json']({'success':![],'message':_0x195678(0x21e)});}}),router[a19_0x278df6(0x1f5)]('/domain-monitoring/check',async(_0x2c5ce6,_0x450c1d)=>{const _0x31305f=a19_0x278df6;try{const _0x3361c2=await domainMonitoringService_1['domainMonitoringService'][_0x31305f(0x240)]();_0x450c1d['json']({'success':!![],'result':{'domainAvailable':_0x3361c2,'message':_0x3361c2?'Domain\x20is\x20responding\x20correctly':_0x31305f(0x23a),'timestamp':new Date()[_0x31305f(0x247)]()}});}catch(_0x41d72b){_0x450c1d[_0x31305f(0x1fa)](0x1f4)[_0x31305f(0x1f0)]({'success':![],'message':_0x41d72b instanceof Error?_0x41d72b[_0x31305f(0x244)]:_0x31305f(0x234)});}}),exports['default']=router;