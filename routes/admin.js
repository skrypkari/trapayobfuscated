'use strict';const a20_0x143fa3=a20_0x9a91;(function(_0x1ea280,_0x5878a9){const _0xc8046=a20_0x9a91,_0x27789b=_0x1ea280();while(!![]){try{const _0x3ce200=-parseInt(_0xc8046(0x1c1))/0x1*(parseInt(_0xc8046(0x233))/0x2)+-parseInt(_0xc8046(0x1dc))/0x3+parseInt(_0xc8046(0x1df))/0x4+parseInt(_0xc8046(0x1cc))/0x5*(parseInt(_0xc8046(0x21a))/0x6)+-parseInt(_0xc8046(0x1cb))/0x7+parseInt(_0xc8046(0x1e7))/0x8+parseInt(_0xc8046(0x1ed))/0x9*(parseInt(_0xc8046(0x20f))/0xa);if(_0x3ce200===_0x5878a9)break;else _0x27789b['push'](_0x27789b['shift']());}catch(_0x3f8002){_0x27789b['push'](_0x27789b['shift']());}}}(a20_0x3afd,0x34569));var __createBinding=this&&this[a20_0x143fa3(0x20a)]||(Object['create']?function(_0x1c9ffa,_0x55cc2b,_0x2a34ec,_0x487e6c){const _0xd8b918=a20_0x143fa3;if(_0x487e6c===undefined)_0x487e6c=_0x2a34ec;var _0xa4d361=Object[_0xd8b918(0x1c8)](_0x55cc2b,_0x2a34ec);(!_0xa4d361||(_0xd8b918(0x22e)in _0xa4d361?!_0x55cc2b['__esModule']:_0xa4d361[_0xd8b918(0x1da)]||_0xa4d361[_0xd8b918(0x1c5)]))&&(_0xa4d361={'enumerable':!![],'get':function(){return _0x55cc2b[_0x2a34ec];}}),Object[_0xd8b918(0x1e5)](_0x1c9ffa,_0x487e6c,_0xa4d361);}:function(_0x1c5cc8,_0x11352c,_0x977834,_0x92c6db){if(_0x92c6db===undefined)_0x92c6db=_0x977834;_0x1c5cc8[_0x92c6db]=_0x11352c[_0x977834];}),__setModuleDefault=this&&this[a20_0x143fa3(0x1d1)]||(Object[a20_0x143fa3(0x1bb)]?function(_0x1cc112,_0x1681ee){const _0x181c76=a20_0x143fa3;Object[_0x181c76(0x1e5)](_0x1cc112,_0x181c76(0x1f5),{'enumerable':!![],'value':_0x1681ee});}:function(_0x2b4103,_0x2ee8f1){const _0xb364b4=a20_0x143fa3;_0x2b4103[_0xb364b4(0x1f5)]=_0x2ee8f1;}),__importStar=this&&this[a20_0x143fa3(0x1f1)]||(function(){var _0x5d26b2=function(_0x40ad97){return _0x5d26b2=Object['getOwnPropertyNames']||function(_0x1b7d8b){const _0x202e6c=a20_0x9a91;var _0x5c7c26=[];for(var _0x5e69ac in _0x1b7d8b)if(Object[_0x202e6c(0x1fa)][_0x202e6c(0x1c9)]['call'](_0x1b7d8b,_0x5e69ac))_0x5c7c26[_0x5c7c26[_0x202e6c(0x1c4)]]=_0x5e69ac;return _0x5c7c26;},_0x5d26b2(_0x40ad97);};return function(_0x2958f3){const _0x4c2cb7=a20_0x9a91;if(_0x2958f3&&_0x2958f3[_0x4c2cb7(0x214)])return _0x2958f3;var _0x7161fd={};if(_0x2958f3!=null){for(var _0x4a4054=_0x5d26b2(_0x2958f3),_0x17636e=0x0;_0x17636e<_0x4a4054[_0x4c2cb7(0x1c4)];_0x17636e++)if(_0x4a4054[_0x17636e]!==_0x4c2cb7(0x1f5))__createBinding(_0x7161fd,_0x2958f3,_0x4a4054[_0x17636e]);}return __setModuleDefault(_0x7161fd,_0x2958f3),_0x7161fd;};}());Object['defineProperty'](exports,a20_0x143fa3(0x214),{'value':!![]});const express_1=require(a20_0x143fa3(0x22b)),adminController_1=require('../controllers/adminController'),validation_1=require(a20_0x143fa3(0x227)),auth_1=require('../middleware/auth'),loggerService_1=require(a20_0x143fa3(0x223)),coinToPayStatusService_1=require('../services/coinToPayStatusService'),domainMonitoringService_1=require('../services/domainMonitoringService'),router=(0x0,express_1[a20_0x143fa3(0x215)])(),adminController=new adminController_1['AdminController']();function a20_0x9a91(_0x2373c3,_0x217e51){const _0x3afddb=a20_0x3afd();return a20_0x9a91=function(_0x9a910a,_0x530ff6){_0x9a910a=_0x9a910a-0x1b4;let _0x28a941=_0x3afddb[_0x9a910a];return _0x28a941;},a20_0x9a91(_0x2373c3,_0x217e51);}router['use'](auth_1[a20_0x143fa3(0x1b4)],auth_1[a20_0x143fa3(0x1e6)]),router[a20_0x143fa3(0x22e)](a20_0x143fa3(0x1ec),adminController[a20_0x143fa3(0x230)]),router[a20_0x143fa3(0x22e)](a20_0x143fa3(0x1f3),adminController['getStatistics']),router['get'](a20_0x143fa3(0x211),adminController['getMerchantStatistics']),router[a20_0x143fa3(0x22e)](a20_0x143fa3(0x1d4),adminController['getPayoutStats']),router['get'](a20_0x143fa3(0x1b9),adminController[a20_0x143fa3(0x210)]),router[a20_0x143fa3(0x22e)](a20_0x143fa3(0x1d9),adminController[a20_0x143fa3(0x1f0)]),router['post'](a20_0x143fa3(0x1f7),(0x0,validation_1[a20_0x143fa3(0x1c6)])(validation_1[a20_0x143fa3(0x1d3)]),adminController[a20_0x143fa3(0x228)]),router[a20_0x143fa3(0x22e)](a20_0x143fa3(0x1fc),adminController[a20_0x143fa3(0x231)]),router[a20_0x143fa3(0x22e)]('/payouts/:id',adminController[a20_0x143fa3(0x1b6)]),router[a20_0x143fa3(0x21e)](a20_0x143fa3(0x217),adminController[a20_0x143fa3(0x225)]),router['get'](a20_0x143fa3(0x1e3),adminController[a20_0x143fa3(0x1d8)]),router[a20_0x143fa3(0x22e)]('/payments/:id',adminController[a20_0x143fa3(0x1c7)]),router[a20_0x143fa3(0x1b5)](a20_0x143fa3(0x221),adminController[a20_0x143fa3(0x218)]),router['put'](a20_0x143fa3(0x22f),(0x0,validation_1[a20_0x143fa3(0x1c6)])(validation_1[a20_0x143fa3(0x232)]),adminController[a20_0x143fa3(0x203)]),router[a20_0x143fa3(0x22e)](a20_0x143fa3(0x20c),adminController[a20_0x143fa3(0x1ff)]),router[a20_0x143fa3(0x205)]('/payments/cleanup',adminController[a20_0x143fa3(0x201)]),router['post'](a20_0x143fa3(0x20b),adminController[a20_0x143fa3(0x1f2)]),router['post'](a20_0x143fa3(0x1fb),adminController['cleanupStalePaymentsWithReport']),router[a20_0x143fa3(0x22e)](a20_0x143fa3(0x1bf),adminController[a20_0x143fa3(0x22d)]),router[a20_0x143fa3(0x22e)](a20_0x143fa3(0x21d),adminController[a20_0x143fa3(0x1f6)]),router['post'](a20_0x143fa3(0x1bf),(0x0,validation_1[a20_0x143fa3(0x1c6)])(validation_1[a20_0x143fa3(0x1bc)]),adminController[a20_0x143fa3(0x1c0)]),router[a20_0x143fa3(0x1b5)](a20_0x143fa3(0x21d),(0x0,validation_1[a20_0x143fa3(0x1c6)])(validation_1[a20_0x143fa3(0x1ba)]),adminController[a20_0x143fa3(0x1d0)]),router['delete'](a20_0x143fa3(0x21d),adminController[a20_0x143fa3(0x20d)]),router[a20_0x143fa3(0x205)](a20_0x143fa3(0x1ca),adminController[a20_0x143fa3(0x1e0)]),router[a20_0x143fa3(0x205)](a20_0x143fa3(0x21c),adminController['activateUser']),router[a20_0x143fa3(0x22e)](a20_0x143fa3(0x1cd),(_0x11f962,_0x1871ad)=>{const _0x59ae9c=a20_0x143fa3;try{const _0x202ec8=loggerService_1['loggerService']['getLogStats']();_0x1871ad['json']({'success':!![],'result':_0x202ec8});}catch(_0x191cb9){_0x1871ad[_0x59ae9c(0x1f8)](0x1f4)[_0x59ae9c(0x1e4)]({'success':![],'message':_0x59ae9c(0x1b8)});}}),router[a20_0x143fa3(0x205)]('/logs/clean',(_0x51e214,_0x838039)=>{const _0xc59758=a20_0x143fa3;try{const {daysToKeep:daysToKeep=0x1e}=_0x51e214['body'];loggerService_1[_0xc59758(0x1c3)][_0xc59758(0x1b7)](daysToKeep),_0x838039['json']({'success':!![],'message':'Old\x20logs\x20cleaned\x20(kept\x20last\x20'+daysToKeep+_0xc59758(0x1d2)});}catch(_0x467f94){_0x838039['status'](0x1f4)[_0xc59758(0x1e4)]({'success':![],'message':_0xc59758(0x1e1)});}}),router[a20_0x143fa3(0x205)](a20_0x143fa3(0x202),async(_0x3ed250,_0x3b2f98)=>{const _0x531515=a20_0x143fa3;try{const {paymentId:_0x73c03e}=_0x3ed250[_0x531515(0x1dd)];console[_0x531515(0x1d7)](_0x531515(0x224)+_0x73c03e),await coinToPayStatusService_1[_0x531515(0x1f4)][_0x531515(0x200)](_0x73c03e),_0x3b2f98[_0x531515(0x1e4)]({'success':!![],'message':'CoinToPay\x20payment\x20status\x20checked\x20successfully'});}catch(_0x79a9b3){console['error'](_0x531515(0x1e2)+_0x3ed250[_0x531515(0x1dd)][_0x531515(0x22a)]+':',_0x79a9b3),_0x3b2f98[_0x531515(0x1f8)](0x1f4)[_0x531515(0x1e4)]({'success':![],'message':_0x79a9b3 instanceof Error?_0x79a9b3[_0x531515(0x207)]:'Failed\x20to\x20check\x20CoinToPay\x20payment\x20status'});}}),router[a20_0x143fa3(0x22e)](a20_0x143fa3(0x212),(_0x42fbc4,_0x3d6023)=>{const _0x3c0953=a20_0x143fa3;try{const _0x4c8139=coinToPayStatusService_1['coinToPayStatusService'][_0x3c0953(0x216)]();_0x3d6023[_0x3c0953(0x1e4)]({'success':!![],'result':{..._0x4c8139,'description':_0x3c0953(0x1eb),'statusMapping':{'Paid':'PAID','Awaiting\x20Fiat':_0x3c0953(0x1fe),'waiting':_0x3c0953(0x1fe),'expired':_0x3c0953(0x1ea),'failed':_0x3c0953(0x1e9)},'autoExpiryNote':_0x3c0953(0x1bd)+_0x4c8139[_0x3c0953(0x209)]+_0x3c0953(0x22c),'individualTimersNote':_0x3c0953(0x213)}});}catch(_0x269b22){_0x3d6023['status'](0x1f4)[_0x3c0953(0x1e4)]({'success':![],'message':_0x3c0953(0x1cf)});}}),router[a20_0x143fa3(0x22e)](a20_0x143fa3(0x208),async(_0x46c333,_0x181ce1)=>{const _0x10dfb6=a20_0x143fa3;try{const {paymentId:_0xbacf84}=_0x46c333[_0x10dfb6(0x1dd)],_0x50713f=coinToPayStatusService_1[_0x10dfb6(0x1f4)][_0x10dfb6(0x21f)](_0xbacf84),_0x405239=(await Promise['resolve']()[_0x10dfb6(0x1c2)](()=>__importStar(require(_0x10dfb6(0x204)))))['default'],_0xd72f02=await _0x405239[_0x10dfb6(0x21b)][_0x10dfb6(0x1db)]({'where':{'id':_0xbacf84},'select':{'id':!![],'gateway':!![],'gatewayPaymentId':!![],'status':!![],'amount':!![],'currency':!![],'createdAt':!![],'updatedAt':!![],'shopId':!![],'shop':{'select':{'name':!![],'username':!![]}}}});if(!_0xd72f02)return _0x181ce1['status'](0x194)['json']({'success':![],'message':_0x10dfb6(0x1f9)});_0x181ce1[_0x10dfb6(0x1e4)]({'success':!![],'result':{'payment':{'id':_0xd72f02['id'],'gateway':_0xd72f02[_0x10dfb6(0x206)],'gatewayPaymentId':_0xd72f02[_0x10dfb6(0x1d6)],'status':_0xd72f02['status'],'amount':_0xd72f02['amount'],'currency':_0xd72f02['currency'],'createdAt':_0xd72f02['createdAt'],'updatedAt':_0xd72f02[_0x10dfb6(0x20e)],'shop':_0xd72f02[_0x10dfb6(0x220)]},'timers':_0x50713f,'isCoinToPay':_0xd72f02[_0x10dfb6(0x206)]===_0x10dfb6(0x1ce),'ageInMinutes':Math[_0x10dfb6(0x1ef)]((Date[_0x10dfb6(0x1fd)]()-_0xd72f02[_0x10dfb6(0x1d5)]['getTime']())/(0x3e8*0x3c))}});}catch(_0x12c71e){_0x181ce1['status'](0x1f4)[_0x10dfb6(0x1e4)]({'success':![],'message':_0x12c71e instanceof Error?_0x12c71e[_0x10dfb6(0x207)]:'Failed\x20to\x20get\x20payment\x20information'});}}),router['get']('/domain-monitoring/stats',(_0x289a13,_0x2da824)=>{const _0x148af6=a20_0x143fa3;try{const _0x2a4a9d=domainMonitoringService_1['domainMonitoringService']['getMonitoringStats']();_0x2da824[_0x148af6(0x1e4)]({'success':!![],'result':{..._0x2a4a9d,'description':_0x148af6(0x1be),'behavior':_0x148af6(0x1de),'encoding':_0x148af6(0x1e8)}});}catch(_0x5ea832){_0x2da824[_0x148af6(0x1f8)](0x1f4)['json']({'success':![],'message':_0x148af6(0x229)});}}),router[a20_0x143fa3(0x205)](a20_0x143fa3(0x226),async(_0x295227,_0x50f356)=>{const _0xae4ef4=a20_0x143fa3;try{const _0x4fb857=await domainMonitoringService_1['domainMonitoringService']['manualCheck']();_0x50f356['json']({'success':!![],'result':{'domainAvailable':_0x4fb857,'message':_0x4fb857?_0xae4ef4(0x1ee):_0xae4ef4(0x219),'timestamp':new Date()['toISOString']()}});}catch(_0x56fce5){_0x50f356[_0xae4ef4(0x1f8)](0x1f4)[_0xae4ef4(0x1e4)]({'success':![],'message':_0x56fce5 instanceof Error?_0x56fce5['message']:_0xae4ef4(0x222)});}}),exports[a20_0x143fa3(0x1f5)]=router;function a20_0x3afd(){const _0x16d49f=['floor','getMerchantsSelection','__importStar','cleanupStalePendingPayments','/statistics','coinToPayStatusService','default','getUserById','/payout','status','Payment\x20not\x20found','prototype','/payments/cleanup-with-report','/payouts','now','PENDING','getProcessingPaymentsStats','checkPaymentById','cleanupStalePayments','/cointopay/check/:paymentId','updateCustomerData','../config/database','post','gateway','message','/cointopay/payment/:paymentId','expiryDays','__createBinding','/payments/cleanup-pending','/payments/processing-stats','deleteUser','updatedAt','286210UfzQQt','getMerchantsAwaitingPayout','/merchant-statistics','/cointopay/stats','Each\x20new\x20payment\x20gets\x20individual\x20timers:\x201min,\x202min,\x207min,\x2012min,\x20then\x20hourly','__esModule','Router','getServiceStats','/payouts/:id','updatePayment','Domain\x20check\x20failed','282vjvwaq','payment','/users/:id/activate','/users/:id','delete','getPaymentTimerInfo','shop','/payments/:id','Failed\x20to\x20perform\x20manual\x20domain\x20check','../services/loggerService','🔍\x20[ADMIN]\x20Manual\x20CoinToPay\x20check\x20requested\x20for\x20payment:\x20','deletePayout','/domain-monitoring/check','../middleware/validation','createPayout','Failed\x20to\x20get\x20domain\x20monitoring\x20statistics','paymentId','express','\x20days\x20if\x20not\x20paid','getUsers','get','/payments/:id/customer','checkAuth','getPayouts','updateCustomerDataSchema','4222mwIqgo','authenticateToken','put','getPayoutById','cleanOldLogs','Failed\x20to\x20get\x20log\x20statistics','/payout/merchants','updateUserSchema','create','createUserSchema','Payments\x20automatically\x20expire\x20after\x20','Domain\x20monitoring\x20service\x20for\x20amaterasy884.icu','/users','createUser','93qVnXJI','then','loggerService','length','configurable','validate','getPaymentById','getOwnPropertyDescriptor','hasOwnProperty','/users/:id/suspend','1517677NSoHfh','11695eaBRDm','/logs/stats','cointopay','Failed\x20to\x20get\x20CoinToPay\x20service\x20statistics','updateUser','__setModuleDefault','\x20days)','createPayoutSchema','/payout/stats','createdAt','gatewayPaymentId','log','getPayments','/merchants/selection','writable','findUnique','848247fRoPQO','params','Server\x20crashes\x20if\x20domain\x20is\x20not\x20responding\x20after\x20consecutive\x20failures','1286428AQIqJm','suspendUser','Failed\x20to\x20clean\x20old\x20logs','❌\x20[ADMIN]\x20Manual\x20CoinToPay\x20check\x20failed\x20for\x20payment\x20','/payments','json','defineProperty','requireAdmin','1311112IVELvs','Requests\x20are\x20made\x20with\x20base64\x20encoded\x20URLs','FAILED','EXPIRED','CoinToPay\x20automatic\x20status\x20checking\x20service','/auth','99DKShiw','Domain\x20is\x20responding\x20correctly'];a20_0x3afd=function(){return _0x16d49f;};return a20_0x3afd();}