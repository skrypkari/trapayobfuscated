'use strict';const a21_0x50be0d=a21_0x78f7;function a21_0x78f7(_0x518324,_0x362306){const _0x1d8a71=a21_0x1d8a();return a21_0x78f7=function(_0x78f7c5,_0x4a1fac){_0x78f7c5=_0x78f7c5-0xe5;let _0x4fb020=_0x1d8a71[_0x78f7c5];return _0x4fb020;},a21_0x78f7(_0x518324,_0x362306);}(function(_0x1ac8a5,_0x33bf47){const _0x3e3c20=a21_0x78f7,_0x22290f=_0x1ac8a5();while(!![]){try{const _0x50f604=parseInt(_0x3e3c20(0x102))/0x1*(-parseInt(_0x3e3c20(0x124))/0x2)+-parseInt(_0x3e3c20(0x12a))/0x3+parseInt(_0x3e3c20(0xe5))/0x4+parseInt(_0x3e3c20(0x133))/0x5*(-parseInt(_0x3e3c20(0x11e))/0x6)+-parseInt(_0x3e3c20(0x12b))/0x7+parseInt(_0x3e3c20(0xf7))/0x8*(-parseInt(_0x3e3c20(0xed))/0x9)+parseInt(_0x3e3c20(0xea))/0xa;if(_0x50f604===_0x33bf47)break;else _0x22290f['push'](_0x22290f['shift']());}catch(_0x2340f1){_0x22290f['push'](_0x22290f['shift']());}}}(a21_0x1d8a,0xe9c94));var __createBinding=this&&this[a21_0x50be0d(0x142)]||(Object[a21_0x50be0d(0x100)]?function(_0x26aec9,_0x4948a0,_0x2dc2de,_0x421c2b){const _0x36bb11=a21_0x50be0d;if(_0x421c2b===undefined)_0x421c2b=_0x2dc2de;var _0x2e046e=Object[_0x36bb11(0xee)](_0x4948a0,_0x2dc2de);(!_0x2e046e||(_0x36bb11(0x129)in _0x2e046e?!_0x4948a0[_0x36bb11(0x134)]:_0x2e046e[_0x36bb11(0x12f)]||_0x2e046e['configurable']))&&(_0x2e046e={'enumerable':!![],'get':function(){return _0x4948a0[_0x2dc2de];}}),Object[_0x36bb11(0x147)](_0x26aec9,_0x421c2b,_0x2e046e);}:function(_0x16c39c,_0x48ebb6,_0x369726,_0x683827){if(_0x683827===undefined)_0x683827=_0x369726;_0x16c39c[_0x683827]=_0x48ebb6[_0x369726];}),__setModuleDefault=this&&this[a21_0x50be0d(0x132)]||(Object[a21_0x50be0d(0x100)]?function(_0x55d148,_0x395b91){const _0x17104d=a21_0x50be0d;Object[_0x17104d(0x147)](_0x55d148,_0x17104d(0x143),{'enumerable':!![],'value':_0x395b91});}:function(_0x11f722,_0x4fcdc9){const _0x57aed2=a21_0x50be0d;_0x11f722[_0x57aed2(0x143)]=_0x4fcdc9;}),__importStar=this&&this[a21_0x50be0d(0x103)]||(function(){var _0x7eeb13=function(_0x2fb6a8){const _0x456baf=a21_0x78f7;return _0x7eeb13=Object[_0x456baf(0x12e)]||function(_0x5f4aef){const _0x258599=_0x456baf;var _0x36ec7f=[];for(var _0x480bdb in _0x5f4aef)if(Object[_0x258599(0xef)]['hasOwnProperty'][_0x258599(0x154)](_0x5f4aef,_0x480bdb))_0x36ec7f[_0x36ec7f[_0x258599(0xfc)]]=_0x480bdb;return _0x36ec7f;},_0x7eeb13(_0x2fb6a8);};return function(_0x47ae30){const _0x32006b=a21_0x78f7;if(_0x47ae30&&_0x47ae30[_0x32006b(0x134)])return _0x47ae30;var _0xe98a15={};if(_0x47ae30!=null){for(var _0x66b797=_0x7eeb13(_0x47ae30),_0x2871f3=0x0;_0x2871f3<_0x66b797[_0x32006b(0xfc)];_0x2871f3++)if(_0x66b797[_0x2871f3]!=='default')__createBinding(_0xe98a15,_0x47ae30,_0x66b797[_0x2871f3]);}return __setModuleDefault(_0xe98a15,_0x47ae30),_0xe98a15;};}());Object[a21_0x50be0d(0x147)](exports,a21_0x50be0d(0x134),{'value':!![]});const express_1=require('express'),adminController_1=require(a21_0x50be0d(0x131)),validation_1=require(a21_0x50be0d(0xf1)),auth_1=require(a21_0x50be0d(0x14d)),loggerService_1=require('../services/loggerService'),coinToPayStatusService_1=require(a21_0x50be0d(0x12c)),domainMonitoringService_1=require('../services/domainMonitoringService'),router=(0x0,express_1[a21_0x50be0d(0x118)])(),adminController=new adminController_1['AdminController']();function a21_0x1d8a(){const _0x3dd4e9=['updateUser','error','loggerService','get','3216303zEqJJT','11780125kSSghj','../services/coinToPayStatusService','getPaymentTimerInfo','getOwnPropertyNames','writable','/domain-monitoring/stats','../controllers/adminController','__setModuleDefault','1145sZOEkD','__esModule','put','createPayoutSchema','getTime','Payment\x20not\x20found','updateCustomerDataSchema','now','/cointopay/stats','/auth','/payments/:id/customer','/payout/merchants','amount','/payouts','delete','__createBinding','default','status','Failed\x20to\x20get\x20CoinToPay\x20service\x20statistics','getMerchantsSelection','defineProperty','/payout','params','json','deletePayout','Server\x20crashes\x20if\x20domain\x20is\x20not\x20responding\x20after\x20consecutive\x20failures','../middleware/auth','/statistics','coinToPayStatusService','\x20days\x20if\x20not\x20paid','expiryDays','payment','/merchant-statistics','call','/users','suspendUser','getPayouts','PENDING','updateUserSchema','Failed\x20to\x20perform\x20manual\x20domain\x20check','\x20days)','domainMonitoringService','/logs/stats','/domain-monitoring/check','createPayout','Failed\x20to\x20get\x20domain\x20monitoring\x20statistics','Payments\x20automatically\x20expire\x20after\x20','üîç\x20[ADMIN]\x20Manual\x20CoinToPay\x20check\x20requested\x20for\x20payment:\x20','172752bFJbxP','Old\x20logs\x20cleaned\x20(kept\x20last\x20','cleanupStalePaymentsWithReport','checkAuth','message','82270960VcKyFJ','/merchants/selection','getServiceStats','11381895NHGQdT','getOwnPropertyDescriptor','prototype','/cointopay/check/:paymentId','../middleware/validation','/payouts/:id','createdAt','getMerchantsAwaitingPayout','getUsers','/payments/:id','8LjQBfK','getPayoutStats','createUserSchema','findUnique','getUserById','length','Failed\x20to\x20get\x20payment\x20information','use','getMonitoringStats','create','/users/:id','311791oJJcbt','__importStar','requireAdmin','getPaymentById','getStatistics','/payments','PAID','getLogStats','getProcessingPaymentsStats','Domain\x20check\x20failed','Each\x20new\x20payment\x20gets\x20individual\x20timers:\x201min,\x202min,\x207min,\x2012min,\x20then\x20hourly','post','validate','gateway','activateUser','/cointopay/payment/:paymentId','Failed\x20to\x20check\x20CoinToPay\x20payment\x20status','paymentId','EXPIRED','CoinToPay\x20automatic\x20status\x20checking\x20service','/logs/clean','CoinToPay\x20payment\x20status\x20checked\x20successfully','Router','updateCustomerData','/payments/cleanup-pending','/payments/cleanup-with-report','getPayments','Failed\x20to\x20clean\x20old\x20logs','37266zBwGoV','/payments/cleanup','getMerchantStatistics','cointopay','checkPaymentById','cleanupStalePayments','12olvDYM','shop'];a21_0x1d8a=function(){return _0x3dd4e9;};return a21_0x1d8a();}router[a21_0x50be0d(0xfe)](auth_1['authenticateToken'],auth_1[a21_0x50be0d(0x104)]),router[a21_0x50be0d(0x129)](a21_0x50be0d(0x13c),adminController[a21_0x50be0d(0xe8)]),router[a21_0x50be0d(0x129)](a21_0x50be0d(0x14e),adminController[a21_0x50be0d(0x106)]),router[a21_0x50be0d(0x129)](a21_0x50be0d(0x153),adminController[a21_0x50be0d(0x120)]),router[a21_0x50be0d(0x129)]('/payout/stats',adminController[a21_0x50be0d(0xf8)]),router[a21_0x50be0d(0x129)](a21_0x50be0d(0x13e),adminController[a21_0x50be0d(0xf4)]),router[a21_0x50be0d(0x129)](a21_0x50be0d(0xeb),adminController[a21_0x50be0d(0x146)]),router[a21_0x50be0d(0x10d)](a21_0x50be0d(0x148),(0x0,validation_1[a21_0x50be0d(0x10e)])(validation_1[a21_0x50be0d(0x136)]),adminController[a21_0x50be0d(0x15f)]),router[a21_0x50be0d(0x129)](a21_0x50be0d(0x140),adminController[a21_0x50be0d(0x157)]),router[a21_0x50be0d(0x129)]('/payouts/:id',adminController['getPayoutById']),router[a21_0x50be0d(0x141)](a21_0x50be0d(0xf2),adminController[a21_0x50be0d(0x14b)]),router[a21_0x50be0d(0x129)](a21_0x50be0d(0x107),adminController[a21_0x50be0d(0x11c)]),router['get'](a21_0x50be0d(0xf6),adminController[a21_0x50be0d(0x105)]),router[a21_0x50be0d(0x135)](a21_0x50be0d(0xf6),adminController['updatePayment']),router[a21_0x50be0d(0x135)](a21_0x50be0d(0x13d),(0x0,validation_1[a21_0x50be0d(0x10e)])(validation_1[a21_0x50be0d(0x139)]),adminController[a21_0x50be0d(0x119)]),router[a21_0x50be0d(0x129)]('/payments/processing-stats',adminController[a21_0x50be0d(0x10a)]),router[a21_0x50be0d(0x10d)](a21_0x50be0d(0x11f),adminController[a21_0x50be0d(0x123)]),router[a21_0x50be0d(0x10d)](a21_0x50be0d(0x11a),adminController['cleanupStalePendingPayments']),router[a21_0x50be0d(0x10d)](a21_0x50be0d(0x11b),adminController[a21_0x50be0d(0xe7)]),router['get'](a21_0x50be0d(0x155),adminController[a21_0x50be0d(0xf5)]),router[a21_0x50be0d(0x129)](a21_0x50be0d(0x101),adminController[a21_0x50be0d(0xfb)]),router[a21_0x50be0d(0x10d)](a21_0x50be0d(0x155),(0x0,validation_1[a21_0x50be0d(0x10e)])(validation_1[a21_0x50be0d(0xf9)]),adminController['createUser']),router[a21_0x50be0d(0x135)](a21_0x50be0d(0x101),(0x0,validation_1['validate'])(validation_1[a21_0x50be0d(0x159)]),adminController[a21_0x50be0d(0x126)]),router[a21_0x50be0d(0x141)]('/users/:id',adminController['deleteUser']),router[a21_0x50be0d(0x10d)]('/users/:id/suspend',adminController[a21_0x50be0d(0x156)]),router[a21_0x50be0d(0x10d)]('/users/:id/activate',adminController[a21_0x50be0d(0x110)]),router[a21_0x50be0d(0x129)](a21_0x50be0d(0x15d),(_0x4fc32f,_0x5bde23)=>{const _0x1bc2a3=a21_0x50be0d;try{const _0x57f8c1=loggerService_1['loggerService'][_0x1bc2a3(0x109)]();_0x5bde23['json']({'success':!![],'result':_0x57f8c1});}catch(_0x47c87a){_0x5bde23[_0x1bc2a3(0x144)](0x1f4)['json']({'success':![],'message':'Failed\x20to\x20get\x20log\x20statistics'});}}),router[a21_0x50be0d(0x10d)](a21_0x50be0d(0x116),(_0x26fa60,_0x1a60b9)=>{const _0x1686cf=a21_0x50be0d;try{const {daysToKeep:daysToKeep=0x1e}=_0x26fa60['body'];loggerService_1[_0x1686cf(0x128)]['cleanOldLogs'](daysToKeep),_0x1a60b9[_0x1686cf(0x14a)]({'success':!![],'message':_0x1686cf(0xe6)+daysToKeep+_0x1686cf(0x15b)});}catch(_0x32571a){_0x1a60b9[_0x1686cf(0x144)](0x1f4)['json']({'success':![],'message':_0x1686cf(0x11d)});}}),router[a21_0x50be0d(0x10d)](a21_0x50be0d(0xf0),async(_0xcf130d,_0x53b662)=>{const _0x2ef22e=a21_0x50be0d;try{const {paymentId:_0x2d77b9}=_0xcf130d[_0x2ef22e(0x149)];console['log'](_0x2ef22e(0x162)+_0x2d77b9),await coinToPayStatusService_1['coinToPayStatusService'][_0x2ef22e(0x122)](_0x2d77b9),_0x53b662[_0x2ef22e(0x14a)]({'success':!![],'message':_0x2ef22e(0x117)});}catch(_0x584f8a){console[_0x2ef22e(0x127)]('‚ùå\x20[ADMIN]\x20Manual\x20CoinToPay\x20check\x20failed\x20for\x20payment\x20'+_0xcf130d[_0x2ef22e(0x149)][_0x2ef22e(0x113)]+':',_0x584f8a),_0x53b662[_0x2ef22e(0x144)](0x1f4)[_0x2ef22e(0x14a)]({'success':![],'message':_0x584f8a instanceof Error?_0x584f8a[_0x2ef22e(0xe9)]:_0x2ef22e(0x112)});}}),router[a21_0x50be0d(0x129)](a21_0x50be0d(0x13b),(_0x3aaff4,_0x4320f4)=>{const _0x28adcb=a21_0x50be0d;try{const _0x59d3f0=coinToPayStatusService_1[_0x28adcb(0x14f)][_0x28adcb(0xec)]();_0x4320f4[_0x28adcb(0x14a)]({'success':!![],'result':{..._0x59d3f0,'description':_0x28adcb(0x115),'statusMapping':{'Paid':_0x28adcb(0x108),'Awaiting\x20Fiat':_0x28adcb(0x158),'waiting':_0x28adcb(0x158),'expired':_0x28adcb(0x114),'failed':'FAILED'},'autoExpiryNote':_0x28adcb(0x161)+_0x59d3f0[_0x28adcb(0x151)]+_0x28adcb(0x150),'individualTimersNote':_0x28adcb(0x10c)}});}catch(_0x4a33ba){_0x4320f4['status'](0x1f4)[_0x28adcb(0x14a)]({'success':![],'message':_0x28adcb(0x145)});}}),router[a21_0x50be0d(0x129)](a21_0x50be0d(0x111),async(_0x4ace4b,_0x59b56f)=>{const _0x1da7a1=a21_0x50be0d;try{const {paymentId:_0x1e111f}=_0x4ace4b[_0x1da7a1(0x149)],_0x16a142=coinToPayStatusService_1['coinToPayStatusService'][_0x1da7a1(0x12d)](_0x1e111f),_0x40c598=(await Promise['resolve']()['then'](()=>__importStar(require('../config/database'))))[_0x1da7a1(0x143)],_0x840b8e=await _0x40c598[_0x1da7a1(0x152)][_0x1da7a1(0xfa)]({'where':{'id':_0x1e111f},'select':{'id':!![],'gateway':!![],'gatewayPaymentId':!![],'status':!![],'amount':!![],'currency':!![],'createdAt':!![],'updatedAt':!![],'shopId':!![],'shop':{'select':{'name':!![],'username':!![]}}}});if(!_0x840b8e)return _0x59b56f[_0x1da7a1(0x144)](0x194)[_0x1da7a1(0x14a)]({'success':![],'message':_0x1da7a1(0x138)});_0x59b56f[_0x1da7a1(0x14a)]({'success':!![],'result':{'payment':{'id':_0x840b8e['id'],'gateway':_0x840b8e[_0x1da7a1(0x10f)],'gatewayPaymentId':_0x840b8e['gatewayPaymentId'],'status':_0x840b8e[_0x1da7a1(0x144)],'amount':_0x840b8e[_0x1da7a1(0x13f)],'currency':_0x840b8e['currency'],'createdAt':_0x840b8e[_0x1da7a1(0xf3)],'updatedAt':_0x840b8e['updatedAt'],'shop':_0x840b8e[_0x1da7a1(0x125)]},'timers':_0x16a142,'isCoinToPay':_0x840b8e[_0x1da7a1(0x10f)]===_0x1da7a1(0x121),'ageInMinutes':Math['floor']((Date[_0x1da7a1(0x13a)]()-_0x840b8e[_0x1da7a1(0xf3)][_0x1da7a1(0x137)]())/(0x3e8*0x3c))}});}catch(_0x434108){_0x59b56f[_0x1da7a1(0x144)](0x1f4)[_0x1da7a1(0x14a)]({'success':![],'message':_0x434108 instanceof Error?_0x434108[_0x1da7a1(0xe9)]:_0x1da7a1(0xfd)});}}),router[a21_0x50be0d(0x129)](a21_0x50be0d(0x130),(_0x27e7b5,_0x5649d4)=>{const _0x2c621c=a21_0x50be0d;try{const _0x33b2cc=domainMonitoringService_1[_0x2c621c(0x15c)][_0x2c621c(0xff)]();_0x5649d4['json']({'success':!![],'result':{..._0x33b2cc,'description':'Domain\x20monitoring\x20service\x20for\x20amaterasy884.icu','behavior':_0x2c621c(0x14c),'encoding':'Requests\x20are\x20made\x20with\x20base64\x20encoded\x20URLs'}});}catch(_0x3c88a){_0x5649d4[_0x2c621c(0x144)](0x1f4)[_0x2c621c(0x14a)]({'success':![],'message':_0x2c621c(0x160)});}}),router[a21_0x50be0d(0x10d)](a21_0x50be0d(0x15e),async(_0x1eb990,_0x24b03e)=>{const _0x5ecb16=a21_0x50be0d;try{const _0x211947=await domainMonitoringService_1['domainMonitoringService']['manualCheck']();_0x24b03e['json']({'success':!![],'result':{'domainAvailable':_0x211947,'message':_0x211947?'Domain\x20is\x20responding\x20correctly':_0x5ecb16(0x10b),'timestamp':new Date()['toISOString']()}});}catch(_0x5dd197){_0x24b03e[_0x5ecb16(0x144)](0x1f4)[_0x5ecb16(0x14a)]({'success':![],'message':_0x5dd197 instanceof Error?_0x5dd197[_0x5ecb16(0xe9)]:_0x5ecb16(0x15a)});}}),exports['default']=router;