'use strict';const a20_0x23f0c0=a20_0x58f2;(function(_0x64e935,_0x119e60){const _0x5261ce=a20_0x58f2,_0x5a60b7=_0x64e935();while(!![]){try{const _0x1dae4a=-parseInt(_0x5261ce(0x8d))/0x1+parseInt(_0x5261ce(0x86))/0x2*(parseInt(_0x5261ce(0xdb))/0x3)+parseInt(_0x5261ce(0xa4))/0x4*(-parseInt(_0x5261ce(0xb9))/0x5)+-parseInt(_0x5261ce(0xb4))/0x6*(parseInt(_0x5261ce(0xa9))/0x7)+parseInt(_0x5261ce(0x99))/0x8+-parseInt(_0x5261ce(0xc2))/0x9+parseInt(_0x5261ce(0x9c))/0xa;if(_0x1dae4a===_0x119e60)break;else _0x5a60b7['push'](_0x5a60b7['shift']());}catch(_0x2d2482){_0x5a60b7['push'](_0x5a60b7['shift']());}}}(a20_0x16ae,0x23202));function a20_0x16ae(){const _0x4ad4e7=['22qHvKGw','checkPaymentById','/auth','json','manualCheck','resolve','default','13216jRzWzf','getUsers','configurable','express','loggerService','coinToPayStatusService','CoinToPay\x20payment\x20status\x20checked\x20successfully','Domain\x20monitoring\x20service\x20for\x20amaterasy884.icu','getPaymentById','then','/cointopay/stats','__importStar','779160aYTfEo','gateway','/payout/merchants','2996950UQfLpw','createdAt','__esModule','log','writable','getPayoutStats','/payments/:id/customer','Failed\x20to\x20get\x20payment\x20information','4zEoJEK','/users/:id/suspend','get','getPayoutById','message','7NvnRJf','\x20days)','getServiceStats','gatewayPaymentId','Requests\x20are\x20made\x20with\x20base64\x20encoded\x20URLs','/payments','/payments/processing-stats','/users/:id','getMerchantStatistics','updatePayment','payment','177162yUDVLG','../services/domainMonitoringService','/payout/stats','Failed\x20to\x20get\x20log\x20statistics','requireAdmin','1031410KVBnZe','error','/payments/cleanup','call','getStatistics','/payments/:id','../services/coinToPayStatusService','createUser','shop','1356003nzSeEp','authenticateToken','expiryDays','suspendUser','delete','validate','cleanupStalePaymentsWithReport','Failed\x20to\x20clean\x20old\x20logs','/statistics','Domain\x20is\x20responding\x20correctly','createPayoutSchema','now','Failed\x20to\x20get\x20CoinToPay\x20service\x20statistics','status','getOwnPropertyDescriptor','/payouts','deletePayout','/domain-monitoring/stats','deleteUser','__createBinding','Failed\x20to\x20get\x20domain\x20monitoring\x20statistics','/domain-monitoring/check','/cointopay/check/:paymentId','../middleware/validation','getPayments','39948eaFZGN','put','PAID','Old\x20logs\x20cleaned\x20(kept\x20last\x20','currency','getMonitoringStats','createUserSchema','../services/loggerService','/merchants/selection','__setModuleDefault','Payment\x20not\x20found','findUnique','domainMonitoringService','amount','body','/payouts/:id','/logs/clean','CoinToPay\x20automatic\x20status\x20checking\x20service','params','prototype','create','use','paymentId','updateCustomerDataSchema','post','defineProperty','Router','createPayout','AdminController','length','updateUserSchema','activateUser','getLogStats','floor','../middleware/auth','/cointopay/payment/:paymentId','checkAuth'];a20_0x16ae=function(){return _0x4ad4e7;};return a20_0x16ae();}function a20_0x58f2(_0x318265,_0x4a2ebe){const _0x16ae38=a20_0x16ae();return a20_0x58f2=function(_0x58f2ac,_0x56339c){_0x58f2ac=_0x58f2ac-0x6b;let _0x49a6d3=_0x16ae38[_0x58f2ac];return _0x49a6d3;},a20_0x58f2(_0x318265,_0x4a2ebe);}var __createBinding=this&&this[a20_0x23f0c0(0xd5)]||(Object[a20_0x23f0c0(0x75)]?function(_0x2095df,_0x354802,_0x35c47c,_0xc0d7d4){const _0x27e836=a20_0x23f0c0;if(_0xc0d7d4===undefined)_0xc0d7d4=_0x35c47c;var _0x1988ca=Object[_0x27e836(0xd0)](_0x354802,_0x35c47c);(!_0x1988ca||(_0x27e836(0xa6)in _0x1988ca?!_0x354802[_0x27e836(0x9e)]:_0x1988ca[_0x27e836(0xa0)]||_0x1988ca[_0x27e836(0x8f)]))&&(_0x1988ca={'enumerable':!![],'get':function(){return _0x354802[_0x35c47c];}}),Object[_0x27e836(0x7a)](_0x2095df,_0xc0d7d4,_0x1988ca);}:function(_0x366b50,_0x464422,_0x5dca66,_0x3a6024){if(_0x3a6024===undefined)_0x3a6024=_0x5dca66;_0x366b50[_0x3a6024]=_0x464422[_0x5dca66];}),__setModuleDefault=this&&this[a20_0x23f0c0(0xe4)]||(Object[a20_0x23f0c0(0x75)]?function(_0x2e88de,_0x25f7e9){const _0x1d75aa=a20_0x23f0c0;Object[_0x1d75aa(0x7a)](_0x2e88de,_0x1d75aa(0x8c),{'enumerable':!![],'value':_0x25f7e9});}:function(_0x3ed98c,_0x27f984){const _0x314ef8=a20_0x23f0c0;_0x3ed98c[_0x314ef8(0x8c)]=_0x27f984;}),__importStar=this&&this[a20_0x23f0c0(0x98)]||(function(){var _0x2f825a=function(_0x22c280){return _0x2f825a=Object['getOwnPropertyNames']||function(_0x240528){const _0xf5cb33=a20_0x58f2;var _0x2caeb5=[];for(var _0xc3d1ec in _0x240528)if(Object[_0xf5cb33(0x74)]['hasOwnProperty'][_0xf5cb33(0xbc)](_0x240528,_0xc3d1ec))_0x2caeb5[_0x2caeb5[_0xf5cb33(0x7e)]]=_0xc3d1ec;return _0x2caeb5;},_0x2f825a(_0x22c280);};return function(_0x88a66a){const _0x1e9477=a20_0x58f2;if(_0x88a66a&&_0x88a66a[_0x1e9477(0x9e)])return _0x88a66a;var _0x131ec5={};if(_0x88a66a!=null){for(var _0x154bf6=_0x2f825a(_0x88a66a),_0x3865b8=0x0;_0x3865b8<_0x154bf6[_0x1e9477(0x7e)];_0x3865b8++)if(_0x154bf6[_0x3865b8]!=='default')__createBinding(_0x131ec5,_0x88a66a,_0x154bf6[_0x3865b8]);}return __setModuleDefault(_0x131ec5,_0x88a66a),_0x131ec5;};}());Object[a20_0x23f0c0(0x7a)](exports,'__esModule',{'value':!![]});const express_1=require(a20_0x23f0c0(0x90)),adminController_1=require('../controllers/adminController'),validation_1=require(a20_0x23f0c0(0xd9)),auth_1=require(a20_0x23f0c0(0x83)),loggerService_1=require(a20_0x23f0c0(0xe2)),coinToPayStatusService_1=require(a20_0x23f0c0(0xbf)),domainMonitoringService_1=require(a20_0x23f0c0(0xb5)),router=(0x0,express_1[a20_0x23f0c0(0x7b)])(),adminController=new adminController_1[(a20_0x23f0c0(0x7d))]();router[a20_0x23f0c0(0x76)](auth_1[a20_0x23f0c0(0xc3)],auth_1[a20_0x23f0c0(0xb8)]),router[a20_0x23f0c0(0xa6)](a20_0x23f0c0(0x88),adminController[a20_0x23f0c0(0x85)]),router[a20_0x23f0c0(0xa6)](a20_0x23f0c0(0xca),adminController[a20_0x23f0c0(0xbd)]),router[a20_0x23f0c0(0xa6)]('/merchant-statistics',adminController[a20_0x23f0c0(0xb1)]),router[a20_0x23f0c0(0xa6)](a20_0x23f0c0(0xb6),adminController[a20_0x23f0c0(0xa1)]),router[a20_0x23f0c0(0xa6)](a20_0x23f0c0(0x9b),adminController['getMerchantsAwaitingPayout']),router['get'](a20_0x23f0c0(0xe3),adminController['getMerchantsSelection']),router['post']('/payout',(0x0,validation_1['validate'])(validation_1[a20_0x23f0c0(0xcc)]),adminController[a20_0x23f0c0(0x7c)]),router['get'](a20_0x23f0c0(0xd1),adminController['getPayouts']),router[a20_0x23f0c0(0xa6)]('/payouts/:id',adminController[a20_0x23f0c0(0xa7)]),router[a20_0x23f0c0(0xc6)](a20_0x23f0c0(0x70),adminController[a20_0x23f0c0(0xd2)]),router['get'](a20_0x23f0c0(0xae),adminController[a20_0x23f0c0(0xda)]),router['get']('/payments/:id',adminController[a20_0x23f0c0(0x95)]),router[a20_0x23f0c0(0xdc)](a20_0x23f0c0(0xbe),adminController[a20_0x23f0c0(0xb2)]),router[a20_0x23f0c0(0xdc)](a20_0x23f0c0(0xa2),(0x0,validation_1[a20_0x23f0c0(0xc7)])(validation_1[a20_0x23f0c0(0x78)]),adminController['updateCustomerData']),router[a20_0x23f0c0(0xa6)](a20_0x23f0c0(0xaf),adminController['getProcessingPaymentsStats']),router['post'](a20_0x23f0c0(0xbb),adminController['cleanupStalePayments']),router['post']('/payments/cleanup-with-report',adminController[a20_0x23f0c0(0xc8)]),router[a20_0x23f0c0(0xa6)]('/users',adminController[a20_0x23f0c0(0x8e)]),router['get']('/users/:id',adminController['getUserById']),router[a20_0x23f0c0(0x79)]('/users',(0x0,validation_1[a20_0x23f0c0(0xc7)])(validation_1[a20_0x23f0c0(0xe1)]),adminController[a20_0x23f0c0(0xc0)]),router['put']('/users/:id',(0x0,validation_1[a20_0x23f0c0(0xc7)])(validation_1[a20_0x23f0c0(0x7f)]),adminController['updateUser']),router[a20_0x23f0c0(0xc6)](a20_0x23f0c0(0xb0),adminController[a20_0x23f0c0(0xd4)]),router['post'](a20_0x23f0c0(0xa5),adminController[a20_0x23f0c0(0xc5)]),router[a20_0x23f0c0(0x79)]('/users/:id/activate',adminController[a20_0x23f0c0(0x80)]),router[a20_0x23f0c0(0xa6)]('/logs/stats',(_0x4f1ae1,_0x449c0d)=>{const _0x1226e1=a20_0x23f0c0;try{const _0x101b50=loggerService_1[_0x1226e1(0x91)][_0x1226e1(0x81)]();_0x449c0d['json']({'success':!![],'result':_0x101b50});}catch(_0x11650e){_0x449c0d[_0x1226e1(0xcf)](0x1f4)['json']({'success':![],'message':_0x1226e1(0xb7)});}}),router['post'](a20_0x23f0c0(0x71),(_0x3640bc,_0x34dd21)=>{const _0x3291dc=a20_0x23f0c0;try{const {daysToKeep:daysToKeep=0x1e}=_0x3640bc[_0x3291dc(0x6f)];loggerService_1[_0x3291dc(0x91)]['cleanOldLogs'](daysToKeep),_0x34dd21[_0x3291dc(0x89)]({'success':!![],'message':_0x3291dc(0xde)+daysToKeep+_0x3291dc(0xaa)});}catch(_0x525f17){_0x34dd21[_0x3291dc(0xcf)](0x1f4)[_0x3291dc(0x89)]({'success':![],'message':_0x3291dc(0xc9)});}}),router[a20_0x23f0c0(0x79)](a20_0x23f0c0(0xd8),async(_0x321bd5,_0x20e534)=>{const _0x2cf771=a20_0x23f0c0;try{const {paymentId:_0x6e5982}=_0x321bd5[_0x2cf771(0x73)];console[_0x2cf771(0x9f)]('🔍\x20[ADMIN]\x20Manual\x20CoinToPay\x20check\x20requested\x20for\x20payment:\x20'+_0x6e5982),await coinToPayStatusService_1[_0x2cf771(0x92)][_0x2cf771(0x87)](_0x6e5982),_0x20e534['json']({'success':!![],'message':_0x2cf771(0x93)});}catch(_0xb958d5){console[_0x2cf771(0xba)]('❌\x20[ADMIN]\x20Manual\x20CoinToPay\x20check\x20failed\x20for\x20payment\x20'+_0x321bd5['params'][_0x2cf771(0x77)]+':',_0xb958d5),_0x20e534[_0x2cf771(0xcf)](0x1f4)[_0x2cf771(0x89)]({'success':![],'message':_0xb958d5 instanceof Error?_0xb958d5[_0x2cf771(0xa8)]:'Failed\x20to\x20check\x20CoinToPay\x20payment\x20status'});}}),router[a20_0x23f0c0(0xa6)](a20_0x23f0c0(0x97),(_0xebf46e,_0x6b2854)=>{const _0x49c616=a20_0x23f0c0;try{const _0x271a40=coinToPayStatusService_1['coinToPayStatusService'][_0x49c616(0xab)]();_0x6b2854[_0x49c616(0x89)]({'success':!![],'result':{..._0x271a40,'description':_0x49c616(0x72),'statusMapping':{'Paid':_0x49c616(0xdd),'Awaiting\x20Fiat':'PENDING','waiting':'PENDING','expired':'EXPIRED','failed':'FAILED'},'autoExpiryNote':'Payments\x20automatically\x20expire\x20after\x20'+_0x271a40[_0x49c616(0xc4)]+'\x20days\x20if\x20not\x20paid','individualTimersNote':'Each\x20new\x20payment\x20gets\x20individual\x20timers:\x201min,\x202min,\x207min,\x2012min,\x20then\x20hourly'}});}catch(_0xc583d){_0x6b2854[_0x49c616(0xcf)](0x1f4)[_0x49c616(0x89)]({'success':![],'message':_0x49c616(0xce)});}}),router[a20_0x23f0c0(0xa6)](a20_0x23f0c0(0x84),async(_0x4b5a8b,_0x38cf97)=>{const _0x5224d7=a20_0x23f0c0;try{const {paymentId:_0xae398c}=_0x4b5a8b[_0x5224d7(0x73)],_0x5e2ffb=coinToPayStatusService_1['coinToPayStatusService']['getPaymentTimerInfo'](_0xae398c),_0x27e8f6=(await Promise[_0x5224d7(0x8b)]()[_0x5224d7(0x96)](()=>__importStar(require('../config/database'))))[_0x5224d7(0x8c)],_0x5b4b90=await _0x27e8f6[_0x5224d7(0xb3)][_0x5224d7(0x6c)]({'where':{'id':_0xae398c},'select':{'id':!![],'gateway':!![],'gatewayPaymentId':!![],'status':!![],'amount':!![],'currency':!![],'createdAt':!![],'updatedAt':!![],'shopId':!![],'shop':{'select':{'name':!![],'username':!![]}}}});if(!_0x5b4b90)return _0x38cf97[_0x5224d7(0xcf)](0x194)[_0x5224d7(0x89)]({'success':![],'message':_0x5224d7(0x6b)});_0x38cf97[_0x5224d7(0x89)]({'success':!![],'result':{'payment':{'id':_0x5b4b90['id'],'gateway':_0x5b4b90[_0x5224d7(0x9a)],'gatewayPaymentId':_0x5b4b90[_0x5224d7(0xac)],'status':_0x5b4b90[_0x5224d7(0xcf)],'amount':_0x5b4b90[_0x5224d7(0x6e)],'currency':_0x5b4b90[_0x5224d7(0xdf)],'createdAt':_0x5b4b90['createdAt'],'updatedAt':_0x5b4b90['updatedAt'],'shop':_0x5b4b90[_0x5224d7(0xc1)]},'timers':_0x5e2ffb,'isCoinToPay':_0x5b4b90[_0x5224d7(0x9a)]==='cointopay','ageInMinutes':Math[_0x5224d7(0x82)]((Date[_0x5224d7(0xcd)]()-_0x5b4b90[_0x5224d7(0x9d)]['getTime']())/(0x3e8*0x3c))}});}catch(_0x1aa3ae){_0x38cf97[_0x5224d7(0xcf)](0x1f4)[_0x5224d7(0x89)]({'success':![],'message':_0x1aa3ae instanceof Error?_0x1aa3ae[_0x5224d7(0xa8)]:_0x5224d7(0xa3)});}}),router[a20_0x23f0c0(0xa6)](a20_0x23f0c0(0xd3),(_0x11fa37,_0x26702d)=>{const _0x490407=a20_0x23f0c0;try{const _0x2b49e8=domainMonitoringService_1['domainMonitoringService'][_0x490407(0xe0)]();_0x26702d[_0x490407(0x89)]({'success':!![],'result':{..._0x2b49e8,'description':_0x490407(0x94),'behavior':'Server\x20crashes\x20if\x20domain\x20is\x20not\x20responding\x20after\x20consecutive\x20failures','encoding':_0x490407(0xad)}});}catch(_0x33baa6){_0x26702d[_0x490407(0xcf)](0x1f4)['json']({'success':![],'message':_0x490407(0xd6)});}}),router[a20_0x23f0c0(0x79)](a20_0x23f0c0(0xd7),async(_0x4bb24c,_0x54c054)=>{const _0x110497=a20_0x23f0c0;try{const _0x31a41c=await domainMonitoringService_1[_0x110497(0x6d)][_0x110497(0x8a)]();_0x54c054[_0x110497(0x89)]({'success':!![],'result':{'domainAvailable':_0x31a41c,'message':_0x31a41c?_0x110497(0xcb):'Domain\x20check\x20failed','timestamp':new Date()['toISOString']()}});}catch(_0x4f15fb){_0x54c054['status'](0x1f4)[_0x110497(0x89)]({'success':![],'message':_0x4f15fb instanceof Error?_0x4f15fb[_0x110497(0xa8)]:'Failed\x20to\x20perform\x20manual\x20domain\x20check'});}}),exports[a20_0x23f0c0(0x8c)]=router;