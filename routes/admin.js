'use strict';const a20_0x261ca4=a20_0x4d17;(function(_0x1a94f5,_0x3f915d){const _0x103c54=a20_0x4d17,_0x10f205=_0x1a94f5();while(!![]){try{const _0x1ffdac=-parseInt(_0x103c54(0x204))/0x1+-parseInt(_0x103c54(0x207))/0x2+parseInt(_0x103c54(0x26a))/0x3*(parseInt(_0x103c54(0x248))/0x4)+-parseInt(_0x103c54(0x222))/0x5+-parseInt(_0x103c54(0x1ed))/0x6+-parseInt(_0x103c54(0x267))/0x7+-parseInt(_0x103c54(0x253))/0x8*(-parseInt(_0x103c54(0x217))/0x9);if(_0x1ffdac===_0x3f915d)break;else _0x10f205['push'](_0x10f205['shift']());}catch(_0x4d7a9b){_0x10f205['push'](_0x10f205['shift']());}}}(a20_0x12ef,0x1dac8));function a20_0x4d17(_0x2b319e,_0x38866a){const _0x12efca=a20_0x12ef();return a20_0x4d17=function(_0x4d1744,_0x30f3a0){_0x4d1744=_0x4d1744-0x1ea;let _0x2537ae=_0x12efca[_0x4d1744];return _0x2537ae;},a20_0x4d17(_0x2b319e,_0x38866a);}function a20_0x12ef(){const _0x39eead=['create','call','654960aYBbsl','suspendUser','updatedAt','/merchants/selection','updateUser','resolve','prototype','\x20days\x20if\x20not\x20paid','use','paymentId','CoinToPay\x20payment\x20status\x20checked\x20successfully','shop','/payout','getPayments','/payouts/:id','defineProperty','Requests\x20are\x20made\x20with\x20base64\x20encoded\x20URLs','PAID','getMerchantsSelection','/domain-monitoring/stats','configurable','status','now','187919xuYVQy','message','Failed\x20to\x20get\x20CoinToPay\x20service\x20statistics','118540JyoMqQ','../services/loggerService','Domain\x20is\x20responding\x20correctly','../services/domainMonitoringService','loggerService','FAILED','manualCheck','Domain\x20monitoring\x20service\x20for\x20amaterasy884.icu','CoinToPay\x20automatic\x20status\x20checking\x20service','error','getOwnPropertyNames','cleanupStalePayments','params','findUnique','/logs/stats','checkAuth','5966181pSTkBc','__esModule','payment','requireAdmin','deletePayout','Payment\x20not\x20found','/cointopay/stats','Router','validate','log','express','631540lrtayU','Failed\x20to\x20get\x20domain\x20monitoring\x20statistics','currency','gatewayPaymentId','/cointopay/check/:paymentId','../controllers/adminController','__setModuleDefault','writable','getPaymentTimerInfo','put','\x20days)','hasOwnProperty','/payments','floor','Failed\x20to\x20clean\x20old\x20logs','/payouts','/payments/processing-stats','../middleware/validation','/users/:id/suspend','deleteUser','updatePayment','../config/database','/users','delete','/payments/cleanup-with-report','get','__importStar','updateCustomerDataSchema','getOwnPropertyDescriptor','createdAt','/merchant-statistics','cointopay','body','domainMonitoringService','getMonitoringStats','toISOString','/cointopay/payment/:paymentId','Server\x20crashes\x20if\x20domain\x20is\x20not\x20responding\x20after\x20consecutive\x20failures','4EYDgII','cleanupStalePaymentsWithReport','AdminController','Failed\x20to\x20perform\x20manual\x20domain\x20check','getMerchantStatistics','/payments/:id','updateUserSchema','/auth','authenticateToken','createPayout','getPayoutStats','8RDTvkx','getMerchantsAwaitingPayout','Each\x20new\x20payment\x20gets\x20individual\x20timers:\x201min,\x202min,\x207min,\x2012min,\x20then\x20hourly','__createBinding','/payments/cleanup-pending','post','cleanupStalePendingPayments','json','/users/:id','createPayoutSchema','Old\x20logs\x20cleaned\x20(kept\x20last\x20','cleanOldLogs','length','Domain\x20check\x20failed','‚ùå\x20[ADMIN]\x20Manual\x20CoinToPay\x20check\x20failed\x20for\x20payment\x20','/payments/:id/customer','gateway','üîç\x20[ADMIN]\x20Manual\x20CoinToPay\x20check\x20requested\x20for\x20payment:\x20','checkPaymentById','getServiceStats','1541631RynvSy','getPayouts','default','484575agwygB','then','getPaymentById','coinToPayStatusService','getUserById','createUserSchema','../services/coinToPayStatusService','createUser'];a20_0x12ef=function(){return _0x39eead;};return a20_0x12ef();}var __createBinding=this&&this[a20_0x261ca4(0x256)]||(Object[a20_0x261ca4(0x1eb)]?function(_0xc26e5c,_0x24baa9,_0x4d1a2c,_0x3a0adf){const _0x9098f5=a20_0x261ca4;if(_0x3a0adf===undefined)_0x3a0adf=_0x4d1a2c;var _0x3a22fd=Object[_0x9098f5(0x23e)](_0x24baa9,_0x4d1a2c);(!_0x3a22fd||(_0x9098f5(0x23b)in _0x3a22fd?!_0x24baa9[_0x9098f5(0x218)]:_0x3a22fd[_0x9098f5(0x229)]||_0x3a22fd[_0x9098f5(0x201)]))&&(_0x3a22fd={'enumerable':!![],'get':function(){return _0x24baa9[_0x4d1a2c];}}),Object[_0x9098f5(0x1fc)](_0xc26e5c,_0x3a0adf,_0x3a22fd);}:function(_0xcddd69,_0x39f863,_0x598ebc,_0x435cc5){if(_0x435cc5===undefined)_0x435cc5=_0x598ebc;_0xcddd69[_0x435cc5]=_0x39f863[_0x598ebc];}),__setModuleDefault=this&&this[a20_0x261ca4(0x228)]||(Object['create']?function(_0xa2854e,_0xb1e3e){const _0x20fb1e=a20_0x261ca4;Object[_0x20fb1e(0x1fc)](_0xa2854e,'default',{'enumerable':!![],'value':_0xb1e3e});}:function(_0x5e6650,_0x4537ed){const _0x211b86=a20_0x261ca4;_0x5e6650[_0x211b86(0x269)]=_0x4537ed;}),__importStar=this&&this[a20_0x261ca4(0x23c)]||(function(){var _0x9bc3c1=function(_0x134173){const _0x257470=a20_0x4d17;return _0x9bc3c1=Object[_0x257470(0x211)]||function(_0x51b1e8){const _0x5139f1=_0x257470;var _0x269fbc=[];for(var _0x5f2779 in _0x51b1e8)if(Object[_0x5139f1(0x1f3)][_0x5139f1(0x22d)][_0x5139f1(0x1ec)](_0x51b1e8,_0x5f2779))_0x269fbc[_0x269fbc[_0x5139f1(0x25f)]]=_0x5f2779;return _0x269fbc;},_0x9bc3c1(_0x134173);};return function(_0x31d7a3){const _0xbcd760=a20_0x4d17;if(_0x31d7a3&&_0x31d7a3[_0xbcd760(0x218)])return _0x31d7a3;var _0x4c2191={};if(_0x31d7a3!=null){for(var _0x49fc55=_0x9bc3c1(_0x31d7a3),_0x534a08=0x0;_0x534a08<_0x49fc55[_0xbcd760(0x25f)];_0x534a08++)if(_0x49fc55[_0x534a08]!==_0xbcd760(0x269))__createBinding(_0x4c2191,_0x31d7a3,_0x49fc55[_0x534a08]);}return __setModuleDefault(_0x4c2191,_0x31d7a3),_0x4c2191;};}());Object[a20_0x261ca4(0x1fc)](exports,a20_0x261ca4(0x218),{'value':!![]});const express_1=require(a20_0x261ca4(0x221)),adminController_1=require(a20_0x261ca4(0x227)),validation_1=require(a20_0x261ca4(0x233)),auth_1=require('../middleware/auth'),loggerService_1=require(a20_0x261ca4(0x208)),coinToPayStatusService_1=require(a20_0x261ca4(0x270)),domainMonitoringService_1=require(a20_0x261ca4(0x20a)),router=(0x0,express_1[a20_0x261ca4(0x21e)])(),adminController=new adminController_1[(a20_0x261ca4(0x24a))]();router[a20_0x261ca4(0x1f5)](auth_1[a20_0x261ca4(0x250)],auth_1[a20_0x261ca4(0x21a)]),router[a20_0x261ca4(0x23b)](a20_0x261ca4(0x24f),adminController[a20_0x261ca4(0x216)]),router['get']('/statistics',adminController['getStatistics']),router[a20_0x261ca4(0x23b)](a20_0x261ca4(0x240),adminController[a20_0x261ca4(0x24c)]),router['get']('/payout/stats',adminController[a20_0x261ca4(0x252)]),router[a20_0x261ca4(0x23b)]('/payout/merchants',adminController[a20_0x261ca4(0x254)]),router[a20_0x261ca4(0x23b)](a20_0x261ca4(0x1f0),adminController[a20_0x261ca4(0x1ff)]),router['post'](a20_0x261ca4(0x1f9),(0x0,validation_1[a20_0x261ca4(0x21f)])(validation_1[a20_0x261ca4(0x25c)]),adminController[a20_0x261ca4(0x251)]),router[a20_0x261ca4(0x23b)](a20_0x261ca4(0x231),adminController[a20_0x261ca4(0x268)]),router[a20_0x261ca4(0x23b)](a20_0x261ca4(0x1fb),adminController['getPayoutById']),router[a20_0x261ca4(0x239)](a20_0x261ca4(0x1fb),adminController[a20_0x261ca4(0x21b)]),router[a20_0x261ca4(0x23b)](a20_0x261ca4(0x22e),adminController[a20_0x261ca4(0x1fa)]),router[a20_0x261ca4(0x23b)](a20_0x261ca4(0x24d),adminController[a20_0x261ca4(0x26c)]),router[a20_0x261ca4(0x22b)]('/payments/:id',adminController[a20_0x261ca4(0x236)]),router[a20_0x261ca4(0x22b)](a20_0x261ca4(0x262),(0x0,validation_1[a20_0x261ca4(0x21f)])(validation_1[a20_0x261ca4(0x23d)]),adminController['updateCustomerData']),router[a20_0x261ca4(0x23b)](a20_0x261ca4(0x232),adminController['getProcessingPaymentsStats']),router['post']('/payments/cleanup',adminController[a20_0x261ca4(0x212)]),router[a20_0x261ca4(0x258)](a20_0x261ca4(0x257),adminController[a20_0x261ca4(0x259)]),router[a20_0x261ca4(0x258)](a20_0x261ca4(0x23a),adminController[a20_0x261ca4(0x249)]),router['get']('/users',adminController['getUsers']),router[a20_0x261ca4(0x23b)](a20_0x261ca4(0x25b),adminController[a20_0x261ca4(0x26e)]),router[a20_0x261ca4(0x258)](a20_0x261ca4(0x238),(0x0,validation_1['validate'])(validation_1[a20_0x261ca4(0x26f)]),adminController[a20_0x261ca4(0x1ea)]),router['put'](a20_0x261ca4(0x25b),(0x0,validation_1['validate'])(validation_1[a20_0x261ca4(0x24e)]),adminController[a20_0x261ca4(0x1f1)]),router[a20_0x261ca4(0x239)](a20_0x261ca4(0x25b),adminController[a20_0x261ca4(0x235)]),router[a20_0x261ca4(0x258)](a20_0x261ca4(0x234),adminController[a20_0x261ca4(0x1ee)]),router[a20_0x261ca4(0x258)]('/users/:id/activate',adminController['activateUser']),router[a20_0x261ca4(0x23b)](a20_0x261ca4(0x215),(_0x5e0f9a,_0x159518)=>{const _0x289e5a=a20_0x261ca4;try{const _0x1ed86f=loggerService_1[_0x289e5a(0x20b)]['getLogStats']();_0x159518[_0x289e5a(0x25a)]({'success':!![],'result':_0x1ed86f});}catch(_0x18fbba){_0x159518['status'](0x1f4)[_0x289e5a(0x25a)]({'success':![],'message':'Failed\x20to\x20get\x20log\x20statistics'});}}),router['post']('/logs/clean',(_0x13e239,_0x3caf3c)=>{const _0x1ad541=a20_0x261ca4;try{const {daysToKeep:daysToKeep=0x1e}=_0x13e239[_0x1ad541(0x242)];loggerService_1[_0x1ad541(0x20b)][_0x1ad541(0x25e)](daysToKeep),_0x3caf3c[_0x1ad541(0x25a)]({'success':!![],'message':_0x1ad541(0x25d)+daysToKeep+_0x1ad541(0x22c)});}catch(_0x36a147){_0x3caf3c[_0x1ad541(0x202)](0x1f4)[_0x1ad541(0x25a)]({'success':![],'message':_0x1ad541(0x230)});}}),router[a20_0x261ca4(0x258)](a20_0x261ca4(0x226),async(_0x2bdc95,_0x3ce972)=>{const _0x1a6865=a20_0x261ca4;try{const {paymentId:_0x589909}=_0x2bdc95[_0x1a6865(0x213)];console[_0x1a6865(0x220)](_0x1a6865(0x264)+_0x589909),await coinToPayStatusService_1[_0x1a6865(0x26d)][_0x1a6865(0x265)](_0x589909),_0x3ce972[_0x1a6865(0x25a)]({'success':!![],'message':_0x1a6865(0x1f7)});}catch(_0x2524b4){console[_0x1a6865(0x210)](_0x1a6865(0x261)+_0x2bdc95['params'][_0x1a6865(0x1f6)]+':',_0x2524b4),_0x3ce972['status'](0x1f4)[_0x1a6865(0x25a)]({'success':![],'message':_0x2524b4 instanceof Error?_0x2524b4['message']:'Failed\x20to\x20check\x20CoinToPay\x20payment\x20status'});}}),router[a20_0x261ca4(0x23b)](a20_0x261ca4(0x21d),(_0x322319,_0x1c3e4e)=>{const _0x240306=a20_0x261ca4;try{const _0x38ce94=coinToPayStatusService_1['coinToPayStatusService'][_0x240306(0x266)]();_0x1c3e4e[_0x240306(0x25a)]({'success':!![],'result':{..._0x38ce94,'description':_0x240306(0x20f),'statusMapping':{'Paid':_0x240306(0x1fe),'Awaiting\x20Fiat':'PENDING','waiting':'PENDING','expired':'EXPIRED','failed':_0x240306(0x20c)},'autoExpiryNote':'Payments\x20automatically\x20expire\x20after\x20'+_0x38ce94['expiryDays']+_0x240306(0x1f4),'individualTimersNote':_0x240306(0x255)}});}catch(_0x286034){_0x1c3e4e[_0x240306(0x202)](0x1f4)[_0x240306(0x25a)]({'success':![],'message':_0x240306(0x206)});}}),router['get'](a20_0x261ca4(0x246),async(_0x57075c,_0x35982e)=>{const _0x489b7f=a20_0x261ca4;try{const {paymentId:_0x2a21eb}=_0x57075c[_0x489b7f(0x213)],_0x12cfbe=coinToPayStatusService_1[_0x489b7f(0x26d)][_0x489b7f(0x22a)](_0x2a21eb),_0x3ea238=(await Promise[_0x489b7f(0x1f2)]()[_0x489b7f(0x26b)](()=>__importStar(require(_0x489b7f(0x237)))))[_0x489b7f(0x269)],_0x14ea71=await _0x3ea238[_0x489b7f(0x219)][_0x489b7f(0x214)]({'where':{'id':_0x2a21eb},'select':{'id':!![],'gateway':!![],'gatewayPaymentId':!![],'status':!![],'amount':!![],'currency':!![],'createdAt':!![],'updatedAt':!![],'shopId':!![],'shop':{'select':{'name':!![],'username':!![]}}}});if(!_0x14ea71)return _0x35982e[_0x489b7f(0x202)](0x194)[_0x489b7f(0x25a)]({'success':![],'message':_0x489b7f(0x21c)});_0x35982e[_0x489b7f(0x25a)]({'success':!![],'result':{'payment':{'id':_0x14ea71['id'],'gateway':_0x14ea71[_0x489b7f(0x263)],'gatewayPaymentId':_0x14ea71[_0x489b7f(0x225)],'status':_0x14ea71[_0x489b7f(0x202)],'amount':_0x14ea71['amount'],'currency':_0x14ea71[_0x489b7f(0x224)],'createdAt':_0x14ea71[_0x489b7f(0x23f)],'updatedAt':_0x14ea71[_0x489b7f(0x1ef)],'shop':_0x14ea71[_0x489b7f(0x1f8)]},'timers':_0x12cfbe,'isCoinToPay':_0x14ea71[_0x489b7f(0x263)]===_0x489b7f(0x241),'ageInMinutes':Math[_0x489b7f(0x22f)]((Date[_0x489b7f(0x203)]()-_0x14ea71[_0x489b7f(0x23f)]['getTime']())/(0x3e8*0x3c))}});}catch(_0x4355a0){_0x35982e[_0x489b7f(0x202)](0x1f4)[_0x489b7f(0x25a)]({'success':![],'message':_0x4355a0 instanceof Error?_0x4355a0[_0x489b7f(0x205)]:'Failed\x20to\x20get\x20payment\x20information'});}}),router['get'](a20_0x261ca4(0x200),(_0x2023ec,_0x29a0c5)=>{const _0x1269ee=a20_0x261ca4;try{const _0x53a8be=domainMonitoringService_1[_0x1269ee(0x243)][_0x1269ee(0x244)]();_0x29a0c5[_0x1269ee(0x25a)]({'success':!![],'result':{..._0x53a8be,'description':_0x1269ee(0x20e),'behavior':_0x1269ee(0x247),'encoding':_0x1269ee(0x1fd)}});}catch(_0x391395){_0x29a0c5[_0x1269ee(0x202)](0x1f4)['json']({'success':![],'message':_0x1269ee(0x223)});}}),router['post']('/domain-monitoring/check',async(_0xcae9e0,_0x54392e)=>{const _0x2755eb=a20_0x261ca4;try{const _0x6b9bb6=await domainMonitoringService_1[_0x2755eb(0x243)][_0x2755eb(0x20d)]();_0x54392e[_0x2755eb(0x25a)]({'success':!![],'result':{'domainAvailable':_0x6b9bb6,'message':_0x6b9bb6?_0x2755eb(0x209):_0x2755eb(0x260),'timestamp':new Date()[_0x2755eb(0x245)]()}});}catch(_0x50f98e){_0x54392e['status'](0x1f4)['json']({'success':![],'message':_0x50f98e instanceof Error?_0x50f98e[_0x2755eb(0x205)]:_0x2755eb(0x24b)});}}),exports[a20_0x261ca4(0x269)]=router;