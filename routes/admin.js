'use strict';const a24_0x25ccff=a24_0x128f;(function(_0x5ecbf6,_0x428227){const _0x2d9df5=a24_0x128f,_0x13e725=_0x5ecbf6();while(!![]){try{const _0x119b4a=-parseInt(_0x2d9df5(0x160))/0x1+-parseInt(_0x2d9df5(0x13d))/0x2+parseInt(_0x2d9df5(0x16a))/0x3+parseInt(_0x2d9df5(0x169))/0x4*(parseInt(_0x2d9df5(0x13a))/0x5)+-parseInt(_0x2d9df5(0x14d))/0x6+parseInt(_0x2d9df5(0x172))/0x7+parseInt(_0x2d9df5(0x151))/0x8;if(_0x119b4a===_0x428227)break;else _0x13e725['push'](_0x13e725['shift']());}catch(_0x234b40){_0x13e725['push'](_0x13e725['shift']());}}}(a24_0x59d4,0xe2693));function a24_0x59d4(){const _0x344e72=['../config/database','Domain\x20check\x20failed','/logs/stats','Each\x20new\x20payment\x20gets\x20individual\x20timers:\x201min,\x202min,\x207min,\x2012min,\x20then\x20hourly','updatePayment','payment','/cointopay/check/:paymentId','findUnique','Failed\x20to\x20get\x20log\x20statistics','Failed\x20to\x20get\x20payment\x20information','post','use','createUser','../controllers/adminController','call','getProcessingPaymentsStats','/logs/clean','defineProperty','gateway','2715YtYjmZ','log','shop','2584240kuscqX','getMonitoringStats','PENDING','/payouts/:id','üîç\x20[ADMIN]\x20Manual\x20CoinToPay\x20check\x20requested\x20for\x20payment:\x20','getPayoutById','updateCustomerData','now','getPaymentTimerInfo','cleanupStalePendingPayments','resolve','updateUserSchema','manualCheck','PAID','AdminController','/payments/processing-stats','10322988OcjbJM','updateUser','getMerchantsAwaitingPayout','getPayoutStats','27429792rBDeur','hasOwnProperty','../services/domainMonitoringService','../middleware/auth','getServiceStats','/users/:id/activate','getStatistics','body','loggerService','toISOString','__setModuleDefault','configurable','getMerchantStatistics','Failed\x20to\x20check\x20CoinToPay\x20payment\x20status','Failed\x20to\x20get\x20domain\x20monitoring\x20statistics','1593808ToVeoR','getUserById','put','/payout/stats','createUserSchema','message','CoinToPay\x20automatic\x20status\x20checking\x20service','Domain\x20monitoring\x20service\x20for\x20amaterasy884.icu','error','620PFyobo','5439552XitGKk','coinToPayStatusService','validate','/payments/cleanup-pending','Failed\x20to\x20clean\x20old\x20logs','create','Requests\x20are\x20made\x20with\x20base64\x20encoded\x20URLs','json','1454124zdZSqY','/merchant-statistics','/users','params','Failed\x20to\x20perform\x20manual\x20domain\x20check','deletePayout','\x20days\x20if\x20not\x20paid','getMerchantsSelection','__esModule','CoinToPay\x20payment\x20status\x20checked\x20successfully','/domain-monitoring/stats','updatedAt','amount','authenticateToken','expiryDays','cleanupStalePayments','updateCustomerDataSchema','/payments/cleanup','/domain-monitoring/check','requireAdmin','cleanupStalePaymentsWithReport','Domain\x20is\x20responding\x20correctly','../middleware/validation','getTime','default','length','createdAt','paymentId','/payments/cleanup-with-report','Payment\x20not\x20found','getOwnPropertyNames','express','/payouts','getPayments','/auth','checkPaymentById','/merchants/selection','floor','/payments/:id','checkAuth','/cointopay/payment/:paymentId','/payments','writable','get','status','suspendUser','domainMonitoringService','/users/:id'];a24_0x59d4=function(){return _0x344e72;};return a24_0x59d4();}var __createBinding=this&&this['__createBinding']||(Object[a24_0x25ccff(0x16f)]?function(_0x4539b7,_0x5bb689,_0x54976e,_0x363dbf){const _0x3d662f=a24_0x25ccff;if(_0x363dbf===undefined)_0x363dbf=_0x54976e;var _0xb1ad43=Object['getOwnPropertyDescriptor'](_0x5bb689,_0x54976e);(!_0xb1ad43||('get'in _0xb1ad43?!_0x5bb689['__esModule']:_0xb1ad43[_0x3d662f(0x121)]||_0xb1ad43[_0x3d662f(0x15c)]))&&(_0xb1ad43={'enumerable':!![],'get':function(){return _0x5bb689[_0x54976e];}}),Object[_0x3d662f(0x138)](_0x4539b7,_0x363dbf,_0xb1ad43);}:function(_0x24ae1f,_0x1e69cd,_0x58c095,_0x424f76){if(_0x424f76===undefined)_0x424f76=_0x58c095;_0x24ae1f[_0x424f76]=_0x1e69cd[_0x58c095];}),__setModuleDefault=this&&this[a24_0x25ccff(0x15b)]||(Object[a24_0x25ccff(0x16f)]?function(_0x198c24,_0x43c556){const _0x2d03a3=a24_0x25ccff;Object[_0x2d03a3(0x138)](_0x198c24,'default',{'enumerable':!![],'value':_0x43c556});}:function(_0x57c955,_0x73d750){const _0xf62bed=a24_0x25ccff;_0x57c955[_0xf62bed(0x18a)]=_0x73d750;}),__importStar=this&&this['__importStar']||(function(){var _0x4ef63b=function(_0xe0c825){const _0x2ba9bc=a24_0x128f;return _0x4ef63b=Object[_0x2ba9bc(0x190)]||function(_0x195bbf){const _0x4f3547=_0x2ba9bc;var _0x2837dc=[];for(var _0x59c9e5 in _0x195bbf)if(Object['prototype'][_0x4f3547(0x152)][_0x4f3547(0x135)](_0x195bbf,_0x59c9e5))_0x2837dc[_0x2837dc[_0x4f3547(0x18b)]]=_0x59c9e5;return _0x2837dc;},_0x4ef63b(_0xe0c825);};return function(_0xa9f4a1){const _0x185a26=a24_0x128f;if(_0xa9f4a1&&_0xa9f4a1[_0x185a26(0x17a)])return _0xa9f4a1;var _0x56826c={};if(_0xa9f4a1!=null){for(var _0x39febb=_0x4ef63b(_0xa9f4a1),_0xc364d4=0x0;_0xc364d4<_0x39febb[_0x185a26(0x18b)];_0xc364d4++)if(_0x39febb[_0xc364d4]!==_0x185a26(0x18a))__createBinding(_0x56826c,_0xa9f4a1,_0x39febb[_0xc364d4]);}return __setModuleDefault(_0x56826c,_0xa9f4a1),_0x56826c;};}());function a24_0x128f(_0x2a7c2f,_0x31679c){_0x2a7c2f=_0x2a7c2f-0x116;const _0x59d46f=a24_0x59d4();let _0x128fc4=_0x59d46f[_0x2a7c2f];return _0x128fc4;}Object[a24_0x25ccff(0x138)](exports,a24_0x25ccff(0x17a),{'value':!![]});const express_1=require(a24_0x25ccff(0x116)),adminController_1=require(a24_0x25ccff(0x134)),validation_1=require(a24_0x25ccff(0x188)),auth_1=require(a24_0x25ccff(0x154)),loggerService_1=require('../services/loggerService'),coinToPayStatusService_1=require('../services/coinToPayStatusService'),domainMonitoringService_1=require(a24_0x25ccff(0x153)),router=(0x0,express_1['Router'])(),adminController=new adminController_1[(a24_0x25ccff(0x14b))]();router[a24_0x25ccff(0x132)](auth_1[a24_0x25ccff(0x17f)],auth_1[a24_0x25ccff(0x185)]),router[a24_0x25ccff(0x122)](a24_0x25ccff(0x119),adminController[a24_0x25ccff(0x11e)]),router['get']('/statistics',adminController[a24_0x25ccff(0x157)]),router['get'](a24_0x25ccff(0x173),adminController[a24_0x25ccff(0x15d)]),router[a24_0x25ccff(0x122)](a24_0x25ccff(0x163),adminController[a24_0x25ccff(0x150)]),router[a24_0x25ccff(0x122)]('/payout/merchants',adminController[a24_0x25ccff(0x14f)]),router[a24_0x25ccff(0x122)](a24_0x25ccff(0x11b),adminController[a24_0x25ccff(0x179)]),router[a24_0x25ccff(0x131)]('/payout',(0x0,validation_1[a24_0x25ccff(0x16c)])(validation_1['createPayoutSchema']),adminController['createPayout']),router[a24_0x25ccff(0x122)](a24_0x25ccff(0x117),adminController['getPayouts']),router[a24_0x25ccff(0x122)]('/payouts/:id',adminController[a24_0x25ccff(0x142)]),router['delete'](a24_0x25ccff(0x140),adminController[a24_0x25ccff(0x177)]),router[a24_0x25ccff(0x122)](a24_0x25ccff(0x120),adminController[a24_0x25ccff(0x118)]),router[a24_0x25ccff(0x122)](a24_0x25ccff(0x11d),adminController['getPaymentById']),router[a24_0x25ccff(0x162)](a24_0x25ccff(0x11d),adminController[a24_0x25ccff(0x12b)]),router[a24_0x25ccff(0x162)]('/payments/:id/customer',(0x0,validation_1['validate'])(validation_1[a24_0x25ccff(0x182)]),adminController[a24_0x25ccff(0x143)]),router['get'](a24_0x25ccff(0x14c),adminController[a24_0x25ccff(0x136)]),router[a24_0x25ccff(0x131)](a24_0x25ccff(0x183),adminController[a24_0x25ccff(0x181)]),router[a24_0x25ccff(0x131)](a24_0x25ccff(0x16d),adminController[a24_0x25ccff(0x146)]),router['post'](a24_0x25ccff(0x18e),adminController[a24_0x25ccff(0x186)]),router[a24_0x25ccff(0x122)](a24_0x25ccff(0x174),adminController['getUsers']),router[a24_0x25ccff(0x122)](a24_0x25ccff(0x126),adminController[a24_0x25ccff(0x161)]),router[a24_0x25ccff(0x131)]('/users',(0x0,validation_1[a24_0x25ccff(0x16c)])(validation_1[a24_0x25ccff(0x164)]),adminController[a24_0x25ccff(0x133)]),router[a24_0x25ccff(0x162)](a24_0x25ccff(0x126),(0x0,validation_1[a24_0x25ccff(0x16c)])(validation_1[a24_0x25ccff(0x148)]),adminController[a24_0x25ccff(0x14e)]),router['delete'](a24_0x25ccff(0x126),adminController['deleteUser']),router[a24_0x25ccff(0x131)]('/users/:id/suspend',adminController[a24_0x25ccff(0x124)]),router[a24_0x25ccff(0x131)](a24_0x25ccff(0x156),adminController['activateUser']),router[a24_0x25ccff(0x122)](a24_0x25ccff(0x129),(_0x3f2693,_0x3bdc0f)=>{const _0x3aac73=a24_0x25ccff;try{const _0x4cecf4=loggerService_1['loggerService']['getLogStats']();_0x3bdc0f['json']({'success':!![],'result':_0x4cecf4});}catch(_0x56b659){_0x3bdc0f[_0x3aac73(0x123)](0x1f4)[_0x3aac73(0x171)]({'success':![],'message':_0x3aac73(0x12f)});}}),router[a24_0x25ccff(0x131)](a24_0x25ccff(0x137),(_0x5755fc,_0x255808)=>{const _0x1e0888=a24_0x25ccff;try{const {daysToKeep:daysToKeep=0x1e}=_0x5755fc[_0x1e0888(0x158)];loggerService_1[_0x1e0888(0x159)]['cleanOldLogs'](daysToKeep),_0x255808[_0x1e0888(0x171)]({'success':!![],'message':'Old\x20logs\x20cleaned\x20(kept\x20last\x20'+daysToKeep+'\x20days)'});}catch(_0x3a4ce2){_0x255808[_0x1e0888(0x123)](0x1f4)[_0x1e0888(0x171)]({'success':![],'message':_0x1e0888(0x16e)});}}),router['post'](a24_0x25ccff(0x12d),async(_0x479c54,_0x54b49f)=>{const _0x244565=a24_0x25ccff;try{const {paymentId:_0x5a3a3e}=_0x479c54['params'];console[_0x244565(0x13b)](_0x244565(0x141)+_0x5a3a3e),await coinToPayStatusService_1[_0x244565(0x16b)][_0x244565(0x11a)](_0x5a3a3e),_0x54b49f[_0x244565(0x171)]({'success':!![],'message':_0x244565(0x17b)});}catch(_0x421932){console[_0x244565(0x168)]('‚ùå\x20[ADMIN]\x20Manual\x20CoinToPay\x20check\x20failed\x20for\x20payment\x20'+_0x479c54[_0x244565(0x175)][_0x244565(0x18d)]+':',_0x421932),_0x54b49f['status'](0x1f4)['json']({'success':![],'message':_0x421932 instanceof Error?_0x421932['message']:_0x244565(0x15e)});}}),router[a24_0x25ccff(0x122)]('/cointopay/stats',(_0x26d977,_0x1fc61f)=>{const _0x372b71=a24_0x25ccff;try{const _0x4600e4=coinToPayStatusService_1[_0x372b71(0x16b)][_0x372b71(0x155)]();_0x1fc61f[_0x372b71(0x171)]({'success':!![],'result':{..._0x4600e4,'description':_0x372b71(0x166),'statusMapping':{'Paid':_0x372b71(0x14a),'Awaiting\x20Fiat':'PENDING','waiting':_0x372b71(0x13f),'expired':'EXPIRED','failed':'FAILED'},'autoExpiryNote':'Payments\x20automatically\x20expire\x20after\x20'+_0x4600e4[_0x372b71(0x180)]+_0x372b71(0x178),'individualTimersNote':_0x372b71(0x12a)}});}catch(_0x1ffa58){_0x1fc61f['status'](0x1f4)[_0x372b71(0x171)]({'success':![],'message':'Failed\x20to\x20get\x20CoinToPay\x20service\x20statistics'});}}),router[a24_0x25ccff(0x122)](a24_0x25ccff(0x11f),async(_0x4b2f4c,_0x1324e4)=>{const _0x3f14e8=a24_0x25ccff;try{const {paymentId:_0x369f4d}=_0x4b2f4c[_0x3f14e8(0x175)],_0x398a6c=coinToPayStatusService_1[_0x3f14e8(0x16b)][_0x3f14e8(0x145)](_0x369f4d),_0x5035b5=(await Promise[_0x3f14e8(0x147)]()['then'](()=>__importStar(require(_0x3f14e8(0x127)))))[_0x3f14e8(0x18a)],_0x23bc36=await _0x5035b5[_0x3f14e8(0x12c)][_0x3f14e8(0x12e)]({'where':{'id':_0x369f4d},'select':{'id':!![],'gateway':!![],'gatewayPaymentId':!![],'status':!![],'amount':!![],'currency':!![],'createdAt':!![],'updatedAt':!![],'shopId':!![],'shop':{'select':{'name':!![],'username':!![]}}}});if(!_0x23bc36)return _0x1324e4[_0x3f14e8(0x123)](0x194)[_0x3f14e8(0x171)]({'success':![],'message':_0x3f14e8(0x18f)});_0x1324e4[_0x3f14e8(0x171)]({'success':!![],'result':{'payment':{'id':_0x23bc36['id'],'gateway':_0x23bc36[_0x3f14e8(0x139)],'gatewayPaymentId':_0x23bc36['gatewayPaymentId'],'status':_0x23bc36[_0x3f14e8(0x123)],'amount':_0x23bc36[_0x3f14e8(0x17e)],'currency':_0x23bc36['currency'],'createdAt':_0x23bc36[_0x3f14e8(0x18c)],'updatedAt':_0x23bc36[_0x3f14e8(0x17d)],'shop':_0x23bc36[_0x3f14e8(0x13c)]},'timers':_0x398a6c,'isCoinToPay':_0x23bc36[_0x3f14e8(0x139)]==='cointopay','ageInMinutes':Math[_0x3f14e8(0x11c)]((Date[_0x3f14e8(0x144)]()-_0x23bc36['createdAt'][_0x3f14e8(0x189)]())/(0x3e8*0x3c))}});}catch(_0x2b2b1e){_0x1324e4[_0x3f14e8(0x123)](0x1f4)[_0x3f14e8(0x171)]({'success':![],'message':_0x2b2b1e instanceof Error?_0x2b2b1e[_0x3f14e8(0x165)]:_0x3f14e8(0x130)});}}),router['get'](a24_0x25ccff(0x17c),(_0x4b6728,_0x8791d)=>{const _0x5f1e68=a24_0x25ccff;try{const _0x20a6aa=domainMonitoringService_1[_0x5f1e68(0x125)][_0x5f1e68(0x13e)]();_0x8791d[_0x5f1e68(0x171)]({'success':!![],'result':{..._0x20a6aa,'description':_0x5f1e68(0x167),'behavior':'Server\x20crashes\x20if\x20domain\x20is\x20not\x20responding\x20after\x20consecutive\x20failures','encoding':_0x5f1e68(0x170)}});}catch(_0x4884d3){_0x8791d['status'](0x1f4)[_0x5f1e68(0x171)]({'success':![],'message':_0x5f1e68(0x15f)});}}),router[a24_0x25ccff(0x131)](a24_0x25ccff(0x184),async(_0x2f9a35,_0x454c85)=>{const _0x32a635=a24_0x25ccff;try{const _0x263d21=await domainMonitoringService_1['domainMonitoringService'][_0x32a635(0x149)]();_0x454c85[_0x32a635(0x171)]({'success':!![],'result':{'domainAvailable':_0x263d21,'message':_0x263d21?_0x32a635(0x187):_0x32a635(0x128),'timestamp':new Date()[_0x32a635(0x15a)]()}});}catch(_0x1f3fd0){_0x454c85[_0x32a635(0x123)](0x1f4)['json']({'success':![],'message':_0x1f3fd0 instanceof Error?_0x1f3fd0[_0x32a635(0x165)]:_0x32a635(0x176)});}}),exports[a24_0x25ccff(0x18a)]=router;