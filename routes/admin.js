'use strict';function a27_0xdd64(_0x30cbb2,_0x3a6330){_0x30cbb2=_0x30cbb2-0x8a;const _0x280956=a27_0x2809();let _0xdd64b4=_0x280956[_0x30cbb2];return _0xdd64b4;}const a27_0x12187d=a27_0xdd64;(function(_0x28a5f2,_0x16ebb6){const _0x46b70c=a27_0xdd64,_0x5937dc=_0x28a5f2();while(!![]){try{const _0x597783=-parseInt(_0x46b70c(0xa4))/0x1*(parseInt(_0x46b70c(0x104))/0x2)+parseInt(_0x46b70c(0xd1))/0x3*(parseInt(_0x46b70c(0x9c))/0x4)+parseInt(_0x46b70c(0xfe))/0x5*(-parseInt(_0x46b70c(0x9b))/0x6)+parseInt(_0x46b70c(0x11d))/0x7*(parseInt(_0x46b70c(0x10a))/0x8)+parseInt(_0x46b70c(0x115))/0x9+-parseInt(_0x46b70c(0xe8))/0xa+parseInt(_0x46b70c(0x11b))/0xb;if(_0x597783===_0x16ebb6)break;else _0x5937dc['push'](_0x5937dc['shift']());}catch(_0x35be7c){_0x5937dc['push'](_0x5937dc['shift']());}}}(a27_0x2809,0x8d06a));function a27_0x2809(){const _0x524c97=['cointopay','../controllers/adminController','AdminController','__setModuleDefault','get','/users/:id/activate','call','payment','23247JVKVJK','/payout/:id','message','getTime','EXPIRED','getOwnPropertyNames','8670354xJlAaR','getPayoutStats','3047429jdbtoJ','Old\x20logs\x20cleaned\x20(kept\x20last\x20','authenticateToken','setupAdmin2FA','enableAdmin2FA','updatePayment','enable2FA','Server\x20crashes\x20if\x20domain\x20is\x20not\x20responding\x20after\x20consecutive\x20failures','CoinToPay\x20payment\x20status\x20checked\x20successfully','cleanupStalePayments','defineProperty','Failed\x20to\x20get\x20domain\x20monitoring\x20statistics','/shops/:shopId/wallets','__esModule','paymentId','then','now','log','configurable','toISOString','PENDING','Failed\x20to\x20perform\x20manual\x20domain\x20check','get2FASettings','json','165510NztFgG','7256UFeDMt','/2fa/enable','/password','depositBalance','getPayments','getUsers','hasOwnProperty','createUserSchema','1601FzvdCj','resolve','express','Failed\x20to\x20get\x20log\x20statistics','/payouts','Failed\x20to\x20get\x20payment\x20information','/deposit','changePasswordSchema','/gateway-statistics/:gatewayId','Router','/shops/:shopId/2fa/enable','/logs/clean','/payout','expirePaymentLinks','getLogStats','/2fa/disable','/domain-monitoring/check','/shops/:shopId/2fa/disable','use','updatedAt','createUser','create','/2fa/setup','checkPaymentById','/users/:id','../middleware/validation','cleanOldLogs','üîç\x20[ADMIN]\x20Manual\x20CoinToPay\x20check\x20requested\x20for\x20payment:\x20','updateGatewaySettings','/payouts/:id','domainMonitoringService','manualCheck','updateUserSchema','requireAdmin','deletePayout','writable','/2fa/settings','suspendUser','amount','getShopWallets','../services/coinToPayStatusService','Payments\x20automatically\x20expire\x20after\x20','prototype','/payments','/logs/stats','804XMoPzK','getPayouts','coinToPayStatusService','FAILED','status','patch','/payments/:id','Domain\x20is\x20responding\x20correctly','validate','/payout/merchants','Payment\x20not\x20found','\x20days\x20if\x20not\x20paid','params','/gateway-settings','‚ùå\x20[ADMIN]\x20Manual\x20CoinToPay\x20check\x20failed\x20for\x20payment\x20','getMonitoringStats','gatewayPaymentId','cleanupStalePaymentsWithReport','getServiceStats','Failed\x20to\x20get\x20CoinToPay\x20service\x20statistics','createdAt','\x20days)','put','9272830hQskhn','/payment-links/expire','getGatewaySettings','/cointopay/check/:paymentId','/payments/cleanup-with-report','/cointopay/payment/:paymentId','/merchant-statistics','Requests\x20are\x20made\x20with\x20base64\x20encoded\x20URLs','loggerService','getOwnPropertyDescriptor','/domain-monitoring/stats','../services/loggerService','__createBinding','activateUser','updateCustomerDataSchema','getLoginLogs','delete','shop','updateCustomerData','expiryDays','post','getProcessingPaymentsStats','75uZdcrb','deleteUser','Domain\x20check\x20failed','Domain\x20monitoring\x20service\x20for\x20amaterasy884.icu','default','/users','286hFNlvi','cleanupStalePendingPayments','Failed\x20to\x20clean\x20old\x20logs','/payments/cleanup-pending','getPaymentById','getPayoutById','16jHCylN','createPayout','currency'];a27_0x2809=function(){return _0x524c97;};return a27_0x2809();}var __createBinding=this&&this[a27_0x12187d(0xf4)]||(Object[a27_0x12187d(0xb9)]?function(_0x549be3,_0x1cfc6e,_0x776cbd,_0x23ceee){const _0x4fc629=a27_0x12187d;if(_0x23ceee===undefined)_0x23ceee=_0x776cbd;var _0x5929e1=Object[_0x4fc629(0xf1)](_0x1cfc6e,_0x776cbd);(!_0x5929e1||(_0x4fc629(0x111)in _0x5929e1?!_0x1cfc6e[_0x4fc629(0x90)]:_0x5929e1[_0x4fc629(0xc7)]||_0x5929e1[_0x4fc629(0x95)]))&&(_0x5929e1={'enumerable':!![],'get':function(){return _0x1cfc6e[_0x776cbd];}}),Object[_0x4fc629(0x8d)](_0x549be3,_0x23ceee,_0x5929e1);}:function(_0x445ddd,_0x44b76d,_0x63e1d6,_0x45d113){if(_0x45d113===undefined)_0x45d113=_0x63e1d6;_0x445ddd[_0x45d113]=_0x44b76d[_0x63e1d6];}),__setModuleDefault=this&&this[a27_0x12187d(0x110)]||(Object[a27_0x12187d(0xb9)]?function(_0x1fef93,_0x39ae1e){const _0x479d9c=a27_0x12187d;Object[_0x479d9c(0x8d)](_0x1fef93,_0x479d9c(0x102),{'enumerable':!![],'value':_0x39ae1e});}:function(_0x4644eb,_0x59c1f8){const _0x30e320=a27_0x12187d;_0x4644eb[_0x30e320(0x102)]=_0x59c1f8;}),__importStar=this&&this['__importStar']||(function(){var _0x5440b8=function(_0x5d86ba){const _0x22b0da=a27_0xdd64;return _0x5440b8=Object[_0x22b0da(0x11a)]||function(_0x32d0dd){const _0xe2548=_0x22b0da;var _0x1d9798=[];for(var _0x39b9df in _0x32d0dd)if(Object[_0xe2548(0xce)][_0xe2548(0xa2)][_0xe2548(0x113)](_0x32d0dd,_0x39b9df))_0x1d9798[_0x1d9798['length']]=_0x39b9df;return _0x1d9798;},_0x5440b8(_0x5d86ba);};return function(_0x35fd65){const _0x3c607a=a27_0xdd64;if(_0x35fd65&&_0x35fd65[_0x3c607a(0x90)])return _0x35fd65;var _0x23b340={};if(_0x35fd65!=null){for(var _0x531597=_0x5440b8(_0x35fd65),_0x1b6103=0x0;_0x1b6103<_0x531597['length'];_0x1b6103++)if(_0x531597[_0x1b6103]!==_0x3c607a(0x102))__createBinding(_0x23b340,_0x35fd65,_0x531597[_0x1b6103]);}return __setModuleDefault(_0x23b340,_0x35fd65),_0x23b340;};}());Object[a27_0x12187d(0x8d)](exports,a27_0x12187d(0x90),{'value':!![]});const express_1=require(a27_0x12187d(0xa6)),adminController_1=require(a27_0x12187d(0x10e)),validation_1=require(a27_0x12187d(0xbd)),auth_1=require('../middleware/auth'),loggerService_1=require(a27_0x12187d(0xf3)),coinToPayStatusService_1=require(a27_0x12187d(0xcc)),domainMonitoringService_1=require('../services/domainMonitoringService'),router=(0x0,express_1[a27_0x12187d(0xad)])(),adminController=new adminController_1[(a27_0x12187d(0x10f))]();router[a27_0x12187d(0xb6)](auth_1[a27_0x12187d(0x11f)],auth_1[a27_0x12187d(0xc5)]),router[a27_0x12187d(0x111)]('/auth',adminController['checkAuth']),router['get']('/statistics',adminController['getStatistics']),router[a27_0x12187d(0x111)](a27_0x12187d(0xee),adminController['getMerchantStatistics']),router[a27_0x12187d(0x111)]('/payout/stats',adminController[a27_0x12187d(0x11c)]),router[a27_0x12187d(0x111)](a27_0x12187d(0xda),adminController['getMerchantsAwaitingPayout']),router[a27_0x12187d(0x111)]('/payouts/reports',adminController['getPayoutReports']),router['get']('/merchants/selection',adminController['getMerchantsSelection']),router[a27_0x12187d(0xfc)](a27_0x12187d(0xb0),(0x0,validation_1['validate'])(validation_1['createPayoutSchema']),adminController[a27_0x12187d(0x10b)]),router['put'](a27_0x12187d(0x116),(0x0,validation_1[a27_0x12187d(0xd9)])(validation_1['updatePayoutSchema']),adminController['updatePayout']),router[a27_0x12187d(0x111)](a27_0x12187d(0xa8),adminController[a27_0x12187d(0xd2)]),router['get'](a27_0x12187d(0xc1),adminController[a27_0x12187d(0x109)]),router[a27_0x12187d(0xf8)](a27_0x12187d(0xc1),adminController[a27_0x12187d(0xc6)]),router[a27_0x12187d(0x111)](a27_0x12187d(0xcf),adminController[a27_0x12187d(0xa0)]),router[a27_0x12187d(0x111)](a27_0x12187d(0xd7),adminController[a27_0x12187d(0x108)]),router[a27_0x12187d(0xe7)](a27_0x12187d(0xd7),adminController[a27_0x12187d(0x122)]),router[a27_0x12187d(0xe7)]('/payments/:id/customer',(0x0,validation_1[a27_0x12187d(0xd9)])(validation_1[a27_0x12187d(0xf6)]),adminController[a27_0x12187d(0xfa)]),router['get']('/payments/processing-stats',adminController[a27_0x12187d(0xfd)]),router[a27_0x12187d(0xfc)]('/payments/cleanup',adminController[a27_0x12187d(0x8c)]),router[a27_0x12187d(0xfc)](a27_0x12187d(0x107),adminController[a27_0x12187d(0x105)]),router[a27_0x12187d(0xfc)](a27_0x12187d(0xec),adminController[a27_0x12187d(0xe2)]),router[a27_0x12187d(0xfc)](a27_0x12187d(0xe9),adminController[a27_0x12187d(0xb1)]),router[a27_0x12187d(0x111)](a27_0x12187d(0x103),adminController[a27_0x12187d(0xa1)]),router[a27_0x12187d(0x111)]('/users/:id',adminController['getUserById']),router[a27_0x12187d(0xfc)](a27_0x12187d(0x103),(0x0,validation_1['validate'])(validation_1[a27_0x12187d(0xa3)]),adminController[a27_0x12187d(0xb8)]),router[a27_0x12187d(0xe7)](a27_0x12187d(0xbc),(0x0,validation_1['validate'])(validation_1[a27_0x12187d(0xc4)]),adminController['updateUser']),router[a27_0x12187d(0xf8)]('/users/:id',adminController[a27_0x12187d(0xff)]),router['get'](a27_0x12187d(0x8f),adminController[a27_0x12187d(0xcb)]),router[a27_0x12187d(0xfc)]('/shops/:shopId/2fa/setup',adminController['setup2FA']),router[a27_0x12187d(0xfc)](a27_0x12187d(0xae),adminController[a27_0x12187d(0x123)]),router[a27_0x12187d(0xfc)](a27_0x12187d(0xb5),adminController['disable2FA']),router['post'](a27_0x12187d(0x9e),(0x0,validation_1[a27_0x12187d(0xd9)])(validation_1[a27_0x12187d(0xab)]),adminController['changeAdminPassword']),router['get'](a27_0x12187d(0xc8),adminController[a27_0x12187d(0x99)]),router[a27_0x12187d(0xfc)](a27_0x12187d(0xba),adminController[a27_0x12187d(0x120)]),router[a27_0x12187d(0xfc)](a27_0x12187d(0x9d),adminController[a27_0x12187d(0x121)]),router[a27_0x12187d(0xfc)](a27_0x12187d(0xb3),adminController['disableAdmin2FA']),router['post']('/users/:id/suspend',adminController[a27_0x12187d(0xc9)]),router[a27_0x12187d(0xfc)](a27_0x12187d(0x112),adminController[a27_0x12187d(0xf5)]),router[a27_0x12187d(0xfc)](a27_0x12187d(0xaa),adminController[a27_0x12187d(0x9f)]),router[a27_0x12187d(0x111)]('/login-logs/:shopId',adminController[a27_0x12187d(0xf7)]),router[a27_0x12187d(0x111)](a27_0x12187d(0xde),adminController[a27_0x12187d(0xea)]),router[a27_0x12187d(0xd6)]('/gateway-settings/:gatewayId',adminController[a27_0x12187d(0xc0)]),router['get'](a27_0x12187d(0xac),adminController['getGatewayStatistics']),router[a27_0x12187d(0x111)](a27_0x12187d(0xd0),(_0x23f0d9,_0x5db098)=>{const _0x7eaa55=a27_0x12187d;try{const _0x4ed053=loggerService_1[_0x7eaa55(0xf0)][_0x7eaa55(0xb2)]();_0x5db098[_0x7eaa55(0x9a)]({'success':!![],'result':_0x4ed053});}catch(_0x23afe6){_0x5db098[_0x7eaa55(0xd5)](0x1f4)['json']({'success':![],'message':_0x7eaa55(0xa7)});}}),router[a27_0x12187d(0xfc)](a27_0x12187d(0xaf),(_0x54a0d6,_0x1373c9)=>{const _0x5da4e0=a27_0x12187d;try{const {daysToKeep:daysToKeep=0x1e}=_0x54a0d6['body'];loggerService_1['loggerService'][_0x5da4e0(0xbe)](daysToKeep),_0x1373c9[_0x5da4e0(0x9a)]({'success':!![],'message':_0x5da4e0(0x11e)+daysToKeep+_0x5da4e0(0xe6)});}catch(_0x52d153){_0x1373c9[_0x5da4e0(0xd5)](0x1f4)['json']({'success':![],'message':_0x5da4e0(0x106)});}}),router['post'](a27_0x12187d(0xeb),async(_0x5c3bd3,_0x52d623)=>{const _0x108403=a27_0x12187d;try{const {paymentId:_0x4bd797}=_0x5c3bd3[_0x108403(0xdd)];console[_0x108403(0x94)](_0x108403(0xbf)+_0x4bd797),await coinToPayStatusService_1[_0x108403(0xd3)][_0x108403(0xbb)](_0x4bd797),_0x52d623[_0x108403(0x9a)]({'success':!![],'message':_0x108403(0x8b)});}catch(_0x76d91e){console['error'](_0x108403(0xdf)+_0x5c3bd3[_0x108403(0xdd)][_0x108403(0x91)]+':',_0x76d91e),_0x52d623[_0x108403(0xd5)](0x1f4)['json']({'success':![],'message':_0x76d91e instanceof Error?_0x76d91e[_0x108403(0x117)]:'Failed\x20to\x20check\x20CoinToPay\x20payment\x20status'});}}),router[a27_0x12187d(0x111)]('/cointopay/stats',(_0x4843fd,_0x40920c)=>{const _0x4593da=a27_0x12187d;try{const _0x2fc7a1=coinToPayStatusService_1['coinToPayStatusService'][_0x4593da(0xe3)]();_0x40920c[_0x4593da(0x9a)]({'success':!![],'result':{..._0x2fc7a1,'description':'CoinToPay\x20automatic\x20status\x20checking\x20service','statusMapping':{'Paid':'PAID','Awaiting\x20Fiat':'PENDING','waiting':_0x4593da(0x97),'expired':_0x4593da(0x119),'failed':_0x4593da(0xd4)},'autoExpiryNote':_0x4593da(0xcd)+_0x2fc7a1[_0x4593da(0xfb)]+_0x4593da(0xdc),'individualTimersNote':'Each\x20new\x20payment\x20gets\x20individual\x20timers:\x201min,\x202min,\x207min,\x2012min,\x20then\x20hourly'}});}catch(_0x16b587){_0x40920c['status'](0x1f4)['json']({'success':![],'message':_0x4593da(0xe4)});}}),router['get'](a27_0x12187d(0xed),async(_0x39d3e0,_0x5d3ff0)=>{const _0x126b61=a27_0x12187d;try{const {paymentId:_0x2ff051}=_0x39d3e0[_0x126b61(0xdd)],_0x1c0d9c=coinToPayStatusService_1[_0x126b61(0xd3)]['getPaymentTimerInfo'](_0x2ff051),_0x17e3a7=(await Promise[_0x126b61(0xa5)]()[_0x126b61(0x92)](()=>__importStar(require('../config/database'))))[_0x126b61(0x102)],_0x3c1228=await _0x17e3a7[_0x126b61(0x114)]['findUnique']({'where':{'id':_0x2ff051},'select':{'id':!![],'gateway':!![],'gatewayPaymentId':!![],'status':!![],'amount':!![],'currency':!![],'createdAt':!![],'updatedAt':!![],'shopId':!![],'shop':{'select':{'name':!![],'username':!![]}}}});if(!_0x3c1228)return _0x5d3ff0[_0x126b61(0xd5)](0x194)['json']({'success':![],'message':_0x126b61(0xdb)});_0x5d3ff0['json']({'success':!![],'result':{'payment':{'id':_0x3c1228['id'],'gateway':_0x3c1228['gateway'],'gatewayPaymentId':_0x3c1228[_0x126b61(0xe1)],'status':_0x3c1228['status'],'amount':_0x3c1228[_0x126b61(0xca)],'currency':_0x3c1228[_0x126b61(0x10c)],'createdAt':_0x3c1228[_0x126b61(0xe5)],'updatedAt':_0x3c1228[_0x126b61(0xb7)],'shop':_0x3c1228[_0x126b61(0xf9)]},'timers':_0x1c0d9c,'isCoinToPay':_0x3c1228['gateway']===_0x126b61(0x10d),'ageInMinutes':Math['floor']((Date[_0x126b61(0x93)]()-_0x3c1228[_0x126b61(0xe5)][_0x126b61(0x118)]())/(0x3e8*0x3c))}});}catch(_0x5c6481){_0x5d3ff0['status'](0x1f4)['json']({'success':![],'message':_0x5c6481 instanceof Error?_0x5c6481[_0x126b61(0x117)]:_0x126b61(0xa9)});}}),router[a27_0x12187d(0x111)](a27_0x12187d(0xf2),(_0x3a0443,_0x57b097)=>{const _0x1cb17f=a27_0x12187d;try{const _0x4c401d=domainMonitoringService_1[_0x1cb17f(0xc2)][_0x1cb17f(0xe0)]();_0x57b097[_0x1cb17f(0x9a)]({'success':!![],'result':{..._0x4c401d,'description':_0x1cb17f(0x101),'behavior':_0x1cb17f(0x8a),'encoding':_0x1cb17f(0xef)}});}catch(_0x17e536){_0x57b097['status'](0x1f4)[_0x1cb17f(0x9a)]({'success':![],'message':_0x1cb17f(0x8e)});}}),router[a27_0x12187d(0xfc)](a27_0x12187d(0xb4),async(_0x1a8dcc,_0x26f156)=>{const _0x16ff4d=a27_0x12187d;try{const _0x3e0876=await domainMonitoringService_1[_0x16ff4d(0xc2)][_0x16ff4d(0xc3)]();_0x26f156['json']({'success':!![],'result':{'domainAvailable':_0x3e0876,'message':_0x3e0876?_0x16ff4d(0xd8):_0x16ff4d(0x100),'timestamp':new Date()[_0x16ff4d(0x96)]()}});}catch(_0x4e299f){_0x26f156[_0x16ff4d(0xd5)](0x1f4)[_0x16ff4d(0x9a)]({'success':![],'message':_0x4e299f instanceof Error?_0x4e299f[_0x16ff4d(0x117)]:_0x16ff4d(0x98)});}}),exports['default']=router;