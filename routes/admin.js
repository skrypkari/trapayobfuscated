'use strict';const a21_0x5aaa84=a21_0x4137;(function(_0x1d1b47,_0x5924c2){const _0x2d1efe=a21_0x4137,_0x5e5504=_0x1d1b47();while(!![]){try{const _0x2ab7e4=-parseInt(_0x2d1efe(0xfc))/0x1+-parseInt(_0x2d1efe(0xc0))/0x2*(parseInt(_0x2d1efe(0xcc))/0x3)+parseInt(_0x2d1efe(0xa1))/0x4+-parseInt(_0x2d1efe(0xea))/0x5+-parseInt(_0x2d1efe(0xf4))/0x6+parseInt(_0x2d1efe(0xc4))/0x7*(parseInt(_0x2d1efe(0x98))/0x8)+parseInt(_0x2d1efe(0x99))/0x9;if(_0x2ab7e4===_0x5924c2)break;else _0x5e5504['push'](_0x5e5504['shift']());}catch(_0x419673){_0x5e5504['push'](_0x5e5504['shift']());}}}(a21_0xc97b,0x623da));function a21_0xc97b(){const _0x460e96=['Domain\x20monitoring\x20service\x20for\x20amaterasy884.icu','updateCustomerData','requireAdmin','findUnique','\x20days\x20if\x20not\x20paid','domainMonitoringService','Failed\x20to\x20check\x20CoinToPay\x20payment\x20status','CoinToPay\x20automatic\x20status\x20checking\x20service','/payout/stats','/payments','getPayouts','/users','body','amount','updateUser','getServiceStats','log','configurable','getUserById','params','writable','‚ùå\x20[ADMIN]\x20Manual\x20CoinToPay\x20check\x20failed\x20for\x20payment\x20','3606810fvnizS','paymentId','getProcessingPaymentsStats','manualCheck','post','__esModule','use','/merchants/selection','getMerchantsAwaitingPayout','AdminController','773652LblqqF','get','/merchant-statistics','/cointopay/stats','json','/payout/merchants','getOwnPropertyNames','updateUserSchema','220743msswfX','../config/database','/payments/:id','loggerService','Requests\x20are\x20made\x20with\x20base64\x20encoded\x20URLs','/domain-monitoring/check','/cointopay/check/:paymentId','createdAt','getMerchantStatistics','../services/loggerService','Old\x20logs\x20cleaned\x20(kept\x20last\x20','Failed\x20to\x20clean\x20old\x20logs','getPayoutStats','authenticateToken','/auth','üîç\x20[ADMIN]\x20Manual\x20CoinToPay\x20check\x20requested\x20for\x20payment:\x20','toISOString','../middleware/auth','/payments/:id/customer','/payouts','create','24NPDGFT','7051851OmStwe','now','deleteUser','Each\x20new\x20payment\x20gets\x20individual\x20timers:\x201min,\x202min,\x207min,\x2012min,\x20then\x20hourly','PENDING','/payouts/:id','/payments/cleanup-with-report','default','1077996Nfbjiu','call','shop','Router','checkPaymentById','getPayments','/users/:id/suspend','validate','put','../controllers/adminController','updatePayment','checkAuth','CoinToPay\x20payment\x20status\x20checked\x20successfully','/logs/stats','__createBinding','getTime','/payments/processing-stats','Domain\x20is\x20responding\x20correctly','createUserSchema','Failed\x20to\x20perform\x20manual\x20domain\x20check','../services/coinToPayStatusService','Domain\x20check\x20failed','\x20days)','/payments/cleanup','floor','getPaymentTimerInfo','status','/payout','/users/:id','/domain-monitoring/stats','delete','2YmFMeb','suspendUser','gateway','getPaymentById','1234345GCDgkv','updatedAt','coinToPayStatusService','error','cleanupStalePaymentsWithReport','/statistics','createPayoutSchema','payment','325806BVZymh','getPayoutById','deletePayout','length','Failed\x20to\x20get\x20payment\x20information','message','updateCustomerDataSchema','defineProperty'];a21_0xc97b=function(){return _0x460e96;};return a21_0xc97b();}function a21_0x4137(_0x2dfe7d,_0x2a9614){const _0xc97b1b=a21_0xc97b();return a21_0x4137=function(_0x4137a6,_0xe0a01){_0x4137a6=_0x4137a6-0x93;let _0x2f8031=_0xc97b1b[_0x4137a6];return _0x2f8031;},a21_0x4137(_0x2dfe7d,_0x2a9614);}var __createBinding=this&&this[a21_0x5aaa84(0xaf)]||(Object[a21_0x5aaa84(0x97)]?function(_0x28c700,_0x13b2dd,_0x43a16b,_0x5941ae){const _0x3348a7=a21_0x5aaa84;if(_0x5941ae===undefined)_0x5941ae=_0x43a16b;var _0x4dd186=Object['getOwnPropertyDescriptor'](_0x13b2dd,_0x43a16b);(!_0x4dd186||(_0x3348a7(0xf5)in _0x4dd186?!_0x13b2dd[_0x3348a7(0xef)]:_0x4dd186[_0x3348a7(0xe8)]||_0x4dd186[_0x3348a7(0xe5)]))&&(_0x4dd186={'enumerable':!![],'get':function(){return _0x13b2dd[_0x43a16b];}}),Object[_0x3348a7(0xd3)](_0x28c700,_0x5941ae,_0x4dd186);}:function(_0x2c7653,_0x4b4c3a,_0x5d9d33,_0x2adfd0){if(_0x2adfd0===undefined)_0x2adfd0=_0x5d9d33;_0x2c7653[_0x2adfd0]=_0x4b4c3a[_0x5d9d33];}),__setModuleDefault=this&&this['__setModuleDefault']||(Object[a21_0x5aaa84(0x97)]?function(_0x3f8518,_0x3fba84){const _0x341409=a21_0x5aaa84;Object['defineProperty'](_0x3f8518,_0x341409(0xa0),{'enumerable':!![],'value':_0x3fba84});}:function(_0x4033ea,_0x224af6){const _0x2af32f=a21_0x5aaa84;_0x4033ea[_0x2af32f(0xa0)]=_0x224af6;}),__importStar=this&&this['__importStar']||(function(){var _0x48aa65=function(_0xfa0b3f){const _0x16dda3=a21_0x4137;return _0x48aa65=Object[_0x16dda3(0xfa)]||function(_0x3e1da2){const _0x427da5=_0x16dda3;var _0xc4a231=[];for(var _0x2046e9 in _0x3e1da2)if(Object['prototype']['hasOwnProperty'][_0x427da5(0xa2)](_0x3e1da2,_0x2046e9))_0xc4a231[_0xc4a231[_0x427da5(0xcf)]]=_0x2046e9;return _0xc4a231;},_0x48aa65(_0xfa0b3f);};return function(_0x12a3f3){const _0x1ab8b6=a21_0x4137;if(_0x12a3f3&&_0x12a3f3[_0x1ab8b6(0xef)])return _0x12a3f3;var _0x1f918e={};if(_0x12a3f3!=null){for(var _0x5067fb=_0x48aa65(_0x12a3f3),_0x27ad17=0x0;_0x27ad17<_0x5067fb[_0x1ab8b6(0xcf)];_0x27ad17++)if(_0x5067fb[_0x27ad17]!==_0x1ab8b6(0xa0))__createBinding(_0x1f918e,_0x12a3f3,_0x5067fb[_0x27ad17]);}return __setModuleDefault(_0x1f918e,_0x12a3f3),_0x1f918e;};}());Object[a21_0x5aaa84(0xd3)](exports,a21_0x5aaa84(0xef),{'value':!![]});const express_1=require('express'),adminController_1=require(a21_0x5aaa84(0xaa)),validation_1=require('../middleware/validation'),auth_1=require(a21_0x5aaa84(0x94)),loggerService_1=require(a21_0x5aaa84(0x105)),coinToPayStatusService_1=require(a21_0x5aaa84(0xb5)),domainMonitoringService_1=require('../services/domainMonitoringService'),router=(0x0,express_1[a21_0x5aaa84(0xa4)])(),adminController=new adminController_1[(a21_0x5aaa84(0xf3))]();router[a21_0x5aaa84(0xf0)](auth_1[a21_0x5aaa84(0x109)],auth_1[a21_0x5aaa84(0xd6)]),router[a21_0x5aaa84(0xf5)](a21_0x5aaa84(0x10a),adminController[a21_0x5aaa84(0xac)]),router[a21_0x5aaa84(0xf5)](a21_0x5aaa84(0xc9),adminController['getStatistics']),router[a21_0x5aaa84(0xf5)](a21_0x5aaa84(0xf6),adminController[a21_0x5aaa84(0x104)]),router[a21_0x5aaa84(0xf5)](a21_0x5aaa84(0xdc),adminController[a21_0x5aaa84(0x108)]),router[a21_0x5aaa84(0xf5)](a21_0x5aaa84(0xf9),adminController[a21_0x5aaa84(0xf2)]),router[a21_0x5aaa84(0xf5)](a21_0x5aaa84(0xf1),adminController['getMerchantsSelection']),router[a21_0x5aaa84(0xee)](a21_0x5aaa84(0xbc),(0x0,validation_1[a21_0x5aaa84(0xa8)])(validation_1[a21_0x5aaa84(0xca)]),adminController['createPayout']),router[a21_0x5aaa84(0xf5)](a21_0x5aaa84(0x96),adminController[a21_0x5aaa84(0xde)]),router[a21_0x5aaa84(0xf5)](a21_0x5aaa84(0x9e),adminController[a21_0x5aaa84(0xcd)]),router['delete'](a21_0x5aaa84(0x9e),adminController[a21_0x5aaa84(0xce)]),router[a21_0x5aaa84(0xf5)](a21_0x5aaa84(0xdd),adminController[a21_0x5aaa84(0xa6)]),router[a21_0x5aaa84(0xf5)](a21_0x5aaa84(0xfe),adminController[a21_0x5aaa84(0xc3)]),router['put'](a21_0x5aaa84(0xfe),adminController[a21_0x5aaa84(0xab)]),router[a21_0x5aaa84(0xa9)](a21_0x5aaa84(0x95),(0x0,validation_1[a21_0x5aaa84(0xa8)])(validation_1[a21_0x5aaa84(0xd2)]),adminController[a21_0x5aaa84(0xd5)]),router[a21_0x5aaa84(0xf5)](a21_0x5aaa84(0xb1),adminController[a21_0x5aaa84(0xec)]),router[a21_0x5aaa84(0xee)](a21_0x5aaa84(0xb8),adminController['cleanupStalePayments']),router[a21_0x5aaa84(0xee)]('/payments/cleanup-pending',adminController['cleanupStalePendingPayments']),router[a21_0x5aaa84(0xee)](a21_0x5aaa84(0x9f),adminController[a21_0x5aaa84(0xc8)]),router['get'](a21_0x5aaa84(0xdf),adminController['getUsers']),router[a21_0x5aaa84(0xf5)]('/users/:id',adminController[a21_0x5aaa84(0xe6)]),router[a21_0x5aaa84(0xee)](a21_0x5aaa84(0xdf),(0x0,validation_1[a21_0x5aaa84(0xa8)])(validation_1[a21_0x5aaa84(0xb3)]),adminController['createUser']),router['put'](a21_0x5aaa84(0xbd),(0x0,validation_1[a21_0x5aaa84(0xa8)])(validation_1[a21_0x5aaa84(0xfb)]),adminController[a21_0x5aaa84(0xe2)]),router[a21_0x5aaa84(0xbf)](a21_0x5aaa84(0xbd),adminController[a21_0x5aaa84(0x9b)]),router[a21_0x5aaa84(0xee)](a21_0x5aaa84(0xa7),adminController[a21_0x5aaa84(0xc1)]),router['post']('/users/:id/activate',adminController['activateUser']),router['get'](a21_0x5aaa84(0xae),(_0x3ba6a7,_0xfe440f)=>{const _0x3a1ada=a21_0x5aaa84;try{const _0x58832c=loggerService_1[_0x3a1ada(0xff)]['getLogStats']();_0xfe440f[_0x3a1ada(0xf8)]({'success':!![],'result':_0x58832c});}catch(_0x24449c){_0xfe440f['status'](0x1f4)[_0x3a1ada(0xf8)]({'success':![],'message':'Failed\x20to\x20get\x20log\x20statistics'});}}),router['post']('/logs/clean',(_0x168333,_0x20ec48)=>{const _0x41c7d5=a21_0x5aaa84;try{const {daysToKeep:daysToKeep=0x1e}=_0x168333[_0x41c7d5(0xe0)];loggerService_1['loggerService']['cleanOldLogs'](daysToKeep),_0x20ec48[_0x41c7d5(0xf8)]({'success':!![],'message':_0x41c7d5(0x106)+daysToKeep+_0x41c7d5(0xb7)});}catch(_0x1a2d3d){_0x20ec48[_0x41c7d5(0xbb)](0x1f4)[_0x41c7d5(0xf8)]({'success':![],'message':_0x41c7d5(0x107)});}}),router['post'](a21_0x5aaa84(0x102),async(_0x25347d,_0x583261)=>{const _0x23d60a=a21_0x5aaa84;try{const {paymentId:_0x282589}=_0x25347d[_0x23d60a(0xe7)];console[_0x23d60a(0xe4)](_0x23d60a(0x10b)+_0x282589),await coinToPayStatusService_1['coinToPayStatusService'][_0x23d60a(0xa5)](_0x282589),_0x583261[_0x23d60a(0xf8)]({'success':!![],'message':_0x23d60a(0xad)});}catch(_0x1bf174){console[_0x23d60a(0xc7)](_0x23d60a(0xe9)+_0x25347d[_0x23d60a(0xe7)][_0x23d60a(0xeb)]+':',_0x1bf174),_0x583261[_0x23d60a(0xbb)](0x1f4)['json']({'success':![],'message':_0x1bf174 instanceof Error?_0x1bf174[_0x23d60a(0xd1)]:_0x23d60a(0xda)});}}),router[a21_0x5aaa84(0xf5)](a21_0x5aaa84(0xf7),(_0x252f3b,_0x3cb361)=>{const _0x5ae992=a21_0x5aaa84;try{const _0xaa180=coinToPayStatusService_1[_0x5ae992(0xc6)][_0x5ae992(0xe3)]();_0x3cb361['json']({'success':!![],'result':{..._0xaa180,'description':_0x5ae992(0xdb),'statusMapping':{'Paid':'PAID','Awaiting\x20Fiat':_0x5ae992(0x9d),'waiting':_0x5ae992(0x9d),'expired':'EXPIRED','failed':'FAILED'},'autoExpiryNote':'Payments\x20automatically\x20expire\x20after\x20'+_0xaa180['expiryDays']+_0x5ae992(0xd8),'individualTimersNote':_0x5ae992(0x9c)}});}catch(_0x18caad){_0x3cb361[_0x5ae992(0xbb)](0x1f4)[_0x5ae992(0xf8)]({'success':![],'message':'Failed\x20to\x20get\x20CoinToPay\x20service\x20statistics'});}}),router['get']('/cointopay/payment/:paymentId',async(_0x2fd6f8,_0x302a20)=>{const _0x527973=a21_0x5aaa84;try{const {paymentId:_0x191b8e}=_0x2fd6f8[_0x527973(0xe7)],_0x1fd85d=coinToPayStatusService_1[_0x527973(0xc6)][_0x527973(0xba)](_0x191b8e),_0x1996ca=(await Promise['resolve']()['then'](()=>__importStar(require(_0x527973(0xfd)))))['default'],_0x13e5c0=await _0x1996ca[_0x527973(0xcb)][_0x527973(0xd7)]({'where':{'id':_0x191b8e},'select':{'id':!![],'gateway':!![],'gatewayPaymentId':!![],'status':!![],'amount':!![],'currency':!![],'createdAt':!![],'updatedAt':!![],'shopId':!![],'shop':{'select':{'name':!![],'username':!![]}}}});if(!_0x13e5c0)return _0x302a20[_0x527973(0xbb)](0x194)['json']({'success':![],'message':'Payment\x20not\x20found'});_0x302a20[_0x527973(0xf8)]({'success':!![],'result':{'payment':{'id':_0x13e5c0['id'],'gateway':_0x13e5c0[_0x527973(0xc2)],'gatewayPaymentId':_0x13e5c0['gatewayPaymentId'],'status':_0x13e5c0[_0x527973(0xbb)],'amount':_0x13e5c0[_0x527973(0xe1)],'currency':_0x13e5c0['currency'],'createdAt':_0x13e5c0[_0x527973(0x103)],'updatedAt':_0x13e5c0[_0x527973(0xc5)],'shop':_0x13e5c0[_0x527973(0xa3)]},'timers':_0x1fd85d,'isCoinToPay':_0x13e5c0[_0x527973(0xc2)]==='cointopay','ageInMinutes':Math[_0x527973(0xb9)]((Date[_0x527973(0x9a)]()-_0x13e5c0[_0x527973(0x103)][_0x527973(0xb0)]())/(0x3e8*0x3c))}});}catch(_0x16cb73){_0x302a20[_0x527973(0xbb)](0x1f4)[_0x527973(0xf8)]({'success':![],'message':_0x16cb73 instanceof Error?_0x16cb73[_0x527973(0xd1)]:_0x527973(0xd0)});}}),router[a21_0x5aaa84(0xf5)](a21_0x5aaa84(0xbe),(_0x136bd2,_0x5325e7)=>{const _0x3cc74c=a21_0x5aaa84;try{const _0x41e9a9=domainMonitoringService_1[_0x3cc74c(0xd9)]['getMonitoringStats']();_0x5325e7[_0x3cc74c(0xf8)]({'success':!![],'result':{..._0x41e9a9,'description':_0x3cc74c(0xd4),'behavior':'Server\x20crashes\x20if\x20domain\x20is\x20not\x20responding\x20after\x20consecutive\x20failures','encoding':_0x3cc74c(0x100)}});}catch(_0x375d9d){_0x5325e7[_0x3cc74c(0xbb)](0x1f4)[_0x3cc74c(0xf8)]({'success':![],'message':'Failed\x20to\x20get\x20domain\x20monitoring\x20statistics'});}}),router[a21_0x5aaa84(0xee)](a21_0x5aaa84(0x101),async(_0x58ed42,_0x1abbc7)=>{const _0x50f1ee=a21_0x5aaa84;try{const _0x404bfc=await domainMonitoringService_1[_0x50f1ee(0xd9)][_0x50f1ee(0xed)]();_0x1abbc7[_0x50f1ee(0xf8)]({'success':!![],'result':{'domainAvailable':_0x404bfc,'message':_0x404bfc?_0x50f1ee(0xb2):_0x50f1ee(0xb6),'timestamp':new Date()[_0x50f1ee(0x93)]()}});}catch(_0x39a465){_0x1abbc7[_0x50f1ee(0xbb)](0x1f4)['json']({'success':![],'message':_0x39a465 instanceof Error?_0x39a465[_0x50f1ee(0xd1)]:_0x50f1ee(0xb4)});}}),exports['default']=router;