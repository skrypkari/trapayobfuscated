'use strict';const a19_0x228e26=a19_0x347b;(function(_0x37dc00,_0x5f1485){const _0x468d30=a19_0x347b,_0x4f8f93=_0x37dc00();while(!![]){try{const _0x207f81=-parseInt(_0x468d30(0x200))/0x1*(parseInt(_0x468d30(0x22a))/0x2)+-parseInt(_0x468d30(0x1dc))/0x3+-parseInt(_0x468d30(0x203))/0x4*(-parseInt(_0x468d30(0x24c))/0x5)+-parseInt(_0x468d30(0x22d))/0x6+-parseInt(_0x468d30(0x231))/0x7+parseInt(_0x468d30(0x1e5))/0x8+parseInt(_0x468d30(0x21b))/0x9;if(_0x207f81===_0x5f1485)break;else _0x4f8f93['push'](_0x4f8f93['shift']());}catch(_0x5b6dec){_0x4f8f93['push'](_0x4f8f93['shift']());}}}(a19_0x46c5,0x630bb));function a19_0x46c5(){const _0x35284d=['updatedAt','getMonitoringStats','authenticateToken','../middleware/validation','Server\x20crashes\x20if\x20domain\x20is\x20not\x20responding\x20after\x20consecutive\x20failures','getPayoutStats','/payments','Each\x20new\x20payment\x20gets\x20individual\x20timers:\x201min,\x202min,\x207min,\x2012min,\x20then\x20hourly','Domain\x20monitoring\x20service\x20for\x20amaterasy884.icu','put','createPayout','deletePayout','getPaymentById','Payment\x20not\x20found','getStatistics','Failed\x20to\x20check\x20CoinToPay\x20payment\x20status','status','checkPaymentById','/payouts/:id','paymentId','/domain-monitoring/check','writable','Old\x20logs\x20cleaned\x20(kept\x20last\x20','648665RbcVsy','log','2106165vPfVkv','getUsers','deleteUser','Domain\x20is\x20responding\x20correctly','get','hasOwnProperty','json','/users/:id','Payments\x20automatically\x20expire\x20after\x20','3414472huCcJp','/logs/clean','createPayoutSchema','getMerchantStatistics','Failed\x20to\x20get\x20payment\x20information','../config/database','findUnique','loggerService','/payments/:id','EXPIRED','/logs/stats','__setModuleDefault','params','message','floor','create','createdAt','createUser','domainMonitoringService','defineProperty','/users/:id/activate','/users','getServiceStats','/cointopay/check/:paymentId','checkAuth','default','PENDING','1SywCSs','expiryDays','Failed\x20to\x20get\x20log\x20statistics','8FvFtef','updateCustomerData','CoinToPay\x20automatic\x20status\x20checking\x20service','‚ùå\x20[ADMIN]\x20Manual\x20CoinToPay\x20check\x20failed\x20for\x20payment\x20','coinToPayStatusService','\x20days)','getMerchantsAwaitingPayout','updateCustomerDataSchema','gatewayPaymentId','activateUser','FAILED','Failed\x20to\x20clean\x20old\x20logs','body','gateway','configurable','/payouts','/merchant-statistics','Failed\x20to\x20perform\x20manual\x20domain\x20check','/auth','amount','post','getPayments','getPaymentTimerInfo','__createBinding','20540799cWQiHE','AdminController','Router','cleanOldLogs','CoinToPay\x20payment\x20status\x20checked\x20successfully','updatePayment','/payout/stats','length','../services/domainMonitoringService','delete','use','üîç\x20[ADMIN]\x20Manual\x20CoinToPay\x20check\x20requested\x20for\x20payment:\x20','getOwnPropertyNames','resolve','validate','1195166ELqWNI','getTime','getUserById','3974184CDdaNJ','../controllers/adminController','__esModule','manualCheck','4206251BkwBPI','Failed\x20to\x20get\x20CoinToPay\x20service\x20statistics','updateUserSchema','getLogStats'];a19_0x46c5=function(){return _0x35284d;};return a19_0x46c5();}function a19_0x347b(_0x6f598,_0x5385ea){const _0x46c54b=a19_0x46c5();return a19_0x347b=function(_0x347bc6,_0x14078d){_0x347bc6=_0x347bc6-0x1db;let _0x30cedd=_0x46c54b[_0x347bc6];return _0x30cedd;},a19_0x347b(_0x6f598,_0x5385ea);}var __createBinding=this&&this[a19_0x228e26(0x21a)]||(Object[a19_0x228e26(0x1f4)]?function(_0x30a02d,_0x131763,_0x54d891,_0x45c5b4){const _0x495cd8=a19_0x228e26;if(_0x45c5b4===undefined)_0x45c5b4=_0x54d891;var _0x4e46bf=Object['getOwnPropertyDescriptor'](_0x131763,_0x54d891);(!_0x4e46bf||(_0x495cd8(0x1e0)in _0x4e46bf?!_0x131763[_0x495cd8(0x22f)]:_0x4e46bf[_0x495cd8(0x24a)]||_0x4e46bf[_0x495cd8(0x211)]))&&(_0x4e46bf={'enumerable':!![],'get':function(){return _0x131763[_0x54d891];}}),Object[_0x495cd8(0x1f8)](_0x30a02d,_0x45c5b4,_0x4e46bf);}:function(_0x13a70a,_0x1cdd44,_0x583fb6,_0x54c51a){if(_0x54c51a===undefined)_0x54c51a=_0x583fb6;_0x13a70a[_0x54c51a]=_0x1cdd44[_0x583fb6];}),__setModuleDefault=this&&this[a19_0x228e26(0x1f0)]||(Object['create']?function(_0x5cdad8,_0x52c452){const _0x1f87a3=a19_0x228e26;Object[_0x1f87a3(0x1f8)](_0x5cdad8,'default',{'enumerable':!![],'value':_0x52c452});}:function(_0x56c71c,_0x50aa54){const _0xb52536=a19_0x228e26;_0x56c71c[_0xb52536(0x1fe)]=_0x50aa54;}),__importStar=this&&this['__importStar']||(function(){var _0x4c7c2f=function(_0x1b271d){const _0x2553d9=a19_0x347b;return _0x4c7c2f=Object[_0x2553d9(0x227)]||function(_0x32e42b){const _0x3f976a=_0x2553d9;var _0x3bfd45=[];for(var _0xd5f39c in _0x32e42b)if(Object['prototype'][_0x3f976a(0x1e1)]['call'](_0x32e42b,_0xd5f39c))_0x3bfd45[_0x3bfd45[_0x3f976a(0x222)]]=_0xd5f39c;return _0x3bfd45;},_0x4c7c2f(_0x1b271d);};return function(_0x3f8c00){const _0x2eac7e=a19_0x347b;if(_0x3f8c00&&_0x3f8c00[_0x2eac7e(0x22f)])return _0x3f8c00;var _0x528e3f={};if(_0x3f8c00!=null){for(var _0x430a05=_0x4c7c2f(_0x3f8c00),_0x3b28ed=0x0;_0x3b28ed<_0x430a05[_0x2eac7e(0x222)];_0x3b28ed++)if(_0x430a05[_0x3b28ed]!==_0x2eac7e(0x1fe))__createBinding(_0x528e3f,_0x3f8c00,_0x430a05[_0x3b28ed]);}return __setModuleDefault(_0x528e3f,_0x3f8c00),_0x528e3f;};}());Object[a19_0x228e26(0x1f8)](exports,'__esModule',{'value':!![]});const express_1=require('express'),adminController_1=require(a19_0x228e26(0x22e)),validation_1=require(a19_0x228e26(0x238)),auth_1=require('../middleware/auth'),loggerService_1=require('../services/loggerService'),coinToPayStatusService_1=require('../services/coinToPayStatusService'),domainMonitoringService_1=require(a19_0x228e26(0x223)),router=(0x0,express_1[a19_0x228e26(0x21d)])(),adminController=new adminController_1[(a19_0x228e26(0x21c))]();router[a19_0x228e26(0x225)](auth_1[a19_0x228e26(0x237)],auth_1['requireAdmin']),router[a19_0x228e26(0x1e0)](a19_0x228e26(0x215),adminController[a19_0x228e26(0x1fd)]),router[a19_0x228e26(0x1e0)]('/statistics',adminController[a19_0x228e26(0x243)]),router[a19_0x228e26(0x1e0)](a19_0x228e26(0x213),adminController[a19_0x228e26(0x1e8)]),router['get'](a19_0x228e26(0x221),adminController[a19_0x228e26(0x23a)]),router[a19_0x228e26(0x1e0)]('/payout/merchants',adminController[a19_0x228e26(0x209)]),router[a19_0x228e26(0x217)]('/payout',(0x0,validation_1['validate'])(validation_1[a19_0x228e26(0x1e7)]),adminController[a19_0x228e26(0x23f)]),router[a19_0x228e26(0x1e0)](a19_0x228e26(0x212),adminController['getPayouts']),router[a19_0x228e26(0x1e0)](a19_0x228e26(0x247),adminController['getPayoutById']),router[a19_0x228e26(0x224)](a19_0x228e26(0x247),adminController[a19_0x228e26(0x240)]),router[a19_0x228e26(0x1e0)](a19_0x228e26(0x23b),adminController[a19_0x228e26(0x218)]),router[a19_0x228e26(0x1e0)](a19_0x228e26(0x1ed),adminController[a19_0x228e26(0x241)]),router[a19_0x228e26(0x23e)](a19_0x228e26(0x1ed),adminController[a19_0x228e26(0x220)]),router[a19_0x228e26(0x23e)]('/payments/:id/customer',(0x0,validation_1['validate'])(validation_1[a19_0x228e26(0x20a)]),adminController[a19_0x228e26(0x204)]),router[a19_0x228e26(0x1e0)](a19_0x228e26(0x1fa),adminController[a19_0x228e26(0x1dd)]),router[a19_0x228e26(0x1e0)](a19_0x228e26(0x1e3),adminController[a19_0x228e26(0x22c)]),router[a19_0x228e26(0x217)]('/users',(0x0,validation_1[a19_0x228e26(0x229)])(validation_1['createUserSchema']),adminController[a19_0x228e26(0x1f6)]),router[a19_0x228e26(0x23e)](a19_0x228e26(0x1e3),(0x0,validation_1[a19_0x228e26(0x229)])(validation_1[a19_0x228e26(0x233)]),adminController['updateUser']),router[a19_0x228e26(0x224)](a19_0x228e26(0x1e3),adminController[a19_0x228e26(0x1de)]),router[a19_0x228e26(0x217)]('/users/:id/suspend',adminController['suspendUser']),router[a19_0x228e26(0x217)](a19_0x228e26(0x1f9),adminController[a19_0x228e26(0x20c)]),router[a19_0x228e26(0x1e0)](a19_0x228e26(0x1ef),(_0x2681bc,_0x2f09ac)=>{const _0x3eb317=a19_0x228e26;try{const _0x31daa2=loggerService_1['loggerService'][_0x3eb317(0x234)]();_0x2f09ac[_0x3eb317(0x1e2)]({'success':!![],'result':_0x31daa2});}catch(_0x59e81e){_0x2f09ac['status'](0x1f4)[_0x3eb317(0x1e2)]({'success':![],'message':_0x3eb317(0x202)});}}),router['post'](a19_0x228e26(0x1e6),(_0x182ab6,_0x22d1a7)=>{const _0x10a359=a19_0x228e26;try{const {daysToKeep:daysToKeep=0x1e}=_0x182ab6[_0x10a359(0x20f)];loggerService_1[_0x10a359(0x1ec)][_0x10a359(0x21e)](daysToKeep),_0x22d1a7[_0x10a359(0x1e2)]({'success':!![],'message':_0x10a359(0x24b)+daysToKeep+_0x10a359(0x208)});}catch(_0x2243a3){_0x22d1a7[_0x10a359(0x245)](0x1f4)[_0x10a359(0x1e2)]({'success':![],'message':_0x10a359(0x20e)});}}),router[a19_0x228e26(0x217)](a19_0x228e26(0x1fc),async(_0x5a9a12,_0x3ff5f5)=>{const _0x83427e=a19_0x228e26;try{const {paymentId:_0x54db25}=_0x5a9a12[_0x83427e(0x1f1)];console[_0x83427e(0x1db)](_0x83427e(0x226)+_0x54db25),await coinToPayStatusService_1['coinToPayStatusService'][_0x83427e(0x246)](_0x54db25),_0x3ff5f5[_0x83427e(0x1e2)]({'success':!![],'message':_0x83427e(0x21f)});}catch(_0x2c7e1e){console['error'](_0x83427e(0x206)+_0x5a9a12[_0x83427e(0x1f1)][_0x83427e(0x248)]+':',_0x2c7e1e),_0x3ff5f5[_0x83427e(0x245)](0x1f4)[_0x83427e(0x1e2)]({'success':![],'message':_0x2c7e1e instanceof Error?_0x2c7e1e['message']:_0x83427e(0x244)});}}),router['get']('/cointopay/stats',(_0x274943,_0x272295)=>{const _0x4aac95=a19_0x228e26;try{const _0x32c2a9=coinToPayStatusService_1[_0x4aac95(0x207)][_0x4aac95(0x1fb)]();_0x272295[_0x4aac95(0x1e2)]({'success':!![],'result':{..._0x32c2a9,'description':_0x4aac95(0x205),'statusMapping':{'Paid':'PAID','Awaiting\x20Fiat':_0x4aac95(0x1ff),'waiting':_0x4aac95(0x1ff),'expired':_0x4aac95(0x1ee),'failed':_0x4aac95(0x20d)},'autoExpiryNote':_0x4aac95(0x1e4)+_0x32c2a9[_0x4aac95(0x201)]+'\x20days\x20if\x20not\x20paid','individualTimersNote':_0x4aac95(0x23c)}});}catch(_0x15f262){_0x272295[_0x4aac95(0x245)](0x1f4)['json']({'success':![],'message':_0x4aac95(0x232)});}}),router[a19_0x228e26(0x1e0)]('/cointopay/payment/:paymentId',async(_0x53dd87,_0x4cea96)=>{const _0x54a0f3=a19_0x228e26;try{const {paymentId:_0x87c21f}=_0x53dd87[_0x54a0f3(0x1f1)],_0x1f3137=coinToPayStatusService_1[_0x54a0f3(0x207)][_0x54a0f3(0x219)](_0x87c21f),_0x3f61e5=(await Promise[_0x54a0f3(0x228)]()['then'](()=>__importStar(require(_0x54a0f3(0x1ea)))))['default'],_0x4b3327=await _0x3f61e5['payment'][_0x54a0f3(0x1eb)]({'where':{'id':_0x87c21f},'select':{'id':!![],'gateway':!![],'gatewayPaymentId':!![],'status':!![],'amount':!![],'currency':!![],'createdAt':!![],'updatedAt':!![],'shopId':!![],'shop':{'select':{'name':!![],'username':!![]}}}});if(!_0x4b3327)return _0x4cea96['status'](0x194)['json']({'success':![],'message':_0x54a0f3(0x242)});_0x4cea96[_0x54a0f3(0x1e2)]({'success':!![],'result':{'payment':{'id':_0x4b3327['id'],'gateway':_0x4b3327[_0x54a0f3(0x210)],'gatewayPaymentId':_0x4b3327[_0x54a0f3(0x20b)],'status':_0x4b3327[_0x54a0f3(0x245)],'amount':_0x4b3327[_0x54a0f3(0x216)],'currency':_0x4b3327['currency'],'createdAt':_0x4b3327['createdAt'],'updatedAt':_0x4b3327[_0x54a0f3(0x235)],'shop':_0x4b3327['shop']},'timers':_0x1f3137,'isCoinToPay':_0x4b3327[_0x54a0f3(0x210)]==='cointopay','ageInMinutes':Math[_0x54a0f3(0x1f3)]((Date['now']()-_0x4b3327[_0x54a0f3(0x1f5)][_0x54a0f3(0x22b)]())/(0x3e8*0x3c))}});}catch(_0x5725c8){_0x4cea96[_0x54a0f3(0x245)](0x1f4)[_0x54a0f3(0x1e2)]({'success':![],'message':_0x5725c8 instanceof Error?_0x5725c8[_0x54a0f3(0x1f2)]:_0x54a0f3(0x1e9)});}}),router[a19_0x228e26(0x1e0)]('/domain-monitoring/stats',(_0x1b08b5,_0x30ac30)=>{const _0x13657c=a19_0x228e26;try{const _0x484ba2=domainMonitoringService_1[_0x13657c(0x1f7)][_0x13657c(0x236)]();_0x30ac30['json']({'success':!![],'result':{..._0x484ba2,'description':_0x13657c(0x23d),'behavior':_0x13657c(0x239),'encoding':'Requests\x20are\x20made\x20with\x20base64\x20encoded\x20URLs'}});}catch(_0x4b799d){_0x30ac30[_0x13657c(0x245)](0x1f4)[_0x13657c(0x1e2)]({'success':![],'message':'Failed\x20to\x20get\x20domain\x20monitoring\x20statistics'});}}),router[a19_0x228e26(0x217)](a19_0x228e26(0x249),async(_0x454435,_0x418f3c)=>{const _0x4c4849=a19_0x228e26;try{const _0x57d3b9=await domainMonitoringService_1['domainMonitoringService'][_0x4c4849(0x230)]();_0x418f3c['json']({'success':!![],'result':{'domainAvailable':_0x57d3b9,'message':_0x57d3b9?_0x4c4849(0x1df):'Domain\x20check\x20failed','timestamp':new Date()['toISOString']()}});}catch(_0x5eb599){_0x418f3c[_0x4c4849(0x245)](0x1f4)[_0x4c4849(0x1e2)]({'success':![],'message':_0x5eb599 instanceof Error?_0x5eb599[_0x4c4849(0x1f2)]:_0x4c4849(0x214)});}}),exports['default']=router;