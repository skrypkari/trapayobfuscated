'use strict';const a21_0x300e7f=a21_0x40cc;(function(_0x526df0,_0x475d0f){const _0x481447=a21_0x40cc,_0x1eef14=_0x526df0();while(!![]){try{const _0x19e449=-parseInt(_0x481447(0x1e6))/0x1*(-parseInt(_0x481447(0x1d2))/0x2)+parseInt(_0x481447(0x1f8))/0x3*(parseInt(_0x481447(0x1df))/0x4)+-parseInt(_0x481447(0x1d1))/0x5*(parseInt(_0x481447(0x233))/0x6)+parseInt(_0x481447(0x23b))/0x7+-parseInt(_0x481447(0x219))/0x8+parseInt(_0x481447(0x1f1))/0x9+parseInt(_0x481447(0x230))/0xa;if(_0x19e449===_0x475d0f)break;else _0x1eef14['push'](_0x1eef14['shift']());}catch(_0x3ff7f2){_0x1eef14['push'](_0x1eef14['shift']());}}}(a21_0x5d48,0x314c4));function a21_0x5d48(){const _0x3e6e65=['24733GmNlbC','getMerchantsSelection','deletePayout','Failed\x20to\x20perform\x20manual\x20domain\x20check','Failed\x20to\x20get\x20payment\x20information','status','updateUser','/cointopay/check/:paymentId','getLogStats','getPayouts','CoinToPay\x20automatic\x20status\x20checking\x20service','930672PBVBYw','__importStar','createdAt','activateUser','/merchant-statistics','../middleware/validation','manualCheck','18966XPwWzm','/payouts/:id','/logs/clean','length','/users','expiryDays','validate','EXPIRED','cointopay','updatePayment','Domain\x20check\x20failed','Server\x20crashes\x20if\x20domain\x20is\x20not\x20responding\x20after\x20consecutive\x20failures','__esModule','getUsers','getPaymentTimerInfo','put','message','/cointopay/payment/:paymentId','__createBinding','gatewayPaymentId','getMerchantsAwaitingPayout','get','\x20days)','coinToPayStatusService','PENDING','default','/payout','getPayments','createPayout','/payments/:id','cleanupStalePaymentsWithReport','createUserSchema','CoinToPay\x20payment\x20status\x20checked\x20successfully','1709776MEBQQl','AdminController','checkAuth','toISOString','call','Domain\x20is\x20responding\x20correctly','deleteUser','getMonitoringStats','getUserById','cleanupStalePayments','getTime','Payments\x20automatically\x20expire\x20after\x20','currency','express','params','loggerService','shop','then','/cointopay/stats','__setModuleDefault','updateCustomerDataSchema','gateway','findUnique','110860HJGAmE','writable','post','6wdJuDR','domainMonitoringService','getMerchantStatistics','cleanupStalePendingPayments','prototype','/payouts','payment','use','1944390zDCCaC','defineProperty','Failed\x20to\x20get\x20log\x20statistics','updateUserSchema','delete','checkPaymentById','Payment\x20not\x20found','/payments','/payments/cleanup-pending','Failed\x20to\x20clean\x20old\x20logs','üîç\x20[ADMIN]\x20Manual\x20CoinToPay\x20check\x20requested\x20for\x20payment:\x20','authenticateToken','suspendUser','json','paymentId','amount','1033235bzFiXz','14KtMdFH','requireAdmin','getPayoutStats','Failed\x20to\x20get\x20CoinToPay\x20service\x20statistics','Domain\x20monitoring\x20service\x20for\x20amaterasy884.icu','getPayoutById','Requests\x20are\x20made\x20with\x20base64\x20encoded\x20URLs','create','FAILED','hasOwnProperty','/payout/stats','updatedAt','now','36ygszNM','../services/domainMonitoringService','/users/:id','floor','resolve','configurable','log'];a21_0x5d48=function(){return _0x3e6e65;};return a21_0x5d48();}var __createBinding=this&&this[a21_0x300e7f(0x20a)]||(Object[a21_0x300e7f(0x1d9)]?function(_0x1118fb,_0x1a2d56,_0x441963,_0x373d16){const _0x3a57b3=a21_0x300e7f;if(_0x373d16===undefined)_0x373d16=_0x441963;var _0x934d2=Object['getOwnPropertyDescriptor'](_0x1a2d56,_0x441963);(!_0x934d2||(_0x3a57b3(0x20d)in _0x934d2?!_0x1a2d56[_0x3a57b3(0x204)]:_0x934d2[_0x3a57b3(0x231)]||_0x934d2[_0x3a57b3(0x1e4)]))&&(_0x934d2={'enumerable':!![],'get':function(){return _0x1a2d56[_0x441963];}}),Object[_0x3a57b3(0x23c)](_0x1118fb,_0x373d16,_0x934d2);}:function(_0x3862ff,_0x14e73d,_0x2e7440,_0x2784ce){if(_0x2784ce===undefined)_0x2784ce=_0x2e7440;_0x3862ff[_0x2784ce]=_0x14e73d[_0x2e7440];}),__setModuleDefault=this&&this[a21_0x300e7f(0x22c)]||(Object[a21_0x300e7f(0x1d9)]?function(_0x201f90,_0x200f4b){const _0x304c80=a21_0x300e7f;Object[_0x304c80(0x23c)](_0x201f90,'default',{'enumerable':!![],'value':_0x200f4b});}:function(_0x1981d5,_0x478f2b){_0x1981d5['default']=_0x478f2b;}),__importStar=this&&this[a21_0x300e7f(0x1f2)]||(function(){var _0x539d62=function(_0x58fbba){return _0x539d62=Object['getOwnPropertyNames']||function(_0x2f94b5){const _0x2790ed=a21_0x40cc;var _0x50a863=[];for(var _0x324ad2 in _0x2f94b5)if(Object[_0x2790ed(0x237)][_0x2790ed(0x1db)][_0x2790ed(0x21d)](_0x2f94b5,_0x324ad2))_0x50a863[_0x50a863[_0x2790ed(0x1fb)]]=_0x324ad2;return _0x50a863;},_0x539d62(_0x58fbba);};return function(_0x1185a7){const _0x1508c0=a21_0x40cc;if(_0x1185a7&&_0x1185a7['__esModule'])return _0x1185a7;var _0x3d9e86={};if(_0x1185a7!=null){for(var _0x105044=_0x539d62(_0x1185a7),_0x401c87=0x0;_0x401c87<_0x105044[_0x1508c0(0x1fb)];_0x401c87++)if(_0x105044[_0x401c87]!==_0x1508c0(0x211))__createBinding(_0x3d9e86,_0x1185a7,_0x105044[_0x401c87]);}return __setModuleDefault(_0x3d9e86,_0x1185a7),_0x3d9e86;};}());Object[a21_0x300e7f(0x23c)](exports,a21_0x300e7f(0x204),{'value':!![]});const express_1=require(a21_0x300e7f(0x226)),adminController_1=require('../controllers/adminController'),validation_1=require(a21_0x300e7f(0x1f6)),auth_1=require('../middleware/auth'),loggerService_1=require('../services/loggerService'),coinToPayStatusService_1=require('../services/coinToPayStatusService'),domainMonitoringService_1=require(a21_0x300e7f(0x1e0)),router=(0x0,express_1['Router'])(),adminController=new adminController_1[(a21_0x300e7f(0x21a))]();function a21_0x40cc(_0x389d38,_0x2989be){const _0x5d4851=a21_0x5d48();return a21_0x40cc=function(_0x40cc43,_0x22dd80){_0x40cc43=_0x40cc43-0x1d0;let _0x154a31=_0x5d4851[_0x40cc43];return _0x154a31;},a21_0x40cc(_0x389d38,_0x2989be);}router[a21_0x300e7f(0x23a)](auth_1[a21_0x300e7f(0x246)],auth_1[a21_0x300e7f(0x1d3)]),router[a21_0x300e7f(0x20d)]('/auth',adminController[a21_0x300e7f(0x21b)]),router[a21_0x300e7f(0x20d)]('/statistics',adminController['getStatistics']),router[a21_0x300e7f(0x20d)](a21_0x300e7f(0x1f5),adminController[a21_0x300e7f(0x235)]),router[a21_0x300e7f(0x20d)](a21_0x300e7f(0x1dc),adminController[a21_0x300e7f(0x1d4)]),router[a21_0x300e7f(0x20d)]('/payout/merchants',adminController[a21_0x300e7f(0x20c)]),router[a21_0x300e7f(0x20d)]('/merchants/selection',adminController[a21_0x300e7f(0x1e7)]),router[a21_0x300e7f(0x232)](a21_0x300e7f(0x212),(0x0,validation_1['validate'])(validation_1['createPayoutSchema']),adminController[a21_0x300e7f(0x214)]),router[a21_0x300e7f(0x20d)](a21_0x300e7f(0x238),adminController[a21_0x300e7f(0x1ef)]),router[a21_0x300e7f(0x20d)](a21_0x300e7f(0x1f9),adminController[a21_0x300e7f(0x1d7)]),router['delete']('/payouts/:id',adminController[a21_0x300e7f(0x1e8)]),router[a21_0x300e7f(0x20d)](a21_0x300e7f(0x242),adminController[a21_0x300e7f(0x213)]),router[a21_0x300e7f(0x20d)](a21_0x300e7f(0x215),adminController['getPaymentById']),router[a21_0x300e7f(0x207)](a21_0x300e7f(0x215),adminController[a21_0x300e7f(0x201)]),router[a21_0x300e7f(0x207)]('/payments/:id/customer',(0x0,validation_1[a21_0x300e7f(0x1fe)])(validation_1[a21_0x300e7f(0x22d)]),adminController['updateCustomerData']),router[a21_0x300e7f(0x20d)]('/payments/processing-stats',adminController['getProcessingPaymentsStats']),router[a21_0x300e7f(0x232)]('/payments/cleanup',adminController[a21_0x300e7f(0x222)]),router['post'](a21_0x300e7f(0x243),adminController[a21_0x300e7f(0x236)]),router['post']('/payments/cleanup-with-report',adminController[a21_0x300e7f(0x216)]),router[a21_0x300e7f(0x20d)](a21_0x300e7f(0x1fc),adminController[a21_0x300e7f(0x205)]),router[a21_0x300e7f(0x20d)](a21_0x300e7f(0x1e1),adminController[a21_0x300e7f(0x221)]),router['post'](a21_0x300e7f(0x1fc),(0x0,validation_1[a21_0x300e7f(0x1fe)])(validation_1[a21_0x300e7f(0x217)]),adminController['createUser']),router['put'](a21_0x300e7f(0x1e1),(0x0,validation_1[a21_0x300e7f(0x1fe)])(validation_1[a21_0x300e7f(0x23e)]),adminController[a21_0x300e7f(0x1ec)]),router[a21_0x300e7f(0x23f)](a21_0x300e7f(0x1e1),adminController[a21_0x300e7f(0x21f)]),router[a21_0x300e7f(0x232)]('/users/:id/suspend',adminController[a21_0x300e7f(0x247)]),router[a21_0x300e7f(0x232)]('/users/:id/activate',adminController[a21_0x300e7f(0x1f4)]),router[a21_0x300e7f(0x20d)]('/logs/stats',(_0x33dbc4,_0x39b275)=>{const _0x5645fd=a21_0x300e7f;try{const _0x1f6870=loggerService_1[_0x5645fd(0x228)][_0x5645fd(0x1ee)]();_0x39b275['json']({'success':!![],'result':_0x1f6870});}catch(_0x378301){_0x39b275[_0x5645fd(0x1eb)](0x1f4)[_0x5645fd(0x248)]({'success':![],'message':_0x5645fd(0x23d)});}}),router[a21_0x300e7f(0x232)](a21_0x300e7f(0x1fa),(_0x38e701,_0xafd444)=>{const _0x44c2fa=a21_0x300e7f;try{const {daysToKeep:daysToKeep=0x1e}=_0x38e701['body'];loggerService_1[_0x44c2fa(0x228)]['cleanOldLogs'](daysToKeep),_0xafd444[_0x44c2fa(0x248)]({'success':!![],'message':'Old\x20logs\x20cleaned\x20(kept\x20last\x20'+daysToKeep+_0x44c2fa(0x20e)});}catch(_0x36ee8a){_0xafd444['status'](0x1f4)[_0x44c2fa(0x248)]({'success':![],'message':_0x44c2fa(0x244)});}}),router[a21_0x300e7f(0x232)](a21_0x300e7f(0x1ed),async(_0x4f7d7c,_0x4df1cf)=>{const _0xa09dfe=a21_0x300e7f;try{const {paymentId:_0x567eb7}=_0x4f7d7c[_0xa09dfe(0x227)];console[_0xa09dfe(0x1e5)](_0xa09dfe(0x245)+_0x567eb7),await coinToPayStatusService_1['coinToPayStatusService'][_0xa09dfe(0x240)](_0x567eb7),_0x4df1cf['json']({'success':!![],'message':_0xa09dfe(0x218)});}catch(_0x47e673){console['error']('‚ùå\x20[ADMIN]\x20Manual\x20CoinToPay\x20check\x20failed\x20for\x20payment\x20'+_0x4f7d7c['params'][_0xa09dfe(0x249)]+':',_0x47e673),_0x4df1cf[_0xa09dfe(0x1eb)](0x1f4)[_0xa09dfe(0x248)]({'success':![],'message':_0x47e673 instanceof Error?_0x47e673[_0xa09dfe(0x208)]:'Failed\x20to\x20check\x20CoinToPay\x20payment\x20status'});}}),router[a21_0x300e7f(0x20d)](a21_0x300e7f(0x22b),(_0x380fd7,_0x498592)=>{const _0x15f9f5=a21_0x300e7f;try{const _0x37b407=coinToPayStatusService_1[_0x15f9f5(0x20f)]['getServiceStats']();_0x498592[_0x15f9f5(0x248)]({'success':!![],'result':{..._0x37b407,'description':_0x15f9f5(0x1f0),'statusMapping':{'Paid':'PAID','Awaiting\x20Fiat':_0x15f9f5(0x210),'waiting':'PENDING','expired':_0x15f9f5(0x1ff),'failed':_0x15f9f5(0x1da)},'autoExpiryNote':_0x15f9f5(0x224)+_0x37b407[_0x15f9f5(0x1fd)]+'\x20days\x20if\x20not\x20paid','individualTimersNote':'Each\x20new\x20payment\x20gets\x20individual\x20timers:\x201min,\x202min,\x207min,\x2012min,\x20then\x20hourly'}});}catch(_0x1e8a83){_0x498592['status'](0x1f4)[_0x15f9f5(0x248)]({'success':![],'message':_0x15f9f5(0x1d5)});}}),router['get'](a21_0x300e7f(0x209),async(_0x1e0024,_0x3376bb)=>{const _0x426b05=a21_0x300e7f;try{const {paymentId:_0xfd503e}=_0x1e0024[_0x426b05(0x227)],_0x55b28d=coinToPayStatusService_1[_0x426b05(0x20f)][_0x426b05(0x206)](_0xfd503e),_0x4212e4=(await Promise[_0x426b05(0x1e3)]()[_0x426b05(0x22a)](()=>__importStar(require('../config/database'))))['default'],_0x16307e=await _0x4212e4[_0x426b05(0x239)][_0x426b05(0x22f)]({'where':{'id':_0xfd503e},'select':{'id':!![],'gateway':!![],'gatewayPaymentId':!![],'status':!![],'amount':!![],'currency':!![],'createdAt':!![],'updatedAt':!![],'shopId':!![],'shop':{'select':{'name':!![],'username':!![]}}}});if(!_0x16307e)return _0x3376bb[_0x426b05(0x1eb)](0x194)[_0x426b05(0x248)]({'success':![],'message':_0x426b05(0x241)});_0x3376bb[_0x426b05(0x248)]({'success':!![],'result':{'payment':{'id':_0x16307e['id'],'gateway':_0x16307e['gateway'],'gatewayPaymentId':_0x16307e[_0x426b05(0x20b)],'status':_0x16307e[_0x426b05(0x1eb)],'amount':_0x16307e[_0x426b05(0x1d0)],'currency':_0x16307e[_0x426b05(0x225)],'createdAt':_0x16307e[_0x426b05(0x1f3)],'updatedAt':_0x16307e[_0x426b05(0x1dd)],'shop':_0x16307e[_0x426b05(0x229)]},'timers':_0x55b28d,'isCoinToPay':_0x16307e[_0x426b05(0x22e)]===_0x426b05(0x200),'ageInMinutes':Math[_0x426b05(0x1e2)]((Date[_0x426b05(0x1de)]()-_0x16307e[_0x426b05(0x1f3)][_0x426b05(0x223)]())/(0x3e8*0x3c))}});}catch(_0x1f78dc){_0x3376bb['status'](0x1f4)[_0x426b05(0x248)]({'success':![],'message':_0x1f78dc instanceof Error?_0x1f78dc[_0x426b05(0x208)]:_0x426b05(0x1ea)});}}),router['get']('/domain-monitoring/stats',(_0x2f1cd9,_0x405814)=>{const _0x226163=a21_0x300e7f;try{const _0x232f96=domainMonitoringService_1[_0x226163(0x234)][_0x226163(0x220)]();_0x405814[_0x226163(0x248)]({'success':!![],'result':{..._0x232f96,'description':_0x226163(0x1d6),'behavior':_0x226163(0x203),'encoding':_0x226163(0x1d8)}});}catch(_0x295d7e){_0x405814[_0x226163(0x1eb)](0x1f4)[_0x226163(0x248)]({'success':![],'message':'Failed\x20to\x20get\x20domain\x20monitoring\x20statistics'});}}),router[a21_0x300e7f(0x232)]('/domain-monitoring/check',async(_0x1d939b,_0x49bf21)=>{const _0x38df81=a21_0x300e7f;try{const _0x224698=await domainMonitoringService_1['domainMonitoringService'][_0x38df81(0x1f7)]();_0x49bf21['json']({'success':!![],'result':{'domainAvailable':_0x224698,'message':_0x224698?_0x38df81(0x21e):_0x38df81(0x202),'timestamp':new Date()[_0x38df81(0x21c)]()}});}catch(_0x9dd8ee){_0x49bf21[_0x38df81(0x1eb)](0x1f4)[_0x38df81(0x248)]({'success':![],'message':_0x9dd8ee instanceof Error?_0x9dd8ee[_0x38df81(0x208)]:_0x38df81(0x1e9)});}}),exports['default']=router;