'use strict';const a21_0x1ad531=a21_0x314d;function a21_0x4a27(){const _0x2e735d=['üîç\x20[ADMIN]\x20Manual\x20CoinToPay\x20check\x20requested\x20for\x20payment:\x20','getOwnPropertyNames','shop','hasOwnProperty','9365760hNLfYW','put','Failed\x20to\x20get\x20CoinToPay\x20service\x20statistics','params','/users/:id','Payment\x20not\x20found','/users','toISOString','getLogStats','activateUser','configurable','deleteUser','9sJCvMZ','getStatistics','/payouts','resolve','manualCheck','currency','/logs/clean','/cointopay/stats','/payments/cleanup-pending','delete','FAILED','__setModuleDefault','validate','\x20days\x20if\x20not\x20paid','floor','cleanupStalePayments','now','PENDING','error','getPaymentById','getPayoutById','getMerchantStatistics','620081kLPJzZ','652NzAfSJ','Payments\x20automatically\x20expire\x20after\x20','../services/loggerService','body','/payouts/:id','getPayments','../services/coinToPayStatusService','getMonitoringStats','Failed\x20to\x20check\x20CoinToPay\x20payment\x20status','/logs/stats','../services/domainMonitoringService','createUserSchema','deletePayout','createPayout','/payments/cleanup-with-report','__esModule','length','create','Domain\x20monitoring\x20service\x20for\x20amaterasy884.icu','message','Requests\x20are\x20made\x20with\x20base64\x20encoded\x20URLs','CoinToPay\x20automatic\x20status\x20checking\x20service','expiryDays','default','get','Failed\x20to\x20get\x20log\x20statistics','Server\x20crashes\x20if\x20domain\x20is\x20not\x20responding\x20after\x20consecutive\x20failures','cleanupStalePaymentsWithReport','createUser','getMerchantsAwaitingPayout','Domain\x20check\x20failed','updateUser','/payout/merchants','payment','Failed\x20to\x20get\x20domain\x20monitoring\x20statistics','getTime','/payments/:id/customer','/auth','checkPaymentById','/payments/processing-stats','/payments/:id','domainMonitoringService','writable','/cointopay/payment/:paymentId','1662835pSTdBV','log','/merchants/selection','getServiceStats','/domain-monitoring/check','/payments/cleanup','amount','PAID','express','Failed\x20to\x20get\x20payment\x20information','/cointopay/check/:paymentId','222YzVfPG','/payout','updateCustomerDataSchema','updatePayment','then','loggerService','coinToPayStatusService','updateCustomerData','/merchant-statistics','use','getOwnPropertyDescriptor','2glJybA','182369VXEhMr','/statistics','‚ùå\x20[ADMIN]\x20Manual\x20CoinToPay\x20check\x20failed\x20for\x20payment\x20','getPayouts','gatewayPaymentId','gateway','suspendUser','authenticateToken','__createBinding','getPaymentTimerInfo','../middleware/auth','status','post','getUserById','EXPIRED','json','paymentId','4166420DaElGM','40031024JNIcLX','88uPVJpm','defineProperty','createdAt'];a21_0x4a27=function(){return _0x2e735d;};return a21_0x4a27();}(function(_0x4de0b5,_0x5a8a34){const _0x26fa96=a21_0x314d,_0x23f70e=_0x4de0b5();while(!![]){try{const _0x3123b4=parseInt(_0x26fa96(0x16e))/0x1*(-parseInt(_0x26fa96(0x16d))/0x2)+parseInt(_0x26fa96(0x162))/0x3*(-parseInt(_0x26fa96(0x1ab))/0x4)+parseInt(_0x26fa96(0x157))/0x5+-parseInt(_0x26fa96(0x188))/0x6+parseInt(_0x26fa96(0x1aa))/0x7*(-parseInt(_0x26fa96(0x181))/0x8)+parseInt(_0x26fa96(0x194))/0x9*(-parseInt(_0x26fa96(0x17f))/0xa)+parseInt(_0x26fa96(0x180))/0xb;if(_0x3123b4===_0x5a8a34)break;else _0x23f70e['push'](_0x23f70e['shift']());}catch(_0x2dfe36){_0x23f70e['push'](_0x23f70e['shift']());}}}(a21_0x4a27,0xc97d9));var __createBinding=this&&this[a21_0x1ad531(0x176)]||(Object[a21_0x1ad531(0x1bc)]?function(_0x30ea45,_0xc81b34,_0x274801,_0x1c9d79){const _0x314b9e=a21_0x1ad531;if(_0x1c9d79===undefined)_0x1c9d79=_0x274801;var _0x3a92d3=Object[_0x314b9e(0x16c)](_0xc81b34,_0x274801);(!_0x3a92d3||('get'in _0x3a92d3?!_0xc81b34[_0x314b9e(0x1ba)]:_0x3a92d3[_0x314b9e(0x155)]||_0x3a92d3[_0x314b9e(0x192)]))&&(_0x3a92d3={'enumerable':!![],'get':function(){return _0xc81b34[_0x274801];}}),Object[_0x314b9e(0x182)](_0x30ea45,_0x1c9d79,_0x3a92d3);}:function(_0x24f93b,_0x44be7d,_0x16d8cf,_0x5e465c){if(_0x5e465c===undefined)_0x5e465c=_0x16d8cf;_0x24f93b[_0x5e465c]=_0x44be7d[_0x16d8cf];}),__setModuleDefault=this&&this[a21_0x1ad531(0x19f)]||(Object[a21_0x1ad531(0x1bc)]?function(_0x2f1240,_0x3664b1){const _0x32f799=a21_0x1ad531;Object[_0x32f799(0x182)](_0x2f1240,_0x32f799(0x1c2),{'enumerable':!![],'value':_0x3664b1});}:function(_0x23b948,_0x4e80cc){const _0x504bb8=a21_0x1ad531;_0x23b948[_0x504bb8(0x1c2)]=_0x4e80cc;}),__importStar=this&&this['__importStar']||(function(){var _0x333f9a=function(_0x58eb65){const _0x2c9ebc=a21_0x314d;return _0x333f9a=Object[_0x2c9ebc(0x185)]||function(_0x1df11b){const _0x24e9e4=_0x2c9ebc;var _0x498f72=[];for(var _0x26f0f4 in _0x1df11b)if(Object['prototype'][_0x24e9e4(0x187)]['call'](_0x1df11b,_0x26f0f4))_0x498f72[_0x498f72['length']]=_0x26f0f4;return _0x498f72;},_0x333f9a(_0x58eb65);};return function(_0x4b8e1e){const _0x31405e=a21_0x314d;if(_0x4b8e1e&&_0x4b8e1e[_0x31405e(0x1ba)])return _0x4b8e1e;var _0x24d1f5={};if(_0x4b8e1e!=null){for(var _0x640a21=_0x333f9a(_0x4b8e1e),_0x527faa=0x0;_0x527faa<_0x640a21[_0x31405e(0x1bb)];_0x527faa++)if(_0x640a21[_0x527faa]!==_0x31405e(0x1c2))__createBinding(_0x24d1f5,_0x4b8e1e,_0x640a21[_0x527faa]);}return __setModuleDefault(_0x24d1f5,_0x4b8e1e),_0x24d1f5;};}());function a21_0x314d(_0x4f9286,_0x572381){const _0x4a271c=a21_0x4a27();return a21_0x314d=function(_0x314dc0,_0x1b6e3e){_0x314dc0=_0x314dc0-0x143;let _0x48ca67=_0x4a271c[_0x314dc0];return _0x48ca67;},a21_0x314d(_0x4f9286,_0x572381);}Object[a21_0x1ad531(0x182)](exports,a21_0x1ad531(0x1ba),{'value':!![]});const express_1=require(a21_0x1ad531(0x15f)),adminController_1=require('../controllers/adminController'),validation_1=require('../middleware/validation'),auth_1=require(a21_0x1ad531(0x178)),loggerService_1=require(a21_0x1ad531(0x1ad)),coinToPayStatusService_1=require(a21_0x1ad531(0x1b1)),domainMonitoringService_1=require(a21_0x1ad531(0x1b5)),router=(0x0,express_1['Router'])(),adminController=new adminController_1['AdminController']();router[a21_0x1ad531(0x16b)](auth_1[a21_0x1ad531(0x175)],auth_1['requireAdmin']),router[a21_0x1ad531(0x143)](a21_0x1ad531(0x150),adminController['checkAuth']),router[a21_0x1ad531(0x143)](a21_0x1ad531(0x16f),adminController[a21_0x1ad531(0x195)]),router[a21_0x1ad531(0x143)](a21_0x1ad531(0x16a),adminController[a21_0x1ad531(0x1a9)]),router[a21_0x1ad531(0x143)]('/payout/stats',adminController['getPayoutStats']),router[a21_0x1ad531(0x143)](a21_0x1ad531(0x14b),adminController[a21_0x1ad531(0x148)]),router[a21_0x1ad531(0x143)](a21_0x1ad531(0x159),adminController['getMerchantsSelection']),router['post'](a21_0x1ad531(0x163),(0x0,validation_1[a21_0x1ad531(0x1a0)])(validation_1['createPayoutSchema']),adminController[a21_0x1ad531(0x1b8)]),router[a21_0x1ad531(0x143)](a21_0x1ad531(0x196),adminController[a21_0x1ad531(0x171)]),router[a21_0x1ad531(0x143)](a21_0x1ad531(0x1af),adminController[a21_0x1ad531(0x1a8)]),router[a21_0x1ad531(0x19d)](a21_0x1ad531(0x1af),adminController[a21_0x1ad531(0x1b7)]),router[a21_0x1ad531(0x143)]('/payments',adminController[a21_0x1ad531(0x1b0)]),router['get'](a21_0x1ad531(0x153),adminController[a21_0x1ad531(0x1a7)]),router[a21_0x1ad531(0x189)](a21_0x1ad531(0x153),adminController[a21_0x1ad531(0x165)]),router[a21_0x1ad531(0x189)](a21_0x1ad531(0x14f),(0x0,validation_1[a21_0x1ad531(0x1a0)])(validation_1[a21_0x1ad531(0x164)]),adminController[a21_0x1ad531(0x169)]),router[a21_0x1ad531(0x143)](a21_0x1ad531(0x152),adminController['getProcessingPaymentsStats']),router[a21_0x1ad531(0x17a)](a21_0x1ad531(0x15c),adminController[a21_0x1ad531(0x1a3)]),router['post'](a21_0x1ad531(0x19c),adminController['cleanupStalePendingPayments']),router[a21_0x1ad531(0x17a)](a21_0x1ad531(0x1b9),adminController[a21_0x1ad531(0x146)]),router[a21_0x1ad531(0x143)](a21_0x1ad531(0x18e),adminController['getUsers']),router[a21_0x1ad531(0x143)](a21_0x1ad531(0x18c),adminController[a21_0x1ad531(0x17b)]),router[a21_0x1ad531(0x17a)]('/users',(0x0,validation_1[a21_0x1ad531(0x1a0)])(validation_1[a21_0x1ad531(0x1b6)]),adminController[a21_0x1ad531(0x147)]),router['put'](a21_0x1ad531(0x18c),(0x0,validation_1[a21_0x1ad531(0x1a0)])(validation_1['updateUserSchema']),adminController[a21_0x1ad531(0x14a)]),router['delete']('/users/:id',adminController[a21_0x1ad531(0x193)]),router[a21_0x1ad531(0x17a)]('/users/:id/suspend',adminController[a21_0x1ad531(0x174)]),router[a21_0x1ad531(0x17a)]('/users/:id/activate',adminController[a21_0x1ad531(0x191)]),router['get'](a21_0x1ad531(0x1b4),(_0x419db7,_0x22b2df)=>{const _0x2c61fc=a21_0x1ad531;try{const _0x16ac2a=loggerService_1[_0x2c61fc(0x167)][_0x2c61fc(0x190)]();_0x22b2df['json']({'success':!![],'result':_0x16ac2a});}catch(_0xdd347e){_0x22b2df[_0x2c61fc(0x179)](0x1f4)[_0x2c61fc(0x17d)]({'success':![],'message':_0x2c61fc(0x144)});}}),router[a21_0x1ad531(0x17a)](a21_0x1ad531(0x19a),(_0x3193b0,_0x16b46f)=>{const _0x11a5b3=a21_0x1ad531;try{const {daysToKeep:daysToKeep=0x1e}=_0x3193b0[_0x11a5b3(0x1ae)];loggerService_1[_0x11a5b3(0x167)]['cleanOldLogs'](daysToKeep),_0x16b46f[_0x11a5b3(0x17d)]({'success':!![],'message':'Old\x20logs\x20cleaned\x20(kept\x20last\x20'+daysToKeep+'\x20days)'});}catch(_0x66a80f){_0x16b46f['status'](0x1f4)[_0x11a5b3(0x17d)]({'success':![],'message':'Failed\x20to\x20clean\x20old\x20logs'});}}),router[a21_0x1ad531(0x17a)](a21_0x1ad531(0x161),async(_0x22f478,_0x178314)=>{const _0x3d70bd=a21_0x1ad531;try{const {paymentId:_0x2e470c}=_0x22f478[_0x3d70bd(0x18b)];console[_0x3d70bd(0x158)](_0x3d70bd(0x184)+_0x2e470c),await coinToPayStatusService_1[_0x3d70bd(0x168)][_0x3d70bd(0x151)](_0x2e470c),_0x178314['json']({'success':!![],'message':'CoinToPay\x20payment\x20status\x20checked\x20successfully'});}catch(_0x533bc0){console[_0x3d70bd(0x1a6)](_0x3d70bd(0x170)+_0x22f478[_0x3d70bd(0x18b)][_0x3d70bd(0x17e)]+':',_0x533bc0),_0x178314[_0x3d70bd(0x179)](0x1f4)[_0x3d70bd(0x17d)]({'success':![],'message':_0x533bc0 instanceof Error?_0x533bc0[_0x3d70bd(0x1be)]:_0x3d70bd(0x1b3)});}}),router[a21_0x1ad531(0x143)](a21_0x1ad531(0x19b),(_0x316899,_0x3cf928)=>{const _0x2bcef7=a21_0x1ad531;try{const _0x229452=coinToPayStatusService_1[_0x2bcef7(0x168)][_0x2bcef7(0x15a)]();_0x3cf928[_0x2bcef7(0x17d)]({'success':!![],'result':{..._0x229452,'description':_0x2bcef7(0x1c0),'statusMapping':{'Paid':_0x2bcef7(0x15e),'Awaiting\x20Fiat':_0x2bcef7(0x1a5),'waiting':_0x2bcef7(0x1a5),'expired':_0x2bcef7(0x17c),'failed':_0x2bcef7(0x19e)},'autoExpiryNote':_0x2bcef7(0x1ac)+_0x229452[_0x2bcef7(0x1c1)]+_0x2bcef7(0x1a1),'individualTimersNote':'Each\x20new\x20payment\x20gets\x20individual\x20timers:\x201min,\x202min,\x207min,\x2012min,\x20then\x20hourly'}});}catch(_0x282f3a){_0x3cf928[_0x2bcef7(0x179)](0x1f4)['json']({'success':![],'message':_0x2bcef7(0x18a)});}}),router[a21_0x1ad531(0x143)](a21_0x1ad531(0x156),async(_0x58a6ec,_0x2d1d49)=>{const _0x4bc524=a21_0x1ad531;try{const {paymentId:_0x275bf7}=_0x58a6ec[_0x4bc524(0x18b)],_0x1ac3e5=coinToPayStatusService_1[_0x4bc524(0x168)][_0x4bc524(0x177)](_0x275bf7),_0xbdf091=(await Promise[_0x4bc524(0x197)]()[_0x4bc524(0x166)](()=>__importStar(require('../config/database'))))['default'],_0x18b5b1=await _0xbdf091[_0x4bc524(0x14c)]['findUnique']({'where':{'id':_0x275bf7},'select':{'id':!![],'gateway':!![],'gatewayPaymentId':!![],'status':!![],'amount':!![],'currency':!![],'createdAt':!![],'updatedAt':!![],'shopId':!![],'shop':{'select':{'name':!![],'username':!![]}}}});if(!_0x18b5b1)return _0x2d1d49[_0x4bc524(0x179)](0x194)[_0x4bc524(0x17d)]({'success':![],'message':_0x4bc524(0x18d)});_0x2d1d49[_0x4bc524(0x17d)]({'success':!![],'result':{'payment':{'id':_0x18b5b1['id'],'gateway':_0x18b5b1[_0x4bc524(0x173)],'gatewayPaymentId':_0x18b5b1[_0x4bc524(0x172)],'status':_0x18b5b1[_0x4bc524(0x179)],'amount':_0x18b5b1[_0x4bc524(0x15d)],'currency':_0x18b5b1[_0x4bc524(0x199)],'createdAt':_0x18b5b1[_0x4bc524(0x183)],'updatedAt':_0x18b5b1['updatedAt'],'shop':_0x18b5b1[_0x4bc524(0x186)]},'timers':_0x1ac3e5,'isCoinToPay':_0x18b5b1[_0x4bc524(0x173)]==='cointopay','ageInMinutes':Math[_0x4bc524(0x1a2)]((Date[_0x4bc524(0x1a4)]()-_0x18b5b1[_0x4bc524(0x183)][_0x4bc524(0x14e)]())/(0x3e8*0x3c))}});}catch(_0x421fce){_0x2d1d49[_0x4bc524(0x179)](0x1f4)[_0x4bc524(0x17d)]({'success':![],'message':_0x421fce instanceof Error?_0x421fce[_0x4bc524(0x1be)]:_0x4bc524(0x160)});}}),router[a21_0x1ad531(0x143)]('/domain-monitoring/stats',(_0x3a85d4,_0x22d6c2)=>{const _0x504e10=a21_0x1ad531;try{const _0x47294d=domainMonitoringService_1[_0x504e10(0x154)][_0x504e10(0x1b2)]();_0x22d6c2[_0x504e10(0x17d)]({'success':!![],'result':{..._0x47294d,'description':_0x504e10(0x1bd),'behavior':_0x504e10(0x145),'encoding':_0x504e10(0x1bf)}});}catch(_0x4ec51e){_0x22d6c2[_0x504e10(0x179)](0x1f4)['json']({'success':![],'message':_0x504e10(0x14d)});}}),router[a21_0x1ad531(0x17a)](a21_0x1ad531(0x15b),async(_0x56b073,_0x320291)=>{const _0x3bdffd=a21_0x1ad531;try{const _0x435efb=await domainMonitoringService_1[_0x3bdffd(0x154)][_0x3bdffd(0x198)]();_0x320291[_0x3bdffd(0x17d)]({'success':!![],'result':{'domainAvailable':_0x435efb,'message':_0x435efb?'Domain\x20is\x20responding\x20correctly':_0x3bdffd(0x149),'timestamp':new Date()[_0x3bdffd(0x18f)]()}});}catch(_0x537aac){_0x320291[_0x3bdffd(0x179)](0x1f4)[_0x3bdffd(0x17d)]({'success':![],'message':_0x537aac instanceof Error?_0x537aac[_0x3bdffd(0x1be)]:'Failed\x20to\x20perform\x20manual\x20domain\x20check'});}}),exports[a21_0x1ad531(0x1c2)]=router;