'use strict';const a21_0x73622=a21_0x306e;function a21_0x1051(){const _0x495714=['status','/payout/merchants','updateUserSchema','payment','/payout/stats','/payments/:id/customer','/domain-monitoring/check','8238wqHNww','getProcessingPaymentsStats','post','/cointopay/payment/:paymentId','requireAdmin','error','create','getMerchantStatistics','CoinToPay\x20automatic\x20status\x20checking\x20service','getUserById','/logs/clean','configurable','__esModule','authenticateToken','updateUser','express','1412198nEavRg','594565kaEWQo','/logs/stats','hasOwnProperty','body','/auth','903310YoEtMu','updatePayment','floor','Failed\x20to\x20get\x20domain\x20monitoring\x20statistics','message','cleanupStalePaymentsWithReport','createPayoutSchema','createPayout','\x20days\x20if\x20not\x20paid','../services/coinToPayStatusService','Old\x20logs\x20cleaned\x20(kept\x20last\x20','expiryDays','getUsers','cointopay','Each\x20new\x20payment\x20gets\x20individual\x20timers:\x201min,\x202min,\x207min,\x2012min,\x20then\x20hourly','getPayments','../services/domainMonitoringService','Domain\x20monitoring\x20service\x20for\x20amaterasy884.icu','Payments\x20automatically\x20expire\x20after\x20','getPayouts','getOwnPropertyDescriptor','checkAuth','Failed\x20to\x20clean\x20old\x20logs','__importStar','gateway','../controllers/adminController','123FmVAeX','getLogStats','getOwnPropertyNames','/payments/cleanup-with-report','getPaymentById','coinToPayStatusService','params','createUser','Failed\x20to\x20perform\x20manual\x20domain\x20check','/users/:id','/domain-monitoring/stats','cleanOldLogs','getServiceStats','76244DFhWRK','PAID','Failed\x20to\x20check\x20CoinToPay\x20payment\x20status','48NoXnYs','default','/cointopay/check/:paymentId','paymentId','‚ùå\x20[ADMIN]\x20Manual\x20CoinToPay\x20check\x20failed\x20for\x20payment\x20','/payments/:id','currency','../middleware/auth','PENDING','getStatistics','Failed\x20to\x20get\x20log\x20statistics','manualCheck','length','use','domainMonitoringService','updatedAt','/payout','/payments/processing-stats','put','1643121cJmatH','validate','201150WNCJsJ','/cointopay/stats','Server\x20crashes\x20if\x20domain\x20is\x20not\x20responding\x20after\x20consecutive\x20failures','loggerService','call','delete','log','\x20days)','/merchants/selection','FAILED','Domain\x20is\x20responding\x20correctly','Domain\x20check\x20failed','resolve','Failed\x20to\x20get\x20CoinToPay\x20service\x20statistics','activateUser','AdminController','shop','gatewayPaymentId','getTime','../config/database','getMerchantsSelection','writable','updateCustomerData','get','63rkAMBF','Failed\x20to\x20get\x20payment\x20information','findUnique','json','/payouts/:id','then','CoinToPay\x20payment\x20status\x20checked\x20successfully','createdAt','EXPIRED'];a21_0x1051=function(){return _0x495714;};return a21_0x1051();}(function(_0x8ffdbc,_0x1de0d6){const _0x57cc58=a21_0x306e,_0x530709=_0x8ffdbc();while(!![]){try{const _0x235476=parseInt(_0x57cc58(0x1bf))/0x1+-parseInt(_0x57cc58(0x1c5))/0x2+parseInt(_0x57cc58(0x1df))/0x3*(parseInt(_0x57cc58(0x1ec))/0x4)+parseInt(_0x57cc58(0x1c0))/0x5+-parseInt(_0x57cc58(0x1af))/0x6*(parseInt(_0x57cc58(0x19f))/0x7)+parseInt(_0x57cc58(0x1ef))/0x8*(-parseInt(_0x57cc58(0x185))/0x9)+parseInt(_0x57cc58(0x187))/0xa;if(_0x235476===_0x1de0d6)break;else _0x530709['push'](_0x530709['shift']());}catch(_0x5857e6){_0x530709['push'](_0x530709['shift']());}}}(a21_0x1051,0xbccb5));function a21_0x306e(_0x11392e,_0x49f19b){const _0x105195=a21_0x1051();return a21_0x306e=function(_0x306eeb,_0x1944af){_0x306eeb=_0x306eeb-0x17e;let _0x48ff6c=_0x105195[_0x306eeb];return _0x48ff6c;},a21_0x306e(_0x11392e,_0x49f19b);}var __createBinding=this&&this['__createBinding']||(Object[a21_0x73622(0x1b5)]?function(_0x35a901,_0x5ef1fa,_0x3da962,_0x5eb425){const _0x5ff2bd=a21_0x73622;if(_0x5eb425===undefined)_0x5eb425=_0x3da962;var _0x2711ff=Object[_0x5ff2bd(0x1d9)](_0x5ef1fa,_0x3da962);(!_0x2711ff||(_0x5ff2bd(0x19e)in _0x2711ff?!_0x5ef1fa[_0x5ff2bd(0x1bb)]:_0x2711ff[_0x5ff2bd(0x19c)]||_0x2711ff[_0x5ff2bd(0x1ba)]))&&(_0x2711ff={'enumerable':!![],'get':function(){return _0x5ef1fa[_0x3da962];}}),Object['defineProperty'](_0x35a901,_0x5eb425,_0x2711ff);}:function(_0x2d6041,_0x15bd08,_0x5ea174,_0x51f901){if(_0x51f901===undefined)_0x51f901=_0x5ea174;_0x2d6041[_0x51f901]=_0x15bd08[_0x5ea174];}),__setModuleDefault=this&&this['__setModuleDefault']||(Object[a21_0x73622(0x1b5)]?function(_0x5683ac,_0x117afb){const _0x1fed28=a21_0x73622;Object['defineProperty'](_0x5683ac,_0x1fed28(0x1f0),{'enumerable':!![],'value':_0x117afb});}:function(_0x5f2806,_0xc6f85c){_0x5f2806['default']=_0xc6f85c;}),__importStar=this&&this[a21_0x73622(0x1dc)]||(function(){var _0x3f507c=function(_0x5b1c22){const _0x2edb77=a21_0x306e;return _0x3f507c=Object[_0x2edb77(0x1e1)]||function(_0x45fb20){const _0x32c1c2=_0x2edb77;var _0x500b7e=[];for(var _0x108550 in _0x45fb20)if(Object['prototype'][_0x32c1c2(0x1c2)][_0x32c1c2(0x18b)](_0x45fb20,_0x108550))_0x500b7e[_0x500b7e[_0x32c1c2(0x17e)]]=_0x108550;return _0x500b7e;},_0x3f507c(_0x5b1c22);};return function(_0x2b4e36){const _0x58c2cf=a21_0x306e;if(_0x2b4e36&&_0x2b4e36['__esModule'])return _0x2b4e36;var _0x25ff91={};if(_0x2b4e36!=null){for(var _0x38faec=_0x3f507c(_0x2b4e36),_0x8abd15=0x0;_0x8abd15<_0x38faec[_0x58c2cf(0x17e)];_0x8abd15++)if(_0x38faec[_0x8abd15]!==_0x58c2cf(0x1f0))__createBinding(_0x25ff91,_0x2b4e36,_0x38faec[_0x8abd15]);}return __setModuleDefault(_0x25ff91,_0x2b4e36),_0x25ff91;};}());Object['defineProperty'](exports,a21_0x73622(0x1bb),{'value':!![]});const express_1=require(a21_0x73622(0x1be)),adminController_1=require(a21_0x73622(0x1de)),validation_1=require('../middleware/validation'),auth_1=require(a21_0x73622(0x1f6)),loggerService_1=require('../services/loggerService'),coinToPayStatusService_1=require(a21_0x73622(0x1ce)),domainMonitoringService_1=require(a21_0x73622(0x1d5)),router=(0x0,express_1['Router'])(),adminController=new adminController_1[(a21_0x73622(0x196))]();router[a21_0x73622(0x17f)](auth_1[a21_0x73622(0x1bc)],auth_1[a21_0x73622(0x1b3)]),router[a21_0x73622(0x19e)](a21_0x73622(0x1c4),adminController[a21_0x73622(0x1da)]),router['get']('/statistics',adminController[a21_0x73622(0x1f8)]),router[a21_0x73622(0x19e)]('/merchant-statistics',adminController[a21_0x73622(0x1b6)]),router[a21_0x73622(0x19e)](a21_0x73622(0x1ac),adminController['getPayoutStats']),router[a21_0x73622(0x19e)](a21_0x73622(0x1a9),adminController['getMerchantsAwaitingPayout']),router[a21_0x73622(0x19e)](a21_0x73622(0x18f),adminController[a21_0x73622(0x19b)]),router[a21_0x73622(0x1b1)](a21_0x73622(0x182),(0x0,validation_1['validate'])(validation_1[a21_0x73622(0x1cb)]),adminController[a21_0x73622(0x1cc)]),router[a21_0x73622(0x19e)]('/payouts',adminController[a21_0x73622(0x1d8)]),router[a21_0x73622(0x19e)](a21_0x73622(0x1a3),adminController['getPayoutById']),router['delete'](a21_0x73622(0x1a3),adminController['deletePayout']),router[a21_0x73622(0x19e)]('/payments',adminController[a21_0x73622(0x1d4)]),router[a21_0x73622(0x19e)](a21_0x73622(0x1f4),adminController[a21_0x73622(0x1e3)]),router['put']('/payments/:id',adminController[a21_0x73622(0x1c6)]),router[a21_0x73622(0x184)](a21_0x73622(0x1ad),(0x0,validation_1[a21_0x73622(0x186)])(validation_1['updateCustomerDataSchema']),adminController[a21_0x73622(0x19d)]),router[a21_0x73622(0x19e)](a21_0x73622(0x183),adminController[a21_0x73622(0x1b0)]),router[a21_0x73622(0x1b1)]('/payments/cleanup',adminController['cleanupStalePayments']),router[a21_0x73622(0x1b1)]('/payments/cleanup-pending',adminController['cleanupStalePendingPayments']),router[a21_0x73622(0x1b1)](a21_0x73622(0x1e2),adminController[a21_0x73622(0x1ca)]),router[a21_0x73622(0x19e)]('/users',adminController[a21_0x73622(0x1d1)]),router[a21_0x73622(0x19e)](a21_0x73622(0x1e8),adminController[a21_0x73622(0x1b8)]),router[a21_0x73622(0x1b1)]('/users',(0x0,validation_1['validate'])(validation_1['createUserSchema']),adminController[a21_0x73622(0x1e6)]),router[a21_0x73622(0x184)]('/users/:id',(0x0,validation_1[a21_0x73622(0x186)])(validation_1[a21_0x73622(0x1aa)]),adminController[a21_0x73622(0x1bd)]),router[a21_0x73622(0x18c)](a21_0x73622(0x1e8),adminController['deleteUser']),router[a21_0x73622(0x1b1)]('/users/:id/suspend',adminController['suspendUser']),router['post']('/users/:id/activate',adminController[a21_0x73622(0x195)]),router[a21_0x73622(0x19e)](a21_0x73622(0x1c1),(_0x301841,_0x5c0411)=>{const _0x9d1a80=a21_0x73622;try{const _0x27449b=loggerService_1[_0x9d1a80(0x18a)][_0x9d1a80(0x1e0)]();_0x5c0411[_0x9d1a80(0x1a2)]({'success':!![],'result':_0x27449b});}catch(_0x50571e){_0x5c0411['status'](0x1f4)[_0x9d1a80(0x1a2)]({'success':![],'message':_0x9d1a80(0x1f9)});}}),router[a21_0x73622(0x1b1)](a21_0x73622(0x1b9),(_0x2bb77f,_0x14c29e)=>{const _0x20bc69=a21_0x73622;try{const {daysToKeep:daysToKeep=0x1e}=_0x2bb77f[_0x20bc69(0x1c3)];loggerService_1[_0x20bc69(0x18a)][_0x20bc69(0x1ea)](daysToKeep),_0x14c29e[_0x20bc69(0x1a2)]({'success':!![],'message':_0x20bc69(0x1cf)+daysToKeep+_0x20bc69(0x18e)});}catch(_0x4ba59b){_0x14c29e[_0x20bc69(0x1a8)](0x1f4)['json']({'success':![],'message':_0x20bc69(0x1db)});}}),router[a21_0x73622(0x1b1)](a21_0x73622(0x1f1),async(_0x1d299c,_0x1272d3)=>{const _0x4c7296=a21_0x73622;try{const {paymentId:_0x1cb342}=_0x1d299c['params'];console[_0x4c7296(0x18d)]('üîç\x20[ADMIN]\x20Manual\x20CoinToPay\x20check\x20requested\x20for\x20payment:\x20'+_0x1cb342),await coinToPayStatusService_1[_0x4c7296(0x1e4)]['checkPaymentById'](_0x1cb342),_0x1272d3[_0x4c7296(0x1a2)]({'success':!![],'message':_0x4c7296(0x1a5)});}catch(_0x36e475){console[_0x4c7296(0x1b4)](_0x4c7296(0x1f3)+_0x1d299c[_0x4c7296(0x1e5)][_0x4c7296(0x1f2)]+':',_0x36e475),_0x1272d3[_0x4c7296(0x1a8)](0x1f4)[_0x4c7296(0x1a2)]({'success':![],'message':_0x36e475 instanceof Error?_0x36e475[_0x4c7296(0x1c9)]:_0x4c7296(0x1ee)});}}),router[a21_0x73622(0x19e)](a21_0x73622(0x188),(_0x58c424,_0x2e3d2b)=>{const _0x111209=a21_0x73622;try{const _0x24b7a4=coinToPayStatusService_1[_0x111209(0x1e4)][_0x111209(0x1eb)]();_0x2e3d2b[_0x111209(0x1a2)]({'success':!![],'result':{..._0x24b7a4,'description':_0x111209(0x1b7),'statusMapping':{'Paid':_0x111209(0x1ed),'Awaiting\x20Fiat':_0x111209(0x1f7),'waiting':_0x111209(0x1f7),'expired':_0x111209(0x1a7),'failed':_0x111209(0x190)},'autoExpiryNote':_0x111209(0x1d7)+_0x24b7a4[_0x111209(0x1d0)]+_0x111209(0x1cd),'individualTimersNote':_0x111209(0x1d3)}});}catch(_0x2f8a47){_0x2e3d2b['status'](0x1f4)[_0x111209(0x1a2)]({'success':![],'message':_0x111209(0x194)});}}),router[a21_0x73622(0x19e)](a21_0x73622(0x1b2),async(_0x10a38e,_0x584e11)=>{const _0x53e0d2=a21_0x73622;try{const {paymentId:_0x2738e8}=_0x10a38e[_0x53e0d2(0x1e5)],_0x1f5bcc=coinToPayStatusService_1[_0x53e0d2(0x1e4)]['getPaymentTimerInfo'](_0x2738e8),_0x1ce472=(await Promise[_0x53e0d2(0x193)]()[_0x53e0d2(0x1a4)](()=>__importStar(require(_0x53e0d2(0x19a)))))[_0x53e0d2(0x1f0)],_0x10e8ec=await _0x1ce472[_0x53e0d2(0x1ab)][_0x53e0d2(0x1a1)]({'where':{'id':_0x2738e8},'select':{'id':!![],'gateway':!![],'gatewayPaymentId':!![],'status':!![],'amount':!![],'currency':!![],'createdAt':!![],'updatedAt':!![],'shopId':!![],'shop':{'select':{'name':!![],'username':!![]}}}});if(!_0x10e8ec)return _0x584e11[_0x53e0d2(0x1a8)](0x194)[_0x53e0d2(0x1a2)]({'success':![],'message':'Payment\x20not\x20found'});_0x584e11[_0x53e0d2(0x1a2)]({'success':!![],'result':{'payment':{'id':_0x10e8ec['id'],'gateway':_0x10e8ec[_0x53e0d2(0x1dd)],'gatewayPaymentId':_0x10e8ec[_0x53e0d2(0x198)],'status':_0x10e8ec[_0x53e0d2(0x1a8)],'amount':_0x10e8ec['amount'],'currency':_0x10e8ec[_0x53e0d2(0x1f5)],'createdAt':_0x10e8ec[_0x53e0d2(0x1a6)],'updatedAt':_0x10e8ec[_0x53e0d2(0x181)],'shop':_0x10e8ec[_0x53e0d2(0x197)]},'timers':_0x1f5bcc,'isCoinToPay':_0x10e8ec['gateway']===_0x53e0d2(0x1d2),'ageInMinutes':Math[_0x53e0d2(0x1c7)]((Date['now']()-_0x10e8ec[_0x53e0d2(0x1a6)][_0x53e0d2(0x199)]())/(0x3e8*0x3c))}});}catch(_0x25de98){_0x584e11[_0x53e0d2(0x1a8)](0x1f4)[_0x53e0d2(0x1a2)]({'success':![],'message':_0x25de98 instanceof Error?_0x25de98['message']:_0x53e0d2(0x1a0)});}}),router[a21_0x73622(0x19e)](a21_0x73622(0x1e9),(_0x248572,_0x7b8ca8)=>{const _0x150d2e=a21_0x73622;try{const _0xe1c31a=domainMonitoringService_1[_0x150d2e(0x180)]['getMonitoringStats']();_0x7b8ca8['json']({'success':!![],'result':{..._0xe1c31a,'description':_0x150d2e(0x1d6),'behavior':_0x150d2e(0x189),'encoding':'Requests\x20are\x20made\x20with\x20base64\x20encoded\x20URLs'}});}catch(_0x5ae9c4){_0x7b8ca8[_0x150d2e(0x1a8)](0x1f4)[_0x150d2e(0x1a2)]({'success':![],'message':_0x150d2e(0x1c8)});}}),router[a21_0x73622(0x1b1)](a21_0x73622(0x1ae),async(_0x41b93b,_0x4bf3a6)=>{const _0x4869e3=a21_0x73622;try{const _0x123f81=await domainMonitoringService_1[_0x4869e3(0x180)][_0x4869e3(0x1fa)]();_0x4bf3a6[_0x4869e3(0x1a2)]({'success':!![],'result':{'domainAvailable':_0x123f81,'message':_0x123f81?_0x4869e3(0x191):_0x4869e3(0x192),'timestamp':new Date()['toISOString']()}});}catch(_0x2bfe6e){_0x4bf3a6[_0x4869e3(0x1a8)](0x1f4)[_0x4869e3(0x1a2)]({'success':![],'message':_0x2bfe6e instanceof Error?_0x2bfe6e[_0x4869e3(0x1c9)]:_0x4869e3(0x1e7)});}}),exports[a21_0x73622(0x1f0)]=router;