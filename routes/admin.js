'use strict';const a27_0x4194c2=a27_0x44da;function a27_0x44da(_0x55d8b8,_0x329395){_0x55d8b8=_0x55d8b8-0xcf;const _0x40a810=a27_0x40a8();let _0x44da89=_0x40a810[_0x55d8b8];return _0x44da89;}(function(_0x352b11,_0x15c9b4){const _0x223b2e=a27_0x44da,_0x4badab=_0x352b11();while(!![]){try{const _0xd8fe55=parseInt(_0x223b2e(0x150))/0x1*(-parseInt(_0x223b2e(0x15a))/0x2)+-parseInt(_0x223b2e(0x10d))/0x3+-parseInt(_0x223b2e(0x167))/0x4*(-parseInt(_0x223b2e(0x107))/0x5)+parseInt(_0x223b2e(0x155))/0x6+-parseInt(_0x223b2e(0x138))/0x7+parseInt(_0x223b2e(0x109))/0x8*(parseInt(_0x223b2e(0x15d))/0x9)+parseInt(_0x223b2e(0x124))/0xa*(parseInt(_0x223b2e(0x14d))/0xb);if(_0xd8fe55===_0x15c9b4)break;else _0x4badab['push'](_0x4badab['shift']());}catch(_0x92a3bd){_0x4badab['push'](_0x4badab['shift']());}}}(a27_0x40a8,0x810f6));var __createBinding=this&&this[a27_0x4194c2(0x14a)]||(Object[a27_0x4194c2(0x129)]?function(_0x3bd698,_0x2bdd9f,_0x1e0d62,_0x508064){const _0xf636be=a27_0x4194c2;if(_0x508064===undefined)_0x508064=_0x1e0d62;var _0x5c1d8e=Object[_0xf636be(0x131)](_0x2bdd9f,_0x1e0d62);(!_0x5c1d8e||(_0xf636be(0x143)in _0x5c1d8e?!_0x2bdd9f[_0xf636be(0x11b)]:_0x5c1d8e['writable']||_0x5c1d8e['configurable']))&&(_0x5c1d8e={'enumerable':!![],'get':function(){return _0x2bdd9f[_0x1e0d62];}}),Object[_0xf636be(0xda)](_0x3bd698,_0x508064,_0x5c1d8e);}:function(_0x362883,_0x181d0b,_0x233bce,_0x1b22e0){if(_0x1b22e0===undefined)_0x1b22e0=_0x233bce;_0x362883[_0x1b22e0]=_0x181d0b[_0x233bce];}),__setModuleDefault=this&&this[a27_0x4194c2(0x166)]||(Object[a27_0x4194c2(0x129)]?function(_0x38d821,_0x5f2242){const _0xf03e77=a27_0x4194c2;Object[_0xf03e77(0xda)](_0x38d821,_0xf03e77(0xe7),{'enumerable':!![],'value':_0x5f2242});}:function(_0x19d099,_0x30f096){const _0x189f9e=a27_0x4194c2;_0x19d099[_0x189f9e(0xe7)]=_0x30f096;}),__importStar=this&&this[a27_0x4194c2(0xd7)]||(function(){var _0x23a5ed=function(_0x2b432f){const _0x469490=a27_0x44da;return _0x23a5ed=Object[_0x469490(0xf8)]||function(_0x316e3e){const _0x95fcbf=_0x469490;var _0x500a83=[];for(var _0x221abf in _0x316e3e)if(Object[_0x95fcbf(0x126)][_0x95fcbf(0x14b)][_0x95fcbf(0xdb)](_0x316e3e,_0x221abf))_0x500a83[_0x500a83[_0x95fcbf(0xe3)]]=_0x221abf;return _0x500a83;},_0x23a5ed(_0x2b432f);};return function(_0x316544){const _0x3c4fae=a27_0x44da;if(_0x316544&&_0x316544['__esModule'])return _0x316544;var _0x1b4c36={};if(_0x316544!=null){for(var _0x424389=_0x23a5ed(_0x316544),_0x2c9e12=0x0;_0x2c9e12<_0x424389[_0x3c4fae(0xe3)];_0x2c9e12++)if(_0x424389[_0x2c9e12]!==_0x3c4fae(0xe7))__createBinding(_0x1b4c36,_0x316544,_0x424389[_0x2c9e12]);}return __setModuleDefault(_0x1b4c36,_0x316544),_0x1b4c36;};}());Object[a27_0x4194c2(0xda)](exports,a27_0x4194c2(0x11b),{'value':!![]});function a27_0x40a8(){const _0x2a5978=['checkPaymentById','/shops/:shopId/wallets','error','default','getMerchantsAwaitingPayout','body','expirePaymentLinks','log','/shops/:shopId/2fa/disable','Domain\x20monitoring\x20service\x20for\x20amaterasy884.icu','createPayoutSchema','patch','activateUser','../controllers/adminController','createUserSchema','cleanupStalePendingPayments','status','delete','disable2FA','getPayoutById','getOwnPropertyNames','deleteUser','/statistics','/payouts/reports','Requests\x20are\x20made\x20with\x20base64\x20encoded\x20URLs','../services/loggerService','/shops/:shopId/2fa/enable','paymentId','post','Server\x20crashes\x20if\x20domain\x20is\x20not\x20responding\x20after\x20consecutive\x20failures','get2FASettings','put','cleanupStalePayments','CoinToPay\x20automatic\x20status\x20checking\x20service','validate','922245TXvbHz','\x20days)','69952unyTEu','../services/domainMonitoringService','\x20days\x20if\x20not\x20paid','amount','3052119gIZxRn','/payouts/:id','../services/coinToPayStatusService','/payout/:id','disableAdmin2FA','changePasswordSchema','coinToPayStatusService','AdminController','âŒ\x20[ADMIN]\x20Manual\x20CoinToPay\x20check\x20failed\x20for\x20payment\x20','createdAt','updatePayment','getShopWallets','/payout/stats','express','__esModule','getPaymentById','authenticateToken','FAILED','shop','gatewayPaymentId','deletePayout','Failed\x20to\x20get\x20payment\x20information','/payments','70mCfEbq','toISOString','prototype','getPayoutReports','setup2FA','create','enableAdmin2FA','expiryDays','payment','/users/:id','/users/:id/suspend','json','/shops/:shopId/2fa/setup','getOwnPropertyDescriptor','gateway','enable2FA','updatePayoutSchema','getPayoutStats','resolve','changeAdminPassword','3034269QVulDQ','findUnique','Router','/payout/merchants','requireAdmin','getPayments','../middleware/validation','getPaymentTimerInfo','getGatewayStatistics','/password','getLoginLogs','get','/gateway-statistics/:gatewayId','PAID','suspendUser','ðŸ”\x20[ADMIN]\x20Manual\x20CoinToPay\x20check\x20requested\x20for\x20payment:\x20','/logs/clean','depositBalance','__createBinding','hasOwnProperty','/payments/cleanup-pending','3150785lHXfcn','params','/merchants/selection','253085upqSYd','/2fa/settings','/payments/cleanup-with-report','Domain\x20is\x20responding\x20correctly','cleanupStalePaymentsWithReport','1354218vtoqiZ','getUserById','../middleware/auth','/cointopay/stats','Payment\x20not\x20found','6IqdOhy','getGatewaySettings','updateCustomerData','333FevhJs','loggerService','/cointopay/check/:paymentId','manualCheck','/users','PENDING','getUsers','/2fa/setup','updatedAt','__setModuleDefault','4OAVMtr','use','/auth','/2fa/disable','updateUser','Failed\x20to\x20clean\x20old\x20logs','/gateway-settings','message','Failed\x20to\x20get\x20domain\x20monitoring\x20statistics','__importStar','/domain-monitoring/stats','getMerchantsSelection','defineProperty','call','cointopay','setupAdmin2FA','updatePayout','/merchant-statistics','Failed\x20to\x20get\x20log\x20statistics','/payment-links/expire','/payouts','length'];a27_0x40a8=function(){return _0x2a5978;};return a27_0x40a8();}const express_1=require(a27_0x4194c2(0x11a)),adminController_1=require(a27_0x4194c2(0xf1)),validation_1=require(a27_0x4194c2(0x13e)),auth_1=require(a27_0x4194c2(0x157)),loggerService_1=require(a27_0x4194c2(0xfd)),coinToPayStatusService_1=require(a27_0x4194c2(0x10f)),domainMonitoringService_1=require(a27_0x4194c2(0x10a)),router=(0x0,express_1[a27_0x4194c2(0x13a)])(),adminController=new adminController_1[(a27_0x4194c2(0x114))]();router[a27_0x4194c2(0xcf)](auth_1[a27_0x4194c2(0x11d)],auth_1[a27_0x4194c2(0x13c)]),router['get'](a27_0x4194c2(0xd0),adminController['checkAuth']),router['get'](a27_0x4194c2(0xfa),adminController['getStatistics']),router[a27_0x4194c2(0x143)](a27_0x4194c2(0xdf),adminController['getMerchantStatistics']),router[a27_0x4194c2(0x143)](a27_0x4194c2(0x119),adminController[a27_0x4194c2(0x135)]),router['get'](a27_0x4194c2(0x13b),adminController[a27_0x4194c2(0xe8)]),router[a27_0x4194c2(0x143)](a27_0x4194c2(0xfb),adminController[a27_0x4194c2(0x127)]),router[a27_0x4194c2(0x143)](a27_0x4194c2(0x14f),adminController[a27_0x4194c2(0xd9)]),router[a27_0x4194c2(0x100)]('/payout',(0x0,validation_1[a27_0x4194c2(0x106)])(validation_1[a27_0x4194c2(0xee)]),adminController['createPayout']),router[a27_0x4194c2(0x103)](a27_0x4194c2(0x110),(0x0,validation_1[a27_0x4194c2(0x106)])(validation_1[a27_0x4194c2(0x134)]),adminController[a27_0x4194c2(0xde)]),router['get'](a27_0x4194c2(0xe2),adminController['getPayouts']),router[a27_0x4194c2(0x143)](a27_0x4194c2(0x10e),adminController[a27_0x4194c2(0xf7)]),router['delete']('/payouts/:id',adminController[a27_0x4194c2(0x121)]),router[a27_0x4194c2(0x143)](a27_0x4194c2(0x123),adminController[a27_0x4194c2(0x13d)]),router[a27_0x4194c2(0x143)]('/payments/:id',adminController[a27_0x4194c2(0x11c)]),router[a27_0x4194c2(0x103)]('/payments/:id',adminController[a27_0x4194c2(0x117)]),router[a27_0x4194c2(0x103)]('/payments/:id/customer',(0x0,validation_1[a27_0x4194c2(0x106)])(validation_1['updateCustomerDataSchema']),adminController[a27_0x4194c2(0x15c)]),router['get']('/payments/processing-stats',adminController['getProcessingPaymentsStats']),router[a27_0x4194c2(0x100)]('/payments/cleanup',adminController[a27_0x4194c2(0x104)]),router['post'](a27_0x4194c2(0x14c),adminController[a27_0x4194c2(0xf3)]),router[a27_0x4194c2(0x100)](a27_0x4194c2(0x152),adminController[a27_0x4194c2(0x154)]),router['post'](a27_0x4194c2(0xe1),adminController[a27_0x4194c2(0xea)]),router[a27_0x4194c2(0x143)](a27_0x4194c2(0x161),adminController[a27_0x4194c2(0x163)]),router['get'](a27_0x4194c2(0x12d),adminController[a27_0x4194c2(0x156)]),router['post'](a27_0x4194c2(0x161),(0x0,validation_1[a27_0x4194c2(0x106)])(validation_1[a27_0x4194c2(0xf2)]),adminController['createUser']),router[a27_0x4194c2(0x103)]('/users/:id',(0x0,validation_1[a27_0x4194c2(0x106)])(validation_1['updateUserSchema']),adminController[a27_0x4194c2(0xd2)]),router[a27_0x4194c2(0xf5)](a27_0x4194c2(0x12d),adminController[a27_0x4194c2(0xf9)]),router[a27_0x4194c2(0x143)](a27_0x4194c2(0xe5),adminController[a27_0x4194c2(0x118)]),router[a27_0x4194c2(0x100)](a27_0x4194c2(0x130),adminController[a27_0x4194c2(0x128)]),router[a27_0x4194c2(0x100)](a27_0x4194c2(0xfe),adminController[a27_0x4194c2(0x133)]),router['post'](a27_0x4194c2(0xec),adminController[a27_0x4194c2(0xf6)]),router[a27_0x4194c2(0x100)](a27_0x4194c2(0x141),(0x0,validation_1[a27_0x4194c2(0x106)])(validation_1[a27_0x4194c2(0x112)]),adminController[a27_0x4194c2(0x137)]),router['get'](a27_0x4194c2(0x151),adminController[a27_0x4194c2(0x102)]),router[a27_0x4194c2(0x100)](a27_0x4194c2(0x164),adminController[a27_0x4194c2(0xdd)]),router[a27_0x4194c2(0x100)]('/2fa/enable',adminController[a27_0x4194c2(0x12a)]),router[a27_0x4194c2(0x100)](a27_0x4194c2(0xd1),adminController[a27_0x4194c2(0x111)]),router[a27_0x4194c2(0x100)](a27_0x4194c2(0x12e),adminController[a27_0x4194c2(0x146)]),router[a27_0x4194c2(0x100)]('/users/:id/activate',adminController[a27_0x4194c2(0xf0)]),router[a27_0x4194c2(0x100)]('/deposit',adminController[a27_0x4194c2(0x149)]),router[a27_0x4194c2(0x143)]('/login-logs/:shopId',adminController[a27_0x4194c2(0x142)]),router[a27_0x4194c2(0x143)](a27_0x4194c2(0xd4),adminController[a27_0x4194c2(0x15b)]),router[a27_0x4194c2(0xef)]('/gateway-settings/:gatewayId',adminController['updateGatewaySettings']),router['get'](a27_0x4194c2(0x144),adminController[a27_0x4194c2(0x140)]),router[a27_0x4194c2(0x143)]('/logs/stats',(_0x351467,_0x25b81f)=>{const _0x1a3dc3=a27_0x4194c2;try{const _0x84b71d=loggerService_1[_0x1a3dc3(0x15e)]['getLogStats']();_0x25b81f['json']({'success':!![],'result':_0x84b71d});}catch(_0x1b8893){_0x25b81f[_0x1a3dc3(0xf4)](0x1f4)[_0x1a3dc3(0x12f)]({'success':![],'message':_0x1a3dc3(0xe0)});}}),router['post'](a27_0x4194c2(0x148),(_0x217b59,_0x28c3a3)=>{const _0x5daf6b=a27_0x4194c2;try{const {daysToKeep:daysToKeep=0x1e}=_0x217b59[_0x5daf6b(0xe9)];loggerService_1[_0x5daf6b(0x15e)]['cleanOldLogs'](daysToKeep),_0x28c3a3[_0x5daf6b(0x12f)]({'success':!![],'message':'Old\x20logs\x20cleaned\x20(kept\x20last\x20'+daysToKeep+_0x5daf6b(0x108)});}catch(_0x831a91){_0x28c3a3[_0x5daf6b(0xf4)](0x1f4)[_0x5daf6b(0x12f)]({'success':![],'message':_0x5daf6b(0xd3)});}}),router['post'](a27_0x4194c2(0x15f),async(_0x4e163d,_0x1df96c)=>{const _0x5279cc=a27_0x4194c2;try{const {paymentId:_0x2941e7}=_0x4e163d[_0x5279cc(0x14e)];console[_0x5279cc(0xeb)](_0x5279cc(0x147)+_0x2941e7),await coinToPayStatusService_1['coinToPayStatusService'][_0x5279cc(0xe4)](_0x2941e7),_0x1df96c[_0x5279cc(0x12f)]({'success':!![],'message':'CoinToPay\x20payment\x20status\x20checked\x20successfully'});}catch(_0x286d3d){console[_0x5279cc(0xe6)](_0x5279cc(0x115)+_0x4e163d[_0x5279cc(0x14e)][_0x5279cc(0xff)]+':',_0x286d3d),_0x1df96c[_0x5279cc(0xf4)](0x1f4)[_0x5279cc(0x12f)]({'success':![],'message':_0x286d3d instanceof Error?_0x286d3d[_0x5279cc(0xd5)]:'Failed\x20to\x20check\x20CoinToPay\x20payment\x20status'});}}),router['get'](a27_0x4194c2(0x158),(_0x567718,_0x21f36b)=>{const _0x305a9d=a27_0x4194c2;try{const _0x2fb33c=coinToPayStatusService_1[_0x305a9d(0x113)]['getServiceStats']();_0x21f36b[_0x305a9d(0x12f)]({'success':!![],'result':{..._0x2fb33c,'description':_0x305a9d(0x105),'statusMapping':{'Paid':_0x305a9d(0x145),'Awaiting\x20Fiat':_0x305a9d(0x162),'waiting':_0x305a9d(0x162),'expired':'EXPIRED','failed':_0x305a9d(0x11e)},'autoExpiryNote':'Payments\x20automatically\x20expire\x20after\x20'+_0x2fb33c[_0x305a9d(0x12b)]+_0x305a9d(0x10b),'individualTimersNote':'Each\x20new\x20payment\x20gets\x20individual\x20timers:\x201min,\x202min,\x207min,\x2012min,\x20then\x20hourly'}});}catch(_0x2a5047){_0x21f36b[_0x305a9d(0xf4)](0x1f4)[_0x305a9d(0x12f)]({'success':![],'message':'Failed\x20to\x20get\x20CoinToPay\x20service\x20statistics'});}}),router['get']('/cointopay/payment/:paymentId',async(_0x280c5d,_0x33dee4)=>{const _0x14013a=a27_0x4194c2;try{const {paymentId:_0x2a39ff}=_0x280c5d[_0x14013a(0x14e)],_0x47aef3=coinToPayStatusService_1[_0x14013a(0x113)][_0x14013a(0x13f)](_0x2a39ff),_0x4190df=(await Promise[_0x14013a(0x136)]()['then'](()=>__importStar(require('../config/database'))))['default'],_0xba4412=await _0x4190df[_0x14013a(0x12c)][_0x14013a(0x139)]({'where':{'id':_0x2a39ff},'select':{'id':!![],'gateway':!![],'gatewayPaymentId':!![],'status':!![],'amount':!![],'currency':!![],'createdAt':!![],'updatedAt':!![],'shopId':!![],'shop':{'select':{'name':!![],'username':!![]}}}});if(!_0xba4412)return _0x33dee4[_0x14013a(0xf4)](0x194)[_0x14013a(0x12f)]({'success':![],'message':_0x14013a(0x159)});_0x33dee4[_0x14013a(0x12f)]({'success':!![],'result':{'payment':{'id':_0xba4412['id'],'gateway':_0xba4412[_0x14013a(0x132)],'gatewayPaymentId':_0xba4412[_0x14013a(0x120)],'status':_0xba4412['status'],'amount':_0xba4412[_0x14013a(0x10c)],'currency':_0xba4412['currency'],'createdAt':_0xba4412[_0x14013a(0x116)],'updatedAt':_0xba4412[_0x14013a(0x165)],'shop':_0xba4412[_0x14013a(0x11f)]},'timers':_0x47aef3,'isCoinToPay':_0xba4412[_0x14013a(0x132)]===_0x14013a(0xdc),'ageInMinutes':Math['floor']((Date['now']()-_0xba4412[_0x14013a(0x116)]['getTime']())/(0x3e8*0x3c))}});}catch(_0xe43b74){_0x33dee4[_0x14013a(0xf4)](0x1f4)[_0x14013a(0x12f)]({'success':![],'message':_0xe43b74 instanceof Error?_0xe43b74[_0x14013a(0xd5)]:_0x14013a(0x122)});}}),router[a27_0x4194c2(0x143)](a27_0x4194c2(0xd8),(_0x309f39,_0x5eb2b9)=>{const _0x16479d=a27_0x4194c2;try{const _0x17e49e=domainMonitoringService_1['domainMonitoringService']['getMonitoringStats']();_0x5eb2b9[_0x16479d(0x12f)]({'success':!![],'result':{..._0x17e49e,'description':_0x16479d(0xed),'behavior':_0x16479d(0x101),'encoding':_0x16479d(0xfc)}});}catch(_0x475b07){_0x5eb2b9[_0x16479d(0xf4)](0x1f4)[_0x16479d(0x12f)]({'success':![],'message':_0x16479d(0xd6)});}}),router[a27_0x4194c2(0x100)]('/domain-monitoring/check',async(_0x5603d9,_0x4b92c4)=>{const _0x2cc451=a27_0x4194c2;try{const _0x54c808=await domainMonitoringService_1['domainMonitoringService'][_0x2cc451(0x160)]();_0x4b92c4[_0x2cc451(0x12f)]({'success':!![],'result':{'domainAvailable':_0x54c808,'message':_0x54c808?_0x2cc451(0x153):'Domain\x20check\x20failed','timestamp':new Date()[_0x2cc451(0x125)]()}});}catch(_0x1263b9){_0x4b92c4[_0x2cc451(0xf4)](0x1f4)[_0x2cc451(0x12f)]({'success':![],'message':_0x1263b9 instanceof Error?_0x1263b9[_0x2cc451(0xd5)]:'Failed\x20to\x20perform\x20manual\x20domain\x20check'});}}),exports[a27_0x4194c2(0xe7)]=router;