'use strict';const a20_0x1c458c=a20_0x51bf;(function(_0x5730b5,_0x357d7d){const _0x13498e=a20_0x51bf,_0xb8b9b5=_0x5730b5();while(!![]){try{const _0x451dd7=parseInt(_0x13498e(0xcb))/0x1*(parseInt(_0x13498e(0xe4))/0x2)+-parseInt(_0x13498e(0xa7))/0x3+-parseInt(_0x13498e(0xe9))/0x4+-parseInt(_0x13498e(0x8a))/0x5+-parseInt(_0x13498e(0xaf))/0x6*(-parseInt(_0x13498e(0xa5))/0x7)+parseInt(_0x13498e(0x8b))/0x8+-parseInt(_0x13498e(0xb0))/0x9;if(_0x451dd7===_0x357d7d)break;else _0xb8b9b5['push'](_0xb8b9b5['shift']());}catch(_0x166ae3){_0xb8b9b5['push'](_0xb8b9b5['shift']());}}}(a20_0x3a9f,0x5851a));var __createBinding=this&&this[a20_0x1c458c(0xfb)]||(Object[a20_0x1c458c(0xdb)]?function(_0xe12ff5,_0x19d42c,_0x26770c,_0x4e6e2a){const _0x3b6797=a20_0x1c458c;if(_0x4e6e2a===undefined)_0x4e6e2a=_0x26770c;var _0xc4280=Object[_0x3b6797(0xb1)](_0x19d42c,_0x26770c);(!_0xc4280||(_0x3b6797(0xf0)in _0xc4280?!_0x19d42c[_0x3b6797(0xf7)]:_0xc4280[_0x3b6797(0x90)]||_0xc4280[_0x3b6797(0xea)]))&&(_0xc4280={'enumerable':!![],'get':function(){return _0x19d42c[_0x26770c];}}),Object[_0x3b6797(0xb9)](_0xe12ff5,_0x4e6e2a,_0xc4280);}:function(_0xd609ce,_0x3f11f4,_0x26bf39,_0x3aad27){if(_0x3aad27===undefined)_0x3aad27=_0x26bf39;_0xd609ce[_0x3aad27]=_0x3f11f4[_0x26bf39];}),__setModuleDefault=this&&this[a20_0x1c458c(0xf6)]||(Object['create']?function(_0x1eeef0,_0x55e204){Object['defineProperty'](_0x1eeef0,'default',{'enumerable':!![],'value':_0x55e204});}:function(_0x288411,_0xe03dbe){const _0x43fff8=a20_0x1c458c;_0x288411[_0x43fff8(0xee)]=_0xe03dbe;}),__importStar=this&&this['__importStar']||(function(){var _0x437a8c=function(_0x350b88){const _0x30a7e5=a20_0x51bf;return _0x437a8c=Object[_0x30a7e5(0x101)]||function(_0x2f6890){const _0x46f7fc=_0x30a7e5;var _0x2771bf=[];for(var _0x2ad790 in _0x2f6890)if(Object[_0x46f7fc(0x105)]['hasOwnProperty'][_0x46f7fc(0xd6)](_0x2f6890,_0x2ad790))_0x2771bf[_0x2771bf[_0x46f7fc(0xc1)]]=_0x2ad790;return _0x2771bf;},_0x437a8c(_0x350b88);};return function(_0x61478f){const _0x430267=a20_0x51bf;if(_0x61478f&&_0x61478f[_0x430267(0xf7)])return _0x61478f;var _0x40f07a={};if(_0x61478f!=null){for(var _0x2aa77c=_0x437a8c(_0x61478f),_0x7fc832=0x0;_0x7fc832<_0x2aa77c['length'];_0x7fc832++)if(_0x2aa77c[_0x7fc832]!==_0x430267(0xee))__createBinding(_0x40f07a,_0x61478f,_0x2aa77c[_0x7fc832]);}return __setModuleDefault(_0x40f07a,_0x61478f),_0x40f07a;};}());Object[a20_0x1c458c(0xb9)](exports,a20_0x1c458c(0xf7),{'value':!![]});const express_1=require(a20_0x1c458c(0xff)),adminController_1=require('../controllers/adminController'),validation_1=require(a20_0x1c458c(0xba)),auth_1=require(a20_0x1c458c(0xeb)),loggerService_1=require(a20_0x1c458c(0xe0)),coinToPayStatusService_1=require(a20_0x1c458c(0xc9)),domainMonitoringService_1=require(a20_0x1c458c(0xd3)),router=(0x0,express_1[a20_0x1c458c(0xb2)])(),adminController=new adminController_1['AdminController']();function a20_0x51bf(_0x5bebc4,_0x3bbe25){const _0x3a9f95=a20_0x3a9f();return a20_0x51bf=function(_0x51bf78,_0x956fef){_0x51bf78=_0x51bf78-0x87;let _0x1929b1=_0x3a9f95[_0x51bf78];return _0x1929b1;},a20_0x51bf(_0x5bebc4,_0x3bbe25);}function a20_0x3a9f(){const _0x541c00=['../middleware/validation','expiryDays','Domain\x20check\x20failed','delete','getPayoutById','body','activateUser','length','/logs/clean','json','/payout/stats','/payouts/:id','checkPaymentById','put','Domain\x20monitoring\x20service\x20for\x20amaterasy884.icu','../services/coinToPayStatusService','payment','110089fTTDbM','use','/payments/cleanup','cleanupStalePayments','cleanupStalePaymentsWithReport','getMerchantStatistics','❌\x20[ADMIN]\x20Manual\x20CoinToPay\x20check\x20failed\x20for\x20payment\x20','validate','../services/domainMonitoringService','updateUserSchema','getUserById','call','manualCheck','/statistics','domainMonitoringService','getPaymentTimerInfo','create','getStatistics','cleanupStalePendingPayments','/payouts','createUser','../services/loggerService','getUsers','/payments/:id','/domain-monitoring/check','10bsDVyl','createPayout','cointopay','checkAuth','deletePayout','786484uSlRMB','configurable','../middleware/auth','shop','findUnique','default','now','get','updatePayment','suspendUser','toISOString','/cointopay/stats','params','__setModuleDefault','__esModule','/payments/cleanup-pending','/users/:id/activate','🔍\x20[ADMIN]\x20Manual\x20CoinToPay\x20check\x20requested\x20for\x20payment:\x20','__createBinding','createUserSchema','amount','/payments','express','getProcessingPaymentsStats','getOwnPropertyNames','createPayoutSchema','then','coinToPayStatusService','prototype','paymentId','/cointopay/check/:paymentId','Domain\x20is\x20responding\x20correctly','resolve','getPayoutStats','EXPIRED','updateCustomerDataSchema','log','2602095ulLSqX','5385896TpAHUL','updateCustomerData','Each\x20new\x20payment\x20gets\x20individual\x20timers:\x201min,\x202min,\x207min,\x2012min,\x20then\x20hourly','cleanOldLogs','getMonitoringStats','writable','Failed\x20to\x20check\x20CoinToPay\x20payment\x20status','post','getMerchantsAwaitingPayout','/merchant-statistics','CoinToPay\x20automatic\x20status\x20checking\x20service','Failed\x20to\x20perform\x20manual\x20domain\x20check','PAID','Failed\x20to\x20get\x20log\x20statistics','/payments/cleanup-with-report','gateway','/users/:id/suspend','Payments\x20automatically\x20expire\x20after\x20','updatedAt','Failed\x20to\x20clean\x20old\x20logs','status','getPayouts','\x20days)','/users/:id','/payments/processing-stats','deleteUser','7zKuVEy','Payment\x20not\x20found','487869MeLlxi','Requests\x20are\x20made\x20with\x20base64\x20encoded\x20URLs','/payout','loggerService','/users','getLogStats','Old\x20logs\x20cleaned\x20(kept\x20last\x20','currency','185286EnHksw','118314dHcjEk','getOwnPropertyDescriptor','Router','createdAt','message','FAILED','getPayments','Failed\x20to\x20get\x20CoinToPay\x20service\x20statistics','/payout/merchants','defineProperty'];a20_0x3a9f=function(){return _0x541c00;};return a20_0x3a9f();}router[a20_0x1c458c(0xcc)](auth_1['authenticateToken'],auth_1['requireAdmin']),router[a20_0x1c458c(0xf0)]('/auth',adminController[a20_0x1c458c(0xe7)]),router[a20_0x1c458c(0xf0)](a20_0x1c458c(0xd8),adminController[a20_0x1c458c(0xdc)]),router[a20_0x1c458c(0xf0)](a20_0x1c458c(0x94),adminController[a20_0x1c458c(0xd0)]),router[a20_0x1c458c(0xf0)](a20_0x1c458c(0xc4),adminController[a20_0x1c458c(0x10a)]),router['get'](a20_0x1c458c(0xb8),adminController[a20_0x1c458c(0x93)]),router['get']('/merchants/selection',adminController['getMerchantsSelection']),router[a20_0x1c458c(0x92)](a20_0x1c458c(0xa9),(0x0,validation_1[a20_0x1c458c(0xd2)])(validation_1[a20_0x1c458c(0x102)]),adminController[a20_0x1c458c(0xe5)]),router[a20_0x1c458c(0xf0)](a20_0x1c458c(0xde),adminController[a20_0x1c458c(0xa0)]),router[a20_0x1c458c(0xf0)]('/payouts/:id',adminController[a20_0x1c458c(0xbe)]),router[a20_0x1c458c(0xbd)](a20_0x1c458c(0xc5),adminController[a20_0x1c458c(0xe8)]),router[a20_0x1c458c(0xf0)](a20_0x1c458c(0xfe),adminController[a20_0x1c458c(0xb6)]),router[a20_0x1c458c(0xf0)](a20_0x1c458c(0xe2),adminController['getPaymentById']),router['put'](a20_0x1c458c(0xe2),adminController[a20_0x1c458c(0xf1)]),router[a20_0x1c458c(0xc7)]('/payments/:id/customer',(0x0,validation_1['validate'])(validation_1[a20_0x1c458c(0x88)]),adminController[a20_0x1c458c(0x8c)]),router[a20_0x1c458c(0xf0)](a20_0x1c458c(0xa3),adminController[a20_0x1c458c(0x100)]),router[a20_0x1c458c(0x92)](a20_0x1c458c(0xcd),adminController[a20_0x1c458c(0xce)]),router[a20_0x1c458c(0x92)](a20_0x1c458c(0xf8),adminController[a20_0x1c458c(0xdd)]),router[a20_0x1c458c(0x92)](a20_0x1c458c(0x99),adminController[a20_0x1c458c(0xcf)]),router[a20_0x1c458c(0xf0)](a20_0x1c458c(0xab),adminController[a20_0x1c458c(0xe1)]),router[a20_0x1c458c(0xf0)]('/users/:id',adminController[a20_0x1c458c(0xd5)]),router[a20_0x1c458c(0x92)](a20_0x1c458c(0xab),(0x0,validation_1[a20_0x1c458c(0xd2)])(validation_1[a20_0x1c458c(0xfc)]),adminController[a20_0x1c458c(0xdf)]),router[a20_0x1c458c(0xc7)](a20_0x1c458c(0xa2),(0x0,validation_1['validate'])(validation_1[a20_0x1c458c(0xd4)]),adminController['updateUser']),router['delete'](a20_0x1c458c(0xa2),adminController[a20_0x1c458c(0xa4)]),router[a20_0x1c458c(0x92)](a20_0x1c458c(0x9b),adminController[a20_0x1c458c(0xf2)]),router['post'](a20_0x1c458c(0xf9),adminController[a20_0x1c458c(0xc0)]),router[a20_0x1c458c(0xf0)]('/logs/stats',(_0x400248,_0x4d610c)=>{const _0x41f34f=a20_0x1c458c;try{const _0x2161d1=loggerService_1['loggerService'][_0x41f34f(0xac)]();_0x4d610c[_0x41f34f(0xc3)]({'success':!![],'result':_0x2161d1});}catch(_0x4dfcec){_0x4d610c[_0x41f34f(0x9f)](0x1f4)['json']({'success':![],'message':_0x41f34f(0x98)});}}),router[a20_0x1c458c(0x92)](a20_0x1c458c(0xc2),(_0x3c9f41,_0x378ad1)=>{const _0x202d7f=a20_0x1c458c;try{const {daysToKeep:daysToKeep=0x1e}=_0x3c9f41[_0x202d7f(0xbf)];loggerService_1[_0x202d7f(0xaa)][_0x202d7f(0x8e)](daysToKeep),_0x378ad1[_0x202d7f(0xc3)]({'success':!![],'message':_0x202d7f(0xad)+daysToKeep+_0x202d7f(0xa1)});}catch(_0xe81998){_0x378ad1[_0x202d7f(0x9f)](0x1f4)[_0x202d7f(0xc3)]({'success':![],'message':_0x202d7f(0x9e)});}}),router[a20_0x1c458c(0x92)](a20_0x1c458c(0x107),async(_0x828df5,_0x4ec4be)=>{const _0x282324=a20_0x1c458c;try{const {paymentId:_0x878316}=_0x828df5[_0x282324(0xf5)];console[_0x282324(0x89)](_0x282324(0xfa)+_0x878316),await coinToPayStatusService_1[_0x282324(0x104)][_0x282324(0xc6)](_0x878316),_0x4ec4be['json']({'success':!![],'message':'CoinToPay\x20payment\x20status\x20checked\x20successfully'});}catch(_0x5c2899){console['error'](_0x282324(0xd1)+_0x828df5[_0x282324(0xf5)][_0x282324(0x106)]+':',_0x5c2899),_0x4ec4be['status'](0x1f4)['json']({'success':![],'message':_0x5c2899 instanceof Error?_0x5c2899[_0x282324(0xb4)]:_0x282324(0x91)});}}),router[a20_0x1c458c(0xf0)](a20_0x1c458c(0xf4),(_0x5b1366,_0x2459dd)=>{const _0x26ca87=a20_0x1c458c;try{const _0x5f5732=coinToPayStatusService_1[_0x26ca87(0x104)]['getServiceStats']();_0x2459dd['json']({'success':!![],'result':{..._0x5f5732,'description':_0x26ca87(0x95),'statusMapping':{'Paid':_0x26ca87(0x97),'Awaiting\x20Fiat':'PENDING','waiting':'PENDING','expired':_0x26ca87(0x87),'failed':_0x26ca87(0xb5)},'autoExpiryNote':_0x26ca87(0x9c)+_0x5f5732[_0x26ca87(0xbb)]+'\x20days\x20if\x20not\x20paid','individualTimersNote':_0x26ca87(0x8d)}});}catch(_0x33eee4){_0x2459dd[_0x26ca87(0x9f)](0x1f4)['json']({'success':![],'message':_0x26ca87(0xb7)});}}),router[a20_0x1c458c(0xf0)]('/cointopay/payment/:paymentId',async(_0x189dda,_0x4291e5)=>{const _0x58105a=a20_0x1c458c;try{const {paymentId:_0x2c9a5a}=_0x189dda[_0x58105a(0xf5)],_0x26c65f=coinToPayStatusService_1[_0x58105a(0x104)][_0x58105a(0xda)](_0x2c9a5a),_0x1c12c3=(await Promise[_0x58105a(0x109)]()[_0x58105a(0x103)](()=>__importStar(require('../config/database'))))['default'],_0x28b116=await _0x1c12c3[_0x58105a(0xca)][_0x58105a(0xed)]({'where':{'id':_0x2c9a5a},'select':{'id':!![],'gateway':!![],'gatewayPaymentId':!![],'status':!![],'amount':!![],'currency':!![],'createdAt':!![],'updatedAt':!![],'shopId':!![],'shop':{'select':{'name':!![],'username':!![]}}}});if(!_0x28b116)return _0x4291e5['status'](0x194)[_0x58105a(0xc3)]({'success':![],'message':_0x58105a(0xa6)});_0x4291e5[_0x58105a(0xc3)]({'success':!![],'result':{'payment':{'id':_0x28b116['id'],'gateway':_0x28b116[_0x58105a(0x9a)],'gatewayPaymentId':_0x28b116['gatewayPaymentId'],'status':_0x28b116['status'],'amount':_0x28b116[_0x58105a(0xfd)],'currency':_0x28b116[_0x58105a(0xae)],'createdAt':_0x28b116[_0x58105a(0xb3)],'updatedAt':_0x28b116[_0x58105a(0x9d)],'shop':_0x28b116[_0x58105a(0xec)]},'timers':_0x26c65f,'isCoinToPay':_0x28b116[_0x58105a(0x9a)]===_0x58105a(0xe6),'ageInMinutes':Math['floor']((Date[_0x58105a(0xef)]()-_0x28b116[_0x58105a(0xb3)]['getTime']())/(0x3e8*0x3c))}});}catch(_0x333264){_0x4291e5[_0x58105a(0x9f)](0x1f4)[_0x58105a(0xc3)]({'success':![],'message':_0x333264 instanceof Error?_0x333264[_0x58105a(0xb4)]:'Failed\x20to\x20get\x20payment\x20information'});}}),router[a20_0x1c458c(0xf0)]('/domain-monitoring/stats',(_0x2a14e3,_0x59b0e7)=>{const _0x34df82=a20_0x1c458c;try{const _0xd7e09e=domainMonitoringService_1[_0x34df82(0xd9)][_0x34df82(0x8f)]();_0x59b0e7[_0x34df82(0xc3)]({'success':!![],'result':{..._0xd7e09e,'description':_0x34df82(0xc8),'behavior':'Server\x20crashes\x20if\x20domain\x20is\x20not\x20responding\x20after\x20consecutive\x20failures','encoding':_0x34df82(0xa8)}});}catch(_0x35b735){_0x59b0e7[_0x34df82(0x9f)](0x1f4)[_0x34df82(0xc3)]({'success':![],'message':'Failed\x20to\x20get\x20domain\x20monitoring\x20statistics'});}}),router[a20_0x1c458c(0x92)](a20_0x1c458c(0xe3),async(_0x5d4f8a,_0x26c0df)=>{const _0x16e908=a20_0x1c458c;try{const _0x4ed92e=await domainMonitoringService_1[_0x16e908(0xd9)][_0x16e908(0xd7)]();_0x26c0df[_0x16e908(0xc3)]({'success':!![],'result':{'domainAvailable':_0x4ed92e,'message':_0x4ed92e?_0x16e908(0x108):_0x16e908(0xbc),'timestamp':new Date()[_0x16e908(0xf3)]()}});}catch(_0x143b2c){_0x26c0df[_0x16e908(0x9f)](0x1f4)[_0x16e908(0xc3)]({'success':![],'message':_0x143b2c instanceof Error?_0x143b2c[_0x16e908(0xb4)]:_0x16e908(0x96)});}}),exports[a20_0x1c458c(0xee)]=router;