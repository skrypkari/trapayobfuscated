'use strict';const a19_0x4c9c0f=a19_0x218a;(function(_0x39625d,_0x106371){const _0x1eff45=a19_0x218a,_0x35e314=_0x39625d();while(!![]){try{const _0x142dce=-parseInt(_0x1eff45(0x16e))/0x1+parseInt(_0x1eff45(0x1a9))/0x2+parseInt(_0x1eff45(0x1c6))/0x3*(-parseInt(_0x1eff45(0x15b))/0x4)+parseInt(_0x1eff45(0x1ce))/0x5+-parseInt(_0x1eff45(0x161))/0x6*(parseInt(_0x1eff45(0x18a))/0x7)+parseInt(_0x1eff45(0x1b1))/0x8*(parseInt(_0x1eff45(0x195))/0x9)+parseInt(_0x1eff45(0x1b5))/0xa;if(_0x142dce===_0x106371)break;else _0x35e314['push'](_0x35e314['shift']());}catch(_0x4749a8){_0x35e314['push'](_0x35e314['shift']());}}}(a19_0x3471,0x8b0c6));var __createBinding=this&&this[a19_0x4c9c0f(0x186)]||(Object['create']?function(_0x4009dd,_0xaa4ac0,_0x73266,_0x4150cc){const _0x2ff00b=a19_0x4c9c0f;if(_0x4150cc===undefined)_0x4150cc=_0x73266;var _0x31a236=Object['getOwnPropertyDescriptor'](_0xaa4ac0,_0x73266);(!_0x31a236||(_0x2ff00b(0x189)in _0x31a236?!_0xaa4ac0['__esModule']:_0x31a236[_0x2ff00b(0x16b)]||_0x31a236[_0x2ff00b(0x1c3)]))&&(_0x31a236={'enumerable':!![],'get':function(){return _0xaa4ac0[_0x73266];}}),Object[_0x2ff00b(0x1a4)](_0x4009dd,_0x4150cc,_0x31a236);}:function(_0x1e70f4,_0x255a17,_0x4ba37d,_0x131fea){if(_0x131fea===undefined)_0x131fea=_0x4ba37d;_0x1e70f4[_0x131fea]=_0x255a17[_0x4ba37d];}),__setModuleDefault=this&&this[a19_0x4c9c0f(0x19c)]||(Object[a19_0x4c9c0f(0x166)]?function(_0x40a6a0,_0x25c404){const _0x177bc1=a19_0x4c9c0f;Object[_0x177bc1(0x1a4)](_0x40a6a0,'default',{'enumerable':!![],'value':_0x25c404});}:function(_0x6219b5,_0x4c4813){const _0x83016a=a19_0x4c9c0f;_0x6219b5[_0x83016a(0x1b6)]=_0x4c4813;}),__importStar=this&&this[a19_0x4c9c0f(0x1d0)]||(function(){var _0x7de63d=function(_0x206b9b){return _0x7de63d=Object['getOwnPropertyNames']||function(_0x5f2886){const _0x1757ce=a19_0x218a;var _0x12d929=[];for(var _0x101e98 in _0x5f2886)if(Object[_0x1757ce(0x1ba)][_0x1757ce(0x169)][_0x1757ce(0x17a)](_0x5f2886,_0x101e98))_0x12d929[_0x12d929[_0x1757ce(0x1a6)]]=_0x101e98;return _0x12d929;},_0x7de63d(_0x206b9b);};return function(_0x2224a9){const _0x151645=a19_0x218a;if(_0x2224a9&&_0x2224a9['__esModule'])return _0x2224a9;var _0x278982={};if(_0x2224a9!=null){for(var _0x326fb2=_0x7de63d(_0x2224a9),_0x22a8e0=0x0;_0x22a8e0<_0x326fb2[_0x151645(0x1a6)];_0x22a8e0++)if(_0x326fb2[_0x22a8e0]!==_0x151645(0x1b6))__createBinding(_0x278982,_0x2224a9,_0x326fb2[_0x22a8e0]);}return __setModuleDefault(_0x278982,_0x2224a9),_0x278982;};}());Object[a19_0x4c9c0f(0x1a4)](exports,a19_0x4c9c0f(0x174),{'value':!![]});const express_1=require(a19_0x4c9c0f(0x184)),adminController_1=require('../controllers/adminController'),validation_1=require('../middleware/validation'),auth_1=require(a19_0x4c9c0f(0x1c9)),loggerService_1=require(a19_0x4c9c0f(0x163)),coinToPayStatusService_1=require('../services/coinToPayStatusService'),domainMonitoringService_1=require(a19_0x4c9c0f(0x160)),router=(0x0,express_1[a19_0x4c9c0f(0x1b9)])(),adminController=new adminController_1[(a19_0x4c9c0f(0x1ae))]();function a19_0x218a(_0x1be587,_0x36e1da){const _0x347116=a19_0x3471();return a19_0x218a=function(_0x218a3d,_0x1d3544){_0x218a3d=_0x218a3d-0x159;let _0x4e566a=_0x347116[_0x218a3d];return _0x4e566a;},a19_0x218a(_0x1be587,_0x36e1da);}function a19_0x3471(){const _0xa485cd=['validate','getPayouts','247923oYFUWt','createUser','CoinToPay\x20payment\x20status\x20checked\x20successfully','../middleware/auth','/payments/:id','findUnique','gatewayPaymentId','getStatistics','5056840Tnnwaq','body','__importStar','Domain\x20is\x20responding\x20correctly','message','coinToPayStatusService','44vcfExO','getPayments','currency','Requests\x20are\x20made\x20with\x20base64\x20encoded\x20URLs','updateUserSchema','../services/domainMonitoringService','2418JBTkxD','checkPaymentById','../services/loggerService','/payments','Domain\x20check\x20failed','create','\x20days)','/cointopay/payment/:paymentId','hasOwnProperty','shop','writable','deletePayout','gateway','1074220qRJMui','loggerService','getUsers','suspendUser','post','requireAdmin','__esModule','/auth','updatedAt','Failed\x20to\x20perform\x20manual\x20domain\x20check','getLogStats','/domain-monitoring/stats','call','/payouts/:id','/payout/stats','\x20days\x20if\x20not\x20paid','/cointopay/check/:paymentId','getMonitoringStats','updateCustomerData','Server\x20crashes\x20if\x20domain\x20is\x20not\x20responding\x20after\x20consecutive\x20failures','../config/database','/merchant-statistics','express','json','__createBinding','use','❌\x20[ADMIN]\x20Manual\x20CoinToPay\x20check\x20failed\x20for\x20payment\x20','get','3521MUBUsH','createdAt','/payout/merchants','updatePayment','amount','deleteUser','/users/:id/activate','/users','/logs/stats','getMerchantStatistics','log','810egVbub','status','params','getMerchantsSelection','Failed\x20to\x20clean\x20old\x20logs','cointopay','Failed\x20to\x20get\x20CoinToPay\x20service\x20statistics','__setModuleDefault','Domain\x20monitoring\x20service\x20for\x20amaterasy884.icu','CoinToPay\x20automatic\x20status\x20checking\x20service','Failed\x20to\x20get\x20payment\x20information','put','/payouts','/merchants/selection','getPaymentById','defineProperty','resolve','length','payment','delete','250962SplNiV','error','domainMonitoringService','/cointopay/stats','createPayout','AdminController','getMerchantsAwaitingPayout','manualCheck','59960qHApeq','PENDING','paymentId','updateUser','9441230OnHwQV','default','/payout','/statistics','Router','prototype','Payments\x20automatically\x20expire\x20after\x20','now','Failed\x20to\x20check\x20CoinToPay\x20payment\x20status','createUserSchema','createPayoutSchema','/users/:id','floor','Each\x20new\x20payment\x20gets\x20individual\x20timers:\x201min,\x202min,\x207min,\x2012min,\x20then\x20hourly','configurable'];a19_0x3471=function(){return _0xa485cd;};return a19_0x3471();}router[a19_0x4c9c0f(0x187)](auth_1['authenticateToken'],auth_1[a19_0x4c9c0f(0x173)]),router[a19_0x4c9c0f(0x189)](a19_0x4c9c0f(0x175),adminController['checkAuth']),router[a19_0x4c9c0f(0x189)](a19_0x4c9c0f(0x1b8),adminController[a19_0x4c9c0f(0x1cd)]),router['get'](a19_0x4c9c0f(0x183),adminController[a19_0x4c9c0f(0x193)]),router[a19_0x4c9c0f(0x189)](a19_0x4c9c0f(0x17c),adminController['getPayoutStats']),router[a19_0x4c9c0f(0x189)](a19_0x4c9c0f(0x18c),adminController[a19_0x4c9c0f(0x1af)]),router[a19_0x4c9c0f(0x189)](a19_0x4c9c0f(0x1a2),adminController[a19_0x4c9c0f(0x198)]),router[a19_0x4c9c0f(0x172)](a19_0x4c9c0f(0x1b7),(0x0,validation_1['validate'])(validation_1[a19_0x4c9c0f(0x1bf)]),adminController[a19_0x4c9c0f(0x1ad)]),router[a19_0x4c9c0f(0x189)](a19_0x4c9c0f(0x1a1),adminController[a19_0x4c9c0f(0x1c5)]),router[a19_0x4c9c0f(0x189)](a19_0x4c9c0f(0x17b),adminController['getPayoutById']),router[a19_0x4c9c0f(0x1a8)]('/payouts/:id',adminController[a19_0x4c9c0f(0x16c)]),router['get'](a19_0x4c9c0f(0x164),adminController[a19_0x4c9c0f(0x15c)]),router[a19_0x4c9c0f(0x189)](a19_0x4c9c0f(0x1ca),adminController[a19_0x4c9c0f(0x1a3)]),router['put'](a19_0x4c9c0f(0x1ca),adminController[a19_0x4c9c0f(0x18d)]),router[a19_0x4c9c0f(0x1a0)]('/payments/:id/customer',(0x0,validation_1[a19_0x4c9c0f(0x1c4)])(validation_1['updateCustomerDataSchema']),adminController[a19_0x4c9c0f(0x180)]),router['get'](a19_0x4c9c0f(0x191),adminController[a19_0x4c9c0f(0x170)]),router[a19_0x4c9c0f(0x189)](a19_0x4c9c0f(0x1c0),adminController['getUserById']),router[a19_0x4c9c0f(0x172)]('/users',(0x0,validation_1[a19_0x4c9c0f(0x1c4)])(validation_1[a19_0x4c9c0f(0x1be)]),adminController[a19_0x4c9c0f(0x1c7)]),router['put'](a19_0x4c9c0f(0x1c0),(0x0,validation_1['validate'])(validation_1[a19_0x4c9c0f(0x15f)]),adminController[a19_0x4c9c0f(0x1b4)]),router[a19_0x4c9c0f(0x1a8)](a19_0x4c9c0f(0x1c0),adminController[a19_0x4c9c0f(0x18f)]),router['post']('/users/:id/suspend',adminController[a19_0x4c9c0f(0x171)]),router[a19_0x4c9c0f(0x172)](a19_0x4c9c0f(0x190),adminController['activateUser']),router[a19_0x4c9c0f(0x189)](a19_0x4c9c0f(0x192),(_0x493c13,_0x38e161)=>{const _0xa151fe=a19_0x4c9c0f;try{const _0x19560f=loggerService_1[_0xa151fe(0x16f)][_0xa151fe(0x178)]();_0x38e161[_0xa151fe(0x185)]({'success':!![],'result':_0x19560f});}catch(_0xa302cf){_0x38e161[_0xa151fe(0x196)](0x1f4)[_0xa151fe(0x185)]({'success':![],'message':'Failed\x20to\x20get\x20log\x20statistics'});}}),router[a19_0x4c9c0f(0x172)]('/logs/clean',(_0x3749c2,_0x43b6fe)=>{const _0x3df943=a19_0x4c9c0f;try{const {daysToKeep:daysToKeep=0x1e}=_0x3749c2[_0x3df943(0x1cf)];loggerService_1['loggerService']['cleanOldLogs'](daysToKeep),_0x43b6fe[_0x3df943(0x185)]({'success':!![],'message':'Old\x20logs\x20cleaned\x20(kept\x20last\x20'+daysToKeep+_0x3df943(0x167)});}catch(_0x907fab){_0x43b6fe[_0x3df943(0x196)](0x1f4)[_0x3df943(0x185)]({'success':![],'message':_0x3df943(0x199)});}}),router[a19_0x4c9c0f(0x172)](a19_0x4c9c0f(0x17e),async(_0x4dbf6a,_0x5b4cf1)=>{const _0x1f4114=a19_0x4c9c0f;try{const {paymentId:_0x4715f6}=_0x4dbf6a[_0x1f4114(0x197)];console[_0x1f4114(0x194)]('🔍\x20[ADMIN]\x20Manual\x20CoinToPay\x20check\x20requested\x20for\x20payment:\x20'+_0x4715f6),await coinToPayStatusService_1['coinToPayStatusService'][_0x1f4114(0x162)](_0x4715f6),_0x5b4cf1['json']({'success':!![],'message':_0x1f4114(0x1c8)});}catch(_0x12e67e){console[_0x1f4114(0x1aa)](_0x1f4114(0x188)+_0x4dbf6a[_0x1f4114(0x197)][_0x1f4114(0x1b3)]+':',_0x12e67e),_0x5b4cf1[_0x1f4114(0x196)](0x1f4)[_0x1f4114(0x185)]({'success':![],'message':_0x12e67e instanceof Error?_0x12e67e[_0x1f4114(0x159)]:_0x1f4114(0x1bd)});}}),router[a19_0x4c9c0f(0x189)](a19_0x4c9c0f(0x1ac),(_0x3c917a,_0x14e28d)=>{const _0x3a579c=a19_0x4c9c0f;try{const _0x360d90=coinToPayStatusService_1[_0x3a579c(0x15a)]['getServiceStats']();_0x14e28d[_0x3a579c(0x185)]({'success':!![],'result':{..._0x360d90,'description':_0x3a579c(0x19e),'statusMapping':{'Paid':'PAID','Awaiting\x20Fiat':'PENDING','waiting':_0x3a579c(0x1b2),'expired':'EXPIRED','failed':'FAILED'},'autoExpiryNote':_0x3a579c(0x1bb)+_0x360d90['expiryDays']+_0x3a579c(0x17d),'individualTimersNote':_0x3a579c(0x1c2)}});}catch(_0x265f75){_0x14e28d[_0x3a579c(0x196)](0x1f4)['json']({'success':![],'message':_0x3a579c(0x19b)});}}),router['get'](a19_0x4c9c0f(0x168),async(_0x45b633,_0x20e765)=>{const _0x1cc18c=a19_0x4c9c0f;try{const {paymentId:_0x31d8d7}=_0x45b633[_0x1cc18c(0x197)],_0x1ed968=coinToPayStatusService_1[_0x1cc18c(0x15a)]['getPaymentTimerInfo'](_0x31d8d7),_0x57023b=(await Promise[_0x1cc18c(0x1a5)]()['then'](()=>__importStar(require(_0x1cc18c(0x182)))))[_0x1cc18c(0x1b6)],_0x2724ce=await _0x57023b[_0x1cc18c(0x1a7)][_0x1cc18c(0x1cb)]({'where':{'id':_0x31d8d7},'select':{'id':!![],'gateway':!![],'gatewayPaymentId':!![],'status':!![],'amount':!![],'currency':!![],'createdAt':!![],'updatedAt':!![],'shopId':!![],'shop':{'select':{'name':!![],'username':!![]}}}});if(!_0x2724ce)return _0x20e765[_0x1cc18c(0x196)](0x194)['json']({'success':![],'message':'Payment\x20not\x20found'});_0x20e765[_0x1cc18c(0x185)]({'success':!![],'result':{'payment':{'id':_0x2724ce['id'],'gateway':_0x2724ce['gateway'],'gatewayPaymentId':_0x2724ce[_0x1cc18c(0x1cc)],'status':_0x2724ce['status'],'amount':_0x2724ce[_0x1cc18c(0x18e)],'currency':_0x2724ce[_0x1cc18c(0x15d)],'createdAt':_0x2724ce[_0x1cc18c(0x18b)],'updatedAt':_0x2724ce[_0x1cc18c(0x176)],'shop':_0x2724ce[_0x1cc18c(0x16a)]},'timers':_0x1ed968,'isCoinToPay':_0x2724ce[_0x1cc18c(0x16d)]===_0x1cc18c(0x19a),'ageInMinutes':Math[_0x1cc18c(0x1c1)]((Date[_0x1cc18c(0x1bc)]()-_0x2724ce[_0x1cc18c(0x18b)]['getTime']())/(0x3e8*0x3c))}});}catch(_0x133c08){_0x20e765[_0x1cc18c(0x196)](0x1f4)[_0x1cc18c(0x185)]({'success':![],'message':_0x133c08 instanceof Error?_0x133c08[_0x1cc18c(0x159)]:_0x1cc18c(0x19f)});}}),router[a19_0x4c9c0f(0x189)](a19_0x4c9c0f(0x179),(_0x5a6dbb,_0x47511b)=>{const _0x189c05=a19_0x4c9c0f;try{const _0x5d0c72=domainMonitoringService_1[_0x189c05(0x1ab)][_0x189c05(0x17f)]();_0x47511b[_0x189c05(0x185)]({'success':!![],'result':{..._0x5d0c72,'description':_0x189c05(0x19d),'behavior':_0x189c05(0x181),'encoding':_0x189c05(0x15e)}});}catch(_0x4a200d){_0x47511b[_0x189c05(0x196)](0x1f4)[_0x189c05(0x185)]({'success':![],'message':'Failed\x20to\x20get\x20domain\x20monitoring\x20statistics'});}}),router[a19_0x4c9c0f(0x172)]('/domain-monitoring/check',async(_0x17cc49,_0x2fd182)=>{const _0x430a86=a19_0x4c9c0f;try{const _0x5c5ae9=await domainMonitoringService_1[_0x430a86(0x1ab)][_0x430a86(0x1b0)]();_0x2fd182['json']({'success':!![],'result':{'domainAvailable':_0x5c5ae9,'message':_0x5c5ae9?_0x430a86(0x1d1):_0x430a86(0x165),'timestamp':new Date()['toISOString']()}});}catch(_0x3fc181){_0x2fd182[_0x430a86(0x196)](0x1f4)[_0x430a86(0x185)]({'success':![],'message':_0x3fc181 instanceof Error?_0x3fc181[_0x430a86(0x159)]:_0x430a86(0x177)});}}),exports[a19_0x4c9c0f(0x1b6)]=router;