'use strict';function a21_0x5efc(){const _0xe8e678=['169419uDqUNI','Failed\x20to\x20check\x20CoinToPay\x20payment\x20status','cleanupStalePaymentsWithReport','updatedAt','/payments/cleanup-pending','../services/domainMonitoringService','\x20days\x20if\x20not\x20paid','1410BLzGlW','getOwnPropertyDescriptor','Payments\x20automatically\x20expire\x20after\x20','use','Router','post','json','currency','\x20days)','../middleware/validation','__createBinding','Requests\x20are\x20made\x20with\x20base64\x20encoded\x20URLs','message','/payouts/:id','getTime','1722JzXoTV','__setModuleDefault','call','getPaymentTimerInfo','amount','params','status','CoinToPay\x20payment\x20status\x20checked\x20successfully','put','Failed\x20to\x20get\x20domain\x20monitoring\x20statistics','updateCustomerData','createdAt','create','../services/loggerService','/users','resolve','deletePayout','createPayoutSchema','getUsers','/logs/stats','Domain\x20check\x20failed','loggerService','activateUser','shop','Failed\x20to\x20get\x20payment\x20information','PENDING','../middleware/auth','getProcessingPaymentsStats','Failed\x20to\x20get\x20CoinToPay\x20service\x20statistics','../controllers/adminController','express','checkAuth','deleteUser','Failed\x20to\x20get\x20log\x20statistics','validate','floor','suspendUser','542448xVFWuv','489044zGqpnC','default','/payments/:id','/statistics','updateCustomerDataSchema','6ypaBQJ','getStatistics','/cointopay/stats','Payment\x20not\x20found','getUserById','/payments/processing-stats','__esModule','getPayments','getPaymentById','cleanOldLogs','coinToPayStatusService','/cointopay/payment/:paymentId','cleanupStalePendingPayments','get','authenticateToken','Domain\x20monitoring\x20service\x20for\x20amaterasy884.icu','log','getPayouts','306504wKXHEw','then','AdminController','cleanupStalePayments','createUser','../services/coinToPayStatusService','payment','manualCheck','Server\x20crashes\x20if\x20domain\x20is\x20not\x20responding\x20after\x20consecutive\x20failures','toISOString','Domain\x20is\x20responding\x20correctly','/payouts','../config/database','checkPaymentById','/users/:id/activate','getMerchantsSelection','1591930ICQBCt','getMerchantStatistics','findUnique','paymentId','Each\x20new\x20payment\x20gets\x20individual\x20timers:\x201min,\x202min,\x207min,\x2012min,\x20then\x20hourly','cointopay','getLogStats','getServiceStats','/merchant-statistics','expiryDays','14176tlUvew','now','length','üîç\x20[ADMIN]\x20Manual\x20CoinToPay\x20check\x20requested\x20for\x20payment:\x20','Failed\x20to\x20clean\x20old\x20logs','__importStar','/payout/merchants','/users/:id','/users/:id/suspend','createUserSchema','configurable','hasOwnProperty','defineProperty','/payout'];a21_0x5efc=function(){return _0xe8e678;};return a21_0x5efc();}const a21_0x3aa743=a21_0x21af;function a21_0x21af(_0x112051,_0x44b368){const _0x5efcea=a21_0x5efc();return a21_0x21af=function(_0x21af7b,_0x4e0c9d){_0x21af7b=_0x21af7b-0x14c;let _0x2155fb=_0x5efcea[_0x21af7b];return _0x2155fb;},a21_0x21af(_0x112051,_0x44b368);}(function(_0x5880e0,_0x306da8){const _0x34d856=a21_0x21af,_0x11667c=_0x5880e0();while(!![]){try{const _0x30d8cf=-parseInt(_0x34d856(0x1a0))/0x1+parseInt(_0x34d856(0x174))/0x2*(-parseInt(_0x34d856(0x1ae))/0x3)+-parseInt(_0x34d856(0x16f))/0x4+parseInt(_0x34d856(0x196))/0x5+parseInt(_0x34d856(0x1b5))/0x6*(parseInt(_0x34d856(0x1c4))/0x7)+parseInt(_0x34d856(0x16e))/0x8+parseInt(_0x34d856(0x186))/0x9;if(_0x30d8cf===_0x306da8)break;else _0x11667c['push'](_0x11667c['shift']());}catch(_0x2962f8){_0x11667c['push'](_0x11667c['shift']());}}}(a21_0x5efc,0x2a0aa));var __createBinding=this&&this[a21_0x3aa743(0x1bf)]||(Object[a21_0x3aa743(0x155)]?function(_0x338c6b,_0x12eb0e,_0xb1df47,_0xbc84fe){const _0xec16a4=a21_0x3aa743;if(_0xbc84fe===undefined)_0xbc84fe=_0xb1df47;var _0xdefbec=Object[_0xec16a4(0x1b6)](_0x12eb0e,_0xb1df47);(!_0xdefbec||('get'in _0xdefbec?!_0x12eb0e[_0xec16a4(0x17a)]:_0xdefbec['writable']||_0xdefbec[_0xec16a4(0x1aa)]))&&(_0xdefbec={'enumerable':!![],'get':function(){return _0x12eb0e[_0xb1df47];}}),Object[_0xec16a4(0x1ac)](_0x338c6b,_0xbc84fe,_0xdefbec);}:function(_0x28d9ff,_0x3ba1ea,_0x32181e,_0x39739e){if(_0x39739e===undefined)_0x39739e=_0x32181e;_0x28d9ff[_0x39739e]=_0x3ba1ea[_0x32181e];}),__setModuleDefault=this&&this[a21_0x3aa743(0x1c5)]||(Object[a21_0x3aa743(0x155)]?function(_0x3865ce,_0x2fbdd8){const _0x5a43ba=a21_0x3aa743;Object[_0x5a43ba(0x1ac)](_0x3865ce,_0x5a43ba(0x170),{'enumerable':!![],'value':_0x2fbdd8});}:function(_0x3b1526,_0x22b910){const _0x2c687a=a21_0x3aa743;_0x3b1526[_0x2c687a(0x170)]=_0x22b910;}),__importStar=this&&this[a21_0x3aa743(0x1a5)]||(function(){var _0x4f3ef6=function(_0x453d94){return _0x4f3ef6=Object['getOwnPropertyNames']||function(_0x3bd835){const _0x318d52=a21_0x21af;var _0x351dda=[];for(var _0x4dbccb in _0x3bd835)if(Object['prototype'][_0x318d52(0x1ab)][_0x318d52(0x1c6)](_0x3bd835,_0x4dbccb))_0x351dda[_0x351dda[_0x318d52(0x1a2)]]=_0x4dbccb;return _0x351dda;},_0x4f3ef6(_0x453d94);};return function(_0x49cf8e){const _0x5f0b67=a21_0x21af;if(_0x49cf8e&&_0x49cf8e['__esModule'])return _0x49cf8e;var _0x4d39ce={};if(_0x49cf8e!=null){for(var _0x56fdc9=_0x4f3ef6(_0x49cf8e),_0x2080b6=0x0;_0x2080b6<_0x56fdc9[_0x5f0b67(0x1a2)];_0x2080b6++)if(_0x56fdc9[_0x2080b6]!==_0x5f0b67(0x170))__createBinding(_0x4d39ce,_0x49cf8e,_0x56fdc9[_0x2080b6]);}return __setModuleDefault(_0x4d39ce,_0x49cf8e),_0x4d39ce;};}());Object['defineProperty'](exports,a21_0x3aa743(0x17a),{'value':!![]});const express_1=require(a21_0x3aa743(0x167)),adminController_1=require(a21_0x3aa743(0x166)),validation_1=require(a21_0x3aa743(0x1be)),auth_1=require(a21_0x3aa743(0x163)),loggerService_1=require(a21_0x3aa743(0x156)),coinToPayStatusService_1=require(a21_0x3aa743(0x18b)),domainMonitoringService_1=require(a21_0x3aa743(0x1b3)),router=(0x0,express_1[a21_0x3aa743(0x1b9)])(),adminController=new adminController_1[(a21_0x3aa743(0x188))]();router[a21_0x3aa743(0x1b8)](auth_1[a21_0x3aa743(0x182)],auth_1['requireAdmin']),router[a21_0x3aa743(0x181)]('/auth',adminController[a21_0x3aa743(0x168)]),router[a21_0x3aa743(0x181)](a21_0x3aa743(0x172),adminController[a21_0x3aa743(0x175)]),router[a21_0x3aa743(0x181)](a21_0x3aa743(0x19e),adminController[a21_0x3aa743(0x197)]),router[a21_0x3aa743(0x181)]('/payout/stats',adminController['getPayoutStats']),router['get'](a21_0x3aa743(0x1a6),adminController['getMerchantsAwaitingPayout']),router[a21_0x3aa743(0x181)]('/merchants/selection',adminController[a21_0x3aa743(0x195)]),router[a21_0x3aa743(0x1ba)](a21_0x3aa743(0x1ad),(0x0,validation_1[a21_0x3aa743(0x16b)])(validation_1[a21_0x3aa743(0x15a)]),adminController['createPayout']),router[a21_0x3aa743(0x181)](a21_0x3aa743(0x191),adminController[a21_0x3aa743(0x185)]),router[a21_0x3aa743(0x181)](a21_0x3aa743(0x1c2),adminController['getPayoutById']),router['delete'](a21_0x3aa743(0x1c2),adminController[a21_0x3aa743(0x159)]),router['get']('/payments',adminController[a21_0x3aa743(0x17b)]),router[a21_0x3aa743(0x181)]('/payments/:id',adminController[a21_0x3aa743(0x17c)]),router[a21_0x3aa743(0x151)](a21_0x3aa743(0x171),adminController['updatePayment']),router[a21_0x3aa743(0x151)]('/payments/:id/customer',(0x0,validation_1[a21_0x3aa743(0x16b)])(validation_1[a21_0x3aa743(0x173)]),adminController[a21_0x3aa743(0x153)]),router[a21_0x3aa743(0x181)](a21_0x3aa743(0x179),adminController[a21_0x3aa743(0x164)]),router[a21_0x3aa743(0x1ba)]('/payments/cleanup',adminController[a21_0x3aa743(0x189)]),router[a21_0x3aa743(0x1ba)](a21_0x3aa743(0x1b2),adminController[a21_0x3aa743(0x180)]),router[a21_0x3aa743(0x1ba)]('/payments/cleanup-with-report',adminController[a21_0x3aa743(0x1b0)]),router[a21_0x3aa743(0x181)](a21_0x3aa743(0x157),adminController[a21_0x3aa743(0x15b)]),router[a21_0x3aa743(0x181)](a21_0x3aa743(0x1a7),adminController[a21_0x3aa743(0x178)]),router[a21_0x3aa743(0x1ba)](a21_0x3aa743(0x157),(0x0,validation_1['validate'])(validation_1[a21_0x3aa743(0x1a9)]),adminController[a21_0x3aa743(0x18a)]),router['put']('/users/:id',(0x0,validation_1[a21_0x3aa743(0x16b)])(validation_1['updateUserSchema']),adminController['updateUser']),router['delete'](a21_0x3aa743(0x1a7),adminController[a21_0x3aa743(0x169)]),router['post'](a21_0x3aa743(0x1a8),adminController[a21_0x3aa743(0x16d)]),router[a21_0x3aa743(0x1ba)](a21_0x3aa743(0x194),adminController[a21_0x3aa743(0x15f)]),router[a21_0x3aa743(0x181)](a21_0x3aa743(0x15c),(_0x130e6b,_0x4d016e)=>{const _0x4d94f5=a21_0x3aa743;try{const _0x24770d=loggerService_1['loggerService'][_0x4d94f5(0x19c)]();_0x4d016e[_0x4d94f5(0x1bb)]({'success':!![],'result':_0x24770d});}catch(_0x52ab7a){_0x4d016e[_0x4d94f5(0x14f)](0x1f4)['json']({'success':![],'message':_0x4d94f5(0x16a)});}}),router[a21_0x3aa743(0x1ba)]('/logs/clean',(_0x4515e6,_0x4599f0)=>{const _0x48ea31=a21_0x3aa743;try{const {daysToKeep:daysToKeep=0x1e}=_0x4515e6['body'];loggerService_1[_0x48ea31(0x15e)][_0x48ea31(0x17d)](daysToKeep),_0x4599f0[_0x48ea31(0x1bb)]({'success':!![],'message':'Old\x20logs\x20cleaned\x20(kept\x20last\x20'+daysToKeep+_0x48ea31(0x1bd)});}catch(_0x35a4b6){_0x4599f0[_0x48ea31(0x14f)](0x1f4)[_0x48ea31(0x1bb)]({'success':![],'message':_0x48ea31(0x1a4)});}}),router[a21_0x3aa743(0x1ba)]('/cointopay/check/:paymentId',async(_0x368254,_0x2ee6fb)=>{const _0x392c8d=a21_0x3aa743;try{const {paymentId:_0x57707e}=_0x368254[_0x392c8d(0x14e)];console[_0x392c8d(0x184)](_0x392c8d(0x1a3)+_0x57707e),await coinToPayStatusService_1[_0x392c8d(0x17e)][_0x392c8d(0x193)](_0x57707e),_0x2ee6fb[_0x392c8d(0x1bb)]({'success':!![],'message':_0x392c8d(0x150)});}catch(_0x1f4be8){console['error']('‚ùå\x20[ADMIN]\x20Manual\x20CoinToPay\x20check\x20failed\x20for\x20payment\x20'+_0x368254[_0x392c8d(0x14e)][_0x392c8d(0x199)]+':',_0x1f4be8),_0x2ee6fb[_0x392c8d(0x14f)](0x1f4)[_0x392c8d(0x1bb)]({'success':![],'message':_0x1f4be8 instanceof Error?_0x1f4be8[_0x392c8d(0x1c1)]:_0x392c8d(0x1af)});}}),router[a21_0x3aa743(0x181)](a21_0x3aa743(0x176),(_0x3bfe8e,_0x1e6790)=>{const _0x20151c=a21_0x3aa743;try{const _0x3f56b6=coinToPayStatusService_1[_0x20151c(0x17e)][_0x20151c(0x19d)]();_0x1e6790[_0x20151c(0x1bb)]({'success':!![],'result':{..._0x3f56b6,'description':'CoinToPay\x20automatic\x20status\x20checking\x20service','statusMapping':{'Paid':'PAID','Awaiting\x20Fiat':_0x20151c(0x162),'waiting':_0x20151c(0x162),'expired':'EXPIRED','failed':'FAILED'},'autoExpiryNote':_0x20151c(0x1b7)+_0x3f56b6[_0x20151c(0x19f)]+_0x20151c(0x1b4),'individualTimersNote':_0x20151c(0x19a)}});}catch(_0x1f74b3){_0x1e6790[_0x20151c(0x14f)](0x1f4)[_0x20151c(0x1bb)]({'success':![],'message':_0x20151c(0x165)});}}),router['get'](a21_0x3aa743(0x17f),async(_0x48b5d4,_0x6eabfc)=>{const _0x372cb8=a21_0x3aa743;try{const {paymentId:_0x479dbf}=_0x48b5d4['params'],_0x215379=coinToPayStatusService_1[_0x372cb8(0x17e)][_0x372cb8(0x14c)](_0x479dbf),_0x13974c=(await Promise[_0x372cb8(0x158)]()[_0x372cb8(0x187)](()=>__importStar(require(_0x372cb8(0x192)))))[_0x372cb8(0x170)],_0x5bf419=await _0x13974c[_0x372cb8(0x18c)][_0x372cb8(0x198)]({'where':{'id':_0x479dbf},'select':{'id':!![],'gateway':!![],'gatewayPaymentId':!![],'status':!![],'amount':!![],'currency':!![],'createdAt':!![],'updatedAt':!![],'shopId':!![],'shop':{'select':{'name':!![],'username':!![]}}}});if(!_0x5bf419)return _0x6eabfc[_0x372cb8(0x14f)](0x194)[_0x372cb8(0x1bb)]({'success':![],'message':_0x372cb8(0x177)});_0x6eabfc[_0x372cb8(0x1bb)]({'success':!![],'result':{'payment':{'id':_0x5bf419['id'],'gateway':_0x5bf419['gateway'],'gatewayPaymentId':_0x5bf419['gatewayPaymentId'],'status':_0x5bf419[_0x372cb8(0x14f)],'amount':_0x5bf419[_0x372cb8(0x14d)],'currency':_0x5bf419[_0x372cb8(0x1bc)],'createdAt':_0x5bf419[_0x372cb8(0x154)],'updatedAt':_0x5bf419[_0x372cb8(0x1b1)],'shop':_0x5bf419[_0x372cb8(0x160)]},'timers':_0x215379,'isCoinToPay':_0x5bf419['gateway']===_0x372cb8(0x19b),'ageInMinutes':Math[_0x372cb8(0x16c)]((Date[_0x372cb8(0x1a1)]()-_0x5bf419['createdAt'][_0x372cb8(0x1c3)]())/(0x3e8*0x3c))}});}catch(_0x2b51f4){_0x6eabfc[_0x372cb8(0x14f)](0x1f4)[_0x372cb8(0x1bb)]({'success':![],'message':_0x2b51f4 instanceof Error?_0x2b51f4['message']:_0x372cb8(0x161)});}}),router[a21_0x3aa743(0x181)]('/domain-monitoring/stats',(_0x19a56a,_0x249329)=>{const _0x5e46d5=a21_0x3aa743;try{const _0x232d87=domainMonitoringService_1['domainMonitoringService']['getMonitoringStats']();_0x249329[_0x5e46d5(0x1bb)]({'success':!![],'result':{..._0x232d87,'description':_0x5e46d5(0x183),'behavior':_0x5e46d5(0x18e),'encoding':_0x5e46d5(0x1c0)}});}catch(_0x2d4562){_0x249329[_0x5e46d5(0x14f)](0x1f4)[_0x5e46d5(0x1bb)]({'success':![],'message':_0x5e46d5(0x152)});}}),router[a21_0x3aa743(0x1ba)]('/domain-monitoring/check',async(_0x25179d,_0x506a3a)=>{const _0x3093d2=a21_0x3aa743;try{const _0x5e573a=await domainMonitoringService_1['domainMonitoringService'][_0x3093d2(0x18d)]();_0x506a3a['json']({'success':!![],'result':{'domainAvailable':_0x5e573a,'message':_0x5e573a?_0x3093d2(0x190):_0x3093d2(0x15d),'timestamp':new Date()[_0x3093d2(0x18f)]()}});}catch(_0x3c0c2c){_0x506a3a['status'](0x1f4)[_0x3093d2(0x1bb)]({'success':![],'message':_0x3c0c2c instanceof Error?_0x3c0c2c[_0x3093d2(0x1c1)]:'Failed\x20to\x20perform\x20manual\x20domain\x20check'});}}),exports[a21_0x3aa743(0x170)]=router;