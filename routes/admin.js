'use strict';function a19_0x45b8(_0x589ebc,_0x1b6543){const _0x149e0e=a19_0x149e();return a19_0x45b8=function(_0x45b80d,_0x160457){_0x45b80d=_0x45b80d-0xe7;let _0xd9185d=_0x149e0e[_0x45b80d];return _0xd9185d;},a19_0x45b8(_0x589ebc,_0x1b6543);}const a19_0x4a2b5d=a19_0x45b8;(function(_0x29c8a0,_0x527cbf){const _0x47c761=a19_0x45b8,_0x4ed6a2=_0x29c8a0();while(!![]){try{const _0x3e03dc=parseInt(_0x47c761(0x101))/0x1*(-parseInt(_0x47c761(0x148))/0x2)+-parseInt(_0x47c761(0x107))/0x3+parseInt(_0x47c761(0x11f))/0x4*(-parseInt(_0x47c761(0x11a))/0x5)+-parseInt(_0x47c761(0xfa))/0x6+parseInt(_0x47c761(0x122))/0x7+parseInt(_0x47c761(0x115))/0x8+parseInt(_0x47c761(0x14d))/0x9;if(_0x3e03dc===_0x527cbf)break;else _0x4ed6a2['push'](_0x4ed6a2['shift']());}catch(_0x1f3346){_0x4ed6a2['push'](_0x4ed6a2['shift']());}}}(a19_0x149e,0xc6d44));var __createBinding=this&&this['__createBinding']||(Object[a19_0x4a2b5d(0x111)]?function(_0x3b83ee,_0x237b7c,_0x208468,_0x26b2bf){const _0x56e724=a19_0x4a2b5d;if(_0x26b2bf===undefined)_0x26b2bf=_0x208468;var _0xd4cc5=Object[_0x56e724(0xee)](_0x237b7c,_0x208468);(!_0xd4cc5||(_0x56e724(0x10d)in _0xd4cc5?!_0x237b7c[_0x56e724(0x143)]:_0xd4cc5[_0x56e724(0x13c)]||_0xd4cc5[_0x56e724(0x154)]))&&(_0xd4cc5={'enumerable':!![],'get':function(){return _0x237b7c[_0x208468];}}),Object[_0x56e724(0xef)](_0x3b83ee,_0x26b2bf,_0xd4cc5);}:function(_0x34336e,_0x3aee7f,_0x3506b4,_0x228b46){if(_0x228b46===undefined)_0x228b46=_0x3506b4;_0x34336e[_0x228b46]=_0x3aee7f[_0x3506b4];}),__setModuleDefault=this&&this[a19_0x4a2b5d(0x156)]||(Object[a19_0x4a2b5d(0x111)]?function(_0x664f51,_0x4328fa){const _0x2aed2f=a19_0x4a2b5d;Object[_0x2aed2f(0xef)](_0x664f51,_0x2aed2f(0x11b),{'enumerable':!![],'value':_0x4328fa});}:function(_0x2d3286,_0xffa6ef){const _0xe6efc0=a19_0x4a2b5d;_0x2d3286[_0xe6efc0(0x11b)]=_0xffa6ef;}),__importStar=this&&this['__importStar']||(function(){var _0x50178e=function(_0x41c8df){const _0x23e958=a19_0x45b8;return _0x50178e=Object[_0x23e958(0x10e)]||function(_0x12f288){const _0x450afc=_0x23e958;var _0x535310=[];for(var _0x54bb0c in _0x12f288)if(Object[_0x450afc(0x13f)][_0x450afc(0x138)][_0x450afc(0xff)](_0x12f288,_0x54bb0c))_0x535310[_0x535310['length']]=_0x54bb0c;return _0x535310;},_0x50178e(_0x41c8df);};return function(_0x599980){const _0x43e544=a19_0x45b8;if(_0x599980&&_0x599980['__esModule'])return _0x599980;var _0x87561a={};if(_0x599980!=null){for(var _0x356c0a=_0x50178e(_0x599980),_0x20c242=0x0;_0x20c242<_0x356c0a[_0x43e544(0x141)];_0x20c242++)if(_0x356c0a[_0x20c242]!==_0x43e544(0x11b))__createBinding(_0x87561a,_0x599980,_0x356c0a[_0x20c242]);}return __setModuleDefault(_0x87561a,_0x599980),_0x87561a;};}());Object[a19_0x4a2b5d(0xef)](exports,a19_0x4a2b5d(0x143),{'value':!![]});const express_1=require('express'),adminController_1=require(a19_0x4a2b5d(0xfd)),validation_1=require('../middleware/validation'),auth_1=require(a19_0x4a2b5d(0x11e)),loggerService_1=require(a19_0x4a2b5d(0x149)),coinToPayStatusService_1=require('../services/coinToPayStatusService'),domainMonitoringService_1=require('../services/domainMonitoringService'),router=(0x0,express_1[a19_0x4a2b5d(0x142)])(),adminController=new adminController_1[(a19_0x4a2b5d(0x10b))]();router[a19_0x4a2b5d(0x155)](auth_1['authenticateToken'],auth_1['requireAdmin']),router[a19_0x4a2b5d(0x10d)](a19_0x4a2b5d(0x147),adminController[a19_0x4a2b5d(0xec)]),router[a19_0x4a2b5d(0x10d)](a19_0x4a2b5d(0x124),adminController[a19_0x4a2b5d(0x112)]),router['get'](a19_0x4a2b5d(0x127),adminController[a19_0x4a2b5d(0xfe)]),router['get'](a19_0x4a2b5d(0x130),adminController['getPayoutStats']),router[a19_0x4a2b5d(0x10d)](a19_0x4a2b5d(0x114),adminController[a19_0x4a2b5d(0x110)]),router[a19_0x4a2b5d(0x10d)](a19_0x4a2b5d(0x119),adminController['getMerchantsSelection']),router[a19_0x4a2b5d(0xf4)](a19_0x4a2b5d(0x13e),(0x0,validation_1[a19_0x4a2b5d(0x116)])(validation_1[a19_0x4a2b5d(0x14b)]),adminController[a19_0x4a2b5d(0x103)]),router['get']('/payouts',adminController[a19_0x4a2b5d(0x151)]),router['get']('/payouts/:id',adminController['getPayoutById']),router[a19_0x4a2b5d(0x12d)](a19_0x4a2b5d(0x113),adminController[a19_0x4a2b5d(0x11d)]),router['get']('/payments',adminController['getPayments']),router['get'](a19_0x4a2b5d(0x132),adminController[a19_0x4a2b5d(0xf3)]),router[a19_0x4a2b5d(0x11c)](a19_0x4a2b5d(0x132),adminController[a19_0x4a2b5d(0xf8)]),router[a19_0x4a2b5d(0x11c)]('/payments/:id/customer',(0x0,validation_1[a19_0x4a2b5d(0x116)])(validation_1['updateCustomerDataSchema']),adminController[a19_0x4a2b5d(0xed)]),router[a19_0x4a2b5d(0x10d)]('/users',adminController[a19_0x4a2b5d(0x12f)]),router[a19_0x4a2b5d(0x10d)](a19_0x4a2b5d(0x157),adminController['getUserById']),router[a19_0x4a2b5d(0xf4)](a19_0x4a2b5d(0x135),(0x0,validation_1['validate'])(validation_1[a19_0x4a2b5d(0xe9)]),adminController['createUser']),router[a19_0x4a2b5d(0x11c)]('/users/:id',(0x0,validation_1[a19_0x4a2b5d(0x116)])(validation_1[a19_0x4a2b5d(0x12e)]),adminController['updateUser']),router[a19_0x4a2b5d(0x12d)](a19_0x4a2b5d(0x157),adminController[a19_0x4a2b5d(0x120)]),router[a19_0x4a2b5d(0xf4)]('/users/:id/suspend',adminController[a19_0x4a2b5d(0x126)]),router[a19_0x4a2b5d(0xf4)](a19_0x4a2b5d(0x123),adminController[a19_0x4a2b5d(0x10c)]),router[a19_0x4a2b5d(0x10d)](a19_0x4a2b5d(0x144),(_0x188f06,_0x39f836)=>{const _0x564fc9=a19_0x4a2b5d;try{const _0x4a0f36=loggerService_1[_0x564fc9(0xf2)][_0x564fc9(0x139)]();_0x39f836[_0x564fc9(0x134)]({'success':!![],'result':_0x4a0f36});}catch(_0x5f18a6){_0x39f836[_0x564fc9(0x129)](0x1f4)[_0x564fc9(0x134)]({'success':![],'message':_0x564fc9(0xeb)});}}),router[a19_0x4a2b5d(0xf4)](a19_0x4a2b5d(0xfc),(_0xafc320,_0xbf6051)=>{const _0x580389=a19_0x4a2b5d;try{const {daysToKeep:daysToKeep=0x1e}=_0xafc320['body'];loggerService_1[_0x580389(0xf2)]['cleanOldLogs'](daysToKeep),_0xbf6051[_0x580389(0x134)]({'success':!![],'message':'Old\x20logs\x20cleaned\x20(kept\x20last\x20'+daysToKeep+'\x20days)'});}catch(_0x540308){_0xbf6051['status'](0x1f4)[_0x580389(0x134)]({'success':![],'message':_0x580389(0x117)});}}),router[a19_0x4a2b5d(0xf4)](a19_0x4a2b5d(0x125),async(_0x3d0721,_0x93b558)=>{const _0x34218d=a19_0x4a2b5d;try{const {paymentId:_0x21c512}=_0x3d0721[_0x34218d(0xe7)];console['log']('🔍\x20[ADMIN]\x20Manual\x20CoinToPay\x20check\x20requested\x20for\x20payment:\x20'+_0x21c512),await coinToPayStatusService_1[_0x34218d(0xf6)]['checkPaymentById'](_0x21c512),_0x93b558[_0x34218d(0x134)]({'success':!![],'message':_0x34218d(0x153)});}catch(_0x200355){console[_0x34218d(0x14c)](_0x34218d(0x131)+_0x3d0721['params'][_0x34218d(0x14a)]+':',_0x200355),_0x93b558[_0x34218d(0x129)](0x1f4)[_0x34218d(0x134)]({'success':![],'message':_0x200355 instanceof Error?_0x200355[_0x34218d(0x118)]:_0x34218d(0x10a)});}}),router[a19_0x4a2b5d(0x10d)](a19_0x4a2b5d(0x13d),(_0x3dcca2,_0x351c40)=>{const _0x2251db=a19_0x4a2b5d;try{const _0x20727a=coinToPayStatusService_1['coinToPayStatusService'][_0x2251db(0x106)]();_0x351c40[_0x2251db(0x134)]({'success':!![],'result':{..._0x20727a,'description':'CoinToPay\x20automatic\x20status\x20checking\x20service','statusMapping':{'Paid':'PAID','Awaiting\x20Fiat':_0x2251db(0x12b),'waiting':_0x2251db(0x12b),'expired':_0x2251db(0x108),'failed':_0x2251db(0x13a)},'autoExpiryNote':_0x2251db(0x105)+_0x20727a[_0x2251db(0x152)]+_0x2251db(0x146),'individualTimersNote':_0x2251db(0xfb)}});}catch(_0x542512){_0x351c40[_0x2251db(0x129)](0x1f4)[_0x2251db(0x134)]({'success':![],'message':_0x2251db(0x14f)});}}),router[a19_0x4a2b5d(0x10d)]('/cointopay/payment/:paymentId',async(_0x32be91,_0x472092)=>{const _0x565b1a=a19_0x4a2b5d;try{const {paymentId:_0x482957}=_0x32be91['params'],_0x5efa57=coinToPayStatusService_1[_0x565b1a(0xf6)][_0x565b1a(0xf1)](_0x482957),_0x5a96c9=(await Promise[_0x565b1a(0x133)]()[_0x565b1a(0xf9)](()=>__importStar(require('../config/database'))))[_0x565b1a(0x11b)],_0x1d62f0=await _0x5a96c9[_0x565b1a(0xf7)][_0x565b1a(0x145)]({'where':{'id':_0x482957},'select':{'id':!![],'gateway':!![],'gatewayPaymentId':!![],'status':!![],'amount':!![],'currency':!![],'createdAt':!![],'updatedAt':!![],'shopId':!![],'shop':{'select':{'name':!![],'username':!![]}}}});if(!_0x1d62f0)return _0x472092[_0x565b1a(0x129)](0x194)['json']({'success':![],'message':_0x565b1a(0x109)});_0x472092[_0x565b1a(0x134)]({'success':!![],'result':{'payment':{'id':_0x1d62f0['id'],'gateway':_0x1d62f0[_0x565b1a(0x104)],'gatewayPaymentId':_0x1d62f0[_0x565b1a(0xea)],'status':_0x1d62f0['status'],'amount':_0x1d62f0[_0x565b1a(0x12c)],'currency':_0x1d62f0[_0x565b1a(0x14e)],'createdAt':_0x1d62f0['createdAt'],'updatedAt':_0x1d62f0['updatedAt'],'shop':_0x1d62f0[_0x565b1a(0x140)]},'timers':_0x5efa57,'isCoinToPay':_0x1d62f0[_0x565b1a(0x104)]==='cointopay','ageInMinutes':Math[_0x565b1a(0x150)]((Date['now']()-_0x1d62f0[_0x565b1a(0x102)][_0x565b1a(0xe8)]())/(0x3e8*0x3c))}});}catch(_0x75bf19){_0x472092[_0x565b1a(0x129)](0x1f4)[_0x565b1a(0x134)]({'success':![],'message':_0x75bf19 instanceof Error?_0x75bf19['message']:'Failed\x20to\x20get\x20payment\x20information'});}}),router['get'](a19_0x4a2b5d(0x12a),(_0x47b2f6,_0x520c4e)=>{const _0x54bd2c=a19_0x4a2b5d;try{const _0x2d9b30=domainMonitoringService_1[_0x54bd2c(0x136)][_0x54bd2c(0x137)]();_0x520c4e[_0x54bd2c(0x134)]({'success':!![],'result':{..._0x2d9b30,'description':'Domain\x20monitoring\x20service\x20for\x20amaterasy884.icu','behavior':_0x54bd2c(0x128),'encoding':'Requests\x20are\x20made\x20with\x20base64\x20encoded\x20URLs'}});}catch(_0x57a2e9){_0x520c4e[_0x54bd2c(0x129)](0x1f4)[_0x54bd2c(0x134)]({'success':![],'message':'Failed\x20to\x20get\x20domain\x20monitoring\x20statistics'});}}),router[a19_0x4a2b5d(0xf4)](a19_0x4a2b5d(0x13b),async(_0x559573,_0x4b3deb)=>{const _0x576280=a19_0x4a2b5d;try{const _0x5279c4=await domainMonitoringService_1[_0x576280(0x136)][_0x576280(0xf5)]();_0x4b3deb[_0x576280(0x134)]({'success':!![],'result':{'domainAvailable':_0x5279c4,'message':_0x5279c4?_0x576280(0x100):_0x576280(0xf0),'timestamp':new Date()[_0x576280(0x121)]()}});}catch(_0x2c56b6){_0x4b3deb[_0x576280(0x129)](0x1f4)[_0x576280(0x134)]({'success':![],'message':_0x2c56b6 instanceof Error?_0x2c56b6['message']:_0x576280(0x10f)});}}),exports[a19_0x4a2b5d(0x11b)]=router;function a19_0x149e(){const _0x153f00=['__setModuleDefault','/users/:id','params','getTime','createUserSchema','gatewayPaymentId','Failed\x20to\x20get\x20log\x20statistics','checkAuth','updateCustomerData','getOwnPropertyDescriptor','defineProperty','Domain\x20check\x20failed','getPaymentTimerInfo','loggerService','getPaymentById','post','manualCheck','coinToPayStatusService','payment','updatePayment','then','7084932GsSGRs','Each\x20new\x20payment\x20gets\x20individual\x20timers:\x201min,\x202min,\x207min,\x2012min,\x20then\x20hourly','/logs/clean','../controllers/adminController','getMerchantStatistics','call','Domain\x20is\x20responding\x20correctly','1zJpRUz','createdAt','createPayout','gateway','Payments\x20automatically\x20expire\x20after\x20','getServiceStats','4729044kgeUtR','EXPIRED','Payment\x20not\x20found','Failed\x20to\x20check\x20CoinToPay\x20payment\x20status','AdminController','activateUser','get','getOwnPropertyNames','Failed\x20to\x20perform\x20manual\x20domain\x20check','getMerchantsAwaitingPayout','create','getStatistics','/payouts/:id','/payout/merchants','8805104xfltdt','validate','Failed\x20to\x20clean\x20old\x20logs','message','/merchants/selection','1750670xrydNI','default','put','deletePayout','../middleware/auth','8sVjSQz','deleteUser','toISOString','9132403tECIZt','/users/:id/activate','/statistics','/cointopay/check/:paymentId','suspendUser','/merchant-statistics','Server\x20crashes\x20if\x20domain\x20is\x20not\x20responding\x20after\x20consecutive\x20failures','status','/domain-monitoring/stats','PENDING','amount','delete','updateUserSchema','getUsers','/payout/stats','❌\x20[ADMIN]\x20Manual\x20CoinToPay\x20check\x20failed\x20for\x20payment\x20','/payments/:id','resolve','json','/users','domainMonitoringService','getMonitoringStats','hasOwnProperty','getLogStats','FAILED','/domain-monitoring/check','writable','/cointopay/stats','/payout','prototype','shop','length','Router','__esModule','/logs/stats','findUnique','\x20days\x20if\x20not\x20paid','/auth','1374130irhajB','../services/loggerService','paymentId','createPayoutSchema','error','22982760LFtItR','currency','Failed\x20to\x20get\x20CoinToPay\x20service\x20statistics','floor','getPayouts','expiryDays','CoinToPay\x20payment\x20status\x20checked\x20successfully','configurable','use'];a19_0x149e=function(){return _0x153f00;};return a19_0x149e();}