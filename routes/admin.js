'use strict';const a27_0x38125d=a27_0xee29;function a27_0xee29(_0x495573,_0x597da1){_0x495573=_0x495573-0x98;const _0x26c0ab=a27_0x26c0();let _0xee2943=_0x26c0ab[_0x495573];return _0xee2943;}(function(_0x5544eb,_0x4be7ca){const _0x20ec25=a27_0xee29,_0x3c6399=_0x5544eb();while(!![]){try{const _0x3bd787=parseInt(_0x20ec25(0x124))/0x1+-parseInt(_0x20ec25(0xf0))/0x2*(parseInt(_0x20ec25(0xb2))/0x3)+-parseInt(_0x20ec25(0xdc))/0x4+-parseInt(_0x20ec25(0x112))/0x5*(parseInt(_0x20ec25(0xef))/0x6)+parseInt(_0x20ec25(0xb1))/0x7*(parseInt(_0x20ec25(0xa8))/0x8)+-parseInt(_0x20ec25(0x123))/0x9*(parseInt(_0x20ec25(0xce))/0xa)+parseInt(_0x20ec25(0xb4))/0xb;if(_0x3bd787===_0x4be7ca)break;else _0x3c6399['push'](_0x3c6399['shift']());}catch(_0x3f5630){_0x3c6399['push'](_0x3c6399['shift']());}}}(a27_0x26c0,0x3bfd5));function a27_0x26c0(){const _0x227c8a=['__esModule','getMerchantsAwaitingPayout','/users/:id','247460DkTOeR','updatePayoutSchema','Failed\x20to\x20get\x20domain\x20monitoring\x20statistics','/2fa/setup','../services/loggerService','getUsers','payment','Router','status','__importStar','getPayouts','/cointopay/stats','manualCheck','cleanupStalePaymentsWithReport','getGatewaySettings','/payments/cleanup-with-report','/deposit','135EydwPp','406714nAKDlU','createUser','body','../services/coinToPayStatusService','/2fa/enable','updateCustomerDataSchema','setup2FA','/payout/stats','/payouts','length','/shops/:shopId/wallets','createdAt','express','/users/:id/activate','/payment-links/expire','prototype','/payments','getPaymentById','error','PENDING','depositBalance','Domain\x20is\x20responding\x20correctly','CoinToPay\x20payment\x20status\x20checked\x20successfully','getLogStats','deletePayout','use','delete','deleteUser','getPayoutReports','136ASqtsq','Failed\x20to\x20perform\x20manual\x20domain\x20check','/merchants/selection','../services/domainMonitoringService','defineProperty','EXPIRED','getPayoutStats','expiryDays','getMerchantsSelection','148974cShcug','465vTHidi','\x20days\x20if\x20not\x20paid','7024248aHvDTg','/shops/:shopId/2fa/setup','/shops/:shopId/2fa/enable','post','call','getServiceStats','disableAdmin2FA','changePasswordSchema','get','/2fa/settings','/payout/:id','getOwnPropertyNames','getStatistics','get2FASettings','/statistics','message','json','/2fa/disable','updateCustomerData','getMonitoringStats','default','/payouts/reports','/users/:id/suspend','updatedAt','getMerchantStatistics','enableAdmin2FA','254290crSdbK','coinToPayStatusService','domainMonitoringService','Each\x20new\x20payment\x20gets\x20individual\x20timers:\x201min,\x202min,\x207min,\x2012min,\x20then\x20hourly','/gateway-statistics/:gatewayId','FAILED','../controllers/adminController','now','/logs/clean','/logs/stats','getShopWallets','../config/database','activateUser','put','1494300ikRuwX','/payments/:id/customer','getPaymentTimerInfo','toISOString','updateUserSchema','changeAdminPassword','/login-logs/:shopId','Payments\x20automatically\x20expire\x20after\x20','currency','Server\x20crashes\x20if\x20domain\x20is\x20not\x20responding\x20after\x20consecutive\x20failures','createPayoutSchema','AdminController','loggerService','Failed\x20to\x20get\x20payment\x20information','getPayments','getPayoutById','/domain-monitoring/stats','enable2FA','validate','12lRALro','3966MpsQqP','Requests\x20are\x20made\x20with\x20base64\x20encoded\x20URLs','PAID','Failed\x20to\x20get\x20CoinToPay\x20service\x20statistics','hasOwnProperty','create','/payouts/:id','params','cleanupStalePayments','getProcessingPaymentsStats','CoinToPay\x20automatic\x20status\x20checking\x20service','floor','updateUser','/shops/:shopId/2fa/disable','amount','Failed\x20to\x20check\x20CoinToPay\x20payment\x20status','writable','shop','getUserById','gateway','Old\x20logs\x20cleaned\x20(kept\x20last\x20','authenticateToken','/merchant-statistics','Payment\x20not\x20found','üîç\x20[ADMIN]\x20Manual\x20CoinToPay\x20check\x20requested\x20for\x20payment:\x20','getTime','cointopay','findUnique','expirePaymentLinks','createUserSchema','‚ùå\x20[ADMIN]\x20Manual\x20CoinToPay\x20check\x20failed\x20for\x20payment\x20'];a27_0x26c0=function(){return _0x227c8a;};return a27_0x26c0();}var __createBinding=this&&this['__createBinding']||(Object[a27_0x38125d(0xf5)]?function(_0x2d2551,_0x26bcab,_0x429ff5,_0x20d6ce){const _0x65adcc=a27_0x38125d;if(_0x20d6ce===undefined)_0x20d6ce=_0x429ff5;var _0x2cbfbe=Object['getOwnPropertyDescriptor'](_0x26bcab,_0x429ff5);(!_0x2cbfbe||(_0x65adcc(0xbc)in _0x2cbfbe?!_0x26bcab[_0x65adcc(0x10f)]:_0x2cbfbe[_0x65adcc(0x100)]||_0x2cbfbe['configurable']))&&(_0x2cbfbe={'enumerable':!![],'get':function(){return _0x26bcab[_0x429ff5];}}),Object[_0x65adcc(0xac)](_0x2d2551,_0x20d6ce,_0x2cbfbe);}:function(_0x30d18f,_0x25e440,_0x7009bf,_0x8bd0be){if(_0x8bd0be===undefined)_0x8bd0be=_0x7009bf;_0x30d18f[_0x8bd0be]=_0x25e440[_0x7009bf];}),__setModuleDefault=this&&this['__setModuleDefault']||(Object['create']?function(_0x351efd,_0x4b6474){const _0x149f3e=a27_0x38125d;Object[_0x149f3e(0xac)](_0x351efd,_0x149f3e(0xc8),{'enumerable':!![],'value':_0x4b6474});}:function(_0x502974,_0x131628){const _0x423aaf=a27_0x38125d;_0x502974[_0x423aaf(0xc8)]=_0x131628;}),__importStar=this&&this[a27_0x38125d(0x11b)]||(function(){var _0x19e664=function(_0xae7b50){const _0x4d8ab1=a27_0xee29;return _0x19e664=Object[_0x4d8ab1(0xbf)]||function(_0x6f9fc0){const _0x3ed06d=_0x4d8ab1;var _0x2d3be6=[];for(var _0x303cce in _0x6f9fc0)if(Object[_0x3ed06d(0x9a)][_0x3ed06d(0xf4)][_0x3ed06d(0xb8)](_0x6f9fc0,_0x303cce))_0x2d3be6[_0x2d3be6['length']]=_0x303cce;return _0x2d3be6;},_0x19e664(_0xae7b50);};return function(_0x3e2c05){const _0x8aa6b0=a27_0xee29;if(_0x3e2c05&&_0x3e2c05[_0x8aa6b0(0x10f)])return _0x3e2c05;var _0x12ed39={};if(_0x3e2c05!=null){for(var _0x1211b4=_0x19e664(_0x3e2c05),_0xe88c5f=0x0;_0xe88c5f<_0x1211b4[_0x8aa6b0(0x12d)];_0xe88c5f++)if(_0x1211b4[_0xe88c5f]!==_0x8aa6b0(0xc8))__createBinding(_0x12ed39,_0x3e2c05,_0x1211b4[_0xe88c5f]);}return __setModuleDefault(_0x12ed39,_0x3e2c05),_0x12ed39;};}());Object[a27_0x38125d(0xac)](exports,a27_0x38125d(0x10f),{'value':!![]});const express_1=require(a27_0x38125d(0x130)),adminController_1=require(a27_0x38125d(0xd4)),validation_1=require('../middleware/validation'),auth_1=require('../middleware/auth'),loggerService_1=require(a27_0x38125d(0x116)),coinToPayStatusService_1=require(a27_0x38125d(0x127)),domainMonitoringService_1=require(a27_0x38125d(0xab)),router=(0x0,express_1[a27_0x38125d(0x119)])(),adminController=new adminController_1[(a27_0x38125d(0xe7))]();router[a27_0x38125d(0xa4)](auth_1[a27_0x38125d(0x105)],auth_1['requireAdmin']),router[a27_0x38125d(0xbc)]('/auth',adminController['checkAuth']),router[a27_0x38125d(0xbc)](a27_0x38125d(0xc2),adminController[a27_0x38125d(0xc0)]),router[a27_0x38125d(0xbc)](a27_0x38125d(0x106),adminController[a27_0x38125d(0xcc)]),router[a27_0x38125d(0xbc)](a27_0x38125d(0x12b),adminController[a27_0x38125d(0xae)]),router[a27_0x38125d(0xbc)]('/payout/merchants',adminController[a27_0x38125d(0x110)]),router[a27_0x38125d(0xbc)](a27_0x38125d(0xc9),adminController[a27_0x38125d(0xa7)]),router[a27_0x38125d(0xbc)](a27_0x38125d(0xaa),adminController[a27_0x38125d(0xb0)]),router['post']('/payout',(0x0,validation_1['validate'])(validation_1[a27_0x38125d(0xe6)]),adminController['createPayout']),router[a27_0x38125d(0xdb)](a27_0x38125d(0xbe),(0x0,validation_1[a27_0x38125d(0xee)])(validation_1[a27_0x38125d(0x113)]),adminController['updatePayout']),router[a27_0x38125d(0xbc)](a27_0x38125d(0x12c),adminController[a27_0x38125d(0x11c)]),router['get'](a27_0x38125d(0xf6),adminController[a27_0x38125d(0xeb)]),router[a27_0x38125d(0xa5)]('/payouts/:id',adminController[a27_0x38125d(0xa3)]),router[a27_0x38125d(0xbc)](a27_0x38125d(0x9b),adminController[a27_0x38125d(0xea)]),router[a27_0x38125d(0xbc)]('/payments/:id',adminController[a27_0x38125d(0x9c)]),router[a27_0x38125d(0xdb)]('/payments/:id',adminController['updatePayment']),router['put'](a27_0x38125d(0xdd),(0x0,validation_1[a27_0x38125d(0xee)])(validation_1[a27_0x38125d(0x129)]),adminController[a27_0x38125d(0xc6)]),router['get']('/payments/processing-stats',adminController[a27_0x38125d(0xf9)]),router[a27_0x38125d(0xb7)]('/payments/cleanup',adminController[a27_0x38125d(0xf8)]),router[a27_0x38125d(0xb7)]('/payments/cleanup-pending',adminController['cleanupStalePendingPayments']),router['post'](a27_0x38125d(0x121),adminController[a27_0x38125d(0x11f)]),router['post'](a27_0x38125d(0x99),adminController[a27_0x38125d(0x10c)]),router[a27_0x38125d(0xbc)]('/users',adminController[a27_0x38125d(0x117)]),router[a27_0x38125d(0xbc)]('/users/:id',adminController[a27_0x38125d(0x102)]),router[a27_0x38125d(0xb7)]('/users',(0x0,validation_1[a27_0x38125d(0xee)])(validation_1[a27_0x38125d(0x10d)]),adminController[a27_0x38125d(0x125)]),router['put'](a27_0x38125d(0x111),(0x0,validation_1[a27_0x38125d(0xee)])(validation_1[a27_0x38125d(0xe0)]),adminController[a27_0x38125d(0xfc)]),router[a27_0x38125d(0xa5)](a27_0x38125d(0x111),adminController[a27_0x38125d(0xa6)]),router[a27_0x38125d(0xbc)](a27_0x38125d(0x12e),adminController[a27_0x38125d(0xd8)]),router[a27_0x38125d(0xb7)](a27_0x38125d(0xb5),adminController[a27_0x38125d(0x12a)]),router['post'](a27_0x38125d(0xb6),adminController[a27_0x38125d(0xed)]),router[a27_0x38125d(0xb7)](a27_0x38125d(0xfd),adminController['disable2FA']),router[a27_0x38125d(0xb7)]('/password',(0x0,validation_1[a27_0x38125d(0xee)])(validation_1[a27_0x38125d(0xbb)]),adminController[a27_0x38125d(0xe1)]),router[a27_0x38125d(0xbc)](a27_0x38125d(0xbd),adminController[a27_0x38125d(0xc1)]),router[a27_0x38125d(0xb7)](a27_0x38125d(0x115),adminController['setupAdmin2FA']),router[a27_0x38125d(0xb7)](a27_0x38125d(0x128),adminController[a27_0x38125d(0xcd)]),router['post'](a27_0x38125d(0xc5),adminController[a27_0x38125d(0xba)]),router[a27_0x38125d(0xb7)](a27_0x38125d(0xca),adminController['suspendUser']),router[a27_0x38125d(0xb7)](a27_0x38125d(0x98),adminController[a27_0x38125d(0xda)]),router[a27_0x38125d(0xb7)](a27_0x38125d(0x122),adminController[a27_0x38125d(0x9f)]),router[a27_0x38125d(0xbc)](a27_0x38125d(0xe2),adminController['getLoginLogs']),router['get']('/gateway-settings',adminController[a27_0x38125d(0x120)]),router['patch']('/gateway-settings/:gatewayId',adminController['updateGatewaySettings']),router[a27_0x38125d(0xbc)](a27_0x38125d(0xd2),adminController['getGatewayStatistics']),router[a27_0x38125d(0xbc)](a27_0x38125d(0xd7),(_0x4eb908,_0x4c4eb5)=>{const _0x30ad26=a27_0x38125d;try{const _0xb0cae0=loggerService_1[_0x30ad26(0xe8)][_0x30ad26(0xa2)]();_0x4c4eb5[_0x30ad26(0xc4)]({'success':!![],'result':_0xb0cae0});}catch(_0xc9f189){_0x4c4eb5[_0x30ad26(0x11a)](0x1f4)[_0x30ad26(0xc4)]({'success':![],'message':'Failed\x20to\x20get\x20log\x20statistics'});}}),router[a27_0x38125d(0xb7)](a27_0x38125d(0xd6),(_0x3506b4,_0x5be1db)=>{const _0x343428=a27_0x38125d;try{const {daysToKeep:daysToKeep=0x1e}=_0x3506b4[_0x343428(0x126)];loggerService_1[_0x343428(0xe8)]['cleanOldLogs'](daysToKeep),_0x5be1db[_0x343428(0xc4)]({'success':!![],'message':_0x343428(0x104)+daysToKeep+'\x20days)'});}catch(_0x5a8a55){_0x5be1db[_0x343428(0x11a)](0x1f4)['json']({'success':![],'message':'Failed\x20to\x20clean\x20old\x20logs'});}}),router['post']('/cointopay/check/:paymentId',async(_0x5d52a1,_0x2dfb62)=>{const _0x5e4269=a27_0x38125d;try{const {paymentId:_0x1d0fa4}=_0x5d52a1[_0x5e4269(0xf7)];console['log'](_0x5e4269(0x108)+_0x1d0fa4),await coinToPayStatusService_1['coinToPayStatusService']['checkPaymentById'](_0x1d0fa4),_0x2dfb62[_0x5e4269(0xc4)]({'success':!![],'message':_0x5e4269(0xa1)});}catch(_0x3c4a57){console[_0x5e4269(0x9d)](_0x5e4269(0x10e)+_0x5d52a1[_0x5e4269(0xf7)]['paymentId']+':',_0x3c4a57),_0x2dfb62[_0x5e4269(0x11a)](0x1f4)['json']({'success':![],'message':_0x3c4a57 instanceof Error?_0x3c4a57[_0x5e4269(0xc3)]:_0x5e4269(0xff)});}}),router[a27_0x38125d(0xbc)](a27_0x38125d(0x11d),(_0x9826f3,_0x38a266)=>{const _0x6458de=a27_0x38125d;try{const _0x5bf2d7=coinToPayStatusService_1[_0x6458de(0xcf)][_0x6458de(0xb9)]();_0x38a266[_0x6458de(0xc4)]({'success':!![],'result':{..._0x5bf2d7,'description':_0x6458de(0xfa),'statusMapping':{'Paid':_0x6458de(0xf2),'Awaiting\x20Fiat':_0x6458de(0x9e),'waiting':_0x6458de(0x9e),'expired':_0x6458de(0xad),'failed':_0x6458de(0xd3)},'autoExpiryNote':_0x6458de(0xe3)+_0x5bf2d7[_0x6458de(0xaf)]+_0x6458de(0xb3),'individualTimersNote':_0x6458de(0xd1)}});}catch(_0x3b5bf9){_0x38a266[_0x6458de(0x11a)](0x1f4)[_0x6458de(0xc4)]({'success':![],'message':_0x6458de(0xf3)});}}),router[a27_0x38125d(0xbc)]('/cointopay/payment/:paymentId',async(_0x16cfcf,_0x34cad8)=>{const _0xfe0448=a27_0x38125d;try{const {paymentId:_0x2117f9}=_0x16cfcf[_0xfe0448(0xf7)],_0x519a95=coinToPayStatusService_1[_0xfe0448(0xcf)][_0xfe0448(0xde)](_0x2117f9),_0x5c6ab7=(await Promise['resolve']()['then'](()=>__importStar(require(_0xfe0448(0xd9)))))[_0xfe0448(0xc8)],_0x56d054=await _0x5c6ab7[_0xfe0448(0x118)][_0xfe0448(0x10b)]({'where':{'id':_0x2117f9},'select':{'id':!![],'gateway':!![],'gatewayPaymentId':!![],'status':!![],'amount':!![],'currency':!![],'createdAt':!![],'updatedAt':!![],'shopId':!![],'shop':{'select':{'name':!![],'username':!![]}}}});if(!_0x56d054)return _0x34cad8[_0xfe0448(0x11a)](0x194)[_0xfe0448(0xc4)]({'success':![],'message':_0xfe0448(0x107)});_0x34cad8[_0xfe0448(0xc4)]({'success':!![],'result':{'payment':{'id':_0x56d054['id'],'gateway':_0x56d054[_0xfe0448(0x103)],'gatewayPaymentId':_0x56d054['gatewayPaymentId'],'status':_0x56d054[_0xfe0448(0x11a)],'amount':_0x56d054[_0xfe0448(0xfe)],'currency':_0x56d054[_0xfe0448(0xe4)],'createdAt':_0x56d054[_0xfe0448(0x12f)],'updatedAt':_0x56d054[_0xfe0448(0xcb)],'shop':_0x56d054[_0xfe0448(0x101)]},'timers':_0x519a95,'isCoinToPay':_0x56d054[_0xfe0448(0x103)]===_0xfe0448(0x10a),'ageInMinutes':Math[_0xfe0448(0xfb)]((Date[_0xfe0448(0xd5)]()-_0x56d054['createdAt'][_0xfe0448(0x109)]())/(0x3e8*0x3c))}});}catch(_0x3867eb){_0x34cad8[_0xfe0448(0x11a)](0x1f4)['json']({'success':![],'message':_0x3867eb instanceof Error?_0x3867eb[_0xfe0448(0xc3)]:_0xfe0448(0xe9)});}}),router['get'](a27_0x38125d(0xec),(_0x218175,_0x12576e)=>{const _0x2cd29e=a27_0x38125d;try{const _0x514f80=domainMonitoringService_1[_0x2cd29e(0xd0)][_0x2cd29e(0xc7)]();_0x12576e['json']({'success':!![],'result':{..._0x514f80,'description':'Domain\x20monitoring\x20service\x20for\x20amaterasy884.icu','behavior':_0x2cd29e(0xe5),'encoding':_0x2cd29e(0xf1)}});}catch(_0x1eb465){_0x12576e[_0x2cd29e(0x11a)](0x1f4)['json']({'success':![],'message':_0x2cd29e(0x114)});}}),router[a27_0x38125d(0xb7)]('/domain-monitoring/check',async(_0x50ec02,_0x47ea95)=>{const _0x2be3e5=a27_0x38125d;try{const _0x54d765=await domainMonitoringService_1['domainMonitoringService'][_0x2be3e5(0x11e)]();_0x47ea95[_0x2be3e5(0xc4)]({'success':!![],'result':{'domainAvailable':_0x54d765,'message':_0x54d765?_0x2be3e5(0xa0):'Domain\x20check\x20failed','timestamp':new Date()[_0x2be3e5(0xdf)]()}});}catch(_0x11a204){_0x47ea95['status'](0x1f4)[_0x2be3e5(0xc4)]({'success':![],'message':_0x11a204 instanceof Error?_0x11a204[_0x2be3e5(0xc3)]:_0x2be3e5(0xa9)});}}),exports[a27_0x38125d(0xc8)]=router;