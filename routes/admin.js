'use strict';const a18_0x379044=a18_0x1fe0;function a18_0x1fe0(_0x2a2c43,_0xbe3ce4){const _0x420f54=a18_0x420f();return a18_0x1fe0=function(_0x1fe028,_0x222f46){_0x1fe028=_0x1fe028-0xe6;let _0x1e7f68=_0x420f54[_0x1fe028];return _0x1e7f68;},a18_0x1fe0(_0x2a2c43,_0xbe3ce4);}(function(_0x3ae826,_0x20ad5e){const _0x5f41a8=a18_0x1fe0,_0x3e7357=_0x3ae826();while(!![]){try{const _0x4bed4f=-parseInt(_0x5f41a8(0x147))/0x1+parseInt(_0x5f41a8(0x10a))/0x2+-parseInt(_0x5f41a8(0x100))/0x3+parseInt(_0x5f41a8(0x142))/0x4+parseInt(_0x5f41a8(0xf6))/0x5*(-parseInt(_0x5f41a8(0xfd))/0x6)+-parseInt(_0x5f41a8(0x127))/0x7*(parseInt(_0x5f41a8(0x115))/0x8)+-parseInt(_0x5f41a8(0xe7))/0x9*(-parseInt(_0x5f41a8(0x156))/0xa);if(_0x4bed4f===_0x20ad5e)break;else _0x3e7357['push'](_0x3e7357['shift']());}catch(_0x3ad632){_0x3e7357['push'](_0x3e7357['shift']());}}}(a18_0x420f,0x99d00));function a18_0x420f(){const _0x1bd824=['Server\x20crashes\x20if\x20domain\x20is\x20not\x20responding\x20after\x20consecutive\x20failures','9bsQpSU','Failed\x20to\x20check\x20CoinToPay\x20payment\x20status','Domain\x20is\x20responding\x20correctly','‚ùå\x20[ADMIN]\x20Manual\x20CoinToPay\x20check\x20failed\x20for\x20payment\x20','../services/loggerService','createUser','/statistics','error','writable','then','/payouts/:id','getOwnPropertyNames','updateUser','Failed\x20to\x20get\x20log\x20statistics','activateUser','60XhdYGg','getMerchantStatistics','/logs/clean','suspendUser','/users','Failed\x20to\x20clean\x20old\x20logs','/domain-monitoring/check','26526LXEewl','getOwnPropertyDescriptor','/users/:id','1851900AeumjG','put','/auth','length','Requests\x20are\x20made\x20with\x20base64\x20encoded\x20URLs','hasOwnProperty','authenticateToken','deletePayout','getUserById','../controllers/adminController','1291568KUpmhq','now','call','get','getUsers','delete','updateCustomerDataSchema','/payout/stats','json','updatePayment','message','24eWJvsJ','currency','paymentId','params','getMonitoringStats','manualCheck','AdminController','Domain\x20monitoring\x20service\x20for\x20amaterasy884.icu','toISOString','PENDING','../config/database','validate','/users/:id/suspend','post','__createBinding','/cointopay/payment/:paymentId','Old\x20logs\x20cleaned\x20(kept\x20last\x20','gateway','495698fsdTYS','body','Payment\x20not\x20found','default','FAILED','updateCustomerData','getLogStats','/cointopay/stats','/payout/merchants','cointopay','updateUserSchema','/users/:id/activate','Payments\x20automatically\x20expire\x20after\x20','expiryDays','findUnique','../services/domainMonitoringService','/payments','/payouts','status','createdAt','getPaymentTimerInfo','create','domainMonitoringService','defineProperty','coinToPayStatusService','__esModule','floor','2990228HQZKDO','loggerService','EXPIRED','\x20days)','Failed\x20to\x20get\x20domain\x20monitoring\x20statistics','639928FUWClx','/payments/:id','checkPaymentById','Failed\x20to\x20get\x20payment\x20information','../services/coinToPayStatusService','\x20days\x20if\x20not\x20paid','Failed\x20to\x20get\x20CoinToPay\x20service\x20statistics','../middleware/auth','getStatistics','createPayout','üîç\x20[ADMIN]\x20Manual\x20CoinToPay\x20check\x20requested\x20for\x20payment:\x20','/payments/:id/customer','Router','/merchant-statistics','__importStar','7593970onKkxB','/logs/stats','Domain\x20check\x20failed','checkAuth','getServiceStats','createUserSchema'];a18_0x420f=function(){return _0x1bd824;};return a18_0x420f();}var __createBinding=this&&this[a18_0x379044(0x123)]||(Object[a18_0x379044(0x13c)]?function(_0x438c10,_0x51e817,_0x4e1699,_0x5e348d){const _0xb228ac=a18_0x379044;if(_0x5e348d===undefined)_0x5e348d=_0x4e1699;var _0x2ec7ec=Object[_0xb228ac(0xfe)](_0x51e817,_0x4e1699);(!_0x2ec7ec||(_0xb228ac(0x10d)in _0x2ec7ec?!_0x51e817[_0xb228ac(0x140)]:_0x2ec7ec[_0xb228ac(0xef)]||_0x2ec7ec['configurable']))&&(_0x2ec7ec={'enumerable':!![],'get':function(){return _0x51e817[_0x4e1699];}}),Object['defineProperty'](_0x438c10,_0x5e348d,_0x2ec7ec);}:function(_0x31fd04,_0x10b14d,_0x4098b9,_0x5e532d){if(_0x5e532d===undefined)_0x5e532d=_0x4098b9;_0x31fd04[_0x5e532d]=_0x10b14d[_0x4098b9];}),__setModuleDefault=this&&this['__setModuleDefault']||(Object['create']?function(_0x1dd36d,_0x3b6c7f){const _0x21723e=a18_0x379044;Object[_0x21723e(0x13e)](_0x1dd36d,'default',{'enumerable':!![],'value':_0x3b6c7f});}:function(_0x1a2511,_0x3d9c38){const _0x39d1f7=a18_0x379044;_0x1a2511[_0x39d1f7(0x12a)]=_0x3d9c38;}),__importStar=this&&this[a18_0x379044(0x155)]||(function(){var _0x1b0533=function(_0x4a428c){const _0x553f28=a18_0x1fe0;return _0x1b0533=Object[_0x553f28(0xf2)]||function(_0x3476fe){const _0x51598d=_0x553f28;var _0x259ad8=[];for(var _0x2647f0 in _0x3476fe)if(Object['prototype'][_0x51598d(0x105)][_0x51598d(0x10c)](_0x3476fe,_0x2647f0))_0x259ad8[_0x259ad8[_0x51598d(0x103)]]=_0x2647f0;return _0x259ad8;},_0x1b0533(_0x4a428c);};return function(_0x5b6357){const _0x21b36b=a18_0x1fe0;if(_0x5b6357&&_0x5b6357[_0x21b36b(0x140)])return _0x5b6357;var _0x31c810={};if(_0x5b6357!=null){for(var _0x540db6=_0x1b0533(_0x5b6357),_0x473bbd=0x0;_0x473bbd<_0x540db6['length'];_0x473bbd++)if(_0x540db6[_0x473bbd]!==_0x21b36b(0x12a))__createBinding(_0x31c810,_0x5b6357,_0x540db6[_0x473bbd]);}return __setModuleDefault(_0x31c810,_0x5b6357),_0x31c810;};}());Object[a18_0x379044(0x13e)](exports,a18_0x379044(0x140),{'value':!![]});const express_1=require('express'),adminController_1=require(a18_0x379044(0x109)),validation_1=require('../middleware/validation'),auth_1=require(a18_0x379044(0x14e)),loggerService_1=require(a18_0x379044(0xeb)),coinToPayStatusService_1=require(a18_0x379044(0x14b)),domainMonitoringService_1=require(a18_0x379044(0x136)),router=(0x0,express_1[a18_0x379044(0x153)])(),adminController=new adminController_1[(a18_0x379044(0x11b))]();router['use'](auth_1[a18_0x379044(0x106)],auth_1['requireAdmin']),router[a18_0x379044(0x10d)](a18_0x379044(0x102),adminController[a18_0x379044(0x159)]),router['get'](a18_0x379044(0xed),adminController[a18_0x379044(0x14f)]),router[a18_0x379044(0x10d)](a18_0x379044(0x154),adminController[a18_0x379044(0xf7)]),router[a18_0x379044(0x10d)](a18_0x379044(0x111),adminController['getPayoutStats']),router['get'](a18_0x379044(0x12f),adminController['getMerchantsAwaitingPayout']),router[a18_0x379044(0x122)]('/payout',(0x0,validation_1['validate'])(validation_1['createPayoutSchema']),adminController[a18_0x379044(0x150)]),router[a18_0x379044(0x10d)](a18_0x379044(0x138),adminController['getPayouts']),router[a18_0x379044(0x10d)](a18_0x379044(0xf1),adminController['getPayoutById']),router[a18_0x379044(0x10f)](a18_0x379044(0xf1),adminController[a18_0x379044(0x107)]),router[a18_0x379044(0x10d)](a18_0x379044(0x137),adminController['getPayments']),router[a18_0x379044(0x10d)](a18_0x379044(0x148),adminController['getPaymentById']),router[a18_0x379044(0x101)](a18_0x379044(0x148),adminController[a18_0x379044(0x113)]),router[a18_0x379044(0x101)](a18_0x379044(0x152),(0x0,validation_1['validate'])(validation_1[a18_0x379044(0x110)]),adminController[a18_0x379044(0x12c)]),router['get'](a18_0x379044(0xfa),adminController[a18_0x379044(0x10e)]),router['get']('/users/:id',adminController[a18_0x379044(0x108)]),router['post'](a18_0x379044(0xfa),(0x0,validation_1[a18_0x379044(0x120)])(validation_1[a18_0x379044(0x15b)]),adminController[a18_0x379044(0xec)]),router[a18_0x379044(0x101)](a18_0x379044(0xff),(0x0,validation_1['validate'])(validation_1[a18_0x379044(0x131)]),adminController[a18_0x379044(0xf3)]),router['delete'](a18_0x379044(0xff),adminController['deleteUser']),router[a18_0x379044(0x122)](a18_0x379044(0x121),adminController[a18_0x379044(0xf9)]),router[a18_0x379044(0x122)](a18_0x379044(0x132),adminController[a18_0x379044(0xf5)]),router['get'](a18_0x379044(0x157),(_0x534451,_0x58a350)=>{const _0x3dc557=a18_0x379044;try{const _0x36ffdd=loggerService_1[_0x3dc557(0x143)][_0x3dc557(0x12d)]();_0x58a350[_0x3dc557(0x112)]({'success':!![],'result':_0x36ffdd});}catch(_0x510331){_0x58a350[_0x3dc557(0x139)](0x1f4)[_0x3dc557(0x112)]({'success':![],'message':_0x3dc557(0xf4)});}}),router[a18_0x379044(0x122)](a18_0x379044(0xf8),(_0x46f02f,_0x5211cc)=>{const _0x5d9538=a18_0x379044;try{const {daysToKeep:daysToKeep=0x1e}=_0x46f02f[_0x5d9538(0x128)];loggerService_1[_0x5d9538(0x143)]['cleanOldLogs'](daysToKeep),_0x5211cc[_0x5d9538(0x112)]({'success':!![],'message':_0x5d9538(0x125)+daysToKeep+_0x5d9538(0x145)});}catch(_0x13c893){_0x5211cc[_0x5d9538(0x139)](0x1f4)[_0x5d9538(0x112)]({'success':![],'message':_0x5d9538(0xfb)});}}),router[a18_0x379044(0x122)]('/cointopay/check/:paymentId',async(_0x156e33,_0x331a03)=>{const _0x2a12fe=a18_0x379044;try{const {paymentId:_0x176532}=_0x156e33[_0x2a12fe(0x118)];console['log'](_0x2a12fe(0x151)+_0x176532),await coinToPayStatusService_1[_0x2a12fe(0x13f)][_0x2a12fe(0x149)](_0x176532),_0x331a03[_0x2a12fe(0x112)]({'success':!![],'message':'CoinToPay\x20payment\x20status\x20checked\x20successfully'});}catch(_0x4de17a){console[_0x2a12fe(0xee)](_0x2a12fe(0xea)+_0x156e33[_0x2a12fe(0x118)][_0x2a12fe(0x117)]+':',_0x4de17a),_0x331a03[_0x2a12fe(0x139)](0x1f4)[_0x2a12fe(0x112)]({'success':![],'message':_0x4de17a instanceof Error?_0x4de17a[_0x2a12fe(0x114)]:_0x2a12fe(0xe8)});}}),router[a18_0x379044(0x10d)](a18_0x379044(0x12e),(_0x3b3341,_0x9b700b)=>{const _0x55daf0=a18_0x379044;try{const _0x1b5353=coinToPayStatusService_1['coinToPayStatusService'][_0x55daf0(0x15a)]();_0x9b700b[_0x55daf0(0x112)]({'success':!![],'result':{..._0x1b5353,'description':'CoinToPay\x20automatic\x20status\x20checking\x20service','statusMapping':{'Paid':'PAID','Awaiting\x20Fiat':_0x55daf0(0x11e),'waiting':'PENDING','expired':_0x55daf0(0x144),'failed':_0x55daf0(0x12b)},'autoExpiryNote':_0x55daf0(0x133)+_0x1b5353[_0x55daf0(0x134)]+_0x55daf0(0x14c),'individualTimersNote':'Each\x20new\x20payment\x20gets\x20individual\x20timers:\x201min,\x202min,\x207min,\x2012min,\x20then\x20hourly'}});}catch(_0x270543){_0x9b700b[_0x55daf0(0x139)](0x1f4)['json']({'success':![],'message':_0x55daf0(0x14d)});}}),router[a18_0x379044(0x10d)](a18_0x379044(0x124),async(_0x2b8049,_0x3891ab)=>{const _0x2f9db4=a18_0x379044;try{const {paymentId:_0x4c78df}=_0x2b8049['params'],_0x2efd01=coinToPayStatusService_1[_0x2f9db4(0x13f)][_0x2f9db4(0x13b)](_0x4c78df),_0x4e889e=(await Promise['resolve']()[_0x2f9db4(0xf0)](()=>__importStar(require(_0x2f9db4(0x11f)))))[_0x2f9db4(0x12a)],_0x1e6fc9=await _0x4e889e['payment'][_0x2f9db4(0x135)]({'where':{'id':_0x4c78df},'select':{'id':!![],'gateway':!![],'gatewayPaymentId':!![],'status':!![],'amount':!![],'currency':!![],'createdAt':!![],'updatedAt':!![],'shopId':!![],'shop':{'select':{'name':!![],'username':!![]}}}});if(!_0x1e6fc9)return _0x3891ab[_0x2f9db4(0x139)](0x194)[_0x2f9db4(0x112)]({'success':![],'message':_0x2f9db4(0x129)});_0x3891ab[_0x2f9db4(0x112)]({'success':!![],'result':{'payment':{'id':_0x1e6fc9['id'],'gateway':_0x1e6fc9[_0x2f9db4(0x126)],'gatewayPaymentId':_0x1e6fc9['gatewayPaymentId'],'status':_0x1e6fc9[_0x2f9db4(0x139)],'amount':_0x1e6fc9['amount'],'currency':_0x1e6fc9[_0x2f9db4(0x116)],'createdAt':_0x1e6fc9['createdAt'],'updatedAt':_0x1e6fc9['updatedAt'],'shop':_0x1e6fc9['shop']},'timers':_0x2efd01,'isCoinToPay':_0x1e6fc9['gateway']===_0x2f9db4(0x130),'ageInMinutes':Math[_0x2f9db4(0x141)]((Date[_0x2f9db4(0x10b)]()-_0x1e6fc9[_0x2f9db4(0x13a)]['getTime']())/(0x3e8*0x3c))}});}catch(_0x3542bc){_0x3891ab[_0x2f9db4(0x139)](0x1f4)['json']({'success':![],'message':_0x3542bc instanceof Error?_0x3542bc[_0x2f9db4(0x114)]:_0x2f9db4(0x14a)});}}),router[a18_0x379044(0x10d)]('/domain-monitoring/stats',(_0x544f50,_0x12c71f)=>{const _0x397659=a18_0x379044;try{const _0x4c736d=domainMonitoringService_1[_0x397659(0x13d)][_0x397659(0x119)]();_0x12c71f['json']({'success':!![],'result':{..._0x4c736d,'description':_0x397659(0x11c),'behavior':_0x397659(0xe6),'encoding':_0x397659(0x104)}});}catch(_0x2d6078){_0x12c71f[_0x397659(0x139)](0x1f4)[_0x397659(0x112)]({'success':![],'message':_0x397659(0x146)});}}),router[a18_0x379044(0x122)](a18_0x379044(0xfc),async(_0x4715ad,_0x25d8bd)=>{const _0x1b4e43=a18_0x379044;try{const _0x44939d=await domainMonitoringService_1[_0x1b4e43(0x13d)][_0x1b4e43(0x11a)]();_0x25d8bd[_0x1b4e43(0x112)]({'success':!![],'result':{'domainAvailable':_0x44939d,'message':_0x44939d?_0x1b4e43(0xe9):_0x1b4e43(0x158),'timestamp':new Date()[_0x1b4e43(0x11d)]()}});}catch(_0x3671ed){_0x25d8bd['status'](0x1f4)[_0x1b4e43(0x112)]({'success':![],'message':_0x3671ed instanceof Error?_0x3671ed[_0x1b4e43(0x114)]:'Failed\x20to\x20perform\x20manual\x20domain\x20check'});}}),exports[a18_0x379044(0x12a)]=router;