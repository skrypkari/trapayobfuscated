'use strict';function a19_0x48bd(_0x29cf75,_0x126a8c){const _0x57b536=a19_0x57b5();return a19_0x48bd=function(_0x48bd7a,_0x31eef){_0x48bd7a=_0x48bd7a-0x179;let _0x3961b4=_0x57b536[_0x48bd7a];return _0x3961b4;},a19_0x48bd(_0x29cf75,_0x126a8c);}const a19_0x332a7c=a19_0x48bd;(function(_0x4622b7,_0x316efa){const _0x3c5ce9=a19_0x48bd,_0x89e8a6=_0x4622b7();while(!![]){try{const _0x9df6e8=-parseInt(_0x3c5ce9(0x1e7))/0x1*(-parseInt(_0x3c5ce9(0x1a7))/0x2)+-parseInt(_0x3c5ce9(0x19a))/0x3*(-parseInt(_0x3c5ce9(0x1ab))/0x4)+parseInt(_0x3c5ce9(0x203))/0x5+parseInt(_0x3c5ce9(0x19f))/0x6+parseInt(_0x3c5ce9(0x1db))/0x7*(-parseInt(_0x3c5ce9(0x1b7))/0x8)+-parseInt(_0x3c5ce9(0x1d5))/0x9*(-parseInt(_0x3c5ce9(0x1d8))/0xa)+parseInt(_0x3c5ce9(0x1a6))/0xb*(-parseInt(_0x3c5ce9(0x183))/0xc);if(_0x9df6e8===_0x316efa)break;else _0x89e8a6['push'](_0x89e8a6['shift']());}catch(_0x49f45f){_0x89e8a6['push'](_0x89e8a6['shift']());}}}(a19_0x57b5,0x85785));var __createBinding=this&&this['__createBinding']||(Object['create']?function(_0x592b58,_0x217441,_0x55f6ef,_0x5a5cb3){const _0x19185c=a19_0x48bd;if(_0x5a5cb3===undefined)_0x5a5cb3=_0x55f6ef;var _0x3b31b3=Object['getOwnPropertyDescriptor'](_0x217441,_0x55f6ef);(!_0x3b31b3||(_0x19185c(0x1f9)in _0x3b31b3?!_0x217441[_0x19185c(0x1aa)]:_0x3b31b3[_0x19185c(0x1f8)]||_0x3b31b3[_0x19185c(0x1d4)]))&&(_0x3b31b3={'enumerable':!![],'get':function(){return _0x217441[_0x55f6ef];}}),Object['defineProperty'](_0x592b58,_0x5a5cb3,_0x3b31b3);}:function(_0x1f16b0,_0x1502f5,_0x2e9d04,_0x43f71d){if(_0x43f71d===undefined)_0x43f71d=_0x2e9d04;_0x1f16b0[_0x43f71d]=_0x1502f5[_0x2e9d04];}),__setModuleDefault=this&&this[a19_0x332a7c(0x1b3)]||(Object[a19_0x332a7c(0x1b6)]?function(_0xf4d34c,_0x382e56){const _0x24b7e2=a19_0x332a7c;Object[_0x24b7e2(0x1de)](_0xf4d34c,_0x24b7e2(0x1be),{'enumerable':!![],'value':_0x382e56});}:function(_0x22e7fc,_0x22a902){_0x22e7fc['default']=_0x22a902;}),__importStar=this&&this[a19_0x332a7c(0x1f3)]||(function(){var _0x1d27a9=function(_0x4f77c5){const _0x1fba5f=a19_0x48bd;return _0x1d27a9=Object[_0x1fba5f(0x188)]||function(_0x7ddfb5){const _0x2d321a=_0x1fba5f;var _0x532c19=[];for(var _0x3d80bc in _0x7ddfb5)if(Object[_0x2d321a(0x190)][_0x2d321a(0x191)][_0x2d321a(0x1a5)](_0x7ddfb5,_0x3d80bc))_0x532c19[_0x532c19[_0x2d321a(0x192)]]=_0x3d80bc;return _0x532c19;},_0x1d27a9(_0x4f77c5);};return function(_0x2349c1){const _0x3c34ab=a19_0x48bd;if(_0x2349c1&&_0x2349c1[_0x3c34ab(0x1aa)])return _0x2349c1;var _0x126aac={};if(_0x2349c1!=null){for(var _0x3e5da1=_0x1d27a9(_0x2349c1),_0x23ebb1=0x0;_0x23ebb1<_0x3e5da1[_0x3c34ab(0x192)];_0x23ebb1++)if(_0x3e5da1[_0x23ebb1]!=='default')__createBinding(_0x126aac,_0x2349c1,_0x3e5da1[_0x23ebb1]);}return __setModuleDefault(_0x126aac,_0x2349c1),_0x126aac;};}()),__importDefault=this&&this[a19_0x332a7c(0x1f1)]||function(_0xe599c3){const _0x2c7d4d=a19_0x332a7c;return _0xe599c3&&_0xe599c3[_0x2c7d4d(0x1aa)]?_0xe599c3:{'default':_0xe599c3};};Object[a19_0x332a7c(0x1de)](exports,a19_0x332a7c(0x1aa),{'value':!![]});function a19_0x57b5(){const _0x73e092=['/merchant-statistics','updatedAt','\x20minutes','1rbcMgd','cleanOldLogs','log','Router','getLogStats','payment','CoinToPay\x20automatic\x20status\x20checking\x20service','Rapyd\x20payment\x20status\x20checked\x20successfully','getUsers','getUserById','__importDefault','Payments\x20are\x20checked\x20after\x2030\x20minutes\x20and\x2060\x20minutes,\x20then\x20forgotten','__importStar','getServiceStats','Payments\x20automatically\x20expire\x20after\x20','/payments/:id','/users/:id','writable','get','/cointopay/check/:paymentId','then','updatePayment','message','updateCustomerData','getTime','deletePayout','createdAt','\x20days)','4869785gvDLvs','/users/:id/suspend','error','delete','/users/:id/activate','getStatistics','rapyd','\x20days\x20if\x20not\x20paid','Failed\x20to\x20check\x20CoinToPay\x20payment\x20status','/cointopay/stats','Requests\x20are\x20made\x20with\x20base64\x20encoded\x20URLs','PAID','/statistics','12kfBdvR','getMerchantStatistics','🔍\x20[ADMIN]\x20Manual\x20CoinToPay\x20check\x20requested\x20for\x20payment:\x20','/domain-monitoring/check','use','getOwnPropertyNames','Domain\x20monitoring\x20service\x20for\x20amaterasy884.icu','../services/coinToPayStatusService','floor','PENDING','Failed\x20to\x20clean\x20old\x20logs','getPaymentById','Failed\x20to\x20check\x20Rapyd\x20payment\x20status','prototype','hasOwnProperty','length','EXPIRED','requireAdmin','rapydStatusService','domainMonitoringService','post','Only\x20checks\x20payments\x20with\x20status\x20PENDING\x20at\x20check\x20time','updateCustomerDataSchema','75pGufte','paymentId','CoinToPay\x20payment\x20status\x20checked\x20successfully','status','../services/loggerService','5691870cGKPnG','updateUser','Failed\x20to\x20get\x20CoinToPay\x20service\x20statistics','getPaymentTimerInfo','/rapyd/stats','validate','call','33416031vLSOhm','1833212UxpHPm','Failed\x20to\x20perform\x20manual\x20domain\x20check','loggerService','__esModule','96996hpjkLG','put','/rapyd/payment/:paymentId','🔍\x20[ADMIN]\x20Manual\x20Rapyd\x20check\x20requested\x20for\x20payment:\x20','activateUser','❌\x20[ADMIN]\x20Manual\x20CoinToPay\x20check\x20failed\x20for\x20payment\x20','Rapyd\x20automatic\x20status\x20checking\x20service','toISOString','__setModuleDefault','gatewayPaymentId','Failed\x20to\x20get\x20Rapyd\x20service\x20statistics','create','56CKraqw','/users','AdminController','Failed\x20to\x20get\x20domain\x20monitoring\x20statistics','getPayoutStats','/payments','createPayout','default','coinToPayStatusService','createPayoutSchema','Failed\x20to\x20get\x20payment\x20information','getMonitoringStats','checkPaymentById','/auth','suspendUser','../middleware/auth','getPayoutById','params','FAILED','json','/payments/:id/customer','express','createUser','/merchants/selection','gateway','now','../middleware/validation','/payout/merchants','Domain\x20is\x20responding\x20correctly','configurable','72QAoEgI','expiryDays','manualCheck','671350NItQgM','/domain-monitoring/stats','../config/database','397999krXkNi','findUnique','No\x20checks\x20scheduled','defineProperty','/rapyd/check/:paymentId','resolve','shop','currency','getPayouts'];a19_0x57b5=function(){return _0x73e092;};return a19_0x57b5();}const express_1=require(a19_0x332a7c(0x1cc)),adminController_1=require('../controllers/adminController'),validation_1=require(a19_0x332a7c(0x1d1)),auth_1=require(a19_0x332a7c(0x1c6)),loggerService_1=require(a19_0x332a7c(0x19e)),coinToPayStatusService_1=require(a19_0x332a7c(0x18a)),rapydStatusService_1=require('../services/rapydStatusService'),domainMonitoringService_1=require('../services/domainMonitoringService'),database_1=__importDefault(require(a19_0x332a7c(0x1da))),router=(0x0,express_1[a19_0x332a7c(0x1ea)])(),adminController=new adminController_1[(a19_0x332a7c(0x1b9))]();router[a19_0x332a7c(0x187)](auth_1['authenticateToken'],auth_1[a19_0x332a7c(0x194)]),router['get'](a19_0x332a7c(0x1c4),adminController['checkAuth']),router[a19_0x332a7c(0x1f9)](a19_0x332a7c(0x182),adminController[a19_0x332a7c(0x17b)]),router[a19_0x332a7c(0x1f9)](a19_0x332a7c(0x1e4),adminController[a19_0x332a7c(0x184)]),router['get'](a19_0x332a7c(0x1ce),adminController['getMerchantsSelection']),router[a19_0x332a7c(0x1f9)]('/payout/stats',adminController[a19_0x332a7c(0x1bb)]),router[a19_0x332a7c(0x1f9)](a19_0x332a7c(0x1d2),adminController['getMerchantsAwaitingPayout']),router[a19_0x332a7c(0x197)]('/payout',(0x0,validation_1[a19_0x332a7c(0x1a4)])(validation_1[a19_0x332a7c(0x1c0)]),adminController[a19_0x332a7c(0x1bd)]),router['get']('/payouts',adminController[a19_0x332a7c(0x1e3)]),router[a19_0x332a7c(0x1f9)]('/payouts/:id',adminController[a19_0x332a7c(0x1c7)]),router['delete']('/payouts/:id',adminController[a19_0x332a7c(0x200)]),router[a19_0x332a7c(0x1f9)](a19_0x332a7c(0x1bc),adminController['getPayments']),router[a19_0x332a7c(0x1f9)](a19_0x332a7c(0x1f6),adminController[a19_0x332a7c(0x18e)]),router[a19_0x332a7c(0x1ac)](a19_0x332a7c(0x1f6),adminController[a19_0x332a7c(0x1fc)]),router[a19_0x332a7c(0x1ac)](a19_0x332a7c(0x1cb),(0x0,validation_1['validate'])(validation_1[a19_0x332a7c(0x199)]),adminController[a19_0x332a7c(0x1fe)]),router['get'](a19_0x332a7c(0x1b8),adminController[a19_0x332a7c(0x1ef)]),router['get'](a19_0x332a7c(0x1f7),adminController[a19_0x332a7c(0x1f0)]),router['post'](a19_0x332a7c(0x1b8),(0x0,validation_1[a19_0x332a7c(0x1a4)])(validation_1['createUserSchema']),adminController[a19_0x332a7c(0x1cd)]),router['put'](a19_0x332a7c(0x1f7),(0x0,validation_1[a19_0x332a7c(0x1a4)])(validation_1['updateUserSchema']),adminController[a19_0x332a7c(0x1a0)]),router[a19_0x332a7c(0x179)]('/users/:id',adminController['deleteUser']),router[a19_0x332a7c(0x197)](a19_0x332a7c(0x204),adminController[a19_0x332a7c(0x1c5)]),router[a19_0x332a7c(0x197)](a19_0x332a7c(0x17a),adminController[a19_0x332a7c(0x1af)]),router[a19_0x332a7c(0x1f9)]('/logs/stats',(_0x178e51,_0x21709d)=>{const _0x553941=a19_0x332a7c;try{const _0x27c040=loggerService_1[_0x553941(0x1a9)][_0x553941(0x1eb)]();_0x21709d[_0x553941(0x1ca)]({'success':!![],'result':_0x27c040});}catch(_0x1ddd1a){_0x21709d['status'](0x1f4)[_0x553941(0x1ca)]({'success':![],'message':'Failed\x20to\x20get\x20log\x20statistics'});}}),router[a19_0x332a7c(0x197)]('/logs/clean',(_0x1cc2da,_0x2c23c0)=>{const _0xca77d9=a19_0x332a7c;try{const {daysToKeep:daysToKeep=0x1e}=_0x1cc2da['body'];loggerService_1[_0xca77d9(0x1a9)][_0xca77d9(0x1e8)](daysToKeep),_0x2c23c0['json']({'success':!![],'message':'Old\x20logs\x20cleaned\x20(kept\x20last\x20'+daysToKeep+_0xca77d9(0x202)});}catch(_0x4d4ddd){_0x2c23c0[_0xca77d9(0x19d)](0x1f4)[_0xca77d9(0x1ca)]({'success':![],'message':_0xca77d9(0x18d)});}}),router[a19_0x332a7c(0x197)](a19_0x332a7c(0x1fa),async(_0x3aea2f,_0x3e6ed3)=>{const _0x338195=a19_0x332a7c;try{const {paymentId:_0x4723e0}=_0x3aea2f['params'];console[_0x338195(0x1e9)](_0x338195(0x185)+_0x4723e0),await coinToPayStatusService_1[_0x338195(0x1bf)][_0x338195(0x1c3)](_0x4723e0),_0x3e6ed3[_0x338195(0x1ca)]({'success':!![],'message':_0x338195(0x19c)});}catch(_0x5ad835){console[_0x338195(0x205)](_0x338195(0x1b0)+_0x3aea2f[_0x338195(0x1c8)][_0x338195(0x19b)]+':',_0x5ad835),_0x3e6ed3[_0x338195(0x19d)](0x1f4)[_0x338195(0x1ca)]({'success':![],'message':_0x5ad835 instanceof Error?_0x5ad835[_0x338195(0x1fd)]:_0x338195(0x17e)});}}),router['get'](a19_0x332a7c(0x17f),(_0x21f4f5,_0x13e129)=>{const _0x3b646d=a19_0x332a7c;try{const _0x118284=coinToPayStatusService_1[_0x3b646d(0x1bf)]['getServiceStats']();_0x13e129[_0x3b646d(0x1ca)]({'success':!![],'result':{..._0x118284,'description':_0x3b646d(0x1ed),'statusMapping':{'Paid':_0x3b646d(0x181),'Awaiting\x20Fiat':'PENDING','waiting':_0x3b646d(0x18c),'expired':_0x3b646d(0x193),'failed':_0x3b646d(0x1c9)},'autoExpiryNote':_0x3b646d(0x1f5)+_0x118284[_0x3b646d(0x1d6)]+_0x3b646d(0x17d),'individualTimersNote':'Each\x20new\x20payment\x20gets\x20individual\x20timers:\x201min,\x202min,\x207min,\x2012min,\x20then\x20hourly'}});}catch(_0x3143b1){_0x13e129[_0x3b646d(0x19d)](0x1f4)[_0x3b646d(0x1ca)]({'success':![],'message':_0x3b646d(0x1a1)});}}),router['get']('/cointopay/payment/:paymentId',async(_0x19991c,_0x5d1771)=>{const _0x5f2ff3=a19_0x332a7c;try{const {paymentId:_0x404b95}=_0x19991c[_0x5f2ff3(0x1c8)],_0x42e3a7=coinToPayStatusService_1[_0x5f2ff3(0x1bf)][_0x5f2ff3(0x1a2)](_0x404b95),_0x364416=(await Promise[_0x5f2ff3(0x1e0)]()[_0x5f2ff3(0x1fb)](()=>__importStar(require(_0x5f2ff3(0x1da)))))[_0x5f2ff3(0x1be)],_0x50ef9b=await _0x364416[_0x5f2ff3(0x1ec)][_0x5f2ff3(0x1dc)]({'where':{'id':_0x404b95},'select':{'id':!![],'gateway':!![],'gatewayPaymentId':!![],'status':!![],'amount':!![],'currency':!![],'createdAt':!![],'updatedAt':!![],'shopId':!![],'shop':{'select':{'name':!![],'username':!![]}}}});if(!_0x50ef9b)return _0x5d1771[_0x5f2ff3(0x19d)](0x194)[_0x5f2ff3(0x1ca)]({'success':![],'message':'Payment\x20not\x20found'});_0x5d1771['json']({'success':!![],'result':{'payment':{'id':_0x50ef9b['id'],'gateway':_0x50ef9b[_0x5f2ff3(0x1cf)],'gatewayPaymentId':_0x50ef9b[_0x5f2ff3(0x1b4)],'status':_0x50ef9b[_0x5f2ff3(0x19d)],'amount':_0x50ef9b['amount'],'currency':_0x50ef9b['currency'],'createdAt':_0x50ef9b['createdAt'],'updatedAt':_0x50ef9b[_0x5f2ff3(0x1e5)],'shop':_0x50ef9b['shop']},'timers':_0x42e3a7,'isCoinToPay':_0x50ef9b['gateway']==='cointopay','ageInMinutes':Math[_0x5f2ff3(0x18b)]((Date[_0x5f2ff3(0x1d0)]()-_0x50ef9b[_0x5f2ff3(0x201)][_0x5f2ff3(0x1ff)]())/(0x3e8*0x3c))}});}catch(_0x184d53){_0x5d1771['status'](0x1f4)[_0x5f2ff3(0x1ca)]({'success':![],'message':_0x184d53 instanceof Error?_0x184d53[_0x5f2ff3(0x1fd)]:_0x5f2ff3(0x1c1)});}}),router['post'](a19_0x332a7c(0x1df),async(_0x2f6d55,_0x318c76)=>{const _0x35e166=a19_0x332a7c;try{const {paymentId:_0x23d8b5}=_0x2f6d55['params'];console[_0x35e166(0x1e9)](_0x35e166(0x1ae)+_0x23d8b5),await rapydStatusService_1[_0x35e166(0x195)][_0x35e166(0x1c3)](_0x23d8b5),_0x318c76[_0x35e166(0x1ca)]({'success':!![],'message':_0x35e166(0x1ee)});}catch(_0x34a41d){console[_0x35e166(0x205)]('❌\x20[ADMIN]\x20Manual\x20Rapyd\x20check\x20failed\x20for\x20payment\x20'+_0x2f6d55[_0x35e166(0x1c8)][_0x35e166(0x19b)]+':',_0x34a41d),_0x318c76['status'](0x1f4)['json']({'success':![],'message':_0x34a41d instanceof Error?_0x34a41d[_0x35e166(0x1fd)]:_0x35e166(0x18f)});}}),router[a19_0x332a7c(0x1f9)](a19_0x332a7c(0x1a3),(_0x1a24c5,_0x346e0c)=>{const _0x359efd=a19_0x332a7c;try{const _0x3106f7=rapydStatusService_1[_0x359efd(0x195)][_0x359efd(0x1f4)]();_0x346e0c['json']({'success':!![],'result':{..._0x3106f7,'description':_0x359efd(0x1b1),'statusMapping':{'paid:\x20true':'PAID','paid:\x20false\x20+\x20CAN':_0x359efd(0x1c9),'paid:\x20false\x20+\x20ERR':_0x359efd(0x1c9),'paid:\x20false\x20+\x20EXP':'EXPIRED','paid:\x20false\x20+\x20other':_0x359efd(0x18c)},'checkSchedule':_0x359efd(0x1f2),'note':_0x359efd(0x198)}});}catch(_0xeffb09){_0x346e0c[_0x359efd(0x19d)](0x1f4)[_0x359efd(0x1ca)]({'success':![],'message':_0x359efd(0x1b5)});}}),router['get'](a19_0x332a7c(0x1ad),async(_0xa3346a,_0x4b8063)=>{const _0x15589e=a19_0x332a7c;try{const {paymentId:_0xf4ef5f}=_0xa3346a['params'],_0x21a2c9=await database_1['default'][_0x15589e(0x1ec)][_0x15589e(0x1dc)]({'where':{'id':_0xf4ef5f},'include':{'shop':{'select':{'id':!![],'name':!![],'username':!![]}}}});if(!_0x21a2c9)return _0x4b8063[_0x15589e(0x19d)](0x194)['json']({'success':![],'message':'Payment\x20not\x20found'});const _0xaf5d9d=rapydStatusService_1[_0x15589e(0x195)][_0x15589e(0x1a2)](_0xf4ef5f);_0x4b8063['json']({'success':!![],'result':{'payment':{'id':_0x21a2c9['id'],'gateway':_0x21a2c9[_0x15589e(0x1cf)],'gatewayPaymentId':_0x21a2c9['gatewayPaymentId'],'status':_0x21a2c9[_0x15589e(0x19d)],'amount':_0x21a2c9['amount'],'currency':_0x21a2c9[_0x15589e(0x1e2)],'createdAt':_0x21a2c9[_0x15589e(0x201)],'updatedAt':_0x21a2c9['updatedAt'],'shop':_0x21a2c9[_0x15589e(0x1e1)]},'timers':_0xaf5d9d,'isRapyd':_0x21a2c9[_0x15589e(0x1cf)]===_0x15589e(0x17c),'ageInMinutes':Math[_0x15589e(0x18b)]((Date['now']()-_0x21a2c9[_0x15589e(0x201)][_0x15589e(0x1ff)]())/(0x3e8*0x3c)),'nextCheck':_0xaf5d9d['hasTimers']?Math[_0x15589e(0x18b)]((Date[_0x15589e(0x1d0)]()-_0x21a2c9[_0x15589e(0x201)][_0x15589e(0x1ff)]())/(0x3e8*0x3c))<0x1e?0x1e-Math[_0x15589e(0x18b)]((Date[_0x15589e(0x1d0)]()-_0x21a2c9['createdAt']['getTime']())/(0x3e8*0x3c))+_0x15589e(0x1e6):Math[_0x15589e(0x18b)]((Date[_0x15589e(0x1d0)]()-_0x21a2c9[_0x15589e(0x201)][_0x15589e(0x1ff)]())/(0x3e8*0x3c))<0x3c?0x3c-Math[_0x15589e(0x18b)]((Date[_0x15589e(0x1d0)]()-_0x21a2c9['createdAt'][_0x15589e(0x1ff)]())/(0x3e8*0x3c))+'\x20minutes':'No\x20more\x20checks\x20scheduled':_0x15589e(0x1dd)}});}catch(_0x17a7f9){_0x4b8063['status'](0x1f4)[_0x15589e(0x1ca)]({'success':![],'message':_0x17a7f9 instanceof Error?_0x17a7f9[_0x15589e(0x1fd)]:'Failed\x20to\x20get\x20payment\x20information'});}}),router[a19_0x332a7c(0x1f9)](a19_0x332a7c(0x1d9),(_0xf207de,_0x39039a)=>{const _0x10282e=a19_0x332a7c;try{const _0x326910=domainMonitoringService_1[_0x10282e(0x196)][_0x10282e(0x1c2)]();_0x39039a[_0x10282e(0x1ca)]({'success':!![],'result':{..._0x326910,'description':_0x10282e(0x189),'behavior':'Server\x20crashes\x20if\x20domain\x20is\x20not\x20responding\x20after\x20consecutive\x20failures','encoding':_0x10282e(0x180)}});}catch(_0x4438a0){_0x39039a[_0x10282e(0x19d)](0x1f4)[_0x10282e(0x1ca)]({'success':![],'message':_0x10282e(0x1ba)});}}),router[a19_0x332a7c(0x197)](a19_0x332a7c(0x186),async(_0x168069,_0x180898)=>{const _0x324e0f=a19_0x332a7c;try{const _0x253dbb=await domainMonitoringService_1['domainMonitoringService'][_0x324e0f(0x1d7)]();_0x180898[_0x324e0f(0x1ca)]({'success':!![],'result':{'domainAvailable':_0x253dbb,'message':_0x253dbb?_0x324e0f(0x1d3):'Domain\x20check\x20failed','timestamp':new Date()[_0x324e0f(0x1b2)]()}});}catch(_0x28023e){_0x180898[_0x324e0f(0x19d)](0x1f4)[_0x324e0f(0x1ca)]({'success':![],'message':_0x28023e instanceof Error?_0x28023e['message']:_0x324e0f(0x1a8)});}}),exports[a19_0x332a7c(0x1be)]=router;