'use strict';function a25_0x358d(_0x31bfe3,_0x5ddd83){_0x31bfe3=_0x31bfe3-0x182;const _0x4baf75=a25_0x4baf();let _0x358d40=_0x4baf75[_0x31bfe3];return _0x358d40;}const a25_0x3e8e07=a25_0x358d;(function(_0x32e877,_0x3f02d5){const _0x414290=a25_0x358d,_0x1f86e6=_0x32e877();while(!![]){try{const _0x13ba16=parseInt(_0x414290(0x1d4))/0x1*(parseInt(_0x414290(0x1a5))/0x2)+-parseInt(_0x414290(0x202))/0x3*(-parseInt(_0x414290(0x205))/0x4)+parseInt(_0x414290(0x1cd))/0x5*(parseInt(_0x414290(0x195))/0x6)+-parseInt(_0x414290(0x1d7))/0x7+parseInt(_0x414290(0x1f2))/0x8+-parseInt(_0x414290(0x1a2))/0x9+parseInt(_0x414290(0x20d))/0xa*(-parseInt(_0x414290(0x1da))/0xb);if(_0x13ba16===_0x3f02d5)break;else _0x1f86e6['push'](_0x1f86e6['shift']());}catch(_0x39b489){_0x1f86e6['push'](_0x1f86e6['shift']());}}}(a25_0x4baf,0xe7b4c));var __createBinding=this&&this[a25_0x3e8e07(0x1be)]||(Object[a25_0x3e8e07(0x1e2)]?function(_0x3cdf7a,_0x36665c,_0x3840a9,_0xa4613c){const _0x4e32bf=a25_0x3e8e07;if(_0xa4613c===undefined)_0xa4613c=_0x3840a9;var _0x3ae2b9=Object[_0x4e32bf(0x1bd)](_0x36665c,_0x3840a9);(!_0x3ae2b9||('get'in _0x3ae2b9?!_0x36665c['__esModule']:_0x3ae2b9[_0x4e32bf(0x1fb)]||_0x3ae2b9['configurable']))&&(_0x3ae2b9={'enumerable':!![],'get':function(){return _0x36665c[_0x3840a9];}}),Object[_0x4e32bf(0x1d3)](_0x3cdf7a,_0xa4613c,_0x3ae2b9);}:function(_0x4f1828,_0x59a676,_0x4a50cc,_0x4c620b){if(_0x4c620b===undefined)_0x4c620b=_0x4a50cc;_0x4f1828[_0x4c620b]=_0x59a676[_0x4a50cc];}),__setModuleDefault=this&&this['__setModuleDefault']||(Object[a25_0x3e8e07(0x1e2)]?function(_0xf9fc9,_0x245c9b){Object['defineProperty'](_0xf9fc9,'default',{'enumerable':!![],'value':_0x245c9b});}:function(_0xdbc351,_0x57507e){_0xdbc351['default']=_0x57507e;}),__importStar=this&&this['__importStar']||(function(){var _0x4847f9=function(_0x573efe){return _0x4847f9=Object['getOwnPropertyNames']||function(_0x448d07){const _0x5e476a=a25_0x358d;var _0x39efe4=[];for(var _0x1d2d22 in _0x448d07)if(Object['prototype'][_0x5e476a(0x1c4)][_0x5e476a(0x1a3)](_0x448d07,_0x1d2d22))_0x39efe4[_0x39efe4[_0x5e476a(0x1fc)]]=_0x1d2d22;return _0x39efe4;},_0x4847f9(_0x573efe);};return function(_0x40ca8f){const _0x9e9d83=a25_0x358d;if(_0x40ca8f&&_0x40ca8f[_0x9e9d83(0x1e6)])return _0x40ca8f;var _0x5a5fe2={};if(_0x40ca8f!=null){for(var _0x8ca039=_0x4847f9(_0x40ca8f),_0x15efbc=0x0;_0x15efbc<_0x8ca039[_0x9e9d83(0x1fc)];_0x15efbc++)if(_0x8ca039[_0x15efbc]!==_0x9e9d83(0x1a6))__createBinding(_0x5a5fe2,_0x40ca8f,_0x8ca039[_0x15efbc]);}return __setModuleDefault(_0x5a5fe2,_0x40ca8f),_0x5a5fe2;};}());Object[a25_0x3e8e07(0x1d3)](exports,a25_0x3e8e07(0x1e6),{'value':!![]});function a25_0x4baf(){const _0x497eb5=['Failed\x20to\x20get\x20domain\x20monitoring\x20statistics','/payout','/shops/:shopId/wallets','../controllers/adminController','activateUser','Server\x20crashes\x20if\x20domain\x20is\x20not\x20responding\x20after\x20consecutive\x20failures','resolve','create','/merchants/selection','Each\x20new\x20payment\x20gets\x20individual\x20timers:\x201min,\x202min,\x207min,\x2012min,\x20then\x20hourly','Requests\x20are\x20made\x20with\x20base64\x20encoded\x20URLs','__esModule','use','/payout/stats','amount','getMerchantStatistics','getTime','CoinToPay\x20automatic\x20status\x20checking\x20service','cointopay','/payments/cleanup-pending','../middleware/validation','/statistics','\x20days\x20if\x20not\x20paid','14873896hluFtH','/2fa/enable','gateway','delete','Failed\x20to\x20check\x20CoinToPay\x20payment\x20status','createUserSchema','AdminController','/logs/stats','cleanupStalePaymentsWithReport','writable','length','express','/users/:id/activate','Domain\x20monitoring\x20service\x20for\x20amaterasy884.icu','updateCustomerDataSchema','setup2FA','84867Fcrybe','/2fa/settings','manualCheck','152jDeKGa','Failed\x20to\x20get\x20payment\x20information','getPayments','paymentId','Failed\x20to\x20get\x20CoinToPay\x20service\x20statistics','status','changeAdminPassword','expiryDays','220kChQQA','/shops/:shopId/2fa/enable','changePasswordSchema','log','/auth','enableAdmin2FA','PENDING','deleteUser','Payment\x20not\x20found','requireAdmin','/payouts/:id','/password','Router','updatePayoutSchema','/merchant-statistics','updatePayment','/shops/:shopId/2fa/disable','/shops/:shopId/2fa/setup','setupAdmin2FA','getMerchantsAwaitingPayout','66EIDbkz','cleanupStalePendingPayments','json','getUserById','cleanupStalePayments','cleanOldLogs','/payouts','get','getMonitoringStats','Domain\x20is\x20responding\x20correctly','/payments/processing-stats','ðŸ”\x20[ADMIN]\x20Manual\x20CoinToPay\x20check\x20requested\x20for\x20payment:\x20','CoinToPay\x20payment\x20status\x20checked\x20successfully','10183473WvDuph','call','getLogStats','10hjeyvu','default','EXPIRED','params','now','expirePaymentLinks','updatePayout','/payments/:id','../services/domainMonitoringService','/users','Old\x20logs\x20cleaned\x20(kept\x20last\x20','getPayouts','toISOString','shop','/users/:id/suspend','checkAuth','then','gatewayPaymentId','coinToPayStatusService','getUsers','get2FASettings','/domain-monitoring/stats','body','/users/:id','getOwnPropertyDescriptor','__createBinding','/payout/merchants','getShopWallets','PAID','/cointopay/check/:paymentId','getPaymentById','hasOwnProperty','checkPaymentById','post','Domain\x20check\x20failed','validate','/2fa/setup','enable2FA','FAILED','disableAdmin2FA','91235URDhfz','put','currency','suspendUser','updateUser','disable2FA','defineProperty','77233wnIvFp','createdAt','/2fa/disable','9635458Upvlyi','Failed\x20to\x20perform\x20manual\x20domain\x20check','/domain-monitoring/check','32021xNqmWS'];a25_0x4baf=function(){return _0x497eb5;};return a25_0x4baf();}const express_1=require(a25_0x3e8e07(0x1fd)),adminController_1=require(a25_0x3e8e07(0x1de)),validation_1=require(a25_0x3e8e07(0x1ef)),auth_1=require('../middleware/auth'),loggerService_1=require('../services/loggerService'),coinToPayStatusService_1=require('../services/coinToPayStatusService'),domainMonitoringService_1=require(a25_0x3e8e07(0x1ad)),router=(0x0,express_1[a25_0x3e8e07(0x18d)])(),adminController=new adminController_1[(a25_0x3e8e07(0x1f8))]();router[a25_0x3e8e07(0x1e7)](auth_1['authenticateToken'],auth_1[a25_0x3e8e07(0x18a)]),router['get'](a25_0x3e8e07(0x185),adminController[a25_0x3e8e07(0x1b4)]),router[a25_0x3e8e07(0x19c)](a25_0x3e8e07(0x1f0),adminController['getStatistics']),router[a25_0x3e8e07(0x19c)](a25_0x3e8e07(0x18f),adminController[a25_0x3e8e07(0x1ea)]),router[a25_0x3e8e07(0x19c)](a25_0x3e8e07(0x1e8),adminController['getPayoutStats']),router[a25_0x3e8e07(0x19c)](a25_0x3e8e07(0x1bf),adminController[a25_0x3e8e07(0x194)]),router[a25_0x3e8e07(0x19c)](a25_0x3e8e07(0x1e3),adminController['getMerchantsSelection']),router[a25_0x3e8e07(0x1c6)](a25_0x3e8e07(0x1dc),(0x0,validation_1[a25_0x3e8e07(0x1c8)])(validation_1['createPayoutSchema']),adminController['createPayout']),router[a25_0x3e8e07(0x1ce)]('/payout/:id',(0x0,validation_1[a25_0x3e8e07(0x1c8)])(validation_1[a25_0x3e8e07(0x18e)]),adminController[a25_0x3e8e07(0x1ab)]),router[a25_0x3e8e07(0x19c)](a25_0x3e8e07(0x19b),adminController[a25_0x3e8e07(0x1b0)]),router['get'](a25_0x3e8e07(0x18b),adminController['getPayoutById']),router[a25_0x3e8e07(0x1f5)](a25_0x3e8e07(0x18b),adminController['deletePayout']),router['get']('/payments',adminController[a25_0x3e8e07(0x207)]),router[a25_0x3e8e07(0x19c)](a25_0x3e8e07(0x1ac),adminController[a25_0x3e8e07(0x1c3)]),router[a25_0x3e8e07(0x1ce)](a25_0x3e8e07(0x1ac),adminController[a25_0x3e8e07(0x190)]),router[a25_0x3e8e07(0x1ce)]('/payments/:id/customer',(0x0,validation_1['validate'])(validation_1[a25_0x3e8e07(0x200)]),adminController['updateCustomerData']),router['get'](a25_0x3e8e07(0x19f),adminController['getProcessingPaymentsStats']),router['post']('/payments/cleanup',adminController[a25_0x3e8e07(0x199)]),router[a25_0x3e8e07(0x1c6)](a25_0x3e8e07(0x1ee),adminController[a25_0x3e8e07(0x196)]),router[a25_0x3e8e07(0x1c6)]('/payments/cleanup-with-report',adminController[a25_0x3e8e07(0x1fa)]),router[a25_0x3e8e07(0x1c6)]('/payment-links/expire',adminController[a25_0x3e8e07(0x1aa)]),router[a25_0x3e8e07(0x19c)](a25_0x3e8e07(0x1ae),adminController[a25_0x3e8e07(0x1b8)]),router[a25_0x3e8e07(0x19c)]('/users/:id',adminController[a25_0x3e8e07(0x198)]),router[a25_0x3e8e07(0x1c6)](a25_0x3e8e07(0x1ae),(0x0,validation_1[a25_0x3e8e07(0x1c8)])(validation_1[a25_0x3e8e07(0x1f7)]),adminController['createUser']),router[a25_0x3e8e07(0x1ce)]('/users/:id',(0x0,validation_1[a25_0x3e8e07(0x1c8)])(validation_1['updateUserSchema']),adminController[a25_0x3e8e07(0x1d1)]),router[a25_0x3e8e07(0x1f5)](a25_0x3e8e07(0x1bc),adminController[a25_0x3e8e07(0x188)]),router[a25_0x3e8e07(0x19c)](a25_0x3e8e07(0x1dd),adminController[a25_0x3e8e07(0x1c0)]),router['post'](a25_0x3e8e07(0x192),adminController[a25_0x3e8e07(0x201)]),router[a25_0x3e8e07(0x1c6)](a25_0x3e8e07(0x182),adminController[a25_0x3e8e07(0x1ca)]),router[a25_0x3e8e07(0x1c6)](a25_0x3e8e07(0x191),adminController[a25_0x3e8e07(0x1d2)]),router['post'](a25_0x3e8e07(0x18c),(0x0,validation_1['validate'])(validation_1[a25_0x3e8e07(0x183)]),adminController[a25_0x3e8e07(0x20b)]),router[a25_0x3e8e07(0x19c)](a25_0x3e8e07(0x203),adminController[a25_0x3e8e07(0x1b9)]),router[a25_0x3e8e07(0x1c6)](a25_0x3e8e07(0x1c9),adminController[a25_0x3e8e07(0x193)]),router[a25_0x3e8e07(0x1c6)](a25_0x3e8e07(0x1f3),adminController[a25_0x3e8e07(0x186)]),router['post'](a25_0x3e8e07(0x1d6),adminController[a25_0x3e8e07(0x1cc)]),router[a25_0x3e8e07(0x1c6)](a25_0x3e8e07(0x1b3),adminController[a25_0x3e8e07(0x1d0)]),router[a25_0x3e8e07(0x1c6)](a25_0x3e8e07(0x1fe),adminController[a25_0x3e8e07(0x1df)]),router[a25_0x3e8e07(0x19c)](a25_0x3e8e07(0x1f9),(_0x1c7c8b,_0x1788e3)=>{const _0x3aa48f=a25_0x3e8e07;try{const _0x2d0d42=loggerService_1['loggerService'][_0x3aa48f(0x1a4)]();_0x1788e3[_0x3aa48f(0x197)]({'success':!![],'result':_0x2d0d42});}catch(_0x2be179){_0x1788e3[_0x3aa48f(0x20a)](0x1f4)[_0x3aa48f(0x197)]({'success':![],'message':'Failed\x20to\x20get\x20log\x20statistics'});}}),router[a25_0x3e8e07(0x1c6)]('/logs/clean',(_0x3c994a,_0x2c0329)=>{const _0xdcd5c4=a25_0x3e8e07;try{const {daysToKeep:daysToKeep=0x1e}=_0x3c994a[_0xdcd5c4(0x1bb)];loggerService_1['loggerService'][_0xdcd5c4(0x19a)](daysToKeep),_0x2c0329[_0xdcd5c4(0x197)]({'success':!![],'message':_0xdcd5c4(0x1af)+daysToKeep+'\x20days)'});}catch(_0x39d035){_0x2c0329[_0xdcd5c4(0x20a)](0x1f4)[_0xdcd5c4(0x197)]({'success':![],'message':'Failed\x20to\x20clean\x20old\x20logs'});}}),router[a25_0x3e8e07(0x1c6)](a25_0x3e8e07(0x1c2),async(_0x3bcb95,_0x16030f)=>{const _0x30564d=a25_0x3e8e07;try{const {paymentId:_0x3148db}=_0x3bcb95['params'];console[_0x30564d(0x184)](_0x30564d(0x1a0)+_0x3148db),await coinToPayStatusService_1[_0x30564d(0x1b7)][_0x30564d(0x1c5)](_0x3148db),_0x16030f[_0x30564d(0x197)]({'success':!![],'message':_0x30564d(0x1a1)});}catch(_0x1808ea){console['error']('âŒ\x20[ADMIN]\x20Manual\x20CoinToPay\x20check\x20failed\x20for\x20payment\x20'+_0x3bcb95[_0x30564d(0x1a8)][_0x30564d(0x208)]+':',_0x1808ea),_0x16030f['status'](0x1f4)[_0x30564d(0x197)]({'success':![],'message':_0x1808ea instanceof Error?_0x1808ea['message']:_0x30564d(0x1f6)});}}),router['get']('/cointopay/stats',(_0x45051d,_0x37fe56)=>{const _0x5b2778=a25_0x3e8e07;try{const _0x1dc749=coinToPayStatusService_1[_0x5b2778(0x1b7)]['getServiceStats']();_0x37fe56[_0x5b2778(0x197)]({'success':!![],'result':{..._0x1dc749,'description':_0x5b2778(0x1ec),'statusMapping':{'Paid':_0x5b2778(0x1c1),'Awaiting\x20Fiat':'PENDING','waiting':_0x5b2778(0x187),'expired':_0x5b2778(0x1a7),'failed':_0x5b2778(0x1cb)},'autoExpiryNote':'Payments\x20automatically\x20expire\x20after\x20'+_0x1dc749[_0x5b2778(0x20c)]+_0x5b2778(0x1f1),'individualTimersNote':_0x5b2778(0x1e4)}});}catch(_0xeef808){_0x37fe56[_0x5b2778(0x20a)](0x1f4)[_0x5b2778(0x197)]({'success':![],'message':_0x5b2778(0x209)});}}),router[a25_0x3e8e07(0x19c)]('/cointopay/payment/:paymentId',async(_0x13639e,_0x477f78)=>{const _0x25ff12=a25_0x3e8e07;try{const {paymentId:_0x192e4a}=_0x13639e[_0x25ff12(0x1a8)],_0x13f726=coinToPayStatusService_1[_0x25ff12(0x1b7)]['getPaymentTimerInfo'](_0x192e4a),_0x190cc6=(await Promise[_0x25ff12(0x1e1)]()[_0x25ff12(0x1b5)](()=>__importStar(require('../config/database'))))[_0x25ff12(0x1a6)],_0x23746f=await _0x190cc6['payment']['findUnique']({'where':{'id':_0x192e4a},'select':{'id':!![],'gateway':!![],'gatewayPaymentId':!![],'status':!![],'amount':!![],'currency':!![],'createdAt':!![],'updatedAt':!![],'shopId':!![],'shop':{'select':{'name':!![],'username':!![]}}}});if(!_0x23746f)return _0x477f78['status'](0x194)[_0x25ff12(0x197)]({'success':![],'message':_0x25ff12(0x189)});_0x477f78[_0x25ff12(0x197)]({'success':!![],'result':{'payment':{'id':_0x23746f['id'],'gateway':_0x23746f[_0x25ff12(0x1f4)],'gatewayPaymentId':_0x23746f[_0x25ff12(0x1b6)],'status':_0x23746f[_0x25ff12(0x20a)],'amount':_0x23746f[_0x25ff12(0x1e9)],'currency':_0x23746f[_0x25ff12(0x1cf)],'createdAt':_0x23746f[_0x25ff12(0x1d5)],'updatedAt':_0x23746f['updatedAt'],'shop':_0x23746f[_0x25ff12(0x1b2)]},'timers':_0x13f726,'isCoinToPay':_0x23746f[_0x25ff12(0x1f4)]===_0x25ff12(0x1ed),'ageInMinutes':Math['floor']((Date[_0x25ff12(0x1a9)]()-_0x23746f[_0x25ff12(0x1d5)][_0x25ff12(0x1eb)]())/(0x3e8*0x3c))}});}catch(_0x2756d2){_0x477f78['status'](0x1f4)['json']({'success':![],'message':_0x2756d2 instanceof Error?_0x2756d2['message']:_0x25ff12(0x206)});}}),router['get'](a25_0x3e8e07(0x1ba),(_0x325278,_0x5d19b4)=>{const _0x433ef9=a25_0x3e8e07;try{const _0x9b3bf0=domainMonitoringService_1['domainMonitoringService'][_0x433ef9(0x19d)]();_0x5d19b4['json']({'success':!![],'result':{..._0x9b3bf0,'description':_0x433ef9(0x1ff),'behavior':_0x433ef9(0x1e0),'encoding':_0x433ef9(0x1e5)}});}catch(_0x2f13e4){_0x5d19b4[_0x433ef9(0x20a)](0x1f4)[_0x433ef9(0x197)]({'success':![],'message':_0x433ef9(0x1db)});}}),router['post'](a25_0x3e8e07(0x1d9),async(_0x3e8150,_0x40658e)=>{const _0x2ae795=a25_0x3e8e07;try{const _0x4e4bde=await domainMonitoringService_1['domainMonitoringService'][_0x2ae795(0x204)]();_0x40658e[_0x2ae795(0x197)]({'success':!![],'result':{'domainAvailable':_0x4e4bde,'message':_0x4e4bde?_0x2ae795(0x19e):_0x2ae795(0x1c7),'timestamp':new Date()[_0x2ae795(0x1b1)]()}});}catch(_0x4fd502){_0x40658e[_0x2ae795(0x20a)](0x1f4)[_0x2ae795(0x197)]({'success':![],'message':_0x4fd502 instanceof Error?_0x4fd502['message']:_0x2ae795(0x1d8)});}}),exports['default']=router;