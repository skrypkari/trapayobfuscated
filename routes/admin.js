'use strict';const a21_0x38c65d=a21_0x15e7;(function(_0x16cacd,_0x4c2822){const _0x420fc6=a21_0x15e7,_0x3bd801=_0x16cacd();while(!![]){try{const _0x152bd3=-parseInt(_0x420fc6(0x108))/0x1*(-parseInt(_0x420fc6(0x16d))/0x2)+-parseInt(_0x420fc6(0x16c))/0x3*(-parseInt(_0x420fc6(0x149))/0x4)+parseInt(_0x420fc6(0x16b))/0x5+parseInt(_0x420fc6(0x11c))/0x6*(-parseInt(_0x420fc6(0x12d))/0x7)+-parseInt(_0x420fc6(0x15f))/0x8*(parseInt(_0x420fc6(0x130))/0x9)+-parseInt(_0x420fc6(0x110))/0xa+parseInt(_0x420fc6(0x113))/0xb;if(_0x152bd3===_0x4c2822)break;else _0x3bd801['push'](_0x3bd801['shift']());}catch(_0x4bf1b9){_0x3bd801['push'](_0x3bd801['shift']());}}}(a21_0x19e4,0xaf9e0));function a21_0x15e7(_0xf4b41b,_0x26e0ae){const _0x19e454=a21_0x19e4();return a21_0x15e7=function(_0x15e759,_0x66f7b1){_0x15e759=_0x15e759-0xf5;let _0x5b3085=_0x19e454[_0x15e759];return _0x5b3085;},a21_0x15e7(_0xf4b41b,_0x26e0ae);}var __createBinding=this&&this[a21_0x38c65d(0x11f)]||(Object[a21_0x38c65d(0xfa)]?function(_0x4a5447,_0x579b2a,_0x2bee6f,_0x1e014a){const _0x11bcc1=a21_0x38c65d;if(_0x1e014a===undefined)_0x1e014a=_0x2bee6f;var _0x438209=Object[_0x11bcc1(0x148)](_0x579b2a,_0x2bee6f);(!_0x438209||('get'in _0x438209?!_0x579b2a[_0x11bcc1(0x14c)]:_0x438209[_0x11bcc1(0xfc)]||_0x438209['configurable']))&&(_0x438209={'enumerable':!![],'get':function(){return _0x579b2a[_0x2bee6f];}}),Object[_0x11bcc1(0x11a)](_0x4a5447,_0x1e014a,_0x438209);}:function(_0x562538,_0x3a056d,_0x12fc9c,_0x3d3199){if(_0x3d3199===undefined)_0x3d3199=_0x12fc9c;_0x562538[_0x3d3199]=_0x3a056d[_0x12fc9c];}),__setModuleDefault=this&&this[a21_0x38c65d(0x169)]||(Object[a21_0x38c65d(0xfa)]?function(_0xc635b0,_0x52dcc7){const _0x26368f=a21_0x38c65d;Object['defineProperty'](_0xc635b0,_0x26368f(0x164),{'enumerable':!![],'value':_0x52dcc7});}:function(_0x39c38b,_0x46eae2){_0x39c38b['default']=_0x46eae2;}),__importStar=this&&this[a21_0x38c65d(0x174)]||(function(){var _0x46c012=function(_0x155027){const _0x275f0d=a21_0x15e7;return _0x46c012=Object[_0x275f0d(0xf9)]||function(_0x124fba){const _0x3af1a4=_0x275f0d;var _0x4c6142=[];for(var _0x5b7461 in _0x124fba)if(Object[_0x3af1a4(0x15c)][_0x3af1a4(0x12c)][_0x3af1a4(0xf7)](_0x124fba,_0x5b7461))_0x4c6142[_0x4c6142['length']]=_0x5b7461;return _0x4c6142;},_0x46c012(_0x155027);};return function(_0x3d4fe2){const _0x3a154d=a21_0x15e7;if(_0x3d4fe2&&_0x3d4fe2[_0x3a154d(0x14c)])return _0x3d4fe2;var _0x239c7b={};if(_0x3d4fe2!=null){for(var _0x2e5adf=_0x46c012(_0x3d4fe2),_0x1a95df=0x0;_0x1a95df<_0x2e5adf[_0x3a154d(0x11e)];_0x1a95df++)if(_0x2e5adf[_0x1a95df]!==_0x3a154d(0x164))__createBinding(_0x239c7b,_0x3d4fe2,_0x2e5adf[_0x1a95df]);}return __setModuleDefault(_0x239c7b,_0x3d4fe2),_0x239c7b;};}());Object['defineProperty'](exports,'__esModule',{'value':!![]});function a21_0x19e4(){const _0x4817ba=['CoinToPay\x20automatic\x20status\x20checking\x20service','../middleware/validation','cointopay','payment','prototype','resolve','/users/:id','40uNDYYB','toISOString','express','get','getTime','default','/users/:id/suspend','now','../config/database','/payout/stats','__setModuleDefault','createUserSchema','931665jJtClL','669PIPWeG','14qlqUJL','/payout/merchants','PENDING','suspendUser','AdminController','Failed\x20to\x20get\x20log\x20statistics','authenticateToken','__importStar','body','/payments/cleanup','getStatistics','../services/domainMonitoringService','coinToPayStatusService','updatedAt','then','/cointopay/stats','Failed\x20to\x20clean\x20old\x20logs','call','CoinToPay\x20payment\x20status\x20checked\x20successfully','getOwnPropertyNames','create','/domain-monitoring/stats','writable','getPayoutStats','getServiceStats','cleanOldLogs','Failed\x20to\x20check\x20CoinToPay\x20payment\x20status','floor','EXPIRED','/domain-monitoring/check','requireAdmin','getPayouts','Payments\x20automatically\x20expire\x20after\x20','updateCustomerDataSchema','150519fogRTa','Payment\x20not\x20found','üîç\x20[ADMIN]\x20Manual\x20CoinToPay\x20check\x20requested\x20for\x20payment:\x20','getUserById','domainMonitoringService','log','getMerchantStatistics','updatePayment','8867980PqQHQP','Requests\x20are\x20made\x20with\x20base64\x20encoded\x20URLs','cleanupStalePaymentsWithReport','5771821aPQrco','/payments/:id','/payments/processing-stats','getMonitoringStats','createPayoutSchema','/statistics','/merchants/selection','defineProperty','Domain\x20monitoring\x20service\x20for\x20amaterasy884.icu','269238gdqcXn','\x20days)','length','__createBinding','message','/payments','/users/:id/activate','/payments/:id/customer','/payments/cleanup-with-report','validate','createUser','/merchant-statistics','params','Old\x20logs\x20cleaned\x20(kept\x20last\x20','getPayments','cleanupStalePayments','hasOwnProperty','35HdaLTB','/users','FAILED','2259027lvrBMe','/payments/cleanup-pending','Router','Failed\x20to\x20get\x20domain\x20monitoring\x20statistics','getUsers','post','getMerchantsAwaitingPayout','getPayoutById','updateCustomerData','../middleware/auth','Failed\x20to\x20get\x20payment\x20information','put','createdAt','manualCheck','activateUser','/auth','checkPaymentById','delete','amount','gateway','getPaymentById','\x20days\x20if\x20not\x20paid','status','../controllers/adminController','getOwnPropertyDescriptor','23692KwIqaJ','json','getProcessingPaymentsStats','__esModule','Failed\x20to\x20get\x20CoinToPay\x20service\x20statistics','deleteUser','/logs/clean','Server\x20crashes\x20if\x20domain\x20is\x20not\x20responding\x20after\x20consecutive\x20failures','getPaymentTimerInfo','/payout','use','cleanupStalePendingPayments','checkAuth','createPayout','paymentId'];a21_0x19e4=function(){return _0x4817ba;};return a21_0x19e4();}const express_1=require(a21_0x38c65d(0x161)),adminController_1=require(a21_0x38c65d(0x147)),validation_1=require(a21_0x38c65d(0x159)),auth_1=require(a21_0x38c65d(0x139)),loggerService_1=require('../services/loggerService'),coinToPayStatusService_1=require('../services/coinToPayStatusService'),domainMonitoringService_1=require(a21_0x38c65d(0x178)),router=(0x0,express_1[a21_0x38c65d(0x132)])(),adminController=new adminController_1[(a21_0x38c65d(0x171))]();router[a21_0x38c65d(0x153)](auth_1[a21_0x38c65d(0x173)],auth_1[a21_0x38c65d(0x104)]),router[a21_0x38c65d(0x162)](a21_0x38c65d(0x13f),adminController[a21_0x38c65d(0x155)]),router[a21_0x38c65d(0x162)](a21_0x38c65d(0x118),adminController[a21_0x38c65d(0x177)]),router[a21_0x38c65d(0x162)](a21_0x38c65d(0x127),adminController[a21_0x38c65d(0x10e)]),router[a21_0x38c65d(0x162)](a21_0x38c65d(0x168),adminController[a21_0x38c65d(0xfd)]),router['get'](a21_0x38c65d(0x16e),adminController[a21_0x38c65d(0x136)]),router[a21_0x38c65d(0x162)](a21_0x38c65d(0x119),adminController['getMerchantsSelection']),router[a21_0x38c65d(0x135)](a21_0x38c65d(0x152),(0x0,validation_1[a21_0x38c65d(0x125)])(validation_1[a21_0x38c65d(0x117)]),adminController[a21_0x38c65d(0x156)]),router[a21_0x38c65d(0x162)]('/payouts',adminController[a21_0x38c65d(0x105)]),router['get']('/payouts/:id',adminController[a21_0x38c65d(0x137)]),router[a21_0x38c65d(0x141)]('/payouts/:id',adminController['deletePayout']),router[a21_0x38c65d(0x162)](a21_0x38c65d(0x121),adminController[a21_0x38c65d(0x12a)]),router[a21_0x38c65d(0x162)](a21_0x38c65d(0x114),adminController[a21_0x38c65d(0x144)]),router[a21_0x38c65d(0x13b)](a21_0x38c65d(0x114),adminController[a21_0x38c65d(0x10f)]),router[a21_0x38c65d(0x13b)](a21_0x38c65d(0x123),(0x0,validation_1[a21_0x38c65d(0x125)])(validation_1[a21_0x38c65d(0x107)]),adminController[a21_0x38c65d(0x138)]),router['get'](a21_0x38c65d(0x115),adminController[a21_0x38c65d(0x14b)]),router[a21_0x38c65d(0x135)](a21_0x38c65d(0x176),adminController[a21_0x38c65d(0x12b)]),router[a21_0x38c65d(0x135)](a21_0x38c65d(0x131),adminController[a21_0x38c65d(0x154)]),router[a21_0x38c65d(0x135)](a21_0x38c65d(0x124),adminController[a21_0x38c65d(0x112)]),router['get']('/users',adminController[a21_0x38c65d(0x134)]),router['get'](a21_0x38c65d(0x15e),adminController[a21_0x38c65d(0x10b)]),router['post'](a21_0x38c65d(0x12e),(0x0,validation_1['validate'])(validation_1[a21_0x38c65d(0x16a)]),adminController[a21_0x38c65d(0x126)]),router[a21_0x38c65d(0x13b)]('/users/:id',(0x0,validation_1[a21_0x38c65d(0x125)])(validation_1['updateUserSchema']),adminController['updateUser']),router[a21_0x38c65d(0x141)]('/users/:id',adminController[a21_0x38c65d(0x14e)]),router['post'](a21_0x38c65d(0x165),adminController[a21_0x38c65d(0x170)]),router[a21_0x38c65d(0x135)](a21_0x38c65d(0x122),adminController[a21_0x38c65d(0x13e)]),router[a21_0x38c65d(0x162)]('/logs/stats',(_0x5dd8d4,_0x2f9b83)=>{const _0x3fc137=a21_0x38c65d;try{const _0x208565=loggerService_1['loggerService']['getLogStats']();_0x2f9b83[_0x3fc137(0x14a)]({'success':!![],'result':_0x208565});}catch(_0x3ffcca){_0x2f9b83['status'](0x1f4)[_0x3fc137(0x14a)]({'success':![],'message':_0x3fc137(0x172)});}}),router[a21_0x38c65d(0x135)](a21_0x38c65d(0x14f),(_0x5f1b68,_0x1e7ec4)=>{const _0x3cff6c=a21_0x38c65d;try{const {daysToKeep:daysToKeep=0x1e}=_0x5f1b68[_0x3cff6c(0x175)];loggerService_1['loggerService'][_0x3cff6c(0xff)](daysToKeep),_0x1e7ec4['json']({'success':!![],'message':_0x3cff6c(0x129)+daysToKeep+_0x3cff6c(0x11d)});}catch(_0x398bf5){_0x1e7ec4[_0x3cff6c(0x146)](0x1f4)[_0x3cff6c(0x14a)]({'success':![],'message':_0x3cff6c(0xf6)});}}),router['post']('/cointopay/check/:paymentId',async(_0x16cf1c,_0x521944)=>{const _0x23d1e0=a21_0x38c65d;try{const {paymentId:_0x104427}=_0x16cf1c[_0x23d1e0(0x128)];console[_0x23d1e0(0x10d)](_0x23d1e0(0x10a)+_0x104427),await coinToPayStatusService_1[_0x23d1e0(0x179)][_0x23d1e0(0x140)](_0x104427),_0x521944[_0x23d1e0(0x14a)]({'success':!![],'message':_0x23d1e0(0xf8)});}catch(_0x500d90){console['error']('‚ùå\x20[ADMIN]\x20Manual\x20CoinToPay\x20check\x20failed\x20for\x20payment\x20'+_0x16cf1c['params'][_0x23d1e0(0x157)]+':',_0x500d90),_0x521944[_0x23d1e0(0x146)](0x1f4)[_0x23d1e0(0x14a)]({'success':![],'message':_0x500d90 instanceof Error?_0x500d90[_0x23d1e0(0x120)]:_0x23d1e0(0x100)});}}),router['get'](a21_0x38c65d(0xf5),(_0xac959,_0x1a9842)=>{const _0x26c866=a21_0x38c65d;try{const _0x3a9f88=coinToPayStatusService_1[_0x26c866(0x179)][_0x26c866(0xfe)]();_0x1a9842[_0x26c866(0x14a)]({'success':!![],'result':{..._0x3a9f88,'description':_0x26c866(0x158),'statusMapping':{'Paid':'PAID','Awaiting\x20Fiat':'PENDING','waiting':_0x26c866(0x16f),'expired':_0x26c866(0x102),'failed':_0x26c866(0x12f)},'autoExpiryNote':_0x26c866(0x106)+_0x3a9f88['expiryDays']+_0x26c866(0x145),'individualTimersNote':'Each\x20new\x20payment\x20gets\x20individual\x20timers:\x201min,\x202min,\x207min,\x2012min,\x20then\x20hourly'}});}catch(_0x17226a){_0x1a9842[_0x26c866(0x146)](0x1f4)['json']({'success':![],'message':_0x26c866(0x14d)});}}),router[a21_0x38c65d(0x162)]('/cointopay/payment/:paymentId',async(_0x4e9e0d,_0x519969)=>{const _0x52c0e0=a21_0x38c65d;try{const {paymentId:_0x24909f}=_0x4e9e0d['params'],_0x1c7eb1=coinToPayStatusService_1[_0x52c0e0(0x179)][_0x52c0e0(0x151)](_0x24909f),_0xa63988=(await Promise[_0x52c0e0(0x15d)]()[_0x52c0e0(0x17b)](()=>__importStar(require(_0x52c0e0(0x167)))))[_0x52c0e0(0x164)],_0x51f15a=await _0xa63988[_0x52c0e0(0x15b)]['findUnique']({'where':{'id':_0x24909f},'select':{'id':!![],'gateway':!![],'gatewayPaymentId':!![],'status':!![],'amount':!![],'currency':!![],'createdAt':!![],'updatedAt':!![],'shopId':!![],'shop':{'select':{'name':!![],'username':!![]}}}});if(!_0x51f15a)return _0x519969[_0x52c0e0(0x146)](0x194)[_0x52c0e0(0x14a)]({'success':![],'message':_0x52c0e0(0x109)});_0x519969['json']({'success':!![],'result':{'payment':{'id':_0x51f15a['id'],'gateway':_0x51f15a[_0x52c0e0(0x143)],'gatewayPaymentId':_0x51f15a['gatewayPaymentId'],'status':_0x51f15a[_0x52c0e0(0x146)],'amount':_0x51f15a[_0x52c0e0(0x142)],'currency':_0x51f15a['currency'],'createdAt':_0x51f15a[_0x52c0e0(0x13c)],'updatedAt':_0x51f15a[_0x52c0e0(0x17a)],'shop':_0x51f15a['shop']},'timers':_0x1c7eb1,'isCoinToPay':_0x51f15a['gateway']===_0x52c0e0(0x15a),'ageInMinutes':Math[_0x52c0e0(0x101)]((Date[_0x52c0e0(0x166)]()-_0x51f15a[_0x52c0e0(0x13c)][_0x52c0e0(0x163)]())/(0x3e8*0x3c))}});}catch(_0xf72749){_0x519969['status'](0x1f4)[_0x52c0e0(0x14a)]({'success':![],'message':_0xf72749 instanceof Error?_0xf72749[_0x52c0e0(0x120)]:_0x52c0e0(0x13a)});}}),router[a21_0x38c65d(0x162)](a21_0x38c65d(0xfb),(_0x18d783,_0xd2cec7)=>{const _0x47a677=a21_0x38c65d;try{const _0x3f3689=domainMonitoringService_1[_0x47a677(0x10c)][_0x47a677(0x116)]();_0xd2cec7[_0x47a677(0x14a)]({'success':!![],'result':{..._0x3f3689,'description':_0x47a677(0x11b),'behavior':_0x47a677(0x150),'encoding':_0x47a677(0x111)}});}catch(_0x294fd9){_0xd2cec7[_0x47a677(0x146)](0x1f4)[_0x47a677(0x14a)]({'success':![],'message':_0x47a677(0x133)});}}),router['post'](a21_0x38c65d(0x103),async(_0x362b10,_0xb3fd13)=>{const _0x201351=a21_0x38c65d;try{const _0x23792b=await domainMonitoringService_1[_0x201351(0x10c)][_0x201351(0x13d)]();_0xb3fd13[_0x201351(0x14a)]({'success':!![],'result':{'domainAvailable':_0x23792b,'message':_0x23792b?'Domain\x20is\x20responding\x20correctly':'Domain\x20check\x20failed','timestamp':new Date()[_0x201351(0x160)]()}});}catch(_0x548727){_0xb3fd13[_0x201351(0x146)](0x1f4)[_0x201351(0x14a)]({'success':![],'message':_0x548727 instanceof Error?_0x548727[_0x201351(0x120)]:'Failed\x20to\x20perform\x20manual\x20domain\x20check'});}}),exports[a21_0x38c65d(0x164)]=router;