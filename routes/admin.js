'use strict';function a19_0x1950(){const _0x1027b7=['message','17175006HQhXAA','7233610WyhdXZ','getPayouts','configurable','gateway','shop','then','/logs/stats','/merchant-statistics','expiryDays','floor','now','Rapyd\x20payment\x20status\x20checked\x20successfully','getTime','getMerchantsSelection','Failed\x20to\x20get\x20CoinToPay\x20service\x20statistics','\x20days\x20if\x20not\x20paid','loggerService','getOwnPropertyDescriptor','75187ObmJpC','../services/rapydStatusService','paymentId','getPayoutById','getMonitoringStats','gatewayPaymentId','rapydStatusService','call','/payouts/:id','FAILED','validate','manualCheck','üîç\x20[ADMIN]\x20Manual\x20CoinToPay\x20check\x20requested\x20for\x20payment:\x20','getServiceStats','Each\x20new\x20payment\x20gets\x20individual\x20timers:\x201min,\x202min,\x207min,\x2012min,\x20then\x20hourly','Domain\x20monitoring\x20service\x20for\x20amaterasy884.icu','checkPaymentById','deletePayout','../config/database','/rapyd/check/:paymentId','../controllers/adminController','Failed\x20to\x20get\x20Rapyd\x20service\x20statistics','domainMonitoringService','/payout/stats','defineProperty','currency','getOwnPropertyNames','../middleware/validation','requireAdmin','Requests\x20are\x20made\x20with\x20base64\x20encoded\x20URLs','Payments\x20automatically\x20expire\x20after\x20','Failed\x20to\x20clean\x20old\x20logs','cointopay','amount','deleteUser','Domain\x20check\x20failed','params','8QSeiCe','delete','Failed\x20to\x20get\x20domain\x20monitoring\x20statistics','Router','Old\x20logs\x20cleaned\x20(kept\x20last\x20','default','/domain-monitoring/check','__setModuleDefault','__esModule','Failed\x20to\x20get\x20payment\x20information','/users/:id/suspend','/rapyd/payment/:paymentId','authenticateToken','json','updatePayment','hasTimers','__importDefault','/cointopay/stats','üîç\x20[ADMIN]\x20Manual\x20Rapyd\x20check\x20requested\x20for\x20payment:\x20','612KsBoqi','findUnique','createUser','../services/coinToPayStatusService','express','cleanOldLogs','/rapyd/stats','body','createdAt','‚ùå\x20[ADMIN]\x20Manual\x20Rapyd\x20check\x20failed\x20for\x20payment\x20','PENDING','EXPIRED','AdminController','use','No\x20more\x20checks\x20scheduled','updateUser','/users/:id','Only\x20checks\x20payments\x20with\x20status\x20PENDING\x20at\x20check\x20time','‚ùå\x20[ADMIN]\x20Manual\x20CoinToPay\x20check\x20failed\x20for\x20payment\x20','/cointopay/payment/:paymentId','__importStar','log','payment','9149528ovMZeG','getUserById','1825938znFWPn','Server\x20crashes\x20if\x20domain\x20is\x20not\x20responding\x20after\x20consecutive\x20failures','writable','error','coinToPayStatusService','getUsers','toISOString','429325cYuvTW','getPayments','/users','updatedAt','Payment\x20not\x20found','/payments/:id/customer','create','put','/payments/:id','post','prototype','\x20minutes','Payments\x20are\x20checked\x20after\x2030\x20minutes\x20and\x2060\x20minutes,\x20then\x20forgotten','/domain-monitoring/stats','No\x20checks\x20scheduled','status','get','Failed\x20to\x20perform\x20manual\x20domain\x20check','CoinToPay\x20automatic\x20status\x20checking\x20service','activateUser','7773tXhpfX','getPaymentTimerInfo','getLogStats','Domain\x20is\x20responding\x20correctly','/cointopay/check/:paymentId','Failed\x20to\x20check\x20Rapyd\x20payment\x20status'];a19_0x1950=function(){return _0x1027b7;};return a19_0x1950();}const a19_0x4a5c7e=a19_0x2010;(function(_0x2b0b28,_0x438406){const _0x17f298=a19_0x2010,_0x4c3aff=_0x2b0b28();while(!![]){try{const _0x5888d0=-parseInt(_0x17f298(0x1df))/0x1+parseInt(_0x17f298(0x1d8))/0x2+-parseInt(_0x17f298(0x1f3))/0x3*(parseInt(_0x17f298(0x1ac))/0x4)+-parseInt(_0x17f298(0x1fb))/0x5+parseInt(_0x17f298(0x1bf))/0x6*(-parseInt(_0x17f298(0x20d))/0x7)+parseInt(_0x17f298(0x1d6))/0x8+parseInt(_0x17f298(0x1fa))/0x9;if(_0x5888d0===_0x438406)break;else _0x4c3aff['push'](_0x4c3aff['shift']());}catch(_0x3892e2){_0x4c3aff['push'](_0x4c3aff['shift']());}}}(a19_0x1950,0xf1417));var __createBinding=this&&this['__createBinding']||(Object['create']?function(_0x23d2c9,_0x483d8a,_0x5949be,_0x29d668){const _0x6543a7=a19_0x2010;if(_0x29d668===undefined)_0x29d668=_0x5949be;var _0x41d76f=Object[_0x6543a7(0x20c)](_0x483d8a,_0x5949be);(!_0x41d76f||(_0x6543a7(0x1ef)in _0x41d76f?!_0x483d8a[_0x6543a7(0x1b4)]:_0x41d76f[_0x6543a7(0x1da)]||_0x41d76f[_0x6543a7(0x1fd)]))&&(_0x41d76f={'enumerable':!![],'get':function(){return _0x483d8a[_0x5949be];}}),Object[_0x6543a7(0x19f)](_0x23d2c9,_0x29d668,_0x41d76f);}:function(_0x33959,_0x10d497,_0x5ece46,_0x49f2f2){if(_0x49f2f2===undefined)_0x49f2f2=_0x5ece46;_0x33959[_0x49f2f2]=_0x10d497[_0x5ece46];}),__setModuleDefault=this&&this[a19_0x4a5c7e(0x1b3)]||(Object[a19_0x4a5c7e(0x1e5)]?function(_0x2b9520,_0x23fa2c){const _0x3bf0ff=a19_0x4a5c7e;Object[_0x3bf0ff(0x19f)](_0x2b9520,_0x3bf0ff(0x1b1),{'enumerable':!![],'value':_0x23fa2c});}:function(_0x5962f9,_0x55a041){const _0x3f8450=a19_0x4a5c7e;_0x5962f9[_0x3f8450(0x1b1)]=_0x55a041;}),__importStar=this&&this[a19_0x4a5c7e(0x1d3)]||(function(){var _0xde39e5=function(_0x41b023){const _0x44e078=a19_0x2010;return _0xde39e5=Object[_0x44e078(0x1a1)]||function(_0x464b0e){const _0x15a418=_0x44e078;var _0x555f96=[];for(var _0x563c3d in _0x464b0e)if(Object[_0x15a418(0x1e9)]['hasOwnProperty'][_0x15a418(0x214)](_0x464b0e,_0x563c3d))_0x555f96[_0x555f96['length']]=_0x563c3d;return _0x555f96;},_0xde39e5(_0x41b023);};return function(_0x11ec4c){const _0x2c8b7c=a19_0x2010;if(_0x11ec4c&&_0x11ec4c[_0x2c8b7c(0x1b4)])return _0x11ec4c;var _0x4a9f44={};if(_0x11ec4c!=null){for(var _0x4730ae=_0xde39e5(_0x11ec4c),_0x50e858=0x0;_0x50e858<_0x4730ae['length'];_0x50e858++)if(_0x4730ae[_0x50e858]!==_0x2c8b7c(0x1b1))__createBinding(_0x4a9f44,_0x11ec4c,_0x4730ae[_0x50e858]);}return __setModuleDefault(_0x4a9f44,_0x11ec4c),_0x4a9f44;};}()),__importDefault=this&&this[a19_0x4a5c7e(0x1bc)]||function(_0x4fe1a7){const _0xa8fb3f=a19_0x4a5c7e;return _0x4fe1a7&&_0x4fe1a7[_0xa8fb3f(0x1b4)]?_0x4fe1a7:{'default':_0x4fe1a7};};function a19_0x2010(_0x416f13,_0x3dcbf4){const _0x195015=a19_0x1950();return a19_0x2010=function(_0x201038,_0x3e7ea7){_0x201038=_0x201038-0x191;let _0x1f0c0c=_0x195015[_0x201038];return _0x1f0c0c;},a19_0x2010(_0x416f13,_0x3dcbf4);}Object['defineProperty'](exports,a19_0x4a5c7e(0x1b4),{'value':!![]});const express_1=require(a19_0x4a5c7e(0x1c3)),adminController_1=require(a19_0x4a5c7e(0x19b)),validation_1=require(a19_0x4a5c7e(0x1a2)),auth_1=require('../middleware/auth'),loggerService_1=require('../services/loggerService'),coinToPayStatusService_1=require(a19_0x4a5c7e(0x1c2)),rapydStatusService_1=require(a19_0x4a5c7e(0x20e)),domainMonitoringService_1=require('../services/domainMonitoringService'),database_1=__importDefault(require(a19_0x4a5c7e(0x199))),router=(0x0,express_1[a19_0x4a5c7e(0x1af)])(),adminController=new adminController_1[(a19_0x4a5c7e(0x1cb))]();router[a19_0x4a5c7e(0x1cc)](auth_1[a19_0x4a5c7e(0x1b8)],auth_1[a19_0x4a5c7e(0x1a3)]),router[a19_0x4a5c7e(0x1ef)]('/auth',adminController['checkAuth']),router[a19_0x4a5c7e(0x1ef)]('/statistics',adminController['getStatistics']),router[a19_0x4a5c7e(0x1ef)](a19_0x4a5c7e(0x202),adminController['getMerchantStatistics']),router[a19_0x4a5c7e(0x1ef)]('/merchants/selection',adminController[a19_0x4a5c7e(0x208)]),router['get'](a19_0x4a5c7e(0x19e),adminController['getPayoutStats']),router[a19_0x4a5c7e(0x1ef)]('/payout/merchants',adminController['getMerchantsAwaitingPayout']),router[a19_0x4a5c7e(0x1e8)]('/payout',(0x0,validation_1[a19_0x4a5c7e(0x191)])(validation_1['createPayoutSchema']),adminController['createPayout']),router['get']('/payouts',adminController[a19_0x4a5c7e(0x1fc)]),router[a19_0x4a5c7e(0x1ef)]('/payouts/:id',adminController[a19_0x4a5c7e(0x210)]),router[a19_0x4a5c7e(0x1ad)](a19_0x4a5c7e(0x215),adminController[a19_0x4a5c7e(0x198)]),router[a19_0x4a5c7e(0x1ef)]('/payments',adminController[a19_0x4a5c7e(0x1e0)]),router[a19_0x4a5c7e(0x1ef)](a19_0x4a5c7e(0x1e7),adminController['getPaymentById']),router['put'](a19_0x4a5c7e(0x1e7),adminController[a19_0x4a5c7e(0x1ba)]),router[a19_0x4a5c7e(0x1e6)](a19_0x4a5c7e(0x1e4),(0x0,validation_1[a19_0x4a5c7e(0x191)])(validation_1['updateCustomerDataSchema']),adminController['updateCustomerData']),router[a19_0x4a5c7e(0x1ef)]('/users',adminController[a19_0x4a5c7e(0x1dd)]),router[a19_0x4a5c7e(0x1ef)]('/users/:id',adminController[a19_0x4a5c7e(0x1d7)]),router[a19_0x4a5c7e(0x1e8)](a19_0x4a5c7e(0x1e1),(0x0,validation_1[a19_0x4a5c7e(0x191)])(validation_1['createUserSchema']),adminController[a19_0x4a5c7e(0x1c1)]),router[a19_0x4a5c7e(0x1e6)]('/users/:id',(0x0,validation_1['validate'])(validation_1['updateUserSchema']),adminController[a19_0x4a5c7e(0x1ce)]),router['delete'](a19_0x4a5c7e(0x1cf),adminController[a19_0x4a5c7e(0x1a9)]),router[a19_0x4a5c7e(0x1e8)](a19_0x4a5c7e(0x1b6),adminController['suspendUser']),router[a19_0x4a5c7e(0x1e8)]('/users/:id/activate',adminController[a19_0x4a5c7e(0x1f2)]),router[a19_0x4a5c7e(0x1ef)](a19_0x4a5c7e(0x201),(_0x463c78,_0x4385c7)=>{const _0x23cb27=a19_0x4a5c7e;try{const _0x34d105=loggerService_1[_0x23cb27(0x20b)][_0x23cb27(0x1f5)]();_0x4385c7['json']({'success':!![],'result':_0x34d105});}catch(_0x22a6e9){_0x4385c7[_0x23cb27(0x1ee)](0x1f4)[_0x23cb27(0x1b9)]({'success':![],'message':'Failed\x20to\x20get\x20log\x20statistics'});}}),router[a19_0x4a5c7e(0x1e8)]('/logs/clean',(_0xd1ba97,_0x37d5e3)=>{const _0x224af1=a19_0x4a5c7e;try{const {daysToKeep:daysToKeep=0x1e}=_0xd1ba97[_0x224af1(0x1c6)];loggerService_1[_0x224af1(0x20b)][_0x224af1(0x1c4)](daysToKeep),_0x37d5e3['json']({'success':!![],'message':_0x224af1(0x1b0)+daysToKeep+'\x20days)'});}catch(_0x56f698){_0x37d5e3[_0x224af1(0x1ee)](0x1f4)[_0x224af1(0x1b9)]({'success':![],'message':_0x224af1(0x1a6)});}}),router[a19_0x4a5c7e(0x1e8)](a19_0x4a5c7e(0x1f7),async(_0x3281be,_0x50468b)=>{const _0x36e530=a19_0x4a5c7e;try{const {paymentId:_0x1e5a18}=_0x3281be['params'];console[_0x36e530(0x1d4)](_0x36e530(0x193)+_0x1e5a18),await coinToPayStatusService_1['coinToPayStatusService'][_0x36e530(0x197)](_0x1e5a18),_0x50468b['json']({'success':!![],'message':'CoinToPay\x20payment\x20status\x20checked\x20successfully'});}catch(_0x18d6bb){console[_0x36e530(0x1db)](_0x36e530(0x1d1)+_0x3281be['params']['paymentId']+':',_0x18d6bb),_0x50468b['status'](0x1f4)[_0x36e530(0x1b9)]({'success':![],'message':_0x18d6bb instanceof Error?_0x18d6bb[_0x36e530(0x1f9)]:'Failed\x20to\x20check\x20CoinToPay\x20payment\x20status'});}}),router[a19_0x4a5c7e(0x1ef)](a19_0x4a5c7e(0x1bd),(_0x280b56,_0x3d5559)=>{const _0x4e188b=a19_0x4a5c7e;try{const _0x320607=coinToPayStatusService_1['coinToPayStatusService']['getServiceStats']();_0x3d5559[_0x4e188b(0x1b9)]({'success':!![],'result':{..._0x320607,'description':_0x4e188b(0x1f1),'statusMapping':{'Paid':'PAID','Awaiting\x20Fiat':_0x4e188b(0x1c9),'waiting':_0x4e188b(0x1c9),'expired':_0x4e188b(0x1ca),'failed':_0x4e188b(0x216)},'autoExpiryNote':_0x4e188b(0x1a5)+_0x320607[_0x4e188b(0x203)]+_0x4e188b(0x20a),'individualTimersNote':_0x4e188b(0x195)}});}catch(_0x3f0605){_0x3d5559['status'](0x1f4)[_0x4e188b(0x1b9)]({'success':![],'message':_0x4e188b(0x209)});}}),router['get'](a19_0x4a5c7e(0x1d2),async(_0x18d540,_0x3847ae)=>{const _0x8c66ad=a19_0x4a5c7e;try{const {paymentId:_0x2f898e}=_0x18d540['params'],_0x570dcf=coinToPayStatusService_1[_0x8c66ad(0x1dc)][_0x8c66ad(0x1f4)](_0x2f898e),_0x3a9acd=(await Promise['resolve']()[_0x8c66ad(0x200)](()=>__importStar(require(_0x8c66ad(0x199)))))['default'],_0x53ccdf=await _0x3a9acd[_0x8c66ad(0x1d5)]['findUnique']({'where':{'id':_0x2f898e},'select':{'id':!![],'gateway':!![],'gatewayPaymentId':!![],'status':!![],'amount':!![],'currency':!![],'createdAt':!![],'updatedAt':!![],'shopId':!![],'shop':{'select':{'name':!![],'username':!![]}}}});if(!_0x53ccdf)return _0x3847ae['status'](0x194)[_0x8c66ad(0x1b9)]({'success':![],'message':_0x8c66ad(0x1e3)});_0x3847ae[_0x8c66ad(0x1b9)]({'success':!![],'result':{'payment':{'id':_0x53ccdf['id'],'gateway':_0x53ccdf['gateway'],'gatewayPaymentId':_0x53ccdf['gatewayPaymentId'],'status':_0x53ccdf[_0x8c66ad(0x1ee)],'amount':_0x53ccdf[_0x8c66ad(0x1a8)],'currency':_0x53ccdf[_0x8c66ad(0x1a0)],'createdAt':_0x53ccdf[_0x8c66ad(0x1c7)],'updatedAt':_0x53ccdf['updatedAt'],'shop':_0x53ccdf[_0x8c66ad(0x1ff)]},'timers':_0x570dcf,'isCoinToPay':_0x53ccdf['gateway']===_0x8c66ad(0x1a7),'ageInMinutes':Math[_0x8c66ad(0x204)]((Date[_0x8c66ad(0x205)]()-_0x53ccdf[_0x8c66ad(0x1c7)][_0x8c66ad(0x207)]())/(0x3e8*0x3c))}});}catch(_0x4a8aed){_0x3847ae[_0x8c66ad(0x1ee)](0x1f4)[_0x8c66ad(0x1b9)]({'success':![],'message':_0x4a8aed instanceof Error?_0x4a8aed[_0x8c66ad(0x1f9)]:_0x8c66ad(0x1b5)});}}),router['post'](a19_0x4a5c7e(0x19a),async(_0x4814a2,_0x1f12ab)=>{const _0xc5048b=a19_0x4a5c7e;try{const {paymentId:_0x936ee}=_0x4814a2[_0xc5048b(0x1ab)];console[_0xc5048b(0x1d4)](_0xc5048b(0x1be)+_0x936ee),await rapydStatusService_1[_0xc5048b(0x213)][_0xc5048b(0x197)](_0x936ee),_0x1f12ab['json']({'success':!![],'message':_0xc5048b(0x206)});}catch(_0x135915){console[_0xc5048b(0x1db)](_0xc5048b(0x1c8)+_0x4814a2['params'][_0xc5048b(0x20f)]+':',_0x135915),_0x1f12ab[_0xc5048b(0x1ee)](0x1f4)[_0xc5048b(0x1b9)]({'success':![],'message':_0x135915 instanceof Error?_0x135915['message']:_0xc5048b(0x1f8)});}}),router[a19_0x4a5c7e(0x1ef)](a19_0x4a5c7e(0x1c5),(_0x84b00e,_0x18eb0e)=>{const _0x961af7=a19_0x4a5c7e;try{const _0x98cbfa=rapydStatusService_1[_0x961af7(0x213)][_0x961af7(0x194)]();_0x18eb0e[_0x961af7(0x1b9)]({'success':!![],'result':{..._0x98cbfa,'description':'Rapyd\x20automatic\x20status\x20checking\x20service','statusMapping':{'paid:\x20true':'PAID','paid:\x20false\x20+\x20CAN':'FAILED','paid:\x20false\x20+\x20ERR':_0x961af7(0x216),'paid:\x20false\x20+\x20EXP':_0x961af7(0x1ca),'paid:\x20false\x20+\x20other':_0x961af7(0x1c9)},'checkSchedule':_0x961af7(0x1eb),'note':_0x961af7(0x1d0)}});}catch(_0x3e094b){_0x18eb0e[_0x961af7(0x1ee)](0x1f4)[_0x961af7(0x1b9)]({'success':![],'message':_0x961af7(0x19c)});}}),router[a19_0x4a5c7e(0x1ef)](a19_0x4a5c7e(0x1b7),async(_0xdaf336,_0x59f4aa)=>{const _0x13424c=a19_0x4a5c7e;try{const {paymentId:_0x3ce1ff}=_0xdaf336[_0x13424c(0x1ab)],_0x8602b0=await database_1['default'][_0x13424c(0x1d5)][_0x13424c(0x1c0)]({'where':{'id':_0x3ce1ff},'include':{'shop':{'select':{'id':!![],'name':!![],'username':!![]}}}});if(!_0x8602b0)return _0x59f4aa[_0x13424c(0x1ee)](0x194)[_0x13424c(0x1b9)]({'success':![],'message':_0x13424c(0x1e3)});const _0x570771=rapydStatusService_1[_0x13424c(0x213)][_0x13424c(0x1f4)](_0x3ce1ff);_0x59f4aa[_0x13424c(0x1b9)]({'success':!![],'result':{'payment':{'id':_0x8602b0['id'],'gateway':_0x8602b0[_0x13424c(0x1fe)],'gatewayPaymentId':_0x8602b0[_0x13424c(0x212)],'status':_0x8602b0[_0x13424c(0x1ee)],'amount':_0x8602b0[_0x13424c(0x1a8)],'currency':_0x8602b0[_0x13424c(0x1a0)],'createdAt':_0x8602b0[_0x13424c(0x1c7)],'updatedAt':_0x8602b0[_0x13424c(0x1e2)],'shop':_0x8602b0[_0x13424c(0x1ff)]},'timers':_0x570771,'isRapyd':_0x8602b0[_0x13424c(0x1fe)]==='rapyd','ageInMinutes':Math[_0x13424c(0x204)]((Date[_0x13424c(0x205)]()-_0x8602b0[_0x13424c(0x1c7)][_0x13424c(0x207)]())/(0x3e8*0x3c)),'nextCheck':_0x570771[_0x13424c(0x1bb)]?Math[_0x13424c(0x204)]((Date['now']()-_0x8602b0[_0x13424c(0x1c7)][_0x13424c(0x207)]())/(0x3e8*0x3c))<0x1e?0x1e-Math[_0x13424c(0x204)]((Date[_0x13424c(0x205)]()-_0x8602b0[_0x13424c(0x1c7)][_0x13424c(0x207)]())/(0x3e8*0x3c))+_0x13424c(0x1ea):Math[_0x13424c(0x204)]((Date['now']()-_0x8602b0['createdAt'][_0x13424c(0x207)]())/(0x3e8*0x3c))<0x3c?0x3c-Math[_0x13424c(0x204)]((Date[_0x13424c(0x205)]()-_0x8602b0[_0x13424c(0x1c7)][_0x13424c(0x207)]())/(0x3e8*0x3c))+'\x20minutes':_0x13424c(0x1cd):_0x13424c(0x1ed)}});}catch(_0x2421e3){_0x59f4aa[_0x13424c(0x1ee)](0x1f4)[_0x13424c(0x1b9)]({'success':![],'message':_0x2421e3 instanceof Error?_0x2421e3[_0x13424c(0x1f9)]:_0x13424c(0x1b5)});}}),router[a19_0x4a5c7e(0x1ef)](a19_0x4a5c7e(0x1ec),(_0x3b23d4,_0x153734)=>{const _0x36f4f7=a19_0x4a5c7e;try{const _0x108cb6=domainMonitoringService_1[_0x36f4f7(0x19d)][_0x36f4f7(0x211)]();_0x153734[_0x36f4f7(0x1b9)]({'success':!![],'result':{..._0x108cb6,'description':_0x36f4f7(0x196),'behavior':_0x36f4f7(0x1d9),'encoding':_0x36f4f7(0x1a4)}});}catch(_0x2bf7f9){_0x153734['status'](0x1f4)[_0x36f4f7(0x1b9)]({'success':![],'message':_0x36f4f7(0x1ae)});}}),router[a19_0x4a5c7e(0x1e8)](a19_0x4a5c7e(0x1b2),async(_0xdbc71c,_0x387251)=>{const _0x2f7888=a19_0x4a5c7e;try{const _0x489b5c=await domainMonitoringService_1['domainMonitoringService'][_0x2f7888(0x192)]();_0x387251[_0x2f7888(0x1b9)]({'success':!![],'result':{'domainAvailable':_0x489b5c,'message':_0x489b5c?_0x2f7888(0x1f6):_0x2f7888(0x1aa),'timestamp':new Date()[_0x2f7888(0x1de)]()}});}catch(_0x2308bd){_0x387251['status'](0x1f4)['json']({'success':![],'message':_0x2308bd instanceof Error?_0x2308bd[_0x2f7888(0x1f9)]:_0x2f7888(0x1f0)});}}),exports[a19_0x4a5c7e(0x1b1)]=router;