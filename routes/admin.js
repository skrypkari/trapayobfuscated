'use strict';const a19_0x4e912e=a19_0x43ca;(function(_0x2dce58,_0x11963d){const _0x2612e9=a19_0x43ca,_0x3648f9=_0x2dce58();while(!![]){try{const _0x2ccc42=parseInt(_0x2612e9(0x1b2))/0x1*(-parseInt(_0x2612e9(0x18c))/0x2)+parseInt(_0x2612e9(0x1af))/0x3+-parseInt(_0x2612e9(0x1cb))/0x4*(parseInt(_0x2612e9(0x1c4))/0x5)+-parseInt(_0x2612e9(0x1bb))/0x6+parseInt(_0x2612e9(0x1d0))/0x7*(parseInt(_0x2612e9(0x1b1))/0x8)+parseInt(_0x2612e9(0x1a3))/0x9+parseInt(_0x2612e9(0x1aa))/0xa;if(_0x2ccc42===_0x11963d)break;else _0x3648f9['push'](_0x3648f9['shift']());}catch(_0x5ecb1f){_0x3648f9['push'](_0x3648f9['shift']());}}}(a19_0x258c,0xe5e61));function a19_0x258c(){const _0x27b4a0=['loggerService','getMerchantsAwaitingPayout','Failed\x20to\x20get\x20domain\x20monitoring\x20statistics','/payments/:id','__importStar','‚ùå\x20[ADMIN]\x20Manual\x20CoinToPay\x20check\x20failed\x20for\x20payment\x20','Failed\x20to\x20get\x20payment\x20information','length','gatewayPaymentId','Failed\x20to\x20clean\x20old\x20logs','\x20days\x20if\x20not\x20paid','get','amount','updateCustomerData','use','activateUser','/payments','status','/merchant-statistics','getLogStats','/payout/merchants','PAID','deletePayout','Old\x20logs\x20cleaned\x20(kept\x20last\x20','gateway','Payments\x20automatically\x20expire\x20after\x20','25006hfirXR','requireAdmin','createUser','Requests\x20are\x20made\x20with\x20base64\x20encoded\x20URLs','body','/domain-monitoring/stats','payment','expiryDays','getPayouts','/statistics','updateCustomerDataSchema','suspendUser','/users/:id','/logs/stats','__esModule','getPayments','Failed\x20to\x20get\x20CoinToPay\x20service\x20statistics','/users/:id/activate','getPayoutById','createUserSchema','updateUserSchema','updatedAt','put','5429187duLclQ','create','../services/domainMonitoringService','post','../services/loggerService','PENDING','/logs/clean','26743690fBIqYc','/cointopay/stats','manualCheck','__setModuleDefault','checkAuth','528315aaZXfJ','params','5160WNdCXl','23eAtpJP','Domain\x20check\x20failed','defineProperty','CoinToPay\x20automatic\x20status\x20checking\x20service','updateUser','getPaymentTimerInfo','toISOString','AdminController','/auth','8460072ObOXRZ','../middleware/auth','/payout/stats','getOwnPropertyDescriptor','getUsers','updatePayment','FAILED','/users/:id/suspend','/payments/:id/customer','10210PWsdoE','default','getStatistics','json','/domain-monitoring/check','EXPIRED','Server\x20crashes\x20if\x20domain\x20is\x20not\x20responding\x20after\x20consecutive\x20failures','3032ZjigJe','shop','getOwnPropertyNames','call','../controllers/adminController','7959MdJXWs','Each\x20new\x20payment\x20gets\x20individual\x20timers:\x201min,\x202min,\x207min,\x2012min,\x20then\x20hourly','then','Failed\x20to\x20get\x20log\x20statistics','getServiceStats','domainMonitoringService','coinToPayStatusService','Failed\x20to\x20perform\x20manual\x20domain\x20check','message','createdAt','üîç\x20[ADMIN]\x20Manual\x20CoinToPay\x20check\x20requested\x20for\x20payment:\x20','now','Domain\x20monitoring\x20service\x20for\x20amaterasy884.icu','createPayout','/payout','/payouts/:id','authenticateToken','paymentId','validate','error','Payment\x20not\x20found','delete','resolve'];a19_0x258c=function(){return _0x27b4a0;};return a19_0x258c();}function a19_0x43ca(_0x2b6de1,_0x2735e1){const _0x258c8d=a19_0x258c();return a19_0x43ca=function(_0x43ca92,_0x12d8aa){_0x43ca92=_0x43ca92-0x166;let _0x4b3ec1=_0x258c8d[_0x43ca92];return _0x4b3ec1;},a19_0x43ca(_0x2b6de1,_0x2735e1);}var __createBinding=this&&this['__createBinding']||(Object[a19_0x4e912e(0x1a4)]?function(_0x45fc23,_0x316700,_0x5c7e61,_0x477c71){const _0x5c4b4f=a19_0x4e912e;if(_0x477c71===undefined)_0x477c71=_0x5c7e61;var _0x7b6204=Object[_0x5c4b4f(0x1be)](_0x316700,_0x5c7e61);(!_0x7b6204||(_0x5c4b4f(0x17d)in _0x7b6204?!_0x316700[_0x5c4b4f(0x19a)]:_0x7b6204['writable']||_0x7b6204['configurable']))&&(_0x7b6204={'enumerable':!![],'get':function(){return _0x316700[_0x5c7e61];}}),Object[_0x5c4b4f(0x1b4)](_0x45fc23,_0x477c71,_0x7b6204);}:function(_0x131a42,_0x4fcbc7,_0x267ba7,_0x3695c2){if(_0x3695c2===undefined)_0x3695c2=_0x267ba7;_0x131a42[_0x3695c2]=_0x4fcbc7[_0x267ba7];}),__setModuleDefault=this&&this[a19_0x4e912e(0x1ad)]||(Object['create']?function(_0x126bb4,_0x17c058){const _0x1c45dd=a19_0x4e912e;Object[_0x1c45dd(0x1b4)](_0x126bb4,'default',{'enumerable':!![],'value':_0x17c058});}:function(_0x19be48,_0x35b02a){const _0xe36842=a19_0x4e912e;_0x19be48[_0xe36842(0x1c5)]=_0x35b02a;}),__importStar=this&&this[a19_0x4e912e(0x176)]||(function(){var _0x10dc2e=function(_0x1fa021){const _0xf03cd0=a19_0x43ca;return _0x10dc2e=Object[_0xf03cd0(0x1cd)]||function(_0x8ec2e3){const _0x2cad06=_0xf03cd0;var _0x20ec71=[];for(var _0x15f8e4 in _0x8ec2e3)if(Object['prototype']['hasOwnProperty'][_0x2cad06(0x1ce)](_0x8ec2e3,_0x15f8e4))_0x20ec71[_0x20ec71[_0x2cad06(0x179)]]=_0x15f8e4;return _0x20ec71;},_0x10dc2e(_0x1fa021);};return function(_0x2b39f0){const _0x380919=a19_0x43ca;if(_0x2b39f0&&_0x2b39f0[_0x380919(0x19a)])return _0x2b39f0;var _0x5bdb36={};if(_0x2b39f0!=null){for(var _0x17e4b4=_0x10dc2e(_0x2b39f0),_0x59e9c3=0x0;_0x59e9c3<_0x17e4b4['length'];_0x59e9c3++)if(_0x17e4b4[_0x59e9c3]!=='default')__createBinding(_0x5bdb36,_0x2b39f0,_0x17e4b4[_0x59e9c3]);}return __setModuleDefault(_0x5bdb36,_0x2b39f0),_0x5bdb36;};}());Object['defineProperty'](exports,a19_0x4e912e(0x19a),{'value':!![]});const express_1=require('express'),adminController_1=require(a19_0x4e912e(0x1cf)),validation_1=require('../middleware/validation'),auth_1=require(a19_0x4e912e(0x1bc)),loggerService_1=require(a19_0x4e912e(0x1a7)),coinToPayStatusService_1=require('../services/coinToPayStatusService'),domainMonitoringService_1=require(a19_0x4e912e(0x1a5)),router=(0x0,express_1['Router'])(),adminController=new adminController_1[(a19_0x4e912e(0x1b9))]();router[a19_0x4e912e(0x180)](auth_1[a19_0x4e912e(0x16b)],auth_1[a19_0x4e912e(0x18d)]),router[a19_0x4e912e(0x17d)](a19_0x4e912e(0x1ba),adminController[a19_0x4e912e(0x1ae)]),router[a19_0x4e912e(0x17d)](a19_0x4e912e(0x195),adminController[a19_0x4e912e(0x1c6)]),router['get'](a19_0x4e912e(0x184),adminController['getMerchantStatistics']),router[a19_0x4e912e(0x17d)](a19_0x4e912e(0x1bd),adminController['getPayoutStats']),router[a19_0x4e912e(0x17d)](a19_0x4e912e(0x186),adminController[a19_0x4e912e(0x173)]),router['post'](a19_0x4e912e(0x169),(0x0,validation_1[a19_0x4e912e(0x16d)])(validation_1['createPayoutSchema']),adminController[a19_0x4e912e(0x168)]),router[a19_0x4e912e(0x17d)]('/payouts',adminController[a19_0x4e912e(0x194)]),router[a19_0x4e912e(0x17d)](a19_0x4e912e(0x16a),adminController[a19_0x4e912e(0x19e)]),router[a19_0x4e912e(0x170)]('/payouts/:id',adminController[a19_0x4e912e(0x188)]),router['get'](a19_0x4e912e(0x182),adminController[a19_0x4e912e(0x19b)]),router[a19_0x4e912e(0x17d)]('/payments/:id',adminController['getPaymentById']),router['put'](a19_0x4e912e(0x175),adminController[a19_0x4e912e(0x1c0)]),router[a19_0x4e912e(0x1a2)](a19_0x4e912e(0x1c3),(0x0,validation_1[a19_0x4e912e(0x16d)])(validation_1[a19_0x4e912e(0x196)]),adminController[a19_0x4e912e(0x17f)]),router[a19_0x4e912e(0x17d)]('/users',adminController[a19_0x4e912e(0x1bf)]),router[a19_0x4e912e(0x17d)](a19_0x4e912e(0x198),adminController['getUserById']),router[a19_0x4e912e(0x1a6)]('/users',(0x0,validation_1[a19_0x4e912e(0x16d)])(validation_1[a19_0x4e912e(0x19f)]),adminController[a19_0x4e912e(0x18e)]),router[a19_0x4e912e(0x1a2)](a19_0x4e912e(0x198),(0x0,validation_1[a19_0x4e912e(0x16d)])(validation_1[a19_0x4e912e(0x1a0)]),adminController[a19_0x4e912e(0x1b6)]),router[a19_0x4e912e(0x170)]('/users/:id',adminController['deleteUser']),router[a19_0x4e912e(0x1a6)](a19_0x4e912e(0x1c2),adminController[a19_0x4e912e(0x197)]),router[a19_0x4e912e(0x1a6)](a19_0x4e912e(0x19d),adminController[a19_0x4e912e(0x181)]),router['get'](a19_0x4e912e(0x199),(_0x221da3,_0x70267)=>{const _0x356ab8=a19_0x4e912e;try{const _0x2b91cc=loggerService_1[_0x356ab8(0x172)][_0x356ab8(0x185)]();_0x70267['json']({'success':!![],'result':_0x2b91cc});}catch(_0x4f114d){_0x70267[_0x356ab8(0x183)](0x1f4)[_0x356ab8(0x1c7)]({'success':![],'message':_0x356ab8(0x1d3)});}}),router[a19_0x4e912e(0x1a6)](a19_0x4e912e(0x1a9),(_0x3b1d6a,_0x5869e6)=>{const _0x2ca48b=a19_0x4e912e;try{const {daysToKeep:daysToKeep=0x1e}=_0x3b1d6a[_0x2ca48b(0x190)];loggerService_1[_0x2ca48b(0x172)]['cleanOldLogs'](daysToKeep),_0x5869e6['json']({'success':!![],'message':_0x2ca48b(0x189)+daysToKeep+'\x20days)'});}catch(_0x32755c){_0x5869e6[_0x2ca48b(0x183)](0x1f4)[_0x2ca48b(0x1c7)]({'success':![],'message':_0x2ca48b(0x17b)});}}),router[a19_0x4e912e(0x1a6)]('/cointopay/check/:paymentId',async(_0x5376ce,_0xb64e2d)=>{const _0x1e6aed=a19_0x4e912e;try{const {paymentId:_0x580d5f}=_0x5376ce[_0x1e6aed(0x1b0)];console['log'](_0x1e6aed(0x1da)+_0x580d5f),await coinToPayStatusService_1[_0x1e6aed(0x1d6)]['checkPaymentById'](_0x580d5f),_0xb64e2d[_0x1e6aed(0x1c7)]({'success':!![],'message':'CoinToPay\x20payment\x20status\x20checked\x20successfully'});}catch(_0x318129){console[_0x1e6aed(0x16e)](_0x1e6aed(0x177)+_0x5376ce['params'][_0x1e6aed(0x16c)]+':',_0x318129),_0xb64e2d['status'](0x1f4)[_0x1e6aed(0x1c7)]({'success':![],'message':_0x318129 instanceof Error?_0x318129[_0x1e6aed(0x1d8)]:'Failed\x20to\x20check\x20CoinToPay\x20payment\x20status'});}}),router[a19_0x4e912e(0x17d)](a19_0x4e912e(0x1ab),(_0x9c261e,_0xb95613)=>{const _0x3ce87c=a19_0x4e912e;try{const _0x34e578=coinToPayStatusService_1['coinToPayStatusService'][_0x3ce87c(0x1d4)]();_0xb95613[_0x3ce87c(0x1c7)]({'success':!![],'result':{..._0x34e578,'description':_0x3ce87c(0x1b5),'statusMapping':{'Paid':_0x3ce87c(0x187),'Awaiting\x20Fiat':_0x3ce87c(0x1a8),'waiting':_0x3ce87c(0x1a8),'expired':_0x3ce87c(0x1c9),'failed':_0x3ce87c(0x1c1)},'autoExpiryNote':_0x3ce87c(0x18b)+_0x34e578[_0x3ce87c(0x193)]+_0x3ce87c(0x17c),'individualTimersNote':_0x3ce87c(0x1d1)}});}catch(_0x2ea7e6){_0xb95613[_0x3ce87c(0x183)](0x1f4)[_0x3ce87c(0x1c7)]({'success':![],'message':_0x3ce87c(0x19c)});}}),router[a19_0x4e912e(0x17d)]('/cointopay/payment/:paymentId',async(_0x305363,_0x33a7e6)=>{const _0x22c27b=a19_0x4e912e;try{const {paymentId:_0x2c5243}=_0x305363[_0x22c27b(0x1b0)],_0x363ffa=coinToPayStatusService_1[_0x22c27b(0x1d6)][_0x22c27b(0x1b7)](_0x2c5243),_0x1aaf11=(await Promise[_0x22c27b(0x171)]()[_0x22c27b(0x1d2)](()=>__importStar(require('../config/database'))))[_0x22c27b(0x1c5)],_0x1ba7e4=await _0x1aaf11[_0x22c27b(0x192)]['findUnique']({'where':{'id':_0x2c5243},'select':{'id':!![],'gateway':!![],'gatewayPaymentId':!![],'status':!![],'amount':!![],'currency':!![],'createdAt':!![],'updatedAt':!![],'shopId':!![],'shop':{'select':{'name':!![],'username':!![]}}}});if(!_0x1ba7e4)return _0x33a7e6[_0x22c27b(0x183)](0x194)['json']({'success':![],'message':_0x22c27b(0x16f)});_0x33a7e6[_0x22c27b(0x1c7)]({'success':!![],'result':{'payment':{'id':_0x1ba7e4['id'],'gateway':_0x1ba7e4['gateway'],'gatewayPaymentId':_0x1ba7e4[_0x22c27b(0x17a)],'status':_0x1ba7e4[_0x22c27b(0x183)],'amount':_0x1ba7e4[_0x22c27b(0x17e)],'currency':_0x1ba7e4['currency'],'createdAt':_0x1ba7e4[_0x22c27b(0x1d9)],'updatedAt':_0x1ba7e4[_0x22c27b(0x1a1)],'shop':_0x1ba7e4[_0x22c27b(0x1cc)]},'timers':_0x363ffa,'isCoinToPay':_0x1ba7e4[_0x22c27b(0x18a)]==='cointopay','ageInMinutes':Math['floor']((Date[_0x22c27b(0x166)]()-_0x1ba7e4['createdAt']['getTime']())/(0x3e8*0x3c))}});}catch(_0x516449){_0x33a7e6[_0x22c27b(0x183)](0x1f4)[_0x22c27b(0x1c7)]({'success':![],'message':_0x516449 instanceof Error?_0x516449[_0x22c27b(0x1d8)]:_0x22c27b(0x178)});}}),router['get'](a19_0x4e912e(0x191),(_0x4c58c6,_0x563185)=>{const _0x388eba=a19_0x4e912e;try{const _0xdfece0=domainMonitoringService_1[_0x388eba(0x1d5)]['getMonitoringStats']();_0x563185['json']({'success':!![],'result':{..._0xdfece0,'description':_0x388eba(0x167),'behavior':_0x388eba(0x1ca),'encoding':_0x388eba(0x18f)}});}catch(_0x5310c8){_0x563185[_0x388eba(0x183)](0x1f4)[_0x388eba(0x1c7)]({'success':![],'message':_0x388eba(0x174)});}}),router[a19_0x4e912e(0x1a6)](a19_0x4e912e(0x1c8),async(_0x106cac,_0x2d1a0b)=>{const _0x4d4ee5=a19_0x4e912e;try{const _0x2a868a=await domainMonitoringService_1[_0x4d4ee5(0x1d5)][_0x4d4ee5(0x1ac)]();_0x2d1a0b[_0x4d4ee5(0x1c7)]({'success':!![],'result':{'domainAvailable':_0x2a868a,'message':_0x2a868a?'Domain\x20is\x20responding\x20correctly':_0x4d4ee5(0x1b3),'timestamp':new Date()[_0x4d4ee5(0x1b8)]()}});}catch(_0x9df24f){_0x2d1a0b[_0x4d4ee5(0x183)](0x1f4)[_0x4d4ee5(0x1c7)]({'success':![],'message':_0x9df24f instanceof Error?_0x9df24f[_0x4d4ee5(0x1d8)]:_0x4d4ee5(0x1d7)});}}),exports[a19_0x4e912e(0x1c5)]=router;