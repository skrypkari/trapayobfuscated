'use strict';function a19_0x3422(){const _0x2433cf=['getLogStats','/payments/:id/customer','getUserById','getServiceStats','getOwnPropertyNames','post','toISOString','checkPaymentById','Payment\x20not\x20found','Payments\x20are\x20checked\x20after\x2030\x20minutes\x20and\x2060\x20minutes,\x20then\x20forgotten','deleteUser','gatewayPaymentId','Failed\x20to\x20get\x20log\x20statistics','../services/loggerService','paymentId','\x20minutes','getPayouts','Router','updatedAt','createUser','AdminController','/payments','../services/domainMonitoringService','Failed\x20to\x20get\x20domain\x20monitoring\x20statistics','1080018tUCtTD','call','message','EXPIRED','/users/:id/suspend','getMerchantsSelection','Domain\x20check\x20failed','/domain-monitoring/stats','683493exwfJr','/payout/stats','log','createdAt','coinToPayStatusService','11405124VKMwoL','610828DAaBRR','üîç\x20[ADMIN]\x20Manual\x20Rapyd\x20check\x20requested\x20for\x20payment:\x20','currency','Rapyd\x20automatic\x20status\x20checking\x20service','Failed\x20to\x20check\x20Rapyd\x20payment\x20status','/users','getOwnPropertyDescriptor','Server\x20crashes\x20if\x20domain\x20is\x20not\x20responding\x20after\x20consecutive\x20failures','gateway','floor','‚ùå\x20[ADMIN]\x20Manual\x20Rapyd\x20check\x20failed\x20for\x20payment\x20','__importDefault','PAID','getPaymentTimerInfo','deletePayout','createUserSchema','activateUser','Requests\x20are\x20made\x20with\x20base64\x20encoded\x20URLs','amount','authenticateToken','express','Failed\x20to\x20get\x20Rapyd\x20service\x20statistics','domainMonitoringService','\x20days)','../middleware/auth','FAILED','default','/auth','writable','1246714ZnHtoi','getTime','getMerchantsAwaitingPayout','defineProperty','/rapyd/payment/:paymentId','json','params','body','CoinToPay\x20payment\x20status\x20checked\x20successfully','updateUser','164761dRABNM','expiryDays','status','getPaymentById','checkAuth','hasTimers','CoinToPay\x20automatic\x20status\x20checking\x20service','get','/payouts/:id','8lAqOsm','/rapyd/stats','findUnique','resolve','/cointopay/stats','manualCheck','getMonitoringStats','‚ùå\x20[ADMIN]\x20Manual\x20CoinToPay\x20check\x20failed\x20for\x20payment\x20','hasOwnProperty','__createBinding','rapydStatusService','error','/users/:id','createPayout','/cointopay/payment/:paymentId','createPayoutSchema','/logs/clean','requireAdmin','Domain\x20monitoring\x20service\x20for\x20amaterasy884.icu','/merchant-statistics','put','__importStar','PENDING','now','Failed\x20to\x20perform\x20manual\x20domain\x20check','__esModule','../config/database','15sCoGnK','payment','validate','/users/:id/activate','/cointopay/check/:paymentId','Domain\x20is\x20responding\x20correctly','Failed\x20to\x20check\x20CoinToPay\x20payment\x20status','No\x20checks\x20scheduled','cointopay','../services/rapydStatusService','/rapyd/check/:paymentId','/logs/stats','updateCustomerData','üîç\x20[ADMIN]\x20Manual\x20CoinToPay\x20check\x20requested\x20for\x20payment:\x20','getMerchantStatistics','Only\x20checks\x20payments\x20with\x20status\x20PENDING\x20at\x20check\x20time','getUsers','/statistics','/payout/merchants','/payments/:id','use','3840214FbGxZk','updateCustomerDataSchema','/domain-monitoring/check','/payout','Failed\x20to\x20get\x20CoinToPay\x20service\x20statistics','delete','getPayments','Old\x20logs\x20cleaned\x20(kept\x20last\x20','rapyd','length'];a19_0x3422=function(){return _0x2433cf;};return a19_0x3422();}const a19_0x3b60f8=a19_0x149d;(function(_0x5e23d3,_0x2c7b7a){const _0xa6af77=a19_0x149d,_0x460966=_0x5e23d3();while(!![]){try{const _0x272970=parseInt(_0xa6af77(0x17a))/0x1+-parseInt(_0xa6af77(0x170))/0x2+parseInt(_0xa6af77(0x1dd))/0x3+-parseInt(_0xa6af77(0x1e3))/0x4*(-parseInt(_0xa6af77(0x19e))/0x5)+-parseInt(_0xa6af77(0x1d5))/0x6+parseInt(_0xa6af77(0x1b3))/0x7*(-parseInt(_0xa6af77(0x183))/0x8)+parseInt(_0xa6af77(0x1e2))/0x9;if(_0x272970===_0x2c7b7a)break;else _0x460966['push'](_0x460966['shift']());}catch(_0x169a39){_0x460966['push'](_0x460966['shift']());}}}(a19_0x3422,0xbb023));var __createBinding=this&&this[a19_0x3b60f8(0x18c)]||(Object['create']?function(_0xcc1142,_0x15da4f,_0x5e12f9,_0x209b94){const _0x44ec2d=a19_0x3b60f8;if(_0x209b94===undefined)_0x209b94=_0x5e12f9;var _0x4023f2=Object[_0x44ec2d(0x1e9)](_0x15da4f,_0x5e12f9);(!_0x4023f2||(_0x44ec2d(0x181)in _0x4023f2?!_0x15da4f['__esModule']:_0x4023f2[_0x44ec2d(0x16f)]||_0x4023f2['configurable']))&&(_0x4023f2={'enumerable':!![],'get':function(){return _0x15da4f[_0x5e12f9];}}),Object['defineProperty'](_0xcc1142,_0x209b94,_0x4023f2);}:function(_0x36252d,_0x583824,_0x1ba42f,_0x33d472){if(_0x33d472===undefined)_0x33d472=_0x1ba42f;_0x36252d[_0x33d472]=_0x583824[_0x1ba42f];}),__setModuleDefault=this&&this['__setModuleDefault']||(Object['create']?function(_0x41f879,_0x54295c){const _0x34e28d=a19_0x3b60f8;Object[_0x34e28d(0x173)](_0x41f879,_0x34e28d(0x16d),{'enumerable':!![],'value':_0x54295c});}:function(_0x2dfa64,_0x352bfc){const _0x464b7a=a19_0x3b60f8;_0x2dfa64[_0x464b7a(0x16d)]=_0x352bfc;}),__importStar=this&&this[a19_0x3b60f8(0x198)]||(function(){var _0x5101dd=function(_0xc6257){const _0x1cf99f=a19_0x149d;return _0x5101dd=Object[_0x1cf99f(0x1c1)]||function(_0x5947b5){const _0x2eff7b=_0x1cf99f;var _0x119393=[];for(var _0x2594ad in _0x5947b5)if(Object['prototype'][_0x2eff7b(0x18b)][_0x2eff7b(0x1d6)](_0x5947b5,_0x2594ad))_0x119393[_0x119393['length']]=_0x2594ad;return _0x119393;},_0x5101dd(_0xc6257);};return function(_0x22d93e){const _0x16ab75=a19_0x149d;if(_0x22d93e&&_0x22d93e[_0x16ab75(0x19c)])return _0x22d93e;var _0x50a1cc={};if(_0x22d93e!=null){for(var _0x11ad3c=_0x5101dd(_0x22d93e),_0x20ddf1=0x0;_0x20ddf1<_0x11ad3c[_0x16ab75(0x1bc)];_0x20ddf1++)if(_0x11ad3c[_0x20ddf1]!==_0x16ab75(0x16d))__createBinding(_0x50a1cc,_0x22d93e,_0x11ad3c[_0x20ddf1]);}return __setModuleDefault(_0x50a1cc,_0x22d93e),_0x50a1cc;};}()),__importDefault=this&&this[a19_0x3b60f8(0x1ee)]||function(_0x6a4373){const _0x4ff9d5=a19_0x3b60f8;return _0x6a4373&&_0x6a4373[_0x4ff9d5(0x19c)]?_0x6a4373:{'default':_0x6a4373};};Object[a19_0x3b60f8(0x173)](exports,a19_0x3b60f8(0x19c),{'value':!![]});const express_1=require(a19_0x3b60f8(0x167)),adminController_1=require('../controllers/adminController'),validation_1=require('../middleware/validation'),auth_1=require(a19_0x3b60f8(0x16b)),loggerService_1=require(a19_0x3b60f8(0x1ca)),coinToPayStatusService_1=require('../services/coinToPayStatusService'),rapydStatusService_1=require(a19_0x3b60f8(0x1a7)),domainMonitoringService_1=require(a19_0x3b60f8(0x1d3)),database_1=__importDefault(require(a19_0x3b60f8(0x19d))),router=(0x0,express_1[a19_0x3b60f8(0x1ce)])(),adminController=new adminController_1[(a19_0x3b60f8(0x1d1))]();function a19_0x149d(_0x184ff5,_0x3fa639){const _0x342252=a19_0x3422();return a19_0x149d=function(_0x149de8,_0x46209a){_0x149de8=_0x149de8-0x15f;let _0x35c46e=_0x342252[_0x149de8];return _0x35c46e;},a19_0x149d(_0x184ff5,_0x3fa639);}router[a19_0x3b60f8(0x1b2)](auth_1[a19_0x3b60f8(0x166)],auth_1[a19_0x3b60f8(0x194)]),router[a19_0x3b60f8(0x181)](a19_0x3b60f8(0x16e),adminController[a19_0x3b60f8(0x17e)]),router['get'](a19_0x3b60f8(0x1af),adminController['getStatistics']),router[a19_0x3b60f8(0x181)](a19_0x3b60f8(0x196),adminController[a19_0x3b60f8(0x1ac)]),router['get']('/merchants/selection',adminController[a19_0x3b60f8(0x1da)]),router[a19_0x3b60f8(0x181)](a19_0x3b60f8(0x1de),adminController['getPayoutStats']),router[a19_0x3b60f8(0x181)](a19_0x3b60f8(0x1b0),adminController[a19_0x3b60f8(0x172)]),router[a19_0x3b60f8(0x1c2)](a19_0x3b60f8(0x1b6),(0x0,validation_1[a19_0x3b60f8(0x1a0)])(validation_1[a19_0x3b60f8(0x192)]),adminController[a19_0x3b60f8(0x190)]),router['get']('/payouts',adminController[a19_0x3b60f8(0x1cd)]),router['get'](a19_0x3b60f8(0x182),adminController['getPayoutById']),router[a19_0x3b60f8(0x1b8)](a19_0x3b60f8(0x182),adminController[a19_0x3b60f8(0x161)]),router[a19_0x3b60f8(0x181)](a19_0x3b60f8(0x1d2),adminController[a19_0x3b60f8(0x1b9)]),router[a19_0x3b60f8(0x181)](a19_0x3b60f8(0x1b1),adminController[a19_0x3b60f8(0x17d)]),router[a19_0x3b60f8(0x197)](a19_0x3b60f8(0x1b1),adminController['updatePayment']),router[a19_0x3b60f8(0x197)](a19_0x3b60f8(0x1be),(0x0,validation_1[a19_0x3b60f8(0x1a0)])(validation_1[a19_0x3b60f8(0x1b4)]),adminController[a19_0x3b60f8(0x1aa)]),router[a19_0x3b60f8(0x181)](a19_0x3b60f8(0x1e8),adminController[a19_0x3b60f8(0x1ae)]),router[a19_0x3b60f8(0x181)](a19_0x3b60f8(0x18f),adminController[a19_0x3b60f8(0x1bf)]),router[a19_0x3b60f8(0x1c2)]('/users',(0x0,validation_1[a19_0x3b60f8(0x1a0)])(validation_1[a19_0x3b60f8(0x162)]),adminController[a19_0x3b60f8(0x1d0)]),router['put']('/users/:id',(0x0,validation_1[a19_0x3b60f8(0x1a0)])(validation_1['updateUserSchema']),adminController[a19_0x3b60f8(0x179)]),router[a19_0x3b60f8(0x1b8)]('/users/:id',adminController[a19_0x3b60f8(0x1c7)]),router[a19_0x3b60f8(0x1c2)](a19_0x3b60f8(0x1d9),adminController['suspendUser']),router[a19_0x3b60f8(0x1c2)](a19_0x3b60f8(0x1a1),adminController[a19_0x3b60f8(0x163)]),router['get'](a19_0x3b60f8(0x1a9),(_0x2f85e4,_0x19d8fa)=>{const _0x5bbb2d=a19_0x3b60f8;try{const _0x2d3e71=loggerService_1['loggerService'][_0x5bbb2d(0x1bd)]();_0x19d8fa['json']({'success':!![],'result':_0x2d3e71});}catch(_0x46217c){_0x19d8fa[_0x5bbb2d(0x17c)](0x1f4)['json']({'success':![],'message':_0x5bbb2d(0x1c9)});}}),router['post'](a19_0x3b60f8(0x193),(_0x41d6ef,_0x3d9ba6)=>{const _0xa53b1f=a19_0x3b60f8;try{const {daysToKeep:daysToKeep=0x1e}=_0x41d6ef[_0xa53b1f(0x177)];loggerService_1['loggerService']['cleanOldLogs'](daysToKeep),_0x3d9ba6[_0xa53b1f(0x175)]({'success':!![],'message':_0xa53b1f(0x1ba)+daysToKeep+_0xa53b1f(0x16a)});}catch(_0x45d151){_0x3d9ba6[_0xa53b1f(0x17c)](0x1f4)[_0xa53b1f(0x175)]({'success':![],'message':'Failed\x20to\x20clean\x20old\x20logs'});}}),router[a19_0x3b60f8(0x1c2)](a19_0x3b60f8(0x1a2),async(_0x1c04d0,_0x3fe89d)=>{const _0x5843f7=a19_0x3b60f8;try{const {paymentId:_0x52840f}=_0x1c04d0[_0x5843f7(0x176)];console[_0x5843f7(0x1df)](_0x5843f7(0x1ab)+_0x52840f),await coinToPayStatusService_1[_0x5843f7(0x1e1)][_0x5843f7(0x1c4)](_0x52840f),_0x3fe89d['json']({'success':!![],'message':_0x5843f7(0x178)});}catch(_0x430d83){console[_0x5843f7(0x18e)](_0x5843f7(0x18a)+_0x1c04d0[_0x5843f7(0x176)]['paymentId']+':',_0x430d83),_0x3fe89d[_0x5843f7(0x17c)](0x1f4)['json']({'success':![],'message':_0x430d83 instanceof Error?_0x430d83['message']:_0x5843f7(0x1a4)});}}),router[a19_0x3b60f8(0x181)](a19_0x3b60f8(0x187),(_0xca4e19,_0x30f0a9)=>{const _0x353075=a19_0x3b60f8;try{const _0x6d3710=coinToPayStatusService_1['coinToPayStatusService'][_0x353075(0x1c0)]();_0x30f0a9[_0x353075(0x175)]({'success':!![],'result':{..._0x6d3710,'description':_0x353075(0x180),'statusMapping':{'Paid':_0x353075(0x15f),'Awaiting\x20Fiat':_0x353075(0x199),'waiting':_0x353075(0x199),'expired':_0x353075(0x1d8),'failed':_0x353075(0x16c)},'autoExpiryNote':'Payments\x20automatically\x20expire\x20after\x20'+_0x6d3710[_0x353075(0x17b)]+'\x20days\x20if\x20not\x20paid','individualTimersNote':'Each\x20new\x20payment\x20gets\x20individual\x20timers:\x201min,\x202min,\x207min,\x2012min,\x20then\x20hourly'}});}catch(_0x3cdf11){_0x30f0a9[_0x353075(0x17c)](0x1f4)[_0x353075(0x175)]({'success':![],'message':_0x353075(0x1b7)});}}),router['get'](a19_0x3b60f8(0x191),async(_0x4be5ce,_0x5aa65b)=>{const _0x419773=a19_0x3b60f8;try{const {paymentId:_0x3b32e7}=_0x4be5ce[_0x419773(0x176)],_0x47721b=coinToPayStatusService_1['coinToPayStatusService'][_0x419773(0x160)](_0x3b32e7),_0x26b53a=(await Promise[_0x419773(0x186)]()['then'](()=>__importStar(require(_0x419773(0x19d)))))[_0x419773(0x16d)],_0x2180db=await _0x26b53a[_0x419773(0x19f)][_0x419773(0x185)]({'where':{'id':_0x3b32e7},'select':{'id':!![],'gateway':!![],'gatewayPaymentId':!![],'status':!![],'amount':!![],'currency':!![],'createdAt':!![],'updatedAt':!![],'shopId':!![],'shop':{'select':{'name':!![],'username':!![]}}}});if(!_0x2180db)return _0x5aa65b['status'](0x194)[_0x419773(0x175)]({'success':![],'message':'Payment\x20not\x20found'});_0x5aa65b['json']({'success':!![],'result':{'payment':{'id':_0x2180db['id'],'gateway':_0x2180db[_0x419773(0x1eb)],'gatewayPaymentId':_0x2180db[_0x419773(0x1c8)],'status':_0x2180db[_0x419773(0x17c)],'amount':_0x2180db[_0x419773(0x165)],'currency':_0x2180db[_0x419773(0x1e5)],'createdAt':_0x2180db[_0x419773(0x1e0)],'updatedAt':_0x2180db[_0x419773(0x1cf)],'shop':_0x2180db['shop']},'timers':_0x47721b,'isCoinToPay':_0x2180db[_0x419773(0x1eb)]===_0x419773(0x1a6),'ageInMinutes':Math[_0x419773(0x1ec)]((Date['now']()-_0x2180db['createdAt']['getTime']())/(0x3e8*0x3c))}});}catch(_0x430a81){_0x5aa65b[_0x419773(0x17c)](0x1f4)[_0x419773(0x175)]({'success':![],'message':_0x430a81 instanceof Error?_0x430a81[_0x419773(0x1d7)]:'Failed\x20to\x20get\x20payment\x20information'});}}),router[a19_0x3b60f8(0x1c2)](a19_0x3b60f8(0x1a8),async(_0x473167,_0x46eb78)=>{const _0x8cec2a=a19_0x3b60f8;try{const {paymentId:_0x207567}=_0x473167[_0x8cec2a(0x176)];console[_0x8cec2a(0x1df)](_0x8cec2a(0x1e4)+_0x207567),await rapydStatusService_1[_0x8cec2a(0x18d)]['checkPaymentById'](_0x207567),_0x46eb78['json']({'success':!![],'message':'Rapyd\x20payment\x20status\x20checked\x20successfully'});}catch(_0x34b928){console['error'](_0x8cec2a(0x1ed)+_0x473167[_0x8cec2a(0x176)][_0x8cec2a(0x1cb)]+':',_0x34b928),_0x46eb78[_0x8cec2a(0x17c)](0x1f4)[_0x8cec2a(0x175)]({'success':![],'message':_0x34b928 instanceof Error?_0x34b928[_0x8cec2a(0x1d7)]:_0x8cec2a(0x1e7)});}}),router[a19_0x3b60f8(0x181)](a19_0x3b60f8(0x184),(_0x288b22,_0x1d4c64)=>{const _0xf4d952=a19_0x3b60f8;try{const _0x510f30=rapydStatusService_1[_0xf4d952(0x18d)][_0xf4d952(0x1c0)]();_0x1d4c64['json']({'success':!![],'result':{..._0x510f30,'description':_0xf4d952(0x1e6),'statusMapping':{'paid:\x20true':_0xf4d952(0x15f),'paid:\x20false\x20+\x20CAN':_0xf4d952(0x16c),'paid:\x20false\x20+\x20ERR':_0xf4d952(0x16c),'paid:\x20false\x20+\x20EXP':_0xf4d952(0x1d8),'paid:\x20false\x20+\x20other':'PENDING'},'checkSchedule':_0xf4d952(0x1c6),'note':_0xf4d952(0x1ad)}});}catch(_0xad1d13){_0x1d4c64['status'](0x1f4)[_0xf4d952(0x175)]({'success':![],'message':_0xf4d952(0x168)});}}),router[a19_0x3b60f8(0x181)](a19_0x3b60f8(0x174),async(_0x2aad5f,_0x516d1c)=>{const _0x3a68e5=a19_0x3b60f8;try{const {paymentId:_0x4042f8}=_0x2aad5f['params'],_0x31da27=await database_1[_0x3a68e5(0x16d)][_0x3a68e5(0x19f)][_0x3a68e5(0x185)]({'where':{'id':_0x4042f8},'include':{'shop':{'select':{'id':!![],'name':!![],'username':!![]}}}});if(!_0x31da27)return _0x516d1c[_0x3a68e5(0x17c)](0x194)[_0x3a68e5(0x175)]({'success':![],'message':_0x3a68e5(0x1c5)});const _0x3654b2=rapydStatusService_1['rapydStatusService'][_0x3a68e5(0x160)](_0x4042f8);_0x516d1c[_0x3a68e5(0x175)]({'success':!![],'result':{'payment':{'id':_0x31da27['id'],'gateway':_0x31da27[_0x3a68e5(0x1eb)],'gatewayPaymentId':_0x31da27[_0x3a68e5(0x1c8)],'status':_0x31da27[_0x3a68e5(0x17c)],'amount':_0x31da27[_0x3a68e5(0x165)],'currency':_0x31da27['currency'],'createdAt':_0x31da27['createdAt'],'updatedAt':_0x31da27[_0x3a68e5(0x1cf)],'shop':_0x31da27['shop']},'timers':_0x3654b2,'isRapyd':_0x31da27[_0x3a68e5(0x1eb)]===_0x3a68e5(0x1bb),'ageInMinutes':Math[_0x3a68e5(0x1ec)]((Date[_0x3a68e5(0x19a)]()-_0x31da27[_0x3a68e5(0x1e0)][_0x3a68e5(0x171)]())/(0x3e8*0x3c)),'nextCheck':_0x3654b2[_0x3a68e5(0x17f)]?Math['floor']((Date['now']()-_0x31da27[_0x3a68e5(0x1e0)][_0x3a68e5(0x171)]())/(0x3e8*0x3c))<0x1e?0x1e-Math[_0x3a68e5(0x1ec)]((Date[_0x3a68e5(0x19a)]()-_0x31da27[_0x3a68e5(0x1e0)]['getTime']())/(0x3e8*0x3c))+_0x3a68e5(0x1cc):Math[_0x3a68e5(0x1ec)]((Date[_0x3a68e5(0x19a)]()-_0x31da27['createdAt'][_0x3a68e5(0x171)]())/(0x3e8*0x3c))<0x3c?0x3c-Math[_0x3a68e5(0x1ec)]((Date[_0x3a68e5(0x19a)]()-_0x31da27['createdAt'][_0x3a68e5(0x171)]())/(0x3e8*0x3c))+_0x3a68e5(0x1cc):'No\x20more\x20checks\x20scheduled':_0x3a68e5(0x1a5)}});}catch(_0x5b65b9){_0x516d1c['status'](0x1f4)[_0x3a68e5(0x175)]({'success':![],'message':_0x5b65b9 instanceof Error?_0x5b65b9[_0x3a68e5(0x1d7)]:'Failed\x20to\x20get\x20payment\x20information'});}}),router[a19_0x3b60f8(0x181)](a19_0x3b60f8(0x1dc),(_0x4b6fd0,_0x3049dc)=>{const _0x5d2b1b=a19_0x3b60f8;try{const _0x122f36=domainMonitoringService_1[_0x5d2b1b(0x169)][_0x5d2b1b(0x189)]();_0x3049dc['json']({'success':!![],'result':{..._0x122f36,'description':_0x5d2b1b(0x195),'behavior':_0x5d2b1b(0x1ea),'encoding':_0x5d2b1b(0x164)}});}catch(_0x2ed3e2){_0x3049dc['status'](0x1f4)[_0x5d2b1b(0x175)]({'success':![],'message':_0x5d2b1b(0x1d4)});}}),router[a19_0x3b60f8(0x1c2)](a19_0x3b60f8(0x1b5),async(_0x288aff,_0x30cfe8)=>{const _0x2c5ffc=a19_0x3b60f8;try{const _0xd0591b=await domainMonitoringService_1[_0x2c5ffc(0x169)][_0x2c5ffc(0x188)]();_0x30cfe8[_0x2c5ffc(0x175)]({'success':!![],'result':{'domainAvailable':_0xd0591b,'message':_0xd0591b?_0x2c5ffc(0x1a3):_0x2c5ffc(0x1db),'timestamp':new Date()[_0x2c5ffc(0x1c3)]()}});}catch(_0x35125e){_0x30cfe8['status'](0x1f4)[_0x2c5ffc(0x175)]({'success':![],'message':_0x35125e instanceof Error?_0x35125e[_0x2c5ffc(0x1d7)]:_0x2c5ffc(0x19b)});}}),exports[a19_0x3b60f8(0x16d)]=router;