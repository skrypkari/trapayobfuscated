'use strict';function a24_0x5ee4(){const _0x52047c=['updateUserSchema','createPayout','shop','currency','2616qldYxX','/domain-monitoring/stats','put','then','2802240BYYsrC','getProcessingPaymentsStats','call','getPayouts','checkAuth','createUserSchema','updatePayment','cleanOldLogs','writable','status','message','AdminController','validate','/payments/:id','params','Failed\x20to\x20get\x20CoinToPay\x20service\x20statistics','getPayoutById','requireAdmin','../middleware/auth','8606944jctgJH','amount','deleteUser','/statistics','/cointopay/check/:paymentId','Domain\x20monitoring\x20service\x20for\x20amaterasy884.icu','get','json','delete','12dJKeDz','coinToPayStatusService','../config/database','/payouts/:id','199288tcqoqX','__setModuleDefault','CoinToPay\x20automatic\x20status\x20checking\x20service','PAID','cleanupStalePendingPayments','authenticateToken','getOwnPropertyDescriptor','__esModule','Failed\x20to\x20get\x20log\x20statistics','/merchants/selection','Failed\x20to\x20perform\x20manual\x20domain\x20check','log','\x20days)','/payments/cleanup-with-report','/users/:id','prototype','/users/:id/activate','\x20days\x20if\x20not\x20paid','EXPIRED','../controllers/adminController','CoinToPay\x20payment\x20status\x20checked\x20successfully','Domain\x20is\x20responding\x20correctly','createUser','/cointopay/stats','floor','now','getServiceStats','/cointopay/payment/:paymentId','__createBinding','post','Failed\x20to\x20check\x20CoinToPay\x20payment\x20status','Failed\x20to\x20get\x20payment\x20information','updateUser','/payout','paymentId','getPaymentTimerInfo','defineProperty','87834WsdKgH','domainMonitoringService','PENDING','error','getTime','‚ùå\x20[ADMIN]\x20Manual\x20CoinToPay\x20check\x20failed\x20for\x20payment\x20','gateway','updateCustomerDataSchema','getUsers','express','configurable','deletePayout','Router','Failed\x20to\x20clean\x20old\x20logs','manualCheck','body','/users','getMerchantsSelection','resolve','3833053zVLHFo','getMerchantsAwaitingPayout','/payments','suspendUser','getMerchantStatistics','/logs/stats','Requests\x20are\x20made\x20with\x20base64\x20encoded\x20URLs','Server\x20crashes\x20if\x20domain\x20is\x20not\x20responding\x20after\x20consecutive\x20failures','36RMuPhS','checkPaymentById','Each\x20new\x20payment\x20gets\x20individual\x20timers:\x201min,\x202min,\x207min,\x2012min,\x20then\x20hourly','getPaymentById','createPayoutSchema','default','Payment\x20not\x20found','loggerService','739165yYThSH','gatewayPaymentId','/domain-monitoring/check','../middleware/validation','../services/coinToPayStatusService','getUserById','../services/loggerService','createdAt','length','getMonitoringStats','Old\x20logs\x20cleaned\x20(kept\x20last\x20','Domain\x20check\x20failed','/payments/cleanup-pending','getStatistics','activateUser','create'];a24_0x5ee4=function(){return _0x52047c;};return a24_0x5ee4();}const a24_0x33a217=a24_0x95ce;(function(_0x469870,_0x48e21c){const _0x2e933c=a24_0x95ce,_0x18f8e9=_0x469870();while(!![]){try{const _0x3527e6=-parseInt(_0x2e933c(0xfb))/0x1+-parseInt(_0x2e933c(0x120))/0x2*(parseInt(_0x2e933c(0x13b))/0x3)+parseInt(_0x2e933c(0xf7))/0x4*(parseInt(_0x2e933c(0x143))/0x5)+-parseInt(_0x2e933c(0x157))/0x6+-parseInt(_0x2e933c(0x133))/0x7+parseInt(_0x2e933c(0x16e))/0x8+parseInt(_0x2e933c(0x15b))/0x9;if(_0x3527e6===_0x48e21c)break;else _0x18f8e9['push'](_0x18f8e9['shift']());}catch(_0x15ae8c){_0x18f8e9['push'](_0x18f8e9['shift']());}}}(a24_0x5ee4,0x87d84));var __createBinding=this&&this[a24_0x33a217(0x117)]||(Object[a24_0x33a217(0x152)]?function(_0x4e6fca,_0x5bbb7d,_0x205ab9,_0x1b999b){const _0xcbec21=a24_0x33a217;if(_0x1b999b===undefined)_0x1b999b=_0x205ab9;var _0x52ea21=Object[_0xcbec21(0x101)](_0x5bbb7d,_0x205ab9);(!_0x52ea21||('get'in _0x52ea21?!_0x5bbb7d['__esModule']:_0x52ea21[_0xcbec21(0x163)]||_0x52ea21[_0xcbec21(0x12a)]))&&(_0x52ea21={'enumerable':!![],'get':function(){return _0x5bbb7d[_0x205ab9];}}),Object['defineProperty'](_0x4e6fca,_0x1b999b,_0x52ea21);}:function(_0xbeca90,_0x1e43b4,_0x1e8274,_0x40cab0){if(_0x40cab0===undefined)_0x40cab0=_0x1e8274;_0xbeca90[_0x40cab0]=_0x1e43b4[_0x1e8274];}),__setModuleDefault=this&&this[a24_0x33a217(0xfc)]||(Object[a24_0x33a217(0x152)]?function(_0x315d09,_0x670660){const _0x3eb1d3=a24_0x33a217;Object[_0x3eb1d3(0x11f)](_0x315d09,'default',{'enumerable':!![],'value':_0x670660});}:function(_0xe819aa,_0x276103){const _0x32c6c5=a24_0x33a217;_0xe819aa[_0x32c6c5(0x140)]=_0x276103;}),__importStar=this&&this['__importStar']||(function(){var _0x38bb49=function(_0x127852){return _0x38bb49=Object['getOwnPropertyNames']||function(_0x109547){const _0x3ab0d1=a24_0x95ce;var _0x10442c=[];for(var _0x19f042 in _0x109547)if(Object[_0x3ab0d1(0x10a)]['hasOwnProperty'][_0x3ab0d1(0x15d)](_0x109547,_0x19f042))_0x10442c[_0x10442c['length']]=_0x19f042;return _0x10442c;},_0x38bb49(_0x127852);};return function(_0x52414b){const _0x25472c=a24_0x95ce;if(_0x52414b&&_0x52414b['__esModule'])return _0x52414b;var _0x2fbfd9={};if(_0x52414b!=null){for(var _0x263afb=_0x38bb49(_0x52414b),_0x38e3df=0x0;_0x38e3df<_0x263afb[_0x25472c(0x14b)];_0x38e3df++)if(_0x263afb[_0x38e3df]!==_0x25472c(0x140))__createBinding(_0x2fbfd9,_0x52414b,_0x263afb[_0x38e3df]);}return __setModuleDefault(_0x2fbfd9,_0x52414b),_0x2fbfd9;};}());Object['defineProperty'](exports,a24_0x33a217(0x102),{'value':!![]});function a24_0x95ce(_0xc2acc8,_0x596017){_0xc2acc8=_0xc2acc8-0xf7;const _0x5ee424=a24_0x5ee4();let _0x95cec6=_0x5ee424[_0xc2acc8];return _0x95cec6;}const express_1=require(a24_0x33a217(0x129)),adminController_1=require(a24_0x33a217(0x10e)),validation_1=require(a24_0x33a217(0x146)),auth_1=require(a24_0x33a217(0x16d)),loggerService_1=require(a24_0x33a217(0x149)),coinToPayStatusService_1=require(a24_0x33a217(0x147)),domainMonitoringService_1=require('../services/domainMonitoringService'),router=(0x0,express_1[a24_0x33a217(0x12c)])(),adminController=new adminController_1[(a24_0x33a217(0x166))]();router['use'](auth_1[a24_0x33a217(0x100)],auth_1[a24_0x33a217(0x16c)]),router[a24_0x33a217(0x174)]('/auth',adminController[a24_0x33a217(0x15f)]),router[a24_0x33a217(0x174)](a24_0x33a217(0x171),adminController[a24_0x33a217(0x150)]),router['get']('/merchant-statistics',adminController[a24_0x33a217(0x137)]),router[a24_0x33a217(0x174)]('/payout/stats',adminController['getPayoutStats']),router[a24_0x33a217(0x174)]('/payout/merchants',adminController[a24_0x33a217(0x134)]),router[a24_0x33a217(0x174)](a24_0x33a217(0x104),adminController[a24_0x33a217(0x131)]),router['post'](a24_0x33a217(0x11c),(0x0,validation_1[a24_0x33a217(0x167)])(validation_1[a24_0x33a217(0x13f)]),adminController[a24_0x33a217(0x154)]),router['get']('/payouts',adminController[a24_0x33a217(0x15e)]),router[a24_0x33a217(0x174)](a24_0x33a217(0xfa),adminController[a24_0x33a217(0x16b)]),router[a24_0x33a217(0x176)](a24_0x33a217(0xfa),adminController[a24_0x33a217(0x12b)]),router[a24_0x33a217(0x174)](a24_0x33a217(0x135),adminController['getPayments']),router[a24_0x33a217(0x174)](a24_0x33a217(0x168),adminController[a24_0x33a217(0x13e)]),router['put'](a24_0x33a217(0x168),adminController[a24_0x33a217(0x161)]),router[a24_0x33a217(0x159)]('/payments/:id/customer',(0x0,validation_1['validate'])(validation_1[a24_0x33a217(0x127)]),adminController['updateCustomerData']),router['get']('/payments/processing-stats',adminController[a24_0x33a217(0x15c)]),router[a24_0x33a217(0x118)]('/payments/cleanup',adminController['cleanupStalePayments']),router[a24_0x33a217(0x118)](a24_0x33a217(0x14f),adminController[a24_0x33a217(0xff)]),router['post'](a24_0x33a217(0x108),adminController['cleanupStalePaymentsWithReport']),router[a24_0x33a217(0x174)]('/users',adminController[a24_0x33a217(0x128)]),router[a24_0x33a217(0x174)]('/users/:id',adminController[a24_0x33a217(0x148)]),router[a24_0x33a217(0x118)](a24_0x33a217(0x130),(0x0,validation_1['validate'])(validation_1[a24_0x33a217(0x160)]),adminController[a24_0x33a217(0x111)]),router[a24_0x33a217(0x159)](a24_0x33a217(0x109),(0x0,validation_1['validate'])(validation_1[a24_0x33a217(0x153)]),adminController[a24_0x33a217(0x11b)]),router[a24_0x33a217(0x176)]('/users/:id',adminController[a24_0x33a217(0x170)]),router[a24_0x33a217(0x118)]('/users/:id/suspend',adminController[a24_0x33a217(0x136)]),router[a24_0x33a217(0x118)](a24_0x33a217(0x10b),adminController[a24_0x33a217(0x151)]),router[a24_0x33a217(0x174)](a24_0x33a217(0x138),(_0x11c309,_0x1701d1)=>{const _0x1e6266=a24_0x33a217;try{const _0x53c05c=loggerService_1[_0x1e6266(0x142)]['getLogStats']();_0x1701d1[_0x1e6266(0x175)]({'success':!![],'result':_0x53c05c});}catch(_0x4591f8){_0x1701d1[_0x1e6266(0x164)](0x1f4)[_0x1e6266(0x175)]({'success':![],'message':_0x1e6266(0x103)});}}),router[a24_0x33a217(0x118)]('/logs/clean',(_0x4305eb,_0x279b18)=>{const _0x23605b=a24_0x33a217;try{const {daysToKeep:daysToKeep=0x1e}=_0x4305eb[_0x23605b(0x12f)];loggerService_1['loggerService'][_0x23605b(0x162)](daysToKeep),_0x279b18[_0x23605b(0x175)]({'success':!![],'message':_0x23605b(0x14d)+daysToKeep+_0x23605b(0x107)});}catch(_0x879202){_0x279b18[_0x23605b(0x164)](0x1f4)[_0x23605b(0x175)]({'success':![],'message':_0x23605b(0x12d)});}}),router[a24_0x33a217(0x118)](a24_0x33a217(0x172),async(_0x39de4f,_0x4ed956)=>{const _0x13c0ec=a24_0x33a217;try{const {paymentId:_0x1c5677}=_0x39de4f['params'];console[_0x13c0ec(0x106)]('üîç\x20[ADMIN]\x20Manual\x20CoinToPay\x20check\x20requested\x20for\x20payment:\x20'+_0x1c5677),await coinToPayStatusService_1[_0x13c0ec(0xf8)][_0x13c0ec(0x13c)](_0x1c5677),_0x4ed956['json']({'success':!![],'message':_0x13c0ec(0x10f)});}catch(_0x56e02e){console[_0x13c0ec(0x123)](_0x13c0ec(0x125)+_0x39de4f[_0x13c0ec(0x169)][_0x13c0ec(0x11d)]+':',_0x56e02e),_0x4ed956[_0x13c0ec(0x164)](0x1f4)['json']({'success':![],'message':_0x56e02e instanceof Error?_0x56e02e[_0x13c0ec(0x165)]:_0x13c0ec(0x119)});}}),router[a24_0x33a217(0x174)](a24_0x33a217(0x112),(_0x3dc9dd,_0x497e0b)=>{const _0x21524d=a24_0x33a217;try{const _0x3c2c7b=coinToPayStatusService_1[_0x21524d(0xf8)][_0x21524d(0x115)]();_0x497e0b['json']({'success':!![],'result':{..._0x3c2c7b,'description':_0x21524d(0xfd),'statusMapping':{'Paid':_0x21524d(0xfe),'Awaiting\x20Fiat':_0x21524d(0x122),'waiting':_0x21524d(0x122),'expired':_0x21524d(0x10d),'failed':'FAILED'},'autoExpiryNote':'Payments\x20automatically\x20expire\x20after\x20'+_0x3c2c7b['expiryDays']+_0x21524d(0x10c),'individualTimersNote':_0x21524d(0x13d)}});}catch(_0x57d0b0){_0x497e0b[_0x21524d(0x164)](0x1f4)[_0x21524d(0x175)]({'success':![],'message':_0x21524d(0x16a)});}}),router['get'](a24_0x33a217(0x116),async(_0x4660b8,_0x3800a9)=>{const _0x8967af=a24_0x33a217;try{const {paymentId:_0x30e27a}=_0x4660b8['params'],_0x1f7b02=coinToPayStatusService_1[_0x8967af(0xf8)][_0x8967af(0x11e)](_0x30e27a),_0x569c10=(await Promise[_0x8967af(0x132)]()[_0x8967af(0x15a)](()=>__importStar(require(_0x8967af(0xf9)))))[_0x8967af(0x140)],_0xe7eaab=await _0x569c10['payment']['findUnique']({'where':{'id':_0x30e27a},'select':{'id':!![],'gateway':!![],'gatewayPaymentId':!![],'status':!![],'amount':!![],'currency':!![],'createdAt':!![],'updatedAt':!![],'shopId':!![],'shop':{'select':{'name':!![],'username':!![]}}}});if(!_0xe7eaab)return _0x3800a9[_0x8967af(0x164)](0x194)[_0x8967af(0x175)]({'success':![],'message':_0x8967af(0x141)});_0x3800a9[_0x8967af(0x175)]({'success':!![],'result':{'payment':{'id':_0xe7eaab['id'],'gateway':_0xe7eaab[_0x8967af(0x126)],'gatewayPaymentId':_0xe7eaab[_0x8967af(0x144)],'status':_0xe7eaab[_0x8967af(0x164)],'amount':_0xe7eaab[_0x8967af(0x16f)],'currency':_0xe7eaab[_0x8967af(0x156)],'createdAt':_0xe7eaab[_0x8967af(0x14a)],'updatedAt':_0xe7eaab['updatedAt'],'shop':_0xe7eaab[_0x8967af(0x155)]},'timers':_0x1f7b02,'isCoinToPay':_0xe7eaab[_0x8967af(0x126)]==='cointopay','ageInMinutes':Math[_0x8967af(0x113)]((Date[_0x8967af(0x114)]()-_0xe7eaab[_0x8967af(0x14a)][_0x8967af(0x124)]())/(0x3e8*0x3c))}});}catch(_0x2da826){_0x3800a9['status'](0x1f4)[_0x8967af(0x175)]({'success':![],'message':_0x2da826 instanceof Error?_0x2da826[_0x8967af(0x165)]:_0x8967af(0x11a)});}}),router[a24_0x33a217(0x174)](a24_0x33a217(0x158),(_0x13ff2f,_0xdc504b)=>{const _0x417103=a24_0x33a217;try{const _0x367e61=domainMonitoringService_1[_0x417103(0x121)][_0x417103(0x14c)]();_0xdc504b[_0x417103(0x175)]({'success':!![],'result':{..._0x367e61,'description':_0x417103(0x173),'behavior':_0x417103(0x13a),'encoding':_0x417103(0x139)}});}catch(_0x1ce0cc){_0xdc504b['status'](0x1f4)['json']({'success':![],'message':'Failed\x20to\x20get\x20domain\x20monitoring\x20statistics'});}}),router[a24_0x33a217(0x118)](a24_0x33a217(0x145),async(_0x19fd15,_0x5b2f80)=>{const _0x52c3ab=a24_0x33a217;try{const _0x331a2d=await domainMonitoringService_1['domainMonitoringService'][_0x52c3ab(0x12e)]();_0x5b2f80[_0x52c3ab(0x175)]({'success':!![],'result':{'domainAvailable':_0x331a2d,'message':_0x331a2d?_0x52c3ab(0x110):_0x52c3ab(0x14e),'timestamp':new Date()['toISOString']()}});}catch(_0x1de9aa){_0x5b2f80[_0x52c3ab(0x164)](0x1f4)['json']({'success':![],'message':_0x1de9aa instanceof Error?_0x1de9aa['message']:_0x52c3ab(0x105)});}}),exports['default']=router;