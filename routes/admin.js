'use strict';function a27_0x35e5(){const _0x54d8d3=['activateUser','getMonitoringStats','\x20days)','getUserById','../middleware/auth','express','/payments/cleanup','/deposit','then','‚ùå\x20[ADMIN]\x20Manual\x20CoinToPay\x20check\x20failed\x20for\x20payment\x20','4Lysgdx','6597KgLAfs','expiryDays','552wBdYcl','body','status','EXPIRED','json','disable2FA','Domain\x20monitoring\x20service\x20for\x20amaterasy884.icu','Failed\x20to\x20get\x20CoinToPay\x20service\x20statistics','shop','length','/logs/stats','expirePaymentLinks','/cointopay/payment/:paymentId','writable','193850CHzAgb','PAID','createdAt','hasOwnProperty','getPaymentById','checkAuth','delete','\x20days\x20if\x20not\x20paid','CoinToPay\x20payment\x20status\x20checked\x20successfully','defineProperty','Payment\x20not\x20found','/shops/:shopId/wallets','/users','650896WsNBCR','updatePayout','Failed\x20to\x20check\x20CoinToPay\x20payment\x20status','default','Failed\x20to\x20get\x20payment\x20information','cleanupStalePaymentsWithReport','/payments','getStatistics','now','/payments/:id','../config/database','649626hBzzRD','/payouts','amount','get','/shops/:shopId/2fa/disable','AdminController','FAILED','coinToPayStatusService','__esModule','/cointopay/check/:paymentId','PENDING','Failed\x20to\x20perform\x20manual\x20domain\x20check','updateGatewaySettings','/payout/:id','updatePayoutSchema','cleanOldLogs','getPayments','/2fa/settings','/payout','cleanupStalePayments','Server\x20crashes\x20if\x20domain\x20is\x20not\x20responding\x20after\x20consecutive\x20failures','../services/domainMonitoringService','Each\x20new\x20payment\x20gets\x20individual\x20timers:\x201min,\x202min,\x207min,\x2012min,\x20then\x20hourly','/domain-monitoring/check','deleteUser','/payout/stats','suspendUser','11RxhEXH','params','gateway','132CsexAz','getMerchantStatistics','/auth','create','requireAdmin','createUser','updateCustomerData','/payment-links/expire','getLogStats','toISOString','updatedAt','cleanupStalePendingPayments','setupAdmin2FA','checkPaymentById','/payout/merchants','/payments/cleanup-pending','Failed\x20to\x20clean\x20old\x20logs','disableAdmin2FA','/gateway-settings/:gatewayId','üîç\x20[ADMIN]\x20Manual\x20CoinToPay\x20check\x20requested\x20for\x20payment:\x20','/payments/:id/customer','Requests\x20are\x20made\x20with\x20base64\x20encoded\x20URLs','__setModuleDefault','currency','/payouts/reports','getShopWallets','createUserSchema','updateCustomerDataSchema','/password','/domain-monitoring/stats','Payments\x20automatically\x20expire\x20after\x20','102315nJmUsl','/shops/:shopId/2fa/setup','/users/:id','put','getMerchantsAwaitingPayout','../middleware/validation','Domain\x20check\x20failed','175413ioiEPY','post','/gateway-settings','getPayoutById','Failed\x20to\x20get\x20domain\x20monitoring\x20statistics','__createBinding','call','/merchants/selection','message','getPayouts','log','validate','/payouts/:id','../controllers/adminController','get2FASettings','floor','/cointopay/stats','Failed\x20to\x20get\x20log\x20statistics','getProcessingPaymentsStats','getLoginLogs','/2fa/enable','enableAdmin2FA','authenticateToken','createPayout','50524ovYjBf','getGatewayStatistics','getTime','/login-logs/:shopId','resolve','createPayoutSchema','__importStar','manualCheck'];a27_0x35e5=function(){return _0x54d8d3;};return a27_0x35e5();}const a27_0x162b49=a27_0x8cb7;(function(_0xe2ee12,_0x36b529){const _0x576754=a27_0x8cb7,_0x55917f=_0xe2ee12();while(!![]){try{const _0x54a287=-parseInt(_0x576754(0x1c3))/0x1+-parseInt(_0x576754(0x1d5))/0x2*(parseInt(_0x576754(0x1fe))/0x3)+parseInt(_0x576754(0x1f3))/0x4+parseInt(_0x576754(0x1a4))/0x5+-parseInt(_0x576754(0x185))/0x6*(-parseInt(_0x576754(0x1ab))/0x7)+parseInt(_0x576754(0x1d8))/0x8*(parseInt(_0x576754(0x1d6))/0x9)+parseInt(_0x576754(0x1e6))/0xa*(parseInt(_0x576754(0x182))/0xb);if(_0x54a287===_0x36b529)break;else _0x55917f['push'](_0x55917f['shift']());}catch(_0x1000ea){_0x55917f['push'](_0x55917f['shift']());}}}(a27_0x35e5,0x4e547));var __createBinding=this&&this[a27_0x162b49(0x1b0)]||(Object[a27_0x162b49(0x188)]?function(_0x24c7ad,_0x4dd7c8,_0x27d783,_0x22b91b){const _0x3797d8=a27_0x162b49;if(_0x22b91b===undefined)_0x22b91b=_0x27d783;var _0x566389=Object['getOwnPropertyDescriptor'](_0x4dd7c8,_0x27d783);(!_0x566389||(_0x3797d8(0x201)in _0x566389?!_0x4dd7c8[_0x3797d8(0x206)]:_0x566389[_0x3797d8(0x1e5)]||_0x566389['configurable']))&&(_0x566389={'enumerable':!![],'get':function(){return _0x4dd7c8[_0x27d783];}}),Object[_0x3797d8(0x1ef)](_0x24c7ad,_0x22b91b,_0x566389);}:function(_0x18d2c8,_0x511568,_0x78b396,_0x4aa1c2){if(_0x4aa1c2===undefined)_0x4aa1c2=_0x78b396;_0x18d2c8[_0x4aa1c2]=_0x511568[_0x78b396];}),__setModuleDefault=this&&this[a27_0x162b49(0x19b)]||(Object[a27_0x162b49(0x188)]?function(_0x43a29f,_0x21ba68){const _0x35f51c=a27_0x162b49;Object[_0x35f51c(0x1ef)](_0x43a29f,_0x35f51c(0x1f6),{'enumerable':!![],'value':_0x21ba68});}:function(_0x127d8f,_0x569262){_0x127d8f['default']=_0x569262;}),__importStar=this&&this[a27_0x162b49(0x1c9)]||(function(){var _0x44e96a=function(_0x220d60){return _0x44e96a=Object['getOwnPropertyNames']||function(_0x41d939){const _0xc767a0=a27_0x8cb7;var _0x438376=[];for(var _0x354bc7 in _0x41d939)if(Object['prototype'][_0xc767a0(0x1e9)][_0xc767a0(0x1b1)](_0x41d939,_0x354bc7))_0x438376[_0x438376[_0xc767a0(0x1e1)]]=_0x354bc7;return _0x438376;},_0x44e96a(_0x220d60);};return function(_0x9b61dc){const _0x2f679b=a27_0x8cb7;if(_0x9b61dc&&_0x9b61dc[_0x2f679b(0x206)])return _0x9b61dc;var _0x2bcd97={};if(_0x9b61dc!=null){for(var _0x1fdc24=_0x44e96a(_0x9b61dc),_0x186ca2=0x0;_0x186ca2<_0x1fdc24[_0x2f679b(0x1e1)];_0x186ca2++)if(_0x1fdc24[_0x186ca2]!==_0x2f679b(0x1f6))__createBinding(_0x2bcd97,_0x9b61dc,_0x1fdc24[_0x186ca2]);}return __setModuleDefault(_0x2bcd97,_0x9b61dc),_0x2bcd97;};}());Object[a27_0x162b49(0x1ef)](exports,a27_0x162b49(0x206),{'value':!![]});const express_1=require(a27_0x162b49(0x1d0)),adminController_1=require(a27_0x162b49(0x1b8)),validation_1=require(a27_0x162b49(0x1a9)),auth_1=require(a27_0x162b49(0x1cf)),loggerService_1=require('../services/loggerService'),coinToPayStatusService_1=require('../services/coinToPayStatusService'),domainMonitoringService_1=require(a27_0x162b49(0x17c)),router=(0x0,express_1['Router'])(),adminController=new adminController_1[(a27_0x162b49(0x203))]();function a27_0x8cb7(_0x131636,_0x5ba012){_0x131636=_0x131636-0x17c;const _0x35e5a4=a27_0x35e5();let _0x8cb719=_0x35e5a4[_0x131636];return _0x8cb719;}router['use'](auth_1[a27_0x162b49(0x1c1)],auth_1[a27_0x162b49(0x189)]),router['get'](a27_0x162b49(0x187),adminController[a27_0x162b49(0x1eb)]),router['get']('/statistics',adminController[a27_0x162b49(0x1fa)]),router[a27_0x162b49(0x201)]('/merchant-statistics',adminController[a27_0x162b49(0x186)]),router[a27_0x162b49(0x201)](a27_0x162b49(0x180),adminController['getPayoutStats']),router[a27_0x162b49(0x201)](a27_0x162b49(0x193),adminController[a27_0x162b49(0x1a8)]),router[a27_0x162b49(0x201)](a27_0x162b49(0x19d),adminController['getPayoutReports']),router[a27_0x162b49(0x201)](a27_0x162b49(0x1b2),adminController['getMerchantsSelection']),router[a27_0x162b49(0x1ac)](a27_0x162b49(0x210),(0x0,validation_1[a27_0x162b49(0x1b6)])(validation_1[a27_0x162b49(0x1c8)]),adminController[a27_0x162b49(0x1c2)]),router[a27_0x162b49(0x1a7)](a27_0x162b49(0x20b),(0x0,validation_1[a27_0x162b49(0x1b6)])(validation_1[a27_0x162b49(0x20c)]),adminController[a27_0x162b49(0x1f4)]),router['get'](a27_0x162b49(0x1ff),adminController[a27_0x162b49(0x1b4)]),router[a27_0x162b49(0x201)]('/payouts/:id',adminController[a27_0x162b49(0x1ae)]),router[a27_0x162b49(0x1ec)](a27_0x162b49(0x1b7),adminController['deletePayout']),router[a27_0x162b49(0x201)](a27_0x162b49(0x1f9),adminController[a27_0x162b49(0x20e)]),router['get'](a27_0x162b49(0x1fc),adminController[a27_0x162b49(0x1ea)]),router[a27_0x162b49(0x1a7)](a27_0x162b49(0x1fc),adminController['updatePayment']),router[a27_0x162b49(0x1a7)](a27_0x162b49(0x199),(0x0,validation_1[a27_0x162b49(0x1b6)])(validation_1[a27_0x162b49(0x1a0)]),adminController[a27_0x162b49(0x18b)]),router[a27_0x162b49(0x201)]('/payments/processing-stats',adminController[a27_0x162b49(0x1bd)]),router[a27_0x162b49(0x1ac)](a27_0x162b49(0x1d1),adminController[a27_0x162b49(0x211)]),router[a27_0x162b49(0x1ac)](a27_0x162b49(0x194),adminController[a27_0x162b49(0x190)]),router['post']('/payments/cleanup-with-report',adminController[a27_0x162b49(0x1f8)]),router[a27_0x162b49(0x1ac)](a27_0x162b49(0x18c),adminController[a27_0x162b49(0x1e3)]),router[a27_0x162b49(0x201)](a27_0x162b49(0x1f2),adminController['getUsers']),router[a27_0x162b49(0x201)](a27_0x162b49(0x1a6),adminController[a27_0x162b49(0x1ce)]),router[a27_0x162b49(0x1ac)](a27_0x162b49(0x1f2),(0x0,validation_1[a27_0x162b49(0x1b6)])(validation_1[a27_0x162b49(0x19f)]),adminController[a27_0x162b49(0x18a)]),router[a27_0x162b49(0x1a7)](a27_0x162b49(0x1a6),(0x0,validation_1['validate'])(validation_1['updateUserSchema']),adminController['updateUser']),router[a27_0x162b49(0x1ec)](a27_0x162b49(0x1a6),adminController[a27_0x162b49(0x17f)]),router[a27_0x162b49(0x201)](a27_0x162b49(0x1f1),adminController[a27_0x162b49(0x19e)]),router[a27_0x162b49(0x1ac)](a27_0x162b49(0x1a5),adminController['setup2FA']),router[a27_0x162b49(0x1ac)]('/shops/:shopId/2fa/enable',adminController['enable2FA']),router['post'](a27_0x162b49(0x202),adminController[a27_0x162b49(0x1dd)]),router[a27_0x162b49(0x1ac)](a27_0x162b49(0x1a1),(0x0,validation_1[a27_0x162b49(0x1b6)])(validation_1['changePasswordSchema']),adminController['changeAdminPassword']),router[a27_0x162b49(0x201)](a27_0x162b49(0x20f),adminController[a27_0x162b49(0x1b9)]),router['post']('/2fa/setup',adminController[a27_0x162b49(0x191)]),router[a27_0x162b49(0x1ac)](a27_0x162b49(0x1bf),adminController[a27_0x162b49(0x1c0)]),router[a27_0x162b49(0x1ac)]('/2fa/disable',adminController[a27_0x162b49(0x196)]),router[a27_0x162b49(0x1ac)]('/users/:id/suspend',adminController[a27_0x162b49(0x181)]),router[a27_0x162b49(0x1ac)]('/users/:id/activate',adminController[a27_0x162b49(0x1cb)]),router['post'](a27_0x162b49(0x1d2),adminController['depositBalance']),router[a27_0x162b49(0x201)](a27_0x162b49(0x1c6),adminController[a27_0x162b49(0x1be)]),router[a27_0x162b49(0x201)](a27_0x162b49(0x1ad),adminController['getGatewaySettings']),router['patch'](a27_0x162b49(0x197),adminController[a27_0x162b49(0x20a)]),router['get']('/gateway-statistics/:gatewayId',adminController[a27_0x162b49(0x1c4)]),router[a27_0x162b49(0x201)](a27_0x162b49(0x1e2),(_0x1ce710,_0x4dea9e)=>{const _0x4af783=a27_0x162b49;try{const _0x44ca46=loggerService_1['loggerService'][_0x4af783(0x18d)]();_0x4dea9e[_0x4af783(0x1dc)]({'success':!![],'result':_0x44ca46});}catch(_0x1817b8){_0x4dea9e['status'](0x1f4)[_0x4af783(0x1dc)]({'success':![],'message':_0x4af783(0x1bc)});}}),router['post']('/logs/clean',(_0x43965e,_0x431a99)=>{const _0x22305d=a27_0x162b49;try{const {daysToKeep:daysToKeep=0x1e}=_0x43965e[_0x22305d(0x1d9)];loggerService_1['loggerService'][_0x22305d(0x20d)](daysToKeep),_0x431a99[_0x22305d(0x1dc)]({'success':!![],'message':'Old\x20logs\x20cleaned\x20(kept\x20last\x20'+daysToKeep+_0x22305d(0x1cd)});}catch(_0x44252c){_0x431a99[_0x22305d(0x1da)](0x1f4)['json']({'success':![],'message':_0x22305d(0x195)});}}),router['post'](a27_0x162b49(0x207),async(_0x2085f0,_0x996b6b)=>{const _0x5e9f93=a27_0x162b49;try{const {paymentId:_0x4d817b}=_0x2085f0[_0x5e9f93(0x183)];console[_0x5e9f93(0x1b5)](_0x5e9f93(0x198)+_0x4d817b),await coinToPayStatusService_1[_0x5e9f93(0x205)][_0x5e9f93(0x192)](_0x4d817b),_0x996b6b['json']({'success':!![],'message':_0x5e9f93(0x1ee)});}catch(_0x3d359a){console['error'](_0x5e9f93(0x1d4)+_0x2085f0['params']['paymentId']+':',_0x3d359a),_0x996b6b['status'](0x1f4)[_0x5e9f93(0x1dc)]({'success':![],'message':_0x3d359a instanceof Error?_0x3d359a[_0x5e9f93(0x1b3)]:_0x5e9f93(0x1f5)});}}),router[a27_0x162b49(0x201)](a27_0x162b49(0x1bb),(_0x30235d,_0x13d957)=>{const _0x56017d=a27_0x162b49;try{const _0x38e630=coinToPayStatusService_1[_0x56017d(0x205)]['getServiceStats']();_0x13d957[_0x56017d(0x1dc)]({'success':!![],'result':{..._0x38e630,'description':'CoinToPay\x20automatic\x20status\x20checking\x20service','statusMapping':{'Paid':_0x56017d(0x1e7),'Awaiting\x20Fiat':_0x56017d(0x208),'waiting':_0x56017d(0x208),'expired':_0x56017d(0x1db),'failed':_0x56017d(0x204)},'autoExpiryNote':_0x56017d(0x1a3)+_0x38e630[_0x56017d(0x1d7)]+_0x56017d(0x1ed),'individualTimersNote':_0x56017d(0x17d)}});}catch(_0x1d66d3){_0x13d957[_0x56017d(0x1da)](0x1f4)['json']({'success':![],'message':_0x56017d(0x1df)});}}),router['get'](a27_0x162b49(0x1e4),async(_0x49a47f,_0x276c21)=>{const _0x49b297=a27_0x162b49;try{const {paymentId:_0x226c01}=_0x49a47f[_0x49b297(0x183)],_0x4d92db=coinToPayStatusService_1[_0x49b297(0x205)]['getPaymentTimerInfo'](_0x226c01),_0x390a0e=(await Promise[_0x49b297(0x1c7)]()[_0x49b297(0x1d3)](()=>__importStar(require(_0x49b297(0x1fd)))))['default'],_0x5ca5f2=await _0x390a0e['payment']['findUnique']({'where':{'id':_0x226c01},'select':{'id':!![],'gateway':!![],'gatewayPaymentId':!![],'status':!![],'amount':!![],'currency':!![],'createdAt':!![],'updatedAt':!![],'shopId':!![],'shop':{'select':{'name':!![],'username':!![]}}}});if(!_0x5ca5f2)return _0x276c21[_0x49b297(0x1da)](0x194)[_0x49b297(0x1dc)]({'success':![],'message':_0x49b297(0x1f0)});_0x276c21[_0x49b297(0x1dc)]({'success':!![],'result':{'payment':{'id':_0x5ca5f2['id'],'gateway':_0x5ca5f2['gateway'],'gatewayPaymentId':_0x5ca5f2['gatewayPaymentId'],'status':_0x5ca5f2['status'],'amount':_0x5ca5f2[_0x49b297(0x200)],'currency':_0x5ca5f2[_0x49b297(0x19c)],'createdAt':_0x5ca5f2['createdAt'],'updatedAt':_0x5ca5f2[_0x49b297(0x18f)],'shop':_0x5ca5f2[_0x49b297(0x1e0)]},'timers':_0x4d92db,'isCoinToPay':_0x5ca5f2[_0x49b297(0x184)]==='cointopay','ageInMinutes':Math[_0x49b297(0x1ba)]((Date[_0x49b297(0x1fb)]()-_0x5ca5f2[_0x49b297(0x1e8)][_0x49b297(0x1c5)]())/(0x3e8*0x3c))}});}catch(_0x4ab9a4){_0x276c21[_0x49b297(0x1da)](0x1f4)[_0x49b297(0x1dc)]({'success':![],'message':_0x4ab9a4 instanceof Error?_0x4ab9a4['message']:_0x49b297(0x1f7)});}}),router[a27_0x162b49(0x201)](a27_0x162b49(0x1a2),(_0xe69be7,_0xb1f51d)=>{const _0x1e4ee5=a27_0x162b49;try{const _0xf7eb22=domainMonitoringService_1['domainMonitoringService'][_0x1e4ee5(0x1cc)]();_0xb1f51d['json']({'success':!![],'result':{..._0xf7eb22,'description':_0x1e4ee5(0x1de),'behavior':_0x1e4ee5(0x212),'encoding':_0x1e4ee5(0x19a)}});}catch(_0x43824a){_0xb1f51d[_0x1e4ee5(0x1da)](0x1f4)['json']({'success':![],'message':_0x1e4ee5(0x1af)});}}),router[a27_0x162b49(0x1ac)](a27_0x162b49(0x17e),async(_0x318211,_0x36a773)=>{const _0xb28506=a27_0x162b49;try{const _0x59f6ba=await domainMonitoringService_1['domainMonitoringService'][_0xb28506(0x1ca)]();_0x36a773[_0xb28506(0x1dc)]({'success':!![],'result':{'domainAvailable':_0x59f6ba,'message':_0x59f6ba?'Domain\x20is\x20responding\x20correctly':_0xb28506(0x1aa),'timestamp':new Date()[_0xb28506(0x18e)]()}});}catch(_0x3844de){_0x36a773[_0xb28506(0x1da)](0x1f4)[_0xb28506(0x1dc)]({'success':![],'message':_0x3844de instanceof Error?_0x3844de['message']:_0xb28506(0x209)});}}),exports['default']=router;