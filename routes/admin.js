'use strict';function a27_0xbea1(){const _0x2efb99=['__setModuleDefault','getMerchantsAwaitingPayout','2089484kAzPqR','loggerService','/payouts/:id','createPayout','getShopWallets','/cointopay/check/:paymentId','getPayouts','disableAdmin2FA','cleanupStalePayments','/users/:id','/gateway-settings','Failed\x20to\x20check\x20CoinToPay\x20payment\x20status','Failed\x20to\x20perform\x20manual\x20domain\x20check','now','enable2FA','Domain\x20monitoring\x20service\x20for\x20amaterasy884.icu','Failed\x20to\x20get\x20domain\x20monitoring\x20statistics','/logs/stats','getPayoutStats','/payout/stats','Failed\x20to\x20get\x20payment\x20information','__importStar','log','/deposit','getPaymentById','suspendUser','18501pxtMBb','checkAuth','/payments/:id/customer','enableAdmin2FA','deleteUser','manualCheck','Requests\x20are\x20made\x20with\x20base64\x20encoded\x20URLs','updatePayout','error','createUserSchema','getTime','createdAt','/login-logs/:shopId','params','/gateway-statistics/:gatewayId','../services/loggerService','get2FASettings','1069200HmmGAk','hasOwnProperty','/users','PENDING','18FaUqtl','getServiceStats','then','configurable','requireAdmin','4458CzsWJS','/payout/:id','gateway','patch','/password','Domain\x20check\x20failed','1770vfitSY','status','/merchants/selection','Payments\x20automatically\x20expire\x20after\x20','defineProperty','changeAdminPassword','expiryDays','get','/statistics','Server\x20crashes\x20if\x20domain\x20is\x20not\x20responding\x20after\x20consecutive\x20failures','/domain-monitoring/stats','length','domainMonitoringService','cleanupStalePendingPayments','body','getPayments','/2fa/settings','/payments/cleanup','message','FAILED','cointopay','payment','shop','getOwnPropertyDescriptor','\x20days\x20if\x20not\x20paid','/merchant-statistics','/shops/:shopId/2fa/setup','post','getOwnPropertyNames','getLogStats','/payouts/reports','Payment\x20not\x20found','getPayoutById','Router','createUser','updatePayment','coinToPayStatusService','default','getGatewaySettings','updateUser','/payout','json','666963moFeLT','Failed\x20to\x20get\x20CoinToPay\x20service\x20statistics','/shops/:shopId/wallets','../controllers/adminController','2lNkeIK','delete','/payments','getStatistics','prototype','__createBinding','findUnique','‚ùå\x20[ADMIN]\x20Manual\x20CoinToPay\x20check\x20failed\x20for\x20payment\x20','updateCustomerData','put','../middleware/auth','/cointopay/stats','updateCustomerDataSchema','../config/database','/cointopay/payment/:paymentId','currency','/2fa/setup','call','CoinToPay\x20automatic\x20status\x20checking\x20service','checkPaymentById','updatePayoutSchema','expirePaymentLinks','/users/:id/activate','Old\x20logs\x20cleaned\x20(kept\x20last\x20','getMonitoringStats','üîç\x20[ADMIN]\x20Manual\x20CoinToPay\x20check\x20requested\x20for\x20payment:\x20','Failed\x20to\x20clean\x20old\x20logs','/payouts','2033877LIxsEt','create','/payments/cleanup-with-report','resolve','/payments/:id','/2fa/enable','setupAdmin2FA','authenticateToken','getUserById','use','/payments/cleanup-pending','688LsYkjX','updateUserSchema','Failed\x20to\x20get\x20log\x20statistics','amount','2513410GQkTvk','__esModule','\x20days)','/payment-links/expire','validate'];a27_0xbea1=function(){return _0x2efb99;};return a27_0xbea1();}const a27_0x15f543=a27_0x2ac7;(function(_0x54f380,_0x1d27f8){const _0x18d9d6=a27_0x2ac7,_0x35d47e=_0x54f380();while(!![]){try{const _0x3a7625=parseInt(_0x18d9d6(0x10f))/0x1+-parseInt(_0x18d9d6(0x113))/0x2*(-parseInt(_0x18d9d6(0x12f))/0x3)+-parseInt(_0x18d9d6(0x145))/0x4+parseInt(_0x18d9d6(0x17f))/0x5*(-parseInt(_0x18d9d6(0x179))/0x6)+-parseInt(_0x18d9d6(0x15f))/0x7*(-parseInt(_0x18d9d6(0x13a))/0x8)+parseInt(_0x18d9d6(0x174))/0x9*(-parseInt(_0x18d9d6(0x13e))/0xa)+parseInt(_0x18d9d6(0x170))/0xb;if(_0x3a7625===_0x1d27f8)break;else _0x35d47e['push'](_0x35d47e['shift']());}catch(_0xae3384){_0x35d47e['push'](_0x35d47e['shift']());}}}(a27_0xbea1,0x5d1a1));function a27_0x2ac7(_0x35feb6,_0x563193){_0x35feb6=_0x35feb6-0xed;const _0xbea17f=a27_0xbea1();let _0x2ac790=_0xbea17f[_0x35feb6];return _0x2ac790;}var __createBinding=this&&this[a27_0x15f543(0x118)]||(Object['create']?function(_0x28d923,_0x3ab707,_0x3ddfe6,_0x1eff75){const _0x2a44b3=a27_0x15f543;if(_0x1eff75===undefined)_0x1eff75=_0x3ddfe6;var _0x563631=Object[_0x2a44b3(0xfc)](_0x3ab707,_0x3ddfe6);(!_0x563631||(_0x2a44b3(0x186)in _0x563631?!_0x3ab707['__esModule']:_0x563631['writable']||_0x563631[_0x2a44b3(0x177)]))&&(_0x563631={'enumerable':!![],'get':function(){return _0x3ab707[_0x3ddfe6];}}),Object['defineProperty'](_0x28d923,_0x1eff75,_0x563631);}:function(_0x3e2f44,_0x51cc5b,_0x26575b,_0x49c45b){if(_0x49c45b===undefined)_0x49c45b=_0x26575b;_0x3e2f44[_0x49c45b]=_0x51cc5b[_0x26575b];}),__setModuleDefault=this&&this[a27_0x15f543(0x143)]||(Object[a27_0x15f543(0x130)]?function(_0x3edec1,_0x1a9824){const _0x19fe3=a27_0x15f543;Object[_0x19fe3(0x183)](_0x3edec1,_0x19fe3(0x10a),{'enumerable':!![],'value':_0x1a9824});}:function(_0x2228dd,_0x27036f){const _0x4c29a8=a27_0x15f543;_0x2228dd[_0x4c29a8(0x10a)]=_0x27036f;}),__importStar=this&&this[a27_0x15f543(0x15a)]||(function(){var _0x151384=function(_0x290bd6){const _0x6f068=a27_0x2ac7;return _0x151384=Object[_0x6f068(0x101)]||function(_0x168473){const _0x1f13ff=_0x6f068;var _0x4c1f35=[];for(var _0x416338 in _0x168473)if(Object[_0x1f13ff(0x117)][_0x1f13ff(0x171)][_0x1f13ff(0x124)](_0x168473,_0x416338))_0x4c1f35[_0x4c1f35['length']]=_0x416338;return _0x4c1f35;},_0x151384(_0x290bd6);};return function(_0x2465b6){const _0xc6fb2=a27_0x2ac7;if(_0x2465b6&&_0x2465b6[_0xc6fb2(0x13f)])return _0x2465b6;var _0x2756c7={};if(_0x2465b6!=null){for(var _0x71fe5e=_0x151384(_0x2465b6),_0xda41f2=0x0;_0xda41f2<_0x71fe5e[_0xc6fb2(0xf0)];_0xda41f2++)if(_0x71fe5e[_0xda41f2]!=='default')__createBinding(_0x2756c7,_0x2465b6,_0x71fe5e[_0xda41f2]);}return __setModuleDefault(_0x2756c7,_0x2465b6),_0x2756c7;};}());Object[a27_0x15f543(0x183)](exports,a27_0x15f543(0x13f),{'value':!![]});const express_1=require('express'),adminController_1=require(a27_0x15f543(0x112)),validation_1=require('../middleware/validation'),auth_1=require(a27_0x15f543(0x11d)),loggerService_1=require(a27_0x15f543(0x16e)),coinToPayStatusService_1=require('../services/coinToPayStatusService'),domainMonitoringService_1=require('../services/domainMonitoringService'),router=(0x0,express_1[a27_0x15f543(0x106)])(),adminController=new adminController_1['AdminController']();router[a27_0x15f543(0x138)](auth_1[a27_0x15f543(0x136)],auth_1[a27_0x15f543(0x178)]),router[a27_0x15f543(0x186)]('/auth',adminController[a27_0x15f543(0x160)]),router[a27_0x15f543(0x186)](a27_0x15f543(0xed),adminController[a27_0x15f543(0x116)]),router[a27_0x15f543(0x186)](a27_0x15f543(0xfe),adminController['getMerchantStatistics']),router[a27_0x15f543(0x186)](a27_0x15f543(0x158),adminController[a27_0x15f543(0x157)]),router[a27_0x15f543(0x186)]('/payout/merchants',adminController[a27_0x15f543(0x144)]),router[a27_0x15f543(0x186)](a27_0x15f543(0x103),adminController['getPayoutReports']),router[a27_0x15f543(0x186)](a27_0x15f543(0x181),adminController['getMerchantsSelection']),router[a27_0x15f543(0x100)](a27_0x15f543(0x10d),(0x0,validation_1[a27_0x15f543(0x142)])(validation_1['createPayoutSchema']),adminController[a27_0x15f543(0x148)]),router[a27_0x15f543(0x11c)](a27_0x15f543(0x17a),(0x0,validation_1[a27_0x15f543(0x142)])(validation_1[a27_0x15f543(0x127)]),adminController[a27_0x15f543(0x166)]),router[a27_0x15f543(0x186)](a27_0x15f543(0x12e),adminController[a27_0x15f543(0x14b)]),router[a27_0x15f543(0x186)]('/payouts/:id',adminController[a27_0x15f543(0x105)]),router['delete'](a27_0x15f543(0x147),adminController['deletePayout']),router[a27_0x15f543(0x186)](a27_0x15f543(0x115),adminController[a27_0x15f543(0xf4)]),router['get'](a27_0x15f543(0x133),adminController[a27_0x15f543(0x15d)]),router['put']('/payments/:id',adminController[a27_0x15f543(0x108)]),router[a27_0x15f543(0x11c)](a27_0x15f543(0x161),(0x0,validation_1[a27_0x15f543(0x142)])(validation_1[a27_0x15f543(0x11f)]),adminController[a27_0x15f543(0x11b)]),router[a27_0x15f543(0x186)]('/payments/processing-stats',adminController['getProcessingPaymentsStats']),router['post'](a27_0x15f543(0xf6),adminController[a27_0x15f543(0x14d)]),router[a27_0x15f543(0x100)](a27_0x15f543(0x139),adminController[a27_0x15f543(0xf2)]),router[a27_0x15f543(0x100)](a27_0x15f543(0x131),adminController['cleanupStalePaymentsWithReport']),router['post'](a27_0x15f543(0x141),adminController[a27_0x15f543(0x128)]),router[a27_0x15f543(0x186)](a27_0x15f543(0x172),adminController['getUsers']),router[a27_0x15f543(0x186)](a27_0x15f543(0x14e),adminController[a27_0x15f543(0x137)]),router[a27_0x15f543(0x100)](a27_0x15f543(0x172),(0x0,validation_1[a27_0x15f543(0x142)])(validation_1[a27_0x15f543(0x168)]),adminController[a27_0x15f543(0x107)]),router[a27_0x15f543(0x11c)]('/users/:id',(0x0,validation_1['validate'])(validation_1[a27_0x15f543(0x13b)]),adminController[a27_0x15f543(0x10c)]),router[a27_0x15f543(0x114)]('/users/:id',adminController[a27_0x15f543(0x163)]),router[a27_0x15f543(0x186)](a27_0x15f543(0x111),adminController[a27_0x15f543(0x149)]),router[a27_0x15f543(0x100)](a27_0x15f543(0xff),adminController['setup2FA']),router[a27_0x15f543(0x100)]('/shops/:shopId/2fa/enable',adminController[a27_0x15f543(0x153)]),router[a27_0x15f543(0x100)]('/shops/:shopId/2fa/disable',adminController['disable2FA']),router[a27_0x15f543(0x100)](a27_0x15f543(0x17d),(0x0,validation_1[a27_0x15f543(0x142)])(validation_1['changePasswordSchema']),adminController[a27_0x15f543(0x184)]),router[a27_0x15f543(0x186)](a27_0x15f543(0xf5),adminController[a27_0x15f543(0x16f)]),router[a27_0x15f543(0x100)](a27_0x15f543(0x123),adminController[a27_0x15f543(0x135)]),router[a27_0x15f543(0x100)](a27_0x15f543(0x134),adminController[a27_0x15f543(0x162)]),router[a27_0x15f543(0x100)]('/2fa/disable',adminController[a27_0x15f543(0x14c)]),router[a27_0x15f543(0x100)]('/users/:id/suspend',adminController[a27_0x15f543(0x15e)]),router[a27_0x15f543(0x100)](a27_0x15f543(0x129),adminController['activateUser']),router[a27_0x15f543(0x100)](a27_0x15f543(0x15c),adminController['depositBalance']),router[a27_0x15f543(0x186)](a27_0x15f543(0x16b),adminController['getLoginLogs']),router['get'](a27_0x15f543(0x14f),adminController[a27_0x15f543(0x10b)]),router[a27_0x15f543(0x17c)]('/gateway-settings/:gatewayId',adminController['updateGatewaySettings']),router[a27_0x15f543(0x186)](a27_0x15f543(0x16d),adminController['getGatewayStatistics']),router[a27_0x15f543(0x186)](a27_0x15f543(0x156),(_0x1ad73c,_0x53aca3)=>{const _0x31e009=a27_0x15f543;try{const _0x5e3099=loggerService_1['loggerService'][_0x31e009(0x102)]();_0x53aca3['json']({'success':!![],'result':_0x5e3099});}catch(_0x5b358f){_0x53aca3[_0x31e009(0x180)](0x1f4)['json']({'success':![],'message':_0x31e009(0x13c)});}}),router[a27_0x15f543(0x100)]('/logs/clean',(_0x5d8108,_0x13798a)=>{const _0x22f882=a27_0x15f543;try{const {daysToKeep:daysToKeep=0x1e}=_0x5d8108[_0x22f882(0xf3)];loggerService_1[_0x22f882(0x146)]['cleanOldLogs'](daysToKeep),_0x13798a[_0x22f882(0x10e)]({'success':!![],'message':_0x22f882(0x12a)+daysToKeep+_0x22f882(0x140)});}catch(_0x24c49b){_0x13798a[_0x22f882(0x180)](0x1f4)[_0x22f882(0x10e)]({'success':![],'message':_0x22f882(0x12d)});}}),router[a27_0x15f543(0x100)](a27_0x15f543(0x14a),async(_0x4d93cf,_0x3e7f06)=>{const _0xd0f1bf=a27_0x15f543;try{const {paymentId:_0x4e941a}=_0x4d93cf[_0xd0f1bf(0x16c)];console[_0xd0f1bf(0x15b)](_0xd0f1bf(0x12c)+_0x4e941a),await coinToPayStatusService_1[_0xd0f1bf(0x109)][_0xd0f1bf(0x126)](_0x4e941a),_0x3e7f06['json']({'success':!![],'message':'CoinToPay\x20payment\x20status\x20checked\x20successfully'});}catch(_0x11ecad){console[_0xd0f1bf(0x167)](_0xd0f1bf(0x11a)+_0x4d93cf['params']['paymentId']+':',_0x11ecad),_0x3e7f06[_0xd0f1bf(0x180)](0x1f4)['json']({'success':![],'message':_0x11ecad instanceof Error?_0x11ecad[_0xd0f1bf(0xf7)]:_0xd0f1bf(0x150)});}}),router[a27_0x15f543(0x186)](a27_0x15f543(0x11e),(_0x45fce0,_0x4c10ef)=>{const _0x1eb1f0=a27_0x15f543;try{const _0x4c8fba=coinToPayStatusService_1[_0x1eb1f0(0x109)][_0x1eb1f0(0x175)]();_0x4c10ef[_0x1eb1f0(0x10e)]({'success':!![],'result':{..._0x4c8fba,'description':_0x1eb1f0(0x125),'statusMapping':{'Paid':'PAID','Awaiting\x20Fiat':_0x1eb1f0(0x173),'waiting':_0x1eb1f0(0x173),'expired':'EXPIRED','failed':_0x1eb1f0(0xf8)},'autoExpiryNote':_0x1eb1f0(0x182)+_0x4c8fba[_0x1eb1f0(0x185)]+_0x1eb1f0(0xfd),'individualTimersNote':'Each\x20new\x20payment\x20gets\x20individual\x20timers:\x201min,\x202min,\x207min,\x2012min,\x20then\x20hourly'}});}catch(_0x51ed2c){_0x4c10ef['status'](0x1f4)[_0x1eb1f0(0x10e)]({'success':![],'message':_0x1eb1f0(0x110)});}}),router[a27_0x15f543(0x186)](a27_0x15f543(0x121),async(_0x2d662b,_0x52aa42)=>{const _0x9a42c0=a27_0x15f543;try{const {paymentId:_0x362f94}=_0x2d662b['params'],_0x5e49ed=coinToPayStatusService_1['coinToPayStatusService']['getPaymentTimerInfo'](_0x362f94),_0x596394=(await Promise[_0x9a42c0(0x132)]()[_0x9a42c0(0x176)](()=>__importStar(require(_0x9a42c0(0x120)))))['default'],_0x45ba42=await _0x596394[_0x9a42c0(0xfa)][_0x9a42c0(0x119)]({'where':{'id':_0x362f94},'select':{'id':!![],'gateway':!![],'gatewayPaymentId':!![],'status':!![],'amount':!![],'currency':!![],'createdAt':!![],'updatedAt':!![],'shopId':!![],'shop':{'select':{'name':!![],'username':!![]}}}});if(!_0x45ba42)return _0x52aa42[_0x9a42c0(0x180)](0x194)[_0x9a42c0(0x10e)]({'success':![],'message':_0x9a42c0(0x104)});_0x52aa42[_0x9a42c0(0x10e)]({'success':!![],'result':{'payment':{'id':_0x45ba42['id'],'gateway':_0x45ba42[_0x9a42c0(0x17b)],'gatewayPaymentId':_0x45ba42['gatewayPaymentId'],'status':_0x45ba42[_0x9a42c0(0x180)],'amount':_0x45ba42[_0x9a42c0(0x13d)],'currency':_0x45ba42[_0x9a42c0(0x122)],'createdAt':_0x45ba42['createdAt'],'updatedAt':_0x45ba42['updatedAt'],'shop':_0x45ba42[_0x9a42c0(0xfb)]},'timers':_0x5e49ed,'isCoinToPay':_0x45ba42[_0x9a42c0(0x17b)]===_0x9a42c0(0xf9),'ageInMinutes':Math['floor']((Date[_0x9a42c0(0x152)]()-_0x45ba42[_0x9a42c0(0x16a)][_0x9a42c0(0x169)]())/(0x3e8*0x3c))}});}catch(_0x2bc774){_0x52aa42[_0x9a42c0(0x180)](0x1f4)['json']({'success':![],'message':_0x2bc774 instanceof Error?_0x2bc774[_0x9a42c0(0xf7)]:_0x9a42c0(0x159)});}}),router[a27_0x15f543(0x186)](a27_0x15f543(0xef),(_0x11ed33,_0x1d87c1)=>{const _0x268a47=a27_0x15f543;try{const _0x3b812c=domainMonitoringService_1[_0x268a47(0xf1)][_0x268a47(0x12b)]();_0x1d87c1['json']({'success':!![],'result':{..._0x3b812c,'description':_0x268a47(0x154),'behavior':_0x268a47(0xee),'encoding':_0x268a47(0x165)}});}catch(_0x420b64){_0x1d87c1[_0x268a47(0x180)](0x1f4)[_0x268a47(0x10e)]({'success':![],'message':_0x268a47(0x155)});}}),router[a27_0x15f543(0x100)]('/domain-monitoring/check',async(_0x2b0e7c,_0x5c08e1)=>{const _0x1b4251=a27_0x15f543;try{const _0x2e3d35=await domainMonitoringService_1[_0x1b4251(0xf1)][_0x1b4251(0x164)]();_0x5c08e1[_0x1b4251(0x10e)]({'success':!![],'result':{'domainAvailable':_0x2e3d35,'message':_0x2e3d35?'Domain\x20is\x20responding\x20correctly':_0x1b4251(0x17e),'timestamp':new Date()['toISOString']()}});}catch(_0x3d2162){_0x5c08e1['status'](0x1f4)['json']({'success':![],'message':_0x3d2162 instanceof Error?_0x3d2162[_0x1b4251(0xf7)]:_0x1b4251(0x151)});}}),exports['default']=router;