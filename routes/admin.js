'use strict';const a20_0x329d3e=a20_0x1d73;function a20_0x1d73(_0x2c13f4,_0x389766){const _0x2d164d=a20_0x2d16();return a20_0x1d73=function(_0x1d731e,_0x4745e8){_0x1d731e=_0x1d731e-0x1d7;let _0x52a6e7=_0x2d164d[_0x1d731e];return _0x52a6e7;},a20_0x1d73(_0x2c13f4,_0x389766);}(function(_0x2ea674,_0x10ee85){const _0x34c13c=a20_0x1d73,_0x171057=_0x2ea674();while(!![]){try{const _0x3eca11=-parseInt(_0x34c13c(0x203))/0x1+parseInt(_0x34c13c(0x219))/0x2+parseInt(_0x34c13c(0x1fa))/0x3+parseInt(_0x34c13c(0x22e))/0x4+-parseInt(_0x34c13c(0x253))/0x5*(-parseInt(_0x34c13c(0x200))/0x6)+-parseInt(_0x34c13c(0x23e))/0x7*(parseInt(_0x34c13c(0x1f7))/0x8)+-parseInt(_0x34c13c(0x1e6))/0x9;if(_0x3eca11===_0x10ee85)break;else _0x171057['push'](_0x171057['shift']());}catch(_0x37a7c5){_0x171057['push'](_0x171057['shift']());}}}(a20_0x2d16,0xeaf9d));var __createBinding=this&&this[a20_0x329d3e(0x22b)]||(Object[a20_0x329d3e(0x24f)]?function(_0x5e8c15,_0x4f6554,_0xf5e860,_0x1398b8){const _0x51e605=a20_0x329d3e;if(_0x1398b8===undefined)_0x1398b8=_0xf5e860;var _0x5873ff=Object[_0x51e605(0x1f3)](_0x4f6554,_0xf5e860);(!_0x5873ff||(_0x51e605(0x20f)in _0x5873ff?!_0x4f6554[_0x51e605(0x24b)]:_0x5873ff['writable']||_0x5873ff[_0x51e605(0x231)]))&&(_0x5873ff={'enumerable':!![],'get':function(){return _0x4f6554[_0xf5e860];}}),Object[_0x51e605(0x1db)](_0x5e8c15,_0x1398b8,_0x5873ff);}:function(_0x10d833,_0x1d625a,_0x18c8e7,_0x57bf85){if(_0x57bf85===undefined)_0x57bf85=_0x18c8e7;_0x10d833[_0x57bf85]=_0x1d625a[_0x18c8e7];}),__setModuleDefault=this&&this['__setModuleDefault']||(Object['create']?function(_0x29b067,_0x2f45cc){const _0x1c5b5f=a20_0x329d3e;Object[_0x1c5b5f(0x1db)](_0x29b067,_0x1c5b5f(0x214),{'enumerable':!![],'value':_0x2f45cc});}:function(_0x57fa07,_0x44218f){const _0x6effd0=a20_0x329d3e;_0x57fa07[_0x6effd0(0x214)]=_0x44218f;}),__importStar=this&&this[a20_0x329d3e(0x1d8)]||(function(){var _0x9162c6=function(_0x15407f){const _0x642df7=a20_0x1d73;return _0x9162c6=Object[_0x642df7(0x20d)]||function(_0x42fb32){const _0x5c3eb8=_0x642df7;var _0x5b6064=[];for(var _0x12e842 in _0x42fb32)if(Object[_0x5c3eb8(0x22c)][_0x5c3eb8(0x20a)][_0x5c3eb8(0x228)](_0x42fb32,_0x12e842))_0x5b6064[_0x5b6064[_0x5c3eb8(0x23f)]]=_0x12e842;return _0x5b6064;},_0x9162c6(_0x15407f);};return function(_0xa8d088){const _0x3d25d9=a20_0x1d73;if(_0xa8d088&&_0xa8d088[_0x3d25d9(0x24b)])return _0xa8d088;var _0x4f104a={};if(_0xa8d088!=null){for(var _0x1da82d=_0x9162c6(_0xa8d088),_0x59d321=0x0;_0x59d321<_0x1da82d[_0x3d25d9(0x23f)];_0x59d321++)if(_0x1da82d[_0x59d321]!==_0x3d25d9(0x214))__createBinding(_0x4f104a,_0xa8d088,_0x1da82d[_0x59d321]);}return __setModuleDefault(_0x4f104a,_0xa8d088),_0x4f104a;};}());Object[a20_0x329d3e(0x1db)](exports,a20_0x329d3e(0x24b),{'value':!![]});const express_1=require(a20_0x329d3e(0x1da)),adminController_1=require(a20_0x329d3e(0x235)),validation_1=require(a20_0x329d3e(0x21f)),auth_1=require('../middleware/auth'),loggerService_1=require(a20_0x329d3e(0x22f)),coinToPayStatusService_1=require(a20_0x329d3e(0x1ed)),domainMonitoringService_1=require(a20_0x329d3e(0x21e)),router=(0x0,express_1[a20_0x329d3e(0x20b)])(),adminController=new adminController_1[(a20_0x329d3e(0x243))]();router[a20_0x329d3e(0x217)](auth_1[a20_0x329d3e(0x209)],auth_1[a20_0x329d3e(0x246)]),router['get'](a20_0x329d3e(0x249),adminController['checkAuth']),router[a20_0x329d3e(0x20f)](a20_0x329d3e(0x1ec),adminController[a20_0x329d3e(0x236)]),router[a20_0x329d3e(0x20f)]('/merchant-statistics',adminController['getMerchantStatistics']),router[a20_0x329d3e(0x20f)](a20_0x329d3e(0x237),adminController['getPayoutStats']),router[a20_0x329d3e(0x20f)]('/payout/merchants',adminController[a20_0x329d3e(0x24c)]),router[a20_0x329d3e(0x20f)]('/merchants/selection',adminController['getMerchantsSelection']),router[a20_0x329d3e(0x234)](a20_0x329d3e(0x252),(0x0,validation_1['validate'])(validation_1[a20_0x329d3e(0x230)]),adminController[a20_0x329d3e(0x220)]),router['get'](a20_0x329d3e(0x1d7),adminController[a20_0x329d3e(0x255)]),router['get'](a20_0x329d3e(0x215),adminController[a20_0x329d3e(0x207)]),router[a20_0x329d3e(0x222)](a20_0x329d3e(0x215),adminController[a20_0x329d3e(0x1ef)]),router[a20_0x329d3e(0x20f)](a20_0x329d3e(0x244),adminController['getPayments']),router[a20_0x329d3e(0x20f)](a20_0x329d3e(0x1eb),adminController[a20_0x329d3e(0x20c)]),router[a20_0x329d3e(0x1e8)](a20_0x329d3e(0x1eb),adminController[a20_0x329d3e(0x1ee)]),router[a20_0x329d3e(0x1e8)]('/payments/:id/customer',(0x0,validation_1[a20_0x329d3e(0x212)])(validation_1[a20_0x329d3e(0x1f9)]),adminController[a20_0x329d3e(0x23b)]),router['get'](a20_0x329d3e(0x1f2),adminController[a20_0x329d3e(0x1f4)]),router['post']('/payments/cleanup',adminController[a20_0x329d3e(0x224)]),router[a20_0x329d3e(0x234)](a20_0x329d3e(0x206),adminController[a20_0x329d3e(0x250)]),router[a20_0x329d3e(0x20f)]('/users',adminController[a20_0x329d3e(0x21a)]),router[a20_0x329d3e(0x20f)]('/users/:id',adminController[a20_0x329d3e(0x233)]),router[a20_0x329d3e(0x234)](a20_0x329d3e(0x1dc),(0x0,validation_1['validate'])(validation_1[a20_0x329d3e(0x204)]),adminController[a20_0x329d3e(0x213)]),router[a20_0x329d3e(0x1e8)](a20_0x329d3e(0x241),(0x0,validation_1[a20_0x329d3e(0x212)])(validation_1['updateUserSchema']),adminController[a20_0x329d3e(0x1fb)]),router['delete'](a20_0x329d3e(0x241),adminController[a20_0x329d3e(0x227)]),router[a20_0x329d3e(0x234)](a20_0x329d3e(0x1f6),adminController[a20_0x329d3e(0x1d9)]),router[a20_0x329d3e(0x234)](a20_0x329d3e(0x245),adminController['activateUser']),router[a20_0x329d3e(0x20f)]('/logs/stats',(_0xd27e92,_0x42d7ea)=>{const _0x76dafa=a20_0x329d3e;try{const _0x59b5e9=loggerService_1[_0x76dafa(0x22d)]['getLogStats']();_0x42d7ea['json']({'success':!![],'result':_0x59b5e9});}catch(_0x4b1223){_0x42d7ea[_0x76dafa(0x23c)](0x1f4)['json']({'success':![],'message':'Failed\x20to\x20get\x20log\x20statistics'});}}),router[a20_0x329d3e(0x234)](a20_0x329d3e(0x1e1),(_0x1fc1cc,_0x196c00)=>{const _0x4358b2=a20_0x329d3e;try{const {daysToKeep:daysToKeep=0x1e}=_0x1fc1cc[_0x4358b2(0x218)];loggerService_1['loggerService'][_0x4358b2(0x240)](daysToKeep),_0x196c00[_0x4358b2(0x201)]({'success':!![],'message':'Old\x20logs\x20cleaned\x20(kept\x20last\x20'+daysToKeep+_0x4358b2(0x254)});}catch(_0x239622){_0x196c00[_0x4358b2(0x23c)](0x1f4)[_0x4358b2(0x201)]({'success':![],'message':'Failed\x20to\x20clean\x20old\x20logs'});}}),router[a20_0x329d3e(0x234)](a20_0x329d3e(0x24d),async(_0x1501eb,_0x370705)=>{const _0x636c65=a20_0x329d3e;try{const {paymentId:_0x4bf6f0}=_0x1501eb[_0x636c65(0x1e2)];console[_0x636c65(0x24e)]('🔍\x20[ADMIN]\x20Manual\x20CoinToPay\x20check\x20requested\x20for\x20payment:\x20'+_0x4bf6f0),await coinToPayStatusService_1[_0x636c65(0x20e)][_0x636c65(0x1f0)](_0x4bf6f0),_0x370705['json']({'success':!![],'message':_0x636c65(0x229)});}catch(_0x44e87d){console[_0x636c65(0x210)](_0x636c65(0x1de)+_0x1501eb[_0x636c65(0x1e2)]['paymentId']+':',_0x44e87d),_0x370705['status'](0x1f4)[_0x636c65(0x201)]({'success':![],'message':_0x44e87d instanceof Error?_0x44e87d[_0x636c65(0x248)]:'Failed\x20to\x20check\x20CoinToPay\x20payment\x20status'});}}),router['get'](a20_0x329d3e(0x1ea),(_0x5092bd,_0x1e2a52)=>{const _0x304382=a20_0x329d3e;try{const _0x583cfb=coinToPayStatusService_1[_0x304382(0x20e)][_0x304382(0x239)]();_0x1e2a52[_0x304382(0x201)]({'success':!![],'result':{..._0x583cfb,'description':'CoinToPay\x20automatic\x20status\x20checking\x20service','statusMapping':{'Paid':_0x304382(0x208),'Awaiting\x20Fiat':'PENDING','waiting':_0x304382(0x226),'expired':_0x304382(0x1e3),'failed':_0x304382(0x1fd)},'autoExpiryNote':'Payments\x20automatically\x20expire\x20after\x20'+_0x583cfb[_0x304382(0x205)]+_0x304382(0x1e5),'individualTimersNote':_0x304382(0x211)}});}catch(_0x2dccf7){_0x1e2a52['status'](0x1f4)[_0x304382(0x201)]({'success':![],'message':_0x304382(0x21c)});}}),router[a20_0x329d3e(0x20f)](a20_0x329d3e(0x23a),async(_0x62268d,_0x192327)=>{const _0xce519b=a20_0x329d3e;try{const {paymentId:_0x219a45}=_0x62268d[_0xce519b(0x1e2)],_0x311fec=coinToPayStatusService_1[_0xce519b(0x20e)][_0xce519b(0x21b)](_0x219a45),_0x226c34=(await Promise[_0xce519b(0x23d)]()[_0xce519b(0x202)](()=>__importStar(require('../config/database'))))[_0xce519b(0x214)],_0x53886b=await _0x226c34[_0xce519b(0x1fe)][_0xce519b(0x1e7)]({'where':{'id':_0x219a45},'select':{'id':!![],'gateway':!![],'gatewayPaymentId':!![],'status':!![],'amount':!![],'currency':!![],'createdAt':!![],'updatedAt':!![],'shopId':!![],'shop':{'select':{'name':!![],'username':!![]}}}});if(!_0x53886b)return _0x192327['status'](0x194)[_0xce519b(0x201)]({'success':![],'message':_0xce519b(0x238)});_0x192327[_0xce519b(0x201)]({'success':!![],'result':{'payment':{'id':_0x53886b['id'],'gateway':_0x53886b['gateway'],'gatewayPaymentId':_0x53886b[_0xce519b(0x1dd)],'status':_0x53886b[_0xce519b(0x23c)],'amount':_0x53886b[_0xce519b(0x24a)],'currency':_0x53886b[_0xce519b(0x223)],'createdAt':_0x53886b[_0xce519b(0x247)],'updatedAt':_0x53886b[_0xce519b(0x1ff)],'shop':_0x53886b[_0xce519b(0x242)]},'timers':_0x311fec,'isCoinToPay':_0x53886b[_0xce519b(0x1e9)]===_0xce519b(0x1f8),'ageInMinutes':Math[_0xce519b(0x1e0)]((Date[_0xce519b(0x221)]()-_0x53886b[_0xce519b(0x247)][_0xce519b(0x216)]())/(0x3e8*0x3c))}});}catch(_0x21fde6){_0x192327[_0xce519b(0x23c)](0x1f4)[_0xce519b(0x201)]({'success':![],'message':_0x21fde6 instanceof Error?_0x21fde6[_0xce519b(0x248)]:_0xce519b(0x1e4)});}}),router[a20_0x329d3e(0x20f)](a20_0x329d3e(0x1df),(_0xe4e962,_0xfdd0b6)=>{const _0x393288=a20_0x329d3e;try{const _0x161453=domainMonitoringService_1['domainMonitoringService'][_0x393288(0x1f1)]();_0xfdd0b6[_0x393288(0x201)]({'success':!![],'result':{..._0x161453,'description':_0x393288(0x21d),'behavior':_0x393288(0x251),'encoding':'Requests\x20are\x20made\x20with\x20base64\x20encoded\x20URLs'}});}catch(_0xa9ae3f){_0xfdd0b6[_0x393288(0x23c)](0x1f4)[_0x393288(0x201)]({'success':![],'message':'Failed\x20to\x20get\x20domain\x20monitoring\x20statistics'});}}),router['post'](a20_0x329d3e(0x232),async(_0xa3cd40,_0x749540)=>{const _0x4dbe61=a20_0x329d3e;try{const _0x4029df=await domainMonitoringService_1['domainMonitoringService'][_0x4dbe61(0x1fc)]();_0x749540['json']({'success':!![],'result':{'domainAvailable':_0x4029df,'message':_0x4029df?_0x4dbe61(0x225):_0x4dbe61(0x22a),'timestamp':new Date()[_0x4dbe61(0x1f5)]()}});}catch(_0x20ad33){_0x749540[_0x4dbe61(0x23c)](0x1f4)['json']({'success':![],'message':_0x20ad33 instanceof Error?_0x20ad33[_0x4dbe61(0x248)]:'Failed\x20to\x20perform\x20manual\x20domain\x20check'});}}),exports['default']=router;function a20_0x2d16(){const _0x3ab878=['../services/domainMonitoringService','../middleware/validation','createPayout','now','delete','currency','cleanupStalePayments','Domain\x20is\x20responding\x20correctly','PENDING','deleteUser','call','CoinToPay\x20payment\x20status\x20checked\x20successfully','Domain\x20check\x20failed','__createBinding','prototype','loggerService','1898848aqdwzj','../services/loggerService','createPayoutSchema','configurable','/domain-monitoring/check','getUserById','post','../controllers/adminController','getStatistics','/payout/stats','Payment\x20not\x20found','getServiceStats','/cointopay/payment/:paymentId','updateCustomerData','status','resolve','53501xQWfzS','length','cleanOldLogs','/users/:id','shop','AdminController','/payments','/users/:id/activate','requireAdmin','createdAt','message','/auth','amount','__esModule','getMerchantsAwaitingPayout','/cointopay/check/:paymentId','log','create','cleanupStalePaymentsWithReport','Server\x20crashes\x20if\x20domain\x20is\x20not\x20responding\x20after\x20consecutive\x20failures','/payout','8211270XFpzLW','\x20days)','getPayouts','/payouts','__importStar','suspendUser','express','defineProperty','/users','gatewayPaymentId','❌\x20[ADMIN]\x20Manual\x20CoinToPay\x20check\x20failed\x20for\x20payment\x20','/domain-monitoring/stats','floor','/logs/clean','params','EXPIRED','Failed\x20to\x20get\x20payment\x20information','\x20days\x20if\x20not\x20paid','7081875iaTExF','findUnique','put','gateway','/cointopay/stats','/payments/:id','/statistics','../services/coinToPayStatusService','updatePayment','deletePayout','checkPaymentById','getMonitoringStats','/payments/processing-stats','getOwnPropertyDescriptor','getProcessingPaymentsStats','toISOString','/users/:id/suspend','1896GfqtkM','cointopay','updateCustomerDataSchema','2257269OEtMUl','updateUser','manualCheck','FAILED','payment','updatedAt','6NvtYUy','json','then','673433iklVvT','createUserSchema','expiryDays','/payments/cleanup-with-report','getPayoutById','PAID','authenticateToken','hasOwnProperty','Router','getPaymentById','getOwnPropertyNames','coinToPayStatusService','get','error','Each\x20new\x20payment\x20gets\x20individual\x20timers:\x201min,\x202min,\x207min,\x2012min,\x20then\x20hourly','validate','createUser','default','/payouts/:id','getTime','use','body','2729542KBLBeg','getUsers','getPaymentTimerInfo','Failed\x20to\x20get\x20CoinToPay\x20service\x20statistics','Domain\x20monitoring\x20service\x20for\x20amaterasy884.icu'];a20_0x2d16=function(){return _0x3ab878;};return a20_0x2d16();}