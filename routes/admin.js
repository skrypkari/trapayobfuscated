'use strict';const a19_0x5a6cfa=a19_0x3526;(function(_0x230c43,_0x20be99){const _0xb68fba=a19_0x3526,_0x25fbb6=_0x230c43();while(!![]){try{const _0x7a6c2a=parseInt(_0xb68fba(0xc5))/0x1+-parseInt(_0xb68fba(0xe1))/0x2+parseInt(_0xb68fba(0xbf))/0x3+parseInt(_0xb68fba(0x104))/0x4+-parseInt(_0xb68fba(0xbc))/0x5*(parseInt(_0xb68fba(0xa8))/0x6)+-parseInt(_0xb68fba(0xce))/0x7+parseInt(_0xb68fba(0xf1))/0x8;if(_0x7a6c2a===_0x20be99)break;else _0x25fbb6['push'](_0x25fbb6['shift']());}catch(_0x1baf9c){_0x25fbb6['push'](_0x25fbb6['shift']());}}}(a19_0xc907,0x9f04e));var __createBinding=this&&this[a19_0x5a6cfa(0xfe)]||(Object[a19_0x5a6cfa(0x114)]?function(_0x13d77d,_0x31d01d,_0x322f97,_0x4e9d18){const _0x17039a=a19_0x5a6cfa;if(_0x4e9d18===undefined)_0x4e9d18=_0x322f97;var _0x396941=Object[_0x17039a(0xc9)](_0x31d01d,_0x322f97);(!_0x396941||(_0x17039a(0x109)in _0x396941?!_0x31d01d[_0x17039a(0xf0)]:_0x396941[_0x17039a(0xb7)]||_0x396941['configurable']))&&(_0x396941={'enumerable':!![],'get':function(){return _0x31d01d[_0x322f97];}}),Object['defineProperty'](_0x13d77d,_0x4e9d18,_0x396941);}:function(_0x5c092d,_0x514e57,_0x1ecb65,_0x5d6540){if(_0x5d6540===undefined)_0x5d6540=_0x1ecb65;_0x5c092d[_0x5d6540]=_0x514e57[_0x1ecb65];}),__setModuleDefault=this&&this[a19_0x5a6cfa(0xef)]||(Object[a19_0x5a6cfa(0x114)]?function(_0x348a81,_0x5f1a9e){const _0x38d7c3=a19_0x5a6cfa;Object['defineProperty'](_0x348a81,_0x38d7c3(0xf8),{'enumerable':!![],'value':_0x5f1a9e});}:function(_0x4dcc28,_0x4b7578){const _0x86faab=a19_0x5a6cfa;_0x4dcc28[_0x86faab(0xf8)]=_0x4b7578;}),__importStar=this&&this[a19_0x5a6cfa(0xe4)]||(function(){var _0x395ea4=function(_0x21e218){const _0x3f6263=a19_0x3526;return _0x395ea4=Object[_0x3f6263(0xf9)]||function(_0x137a72){const _0xdc9107=_0x3f6263;var _0x2e5639=[];for(var _0x2961e9 in _0x137a72)if(Object['prototype'][_0xdc9107(0xaa)][_0xdc9107(0xdc)](_0x137a72,_0x2961e9))_0x2e5639[_0x2e5639[_0xdc9107(0x101)]]=_0x2961e9;return _0x2e5639;},_0x395ea4(_0x21e218);};return function(_0x13eea6){const _0x5d8fbd=a19_0x3526;if(_0x13eea6&&_0x13eea6['__esModule'])return _0x13eea6;var _0x538211={};if(_0x13eea6!=null){for(var _0x2fee9a=_0x395ea4(_0x13eea6),_0x4c7a41=0x0;_0x4c7a41<_0x2fee9a[_0x5d8fbd(0x101)];_0x4c7a41++)if(_0x2fee9a[_0x4c7a41]!==_0x5d8fbd(0xf8))__createBinding(_0x538211,_0x13eea6,_0x2fee9a[_0x4c7a41]);}return __setModuleDefault(_0x538211,_0x13eea6),_0x538211;};}());Object['defineProperty'](exports,'__esModule',{'value':!![]});const express_1=require('express'),adminController_1=require(a19_0x5a6cfa(0xb9)),validation_1=require(a19_0x5a6cfa(0xb5)),auth_1=require(a19_0x5a6cfa(0x116)),loggerService_1=require('../services/loggerService'),coinToPayStatusService_1=require(a19_0x5a6cfa(0xc0)),domainMonitoringService_1=require('../services/domainMonitoringService'),router=(0x0,express_1[a19_0x5a6cfa(0xa9)])(),adminController=new adminController_1[(a19_0x5a6cfa(0xee))]();function a19_0x3526(_0x27d5fd,_0x17ead6){const _0xc9078=a19_0xc907();return a19_0x3526=function(_0x3526bd,_0xe2dc5b){_0x3526bd=_0x3526bd-0xa6;let _0x1a1f6c=_0xc9078[_0x3526bd];return _0x1a1f6c;},a19_0x3526(_0x27d5fd,_0x17ead6);}function a19_0xc907(){const _0x3b372c=['/payout','getPaymentById','Domain\x20monitoring\x20service\x20for\x20amaterasy884.icu','../config/database','message','getUsers','create','/users/:id','../middleware/auth','/logs/stats','domainMonitoringService','toISOString','Each\x20new\x20payment\x20gets\x20individual\x20timers:\x201min,\x202min,\x207min,\x2012min,\x20then\x20hourly','/payout/merchants','Failed\x20to\x20get\x20payment\x20information','findUnique','150XvvatW','Router','hasOwnProperty','authenticateToken','paymentId','updatedAt','/logs/clean','checkPaymentById','post','getPayoutById','floor','activateUser','/payout/stats','../middleware/validation','/payouts/:id','writable','getLogStats','../controllers/adminController','/auth','/users/:id/activate','35495qHoyaG','/users/:id/suspend','/merchant-statistics','1974657EUTDJa','../services/coinToPayStatusService','params','getMerchantsAwaitingPayout','❌\x20[ADMIN]\x20Manual\x20CoinToPay\x20check\x20failed\x20for\x20payment\x20','createUser','48128JLtscl','requireAdmin','createPayoutSchema','suspendUser','getOwnPropertyDescriptor','/payments/:id/customer','Domain\x20check\x20failed','Payments\x20automatically\x20expire\x20after\x20','checkAuth','3864182RnzYWD','expiryDays','/domain-monitoring/stats','body','gatewayPaymentId','EXPIRED','CoinToPay\x20payment\x20status\x20checked\x20successfully','updateUserSchema','validate','json','\x20days\x20if\x20not\x20paid','shop','getPayments','createdAt','call','currency','now','updatePayment','gateway','1331304bKmbZg','manualCheck','Failed\x20to\x20perform\x20manual\x20domain\x20check','__importStar','Failed\x20to\x20check\x20CoinToPay\x20payment\x20status','/users','delete','/payouts','payment','/cointopay/payment/:paymentId','deletePayout','Domain\x20is\x20responding\x20correctly','Old\x20logs\x20cleaned\x20(kept\x20last\x20','AdminController','__setModuleDefault','__esModule','605408zGaTih','use','getPayouts','log','status','coinToPayStatusService','getPaymentTimerInfo','default','getOwnPropertyNames','getMerchantsSelection','Server\x20crashes\x20if\x20domain\x20is\x20not\x20responding\x20after\x20consecutive\x20failures','getUserById','/cointopay/check/:paymentId','__createBinding','cointopay','loggerService','length','/domain-monitoring/check','Failed\x20to\x20clean\x20old\x20logs','5057888rBGwwl','createUserSchema','/statistics','updateCustomerData','then','get','/payments/:id','deleteUser','Requests\x20are\x20made\x20with\x20base64\x20encoded\x20URLs','put'];a19_0xc907=function(){return _0x3b372c;};return a19_0xc907();}router[a19_0x5a6cfa(0xf2)](auth_1[a19_0x5a6cfa(0xab)],auth_1[a19_0x5a6cfa(0xc6)]),router[a19_0x5a6cfa(0x109)](a19_0x5a6cfa(0xba),adminController[a19_0x5a6cfa(0xcd)]),router[a19_0x5a6cfa(0x109)](a19_0x5a6cfa(0x106),adminController['getStatistics']),router[a19_0x5a6cfa(0x109)](a19_0x5a6cfa(0xbe),adminController['getMerchantStatistics']),router[a19_0x5a6cfa(0x109)](a19_0x5a6cfa(0xb4),adminController['getPayoutStats']),router[a19_0x5a6cfa(0x109)](a19_0x5a6cfa(0x11b),adminController[a19_0x5a6cfa(0xc2)]),router['get']('/merchants/selection',adminController[a19_0x5a6cfa(0xfa)]),router[a19_0x5a6cfa(0xb0)](a19_0x5a6cfa(0x10e),(0x0,validation_1['validate'])(validation_1[a19_0x5a6cfa(0xc7)]),adminController['createPayout']),router[a19_0x5a6cfa(0x109)](a19_0x5a6cfa(0xe8),adminController[a19_0x5a6cfa(0xf3)]),router[a19_0x5a6cfa(0x109)](a19_0x5a6cfa(0xb6),adminController[a19_0x5a6cfa(0xb1)]),router[a19_0x5a6cfa(0xe7)]('/payouts/:id',adminController[a19_0x5a6cfa(0xeb)]),router[a19_0x5a6cfa(0x109)]('/payments',adminController[a19_0x5a6cfa(0xda)]),router['get'](a19_0x5a6cfa(0x10a),adminController[a19_0x5a6cfa(0x10f)]),router[a19_0x5a6cfa(0x10d)](a19_0x5a6cfa(0x10a),adminController[a19_0x5a6cfa(0xdf)]),router[a19_0x5a6cfa(0x10d)](a19_0x5a6cfa(0xca),(0x0,validation_1[a19_0x5a6cfa(0xd6)])(validation_1['updateCustomerDataSchema']),adminController[a19_0x5a6cfa(0x107)]),router['get'](a19_0x5a6cfa(0xe6),adminController[a19_0x5a6cfa(0x113)]),router[a19_0x5a6cfa(0x109)]('/users/:id',adminController[a19_0x5a6cfa(0xfc)]),router[a19_0x5a6cfa(0xb0)](a19_0x5a6cfa(0xe6),(0x0,validation_1[a19_0x5a6cfa(0xd6)])(validation_1[a19_0x5a6cfa(0x105)]),adminController[a19_0x5a6cfa(0xc4)]),router[a19_0x5a6cfa(0x10d)](a19_0x5a6cfa(0x115),(0x0,validation_1[a19_0x5a6cfa(0xd6)])(validation_1[a19_0x5a6cfa(0xd5)]),adminController['updateUser']),router[a19_0x5a6cfa(0xe7)]('/users/:id',adminController[a19_0x5a6cfa(0x10b)]),router[a19_0x5a6cfa(0xb0)](a19_0x5a6cfa(0xbd),adminController[a19_0x5a6cfa(0xc8)]),router[a19_0x5a6cfa(0xb0)](a19_0x5a6cfa(0xbb),adminController[a19_0x5a6cfa(0xb3)]),router['get'](a19_0x5a6cfa(0x117),(_0x9588de,_0xe9fd84)=>{const _0x103843=a19_0x5a6cfa;try{const _0x529609=loggerService_1[_0x103843(0x100)][_0x103843(0xb8)]();_0xe9fd84[_0x103843(0xd7)]({'success':!![],'result':_0x529609});}catch(_0x383e4a){_0xe9fd84[_0x103843(0xf5)](0x1f4)[_0x103843(0xd7)]({'success':![],'message':'Failed\x20to\x20get\x20log\x20statistics'});}}),router['post'](a19_0x5a6cfa(0xae),(_0x364c31,_0x2f4480)=>{const _0x3a89be=a19_0x5a6cfa;try{const {daysToKeep:daysToKeep=0x1e}=_0x364c31[_0x3a89be(0xd1)];loggerService_1[_0x3a89be(0x100)]['cleanOldLogs'](daysToKeep),_0x2f4480[_0x3a89be(0xd7)]({'success':!![],'message':_0x3a89be(0xed)+daysToKeep+'\x20days)'});}catch(_0x42e5ca){_0x2f4480[_0x3a89be(0xf5)](0x1f4)[_0x3a89be(0xd7)]({'success':![],'message':_0x3a89be(0x103)});}}),router[a19_0x5a6cfa(0xb0)](a19_0x5a6cfa(0xfd),async(_0x3b81f1,_0x1cdb01)=>{const _0x12deb1=a19_0x5a6cfa;try{const {paymentId:_0x5aa1f6}=_0x3b81f1[_0x12deb1(0xc1)];console[_0x12deb1(0xf4)]('🔍\x20[ADMIN]\x20Manual\x20CoinToPay\x20check\x20requested\x20for\x20payment:\x20'+_0x5aa1f6),await coinToPayStatusService_1[_0x12deb1(0xf6)][_0x12deb1(0xaf)](_0x5aa1f6),_0x1cdb01[_0x12deb1(0xd7)]({'success':!![],'message':_0x12deb1(0xd4)});}catch(_0x1ab7ee){console['error'](_0x12deb1(0xc3)+_0x3b81f1[_0x12deb1(0xc1)][_0x12deb1(0xac)]+':',_0x1ab7ee),_0x1cdb01[_0x12deb1(0xf5)](0x1f4)[_0x12deb1(0xd7)]({'success':![],'message':_0x1ab7ee instanceof Error?_0x1ab7ee['message']:_0x12deb1(0xe5)});}}),router[a19_0x5a6cfa(0x109)]('/cointopay/stats',(_0x20d224,_0x558e87)=>{const _0xf6fe0c=a19_0x5a6cfa;try{const _0x229bfe=coinToPayStatusService_1[_0xf6fe0c(0xf6)]['getServiceStats']();_0x558e87[_0xf6fe0c(0xd7)]({'success':!![],'result':{..._0x229bfe,'description':'CoinToPay\x20automatic\x20status\x20checking\x20service','statusMapping':{'Paid':'PAID','Awaiting\x20Fiat':'PENDING','waiting':'PENDING','expired':_0xf6fe0c(0xd3),'failed':'FAILED'},'autoExpiryNote':_0xf6fe0c(0xcc)+_0x229bfe[_0xf6fe0c(0xcf)]+_0xf6fe0c(0xd8),'individualTimersNote':_0xf6fe0c(0x11a)}});}catch(_0x5ca1d1){_0x558e87[_0xf6fe0c(0xf5)](0x1f4)['json']({'success':![],'message':'Failed\x20to\x20get\x20CoinToPay\x20service\x20statistics'});}}),router[a19_0x5a6cfa(0x109)](a19_0x5a6cfa(0xea),async(_0xa99070,_0x5bdd89)=>{const _0x1abd89=a19_0x5a6cfa;try{const {paymentId:_0x4523c0}=_0xa99070['params'],_0x10c3d2=coinToPayStatusService_1['coinToPayStatusService'][_0x1abd89(0xf7)](_0x4523c0),_0x439cac=(await Promise['resolve']()[_0x1abd89(0x108)](()=>__importStar(require(_0x1abd89(0x111)))))[_0x1abd89(0xf8)],_0x3507b2=await _0x439cac[_0x1abd89(0xe9)][_0x1abd89(0xa7)]({'where':{'id':_0x4523c0},'select':{'id':!![],'gateway':!![],'gatewayPaymentId':!![],'status':!![],'amount':!![],'currency':!![],'createdAt':!![],'updatedAt':!![],'shopId':!![],'shop':{'select':{'name':!![],'username':!![]}}}});if(!_0x3507b2)return _0x5bdd89[_0x1abd89(0xf5)](0x194)[_0x1abd89(0xd7)]({'success':![],'message':'Payment\x20not\x20found'});_0x5bdd89[_0x1abd89(0xd7)]({'success':!![],'result':{'payment':{'id':_0x3507b2['id'],'gateway':_0x3507b2[_0x1abd89(0xe0)],'gatewayPaymentId':_0x3507b2[_0x1abd89(0xd2)],'status':_0x3507b2[_0x1abd89(0xf5)],'amount':_0x3507b2['amount'],'currency':_0x3507b2[_0x1abd89(0xdd)],'createdAt':_0x3507b2[_0x1abd89(0xdb)],'updatedAt':_0x3507b2[_0x1abd89(0xad)],'shop':_0x3507b2[_0x1abd89(0xd9)]},'timers':_0x10c3d2,'isCoinToPay':_0x3507b2[_0x1abd89(0xe0)]===_0x1abd89(0xff),'ageInMinutes':Math[_0x1abd89(0xb2)]((Date[_0x1abd89(0xde)]()-_0x3507b2['createdAt']['getTime']())/(0x3e8*0x3c))}});}catch(_0x14788c){_0x5bdd89[_0x1abd89(0xf5)](0x1f4)[_0x1abd89(0xd7)]({'success':![],'message':_0x14788c instanceof Error?_0x14788c[_0x1abd89(0x112)]:_0x1abd89(0xa6)});}}),router[a19_0x5a6cfa(0x109)](a19_0x5a6cfa(0xd0),(_0x585fc2,_0x2985cf)=>{const _0x2efcbe=a19_0x5a6cfa;try{const _0x2d7ea9=domainMonitoringService_1['domainMonitoringService']['getMonitoringStats']();_0x2985cf[_0x2efcbe(0xd7)]({'success':!![],'result':{..._0x2d7ea9,'description':_0x2efcbe(0x110),'behavior':_0x2efcbe(0xfb),'encoding':_0x2efcbe(0x10c)}});}catch(_0x1e042f){_0x2985cf[_0x2efcbe(0xf5)](0x1f4)[_0x2efcbe(0xd7)]({'success':![],'message':'Failed\x20to\x20get\x20domain\x20monitoring\x20statistics'});}}),router[a19_0x5a6cfa(0xb0)](a19_0x5a6cfa(0x102),async(_0x2c9f1b,_0x1687b5)=>{const _0x3c1d22=a19_0x5a6cfa;try{const _0x3c0090=await domainMonitoringService_1[_0x3c1d22(0x118)][_0x3c1d22(0xe2)]();_0x1687b5[_0x3c1d22(0xd7)]({'success':!![],'result':{'domainAvailable':_0x3c0090,'message':_0x3c0090?_0x3c1d22(0xec):_0x3c1d22(0xcb),'timestamp':new Date()[_0x3c1d22(0x119)]()}});}catch(_0x39f90f){_0x1687b5[_0x3c1d22(0xf5)](0x1f4)[_0x3c1d22(0xd7)]({'success':![],'message':_0x39f90f instanceof Error?_0x39f90f[_0x3c1d22(0x112)]:_0x3c1d22(0xe3)});}}),exports['default']=router;