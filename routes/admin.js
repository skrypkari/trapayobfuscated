'use strict';function a20_0x518c(_0x417563,_0x2864ee){const _0x331afe=a20_0x331a();return a20_0x518c=function(_0x518c4e,_0x4a6fd8){_0x518c4e=_0x518c4e-0x1c9;let _0x5c529f=_0x331afe[_0x518c4e];return _0x5c529f;},a20_0x518c(_0x417563,_0x2864ee);}const a20_0x56c8b2=a20_0x518c;(function(_0x545ba8,_0x2a517a){const _0x4597b2=a20_0x518c,_0x5804cc=_0x545ba8();while(!![]){try{const _0x59673a=-parseInt(_0x4597b2(0x23b))/0x1*(parseInt(_0x4597b2(0x1ef))/0x2)+-parseInt(_0x4597b2(0x201))/0x3*(parseInt(_0x4597b2(0x23c))/0x4)+parseInt(_0x4597b2(0x1e6))/0x5+parseInt(_0x4597b2(0x229))/0x6*(parseInt(_0x4597b2(0x209))/0x7)+parseInt(_0x4597b2(0x205))/0x8+parseInt(_0x4597b2(0x22d))/0x9+-parseInt(_0x4597b2(0x239))/0xa;if(_0x59673a===_0x2a517a)break;else _0x5804cc['push'](_0x5804cc['shift']());}catch(_0x1569f9){_0x5804cc['push'](_0x5804cc['shift']());}}}(a20_0x331a,0x82605));var __createBinding=this&&this[a20_0x56c8b2(0x1ec)]||(Object['create']?function(_0x238c6b,_0x35026c,_0x46cdb3,_0x155c70){const _0x388ba9=a20_0x56c8b2;if(_0x155c70===undefined)_0x155c70=_0x46cdb3;var _0x296594=Object[_0x388ba9(0x1d8)](_0x35026c,_0x46cdb3);(!_0x296594||(_0x388ba9(0x200)in _0x296594?!_0x35026c[_0x388ba9(0x234)]:_0x296594[_0x388ba9(0x21b)]||_0x296594[_0x388ba9(0x1e3)]))&&(_0x296594={'enumerable':!![],'get':function(){return _0x35026c[_0x46cdb3];}}),Object[_0x388ba9(0x20b)](_0x238c6b,_0x155c70,_0x296594);}:function(_0x1cba67,_0xe559a1,_0x4fd490,_0x48d73b){if(_0x48d73b===undefined)_0x48d73b=_0x4fd490;_0x1cba67[_0x48d73b]=_0xe559a1[_0x4fd490];}),__setModuleDefault=this&&this[a20_0x56c8b2(0x222)]||(Object[a20_0x56c8b2(0x1fe)]?function(_0x53c776,_0x46f4a1){const _0x19d61d=a20_0x56c8b2;Object['defineProperty'](_0x53c776,_0x19d61d(0x204),{'enumerable':!![],'value':_0x46f4a1});}:function(_0x1394f0,_0x454843){const _0x3c892d=a20_0x56c8b2;_0x1394f0[_0x3c892d(0x204)]=_0x454843;}),__importStar=this&&this[a20_0x56c8b2(0x22e)]||(function(){var _0x1be42a=function(_0x1d629e){return _0x1be42a=Object['getOwnPropertyNames']||function(_0x4a6b5d){const _0x45bdee=a20_0x518c;var _0x1a8844=[];for(var _0x9e489 in _0x4a6b5d)if(Object[_0x45bdee(0x1fc)][_0x45bdee(0x1f5)][_0x45bdee(0x21a)](_0x4a6b5d,_0x9e489))_0x1a8844[_0x1a8844[_0x45bdee(0x1df)]]=_0x9e489;return _0x1a8844;},_0x1be42a(_0x1d629e);};return function(_0x44dbb9){const _0xa388f8=a20_0x518c;if(_0x44dbb9&&_0x44dbb9[_0xa388f8(0x234)])return _0x44dbb9;var _0x502861={};if(_0x44dbb9!=null){for(var _0x43b7ed=_0x1be42a(_0x44dbb9),_0x4430be=0x0;_0x4430be<_0x43b7ed[_0xa388f8(0x1df)];_0x4430be++)if(_0x43b7ed[_0x4430be]!=='default')__createBinding(_0x502861,_0x44dbb9,_0x43b7ed[_0x4430be]);}return __setModuleDefault(_0x502861,_0x44dbb9),_0x502861;};}());Object[a20_0x56c8b2(0x20b)](exports,a20_0x56c8b2(0x234),{'value':!![]});function a20_0x331a(){const _0x2c2fc0=['Old\x20logs\x20cleaned\x20(kept\x20last\x20','domainMonitoringService','1479096TIkgNe','/users/:id','updateUser','Domain\x20check\x20failed','3109464iHzToJ','__importStar','shop','paymentId','Failed\x20to\x20perform\x20manual\x20domain\x20check','../services/loggerService','post','__esModule','getLogStats','coinToPayStatusService','/domain-monitoring/stats','Payment\x20not\x20found','8452860lFyPjE','FAILED','129GocKXP','508QTvQwe','Failed\x20to\x20get\x20CoinToPay\x20service\x20statistics','/payments/:id','error','Domain\x20monitoring\x20service\x20for\x20amaterasy884.icu','Payments\x20automatically\x20expire\x20after\x20','/merchant-statistics','loggerService','use','floor','getUsers','Failed\x20to\x20clean\x20old\x20logs','/payout/merchants','Failed\x20to\x20check\x20CoinToPay\x20payment\x20status','getMerchantsAwaitingPayout','CoinToPay\x20automatic\x20status\x20checking\x20service','\x20days\x20if\x20not\x20paid','put','cleanOldLogs','body','/cointopay/stats','createPayoutSchema','/logs/clean','getOwnPropertyDescriptor','Failed\x20to\x20get\x20domain\x20monitoring\x20statistics','getPayouts','message','getMerchantsSelection','cointopay','\x20days)','length','delete','payment','../middleware/validation','configurable','requireAdmin','EXPIRED','3474485jwrBKI','status','gateway','❌\x20[ADMIN]\x20Manual\x20CoinToPay\x20check\x20failed\x20for\x20payment\x20','getPayoutById','/cointopay/payment/:paymentId','__createBinding','PENDING','toISOString','4734VbmYkt','checkPaymentById','deleteUser','/statistics','getPayoutStats','params','hasOwnProperty','getStatistics','/payouts/:id','manualCheck','findUnique','json','suspendUser','prototype','🔍\x20[ADMIN]\x20Manual\x20CoinToPay\x20check\x20requested\x20for\x20payment:\x20','create','../config/database','get','6138LRnadV','getUserById','/payments/:id/customer','default','1316408xyZQWT','getPaymentById','/payouts','createUser','21kZnCpz','Domain\x20is\x20responding\x20correctly','defineProperty','resolve','../controllers/adminController','Router','getMerchantStatistics','getPaymentTimerInfo','createPayout','/merchants/selection','Server\x20crashes\x20if\x20domain\x20is\x20not\x20responding\x20after\x20consecutive\x20failures','/payout/stats','validate','../services/coinToPayStatusService','/payout','updatePayment','CoinToPay\x20payment\x20status\x20checked\x20successfully','call','writable','/users/:id/suspend','Requests\x20are\x20made\x20with\x20base64\x20encoded\x20URLs','Failed\x20to\x20get\x20log\x20statistics','log','createdAt','activateUser','__setModuleDefault','/users','then','checkAuth','/cointopay/check/:paymentId'];a20_0x331a=function(){return _0x2c2fc0;};return a20_0x331a();}const express_1=require('express'),adminController_1=require(a20_0x56c8b2(0x20d)),validation_1=require(a20_0x56c8b2(0x1e2)),auth_1=require('../middleware/auth'),loggerService_1=require(a20_0x56c8b2(0x232)),coinToPayStatusService_1=require(a20_0x56c8b2(0x216)),domainMonitoringService_1=require('../services/domainMonitoringService'),router=(0x0,express_1[a20_0x56c8b2(0x20e)])(),adminController=new adminController_1['AdminController']();router[a20_0x56c8b2(0x1c9)](auth_1['authenticateToken'],auth_1[a20_0x56c8b2(0x1e4)]),router['get']('/auth',adminController[a20_0x56c8b2(0x225)]),router[a20_0x56c8b2(0x200)](a20_0x56c8b2(0x1f2),adminController[a20_0x56c8b2(0x1f6)]),router[a20_0x56c8b2(0x200)](a20_0x56c8b2(0x242),adminController[a20_0x56c8b2(0x20f)]),router[a20_0x56c8b2(0x200)](a20_0x56c8b2(0x214),adminController[a20_0x56c8b2(0x1f3)]),router['get'](a20_0x56c8b2(0x1cd),adminController[a20_0x56c8b2(0x1cf)]),router[a20_0x56c8b2(0x200)](a20_0x56c8b2(0x212),adminController[a20_0x56c8b2(0x1dc)]),router[a20_0x56c8b2(0x233)](a20_0x56c8b2(0x217),(0x0,validation_1['validate'])(validation_1[a20_0x56c8b2(0x1d6)]),adminController[a20_0x56c8b2(0x211)]),router[a20_0x56c8b2(0x200)](a20_0x56c8b2(0x207),adminController[a20_0x56c8b2(0x1da)]),router[a20_0x56c8b2(0x200)](a20_0x56c8b2(0x1f7),adminController[a20_0x56c8b2(0x1ea)]),router[a20_0x56c8b2(0x1e0)](a20_0x56c8b2(0x1f7),adminController['deletePayout']),router[a20_0x56c8b2(0x200)]('/payments',adminController['getPayments']),router['get'](a20_0x56c8b2(0x23e),adminController[a20_0x56c8b2(0x206)]),router[a20_0x56c8b2(0x1d2)]('/payments/:id',adminController[a20_0x56c8b2(0x218)]),router[a20_0x56c8b2(0x1d2)](a20_0x56c8b2(0x203),(0x0,validation_1[a20_0x56c8b2(0x215)])(validation_1['updateCustomerDataSchema']),adminController['updateCustomerData']),router['get'](a20_0x56c8b2(0x223),adminController[a20_0x56c8b2(0x1cb)]),router['get'](a20_0x56c8b2(0x22a),adminController[a20_0x56c8b2(0x202)]),router[a20_0x56c8b2(0x233)]('/users',(0x0,validation_1['validate'])(validation_1['createUserSchema']),adminController[a20_0x56c8b2(0x208)]),router[a20_0x56c8b2(0x1d2)](a20_0x56c8b2(0x22a),(0x0,validation_1[a20_0x56c8b2(0x215)])(validation_1['updateUserSchema']),adminController[a20_0x56c8b2(0x22b)]),router['delete'](a20_0x56c8b2(0x22a),adminController[a20_0x56c8b2(0x1f1)]),router[a20_0x56c8b2(0x233)](a20_0x56c8b2(0x21c),adminController[a20_0x56c8b2(0x1fb)]),router[a20_0x56c8b2(0x233)]('/users/:id/activate',adminController[a20_0x56c8b2(0x221)]),router['get']('/logs/stats',(_0x2447ac,_0x5be1f8)=>{const _0x59b9a5=a20_0x56c8b2;try{const _0x85002=loggerService_1[_0x59b9a5(0x243)][_0x59b9a5(0x235)]();_0x5be1f8[_0x59b9a5(0x1fa)]({'success':!![],'result':_0x85002});}catch(_0x594426){_0x5be1f8[_0x59b9a5(0x1e7)](0x1f4)['json']({'success':![],'message':_0x59b9a5(0x21e)});}}),router['post'](a20_0x56c8b2(0x1d7),(_0x4c8769,_0x598a02)=>{const _0x11af4b=a20_0x56c8b2;try{const {daysToKeep:daysToKeep=0x1e}=_0x4c8769[_0x11af4b(0x1d4)];loggerService_1[_0x11af4b(0x243)][_0x11af4b(0x1d3)](daysToKeep),_0x598a02[_0x11af4b(0x1fa)]({'success':!![],'message':_0x11af4b(0x227)+daysToKeep+_0x11af4b(0x1de)});}catch(_0x3e2f51){_0x598a02[_0x11af4b(0x1e7)](0x1f4)[_0x11af4b(0x1fa)]({'success':![],'message':_0x11af4b(0x1cc)});}}),router['post'](a20_0x56c8b2(0x226),async(_0x387c47,_0x292aed)=>{const _0x58f42f=a20_0x56c8b2;try{const {paymentId:_0x60bfec}=_0x387c47[_0x58f42f(0x1f4)];console[_0x58f42f(0x21f)](_0x58f42f(0x1fd)+_0x60bfec),await coinToPayStatusService_1['coinToPayStatusService'][_0x58f42f(0x1f0)](_0x60bfec),_0x292aed[_0x58f42f(0x1fa)]({'success':!![],'message':_0x58f42f(0x219)});}catch(_0x147c7e){console[_0x58f42f(0x23f)](_0x58f42f(0x1e9)+_0x387c47['params'][_0x58f42f(0x230)]+':',_0x147c7e),_0x292aed[_0x58f42f(0x1e7)](0x1f4)[_0x58f42f(0x1fa)]({'success':![],'message':_0x147c7e instanceof Error?_0x147c7e[_0x58f42f(0x1db)]:_0x58f42f(0x1ce)});}}),router[a20_0x56c8b2(0x200)](a20_0x56c8b2(0x1d5),(_0xdd85be,_0x1fe0f4)=>{const _0x448f89=a20_0x56c8b2;try{const _0x99992f=coinToPayStatusService_1[_0x448f89(0x236)]['getServiceStats']();_0x1fe0f4[_0x448f89(0x1fa)]({'success':!![],'result':{..._0x99992f,'description':_0x448f89(0x1d0),'statusMapping':{'Paid':'PAID','Awaiting\x20Fiat':_0x448f89(0x1ed),'waiting':'PENDING','expired':_0x448f89(0x1e5),'failed':_0x448f89(0x23a)},'autoExpiryNote':_0x448f89(0x241)+_0x99992f['expiryDays']+_0x448f89(0x1d1),'individualTimersNote':'Each\x20new\x20payment\x20gets\x20individual\x20timers:\x201min,\x202min,\x207min,\x2012min,\x20then\x20hourly'}});}catch(_0x48bc11){_0x1fe0f4[_0x448f89(0x1e7)](0x1f4)[_0x448f89(0x1fa)]({'success':![],'message':_0x448f89(0x23d)});}}),router[a20_0x56c8b2(0x200)](a20_0x56c8b2(0x1eb),async(_0x228f30,_0x2ee475)=>{const _0x1c553a=a20_0x56c8b2;try{const {paymentId:_0x5f3eb9}=_0x228f30[_0x1c553a(0x1f4)],_0xc60cb8=coinToPayStatusService_1[_0x1c553a(0x236)][_0x1c553a(0x210)](_0x5f3eb9),_0x4ff835=(await Promise[_0x1c553a(0x20c)]()[_0x1c553a(0x224)](()=>__importStar(require(_0x1c553a(0x1ff)))))[_0x1c553a(0x204)],_0x501091=await _0x4ff835[_0x1c553a(0x1e1)][_0x1c553a(0x1f9)]({'where':{'id':_0x5f3eb9},'select':{'id':!![],'gateway':!![],'gatewayPaymentId':!![],'status':!![],'amount':!![],'currency':!![],'createdAt':!![],'updatedAt':!![],'shopId':!![],'shop':{'select':{'name':!![],'username':!![]}}}});if(!_0x501091)return _0x2ee475['status'](0x194)[_0x1c553a(0x1fa)]({'success':![],'message':_0x1c553a(0x238)});_0x2ee475['json']({'success':!![],'result':{'payment':{'id':_0x501091['id'],'gateway':_0x501091['gateway'],'gatewayPaymentId':_0x501091['gatewayPaymentId'],'status':_0x501091[_0x1c553a(0x1e7)],'amount':_0x501091['amount'],'currency':_0x501091['currency'],'createdAt':_0x501091['createdAt'],'updatedAt':_0x501091['updatedAt'],'shop':_0x501091[_0x1c553a(0x22f)]},'timers':_0xc60cb8,'isCoinToPay':_0x501091[_0x1c553a(0x1e8)]===_0x1c553a(0x1dd),'ageInMinutes':Math[_0x1c553a(0x1ca)]((Date['now']()-_0x501091[_0x1c553a(0x220)]['getTime']())/(0x3e8*0x3c))}});}catch(_0x2aaf02){_0x2ee475[_0x1c553a(0x1e7)](0x1f4)[_0x1c553a(0x1fa)]({'success':![],'message':_0x2aaf02 instanceof Error?_0x2aaf02[_0x1c553a(0x1db)]:'Failed\x20to\x20get\x20payment\x20information'});}}),router[a20_0x56c8b2(0x200)](a20_0x56c8b2(0x237),(_0x42cf71,_0x5d2bd1)=>{const _0x2f8c3a=a20_0x56c8b2;try{const _0x3f312a=domainMonitoringService_1[_0x2f8c3a(0x228)]['getMonitoringStats']();_0x5d2bd1[_0x2f8c3a(0x1fa)]({'success':!![],'result':{..._0x3f312a,'description':_0x2f8c3a(0x240),'behavior':_0x2f8c3a(0x213),'encoding':_0x2f8c3a(0x21d)}});}catch(_0x96ca0){_0x5d2bd1[_0x2f8c3a(0x1e7)](0x1f4)['json']({'success':![],'message':_0x2f8c3a(0x1d9)});}}),router[a20_0x56c8b2(0x233)]('/domain-monitoring/check',async(_0x3c0c23,_0x39356f)=>{const _0x2dfdc7=a20_0x56c8b2;try{const _0x4402cf=await domainMonitoringService_1[_0x2dfdc7(0x228)][_0x2dfdc7(0x1f8)]();_0x39356f[_0x2dfdc7(0x1fa)]({'success':!![],'result':{'domainAvailable':_0x4402cf,'message':_0x4402cf?_0x2dfdc7(0x20a):_0x2dfdc7(0x22c),'timestamp':new Date()[_0x2dfdc7(0x1ee)]()}});}catch(_0x563e6c){_0x39356f[_0x2dfdc7(0x1e7)](0x1f4)['json']({'success':![],'message':_0x563e6c instanceof Error?_0x563e6c[_0x2dfdc7(0x1db)]:_0x2dfdc7(0x231)});}}),exports['default']=router;