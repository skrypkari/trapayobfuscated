'use strict';const a19_0x1ff793=a19_0x3090;function a19_0x5c33(){const _0x1bbe1a=['/domain-monitoring/check','Domain\x20monitoring\x20service\x20for\x20amaterasy884.icu','message','/cointopay/check/:paymentId','now','/payout/merchants','/users/:id/activate','8854242nWqQrv','getPayoutStats','coinToPayStatusService','defineProperty','updateUser','gateway','829626Mgybor','/users/:id/suspend','createdAt','getMonitoringStats','2cUSbUe','payment','authenticateToken','__esModule','Requests\x20are\x20made\x20with\x20base64\x20encoded\x20URLs','getStatistics','/statistics','Failed\x20to\x20get\x20log\x20statistics','getMerchantsSelection','delete','29912360yIpqUX','Failed\x20to\x20check\x20CoinToPay\x20payment\x20status','Failed\x20to\x20perform\x20manual\x20domain\x20check','/payouts','post','Failed\x20to\x20clean\x20old\x20logs','634176GmZoyn','default','createPayoutSchema','createUserSchema','then','getPaymentTimerInfo','activateUser','get','getPayoutById','createUser','cointopay','../services/domainMonitoringService','createPayout','suspendUser','configurable','checkPaymentById','create','call','shop','2427801STabIa','PAID','expiryDays','Router','deleteUser','PENDING','getTime','\x20days)','Domain\x20is\x20responding\x20correctly','getMerchantStatistics','findUnique','Domain\x20check\x20failed','put','/domain-monitoring/stats','manualCheck','../controllers/adminController','__createBinding','/payout','/payments/:id','../services/loggerService','getPayouts','floor','params','1491407YXaaft','length','/users','getPaymentById','loggerService','Each\x20new\x20payment\x20gets\x20individual\x20timers:\x201min,\x202min,\x207min,\x2012min,\x20then\x20hourly','/payments/:id/customer','log','/payout/stats','Payment\x20not\x20found','../config/database','getUserById','Failed\x20to\x20get\x20payment\x20information','json','/cointopay/stats','status','updatePayment','48AocbWA','/cointopay/payment/:paymentId','/payouts/:id','__setModuleDefault','20fXogAq','use','prototype','getUsers','gatewayPaymentId','CoinToPay\x20automatic\x20status\x20checking\x20service','/merchants/selection','../middleware/auth','error','Failed\x20to\x20get\x20CoinToPay\x20service\x20statistics','\x20days\x20if\x20not\x20paid','615292OJcRGJ','amount','deletePayout','../services/coinToPayStatusService','domainMonitoringService','currency','body','/users/:id','validate','Server\x20crashes\x20if\x20domain\x20is\x20not\x20responding\x20after\x20consecutive\x20failures','../middleware/validation'];a19_0x5c33=function(){return _0x1bbe1a;};return a19_0x5c33();}(function(_0x4c7db4,_0x2b4d81){const _0x2170f4=a19_0x3090,_0x9ce9c4=_0x4c7db4();while(!![]){try{const _0x12798d=-parseInt(_0x2170f4(0xcd))/0x1*(-parseInt(_0x2170f4(0x109))/0x2)+parseInt(_0x2170f4(0xb6))/0x3+parseInt(_0x2170f4(0xed))/0x4*(-parseInt(_0x2170f4(0xe2))/0x5)+parseInt(_0x2170f4(0xff))/0x6+-parseInt(_0x2170f4(0x105))/0x7*(-parseInt(_0x2170f4(0xde))/0x8)+-parseInt(_0x2170f4(0x119))/0x9+-parseInt(_0x2170f4(0x113))/0xa;if(_0x12798d===_0x2b4d81)break;else _0x9ce9c4['push'](_0x9ce9c4['shift']());}catch(_0x45bcc9){_0x9ce9c4['push'](_0x9ce9c4['shift']());}}}(a19_0x5c33,0xc5e01));var __createBinding=this&&this[a19_0x1ff793(0xc6)]||(Object[a19_0x1ff793(0xb3)]?function(_0x6ce18f,_0x5bf013,_0x294bf7,_0x21bf90){const _0x22a421=a19_0x1ff793;if(_0x21bf90===undefined)_0x21bf90=_0x294bf7;var _0x1be944=Object['getOwnPropertyDescriptor'](_0x5bf013,_0x294bf7);(!_0x1be944||(_0x22a421(0xaa)in _0x1be944?!_0x5bf013['__esModule']:_0x1be944['writable']||_0x1be944[_0x22a421(0xb1)]))&&(_0x1be944={'enumerable':!![],'get':function(){return _0x5bf013[_0x294bf7];}}),Object[_0x22a421(0x102)](_0x6ce18f,_0x21bf90,_0x1be944);}:function(_0x5da77c,_0x166595,_0x174a4a,_0x4da5f9){if(_0x4da5f9===undefined)_0x4da5f9=_0x174a4a;_0x5da77c[_0x4da5f9]=_0x166595[_0x174a4a];}),__setModuleDefault=this&&this[a19_0x1ff793(0xe1)]||(Object[a19_0x1ff793(0xb3)]?function(_0x21796e,_0x4779f3){const _0x5a5bb6=a19_0x1ff793;Object[_0x5a5bb6(0x102)](_0x21796e,_0x5a5bb6(0x11a),{'enumerable':!![],'value':_0x4779f3});}:function(_0x53f555,_0x462cd6){_0x53f555['default']=_0x462cd6;}),__importStar=this&&this['__importStar']||(function(){var _0x512616=function(_0x13967d){return _0x512616=Object['getOwnPropertyNames']||function(_0x5d5599){const _0x5d69bd=a19_0x3090;var _0x518a8d=[];for(var _0x371a8b in _0x5d5599)if(Object[_0x5d69bd(0xe4)]['hasOwnProperty'][_0x5d69bd(0xb4)](_0x5d5599,_0x371a8b))_0x518a8d[_0x518a8d[_0x5d69bd(0xce)]]=_0x371a8b;return _0x518a8d;},_0x512616(_0x13967d);};return function(_0x14cb89){const _0x94561b=a19_0x3090;if(_0x14cb89&&_0x14cb89['__esModule'])return _0x14cb89;var _0x448821={};if(_0x14cb89!=null){for(var _0x462ef0=_0x512616(_0x14cb89),_0x152dee=0x0;_0x152dee<_0x462ef0[_0x94561b(0xce)];_0x152dee++)if(_0x462ef0[_0x152dee]!==_0x94561b(0x11a))__createBinding(_0x448821,_0x14cb89,_0x462ef0[_0x152dee]);}return __setModuleDefault(_0x448821,_0x14cb89),_0x448821;};}());Object[a19_0x1ff793(0x102)](exports,a19_0x1ff793(0x10c),{'value':!![]});function a19_0x3090(_0x3c20f1,_0x5b9a48){const _0x5c3362=a19_0x5c33();return a19_0x3090=function(_0x309045,_0x1ff764){_0x309045=_0x309045-0xa6;let _0x5396d9=_0x5c3362[_0x309045];return _0x5396d9;},a19_0x3090(_0x3c20f1,_0x5b9a48);}const express_1=require('express'),adminController_1=require(a19_0x1ff793(0xc5)),validation_1=require(a19_0x1ff793(0xf7)),auth_1=require(a19_0x1ff793(0xe9)),loggerService_1=require(a19_0x1ff793(0xc9)),coinToPayStatusService_1=require(a19_0x1ff793(0xf0)),domainMonitoringService_1=require(a19_0x1ff793(0xae)),router=(0x0,express_1[a19_0x1ff793(0xb9)])(),adminController=new adminController_1['AdminController']();router[a19_0x1ff793(0xe3)](auth_1[a19_0x1ff793(0x10b)],auth_1['requireAdmin']),router[a19_0x1ff793(0xaa)]('/auth',adminController['checkAuth']),router['get'](a19_0x1ff793(0x10f),adminController[a19_0x1ff793(0x10e)]),router['get']('/merchant-statistics',adminController[a19_0x1ff793(0xbf)]),router[a19_0x1ff793(0xaa)](a19_0x1ff793(0xd5),adminController[a19_0x1ff793(0x100)]),router[a19_0x1ff793(0xaa)](a19_0x1ff793(0xfd),adminController['getMerchantsAwaitingPayout']),router[a19_0x1ff793(0xaa)](a19_0x1ff793(0xe8),adminController[a19_0x1ff793(0x111)]),router['post'](a19_0x1ff793(0xc7),(0x0,validation_1[a19_0x1ff793(0xf5)])(validation_1[a19_0x1ff793(0x11b)]),adminController[a19_0x1ff793(0xaf)]),router['get'](a19_0x1ff793(0x116),adminController[a19_0x1ff793(0xca)]),router[a19_0x1ff793(0xaa)](a19_0x1ff793(0xe0),adminController[a19_0x1ff793(0xab)]),router['delete'](a19_0x1ff793(0xe0),adminController[a19_0x1ff793(0xef)]),router[a19_0x1ff793(0xaa)]('/payments',adminController['getPayments']),router[a19_0x1ff793(0xaa)](a19_0x1ff793(0xc8),adminController[a19_0x1ff793(0xd0)]),router[a19_0x1ff793(0xc2)](a19_0x1ff793(0xc8),adminController[a19_0x1ff793(0xdd)]),router[a19_0x1ff793(0xc2)](a19_0x1ff793(0xd3),(0x0,validation_1[a19_0x1ff793(0xf5)])(validation_1['updateCustomerDataSchema']),adminController['updateCustomerData']),router['get'](a19_0x1ff793(0xcf),adminController[a19_0x1ff793(0xe5)]),router[a19_0x1ff793(0xaa)](a19_0x1ff793(0xf4),adminController[a19_0x1ff793(0xd8)]),router['post'](a19_0x1ff793(0xcf),(0x0,validation_1[a19_0x1ff793(0xf5)])(validation_1[a19_0x1ff793(0xa6)]),adminController[a19_0x1ff793(0xac)]),router[a19_0x1ff793(0xc2)](a19_0x1ff793(0xf4),(0x0,validation_1[a19_0x1ff793(0xf5)])(validation_1['updateUserSchema']),adminController[a19_0x1ff793(0x103)]),router[a19_0x1ff793(0x112)](a19_0x1ff793(0xf4),adminController[a19_0x1ff793(0xba)]),router[a19_0x1ff793(0x117)](a19_0x1ff793(0x106),adminController[a19_0x1ff793(0xb0)]),router[a19_0x1ff793(0x117)](a19_0x1ff793(0xfe),adminController[a19_0x1ff793(0xa9)]),router[a19_0x1ff793(0xaa)]('/logs/stats',(_0xf1d57a,_0x111c6e)=>{const _0x448ea2=a19_0x1ff793;try{const _0x51fabe=loggerService_1[_0x448ea2(0xd1)]['getLogStats']();_0x111c6e[_0x448ea2(0xda)]({'success':!![],'result':_0x51fabe});}catch(_0xcbc666){_0x111c6e['status'](0x1f4)[_0x448ea2(0xda)]({'success':![],'message':_0x448ea2(0x110)});}}),router[a19_0x1ff793(0x117)]('/logs/clean',(_0x436823,_0xc151bd)=>{const _0x461887=a19_0x1ff793;try{const {daysToKeep:daysToKeep=0x1e}=_0x436823[_0x461887(0xf3)];loggerService_1[_0x461887(0xd1)]['cleanOldLogs'](daysToKeep),_0xc151bd[_0x461887(0xda)]({'success':!![],'message':'Old\x20logs\x20cleaned\x20(kept\x20last\x20'+daysToKeep+_0x461887(0xbd)});}catch(_0x12ec25){_0xc151bd[_0x461887(0xdc)](0x1f4)[_0x461887(0xda)]({'success':![],'message':_0x461887(0x118)});}}),router['post'](a19_0x1ff793(0xfb),async(_0x230582,_0x4b2f4d)=>{const _0x39bcbc=a19_0x1ff793;try{const {paymentId:_0xd4517}=_0x230582[_0x39bcbc(0xcc)];console[_0x39bcbc(0xd4)]('🔍\x20[ADMIN]\x20Manual\x20CoinToPay\x20check\x20requested\x20for\x20payment:\x20'+_0xd4517),await coinToPayStatusService_1[_0x39bcbc(0x101)][_0x39bcbc(0xb2)](_0xd4517),_0x4b2f4d[_0x39bcbc(0xda)]({'success':!![],'message':'CoinToPay\x20payment\x20status\x20checked\x20successfully'});}catch(_0xba7df3){console[_0x39bcbc(0xea)]('❌\x20[ADMIN]\x20Manual\x20CoinToPay\x20check\x20failed\x20for\x20payment\x20'+_0x230582[_0x39bcbc(0xcc)]['paymentId']+':',_0xba7df3),_0x4b2f4d['status'](0x1f4)[_0x39bcbc(0xda)]({'success':![],'message':_0xba7df3 instanceof Error?_0xba7df3[_0x39bcbc(0xfa)]:_0x39bcbc(0x114)});}}),router['get'](a19_0x1ff793(0xdb),(_0x494a74,_0x3c4c2a)=>{const _0x74af86=a19_0x1ff793;try{const _0x3f4284=coinToPayStatusService_1[_0x74af86(0x101)]['getServiceStats']();_0x3c4c2a[_0x74af86(0xda)]({'success':!![],'result':{..._0x3f4284,'description':_0x74af86(0xe7),'statusMapping':{'Paid':_0x74af86(0xb7),'Awaiting\x20Fiat':_0x74af86(0xbb),'waiting':_0x74af86(0xbb),'expired':'EXPIRED','failed':'FAILED'},'autoExpiryNote':'Payments\x20automatically\x20expire\x20after\x20'+_0x3f4284[_0x74af86(0xb8)]+_0x74af86(0xec),'individualTimersNote':_0x74af86(0xd2)}});}catch(_0x44da48){_0x3c4c2a[_0x74af86(0xdc)](0x1f4)['json']({'success':![],'message':_0x74af86(0xeb)});}}),router[a19_0x1ff793(0xaa)](a19_0x1ff793(0xdf),async(_0x13fc9b,_0x5f1af5)=>{const _0x1e4e64=a19_0x1ff793;try{const {paymentId:_0x24c1bc}=_0x13fc9b['params'],_0x509f87=coinToPayStatusService_1['coinToPayStatusService'][_0x1e4e64(0xa8)](_0x24c1bc),_0x456f86=(await Promise['resolve']()[_0x1e4e64(0xa7)](()=>__importStar(require(_0x1e4e64(0xd7)))))[_0x1e4e64(0x11a)],_0x4eaf05=await _0x456f86[_0x1e4e64(0x10a)][_0x1e4e64(0xc0)]({'where':{'id':_0x24c1bc},'select':{'id':!![],'gateway':!![],'gatewayPaymentId':!![],'status':!![],'amount':!![],'currency':!![],'createdAt':!![],'updatedAt':!![],'shopId':!![],'shop':{'select':{'name':!![],'username':!![]}}}});if(!_0x4eaf05)return _0x5f1af5['status'](0x194)['json']({'success':![],'message':_0x1e4e64(0xd6)});_0x5f1af5['json']({'success':!![],'result':{'payment':{'id':_0x4eaf05['id'],'gateway':_0x4eaf05[_0x1e4e64(0x104)],'gatewayPaymentId':_0x4eaf05[_0x1e4e64(0xe6)],'status':_0x4eaf05[_0x1e4e64(0xdc)],'amount':_0x4eaf05[_0x1e4e64(0xee)],'currency':_0x4eaf05[_0x1e4e64(0xf2)],'createdAt':_0x4eaf05['createdAt'],'updatedAt':_0x4eaf05['updatedAt'],'shop':_0x4eaf05[_0x1e4e64(0xb5)]},'timers':_0x509f87,'isCoinToPay':_0x4eaf05['gateway']===_0x1e4e64(0xad),'ageInMinutes':Math[_0x1e4e64(0xcb)]((Date[_0x1e4e64(0xfc)]()-_0x4eaf05[_0x1e4e64(0x107)][_0x1e4e64(0xbc)]())/(0x3e8*0x3c))}});}catch(_0x2c6cfd){_0x5f1af5[_0x1e4e64(0xdc)](0x1f4)[_0x1e4e64(0xda)]({'success':![],'message':_0x2c6cfd instanceof Error?_0x2c6cfd['message']:_0x1e4e64(0xd9)});}}),router[a19_0x1ff793(0xaa)](a19_0x1ff793(0xc3),(_0xf2d8d4,_0x51d56e)=>{const _0x1918d5=a19_0x1ff793;try{const _0x2ba487=domainMonitoringService_1[_0x1918d5(0xf1)][_0x1918d5(0x108)]();_0x51d56e[_0x1918d5(0xda)]({'success':!![],'result':{..._0x2ba487,'description':_0x1918d5(0xf9),'behavior':_0x1918d5(0xf6),'encoding':_0x1918d5(0x10d)}});}catch(_0x4b7839){_0x51d56e[_0x1918d5(0xdc)](0x1f4)['json']({'success':![],'message':'Failed\x20to\x20get\x20domain\x20monitoring\x20statistics'});}}),router[a19_0x1ff793(0x117)](a19_0x1ff793(0xf8),async(_0x453e62,_0x128249)=>{const _0x59e8f1=a19_0x1ff793;try{const _0x5e751e=await domainMonitoringService_1['domainMonitoringService'][_0x59e8f1(0xc4)]();_0x128249[_0x59e8f1(0xda)]({'success':!![],'result':{'domainAvailable':_0x5e751e,'message':_0x5e751e?_0x59e8f1(0xbe):_0x59e8f1(0xc1),'timestamp':new Date()['toISOString']()}});}catch(_0x39a358){_0x128249[_0x59e8f1(0xdc)](0x1f4)['json']({'success':![],'message':_0x39a358 instanceof Error?_0x39a358[_0x59e8f1(0xfa)]:_0x59e8f1(0x115)});}}),exports[a19_0x1ff793(0x11a)]=router;