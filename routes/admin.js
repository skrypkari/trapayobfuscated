'use strict';const a21_0xfbd7f9=a21_0x5e6d;(function(_0x536095,_0x174aec){const _0x58e8f3=a21_0x5e6d,_0x5df77a=_0x536095();while(!![]){try{const _0x4fc394=-parseInt(_0x58e8f3(0xdd))/0x1+parseInt(_0x58e8f3(0xb9))/0x2+parseInt(_0x58e8f3(0x9a))/0x3+parseInt(_0x58e8f3(0x9e))/0x4*(parseInt(_0x58e8f3(0xd3))/0x5)+-parseInt(_0x58e8f3(0xc3))/0x6+parseInt(_0x58e8f3(0x98))/0x7+-parseInt(_0x58e8f3(0x80))/0x8;if(_0x4fc394===_0x174aec)break;else _0x5df77a['push'](_0x5df77a['shift']());}catch(_0x2bcf50){_0x5df77a['push'](_0x5df77a['shift']());}}}(a21_0x3cc8,0xd5053));function a21_0x3cc8(){const _0xcbec14=['currency','../middleware/auth','put','/payouts','updatePayment','Domain\x20monitoring\x20service\x20for\x20amaterasy884.icu','PAID','/payments/cleanup','Payment\x20not\x20found','createUser','suspendUser','requireAdmin','/domain-monitoring/check','AdminController','validate','getStatistics','prototype','getOwnPropertyNames','paymentId','/users/:id/activate','/cointopay/payment/:paymentId','../services/coinToPayStatusService','/payout/merchants','789556XTdmYL','message','Requests\x20are\x20made\x20with\x20base64\x20encoded\x20URLs','manualCheck','error','getUsers','getTime','Failed\x20to\x20get\x20payment\x20information','updateUserSchema','__importStar','3377532GLJEdE','/merchants/selection','CoinToPay\x20automatic\x20status\x20checking\x20service','Domain\x20is\x20responding\x20correctly','default','getPaymentTimerInfo','cleanupStalePendingPayments','createdAt','/payouts/:id','status','getMerchantStatistics','/users/:id','now','Domain\x20check\x20failed','Failed\x20to\x20get\x20log\x20statistics','__createBinding','1400dtswvJ','/payout','params','EXPIRED','createPayoutSchema','authenticateToken','/domain-monitoring/stats','getPaymentById','get','updateCustomerDataSchema','1224344MSkCTd','defineProperty','then','activateUser','/users/:id/suspend','../config/database','cleanupStalePayments','/logs/stats','/logs/clean','Failed\x20to\x20get\x20domain\x20monitoring\x20statistics','configurable','getOwnPropertyDescriptor','Failed\x20to\x20perform\x20manual\x20domain\x20check','/payments/cleanup-pending','Each\x20new\x20payment\x20gets\x20individual\x20timers:\x201min,\x202min,\x207min,\x2012min,\x20then\x20hourly','../services/domainMonitoringService','CoinToPay\x20payment\x20status\x20checked\x20successfully','/payments/:id/customer','coinToPayStatusService','findUnique','__esModule','create','checkPaymentById','payment','/auth','getServiceStats','gatewayPaymentId','expiryDays','/statistics','updateCustomerData','amount','10252536cSZaFO','/payments/cleanup-with-report','../middleware/validation','üîç\x20[ADMIN]\x20Manual\x20CoinToPay\x20check\x20requested\x20for\x20payment:\x20','updateUser','cleanOldLogs','post','Failed\x20to\x20check\x20CoinToPay\x20payment\x20status','cointopay','Failed\x20to\x20clean\x20old\x20logs','body','Old\x20logs\x20cleaned\x20(kept\x20last\x20','/cointopay/check/:paymentId','getPayoutStats','/merchant-statistics','Failed\x20to\x20get\x20CoinToPay\x20service\x20statistics','call','createPayout','domainMonitoringService','__setModuleDefault','\x20days\x20if\x20not\x20paid','length','writable','Server\x20crashes\x20if\x20domain\x20is\x20not\x20responding\x20after\x20consecutive\x20failures','11221644tzpNGw','cleanupStalePaymentsWithReport','4256322sygtaG','delete','deletePayout','FAILED','7496tQjkkc','/payments/:id','log','json'];a21_0x3cc8=function(){return _0xcbec14;};return a21_0x3cc8();}function a21_0x5e6d(_0x541e68,_0x5226fa){const _0x3cc8c8=a21_0x3cc8();return a21_0x5e6d=function(_0x5e6d5f,_0x4f022d){_0x5e6d5f=_0x5e6d5f-0x6b;let _0xb0036c=_0x3cc8c8[_0x5e6d5f];return _0xb0036c;},a21_0x5e6d(_0x541e68,_0x5226fa);}var __createBinding=this&&this[a21_0xfbd7f9(0xd2)]||(Object[a21_0xfbd7f9(0x76)]?function(_0x1a05b3,_0xabee26,_0x57e67c,_0x3a0af3){const _0x22e9a7=a21_0xfbd7f9;if(_0x3a0af3===undefined)_0x3a0af3=_0x57e67c;var _0x5f1e3a=Object[_0x22e9a7(0x6c)](_0xabee26,_0x57e67c);(!_0x5f1e3a||(_0x22e9a7(0xdb)in _0x5f1e3a?!_0xabee26[_0x22e9a7(0x75)]:_0x5f1e3a[_0x22e9a7(0x96)]||_0x5f1e3a[_0x22e9a7(0x6b)]))&&(_0x5f1e3a={'enumerable':!![],'get':function(){return _0xabee26[_0x57e67c];}}),Object[_0x22e9a7(0xde)](_0x1a05b3,_0x3a0af3,_0x5f1e3a);}:function(_0x527ffe,_0x52b397,_0x2978b8,_0x4bb3bc){if(_0x4bb3bc===undefined)_0x4bb3bc=_0x2978b8;_0x527ffe[_0x4bb3bc]=_0x52b397[_0x2978b8];}),__setModuleDefault=this&&this[a21_0xfbd7f9(0x93)]||(Object[a21_0xfbd7f9(0x76)]?function(_0x92fcd,_0x41f315){const _0x107810=a21_0xfbd7f9;Object[_0x107810(0xde)](_0x92fcd,'default',{'enumerable':!![],'value':_0x41f315});}:function(_0x5b9717,_0x16f9d0){_0x5b9717['default']=_0x16f9d0;}),__importStar=this&&this[a21_0xfbd7f9(0xc2)]||(function(){var _0x3d5d7d=function(_0x1b09f3){const _0x2aa706=a21_0x5e6d;return _0x3d5d7d=Object[_0x2aa706(0xb3)]||function(_0x36389e){const _0xf41feb=_0x2aa706;var _0x456299=[];for(var _0x12f5cc in _0x36389e)if(Object[_0xf41feb(0xb2)]['hasOwnProperty'][_0xf41feb(0x90)](_0x36389e,_0x12f5cc))_0x456299[_0x456299[_0xf41feb(0x95)]]=_0x12f5cc;return _0x456299;},_0x3d5d7d(_0x1b09f3);};return function(_0x51e7bb){const _0xbd54e4=a21_0x5e6d;if(_0x51e7bb&&_0x51e7bb[_0xbd54e4(0x75)])return _0x51e7bb;var _0x5332b5={};if(_0x51e7bb!=null){for(var _0x4a6b4f=_0x3d5d7d(_0x51e7bb),_0x3f8270=0x0;_0x3f8270<_0x4a6b4f['length'];_0x3f8270++)if(_0x4a6b4f[_0x3f8270]!=='default')__createBinding(_0x5332b5,_0x51e7bb,_0x4a6b4f[_0x3f8270]);}return __setModuleDefault(_0x5332b5,_0x51e7bb),_0x5332b5;};}());Object[a21_0xfbd7f9(0xde)](exports,a21_0xfbd7f9(0x75),{'value':!![]});const express_1=require('express'),adminController_1=require('../controllers/adminController'),validation_1=require(a21_0xfbd7f9(0x82)),auth_1=require(a21_0xfbd7f9(0xa3)),loggerService_1=require('../services/loggerService'),coinToPayStatusService_1=require(a21_0xfbd7f9(0xb7)),domainMonitoringService_1=require(a21_0xfbd7f9(0x70)),router=(0x0,express_1['Router'])(),adminController=new adminController_1[(a21_0xfbd7f9(0xaf))]();router['use'](auth_1[a21_0xfbd7f9(0xd8)],auth_1[a21_0xfbd7f9(0xad)]),router[a21_0xfbd7f9(0xdb)](a21_0xfbd7f9(0x79),adminController['checkAuth']),router[a21_0xfbd7f9(0xdb)](a21_0xfbd7f9(0x7d),adminController[a21_0xfbd7f9(0xb1)]),router[a21_0xfbd7f9(0xdb)](a21_0xfbd7f9(0x8e),adminController[a21_0xfbd7f9(0xcd)]),router[a21_0xfbd7f9(0xdb)]('/payout/stats',adminController[a21_0xfbd7f9(0x8d)]),router[a21_0xfbd7f9(0xdb)](a21_0xfbd7f9(0xb8),adminController['getMerchantsAwaitingPayout']),router[a21_0xfbd7f9(0xdb)](a21_0xfbd7f9(0xc4),adminController['getMerchantsSelection']),router['post'](a21_0xfbd7f9(0xd4),(0x0,validation_1['validate'])(validation_1[a21_0xfbd7f9(0xd7)]),adminController[a21_0xfbd7f9(0x91)]),router[a21_0xfbd7f9(0xdb)](a21_0xfbd7f9(0xa5),adminController['getPayouts']),router[a21_0xfbd7f9(0xdb)](a21_0xfbd7f9(0xcb),adminController['getPayoutById']),router[a21_0xfbd7f9(0x9b)]('/payouts/:id',adminController[a21_0xfbd7f9(0x9c)]),router[a21_0xfbd7f9(0xdb)]('/payments',adminController['getPayments']),router[a21_0xfbd7f9(0xdb)](a21_0xfbd7f9(0x9f),adminController[a21_0xfbd7f9(0xda)]),router[a21_0xfbd7f9(0xa4)](a21_0xfbd7f9(0x9f),adminController[a21_0xfbd7f9(0xa6)]),router[a21_0xfbd7f9(0xa4)](a21_0xfbd7f9(0x72),(0x0,validation_1['validate'])(validation_1[a21_0xfbd7f9(0xdc)]),adminController[a21_0xfbd7f9(0x7e)]),router['get']('/payments/processing-stats',adminController['getProcessingPaymentsStats']),router[a21_0xfbd7f9(0x86)](a21_0xfbd7f9(0xa9),adminController[a21_0xfbd7f9(0xe3)]),router[a21_0xfbd7f9(0x86)](a21_0xfbd7f9(0x6e),adminController[a21_0xfbd7f9(0xc9)]),router[a21_0xfbd7f9(0x86)](a21_0xfbd7f9(0x81),adminController[a21_0xfbd7f9(0x99)]),router['get']('/users',adminController[a21_0xfbd7f9(0xbe)]),router['get'](a21_0xfbd7f9(0xce),adminController['getUserById']),router['post']('/users',(0x0,validation_1['validate'])(validation_1['createUserSchema']),adminController[a21_0xfbd7f9(0xab)]),router['put'](a21_0xfbd7f9(0xce),(0x0,validation_1[a21_0xfbd7f9(0xb0)])(validation_1[a21_0xfbd7f9(0xc1)]),adminController[a21_0xfbd7f9(0x84)]),router[a21_0xfbd7f9(0x9b)]('/users/:id',adminController['deleteUser']),router[a21_0xfbd7f9(0x86)](a21_0xfbd7f9(0xe1),adminController[a21_0xfbd7f9(0xac)]),router[a21_0xfbd7f9(0x86)](a21_0xfbd7f9(0xb5),adminController[a21_0xfbd7f9(0xe0)]),router[a21_0xfbd7f9(0xdb)](a21_0xfbd7f9(0xe4),(_0x3b57e1,_0x255ce6)=>{const _0x3691d4=a21_0xfbd7f9;try{const _0x3a5e63=loggerService_1['loggerService']['getLogStats']();_0x255ce6[_0x3691d4(0xa1)]({'success':!![],'result':_0x3a5e63});}catch(_0x568d7a){_0x255ce6['status'](0x1f4)['json']({'success':![],'message':_0x3691d4(0xd1)});}}),router[a21_0xfbd7f9(0x86)](a21_0xfbd7f9(0xe5),(_0x32a99d,_0x14f817)=>{const _0x24800d=a21_0xfbd7f9;try{const {daysToKeep:daysToKeep=0x1e}=_0x32a99d[_0x24800d(0x8a)];loggerService_1['loggerService'][_0x24800d(0x85)](daysToKeep),_0x14f817[_0x24800d(0xa1)]({'success':!![],'message':_0x24800d(0x8b)+daysToKeep+'\x20days)'});}catch(_0x338b98){_0x14f817[_0x24800d(0xcc)](0x1f4)[_0x24800d(0xa1)]({'success':![],'message':_0x24800d(0x89)});}}),router[a21_0xfbd7f9(0x86)](a21_0xfbd7f9(0x8c),async(_0x178306,_0xdd489)=>{const _0x35cf4c=a21_0xfbd7f9;try{const {paymentId:_0x4a9e67}=_0x178306[_0x35cf4c(0xd5)];console[_0x35cf4c(0xa0)](_0x35cf4c(0x83)+_0x4a9e67),await coinToPayStatusService_1[_0x35cf4c(0x73)][_0x35cf4c(0x77)](_0x4a9e67),_0xdd489[_0x35cf4c(0xa1)]({'success':!![],'message':_0x35cf4c(0x71)});}catch(_0x3d1cf6){console[_0x35cf4c(0xbd)]('‚ùå\x20[ADMIN]\x20Manual\x20CoinToPay\x20check\x20failed\x20for\x20payment\x20'+_0x178306[_0x35cf4c(0xd5)][_0x35cf4c(0xb4)]+':',_0x3d1cf6),_0xdd489['status'](0x1f4)[_0x35cf4c(0xa1)]({'success':![],'message':_0x3d1cf6 instanceof Error?_0x3d1cf6[_0x35cf4c(0xba)]:_0x35cf4c(0x87)});}}),router[a21_0xfbd7f9(0xdb)]('/cointopay/stats',(_0x3c7424,_0x39f85a)=>{const _0x480437=a21_0xfbd7f9;try{const _0xe8e9ad=coinToPayStatusService_1['coinToPayStatusService'][_0x480437(0x7a)]();_0x39f85a['json']({'success':!![],'result':{..._0xe8e9ad,'description':_0x480437(0xc5),'statusMapping':{'Paid':_0x480437(0xa8),'Awaiting\x20Fiat':'PENDING','waiting':'PENDING','expired':_0x480437(0xd6),'failed':_0x480437(0x9d)},'autoExpiryNote':'Payments\x20automatically\x20expire\x20after\x20'+_0xe8e9ad[_0x480437(0x7c)]+_0x480437(0x94),'individualTimersNote':_0x480437(0x6f)}});}catch(_0x333010){_0x39f85a['status'](0x1f4)['json']({'success':![],'message':_0x480437(0x8f)});}}),router[a21_0xfbd7f9(0xdb)](a21_0xfbd7f9(0xb6),async(_0x11c72c,_0x2350ae)=>{const _0x5c06ef=a21_0xfbd7f9;try{const {paymentId:_0x18a46e}=_0x11c72c[_0x5c06ef(0xd5)],_0x5476f5=coinToPayStatusService_1['coinToPayStatusService'][_0x5c06ef(0xc8)](_0x18a46e),_0x411e94=(await Promise['resolve']()[_0x5c06ef(0xdf)](()=>__importStar(require(_0x5c06ef(0xe2)))))[_0x5c06ef(0xc7)],_0x551390=await _0x411e94[_0x5c06ef(0x78)][_0x5c06ef(0x74)]({'where':{'id':_0x18a46e},'select':{'id':!![],'gateway':!![],'gatewayPaymentId':!![],'status':!![],'amount':!![],'currency':!![],'createdAt':!![],'updatedAt':!![],'shopId':!![],'shop':{'select':{'name':!![],'username':!![]}}}});if(!_0x551390)return _0x2350ae[_0x5c06ef(0xcc)](0x194)[_0x5c06ef(0xa1)]({'success':![],'message':_0x5c06ef(0xaa)});_0x2350ae[_0x5c06ef(0xa1)]({'success':!![],'result':{'payment':{'id':_0x551390['id'],'gateway':_0x551390['gateway'],'gatewayPaymentId':_0x551390[_0x5c06ef(0x7b)],'status':_0x551390[_0x5c06ef(0xcc)],'amount':_0x551390[_0x5c06ef(0x7f)],'currency':_0x551390[_0x5c06ef(0xa2)],'createdAt':_0x551390[_0x5c06ef(0xca)],'updatedAt':_0x551390['updatedAt'],'shop':_0x551390['shop']},'timers':_0x5476f5,'isCoinToPay':_0x551390['gateway']===_0x5c06ef(0x88),'ageInMinutes':Math['floor']((Date[_0x5c06ef(0xcf)]()-_0x551390[_0x5c06ef(0xca)][_0x5c06ef(0xbf)]())/(0x3e8*0x3c))}});}catch(_0x24afc7){_0x2350ae[_0x5c06ef(0xcc)](0x1f4)[_0x5c06ef(0xa1)]({'success':![],'message':_0x24afc7 instanceof Error?_0x24afc7[_0x5c06ef(0xba)]:_0x5c06ef(0xc0)});}}),router['get'](a21_0xfbd7f9(0xd9),(_0xc229f7,_0x216dc5)=>{const _0x5cc58c=a21_0xfbd7f9;try{const _0x1114d8=domainMonitoringService_1['domainMonitoringService']['getMonitoringStats']();_0x216dc5['json']({'success':!![],'result':{..._0x1114d8,'description':_0x5cc58c(0xa7),'behavior':_0x5cc58c(0x97),'encoding':_0x5cc58c(0xbb)}});}catch(_0xbc7b19){_0x216dc5[_0x5cc58c(0xcc)](0x1f4)['json']({'success':![],'message':_0x5cc58c(0xe6)});}}),router['post'](a21_0xfbd7f9(0xae),async(_0x2fbc25,_0x35fa90)=>{const _0x2ee2af=a21_0xfbd7f9;try{const _0x8a1a47=await domainMonitoringService_1[_0x2ee2af(0x92)][_0x2ee2af(0xbc)]();_0x35fa90[_0x2ee2af(0xa1)]({'success':!![],'result':{'domainAvailable':_0x8a1a47,'message':_0x8a1a47?_0x2ee2af(0xc6):_0x2ee2af(0xd0),'timestamp':new Date()['toISOString']()}});}catch(_0xa38105){_0x35fa90['status'](0x1f4)['json']({'success':![],'message':_0xa38105 instanceof Error?_0xa38105[_0x2ee2af(0xba)]:_0x2ee2af(0x6d)});}}),exports['default']=router;