'use strict';const a19_0x44b329=a19_0x5175;(function(_0x236777,_0x422c73){const _0x8f0e8e=a19_0x5175,_0x1e336b=_0x236777();while(!![]){try{const _0x5d4f6f=parseInt(_0x8f0e8e(0x239))/0x1+parseInt(_0x8f0e8e(0x1bc))/0x2*(-parseInt(_0x8f0e8e(0x23f))/0x3)+-parseInt(_0x8f0e8e(0x1e9))/0x4+parseInt(_0x8f0e8e(0x240))/0x5*(parseInt(_0x8f0e8e(0x1f2))/0x6)+-parseInt(_0x8f0e8e(0x21f))/0x7+parseInt(_0x8f0e8e(0x1cb))/0x8+parseInt(_0x8f0e8e(0x213))/0x9;if(_0x5d4f6f===_0x422c73)break;else _0x1e336b['push'](_0x1e336b['shift']());}catch(_0x1d7e30){_0x1e336b['push'](_0x1e336b['shift']());}}}(a19_0x368d,0xb5d8b));function a19_0x368d(){const _0x4f5624=['../services/domainMonitoringService','/payments/:id','/payouts','checkPaymentById','params','Rapyd\x20automatic\x20status\x20checking\x20service','toISOString','hasOwnProperty','shop','updateCustomerData','__importStar','Failed\x20to\x20get\x20domain\x20monitoring\x20statistics','json','updatePayment','PAID','Each\x20new\x20payment\x20gets\x20individual\x20timers:\x201min,\x202min,\x207min,\x2012min,\x20then\x20hourly','create','Requests\x20are\x20made\x20with\x20base64\x20encoded\x20URLs','createPayoutSchema','\x20days)','EXPIRED','Domain\x20is\x20responding\x20correctly','__setModuleDefault','7310601RiZJDj','Server\x20crashes\x20if\x20domain\x20is\x20not\x20responding\x20after\x20consecutive\x20failures','requireAdmin','updatedAt','getTime','getPayouts','expiryDays','Domain\x20check\x20failed','updateUser','/domain-monitoring/stats','/statistics','getOwnPropertyNames','975681hNxAYf','getPayoutById','Failed\x20to\x20get\x20CoinToPay\x20service\x20statistics','Failed\x20to\x20get\x20log\x20statistics','getUserById','log','getPaymentTimerInfo','prototype','post','manualCheck','getMerchantsAwaitingPayout','getMonitoringStats','Payment\x20not\x20found','Only\x20checks\x20payments\x20with\x20status\x20PENDING\x20at\x20check\x20time','gatewayPaymentId','/users/:id/activate','call','put','payment','CoinToPay\x20payment\x20status\x20checked\x20successfully','resolve','No\x20more\x20checks\x20scheduled','paymentId','findUnique','validate','PENDING','1444947mHSZgN','../services/coinToPayStatusService','delete','status','currency','No\x20checks\x20scheduled','3rZDMGc','25910TxrAYh','getPaymentById','__importDefault','now','updateCustomerDataSchema','/cointopay/stats','getServiceStats','authenticateToken','deleteUser','hasTimers','../services/loggerService','2376186IiLRpN','/payouts/:id','Failed\x20to\x20get\x20Rapyd\x20service\x20statistics','Payments\x20automatically\x20expire\x20after\x20','/cointopay/check/:paymentId','Failed\x20to\x20check\x20CoinToPay\x20payment\x20status','/auth','activateUser','createUserSchema','/users/:id/suspend','amount','loggerService','../config/database','length','floor','5108728wJlXcS','cleanOldLogs','üîç\x20[ADMIN]\x20Manual\x20CoinToPay\x20check\x20requested\x20for\x20payment:\x20','default','express','/logs/stats','/merchants/selection','/logs/clean','cointopay','\x20days\x20if\x20not\x20paid','coinToPayStatusService','/payments/:id/customer','suspendUser','Failed\x20to\x20get\x20payment\x20information','FAILED','getOwnPropertyDescriptor','/users/:id','/domain-monitoring/check','Router','rapyd','updateUserSchema','../services/rapydStatusService','/cointopay/payment/:paymentId','error','writable','body','Domain\x20monitoring\x20service\x20for\x20amaterasy884.icu','../middleware/validation','createUser','createPayout','3667136tozGyo','../middleware/auth','get','createdAt','rapydStatusService','/payout','message','getMerchantStatistics','\x20minutes','108uEdYFr','__esModule','Old\x20logs\x20cleaned\x20(kept\x20last\x20','defineProperty','/rapyd/check/:paymentId','üîç\x20[ADMIN]\x20Manual\x20Rapyd\x20check\x20requested\x20for\x20payment:\x20','domainMonitoringService','gateway','then','/payments'];a19_0x368d=function(){return _0x4f5624;};return a19_0x368d();}function a19_0x5175(_0x31bcfd,_0x264ecf){const _0x368dad=a19_0x368d();return a19_0x5175=function(_0x5175bd,_0x2afcaf){_0x5175bd=_0x5175bd-0x1b6;let _0x7c8009=_0x368dad[_0x5175bd];return _0x7c8009;},a19_0x5175(_0x31bcfd,_0x264ecf);}var __createBinding=this&&this['__createBinding']||(Object[a19_0x44b329(0x20c)]?function(_0xf270e7,_0x25ea5a,_0x202ccc,_0x22e8c7){const _0x48b460=a19_0x44b329;if(_0x22e8c7===undefined)_0x22e8c7=_0x202ccc;var _0x3a1859=Object[_0x48b460(0x1da)](_0x25ea5a,_0x202ccc);(!_0x3a1859||('get'in _0x3a1859?!_0x25ea5a[_0x48b460(0x1f3)]:_0x3a1859[_0x48b460(0x1e3)]||_0x3a1859['configurable']))&&(_0x3a1859={'enumerable':!![],'get':function(){return _0x25ea5a[_0x202ccc];}}),Object[_0x48b460(0x1f5)](_0xf270e7,_0x22e8c7,_0x3a1859);}:function(_0x11e3ab,_0x3759cc,_0x5e9763,_0x4c8f47){if(_0x4c8f47===undefined)_0x4c8f47=_0x5e9763;_0x11e3ab[_0x4c8f47]=_0x3759cc[_0x5e9763];}),__setModuleDefault=this&&this[a19_0x44b329(0x212)]||(Object['create']?function(_0x5dcf1d,_0x458043){const _0x3ec292=a19_0x44b329;Object[_0x3ec292(0x1f5)](_0x5dcf1d,_0x3ec292(0x1ce),{'enumerable':!![],'value':_0x458043});}:function(_0x4dde0b,_0x54c7b4){const _0x5ce996=a19_0x44b329;_0x4dde0b[_0x5ce996(0x1ce)]=_0x54c7b4;}),__importStar=this&&this[a19_0x44b329(0x206)]||(function(){var _0x3f6ee6=function(_0x1e6b56){const _0x3d4421=a19_0x5175;return _0x3f6ee6=Object[_0x3d4421(0x21e)]||function(_0xb25915){const _0x5f02fe=_0x3d4421;var _0x4a1981=[];for(var _0x5b2119 in _0xb25915)if(Object[_0x5f02fe(0x226)][_0x5f02fe(0x203)][_0x5f02fe(0x22f)](_0xb25915,_0x5b2119))_0x4a1981[_0x4a1981[_0x5f02fe(0x1c9)]]=_0x5b2119;return _0x4a1981;},_0x3f6ee6(_0x1e6b56);};return function(_0x3c71f3){const _0x5ac2ab=a19_0x5175;if(_0x3c71f3&&_0x3c71f3['__esModule'])return _0x3c71f3;var _0x236858={};if(_0x3c71f3!=null){for(var _0x5d0de7=_0x3f6ee6(_0x3c71f3),_0x410f3b=0x0;_0x410f3b<_0x5d0de7['length'];_0x410f3b++)if(_0x5d0de7[_0x410f3b]!==_0x5ac2ab(0x1ce))__createBinding(_0x236858,_0x3c71f3,_0x5d0de7[_0x410f3b]);}return __setModuleDefault(_0x236858,_0x3c71f3),_0x236858;};}()),__importDefault=this&&this[a19_0x44b329(0x242)]||function(_0x560f3f){const _0x3e2719=a19_0x44b329;return _0x560f3f&&_0x560f3f[_0x3e2719(0x1f3)]?_0x560f3f:{'default':_0x560f3f};};Object[a19_0x44b329(0x1f5)](exports,a19_0x44b329(0x1f3),{'value':!![]});const express_1=require(a19_0x44b329(0x1cf)),adminController_1=require('../controllers/adminController'),validation_1=require(a19_0x44b329(0x1e6)),auth_1=require(a19_0x44b329(0x1ea)),loggerService_1=require(a19_0x44b329(0x1bb)),coinToPayStatusService_1=require(a19_0x44b329(0x23a)),rapydStatusService_1=require(a19_0x44b329(0x1e0)),domainMonitoringService_1=require(a19_0x44b329(0x1fc)),database_1=__importDefault(require(a19_0x44b329(0x1c8))),router=(0x0,express_1[a19_0x44b329(0x1dd)])(),adminController=new adminController_1['AdminController']();router['use'](auth_1[a19_0x44b329(0x1b8)],auth_1[a19_0x44b329(0x215)]),router[a19_0x44b329(0x1eb)](a19_0x44b329(0x1c2),adminController['checkAuth']),router[a19_0x44b329(0x1eb)](a19_0x44b329(0x21d),adminController['getStatistics']),router['get']('/merchant-statistics',adminController[a19_0x44b329(0x1f0)]),router[a19_0x44b329(0x1eb)](a19_0x44b329(0x1d1),adminController['getMerchantsSelection']),router[a19_0x44b329(0x1eb)]('/payout/stats',adminController['getPayoutStats']),router[a19_0x44b329(0x1eb)]('/payout/merchants',adminController[a19_0x44b329(0x229)]),router[a19_0x44b329(0x227)](a19_0x44b329(0x1ee),(0x0,validation_1[a19_0x44b329(0x237)])(validation_1[a19_0x44b329(0x20e)]),adminController[a19_0x44b329(0x1e8)]),router[a19_0x44b329(0x1eb)](a19_0x44b329(0x1fe),adminController[a19_0x44b329(0x218)]),router[a19_0x44b329(0x1eb)](a19_0x44b329(0x1bd),adminController[a19_0x44b329(0x220)]),router[a19_0x44b329(0x23b)](a19_0x44b329(0x1bd),adminController['deletePayout']),router[a19_0x44b329(0x1eb)](a19_0x44b329(0x1fb),adminController['getPayments']),router[a19_0x44b329(0x1eb)](a19_0x44b329(0x1fd),adminController[a19_0x44b329(0x241)]),router[a19_0x44b329(0x230)](a19_0x44b329(0x1fd),adminController[a19_0x44b329(0x209)]),router[a19_0x44b329(0x230)](a19_0x44b329(0x1d6),(0x0,validation_1[a19_0x44b329(0x237)])(validation_1[a19_0x44b329(0x244)]),adminController[a19_0x44b329(0x205)]),router[a19_0x44b329(0x1eb)]('/users',adminController['getUsers']),router[a19_0x44b329(0x1eb)](a19_0x44b329(0x1db),adminController[a19_0x44b329(0x223)]),router[a19_0x44b329(0x227)]('/users',(0x0,validation_1[a19_0x44b329(0x237)])(validation_1[a19_0x44b329(0x1c4)]),adminController[a19_0x44b329(0x1e7)]),router[a19_0x44b329(0x230)](a19_0x44b329(0x1db),(0x0,validation_1[a19_0x44b329(0x237)])(validation_1[a19_0x44b329(0x1df)]),adminController[a19_0x44b329(0x21b)]),router[a19_0x44b329(0x23b)]('/users/:id',adminController[a19_0x44b329(0x1b9)]),router[a19_0x44b329(0x227)](a19_0x44b329(0x1c5),adminController[a19_0x44b329(0x1d7)]),router[a19_0x44b329(0x227)](a19_0x44b329(0x22e),adminController[a19_0x44b329(0x1c3)]),router[a19_0x44b329(0x1eb)](a19_0x44b329(0x1d0),(_0x460642,_0x5c9c5e)=>{const _0x21c70d=a19_0x44b329;try{const _0x4e3005=loggerService_1[_0x21c70d(0x1c7)]['getLogStats']();_0x5c9c5e[_0x21c70d(0x208)]({'success':!![],'result':_0x4e3005});}catch(_0x34550b){_0x5c9c5e[_0x21c70d(0x23c)](0x1f4)[_0x21c70d(0x208)]({'success':![],'message':_0x21c70d(0x222)});}}),router[a19_0x44b329(0x227)](a19_0x44b329(0x1d2),(_0x28b883,_0x1cc9d6)=>{const _0x40f6c1=a19_0x44b329;try{const {daysToKeep:daysToKeep=0x1e}=_0x28b883[_0x40f6c1(0x1e4)];loggerService_1[_0x40f6c1(0x1c7)][_0x40f6c1(0x1cc)](daysToKeep),_0x1cc9d6['json']({'success':!![],'message':_0x40f6c1(0x1f4)+daysToKeep+_0x40f6c1(0x20f)});}catch(_0x2f1481){_0x1cc9d6[_0x40f6c1(0x23c)](0x1f4)[_0x40f6c1(0x208)]({'success':![],'message':'Failed\x20to\x20clean\x20old\x20logs'});}}),router[a19_0x44b329(0x227)](a19_0x44b329(0x1c0),async(_0x130f3e,_0x416d56)=>{const _0x1e67d6=a19_0x44b329;try{const {paymentId:_0x323f75}=_0x130f3e[_0x1e67d6(0x200)];console['log'](_0x1e67d6(0x1cd)+_0x323f75),await coinToPayStatusService_1[_0x1e67d6(0x1d5)][_0x1e67d6(0x1ff)](_0x323f75),_0x416d56[_0x1e67d6(0x208)]({'success':!![],'message':_0x1e67d6(0x232)});}catch(_0x4daf79){console['error']('‚ùå\x20[ADMIN]\x20Manual\x20CoinToPay\x20check\x20failed\x20for\x20payment\x20'+_0x130f3e['params'][_0x1e67d6(0x235)]+':',_0x4daf79),_0x416d56[_0x1e67d6(0x23c)](0x1f4)[_0x1e67d6(0x208)]({'success':![],'message':_0x4daf79 instanceof Error?_0x4daf79[_0x1e67d6(0x1ef)]:_0x1e67d6(0x1c1)});}}),router[a19_0x44b329(0x1eb)](a19_0x44b329(0x1b6),(_0x4775e3,_0x5a58bc)=>{const _0x287a3c=a19_0x44b329;try{const _0x5c8f06=coinToPayStatusService_1[_0x287a3c(0x1d5)][_0x287a3c(0x1b7)]();_0x5a58bc['json']({'success':!![],'result':{..._0x5c8f06,'description':'CoinToPay\x20automatic\x20status\x20checking\x20service','statusMapping':{'Paid':_0x287a3c(0x20a),'Awaiting\x20Fiat':_0x287a3c(0x238),'waiting':_0x287a3c(0x238),'expired':_0x287a3c(0x210),'failed':_0x287a3c(0x1d9)},'autoExpiryNote':_0x287a3c(0x1bf)+_0x5c8f06[_0x287a3c(0x219)]+_0x287a3c(0x1d4),'individualTimersNote':_0x287a3c(0x20b)}});}catch(_0x270534){_0x5a58bc[_0x287a3c(0x23c)](0x1f4)[_0x287a3c(0x208)]({'success':![],'message':_0x287a3c(0x221)});}}),router[a19_0x44b329(0x1eb)](a19_0x44b329(0x1e1),async(_0x11502b,_0x97646)=>{const _0x1c7810=a19_0x44b329;try{const {paymentId:_0x3bd9bb}=_0x11502b['params'],_0x8f6015=coinToPayStatusService_1[_0x1c7810(0x1d5)]['getPaymentTimerInfo'](_0x3bd9bb),_0xe201b9=(await Promise[_0x1c7810(0x233)]()[_0x1c7810(0x1fa)](()=>__importStar(require(_0x1c7810(0x1c8)))))[_0x1c7810(0x1ce)],_0x23e7c5=await _0xe201b9[_0x1c7810(0x231)][_0x1c7810(0x236)]({'where':{'id':_0x3bd9bb},'select':{'id':!![],'gateway':!![],'gatewayPaymentId':!![],'status':!![],'amount':!![],'currency':!![],'createdAt':!![],'updatedAt':!![],'shopId':!![],'shop':{'select':{'name':!![],'username':!![]}}}});if(!_0x23e7c5)return _0x97646[_0x1c7810(0x23c)](0x194)[_0x1c7810(0x208)]({'success':![],'message':_0x1c7810(0x22b)});_0x97646[_0x1c7810(0x208)]({'success':!![],'result':{'payment':{'id':_0x23e7c5['id'],'gateway':_0x23e7c5['gateway'],'gatewayPaymentId':_0x23e7c5['gatewayPaymentId'],'status':_0x23e7c5[_0x1c7810(0x23c)],'amount':_0x23e7c5[_0x1c7810(0x1c6)],'currency':_0x23e7c5[_0x1c7810(0x23d)],'createdAt':_0x23e7c5[_0x1c7810(0x1ec)],'updatedAt':_0x23e7c5['updatedAt'],'shop':_0x23e7c5['shop']},'timers':_0x8f6015,'isCoinToPay':_0x23e7c5[_0x1c7810(0x1f9)]===_0x1c7810(0x1d3),'ageInMinutes':Math[_0x1c7810(0x1ca)]((Date['now']()-_0x23e7c5['createdAt']['getTime']())/(0x3e8*0x3c))}});}catch(_0x307e80){_0x97646[_0x1c7810(0x23c)](0x1f4)['json']({'success':![],'message':_0x307e80 instanceof Error?_0x307e80['message']:_0x1c7810(0x1d8)});}}),router[a19_0x44b329(0x227)](a19_0x44b329(0x1f6),async(_0x3f5cb4,_0x41d482)=>{const _0x4fcb76=a19_0x44b329;try{const {paymentId:_0x36088c}=_0x3f5cb4['params'];console[_0x4fcb76(0x224)](_0x4fcb76(0x1f7)+_0x36088c),await rapydStatusService_1[_0x4fcb76(0x1ed)][_0x4fcb76(0x1ff)](_0x36088c),_0x41d482[_0x4fcb76(0x208)]({'success':!![],'message':'Rapyd\x20payment\x20status\x20checked\x20successfully'});}catch(_0x16cf30){console[_0x4fcb76(0x1e2)]('‚ùå\x20[ADMIN]\x20Manual\x20Rapyd\x20check\x20failed\x20for\x20payment\x20'+_0x3f5cb4['params']['paymentId']+':',_0x16cf30),_0x41d482[_0x4fcb76(0x23c)](0x1f4)[_0x4fcb76(0x208)]({'success':![],'message':_0x16cf30 instanceof Error?_0x16cf30[_0x4fcb76(0x1ef)]:'Failed\x20to\x20check\x20Rapyd\x20payment\x20status'});}}),router[a19_0x44b329(0x1eb)]('/rapyd/stats',(_0x3740da,_0x3b5835)=>{const _0x2fef7a=a19_0x44b329;try{const _0x2b0100=rapydStatusService_1[_0x2fef7a(0x1ed)][_0x2fef7a(0x1b7)]();_0x3b5835[_0x2fef7a(0x208)]({'success':!![],'result':{..._0x2b0100,'description':_0x2fef7a(0x201),'statusMapping':{'paid:\x20true':_0x2fef7a(0x20a),'paid:\x20false\x20+\x20CAN':'FAILED','paid:\x20false\x20+\x20ERR':_0x2fef7a(0x1d9),'paid:\x20false\x20+\x20EXP':_0x2fef7a(0x210),'paid:\x20false\x20+\x20other':_0x2fef7a(0x238)},'checkSchedule':'Payments\x20are\x20checked\x20after\x2030\x20minutes\x20and\x2060\x20minutes,\x20then\x20forgotten','note':_0x2fef7a(0x22c)}});}catch(_0x52ce0e){_0x3b5835['status'](0x1f4)[_0x2fef7a(0x208)]({'success':![],'message':_0x2fef7a(0x1be)});}}),router[a19_0x44b329(0x1eb)]('/rapyd/payment/:paymentId',async(_0x5560fd,_0x1cea98)=>{const _0x1cdc39=a19_0x44b329;try{const {paymentId:_0x776e1e}=_0x5560fd[_0x1cdc39(0x200)],_0x2f054d=await database_1['default'][_0x1cdc39(0x231)][_0x1cdc39(0x236)]({'where':{'id':_0x776e1e},'include':{'shop':{'select':{'id':!![],'name':!![],'username':!![]}}}});if(!_0x2f054d)return _0x1cea98[_0x1cdc39(0x23c)](0x194)[_0x1cdc39(0x208)]({'success':![],'message':_0x1cdc39(0x22b)});const _0x5df018=rapydStatusService_1['rapydStatusService'][_0x1cdc39(0x225)](_0x776e1e);_0x1cea98[_0x1cdc39(0x208)]({'success':!![],'result':{'payment':{'id':_0x2f054d['id'],'gateway':_0x2f054d['gateway'],'gatewayPaymentId':_0x2f054d[_0x1cdc39(0x22d)],'status':_0x2f054d[_0x1cdc39(0x23c)],'amount':_0x2f054d['amount'],'currency':_0x2f054d['currency'],'createdAt':_0x2f054d['createdAt'],'updatedAt':_0x2f054d[_0x1cdc39(0x216)],'shop':_0x2f054d[_0x1cdc39(0x204)]},'timers':_0x5df018,'isRapyd':_0x2f054d[_0x1cdc39(0x1f9)]===_0x1cdc39(0x1de),'ageInMinutes':Math[_0x1cdc39(0x1ca)]((Date[_0x1cdc39(0x243)]()-_0x2f054d[_0x1cdc39(0x1ec)][_0x1cdc39(0x217)]())/(0x3e8*0x3c)),'nextCheck':_0x5df018[_0x1cdc39(0x1ba)]?Math[_0x1cdc39(0x1ca)]((Date[_0x1cdc39(0x243)]()-_0x2f054d[_0x1cdc39(0x1ec)][_0x1cdc39(0x217)]())/(0x3e8*0x3c))<0x1e?0x1e-Math[_0x1cdc39(0x1ca)]((Date[_0x1cdc39(0x243)]()-_0x2f054d[_0x1cdc39(0x1ec)][_0x1cdc39(0x217)]())/(0x3e8*0x3c))+_0x1cdc39(0x1f1):Math[_0x1cdc39(0x1ca)]((Date['now']()-_0x2f054d['createdAt']['getTime']())/(0x3e8*0x3c))<0x3c?0x3c-Math[_0x1cdc39(0x1ca)]((Date['now']()-_0x2f054d[_0x1cdc39(0x1ec)][_0x1cdc39(0x217)]())/(0x3e8*0x3c))+'\x20minutes':_0x1cdc39(0x234):_0x1cdc39(0x23e)}});}catch(_0x4a4a01){_0x1cea98['status'](0x1f4)[_0x1cdc39(0x208)]({'success':![],'message':_0x4a4a01 instanceof Error?_0x4a4a01['message']:_0x1cdc39(0x1d8)});}}),router['get'](a19_0x44b329(0x21c),(_0x37fa28,_0x430d84)=>{const _0x2bb377=a19_0x44b329;try{const _0x2c32a7=domainMonitoringService_1['domainMonitoringService'][_0x2bb377(0x22a)]();_0x430d84[_0x2bb377(0x208)]({'success':!![],'result':{..._0x2c32a7,'description':_0x2bb377(0x1e5),'behavior':_0x2bb377(0x214),'encoding':_0x2bb377(0x20d)}});}catch(_0x4c0b4a){_0x430d84['status'](0x1f4)[_0x2bb377(0x208)]({'success':![],'message':_0x2bb377(0x207)});}}),router['post'](a19_0x44b329(0x1dc),async(_0x4e1427,_0x383f9d)=>{const _0x5abb7d=a19_0x44b329;try{const _0x53907c=await domainMonitoringService_1[_0x5abb7d(0x1f8)][_0x5abb7d(0x228)]();_0x383f9d[_0x5abb7d(0x208)]({'success':!![],'result':{'domainAvailable':_0x53907c,'message':_0x53907c?_0x5abb7d(0x211):_0x5abb7d(0x21a),'timestamp':new Date()[_0x5abb7d(0x202)]()}});}catch(_0x5e007e){_0x383f9d[_0x5abb7d(0x23c)](0x1f4)[_0x5abb7d(0x208)]({'success':![],'message':_0x5e007e instanceof Error?_0x5e007e[_0x5abb7d(0x1ef)]:'Failed\x20to\x20perform\x20manual\x20domain\x20check'});}}),exports[a19_0x44b329(0x1ce)]=router;