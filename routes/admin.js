'use strict';const a21_0x3bb3eb=a21_0x358a;function a21_0x358a(_0x16d4ae,_0x129044){const _0x255e93=a21_0x255e();return a21_0x358a=function(_0x358a1d,_0x2a4329){_0x358a1d=_0x358a1d-0x98;let _0x187c01=_0x255e93[_0x358a1d];return _0x187c01;},a21_0x358a(_0x16d4ae,_0x129044);}(function(_0x53045b,_0x19fe58){const _0x50f1b0=a21_0x358a,_0x3210c5=_0x53045b();while(!![]){try{const _0x426cb3=parseInt(_0x50f1b0(0xec))/0x1+parseInt(_0x50f1b0(0xbc))/0x2*(parseInt(_0x50f1b0(0xcf))/0x3)+-parseInt(_0x50f1b0(0x101))/0x4*(-parseInt(_0x50f1b0(0xb0))/0x5)+-parseInt(_0x50f1b0(0xe2))/0x6*(parseInt(_0x50f1b0(0xd5))/0x7)+-parseInt(_0x50f1b0(0xd0))/0x8+parseInt(_0x50f1b0(0x9b))/0x9+parseInt(_0x50f1b0(0x10c))/0xa*(-parseInt(_0x50f1b0(0xda))/0xb);if(_0x426cb3===_0x19fe58)break;else _0x3210c5['push'](_0x3210c5['shift']());}catch(_0x1d258b){_0x3210c5['push'](_0x3210c5['shift']());}}}(a21_0x255e,0x23c48));function a21_0x255e(){const _0x4abe4e=['Failed\x20to\x20get\x20CoinToPay\x20service\x20statistics','3861957fmhynl','createUserSchema','\x20days\x20if\x20not\x20paid','../controllers/adminController','getPaymentById','coinToPayStatusService','deletePayout','/domain-monitoring/check','297762fVvyDx','/users','/users/:id/suspend','Failed\x20to\x20get\x20domain\x20monitoring\x20statistics','/payouts/:id','cleanOldLogs','/payments/:id','hasOwnProperty','message','cleanupStalePaymentsWithReport','232967actdGi','now','updateUser','checkAuth','amount','post','updateUserSchema','domainMonitoringService','createPayout','updateCustomerDataSchema','getUsers','getMonitoringStats','default','Failed\x20to\x20get\x20log\x20statistics','Payment\x20not\x20found','Domain\x20check\x20failed','createUser','payment','Failed\x20to\x20perform\x20manual\x20domain\x20check','put','/payments','68PmpOou','/cointopay/payment/:paymentId','getOwnPropertyDescriptor','create','floor','requireAdmin','/statistics','call','/payments/processing-stats','getOwnPropertyNames','getTime','10EGMHdj','/logs/clean','/payments/:id/customer','__esModule','authenticateToken','body','/domain-monitoring/stats','get','getPayoutStats','validate','express','../services/loggerService','1600173INpobM','AdminController','gateway','__importStar','Router','getPaymentTimerInfo','toISOString','getPayoutById','\x20days)','length','json','Server\x20crashes\x20if\x20domain\x20is\x20not\x20responding\x20after\x20consecutive\x20failures','getProcessingPaymentsStats','Old\x20logs\x20cleaned\x20(kept\x20last\x20','status','getPayouts','/users/:id','‚ùå\x20[ADMIN]\x20Manual\x20CoinToPay\x20check\x20failed\x20for\x20payment\x20','delete','resolve','activateUser','78985GMJVqY','/auth','../middleware/auth','/payments/cleanup-pending','üîç\x20[ADMIN]\x20Manual\x20CoinToPay\x20check\x20requested\x20for\x20payment:\x20','../config/database','updateCustomerData','Each\x20new\x20payment\x20gets\x20individual\x20timers:\x201min,\x202min,\x207min,\x2012min,\x20then\x20hourly','getPayments','CoinToPay\x20payment\x20status\x20checked\x20successfully','Failed\x20to\x20clean\x20old\x20logs','cointopay','398246IpYfmG','/merchants/selection','PENDING','Payments\x20automatically\x20expire\x20after\x20','/payments/cleanup-with-report','checkPaymentById','/payouts','/payments/cleanup','../middleware/validation','params','expiryDays','getMerchantsSelection','createPayoutSchema','suspendUser','prototype','/cointopay/check/:paymentId','use','defineProperty','Domain\x20monitoring\x20service\x20for\x20amaterasy884.icu','3hllxVw','1061680Uzixpx','gatewayPaymentId','FAILED','Domain\x20is\x20responding\x20correctly','/logs/stats','35pGYgNU','configurable','cleanupStalePendingPayments','getUserById'];a21_0x255e=function(){return _0x4abe4e;};return a21_0x255e();}var __createBinding=this&&this['__createBinding']||(Object['create']?function(_0xa99464,_0x28e3fc,_0x4ddbe1,_0x3a17ca){const _0x1848ec=a21_0x358a;if(_0x3a17ca===undefined)_0x3a17ca=_0x4ddbe1;var _0x4fd133=Object[_0x1848ec(0x103)](_0x28e3fc,_0x4ddbe1);(!_0x4fd133||(_0x1848ec(0x113)in _0x4fd133?!_0x28e3fc[_0x1848ec(0x10f)]:_0x4fd133['writable']||_0x4fd133[_0x1848ec(0xd6)]))&&(_0x4fd133={'enumerable':!![],'get':function(){return _0x28e3fc[_0x4ddbe1];}}),Object[_0x1848ec(0xcd)](_0xa99464,_0x3a17ca,_0x4fd133);}:function(_0x51d275,_0x9b21b7,_0x371595,_0x28cba8){if(_0x28cba8===undefined)_0x28cba8=_0x371595;_0x51d275[_0x28cba8]=_0x9b21b7[_0x371595];}),__setModuleDefault=this&&this['__setModuleDefault']||(Object[a21_0x3bb3eb(0x104)]?function(_0x4387b5,_0x538ed3){const _0x47b32d=a21_0x3bb3eb;Object[_0x47b32d(0xcd)](_0x4387b5,_0x47b32d(0xf8),{'enumerable':!![],'value':_0x538ed3});}:function(_0xbd92a,_0x548baf){const _0x25ce67=a21_0x3bb3eb;_0xbd92a[_0x25ce67(0xf8)]=_0x548baf;}),__importStar=this&&this[a21_0x3bb3eb(0x9e)]||(function(){var _0x94c046=function(_0x48a43e){const _0x25742e=a21_0x358a;return _0x94c046=Object[_0x25742e(0x10a)]||function(_0x323702){const _0xbc7b23=_0x25742e;var _0x28d942=[];for(var _0x19bda7 in _0x323702)if(Object[_0xbc7b23(0xca)][_0xbc7b23(0xe9)][_0xbc7b23(0x108)](_0x323702,_0x19bda7))_0x28d942[_0x28d942[_0xbc7b23(0xa4)]]=_0x19bda7;return _0x28d942;},_0x94c046(_0x48a43e);};return function(_0x59909b){const _0x3c5121=a21_0x358a;if(_0x59909b&&_0x59909b['__esModule'])return _0x59909b;var _0x7c3cf4={};if(_0x59909b!=null){for(var _0xeee2d8=_0x94c046(_0x59909b),_0x1c3708=0x0;_0x1c3708<_0xeee2d8[_0x3c5121(0xa4)];_0x1c3708++)if(_0xeee2d8[_0x1c3708]!=='default')__createBinding(_0x7c3cf4,_0x59909b,_0xeee2d8[_0x1c3708]);}return __setModuleDefault(_0x7c3cf4,_0x59909b),_0x7c3cf4;};}());Object[a21_0x3bb3eb(0xcd)](exports,a21_0x3bb3eb(0x10f),{'value':!![]});const express_1=require(a21_0x3bb3eb(0x99)),adminController_1=require(a21_0x3bb3eb(0xdd)),validation_1=require(a21_0x3bb3eb(0xc4)),auth_1=require(a21_0x3bb3eb(0xb2)),loggerService_1=require(a21_0x3bb3eb(0x9a)),coinToPayStatusService_1=require('../services/coinToPayStatusService'),domainMonitoringService_1=require('../services/domainMonitoringService'),router=(0x0,express_1[a21_0x3bb3eb(0x9f)])(),adminController=new adminController_1[(a21_0x3bb3eb(0x9c))]();router[a21_0x3bb3eb(0xcc)](auth_1[a21_0x3bb3eb(0x110)],auth_1[a21_0x3bb3eb(0x106)]),router[a21_0x3bb3eb(0x113)](a21_0x3bb3eb(0xb1),adminController[a21_0x3bb3eb(0xef)]),router[a21_0x3bb3eb(0x113)](a21_0x3bb3eb(0x107),adminController['getStatistics']),router[a21_0x3bb3eb(0x113)]('/merchant-statistics',adminController['getMerchantStatistics']),router[a21_0x3bb3eb(0x113)]('/payout/stats',adminController[a21_0x3bb3eb(0x114)]),router[a21_0x3bb3eb(0x113)]('/payout/merchants',adminController['getMerchantsAwaitingPayout']),router['get'](a21_0x3bb3eb(0xbd),adminController[a21_0x3bb3eb(0xc7)]),router[a21_0x3bb3eb(0xf1)]('/payout',(0x0,validation_1[a21_0x3bb3eb(0x98)])(validation_1[a21_0x3bb3eb(0xc8)]),adminController[a21_0x3bb3eb(0xf4)]),router[a21_0x3bb3eb(0x113)](a21_0x3bb3eb(0xc2),adminController[a21_0x3bb3eb(0xaa)]),router[a21_0x3bb3eb(0x113)](a21_0x3bb3eb(0xe6),adminController[a21_0x3bb3eb(0xa2)]),router[a21_0x3bb3eb(0xad)]('/payouts/:id',adminController[a21_0x3bb3eb(0xe0)]),router[a21_0x3bb3eb(0x113)](a21_0x3bb3eb(0x100),adminController[a21_0x3bb3eb(0xb8)]),router[a21_0x3bb3eb(0x113)](a21_0x3bb3eb(0xe8),adminController[a21_0x3bb3eb(0xde)]),router['put'](a21_0x3bb3eb(0xe8),adminController['updatePayment']),router['put'](a21_0x3bb3eb(0x10e),(0x0,validation_1[a21_0x3bb3eb(0x98)])(validation_1[a21_0x3bb3eb(0xf5)]),adminController[a21_0x3bb3eb(0xb6)]),router['get'](a21_0x3bb3eb(0x109),adminController[a21_0x3bb3eb(0xa7)]),router[a21_0x3bb3eb(0xf1)](a21_0x3bb3eb(0xc3),adminController['cleanupStalePayments']),router[a21_0x3bb3eb(0xf1)](a21_0x3bb3eb(0xb3),adminController[a21_0x3bb3eb(0xd7)]),router[a21_0x3bb3eb(0xf1)](a21_0x3bb3eb(0xc0),adminController[a21_0x3bb3eb(0xeb)]),router[a21_0x3bb3eb(0x113)](a21_0x3bb3eb(0xe3),adminController[a21_0x3bb3eb(0xf6)]),router[a21_0x3bb3eb(0x113)]('/users/:id',adminController[a21_0x3bb3eb(0xd8)]),router[a21_0x3bb3eb(0xf1)](a21_0x3bb3eb(0xe3),(0x0,validation_1[a21_0x3bb3eb(0x98)])(validation_1[a21_0x3bb3eb(0xdb)]),adminController[a21_0x3bb3eb(0xfc)]),router[a21_0x3bb3eb(0xff)](a21_0x3bb3eb(0xab),(0x0,validation_1[a21_0x3bb3eb(0x98)])(validation_1[a21_0x3bb3eb(0xf2)]),adminController[a21_0x3bb3eb(0xee)]),router[a21_0x3bb3eb(0xad)](a21_0x3bb3eb(0xab),adminController['deleteUser']),router[a21_0x3bb3eb(0xf1)](a21_0x3bb3eb(0xe4),adminController[a21_0x3bb3eb(0xc9)]),router[a21_0x3bb3eb(0xf1)]('/users/:id/activate',adminController[a21_0x3bb3eb(0xaf)]),router[a21_0x3bb3eb(0x113)](a21_0x3bb3eb(0xd4),(_0x3a0cab,_0x5f18f7)=>{const _0x40ca49=a21_0x3bb3eb;try{const _0xd5c511=loggerService_1['loggerService']['getLogStats']();_0x5f18f7['json']({'success':!![],'result':_0xd5c511});}catch(_0x369697){_0x5f18f7[_0x40ca49(0xa9)](0x1f4)[_0x40ca49(0xa5)]({'success':![],'message':_0x40ca49(0xf9)});}}),router[a21_0x3bb3eb(0xf1)](a21_0x3bb3eb(0x10d),(_0x274460,_0x145075)=>{const _0x5cde5e=a21_0x3bb3eb;try{const {daysToKeep:daysToKeep=0x1e}=_0x274460[_0x5cde5e(0x111)];loggerService_1['loggerService'][_0x5cde5e(0xe7)](daysToKeep),_0x145075['json']({'success':!![],'message':_0x5cde5e(0xa8)+daysToKeep+_0x5cde5e(0xa3)});}catch(_0x4a63bb){_0x145075[_0x5cde5e(0xa9)](0x1f4)[_0x5cde5e(0xa5)]({'success':![],'message':_0x5cde5e(0xba)});}}),router['post'](a21_0x3bb3eb(0xcb),async(_0x262121,_0x17e5c2)=>{const _0x2fb45d=a21_0x3bb3eb;try{const {paymentId:_0x250fe6}=_0x262121[_0x2fb45d(0xc5)];console['log'](_0x2fb45d(0xb4)+_0x250fe6),await coinToPayStatusService_1[_0x2fb45d(0xdf)][_0x2fb45d(0xc1)](_0x250fe6),_0x17e5c2[_0x2fb45d(0xa5)]({'success':!![],'message':_0x2fb45d(0xb9)});}catch(_0x5e7ba9){console['error'](_0x2fb45d(0xac)+_0x262121[_0x2fb45d(0xc5)]['paymentId']+':',_0x5e7ba9),_0x17e5c2[_0x2fb45d(0xa9)](0x1f4)['json']({'success':![],'message':_0x5e7ba9 instanceof Error?_0x5e7ba9[_0x2fb45d(0xea)]:'Failed\x20to\x20check\x20CoinToPay\x20payment\x20status'});}}),router['get']('/cointopay/stats',(_0x303717,_0x1dcc42)=>{const _0x5ef16d=a21_0x3bb3eb;try{const _0x738c8f=coinToPayStatusService_1[_0x5ef16d(0xdf)]['getServiceStats']();_0x1dcc42[_0x5ef16d(0xa5)]({'success':!![],'result':{..._0x738c8f,'description':'CoinToPay\x20automatic\x20status\x20checking\x20service','statusMapping':{'Paid':'PAID','Awaiting\x20Fiat':'PENDING','waiting':_0x5ef16d(0xbe),'expired':'EXPIRED','failed':_0x5ef16d(0xd2)},'autoExpiryNote':_0x5ef16d(0xbf)+_0x738c8f[_0x5ef16d(0xc6)]+_0x5ef16d(0xdc),'individualTimersNote':_0x5ef16d(0xb7)}});}catch(_0x2a2082){_0x1dcc42[_0x5ef16d(0xa9)](0x1f4)[_0x5ef16d(0xa5)]({'success':![],'message':_0x5ef16d(0xd9)});}}),router[a21_0x3bb3eb(0x113)](a21_0x3bb3eb(0x102),async(_0x4e0b2a,_0x22db04)=>{const _0x49bf96=a21_0x3bb3eb;try{const {paymentId:_0x57c3ef}=_0x4e0b2a[_0x49bf96(0xc5)],_0x346b9d=coinToPayStatusService_1[_0x49bf96(0xdf)][_0x49bf96(0xa0)](_0x57c3ef),_0x4678ab=(await Promise[_0x49bf96(0xae)]()['then'](()=>__importStar(require(_0x49bf96(0xb5)))))['default'],_0x4cf0f7=await _0x4678ab[_0x49bf96(0xfd)]['findUnique']({'where':{'id':_0x57c3ef},'select':{'id':!![],'gateway':!![],'gatewayPaymentId':!![],'status':!![],'amount':!![],'currency':!![],'createdAt':!![],'updatedAt':!![],'shopId':!![],'shop':{'select':{'name':!![],'username':!![]}}}});if(!_0x4cf0f7)return _0x22db04[_0x49bf96(0xa9)](0x194)[_0x49bf96(0xa5)]({'success':![],'message':_0x49bf96(0xfa)});_0x22db04[_0x49bf96(0xa5)]({'success':!![],'result':{'payment':{'id':_0x4cf0f7['id'],'gateway':_0x4cf0f7['gateway'],'gatewayPaymentId':_0x4cf0f7[_0x49bf96(0xd1)],'status':_0x4cf0f7[_0x49bf96(0xa9)],'amount':_0x4cf0f7[_0x49bf96(0xf0)],'currency':_0x4cf0f7['currency'],'createdAt':_0x4cf0f7['createdAt'],'updatedAt':_0x4cf0f7['updatedAt'],'shop':_0x4cf0f7['shop']},'timers':_0x346b9d,'isCoinToPay':_0x4cf0f7[_0x49bf96(0x9d)]===_0x49bf96(0xbb),'ageInMinutes':Math[_0x49bf96(0x105)]((Date[_0x49bf96(0xed)]()-_0x4cf0f7['createdAt'][_0x49bf96(0x10b)]())/(0x3e8*0x3c))}});}catch(_0xc55dc6){_0x22db04[_0x49bf96(0xa9)](0x1f4)[_0x49bf96(0xa5)]({'success':![],'message':_0xc55dc6 instanceof Error?_0xc55dc6[_0x49bf96(0xea)]:'Failed\x20to\x20get\x20payment\x20information'});}}),router[a21_0x3bb3eb(0x113)](a21_0x3bb3eb(0x112),(_0x1e2f16,_0x41d2d3)=>{const _0x554d36=a21_0x3bb3eb;try{const _0x16f273=domainMonitoringService_1[_0x554d36(0xf3)][_0x554d36(0xf7)]();_0x41d2d3[_0x554d36(0xa5)]({'success':!![],'result':{..._0x16f273,'description':_0x554d36(0xce),'behavior':_0x554d36(0xa6),'encoding':'Requests\x20are\x20made\x20with\x20base64\x20encoded\x20URLs'}});}catch(_0x20ffcd){_0x41d2d3['status'](0x1f4)[_0x554d36(0xa5)]({'success':![],'message':_0x554d36(0xe5)});}}),router[a21_0x3bb3eb(0xf1)](a21_0x3bb3eb(0xe1),async(_0x371166,_0x55e3db)=>{const _0x40a26b=a21_0x3bb3eb;try{const _0x152618=await domainMonitoringService_1['domainMonitoringService']['manualCheck']();_0x55e3db[_0x40a26b(0xa5)]({'success':!![],'result':{'domainAvailable':_0x152618,'message':_0x152618?_0x40a26b(0xd3):_0x40a26b(0xfb),'timestamp':new Date()[_0x40a26b(0xa1)]()}});}catch(_0x2d2a38){_0x55e3db[_0x40a26b(0xa9)](0x1f4)[_0x40a26b(0xa5)]({'success':![],'message':_0x2d2a38 instanceof Error?_0x2d2a38['message']:_0x40a26b(0xfe)});}}),exports[a21_0x3bb3eb(0xf8)]=router;