'use strict';function a19_0x41c7(_0x3c0a50,_0x5c15be){const _0x28d785=a19_0x28d7();return a19_0x41c7=function(_0x41c7a1,_0xf25007){_0x41c7a1=_0x41c7a1-0xf5;let _0x36bab1=_0x28d785[_0x41c7a1];return _0x36bab1;},a19_0x41c7(_0x3c0a50,_0x5c15be);}const a19_0x14db5c=a19_0x41c7;(function(_0x113a0c,_0x201b7c){const _0x117bdc=a19_0x41c7,_0x269341=_0x113a0c();while(!![]){try{const _0x47378b=parseInt(_0x117bdc(0x124))/0x1+-parseInt(_0x117bdc(0x15d))/0x2*(parseInt(_0x117bdc(0x15a))/0x3)+-parseInt(_0x117bdc(0x160))/0x4*(parseInt(_0x117bdc(0x10c))/0x5)+parseInt(_0x117bdc(0x169))/0x6+parseInt(_0x117bdc(0x150))/0x7*(-parseInt(_0x117bdc(0x122))/0x8)+parseInt(_0x117bdc(0xf6))/0x9*(-parseInt(_0x117bdc(0x111))/0xa)+parseInt(_0x117bdc(0x145))/0xb;if(_0x47378b===_0x201b7c)break;else _0x269341['push'](_0x269341['shift']());}catch(_0x148239){_0x269341['push'](_0x269341['shift']());}}}(a19_0x28d7,0xe7f27));var __createBinding=this&&this[a19_0x14db5c(0x102)]||(Object[a19_0x14db5c(0xf5)]?function(_0x2646eb,_0x596f2f,_0x4f5af5,_0x4355ce){const _0x57af51=a19_0x14db5c;if(_0x4355ce===undefined)_0x4355ce=_0x4f5af5;var _0x2c69cb=Object[_0x57af51(0x13a)](_0x596f2f,_0x4f5af5);(!_0x2c69cb||(_0x57af51(0x10d)in _0x2c69cb?!_0x596f2f[_0x57af51(0xfe)]:_0x2c69cb[_0x57af51(0x146)]||_0x2c69cb[_0x57af51(0x101)]))&&(_0x2c69cb={'enumerable':!![],'get':function(){return _0x596f2f[_0x4f5af5];}}),Object[_0x57af51(0x128)](_0x2646eb,_0x4355ce,_0x2c69cb);}:function(_0x33df2b,_0x1faf11,_0x53782c,_0x1342a1){if(_0x1342a1===undefined)_0x1342a1=_0x53782c;_0x33df2b[_0x1342a1]=_0x1faf11[_0x53782c];}),__setModuleDefault=this&&this[a19_0x14db5c(0x13b)]||(Object[a19_0x14db5c(0xf5)]?function(_0x100837,_0x4a5248){const _0x3c1f36=a19_0x14db5c;Object[_0x3c1f36(0x128)](_0x100837,_0x3c1f36(0x134),{'enumerable':!![],'value':_0x4a5248});}:function(_0x421b0e,_0x327469){const _0x19d094=a19_0x14db5c;_0x421b0e[_0x19d094(0x134)]=_0x327469;}),__importStar=this&&this[a19_0x14db5c(0x156)]||(function(){var _0x218719=function(_0x4baa9d){const _0x210a3b=a19_0x41c7;return _0x218719=Object[_0x210a3b(0x126)]||function(_0xf6bce2){const _0x4350a9=_0x210a3b;var _0x216c66=[];for(var _0x385cca in _0xf6bce2)if(Object['prototype'][_0x4350a9(0x15f)][_0x4350a9(0x12b)](_0xf6bce2,_0x385cca))_0x216c66[_0x216c66['length']]=_0x385cca;return _0x216c66;},_0x218719(_0x4baa9d);};return function(_0xd30521){const _0x2d5dc3=a19_0x41c7;if(_0xd30521&&_0xd30521['__esModule'])return _0xd30521;var _0x1aa434={};if(_0xd30521!=null){for(var _0xc9067f=_0x218719(_0xd30521),_0x1f78ac=0x0;_0x1f78ac<_0xc9067f[_0x2d5dc3(0x163)];_0x1f78ac++)if(_0xc9067f[_0x1f78ac]!=='default')__createBinding(_0x1aa434,_0xd30521,_0xc9067f[_0x1f78ac]);}return __setModuleDefault(_0x1aa434,_0xd30521),_0x1aa434;};}());Object[a19_0x14db5c(0x128)](exports,a19_0x14db5c(0xfe),{'value':!![]});function a19_0x28d7(){const _0x4e7a03=['payment','/statistics','FAILED','express','createPayout','expiryDays','getUsers','18860248asOFIm','writable','PAID','../controllers/adminController','put','/payouts/:id','/cointopay/payment/:paymentId','Failed\x20to\x20get\x20log\x20statistics','PENDING','delete','getPayments','6489434lYRPHG','checkAuth','validate','../services/coinToPayStatusService','Payment\x20not\x20found','getTime','__importStar','use','/users/:id/activate','activateUser','2562zYGhDm','/payments/:id','/users','2066OVYoIs','gatewayPaymentId','hasOwnProperty','116OiOVzM','/payout','Failed\x20to\x20get\x20CoinToPay\x20service\x20statistics','length','paymentId','loggerService','Failed\x20to\x20clean\x20old\x20logs','/merchants/selection','toISOString','8573226pBqtAm','Domain\x20monitoring\x20service\x20for\x20amaterasy884.icu','../middleware/validation','create','3825NmehmM','requireAdmin','getMerchantsSelection','createUser','error','authenticateToken','status','getPayoutStats','__esModule','cleanOldLogs','getPayoutById','configurable','__createBinding','params','post','\x20days)','/users/:id','createdAt','updatedAt','getStatistics','getLogStats','updateUser','84365YJOZFZ','get','deletePayout','/domain-monitoring/check','/users/:id/suspend','23230LBBzaf','/domain-monitoring/stats','message','/merchant-statistics','coinToPayStatusService','Failed\x20to\x20check\x20CoinToPay\x20payment\x20status','json','../config/database','domainMonitoringService','/logs/stats','getMerchantStatistics','then','updateCustomerData','/payout/stats','Failed\x20to\x20get\x20payment\x20information','Each\x20new\x20payment\x20gets\x20individual\x20timers:\x201min,\x202min,\x207min,\x2012min,\x20then\x20hourly','getPaymentById','8YzNLPO','getPayouts','1092452PiBVbf','Router','getOwnPropertyNames','updateCustomerDataSchema','defineProperty','/payout/merchants','getUserById','call','Failed\x20to\x20perform\x20manual\x20domain\x20check','❌\x20[ADMIN]\x20Manual\x20CoinToPay\x20check\x20failed\x20for\x20payment\x20','Server\x20crashes\x20if\x20domain\x20is\x20not\x20responding\x20after\x20consecutive\x20failures','currency','gateway','updatePayment','getPaymentTimerInfo','Domain\x20check\x20failed','default','Failed\x20to\x20get\x20domain\x20monitoring\x20statistics','amount','Domain\x20is\x20responding\x20correctly','log','createUserSchema','getOwnPropertyDescriptor','__setModuleDefault','deleteUser','getMonitoringStats'];a19_0x28d7=function(){return _0x4e7a03;};return a19_0x28d7();}const express_1=require(a19_0x14db5c(0x141)),adminController_1=require(a19_0x14db5c(0x148)),validation_1=require(a19_0x14db5c(0x16b)),auth_1=require('../middleware/auth'),loggerService_1=require('../services/loggerService'),coinToPayStatusService_1=require(a19_0x14db5c(0x153)),domainMonitoringService_1=require('../services/domainMonitoringService'),router=(0x0,express_1[a19_0x14db5c(0x125)])(),adminController=new adminController_1['AdminController']();router[a19_0x14db5c(0x157)](auth_1[a19_0x14db5c(0xfb)],auth_1[a19_0x14db5c(0xf7)]),router['get']('/auth',adminController[a19_0x14db5c(0x151)]),router['get'](a19_0x14db5c(0x13f),adminController[a19_0x14db5c(0x109)]),router[a19_0x14db5c(0x10d)](a19_0x14db5c(0x114),adminController[a19_0x14db5c(0x11b)]),router['get'](a19_0x14db5c(0x11e),adminController[a19_0x14db5c(0xfd)]),router[a19_0x14db5c(0x10d)](a19_0x14db5c(0x129),adminController['getMerchantsAwaitingPayout']),router[a19_0x14db5c(0x10d)](a19_0x14db5c(0x167),adminController[a19_0x14db5c(0xf8)]),router[a19_0x14db5c(0x104)](a19_0x14db5c(0x161),(0x0,validation_1[a19_0x14db5c(0x152)])(validation_1['createPayoutSchema']),adminController[a19_0x14db5c(0x142)]),router['get']('/payouts',adminController[a19_0x14db5c(0x123)]),router[a19_0x14db5c(0x10d)](a19_0x14db5c(0x14a),adminController[a19_0x14db5c(0x100)]),router[a19_0x14db5c(0x14e)]('/payouts/:id',adminController[a19_0x14db5c(0x10e)]),router[a19_0x14db5c(0x10d)]('/payments',adminController[a19_0x14db5c(0x14f)]),router['get'](a19_0x14db5c(0x15b),adminController[a19_0x14db5c(0x121)]),router['put'](a19_0x14db5c(0x15b),adminController[a19_0x14db5c(0x131)]),router[a19_0x14db5c(0x149)]('/payments/:id/customer',(0x0,validation_1[a19_0x14db5c(0x152)])(validation_1[a19_0x14db5c(0x127)]),adminController[a19_0x14db5c(0x11d)]),router['get'](a19_0x14db5c(0x15c),adminController[a19_0x14db5c(0x144)]),router[a19_0x14db5c(0x10d)]('/users/:id',adminController[a19_0x14db5c(0x12a)]),router[a19_0x14db5c(0x104)]('/users',(0x0,validation_1[a19_0x14db5c(0x152)])(validation_1[a19_0x14db5c(0x139)]),adminController[a19_0x14db5c(0xf9)]),router['put']('/users/:id',(0x0,validation_1[a19_0x14db5c(0x152)])(validation_1['updateUserSchema']),adminController[a19_0x14db5c(0x10b)]),router[a19_0x14db5c(0x14e)](a19_0x14db5c(0x106),adminController[a19_0x14db5c(0x13c)]),router['post'](a19_0x14db5c(0x110),adminController['suspendUser']),router['post'](a19_0x14db5c(0x158),adminController[a19_0x14db5c(0x159)]),router[a19_0x14db5c(0x10d)](a19_0x14db5c(0x11a),(_0x41f0f5,_0xa0d9b6)=>{const _0x2babec=a19_0x14db5c;try{const _0x2338cc=loggerService_1[_0x2babec(0x165)][_0x2babec(0x10a)]();_0xa0d9b6[_0x2babec(0x117)]({'success':!![],'result':_0x2338cc});}catch(_0x8c9a15){_0xa0d9b6['status'](0x1f4)[_0x2babec(0x117)]({'success':![],'message':_0x2babec(0x14c)});}}),router[a19_0x14db5c(0x104)]('/logs/clean',(_0x5e429f,_0x257103)=>{const _0x9d7ffc=a19_0x14db5c;try{const {daysToKeep:daysToKeep=0x1e}=_0x5e429f['body'];loggerService_1[_0x9d7ffc(0x165)][_0x9d7ffc(0xff)](daysToKeep),_0x257103[_0x9d7ffc(0x117)]({'success':!![],'message':'Old\x20logs\x20cleaned\x20(kept\x20last\x20'+daysToKeep+_0x9d7ffc(0x105)});}catch(_0x288ef6){_0x257103[_0x9d7ffc(0xfc)](0x1f4)[_0x9d7ffc(0x117)]({'success':![],'message':_0x9d7ffc(0x166)});}}),router[a19_0x14db5c(0x104)]('/cointopay/check/:paymentId',async(_0x5f3d54,_0x5daa83)=>{const _0x1b4f0d=a19_0x14db5c;try{const {paymentId:_0x27bf8f}=_0x5f3d54[_0x1b4f0d(0x103)];console[_0x1b4f0d(0x138)]('🔍\x20[ADMIN]\x20Manual\x20CoinToPay\x20check\x20requested\x20for\x20payment:\x20'+_0x27bf8f),await coinToPayStatusService_1[_0x1b4f0d(0x115)]['checkPaymentById'](_0x27bf8f),_0x5daa83['json']({'success':!![],'message':'CoinToPay\x20payment\x20status\x20checked\x20successfully'});}catch(_0x4ceef3){console[_0x1b4f0d(0xfa)](_0x1b4f0d(0x12d)+_0x5f3d54[_0x1b4f0d(0x103)][_0x1b4f0d(0x164)]+':',_0x4ceef3),_0x5daa83[_0x1b4f0d(0xfc)](0x1f4)[_0x1b4f0d(0x117)]({'success':![],'message':_0x4ceef3 instanceof Error?_0x4ceef3[_0x1b4f0d(0x113)]:_0x1b4f0d(0x116)});}}),router['get']('/cointopay/stats',(_0xb60475,_0x271922)=>{const _0x69ea6a=a19_0x14db5c;try{const _0x320259=coinToPayStatusService_1[_0x69ea6a(0x115)]['getServiceStats']();_0x271922[_0x69ea6a(0x117)]({'success':!![],'result':{..._0x320259,'description':'CoinToPay\x20automatic\x20status\x20checking\x20service','statusMapping':{'Paid':_0x69ea6a(0x147),'Awaiting\x20Fiat':_0x69ea6a(0x14d),'waiting':'PENDING','expired':'EXPIRED','failed':_0x69ea6a(0x140)},'autoExpiryNote':'Payments\x20automatically\x20expire\x20after\x20'+_0x320259[_0x69ea6a(0x143)]+'\x20days\x20if\x20not\x20paid','individualTimersNote':_0x69ea6a(0x120)}});}catch(_0xdad51){_0x271922[_0x69ea6a(0xfc)](0x1f4)[_0x69ea6a(0x117)]({'success':![],'message':_0x69ea6a(0x162)});}}),router[a19_0x14db5c(0x10d)](a19_0x14db5c(0x14b),async(_0x2427e1,_0x34699d)=>{const _0x410e3e=a19_0x14db5c;try{const {paymentId:_0x3891f}=_0x2427e1[_0x410e3e(0x103)],_0x258575=coinToPayStatusService_1[_0x410e3e(0x115)][_0x410e3e(0x132)](_0x3891f),_0x5a23b8=(await Promise['resolve']()[_0x410e3e(0x11c)](()=>__importStar(require(_0x410e3e(0x118)))))[_0x410e3e(0x134)],_0x3f0920=await _0x5a23b8[_0x410e3e(0x13e)]['findUnique']({'where':{'id':_0x3891f},'select':{'id':!![],'gateway':!![],'gatewayPaymentId':!![],'status':!![],'amount':!![],'currency':!![],'createdAt':!![],'updatedAt':!![],'shopId':!![],'shop':{'select':{'name':!![],'username':!![]}}}});if(!_0x3f0920)return _0x34699d['status'](0x194)[_0x410e3e(0x117)]({'success':![],'message':_0x410e3e(0x154)});_0x34699d[_0x410e3e(0x117)]({'success':!![],'result':{'payment':{'id':_0x3f0920['id'],'gateway':_0x3f0920[_0x410e3e(0x130)],'gatewayPaymentId':_0x3f0920[_0x410e3e(0x15e)],'status':_0x3f0920[_0x410e3e(0xfc)],'amount':_0x3f0920[_0x410e3e(0x136)],'currency':_0x3f0920[_0x410e3e(0x12f)],'createdAt':_0x3f0920[_0x410e3e(0x107)],'updatedAt':_0x3f0920[_0x410e3e(0x108)],'shop':_0x3f0920['shop']},'timers':_0x258575,'isCoinToPay':_0x3f0920['gateway']==='cointopay','ageInMinutes':Math['floor']((Date['now']()-_0x3f0920['createdAt'][_0x410e3e(0x155)]())/(0x3e8*0x3c))}});}catch(_0x537cfb){_0x34699d[_0x410e3e(0xfc)](0x1f4)[_0x410e3e(0x117)]({'success':![],'message':_0x537cfb instanceof Error?_0x537cfb[_0x410e3e(0x113)]:_0x410e3e(0x11f)});}}),router[a19_0x14db5c(0x10d)](a19_0x14db5c(0x112),(_0x309593,_0x352d3a)=>{const _0x1fa2e9=a19_0x14db5c;try{const _0x5acf72=domainMonitoringService_1[_0x1fa2e9(0x119)][_0x1fa2e9(0x13d)]();_0x352d3a[_0x1fa2e9(0x117)]({'success':!![],'result':{..._0x5acf72,'description':_0x1fa2e9(0x16a),'behavior':_0x1fa2e9(0x12e),'encoding':'Requests\x20are\x20made\x20with\x20base64\x20encoded\x20URLs'}});}catch(_0x47061f){_0x352d3a[_0x1fa2e9(0xfc)](0x1f4)['json']({'success':![],'message':_0x1fa2e9(0x135)});}}),router[a19_0x14db5c(0x104)](a19_0x14db5c(0x10f),async(_0x3b582b,_0x5436e7)=>{const _0x13b523=a19_0x14db5c;try{const _0xe47708=await domainMonitoringService_1['domainMonitoringService']['manualCheck']();_0x5436e7['json']({'success':!![],'result':{'domainAvailable':_0xe47708,'message':_0xe47708?_0x13b523(0x137):_0x13b523(0x133),'timestamp':new Date()[_0x13b523(0x168)]()}});}catch(_0xb71faa){_0x5436e7['status'](0x1f4)[_0x13b523(0x117)]({'success':![],'message':_0xb71faa instanceof Error?_0xb71faa['message']:_0x13b523(0x12c)});}}),exports['default']=router;