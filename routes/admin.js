'use strict';function a21_0x89de(_0x1269a5,_0x52ce69){const _0x2ee2e6=a21_0x2ee2();return a21_0x89de=function(_0x89de6a,_0x3c023d){_0x89de6a=_0x89de6a-0xe5;let _0x45cc0f=_0x2ee2e6[_0x89de6a];return _0x45cc0f;},a21_0x89de(_0x1269a5,_0x52ce69);}const a21_0x14c8bc=a21_0x89de;(function(_0x2e73f4,_0x3c05c6){const _0x47d790=a21_0x89de,_0x53ac02=_0x2e73f4();while(!![]){try{const _0x545eb0=-parseInt(_0x47d790(0x10b))/0x1+-parseInt(_0x47d790(0x126))/0x2+parseInt(_0x47d790(0x10e))/0x3*(parseInt(_0x47d790(0xec))/0x4)+-parseInt(_0x47d790(0x11f))/0x5*(parseInt(_0x47d790(0x14b))/0x6)+-parseInt(_0x47d790(0x150))/0x7+parseInt(_0x47d790(0x13d))/0x8*(-parseInt(_0x47d790(0xed))/0x9)+parseInt(_0x47d790(0x152))/0xa;if(_0x545eb0===_0x3c05c6)break;else _0x53ac02['push'](_0x53ac02['shift']());}catch(_0x2e2dc2){_0x53ac02['push'](_0x53ac02['shift']());}}}(a21_0x2ee2,0x5afe9));var __createBinding=this&&this[a21_0x14c8bc(0x105)]||(Object[a21_0x14c8bc(0xf6)]?function(_0x16d5f3,_0x3df6a8,_0x353252,_0x197c0e){const _0x276976=a21_0x14c8bc;if(_0x197c0e===undefined)_0x197c0e=_0x353252;var _0x16139=Object[_0x276976(0x121)](_0x3df6a8,_0x353252);(!_0x16139||(_0x276976(0x133)in _0x16139?!_0x3df6a8[_0x276976(0x12c)]:_0x16139[_0x276976(0x117)]||_0x16139[_0x276976(0x131)]))&&(_0x16139={'enumerable':!![],'get':function(){return _0x3df6a8[_0x353252];}}),Object[_0x276976(0x135)](_0x16d5f3,_0x197c0e,_0x16139);}:function(_0x1783c4,_0x5c3dfb,_0x1c5d1e,_0x57878f){if(_0x57878f===undefined)_0x57878f=_0x1c5d1e;_0x1783c4[_0x57878f]=_0x5c3dfb[_0x1c5d1e];}),__setModuleDefault=this&&this['__setModuleDefault']||(Object['create']?function(_0x46973d,_0x3535ad){const _0x39cd5c=a21_0x14c8bc;Object[_0x39cd5c(0x135)](_0x46973d,_0x39cd5c(0x10c),{'enumerable':!![],'value':_0x3535ad});}:function(_0x2f54ce,_0xd9303d){const _0x4090ab=a21_0x14c8bc;_0x2f54ce[_0x4090ab(0x10c)]=_0xd9303d;}),__importStar=this&&this[a21_0x14c8bc(0x149)]||(function(){var _0x178f8f=function(_0x1d4280){const _0x27efa9=a21_0x89de;return _0x178f8f=Object[_0x27efa9(0xe9)]||function(_0x4ecab3){const _0x5b7389=_0x27efa9;var _0x278649=[];for(var _0x4ea2d6 in _0x4ecab3)if(Object['prototype']['hasOwnProperty'][_0x5b7389(0x12b)](_0x4ecab3,_0x4ea2d6))_0x278649[_0x278649['length']]=_0x4ea2d6;return _0x278649;},_0x178f8f(_0x1d4280);};return function(_0x1ee0ce){const _0x5bfc03=a21_0x89de;if(_0x1ee0ce&&_0x1ee0ce['__esModule'])return _0x1ee0ce;var _0x5bb520={};if(_0x1ee0ce!=null){for(var _0x2f8603=_0x178f8f(_0x1ee0ce),_0x29a354=0x0;_0x29a354<_0x2f8603[_0x5bfc03(0x154)];_0x29a354++)if(_0x2f8603[_0x29a354]!=='default')__createBinding(_0x5bb520,_0x1ee0ce,_0x2f8603[_0x29a354]);}return __setModuleDefault(_0x5bb520,_0x1ee0ce),_0x5bb520;};}());function a21_0x2ee2(){const _0x23abea=['/payments/cleanup-pending','cleanupStalePaymentsWithReport','cleanOldLogs','express','loggerService','/statistics','updateUser','2126715HHmSGs','then','getOwnPropertyDescriptor','AdminController','toISOString','Domain\x20check\x20failed','❌\x20[ADMIN]\x20Manual\x20CoinToPay\x20check\x20failed\x20for\x20payment\x20','340304AdymQu','activateUser','PAID','../controllers/adminController','domainMonitoringService','call','__esModule','Failed\x20to\x20get\x20payment\x20information','coinToPayStatusService','/payout/stats','../middleware/validation','configurable','updateUserSchema','get','/users','defineProperty','delete','/users/:id/suspend','currency','deleteUser','params','/merchant-statistics','/payouts','102320dWejJT','/payments/cleanup','Failed\x20to\x20clean\x20old\x20logs','cleanupStalePendingPayments','/logs/clean','../config/database','put','now','getStatistics','CoinToPay\x20payment\x20status\x20checked\x20successfully','/cointopay/stats','../services/loggerService','__importStar','json','6GJeHyg','post','status','/payments/:id','body','304598HSYkXP','../services/domainMonitoringService','19300520gqMqiE','getLogStats','length','/domain-monitoring/check','/auth','message','authenticateToken','/payout','\x20days\x20if\x20not\x20paid','getPayments','cleanupStalePayments','Old\x20logs\x20cleaned\x20(kept\x20last\x20','/domain-monitoring/stats','updatePayment','CoinToPay\x20automatic\x20status\x20checking\x20service','payment','/payouts/:id','/payments/cleanup-with-report','Server\x20crashes\x20if\x20domain\x20is\x20not\x20responding\x20after\x20consecutive\x20failures','/cointopay/payment/:paymentId','createPayoutSchema','Payments\x20automatically\x20expire\x20after\x20','EXPIRED','\x20days)','manualCheck','getOwnPropertyNames','Failed\x20to\x20perform\x20manual\x20domain\x20check','getMerchantsSelection','16632QNxQwG','315uCEwVw','checkPaymentById','updateCustomerDataSchema','getServiceStats','suspendUser','getUsers','getPaymentById','createdAt','validate','create','FAILED','createUser','Each\x20new\x20payment\x20gets\x20individual\x20timers:\x201min,\x202min,\x207min,\x2012min,\x20then\x20hourly','Requests\x20are\x20made\x20with\x20base64\x20encoded\x20URLs','gateway','error','../middleware/auth','shop','Failed\x20to\x20get\x20log\x20statistics','Router','getPayouts','Domain\x20is\x20responding\x20correctly','findUnique','PENDING','__createBinding','/payout/merchants','/payments','Payment\x20not\x20found','../services/coinToPayStatusService','updateCustomerData','582946XZGlhk','default','/cointopay/check/:paymentId','81mqeBib','getPayoutById','cointopay','getUserById','Failed\x20to\x20get\x20CoinToPay\x20service\x20statistics','/users/:id/activate','getTime','resolve','getMerchantsAwaitingPayout','writable'];a21_0x2ee2=function(){return _0x23abea;};return a21_0x2ee2();}Object[a21_0x14c8bc(0x135)](exports,'__esModule',{'value':!![]});const express_1=require(a21_0x14c8bc(0x11b)),adminController_1=require(a21_0x14c8bc(0x129)),validation_1=require(a21_0x14c8bc(0x130)),auth_1=require(a21_0x14c8bc(0xfd)),loggerService_1=require(a21_0x14c8bc(0x148)),coinToPayStatusService_1=require(a21_0x14c8bc(0x109)),domainMonitoringService_1=require(a21_0x14c8bc(0x151)),router=(0x0,express_1[a21_0x14c8bc(0x100)])(),adminController=new adminController_1[(a21_0x14c8bc(0x122))]();router['use'](auth_1[a21_0x14c8bc(0x158)],auth_1['requireAdmin']),router[a21_0x14c8bc(0x133)](a21_0x14c8bc(0x156),adminController['checkAuth']),router[a21_0x14c8bc(0x133)](a21_0x14c8bc(0x11d),adminController[a21_0x14c8bc(0x145)]),router[a21_0x14c8bc(0x133)](a21_0x14c8bc(0x13b),adminController['getMerchantStatistics']),router[a21_0x14c8bc(0x133)](a21_0x14c8bc(0x12f),adminController['getPayoutStats']),router[a21_0x14c8bc(0x133)](a21_0x14c8bc(0x106),adminController[a21_0x14c8bc(0x116)]),router['get']('/merchants/selection',adminController[a21_0x14c8bc(0xeb)]),router['post'](a21_0x14c8bc(0x159),(0x0,validation_1[a21_0x14c8bc(0xf5)])(validation_1[a21_0x14c8bc(0x166)]),adminController['createPayout']),router[a21_0x14c8bc(0x133)](a21_0x14c8bc(0x13c),adminController[a21_0x14c8bc(0x101)]),router[a21_0x14c8bc(0x133)]('/payouts/:id',adminController[a21_0x14c8bc(0x10f)]),router[a21_0x14c8bc(0x136)](a21_0x14c8bc(0x162),adminController['deletePayout']),router[a21_0x14c8bc(0x133)](a21_0x14c8bc(0x107),adminController[a21_0x14c8bc(0x15b)]),router[a21_0x14c8bc(0x133)]('/payments/:id',adminController[a21_0x14c8bc(0xf3)]),router[a21_0x14c8bc(0x143)](a21_0x14c8bc(0x14e),adminController[a21_0x14c8bc(0x15f)]),router[a21_0x14c8bc(0x143)]('/payments/:id/customer',(0x0,validation_1[a21_0x14c8bc(0xf5)])(validation_1[a21_0x14c8bc(0xef)]),adminController[a21_0x14c8bc(0x10a)]),router['get']('/payments/processing-stats',adminController['getProcessingPaymentsStats']),router[a21_0x14c8bc(0x14c)](a21_0x14c8bc(0x13e),adminController[a21_0x14c8bc(0x15c)]),router[a21_0x14c8bc(0x14c)](a21_0x14c8bc(0x118),adminController[a21_0x14c8bc(0x140)]),router['post'](a21_0x14c8bc(0x163),adminController[a21_0x14c8bc(0x119)]),router['get'](a21_0x14c8bc(0x134),adminController[a21_0x14c8bc(0xf2)]),router[a21_0x14c8bc(0x133)]('/users/:id',adminController[a21_0x14c8bc(0x111)]),router[a21_0x14c8bc(0x14c)]('/users',(0x0,validation_1[a21_0x14c8bc(0xf5)])(validation_1['createUserSchema']),adminController[a21_0x14c8bc(0xf8)]),router[a21_0x14c8bc(0x143)]('/users/:id',(0x0,validation_1[a21_0x14c8bc(0xf5)])(validation_1[a21_0x14c8bc(0x132)]),adminController[a21_0x14c8bc(0x11e)]),router[a21_0x14c8bc(0x136)]('/users/:id',adminController[a21_0x14c8bc(0x139)]),router[a21_0x14c8bc(0x14c)](a21_0x14c8bc(0x137),adminController[a21_0x14c8bc(0xf1)]),router[a21_0x14c8bc(0x14c)](a21_0x14c8bc(0x113),adminController[a21_0x14c8bc(0x127)]),router[a21_0x14c8bc(0x133)]('/logs/stats',(_0x5d821e,_0x35cb33)=>{const _0x2f5966=a21_0x14c8bc;try{const _0x583770=loggerService_1[_0x2f5966(0x11c)][_0x2f5966(0x153)]();_0x35cb33[_0x2f5966(0x14a)]({'success':!![],'result':_0x583770});}catch(_0x5784af){_0x35cb33[_0x2f5966(0x14d)](0x1f4)[_0x2f5966(0x14a)]({'success':![],'message':_0x2f5966(0xff)});}}),router[a21_0x14c8bc(0x14c)](a21_0x14c8bc(0x141),(_0x467f5e,_0x26e368)=>{const _0x1f5b83=a21_0x14c8bc;try{const {daysToKeep:daysToKeep=0x1e}=_0x467f5e[_0x1f5b83(0x14f)];loggerService_1['loggerService'][_0x1f5b83(0x11a)](daysToKeep),_0x26e368['json']({'success':!![],'message':_0x1f5b83(0x15d)+daysToKeep+_0x1f5b83(0xe7)});}catch(_0x50acce){_0x26e368['status'](0x1f4)[_0x1f5b83(0x14a)]({'success':![],'message':_0x1f5b83(0x13f)});}}),router['post'](a21_0x14c8bc(0x10d),async(_0x5a46fb,_0x147cfc)=>{const _0x4a4376=a21_0x14c8bc;try{const {paymentId:_0x1bd266}=_0x5a46fb[_0x4a4376(0x13a)];console['log']('🔍\x20[ADMIN]\x20Manual\x20CoinToPay\x20check\x20requested\x20for\x20payment:\x20'+_0x1bd266),await coinToPayStatusService_1[_0x4a4376(0x12e)][_0x4a4376(0xee)](_0x1bd266),_0x147cfc['json']({'success':!![],'message':_0x4a4376(0x146)});}catch(_0x44ccee){console[_0x4a4376(0xfc)](_0x4a4376(0x125)+_0x5a46fb['params']['paymentId']+':',_0x44ccee),_0x147cfc[_0x4a4376(0x14d)](0x1f4)[_0x4a4376(0x14a)]({'success':![],'message':_0x44ccee instanceof Error?_0x44ccee[_0x4a4376(0x157)]:'Failed\x20to\x20check\x20CoinToPay\x20payment\x20status'});}}),router['get'](a21_0x14c8bc(0x147),(_0x616598,_0x742ff3)=>{const _0x25eb61=a21_0x14c8bc;try{const _0x3ea398=coinToPayStatusService_1[_0x25eb61(0x12e)][_0x25eb61(0xf0)]();_0x742ff3[_0x25eb61(0x14a)]({'success':!![],'result':{..._0x3ea398,'description':_0x25eb61(0x160),'statusMapping':{'Paid':_0x25eb61(0x128),'Awaiting\x20Fiat':_0x25eb61(0x104),'waiting':_0x25eb61(0x104),'expired':_0x25eb61(0xe6),'failed':_0x25eb61(0xf7)},'autoExpiryNote':_0x25eb61(0xe5)+_0x3ea398['expiryDays']+_0x25eb61(0x15a),'individualTimersNote':_0x25eb61(0xf9)}});}catch(_0x855b7f){_0x742ff3[_0x25eb61(0x14d)](0x1f4)[_0x25eb61(0x14a)]({'success':![],'message':_0x25eb61(0x112)});}}),router[a21_0x14c8bc(0x133)](a21_0x14c8bc(0x165),async(_0x2a616f,_0xd21853)=>{const _0xdc00f2=a21_0x14c8bc;try{const {paymentId:_0x293b0d}=_0x2a616f[_0xdc00f2(0x13a)],_0x651834=coinToPayStatusService_1[_0xdc00f2(0x12e)]['getPaymentTimerInfo'](_0x293b0d),_0x2a3a2e=(await Promise[_0xdc00f2(0x115)]()[_0xdc00f2(0x120)](()=>__importStar(require(_0xdc00f2(0x142)))))[_0xdc00f2(0x10c)],_0x40ab0a=await _0x2a3a2e[_0xdc00f2(0x161)][_0xdc00f2(0x103)]({'where':{'id':_0x293b0d},'select':{'id':!![],'gateway':!![],'gatewayPaymentId':!![],'status':!![],'amount':!![],'currency':!![],'createdAt':!![],'updatedAt':!![],'shopId':!![],'shop':{'select':{'name':!![],'username':!![]}}}});if(!_0x40ab0a)return _0xd21853[_0xdc00f2(0x14d)](0x194)[_0xdc00f2(0x14a)]({'success':![],'message':_0xdc00f2(0x108)});_0xd21853['json']({'success':!![],'result':{'payment':{'id':_0x40ab0a['id'],'gateway':_0x40ab0a[_0xdc00f2(0xfb)],'gatewayPaymentId':_0x40ab0a['gatewayPaymentId'],'status':_0x40ab0a[_0xdc00f2(0x14d)],'amount':_0x40ab0a['amount'],'currency':_0x40ab0a[_0xdc00f2(0x138)],'createdAt':_0x40ab0a[_0xdc00f2(0xf4)],'updatedAt':_0x40ab0a['updatedAt'],'shop':_0x40ab0a[_0xdc00f2(0xfe)]},'timers':_0x651834,'isCoinToPay':_0x40ab0a[_0xdc00f2(0xfb)]===_0xdc00f2(0x110),'ageInMinutes':Math['floor']((Date[_0xdc00f2(0x144)]()-_0x40ab0a[_0xdc00f2(0xf4)][_0xdc00f2(0x114)]())/(0x3e8*0x3c))}});}catch(_0x43492e){_0xd21853[_0xdc00f2(0x14d)](0x1f4)['json']({'success':![],'message':_0x43492e instanceof Error?_0x43492e[_0xdc00f2(0x157)]:_0xdc00f2(0x12d)});}}),router[a21_0x14c8bc(0x133)](a21_0x14c8bc(0x15e),(_0x579607,_0x284fec)=>{const _0x197048=a21_0x14c8bc;try{const _0x268b37=domainMonitoringService_1['domainMonitoringService']['getMonitoringStats']();_0x284fec['json']({'success':!![],'result':{..._0x268b37,'description':'Domain\x20monitoring\x20service\x20for\x20amaterasy884.icu','behavior':_0x197048(0x164),'encoding':_0x197048(0xfa)}});}catch(_0x435627){_0x284fec[_0x197048(0x14d)](0x1f4)[_0x197048(0x14a)]({'success':![],'message':'Failed\x20to\x20get\x20domain\x20monitoring\x20statistics'});}}),router[a21_0x14c8bc(0x14c)](a21_0x14c8bc(0x155),async(_0x5ccc88,_0x3f1448)=>{const _0x56ec84=a21_0x14c8bc;try{const _0x4ddd04=await domainMonitoringService_1[_0x56ec84(0x12a)][_0x56ec84(0xe8)]();_0x3f1448[_0x56ec84(0x14a)]({'success':!![],'result':{'domainAvailable':_0x4ddd04,'message':_0x4ddd04?_0x56ec84(0x102):_0x56ec84(0x124),'timestamp':new Date()[_0x56ec84(0x123)]()}});}catch(_0x32c6f5){_0x3f1448['status'](0x1f4)[_0x56ec84(0x14a)]({'success':![],'message':_0x32c6f5 instanceof Error?_0x32c6f5[_0x56ec84(0x157)]:_0x56ec84(0xea)});}}),exports[a21_0x14c8bc(0x10c)]=router;