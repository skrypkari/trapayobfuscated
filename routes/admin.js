'use strict';const a19_0x79b7c5=a19_0x3a33;function a19_0x2a6c(){const _0x28d77f=['gateway','paymentId','/payouts/:id','getPayments','getPaymentById','updateCustomerDataSchema','updatePayment','Domain\x20monitoring\x20service\x20for\x20amaterasy884.icu','params','\x20days)','Domain\x20check\x20failed','\x20days\x20if\x20not\x20paid','defineProperty','Server\x20crashes\x20if\x20domain\x20is\x20not\x20responding\x20after\x20consecutive\x20failures','createdAt','Router','../controllers/adminController','loggerService','PENDING','gatewayPaymentId','message','Failed\x20to\x20get\x20log\x20statistics','findUnique','getStatistics','getMerchantStatistics','Failed\x20to\x20clean\x20old\x20logs','/cointopay/check/:paymentId','amount','activateUser','deleteUser','domainMonitoringService','resolve','getServiceStats','36FgAglT','525uzjysF','/payout/merchants','/auth','PAID','getPaymentTimerInfo','5gtndYW','71718ckQBQi','Failed\x20to\x20get\x20domain\x20monitoring\x20statistics','/payments/:id','/users/:id/suspend','updateCustomerData','length','‚ùå\x20[ADMIN]\x20Manual\x20CoinToPay\x20check\x20failed\x20for\x20payment\x20','toISOString','error','prototype','/logs/stats','Each\x20new\x20payment\x20gets\x20individual\x20timers:\x201min,\x202min,\x207min,\x2012min,\x20then\x20hourly','coinToPayStatusService','42454LmCyis','getPayoutStats','createPayout','requireAdmin','21397629oDoPUD','deletePayout','express','getMerchantsAwaitingPayout','authenticateToken','log','/users/:id','post','validate','CoinToPay\x20automatic\x20status\x20checking\x20service','/cointopay/stats','updateUser','getUserById','3869524uyjABH','body','json','Payment\x20not\x20found','61694yfkwuy','create','currency','3906630CgupuI','Old\x20logs\x20cleaned\x20(kept\x20last\x20','floor','7032KPVmrN','getPayouts','manualCheck','/payouts','get','../config/database','updatedAt','__importStar','../services/domainMonitoringService','__createBinding','../services/loggerService','üîç\x20[ADMIN]\x20Manual\x20CoinToPay\x20check\x20requested\x20for\x20payment:\x20','/merchant-statistics','cointopay','hasOwnProperty','put','../middleware/validation','createPayoutSchema','/merchants/selection','payment','call','__esModule','/statistics','getOwnPropertyDescriptor','getLogStats','createUserSchema','6633UgstTB','delete','updateUserSchema','default','/users','status','/payments/:id/customer'];a19_0x2a6c=function(){return _0x28d77f;};return a19_0x2a6c();}(function(_0x786fc0,_0x1ce71f){const _0x38772b=a19_0x3a33,_0x1d4e51=_0x786fc0();while(!![]){try{const _0x268022=parseInt(_0x38772b(0x122))/0x1+parseInt(_0x38772b(0x137))/0x2*(parseInt(_0x38772b(0x10e))/0x3)+parseInt(_0x38772b(0x133))/0x4*(parseInt(_0x38772b(0x114))/0x5)+parseInt(_0x38772b(0x115))/0x6*(parseInt(_0x38772b(0x10f))/0x7)+-parseInt(_0x38772b(0x13d))/0x8*(-parseInt(_0x38772b(0x157))/0x9)+-parseInt(_0x38772b(0x13a))/0xa+-parseInt(_0x38772b(0x126))/0xb;if(_0x268022===_0x1ce71f)break;else _0x1d4e51['push'](_0x1d4e51['shift']());}catch(_0x27e767){_0x1d4e51['push'](_0x1d4e51['shift']());}}}(a19_0x2a6c,0x8fa6b));function a19_0x3a33(_0x27dfbe,_0x16156f){const _0x2a6c1f=a19_0x2a6c();return a19_0x3a33=function(_0x3a339c,_0x370fbc){_0x3a339c=_0x3a339c-0xf3;let _0x1935b0=_0x2a6c1f[_0x3a339c];return _0x1935b0;},a19_0x3a33(_0x27dfbe,_0x16156f);}var __createBinding=this&&this[a19_0x79b7c5(0x146)]||(Object[a19_0x79b7c5(0x138)]?function(_0x12f065,_0x1503c0,_0x1407da,_0x369927){const _0x3e7c42=a19_0x79b7c5;if(_0x369927===undefined)_0x369927=_0x1407da;var _0x46d049=Object[_0x3e7c42(0x154)](_0x1503c0,_0x1407da);(!_0x46d049||(_0x3e7c42(0x141)in _0x46d049?!_0x1503c0[_0x3e7c42(0x152)]:_0x46d049['writable']||_0x46d049['configurable']))&&(_0x46d049={'enumerable':!![],'get':function(){return _0x1503c0[_0x1407da];}}),Object[_0x3e7c42(0xf9)](_0x12f065,_0x369927,_0x46d049);}:function(_0x1af38f,_0xae4fa7,_0x19e237,_0x1cb969){if(_0x1cb969===undefined)_0x1cb969=_0x19e237;_0x1af38f[_0x1cb969]=_0xae4fa7[_0x19e237];}),__setModuleDefault=this&&this['__setModuleDefault']||(Object[a19_0x79b7c5(0x138)]?function(_0x175d8f,_0xff8140){Object['defineProperty'](_0x175d8f,'default',{'enumerable':!![],'value':_0xff8140});}:function(_0x14aed5,_0x40e057){const _0x305409=a19_0x79b7c5;_0x14aed5[_0x305409(0x15a)]=_0x40e057;}),__importStar=this&&this[a19_0x79b7c5(0x144)]||(function(){var _0x4fc430=function(_0x6fb701){return _0x4fc430=Object['getOwnPropertyNames']||function(_0x3d6108){const _0x501e5e=a19_0x3a33;var _0x15ea88=[];for(var _0x37bec1 in _0x3d6108)if(Object[_0x501e5e(0x11e)][_0x501e5e(0x14b)][_0x501e5e(0x151)](_0x3d6108,_0x37bec1))_0x15ea88[_0x15ea88[_0x501e5e(0x11a)]]=_0x37bec1;return _0x15ea88;},_0x4fc430(_0x6fb701);};return function(_0x1fda0c){const _0x29846c=a19_0x3a33;if(_0x1fda0c&&_0x1fda0c[_0x29846c(0x152)])return _0x1fda0c;var _0x1ea8b4={};if(_0x1fda0c!=null){for(var _0x2987d9=_0x4fc430(_0x1fda0c),_0xe780b3=0x0;_0xe780b3<_0x2987d9[_0x29846c(0x11a)];_0xe780b3++)if(_0x2987d9[_0xe780b3]!==_0x29846c(0x15a))__createBinding(_0x1ea8b4,_0x1fda0c,_0x2987d9[_0xe780b3]);}return __setModuleDefault(_0x1ea8b4,_0x1fda0c),_0x1ea8b4;};}());Object[a19_0x79b7c5(0xf9)](exports,'__esModule',{'value':!![]});const express_1=require(a19_0x79b7c5(0x128)),adminController_1=require(a19_0x79b7c5(0xfd)),validation_1=require(a19_0x79b7c5(0x14d)),auth_1=require('../middleware/auth'),loggerService_1=require(a19_0x79b7c5(0x147)),coinToPayStatusService_1=require('../services/coinToPayStatusService'),domainMonitoringService_1=require(a19_0x79b7c5(0x145)),router=(0x0,express_1[a19_0x79b7c5(0xfc)])(),adminController=new adminController_1['AdminController']();router['use'](auth_1[a19_0x79b7c5(0x12a)],auth_1[a19_0x79b7c5(0x125)]),router[a19_0x79b7c5(0x141)](a19_0x79b7c5(0x111),adminController['checkAuth']),router[a19_0x79b7c5(0x141)](a19_0x79b7c5(0x153),adminController[a19_0x79b7c5(0x104)]),router[a19_0x79b7c5(0x141)](a19_0x79b7c5(0x149),adminController[a19_0x79b7c5(0x105)]),router[a19_0x79b7c5(0x141)]('/payout/stats',adminController[a19_0x79b7c5(0x123)]),router[a19_0x79b7c5(0x141)](a19_0x79b7c5(0x110),adminController[a19_0x79b7c5(0x129)]),router['get'](a19_0x79b7c5(0x14f),adminController['getMerchantsSelection']),router[a19_0x79b7c5(0x12d)]('/payout',(0x0,validation_1[a19_0x79b7c5(0x12e)])(validation_1[a19_0x79b7c5(0x14e)]),adminController[a19_0x79b7c5(0x124)]),router[a19_0x79b7c5(0x141)](a19_0x79b7c5(0x140),adminController[a19_0x79b7c5(0x13e)]),router[a19_0x79b7c5(0x141)](a19_0x79b7c5(0x160),adminController['getPayoutById']),router[a19_0x79b7c5(0x158)](a19_0x79b7c5(0x160),adminController[a19_0x79b7c5(0x127)]),router[a19_0x79b7c5(0x141)]('/payments',adminController[a19_0x79b7c5(0x161)]),router['get'](a19_0x79b7c5(0x117),adminController[a19_0x79b7c5(0x162)]),router['put'](a19_0x79b7c5(0x117),adminController[a19_0x79b7c5(0xf3)]),router[a19_0x79b7c5(0x14c)](a19_0x79b7c5(0x15d),(0x0,validation_1[a19_0x79b7c5(0x12e)])(validation_1[a19_0x79b7c5(0x163)]),adminController[a19_0x79b7c5(0x119)]),router[a19_0x79b7c5(0x141)]('/users',adminController['getUsers']),router[a19_0x79b7c5(0x141)](a19_0x79b7c5(0x12c),adminController[a19_0x79b7c5(0x132)]),router[a19_0x79b7c5(0x12d)](a19_0x79b7c5(0x15b),(0x0,validation_1[a19_0x79b7c5(0x12e)])(validation_1[a19_0x79b7c5(0x156)]),adminController['createUser']),router[a19_0x79b7c5(0x14c)](a19_0x79b7c5(0x12c),(0x0,validation_1[a19_0x79b7c5(0x12e)])(validation_1[a19_0x79b7c5(0x159)]),adminController[a19_0x79b7c5(0x131)]),router['delete'](a19_0x79b7c5(0x12c),adminController[a19_0x79b7c5(0x10a)]),router['post'](a19_0x79b7c5(0x118),adminController['suspendUser']),router[a19_0x79b7c5(0x12d)]('/users/:id/activate',adminController[a19_0x79b7c5(0x109)]),router[a19_0x79b7c5(0x141)](a19_0x79b7c5(0x11f),(_0x3b350c,_0x4ec103)=>{const _0x45f0d4=a19_0x79b7c5;try{const _0x5dccb4=loggerService_1[_0x45f0d4(0xfe)][_0x45f0d4(0x155)]();_0x4ec103['json']({'success':!![],'result':_0x5dccb4});}catch(_0x37cb24){_0x4ec103[_0x45f0d4(0x15c)](0x1f4)[_0x45f0d4(0x135)]({'success':![],'message':_0x45f0d4(0x102)});}}),router[a19_0x79b7c5(0x12d)]('/logs/clean',(_0x3ffe9d,_0x273451)=>{const _0x5d9dc4=a19_0x79b7c5;try{const {daysToKeep:daysToKeep=0x1e}=_0x3ffe9d[_0x5d9dc4(0x134)];loggerService_1[_0x5d9dc4(0xfe)]['cleanOldLogs'](daysToKeep),_0x273451[_0x5d9dc4(0x135)]({'success':!![],'message':_0x5d9dc4(0x13b)+daysToKeep+_0x5d9dc4(0xf6)});}catch(_0x550f2e){_0x273451[_0x5d9dc4(0x15c)](0x1f4)[_0x5d9dc4(0x135)]({'success':![],'message':_0x5d9dc4(0x106)});}}),router[a19_0x79b7c5(0x12d)](a19_0x79b7c5(0x107),async(_0x5e2e41,_0x499c01)=>{const _0x518d86=a19_0x79b7c5;try{const {paymentId:_0x59ad1c}=_0x5e2e41[_0x518d86(0xf5)];console[_0x518d86(0x12b)](_0x518d86(0x148)+_0x59ad1c),await coinToPayStatusService_1[_0x518d86(0x121)]['checkPaymentById'](_0x59ad1c),_0x499c01[_0x518d86(0x135)]({'success':!![],'message':'CoinToPay\x20payment\x20status\x20checked\x20successfully'});}catch(_0x367ff3){console[_0x518d86(0x11d)](_0x518d86(0x11b)+_0x5e2e41['params'][_0x518d86(0x15f)]+':',_0x367ff3),_0x499c01[_0x518d86(0x15c)](0x1f4)['json']({'success':![],'message':_0x367ff3 instanceof Error?_0x367ff3[_0x518d86(0x101)]:'Failed\x20to\x20check\x20CoinToPay\x20payment\x20status'});}}),router['get'](a19_0x79b7c5(0x130),(_0x29ec85,_0x4425ae)=>{const _0xd5f4f5=a19_0x79b7c5;try{const _0x2620d5=coinToPayStatusService_1[_0xd5f4f5(0x121)][_0xd5f4f5(0x10d)]();_0x4425ae[_0xd5f4f5(0x135)]({'success':!![],'result':{..._0x2620d5,'description':_0xd5f4f5(0x12f),'statusMapping':{'Paid':_0xd5f4f5(0x112),'Awaiting\x20Fiat':_0xd5f4f5(0xff),'waiting':'PENDING','expired':'EXPIRED','failed':'FAILED'},'autoExpiryNote':'Payments\x20automatically\x20expire\x20after\x20'+_0x2620d5['expiryDays']+_0xd5f4f5(0xf8),'individualTimersNote':_0xd5f4f5(0x120)}});}catch(_0x33118a){_0x4425ae[_0xd5f4f5(0x15c)](0x1f4)[_0xd5f4f5(0x135)]({'success':![],'message':'Failed\x20to\x20get\x20CoinToPay\x20service\x20statistics'});}}),router['get']('/cointopay/payment/:paymentId',async(_0x1de76f,_0x488b20)=>{const _0x2fa476=a19_0x79b7c5;try{const {paymentId:_0x341514}=_0x1de76f[_0x2fa476(0xf5)],_0x14fe0d=coinToPayStatusService_1[_0x2fa476(0x121)][_0x2fa476(0x113)](_0x341514),_0x57e49a=(await Promise[_0x2fa476(0x10c)]()['then'](()=>__importStar(require(_0x2fa476(0x142)))))['default'],_0x2c5e2e=await _0x57e49a[_0x2fa476(0x150)][_0x2fa476(0x103)]({'where':{'id':_0x341514},'select':{'id':!![],'gateway':!![],'gatewayPaymentId':!![],'status':!![],'amount':!![],'currency':!![],'createdAt':!![],'updatedAt':!![],'shopId':!![],'shop':{'select':{'name':!![],'username':!![]}}}});if(!_0x2c5e2e)return _0x488b20['status'](0x194)[_0x2fa476(0x135)]({'success':![],'message':_0x2fa476(0x136)});_0x488b20[_0x2fa476(0x135)]({'success':!![],'result':{'payment':{'id':_0x2c5e2e['id'],'gateway':_0x2c5e2e[_0x2fa476(0x15e)],'gatewayPaymentId':_0x2c5e2e[_0x2fa476(0x100)],'status':_0x2c5e2e[_0x2fa476(0x15c)],'amount':_0x2c5e2e[_0x2fa476(0x108)],'currency':_0x2c5e2e[_0x2fa476(0x139)],'createdAt':_0x2c5e2e[_0x2fa476(0xfb)],'updatedAt':_0x2c5e2e[_0x2fa476(0x143)],'shop':_0x2c5e2e['shop']},'timers':_0x14fe0d,'isCoinToPay':_0x2c5e2e[_0x2fa476(0x15e)]===_0x2fa476(0x14a),'ageInMinutes':Math[_0x2fa476(0x13c)]((Date['now']()-_0x2c5e2e[_0x2fa476(0xfb)]['getTime']())/(0x3e8*0x3c))}});}catch(_0x21bb33){_0x488b20[_0x2fa476(0x15c)](0x1f4)[_0x2fa476(0x135)]({'success':![],'message':_0x21bb33 instanceof Error?_0x21bb33[_0x2fa476(0x101)]:'Failed\x20to\x20get\x20payment\x20information'});}}),router['get']('/domain-monitoring/stats',(_0x4d0984,_0x1be572)=>{const _0x5fec64=a19_0x79b7c5;try{const _0x396931=domainMonitoringService_1[_0x5fec64(0x10b)]['getMonitoringStats']();_0x1be572[_0x5fec64(0x135)]({'success':!![],'result':{..._0x396931,'description':_0x5fec64(0xf4),'behavior':_0x5fec64(0xfa),'encoding':'Requests\x20are\x20made\x20with\x20base64\x20encoded\x20URLs'}});}catch(_0x14f4da){_0x1be572[_0x5fec64(0x15c)](0x1f4)['json']({'success':![],'message':_0x5fec64(0x116)});}}),router[a19_0x79b7c5(0x12d)]('/domain-monitoring/check',async(_0xbe28d,_0x4b1c96)=>{const _0x1f79f2=a19_0x79b7c5;try{const _0x480396=await domainMonitoringService_1[_0x1f79f2(0x10b)][_0x1f79f2(0x13f)]();_0x4b1c96[_0x1f79f2(0x135)]({'success':!![],'result':{'domainAvailable':_0x480396,'message':_0x480396?'Domain\x20is\x20responding\x20correctly':_0x1f79f2(0xf7),'timestamp':new Date()[_0x1f79f2(0x11c)]()}});}catch(_0x4f667e){_0x4b1c96['status'](0x1f4)[_0x1f79f2(0x135)]({'success':![],'message':_0x4f667e instanceof Error?_0x4f667e['message']:'Failed\x20to\x20perform\x20manual\x20domain\x20check'});}}),exports[a19_0x79b7c5(0x15a)]=router;