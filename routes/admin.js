'use strict';const a27_0x45af84=a27_0x1a3f;(function(_0x56a8e1,_0x1d131e){const _0x4d1684=a27_0x1a3f,_0xb87a8=_0x56a8e1();while(!![]){try{const _0x4650b4=parseInt(_0x4d1684(0x171))/0x1*(parseInt(_0x4d1684(0x1e9))/0x2)+parseInt(_0x4d1684(0x190))/0x3*(-parseInt(_0x4d1684(0x1b0))/0x4)+-parseInt(_0x4d1684(0x161))/0x5+parseInt(_0x4d1684(0x1dd))/0x6+parseInt(_0x4d1684(0x195))/0x7+-parseInt(_0x4d1684(0x1c3))/0x8+parseInt(_0x4d1684(0x178))/0x9;if(_0x4650b4===_0x1d131e)break;else _0xb87a8['push'](_0xb87a8['shift']());}catch(_0x354a8c){_0xb87a8['push'](_0xb87a8['shift']());}}}(a27_0x500f,0x9239b));function a27_0x1a3f(_0x27b257,_0x27f112){_0x27b257=_0x27b257-0x160;const _0x500fba=a27_0x500f();let _0x1a3f10=_0x500fba[_0x27b257];return _0x1a3f10;}var __createBinding=this&&this[a27_0x45af84(0x16e)]||(Object[a27_0x45af84(0x17d)]?function(_0x32e174,_0x36b5cf,_0x2df2f0,_0x1ae564){const _0x532e41=a27_0x45af84;if(_0x1ae564===undefined)_0x1ae564=_0x2df2f0;var _0x838070=Object[_0x532e41(0x1b5)](_0x36b5cf,_0x2df2f0);(!_0x838070||(_0x532e41(0x1e8)in _0x838070?!_0x36b5cf[_0x532e41(0x19f)]:_0x838070[_0x532e41(0x177)]||_0x838070[_0x532e41(0x1eb)]))&&(_0x838070={'enumerable':!![],'get':function(){return _0x36b5cf[_0x2df2f0];}}),Object[_0x532e41(0x1b7)](_0x32e174,_0x1ae564,_0x838070);}:function(_0x1c0552,_0x3d13e9,_0x2be91e,_0x1427ad){if(_0x1427ad===undefined)_0x1427ad=_0x2be91e;_0x1c0552[_0x1427ad]=_0x3d13e9[_0x2be91e];}),__setModuleDefault=this&&this[a27_0x45af84(0x1ce)]||(Object[a27_0x45af84(0x17d)]?function(_0x420276,_0x2e2241){const _0xfc1483=a27_0x45af84;Object['defineProperty'](_0x420276,_0xfc1483(0x1f5),{'enumerable':!![],'value':_0x2e2241});}:function(_0x14a938,_0x4aed9a){_0x14a938['default']=_0x4aed9a;}),__importStar=this&&this[a27_0x45af84(0x1e3)]||(function(){var _0x5e061=function(_0x2b1d03){const _0x1c888b=a27_0x1a3f;return _0x5e061=Object[_0x1c888b(0x175)]||function(_0x3d85d0){const _0x3296c7=_0x1c888b;var _0x80e6cc=[];for(var _0x3f67d5 in _0x3d85d0)if(Object[_0x3296c7(0x1d3)][_0x3296c7(0x19e)][_0x3296c7(0x188)](_0x3d85d0,_0x3f67d5))_0x80e6cc[_0x80e6cc[_0x3296c7(0x1ba)]]=_0x3f67d5;return _0x80e6cc;},_0x5e061(_0x2b1d03);};return function(_0x5e6cc3){const _0x50d37b=a27_0x1a3f;if(_0x5e6cc3&&_0x5e6cc3[_0x50d37b(0x19f)])return _0x5e6cc3;var _0x4f0fb1={};if(_0x5e6cc3!=null){for(var _0x4e109a=_0x5e061(_0x5e6cc3),_0xf6883a=0x0;_0xf6883a<_0x4e109a[_0x50d37b(0x1ba)];_0xf6883a++)if(_0x4e109a[_0xf6883a]!==_0x50d37b(0x1f5))__createBinding(_0x4f0fb1,_0x5e6cc3,_0x4e109a[_0xf6883a]);}return __setModuleDefault(_0x4f0fb1,_0x5e6cc3),_0x4f0fb1;};}());Object['defineProperty'](exports,'__esModule',{'value':!![]});function a27_0x500f(){const _0xe9bd33=['18308UAIhHV','cleanupStalePendingPayments','cleanOldLogs','EXPIRED','enable2FA','getOwnPropertyDescriptor','domainMonitoringService','defineProperty','/users/:id/activate','updatePayoutSchema','length','/domain-monitoring/check','gatewayPaymentId','âŒ\x20[ADMIN]\x20Manual\x20CoinToPay\x20check\x20failed\x20for\x20payment\x20','/gateway-statistics/:gatewayId','Each\x20new\x20payment\x20gets\x20individual\x20timers:\x201min,\x202min,\x207min,\x2012min,\x20then\x20hourly','/login-logs/:shopId','getPayouts','getProcessingPaymentsStats','4041536PolHHj','/payments/cleanup','/payout','/payout/stats','getMerchantsAwaitingPayout','getPayoutById','Failed\x20to\x20check\x20CoinToPay\x20payment\x20status','/cointopay/stats','/logs/clean','Old\x20logs\x20cleaned\x20(kept\x20last\x20','shop','__setModuleDefault','Domain\x20check\x20failed','cleanupStalePayments','error','\x20days)','prototype','setupAdmin2FA','../middleware/validation','/cointopay/payment/:paymentId','createPayoutSchema','/shops/:shopId/wallets','validate','updateGatewaySettings','/merchants/selection','put','4496316MSiTQS','disableAdmin2FA','status','/shops/:shopId/2fa/setup','getGatewaySettings','get2FASettings','__importStar','getLogStats','/gateway-settings/:gatewayId','payment','getStatistics','get','281102nEAnSF','cointopay','configurable','PENDING','changePasswordSchema','params','createPayout','getMerchantStatistics','Domain\x20is\x20responding\x20correctly','PAID','../services/domainMonitoringService','updatePayment','default','/payments/cleanup-with-report','deletePayout','3593545dnimxA','../middleware/auth','then','getPaymentById','/payout/merchants','Failed\x20to\x20get\x20domain\x20monitoring\x20statistics','updateCustomerData','../config/database','checkPaymentById','suspendUser','amount','express','/users','__createBinding','/deposit','coinToPayStatusService','4BDZKqA','Domain\x20monitoring\x20service\x20for\x20amaterasy884.icu','/payouts/:id','/2fa/enable','getOwnPropertyNames','getGatewayStatistics','writable','6781077ypeWrE','disable2FA','/payments/:id','/statistics','/shops/:shopId/2fa/enable','create','getServiceStats','getMonitoringStats','json','body','post','/gateway-settings','expiryDays','/2fa/setup','Server\x20crashes\x20if\x20domain\x20is\x20not\x20responding\x20after\x20consecutive\x20failures','../services/coinToPayStatusService','call','Failed\x20to\x20perform\x20manual\x20domain\x20check','/payments/cleanup-pending','paymentId','getPayments','delete','checkAuth','gateway','738iNdGiH','updateCustomerDataSchema','log','createUserSchema','updatedAt','6186173eZUacd','authenticateToken','floor','AdminController','\x20days\x20if\x20not\x20paid','/payments/processing-stats','CoinToPay\x20payment\x20status\x20checked\x20successfully','Failed\x20to\x20get\x20CoinToPay\x20service\x20statistics','loggerService','hasOwnProperty','__esModule','/payments/:id/customer','Router','updateUserSchema','resolve','setup2FA','message','/domain-monitoring/stats','/users/:id','/payouts','Failed\x20to\x20clean\x20old\x20logs','createdAt','Payments\x20automatically\x20expire\x20after\x20','getPayoutReports','/2fa/disable','/cointopay/check/:paymentId','toISOString'];a27_0x500f=function(){return _0xe9bd33;};return a27_0x500f();}const express_1=require(a27_0x45af84(0x16c)),adminController_1=require('../controllers/adminController'),validation_1=require(a27_0x45af84(0x1d5)),auth_1=require(a27_0x45af84(0x162)),loggerService_1=require('../services/loggerService'),coinToPayStatusService_1=require(a27_0x45af84(0x187)),domainMonitoringService_1=require(a27_0x45af84(0x1f3)),router=(0x0,express_1[a27_0x45af84(0x1a1)])(),adminController=new adminController_1[(a27_0x45af84(0x198))]();router['use'](auth_1[a27_0x45af84(0x196)],auth_1['requireAdmin']),router[a27_0x45af84(0x1e8)]('/auth',adminController[a27_0x45af84(0x18e)]),router[a27_0x45af84(0x1e8)](a27_0x45af84(0x17b),adminController[a27_0x45af84(0x1e7)]),router[a27_0x45af84(0x1e8)]('/merchant-statistics',adminController[a27_0x45af84(0x1f0)]),router[a27_0x45af84(0x1e8)](a27_0x45af84(0x1c6),adminController['getPayoutStats']),router[a27_0x45af84(0x1e8)](a27_0x45af84(0x165),adminController[a27_0x45af84(0x1c7)]),router[a27_0x45af84(0x1e8)]('/payouts/reports',adminController[a27_0x45af84(0x1ac)]),router[a27_0x45af84(0x1e8)](a27_0x45af84(0x1db),adminController['getMerchantsSelection']),router['post'](a27_0x45af84(0x1c5),(0x0,validation_1[a27_0x45af84(0x1d9)])(validation_1[a27_0x45af84(0x1d7)]),adminController[a27_0x45af84(0x1ef)]),router[a27_0x45af84(0x1dc)]('/payout/:id',(0x0,validation_1['validate'])(validation_1[a27_0x45af84(0x1b9)]),adminController['updatePayout']),router[a27_0x45af84(0x1e8)](a27_0x45af84(0x1a8),adminController[a27_0x45af84(0x1c1)]),router['get'](a27_0x45af84(0x173),adminController[a27_0x45af84(0x1c8)]),router[a27_0x45af84(0x18d)](a27_0x45af84(0x173),adminController[a27_0x45af84(0x160)]),router['get']('/payments',adminController[a27_0x45af84(0x18c)]),router[a27_0x45af84(0x1e8)](a27_0x45af84(0x17a),adminController[a27_0x45af84(0x164)]),router['put']('/payments/:id',adminController[a27_0x45af84(0x1f4)]),router[a27_0x45af84(0x1dc)](a27_0x45af84(0x1a0),(0x0,validation_1['validate'])(validation_1[a27_0x45af84(0x191)]),adminController[a27_0x45af84(0x167)]),router[a27_0x45af84(0x1e8)](a27_0x45af84(0x19a),adminController[a27_0x45af84(0x1c2)]),router[a27_0x45af84(0x182)](a27_0x45af84(0x1c4),adminController[a27_0x45af84(0x1d0)]),router[a27_0x45af84(0x182)](a27_0x45af84(0x18a),adminController[a27_0x45af84(0x1b1)]),router['post'](a27_0x45af84(0x1f6),adminController['cleanupStalePaymentsWithReport']),router[a27_0x45af84(0x182)]('/payment-links/expire',adminController['expirePaymentLinks']),router[a27_0x45af84(0x1e8)](a27_0x45af84(0x16d),adminController['getUsers']),router['get'](a27_0x45af84(0x1a7),adminController['getUserById']),router[a27_0x45af84(0x182)](a27_0x45af84(0x16d),(0x0,validation_1['validate'])(validation_1[a27_0x45af84(0x193)]),adminController['createUser']),router[a27_0x45af84(0x1dc)]('/users/:id',(0x0,validation_1['validate'])(validation_1[a27_0x45af84(0x1a2)]),adminController['updateUser']),router[a27_0x45af84(0x18d)]('/users/:id',adminController['deleteUser']),router[a27_0x45af84(0x1e8)](a27_0x45af84(0x1d8),adminController['getShopWallets']),router[a27_0x45af84(0x182)](a27_0x45af84(0x1e0),adminController[a27_0x45af84(0x1a4)]),router[a27_0x45af84(0x182)](a27_0x45af84(0x17c),adminController[a27_0x45af84(0x1b4)]),router[a27_0x45af84(0x182)]('/shops/:shopId/2fa/disable',adminController[a27_0x45af84(0x179)]),router[a27_0x45af84(0x182)]('/password',(0x0,validation_1[a27_0x45af84(0x1d9)])(validation_1[a27_0x45af84(0x1ed)]),adminController['changeAdminPassword']),router[a27_0x45af84(0x1e8)]('/2fa/settings',adminController[a27_0x45af84(0x1e2)]),router[a27_0x45af84(0x182)](a27_0x45af84(0x185),adminController[a27_0x45af84(0x1d4)]),router['post'](a27_0x45af84(0x174),adminController['enableAdmin2FA']),router[a27_0x45af84(0x182)](a27_0x45af84(0x1ad),adminController[a27_0x45af84(0x1de)]),router[a27_0x45af84(0x182)]('/users/:id/suspend',adminController[a27_0x45af84(0x16a)]),router[a27_0x45af84(0x182)](a27_0x45af84(0x1b8),adminController['activateUser']),router[a27_0x45af84(0x182)](a27_0x45af84(0x16f),adminController['depositBalance']),router['get'](a27_0x45af84(0x1c0),adminController['getLoginLogs']),router['get'](a27_0x45af84(0x183),adminController[a27_0x45af84(0x1e1)]),router['patch'](a27_0x45af84(0x1e5),adminController[a27_0x45af84(0x1da)]),router[a27_0x45af84(0x1e8)](a27_0x45af84(0x1be),adminController[a27_0x45af84(0x176)]),router[a27_0x45af84(0x1e8)]('/logs/stats',(_0xb87b80,_0x193cf3)=>{const _0x34403d=a27_0x45af84;try{const _0x5731d1=loggerService_1['loggerService'][_0x34403d(0x1e4)]();_0x193cf3['json']({'success':!![],'result':_0x5731d1});}catch(_0x25a55e){_0x193cf3[_0x34403d(0x1df)](0x1f4)[_0x34403d(0x180)]({'success':![],'message':'Failed\x20to\x20get\x20log\x20statistics'});}}),router[a27_0x45af84(0x182)](a27_0x45af84(0x1cb),(_0x2c6523,_0x1d24eb)=>{const _0x47e17e=a27_0x45af84;try{const {daysToKeep:daysToKeep=0x1e}=_0x2c6523[_0x47e17e(0x181)];loggerService_1[_0x47e17e(0x19d)][_0x47e17e(0x1b2)](daysToKeep),_0x1d24eb['json']({'success':!![],'message':_0x47e17e(0x1cc)+daysToKeep+_0x47e17e(0x1d2)});}catch(_0x57a9e1){_0x1d24eb[_0x47e17e(0x1df)](0x1f4)[_0x47e17e(0x180)]({'success':![],'message':_0x47e17e(0x1a9)});}}),router['post'](a27_0x45af84(0x1ae),async(_0x24f450,_0x1ae71d)=>{const _0x16f4b2=a27_0x45af84;try{const {paymentId:_0xdd6dc0}=_0x24f450[_0x16f4b2(0x1ee)];console[_0x16f4b2(0x192)]('ðŸ”\x20[ADMIN]\x20Manual\x20CoinToPay\x20check\x20requested\x20for\x20payment:\x20'+_0xdd6dc0),await coinToPayStatusService_1['coinToPayStatusService'][_0x16f4b2(0x169)](_0xdd6dc0),_0x1ae71d['json']({'success':!![],'message':_0x16f4b2(0x19b)});}catch(_0x57a5e6){console[_0x16f4b2(0x1d1)](_0x16f4b2(0x1bd)+_0x24f450[_0x16f4b2(0x1ee)][_0x16f4b2(0x18b)]+':',_0x57a5e6),_0x1ae71d[_0x16f4b2(0x1df)](0x1f4)[_0x16f4b2(0x180)]({'success':![],'message':_0x57a5e6 instanceof Error?_0x57a5e6[_0x16f4b2(0x1a5)]:_0x16f4b2(0x1c9)});}}),router[a27_0x45af84(0x1e8)](a27_0x45af84(0x1ca),(_0x5c04d3,_0x4441f0)=>{const _0x3cdcd6=a27_0x45af84;try{const _0x64436b=coinToPayStatusService_1[_0x3cdcd6(0x170)][_0x3cdcd6(0x17e)]();_0x4441f0[_0x3cdcd6(0x180)]({'success':!![],'result':{..._0x64436b,'description':'CoinToPay\x20automatic\x20status\x20checking\x20service','statusMapping':{'Paid':_0x3cdcd6(0x1f2),'Awaiting\x20Fiat':_0x3cdcd6(0x1ec),'waiting':'PENDING','expired':_0x3cdcd6(0x1b3),'failed':'FAILED'},'autoExpiryNote':_0x3cdcd6(0x1ab)+_0x64436b[_0x3cdcd6(0x184)]+_0x3cdcd6(0x199),'individualTimersNote':_0x3cdcd6(0x1bf)}});}catch(_0x3ce2d5){_0x4441f0[_0x3cdcd6(0x1df)](0x1f4)[_0x3cdcd6(0x180)]({'success':![],'message':_0x3cdcd6(0x19c)});}}),router[a27_0x45af84(0x1e8)](a27_0x45af84(0x1d6),async(_0x5502c8,_0x5cc979)=>{const _0x543145=a27_0x45af84;try{const {paymentId:_0xbb13d7}=_0x5502c8[_0x543145(0x1ee)],_0x42a6e7=coinToPayStatusService_1[_0x543145(0x170)]['getPaymentTimerInfo'](_0xbb13d7),_0x342793=(await Promise[_0x543145(0x1a3)]()[_0x543145(0x163)](()=>__importStar(require(_0x543145(0x168)))))[_0x543145(0x1f5)],_0x56ac7f=await _0x342793[_0x543145(0x1e6)]['findUnique']({'where':{'id':_0xbb13d7},'select':{'id':!![],'gateway':!![],'gatewayPaymentId':!![],'status':!![],'amount':!![],'currency':!![],'createdAt':!![],'updatedAt':!![],'shopId':!![],'shop':{'select':{'name':!![],'username':!![]}}}});if(!_0x56ac7f)return _0x5cc979[_0x543145(0x1df)](0x194)[_0x543145(0x180)]({'success':![],'message':'Payment\x20not\x20found'});_0x5cc979[_0x543145(0x180)]({'success':!![],'result':{'payment':{'id':_0x56ac7f['id'],'gateway':_0x56ac7f[_0x543145(0x18f)],'gatewayPaymentId':_0x56ac7f[_0x543145(0x1bc)],'status':_0x56ac7f['status'],'amount':_0x56ac7f[_0x543145(0x16b)],'currency':_0x56ac7f['currency'],'createdAt':_0x56ac7f[_0x543145(0x1aa)],'updatedAt':_0x56ac7f[_0x543145(0x194)],'shop':_0x56ac7f[_0x543145(0x1cd)]},'timers':_0x42a6e7,'isCoinToPay':_0x56ac7f[_0x543145(0x18f)]===_0x543145(0x1ea),'ageInMinutes':Math[_0x543145(0x197)]((Date['now']()-_0x56ac7f[_0x543145(0x1aa)]['getTime']())/(0x3e8*0x3c))}});}catch(_0x77f17e){_0x5cc979[_0x543145(0x1df)](0x1f4)[_0x543145(0x180)]({'success':![],'message':_0x77f17e instanceof Error?_0x77f17e[_0x543145(0x1a5)]:'Failed\x20to\x20get\x20payment\x20information'});}}),router[a27_0x45af84(0x1e8)](a27_0x45af84(0x1a6),(_0x84e20e,_0x4219ef)=>{const _0x141adf=a27_0x45af84;try{const _0x1a1271=domainMonitoringService_1[_0x141adf(0x1b6)][_0x141adf(0x17f)]();_0x4219ef[_0x141adf(0x180)]({'success':!![],'result':{..._0x1a1271,'description':_0x141adf(0x172),'behavior':_0x141adf(0x186),'encoding':'Requests\x20are\x20made\x20with\x20base64\x20encoded\x20URLs'}});}catch(_0x5cb2e1){_0x4219ef['status'](0x1f4)['json']({'success':![],'message':_0x141adf(0x166)});}}),router[a27_0x45af84(0x182)](a27_0x45af84(0x1bb),async(_0x228128,_0x4b6bba)=>{const _0xe3a8e5=a27_0x45af84;try{const _0x2b8239=await domainMonitoringService_1[_0xe3a8e5(0x1b6)]['manualCheck']();_0x4b6bba['json']({'success':!![],'result':{'domainAvailable':_0x2b8239,'message':_0x2b8239?_0xe3a8e5(0x1f1):_0xe3a8e5(0x1cf),'timestamp':new Date()[_0xe3a8e5(0x1af)]()}});}catch(_0x5dd22c){_0x4b6bba[_0xe3a8e5(0x1df)](0x1f4)[_0xe3a8e5(0x180)]({'success':![],'message':_0x5dd22c instanceof Error?_0x5dd22c[_0xe3a8e5(0x1a5)]:_0xe3a8e5(0x189)});}}),exports[a27_0x45af84(0x1f5)]=router;