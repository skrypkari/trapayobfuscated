'use strict';const a19_0x1e79ef=a19_0x4d8d;(function(_0xd6f089,_0x73e0a1){const _0xa309e6=a19_0x4d8d,_0x10fbf1=_0xd6f089();while(!![]){try{const _0xc768ca=parseInt(_0xa309e6(0x169))/0x1*(-parseInt(_0xa309e6(0x144))/0x2)+-parseInt(_0xa309e6(0x1a5))/0x3*(-parseInt(_0xa309e6(0x151))/0x4)+-parseInt(_0xa309e6(0x12f))/0x5*(parseInt(_0xa309e6(0x1a8))/0x6)+parseInt(_0xa309e6(0x1b2))/0x7*(parseInt(_0xa309e6(0x139))/0x8)+parseInt(_0xa309e6(0x141))/0x9+-parseInt(_0xa309e6(0x186))/0xa+parseInt(_0xa309e6(0x185))/0xb;if(_0xc768ca===_0x73e0a1)break;else _0x10fbf1['push'](_0x10fbf1['shift']());}catch(_0x215575){_0x10fbf1['push'](_0x10fbf1['shift']());}}}(a19_0x2ff7,0x23b85));function a19_0x2ff7(){const _0x5accfc=['/auth','CoinToPay\x20payment\x20status\x20checked\x20successfully','post','/cointopay/check/:paymentId','updatedAt','getMerchantsAwaitingPayout','getPayments','configurable','üîç\x20[ADMIN]\x20Manual\x20CoinToPay\x20check\x20requested\x20for\x20payment:\x20','delete','EXPIRED','get','manualCheck','gatewayPaymentId','793335RbmJBe','/rapyd/stats','../services/rapydStatusService','6xVoUDh','/users','createdAt','createUserSchema','__importStar','floor','updateCustomerData','defineProperty','/rapyd/payment/:paymentId','now','43841TUxpUT','body','/payouts/:id','express','810130fGhfRk','resolve','Server\x20crashes\x20if\x20domain\x20is\x20not\x20responding\x20after\x20consecutive\x20failures','prototype','PENDING','No\x20checks\x20scheduled','paymentId','Failed\x20to\x20check\x20Rapyd\x20payment\x20status','cointopay','updateCustomerDataSchema','72ypcaFH','Only\x20checks\x20payments\x20with\x20status\x20PENDING\x20at\x20check\x20time','checkPaymentById','AdminController','coinToPayStatusService','amount','getOwnPropertyDescriptor','/users/:id/activate','285615IWMQAT','Domain\x20check\x20failed','payment','2CSFhGe','../services/domainMonitoringService','Failed\x20to\x20get\x20Rapyd\x20service\x20statistics','updateUser','/domain-monitoring/stats','getMonitoringStats','deleteUser','default','deletePayout','hasTimers','authenticateToken','params','/users/:id/suspend','4qdcXox','/payments/:id','../services/coinToPayStatusService','/statistics','writable','suspendUser','Old\x20logs\x20cleaned\x20(kept\x20last\x20','Failed\x20to\x20get\x20domain\x20monitoring\x20statistics','requireAdmin','Failed\x20to\x20perform\x20manual\x20domain\x20check','getLogStats','updatePayment','Failed\x20to\x20get\x20log\x20statistics','CoinToPay\x20automatic\x20status\x20checking\x20service','/payouts','log','Payments\x20automatically\x20expire\x20after\x20','getPaymentTimerInfo','\x20minutes','then','rapydStatusService','Failed\x20to\x20get\x20payment\x20information','status','Payment\x20not\x20found','257869PtJqdl','json','/users/:id','validate','\x20days\x20if\x20not\x20paid','Requests\x20are\x20made\x20with\x20base64\x20encoded\x20URLs','Rapyd\x20payment\x20status\x20checked\x20successfully','findUnique','toISOString','/logs/stats','loggerService','cleanOldLogs','/payout/merchants','__esModule','currency','No\x20more\x20checks\x20scheduled','length','FAILED','shop','expiryDays','createUser','gateway','domainMonitoringService','getUsers','error','checkAuth','message','getTime','3511585JqIEmJ','1055780jBLBPL','/payout','../middleware/auth','create','use','getServiceStats','Failed\x20to\x20get\x20CoinToPay\x20service\x20statistics','getPayoutById','../controllers/adminController','/merchant-statistics','/merchants/selection','/payments','__setModuleDefault','Domain\x20monitoring\x20service\x20for\x20amaterasy884.icu','/payments/:id/customer','put','activateUser'];a19_0x2ff7=function(){return _0x5accfc;};return a19_0x2ff7();}function a19_0x4d8d(_0x302c0b,_0x31cf80){const _0x2ff7b3=a19_0x2ff7();return a19_0x4d8d=function(_0x4d8dca,_0x583a93){_0x4d8dca=_0x4d8dca-0x12f;let _0x4fb2c3=_0x2ff7b3[_0x4d8dca];return _0x4fb2c3;},a19_0x4d8d(_0x302c0b,_0x31cf80);}var __createBinding=this&&this['__createBinding']||(Object[a19_0x1e79ef(0x189)]?function(_0xf23411,_0x57db69,_0x2eaadc,_0x18afb3){const _0x2e1581=a19_0x1e79ef;if(_0x18afb3===undefined)_0x18afb3=_0x2eaadc;var _0xd54ca3=Object[_0x2e1581(0x13f)](_0x57db69,_0x2eaadc);(!_0xd54ca3||(_0x2e1581(0x1a2)in _0xd54ca3?!_0x57db69[_0x2e1581(0x176)]:_0xd54ca3[_0x2e1581(0x155)]||_0xd54ca3[_0x2e1581(0x19e)]))&&(_0xd54ca3={'enumerable':!![],'get':function(){return _0x57db69[_0x2eaadc];}}),Object['defineProperty'](_0xf23411,_0x18afb3,_0xd54ca3);}:function(_0x4d01dc,_0x1c921c,_0x4c48f9,_0x380fb2){if(_0x380fb2===undefined)_0x380fb2=_0x4c48f9;_0x4d01dc[_0x380fb2]=_0x1c921c[_0x4c48f9];}),__setModuleDefault=this&&this[a19_0x1e79ef(0x192)]||(Object[a19_0x1e79ef(0x189)]?function(_0x265870,_0x1facc8){const _0x2d17b3=a19_0x1e79ef;Object[_0x2d17b3(0x1af)](_0x265870,'default',{'enumerable':!![],'value':_0x1facc8});}:function(_0x72cac0,_0x142f25){const _0xfb6546=a19_0x1e79ef;_0x72cac0[_0xfb6546(0x14b)]=_0x142f25;}),__importStar=this&&this[a19_0x1e79ef(0x1ac)]||(function(){var _0x4d2c44=function(_0x140910){return _0x4d2c44=Object['getOwnPropertyNames']||function(_0xe4db4c){const _0xe8bdd5=a19_0x4d8d;var _0x824b0d=[];for(var _0x4b55ab in _0xe4db4c)if(Object[_0xe8bdd5(0x132)]['hasOwnProperty']['call'](_0xe4db4c,_0x4b55ab))_0x824b0d[_0x824b0d[_0xe8bdd5(0x179)]]=_0x4b55ab;return _0x824b0d;},_0x4d2c44(_0x140910);};return function(_0x53ace1){const _0x19216f=a19_0x4d8d;if(_0x53ace1&&_0x53ace1[_0x19216f(0x176)])return _0x53ace1;var _0x3556f9={};if(_0x53ace1!=null){for(var _0x35b687=_0x4d2c44(_0x53ace1),_0x2506b0=0x0;_0x2506b0<_0x35b687[_0x19216f(0x179)];_0x2506b0++)if(_0x35b687[_0x2506b0]!==_0x19216f(0x14b))__createBinding(_0x3556f9,_0x53ace1,_0x35b687[_0x2506b0]);}return __setModuleDefault(_0x3556f9,_0x53ace1),_0x3556f9;};}()),__importDefault=this&&this['__importDefault']||function(_0x466b99){const _0x444f5a=a19_0x1e79ef;return _0x466b99&&_0x466b99[_0x444f5a(0x176)]?_0x466b99:{'default':_0x466b99};};Object[a19_0x1e79ef(0x1af)](exports,a19_0x1e79ef(0x176),{'value':!![]});const express_1=require(a19_0x1e79ef(0x1b5)),adminController_1=require(a19_0x1e79ef(0x18e)),validation_1=require('../middleware/validation'),auth_1=require(a19_0x1e79ef(0x188)),loggerService_1=require('../services/loggerService'),coinToPayStatusService_1=require(a19_0x1e79ef(0x153)),rapydStatusService_1=require(a19_0x1e79ef(0x1a7)),domainMonitoringService_1=require(a19_0x1e79ef(0x145)),database_1=__importDefault(require('../config/database')),router=(0x0,express_1['Router'])(),adminController=new adminController_1[(a19_0x1e79ef(0x13c))]();router[a19_0x1e79ef(0x18a)](auth_1[a19_0x1e79ef(0x14e)],auth_1[a19_0x1e79ef(0x159)]),router[a19_0x1e79ef(0x1a2)](a19_0x1e79ef(0x197),adminController[a19_0x1e79ef(0x182)]),router[a19_0x1e79ef(0x1a2)](a19_0x1e79ef(0x154),adminController['getStatistics']),router['get'](a19_0x1e79ef(0x18f),adminController['getMerchantStatistics']),router['get'](a19_0x1e79ef(0x190),adminController['getMerchantsSelection']),router[a19_0x1e79ef(0x1a2)]('/payout/stats',adminController['getPayoutStats']),router[a19_0x1e79ef(0x1a2)](a19_0x1e79ef(0x175),adminController[a19_0x1e79ef(0x19c)]),router[a19_0x1e79ef(0x199)](a19_0x1e79ef(0x187),(0x0,validation_1[a19_0x1e79ef(0x16c)])(validation_1['createPayoutSchema']),adminController['createPayout']),router[a19_0x1e79ef(0x1a2)](a19_0x1e79ef(0x15f),adminController['getPayouts']),router[a19_0x1e79ef(0x1a2)](a19_0x1e79ef(0x1b4),adminController[a19_0x1e79ef(0x18d)]),router['delete'](a19_0x1e79ef(0x1b4),adminController[a19_0x1e79ef(0x14c)]),router[a19_0x1e79ef(0x1a2)](a19_0x1e79ef(0x191),adminController[a19_0x1e79ef(0x19d)]),router[a19_0x1e79ef(0x1a2)]('/payments/:id',adminController['getPaymentById']),router[a19_0x1e79ef(0x195)](a19_0x1e79ef(0x152),adminController[a19_0x1e79ef(0x15c)]),router['put'](a19_0x1e79ef(0x194),(0x0,validation_1['validate'])(validation_1[a19_0x1e79ef(0x138)]),adminController[a19_0x1e79ef(0x1ae)]),router[a19_0x1e79ef(0x1a2)](a19_0x1e79ef(0x1a9),adminController[a19_0x1e79ef(0x180)]),router[a19_0x1e79ef(0x1a2)](a19_0x1e79ef(0x16b),adminController['getUserById']),router[a19_0x1e79ef(0x199)](a19_0x1e79ef(0x1a9),(0x0,validation_1[a19_0x1e79ef(0x16c)])(validation_1[a19_0x1e79ef(0x1ab)]),adminController[a19_0x1e79ef(0x17d)]),router['put']('/users/:id',(0x0,validation_1[a19_0x1e79ef(0x16c)])(validation_1['updateUserSchema']),adminController[a19_0x1e79ef(0x147)]),router[a19_0x1e79ef(0x1a0)](a19_0x1e79ef(0x16b),adminController[a19_0x1e79ef(0x14a)]),router['post'](a19_0x1e79ef(0x150),adminController[a19_0x1e79ef(0x156)]),router[a19_0x1e79ef(0x199)](a19_0x1e79ef(0x140),adminController[a19_0x1e79ef(0x196)]),router[a19_0x1e79ef(0x1a2)](a19_0x1e79ef(0x172),(_0x11207c,_0x95bd5a)=>{const _0x223d60=a19_0x1e79ef;try{const _0x211f4c=loggerService_1[_0x223d60(0x173)][_0x223d60(0x15b)]();_0x95bd5a[_0x223d60(0x16a)]({'success':!![],'result':_0x211f4c});}catch(_0x5e81b1){_0x95bd5a[_0x223d60(0x167)](0x1f4)[_0x223d60(0x16a)]({'success':![],'message':_0x223d60(0x15d)});}}),router[a19_0x1e79ef(0x199)]('/logs/clean',(_0x1d78b7,_0x1e7705)=>{const _0x19b082=a19_0x1e79ef;try{const {daysToKeep:daysToKeep=0x1e}=_0x1d78b7[_0x19b082(0x1b3)];loggerService_1[_0x19b082(0x173)][_0x19b082(0x174)](daysToKeep),_0x1e7705[_0x19b082(0x16a)]({'success':!![],'message':_0x19b082(0x157)+daysToKeep+'\x20days)'});}catch(_0x3780a7){_0x1e7705[_0x19b082(0x167)](0x1f4)['json']({'success':![],'message':'Failed\x20to\x20clean\x20old\x20logs'});}}),router['post'](a19_0x1e79ef(0x19a),async(_0x5b536f,_0x1abde0)=>{const _0x3cfd8d=a19_0x1e79ef;try{const {paymentId:_0x2eb642}=_0x5b536f[_0x3cfd8d(0x14f)];console[_0x3cfd8d(0x160)](_0x3cfd8d(0x19f)+_0x2eb642),await coinToPayStatusService_1[_0x3cfd8d(0x13d)][_0x3cfd8d(0x13b)](_0x2eb642),_0x1abde0[_0x3cfd8d(0x16a)]({'success':!![],'message':_0x3cfd8d(0x198)});}catch(_0x4ddcd2){console[_0x3cfd8d(0x181)]('‚ùå\x20[ADMIN]\x20Manual\x20CoinToPay\x20check\x20failed\x20for\x20payment\x20'+_0x5b536f[_0x3cfd8d(0x14f)][_0x3cfd8d(0x135)]+':',_0x4ddcd2),_0x1abde0[_0x3cfd8d(0x167)](0x1f4)['json']({'success':![],'message':_0x4ddcd2 instanceof Error?_0x4ddcd2[_0x3cfd8d(0x183)]:'Failed\x20to\x20check\x20CoinToPay\x20payment\x20status'});}}),router[a19_0x1e79ef(0x1a2)]('/cointopay/stats',(_0x1b46cd,_0x181fa3)=>{const _0x45ecd1=a19_0x1e79ef;try{const _0x4c83f3=coinToPayStatusService_1[_0x45ecd1(0x13d)][_0x45ecd1(0x18b)]();_0x181fa3[_0x45ecd1(0x16a)]({'success':!![],'result':{..._0x4c83f3,'description':_0x45ecd1(0x15e),'statusMapping':{'Paid':'PAID','Awaiting\x20Fiat':'PENDING','waiting':'PENDING','expired':_0x45ecd1(0x1a1),'failed':_0x45ecd1(0x17a)},'autoExpiryNote':_0x45ecd1(0x161)+_0x4c83f3[_0x45ecd1(0x17c)]+_0x45ecd1(0x16d),'individualTimersNote':'Each\x20new\x20payment\x20gets\x20individual\x20timers:\x201min,\x202min,\x207min,\x2012min,\x20then\x20hourly'}});}catch(_0x56984b){_0x181fa3['status'](0x1f4)['json']({'success':![],'message':_0x45ecd1(0x18c)});}}),router[a19_0x1e79ef(0x1a2)]('/cointopay/payment/:paymentId',async(_0x53a90a,_0x29bda1)=>{const _0x3bc370=a19_0x1e79ef;try{const {paymentId:_0x5a0644}=_0x53a90a[_0x3bc370(0x14f)],_0x4504a9=coinToPayStatusService_1['coinToPayStatusService'][_0x3bc370(0x162)](_0x5a0644),_0x13f0bd=(await Promise[_0x3bc370(0x130)]()[_0x3bc370(0x164)](()=>__importStar(require('../config/database'))))[_0x3bc370(0x14b)],_0x32109b=await _0x13f0bd[_0x3bc370(0x143)][_0x3bc370(0x170)]({'where':{'id':_0x5a0644},'select':{'id':!![],'gateway':!![],'gatewayPaymentId':!![],'status':!![],'amount':!![],'currency':!![],'createdAt':!![],'updatedAt':!![],'shopId':!![],'shop':{'select':{'name':!![],'username':!![]}}}});if(!_0x32109b)return _0x29bda1[_0x3bc370(0x167)](0x194)[_0x3bc370(0x16a)]({'success':![],'message':_0x3bc370(0x168)});_0x29bda1['json']({'success':!![],'result':{'payment':{'id':_0x32109b['id'],'gateway':_0x32109b[_0x3bc370(0x17e)],'gatewayPaymentId':_0x32109b['gatewayPaymentId'],'status':_0x32109b[_0x3bc370(0x167)],'amount':_0x32109b['amount'],'currency':_0x32109b[_0x3bc370(0x177)],'createdAt':_0x32109b[_0x3bc370(0x1aa)],'updatedAt':_0x32109b[_0x3bc370(0x19b)],'shop':_0x32109b['shop']},'timers':_0x4504a9,'isCoinToPay':_0x32109b['gateway']===_0x3bc370(0x137),'ageInMinutes':Math['floor']((Date['now']()-_0x32109b[_0x3bc370(0x1aa)][_0x3bc370(0x184)]())/(0x3e8*0x3c))}});}catch(_0x3e6219){_0x29bda1[_0x3bc370(0x167)](0x1f4)['json']({'success':![],'message':_0x3e6219 instanceof Error?_0x3e6219[_0x3bc370(0x183)]:_0x3bc370(0x166)});}}),router[a19_0x1e79ef(0x199)]('/rapyd/check/:paymentId',async(_0x4fbf72,_0x325ae9)=>{const _0x37d9f9=a19_0x1e79ef;try{const {paymentId:_0x5ccdb7}=_0x4fbf72['params'];console['log']('üîç\x20[ADMIN]\x20Manual\x20Rapyd\x20check\x20requested\x20for\x20payment:\x20'+_0x5ccdb7),await rapydStatusService_1['rapydStatusService'][_0x37d9f9(0x13b)](_0x5ccdb7),_0x325ae9[_0x37d9f9(0x16a)]({'success':!![],'message':_0x37d9f9(0x16f)});}catch(_0x5dfdb9){console[_0x37d9f9(0x181)]('‚ùå\x20[ADMIN]\x20Manual\x20Rapyd\x20check\x20failed\x20for\x20payment\x20'+_0x4fbf72['params'][_0x37d9f9(0x135)]+':',_0x5dfdb9),_0x325ae9[_0x37d9f9(0x167)](0x1f4)['json']({'success':![],'message':_0x5dfdb9 instanceof Error?_0x5dfdb9[_0x37d9f9(0x183)]:_0x37d9f9(0x136)});}}),router['get'](a19_0x1e79ef(0x1a6),(_0x84ff8,_0x26dd5c)=>{const _0x12e1c1=a19_0x1e79ef;try{const _0x16f28e=rapydStatusService_1[_0x12e1c1(0x165)][_0x12e1c1(0x18b)]();_0x26dd5c['json']({'success':!![],'result':{..._0x16f28e,'description':'Rapyd\x20automatic\x20status\x20checking\x20service','statusMapping':{'paid:\x20true':'PAID','paid:\x20false\x20+\x20CAN':_0x12e1c1(0x17a),'paid:\x20false\x20+\x20ERR':_0x12e1c1(0x17a),'paid:\x20false\x20+\x20EXP':_0x12e1c1(0x1a1),'paid:\x20false\x20+\x20other':_0x12e1c1(0x133)},'checkSchedule':'Payments\x20are\x20checked\x20after\x2030\x20minutes\x20and\x2060\x20minutes,\x20then\x20forgotten','note':_0x12e1c1(0x13a)}});}catch(_0x2f0287){_0x26dd5c[_0x12e1c1(0x167)](0x1f4)[_0x12e1c1(0x16a)]({'success':![],'message':_0x12e1c1(0x146)});}}),router['get'](a19_0x1e79ef(0x1b0),async(_0x2d439c,_0x4d08c3)=>{const _0x43ef53=a19_0x1e79ef;try{const {paymentId:_0x314aef}=_0x2d439c['params'],_0x36ebce=await database_1['default'][_0x43ef53(0x143)][_0x43ef53(0x170)]({'where':{'id':_0x314aef},'include':{'shop':{'select':{'id':!![],'name':!![],'username':!![]}}}});if(!_0x36ebce)return _0x4d08c3[_0x43ef53(0x167)](0x194)[_0x43ef53(0x16a)]({'success':![],'message':_0x43ef53(0x168)});const _0x18555f=rapydStatusService_1[_0x43ef53(0x165)][_0x43ef53(0x162)](_0x314aef);_0x4d08c3[_0x43ef53(0x16a)]({'success':!![],'result':{'payment':{'id':_0x36ebce['id'],'gateway':_0x36ebce[_0x43ef53(0x17e)],'gatewayPaymentId':_0x36ebce[_0x43ef53(0x1a4)],'status':_0x36ebce['status'],'amount':_0x36ebce[_0x43ef53(0x13e)],'currency':_0x36ebce[_0x43ef53(0x177)],'createdAt':_0x36ebce['createdAt'],'updatedAt':_0x36ebce['updatedAt'],'shop':_0x36ebce[_0x43ef53(0x17b)]},'timers':_0x18555f,'isRapyd':_0x36ebce[_0x43ef53(0x17e)]==='rapyd','ageInMinutes':Math['floor']((Date[_0x43ef53(0x1b1)]()-_0x36ebce[_0x43ef53(0x1aa)][_0x43ef53(0x184)]())/(0x3e8*0x3c)),'nextCheck':_0x18555f[_0x43ef53(0x14d)]?Math[_0x43ef53(0x1ad)]((Date[_0x43ef53(0x1b1)]()-_0x36ebce[_0x43ef53(0x1aa)][_0x43ef53(0x184)]())/(0x3e8*0x3c))<0x1e?0x1e-Math[_0x43ef53(0x1ad)]((Date[_0x43ef53(0x1b1)]()-_0x36ebce[_0x43ef53(0x1aa)][_0x43ef53(0x184)]())/(0x3e8*0x3c))+_0x43ef53(0x163):Math[_0x43ef53(0x1ad)]((Date[_0x43ef53(0x1b1)]()-_0x36ebce[_0x43ef53(0x1aa)][_0x43ef53(0x184)]())/(0x3e8*0x3c))<0x3c?0x3c-Math['floor']((Date[_0x43ef53(0x1b1)]()-_0x36ebce['createdAt']['getTime']())/(0x3e8*0x3c))+_0x43ef53(0x163):_0x43ef53(0x178):_0x43ef53(0x134)}});}catch(_0xfce638){_0x4d08c3[_0x43ef53(0x167)](0x1f4)[_0x43ef53(0x16a)]({'success':![],'message':_0xfce638 instanceof Error?_0xfce638['message']:_0x43ef53(0x166)});}}),router[a19_0x1e79ef(0x1a2)](a19_0x1e79ef(0x148),(_0x3b65e0,_0x55d2e7)=>{const _0x1492c1=a19_0x1e79ef;try{const _0x13d380=domainMonitoringService_1[_0x1492c1(0x17f)][_0x1492c1(0x149)]();_0x55d2e7[_0x1492c1(0x16a)]({'success':!![],'result':{..._0x13d380,'description':_0x1492c1(0x193),'behavior':_0x1492c1(0x131),'encoding':_0x1492c1(0x16e)}});}catch(_0x19e105){_0x55d2e7[_0x1492c1(0x167)](0x1f4)[_0x1492c1(0x16a)]({'success':![],'message':_0x1492c1(0x158)});}}),router[a19_0x1e79ef(0x199)]('/domain-monitoring/check',async(_0x174874,_0x4380bd)=>{const _0x2b78bb=a19_0x1e79ef;try{const _0x5cad53=await domainMonitoringService_1['domainMonitoringService'][_0x2b78bb(0x1a3)]();_0x4380bd[_0x2b78bb(0x16a)]({'success':!![],'result':{'domainAvailable':_0x5cad53,'message':_0x5cad53?'Domain\x20is\x20responding\x20correctly':_0x2b78bb(0x142),'timestamp':new Date()[_0x2b78bb(0x171)]()}});}catch(_0xa3d920){_0x4380bd[_0x2b78bb(0x167)](0x1f4)[_0x2b78bb(0x16a)]({'success':![],'message':_0xa3d920 instanceof Error?_0xa3d920['message']:_0x2b78bb(0x15a)});}}),exports[a19_0x1e79ef(0x14b)]=router;