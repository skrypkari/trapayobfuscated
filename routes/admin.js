'use strict';const a20_0x55e814=a20_0x546a;function a20_0x2a7f(){const _0x3a998e=['shop','/users/:id/suspend','getMerchantsSelection','validate','\x20days\x20if\x20not\x20paid','delete','body','now','writable','/cointopay/stats','getUsers','manualCheck','createUser','__esModule','/payout','floor','__createBinding','domainMonitoringService','configurable','amount','7660416vGRlYn','Router','14mYeSJD','/cointopay/payment/:paymentId','Failed\x20to\x20get\x20domain\x20monitoring\x20statistics','Old\x20logs\x20cleaned\x20(kept\x20last\x20','/merchant-statistics','963QIGiJg','\x20days)','../services/coinToPayStatusService','/payouts/:id','/payments','Failed\x20to\x20get\x20log\x20statistics','/payments/:id','22146751fRedYT','findUnique','hasOwnProperty','getUserById','then','../middleware/validation','createdAt','getOwnPropertyNames','AdminController','put','3wJbgRQ','loggerService','createPayoutSchema','Payments\x20automatically\x20expire\x20after\x20','getStatistics','express','get','create','/logs/clean','Failed\x20to\x20clean\x20old\x20logs','length','getLogStats','__importStar','EXPIRED','gatewayPaymentId','toISOString','Failed\x20to\x20check\x20CoinToPay\x20payment\x20status','977145eHYdna','‚ùå\x20[ADMIN]\x20Manual\x20CoinToPay\x20check\x20failed\x20for\x20payment\x20','updateCustomerDataSchema','defineProperty','activateUser','/users/:id','Requests\x20are\x20made\x20with\x20base64\x20encoded\x20URLs','requireAdmin','/payments/:id/customer','getPayoutById','Domain\x20is\x20responding\x20correctly','FAILED','/users','getMerchantsAwaitingPayout','deleteUser','prototype','updateCustomerData','üîç\x20[ADMIN]\x20Manual\x20CoinToPay\x20check\x20requested\x20for\x20payment:\x20','PENDING','getMonitoringStats','updatePayment','Failed\x20to\x20get\x20CoinToPay\x20service\x20statistics','paymentId','updatedAt','getTime','params','default','log','getPayouts','95vRUFKm','getPaymentById','CoinToPay\x20payment\x20status\x20checked\x20successfully','/domain-monitoring/stats','expiryDays','138652CllyoU','post','checkAuth','getMerchantStatistics','/users/:id/activate','../config/database','use','../middleware/auth','gateway','CoinToPay\x20automatic\x20status\x20checking\x20service','/domain-monitoring/check','getPayoutStats','Each\x20new\x20payment\x20gets\x20individual\x20timers:\x201min,\x202min,\x207min,\x2012min,\x20then\x20hourly','message','getOwnPropertyDescriptor','57730gUrZEI','218198jgoQvd','status','Domain\x20monitoring\x20service\x20for\x20amaterasy884.icu','1528500OGHNEq','createUserSchema','Domain\x20check\x20failed','Failed\x20to\x20get\x20payment\x20information','../services/loggerService','json','/merchants/selection','/payout/merchants','coinToPayStatusService'];a20_0x2a7f=function(){return _0x3a998e;};return a20_0x2a7f();}(function(_0x5f3195,_0x4691b2){const _0x48fcde=a20_0x546a,_0x4f8486=_0x5f3195();while(!![]){try{const _0x125a52=-parseInt(_0x48fcde(0x140))/0x1*(-parseInt(_0x48fcde(0x108))/0x2)+-parseInt(_0x48fcde(0x151))/0x3+-parseInt(_0x48fcde(0xf8))/0x4*(parseInt(_0x48fcde(0xf3))/0x5)+-parseInt(_0x48fcde(0x10b))/0x6*(parseInt(_0x48fcde(0x12a))/0x7)+-parseInt(_0x48fcde(0x128))/0x8+-parseInt(_0x48fcde(0x12f))/0x9*(-parseInt(_0x48fcde(0x107))/0xa)+parseInt(_0x48fcde(0x136))/0xb;if(_0x125a52===_0x4691b2)break;else _0x4f8486['push'](_0x4f8486['shift']());}catch(_0xc079b4){_0x4f8486['push'](_0x4f8486['shift']());}}}(a20_0x2a7f,0x7bc69));var __createBinding=this&&this[a20_0x55e814(0x124)]||(Object['create']?function(_0x219a60,_0x2a4baf,_0x20a62e,_0x2629da){const _0x529d3e=a20_0x55e814;if(_0x2629da===undefined)_0x2629da=_0x20a62e;var _0x494e3c=Object[_0x529d3e(0x106)](_0x2a4baf,_0x20a62e);(!_0x494e3c||('get'in _0x494e3c?!_0x2a4baf['__esModule']:_0x494e3c[_0x529d3e(0x11c)]||_0x494e3c[_0x529d3e(0x126)]))&&(_0x494e3c={'enumerable':!![],'get':function(){return _0x2a4baf[_0x20a62e];}}),Object[_0x529d3e(0x154)](_0x219a60,_0x2629da,_0x494e3c);}:function(_0x3e9d8a,_0x472fb5,_0x1676f1,_0x160955){if(_0x160955===undefined)_0x160955=_0x1676f1;_0x3e9d8a[_0x160955]=_0x472fb5[_0x1676f1];}),__setModuleDefault=this&&this['__setModuleDefault']||(Object[a20_0x55e814(0x147)]?function(_0x5ced61,_0x352b21){const _0x3c59d0=a20_0x55e814;Object[_0x3c59d0(0x154)](_0x5ced61,_0x3c59d0(0xf0),{'enumerable':!![],'value':_0x352b21});}:function(_0x19cf49,_0x1b1ad9){const _0x3111d9=a20_0x55e814;_0x19cf49[_0x3111d9(0xf0)]=_0x1b1ad9;}),__importStar=this&&this[a20_0x55e814(0x14c)]||(function(){var _0xd196be=function(_0x7787e6){const _0x3ec81a=a20_0x546a;return _0xd196be=Object[_0x3ec81a(0x13d)]||function(_0x46a391){const _0x535670=_0x3ec81a;var _0x4b6502=[];for(var _0x7d340c in _0x46a391)if(Object[_0x535670(0x160)][_0x535670(0x138)]['call'](_0x46a391,_0x7d340c))_0x4b6502[_0x4b6502[_0x535670(0x14a)]]=_0x7d340c;return _0x4b6502;},_0xd196be(_0x7787e6);};return function(_0x43d0e8){const _0x42f70a=a20_0x546a;if(_0x43d0e8&&_0x43d0e8[_0x42f70a(0x121)])return _0x43d0e8;var _0x465263={};if(_0x43d0e8!=null){for(var _0x13dc27=_0xd196be(_0x43d0e8),_0x45f58d=0x0;_0x45f58d<_0x13dc27[_0x42f70a(0x14a)];_0x45f58d++)if(_0x13dc27[_0x45f58d]!==_0x42f70a(0xf0))__createBinding(_0x465263,_0x43d0e8,_0x13dc27[_0x45f58d]);}return __setModuleDefault(_0x465263,_0x43d0e8),_0x465263;};}());function a20_0x546a(_0x569f82,_0x4efc48){const _0x2a7f1a=a20_0x2a7f();return a20_0x546a=function(_0x546a7c,_0x3d21f9){_0x546a7c=_0x546a7c-0xe9;let _0x13be09=_0x2a7f1a[_0x546a7c];return _0x13be09;},a20_0x546a(_0x569f82,_0x4efc48);}Object[a20_0x55e814(0x154)](exports,a20_0x55e814(0x121),{'value':!![]});const express_1=require(a20_0x55e814(0x145)),adminController_1=require('../controllers/adminController'),validation_1=require(a20_0x55e814(0x13b)),auth_1=require(a20_0x55e814(0xff)),loggerService_1=require(a20_0x55e814(0x10f)),coinToPayStatusService_1=require(a20_0x55e814(0x131)),domainMonitoringService_1=require('../services/domainMonitoringService'),router=(0x0,express_1[a20_0x55e814(0x129)])(),adminController=new adminController_1[(a20_0x55e814(0x13e))]();router[a20_0x55e814(0xfe)](auth_1['authenticateToken'],auth_1[a20_0x55e814(0x158)]),router[a20_0x55e814(0x146)]('/auth',adminController[a20_0x55e814(0xfa)]),router[a20_0x55e814(0x146)]('/statistics',adminController[a20_0x55e814(0x144)]),router[a20_0x55e814(0x146)](a20_0x55e814(0x12e),adminController[a20_0x55e814(0xfb)]),router['get']('/payout/stats',adminController[a20_0x55e814(0x103)]),router[a20_0x55e814(0x146)](a20_0x55e814(0x112),adminController[a20_0x55e814(0x15e)]),router['get'](a20_0x55e814(0x111),adminController[a20_0x55e814(0x116)]),router['post'](a20_0x55e814(0x122),(0x0,validation_1[a20_0x55e814(0x117)])(validation_1[a20_0x55e814(0x142)]),adminController['createPayout']),router['get']('/payouts',adminController[a20_0x55e814(0xf2)]),router[a20_0x55e814(0x146)](a20_0x55e814(0x132),adminController[a20_0x55e814(0x15a)]),router[a20_0x55e814(0x119)](a20_0x55e814(0x132),adminController['deletePayout']),router[a20_0x55e814(0x146)](a20_0x55e814(0x133),adminController['getPayments']),router['get']('/payments/:id',adminController[a20_0x55e814(0xf4)]),router[a20_0x55e814(0x13f)](a20_0x55e814(0x135),adminController[a20_0x55e814(0xea)]),router['put'](a20_0x55e814(0x159),(0x0,validation_1[a20_0x55e814(0x117)])(validation_1[a20_0x55e814(0x153)]),adminController[a20_0x55e814(0x161)]),router['get'](a20_0x55e814(0x15d),adminController[a20_0x55e814(0x11e)]),router['get'](a20_0x55e814(0x156),adminController[a20_0x55e814(0x139)]),router[a20_0x55e814(0xf9)](a20_0x55e814(0x15d),(0x0,validation_1[a20_0x55e814(0x117)])(validation_1[a20_0x55e814(0x10c)]),adminController[a20_0x55e814(0x120)]),router['put'](a20_0x55e814(0x156),(0x0,validation_1[a20_0x55e814(0x117)])(validation_1['updateUserSchema']),adminController['updateUser']),router[a20_0x55e814(0x119)](a20_0x55e814(0x156),adminController[a20_0x55e814(0x15f)]),router[a20_0x55e814(0xf9)](a20_0x55e814(0x115),adminController['suspendUser']),router[a20_0x55e814(0xf9)](a20_0x55e814(0xfc),adminController[a20_0x55e814(0x155)]),router['get']('/logs/stats',(_0x3218d9,_0x3c098b)=>{const _0x5d9e17=a20_0x55e814;try{const _0x4fd580=loggerService_1[_0x5d9e17(0x141)][_0x5d9e17(0x14b)]();_0x3c098b['json']({'success':!![],'result':_0x4fd580});}catch(_0x138582){_0x3c098b['status'](0x1f4)[_0x5d9e17(0x110)]({'success':![],'message':_0x5d9e17(0x134)});}}),router[a20_0x55e814(0xf9)](a20_0x55e814(0x148),(_0x13f672,_0x52288b)=>{const _0x1d7049=a20_0x55e814;try{const {daysToKeep:daysToKeep=0x1e}=_0x13f672[_0x1d7049(0x11a)];loggerService_1[_0x1d7049(0x141)]['cleanOldLogs'](daysToKeep),_0x52288b[_0x1d7049(0x110)]({'success':!![],'message':_0x1d7049(0x12d)+daysToKeep+_0x1d7049(0x130)});}catch(_0x47142c){_0x52288b['status'](0x1f4)[_0x1d7049(0x110)]({'success':![],'message':_0x1d7049(0x149)});}}),router[a20_0x55e814(0xf9)]('/cointopay/check/:paymentId',async(_0x2ab832,_0x49d517)=>{const _0xc9f6d8=a20_0x55e814;try{const {paymentId:_0x3457e6}=_0x2ab832[_0xc9f6d8(0xef)];console[_0xc9f6d8(0xf1)](_0xc9f6d8(0x162)+_0x3457e6),await coinToPayStatusService_1[_0xc9f6d8(0x113)]['checkPaymentById'](_0x3457e6),_0x49d517[_0xc9f6d8(0x110)]({'success':!![],'message':_0xc9f6d8(0xf5)});}catch(_0x8773ac){console['error'](_0xc9f6d8(0x152)+_0x2ab832['params'][_0xc9f6d8(0xec)]+':',_0x8773ac),_0x49d517['status'](0x1f4)[_0xc9f6d8(0x110)]({'success':![],'message':_0x8773ac instanceof Error?_0x8773ac[_0xc9f6d8(0x105)]:_0xc9f6d8(0x150)});}}),router[a20_0x55e814(0x146)](a20_0x55e814(0x11d),(_0x382928,_0x1ee762)=>{const _0x40a199=a20_0x55e814;try{const _0x57114d=coinToPayStatusService_1[_0x40a199(0x113)]['getServiceStats']();_0x1ee762[_0x40a199(0x110)]({'success':!![],'result':{..._0x57114d,'description':_0x40a199(0x101),'statusMapping':{'Paid':'PAID','Awaiting\x20Fiat':_0x40a199(0x163),'waiting':_0x40a199(0x163),'expired':_0x40a199(0x14d),'failed':_0x40a199(0x15c)},'autoExpiryNote':_0x40a199(0x143)+_0x57114d[_0x40a199(0xf7)]+_0x40a199(0x118),'individualTimersNote':_0x40a199(0x104)}});}catch(_0x3a9bf1){_0x1ee762[_0x40a199(0x109)](0x1f4)['json']({'success':![],'message':_0x40a199(0xeb)});}}),router[a20_0x55e814(0x146)](a20_0x55e814(0x12b),async(_0x963f2b,_0x10d6e6)=>{const _0xe9f45b=a20_0x55e814;try{const {paymentId:_0x9adcd6}=_0x963f2b[_0xe9f45b(0xef)],_0x2a4abd=coinToPayStatusService_1['coinToPayStatusService']['getPaymentTimerInfo'](_0x9adcd6),_0xac73a2=(await Promise['resolve']()[_0xe9f45b(0x13a)](()=>__importStar(require(_0xe9f45b(0xfd)))))[_0xe9f45b(0xf0)],_0x3174ad=await _0xac73a2['payment'][_0xe9f45b(0x137)]({'where':{'id':_0x9adcd6},'select':{'id':!![],'gateway':!![],'gatewayPaymentId':!![],'status':!![],'amount':!![],'currency':!![],'createdAt':!![],'updatedAt':!![],'shopId':!![],'shop':{'select':{'name':!![],'username':!![]}}}});if(!_0x3174ad)return _0x10d6e6[_0xe9f45b(0x109)](0x194)['json']({'success':![],'message':'Payment\x20not\x20found'});_0x10d6e6[_0xe9f45b(0x110)]({'success':!![],'result':{'payment':{'id':_0x3174ad['id'],'gateway':_0x3174ad[_0xe9f45b(0x100)],'gatewayPaymentId':_0x3174ad[_0xe9f45b(0x14e)],'status':_0x3174ad[_0xe9f45b(0x109)],'amount':_0x3174ad[_0xe9f45b(0x127)],'currency':_0x3174ad['currency'],'createdAt':_0x3174ad['createdAt'],'updatedAt':_0x3174ad[_0xe9f45b(0xed)],'shop':_0x3174ad[_0xe9f45b(0x114)]},'timers':_0x2a4abd,'isCoinToPay':_0x3174ad[_0xe9f45b(0x100)]==='cointopay','ageInMinutes':Math[_0xe9f45b(0x123)]((Date[_0xe9f45b(0x11b)]()-_0x3174ad[_0xe9f45b(0x13c)][_0xe9f45b(0xee)]())/(0x3e8*0x3c))}});}catch(_0x4d5a41){_0x10d6e6['status'](0x1f4)[_0xe9f45b(0x110)]({'success':![],'message':_0x4d5a41 instanceof Error?_0x4d5a41[_0xe9f45b(0x105)]:_0xe9f45b(0x10e)});}}),router['get'](a20_0x55e814(0xf6),(_0x179bf5,_0x480060)=>{const _0x849b25=a20_0x55e814;try{const _0x2c1f77=domainMonitoringService_1[_0x849b25(0x125)][_0x849b25(0xe9)]();_0x480060[_0x849b25(0x110)]({'success':!![],'result':{..._0x2c1f77,'description':_0x849b25(0x10a),'behavior':'Server\x20crashes\x20if\x20domain\x20is\x20not\x20responding\x20after\x20consecutive\x20failures','encoding':_0x849b25(0x157)}});}catch(_0x5dbbd2){_0x480060[_0x849b25(0x109)](0x1f4)[_0x849b25(0x110)]({'success':![],'message':_0x849b25(0x12c)});}}),router[a20_0x55e814(0xf9)](a20_0x55e814(0x102),async(_0x5f349a,_0x4108a7)=>{const _0x339715=a20_0x55e814;try{const _0x1ef5e7=await domainMonitoringService_1[_0x339715(0x125)][_0x339715(0x11f)]();_0x4108a7[_0x339715(0x110)]({'success':!![],'result':{'domainAvailable':_0x1ef5e7,'message':_0x1ef5e7?_0x339715(0x15b):_0x339715(0x10d),'timestamp':new Date()[_0x339715(0x14f)]()}});}catch(_0x5eb08d){_0x4108a7[_0x339715(0x109)](0x1f4)['json']({'success':![],'message':_0x5eb08d instanceof Error?_0x5eb08d[_0x339715(0x105)]:'Failed\x20to\x20perform\x20manual\x20domain\x20check'});}}),exports[a20_0x55e814(0xf0)]=router;