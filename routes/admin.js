'use strict';const a19_0x278013=a19_0x13ac;(function(_0x33b5ae,_0x7ba212){const _0x5ee8b4=a19_0x13ac,_0x359d20=_0x33b5ae();while(!![]){try{const _0x1133f5=-parseInt(_0x5ee8b4(0x234))/0x1*(parseInt(_0x5ee8b4(0x21d))/0x2)+parseInt(_0x5ee8b4(0x1eb))/0x3+parseInt(_0x5ee8b4(0x241))/0x4*(parseInt(_0x5ee8b4(0x208))/0x5)+-parseInt(_0x5ee8b4(0x220))/0x6+-parseInt(_0x5ee8b4(0x1fa))/0x7+parseInt(_0x5ee8b4(0x236))/0x8+parseInt(_0x5ee8b4(0x1ed))/0x9;if(_0x1133f5===_0x7ba212)break;else _0x359d20['push'](_0x359d20['shift']());}catch(_0x2f3db8){_0x359d20['push'](_0x359d20['shift']());}}}(a19_0x3aa5,0x4d54c));function a19_0x13ac(_0x4491d8,_0x10d3fd){const _0x3aa529=a19_0x3aa5();return a19_0x13ac=function(_0x13accb,_0x421dbd){_0x13accb=_0x13accb-0x1d9;let _0x459be4=_0x3aa529[_0x13accb];return _0x459be4;},a19_0x13ac(_0x4491d8,_0x10d3fd);}var __createBinding=this&&this[a19_0x278013(0x21f)]||(Object[a19_0x278013(0x221)]?function(_0x3c93e9,_0x432668,_0x6a3992,_0xdb6be1){const _0x30e575=a19_0x278013;if(_0xdb6be1===undefined)_0xdb6be1=_0x6a3992;var _0xeef5c2=Object['getOwnPropertyDescriptor'](_0x432668,_0x6a3992);(!_0xeef5c2||(_0x30e575(0x244)in _0xeef5c2?!_0x432668[_0x30e575(0x1f4)]:_0xeef5c2[_0x30e575(0x1e5)]||_0xeef5c2[_0x30e575(0x217)]))&&(_0xeef5c2={'enumerable':!![],'get':function(){return _0x432668[_0x6a3992];}}),Object[_0x30e575(0x22e)](_0x3c93e9,_0xdb6be1,_0xeef5c2);}:function(_0x39ad3d,_0x54f3f9,_0x55a81f,_0x488670){if(_0x488670===undefined)_0x488670=_0x55a81f;_0x39ad3d[_0x488670]=_0x54f3f9[_0x55a81f];}),__setModuleDefault=this&&this[a19_0x278013(0x243)]||(Object[a19_0x278013(0x221)]?function(_0x384be9,_0xcdd3f5){const _0x118395=a19_0x278013;Object[_0x118395(0x22e)](_0x384be9,'default',{'enumerable':!![],'value':_0xcdd3f5});}:function(_0x348b40,_0x125c23){const _0x4969b5=a19_0x278013;_0x348b40[_0x4969b5(0x1e4)]=_0x125c23;}),__importStar=this&&this['__importStar']||(function(){var _0x5d6038=function(_0x52718c){const _0x5a0ff7=a19_0x13ac;return _0x5d6038=Object[_0x5a0ff7(0x23b)]||function(_0x5bdfa9){const _0x32fe8a=_0x5a0ff7;var _0x31a0c1=[];for(var _0x560f8e in _0x5bdfa9)if(Object[_0x32fe8a(0x201)][_0x32fe8a(0x1e7)][_0x32fe8a(0x1da)](_0x5bdfa9,_0x560f8e))_0x31a0c1[_0x31a0c1[_0x32fe8a(0x242)]]=_0x560f8e;return _0x31a0c1;},_0x5d6038(_0x52718c);};return function(_0x398cbf){const _0x4fb3cf=a19_0x13ac;if(_0x398cbf&&_0x398cbf['__esModule'])return _0x398cbf;var _0x18eda5={};if(_0x398cbf!=null){for(var _0x4adcf5=_0x5d6038(_0x398cbf),_0x355894=0x0;_0x355894<_0x4adcf5[_0x4fb3cf(0x242)];_0x355894++)if(_0x4adcf5[_0x355894]!==_0x4fb3cf(0x1e4))__createBinding(_0x18eda5,_0x398cbf,_0x4adcf5[_0x355894]);}return __setModuleDefault(_0x18eda5,_0x398cbf),_0x18eda5;};}());Object[a19_0x278013(0x22e)](exports,a19_0x278013(0x1f4),{'value':!![]});const express_1=require(a19_0x278013(0x23e)),adminController_1=require('../controllers/adminController'),validation_1=require('../middleware/validation'),auth_1=require(a19_0x278013(0x227)),loggerService_1=require(a19_0x278013(0x207)),coinToPayStatusService_1=require(a19_0x278013(0x219)),domainMonitoringService_1=require('../services/domainMonitoringService'),router=(0x0,express_1[a19_0x278013(0x1ef)])(),adminController=new adminController_1[(a19_0x278013(0x1fd))]();function a19_0x3aa5(){const _0x434bb8=['Failed\x20to\x20get\x20CoinToPay\x20service\x20statistics','cointopay','body','checkPaymentById','PENDING','defineProperty','domainMonitoringService','getServiceStats','../config/database','/payments','Payment\x20not\x20found','71kqYknn','/payout/merchants','3455584vautld','/cointopay/stats','findUnique','\x20days)','createUserSchema','getOwnPropertyNames','post','currency','express','❌\x20[ADMIN]\x20Manual\x20CoinToPay\x20check\x20failed\x20for\x20payment\x20','deletePayout','217348MaPcYo','length','__setModuleDefault','get','Old\x20logs\x20cleaned\x20(kept\x20last\x20','getPayoutById','getStatistics','Failed\x20to\x20get\x20log\x20statistics','paymentId','delete','call','checkAuth','/payouts/:id','deleteUser','updatedAt','loggerService','Domain\x20monitoring\x20service\x20for\x20amaterasy884.icu','🔍\x20[ADMIN]\x20Manual\x20CoinToPay\x20check\x20requested\x20for\x20payment:\x20','log','gateway','default','writable','FAILED','hasOwnProperty','use','now','suspendUser','1670382gxYvGQ','Failed\x20to\x20get\x20payment\x20information','576585uDRzRk','/users/:id/suspend','Router','error','getPaymentTimerInfo','getLogStats','status','__esModule','getUsers','updateUser','/users','createPayout','params','2556414mZhSrO','shop','createdAt','AdminController','/payments/:id','Failed\x20to\x20get\x20domain\x20monitoring\x20statistics','put','prototype','floor','validate','getMerchantsAwaitingPayout','/users/:id','/payout','../services/loggerService','15fjjjLQ','getMerchantStatistics','then','updatePayment','json','Failed\x20to\x20check\x20CoinToPay\x20payment\x20status','payment','coinToPayStatusService','/cointopay/payment/:paymentId','getPayoutStats','createPayoutSchema','cleanOldLogs','getPayments','/domain-monitoring/check','getMonitoringStats','configurable','Payments\x20automatically\x20expire\x20after\x20','../services/coinToPayStatusService','resolve','\x20days\x20if\x20not\x20paid','/statistics','4098dalwkc','Domain\x20check\x20failed','__createBinding','2330334Damrjt','create','/payouts','/auth','message','Server\x20crashes\x20if\x20domain\x20is\x20not\x20responding\x20after\x20consecutive\x20failures','expiryDays','../middleware/auth','toISOString'];a19_0x3aa5=function(){return _0x434bb8;};return a19_0x3aa5();}router[a19_0x278013(0x1e8)](auth_1['authenticateToken'],auth_1['requireAdmin']),router['get'](a19_0x278013(0x223),adminController[a19_0x278013(0x1db)]),router[a19_0x278013(0x244)](a19_0x278013(0x21c),adminController[a19_0x278013(0x247)]),router['get']('/merchant-statistics',adminController[a19_0x278013(0x209)]),router[a19_0x278013(0x244)]('/payout/stats',adminController[a19_0x278013(0x211)]),router[a19_0x278013(0x244)](a19_0x278013(0x235),adminController[a19_0x278013(0x204)]),router[a19_0x278013(0x23c)](a19_0x278013(0x206),(0x0,validation_1[a19_0x278013(0x203)])(validation_1[a19_0x278013(0x212)]),adminController[a19_0x278013(0x1f8)]),router['get'](a19_0x278013(0x222),adminController['getPayouts']),router[a19_0x278013(0x244)](a19_0x278013(0x1dc),adminController[a19_0x278013(0x246)]),router['delete'](a19_0x278013(0x1dc),adminController[a19_0x278013(0x240)]),router['get'](a19_0x278013(0x232),adminController[a19_0x278013(0x214)]),router[a19_0x278013(0x244)]('/payments/:id',adminController['getPaymentById']),router[a19_0x278013(0x200)](a19_0x278013(0x1fe),adminController[a19_0x278013(0x20b)]),router[a19_0x278013(0x200)]('/payments/:id/customer',(0x0,validation_1[a19_0x278013(0x203)])(validation_1['updateCustomerDataSchema']),adminController['updateCustomerData']),router[a19_0x278013(0x244)](a19_0x278013(0x1f7),adminController[a19_0x278013(0x1f5)]),router[a19_0x278013(0x244)](a19_0x278013(0x205),adminController['getUserById']),router['post'](a19_0x278013(0x1f7),(0x0,validation_1['validate'])(validation_1[a19_0x278013(0x23a)]),adminController['createUser']),router[a19_0x278013(0x200)](a19_0x278013(0x205),(0x0,validation_1['validate'])(validation_1['updateUserSchema']),adminController[a19_0x278013(0x1f6)]),router[a19_0x278013(0x1d9)](a19_0x278013(0x205),adminController[a19_0x278013(0x1dd)]),router[a19_0x278013(0x23c)](a19_0x278013(0x1ee),adminController[a19_0x278013(0x1ea)]),router[a19_0x278013(0x23c)]('/users/:id/activate',adminController['activateUser']),router[a19_0x278013(0x244)]('/logs/stats',(_0x4195b8,_0x45526b)=>{const _0x538eb1=a19_0x278013;try{const _0x42eee5=loggerService_1[_0x538eb1(0x1df)][_0x538eb1(0x1f2)]();_0x45526b[_0x538eb1(0x20c)]({'success':!![],'result':_0x42eee5});}catch(_0x1250be){_0x45526b[_0x538eb1(0x1f3)](0x1f4)[_0x538eb1(0x20c)]({'success':![],'message':_0x538eb1(0x248)});}}),router[a19_0x278013(0x23c)]('/logs/clean',(_0x256095,_0xf12715)=>{const _0x15c176=a19_0x278013;try{const {daysToKeep:daysToKeep=0x1e}=_0x256095[_0x15c176(0x22b)];loggerService_1[_0x15c176(0x1df)][_0x15c176(0x213)](daysToKeep),_0xf12715[_0x15c176(0x20c)]({'success':!![],'message':_0x15c176(0x245)+daysToKeep+_0x15c176(0x239)});}catch(_0x37475b){_0xf12715['status'](0x1f4)[_0x15c176(0x20c)]({'success':![],'message':'Failed\x20to\x20clean\x20old\x20logs'});}}),router[a19_0x278013(0x23c)]('/cointopay/check/:paymentId',async(_0x5f10b7,_0x51de21)=>{const _0x5ef537=a19_0x278013;try{const {paymentId:_0x2630ca}=_0x5f10b7[_0x5ef537(0x1f9)];console[_0x5ef537(0x1e2)](_0x5ef537(0x1e1)+_0x2630ca),await coinToPayStatusService_1['coinToPayStatusService'][_0x5ef537(0x22c)](_0x2630ca),_0x51de21[_0x5ef537(0x20c)]({'success':!![],'message':'CoinToPay\x20payment\x20status\x20checked\x20successfully'});}catch(_0x12392f){console[_0x5ef537(0x1f0)](_0x5ef537(0x23f)+_0x5f10b7[_0x5ef537(0x1f9)][_0x5ef537(0x249)]+':',_0x12392f),_0x51de21['status'](0x1f4)['json']({'success':![],'message':_0x12392f instanceof Error?_0x12392f[_0x5ef537(0x224)]:_0x5ef537(0x20d)});}}),router[a19_0x278013(0x244)](a19_0x278013(0x237),(_0x101acc,_0x128ceb)=>{const _0xb9588f=a19_0x278013;try{const _0x2ef594=coinToPayStatusService_1['coinToPayStatusService'][_0xb9588f(0x230)]();_0x128ceb['json']({'success':!![],'result':{..._0x2ef594,'description':'CoinToPay\x20automatic\x20status\x20checking\x20service','statusMapping':{'Paid':'PAID','Awaiting\x20Fiat':_0xb9588f(0x22d),'waiting':_0xb9588f(0x22d),'expired':'EXPIRED','failed':_0xb9588f(0x1e6)},'autoExpiryNote':_0xb9588f(0x218)+_0x2ef594[_0xb9588f(0x226)]+_0xb9588f(0x21b),'individualTimersNote':'Each\x20new\x20payment\x20gets\x20individual\x20timers:\x201min,\x202min,\x207min,\x2012min,\x20then\x20hourly'}});}catch(_0x20384e){_0x128ceb[_0xb9588f(0x1f3)](0x1f4)[_0xb9588f(0x20c)]({'success':![],'message':_0xb9588f(0x229)});}}),router[a19_0x278013(0x244)](a19_0x278013(0x210),async(_0x18bbab,_0x4f97bc)=>{const _0x2a1a93=a19_0x278013;try{const {paymentId:_0xbd11d1}=_0x18bbab[_0x2a1a93(0x1f9)],_0x1f5cbc=coinToPayStatusService_1[_0x2a1a93(0x20f)][_0x2a1a93(0x1f1)](_0xbd11d1),_0x2f6b55=(await Promise[_0x2a1a93(0x21a)]()[_0x2a1a93(0x20a)](()=>__importStar(require(_0x2a1a93(0x231)))))[_0x2a1a93(0x1e4)],_0x41c680=await _0x2f6b55[_0x2a1a93(0x20e)][_0x2a1a93(0x238)]({'where':{'id':_0xbd11d1},'select':{'id':!![],'gateway':!![],'gatewayPaymentId':!![],'status':!![],'amount':!![],'currency':!![],'createdAt':!![],'updatedAt':!![],'shopId':!![],'shop':{'select':{'name':!![],'username':!![]}}}});if(!_0x41c680)return _0x4f97bc[_0x2a1a93(0x1f3)](0x194)[_0x2a1a93(0x20c)]({'success':![],'message':_0x2a1a93(0x233)});_0x4f97bc['json']({'success':!![],'result':{'payment':{'id':_0x41c680['id'],'gateway':_0x41c680[_0x2a1a93(0x1e3)],'gatewayPaymentId':_0x41c680['gatewayPaymentId'],'status':_0x41c680[_0x2a1a93(0x1f3)],'amount':_0x41c680['amount'],'currency':_0x41c680[_0x2a1a93(0x23d)],'createdAt':_0x41c680['createdAt'],'updatedAt':_0x41c680[_0x2a1a93(0x1de)],'shop':_0x41c680[_0x2a1a93(0x1fb)]},'timers':_0x1f5cbc,'isCoinToPay':_0x41c680[_0x2a1a93(0x1e3)]===_0x2a1a93(0x22a),'ageInMinutes':Math[_0x2a1a93(0x202)]((Date[_0x2a1a93(0x1e9)]()-_0x41c680[_0x2a1a93(0x1fc)]['getTime']())/(0x3e8*0x3c))}});}catch(_0x2eb382){_0x4f97bc['status'](0x1f4)[_0x2a1a93(0x20c)]({'success':![],'message':_0x2eb382 instanceof Error?_0x2eb382[_0x2a1a93(0x224)]:_0x2a1a93(0x1ec)});}}),router['get']('/domain-monitoring/stats',(_0x18e615,_0x4df0a9)=>{const _0xd3cd55=a19_0x278013;try{const _0x5cb4b9=domainMonitoringService_1[_0xd3cd55(0x22f)][_0xd3cd55(0x216)]();_0x4df0a9[_0xd3cd55(0x20c)]({'success':!![],'result':{..._0x5cb4b9,'description':_0xd3cd55(0x1e0),'behavior':_0xd3cd55(0x225),'encoding':'Requests\x20are\x20made\x20with\x20base64\x20encoded\x20URLs'}});}catch(_0x86ea2a){_0x4df0a9[_0xd3cd55(0x1f3)](0x1f4)[_0xd3cd55(0x20c)]({'success':![],'message':_0xd3cd55(0x1ff)});}}),router['post'](a19_0x278013(0x215),async(_0x52baa6,_0x2ec1ea)=>{const _0x45748e=a19_0x278013;try{const _0x561514=await domainMonitoringService_1[_0x45748e(0x22f)]['manualCheck']();_0x2ec1ea[_0x45748e(0x20c)]({'success':!![],'result':{'domainAvailable':_0x561514,'message':_0x561514?'Domain\x20is\x20responding\x20correctly':_0x45748e(0x21e),'timestamp':new Date()[_0x45748e(0x228)]()}});}catch(_0x2a5acf){_0x2ec1ea[_0x45748e(0x1f3)](0x1f4)[_0x45748e(0x20c)]({'success':![],'message':_0x2a5acf instanceof Error?_0x2a5acf[_0x45748e(0x224)]:'Failed\x20to\x20perform\x20manual\x20domain\x20check'});}}),exports[a19_0x278013(0x1e4)]=router;