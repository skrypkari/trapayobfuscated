'use strict';function a24_0x2a96(){const _0x370366=['log','‚ùå\x20[ADMIN]\x20Manual\x20CoinToPay\x20check\x20failed\x20for\x20payment\x20','/auth','PENDING','607088OxcJYC','currency','use','getLogStats','EXPIRED','4571973qmSopZ','default','/payouts','validate','Failed\x20to\x20get\x20domain\x20monitoring\x20statistics','/logs/clean','now','updatedAt','getUsers','call','cleanupStalePendingPayments','Failed\x20to\x20get\x20payment\x20information','getPayoutStats','Failed\x20to\x20get\x20CoinToPay\x20service\x20statistics','paymentId','/payments','length','Failed\x20to\x20clean\x20old\x20logs','get','resolve','/cointopay/payment/:paymentId','/cointopay/check/:paymentId','__setModuleDefault','defineProperty','\x20days)','getOwnPropertyNames','createUser','configurable','/logs/stats','Requests\x20are\x20made\x20with\x20base64\x20encoded\x20URLs','body','/payouts/:id','3912942bczviO','/statistics','50dJOvXh','getMerchantStatistics','getOwnPropertyDescriptor','/payments/cleanup-with-report','coinToPayStatusService','shop','/payments/:id/customer','amount','createUserSchema','put','getPaymentById','toISOString','createPayout','gateway','getUserById','createPayoutSchema','checkAuth','üîç\x20[ADMIN]\x20Manual\x20CoinToPay\x20check\x20requested\x20for\x20payment:\x20','suspendUser','domainMonitoringService','getMerchantsAwaitingPayout','payment','52369KuWPwI','CoinToPay\x20payment\x20status\x20checked\x20successfully','getProcessingPaymentsStats','Server\x20crashes\x20if\x20domain\x20is\x20not\x20responding\x20after\x20consecutive\x20failures','/cointopay/stats','FAILED','/payout/merchants','create','getPaymentTimerInfo','12VFLkpK','Failed\x20to\x20get\x20log\x20statistics','deletePayout','/payments/cleanup','Payment\x20not\x20found','Each\x20new\x20payment\x20gets\x20individual\x20timers:\x201min,\x202min,\x207min,\x2012min,\x20then\x20hourly','3028900vZyLPK','createdAt','/merchant-statistics','__importStar','/payments/:id','8SRFTKH','prototype','updateCustomerData','../middleware/auth','getPayouts','status','/domain-monitoring/check','getTime','then','__createBinding','cleanupStalePayments','__esModule','Domain\x20monitoring\x20service\x20for\x20amaterasy884.icu','gatewayPaymentId','authenticateToken','post','loggerService','AdminController','getServiceStats','/users/:id/activate','floor','/payout','message','CoinToPay\x20automatic\x20status\x20checking\x20service','/payout/stats','params','findUnique','Payments\x20automatically\x20expire\x20after\x20','delete','/users/:id','../controllers/adminController','/merchants/selection','14HZoNiK','1448988Ruxvsb','Old\x20logs\x20cleaned\x20(kept\x20last\x20','1035400ZenkDn','cointopay','json','Domain\x20is\x20responding\x20correctly','manualCheck','requireAdmin','expiryDays','/users'];a24_0x2a96=function(){return _0x370366;};return a24_0x2a96();}const a24_0x304358=a24_0x3e5e;(function(_0x3cbe0d,_0x4a09dc){const _0x4d245e=a24_0x3e5e,_0x374d7f=_0x3cbe0d();while(!![]){try{const _0x4b2cd7=-parseInt(_0x4d245e(0x120))/0x1*(-parseInt(_0x4d245e(0xd4))/0x2)+parseInt(_0x4d245e(0xd5))/0x3+-parseInt(_0x4d245e(0xe3))/0x4+parseInt(_0x4d245e(0xd7))/0x5*(parseInt(_0x4d245e(0xa9))/0x6)+parseInt(_0x4d245e(0xaf))/0x7+parseInt(_0x4d245e(0xb4))/0x8*(parseInt(_0x4d245e(0xe8))/0x9)+-parseInt(_0x4d245e(0x10a))/0xa*(parseInt(_0x4d245e(0x108))/0xb);if(_0x4b2cd7===_0x4a09dc)break;else _0x374d7f['push'](_0x374d7f['shift']());}catch(_0x3d1592){_0x374d7f['push'](_0x374d7f['shift']());}}}(a24_0x2a96,0x42e86));function a24_0x3e5e(_0x4ff6a1,_0x2d3114){_0x4ff6a1=_0x4ff6a1-0xa6;const _0x2a96cc=a24_0x2a96();let _0x3e5e07=_0x2a96cc[_0x4ff6a1];return _0x3e5e07;}var __createBinding=this&&this[a24_0x304358(0xbd)]||(Object['create']?function(_0x65876a,_0x43ff68,_0x5c118f,_0x369fbe){const _0x3b07c2=a24_0x304358;if(_0x369fbe===undefined)_0x369fbe=_0x5c118f;var _0x20abd2=Object[_0x3b07c2(0x10c)](_0x43ff68,_0x5c118f);(!_0x20abd2||(_0x3b07c2(0xfa)in _0x20abd2?!_0x43ff68[_0x3b07c2(0xbf)]:_0x20abd2['writable']||_0x20abd2[_0x3b07c2(0x103)]))&&(_0x20abd2={'enumerable':!![],'get':function(){return _0x43ff68[_0x5c118f];}}),Object[_0x3b07c2(0xff)](_0x65876a,_0x369fbe,_0x20abd2);}:function(_0x5196ba,_0x348226,_0x3d0d2f,_0x83567c){if(_0x83567c===undefined)_0x83567c=_0x3d0d2f;_0x5196ba[_0x83567c]=_0x348226[_0x3d0d2f];}),__setModuleDefault=this&&this[a24_0x304358(0xfe)]||(Object[a24_0x304358(0xa7)]?function(_0x40c0ba,_0x34e43a){const _0x4e11f0=a24_0x304358;Object[_0x4e11f0(0xff)](_0x40c0ba,_0x4e11f0(0xe9),{'enumerable':!![],'value':_0x34e43a});}:function(_0x4ae4ca,_0x215a01){const _0x15d866=a24_0x304358;_0x4ae4ca[_0x15d866(0xe9)]=_0x215a01;}),__importStar=this&&this[a24_0x304358(0xb2)]||(function(){var _0x2e6049=function(_0x4d7a9b){const _0x4b44fd=a24_0x3e5e;return _0x2e6049=Object[_0x4b44fd(0x101)]||function(_0x52f7f8){const _0x5092f1=_0x4b44fd;var _0x3bd4bc=[];for(var _0x5d0698 in _0x52f7f8)if(Object[_0x5092f1(0xb5)]['hasOwnProperty'][_0x5092f1(0xf1)](_0x52f7f8,_0x5d0698))_0x3bd4bc[_0x3bd4bc[_0x5092f1(0xf8)]]=_0x5d0698;return _0x3bd4bc;},_0x2e6049(_0x4d7a9b);};return function(_0x36060f){const _0x30eb92=a24_0x3e5e;if(_0x36060f&&_0x36060f[_0x30eb92(0xbf)])return _0x36060f;var _0x40af67={};if(_0x36060f!=null){for(var _0x19a397=_0x2e6049(_0x36060f),_0x1e6c68=0x0;_0x1e6c68<_0x19a397[_0x30eb92(0xf8)];_0x1e6c68++)if(_0x19a397[_0x1e6c68]!==_0x30eb92(0xe9))__createBinding(_0x40af67,_0x36060f,_0x19a397[_0x1e6c68]);}return __setModuleDefault(_0x40af67,_0x36060f),_0x40af67;};}());Object['defineProperty'](exports,'__esModule',{'value':!![]});const express_1=require('express'),adminController_1=require(a24_0x304358(0xd2)),validation_1=require('../middleware/validation'),auth_1=require(a24_0x304358(0xb7)),loggerService_1=require('../services/loggerService'),coinToPayStatusService_1=require('../services/coinToPayStatusService'),domainMonitoringService_1=require('../services/domainMonitoringService'),router=(0x0,express_1['Router'])(),adminController=new adminController_1[(a24_0x304358(0xc5))]();router[a24_0x304358(0xe5)](auth_1[a24_0x304358(0xc2)],auth_1[a24_0x304358(0xdc)]),router[a24_0x304358(0xfa)](a24_0x304358(0xe1),adminController[a24_0x304358(0x11a)]),router[a24_0x304358(0xfa)](a24_0x304358(0x109),adminController['getStatistics']),router[a24_0x304358(0xfa)](a24_0x304358(0xb1),adminController[a24_0x304358(0x10b)]),router[a24_0x304358(0xfa)](a24_0x304358(0xcc),adminController[a24_0x304358(0xf4)]),router[a24_0x304358(0xfa)](a24_0x304358(0xa6),adminController[a24_0x304358(0x11e)]),router[a24_0x304358(0xfa)](a24_0x304358(0xd3),adminController['getMerchantsSelection']),router[a24_0x304358(0xc3)](a24_0x304358(0xc9),(0x0,validation_1[a24_0x304358(0xeb)])(validation_1[a24_0x304358(0x119)]),adminController[a24_0x304358(0x116)]),router[a24_0x304358(0xfa)](a24_0x304358(0xea),adminController[a24_0x304358(0xb8)]),router[a24_0x304358(0xfa)]('/payouts/:id',adminController['getPayoutById']),router[a24_0x304358(0xd0)](a24_0x304358(0x107),adminController[a24_0x304358(0xab)]),router[a24_0x304358(0xfa)](a24_0x304358(0xf7),adminController['getPayments']),router[a24_0x304358(0xfa)](a24_0x304358(0xb3),adminController[a24_0x304358(0x114)]),router[a24_0x304358(0x113)](a24_0x304358(0xb3),adminController['updatePayment']),router[a24_0x304358(0x113)](a24_0x304358(0x110),(0x0,validation_1[a24_0x304358(0xeb)])(validation_1['updateCustomerDataSchema']),adminController[a24_0x304358(0xb6)]),router[a24_0x304358(0xfa)]('/payments/processing-stats',adminController[a24_0x304358(0x122)]),router[a24_0x304358(0xc3)](a24_0x304358(0xac),adminController[a24_0x304358(0xbe)]),router[a24_0x304358(0xc3)]('/payments/cleanup-pending',adminController[a24_0x304358(0xf2)]),router[a24_0x304358(0xc3)](a24_0x304358(0x10d),adminController['cleanupStalePaymentsWithReport']),router[a24_0x304358(0xfa)](a24_0x304358(0xde),adminController[a24_0x304358(0xf0)]),router[a24_0x304358(0xfa)](a24_0x304358(0xd1),adminController[a24_0x304358(0x118)]),router[a24_0x304358(0xc3)]('/users',(0x0,validation_1[a24_0x304358(0xeb)])(validation_1[a24_0x304358(0x112)]),adminController[a24_0x304358(0x102)]),router['put'](a24_0x304358(0xd1),(0x0,validation_1[a24_0x304358(0xeb)])(validation_1['updateUserSchema']),adminController['updateUser']),router[a24_0x304358(0xd0)]('/users/:id',adminController['deleteUser']),router[a24_0x304358(0xc3)]('/users/:id/suspend',adminController[a24_0x304358(0x11c)]),router[a24_0x304358(0xc3)](a24_0x304358(0xc7),adminController['activateUser']),router[a24_0x304358(0xfa)](a24_0x304358(0x104),(_0xa2ba60,_0x23eda5)=>{const _0x1b921f=a24_0x304358;try{const _0x37bbe1=loggerService_1[_0x1b921f(0xc4)][_0x1b921f(0xe6)]();_0x23eda5[_0x1b921f(0xd9)]({'success':!![],'result':_0x37bbe1});}catch(_0x4ea094){_0x23eda5[_0x1b921f(0xb9)](0x1f4)[_0x1b921f(0xd9)]({'success':![],'message':_0x1b921f(0xaa)});}}),router[a24_0x304358(0xc3)](a24_0x304358(0xed),(_0x5c4793,_0x37c2b4)=>{const _0x444ed3=a24_0x304358;try{const {daysToKeep:daysToKeep=0x1e}=_0x5c4793[_0x444ed3(0x106)];loggerService_1[_0x444ed3(0xc4)]['cleanOldLogs'](daysToKeep),_0x37c2b4[_0x444ed3(0xd9)]({'success':!![],'message':_0x444ed3(0xd6)+daysToKeep+_0x444ed3(0x100)});}catch(_0x333345){_0x37c2b4[_0x444ed3(0xb9)](0x1f4)[_0x444ed3(0xd9)]({'success':![],'message':_0x444ed3(0xf9)});}}),router[a24_0x304358(0xc3)](a24_0x304358(0xfd),async(_0x10cc2e,_0x5c34f5)=>{const _0x23cbe2=a24_0x304358;try{const {paymentId:_0x34c774}=_0x10cc2e[_0x23cbe2(0xcd)];console[_0x23cbe2(0xdf)](_0x23cbe2(0x11b)+_0x34c774),await coinToPayStatusService_1[_0x23cbe2(0x10e)]['checkPaymentById'](_0x34c774),_0x5c34f5[_0x23cbe2(0xd9)]({'success':!![],'message':_0x23cbe2(0x121)});}catch(_0x305497){console['error'](_0x23cbe2(0xe0)+_0x10cc2e['params'][_0x23cbe2(0xf6)]+':',_0x305497),_0x5c34f5[_0x23cbe2(0xb9)](0x1f4)[_0x23cbe2(0xd9)]({'success':![],'message':_0x305497 instanceof Error?_0x305497[_0x23cbe2(0xca)]:'Failed\x20to\x20check\x20CoinToPay\x20payment\x20status'});}}),router[a24_0x304358(0xfa)](a24_0x304358(0x124),(_0xe594b,_0x49cb73)=>{const _0x43ea2=a24_0x304358;try{const _0x5ed7f1=coinToPayStatusService_1[_0x43ea2(0x10e)][_0x43ea2(0xc6)]();_0x49cb73[_0x43ea2(0xd9)]({'success':!![],'result':{..._0x5ed7f1,'description':_0x43ea2(0xcb),'statusMapping':{'Paid':'PAID','Awaiting\x20Fiat':_0x43ea2(0xe2),'waiting':'PENDING','expired':_0x43ea2(0xe7),'failed':_0x43ea2(0x125)},'autoExpiryNote':_0x43ea2(0xcf)+_0x5ed7f1[_0x43ea2(0xdd)]+'\x20days\x20if\x20not\x20paid','individualTimersNote':_0x43ea2(0xae)}});}catch(_0x3d816f){_0x49cb73[_0x43ea2(0xb9)](0x1f4)[_0x43ea2(0xd9)]({'success':![],'message':_0x43ea2(0xf5)});}}),router[a24_0x304358(0xfa)](a24_0x304358(0xfc),async(_0x116128,_0x1b1509)=>{const _0x413198=a24_0x304358;try{const {paymentId:_0x4bca9e}=_0x116128['params'],_0x15e841=coinToPayStatusService_1['coinToPayStatusService'][_0x413198(0xa8)](_0x4bca9e),_0x4b9334=(await Promise[_0x413198(0xfb)]()[_0x413198(0xbc)](()=>__importStar(require('../config/database'))))[_0x413198(0xe9)],_0x1ed845=await _0x4b9334[_0x413198(0x11f)][_0x413198(0xce)]({'where':{'id':_0x4bca9e},'select':{'id':!![],'gateway':!![],'gatewayPaymentId':!![],'status':!![],'amount':!![],'currency':!![],'createdAt':!![],'updatedAt':!![],'shopId':!![],'shop':{'select':{'name':!![],'username':!![]}}}});if(!_0x1ed845)return _0x1b1509['status'](0x194)[_0x413198(0xd9)]({'success':![],'message':_0x413198(0xad)});_0x1b1509[_0x413198(0xd9)]({'success':!![],'result':{'payment':{'id':_0x1ed845['id'],'gateway':_0x1ed845[_0x413198(0x117)],'gatewayPaymentId':_0x1ed845[_0x413198(0xc1)],'status':_0x1ed845[_0x413198(0xb9)],'amount':_0x1ed845[_0x413198(0x111)],'currency':_0x1ed845[_0x413198(0xe4)],'createdAt':_0x1ed845[_0x413198(0xb0)],'updatedAt':_0x1ed845[_0x413198(0xef)],'shop':_0x1ed845[_0x413198(0x10f)]},'timers':_0x15e841,'isCoinToPay':_0x1ed845[_0x413198(0x117)]===_0x413198(0xd8),'ageInMinutes':Math[_0x413198(0xc8)]((Date[_0x413198(0xee)]()-_0x1ed845[_0x413198(0xb0)][_0x413198(0xbb)]())/(0x3e8*0x3c))}});}catch(_0x1843a3){_0x1b1509[_0x413198(0xb9)](0x1f4)[_0x413198(0xd9)]({'success':![],'message':_0x1843a3 instanceof Error?_0x1843a3[_0x413198(0xca)]:_0x413198(0xf3)});}}),router[a24_0x304358(0xfa)]('/domain-monitoring/stats',(_0x38f5d2,_0x2e6325)=>{const _0x4b00e1=a24_0x304358;try{const _0x561426=domainMonitoringService_1[_0x4b00e1(0x11d)]['getMonitoringStats']();_0x2e6325['json']({'success':!![],'result':{..._0x561426,'description':_0x4b00e1(0xc0),'behavior':_0x4b00e1(0x123),'encoding':_0x4b00e1(0x105)}});}catch(_0x12792b){_0x2e6325['status'](0x1f4)[_0x4b00e1(0xd9)]({'success':![],'message':_0x4b00e1(0xec)});}}),router[a24_0x304358(0xc3)](a24_0x304358(0xba),async(_0x13871d,_0x547728)=>{const _0x509524=a24_0x304358;try{const _0x252e10=await domainMonitoringService_1[_0x509524(0x11d)][_0x509524(0xdb)]();_0x547728[_0x509524(0xd9)]({'success':!![],'result':{'domainAvailable':_0x252e10,'message':_0x252e10?_0x509524(0xda):'Domain\x20check\x20failed','timestamp':new Date()[_0x509524(0x115)]()}});}catch(_0x4453b0){_0x547728[_0x509524(0xb9)](0x1f4)['json']({'success':![],'message':_0x4453b0 instanceof Error?_0x4453b0[_0x509524(0xca)]:'Failed\x20to\x20perform\x20manual\x20domain\x20check'});}}),exports['default']=router;