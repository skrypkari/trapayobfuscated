'use strict';const a19_0x41308a=a19_0x43d3;(function(_0x396279,_0x1734e4){const _0x363ec3=a19_0x43d3,_0x4eb3d7=_0x396279();while(!![]){try{const _0x75095e=parseInt(_0x363ec3(0x1b2))/0x1+parseInt(_0x363ec3(0x1af))/0x2*(-parseInt(_0x363ec3(0x1d7))/0x3)+-parseInt(_0x363ec3(0x1eb))/0x4+parseInt(_0x363ec3(0x191))/0x5*(parseInt(_0x363ec3(0x1da))/0x6)+parseInt(_0x363ec3(0x1be))/0x7*(-parseInt(_0x363ec3(0x1ba))/0x8)+-parseInt(_0x363ec3(0x215))/0x9+parseInt(_0x363ec3(0x1db))/0xa;if(_0x75095e===_0x1734e4)break;else _0x4eb3d7['push'](_0x4eb3d7['shift']());}catch(_0x4874a3){_0x4eb3d7['push'](_0x4eb3d7['shift']());}}}(a19_0x24d9,0x44cc7));function a19_0x24d9(){const _0x16ce1b=['prototype','/merchant-statistics','/payouts','toISOString','findUnique','loggerService','Old\x20logs\x20cleaned\x20(kept\x20last\x20','/cointopay/stats','defineProperty','1099356PulplZ','AdminController','FAILED','/cointopay/payment/:paymentId','createdAt','checkAuth','activateUser','Failed\x20to\x20get\x20CoinToPay\x20service\x20statistics','manualCheck','deletePayout','cleanOldLogs','hasTimers','/domain-monitoring/check','length','paymentId','../middleware/auth','getTime','Failed\x20to\x20check\x20CoinToPay\x20payment\x20status','amount','getMerchantsAwaitingPayout','Failed\x20to\x20perform\x20manual\x20domain\x20check','getMerchantStatistics','post','cointopay','validate','create','json','üîç\x20[ADMIN]\x20Manual\x20Rapyd\x20check\x20requested\x20for\x20payment:\x20','Router','PENDING','getLogStats','updatedAt','getUserById','/logs/clean','writable','put','Failed\x20to\x20clean\x20old\x20logs','expiryDays','No\x20more\x20checks\x20scheduled','/payments/:id/customer','gatewayPaymentId','/rapyd/check/:paymentId','5050395aQUkZK','../services/domainMonitoringService','‚ùå\x20[ADMIN]\x20Manual\x20CoinToPay\x20check\x20failed\x20for\x20payment\x20','getMonitoringStats','Each\x20new\x20payment\x20gets\x20individual\x20timers:\x201min,\x202min,\x207min,\x2012min,\x20then\x20hourly','../controllers/adminController','/payout/merchants','gateway','default','get','5OdPSCG','suspendUser','CoinToPay\x20automatic\x20status\x20checking\x20service','CoinToPay\x20payment\x20status\x20checked\x20successfully','express','__createBinding','/users','Server\x20crashes\x20if\x20domain\x20is\x20not\x20responding\x20after\x20consecutive\x20failures','currency','‚ùå\x20[ADMIN]\x20Manual\x20Rapyd\x20check\x20failed\x20for\x20payment\x20','call','payment','/statistics','shop','log','delete','/auth','authenticateToken','../config/database','requireAdmin','use','getUsers','../services/loggerService','\x20days)','__importDefault','hasOwnProperty','Failed\x20to\x20get\x20payment\x20information','Requests\x20are\x20made\x20with\x20base64\x20encoded\x20URLs','Domain\x20monitoring\x20service\x20for\x20amaterasy884.icu','__setModuleDefault','419086jSjBtz','/payout/stats','coinToPayStatusService','309405bLmGlf','__esModule','rapydStatusService','\x20minutes','/payments/:id','EXPIRED','Domain\x20is\x20responding\x20correctly','getOwnPropertyNames','997856XBbIgN','message','../services/rapydStatusService','/rapyd/payment/:paymentId','14SoljRg','Payment\x20not\x20found','/rapyd/stats','updatePayment','domainMonitoringService','/users/:id/activate','üîç\x20[ADMIN]\x20Manual\x20CoinToPay\x20check\x20requested\x20for\x20payment:\x20','Failed\x20to\x20get\x20domain\x20monitoring\x20statistics','../services/coinToPayStatusService','Only\x20checks\x20payments\x20with\x20status\x20PENDING\x20at\x20check\x20time','/merchants/selection','/users/:id','updateCustomerData','checkPaymentById','params','status','updateUserSchema','Failed\x20to\x20get\x20Rapyd\x20service\x20statistics','/payouts/:id','getPaymentTimerInfo','createPayout','PAID','now','getPayouts','Failed\x20to\x20get\x20log\x20statistics','6OyiiKC','getPayoutById','body','41748CIaNwU','14699800ZFOBrZ','/logs/stats','floor','resolve','createPayoutSchema','/payout','No\x20checks\x20scheduled'];a19_0x24d9=function(){return _0x16ce1b;};return a19_0x24d9();}function a19_0x43d3(_0x534cd1,_0x5848a3){const _0x24d9bd=a19_0x24d9();return a19_0x43d3=function(_0x43d3fe,_0xb5570d){_0x43d3fe=_0x43d3fe-0x188;let _0x5b3460=_0x24d9bd[_0x43d3fe];return _0x5b3460;},a19_0x43d3(_0x534cd1,_0x5848a3);}var __createBinding=this&&this[a19_0x41308a(0x196)]||(Object[a19_0x41308a(0x204)]?function(_0x3d1f2c,_0x54ea07,_0x23997b,_0x536f29){const _0x3821b6=a19_0x41308a;if(_0x536f29===undefined)_0x536f29=_0x23997b;var _0x242ea8=Object['getOwnPropertyDescriptor'](_0x54ea07,_0x23997b);(!_0x242ea8||(_0x3821b6(0x190)in _0x242ea8?!_0x54ea07[_0x3821b6(0x1b3)]:_0x242ea8[_0x3821b6(0x20d)]||_0x242ea8['configurable']))&&(_0x242ea8={'enumerable':!![],'get':function(){return _0x54ea07[_0x23997b];}}),Object[_0x3821b6(0x1ea)](_0x3d1f2c,_0x536f29,_0x242ea8);}:function(_0x51147d,_0x189858,_0x2effed,_0xdc9ba5){if(_0xdc9ba5===undefined)_0xdc9ba5=_0x2effed;_0x51147d[_0xdc9ba5]=_0x189858[_0x2effed];}),__setModuleDefault=this&&this[a19_0x41308a(0x1ae)]||(Object[a19_0x41308a(0x204)]?function(_0x55625a,_0x3a88cf){const _0x3f8df2=a19_0x41308a;Object[_0x3f8df2(0x1ea)](_0x55625a,_0x3f8df2(0x18f),{'enumerable':!![],'value':_0x3a88cf});}:function(_0x294751,_0x3a2e2f){const _0x4939de=a19_0x41308a;_0x294751[_0x4939de(0x18f)]=_0x3a2e2f;}),__importStar=this&&this['__importStar']||(function(){var _0x19b71f=function(_0x2013fa){const _0x508a13=a19_0x43d3;return _0x19b71f=Object[_0x508a13(0x1b9)]||function(_0x48bc55){const _0x4c1a9e=_0x508a13;var _0x477fe8=[];for(var _0x5d1cc9 in _0x48bc55)if(Object[_0x4c1a9e(0x1e2)][_0x4c1a9e(0x1aa)][_0x4c1a9e(0x19b)](_0x48bc55,_0x5d1cc9))_0x477fe8[_0x477fe8[_0x4c1a9e(0x1f8)]]=_0x5d1cc9;return _0x477fe8;},_0x19b71f(_0x2013fa);};return function(_0x553f1b){const _0x30773d=a19_0x43d3;if(_0x553f1b&&_0x553f1b[_0x30773d(0x1b3)])return _0x553f1b;var _0x57028e={};if(_0x553f1b!=null){for(var _0x5f39ff=_0x19b71f(_0x553f1b),_0x39c38e=0x0;_0x39c38e<_0x5f39ff[_0x30773d(0x1f8)];_0x39c38e++)if(_0x5f39ff[_0x39c38e]!=='default')__createBinding(_0x57028e,_0x553f1b,_0x5f39ff[_0x39c38e]);}return __setModuleDefault(_0x57028e,_0x553f1b),_0x57028e;};}()),__importDefault=this&&this[a19_0x41308a(0x1a9)]||function(_0x128159){return _0x128159&&_0x128159['__esModule']?_0x128159:{'default':_0x128159};};Object[a19_0x41308a(0x1ea)](exports,a19_0x41308a(0x1b3),{'value':!![]});const express_1=require(a19_0x41308a(0x195)),adminController_1=require(a19_0x41308a(0x18c)),validation_1=require('../middleware/validation'),auth_1=require(a19_0x41308a(0x1fa)),loggerService_1=require(a19_0x41308a(0x1a7)),coinToPayStatusService_1=require(a19_0x41308a(0x1c6)),rapydStatusService_1=require(a19_0x41308a(0x1bc)),domainMonitoringService_1=require(a19_0x41308a(0x188)),database_1=__importDefault(require(a19_0x41308a(0x1a3))),router=(0x0,express_1[a19_0x41308a(0x207)])(),adminController=new adminController_1[(a19_0x41308a(0x1ec))]();router[a19_0x41308a(0x1a5)](auth_1[a19_0x41308a(0x1a2)],auth_1[a19_0x41308a(0x1a4)]),router[a19_0x41308a(0x190)](a19_0x41308a(0x1a1),adminController[a19_0x41308a(0x1f0)]),router[a19_0x41308a(0x190)](a19_0x41308a(0x19d),adminController['getStatistics']),router[a19_0x41308a(0x190)](a19_0x41308a(0x1e3),adminController[a19_0x41308a(0x200)]),router['get'](a19_0x41308a(0x1c8),adminController['getMerchantsSelection']),router[a19_0x41308a(0x190)](a19_0x41308a(0x1b0),adminController['getPayoutStats']),router[a19_0x41308a(0x190)](a19_0x41308a(0x18d),adminController[a19_0x41308a(0x1fe)]),router[a19_0x41308a(0x201)](a19_0x41308a(0x1e0),(0x0,validation_1['validate'])(validation_1[a19_0x41308a(0x1df)]),adminController[a19_0x41308a(0x1d2)]),router[a19_0x41308a(0x190)](a19_0x41308a(0x1e4),adminController[a19_0x41308a(0x1d5)]),router[a19_0x41308a(0x190)]('/payouts/:id',adminController[a19_0x41308a(0x1d8)]),router[a19_0x41308a(0x1a0)](a19_0x41308a(0x1d0),adminController[a19_0x41308a(0x1f4)]),router[a19_0x41308a(0x190)]('/payments',adminController['getPayments']),router[a19_0x41308a(0x190)]('/payments/:id',adminController['getPaymentById']),router[a19_0x41308a(0x20e)](a19_0x41308a(0x1b6),adminController[a19_0x41308a(0x1c1)]),router['put'](a19_0x41308a(0x212),(0x0,validation_1[a19_0x41308a(0x203)])(validation_1['updateCustomerDataSchema']),adminController[a19_0x41308a(0x1ca)]),router['get'](a19_0x41308a(0x197),adminController[a19_0x41308a(0x1a6)]),router[a19_0x41308a(0x190)](a19_0x41308a(0x1c9),adminController[a19_0x41308a(0x20b)]),router['post'](a19_0x41308a(0x197),(0x0,validation_1[a19_0x41308a(0x203)])(validation_1['createUserSchema']),adminController['createUser']),router[a19_0x41308a(0x20e)](a19_0x41308a(0x1c9),(0x0,validation_1[a19_0x41308a(0x203)])(validation_1[a19_0x41308a(0x1ce)]),adminController['updateUser']),router[a19_0x41308a(0x1a0)](a19_0x41308a(0x1c9),adminController['deleteUser']),router[a19_0x41308a(0x201)]('/users/:id/suspend',adminController[a19_0x41308a(0x192)]),router[a19_0x41308a(0x201)](a19_0x41308a(0x1c3),adminController[a19_0x41308a(0x1f1)]),router[a19_0x41308a(0x190)](a19_0x41308a(0x1dc),(_0x1da576,_0x2566f0)=>{const _0x4a25b8=a19_0x41308a;try{const _0x56efa1=loggerService_1['loggerService'][_0x4a25b8(0x209)]();_0x2566f0[_0x4a25b8(0x205)]({'success':!![],'result':_0x56efa1});}catch(_0x57aaa8){_0x2566f0[_0x4a25b8(0x1cd)](0x1f4)['json']({'success':![],'message':_0x4a25b8(0x1d6)});}}),router['post'](a19_0x41308a(0x20c),(_0x2c17d4,_0x1348bc)=>{const _0x90e44e=a19_0x41308a;try{const {daysToKeep:daysToKeep=0x1e}=_0x2c17d4[_0x90e44e(0x1d9)];loggerService_1[_0x90e44e(0x1e7)][_0x90e44e(0x1f5)](daysToKeep),_0x1348bc[_0x90e44e(0x205)]({'success':!![],'message':_0x90e44e(0x1e8)+daysToKeep+_0x90e44e(0x1a8)});}catch(_0x510828){_0x1348bc['status'](0x1f4)['json']({'success':![],'message':_0x90e44e(0x20f)});}}),router[a19_0x41308a(0x201)]('/cointopay/check/:paymentId',async(_0x122c7c,_0x4afca6)=>{const _0x1b120e=a19_0x41308a;try{const {paymentId:_0x3e007b}=_0x122c7c[_0x1b120e(0x1cc)];console[_0x1b120e(0x19f)](_0x1b120e(0x1c4)+_0x3e007b),await coinToPayStatusService_1[_0x1b120e(0x1b1)][_0x1b120e(0x1cb)](_0x3e007b),_0x4afca6[_0x1b120e(0x205)]({'success':!![],'message':_0x1b120e(0x194)});}catch(_0x5b2f8c){console['error'](_0x1b120e(0x189)+_0x122c7c[_0x1b120e(0x1cc)]['paymentId']+':',_0x5b2f8c),_0x4afca6[_0x1b120e(0x1cd)](0x1f4)[_0x1b120e(0x205)]({'success':![],'message':_0x5b2f8c instanceof Error?_0x5b2f8c[_0x1b120e(0x1bb)]:_0x1b120e(0x1fc)});}}),router['get'](a19_0x41308a(0x1e9),(_0x1ec903,_0x37ae49)=>{const _0x566d22=a19_0x41308a;try{const _0x4e4c0f=coinToPayStatusService_1[_0x566d22(0x1b1)]['getServiceStats']();_0x37ae49[_0x566d22(0x205)]({'success':!![],'result':{..._0x4e4c0f,'description':_0x566d22(0x193),'statusMapping':{'Paid':_0x566d22(0x1d3),'Awaiting\x20Fiat':_0x566d22(0x208),'waiting':_0x566d22(0x208),'expired':'EXPIRED','failed':_0x566d22(0x1ed)},'autoExpiryNote':'Payments\x20automatically\x20expire\x20after\x20'+_0x4e4c0f[_0x566d22(0x210)]+'\x20days\x20if\x20not\x20paid','individualTimersNote':_0x566d22(0x18b)}});}catch(_0x143c8f){_0x37ae49['status'](0x1f4)[_0x566d22(0x205)]({'success':![],'message':_0x566d22(0x1f2)});}}),router['get'](a19_0x41308a(0x1ee),async(_0x113a2b,_0x518964)=>{const _0x2c804c=a19_0x41308a;try{const {paymentId:_0x40174c}=_0x113a2b[_0x2c804c(0x1cc)],_0x5ec2df=coinToPayStatusService_1['coinToPayStatusService'][_0x2c804c(0x1d1)](_0x40174c),_0x6c2883=(await Promise[_0x2c804c(0x1de)]()['then'](()=>__importStar(require(_0x2c804c(0x1a3)))))[_0x2c804c(0x18f)],_0x25fb55=await _0x6c2883[_0x2c804c(0x19c)][_0x2c804c(0x1e6)]({'where':{'id':_0x40174c},'select':{'id':!![],'gateway':!![],'gatewayPaymentId':!![],'status':!![],'amount':!![],'currency':!![],'createdAt':!![],'updatedAt':!![],'shopId':!![],'shop':{'select':{'name':!![],'username':!![]}}}});if(!_0x25fb55)return _0x518964[_0x2c804c(0x1cd)](0x194)[_0x2c804c(0x205)]({'success':![],'message':_0x2c804c(0x1bf)});_0x518964[_0x2c804c(0x205)]({'success':!![],'result':{'payment':{'id':_0x25fb55['id'],'gateway':_0x25fb55[_0x2c804c(0x18e)],'gatewayPaymentId':_0x25fb55[_0x2c804c(0x213)],'status':_0x25fb55[_0x2c804c(0x1cd)],'amount':_0x25fb55[_0x2c804c(0x1fd)],'currency':_0x25fb55[_0x2c804c(0x199)],'createdAt':_0x25fb55[_0x2c804c(0x1ef)],'updatedAt':_0x25fb55[_0x2c804c(0x20a)],'shop':_0x25fb55[_0x2c804c(0x19e)]},'timers':_0x5ec2df,'isCoinToPay':_0x25fb55[_0x2c804c(0x18e)]===_0x2c804c(0x202),'ageInMinutes':Math['floor']((Date[_0x2c804c(0x1d4)]()-_0x25fb55[_0x2c804c(0x1ef)][_0x2c804c(0x1fb)]())/(0x3e8*0x3c))}});}catch(_0x72bd4){_0x518964[_0x2c804c(0x1cd)](0x1f4)[_0x2c804c(0x205)]({'success':![],'message':_0x72bd4 instanceof Error?_0x72bd4[_0x2c804c(0x1bb)]:_0x2c804c(0x1ab)});}}),router['post'](a19_0x41308a(0x214),async(_0x28ef64,_0x70e183)=>{const _0x38c3b0=a19_0x41308a;try{const {paymentId:_0x2ccf07}=_0x28ef64[_0x38c3b0(0x1cc)];console[_0x38c3b0(0x19f)](_0x38c3b0(0x206)+_0x2ccf07),await rapydStatusService_1[_0x38c3b0(0x1b4)]['checkPaymentById'](_0x2ccf07),_0x70e183['json']({'success':!![],'message':'Rapyd\x20payment\x20status\x20checked\x20successfully'});}catch(_0x1458df){console['error'](_0x38c3b0(0x19a)+_0x28ef64[_0x38c3b0(0x1cc)][_0x38c3b0(0x1f9)]+':',_0x1458df),_0x70e183[_0x38c3b0(0x1cd)](0x1f4)[_0x38c3b0(0x205)]({'success':![],'message':_0x1458df instanceof Error?_0x1458df[_0x38c3b0(0x1bb)]:'Failed\x20to\x20check\x20Rapyd\x20payment\x20status'});}}),router[a19_0x41308a(0x190)](a19_0x41308a(0x1c0),(_0x57a1ce,_0x44b820)=>{const _0xd8fb54=a19_0x41308a;try{const _0x4886dd=rapydStatusService_1['rapydStatusService']['getServiceStats']();_0x44b820[_0xd8fb54(0x205)]({'success':!![],'result':{..._0x4886dd,'description':'Rapyd\x20automatic\x20status\x20checking\x20service','statusMapping':{'paid:\x20true':_0xd8fb54(0x1d3),'paid:\x20false\x20+\x20CAN':_0xd8fb54(0x1ed),'paid:\x20false\x20+\x20ERR':_0xd8fb54(0x1ed),'paid:\x20false\x20+\x20EXP':_0xd8fb54(0x1b7),'paid:\x20false\x20+\x20other':_0xd8fb54(0x208)},'checkSchedule':'Payments\x20are\x20checked\x20after\x2030\x20minutes\x20and\x2060\x20minutes,\x20then\x20forgotten','note':_0xd8fb54(0x1c7)}});}catch(_0x3e452b){_0x44b820[_0xd8fb54(0x1cd)](0x1f4)[_0xd8fb54(0x205)]({'success':![],'message':_0xd8fb54(0x1cf)});}}),router[a19_0x41308a(0x190)](a19_0x41308a(0x1bd),async(_0x1d7e57,_0x3207b4)=>{const _0x451520=a19_0x41308a;try{const {paymentId:_0x394f67}=_0x1d7e57[_0x451520(0x1cc)],_0x59f643=await database_1[_0x451520(0x18f)][_0x451520(0x19c)][_0x451520(0x1e6)]({'where':{'id':_0x394f67},'include':{'shop':{'select':{'id':!![],'name':!![],'username':!![]}}}});if(!_0x59f643)return _0x3207b4[_0x451520(0x1cd)](0x194)['json']({'success':![],'message':_0x451520(0x1bf)});const _0x53e1f0=rapydStatusService_1[_0x451520(0x1b4)]['getPaymentTimerInfo'](_0x394f67);_0x3207b4[_0x451520(0x205)]({'success':!![],'result':{'payment':{'id':_0x59f643['id'],'gateway':_0x59f643[_0x451520(0x18e)],'gatewayPaymentId':_0x59f643['gatewayPaymentId'],'status':_0x59f643[_0x451520(0x1cd)],'amount':_0x59f643[_0x451520(0x1fd)],'currency':_0x59f643[_0x451520(0x199)],'createdAt':_0x59f643[_0x451520(0x1ef)],'updatedAt':_0x59f643['updatedAt'],'shop':_0x59f643['shop']},'timers':_0x53e1f0,'isRapyd':_0x59f643[_0x451520(0x18e)]==='rapyd','ageInMinutes':Math[_0x451520(0x1dd)]((Date[_0x451520(0x1d4)]()-_0x59f643[_0x451520(0x1ef)]['getTime']())/(0x3e8*0x3c)),'nextCheck':_0x53e1f0[_0x451520(0x1f6)]?Math[_0x451520(0x1dd)]((Date[_0x451520(0x1d4)]()-_0x59f643[_0x451520(0x1ef)][_0x451520(0x1fb)]())/(0x3e8*0x3c))<0x1e?0x1e-Math[_0x451520(0x1dd)]((Date[_0x451520(0x1d4)]()-_0x59f643[_0x451520(0x1ef)][_0x451520(0x1fb)]())/(0x3e8*0x3c))+_0x451520(0x1b5):Math[_0x451520(0x1dd)]((Date['now']()-_0x59f643[_0x451520(0x1ef)][_0x451520(0x1fb)]())/(0x3e8*0x3c))<0x3c?0x3c-Math['floor']((Date[_0x451520(0x1d4)]()-_0x59f643['createdAt']['getTime']())/(0x3e8*0x3c))+_0x451520(0x1b5):_0x451520(0x211):_0x451520(0x1e1)}});}catch(_0x3cd513){_0x3207b4['status'](0x1f4)[_0x451520(0x205)]({'success':![],'message':_0x3cd513 instanceof Error?_0x3cd513[_0x451520(0x1bb)]:'Failed\x20to\x20get\x20payment\x20information'});}}),router[a19_0x41308a(0x190)]('/domain-monitoring/stats',(_0x56a062,_0x18f234)=>{const _0x5a0915=a19_0x41308a;try{const _0x4d6e3d=domainMonitoringService_1['domainMonitoringService'][_0x5a0915(0x18a)]();_0x18f234[_0x5a0915(0x205)]({'success':!![],'result':{..._0x4d6e3d,'description':_0x5a0915(0x1ad),'behavior':_0x5a0915(0x198),'encoding':_0x5a0915(0x1ac)}});}catch(_0x4f2e77){_0x18f234[_0x5a0915(0x1cd)](0x1f4)[_0x5a0915(0x205)]({'success':![],'message':_0x5a0915(0x1c5)});}}),router[a19_0x41308a(0x201)](a19_0x41308a(0x1f7),async(_0x36d5ef,_0x250b9a)=>{const _0x4e49f5=a19_0x41308a;try{const _0x27a76f=await domainMonitoringService_1[_0x4e49f5(0x1c2)][_0x4e49f5(0x1f3)]();_0x250b9a[_0x4e49f5(0x205)]({'success':!![],'result':{'domainAvailable':_0x27a76f,'message':_0x27a76f?_0x4e49f5(0x1b8):'Domain\x20check\x20failed','timestamp':new Date()[_0x4e49f5(0x1e5)]()}});}catch(_0x323c05){_0x250b9a[_0x4e49f5(0x1cd)](0x1f4)['json']({'success':![],'message':_0x323c05 instanceof Error?_0x323c05[_0x4e49f5(0x1bb)]:_0x4e49f5(0x1ff)});}}),exports[a19_0x41308a(0x18f)]=router;