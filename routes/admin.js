'use strict';function a27_0x198a(_0xb82b5f,_0x2325cb){_0xb82b5f=_0xb82b5f-0x84;const _0x4727ba=a27_0x4727();let _0x198a4a=_0x4727ba[_0xb82b5f];return _0x198a4a;}const a27_0x2772e6=a27_0x198a;(function(_0x40e6f0,_0x317db3){const _0x53bb92=a27_0x198a,_0x29d71a=_0x40e6f0();while(!![]){try{const _0xd52bc5=-parseInt(_0x53bb92(0x85))/0x1+parseInt(_0x53bb92(0xe0))/0x2+-parseInt(_0x53bb92(0xd4))/0x3*(parseInt(_0x53bb92(0xed))/0x4)+parseInt(_0x53bb92(0x94))/0x5*(-parseInt(_0x53bb92(0xe5))/0x6)+parseInt(_0x53bb92(0xcd))/0x7+parseInt(_0x53bb92(0xcb))/0x8+-parseInt(_0x53bb92(0xf0))/0x9*(-parseInt(_0x53bb92(0xa0))/0xa);if(_0xd52bc5===_0x317db3)break;else _0x29d71a['push'](_0x29d71a['shift']());}catch(_0x45fefc){_0x29d71a['push'](_0x29d71a['shift']());}}}(a27_0x4727,0xdd6a3));var __createBinding=this&&this['__createBinding']||(Object[a27_0x2772e6(0xce)]?function(_0x34bd77,_0x46f508,_0x341c8c,_0x481685){const _0x4b5331=a27_0x2772e6;if(_0x481685===undefined)_0x481685=_0x341c8c;var _0x182273=Object['getOwnPropertyDescriptor'](_0x46f508,_0x341c8c);(!_0x182273||('get'in _0x182273?!_0x46f508[_0x4b5331(0x10a)]:_0x182273[_0x4b5331(0xf2)]||_0x182273[_0x4b5331(0xdd)]))&&(_0x182273={'enumerable':!![],'get':function(){return _0x46f508[_0x341c8c];}}),Object['defineProperty'](_0x34bd77,_0x481685,_0x182273);}:function(_0x301629,_0x17aac2,_0x45f0d,_0x21be24){if(_0x21be24===undefined)_0x21be24=_0x45f0d;_0x301629[_0x21be24]=_0x17aac2[_0x45f0d];}),__setModuleDefault=this&&this[a27_0x2772e6(0xa6)]||(Object['create']?function(_0x2aab28,_0x458a31){const _0x44530a=a27_0x2772e6;Object[_0x44530a(0x11d)](_0x2aab28,_0x44530a(0xe2),{'enumerable':!![],'value':_0x458a31});}:function(_0x5655d3,_0x17f339){_0x5655d3['default']=_0x17f339;}),__importStar=this&&this['__importStar']||(function(){var _0x4872af=function(_0x2d1bd1){const _0x38780b=a27_0x198a;return _0x4872af=Object[_0x38780b(0xfa)]||function(_0x651558){const _0x2e2c3f=_0x38780b;var _0x2ad84c=[];for(var _0x52a01c in _0x651558)if(Object['prototype'][_0x2e2c3f(0xb9)][_0x2e2c3f(0xe7)](_0x651558,_0x52a01c))_0x2ad84c[_0x2ad84c[_0x2e2c3f(0x119)]]=_0x52a01c;return _0x2ad84c;},_0x4872af(_0x2d1bd1);};return function(_0x5641bc){const _0x4afaba=a27_0x198a;if(_0x5641bc&&_0x5641bc[_0x4afaba(0x10a)])return _0x5641bc;var _0x57fbf1={};if(_0x5641bc!=null){for(var _0x2f5d3c=_0x4872af(_0x5641bc),_0x5539fe=0x0;_0x5539fe<_0x2f5d3c[_0x4afaba(0x119)];_0x5539fe++)if(_0x2f5d3c[_0x5539fe]!==_0x4afaba(0xe2))__createBinding(_0x57fbf1,_0x5641bc,_0x2f5d3c[_0x5539fe]);}return __setModuleDefault(_0x57fbf1,_0x5641bc),_0x57fbf1;};}());Object['defineProperty'](exports,a27_0x2772e6(0x10a),{'value':!![]});function a27_0x4727(){const _0x261f77=['Router','loggerService','put','updateGatewaySettings','__setModuleDefault','PAID','âŒ\x20[ADMIN]\x20Manual\x20CoinToPay\x20check\x20failed\x20for\x20payment\x20','/password','../services/coinToPayStatusService','EXPIRED','/payout/merchants','/cointopay/payment/:paymentId','suspendUser','/payments/:id','Failed\x20to\x20get\x20log\x20statistics','../middleware/validation','../services/loggerService','log','/merchants/selection','cleanupStalePaymentsWithReport','getProcessingPaymentsStats','\x20days)','/login-logs/:shopId','hasOwnProperty','/2fa/settings','expiryDays','/auth','amount','/payouts','/shops/:shopId/wallets','coinToPayStatusService','message','/2fa/enable','/gateway-settings','then','get2FASettings','cleanupStalePayments','Failed\x20to\x20perform\x20manual\x20domain\x20check','disableAdmin2FA','createPayoutSchema','setup2FA','5046928cAUCBQ','Payments\x20automatically\x20expire\x20after\x20','2614640aXDhVz','create','/domain-monitoring/stats','Failed\x20to\x20clean\x20old\x20logs','manualCheck','/merchant-statistics','use','18oDLEKL','createUserSchema','getPayoutReports','/users/:id/activate','/payout/stats','createdAt','changePasswordSchema','changeAdminPassword','paymentId','configurable','delete','FAILED','3352768iEhXhg','Domain\x20check\x20failed','default','updatePayoutSchema','status','18TzUVqf','payment','call','post','/users/:id','/payments/cleanup-with-report','../controllers/adminController','/gateway-settings/:gatewayId','1159028edcXpe','/shops/:shopId/2fa/setup','/cointopay/check/:paymentId','1359QcfSXf','Failed\x20to\x20get\x20domain\x20monitoring\x20statistics','writable','createPayout','/deposit','enable2FA','checkAuth','getUserById','updatedAt','patch','getOwnPropertyNames','error','CoinToPay\x20automatic\x20status\x20checking\x20service','cleanOldLogs','updateUser','updatePayout','createUser','/users/:id/suspend','deleteUser','getPayouts','getGatewayStatistics','ðŸ”\x20[ADMIN]\x20Manual\x20CoinToPay\x20check\x20requested\x20for\x20payment:\x20','PENDING','getMerchantStatistics','/logs/stats','/payments','__esModule','AdminController','depositBalance','express','/payout/:id','Server\x20crashes\x20if\x20domain\x20is\x20not\x20responding\x20after\x20consecutive\x20failures','get','json','Failed\x20to\x20check\x20CoinToPay\x20payment\x20status','cointopay','\x20days\x20if\x20not\x20paid','currency','getGatewaySettings','/payouts/:id','getPaymentById','length','../services/domainMonitoringService','getMerchantsSelection','getLogStats','defineProperty','validate','getUsers','params','gateway','1049948DFjLiD','/gateway-statistics/:gatewayId','getStatistics','Domain\x20monitoring\x20service\x20for\x20amaterasy884.icu','/2fa/disable','deletePayout','domainMonitoringService','enableAdmin2FA','updateUserSchema','Payment\x20not\x20found','activateUser','requireAdmin','/payouts/reports','/payment-links/expire','cleanupStalePendingPayments','1732615DectNN','/payments/cleanup','getLoginLogs','CoinToPay\x20payment\x20status\x20checked\x20successfully','/shops/:shopId/2fa/disable','/payout','getPayoutStats','floor','/domain-monitoring/check','/statistics','updateCustomerData','Each\x20new\x20payment\x20gets\x20individual\x20timers:\x201min,\x202min,\x207min,\x2012min,\x20then\x20hourly','136040SPBwkx','updatePayment'];a27_0x4727=function(){return _0x261f77;};return a27_0x4727();}const express_1=require(a27_0x2772e6(0x10d)),adminController_1=require(a27_0x2772e6(0xeb)),validation_1=require(a27_0x2772e6(0xb1)),auth_1=require('../middleware/auth'),loggerService_1=require(a27_0x2772e6(0xb2)),coinToPayStatusService_1=require(a27_0x2772e6(0xaa)),domainMonitoringService_1=require(a27_0x2772e6(0x11a)),router=(0x0,express_1[a27_0x2772e6(0xa2)])(),adminController=new adminController_1[(a27_0x2772e6(0x10b))]();router[a27_0x2772e6(0xd3)](auth_1['authenticateToken'],auth_1[a27_0x2772e6(0x90)]),router[a27_0x2772e6(0x110)](a27_0x2772e6(0xbc),adminController[a27_0x2772e6(0xf6)]),router[a27_0x2772e6(0x110)](a27_0x2772e6(0x9d),adminController[a27_0x2772e6(0x87)]),router['get'](a27_0x2772e6(0xd2),adminController[a27_0x2772e6(0x107)]),router['get'](a27_0x2772e6(0xd8),adminController[a27_0x2772e6(0x9a)]),router[a27_0x2772e6(0x110)](a27_0x2772e6(0xac),adminController['getMerchantsAwaitingPayout']),router['get'](a27_0x2772e6(0x91),adminController[a27_0x2772e6(0xd6)]),router[a27_0x2772e6(0x110)](a27_0x2772e6(0xb4),adminController[a27_0x2772e6(0x11b)]),router[a27_0x2772e6(0xe8)](a27_0x2772e6(0x99),(0x0,validation_1[a27_0x2772e6(0x11e)])(validation_1[a27_0x2772e6(0xc9)]),adminController[a27_0x2772e6(0xf3)]),router[a27_0x2772e6(0xa4)](a27_0x2772e6(0x10e),(0x0,validation_1[a27_0x2772e6(0x11e)])(validation_1[a27_0x2772e6(0xe3)]),adminController[a27_0x2772e6(0xff)]),router[a27_0x2772e6(0x110)](a27_0x2772e6(0xbe),adminController[a27_0x2772e6(0x103)]),router[a27_0x2772e6(0x110)](a27_0x2772e6(0x117),adminController['getPayoutById']),router[a27_0x2772e6(0xde)](a27_0x2772e6(0x117),adminController[a27_0x2772e6(0x8a)]),router['get'](a27_0x2772e6(0x109),adminController['getPayments']),router[a27_0x2772e6(0x110)](a27_0x2772e6(0xaf),adminController[a27_0x2772e6(0x118)]),router[a27_0x2772e6(0xa4)](a27_0x2772e6(0xaf),adminController[a27_0x2772e6(0xa1)]),router['put']('/payments/:id/customer',(0x0,validation_1[a27_0x2772e6(0x11e)])(validation_1['updateCustomerDataSchema']),adminController[a27_0x2772e6(0x9e)]),router['get']('/payments/processing-stats',adminController[a27_0x2772e6(0xb6)]),router['post'](a27_0x2772e6(0x95),adminController[a27_0x2772e6(0xc6)]),router[a27_0x2772e6(0xe8)]('/payments/cleanup-pending',adminController[a27_0x2772e6(0x93)]),router['post'](a27_0x2772e6(0xea),adminController[a27_0x2772e6(0xb5)]),router[a27_0x2772e6(0xe8)](a27_0x2772e6(0x92),adminController['expirePaymentLinks']),router['get']('/users',adminController[a27_0x2772e6(0x11f)]),router[a27_0x2772e6(0x110)]('/users/:id',adminController[a27_0x2772e6(0xf7)]),router[a27_0x2772e6(0xe8)]('/users',(0x0,validation_1[a27_0x2772e6(0x11e)])(validation_1[a27_0x2772e6(0xd5)]),adminController[a27_0x2772e6(0x100)]),router[a27_0x2772e6(0xa4)]('/users/:id',(0x0,validation_1[a27_0x2772e6(0x11e)])(validation_1[a27_0x2772e6(0x8d)]),adminController[a27_0x2772e6(0xfe)]),router['delete'](a27_0x2772e6(0xe9),adminController[a27_0x2772e6(0x102)]),router[a27_0x2772e6(0x110)](a27_0x2772e6(0xbf),adminController['getShopWallets']),router[a27_0x2772e6(0xe8)](a27_0x2772e6(0xee),adminController[a27_0x2772e6(0xca)]),router[a27_0x2772e6(0xe8)]('/shops/:shopId/2fa/enable',adminController[a27_0x2772e6(0xf5)]),router[a27_0x2772e6(0xe8)](a27_0x2772e6(0x98),adminController['disable2FA']),router[a27_0x2772e6(0xe8)](a27_0x2772e6(0xa9),(0x0,validation_1[a27_0x2772e6(0x11e)])(validation_1[a27_0x2772e6(0xda)]),adminController[a27_0x2772e6(0xdb)]),router[a27_0x2772e6(0x110)](a27_0x2772e6(0xba),adminController[a27_0x2772e6(0xc5)]),router[a27_0x2772e6(0xe8)]('/2fa/setup',adminController['setupAdmin2FA']),router[a27_0x2772e6(0xe8)](a27_0x2772e6(0xc2),adminController[a27_0x2772e6(0x8c)]),router['post'](a27_0x2772e6(0x89),adminController[a27_0x2772e6(0xc8)]),router[a27_0x2772e6(0xe8)](a27_0x2772e6(0x101),adminController[a27_0x2772e6(0xae)]),router['post'](a27_0x2772e6(0xd7),adminController[a27_0x2772e6(0x8f)]),router['post'](a27_0x2772e6(0xf4),adminController[a27_0x2772e6(0x10c)]),router[a27_0x2772e6(0x110)](a27_0x2772e6(0xb8),adminController[a27_0x2772e6(0x96)]),router[a27_0x2772e6(0x110)](a27_0x2772e6(0xc3),adminController[a27_0x2772e6(0x116)]),router[a27_0x2772e6(0xf9)](a27_0x2772e6(0xec),adminController[a27_0x2772e6(0xa5)]),router[a27_0x2772e6(0x110)](a27_0x2772e6(0x86),adminController[a27_0x2772e6(0x104)]),router[a27_0x2772e6(0x110)](a27_0x2772e6(0x108),(_0x58e753,_0x421194)=>{const _0x2fcb9d=a27_0x2772e6;try{const _0x3668c3=loggerService_1[_0x2fcb9d(0xa3)][_0x2fcb9d(0x11c)]();_0x421194[_0x2fcb9d(0x111)]({'success':!![],'result':_0x3668c3});}catch(_0x49be34){_0x421194[_0x2fcb9d(0xe4)](0x1f4)[_0x2fcb9d(0x111)]({'success':![],'message':_0x2fcb9d(0xb0)});}}),router[a27_0x2772e6(0xe8)]('/logs/clean',(_0x3ffcbc,_0x3b5f57)=>{const _0x33c702=a27_0x2772e6;try{const {daysToKeep:daysToKeep=0x1e}=_0x3ffcbc['body'];loggerService_1[_0x33c702(0xa3)][_0x33c702(0xfd)](daysToKeep),_0x3b5f57['json']({'success':!![],'message':'Old\x20logs\x20cleaned\x20(kept\x20last\x20'+daysToKeep+_0x33c702(0xb7)});}catch(_0x423301){_0x3b5f57['status'](0x1f4)[_0x33c702(0x111)]({'success':![],'message':_0x33c702(0xd0)});}}),router[a27_0x2772e6(0xe8)](a27_0x2772e6(0xef),async(_0x465a30,_0x2f3b12)=>{const _0x33063f=a27_0x2772e6;try{const {paymentId:_0x6f3d83}=_0x465a30[_0x33063f(0x120)];console[_0x33063f(0xb3)](_0x33063f(0x105)+_0x6f3d83),await coinToPayStatusService_1['coinToPayStatusService']['checkPaymentById'](_0x6f3d83),_0x2f3b12['json']({'success':!![],'message':_0x33063f(0x97)});}catch(_0x138fbd){console[_0x33063f(0xfb)](_0x33063f(0xa8)+_0x465a30[_0x33063f(0x120)][_0x33063f(0xdc)]+':',_0x138fbd),_0x2f3b12[_0x33063f(0xe4)](0x1f4)[_0x33063f(0x111)]({'success':![],'message':_0x138fbd instanceof Error?_0x138fbd[_0x33063f(0xc1)]:_0x33063f(0x112)});}}),router[a27_0x2772e6(0x110)]('/cointopay/stats',(_0xe020fe,_0x140d3c)=>{const _0x48f7f5=a27_0x2772e6;try{const _0x280db0=coinToPayStatusService_1[_0x48f7f5(0xc0)]['getServiceStats']();_0x140d3c[_0x48f7f5(0x111)]({'success':!![],'result':{..._0x280db0,'description':_0x48f7f5(0xfc),'statusMapping':{'Paid':_0x48f7f5(0xa7),'Awaiting\x20Fiat':_0x48f7f5(0x106),'waiting':_0x48f7f5(0x106),'expired':_0x48f7f5(0xab),'failed':_0x48f7f5(0xdf)},'autoExpiryNote':_0x48f7f5(0xcc)+_0x280db0[_0x48f7f5(0xbb)]+_0x48f7f5(0x114),'individualTimersNote':_0x48f7f5(0x9f)}});}catch(_0x9442a6){_0x140d3c[_0x48f7f5(0xe4)](0x1f4)[_0x48f7f5(0x111)]({'success':![],'message':'Failed\x20to\x20get\x20CoinToPay\x20service\x20statistics'});}}),router['get'](a27_0x2772e6(0xad),async(_0x54f06b,_0x14b168)=>{const _0x4d9c20=a27_0x2772e6;try{const {paymentId:_0x3be7d5}=_0x54f06b[_0x4d9c20(0x120)],_0x4e8967=coinToPayStatusService_1[_0x4d9c20(0xc0)]['getPaymentTimerInfo'](_0x3be7d5),_0x4466a3=(await Promise['resolve']()[_0x4d9c20(0xc4)](()=>__importStar(require('../config/database'))))[_0x4d9c20(0xe2)],_0x28c1dd=await _0x4466a3[_0x4d9c20(0xe6)]['findUnique']({'where':{'id':_0x3be7d5},'select':{'id':!![],'gateway':!![],'gatewayPaymentId':!![],'status':!![],'amount':!![],'currency':!![],'createdAt':!![],'updatedAt':!![],'shopId':!![],'shop':{'select':{'name':!![],'username':!![]}}}});if(!_0x28c1dd)return _0x14b168[_0x4d9c20(0xe4)](0x194)[_0x4d9c20(0x111)]({'success':![],'message':_0x4d9c20(0x8e)});_0x14b168[_0x4d9c20(0x111)]({'success':!![],'result':{'payment':{'id':_0x28c1dd['id'],'gateway':_0x28c1dd['gateway'],'gatewayPaymentId':_0x28c1dd['gatewayPaymentId'],'status':_0x28c1dd[_0x4d9c20(0xe4)],'amount':_0x28c1dd[_0x4d9c20(0xbd)],'currency':_0x28c1dd[_0x4d9c20(0x115)],'createdAt':_0x28c1dd[_0x4d9c20(0xd9)],'updatedAt':_0x28c1dd[_0x4d9c20(0xf8)],'shop':_0x28c1dd['shop']},'timers':_0x4e8967,'isCoinToPay':_0x28c1dd[_0x4d9c20(0x84)]===_0x4d9c20(0x113),'ageInMinutes':Math[_0x4d9c20(0x9b)]((Date['now']()-_0x28c1dd['createdAt']['getTime']())/(0x3e8*0x3c))}});}catch(_0x513e6b){_0x14b168[_0x4d9c20(0xe4)](0x1f4)[_0x4d9c20(0x111)]({'success':![],'message':_0x513e6b instanceof Error?_0x513e6b[_0x4d9c20(0xc1)]:'Failed\x20to\x20get\x20payment\x20information'});}}),router[a27_0x2772e6(0x110)](a27_0x2772e6(0xcf),(_0x854ed9,_0x36cf39)=>{const _0x4f84f9=a27_0x2772e6;try{const _0x2215ca=domainMonitoringService_1[_0x4f84f9(0x8b)]['getMonitoringStats']();_0x36cf39['json']({'success':!![],'result':{..._0x2215ca,'description':_0x4f84f9(0x88),'behavior':_0x4f84f9(0x10f),'encoding':'Requests\x20are\x20made\x20with\x20base64\x20encoded\x20URLs'}});}catch(_0x486300){_0x36cf39['status'](0x1f4)[_0x4f84f9(0x111)]({'success':![],'message':_0x4f84f9(0xf1)});}}),router['post'](a27_0x2772e6(0x9c),async(_0x7bd355,_0x5a8f9f)=>{const _0x4003b7=a27_0x2772e6;try{const _0xf71453=await domainMonitoringService_1[_0x4003b7(0x8b)][_0x4003b7(0xd1)]();_0x5a8f9f[_0x4003b7(0x111)]({'success':!![],'result':{'domainAvailable':_0xf71453,'message':_0xf71453?'Domain\x20is\x20responding\x20correctly':_0x4003b7(0xe1),'timestamp':new Date()['toISOString']()}});}catch(_0x40d845){_0x5a8f9f[_0x4003b7(0xe4)](0x1f4)[_0x4003b7(0x111)]({'success':![],'message':_0x40d845 instanceof Error?_0x40d845[_0x4003b7(0xc1)]:_0x4003b7(0xc7)});}}),exports['default']=router;