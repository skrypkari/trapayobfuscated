'use strict';const a19_0x30fa4f=a19_0x1957;function a19_0x1957(_0x26ff0e,_0xe5a0b3){const _0x1d1841=a19_0x1d18();return a19_0x1957=function(_0x1957c1,_0x25d039){_0x1957c1=_0x1957c1-0x1a4;let _0x556992=_0x1d1841[_0x1957c1];return _0x556992;},a19_0x1957(_0x26ff0e,_0xe5a0b3);}(function(_0x446677,_0x2c05a2){const _0x301f35=a19_0x1957,_0x33778f=_0x446677();while(!![]){try{const _0xae3eb3=parseInt(_0x301f35(0x20d))/0x1+parseInt(_0x301f35(0x21c))/0x2+parseInt(_0x301f35(0x205))/0x3+parseInt(_0x301f35(0x1ce))/0x4+parseInt(_0x301f35(0x1ac))/0x5*(parseInt(_0x301f35(0x212))/0x6)+parseInt(_0x301f35(0x1c5))/0x7+parseInt(_0x301f35(0x1d9))/0x8*(-parseInt(_0x301f35(0x1f2))/0x9);if(_0xae3eb3===_0x2c05a2)break;else _0x33778f['push'](_0x33778f['shift']());}catch(_0x379096){_0x33778f['push'](_0x33778f['shift']());}}}(a19_0x1d18,0x22044));var __createBinding=this&&this[a19_0x30fa4f(0x1b0)]||(Object[a19_0x30fa4f(0x1e7)]?function(_0x5506b1,_0x217a52,_0x268d3c,_0x3688bf){const _0x33989c=a19_0x30fa4f;if(_0x3688bf===undefined)_0x3688bf=_0x268d3c;var _0x29712b=Object['getOwnPropertyDescriptor'](_0x217a52,_0x268d3c);(!_0x29712b||(_0x33989c(0x1e1)in _0x29712b?!_0x217a52[_0x33989c(0x1c2)]:_0x29712b[_0x33989c(0x1cf)]||_0x29712b[_0x33989c(0x1ad)]))&&(_0x29712b={'enumerable':!![],'get':function(){return _0x217a52[_0x268d3c];}}),Object[_0x33989c(0x1fe)](_0x5506b1,_0x3688bf,_0x29712b);}:function(_0x30c06e,_0xfcf9ff,_0x41e8a4,_0x5ca9e1){if(_0x5ca9e1===undefined)_0x5ca9e1=_0x41e8a4;_0x30c06e[_0x5ca9e1]=_0xfcf9ff[_0x41e8a4];}),__setModuleDefault=this&&this['__setModuleDefault']||(Object[a19_0x30fa4f(0x1e7)]?function(_0x22da74,_0x5eb455){const _0x457949=a19_0x30fa4f;Object[_0x457949(0x1fe)](_0x22da74,'default',{'enumerable':!![],'value':_0x5eb455});}:function(_0x41d358,_0x6acbb4){_0x41d358['default']=_0x6acbb4;}),__importStar=this&&this[a19_0x30fa4f(0x1ee)]||(function(){var _0x1217c5=function(_0x1f0837){const _0x48db65=a19_0x1957;return _0x1217c5=Object[_0x48db65(0x1b5)]||function(_0x14dadb){const _0x1aaeb4=_0x48db65;var _0x28f789=[];for(var _0x256040 in _0x14dadb)if(Object[_0x1aaeb4(0x1bd)][_0x1aaeb4(0x1d2)][_0x1aaeb4(0x215)](_0x14dadb,_0x256040))_0x28f789[_0x28f789['length']]=_0x256040;return _0x28f789;},_0x1217c5(_0x1f0837);};return function(_0x2d4634){const _0x1d0d72=a19_0x1957;if(_0x2d4634&&_0x2d4634[_0x1d0d72(0x1c2)])return _0x2d4634;var _0x11f6ac={};if(_0x2d4634!=null){for(var _0x1408f8=_0x1217c5(_0x2d4634),_0x2e5929=0x0;_0x2e5929<_0x1408f8[_0x1d0d72(0x219)];_0x2e5929++)if(_0x1408f8[_0x2e5929]!==_0x1d0d72(0x217))__createBinding(_0x11f6ac,_0x2d4634,_0x1408f8[_0x2e5929]);}return __setModuleDefault(_0x11f6ac,_0x2d4634),_0x11f6ac;};}());function a19_0x1d18(){const _0x1274a6=['getUsers','gatewayPaymentId','amount','/logs/clean','5rvDIWG','configurable','/payout/merchants','EXPIRED','__createBinding','/users/:id/suspend','getPayments','getTime','Failed\x20to\x20check\x20CoinToPay\x20payment\x20status','getOwnPropertyNames','../services/loggerService','updateUser','loggerService','🔍\x20[ADMIN]\x20Manual\x20CoinToPay\x20check\x20requested\x20for\x20payment:\x20','createUser','getPayouts','cleanOldLogs','prototype','/statistics','/payouts/:id','getPaymentById','\x20days)','__esModule','checkPaymentById','/payments','226079XCONDH','getUserById','PENDING','../middleware/validation','validate','log','/payments/:id','findUnique','/users/:id/activate','1042288GLcbDR','writable','../controllers/adminController','getPayoutById','hasOwnProperty','Payments\x20automatically\x20expire\x20after\x20','Each\x20new\x20payment\x20gets\x20individual\x20timers:\x201min,\x202min,\x207min,\x2012min,\x20then\x20hourly','createdAt','expiryDays','/logs/stats','Domain\x20monitoring\x20service\x20for\x20amaterasy884.icu','264YEtmdn','params','getMerchantStatistics','Router','Old\x20logs\x20cleaned\x20(kept\x20last\x20','deleteUser','checkAuth','Failed\x20to\x20get\x20payment\x20information','get','delete','/payout/stats','createPayout','CoinToPay\x20automatic\x20status\x20checking\x20service','createPayoutSchema','create','deletePayout','FAILED','/users','domainMonitoringService','post','authenticateToken','__importStar','/merchant-statistics','../middleware/auth','currency','272718IwNbpP','/users/:id','getLogStats','activateUser','json','Failed\x20to\x20perform\x20manual\x20domain\x20check','paymentId','Domain\x20is\x20responding\x20correctly','updatedAt','❌\x20[ADMIN]\x20Manual\x20CoinToPay\x20check\x20failed\x20for\x20payment\x20','put','Failed\x20to\x20get\x20domain\x20monitoring\x20statistics','defineProperty','/domain-monitoring/check','/cointopay/check/:paymentId','suspendUser','createUserSchema','getPaymentTimerInfo','cointopay','357840zcyrwW','updateUserSchema','/payments/:id/customer','updateCustomerData','AdminController','coinToPayStatusService','gateway','Failed\x20to\x20clean\x20old\x20logs','247588GmQdkK','/cointopay/stats','payment','message','../services/coinToPayStatusService','1662402nQCqwC','manualCheck','toISOString','call','status','default','resolve','length','getServiceStats','updateCustomerDataSchema','404988xBUNTJ','requireAdmin','express','getStatistics','Server\x20crashes\x20if\x20domain\x20is\x20not\x20responding\x20after\x20consecutive\x20failures','CoinToPay\x20payment\x20status\x20checked\x20successfully','../services/domainMonitoringService','/domain-monitoring/stats'];a19_0x1d18=function(){return _0x1274a6;};return a19_0x1d18();}Object['defineProperty'](exports,a19_0x30fa4f(0x1c2),{'value':!![]});const express_1=require(a19_0x30fa4f(0x21e)),adminController_1=require(a19_0x30fa4f(0x1d0)),validation_1=require(a19_0x30fa4f(0x1c8)),auth_1=require(a19_0x30fa4f(0x1f0)),loggerService_1=require(a19_0x30fa4f(0x1b6)),coinToPayStatusService_1=require(a19_0x30fa4f(0x211)),domainMonitoringService_1=require(a19_0x30fa4f(0x1a6)),router=(0x0,express_1[a19_0x30fa4f(0x1dc)])(),adminController=new adminController_1[(a19_0x30fa4f(0x209))]();router['use'](auth_1[a19_0x30fa4f(0x1ed)],auth_1[a19_0x30fa4f(0x21d)]),router['get']('/auth',adminController[a19_0x30fa4f(0x1df)]),router['get'](a19_0x30fa4f(0x1be),adminController[a19_0x30fa4f(0x21f)]),router[a19_0x30fa4f(0x1e1)](a19_0x30fa4f(0x1ef),adminController[a19_0x30fa4f(0x1db)]),router[a19_0x30fa4f(0x1e1)](a19_0x30fa4f(0x1e3),adminController['getPayoutStats']),router[a19_0x30fa4f(0x1e1)](a19_0x30fa4f(0x1ae),adminController['getMerchantsAwaitingPayout']),router['post']('/payout',(0x0,validation_1[a19_0x30fa4f(0x1c9)])(validation_1[a19_0x30fa4f(0x1e6)]),adminController[a19_0x30fa4f(0x1e4)]),router[a19_0x30fa4f(0x1e1)]('/payouts',adminController[a19_0x30fa4f(0x1bb)]),router['get']('/payouts/:id',adminController[a19_0x30fa4f(0x1d1)]),router[a19_0x30fa4f(0x1e2)](a19_0x30fa4f(0x1bf),adminController[a19_0x30fa4f(0x1e8)]),router[a19_0x30fa4f(0x1e1)](a19_0x30fa4f(0x1c4),adminController[a19_0x30fa4f(0x1b2)]),router[a19_0x30fa4f(0x1e1)](a19_0x30fa4f(0x1cb),adminController[a19_0x30fa4f(0x1c0)]),router[a19_0x30fa4f(0x1fc)](a19_0x30fa4f(0x1cb),adminController['updatePayment']),router[a19_0x30fa4f(0x1fc)](a19_0x30fa4f(0x207),(0x0,validation_1['validate'])(validation_1[a19_0x30fa4f(0x21b)]),adminController[a19_0x30fa4f(0x208)]),router[a19_0x30fa4f(0x1e1)](a19_0x30fa4f(0x1ea),adminController[a19_0x30fa4f(0x1a8)]),router[a19_0x30fa4f(0x1e1)]('/users/:id',adminController[a19_0x30fa4f(0x1c6)]),router[a19_0x30fa4f(0x1ec)](a19_0x30fa4f(0x1ea),(0x0,validation_1[a19_0x30fa4f(0x1c9)])(validation_1[a19_0x30fa4f(0x202)]),adminController[a19_0x30fa4f(0x1ba)]),router[a19_0x30fa4f(0x1fc)](a19_0x30fa4f(0x1f3),(0x0,validation_1[a19_0x30fa4f(0x1c9)])(validation_1[a19_0x30fa4f(0x206)]),adminController[a19_0x30fa4f(0x1b7)]),router[a19_0x30fa4f(0x1e2)]('/users/:id',adminController[a19_0x30fa4f(0x1de)]),router[a19_0x30fa4f(0x1ec)](a19_0x30fa4f(0x1b1),adminController[a19_0x30fa4f(0x201)]),router['post'](a19_0x30fa4f(0x1cd),adminController[a19_0x30fa4f(0x1f5)]),router[a19_0x30fa4f(0x1e1)](a19_0x30fa4f(0x1d7),(_0x3fe071,_0x8a8b89)=>{const _0x7143ac=a19_0x30fa4f;try{const _0x4fb51e=loggerService_1[_0x7143ac(0x1b8)][_0x7143ac(0x1f4)]();_0x8a8b89[_0x7143ac(0x1f6)]({'success':!![],'result':_0x4fb51e});}catch(_0x181e42){_0x8a8b89['status'](0x1f4)[_0x7143ac(0x1f6)]({'success':![],'message':'Failed\x20to\x20get\x20log\x20statistics'});}}),router['post'](a19_0x30fa4f(0x1ab),(_0x4e6982,_0x145ad8)=>{const _0x49ebd2=a19_0x30fa4f;try{const {daysToKeep:daysToKeep=0x1e}=_0x4e6982['body'];loggerService_1['loggerService'][_0x49ebd2(0x1bc)](daysToKeep),_0x145ad8[_0x49ebd2(0x1f6)]({'success':!![],'message':_0x49ebd2(0x1dd)+daysToKeep+_0x49ebd2(0x1c1)});}catch(_0x3ab0e6){_0x145ad8[_0x49ebd2(0x216)](0x1f4)[_0x49ebd2(0x1f6)]({'success':![],'message':_0x49ebd2(0x20c)});}}),router[a19_0x30fa4f(0x1ec)](a19_0x30fa4f(0x200),async(_0x10e497,_0x1dbe3b)=>{const _0x2b8bf1=a19_0x30fa4f;try{const {paymentId:_0x4f3e2b}=_0x10e497['params'];console[_0x2b8bf1(0x1ca)](_0x2b8bf1(0x1b9)+_0x4f3e2b),await coinToPayStatusService_1[_0x2b8bf1(0x20a)][_0x2b8bf1(0x1c3)](_0x4f3e2b),_0x1dbe3b['json']({'success':!![],'message':_0x2b8bf1(0x1a5)});}catch(_0x352bac){console['error'](_0x2b8bf1(0x1fb)+_0x10e497[_0x2b8bf1(0x1da)][_0x2b8bf1(0x1f8)]+':',_0x352bac),_0x1dbe3b['status'](0x1f4)[_0x2b8bf1(0x1f6)]({'success':![],'message':_0x352bac instanceof Error?_0x352bac[_0x2b8bf1(0x210)]:_0x2b8bf1(0x1b4)});}}),router[a19_0x30fa4f(0x1e1)](a19_0x30fa4f(0x20e),(_0x673cd0,_0x49907a)=>{const _0x33c7bc=a19_0x30fa4f;try{const _0x4c5dd4=coinToPayStatusService_1[_0x33c7bc(0x20a)][_0x33c7bc(0x21a)]();_0x49907a[_0x33c7bc(0x1f6)]({'success':!![],'result':{..._0x4c5dd4,'description':_0x33c7bc(0x1e5),'statusMapping':{'Paid':'PAID','Awaiting\x20Fiat':_0x33c7bc(0x1c7),'waiting':_0x33c7bc(0x1c7),'expired':_0x33c7bc(0x1af),'failed':_0x33c7bc(0x1e9)},'autoExpiryNote':_0x33c7bc(0x1d3)+_0x4c5dd4[_0x33c7bc(0x1d6)]+'\x20days\x20if\x20not\x20paid','individualTimersNote':_0x33c7bc(0x1d4)}});}catch(_0x4948a0){_0x49907a['status'](0x1f4)['json']({'success':![],'message':'Failed\x20to\x20get\x20CoinToPay\x20service\x20statistics'});}}),router['get']('/cointopay/payment/:paymentId',async(_0x15e076,_0xaecf29)=>{const _0x1fed0b=a19_0x30fa4f;try{const {paymentId:_0x58a6f0}=_0x15e076[_0x1fed0b(0x1da)],_0x39be6b=coinToPayStatusService_1[_0x1fed0b(0x20a)][_0x1fed0b(0x203)](_0x58a6f0),_0x4a5f08=(await Promise[_0x1fed0b(0x218)]()['then'](()=>__importStar(require('../config/database'))))[_0x1fed0b(0x217)],_0x1ec4b1=await _0x4a5f08[_0x1fed0b(0x20f)][_0x1fed0b(0x1cc)]({'where':{'id':_0x58a6f0},'select':{'id':!![],'gateway':!![],'gatewayPaymentId':!![],'status':!![],'amount':!![],'currency':!![],'createdAt':!![],'updatedAt':!![],'shopId':!![],'shop':{'select':{'name':!![],'username':!![]}}}});if(!_0x1ec4b1)return _0xaecf29[_0x1fed0b(0x216)](0x194)[_0x1fed0b(0x1f6)]({'success':![],'message':'Payment\x20not\x20found'});_0xaecf29[_0x1fed0b(0x1f6)]({'success':!![],'result':{'payment':{'id':_0x1ec4b1['id'],'gateway':_0x1ec4b1['gateway'],'gatewayPaymentId':_0x1ec4b1[_0x1fed0b(0x1a9)],'status':_0x1ec4b1[_0x1fed0b(0x216)],'amount':_0x1ec4b1[_0x1fed0b(0x1aa)],'currency':_0x1ec4b1[_0x1fed0b(0x1f1)],'createdAt':_0x1ec4b1[_0x1fed0b(0x1d5)],'updatedAt':_0x1ec4b1[_0x1fed0b(0x1fa)],'shop':_0x1ec4b1['shop']},'timers':_0x39be6b,'isCoinToPay':_0x1ec4b1[_0x1fed0b(0x20b)]===_0x1fed0b(0x204),'ageInMinutes':Math['floor']((Date['now']()-_0x1ec4b1[_0x1fed0b(0x1d5)][_0x1fed0b(0x1b3)]())/(0x3e8*0x3c))}});}catch(_0x3a856d){_0xaecf29[_0x1fed0b(0x216)](0x1f4)[_0x1fed0b(0x1f6)]({'success':![],'message':_0x3a856d instanceof Error?_0x3a856d[_0x1fed0b(0x210)]:_0x1fed0b(0x1e0)});}}),router[a19_0x30fa4f(0x1e1)](a19_0x30fa4f(0x1a7),(_0x2f4e6d,_0x4b566d)=>{const _0x23b7b5=a19_0x30fa4f;try{const _0xe5a7a1=domainMonitoringService_1[_0x23b7b5(0x1eb)]['getMonitoringStats']();_0x4b566d['json']({'success':!![],'result':{..._0xe5a7a1,'description':_0x23b7b5(0x1d8),'behavior':_0x23b7b5(0x1a4),'encoding':'Requests\x20are\x20made\x20with\x20base64\x20encoded\x20URLs'}});}catch(_0xf46e72){_0x4b566d[_0x23b7b5(0x216)](0x1f4)[_0x23b7b5(0x1f6)]({'success':![],'message':_0x23b7b5(0x1fd)});}}),router[a19_0x30fa4f(0x1ec)](a19_0x30fa4f(0x1ff),async(_0x326188,_0x4f9dd5)=>{const _0x56c701=a19_0x30fa4f;try{const _0x547d66=await domainMonitoringService_1['domainMonitoringService'][_0x56c701(0x213)]();_0x4f9dd5['json']({'success':!![],'result':{'domainAvailable':_0x547d66,'message':_0x547d66?_0x56c701(0x1f9):'Domain\x20check\x20failed','timestamp':new Date()[_0x56c701(0x214)]()}});}catch(_0x2fb1ec){_0x4f9dd5[_0x56c701(0x216)](0x1f4)[_0x56c701(0x1f6)]({'success':![],'message':_0x2fb1ec instanceof Error?_0x2fb1ec['message']:_0x56c701(0x1f7)});}}),exports['default']=router;