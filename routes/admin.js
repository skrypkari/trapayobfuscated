'use strict';const a24_0x1fdb6d=a24_0x56e5;function a24_0x30b7(){const _0x38807e=['../config/database','getStatistics','getPaymentById','body','get','getOwnPropertyNames','updatedAt','createPayoutSchema','../services/coinToPayStatusService','cointopay','../services/loggerService','createdAt','validate','now','/users/:id/activate','Domain\x20check\x20failed','69qgLZCF','/merchants/selection','../middleware/validation','getMonitoringStats','status','324248DZyCjA','1758522mOMdAv','/users/:id','cleanupStalePaymentsWithReport','getMerchantsAwaitingPayout','PAID','json','put','Requests\x20are\x20made\x20with\x20base64\x20encoded\x20URLs','\x20days\x20if\x20not\x20paid','resolve','/logs/clean','63tKcdFE','express','Failed\x20to\x20perform\x20manual\x20domain\x20check','Failed\x20to\x20get\x20payment\x20information','__setModuleDefault','checkAuth','Domain\x20monitoring\x20service\x20for\x20amaterasy884.icu','createPayout','getServiceStats','message','createUserSchema','loggerService','Payments\x20automatically\x20expire\x20after\x20','4189408cMUuNO','domainMonitoringService','cleanOldLogs','/cointopay/check/:paymentId','getUserById','createUser','hasOwnProperty','Failed\x20to\x20get\x20CoinToPay\x20service\x20statistics','expiryDays','delete','error','/payments/:id/customer','/payout/merchants','getPayments','Failed\x20to\x20get\x20domain\x20monitoring\x20statistics','/users/:id/suspend','default','\x20days)','AdminController','currency','use','EXPIRED','shop','/users','getUsers','gateway','getProcessingPaymentsStats','__importStar','updateUser','2701390IQSIJj','‚ùå\x20[ADMIN]\x20Manual\x20CoinToPay\x20check\x20failed\x20for\x20payment\x20','__esModule','14USAMPJ','Each\x20new\x20payment\x20gets\x20individual\x20timers:\x201min,\x202min,\x207min,\x2012min,\x20then\x20hourly','Domain\x20is\x20responding\x20correctly','/payments/cleanup-pending','/payouts','/cointopay/stats','suspendUser','params','Router','length','gatewayPaymentId','../services/domainMonitoringService','cleanupStalePayments','2627860ipIkWy','updateUserSchema','getOwnPropertyDescriptor','Payment\x20not\x20found','log','CoinToPay\x20payment\x20status\x20checked\x20successfully','getTime','__createBinding','/auth','getPayoutById','configurable','2495485KDAruR','FAILED','/domain-monitoring/stats','/logs/stats','üîç\x20[ADMIN]\x20Manual\x20CoinToPay\x20check\x20requested\x20for\x20payment:\x20','coinToPayStatusService','PENDING','Failed\x20to\x20clean\x20old\x20logs','/payments/:id','authenticateToken','/payments','call','floor','defineProperty','/payout','post','getLogStats','1242173lTtpba','create','/payouts/:id','/payments/cleanup'];a24_0x30b7=function(){return _0x38807e;};return a24_0x30b7();}(function(_0x156a67,_0x467082){const _0x24f7aa=a24_0x56e5,_0x36b031=_0x156a67();while(!![]){try{const _0x44532a=parseInt(_0x24f7aa(0x192))/0x1+parseInt(_0x24f7aa(0x176))/0x2+-parseInt(_0x24f7aa(0x12b))/0x3*(parseInt(_0x24f7aa(0x130))/0x4)+-parseInt(_0x24f7aa(0x181))/0x5+-parseInt(_0x24f7aa(0x131))/0x6*(parseInt(_0x24f7aa(0x169))/0x7)+-parseInt(_0x24f7aa(0x149))/0x8+-parseInt(_0x24f7aa(0x13c))/0x9*(-parseInt(_0x24f7aa(0x166))/0xa);if(_0x44532a===_0x467082)break;else _0x36b031['push'](_0x36b031['shift']());}catch(_0x4db625){_0x36b031['push'](_0x36b031['shift']());}}}(a24_0x30b7,0xedb87));var __createBinding=this&&this[a24_0x1fdb6d(0x17d)]||(Object['create']?function(_0x3928c8,_0x42c20f,_0x2c0ad0,_0x2e0c2c){const _0x317ea9=a24_0x1fdb6d;if(_0x2e0c2c===undefined)_0x2e0c2c=_0x2c0ad0;var _0x4b0cdc=Object[_0x317ea9(0x178)](_0x42c20f,_0x2c0ad0);(!_0x4b0cdc||(_0x317ea9(0x19a)in _0x4b0cdc?!_0x42c20f['__esModule']:_0x4b0cdc['writable']||_0x4b0cdc[_0x317ea9(0x180)]))&&(_0x4b0cdc={'enumerable':!![],'get':function(){return _0x42c20f[_0x2c0ad0];}}),Object['defineProperty'](_0x3928c8,_0x2e0c2c,_0x4b0cdc);}:function(_0x323888,_0x37c040,_0x4c8b42,_0x1909b8){if(_0x1909b8===undefined)_0x1909b8=_0x4c8b42;_0x323888[_0x1909b8]=_0x37c040[_0x4c8b42];}),__setModuleDefault=this&&this[a24_0x1fdb6d(0x140)]||(Object[a24_0x1fdb6d(0x193)]?function(_0x4ddd9b,_0xb54cf){const _0x55c781=a24_0x1fdb6d;Object[_0x55c781(0x18e)](_0x4ddd9b,_0x55c781(0x159),{'enumerable':!![],'value':_0xb54cf});}:function(_0x9140ac,_0x3ce48f){const _0x3f5826=a24_0x1fdb6d;_0x9140ac[_0x3f5826(0x159)]=_0x3ce48f;}),__importStar=this&&this[a24_0x1fdb6d(0x164)]||(function(){var _0xafe8c9=function(_0xc3244f){const _0x3505ae=a24_0x56e5;return _0xafe8c9=Object[_0x3505ae(0x19b)]||function(_0x1216f7){const _0x172b4a=_0x3505ae;var _0x2fad2d=[];for(var _0x31379d in _0x1216f7)if(Object['prototype'][_0x172b4a(0x14f)][_0x172b4a(0x18c)](_0x1216f7,_0x31379d))_0x2fad2d[_0x2fad2d[_0x172b4a(0x172)]]=_0x31379d;return _0x2fad2d;},_0xafe8c9(_0xc3244f);};return function(_0x1fc663){const _0x37d187=a24_0x56e5;if(_0x1fc663&&_0x1fc663[_0x37d187(0x168)])return _0x1fc663;var _0x3afbb0={};if(_0x1fc663!=null){for(var _0x57d114=_0xafe8c9(_0x1fc663),_0x5158a7=0x0;_0x5158a7<_0x57d114[_0x37d187(0x172)];_0x5158a7++)if(_0x57d114[_0x5158a7]!==_0x37d187(0x159))__createBinding(_0x3afbb0,_0x1fc663,_0x57d114[_0x5158a7]);}return __setModuleDefault(_0x3afbb0,_0x1fc663),_0x3afbb0;};}());Object['defineProperty'](exports,a24_0x1fdb6d(0x168),{'value':!![]});function a24_0x56e5(_0x233e3a,_0x1dca90){_0x233e3a=_0x233e3a-0x127;const _0x30b7e8=a24_0x30b7();let _0x56e5b6=_0x30b7e8[_0x233e3a];return _0x56e5b6;}const express_1=require(a24_0x1fdb6d(0x13d)),adminController_1=require('../controllers/adminController'),validation_1=require(a24_0x1fdb6d(0x12d)),auth_1=require('../middleware/auth'),loggerService_1=require(a24_0x1fdb6d(0x1a0)),coinToPayStatusService_1=require(a24_0x1fdb6d(0x19e)),domainMonitoringService_1=require(a24_0x1fdb6d(0x174)),router=(0x0,express_1[a24_0x1fdb6d(0x171)])(),adminController=new adminController_1[(a24_0x1fdb6d(0x15b))]();router[a24_0x1fdb6d(0x15d)](auth_1[a24_0x1fdb6d(0x18a)],auth_1['requireAdmin']),router['get'](a24_0x1fdb6d(0x17e),adminController[a24_0x1fdb6d(0x141)]),router[a24_0x1fdb6d(0x19a)]('/statistics',adminController[a24_0x1fdb6d(0x197)]),router[a24_0x1fdb6d(0x19a)]('/merchant-statistics',adminController['getMerchantStatistics']),router[a24_0x1fdb6d(0x19a)]('/payout/stats',adminController['getPayoutStats']),router[a24_0x1fdb6d(0x19a)](a24_0x1fdb6d(0x155),adminController[a24_0x1fdb6d(0x134)]),router[a24_0x1fdb6d(0x19a)](a24_0x1fdb6d(0x12c),adminController['getMerchantsSelection']),router[a24_0x1fdb6d(0x190)](a24_0x1fdb6d(0x18f),(0x0,validation_1[a24_0x1fdb6d(0x127)])(validation_1[a24_0x1fdb6d(0x19d)]),adminController[a24_0x1fdb6d(0x143)]),router[a24_0x1fdb6d(0x19a)](a24_0x1fdb6d(0x16d),adminController['getPayouts']),router['get']('/payouts/:id',adminController[a24_0x1fdb6d(0x17f)]),router[a24_0x1fdb6d(0x152)](a24_0x1fdb6d(0x194),adminController['deletePayout']),router[a24_0x1fdb6d(0x19a)](a24_0x1fdb6d(0x18b),adminController[a24_0x1fdb6d(0x156)]),router[a24_0x1fdb6d(0x19a)](a24_0x1fdb6d(0x189),adminController[a24_0x1fdb6d(0x198)]),router[a24_0x1fdb6d(0x137)](a24_0x1fdb6d(0x189),adminController['updatePayment']),router[a24_0x1fdb6d(0x137)](a24_0x1fdb6d(0x154),(0x0,validation_1['validate'])(validation_1['updateCustomerDataSchema']),adminController['updateCustomerData']),router[a24_0x1fdb6d(0x19a)]('/payments/processing-stats',adminController[a24_0x1fdb6d(0x163)]),router[a24_0x1fdb6d(0x190)](a24_0x1fdb6d(0x195),adminController[a24_0x1fdb6d(0x175)]),router[a24_0x1fdb6d(0x190)](a24_0x1fdb6d(0x16c),adminController['cleanupStalePendingPayments']),router[a24_0x1fdb6d(0x190)]('/payments/cleanup-with-report',adminController[a24_0x1fdb6d(0x133)]),router[a24_0x1fdb6d(0x19a)](a24_0x1fdb6d(0x160),adminController[a24_0x1fdb6d(0x161)]),router[a24_0x1fdb6d(0x19a)](a24_0x1fdb6d(0x132),adminController[a24_0x1fdb6d(0x14d)]),router[a24_0x1fdb6d(0x190)](a24_0x1fdb6d(0x160),(0x0,validation_1[a24_0x1fdb6d(0x127)])(validation_1[a24_0x1fdb6d(0x146)]),adminController[a24_0x1fdb6d(0x14e)]),router['put']('/users/:id',(0x0,validation_1[a24_0x1fdb6d(0x127)])(validation_1[a24_0x1fdb6d(0x177)]),adminController[a24_0x1fdb6d(0x165)]),router[a24_0x1fdb6d(0x152)](a24_0x1fdb6d(0x132),adminController['deleteUser']),router['post'](a24_0x1fdb6d(0x158),adminController[a24_0x1fdb6d(0x16f)]),router['post'](a24_0x1fdb6d(0x129),adminController['activateUser']),router[a24_0x1fdb6d(0x19a)](a24_0x1fdb6d(0x184),(_0x1114b7,_0x38bcd1)=>{const _0x49c1df=a24_0x1fdb6d;try{const _0x448b95=loggerService_1['loggerService'][_0x49c1df(0x191)]();_0x38bcd1[_0x49c1df(0x136)]({'success':!![],'result':_0x448b95});}catch(_0x335f21){_0x38bcd1[_0x49c1df(0x12f)](0x1f4)[_0x49c1df(0x136)]({'success':![],'message':'Failed\x20to\x20get\x20log\x20statistics'});}}),router[a24_0x1fdb6d(0x190)](a24_0x1fdb6d(0x13b),(_0x2619e4,_0x36ee25)=>{const _0xb90c7c=a24_0x1fdb6d;try{const {daysToKeep:daysToKeep=0x1e}=_0x2619e4[_0xb90c7c(0x199)];loggerService_1[_0xb90c7c(0x147)][_0xb90c7c(0x14b)](daysToKeep),_0x36ee25[_0xb90c7c(0x136)]({'success':!![],'message':'Old\x20logs\x20cleaned\x20(kept\x20last\x20'+daysToKeep+_0xb90c7c(0x15a)});}catch(_0x976235){_0x36ee25[_0xb90c7c(0x12f)](0x1f4)['json']({'success':![],'message':_0xb90c7c(0x188)});}}),router[a24_0x1fdb6d(0x190)](a24_0x1fdb6d(0x14c),async(_0x43920d,_0x173b7a)=>{const _0x526f27=a24_0x1fdb6d;try{const {paymentId:_0x5399b3}=_0x43920d[_0x526f27(0x170)];console[_0x526f27(0x17a)](_0x526f27(0x185)+_0x5399b3),await coinToPayStatusService_1[_0x526f27(0x186)]['checkPaymentById'](_0x5399b3),_0x173b7a[_0x526f27(0x136)]({'success':!![],'message':_0x526f27(0x17b)});}catch(_0x153992){console[_0x526f27(0x153)](_0x526f27(0x167)+_0x43920d[_0x526f27(0x170)]['paymentId']+':',_0x153992),_0x173b7a[_0x526f27(0x12f)](0x1f4)[_0x526f27(0x136)]({'success':![],'message':_0x153992 instanceof Error?_0x153992[_0x526f27(0x145)]:'Failed\x20to\x20check\x20CoinToPay\x20payment\x20status'});}}),router[a24_0x1fdb6d(0x19a)](a24_0x1fdb6d(0x16e),(_0x309f07,_0x5bf0db)=>{const _0x4d9889=a24_0x1fdb6d;try{const _0xfed3f4=coinToPayStatusService_1[_0x4d9889(0x186)][_0x4d9889(0x144)]();_0x5bf0db[_0x4d9889(0x136)]({'success':!![],'result':{..._0xfed3f4,'description':'CoinToPay\x20automatic\x20status\x20checking\x20service','statusMapping':{'Paid':_0x4d9889(0x135),'Awaiting\x20Fiat':_0x4d9889(0x187),'waiting':_0x4d9889(0x187),'expired':_0x4d9889(0x15e),'failed':_0x4d9889(0x182)},'autoExpiryNote':_0x4d9889(0x148)+_0xfed3f4[_0x4d9889(0x151)]+_0x4d9889(0x139),'individualTimersNote':_0x4d9889(0x16a)}});}catch(_0x108844){_0x5bf0db[_0x4d9889(0x12f)](0x1f4)[_0x4d9889(0x136)]({'success':![],'message':_0x4d9889(0x150)});}}),router[a24_0x1fdb6d(0x19a)]('/cointopay/payment/:paymentId',async(_0x47bf40,_0x481104)=>{const _0x3b9431=a24_0x1fdb6d;try{const {paymentId:_0xad3eb7}=_0x47bf40['params'],_0x206653=coinToPayStatusService_1[_0x3b9431(0x186)]['getPaymentTimerInfo'](_0xad3eb7),_0x485864=(await Promise[_0x3b9431(0x13a)]()['then'](()=>__importStar(require(_0x3b9431(0x196)))))[_0x3b9431(0x159)],_0x3fc35e=await _0x485864['payment']['findUnique']({'where':{'id':_0xad3eb7},'select':{'id':!![],'gateway':!![],'gatewayPaymentId':!![],'status':!![],'amount':!![],'currency':!![],'createdAt':!![],'updatedAt':!![],'shopId':!![],'shop':{'select':{'name':!![],'username':!![]}}}});if(!_0x3fc35e)return _0x481104[_0x3b9431(0x12f)](0x194)['json']({'success':![],'message':_0x3b9431(0x179)});_0x481104['json']({'success':!![],'result':{'payment':{'id':_0x3fc35e['id'],'gateway':_0x3fc35e[_0x3b9431(0x162)],'gatewayPaymentId':_0x3fc35e[_0x3b9431(0x173)],'status':_0x3fc35e[_0x3b9431(0x12f)],'amount':_0x3fc35e['amount'],'currency':_0x3fc35e[_0x3b9431(0x15c)],'createdAt':_0x3fc35e[_0x3b9431(0x1a1)],'updatedAt':_0x3fc35e[_0x3b9431(0x19c)],'shop':_0x3fc35e[_0x3b9431(0x15f)]},'timers':_0x206653,'isCoinToPay':_0x3fc35e[_0x3b9431(0x162)]===_0x3b9431(0x19f),'ageInMinutes':Math[_0x3b9431(0x18d)]((Date[_0x3b9431(0x128)]()-_0x3fc35e[_0x3b9431(0x1a1)][_0x3b9431(0x17c)]())/(0x3e8*0x3c))}});}catch(_0x101f9e){_0x481104[_0x3b9431(0x12f)](0x1f4)[_0x3b9431(0x136)]({'success':![],'message':_0x101f9e instanceof Error?_0x101f9e['message']:_0x3b9431(0x13f)});}}),router[a24_0x1fdb6d(0x19a)](a24_0x1fdb6d(0x183),(_0x22e919,_0x23a7fb)=>{const _0x4723d0=a24_0x1fdb6d;try{const _0x21191f=domainMonitoringService_1[_0x4723d0(0x14a)][_0x4723d0(0x12e)]();_0x23a7fb[_0x4723d0(0x136)]({'success':!![],'result':{..._0x21191f,'description':_0x4723d0(0x142),'behavior':'Server\x20crashes\x20if\x20domain\x20is\x20not\x20responding\x20after\x20consecutive\x20failures','encoding':_0x4723d0(0x138)}});}catch(_0x3c9702){_0x23a7fb[_0x4723d0(0x12f)](0x1f4)[_0x4723d0(0x136)]({'success':![],'message':_0x4723d0(0x157)});}}),router['post']('/domain-monitoring/check',async(_0x5ed00b,_0x164e18)=>{const _0x4f7b7c=a24_0x1fdb6d;try{const _0x463a7f=await domainMonitoringService_1[_0x4f7b7c(0x14a)]['manualCheck']();_0x164e18[_0x4f7b7c(0x136)]({'success':!![],'result':{'domainAvailable':_0x463a7f,'message':_0x463a7f?_0x4f7b7c(0x16b):_0x4f7b7c(0x12a),'timestamp':new Date()['toISOString']()}});}catch(_0x409490){_0x164e18[_0x4f7b7c(0x12f)](0x1f4)[_0x4f7b7c(0x136)]({'success':![],'message':_0x409490 instanceof Error?_0x409490['message']:_0x4f7b7c(0x13e)});}}),exports[a24_0x1fdb6d(0x159)]=router;