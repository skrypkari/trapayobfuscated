'use strict';const a27_0x70b7d=a27_0x5809;(function(_0xe0af44,_0x3ecb73){const _0x458adf=a27_0x5809,_0x4e5c1a=_0xe0af44();while(!![]){try{const _0x585790=-parseInt(_0x458adf(0x18c))/0x1*(-parseInt(_0x458adf(0x142))/0x2)+parseInt(_0x458adf(0x111))/0x3*(-parseInt(_0x458adf(0x15f))/0x4)+parseInt(_0x458adf(0x14d))/0x5+parseInt(_0x458adf(0x11d))/0x6*(-parseInt(_0x458adf(0x143))/0x7)+parseInt(_0x458adf(0x18d))/0x8+-parseInt(_0x458adf(0x107))/0x9*(parseInt(_0x458adf(0x115))/0xa)+-parseInt(_0x458adf(0x168))/0xb*(-parseInt(_0x458adf(0x17a))/0xc);if(_0x585790===_0x3ecb73)break;else _0x4e5c1a['push'](_0x4e5c1a['shift']());}catch(_0x345110){_0x4e5c1a['push'](_0x4e5c1a['shift']());}}}(a27_0x5ba4,0x939c7));var __createBinding=this&&this[a27_0x70b7d(0xfa)]||(Object['create']?function(_0x565d74,_0x2e4932,_0x5d1fb0,_0x2a7220){const _0x48f911=a27_0x70b7d;if(_0x2a7220===undefined)_0x2a7220=_0x5d1fb0;var _0x2d5f3e=Object[_0x48f911(0x11e)](_0x2e4932,_0x5d1fb0);(!_0x2d5f3e||(_0x48f911(0x137)in _0x2d5f3e?!_0x2e4932[_0x48f911(0x165)]:_0x2d5f3e[_0x48f911(0x11a)]||_0x2d5f3e['configurable']))&&(_0x2d5f3e={'enumerable':!![],'get':function(){return _0x2e4932[_0x5d1fb0];}}),Object[_0x48f911(0x15d)](_0x565d74,_0x2a7220,_0x2d5f3e);}:function(_0x35788a,_0x42e4d6,_0x465742,_0x18e7ad){if(_0x18e7ad===undefined)_0x18e7ad=_0x465742;_0x35788a[_0x18e7ad]=_0x42e4d6[_0x465742];}),__setModuleDefault=this&&this[a27_0x70b7d(0x11b)]||(Object['create']?function(_0x41feb3,_0x4b92a5){const _0x514aab=a27_0x70b7d;Object[_0x514aab(0x15d)](_0x41feb3,'default',{'enumerable':!![],'value':_0x4b92a5});}:function(_0xd24e,_0x129694){const _0x483e0c=a27_0x70b7d;_0xd24e[_0x483e0c(0x10e)]=_0x129694;}),__importStar=this&&this[a27_0x70b7d(0x12f)]||(function(){var _0x3063f=function(_0x1c1607){return _0x3063f=Object['getOwnPropertyNames']||function(_0x1f34b9){const _0x151975=a27_0x5809;var _0x426772=[];for(var _0x47664e in _0x1f34b9)if(Object[_0x151975(0x10b)]['hasOwnProperty']['call'](_0x1f34b9,_0x47664e))_0x426772[_0x426772['length']]=_0x47664e;return _0x426772;},_0x3063f(_0x1c1607);};return function(_0x104d55){const _0xc74c0=a27_0x5809;if(_0x104d55&&_0x104d55[_0xc74c0(0x165)])return _0x104d55;var _0x35f6de={};if(_0x104d55!=null){for(var _0x54313c=_0x3063f(_0x104d55),_0x43f478=0x0;_0x43f478<_0x54313c[_0xc74c0(0xf9)];_0x43f478++)if(_0x54313c[_0x43f478]!==_0xc74c0(0x10e))__createBinding(_0x35f6de,_0x104d55,_0x54313c[_0x43f478]);}return __setModuleDefault(_0x35f6de,_0x104d55),_0x35f6de;};}());Object[a27_0x70b7d(0x15d)](exports,a27_0x70b7d(0x165),{'value':!![]});function a27_0x5ba4(){const _0xcdf94d=['/2fa/setup','updateCustomerDataSchema','9tsohxa','âŒ\x20[ADMIN]\x20Manual\x20CoinToPay\x20check\x20failed\x20for\x20payment\x20','domainMonitoringService','params','prototype','message','/logs/stats','default','/payouts/reports','getMerchantsSelection','12471TKykgL','/2fa/disable','json','/cointopay/stats','7869790RZJQaQ','Server\x20crashes\x20if\x20domain\x20is\x20not\x20responding\x20after\x20consecutive\x20failures','createPayoutSchema','EXPIRED','log','writable','__setModuleDefault','createUserSchema','289014QEhhmf','getOwnPropertyDescriptor','enableAdmin2FA','updateUser','body','/payments/:id','shop','/payments/:id/customer','getProcessingPaymentsStats','gatewayPaymentId','\x20days\x20if\x20not\x20paid','getGatewaySettings','/payments/processing-stats','use','cleanupStalePaymentsWithReport','\x20days)','paymentId','now','__importStar','updateUserSchema','PENDING','activateUser','updateGatewaySettings','requireAdmin','changeAdminPassword','PAID','get','Failed\x20to\x20get\x20domain\x20monitoring\x20statistics','getMonitoringStats','put','/login-logs/:shopId','/payments/cleanup','expirePaymentLinks','getUserById','Failed\x20to\x20get\x20log\x20statistics','getPayoutStats','Domain\x20check\x20failed','5142OuWSMd','70DvRbrj','validate','get2FASettings','updatePayout','getPayouts','Payment\x20not\x20found','getGatewayStatistics','/2fa/settings','delete','Router','892190sSafww','/auth','/merchant-statistics','status','expiryDays','cleanOldLogs','getTime','toISOString','getLoginLogs','/users/:id','getPayoutById','cleanupStalePayments','getUsers','enable2FA','/payout','manualCheck','defineProperty','Failed\x20to\x20check\x20CoinToPay\x20payment\x20status','1108WpPPjU','updatePayoutSchema','patch','/users/:id/activate','Domain\x20monitoring\x20service\x20for\x20amaterasy884.icu','getPaymentById','__esModule','getServiceStats','coinToPayStatusService','803vrKfae','ðŸ”\x20[ADMIN]\x20Manual\x20CoinToPay\x20check\x20requested\x20for\x20payment:\x20','createdAt','../middleware/validation','gateway','/cointopay/payment/:paymentId','/users','Payments\x20automatically\x20expire\x20after\x20','setupAdmin2FA','updatedAt','disable2FA','getStatistics','suspendUser','getPayoutReports','/users/:id/suspend','../config/database','Each\x20new\x20payment\x20gets\x20individual\x20timers:\x201min,\x202min,\x207min,\x2012min,\x20then\x20hourly','/gateway-settings/:gatewayId','172740zumuYZ','loggerService','/shops/:shopId/2fa/setup','authenticateToken','updateCustomerData','payment','Failed\x20to\x20get\x20CoinToPay\x20service\x20statistics','AdminController','/gateway-statistics/:gatewayId','/2fa/enable','post','deleteUser','Old\x20logs\x20cleaned\x20(kept\x20last\x20','/shops/:shopId/2fa/disable','/statistics','/domain-monitoring/stats','/payout/stats','/domain-monitoring/check','369tAthJJ','6774408XhxMfn','updatePayment','/cointopay/check/:paymentId','Domain\x20is\x20responding\x20correctly','getPaymentTimerInfo','changePasswordSchema','error','Requests\x20are\x20made\x20with\x20base64\x20encoded\x20URLs','getMerchantStatistics','resolve','/shops/:shopId/2fa/enable','/payouts/:id','cleanupStalePendingPayments','/payouts','getLogStats','amount','length','__createBinding','/payments/cleanup-with-report','createPayout','/logs/clean','/payout/:id','express','findUnique','/payments/cleanup-pending','/deposit','Failed\x20to\x20get\x20payment\x20information','disableAdmin2FA'];a27_0x5ba4=function(){return _0xcdf94d;};return a27_0x5ba4();}const express_1=require(a27_0x70b7d(0xff)),adminController_1=require('../controllers/adminController'),validation_1=require(a27_0x70b7d(0x16b)),auth_1=require('../middleware/auth'),loggerService_1=require('../services/loggerService'),coinToPayStatusService_1=require('../services/coinToPayStatusService'),domainMonitoringService_1=require('../services/domainMonitoringService'),router=(0x0,express_1[a27_0x70b7d(0x14c)])(),adminController=new adminController_1[(a27_0x70b7d(0x181))]();function a27_0x5809(_0x21eeb1,_0x57deb4){_0x21eeb1=_0x21eeb1-0xf8;const _0x5ba423=a27_0x5ba4();let _0x580959=_0x5ba423[_0x21eeb1];return _0x580959;}router[a27_0x70b7d(0x12a)](auth_1[a27_0x70b7d(0x17d)],auth_1[a27_0x70b7d(0x134)]),router[a27_0x70b7d(0x137)](a27_0x70b7d(0x14e),adminController['checkAuth']),router[a27_0x70b7d(0x137)](a27_0x70b7d(0x188),adminController[a27_0x70b7d(0x173)]),router['get'](a27_0x70b7d(0x14f),adminController[a27_0x70b7d(0x195)]),router[a27_0x70b7d(0x137)](a27_0x70b7d(0x18a),adminController[a27_0x70b7d(0x140)]),router['get']('/payout/merchants',adminController['getMerchantsAwaitingPayout']),router[a27_0x70b7d(0x137)](a27_0x70b7d(0x10f),adminController[a27_0x70b7d(0x175)]),router[a27_0x70b7d(0x137)]('/merchants/selection',adminController[a27_0x70b7d(0x110)]),router[a27_0x70b7d(0x184)](a27_0x70b7d(0x15b),(0x0,validation_1[a27_0x70b7d(0x144)])(validation_1[a27_0x70b7d(0x117)]),adminController[a27_0x70b7d(0xfc)]),router['put'](a27_0x70b7d(0xfe),(0x0,validation_1[a27_0x70b7d(0x144)])(validation_1[a27_0x70b7d(0x160)]),adminController[a27_0x70b7d(0x146)]),router['get'](a27_0x70b7d(0x19a),adminController[a27_0x70b7d(0x147)]),router[a27_0x70b7d(0x137)](a27_0x70b7d(0x198),adminController[a27_0x70b7d(0x157)]),router[a27_0x70b7d(0x14b)](a27_0x70b7d(0x198),adminController['deletePayout']),router[a27_0x70b7d(0x137)]('/payments',adminController['getPayments']),router[a27_0x70b7d(0x137)](a27_0x70b7d(0x122),adminController[a27_0x70b7d(0x164)]),router['put'](a27_0x70b7d(0x122),adminController[a27_0x70b7d(0x18e)]),router[a27_0x70b7d(0x13a)](a27_0x70b7d(0x124),(0x0,validation_1[a27_0x70b7d(0x144)])(validation_1[a27_0x70b7d(0x106)]),adminController[a27_0x70b7d(0x17e)]),router[a27_0x70b7d(0x137)](a27_0x70b7d(0x129),adminController[a27_0x70b7d(0x125)]),router[a27_0x70b7d(0x184)](a27_0x70b7d(0x13c),adminController[a27_0x70b7d(0x158)]),router[a27_0x70b7d(0x184)](a27_0x70b7d(0x101),adminController[a27_0x70b7d(0x199)]),router[a27_0x70b7d(0x184)](a27_0x70b7d(0xfb),adminController[a27_0x70b7d(0x12b)]),router[a27_0x70b7d(0x184)]('/payment-links/expire',adminController[a27_0x70b7d(0x13d)]),router[a27_0x70b7d(0x137)](a27_0x70b7d(0x16e),adminController[a27_0x70b7d(0x159)]),router[a27_0x70b7d(0x137)]('/users/:id',adminController[a27_0x70b7d(0x13e)]),router[a27_0x70b7d(0x184)](a27_0x70b7d(0x16e),(0x0,validation_1[a27_0x70b7d(0x144)])(validation_1[a27_0x70b7d(0x11c)]),adminController['createUser']),router['put'](a27_0x70b7d(0x156),(0x0,validation_1['validate'])(validation_1[a27_0x70b7d(0x130)]),adminController[a27_0x70b7d(0x120)]),router[a27_0x70b7d(0x14b)](a27_0x70b7d(0x156),adminController[a27_0x70b7d(0x185)]),router['get']('/shops/:shopId/wallets',adminController['getShopWallets']),router[a27_0x70b7d(0x184)](a27_0x70b7d(0x17c),adminController['setup2FA']),router['post'](a27_0x70b7d(0x197),adminController[a27_0x70b7d(0x15a)]),router[a27_0x70b7d(0x184)](a27_0x70b7d(0x187),adminController[a27_0x70b7d(0x172)]),router[a27_0x70b7d(0x184)]('/password',(0x0,validation_1['validate'])(validation_1[a27_0x70b7d(0x192)]),adminController[a27_0x70b7d(0x135)]),router[a27_0x70b7d(0x137)](a27_0x70b7d(0x14a),adminController[a27_0x70b7d(0x145)]),router['post'](a27_0x70b7d(0x105),adminController[a27_0x70b7d(0x170)]),router[a27_0x70b7d(0x184)](a27_0x70b7d(0x183),adminController[a27_0x70b7d(0x11f)]),router['post'](a27_0x70b7d(0x112),adminController[a27_0x70b7d(0x104)]),router[a27_0x70b7d(0x184)](a27_0x70b7d(0x176),adminController[a27_0x70b7d(0x174)]),router[a27_0x70b7d(0x184)](a27_0x70b7d(0x162),adminController[a27_0x70b7d(0x132)]),router[a27_0x70b7d(0x184)](a27_0x70b7d(0x102),adminController['depositBalance']),router[a27_0x70b7d(0x137)](a27_0x70b7d(0x13b),adminController[a27_0x70b7d(0x155)]),router['get']('/gateway-settings',adminController[a27_0x70b7d(0x128)]),router[a27_0x70b7d(0x161)](a27_0x70b7d(0x179),adminController[a27_0x70b7d(0x133)]),router[a27_0x70b7d(0x137)](a27_0x70b7d(0x182),adminController[a27_0x70b7d(0x149)]),router['get'](a27_0x70b7d(0x10d),(_0x1249e2,_0x5d672a)=>{const _0x17edfa=a27_0x70b7d;try{const _0x4e7c85=loggerService_1[_0x17edfa(0x17b)][_0x17edfa(0x19b)]();_0x5d672a[_0x17edfa(0x113)]({'success':!![],'result':_0x4e7c85});}catch(_0x77155f){_0x5d672a['status'](0x1f4)[_0x17edfa(0x113)]({'success':![],'message':_0x17edfa(0x13f)});}}),router['post'](a27_0x70b7d(0xfd),(_0x2db489,_0x4c006f)=>{const _0x4dbe4c=a27_0x70b7d;try{const {daysToKeep:daysToKeep=0x1e}=_0x2db489[_0x4dbe4c(0x121)];loggerService_1[_0x4dbe4c(0x17b)][_0x4dbe4c(0x152)](daysToKeep),_0x4c006f[_0x4dbe4c(0x113)]({'success':!![],'message':_0x4dbe4c(0x186)+daysToKeep+_0x4dbe4c(0x12c)});}catch(_0x432646){_0x4c006f[_0x4dbe4c(0x150)](0x1f4)['json']({'success':![],'message':'Failed\x20to\x20clean\x20old\x20logs'});}}),router['post'](a27_0x70b7d(0x18f),async(_0x24d70c,_0x3a0360)=>{const _0x5ad3c7=a27_0x70b7d;try{const {paymentId:_0x15a39d}=_0x24d70c[_0x5ad3c7(0x10a)];console[_0x5ad3c7(0x119)](_0x5ad3c7(0x169)+_0x15a39d),await coinToPayStatusService_1[_0x5ad3c7(0x167)]['checkPaymentById'](_0x15a39d),_0x3a0360[_0x5ad3c7(0x113)]({'success':!![],'message':'CoinToPay\x20payment\x20status\x20checked\x20successfully'});}catch(_0x3b4f70){console[_0x5ad3c7(0x193)](_0x5ad3c7(0x108)+_0x24d70c[_0x5ad3c7(0x10a)][_0x5ad3c7(0x12d)]+':',_0x3b4f70),_0x3a0360[_0x5ad3c7(0x150)](0x1f4)[_0x5ad3c7(0x113)]({'success':![],'message':_0x3b4f70 instanceof Error?_0x3b4f70[_0x5ad3c7(0x10c)]:_0x5ad3c7(0x15e)});}}),router[a27_0x70b7d(0x137)](a27_0x70b7d(0x114),(_0x5ce3c2,_0x56f6c7)=>{const _0x28d750=a27_0x70b7d;try{const _0x1017ab=coinToPayStatusService_1[_0x28d750(0x167)][_0x28d750(0x166)]();_0x56f6c7[_0x28d750(0x113)]({'success':!![],'result':{..._0x1017ab,'description':'CoinToPay\x20automatic\x20status\x20checking\x20service','statusMapping':{'Paid':_0x28d750(0x136),'Awaiting\x20Fiat':_0x28d750(0x131),'waiting':_0x28d750(0x131),'expired':_0x28d750(0x118),'failed':'FAILED'},'autoExpiryNote':_0x28d750(0x16f)+_0x1017ab[_0x28d750(0x151)]+_0x28d750(0x127),'individualTimersNote':_0x28d750(0x178)}});}catch(_0x1a766a){_0x56f6c7[_0x28d750(0x150)](0x1f4)[_0x28d750(0x113)]({'success':![],'message':_0x28d750(0x180)});}}),router[a27_0x70b7d(0x137)](a27_0x70b7d(0x16d),async(_0x41a2bd,_0x2f17a1)=>{const _0x11f2c0=a27_0x70b7d;try{const {paymentId:_0x206469}=_0x41a2bd[_0x11f2c0(0x10a)],_0x19d5ec=coinToPayStatusService_1['coinToPayStatusService'][_0x11f2c0(0x191)](_0x206469),_0x539031=(await Promise[_0x11f2c0(0x196)]()['then'](()=>__importStar(require(_0x11f2c0(0x177)))))[_0x11f2c0(0x10e)],_0x1e15d5=await _0x539031[_0x11f2c0(0x17f)][_0x11f2c0(0x100)]({'where':{'id':_0x206469},'select':{'id':!![],'gateway':!![],'gatewayPaymentId':!![],'status':!![],'amount':!![],'currency':!![],'createdAt':!![],'updatedAt':!![],'shopId':!![],'shop':{'select':{'name':!![],'username':!![]}}}});if(!_0x1e15d5)return _0x2f17a1[_0x11f2c0(0x150)](0x194)[_0x11f2c0(0x113)]({'success':![],'message':_0x11f2c0(0x148)});_0x2f17a1[_0x11f2c0(0x113)]({'success':!![],'result':{'payment':{'id':_0x1e15d5['id'],'gateway':_0x1e15d5['gateway'],'gatewayPaymentId':_0x1e15d5[_0x11f2c0(0x126)],'status':_0x1e15d5[_0x11f2c0(0x150)],'amount':_0x1e15d5[_0x11f2c0(0xf8)],'currency':_0x1e15d5['currency'],'createdAt':_0x1e15d5[_0x11f2c0(0x16a)],'updatedAt':_0x1e15d5[_0x11f2c0(0x171)],'shop':_0x1e15d5[_0x11f2c0(0x123)]},'timers':_0x19d5ec,'isCoinToPay':_0x1e15d5[_0x11f2c0(0x16c)]==='cointopay','ageInMinutes':Math['floor']((Date[_0x11f2c0(0x12e)]()-_0x1e15d5[_0x11f2c0(0x16a)][_0x11f2c0(0x153)]())/(0x3e8*0x3c))}});}catch(_0x12901c){_0x2f17a1[_0x11f2c0(0x150)](0x1f4)['json']({'success':![],'message':_0x12901c instanceof Error?_0x12901c['message']:_0x11f2c0(0x103)});}}),router['get'](a27_0x70b7d(0x189),(_0x4fc1cd,_0xf43510)=>{const _0x4e668e=a27_0x70b7d;try{const _0x470cb7=domainMonitoringService_1[_0x4e668e(0x109)][_0x4e668e(0x139)]();_0xf43510['json']({'success':!![],'result':{..._0x470cb7,'description':_0x4e668e(0x163),'behavior':_0x4e668e(0x116),'encoding':_0x4e668e(0x194)}});}catch(_0x4013e9){_0xf43510[_0x4e668e(0x150)](0x1f4)['json']({'success':![],'message':_0x4e668e(0x138)});}}),router[a27_0x70b7d(0x184)](a27_0x70b7d(0x18b),async(_0x46747c,_0x4b43ca)=>{const _0x4fd92b=a27_0x70b7d;try{const _0x27e52e=await domainMonitoringService_1[_0x4fd92b(0x109)][_0x4fd92b(0x15c)]();_0x4b43ca['json']({'success':!![],'result':{'domainAvailable':_0x27e52e,'message':_0x27e52e?_0x4fd92b(0x190):_0x4fd92b(0x141),'timestamp':new Date()[_0x4fd92b(0x154)]()}});}catch(_0x1d3b2f){_0x4b43ca[_0x4fd92b(0x150)](0x1f4)[_0x4fd92b(0x113)]({'success':![],'message':_0x1d3b2f instanceof Error?_0x1d3b2f[_0x4fd92b(0x10c)]:'Failed\x20to\x20perform\x20manual\x20domain\x20check'});}}),exports[a27_0x70b7d(0x10e)]=router;