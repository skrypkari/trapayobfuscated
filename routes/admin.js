'use strict';const a19_0x154996=a19_0x4308;function a19_0x4308(_0x473c99,_0x4661fd){const _0x3b11af=a19_0x3b11();return a19_0x4308=function(_0x430884,_0xe06226){_0x430884=_0x430884-0x112;let _0x5dd4ed=_0x3b11af[_0x430884];return _0x5dd4ed;},a19_0x4308(_0x473c99,_0x4661fd);}(function(_0x285845,_0x4247e2){const _0x5609ce=a19_0x4308,_0x225841=_0x285845();while(!![]){try{const _0x65029f=-parseInt(_0x5609ce(0x14b))/0x1+-parseInt(_0x5609ce(0x168))/0x2*(-parseInt(_0x5609ce(0x129))/0x3)+-parseInt(_0x5609ce(0x186))/0x4+parseInt(_0x5609ce(0x13e))/0x5+-parseInt(_0x5609ce(0x16e))/0x6*(parseInt(_0x5609ce(0x12a))/0x7)+-parseInt(_0x5609ce(0x184))/0x8+parseInt(_0x5609ce(0x144))/0x9*(parseInt(_0x5609ce(0x118))/0xa);if(_0x65029f===_0x4247e2)break;else _0x225841['push'](_0x225841['shift']());}catch(_0x1bfa97){_0x225841['push'](_0x225841['shift']());}}}(a19_0x3b11,0xf0288));function a19_0x3b11(){const _0x52e8ef=['then','PENDING','‚ùå\x20[ADMIN]\x20Manual\x20CoinToPay\x20check\x20failed\x20for\x20payment\x20','../controllers/adminController','Failed\x20to\x20get\x20log\x20statistics','/domain-monitoring/stats','getPayouts','Failed\x20to\x20get\x20CoinToPay\x20service\x20statistics','getServiceStats','/users/:id/activate','log','defineProperty','getUserById','4831672FtBSAJ','now','3517100ZXUbIA','delete','/statistics','manualCheck','checkPaymentById','cleanOldLogs','updatePayment','PAID','Domain\x20monitoring\x20service\x20for\x20amaterasy884.icu','CoinToPay\x20payment\x20status\x20checked\x20successfully','post','create','getLogStats','Failed\x20to\x20clean\x20old\x20logs','body','findUnique','21110240KMRqFh','../middleware/validation','../services/domainMonitoringService','EXPIRED','createdAt','checkAuth','/cointopay/payment/:paymentId','toISOString','gatewayPaymentId','Server\x20crashes\x20if\x20domain\x20is\x20not\x20responding\x20after\x20consecutive\x20failures','\x20days\x20if\x20not\x20paid','params','validate','floor','status','writable','getTime','3jkZFzp','70637VisDLd','/cointopay/stats','/payments/:id/customer','/payouts','getPayoutById','getStatistics','Requests\x20are\x20made\x20with\x20base64\x20encoded\x20URLs','domainMonitoringService','loggerService','expiryDays','authenticateToken','Each\x20new\x20payment\x20gets\x20individual\x20timers:\x201min,\x202min,\x207min,\x2012min,\x20then\x20hourly','../config/database','shop','__setModuleDefault','../services/loggerService','length','updateUser','suspendUser','updateUserSchema','6221255TSHKXI','getMerchantStatistics','../middleware/auth','deleteUser','createPayoutSchema','AdminController','9iKWWpp','updateCustomerDataSchema','currency','put','FAILED','Failed\x20to\x20get\x20domain\x20monitoring\x20statistics','createUserSchema','1263287UTrzOW','coinToPayStatusService','requireAdmin','prototype','CoinToPay\x20automatic\x20status\x20checking\x20service','/payouts/:id','createPayout','configurable','amount','Payments\x20automatically\x20expire\x20after\x20','__createBinding','/payments/:id','/logs/clean','/payments','/domain-monitoring/check','getOwnPropertyNames','message','cointopay','getPaymentTimerInfo','default','get','getOwnPropertyDescriptor','gateway','/users','json','__esModule','paymentId','updatedAt','use','1092962MGNUjd','/payout/stats','getPaymentById','/cointopay/check/:paymentId','/users/:id/suspend','getPayoutStats','102fSlUpw','/payout/merchants','createUser','deletePayout','Payment\x20not\x20found','Domain\x20is\x20responding\x20correctly','__importStar','Domain\x20check\x20failed','express'];a19_0x3b11=function(){return _0x52e8ef;};return a19_0x3b11();}var __createBinding=this&&this[a19_0x154996(0x155)]||(Object[a19_0x154996(0x113)]?function(_0x235061,_0x1353de,_0x34e506,_0x1181da){const _0xbd2eca=a19_0x154996;if(_0x1181da===undefined)_0x1181da=_0x34e506;var _0xef59dc=Object[_0xbd2eca(0x160)](_0x1353de,_0x34e506);(!_0xef59dc||('get'in _0xef59dc?!_0x1353de['__esModule']:_0xef59dc[_0xbd2eca(0x127)]||_0xef59dc[_0xbd2eca(0x152)]))&&(_0xef59dc={'enumerable':!![],'get':function(){return _0x1353de[_0x34e506];}}),Object['defineProperty'](_0x235061,_0x1181da,_0xef59dc);}:function(_0x8f9198,_0x2a22d9,_0x1c53c9,_0x2efc98){if(_0x2efc98===undefined)_0x2efc98=_0x1c53c9;_0x8f9198[_0x2efc98]=_0x2a22d9[_0x1c53c9];}),__setModuleDefault=this&&this[a19_0x154996(0x138)]||(Object['create']?function(_0x1c846,_0x10934){const _0x2958a2=a19_0x154996;Object[_0x2958a2(0x182)](_0x1c846,_0x2958a2(0x15e),{'enumerable':!![],'value':_0x10934});}:function(_0x2f04fe,_0x16d11f){_0x2f04fe['default']=_0x16d11f;}),__importStar=this&&this[a19_0x154996(0x174)]||(function(){var _0x4ce798=function(_0x43cc21){const _0x325c34=a19_0x4308;return _0x4ce798=Object[_0x325c34(0x15a)]||function(_0xe21024){const _0x1ce0d7=_0x325c34;var _0x471948=[];for(var _0x246236 in _0xe21024)if(Object[_0x1ce0d7(0x14e)]['hasOwnProperty']['call'](_0xe21024,_0x246236))_0x471948[_0x471948[_0x1ce0d7(0x13a)]]=_0x246236;return _0x471948;},_0x4ce798(_0x43cc21);};return function(_0x6156c2){const _0x7665ad=a19_0x4308;if(_0x6156c2&&_0x6156c2[_0x7665ad(0x164)])return _0x6156c2;var _0x1d5780={};if(_0x6156c2!=null){for(var _0x5106ed=_0x4ce798(_0x6156c2),_0x46978d=0x0;_0x46978d<_0x5106ed[_0x7665ad(0x13a)];_0x46978d++)if(_0x5106ed[_0x46978d]!==_0x7665ad(0x15e))__createBinding(_0x1d5780,_0x6156c2,_0x5106ed[_0x46978d]);}return __setModuleDefault(_0x1d5780,_0x6156c2),_0x1d5780;};}());Object[a19_0x154996(0x182)](exports,a19_0x154996(0x164),{'value':!![]});const express_1=require(a19_0x154996(0x176)),adminController_1=require(a19_0x154996(0x17a)),validation_1=require(a19_0x154996(0x119)),auth_1=require(a19_0x154996(0x140)),loggerService_1=require(a19_0x154996(0x139)),coinToPayStatusService_1=require('../services/coinToPayStatusService'),domainMonitoringService_1=require(a19_0x154996(0x11a)),router=(0x0,express_1['Router'])(),adminController=new adminController_1[(a19_0x154996(0x143))]();router[a19_0x154996(0x167)](auth_1[a19_0x154996(0x134)],auth_1[a19_0x154996(0x14d)]),router[a19_0x154996(0x15f)]('/auth',adminController[a19_0x154996(0x11d)]),router[a19_0x154996(0x15f)](a19_0x154996(0x188),adminController[a19_0x154996(0x12f)]),router[a19_0x154996(0x15f)]('/merchant-statistics',adminController[a19_0x154996(0x13f)]),router[a19_0x154996(0x15f)](a19_0x154996(0x169),adminController[a19_0x154996(0x16d)]),router[a19_0x154996(0x15f)](a19_0x154996(0x16f),adminController['getMerchantsAwaitingPayout']),router['post']('/payout',(0x0,validation_1['validate'])(validation_1[a19_0x154996(0x142)]),adminController[a19_0x154996(0x151)]),router['get'](a19_0x154996(0x12d),adminController[a19_0x154996(0x17d)]),router['get'](a19_0x154996(0x150),adminController[a19_0x154996(0x12e)]),router['delete'](a19_0x154996(0x150),adminController[a19_0x154996(0x171)]),router[a19_0x154996(0x15f)](a19_0x154996(0x158),adminController['getPayments']),router[a19_0x154996(0x15f)](a19_0x154996(0x156),adminController[a19_0x154996(0x16a)]),router[a19_0x154996(0x147)]('/payments/:id',adminController[a19_0x154996(0x18c)]),router['put'](a19_0x154996(0x12c),(0x0,validation_1[a19_0x154996(0x124)])(validation_1[a19_0x154996(0x145)]),adminController['updateCustomerData']),router['get'](a19_0x154996(0x162),adminController['getUsers']),router[a19_0x154996(0x15f)]('/users/:id',adminController[a19_0x154996(0x183)]),router[a19_0x154996(0x112)](a19_0x154996(0x162),(0x0,validation_1['validate'])(validation_1[a19_0x154996(0x14a)]),adminController[a19_0x154996(0x170)]),router[a19_0x154996(0x147)]('/users/:id',(0x0,validation_1[a19_0x154996(0x124)])(validation_1[a19_0x154996(0x13d)]),adminController[a19_0x154996(0x13b)]),router[a19_0x154996(0x187)]('/users/:id',adminController[a19_0x154996(0x141)]),router['post'](a19_0x154996(0x16c),adminController[a19_0x154996(0x13c)]),router[a19_0x154996(0x112)](a19_0x154996(0x180),adminController['activateUser']),router[a19_0x154996(0x15f)]('/logs/stats',(_0x1eed71,_0x41e5e2)=>{const _0x151a68=a19_0x154996;try{const _0x439f45=loggerService_1[_0x151a68(0x132)][_0x151a68(0x114)]();_0x41e5e2[_0x151a68(0x163)]({'success':!![],'result':_0x439f45});}catch(_0x45bce4){_0x41e5e2[_0x151a68(0x126)](0x1f4)[_0x151a68(0x163)]({'success':![],'message':_0x151a68(0x17b)});}}),router[a19_0x154996(0x112)](a19_0x154996(0x157),(_0x1efb1c,_0x20614a)=>{const _0x4b646b=a19_0x154996;try{const {daysToKeep:daysToKeep=0x1e}=_0x1efb1c[_0x4b646b(0x116)];loggerService_1[_0x4b646b(0x132)][_0x4b646b(0x18b)](daysToKeep),_0x20614a['json']({'success':!![],'message':'Old\x20logs\x20cleaned\x20(kept\x20last\x20'+daysToKeep+'\x20days)'});}catch(_0x31ebda){_0x20614a['status'](0x1f4)[_0x4b646b(0x163)]({'success':![],'message':_0x4b646b(0x115)});}}),router[a19_0x154996(0x112)](a19_0x154996(0x16b),async(_0x325361,_0x564ff7)=>{const _0x54d43d=a19_0x154996;try{const {paymentId:_0x886924}=_0x325361['params'];console[_0x54d43d(0x181)]('üîç\x20[ADMIN]\x20Manual\x20CoinToPay\x20check\x20requested\x20for\x20payment:\x20'+_0x886924),await coinToPayStatusService_1[_0x54d43d(0x14c)][_0x54d43d(0x18a)](_0x886924),_0x564ff7['json']({'success':!![],'message':_0x54d43d(0x18f)});}catch(_0x2e4f3c){console['error'](_0x54d43d(0x179)+_0x325361[_0x54d43d(0x123)][_0x54d43d(0x165)]+':',_0x2e4f3c),_0x564ff7[_0x54d43d(0x126)](0x1f4)[_0x54d43d(0x163)]({'success':![],'message':_0x2e4f3c instanceof Error?_0x2e4f3c['message']:'Failed\x20to\x20check\x20CoinToPay\x20payment\x20status'});}}),router[a19_0x154996(0x15f)](a19_0x154996(0x12b),(_0x5d528a,_0x55e376)=>{const _0x3772e3=a19_0x154996;try{const _0x16096b=coinToPayStatusService_1[_0x3772e3(0x14c)][_0x3772e3(0x17f)]();_0x55e376[_0x3772e3(0x163)]({'success':!![],'result':{..._0x16096b,'description':_0x3772e3(0x14f),'statusMapping':{'Paid':_0x3772e3(0x18d),'Awaiting\x20Fiat':_0x3772e3(0x178),'waiting':_0x3772e3(0x178),'expired':_0x3772e3(0x11b),'failed':_0x3772e3(0x148)},'autoExpiryNote':_0x3772e3(0x154)+_0x16096b[_0x3772e3(0x133)]+_0x3772e3(0x122),'individualTimersNote':_0x3772e3(0x135)}});}catch(_0x2a956b){_0x55e376[_0x3772e3(0x126)](0x1f4)['json']({'success':![],'message':_0x3772e3(0x17e)});}}),router[a19_0x154996(0x15f)](a19_0x154996(0x11e),async(_0x374f21,_0x415638)=>{const _0x2d29ed=a19_0x154996;try{const {paymentId:_0x2c28ab}=_0x374f21['params'],_0x4380af=coinToPayStatusService_1['coinToPayStatusService'][_0x2d29ed(0x15d)](_0x2c28ab),_0x2df822=(await Promise['resolve']()[_0x2d29ed(0x177)](()=>__importStar(require(_0x2d29ed(0x136)))))[_0x2d29ed(0x15e)],_0x49d1fa=await _0x2df822['payment'][_0x2d29ed(0x117)]({'where':{'id':_0x2c28ab},'select':{'id':!![],'gateway':!![],'gatewayPaymentId':!![],'status':!![],'amount':!![],'currency':!![],'createdAt':!![],'updatedAt':!![],'shopId':!![],'shop':{'select':{'name':!![],'username':!![]}}}});if(!_0x49d1fa)return _0x415638[_0x2d29ed(0x126)](0x194)[_0x2d29ed(0x163)]({'success':![],'message':_0x2d29ed(0x172)});_0x415638[_0x2d29ed(0x163)]({'success':!![],'result':{'payment':{'id':_0x49d1fa['id'],'gateway':_0x49d1fa['gateway'],'gatewayPaymentId':_0x49d1fa[_0x2d29ed(0x120)],'status':_0x49d1fa[_0x2d29ed(0x126)],'amount':_0x49d1fa[_0x2d29ed(0x153)],'currency':_0x49d1fa[_0x2d29ed(0x146)],'createdAt':_0x49d1fa[_0x2d29ed(0x11c)],'updatedAt':_0x49d1fa[_0x2d29ed(0x166)],'shop':_0x49d1fa[_0x2d29ed(0x137)]},'timers':_0x4380af,'isCoinToPay':_0x49d1fa[_0x2d29ed(0x161)]===_0x2d29ed(0x15c),'ageInMinutes':Math[_0x2d29ed(0x125)]((Date[_0x2d29ed(0x185)]()-_0x49d1fa[_0x2d29ed(0x11c)][_0x2d29ed(0x128)]())/(0x3e8*0x3c))}});}catch(_0x278b49){_0x415638['status'](0x1f4)[_0x2d29ed(0x163)]({'success':![],'message':_0x278b49 instanceof Error?_0x278b49[_0x2d29ed(0x15b)]:'Failed\x20to\x20get\x20payment\x20information'});}}),router[a19_0x154996(0x15f)](a19_0x154996(0x17c),(_0x522e79,_0x49c5f1)=>{const _0x4e8d03=a19_0x154996;try{const _0x2b1647=domainMonitoringService_1['domainMonitoringService']['getMonitoringStats']();_0x49c5f1[_0x4e8d03(0x163)]({'success':!![],'result':{..._0x2b1647,'description':_0x4e8d03(0x18e),'behavior':_0x4e8d03(0x121),'encoding':_0x4e8d03(0x130)}});}catch(_0x434759){_0x49c5f1[_0x4e8d03(0x126)](0x1f4)[_0x4e8d03(0x163)]({'success':![],'message':_0x4e8d03(0x149)});}}),router['post'](a19_0x154996(0x159),async(_0x4b1ea1,_0x138809)=>{const _0x4efd99=a19_0x154996;try{const _0x3b423e=await domainMonitoringService_1[_0x4efd99(0x131)][_0x4efd99(0x189)]();_0x138809[_0x4efd99(0x163)]({'success':!![],'result':{'domainAvailable':_0x3b423e,'message':_0x3b423e?_0x4efd99(0x173):_0x4efd99(0x175),'timestamp':new Date()[_0x4efd99(0x11f)]()}});}catch(_0x762f44){_0x138809[_0x4efd99(0x126)](0x1f4)[_0x4efd99(0x163)]({'success':![],'message':_0x762f44 instanceof Error?_0x762f44[_0x4efd99(0x15b)]:'Failed\x20to\x20perform\x20manual\x20domain\x20check'});}}),exports['default']=router;