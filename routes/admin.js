'use strict';const a20_0x5127b8=a20_0x1f1a;(function(_0x2fb94b,_0x22602d){const _0x4058a6=a20_0x1f1a,_0x508cea=_0x2fb94b();while(!![]){try{const _0x6e34d6=-parseInt(_0x4058a6(0x204))/0x1+parseInt(_0x4058a6(0x203))/0x2+-parseInt(_0x4058a6(0x1d6))/0x3+-parseInt(_0x4058a6(0x21a))/0x4*(parseInt(_0x4058a6(0x1b0))/0x5)+-parseInt(_0x4058a6(0x1b6))/0x6*(parseInt(_0x4058a6(0x1f5))/0x7)+parseInt(_0x4058a6(0x1d0))/0x8+parseInt(_0x4058a6(0x201))/0x9*(parseInt(_0x4058a6(0x1d7))/0xa);if(_0x6e34d6===_0x22602d)break;else _0x508cea['push'](_0x508cea['shift']());}catch(_0x39b43b){_0x508cea['push'](_0x508cea['shift']());}}}(a20_0x356e,0xd408c));function a20_0x1f1a(_0x408c0b,_0x22aea8){const _0x356eb3=a20_0x356e();return a20_0x1f1a=function(_0x1f1a48,_0x2481fe){_0x1f1a48=_0x1f1a48-0x1ad;let _0x3f4361=_0x356eb3[_0x1f1a48];return _0x3f4361;},a20_0x1f1a(_0x408c0b,_0x22aea8);}var __createBinding=this&&this[a20_0x5127b8(0x1c2)]||(Object[a20_0x5127b8(0x1ea)]?function(_0x40328a,_0xd30a75,_0x45c436,_0x564a97){const _0x13236c=a20_0x5127b8;if(_0x564a97===undefined)_0x564a97=_0x45c436;var _0xb2e390=Object[_0x13236c(0x208)](_0xd30a75,_0x45c436);(!_0xb2e390||(_0x13236c(0x1cc)in _0xb2e390?!_0xd30a75[_0x13236c(0x1d2)]:_0xb2e390['writable']||_0xb2e390[_0x13236c(0x1ee)]))&&(_0xb2e390={'enumerable':!![],'get':function(){return _0xd30a75[_0x45c436];}}),Object['defineProperty'](_0x40328a,_0x564a97,_0xb2e390);}:function(_0x5d2399,_0xdd7261,_0x12b698,_0x19d317){if(_0x19d317===undefined)_0x19d317=_0x12b698;_0x5d2399[_0x19d317]=_0xdd7261[_0x12b698];}),__setModuleDefault=this&&this[a20_0x5127b8(0x1e4)]||(Object[a20_0x5127b8(0x1ea)]?function(_0x38bb66,_0x3098b6){const _0x1f093d=a20_0x5127b8;Object[_0x1f093d(0x1dd)](_0x38bb66,_0x1f093d(0x1fc),{'enumerable':!![],'value':_0x3098b6});}:function(_0x6d19e8,_0x8596f0){const _0x2a785e=a20_0x5127b8;_0x6d19e8[_0x2a785e(0x1fc)]=_0x8596f0;}),__importStar=this&&this[a20_0x5127b8(0x1b4)]||(function(){var _0x29a8b5=function(_0x5bb656){return _0x29a8b5=Object['getOwnPropertyNames']||function(_0x3ac5a5){const _0x527eec=a20_0x1f1a;var _0x1ee049=[];for(var _0xf023f8 in _0x3ac5a5)if(Object['prototype'][_0x527eec(0x1e8)]['call'](_0x3ac5a5,_0xf023f8))_0x1ee049[_0x1ee049[_0x527eec(0x1f8)]]=_0xf023f8;return _0x1ee049;},_0x29a8b5(_0x5bb656);};return function(_0x35601c){const _0x44075d=a20_0x1f1a;if(_0x35601c&&_0x35601c[_0x44075d(0x1d2)])return _0x35601c;var _0x48b450={};if(_0x35601c!=null){for(var _0x3e0490=_0x29a8b5(_0x35601c),_0x5210e9=0x0;_0x5210e9<_0x3e0490[_0x44075d(0x1f8)];_0x5210e9++)if(_0x3e0490[_0x5210e9]!=='default')__createBinding(_0x48b450,_0x35601c,_0x3e0490[_0x5210e9]);}return __setModuleDefault(_0x48b450,_0x35601c),_0x48b450;};}());Object[a20_0x5127b8(0x1dd)](exports,a20_0x5127b8(0x1d2),{'value':!![]});const express_1=require('express'),adminController_1=require(a20_0x5127b8(0x216)),validation_1=require('../middleware/validation'),auth_1=require('../middleware/auth'),loggerService_1=require(a20_0x5127b8(0x1e1)),coinToPayStatusService_1=require(a20_0x5127b8(0x1c0)),domainMonitoringService_1=require('../services/domainMonitoringService'),router=(0x0,express_1['Router'])(),adminController=new adminController_1[(a20_0x5127b8(0x211))]();router[a20_0x5127b8(0x1e2)](auth_1['authenticateToken'],auth_1[a20_0x5127b8(0x21c)]),router[a20_0x5127b8(0x1cc)]('/auth',adminController[a20_0x5127b8(0x218)]),router['get'](a20_0x5127b8(0x20c),adminController[a20_0x5127b8(0x1e3)]),router[a20_0x5127b8(0x1cc)](a20_0x5127b8(0x1ae),adminController['getMerchantStatistics']),router[a20_0x5127b8(0x1cc)](a20_0x5127b8(0x1b8),adminController[a20_0x5127b8(0x1c5)]),router[a20_0x5127b8(0x1cc)](a20_0x5127b8(0x215),adminController[a20_0x5127b8(0x1d1)]),router[a20_0x5127b8(0x1cc)](a20_0x5127b8(0x1af),adminController[a20_0x5127b8(0x1f7)]),router[a20_0x5127b8(0x1db)](a20_0x5127b8(0x1f9),(0x0,validation_1[a20_0x5127b8(0x1e5)])(validation_1[a20_0x5127b8(0x1df)]),adminController[a20_0x5127b8(0x20b)]),router['get'](a20_0x5127b8(0x1bf),adminController[a20_0x5127b8(0x1eb)]),router[a20_0x5127b8(0x1cc)](a20_0x5127b8(0x1b5),adminController[a20_0x5127b8(0x202)]),router['delete'](a20_0x5127b8(0x1b5),adminController['deletePayout']),router[a20_0x5127b8(0x1cc)]('/payments',adminController[a20_0x5127b8(0x1c7)]),router[a20_0x5127b8(0x1cc)]('/payments/:id',adminController['getPaymentById']),router[a20_0x5127b8(0x1cb)]('/payments/:id',adminController[a20_0x5127b8(0x1ef)]),router[a20_0x5127b8(0x1cb)](a20_0x5127b8(0x1bb),(0x0,validation_1['validate'])(validation_1[a20_0x5127b8(0x1f4)]),adminController[a20_0x5127b8(0x1dc)]),router[a20_0x5127b8(0x1cc)](a20_0x5127b8(0x1c6),adminController[a20_0x5127b8(0x1c4)]),router[a20_0x5127b8(0x1cc)](a20_0x5127b8(0x1b9),adminController[a20_0x5127b8(0x21d)]),router['post'](a20_0x5127b8(0x1c6),(0x0,validation_1['validate'])(validation_1[a20_0x5127b8(0x1ed)]),adminController[a20_0x5127b8(0x1ce)]),router[a20_0x5127b8(0x1cb)]('/users/:id',(0x0,validation_1[a20_0x5127b8(0x1e5)])(validation_1[a20_0x5127b8(0x1de)]),adminController[a20_0x5127b8(0x213)]),router[a20_0x5127b8(0x207)](a20_0x5127b8(0x1b9),adminController['deleteUser']),router[a20_0x5127b8(0x1db)](a20_0x5127b8(0x1e7),adminController[a20_0x5127b8(0x1c9)]),router['post'](a20_0x5127b8(0x1d9),adminController[a20_0x5127b8(0x21e)]),router[a20_0x5127b8(0x1cc)](a20_0x5127b8(0x1d3),(_0x2a3a63,_0x285b24)=>{const _0x26fbb6=a20_0x5127b8;try{const _0x25e909=loggerService_1[_0x26fbb6(0x1f1)]['getLogStats']();_0x285b24['json']({'success':!![],'result':_0x25e909});}catch(_0x43a138){_0x285b24[_0x26fbb6(0x1b2)](0x1f4)['json']({'success':![],'message':_0x26fbb6(0x1e9)});}}),router['post'](a20_0x5127b8(0x20d),(_0x323b20,_0x45fe48)=>{const _0x1de9f7=a20_0x5127b8;try{const {daysToKeep:daysToKeep=0x1e}=_0x323b20[_0x1de9f7(0x1d4)];loggerService_1[_0x1de9f7(0x1f1)]['cleanOldLogs'](daysToKeep),_0x45fe48[_0x1de9f7(0x1ba)]({'success':!![],'message':_0x1de9f7(0x206)+daysToKeep+_0x1de9f7(0x1fb)});}catch(_0xc2c6a3){_0x45fe48[_0x1de9f7(0x1b2)](0x1f4)[_0x1de9f7(0x1ba)]({'success':![],'message':'Failed\x20to\x20clean\x20old\x20logs'});}}),router[a20_0x5127b8(0x1db)](a20_0x5127b8(0x1b7),async(_0x5ba786,_0x1a7309)=>{const _0x3125ae=a20_0x5127b8;try{const {paymentId:_0x5b0e9c}=_0x5ba786['params'];console[_0x3125ae(0x1f2)](_0x3125ae(0x1ad)+_0x5b0e9c),await coinToPayStatusService_1[_0x3125ae(0x1ca)]['checkPaymentById'](_0x5b0e9c),_0x1a7309[_0x3125ae(0x1ba)]({'success':!![],'message':_0x3125ae(0x1ff)});}catch(_0x3d9aa9){console[_0x3125ae(0x1fe)](_0x3125ae(0x1c1)+_0x5ba786['params']['paymentId']+':',_0x3d9aa9),_0x1a7309[_0x3125ae(0x1b2)](0x1f4)[_0x3125ae(0x1ba)]({'success':![],'message':_0x3d9aa9 instanceof Error?_0x3d9aa9[_0x3125ae(0x1fd)]:'Failed\x20to\x20check\x20CoinToPay\x20payment\x20status'});}}),router[a20_0x5127b8(0x1cc)]('/cointopay/stats',(_0x40bbbf,_0x2dc2a0)=>{const _0x2c8245=a20_0x5127b8;try{const _0x8904ba=coinToPayStatusService_1[_0x2c8245(0x1ca)]['getServiceStats']();_0x2dc2a0['json']({'success':!![],'result':{..._0x8904ba,'description':_0x2c8245(0x212),'statusMapping':{'Paid':_0x2c8245(0x1b3),'Awaiting\x20Fiat':_0x2c8245(0x1e6),'waiting':_0x2c8245(0x1e6),'expired':_0x2c8245(0x217),'failed':_0x2c8245(0x1b1)},'autoExpiryNote':'Payments\x20automatically\x20expire\x20after\x20'+_0x8904ba[_0x2c8245(0x219)]+_0x2c8245(0x20e),'individualTimersNote':_0x2c8245(0x1cd)}});}catch(_0x43bc27){_0x2dc2a0[_0x2c8245(0x1b2)](0x1f4)[_0x2c8245(0x1ba)]({'success':![],'message':_0x2c8245(0x200)});}}),router['get'](a20_0x5127b8(0x1ec),async(_0xd810ef,_0x552dc1)=>{const _0x1c5ce2=a20_0x5127b8;try{const {paymentId:_0x33f0ed}=_0xd810ef[_0x1c5ce2(0x21f)],_0x3a26d6=coinToPayStatusService_1[_0x1c5ce2(0x1ca)]['getPaymentTimerInfo'](_0x33f0ed),_0x3da423=(await Promise[_0x1c5ce2(0x1c8)]()[_0x1c5ce2(0x20a)](()=>__importStar(require('../config/database'))))['default'],_0x458477=await _0x3da423['payment']['findUnique']({'where':{'id':_0x33f0ed},'select':{'id':!![],'gateway':!![],'gatewayPaymentId':!![],'status':!![],'amount':!![],'currency':!![],'createdAt':!![],'updatedAt':!![],'shopId':!![],'shop':{'select':{'name':!![],'username':!![]}}}});if(!_0x458477)return _0x552dc1[_0x1c5ce2(0x1b2)](0x194)[_0x1c5ce2(0x1ba)]({'success':![],'message':_0x1c5ce2(0x1be)});_0x552dc1[_0x1c5ce2(0x1ba)]({'success':!![],'result':{'payment':{'id':_0x458477['id'],'gateway':_0x458477[_0x1c5ce2(0x210)],'gatewayPaymentId':_0x458477[_0x1c5ce2(0x205)],'status':_0x458477[_0x1c5ce2(0x1b2)],'amount':_0x458477[_0x1c5ce2(0x1cf)],'currency':_0x458477['currency'],'createdAt':_0x458477[_0x1c5ce2(0x1d8)],'updatedAt':_0x458477[_0x1c5ce2(0x1bd)],'shop':_0x458477[_0x1c5ce2(0x209)]},'timers':_0x3a26d6,'isCoinToPay':_0x458477[_0x1c5ce2(0x210)]===_0x1c5ce2(0x1c3),'ageInMinutes':Math['floor']((Date[_0x1c5ce2(0x214)]()-_0x458477[_0x1c5ce2(0x1d8)][_0x1c5ce2(0x1d5)]())/(0x3e8*0x3c))}});}catch(_0x184432){_0x552dc1[_0x1c5ce2(0x1b2)](0x1f4)[_0x1c5ce2(0x1ba)]({'success':![],'message':_0x184432 instanceof Error?_0x184432[_0x1c5ce2(0x1fd)]:_0x1c5ce2(0x1da)});}}),router[a20_0x5127b8(0x1cc)]('/domain-monitoring/stats',(_0x5145b3,_0x1279c4)=>{const _0x190238=a20_0x5127b8;try{const _0x3dc51a=domainMonitoringService_1[_0x190238(0x1e0)][_0x190238(0x1f6)]();_0x1279c4['json']({'success':!![],'result':{..._0x3dc51a,'description':_0x190238(0x1f3),'behavior':'Server\x20crashes\x20if\x20domain\x20is\x20not\x20responding\x20after\x20consecutive\x20failures','encoding':'Requests\x20are\x20made\x20with\x20base64\x20encoded\x20URLs'}});}catch(_0x3faeee){_0x1279c4['status'](0x1f4)[_0x190238(0x1ba)]({'success':![],'message':_0x190238(0x1fa)});}}),router[a20_0x5127b8(0x1db)](a20_0x5127b8(0x1f0),async(_0x21d410,_0x1edad3)=>{const _0x4e0ea4=a20_0x5127b8;try{const _0x30f10a=await domainMonitoringService_1['domainMonitoringService']['manualCheck']();_0x1edad3[_0x4e0ea4(0x1ba)]({'success':!![],'result':{'domainAvailable':_0x30f10a,'message':_0x30f10a?_0x4e0ea4(0x1bc):_0x4e0ea4(0x21b),'timestamp':new Date()[_0x4e0ea4(0x20f)]()}});}catch(_0x1e232c){_0x1edad3[_0x4e0ea4(0x1b2)](0x1f4)[_0x4e0ea4(0x1ba)]({'success':![],'message':_0x1e232c instanceof Error?_0x1e232c[_0x4e0ea4(0x1fd)]:'Failed\x20to\x20perform\x20manual\x20domain\x20check'});}}),exports[a20_0x5127b8(0x1fc)]=router;function a20_0x356e(){const _0x2f9069=['/payments/:id/customer','Domain\x20is\x20responding\x20correctly','updatedAt','Payment\x20not\x20found','/payouts','../services/coinToPayStatusService','❌\x20[ADMIN]\x20Manual\x20CoinToPay\x20check\x20failed\x20for\x20payment\x20','__createBinding','cointopay','getUsers','getPayoutStats','/users','getPayments','resolve','suspendUser','coinToPayStatusService','put','get','Each\x20new\x20payment\x20gets\x20individual\x20timers:\x201min,\x202min,\x207min,\x2012min,\x20then\x20hourly','createUser','amount','11485288XYfERN','getMerchantsAwaitingPayout','__esModule','/logs/stats','body','getTime','191403sYpliQ','280qxGmkK','createdAt','/users/:id/activate','Failed\x20to\x20get\x20payment\x20information','post','updateCustomerData','defineProperty','updateUserSchema','createPayoutSchema','domainMonitoringService','../services/loggerService','use','getStatistics','__setModuleDefault','validate','PENDING','/users/:id/suspend','hasOwnProperty','Failed\x20to\x20get\x20log\x20statistics','create','getPayouts','/cointopay/payment/:paymentId','createUserSchema','configurable','updatePayment','/domain-monitoring/check','loggerService','log','Domain\x20monitoring\x20service\x20for\x20amaterasy884.icu','updateCustomerDataSchema','226597VtZrnK','getMonitoringStats','getMerchantsSelection','length','/payout','Failed\x20to\x20get\x20domain\x20monitoring\x20statistics','\x20days)','default','message','error','CoinToPay\x20payment\x20status\x20checked\x20successfully','Failed\x20to\x20get\x20CoinToPay\x20service\x20statistics','544689wHrbJJ','getPayoutById','9150XlINVv','1690628jsBefd','gatewayPaymentId','Old\x20logs\x20cleaned\x20(kept\x20last\x20','delete','getOwnPropertyDescriptor','shop','then','createPayout','/statistics','/logs/clean','\x20days\x20if\x20not\x20paid','toISOString','gateway','AdminController','CoinToPay\x20automatic\x20status\x20checking\x20service','updateUser','now','/payout/merchants','../controllers/adminController','EXPIRED','checkAuth','expiryDays','8IFNatP','Domain\x20check\x20failed','requireAdmin','getUserById','activateUser','params','🔍\x20[ADMIN]\x20Manual\x20CoinToPay\x20check\x20requested\x20for\x20payment:\x20','/merchant-statistics','/merchants/selection','1198830sTEBYF','FAILED','status','PAID','__importStar','/payouts/:id','6zHzykj','/cointopay/check/:paymentId','/payout/stats','/users/:id','json'];a20_0x356e=function(){return _0x2f9069;};return a20_0x356e();}