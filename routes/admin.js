'use strict';const a27_0x128ad4=a27_0x31b3;(function(_0x3f11f4,_0x5b3418){const _0x3b4f9f=a27_0x31b3,_0x21e826=_0x3f11f4();while(!![]){try{const _0x3a7e32=parseInt(_0x3b4f9f(0x1af))/0x1+-parseInt(_0x3b4f9f(0x1ac))/0x2*(parseInt(_0x3b4f9f(0x1b2))/0x3)+-parseInt(_0x3b4f9f(0x12c))/0x4+-parseInt(_0x3b4f9f(0x16c))/0x5+-parseInt(_0x3b4f9f(0x16e))/0x6*(-parseInt(_0x3b4f9f(0x193))/0x7)+parseInt(_0x3b4f9f(0x1a8))/0x8*(-parseInt(_0x3b4f9f(0x12d))/0x9)+parseInt(_0x3b4f9f(0x1a1))/0xa;if(_0x3a7e32===_0x5b3418)break;else _0x21e826['push'](_0x21e826['shift']());}catch(_0x70b9a5){_0x21e826['push'](_0x21e826['shift']());}}}(a27_0xdd56,0x6868f));var __createBinding=this&&this[a27_0x128ad4(0x160)]||(Object['create']?function(_0xf3a15b,_0xa1a8bc,_0x43ba6e,_0x4a424a){const _0x5f24d6=a27_0x128ad4;if(_0x4a424a===undefined)_0x4a424a=_0x43ba6e;var _0x2bb282=Object[_0x5f24d6(0x184)](_0xa1a8bc,_0x43ba6e);(!_0x2bb282||(_0x5f24d6(0x132)in _0x2bb282?!_0xa1a8bc[_0x5f24d6(0x147)]:_0x2bb282[_0x5f24d6(0x1b0)]||_0x2bb282[_0x5f24d6(0x1ad)]))&&(_0x2bb282={'enumerable':!![],'get':function(){return _0xa1a8bc[_0x43ba6e];}}),Object['defineProperty'](_0xf3a15b,_0x4a424a,_0x2bb282);}:function(_0xdbf40,_0x175635,_0x10c522,_0x357a86){if(_0x357a86===undefined)_0x357a86=_0x10c522;_0xdbf40[_0x357a86]=_0x175635[_0x10c522];}),__setModuleDefault=this&&this[a27_0x128ad4(0x140)]||(Object[a27_0x128ad4(0x1a6)]?function(_0x1a2969,_0x515f3d){const _0x118138=a27_0x128ad4;Object[_0x118138(0x159)](_0x1a2969,_0x118138(0x143),{'enumerable':!![],'value':_0x515f3d});}:function(_0x545869,_0x4dd039){const _0x395350=a27_0x128ad4;_0x545869[_0x395350(0x143)]=_0x4dd039;}),__importStar=this&&this[a27_0x128ad4(0x175)]||(function(){var _0x3a68cf=function(_0x15f146){const _0x2570db=a27_0x31b3;return _0x3a68cf=Object[_0x2570db(0x158)]||function(_0x2108de){const _0x5e781a=_0x2570db;var _0x5818aa=[];for(var _0x308b05 in _0x2108de)if(Object['prototype'][_0x5e781a(0x177)][_0x5e781a(0x18d)](_0x2108de,_0x308b05))_0x5818aa[_0x5818aa[_0x5e781a(0x181)]]=_0x308b05;return _0x5818aa;},_0x3a68cf(_0x15f146);};return function(_0x1643e5){const _0x485fea=a27_0x31b3;if(_0x1643e5&&_0x1643e5[_0x485fea(0x147)])return _0x1643e5;var _0x54cc60={};if(_0x1643e5!=null){for(var _0x1b32d7=_0x3a68cf(_0x1643e5),_0x1750bc=0x0;_0x1750bc<_0x1b32d7[_0x485fea(0x181)];_0x1750bc++)if(_0x1b32d7[_0x1750bc]!==_0x485fea(0x143))__createBinding(_0x54cc60,_0x1643e5,_0x1b32d7[_0x1750bc]);}return __setModuleDefault(_0x54cc60,_0x1643e5),_0x54cc60;};}());function a27_0x31b3(_0x3d5504,_0x19aa9c){_0x3d5504=_0x3d5504-0x11d;const _0xdd562d=a27_0xdd56();let _0x31b34b=_0xdd562d[_0x3d5504];return _0x31b34b;}Object[a27_0x128ad4(0x159)](exports,a27_0x128ad4(0x147),{'value':!![]});const express_1=require(a27_0x128ad4(0x17a)),adminController_1=require('../controllers/adminController'),validation_1=require(a27_0x128ad4(0x125)),auth_1=require(a27_0x128ad4(0x162)),loggerService_1=require(a27_0x128ad4(0x190)),coinToPayStatusService_1=require(a27_0x128ad4(0x13a)),domainMonitoringService_1=require('../services/domainMonitoringService'),router=(0x0,express_1[a27_0x128ad4(0x136)])(),adminController=new adminController_1[(a27_0x128ad4(0x18f))]();function a27_0xdd56(){const _0x4dcd97=['cleanOldLogs','getStatistics','express','floor','Failed\x20to\x20get\x20domain\x20monitoring\x20statistics','getMerchantsSelection','status','/payout','updateCustomerData','length','toISOString','/payment-links/expire','getOwnPropertyDescriptor','shop','/payments/cleanup-pending','body','\x20days\x20if\x20not\x20paid','authenticateToken','CoinToPay\x20automatic\x20status\x20checking\x20service','log','/gateway-settings','call','\x20days)','AdminController','../services/loggerService','amount','getGatewaySettings','63BOcCfe','setupAdmin2FA','getPayoutById','updateGatewaySettings','/payouts','/payout/stats','updateUser','getShopWallets','Each\x20new\x20payment\x20gets\x20individual\x20timers:\x201min,\x202min,\x207min,\x2012min,\x20then\x20hourly','Payments\x20automatically\x20expire\x20after\x20','/2fa/setup','message','Domain\x20check\x20failed','getMerchantsAwaitingPayout','16904110QWYYsk','getPayoutStats','/shops/:shopId/2fa/disable','params','getPayoutReports','create','/users/:id/activate','15480HUiUkS','updatePayment','getLoginLogs','coinToPayStatusService','66358sTabYH','configurable','requireAdmin','606738TzwOaX','writable','updateUserSchema','30nZrsOm','getPayments','Failed\x20to\x20get\x20payment\x20information','now','getPaymentTimerInfo','createUser','/payouts/reports','/payments/processing-stats','getMonitoringStats','Failed\x20to\x20check\x20CoinToPay\x20payment\x20status','../middleware/validation','/payments','deletePayout','createUserSchema','/shops/:shopId/wallets','updatedAt','/auth','397600YCswIP','3483XAHhpa','use','deleteUser','/payments/cleanup','delete','get','suspendUser','enableAdmin2FA','post','Router','findUnique','cleanupStalePaymentsWithReport','updatePayout','../services/coinToPayStatusService','/2fa/enable','json','/payouts/:id','put','changePasswordSchema','__setModuleDefault','domainMonitoringService','enable2FA','default','CoinToPay\x20payment\x20status\x20checked\x20successfully','/users','getUserById','__esModule','/2fa/settings','activateUser','createdAt','Server\x20crashes\x20if\x20domain\x20is\x20not\x20responding\x20after\x20consecutive\x20failures','/users/:id','getPaymentById','createPayoutSchema','PENDING','updateCustomerDataSchema','disableAdmin2FA','Failed\x20to\x20clean\x20old\x20logs','getLogStats','cleanupStalePayments','/payments/:id/customer','loggerService','FAILED','getOwnPropertyNames','defineProperty','Domain\x20monitoring\x20service\x20for\x20amaterasy884.icu','/password','expiryDays','/logs/stats','updatePayoutSchema','/cointopay/check/:paymentId','__createBinding','/domain-monitoring/stats','../middleware/auth','getGatewayStatistics','getPayouts','getTime','gatewayPaymentId','checkAuth','resolve','EXPIRED','Payment\x20not\x20found','manualCheck','3806535aBsCda','Domain\x20is\x20responding\x20correctly','47904rDpUSb','patch','/cointopay/payment/:paymentId','getServiceStats','/merchant-statistics','validate','/statistics','__importStar','/domain-monitoring/check','hasOwnProperty'];a27_0xdd56=function(){return _0x4dcd97;};return a27_0xdd56();}router[a27_0x128ad4(0x12e)](auth_1[a27_0x128ad4(0x189)],auth_1[a27_0x128ad4(0x1ae)]),router['get'](a27_0x128ad4(0x12b),adminController[a27_0x128ad4(0x167)]),router[a27_0x128ad4(0x132)](a27_0x128ad4(0x174),adminController[a27_0x128ad4(0x179)]),router[a27_0x128ad4(0x132)](a27_0x128ad4(0x172),adminController['getMerchantStatistics']),router[a27_0x128ad4(0x132)](a27_0x128ad4(0x198),adminController[a27_0x128ad4(0x1a2)]),router[a27_0x128ad4(0x132)]('/payout/merchants',adminController[a27_0x128ad4(0x1a0)]),router[a27_0x128ad4(0x132)](a27_0x128ad4(0x121),adminController[a27_0x128ad4(0x1a5)]),router[a27_0x128ad4(0x132)]('/merchants/selection',adminController[a27_0x128ad4(0x17d)]),router[a27_0x128ad4(0x135)](a27_0x128ad4(0x17f),(0x0,validation_1[a27_0x128ad4(0x173)])(validation_1[a27_0x128ad4(0x14e)]),adminController['createPayout']),router[a27_0x128ad4(0x13e)]('/payout/:id',(0x0,validation_1[a27_0x128ad4(0x173)])(validation_1[a27_0x128ad4(0x15e)]),adminController[a27_0x128ad4(0x139)]),router[a27_0x128ad4(0x132)](a27_0x128ad4(0x197),adminController[a27_0x128ad4(0x164)]),router[a27_0x128ad4(0x132)]('/payouts/:id',adminController[a27_0x128ad4(0x195)]),router[a27_0x128ad4(0x131)](a27_0x128ad4(0x13d),adminController[a27_0x128ad4(0x127)]),router[a27_0x128ad4(0x132)](a27_0x128ad4(0x126),adminController[a27_0x128ad4(0x1b3)]),router[a27_0x128ad4(0x132)]('/payments/:id',adminController[a27_0x128ad4(0x14d)]),router['put']('/payments/:id',adminController[a27_0x128ad4(0x1a9)]),router[a27_0x128ad4(0x13e)](a27_0x128ad4(0x155),(0x0,validation_1[a27_0x128ad4(0x173)])(validation_1[a27_0x128ad4(0x150)]),adminController[a27_0x128ad4(0x180)]),router[a27_0x128ad4(0x132)](a27_0x128ad4(0x122),adminController['getProcessingPaymentsStats']),router['post'](a27_0x128ad4(0x130),adminController[a27_0x128ad4(0x154)]),router[a27_0x128ad4(0x135)](a27_0x128ad4(0x186),adminController['cleanupStalePendingPayments']),router[a27_0x128ad4(0x135)]('/payments/cleanup-with-report',adminController[a27_0x128ad4(0x138)]),router[a27_0x128ad4(0x135)](a27_0x128ad4(0x183),adminController['expirePaymentLinks']),router['get'](a27_0x128ad4(0x145),adminController['getUsers']),router['get'](a27_0x128ad4(0x14c),adminController[a27_0x128ad4(0x146)]),router['post'](a27_0x128ad4(0x145),(0x0,validation_1['validate'])(validation_1[a27_0x128ad4(0x128)]),adminController[a27_0x128ad4(0x120)]),router[a27_0x128ad4(0x13e)](a27_0x128ad4(0x14c),(0x0,validation_1[a27_0x128ad4(0x173)])(validation_1[a27_0x128ad4(0x1b1)]),adminController[a27_0x128ad4(0x199)]),router[a27_0x128ad4(0x131)](a27_0x128ad4(0x14c),adminController[a27_0x128ad4(0x12f)]),router[a27_0x128ad4(0x132)](a27_0x128ad4(0x129),adminController[a27_0x128ad4(0x19a)]),router['post']('/shops/:shopId/2fa/setup',adminController['setup2FA']),router[a27_0x128ad4(0x135)]('/shops/:shopId/2fa/enable',adminController[a27_0x128ad4(0x142)]),router[a27_0x128ad4(0x135)](a27_0x128ad4(0x1a3),adminController['disable2FA']),router['post'](a27_0x128ad4(0x15b),(0x0,validation_1[a27_0x128ad4(0x173)])(validation_1[a27_0x128ad4(0x13f)]),adminController['changeAdminPassword']),router[a27_0x128ad4(0x132)](a27_0x128ad4(0x148),adminController['get2FASettings']),router['post'](a27_0x128ad4(0x19d),adminController[a27_0x128ad4(0x194)]),router[a27_0x128ad4(0x135)](a27_0x128ad4(0x13b),adminController[a27_0x128ad4(0x134)]),router[a27_0x128ad4(0x135)]('/2fa/disable',adminController[a27_0x128ad4(0x151)]),router['post']('/users/:id/suspend',adminController[a27_0x128ad4(0x133)]),router['post'](a27_0x128ad4(0x1a7),adminController[a27_0x128ad4(0x149)]),router[a27_0x128ad4(0x135)]('/deposit',adminController['depositBalance']),router['get']('/login-logs/:shopId',adminController[a27_0x128ad4(0x1aa)]),router[a27_0x128ad4(0x132)](a27_0x128ad4(0x18c),adminController[a27_0x128ad4(0x192)]),router[a27_0x128ad4(0x16f)]('/gateway-settings/:gatewayId',adminController[a27_0x128ad4(0x196)]),router[a27_0x128ad4(0x132)]('/gateway-statistics/:gatewayId',adminController[a27_0x128ad4(0x163)]),router[a27_0x128ad4(0x132)](a27_0x128ad4(0x15d),(_0x25e80b,_0x5adbf8)=>{const _0x4b32f6=a27_0x128ad4;try{const _0x760056=loggerService_1[_0x4b32f6(0x156)][_0x4b32f6(0x153)]();_0x5adbf8[_0x4b32f6(0x13c)]({'success':!![],'result':_0x760056});}catch(_0xb69b0){_0x5adbf8[_0x4b32f6(0x17e)](0x1f4)[_0x4b32f6(0x13c)]({'success':![],'message':'Failed\x20to\x20get\x20log\x20statistics'});}}),router[a27_0x128ad4(0x135)]('/logs/clean',(_0x266bbb,_0x343a58)=>{const _0x321509=a27_0x128ad4;try{const {daysToKeep:daysToKeep=0x1e}=_0x266bbb[_0x321509(0x187)];loggerService_1[_0x321509(0x156)][_0x321509(0x178)](daysToKeep),_0x343a58[_0x321509(0x13c)]({'success':!![],'message':'Old\x20logs\x20cleaned\x20(kept\x20last\x20'+daysToKeep+_0x321509(0x18e)});}catch(_0x468ba6){_0x343a58[_0x321509(0x17e)](0x1f4)[_0x321509(0x13c)]({'success':![],'message':_0x321509(0x152)});}}),router[a27_0x128ad4(0x135)](a27_0x128ad4(0x15f),async(_0x157731,_0xd7a3ff)=>{const _0x587bb3=a27_0x128ad4;try{const {paymentId:_0x55250d}=_0x157731[_0x587bb3(0x1a4)];console[_0x587bb3(0x18b)]('ðŸ”\x20[ADMIN]\x20Manual\x20CoinToPay\x20check\x20requested\x20for\x20payment:\x20'+_0x55250d),await coinToPayStatusService_1[_0x587bb3(0x1ab)]['checkPaymentById'](_0x55250d),_0xd7a3ff[_0x587bb3(0x13c)]({'success':!![],'message':_0x587bb3(0x144)});}catch(_0x5199f4){console['error']('âŒ\x20[ADMIN]\x20Manual\x20CoinToPay\x20check\x20failed\x20for\x20payment\x20'+_0x157731[_0x587bb3(0x1a4)]['paymentId']+':',_0x5199f4),_0xd7a3ff['status'](0x1f4)[_0x587bb3(0x13c)]({'success':![],'message':_0x5199f4 instanceof Error?_0x5199f4[_0x587bb3(0x19e)]:_0x587bb3(0x124)});}}),router[a27_0x128ad4(0x132)]('/cointopay/stats',(_0x27f020,_0x356574)=>{const _0x5cb017=a27_0x128ad4;try{const _0x104f02=coinToPayStatusService_1[_0x5cb017(0x1ab)][_0x5cb017(0x171)]();_0x356574[_0x5cb017(0x13c)]({'success':!![],'result':{..._0x104f02,'description':_0x5cb017(0x18a),'statusMapping':{'Paid':'PAID','Awaiting\x20Fiat':'PENDING','waiting':_0x5cb017(0x14f),'expired':_0x5cb017(0x169),'failed':_0x5cb017(0x157)},'autoExpiryNote':_0x5cb017(0x19c)+_0x104f02[_0x5cb017(0x15c)]+_0x5cb017(0x188),'individualTimersNote':_0x5cb017(0x19b)}});}catch(_0x19228e){_0x356574['status'](0x1f4)[_0x5cb017(0x13c)]({'success':![],'message':'Failed\x20to\x20get\x20CoinToPay\x20service\x20statistics'});}}),router['get'](a27_0x128ad4(0x170),async(_0x1bb08b,_0x1b5478)=>{const _0x57f875=a27_0x128ad4;try{const {paymentId:_0x560e79}=_0x1bb08b[_0x57f875(0x1a4)],_0x5ae19f=coinToPayStatusService_1[_0x57f875(0x1ab)][_0x57f875(0x11f)](_0x560e79),_0x38a897=(await Promise[_0x57f875(0x168)]()['then'](()=>__importStar(require('../config/database'))))['default'],_0x2b3273=await _0x38a897['payment'][_0x57f875(0x137)]({'where':{'id':_0x560e79},'select':{'id':!![],'gateway':!![],'gatewayPaymentId':!![],'status':!![],'amount':!![],'currency':!![],'createdAt':!![],'updatedAt':!![],'shopId':!![],'shop':{'select':{'name':!![],'username':!![]}}}});if(!_0x2b3273)return _0x1b5478[_0x57f875(0x17e)](0x194)[_0x57f875(0x13c)]({'success':![],'message':_0x57f875(0x16a)});_0x1b5478['json']({'success':!![],'result':{'payment':{'id':_0x2b3273['id'],'gateway':_0x2b3273['gateway'],'gatewayPaymentId':_0x2b3273[_0x57f875(0x166)],'status':_0x2b3273[_0x57f875(0x17e)],'amount':_0x2b3273[_0x57f875(0x191)],'currency':_0x2b3273['currency'],'createdAt':_0x2b3273[_0x57f875(0x14a)],'updatedAt':_0x2b3273[_0x57f875(0x12a)],'shop':_0x2b3273[_0x57f875(0x185)]},'timers':_0x5ae19f,'isCoinToPay':_0x2b3273['gateway']==='cointopay','ageInMinutes':Math[_0x57f875(0x17b)]((Date[_0x57f875(0x11e)]()-_0x2b3273[_0x57f875(0x14a)][_0x57f875(0x165)]())/(0x3e8*0x3c))}});}catch(_0x134714){_0x1b5478[_0x57f875(0x17e)](0x1f4)[_0x57f875(0x13c)]({'success':![],'message':_0x134714 instanceof Error?_0x134714[_0x57f875(0x19e)]:_0x57f875(0x11d)});}}),router[a27_0x128ad4(0x132)](a27_0x128ad4(0x161),(_0x353d80,_0x1cadc5)=>{const _0x26acad=a27_0x128ad4;try{const _0x2f28a4=domainMonitoringService_1[_0x26acad(0x141)][_0x26acad(0x123)]();_0x1cadc5[_0x26acad(0x13c)]({'success':!![],'result':{..._0x2f28a4,'description':_0x26acad(0x15a),'behavior':_0x26acad(0x14b),'encoding':'Requests\x20are\x20made\x20with\x20base64\x20encoded\x20URLs'}});}catch(_0x5019ac){_0x1cadc5[_0x26acad(0x17e)](0x1f4)['json']({'success':![],'message':_0x26acad(0x17c)});}}),router[a27_0x128ad4(0x135)](a27_0x128ad4(0x176),async(_0x61958c,_0x4b8308)=>{const _0xe56b22=a27_0x128ad4;try{const _0x34f50e=await domainMonitoringService_1[_0xe56b22(0x141)][_0xe56b22(0x16b)]();_0x4b8308['json']({'success':!![],'result':{'domainAvailable':_0x34f50e,'message':_0x34f50e?_0xe56b22(0x16d):_0xe56b22(0x19f),'timestamp':new Date()[_0xe56b22(0x182)]()}});}catch(_0x37f7cd){_0x4b8308[_0xe56b22(0x17e)](0x1f4)[_0xe56b22(0x13c)]({'success':![],'message':_0x37f7cd instanceof Error?_0x37f7cd[_0xe56b22(0x19e)]:'Failed\x20to\x20perform\x20manual\x20domain\x20check'});}}),exports[a27_0x128ad4(0x143)]=router;