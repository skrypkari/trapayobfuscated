'use strict';const a19_0x826b8a=a19_0x18c7;function a19_0x18c7(_0x268f21,_0x173910){const _0x306e35=a19_0x306e();return a19_0x18c7=function(_0x18c766,_0x3e588c){_0x18c766=_0x18c766-0xea;let _0x43a64d=_0x306e35[_0x18c766];return _0x43a64d;},a19_0x18c7(_0x268f21,_0x173910);}(function(_0x2a70d9,_0x289315){const _0x3a8238=a19_0x18c7,_0x3e8353=_0x2a70d9();while(!![]){try{const _0x464a9f=-parseInt(_0x3a8238(0x13a))/0x1+-parseInt(_0x3a8238(0x141))/0x2+-parseInt(_0x3a8238(0x103))/0x3*(parseInt(_0x3a8238(0xfc))/0x4)+-parseInt(_0x3a8238(0x108))/0x5+parseInt(_0x3a8238(0x15e))/0x6+parseInt(_0x3a8238(0x140))/0x7+parseInt(_0x3a8238(0x123))/0x8;if(_0x464a9f===_0x289315)break;else _0x3e8353['push'](_0x3e8353['shift']());}catch(_0x32837b){_0x3e8353['push'](_0x3e8353['shift']());}}}(a19_0x306e,0xa0530));var __createBinding=this&&this['__createBinding']||(Object['create']?function(_0x3ad052,_0x18a7ce,_0x3347cc,_0x2c4373){const _0x54d446=a19_0x18c7;if(_0x2c4373===undefined)_0x2c4373=_0x3347cc;var _0x1f34a3=Object[_0x54d446(0x126)](_0x18a7ce,_0x3347cc);(!_0x1f34a3||('get'in _0x1f34a3?!_0x18a7ce[_0x54d446(0x11e)]:_0x1f34a3[_0x54d446(0x158)]||_0x1f34a3['configurable']))&&(_0x1f34a3={'enumerable':!![],'get':function(){return _0x18a7ce[_0x3347cc];}}),Object[_0x54d446(0x12a)](_0x3ad052,_0x2c4373,_0x1f34a3);}:function(_0xf20aa4,_0x3365a8,_0x2f2994,_0x50dfef){if(_0x50dfef===undefined)_0x50dfef=_0x2f2994;_0xf20aa4[_0x50dfef]=_0x3365a8[_0x2f2994];}),__setModuleDefault=this&&this[a19_0x826b8a(0x156)]||(Object['create']?function(_0x30cf50,_0x4bca0c){const _0x4821a6=a19_0x826b8a;Object[_0x4821a6(0x12a)](_0x30cf50,_0x4821a6(0xf7),{'enumerable':!![],'value':_0x4bca0c});}:function(_0x45a85a,_0xeb81a7){_0x45a85a['default']=_0xeb81a7;}),__importStar=this&&this[a19_0x826b8a(0x14d)]||(function(){var _0xe5096=function(_0x2ea888){const _0x20c7a5=a19_0x18c7;return _0xe5096=Object[_0x20c7a5(0x11d)]||function(_0x4d2724){const _0x32f40a=_0x20c7a5;var _0x373bd9=[];for(var _0x33c765 in _0x4d2724)if(Object['prototype'][_0x32f40a(0xfa)]['call'](_0x4d2724,_0x33c765))_0x373bd9[_0x373bd9[_0x32f40a(0x144)]]=_0x33c765;return _0x373bd9;},_0xe5096(_0x2ea888);};return function(_0x60a91){const _0x5507f3=a19_0x18c7;if(_0x60a91&&_0x60a91[_0x5507f3(0x11e)])return _0x60a91;var _0x2cdda2={};if(_0x60a91!=null){for(var _0x5a1b6d=_0xe5096(_0x60a91),_0x46581c=0x0;_0x46581c<_0x5a1b6d['length'];_0x46581c++)if(_0x5a1b6d[_0x46581c]!=='default')__createBinding(_0x2cdda2,_0x60a91,_0x5a1b6d[_0x46581c]);}return __setModuleDefault(_0x2cdda2,_0x60a91),_0x2cdda2;};}());Object[a19_0x826b8a(0x12a)](exports,a19_0x826b8a(0x11e),{'value':!![]});const express_1=require('express'),adminController_1=require(a19_0x826b8a(0xf0)),validation_1=require(a19_0x826b8a(0x161)),auth_1=require(a19_0x826b8a(0x12b)),loggerService_1=require(a19_0x826b8a(0x13b)),coinToPayStatusService_1=require(a19_0x826b8a(0x125)),domainMonitoringService_1=require(a19_0x826b8a(0x12d)),router=(0x0,express_1['Router'])(),adminController=new adminController_1[(a19_0x826b8a(0x12f))]();function a19_0x306e(){const _0x2bad4f=['shop','getPayoutById','/domain-monitoring/stats','Each\x20new\x20payment\x20gets\x20individual\x20timers:\x201min,\x202min,\x207min,\x2012min,\x20then\x20hourly','createUserSchema','Domain\x20check\x20failed','post','__importStar','updateCustomerData','Domain\x20monitoring\x20service\x20for\x20amaterasy884.icu','body','activateUser','/statistics','log','/payout','/users/:id','__setModuleDefault','Failed\x20to\x20perform\x20manual\x20domain\x20check','writable','coinToPayStatusService','currency','domainMonitoringService','updateCustomerDataSchema','suspendUser','7869864zHIQSk','payment','updateUserSchema','../middleware/validation','gatewayPaymentId','PENDING','requireAdmin','updateUser','put','Old\x20logs\x20cleaned\x20(kept\x20last\x20','../controllers/adminController','getMonitoringStats','validate','checkPaymentById','/payouts','get','getPayoutStats','default','createdAt','CoinToPay\x20automatic\x20status\x20checking\x20service','hasOwnProperty','authenticateToken','1079916mrHpfd','manualCheck','updatePayment','Failed\x20to\x20clean\x20old\x20logs','Failed\x20to\x20get\x20domain\x20monitoring\x20statistics','PAID','getTime','12sVKovp','findUnique','getMerchantsAwaitingPayout','../config/database','gateway','4803295nYkGAM','EXPIRED','expiryDays','getLogStats','status','getPayments','getMerchantStatistics','/users','❌\x20[ADMIN]\x20Manual\x20CoinToPay\x20check\x20failed\x20for\x20payment\x20','params','/payouts/:id','/logs/stats','floor','/cointopay/payment/:paymentId','Server\x20crashes\x20if\x20domain\x20is\x20not\x20responding\x20after\x20consecutive\x20failures','CoinToPay\x20payment\x20status\x20checked\x20successfully','createPayoutSchema','loggerService','amount','deletePayout','getPaymentById','getOwnPropertyNames','__esModule','then','Domain\x20is\x20responding\x20correctly','Failed\x20to\x20get\x20CoinToPay\x20service\x20statistics','delete','19434648kaZMJP','🔍\x20[ADMIN]\x20Manual\x20CoinToPay\x20check\x20requested\x20for\x20payment:\x20','../services/coinToPayStatusService','getOwnPropertyDescriptor','use','/cointopay/check/:paymentId','Payments\x20automatically\x20expire\x20after\x20','defineProperty','../middleware/auth','\x20days\x20if\x20not\x20paid','../services/domainMonitoringService','/logs/clean','AdminController','toISOString','/merchant-statistics','json','/payout/merchants','getStatistics','error','cointopay','/payments/:id','getPaymentTimerInfo','cleanOldLogs','214603wVqRKg','../services/loggerService','/users/:id/activate','/auth','message','FAILED','2638783EfGbOz','2412156oIZhDt','checkAuth','/cointopay/stats','length','createUser'];a19_0x306e=function(){return _0x2bad4f;};return a19_0x306e();}router[a19_0x826b8a(0x127)](auth_1[a19_0x826b8a(0xfb)],auth_1[a19_0x826b8a(0xec)]),router[a19_0x826b8a(0xf5)](a19_0x826b8a(0x13d),adminController[a19_0x826b8a(0x142)]),router[a19_0x826b8a(0xf5)](a19_0x826b8a(0x152),adminController[a19_0x826b8a(0x134)]),router[a19_0x826b8a(0xf5)](a19_0x826b8a(0x131),adminController[a19_0x826b8a(0x10e)]),router[a19_0x826b8a(0xf5)]('/payout/stats',adminController[a19_0x826b8a(0xf6)]),router[a19_0x826b8a(0xf5)](a19_0x826b8a(0x133),adminController[a19_0x826b8a(0x105)]),router[a19_0x826b8a(0x14c)](a19_0x826b8a(0x154),(0x0,validation_1['validate'])(validation_1[a19_0x826b8a(0x118)]),adminController['createPayout']),router['get'](a19_0x826b8a(0xf4),adminController['getPayouts']),router[a19_0x826b8a(0xf5)](a19_0x826b8a(0x112),adminController[a19_0x826b8a(0x147)]),router[a19_0x826b8a(0x122)]('/payouts/:id',adminController[a19_0x826b8a(0x11b)]),router['get']('/payments',adminController[a19_0x826b8a(0x10d)]),router[a19_0x826b8a(0xf5)]('/payments/:id',adminController[a19_0x826b8a(0x11c)]),router[a19_0x826b8a(0xee)](a19_0x826b8a(0x137),adminController[a19_0x826b8a(0xfe)]),router[a19_0x826b8a(0xee)]('/payments/:id/customer',(0x0,validation_1[a19_0x826b8a(0xf2)])(validation_1[a19_0x826b8a(0x15c)]),adminController[a19_0x826b8a(0x14e)]),router[a19_0x826b8a(0xf5)](a19_0x826b8a(0x10f),adminController['getUsers']),router[a19_0x826b8a(0xf5)](a19_0x826b8a(0x155),adminController['getUserById']),router['post'](a19_0x826b8a(0x10f),(0x0,validation_1['validate'])(validation_1[a19_0x826b8a(0x14a)]),adminController[a19_0x826b8a(0x145)]),router[a19_0x826b8a(0xee)](a19_0x826b8a(0x155),(0x0,validation_1['validate'])(validation_1[a19_0x826b8a(0x160)]),adminController[a19_0x826b8a(0xed)]),router['delete']('/users/:id',adminController['deleteUser']),router['post']('/users/:id/suspend',adminController[a19_0x826b8a(0x15d)]),router['post'](a19_0x826b8a(0x13c),adminController[a19_0x826b8a(0x151)]),router[a19_0x826b8a(0xf5)](a19_0x826b8a(0x113),(_0x409860,_0x4fffa3)=>{const _0x30fce4=a19_0x826b8a;try{const _0x55f5eb=loggerService_1[_0x30fce4(0x119)][_0x30fce4(0x10b)]();_0x4fffa3[_0x30fce4(0x132)]({'success':!![],'result':_0x55f5eb});}catch(_0x2458b3){_0x4fffa3[_0x30fce4(0x10c)](0x1f4)['json']({'success':![],'message':'Failed\x20to\x20get\x20log\x20statistics'});}}),router[a19_0x826b8a(0x14c)](a19_0x826b8a(0x12e),(_0x570145,_0x3109e6)=>{const _0x3c8cc5=a19_0x826b8a;try{const {daysToKeep:daysToKeep=0x1e}=_0x570145[_0x3c8cc5(0x150)];loggerService_1[_0x3c8cc5(0x119)][_0x3c8cc5(0x139)](daysToKeep),_0x3109e6['json']({'success':!![],'message':_0x3c8cc5(0xef)+daysToKeep+'\x20days)'});}catch(_0x41a62a){_0x3109e6[_0x3c8cc5(0x10c)](0x1f4)[_0x3c8cc5(0x132)]({'success':![],'message':_0x3c8cc5(0xff)});}}),router[a19_0x826b8a(0x14c)](a19_0x826b8a(0x128),async(_0x54b36f,_0x53d71b)=>{const _0x97689c=a19_0x826b8a;try{const {paymentId:_0x181aab}=_0x54b36f[_0x97689c(0x111)];console[_0x97689c(0x153)](_0x97689c(0x124)+_0x181aab),await coinToPayStatusService_1[_0x97689c(0x159)][_0x97689c(0xf3)](_0x181aab),_0x53d71b['json']({'success':!![],'message':_0x97689c(0x117)});}catch(_0x3eacca){console[_0x97689c(0x135)](_0x97689c(0x110)+_0x54b36f['params']['paymentId']+':',_0x3eacca),_0x53d71b[_0x97689c(0x10c)](0x1f4)[_0x97689c(0x132)]({'success':![],'message':_0x3eacca instanceof Error?_0x3eacca[_0x97689c(0x13e)]:'Failed\x20to\x20check\x20CoinToPay\x20payment\x20status'});}}),router[a19_0x826b8a(0xf5)](a19_0x826b8a(0x143),(_0x255b2b,_0x5b745a)=>{const _0x1bdcd3=a19_0x826b8a;try{const _0x30998c=coinToPayStatusService_1[_0x1bdcd3(0x159)]['getServiceStats']();_0x5b745a[_0x1bdcd3(0x132)]({'success':!![],'result':{..._0x30998c,'description':_0x1bdcd3(0xf9),'statusMapping':{'Paid':_0x1bdcd3(0x101),'Awaiting\x20Fiat':_0x1bdcd3(0xeb),'waiting':'PENDING','expired':_0x1bdcd3(0x109),'failed':_0x1bdcd3(0x13f)},'autoExpiryNote':_0x1bdcd3(0x129)+_0x30998c[_0x1bdcd3(0x10a)]+_0x1bdcd3(0x12c),'individualTimersNote':_0x1bdcd3(0x149)}});}catch(_0x5f3576){_0x5b745a[_0x1bdcd3(0x10c)](0x1f4)[_0x1bdcd3(0x132)]({'success':![],'message':_0x1bdcd3(0x121)});}}),router[a19_0x826b8a(0xf5)](a19_0x826b8a(0x115),async(_0x14d509,_0x542bc4)=>{const _0x4b5239=a19_0x826b8a;try{const {paymentId:_0x4ba9fd}=_0x14d509[_0x4b5239(0x111)],_0x4e6ba8=coinToPayStatusService_1['coinToPayStatusService'][_0x4b5239(0x138)](_0x4ba9fd),_0x566476=(await Promise['resolve']()[_0x4b5239(0x11f)](()=>__importStar(require(_0x4b5239(0x106)))))[_0x4b5239(0xf7)],_0x3c8d72=await _0x566476[_0x4b5239(0x15f)][_0x4b5239(0x104)]({'where':{'id':_0x4ba9fd},'select':{'id':!![],'gateway':!![],'gatewayPaymentId':!![],'status':!![],'amount':!![],'currency':!![],'createdAt':!![],'updatedAt':!![],'shopId':!![],'shop':{'select':{'name':!![],'username':!![]}}}});if(!_0x3c8d72)return _0x542bc4['status'](0x194)[_0x4b5239(0x132)]({'success':![],'message':'Payment\x20not\x20found'});_0x542bc4[_0x4b5239(0x132)]({'success':!![],'result':{'payment':{'id':_0x3c8d72['id'],'gateway':_0x3c8d72['gateway'],'gatewayPaymentId':_0x3c8d72[_0x4b5239(0xea)],'status':_0x3c8d72[_0x4b5239(0x10c)],'amount':_0x3c8d72[_0x4b5239(0x11a)],'currency':_0x3c8d72[_0x4b5239(0x15a)],'createdAt':_0x3c8d72[_0x4b5239(0xf8)],'updatedAt':_0x3c8d72['updatedAt'],'shop':_0x3c8d72[_0x4b5239(0x146)]},'timers':_0x4e6ba8,'isCoinToPay':_0x3c8d72[_0x4b5239(0x107)]===_0x4b5239(0x136),'ageInMinutes':Math[_0x4b5239(0x114)]((Date['now']()-_0x3c8d72[_0x4b5239(0xf8)][_0x4b5239(0x102)]())/(0x3e8*0x3c))}});}catch(_0x14bf1b){_0x542bc4[_0x4b5239(0x10c)](0x1f4)[_0x4b5239(0x132)]({'success':![],'message':_0x14bf1b instanceof Error?_0x14bf1b[_0x4b5239(0x13e)]:'Failed\x20to\x20get\x20payment\x20information'});}}),router[a19_0x826b8a(0xf5)](a19_0x826b8a(0x148),(_0x4bf763,_0xf05335)=>{const _0x16eb4e=a19_0x826b8a;try{const _0xa1bda8=domainMonitoringService_1[_0x16eb4e(0x15b)][_0x16eb4e(0xf1)]();_0xf05335['json']({'success':!![],'result':{..._0xa1bda8,'description':_0x16eb4e(0x14f),'behavior':_0x16eb4e(0x116),'encoding':'Requests\x20are\x20made\x20with\x20base64\x20encoded\x20URLs'}});}catch(_0x9c4aad){_0xf05335[_0x16eb4e(0x10c)](0x1f4)[_0x16eb4e(0x132)]({'success':![],'message':_0x16eb4e(0x100)});}}),router['post']('/domain-monitoring/check',async(_0x375026,_0x363834)=>{const _0x60306f=a19_0x826b8a;try{const _0x1b0e79=await domainMonitoringService_1[_0x60306f(0x15b)][_0x60306f(0xfd)]();_0x363834[_0x60306f(0x132)]({'success':!![],'result':{'domainAvailable':_0x1b0e79,'message':_0x1b0e79?_0x60306f(0x120):_0x60306f(0x14b),'timestamp':new Date()[_0x60306f(0x130)]()}});}catch(_0x5461c3){_0x363834[_0x60306f(0x10c)](0x1f4)[_0x60306f(0x132)]({'success':![],'message':_0x5461c3 instanceof Error?_0x5461c3['message']:_0x60306f(0x157)});}}),exports['default']=router;