'use strict';function a19_0xa95d(_0x43e0eb,_0x373651){const _0x5613f0=a19_0x5613();return a19_0xa95d=function(_0xa95d67,_0x200fdc){_0xa95d67=_0xa95d67-0x16f;let _0x45c644=_0x5613f0[_0xa95d67];return _0x45c644;},a19_0xa95d(_0x43e0eb,_0x373651);}function a19_0x5613(){const _0x570d5f=['/payments/:id/customer','createdAt','\x20days\x20if\x20not\x20paid','Failed\x20to\x20get\x20domain\x20monitoring\x20statistics','findUnique','Domain\x20check\x20failed','18cOneeK','6629416zUevga','/payouts/:id','CoinToPay\x20payment\x20status\x20checked\x20successfully','/users','validate','AdminController','create','__setModuleDefault','error','getUserById','default','Domain\x20monitoring\x20service\x20for\x20amaterasy884.icu','suspendUser','/cointopay/payment/:paymentId','requireAdmin','/cointopay/stats','/payments/:id','gateway','/merchant-statistics','/cointopay/check/:paymentId','3122698onIAwG','prototype','getPaymentById','4JEnCLC','../services/loggerService','updatePayment','delete','30599590XyFdZz','getOwnPropertyDescriptor','Payments\x20automatically\x20expire\x20after\x20','/statistics','/merchants/selection','/auth','createUser','__esModule','deleteUser','expiryDays','CoinToPay\x20automatic\x20status\x20checking\x20service','PAID','getPayouts','createUserSchema','coinToPayStatusService','createPayout','updatedAt','message','getPaymentTimerInfo','Old\x20logs\x20cleaned\x20(kept\x20last\x20','Failed\x20to\x20perform\x20manual\x20domain\x20check','/users/:id/suspend','put','Domain\x20is\x20responding\x20correctly','createPayoutSchema','getOwnPropertyNames','Router','Failed\x20to\x20get\x20log\x20statistics','checkAuth','7004905QQlamJ','floor','express','gatewayPaymentId','../middleware/auth','toISOString','../services/domainMonitoringService','../controllers/adminController','loggerService','getMerchantStatistics','params','get','PENDING','__createBinding','payment','üîç\x20[ADMIN]\x20Manual\x20CoinToPay\x20check\x20requested\x20for\x20payment:\x20','../config/database','length','shop','11qafmVv','FAILED','defineProperty','updateUser','getMonitoringStats','getUsers','/logs/stats','body','writable','/domain-monitoring/stats','currency','updateCustomerDataSchema','48eqxIrR','getPayments','status','configurable','json','925526KQNpUO','Failed\x20to\x20get\x20payment\x20information','Requests\x20are\x20made\x20with\x20base64\x20encoded\x20URLs','getPayoutStats','post','‚ùå\x20[ADMIN]\x20Manual\x20CoinToPay\x20check\x20failed\x20for\x20payment\x20','getMerchantsAwaitingPayout','Each\x20new\x20payment\x20gets\x20individual\x20timers:\x201min,\x202min,\x207min,\x2012min,\x20then\x20hourly','Server\x20crashes\x20if\x20domain\x20is\x20not\x20responding\x20after\x20consecutive\x20failures','amount','checkPaymentById','now','updateUserSchema','updateCustomerData','317184rdIdLT','3221823lvlIXQ','/domain-monitoring/check','/users/:id','getTime','paymentId'];a19_0x5613=function(){return _0x570d5f;};return a19_0x5613();}const a19_0xb1cf02=a19_0xa95d;(function(_0x52c12c,_0x5f7555){const _0xe7cf0a=a19_0xa95d,_0x33faab=_0x52c12c();while(!![]){try{const _0x2e4d7d=-parseInt(_0xe7cf0a(0x192))/0x1+-parseInt(_0xe7cf0a(0x1b3))/0x2+-parseInt(_0xe7cf0a(0x193))/0x3*(parseInt(_0xe7cf0a(0x1b6))/0x4)+parseInt(_0xe7cf0a(0x1d7))/0x5+-parseInt(_0xe7cf0a(0x17f))/0x6*(-parseInt(_0xe7cf0a(0x184))/0x7)+parseInt(_0xe7cf0a(0x19f))/0x8*(-parseInt(_0xe7cf0a(0x19e))/0x9)+parseInt(_0xe7cf0a(0x1ba))/0xa*(parseInt(_0xe7cf0a(0x173))/0xb);if(_0x2e4d7d===_0x5f7555)break;else _0x33faab['push'](_0x33faab['shift']());}catch(_0x1765ad){_0x33faab['push'](_0x33faab['shift']());}}}(a19_0x5613,0xdde38));var __createBinding=this&&this[a19_0xb1cf02(0x1e4)]||(Object[a19_0xb1cf02(0x1a5)]?function(_0x15187d,_0x2a6047,_0x280ec9,_0x506c11){const _0x4fba71=a19_0xb1cf02;if(_0x506c11===undefined)_0x506c11=_0x280ec9;var _0x18a0b0=Object[_0x4fba71(0x1bb)](_0x2a6047,_0x280ec9);(!_0x18a0b0||(_0x4fba71(0x1e2)in _0x18a0b0?!_0x2a6047[_0x4fba71(0x1c1)]:_0x18a0b0[_0x4fba71(0x17b)]||_0x18a0b0[_0x4fba71(0x182)]))&&(_0x18a0b0={'enumerable':!![],'get':function(){return _0x2a6047[_0x280ec9];}}),Object[_0x4fba71(0x175)](_0x15187d,_0x506c11,_0x18a0b0);}:function(_0x53bcea,_0x5b4f35,_0x4d776a,_0x3e3c97){if(_0x3e3c97===undefined)_0x3e3c97=_0x4d776a;_0x53bcea[_0x3e3c97]=_0x5b4f35[_0x4d776a];}),__setModuleDefault=this&&this[a19_0xb1cf02(0x1a6)]||(Object[a19_0xb1cf02(0x1a5)]?function(_0x1834bc,_0x178981){const _0x54eec0=a19_0xb1cf02;Object['defineProperty'](_0x1834bc,_0x54eec0(0x1a9),{'enumerable':!![],'value':_0x178981});}:function(_0x2d9aa5,_0x17d85c){const _0x56172a=a19_0xb1cf02;_0x2d9aa5[_0x56172a(0x1a9)]=_0x17d85c;}),__importStar=this&&this['__importStar']||(function(){var _0x2f4a6a=function(_0x237f2d){const _0x2c28a6=a19_0xa95d;return _0x2f4a6a=Object[_0x2c28a6(0x1d3)]||function(_0x9b1a99){const _0x5a8f37=_0x2c28a6;var _0x195887=[];for(var _0x3208f8 in _0x9b1a99)if(Object[_0x5a8f37(0x1b4)]['hasOwnProperty']['call'](_0x9b1a99,_0x3208f8))_0x195887[_0x195887[_0x5a8f37(0x171)]]=_0x3208f8;return _0x195887;},_0x2f4a6a(_0x237f2d);};return function(_0x597bed){const _0x351e8c=a19_0xa95d;if(_0x597bed&&_0x597bed[_0x351e8c(0x1c1)])return _0x597bed;var _0x6ae908={};if(_0x597bed!=null){for(var _0x2048f0=_0x2f4a6a(_0x597bed),_0x9e7e0b=0x0;_0x9e7e0b<_0x2048f0['length'];_0x9e7e0b++)if(_0x2048f0[_0x9e7e0b]!==_0x351e8c(0x1a9))__createBinding(_0x6ae908,_0x597bed,_0x2048f0[_0x9e7e0b]);}return __setModuleDefault(_0x6ae908,_0x597bed),_0x6ae908;};}());Object[a19_0xb1cf02(0x175)](exports,a19_0xb1cf02(0x1c1),{'value':!![]});const express_1=require(a19_0xb1cf02(0x1d9)),adminController_1=require(a19_0xb1cf02(0x1de)),validation_1=require('../middleware/validation'),auth_1=require(a19_0xb1cf02(0x1db)),loggerService_1=require(a19_0xb1cf02(0x1b7)),coinToPayStatusService_1=require('../services/coinToPayStatusService'),domainMonitoringService_1=require(a19_0xb1cf02(0x1dd)),router=(0x0,express_1[a19_0xb1cf02(0x1d4)])(),adminController=new adminController_1[(a19_0xb1cf02(0x1a4))]();router['use'](auth_1['authenticateToken'],auth_1[a19_0xb1cf02(0x1ad)]),router[a19_0xb1cf02(0x1e2)](a19_0xb1cf02(0x1bf),adminController[a19_0xb1cf02(0x1d6)]),router['get'](a19_0xb1cf02(0x1bd),adminController['getStatistics']),router[a19_0xb1cf02(0x1e2)](a19_0xb1cf02(0x1b1),adminController[a19_0xb1cf02(0x1e0)]),router[a19_0xb1cf02(0x1e2)]('/payout/stats',adminController[a19_0xb1cf02(0x187)]),router['get']('/payout/merchants',adminController[a19_0xb1cf02(0x18a)]),router[a19_0xb1cf02(0x1e2)](a19_0xb1cf02(0x1be),adminController['getMerchantsSelection']),router[a19_0xb1cf02(0x188)]('/payout',(0x0,validation_1['validate'])(validation_1[a19_0xb1cf02(0x1d2)]),adminController[a19_0xb1cf02(0x1c9)]),router[a19_0xb1cf02(0x1e2)]('/payouts',adminController[a19_0xb1cf02(0x1c6)]),router['get']('/payouts/:id',adminController['getPayoutById']),router[a19_0xb1cf02(0x1b9)](a19_0xb1cf02(0x1a0),adminController['deletePayout']),router[a19_0xb1cf02(0x1e2)]('/payments',adminController[a19_0xb1cf02(0x180)]),router[a19_0xb1cf02(0x1e2)](a19_0xb1cf02(0x1af),adminController[a19_0xb1cf02(0x1b5)]),router[a19_0xb1cf02(0x1d0)](a19_0xb1cf02(0x1af),adminController[a19_0xb1cf02(0x1b8)]),router['put'](a19_0xb1cf02(0x198),(0x0,validation_1['validate'])(validation_1[a19_0xb1cf02(0x17e)]),adminController[a19_0xb1cf02(0x191)]),router[a19_0xb1cf02(0x1e2)](a19_0xb1cf02(0x1a2),adminController[a19_0xb1cf02(0x178)]),router[a19_0xb1cf02(0x1e2)]('/users/:id',adminController[a19_0xb1cf02(0x1a8)]),router['post']('/users',(0x0,validation_1[a19_0xb1cf02(0x1a3)])(validation_1[a19_0xb1cf02(0x1c7)]),adminController[a19_0xb1cf02(0x1c0)]),router[a19_0xb1cf02(0x1d0)](a19_0xb1cf02(0x195),(0x0,validation_1[a19_0xb1cf02(0x1a3)])(validation_1[a19_0xb1cf02(0x190)]),adminController[a19_0xb1cf02(0x176)]),router['delete'](a19_0xb1cf02(0x195),adminController[a19_0xb1cf02(0x1c2)]),router['post'](a19_0xb1cf02(0x1cf),adminController[a19_0xb1cf02(0x1ab)]),router[a19_0xb1cf02(0x188)]('/users/:id/activate',adminController['activateUser']),router['get'](a19_0xb1cf02(0x179),(_0x3c4477,_0xe4a275)=>{const _0x2d22ee=a19_0xb1cf02;try{const _0x448e0a=loggerService_1[_0x2d22ee(0x1df)]['getLogStats']();_0xe4a275[_0x2d22ee(0x183)]({'success':!![],'result':_0x448e0a});}catch(_0x2191ab){_0xe4a275[_0x2d22ee(0x181)](0x1f4)['json']({'success':![],'message':_0x2d22ee(0x1d5)});}}),router['post']('/logs/clean',(_0xddc540,_0x2c52f0)=>{const _0xc4492f=a19_0xb1cf02;try{const {daysToKeep:daysToKeep=0x1e}=_0xddc540[_0xc4492f(0x17a)];loggerService_1[_0xc4492f(0x1df)]['cleanOldLogs'](daysToKeep),_0x2c52f0['json']({'success':!![],'message':_0xc4492f(0x1cd)+daysToKeep+'\x20days)'});}catch(_0x19f4f8){_0x2c52f0['status'](0x1f4)[_0xc4492f(0x183)]({'success':![],'message':'Failed\x20to\x20clean\x20old\x20logs'});}}),router[a19_0xb1cf02(0x188)](a19_0xb1cf02(0x1b2),async(_0x2b581b,_0x1a2601)=>{const _0x35b805=a19_0xb1cf02;try{const {paymentId:_0x5980ec}=_0x2b581b['params'];console['log'](_0x35b805(0x16f)+_0x5980ec),await coinToPayStatusService_1[_0x35b805(0x1c8)][_0x35b805(0x18e)](_0x5980ec),_0x1a2601[_0x35b805(0x183)]({'success':!![],'message':_0x35b805(0x1a1)});}catch(_0x581977){console[_0x35b805(0x1a7)](_0x35b805(0x189)+_0x2b581b['params'][_0x35b805(0x197)]+':',_0x581977),_0x1a2601['status'](0x1f4)[_0x35b805(0x183)]({'success':![],'message':_0x581977 instanceof Error?_0x581977[_0x35b805(0x1cb)]:'Failed\x20to\x20check\x20CoinToPay\x20payment\x20status'});}}),router[a19_0xb1cf02(0x1e2)](a19_0xb1cf02(0x1ae),(_0x5dfa2b,_0x2ccb7c)=>{const _0x56dab2=a19_0xb1cf02;try{const _0x2c4332=coinToPayStatusService_1[_0x56dab2(0x1c8)]['getServiceStats']();_0x2ccb7c[_0x56dab2(0x183)]({'success':!![],'result':{..._0x2c4332,'description':_0x56dab2(0x1c4),'statusMapping':{'Paid':_0x56dab2(0x1c5),'Awaiting\x20Fiat':_0x56dab2(0x1e3),'waiting':'PENDING','expired':'EXPIRED','failed':_0x56dab2(0x174)},'autoExpiryNote':_0x56dab2(0x1bc)+_0x2c4332[_0x56dab2(0x1c3)]+_0x56dab2(0x19a),'individualTimersNote':_0x56dab2(0x18b)}});}catch(_0x15bb78){_0x2ccb7c[_0x56dab2(0x181)](0x1f4)[_0x56dab2(0x183)]({'success':![],'message':'Failed\x20to\x20get\x20CoinToPay\x20service\x20statistics'});}}),router['get'](a19_0xb1cf02(0x1ac),async(_0xf15e5a,_0x107d16)=>{const _0xf40891=a19_0xb1cf02;try{const {paymentId:_0x5b663c}=_0xf15e5a[_0xf40891(0x1e1)],_0x53d474=coinToPayStatusService_1[_0xf40891(0x1c8)][_0xf40891(0x1cc)](_0x5b663c),_0x62cec8=(await Promise['resolve']()['then'](()=>__importStar(require(_0xf40891(0x170)))))[_0xf40891(0x1a9)],_0x46cef8=await _0x62cec8[_0xf40891(0x1e5)][_0xf40891(0x19c)]({'where':{'id':_0x5b663c},'select':{'id':!![],'gateway':!![],'gatewayPaymentId':!![],'status':!![],'amount':!![],'currency':!![],'createdAt':!![],'updatedAt':!![],'shopId':!![],'shop':{'select':{'name':!![],'username':!![]}}}});if(!_0x46cef8)return _0x107d16[_0xf40891(0x181)](0x194)[_0xf40891(0x183)]({'success':![],'message':'Payment\x20not\x20found'});_0x107d16[_0xf40891(0x183)]({'success':!![],'result':{'payment':{'id':_0x46cef8['id'],'gateway':_0x46cef8[_0xf40891(0x1b0)],'gatewayPaymentId':_0x46cef8[_0xf40891(0x1da)],'status':_0x46cef8[_0xf40891(0x181)],'amount':_0x46cef8[_0xf40891(0x18d)],'currency':_0x46cef8[_0xf40891(0x17d)],'createdAt':_0x46cef8[_0xf40891(0x199)],'updatedAt':_0x46cef8[_0xf40891(0x1ca)],'shop':_0x46cef8[_0xf40891(0x172)]},'timers':_0x53d474,'isCoinToPay':_0x46cef8['gateway']==='cointopay','ageInMinutes':Math[_0xf40891(0x1d8)]((Date[_0xf40891(0x18f)]()-_0x46cef8[_0xf40891(0x199)][_0xf40891(0x196)]())/(0x3e8*0x3c))}});}catch(_0x2f133c){_0x107d16['status'](0x1f4)['json']({'success':![],'message':_0x2f133c instanceof Error?_0x2f133c[_0xf40891(0x1cb)]:_0xf40891(0x185)});}}),router[a19_0xb1cf02(0x1e2)](a19_0xb1cf02(0x17c),(_0xd33c99,_0x5081ee)=>{const _0xcb3af6=a19_0xb1cf02;try{const _0x795846=domainMonitoringService_1['domainMonitoringService'][_0xcb3af6(0x177)]();_0x5081ee[_0xcb3af6(0x183)]({'success':!![],'result':{..._0x795846,'description':_0xcb3af6(0x1aa),'behavior':_0xcb3af6(0x18c),'encoding':_0xcb3af6(0x186)}});}catch(_0x12d96e){_0x5081ee['status'](0x1f4)[_0xcb3af6(0x183)]({'success':![],'message':_0xcb3af6(0x19b)});}}),router[a19_0xb1cf02(0x188)](a19_0xb1cf02(0x194),async(_0x481f8e,_0x2a57f1)=>{const _0x51a341=a19_0xb1cf02;try{const _0x3bf8bf=await domainMonitoringService_1['domainMonitoringService']['manualCheck']();_0x2a57f1[_0x51a341(0x183)]({'success':!![],'result':{'domainAvailable':_0x3bf8bf,'message':_0x3bf8bf?_0x51a341(0x1d1):_0x51a341(0x19d),'timestamp':new Date()[_0x51a341(0x1dc)]()}});}catch(_0x4df72d){_0x2a57f1[_0x51a341(0x181)](0x1f4)[_0x51a341(0x183)]({'success':![],'message':_0x4df72d instanceof Error?_0x4df72d['message']:_0x51a341(0x1ce)});}}),exports[a19_0xb1cf02(0x1a9)]=router;