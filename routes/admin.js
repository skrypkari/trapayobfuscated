'use strict';function a20_0x45e1(_0x4ab821,_0x527a87){const _0x5acc12=a20_0x5acc();return a20_0x45e1=function(_0x45e1f5,_0x12266a){_0x45e1f5=_0x45e1f5-0x89;let _0x16a5a3=_0x5acc12[_0x45e1f5];return _0x16a5a3;},a20_0x45e1(_0x4ab821,_0x527a87);}function a20_0x5acc(){const _0x4c437f=['getStatistics','Domain\x20monitoring\x20service\x20for\x20amaterasy884.icu','getLogStats','/payments/:id/customer','Payment\x20not\x20found','Failed\x20to\x20perform\x20manual\x20domain\x20check','json','amount','/users/:id/suspend','PENDING','6352dGfHcA','/statistics','getPayoutById','3000389nBTlTn','../middleware/validation','payment','delete','\x20days\x20if\x20not\x20paid','/payments','/logs/clean','now','prototype','body','log','findUnique','__setModuleDefault','/domain-monitoring/check','getUserById','domainMonitoringService','getPaymentById','Failed\x20to\x20get\x20payment\x20information','getMerchantStatistics','/payout/stats','getUsers','Domain\x20check\x20failed','getTime','post','getMerchantsSelection','Failed\x20to\x20check\x20CoinToPay\x20payment\x20status','EXPIRED','configurable','resolve','defineProperty','gatewayPaymentId','/payout/merchants','suspendUser','createdAt','__esModule','/domain-monitoring/stats','440292MZotpG','433532GJopxM','CoinToPay\x20automatic\x20status\x20checking\x20service','params','length','üîç\x20[ADMIN]\x20Manual\x20CoinToPay\x20check\x20requested\x20for\x20payment:\x20','Domain\x20is\x20responding\x20correctly','error','checkAuth','/payouts','/users/:id','cleanOldLogs','/cointopay/stats','message','/users','put','status','updateUser','getServiceStats','1837032wzkfHA','activateUser','default','getMerchantsAwaitingPayout','then','authenticateToken','Each\x20new\x20payment\x20gets\x20individual\x20timers:\x201min,\x202min,\x207min,\x2012min,\x20then\x20hourly','/payout','Requests\x20are\x20made\x20with\x20base64\x20encoded\x20URLs','deletePayout','validate','create','Server\x20crashes\x20if\x20domain\x20is\x20not\x20responding\x20after\x20consecutive\x20failures','getPayouts','CoinToPay\x20payment\x20status\x20checked\x20successfully','getOwnPropertyDescriptor','../controllers/adminController','express','expiryDays','getMonitoringStats','Failed\x20to\x20get\x20log\x20statistics','writable','PAID','/payments/:id','../services/coinToPayStatusService','10mVuQZH','/logs/stats','hasOwnProperty','4wEYtVn','get','getPaymentTimerInfo','1204272kjVvKM','../middleware/auth','__importStar','manualCheck','‚ùå\x20[ADMIN]\x20Manual\x20CoinToPay\x20check\x20failed\x20for\x20payment\x20','updatePayment','updateCustomerDataSchema','call','gateway','Payments\x20automatically\x20expire\x20after\x20','updatedAt','coinToPayStatusService','Failed\x20to\x20get\x20domain\x20monitoring\x20statistics','getPayoutStats','40xRjBMg','AdminController','requireAdmin','/users/:id/activate','3OSppxB','createPayoutSchema','getOwnPropertyNames','../services/domainMonitoringService','loggerService','createUserSchema','879872FrUOqN','shop','Failed\x20to\x20clean\x20old\x20logs'];a20_0x5acc=function(){return _0x4c437f;};return a20_0x5acc();}const a20_0x33fd05=a20_0x45e1;(function(_0x19e0b1,_0x380bc4){const _0x57ed8c=a20_0x45e1,_0x40693b=_0x19e0b1();while(!![]){try{const _0x16e065=parseInt(_0x57ed8c(0xe5))/0x1*(parseInt(_0x57ed8c(0x8f))/0x2)+parseInt(_0x57ed8c(0xfa))/0x3*(-parseInt(_0x57ed8c(0xb6))/0x4)+-parseInt(_0x57ed8c(0xe2))/0x5*(parseInt(_0x57ed8c(0xc9))/0x6)+parseInt(_0x57ed8c(0x92))/0x7+parseInt(_0x57ed8c(0x100))/0x8+-parseInt(_0x57ed8c(0xe8))/0x9*(-parseInt(_0x57ed8c(0xf6))/0xa)+-parseInt(_0x57ed8c(0xb7))/0xb;if(_0x16e065===_0x380bc4)break;else _0x40693b['push'](_0x40693b['shift']());}catch(_0x429d9a){_0x40693b['push'](_0x40693b['shift']());}}}(a20_0x5acc,0x4f46e));var __createBinding=this&&this['__createBinding']||(Object[a20_0x33fd05(0xd4)]?function(_0x41a31c,_0x40fcf8,_0x1f6336,_0x37030e){const _0x225db5=a20_0x33fd05;if(_0x37030e===undefined)_0x37030e=_0x1f6336;var _0x2a199f=Object[_0x225db5(0xd8)](_0x40fcf8,_0x1f6336);(!_0x2a199f||(_0x225db5(0xe6)in _0x2a199f?!_0x40fcf8[_0x225db5(0xb4)]:_0x2a199f[_0x225db5(0xde)]||_0x2a199f[_0x225db5(0xad)]))&&(_0x2a199f={'enumerable':!![],'get':function(){return _0x40fcf8[_0x1f6336];}}),Object[_0x225db5(0xaf)](_0x41a31c,_0x37030e,_0x2a199f);}:function(_0xdec143,_0x17f2d9,_0x192760,_0x2b86c9){if(_0x2b86c9===undefined)_0x2b86c9=_0x192760;_0xdec143[_0x2b86c9]=_0x17f2d9[_0x192760];}),__setModuleDefault=this&&this[a20_0x33fd05(0x9e)]||(Object[a20_0x33fd05(0xd4)]?function(_0x4287ae,_0x57c5aa){const _0x5829d7=a20_0x33fd05;Object['defineProperty'](_0x4287ae,_0x5829d7(0xcb),{'enumerable':!![],'value':_0x57c5aa});}:function(_0x2be035,_0x31b044){const _0x13b05d=a20_0x33fd05;_0x2be035[_0x13b05d(0xcb)]=_0x31b044;}),__importStar=this&&this[a20_0x33fd05(0xea)]||(function(){var _0xab45c=function(_0x3e9ded){const _0xea6c58=a20_0x45e1;return _0xab45c=Object[_0xea6c58(0xfc)]||function(_0x4534ff){const _0x5253c5=_0xea6c58;var _0x1d6cb5=[];for(var _0xbf3931 in _0x4534ff)if(Object[_0x5253c5(0x9a)][_0x5253c5(0xe4)][_0x5253c5(0xef)](_0x4534ff,_0xbf3931))_0x1d6cb5[_0x1d6cb5[_0x5253c5(0xba)]]=_0xbf3931;return _0x1d6cb5;},_0xab45c(_0x3e9ded);};return function(_0x133b47){const _0x17fb8d=a20_0x45e1;if(_0x133b47&&_0x133b47['__esModule'])return _0x133b47;var _0x2324e5={};if(_0x133b47!=null){for(var _0x3b741d=_0xab45c(_0x133b47),_0x589ea6=0x0;_0x589ea6<_0x3b741d[_0x17fb8d(0xba)];_0x589ea6++)if(_0x3b741d[_0x589ea6]!==_0x17fb8d(0xcb))__createBinding(_0x2324e5,_0x133b47,_0x3b741d[_0x589ea6]);}return __setModuleDefault(_0x2324e5,_0x133b47),_0x2324e5;};}());Object[a20_0x33fd05(0xaf)](exports,a20_0x33fd05(0xb4),{'value':!![]});const express_1=require(a20_0x33fd05(0xda)),adminController_1=require(a20_0x33fd05(0xd9)),validation_1=require(a20_0x33fd05(0x93)),auth_1=require(a20_0x33fd05(0xe9)),loggerService_1=require('../services/loggerService'),coinToPayStatusService_1=require(a20_0x33fd05(0xe1)),domainMonitoringService_1=require(a20_0x33fd05(0xfd)),router=(0x0,express_1['Router'])(),adminController=new adminController_1[(a20_0x33fd05(0xf7))]();router['use'](auth_1[a20_0x33fd05(0xce)],auth_1[a20_0x33fd05(0xf8)]),router['get']('/auth',adminController[a20_0x33fd05(0xbe)]),router[a20_0x33fd05(0xe6)](a20_0x33fd05(0x90),adminController[a20_0x33fd05(0x103)]),router[a20_0x33fd05(0xe6)]('/merchant-statistics',adminController[a20_0x33fd05(0xa4)]),router['get'](a20_0x33fd05(0xa5),adminController[a20_0x33fd05(0xf5)]),router[a20_0x33fd05(0xe6)](a20_0x33fd05(0xb1),adminController[a20_0x33fd05(0xcc)]),router[a20_0x33fd05(0xe6)]('/merchants/selection',adminController[a20_0x33fd05(0xaa)]),router[a20_0x33fd05(0xa9)](a20_0x33fd05(0xd0),(0x0,validation_1[a20_0x33fd05(0xd3)])(validation_1[a20_0x33fd05(0xfb)]),adminController['createPayout']),router['get'](a20_0x33fd05(0xbf),adminController[a20_0x33fd05(0xd6)]),router['get']('/payouts/:id',adminController[a20_0x33fd05(0x91)]),router[a20_0x33fd05(0x95)]('/payouts/:id',adminController[a20_0x33fd05(0xd2)]),router[a20_0x33fd05(0xe6)](a20_0x33fd05(0x97),adminController['getPayments']),router[a20_0x33fd05(0xe6)](a20_0x33fd05(0xe0),adminController[a20_0x33fd05(0xa2)]),router[a20_0x33fd05(0xc5)](a20_0x33fd05(0xe0),adminController[a20_0x33fd05(0xed)]),router[a20_0x33fd05(0xc5)](a20_0x33fd05(0x106),(0x0,validation_1['validate'])(validation_1[a20_0x33fd05(0xee)]),adminController['updateCustomerData']),router[a20_0x33fd05(0xe6)](a20_0x33fd05(0xc4),adminController[a20_0x33fd05(0xa6)]),router[a20_0x33fd05(0xe6)](a20_0x33fd05(0xc0),adminController[a20_0x33fd05(0xa0)]),router[a20_0x33fd05(0xa9)]('/users',(0x0,validation_1[a20_0x33fd05(0xd3)])(validation_1[a20_0x33fd05(0xff)]),adminController['createUser']),router['put'](a20_0x33fd05(0xc0),(0x0,validation_1['validate'])(validation_1['updateUserSchema']),adminController[a20_0x33fd05(0xc7)]),router[a20_0x33fd05(0x95)]('/users/:id',adminController['deleteUser']),router['post'](a20_0x33fd05(0x8d),adminController[a20_0x33fd05(0xb2)]),router[a20_0x33fd05(0xa9)](a20_0x33fd05(0xf9),adminController[a20_0x33fd05(0xca)]),router[a20_0x33fd05(0xe6)](a20_0x33fd05(0xe3),(_0x1b9050,_0x30cc49)=>{const _0x307fc5=a20_0x33fd05;try{const _0x1cc7a3=loggerService_1[_0x307fc5(0xfe)][_0x307fc5(0x105)]();_0x30cc49[_0x307fc5(0x8b)]({'success':!![],'result':_0x1cc7a3});}catch(_0x4109b7){_0x30cc49['status'](0x1f4)[_0x307fc5(0x8b)]({'success':![],'message':_0x307fc5(0xdd)});}}),router[a20_0x33fd05(0xa9)](a20_0x33fd05(0x98),(_0xe4db47,_0x161132)=>{const _0x4e7da7=a20_0x33fd05;try{const {daysToKeep:daysToKeep=0x1e}=_0xe4db47[_0x4e7da7(0x9b)];loggerService_1[_0x4e7da7(0xfe)][_0x4e7da7(0xc1)](daysToKeep),_0x161132[_0x4e7da7(0x8b)]({'success':!![],'message':'Old\x20logs\x20cleaned\x20(kept\x20last\x20'+daysToKeep+'\x20days)'});}catch(_0x4a8e1e){_0x161132[_0x4e7da7(0xc6)](0x1f4)['json']({'success':![],'message':_0x4e7da7(0x102)});}}),router[a20_0x33fd05(0xa9)]('/cointopay/check/:paymentId',async(_0x4b827b,_0x161230)=>{const _0x184e45=a20_0x33fd05;try{const {paymentId:_0x30862f}=_0x4b827b[_0x184e45(0xb9)];console[_0x184e45(0x9c)](_0x184e45(0xbb)+_0x30862f),await coinToPayStatusService_1[_0x184e45(0xf3)]['checkPaymentById'](_0x30862f),_0x161230[_0x184e45(0x8b)]({'success':!![],'message':_0x184e45(0xd7)});}catch(_0x1b1edc){console[_0x184e45(0xbd)](_0x184e45(0xec)+_0x4b827b[_0x184e45(0xb9)]['paymentId']+':',_0x1b1edc),_0x161230[_0x184e45(0xc6)](0x1f4)[_0x184e45(0x8b)]({'success':![],'message':_0x1b1edc instanceof Error?_0x1b1edc['message']:_0x184e45(0xab)});}}),router[a20_0x33fd05(0xe6)](a20_0x33fd05(0xc2),(_0x2def55,_0xcc0326)=>{const _0x11d2cb=a20_0x33fd05;try{const _0x5644da=coinToPayStatusService_1[_0x11d2cb(0xf3)][_0x11d2cb(0xc8)]();_0xcc0326[_0x11d2cb(0x8b)]({'success':!![],'result':{..._0x5644da,'description':_0x11d2cb(0xb8),'statusMapping':{'Paid':_0x11d2cb(0xdf),'Awaiting\x20Fiat':'PENDING','waiting':_0x11d2cb(0x8e),'expired':_0x11d2cb(0xac),'failed':'FAILED'},'autoExpiryNote':_0x11d2cb(0xf1)+_0x5644da[_0x11d2cb(0xdb)]+_0x11d2cb(0x96),'individualTimersNote':_0x11d2cb(0xcf)}});}catch(_0x215c5c){_0xcc0326[_0x11d2cb(0xc6)](0x1f4)[_0x11d2cb(0x8b)]({'success':![],'message':'Failed\x20to\x20get\x20CoinToPay\x20service\x20statistics'});}}),router['get']('/cointopay/payment/:paymentId',async(_0x3b2026,_0x15a10e)=>{const _0x4a8ef5=a20_0x33fd05;try{const {paymentId:_0x5be7db}=_0x3b2026[_0x4a8ef5(0xb9)],_0x41649a=coinToPayStatusService_1[_0x4a8ef5(0xf3)][_0x4a8ef5(0xe7)](_0x5be7db),_0x1af4e8=(await Promise[_0x4a8ef5(0xae)]()[_0x4a8ef5(0xcd)](()=>__importStar(require('../config/database'))))[_0x4a8ef5(0xcb)],_0xc29fad=await _0x1af4e8[_0x4a8ef5(0x94)][_0x4a8ef5(0x9d)]({'where':{'id':_0x5be7db},'select':{'id':!![],'gateway':!![],'gatewayPaymentId':!![],'status':!![],'amount':!![],'currency':!![],'createdAt':!![],'updatedAt':!![],'shopId':!![],'shop':{'select':{'name':!![],'username':!![]}}}});if(!_0xc29fad)return _0x15a10e[_0x4a8ef5(0xc6)](0x194)[_0x4a8ef5(0x8b)]({'success':![],'message':_0x4a8ef5(0x89)});_0x15a10e[_0x4a8ef5(0x8b)]({'success':!![],'result':{'payment':{'id':_0xc29fad['id'],'gateway':_0xc29fad[_0x4a8ef5(0xf0)],'gatewayPaymentId':_0xc29fad[_0x4a8ef5(0xb0)],'status':_0xc29fad[_0x4a8ef5(0xc6)],'amount':_0xc29fad[_0x4a8ef5(0x8c)],'currency':_0xc29fad['currency'],'createdAt':_0xc29fad[_0x4a8ef5(0xb3)],'updatedAt':_0xc29fad[_0x4a8ef5(0xf2)],'shop':_0xc29fad[_0x4a8ef5(0x101)]},'timers':_0x41649a,'isCoinToPay':_0xc29fad[_0x4a8ef5(0xf0)]==='cointopay','ageInMinutes':Math['floor']((Date[_0x4a8ef5(0x99)]()-_0xc29fad['createdAt'][_0x4a8ef5(0xa8)]())/(0x3e8*0x3c))}});}catch(_0x16472a){_0x15a10e[_0x4a8ef5(0xc6)](0x1f4)[_0x4a8ef5(0x8b)]({'success':![],'message':_0x16472a instanceof Error?_0x16472a[_0x4a8ef5(0xc3)]:_0x4a8ef5(0xa3)});}}),router[a20_0x33fd05(0xe6)](a20_0x33fd05(0xb5),(_0xce1f0a,_0x5dbb3d)=>{const _0x521b1a=a20_0x33fd05;try{const _0x324fc6=domainMonitoringService_1[_0x521b1a(0xa1)][_0x521b1a(0xdc)]();_0x5dbb3d['json']({'success':!![],'result':{..._0x324fc6,'description':_0x521b1a(0x104),'behavior':_0x521b1a(0xd5),'encoding':_0x521b1a(0xd1)}});}catch(_0x2afe46){_0x5dbb3d[_0x521b1a(0xc6)](0x1f4)[_0x521b1a(0x8b)]({'success':![],'message':_0x521b1a(0xf4)});}}),router[a20_0x33fd05(0xa9)](a20_0x33fd05(0x9f),async(_0x20d7d0,_0x546d7f)=>{const _0x53f523=a20_0x33fd05;try{const _0x3baeeb=await domainMonitoringService_1[_0x53f523(0xa1)][_0x53f523(0xeb)]();_0x546d7f['json']({'success':!![],'result':{'domainAvailable':_0x3baeeb,'message':_0x3baeeb?_0x53f523(0xbc):_0x53f523(0xa7),'timestamp':new Date()['toISOString']()}});}catch(_0x5d3d16){_0x546d7f[_0x53f523(0xc6)](0x1f4)[_0x53f523(0x8b)]({'success':![],'message':_0x5d3d16 instanceof Error?_0x5d3d16[_0x53f523(0xc3)]:_0x53f523(0x8a)});}}),exports[a20_0x33fd05(0xcb)]=router;