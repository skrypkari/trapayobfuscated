'use strict';function a19_0x38bb(_0x12c5ff,_0x5ee931){const _0x17849e=a19_0x1784();return a19_0x38bb=function(_0x38bb2e,_0x3d8a02){_0x38bb2e=_0x38bb2e-0x12d;let _0x14dd09=_0x17849e[_0x38bb2e];return _0x14dd09;},a19_0x38bb(_0x12c5ff,_0x5ee931);}function a19_0x1784(){const _0x4bde18=['getOwnPropertyDescriptor','Requests\x20are\x20made\x20with\x20base64\x20encoded\x20URLs','EXPIRED','getOwnPropertyNames','use','create','getLogStats','Payments\x20automatically\x20expire\x20after\x20','expiryDays','Failed\x20to\x20check\x20CoinToPay\x20payment\x20status','PAID','findUnique','getMerchantsAwaitingPayout','Old\x20logs\x20cleaned\x20(kept\x20last\x20','/payouts/:id','181146EuPpvP','__esModule','/cointopay/stats','body','397480pVoDjc','CoinToPay\x20payment\x20status\x20checked\x20successfully','checkPaymentById','Domain\x20monitoring\x20service\x20for\x20amaterasy884.icu','../middleware/validation','error','/payments/:id','Domain\x20check\x20failed','/users/:id/activate','4Gddpug','\x20days)','defineProperty','/merchant-statistics','/logs/clean','createUser','message','currency','createPayoutSchema','validate','\x20days\x20if\x20not\x20paid','gateway','suspendUser','/domain-monitoring/check','updatePayment','__createBinding','3034560tZHYoC','resolve','/cointopay/check/:paymentId','requireAdmin','createUserSchema','cointopay','üîç\x20[ADMIN]\x20Manual\x20CoinToPay\x20check\x20requested\x20for\x20payment:\x20','prototype','hasOwnProperty','90qLnCWt','params','express','put','../services/loggerService','getServiceStats','length','/domain-monitoring/stats','/auth','1075242KRIrbn','default','getTime','getPayoutStats','domainMonitoringService','1LhXFgY','coinToPayStatusService','40980YtucSk','toISOString','get','json','Failed\x20to\x20get\x20payment\x20information','writable','createPayout','/users/:id/suspend','getPayments','PENDING','/statistics','post','/payments','updateUserSchema','status','getMerchantStatistics','/payout/stats','cleanOldLogs','Domain\x20is\x20responding\x20correctly','Failed\x20to\x20get\x20log\x20statistics','/users','__setModuleDefault','updatedAt','Failed\x20to\x20perform\x20manual\x20domain\x20check','authenticateToken','681632YlQgEW','getPaymentById','createdAt','CoinToPay\x20automatic\x20status\x20checking\x20service','Failed\x20to\x20clean\x20old\x20logs','/payout','deleteUser','__importStar','floor','/users/:id','getStatistics','gatewayPaymentId','/payout/merchants','updateUser','call','../services/domainMonitoringService','187HTocNc','now','loggerService','2542235ttGsAD','Each\x20new\x20payment\x20gets\x20individual\x20timers:\x201min,\x202min,\x207min,\x2012min,\x20then\x20hourly','getPaymentTimerInfo','activateUser','updateCustomerData','/merchants/selection','shop'];a19_0x1784=function(){return _0x4bde18;};return a19_0x1784();}const a19_0x3f0384=a19_0x38bb;(function(_0x364050,_0x281a01){const _0x1c5dd0=a19_0x38bb,_0xfa82ff=_0x364050();while(!![]){try{const _0x3cae7e=-parseInt(_0x1c5dd0(0x190))/0x1*(-parseInt(_0x1c5dd0(0x15c))/0x2)+-parseInt(_0x1c5dd0(0x18b))/0x3+parseInt(_0x1c5dd0(0x169))/0x4*(parseInt(_0x1c5dd0(0x146))/0x5)+parseInt(_0x1c5dd0(0x179))/0x6+parseInt(_0x1c5dd0(0x133))/0x7+-parseInt(_0x1c5dd0(0x160))/0x8*(parseInt(_0x1c5dd0(0x182))/0x9)+parseInt(_0x1c5dd0(0x192))/0xa*(-parseInt(_0x1c5dd0(0x143))/0xb);if(_0x3cae7e===_0x281a01)break;else _0xfa82ff['push'](_0xfa82ff['shift']());}catch(_0xd079a1){_0xfa82ff['push'](_0xfa82ff['shift']());}}}(a19_0x1784,0x43aea));var __createBinding=this&&this[a19_0x3f0384(0x178)]||(Object['create']?function(_0x3607eb,_0xa0e675,_0x157300,_0x571d49){const _0xafb824=a19_0x3f0384;if(_0x571d49===undefined)_0x571d49=_0x157300;var _0x43d7aa=Object[_0xafb824(0x14d)](_0xa0e675,_0x157300);(!_0x43d7aa||('get'in _0x43d7aa?!_0xa0e675[_0xafb824(0x15d)]:_0x43d7aa[_0xafb824(0x197)]||_0x43d7aa['configurable']))&&(_0x43d7aa={'enumerable':!![],'get':function(){return _0xa0e675[_0x157300];}}),Object['defineProperty'](_0x3607eb,_0x571d49,_0x43d7aa);}:function(_0x1bef58,_0x34309e,_0x501e82,_0x3c1a39){if(_0x3c1a39===undefined)_0x3c1a39=_0x501e82;_0x1bef58[_0x3c1a39]=_0x34309e[_0x501e82];}),__setModuleDefault=this&&this[a19_0x3f0384(0x12f)]||(Object[a19_0x3f0384(0x152)]?function(_0x28b48b,_0x4b19ee){const _0x45a221=a19_0x3f0384;Object[_0x45a221(0x16b)](_0x28b48b,'default',{'enumerable':!![],'value':_0x4b19ee});}:function(_0xe7ebb,_0x55cdf4){_0xe7ebb['default']=_0x55cdf4;}),__importStar=this&&this[a19_0x3f0384(0x13a)]||(function(){var _0x5b8f19=function(_0x4fc3c7){const _0x16b777=a19_0x38bb;return _0x5b8f19=Object[_0x16b777(0x150)]||function(_0x382bf9){const _0x24c17b=_0x16b777;var _0x4c2f65=[];for(var _0x2e79ed in _0x382bf9)if(Object[_0x24c17b(0x180)][_0x24c17b(0x181)][_0x24c17b(0x141)](_0x382bf9,_0x2e79ed))_0x4c2f65[_0x4c2f65['length']]=_0x2e79ed;return _0x4c2f65;},_0x5b8f19(_0x4fc3c7);};return function(_0x455730){const _0x4a8eaf=a19_0x38bb;if(_0x455730&&_0x455730[_0x4a8eaf(0x15d)])return _0x455730;var _0x3ec8c6={};if(_0x455730!=null){for(var _0x307305=_0x5b8f19(_0x455730),_0x373bf9=0x0;_0x373bf9<_0x307305[_0x4a8eaf(0x188)];_0x373bf9++)if(_0x307305[_0x373bf9]!==_0x4a8eaf(0x18c))__createBinding(_0x3ec8c6,_0x455730,_0x307305[_0x373bf9]);}return __setModuleDefault(_0x3ec8c6,_0x455730),_0x3ec8c6;};}());Object[a19_0x3f0384(0x16b)](exports,'__esModule',{'value':!![]});const express_1=require(a19_0x3f0384(0x184)),adminController_1=require('../controllers/adminController'),validation_1=require(a19_0x3f0384(0x164)),auth_1=require('../middleware/auth'),loggerService_1=require(a19_0x3f0384(0x186)),coinToPayStatusService_1=require('../services/coinToPayStatusService'),domainMonitoringService_1=require(a19_0x3f0384(0x142)),router=(0x0,express_1['Router'])(),adminController=new adminController_1['AdminController']();router[a19_0x3f0384(0x151)](auth_1[a19_0x3f0384(0x132)],auth_1[a19_0x3f0384(0x17c)]),router[a19_0x3f0384(0x194)](a19_0x3f0384(0x18a),adminController['checkAuth']),router[a19_0x3f0384(0x194)](a19_0x3f0384(0x19c),adminController[a19_0x3f0384(0x13d)]),router[a19_0x3f0384(0x194)](a19_0x3f0384(0x16c),adminController[a19_0x3f0384(0x1a1)]),router[a19_0x3f0384(0x194)](a19_0x3f0384(0x1a2),adminController[a19_0x3f0384(0x18e)]),router[a19_0x3f0384(0x194)](a19_0x3f0384(0x13f),adminController[a19_0x3f0384(0x159)]),router[a19_0x3f0384(0x194)](a19_0x3f0384(0x14b),adminController['getMerchantsSelection']),router[a19_0x3f0384(0x19d)](a19_0x3f0384(0x138),(0x0,validation_1[a19_0x3f0384(0x172)])(validation_1[a19_0x3f0384(0x171)]),adminController[a19_0x3f0384(0x198)]),router[a19_0x3f0384(0x194)]('/payouts',adminController['getPayouts']),router['get'](a19_0x3f0384(0x15b),adminController['getPayoutById']),router['delete']('/payouts/:id',adminController['deletePayout']),router[a19_0x3f0384(0x194)](a19_0x3f0384(0x19e),adminController[a19_0x3f0384(0x19a)]),router[a19_0x3f0384(0x194)](a19_0x3f0384(0x166),adminController[a19_0x3f0384(0x134)]),router[a19_0x3f0384(0x185)](a19_0x3f0384(0x166),adminController[a19_0x3f0384(0x177)]),router['put']('/payments/:id/customer',(0x0,validation_1['validate'])(validation_1['updateCustomerDataSchema']),adminController[a19_0x3f0384(0x14a)]),router[a19_0x3f0384(0x194)](a19_0x3f0384(0x12e),adminController['getUsers']),router[a19_0x3f0384(0x194)](a19_0x3f0384(0x13c),adminController['getUserById']),router[a19_0x3f0384(0x19d)](a19_0x3f0384(0x12e),(0x0,validation_1[a19_0x3f0384(0x172)])(validation_1[a19_0x3f0384(0x17d)]),adminController[a19_0x3f0384(0x16e)]),router[a19_0x3f0384(0x185)](a19_0x3f0384(0x13c),(0x0,validation_1[a19_0x3f0384(0x172)])(validation_1[a19_0x3f0384(0x19f)]),adminController[a19_0x3f0384(0x140)]),router['delete'](a19_0x3f0384(0x13c),adminController[a19_0x3f0384(0x139)]),router[a19_0x3f0384(0x19d)](a19_0x3f0384(0x199),adminController[a19_0x3f0384(0x175)]),router[a19_0x3f0384(0x19d)](a19_0x3f0384(0x168),adminController[a19_0x3f0384(0x149)]),router[a19_0x3f0384(0x194)]('/logs/stats',(_0x167ed9,_0x28baab)=>{const _0x3754c2=a19_0x3f0384;try{const _0x2dde53=loggerService_1[_0x3754c2(0x145)][_0x3754c2(0x153)]();_0x28baab[_0x3754c2(0x195)]({'success':!![],'result':_0x2dde53});}catch(_0x5b6209){_0x28baab[_0x3754c2(0x1a0)](0x1f4)['json']({'success':![],'message':_0x3754c2(0x12d)});}}),router[a19_0x3f0384(0x19d)](a19_0x3f0384(0x16d),(_0x27df0,_0x2c1213)=>{const _0x56d2cc=a19_0x3f0384;try{const {daysToKeep:daysToKeep=0x1e}=_0x27df0[_0x56d2cc(0x15f)];loggerService_1[_0x56d2cc(0x145)][_0x56d2cc(0x1a3)](daysToKeep),_0x2c1213[_0x56d2cc(0x195)]({'success':!![],'message':_0x56d2cc(0x15a)+daysToKeep+_0x56d2cc(0x16a)});}catch(_0x3249b3){_0x2c1213[_0x56d2cc(0x1a0)](0x1f4)[_0x56d2cc(0x195)]({'success':![],'message':_0x56d2cc(0x137)});}}),router[a19_0x3f0384(0x19d)](a19_0x3f0384(0x17b),async(_0x5911e0,_0x3548b8)=>{const _0x211e17=a19_0x3f0384;try{const {paymentId:_0x20f1b5}=_0x5911e0[_0x211e17(0x183)];console['log'](_0x211e17(0x17f)+_0x20f1b5),await coinToPayStatusService_1['coinToPayStatusService'][_0x211e17(0x162)](_0x20f1b5),_0x3548b8[_0x211e17(0x195)]({'success':!![],'message':_0x211e17(0x161)});}catch(_0x3d0c3e){console[_0x211e17(0x165)]('‚ùå\x20[ADMIN]\x20Manual\x20CoinToPay\x20check\x20failed\x20for\x20payment\x20'+_0x5911e0[_0x211e17(0x183)]['paymentId']+':',_0x3d0c3e),_0x3548b8['status'](0x1f4)['json']({'success':![],'message':_0x3d0c3e instanceof Error?_0x3d0c3e[_0x211e17(0x16f)]:_0x211e17(0x156)});}}),router['get'](a19_0x3f0384(0x15e),(_0x303ea7,_0x21cc81)=>{const _0x8d49b5=a19_0x3f0384;try{const _0x2b1ca4=coinToPayStatusService_1[_0x8d49b5(0x191)][_0x8d49b5(0x187)]();_0x21cc81[_0x8d49b5(0x195)]({'success':!![],'result':{..._0x2b1ca4,'description':_0x8d49b5(0x136),'statusMapping':{'Paid':_0x8d49b5(0x157),'Awaiting\x20Fiat':_0x8d49b5(0x19b),'waiting':'PENDING','expired':_0x8d49b5(0x14f),'failed':'FAILED'},'autoExpiryNote':_0x8d49b5(0x154)+_0x2b1ca4[_0x8d49b5(0x155)]+_0x8d49b5(0x173),'individualTimersNote':_0x8d49b5(0x147)}});}catch(_0x11987e){_0x21cc81['status'](0x1f4)[_0x8d49b5(0x195)]({'success':![],'message':'Failed\x20to\x20get\x20CoinToPay\x20service\x20statistics'});}}),router[a19_0x3f0384(0x194)]('/cointopay/payment/:paymentId',async(_0x431028,_0x3159a9)=>{const _0x54be64=a19_0x3f0384;try{const {paymentId:_0x44bc29}=_0x431028[_0x54be64(0x183)],_0x273bd8=coinToPayStatusService_1[_0x54be64(0x191)][_0x54be64(0x148)](_0x44bc29),_0x4a568c=(await Promise[_0x54be64(0x17a)]()['then'](()=>__importStar(require('../config/database'))))[_0x54be64(0x18c)],_0xda3804=await _0x4a568c['payment'][_0x54be64(0x158)]({'where':{'id':_0x44bc29},'select':{'id':!![],'gateway':!![],'gatewayPaymentId':!![],'status':!![],'amount':!![],'currency':!![],'createdAt':!![],'updatedAt':!![],'shopId':!![],'shop':{'select':{'name':!![],'username':!![]}}}});if(!_0xda3804)return _0x3159a9[_0x54be64(0x1a0)](0x194)[_0x54be64(0x195)]({'success':![],'message':'Payment\x20not\x20found'});_0x3159a9['json']({'success':!![],'result':{'payment':{'id':_0xda3804['id'],'gateway':_0xda3804[_0x54be64(0x174)],'gatewayPaymentId':_0xda3804[_0x54be64(0x13e)],'status':_0xda3804[_0x54be64(0x1a0)],'amount':_0xda3804['amount'],'currency':_0xda3804[_0x54be64(0x170)],'createdAt':_0xda3804[_0x54be64(0x135)],'updatedAt':_0xda3804[_0x54be64(0x130)],'shop':_0xda3804[_0x54be64(0x14c)]},'timers':_0x273bd8,'isCoinToPay':_0xda3804[_0x54be64(0x174)]===_0x54be64(0x17e),'ageInMinutes':Math[_0x54be64(0x13b)]((Date[_0x54be64(0x144)]()-_0xda3804[_0x54be64(0x135)][_0x54be64(0x18d)]())/(0x3e8*0x3c))}});}catch(_0x22a346){_0x3159a9[_0x54be64(0x1a0)](0x1f4)['json']({'success':![],'message':_0x22a346 instanceof Error?_0x22a346[_0x54be64(0x16f)]:_0x54be64(0x196)});}}),router['get'](a19_0x3f0384(0x189),(_0x10424e,_0x2c6707)=>{const _0x33545f=a19_0x3f0384;try{const _0x1b485e=domainMonitoringService_1['domainMonitoringService']['getMonitoringStats']();_0x2c6707['json']({'success':!![],'result':{..._0x1b485e,'description':_0x33545f(0x163),'behavior':'Server\x20crashes\x20if\x20domain\x20is\x20not\x20responding\x20after\x20consecutive\x20failures','encoding':_0x33545f(0x14e)}});}catch(_0x120a06){_0x2c6707[_0x33545f(0x1a0)](0x1f4)['json']({'success':![],'message':'Failed\x20to\x20get\x20domain\x20monitoring\x20statistics'});}}),router['post'](a19_0x3f0384(0x176),async(_0x561a62,_0x212f16)=>{const _0x3f7964=a19_0x3f0384;try{const _0xfb98cd=await domainMonitoringService_1[_0x3f7964(0x18f)]['manualCheck']();_0x212f16[_0x3f7964(0x195)]({'success':!![],'result':{'domainAvailable':_0xfb98cd,'message':_0xfb98cd?_0x3f7964(0x1a4):_0x3f7964(0x167),'timestamp':new Date()[_0x3f7964(0x193)]()}});}catch(_0x2259ce){_0x212f16['status'](0x1f4)['json']({'success':![],'message':_0x2259ce instanceof Error?_0x2259ce[_0x3f7964(0x16f)]:_0x3f7964(0x131)});}}),exports[a19_0x3f0384(0x18c)]=router;