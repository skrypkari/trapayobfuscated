'use strict';const a19_0x28346d=a19_0x36f2;(function(_0xa9d9aa,_0x16ad04){const _0x2aef7d=a19_0x36f2,_0xdb049d=_0xa9d9aa();while(!![]){try{const _0x593868=parseInt(_0x2aef7d(0x195))/0x1*(parseInt(_0x2aef7d(0x20d))/0x2)+parseInt(_0x2aef7d(0x1b7))/0x3+parseInt(_0x2aef7d(0x20c))/0x4+parseInt(_0x2aef7d(0x1a2))/0x5*(-parseInt(_0x2aef7d(0x1c6))/0x6)+parseInt(_0x2aef7d(0x20e))/0x7+parseInt(_0x2aef7d(0x201))/0x8*(-parseInt(_0x2aef7d(0x1ec))/0x9)+-parseInt(_0x2aef7d(0x193))/0xa;if(_0x593868===_0x16ad04)break;else _0xdb049d['push'](_0xdb049d['shift']());}catch(_0x506c74){_0xdb049d['push'](_0xdb049d['shift']());}}}(a19_0x110a,0x3cf58));function a19_0x110a(){const _0x559f71=['../services/loggerService','getPaymentById','/statistics','Domain\x20is\x20responding\x20correctly','getMerchantsSelection','configurable','Domain\x20check\x20failed','params','PAID','../services/domainMonitoringService','delete','getPayoutStats','manualCheck','activateUser','Old\x20logs\x20cleaned\x20(kept\x20last\x20','then','/users','Requests\x20are\x20made\x20with\x20base64\x20encoded\x20URLs','8fULRwD','hasOwnProperty','floor','createPayoutSchema','Each\x20new\x20payment\x20gets\x20individual\x20timers:\x201min,\x202min,\x207min,\x2012min,\x20then\x20hourly','/payouts','\x20days\x20if\x20not\x20paid','/auth','/domain-monitoring/stats','/payments/:id/customer','createPayout','1712036cGvgwD','28432XwNPYA','1265194NOSKFn','../middleware/auth','updateUser','updateCustomerData','createdAt','post','Failed\x20to\x20get\x20log\x20statistics','5942410fcYOqK','Failed\x20to\x20get\x20domain\x20monitoring\x20statistics','32fFSQOk','now','writable','../config/database','/cointopay/payment/:paymentId','CoinToPay\x20payment\x20status\x20checked\x20successfully','length','üîç\x20[ADMIN]\x20Manual\x20CoinToPay\x20check\x20requested\x20for\x20payment:\x20','loggerService','createUserSchema','getStatistics','__importStar','../services/coinToPayStatusService','322415tNyUVh','/cointopay/stats','/users/:id/activate','Failed\x20to\x20clean\x20old\x20logs','suspendUser','/logs/stats','create','domainMonitoringService','AdminController','/payments','cointopay','/payout/merchants','log','prototype','/logs/clean','CoinToPay\x20automatic\x20status\x20checking\x20service','validate','‚ùå\x20[ADMIN]\x20Manual\x20CoinToPay\x20check\x20failed\x20for\x20payment\x20','put','express','body','483708IWYVot','findUnique','Payments\x20automatically\x20expire\x20after\x20','checkAuth','/users/:id','Failed\x20to\x20check\x20CoinToPay\x20payment\x20status','EXPIRED','getTime','__esModule','getPayments','gatewayPaymentId','deletePayout','amount','defineProperty','createUser','18RhEBUT','status','getMonitoringStats','Payment\x20not\x20found','json','message','FAILED','/payout','get','paymentId','Domain\x20monitoring\x20service\x20for\x20amaterasy884.icu','updateCustomerDataSchema','updatedAt','error','payment','checkPaymentById','gateway','Server\x20crashes\x20if\x20domain\x20is\x20not\x20responding\x20after\x20consecutive\x20failures','getMerchantsAwaitingPayout','toISOString','coinToPayStatusService','getOwnPropertyDescriptor','currency','__setModuleDefault','getLogStats','/payouts/:id','deleteUser','call','\x20days)','/payments/:id','../middleware/validation','updateUserSchema','/cointopay/check/:paymentId','Failed\x20to\x20perform\x20manual\x20domain\x20check','default','resolve','updatePayment','requireAdmin','1687689gMHHGW','/users/:id/suspend','getPayouts'];a19_0x110a=function(){return _0x559f71;};return a19_0x110a();}var __createBinding=this&&this['__createBinding']||(Object[a19_0x28346d(0x1a8)]?function(_0x2826af,_0x1d7b0e,_0x31f049,_0x2050a1){const _0x397c20=a19_0x28346d;if(_0x2050a1===undefined)_0x2050a1=_0x31f049;var _0x2d06d6=Object[_0x397c20(0x1db)](_0x1d7b0e,_0x31f049);(!_0x2d06d6||(_0x397c20(0x1ce)in _0x2d06d6?!_0x1d7b0e[_0x397c20(0x1bf)]:_0x2d06d6[_0x397c20(0x197)]||_0x2d06d6[_0x397c20(0x1f4)]))&&(_0x2d06d6={'enumerable':!![],'get':function(){return _0x1d7b0e[_0x31f049];}}),Object[_0x397c20(0x1c4)](_0x2826af,_0x2050a1,_0x2d06d6);}:function(_0x1a0291,_0x43905e,_0x2384bf,_0x437960){if(_0x437960===undefined)_0x437960=_0x2384bf;_0x1a0291[_0x437960]=_0x43905e[_0x2384bf];}),__setModuleDefault=this&&this[a19_0x28346d(0x1dd)]||(Object[a19_0x28346d(0x1a8)]?function(_0x54ef3d,_0x408ffb){const _0x197e32=a19_0x28346d;Object[_0x197e32(0x1c4)](_0x54ef3d,_0x197e32(0x1e8),{'enumerable':!![],'value':_0x408ffb});}:function(_0x595290,_0x43d4ea){const _0x54de55=a19_0x28346d;_0x595290[_0x54de55(0x1e8)]=_0x43d4ea;}),__importStar=this&&this[a19_0x28346d(0x1a0)]||(function(){var _0x31acd9=function(_0x42a814){return _0x31acd9=Object['getOwnPropertyNames']||function(_0x26868b){const _0xfe1feb=a19_0x36f2;var _0x5f36ac=[];for(var _0x31f85c in _0x26868b)if(Object[_0xfe1feb(0x1af)][_0xfe1feb(0x202)][_0xfe1feb(0x1e1)](_0x26868b,_0x31f85c))_0x5f36ac[_0x5f36ac['length']]=_0x31f85c;return _0x5f36ac;},_0x31acd9(_0x42a814);};return function(_0x4af050){const _0x5c9547=a19_0x36f2;if(_0x4af050&&_0x4af050[_0x5c9547(0x1bf)])return _0x4af050;var _0x297c7f={};if(_0x4af050!=null){for(var _0x46efcc=_0x31acd9(_0x4af050),_0x5b98ec=0x0;_0x5b98ec<_0x46efcc[_0x5c9547(0x19b)];_0x5b98ec++)if(_0x46efcc[_0x5b98ec]!==_0x5c9547(0x1e8))__createBinding(_0x297c7f,_0x4af050,_0x46efcc[_0x5b98ec]);}return __setModuleDefault(_0x297c7f,_0x4af050),_0x297c7f;};}());function a19_0x36f2(_0x2e8431,_0x43236e){const _0x110ab1=a19_0x110a();return a19_0x36f2=function(_0x36f25d,_0x12104a){_0x36f25d=_0x36f25d-0x190;let _0x5e616b=_0x110ab1[_0x36f25d];return _0x5e616b;},a19_0x36f2(_0x2e8431,_0x43236e);}Object[a19_0x28346d(0x1c4)](exports,a19_0x28346d(0x1bf),{'value':!![]});const express_1=require(a19_0x28346d(0x1b5)),adminController_1=require('../controllers/adminController'),validation_1=require(a19_0x28346d(0x1e4)),auth_1=require(a19_0x28346d(0x20f)),loggerService_1=require(a19_0x28346d(0x1ef)),coinToPayStatusService_1=require(a19_0x28346d(0x1a1)),domainMonitoringService_1=require(a19_0x28346d(0x1f8)),router=(0x0,express_1['Router'])(),adminController=new adminController_1[(a19_0x28346d(0x1aa))]();router['use'](auth_1['authenticateToken'],auth_1[a19_0x28346d(0x1eb)]),router[a19_0x28346d(0x1ce)](a19_0x28346d(0x208),adminController[a19_0x28346d(0x1ba)]),router['get'](a19_0x28346d(0x1f1),adminController[a19_0x28346d(0x19f)]),router[a19_0x28346d(0x1ce)]('/merchant-statistics',adminController['getMerchantStatistics']),router[a19_0x28346d(0x1ce)]('/payout/stats',adminController[a19_0x28346d(0x1fa)]),router['get'](a19_0x28346d(0x1ad),adminController[a19_0x28346d(0x1d8)]),router[a19_0x28346d(0x1ce)]('/merchants/selection',adminController[a19_0x28346d(0x1f3)]),router[a19_0x28346d(0x191)](a19_0x28346d(0x1cd),(0x0,validation_1[a19_0x28346d(0x1b2)])(validation_1[a19_0x28346d(0x204)]),adminController[a19_0x28346d(0x20b)]),router[a19_0x28346d(0x1ce)](a19_0x28346d(0x206),adminController[a19_0x28346d(0x1ee)]),router['get'](a19_0x28346d(0x1df),adminController['getPayoutById']),router[a19_0x28346d(0x1f9)]('/payouts/:id',adminController[a19_0x28346d(0x1c2)]),router[a19_0x28346d(0x1ce)](a19_0x28346d(0x1ab),adminController[a19_0x28346d(0x1c0)]),router[a19_0x28346d(0x1ce)](a19_0x28346d(0x1e3),adminController[a19_0x28346d(0x1f0)]),router[a19_0x28346d(0x1b4)](a19_0x28346d(0x1e3),adminController[a19_0x28346d(0x1ea)]),router[a19_0x28346d(0x1b4)](a19_0x28346d(0x20a),(0x0,validation_1[a19_0x28346d(0x1b2)])(validation_1[a19_0x28346d(0x1d1)]),adminController[a19_0x28346d(0x211)]),router[a19_0x28346d(0x1ce)](a19_0x28346d(0x1ff),adminController['getUsers']),router[a19_0x28346d(0x1ce)]('/users/:id',adminController['getUserById']),router[a19_0x28346d(0x191)]('/users',(0x0,validation_1[a19_0x28346d(0x1b2)])(validation_1[a19_0x28346d(0x19e)]),adminController[a19_0x28346d(0x1c5)]),router[a19_0x28346d(0x1b4)]('/users/:id',(0x0,validation_1[a19_0x28346d(0x1b2)])(validation_1[a19_0x28346d(0x1e5)]),adminController[a19_0x28346d(0x210)]),router[a19_0x28346d(0x1f9)](a19_0x28346d(0x1bb),adminController[a19_0x28346d(0x1e0)]),router['post'](a19_0x28346d(0x1ed),adminController[a19_0x28346d(0x1a6)]),router['post'](a19_0x28346d(0x1a4),adminController[a19_0x28346d(0x1fc)]),router[a19_0x28346d(0x1ce)](a19_0x28346d(0x1a7),(_0x500069,_0x5a519f)=>{const _0x420040=a19_0x28346d;try{const _0x428d79=loggerService_1[_0x420040(0x19d)][_0x420040(0x1de)]();_0x5a519f['json']({'success':!![],'result':_0x428d79});}catch(_0x1a505f){_0x5a519f[_0x420040(0x1c7)](0x1f4)['json']({'success':![],'message':_0x420040(0x192)});}}),router['post'](a19_0x28346d(0x1b0),(_0x37eadd,_0x5402aa)=>{const _0x30cfe7=a19_0x28346d;try{const {daysToKeep:daysToKeep=0x1e}=_0x37eadd[_0x30cfe7(0x1b6)];loggerService_1[_0x30cfe7(0x19d)]['cleanOldLogs'](daysToKeep),_0x5402aa[_0x30cfe7(0x1ca)]({'success':!![],'message':_0x30cfe7(0x1fd)+daysToKeep+_0x30cfe7(0x1e2)});}catch(_0x767b91){_0x5402aa[_0x30cfe7(0x1c7)](0x1f4)[_0x30cfe7(0x1ca)]({'success':![],'message':_0x30cfe7(0x1a5)});}}),router[a19_0x28346d(0x191)](a19_0x28346d(0x1e6),async(_0x2d7991,_0x1db173)=>{const _0x56cb2=a19_0x28346d;try{const {paymentId:_0x4226ee}=_0x2d7991['params'];console[_0x56cb2(0x1ae)](_0x56cb2(0x19c)+_0x4226ee),await coinToPayStatusService_1[_0x56cb2(0x1da)][_0x56cb2(0x1d5)](_0x4226ee),_0x1db173[_0x56cb2(0x1ca)]({'success':!![],'message':_0x56cb2(0x19a)});}catch(_0x2ede5e){console[_0x56cb2(0x1d3)](_0x56cb2(0x1b3)+_0x2d7991[_0x56cb2(0x1f6)][_0x56cb2(0x1cf)]+':',_0x2ede5e),_0x1db173['status'](0x1f4)[_0x56cb2(0x1ca)]({'success':![],'message':_0x2ede5e instanceof Error?_0x2ede5e['message']:_0x56cb2(0x1bc)});}}),router[a19_0x28346d(0x1ce)](a19_0x28346d(0x1a3),(_0x46a4e2,_0x2f5cfa)=>{const _0x16a826=a19_0x28346d;try{const _0x13ec54=coinToPayStatusService_1['coinToPayStatusService']['getServiceStats']();_0x2f5cfa['json']({'success':!![],'result':{..._0x13ec54,'description':_0x16a826(0x1b1),'statusMapping':{'Paid':_0x16a826(0x1f7),'Awaiting\x20Fiat':'PENDING','waiting':'PENDING','expired':_0x16a826(0x1bd),'failed':_0x16a826(0x1cc)},'autoExpiryNote':_0x16a826(0x1b9)+_0x13ec54['expiryDays']+_0x16a826(0x207),'individualTimersNote':_0x16a826(0x205)}});}catch(_0x4ab84b){_0x2f5cfa[_0x16a826(0x1c7)](0x1f4)[_0x16a826(0x1ca)]({'success':![],'message':'Failed\x20to\x20get\x20CoinToPay\x20service\x20statistics'});}}),router['get'](a19_0x28346d(0x199),async(_0xdb7cd8,_0xf7a439)=>{const _0x4cda4b=a19_0x28346d;try{const {paymentId:_0x430cd8}=_0xdb7cd8['params'],_0x321991=coinToPayStatusService_1[_0x4cda4b(0x1da)]['getPaymentTimerInfo'](_0x430cd8),_0x1e448f=(await Promise[_0x4cda4b(0x1e9)]()[_0x4cda4b(0x1fe)](()=>__importStar(require(_0x4cda4b(0x198)))))[_0x4cda4b(0x1e8)],_0x46bd52=await _0x1e448f[_0x4cda4b(0x1d4)][_0x4cda4b(0x1b8)]({'where':{'id':_0x430cd8},'select':{'id':!![],'gateway':!![],'gatewayPaymentId':!![],'status':!![],'amount':!![],'currency':!![],'createdAt':!![],'updatedAt':!![],'shopId':!![],'shop':{'select':{'name':!![],'username':!![]}}}});if(!_0x46bd52)return _0xf7a439[_0x4cda4b(0x1c7)](0x194)[_0x4cda4b(0x1ca)]({'success':![],'message':_0x4cda4b(0x1c9)});_0xf7a439['json']({'success':!![],'result':{'payment':{'id':_0x46bd52['id'],'gateway':_0x46bd52[_0x4cda4b(0x1d6)],'gatewayPaymentId':_0x46bd52[_0x4cda4b(0x1c1)],'status':_0x46bd52[_0x4cda4b(0x1c7)],'amount':_0x46bd52[_0x4cda4b(0x1c3)],'currency':_0x46bd52[_0x4cda4b(0x1dc)],'createdAt':_0x46bd52['createdAt'],'updatedAt':_0x46bd52[_0x4cda4b(0x1d2)],'shop':_0x46bd52['shop']},'timers':_0x321991,'isCoinToPay':_0x46bd52[_0x4cda4b(0x1d6)]===_0x4cda4b(0x1ac),'ageInMinutes':Math[_0x4cda4b(0x203)]((Date[_0x4cda4b(0x196)]()-_0x46bd52[_0x4cda4b(0x190)][_0x4cda4b(0x1be)]())/(0x3e8*0x3c))}});}catch(_0x319461){_0xf7a439[_0x4cda4b(0x1c7)](0x1f4)['json']({'success':![],'message':_0x319461 instanceof Error?_0x319461[_0x4cda4b(0x1cb)]:'Failed\x20to\x20get\x20payment\x20information'});}}),router['get'](a19_0x28346d(0x209),(_0x3df041,_0x3bdfcd)=>{const _0x234fb4=a19_0x28346d;try{const _0x149be2=domainMonitoringService_1[_0x234fb4(0x1a9)][_0x234fb4(0x1c8)]();_0x3bdfcd[_0x234fb4(0x1ca)]({'success':!![],'result':{..._0x149be2,'description':_0x234fb4(0x1d0),'behavior':_0x234fb4(0x1d7),'encoding':_0x234fb4(0x200)}});}catch(_0x3d5f2d){_0x3bdfcd[_0x234fb4(0x1c7)](0x1f4)[_0x234fb4(0x1ca)]({'success':![],'message':_0x234fb4(0x194)});}}),router['post']('/domain-monitoring/check',async(_0x131594,_0x378dfd)=>{const _0x348c19=a19_0x28346d;try{const _0x3479bc=await domainMonitoringService_1['domainMonitoringService'][_0x348c19(0x1fb)]();_0x378dfd['json']({'success':!![],'result':{'domainAvailable':_0x3479bc,'message':_0x3479bc?_0x348c19(0x1f2):_0x348c19(0x1f5),'timestamp':new Date()[_0x348c19(0x1d9)]()}});}catch(_0x318518){_0x378dfd[_0x348c19(0x1c7)](0x1f4)[_0x348c19(0x1ca)]({'success':![],'message':_0x318518 instanceof Error?_0x318518[_0x348c19(0x1cb)]:_0x348c19(0x1e7)});}}),exports['default']=router;