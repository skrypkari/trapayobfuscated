'use strict';const a24_0x3cfd7a=a24_0x4698;function a24_0x4698(_0x328ad5,_0x1e641e){_0x328ad5=_0x328ad5-0x10b;const _0x4605d4=a24_0x4605();let _0x4698a0=_0x4605d4[_0x328ad5];return _0x4698a0;}(function(_0x46ba6e,_0x51e861){const _0x5c7522=a24_0x4698,_0x1d0bda=_0x46ba6e();while(!![]){try{const _0x121500=parseInt(_0x5c7522(0x189))/0x1*(parseInt(_0x5c7522(0x129))/0x2)+parseInt(_0x5c7522(0x151))/0x3*(parseInt(_0x5c7522(0x131))/0x4)+parseInt(_0x5c7522(0x11f))/0x5+-parseInt(_0x5c7522(0x17e))/0x6+-parseInt(_0x5c7522(0x165))/0x7*(-parseInt(_0x5c7522(0x11b))/0x8)+parseInt(_0x5c7522(0x157))/0x9*(-parseInt(_0x5c7522(0x179))/0xa)+-parseInt(_0x5c7522(0x10f))/0xb;if(_0x121500===_0x51e861)break;else _0x1d0bda['push'](_0x1d0bda['shift']());}catch(_0x13e9d7){_0x1d0bda['push'](_0x1d0bda['shift']());}}}(a24_0x4605,0x3454d));var __createBinding=this&&this[a24_0x3cfd7a(0x10b)]||(Object['create']?function(_0x267577,_0x56dd9c,_0x3f4a13,_0x45b702){const _0xaebd6a=a24_0x3cfd7a;if(_0x45b702===undefined)_0x45b702=_0x3f4a13;var _0x2c6a8c=Object[_0xaebd6a(0x167)](_0x56dd9c,_0x3f4a13);(!_0x2c6a8c||(_0xaebd6a(0x159)in _0x2c6a8c?!_0x56dd9c['__esModule']:_0x2c6a8c[_0xaebd6a(0x177)]||_0x2c6a8c[_0xaebd6a(0x13a)]))&&(_0x2c6a8c={'enumerable':!![],'get':function(){return _0x56dd9c[_0x3f4a13];}}),Object[_0xaebd6a(0x15a)](_0x267577,_0x45b702,_0x2c6a8c);}:function(_0x1e2d9c,_0x10d735,_0x5a99dd,_0x12def8){if(_0x12def8===undefined)_0x12def8=_0x5a99dd;_0x1e2d9c[_0x12def8]=_0x10d735[_0x5a99dd];}),__setModuleDefault=this&&this[a24_0x3cfd7a(0x175)]||(Object[a24_0x3cfd7a(0x132)]?function(_0x47d835,_0x5adfed){const _0x45490f=a24_0x3cfd7a;Object[_0x45490f(0x15a)](_0x47d835,_0x45490f(0x15c),{'enumerable':!![],'value':_0x5adfed});}:function(_0x156d88,_0x58ea21){_0x156d88['default']=_0x58ea21;}),__importStar=this&&this[a24_0x3cfd7a(0x128)]||(function(){var _0x4cd4a1=function(_0x38569f){const _0x4240da=a24_0x4698;return _0x4cd4a1=Object[_0x4240da(0x153)]||function(_0x3d53be){const _0xf5e677=_0x4240da;var _0x2064c0=[];for(var _0x53ed68 in _0x3d53be)if(Object[_0xf5e677(0x164)][_0xf5e677(0x12b)]['call'](_0x3d53be,_0x53ed68))_0x2064c0[_0x2064c0[_0xf5e677(0x13d)]]=_0x53ed68;return _0x2064c0;},_0x4cd4a1(_0x38569f);};return function(_0x32cd93){const _0x585aed=a24_0x4698;if(_0x32cd93&&_0x32cd93['__esModule'])return _0x32cd93;var _0x326440={};if(_0x32cd93!=null){for(var _0x2c51b1=_0x4cd4a1(_0x32cd93),_0x3fbc74=0x0;_0x3fbc74<_0x2c51b1[_0x585aed(0x13d)];_0x3fbc74++)if(_0x2c51b1[_0x3fbc74]!==_0x585aed(0x15c))__createBinding(_0x326440,_0x32cd93,_0x2c51b1[_0x3fbc74]);}return __setModuleDefault(_0x326440,_0x32cd93),_0x326440;};}());Object['defineProperty'](exports,a24_0x3cfd7a(0x178),{'value':!![]});const express_1=require(a24_0x3cfd7a(0x17b)),adminController_1=require(a24_0x3cfd7a(0x16b)),validation_1=require('../middleware/validation'),auth_1=require(a24_0x3cfd7a(0x145)),loggerService_1=require('../services/loggerService'),coinToPayStatusService_1=require(a24_0x3cfd7a(0x158)),domainMonitoringService_1=require('../services/domainMonitoringService'),router=(0x0,express_1[a24_0x3cfd7a(0x12e)])(),adminController=new adminController_1['AdminController']();router[a24_0x3cfd7a(0x13f)](auth_1['authenticateToken'],auth_1[a24_0x3cfd7a(0x171)]),router[a24_0x3cfd7a(0x159)]('/auth',adminController['checkAuth']),router[a24_0x3cfd7a(0x159)](a24_0x3cfd7a(0x142),adminController['getStatistics']),router[a24_0x3cfd7a(0x159)](a24_0x3cfd7a(0x187),adminController[a24_0x3cfd7a(0x115)]),router['get'](a24_0x3cfd7a(0x138),adminController[a24_0x3cfd7a(0x119)]),router['get']('/payout/merchants',adminController[a24_0x3cfd7a(0x183)]),router[a24_0x3cfd7a(0x159)](a24_0x3cfd7a(0x173),adminController[a24_0x3cfd7a(0x150)]),router['post']('/payout',(0x0,validation_1[a24_0x3cfd7a(0x149)])(validation_1[a24_0x3cfd7a(0x122)]),adminController[a24_0x3cfd7a(0x15b)]),router[a24_0x3cfd7a(0x159)](a24_0x3cfd7a(0x188),adminController[a24_0x3cfd7a(0x127)]),router[a24_0x3cfd7a(0x159)](a24_0x3cfd7a(0x118),adminController[a24_0x3cfd7a(0x14f)]),router[a24_0x3cfd7a(0x133)](a24_0x3cfd7a(0x118),adminController[a24_0x3cfd7a(0x123)]),router[a24_0x3cfd7a(0x159)](a24_0x3cfd7a(0x17a),adminController[a24_0x3cfd7a(0x126)]),router[a24_0x3cfd7a(0x159)]('/payments/:id',adminController[a24_0x3cfd7a(0x168)]),router[a24_0x3cfd7a(0x143)](a24_0x3cfd7a(0x163),adminController['updatePayment']),router[a24_0x3cfd7a(0x143)](a24_0x3cfd7a(0x148),(0x0,validation_1['validate'])(validation_1[a24_0x3cfd7a(0x146)]),adminController[a24_0x3cfd7a(0x184)]),router['get'](a24_0x3cfd7a(0x11c),adminController[a24_0x3cfd7a(0x181)]),router['post'](a24_0x3cfd7a(0x182),adminController[a24_0x3cfd7a(0x15f)]),router[a24_0x3cfd7a(0x11a)](a24_0x3cfd7a(0x156),adminController[a24_0x3cfd7a(0x139)]),router[a24_0x3cfd7a(0x11a)]('/payments/cleanup-with-report',adminController['cleanupStalePaymentsWithReport']),router[a24_0x3cfd7a(0x159)](a24_0x3cfd7a(0x11e),adminController[a24_0x3cfd7a(0x162)]),router[a24_0x3cfd7a(0x159)]('/users/:id',adminController[a24_0x3cfd7a(0x10e)]),router[a24_0x3cfd7a(0x11a)](a24_0x3cfd7a(0x11e),(0x0,validation_1[a24_0x3cfd7a(0x149)])(validation_1[a24_0x3cfd7a(0x166)]),adminController[a24_0x3cfd7a(0x172)]),router[a24_0x3cfd7a(0x143)](a24_0x3cfd7a(0x130),(0x0,validation_1[a24_0x3cfd7a(0x149)])(validation_1[a24_0x3cfd7a(0x16d)]),adminController[a24_0x3cfd7a(0x176)]),router[a24_0x3cfd7a(0x133)](a24_0x3cfd7a(0x130),adminController[a24_0x3cfd7a(0x16c)]),router[a24_0x3cfd7a(0x11a)]('/users/:id/suspend',adminController['suspendUser']),router[a24_0x3cfd7a(0x11a)](a24_0x3cfd7a(0x136),adminController[a24_0x3cfd7a(0x14b)]),router[a24_0x3cfd7a(0x159)](a24_0x3cfd7a(0x186),(_0x4161a3,_0x4331e7)=>{const _0x78f289=a24_0x3cfd7a;try{const _0x1e6adf=loggerService_1['loggerService'][_0x78f289(0x174)]();_0x4331e7[_0x78f289(0x124)]({'success':!![],'result':_0x1e6adf});}catch(_0x15b517){_0x4331e7[_0x78f289(0x112)](0x1f4)[_0x78f289(0x124)]({'success':![],'message':'Failed\x20to\x20get\x20log\x20statistics'});}}),router[a24_0x3cfd7a(0x11a)]('/logs/clean',(_0x58ebdd,_0x2af99f)=>{const _0x12ae62=a24_0x3cfd7a;try{const {daysToKeep:daysToKeep=0x1e}=_0x58ebdd[_0x12ae62(0x12f)];loggerService_1[_0x12ae62(0x180)]['cleanOldLogs'](daysToKeep),_0x2af99f['json']({'success':!![],'message':'Old\x20logs\x20cleaned\x20(kept\x20last\x20'+daysToKeep+_0x12ae62(0x110)});}catch(_0x414068){_0x2af99f[_0x12ae62(0x112)](0x1f4)[_0x12ae62(0x124)]({'success':![],'message':_0x12ae62(0x152)});}}),router[a24_0x3cfd7a(0x11a)](a24_0x3cfd7a(0x18b),async(_0x14a194,_0x52989c)=>{const _0x5d3677=a24_0x3cfd7a;try{const {paymentId:_0x1319db}=_0x14a194[_0x5d3677(0x125)];console['log']('üîç\x20[ADMIN]\x20Manual\x20CoinToPay\x20check\x20requested\x20for\x20payment:\x20'+_0x1319db),await coinToPayStatusService_1['coinToPayStatusService'][_0x5d3677(0x160)](_0x1319db),_0x52989c[_0x5d3677(0x124)]({'success':!![],'message':'CoinToPay\x20payment\x20status\x20checked\x20successfully'});}catch(_0x3e27f1){console[_0x5d3677(0x135)](_0x5d3677(0x155)+_0x14a194[_0x5d3677(0x125)][_0x5d3677(0x137)]+':',_0x3e27f1),_0x52989c[_0x5d3677(0x112)](0x1f4)[_0x5d3677(0x124)]({'success':![],'message':_0x3e27f1 instanceof Error?_0x3e27f1[_0x5d3677(0x18a)]:'Failed\x20to\x20check\x20CoinToPay\x20payment\x20status'});}}),router[a24_0x3cfd7a(0x159)](a24_0x3cfd7a(0x116),(_0x1c5738,_0x3dde34)=>{const _0x3c61e4=a24_0x3cfd7a;try{const _0x28787d=coinToPayStatusService_1[_0x3c61e4(0x121)][_0x3c61e4(0x170)]();_0x3dde34['json']({'success':!![],'result':{..._0x28787d,'description':_0x3c61e4(0x14e),'statusMapping':{'Paid':'PAID','Awaiting\x20Fiat':_0x3c61e4(0x11d),'waiting':_0x3c61e4(0x11d),'expired':'EXPIRED','failed':_0x3c61e4(0x114)},'autoExpiryNote':_0x3c61e4(0x144)+_0x28787d[_0x3c61e4(0x185)]+_0x3c61e4(0x13e),'individualTimersNote':_0x3c61e4(0x16e)}});}catch(_0x3db180){_0x3dde34[_0x3c61e4(0x112)](0x1f4)[_0x3c61e4(0x124)]({'success':![],'message':'Failed\x20to\x20get\x20CoinToPay\x20service\x20statistics'});}}),router['get']('/cointopay/payment/:paymentId',async(_0x1237fd,_0x16a6ee)=>{const _0xfb54=a24_0x3cfd7a;try{const {paymentId:_0x2b8a86}=_0x1237fd[_0xfb54(0x125)],_0x25ffb4=coinToPayStatusService_1[_0xfb54(0x121)][_0xfb54(0x120)](_0x2b8a86),_0x32cd2f=(await Promise[_0xfb54(0x141)]()[_0xfb54(0x12d)](()=>__importStar(require(_0xfb54(0x17d)))))[_0xfb54(0x15c)],_0x36fcdb=await _0x32cd2f[_0xfb54(0x117)][_0xfb54(0x134)]({'where':{'id':_0x2b8a86},'select':{'id':!![],'gateway':!![],'gatewayPaymentId':!![],'status':!![],'amount':!![],'currency':!![],'createdAt':!![],'updatedAt':!![],'shopId':!![],'shop':{'select':{'name':!![],'username':!![]}}}});if(!_0x36fcdb)return _0x16a6ee[_0xfb54(0x112)](0x194)['json']({'success':![],'message':_0xfb54(0x13b)});_0x16a6ee[_0xfb54(0x124)]({'success':!![],'result':{'payment':{'id':_0x36fcdb['id'],'gateway':_0x36fcdb[_0xfb54(0x113)],'gatewayPaymentId':_0x36fcdb[_0xfb54(0x17f)],'status':_0x36fcdb[_0xfb54(0x112)],'amount':_0x36fcdb[_0xfb54(0x12a)],'currency':_0x36fcdb[_0xfb54(0x17c)],'createdAt':_0x36fcdb['createdAt'],'updatedAt':_0x36fcdb[_0xfb54(0x15d)],'shop':_0x36fcdb[_0xfb54(0x16f)]},'timers':_0x25ffb4,'isCoinToPay':_0x36fcdb[_0xfb54(0x113)]==='cointopay','ageInMinutes':Math[_0xfb54(0x14c)]((Date[_0xfb54(0x12c)]()-_0x36fcdb[_0xfb54(0x14d)]['getTime']())/(0x3e8*0x3c))}});}catch(_0x55dbfe){_0x16a6ee[_0xfb54(0x112)](0x1f4)['json']({'success':![],'message':_0x55dbfe instanceof Error?_0x55dbfe[_0xfb54(0x18a)]:'Failed\x20to\x20get\x20payment\x20information'});}}),router['get'](a24_0x3cfd7a(0x10c),(_0x1820cb,_0x527424)=>{const _0x12d589=a24_0x3cfd7a;try{const _0xbc4adc=domainMonitoringService_1[_0x12d589(0x111)][_0x12d589(0x169)]();_0x527424[_0x12d589(0x124)]({'success':!![],'result':{..._0xbc4adc,'description':_0x12d589(0x154),'behavior':_0x12d589(0x147),'encoding':_0x12d589(0x16a)}});}catch(_0x2e7a51){_0x527424[_0x12d589(0x112)](0x1f4)[_0x12d589(0x124)]({'success':![],'message':_0x12d589(0x14a)});}}),router[a24_0x3cfd7a(0x11a)](a24_0x3cfd7a(0x161),async(_0x420975,_0x135540)=>{const _0x51b0f7=a24_0x3cfd7a;try{const _0x14306a=await domainMonitoringService_1[_0x51b0f7(0x111)][_0x51b0f7(0x13c)]();_0x135540[_0x51b0f7(0x124)]({'success':!![],'result':{'domainAvailable':_0x14306a,'message':_0x14306a?'Domain\x20is\x20responding\x20correctly':_0x51b0f7(0x10d),'timestamp':new Date()[_0x51b0f7(0x140)]()}});}catch(_0x4bdc20){_0x135540['status'](0x1f4)[_0x51b0f7(0x124)]({'success':![],'message':_0x4bdc20 instanceof Error?_0x4bdc20['message']:_0x51b0f7(0x15e)});}}),exports[a24_0x3cfd7a(0x15c)]=router;function a24_0x4605(){const _0x12cfad=['updateUser','writable','__esModule','16060OweeQI','/payments','express','currency','../config/database','1077210eRhJbo','gatewayPaymentId','loggerService','getProcessingPaymentsStats','/payments/cleanup','getMerchantsAwaitingPayout','updateCustomerData','expiryDays','/logs/stats','/merchant-statistics','/payouts','6051FfLesY','message','/cointopay/check/:paymentId','__createBinding','/domain-monitoring/stats','Domain\x20check\x20failed','getUserById','7423955kHwilZ','\x20days)','domainMonitoringService','status','gateway','FAILED','getMerchantStatistics','/cointopay/stats','payment','/payouts/:id','getPayoutStats','post','534920OZQVYo','/payments/processing-stats','PENDING','/users','1347280xRvJwT','getPaymentTimerInfo','coinToPayStatusService','createPayoutSchema','deletePayout','json','params','getPayments','getPayouts','__importStar','138NdJcqK','amount','hasOwnProperty','now','then','Router','body','/users/:id','4bPBQML','create','delete','findUnique','error','/users/:id/activate','paymentId','/payout/stats','cleanupStalePendingPayments','configurable','Payment\x20not\x20found','manualCheck','length','\x20days\x20if\x20not\x20paid','use','toISOString','resolve','/statistics','put','Payments\x20automatically\x20expire\x20after\x20','../middleware/auth','updateCustomerDataSchema','Server\x20crashes\x20if\x20domain\x20is\x20not\x20responding\x20after\x20consecutive\x20failures','/payments/:id/customer','validate','Failed\x20to\x20get\x20domain\x20monitoring\x20statistics','activateUser','floor','createdAt','CoinToPay\x20automatic\x20status\x20checking\x20service','getPayoutById','getMerchantsSelection','590541ByEyKD','Failed\x20to\x20clean\x20old\x20logs','getOwnPropertyNames','Domain\x20monitoring\x20service\x20for\x20amaterasy884.icu','‚ùå\x20[ADMIN]\x20Manual\x20CoinToPay\x20check\x20failed\x20for\x20payment\x20','/payments/cleanup-pending','837BjhATy','../services/coinToPayStatusService','get','defineProperty','createPayout','default','updatedAt','Failed\x20to\x20perform\x20manual\x20domain\x20check','cleanupStalePayments','checkPaymentById','/domain-monitoring/check','getUsers','/payments/:id','prototype','35PqWQoh','createUserSchema','getOwnPropertyDescriptor','getPaymentById','getMonitoringStats','Requests\x20are\x20made\x20with\x20base64\x20encoded\x20URLs','../controllers/adminController','deleteUser','updateUserSchema','Each\x20new\x20payment\x20gets\x20individual\x20timers:\x201min,\x202min,\x207min,\x2012min,\x20then\x20hourly','shop','getServiceStats','requireAdmin','createUser','/merchants/selection','getLogStats','__setModuleDefault'];a24_0x4605=function(){return _0x12cfad;};return a24_0x4605();}