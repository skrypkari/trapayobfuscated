'use strict';function a20_0x4ba5(_0x4c9a18,_0x929098){const _0x40ead9=a20_0x40ea();return a20_0x4ba5=function(_0x4ba515,_0x55921e){_0x4ba515=_0x4ba515-0x194;let _0x2a93f7=_0x40ead9[_0x4ba515];return _0x2a93f7;},a20_0x4ba5(_0x4c9a18,_0x929098);}const a20_0x177b5a=a20_0x4ba5;(function(_0x2b6c3f,_0x16bccc){const _0x586bb9=a20_0x4ba5,_0x4dde2f=_0x2b6c3f();while(!![]){try{const _0x5d4ddd=-parseInt(_0x586bb9(0x195))/0x1+-parseInt(_0x586bb9(0x1fa))/0x2*(parseInt(_0x586bb9(0x1b8))/0x3)+parseInt(_0x586bb9(0x1f3))/0x4+parseInt(_0x586bb9(0x1ab))/0x5+parseInt(_0x586bb9(0x1e2))/0x6+-parseInt(_0x586bb9(0x1b6))/0x7*(-parseInt(_0x586bb9(0x1d8))/0x8)+-parseInt(_0x586bb9(0x196))/0x9*(-parseInt(_0x586bb9(0x1c1))/0xa);if(_0x5d4ddd===_0x16bccc)break;else _0x4dde2f['push'](_0x4dde2f['shift']());}catch(_0x4fd281){_0x4dde2f['push'](_0x4dde2f['shift']());}}}(a20_0x40ea,0x4b293));var __createBinding=this&&this[a20_0x177b5a(0x1c7)]||(Object[a20_0x177b5a(0x1b4)]?function(_0x2cd722,_0x2f4fc6,_0x110326,_0x3cedaa){const _0x3f9f93=a20_0x177b5a;if(_0x3cedaa===undefined)_0x3cedaa=_0x110326;var _0xe4dffd=Object[_0x3f9f93(0x202)](_0x2f4fc6,_0x110326);(!_0xe4dffd||(_0x3f9f93(0x1c4)in _0xe4dffd?!_0x2f4fc6[_0x3f9f93(0x1ce)]:_0xe4dffd['writable']||_0xe4dffd['configurable']))&&(_0xe4dffd={'enumerable':!![],'get':function(){return _0x2f4fc6[_0x110326];}}),Object['defineProperty'](_0x2cd722,_0x3cedaa,_0xe4dffd);}:function(_0x40f7d1,_0x25322c,_0x4f3992,_0x49ce1d){if(_0x49ce1d===undefined)_0x49ce1d=_0x4f3992;_0x40f7d1[_0x49ce1d]=_0x25322c[_0x4f3992];}),__setModuleDefault=this&&this[a20_0x177b5a(0x1ae)]||(Object[a20_0x177b5a(0x1b4)]?function(_0x30782e,_0x518720){const _0x3e85cc=a20_0x177b5a;Object[_0x3e85cc(0x1e5)](_0x30782e,_0x3e85cc(0x198),{'enumerable':!![],'value':_0x518720});}:function(_0x53d2e0,_0x5688d5){const _0x28292b=a20_0x177b5a;_0x53d2e0[_0x28292b(0x198)]=_0x5688d5;}),__importStar=this&&this[a20_0x177b5a(0x20a)]||(function(){var _0x13712c=function(_0x54a71b){return _0x13712c=Object['getOwnPropertyNames']||function(_0x456a03){const _0x1dcdbe=a20_0x4ba5;var _0x327eb9=[];for(var _0x5793de in _0x456a03)if(Object['prototype'][_0x1dcdbe(0x1a7)][_0x1dcdbe(0x1ff)](_0x456a03,_0x5793de))_0x327eb9[_0x327eb9['length']]=_0x5793de;return _0x327eb9;},_0x13712c(_0x54a71b);};return function(_0x3543b6){const _0x2d043c=a20_0x4ba5;if(_0x3543b6&&_0x3543b6['__esModule'])return _0x3543b6;var _0x3d087c={};if(_0x3543b6!=null){for(var _0x18f082=_0x13712c(_0x3543b6),_0x15f2ce=0x0;_0x15f2ce<_0x18f082[_0x2d043c(0x1f9)];_0x15f2ce++)if(_0x18f082[_0x15f2ce]!==_0x2d043c(0x198))__createBinding(_0x3d087c,_0x3543b6,_0x18f082[_0x15f2ce]);}return __setModuleDefault(_0x3d087c,_0x3543b6),_0x3d087c;};}());function a20_0x40ea(){const _0x18c2f6=['loggerService','cointopay','Failed\x20to\x20get\x20CoinToPay\x20service\x20statistics','length','10bAOFGb','/merchant-statistics','params','updatePayment','log','call','getServiceStats','status','getOwnPropertyDescriptor','❌\x20[ADMIN]\x20Manual\x20CoinToPay\x20check\x20failed\x20for\x20payment\x20','Old\x20logs\x20cleaned\x20(kept\x20last\x20','createdAt','\x20days\x20if\x20not\x20paid','createPayoutSchema','express','getMerchantStatistics','__importStar','getPayoutById','expiryDays','getPayouts','313585uFzEXr','90RTDbKq','domainMonitoringService','default','/payouts/:id','Server\x20crashes\x20if\x20domain\x20is\x20not\x20responding\x20after\x20consecutive\x20failures','Requests\x20are\x20made\x20with\x20base64\x20encoded\x20URLs','resolve','checkPaymentById','payment','validate','getMerchantsAwaitingPayout','currency','error','updateCustomerData','../services/loggerService','../config/database','CoinToPay\x20automatic\x20status\x20checking\x20service','hasOwnProperty','/users','/statistics','Payments\x20automatically\x20expire\x20after\x20','1657380qonTPa','then','PAID','__setModuleDefault','delete','../services/domainMonitoringService','updateUserSchema','Failed\x20to\x20get\x20domain\x20monitoring\x20statistics','getPaymentTimerInfo','create','getTime','13055oXvkZs','/cointopay/check/:paymentId','76242vmwobU','gateway','/users/:id','/payments','getStatistics','FAILED','../services/coinToPayStatusService','use','/payments/:id','142150dZTrpk','now','CoinToPay\x20payment\x20status\x20checked\x20successfully','get','/merchants/selection','manualCheck','__createBinding','updateUser','suspendUser','gatewayPaymentId','createPayout','AdminController','getMerchantsSelection','__esModule','/payout/merchants','PENDING','\x20days)','createUserSchema','checkAuth','put','/cointopay/payment/:paymentId','json','EXPIRED','328iEWIhd','/payments/:id/customer','/domain-monitoring/stats','getUserById','/payout/stats','Payment\x20not\x20found','/domain-monitoring/check','coinToPayStatusService','shop','message','95142fgaEmn','authenticateToken','../middleware/auth','defineProperty','post','paymentId','body','Domain\x20is\x20responding\x20correctly','amount','getMonitoringStats','Failed\x20to\x20get\x20payment\x20information','Router','Failed\x20to\x20check\x20CoinToPay\x20payment\x20status','Failed\x20to\x20clean\x20old\x20logs','getPaymentById','activateUser','deleteUser','730264fuBqhH','/auth','🔍\x20[ADMIN]\x20Manual\x20CoinToPay\x20check\x20requested\x20for\x20payment:\x20'];a20_0x40ea=function(){return _0x18c2f6;};return a20_0x40ea();}Object[a20_0x177b5a(0x1e5)](exports,a20_0x177b5a(0x1ce),{'value':!![]});const express_1=require(a20_0x177b5a(0x208)),adminController_1=require('../controllers/adminController'),validation_1=require('../middleware/validation'),auth_1=require(a20_0x177b5a(0x1e4)),loggerService_1=require(a20_0x177b5a(0x1a4)),coinToPayStatusService_1=require(a20_0x177b5a(0x1be)),domainMonitoringService_1=require(a20_0x177b5a(0x1b0)),router=(0x0,express_1[a20_0x177b5a(0x1ed)])(),adminController=new adminController_1[(a20_0x177b5a(0x1cc))]();router[a20_0x177b5a(0x1bf)](auth_1[a20_0x177b5a(0x1e3)],auth_1['requireAdmin']),router[a20_0x177b5a(0x1c4)](a20_0x177b5a(0x1f4),adminController[a20_0x177b5a(0x1d3)]),router[a20_0x177b5a(0x1c4)](a20_0x177b5a(0x1a9),adminController[a20_0x177b5a(0x1bc)]),router[a20_0x177b5a(0x1c4)](a20_0x177b5a(0x1fb),adminController[a20_0x177b5a(0x209)]),router['get'](a20_0x177b5a(0x1dc),adminController['getPayoutStats']),router[a20_0x177b5a(0x1c4)](a20_0x177b5a(0x1cf),adminController[a20_0x177b5a(0x1a0)]),router[a20_0x177b5a(0x1c4)](a20_0x177b5a(0x1c5),adminController[a20_0x177b5a(0x1cd)]),router[a20_0x177b5a(0x1e6)]('/payout',(0x0,validation_1[a20_0x177b5a(0x19f)])(validation_1[a20_0x177b5a(0x207)]),adminController[a20_0x177b5a(0x1cb)]),router[a20_0x177b5a(0x1c4)]('/payouts',adminController[a20_0x177b5a(0x194)]),router[a20_0x177b5a(0x1c4)](a20_0x177b5a(0x199),adminController[a20_0x177b5a(0x20b)]),router[a20_0x177b5a(0x1af)](a20_0x177b5a(0x199),adminController['deletePayout']),router['get'](a20_0x177b5a(0x1bb),adminController['getPayments']),router['get'](a20_0x177b5a(0x1c0),adminController[a20_0x177b5a(0x1f0)]),router['put'](a20_0x177b5a(0x1c0),adminController[a20_0x177b5a(0x1fd)]),router[a20_0x177b5a(0x1d4)](a20_0x177b5a(0x1d9),(0x0,validation_1[a20_0x177b5a(0x19f)])(validation_1['updateCustomerDataSchema']),adminController[a20_0x177b5a(0x1a3)]),router['get'](a20_0x177b5a(0x1a8),adminController['getUsers']),router[a20_0x177b5a(0x1c4)]('/users/:id',adminController[a20_0x177b5a(0x1db)]),router[a20_0x177b5a(0x1e6)]('/users',(0x0,validation_1[a20_0x177b5a(0x19f)])(validation_1[a20_0x177b5a(0x1d2)]),adminController['createUser']),router[a20_0x177b5a(0x1d4)](a20_0x177b5a(0x1ba),(0x0,validation_1[a20_0x177b5a(0x19f)])(validation_1[a20_0x177b5a(0x1b1)]),adminController[a20_0x177b5a(0x1c8)]),router[a20_0x177b5a(0x1af)](a20_0x177b5a(0x1ba),adminController[a20_0x177b5a(0x1f2)]),router[a20_0x177b5a(0x1e6)]('/users/:id/suspend',adminController[a20_0x177b5a(0x1c9)]),router['post']('/users/:id/activate',adminController[a20_0x177b5a(0x1f1)]),router['get']('/logs/stats',(_0x4c6aa3,_0x303a86)=>{const _0x3468e6=a20_0x177b5a;try{const _0x29b893=loggerService_1[_0x3468e6(0x1f6)]['getLogStats']();_0x303a86[_0x3468e6(0x1d6)]({'success':!![],'result':_0x29b893});}catch(_0x5a4f91){_0x303a86[_0x3468e6(0x201)](0x1f4)[_0x3468e6(0x1d6)]({'success':![],'message':'Failed\x20to\x20get\x20log\x20statistics'});}}),router[a20_0x177b5a(0x1e6)]('/logs/clean',(_0x2bb882,_0x284c3e)=>{const _0xbc7060=a20_0x177b5a;try{const {daysToKeep:daysToKeep=0x1e}=_0x2bb882[_0xbc7060(0x1e8)];loggerService_1['loggerService']['cleanOldLogs'](daysToKeep),_0x284c3e[_0xbc7060(0x1d6)]({'success':!![],'message':_0xbc7060(0x204)+daysToKeep+_0xbc7060(0x1d1)});}catch(_0x48d737){_0x284c3e['status'](0x1f4)[_0xbc7060(0x1d6)]({'success':![],'message':_0xbc7060(0x1ef)});}}),router[a20_0x177b5a(0x1e6)](a20_0x177b5a(0x1b7),async(_0x5e37e0,_0x1efa99)=>{const _0x1b22df=a20_0x177b5a;try{const {paymentId:_0x192d67}=_0x5e37e0[_0x1b22df(0x1fc)];console[_0x1b22df(0x1fe)](_0x1b22df(0x1f5)+_0x192d67),await coinToPayStatusService_1[_0x1b22df(0x1df)][_0x1b22df(0x19d)](_0x192d67),_0x1efa99[_0x1b22df(0x1d6)]({'success':!![],'message':_0x1b22df(0x1c3)});}catch(_0x5912cd){console[_0x1b22df(0x1a2)](_0x1b22df(0x203)+_0x5e37e0[_0x1b22df(0x1fc)][_0x1b22df(0x1e7)]+':',_0x5912cd),_0x1efa99[_0x1b22df(0x201)](0x1f4)['json']({'success':![],'message':_0x5912cd instanceof Error?_0x5912cd[_0x1b22df(0x1e1)]:_0x1b22df(0x1ee)});}}),router['get']('/cointopay/stats',(_0x589372,_0xa85338)=>{const _0x26fc00=a20_0x177b5a;try{const _0x117e5a=coinToPayStatusService_1[_0x26fc00(0x1df)][_0x26fc00(0x200)]();_0xa85338[_0x26fc00(0x1d6)]({'success':!![],'result':{..._0x117e5a,'description':_0x26fc00(0x1a6),'statusMapping':{'Paid':_0x26fc00(0x1ad),'Awaiting\x20Fiat':_0x26fc00(0x1d0),'waiting':_0x26fc00(0x1d0),'expired':_0x26fc00(0x1d7),'failed':_0x26fc00(0x1bd)},'autoExpiryNote':_0x26fc00(0x1aa)+_0x117e5a[_0x26fc00(0x20c)]+_0x26fc00(0x206),'individualTimersNote':'Each\x20new\x20payment\x20gets\x20individual\x20timers:\x201min,\x202min,\x207min,\x2012min,\x20then\x20hourly'}});}catch(_0x3449cd){_0xa85338[_0x26fc00(0x201)](0x1f4)[_0x26fc00(0x1d6)]({'success':![],'message':_0x26fc00(0x1f8)});}}),router[a20_0x177b5a(0x1c4)](a20_0x177b5a(0x1d5),async(_0x117d1a,_0x359e16)=>{const _0x2d16b0=a20_0x177b5a;try{const {paymentId:_0x3ed1bb}=_0x117d1a[_0x2d16b0(0x1fc)],_0x1d0225=coinToPayStatusService_1[_0x2d16b0(0x1df)][_0x2d16b0(0x1b3)](_0x3ed1bb),_0x951314=(await Promise[_0x2d16b0(0x19c)]()[_0x2d16b0(0x1ac)](()=>__importStar(require(_0x2d16b0(0x1a5)))))[_0x2d16b0(0x198)],_0x142a56=await _0x951314[_0x2d16b0(0x19e)]['findUnique']({'where':{'id':_0x3ed1bb},'select':{'id':!![],'gateway':!![],'gatewayPaymentId':!![],'status':!![],'amount':!![],'currency':!![],'createdAt':!![],'updatedAt':!![],'shopId':!![],'shop':{'select':{'name':!![],'username':!![]}}}});if(!_0x142a56)return _0x359e16[_0x2d16b0(0x201)](0x194)[_0x2d16b0(0x1d6)]({'success':![],'message':_0x2d16b0(0x1dd)});_0x359e16[_0x2d16b0(0x1d6)]({'success':!![],'result':{'payment':{'id':_0x142a56['id'],'gateway':_0x142a56[_0x2d16b0(0x1b9)],'gatewayPaymentId':_0x142a56[_0x2d16b0(0x1ca)],'status':_0x142a56['status'],'amount':_0x142a56[_0x2d16b0(0x1ea)],'currency':_0x142a56[_0x2d16b0(0x1a1)],'createdAt':_0x142a56[_0x2d16b0(0x205)],'updatedAt':_0x142a56['updatedAt'],'shop':_0x142a56[_0x2d16b0(0x1e0)]},'timers':_0x1d0225,'isCoinToPay':_0x142a56[_0x2d16b0(0x1b9)]===_0x2d16b0(0x1f7),'ageInMinutes':Math['floor']((Date[_0x2d16b0(0x1c2)]()-_0x142a56[_0x2d16b0(0x205)][_0x2d16b0(0x1b5)]())/(0x3e8*0x3c))}});}catch(_0x3a7db8){_0x359e16[_0x2d16b0(0x201)](0x1f4)[_0x2d16b0(0x1d6)]({'success':![],'message':_0x3a7db8 instanceof Error?_0x3a7db8['message']:_0x2d16b0(0x1ec)});}}),router['get'](a20_0x177b5a(0x1da),(_0x561689,_0x3c3dc2)=>{const _0x5e95e4=a20_0x177b5a;try{const _0x239c31=domainMonitoringService_1['domainMonitoringService'][_0x5e95e4(0x1eb)]();_0x3c3dc2[_0x5e95e4(0x1d6)]({'success':!![],'result':{..._0x239c31,'description':'Domain\x20monitoring\x20service\x20for\x20amaterasy884.icu','behavior':_0x5e95e4(0x19a),'encoding':_0x5e95e4(0x19b)}});}catch(_0x458338){_0x3c3dc2['status'](0x1f4)[_0x5e95e4(0x1d6)]({'success':![],'message':_0x5e95e4(0x1b2)});}}),router['post'](a20_0x177b5a(0x1de),async(_0x44317b,_0x2a4ec2)=>{const _0x2f92b4=a20_0x177b5a;try{const _0x9d51a8=await domainMonitoringService_1[_0x2f92b4(0x197)][_0x2f92b4(0x1c6)]();_0x2a4ec2[_0x2f92b4(0x1d6)]({'success':!![],'result':{'domainAvailable':_0x9d51a8,'message':_0x9d51a8?_0x2f92b4(0x1e9):'Domain\x20check\x20failed','timestamp':new Date()['toISOString']()}});}catch(_0xf31bd2){_0x2a4ec2[_0x2f92b4(0x201)](0x1f4)[_0x2f92b4(0x1d6)]({'success':![],'message':_0xf31bd2 instanceof Error?_0xf31bd2['message']:'Failed\x20to\x20perform\x20manual\x20domain\x20check'});}}),exports[a20_0x177b5a(0x198)]=router;