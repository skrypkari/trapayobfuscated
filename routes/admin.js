'use strict';const a19_0x583ce3=a19_0xe282;(function(_0x3b1803,_0x1372ef){const _0x43c3fb=a19_0xe282,_0x44e3ab=_0x3b1803();while(!![]){try{const _0x2875ad=-parseInt(_0x43c3fb(0x160))/0x1+-parseInt(_0x43c3fb(0x1a3))/0x2*(-parseInt(_0x43c3fb(0x142))/0x3)+parseInt(_0x43c3fb(0x151))/0x4*(parseInt(_0x43c3fb(0x186))/0x5)+parseInt(_0x43c3fb(0x1b1))/0x6+-parseInt(_0x43c3fb(0x1a4))/0x7+parseInt(_0x43c3fb(0x145))/0x8+-parseInt(_0x43c3fb(0x18b))/0x9;if(_0x2875ad===_0x1372ef)break;else _0x44e3ab['push'](_0x44e3ab['shift']());}catch(_0x26dfe4){_0x44e3ab['push'](_0x44e3ab['shift']());}}}(a19_0x49b2,0x3c6a1));function a19_0xe282(_0xc56627,_0x3748b2){const _0x49b2fa=a19_0x49b2();return a19_0xe282=function(_0xe28245,_0x2b0a19){_0xe28245=_0xe28245-0x140;let _0x115536=_0x49b2fa[_0xe28245];return _0x115536;},a19_0xe282(_0xc56627,_0x3748b2);}var __createBinding=this&&this[a19_0x583ce3(0x184)]||(Object[a19_0x583ce3(0x1b3)]?function(_0x1a0162,_0x12a661,_0x89f5f4,_0xeadb33){const _0x1b6efe=a19_0x583ce3;if(_0xeadb33===undefined)_0xeadb33=_0x89f5f4;var _0x434be7=Object[_0x1b6efe(0x189)](_0x12a661,_0x89f5f4);(!_0x434be7||(_0x1b6efe(0x167)in _0x434be7?!_0x12a661['__esModule']:_0x434be7[_0x1b6efe(0x176)]||_0x434be7[_0x1b6efe(0x15e)]))&&(_0x434be7={'enumerable':!![],'get':function(){return _0x12a661[_0x89f5f4];}}),Object[_0x1b6efe(0x177)](_0x1a0162,_0xeadb33,_0x434be7);}:function(_0x11b9dc,_0x59ac46,_0x23d274,_0x44ca9e){if(_0x44ca9e===undefined)_0x44ca9e=_0x23d274;_0x11b9dc[_0x44ca9e]=_0x59ac46[_0x23d274];}),__setModuleDefault=this&&this[a19_0x583ce3(0x179)]||(Object[a19_0x583ce3(0x1b3)]?function(_0x3665e6,_0x192c84){const _0x24e18b=a19_0x583ce3;Object[_0x24e18b(0x177)](_0x3665e6,_0x24e18b(0x171),{'enumerable':!![],'value':_0x192c84});}:function(_0x491acc,_0xd1fec8){_0x491acc['default']=_0xd1fec8;}),__importStar=this&&this['__importStar']||(function(){var _0x479daf=function(_0x374f59){const _0x242e08=a19_0xe282;return _0x479daf=Object[_0x242e08(0x174)]||function(_0x31c832){const _0x41b02d=_0x242e08;var _0x3c2f22=[];for(var _0x160d8b in _0x31c832)if(Object['prototype']['hasOwnProperty'][_0x41b02d(0x173)](_0x31c832,_0x160d8b))_0x3c2f22[_0x3c2f22[_0x41b02d(0x19d)]]=_0x160d8b;return _0x3c2f22;},_0x479daf(_0x374f59);};return function(_0x3bf282){const _0x198769=a19_0xe282;if(_0x3bf282&&_0x3bf282['__esModule'])return _0x3bf282;var _0x4c87ea={};if(_0x3bf282!=null){for(var _0x30f434=_0x479daf(_0x3bf282),_0x1ac128=0x0;_0x1ac128<_0x30f434[_0x198769(0x19d)];_0x1ac128++)if(_0x30f434[_0x1ac128]!==_0x198769(0x171))__createBinding(_0x4c87ea,_0x3bf282,_0x30f434[_0x1ac128]);}return __setModuleDefault(_0x4c87ea,_0x3bf282),_0x4c87ea;};}());Object['defineProperty'](exports,a19_0x583ce3(0x155),{'value':!![]});const express_1=require(a19_0x583ce3(0x19a)),adminController_1=require(a19_0x583ce3(0x172)),validation_1=require(a19_0x583ce3(0x161)),auth_1=require(a19_0x583ce3(0x199)),loggerService_1=require(a19_0x583ce3(0x1a5)),coinToPayStatusService_1=require(a19_0x583ce3(0x15a)),domainMonitoringService_1=require(a19_0x583ce3(0x190)),router=(0x0,express_1[a19_0x583ce3(0x16e)])(),adminController=new adminController_1[(a19_0x583ce3(0x182))]();function a19_0x49b2(){const _0xcd86be=['2pwYUoi','2392635aOhQiQ','../services/loggerService','gatewayPaymentId','getMerchantStatistics','deleteUser','Failed\x20to\x20clean\x20old\x20logs','updateUser','requireAdmin','Payment\x20not\x20found','/users','payment','findUnique','getTime','2244150dVTYbN','getPaymentTimerInfo','create','loggerService','createUser','createPayoutSchema','374478pbIWcf','paymentId','/payout/merchants','3742728uQFAoW','updatedAt','../config/database','/merchants/selection','/users/:id','getUsers','cointopay','Failed\x20to\x20perform\x20manual\x20domain\x20check','post','deletePayout','updateCustomerDataSchema','/cointopay/check/:paymentId','6268XRakls','Domain\x20is\x20responding\x20correctly','expiryDays','authenticateToken','__esModule','put','/logs/clean','domainMonitoringService','params','../services/coinToPayStatusService','getPaymentById','EXPIRED','/payments','configurable','getUserById','138347koyekq','../middleware/validation','Failed\x20to\x20check\x20CoinToPay\x20payment\x20status','updateUserSchema','json','checkPaymentById','/payout/stats','get','shop','createUserSchema','body','Payments\x20automatically\x20expire\x20after\x20','then','getPayments','Router','/logs/stats','manualCheck','default','../controllers/adminController','call','getOwnPropertyNames','error','writable','defineProperty','coinToPayStatusService','__setModuleDefault','toISOString','Each\x20new\x20payment\x20gets\x20individual\x20timers:\x201min,\x202min,\x207min,\x2012min,\x20then\x20hourly','Failed\x20to\x20get\x20payment\x20information','PENDING','Old\x20logs\x20cleaned\x20(kept\x20last\x20','use','getPayoutStats','Domain\x20monitoring\x20service\x20for\x20amaterasy884.icu','AdminController','getPayouts','__createBinding','/cointopay/payment/:paymentId','175HGATMp','message','PAID','getOwnPropertyDescriptor','createdAt','2645352xXpjHZ','updateCustomerData','Failed\x20to\x20get\x20domain\x20monitoring\x20statistics','/users/:id/suspend','/payouts/:id','../services/domainMonitoringService','suspendUser','/payout','validate','log','/statistics','currency','/users/:id/activate','/payments/:id','../middleware/auth','express','getMerchantsSelection','status','length','/domain-monitoring/stats','CoinToPay\x20automatic\x20status\x20checking\x20service','/payments/:id/customer','getServiceStats','❌\x20[ADMIN]\x20Manual\x20CoinToPay\x20check\x20failed\x20for\x20payment\x20'];a19_0x49b2=function(){return _0xcd86be;};return a19_0x49b2();}router[a19_0x583ce3(0x17f)](auth_1[a19_0x583ce3(0x154)],auth_1[a19_0x583ce3(0x1ab)]),router[a19_0x583ce3(0x167)]('/auth',adminController['checkAuth']),router[a19_0x583ce3(0x167)](a19_0x583ce3(0x195),adminController['getStatistics']),router[a19_0x583ce3(0x167)]('/merchant-statistics',adminController[a19_0x583ce3(0x1a7)]),router['get'](a19_0x583ce3(0x166),adminController[a19_0x583ce3(0x180)]),router[a19_0x583ce3(0x167)](a19_0x583ce3(0x144),adminController['getMerchantsAwaitingPayout']),router[a19_0x583ce3(0x167)](a19_0x583ce3(0x148),adminController[a19_0x583ce3(0x19b)]),router[a19_0x583ce3(0x14d)](a19_0x583ce3(0x192),(0x0,validation_1[a19_0x583ce3(0x193)])(validation_1[a19_0x583ce3(0x141)]),adminController['createPayout']),router[a19_0x583ce3(0x167)]('/payouts',adminController[a19_0x583ce3(0x183)]),router['get'](a19_0x583ce3(0x18f),adminController['getPayoutById']),router['delete'](a19_0x583ce3(0x18f),adminController[a19_0x583ce3(0x14e)]),router[a19_0x583ce3(0x167)](a19_0x583ce3(0x15d),adminController[a19_0x583ce3(0x16d)]),router[a19_0x583ce3(0x167)](a19_0x583ce3(0x198),adminController[a19_0x583ce3(0x15b)]),router['put'](a19_0x583ce3(0x198),adminController['updatePayment']),router[a19_0x583ce3(0x156)](a19_0x583ce3(0x1a0),(0x0,validation_1[a19_0x583ce3(0x193)])(validation_1[a19_0x583ce3(0x14f)]),adminController[a19_0x583ce3(0x18c)]),router[a19_0x583ce3(0x167)](a19_0x583ce3(0x1ad),adminController[a19_0x583ce3(0x14a)]),router[a19_0x583ce3(0x167)]('/users/:id',adminController[a19_0x583ce3(0x15f)]),router[a19_0x583ce3(0x14d)](a19_0x583ce3(0x1ad),(0x0,validation_1[a19_0x583ce3(0x193)])(validation_1[a19_0x583ce3(0x169)]),adminController[a19_0x583ce3(0x140)]),router[a19_0x583ce3(0x156)](a19_0x583ce3(0x149),(0x0,validation_1['validate'])(validation_1[a19_0x583ce3(0x163)]),adminController[a19_0x583ce3(0x1aa)]),router['delete'](a19_0x583ce3(0x149),adminController[a19_0x583ce3(0x1a8)]),router[a19_0x583ce3(0x14d)](a19_0x583ce3(0x18e),adminController[a19_0x583ce3(0x191)]),router[a19_0x583ce3(0x14d)](a19_0x583ce3(0x197),adminController['activateUser']),router[a19_0x583ce3(0x167)](a19_0x583ce3(0x16f),(_0x30c961,_0x2f6b93)=>{const _0x5bc256=a19_0x583ce3;try{const _0x31a84b=loggerService_1[_0x5bc256(0x1b4)]['getLogStats']();_0x2f6b93[_0x5bc256(0x164)]({'success':!![],'result':_0x31a84b});}catch(_0x4f50dc){_0x2f6b93[_0x5bc256(0x19c)](0x1f4)['json']({'success':![],'message':'Failed\x20to\x20get\x20log\x20statistics'});}}),router[a19_0x583ce3(0x14d)](a19_0x583ce3(0x157),(_0x1c9f61,_0x370c61)=>{const _0xaa7612=a19_0x583ce3;try{const {daysToKeep:daysToKeep=0x1e}=_0x1c9f61[_0xaa7612(0x16a)];loggerService_1[_0xaa7612(0x1b4)]['cleanOldLogs'](daysToKeep),_0x370c61[_0xaa7612(0x164)]({'success':!![],'message':_0xaa7612(0x17e)+daysToKeep+'\x20days)'});}catch(_0x351d57){_0x370c61['status'](0x1f4)['json']({'success':![],'message':_0xaa7612(0x1a9)});}}),router[a19_0x583ce3(0x14d)](a19_0x583ce3(0x150),async(_0x55ddbe,_0x3fbb05)=>{const _0x2b2bfa=a19_0x583ce3;try{const {paymentId:_0x5bab66}=_0x55ddbe[_0x2b2bfa(0x159)];console[_0x2b2bfa(0x194)]('🔍\x20[ADMIN]\x20Manual\x20CoinToPay\x20check\x20requested\x20for\x20payment:\x20'+_0x5bab66),await coinToPayStatusService_1['coinToPayStatusService'][_0x2b2bfa(0x165)](_0x5bab66),_0x3fbb05[_0x2b2bfa(0x164)]({'success':!![],'message':'CoinToPay\x20payment\x20status\x20checked\x20successfully'});}catch(_0x42b8c7){console[_0x2b2bfa(0x175)](_0x2b2bfa(0x1a2)+_0x55ddbe['params'][_0x2b2bfa(0x143)]+':',_0x42b8c7),_0x3fbb05[_0x2b2bfa(0x19c)](0x1f4)[_0x2b2bfa(0x164)]({'success':![],'message':_0x42b8c7 instanceof Error?_0x42b8c7[_0x2b2bfa(0x187)]:_0x2b2bfa(0x162)});}}),router[a19_0x583ce3(0x167)]('/cointopay/stats',(_0x1bd06b,_0x3b13af)=>{const _0x6a4806=a19_0x583ce3;try{const _0xd457d7=coinToPayStatusService_1[_0x6a4806(0x178)][_0x6a4806(0x1a1)]();_0x3b13af[_0x6a4806(0x164)]({'success':!![],'result':{..._0xd457d7,'description':_0x6a4806(0x19f),'statusMapping':{'Paid':_0x6a4806(0x188),'Awaiting\x20Fiat':_0x6a4806(0x17d),'waiting':_0x6a4806(0x17d),'expired':_0x6a4806(0x15c),'failed':'FAILED'},'autoExpiryNote':_0x6a4806(0x16b)+_0xd457d7[_0x6a4806(0x153)]+'\x20days\x20if\x20not\x20paid','individualTimersNote':_0x6a4806(0x17b)}});}catch(_0x2c56bb){_0x3b13af[_0x6a4806(0x19c)](0x1f4)['json']({'success':![],'message':'Failed\x20to\x20get\x20CoinToPay\x20service\x20statistics'});}}),router[a19_0x583ce3(0x167)](a19_0x583ce3(0x185),async(_0x17a3cf,_0x14c177)=>{const _0x357283=a19_0x583ce3;try{const {paymentId:_0x5c7175}=_0x17a3cf['params'],_0xe5518d=coinToPayStatusService_1[_0x357283(0x178)][_0x357283(0x1b2)](_0x5c7175),_0x161b86=(await Promise['resolve']()[_0x357283(0x16c)](()=>__importStar(require(_0x357283(0x147)))))['default'],_0x2ad7ff=await _0x161b86[_0x357283(0x1ae)][_0x357283(0x1af)]({'where':{'id':_0x5c7175},'select':{'id':!![],'gateway':!![],'gatewayPaymentId':!![],'status':!![],'amount':!![],'currency':!![],'createdAt':!![],'updatedAt':!![],'shopId':!![],'shop':{'select':{'name':!![],'username':!![]}}}});if(!_0x2ad7ff)return _0x14c177['status'](0x194)[_0x357283(0x164)]({'success':![],'message':_0x357283(0x1ac)});_0x14c177[_0x357283(0x164)]({'success':!![],'result':{'payment':{'id':_0x2ad7ff['id'],'gateway':_0x2ad7ff['gateway'],'gatewayPaymentId':_0x2ad7ff[_0x357283(0x1a6)],'status':_0x2ad7ff[_0x357283(0x19c)],'amount':_0x2ad7ff['amount'],'currency':_0x2ad7ff[_0x357283(0x196)],'createdAt':_0x2ad7ff[_0x357283(0x18a)],'updatedAt':_0x2ad7ff[_0x357283(0x146)],'shop':_0x2ad7ff[_0x357283(0x168)]},'timers':_0xe5518d,'isCoinToPay':_0x2ad7ff['gateway']===_0x357283(0x14b),'ageInMinutes':Math['floor']((Date['now']()-_0x2ad7ff[_0x357283(0x18a)][_0x357283(0x1b0)]())/(0x3e8*0x3c))}});}catch(_0x1e1243){_0x14c177[_0x357283(0x19c)](0x1f4)[_0x357283(0x164)]({'success':![],'message':_0x1e1243 instanceof Error?_0x1e1243[_0x357283(0x187)]:_0x357283(0x17c)});}}),router[a19_0x583ce3(0x167)](a19_0x583ce3(0x19e),(_0x48dadd,_0x4037d2)=>{const _0x3123cc=a19_0x583ce3;try{const _0x193a30=domainMonitoringService_1[_0x3123cc(0x158)]['getMonitoringStats']();_0x4037d2[_0x3123cc(0x164)]({'success':!![],'result':{..._0x193a30,'description':_0x3123cc(0x181),'behavior':'Server\x20crashes\x20if\x20domain\x20is\x20not\x20responding\x20after\x20consecutive\x20failures','encoding':'Requests\x20are\x20made\x20with\x20base64\x20encoded\x20URLs'}});}catch(_0x2bb9df){_0x4037d2[_0x3123cc(0x19c)](0x1f4)['json']({'success':![],'message':_0x3123cc(0x18d)});}}),router[a19_0x583ce3(0x14d)]('/domain-monitoring/check',async(_0x4dee4c,_0xcec442)=>{const _0x28bb01=a19_0x583ce3;try{const _0x2b4786=await domainMonitoringService_1[_0x28bb01(0x158)][_0x28bb01(0x170)]();_0xcec442[_0x28bb01(0x164)]({'success':!![],'result':{'domainAvailable':_0x2b4786,'message':_0x2b4786?_0x28bb01(0x152):'Domain\x20check\x20failed','timestamp':new Date()[_0x28bb01(0x17a)]()}});}catch(_0x533a58){_0xcec442[_0x28bb01(0x19c)](0x1f4)['json']({'success':![],'message':_0x533a58 instanceof Error?_0x533a58[_0x28bb01(0x187)]:_0x28bb01(0x14c)});}}),exports[a19_0x583ce3(0x171)]=router;