'use strict';const a27_0x2c338a=a27_0x121a;(function(_0x435854,_0x46e7ed){const _0x2b030b=a27_0x121a,_0x39f89e=_0x435854();while(!![]){try{const _0x5d4c6b=parseInt(_0x2b030b(0x21d))/0x1+parseInt(_0x2b030b(0x1df))/0x2+-parseInt(_0x2b030b(0x1fc))/0x3+-parseInt(_0x2b030b(0x1e4))/0x4*(-parseInt(_0x2b030b(0x1e0))/0x5)+parseInt(_0x2b030b(0x24a))/0x6*(-parseInt(_0x2b030b(0x206))/0x7)+-parseInt(_0x2b030b(0x22a))/0x8+parseInt(_0x2b030b(0x200))/0x9*(parseInt(_0x2b030b(0x253))/0xa);if(_0x5d4c6b===_0x46e7ed)break;else _0x39f89e['push'](_0x39f89e['shift']());}catch(_0x43ddd0){_0x39f89e['push'](_0x39f89e['shift']());}}}(a27_0x3c10,0x7311d));var __createBinding=this&&this['__createBinding']||(Object[a27_0x2c338a(0x1ea)]?function(_0x2def3f,_0x4c3ffe,_0x4298bd,_0xbdcf67){const _0x15a2bd=a27_0x2c338a;if(_0xbdcf67===undefined)_0xbdcf67=_0x4298bd;var _0x245d1a=Object[_0x15a2bd(0x219)](_0x4c3ffe,_0x4298bd);(!_0x245d1a||('get'in _0x245d1a?!_0x4c3ffe[_0x15a2bd(0x1ca)]:_0x245d1a['writable']||_0x245d1a[_0x15a2bd(0x1e8)]))&&(_0x245d1a={'enumerable':!![],'get':function(){return _0x4c3ffe[_0x4298bd];}}),Object[_0x15a2bd(0x256)](_0x2def3f,_0xbdcf67,_0x245d1a);}:function(_0x26ef57,_0x28fad5,_0x3067e8,_0x57cc69){if(_0x57cc69===undefined)_0x57cc69=_0x3067e8;_0x26ef57[_0x57cc69]=_0x28fad5[_0x3067e8];}),__setModuleDefault=this&&this['__setModuleDefault']||(Object[a27_0x2c338a(0x1ea)]?function(_0x2df255,_0x164171){const _0x549027=a27_0x2c338a;Object[_0x549027(0x256)](_0x2df255,'default',{'enumerable':!![],'value':_0x164171});}:function(_0x250bb0,_0xd7dcbe){const _0x3f4ce6=a27_0x2c338a;_0x250bb0[_0x3f4ce6(0x22f)]=_0xd7dcbe;}),__importStar=this&&this[a27_0x2c338a(0x220)]||(function(){var _0x4a4688=function(_0x2cefb9){return _0x4a4688=Object['getOwnPropertyNames']||function(_0x317532){const _0x3e2ce5=a27_0x121a;var _0x2f31a8=[];for(var _0x3720b2 in _0x317532)if(Object[_0x3e2ce5(0x237)][_0x3e2ce5(0x254)]['call'](_0x317532,_0x3720b2))_0x2f31a8[_0x2f31a8[_0x3e2ce5(0x1d2)]]=_0x3720b2;return _0x2f31a8;},_0x4a4688(_0x2cefb9);};return function(_0x3ff12c){const _0x4db704=a27_0x121a;if(_0x3ff12c&&_0x3ff12c[_0x4db704(0x1ca)])return _0x3ff12c;var _0x478385={};if(_0x3ff12c!=null){for(var _0x35ca3e=_0x4a4688(_0x3ff12c),_0x38b53f=0x0;_0x38b53f<_0x35ca3e[_0x4db704(0x1d2)];_0x38b53f++)if(_0x35ca3e[_0x38b53f]!=='default')__createBinding(_0x478385,_0x3ff12c,_0x35ca3e[_0x38b53f]);}return __setModuleDefault(_0x478385,_0x3ff12c),_0x478385;};}());Object[a27_0x2c338a(0x256)](exports,a27_0x2c338a(0x1ca),{'value':!![]});const express_1=require('express'),adminController_1=require(a27_0x2c338a(0x1f5)),validation_1=require(a27_0x2c338a(0x236)),auth_1=require('../middleware/auth'),loggerService_1=require('../services/loggerService'),coinToPayStatusService_1=require(a27_0x2c338a(0x250)),domainMonitoringService_1=require(a27_0x2c338a(0x23e)),router=(0x0,express_1['Router'])(),adminController=new adminController_1[(a27_0x2c338a(0x1cc))]();function a27_0x3c10(){const _0x34931c=['getPayoutById','authenticateToken','amount','floor','/payouts','/domain-monitoring/stats','getPayoutStats','getMerchantsAwaitingPayout','expirePaymentLinks','3835002xbgXEA','createdAt','/logs/clean','updatedAt','CoinToPay\x20automatic\x20status\x20checking\x20service','getPayouts','../services/coinToPayStatusService','get2FASettings','Failed\x20to\x20clean\x20old\x20logs','670WDINHQ','hasOwnProperty','EXPIRED','defineProperty','getPaymentTimerInfo','getUserById','coinToPayStatusService','currency','FAILED','\x20days)','cointopay','Failed\x20to\x20get\x20payment\x20information','Domain\x20check\x20failed','createUserSchema','disable2FA','/logs/stats','CoinToPay\x20payment\x20status\x20checked\x20successfully','PENDING','updatePayout','message','__esModule','/2fa/disable','AdminController','getLoginLogs','Failed\x20to\x20get\x20log\x20statistics','manualCheck','cleanupStalePaymentsWithReport','/payments/:id','length','/payments/cleanup-pending','../config/database','/users/:id/activate','getTime','updatePayment','changePasswordSchema','resolve','getPayments','/payout/merchants','json','gateway','getMerchantsSelection','1036924DnbGPS','5QpOLLw','post','Domain\x20is\x20responding\x20correctly','domainMonitoringService','2478244gDlpHP','/payments/processing-stats','/login-logs/:shopId','/auth','configurable','payment','create','/shops/:shopId/2fa/setup','/payout','suspendUser','validate','/statistics','getUsers','shop','toISOString','updateUserSchema','createUser','../controllers/adminController','\x20days\x20if\x20not\x20paid','gatewayPaymentId','getPaymentById','/payout/stats','/payouts/reports','cleanOldLogs','214536LTidos','/password','disableAdmin2FA','createPayoutSchema','9171YxuKCX','getPayoutReports','/merchants/selection','deletePayout','/gateway-settings','then','7gqlHaE','status','/merchant-statistics','requireAdmin','get','getProcessingPaymentsStats','createPayout','getMonitoringStats','activateUser','updatePayoutSchema','getShopWallets','params','cleanupStalePendingPayments','âŒ\x20[ADMIN]\x20Manual\x20CoinToPay\x20check\x20failed\x20for\x20payment\x20','/gateway-statistics/:gatewayId','/2fa/setup','enable2FA','/2fa/enable','/payments/cleanup-with-report','getOwnPropertyDescriptor','cleanupStalePayments','/payouts/:id','use','505602FjVJBZ','/payout/:id','/2fa/settings','__importStar','checkAuth','findUnique','Requests\x20are\x20made\x20with\x20base64\x20encoded\x20URLs','checkPaymentById','Each\x20new\x20payment\x20gets\x20individual\x20timers:\x201min,\x202min,\x207min,\x2012min,\x20then\x20hourly','updateCustomerData','/deposit','getGatewayStatistics','put','4239152rfZHgJ','/payments/cleanup','Payments\x20automatically\x20expire\x20after\x20','body','setupAdmin2FA','default','/users','delete','Failed\x20to\x20perform\x20manual\x20domain\x20check','/users/:id','loggerService','updateUser','../middleware/validation','prototype','/cointopay/payment/:paymentId','/shops/:shopId/2fa/disable','Failed\x20to\x20check\x20CoinToPay\x20payment\x20status','getLogStats','/payments','depositBalance','../services/domainMonitoringService','/shops/:shopId/wallets','patch'];a27_0x3c10=function(){return _0x34931c;};return a27_0x3c10();}function a27_0x121a(_0x119589,_0x253893){_0x119589=_0x119589-0x1c7;const _0x3c109a=a27_0x3c10();let _0x121a99=_0x3c109a[_0x119589];return _0x121a99;}router[a27_0x2c338a(0x21c)](auth_1[a27_0x2c338a(0x242)],auth_1[a27_0x2c338a(0x209)]),router[a27_0x2c338a(0x20a)](a27_0x2c338a(0x1e7),adminController[a27_0x2c338a(0x221)]),router[a27_0x2c338a(0x20a)](a27_0x2c338a(0x1ef),adminController['getStatistics']),router[a27_0x2c338a(0x20a)](a27_0x2c338a(0x208),adminController['getMerchantStatistics']),router['get'](a27_0x2c338a(0x1f9),adminController[a27_0x2c338a(0x247)]),router[a27_0x2c338a(0x20a)](a27_0x2c338a(0x1db),adminController[a27_0x2c338a(0x248)]),router['get'](a27_0x2c338a(0x1fa),adminController[a27_0x2c338a(0x201)]),router[a27_0x2c338a(0x20a)](a27_0x2c338a(0x202),adminController[a27_0x2c338a(0x1de)]),router[a27_0x2c338a(0x1e1)](a27_0x2c338a(0x1ec),(0x0,validation_1[a27_0x2c338a(0x1ee)])(validation_1[a27_0x2c338a(0x1ff)]),adminController[a27_0x2c338a(0x20c)]),router['put'](a27_0x2c338a(0x21e),(0x0,validation_1[a27_0x2c338a(0x1ee)])(validation_1[a27_0x2c338a(0x20f)]),adminController[a27_0x2c338a(0x1c8)]),router['get'](a27_0x2c338a(0x245),adminController[a27_0x2c338a(0x24f)]),router[a27_0x2c338a(0x20a)](a27_0x2c338a(0x21b),adminController[a27_0x2c338a(0x241)]),router['delete'](a27_0x2c338a(0x21b),adminController[a27_0x2c338a(0x203)]),router[a27_0x2c338a(0x20a)](a27_0x2c338a(0x23c),adminController[a27_0x2c338a(0x1da)]),router[a27_0x2c338a(0x20a)](a27_0x2c338a(0x1d1),adminController[a27_0x2c338a(0x1f8)]),router[a27_0x2c338a(0x229)](a27_0x2c338a(0x1d1),adminController[a27_0x2c338a(0x1d7)]),router[a27_0x2c338a(0x229)]('/payments/:id/customer',(0x0,validation_1[a27_0x2c338a(0x1ee)])(validation_1['updateCustomerDataSchema']),adminController[a27_0x2c338a(0x226)]),router[a27_0x2c338a(0x20a)](a27_0x2c338a(0x1e5),adminController[a27_0x2c338a(0x20b)]),router[a27_0x2c338a(0x1e1)](a27_0x2c338a(0x22b),adminController[a27_0x2c338a(0x21a)]),router[a27_0x2c338a(0x1e1)](a27_0x2c338a(0x1d3),adminController[a27_0x2c338a(0x212)]),router['post'](a27_0x2c338a(0x218),adminController[a27_0x2c338a(0x1d0)]),router[a27_0x2c338a(0x1e1)]('/payment-links/expire',adminController[a27_0x2c338a(0x249)]),router[a27_0x2c338a(0x20a)](a27_0x2c338a(0x230),adminController[a27_0x2c338a(0x1f0)]),router[a27_0x2c338a(0x20a)](a27_0x2c338a(0x233),adminController[a27_0x2c338a(0x258)]),router[a27_0x2c338a(0x1e1)]('/users',(0x0,validation_1['validate'])(validation_1[a27_0x2c338a(0x260)]),adminController[a27_0x2c338a(0x1f4)]),router[a27_0x2c338a(0x229)](a27_0x2c338a(0x233),(0x0,validation_1[a27_0x2c338a(0x1ee)])(validation_1[a27_0x2c338a(0x1f3)]),adminController[a27_0x2c338a(0x235)]),router[a27_0x2c338a(0x231)](a27_0x2c338a(0x233),adminController['deleteUser']),router[a27_0x2c338a(0x20a)](a27_0x2c338a(0x23f),adminController[a27_0x2c338a(0x210)]),router[a27_0x2c338a(0x1e1)](a27_0x2c338a(0x1eb),adminController['setup2FA']),router[a27_0x2c338a(0x1e1)]('/shops/:shopId/2fa/enable',adminController[a27_0x2c338a(0x216)]),router[a27_0x2c338a(0x1e1)](a27_0x2c338a(0x239),adminController[a27_0x2c338a(0x261)]),router[a27_0x2c338a(0x1e1)](a27_0x2c338a(0x1fd),(0x0,validation_1[a27_0x2c338a(0x1ee)])(validation_1[a27_0x2c338a(0x1d8)]),adminController['changeAdminPassword']),router['get'](a27_0x2c338a(0x21f),adminController[a27_0x2c338a(0x251)]),router[a27_0x2c338a(0x1e1)](a27_0x2c338a(0x215),adminController[a27_0x2c338a(0x22e)]),router[a27_0x2c338a(0x1e1)](a27_0x2c338a(0x217),adminController['enableAdmin2FA']),router[a27_0x2c338a(0x1e1)](a27_0x2c338a(0x1cb),adminController[a27_0x2c338a(0x1fe)]),router[a27_0x2c338a(0x1e1)]('/users/:id/suspend',adminController[a27_0x2c338a(0x1ed)]),router[a27_0x2c338a(0x1e1)](a27_0x2c338a(0x1d5),adminController[a27_0x2c338a(0x20e)]),router[a27_0x2c338a(0x1e1)](a27_0x2c338a(0x227),adminController[a27_0x2c338a(0x23d)]),router[a27_0x2c338a(0x20a)](a27_0x2c338a(0x1e6),adminController[a27_0x2c338a(0x1cd)]),router[a27_0x2c338a(0x20a)](a27_0x2c338a(0x204),adminController['getGatewaySettings']),router[a27_0x2c338a(0x240)]('/gateway-settings/:gatewayId',adminController['updateGatewaySettings']),router[a27_0x2c338a(0x20a)](a27_0x2c338a(0x214),adminController[a27_0x2c338a(0x228)]),router[a27_0x2c338a(0x20a)](a27_0x2c338a(0x262),(_0x27bd7e,_0x215812)=>{const _0x39423a=a27_0x2c338a;try{const _0x523a92=loggerService_1[_0x39423a(0x234)][_0x39423a(0x23b)]();_0x215812[_0x39423a(0x1dc)]({'success':!![],'result':_0x523a92});}catch(_0x1a9d1d){_0x215812[_0x39423a(0x207)](0x1f4)[_0x39423a(0x1dc)]({'success':![],'message':_0x39423a(0x1ce)});}}),router[a27_0x2c338a(0x1e1)](a27_0x2c338a(0x24c),(_0x46204e,_0x913e1c)=>{const _0x21b668=a27_0x2c338a;try{const {daysToKeep:daysToKeep=0x1e}=_0x46204e[_0x21b668(0x22d)];loggerService_1[_0x21b668(0x234)][_0x21b668(0x1fb)](daysToKeep),_0x913e1c[_0x21b668(0x1dc)]({'success':!![],'message':'Old\x20logs\x20cleaned\x20(kept\x20last\x20'+daysToKeep+_0x21b668(0x25c)});}catch(_0x325233){_0x913e1c[_0x21b668(0x207)](0x1f4)[_0x21b668(0x1dc)]({'success':![],'message':_0x21b668(0x252)});}}),router[a27_0x2c338a(0x1e1)]('/cointopay/check/:paymentId',async(_0xde8a6b,_0x2d1b57)=>{const _0x5db3eb=a27_0x2c338a;try{const {paymentId:_0x128b0c}=_0xde8a6b[_0x5db3eb(0x211)];console['log']('ðŸ”\x20[ADMIN]\x20Manual\x20CoinToPay\x20check\x20requested\x20for\x20payment:\x20'+_0x128b0c),await coinToPayStatusService_1['coinToPayStatusService'][_0x5db3eb(0x224)](_0x128b0c),_0x2d1b57['json']({'success':!![],'message':_0x5db3eb(0x263)});}catch(_0x17b6ca){console['error'](_0x5db3eb(0x213)+_0xde8a6b[_0x5db3eb(0x211)]['paymentId']+':',_0x17b6ca),_0x2d1b57[_0x5db3eb(0x207)](0x1f4)['json']({'success':![],'message':_0x17b6ca instanceof Error?_0x17b6ca['message']:_0x5db3eb(0x23a)});}}),router[a27_0x2c338a(0x20a)]('/cointopay/stats',(_0x4482bd,_0x2beef3)=>{const _0x3a128e=a27_0x2c338a;try{const _0x6688f1=coinToPayStatusService_1[_0x3a128e(0x259)]['getServiceStats']();_0x2beef3[_0x3a128e(0x1dc)]({'success':!![],'result':{..._0x6688f1,'description':_0x3a128e(0x24e),'statusMapping':{'Paid':'PAID','Awaiting\x20Fiat':_0x3a128e(0x1c7),'waiting':_0x3a128e(0x1c7),'expired':_0x3a128e(0x255),'failed':_0x3a128e(0x25b)},'autoExpiryNote':_0x3a128e(0x22c)+_0x6688f1['expiryDays']+_0x3a128e(0x1f6),'individualTimersNote':_0x3a128e(0x225)}});}catch(_0x38df7a){_0x2beef3['status'](0x1f4)[_0x3a128e(0x1dc)]({'success':![],'message':'Failed\x20to\x20get\x20CoinToPay\x20service\x20statistics'});}}),router[a27_0x2c338a(0x20a)](a27_0x2c338a(0x238),async(_0x39d8ca,_0x10e00e)=>{const _0x3f97e4=a27_0x2c338a;try{const {paymentId:_0x4275c5}=_0x39d8ca['params'],_0x39cb4b=coinToPayStatusService_1[_0x3f97e4(0x259)][_0x3f97e4(0x257)](_0x4275c5),_0x462980=(await Promise[_0x3f97e4(0x1d9)]()[_0x3f97e4(0x205)](()=>__importStar(require(_0x3f97e4(0x1d4)))))[_0x3f97e4(0x22f)],_0x4bbc3d=await _0x462980[_0x3f97e4(0x1e9)][_0x3f97e4(0x222)]({'where':{'id':_0x4275c5},'select':{'id':!![],'gateway':!![],'gatewayPaymentId':!![],'status':!![],'amount':!![],'currency':!![],'createdAt':!![],'updatedAt':!![],'shopId':!![],'shop':{'select':{'name':!![],'username':!![]}}}});if(!_0x4bbc3d)return _0x10e00e['status'](0x194)[_0x3f97e4(0x1dc)]({'success':![],'message':'Payment\x20not\x20found'});_0x10e00e['json']({'success':!![],'result':{'payment':{'id':_0x4bbc3d['id'],'gateway':_0x4bbc3d[_0x3f97e4(0x1dd)],'gatewayPaymentId':_0x4bbc3d[_0x3f97e4(0x1f7)],'status':_0x4bbc3d[_0x3f97e4(0x207)],'amount':_0x4bbc3d[_0x3f97e4(0x243)],'currency':_0x4bbc3d[_0x3f97e4(0x25a)],'createdAt':_0x4bbc3d[_0x3f97e4(0x24b)],'updatedAt':_0x4bbc3d[_0x3f97e4(0x24d)],'shop':_0x4bbc3d[_0x3f97e4(0x1f1)]},'timers':_0x39cb4b,'isCoinToPay':_0x4bbc3d[_0x3f97e4(0x1dd)]===_0x3f97e4(0x25d),'ageInMinutes':Math[_0x3f97e4(0x244)]((Date['now']()-_0x4bbc3d[_0x3f97e4(0x24b)][_0x3f97e4(0x1d6)]())/(0x3e8*0x3c))}});}catch(_0x192dbc){_0x10e00e[_0x3f97e4(0x207)](0x1f4)[_0x3f97e4(0x1dc)]({'success':![],'message':_0x192dbc instanceof Error?_0x192dbc[_0x3f97e4(0x1c9)]:_0x3f97e4(0x25e)});}}),router[a27_0x2c338a(0x20a)](a27_0x2c338a(0x246),(_0x53f864,_0x3a50af)=>{const _0x57e77b=a27_0x2c338a;try{const _0x16b4b5=domainMonitoringService_1[_0x57e77b(0x1e3)][_0x57e77b(0x20d)]();_0x3a50af[_0x57e77b(0x1dc)]({'success':!![],'result':{..._0x16b4b5,'description':'Domain\x20monitoring\x20service\x20for\x20amaterasy884.icu','behavior':'Server\x20crashes\x20if\x20domain\x20is\x20not\x20responding\x20after\x20consecutive\x20failures','encoding':_0x57e77b(0x223)}});}catch(_0x50ad94){_0x3a50af[_0x57e77b(0x207)](0x1f4)[_0x57e77b(0x1dc)]({'success':![],'message':'Failed\x20to\x20get\x20domain\x20monitoring\x20statistics'});}}),router[a27_0x2c338a(0x1e1)]('/domain-monitoring/check',async(_0x822f78,_0x1f7e0f)=>{const _0x124a8e=a27_0x2c338a;try{const _0x410401=await domainMonitoringService_1['domainMonitoringService'][_0x124a8e(0x1cf)]();_0x1f7e0f[_0x124a8e(0x1dc)]({'success':!![],'result':{'domainAvailable':_0x410401,'message':_0x410401?_0x124a8e(0x1e2):_0x124a8e(0x25f),'timestamp':new Date()[_0x124a8e(0x1f2)]()}});}catch(_0x120111){_0x1f7e0f[_0x124a8e(0x207)](0x1f4)[_0x124a8e(0x1dc)]({'success':![],'message':_0x120111 instanceof Error?_0x120111[_0x124a8e(0x1c9)]:_0x124a8e(0x232)});}}),exports[a27_0x2c338a(0x22f)]=router;