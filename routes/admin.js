'use strict';const a24_0x272264=a24_0x3617;function a24_0x3617(_0x37bf3f,_0x230fe2){_0x37bf3f=_0x37bf3f-0x11c;const _0x38708f=a24_0x3870();let _0x3617ef=_0x38708f[_0x37bf3f];return _0x3617ef;}(function(_0x40a264,_0xa4b083){const _0x304055=a24_0x3617,_0x3db456=_0x40a264();while(!![]){try{const _0x42f2bf=parseInt(_0x304055(0x17d))/0x1+-parseInt(_0x304055(0x174))/0x2+parseInt(_0x304055(0x144))/0x3+-parseInt(_0x304055(0x143))/0x4+-parseInt(_0x304055(0x14c))/0x5*(-parseInt(_0x304055(0x173))/0x6)+parseInt(_0x304055(0x122))/0x7*(-parseInt(_0x304055(0x176))/0x8)+parseInt(_0x304055(0x16a))/0x9;if(_0x42f2bf===_0xa4b083)break;else _0x3db456['push'](_0x3db456['shift']());}catch(_0x56595f){_0x3db456['push'](_0x3db456['shift']());}}}(a24_0x3870,0x45ad6));var __createBinding=this&&this[a24_0x272264(0x146)]||(Object[a24_0x272264(0x16f)]?function(_0x4f2068,_0x3d9734,_0x16ca7c,_0x51b06e){const _0x146b82=a24_0x272264;if(_0x51b06e===undefined)_0x51b06e=_0x16ca7c;var _0x4b64a4=Object[_0x146b82(0x140)](_0x3d9734,_0x16ca7c);(!_0x4b64a4||(_0x146b82(0x18e)in _0x4b64a4?!_0x3d9734[_0x146b82(0x13f)]:_0x4b64a4[_0x146b82(0x149)]||_0x4b64a4[_0x146b82(0x157)]))&&(_0x4b64a4={'enumerable':!![],'get':function(){return _0x3d9734[_0x16ca7c];}}),Object[_0x146b82(0x11e)](_0x4f2068,_0x51b06e,_0x4b64a4);}:function(_0x58fbc6,_0x8ac41e,_0x266797,_0x50327a){if(_0x50327a===undefined)_0x50327a=_0x266797;_0x58fbc6[_0x50327a]=_0x8ac41e[_0x266797];}),__setModuleDefault=this&&this[a24_0x272264(0x127)]||(Object[a24_0x272264(0x16f)]?function(_0x2cd9fc,_0x38d604){const _0x2ce3b7=a24_0x272264;Object[_0x2ce3b7(0x11e)](_0x2cd9fc,'default',{'enumerable':!![],'value':_0x38d604});}:function(_0x64524d,_0x202a50){const _0x4f171d=a24_0x272264;_0x64524d[_0x4f171d(0x16c)]=_0x202a50;}),__importStar=this&&this[a24_0x272264(0x151)]||(function(){var _0x283e83=function(_0x2afdd1){const _0x1a8a3b=a24_0x3617;return _0x283e83=Object[_0x1a8a3b(0x190)]||function(_0x9c0a3e){const _0x1d94ae=_0x1a8a3b;var _0x404278=[];for(var _0x23cf97 in _0x9c0a3e)if(Object[_0x1d94ae(0x187)]['hasOwnProperty']['call'](_0x9c0a3e,_0x23cf97))_0x404278[_0x404278['length']]=_0x23cf97;return _0x404278;},_0x283e83(_0x2afdd1);};return function(_0x4e28bc){const _0x1364ef=a24_0x3617;if(_0x4e28bc&&_0x4e28bc[_0x1364ef(0x13f)])return _0x4e28bc;var _0xd1d364={};if(_0x4e28bc!=null){for(var _0x5d2a5f=_0x283e83(_0x4e28bc),_0x4b4292=0x0;_0x4b4292<_0x5d2a5f[_0x1364ef(0x17b)];_0x4b4292++)if(_0x5d2a5f[_0x4b4292]!==_0x1364ef(0x16c))__createBinding(_0xd1d364,_0x4e28bc,_0x5d2a5f[_0x4b4292]);}return __setModuleDefault(_0xd1d364,_0x4e28bc),_0xd1d364;};}());Object[a24_0x272264(0x11e)](exports,'__esModule',{'value':!![]});function a24_0x3870(){const _0x8a746d=['5691iKKSjT','checkAuth','findUnique','/payments/cleanup','loggerService','__setModuleDefault','/payments/:id/customer','gateway','params','Payments\x20automatically\x20expire\x20after\x20','/payments','updateCustomerData','Domain\x20check\x20failed','updateUserSchema','getUsers','getPaymentById','getPayments','status','paymentId','../config/database','requireAdmin','EXPIRED','cleanupStalePendingPayments','updatePayment','domainMonitoringService','createPayout','../middleware/validation','updateUser','Server\x20crashes\x20if\x20domain\x20is\x20not\x20responding\x20after\x20consecutive\x20failures','__esModule','getOwnPropertyDescriptor','updatedAt','/merchants/selection','597792vWORrG','762675yFkUul','cleanupStalePayments','__createBinding','body','error','writable','\x20days\x20if\x20not\x20paid','/users/:id/activate','95ixlxLl','message','getPaymentTimerInfo','CoinToPay\x20payment\x20status\x20checked\x20successfully','createUser','__importStar','/users','PENDING','../services/domainMonitoringService','post','createdAt','configurable','Payment\x20not\x20found','/domain-monitoring/stats','/statistics','express','deletePayout','../controllers/adminController','Failed\x20to\x20get\x20CoinToPay\x20service\x20statistics','Failed\x20to\x20perform\x20manual\x20domain\x20check','cleanupStalePaymentsWithReport','payment','/users/:id','/payments/processing-stats','coinToPayStatusService','/domain-monitoring/check','getTime','Old\x20logs\x20cleaned\x20(kept\x20last\x20','activateUser','getLogStats','2091339sTpQFX','../services/coinToPayStatusService','default','authenticateToken','getPayouts','create','Domain\x20is\x20responding\x20correctly','currency','getPayoutStats','22818OvKMOj','329872zqWZvJ','ðŸ”\x20[ADMIN]\x20Manual\x20CoinToPay\x20check\x20requested\x20for\x20payment:\x20','1912hiTqnl','now','gatewayPaymentId','Each\x20new\x20payment\x20gets\x20individual\x20timers:\x201min,\x202min,\x207min,\x2012min,\x20then\x20hourly','/payout/merchants','length','PAID','235236UpLwhA','/payout','getMerchantsSelection','validate','put','Requests\x20are\x20made\x20with\x20base64\x20encoded\x20URLs','toISOString','Failed\x20to\x20get\x20payment\x20information','/payments/:id','Failed\x20to\x20get\x20domain\x20monitoring\x20statistics','prototype','getMonitoringStats','AdminController','CoinToPay\x20automatic\x20status\x20checking\x20service','/cointopay/check/:paymentId','getMerchantsAwaitingPayout','Failed\x20to\x20clean\x20old\x20logs','get','floor','getOwnPropertyNames','/cointopay/stats','deleteUser','suspendUser','/payments/cleanup-with-report','json','getUserById','cointopay','getPayoutById','createUserSchema','/payouts/:id','/payout/stats','defineProperty','getMerchantStatistics','getProcessingPaymentsStats','getStatistics'];a24_0x3870=function(){return _0x8a746d;};return a24_0x3870();}const express_1=require(a24_0x272264(0x15b)),adminController_1=require(a24_0x272264(0x15d)),validation_1=require(a24_0x272264(0x13c)),auth_1=require('../middleware/auth'),loggerService_1=require('../services/loggerService'),coinToPayStatusService_1=require(a24_0x272264(0x16b)),domainMonitoringService_1=require(a24_0x272264(0x154)),router=(0x0,express_1['Router'])(),adminController=new adminController_1[(a24_0x272264(0x189))]();router['use'](auth_1[a24_0x272264(0x16d)],auth_1[a24_0x272264(0x136)]),router[a24_0x272264(0x18e)]('/auth',adminController[a24_0x272264(0x123)]),router[a24_0x272264(0x18e)](a24_0x272264(0x15a),adminController[a24_0x272264(0x121)]),router[a24_0x272264(0x18e)]('/merchant-statistics',adminController[a24_0x272264(0x11f)]),router[a24_0x272264(0x18e)](a24_0x272264(0x11d),adminController[a24_0x272264(0x172)]),router[a24_0x272264(0x18e)](a24_0x272264(0x17a),adminController[a24_0x272264(0x18c)]),router[a24_0x272264(0x18e)](a24_0x272264(0x142),adminController[a24_0x272264(0x17f)]),router[a24_0x272264(0x155)](a24_0x272264(0x17e),(0x0,validation_1['validate'])(validation_1['createPayoutSchema']),adminController[a24_0x272264(0x13b)]),router[a24_0x272264(0x18e)]('/payouts',adminController[a24_0x272264(0x16e)]),router['get']('/payouts/:id',adminController[a24_0x272264(0x198)]),router['delete'](a24_0x272264(0x11c),adminController[a24_0x272264(0x15c)]),router[a24_0x272264(0x18e)](a24_0x272264(0x12c),adminController[a24_0x272264(0x132)]),router[a24_0x272264(0x18e)]('/payments/:id',adminController[a24_0x272264(0x131)]),router[a24_0x272264(0x181)](a24_0x272264(0x185),adminController[a24_0x272264(0x139)]),router[a24_0x272264(0x181)](a24_0x272264(0x128),(0x0,validation_1[a24_0x272264(0x180)])(validation_1['updateCustomerDataSchema']),adminController[a24_0x272264(0x12d)]),router[a24_0x272264(0x18e)](a24_0x272264(0x163),adminController[a24_0x272264(0x120)]),router['post'](a24_0x272264(0x125),adminController[a24_0x272264(0x145)]),router[a24_0x272264(0x155)]('/payments/cleanup-pending',adminController[a24_0x272264(0x138)]),router['post'](a24_0x272264(0x194),adminController[a24_0x272264(0x160)]),router[a24_0x272264(0x18e)](a24_0x272264(0x152),adminController[a24_0x272264(0x130)]),router[a24_0x272264(0x18e)](a24_0x272264(0x162),adminController[a24_0x272264(0x196)]),router['post']('/users',(0x0,validation_1[a24_0x272264(0x180)])(validation_1[a24_0x272264(0x199)]),adminController[a24_0x272264(0x150)]),router['put'](a24_0x272264(0x162),(0x0,validation_1[a24_0x272264(0x180)])(validation_1[a24_0x272264(0x12f)]),adminController[a24_0x272264(0x13d)]),router['delete'](a24_0x272264(0x162),adminController[a24_0x272264(0x192)]),router[a24_0x272264(0x155)]('/users/:id/suspend',adminController[a24_0x272264(0x193)]),router['post'](a24_0x272264(0x14b),adminController[a24_0x272264(0x168)]),router[a24_0x272264(0x18e)]('/logs/stats',(_0x1c414e,_0x261aca)=>{const _0x4dbbba=a24_0x272264;try{const _0x14d437=loggerService_1[_0x4dbbba(0x126)][_0x4dbbba(0x169)]();_0x261aca['json']({'success':!![],'result':_0x14d437});}catch(_0x32fca2){_0x261aca[_0x4dbbba(0x133)](0x1f4)[_0x4dbbba(0x195)]({'success':![],'message':'Failed\x20to\x20get\x20log\x20statistics'});}}),router[a24_0x272264(0x155)]('/logs/clean',(_0xdb644c,_0x13cbf6)=>{const _0x43834b=a24_0x272264;try{const {daysToKeep:daysToKeep=0x1e}=_0xdb644c[_0x43834b(0x147)];loggerService_1[_0x43834b(0x126)]['cleanOldLogs'](daysToKeep),_0x13cbf6[_0x43834b(0x195)]({'success':!![],'message':_0x43834b(0x167)+daysToKeep+'\x20days)'});}catch(_0x3d058a){_0x13cbf6[_0x43834b(0x133)](0x1f4)[_0x43834b(0x195)]({'success':![],'message':_0x43834b(0x18d)});}}),router[a24_0x272264(0x155)](a24_0x272264(0x18b),async(_0x327672,_0x4be3c1)=>{const _0x4d282b=a24_0x272264;try{const {paymentId:_0x2cc9bf}=_0x327672[_0x4d282b(0x12a)];console['log'](_0x4d282b(0x175)+_0x2cc9bf),await coinToPayStatusService_1[_0x4d282b(0x164)]['checkPaymentById'](_0x2cc9bf),_0x4be3c1[_0x4d282b(0x195)]({'success':!![],'message':_0x4d282b(0x14f)});}catch(_0x17f3f8){console[_0x4d282b(0x148)]('âŒ\x20[ADMIN]\x20Manual\x20CoinToPay\x20check\x20failed\x20for\x20payment\x20'+_0x327672['params'][_0x4d282b(0x134)]+':',_0x17f3f8),_0x4be3c1[_0x4d282b(0x133)](0x1f4)[_0x4d282b(0x195)]({'success':![],'message':_0x17f3f8 instanceof Error?_0x17f3f8[_0x4d282b(0x14d)]:'Failed\x20to\x20check\x20CoinToPay\x20payment\x20status'});}}),router[a24_0x272264(0x18e)](a24_0x272264(0x191),(_0x3a12ce,_0x1c5c5e)=>{const _0xa7ba9e=a24_0x272264;try{const _0x128777=coinToPayStatusService_1['coinToPayStatusService']['getServiceStats']();_0x1c5c5e[_0xa7ba9e(0x195)]({'success':!![],'result':{..._0x128777,'description':_0xa7ba9e(0x18a),'statusMapping':{'Paid':_0xa7ba9e(0x17c),'Awaiting\x20Fiat':'PENDING','waiting':_0xa7ba9e(0x153),'expired':_0xa7ba9e(0x137),'failed':'FAILED'},'autoExpiryNote':_0xa7ba9e(0x12b)+_0x128777['expiryDays']+_0xa7ba9e(0x14a),'individualTimersNote':_0xa7ba9e(0x179)}});}catch(_0x4c5f70){_0x1c5c5e['status'](0x1f4)[_0xa7ba9e(0x195)]({'success':![],'message':_0xa7ba9e(0x15e)});}}),router[a24_0x272264(0x18e)]('/cointopay/payment/:paymentId',async(_0x54026c,_0x49ca21)=>{const _0x2cf6fb=a24_0x272264;try{const {paymentId:_0x4bc29d}=_0x54026c['params'],_0x4d747a=coinToPayStatusService_1[_0x2cf6fb(0x164)][_0x2cf6fb(0x14e)](_0x4bc29d),_0x159d59=(await Promise['resolve']()['then'](()=>__importStar(require(_0x2cf6fb(0x135)))))['default'],_0x203b0b=await _0x159d59[_0x2cf6fb(0x161)][_0x2cf6fb(0x124)]({'where':{'id':_0x4bc29d},'select':{'id':!![],'gateway':!![],'gatewayPaymentId':!![],'status':!![],'amount':!![],'currency':!![],'createdAt':!![],'updatedAt':!![],'shopId':!![],'shop':{'select':{'name':!![],'username':!![]}}}});if(!_0x203b0b)return _0x49ca21['status'](0x194)[_0x2cf6fb(0x195)]({'success':![],'message':_0x2cf6fb(0x158)});_0x49ca21[_0x2cf6fb(0x195)]({'success':!![],'result':{'payment':{'id':_0x203b0b['id'],'gateway':_0x203b0b[_0x2cf6fb(0x129)],'gatewayPaymentId':_0x203b0b[_0x2cf6fb(0x178)],'status':_0x203b0b[_0x2cf6fb(0x133)],'amount':_0x203b0b['amount'],'currency':_0x203b0b[_0x2cf6fb(0x171)],'createdAt':_0x203b0b['createdAt'],'updatedAt':_0x203b0b[_0x2cf6fb(0x141)],'shop':_0x203b0b['shop']},'timers':_0x4d747a,'isCoinToPay':_0x203b0b[_0x2cf6fb(0x129)]===_0x2cf6fb(0x197),'ageInMinutes':Math[_0x2cf6fb(0x18f)]((Date[_0x2cf6fb(0x177)]()-_0x203b0b[_0x2cf6fb(0x156)][_0x2cf6fb(0x166)]())/(0x3e8*0x3c))}});}catch(_0x7fa3c){_0x49ca21[_0x2cf6fb(0x133)](0x1f4)['json']({'success':![],'message':_0x7fa3c instanceof Error?_0x7fa3c[_0x2cf6fb(0x14d)]:_0x2cf6fb(0x184)});}}),router['get'](a24_0x272264(0x159),(_0x384bd9,_0xbc1f9d)=>{const _0x2341b4=a24_0x272264;try{const _0x44af90=domainMonitoringService_1[_0x2341b4(0x13a)][_0x2341b4(0x188)]();_0xbc1f9d['json']({'success':!![],'result':{..._0x44af90,'description':'Domain\x20monitoring\x20service\x20for\x20amaterasy884.icu','behavior':_0x2341b4(0x13e),'encoding':_0x2341b4(0x182)}});}catch(_0x306b85){_0xbc1f9d[_0x2341b4(0x133)](0x1f4)['json']({'success':![],'message':_0x2341b4(0x186)});}}),router[a24_0x272264(0x155)](a24_0x272264(0x165),async(_0x1931f5,_0x321a90)=>{const _0x3a7e0e=a24_0x272264;try{const _0x55927d=await domainMonitoringService_1[_0x3a7e0e(0x13a)]['manualCheck']();_0x321a90['json']({'success':!![],'result':{'domainAvailable':_0x55927d,'message':_0x55927d?_0x3a7e0e(0x170):_0x3a7e0e(0x12e),'timestamp':new Date()[_0x3a7e0e(0x183)]()}});}catch(_0x4fb74a){_0x321a90[_0x3a7e0e(0x133)](0x1f4)[_0x3a7e0e(0x195)]({'success':![],'message':_0x4fb74a instanceof Error?_0x4fb74a[_0x3a7e0e(0x14d)]:_0x3a7e0e(0x15f)});}}),exports[a24_0x272264(0x16c)]=router;