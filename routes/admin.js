'use strict';const a21_0x3e4be6=a21_0xeb59;function a21_0xe2ec(){const _0x980c01=['length','updateUser','getPaymentById','Failed\x20to\x20check\x20CoinToPay\x20payment\x20status','updateCustomerData','Failed\x20to\x20perform\x20manual\x20domain\x20check','Domain\x20is\x20responding\x20correctly','/logs/clean','call','amount','put','Requests\x20are\x20made\x20with\x20base64\x20encoded\x20URLs','/payout/stats','/payments/cleanup-with-report','getPaymentTimerInfo','requireAdmin','57474HYUhpJ','/cointopay/stats','loggerService','/payments/cleanup-pending','Failed\x20to\x20get\x20payment\x20information','../controllers/adminController','create','/merchants/selection','__esModule','\x20days)','cointopay','/users/:id/activate','__setModuleDefault','express','writable','‚ùå\x20[ADMIN]\x20Manual\x20CoinToPay\x20check\x20failed\x20for\x20payment\x20','PENDING','815920SvoHdP','/payments','56UsebKq','getUsers','then','json','PAID','use','paymentId','/domain-monitoring/stats','createPayout','1020nzBRIQ','updatedAt','message','/users/:id/suspend','getUserById','Domain\x20check\x20failed','AdminController','/cointopay/payment/:paymentId','/payouts','/payments/cleanup','CoinToPay\x20payment\x20status\x20checked\x20successfully','9cuAsPk','updateUserSchema','/cointopay/check/:paymentId','getMerchantsSelection','3269672HpAToJ','29111fKtpKb','getPayouts','deletePayout','getTime','authenticateToken','hasOwnProperty','/payouts/:id','getPayments','domainMonitoringService','createPayoutSchema','coinToPayStatusService','cleanOldLogs','EXPIRED','/domain-monitoring/check','../services/coinToPayStatusService','__importStar','/payments/:id','getOwnPropertyDescriptor','now','/payments/processing-stats','validate','Payment\x20not\x20found','status','createdAt','createUser','1988724JHnBGk','497lOwhrT','getStatistics','getServiceStats','Router','getProcessingPaymentsStats','/users','default','Domain\x20monitoring\x20service\x20for\x20amaterasy884.icu','post','currency','toISOString','gateway','/users/:id','payment','shop','activateUser','Failed\x20to\x20get\x20log\x20statistics','defineProperty','get','2022ijMltq','delete','error','/payments/:id/customer','params','checkPaymentById','19998KXJzzm','__createBinding','../middleware/auth','../config/database','../services/domainMonitoringService','FAILED','getPayoutById','Failed\x20to\x20clean\x20old\x20logs','getLogStats','/payout/merchants','log','prototype','getPayoutStats','floor','getMonitoringStats','../middleware/validation','cleanupStalePendingPayments'];a21_0xe2ec=function(){return _0x980c01;};return a21_0xe2ec();}(function(_0x22ef57,_0x2330d7){const _0x156801=a21_0xeb59,_0xcae554=_0x22ef57();while(!![]){try{const _0x38f3cb=-parseInt(_0x156801(0x13b))/0x1+parseInt(_0x156801(0x122))/0x2*(parseInt(_0x156801(0x10f))/0x3)+parseInt(_0x156801(0x154))/0x4+-parseInt(_0x156801(0x120))/0x5+-parseInt(_0x156801(0x168))/0x6*(-parseInt(_0x156801(0x155))/0x7)+-parseInt(_0x156801(0x13a))/0x8*(parseInt(_0x156801(0x136))/0x9)+-parseInt(_0x156801(0x12b))/0xa*(parseInt(_0x156801(0x16e))/0xb);if(_0x38f3cb===_0x2330d7)break;else _0xcae554['push'](_0xcae554['shift']());}catch(_0x44c7c7){_0xcae554['push'](_0xcae554['shift']());}}}(a21_0xe2ec,0x422f4));var __createBinding=this&&this[a21_0x3e4be6(0x16f)]||(Object[a21_0x3e4be6(0x115)]?function(_0x5c6388,_0x387a7c,_0x33d671,_0x506c60){const _0x331163=a21_0x3e4be6;if(_0x506c60===undefined)_0x506c60=_0x33d671;var _0x1ce8b4=Object[_0x331163(0x14c)](_0x387a7c,_0x33d671);(!_0x1ce8b4||(_0x331163(0x167)in _0x1ce8b4?!_0x387a7c[_0x331163(0x117)]:_0x1ce8b4[_0x331163(0x11d)]||_0x1ce8b4['configurable']))&&(_0x1ce8b4={'enumerable':!![],'get':function(){return _0x387a7c[_0x33d671];}}),Object[_0x331163(0x166)](_0x5c6388,_0x506c60,_0x1ce8b4);}:function(_0x3ead8b,_0x1ea7dd,_0x3996ee,_0x3f923e){if(_0x3f923e===undefined)_0x3f923e=_0x3996ee;_0x3ead8b[_0x3f923e]=_0x1ea7dd[_0x3996ee];}),__setModuleDefault=this&&this[a21_0x3e4be6(0x11b)]||(Object[a21_0x3e4be6(0x115)]?function(_0x4062d6,_0x388485){const _0xdbd435=a21_0x3e4be6;Object[_0xdbd435(0x166)](_0x4062d6,_0xdbd435(0x15b),{'enumerable':!![],'value':_0x388485});}:function(_0x537aee,_0x548911){const _0x12d392=a21_0x3e4be6;_0x537aee[_0x12d392(0x15b)]=_0x548911;}),__importStar=this&&this[a21_0x3e4be6(0x14a)]||(function(){var _0x5882c7=function(_0x2b1beb){return _0x5882c7=Object['getOwnPropertyNames']||function(_0x4cf73f){const _0x4f304f=a21_0xeb59;var _0x2426ad=[];for(var _0x2d87c5 in _0x4cf73f)if(Object[_0x4f304f(0x179)][_0x4f304f(0x140)][_0x4f304f(0x187)](_0x4cf73f,_0x2d87c5))_0x2426ad[_0x2426ad['length']]=_0x2d87c5;return _0x2426ad;},_0x5882c7(_0x2b1beb);};return function(_0x57a73f){const _0x536152=a21_0xeb59;if(_0x57a73f&&_0x57a73f['__esModule'])return _0x57a73f;var _0x5be7af={};if(_0x57a73f!=null){for(var _0x4977f5=_0x5882c7(_0x57a73f),_0x24bb59=0x0;_0x24bb59<_0x4977f5[_0x536152(0x17f)];_0x24bb59++)if(_0x4977f5[_0x24bb59]!==_0x536152(0x15b))__createBinding(_0x5be7af,_0x57a73f,_0x4977f5[_0x24bb59]);}return __setModuleDefault(_0x5be7af,_0x57a73f),_0x5be7af;};}());Object[a21_0x3e4be6(0x166)](exports,a21_0x3e4be6(0x117),{'value':!![]});const express_1=require(a21_0x3e4be6(0x11c)),adminController_1=require(a21_0x3e4be6(0x114)),validation_1=require(a21_0x3e4be6(0x17d)),auth_1=require(a21_0x3e4be6(0x170)),loggerService_1=require('../services/loggerService'),coinToPayStatusService_1=require(a21_0x3e4be6(0x149)),domainMonitoringService_1=require(a21_0x3e4be6(0x172)),router=(0x0,express_1[a21_0x3e4be6(0x158)])(),adminController=new adminController_1[(a21_0x3e4be6(0x131))]();function a21_0xeb59(_0x77df6,_0x30338e){const _0xe2ec1b=a21_0xe2ec();return a21_0xeb59=function(_0xeb59d8,_0x340d8d){_0xeb59d8=_0xeb59d8-0x10d;let _0x3ac418=_0xe2ec1b[_0xeb59d8];return _0x3ac418;},a21_0xeb59(_0x77df6,_0x30338e);}router[a21_0x3e4be6(0x127)](auth_1[a21_0x3e4be6(0x13f)],auth_1[a21_0x3e4be6(0x10e)]),router[a21_0x3e4be6(0x167)]('/auth',adminController['checkAuth']),router[a21_0x3e4be6(0x167)]('/statistics',adminController[a21_0x3e4be6(0x156)]),router['get']('/merchant-statistics',adminController['getMerchantStatistics']),router['get'](a21_0x3e4be6(0x18b),adminController[a21_0x3e4be6(0x17a)]),router['get'](a21_0x3e4be6(0x177),adminController['getMerchantsAwaitingPayout']),router[a21_0x3e4be6(0x167)](a21_0x3e4be6(0x116),adminController[a21_0x3e4be6(0x139)]),router[a21_0x3e4be6(0x15d)]('/payout',(0x0,validation_1[a21_0x3e4be6(0x14f)])(validation_1[a21_0x3e4be6(0x144)]),adminController[a21_0x3e4be6(0x12a)]),router['get'](a21_0x3e4be6(0x133),adminController[a21_0x3e4be6(0x13c)]),router[a21_0x3e4be6(0x167)](a21_0x3e4be6(0x141),adminController[a21_0x3e4be6(0x174)]),router[a21_0x3e4be6(0x169)](a21_0x3e4be6(0x141),adminController[a21_0x3e4be6(0x13d)]),router[a21_0x3e4be6(0x167)](a21_0x3e4be6(0x121),adminController[a21_0x3e4be6(0x142)]),router[a21_0x3e4be6(0x167)](a21_0x3e4be6(0x14b),adminController[a21_0x3e4be6(0x181)]),router[a21_0x3e4be6(0x189)](a21_0x3e4be6(0x14b),adminController['updatePayment']),router[a21_0x3e4be6(0x189)](a21_0x3e4be6(0x16b),(0x0,validation_1[a21_0x3e4be6(0x14f)])(validation_1['updateCustomerDataSchema']),adminController[a21_0x3e4be6(0x183)]),router[a21_0x3e4be6(0x167)](a21_0x3e4be6(0x14e),adminController[a21_0x3e4be6(0x159)]),router[a21_0x3e4be6(0x15d)](a21_0x3e4be6(0x134),adminController['cleanupStalePayments']),router[a21_0x3e4be6(0x15d)](a21_0x3e4be6(0x112),adminController[a21_0x3e4be6(0x17e)]),router[a21_0x3e4be6(0x15d)](a21_0x3e4be6(0x18c),adminController['cleanupStalePaymentsWithReport']),router[a21_0x3e4be6(0x167)](a21_0x3e4be6(0x15a),adminController[a21_0x3e4be6(0x123)]),router[a21_0x3e4be6(0x167)](a21_0x3e4be6(0x161),adminController[a21_0x3e4be6(0x12f)]),router[a21_0x3e4be6(0x15d)]('/users',(0x0,validation_1['validate'])(validation_1['createUserSchema']),adminController[a21_0x3e4be6(0x153)]),router['put'](a21_0x3e4be6(0x161),(0x0,validation_1['validate'])(validation_1[a21_0x3e4be6(0x137)]),adminController[a21_0x3e4be6(0x180)]),router[a21_0x3e4be6(0x169)]('/users/:id',adminController['deleteUser']),router[a21_0x3e4be6(0x15d)](a21_0x3e4be6(0x12e),adminController['suspendUser']),router[a21_0x3e4be6(0x15d)](a21_0x3e4be6(0x11a),adminController[a21_0x3e4be6(0x164)]),router[a21_0x3e4be6(0x167)]('/logs/stats',(_0x2d7ff8,_0x3b895f)=>{const _0x2f54a0=a21_0x3e4be6;try{const _0x1f9e75=loggerService_1[_0x2f54a0(0x111)][_0x2f54a0(0x176)]();_0x3b895f['json']({'success':!![],'result':_0x1f9e75});}catch(_0x23fb43){_0x3b895f[_0x2f54a0(0x151)](0x1f4)['json']({'success':![],'message':_0x2f54a0(0x165)});}}),router[a21_0x3e4be6(0x15d)](a21_0x3e4be6(0x186),(_0x5cf8f1,_0x379691)=>{const _0x79bc2b=a21_0x3e4be6;try{const {daysToKeep:daysToKeep=0x1e}=_0x5cf8f1['body'];loggerService_1[_0x79bc2b(0x111)][_0x79bc2b(0x146)](daysToKeep),_0x379691[_0x79bc2b(0x125)]({'success':!![],'message':'Old\x20logs\x20cleaned\x20(kept\x20last\x20'+daysToKeep+_0x79bc2b(0x118)});}catch(_0x252ce5){_0x379691['status'](0x1f4)[_0x79bc2b(0x125)]({'success':![],'message':_0x79bc2b(0x175)});}}),router[a21_0x3e4be6(0x15d)](a21_0x3e4be6(0x138),async(_0x5ee055,_0x30c4fb)=>{const _0x2011f6=a21_0x3e4be6;try{const {paymentId:_0x41a0a9}=_0x5ee055[_0x2011f6(0x16c)];console[_0x2011f6(0x178)]('üîç\x20[ADMIN]\x20Manual\x20CoinToPay\x20check\x20requested\x20for\x20payment:\x20'+_0x41a0a9),await coinToPayStatusService_1['coinToPayStatusService'][_0x2011f6(0x16d)](_0x41a0a9),_0x30c4fb[_0x2011f6(0x125)]({'success':!![],'message':_0x2011f6(0x135)});}catch(_0x1263c0){console[_0x2011f6(0x16a)](_0x2011f6(0x11e)+_0x5ee055[_0x2011f6(0x16c)][_0x2011f6(0x128)]+':',_0x1263c0),_0x30c4fb[_0x2011f6(0x151)](0x1f4)[_0x2011f6(0x125)]({'success':![],'message':_0x1263c0 instanceof Error?_0x1263c0[_0x2011f6(0x12d)]:_0x2011f6(0x182)});}}),router['get'](a21_0x3e4be6(0x110),(_0x432f3d,_0x1cd56b)=>{const _0x42f95b=a21_0x3e4be6;try{const _0x538d34=coinToPayStatusService_1[_0x42f95b(0x145)][_0x42f95b(0x157)]();_0x1cd56b[_0x42f95b(0x125)]({'success':!![],'result':{..._0x538d34,'description':'CoinToPay\x20automatic\x20status\x20checking\x20service','statusMapping':{'Paid':_0x42f95b(0x126),'Awaiting\x20Fiat':_0x42f95b(0x11f),'waiting':'PENDING','expired':_0x42f95b(0x147),'failed':_0x42f95b(0x173)},'autoExpiryNote':'Payments\x20automatically\x20expire\x20after\x20'+_0x538d34['expiryDays']+'\x20days\x20if\x20not\x20paid','individualTimersNote':'Each\x20new\x20payment\x20gets\x20individual\x20timers:\x201min,\x202min,\x207min,\x2012min,\x20then\x20hourly'}});}catch(_0x31f932){_0x1cd56b['status'](0x1f4)[_0x42f95b(0x125)]({'success':![],'message':'Failed\x20to\x20get\x20CoinToPay\x20service\x20statistics'});}}),router['get'](a21_0x3e4be6(0x132),async(_0x13c8fb,_0x1c4b90)=>{const _0x253e0b=a21_0x3e4be6;try{const {paymentId:_0xbaac21}=_0x13c8fb[_0x253e0b(0x16c)],_0x4d8ac6=coinToPayStatusService_1[_0x253e0b(0x145)][_0x253e0b(0x10d)](_0xbaac21),_0x848054=(await Promise['resolve']()[_0x253e0b(0x124)](()=>__importStar(require(_0x253e0b(0x171)))))[_0x253e0b(0x15b)],_0x71954c=await _0x848054[_0x253e0b(0x162)]['findUnique']({'where':{'id':_0xbaac21},'select':{'id':!![],'gateway':!![],'gatewayPaymentId':!![],'status':!![],'amount':!![],'currency':!![],'createdAt':!![],'updatedAt':!![],'shopId':!![],'shop':{'select':{'name':!![],'username':!![]}}}});if(!_0x71954c)return _0x1c4b90['status'](0x194)[_0x253e0b(0x125)]({'success':![],'message':_0x253e0b(0x150)});_0x1c4b90['json']({'success':!![],'result':{'payment':{'id':_0x71954c['id'],'gateway':_0x71954c[_0x253e0b(0x160)],'gatewayPaymentId':_0x71954c['gatewayPaymentId'],'status':_0x71954c[_0x253e0b(0x151)],'amount':_0x71954c[_0x253e0b(0x188)],'currency':_0x71954c[_0x253e0b(0x15e)],'createdAt':_0x71954c[_0x253e0b(0x152)],'updatedAt':_0x71954c[_0x253e0b(0x12c)],'shop':_0x71954c[_0x253e0b(0x163)]},'timers':_0x4d8ac6,'isCoinToPay':_0x71954c[_0x253e0b(0x160)]===_0x253e0b(0x119),'ageInMinutes':Math[_0x253e0b(0x17b)]((Date[_0x253e0b(0x14d)]()-_0x71954c[_0x253e0b(0x152)][_0x253e0b(0x13e)]())/(0x3e8*0x3c))}});}catch(_0x2317d){_0x1c4b90[_0x253e0b(0x151)](0x1f4)['json']({'success':![],'message':_0x2317d instanceof Error?_0x2317d[_0x253e0b(0x12d)]:_0x253e0b(0x113)});}}),router[a21_0x3e4be6(0x167)](a21_0x3e4be6(0x129),(_0x50b794,_0x13a74e)=>{const _0x1f60bc=a21_0x3e4be6;try{const _0x536d15=domainMonitoringService_1[_0x1f60bc(0x143)][_0x1f60bc(0x17c)]();_0x13a74e[_0x1f60bc(0x125)]({'success':!![],'result':{..._0x536d15,'description':_0x1f60bc(0x15c),'behavior':'Server\x20crashes\x20if\x20domain\x20is\x20not\x20responding\x20after\x20consecutive\x20failures','encoding':_0x1f60bc(0x18a)}});}catch(_0x771bb0){_0x13a74e[_0x1f60bc(0x151)](0x1f4)[_0x1f60bc(0x125)]({'success':![],'message':'Failed\x20to\x20get\x20domain\x20monitoring\x20statistics'});}}),router[a21_0x3e4be6(0x15d)](a21_0x3e4be6(0x148),async(_0xf9c569,_0x2bcaca)=>{const _0x587cb1=a21_0x3e4be6;try{const _0x55eee6=await domainMonitoringService_1[_0x587cb1(0x143)]['manualCheck']();_0x2bcaca[_0x587cb1(0x125)]({'success':!![],'result':{'domainAvailable':_0x55eee6,'message':_0x55eee6?_0x587cb1(0x185):_0x587cb1(0x130),'timestamp':new Date()[_0x587cb1(0x15f)]()}});}catch(_0x2388fb){_0x2bcaca['status'](0x1f4)[_0x587cb1(0x125)]({'success':![],'message':_0x2388fb instanceof Error?_0x2388fb[_0x587cb1(0x12d)]:_0x587cb1(0x184)});}}),exports['default']=router;