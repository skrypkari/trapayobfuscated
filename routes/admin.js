'use strict';function a21_0x4274(_0x5ec11c,_0x293a9e){const _0x327251=a21_0x3272();return a21_0x4274=function(_0x427404,_0x36622d){_0x427404=_0x427404-0x196;let _0x307785=_0x327251[_0x427404];return _0x307785;},a21_0x4274(_0x5ec11c,_0x293a9e);}const a21_0x5dd17f=a21_0x4274;function a21_0x3272(){const _0x2b2efe=['createUser','updatedAt','status','/payout/stats','/payout/merchants','loggerService','CoinToPay\x20payment\x20status\x20checked\x20successfully','call','shop','/users/:id','coinToPayStatusService','/payments/cleanup-pending','hasOwnProperty','getPayouts','writable','/payouts/:id','/payments/:id/customer','/auth','5VfMPlD','findUnique','/cointopay/stats','post','../middleware/auth','34370dnyJAi','message','getMerchantsAwaitingPayout','updateUserSchema','activateUser','1368GzpifK','__setModuleDefault','manualCheck','AdminController','updateCustomerData','../services/coinToPayStatusService','/payments/cleanup','createPayout','then','log','amount','/payments/:id','Failed\x20to\x20get\x20payment\x20information','json','gatewayPaymentId','deleteUser','express','put','../middleware/validation','2934RYbxHh','gateway','paymentId','\x20days\x20if\x20not\x20paid','354216SOJzFV','/merchants/selection','/merchant-statistics','../services/domainMonitoringService','get','__importStar','now','validate','Failed\x20to\x20clean\x20old\x20logs','configurable','/cointopay/payment/:paymentId','getMerchantStatistics','Old\x20logs\x20cleaned\x20(kept\x20last\x20','1547231EgnNRw','/domain-monitoring/check','Domain\x20is\x20responding\x20correctly','default','requireAdmin','delete','updatePayment','Requests\x20are\x20made\x20with\x20base64\x20encoded\x20URLs','Server\x20crashes\x20if\x20domain\x20is\x20not\x20responding\x20after\x20consecutive\x20failures','Failed\x20to\x20get\x20domain\x20monitoring\x20statistics','getUsers','toISOString','error','/users','Failed\x20to\x20get\x20CoinToPay\x20service\x20statistics','getMerchantsSelection','\x20days)','2032XPJXJA','checkPaymentById','/payout','/statistics','/users/:id/suspend','create','/payments/cleanup-with-report','getLogStats','prototype','üîç\x20[ADMIN]\x20Manual\x20CoinToPay\x20check\x20requested\x20for\x20payment:\x20','EXPIRED','currency','1321iEDMeH','Payment\x20not\x20found','payment','PENDING','expiryDays','getPaymentTimerInfo','defineProperty','38681112OyJGpk','cleanOldLogs','getPaymentById','10009318eIBHHd','use','cleanupStalePayments','domainMonitoringService','13575AUwxRm','/payments','getStatistics','params','getServiceStats','32PMRNvw','getPayoutStats','length','‚ùå\x20[ADMIN]\x20Manual\x20CoinToPay\x20check\x20failed\x20for\x20payment\x20','__esModule','getProcessingPaymentsStats','authenticateToken','/payouts','getOwnPropertyNames'];a21_0x3272=function(){return _0x2b2efe;};return a21_0x3272();}(function(_0x7b860f,_0x55ab47){const _0x5b36e0=a21_0x4274,_0x1b3116=_0x7b860f();while(!![]){try{const _0x152eef=-parseInt(_0x5b36e0(0x1e8))/0x1*(-parseInt(_0x5b36e0(0x1dc))/0x2)+parseInt(_0x5b36e0(0x1f6))/0x3*(parseInt(_0x5b36e0(0x1a7))/0x4)+-parseInt(_0x5b36e0(0x19d))/0x5*(-parseInt(_0x5b36e0(0x1be))/0x6)+-parseInt(_0x5b36e0(0x1cb))/0x7*(-parseInt(_0x5b36e0(0x1fb))/0x8)+parseInt(_0x5b36e0(0x1ba))/0x9*(parseInt(_0x5b36e0(0x1a2))/0xa)+-parseInt(_0x5b36e0(0x1f2))/0xb+-parseInt(_0x5b36e0(0x1ef))/0xc;if(_0x152eef===_0x55ab47)break;else _0x1b3116['push'](_0x1b3116['shift']());}catch(_0x2e7be3){_0x1b3116['push'](_0x1b3116['shift']());}}}(a21_0x3272,0xc82f0));var __createBinding=this&&this['__createBinding']||(Object[a21_0x5dd17f(0x1e1)]?function(_0x50c7a4,_0x83e4eb,_0x56c0c7,_0x38f1bc){const _0x425f64=a21_0x5dd17f;if(_0x38f1bc===undefined)_0x38f1bc=_0x56c0c7;var _0x44f816=Object['getOwnPropertyDescriptor'](_0x83e4eb,_0x56c0c7);(!_0x44f816||(_0x425f64(0x1c2)in _0x44f816?!_0x83e4eb[_0x425f64(0x1ff)]:_0x44f816[_0x425f64(0x199)]||_0x44f816[_0x425f64(0x1c7)]))&&(_0x44f816={'enumerable':!![],'get':function(){return _0x83e4eb[_0x56c0c7];}}),Object[_0x425f64(0x1ee)](_0x50c7a4,_0x38f1bc,_0x44f816);}:function(_0x4fa449,_0x4c2ee2,_0x2937fe,_0x2d68b9){if(_0x2d68b9===undefined)_0x2d68b9=_0x2937fe;_0x4fa449[_0x2d68b9]=_0x4c2ee2[_0x2937fe];}),__setModuleDefault=this&&this[a21_0x5dd17f(0x1a8)]||(Object[a21_0x5dd17f(0x1e1)]?function(_0x31e370,_0x1cff1c){const _0x582d43=a21_0x5dd17f;Object[_0x582d43(0x1ee)](_0x31e370,'default',{'enumerable':!![],'value':_0x1cff1c});}:function(_0x5f30c5,_0xc0a5){const _0x56c13d=a21_0x5dd17f;_0x5f30c5[_0x56c13d(0x1ce)]=_0xc0a5;}),__importStar=this&&this[a21_0x5dd17f(0x1c3)]||(function(){var _0x35a739=function(_0x50d7c8){const _0x5aea27=a21_0x4274;return _0x35a739=Object[_0x5aea27(0x203)]||function(_0x5b90b2){const _0x37ced3=_0x5aea27;var _0x9c8577=[];for(var _0x2b58b6 in _0x5b90b2)if(Object[_0x37ced3(0x1e4)][_0x37ced3(0x197)][_0x37ced3(0x20b)](_0x5b90b2,_0x2b58b6))_0x9c8577[_0x9c8577[_0x37ced3(0x1fd)]]=_0x2b58b6;return _0x9c8577;},_0x35a739(_0x50d7c8);};return function(_0x50fa06){const _0x1f8d72=a21_0x4274;if(_0x50fa06&&_0x50fa06['__esModule'])return _0x50fa06;var _0x4e6594={};if(_0x50fa06!=null){for(var _0x42158a=_0x35a739(_0x50fa06),_0x2ba903=0x0;_0x2ba903<_0x42158a[_0x1f8d72(0x1fd)];_0x2ba903++)if(_0x42158a[_0x2ba903]!==_0x1f8d72(0x1ce))__createBinding(_0x4e6594,_0x50fa06,_0x42158a[_0x2ba903]);}return __setModuleDefault(_0x4e6594,_0x50fa06),_0x4e6594;};}());Object[a21_0x5dd17f(0x1ee)](exports,a21_0x5dd17f(0x1ff),{'value':!![]});const express_1=require(a21_0x5dd17f(0x1b7)),adminController_1=require('../controllers/adminController'),validation_1=require(a21_0x5dd17f(0x1b9)),auth_1=require(a21_0x5dd17f(0x1a1)),loggerService_1=require('../services/loggerService'),coinToPayStatusService_1=require(a21_0x5dd17f(0x1ac)),domainMonitoringService_1=require(a21_0x5dd17f(0x1c1)),router=(0x0,express_1['Router'])(),adminController=new adminController_1[(a21_0x5dd17f(0x1aa))]();router[a21_0x5dd17f(0x1f3)](auth_1[a21_0x5dd17f(0x201)],auth_1[a21_0x5dd17f(0x1cf)]),router['get'](a21_0x5dd17f(0x19c),adminController['checkAuth']),router[a21_0x5dd17f(0x1c2)](a21_0x5dd17f(0x1df),adminController[a21_0x5dd17f(0x1f8)]),router['get'](a21_0x5dd17f(0x1c0),adminController[a21_0x5dd17f(0x1c9)]),router[a21_0x5dd17f(0x1c2)](a21_0x5dd17f(0x207),adminController[a21_0x5dd17f(0x1fc)]),router[a21_0x5dd17f(0x1c2)](a21_0x5dd17f(0x208),adminController[a21_0x5dd17f(0x1a4)]),router[a21_0x5dd17f(0x1c2)](a21_0x5dd17f(0x1bf),adminController[a21_0x5dd17f(0x1da)]),router[a21_0x5dd17f(0x1a0)](a21_0x5dd17f(0x1de),(0x0,validation_1[a21_0x5dd17f(0x1c5)])(validation_1['createPayoutSchema']),adminController[a21_0x5dd17f(0x1ae)]),router[a21_0x5dd17f(0x1c2)](a21_0x5dd17f(0x202),adminController[a21_0x5dd17f(0x198)]),router[a21_0x5dd17f(0x1c2)](a21_0x5dd17f(0x19a),adminController['getPayoutById']),router[a21_0x5dd17f(0x1d0)](a21_0x5dd17f(0x19a),adminController['deletePayout']),router[a21_0x5dd17f(0x1c2)](a21_0x5dd17f(0x1f7),adminController['getPayments']),router[a21_0x5dd17f(0x1c2)](a21_0x5dd17f(0x1b2),adminController[a21_0x5dd17f(0x1f1)]),router[a21_0x5dd17f(0x1b8)](a21_0x5dd17f(0x1b2),adminController[a21_0x5dd17f(0x1d1)]),router[a21_0x5dd17f(0x1b8)](a21_0x5dd17f(0x19b),(0x0,validation_1[a21_0x5dd17f(0x1c5)])(validation_1['updateCustomerDataSchema']),adminController[a21_0x5dd17f(0x1ab)]),router[a21_0x5dd17f(0x1c2)]('/payments/processing-stats',adminController[a21_0x5dd17f(0x200)]),router[a21_0x5dd17f(0x1a0)](a21_0x5dd17f(0x1ad),adminController[a21_0x5dd17f(0x1f4)]),router['post'](a21_0x5dd17f(0x196),adminController['cleanupStalePendingPayments']),router[a21_0x5dd17f(0x1a0)](a21_0x5dd17f(0x1e2),adminController['cleanupStalePaymentsWithReport']),router[a21_0x5dd17f(0x1c2)](a21_0x5dd17f(0x1d8),adminController[a21_0x5dd17f(0x1d5)]),router[a21_0x5dd17f(0x1c2)]('/users/:id',adminController['getUserById']),router[a21_0x5dd17f(0x1a0)](a21_0x5dd17f(0x1d8),(0x0,validation_1['validate'])(validation_1['createUserSchema']),adminController[a21_0x5dd17f(0x204)]),router['put']('/users/:id',(0x0,validation_1[a21_0x5dd17f(0x1c5)])(validation_1[a21_0x5dd17f(0x1a5)]),adminController['updateUser']),router[a21_0x5dd17f(0x1d0)](a21_0x5dd17f(0x20d),adminController[a21_0x5dd17f(0x1b6)]),router[a21_0x5dd17f(0x1a0)](a21_0x5dd17f(0x1e0),adminController['suspendUser']),router[a21_0x5dd17f(0x1a0)]('/users/:id/activate',adminController[a21_0x5dd17f(0x1a6)]),router['get']('/logs/stats',(_0x2aa996,_0x581ffa)=>{const _0x44c793=a21_0x5dd17f;try{const _0x439ca5=loggerService_1[_0x44c793(0x209)][_0x44c793(0x1e3)]();_0x581ffa[_0x44c793(0x1b4)]({'success':!![],'result':_0x439ca5});}catch(_0x3f054c){_0x581ffa[_0x44c793(0x206)](0x1f4)[_0x44c793(0x1b4)]({'success':![],'message':'Failed\x20to\x20get\x20log\x20statistics'});}}),router[a21_0x5dd17f(0x1a0)]('/logs/clean',(_0x30378d,_0xfef2af)=>{const _0x1ae0dd=a21_0x5dd17f;try{const {daysToKeep:daysToKeep=0x1e}=_0x30378d['body'];loggerService_1[_0x1ae0dd(0x209)][_0x1ae0dd(0x1f0)](daysToKeep),_0xfef2af[_0x1ae0dd(0x1b4)]({'success':!![],'message':_0x1ae0dd(0x1ca)+daysToKeep+_0x1ae0dd(0x1db)});}catch(_0x580310){_0xfef2af['status'](0x1f4)['json']({'success':![],'message':_0x1ae0dd(0x1c6)});}}),router[a21_0x5dd17f(0x1a0)]('/cointopay/check/:paymentId',async(_0x190c7d,_0x33a9ff)=>{const _0x3931a4=a21_0x5dd17f;try{const {paymentId:_0x33636a}=_0x190c7d[_0x3931a4(0x1f9)];console[_0x3931a4(0x1b0)](_0x3931a4(0x1e5)+_0x33636a),await coinToPayStatusService_1[_0x3931a4(0x20e)][_0x3931a4(0x1dd)](_0x33636a),_0x33a9ff[_0x3931a4(0x1b4)]({'success':!![],'message':_0x3931a4(0x20a)});}catch(_0x25b40c){console[_0x3931a4(0x1d7)](_0x3931a4(0x1fe)+_0x190c7d[_0x3931a4(0x1f9)][_0x3931a4(0x1bc)]+':',_0x25b40c),_0x33a9ff[_0x3931a4(0x206)](0x1f4)[_0x3931a4(0x1b4)]({'success':![],'message':_0x25b40c instanceof Error?_0x25b40c[_0x3931a4(0x1a3)]:'Failed\x20to\x20check\x20CoinToPay\x20payment\x20status'});}}),router[a21_0x5dd17f(0x1c2)](a21_0x5dd17f(0x19f),(_0x6d2ff5,_0x5515a8)=>{const _0x2ae774=a21_0x5dd17f;try{const _0x2e402f=coinToPayStatusService_1[_0x2ae774(0x20e)][_0x2ae774(0x1fa)]();_0x5515a8[_0x2ae774(0x1b4)]({'success':!![],'result':{..._0x2e402f,'description':'CoinToPay\x20automatic\x20status\x20checking\x20service','statusMapping':{'Paid':'PAID','Awaiting\x20Fiat':_0x2ae774(0x1eb),'waiting':_0x2ae774(0x1eb),'expired':_0x2ae774(0x1e6),'failed':'FAILED'},'autoExpiryNote':'Payments\x20automatically\x20expire\x20after\x20'+_0x2e402f[_0x2ae774(0x1ec)]+_0x2ae774(0x1bd),'individualTimersNote':'Each\x20new\x20payment\x20gets\x20individual\x20timers:\x201min,\x202min,\x207min,\x2012min,\x20then\x20hourly'}});}catch(_0x57b97f){_0x5515a8[_0x2ae774(0x206)](0x1f4)[_0x2ae774(0x1b4)]({'success':![],'message':_0x2ae774(0x1d9)});}}),router[a21_0x5dd17f(0x1c2)](a21_0x5dd17f(0x1c8),async(_0x9cf80f,_0x3f7f2c)=>{const _0x295c22=a21_0x5dd17f;try{const {paymentId:_0x11da11}=_0x9cf80f[_0x295c22(0x1f9)],_0x5c578a=coinToPayStatusService_1[_0x295c22(0x20e)][_0x295c22(0x1ed)](_0x11da11),_0x45013a=(await Promise['resolve']()[_0x295c22(0x1af)](()=>__importStar(require('../config/database'))))[_0x295c22(0x1ce)],_0x3d6c18=await _0x45013a[_0x295c22(0x1ea)][_0x295c22(0x19e)]({'where':{'id':_0x11da11},'select':{'id':!![],'gateway':!![],'gatewayPaymentId':!![],'status':!![],'amount':!![],'currency':!![],'createdAt':!![],'updatedAt':!![],'shopId':!![],'shop':{'select':{'name':!![],'username':!![]}}}});if(!_0x3d6c18)return _0x3f7f2c[_0x295c22(0x206)](0x194)[_0x295c22(0x1b4)]({'success':![],'message':_0x295c22(0x1e9)});_0x3f7f2c['json']({'success':!![],'result':{'payment':{'id':_0x3d6c18['id'],'gateway':_0x3d6c18[_0x295c22(0x1bb)],'gatewayPaymentId':_0x3d6c18[_0x295c22(0x1b5)],'status':_0x3d6c18[_0x295c22(0x206)],'amount':_0x3d6c18[_0x295c22(0x1b1)],'currency':_0x3d6c18[_0x295c22(0x1e7)],'createdAt':_0x3d6c18['createdAt'],'updatedAt':_0x3d6c18[_0x295c22(0x205)],'shop':_0x3d6c18[_0x295c22(0x20c)]},'timers':_0x5c578a,'isCoinToPay':_0x3d6c18[_0x295c22(0x1bb)]==='cointopay','ageInMinutes':Math['floor']((Date[_0x295c22(0x1c4)]()-_0x3d6c18['createdAt']['getTime']())/(0x3e8*0x3c))}});}catch(_0x4c0233){_0x3f7f2c[_0x295c22(0x206)](0x1f4)[_0x295c22(0x1b4)]({'success':![],'message':_0x4c0233 instanceof Error?_0x4c0233[_0x295c22(0x1a3)]:_0x295c22(0x1b3)});}}),router[a21_0x5dd17f(0x1c2)]('/domain-monitoring/stats',(_0x56cc00,_0x514890)=>{const _0x4484e2=a21_0x5dd17f;try{const _0x35f421=domainMonitoringService_1['domainMonitoringService']['getMonitoringStats']();_0x514890[_0x4484e2(0x1b4)]({'success':!![],'result':{..._0x35f421,'description':'Domain\x20monitoring\x20service\x20for\x20amaterasy884.icu','behavior':_0x4484e2(0x1d3),'encoding':_0x4484e2(0x1d2)}});}catch(_0x2855cc){_0x514890['status'](0x1f4)[_0x4484e2(0x1b4)]({'success':![],'message':_0x4484e2(0x1d4)});}}),router[a21_0x5dd17f(0x1a0)](a21_0x5dd17f(0x1cc),async(_0x10d422,_0x7e5731)=>{const _0x46c8f9=a21_0x5dd17f;try{const _0x34822c=await domainMonitoringService_1[_0x46c8f9(0x1f5)][_0x46c8f9(0x1a9)]();_0x7e5731[_0x46c8f9(0x1b4)]({'success':!![],'result':{'domainAvailable':_0x34822c,'message':_0x34822c?_0x46c8f9(0x1cd):'Domain\x20check\x20failed','timestamp':new Date()[_0x46c8f9(0x1d6)]()}});}catch(_0x11f950){_0x7e5731[_0x46c8f9(0x206)](0x1f4)[_0x46c8f9(0x1b4)]({'success':![],'message':_0x11f950 instanceof Error?_0x11f950[_0x46c8f9(0x1a3)]:'Failed\x20to\x20perform\x20manual\x20domain\x20check'});}}),exports[a21_0x5dd17f(0x1ce)]=router;