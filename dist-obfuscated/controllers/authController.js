'use strict';function a4_0x4a80(_0x3478ed,_0x2b992a){const _0xeeb4ef=a4_0xeeb4();return a4_0x4a80=function(_0x4a805f,_0xa6c8dd){_0x4a805f=_0x4a805f-0x157;let _0x41b86d=_0xeeb4ef[_0x4a805f];return _0x41b86d;},a4_0x4a80(_0x3478ed,_0x2b992a);}const a4_0x1d2caa=a4_0x4a80;(function(_0x4043f5,_0x294b8b){const _0x1e2529=a4_0x4a80,_0x5b49f7=_0x4043f5();while(!![]){try{const _0x16061b=-parseInt(_0x1e2529(0x16f))/0x1*(-parseInt(_0x1e2529(0x158))/0x2)+-parseInt(_0x1e2529(0x178))/0x3*(-parseInt(_0x1e2529(0x16a))/0x4)+-parseInt(_0x1e2529(0x162))/0x5*(parseInt(_0x1e2529(0x168))/0x6)+parseInt(_0x1e2529(0x188))/0x7*(-parseInt(_0x1e2529(0x169))/0x8)+-parseInt(_0x1e2529(0x186))/0x9*(parseInt(_0x1e2529(0x177))/0xa)+-parseInt(_0x1e2529(0x17f))/0xb+parseInt(_0x1e2529(0x179))/0xc;if(_0x16061b===_0x294b8b)break;else _0x5b49f7['push'](_0x5b49f7['shift']());}catch(_0x105b5b){_0x5b49f7['push'](_0x5b49f7['shift']());}}}(a4_0xeeb4,0x66192));var __createBinding=this&&this['__createBinding']||(Object['create']?function(_0x5b35fc,_0x2399d0,_0xd3b300,_0x3b8f29){const _0x4215cc=a4_0x4a80;if(_0x3b8f29===undefined)_0x3b8f29=_0xd3b300;var _0x5365e8=Object[_0x4215cc(0x15d)](_0x2399d0,_0xd3b300);(!_0x5365e8||('get'in _0x5365e8?!_0x2399d0[_0x4215cc(0x160)]:_0x5365e8[_0x4215cc(0x161)]||_0x5365e8[_0x4215cc(0x15a)]))&&(_0x5365e8={'enumerable':!![],'get':function(){return _0x2399d0[_0xd3b300];}}),Object[_0x4215cc(0x17a)](_0x5b35fc,_0x3b8f29,_0x5365e8);}:function(_0x1eb827,_0x32ca55,_0xd8e831,_0x55f448){if(_0x55f448===undefined)_0x55f448=_0xd8e831;_0x1eb827[_0x55f448]=_0x32ca55[_0xd8e831];}),__setModuleDefault=this&&this[a4_0x1d2caa(0x157)]||(Object[a4_0x1d2caa(0x163)]?function(_0x2febcf,_0x4cb133){const _0x551ce8=a4_0x1d2caa;Object['defineProperty'](_0x2febcf,_0x551ce8(0x15c),{'enumerable':!![],'value':_0x4cb133});}:function(_0x169f5d,_0x3bfe33){const _0x44982a=a4_0x1d2caa;_0x169f5d[_0x44982a(0x15c)]=_0x3bfe33;}),__importStar=this&&this[a4_0x1d2caa(0x189)]||(function(){var _0x1df422=function(_0x42e1d6){return _0x1df422=Object['getOwnPropertyNames']||function(_0x549fde){const _0x1d59f9=a4_0x4a80;var _0x4f44e7=[];for(var _0x445d47 in _0x549fde)if(Object['prototype'][_0x1d59f9(0x176)][_0x1d59f9(0x170)](_0x549fde,_0x445d47))_0x4f44e7[_0x4f44e7[_0x1d59f9(0x182)]]=_0x445d47;return _0x4f44e7;},_0x1df422(_0x42e1d6);};return function(_0x1b22fc){const _0xae706c=a4_0x4a80;if(_0x1b22fc&&_0x1b22fc[_0xae706c(0x160)])return _0x1b22fc;var _0x40c5e6={};if(_0x1b22fc!=null){for(var _0x3b97fb=_0x1df422(_0x1b22fc),_0x365afe=0x0;_0x365afe<_0x3b97fb[_0xae706c(0x182)];_0x365afe++)if(_0x3b97fb[_0x365afe]!==_0xae706c(0x15c))__createBinding(_0x40c5e6,_0x1b22fc,_0x3b97fb[_0x365afe]);}return __setModuleDefault(_0x40c5e6,_0x1b22fc),_0x40c5e6;};}());Object['defineProperty'](exports,a4_0x1d2caa(0x160),{'value':!![]}),exports[a4_0x1d2caa(0x171)]=void 0x0;const authService_1=require(a4_0x1d2caa(0x187)),tokenBlacklistService_1=require(a4_0x1d2caa(0x17d)),telegramBotService_1=require(a4_0x1d2caa(0x173));function a4_0xeeb4(){const _0x318af6=['unknown','3171789RxRqBr','../services/authService','1848gsHNqf','__importStar','findUnique','__setModuleDefault','14tkRCVc','blacklistToken','configurable','error','default','getOwnPropertyDescriptor','json','body','__esModule','writable','75BpUyld','create','User-Agent','get','Failed\x20to\x20send\x20failed\x20login\x20notification:','sendLoginNotification','248454yAwWOd','2944WFWGut','232FPlInz','authService','user','connection','role','2457SowPWa','call','AuthController','resolve','../services/telegramBotService','exp','shop','hasOwnProperty','10NsxbyZ','27102FXNNpG','20468628kgEQGX','defineProperty','telegramBotService','username','../services/tokenBlacklistService','getBlacklistStats','8337868Iozdbi','login','then','length','../config/database','tokenBlacklistService'];a4_0xeeb4=function(){return _0x318af6;};return a4_0xeeb4();}class AuthController{constructor(){const _0x3320d8=a4_0x1d2caa;this[_0x3320d8(0x180)]=async(_0x41fc25,_0x237564,_0x4f4de3)=>{const _0x1d8b6c=_0x3320d8;try{const _0x55978f=_0x41fc25[_0x1d8b6c(0x15f)],_0x54a7c3=_0x41fc25['ip']||_0x41fc25[_0x1d8b6c(0x16d)]['remoteAddress']||_0x1d8b6c(0x185),_0x17b057=_0x41fc25[_0x1d8b6c(0x165)](_0x1d8b6c(0x164))||_0x1d8b6c(0x185);let _0x184787=![],_0x544b4a=null;try{const _0x1590ed=await this['authService'][_0x1d8b6c(0x180)](_0x55978f);_0x184787=!![],_0x1590ed[_0x1d8b6c(0x16e)]===_0x1d8b6c(0x175)&&_0x1590ed[_0x1d8b6c(0x16c)]?.['id']&&(_0x544b4a=_0x1590ed['user']['id']),_0x544b4a&&await telegramBotService_1[_0x1d8b6c(0x17b)][_0x1d8b6c(0x167)](_0x544b4a,{'username':_0x55978f[_0x1d8b6c(0x17c)],'ipAddress':_0x54a7c3,'userAgent':_0x17b057,'timestamp':new Date(),'success':!![]}),_0x237564[_0x1d8b6c(0x15e)]({'success':!![],'result':_0x1590ed});}catch(_0x4d55f3){try{const _0x5c8032=(await Promise[_0x1d8b6c(0x172)]()[_0x1d8b6c(0x181)](()=>__importStar(require(_0x1d8b6c(0x183)))))[_0x1d8b6c(0x15c)],_0x2a527d=await _0x5c8032[_0x1d8b6c(0x175)][_0x1d8b6c(0x18a)]({'where':{'username':_0x55978f[_0x1d8b6c(0x17c)]},'select':{'id':!![]}});_0x2a527d&&await telegramBotService_1[_0x1d8b6c(0x17b)][_0x1d8b6c(0x167)](_0x2a527d['id'],{'username':_0x55978f[_0x1d8b6c(0x17c)],'ipAddress':_0x54a7c3,'userAgent':_0x17b057,'timestamp':new Date(),'success':![]});}catch(_0x42268c){console[_0x1d8b6c(0x15b)](_0x1d8b6c(0x166),_0x42268c);}throw _0x4d55f3;}}catch(_0x46c81b){_0x4f4de3(_0x46c81b);}},this['me']=async(_0x2578d1,_0xf1663e,_0x3a5f16)=>{const _0xaca6ee=_0x3320d8;try{const _0x56a2c6=_0x2578d1['user'];_0xf1663e['json']({'success':!![],'result':{'id':_0x56a2c6?.['id'],'username':_0x56a2c6?.[_0xaca6ee(0x17c)],'role':_0x56a2c6?.['role']}});}catch(_0x6eb3f7){_0x3a5f16(_0x6eb3f7);}},this['logout']=async(_0x758ea9,_0x3297d7,_0x1cf1e9)=>{const _0x4927e3=_0x3320d8;try{const _0x3642cf=_0x758ea9['token'],_0x1ed344=_0x758ea9[_0x4927e3(0x16c)];_0x3642cf&&_0x1ed344?.[_0x4927e3(0x174)]&&tokenBlacklistService_1['tokenBlacklistService'][_0x4927e3(0x159)](_0x3642cf,_0x1ed344[_0x4927e3(0x174)]),_0x3297d7[_0x4927e3(0x15e)]({'success':!![],'message':'Logged\x20out\x20successfully'});}catch(_0x53b093){_0x1cf1e9(_0x53b093);}},this[_0x3320d8(0x17e)]=async(_0x596aef,_0x47d5c1,_0xa6e793)=>{const _0x2c2e98=_0x3320d8;try{const _0x2beb34=tokenBlacklistService_1[_0x2c2e98(0x184)]['getStats']();_0x47d5c1[_0x2c2e98(0x15e)]({'success':!![],'result':_0x2beb34});}catch(_0x243ce2){_0xa6e793(_0x243ce2);}},this[_0x3320d8(0x16b)]=new authService_1['AuthService']();}}exports[a4_0x1d2caa(0x171)]=AuthController;