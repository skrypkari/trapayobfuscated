'use strict';const a15_0x2437cf=a15_0x5a5b;(function(_0x299b9d,_0x3f866b){const _0x188794=a15_0x5a5b,_0x3a5d5d=_0x299b9d();while(!![]){try{const _0x1a8dd6=parseInt(_0x188794(0x12d))/0x1+-parseInt(_0x188794(0x138))/0x2+parseInt(_0x188794(0x135))/0x3+-parseInt(_0x188794(0x147))/0x4*(parseInt(_0x188794(0x129))/0x5)+parseInt(_0x188794(0x148))/0x6*(parseInt(_0x188794(0x143))/0x7)+-parseInt(_0x188794(0x128))/0x8*(-parseInt(_0x188794(0x140))/0x9)+parseInt(_0x188794(0x146))/0xa;if(_0x1a8dd6===_0x3f866b)break;else _0x3a5d5d['push'](_0x3a5d5d['shift']());}catch(_0x4ff900){_0x3a5d5d['push'](_0x3a5d5d['shift']());}}}(a15_0x4614,0xc6c8f));var __importDefault=this&&this[a15_0x2437cf(0x13a)]||function(_0x361d5e){const _0x3c886a=a15_0x2437cf;return _0x361d5e&&_0x361d5e[_0x3c886a(0x139)]?_0x361d5e:{'default':_0x361d5e};};Object[a15_0x2437cf(0x133)](exports,a15_0x2437cf(0x139),{'value':!![]}),exports[a15_0x2437cf(0x145)]=exports[a15_0x2437cf(0x12a)]=exports[a15_0x2437cf(0x13b)]=void 0x0;function a15_0x5a5b(_0x6eac8e,_0x2a47a9){const _0x4614e5=a15_0x4614();return a15_0x5a5b=function(_0x5a5b70,_0x309201){_0x5a5b70=_0x5a5b70-0x128;let _0x5ec536=_0x4614e5[_0x5a5b70];return _0x5ec536;},a15_0x5a5b(_0x6eac8e,_0x2a47a9);}const jsonwebtoken_1=__importDefault(require('jsonwebtoken')),config_1=require(a15_0x2437cf(0x132)),tokenBlacklistService_1=require(a15_0x2437cf(0x12b)),authenticateToken=(_0x21bdfe,_0x4c06e3,_0x52eeaf)=>{const _0x3f3db1=a15_0x2437cf,_0x42af55=_0x21bdfe[_0x3f3db1(0x142)]['authorization'],_0x2cc3cd=_0x42af55&&_0x42af55['split']('\x20')[0x1];if(!_0x2cc3cd)return _0x4c06e3[_0x3f3db1(0x137)](0x191)['json']({'success':![],'message':_0x3f3db1(0x149)});if(tokenBlacklistService_1[_0x3f3db1(0x12f)][_0x3f3db1(0x13e)](_0x2cc3cd))return _0x4c06e3[_0x3f3db1(0x137)](0x191)[_0x3f3db1(0x130)]({'success':![],'message':_0x3f3db1(0x13d)});jsonwebtoken_1['default'][_0x3f3db1(0x131)](_0x2cc3cd,config_1[_0x3f3db1(0x144)][_0x3f3db1(0x13c)][_0x3f3db1(0x136)],(_0x45553b,_0x1f5d2)=>{const _0x5c94b6=_0x3f3db1;if(_0x45553b)return _0x4c06e3[_0x5c94b6(0x137)](0x193)[_0x5c94b6(0x130)]({'success':![],'message':'Invalid\x20or\x20expired\x20token'});_0x21bdfe[_0x5c94b6(0x134)]=_0x1f5d2,_0x21bdfe['token']=_0x2cc3cd,_0x52eeaf();});};exports[a15_0x2437cf(0x13b)]=authenticateToken;const requireAdmin=(_0x5a9aec,_0x53d8c2,_0xc8a792)=>{const _0x5d3d29=a15_0x2437cf;if(!_0x5a9aec[_0x5d3d29(0x134)]||_0x5a9aec[_0x5d3d29(0x134)][_0x5d3d29(0x141)]!=='admin')return _0x53d8c2[_0x5d3d29(0x137)](0x193)[_0x5d3d29(0x130)]({'success':![],'message':_0x5d3d29(0x12c)});_0xc8a792();};exports[a15_0x2437cf(0x12a)]=requireAdmin;const requireShop=(_0x34cfa4,_0x22a8f3,_0x533026)=>{const _0x285750=a15_0x2437cf;if(!_0x34cfa4[_0x285750(0x134)]||_0x34cfa4['user'][_0x285750(0x141)]!==_0x285750(0x13f))return _0x22a8f3[_0x285750(0x137)](0x193)['json']({'success':![],'message':_0x285750(0x12e)});_0x533026();};function a15_0x4614(){const _0x4e9d0=['shop','2916xREyeB','role','headers','91kjSDuW','config','requireShop','6145400zRBZUZ','5430632tixKvm','273954KTOUGb','Access\x20token\x20required','10728TQEyBo','5RdJBmX','requireAdmin','../services/tokenBlacklistService','Admin\x20access\x20required','395587uEqrLW','Shop\x20access\x20required','tokenBlacklistService','json','verify','../config/config','defineProperty','user','2368851LCTuQs','secret','status','1311828WtmCgN','__esModule','__importDefault','authenticateToken','jwt','Token\x20has\x20been\x20revoked','isTokenBlacklisted'];a15_0x4614=function(){return _0x4e9d0;};return a15_0x4614();}exports[a15_0x2437cf(0x145)]=requireShop;