'use strict';const a34_0x5257f1=a34_0x14e4;(function(_0xbcfe2d,_0x52d963){const _0x148a20=a34_0x14e4,_0x1332d0=_0xbcfe2d();while(!![]){try{const _0x3e81bf=-parseInt(_0x148a20(0x13e))/0x1*(-parseInt(_0x148a20(0x132))/0x2)+-parseInt(_0x148a20(0x137))/0x3+-parseInt(_0x148a20(0x13b))/0x4*(parseInt(_0x148a20(0x145))/0x5)+parseInt(_0x148a20(0x140))/0x6+-parseInt(_0x148a20(0x128))/0x7*(parseInt(_0x148a20(0x133))/0x8)+-parseInt(_0x148a20(0x131))/0x9+-parseInt(_0x148a20(0x13d))/0xa*(-parseInt(_0x148a20(0x129))/0xb);if(_0x3e81bf===_0x52d963)break;else _0x1332d0['push'](_0x1332d0['shift']());}catch(_0x539f1d){_0x1332d0['push'](_0x1332d0['shift']());}}}(a34_0x2762,0x41e8c));function a34_0x14e4(_0x173163,_0x30ef62){const _0x276211=a34_0x2762();return a34_0x14e4=function(_0x14e495,_0x2c000f){_0x14e495=_0x14e495-0x128;let _0x2088fd=_0x276211[_0x14e495];return _0x2088fd;},a34_0x14e4(_0x173163,_0x30ef62);}var __importDefault=this&&this['__importDefault']||function(_0x4d4d1c){const _0x450410=a34_0x14e4;return _0x4d4d1c&&_0x4d4d1c[_0x450410(0x139)]?_0x4d4d1c:{'default':_0x4d4d1c};};Object['defineProperty'](exports,a34_0x5257f1(0x139),{'value':!![]}),exports[a34_0x5257f1(0x148)]=void 0x0;const bcryptjs_1=__importDefault(require('bcryptjs')),jsonwebtoken_1=__importDefault(require(a34_0x5257f1(0x138))),database_1=__importDefault(require(a34_0x5257f1(0x14b))),config_1=require(a34_0x5257f1(0x12e));function a34_0x2762(){const _0x4849d0=['expiresIn','4546125wIkquz','2zzKQCa','8ZwNnsH','name','sign','ACTIVE','620814LJbEsR','jsonwebtoken','__esModule','passwordHash','122372noueqi','jwt','30hZAFTO','253364KfxITq','secret','2329830FtWpNc','default','findUnique','compare','verify','60TRyjkb','username','password','AuthService','Account\x20is\x20not\x20active','config','../config/database','admin','269017OfaLNz','2734985vpRxsv','Invalid\x20credentials','generateToken','status','shop','../config/config','Invalid\x20token'];a34_0x2762=function(){return _0x4849d0;};return a34_0x2762();}class AuthService{[a34_0x5257f1(0x12b)](_0x1b412c){const _0x482150=a34_0x5257f1;return jsonwebtoken_1[_0x482150(0x141)][_0x482150(0x135)](_0x1b412c,config_1[_0x482150(0x14a)][_0x482150(0x13c)]['secret'],{'expiresIn':String(config_1[_0x482150(0x14a)]['jwt'][_0x482150(0x130)])});}async['login'](_0x115123){const _0x54840b=a34_0x5257f1,{username:_0x24d60d,password:_0x32e3d5}=_0x115123;if(_0x24d60d===config_1[_0x54840b(0x14a)][_0x54840b(0x14c)][_0x54840b(0x146)]){const _0x238034=await bcryptjs_1[_0x54840b(0x141)][_0x54840b(0x143)](_0x32e3d5,config_1[_0x54840b(0x14a)][_0x54840b(0x14c)][_0x54840b(0x13a)]);if(_0x238034){const _0x39edd6=this[_0x54840b(0x12b)]({'id':_0x54840b(0x14c),'username':config_1[_0x54840b(0x14a)]['admin'][_0x54840b(0x146)],'role':_0x54840b(0x14c)});return{'access_token':_0x39edd6,'role':_0x54840b(0x14c)};}}const _0x4ef0aa=await database_1[_0x54840b(0x141)][_0x54840b(0x12d)][_0x54840b(0x142)]({'where':{'username':_0x24d60d},'select':{'id':!![],'name':!![],'username':!![],'password':!![],'status':!![]}});if(!_0x4ef0aa)throw new Error(_0x54840b(0x12a));if(_0x4ef0aa[_0x54840b(0x12c)]!==_0x54840b(0x136))throw new Error(_0x54840b(0x149));const _0x2e25a5=await bcryptjs_1[_0x54840b(0x141)][_0x54840b(0x143)](_0x32e3d5,_0x4ef0aa[_0x54840b(0x147)]);if(!_0x2e25a5)throw new Error(_0x54840b(0x12a));const _0x857c42=this['generateToken']({'id':_0x4ef0aa['id'],'username':_0x4ef0aa[_0x54840b(0x146)],'role':_0x54840b(0x12d)});return{'access_token':_0x857c42,'role':'shop','user':{'id':_0x4ef0aa['id'],'name':_0x4ef0aa[_0x54840b(0x134)],'username':_0x4ef0aa[_0x54840b(0x146)]}};}async['verifyToken'](_0x1a4c9b){const _0x37a83c=a34_0x5257f1;try{const _0x14060e=jsonwebtoken_1[_0x37a83c(0x141)][_0x37a83c(0x144)](_0x1a4c9b,config_1[_0x37a83c(0x14a)][_0x37a83c(0x13c)][_0x37a83c(0x13f)]);return _0x14060e;}catch(_0x336647){throw new Error(_0x37a83c(0x12f));}}}exports[a34_0x5257f1(0x148)]=AuthService;