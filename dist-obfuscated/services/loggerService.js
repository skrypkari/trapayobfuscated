'use strict';const a44_0x45cc4f=a44_0x730b;(function(_0x580124,_0xff4ecb){const _0x378bf8=a44_0x730b,_0x51b89c=_0x580124();while(!![]){try{const _0x22069d=parseInt(_0x378bf8(0x169))/0x1+parseInt(_0x378bf8(0x184))/0x2*(parseInt(_0x378bf8(0x1a7))/0x3)+parseInt(_0x378bf8(0x19c))/0x4*(-parseInt(_0x378bf8(0x197))/0x5)+-parseInt(_0x378bf8(0x180))/0x6*(parseInt(_0x378bf8(0x182))/0x7)+parseInt(_0x378bf8(0x192))/0x8*(parseInt(_0x378bf8(0x175))/0x9)+-parseInt(_0x378bf8(0x179))/0xa*(-parseInt(_0x378bf8(0x1a4))/0xb)+-parseInt(_0x378bf8(0x17f))/0xc;if(_0x22069d===_0xff4ecb)break;else _0x51b89c['push'](_0x51b89c['shift']());}catch(_0x3adbdb){_0x51b89c['push'](_0x51b89c['shift']());}}}(a44_0x1028,0xe6365));function a44_0x1028(){const _0x11d0d5=['localeCompare','existsSync','error','shop_webhooks_errors','.log','defineProperty','mkdirSync','writeLog','map','webhooks_errors','path','ðŸ—‘ï¸\x20Deleted\x20old\x20log\x20file:\x20','ensureLogsDirectory','payments_created','ERROR','join','PAYMENT_CREATED','1874074ojMztY','logApiCall','logWhiteDomainResponse','loggerService','stringify','sort','ðŸ§¹\x20Cleaned\x20','message','SHOP_WEBHOOK_SENT','\x20days)','__importDefault','Failed\x20to\x20clean\x20old\x20logs:','1026ncXgTk','api_calls','split','log','10seoGAd','getDate','LoggerService','SHOP_WEBHOOK_ERROR','WEBHOOK_RECEIVED','toISOString','10305768MukKrx','13470SyysHw','unlinkSync','3325FatVez','logWhiteDomainError','2270RNRjsD','getLogFileName','WEBHOOK_PROCESSED','readdirSync','utf8','Failed\x20to\x20write\x20','__esModule','ðŸ“\x20Created\x20logs\x20directory:\x20','REQUEST','filter','webhooks_processed','length','endsWith','logsDir','53904HLtxCt','getLogStats','RESPONSE','logShopWebhookSent','default','365jIrTRj','cleanOldLogs','\x20old\x20log\x20files\x20(older\x20than\x20','logs','replace','8068fcWaeE','white_domain_responses','logWebhookProcessed','WEBHOOK_ERROR','stack','date','logPaymentCreated','logWhiteDomainRequest','1170928zYUchs','forEach','shop_webhooks_sent','705wQWfrQ','statSync','Failed\x20to\x20get\x20log\x20stats:'];a44_0x1028=function(){return _0x11d0d5;};return a44_0x1028();}var __importDefault=this&&this[a44_0x45cc4f(0x173)]||function(_0x2eebf1){const _0x2cf458=a44_0x45cc4f;return _0x2eebf1&&_0x2eebf1[_0x2cf458(0x18a)]?_0x2eebf1:{'default':_0x2eebf1};};function a44_0x730b(_0x3d3b27,_0x501559){const _0x102880=a44_0x1028();return a44_0x730b=function(_0x730bb6,_0x30bba8){_0x730bb6=_0x730bb6-0x168;let _0x28112a=_0x102880[_0x730bb6];return _0x28112a;},a44_0x730b(_0x3d3b27,_0x501559);}Object[a44_0x45cc4f(0x1af)](exports,a44_0x45cc4f(0x18a),{'value':!![]}),exports[a44_0x45cc4f(0x16c)]=exports[a44_0x45cc4f(0x17b)]=void 0x0;const fs_1=__importDefault(require('fs')),path_1=__importDefault(require(a44_0x45cc4f(0x1b4)));class LoggerService{constructor(){const _0x1bb8e8=a44_0x45cc4f;this['logsDir']=path_1[_0x1bb8e8(0x196)][_0x1bb8e8(0x1b9)](process['cwd'](),_0x1bb8e8(0x19a)),this['ensureLogsDirectory']();}[a44_0x45cc4f(0x1b6)](){const _0x3d6a15=a44_0x45cc4f;!fs_1[_0x3d6a15(0x196)][_0x3d6a15(0x1ab)](this[_0x3d6a15(0x191)])&&(fs_1[_0x3d6a15(0x196)][_0x3d6a15(0x1b0)](this['logsDir'],{'recursive':!![]}),console[_0x3d6a15(0x178)](_0x3d6a15(0x18b)+this[_0x3d6a15(0x191)]));}[a44_0x45cc4f(0x185)](_0x3f2ea3){const _0x11d2dc=a44_0x45cc4f,_0x58d283=new Date()[_0x11d2dc(0x17e)]()[_0x11d2dc(0x177)]('T')[0x0];return path_1[_0x11d2dc(0x196)][_0x11d2dc(0x1b9)](this[_0x11d2dc(0x191)],_0x3f2ea3+'_'+_0x58d283+'.log');}[a44_0x45cc4f(0x1b1)](_0x4dc694,_0x5cf362){const _0x54d87c=a44_0x45cc4f;try{const _0x4e168f=new Date()[_0x54d87c(0x17e)](),_0x2f0f0f={'timestamp':_0x4e168f,..._0x5cf362},_0x434657=JSON[_0x54d87c(0x16d)](_0x2f0f0f)+'\x0a',_0x599925=this[_0x54d87c(0x185)](_0x4dc694);fs_1[_0x54d87c(0x196)]['appendFileSync'](_0x599925,_0x434657,_0x54d87c(0x188));}catch(_0x201eef){console[_0x54d87c(0x1ac)](_0x54d87c(0x189)+_0x4dc694+'\x20log:',_0x201eef);}}[a44_0x45cc4f(0x1a3)](_0x1e8120,_0x4e7f55,_0x3fe6aa,_0x2300df){const _0x344efb=a44_0x45cc4f;this[_0x344efb(0x1b1)]('white_domain_requests',{'type':_0x344efb(0x18c),'gateway':_0x1e8120,'endpoint':_0x4e7f55,'method':_0x3fe6aa,'data':_0x2300df});}[a44_0x45cc4f(0x16b)](_0x4abc97,_0x2421d7,_0x536ce1,_0x2d2775,_0x18cd61){const _0x1b97a6=a44_0x45cc4f;this[_0x1b97a6(0x1b1)](_0x1b97a6(0x19d),{'type':_0x1b97a6(0x194),'gateway':_0x4abc97,'endpoint':_0x2421d7,'status':_0x536ce1,'responseTime':_0x18cd61,'data':_0x2d2775});}[a44_0x45cc4f(0x183)](_0x1c8f46,_0x4af3ca,_0x557f83){const _0x4a10bb=a44_0x45cc4f;this[_0x4a10bb(0x1b1)]('white_domain_errors',{'type':_0x4a10bb(0x1b8),'gateway':_0x1c8f46,'endpoint':_0x4af3ca,'error':_0x557f83 instanceof Error?{'message':_0x557f83['message'],'stack':_0x557f83[_0x4a10bb(0x1a0)]}:_0x557f83});}['logWebhookReceived'](_0x539bfa,_0x4ab8c7,_0x5a3307){const _0x56dd73=a44_0x45cc4f;this[_0x56dd73(0x1b1)]('webhooks_received',{'type':_0x56dd73(0x17d),'gateway':_0x539bfa,'headers':_0x5a3307,'data':_0x4ab8c7});}[a44_0x45cc4f(0x19e)](_0x1124ea,_0x473f24,_0x4e2750,_0x1b56a4,_0x439398){const _0x4f2e11=a44_0x45cc4f;this['writeLog'](_0x4f2e11(0x18e),{'type':_0x4f2e11(0x186),'gateway':_0x1124ea,'paymentId':_0x473f24,'oldStatus':_0x4e2750,'newStatus':_0x1b56a4,'originalData':_0x439398});}['logWebhookError'](_0x2d5e6e,_0x5768dc,_0x5d0111){const _0x108365=a44_0x45cc4f;this[_0x108365(0x1b1)](_0x108365(0x1b3),{'type':_0x108365(0x19f),'gateway':_0x2d5e6e,'error':_0x5768dc instanceof Error?{'message':_0x5768dc[_0x108365(0x170)],'stack':_0x5768dc[_0x108365(0x1a0)]}:_0x5768dc,'originalData':_0x5d0111});}[a44_0x45cc4f(0x195)](_0xa908ec,_0x536c2d,_0x40df40,_0x4dc571,_0x7c254e,_0x11900d){const _0x202b4d=a44_0x45cc4f;this[_0x202b4d(0x1b1)](_0x202b4d(0x1a6),{'type':_0x202b4d(0x171),'shopId':_0xa908ec,'webhookUrl':_0x536c2d,'event':_0x40df40,'status':_0x4dc571,'responseTime':_0x7c254e,'payload':_0x11900d});}['logShopWebhookError'](_0x4ea0b7,_0x3e5dbf,_0x1f8aa3,_0xd22659,_0x18def0){const _0x336dc3=a44_0x45cc4f;this[_0x336dc3(0x1b1)](_0x336dc3(0x1ad),{'type':_0x336dc3(0x17c),'shopId':_0x4ea0b7,'webhookUrl':_0x3e5dbf,'event':_0x1f8aa3,'error':_0xd22659 instanceof Error?{'message':_0xd22659['message'],'stack':_0xd22659[_0x336dc3(0x1a0)]}:_0xd22659,'payload':_0x18def0});}[a44_0x45cc4f(0x1a2)](_0x3d0d33,_0xc5832e,_0x2cbfdc,_0x44bbd0,_0x340207){const _0x1301cf=a44_0x45cc4f;this['writeLog'](_0x1301cf(0x1b7),{'type':_0x1301cf(0x168),'gateway':_0x3d0d33,'paymentId':_0xc5832e,'shopId':_0x2cbfdc,'amount':_0x44bbd0,'currency':_0x340207});}[a44_0x45cc4f(0x16a)](_0x36866e,_0x4994db,_0x401a3f,_0x2543b2,_0x40bbb4){const _0x341dbf=a44_0x45cc4f;this[_0x341dbf(0x1b1)](_0x341dbf(0x176),{'type':'API_CALL','endpoint':_0x36866e,'method':_0x4994db,'userId':_0x401a3f,'userRole':_0x2543b2,'requestData':_0x40bbb4});}[a44_0x45cc4f(0x193)](){const _0x3126a2=a44_0x45cc4f;try{const _0x2f92e5=fs_1['default'][_0x3126a2(0x187)](this[_0x3126a2(0x191)]),_0xb40e91=_0x2f92e5[_0x3126a2(0x18d)](_0x9401a9=>_0x9401a9[_0x3126a2(0x190)]('.log')),_0x1625e2=[...new Set(_0xb40e91[_0x3126a2(0x1b2)](_0x51f9a8=>_0x51f9a8['split']('_')[0x0]))],_0x201bdc=_0xb40e91['map'](_0x2c67d9=>{const _0xdedfac=_0x3126a2,_0x4f0568=path_1[_0xdedfac(0x196)][_0xdedfac(0x1b9)](this[_0xdedfac(0x191)],_0x2c67d9),_0x3e858a=fs_1[_0xdedfac(0x196)][_0xdedfac(0x1a8)](_0x4f0568),[_0x216f61,_0x5aac6c]=_0x2c67d9[_0xdedfac(0x19b)](_0xdedfac(0x1ae),'')[_0xdedfac(0x177)]('_');return{'type':_0x216f61,'date':_0x5aac6c,'size':_0x3e858a['size']};})[_0x3126a2(0x16e)]((_0x102425,_0x2a8b1e)=>_0x2a8b1e[_0x3126a2(0x1a1)][_0x3126a2(0x1aa)](_0x102425[_0x3126a2(0x1a1)]));return{'totalFiles':_0xb40e91[_0x3126a2(0x18f)],'logTypes':_0x1625e2,'latestLogs':_0x201bdc['slice'](0x0,0xa)};}catch(_0x2322d3){return console[_0x3126a2(0x1ac)](_0x3126a2(0x1a9),_0x2322d3),{'totalFiles':0x0,'logTypes':[],'latestLogs':[]};}}[a44_0x45cc4f(0x198)](_0x41efae=0x1e){const _0x5209f3=a44_0x45cc4f;try{const _0x156060=fs_1['default'][_0x5209f3(0x187)](this['logsDir']),_0x399a55=new Date();_0x399a55['setDate'](_0x399a55[_0x5209f3(0x17a)]()-_0x41efae);let _0x494e98=0x0;_0x156060[_0x5209f3(0x1a5)](_0x356702=>{const _0x2e5089=_0x5209f3;if(!_0x356702[_0x2e5089(0x190)](_0x2e5089(0x1ae)))return;const _0x4dc6ac=path_1[_0x2e5089(0x196)][_0x2e5089(0x1b9)](this[_0x2e5089(0x191)],_0x356702),_0x51d640=fs_1['default'][_0x2e5089(0x1a8)](_0x4dc6ac);_0x51d640['mtime']<_0x399a55&&(fs_1[_0x2e5089(0x196)][_0x2e5089(0x181)](_0x4dc6ac),_0x494e98++,console[_0x2e5089(0x178)](_0x2e5089(0x1b5)+_0x356702));}),console['log'](_0x5209f3(0x16f)+_0x494e98+_0x5209f3(0x199)+_0x41efae+_0x5209f3(0x172));}catch(_0x1f8732){console[_0x5209f3(0x1ac)](_0x5209f3(0x174),_0x1f8732);}}}exports[a44_0x45cc4f(0x17b)]=LoggerService,exports[a44_0x45cc4f(0x16c)]=new LoggerService();