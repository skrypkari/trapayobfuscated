'use strict';const a3_0xc8cedf=a3_0x2c12;function a3_0x2c12(_0x44bef8,_0x5429fa){const _0x4cc295=a3_0x4cc2();return a3_0x2c12=function(_0x2c125e,_0x56d08b){_0x2c125e=_0x2c125e-0xdd;let _0x7d3e50=_0x4cc295[_0x2c125e];return _0x7d3e50;},a3_0x2c12(_0x44bef8,_0x5429fa);}(function(_0xb5cfa8,_0x5d171b){const _0x5dc1d3=a3_0x2c12,_0x31dcfa=_0xb5cfa8();while(!![]){try{const _0x36be78=-parseInt(_0x5dc1d3(0xf6))/0x1+parseInt(_0x5dc1d3(0x112))/0x2*(parseInt(_0x5dc1d3(0xfd))/0x3)+-parseInt(_0x5dc1d3(0x113))/0x4*(parseInt(_0x5dc1d3(0x109))/0x5)+parseInt(_0x5dc1d3(0x124))/0x6+-parseInt(_0x5dc1d3(0x119))/0x7+parseInt(_0x5dc1d3(0x11f))/0x8*(-parseInt(_0x5dc1d3(0xde))/0x9)+parseInt(_0x5dc1d3(0xfe))/0xa;if(_0x36be78===_0x5d171b)break;else _0x31dcfa['push'](_0x31dcfa['shift']());}catch(_0xc96285){_0x31dcfa['push'](_0x31dcfa['shift']());}}}(a3_0x4cc2,0xdf5e6));Object['defineProperty'](exports,a3_0xc8cedf(0x129),{'value':!![]}),exports[a3_0xc8cedf(0xe8)]=void 0x0;const adminService_1=require(a3_0xc8cedf(0xe1)),telegramBotService_1=require(a3_0xc8cedf(0xfc));function a3_0x4cc2(){const _0x48d49a=['createdAt','../services/adminService','toUpperCase','User\x20not\x20found','Статус\x20изменен\x20администратором\x20на\x20','createUser','REFUND','body','AdminController','Payment\x20not\x20found','users','User\x20created\x20successfully','params','merchants','User\x20suspended\x20successfully','PAID','json','User\x20deleted\x20successfully','getStatistics','Payout\x20created\x20successfully','log','deletePayout','706087mdDbNc','Failed\x20to\x20send\x20Telegram\x20notification\x20for\x20admin\x20status\x20change:','EXPIRED','getPayments','shopId','activateUser','../services/telegramBotService','964971hXMVWy','34157440HFpCsL','updatePayment','getUsers','checkAuth','adminService','payouts','Payout\x20deleted\x20successfully','refund',',\x20sending\x20Telegram\x20notification','username','getPayoutStats','35pIlAzk','📱\x20Admin\x20changed\x20payment\x20','getUserById','status','FAILED','chargeback','getAllPayments','updateUser','getPayoutById','4uVDFVx','180076qgzkzy','pagination','error','getMerchantsAwaitingPayout','User\x20activated\x20successfully','payments','6557733opXcuL','gateway','30d','getAllUsers','deleteUser','telegramBotService','5768824ANOdiq','summary','getAllPayouts','✅\x20Telegram\x20notification\x20sent\x20for\x20admin\x20status\x20change:\x20','\x20to\x20','1536630euxWIl','getPaymentById','sendPaymentNotification','query','expired','__esModule','paid','getPayouts','createPayout','\x20->\x20','18TpAtrD','failed'];a3_0x4cc2=function(){return _0x48d49a;};return a3_0x4cc2();}class AdminController{constructor(){const _0x5eae9c=a3_0xc8cedf;this[_0x5eae9c(0x101)]=async(_0x3fc009,_0x2c3f7c,_0x2bf319)=>{const _0x1458f1=_0x5eae9c;try{const _0x33161=_0x3fc009['user'];_0x2c3f7c['json']({'success':!![],'message':'Admin\x20access\x20confirmed','user':{'id':_0x33161?.['id'],'username':_0x33161?.[_0x1458f1(0x107)],'role':_0x33161?.['role']}});}catch(_0x1737df){_0x2bf319(_0x1737df);}},this[_0x5eae9c(0xf2)]=async(_0x401776,_0x363505,_0x51dfe6)=>{const _0x23674d=_0x5eae9c;try{const {period:period=_0x23674d(0x11b)}=_0x401776[_0x23674d(0x127)],_0x2ec2d3=await this['adminService']['getSystemStatistics'](period);_0x363505['json']({'success':!![],'result':_0x2ec2d3});}catch(_0x43b167){_0x51dfe6(_0x43b167);}},this[_0x5eae9c(0x108)]=async(_0x56fa85,_0x554917,_0x1fcc82)=>{const _0x23104d=_0x5eae9c;try{const _0x2d5ba8=await this['adminService'][_0x23104d(0x108)]();_0x554917[_0x23104d(0xf0)]({'success':!![],'result':_0x2d5ba8});}catch(_0x4e91ac){_0x1fcc82(_0x4e91ac);}},this['getMerchantsAwaitingPayout']=async(_0x21e889,_0x51058b,_0x49237b)=>{const _0xed3ae6=_0x5eae9c;try{const {page:page=0x1,limit:limit=0x14,minAmount:_0x833dfa,search:_0x29b325}=_0x21e889['query'],_0x33dedf={'page':Number(page),'limit':Number(limit),'minAmount':_0x833dfa?Number(_0x833dfa):undefined,'search':_0x29b325},_0x6ffe1=await this[_0xed3ae6(0x102)][_0xed3ae6(0x116)](_0x33dedf);_0x51058b[_0xed3ae6(0xf0)]({'success':!![],'merchants':_0x6ffe1[_0xed3ae6(0xed)],'pagination':_0x6ffe1['pagination'],'summary':_0x6ffe1[_0xed3ae6(0x120)]});}catch(_0x48cb97){_0x49237b(_0x48cb97);}},this[_0x5eae9c(0x12c)]=async(_0x33ca87,_0x7cdd18,_0x7e8734)=>{const _0x4f90da=_0x5eae9c;try{const _0x3c2048=_0x33ca87[_0x4f90da(0xe7)],_0xc4f959=await this[_0x4f90da(0x102)][_0x4f90da(0x12c)](_0x3c2048);_0x7cdd18['status'](0xc9)['json']({'success':!![],'message':_0x4f90da(0xf3),'result':_0xc4f959});}catch(_0x482f1c){_0x7e8734(_0x482f1c);}},this[_0x5eae9c(0x12b)]=async(_0x4eabf2,_0x55719f,_0x1bf780)=>{const _0x75fe9c=_0x5eae9c;try{const {page:page=0x1,limit:limit=0x14,shopId:_0x4a301f,network:_0x420976,dateFrom:_0x56d852,dateTo:_0x5c8a04,search:_0xaefb2a}=_0x4eabf2['query'],_0x3d0ad2={'page':Number(page),'limit':Number(limit),'shopId':_0x4a301f,'network':_0x420976,'dateFrom':_0x56d852,'dateTo':_0x5c8a04,'search':_0xaefb2a},_0x56e690=await this['adminService'][_0x75fe9c(0x121)](_0x3d0ad2);_0x55719f[_0x75fe9c(0xf0)]({'success':!![],'payouts':_0x56e690[_0x75fe9c(0x103)],'pagination':_0x56e690[_0x75fe9c(0x114)]});}catch(_0x5a17d2){_0x1bf780(_0x5a17d2);}},this['getPayoutById']=async(_0x400af7,_0x20f214,_0x2d2534)=>{const _0x4300d5=_0x5eae9c;try{const {id:_0x3e69b5}=_0x400af7[_0x4300d5(0xec)],_0x96791b=await this[_0x4300d5(0x102)][_0x4300d5(0x111)](_0x3e69b5);if(!_0x96791b)return _0x20f214[_0x4300d5(0x10c)](0x194)[_0x4300d5(0xf0)]({'success':![],'message':'Payout\x20not\x20found'});_0x20f214[_0x4300d5(0xf0)]({'success':!![],'result':_0x96791b});}catch(_0x2d4cd9){_0x2d2534(_0x2d4cd9);}},this[_0x5eae9c(0xf5)]=async(_0x56114d,_0x392548,_0xf27daa)=>{const _0x49ea02=_0x5eae9c;try{const {id:_0x141043}=_0x56114d[_0x49ea02(0xec)];await this['adminService'][_0x49ea02(0xf5)](_0x141043),_0x392548[_0x49ea02(0xf0)]({'success':!![],'message':_0x49ea02(0x104)});}catch(_0x22c59e){_0xf27daa(_0x22c59e);}},this[_0x5eae9c(0xf9)]=async(_0x595cb8,_0x243dfc,_0x1b463a)=>{const _0x314520=_0x5eae9c;try{const {page:page=0x1,limit:limit=0x14,status:_0x5e07ac,gateway:_0x21a930,shopId:_0x39d10b,dateFrom:_0x333dd5,dateTo:_0x40750,search:_0x43efed}=_0x595cb8[_0x314520(0x127)],_0x4f313a={'page':Number(page),'limit':Number(limit),'status':_0x5e07ac,'gateway':_0x21a930,'shopId':_0x39d10b,'dateFrom':_0x333dd5,'dateTo':_0x40750,'search':_0x43efed},_0x3a0e8e=await this[_0x314520(0x102)][_0x314520(0x10f)](_0x4f313a);_0x243dfc[_0x314520(0xf0)]({'success':!![],'payments':_0x3a0e8e[_0x314520(0x118)],'pagination':_0x3a0e8e[_0x314520(0x114)]});}catch(_0x39b410){_0x1b463a(_0x39b410);}},this[_0x5eae9c(0x125)]=async(_0x6abc81,_0x4dcf5a,_0x433097)=>{const _0x1365f2=_0x5eae9c;try{const {id:_0x59869a}=_0x6abc81[_0x1365f2(0xec)],_0x5b8b6e=await this[_0x1365f2(0x102)][_0x1365f2(0x125)](_0x59869a);if(!_0x5b8b6e)return _0x4dcf5a[_0x1365f2(0x10c)](0x194)[_0x1365f2(0xf0)]({'success':![],'message':'Payment\x20not\x20found'});_0x4dcf5a[_0x1365f2(0xf0)]({'success':!![],'result':_0x5b8b6e});}catch(_0x19a958){_0x433097(_0x19a958);}},this[_0x5eae9c(0xff)]=async(_0x3e0a86,_0x460983,_0x59d500)=>{const _0x511965=_0x5eae9c;try{const {id:_0x1e8133}=_0x3e0a86[_0x511965(0xec)],{status:_0x317733,notes:_0x3a7216,chargebackAmount:_0x4fc178}=_0x3e0a86[_0x511965(0xe7)],_0x1d0fff=await this[_0x511965(0x102)][_0x511965(0x125)](_0x1e8133);if(!_0x1d0fff)return _0x460983[_0x511965(0x10c)](0x194)[_0x511965(0xf0)]({'success':![],'message':_0x511965(0xe9)});const _0x1f07dd=await this[_0x511965(0x102)]['updatePaymentStatus'](_0x1e8133,_0x317733,_0x3a7216,_0x4fc178);if(_0x1d0fff['status']!==_0x317733){console[_0x511965(0xf4)](_0x511965(0x10a)+_0x1e8133+'\x20status\x20from\x20'+_0x1d0fff[_0x511965(0x10c)]+_0x511965(0x123)+_0x317733+_0x511965(0x106));try{let _0x515d9c;switch(_0x317733[_0x511965(0xe2)]()){case _0x511965(0xef):_0x515d9c=_0x511965(0x12a);break;case _0x511965(0x10d):_0x515d9c=_0x511965(0xdf);break;case _0x511965(0xf8):_0x515d9c=_0x511965(0x128);break;case _0x511965(0xe6):_0x515d9c=_0x511965(0x105);break;case'CHARGEBACK':_0x515d9c=_0x511965(0x10e);break;default:console[_0x511965(0xf4)]('📱\x20Skipping\x20Telegram\x20notification\x20for\x20admin\x20status\x20change\x20to:\x20'+_0x317733);break;}if(_0x515d9c){const _0xa81af4={..._0x1f07dd,'shopId':_0x1d0fff['shopId'],'gateway':_0x1d0fff[_0x511965(0x11a)],'createdAt':_0x1d0fff[_0x511965(0xe0)],'adminNotes':_0x3a7216||_0x511965(0xe4)+_0x317733,'chargebackAmount':_0x4fc178};await telegramBotService_1[_0x511965(0x11e)][_0x511965(0x126)](_0x1d0fff[_0x511965(0xfa)],_0xa81af4,_0x515d9c),console[_0x511965(0xf4)](_0x511965(0x122)+_0x1d0fff['status']+_0x511965(0xdd)+_0x317733);}}catch(_0x52e2fb){console[_0x511965(0x115)](_0x511965(0xf7),_0x52e2fb);}}_0x460983[_0x511965(0xf0)]({'success':!![],'message':'Payment\x20updated\x20successfully','result':_0x1f07dd});}catch(_0x573501){_0x59d500(_0x573501);}},this['updateUser']=async(_0x15a572,_0x388b90,_0x31106b)=>{const _0x5cec62=_0x5eae9c;try{const {id:_0x52bc3f}=_0x15a572[_0x5cec62(0xec)],_0x1ec97f=_0x15a572[_0x5cec62(0xe7)],_0x5e25f2=await this[_0x5cec62(0x102)][_0x5cec62(0x110)](_0x52bc3f,_0x1ec97f);_0x388b90[_0x5cec62(0xf0)]({'success':!![],'message':'User\x20updated\x20successfully','result':_0x5e25f2});}catch(_0x7bea11){_0x31106b(_0x7bea11);}},this['suspendUser']=async(_0x4300cc,_0x7598e7,_0x4e898b)=>{const _0x38ae66=_0x5eae9c;try{const {id:_0x774582}=_0x4300cc['params'],_0x59abc7=await this[_0x38ae66(0x102)]['suspendUser'](_0x774582);_0x7598e7['json']({'success':!![],'message':_0x38ae66(0xee),'result':_0x59abc7});}catch(_0x19e8ac){_0x4e898b(_0x19e8ac);}},this[_0x5eae9c(0xfb)]=async(_0x859790,_0x807f24,_0x2f880a)=>{const _0x19eace=_0x5eae9c;try{const {id:_0x4499f5}=_0x859790[_0x19eace(0xec)],_0x5ab169=await this[_0x19eace(0x102)][_0x19eace(0xfb)](_0x4499f5);_0x807f24[_0x19eace(0xf0)]({'success':!![],'message':_0x19eace(0x117),'result':_0x5ab169});}catch(_0x3ca266){_0x2f880a(_0x3ca266);}},this[_0x5eae9c(0x100)]=async(_0x17ae4a,_0xada1d1,_0x3345c3)=>{const _0x2cba0a=_0x5eae9c;try{const {page:page=0x1,limit:limit=0x14,status:_0x52de01}=_0x17ae4a[_0x2cba0a(0x127)],_0x323b95={'page':Number(page),'limit':Number(limit),'status':_0x52de01},_0x2d6c90=await this[_0x2cba0a(0x102)][_0x2cba0a(0x11c)](_0x323b95);_0xada1d1[_0x2cba0a(0xf0)]({'success':!![],'users':_0x2d6c90[_0x2cba0a(0xea)],'pagination':_0x2d6c90[_0x2cba0a(0x114)]});}catch(_0x5f36bc){_0x3345c3(_0x5f36bc);}},this[_0x5eae9c(0x10b)]=async(_0x4b1556,_0x3daea1,_0x57209c)=>{const _0x3e9150=_0x5eae9c;try{const {id:_0x4c02de}=_0x4b1556[_0x3e9150(0xec)],_0x150602=await this[_0x3e9150(0x102)]['getUserById'](_0x4c02de);if(!_0x150602)return _0x3daea1[_0x3e9150(0x10c)](0x194)[_0x3e9150(0xf0)]({'success':![],'message':_0x3e9150(0xe3)});_0x3daea1['json']({'success':!![],'result':_0x150602});}catch(_0x112c07){_0x57209c(_0x112c07);}},this[_0x5eae9c(0xe5)]=async(_0x25289b,_0x35d03f,_0x1b3c92)=>{const _0x3a3342=_0x5eae9c;try{const _0x4e270e=_0x25289b['body'],_0x260ca0=await this['adminService'][_0x3a3342(0xe5)](_0x4e270e);_0x35d03f[_0x3a3342(0x10c)](0xc9)[_0x3a3342(0xf0)]({'success':!![],'message':_0x3a3342(0xeb),'result':_0x260ca0});}catch(_0x89d491){_0x1b3c92(_0x89d491);}},this[_0x5eae9c(0x11d)]=async(_0x4272e4,_0x324676,_0x2e700f)=>{const _0x5a416c=_0x5eae9c;try{const {id:_0x384b89}=_0x4272e4[_0x5a416c(0xec)];await this['adminService'][_0x5a416c(0x11d)](_0x384b89),_0x324676[_0x5a416c(0xf0)]({'success':!![],'message':_0x5a416c(0xf1)});}catch(_0x8fdd8b){_0x2e700f(_0x8fdd8b);}},this[_0x5eae9c(0x102)]=new adminService_1['AdminService']();}}exports[a3_0xc8cedf(0xe8)]=AdminController;