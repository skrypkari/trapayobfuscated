'use strict';function a4_0x132b(){const _0x1e4f9f=['User\x20suspended\x20successfully','\x20->\x20','shopId','../services/gatewaySettingsService','merchants','create','failed','../services/paymentLinkService','User\x20updated\x20successfully','activateUser','User\x20activated\x20successfully','handleSuccessfulPayment','User\x20deleted\x20successfully','paymentLinkService','expireSinglePaymentLinks','__importDefault','AdminService','enable2FA','getStatistics','getSystemStatistics','../config/database','\x20to\x20','üîô\x20[GATEWAY\x20STATS]\x20Chargeback\x20count:\x20','Admin\x20password\x20changed\x20successfully','pagination','764216emVfcS','get','username','getAllUsers','disableAdmin2FA','body','findMany','ceil','users','Gateway\x20not\x20found','__esModule','getGatewaySettings','adminService','_all','log','defineProperty','depositBalance','Customer\x20data\x20updated\x20successfully','Payment\x20not\x20found','645MBnSqv',',\x20sending\x20Telegram\x20notification','updatePayout','üìä\x20Manual\x20payment\x20cleanup\x20(PROCESSING\x20+\x20PENDING)\x20with\x20report\x20initiated\x20by\x20admin:\x20','query','cleanupStalePayments','payouts','deleteUser','CHARGEBACK','User\x20not\x20found','getProcessingPaymentsStats','469SyBCGu','createUser','2160cduhkz','30d','üìä\x20Admin\x20requesting\x20payout\x20reports:','changeAdminPassword','true','processed','writable','summary','getUserById','2927406ePczIi','Admin\x202FA\x20disabled\x20successfully','üí∞\x20[GATEWAY\x20STATS]\x20Paid\x20payments\x20result:','amountAfterGatewayCommissionUSDT','770kFAVzG','_count','Payment\x20link\x20expiration\x20check\x20completed\x20successfully','json','params','amountUSDT','periodFrom,\x20periodTo,\x20and\x20gateway\x20are\x20required','getOwnPropertyNames','setup2FA','Token\x20is\x20required','toFixed','\x20status\x20changed\x20from\x20','\x20with\x20data:','\x20\x20\x20-\x20Total\x20Turnover:\x20','Payment\x20updated\x20successfully','Payment\x20cleanup\x20(PROCESSING\x20+\x20PENDING)\x20with\x20report\x20completed\x20successfully','PROCESSING\x20payment\x20cleanup\x20completed\x20successfully','updatePayment','errors','getPayoutReports','../types/gateway','üìà\x20Admin\x20changed\x20payment\x20','count','desc','getOwnPropertyDescriptor','loginLog','getMerchantsSelection','role','refund','92940DWGneL','status','\x20->\x20Gateway\x20Name:\x20','cleanupStalePaymentsWithReport','üîÑ\x20Admin\x20updating\x20customer\x20data\x20for\x20payment\x20','payment','9GtZMjk','FAILED','all','Payout\x20deleted\x20successfully','get2FASettings','üì±\x20Payment\x20','../services/paymentCleanupService','\x20\x20\x20-\x20Total\x20Commission:\x20','getPayments','Payout\x20updated\x20successfully','gateway','createPayout','telegramBotService','844RRxEGD','Balance\x20deposited\x20successfully','statistics','updateCustomerData','getPayoutById','setupAdmin2FA','getAllPayments','_sum','PENDING\x20payment\x20cleanup\x20completed\x20successfully','default','REFUND','expired','hasOwnProperty','Amount\x20must\x20be\x20greater\x20than\x200','getMerchantStatistics','Admin\x20access\x20confirmed','üìä\x20[GATEWAY\x20STATS]\x20Gateway\x20ID\x20','resolve','getAllGatewaysWithSettings','paymentCleanupService','Payout\x20created\x20successfully','length','stringify','PaymentLinkService','updatePaymentStatus','error','cleanupStalePendingPayments','../services/telegramBotService','‚úÖ\x20Telegram\x20notification\x20sent\x20for\x20status\x20change:\x20','\x20to\x20PAID,\x20updating\x20payment\x20link\x20counter','getUsers','cleanupStaleProcessingPayments','getPaymentById','EXPIRED','\x22\x20and\x20status=\x22PAID\x22','getPayoutStats','getMerchantsAwaitingPayout','User\x20created\x20successfully','../services/adminService','2064808laHzft','configurable','AdminController','suspendUser','shopId\x20and\x20amount\x20are\x20required','user','deletePayout','payments','__createBinding','enableAdmin2FA','gatewaySettingsService','getShopWallets','PAID','Payout\x20not\x20found','toUpperCase','total','prototype','getGatewayStatistics','month','üéØ\x20[CONTROLLER]\x20Creating\x20payout\x20with\x20data:','processing','sendPaymentNotification','PROCESSING','then','86626VVHrBW','üìä\x20[GATEWAY\x20STATS]\x20Requesting\x20statistics\x20for\x20gateway\x20ID:\x20'];a4_0x132b=function(){return _0x1e4f9f;};return a4_0x132b();}const a4_0x3032dd=a4_0x28d2;(function(_0x44f81a,_0x80ddd4){const _0x22112e=a4_0x28d2,_0x3407ef=_0x44f81a();while(!![]){try{const _0x23c311=-parseInt(_0x22112e(0x145))/0x1+-parseInt(_0x22112e(0x12d))/0x2+parseInt(_0x22112e(0xd2))/0x3+-parseInt(_0x22112e(0x106))/0x4*(parseInt(_0x22112e(0x173))/0x5)+-parseInt(_0x22112e(0x180))/0x6*(-parseInt(_0x22112e(0x17e))/0x7)+parseInt(_0x22112e(0x160))/0x8*(parseInt(_0x22112e(0xf9))/0x9)+-parseInt(_0x22112e(0xf3))/0xa*(-parseInt(_0x22112e(0xd6))/0xb);if(_0x23c311===_0x80ddd4)break;else _0x3407ef['push'](_0x3407ef['shift']());}catch(_0x1c320d){_0x3407ef['push'](_0x3407ef['shift']());}}}(a4_0x132b,0x926e4));var __createBinding=this&&this[a4_0x3032dd(0x135)]||(Object[a4_0x3032dd(0x14c)]?function(_0x345c2c,_0x2d5c77,_0x5aa659,_0x7d6ed7){const _0x3b9a5f=a4_0x3032dd;if(_0x7d6ed7===undefined)_0x7d6ed7=_0x5aa659;var _0x107c17=Object[_0x3b9a5f(0xee)](_0x2d5c77,_0x5aa659);(!_0x107c17||(_0x3b9a5f(0x161)in _0x107c17?!_0x2d5c77[_0x3b9a5f(0x16a)]:_0x107c17[_0x3b9a5f(0x186)]||_0x107c17[_0x3b9a5f(0x12e)]))&&(_0x107c17={'enumerable':!![],'get':function(){return _0x2d5c77[_0x5aa659];}}),Object[_0x3b9a5f(0x16f)](_0x345c2c,_0x7d6ed7,_0x107c17);}:function(_0x58add7,_0x3a1eca,_0x3d86b8,_0x4456d4){if(_0x4456d4===undefined)_0x4456d4=_0x3d86b8;_0x58add7[_0x4456d4]=_0x3a1eca[_0x3d86b8];}),__setModuleDefault=this&&this['__setModuleDefault']||(Object['create']?function(_0x3605a0,_0x532db0){const _0x5f3ea0=a4_0x3032dd;Object[_0x5f3ea0(0x16f)](_0x3605a0,_0x5f3ea0(0x10f),{'enumerable':!![],'value':_0x532db0});}:function(_0xc649ec,_0x308b1e){const _0x2d61c1=a4_0x3032dd;_0xc649ec[_0x2d61c1(0x10f)]=_0x308b1e;}),__importStar=this&&this['__importStar']||(function(){var _0x26adb7=function(_0x53798e){const _0x5d3321=a4_0x28d2;return _0x26adb7=Object[_0x5d3321(0xdd)]||function(_0x2ace38){const _0x2152a8=_0x5d3321;var _0x3242a1=[];for(var _0x4a7c9b in _0x2ace38)if(Object[_0x2152a8(0x13d)][_0x2152a8(0x112)]['call'](_0x2ace38,_0x4a7c9b))_0x3242a1[_0x3242a1[_0x2152a8(0x11b)]]=_0x4a7c9b;return _0x3242a1;},_0x26adb7(_0x53798e);};return function(_0x2fed87){const _0x4bbd10=a4_0x28d2;if(_0x2fed87&&_0x2fed87['__esModule'])return _0x2fed87;var _0x43a311={};if(_0x2fed87!=null){for(var _0x27e69b=_0x26adb7(_0x2fed87),_0x5523d2=0x0;_0x5523d2<_0x27e69b[_0x4bbd10(0x11b)];_0x5523d2++)if(_0x27e69b[_0x5523d2]!==_0x4bbd10(0x10f))__createBinding(_0x43a311,_0x2fed87,_0x27e69b[_0x5523d2]);}return __setModuleDefault(_0x43a311,_0x2fed87),_0x43a311;};}()),__importDefault=this&&this[a4_0x3032dd(0x156)]||function(_0x11f816){const _0x59fc91=a4_0x3032dd;return _0x11f816&&_0x11f816[_0x59fc91(0x16a)]?_0x11f816:{'default':_0x11f816};};Object[a4_0x3032dd(0x16f)](exports,a4_0x3032dd(0x16a),{'value':!![]}),exports['AdminController']=void 0x0;const adminService_1=require(a4_0x3032dd(0x12c)),paymentLinkService_1=require(a4_0x3032dd(0x14e)),paymentCleanupService_1=require(a4_0x3032dd(0xff)),telegramBotService_1=require(a4_0x3032dd(0x121)),gatewaySettingsService_1=require(a4_0x3032dd(0x14a)),database_1=__importDefault(require(a4_0x3032dd(0x15b)));class AdminController{constructor(){const _0x419f16=a4_0x3032dd;this['checkAuth']=async(_0x39e0e7,_0x2833d0,_0xacba04)=>{const _0x404adc=a4_0x28d2;try{const _0x2a7890=_0x39e0e7[_0x404adc(0x132)];_0x2833d0[_0x404adc(0xd9)]({'success':!![],'message':_0x404adc(0x115),'user':{'id':_0x2a7890?.['id'],'username':_0x2a7890?.[_0x404adc(0x162)],'role':_0x2a7890?.[_0x404adc(0xf1)]}});}catch(_0x38c4da){_0xacba04(_0x38c4da);}},this[_0x419f16(0x159)]=async(_0x155c69,_0x44b363,_0xe843a3)=>{const _0x1e8087=_0x419f16;try{const {period:period=_0x1e8087(0x181),currentDate:_0xb1aa05}=_0x155c69['query'],_0x43d00f=await this[_0x1e8087(0x16c)][_0x1e8087(0x15a)](period,_0xb1aa05);_0x44b363[_0x1e8087(0xd9)]({'success':!![],'result':_0x43d00f});}catch(_0x29170c){_0xe843a3(_0x29170c);}},this[_0x419f16(0x114)]=async(_0x190ab4,_0x528b31,_0x4a6b03)=>{const _0x10a6e9=_0x419f16;try{const {shopId:_0x1acb6f,period:period=_0x10a6e9(0x13f),dateFrom:_0x26a194,dateTo:_0x4e05ca}=_0x190ab4['query'],_0x41b6bd={'shopId':_0x1acb6f,'period':period,'dateFrom':_0x26a194,'dateTo':_0x4e05ca};console[_0x10a6e9(0x16e)]('üìä\x20Admin\x20requesting\x20merchant\x20statistics\x20with\x20filters:',_0x41b6bd);const _0xcb9ec5=await this[_0x10a6e9(0x16c)][_0x10a6e9(0x114)](_0x41b6bd);_0x528b31[_0x10a6e9(0xd9)]({'success':!![],'result':_0xcb9ec5});}catch(_0x59a2a1){_0x4a6b03(_0x59a2a1);}},this[_0x419f16(0xe9)]=async(_0x355c25,_0x5b7ea5,_0x20507d)=>{const _0x28f260=_0x419f16;try{const {periodFrom:_0x5b473b,periodTo:_0xd302f8,gateway:_0x289f25}=_0x355c25[_0x28f260(0x177)];if(!_0x5b473b||!_0xd302f8||!_0x289f25)return _0x5b7ea5[_0x28f260(0xf4)](0x190)[_0x28f260(0xd9)]({'success':![],'message':_0x28f260(0xdc)});console[_0x28f260(0x16e)](_0x28f260(0x182),{'periodFrom':_0x5b473b,'periodTo':_0xd302f8,'gateway':_0x289f25});const _0x50d0b2=await this['adminService'][_0x28f260(0xe9)]({'periodFrom':_0x5b473b,'periodTo':_0xd302f8,'gateway':_0x289f25});_0x5b7ea5[_0x28f260(0xd9)]({'success':!![],'reports':_0x50d0b2});}catch(_0x4b390e){_0x20507d(_0x4b390e);}},this[_0x419f16(0x129)]=async(_0x57cea0,_0x265896,_0x16409e)=>{const _0x32a3bf=_0x419f16;try{const _0x12c89f=await this[_0x32a3bf(0x16c)][_0x32a3bf(0x129)]();_0x265896[_0x32a3bf(0xd9)]({'success':!![],'result':_0x12c89f});}catch(_0x39e443){_0x16409e(_0x39e443);}},this['getMerchantsAwaitingPayout']=async(_0x47b9f8,_0x4b9d1a,_0x5c9263)=>{const _0x430534=_0x419f16;try{const {page:page=0x1,limit:limit=0x14,minAmount:_0x1798be,search:_0x420137}=_0x47b9f8[_0x430534(0x177)],_0xae85db={'page':Number(page),'limit':Number(limit),'minAmount':_0x1798be?Number(_0x1798be):undefined,'search':_0x420137},_0x2ef6a1=await this[_0x430534(0x16c)][_0x430534(0x12a)](_0xae85db);_0x4b9d1a[_0x430534(0xd9)]({'success':!![],'merchants':_0x2ef6a1[_0x430534(0x14b)],'pagination':_0x2ef6a1[_0x430534(0x15f)],'summary':_0x2ef6a1[_0x430534(0xd0)]});}catch(_0x44f399){_0x5c9263(_0x44f399);}},this['getMerchantsSelection']=async(_0x3791dd,_0x53e322,_0x46cc64)=>{const _0x1344f8=_0x419f16;try{const _0x227cb0=_0x3791dd[_0x1344f8(0x177)]['hasPayoutHistory']===_0x1344f8(0x184),_0x2097d4=await this[_0x1344f8(0x16c)][_0x1344f8(0xf0)](_0x227cb0);_0x53e322[_0x1344f8(0xd9)]({'success':!![],'result':_0x2097d4});}catch(_0x14abef){_0x46cc64(_0x14abef);}},this['createPayout']=async(_0xaddbe,_0x13962e,_0x33e877)=>{const _0x5e5c4b=_0x419f16;try{const _0x217bf2=_0xaddbe[_0x5e5c4b(0x165)];console[_0x5e5c4b(0x16e)](_0x5e5c4b(0x140),_0x217bf2);const _0x49552b=await this['adminService'][_0x5e5c4b(0x104)](_0x217bf2);_0x13962e[_0x5e5c4b(0xf4)](0xc9)['json']({'success':!![],'message':_0x5e5c4b(0x11a),'result':_0x49552b});}catch(_0x3ce544){_0x33e877(_0x3ce544);}},this[_0x419f16(0x175)]=async(_0x312fbd,_0x284f2f,_0x42d059)=>{const _0x2d7f0b=_0x419f16;try{const {id:_0x343442}=_0x312fbd[_0x2d7f0b(0xda)],_0x536248=_0x312fbd[_0x2d7f0b(0x165)];console[_0x2d7f0b(0x16e)]('üéØ\x20[CONTROLLER]\x20Updating\x20payout\x20'+_0x343442+_0x2d7f0b(0xe2),_0x536248);const _0xb4e39b=await this[_0x2d7f0b(0x16c)][_0x2d7f0b(0x175)](_0x343442,_0x536248);_0x284f2f[_0x2d7f0b(0xd9)]({'success':!![],'message':_0x2d7f0b(0x102),'result':_0xb4e39b});}catch(_0x3de437){_0x42d059(_0x3de437);}},this['getPayouts']=async(_0x27ee06,_0x1ef02b,_0x2a34f6)=>{const _0x121ffb=_0x419f16;try{const {page:page=0x1,limit:limit=0x14,shopId:_0x2d3768,network:_0x4fb1fa,dateFrom:_0x5226af,dateTo:_0x499c13,search:_0x13d7d1}=_0x27ee06[_0x121ffb(0x177)],_0x35e66f={'page':Number(page),'limit':Number(limit),'shopId':_0x2d3768,'network':_0x4fb1fa,'dateFrom':_0x5226af,'dateTo':_0x499c13,'search':_0x13d7d1},_0x190bdf=await this[_0x121ffb(0x16c)]['getAllPayouts'](_0x35e66f);_0x1ef02b[_0x121ffb(0xd9)]({'success':!![],'payouts':_0x190bdf[_0x121ffb(0x179)],'pagination':_0x190bdf[_0x121ffb(0x15f)]});}catch(_0x139b06){_0x2a34f6(_0x139b06);}},this[_0x419f16(0x10a)]=async(_0xb74d1,_0x4e6ca1,_0x161134)=>{const _0x2936f2=_0x419f16;try{const {id:_0x31d316}=_0xb74d1[_0x2936f2(0xda)],_0x1161db=await this[_0x2936f2(0x16c)][_0x2936f2(0x10a)](_0x31d316);if(!_0x1161db)return _0x4e6ca1[_0x2936f2(0xf4)](0x194)['json']({'success':![],'message':_0x2936f2(0x13a)});_0x4e6ca1[_0x2936f2(0xd9)]({'success':!![],'result':_0x1161db});}catch(_0x251b79){_0x161134(_0x251b79);}},this[_0x419f16(0x133)]=async(_0x5c3d8b,_0xac7fcc,_0x13dfd1)=>{const _0x3c27be=_0x419f16;try{const {id:_0x4c7f5d}=_0x5c3d8b[_0x3c27be(0xda)];await this[_0x3c27be(0x16c)][_0x3c27be(0x133)](_0x4c7f5d),_0xac7fcc[_0x3c27be(0xd9)]({'success':!![],'message':_0x3c27be(0xfc)});}catch(_0x3c2e9e){_0x13dfd1(_0x3c2e9e);}},this[_0x419f16(0x101)]=async(_0xd35130,_0x8b7909,_0x35bc2e)=>{const _0x1e41de=_0x419f16;try{const {page:page=0x1,limit:limit=0x14,status:_0xa6e9bb,gateway:_0x171fdf,shopId:_0x517f1b,dateFrom:_0x37c403,dateTo:_0x3cd691,search:_0x253d10,currency:_0x4d9514,sortBy:_0x31afab,sortOrder:_0x34c58f}=_0xd35130['query'],_0xdef48={'page':Number(page),'limit':Number(limit),'status':_0xa6e9bb,'gateway':_0x171fdf,'shopId':_0x517f1b,'dateFrom':_0x37c403,'dateTo':_0x3cd691,'search':_0x253d10,'currency':_0x4d9514,'sortBy':_0x31afab,'sortOrder':_0x34c58f},_0x5ca406=await this[_0x1e41de(0x16c)][_0x1e41de(0x10c)](_0xdef48);_0x8b7909['json']({'success':!![],'payments':_0x5ca406[_0x1e41de(0x134)],'pagination':_0x5ca406['pagination'],'statistics':_0x5ca406[_0x1e41de(0x108)]});}catch(_0x52f8ab){_0x35bc2e(_0x52f8ab);}},this['getPaymentById']=async(_0x19dcf5,_0x3f97eb,_0x160743)=>{const _0x2e5aa7=_0x419f16;try{const {id:_0x534bd6}=_0x19dcf5[_0x2e5aa7(0xda)],_0x40824b=await this[_0x2e5aa7(0x16c)]['getPaymentById'](_0x534bd6);if(!_0x40824b)return _0x3f97eb[_0x2e5aa7(0xf4)](0x194)[_0x2e5aa7(0xd9)]({'success':![],'message':_0x2e5aa7(0x172)});_0x3f97eb['json']({'success':!![],'result':_0x40824b});}catch(_0x45a376){_0x160743(_0x45a376);}},this[_0x419f16(0xe7)]=async(_0x23b51a,_0x390cef,_0x2d0bf7)=>{const _0x48633d=_0x419f16;try{const {id:_0x21c453}=_0x23b51a[_0x48633d(0xda)],{status:_0xf911cd,notes:_0x356b7d,chargebackAmount:_0x193fe2}=_0x23b51a[_0x48633d(0x165)],_0x24be3c=await this[_0x48633d(0x16c)][_0x48633d(0x126)](_0x21c453);if(!_0x24be3c)return _0x390cef[_0x48633d(0xf4)](0x194)[_0x48633d(0xd9)]({'success':![],'message':_0x48633d(0x172)});const _0x338ef4=await this[_0x48633d(0x16c)][_0x48633d(0x11e)](_0x21c453,_0xf911cd,_0x356b7d,_0x193fe2);if(_0x24be3c['status']!==_0xf911cd&&_0xf911cd[_0x48633d(0x13b)]()==='PAID'){console['log'](_0x48633d(0xeb)+_0x21c453+_0x48633d(0x123));try{await this[_0x48633d(0x154)][_0x48633d(0x152)](_0x21c453),console['log']('‚úÖ\x20Payment\x20link\x20counter\x20updated\x20for\x20payment\x20'+_0x21c453);}catch(_0x46efe1){console[_0x48633d(0x11f)]('Failed\x20to\x20update\x20payment\x20link\x20counter:',_0x46efe1);}}if(_0x24be3c['status']!==_0xf911cd){console[_0x48633d(0x16e)](_0x48633d(0xfe)+_0x21c453+_0x48633d(0xe1)+_0x24be3c[_0x48633d(0xf4)]+_0x48633d(0x15c)+_0xf911cd+_0x48633d(0x174));try{let _0x4cd5f8;switch(_0xf911cd['toUpperCase']()){case _0x48633d(0x139):_0x4cd5f8='paid';break;case _0x48633d(0x143):_0x4cd5f8=_0x48633d(0x141);break;case _0x48633d(0xfa):_0x4cd5f8=_0x48633d(0x14d);break;case _0x48633d(0x127):_0x4cd5f8=_0x48633d(0x111);break;case'REFUND':_0x4cd5f8=_0x48633d(0xf2);break;case _0x48633d(0x17b):_0x4cd5f8='chargeback';break;default:console['log']('üì±\x20Skipping\x20Telegram\x20notification\x20for\x20status\x20change\x20to:\x20'+_0xf911cd);break;}if(_0x4cd5f8){const _0xafee7e={..._0x338ef4,'shopId':_0x24be3c[_0x48633d(0x149)],'gateway':_0x24be3c[_0x48633d(0x103)],'createdAt':_0x24be3c['createdAt'],'chargebackAmount':_0x193fe2};await telegramBotService_1[_0x48633d(0x105)][_0x48633d(0x142)](_0x24be3c[_0x48633d(0x149)],_0xafee7e,_0x4cd5f8),console[_0x48633d(0x16e)](_0x48633d(0x122)+_0x24be3c['status']+_0x48633d(0x148)+_0xf911cd);}}catch(_0x3c5bca){console[_0x48633d(0x11f)]('Failed\x20to\x20send\x20Telegram\x20notification\x20for\x20status\x20change:',_0x3c5bca);}}_0x390cef[_0x48633d(0xd9)]({'success':!![],'message':_0x48633d(0xe4),'result':_0x338ef4});}catch(_0x28f4f2){_0x2d0bf7(_0x28f4f2);}},this[_0x419f16(0x109)]=async(_0x56a61d,_0x38f857,_0x13805a)=>{const _0xde0f4f=_0x419f16;try{const {id:_0x51e8a1}=_0x56a61d[_0xde0f4f(0xda)],_0x4c46a1=_0x56a61d[_0xde0f4f(0x165)];console[_0xde0f4f(0x16e)](_0xde0f4f(0xf7)+_0x51e8a1+':',_0x4c46a1);const _0x2082c2=await this['adminService'][_0xde0f4f(0x109)](_0x51e8a1,_0x4c46a1);_0x38f857[_0xde0f4f(0xd9)]({'success':!![],'message':_0xde0f4f(0x171),'result':_0x2082c2});}catch(_0x30b49e){_0x13805a(_0x30b49e);}},this['updateUser']=async(_0x183ae7,_0x3e61b7,_0x5cc4d4)=>{const _0x5b3a39=_0x419f16;try{const {id:_0x3d8a4b}=_0x183ae7[_0x5b3a39(0xda)],_0x23263d=_0x183ae7[_0x5b3a39(0x165)],_0x107b69=await this[_0x5b3a39(0x16c)]['updateUser'](_0x3d8a4b,_0x23263d);_0x3e61b7[_0x5b3a39(0xd9)]({'success':!![],'message':_0x5b3a39(0x14f),'result':_0x107b69});}catch(_0x5e14c4){_0x5cc4d4(_0x5e14c4);}},this['suspendUser']=async(_0x2293a7,_0x5c36dd,_0x57e404)=>{const _0x496196=_0x419f16;try{const {id:_0x885942}=_0x2293a7[_0x496196(0xda)],_0x45e664=await this[_0x496196(0x16c)][_0x496196(0x130)](_0x885942);_0x5c36dd[_0x496196(0xd9)]({'success':!![],'message':_0x496196(0x147),'result':_0x45e664});}catch(_0x3a23b2){_0x57e404(_0x3a23b2);}},this[_0x419f16(0x150)]=async(_0x14c18c,_0x50d776,_0x280094)=>{const _0x5732d9=_0x419f16;try{const {id:_0x5cd305}=_0x14c18c[_0x5732d9(0xda)],_0x5521f2=await this[_0x5732d9(0x16c)][_0x5732d9(0x150)](_0x5cd305);_0x50d776[_0x5732d9(0xd9)]({'success':!![],'message':_0x5732d9(0x151),'result':_0x5521f2});}catch(_0x3a8271){_0x280094(_0x3a8271);}},this[_0x419f16(0x124)]=async(_0x113419,_0x14a5bf,_0x3cafcf)=>{const _0x333504=_0x419f16;try{const {page:page=0x1,limit:limit=0x14,status:_0xd7d3cb,search:_0x3e7f59}=_0x113419['query'],_0x2f08d0={'page':Number(page),'limit':Number(limit),'status':_0xd7d3cb,'search':_0x3e7f59},_0x5d43eb=await this[_0x333504(0x16c)][_0x333504(0x163)](_0x2f08d0);_0x14a5bf[_0x333504(0xd9)]({'success':!![],'users':_0x5d43eb[_0x333504(0x168)],'pagination':_0x5d43eb[_0x333504(0x15f)]});}catch(_0x51b0df){_0x3cafcf(_0x51b0df);}},this[_0x419f16(0xd1)]=async(_0x3f4c28,_0x293189,_0x53b55a)=>{const _0x1d86c6=_0x419f16;try{const {id:_0x3ca60a}=_0x3f4c28[_0x1d86c6(0xda)],_0x2741c9=await this['adminService'][_0x1d86c6(0xd1)](_0x3ca60a);if(!_0x2741c9)return _0x293189[_0x1d86c6(0xf4)](0x194)[_0x1d86c6(0xd9)]({'success':![],'message':_0x1d86c6(0x17c)});_0x293189['json']({'success':!![],'result':_0x2741c9});}catch(_0x144e99){_0x53b55a(_0x144e99);}},this['createUser']=async(_0x23d043,_0x3c35d2,_0x455bc4)=>{const _0x3fb62a=_0x419f16;try{const _0xd98a11=_0x23d043[_0x3fb62a(0x165)],_0x463672=await this[_0x3fb62a(0x16c)][_0x3fb62a(0x17f)](_0xd98a11);_0x3c35d2[_0x3fb62a(0xf4)](0xc9)[_0x3fb62a(0xd9)]({'success':!![],'message':_0x3fb62a(0x12b),'result':_0x463672});}catch(_0x6e73a){_0x455bc4(_0x6e73a);}},this[_0x419f16(0x17a)]=async(_0x1843b9,_0x1fe3d4,_0x44ec13)=>{const _0xe1e860=_0x419f16;try{const {id:_0x50a8b0}=_0x1843b9[_0xe1e860(0xda)],{twoFactorToken:_0x54e7b7}=_0x1843b9['body'];await this[_0xe1e860(0x16c)][_0xe1e860(0x17a)](_0x50a8b0,_0x54e7b7),_0x1fe3d4[_0xe1e860(0xd9)]({'success':!![],'message':_0xe1e860(0x153)});}catch(_0x40d462){_0x44ec13(_0x40d462);}},this['getShopWallets']=async(_0x3a163f,_0x38122b,_0x1fbf8a)=>{const _0x5ae0de=_0x419f16;try{const {shopId:_0x23d4c1}=_0x3a163f[_0x5ae0de(0xda)],_0x1178e3=await this[_0x5ae0de(0x16c)][_0x5ae0de(0x138)](_0x23d4c1);_0x38122b[_0x5ae0de(0xd9)]({'success':!![],'wallets':_0x1178e3});}catch(_0x3fadc4){_0x1fbf8a(_0x3fadc4);}},this[_0x419f16(0xde)]=async(_0x5a5132,_0x207fcf,_0x26576e)=>{const _0x5a512a=_0x419f16;try{const {shopId:_0x25864d}=_0x5a5132[_0x5a512a(0xda)],_0x5c41f0=await this[_0x5a512a(0x16c)][_0x5a512a(0xde)](_0x25864d);_0x207fcf[_0x5a512a(0xd9)]({'success':!![],'result':_0x5c41f0});}catch(_0x2ecf92){_0x26576e(_0x2ecf92);}},this[_0x419f16(0x158)]=async(_0x14d9c3,_0x1049b3,_0x5929fd)=>{const _0x25e2a4=_0x419f16;try{const {shopId:_0x548183}=_0x14d9c3[_0x25e2a4(0xda)],{token:_0x2fd155}=_0x14d9c3[_0x25e2a4(0x165)];if(!_0x2fd155)return _0x1049b3[_0x25e2a4(0xf4)](0x190)[_0x25e2a4(0xd9)]({'success':![],'message':_0x25e2a4(0xdf)});const _0x338dfc=await this[_0x25e2a4(0x16c)]['enable2FA'](_0x548183,_0x2fd155);_0x1049b3[_0x25e2a4(0xd9)]({'success':!![],'message':'2FA\x20enabled\x20successfully','result':_0x338dfc});}catch(_0x5beda5){_0x5929fd(_0x5beda5);}},this['disable2FA']=async(_0x5b3506,_0x3bdd84,_0x3b9b24)=>{const _0x360ac9=_0x419f16;try{const {shopId:_0x254183}=_0x5b3506[_0x360ac9(0xda)];await this[_0x360ac9(0x16c)]['disable2FA'](_0x254183),_0x3bdd84[_0x360ac9(0xd9)]({'success':!![],'message':'2FA\x20disabled\x20successfully'});}catch(_0x352bd4){_0x3b9b24(_0x352bd4);}},this[_0x419f16(0x17d)]=async(_0x47a487,_0x48a4ed,_0x2d6bb3)=>{const _0x289526=_0x419f16;try{const _0x2f0bb9=await paymentCleanupService_1[_0x289526(0x119)][_0x289526(0x17d)]();_0x48a4ed[_0x289526(0xd9)]({'success':!![],'result':_0x2f0bb9});}catch(_0x2a08b6){_0x2d6bb3(_0x2a08b6);}},this[_0x419f16(0x178)]=async(_0x45cb52,_0x4870ca,_0x229c40)=>{const _0x1591d4=_0x419f16;try{console[_0x1591d4(0x16e)]('üßπ\x20Manual\x20PROCESSING\x20payment\x20cleanup\x20initiated\x20by\x20admin:\x20'+_0x45cb52[_0x1591d4(0x132)]?.[_0x1591d4(0x162)]+'\x20('+_0x45cb52[_0x1591d4(0x132)]?.['id']+')');const _0x1e06a2=await paymentCleanupService_1[_0x1591d4(0x119)][_0x1591d4(0x125)]();_0x4870ca[_0x1591d4(0xd9)]({'success':!![],'message':_0x1591d4(0xe6),'result':{'processed':_0x1e06a2[_0x1591d4(0x185)],'failed':_0x1e06a2[_0x1591d4(0x14d)],'errors':_0x1e06a2[_0x1591d4(0xe8)]}});}catch(_0x4bfd7d){_0x229c40(_0x4bfd7d);}},this[_0x419f16(0x120)]=async(_0x1c8fd9,_0x4ec4d1,_0x24bc17)=>{const _0x193f6b=_0x419f16;try{console[_0x193f6b(0x16e)]('‚è∞\x20Manual\x20PENDING\x20payment\x20cleanup\x20initiated\x20by\x20admin:\x20'+_0x1c8fd9[_0x193f6b(0x132)]?.['username']+'\x20('+_0x1c8fd9[_0x193f6b(0x132)]?.['id']+')');const _0x518118=await paymentCleanupService_1[_0x193f6b(0x119)]['cleanupStalePendingPayments']();_0x4ec4d1[_0x193f6b(0xd9)]({'success':!![],'message':_0x193f6b(0x10e),'result':{'processed':_0x518118['processed'],'failed':_0x518118[_0x193f6b(0x14d)],'errors':_0x518118[_0x193f6b(0xe8)]}});}catch(_0x498b89){_0x24bc17(_0x498b89);}},this[_0x419f16(0xf6)]=async(_0x44f46d,_0x302c39,_0x3fb632)=>{const _0x2fb05=_0x419f16;try{console[_0x2fb05(0x16e)](_0x2fb05(0x176)+_0x44f46d[_0x2fb05(0x132)]?.[_0x2fb05(0x162)]+'\x20('+_0x44f46d['user']?.['id']+')');const _0x593db5=await paymentCleanupService_1[_0x2fb05(0x119)]['getProcessingPaymentsStats'](),_0xe26661=await paymentCleanupService_1[_0x2fb05(0x119)][_0x2fb05(0x125)](),_0x24b3ef=await paymentCleanupService_1[_0x2fb05(0x119)][_0x2fb05(0x120)](),_0x2b52c7=await paymentCleanupService_1['paymentCleanupService'][_0x2fb05(0x17d)]();_0x302c39[_0x2fb05(0xd9)]({'success':!![],'message':_0x2fb05(0xe5),'result':{'cleanup':{'processing':{'processed':_0xe26661[_0x2fb05(0x185)],'failed':_0xe26661[_0x2fb05(0x14d)],'errors':_0xe26661[_0x2fb05(0xe8)]},'pending':{'processed':_0x24b3ef[_0x2fb05(0x185)],'failed':_0x24b3ef[_0x2fb05(0x14d)],'errors':_0x24b3ef[_0x2fb05(0xe8)]},'total':{'processed':_0xe26661[_0x2fb05(0x185)]+_0x24b3ef['processed'],'failed':_0xe26661[_0x2fb05(0x14d)]+_0x24b3ef[_0x2fb05(0x14d)],'errors':[..._0xe26661[_0x2fb05(0xe8)],..._0x24b3ef['errors']]}},'statistics':{'before':_0x593db5,'after':_0x2b52c7,'reduced':_0x593db5['total']-_0x2b52c7[_0x2fb05(0x13c)]}}});}catch(_0x148c99){_0x3fb632(_0x148c99);}},this['expirePaymentLinks']=async(_0xac92e,_0xb76787,_0x36d734)=>{const _0x514487=_0x419f16;try{const _0x4b3fa1=await paymentCleanupService_1[_0x514487(0x119)][_0x514487(0x155)]();_0xb76787['json']({'success':!![],'message':_0x514487(0xd8),'result':{'expired':_0x4b3fa1[_0x514487(0x111)],'errors':_0x4b3fa1[_0x514487(0xe8)]}});}catch(_0x50b329){_0x36d734(_0x50b329);}},this[_0x419f16(0x183)]=async(_0x99e852,_0x4317d9,_0x2ad2b7)=>{const _0x2704c6=_0x419f16;try{const {currentPassword:_0x2988f2,newPassword:_0x254661,confirmNewPassword:_0x440a0f,twoFactorToken:_0xd356ae}=_0x99e852['body'];await this[_0x2704c6(0x16c)][_0x2704c6(0x183)](_0x2988f2,_0x254661,_0x440a0f,_0xd356ae),_0x4317d9['json']({'success':!![],'message':_0x2704c6(0x15e)});}catch(_0x2e7470){_0x2ad2b7(_0x2e7470);}},this[_0x419f16(0xfd)]=async(_0x47cc78,_0x8c6514,_0x2059bc)=>{const _0x4db74b=_0x419f16;try{const _0x4abd50=await this[_0x4db74b(0x16c)][_0x4db74b(0xfd)]();_0x8c6514[_0x4db74b(0xd9)]({'success':!![],'result':_0x4abd50});}catch(_0x2949a7){_0x2059bc(_0x2949a7);}},this[_0x419f16(0x10b)]=async(_0x3d183a,_0x2e0e93,_0x49abb8)=>{const _0x3c63a8=_0x419f16;try{const _0x1de6d8=await this[_0x3c63a8(0x16c)][_0x3c63a8(0x10b)]();_0x2e0e93[_0x3c63a8(0xd9)]({'success':!![],'result':_0x1de6d8});}catch(_0x126f94){_0x49abb8(_0x126f94);}},this[_0x419f16(0x136)]=async(_0x5739d2,_0x2ed8bd,_0x25e92a)=>{const _0x47211a=_0x419f16;try{const {token:_0x568e3a}=_0x5739d2[_0x47211a(0x165)],_0x1999cf=await this['adminService'][_0x47211a(0x136)](_0x568e3a);_0x2ed8bd[_0x47211a(0xd9)]({'success':!![],'result':_0x1999cf});}catch(_0x307b68){_0x25e92a(_0x307b68);}},this[_0x419f16(0x164)]=async(_0x1f9148,_0x93d8e2,_0x1988d2)=>{const _0x2acb71=_0x419f16;try{await this[_0x2acb71(0x16c)][_0x2acb71(0x164)](),_0x93d8e2['json']({'success':!![],'message':_0x2acb71(0xd3)});}catch(_0x2879b9){_0x1988d2(_0x2879b9);}},this[_0x419f16(0x170)]=async(_0x5a0447,_0x232cfd,_0x16d480)=>{const _0x13e826=_0x419f16;try{const {shopId:_0x30a40b,amount:_0x157cab,notes:_0x39f17d}=_0x5a0447[_0x13e826(0x165)];if(!_0x30a40b||!_0x157cab)return _0x232cfd['status'](0x190)[_0x13e826(0xd9)]({'success':![],'message':_0x13e826(0x131)});if(_0x157cab<=0x0)return _0x232cfd[_0x13e826(0xf4)](0x190)[_0x13e826(0xd9)]({'success':![],'message':_0x13e826(0x113)});await this[_0x13e826(0x16c)][_0x13e826(0x170)](_0x30a40b,_0x157cab,_0x39f17d),_0x232cfd[_0x13e826(0xd9)]({'success':!![],'message':_0x13e826(0x107)});}catch(_0x2758ea){_0x16d480(_0x2758ea);}},this['getLoginLogs']=async(_0x38ec37,_0x1da2b9,_0x40c4c4)=>{const _0x6f5406=_0x419f16;try{const {shopId:_0x3b2580}=_0x38ec37[_0x6f5406(0xda)],{page:page='1',limit:limit='20'}=_0x38ec37['query'],_0x30af26=(await Promise[_0x6f5406(0x117)]()[_0x6f5406(0x144)](()=>__importStar(require(_0x6f5406(0x15b)))))['default'],_0x53f8e1=parseInt(page,0xa),_0xa21322=parseInt(limit,0xa),_0x1eaef2=(_0x53f8e1-0x1)*_0xa21322,[_0x3ba336,_0x29265b]=await Promise[_0x6f5406(0xfb)]([_0x30af26[_0x6f5406(0xef)][_0x6f5406(0x166)]({'where':{'shopId':_0x3b2580},'orderBy':{'createdAt':_0x6f5406(0xed)},'skip':_0x1eaef2,'take':_0xa21322}),_0x30af26['loginLog'][_0x6f5406(0xec)]({'where':{'shopId':_0x3b2580}})]);_0x1da2b9[_0x6f5406(0xd9)]({'success':!![],'result':{'logs':_0x3ba336,'pagination':{'page':_0x53f8e1,'limit':_0xa21322,'total':_0x29265b,'totalPages':Math[_0x6f5406(0x167)](_0x29265b/_0xa21322)}}});}catch(_0x26d43b){_0x40c4c4(_0x26d43b);}},this[_0x419f16(0x16b)]=async(_0x2ce105,_0x351e40,_0x4d8bf8)=>{const _0x5bb29e=_0x419f16;try{const _0x369d6e=gatewaySettingsService_1[_0x5bb29e(0x137)][_0x5bb29e(0x118)]();_0x351e40[_0x5bb29e(0xd9)]({'success':!![],'result':_0x369d6e});}catch(_0x45cb05){_0x4d8bf8(_0x45cb05);}},this['updateGatewaySettings']=async(_0x524c86,_0x2cc148,_0x1d280d)=>{const _0x1b18a5=_0x419f16;try{const {gatewayId:_0xa5ee6c}=_0x524c86[_0x1b18a5(0xda)],{minAmount:_0x4ff34e,maxAmount:_0x228cf5,payoutDelay:_0x252ba9,gatewayCommission:_0x17ec49}=_0x524c86[_0x1b18a5(0x165)],_0x510177=gatewaySettingsService_1[_0x1b18a5(0x137)]['updateSettings'](_0xa5ee6c,{'minAmount':_0x4ff34e!==undefined?Number(_0x4ff34e):undefined,'maxAmount':_0x228cf5!==undefined?Number(_0x228cf5):undefined,'payoutDelay':_0x252ba9!==undefined?Number(_0x252ba9):undefined,'gatewayCommission':_0x17ec49!==undefined?Number(_0x17ec49):undefined});_0x2cc148['json']({'success':!![],'message':'Gateway\x20settings\x20updated\x20successfully','result':_0x510177});}catch(_0x3c140e){_0x1d280d(_0x3c140e);}},this[_0x419f16(0x13e)]=async(_0x43a2d4,_0x405429,_0x28962c)=>{const _0x3ead67=_0x419f16;try{const {gatewayId:_0x341a5b}=_0x43a2d4[_0x3ead67(0xda)];console['log'](_0x3ead67(0x146)+_0x341a5b);const {GATEWAY_ID_MAP:_0x1b31d3}=await Promise[_0x3ead67(0x117)]()[_0x3ead67(0x144)](()=>__importStar(require(_0x3ead67(0xea)))),_0x507d43=_0x1b31d3[_0x341a5b];console[_0x3ead67(0x16e)](_0x3ead67(0x116)+_0x341a5b+_0x3ead67(0xf5)+_0x507d43);if(!_0x507d43)return console[_0x3ead67(0x16e)]('‚ùå\x20[GATEWAY\x20STATS]\x20Gateway\x20not\x20found\x20for\x20ID:\x20'+_0x341a5b),_0x405429[_0x3ead67(0xf4)](0x194)[_0x3ead67(0xd9)]({'success':![],'message':_0x3ead67(0x169)});console[_0x3ead67(0x16e)]('üîç\x20[GATEWAY\x20STATS]\x20Querying\x20payments\x20with\x20gateway=\x22'+_0x507d43+_0x3ead67(0x128));const _0x1f8a63=await database_1[_0x3ead67(0x10f)]['payment'][_0x3ead67(0x166)]({'where':{'gateway':_0x507d43},'select':{'id':!![],'status':!![],'amountUSDT':!![]},'take':0x5});console[_0x3ead67(0x16e)]('üîç\x20[GATEWAY\x20STATS]\x20Sample\x20payments\x20for\x20'+_0x507d43+':',JSON['stringify'](_0x1f8a63,null,0x2));const _0x54eeda=await database_1[_0x3ead67(0x10f)][_0x3ead67(0xf8)]['aggregate']({'where':{'gateway':_0x507d43,'status':_0x3ead67(0x139)},'_sum':{'amountUSDT':!![],'amountAfterGatewayCommissionUSDT':!![]},'_count':{'_all':!![]}});console[_0x3ead67(0x16e)](_0x3ead67(0xd4),JSON[_0x3ead67(0x11c)](_0x54eeda,null,0x2));const _0x399c70=await database_1[_0x3ead67(0x10f)][_0x3ead67(0xf8)][_0x3ead67(0xec)]({'where':{'gateway':_0x507d43,'status':_0x3ead67(0x17b)}});console[_0x3ead67(0x16e)](_0x3ead67(0x15d)+_0x399c70);const _0x2ee7bc=await database_1['default']['payment'][_0x3ead67(0xec)]({'where':{'gateway':_0x507d43,'status':_0x3ead67(0x110)}});console[_0x3ead67(0x16e)]('üí∏\x20[GATEWAY\x20STATS]\x20Refund\x20count:\x20'+_0x2ee7bc);const _0x3cfbc4=_0x54eeda[_0x3ead67(0x10d)][_0x3ead67(0xdb)]||0x0,_0x44068d=(_0x54eeda['_sum'][_0x3ead67(0xdb)]||0x0)-(_0x54eeda[_0x3ead67(0x10d)][_0x3ead67(0xd5)]||0x0),_0x198d9e=_0x54eeda[_0x3ead67(0xd7)][_0x3ead67(0x16d)],_0x567e8a=_0x198d9e>0x0?_0x399c70/_0x198d9e*0x64:0x0;console[_0x3ead67(0x16e)]('üìà\x20[GATEWAY\x20STATS]\x20Calculated\x20statistics:'),console[_0x3ead67(0x16e)](_0x3ead67(0xe3)+_0x3cfbc4),console[_0x3ead67(0x16e)](_0x3ead67(0x100)+_0x44068d),console['log']('\x20\x20\x20-\x20Successful\x20Payments:\x20'+_0x198d9e),console[_0x3ead67(0x16e)]('\x20\x20\x20-\x20Chargeback\x20Rate:\x20'+_0x567e8a+'%'),_0x405429[_0x3ead67(0xd9)]({'success':!![],'result':{'gatewayId':_0x341a5b,'totalTurnover':Number(_0x3cfbc4[_0x3ead67(0xe0)](0x2)),'totalCommission':Number(_0x44068d[_0x3ead67(0xe0)](0x2)),'successfulPayments':_0x198d9e,'chargebackCount':_0x399c70,'chargebackRate':Number(_0x567e8a[_0x3ead67(0xe0)](0x2)),'refundCount':_0x2ee7bc}});}catch(_0x5cd5e6){console[_0x3ead67(0x11f)]('‚ùå\x20[GATEWAY\x20STATS]\x20Error:',_0x5cd5e6),_0x28962c(_0x5cd5e6);}},this[_0x419f16(0x16c)]=new adminService_1[(_0x419f16(0x157))](),this[_0x419f16(0x154)]=new paymentLinkService_1[(_0x419f16(0x11d))]();}}function a4_0x28d2(_0x496c5d,_0x5abe5c){_0x496c5d=_0x496c5d-0xd0;const _0x132b37=a4_0x132b();let _0x28d2df=_0x132b37[_0x496c5d];return _0x28d2df;}exports[a4_0x3032dd(0x12f)]=AdminController;