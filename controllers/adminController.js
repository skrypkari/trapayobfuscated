'use strict';const a4_0x91851f=a4_0x3d18;(function(_0x1411da,_0x2c99e8){const _0x29fca3=a4_0x3d18,_0x569bad=_0x1411da();while(!![]){try{const _0x22ceb7=parseInt(_0x29fca3(0x155))/0x1*(-parseInt(_0x29fca3(0x14d))/0x2)+parseInt(_0x29fca3(0x1a9))/0x3*(parseInt(_0x29fca3(0x1a7))/0x4)+parseInt(_0x29fca3(0x194))/0x5*(parseInt(_0x29fca3(0x165))/0x6)+-parseInt(_0x29fca3(0x1a4))/0x7+-parseInt(_0x29fca3(0x1ab))/0x8+parseInt(_0x29fca3(0x173))/0x9+parseInt(_0x29fca3(0x1f1))/0xa*(parseInt(_0x29fca3(0x16c))/0xb);if(_0x22ceb7===_0x2c99e8)break;else _0x569bad['push'](_0x569bad['shift']());}catch(_0x440396){_0x569bad['push'](_0x569bad['shift']());}}}(a4_0x1ce8,0x74695));function a4_0x1ce8(){const _0x499911=['üìä\x20Admin\x20requesting\x20payout\x20reports:','PAID','pagination','getMerchantStatistics','cleanupStalePayments','üîô\x20[GATEWAY\x20STATS]\x20Chargeback\x20count:\x20','log','all','üìà\x20Admin\x20changed\x20payment\x20','get2FASettings','Payout\x20updated\x20successfully','amountAfterGatewayCommissionUSDT','checkAuth','\x20with\x20data:','2715rUYmxH','updatePayment','toFixed','changeAdminPassword','processed','create','hasPayoutHistory','\x20->\x20Gateway\x20Name:\x20','toUpperCase','getMerchantsSelection','‚è∞\x20Manual\x20PENDING\x20payment\x20cleanup\x20initiated\x20by\x20admin:\x20','getAllPayouts','Payout\x20created\x20successfully','role','cleanupStalePendingPayments','gatewaySettingsService','5316346oEaHkl','__importStar','../types/gateway','392508vOYHIl','status','12UAykui','../services/gatewaySettingsService','4980296lNwOTO','summary','Payout\x20not\x20found','User\x20suspended\x20successfully','\x20\x20\x20-\x20Total\x20Commission:\x20','Admin\x202FA\x20disabled\x20successfully','default','üßπ\x20Manual\x20PROCESSING\x20payment\x20cleanup\x20initiated\x20by\x20admin:\x20','updatePayout','Failed\x20to\x20update\x20payment\x20link\x20counter:','createUser','defineProperty','paymentLinkService','query','shopId','call','refund','amountUSDT','aggregate','Payment\x20not\x20found','total','enableAdmin2FA','üí∏\x20[GATEWAY\x20STATS]\x20Refund\x20count:\x20','üîç\x20[GATEWAY\x20STATS]\x20Querying\x20payments\x20with\x20gateway=\x22','Payment\x20updated\x20successfully',',\x20sending\x20Telegram\x20notification','paymentCleanupService','üì±\x20Payment\x20','getGatewaySettings','updateGatewaySettings','prototype','\x20\x20\x20-\x20Chargeback\x20Rate:\x20','Amount\x20must\x20be\x20greater\x20than\x200','hasOwnProperty','‚ùå\x20[GATEWAY\x20STATS]\x20Error:','telegramBotService','PROCESSING\x20payment\x20cleanup\x20completed\x20successfully','__importDefault','payouts','User\x20activated\x20successfully','paid','\x20to\x20','EXPIRED','periodFrom,\x20periodTo,\x20and\x20gateway\x20are\x20required','updatePaymentStatus','getPaymentById','getSystemStatistics','stringify','Gateway\x20settings\x20updated\x20successfully','__esModule','updateCustomerData','desc','getOwnPropertyDescriptor','getPayouts','createPayout','then','üìä\x20Manual\x20payment\x20cleanup\x20(PROCESSING\x20+\x20PENDING)\x20with\x20report\x20initiated\x20by\x20admin:\x20','resolve','‚úÖ\x20Telegram\x20notification\x20sent\x20for\x20status\x20change:\x20','disable2FA','body','getAllUsers','username','gateway','get','sendPaymentNotification','updateUser','errors','üìä\x20Admin\x20requesting\x20merchant\x20statistics\x20with\x20filters:','üéØ\x20[CONTROLLER]\x20Creating\x20payout\x20with\x20data:','20YbkZkH','2FA\x20enabled\x20successfully','expired','createdAt','loginLog','_all','üìà\x20[GATEWAY\x20STATS]\x20Calculated\x20statistics:','üìä\x20[GATEWAY\x20STATS]\x20Requesting\x20statistics\x20for\x20gateway\x20ID:\x20','\x20\x20\x20-\x20Total\x20Turnover:\x20','json','payments','__setModuleDefault','error','disableAdmin2FA','setupAdmin2FA','30d','üîÑ\x20Admin\x20updating\x20customer\x20data\x20for\x20payment\x20','getStatistics','ceil','writable','FAILED','42380yDqEBK','getProcessingPaymentsStats','findMany','üéØ\x20[CONTROLLER]\x20Updating\x20payout\x20','getMerchantsAwaitingPayout','shopId\x20and\x20amount\x20are\x20required','../config/database','chargeback','34LmzgrK','CHARGEBACK','_sum','enable2FA','adminService','../services/paymentCleanupService','cleanupStalePaymentsWithReport','Balance\x20deposited\x20successfully','activateUser','getPayoutById','payment','getShopWallets','REFUND','PaymentLinkService','expireSinglePaymentLinks','getPayoutStats','5178yHRIQj','processing','‚ùå\x20[GATEWAY\x20STATS]\x20Gateway\x20not\x20found\x20for\x20ID:\x20','users','\x20status\x20changed\x20from\x20','user','User\x20created\x20successfully','6283629QKKWnK','getAllGatewaysWithSettings','Payment\x20link\x20expiration\x20check\x20completed\x20successfully','AdminController','suspendUser','params','\x20to\x20PAID,\x20updating\x20payment\x20link\x20counter','5181309ADizLz','üí∞\x20[GATEWAY\x20STATS]\x20Paid\x20payments\x20result:','true','length','üì±\x20Skipping\x20Telegram\x20notification\x20for\x20status\x20change\x20to:\x20','‚úÖ\x20Payment\x20link\x20counter\x20updated\x20for\x20payment\x20','../services/paymentLinkService','../services/telegramBotService','getPayoutReports','count','Customer\x20data\x20updated\x20successfully','getUserById','Admin\x20password\x20changed\x20successfully','setup2FA','updateSettings','2FA\x20disabled\x20successfully','failed','../services/adminService','depositBalance'];a4_0x1ce8=function(){return _0x499911;};return a4_0x1ce8();}var __createBinding=this&&this['__createBinding']||(Object[a4_0x91851f(0x199)]?function(_0x40bf55,_0x51f9e2,_0x36c29e,_0x361975){const _0x478f2b=a4_0x91851f;if(_0x361975===undefined)_0x361975=_0x36c29e;var _0x55f8e9=Object[_0x478f2b(0x1df)](_0x51f9e2,_0x36c29e);(!_0x55f8e9||(_0x478f2b(0x1eb)in _0x55f8e9?!_0x51f9e2[_0x478f2b(0x1dc)]:_0x55f8e9[_0x478f2b(0x14b)]||_0x55f8e9['configurable']))&&(_0x55f8e9={'enumerable':!![],'get':function(){return _0x51f9e2[_0x36c29e];}}),Object[_0x478f2b(0x1b6)](_0x40bf55,_0x361975,_0x55f8e9);}:function(_0x59b5ef,_0x29993c,_0x3b8de7,_0x3c35c9){if(_0x3c35c9===undefined)_0x3c35c9=_0x3b8de7;_0x59b5ef[_0x3c35c9]=_0x29993c[_0x3b8de7];}),__setModuleDefault=this&&this[a4_0x91851f(0x1fc)]||(Object[a4_0x91851f(0x199)]?function(_0x10a97e,_0x1eca72){const _0x54155c=a4_0x91851f;Object['defineProperty'](_0x10a97e,_0x54155c(0x1b1),{'enumerable':!![],'value':_0x1eca72});}:function(_0x3fac5e,_0x5deaa1){const _0x348df1=a4_0x91851f;_0x3fac5e[_0x348df1(0x1b1)]=_0x5deaa1;}),__importStar=this&&this[a4_0x91851f(0x1a5)]||(function(){var _0x283b99=function(_0x5311b6){return _0x283b99=Object['getOwnPropertyNames']||function(_0x23b213){const _0x25cdbd=a4_0x3d18;var _0x3a68ea=[];for(var _0x32ebf4 in _0x23b213)if(Object[_0x25cdbd(0x1c9)][_0x25cdbd(0x1cc)][_0x25cdbd(0x1ba)](_0x23b213,_0x32ebf4))_0x3a68ea[_0x3a68ea[_0x25cdbd(0x176)]]=_0x32ebf4;return _0x3a68ea;},_0x283b99(_0x5311b6);};return function(_0x96586e){const _0x1fc094=a4_0x3d18;if(_0x96586e&&_0x96586e['__esModule'])return _0x96586e;var _0x18b68a={};if(_0x96586e!=null){for(var _0x1ab61b=_0x283b99(_0x96586e),_0x223240=0x0;_0x223240<_0x1ab61b['length'];_0x223240++)if(_0x1ab61b[_0x223240]!==_0x1fc094(0x1b1))__createBinding(_0x18b68a,_0x96586e,_0x1ab61b[_0x223240]);}return __setModuleDefault(_0x18b68a,_0x96586e),_0x18b68a;};}()),__importDefault=this&&this[a4_0x91851f(0x1d0)]||function(_0x3c68e1){return _0x3c68e1&&_0x3c68e1['__esModule']?_0x3c68e1:{'default':_0x3c68e1};};function a4_0x3d18(_0xcf2d94,_0x2d45f9){_0xcf2d94=_0xcf2d94-0x146;const _0x1ce8aa=a4_0x1ce8();let _0x3d18f7=_0x1ce8aa[_0xcf2d94];return _0x3d18f7;}Object[a4_0x91851f(0x1b6)](exports,a4_0x91851f(0x1dc),{'value':!![]}),exports['AdminController']=void 0x0;const adminService_1=require(a4_0x91851f(0x184)),paymentLinkService_1=require(a4_0x91851f(0x179)),paymentCleanupService_1=require(a4_0x91851f(0x15a)),telegramBotService_1=require(a4_0x91851f(0x17a)),gatewaySettingsService_1=require(a4_0x91851f(0x1aa)),database_1=__importDefault(require(a4_0x91851f(0x153)));class AdminController{constructor(){const _0x35c961=a4_0x91851f;this[_0x35c961(0x192)]=async(_0x18116c,_0x2cb334,_0xb53781)=>{const _0x2bcb7f=_0x35c961;try{const _0x6cb04f=_0x18116c['user'];_0x2cb334['json']({'success':!![],'message':'Admin\x20access\x20confirmed','user':{'id':_0x6cb04f?.['id'],'username':_0x6cb04f?.[_0x2bcb7f(0x1e9)],'role':_0x6cb04f?.[_0x2bcb7f(0x1a1)]}});}catch(_0x3d66eb){_0xb53781(_0x3d66eb);}},this[_0x35c961(0x149)]=async(_0x4cbc5f,_0x5c1061,_0x1683ee)=>{const _0x5a6e13=_0x35c961;try{const {period:period=_0x5a6e13(0x147),currentDate:_0xc1b031}=_0x4cbc5f[_0x5a6e13(0x1b8)],_0x20446f=await this['adminService'][_0x5a6e13(0x1d9)](period,_0xc1b031);_0x5c1061[_0x5a6e13(0x1fa)]({'success':!![],'result':_0x20446f});}catch(_0x27ce8f){_0x1683ee(_0x27ce8f);}},this[_0x35c961(0x189)]=async(_0xd277ac,_0x2aff4d,_0x531991)=>{const _0x234d53=_0x35c961;try{const {shopId:_0x2712c8,period:period='month',dateFrom:_0x5960fc,dateTo:_0x1f8700}=_0xd277ac[_0x234d53(0x1b8)],_0x24c7ed={'shopId':_0x2712c8,'period':period,'dateFrom':_0x5960fc,'dateTo':_0x1f8700};console[_0x234d53(0x18c)](_0x234d53(0x1ef),_0x24c7ed);const _0x21fca0=await this[_0x234d53(0x159)][_0x234d53(0x189)](_0x24c7ed);_0x2aff4d[_0x234d53(0x1fa)]({'success':!![],'result':_0x21fca0});}catch(_0x23b490){_0x531991(_0x23b490);}},this[_0x35c961(0x17b)]=async(_0x4a73a0,_0x2c5eb3,_0x4dd350)=>{const _0x3f9a35=_0x35c961;try{const {periodFrom:_0x599969,periodTo:_0x201969,gateway:_0x330acd}=_0x4a73a0[_0x3f9a35(0x1b8)];if(!_0x599969||!_0x201969||!_0x330acd)return _0x2c5eb3[_0x3f9a35(0x1a8)](0x190)[_0x3f9a35(0x1fa)]({'success':![],'message':_0x3f9a35(0x1d6)});console[_0x3f9a35(0x18c)](_0x3f9a35(0x186),{'periodFrom':_0x599969,'periodTo':_0x201969,'gateway':_0x330acd});const _0x306d3f=await this[_0x3f9a35(0x159)][_0x3f9a35(0x17b)]({'periodFrom':_0x599969,'periodTo':_0x201969,'gateway':_0x330acd});_0x2c5eb3['json']({'success':!![],'reports':_0x306d3f});}catch(_0x1add06){_0x4dd350(_0x1add06);}},this['getPayoutStats']=async(_0x55cfbb,_0x1f5b97,_0x22dca9)=>{const _0x3b1db3=_0x35c961;try{const _0x29c792=await this[_0x3b1db3(0x159)][_0x3b1db3(0x164)]();_0x1f5b97[_0x3b1db3(0x1fa)]({'success':!![],'result':_0x29c792});}catch(_0x1faeda){_0x22dca9(_0x1faeda);}},this[_0x35c961(0x151)]=async(_0x25a735,_0x26b5ac,_0x4cfb65)=>{const _0x2e0829=_0x35c961;try{const {page:page=0x1,limit:limit=0x14,minAmount:_0x221c22,search:_0x5aee81}=_0x25a735[_0x2e0829(0x1b8)],_0x330c68={'page':Number(page),'limit':Number(limit),'minAmount':_0x221c22?Number(_0x221c22):undefined,'search':_0x5aee81},_0x4969d9=await this[_0x2e0829(0x159)][_0x2e0829(0x151)](_0x330c68);_0x26b5ac[_0x2e0829(0x1fa)]({'success':!![],'merchants':_0x4969d9['merchants'],'pagination':_0x4969d9[_0x2e0829(0x188)],'summary':_0x4969d9[_0x2e0829(0x1ac)]});}catch(_0x296457){_0x4cfb65(_0x296457);}},this[_0x35c961(0x19d)]=async(_0x2dd660,_0x2f75b6,_0x562026)=>{const _0x1a0a97=_0x35c961;try{const _0x4d385c=_0x2dd660['query'][_0x1a0a97(0x19a)]===_0x1a0a97(0x175),_0x308ebd=await this[_0x1a0a97(0x159)]['getMerchantsSelection'](_0x4d385c);_0x2f75b6[_0x1a0a97(0x1fa)]({'success':!![],'result':_0x308ebd});}catch(_0x5a12b8){_0x562026(_0x5a12b8);}},this['createPayout']=async(_0x498ad7,_0x3fdff5,_0x40f2fb)=>{const _0x1f85ac=_0x35c961;try{const _0x52ad52=_0x498ad7['body'];console['log'](_0x1f85ac(0x1f0),_0x52ad52);const _0x4938d9=await this[_0x1f85ac(0x159)][_0x1f85ac(0x1e1)](_0x52ad52);_0x3fdff5[_0x1f85ac(0x1a8)](0xc9)[_0x1f85ac(0x1fa)]({'success':!![],'message':_0x1f85ac(0x1a0),'result':_0x4938d9});}catch(_0x16f6ed){_0x40f2fb(_0x16f6ed);}},this[_0x35c961(0x1b3)]=async(_0x292b26,_0x4b3624,_0xfaee74)=>{const _0x2d517f=_0x35c961;try{const {id:_0x2bf162}=_0x292b26[_0x2d517f(0x171)],_0x1da6cb=_0x292b26['body'];console['log'](_0x2d517f(0x150)+_0x2bf162+_0x2d517f(0x193),_0x1da6cb);const _0x4b2564=await this[_0x2d517f(0x159)][_0x2d517f(0x1b3)](_0x2bf162,_0x1da6cb);_0x4b3624['json']({'success':!![],'message':_0x2d517f(0x190),'result':_0x4b2564});}catch(_0x41c38b){_0xfaee74(_0x41c38b);}},this[_0x35c961(0x1e0)]=async(_0x5c3c77,_0x44216a,_0x1b6540)=>{const _0x2b990=_0x35c961;try{const {page:page=0x1,limit:limit=0x14,shopId:_0x222340,network:_0x408b79,dateFrom:_0x46f667,dateTo:_0x318436,search:_0x5d7591}=_0x5c3c77[_0x2b990(0x1b8)],_0x2c07fc={'page':Number(page),'limit':Number(limit),'shopId':_0x222340,'network':_0x408b79,'dateFrom':_0x46f667,'dateTo':_0x318436,'search':_0x5d7591},_0x3e9f39=await this[_0x2b990(0x159)][_0x2b990(0x19f)](_0x2c07fc);_0x44216a[_0x2b990(0x1fa)]({'success':!![],'payouts':_0x3e9f39[_0x2b990(0x1d1)],'pagination':_0x3e9f39[_0x2b990(0x188)]});}catch(_0x6d047a){_0x1b6540(_0x6d047a);}},this[_0x35c961(0x15e)]=async(_0x14c76f,_0x243081,_0x3f54a8)=>{const _0x2ff3b0=_0x35c961;try{const {id:_0x44cd9b}=_0x14c76f[_0x2ff3b0(0x171)],_0x206578=await this['adminService'][_0x2ff3b0(0x15e)](_0x44cd9b);if(!_0x206578)return _0x243081[_0x2ff3b0(0x1a8)](0x194)[_0x2ff3b0(0x1fa)]({'success':![],'message':_0x2ff3b0(0x1ad)});_0x243081[_0x2ff3b0(0x1fa)]({'success':!![],'result':_0x206578});}catch(_0x496d73){_0x3f54a8(_0x496d73);}},this['deletePayout']=async(_0x254c24,_0x437493,_0x34da5a)=>{const _0x4ce16b=_0x35c961;try{const {id:_0x4cf702}=_0x254c24[_0x4ce16b(0x171)];await this[_0x4ce16b(0x159)]['deletePayout'](_0x4cf702),_0x437493['json']({'success':!![],'message':'Payout\x20deleted\x20successfully'});}catch(_0x53e10c){_0x34da5a(_0x53e10c);}},this['getPayments']=async(_0x594327,_0x867dca,_0x569171)=>{const _0x4276db=_0x35c961;try{const {page:page=0x1,limit:limit=0x14,status:_0x421f4e,gateway:_0x3977ea,shopId:_0x97f525,dateFrom:_0x3d0774,dateTo:_0x16f673,search:_0x574a74,currency:_0x2c1000,sortBy:_0x59a827,sortOrder:_0x3b1fa7}=_0x594327[_0x4276db(0x1b8)],_0x44384b={'page':Number(page),'limit':Number(limit),'status':_0x421f4e,'gateway':_0x3977ea,'shopId':_0x97f525,'dateFrom':_0x3d0774,'dateTo':_0x16f673,'search':_0x574a74,'currency':_0x2c1000,'sortBy':_0x59a827,'sortOrder':_0x3b1fa7},_0x4a5b35=await this[_0x4276db(0x159)]['getAllPayments'](_0x44384b);_0x867dca[_0x4276db(0x1fa)]({'success':!![],'payments':_0x4a5b35[_0x4276db(0x1fb)],'pagination':_0x4a5b35[_0x4276db(0x188)],'statistics':_0x4a5b35['statistics']});}catch(_0x4887e9){_0x569171(_0x4887e9);}},this['getPaymentById']=async(_0x178dba,_0x220abb,_0x3c9403)=>{const _0x27af42=_0x35c961;try{const {id:_0x5294d8}=_0x178dba[_0x27af42(0x171)],_0x490048=await this[_0x27af42(0x159)][_0x27af42(0x1d8)](_0x5294d8);if(!_0x490048)return _0x220abb[_0x27af42(0x1a8)](0x194)[_0x27af42(0x1fa)]({'success':![],'message':_0x27af42(0x1be)});_0x220abb['json']({'success':!![],'result':_0x490048});}catch(_0x59619f){_0x3c9403(_0x59619f);}},this[_0x35c961(0x195)]=async(_0x51096b,_0x3656ed,_0x5a5ba6)=>{const _0x1c375b=_0x35c961;try{const {id:_0x922e46}=_0x51096b['params'],{status:_0x4d4898,notes:_0x173a07,chargebackAmount:_0x3be4e3}=_0x51096b['body'],_0x864d82=await this['adminService'][_0x1c375b(0x1d8)](_0x922e46);if(!_0x864d82)return _0x3656ed['status'](0x194)[_0x1c375b(0x1fa)]({'success':![],'message':_0x1c375b(0x1be)});const _0x42c914=await this['adminService'][_0x1c375b(0x1d7)](_0x922e46,_0x4d4898,_0x173a07,_0x3be4e3);if(_0x864d82[_0x1c375b(0x1a8)]!==_0x4d4898&&_0x4d4898[_0x1c375b(0x19c)]()===_0x1c375b(0x187)){console[_0x1c375b(0x18c)](_0x1c375b(0x18e)+_0x922e46+_0x1c375b(0x172));try{await this['paymentLinkService']['handleSuccessfulPayment'](_0x922e46),console['log'](_0x1c375b(0x178)+_0x922e46);}catch(_0x41fcc9){console['error'](_0x1c375b(0x1b4),_0x41fcc9);}}if(_0x864d82['status']!==_0x4d4898){console[_0x1c375b(0x18c)](_0x1c375b(0x1c6)+_0x922e46+_0x1c375b(0x169)+_0x864d82[_0x1c375b(0x1a8)]+_0x1c375b(0x1d4)+_0x4d4898+_0x1c375b(0x1c4));try{let _0x4cad25;switch(_0x4d4898['toUpperCase']()){case _0x1c375b(0x187):_0x4cad25=_0x1c375b(0x1d3);break;case'PROCESSING':_0x4cad25=_0x1c375b(0x166);break;case _0x1c375b(0x14c):_0x4cad25=_0x1c375b(0x183);break;case _0x1c375b(0x1d5):_0x4cad25=_0x1c375b(0x1f3);break;case _0x1c375b(0x161):_0x4cad25=_0x1c375b(0x1bb);break;case _0x1c375b(0x156):_0x4cad25=_0x1c375b(0x154);break;default:console[_0x1c375b(0x18c)](_0x1c375b(0x177)+_0x4d4898);break;}if(_0x4cad25){const _0x5b7cce={..._0x42c914,'shopId':_0x864d82[_0x1c375b(0x1b9)],'gateway':_0x864d82[_0x1c375b(0x1ea)],'createdAt':_0x864d82[_0x1c375b(0x1f4)],'chargebackAmount':_0x3be4e3};await telegramBotService_1[_0x1c375b(0x1ce)][_0x1c375b(0x1ec)](_0x864d82[_0x1c375b(0x1b9)],_0x5b7cce,_0x4cad25),console[_0x1c375b(0x18c)](_0x1c375b(0x1e5)+_0x864d82[_0x1c375b(0x1a8)]+'\x20->\x20'+_0x4d4898);}}catch(_0x1693f5){console[_0x1c375b(0x1fd)]('Failed\x20to\x20send\x20Telegram\x20notification\x20for\x20status\x20change:',_0x1693f5);}}_0x3656ed[_0x1c375b(0x1fa)]({'success':!![],'message':_0x1c375b(0x1c3),'result':_0x42c914});}catch(_0x4849c5){_0x5a5ba6(_0x4849c5);}},this[_0x35c961(0x1dd)]=async(_0x434478,_0x337b79,_0x49a5ba)=>{const _0x455d23=_0x35c961;try{const {id:_0x3f3e1a}=_0x434478['params'],_0x323655=_0x434478[_0x455d23(0x1e7)];console[_0x455d23(0x18c)](_0x455d23(0x148)+_0x3f3e1a+':',_0x323655);const _0x4ffeab=await this[_0x455d23(0x159)][_0x455d23(0x1dd)](_0x3f3e1a,_0x323655);_0x337b79[_0x455d23(0x1fa)]({'success':!![],'message':_0x455d23(0x17d),'result':_0x4ffeab});}catch(_0x5f04b3){_0x49a5ba(_0x5f04b3);}},this['updateUser']=async(_0x26b7e7,_0x2ad5c2,_0x1bd94f)=>{const _0x4abedb=_0x35c961;try{const {id:_0x53206b}=_0x26b7e7['params'],_0x27338d=_0x26b7e7[_0x4abedb(0x1e7)],_0x4a15b9=await this[_0x4abedb(0x159)][_0x4abedb(0x1ed)](_0x53206b,_0x27338d);_0x2ad5c2['json']({'success':!![],'message':'User\x20updated\x20successfully','result':_0x4a15b9});}catch(_0x3a6a6c){_0x1bd94f(_0x3a6a6c);}},this[_0x35c961(0x170)]=async(_0xcb7628,_0x3883fc,_0x8964b5)=>{const _0x351f07=_0x35c961;try{const {id:_0x443bf0}=_0xcb7628[_0x351f07(0x171)],_0x5b7172=await this[_0x351f07(0x159)]['suspendUser'](_0x443bf0);_0x3883fc[_0x351f07(0x1fa)]({'success':!![],'message':_0x351f07(0x1ae),'result':_0x5b7172});}catch(_0x2c026b){_0x8964b5(_0x2c026b);}},this[_0x35c961(0x15d)]=async(_0x58ac87,_0xeaebe7,_0x3d9d65)=>{const _0x1e4070=_0x35c961;try{const {id:_0x2dc904}=_0x58ac87[_0x1e4070(0x171)],_0x3875f2=await this[_0x1e4070(0x159)][_0x1e4070(0x15d)](_0x2dc904);_0xeaebe7[_0x1e4070(0x1fa)]({'success':!![],'message':_0x1e4070(0x1d2),'result':_0x3875f2});}catch(_0x20cb56){_0x3d9d65(_0x20cb56);}},this['getUsers']=async(_0x57c428,_0x11926a,_0x1ab28b)=>{const _0x3bd863=_0x35c961;try{const {page:page=0x1,limit:limit=0x14,status:_0x5144c6,search:_0x582094}=_0x57c428['query'],_0x109615={'page':Number(page),'limit':Number(limit),'status':_0x5144c6,'search':_0x582094},_0x48d29f=await this[_0x3bd863(0x159)][_0x3bd863(0x1e8)](_0x109615);_0x11926a[_0x3bd863(0x1fa)]({'success':!![],'users':_0x48d29f[_0x3bd863(0x168)],'pagination':_0x48d29f[_0x3bd863(0x188)]});}catch(_0xaf8dd9){_0x1ab28b(_0xaf8dd9);}},this[_0x35c961(0x17e)]=async(_0x1870ba,_0x441a92,_0x257e05)=>{const _0x3773cb=_0x35c961;try{const {id:_0x1decc4}=_0x1870ba['params'],_0x102b42=await this['adminService'][_0x3773cb(0x17e)](_0x1decc4);if(!_0x102b42)return _0x441a92[_0x3773cb(0x1a8)](0x194)[_0x3773cb(0x1fa)]({'success':![],'message':'User\x20not\x20found'});_0x441a92[_0x3773cb(0x1fa)]({'success':!![],'result':_0x102b42});}catch(_0x26b57b){_0x257e05(_0x26b57b);}},this['createUser']=async(_0x938eb5,_0x4e11f0,_0xaa160d)=>{const _0x5dd6e1=_0x35c961;try{const _0x39c59e=_0x938eb5[_0x5dd6e1(0x1e7)],_0x5e30f8=await this[_0x5dd6e1(0x159)][_0x5dd6e1(0x1b5)](_0x39c59e);_0x4e11f0[_0x5dd6e1(0x1a8)](0xc9)[_0x5dd6e1(0x1fa)]({'success':!![],'message':_0x5dd6e1(0x16b),'result':_0x5e30f8});}catch(_0x53453a){_0xaa160d(_0x53453a);}},this['deleteUser']=async(_0x2b0bb7,_0x14450c,_0xba0b0e)=>{const _0x12e44c=_0x35c961;try{const {id:_0x4f9fc3}=_0x2b0bb7[_0x12e44c(0x171)],{twoFactorToken:_0x1bb71c}=_0x2b0bb7[_0x12e44c(0x1e7)];await this[_0x12e44c(0x159)]['deleteUser'](_0x4f9fc3,_0x1bb71c),_0x14450c['json']({'success':!![],'message':'User\x20deleted\x20successfully'});}catch(_0x188bda){_0xba0b0e(_0x188bda);}},this[_0x35c961(0x160)]=async(_0x47e445,_0x3fe4cf,_0x33aea1)=>{const _0x185e73=_0x35c961;try{const {shopId:_0x5b6c6d}=_0x47e445[_0x185e73(0x171)],_0x28fd34=await this[_0x185e73(0x159)]['getShopWallets'](_0x5b6c6d);_0x3fe4cf['json']({'success':!![],'wallets':_0x28fd34});}catch(_0x16eba9){_0x33aea1(_0x16eba9);}},this[_0x35c961(0x180)]=async(_0x3c89fc,_0x2966bc,_0x66bc51)=>{const _0x13df5f=_0x35c961;try{const {shopId:_0x344522}=_0x3c89fc['params'],_0x22912d=await this[_0x13df5f(0x159)][_0x13df5f(0x180)](_0x344522);_0x2966bc[_0x13df5f(0x1fa)]({'success':!![],'result':_0x22912d});}catch(_0x29ca88){_0x66bc51(_0x29ca88);}},this[_0x35c961(0x158)]=async(_0x31875a,_0x4fbae5,_0x5df172)=>{const _0x1c2d3a=_0x35c961;try{const {shopId:_0xb7674c}=_0x31875a['params'],{token:_0x26e1bd}=_0x31875a[_0x1c2d3a(0x1e7)];if(!_0x26e1bd)return _0x4fbae5['status'](0x190)[_0x1c2d3a(0x1fa)]({'success':![],'message':'Token\x20is\x20required'});const _0x2aa380=await this[_0x1c2d3a(0x159)][_0x1c2d3a(0x158)](_0xb7674c,_0x26e1bd);_0x4fbae5[_0x1c2d3a(0x1fa)]({'success':!![],'message':_0x1c2d3a(0x1f2),'result':_0x2aa380});}catch(_0x2b8869){_0x5df172(_0x2b8869);}},this[_0x35c961(0x1e6)]=async(_0x3b25c4,_0xc7533e,_0xb71a18)=>{const _0x3dd22b=_0x35c961;try{const {shopId:_0x41fe29}=_0x3b25c4[_0x3dd22b(0x171)];await this[_0x3dd22b(0x159)]['disable2FA'](_0x41fe29),_0xc7533e['json']({'success':!![],'message':_0x3dd22b(0x182)});}catch(_0x1a5926){_0xb71a18(_0x1a5926);}},this['getProcessingPaymentsStats']=async(_0x5dbf2a,_0x549fc4,_0x4a8112)=>{const _0x306c09=_0x35c961;try{const _0x30d9a2=await paymentCleanupService_1[_0x306c09(0x1c5)][_0x306c09(0x14e)]();_0x549fc4[_0x306c09(0x1fa)]({'success':!![],'result':_0x30d9a2});}catch(_0x137dbd){_0x4a8112(_0x137dbd);}},this[_0x35c961(0x18a)]=async(_0xa4b98,_0x5ae1e2,_0x4355f5)=>{const _0x35774d=_0x35c961;try{console[_0x35774d(0x18c)](_0x35774d(0x1b2)+_0xa4b98[_0x35774d(0x16a)]?.['username']+'\x20('+_0xa4b98[_0x35774d(0x16a)]?.['id']+')');const _0x45e68d=await paymentCleanupService_1[_0x35774d(0x1c5)]['cleanupStaleProcessingPayments']();_0x5ae1e2[_0x35774d(0x1fa)]({'success':!![],'message':_0x35774d(0x1cf),'result':{'processed':_0x45e68d[_0x35774d(0x198)],'failed':_0x45e68d['failed'],'errors':_0x45e68d[_0x35774d(0x1ee)]}});}catch(_0x1414d5){_0x4355f5(_0x1414d5);}},this[_0x35c961(0x1a2)]=async(_0x526441,_0x5a8c4f,_0xfacb38)=>{const _0x2742c1=_0x35c961;try{console['log'](_0x2742c1(0x19e)+_0x526441['user']?.[_0x2742c1(0x1e9)]+'\x20('+_0x526441[_0x2742c1(0x16a)]?.['id']+')');const _0x3f6b2d=await paymentCleanupService_1[_0x2742c1(0x1c5)]['cleanupStalePendingPayments']();_0x5a8c4f[_0x2742c1(0x1fa)]({'success':!![],'message':'PENDING\x20payment\x20cleanup\x20completed\x20successfully','result':{'processed':_0x3f6b2d['processed'],'failed':_0x3f6b2d[_0x2742c1(0x183)],'errors':_0x3f6b2d['errors']}});}catch(_0x51a5de){_0xfacb38(_0x51a5de);}},this[_0x35c961(0x15b)]=async(_0x26d87f,_0x11b34c,_0x24c2b4)=>{const _0x4ed2e3=_0x35c961;try{console['log'](_0x4ed2e3(0x1e3)+_0x26d87f[_0x4ed2e3(0x16a)]?.[_0x4ed2e3(0x1e9)]+'\x20('+_0x26d87f[_0x4ed2e3(0x16a)]?.['id']+')');const _0x2076bc=await paymentCleanupService_1[_0x4ed2e3(0x1c5)][_0x4ed2e3(0x14e)](),_0x824f9a=await paymentCleanupService_1[_0x4ed2e3(0x1c5)]['cleanupStaleProcessingPayments'](),_0x4ad0cc=await paymentCleanupService_1[_0x4ed2e3(0x1c5)][_0x4ed2e3(0x1a2)](),_0x3235d7=await paymentCleanupService_1[_0x4ed2e3(0x1c5)][_0x4ed2e3(0x14e)]();_0x11b34c[_0x4ed2e3(0x1fa)]({'success':!![],'message':'Payment\x20cleanup\x20(PROCESSING\x20+\x20PENDING)\x20with\x20report\x20completed\x20successfully','result':{'cleanup':{'processing':{'processed':_0x824f9a['processed'],'failed':_0x824f9a[_0x4ed2e3(0x183)],'errors':_0x824f9a[_0x4ed2e3(0x1ee)]},'pending':{'processed':_0x4ad0cc[_0x4ed2e3(0x198)],'failed':_0x4ad0cc['failed'],'errors':_0x4ad0cc[_0x4ed2e3(0x1ee)]},'total':{'processed':_0x824f9a[_0x4ed2e3(0x198)]+_0x4ad0cc[_0x4ed2e3(0x198)],'failed':_0x824f9a['failed']+_0x4ad0cc[_0x4ed2e3(0x183)],'errors':[..._0x824f9a[_0x4ed2e3(0x1ee)],..._0x4ad0cc[_0x4ed2e3(0x1ee)]]}},'statistics':{'before':_0x2076bc,'after':_0x3235d7,'reduced':_0x2076bc[_0x4ed2e3(0x1bf)]-_0x3235d7[_0x4ed2e3(0x1bf)]}}});}catch(_0x1a1e27){_0x24c2b4(_0x1a1e27);}},this['expirePaymentLinks']=async(_0x933d85,_0x2ddb86,_0x509a39)=>{const _0x1dfabc=_0x35c961;try{const _0xde7851=await paymentCleanupService_1[_0x1dfabc(0x1c5)][_0x1dfabc(0x163)]();_0x2ddb86[_0x1dfabc(0x1fa)]({'success':!![],'message':_0x1dfabc(0x16e),'result':{'expired':_0xde7851[_0x1dfabc(0x1f3)],'errors':_0xde7851[_0x1dfabc(0x1ee)]}});}catch(_0xadf75){_0x509a39(_0xadf75);}},this[_0x35c961(0x197)]=async(_0x19872c,_0x1b379d,_0xfb7622)=>{const _0x24a35b=_0x35c961;try{const {currentPassword:_0x1d4e4b,newPassword:_0x3557cd,confirmNewPassword:_0x361a53,twoFactorToken:_0x1f4418}=_0x19872c['body'];await this[_0x24a35b(0x159)][_0x24a35b(0x197)](_0x1d4e4b,_0x3557cd,_0x361a53,_0x1f4418),_0x1b379d[_0x24a35b(0x1fa)]({'success':!![],'message':_0x24a35b(0x17f)});}catch(_0x5660ad){_0xfb7622(_0x5660ad);}},this['get2FASettings']=async(_0x38be2b,_0xde0c26,_0x539b76)=>{const _0x17435c=_0x35c961;try{const _0x2a8681=await this['adminService'][_0x17435c(0x18f)]();_0xde0c26[_0x17435c(0x1fa)]({'success':!![],'result':_0x2a8681});}catch(_0x3bd7ea){_0x539b76(_0x3bd7ea);}},this[_0x35c961(0x146)]=async(_0x18e4b4,_0x3f7a36,_0x250920)=>{const _0x2fcb8f=_0x35c961;try{const _0x427ce0=await this[_0x2fcb8f(0x159)][_0x2fcb8f(0x146)]();_0x3f7a36[_0x2fcb8f(0x1fa)]({'success':!![],'result':_0x427ce0});}catch(_0x51127f){_0x250920(_0x51127f);}},this[_0x35c961(0x1c0)]=async(_0x234cab,_0x15b321,_0x2c780c)=>{const _0x1253bf=_0x35c961;try{const {token:_0x54e493}=_0x234cab[_0x1253bf(0x1e7)],_0x173c1e=await this['adminService']['enableAdmin2FA'](_0x54e493);_0x15b321['json']({'success':!![],'result':_0x173c1e});}catch(_0x104f3c){_0x2c780c(_0x104f3c);}},this['disableAdmin2FA']=async(_0x3dd378,_0x5bbe05,_0x27c218)=>{const _0x31d5cb=_0x35c961;try{await this[_0x31d5cb(0x159)][_0x31d5cb(0x1fe)](),_0x5bbe05[_0x31d5cb(0x1fa)]({'success':!![],'message':_0x31d5cb(0x1b0)});}catch(_0x3641b1){_0x27c218(_0x3641b1);}},this[_0x35c961(0x185)]=async(_0x42bcde,_0x5b7f4b,_0x348338)=>{const _0x470846=_0x35c961;try{const {shopId:_0x4fa081,amount:_0x3dc65a,notes:_0x502ee7}=_0x42bcde['body'];if(!_0x4fa081||!_0x3dc65a)return _0x5b7f4b[_0x470846(0x1a8)](0x190)[_0x470846(0x1fa)]({'success':![],'message':_0x470846(0x152)});if(_0x3dc65a<=0x0)return _0x5b7f4b[_0x470846(0x1a8)](0x190)[_0x470846(0x1fa)]({'success':![],'message':_0x470846(0x1cb)});await this[_0x470846(0x159)][_0x470846(0x185)](_0x4fa081,_0x3dc65a,_0x502ee7),_0x5b7f4b[_0x470846(0x1fa)]({'success':!![],'message':_0x470846(0x15c)});}catch(_0x275de8){_0x348338(_0x275de8);}},this['getLoginLogs']=async(_0x1d253a,_0x41e5a2,_0x2ca9cf)=>{const _0x32a7b7=_0x35c961;try{const {shopId:_0x4bde50}=_0x1d253a[_0x32a7b7(0x171)],{page:page='1',limit:limit='20'}=_0x1d253a['query'],_0x2f9e=(await Promise[_0x32a7b7(0x1e4)]()[_0x32a7b7(0x1e2)](()=>__importStar(require(_0x32a7b7(0x153)))))['default'],_0x3f6866=parseInt(page,0xa),_0x35493e=parseInt(limit,0xa),_0x567d3f=(_0x3f6866-0x1)*_0x35493e,[_0x372a21,_0x32cf71]=await Promise[_0x32a7b7(0x18d)]([_0x2f9e['loginLog'][_0x32a7b7(0x14f)]({'where':{'shopId':_0x4bde50},'orderBy':{'createdAt':_0x32a7b7(0x1de)},'skip':_0x567d3f,'take':_0x35493e}),_0x2f9e[_0x32a7b7(0x1f5)][_0x32a7b7(0x17c)]({'where':{'shopId':_0x4bde50}})]);_0x41e5a2['json']({'success':!![],'result':{'logs':_0x372a21,'pagination':{'page':_0x3f6866,'limit':_0x35493e,'total':_0x32cf71,'totalPages':Math[_0x32a7b7(0x14a)](_0x32cf71/_0x35493e)}}});}catch(_0x53f70d){_0x2ca9cf(_0x53f70d);}},this[_0x35c961(0x1c7)]=async(_0x864283,_0x323b3b,_0x4d0eb7)=>{const _0x444cf5=_0x35c961;try{const _0x248c2e=gatewaySettingsService_1[_0x444cf5(0x1a3)][_0x444cf5(0x16d)]();_0x323b3b[_0x444cf5(0x1fa)]({'success':!![],'result':_0x248c2e});}catch(_0x3dea8f){_0x4d0eb7(_0x3dea8f);}},this[_0x35c961(0x1c8)]=async(_0x5382f9,_0x583b9c,_0x47c4e8)=>{const _0x2dffaa=_0x35c961;try{const {gatewayId:_0x57f7e3}=_0x5382f9[_0x2dffaa(0x171)],{minAmount:_0x2a8fbf,maxAmount:_0x6de404,payoutDelay:_0x41ad8d,gatewayCommission:_0x3587a7}=_0x5382f9[_0x2dffaa(0x1e7)],_0x5d07a2=gatewaySettingsService_1[_0x2dffaa(0x1a3)][_0x2dffaa(0x181)](_0x57f7e3,{'minAmount':_0x2a8fbf!==undefined?Number(_0x2a8fbf):undefined,'maxAmount':_0x6de404!==undefined?Number(_0x6de404):undefined,'payoutDelay':_0x41ad8d!==undefined?Number(_0x41ad8d):undefined,'gatewayCommission':_0x3587a7!==undefined?Number(_0x3587a7):undefined});_0x583b9c[_0x2dffaa(0x1fa)]({'success':!![],'message':_0x2dffaa(0x1db),'result':_0x5d07a2});}catch(_0xec82f0){_0x47c4e8(_0xec82f0);}},this['getGatewayStatistics']=async(_0x5a9de5,_0x305c3d,_0x422969)=>{const _0x2a86e8=_0x35c961;try{const {gatewayId:_0x10f2a2}=_0x5a9de5[_0x2a86e8(0x171)];console['log'](_0x2a86e8(0x1f8)+_0x10f2a2);const {GATEWAY_ID_MAP:_0x2d81ef}=await Promise['resolve']()[_0x2a86e8(0x1e2)](()=>__importStar(require(_0x2a86e8(0x1a6)))),_0x4eb61f=_0x2d81ef[_0x10f2a2];console[_0x2a86e8(0x18c)]('üìä\x20[GATEWAY\x20STATS]\x20Gateway\x20ID\x20'+_0x10f2a2+_0x2a86e8(0x19b)+_0x4eb61f);if(!_0x4eb61f)return console[_0x2a86e8(0x18c)](_0x2a86e8(0x167)+_0x10f2a2),_0x305c3d[_0x2a86e8(0x1a8)](0x194)['json']({'success':![],'message':'Gateway\x20not\x20found'});console['log'](_0x2a86e8(0x1c2)+_0x4eb61f+'\x22\x20and\x20status=\x22PAID\x22');const _0x5eebd4=await database_1[_0x2a86e8(0x1b1)][_0x2a86e8(0x15f)][_0x2a86e8(0x14f)]({'where':{'gateway':_0x4eb61f},'select':{'id':!![],'status':!![],'amountUSDT':!![]},'take':0x5});console[_0x2a86e8(0x18c)]('üîç\x20[GATEWAY\x20STATS]\x20Sample\x20payments\x20for\x20'+_0x4eb61f+':',JSON[_0x2a86e8(0x1da)](_0x5eebd4,null,0x2));const _0x1a1848=await database_1[_0x2a86e8(0x1b1)][_0x2a86e8(0x15f)][_0x2a86e8(0x1bd)]({'where':{'gateway':_0x4eb61f,'status':'PAID'},'_sum':{'amountUSDT':!![],'amountAfterGatewayCommissionUSDT':!![]},'_count':{'_all':!![]}});console['log'](_0x2a86e8(0x174),JSON[_0x2a86e8(0x1da)](_0x1a1848,null,0x2));const _0x1d5410=await database_1[_0x2a86e8(0x1b1)]['payment'][_0x2a86e8(0x17c)]({'where':{'gateway':_0x4eb61f,'status':_0x2a86e8(0x156)}});console['log'](_0x2a86e8(0x18b)+_0x1d5410);const _0x10525e=await database_1[_0x2a86e8(0x1b1)][_0x2a86e8(0x15f)][_0x2a86e8(0x17c)]({'where':{'gateway':_0x4eb61f,'status':_0x2a86e8(0x161)}});console[_0x2a86e8(0x18c)](_0x2a86e8(0x1c1)+_0x10525e);const _0x36fa55=_0x1a1848[_0x2a86e8(0x157)][_0x2a86e8(0x1bc)]||0x0,_0x36b9f8=(_0x1a1848[_0x2a86e8(0x157)][_0x2a86e8(0x1bc)]||0x0)-(_0x1a1848[_0x2a86e8(0x157)][_0x2a86e8(0x191)]||0x0),_0x419217=_0x1a1848['_count'][_0x2a86e8(0x1f6)],_0x5cd1f3=_0x419217>0x0?_0x1d5410/_0x419217*0x64:0x0;console[_0x2a86e8(0x18c)](_0x2a86e8(0x1f7)),console['log'](_0x2a86e8(0x1f9)+_0x36fa55),console['log'](_0x2a86e8(0x1af)+_0x36b9f8),console[_0x2a86e8(0x18c)]('\x20\x20\x20-\x20Successful\x20Payments:\x20'+_0x419217),console[_0x2a86e8(0x18c)](_0x2a86e8(0x1ca)+_0x5cd1f3+'%'),_0x305c3d[_0x2a86e8(0x1fa)]({'success':!![],'result':{'gatewayId':_0x10f2a2,'totalTurnover':Number(_0x36fa55['toFixed'](0x2)),'totalCommission':Number(_0x36b9f8[_0x2a86e8(0x196)](0x2)),'successfulPayments':_0x419217,'chargebackCount':_0x1d5410,'chargebackRate':Number(_0x5cd1f3[_0x2a86e8(0x196)](0x2)),'refundCount':_0x10525e}});}catch(_0x3cdb92){console[_0x2a86e8(0x1fd)](_0x2a86e8(0x1cd),_0x3cdb92),_0x422969(_0x3cdb92);}},this[_0x35c961(0x159)]=new adminService_1['AdminService'](),this[_0x35c961(0x1b7)]=new paymentLinkService_1[(_0x35c961(0x162))]();}}exports[a4_0x91851f(0x16f)]=AdminController;