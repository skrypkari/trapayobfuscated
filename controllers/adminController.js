'use strict';function a4_0x4ff0(){const _0x376cfc=['../services/adminService','4761090ZSObvb','Admin\x20access\x20confirmed','processed','getAllPayouts','chargeback','../services/telegramBotService','8601468iZIblD','Payment\x20not\x20found','handleSuccessfulPayment','paymentLinkService','14iOzOjY','adminService','getPayoutStats','REFUND','ðŸ“Š\x20[GATEWAY\x20STATS]\x20Gateway\x20ID\x20','expirePaymentLinks','failed','payment','then','length','1623612tLGQUQ','getGatewaySettings','payments','default','errors','getGatewayStatistics','createUser','Payment\x20cleanup\x20(PROCESSING\x20+\x20PENDING)\x20with\x20report\x20completed\x20successfully','create','Failed\x20to\x20send\x20Telegram\x20notification\x20for\x20status\x20change:','count','paymentCleanupService','changeAdminPassword','getAllGatewaysWithSettings','updateSettings','getPayoutReports','ðŸ“Š\x20Manual\x20payment\x20cleanup\x20(PROCESSING\x20+\x20PENDING)\x20with\x20report\x20initiated\x20by\x20admin:\x20','updateCustomerData','getAllPayments','expireSinglePaymentLinks','depositBalance','Failed\x20to\x20update\x20payment\x20link\x20counter:','ðŸ”„\x20Admin\x20updating\x20customer\x20data\x20for\x20payment\x20','\x20\x20\x20-\x20Total\x20Commission:\x20','\x20\x20\x20-\x20Total\x20Turnover:\x20','ðŸ”\x20[GATEWAY\x20STATS]\x20Querying\x20payments\x20with\x20gateway=\x22','enable2FA','_sum','toUpperCase','2917710lyLSzK','statistics','__esModule','pagination','getUserById','PROCESSING\x20payment\x20cleanup\x20completed\x20successfully','__importDefault','gatewaySettingsService','â°\x20Manual\x20PENDING\x20payment\x20cleanup\x20initiated\x20by\x20admin:\x20','Gateway\x20settings\x20updated\x20successfully','ðŸ”\x20[GATEWAY\x20STATS]\x20Sample\x20payments\x20for\x20','cleanupStaleProcessingPayments','Admin\x20password\x20changed\x20successfully','prototype','30d','\x20to\x20PAID,\x20updating\x20payment\x20link\x20counter','âŒ\x20[GATEWAY\x20STATS]\x20Gateway\x20not\x20found\x20for\x20ID:\x20','getProcessingPaymentsStats','aggregate','username','7221294LEXEAq','role','deletePayout','cleanupStalePendingPayments','setupAdmin2FA','__setModuleDefault','âŒ\x20[GATEWAY\x20STATS]\x20Error:','toFixed','resolve','createdAt','\x20->\x20Gateway\x20Name:\x20','shopId','telegramBotService','__createBinding','desc','ðŸ’°\x20[GATEWAY\x20STATS]\x20Paid\x20payments\x20result:','params','hasOwnProperty','updatePayout','get2FASettings','all','ðŸ“Š\x20Admin\x20requesting\x20payout\x20reports:','ðŸ§¹\x20Manual\x20PROCESSING\x20payment\x20cleanup\x20initiated\x20by\x20admin:\x20','Payout\x20created\x20successfully','ðŸ“ˆ\x20[GATEWAY\x20STATS]\x20Calculated\x20statistics:','../config/database','Admin\x202FA\x20disabled\x20successfully','user','writable','suspendUser','disableAdmin2FA','createPayout','PAID','stringify','refund','User\x20deleted\x20successfully','Payout\x20deleted\x20successfully','getLoginLogs','json','merchants','\x20with\x20data:','deleteUser','periodFrom,\x20periodTo,\x20and\x20gateway\x20are\x20required','getShopWallets','âœ…\x20Telegram\x20notification\x20sent\x20for\x20status\x20change:\x20','checkAuth','total','565342jjujua','\x20\x20\x20-\x20Chargeback\x20Rate:\x20','User\x20not\x20found','ðŸŽ¯\x20[CONTROLLER]\x20Updating\x20payout\x20','\x20->\x20','8DFPCic','4ZSMqLh','PaymentLinkService','2FA\x20disabled\x20successfully','error','status','updatePayment','User\x20created\x20successfully','query','amountUSDT','defineProperty','enableAdmin2FA','Balance\x20deposited\x20successfully','call','cleanupStalePayments','gateway','../types/gateway','276hKpgdB','get','getPaymentById','getUsers','disable2FA','User\x20activated\x20successfully','getPayoutById','hasPayoutHistory','getSystemStatistics','expired','sendPaymentNotification','loginLog','11EJeOwR','AdminController','updateUser','ðŸ“Š\x20[GATEWAY\x20STATS]\x20Requesting\x20statistics\x20for\x20gateway\x20ID:\x20','ceil','shopId\x20and\x20amount\x20are\x20required','setup2FA','Customer\x20data\x20updated\x20successfully','log','ðŸ”™\x20[GATEWAY\x20STATS]\x20Chargeback\x20count:\x20','findMany','2FA\x20enabled\x20successfully','month','body','getAllUsers','\x20\x20\x20-\x20Successful\x20Payments:\x20','9678SjZjdR','CHARGEBACK','processing','summary','activateUser','paid','true','ðŸ“±\x20Payment\x20','ðŸ“Š\x20Admin\x20requesting\x20merchant\x20statistics\x20with\x20filters:','getStatistics','getMerchantsAwaitingPayout','../services/paymentCleanupService','updatePaymentStatus','getMerchantsSelection'];a4_0x4ff0=function(){return _0x376cfc;};return a4_0x4ff0();}const a4_0x41eee3=a4_0xcb25;(function(_0x10805c,_0x242b96){const _0x46dd69=a4_0xcb25,_0x23585b=_0x10805c();while(!![]){try{const _0x3cf4d9=-parseInt(_0x46dd69(0x1e0))/0x1*(parseInt(_0x46dd69(0x1da))/0x2)+-parseInt(_0x46dd69(0x20c))/0x3*(-parseInt(_0x46dd69(0x1f0))/0x4)+parseInt(_0x46dd69(0x21b))/0x5+parseInt(_0x46dd69(0x22f))/0x6*(parseInt(_0x46dd69(0x225))/0x7)+parseInt(_0x46dd69(0x1df))/0x8*(-parseInt(_0x46dd69(0x1ab))/0x9)+parseInt(_0x46dd69(0x24c))/0xa+parseInt(_0x46dd69(0x1fc))/0xb*(parseInt(_0x46dd69(0x221))/0xc);if(_0x3cf4d9===_0x242b96)break;else _0x23585b['push'](_0x23585b['shift']());}catch(_0x4a3e69){_0x23585b['push'](_0x23585b['shift']());}}}(a4_0x4ff0,0xc13e6));function a4_0xcb25(_0x51f85c,_0x3dfd53){_0x51f85c=_0x51f85c-0x19b;const _0x4ff008=a4_0x4ff0();let _0xcb2524=_0x4ff008[_0x51f85c];return _0xcb2524;}var __createBinding=this&&this[a4_0x41eee3(0x1b8)]||(Object[a4_0x41eee3(0x237)]?function(_0x2cff62,_0x16d190,_0x21af21,_0x2e1616){const _0xfd9f8b=a4_0x41eee3;if(_0x2e1616===undefined)_0x2e1616=_0x21af21;var _0x19631c=Object['getOwnPropertyDescriptor'](_0x16d190,_0x21af21);(!_0x19631c||(_0xfd9f8b(0x1f1)in _0x19631c?!_0x16d190[_0xfd9f8b(0x24e)]:_0x19631c[_0xfd9f8b(0x1c7)]||_0x19631c['configurable']))&&(_0x19631c={'enumerable':!![],'get':function(){return _0x16d190[_0x21af21];}}),Object[_0xfd9f8b(0x1e9)](_0x2cff62,_0x2e1616,_0x19631c);}:function(_0x1e2aee,_0x5ed04b,_0x3e0e46,_0x330e0b){if(_0x330e0b===undefined)_0x330e0b=_0x3e0e46;_0x1e2aee[_0x330e0b]=_0x5ed04b[_0x3e0e46];}),__setModuleDefault=this&&this[a4_0x41eee3(0x1b0)]||(Object[a4_0x41eee3(0x237)]?function(_0x367574,_0x4f7112){const _0x225584=a4_0x41eee3;Object['defineProperty'](_0x367574,_0x225584(0x232),{'enumerable':!![],'value':_0x4f7112});}:function(_0x24c312,_0x22c643){const _0x35e3a3=a4_0x41eee3;_0x24c312[_0x35e3a3(0x232)]=_0x22c643;}),__importStar=this&&this['__importStar']||(function(){var _0x2c5da2=function(_0x2c7ffa){return _0x2c5da2=Object['getOwnPropertyNames']||function(_0x35c67a){const _0x59cf34=a4_0xcb25;var _0x2d194d=[];for(var _0x51d9c9 in _0x35c67a)if(Object[_0x59cf34(0x1a4)][_0x59cf34(0x1bc)][_0x59cf34(0x1ec)](_0x35c67a,_0x51d9c9))_0x2d194d[_0x2d194d[_0x59cf34(0x22e)]]=_0x51d9c9;return _0x2d194d;},_0x2c5da2(_0x2c7ffa);};return function(_0x44280b){const _0x45c950=a4_0xcb25;if(_0x44280b&&_0x44280b[_0x45c950(0x24e)])return _0x44280b;var _0x5958e7={};if(_0x44280b!=null){for(var _0x2b6fda=_0x2c5da2(_0x44280b),_0x12ae59=0x0;_0x12ae59<_0x2b6fda[_0x45c950(0x22e)];_0x12ae59++)if(_0x2b6fda[_0x12ae59]!==_0x45c950(0x232))__createBinding(_0x5958e7,_0x44280b,_0x2b6fda[_0x12ae59]);}return __setModuleDefault(_0x5958e7,_0x44280b),_0x5958e7;};}()),__importDefault=this&&this[a4_0x41eee3(0x19d)]||function(_0x4ca904){const _0x87aca3=a4_0x41eee3;return _0x4ca904&&_0x4ca904[_0x87aca3(0x24e)]?_0x4ca904:{'default':_0x4ca904};};Object[a4_0x41eee3(0x1e9)](exports,a4_0x41eee3(0x24e),{'value':!![]}),exports['AdminController']=void 0x0;const adminService_1=require(a4_0x41eee3(0x21a)),paymentLinkService_1=require('../services/paymentLinkService'),paymentCleanupService_1=require(a4_0x41eee3(0x217)),telegramBotService_1=require(a4_0x41eee3(0x220)),gatewaySettingsService_1=require('../services/gatewaySettingsService'),database_1=__importDefault(require(a4_0x41eee3(0x1c4)));class AdminController{constructor(){const _0x48360e=a4_0x41eee3;this[_0x48360e(0x1d8)]=async(_0x4bb774,_0x5473fd,_0x185c09)=>{const _0x133f52=_0x48360e;try{const _0x4e9151=_0x4bb774[_0x133f52(0x1c6)];_0x5473fd[_0x133f52(0x1d1)]({'success':!![],'message':_0x133f52(0x21c),'user':{'id':_0x4e9151?.['id'],'username':_0x4e9151?.[_0x133f52(0x1aa)],'role':_0x4e9151?.[_0x133f52(0x1ac)]}});}catch(_0x46320a){_0x185c09(_0x46320a);}},this[_0x48360e(0x215)]=async(_0x6dae5c,_0x6d994c,_0x5bae3c)=>{const _0x129084=_0x48360e;try{const {period:period=_0x129084(0x1a5),currentDate:_0x329d6d}=_0x6dae5c[_0x129084(0x1e7)],_0xc28e66=await this[_0x129084(0x226)][_0x129084(0x1f8)](period,_0x329d6d);_0x6d994c[_0x129084(0x1d1)]({'success':!![],'result':_0xc28e66});}catch(_0x372898){_0x5bae3c(_0x372898);}},this['getMerchantStatistics']=async(_0x48a08c,_0x4406a8,_0x4d60ac)=>{const _0x5a2946=_0x48360e;try{const {shopId:_0x1c4f8f,period:period=_0x5a2946(0x208),dateFrom:_0x51a27d,dateTo:_0x5adbf1}=_0x48a08c[_0x5a2946(0x1e7)],_0x26f6cf={'shopId':_0x1c4f8f,'period':period,'dateFrom':_0x51a27d,'dateTo':_0x5adbf1};console[_0x5a2946(0x204)](_0x5a2946(0x214),_0x26f6cf);const _0x20347d=await this[_0x5a2946(0x226)]['getMerchantStatistics'](_0x26f6cf);_0x4406a8[_0x5a2946(0x1d1)]({'success':!![],'result':_0x20347d});}catch(_0x4c35ad){_0x4d60ac(_0x4c35ad);}},this[_0x48360e(0x23e)]=async(_0x12356d,_0x296c70,_0x236179)=>{const _0x143338=_0x48360e;try{const {periodFrom:_0x198bd0,periodTo:_0x5ba96a,gateway:_0x3ae5d9}=_0x12356d[_0x143338(0x1e7)];if(!_0x198bd0||!_0x5ba96a||!_0x3ae5d9)return _0x296c70[_0x143338(0x1e4)](0x190)[_0x143338(0x1d1)]({'success':![],'message':_0x143338(0x1d5)});console[_0x143338(0x204)](_0x143338(0x1c0),{'periodFrom':_0x198bd0,'periodTo':_0x5ba96a,'gateway':_0x3ae5d9});const _0x4f25dd=await this[_0x143338(0x226)][_0x143338(0x23e)]({'periodFrom':_0x198bd0,'periodTo':_0x5ba96a,'gateway':_0x3ae5d9});_0x296c70[_0x143338(0x1d1)]({'success':!![],'reports':_0x4f25dd});}catch(_0x2b0794){_0x236179(_0x2b0794);}},this[_0x48360e(0x227)]=async(_0x4ca35d,_0x1e19c3,_0x5d6383)=>{try{const _0x3b7fc6=await this['adminService']['getPayoutStats']();_0x1e19c3['json']({'success':!![],'result':_0x3b7fc6});}catch(_0xc5472c){_0x5d6383(_0xc5472c);}},this['getMerchantsAwaitingPayout']=async(_0x20ad83,_0xac4ab7,_0x5c6a44)=>{const _0xb16b61=_0x48360e;try{const {page:page=0x1,limit:limit=0x14,minAmount:_0x1c865b,search:_0x46cd55}=_0x20ad83[_0xb16b61(0x1e7)],_0x50334d={'page':Number(page),'limit':Number(limit),'minAmount':_0x1c865b?Number(_0x1c865b):undefined,'search':_0x46cd55},_0xe1685d=await this['adminService'][_0xb16b61(0x216)](_0x50334d);_0xac4ab7[_0xb16b61(0x1d1)]({'success':!![],'merchants':_0xe1685d[_0xb16b61(0x1d2)],'pagination':_0xe1685d[_0xb16b61(0x24f)],'summary':_0xe1685d[_0xb16b61(0x20f)]});}catch(_0x42c294){_0x5c6a44(_0x42c294);}},this[_0x48360e(0x219)]=async(_0x54737a,_0x593f05,_0x4cb39d)=>{const _0x3e882a=_0x48360e;try{const _0x35f942=_0x54737a[_0x3e882a(0x1e7)][_0x3e882a(0x1f7)]===_0x3e882a(0x212),_0x38845c=await this[_0x3e882a(0x226)]['getMerchantsSelection'](_0x35f942);_0x593f05[_0x3e882a(0x1d1)]({'success':!![],'result':_0x38845c});}catch(_0x3a8ff0){_0x4cb39d(_0x3a8ff0);}},this[_0x48360e(0x1ca)]=async(_0x568292,_0x3fd228,_0xb1c71)=>{const _0x153fc8=_0x48360e;try{const _0x149ae9=_0x568292[_0x153fc8(0x209)];console[_0x153fc8(0x204)]('ðŸŽ¯\x20[CONTROLLER]\x20Creating\x20payout\x20with\x20data:',_0x149ae9);const _0x45e38d=await this[_0x153fc8(0x226)][_0x153fc8(0x1ca)](_0x149ae9);_0x3fd228[_0x153fc8(0x1e4)](0xc9)[_0x153fc8(0x1d1)]({'success':!![],'message':_0x153fc8(0x1c2),'result':_0x45e38d});}catch(_0xedfcb5){_0xb1c71(_0xedfcb5);}},this[_0x48360e(0x1bd)]=async(_0x1e3f9f,_0x38df21,_0x5b3bc1)=>{const _0xa60f03=_0x48360e;try{const {id:_0x33db67}=_0x1e3f9f['params'],_0x57d2f2=_0x1e3f9f['body'];console[_0xa60f03(0x204)](_0xa60f03(0x1dd)+_0x33db67+_0xa60f03(0x1d3),_0x57d2f2);const _0x2dd5e9=await this[_0xa60f03(0x226)][_0xa60f03(0x1bd)](_0x33db67,_0x57d2f2);_0x38df21[_0xa60f03(0x1d1)]({'success':!![],'message':'Payout\x20updated\x20successfully','result':_0x2dd5e9});}catch(_0x2e51bf){_0x5b3bc1(_0x2e51bf);}},this['getPayouts']=async(_0x315df2,_0x18a0e3,_0x580610)=>{const _0x2a4464=_0x48360e;try{const {page:page=0x1,limit:limit=0x14,shopId:_0x101522,network:_0x5754a0,dateFrom:_0x44d52b,dateTo:_0x21284b,search:_0x30db8c}=_0x315df2['query'],_0x305c28={'page':Number(page),'limit':Number(limit),'shopId':_0x101522,'network':_0x5754a0,'dateFrom':_0x44d52b,'dateTo':_0x21284b,'search':_0x30db8c},_0x407f6e=await this[_0x2a4464(0x226)][_0x2a4464(0x21e)](_0x305c28);_0x18a0e3[_0x2a4464(0x1d1)]({'success':!![],'payouts':_0x407f6e['payouts'],'pagination':_0x407f6e[_0x2a4464(0x24f)]});}catch(_0x4441b3){_0x580610(_0x4441b3);}},this[_0x48360e(0x1f6)]=async(_0x3b2a40,_0x20055a,_0x4af465)=>{const _0x345011=_0x48360e;try{const {id:_0x13b925}=_0x3b2a40[_0x345011(0x1bb)],_0x29655c=await this[_0x345011(0x226)][_0x345011(0x1f6)](_0x13b925);if(!_0x29655c)return _0x20055a[_0x345011(0x1e4)](0x194)[_0x345011(0x1d1)]({'success':![],'message':'Payout\x20not\x20found'});_0x20055a[_0x345011(0x1d1)]({'success':!![],'result':_0x29655c});}catch(_0x77a821){_0x4af465(_0x77a821);}},this['deletePayout']=async(_0x25b670,_0x22f93b,_0x3240bd)=>{const _0x5d8604=_0x48360e;try{const {id:_0x3129ae}=_0x25b670[_0x5d8604(0x1bb)];await this[_0x5d8604(0x226)][_0x5d8604(0x1ad)](_0x3129ae),_0x22f93b['json']({'success':!![],'message':_0x5d8604(0x1cf)});}catch(_0x348ecb){_0x3240bd(_0x348ecb);}},this['getPayments']=async(_0x42fe92,_0x587590,_0x50cf26)=>{const _0x4d7b6a=_0x48360e;try{const {page:page=0x1,limit:limit=0x14,status:_0xaf810,gateway:_0x7ce5f3,shopId:_0x47c56c,dateFrom:_0x14ba1c,dateTo:_0x160273,search:_0x578199,currency:_0xe42305,sortBy:_0x421a69,sortOrder:_0x5cebaa}=_0x42fe92[_0x4d7b6a(0x1e7)],_0x2cf68a={'page':Number(page),'limit':Number(limit),'status':_0xaf810,'gateway':_0x7ce5f3,'shopId':_0x47c56c,'dateFrom':_0x14ba1c,'dateTo':_0x160273,'search':_0x578199,'currency':_0xe42305,'sortBy':_0x421a69,'sortOrder':_0x5cebaa},_0xae2a3a=await this[_0x4d7b6a(0x226)][_0x4d7b6a(0x241)](_0x2cf68a);_0x587590[_0x4d7b6a(0x1d1)]({'success':!![],'payments':_0xae2a3a[_0x4d7b6a(0x231)],'pagination':_0xae2a3a[_0x4d7b6a(0x24f)],'statistics':_0xae2a3a[_0x4d7b6a(0x24d)]});}catch(_0x486d61){_0x50cf26(_0x486d61);}},this['getPaymentById']=async(_0x5818be,_0x54a9d3,_0x3ec325)=>{const _0x1e7487=_0x48360e;try{const {id:_0x13ce2f}=_0x5818be[_0x1e7487(0x1bb)],_0x1952e8=await this[_0x1e7487(0x226)][_0x1e7487(0x1f2)](_0x13ce2f);if(!_0x1952e8)return _0x54a9d3[_0x1e7487(0x1e4)](0x194)[_0x1e7487(0x1d1)]({'success':![],'message':_0x1e7487(0x222)});_0x54a9d3['json']({'success':!![],'result':_0x1952e8});}catch(_0x333300){_0x3ec325(_0x333300);}},this[_0x48360e(0x1e5)]=async(_0x2aeb6c,_0x30e403,_0x5aa032)=>{const _0x507630=_0x48360e;try{const {id:_0x3070ea}=_0x2aeb6c[_0x507630(0x1bb)],{status:_0x2974b2,notes:_0x30b011,chargebackAmount:_0x3b1d16}=_0x2aeb6c[_0x507630(0x209)],_0x47c277=await this[_0x507630(0x226)][_0x507630(0x1f2)](_0x3070ea);if(!_0x47c277)return _0x30e403[_0x507630(0x1e4)](0x194)[_0x507630(0x1d1)]({'success':![],'message':'Payment\x20not\x20found'});const _0x11fd4a=await this[_0x507630(0x226)][_0x507630(0x218)](_0x3070ea,_0x2974b2,_0x30b011,_0x3b1d16);if(_0x47c277[_0x507630(0x1e4)]!==_0x2974b2&&_0x2974b2[_0x507630(0x24b)]()===_0x507630(0x1cb)){console[_0x507630(0x204)]('ðŸ“ˆ\x20Admin\x20changed\x20payment\x20'+_0x3070ea+_0x507630(0x1a6));try{await this[_0x507630(0x224)][_0x507630(0x223)](_0x3070ea),console['log']('âœ…\x20Payment\x20link\x20counter\x20updated\x20for\x20payment\x20'+_0x3070ea);}catch(_0x1da124){console[_0x507630(0x1e3)](_0x507630(0x244),_0x1da124);}}if(_0x47c277[_0x507630(0x1e4)]!==_0x2974b2){console[_0x507630(0x204)](_0x507630(0x213)+_0x3070ea+'\x20status\x20changed\x20from\x20'+_0x47c277[_0x507630(0x1e4)]+'\x20to\x20'+_0x2974b2+',\x20sending\x20Telegram\x20notification');try{let _0x1ec2cb;switch(_0x2974b2[_0x507630(0x24b)]()){case _0x507630(0x1cb):_0x1ec2cb=_0x507630(0x211);break;case'PROCESSING':_0x1ec2cb=_0x507630(0x20e);break;case'FAILED':_0x1ec2cb=_0x507630(0x22b);break;case'EXPIRED':_0x1ec2cb=_0x507630(0x1f9);break;case _0x507630(0x228):_0x1ec2cb=_0x507630(0x1cd);break;case _0x507630(0x20d):_0x1ec2cb=_0x507630(0x21f);break;default:console['log']('ðŸ“±\x20Skipping\x20Telegram\x20notification\x20for\x20status\x20change\x20to:\x20'+_0x2974b2);break;}if(_0x1ec2cb){const _0x14a1df={..._0x11fd4a,'shopId':_0x47c277[_0x507630(0x1b6)],'gateway':_0x47c277[_0x507630(0x1ee)],'createdAt':_0x47c277[_0x507630(0x1b4)],'chargebackAmount':_0x3b1d16};await telegramBotService_1[_0x507630(0x1b7)][_0x507630(0x1fa)](_0x47c277['shopId'],_0x14a1df,_0x1ec2cb),console[_0x507630(0x204)](_0x507630(0x1d7)+_0x47c277[_0x507630(0x1e4)]+_0x507630(0x1de)+_0x2974b2);}}catch(_0xc117e){console[_0x507630(0x1e3)](_0x507630(0x238),_0xc117e);}}_0x30e403['json']({'success':!![],'message':'Payment\x20updated\x20successfully','result':_0x11fd4a});}catch(_0xe775c0){_0x5aa032(_0xe775c0);}},this[_0x48360e(0x240)]=async(_0x1d82b8,_0x79e86,_0x3f0d02)=>{const _0x4204dc=_0x48360e;try{const {id:_0x5d5fe7}=_0x1d82b8[_0x4204dc(0x1bb)],_0x396057=_0x1d82b8['body'];console[_0x4204dc(0x204)](_0x4204dc(0x245)+_0x5d5fe7+':',_0x396057);const _0x130653=await this[_0x4204dc(0x226)][_0x4204dc(0x240)](_0x5d5fe7,_0x396057);_0x79e86[_0x4204dc(0x1d1)]({'success':!![],'message':_0x4204dc(0x203),'result':_0x130653});}catch(_0x22249a){_0x3f0d02(_0x22249a);}},this[_0x48360e(0x1fe)]=async(_0x493d4b,_0x5d6ff0,_0x2d4777)=>{const _0x333d9b=_0x48360e;try{const {id:_0x244d18}=_0x493d4b[_0x333d9b(0x1bb)],_0x5450e8=_0x493d4b[_0x333d9b(0x209)],_0x365d55=await this['adminService']['updateUser'](_0x244d18,_0x5450e8);_0x5d6ff0[_0x333d9b(0x1d1)]({'success':!![],'message':'User\x20updated\x20successfully','result':_0x365d55});}catch(_0x33a819){_0x2d4777(_0x33a819);}},this['suspendUser']=async(_0x46793e,_0x2ca687,_0x2b7681)=>{const _0x408824=_0x48360e;try{const {id:_0x359cce}=_0x46793e[_0x408824(0x1bb)],_0x534b25=await this[_0x408824(0x226)][_0x408824(0x1c8)](_0x359cce);_0x2ca687[_0x408824(0x1d1)]({'success':!![],'message':'User\x20suspended\x20successfully','result':_0x534b25});}catch(_0x322a26){_0x2b7681(_0x322a26);}},this[_0x48360e(0x210)]=async(_0x772eca,_0x4e517d,_0x122388)=>{const _0x38d9dc=_0x48360e;try{const {id:_0x1e288a}=_0x772eca['params'],_0xd13cfd=await this['adminService'][_0x38d9dc(0x210)](_0x1e288a);_0x4e517d[_0x38d9dc(0x1d1)]({'success':!![],'message':_0x38d9dc(0x1f5),'result':_0xd13cfd});}catch(_0x64bf74){_0x122388(_0x64bf74);}},this[_0x48360e(0x1f3)]=async(_0x30ccff,_0x4ef67d,_0x59f4b6)=>{const _0x5689fb=_0x48360e;try{const {page:page=0x1,limit:limit=0x14,status:_0x67946d,search:_0x4effd3}=_0x30ccff[_0x5689fb(0x1e7)],_0x42e637={'page':Number(page),'limit':Number(limit),'status':_0x67946d,'search':_0x4effd3},_0x5b6953=await this[_0x5689fb(0x226)][_0x5689fb(0x20a)](_0x42e637);_0x4ef67d[_0x5689fb(0x1d1)]({'success':!![],'users':_0x5b6953['users'],'pagination':_0x5b6953['pagination']});}catch(_0x530696){_0x59f4b6(_0x530696);}},this[_0x48360e(0x19b)]=async(_0x95ddb3,_0x23c84c,_0x3263fd)=>{const _0x15f39d=_0x48360e;try{const {id:_0x548af8}=_0x95ddb3[_0x15f39d(0x1bb)],_0x3d7fcc=await this[_0x15f39d(0x226)]['getUserById'](_0x548af8);if(!_0x3d7fcc)return _0x23c84c[_0x15f39d(0x1e4)](0x194)['json']({'success':![],'message':_0x15f39d(0x1dc)});_0x23c84c[_0x15f39d(0x1d1)]({'success':!![],'result':_0x3d7fcc});}catch(_0x690b66){_0x3263fd(_0x690b66);}},this[_0x48360e(0x235)]=async(_0x53cad3,_0x5e0156,_0x55c907)=>{const _0x2ffcf7=_0x48360e;try{const _0x175690=_0x53cad3[_0x2ffcf7(0x209)],_0x504913=await this[_0x2ffcf7(0x226)][_0x2ffcf7(0x235)](_0x175690);_0x5e0156['status'](0xc9)[_0x2ffcf7(0x1d1)]({'success':!![],'message':_0x2ffcf7(0x1e6),'result':_0x504913});}catch(_0x2651ca){_0x55c907(_0x2651ca);}},this[_0x48360e(0x1d4)]=async(_0x31f56f,_0x51d057,_0x31c6cc)=>{const _0x3c2a87=_0x48360e;try{const {id:_0x436e04}=_0x31f56f[_0x3c2a87(0x1bb)],{twoFactorToken:_0x3a16e7}=_0x31f56f['body'];await this[_0x3c2a87(0x226)][_0x3c2a87(0x1d4)](_0x436e04,_0x3a16e7),_0x51d057[_0x3c2a87(0x1d1)]({'success':!![],'message':_0x3c2a87(0x1ce)});}catch(_0x108b5a){_0x31c6cc(_0x108b5a);}},this[_0x48360e(0x1d6)]=async(_0x3ad213,_0x5e1b44,_0x297efd)=>{const _0x46de99=_0x48360e;try{const {shopId:_0x1e1311}=_0x3ad213['params'],_0x11ddc6=await this[_0x46de99(0x226)]['getShopWallets'](_0x1e1311);_0x5e1b44[_0x46de99(0x1d1)]({'success':!![],'wallets':_0x11ddc6});}catch(_0x2c1ce7){_0x297efd(_0x2c1ce7);}},this[_0x48360e(0x202)]=async(_0x2fc27c,_0x3ae9fe,_0x22d7e4)=>{const _0x57552c=_0x48360e;try{const {shopId:_0x2f8135}=_0x2fc27c[_0x57552c(0x1bb)],_0x591cf9=await this['adminService'][_0x57552c(0x202)](_0x2f8135);_0x3ae9fe[_0x57552c(0x1d1)]({'success':!![],'result':_0x591cf9});}catch(_0x448b39){_0x22d7e4(_0x448b39);}},this[_0x48360e(0x249)]=async(_0x4163cf,_0x497aae,_0x2b6f0a)=>{const _0x4206eb=_0x48360e;try{const {shopId:_0x10fa5e}=_0x4163cf[_0x4206eb(0x1bb)],{token:_0x10b8d2}=_0x4163cf['body'];if(!_0x10b8d2)return _0x497aae[_0x4206eb(0x1e4)](0x190)[_0x4206eb(0x1d1)]({'success':![],'message':'Token\x20is\x20required'});const _0x5c92ca=await this['adminService'][_0x4206eb(0x249)](_0x10fa5e,_0x10b8d2);_0x497aae[_0x4206eb(0x1d1)]({'success':!![],'message':_0x4206eb(0x207),'result':_0x5c92ca});}catch(_0xb2defb){_0x2b6f0a(_0xb2defb);}},this['disable2FA']=async(_0x2f2838,_0x52574a,_0x58f52f)=>{const _0x47996a=_0x48360e;try{const {shopId:_0x407df3}=_0x2f2838[_0x47996a(0x1bb)];await this[_0x47996a(0x226)][_0x47996a(0x1f4)](_0x407df3),_0x52574a['json']({'success':!![],'message':_0x47996a(0x1e2)});}catch(_0x68d6fb){_0x58f52f(_0x68d6fb);}},this['getProcessingPaymentsStats']=async(_0x19da5b,_0x204300,_0x1a2b26)=>{const _0x67846e=_0x48360e;try{const _0x11c882=await paymentCleanupService_1['paymentCleanupService'][_0x67846e(0x1a8)]();_0x204300[_0x67846e(0x1d1)]({'success':!![],'result':_0x11c882});}catch(_0x2c9019){_0x1a2b26(_0x2c9019);}},this[_0x48360e(0x1ed)]=async(_0x3c8fa0,_0x4fdcac,_0x2cdf2b)=>{const _0x1ee1f4=_0x48360e;try{console[_0x1ee1f4(0x204)](_0x1ee1f4(0x1c1)+_0x3c8fa0[_0x1ee1f4(0x1c6)]?.[_0x1ee1f4(0x1aa)]+'\x20('+_0x3c8fa0[_0x1ee1f4(0x1c6)]?.['id']+')');const _0x457c92=await paymentCleanupService_1['paymentCleanupService'][_0x1ee1f4(0x1a2)]();_0x4fdcac[_0x1ee1f4(0x1d1)]({'success':!![],'message':_0x1ee1f4(0x19c),'result':{'processed':_0x457c92[_0x1ee1f4(0x21d)],'failed':_0x457c92[_0x1ee1f4(0x22b)],'errors':_0x457c92[_0x1ee1f4(0x233)]}});}catch(_0x3af876){_0x2cdf2b(_0x3af876);}},this[_0x48360e(0x1ae)]=async(_0xb54bac,_0x375c85,_0xfc5e39)=>{const _0x406705=_0x48360e;try{console['log'](_0x406705(0x19f)+_0xb54bac[_0x406705(0x1c6)]?.[_0x406705(0x1aa)]+'\x20('+_0xb54bac[_0x406705(0x1c6)]?.['id']+')');const _0x5aacb2=await paymentCleanupService_1[_0x406705(0x23a)]['cleanupStalePendingPayments']();_0x375c85[_0x406705(0x1d1)]({'success':!![],'message':'PENDING\x20payment\x20cleanup\x20completed\x20successfully','result':{'processed':_0x5aacb2[_0x406705(0x21d)],'failed':_0x5aacb2[_0x406705(0x22b)],'errors':_0x5aacb2[_0x406705(0x233)]}});}catch(_0x39bc49){_0xfc5e39(_0x39bc49);}},this['cleanupStalePaymentsWithReport']=async(_0x2c8979,_0x13d719,_0x5efaf8)=>{const _0x271308=_0x48360e;try{console[_0x271308(0x204)](_0x271308(0x23f)+_0x2c8979['user']?.[_0x271308(0x1aa)]+'\x20('+_0x2c8979[_0x271308(0x1c6)]?.['id']+')');const _0x9b7c3b=await paymentCleanupService_1[_0x271308(0x23a)][_0x271308(0x1a8)](),_0x3218e5=await paymentCleanupService_1[_0x271308(0x23a)]['cleanupStaleProcessingPayments'](),_0x214a4d=await paymentCleanupService_1[_0x271308(0x23a)]['cleanupStalePendingPayments'](),_0x3992df=await paymentCleanupService_1[_0x271308(0x23a)][_0x271308(0x1a8)]();_0x13d719[_0x271308(0x1d1)]({'success':!![],'message':_0x271308(0x236),'result':{'cleanup':{'processing':{'processed':_0x3218e5[_0x271308(0x21d)],'failed':_0x3218e5[_0x271308(0x22b)],'errors':_0x3218e5[_0x271308(0x233)]},'pending':{'processed':_0x214a4d['processed'],'failed':_0x214a4d[_0x271308(0x22b)],'errors':_0x214a4d[_0x271308(0x233)]},'total':{'processed':_0x3218e5[_0x271308(0x21d)]+_0x214a4d[_0x271308(0x21d)],'failed':_0x3218e5[_0x271308(0x22b)]+_0x214a4d[_0x271308(0x22b)],'errors':[..._0x3218e5[_0x271308(0x233)],..._0x214a4d[_0x271308(0x233)]]}},'statistics':{'before':_0x9b7c3b,'after':_0x3992df,'reduced':_0x9b7c3b[_0x271308(0x1d9)]-_0x3992df[_0x271308(0x1d9)]}}});}catch(_0x321e53){_0x5efaf8(_0x321e53);}},this[_0x48360e(0x22a)]=async(_0x28688f,_0x44a947,_0x14956c)=>{const _0x59b594=_0x48360e;try{const _0x23c72c=await paymentCleanupService_1[_0x59b594(0x23a)][_0x59b594(0x242)]();_0x44a947[_0x59b594(0x1d1)]({'success':!![],'message':'Payment\x20link\x20expiration\x20check\x20completed\x20successfully','result':{'expired':_0x23c72c[_0x59b594(0x1f9)],'errors':_0x23c72c[_0x59b594(0x233)]}});}catch(_0x198740){_0x14956c(_0x198740);}},this[_0x48360e(0x23b)]=async(_0x51b147,_0x4dbe6a,_0x85d4c4)=>{const _0x4ded00=_0x48360e;try{const {currentPassword:_0x51191d,newPassword:_0x173cd6,confirmNewPassword:_0x1f1715,twoFactorToken:_0x4006e0}=_0x51b147[_0x4ded00(0x209)];await this[_0x4ded00(0x226)][_0x4ded00(0x23b)](_0x51191d,_0x173cd6,_0x1f1715,_0x4006e0),_0x4dbe6a['json']({'success':!![],'message':_0x4ded00(0x1a3)});}catch(_0x15e67b){_0x85d4c4(_0x15e67b);}},this[_0x48360e(0x1be)]=async(_0x3d66db,_0x595e17,_0x2a4efe)=>{const _0x5c4428=_0x48360e;try{const _0x188b9b=await this['adminService'][_0x5c4428(0x1be)]();_0x595e17['json']({'success':!![],'result':_0x188b9b});}catch(_0x493f40){_0x2a4efe(_0x493f40);}},this[_0x48360e(0x1af)]=async(_0x1a8b7a,_0x52fe9a,_0x20a3b0)=>{const _0x14cc2d=_0x48360e;try{const _0x42ab81=await this[_0x14cc2d(0x226)][_0x14cc2d(0x1af)]();_0x52fe9a[_0x14cc2d(0x1d1)]({'success':!![],'result':_0x42ab81});}catch(_0x7ebeea){_0x20a3b0(_0x7ebeea);}},this[_0x48360e(0x1ea)]=async(_0x2a2dee,_0x2749c9,_0x248806)=>{const _0x41baea=_0x48360e;try{const {token:_0x281fef}=_0x2a2dee[_0x41baea(0x209)],_0x48a5aa=await this[_0x41baea(0x226)]['enableAdmin2FA'](_0x281fef);_0x2749c9[_0x41baea(0x1d1)]({'success':!![],'result':_0x48a5aa});}catch(_0x3d1cb7){_0x248806(_0x3d1cb7);}},this[_0x48360e(0x1c9)]=async(_0x58fd3b,_0x4b3e4d,_0x3b9a1d)=>{const _0x2582af=_0x48360e;try{await this[_0x2582af(0x226)]['disableAdmin2FA'](),_0x4b3e4d[_0x2582af(0x1d1)]({'success':!![],'message':_0x2582af(0x1c5)});}catch(_0x3f3c0d){_0x3b9a1d(_0x3f3c0d);}},this[_0x48360e(0x243)]=async(_0xbd77c2,_0x1ed55b,_0x26d9dc)=>{const _0x5d47f5=_0x48360e;try{const {shopId:_0x5d5673,amount:_0x1d0406,notes:_0x48ca25}=_0xbd77c2[_0x5d47f5(0x209)];if(!_0x5d5673||!_0x1d0406)return _0x1ed55b[_0x5d47f5(0x1e4)](0x190)['json']({'success':![],'message':_0x5d47f5(0x201)});if(_0x1d0406<=0x0)return _0x1ed55b[_0x5d47f5(0x1e4)](0x190)[_0x5d47f5(0x1d1)]({'success':![],'message':'Amount\x20must\x20be\x20greater\x20than\x200'});await this[_0x5d47f5(0x226)][_0x5d47f5(0x243)](_0x5d5673,_0x1d0406,_0x48ca25),_0x1ed55b['json']({'success':!![],'message':_0x5d47f5(0x1eb)});}catch(_0x3efa90){_0x26d9dc(_0x3efa90);}},this[_0x48360e(0x1d0)]=async(_0x4a4287,_0x57898d,_0x552254)=>{const _0x32b04a=_0x48360e;try{const {shopId:_0x48710d}=_0x4a4287[_0x32b04a(0x1bb)],{page:page='1',limit:limit='20'}=_0x4a4287[_0x32b04a(0x1e7)],_0x2b8775=(await Promise[_0x32b04a(0x1b3)]()[_0x32b04a(0x22d)](()=>__importStar(require('../config/database'))))['default'],_0x26bc36=parseInt(page,0xa),_0x40bd63=parseInt(limit,0xa),_0x5d890f=(_0x26bc36-0x1)*_0x40bd63,[_0x14e051,_0x3dab11]=await Promise[_0x32b04a(0x1bf)]([_0x2b8775[_0x32b04a(0x1fb)][_0x32b04a(0x206)]({'where':{'shopId':_0x48710d},'orderBy':{'createdAt':_0x32b04a(0x1b9)},'skip':_0x5d890f,'take':_0x40bd63}),_0x2b8775[_0x32b04a(0x1fb)][_0x32b04a(0x239)]({'where':{'shopId':_0x48710d}})]);_0x57898d[_0x32b04a(0x1d1)]({'success':!![],'result':{'logs':_0x14e051,'pagination':{'page':_0x26bc36,'limit':_0x40bd63,'total':_0x3dab11,'totalPages':Math[_0x32b04a(0x200)](_0x3dab11/_0x40bd63)}}});}catch(_0xf717a5){_0x552254(_0xf717a5);}},this[_0x48360e(0x230)]=async(_0x5efe2b,_0x31d8d5,_0x45eaff)=>{const _0x12717f=_0x48360e;try{const _0x399f57=gatewaySettingsService_1[_0x12717f(0x19e)][_0x12717f(0x23c)]();_0x31d8d5[_0x12717f(0x1d1)]({'success':!![],'result':_0x399f57});}catch(_0x308b31){_0x45eaff(_0x308b31);}},this['updateGatewaySettings']=async(_0xcfc51d,_0x1e33a7,_0xceb812)=>{const _0x17889f=_0x48360e;try{const {gatewayId:_0x1323e2}=_0xcfc51d[_0x17889f(0x1bb)],{minAmount:_0x5d3688,maxAmount:_0x3aaa21,payoutDelay:_0x46b9de,gatewayCommission:_0x104a4a}=_0xcfc51d[_0x17889f(0x209)],_0x434347=gatewaySettingsService_1[_0x17889f(0x19e)][_0x17889f(0x23d)](_0x1323e2,{'minAmount':_0x5d3688!==undefined?Number(_0x5d3688):undefined,'maxAmount':_0x3aaa21!==undefined?Number(_0x3aaa21):undefined,'payoutDelay':_0x46b9de!==undefined?Number(_0x46b9de):undefined,'gatewayCommission':_0x104a4a!==undefined?Number(_0x104a4a):undefined});_0x1e33a7[_0x17889f(0x1d1)]({'success':!![],'message':_0x17889f(0x1a0),'result':_0x434347});}catch(_0x170ce0){_0xceb812(_0x170ce0);}},this[_0x48360e(0x234)]=async(_0x25b895,_0x42ac1f,_0x166220)=>{const _0x1d5820=_0x48360e;try{const {gatewayId:_0x475e25}=_0x25b895[_0x1d5820(0x1bb)];console[_0x1d5820(0x204)](_0x1d5820(0x1ff)+_0x475e25);const {GATEWAY_ID_MAP:_0x511dd1}=await Promise[_0x1d5820(0x1b3)]()[_0x1d5820(0x22d)](()=>__importStar(require(_0x1d5820(0x1ef)))),_0x9ce8b7=_0x511dd1[_0x475e25];console[_0x1d5820(0x204)](_0x1d5820(0x229)+_0x475e25+_0x1d5820(0x1b5)+_0x9ce8b7);if(!_0x9ce8b7)return console[_0x1d5820(0x204)](_0x1d5820(0x1a7)+_0x475e25),_0x42ac1f[_0x1d5820(0x1e4)](0x194)[_0x1d5820(0x1d1)]({'success':![],'message':'Gateway\x20not\x20found'});console[_0x1d5820(0x204)](_0x1d5820(0x248)+_0x9ce8b7+'\x22\x20and\x20status=\x22PAID\x22');const _0x233783=await database_1[_0x1d5820(0x232)][_0x1d5820(0x22c)][_0x1d5820(0x206)]({'where':{'gateway':_0x9ce8b7},'select':{'id':!![],'status':!![],'amountUSDT':!![]},'take':0x5});console['log'](_0x1d5820(0x1a1)+_0x9ce8b7+':',JSON[_0x1d5820(0x1cc)](_0x233783,null,0x2));const _0x503d1d=await database_1[_0x1d5820(0x232)][_0x1d5820(0x22c)][_0x1d5820(0x1a9)]({'where':{'gateway':_0x9ce8b7,'status':'PAID'},'_sum':{'amountUSDT':!![],'amountAfterGatewayCommissionUSDT':!![]},'_count':{'_all':!![]}});console[_0x1d5820(0x204)](_0x1d5820(0x1ba),JSON['stringify'](_0x503d1d,null,0x2));const _0x3a7f79=await database_1[_0x1d5820(0x232)][_0x1d5820(0x22c)][_0x1d5820(0x239)]({'where':{'gateway':_0x9ce8b7,'status':_0x1d5820(0x20d)}});console[_0x1d5820(0x204)](_0x1d5820(0x205)+_0x3a7f79);const _0x49deb3=await database_1[_0x1d5820(0x232)]['payment'][_0x1d5820(0x239)]({'where':{'gateway':_0x9ce8b7,'status':_0x1d5820(0x228)}});console['log']('ðŸ’¸\x20[GATEWAY\x20STATS]\x20Refund\x20count:\x20'+_0x49deb3);const _0x2ef5cc=_0x503d1d['_sum']['amountUSDT']||0x0,_0x4c9154=(_0x503d1d[_0x1d5820(0x24a)][_0x1d5820(0x1e8)]||0x0)-(_0x503d1d['_sum']['amountAfterGatewayCommissionUSDT']||0x0),_0x2b9a6e=_0x503d1d['_count']['_all'],_0x4a8371=_0x2b9a6e>0x0?_0x3a7f79/_0x2b9a6e*0x64:0x0;console['log'](_0x1d5820(0x1c3)),console[_0x1d5820(0x204)](_0x1d5820(0x247)+_0x2ef5cc),console['log'](_0x1d5820(0x246)+_0x4c9154),console[_0x1d5820(0x204)](_0x1d5820(0x20b)+_0x2b9a6e),console[_0x1d5820(0x204)](_0x1d5820(0x1db)+_0x4a8371+'%'),_0x42ac1f[_0x1d5820(0x1d1)]({'success':!![],'result':{'gatewayId':_0x475e25,'totalTurnover':Number(_0x2ef5cc[_0x1d5820(0x1b2)](0x2)),'totalCommission':Number(_0x4c9154[_0x1d5820(0x1b2)](0x2)),'successfulPayments':_0x2b9a6e,'chargebackCount':_0x3a7f79,'chargebackRate':Number(_0x4a8371[_0x1d5820(0x1b2)](0x2)),'refundCount':_0x49deb3}});}catch(_0x16d9ab){console[_0x1d5820(0x1e3)](_0x1d5820(0x1b1),_0x16d9ab),_0x166220(_0x16d9ab);}},this[_0x48360e(0x226)]=new adminService_1['AdminService'](),this[_0x48360e(0x224)]=new paymentLinkService_1[(_0x48360e(0x1e1))]();}}exports[a4_0x41eee3(0x1fd)]=AdminController;