'use strict';const a3_0xc8541=a3_0x4d0c;(function(_0x26f3dc,_0x3ece3a){const _0x27900b=a3_0x4d0c,_0x3283c5=_0x26f3dc();while(!![]){try{const _0x5ab6f4=-parseInt(_0x27900b(0x115))/0x1*(parseInt(_0x27900b(0x13d))/0x2)+-parseInt(_0x27900b(0x113))/0x3+-parseInt(_0x27900b(0x10d))/0x4+parseInt(_0x27900b(0x116))/0x5+parseInt(_0x27900b(0x143))/0x6+-parseInt(_0x27900b(0x104))/0x7+parseInt(_0x27900b(0x14a))/0x8;if(_0x5ab6f4===_0x3ece3a)break;else _0x3283c5['push'](_0x3283c5['shift']());}catch(_0x329562){_0x3283c5['push'](_0x3283c5['shift']());}}}(a3_0x2873,0xbac23));function a3_0x4d0c(_0x18b28e,_0x28def1){const _0x2873ad=a3_0x2873();return a3_0x4d0c=function(_0x4d0ca2,_0x3147e6){_0x4d0ca2=_0x4d0ca2-0xfa;let _0x2f1268=_0x2873ad[_0x4d0ca2];return _0x2f1268;},a3_0x4d0c(_0x18b28e,_0x28def1);}Object[a3_0xc8541(0x12e)](exports,'__esModule',{'value':!![]}),exports[a3_0xc8541(0x103)]=void 0x0;const adminService_1=require(a3_0xc8541(0x137)),paymentLinkService_1=require(a3_0xc8541(0x106)),telegramBotService_1=require(a3_0xc8541(0x142));function a3_0x2873(){const _0x14b741=['paid','error','getPayoutById','createPayout','ðŸ“Š\x20Admin\x20requesting\x20merchant\x20statistics\x20with\x20filters:','getPaymentById','10691808pGyJke','body','updateUser','\x20status\x20changed\x20from\x20','User\x20created\x20successfully','sendPaymentNotification','Failed\x20to\x20send\x20Telegram\x20notification\x20for\x20status\x20change:','log','pagination','getMerchantsSelection','activateUser','AdminController','1659329dBmjSP','shopId','../services/paymentLinkService','PROCESSING','query','expired','FAILED','getMerchantsAwaitingPayout','getSystemStatistics','2118336vMHLbn','30d','toUpperCase','updateCustomerData','Failed\x20to\x20update\x20payment\x20link\x20counter:','getAllPayments','2920962yKBBMm','gateway','68IcpXYV','7395210CXmkpM','suspendUser','payouts','getMerchantStatistics','params','User\x20updated\x20successfully','getStatistics','âœ…\x20Payment\x20link\x20counter\x20updated\x20for\x20payment\x20','getPayouts','\x20->\x20','REFUND','Admin\x20access\x20confirmed','createUser','summary','\x20to\x20','paymentLinkService','processing','user','getPayoutStats','handleSuccessfulPayment','Payout\x20created\x20successfully','status','createdAt','Payout\x20not\x20found','defineProperty','PAID','ðŸ“±\x20Payment\x20',',\x20sending\x20Telegram\x20notification','Payment\x20updated\x20successfully','getAllUsers','getUserById','Payout\x20deleted\x20successfully','json','../services/adminService','deleteUser','Customer\x20data\x20updated\x20successfully','failed','Payment\x20not\x20found','getUsers','38488sKQgjT','chargeback','User\x20deleted\x20successfully','adminService','getPayments','../services/telegramBotService','5989932MzXXdW'];a3_0x2873=function(){return _0x14b741;};return a3_0x2873();}class AdminController{constructor(){const _0x120ce7=a3_0xc8541;this['checkAuth']=async(_0x15c7b6,_0x14675e,_0x244137)=>{const _0x41f014=a3_0x4d0c;try{const _0x551826=_0x15c7b6[_0x41f014(0x127)];_0x14675e['json']({'success':!![],'message':_0x41f014(0x121),'user':{'id':_0x551826?.['id'],'username':_0x551826?.['username'],'role':_0x551826?.['role']}});}catch(_0x2ffa7c){_0x244137(_0x2ffa7c);}},this[_0x120ce7(0x11c)]=async(_0x32a069,_0x53f03d,_0x3764f3)=>{const _0x50d421=_0x120ce7;try{const {period:period=_0x50d421(0x10e)}=_0x32a069[_0x50d421(0x108)],_0x2b93cc=await this[_0x50d421(0x140)][_0x50d421(0x10c)](period);_0x53f03d[_0x50d421(0x136)]({'success':!![],'result':_0x2b93cc});}catch(_0x438f5f){_0x3764f3(_0x438f5f);}},this[_0x120ce7(0x119)]=async(_0x13e9b5,_0x18c944,_0xa10239)=>{const _0x41639d=_0x120ce7;try{const {shopId:_0x29deb5,period:period='month',dateFrom:_0xc8925b,dateTo:_0x5d9d87}=_0x13e9b5[_0x41639d(0x108)],_0x146a9b={'shopId':_0x29deb5,'period':period,'dateFrom':_0xc8925b,'dateTo':_0x5d9d87};console['log'](_0x41639d(0x148),_0x146a9b);const _0x2511aa=await this[_0x41639d(0x140)][_0x41639d(0x119)](_0x146a9b);_0x18c944[_0x41639d(0x136)]({'success':!![],'result':_0x2511aa});}catch(_0x101f45){_0xa10239(_0x101f45);}},this[_0x120ce7(0x128)]=async(_0x5ae324,_0x3aeb23,_0x2fc7b3)=>{const _0x20ba1a=_0x120ce7;try{const _0x2f8ed4=await this[_0x20ba1a(0x140)][_0x20ba1a(0x128)]();_0x3aeb23[_0x20ba1a(0x136)]({'success':!![],'result':_0x2f8ed4});}catch(_0x15e5ad){_0x2fc7b3(_0x15e5ad);}},this[_0x120ce7(0x10b)]=async(_0xa66311,_0x44d423,_0x1d62f9)=>{const _0x302914=_0x120ce7;try{const {page:page=0x1,limit:limit=0x14,minAmount:_0x142be5,search:_0x27ef47}=_0xa66311[_0x302914(0x108)],_0x529af0={'page':Number(page),'limit':Number(limit),'minAmount':_0x142be5?Number(_0x142be5):undefined,'search':_0x27ef47},_0x5460fd=await this[_0x302914(0x140)][_0x302914(0x10b)](_0x529af0);_0x44d423['json']({'success':!![],'merchants':_0x5460fd['merchants'],'pagination':_0x5460fd[_0x302914(0x100)],'summary':_0x5460fd[_0x302914(0x123)]});}catch(_0x525fec){_0x1d62f9(_0x525fec);}},this[_0x120ce7(0x101)]=async(_0x3c5a17,_0x1a21fc,_0x3b8da5)=>{const _0x5b2c13=_0x120ce7;try{const _0x5b1bfd=await this[_0x5b2c13(0x140)][_0x5b2c13(0x101)]();_0x1a21fc[_0x5b2c13(0x136)]({'success':!![],'result':_0x5b1bfd});}catch(_0x53819c){_0x3b8da5(_0x53819c);}},this['createPayout']=async(_0x3c8039,_0x1819b8,_0x1402ac)=>{const _0x5a73cb=_0x120ce7;try{const _0x456373=_0x3c8039['body'],_0x2f7361=await this[_0x5a73cb(0x140)][_0x5a73cb(0x147)](_0x456373);_0x1819b8[_0x5a73cb(0x12b)](0xc9)[_0x5a73cb(0x136)]({'success':!![],'message':_0x5a73cb(0x12a),'result':_0x2f7361});}catch(_0xc7ac78){_0x1402ac(_0xc7ac78);}},this[_0x120ce7(0x11e)]=async(_0x16116e,_0x4336f6,_0x34a6ff)=>{const _0x2d125a=_0x120ce7;try{const {page:page=0x1,limit:limit=0x14,shopId:_0x25d75b,network:_0xabed34,dateFrom:_0x560db8,dateTo:_0x4934e0,search:_0x153ab7}=_0x16116e[_0x2d125a(0x108)],_0x2ae2a6={'page':Number(page),'limit':Number(limit),'shopId':_0x25d75b,'network':_0xabed34,'dateFrom':_0x560db8,'dateTo':_0x4934e0,'search':_0x153ab7},_0x44b8df=await this[_0x2d125a(0x140)]['getAllPayouts'](_0x2ae2a6);_0x4336f6[_0x2d125a(0x136)]({'success':!![],'payouts':_0x44b8df[_0x2d125a(0x118)],'pagination':_0x44b8df[_0x2d125a(0x100)]});}catch(_0x3a6ac7){_0x34a6ff(_0x3a6ac7);}},this[_0x120ce7(0x146)]=async(_0x75abd4,_0x4622a9,_0x1bc484)=>{const _0x57d2bd=_0x120ce7;try{const {id:_0x27f076}=_0x75abd4['params'],_0xfc4c3c=await this['adminService'][_0x57d2bd(0x146)](_0x27f076);if(!_0xfc4c3c)return _0x4622a9['status'](0x194)[_0x57d2bd(0x136)]({'success':![],'message':_0x57d2bd(0x12d)});_0x4622a9[_0x57d2bd(0x136)]({'success':!![],'result':_0xfc4c3c});}catch(_0x17494f){_0x1bc484(_0x17494f);}},this['deletePayout']=async(_0x1ed528,_0x13e48d,_0x594dff)=>{const _0x4eed01=_0x120ce7;try{const {id:_0x5649c7}=_0x1ed528[_0x4eed01(0x11a)];await this['adminService']['deletePayout'](_0x5649c7),_0x13e48d[_0x4eed01(0x136)]({'success':!![],'message':_0x4eed01(0x135)});}catch(_0x17f289){_0x594dff(_0x17f289);}},this[_0x120ce7(0x141)]=async(_0x411c23,_0x2be7ec,_0x3b903e)=>{const _0x5e8abe=_0x120ce7;try{const {page:page=0x1,limit:limit=0x14,status:_0x3b1428,gateway:_0x3f5f4d,shopId:_0x4c2320,dateFrom:_0x284531,dateTo:_0x2a5734,search:_0x2d7872,currency:_0x36667d,sortBy:_0x5c591d,sortOrder:_0x149658}=_0x411c23['query'],_0x433c0b={'page':Number(page),'limit':Number(limit),'status':_0x3b1428,'gateway':_0x3f5f4d,'shopId':_0x4c2320,'dateFrom':_0x284531,'dateTo':_0x2a5734,'search':_0x2d7872,'currency':_0x36667d,'sortBy':_0x5c591d,'sortOrder':_0x149658},_0x53c088=await this[_0x5e8abe(0x140)][_0x5e8abe(0x112)](_0x433c0b);_0x2be7ec[_0x5e8abe(0x136)]({'success':!![],'payments':_0x53c088['payments'],'pagination':_0x53c088['pagination']});}catch(_0x3a5e6e){_0x3b903e(_0x3a5e6e);}},this[_0x120ce7(0x149)]=async(_0x1aa284,_0x1644bf,_0x266b52)=>{const _0x265f53=_0x120ce7;try{const {id:_0x34141f}=_0x1aa284[_0x265f53(0x11a)],_0x2f859d=await this[_0x265f53(0x140)][_0x265f53(0x149)](_0x34141f);if(!_0x2f859d)return _0x1644bf['status'](0x194)[_0x265f53(0x136)]({'success':![],'message':_0x265f53(0x13b)});_0x1644bf['json']({'success':!![],'result':_0x2f859d});}catch(_0x3b6901){_0x266b52(_0x3b6901);}},this['updatePayment']=async(_0x10d66d,_0x161a44,_0xe5b81d)=>{const _0x1f147f=_0x120ce7;try{const {id:_0x21e369}=_0x10d66d[_0x1f147f(0x11a)],{status:_0x3aa67b,notes:_0x509319,chargebackAmount:_0x22735d}=_0x10d66d[_0x1f147f(0x14b)],_0x3317c7=await this[_0x1f147f(0x140)][_0x1f147f(0x149)](_0x21e369);if(!_0x3317c7)return _0x161a44[_0x1f147f(0x12b)](0x194)[_0x1f147f(0x136)]({'success':![],'message':'Payment\x20not\x20found'});const _0x38e0c3=await this['adminService']['updatePaymentStatus'](_0x21e369,_0x3aa67b,_0x509319,_0x22735d);if(_0x3317c7[_0x1f147f(0x12b)]!==_0x3aa67b&&_0x3aa67b[_0x1f147f(0x10f)]()===_0x1f147f(0x12f)){console[_0x1f147f(0xff)]('ðŸ“ˆ\x20Admin\x20changed\x20payment\x20'+_0x21e369+'\x20to\x20PAID,\x20updating\x20payment\x20link\x20counter');try{await this['paymentLinkService'][_0x1f147f(0x129)](_0x21e369),console[_0x1f147f(0xff)](_0x1f147f(0x11d)+_0x21e369);}catch(_0x502f0e){console[_0x1f147f(0x145)](_0x1f147f(0x111),_0x502f0e);}}if(_0x3317c7[_0x1f147f(0x12b)]!==_0x3aa67b){console[_0x1f147f(0xff)](_0x1f147f(0x130)+_0x21e369+_0x1f147f(0xfb)+_0x3317c7['status']+_0x1f147f(0x124)+_0x3aa67b+_0x1f147f(0x131));try{let _0x3b19e4;switch(_0x3aa67b[_0x1f147f(0x10f)]()){case _0x1f147f(0x12f):_0x3b19e4=_0x1f147f(0x144);break;case _0x1f147f(0x107):_0x3b19e4=_0x1f147f(0x126);break;case _0x1f147f(0x10a):_0x3b19e4=_0x1f147f(0x13a);break;case'EXPIRED':_0x3b19e4=_0x1f147f(0x109);break;case _0x1f147f(0x120):_0x3b19e4='refund';break;case'CHARGEBACK':_0x3b19e4=_0x1f147f(0x13e);break;default:console[_0x1f147f(0xff)]('ðŸ“±\x20Skipping\x20Telegram\x20notification\x20for\x20status\x20change\x20to:\x20'+_0x3aa67b);break;}if(_0x3b19e4){const _0x306df1={..._0x38e0c3,'shopId':_0x3317c7[_0x1f147f(0x105)],'gateway':_0x3317c7[_0x1f147f(0x114)],'createdAt':_0x3317c7[_0x1f147f(0x12c)],'chargebackAmount':_0x22735d};await telegramBotService_1['telegramBotService'][_0x1f147f(0xfd)](_0x3317c7[_0x1f147f(0x105)],_0x306df1,_0x3b19e4),console[_0x1f147f(0xff)]('âœ…\x20Telegram\x20notification\x20sent\x20for\x20status\x20change:\x20'+_0x3317c7[_0x1f147f(0x12b)]+_0x1f147f(0x11f)+_0x3aa67b);}}catch(_0x579d9f){console['error'](_0x1f147f(0xfe),_0x579d9f);}}_0x161a44['json']({'success':!![],'message':_0x1f147f(0x132),'result':_0x38e0c3});}catch(_0x3c5a47){_0xe5b81d(_0x3c5a47);}},this[_0x120ce7(0x110)]=async(_0x1d73c6,_0x4f0c11,_0xdd7a18)=>{const _0x1a1374=_0x120ce7;try{const {id:_0x8072a5}=_0x1d73c6['params'],_0x23789d=_0x1d73c6[_0x1a1374(0x14b)];console[_0x1a1374(0xff)]('ðŸ”„\x20Admin\x20updating\x20customer\x20data\x20for\x20payment\x20'+_0x8072a5+':',_0x23789d);const _0x2cd795=await this[_0x1a1374(0x140)]['updateCustomerData'](_0x8072a5,_0x23789d);_0x4f0c11[_0x1a1374(0x136)]({'success':!![],'message':_0x1a1374(0x139),'result':_0x2cd795});}catch(_0x52dfdf){_0xdd7a18(_0x52dfdf);}},this[_0x120ce7(0xfa)]=async(_0x1e7b2d,_0x41d5ab,_0xa8f0ac)=>{const _0x593083=_0x120ce7;try{const {id:_0x49aeb0}=_0x1e7b2d['params'],_0x4ae123=_0x1e7b2d[_0x593083(0x14b)],_0x12bf5f=await this[_0x593083(0x140)][_0x593083(0xfa)](_0x49aeb0,_0x4ae123);_0x41d5ab[_0x593083(0x136)]({'success':!![],'message':_0x593083(0x11b),'result':_0x12bf5f});}catch(_0x4c0e49){_0xa8f0ac(_0x4c0e49);}},this[_0x120ce7(0x117)]=async(_0x289cfa,_0x3351a9,_0x5de186)=>{const _0x4d2cf9=_0x120ce7;try{const {id:_0x822e86}=_0x289cfa['params'],_0x37086b=await this['adminService'][_0x4d2cf9(0x117)](_0x822e86);_0x3351a9[_0x4d2cf9(0x136)]({'success':!![],'message':'User\x20suspended\x20successfully','result':_0x37086b});}catch(_0x4c395f){_0x5de186(_0x4c395f);}},this[_0x120ce7(0x102)]=async(_0x40e61c,_0x523f5b,_0xe46ebf)=>{const _0x4f6a0c=_0x120ce7;try{const {id:_0x166871}=_0x40e61c['params'],_0x25074e=await this['adminService'][_0x4f6a0c(0x102)](_0x166871);_0x523f5b[_0x4f6a0c(0x136)]({'success':!![],'message':'User\x20activated\x20successfully','result':_0x25074e});}catch(_0x52a3ef){_0xe46ebf(_0x52a3ef);}},this[_0x120ce7(0x13c)]=async(_0xc7bf25,_0x2c4eec,_0x2e4b30)=>{const _0x456958=_0x120ce7;try{const {page:page=0x1,limit:limit=0x14,status:_0x4b88aa}=_0xc7bf25['query'],_0x27544d={'page':Number(page),'limit':Number(limit),'status':_0x4b88aa},_0x3bae8b=await this['adminService'][_0x456958(0x133)](_0x27544d);_0x2c4eec['json']({'success':!![],'users':_0x3bae8b['users'],'pagination':_0x3bae8b[_0x456958(0x100)]});}catch(_0x3409fb){_0x2e4b30(_0x3409fb);}},this[_0x120ce7(0x134)]=async(_0x422631,_0x31e994,_0x4b4e1e)=>{const _0x2e4c79=_0x120ce7;try{const {id:_0xd0e9a1}=_0x422631[_0x2e4c79(0x11a)],_0x37597c=await this[_0x2e4c79(0x140)]['getUserById'](_0xd0e9a1);if(!_0x37597c)return _0x31e994[_0x2e4c79(0x12b)](0x194)[_0x2e4c79(0x136)]({'success':![],'message':'User\x20not\x20found'});_0x31e994[_0x2e4c79(0x136)]({'success':!![],'result':_0x37597c});}catch(_0x213299){_0x4b4e1e(_0x213299);}},this[_0x120ce7(0x122)]=async(_0x3ed928,_0x420b09,_0x1903d7)=>{const _0x39d960=_0x120ce7;try{const _0x303565=_0x3ed928[_0x39d960(0x14b)],_0xe22e0=await this[_0x39d960(0x140)]['createUser'](_0x303565);_0x420b09['status'](0xc9)['json']({'success':!![],'message':_0x39d960(0xfc),'result':_0xe22e0});}catch(_0x5084b2){_0x1903d7(_0x5084b2);}},this['deleteUser']=async(_0x2c2bdf,_0x52e327,_0x58d587)=>{const _0x3ae069=_0x120ce7;try{const {id:_0x307dcc}=_0x2c2bdf[_0x3ae069(0x11a)];await this['adminService'][_0x3ae069(0x138)](_0x307dcc),_0x52e327[_0x3ae069(0x136)]({'success':!![],'message':_0x3ae069(0x13f)});}catch(_0x1b4f3f){_0x58d587(_0x1b4f3f);}},this[_0x120ce7(0x140)]=new adminService_1['AdminService'](),this[_0x120ce7(0x125)]=new paymentLinkService_1['PaymentLinkService']();}}exports['AdminController']=AdminController;