'use strict';function a4_0x2e5f(_0x151a2e,_0x3baf59){_0x151a2e=_0x151a2e-0x15c;const _0x409fc4=a4_0x409f();let _0x2e5f81=_0x409fc4[_0x151a2e];return _0x2e5f81;}const a4_0x54a921=a4_0x2e5f;(function(_0x5b4912,_0x2421e7){const _0x1490f7=a4_0x2e5f,_0x22888b=_0x5b4912();while(!![]){try{const _0x15e96d=-parseInt(_0x1490f7(0x16b))/0x1*(parseInt(_0x1490f7(0x1ec))/0x2)+-parseInt(_0x1490f7(0x196))/0x3+-parseInt(_0x1490f7(0x19c))/0x4+parseInt(_0x1490f7(0x219))/0x5*(-parseInt(_0x1490f7(0x214))/0x6)+-parseInt(_0x1490f7(0x17f))/0x7*(parseInt(_0x1490f7(0x184))/0x8)+parseInt(_0x1490f7(0x17a))/0x9+parseInt(_0x1490f7(0x1da))/0xa*(parseInt(_0x1490f7(0x1af))/0xb);if(_0x15e96d===_0x2421e7)break;else _0x22888b['push'](_0x22888b['shift']());}catch(_0x16313e){_0x22888b['push'](_0x22888b['shift']());}}}(a4_0x409f,0xdcbcc));var __createBinding=this&&this['__createBinding']||(Object[a4_0x54a921(0x20f)]?function(_0x1e8d15,_0x490699,_0x5070e0,_0x16e5a9){const _0x3c0119=a4_0x54a921;if(_0x16e5a9===undefined)_0x16e5a9=_0x5070e0;var _0x48706b=Object[_0x3c0119(0x19e)](_0x490699,_0x5070e0);(!_0x48706b||(_0x3c0119(0x18f)in _0x48706b?!_0x490699[_0x3c0119(0x1c3)]:_0x48706b[_0x3c0119(0x167)]||_0x48706b['configurable']))&&(_0x48706b={'enumerable':!![],'get':function(){return _0x490699[_0x5070e0];}}),Object[_0x3c0119(0x1eb)](_0x1e8d15,_0x16e5a9,_0x48706b);}:function(_0x2b0f6c,_0x51433,_0x53363b,_0x13815e){if(_0x13815e===undefined)_0x13815e=_0x53363b;_0x2b0f6c[_0x13815e]=_0x51433[_0x53363b];}),__setModuleDefault=this&&this[a4_0x54a921(0x1b3)]||(Object[a4_0x54a921(0x20f)]?function(_0x1f3fe3,_0x17dd27){const _0x1e4b28=a4_0x54a921;Object[_0x1e4b28(0x1eb)](_0x1f3fe3,_0x1e4b28(0x218),{'enumerable':!![],'value':_0x17dd27});}:function(_0x3ce9f4,_0x21cada){_0x3ce9f4['default']=_0x21cada;}),__importStar=this&&this[a4_0x54a921(0x213)]||(function(){var _0xf0738c=function(_0x506e88){const _0x5ddbe4=a4_0x2e5f;return _0xf0738c=Object[_0x5ddbe4(0x162)]||function(_0x59b1d1){const _0x24c500=_0x5ddbe4;var _0x14014a=[];for(var _0x164d27 in _0x59b1d1)if(Object[_0x24c500(0x1f6)][_0x24c500(0x1c2)][_0x24c500(0x1f0)](_0x59b1d1,_0x164d27))_0x14014a[_0x14014a[_0x24c500(0x1bd)]]=_0x164d27;return _0x14014a;},_0xf0738c(_0x506e88);};return function(_0x3f882e){const _0x2b29b1=a4_0x2e5f;if(_0x3f882e&&_0x3f882e[_0x2b29b1(0x1c3)])return _0x3f882e;var _0x4b5218={};if(_0x3f882e!=null){for(var _0x1480de=_0xf0738c(_0x3f882e),_0x9bdea3=0x0;_0x9bdea3<_0x1480de[_0x2b29b1(0x1bd)];_0x9bdea3++)if(_0x1480de[_0x9bdea3]!=='default')__createBinding(_0x4b5218,_0x3f882e,_0x1480de[_0x9bdea3]);}return __setModuleDefault(_0x4b5218,_0x3f882e),_0x4b5218;};}()),__importDefault=this&&this[a4_0x54a921(0x19b)]||function(_0x141f49){const _0x531472=a4_0x54a921;return _0x141f49&&_0x141f49[_0x531472(0x1c3)]?_0x141f49:{'default':_0x141f49};};function a4_0x409f(){const _0x2782e1=['loginLog','month','createUser','updatePayout','cleanupStalePendingPayments','periodFrom,\x20periodTo,\x20and\x20gateway\x20are\x20required','AdminService','updateUser','cleanupStalePaymentsWithReport','User\x20activated\x20successfully','disableAdmin2FA','users','cleanupStaleProcessingPayments','‚úÖ\x20Telegram\x20notification\x20sent\x20for\x20status\x20change:\x20','total','User\x20not\x20found','getGatewaySettings','üìà\x20Admin\x20changed\x20payment\x20','chargeback','updateCustomerData','EXPIRED','getMerchantStatistics','getSystemStatistics','create','\x20paid\x20payments\x20for\x20','forEach','status','__importStar','24EhmtMw','getAllPayouts','enableAdmin2FA','telegramBotService','default','646020CFaDkX','handleSuccessfulPayment','checkAuth','\x20to\x20PAID,\x20updating\x20payment\x20link\x20counter','getSettingsByGatewayId','sendPaymentNotification','adminService','amountUSDT','enable2FA','getOwnPropertyNames','getPayoutReports','deletePayout','User\x20created\x20successfully','getLoginLogs','writable','merchants','findMany','toUpperCase','1xwtZLL','getStatistics','getPaymentById','‚è∞\x20Manual\x20PENDING\x20payment\x20cleanup\x20initiated\x20by\x20admin:\x20','suspendUser','Failed\x20to\x20send\x20Telegram\x20notification\x20for\x20status\x20change:','params','üí∏\x20[GATEWAY\x20STATS]\x20Refund\x20count:\x20','üìà\x20[GATEWAY\x20STATS]\x20Calculated\x20statistics:','PAID','payouts','getAllPayments','üìä\x20Admin\x20requesting\x20merchant\x20statistics\x20with\x20filters:','User\x20suspended\x20successfully','expireSinglePaymentLinks','13471029rpfFCT','log','createPayout','failed','Gateway\x20not\x20found','91aiyXXV','Payment\x20link\x20expiration\x20check\x20completed\x20successfully','gatewayCommission','PROCESSING','body','199720rtMPtA','updateGatewaySettings','payment','../services/adminService','../services/paymentCleanupService','getShopWallets','shopId\x20and\x20amount\x20are\x20required','getPayouts','username','count','../config/database','get','errors','\x20->\x20Gateway\x20Name:\x20','üéØ\x20[CONTROLLER]\x20Updating\x20payout\x20','json','summary','User\x20updated\x20successfully','3273582vnwiDT','resolve','changeAdminPassword','getPayoutById','../services/paymentLinkService','__importDefault','459432EutKcb','‚úÖ\x20Payment\x20link\x20counter\x20updated\x20for\x20payment\x20','getOwnPropertyDescriptor','paymentCleanupService','stringify','üìä\x20[GATEWAY\x20STATS]\x20Gateway\x20commission:\x20','../services/gatewaySettingsService','shopId','activateUser','\x20\x20\x20-\x20Total\x20Turnover:\x20','refund','getAllUsers','processed','üîÑ\x20Admin\x20updating\x20customer\x20data\x20for\x20payment\x20','\x20\x20\x20-\x20Successful\x20Payments:\x20','\x20to\x20','processing','FAILED','PENDING\x20payment\x20cleanup\x20completed\x20successfully','12538361okmOxD','üéØ\x20[CONTROLLER]\x20Creating\x20payout\x20with\x20data:','all','toFixed','__setModuleDefault','updateSettings','true','role','get2FASettings','Admin\x20access\x20confirmed','ceil','pagination','getPayoutStats','updatePaymentStatus','length','\x20\x20\x20-\x20Chargeback\x20Rate:\x20','‚ùå\x20[GATEWAY\x20STATS]\x20Gateway\x20not\x20found\x20for\x20ID:\x20','depositBalance','üîç\x20[GATEWAY\x20STATS]\x20Querying\x20payments\x20with\x20gateway=\x22','hasOwnProperty','__esModule','createdAt','Payment\x20not\x20found','AdminController','getMerchantsAwaitingPayout','Payout\x20created\x20successfully','CHARGEBACK','üìä\x20[GATEWAY\x20STATS]\x20Requesting\x20statistics\x20for\x20gateway\x20ID:\x20','setupAdmin2FA','getGatewayStatistics','deleteUser','2FA\x20enabled\x20successfully','then',',\x20sending\x20Telegram\x20notification','üì±\x20Payment\x20','Token\x20is\x20required','gateway','getPayments','Payment\x20updated\x20successfully','expirePaymentLinks','cleanupStalePayments','üìä\x20Admin\x20requesting\x20payout\x20reports:','üßπ\x20Manual\x20PROCESSING\x20payment\x20cleanup\x20initiated\x20by\x20admin:\x20','20UeKOtO','Customer\x20data\x20updated\x20successfully','error','gatewaySettingsService','getProcessingPaymentsStats','getAllGatewaysWithSettings','expired','getMerchantsSelection','disable2FA','REFUND','statistics','Admin\x20password\x20changed\x20successfully','Gateway\x20settings\x20updated\x20successfully','üí∞\x20[GATEWAY\x20STATS]\x20Found\x20','üîç\x20[GATEWAY\x20STATS]\x20Sample\x20payments\x20for\x20','Payout\x20updated\x20successfully','getUserById','defineProperty','1649860NyRDQj','Payout\x20deleted\x20successfully','user','../types/gateway','call','Admin\x202FA\x20disabled\x20successfully','üîô\x20[GATEWAY\x20STATS]\x20Chargeback\x20count:\x20','Payout\x20not\x20found','query','30d','prototype','2FA\x20disabled\x20successfully'];a4_0x409f=function(){return _0x2782e1;};return a4_0x409f();}Object['defineProperty'](exports,a4_0x54a921(0x1c3),{'value':!![]}),exports[a4_0x54a921(0x1c6)]=void 0x0;const adminService_1=require(a4_0x54a921(0x187)),paymentLinkService_1=require(a4_0x54a921(0x19a)),paymentCleanupService_1=require(a4_0x54a921(0x188)),telegramBotService_1=require('../services/telegramBotService'),gatewaySettingsService_1=require('../services/gatewaySettingsService'),database_1=__importDefault(require(a4_0x54a921(0x18e)));class AdminController{constructor(){const _0x5b48b9=a4_0x54a921;this[_0x5b48b9(0x21b)]=async(_0x263651,_0x32449d,_0x44fcbc)=>{const _0x2662f6=_0x5b48b9;try{const _0x157ef3=_0x263651['user'];_0x32449d[_0x2662f6(0x193)]({'success':!![],'message':_0x2662f6(0x1b8),'user':{'id':_0x157ef3?.['id'],'username':_0x157ef3?.['username'],'role':_0x157ef3?.[_0x2662f6(0x1b6)]}});}catch(_0x12a289){_0x44fcbc(_0x12a289);}},this[_0x5b48b9(0x16c)]=async(_0x198c9a,_0x51bc70,_0x27e841)=>{const _0x4ad630=_0x5b48b9;try{const {period:period=_0x4ad630(0x1f5),currentDate:_0x27522a}=_0x198c9a[_0x4ad630(0x1f4)],_0x5a7fb2=await this[_0x4ad630(0x15f)][_0x4ad630(0x20e)](period,_0x27522a);_0x51bc70[_0x4ad630(0x193)]({'success':!![],'result':_0x5a7fb2});}catch(_0x3c8faf){_0x27e841(_0x3c8faf);}},this['getMerchantStatistics']=async(_0x3e23ab,_0x12a913,_0x16f516)=>{const _0x45abef=_0x5b48b9;try{const {shopId:_0x446553,period:period=_0x45abef(0x1f9),dateFrom:_0x9f3c96,dateTo:_0x3f8fb5}=_0x3e23ab['query'],_0x3ad6af={'shopId':_0x446553,'period':period,'dateFrom':_0x9f3c96,'dateTo':_0x3f8fb5};console[_0x45abef(0x17b)](_0x45abef(0x177),_0x3ad6af);const _0x41e9e2=await this[_0x45abef(0x15f)][_0x45abef(0x20d)](_0x3ad6af);_0x12a913['json']({'success':!![],'result':_0x41e9e2});}catch(_0xdfff62){_0x16f516(_0xdfff62);}},this[_0x5b48b9(0x163)]=async(_0x3391b5,_0x240153,_0x265d82)=>{const _0x3ed189=_0x5b48b9;try{const {periodFrom:_0x5bc1ee,periodTo:_0x9056b8,gateway:_0x2ce34e}=_0x3391b5['query'];if(!_0x5bc1ee||!_0x9056b8||!_0x2ce34e)return _0x240153['status'](0x190)[_0x3ed189(0x193)]({'success':![],'message':_0x3ed189(0x1fd)});console[_0x3ed189(0x17b)](_0x3ed189(0x1d8),{'periodFrom':_0x5bc1ee,'periodTo':_0x9056b8,'gateway':_0x2ce34e});const _0x33be6e=await this[_0x3ed189(0x15f)]['getPayoutReports']({'periodFrom':_0x5bc1ee,'periodTo':_0x9056b8,'gateway':_0x2ce34e});_0x240153['json']({'success':!![],'reports':_0x33be6e});}catch(_0x4632bb){_0x265d82(_0x4632bb);}},this[_0x5b48b9(0x1bb)]=async(_0x1a7b38,_0x37584d,_0x1687bd)=>{const _0x1da726=_0x5b48b9;try{const _0x2ab72c=await this[_0x1da726(0x15f)][_0x1da726(0x1bb)]();_0x37584d['json']({'success':!![],'result':_0x2ab72c});}catch(_0x232849){_0x1687bd(_0x232849);}},this[_0x5b48b9(0x1c7)]=async(_0x753d9b,_0x261ad2,_0x4a2936)=>{const _0x245109=_0x5b48b9;try{const {page:page=0x1,limit:limit=0x14,minAmount:_0x294e7e,search:_0x2dace2}=_0x753d9b[_0x245109(0x1f4)],_0x4808f3={'page':Number(page),'limit':Number(limit),'minAmount':_0x294e7e?Number(_0x294e7e):undefined,'search':_0x2dace2},_0x45f756=await this['adminService'][_0x245109(0x1c7)](_0x4808f3);_0x261ad2[_0x245109(0x193)]({'success':!![],'merchants':_0x45f756[_0x245109(0x168)],'pagination':_0x45f756[_0x245109(0x1ba)],'summary':_0x45f756[_0x245109(0x194)]});}catch(_0x35b06d){_0x4a2936(_0x35b06d);}},this[_0x5b48b9(0x1e1)]=async(_0x3c6a7a,_0x2dc0a7,_0x4a9ad8)=>{const _0x4815b5=_0x5b48b9;try{const _0x22b898=_0x3c6a7a['query']['hasPayoutHistory']===_0x4815b5(0x1b5),_0x316d26=await this[_0x4815b5(0x15f)]['getMerchantsSelection'](_0x22b898);_0x2dc0a7[_0x4815b5(0x193)]({'success':!![],'result':_0x316d26});}catch(_0x18b9ff){_0x4a9ad8(_0x18b9ff);}},this[_0x5b48b9(0x17c)]=async(_0x3298ea,_0x14cab0,_0x12d3e7)=>{const _0x1c1ca3=_0x5b48b9;try{const _0x2fbd50=_0x3298ea[_0x1c1ca3(0x183)];console['log'](_0x1c1ca3(0x1b0),_0x2fbd50);const _0x5bfd01=await this[_0x1c1ca3(0x15f)][_0x1c1ca3(0x17c)](_0x2fbd50);_0x14cab0[_0x1c1ca3(0x212)](0xc9)['json']({'success':!![],'message':_0x1c1ca3(0x1c8),'result':_0x5bfd01});}catch(_0x4e7070){_0x12d3e7(_0x4e7070);}},this[_0x5b48b9(0x1fb)]=async(_0x526a1a,_0x276f90,_0x3a0057)=>{const _0x47359c=_0x5b48b9;try{const {id:_0x4f5169}=_0x526a1a[_0x47359c(0x171)],_0x1d63a8=_0x526a1a[_0x47359c(0x183)];console[_0x47359c(0x17b)](_0x47359c(0x192)+_0x4f5169+'\x20with\x20data:',_0x1d63a8);const _0x115b6c=await this[_0x47359c(0x15f)][_0x47359c(0x1fb)](_0x4f5169,_0x1d63a8);_0x276f90[_0x47359c(0x193)]({'success':!![],'message':_0x47359c(0x1e9),'result':_0x115b6c});}catch(_0x3102ac){_0x3a0057(_0x3102ac);}},this[_0x5b48b9(0x18b)]=async(_0x31774c,_0x38ee4e,_0xc9e7a0)=>{const _0x2b14da=_0x5b48b9;try{const {page:page=0x1,limit:limit=0x14,shopId:_0x584edf,network:_0x37649f,dateFrom:_0x14d19f,dateTo:_0x2517c2,search:_0x5af058}=_0x31774c['query'],_0x349032={'page':Number(page),'limit':Number(limit),'shopId':_0x584edf,'network':_0x37649f,'dateFrom':_0x14d19f,'dateTo':_0x2517c2,'search':_0x5af058},_0x302eba=await this['adminService'][_0x2b14da(0x215)](_0x349032);_0x38ee4e[_0x2b14da(0x193)]({'success':!![],'payouts':_0x302eba[_0x2b14da(0x175)],'pagination':_0x302eba['pagination']});}catch(_0x1fc662){_0xc9e7a0(_0x1fc662);}},this[_0x5b48b9(0x199)]=async(_0xf365e1,_0x208f9a,_0x3a24d2)=>{const _0x4537cd=_0x5b48b9;try{const {id:_0x3e4863}=_0xf365e1[_0x4537cd(0x171)],_0x5da809=await this[_0x4537cd(0x15f)][_0x4537cd(0x199)](_0x3e4863);if(!_0x5da809)return _0x208f9a['status'](0x194)[_0x4537cd(0x193)]({'success':![],'message':_0x4537cd(0x1f3)});_0x208f9a[_0x4537cd(0x193)]({'success':!![],'result':_0x5da809});}catch(_0x5645a9){_0x3a24d2(_0x5645a9);}},this[_0x5b48b9(0x164)]=async(_0x5bb042,_0x5a4240,_0x398377)=>{const _0xa3cfbe=_0x5b48b9;try{const {id:_0x10ad3f}=_0x5bb042['params'];await this[_0xa3cfbe(0x15f)]['deletePayout'](_0x10ad3f),_0x5a4240[_0xa3cfbe(0x193)]({'success':!![],'message':_0xa3cfbe(0x1ed)});}catch(_0x3e5af1){_0x398377(_0x3e5af1);}},this[_0x5b48b9(0x1d4)]=async(_0x328a39,_0x2def4f,_0x209e2d)=>{const _0x7b1677=_0x5b48b9;try{const {page:page=0x1,limit:limit=0x14,status:_0x30afce,gateway:_0x2feb87,shopId:_0x16b419,dateFrom:_0x2ec801,dateTo:_0xa5daa6,search:_0x1ff4c4,currency:_0x163bbc,sortBy:_0x5012b6,sortOrder:_0x427dee}=_0x328a39[_0x7b1677(0x1f4)],_0x108f56={'page':Number(page),'limit':Number(limit),'status':_0x30afce,'gateway':_0x2feb87,'shopId':_0x16b419,'dateFrom':_0x2ec801,'dateTo':_0xa5daa6,'search':_0x1ff4c4,'currency':_0x163bbc,'sortBy':_0x5012b6,'sortOrder':_0x427dee},_0x8ce36f=await this[_0x7b1677(0x15f)][_0x7b1677(0x176)](_0x108f56);_0x2def4f[_0x7b1677(0x193)]({'success':!![],'payments':_0x8ce36f['payments'],'pagination':_0x8ce36f['pagination'],'statistics':_0x8ce36f[_0x7b1677(0x1e4)]});}catch(_0x19951d){_0x209e2d(_0x19951d);}},this['getPaymentById']=async(_0x338b38,_0x5f1c0b,_0x5c8ef4)=>{const _0x15d6c5=_0x5b48b9;try{const {id:_0x4ae8c7}=_0x338b38[_0x15d6c5(0x171)],_0x4272a6=await this[_0x15d6c5(0x15f)][_0x15d6c5(0x16d)](_0x4ae8c7);if(!_0x4272a6)return _0x5f1c0b[_0x15d6c5(0x212)](0x194)[_0x15d6c5(0x193)]({'success':![],'message':_0x15d6c5(0x1c5)});_0x5f1c0b['json']({'success':!![],'result':_0x4272a6});}catch(_0xe10c3f){_0x5c8ef4(_0xe10c3f);}},this['updatePayment']=async(_0x289b83,_0x208e7a,_0x106d4a)=>{const _0x532853=_0x5b48b9;try{const {id:_0x30ba50}=_0x289b83[_0x532853(0x171)],{status:_0x33ca1d,notes:_0x5a128f,chargebackAmount:_0x32762c}=_0x289b83[_0x532853(0x183)],_0x33db8e=await this[_0x532853(0x15f)][_0x532853(0x16d)](_0x30ba50);if(!_0x33db8e)return _0x208e7a[_0x532853(0x212)](0x194)[_0x532853(0x193)]({'success':![],'message':_0x532853(0x1c5)});const _0x43457f=await this[_0x532853(0x15f)][_0x532853(0x1bc)](_0x30ba50,_0x33ca1d,_0x5a128f,_0x32762c);if(_0x33db8e[_0x532853(0x212)]!==_0x33ca1d&&_0x33ca1d[_0x532853(0x16a)]()==='PAID'){console[_0x532853(0x17b)](_0x532853(0x209)+_0x30ba50+_0x532853(0x15c));try{await this['paymentLinkService'][_0x532853(0x21a)](_0x30ba50),console[_0x532853(0x17b)](_0x532853(0x19d)+_0x30ba50);}catch(_0x697159){console[_0x532853(0x1dc)]('Failed\x20to\x20update\x20payment\x20link\x20counter:',_0x697159);}}if(_0x33db8e['status']!==_0x33ca1d){console[_0x532853(0x17b)](_0x532853(0x1d1)+_0x30ba50+'\x20status\x20changed\x20from\x20'+_0x33db8e['status']+_0x532853(0x1ab)+_0x33ca1d+_0x532853(0x1d0));try{let _0x22173f;switch(_0x33ca1d['toUpperCase']()){case _0x532853(0x174):_0x22173f='paid';break;case _0x532853(0x182):_0x22173f=_0x532853(0x1ac);break;case _0x532853(0x1ad):_0x22173f=_0x532853(0x17d);break;case _0x532853(0x20c):_0x22173f='expired';break;case _0x532853(0x1e3):_0x22173f=_0x532853(0x1a6);break;case _0x532853(0x1c9):_0x22173f=_0x532853(0x20a);break;default:console[_0x532853(0x17b)]('üì±\x20Skipping\x20Telegram\x20notification\x20for\x20status\x20change\x20to:\x20'+_0x33ca1d);break;}if(_0x22173f){const _0x16540a={..._0x43457f,'shopId':_0x33db8e['shopId'],'gateway':_0x33db8e[_0x532853(0x1d3)],'createdAt':_0x33db8e[_0x532853(0x1c4)],'chargebackAmount':_0x32762c};await telegramBotService_1[_0x532853(0x217)][_0x532853(0x15e)](_0x33db8e[_0x532853(0x1a3)],_0x16540a,_0x22173f),console[_0x532853(0x17b)](_0x532853(0x205)+_0x33db8e[_0x532853(0x212)]+'\x20->\x20'+_0x33ca1d);}}catch(_0x35a906){console[_0x532853(0x1dc)](_0x532853(0x170),_0x35a906);}}_0x208e7a[_0x532853(0x193)]({'success':!![],'message':_0x532853(0x1d5),'result':_0x43457f});}catch(_0x1e77aa){_0x106d4a(_0x1e77aa);}},this[_0x5b48b9(0x20b)]=async(_0x41f6ed,_0x2e0b6b,_0x4466e0)=>{const _0x50c0d0=_0x5b48b9;try{const {id:_0x82602d}=_0x41f6ed[_0x50c0d0(0x171)],_0x4da62c=_0x41f6ed[_0x50c0d0(0x183)];console[_0x50c0d0(0x17b)](_0x50c0d0(0x1a9)+_0x82602d+':',_0x4da62c);const _0x43d6ae=await this[_0x50c0d0(0x15f)][_0x50c0d0(0x20b)](_0x82602d,_0x4da62c);_0x2e0b6b[_0x50c0d0(0x193)]({'success':!![],'message':_0x50c0d0(0x1db),'result':_0x43d6ae});}catch(_0x1d3084){_0x4466e0(_0x1d3084);}},this[_0x5b48b9(0x1ff)]=async(_0x377f2a,_0x152c9f,_0x4b8bcb)=>{const _0x5abb19=_0x5b48b9;try{const {id:_0x5c8932}=_0x377f2a[_0x5abb19(0x171)],_0x28ed7a=_0x377f2a[_0x5abb19(0x183)],_0x1ecded=await this[_0x5abb19(0x15f)][_0x5abb19(0x1ff)](_0x5c8932,_0x28ed7a);_0x152c9f[_0x5abb19(0x193)]({'success':!![],'message':_0x5abb19(0x195),'result':_0x1ecded});}catch(_0x11795b){_0x4b8bcb(_0x11795b);}},this[_0x5b48b9(0x16f)]=async(_0x4a798f,_0x1b7ae8,_0x29c21b)=>{const _0x425d00=_0x5b48b9;try{const {id:_0x3a9c04}=_0x4a798f[_0x425d00(0x171)],_0x5b5030=await this[_0x425d00(0x15f)]['suspendUser'](_0x3a9c04);_0x1b7ae8[_0x425d00(0x193)]({'success':!![],'message':_0x425d00(0x178),'result':_0x5b5030});}catch(_0x109334){_0x29c21b(_0x109334);}},this[_0x5b48b9(0x1a4)]=async(_0x22cc11,_0x38244f,_0x56e909)=>{const _0xd2eecc=_0x5b48b9;try{const {id:_0x36d641}=_0x22cc11['params'],_0x37388b=await this[_0xd2eecc(0x15f)][_0xd2eecc(0x1a4)](_0x36d641);_0x38244f[_0xd2eecc(0x193)]({'success':!![],'message':_0xd2eecc(0x201),'result':_0x37388b});}catch(_0x61b8a0){_0x56e909(_0x61b8a0);}},this['getUsers']=async(_0x57ae29,_0x463c72,_0x4b8a95)=>{const _0x4409c1=_0x5b48b9;try{const {page:page=0x1,limit:limit=0x14,status:_0x50174f,search:_0x267f56}=_0x57ae29[_0x4409c1(0x1f4)],_0x565202={'page':Number(page),'limit':Number(limit),'status':_0x50174f,'search':_0x267f56},_0x43212c=await this[_0x4409c1(0x15f)][_0x4409c1(0x1a7)](_0x565202);_0x463c72[_0x4409c1(0x193)]({'success':!![],'users':_0x43212c[_0x4409c1(0x203)],'pagination':_0x43212c[_0x4409c1(0x1ba)]});}catch(_0x26c9fd){_0x4b8a95(_0x26c9fd);}},this[_0x5b48b9(0x1ea)]=async(_0x18c430,_0x2d6710,_0x10b489)=>{const _0x9e5c18=_0x5b48b9;try{const {id:_0xfdc875}=_0x18c430[_0x9e5c18(0x171)],_0x5368d8=await this[_0x9e5c18(0x15f)][_0x9e5c18(0x1ea)](_0xfdc875);if(!_0x5368d8)return _0x2d6710[_0x9e5c18(0x212)](0x194)['json']({'success':![],'message':_0x9e5c18(0x207)});_0x2d6710[_0x9e5c18(0x193)]({'success':!![],'result':_0x5368d8});}catch(_0x320653){_0x10b489(_0x320653);}},this['createUser']=async(_0x293b96,_0x10c1a2,_0x3d0109)=>{const _0x3ac695=_0x5b48b9;try{const _0x44f462=_0x293b96['body'],_0x5e5757=await this[_0x3ac695(0x15f)][_0x3ac695(0x1fa)](_0x44f462);_0x10c1a2[_0x3ac695(0x212)](0xc9)[_0x3ac695(0x193)]({'success':!![],'message':_0x3ac695(0x165),'result':_0x5e5757});}catch(_0x54f624){_0x3d0109(_0x54f624);}},this[_0x5b48b9(0x1cd)]=async(_0x3ba85f,_0xb03a63,_0xa878c4)=>{const _0x13ce93=_0x5b48b9;try{const {id:_0xf934f9}=_0x3ba85f[_0x13ce93(0x171)],{twoFactorToken:_0x4939db}=_0x3ba85f[_0x13ce93(0x183)];await this['adminService'][_0x13ce93(0x1cd)](_0xf934f9,_0x4939db),_0xb03a63[_0x13ce93(0x193)]({'success':!![],'message':'User\x20deleted\x20successfully'});}catch(_0x3aa8b4){_0xa878c4(_0x3aa8b4);}},this[_0x5b48b9(0x189)]=async(_0x572e21,_0x2670e6,_0x187f58)=>{const _0x537445=_0x5b48b9;try{const {shopId:_0x52b56c}=_0x572e21[_0x537445(0x171)],_0x4cc1f8=await this[_0x537445(0x15f)][_0x537445(0x189)](_0x52b56c);_0x2670e6[_0x537445(0x193)]({'success':!![],'wallets':_0x4cc1f8});}catch(_0x42e208){_0x187f58(_0x42e208);}},this['setup2FA']=async(_0x205bf9,_0x37fbed,_0x35de6f)=>{const _0x4e3dee=_0x5b48b9;try{const {shopId:_0x43e2bc}=_0x205bf9[_0x4e3dee(0x171)],_0x5da398=await this[_0x4e3dee(0x15f)]['setup2FA'](_0x43e2bc);_0x37fbed[_0x4e3dee(0x193)]({'success':!![],'result':_0x5da398});}catch(_0x3b117f){_0x35de6f(_0x3b117f);}},this[_0x5b48b9(0x161)]=async(_0x1151b0,_0x2f9e62,_0x4033a3)=>{const _0x4f6d11=_0x5b48b9;try{const {shopId:_0x51dbbe}=_0x1151b0[_0x4f6d11(0x171)],{token:_0x516124}=_0x1151b0['body'];if(!_0x516124)return _0x2f9e62['status'](0x190)[_0x4f6d11(0x193)]({'success':![],'message':_0x4f6d11(0x1d2)});const _0xfddce0=await this[_0x4f6d11(0x15f)][_0x4f6d11(0x161)](_0x51dbbe,_0x516124);_0x2f9e62[_0x4f6d11(0x193)]({'success':!![],'message':_0x4f6d11(0x1ce),'result':_0xfddce0});}catch(_0x1d684e){_0x4033a3(_0x1d684e);}},this[_0x5b48b9(0x1e2)]=async(_0x3343c7,_0x452ab3,_0x128fc0)=>{const _0x1b730e=_0x5b48b9;try{const {shopId:_0x3435c9}=_0x3343c7[_0x1b730e(0x171)];await this[_0x1b730e(0x15f)][_0x1b730e(0x1e2)](_0x3435c9),_0x452ab3[_0x1b730e(0x193)]({'success':!![],'message':_0x1b730e(0x1f7)});}catch(_0x3cdc98){_0x128fc0(_0x3cdc98);}},this[_0x5b48b9(0x1de)]=async(_0x27ff37,_0x48b037,_0x4aefa1)=>{const _0xd1f4bc=_0x5b48b9;try{const _0xc74bdc=await paymentCleanupService_1[_0xd1f4bc(0x19f)]['getProcessingPaymentsStats']();_0x48b037[_0xd1f4bc(0x193)]({'success':!![],'result':_0xc74bdc});}catch(_0x544048){_0x4aefa1(_0x544048);}},this[_0x5b48b9(0x1d7)]=async(_0xb11929,_0x4cc089,_0x272bbd)=>{const _0x1dbcfc=_0x5b48b9;try{console[_0x1dbcfc(0x17b)](_0x1dbcfc(0x1d9)+_0xb11929[_0x1dbcfc(0x1ee)]?.['username']+'\x20('+_0xb11929[_0x1dbcfc(0x1ee)]?.['id']+')');const _0x1f1de6=await paymentCleanupService_1[_0x1dbcfc(0x19f)][_0x1dbcfc(0x204)]();_0x4cc089[_0x1dbcfc(0x193)]({'success':!![],'message':'PROCESSING\x20payment\x20cleanup\x20completed\x20successfully','result':{'processed':_0x1f1de6[_0x1dbcfc(0x1a8)],'failed':_0x1f1de6[_0x1dbcfc(0x17d)],'errors':_0x1f1de6[_0x1dbcfc(0x190)]}});}catch(_0x5b36dd){_0x272bbd(_0x5b36dd);}},this['cleanupStalePendingPayments']=async(_0x1eb69c,_0x1f0d1c,_0x508477)=>{const _0x35c92a=_0x5b48b9;try{console[_0x35c92a(0x17b)](_0x35c92a(0x16e)+_0x1eb69c[_0x35c92a(0x1ee)]?.[_0x35c92a(0x18c)]+'\x20('+_0x1eb69c[_0x35c92a(0x1ee)]?.['id']+')');const _0x1250fc=await paymentCleanupService_1[_0x35c92a(0x19f)]['cleanupStalePendingPayments']();_0x1f0d1c[_0x35c92a(0x193)]({'success':!![],'message':_0x35c92a(0x1ae),'result':{'processed':_0x1250fc[_0x35c92a(0x1a8)],'failed':_0x1250fc[_0x35c92a(0x17d)],'errors':_0x1250fc[_0x35c92a(0x190)]}});}catch(_0x1bcca7){_0x508477(_0x1bcca7);}},this[_0x5b48b9(0x200)]=async(_0x484bcc,_0x1e4860,_0x140aae)=>{const _0x3ee26d=_0x5b48b9;try{console[_0x3ee26d(0x17b)]('üìä\x20Manual\x20payment\x20cleanup\x20(PROCESSING\x20+\x20PENDING)\x20with\x20report\x20initiated\x20by\x20admin:\x20'+_0x484bcc[_0x3ee26d(0x1ee)]?.[_0x3ee26d(0x18c)]+'\x20('+_0x484bcc[_0x3ee26d(0x1ee)]?.['id']+')');const _0x59263a=await paymentCleanupService_1[_0x3ee26d(0x19f)]['getProcessingPaymentsStats'](),_0x38fd19=await paymentCleanupService_1[_0x3ee26d(0x19f)][_0x3ee26d(0x204)](),_0x1e3bc4=await paymentCleanupService_1[_0x3ee26d(0x19f)][_0x3ee26d(0x1fc)](),_0x375b2c=await paymentCleanupService_1[_0x3ee26d(0x19f)]['getProcessingPaymentsStats']();_0x1e4860[_0x3ee26d(0x193)]({'success':!![],'message':'Payment\x20cleanup\x20(PROCESSING\x20+\x20PENDING)\x20with\x20report\x20completed\x20successfully','result':{'cleanup':{'processing':{'processed':_0x38fd19[_0x3ee26d(0x1a8)],'failed':_0x38fd19[_0x3ee26d(0x17d)],'errors':_0x38fd19[_0x3ee26d(0x190)]},'pending':{'processed':_0x1e3bc4[_0x3ee26d(0x1a8)],'failed':_0x1e3bc4['failed'],'errors':_0x1e3bc4[_0x3ee26d(0x190)]},'total':{'processed':_0x38fd19[_0x3ee26d(0x1a8)]+_0x1e3bc4['processed'],'failed':_0x38fd19[_0x3ee26d(0x17d)]+_0x1e3bc4[_0x3ee26d(0x17d)],'errors':[..._0x38fd19['errors'],..._0x1e3bc4[_0x3ee26d(0x190)]]}},'statistics':{'before':_0x59263a,'after':_0x375b2c,'reduced':_0x59263a[_0x3ee26d(0x206)]-_0x375b2c[_0x3ee26d(0x206)]}}});}catch(_0x395f3e){_0x140aae(_0x395f3e);}},this[_0x5b48b9(0x1d6)]=async(_0x12e3c7,_0x2eaca9,_0x52c77f)=>{const _0x36c769=_0x5b48b9;try{const _0x99d955=await paymentCleanupService_1['paymentCleanupService'][_0x36c769(0x179)]();_0x2eaca9[_0x36c769(0x193)]({'success':!![],'message':_0x36c769(0x180),'result':{'expired':_0x99d955[_0x36c769(0x1e0)],'errors':_0x99d955['errors']}});}catch(_0x47e3c4){_0x52c77f(_0x47e3c4);}},this[_0x5b48b9(0x198)]=async(_0x28db52,_0x47b57a,_0x134aa3)=>{const _0x182ede=_0x5b48b9;try{const {currentPassword:_0x180e89,newPassword:_0x34087c,confirmNewPassword:_0xc0ba48,twoFactorToken:_0x4cedfb}=_0x28db52[_0x182ede(0x183)];await this[_0x182ede(0x15f)][_0x182ede(0x198)](_0x180e89,_0x34087c,_0xc0ba48,_0x4cedfb),_0x47b57a[_0x182ede(0x193)]({'success':!![],'message':_0x182ede(0x1e5)});}catch(_0x11158f){_0x134aa3(_0x11158f);}},this[_0x5b48b9(0x1b7)]=async(_0x40cad2,_0x11f5cb,_0x1555f4)=>{const _0x12db5f=_0x5b48b9;try{const _0x4bcd3d=await this[_0x12db5f(0x15f)]['get2FASettings']();_0x11f5cb['json']({'success':!![],'result':_0x4bcd3d});}catch(_0x128da4){_0x1555f4(_0x128da4);}},this[_0x5b48b9(0x1cb)]=async(_0x194a87,_0x5d3508,_0x4514ad)=>{const _0x40ff9a=_0x5b48b9;try{const _0x477a9e=await this[_0x40ff9a(0x15f)][_0x40ff9a(0x1cb)]();_0x5d3508[_0x40ff9a(0x193)]({'success':!![],'result':_0x477a9e});}catch(_0x4ff631){_0x4514ad(_0x4ff631);}},this[_0x5b48b9(0x216)]=async(_0x3627a9,_0x102ab4,_0x333c2d)=>{const _0x5999e0=_0x5b48b9;try{const {token:_0x39aa7c}=_0x3627a9['body'],_0x10d5a3=await this['adminService']['enableAdmin2FA'](_0x39aa7c);_0x102ab4[_0x5999e0(0x193)]({'success':!![],'result':_0x10d5a3});}catch(_0x11ce98){_0x333c2d(_0x11ce98);}},this[_0x5b48b9(0x202)]=async(_0x347b26,_0x4cd392,_0x45b70b)=>{const _0x2e3049=_0x5b48b9;try{await this[_0x2e3049(0x15f)][_0x2e3049(0x202)](),_0x4cd392[_0x2e3049(0x193)]({'success':!![],'message':_0x2e3049(0x1f1)});}catch(_0x33fde3){_0x45b70b(_0x33fde3);}},this[_0x5b48b9(0x1c0)]=async(_0x4fcdaf,_0x1f8a3b,_0x12dda6)=>{const _0x24cd7b=_0x5b48b9;try{const {shopId:_0x4171c0,amount:_0x571136,notes:_0x5d7529}=_0x4fcdaf[_0x24cd7b(0x183)];if(!_0x4171c0||!_0x571136)return _0x1f8a3b[_0x24cd7b(0x212)](0x190)[_0x24cd7b(0x193)]({'success':![],'message':_0x24cd7b(0x18a)});if(_0x571136<=0x0)return _0x1f8a3b[_0x24cd7b(0x212)](0x190)[_0x24cd7b(0x193)]({'success':![],'message':'Amount\x20must\x20be\x20greater\x20than\x200'});await this[_0x24cd7b(0x15f)]['depositBalance'](_0x4171c0,_0x571136,_0x5d7529),_0x1f8a3b['json']({'success':!![],'message':'Balance\x20deposited\x20successfully'});}catch(_0x189fd4){_0x12dda6(_0x189fd4);}},this[_0x5b48b9(0x166)]=async(_0x5e051f,_0x51e46a,_0x28ca94)=>{const _0x2348a8=_0x5b48b9;try{const {shopId:_0x567f1d}=_0x5e051f[_0x2348a8(0x171)],{page:page='1',limit:limit='20'}=_0x5e051f[_0x2348a8(0x1f4)],_0x208881=(await Promise[_0x2348a8(0x197)]()[_0x2348a8(0x1cf)](()=>__importStar(require(_0x2348a8(0x18e)))))[_0x2348a8(0x218)],_0x1bfbd2=parseInt(page,0xa),_0x2d2838=parseInt(limit,0xa),_0x4df02b=(_0x1bfbd2-0x1)*_0x2d2838,[_0x1950bd,_0xf05f85]=await Promise[_0x2348a8(0x1b1)]([_0x208881[_0x2348a8(0x1f8)]['findMany']({'where':{'shopId':_0x567f1d},'orderBy':{'createdAt':'desc'},'skip':_0x4df02b,'take':_0x2d2838}),_0x208881['loginLog'][_0x2348a8(0x18d)]({'where':{'shopId':_0x567f1d}})]);_0x51e46a['json']({'success':!![],'result':{'logs':_0x1950bd,'pagination':{'page':_0x1bfbd2,'limit':_0x2d2838,'total':_0xf05f85,'totalPages':Math[_0x2348a8(0x1b9)](_0xf05f85/_0x2d2838)}}});}catch(_0x493f60){_0x28ca94(_0x493f60);}},this[_0x5b48b9(0x208)]=async(_0x3ca1fa,_0x2e13f8,_0x3cd272)=>{const _0x4ba176=_0x5b48b9;try{const _0x301fd7=gatewaySettingsService_1[_0x4ba176(0x1dd)][_0x4ba176(0x1df)]();_0x2e13f8['json']({'success':!![],'result':_0x301fd7});}catch(_0x5021af){_0x3cd272(_0x5021af);}},this[_0x5b48b9(0x185)]=async(_0x547a01,_0xb1592e,_0x51d599)=>{const _0x162c6f=_0x5b48b9;try{const {gatewayId:_0x2728e6}=_0x547a01['params'],{minAmount:_0x523f8b,maxAmount:_0xe24753,payoutDelay:_0x1c4295,gatewayCommission:_0x429f47}=_0x547a01[_0x162c6f(0x183)],_0x18e601=gatewaySettingsService_1[_0x162c6f(0x1dd)][_0x162c6f(0x1b4)](_0x2728e6,{'minAmount':_0x523f8b!==undefined?Number(_0x523f8b):undefined,'maxAmount':_0xe24753!==undefined?Number(_0xe24753):undefined,'payoutDelay':_0x1c4295!==undefined?Number(_0x1c4295):undefined,'gatewayCommission':_0x429f47!==undefined?Number(_0x429f47):undefined});_0xb1592e['json']({'success':!![],'message':_0x162c6f(0x1e6),'result':_0x18e601});}catch(_0x533f01){_0x51d599(_0x533f01);}},this[_0x5b48b9(0x1cc)]=async(_0x30f09f,_0x1c0007,_0x3db9ed)=>{const _0x139a18=_0x5b48b9;try{const {gatewayId:_0xcec07e}=_0x30f09f[_0x139a18(0x171)];console[_0x139a18(0x17b)](_0x139a18(0x1ca)+_0xcec07e);const {GATEWAY_ID_MAP:_0x4fc30e}=await Promise[_0x139a18(0x197)]()[_0x139a18(0x1cf)](()=>__importStar(require(_0x139a18(0x1ef)))),_0x597b39=_0x4fc30e[_0xcec07e];console[_0x139a18(0x17b)]('üìä\x20[GATEWAY\x20STATS]\x20Gateway\x20ID\x20'+_0xcec07e+_0x139a18(0x191)+_0x597b39);if(!_0x597b39)return console[_0x139a18(0x17b)](_0x139a18(0x1bf)+_0xcec07e),_0x1c0007[_0x139a18(0x212)](0x194)[_0x139a18(0x193)]({'success':![],'message':_0x139a18(0x17e)});console[_0x139a18(0x17b)](_0x139a18(0x1c1)+_0x597b39+'\x22\x20and\x20status=\x22PAID\x22');const _0xc9680b=await database_1[_0x139a18(0x218)]['payment'][_0x139a18(0x169)]({'where':{'gateway':_0x597b39},'select':{'id':!![],'status':!![],'amountUSDT':!![]},'take':0x5});console['log'](_0x139a18(0x1e8)+_0x597b39+':',JSON[_0x139a18(0x1a0)](_0xc9680b,null,0x2));const _0x17dd42=await database_1[_0x139a18(0x218)][_0x139a18(0x186)][_0x139a18(0x169)]({'where':{'gateway':_0x597b39,'status':_0x139a18(0x174)},'select':{'amountUSDT':!![]}});console[_0x139a18(0x17b)](_0x139a18(0x1e7)+_0x17dd42[_0x139a18(0x1bd)]+_0x139a18(0x210)+_0x597b39);const _0x2be016=await database_1[_0x139a18(0x218)][_0x139a18(0x186)]['count']({'where':{'gateway':_0x597b39,'status':_0x139a18(0x174)}}),_0x51e20f=await database_1['default']['payment'][_0x139a18(0x18d)]({'where':{'gateway':_0x597b39,'status':_0x139a18(0x1c9)}});console['log'](_0x139a18(0x1f2)+_0x51e20f);const _0x522c60=await database_1['default']['payment'][_0x139a18(0x18d)]({'where':{'gateway':_0x597b39,'status':_0x139a18(0x1e3)}});console[_0x139a18(0x17b)](_0x139a18(0x172)+_0x522c60);const {gatewaySettingsService:_0x42cc20}=await Promise['resolve']()['then'](()=>__importStar(require(_0x139a18(0x1a2)))),_0x2ab268=_0x42cc20[_0x139a18(0x15d)](_0xcec07e),_0x4aed55=_0x2ab268?.[_0x139a18(0x181)]||0x0;console[_0x139a18(0x17b)](_0x139a18(0x1a1)+_0x4aed55+'%');let _0x246a73=0x0,_0x3029d3=0x0;_0x17dd42[_0x139a18(0x211)](_0x49f551=>{const _0x486c57=_0x139a18,_0x3acc68=_0x49f551[_0x486c57(0x160)]||0x0;_0x246a73+=_0x3acc68;const _0x8867f5=_0x3acc68*(_0x4aed55/0x64);_0x3029d3+=_0x8867f5;});const _0xdba101=_0x2be016,_0x920e52=_0xdba101>0x0?_0x51e20f/_0xdba101*0x64:0x0;console[_0x139a18(0x17b)](_0x139a18(0x173)),console[_0x139a18(0x17b)](_0x139a18(0x1a5)+_0x246a73),console['log']('\x20\x20\x20-\x20Total\x20Commission:\x20'+_0x3029d3),console[_0x139a18(0x17b)](_0x139a18(0x1aa)+_0xdba101),console[_0x139a18(0x17b)](_0x139a18(0x1be)+_0x920e52+'%'),_0x1c0007[_0x139a18(0x193)]({'success':!![],'result':{'gatewayId':_0xcec07e,'totalTurnover':Number(_0x246a73['toFixed'](0x2)),'totalCommission':Number(_0x3029d3[_0x139a18(0x1b2)](0x2)),'successfulPayments':_0xdba101,'chargebackCount':_0x51e20f,'chargebackRate':Number(_0x920e52['toFixed'](0x2)),'refundCount':_0x522c60}});}catch(_0x330e5c){console['error']('‚ùå\x20[GATEWAY\x20STATS]\x20Error:',_0x330e5c),_0x3db9ed(_0x330e5c);}},this[_0x5b48b9(0x15f)]=new adminService_1[(_0x5b48b9(0x1fe))](),this['paymentLinkService']=new paymentLinkService_1['PaymentLinkService']();}}exports[a4_0x54a921(0x1c6)]=AdminController;