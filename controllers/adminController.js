'use strict';const a3_0x44d6f4=a3_0x5671;(function(_0x1bd71f,_0x4b3721){const _0x27ba4b=a3_0x5671,_0x1a81b0=_0x1bd71f();while(!![]){try{const _0x5bc185=parseInt(_0x27ba4b(0x138))/0x1+parseInt(_0x27ba4b(0x12b))/0x2+-parseInt(_0x27ba4b(0x156))/0x3*(parseInt(_0x27ba4b(0x13e))/0x4)+-parseInt(_0x27ba4b(0x139))/0x5*(-parseInt(_0x27ba4b(0x13f))/0x6)+-parseInt(_0x27ba4b(0x149))/0x7+-parseInt(_0x27ba4b(0x126))/0x8*(parseInt(_0x27ba4b(0x135))/0x9)+parseInt(_0x27ba4b(0x132))/0xa*(parseInt(_0x27ba4b(0x14c))/0xb);if(_0x5bc185===_0x4b3721)break;else _0x1a81b0['push'](_0x1a81b0['shift']());}catch(_0xd84bfe){_0x1a81b0['push'](_0x1a81b0['shift']());}}}(a3_0x4e70,0xdba2c));function a3_0x5671(_0x24f512,_0x414c74){const _0x4e705e=a3_0x4e70();return a3_0x5671=function(_0x5671de,_0x33a8d7){_0x5671de=_0x5671de-0x11c;let _0x20fca4=_0x4e705e[_0x5671de];return _0x20fca4;},a3_0x5671(_0x24f512,_0x414c74);}Object[a3_0x44d6f4(0x14a)](exports,'__esModule',{'value':!![]}),exports[a3_0x44d6f4(0x15b)]=void 0x0;function a3_0x4e70(){const _0x472990=['updatePaymentStatus','30d','username','merchants','50QjjhOJ','user','telegramBotService','9npvXTn','adminService','getPayoutStats','602053wsTMIz','1184065uixZEH','createPayout','updatePayment','createUser','updateUser','3238564CsjBxj','12oHtlbp','Payment\x20not\x20found','getPayoutById','getStatistics','PAID','getAllPayments','role','sendPaymentNotification','Payment\x20updated\x20successfully','processing','9081100gsDqst','defineProperty','Admin\x20access\x20confirmed','1518539KMirSv','Customer\x20data\x20updated\x20successfully','REFUND','body','getUserById','\x20to\x20PAID,\x20updating\x20payment\x20link\x20counter','getPaymentById','../services/adminService','payouts','\x20status\x20changed\x20from\x20','3RPYpls','Payout\x20not\x20found','json','query','\x20to\x20','AdminController','log','ðŸ“±\x20Skipping\x20Telegram\x20notification\x20for\x20status\x20change\x20to:\x20','getAllUsers','refund','suspendUser','params','checkAuth',',\x20sending\x20Telegram\x20notification','status','PROCESSING','FAILED','User\x20not\x20found','expired','CHARGEBACK','toUpperCase','getMerchantsSelection','chargeback','User\x20created\x20successfully','PaymentLinkService','failed','../services/telegramBotService','getSystemStatistics','deletePayout','getAllPayouts','User\x20activated\x20successfully','User\x20suspended\x20successfully','getMerchantsAwaitingPayout','User\x20updated\x20successfully','updateCustomerData','getUsers','Payout\x20created\x20successfully','pagination','User\x20deleted\x20successfully','handleSuccessfulPayment','activateUser','paymentLinkService','month','getMerchantStatistics','summary','Payout\x20deleted\x20successfully','3348824JWKrPz','payments','error','deleteUser','\x20->\x20','3318496WtUAhW','shopId','../services/paymentLinkService'];a3_0x4e70=function(){return _0x472990;};return a3_0x4e70();}const adminService_1=require(a3_0x44d6f4(0x153)),paymentLinkService_1=require(a3_0x44d6f4(0x12d)),telegramBotService_1=require(a3_0x44d6f4(0x170));class AdminController{constructor(){const _0x258be8=a3_0x44d6f4;this[_0x258be8(0x162)]=async(_0x12fecc,_0x167292,_0x54b592)=>{const _0x4acba7=_0x258be8;try{const _0x4c4e42=_0x12fecc[_0x4acba7(0x133)];_0x167292[_0x4acba7(0x158)]({'success':!![],'message':_0x4acba7(0x14b),'user':{'id':_0x4c4e42?.['id'],'username':_0x4c4e42?.[_0x4acba7(0x130)],'role':_0x4c4e42?.[_0x4acba7(0x145)]}});}catch(_0x5f5d2f){_0x54b592(_0x5f5d2f);}},this[_0x258be8(0x142)]=async(_0x28a595,_0x3571bf,_0x4f3858)=>{const _0x250b1d=_0x258be8;try{const {period:period=_0x250b1d(0x12f)}=_0x28a595[_0x250b1d(0x159)],_0x554c3e=await this[_0x250b1d(0x136)][_0x250b1d(0x171)](period);_0x3571bf[_0x250b1d(0x158)]({'success':!![],'result':_0x554c3e});}catch(_0x14d007){_0x4f3858(_0x14d007);}},this[_0x258be8(0x123)]=async(_0x2772d0,_0x5487db,_0x1f5e3d)=>{const _0x1b848c=_0x258be8;try{const {shopId:_0x32b898,period:period=_0x1b848c(0x122),dateFrom:_0x116568,dateTo:_0x48c96d}=_0x2772d0['query'],_0x5376c5={'shopId':_0x32b898,'period':period,'dateFrom':_0x116568,'dateTo':_0x48c96d};console['log']('ðŸ“Š\x20Admin\x20requesting\x20merchant\x20statistics\x20with\x20filters:',_0x5376c5);const _0x887feb=await this[_0x1b848c(0x136)][_0x1b848c(0x123)](_0x5376c5);_0x5487db[_0x1b848c(0x158)]({'success':!![],'result':_0x887feb});}catch(_0xbf4397){_0x1f5e3d(_0xbf4397);}},this['getPayoutStats']=async(_0x184e15,_0x2f4028,_0x439365)=>{const _0x3d1c35=_0x258be8;try{const _0x425bc4=await this[_0x3d1c35(0x136)][_0x3d1c35(0x137)]();_0x2f4028['json']({'success':!![],'result':_0x425bc4});}catch(_0x55c380){_0x439365(_0x55c380);}},this[_0x258be8(0x176)]=async(_0x1d8d5b,_0x329487,_0x16319f)=>{const _0xc0d8e4=_0x258be8;try{const {page:page=0x1,limit:limit=0x14,minAmount:_0x2ebfa5,search:_0x7a9aed}=_0x1d8d5b[_0xc0d8e4(0x159)],_0x237d59={'page':Number(page),'limit':Number(limit),'minAmount':_0x2ebfa5?Number(_0x2ebfa5):undefined,'search':_0x7a9aed},_0x5540ed=await this[_0xc0d8e4(0x136)]['getMerchantsAwaitingPayout'](_0x237d59);_0x329487[_0xc0d8e4(0x158)]({'success':!![],'merchants':_0x5540ed[_0xc0d8e4(0x131)],'pagination':_0x5540ed[_0xc0d8e4(0x11d)],'summary':_0x5540ed[_0xc0d8e4(0x124)]});}catch(_0x469de7){_0x16319f(_0x469de7);}},this[_0x258be8(0x16b)]=async(_0x5317b3,_0x14ac7e,_0x4721d8)=>{const _0x4abbbe=_0x258be8;try{const _0x27e597=await this[_0x4abbbe(0x136)][_0x4abbbe(0x16b)]();_0x14ac7e['json']({'success':!![],'result':_0x27e597});}catch(_0x21e7fc){_0x4721d8(_0x21e7fc);}},this[_0x258be8(0x13a)]=async(_0x1d614d,_0x4113f6,_0x2c7503)=>{const _0xc09413=_0x258be8;try{const _0x25fd11=_0x1d614d[_0xc09413(0x14f)],_0xdc3474=await this[_0xc09413(0x136)][_0xc09413(0x13a)](_0x25fd11);_0x4113f6['status'](0xc9)[_0xc09413(0x158)]({'success':!![],'message':_0xc09413(0x11c),'result':_0xdc3474});}catch(_0x32c975){_0x2c7503(_0x32c975);}},this['getPayouts']=async(_0xba014e,_0x5a7c8d,_0x2c68b1)=>{const _0x55d7ae=_0x258be8;try{const {page:page=0x1,limit:limit=0x14,shopId:_0x5304c1,network:_0x28e39e,dateFrom:_0x3956d1,dateTo:_0x58b534,search:_0x5ebfa3}=_0xba014e[_0x55d7ae(0x159)],_0x2702f7={'page':Number(page),'limit':Number(limit),'shopId':_0x5304c1,'network':_0x28e39e,'dateFrom':_0x3956d1,'dateTo':_0x58b534,'search':_0x5ebfa3},_0x42e5a2=await this[_0x55d7ae(0x136)][_0x55d7ae(0x173)](_0x2702f7);_0x5a7c8d[_0x55d7ae(0x158)]({'success':!![],'payouts':_0x42e5a2[_0x55d7ae(0x154)],'pagination':_0x42e5a2[_0x55d7ae(0x11d)]});}catch(_0x3974cc){_0x2c68b1(_0x3974cc);}},this['getPayoutById']=async(_0x3e0bb5,_0x43b480,_0x21a63e)=>{const _0x5d17ea=_0x258be8;try{const {id:_0x259704}=_0x3e0bb5[_0x5d17ea(0x161)],_0x2fd663=await this[_0x5d17ea(0x136)][_0x5d17ea(0x141)](_0x259704);if(!_0x2fd663)return _0x43b480['status'](0x194)['json']({'success':![],'message':_0x5d17ea(0x157)});_0x43b480['json']({'success':!![],'result':_0x2fd663});}catch(_0x168213){_0x21a63e(_0x168213);}},this['deletePayout']=async(_0x565816,_0x5f1122,_0x25f3f6)=>{const _0x327c49=_0x258be8;try{const {id:_0x19df25}=_0x565816['params'];await this[_0x327c49(0x136)][_0x327c49(0x172)](_0x19df25),_0x5f1122[_0x327c49(0x158)]({'success':!![],'message':_0x327c49(0x125)});}catch(_0x254236){_0x25f3f6(_0x254236);}},this['getPayments']=async(_0x1a8b39,_0x56a112,_0x45644a)=>{const _0x4be8a2=_0x258be8;try{const {page:page=0x1,limit:limit=0x14,status:_0x386de2,gateway:_0x211da4,shopId:_0x4de110,dateFrom:_0x190932,dateTo:_0x23e291,search:_0x24cc28,currency:_0x45caea,sortBy:_0x33facf,sortOrder:_0x33d3aa}=_0x1a8b39[_0x4be8a2(0x159)],_0xc85a72={'page':Number(page),'limit':Number(limit),'status':_0x386de2,'gateway':_0x211da4,'shopId':_0x4de110,'dateFrom':_0x190932,'dateTo':_0x23e291,'search':_0x24cc28,'currency':_0x45caea,'sortBy':_0x33facf,'sortOrder':_0x33d3aa},_0x56f094=await this['adminService'][_0x4be8a2(0x144)](_0xc85a72);_0x56a112[_0x4be8a2(0x158)]({'success':!![],'payments':_0x56f094[_0x4be8a2(0x127)],'pagination':_0x56f094[_0x4be8a2(0x11d)]});}catch(_0x371f95){_0x45644a(_0x371f95);}},this[_0x258be8(0x152)]=async(_0x451c09,_0x386e87,_0x5b1a67)=>{const _0x1a20e3=_0x258be8;try{const {id:_0x4f44fd}=_0x451c09['params'],_0x33e9d0=await this['adminService'][_0x1a20e3(0x152)](_0x4f44fd);if(!_0x33e9d0)return _0x386e87['status'](0x194)['json']({'success':![],'message':_0x1a20e3(0x140)});_0x386e87['json']({'success':!![],'result':_0x33e9d0});}catch(_0x124ee3){_0x5b1a67(_0x124ee3);}},this[_0x258be8(0x13b)]=async(_0x4f17d5,_0x2bed0c,_0x5e1122)=>{const _0x5836dc=_0x258be8;try{const {id:_0x48ff7e}=_0x4f17d5['params'],{status:_0x35a878,notes:_0x1bb0d1,chargebackAmount:_0x49d01c}=_0x4f17d5[_0x5836dc(0x14f)],_0x26e018=await this[_0x5836dc(0x136)][_0x5836dc(0x152)](_0x48ff7e);if(!_0x26e018)return _0x2bed0c[_0x5836dc(0x164)](0x194)[_0x5836dc(0x158)]({'success':![],'message':_0x5836dc(0x140)});const _0x31e180=await this[_0x5836dc(0x136)][_0x5836dc(0x12e)](_0x48ff7e,_0x35a878,_0x1bb0d1,_0x49d01c);if(_0x26e018['status']!==_0x35a878&&_0x35a878[_0x5836dc(0x16a)]()==='PAID'){console['log']('ðŸ“ˆ\x20Admin\x20changed\x20payment\x20'+_0x48ff7e+_0x5836dc(0x151));try{await this[_0x5836dc(0x121)][_0x5836dc(0x11f)](_0x48ff7e),console[_0x5836dc(0x15c)]('âœ…\x20Payment\x20link\x20counter\x20updated\x20for\x20payment\x20'+_0x48ff7e);}catch(_0x10687b){console['error']('Failed\x20to\x20update\x20payment\x20link\x20counter:',_0x10687b);}}if(_0x26e018[_0x5836dc(0x164)]!==_0x35a878){console[_0x5836dc(0x15c)]('ðŸ“±\x20Payment\x20'+_0x48ff7e+_0x5836dc(0x155)+_0x26e018[_0x5836dc(0x164)]+_0x5836dc(0x15a)+_0x35a878+_0x5836dc(0x163));try{let _0x2352cb;switch(_0x35a878[_0x5836dc(0x16a)]()){case _0x5836dc(0x143):_0x2352cb='paid';break;case _0x5836dc(0x165):_0x2352cb=_0x5836dc(0x148);break;case _0x5836dc(0x166):_0x2352cb=_0x5836dc(0x16f);break;case'EXPIRED':_0x2352cb=_0x5836dc(0x168);break;case _0x5836dc(0x14e):_0x2352cb=_0x5836dc(0x15f);break;case _0x5836dc(0x169):_0x2352cb=_0x5836dc(0x16c);break;default:console['log'](_0x5836dc(0x15d)+_0x35a878);break;}if(_0x2352cb){const _0x4cf65c={..._0x31e180,'shopId':_0x26e018[_0x5836dc(0x12c)],'gateway':_0x26e018['gateway'],'createdAt':_0x26e018['createdAt'],'chargebackAmount':_0x49d01c};await telegramBotService_1[_0x5836dc(0x134)][_0x5836dc(0x146)](_0x26e018['shopId'],_0x4cf65c,_0x2352cb),console['log']('âœ…\x20Telegram\x20notification\x20sent\x20for\x20status\x20change:\x20'+_0x26e018[_0x5836dc(0x164)]+_0x5836dc(0x12a)+_0x35a878);}}catch(_0x250ff3){console[_0x5836dc(0x128)]('Failed\x20to\x20send\x20Telegram\x20notification\x20for\x20status\x20change:',_0x250ff3);}}_0x2bed0c[_0x5836dc(0x158)]({'success':!![],'message':_0x5836dc(0x147),'result':_0x31e180});}catch(_0x5e7480){_0x5e1122(_0x5e7480);}},this['updateCustomerData']=async(_0x21648d,_0x344f27,_0x5805c8)=>{const _0x4d1e68=_0x258be8;try{const {id:_0x1c27bc}=_0x21648d['params'],_0x4868c9=_0x21648d['body'];console[_0x4d1e68(0x15c)]('ðŸ”„\x20Admin\x20updating\x20customer\x20data\x20for\x20payment\x20'+_0x1c27bc+':',_0x4868c9);const _0xbdaf0d=await this[_0x4d1e68(0x136)][_0x4d1e68(0x178)](_0x1c27bc,_0x4868c9);_0x344f27['json']({'success':!![],'message':_0x4d1e68(0x14d),'result':_0xbdaf0d});}catch(_0x50eb2e){_0x5805c8(_0x50eb2e);}},this[_0x258be8(0x13d)]=async(_0x5ea52c,_0x414ca2,_0x4c1ba8)=>{const _0x5edea5=_0x258be8;try{const {id:_0x57a157}=_0x5ea52c[_0x5edea5(0x161)],_0x233eb8=_0x5ea52c[_0x5edea5(0x14f)],_0xfe3676=await this['adminService'][_0x5edea5(0x13d)](_0x57a157,_0x233eb8);_0x414ca2[_0x5edea5(0x158)]({'success':!![],'message':_0x5edea5(0x177),'result':_0xfe3676});}catch(_0x45d7c3){_0x4c1ba8(_0x45d7c3);}},this[_0x258be8(0x160)]=async(_0x38aba4,_0x5d7b69,_0x2db4d3)=>{const _0x527559=_0x258be8;try{const {id:_0x35ae30}=_0x38aba4['params'],_0x57f040=await this[_0x527559(0x136)][_0x527559(0x160)](_0x35ae30);_0x5d7b69[_0x527559(0x158)]({'success':!![],'message':_0x527559(0x175),'result':_0x57f040});}catch(_0x4ee4b7){_0x2db4d3(_0x4ee4b7);}},this[_0x258be8(0x120)]=async(_0x5750d8,_0x31bd87,_0x1ee7dd)=>{const _0x345ff7=_0x258be8;try{const {id:_0x2177e0}=_0x5750d8['params'],_0x4603bd=await this[_0x345ff7(0x136)][_0x345ff7(0x120)](_0x2177e0);_0x31bd87[_0x345ff7(0x158)]({'success':!![],'message':_0x345ff7(0x174),'result':_0x4603bd});}catch(_0x20cdbc){_0x1ee7dd(_0x20cdbc);}},this[_0x258be8(0x179)]=async(_0x2311fc,_0x6da94d,_0x43dcb7)=>{const _0x5507ab=_0x258be8;try{const {page:page=0x1,limit:limit=0x14,status:_0x2b5bf2}=_0x2311fc['query'],_0x4d3782={'page':Number(page),'limit':Number(limit),'status':_0x2b5bf2},_0x15942d=await this[_0x5507ab(0x136)][_0x5507ab(0x15e)](_0x4d3782);_0x6da94d[_0x5507ab(0x158)]({'success':!![],'users':_0x15942d['users'],'pagination':_0x15942d['pagination']});}catch(_0x13a845){_0x43dcb7(_0x13a845);}},this['getUserById']=async(_0x2e75a1,_0x1329d3,_0x1de244)=>{const _0x31d35d=_0x258be8;try{const {id:_0x166761}=_0x2e75a1[_0x31d35d(0x161)],_0x104c17=await this[_0x31d35d(0x136)][_0x31d35d(0x150)](_0x166761);if(!_0x104c17)return _0x1329d3[_0x31d35d(0x164)](0x194)[_0x31d35d(0x158)]({'success':![],'message':_0x31d35d(0x167)});_0x1329d3['json']({'success':!![],'result':_0x104c17});}catch(_0x45a67c){_0x1de244(_0x45a67c);}},this[_0x258be8(0x13c)]=async(_0xdc9d1c,_0x449156,_0x544e63)=>{const _0x47f07f=_0x258be8;try{const _0x590cea=_0xdc9d1c[_0x47f07f(0x14f)],_0x11b1e0=await this[_0x47f07f(0x136)][_0x47f07f(0x13c)](_0x590cea);_0x449156[_0x47f07f(0x164)](0xc9)['json']({'success':!![],'message':_0x47f07f(0x16d),'result':_0x11b1e0});}catch(_0x149135){_0x544e63(_0x149135);}},this[_0x258be8(0x129)]=async(_0x4c7d2e,_0x3f217e,_0x4c16a5)=>{const _0x4186b5=_0x258be8;try{const {id:_0x2e9da9}=_0x4c7d2e[_0x4186b5(0x161)];await this['adminService']['deleteUser'](_0x2e9da9),_0x3f217e[_0x4186b5(0x158)]({'success':!![],'message':_0x4186b5(0x11e)});}catch(_0x5b3959){_0x4c16a5(_0x5b3959);}},this['adminService']=new adminService_1['AdminService'](),this['paymentLinkService']=new paymentLinkService_1[(_0x258be8(0x16e))]();}}exports[a3_0x44d6f4(0x15b)]=AdminController;