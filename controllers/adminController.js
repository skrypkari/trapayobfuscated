'use strict';function a3_0x3667(){const _0x528a29=['__esModule','json','getAllPayments','REFUND','shopId','\x20to\x20','getPayoutStats','query','4877035YTnjbD','FAILED','defineProperty','users','refund','updatePayment','telegramBotService','60LJiPxT','updatePaymentStatus','506387txnhFU','AdminService','expired','payouts','Payment\x20updated\x20successfully','AdminController','getMerchantsAwaitingPayout','PAID','deletePayout','getUserById','4959690ROtmrd','964336YmHYQI','1352CUBLdq','getAllUsers','User\x20not\x20found','chargeback','Payout\x20not\x20found','Failed\x20to\x20send\x20Telegram\x20notification\x20for\x20admin\x20status\x20change:','deleteUser','📱\x20Skipping\x20Telegram\x20notification\x20for\x20admin\x20status\x20change\x20to:\x20','User\x20deleted\x20successfully','1196hvvoqR','body','failed','User\x20created\x20successfully','User\x20suspended\x20successfully','29061bgdWud','EXPIRED','\x20->\x20','\x20status\x20from\x20','getPayoutById','✅\x20Telegram\x20notification\x20sent\x20for\x20admin\x20status\x20change:\x20','paid','CHARGEBACK','log','params','checkAuth','../services/telegramBotService','activateUser','User\x20activated\x20successfully','summary','adminService','createPayout','30d','Admin\x20access\x20confirmed',',\x20sending\x20Telegram\x20notification','978700EwHTxr','updateUser','Payment\x20not\x20found','Payout\x20created\x20successfully','getSystemStatistics','createUser','8754VYIZxN','getStatistics','status','error','Статус\x20изменен\x20администратором\x20на\x20','gateway','getUsers','pagination','sendPaymentNotification','getPaymentById'];a3_0x3667=function(){return _0x528a29;};return a3_0x3667();}const a3_0x4bf18f=a3_0x13f5;(function(_0x2ea817,_0x2f49d5){const _0x4a843a=a3_0x13f5,_0x21fa4f=_0x2ea817();while(!![]){try{const _0x329bbd=parseInt(_0x4a843a(0x190))/0x1+parseInt(_0x4a843a(0x16d))/0x2+parseInt(_0x4a843a(0x147))/0x3*(parseInt(_0x4a843a(0x177))/0x4)+-parseInt(_0x4a843a(0x159))/0x5+-parseInt(_0x4a843a(0x160))/0x6*(parseInt(_0x4a843a(0x162))/0x7)+-parseInt(_0x4a843a(0x16e))/0x8*(parseInt(_0x4a843a(0x17c))/0x9)+parseInt(_0x4a843a(0x16c))/0xa;if(_0x329bbd===_0x2f49d5)break;else _0x21fa4f['push'](_0x21fa4f['shift']());}catch(_0x54715e){_0x21fa4f['push'](_0x21fa4f['shift']());}}}(a3_0x3667,0x8ec61));Object[a3_0x4bf18f(0x15b)](exports,a3_0x4bf18f(0x151),{'value':!![]}),exports[a3_0x4bf18f(0x167)]=void 0x0;const adminService_1=require('../services/adminService'),telegramBotService_1=require(a3_0x4bf18f(0x187));class AdminController{constructor(){const _0x2ef959=a3_0x4bf18f;this[_0x2ef959(0x186)]=async(_0x49b2ea,_0x3729f5,_0x2257a6)=>{const _0xcfbdf5=_0x2ef959;try{const _0x1db59c=_0x49b2ea['user'];_0x3729f5[_0xcfbdf5(0x152)]({'success':!![],'message':_0xcfbdf5(0x18e),'user':{'id':_0x1db59c?.['id'],'username':_0x1db59c?.['username'],'role':_0x1db59c?.['role']}});}catch(_0x312f3f){_0x2257a6(_0x312f3f);}},this[_0x2ef959(0x148)]=async(_0x4bb7c6,_0x40b27c,_0x5eae13)=>{const _0x202e5b=_0x2ef959;try{const {period:period=_0x202e5b(0x18d)}=_0x4bb7c6['query'],_0x33e4b4=await this[_0x202e5b(0x18b)][_0x202e5b(0x145)](period);_0x40b27c[_0x202e5b(0x152)]({'success':!![],'result':_0x33e4b4});}catch(_0x3db75c){_0x5eae13(_0x3db75c);}},this[_0x2ef959(0x157)]=async(_0x1d6b9e,_0x313631,_0x3acc29)=>{const _0x5d57d4=_0x2ef959;try{const _0x5042cf=await this[_0x5d57d4(0x18b)][_0x5d57d4(0x157)]();_0x313631['json']({'success':!![],'result':_0x5042cf});}catch(_0x34ef29){_0x3acc29(_0x34ef29);}},this['getMerchantsAwaitingPayout']=async(_0x716f40,_0x528ad6,_0x3d1e3c)=>{const _0xfdcc5b=_0x2ef959;try{const {page:page=0x1,limit:limit=0x14,minAmount:_0x30c73c,search:_0x124b7a}=_0x716f40[_0xfdcc5b(0x158)],_0x417701={'page':Number(page),'limit':Number(limit),'minAmount':_0x30c73c?Number(_0x30c73c):undefined,'search':_0x124b7a},_0x1e3760=await this['adminService'][_0xfdcc5b(0x168)](_0x417701);_0x528ad6['json']({'success':!![],'merchants':_0x1e3760['merchants'],'pagination':_0x1e3760[_0xfdcc5b(0x14e)],'summary':_0x1e3760[_0xfdcc5b(0x18a)]});}catch(_0x5d69e7){_0x3d1e3c(_0x5d69e7);}},this[_0x2ef959(0x18c)]=async(_0x18cfa5,_0x5ed581,_0x142f2a)=>{const _0x4acbe0=_0x2ef959;try{const _0x304434=_0x18cfa5[_0x4acbe0(0x178)],_0x2a92cd=await this[_0x4acbe0(0x18b)][_0x4acbe0(0x18c)](_0x304434);_0x5ed581[_0x4acbe0(0x149)](0xc9)[_0x4acbe0(0x152)]({'success':!![],'message':_0x4acbe0(0x144),'result':_0x2a92cd});}catch(_0x3253e4){_0x142f2a(_0x3253e4);}},this['getPayouts']=async(_0x5a3f90,_0x4d6d24,_0xc2818b)=>{const _0x6fb529=_0x2ef959;try{const {page:page=0x1,limit:limit=0x14,shopId:_0x3d4161,network:_0x5a3c90,dateFrom:_0x26bd4e,dateTo:_0x7360cb,search:_0x5673a1}=_0x5a3f90[_0x6fb529(0x158)],_0x200f4c={'page':Number(page),'limit':Number(limit),'shopId':_0x3d4161,'network':_0x5a3c90,'dateFrom':_0x26bd4e,'dateTo':_0x7360cb,'search':_0x5673a1},_0xf6677c=await this['adminService']['getAllPayouts'](_0x200f4c);_0x4d6d24[_0x6fb529(0x152)]({'success':!![],'payouts':_0xf6677c[_0x6fb529(0x165)],'pagination':_0xf6677c[_0x6fb529(0x14e)]});}catch(_0x5ec052){_0xc2818b(_0x5ec052);}},this[_0x2ef959(0x180)]=async(_0x3f78f8,_0x447503,_0x3a5f9f)=>{const _0x448ac6=_0x2ef959;try{const {id:_0x46be2f}=_0x3f78f8['params'],_0x3e1cd2=await this[_0x448ac6(0x18b)]['getPayoutById'](_0x46be2f);if(!_0x3e1cd2)return _0x447503[_0x448ac6(0x149)](0x194)['json']({'success':![],'message':_0x448ac6(0x172)});_0x447503[_0x448ac6(0x152)]({'success':!![],'result':_0x3e1cd2});}catch(_0x508abc){_0x3a5f9f(_0x508abc);}},this[_0x2ef959(0x16a)]=async(_0x2ef4a6,_0x11030f,_0x3ad68d)=>{const _0x3a6eef=_0x2ef959;try{const {id:_0xf472ae}=_0x2ef4a6['params'];await this[_0x3a6eef(0x18b)]['deletePayout'](_0xf472ae),_0x11030f[_0x3a6eef(0x152)]({'success':!![],'message':'Payout\x20deleted\x20successfully'});}catch(_0x32bbea){_0x3ad68d(_0x32bbea);}},this['getPayments']=async(_0x63dbb0,_0x199968,_0x137b0c)=>{const _0x979016=_0x2ef959;try{const {page:page=0x1,limit:limit=0x14,status:_0x1cfc70,gateway:_0x24ff91,shopId:_0x8f7090,dateFrom:_0x4bb8e6,dateTo:_0x8ac001,search:_0x2c7bd5}=_0x63dbb0[_0x979016(0x158)],_0x3de265={'page':Number(page),'limit':Number(limit),'status':_0x1cfc70,'gateway':_0x24ff91,'shopId':_0x8f7090,'dateFrom':_0x4bb8e6,'dateTo':_0x8ac001,'search':_0x2c7bd5},_0x584943=await this['adminService'][_0x979016(0x153)](_0x3de265);_0x199968['json']({'success':!![],'payments':_0x584943['payments'],'pagination':_0x584943[_0x979016(0x14e)]});}catch(_0x3db9da){_0x137b0c(_0x3db9da);}},this[_0x2ef959(0x150)]=async(_0xdf645e,_0x1b324b,_0x423a43)=>{const _0x737a3=_0x2ef959;try{const {id:_0x2a7f9e}=_0xdf645e[_0x737a3(0x185)],_0x5047bd=await this['adminService'][_0x737a3(0x150)](_0x2a7f9e);if(!_0x5047bd)return _0x1b324b['status'](0x194)[_0x737a3(0x152)]({'success':![],'message':_0x737a3(0x143)});_0x1b324b[_0x737a3(0x152)]({'success':!![],'result':_0x5047bd});}catch(_0x18c75f){_0x423a43(_0x18c75f);}},this[_0x2ef959(0x15e)]=async(_0x46f850,_0x567d98,_0x337c4c)=>{const _0x55cd42=_0x2ef959;try{const {id:_0x706c83}=_0x46f850[_0x55cd42(0x185)],{status:_0x3680ba,notes:_0xf9a5bc,chargebackAmount:_0x2aca71}=_0x46f850[_0x55cd42(0x178)],_0xc482c8=await this[_0x55cd42(0x18b)][_0x55cd42(0x150)](_0x706c83);if(!_0xc482c8)return _0x567d98['status'](0x194)[_0x55cd42(0x152)]({'success':![],'message':_0x55cd42(0x143)});const _0x496bd6=await this['adminService'][_0x55cd42(0x161)](_0x706c83,_0x3680ba,_0xf9a5bc,_0x2aca71);if(_0xc482c8[_0x55cd42(0x149)]!==_0x3680ba){console['log']('📱\x20Admin\x20changed\x20payment\x20'+_0x706c83+_0x55cd42(0x17f)+_0xc482c8[_0x55cd42(0x149)]+_0x55cd42(0x156)+_0x3680ba+_0x55cd42(0x18f));try{let _0x7ee5c1;switch(_0x3680ba['toUpperCase']()){case _0x55cd42(0x169):_0x7ee5c1=_0x55cd42(0x182);break;case _0x55cd42(0x15a):_0x7ee5c1=_0x55cd42(0x179);break;case _0x55cd42(0x17d):_0x7ee5c1=_0x55cd42(0x164);break;case _0x55cd42(0x154):_0x7ee5c1=_0x55cd42(0x15d);break;case _0x55cd42(0x183):_0x7ee5c1=_0x55cd42(0x171);break;default:console['log'](_0x55cd42(0x175)+_0x3680ba);break;}if(_0x7ee5c1){const _0x36b532={..._0x496bd6,'shopId':_0xc482c8['shopId'],'gateway':_0xc482c8[_0x55cd42(0x14c)],'createdAt':_0xc482c8['createdAt'],'adminNotes':_0xf9a5bc||_0x55cd42(0x14b)+_0x3680ba,'chargebackAmount':_0x2aca71};await telegramBotService_1[_0x55cd42(0x15f)][_0x55cd42(0x14f)](_0xc482c8[_0x55cd42(0x155)],_0x36b532,_0x7ee5c1),console[_0x55cd42(0x184)](_0x55cd42(0x181)+_0xc482c8['status']+_0x55cd42(0x17e)+_0x3680ba);}}catch(_0x499c86){console[_0x55cd42(0x14a)](_0x55cd42(0x173),_0x499c86);}}_0x567d98[_0x55cd42(0x152)]({'success':!![],'message':_0x55cd42(0x166),'result':_0x496bd6});}catch(_0x41d3d4){_0x337c4c(_0x41d3d4);}},this['updateUser']=async(_0x1f69fd,_0x3581e5,_0x996f44)=>{const _0x149922=_0x2ef959;try{const {id:_0x3a2981}=_0x1f69fd[_0x149922(0x185)],_0x3aa83d=_0x1f69fd[_0x149922(0x178)],_0x423454=await this[_0x149922(0x18b)][_0x149922(0x142)](_0x3a2981,_0x3aa83d);_0x3581e5[_0x149922(0x152)]({'success':!![],'message':'User\x20updated\x20successfully','result':_0x423454});}catch(_0x37dc72){_0x996f44(_0x37dc72);}},this['suspendUser']=async(_0x47a146,_0x445d04,_0x24efd3)=>{const _0x19e37c=_0x2ef959;try{const {id:_0x56957a}=_0x47a146[_0x19e37c(0x185)],_0x36c7cf=await this['adminService']['suspendUser'](_0x56957a);_0x445d04[_0x19e37c(0x152)]({'success':!![],'message':_0x19e37c(0x17b),'result':_0x36c7cf});}catch(_0x18d10c){_0x24efd3(_0x18d10c);}},this['activateUser']=async(_0x5a573c,_0x347086,_0x2a6c1d)=>{const _0x286c99=_0x2ef959;try{const {id:_0x38cac8}=_0x5a573c['params'],_0x17f451=await this['adminService'][_0x286c99(0x188)](_0x38cac8);_0x347086['json']({'success':!![],'message':_0x286c99(0x189),'result':_0x17f451});}catch(_0x565c9f){_0x2a6c1d(_0x565c9f);}},this[_0x2ef959(0x14d)]=async(_0x97d5ff,_0x1479c2,_0x1e3903)=>{const _0x92f05f=_0x2ef959;try{const {page:page=0x1,limit:limit=0x14,status:_0x5481fb}=_0x97d5ff[_0x92f05f(0x158)],_0x68dbc7={'page':Number(page),'limit':Number(limit),'status':_0x5481fb},_0x3b38d1=await this[_0x92f05f(0x18b)][_0x92f05f(0x16f)](_0x68dbc7);_0x1479c2['json']({'success':!![],'users':_0x3b38d1[_0x92f05f(0x15c)],'pagination':_0x3b38d1[_0x92f05f(0x14e)]});}catch(_0x4e2733){_0x1e3903(_0x4e2733);}},this[_0x2ef959(0x16b)]=async(_0x1c222f,_0x22414d,_0x1bb279)=>{const _0x1d87cf=_0x2ef959;try{const {id:_0x223243}=_0x1c222f[_0x1d87cf(0x185)],_0x45e0ba=await this[_0x1d87cf(0x18b)][_0x1d87cf(0x16b)](_0x223243);if(!_0x45e0ba)return _0x22414d['status'](0x194)[_0x1d87cf(0x152)]({'success':![],'message':_0x1d87cf(0x170)});_0x22414d[_0x1d87cf(0x152)]({'success':!![],'result':_0x45e0ba});}catch(_0x5331e3){_0x1bb279(_0x5331e3);}},this[_0x2ef959(0x146)]=async(_0x412c01,_0x45eed0,_0x243525)=>{const _0x2c83e8=_0x2ef959;try{const _0x4a8a1e=_0x412c01[_0x2c83e8(0x178)],_0x350a89=await this[_0x2c83e8(0x18b)]['createUser'](_0x4a8a1e);_0x45eed0[_0x2c83e8(0x149)](0xc9)[_0x2c83e8(0x152)]({'success':!![],'message':_0x2c83e8(0x17a),'result':_0x350a89});}catch(_0xc02456){_0x243525(_0xc02456);}},this[_0x2ef959(0x174)]=async(_0x197210,_0x248f6e,_0x23e8e4)=>{const _0x52c79d=_0x2ef959;try{const {id:_0x2530cc}=_0x197210[_0x52c79d(0x185)];await this['adminService'][_0x52c79d(0x174)](_0x2530cc),_0x248f6e[_0x52c79d(0x152)]({'success':!![],'message':_0x52c79d(0x176)});}catch(_0x5c0cef){_0x23e8e4(_0x5c0cef);}},this[_0x2ef959(0x18b)]=new adminService_1[(_0x2ef959(0x163))]();}}function a3_0x13f5(_0x102d19,_0x5c8369){const _0x36672f=a3_0x3667();return a3_0x13f5=function(_0x13f547,_0x19745e){_0x13f547=_0x13f547-0x142;let _0xe8a310=_0x36672f[_0x13f547];return _0xe8a310;},a3_0x13f5(_0x102d19,_0x5c8369);}exports[a3_0x4bf18f(0x167)]=AdminController;