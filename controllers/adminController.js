'use strict';const a3_0x53b285=a3_0x503e;function a3_0x503e(_0x5907c6,_0x3d9053){const _0x4233c5=a3_0x4233();return a3_0x503e=function(_0x503e02,_0x28394b){_0x503e02=_0x503e02-0x94;let _0x2ca9a3=_0x4233c5[_0x503e02];return _0x2ca9a3;},a3_0x503e(_0x5907c6,_0x3d9053);}function a3_0x4233(){const _0x3bf234=['Failed\x20to\x20send\x20Telegram\x20notification\x20for\x20status\x20change:','shopId','1804614ifZtDv','6183750rsOEia','EXPIRED','CHARGEBACK','getUserById','paid','status','chargeback','pagination','FAILED','3045420aSCVQh','handleSuccessfulPayment','\x20status\x20changed\x20from\x20','2959890lrTKVL','createdAt','gateway','deleteUser','body','151156TGHnBd','âœ…\x20Telegram\x20notification\x20sent\x20for\x20status\x20change:\x20','PROCESSING','2sUytHl','query','refund','updateUser','paymentLinkService','username','payments','Payment\x20updated\x20successfully','getPaymentById','__esModule','getPayoutStats','toUpperCase','1158815ZnqpGI','\x20->\x20','adminService','merchants','deletePayout','summary','ðŸ“±\x20Skipping\x20Telegram\x20notification\x20for\x20status\x20change\x20to:\x20','getPayments','telegramBotService','updatePayment','User\x20created\x20successfully','getMerchantsAwaitingPayout','âœ…\x20Payment\x20link\x20counter\x20updated\x20for\x20payment\x20','params','expired','PaymentLinkService','6SkaGUq','../services/paymentLinkService','User\x20deleted\x20successfully','payouts','User\x20updated\x20successfully','Payout\x20not\x20found','Admin\x20access\x20confirmed','4pjbron','Payment\x20not\x20found','processing','getStatistics','createUser','createPayout','getSystemStatistics','Payout\x20deleted\x20successfully','suspendUser','log','json','User\x20suspended\x20successfully','updatePaymentStatus','5105016LdfYHK','activateUser','REFUND','error','AdminController','User\x20not\x20found'];a3_0x4233=function(){return _0x3bf234;};return a3_0x4233();}(function(_0x589d6e,_0x84cdb5){const _0x1f582e=a3_0x503e,_0x10e33f=_0x589d6e();while(!![]){try{const _0x57e0c5=parseInt(_0x1f582e(0x95))/0x1*(-parseInt(_0x1f582e(0xdf))/0x2)+parseInt(_0x1f582e(0xcd))/0x3+-parseInt(_0x1f582e(0xb8))/0x4*(parseInt(_0x1f582e(0xda))/0x5)+parseInt(_0x1f582e(0xb1))/0x6*(parseInt(_0x1f582e(0xa1))/0x7)+-parseInt(_0x1f582e(0xc5))/0x8+parseInt(_0x1f582e(0xd7))/0x9+parseInt(_0x1f582e(0xce))/0xa;if(_0x57e0c5===_0x84cdb5)break;else _0x10e33f['push'](_0x10e33f['shift']());}catch(_0x13965c){_0x10e33f['push'](_0x10e33f['shift']());}}}(a3_0x4233,0x53a31));Object['defineProperty'](exports,a3_0x53b285(0x9e),{'value':!![]}),exports['AdminController']=void 0x0;const adminService_1=require('../services/adminService'),paymentLinkService_1=require(a3_0x53b285(0xb2)),telegramBotService_1=require('../services/telegramBotService');class AdminController{constructor(){const _0x4e3b7e=a3_0x53b285;this['checkAuth']=async(_0x2b5d37,_0x4c3572,_0x198cb9)=>{const _0x55f15a=a3_0x503e;try{const _0x36d854=_0x2b5d37['user'];_0x4c3572[_0x55f15a(0xc2)]({'success':!![],'message':_0x55f15a(0xb7),'user':{'id':_0x36d854?.['id'],'username':_0x36d854?.[_0x55f15a(0x9a)],'role':_0x36d854?.['role']}});}catch(_0x44c56a){_0x198cb9(_0x44c56a);}},this[_0x4e3b7e(0xbb)]=async(_0x566c9d,_0x133f57,_0x300f93)=>{const _0x23a851=_0x4e3b7e;try{const {period:period='30d'}=_0x566c9d[_0x23a851(0x96)],_0x1e8748=await this['adminService'][_0x23a851(0xbe)](period);_0x133f57['json']({'success':!![],'result':_0x1e8748});}catch(_0x1d53be){_0x300f93(_0x1d53be);}},this[_0x4e3b7e(0x9f)]=async(_0x2514e8,_0x2593d0,_0x4955c5)=>{const _0x3e6686=_0x4e3b7e;try{const _0x51a8e0=await this[_0x3e6686(0xa3)][_0x3e6686(0x9f)]();_0x2593d0[_0x3e6686(0xc2)]({'success':!![],'result':_0x51a8e0});}catch(_0x352260){_0x4955c5(_0x352260);}},this['getMerchantsAwaitingPayout']=async(_0x489fe6,_0x4fd5c3,_0x19f021)=>{const _0x41682e=_0x4e3b7e;try{const {page:page=0x1,limit:limit=0x14,minAmount:_0xb83ea6,search:_0x7746a9}=_0x489fe6[_0x41682e(0x96)],_0x5cef3d={'page':Number(page),'limit':Number(limit),'minAmount':_0xb83ea6?Number(_0xb83ea6):undefined,'search':_0x7746a9},_0x59f99e=await this[_0x41682e(0xa3)][_0x41682e(0xac)](_0x5cef3d);_0x4fd5c3['json']({'success':!![],'merchants':_0x59f99e[_0x41682e(0xa4)],'pagination':_0x59f99e['pagination'],'summary':_0x59f99e[_0x41682e(0xa6)]});}catch(_0x1b89f6){_0x19f021(_0x1b89f6);}},this[_0x4e3b7e(0xbd)]=async(_0x1f4f1f,_0x501d38,_0x469f24)=>{const _0x5c243a=_0x4e3b7e;try{const _0x505e37=_0x1f4f1f[_0x5c243a(0xde)],_0x2c846a=await this['adminService']['createPayout'](_0x505e37);_0x501d38['status'](0xc9)[_0x5c243a(0xc2)]({'success':!![],'message':'Payout\x20created\x20successfully','result':_0x2c846a});}catch(_0x26d579){_0x469f24(_0x26d579);}},this['getPayouts']=async(_0x256dd1,_0x4430cc,_0x10d5bf)=>{const _0x263089=_0x4e3b7e;try{const {page:page=0x1,limit:limit=0x14,shopId:_0x4be66b,network:_0x169e3b,dateFrom:_0x214a3f,dateTo:_0x2f4a77,search:_0x26ba92}=_0x256dd1['query'],_0x30c6be={'page':Number(page),'limit':Number(limit),'shopId':_0x4be66b,'network':_0x169e3b,'dateFrom':_0x214a3f,'dateTo':_0x2f4a77,'search':_0x26ba92},_0x56ccf9=await this[_0x263089(0xa3)]['getAllPayouts'](_0x30c6be);_0x4430cc[_0x263089(0xc2)]({'success':!![],'payouts':_0x56ccf9[_0x263089(0xb4)],'pagination':_0x56ccf9['pagination']});}catch(_0x127e55){_0x10d5bf(_0x127e55);}},this['getPayoutById']=async(_0x1c63b9,_0x32968c,_0x570cb8)=>{const _0x1afd17=_0x4e3b7e;try{const {id:_0x946589}=_0x1c63b9[_0x1afd17(0xae)],_0xa8d316=await this[_0x1afd17(0xa3)]['getPayoutById'](_0x946589);if(!_0xa8d316)return _0x32968c[_0x1afd17(0xd3)](0x194)[_0x1afd17(0xc2)]({'success':![],'message':_0x1afd17(0xb6)});_0x32968c[_0x1afd17(0xc2)]({'success':!![],'result':_0xa8d316});}catch(_0x3e1333){_0x570cb8(_0x3e1333);}},this['deletePayout']=async(_0x4e996d,_0x34ae4f,_0x10724b)=>{const _0x446681=_0x4e3b7e;try{const {id:_0x378754}=_0x4e996d[_0x446681(0xae)];await this[_0x446681(0xa3)][_0x446681(0xa5)](_0x378754),_0x34ae4f[_0x446681(0xc2)]({'success':!![],'message':_0x446681(0xbf)});}catch(_0x4c22ed){_0x10724b(_0x4c22ed);}},this[_0x4e3b7e(0xa8)]=async(_0x2afe36,_0xb61793,_0x49d2bc)=>{const _0x163f6c=_0x4e3b7e;try{const {page:page=0x1,limit:limit=0x14,status:_0x4839a7,gateway:_0x1726b2,shopId:_0x3b680e,dateFrom:_0x2744ea,dateTo:_0x2b205e,search:_0x583e5d}=_0x2afe36[_0x163f6c(0x96)],_0x259667={'page':Number(page),'limit':Number(limit),'status':_0x4839a7,'gateway':_0x1726b2,'shopId':_0x3b680e,'dateFrom':_0x2744ea,'dateTo':_0x2b205e,'search':_0x583e5d},_0x13aef1=await this[_0x163f6c(0xa3)]['getAllPayments'](_0x259667);_0xb61793[_0x163f6c(0xc2)]({'success':!![],'payments':_0x13aef1[_0x163f6c(0x9b)],'pagination':_0x13aef1['pagination']});}catch(_0x1bb375){_0x49d2bc(_0x1bb375);}},this[_0x4e3b7e(0x9d)]=async(_0x5f04b1,_0x160019,_0x4636aa)=>{const _0x5bf18b=_0x4e3b7e;try{const {id:_0x1ff249}=_0x5f04b1[_0x5bf18b(0xae)],_0x4420ce=await this[_0x5bf18b(0xa3)]['getPaymentById'](_0x1ff249);if(!_0x4420ce)return _0x160019[_0x5bf18b(0xd3)](0x194)[_0x5bf18b(0xc2)]({'success':![],'message':_0x5bf18b(0xb9)});_0x160019['json']({'success':!![],'result':_0x4420ce});}catch(_0x307bf4){_0x4636aa(_0x307bf4);}},this[_0x4e3b7e(0xaa)]=async(_0x4894fb,_0x440bd5,_0x154f84)=>{const _0x143eb3=_0x4e3b7e;try{const {id:_0x5407b7}=_0x4894fb[_0x143eb3(0xae)],{status:_0x194b11,notes:_0x86513f,chargebackAmount:_0x237908}=_0x4894fb[_0x143eb3(0xde)],_0x19b106=await this['adminService'][_0x143eb3(0x9d)](_0x5407b7);if(!_0x19b106)return _0x440bd5['status'](0x194)['json']({'success':![],'message':'Payment\x20not\x20found'});const _0x30b93d=await this['adminService'][_0x143eb3(0xc4)](_0x5407b7,_0x194b11,_0x86513f,_0x237908);if(_0x19b106[_0x143eb3(0xd3)]!==_0x194b11&&_0x194b11[_0x143eb3(0xa0)]()==='PAID'){console[_0x143eb3(0xc1)]('ðŸ“ˆ\x20Admin\x20changed\x20payment\x20'+_0x5407b7+'\x20to\x20PAID,\x20updating\x20payment\x20link\x20counter');try{await this[_0x143eb3(0x99)][_0x143eb3(0xd8)](_0x5407b7),console[_0x143eb3(0xc1)](_0x143eb3(0xad)+_0x5407b7);}catch(_0x27bdbd){console[_0x143eb3(0xc8)]('Failed\x20to\x20update\x20payment\x20link\x20counter:',_0x27bdbd);}}if(_0x19b106[_0x143eb3(0xd3)]!==_0x194b11){console[_0x143eb3(0xc1)]('ðŸ“±\x20Payment\x20'+_0x5407b7+_0x143eb3(0xd9)+_0x19b106['status']+'\x20to\x20'+_0x194b11+',\x20sending\x20Telegram\x20notification');try{let _0x1c5783;switch(_0x194b11[_0x143eb3(0xa0)]()){case'PAID':_0x1c5783=_0x143eb3(0xd2);break;case _0x143eb3(0x94):_0x1c5783=_0x143eb3(0xba);break;case _0x143eb3(0xd6):_0x1c5783='failed';break;case _0x143eb3(0xcf):_0x1c5783=_0x143eb3(0xaf);break;case _0x143eb3(0xc7):_0x1c5783=_0x143eb3(0x97);break;case _0x143eb3(0xd0):_0x1c5783=_0x143eb3(0xd4);break;default:console[_0x143eb3(0xc1)](_0x143eb3(0xa7)+_0x194b11);break;}if(_0x1c5783){const _0x1fbab5={..._0x30b93d,'shopId':_0x19b106[_0x143eb3(0xcc)],'gateway':_0x19b106[_0x143eb3(0xdc)],'createdAt':_0x19b106[_0x143eb3(0xdb)],'chargebackAmount':_0x237908};await telegramBotService_1[_0x143eb3(0xa9)]['sendPaymentNotification'](_0x19b106[_0x143eb3(0xcc)],_0x1fbab5,_0x1c5783),console['log'](_0x143eb3(0xe0)+_0x19b106['status']+_0x143eb3(0xa2)+_0x194b11);}}catch(_0x384556){console[_0x143eb3(0xc8)](_0x143eb3(0xcb),_0x384556);}}_0x440bd5[_0x143eb3(0xc2)]({'success':!![],'message':_0x143eb3(0x9c),'result':_0x30b93d});}catch(_0x542863){_0x154f84(_0x542863);}},this[_0x4e3b7e(0x98)]=async(_0x2b8f75,_0x18c7fe,_0x45a871)=>{const _0x2134ca=_0x4e3b7e;try{const {id:_0x36006f}=_0x2b8f75[_0x2134ca(0xae)],_0x4ef66b=_0x2b8f75[_0x2134ca(0xde)],_0xadf591=await this[_0x2134ca(0xa3)][_0x2134ca(0x98)](_0x36006f,_0x4ef66b);_0x18c7fe[_0x2134ca(0xc2)]({'success':!![],'message':_0x2134ca(0xb5),'result':_0xadf591});}catch(_0x4b572f){_0x45a871(_0x4b572f);}},this[_0x4e3b7e(0xc0)]=async(_0x36a582,_0x36f1ee,_0x19e540)=>{const _0x26b79a=_0x4e3b7e;try{const {id:_0x3f7ada}=_0x36a582[_0x26b79a(0xae)],_0x24db68=await this[_0x26b79a(0xa3)]['suspendUser'](_0x3f7ada);_0x36f1ee[_0x26b79a(0xc2)]({'success':!![],'message':_0x26b79a(0xc3),'result':_0x24db68});}catch(_0x598419){_0x19e540(_0x598419);}},this['activateUser']=async(_0x22786,_0x2e2fda,_0x58a7eb)=>{const _0x5a3ce5=_0x4e3b7e;try{const {id:_0x9f7616}=_0x22786['params'],_0x43778d=await this['adminService'][_0x5a3ce5(0xc6)](_0x9f7616);_0x2e2fda[_0x5a3ce5(0xc2)]({'success':!![],'message':'User\x20activated\x20successfully','result':_0x43778d});}catch(_0xcae579){_0x58a7eb(_0xcae579);}},this['getUsers']=async(_0x87ce2d,_0x18b1f6,_0x2d2eaf)=>{const _0xe2da7c=_0x4e3b7e;try{const {page:page=0x1,limit:limit=0x14,status:_0x528799}=_0x87ce2d['query'],_0x28a2cd={'page':Number(page),'limit':Number(limit),'status':_0x528799},_0x5f4e40=await this[_0xe2da7c(0xa3)]['getAllUsers'](_0x28a2cd);_0x18b1f6[_0xe2da7c(0xc2)]({'success':!![],'users':_0x5f4e40['users'],'pagination':_0x5f4e40[_0xe2da7c(0xd5)]});}catch(_0x5ab0ff){_0x2d2eaf(_0x5ab0ff);}},this['getUserById']=async(_0x971de8,_0x217f4,_0x5abd04)=>{const _0x58e270=_0x4e3b7e;try{const {id:_0x39808a}=_0x971de8[_0x58e270(0xae)],_0x35998e=await this[_0x58e270(0xa3)][_0x58e270(0xd1)](_0x39808a);if(!_0x35998e)return _0x217f4['status'](0x194)[_0x58e270(0xc2)]({'success':![],'message':_0x58e270(0xca)});_0x217f4[_0x58e270(0xc2)]({'success':!![],'result':_0x35998e});}catch(_0x295605){_0x5abd04(_0x295605);}},this[_0x4e3b7e(0xbc)]=async(_0x5e56fb,_0x3cfa00,_0x5735fe)=>{const _0xc5c941=_0x4e3b7e;try{const _0xc7b959=_0x5e56fb[_0xc5c941(0xde)],_0x199ee7=await this['adminService'][_0xc5c941(0xbc)](_0xc7b959);_0x3cfa00['status'](0xc9)[_0xc5c941(0xc2)]({'success':!![],'message':_0xc5c941(0xab),'result':_0x199ee7});}catch(_0x191202){_0x5735fe(_0x191202);}},this['deleteUser']=async(_0x5b050e,_0x39effd,_0x22708f)=>{const _0x324bfb=_0x4e3b7e;try{const {id:_0x2b8fb5}=_0x5b050e[_0x324bfb(0xae)];await this[_0x324bfb(0xa3)][_0x324bfb(0xdd)](_0x2b8fb5),_0x39effd['json']({'success':!![],'message':_0x324bfb(0xb3)});}catch(_0x15f228){_0x22708f(_0x15f228);}},this['adminService']=new adminService_1['AdminService'](),this[_0x4e3b7e(0x99)]=new paymentLinkService_1[(_0x4e3b7e(0xb0))]();}}exports[a3_0x53b285(0xc9)]=AdminController;