'use strict';const a3_0x1c1974=a3_0x2344;(function(_0x33fc61,_0x2c5dce){const _0x1540bb=a3_0x2344,_0x5b09fd=_0x33fc61();while(!![]){try{const _0x2d7e59=parseInt(_0x1540bb(0xcb))/0x1+parseInt(_0x1540bb(0xe2))/0x2*(-parseInt(_0x1540bb(0xcd))/0x3)+parseInt(_0x1540bb(0xd6))/0x4+-parseInt(_0x1540bb(0x11a))/0x5+parseInt(_0x1540bb(0xf5))/0x6+parseInt(_0x1540bb(0x121))/0x7*(parseInt(_0x1540bb(0x118))/0x8)+-parseInt(_0x1540bb(0xca))/0x9;if(_0x2d7e59===_0x2c5dce)break;else _0x5b09fd['push'](_0x5b09fd['shift']());}catch(_0x4561b3){_0x5b09fd['push'](_0x5b09fd['shift']());}}}(a3_0x3cb9,0x29fd5));function a3_0x2344(_0x18bbbc,_0x436a51){const _0x3cb982=a3_0x3cb9();return a3_0x2344=function(_0x2344ca,_0x94669d){_0x2344ca=_0x2344ca-0xca;let _0x514a71=_0x3cb982[_0x2344ca];return _0x514a71;},a3_0x2344(_0x18bbbc,_0x436a51);}function a3_0x3cb9(){const _0x3cced6=['getStatistics','Payment\x20not\x20found','Payout\x20deleted\x20successfully','processing','pagination','failed','../services/telegramBotService','ðŸ“Š\x20Admin\x20requesting\x20merchant\x20statistics\x20with\x20filters:','params','ðŸ“±\x20Skipping\x20Telegram\x20notification\x20for\x20status\x20change\x20to:\x20','paid','getPaymentById','users','status','User\x20suspended\x20successfully','\x20status\x20changed\x20from\x20','AdminController','16HVsgIQ','User\x20created\x20successfully','656855sFyxwH','sendPaymentNotification','deleteUser','CHARGEBACK','AdminService','getUserById','getMerchantStatistics','1087919VzxqUW','month','getSystemStatistics','getPayments','âœ…\x20Payment\x20link\x20counter\x20updated\x20for\x20payment\x20',',\x20sending\x20Telegram\x20notification','getAllUsers','2214108mfTLfx','229898vqZPCg','EXPIRED','75jwMXWA','query','checkAuth','createdAt','ðŸ“ˆ\x20Admin\x20changed\x20payment\x20','defineProperty','User\x20activated\x20successfully','User\x20deleted\x20successfully','activateUser','1073812ccflcp','chargeback','createUser','PROCESSING','PAID','handleSuccessfulPayment','updatePayment','Payout\x20not\x20found','payouts','payments','__esModule','getPayoutStats','23112XeIyzn','User\x20updated\x20successfully','ðŸ”„\x20Admin\x20updating\x20customer\x20data\x20for\x20payment\x20','username','\x20to\x20','Failed\x20to\x20send\x20Telegram\x20notification\x20for\x20status\x20change:','updateUser','error','getAllPayments','Customer\x20data\x20updated\x20successfully','getPayoutById','expired','updateCustomerData','gateway','getPayouts','user','Payment\x20updated\x20successfully','FAILED','\x20->\x20','174522mmXLvK','createPayout','30d','deletePayout','toUpperCase','\x20to\x20PAID,\x20updating\x20payment\x20link\x20counter','suspendUser','getMerchantsSelection','shopId','paymentLinkService','json','getAllPayouts','body','adminService','role','telegramBotService','Admin\x20access\x20confirmed','log'];a3_0x3cb9=function(){return _0x3cced6;};return a3_0x3cb9();}Object[a3_0x1c1974(0xd2)](exports,a3_0x1c1974(0xe0),{'value':!![]}),exports['AdminController']=void 0x0;const adminService_1=require('../services/adminService'),paymentLinkService_1=require('../services/paymentLinkService'),telegramBotService_1=require(a3_0x1c1974(0x10d));class AdminController{constructor(){const _0x55cd6c=a3_0x1c1974;this[_0x55cd6c(0xcf)]=async(_0x1c4e9f,_0x182969,_0x8e7f5c)=>{const _0x187928=_0x55cd6c;try{const _0x2dc07b=_0x1c4e9f[_0x187928(0xf1)];_0x182969['json']({'success':!![],'message':_0x187928(0x105),'user':{'id':_0x2dc07b?.['id'],'username':_0x2dc07b?.[_0x187928(0xe5)],'role':_0x2dc07b?.[_0x187928(0x103)]}});}catch(_0x3198d9){_0x8e7f5c(_0x3198d9);}},this[_0x55cd6c(0x107)]=async(_0x2c837b,_0x3afa04,_0x52dbf8)=>{const _0x27301a=_0x55cd6c;try{const {period:period=_0x27301a(0xf7)}=_0x2c837b[_0x27301a(0xce)],_0x587d5f=await this[_0x27301a(0x102)][_0x27301a(0x123)](period);_0x3afa04[_0x27301a(0xff)]({'success':!![],'result':_0x587d5f});}catch(_0x514366){_0x52dbf8(_0x514366);}},this[_0x55cd6c(0x120)]=async(_0x187506,_0x4fc9f8,_0x45cee7)=>{const _0x4c9b06=_0x55cd6c;try{const {shopId:_0xb37eec,period:period=_0x4c9b06(0x122),dateFrom:_0x391af1,dateTo:_0xb3ed51}=_0x187506[_0x4c9b06(0xce)],_0x329270={'shopId':_0xb37eec,'period':period,'dateFrom':_0x391af1,'dateTo':_0xb3ed51};console[_0x4c9b06(0x106)](_0x4c9b06(0x10e),_0x329270);const _0x50eb70=await this[_0x4c9b06(0x102)][_0x4c9b06(0x120)](_0x329270);_0x4fc9f8[_0x4c9b06(0xff)]({'success':!![],'result':_0x50eb70});}catch(_0x101b3e){_0x45cee7(_0x101b3e);}},this[_0x55cd6c(0xe1)]=async(_0x500098,_0x3e8b79,_0x5caa15)=>{const _0x5557a8=_0x55cd6c;try{const _0x389f45=await this[_0x5557a8(0x102)][_0x5557a8(0xe1)]();_0x3e8b79[_0x5557a8(0xff)]({'success':!![],'result':_0x389f45});}catch(_0x3776cc){_0x5caa15(_0x3776cc);}},this['getMerchantsAwaitingPayout']=async(_0x3ec921,_0x26a128,_0x295ee7)=>{const _0x2453ac=_0x55cd6c;try{const {page:page=0x1,limit:limit=0x14,minAmount:_0x3485b8,search:_0x40c94e}=_0x3ec921[_0x2453ac(0xce)],_0x5f02d0={'page':Number(page),'limit':Number(limit),'minAmount':_0x3485b8?Number(_0x3485b8):undefined,'search':_0x40c94e},_0x27cc29=await this[_0x2453ac(0x102)]['getMerchantsAwaitingPayout'](_0x5f02d0);_0x26a128[_0x2453ac(0xff)]({'success':!![],'merchants':_0x27cc29['merchants'],'pagination':_0x27cc29[_0x2453ac(0x10b)],'summary':_0x27cc29['summary']});}catch(_0x200a3f){_0x295ee7(_0x200a3f);}},this['getMerchantsSelection']=async(_0x3b9383,_0x3f9d48,_0x4dc887)=>{const _0x4657c9=_0x55cd6c;try{const _0x11e685=await this[_0x4657c9(0x102)][_0x4657c9(0xfc)]();_0x3f9d48[_0x4657c9(0xff)]({'success':!![],'result':_0x11e685});}catch(_0x5c2155){_0x4dc887(_0x5c2155);}},this[_0x55cd6c(0xf6)]=async(_0x31c8b2,_0x24ced1,_0x51dd89)=>{const _0x307c44=_0x55cd6c;try{const _0x23de31=_0x31c8b2[_0x307c44(0x101)],_0x3ee134=await this[_0x307c44(0x102)]['createPayout'](_0x23de31);_0x24ced1[_0x307c44(0x114)](0xc9)['json']({'success':!![],'message':'Payout\x20created\x20successfully','result':_0x3ee134});}catch(_0x89ecc5){_0x51dd89(_0x89ecc5);}},this[_0x55cd6c(0xf0)]=async(_0x4cb495,_0x163051,_0x11098f)=>{const _0x1355ea=_0x55cd6c;try{const {page:page=0x1,limit:limit=0x14,shopId:_0x3acf6d,network:_0x8d03d8,dateFrom:_0x4d2f64,dateTo:_0x226649,search:_0x3093dd}=_0x4cb495[_0x1355ea(0xce)],_0x36f344={'page':Number(page),'limit':Number(limit),'shopId':_0x3acf6d,'network':_0x8d03d8,'dateFrom':_0x4d2f64,'dateTo':_0x226649,'search':_0x3093dd},_0x476229=await this['adminService'][_0x1355ea(0x100)](_0x36f344);_0x163051['json']({'success':!![],'payouts':_0x476229[_0x1355ea(0xde)],'pagination':_0x476229[_0x1355ea(0x10b)]});}catch(_0xcba2fe){_0x11098f(_0xcba2fe);}},this['getPayoutById']=async(_0x5aaed8,_0x4bb710,_0x18a28c)=>{const _0x35edc7=_0x55cd6c;try{const {id:_0x24e9d6}=_0x5aaed8['params'],_0x43f94d=await this[_0x35edc7(0x102)][_0x35edc7(0xec)](_0x24e9d6);if(!_0x43f94d)return _0x4bb710['status'](0x194)[_0x35edc7(0xff)]({'success':![],'message':_0x35edc7(0xdd)});_0x4bb710['json']({'success':!![],'result':_0x43f94d});}catch(_0x10d45e){_0x18a28c(_0x10d45e);}},this[_0x55cd6c(0xf8)]=async(_0x5c9a65,_0x5506e2,_0x32a50c)=>{const _0xb3b1b4=_0x55cd6c;try{const {id:_0x532c83}=_0x5c9a65['params'];await this[_0xb3b1b4(0x102)][_0xb3b1b4(0xf8)](_0x532c83),_0x5506e2[_0xb3b1b4(0xff)]({'success':!![],'message':_0xb3b1b4(0x109)});}catch(_0x4492c9){_0x32a50c(_0x4492c9);}},this[_0x55cd6c(0x124)]=async(_0x20b076,_0xfbb48e,_0x254772)=>{const _0x5e4948=_0x55cd6c;try{const {page:page=0x1,limit:limit=0x14,status:_0x17fcf3,gateway:_0x3f0da1,shopId:_0x5e7e61,dateFrom:_0x5b052a,dateTo:_0x26a38d,search:_0x50559d,currency:_0x4a3f9f,sortBy:_0x67df71,sortOrder:_0x538c2d}=_0x20b076[_0x5e4948(0xce)],_0x54ea50={'page':Number(page),'limit':Number(limit),'status':_0x17fcf3,'gateway':_0x3f0da1,'shopId':_0x5e7e61,'dateFrom':_0x5b052a,'dateTo':_0x26a38d,'search':_0x50559d,'currency':_0x4a3f9f,'sortBy':_0x67df71,'sortOrder':_0x538c2d},_0x199f0a=await this[_0x5e4948(0x102)][_0x5e4948(0xea)](_0x54ea50);_0xfbb48e['json']({'success':!![],'payments':_0x199f0a[_0x5e4948(0xdf)],'pagination':_0x199f0a[_0x5e4948(0x10b)]});}catch(_0x421b3a){_0x254772(_0x421b3a);}},this[_0x55cd6c(0x112)]=async(_0x179a26,_0x22126d,_0x5e9fe2)=>{const _0x4d820e=_0x55cd6c;try{const {id:_0x3dcccd}=_0x179a26['params'],_0x508672=await this[_0x4d820e(0x102)][_0x4d820e(0x112)](_0x3dcccd);if(!_0x508672)return _0x22126d[_0x4d820e(0x114)](0x194)[_0x4d820e(0xff)]({'success':![],'message':_0x4d820e(0x108)});_0x22126d[_0x4d820e(0xff)]({'success':!![],'result':_0x508672});}catch(_0xfc8d01){_0x5e9fe2(_0xfc8d01);}},this[_0x55cd6c(0xdc)]=async(_0x2e54c8,_0x1a5569,_0x1eb57a)=>{const _0x34bfa2=_0x55cd6c;try{const {id:_0x3b483e}=_0x2e54c8[_0x34bfa2(0x10f)],{status:_0x2ca53d,notes:_0x5bede5,chargebackAmount:_0x27c748}=_0x2e54c8[_0x34bfa2(0x101)],_0x52625c=await this[_0x34bfa2(0x102)][_0x34bfa2(0x112)](_0x3b483e);if(!_0x52625c)return _0x1a5569['status'](0x194)['json']({'success':![],'message':_0x34bfa2(0x108)});const _0x220c07=await this[_0x34bfa2(0x102)]['updatePaymentStatus'](_0x3b483e,_0x2ca53d,_0x5bede5,_0x27c748);if(_0x52625c['status']!==_0x2ca53d&&_0x2ca53d['toUpperCase']()===_0x34bfa2(0xda)){console['log'](_0x34bfa2(0xd1)+_0x3b483e+_0x34bfa2(0xfa));try{await this[_0x34bfa2(0xfe)][_0x34bfa2(0xdb)](_0x3b483e),console['log'](_0x34bfa2(0x125)+_0x3b483e);}catch(_0x236320){console['error']('Failed\x20to\x20update\x20payment\x20link\x20counter:',_0x236320);}}if(_0x52625c[_0x34bfa2(0x114)]!==_0x2ca53d){console['log']('ðŸ“±\x20Payment\x20'+_0x3b483e+_0x34bfa2(0x116)+_0x52625c['status']+_0x34bfa2(0xe6)+_0x2ca53d+_0x34bfa2(0x126));try{let _0x36b0bc;switch(_0x2ca53d[_0x34bfa2(0xf9)]()){case _0x34bfa2(0xda):_0x36b0bc=_0x34bfa2(0x111);break;case _0x34bfa2(0xd9):_0x36b0bc=_0x34bfa2(0x10a);break;case _0x34bfa2(0xf3):_0x36b0bc=_0x34bfa2(0x10c);break;case _0x34bfa2(0xcc):_0x36b0bc=_0x34bfa2(0xed);break;case'REFUND':_0x36b0bc='refund';break;case _0x34bfa2(0x11d):_0x36b0bc=_0x34bfa2(0xd7);break;default:console[_0x34bfa2(0x106)](_0x34bfa2(0x110)+_0x2ca53d);break;}if(_0x36b0bc){const _0x37298d={..._0x220c07,'shopId':_0x52625c['shopId'],'gateway':_0x52625c[_0x34bfa2(0xef)],'createdAt':_0x52625c[_0x34bfa2(0xd0)],'chargebackAmount':_0x27c748};await telegramBotService_1[_0x34bfa2(0x104)][_0x34bfa2(0x11b)](_0x52625c[_0x34bfa2(0xfd)],_0x37298d,_0x36b0bc),console[_0x34bfa2(0x106)]('âœ…\x20Telegram\x20notification\x20sent\x20for\x20status\x20change:\x20'+_0x52625c['status']+_0x34bfa2(0xf4)+_0x2ca53d);}}catch(_0x49c296){console[_0x34bfa2(0xe9)](_0x34bfa2(0xe7),_0x49c296);}}_0x1a5569[_0x34bfa2(0xff)]({'success':!![],'message':_0x34bfa2(0xf2),'result':_0x220c07});}catch(_0x1243a2){_0x1eb57a(_0x1243a2);}},this[_0x55cd6c(0xee)]=async(_0x98d32a,_0x5f544b,_0x17a31d)=>{const _0x148ffa=_0x55cd6c;try{const {id:_0x120683}=_0x98d32a[_0x148ffa(0x10f)],_0x1333c6=_0x98d32a[_0x148ffa(0x101)];console[_0x148ffa(0x106)](_0x148ffa(0xe4)+_0x120683+':',_0x1333c6);const _0x31983a=await this[_0x148ffa(0x102)]['updateCustomerData'](_0x120683,_0x1333c6);_0x5f544b['json']({'success':!![],'message':_0x148ffa(0xeb),'result':_0x31983a});}catch(_0x495474){_0x17a31d(_0x495474);}},this[_0x55cd6c(0xe8)]=async(_0x5a6cda,_0x164a18,_0x24ae57)=>{const _0x29928a=_0x55cd6c;try{const {id:_0xaa87ce}=_0x5a6cda[_0x29928a(0x10f)],_0x30fe84=_0x5a6cda['body'],_0x549dba=await this[_0x29928a(0x102)][_0x29928a(0xe8)](_0xaa87ce,_0x30fe84);_0x164a18[_0x29928a(0xff)]({'success':!![],'message':_0x29928a(0xe3),'result':_0x549dba});}catch(_0x21f106){_0x24ae57(_0x21f106);}},this[_0x55cd6c(0xfb)]=async(_0x2d9cc2,_0x5cfc88,_0x55f241)=>{const _0x48ffea=_0x55cd6c;try{const {id:_0x34e499}=_0x2d9cc2[_0x48ffea(0x10f)],_0x502f3f=await this[_0x48ffea(0x102)][_0x48ffea(0xfb)](_0x34e499);_0x5cfc88[_0x48ffea(0xff)]({'success':!![],'message':_0x48ffea(0x115),'result':_0x502f3f});}catch(_0x2960ad){_0x55f241(_0x2960ad);}},this[_0x55cd6c(0xd5)]=async(_0x1947df,_0x37041e,_0x2a0f0c)=>{const _0x12f7ea=_0x55cd6c;try{const {id:_0x3f42e7}=_0x1947df[_0x12f7ea(0x10f)],_0x47a65d=await this[_0x12f7ea(0x102)][_0x12f7ea(0xd5)](_0x3f42e7);_0x37041e['json']({'success':!![],'message':_0x12f7ea(0xd3),'result':_0x47a65d});}catch(_0x1431db){_0x2a0f0c(_0x1431db);}},this['getUsers']=async(_0x5e1b5d,_0x39ccb2,_0x42280c)=>{const _0x563d19=_0x55cd6c;try{const {page:page=0x1,limit:limit=0x14,status:_0xab4f90}=_0x5e1b5d[_0x563d19(0xce)],_0x644330={'page':Number(page),'limit':Number(limit),'status':_0xab4f90},_0x73530=await this[_0x563d19(0x102)][_0x563d19(0x127)](_0x644330);_0x39ccb2[_0x563d19(0xff)]({'success':!![],'users':_0x73530[_0x563d19(0x113)],'pagination':_0x73530['pagination']});}catch(_0x394d61){_0x42280c(_0x394d61);}},this[_0x55cd6c(0x11f)]=async(_0xa18ffb,_0x5ccedc,_0x3c5eae)=>{const _0x5afed5=_0x55cd6c;try{const {id:_0xf48cfa}=_0xa18ffb[_0x5afed5(0x10f)],_0x47ca38=await this['adminService']['getUserById'](_0xf48cfa);if(!_0x47ca38)return _0x5ccedc[_0x5afed5(0x114)](0x194)[_0x5afed5(0xff)]({'success':![],'message':'User\x20not\x20found'});_0x5ccedc[_0x5afed5(0xff)]({'success':!![],'result':_0x47ca38});}catch(_0x3f0ad4){_0x3c5eae(_0x3f0ad4);}},this['createUser']=async(_0x4abd55,_0x710ada,_0x356129)=>{const _0x64ccd0=_0x55cd6c;try{const _0x2b1cba=_0x4abd55[_0x64ccd0(0x101)],_0x35f7e6=await this[_0x64ccd0(0x102)][_0x64ccd0(0xd8)](_0x2b1cba);_0x710ada[_0x64ccd0(0x114)](0xc9)[_0x64ccd0(0xff)]({'success':!![],'message':_0x64ccd0(0x119),'result':_0x35f7e6});}catch(_0x4b9b20){_0x356129(_0x4b9b20);}},this['deleteUser']=async(_0x4b9946,_0x1be479,_0x287e58)=>{const _0x589487=_0x55cd6c;try{const {id:_0x11b6c8}=_0x4b9946[_0x589487(0x10f)];await this[_0x589487(0x102)][_0x589487(0x11c)](_0x11b6c8),_0x1be479[_0x589487(0xff)]({'success':!![],'message':_0x589487(0xd4)});}catch(_0x591338){_0x287e58(_0x591338);}},this[_0x55cd6c(0x102)]=new adminService_1[(_0x55cd6c(0x11e))](),this[_0x55cd6c(0xfe)]=new paymentLinkService_1['PaymentLinkService']();}}exports[a3_0x1c1974(0x117)]=AdminController;