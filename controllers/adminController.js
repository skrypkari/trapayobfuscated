'use strict';const a4_0x160a8c=a4_0xca4e;(function(_0x48511f,_0x1ab310){const _0x2435a3=a4_0xca4e,_0x1aa07f=_0x48511f();while(!![]){try{const _0x4e1492=parseInt(_0x2435a3(0x249))/0x1+parseInt(_0x2435a3(0x1cb))/0x2+-parseInt(_0x2435a3(0x1e3))/0x3+-parseInt(_0x2435a3(0x25d))/0x4*(-parseInt(_0x2435a3(0x219))/0x5)+parseInt(_0x2435a3(0x24e))/0x6*(parseInt(_0x2435a3(0x25c))/0x7)+-parseInt(_0x2435a3(0x262))/0x8*(-parseInt(_0x2435a3(0x253))/0x9)+-parseInt(_0x2435a3(0x1f5))/0xa*(parseInt(_0x2435a3(0x1c8))/0xb);if(_0x4e1492===_0x1ab310)break;else _0x1aa07f['push'](_0x1aa07f['shift']());}catch(_0x88f90c){_0x1aa07f['push'](_0x1aa07f['shift']());}}}(a4_0x3560,0x560e3));function a4_0x3560(){const _0x480014=['params','üßπ\x20Manual\x20PROCESSING\x20payment\x20cleanup\x20initiated\x20by\x20admin:\x20','status','enableAdmin2FA','shopId','updatePayout','getGatewaySettings','getUserById','body','getAllPayments','üìä\x20Admin\x20requesting\x20merchant\x20statistics\x20with\x20filters:','toFixed','‚úÖ\x20Telegram\x20notification\x20sent\x20for\x20status\x20change:\x20','deleteUser','error','\x20->\x20','getProcessingPaymentsStats','../services/adminService','cleanupStalePayments','createPayout','query','json','createUser','call','Payment\x20not\x20found','expireSinglePaymentLinks','user','suspendUser','getPayments','getPaymentById','then','\x20->\x20Gateway\x20Name:\x20','desc','REFUND','getAllGatewaysWithSettings','updatePayment','47842EtZiPb','total','cleanupStalePaymentsWithReport','getGatewayStatistics','getMerchantsAwaitingPayout','3990ycRUCq','depositBalance','amountAfterGatewayCommissionUSDT','_sum','count','9Tohjrp','amountUSDT','‚è∞\x20Manual\x20PENDING\x20payment\x20cleanup\x20initiated\x20by\x20admin:\x20','__esModule','getMerchantStatistics','payment','changeAdminPassword','PENDING\x20payment\x20cleanup\x20completed\x20successfully','Payout\x20deleted\x20successfully','3969gHXvAJ','814300sqWfEP','Payment\x20link\x20expiration\x20check\x20completed\x20successfully','paymentCleanupService','getPayoutReports','get','3347736xBoTol','enable2FA','\x20with\x20data:','üì±\x20Skipping\x20Telegram\x20notification\x20for\x20status\x20change\x20to:\x20','sendPaymentNotification','updateGatewaySettings','role','User\x20updated\x20successfully','setupAdmin2FA','getUsers','Failed\x20to\x20update\x20payment\x20link\x20counter:','\x20\x20\x20-\x20Successful\x20Payments:\x20','../services/gatewaySettingsService','../types/gateway','User\x20suspended\x20successfully','ceil','refund','all','handleSuccessfulPayment','User\x20not\x20found','getShopWallets','processing','üîç\x20[GATEWAY\x20STATS]\x20Sample\x20payments\x20for\x20','updatePaymentStatus','üìä\x20[GATEWAY\x20STATS]\x20Requesting\x20statistics\x20for\x20gateway\x20ID:\x20','25520qGgGzY','../services/telegramBotService',',\x20sending\x20Telegram\x20notification','1215226EXAnyB','Gateway\x20not\x20found','length','User\x20created\x20successfully','chargeback','‚ùå\x20[GATEWAY\x20STATS]\x20Error:','telegramBotService','findMany','getOwnPropertyNames','prototype','Payout\x20not\x20found','Amount\x20must\x20be\x20greater\x20than\x200','statistics','cleanupStalePendingPayments','paymentLinkService','üéØ\x20[CONTROLLER]\x20Creating\x20payout\x20with\x20data:','loginLog','üìä\x20Manual\x20payment\x20cleanup\x20(PROCESSING\x20+\x20PENDING)\x20with\x20report\x20initiated\x20by\x20admin:\x20','üîç\x20[GATEWAY\x20STATS]\x20Querying\x20payments\x20with\x20gateway=\x22','failed','Failed\x20to\x20send\x20Telegram\x20notification\x20for\x20status\x20change:','\x20to\x20','checkAuth','\x20\x20\x20-\x20Chargeback\x20Rate:\x20','2047887BgsKdW','Token\x20is\x20required','month','disable2FA','getSystemStatistics','users','üí∞\x20[GATEWAY\x20STATS]\x20Paid\x20payments\x20result:','payouts','\x22\x20and\x20status=\x22PAID\x22','getPayoutById','log','processed','default','configurable','stringify','PaymentLinkService','get2FASettings','üìä\x20Admin\x20requesting\x20payout\x20reports:','2670eZmiAu','defineProperty','AdminController','Payment\x20updated\x20successfully','merchants','getPayoutStats','üîÑ\x20Admin\x20updating\x20customer\x20data\x20for\x20payment\x20','errors','PAID','Admin\x202FA\x20disabled\x20successfully','getStatistics','Payment\x20cleanup\x20(PROCESSING\x20+\x20PENDING)\x20with\x20report\x20completed\x20successfully','deletePayout','shopId\x20and\x20amount\x20are\x20required','User\x20deleted\x20successfully','expired','__setModuleDefault','CHARGEBACK','üí∏\x20[GATEWAY\x20STATS]\x20Refund\x20count:\x20','getAllUsers','‚úÖ\x20Payment\x20link\x20counter\x20updated\x20for\x20payment\x20','‚ùå\x20[GATEWAY\x20STATS]\x20Gateway\x20not\x20found\x20for\x20ID:\x20','../services/paymentCleanupService','adminService','30d','__importStar','cleanupStaleProcessingPayments','getAllPayouts','updateSettings','activateUser','pagination','üìà\x20[GATEWAY\x20STATS]\x20Calculated\x20statistics:','2FA\x20disabled\x20successfully','../config/database','üéØ\x20[CONTROLLER]\x20Updating\x20payout\x20','2FA\x20enabled\x20successfully','5TfbBJM','updateCustomerData','üì±\x20Payment\x20','resolve','_count','disableAdmin2FA','gatewaySettingsService','__importDefault','getMerchantsSelection','getOwnPropertyDescriptor','username','gateway'];a4_0x3560=function(){return _0x480014;};return a4_0x3560();}var __createBinding=this&&this['__createBinding']||(Object['create']?function(_0x21dd69,_0x5ad928,_0x738386,_0x2c4bf8){const _0x3cb4a4=a4_0xca4e;if(_0x2c4bf8===undefined)_0x2c4bf8=_0x738386;var _0x54d39b=Object[_0x3cb4a4(0x222)](_0x5ad928,_0x738386);(!_0x54d39b||(_0x3cb4a4(0x261)in _0x54d39b?!_0x5ad928['__esModule']:_0x54d39b['writable']||_0x54d39b[_0x3cb4a4(0x1f0)]))&&(_0x54d39b={'enumerable':!![],'get':function(){return _0x5ad928[_0x738386];}}),Object[_0x3cb4a4(0x1f6)](_0x21dd69,_0x2c4bf8,_0x54d39b);}:function(_0x196d01,_0x51367b,_0x46b677,_0x25b932){if(_0x25b932===undefined)_0x25b932=_0x46b677;_0x196d01[_0x25b932]=_0x51367b[_0x46b677];}),__setModuleDefault=this&&this[a4_0x160a8c(0x205)]||(Object['create']?function(_0x3c0779,_0x394b52){const _0x240390=a4_0x160a8c;Object['defineProperty'](_0x3c0779,_0x240390(0x1ef),{'enumerable':!![],'value':_0x394b52});}:function(_0x4625c5,_0xfe3732){const _0xe0023=a4_0x160a8c;_0x4625c5[_0xe0023(0x1ef)]=_0xfe3732;}),__importStar=this&&this[a4_0x160a8c(0x20e)]||(function(){var _0x29615a=function(_0x25be40){const _0x46a22c=a4_0xca4e;return _0x29615a=Object[_0x46a22c(0x1d3)]||function(_0x53059b){const _0x135e6c=_0x46a22c;var _0x434d53=[];for(var _0x100357 in _0x53059b)if(Object[_0x135e6c(0x1d4)]['hasOwnProperty'][_0x135e6c(0x23c)](_0x53059b,_0x100357))_0x434d53[_0x434d53[_0x135e6c(0x1cd)]]=_0x100357;return _0x434d53;},_0x29615a(_0x25be40);};return function(_0x599d3d){const _0xa40454=a4_0xca4e;if(_0x599d3d&&_0x599d3d[_0xa40454(0x256)])return _0x599d3d;var _0x54dcbb={};if(_0x599d3d!=null){for(var _0x5069b7=_0x29615a(_0x599d3d),_0x26d42a=0x0;_0x26d42a<_0x5069b7['length'];_0x26d42a++)if(_0x5069b7[_0x26d42a]!==_0xa40454(0x1ef))__createBinding(_0x54dcbb,_0x599d3d,_0x5069b7[_0x26d42a]);}return __setModuleDefault(_0x54dcbb,_0x599d3d),_0x54dcbb;};}()),__importDefault=this&&this[a4_0x160a8c(0x220)]||function(_0x15f633){const _0x3eaed7=a4_0x160a8c;return _0x15f633&&_0x15f633[_0x3eaed7(0x256)]?_0x15f633:{'default':_0x15f633};};Object['defineProperty'](exports,a4_0x160a8c(0x256),{'value':!![]}),exports[a4_0x160a8c(0x1f7)]=void 0x0;const adminService_1=require(a4_0x160a8c(0x236)),paymentLinkService_1=require('../services/paymentLinkService'),paymentCleanupService_1=require(a4_0x160a8c(0x20b)),telegramBotService_1=require(a4_0x160a8c(0x1c9)),gatewaySettingsService_1=require(a4_0x160a8c(0x26e)),database_1=__importDefault(require(a4_0x160a8c(0x216)));function a4_0xca4e(_0xec52a9,_0x5e00c6){_0xec52a9=_0xec52a9-0x1c6;const _0x3560e5=a4_0x3560();let _0xca4e6a=_0x3560e5[_0xec52a9];return _0xca4e6a;}class AdminController{constructor(){const _0x2a6356=a4_0x160a8c;this[_0x2a6356(0x1e1)]=async(_0x3776ce,_0x9a93cc,_0x25486f)=>{const _0x321eff=_0x2a6356;try{const _0x4f1caa=_0x3776ce[_0x321eff(0x23f)];_0x9a93cc[_0x321eff(0x23a)]({'success':!![],'message':'Admin\x20access\x20confirmed','user':{'id':_0x4f1caa?.['id'],'username':_0x4f1caa?.['username'],'role':_0x4f1caa?.[_0x321eff(0x268)]}});}catch(_0x9ade8f){_0x25486f(_0x9ade8f);}},this[_0x2a6356(0x1ff)]=async(_0x5d7bdd,_0x219d82,_0x1dc151)=>{const _0x33ef4c=_0x2a6356;try{const {period:period=_0x33ef4c(0x20d),currentDate:_0x41fbc1}=_0x5d7bdd[_0x33ef4c(0x239)],_0x56d0a8=await this[_0x33ef4c(0x20c)][_0x33ef4c(0x1e7)](period,_0x41fbc1);_0x219d82['json']({'success':!![],'result':_0x56d0a8});}catch(_0x2acaf7){_0x1dc151(_0x2acaf7);}},this[_0x2a6356(0x257)]=async(_0x17dbb0,_0x4d8ee8,_0x198a63)=>{const _0xece351=_0x2a6356;try{const {shopId:_0x5886ea,period:period=_0xece351(0x1e5),dateFrom:_0x5167f0,dateTo:_0x2f15aa}=_0x17dbb0['query'],_0x23febd={'shopId':_0x5886ea,'period':period,'dateFrom':_0x5167f0,'dateTo':_0x2f15aa};console[_0xece351(0x1ed)](_0xece351(0x22f),_0x23febd);const _0x1f7635=await this['adminService'][_0xece351(0x257)](_0x23febd);_0x4d8ee8[_0xece351(0x23a)]({'success':!![],'result':_0x1f7635});}catch(_0x21aa47){_0x198a63(_0x21aa47);}},this[_0x2a6356(0x260)]=async(_0x15fedf,_0x4d211c,_0xd60650)=>{const _0x1750df=_0x2a6356;try{const {periodFrom:_0x411e02,periodTo:_0x35c9be,gateway:_0x4a0e10}=_0x15fedf[_0x1750df(0x239)];if(!_0x411e02||!_0x35c9be||!_0x4a0e10)return _0x4d211c[_0x1750df(0x227)](0x190)['json']({'success':![],'message':'periodFrom,\x20periodTo,\x20and\x20gateway\x20are\x20required'});console[_0x1750df(0x1ed)](_0x1750df(0x1f4),{'periodFrom':_0x411e02,'periodTo':_0x35c9be,'gateway':_0x4a0e10});const _0x4b764f=await this['adminService'][_0x1750df(0x260)]({'periodFrom':_0x411e02,'periodTo':_0x35c9be,'gateway':_0x4a0e10});_0x4d211c[_0x1750df(0x23a)]({'success':!![],'reports':_0x4b764f});}catch(_0x1cb719){_0xd60650(_0x1cb719);}},this[_0x2a6356(0x1fa)]=async(_0x1edc40,_0x241dd9,_0x1c38f4)=>{const _0x516201=_0x2a6356;try{const _0x48156c=await this[_0x516201(0x20c)][_0x516201(0x1fa)]();_0x241dd9[_0x516201(0x23a)]({'success':!![],'result':_0x48156c});}catch(_0x2352ac){_0x1c38f4(_0x2352ac);}},this['getMerchantsAwaitingPayout']=async(_0x30030d,_0x1f1333,_0x151e6b)=>{const _0x21bc73=_0x2a6356;try{const {page:page=0x1,limit:limit=0x14,minAmount:_0x153322,search:_0x2a348c}=_0x30030d['query'],_0x4b1d2b={'page':Number(page),'limit':Number(limit),'minAmount':_0x153322?Number(_0x153322):undefined,'search':_0x2a348c},_0x566bbf=await this[_0x21bc73(0x20c)][_0x21bc73(0x24d)](_0x4b1d2b);_0x1f1333[_0x21bc73(0x23a)]({'success':!![],'merchants':_0x566bbf[_0x21bc73(0x1f9)],'pagination':_0x566bbf[_0x21bc73(0x213)],'summary':_0x566bbf['summary']});}catch(_0x4e4e81){_0x151e6b(_0x4e4e81);}},this['getMerchantsSelection']=async(_0x21e04f,_0x14516a,_0x4477d2)=>{const _0x112a35=_0x2a6356;try{const _0x2d5ded=_0x21e04f[_0x112a35(0x239)]['hasPayoutHistory']==='true',_0x4bf54a=await this[_0x112a35(0x20c)][_0x112a35(0x221)](_0x2d5ded);_0x14516a[_0x112a35(0x23a)]({'success':!![],'result':_0x4bf54a});}catch(_0x3cb8ac){_0x4477d2(_0x3cb8ac);}},this[_0x2a6356(0x238)]=async(_0x5419da,_0x986418,_0x3a827c)=>{const _0x96c559=_0x2a6356;try{const _0xf79e19=_0x5419da['body'];console[_0x96c559(0x1ed)](_0x96c559(0x1da),_0xf79e19);const _0x1ae319=await this[_0x96c559(0x20c)][_0x96c559(0x238)](_0xf79e19);_0x986418['status'](0xc9)['json']({'success':!![],'message':'Payout\x20created\x20successfully','result':_0x1ae319});}catch(_0x568052){_0x3a827c(_0x568052);}},this[_0x2a6356(0x22a)]=async(_0xebcd28,_0x15c245,_0x228311)=>{const _0x5385f6=_0x2a6356;try{const {id:_0x22d743}=_0xebcd28[_0x5385f6(0x225)],_0x1cbcf1=_0xebcd28[_0x5385f6(0x22d)];console['log'](_0x5385f6(0x217)+_0x22d743+_0x5385f6(0x264),_0x1cbcf1);const _0x267f0e=await this[_0x5385f6(0x20c)][_0x5385f6(0x22a)](_0x22d743,_0x1cbcf1);_0x15c245[_0x5385f6(0x23a)]({'success':!![],'message':'Payout\x20updated\x20successfully','result':_0x267f0e});}catch(_0x524dc4){_0x228311(_0x524dc4);}},this['getPayouts']=async(_0x376f15,_0x4d58c1,_0x274791)=>{const _0x19ae8a=_0x2a6356;try{const {page:page=0x1,limit:limit=0x14,shopId:_0x17b254,network:_0x4401c5,dateFrom:_0x1a09a7,dateTo:_0x26411e,search:_0x51ea55}=_0x376f15[_0x19ae8a(0x239)],_0x189be8={'page':Number(page),'limit':Number(limit),'shopId':_0x17b254,'network':_0x4401c5,'dateFrom':_0x1a09a7,'dateTo':_0x26411e,'search':_0x51ea55},_0x3d56bd=await this[_0x19ae8a(0x20c)][_0x19ae8a(0x210)](_0x189be8);_0x4d58c1[_0x19ae8a(0x23a)]({'success':!![],'payouts':_0x3d56bd[_0x19ae8a(0x1ea)],'pagination':_0x3d56bd[_0x19ae8a(0x213)]});}catch(_0x13d3cf){_0x274791(_0x13d3cf);}},this[_0x2a6356(0x1ec)]=async(_0xfad19,_0x950736,_0x444f5a)=>{const _0x1202ad=_0x2a6356;try{const {id:_0xd4d764}=_0xfad19[_0x1202ad(0x225)],_0x3b3d59=await this[_0x1202ad(0x20c)][_0x1202ad(0x1ec)](_0xd4d764);if(!_0x3b3d59)return _0x950736[_0x1202ad(0x227)](0x194)['json']({'success':![],'message':_0x1202ad(0x1d5)});_0x950736[_0x1202ad(0x23a)]({'success':!![],'result':_0x3b3d59});}catch(_0x17c5c8){_0x444f5a(_0x17c5c8);}},this[_0x2a6356(0x201)]=async(_0x24c56b,_0x5dcb06,_0x376cb6)=>{const _0x3cb530=_0x2a6356;try{const {id:_0x472440}=_0x24c56b[_0x3cb530(0x225)];await this[_0x3cb530(0x20c)][_0x3cb530(0x201)](_0x472440),_0x5dcb06[_0x3cb530(0x23a)]({'success':!![],'message':_0x3cb530(0x25b)});}catch(_0x40ab5f){_0x376cb6(_0x40ab5f);}},this[_0x2a6356(0x241)]=async(_0x558ea3,_0x7540a4,_0x2e4be1)=>{const _0x14c3f3=_0x2a6356;try{const {page:page=0x1,limit:limit=0x14,status:_0x6e797c,gateway:_0x52b311,shopId:_0x2e8bb8,dateFrom:_0x3d6c7a,dateTo:_0x3d4efc,search:_0x107566,currency:_0x3d0da2,sortBy:_0x5b46d9,sortOrder:_0x11318}=_0x558ea3[_0x14c3f3(0x239)],_0x2a9d12={'page':Number(page),'limit':Number(limit),'status':_0x6e797c,'gateway':_0x52b311,'shopId':_0x2e8bb8,'dateFrom':_0x3d6c7a,'dateTo':_0x3d4efc,'search':_0x107566,'currency':_0x3d0da2,'sortBy':_0x5b46d9,'sortOrder':_0x11318},_0x46b942=await this[_0x14c3f3(0x20c)][_0x14c3f3(0x22e)](_0x2a9d12);_0x7540a4[_0x14c3f3(0x23a)]({'success':!![],'payments':_0x46b942['payments'],'pagination':_0x46b942['pagination'],'statistics':_0x46b942[_0x14c3f3(0x1d7)]});}catch(_0x4bc012){_0x2e4be1(_0x4bc012);}},this[_0x2a6356(0x242)]=async(_0x1a7540,_0xbf5186,_0x43e937)=>{const _0x1234db=_0x2a6356;try{const {id:_0x8c8fa5}=_0x1a7540[_0x1234db(0x225)],_0x21cb02=await this[_0x1234db(0x20c)][_0x1234db(0x242)](_0x8c8fa5);if(!_0x21cb02)return _0xbf5186[_0x1234db(0x227)](0x194)[_0x1234db(0x23a)]({'success':![],'message':_0x1234db(0x23d)});_0xbf5186[_0x1234db(0x23a)]({'success':!![],'result':_0x21cb02});}catch(_0x2503c4){_0x43e937(_0x2503c4);}},this[_0x2a6356(0x248)]=async(_0x2bd6db,_0x34e2b8,_0x561f8a)=>{const _0xfe000=_0x2a6356;try{const {id:_0x15aea8}=_0x2bd6db[_0xfe000(0x225)],{status:_0x24fab1,notes:_0x2e8d0c,chargebackAmount:_0xdebc82}=_0x2bd6db[_0xfe000(0x22d)],_0x37402f=await this['adminService'][_0xfe000(0x242)](_0x15aea8);if(!_0x37402f)return _0x34e2b8[_0xfe000(0x227)](0x194)[_0xfe000(0x23a)]({'success':![],'message':_0xfe000(0x23d)});const _0x1f0c45=await this[_0xfe000(0x20c)][_0xfe000(0x1c6)](_0x15aea8,_0x24fab1,_0x2e8d0c,_0xdebc82);if(_0x37402f[_0xfe000(0x227)]!==_0x24fab1&&_0x24fab1['toUpperCase']()==='PAID'){console['log']('üìà\x20Admin\x20changed\x20payment\x20'+_0x15aea8+'\x20to\x20PAID,\x20updating\x20payment\x20link\x20counter');try{await this[_0xfe000(0x1d9)][_0xfe000(0x274)](_0x15aea8),console['log'](_0xfe000(0x209)+_0x15aea8);}catch(_0x3c5a8e){console[_0xfe000(0x233)](_0xfe000(0x26c),_0x3c5a8e);}}if(_0x37402f['status']!==_0x24fab1){console['log'](_0xfe000(0x21b)+_0x15aea8+'\x20status\x20changed\x20from\x20'+_0x37402f[_0xfe000(0x227)]+_0xfe000(0x1e0)+_0x24fab1+_0xfe000(0x1ca));try{let _0x5b928f;switch(_0x24fab1['toUpperCase']()){case _0xfe000(0x1fd):_0x5b928f='paid';break;case'PROCESSING':_0x5b928f=_0xfe000(0x277);break;case'FAILED':_0x5b928f='failed';break;case'EXPIRED':_0x5b928f='expired';break;case _0xfe000(0x246):_0x5b928f=_0xfe000(0x272);break;case'CHARGEBACK':_0x5b928f=_0xfe000(0x1cf);break;default:console['log'](_0xfe000(0x265)+_0x24fab1);break;}if(_0x5b928f){const _0x2a216f={..._0x1f0c45,'shopId':_0x37402f[_0xfe000(0x229)],'gateway':_0x37402f[_0xfe000(0x224)],'createdAt':_0x37402f['createdAt'],'chargebackAmount':_0xdebc82};await telegramBotService_1[_0xfe000(0x1d1)][_0xfe000(0x266)](_0x37402f['shopId'],_0x2a216f,_0x5b928f),console[_0xfe000(0x1ed)](_0xfe000(0x231)+_0x37402f['status']+_0xfe000(0x234)+_0x24fab1);}}catch(_0x2d702c){console[_0xfe000(0x233)](_0xfe000(0x1df),_0x2d702c);}}_0x34e2b8[_0xfe000(0x23a)]({'success':!![],'message':_0xfe000(0x1f8),'result':_0x1f0c45});}catch(_0x3865f4){_0x561f8a(_0x3865f4);}},this[_0x2a6356(0x21a)]=async(_0x3e556b,_0x36ee26,_0x3d2fca)=>{const _0x5278eb=_0x2a6356;try{const {id:_0x5ebc05}=_0x3e556b[_0x5278eb(0x225)],_0x29f79b=_0x3e556b[_0x5278eb(0x22d)];console['log'](_0x5278eb(0x1fb)+_0x5ebc05+':',_0x29f79b);const _0x5d393e=await this[_0x5278eb(0x20c)][_0x5278eb(0x21a)](_0x5ebc05,_0x29f79b);_0x36ee26[_0x5278eb(0x23a)]({'success':!![],'message':'Customer\x20data\x20updated\x20successfully','result':_0x5d393e});}catch(_0x220e9d){_0x3d2fca(_0x220e9d);}},this['updateUser']=async(_0x4b3778,_0x25408a,_0x4a23c8)=>{const _0x5c1af6=_0x2a6356;try{const {id:_0x1aff5e}=_0x4b3778[_0x5c1af6(0x225)],_0x5ca987=_0x4b3778[_0x5c1af6(0x22d)],_0x252d81=await this[_0x5c1af6(0x20c)]['updateUser'](_0x1aff5e,_0x5ca987);_0x25408a[_0x5c1af6(0x23a)]({'success':!![],'message':_0x5c1af6(0x269),'result':_0x252d81});}catch(_0xbc34f9){_0x4a23c8(_0xbc34f9);}},this[_0x2a6356(0x240)]=async(_0x2e1255,_0x447b97,_0x873070)=>{const _0x421ae5=_0x2a6356;try{const {id:_0x2ee38c}=_0x2e1255['params'],_0x4d8c04=await this[_0x421ae5(0x20c)][_0x421ae5(0x240)](_0x2ee38c);_0x447b97['json']({'success':!![],'message':_0x421ae5(0x270),'result':_0x4d8c04});}catch(_0x170866){_0x873070(_0x170866);}},this['activateUser']=async(_0x4fd26c,_0x39a52d,_0x4f49b6)=>{const _0x2fde53=_0x2a6356;try{const {id:_0x596f9c}=_0x4fd26c[_0x2fde53(0x225)],_0x3c6420=await this[_0x2fde53(0x20c)][_0x2fde53(0x212)](_0x596f9c);_0x39a52d[_0x2fde53(0x23a)]({'success':!![],'message':'User\x20activated\x20successfully','result':_0x3c6420});}catch(_0x1a054d){_0x4f49b6(_0x1a054d);}},this[_0x2a6356(0x26b)]=async(_0x4ec85c,_0x56b12a,_0x16560a)=>{const _0x3214ed=_0x2a6356;try{const {page:page=0x1,limit:limit=0x14,status:_0x251030,search:_0x58f210}=_0x4ec85c[_0x3214ed(0x239)],_0xac1273={'page':Number(page),'limit':Number(limit),'status':_0x251030,'search':_0x58f210},_0x2814c6=await this['adminService'][_0x3214ed(0x208)](_0xac1273);_0x56b12a[_0x3214ed(0x23a)]({'success':!![],'users':_0x2814c6[_0x3214ed(0x1e8)],'pagination':_0x2814c6['pagination']});}catch(_0xed3425){_0x16560a(_0xed3425);}},this[_0x2a6356(0x22c)]=async(_0x462a97,_0x4ad925,_0x1d56d6)=>{const _0x311409=_0x2a6356;try{const {id:_0x5584a2}=_0x462a97[_0x311409(0x225)],_0x367f0c=await this['adminService']['getUserById'](_0x5584a2);if(!_0x367f0c)return _0x4ad925[_0x311409(0x227)](0x194)['json']({'success':![],'message':_0x311409(0x275)});_0x4ad925['json']({'success':!![],'result':_0x367f0c});}catch(_0x366edd){_0x1d56d6(_0x366edd);}},this[_0x2a6356(0x23b)]=async(_0x97442c,_0x2edd11,_0x300e70)=>{const _0x85f458=_0x2a6356;try{const _0x3b247d=_0x97442c[_0x85f458(0x22d)],_0x3e60b6=await this[_0x85f458(0x20c)][_0x85f458(0x23b)](_0x3b247d);_0x2edd11[_0x85f458(0x227)](0xc9)[_0x85f458(0x23a)]({'success':!![],'message':_0x85f458(0x1ce),'result':_0x3e60b6});}catch(_0x2dc851){_0x300e70(_0x2dc851);}},this[_0x2a6356(0x232)]=async(_0x422cf9,_0xd979ba,_0x38ee38)=>{const _0x45263f=_0x2a6356;try{const {id:_0x5112c7}=_0x422cf9[_0x45263f(0x225)],{twoFactorToken:_0x23cafa}=_0x422cf9[_0x45263f(0x22d)];await this[_0x45263f(0x20c)][_0x45263f(0x232)](_0x5112c7,_0x23cafa),_0xd979ba[_0x45263f(0x23a)]({'success':!![],'message':_0x45263f(0x203)});}catch(_0x23790d){_0x38ee38(_0x23790d);}},this['getShopWallets']=async(_0x546c01,_0x2526f6,_0xbe3a00)=>{const _0x5f3c2c=_0x2a6356;try{const {shopId:_0x43bdd0}=_0x546c01[_0x5f3c2c(0x225)],_0x164983=await this[_0x5f3c2c(0x20c)][_0x5f3c2c(0x276)](_0x43bdd0);_0x2526f6[_0x5f3c2c(0x23a)]({'success':!![],'wallets':_0x164983});}catch(_0x2ccfd2){_0xbe3a00(_0x2ccfd2);}},this['setup2FA']=async(_0x240a87,_0x218dc0,_0x2dcbdf)=>{const _0x16cfe3=_0x2a6356;try{const {shopId:_0x4bdccd}=_0x240a87[_0x16cfe3(0x225)],_0x3806c2=await this[_0x16cfe3(0x20c)]['setup2FA'](_0x4bdccd);_0x218dc0[_0x16cfe3(0x23a)]({'success':!![],'result':_0x3806c2});}catch(_0x5b1fd8){_0x2dcbdf(_0x5b1fd8);}},this['enable2FA']=async(_0x4b93b6,_0x55a444,_0x321e68)=>{const _0x1bccc9=_0x2a6356;try{const {shopId:_0xb061a4}=_0x4b93b6[_0x1bccc9(0x225)],{token:_0x5bfd06}=_0x4b93b6[_0x1bccc9(0x22d)];if(!_0x5bfd06)return _0x55a444[_0x1bccc9(0x227)](0x190)[_0x1bccc9(0x23a)]({'success':![],'message':_0x1bccc9(0x1e4)});const _0x53e7e3=await this[_0x1bccc9(0x20c)][_0x1bccc9(0x263)](_0xb061a4,_0x5bfd06);_0x55a444['json']({'success':!![],'message':_0x1bccc9(0x218),'result':_0x53e7e3});}catch(_0x52ad00){_0x321e68(_0x52ad00);}},this['disable2FA']=async(_0x1bd95f,_0x1847f4,_0x2a80f8)=>{const _0x16a854=_0x2a6356;try{const {shopId:_0x5d4c17}=_0x1bd95f[_0x16a854(0x225)];await this['adminService'][_0x16a854(0x1e6)](_0x5d4c17),_0x1847f4['json']({'success':!![],'message':_0x16a854(0x215)});}catch(_0x5ee275){_0x2a80f8(_0x5ee275);}},this[_0x2a6356(0x235)]=async(_0x1217fc,_0x2061a8,_0x58a2ab)=>{const _0x3c20d4=_0x2a6356;try{const _0x32492e=await paymentCleanupService_1['paymentCleanupService'][_0x3c20d4(0x235)]();_0x2061a8[_0x3c20d4(0x23a)]({'success':!![],'result':_0x32492e});}catch(_0x23b71b){_0x58a2ab(_0x23b71b);}},this[_0x2a6356(0x237)]=async(_0x44e429,_0x584479,_0x4a6fa3)=>{const _0x3537bb=_0x2a6356;try{console['log'](_0x3537bb(0x226)+_0x44e429[_0x3537bb(0x23f)]?.[_0x3537bb(0x223)]+'\x20('+_0x44e429[_0x3537bb(0x23f)]?.['id']+')');const _0x48102a=await paymentCleanupService_1['paymentCleanupService'][_0x3537bb(0x20f)]();_0x584479[_0x3537bb(0x23a)]({'success':!![],'message':'PROCESSING\x20payment\x20cleanup\x20completed\x20successfully','result':{'processed':_0x48102a[_0x3537bb(0x1ee)],'failed':_0x48102a['failed'],'errors':_0x48102a[_0x3537bb(0x1fc)]}});}catch(_0x299350){_0x4a6fa3(_0x299350);}},this[_0x2a6356(0x1d8)]=async(_0x164e15,_0x9cd3b0,_0x3e6f9d)=>{const _0x1ff9a8=_0x2a6356;try{console[_0x1ff9a8(0x1ed)](_0x1ff9a8(0x255)+_0x164e15[_0x1ff9a8(0x23f)]?.[_0x1ff9a8(0x223)]+'\x20('+_0x164e15[_0x1ff9a8(0x23f)]?.['id']+')');const _0xd52d5d=await paymentCleanupService_1['paymentCleanupService'][_0x1ff9a8(0x1d8)]();_0x9cd3b0[_0x1ff9a8(0x23a)]({'success':!![],'message':_0x1ff9a8(0x25a),'result':{'processed':_0xd52d5d[_0x1ff9a8(0x1ee)],'failed':_0xd52d5d[_0x1ff9a8(0x1de)],'errors':_0xd52d5d[_0x1ff9a8(0x1fc)]}});}catch(_0x512f23){_0x3e6f9d(_0x512f23);}},this[_0x2a6356(0x24b)]=async(_0x1733e5,_0x4bbd4d,_0x4558b1)=>{const _0x53157c=_0x2a6356;try{console[_0x53157c(0x1ed)](_0x53157c(0x1dc)+_0x1733e5[_0x53157c(0x23f)]?.[_0x53157c(0x223)]+'\x20('+_0x1733e5[_0x53157c(0x23f)]?.['id']+')');const _0xc382f5=await paymentCleanupService_1[_0x53157c(0x25f)][_0x53157c(0x235)](),_0x2cd3ac=await paymentCleanupService_1[_0x53157c(0x25f)]['cleanupStaleProcessingPayments'](),_0x5c749d=await paymentCleanupService_1[_0x53157c(0x25f)][_0x53157c(0x1d8)](),_0x4b8ccc=await paymentCleanupService_1['paymentCleanupService'][_0x53157c(0x235)]();_0x4bbd4d['json']({'success':!![],'message':_0x53157c(0x200),'result':{'cleanup':{'processing':{'processed':_0x2cd3ac[_0x53157c(0x1ee)],'failed':_0x2cd3ac[_0x53157c(0x1de)],'errors':_0x2cd3ac[_0x53157c(0x1fc)]},'pending':{'processed':_0x5c749d[_0x53157c(0x1ee)],'failed':_0x5c749d[_0x53157c(0x1de)],'errors':_0x5c749d[_0x53157c(0x1fc)]},'total':{'processed':_0x2cd3ac[_0x53157c(0x1ee)]+_0x5c749d[_0x53157c(0x1ee)],'failed':_0x2cd3ac[_0x53157c(0x1de)]+_0x5c749d[_0x53157c(0x1de)],'errors':[..._0x2cd3ac[_0x53157c(0x1fc)],..._0x5c749d[_0x53157c(0x1fc)]]}},'statistics':{'before':_0xc382f5,'after':_0x4b8ccc,'reduced':_0xc382f5[_0x53157c(0x24a)]-_0x4b8ccc[_0x53157c(0x24a)]}}});}catch(_0x478002){_0x4558b1(_0x478002);}},this['expirePaymentLinks']=async(_0x1dbd52,_0x19a5d6,_0x53b9ce)=>{const _0xfd79e2=_0x2a6356;try{const _0x565892=await paymentCleanupService_1[_0xfd79e2(0x25f)][_0xfd79e2(0x23e)]();_0x19a5d6[_0xfd79e2(0x23a)]({'success':!![],'message':_0xfd79e2(0x25e),'result':{'expired':_0x565892[_0xfd79e2(0x204)],'errors':_0x565892[_0xfd79e2(0x1fc)]}});}catch(_0xb8f9c){_0x53b9ce(_0xb8f9c);}},this[_0x2a6356(0x259)]=async(_0x457d6f,_0x385e8f,_0x2e3123)=>{const _0x5dbbbb=_0x2a6356;try{const {currentPassword:_0x3f0b07,newPassword:_0x4a181d,confirmNewPassword:_0x2c7130,twoFactorToken:_0x4d3338}=_0x457d6f[_0x5dbbbb(0x22d)];await this['adminService'][_0x5dbbbb(0x259)](_0x3f0b07,_0x4a181d,_0x2c7130,_0x4d3338),_0x385e8f['json']({'success':!![],'message':'Admin\x20password\x20changed\x20successfully'});}catch(_0x1032c4){_0x2e3123(_0x1032c4);}},this['get2FASettings']=async(_0x513c06,_0x4dfa90,_0x53c60d)=>{const _0x1b1b96=_0x2a6356;try{const _0x11b3b6=await this['adminService'][_0x1b1b96(0x1f3)]();_0x4dfa90[_0x1b1b96(0x23a)]({'success':!![],'result':_0x11b3b6});}catch(_0x4cf3ae){_0x53c60d(_0x4cf3ae);}},this['setupAdmin2FA']=async(_0x4fd019,_0x1fe81b,_0x1ec958)=>{const _0x177f97=_0x2a6356;try{const _0x495502=await this[_0x177f97(0x20c)][_0x177f97(0x26a)]();_0x1fe81b[_0x177f97(0x23a)]({'success':!![],'result':_0x495502});}catch(_0x345679){_0x1ec958(_0x345679);}},this[_0x2a6356(0x228)]=async(_0x27815f,_0x375718,_0x494d23)=>{const _0xd820ea=_0x2a6356;try{const {token:_0x11b19b}=_0x27815f[_0xd820ea(0x22d)],_0x4ff780=await this[_0xd820ea(0x20c)][_0xd820ea(0x228)](_0x11b19b);_0x375718[_0xd820ea(0x23a)]({'success':!![],'result':_0x4ff780});}catch(_0x1f4b03){_0x494d23(_0x1f4b03);}},this[_0x2a6356(0x21e)]=async(_0x3ca6b6,_0x18f4cd,_0x394bae)=>{const _0x3b6c17=_0x2a6356;try{await this[_0x3b6c17(0x20c)]['disableAdmin2FA'](),_0x18f4cd[_0x3b6c17(0x23a)]({'success':!![],'message':_0x3b6c17(0x1fe)});}catch(_0x5e8ada){_0x394bae(_0x5e8ada);}},this[_0x2a6356(0x24f)]=async(_0x1e1537,_0x11b0b4,_0x357c2c)=>{const _0x2322fb=_0x2a6356;try{const {shopId:_0x588fba,amount:_0x165100,notes:_0x36b734}=_0x1e1537['body'];if(!_0x588fba||!_0x165100)return _0x11b0b4[_0x2322fb(0x227)](0x190)[_0x2322fb(0x23a)]({'success':![],'message':_0x2322fb(0x202)});if(_0x165100<=0x0)return _0x11b0b4[_0x2322fb(0x227)](0x190)[_0x2322fb(0x23a)]({'success':![],'message':_0x2322fb(0x1d6)});await this[_0x2322fb(0x20c)][_0x2322fb(0x24f)](_0x588fba,_0x165100,_0x36b734),_0x11b0b4['json']({'success':!![],'message':'Balance\x20deposited\x20successfully'});}catch(_0x17dc91){_0x357c2c(_0x17dc91);}},this['getLoginLogs']=async(_0x3836f7,_0x707db7,_0x5dd2be)=>{const _0x5c59cf=_0x2a6356;try{const {shopId:_0x1919f2}=_0x3836f7['params'],{page:page='1',limit:limit='20'}=_0x3836f7[_0x5c59cf(0x239)],_0x2902ac=(await Promise[_0x5c59cf(0x21c)]()[_0x5c59cf(0x243)](()=>__importStar(require(_0x5c59cf(0x216)))))[_0x5c59cf(0x1ef)],_0x2b6e78=parseInt(page,0xa),_0x4d72f9=parseInt(limit,0xa),_0x8400e5=(_0x2b6e78-0x1)*_0x4d72f9,[_0x444305,_0x13de22]=await Promise[_0x5c59cf(0x273)]([_0x2902ac['loginLog'][_0x5c59cf(0x1d2)]({'where':{'shopId':_0x1919f2},'orderBy':{'createdAt':_0x5c59cf(0x245)},'skip':_0x8400e5,'take':_0x4d72f9}),_0x2902ac[_0x5c59cf(0x1db)][_0x5c59cf(0x252)]({'where':{'shopId':_0x1919f2}})]);_0x707db7[_0x5c59cf(0x23a)]({'success':!![],'result':{'logs':_0x444305,'pagination':{'page':_0x2b6e78,'limit':_0x4d72f9,'total':_0x13de22,'totalPages':Math[_0x5c59cf(0x271)](_0x13de22/_0x4d72f9)}}});}catch(_0x30e49a){_0x5dd2be(_0x30e49a);}},this[_0x2a6356(0x22b)]=async(_0x1ed4aa,_0x593b2b,_0x5b5900)=>{const _0x5ee7e7=_0x2a6356;try{const _0x4c7766=gatewaySettingsService_1[_0x5ee7e7(0x21f)][_0x5ee7e7(0x247)]();_0x593b2b[_0x5ee7e7(0x23a)]({'success':!![],'result':_0x4c7766});}catch(_0xa4e380){_0x5b5900(_0xa4e380);}},this[_0x2a6356(0x267)]=async(_0xb3d306,_0x2f9548,_0x5be265)=>{const _0x13bca6=_0x2a6356;try{const {gatewayId:_0x15ad7b}=_0xb3d306[_0x13bca6(0x225)],{minAmount:_0x2de97d,maxAmount:_0x43c435,payoutDelay:_0x33d67e,gatewayCommission:_0x63c795}=_0xb3d306[_0x13bca6(0x22d)],_0x10b3d8=gatewaySettingsService_1['gatewaySettingsService'][_0x13bca6(0x211)](_0x15ad7b,{'minAmount':_0x2de97d!==undefined?Number(_0x2de97d):undefined,'maxAmount':_0x43c435!==undefined?Number(_0x43c435):undefined,'payoutDelay':_0x33d67e!==undefined?Number(_0x33d67e):undefined,'gatewayCommission':_0x63c795!==undefined?Number(_0x63c795):undefined});_0x2f9548['json']({'success':!![],'message':'Gateway\x20settings\x20updated\x20successfully','result':_0x10b3d8});}catch(_0xebf556){_0x5be265(_0xebf556);}},this[_0x2a6356(0x24c)]=async(_0xa57424,_0x5f47f1,_0x424f7a)=>{const _0x45b3ee=_0x2a6356;try{const {gatewayId:_0x289546}=_0xa57424['params'];console[_0x45b3ee(0x1ed)](_0x45b3ee(0x1c7)+_0x289546);const {GATEWAY_ID_MAP:_0x2ef75e}=await Promise[_0x45b3ee(0x21c)]()['then'](()=>__importStar(require(_0x45b3ee(0x26f)))),_0x5ba35e=_0x2ef75e[_0x289546];console['log']('üìä\x20[GATEWAY\x20STATS]\x20Gateway\x20ID\x20'+_0x289546+_0x45b3ee(0x244)+_0x5ba35e);if(!_0x5ba35e)return console[_0x45b3ee(0x1ed)](_0x45b3ee(0x20a)+_0x289546),_0x5f47f1[_0x45b3ee(0x227)](0x194)[_0x45b3ee(0x23a)]({'success':![],'message':_0x45b3ee(0x1cc)});console[_0x45b3ee(0x1ed)](_0x45b3ee(0x1dd)+_0x5ba35e+_0x45b3ee(0x1eb));const _0x443f96=await database_1[_0x45b3ee(0x1ef)][_0x45b3ee(0x258)]['findMany']({'where':{'gateway':_0x5ba35e},'select':{'id':!![],'status':!![],'amountUSDT':!![]},'take':0x5});console['log'](_0x45b3ee(0x278)+_0x5ba35e+':',JSON[_0x45b3ee(0x1f1)](_0x443f96,null,0x2));const _0x5211a9=await database_1['default'][_0x45b3ee(0x258)]['aggregate']({'where':{'gateway':_0x5ba35e,'status':_0x45b3ee(0x1fd)},'_sum':{'amountUSDT':!![],'amountAfterGatewayCommissionUSDT':!![]},'_count':{'_all':!![]}});console[_0x45b3ee(0x1ed)](_0x45b3ee(0x1e9),JSON['stringify'](_0x5211a9,null,0x2));const _0x3533f2=await database_1[_0x45b3ee(0x1ef)]['payment'][_0x45b3ee(0x252)]({'where':{'gateway':_0x5ba35e,'status':_0x45b3ee(0x206)}});console[_0x45b3ee(0x1ed)]('üîô\x20[GATEWAY\x20STATS]\x20Chargeback\x20count:\x20'+_0x3533f2);const _0x2d4259=await database_1[_0x45b3ee(0x1ef)]['payment'][_0x45b3ee(0x252)]({'where':{'gateway':_0x5ba35e,'status':_0x45b3ee(0x246)}});console[_0x45b3ee(0x1ed)](_0x45b3ee(0x207)+_0x2d4259);const _0x4d06e8=_0x5211a9[_0x45b3ee(0x251)][_0x45b3ee(0x254)]||0x0,_0x1a791b=(_0x5211a9[_0x45b3ee(0x251)][_0x45b3ee(0x254)]||0x0)-(_0x5211a9[_0x45b3ee(0x251)][_0x45b3ee(0x250)]||0x0),_0x4cbab7=_0x5211a9[_0x45b3ee(0x21d)]['_all'],_0x450d56=_0x4cbab7>0x0?_0x3533f2/_0x4cbab7*0x64:0x0;console[_0x45b3ee(0x1ed)](_0x45b3ee(0x214)),console[_0x45b3ee(0x1ed)]('\x20\x20\x20-\x20Total\x20Turnover:\x20'+_0x4d06e8),console[_0x45b3ee(0x1ed)]('\x20\x20\x20-\x20Total\x20Commission:\x20'+_0x1a791b),console['log'](_0x45b3ee(0x26d)+_0x4cbab7),console[_0x45b3ee(0x1ed)](_0x45b3ee(0x1e2)+_0x450d56+'%'),_0x5f47f1[_0x45b3ee(0x23a)]({'success':!![],'result':{'gatewayId':_0x289546,'totalTurnover':Number(_0x4d06e8['toFixed'](0x2)),'totalCommission':Number(_0x1a791b[_0x45b3ee(0x230)](0x2)),'successfulPayments':_0x4cbab7,'chargebackCount':_0x3533f2,'chargebackRate':Number(_0x450d56[_0x45b3ee(0x230)](0x2)),'refundCount':_0x2d4259}});}catch(_0x273bec){console[_0x45b3ee(0x233)](_0x45b3ee(0x1d0),_0x273bec),_0x424f7a(_0x273bec);}},this[_0x2a6356(0x20c)]=new adminService_1['AdminService'](),this[_0x2a6356(0x1d9)]=new paymentLinkService_1[(_0x2a6356(0x1f2))]();}}exports[a4_0x160a8c(0x1f7)]=AdminController;