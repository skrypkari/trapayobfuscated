'use strict';const a4_0x15625d=a4_0x44d4;(function(_0x4fd35f,_0x20ce93){const _0x4fc47c=a4_0x44d4,_0x3cb010=_0x4fd35f();while(!![]){try{const _0x45ada6=parseInt(_0x4fc47c(0x199))/0x1*(-parseInt(_0x4fc47c(0x154))/0x2)+-parseInt(_0x4fc47c(0x1af))/0x3+-parseInt(_0x4fc47c(0x1c8))/0x4*(-parseInt(_0x4fc47c(0x1ea))/0x5)+-parseInt(_0x4fc47c(0x16b))/0x6+parseInt(_0x4fc47c(0x196))/0x7+parseInt(_0x4fc47c(0x1ce))/0x8+-parseInt(_0x4fc47c(0x1ad))/0x9*(parseInt(_0x4fc47c(0x1a4))/0xa);if(_0x45ada6===_0x20ce93)break;else _0x3cb010['push'](_0x3cb010['shift']());}catch(_0x176b06){_0x3cb010['push'](_0x3cb010['shift']());}}}(a4_0x1963,0xdd3a6));var __createBinding=this&&this[a4_0x15625d(0x1ec)]||(Object[a4_0x15625d(0x1b4)]?function(_0x222fd3,_0x1462c9,_0x377a8,_0x598aec){const _0x19ba7c=a4_0x15625d;if(_0x598aec===undefined)_0x598aec=_0x377a8;var _0x4de832=Object['getOwnPropertyDescriptor'](_0x1462c9,_0x377a8);(!_0x4de832||('get'in _0x4de832?!_0x1462c9[_0x19ba7c(0x153)]:_0x4de832['writable']||_0x4de832[_0x19ba7c(0x15e)]))&&(_0x4de832={'enumerable':!![],'get':function(){return _0x1462c9[_0x377a8];}}),Object[_0x19ba7c(0x189)](_0x222fd3,_0x598aec,_0x4de832);}:function(_0x4af971,_0xff7d1c,_0x1ed9d4,_0x5103ee){if(_0x5103ee===undefined)_0x5103ee=_0x1ed9d4;_0x4af971[_0x5103ee]=_0xff7d1c[_0x1ed9d4];}),__setModuleDefault=this&&this[a4_0x15625d(0x1db)]||(Object[a4_0x15625d(0x1b4)]?function(_0x1a969e,_0x16f353){const _0x3607c0=a4_0x15625d;Object[_0x3607c0(0x189)](_0x1a969e,_0x3607c0(0x1e3),{'enumerable':!![],'value':_0x16f353});}:function(_0x51d7ed,_0x4db5ce){const _0x17293a=a4_0x15625d;_0x51d7ed[_0x17293a(0x1e3)]=_0x4db5ce;}),__importStar=this&&this[a4_0x15625d(0x1c9)]||(function(){var _0x488fa0=function(_0x45a168){const _0x286159=a4_0x44d4;return _0x488fa0=Object[_0x286159(0x185)]||function(_0x6e3775){const _0x3a23d4=_0x286159;var _0x5b75ad=[];for(var _0x29a542 in _0x6e3775)if(Object[_0x3a23d4(0x19f)][_0x3a23d4(0x1ac)]['call'](_0x6e3775,_0x29a542))_0x5b75ad[_0x5b75ad[_0x3a23d4(0x161)]]=_0x29a542;return _0x5b75ad;},_0x488fa0(_0x45a168);};return function(_0x4b50e1){const _0x1c4e6d=a4_0x44d4;if(_0x4b50e1&&_0x4b50e1[_0x1c4e6d(0x153)])return _0x4b50e1;var _0x331f83={};if(_0x4b50e1!=null){for(var _0x290c18=_0x488fa0(_0x4b50e1),_0x1bd478=0x0;_0x1bd478<_0x290c18[_0x1c4e6d(0x161)];_0x1bd478++)if(_0x290c18[_0x1bd478]!==_0x1c4e6d(0x1e3))__createBinding(_0x331f83,_0x4b50e1,_0x290c18[_0x1bd478]);}return __setModuleDefault(_0x331f83,_0x4b50e1),_0x331f83;};}()),__importDefault=this&&this[a4_0x15625d(0x1cf)]||function(_0x581459){return _0x581459&&_0x581459['__esModule']?_0x581459:{'default':_0x581459};};function a4_0x1963(){const _0x3c8c4f=['__esModule','14KEenNR','disable2FA','getPayoutById','ðŸ“Š\x20Admin\x20requesting\x20payout\x20reports:','getMerchantsAwaitingPayout','ðŸ§¹\x20Manual\x20PROCESSING\x20payment\x20cleanup\x20initiated\x20by\x20admin:\x20','getUsers','count','getAllPayments','PAID','configurable','getLoginLogs','\x20\x20\x20-\x20Total\x20Commission:\x20','length','hasPayoutHistory','getSystemStatistics','role','enableAdmin2FA','deletePayout','amountAfterGatewayCommissionUSDT','payouts','updateSettings','getUserById','5929068HFByOK','changeAdminPassword','paymentLinkService','activateUser','disableAdmin2FA','ðŸ“Š\x20[GATEWAY\x20STATS]\x20Gateway\x20ID\x20','getPayoutReports','month','log','getMerchantsSelection','errors','merchants','updateUser','refund','Failed\x20to\x20update\x20payment\x20link\x20counter:','Payment\x20not\x20found','shopId','paid','../services/telegramBotService','setupAdmin2FA','depositBalance','processed','User\x20deleted\x20successfully','\x20->\x20','updateGatewaySettings','desc','getOwnPropertyNames','chargeback','ðŸ”\x20[GATEWAY\x20STATS]\x20Sample\x20payments\x20for\x20','params','defineProperty','_sum','30d','\x20to\x20','adminService','ðŸ”„\x20Admin\x20updating\x20customer\x20data\x20for\x20payment\x20','ðŸ“±\x20Skipping\x20Telegram\x20notification\x20for\x20status\x20change\x20to:\x20','getPayments','telegramBotService','updatePaymentStatus','Payout\x20updated\x20successfully','User\x20not\x20found','expirePaymentLinks','10484551uVeaCw','json','suspendUser','188085ltYMui','enable2FA','Amount\x20must\x20be\x20greater\x20than\x200','user','updatePayout','_all','prototype','loginLog','cleanupStalePendingPayments','../services/adminService','_count','31490GVWRio','failed','getGatewaySettings','findMany','updateCustomerData','username','error','gateway','hasOwnProperty','1854bgdYBt','gatewaySettingsService','626403jhSJNu','then','User\x20suspended\x20successfully',',\x20sending\x20Telegram\x20notification','ðŸ“ˆ\x20[GATEWAY\x20STATS]\x20Calculated\x20statistics:','create','total','toUpperCase','sendPaymentNotification','\x20->\x20Gateway\x20Name:\x20','getStatistics','amountUSDT','FAILED','get2FASettings','\x20\x20\x20-\x20Total\x20Turnover:\x20','\x20status\x20changed\x20from\x20','getPayoutStats','../services/gatewaySettingsService','query','\x20to\x20PAID,\x20updating\x20payment\x20link\x20counter','getMerchantStatistics','ðŸ“±\x20Payment\x20','getProcessingPaymentsStats','âŒ\x20[GATEWAY\x20STATS]\x20Gateway\x20not\x20found\x20for\x20ID:\x20','ðŸ’°\x20[GATEWAY\x20STATS]\x20Paid\x20payments\x20result:','9332Xdypzk','__importStar','cleanupStalePaymentsWithReport','handleSuccessfulPayment','Payout\x20created\x20successfully','\x20\x20\x20-\x20Chargeback\x20Rate:\x20','7761496RqpiTJ','__importDefault','âœ…\x20Telegram\x20notification\x20sent\x20for\x20status\x20change:\x20','toFixed','true','Admin\x202FA\x20disabled\x20successfully','resolve','\x22\x20and\x20status=\x22PAID\x22','body','ðŸ“Š\x20Admin\x20requesting\x20merchant\x20statistics\x20with\x20filters:','deleteUser','CHARGEBACK','REFUND','__setModuleDefault','ðŸ”\x20[GATEWAY\x20STATS]\x20Querying\x20payments\x20with\x20gateway=\x22','expired','PROCESSING\x20payment\x20cleanup\x20completed\x20successfully','âŒ\x20[GATEWAY\x20STATS]\x20Error:','Customer\x20data\x20updated\x20successfully','cleanupStaleProcessingPayments','ceil','default','PENDING\x20payment\x20cleanup\x20completed\x20successfully','status','users','../config/database','AdminController','updatePayment','3430UUnRAh','pagination','__createBinding','stringify','payment','User\x20created\x20successfully','AdminService','ðŸ“Š\x20Manual\x20payment\x20cleanup\x20(PROCESSING\x20+\x20PENDING)\x20with\x20report\x20initiated\x20by\x20admin:\x20','setup2FA','createdAt','processing','getPaymentById','ðŸ”™\x20[GATEWAY\x20STATS]\x20Chargeback\x20count:\x20','paymentCleanupService','â°\x20Manual\x20PENDING\x20payment\x20cleanup\x20initiated\x20by\x20admin:\x20','PROCESSING','expireSinglePaymentLinks','2FA\x20disabled\x20successfully','createPayout','âœ…\x20Payment\x20link\x20counter\x20updated\x20for\x20payment\x20','User\x20activated\x20successfully','statistics','getPayouts','../types/gateway','Payment\x20cleanup\x20(PROCESSING\x20+\x20PENDING)\x20with\x20report\x20completed\x20successfully','getShopWallets','\x20\x20\x20-\x20Successful\x20Payments:\x20'];a4_0x1963=function(){return _0x3c8c4f;};return a4_0x1963();}Object[a4_0x15625d(0x189)](exports,'__esModule',{'value':!![]}),exports[a4_0x15625d(0x1e8)]=void 0x0;const adminService_1=require(a4_0x15625d(0x1a2)),paymentLinkService_1=require('../services/paymentLinkService'),paymentCleanupService_1=require('../services/paymentCleanupService'),telegramBotService_1=require(a4_0x15625d(0x17d)),gatewaySettingsService_1=require(a4_0x15625d(0x1c0)),database_1=__importDefault(require(a4_0x15625d(0x1e7)));function a4_0x44d4(_0x2cf965,_0x439b14){_0x2cf965=_0x2cf965-0x13c;const _0x196340=a4_0x1963();let _0x44d48a=_0x196340[_0x2cf965];return _0x44d48a;}class AdminController{constructor(){const _0x27f100=a4_0x15625d;this['checkAuth']=async(_0x2e8d5c,_0x83ae4c,_0xcb608c)=>{const _0x989f19=a4_0x44d4;try{const _0x359287=_0x2e8d5c[_0x989f19(0x19c)];_0x83ae4c[_0x989f19(0x197)]({'success':!![],'message':'Admin\x20access\x20confirmed','user':{'id':_0x359287?.['id'],'username':_0x359287?.[_0x989f19(0x1a9)],'role':_0x359287?.[_0x989f19(0x164)]}});}catch(_0x52ee36){_0xcb608c(_0x52ee36);}},this[_0x27f100(0x1b9)]=async(_0x4a71b6,_0xdedcec,_0x59593f)=>{const _0xd8a11a=_0x27f100;try{const {period:period=_0xd8a11a(0x18b),currentDate:_0x30ec55}=_0x4a71b6[_0xd8a11a(0x1c1)],_0x1acb6e=await this[_0xd8a11a(0x18d)][_0xd8a11a(0x163)](period,_0x30ec55);_0xdedcec['json']({'success':!![],'result':_0x1acb6e});}catch(_0x389a56){_0x59593f(_0x389a56);}},this[_0x27f100(0x1c3)]=async(_0x2eeb11,_0x12770a,_0x178273)=>{const _0x2453fe=_0x27f100;try{const {shopId:_0x23ac16,period:period=_0x2453fe(0x172),dateFrom:_0x4daf3a,dateTo:_0x37686d}=_0x2eeb11[_0x2453fe(0x1c1)],_0x1ebae3={'shopId':_0x23ac16,'period':period,'dateFrom':_0x4daf3a,'dateTo':_0x37686d};console[_0x2453fe(0x173)](_0x2453fe(0x1d7),_0x1ebae3);const _0x3a862d=await this[_0x2453fe(0x18d)]['getMerchantStatistics'](_0x1ebae3);_0x12770a[_0x2453fe(0x197)]({'success':!![],'result':_0x3a862d});}catch(_0xea04b9){_0x178273(_0xea04b9);}},this[_0x27f100(0x171)]=async(_0x482a68,_0x4d8aff,_0x5c2ce8)=>{const _0x4ee262=_0x27f100;try{const {periodFrom:_0x41dbf6,periodTo:_0x74654,gateway:_0xed76c3}=_0x482a68['query'];if(!_0x41dbf6||!_0x74654||!_0xed76c3)return _0x4d8aff[_0x4ee262(0x1e5)](0x190)[_0x4ee262(0x197)]({'success':![],'message':'periodFrom,\x20periodTo,\x20and\x20gateway\x20are\x20required'});console[_0x4ee262(0x173)](_0x4ee262(0x157),{'periodFrom':_0x41dbf6,'periodTo':_0x74654,'gateway':_0xed76c3});const _0x541159=await this['adminService'][_0x4ee262(0x171)]({'periodFrom':_0x41dbf6,'periodTo':_0x74654,'gateway':_0xed76c3});_0x4d8aff[_0x4ee262(0x197)]({'success':!![],'reports':_0x541159});}catch(_0x25412f){_0x5c2ce8(_0x25412f);}},this['getPayoutStats']=async(_0x15b38b,_0x46ce1c,_0x59c507)=>{const _0x113027=_0x27f100;try{const _0x3bd3d2=await this[_0x113027(0x18d)][_0x113027(0x1bf)]();_0x46ce1c[_0x113027(0x197)]({'success':!![],'result':_0x3bd3d2});}catch(_0x546adb){_0x59c507(_0x546adb);}},this['getMerchantsAwaitingPayout']=async(_0x506298,_0x31eda2,_0x825735)=>{const _0x5354cf=_0x27f100;try{const {page:page=0x1,limit:limit=0x14,minAmount:_0x3de4e6,search:_0x1a0c42}=_0x506298['query'],_0x5dadc7={'page':Number(page),'limit':Number(limit),'minAmount':_0x3de4e6?Number(_0x3de4e6):undefined,'search':_0x1a0c42},_0x4a48b3=await this['adminService'][_0x5354cf(0x158)](_0x5dadc7);_0x31eda2[_0x5354cf(0x197)]({'success':!![],'merchants':_0x4a48b3[_0x5354cf(0x176)],'pagination':_0x4a48b3[_0x5354cf(0x1eb)],'summary':_0x4a48b3['summary']});}catch(_0x478817){_0x825735(_0x478817);}},this['getMerchantsSelection']=async(_0x262996,_0x14c357,_0x27965e)=>{const _0x4988de=_0x27f100;try{const _0x22c7e4=_0x262996[_0x4988de(0x1c1)][_0x4988de(0x162)]===_0x4988de(0x1d2),_0x453dd5=await this[_0x4988de(0x18d)][_0x4988de(0x174)](_0x22c7e4);_0x14c357[_0x4988de(0x197)]({'success':!![],'result':_0x453dd5});}catch(_0x4300eb){_0x27965e(_0x4300eb);}},this[_0x27f100(0x14a)]=async(_0x1312f4,_0x1d105e,_0x39019b)=>{const _0x2ea723=_0x27f100;try{const _0x2a1de8=_0x1312f4['body'];console['log']('ðŸŽ¯\x20[CONTROLLER]\x20Creating\x20payout\x20with\x20data:',_0x2a1de8);const _0x3396a7=await this[_0x2ea723(0x18d)][_0x2ea723(0x14a)](_0x2a1de8);_0x1d105e[_0x2ea723(0x1e5)](0xc9)[_0x2ea723(0x197)]({'success':!![],'message':_0x2ea723(0x1cc),'result':_0x3396a7});}catch(_0xb06b67){_0x39019b(_0xb06b67);}},this[_0x27f100(0x19d)]=async(_0x363bf5,_0x2880be,_0x558b91)=>{const _0x426e81=_0x27f100;try{const {id:_0x1c6b27}=_0x363bf5[_0x426e81(0x188)],_0x4bc045=_0x363bf5[_0x426e81(0x1d6)];console['log']('ðŸŽ¯\x20[CONTROLLER]\x20Updating\x20payout\x20'+_0x1c6b27+'\x20with\x20data:',_0x4bc045);const _0x1a635b=await this[_0x426e81(0x18d)]['updatePayout'](_0x1c6b27,_0x4bc045);_0x2880be[_0x426e81(0x197)]({'success':!![],'message':_0x426e81(0x193),'result':_0x1a635b});}catch(_0x2123eb){_0x558b91(_0x2123eb);}},this[_0x27f100(0x14e)]=async(_0x5a3d1b,_0x459ae4,_0x3d3d97)=>{const _0x5d45b7=_0x27f100;try{const {page:page=0x1,limit:limit=0x14,shopId:_0x112cff,network:_0x18752d,dateFrom:_0x9ed55,dateTo:_0x54ab09,search:_0x438142}=_0x5a3d1b[_0x5d45b7(0x1c1)],_0x53ba3e={'page':Number(page),'limit':Number(limit),'shopId':_0x112cff,'network':_0x18752d,'dateFrom':_0x9ed55,'dateTo':_0x54ab09,'search':_0x438142},_0x46848e=await this['adminService']['getAllPayouts'](_0x53ba3e);_0x459ae4[_0x5d45b7(0x197)]({'success':!![],'payouts':_0x46848e[_0x5d45b7(0x168)],'pagination':_0x46848e[_0x5d45b7(0x1eb)]});}catch(_0x273647){_0x3d3d97(_0x273647);}},this[_0x27f100(0x156)]=async(_0x5b0134,_0x3eb88f,_0x3dbf67)=>{const _0x56a89e=_0x27f100;try{const {id:_0x2015c3}=_0x5b0134[_0x56a89e(0x188)],_0x5b188b=await this[_0x56a89e(0x18d)][_0x56a89e(0x156)](_0x2015c3);if(!_0x5b188b)return _0x3eb88f[_0x56a89e(0x1e5)](0x194)['json']({'success':![],'message':'Payout\x20not\x20found'});_0x3eb88f['json']({'success':!![],'result':_0x5b188b});}catch(_0x253ef0){_0x3dbf67(_0x253ef0);}},this[_0x27f100(0x166)]=async(_0x19dac3,_0x5aee9a,_0x594ff5)=>{const _0x1fe9e9=_0x27f100;try{const {id:_0x9fc856}=_0x19dac3[_0x1fe9e9(0x188)];await this[_0x1fe9e9(0x18d)][_0x1fe9e9(0x166)](_0x9fc856),_0x5aee9a[_0x1fe9e9(0x197)]({'success':!![],'message':'Payout\x20deleted\x20successfully'});}catch(_0x36522b){_0x594ff5(_0x36522b);}},this[_0x27f100(0x190)]=async(_0xf7898d,_0x199cac,_0x458973)=>{const _0x5acf30=_0x27f100;try{const {page:page=0x1,limit:limit=0x14,status:_0x54e0c8,gateway:_0x4095bb,shopId:_0x7acaff,dateFrom:_0x4c28ce,dateTo:_0x30a675,search:_0xa9aa6f,currency:_0x2c613e,sortBy:_0x358035,sortOrder:_0x10252d}=_0xf7898d['query'],_0x4dc57e={'page':Number(page),'limit':Number(limit),'status':_0x54e0c8,'gateway':_0x4095bb,'shopId':_0x7acaff,'dateFrom':_0x4c28ce,'dateTo':_0x30a675,'search':_0xa9aa6f,'currency':_0x2c613e,'sortBy':_0x358035,'sortOrder':_0x10252d},_0x31635f=await this[_0x5acf30(0x18d)][_0x5acf30(0x15c)](_0x4dc57e);_0x199cac[_0x5acf30(0x197)]({'success':!![],'payments':_0x31635f['payments'],'pagination':_0x31635f[_0x5acf30(0x1eb)],'statistics':_0x31635f[_0x5acf30(0x14d)]});}catch(_0x17f4d0){_0x458973(_0x17f4d0);}},this[_0x27f100(0x143)]=async(_0x32f72b,_0x4299e4,_0x8d97ae)=>{const _0x5286df=_0x27f100;try{const {id:_0xc46ab4}=_0x32f72b[_0x5286df(0x188)],_0x122dd5=await this[_0x5286df(0x18d)]['getPaymentById'](_0xc46ab4);if(!_0x122dd5)return _0x4299e4[_0x5286df(0x1e5)](0x194)[_0x5286df(0x197)]({'success':![],'message':_0x5286df(0x17a)});_0x4299e4[_0x5286df(0x197)]({'success':!![],'result':_0x122dd5});}catch(_0x4642d3){_0x8d97ae(_0x4642d3);}},this[_0x27f100(0x1e9)]=async(_0x13cc05,_0x531889,_0x5a03e5)=>{const _0x2fbcce=_0x27f100;try{const {id:_0xe531bf}=_0x13cc05['params'],{status:_0x55d0b4,notes:_0x5262e4,chargebackAmount:_0x2ca524}=_0x13cc05['body'],_0x2c8e4e=await this[_0x2fbcce(0x18d)][_0x2fbcce(0x143)](_0xe531bf);if(!_0x2c8e4e)return _0x531889['status'](0x194)[_0x2fbcce(0x197)]({'success':![],'message':_0x2fbcce(0x17a)});const _0x1c073b=await this[_0x2fbcce(0x18d)][_0x2fbcce(0x192)](_0xe531bf,_0x55d0b4,_0x5262e4,_0x2ca524);if(_0x2c8e4e[_0x2fbcce(0x1e5)]!==_0x55d0b4&&_0x55d0b4[_0x2fbcce(0x1b6)]()==='PAID'){console[_0x2fbcce(0x173)]('ðŸ“ˆ\x20Admin\x20changed\x20payment\x20'+_0xe531bf+_0x2fbcce(0x1c2));try{await this['paymentLinkService'][_0x2fbcce(0x1cb)](_0xe531bf),console[_0x2fbcce(0x173)](_0x2fbcce(0x14b)+_0xe531bf);}catch(_0x50cbc2){console['error'](_0x2fbcce(0x179),_0x50cbc2);}}if(_0x2c8e4e['status']!==_0x55d0b4){console[_0x2fbcce(0x173)](_0x2fbcce(0x1c4)+_0xe531bf+_0x2fbcce(0x1be)+_0x2c8e4e[_0x2fbcce(0x1e5)]+_0x2fbcce(0x18c)+_0x55d0b4+_0x2fbcce(0x1b2));try{let _0x5c2f7d;switch(_0x55d0b4['toUpperCase']()){case _0x2fbcce(0x15d):_0x5c2f7d=_0x2fbcce(0x17c);break;case _0x2fbcce(0x147):_0x5c2f7d=_0x2fbcce(0x142);break;case _0x2fbcce(0x1bb):_0x5c2f7d='failed';break;case'EXPIRED':_0x5c2f7d=_0x2fbcce(0x1dd);break;case'REFUND':_0x5c2f7d=_0x2fbcce(0x178);break;case _0x2fbcce(0x1d9):_0x5c2f7d=_0x2fbcce(0x186);break;default:console[_0x2fbcce(0x173)](_0x2fbcce(0x18f)+_0x55d0b4);break;}if(_0x5c2f7d){const _0x1bcbfe={..._0x1c073b,'shopId':_0x2c8e4e[_0x2fbcce(0x17b)],'gateway':_0x2c8e4e[_0x2fbcce(0x1ab)],'createdAt':_0x2c8e4e[_0x2fbcce(0x141)],'chargebackAmount':_0x2ca524};await telegramBotService_1[_0x2fbcce(0x191)][_0x2fbcce(0x1b7)](_0x2c8e4e[_0x2fbcce(0x17b)],_0x1bcbfe,_0x5c2f7d),console[_0x2fbcce(0x173)](_0x2fbcce(0x1d0)+_0x2c8e4e[_0x2fbcce(0x1e5)]+_0x2fbcce(0x182)+_0x55d0b4);}}catch(_0x1fce43){console['error']('Failed\x20to\x20send\x20Telegram\x20notification\x20for\x20status\x20change:',_0x1fce43);}}_0x531889[_0x2fbcce(0x197)]({'success':!![],'message':'Payment\x20updated\x20successfully','result':_0x1c073b});}catch(_0x479b2a){_0x5a03e5(_0x479b2a);}},this[_0x27f100(0x1a8)]=async(_0x49d178,_0x555e3c,_0x62a928)=>{const _0xaa421b=_0x27f100;try{const {id:_0x3e3c4f}=_0x49d178[_0xaa421b(0x188)],_0x150ffb=_0x49d178[_0xaa421b(0x1d6)];console[_0xaa421b(0x173)](_0xaa421b(0x18e)+_0x3e3c4f+':',_0x150ffb);const _0x3095f9=await this[_0xaa421b(0x18d)][_0xaa421b(0x1a8)](_0x3e3c4f,_0x150ffb);_0x555e3c[_0xaa421b(0x197)]({'success':!![],'message':_0xaa421b(0x1e0),'result':_0x3095f9});}catch(_0x21080c){_0x62a928(_0x21080c);}},this[_0x27f100(0x177)]=async(_0x440dbc,_0x2f0a37,_0x1ad2ea)=>{const _0xa3e81f=_0x27f100;try{const {id:_0x24ee2a}=_0x440dbc[_0xa3e81f(0x188)],_0x40bc2e=_0x440dbc[_0xa3e81f(0x1d6)],_0x49abe3=await this[_0xa3e81f(0x18d)][_0xa3e81f(0x177)](_0x24ee2a,_0x40bc2e);_0x2f0a37['json']({'success':!![],'message':'User\x20updated\x20successfully','result':_0x49abe3});}catch(_0x3d6d47){_0x1ad2ea(_0x3d6d47);}},this[_0x27f100(0x198)]=async(_0x435a06,_0x17ac78,_0x175887)=>{const _0x361dcf=_0x27f100;try{const {id:_0x23cd94}=_0x435a06[_0x361dcf(0x188)],_0x1f5678=await this[_0x361dcf(0x18d)][_0x361dcf(0x198)](_0x23cd94);_0x17ac78['json']({'success':!![],'message':_0x361dcf(0x1b1),'result':_0x1f5678});}catch(_0x3be527){_0x175887(_0x3be527);}},this[_0x27f100(0x16e)]=async(_0x121e6b,_0x2c5df3,_0x202ebd)=>{const _0x1cebbe=_0x27f100;try{const {id:_0x2724e7}=_0x121e6b['params'],_0x5be769=await this[_0x1cebbe(0x18d)][_0x1cebbe(0x16e)](_0x2724e7);_0x2c5df3[_0x1cebbe(0x197)]({'success':!![],'message':_0x1cebbe(0x14c),'result':_0x5be769});}catch(_0x50b8cb){_0x202ebd(_0x50b8cb);}},this[_0x27f100(0x15a)]=async(_0x81a301,_0x34a34c,_0x1e249c)=>{const _0x598704=_0x27f100;try{const {page:page=0x1,limit:limit=0x14,status:_0x3beda7,search:_0x2ad64f}=_0x81a301[_0x598704(0x1c1)],_0x1a1f02={'page':Number(page),'limit':Number(limit),'status':_0x3beda7,'search':_0x2ad64f},_0x1cf1e7=await this[_0x598704(0x18d)]['getAllUsers'](_0x1a1f02);_0x34a34c[_0x598704(0x197)]({'success':!![],'users':_0x1cf1e7[_0x598704(0x1e6)],'pagination':_0x1cf1e7[_0x598704(0x1eb)]});}catch(_0x2c1199){_0x1e249c(_0x2c1199);}},this[_0x27f100(0x16a)]=async(_0x2c9436,_0x37e69b,_0x1757d2)=>{const _0x12e080=_0x27f100;try{const {id:_0x54c46c}=_0x2c9436[_0x12e080(0x188)],_0x41ea71=await this[_0x12e080(0x18d)]['getUserById'](_0x54c46c);if(!_0x41ea71)return _0x37e69b[_0x12e080(0x1e5)](0x194)[_0x12e080(0x197)]({'success':![],'message':_0x12e080(0x194)});_0x37e69b['json']({'success':!![],'result':_0x41ea71});}catch(_0x24fd76){_0x1757d2(_0x24fd76);}},this['createUser']=async(_0x1c10b3,_0xda31b9,_0x561d32)=>{const _0x22ab8a=_0x27f100;try{const _0x303a8f=_0x1c10b3['body'],_0x5f22d5=await this[_0x22ab8a(0x18d)]['createUser'](_0x303a8f);_0xda31b9['status'](0xc9)[_0x22ab8a(0x197)]({'success':!![],'message':_0x22ab8a(0x13d),'result':_0x5f22d5});}catch(_0x4a5232){_0x561d32(_0x4a5232);}},this[_0x27f100(0x1d8)]=async(_0x5b14c4,_0x255580,_0x2bba31)=>{const _0x36bb8b=_0x27f100;try{const {id:_0x323e57}=_0x5b14c4[_0x36bb8b(0x188)],{twoFactorToken:_0x13117b}=_0x5b14c4[_0x36bb8b(0x1d6)];await this[_0x36bb8b(0x18d)][_0x36bb8b(0x1d8)](_0x323e57,_0x13117b),_0x255580[_0x36bb8b(0x197)]({'success':!![],'message':_0x36bb8b(0x181)});}catch(_0x517b90){_0x2bba31(_0x517b90);}},this[_0x27f100(0x151)]=async(_0xa0db32,_0x2de3dc,_0x5cd3d2)=>{const _0x25b513=_0x27f100;try{const {shopId:_0x132239}=_0xa0db32[_0x25b513(0x188)],_0x87022a=await this[_0x25b513(0x18d)]['getShopWallets'](_0x132239);_0x2de3dc['json']({'success':!![],'wallets':_0x87022a});}catch(_0x2b46be){_0x5cd3d2(_0x2b46be);}},this[_0x27f100(0x140)]=async(_0x266f29,_0x3dcdd6,_0x1fbe36)=>{const _0x392dab=_0x27f100;try{const {shopId:_0x37e353}=_0x266f29['params'],_0x458807=await this[_0x392dab(0x18d)][_0x392dab(0x140)](_0x37e353);_0x3dcdd6[_0x392dab(0x197)]({'success':!![],'result':_0x458807});}catch(_0x485f3b){_0x1fbe36(_0x485f3b);}},this[_0x27f100(0x19a)]=async(_0x3c1528,_0x3afea1,_0x390f36)=>{const _0x26f73f=_0x27f100;try{const {shopId:_0x1691ca}=_0x3c1528['params'],{token:_0x382f59}=_0x3c1528[_0x26f73f(0x1d6)];if(!_0x382f59)return _0x3afea1[_0x26f73f(0x1e5)](0x190)[_0x26f73f(0x197)]({'success':![],'message':'Token\x20is\x20required'});const _0x2ba15a=await this['adminService']['enable2FA'](_0x1691ca,_0x382f59);_0x3afea1[_0x26f73f(0x197)]({'success':!![],'message':'2FA\x20enabled\x20successfully','result':_0x2ba15a});}catch(_0x71bbb){_0x390f36(_0x71bbb);}},this[_0x27f100(0x155)]=async(_0x231318,_0x37fcc2,_0x41cdb8)=>{const _0x26e41f=_0x27f100;try{const {shopId:_0x592e3e}=_0x231318['params'];await this[_0x26e41f(0x18d)][_0x26e41f(0x155)](_0x592e3e),_0x37fcc2[_0x26e41f(0x197)]({'success':!![],'message':_0x26e41f(0x149)});}catch(_0x2ab579){_0x41cdb8(_0x2ab579);}},this[_0x27f100(0x1c5)]=async(_0x1271af,_0x2f3131,_0x20c9b1)=>{const _0x1b094e=_0x27f100;try{const _0x57d52b=await paymentCleanupService_1[_0x1b094e(0x145)][_0x1b094e(0x1c5)]();_0x2f3131[_0x1b094e(0x197)]({'success':!![],'result':_0x57d52b});}catch(_0x5372ca){_0x20c9b1(_0x5372ca);}},this['cleanupStalePayments']=async(_0xff1704,_0x204d4e,_0x51a976)=>{const _0x4d6c92=_0x27f100;try{console[_0x4d6c92(0x173)](_0x4d6c92(0x159)+_0xff1704[_0x4d6c92(0x19c)]?.['username']+'\x20('+_0xff1704[_0x4d6c92(0x19c)]?.['id']+')');const _0x29716f=await paymentCleanupService_1[_0x4d6c92(0x145)][_0x4d6c92(0x1e1)]();_0x204d4e[_0x4d6c92(0x197)]({'success':!![],'message':_0x4d6c92(0x1de),'result':{'processed':_0x29716f['processed'],'failed':_0x29716f[_0x4d6c92(0x1a5)],'errors':_0x29716f[_0x4d6c92(0x175)]}});}catch(_0x2294ba){_0x51a976(_0x2294ba);}},this[_0x27f100(0x1a1)]=async(_0x5699cc,_0x56be4e,_0x2b92bb)=>{const _0x3ba410=_0x27f100;try{console[_0x3ba410(0x173)](_0x3ba410(0x146)+_0x5699cc[_0x3ba410(0x19c)]?.[_0x3ba410(0x1a9)]+'\x20('+_0x5699cc['user']?.['id']+')');const _0x5a7ff2=await paymentCleanupService_1[_0x3ba410(0x145)]['cleanupStalePendingPayments']();_0x56be4e[_0x3ba410(0x197)]({'success':!![],'message':_0x3ba410(0x1e4),'result':{'processed':_0x5a7ff2[_0x3ba410(0x180)],'failed':_0x5a7ff2[_0x3ba410(0x1a5)],'errors':_0x5a7ff2[_0x3ba410(0x175)]}});}catch(_0x7fea98){_0x2b92bb(_0x7fea98);}},this[_0x27f100(0x1ca)]=async(_0x56c3b6,_0xbc3a41,_0x2e9b9d)=>{const _0x7d72a5=_0x27f100;try{console[_0x7d72a5(0x173)](_0x7d72a5(0x13f)+_0x56c3b6[_0x7d72a5(0x19c)]?.[_0x7d72a5(0x1a9)]+'\x20('+_0x56c3b6[_0x7d72a5(0x19c)]?.['id']+')');const _0x27219e=await paymentCleanupService_1[_0x7d72a5(0x145)]['getProcessingPaymentsStats'](),_0x4fa1e8=await paymentCleanupService_1['paymentCleanupService'][_0x7d72a5(0x1e1)](),_0x2d1089=await paymentCleanupService_1[_0x7d72a5(0x145)][_0x7d72a5(0x1a1)](),_0xa7ed39=await paymentCleanupService_1[_0x7d72a5(0x145)][_0x7d72a5(0x1c5)]();_0xbc3a41[_0x7d72a5(0x197)]({'success':!![],'message':_0x7d72a5(0x150),'result':{'cleanup':{'processing':{'processed':_0x4fa1e8[_0x7d72a5(0x180)],'failed':_0x4fa1e8[_0x7d72a5(0x1a5)],'errors':_0x4fa1e8[_0x7d72a5(0x175)]},'pending':{'processed':_0x2d1089[_0x7d72a5(0x180)],'failed':_0x2d1089['failed'],'errors':_0x2d1089[_0x7d72a5(0x175)]},'total':{'processed':_0x4fa1e8[_0x7d72a5(0x180)]+_0x2d1089[_0x7d72a5(0x180)],'failed':_0x4fa1e8['failed']+_0x2d1089[_0x7d72a5(0x1a5)],'errors':[..._0x4fa1e8[_0x7d72a5(0x175)],..._0x2d1089['errors']]}},'statistics':{'before':_0x27219e,'after':_0xa7ed39,'reduced':_0x27219e[_0x7d72a5(0x1b5)]-_0xa7ed39[_0x7d72a5(0x1b5)]}}});}catch(_0x5c9418){_0x2e9b9d(_0x5c9418);}},this[_0x27f100(0x195)]=async(_0x816e9e,_0x5689fe,_0x415bec)=>{const _0x5ad919=_0x27f100;try{const _0x3c99e6=await paymentCleanupService_1[_0x5ad919(0x145)][_0x5ad919(0x148)]();_0x5689fe[_0x5ad919(0x197)]({'success':!![],'message':'Payment\x20link\x20expiration\x20check\x20completed\x20successfully','result':{'expired':_0x3c99e6[_0x5ad919(0x1dd)],'errors':_0x3c99e6[_0x5ad919(0x175)]}});}catch(_0x1e7232){_0x415bec(_0x1e7232);}},this[_0x27f100(0x16c)]=async(_0x41313c,_0x20d318,_0x5311d6)=>{const _0x3738c5=_0x27f100;try{const {currentPassword:_0x2c8e86,newPassword:_0x4c03ba,confirmNewPassword:_0x37525,twoFactorToken:_0x29f2be}=_0x41313c['body'];await this[_0x3738c5(0x18d)][_0x3738c5(0x16c)](_0x2c8e86,_0x4c03ba,_0x37525,_0x29f2be),_0x20d318[_0x3738c5(0x197)]({'success':!![],'message':'Admin\x20password\x20changed\x20successfully'});}catch(_0x2051c4){_0x5311d6(_0x2051c4);}},this[_0x27f100(0x1bc)]=async(_0x19b5fb,_0x4a0474,_0x49cafd)=>{const _0xdab711=_0x27f100;try{const _0x133728=await this[_0xdab711(0x18d)][_0xdab711(0x1bc)]();_0x4a0474[_0xdab711(0x197)]({'success':!![],'result':_0x133728});}catch(_0x1c4135){_0x49cafd(_0x1c4135);}},this[_0x27f100(0x17e)]=async(_0x77a65f,_0x562ad9,_0x467414)=>{const _0x50edba=_0x27f100;try{const _0x33fde2=await this['adminService'][_0x50edba(0x17e)]();_0x562ad9[_0x50edba(0x197)]({'success':!![],'result':_0x33fde2});}catch(_0x2abdfc){_0x467414(_0x2abdfc);}},this[_0x27f100(0x165)]=async(_0x12d5bc,_0x3e958c,_0x1f8dd8)=>{const _0x4aed5e=_0x27f100;try{const {token:_0x1adfc2}=_0x12d5bc[_0x4aed5e(0x1d6)],_0x152cd9=await this[_0x4aed5e(0x18d)][_0x4aed5e(0x165)](_0x1adfc2);_0x3e958c['json']({'success':!![],'result':_0x152cd9});}catch(_0x218d2c){_0x1f8dd8(_0x218d2c);}},this[_0x27f100(0x16f)]=async(_0x36b905,_0x30c134,_0xfef84c)=>{const _0x5f5c45=_0x27f100;try{await this[_0x5f5c45(0x18d)][_0x5f5c45(0x16f)](),_0x30c134[_0x5f5c45(0x197)]({'success':!![],'message':_0x5f5c45(0x1d3)});}catch(_0x4fabd7){_0xfef84c(_0x4fabd7);}},this[_0x27f100(0x17f)]=async(_0x246bb5,_0x171e09,_0x3f31af)=>{const _0x1b96b9=_0x27f100;try{const {shopId:_0x3046d2,amount:_0x26ff2a,notes:_0xf457c1}=_0x246bb5[_0x1b96b9(0x1d6)];if(!_0x3046d2||!_0x26ff2a)return _0x171e09[_0x1b96b9(0x1e5)](0x190)['json']({'success':![],'message':'shopId\x20and\x20amount\x20are\x20required'});if(_0x26ff2a<=0x0)return _0x171e09['status'](0x190)[_0x1b96b9(0x197)]({'success':![],'message':_0x1b96b9(0x19b)});await this[_0x1b96b9(0x18d)][_0x1b96b9(0x17f)](_0x3046d2,_0x26ff2a,_0xf457c1),_0x171e09[_0x1b96b9(0x197)]({'success':!![],'message':'Balance\x20deposited\x20successfully'});}catch(_0x53c2dc){_0x3f31af(_0x53c2dc);}},this[_0x27f100(0x15f)]=async(_0x2ebe57,_0x2cec1d,_0x15d4dc)=>{const _0x4ad447=_0x27f100;try{const {shopId:_0x20db3a}=_0x2ebe57[_0x4ad447(0x188)],{page:page='1',limit:limit='20'}=_0x2ebe57[_0x4ad447(0x1c1)],_0x4fd9d4=(await Promise[_0x4ad447(0x1d4)]()[_0x4ad447(0x1b0)](()=>__importStar(require('../config/database'))))[_0x4ad447(0x1e3)],_0x108fbd=parseInt(page,0xa),_0x564eb7=parseInt(limit,0xa),_0x4627e4=(_0x108fbd-0x1)*_0x564eb7,[_0x50b613,_0xbc8184]=await Promise['all']([_0x4fd9d4[_0x4ad447(0x1a0)][_0x4ad447(0x1a7)]({'where':{'shopId':_0x20db3a},'orderBy':{'createdAt':_0x4ad447(0x184)},'skip':_0x4627e4,'take':_0x564eb7}),_0x4fd9d4[_0x4ad447(0x1a0)][_0x4ad447(0x15b)]({'where':{'shopId':_0x20db3a}})]);_0x2cec1d['json']({'success':!![],'result':{'logs':_0x50b613,'pagination':{'page':_0x108fbd,'limit':_0x564eb7,'total':_0xbc8184,'totalPages':Math[_0x4ad447(0x1e2)](_0xbc8184/_0x564eb7)}}});}catch(_0x2ff74b){_0x15d4dc(_0x2ff74b);}},this[_0x27f100(0x1a6)]=async(_0x358740,_0x313b88,_0x3f36c5)=>{const _0x43d776=_0x27f100;try{const _0x3e5e34=gatewaySettingsService_1[_0x43d776(0x1ae)]['getAllGatewaysWithSettings']();_0x313b88[_0x43d776(0x197)]({'success':!![],'result':_0x3e5e34});}catch(_0x192e3d){_0x3f36c5(_0x192e3d);}},this[_0x27f100(0x183)]=async(_0x35c582,_0x5008e9,_0x143347)=>{const _0x22d918=_0x27f100;try{const {gatewayId:_0x942057}=_0x35c582['params'],{minAmount:_0x17ada3,maxAmount:_0x2e083f,payoutDelay:_0x3d2466,gatewayCommission:_0x53b526}=_0x35c582[_0x22d918(0x1d6)],_0x5eab5e=gatewaySettingsService_1[_0x22d918(0x1ae)][_0x22d918(0x169)](_0x942057,{'minAmount':_0x17ada3!==undefined?Number(_0x17ada3):undefined,'maxAmount':_0x2e083f!==undefined?Number(_0x2e083f):undefined,'payoutDelay':_0x3d2466!==undefined?Number(_0x3d2466):undefined,'gatewayCommission':_0x53b526!==undefined?Number(_0x53b526):undefined});_0x5008e9[_0x22d918(0x197)]({'success':!![],'message':'Gateway\x20settings\x20updated\x20successfully','result':_0x5eab5e});}catch(_0x52cbc0){_0x143347(_0x52cbc0);}},this['getGatewayStatistics']=async(_0x519370,_0x3a852e,_0x266c96)=>{const _0xe25428=_0x27f100;try{const {gatewayId:_0x3b3352}=_0x519370[_0xe25428(0x188)];console['log']('ðŸ“Š\x20[GATEWAY\x20STATS]\x20Requesting\x20statistics\x20for\x20gateway\x20ID:\x20'+_0x3b3352);const {GATEWAY_ID_MAP:_0x38bc71}=await Promise[_0xe25428(0x1d4)]()['then'](()=>__importStar(require(_0xe25428(0x14f)))),_0x1d6846=_0x38bc71[_0x3b3352];console[_0xe25428(0x173)](_0xe25428(0x170)+_0x3b3352+_0xe25428(0x1b8)+_0x1d6846);if(!_0x1d6846)return console[_0xe25428(0x173)](_0xe25428(0x1c6)+_0x3b3352),_0x3a852e[_0xe25428(0x1e5)](0x194)[_0xe25428(0x197)]({'success':![],'message':'Gateway\x20not\x20found'});console['log'](_0xe25428(0x1dc)+_0x1d6846+_0xe25428(0x1d5));const _0x52d3ee=await database_1['default'][_0xe25428(0x13c)][_0xe25428(0x1a7)]({'where':{'gateway':_0x1d6846},'select':{'id':!![],'status':!![],'amountUSDT':!![]},'take':0x5});console[_0xe25428(0x173)](_0xe25428(0x187)+_0x1d6846+':',JSON[_0xe25428(0x1ed)](_0x52d3ee,null,0x2));const _0x5029cf=await database_1['default'][_0xe25428(0x13c)]['aggregate']({'where':{'gateway':_0x1d6846,'status':'PAID'},'_sum':{'amountUSDT':!![],'amountAfterGatewayCommissionUSDT':!![]},'_count':{'_all':!![]}});console[_0xe25428(0x173)](_0xe25428(0x1c7),JSON[_0xe25428(0x1ed)](_0x5029cf,null,0x2));const _0xb7230e=await database_1[_0xe25428(0x1e3)]['payment'][_0xe25428(0x15b)]({'where':{'gateway':_0x1d6846,'status':'CHARGEBACK'}});console[_0xe25428(0x173)](_0xe25428(0x144)+_0xb7230e);const _0x2a4f7e=await database_1[_0xe25428(0x1e3)][_0xe25428(0x13c)][_0xe25428(0x15b)]({'where':{'gateway':_0x1d6846,'status':_0xe25428(0x1da)}});console[_0xe25428(0x173)]('ðŸ’¸\x20[GATEWAY\x20STATS]\x20Refund\x20count:\x20'+_0x2a4f7e);const _0x254230=_0x5029cf[_0xe25428(0x18a)][_0xe25428(0x1ba)]||0x0,_0xa39fb3=(_0x5029cf['_sum'][_0xe25428(0x1ba)]||0x0)-(_0x5029cf[_0xe25428(0x18a)][_0xe25428(0x167)]||0x0),_0x47efec=_0x5029cf[_0xe25428(0x1a3)][_0xe25428(0x19e)],_0x5cbe30=_0x47efec>0x0?_0xb7230e/_0x47efec*0x64:0x0;console[_0xe25428(0x173)](_0xe25428(0x1b3)),console['log'](_0xe25428(0x1bd)+_0x254230),console[_0xe25428(0x173)](_0xe25428(0x160)+_0xa39fb3),console['log'](_0xe25428(0x152)+_0x47efec),console[_0xe25428(0x173)](_0xe25428(0x1cd)+_0x5cbe30+'%'),_0x3a852e[_0xe25428(0x197)]({'success':!![],'result':{'gatewayId':_0x3b3352,'totalTurnover':Number(_0x254230[_0xe25428(0x1d1)](0x2)),'totalCommission':Number(_0xa39fb3['toFixed'](0x2)),'successfulPayments':_0x47efec,'chargebackCount':_0xb7230e,'chargebackRate':Number(_0x5cbe30['toFixed'](0x2)),'refundCount':_0x2a4f7e}});}catch(_0x567467){console[_0xe25428(0x1aa)](_0xe25428(0x1df),_0x567467),_0x266c96(_0x567467);}},this[_0x27f100(0x18d)]=new adminService_1[(_0x27f100(0x13e))](),this[_0x27f100(0x16d)]=new paymentLinkService_1['PaymentLinkService']();}}exports[a4_0x15625d(0x1e8)]=AdminController;