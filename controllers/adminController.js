'use strict';const a3_0x5f547b=a3_0x579f;(function(_0x19ff56,_0x1df06c){const _0x248d28=a3_0x579f,_0x18849=_0x19ff56();while(!![]){try{const _0x572138=parseInt(_0x248d28(0x161))/0x1*(parseInt(_0x248d28(0x179))/0x2)+-parseInt(_0x248d28(0x15f))/0x3+parseInt(_0x248d28(0x14e))/0x4*(parseInt(_0x248d28(0x13a))/0x5)+-parseInt(_0x248d28(0x162))/0x6*(parseInt(_0x248d28(0x12d))/0x7)+parseInt(_0x248d28(0x163))/0x8*(parseInt(_0x248d28(0x141))/0x9)+-parseInt(_0x248d28(0x12f))/0xa*(-parseInt(_0x248d28(0x139))/0xb)+-parseInt(_0x248d28(0x142))/0xc;if(_0x572138===_0x1df06c)break;else _0x18849['push'](_0x18849['shift']());}catch(_0x394fbc){_0x18849['push'](_0x18849['shift']());}}}(a3_0x2990,0xe908b));Object['defineProperty'](exports,'__esModule',{'value':!![]}),exports[a3_0x5f547b(0x14c)]=void 0x0;const adminService_1=require(a3_0x5f547b(0x159)),paymentLinkService_1=require('../services/paymentLinkService'),telegramBotService_1=require(a3_0x5f547b(0x133));function a3_0x2990(){const _0x14df67=['AdminController','users','104UkyPUo','toUpperCase','pagination','ðŸ”„\x20Admin\x20updating\x20customer\x20data\x20for\x20payment\x20','username','payouts','getPayouts','params','merchants','shopId','getPaymentById','../services/adminService',',\x20sending\x20Telegram\x20notification','expired','checkAuth','json','createPayout','5509266AMpRFQ','status','19289jzJmKf','12QXDfmG','16IEHWzo','âœ…\x20Telegram\x20notification\x20sent\x20for\x20status\x20change:\x20','\x20to\x20','deletePayout','getMerchantsAwaitingPayout','getMerchantStatistics','\x20->\x20','\x20to\x20PAID,\x20updating\x20payment\x20link\x20counter','FAILED','month','getPayments','getMerchantsSelection','Payment\x20not\x20found','PROCESSING','getPayoutStats','ðŸ“±\x20Skipping\x20Telegram\x20notification\x20for\x20status\x20change\x20to:\x20','getAllPayouts','Admin\x20access\x20confirmed','paid','body','User\x20updated\x20successfully','query','76SLUQcz','getAllPayments','telegramBotService','updatePayment','getUsers','ðŸ“Š\x20Admin\x20requesting\x20merchant\x20statistics\x20with\x20filters:','updateCustomerData','sendPaymentNotification','activateUser','4357101clblBl','User\x20not\x20found','12850DuyEFz','getPayoutById','adminService','createdAt','../services/telegramBotService','handleSuccessfulPayment','Payout\x20not\x20found','payments','Customer\x20data\x20updated\x20successfully','role','14267hZuZRa','165070ADzsKh','AdminService','paymentLinkService','gateway','updatePaymentStatus','log','EXPIRED','5533722fhEEPr','5422704WipXhc','deleteUser','Failed\x20to\x20update\x20payment\x20link\x20counter:','suspendUser','CHARGEBACK','30d','Failed\x20to\x20send\x20Telegram\x20notification\x20for\x20status\x20change:','getUserById','User\x20created\x20successfully','updateUser'];a3_0x2990=function(){return _0x14df67;};return a3_0x2990();}class AdminController{constructor(){const _0x3c1630=a3_0x5f547b;this[_0x3c1630(0x15c)]=async(_0xfedea5,_0x35b1f4,_0x2c5cfe)=>{const _0x17cd7a=_0x3c1630;try{const _0x32582c=_0xfedea5['user'];_0x35b1f4['json']({'success':!![],'message':_0x17cd7a(0x174),'user':{'id':_0x32582c?.['id'],'username':_0x32582c?.[_0x17cd7a(0x152)],'role':_0x32582c?.[_0x17cd7a(0x138)]}});}catch(_0x437a1a){_0x2c5cfe(_0x437a1a);}},this['getStatistics']=async(_0x4dff08,_0x369f7e,_0x5cd969)=>{const _0x528544=_0x3c1630;try{const {period:period=_0x528544(0x147)}=_0x4dff08[_0x528544(0x178)],_0x2739cf=await this[_0x528544(0x131)]['getSystemStatistics'](period);_0x369f7e[_0x528544(0x15d)]({'success':!![],'result':_0x2739cf});}catch(_0x323758){_0x5cd969(_0x323758);}},this[_0x3c1630(0x168)]=async(_0x38a1b2,_0x3fa09c,_0xd8d8e)=>{const _0x460ca5=_0x3c1630;try{const {shopId:_0x15e298,period:period=_0x460ca5(0x16c),dateFrom:_0x33d6a2,dateTo:_0x3829f7}=_0x38a1b2['query'],_0x22b8ee={'shopId':_0x15e298,'period':period,'dateFrom':_0x33d6a2,'dateTo':_0x3829f7};console[_0x460ca5(0x13f)](_0x460ca5(0x129),_0x22b8ee);const _0x5e2555=await this['adminService']['getMerchantStatistics'](_0x22b8ee);_0x3fa09c[_0x460ca5(0x15d)]({'success':!![],'result':_0x5e2555});}catch(_0x47d1dd){_0xd8d8e(_0x47d1dd);}},this[_0x3c1630(0x171)]=async(_0x114e09,_0x1098fd,_0x392b33)=>{const _0x251da4=_0x3c1630;try{const _0x58ba5d=await this['adminService'][_0x251da4(0x171)]();_0x1098fd['json']({'success':!![],'result':_0x58ba5d});}catch(_0x39c725){_0x392b33(_0x39c725);}},this['getMerchantsAwaitingPayout']=async(_0x35d031,_0x30f6f9,_0x3bdcf4)=>{const _0x33a950=_0x3c1630;try{const {page:page=0x1,limit:limit=0x14,minAmount:_0x2e8cd0,search:_0x2f550}=_0x35d031[_0x33a950(0x178)],_0xf1ac52={'page':Number(page),'limit':Number(limit),'minAmount':_0x2e8cd0?Number(_0x2e8cd0):undefined,'search':_0x2f550},_0x255dbc=await this[_0x33a950(0x131)][_0x33a950(0x167)](_0xf1ac52);_0x30f6f9['json']({'success':!![],'merchants':_0x255dbc[_0x33a950(0x156)],'pagination':_0x255dbc[_0x33a950(0x150)],'summary':_0x255dbc['summary']});}catch(_0x3df951){_0x3bdcf4(_0x3df951);}},this['getMerchantsSelection']=async(_0x3b3b2f,_0x498942,_0xfe5a4e)=>{const _0x5531f=_0x3c1630;try{const _0x30d74d=await this['adminService'][_0x5531f(0x16e)]();_0x498942[_0x5531f(0x15d)]({'success':!![],'result':_0x30d74d});}catch(_0x174adb){_0xfe5a4e(_0x174adb);}},this[_0x3c1630(0x15e)]=async(_0x193cfd,_0x4f3519,_0x41e57f)=>{const _0x119016=_0x3c1630;try{const _0x13c010=_0x193cfd[_0x119016(0x176)],_0x1388ef=await this[_0x119016(0x131)][_0x119016(0x15e)](_0x13c010);_0x4f3519[_0x119016(0x160)](0xc9)[_0x119016(0x15d)]({'success':!![],'message':'Payout\x20created\x20successfully','result':_0x1388ef});}catch(_0x219f29){_0x41e57f(_0x219f29);}},this[_0x3c1630(0x154)]=async(_0x49f8f1,_0x1b1520,_0x50b1b8)=>{const _0x5ea1bb=_0x3c1630;try{const {page:page=0x1,limit:limit=0x14,shopId:_0x468d9a,network:_0x3eec33,dateFrom:_0x430fa4,dateTo:_0x46324b,search:_0xbe234b}=_0x49f8f1[_0x5ea1bb(0x178)],_0xeb3f35={'page':Number(page),'limit':Number(limit),'shopId':_0x468d9a,'network':_0x3eec33,'dateFrom':_0x430fa4,'dateTo':_0x46324b,'search':_0xbe234b},_0x392a3b=await this[_0x5ea1bb(0x131)][_0x5ea1bb(0x173)](_0xeb3f35);_0x1b1520[_0x5ea1bb(0x15d)]({'success':!![],'payouts':_0x392a3b[_0x5ea1bb(0x153)],'pagination':_0x392a3b[_0x5ea1bb(0x150)]});}catch(_0x4b954a){_0x50b1b8(_0x4b954a);}},this[_0x3c1630(0x130)]=async(_0xcaee92,_0x100b54,_0x471af4)=>{const _0x61fc8=_0x3c1630;try{const {id:_0x40319c}=_0xcaee92[_0x61fc8(0x155)],_0x52e997=await this['adminService']['getPayoutById'](_0x40319c);if(!_0x52e997)return _0x100b54['status'](0x194)[_0x61fc8(0x15d)]({'success':![],'message':_0x61fc8(0x135)});_0x100b54[_0x61fc8(0x15d)]({'success':!![],'result':_0x52e997});}catch(_0x4066c8){_0x471af4(_0x4066c8);}},this[_0x3c1630(0x166)]=async(_0x235205,_0x2ad22f,_0x88c089)=>{const _0x1e0b44=_0x3c1630;try{const {id:_0x11b46f}=_0x235205[_0x1e0b44(0x155)];await this[_0x1e0b44(0x131)][_0x1e0b44(0x166)](_0x11b46f),_0x2ad22f[_0x1e0b44(0x15d)]({'success':!![],'message':'Payout\x20deleted\x20successfully'});}catch(_0x371ea9){_0x88c089(_0x371ea9);}},this[_0x3c1630(0x16d)]=async(_0x58cc57,_0x5bad15,_0x32a10a)=>{const _0x42a35a=_0x3c1630;try{const {page:page=0x1,limit:limit=0x14,status:_0xeb2efe,gateway:_0x32553d,shopId:_0x108da9,dateFrom:_0x3a9cb1,dateTo:_0x6df91d,search:_0x3b36ce,currency:_0x37aa0f,sortBy:_0x542746,sortOrder:_0x147db4}=_0x58cc57[_0x42a35a(0x178)],_0x14b2c8={'page':Number(page),'limit':Number(limit),'status':_0xeb2efe,'gateway':_0x32553d,'shopId':_0x108da9,'dateFrom':_0x3a9cb1,'dateTo':_0x6df91d,'search':_0x3b36ce,'currency':_0x37aa0f,'sortBy':_0x542746,'sortOrder':_0x147db4},_0x74a8d4=await this[_0x42a35a(0x131)][_0x42a35a(0x17a)](_0x14b2c8);_0x5bad15[_0x42a35a(0x15d)]({'success':!![],'payments':_0x74a8d4[_0x42a35a(0x136)],'pagination':_0x74a8d4[_0x42a35a(0x150)]});}catch(_0x1d6e35){_0x32a10a(_0x1d6e35);}},this['getPaymentById']=async(_0x2ff393,_0x31f6a4,_0x107938)=>{const _0x899cac=_0x3c1630;try{const {id:_0x3f8bb0}=_0x2ff393['params'],_0x1531e7=await this[_0x899cac(0x131)]['getPaymentById'](_0x3f8bb0);if(!_0x1531e7)return _0x31f6a4[_0x899cac(0x160)](0x194)[_0x899cac(0x15d)]({'success':![],'message':_0x899cac(0x16f)});_0x31f6a4[_0x899cac(0x15d)]({'success':!![],'result':_0x1531e7});}catch(_0x20c1c6){_0x107938(_0x20c1c6);}},this[_0x3c1630(0x17c)]=async(_0x7aa344,_0x1d616e,_0x94600a)=>{const _0x3ea222=_0x3c1630;try{const {id:_0x15b397}=_0x7aa344[_0x3ea222(0x155)],{status:_0x100493,notes:_0x5a6878,chargebackAmount:_0x504a70}=_0x7aa344['body'],_0x451d57=await this[_0x3ea222(0x131)][_0x3ea222(0x158)](_0x15b397);if(!_0x451d57)return _0x1d616e[_0x3ea222(0x160)](0x194)['json']({'success':![],'message':_0x3ea222(0x16f)});const _0x5da4e1=await this[_0x3ea222(0x131)][_0x3ea222(0x13e)](_0x15b397,_0x100493,_0x5a6878,_0x504a70);if(_0x451d57[_0x3ea222(0x160)]!==_0x100493&&_0x100493[_0x3ea222(0x14f)]()==='PAID'){console[_0x3ea222(0x13f)]('ðŸ“ˆ\x20Admin\x20changed\x20payment\x20'+_0x15b397+_0x3ea222(0x16a));try{await this[_0x3ea222(0x13c)][_0x3ea222(0x134)](_0x15b397),console['log']('âœ…\x20Payment\x20link\x20counter\x20updated\x20for\x20payment\x20'+_0x15b397);}catch(_0x2edaec){console['error'](_0x3ea222(0x144),_0x2edaec);}}if(_0x451d57['status']!==_0x100493){console[_0x3ea222(0x13f)]('ðŸ“±\x20Payment\x20'+_0x15b397+'\x20status\x20changed\x20from\x20'+_0x451d57[_0x3ea222(0x160)]+_0x3ea222(0x165)+_0x100493+_0x3ea222(0x15a));try{let _0x4dac0c;switch(_0x100493[_0x3ea222(0x14f)]()){case'PAID':_0x4dac0c=_0x3ea222(0x175);break;case _0x3ea222(0x170):_0x4dac0c='processing';break;case _0x3ea222(0x16b):_0x4dac0c='failed';break;case _0x3ea222(0x140):_0x4dac0c=_0x3ea222(0x15b);break;case'REFUND':_0x4dac0c='refund';break;case _0x3ea222(0x146):_0x4dac0c='chargeback';break;default:console[_0x3ea222(0x13f)](_0x3ea222(0x172)+_0x100493);break;}if(_0x4dac0c){const _0x5dc330={..._0x5da4e1,'shopId':_0x451d57[_0x3ea222(0x157)],'gateway':_0x451d57[_0x3ea222(0x13d)],'createdAt':_0x451d57[_0x3ea222(0x132)],'chargebackAmount':_0x504a70};await telegramBotService_1[_0x3ea222(0x17b)][_0x3ea222(0x12b)](_0x451d57[_0x3ea222(0x157)],_0x5dc330,_0x4dac0c),console[_0x3ea222(0x13f)](_0x3ea222(0x164)+_0x451d57[_0x3ea222(0x160)]+_0x3ea222(0x169)+_0x100493);}}catch(_0x165628){console['error'](_0x3ea222(0x148),_0x165628);}}_0x1d616e[_0x3ea222(0x15d)]({'success':!![],'message':'Payment\x20updated\x20successfully','result':_0x5da4e1});}catch(_0x5ef900){_0x94600a(_0x5ef900);}},this['updateCustomerData']=async(_0x361efc,_0x1bd098,_0x42f218)=>{const _0x1d725f=_0x3c1630;try{const {id:_0x560494}=_0x361efc[_0x1d725f(0x155)],_0x4dccba=_0x361efc[_0x1d725f(0x176)];console['log'](_0x1d725f(0x151)+_0x560494+':',_0x4dccba);const _0xe7f2af=await this['adminService'][_0x1d725f(0x12a)](_0x560494,_0x4dccba);_0x1bd098['json']({'success':!![],'message':_0x1d725f(0x137),'result':_0xe7f2af});}catch(_0x36cf56){_0x42f218(_0x36cf56);}},this[_0x3c1630(0x14b)]=async(_0x4926b0,_0x45dbe3,_0x5e6d34)=>{const _0x1c60a0=_0x3c1630;try{const {id:_0x20842a}=_0x4926b0['params'],_0x3168a6=_0x4926b0[_0x1c60a0(0x176)],_0x36c34=await this['adminService'][_0x1c60a0(0x14b)](_0x20842a,_0x3168a6);_0x45dbe3['json']({'success':!![],'message':_0x1c60a0(0x177),'result':_0x36c34});}catch(_0x63af89){_0x5e6d34(_0x63af89);}},this[_0x3c1630(0x145)]=async(_0x18939c,_0x2396ab,_0x41eb3d)=>{const _0x2d7aa8=_0x3c1630;try{const {id:_0x606514}=_0x18939c[_0x2d7aa8(0x155)],_0x167a6c=await this[_0x2d7aa8(0x131)][_0x2d7aa8(0x145)](_0x606514);_0x2396ab[_0x2d7aa8(0x15d)]({'success':!![],'message':'User\x20suspended\x20successfully','result':_0x167a6c});}catch(_0x30c7ea){_0x41eb3d(_0x30c7ea);}},this['activateUser']=async(_0x368aaf,_0x440d6d,_0x5881d3)=>{const _0x3aa8db=_0x3c1630;try{const {id:_0x303973}=_0x368aaf[_0x3aa8db(0x155)],_0x4251b3=await this[_0x3aa8db(0x131)][_0x3aa8db(0x12c)](_0x303973);_0x440d6d['json']({'success':!![],'message':'User\x20activated\x20successfully','result':_0x4251b3});}catch(_0x16307b){_0x5881d3(_0x16307b);}},this[_0x3c1630(0x17d)]=async(_0x5673fc,_0x4fd61e,_0x5477bc)=>{const _0x31a181=_0x3c1630;try{const {page:page=0x1,limit:limit=0x14,status:_0x4409f6}=_0x5673fc[_0x31a181(0x178)],_0x2a2b1b={'page':Number(page),'limit':Number(limit),'status':_0x4409f6},_0x506eb2=await this['adminService']['getAllUsers'](_0x2a2b1b);_0x4fd61e[_0x31a181(0x15d)]({'success':!![],'users':_0x506eb2[_0x31a181(0x14d)],'pagination':_0x506eb2[_0x31a181(0x150)]});}catch(_0x2bb153){_0x5477bc(_0x2bb153);}},this[_0x3c1630(0x149)]=async(_0xff38a5,_0x2c1adb,_0x14685a)=>{const _0x340e39=_0x3c1630;try{const {id:_0x3759cc}=_0xff38a5[_0x340e39(0x155)],_0x394499=await this[_0x340e39(0x131)][_0x340e39(0x149)](_0x3759cc);if(!_0x394499)return _0x2c1adb[_0x340e39(0x160)](0x194)['json']({'success':![],'message':_0x340e39(0x12e)});_0x2c1adb['json']({'success':!![],'result':_0x394499});}catch(_0x3848f9){_0x14685a(_0x3848f9);}},this['createUser']=async(_0x101af6,_0x5d1de6,_0x349f09)=>{const _0x2b7a1a=_0x3c1630;try{const _0x1af51a=_0x101af6['body'],_0x47f450=await this[_0x2b7a1a(0x131)]['createUser'](_0x1af51a);_0x5d1de6[_0x2b7a1a(0x160)](0xc9)['json']({'success':!![],'message':_0x2b7a1a(0x14a),'result':_0x47f450});}catch(_0x3bd9a8){_0x349f09(_0x3bd9a8);}},this[_0x3c1630(0x143)]=async(_0x438bdc,_0x2463f7,_0x2bdf65)=>{const _0x598ef9=_0x3c1630;try{const {id:_0x3839ad}=_0x438bdc['params'];await this['adminService'][_0x598ef9(0x143)](_0x3839ad),_0x2463f7[_0x598ef9(0x15d)]({'success':!![],'message':'User\x20deleted\x20successfully'});}catch(_0x2659c2){_0x2bdf65(_0x2659c2);}},this['adminService']=new adminService_1[(_0x3c1630(0x13b))](),this[_0x3c1630(0x13c)]=new paymentLinkService_1['PaymentLinkService']();}}function a3_0x579f(_0x106161,_0x1c1d7c){const _0x299092=a3_0x2990();return a3_0x579f=function(_0x579f61,_0x43bfce){_0x579f61=_0x579f61-0x129;let _0x594dd8=_0x299092[_0x579f61];return _0x594dd8;},a3_0x579f(_0x106161,_0x1c1d7c);}exports['AdminController']=AdminController;