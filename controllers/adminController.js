'use strict';function a4_0x58ab(_0x3f3623,_0xde20bd){_0x3f3623=_0x3f3623-0x166;const _0x31fc18=a4_0x31fc();let _0x58ab0a=_0x31fc18[_0x3f3623];return _0x58ab0a;}const a4_0x28c709=a4_0x58ab;(function(_0x3f8469,_0x3b49ac){const _0x1b8457=a4_0x58ab,_0x468ea9=_0x3f8469();while(!![]){try{const _0x982254=-parseInt(_0x1b8457(0x16d))/0x1*(parseInt(_0x1b8457(0x167))/0x2)+parseInt(_0x1b8457(0x21c))/0x3*(-parseInt(_0x1b8457(0x215))/0x4)+parseInt(_0x1b8457(0x1be))/0x5+-parseInt(_0x1b8457(0x170))/0x6*(parseInt(_0x1b8457(0x1f4))/0x7)+parseInt(_0x1b8457(0x189))/0x8*(parseInt(_0x1b8457(0x1cc))/0x9)+parseInt(_0x1b8457(0x1dc))/0xa+-parseInt(_0x1b8457(0x1e7))/0xb*(-parseInt(_0x1b8457(0x1a3))/0xc);if(_0x982254===_0x3b49ac)break;else _0x468ea9['push'](_0x468ea9['shift']());}catch(_0xecc946){_0x468ea9['push'](_0x468ea9['shift']());}}}(a4_0x31fc,0xd452a));var __createBinding=this&&this[a4_0x28c709(0x21b)]||(Object[a4_0x28c709(0x1c8)]?function(_0x378cbe,_0x5add07,_0x5561e3,_0x14716e){const _0x28d89d=a4_0x28c709;if(_0x14716e===undefined)_0x14716e=_0x5561e3;var _0x194074=Object[_0x28d89d(0x203)](_0x5add07,_0x5561e3);(!_0x194074||(_0x28d89d(0x204)in _0x194074?!_0x5add07[_0x28d89d(0x188)]:_0x194074[_0x28d89d(0x17e)]||_0x194074['configurable']))&&(_0x194074={'enumerable':!![],'get':function(){return _0x5add07[_0x5561e3];}}),Object[_0x28d89d(0x1ac)](_0x378cbe,_0x14716e,_0x194074);}:function(_0x1550e9,_0x319930,_0x58d9d1,_0x553786){if(_0x553786===undefined)_0x553786=_0x58d9d1;_0x1550e9[_0x553786]=_0x319930[_0x58d9d1];}),__setModuleDefault=this&&this[a4_0x28c709(0x1f1)]||(Object['create']?function(_0x42edcb,_0x3bb90a){const _0x563a8a=a4_0x28c709;Object['defineProperty'](_0x42edcb,_0x563a8a(0x1f3),{'enumerable':!![],'value':_0x3bb90a});}:function(_0x5d3d46,_0xe1e045){_0x5d3d46['default']=_0xe1e045;}),__importStar=this&&this[a4_0x28c709(0x212)]||(function(){var _0x489047=function(_0x2935a7){const _0x17068e=a4_0x58ab;return _0x489047=Object[_0x17068e(0x1bf)]||function(_0xc71e49){const _0x461fcf=_0x17068e;var _0xb46195=[];for(var _0x4aedb3 in _0xc71e49)if(Object[_0x461fcf(0x171)][_0x461fcf(0x1de)][_0x461fcf(0x1e3)](_0xc71e49,_0x4aedb3))_0xb46195[_0xb46195['length']]=_0x4aedb3;return _0xb46195;},_0x489047(_0x2935a7);};return function(_0x1f9886){const _0x5c0611=a4_0x58ab;if(_0x1f9886&&_0x1f9886[_0x5c0611(0x188)])return _0x1f9886;var _0x12eae5={};if(_0x1f9886!=null){for(var _0x149ee6=_0x489047(_0x1f9886),_0x7f6f2b=0x0;_0x7f6f2b<_0x149ee6[_0x5c0611(0x1ca)];_0x7f6f2b++)if(_0x149ee6[_0x7f6f2b]!=='default')__createBinding(_0x12eae5,_0x1f9886,_0x149ee6[_0x7f6f2b]);}return __setModuleDefault(_0x12eae5,_0x1f9886),_0x12eae5;};}()),__importDefault=this&&this['__importDefault']||function(_0x3aff15){return _0x3aff15&&_0x3aff15['__esModule']?_0x3aff15:{'default':_0x3aff15};};function a4_0x31fc(){const _0x5a4c52=['updatePaymentStatus','gatewaySettingsService','\x20->\x20Gateway\x20Name:\x20','ðŸ”™\x20[GATEWAY\x20STATS]\x20Chargeback\x20count:\x20','Gateway\x20settings\x20updated\x20successfully','expired','updateUser','../types/gateway','query','then','getMerchantStatistics','gatewayCommission','\x20status\x20changed\x20from\x20','User\x20updated\x20successfully','month','User\x20suspended\x20successfully','updateCustomerData','resolve','\x20\x20\x20-\x20Chargeback\x20Rate:\x20','3084LFtmsL','ðŸ§¹\x20Manual\x20PROCESSING\x20payment\x20cleanup\x20initiated\x20by\x20admin:\x20','payment','Payment\x20cleanup\x20(PROCESSING\x20+\x20PENDING)\x20with\x20report\x20completed\x20successfully','createdAt','ðŸ“ˆ\x20Admin\x20changed\x20payment\x20','paid','getPaymentById','suspendUser','defineProperty','ðŸ“Š\x20Admin\x20requesting\x20merchant\x20statistics\x20with\x20filters:','ðŸ“Š\x20Manual\x20payment\x20cleanup\x20(PROCESSING\x20+\x20PENDING)\x20with\x20report\x20initiated\x20by\x20admin:\x20','getSystemStatistics','../services/adminService','stringify','error','User\x20not\x20found','updatePayment','../services/paymentLinkService','AdminController','pagination','setup2FA','cleanupStalePayments','adminService','periodFrom,\x20periodTo,\x20and\x20gateway\x20are\x20required','params','\x20with\x20data:','290795ZlnwYA','getOwnPropertyNames','createPayout','chargeback','CHARGEBACK','telegramBotService','getProcessingPaymentsStats',',\x20sending\x20Telegram\x20notification','../config/database','FAILED','create','Token\x20is\x20required','length','2FA\x20disabled\x20successfully','27TKBnGX','setupAdmin2FA','PAID','â°\x20Manual\x20PENDING\x20payment\x20cleanup\x20initiated\x20by\x20admin:\x20','ðŸ“±\x20Skipping\x20Telegram\x20notification\x20for\x20status\x20change\x20to:\x20','User\x20created\x20successfully','getMerchantsSelection','ðŸ”\x20[GATEWAY\x20STATS]\x20Querying\x20payments\x20with\x20gateway=\x22','amountUSDT','Failed\x20to\x20send\x20Telegram\x20notification\x20for\x20status\x20change:','hasPayoutHistory','\x20paid\x20payments\x20for\x20','getPayoutStats','handleSuccessfulPayment','ðŸ“ˆ\x20[GATEWAY\x20STATS]\x20Calculated\x20statistics:','getAllUsers','11647690FfjOtx','toFixed','hasOwnProperty','PENDING\x20payment\x20cleanup\x20completed\x20successfully','payments','changeAdminPassword','expireSinglePaymentLinks','call','\x20to\x20PAID,\x20updating\x20payment\x20link\x20counter','payouts','Payout\x20created\x20successfully','56518VmSZed','forEach','REFUND','enable2FA','30d','ðŸ’¸\x20[GATEWAY\x20STATS]\x20Refund\x20count:\x20','status','ðŸ’°\x20[GATEWAY\x20STATS]\x20Found\x20','users','ðŸ“±\x20Payment\x20','__setModuleDefault','getPayoutById','default','5026cwaUEV','Gateway\x20not\x20found','\x22\x20and\x20status=\x22PAID\x22','all','âœ…\x20Telegram\x20notification\x20sent\x20for\x20status\x20change:\x20','deletePayout','Admin\x20password\x20changed\x20successfully','getUserById','Payout\x20deleted\x20successfully','json','true','findMany','Failed\x20to\x20update\x20payment\x20link\x20counter:','refund','../services/gatewaySettingsService','getOwnPropertyDescriptor','get','âœ…\x20Payment\x20link\x20counter\x20updated\x20for\x20payment\x20','getShopWallets','cleanupStaleProcessingPayments','ðŸŽ¯\x20[CONTROLLER]\x20Creating\x20payout\x20with\x20data:','AdminService','depositBalance','updatePayout','sendPaymentNotification','getAllPayouts','2FA\x20enabled\x20successfully','updateSettings','ðŸ”„\x20Admin\x20updating\x20customer\x20data\x20for\x20payment\x20','errors','__importStar','\x20\x20\x20-\x20Total\x20Commission:\x20','Amount\x20must\x20be\x20greater\x20than\x200','5449612xvzeSK','getUsers','role','createUser','\x20\x20\x20-\x20Successful\x20Payments:\x20','toUpperCase','__createBinding','3WbllJd','getAllPayments','âŒ\x20[GATEWAY\x20STATS]\x20Error:','summary','enableAdmin2FA','getMerchantsAwaitingPayout','checkAuth','updateGatewaySettings','817764gIkini','âŒ\x20[GATEWAY\x20STATS]\x20Gateway\x20not\x20found\x20for\x20ID:\x20','getPayments','shopId','processing','ceil','2drWRIM','total','Payment\x20link\x20expiration\x20check\x20completed\x20successfully','4164VOehcu','prototype','ðŸ”\x20[GATEWAY\x20STATS]\x20Sample\x20payments\x20for\x20','paymentCleanupService','User\x20deleted\x20successfully','\x20\x20\x20-\x20Total\x20Turnover:\x20','expirePaymentLinks','Admin\x20access\x20confirmed','User\x20activated\x20successfully','processed','../services/telegramBotService','getLoginLogs','getSettingsByGatewayId','body','writable','failed','loginLog','ðŸ“Š\x20[GATEWAY\x20STATS]\x20Requesting\x20statistics\x20for\x20gateway\x20ID:\x20','Payment\x20not\x20found','user','activateUser','getPayoutReports','log','disableAdmin2FA','__esModule','2679304AuQPzn','shopId\x20and\x20amount\x20are\x20required','cleanupStalePendingPayments','username','gateway','Customer\x20data\x20updated\x20successfully','ðŸ“Š\x20[GATEWAY\x20STATS]\x20Gateway\x20commission:\x20'];a4_0x31fc=function(){return _0x5a4c52;};return a4_0x31fc();}Object[a4_0x28c709(0x1ac)](exports,a4_0x28c709(0x188),{'value':!![]}),exports[a4_0x28c709(0x1b6)]=void 0x0;const adminService_1=require(a4_0x28c709(0x1b0)),paymentLinkService_1=require(a4_0x28c709(0x1b5)),paymentCleanupService_1=require('../services/paymentCleanupService'),telegramBotService_1=require(a4_0x28c709(0x17a)),gatewaySettingsService_1=require(a4_0x28c709(0x202)),database_1=__importDefault(require(a4_0x28c709(0x1c6)));class AdminController{constructor(){const _0x36cee9=a4_0x28c709;this[_0x36cee9(0x222)]=async(_0x18480d,_0x267e4b,_0x2f31d5)=>{const _0x30f1f7=_0x36cee9;try{const _0x125eac=_0x18480d[_0x30f1f7(0x183)];_0x267e4b['json']({'success':!![],'message':_0x30f1f7(0x177),'user':{'id':_0x125eac?.['id'],'username':_0x125eac?.[_0x30f1f7(0x18c)],'role':_0x125eac?.[_0x30f1f7(0x217)]}});}catch(_0x3fa05e){_0x2f31d5(_0x3fa05e);}},this['getStatistics']=async(_0x2bf2f9,_0x23780e,_0x2735a6)=>{const _0x3d4ebd=_0x36cee9;try{const {period:period=_0x3d4ebd(0x1eb),currentDate:_0x300acc}=_0x2bf2f9[_0x3d4ebd(0x198)],_0xadcfc8=await this['adminService'][_0x3d4ebd(0x1af)](period,_0x300acc);_0x23780e[_0x3d4ebd(0x1fd)]({'success':!![],'result':_0xadcfc8});}catch(_0x422d7e){_0x2735a6(_0x422d7e);}},this[_0x36cee9(0x19a)]=async(_0x16ad69,_0x6f43ca,_0x21b4f7)=>{const _0x45500f=_0x36cee9;try{const {shopId:_0xaf7682,period:period=_0x45500f(0x19e),dateFrom:_0x276aba,dateTo:_0x546bcf}=_0x16ad69[_0x45500f(0x198)],_0x1795eb={'shopId':_0xaf7682,'period':period,'dateFrom':_0x276aba,'dateTo':_0x546bcf};console[_0x45500f(0x186)](_0x45500f(0x1ad),_0x1795eb);const _0x294e0d=await this['adminService'][_0x45500f(0x19a)](_0x1795eb);_0x6f43ca[_0x45500f(0x1fd)]({'success':!![],'result':_0x294e0d});}catch(_0x4d4274){_0x21b4f7(_0x4d4274);}},this[_0x36cee9(0x185)]=async(_0x1837dc,_0x1be0ea,_0x5198fa)=>{const _0x218802=_0x36cee9;try{const {periodFrom:_0x1485ad,periodTo:_0x12ba5f,gateway:_0x45f453}=_0x1837dc[_0x218802(0x198)];if(!_0x1485ad||!_0x12ba5f||!_0x45f453)return _0x1be0ea[_0x218802(0x1ed)](0x190)['json']({'success':![],'message':_0x218802(0x1bb)});console[_0x218802(0x186)]('ðŸ“Š\x20Admin\x20requesting\x20payout\x20reports:',{'periodFrom':_0x1485ad,'periodTo':_0x12ba5f,'gateway':_0x45f453});const _0x21df2d=await this['adminService'][_0x218802(0x185)]({'periodFrom':_0x1485ad,'periodTo':_0x12ba5f,'gateway':_0x45f453});_0x1be0ea['json']({'success':!![],'reports':_0x21df2d});}catch(_0x3b2a32){_0x5198fa(_0x3b2a32);}},this['getPayoutStats']=async(_0x4054e6,_0x5d529e,_0x4df012)=>{const _0x1accfc=_0x36cee9;try{const _0x16ea9b=await this[_0x1accfc(0x1ba)][_0x1accfc(0x1d8)]();_0x5d529e[_0x1accfc(0x1fd)]({'success':!![],'result':_0x16ea9b});}catch(_0x78497f){_0x4df012(_0x78497f);}},this[_0x36cee9(0x221)]=async(_0x3f385d,_0x3a82cc,_0x3e52b1)=>{const _0x25fb3d=_0x36cee9;try{const {page:page=0x1,limit:limit=0x14,minAmount:_0x516100,search:_0xf2c86c}=_0x3f385d[_0x25fb3d(0x198)],_0x5b7e8a={'page':Number(page),'limit':Number(limit),'minAmount':_0x516100?Number(_0x516100):undefined,'search':_0xf2c86c},_0x13fca4=await this[_0x25fb3d(0x1ba)][_0x25fb3d(0x221)](_0x5b7e8a);_0x3a82cc['json']({'success':!![],'merchants':_0x13fca4['merchants'],'pagination':_0x13fca4[_0x25fb3d(0x1b7)],'summary':_0x13fca4[_0x25fb3d(0x21f)]});}catch(_0x4bdb91){_0x3e52b1(_0x4bdb91);}},this[_0x36cee9(0x1d2)]=async(_0x2b7946,_0x1454dc,_0x289ba7)=>{const _0x2d6a47=_0x36cee9;try{const _0x6b1236=_0x2b7946[_0x2d6a47(0x198)][_0x2d6a47(0x1d6)]===_0x2d6a47(0x1fe),_0x27f162=await this[_0x2d6a47(0x1ba)][_0x2d6a47(0x1d2)](_0x6b1236);_0x1454dc[_0x2d6a47(0x1fd)]({'success':!![],'result':_0x27f162});}catch(_0x2f0485){_0x289ba7(_0x2f0485);}},this['createPayout']=async(_0x2954a4,_0x51226a,_0x559709)=>{const _0x4e4f0e=_0x36cee9;try{const _0x1165fa=_0x2954a4[_0x4e4f0e(0x17d)];console[_0x4e4f0e(0x186)](_0x4e4f0e(0x208),_0x1165fa);const _0x50a1b4=await this['adminService'][_0x4e4f0e(0x1c0)](_0x1165fa);_0x51226a[_0x4e4f0e(0x1ed)](0xc9)[_0x4e4f0e(0x1fd)]({'success':!![],'message':_0x4e4f0e(0x1e6),'result':_0x50a1b4});}catch(_0x352f4b){_0x559709(_0x352f4b);}},this['updatePayout']=async(_0x20cf11,_0x41cb7f,_0x61ffda)=>{const _0x36f079=_0x36cee9;try{const {id:_0x3bbee4}=_0x20cf11['params'],_0x3237c1=_0x20cf11[_0x36f079(0x17d)];console[_0x36f079(0x186)]('ðŸŽ¯\x20[CONTROLLER]\x20Updating\x20payout\x20'+_0x3bbee4+_0x36f079(0x1bd),_0x3237c1);const _0x56fb9e=await this['adminService'][_0x36f079(0x20b)](_0x3bbee4,_0x3237c1);_0x41cb7f[_0x36f079(0x1fd)]({'success':!![],'message':'Payout\x20updated\x20successfully','result':_0x56fb9e});}catch(_0x1ac09e){_0x61ffda(_0x1ac09e);}},this['getPayouts']=async(_0x27e1f5,_0x1a7313,_0xe30733)=>{const _0x4aaaeb=_0x36cee9;try{const {page:page=0x1,limit:limit=0x14,shopId:_0x49f9c7,network:_0x1a04cf,dateFrom:_0x3d2976,dateTo:_0xe121f6,search:_0x5c6ecc}=_0x27e1f5[_0x4aaaeb(0x198)],_0x3d49b7={'page':Number(page),'limit':Number(limit),'shopId':_0x49f9c7,'network':_0x1a04cf,'dateFrom':_0x3d2976,'dateTo':_0xe121f6,'search':_0x5c6ecc},_0x11d4dc=await this[_0x4aaaeb(0x1ba)][_0x4aaaeb(0x20d)](_0x3d49b7);_0x1a7313['json']({'success':!![],'payouts':_0x11d4dc[_0x4aaaeb(0x1e5)],'pagination':_0x11d4dc[_0x4aaaeb(0x1b7)]});}catch(_0x4c2ebb){_0xe30733(_0x4c2ebb);}},this[_0x36cee9(0x1f2)]=async(_0xc6f1d4,_0x3a91e1,_0x40e6a7)=>{const _0x440e77=_0x36cee9;try{const {id:_0x18eb4c}=_0xc6f1d4['params'],_0x68e1ee=await this[_0x440e77(0x1ba)][_0x440e77(0x1f2)](_0x18eb4c);if(!_0x68e1ee)return _0x3a91e1[_0x440e77(0x1ed)](0x194)[_0x440e77(0x1fd)]({'success':![],'message':'Payout\x20not\x20found'});_0x3a91e1[_0x440e77(0x1fd)]({'success':!![],'result':_0x68e1ee});}catch(_0x1c105b){_0x40e6a7(_0x1c105b);}},this[_0x36cee9(0x1f9)]=async(_0x130716,_0x4aafc8,_0x38cdf6)=>{const _0x59a7c8=_0x36cee9;try{const {id:_0x26a54a}=_0x130716[_0x59a7c8(0x1bc)];await this[_0x59a7c8(0x1ba)]['deletePayout'](_0x26a54a),_0x4aafc8['json']({'success':!![],'message':_0x59a7c8(0x1fc)});}catch(_0x189363){_0x38cdf6(_0x189363);}},this[_0x36cee9(0x169)]=async(_0x22ff1f,_0x58bca6,_0x95fb20)=>{const _0x4f8443=_0x36cee9;try{const {page:page=0x1,limit:limit=0x14,status:_0xa9f717,gateway:_0x1c1b48,shopId:_0x9ded32,dateFrom:_0x168325,dateTo:_0x514465,search:_0x2b48f7,currency:_0x4e5538,sortBy:_0x55e6f5,sortOrder:_0x72ff78}=_0x22ff1f[_0x4f8443(0x198)],_0x56c2ca={'page':Number(page),'limit':Number(limit),'status':_0xa9f717,'gateway':_0x1c1b48,'shopId':_0x9ded32,'dateFrom':_0x168325,'dateTo':_0x514465,'search':_0x2b48f7,'currency':_0x4e5538,'sortBy':_0x55e6f5,'sortOrder':_0x72ff78},_0xecd384=await this[_0x4f8443(0x1ba)][_0x4f8443(0x21d)](_0x56c2ca);_0x58bca6['json']({'success':!![],'payments':_0xecd384[_0x4f8443(0x1e0)],'pagination':_0xecd384[_0x4f8443(0x1b7)],'statistics':_0xecd384['statistics']});}catch(_0x36bedd){_0x95fb20(_0x36bedd);}},this['getPaymentById']=async(_0x29c1f8,_0x3d2e2b,_0x21462f)=>{const _0x30e594=_0x36cee9;try{const {id:_0x5ad194}=_0x29c1f8[_0x30e594(0x1bc)],_0x22e1fa=await this[_0x30e594(0x1ba)][_0x30e594(0x1aa)](_0x5ad194);if(!_0x22e1fa)return _0x3d2e2b['status'](0x194)[_0x30e594(0x1fd)]({'success':![],'message':_0x30e594(0x182)});_0x3d2e2b[_0x30e594(0x1fd)]({'success':!![],'result':_0x22e1fa});}catch(_0x490c39){_0x21462f(_0x490c39);}},this[_0x36cee9(0x1b4)]=async(_0x405bae,_0x375464,_0x3b5cb9)=>{const _0x1d5480=_0x36cee9;try{const {id:_0x20c712}=_0x405bae[_0x1d5480(0x1bc)],{status:_0xb91cfa,notes:_0x54bfe0,chargebackAmount:_0x30edf0}=_0x405bae[_0x1d5480(0x17d)],_0x184759=await this[_0x1d5480(0x1ba)][_0x1d5480(0x1aa)](_0x20c712);if(!_0x184759)return _0x375464[_0x1d5480(0x1ed)](0x194)[_0x1d5480(0x1fd)]({'success':![],'message':_0x1d5480(0x182)});const _0x378486=await this[_0x1d5480(0x1ba)][_0x1d5480(0x190)](_0x20c712,_0xb91cfa,_0x54bfe0,_0x30edf0);if(_0x184759[_0x1d5480(0x1ed)]!==_0xb91cfa&&_0xb91cfa[_0x1d5480(0x21a)]()===_0x1d5480(0x1ce)){console[_0x1d5480(0x186)](_0x1d5480(0x1a8)+_0x20c712+_0x1d5480(0x1e4));try{await this['paymentLinkService'][_0x1d5480(0x1d9)](_0x20c712),console['log'](_0x1d5480(0x205)+_0x20c712);}catch(_0x231f61){console[_0x1d5480(0x1b2)](_0x1d5480(0x200),_0x231f61);}}if(_0x184759[_0x1d5480(0x1ed)]!==_0xb91cfa){console[_0x1d5480(0x186)](_0x1d5480(0x1f0)+_0x20c712+_0x1d5480(0x19c)+_0x184759['status']+'\x20to\x20'+_0xb91cfa+_0x1d5480(0x1c5));try{let _0x37891d;switch(_0xb91cfa['toUpperCase']()){case _0x1d5480(0x1ce):_0x37891d=_0x1d5480(0x1a9);break;case'PROCESSING':_0x37891d=_0x1d5480(0x16b);break;case _0x1d5480(0x1c7):_0x37891d=_0x1d5480(0x17f);break;case'EXPIRED':_0x37891d=_0x1d5480(0x195);break;case _0x1d5480(0x1e9):_0x37891d=_0x1d5480(0x201);break;case _0x1d5480(0x1c2):_0x37891d=_0x1d5480(0x1c1);break;default:console[_0x1d5480(0x186)](_0x1d5480(0x1d0)+_0xb91cfa);break;}if(_0x37891d){const _0x34a611={..._0x378486,'shopId':_0x184759[_0x1d5480(0x16a)],'gateway':_0x184759[_0x1d5480(0x18d)],'createdAt':_0x184759[_0x1d5480(0x1a7)],'chargebackAmount':_0x30edf0};await telegramBotService_1[_0x1d5480(0x1c3)][_0x1d5480(0x20c)](_0x184759[_0x1d5480(0x16a)],_0x34a611,_0x37891d),console['log'](_0x1d5480(0x1f8)+_0x184759['status']+'\x20->\x20'+_0xb91cfa);}}catch(_0xe0ea76){console['error'](_0x1d5480(0x1d5),_0xe0ea76);}}_0x375464[_0x1d5480(0x1fd)]({'success':!![],'message':'Payment\x20updated\x20successfully','result':_0x378486});}catch(_0x598ed8){_0x3b5cb9(_0x598ed8);}},this[_0x36cee9(0x1a0)]=async(_0x475c48,_0x5ca3cb,_0x31ebd1)=>{const _0x1c175d=_0x36cee9;try{const {id:_0x16f17a}=_0x475c48[_0x1c175d(0x1bc)],_0xb58945=_0x475c48['body'];console[_0x1c175d(0x186)](_0x1c175d(0x210)+_0x16f17a+':',_0xb58945);const _0x2d0c93=await this['adminService'][_0x1c175d(0x1a0)](_0x16f17a,_0xb58945);_0x5ca3cb['json']({'success':!![],'message':_0x1c175d(0x18e),'result':_0x2d0c93});}catch(_0xbc4403){_0x31ebd1(_0xbc4403);}},this[_0x36cee9(0x196)]=async(_0x53e4c5,_0x30cd5d,_0x20eb70)=>{const _0x2cee02=_0x36cee9;try{const {id:_0xdaee6f}=_0x53e4c5[_0x2cee02(0x1bc)],_0x46d6d4=_0x53e4c5['body'],_0x751bd2=await this[_0x2cee02(0x1ba)][_0x2cee02(0x196)](_0xdaee6f,_0x46d6d4);_0x30cd5d[_0x2cee02(0x1fd)]({'success':!![],'message':_0x2cee02(0x19d),'result':_0x751bd2});}catch(_0x172f22){_0x20eb70(_0x172f22);}},this[_0x36cee9(0x1ab)]=async(_0x360ccb,_0x3dc929,_0x417832)=>{const _0x1a3e47=_0x36cee9;try{const {id:_0x3f1c0d}=_0x360ccb[_0x1a3e47(0x1bc)],_0x117618=await this[_0x1a3e47(0x1ba)][_0x1a3e47(0x1ab)](_0x3f1c0d);_0x3dc929['json']({'success':!![],'message':_0x1a3e47(0x19f),'result':_0x117618});}catch(_0x1ac513){_0x417832(_0x1ac513);}},this[_0x36cee9(0x184)]=async(_0x578390,_0x9cf670,_0x1f4970)=>{const _0x19a9f4=_0x36cee9;try{const {id:_0x221496}=_0x578390[_0x19a9f4(0x1bc)],_0x5f4f06=await this[_0x19a9f4(0x1ba)][_0x19a9f4(0x184)](_0x221496);_0x9cf670[_0x19a9f4(0x1fd)]({'success':!![],'message':_0x19a9f4(0x178),'result':_0x5f4f06});}catch(_0x55fb2){_0x1f4970(_0x55fb2);}},this[_0x36cee9(0x216)]=async(_0x2a3a09,_0x697ad0,_0x42bde9)=>{const _0x197d8c=_0x36cee9;try{const {page:page=0x1,limit:limit=0x14,status:_0x50109e,search:_0x18399c}=_0x2a3a09[_0x197d8c(0x198)],_0x17ae7b={'page':Number(page),'limit':Number(limit),'status':_0x50109e,'search':_0x18399c},_0x68491=await this[_0x197d8c(0x1ba)][_0x197d8c(0x1db)](_0x17ae7b);_0x697ad0['json']({'success':!![],'users':_0x68491[_0x197d8c(0x1ef)],'pagination':_0x68491[_0x197d8c(0x1b7)]});}catch(_0x59b5e8){_0x42bde9(_0x59b5e8);}},this[_0x36cee9(0x1fb)]=async(_0xc3e38c,_0x5c518e,_0x48b8aa)=>{const _0x409960=_0x36cee9;try{const {id:_0x2ff11b}=_0xc3e38c['params'],_0x336196=await this[_0x409960(0x1ba)][_0x409960(0x1fb)](_0x2ff11b);if(!_0x336196)return _0x5c518e[_0x409960(0x1ed)](0x194)[_0x409960(0x1fd)]({'success':![],'message':_0x409960(0x1b3)});_0x5c518e['json']({'success':!![],'result':_0x336196});}catch(_0x241d73){_0x48b8aa(_0x241d73);}},this[_0x36cee9(0x218)]=async(_0x1c9e23,_0x2c2c3d,_0x5c0d44)=>{const _0x2a6610=_0x36cee9;try{const _0x3658c8=_0x1c9e23[_0x2a6610(0x17d)],_0x53c0d1=await this[_0x2a6610(0x1ba)]['createUser'](_0x3658c8);_0x2c2c3d['status'](0xc9)[_0x2a6610(0x1fd)]({'success':!![],'message':_0x2a6610(0x1d1),'result':_0x53c0d1});}catch(_0x56e166){_0x5c0d44(_0x56e166);}},this['deleteUser']=async(_0x156ba0,_0x12b02a,_0x4ddc32)=>{const _0x5c364c=_0x36cee9;try{const {id:_0x8f3883}=_0x156ba0[_0x5c364c(0x1bc)],{twoFactorToken:_0x3176de}=_0x156ba0[_0x5c364c(0x17d)];await this[_0x5c364c(0x1ba)]['deleteUser'](_0x8f3883,_0x3176de),_0x12b02a[_0x5c364c(0x1fd)]({'success':!![],'message':_0x5c364c(0x174)});}catch(_0x3cf210){_0x4ddc32(_0x3cf210);}},this[_0x36cee9(0x206)]=async(_0x398b16,_0x2ef22d,_0x4ef272)=>{const _0x245999=_0x36cee9;try{const {shopId:_0x14a761}=_0x398b16[_0x245999(0x1bc)],_0x4c35d1=await this[_0x245999(0x1ba)][_0x245999(0x206)](_0x14a761);_0x2ef22d[_0x245999(0x1fd)]({'success':!![],'wallets':_0x4c35d1});}catch(_0x154b99){_0x4ef272(_0x154b99);}},this[_0x36cee9(0x1b8)]=async(_0x64b2c6,_0x573fc4,_0x18985d)=>{const _0x59d660=_0x36cee9;try{const {shopId:_0xda541c}=_0x64b2c6['params'],_0x4927a0=await this[_0x59d660(0x1ba)]['setup2FA'](_0xda541c);_0x573fc4[_0x59d660(0x1fd)]({'success':!![],'result':_0x4927a0});}catch(_0x31d4de){_0x18985d(_0x31d4de);}},this[_0x36cee9(0x1ea)]=async(_0x4a1b3b,_0x2c4db8,_0x4bcf44)=>{const _0x2a3781=_0x36cee9;try{const {shopId:_0x10ddd6}=_0x4a1b3b[_0x2a3781(0x1bc)],{token:_0x1f168c}=_0x4a1b3b['body'];if(!_0x1f168c)return _0x2c4db8['status'](0x190)[_0x2a3781(0x1fd)]({'success':![],'message':_0x2a3781(0x1c9)});const _0x5dcf14=await this['adminService']['enable2FA'](_0x10ddd6,_0x1f168c);_0x2c4db8[_0x2a3781(0x1fd)]({'success':!![],'message':_0x2a3781(0x20e),'result':_0x5dcf14});}catch(_0x134376){_0x4bcf44(_0x134376);}},this['disable2FA']=async(_0x3ea39a,_0x4fde88,_0x31397c)=>{const _0x4606e4=_0x36cee9;try{const {shopId:_0x3f9128}=_0x3ea39a[_0x4606e4(0x1bc)];await this[_0x4606e4(0x1ba)]['disable2FA'](_0x3f9128),_0x4fde88[_0x4606e4(0x1fd)]({'success':!![],'message':_0x4606e4(0x1cb)});}catch(_0x47c271){_0x31397c(_0x47c271);}},this[_0x36cee9(0x1c4)]=async(_0x3deb68,_0x52c57d,_0x4e1135)=>{const _0x41527f=_0x36cee9;try{const _0x1c61b5=await paymentCleanupService_1[_0x41527f(0x173)][_0x41527f(0x1c4)]();_0x52c57d[_0x41527f(0x1fd)]({'success':!![],'result':_0x1c61b5});}catch(_0x2e8b11){_0x4e1135(_0x2e8b11);}},this[_0x36cee9(0x1b9)]=async(_0x4d4908,_0x168da9,_0xb278f4)=>{const _0x57ec45=_0x36cee9;try{console[_0x57ec45(0x186)](_0x57ec45(0x1a4)+_0x4d4908['user']?.['username']+'\x20('+_0x4d4908[_0x57ec45(0x183)]?.['id']+')');const _0x1040f1=await paymentCleanupService_1[_0x57ec45(0x173)][_0x57ec45(0x207)]();_0x168da9[_0x57ec45(0x1fd)]({'success':!![],'message':'PROCESSING\x20payment\x20cleanup\x20completed\x20successfully','result':{'processed':_0x1040f1['processed'],'failed':_0x1040f1[_0x57ec45(0x17f)],'errors':_0x1040f1[_0x57ec45(0x211)]}});}catch(_0x450ee8){_0xb278f4(_0x450ee8);}},this['cleanupStalePendingPayments']=async(_0x3efb5c,_0x423c79,_0x1b0946)=>{const _0x10ce27=_0x36cee9;try{console[_0x10ce27(0x186)](_0x10ce27(0x1cf)+_0x3efb5c[_0x10ce27(0x183)]?.[_0x10ce27(0x18c)]+'\x20('+_0x3efb5c['user']?.['id']+')');const _0x1cb849=await paymentCleanupService_1[_0x10ce27(0x173)][_0x10ce27(0x18b)]();_0x423c79[_0x10ce27(0x1fd)]({'success':!![],'message':_0x10ce27(0x1df),'result':{'processed':_0x1cb849[_0x10ce27(0x179)],'failed':_0x1cb849[_0x10ce27(0x17f)],'errors':_0x1cb849['errors']}});}catch(_0x5459fc){_0x1b0946(_0x5459fc);}},this['cleanupStalePaymentsWithReport']=async(_0x5c2ac3,_0x4ac088,_0x2a7bd8)=>{const _0x3f3db5=_0x36cee9;try{console[_0x3f3db5(0x186)](_0x3f3db5(0x1ae)+_0x5c2ac3[_0x3f3db5(0x183)]?.['username']+'\x20('+_0x5c2ac3[_0x3f3db5(0x183)]?.['id']+')');const _0x186072=await paymentCleanupService_1['paymentCleanupService'][_0x3f3db5(0x1c4)](),_0x2341ae=await paymentCleanupService_1[_0x3f3db5(0x173)][_0x3f3db5(0x207)](),_0x5f6dec=await paymentCleanupService_1[_0x3f3db5(0x173)][_0x3f3db5(0x18b)](),_0x3b67c7=await paymentCleanupService_1['paymentCleanupService'][_0x3f3db5(0x1c4)]();_0x4ac088['json']({'success':!![],'message':_0x3f3db5(0x1a6),'result':{'cleanup':{'processing':{'processed':_0x2341ae[_0x3f3db5(0x179)],'failed':_0x2341ae[_0x3f3db5(0x17f)],'errors':_0x2341ae[_0x3f3db5(0x211)]},'pending':{'processed':_0x5f6dec['processed'],'failed':_0x5f6dec['failed'],'errors':_0x5f6dec[_0x3f3db5(0x211)]},'total':{'processed':_0x2341ae['processed']+_0x5f6dec[_0x3f3db5(0x179)],'failed':_0x2341ae[_0x3f3db5(0x17f)]+_0x5f6dec[_0x3f3db5(0x17f)],'errors':[..._0x2341ae[_0x3f3db5(0x211)],..._0x5f6dec[_0x3f3db5(0x211)]]}},'statistics':{'before':_0x186072,'after':_0x3b67c7,'reduced':_0x186072[_0x3f3db5(0x16e)]-_0x3b67c7[_0x3f3db5(0x16e)]}}});}catch(_0x49503e){_0x2a7bd8(_0x49503e);}},this[_0x36cee9(0x176)]=async(_0x5c40d0,_0x25aeaf,_0x224838)=>{const _0x1be56=_0x36cee9;try{const _0x39ff63=await paymentCleanupService_1[_0x1be56(0x173)][_0x1be56(0x1e2)]();_0x25aeaf[_0x1be56(0x1fd)]({'success':!![],'message':_0x1be56(0x16f),'result':{'expired':_0x39ff63[_0x1be56(0x195)],'errors':_0x39ff63[_0x1be56(0x211)]}});}catch(_0x534f76){_0x224838(_0x534f76);}},this[_0x36cee9(0x1e1)]=async(_0x533610,_0x29e5f3,_0x369d04)=>{const _0x53144e=_0x36cee9;try{const {currentPassword:_0x27064a,newPassword:_0x1ce643,confirmNewPassword:_0x2a67e5,twoFactorToken:_0x4be682}=_0x533610[_0x53144e(0x17d)];await this[_0x53144e(0x1ba)][_0x53144e(0x1e1)](_0x27064a,_0x1ce643,_0x2a67e5,_0x4be682),_0x29e5f3[_0x53144e(0x1fd)]({'success':!![],'message':_0x53144e(0x1fa)});}catch(_0x1d9d1e){_0x369d04(_0x1d9d1e);}},this['get2FASettings']=async(_0x55ebcb,_0x4e5709,_0x1670c8)=>{const _0x41e06c=_0x36cee9;try{const _0x319e16=await this[_0x41e06c(0x1ba)]['get2FASettings']();_0x4e5709[_0x41e06c(0x1fd)]({'success':!![],'result':_0x319e16});}catch(_0x21edb0){_0x1670c8(_0x21edb0);}},this[_0x36cee9(0x1cd)]=async(_0x83cbbd,_0x2a5bfd,_0x2e67fa)=>{const _0x19ceab=_0x36cee9;try{const _0x30b5eb=await this[_0x19ceab(0x1ba)][_0x19ceab(0x1cd)]();_0x2a5bfd[_0x19ceab(0x1fd)]({'success':!![],'result':_0x30b5eb});}catch(_0x92b3d6){_0x2e67fa(_0x92b3d6);}},this[_0x36cee9(0x220)]=async(_0x17cc95,_0x3627a9,_0x4e3cc1)=>{const _0x40f378=_0x36cee9;try{const {token:_0x3c9e25}=_0x17cc95[_0x40f378(0x17d)],_0x1a00a9=await this[_0x40f378(0x1ba)]['enableAdmin2FA'](_0x3c9e25);_0x3627a9['json']({'success':!![],'result':_0x1a00a9});}catch(_0x8e993a){_0x4e3cc1(_0x8e993a);}},this[_0x36cee9(0x187)]=async(_0x4f87c7,_0x14c92f,_0x34a5d9)=>{const _0x399120=_0x36cee9;try{await this[_0x399120(0x1ba)]['disableAdmin2FA'](),_0x14c92f['json']({'success':!![],'message':'Admin\x202FA\x20disabled\x20successfully'});}catch(_0x15dbdf){_0x34a5d9(_0x15dbdf);}},this[_0x36cee9(0x20a)]=async(_0x53cc74,_0x386d6f,_0x37e0d7)=>{const _0x4dfd80=_0x36cee9;try{const {shopId:_0x2fa556,amount:_0x92d6e4,notes:_0x2f6cd3}=_0x53cc74[_0x4dfd80(0x17d)];if(!_0x2fa556||!_0x92d6e4)return _0x386d6f[_0x4dfd80(0x1ed)](0x190)['json']({'success':![],'message':_0x4dfd80(0x18a)});if(_0x92d6e4<=0x0)return _0x386d6f[_0x4dfd80(0x1ed)](0x190)['json']({'success':![],'message':_0x4dfd80(0x214)});await this[_0x4dfd80(0x1ba)][_0x4dfd80(0x20a)](_0x2fa556,_0x92d6e4,_0x2f6cd3),_0x386d6f[_0x4dfd80(0x1fd)]({'success':!![],'message':'Balance\x20deposited\x20successfully'});}catch(_0x23605e){_0x37e0d7(_0x23605e);}},this[_0x36cee9(0x17b)]=async(_0x50a03f,_0x209942,_0x214ba5)=>{const _0x3c106a=_0x36cee9;try{const {shopId:_0x319c75}=_0x50a03f['params'],{page:page='1',limit:limit='20'}=_0x50a03f['query'],_0x4ec2ba=(await Promise[_0x3c106a(0x1a1)]()['then'](()=>__importStar(require(_0x3c106a(0x1c6)))))[_0x3c106a(0x1f3)],_0x4a865f=parseInt(page,0xa),_0x4d22c5=parseInt(limit,0xa),_0x20fc19=(_0x4a865f-0x1)*_0x4d22c5,[_0x58a27c,_0x49979d]=await Promise[_0x3c106a(0x1f7)]([_0x4ec2ba[_0x3c106a(0x180)][_0x3c106a(0x1ff)]({'where':{'shopId':_0x319c75},'orderBy':{'createdAt':'desc'},'skip':_0x20fc19,'take':_0x4d22c5}),_0x4ec2ba[_0x3c106a(0x180)]['count']({'where':{'shopId':_0x319c75}})]);_0x209942[_0x3c106a(0x1fd)]({'success':!![],'result':{'logs':_0x58a27c,'pagination':{'page':_0x4a865f,'limit':_0x4d22c5,'total':_0x49979d,'totalPages':Math[_0x3c106a(0x16c)](_0x49979d/_0x4d22c5)}}});}catch(_0x5382a1){_0x214ba5(_0x5382a1);}},this['getGatewaySettings']=async(_0x4145b9,_0x5c2082,_0x504b2c)=>{const _0x88bfc2=_0x36cee9;try{const _0x465a73=gatewaySettingsService_1[_0x88bfc2(0x191)]['getAllGatewaysWithSettings']();_0x5c2082[_0x88bfc2(0x1fd)]({'success':!![],'result':_0x465a73});}catch(_0x2f8fb9){_0x504b2c(_0x2f8fb9);}},this[_0x36cee9(0x166)]=async(_0x316472,_0x538b5d,_0x342a93)=>{const _0x2a8df3=_0x36cee9;try{const {gatewayId:_0x5a5f4a}=_0x316472[_0x2a8df3(0x1bc)],{minAmount:_0x2488a3,maxAmount:_0x496496,payoutDelay:_0x460e6f,gatewayCommission:_0x5cbdd1}=_0x316472[_0x2a8df3(0x17d)],_0x4a1993=gatewaySettingsService_1[_0x2a8df3(0x191)][_0x2a8df3(0x20f)](_0x5a5f4a,{'minAmount':_0x2488a3!==undefined?Number(_0x2488a3):undefined,'maxAmount':_0x496496!==undefined?Number(_0x496496):undefined,'payoutDelay':_0x460e6f!==undefined?Number(_0x460e6f):undefined,'gatewayCommission':_0x5cbdd1!==undefined?Number(_0x5cbdd1):undefined});_0x538b5d[_0x2a8df3(0x1fd)]({'success':!![],'message':_0x2a8df3(0x194),'result':_0x4a1993});}catch(_0x5d9570){_0x342a93(_0x5d9570);}},this['getGatewayStatistics']=async(_0x2b0e22,_0x1cce7d,_0x14d582)=>{const _0x20b83d=_0x36cee9;try{const {gatewayId:_0x1327ce}=_0x2b0e22[_0x20b83d(0x1bc)];console[_0x20b83d(0x186)](_0x20b83d(0x181)+_0x1327ce);const {GATEWAY_ID_MAP:_0x32d7b8}=await Promise['resolve']()[_0x20b83d(0x199)](()=>__importStar(require(_0x20b83d(0x197)))),_0x1bc0e5=_0x32d7b8[_0x1327ce];console[_0x20b83d(0x186)]('ðŸ“Š\x20[GATEWAY\x20STATS]\x20Gateway\x20ID\x20'+_0x1327ce+_0x20b83d(0x192)+_0x1bc0e5);if(!_0x1bc0e5)return console[_0x20b83d(0x186)](_0x20b83d(0x168)+_0x1327ce),_0x1cce7d[_0x20b83d(0x1ed)](0x194)[_0x20b83d(0x1fd)]({'success':![],'message':_0x20b83d(0x1f5)});console['log'](_0x20b83d(0x1d3)+_0x1bc0e5+_0x20b83d(0x1f6));const _0x40fdb8=await database_1[_0x20b83d(0x1f3)][_0x20b83d(0x1a5)][_0x20b83d(0x1ff)]({'where':{'gateway':_0x1bc0e5},'select':{'id':!![],'status':!![],'amountUSDT':!![]},'take':0x5});console[_0x20b83d(0x186)](_0x20b83d(0x172)+_0x1bc0e5+':',JSON[_0x20b83d(0x1b1)](_0x40fdb8,null,0x2));const _0x3a532d=await database_1[_0x20b83d(0x1f3)][_0x20b83d(0x1a5)][_0x20b83d(0x1ff)]({'where':{'gateway':_0x1bc0e5,'status':_0x20b83d(0x1ce)},'select':{'amountUSDT':!![]}});console['log'](_0x20b83d(0x1ee)+_0x3a532d[_0x20b83d(0x1ca)]+_0x20b83d(0x1d7)+_0x1bc0e5);const _0x298672=await database_1['default']['payment']['count']({'where':{'gateway':_0x1bc0e5,'status':'PAID'}}),_0x2dc944=await database_1[_0x20b83d(0x1f3)]['payment']['count']({'where':{'gateway':_0x1bc0e5,'status':_0x20b83d(0x1c2)}});console['log'](_0x20b83d(0x193)+_0x2dc944);const _0x2e9d95=await database_1['default'][_0x20b83d(0x1a5)]['count']({'where':{'gateway':_0x1bc0e5,'status':'REFUND'}});console[_0x20b83d(0x186)](_0x20b83d(0x1ec)+_0x2e9d95);const {gatewaySettingsService:_0x4ea73e}=await Promise[_0x20b83d(0x1a1)]()[_0x20b83d(0x199)](()=>__importStar(require(_0x20b83d(0x202)))),_0x244ab6=_0x4ea73e[_0x20b83d(0x17c)](_0x1327ce),_0x5d9c1f=_0x244ab6?.[_0x20b83d(0x19b)]||0x0;console[_0x20b83d(0x186)](_0x20b83d(0x18f)+_0x5d9c1f+'%');let _0x409d25=0x0,_0x5ca3a5=0x0;_0x3a532d[_0x20b83d(0x1e8)](_0xc3b11f=>{const _0x5d8ed5=_0x20b83d,_0x4cada6=_0xc3b11f[_0x5d8ed5(0x1d4)]||0x0;_0x409d25+=_0x4cada6;const _0x3d2caa=_0x4cada6*(_0x5d9c1f/0x64);_0x5ca3a5+=_0x3d2caa;});const _0x3d99dd=_0x298672,_0x8d7f26=_0x3d99dd>0x0?_0x2dc944/_0x3d99dd*0x64:0x0;console['log'](_0x20b83d(0x1da)),console[_0x20b83d(0x186)](_0x20b83d(0x175)+_0x409d25),console[_0x20b83d(0x186)](_0x20b83d(0x213)+_0x5ca3a5),console[_0x20b83d(0x186)](_0x20b83d(0x219)+_0x3d99dd),console[_0x20b83d(0x186)](_0x20b83d(0x1a2)+_0x8d7f26+'%'),_0x1cce7d[_0x20b83d(0x1fd)]({'success':!![],'result':{'gatewayId':_0x1327ce,'totalTurnover':Number(_0x409d25[_0x20b83d(0x1dd)](0x2)),'totalCommission':Number(_0x5ca3a5[_0x20b83d(0x1dd)](0x2)),'successfulPayments':_0x3d99dd,'chargebackCount':_0x2dc944,'chargebackRate':Number(_0x8d7f26[_0x20b83d(0x1dd)](0x2)),'refundCount':_0x2e9d95}});}catch(_0x3bf5ed){console['error'](_0x20b83d(0x21e),_0x3bf5ed),_0x14d582(_0x3bf5ed);}},this['adminService']=new adminService_1[(_0x36cee9(0x209))](),this['paymentLinkService']=new paymentLinkService_1['PaymentLinkService']();}}exports[a4_0x28c709(0x1b6)]=AdminController;