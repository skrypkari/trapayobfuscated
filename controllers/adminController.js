'use strict';const a3_0x5149cd=a3_0x3405;(function(_0x5557ad,_0x5a4537){const _0x222181=a3_0x3405,_0x3f2ffa=_0x5557ad();while(!![]){try{const _0x25cf96=parseInt(_0x222181(0x1dc))/0x1*(-parseInt(_0x222181(0x1e7))/0x2)+-parseInt(_0x222181(0x1e0))/0x3*(parseInt(_0x222181(0x1b1))/0x4)+parseInt(_0x222181(0x1b8))/0x5*(parseInt(_0x222181(0x1d1))/0x6)+parseInt(_0x222181(0x1cb))/0x7*(parseInt(_0x222181(0x1f6))/0x8)+-parseInt(_0x222181(0x1ff))/0x9*(-parseInt(_0x222181(0x1f8))/0xa)+parseInt(_0x222181(0x202))/0xb*(parseInt(_0x222181(0x1b7))/0xc)+-parseInt(_0x222181(0x1ec))/0xd;if(_0x25cf96===_0x5a4537)break;else _0x3f2ffa['push'](_0x3f2ffa['shift']());}catch(_0xfa6748){_0x3f2ffa['push'](_0x3f2ffa['shift']());}}}(a3_0x315b,0x1df44));function a3_0x3405(_0x319d67,_0x148816){const _0x315b27=a3_0x315b();return a3_0x3405=function(_0x3405bf,_0x400096){_0x3405bf=_0x3405bf-0x1a6;let _0x4b3dbc=_0x315b27[_0x3405bf];return _0x4b3dbc;},a3_0x3405(_0x319d67,_0x148816);}Object['defineProperty'](exports,'__esModule',{'value':!![]}),exports[a3_0x5149cd(0x1d8)]=void 0x0;const adminService_1=require('../services/adminService'),paymentLinkService_1=require(a3_0x5149cd(0x1ca)),telegramBotService_1=require(a3_0x5149cd(0x1bf));function a3_0x315b(){const _0x2036ab=['sendPaymentNotification','âœ…\x20Payment\x20link\x20counter\x20updated\x20for\x20payment\x20','failed','âœ…\x20Telegram\x20notification\x20sent\x20for\x20status\x20change:\x20','2851992BVsrlI','pagination',',\x20sending\x20Telegram\x20notification','\x20->\x20','summary','getSystemStatistics','adminService','getAllUsers','params','EXPIRED','8GaVtod','getPayments','1030cWKebb','getUsers','gateway','status','json','updatePayment','PaymentLinkService','17874utzOiL','role','getStatistics','346742BEmgcB','\x20to\x20PAID,\x20updating\x20payment\x20link\x20counter','handleSuccessfulPayment','getPayouts','paymentLinkService','updateCustomerData','log','User\x20suspended\x20successfully','ðŸ“Š\x20Admin\x20requesting\x20merchant\x20statistics\x20with\x20filters:','Payout\x20not\x20found','ðŸ”„\x20Admin\x20updating\x20customer\x20data\x20for\x20payment\x20','getPaymentById','Failed\x20to\x20send\x20Telegram\x20notification\x20for\x20status\x20change:','body','12720brIwnG','User\x20updated\x20successfully','expired','getUserById','Payout\x20deleted\x20successfully','Payment\x20not\x20found','36YYpQib','25BYmYlO','paid','ðŸ“±\x20Payment\x20','getPayoutStats','getPayoutById','activateUser','query','../services/telegramBotService','users','merchants','getMerchantsAwaitingPayout','\x20status\x20changed\x20from\x20','user','updateUser','ðŸ“ˆ\x20Admin\x20changed\x20payment\x20','refund','createdAt','Payment\x20updated\x20successfully','../services/paymentLinkService','284326JSsEQj','payments','deletePayout','createUser','PROCESSING','getAllPayments','285438azmUGx','updatePaymentStatus','error','Customer\x20data\x20updated\x20successfully','toUpperCase','Payout\x20created\x20successfully','shopId','AdminController','getMerchantStatistics','30d','User\x20not\x20found','22471aSVrib','\x20to\x20','AdminService','month','201pgMzgO','deleteUser','suspendUser','FAILED','payouts','createPayout','telegramBotService','2WGnElk'];a3_0x315b=function(){return _0x2036ab;};return a3_0x315b();}class AdminController{constructor(){const _0x3ecddd=a3_0x5149cd;this['checkAuth']=async(_0x1497c6,_0x3d53ca,_0xabcbcf)=>{const _0x4ca3aa=a3_0x3405;try{const _0x424801=_0x1497c6[_0x4ca3aa(0x1c4)];_0x3d53ca[_0x4ca3aa(0x1fc)]({'success':!![],'message':'Admin\x20access\x20confirmed','user':{'id':_0x424801?.['id'],'username':_0x424801?.['username'],'role':_0x424801?.[_0x4ca3aa(0x200)]}});}catch(_0x1a0919){_0xabcbcf(_0x1a0919);}},this[_0x3ecddd(0x201)]=async(_0x276e6c,_0x1ed160,_0x2c7356)=>{const _0x43d40e=_0x3ecddd;try{const {period:period=_0x43d40e(0x1da)}=_0x276e6c[_0x43d40e(0x1be)],_0x36bcd4=await this['adminService'][_0x43d40e(0x1f1)](period);_0x1ed160['json']({'success':!![],'result':_0x36bcd4});}catch(_0x31192d){_0x2c7356(_0x31192d);}},this['getMerchantStatistics']=async(_0x1c1ce3,_0x550aa3,_0x53d406)=>{const _0x47b856=_0x3ecddd;try{const {shopId:_0xd3ae5c,period:period=_0x47b856(0x1df),dateFrom:_0x30c557,dateTo:_0xe6d2f4}=_0x1c1ce3['query'],_0x32aa8c={'shopId':_0xd3ae5c,'period':period,'dateFrom':_0x30c557,'dateTo':_0xe6d2f4};console[_0x47b856(0x1a9)](_0x47b856(0x1ab),_0x32aa8c);const _0x25d922=await this[_0x47b856(0x1f2)][_0x47b856(0x1d9)](_0x32aa8c);_0x550aa3[_0x47b856(0x1fc)]({'success':!![],'result':_0x25d922});}catch(_0x45b775){_0x53d406(_0x45b775);}},this[_0x3ecddd(0x1bb)]=async(_0x287c0f,_0x4ac745,_0x107722)=>{const _0x32e54f=_0x3ecddd;try{const _0x218d78=await this['adminService'][_0x32e54f(0x1bb)]();_0x4ac745[_0x32e54f(0x1fc)]({'success':!![],'result':_0x218d78});}catch(_0x4706bf){_0x107722(_0x4706bf);}},this[_0x3ecddd(0x1c2)]=async(_0xf40a8b,_0x3965b6,_0x4b6db9)=>{const _0x4d2e33=_0x3ecddd;try{const {page:page=0x1,limit:limit=0x14,minAmount:_0xe1accc,search:_0x3d7a75}=_0xf40a8b[_0x4d2e33(0x1be)],_0x305b27={'page':Number(page),'limit':Number(limit),'minAmount':_0xe1accc?Number(_0xe1accc):undefined,'search':_0x3d7a75},_0x2ec13e=await this[_0x4d2e33(0x1f2)][_0x4d2e33(0x1c2)](_0x305b27);_0x3965b6['json']({'success':!![],'merchants':_0x2ec13e[_0x4d2e33(0x1c1)],'pagination':_0x2ec13e[_0x4d2e33(0x1ed)],'summary':_0x2ec13e[_0x4d2e33(0x1f0)]});}catch(_0x37cb2b){_0x4b6db9(_0x37cb2b);}},this[_0x3ecddd(0x1e5)]=async(_0x3bedc4,_0x4b1937,_0x5ba06f)=>{const _0x179e23=_0x3ecddd;try{const _0x2e0270=_0x3bedc4[_0x179e23(0x1b0)],_0x56264e=await this[_0x179e23(0x1f2)][_0x179e23(0x1e5)](_0x2e0270);_0x4b1937['status'](0xc9)[_0x179e23(0x1fc)]({'success':!![],'message':_0x179e23(0x1d6),'result':_0x56264e});}catch(_0x4c8062){_0x5ba06f(_0x4c8062);}},this[_0x3ecddd(0x1a6)]=async(_0x5b5e24,_0x486119,_0x503046)=>{const _0x5e7b9c=_0x3ecddd;try{const {page:page=0x1,limit:limit=0x14,shopId:_0x7254ca,network:_0x48f087,dateFrom:_0x5090af,dateTo:_0x370111,search:_0x537ef4}=_0x5b5e24[_0x5e7b9c(0x1be)],_0x359653={'page':Number(page),'limit':Number(limit),'shopId':_0x7254ca,'network':_0x48f087,'dateFrom':_0x5090af,'dateTo':_0x370111,'search':_0x537ef4},_0x34d071=await this[_0x5e7b9c(0x1f2)]['getAllPayouts'](_0x359653);_0x486119['json']({'success':!![],'payouts':_0x34d071[_0x5e7b9c(0x1e4)],'pagination':_0x34d071[_0x5e7b9c(0x1ed)]});}catch(_0x31302f){_0x503046(_0x31302f);}},this[_0x3ecddd(0x1bc)]=async(_0x1c43fa,_0x5dc366,_0x1edc79)=>{const _0x589b7b=_0x3ecddd;try{const {id:_0xcb57a5}=_0x1c43fa[_0x589b7b(0x1f4)],_0x58a808=await this[_0x589b7b(0x1f2)]['getPayoutById'](_0xcb57a5);if(!_0x58a808)return _0x5dc366[_0x589b7b(0x1fb)](0x194)[_0x589b7b(0x1fc)]({'success':![],'message':_0x589b7b(0x1ac)});_0x5dc366['json']({'success':!![],'result':_0x58a808});}catch(_0x5141eb){_0x1edc79(_0x5141eb);}},this[_0x3ecddd(0x1cd)]=async(_0x1ac55e,_0x2773ec,_0x585fb1)=>{const _0x13de8b=_0x3ecddd;try{const {id:_0x1a94de}=_0x1ac55e[_0x13de8b(0x1f4)];await this[_0x13de8b(0x1f2)][_0x13de8b(0x1cd)](_0x1a94de),_0x2773ec[_0x13de8b(0x1fc)]({'success':!![],'message':_0x13de8b(0x1b5)});}catch(_0x560bc4){_0x585fb1(_0x560bc4);}},this[_0x3ecddd(0x1f7)]=async(_0x2d34d2,_0x57092a,_0x4e4b81)=>{const _0xf64f4c=_0x3ecddd;try{const {page:page=0x1,limit:limit=0x14,status:_0x54534e,gateway:_0x53f603,shopId:_0x56cdfc,dateFrom:_0x35ecc6,dateTo:_0x4861ba,search:_0xff155}=_0x2d34d2[_0xf64f4c(0x1be)],_0x424022={'page':Number(page),'limit':Number(limit),'status':_0x54534e,'gateway':_0x53f603,'shopId':_0x56cdfc,'dateFrom':_0x35ecc6,'dateTo':_0x4861ba,'search':_0xff155},_0x391c27=await this['adminService'][_0xf64f4c(0x1d0)](_0x424022);_0x57092a['json']({'success':!![],'payments':_0x391c27[_0xf64f4c(0x1cc)],'pagination':_0x391c27[_0xf64f4c(0x1ed)]});}catch(_0x208eb2){_0x4e4b81(_0x208eb2);}},this[_0x3ecddd(0x1ae)]=async(_0x25ac70,_0x3c3767,_0x320412)=>{const _0x38f588=_0x3ecddd;try{const {id:_0x5c6b01}=_0x25ac70[_0x38f588(0x1f4)],_0x1879b6=await this[_0x38f588(0x1f2)][_0x38f588(0x1ae)](_0x5c6b01);if(!_0x1879b6)return _0x3c3767[_0x38f588(0x1fb)](0x194)[_0x38f588(0x1fc)]({'success':![],'message':_0x38f588(0x1b6)});_0x3c3767[_0x38f588(0x1fc)]({'success':!![],'result':_0x1879b6});}catch(_0x1c2d9c){_0x320412(_0x1c2d9c);}},this[_0x3ecddd(0x1fd)]=async(_0x57e555,_0x3bd3f8,_0x19bdec)=>{const _0x353b6a=_0x3ecddd;try{const {id:_0x3d8eab}=_0x57e555['params'],{status:_0x216099,notes:_0x5d7641,chargebackAmount:_0x376f1a}=_0x57e555[_0x353b6a(0x1b0)],_0x51d29a=await this[_0x353b6a(0x1f2)][_0x353b6a(0x1ae)](_0x3d8eab);if(!_0x51d29a)return _0x3bd3f8['status'](0x194)[_0x353b6a(0x1fc)]({'success':![],'message':_0x353b6a(0x1b6)});const _0x54314e=await this['adminService'][_0x353b6a(0x1d2)](_0x3d8eab,_0x216099,_0x5d7641,_0x376f1a);if(_0x51d29a[_0x353b6a(0x1fb)]!==_0x216099&&_0x216099[_0x353b6a(0x1d5)]()==='PAID'){console['log'](_0x353b6a(0x1c6)+_0x3d8eab+_0x353b6a(0x203));try{await this[_0x353b6a(0x1a7)][_0x353b6a(0x204)](_0x3d8eab),console[_0x353b6a(0x1a9)](_0x353b6a(0x1e9)+_0x3d8eab);}catch(_0x17746c){console[_0x353b6a(0x1d3)]('Failed\x20to\x20update\x20payment\x20link\x20counter:',_0x17746c);}}if(_0x51d29a[_0x353b6a(0x1fb)]!==_0x216099){console[_0x353b6a(0x1a9)](_0x353b6a(0x1ba)+_0x3d8eab+_0x353b6a(0x1c3)+_0x51d29a['status']+_0x353b6a(0x1dd)+_0x216099+_0x353b6a(0x1ee));try{let _0x485553;switch(_0x216099['toUpperCase']()){case'PAID':_0x485553=_0x353b6a(0x1b9);break;case _0x353b6a(0x1cf):_0x485553='processing';break;case _0x353b6a(0x1e3):_0x485553=_0x353b6a(0x1ea);break;case _0x353b6a(0x1f5):_0x485553=_0x353b6a(0x1b3);break;case'REFUND':_0x485553=_0x353b6a(0x1c7);break;case'CHARGEBACK':_0x485553='chargeback';break;default:console['log']('ðŸ“±\x20Skipping\x20Telegram\x20notification\x20for\x20status\x20change\x20to:\x20'+_0x216099);break;}if(_0x485553){const _0x3e98a9={..._0x54314e,'shopId':_0x51d29a[_0x353b6a(0x1d7)],'gateway':_0x51d29a[_0x353b6a(0x1fa)],'createdAt':_0x51d29a[_0x353b6a(0x1c8)],'chargebackAmount':_0x376f1a};await telegramBotService_1[_0x353b6a(0x1e6)][_0x353b6a(0x1e8)](_0x51d29a[_0x353b6a(0x1d7)],_0x3e98a9,_0x485553),console[_0x353b6a(0x1a9)](_0x353b6a(0x1eb)+_0x51d29a[_0x353b6a(0x1fb)]+_0x353b6a(0x1ef)+_0x216099);}}catch(_0x1255d7){console[_0x353b6a(0x1d3)](_0x353b6a(0x1af),_0x1255d7);}}_0x3bd3f8[_0x353b6a(0x1fc)]({'success':!![],'message':_0x353b6a(0x1c9),'result':_0x54314e});}catch(_0x25597f){_0x19bdec(_0x25597f);}},this[_0x3ecddd(0x1a8)]=async(_0x5d38a7,_0x2cbd88,_0x2c0dfb)=>{const _0x128ccd=_0x3ecddd;try{const {id:_0x48ebb4}=_0x5d38a7[_0x128ccd(0x1f4)],_0x449718=_0x5d38a7[_0x128ccd(0x1b0)];console[_0x128ccd(0x1a9)](_0x128ccd(0x1ad)+_0x48ebb4+':',_0x449718);const _0x56b335=await this[_0x128ccd(0x1f2)][_0x128ccd(0x1a8)](_0x48ebb4,_0x449718);_0x2cbd88[_0x128ccd(0x1fc)]({'success':!![],'message':_0x128ccd(0x1d4),'result':_0x56b335});}catch(_0x4242ee){_0x2c0dfb(_0x4242ee);}},this[_0x3ecddd(0x1c5)]=async(_0xad8d7d,_0x2a4891,_0x5f064f)=>{const _0x230886=_0x3ecddd;try{const {id:_0x5881b2}=_0xad8d7d[_0x230886(0x1f4)],_0x172966=_0xad8d7d[_0x230886(0x1b0)],_0x24e6ba=await this[_0x230886(0x1f2)][_0x230886(0x1c5)](_0x5881b2,_0x172966);_0x2a4891['json']({'success':!![],'message':_0x230886(0x1b2),'result':_0x24e6ba});}catch(_0x2d0db9){_0x5f064f(_0x2d0db9);}},this[_0x3ecddd(0x1e2)]=async(_0x4861e7,_0x34483d,_0x144ff9)=>{const _0xcdea39=_0x3ecddd;try{const {id:_0x480291}=_0x4861e7['params'],_0x3622dc=await this[_0xcdea39(0x1f2)][_0xcdea39(0x1e2)](_0x480291);_0x34483d[_0xcdea39(0x1fc)]({'success':!![],'message':_0xcdea39(0x1aa),'result':_0x3622dc});}catch(_0x8c1d54){_0x144ff9(_0x8c1d54);}},this[_0x3ecddd(0x1bd)]=async(_0x197ff0,_0x4e5abd,_0x5cf3b0)=>{const _0x23e0ad=_0x3ecddd;try{const {id:_0x8516fc}=_0x197ff0['params'],_0x2273e3=await this[_0x23e0ad(0x1f2)]['activateUser'](_0x8516fc);_0x4e5abd[_0x23e0ad(0x1fc)]({'success':!![],'message':'User\x20activated\x20successfully','result':_0x2273e3});}catch(_0x645c2c){_0x5cf3b0(_0x645c2c);}},this[_0x3ecddd(0x1f9)]=async(_0x59ca99,_0x72e718,_0x19a28f)=>{const _0x227047=_0x3ecddd;try{const {page:page=0x1,limit:limit=0x14,status:_0x3c8e68}=_0x59ca99[_0x227047(0x1be)],_0x43e3db={'page':Number(page),'limit':Number(limit),'status':_0x3c8e68},_0xd6a32d=await this[_0x227047(0x1f2)][_0x227047(0x1f3)](_0x43e3db);_0x72e718['json']({'success':!![],'users':_0xd6a32d[_0x227047(0x1c0)],'pagination':_0xd6a32d['pagination']});}catch(_0xb34e89){_0x19a28f(_0xb34e89);}},this[_0x3ecddd(0x1b4)]=async(_0x34b04b,_0x3f8b08,_0x4d11f6)=>{const _0x1cf92d=_0x3ecddd;try{const {id:_0x555f56}=_0x34b04b[_0x1cf92d(0x1f4)],_0xc3cee7=await this[_0x1cf92d(0x1f2)][_0x1cf92d(0x1b4)](_0x555f56);if(!_0xc3cee7)return _0x3f8b08[_0x1cf92d(0x1fb)](0x194)['json']({'success':![],'message':_0x1cf92d(0x1db)});_0x3f8b08[_0x1cf92d(0x1fc)]({'success':!![],'result':_0xc3cee7});}catch(_0x5c36d3){_0x4d11f6(_0x5c36d3);}},this['createUser']=async(_0x58487f,_0xb7cd8d,_0x57a59f)=>{const _0x4bcca7=_0x3ecddd;try{const _0x371571=_0x58487f[_0x4bcca7(0x1b0)],_0x3c3d2e=await this[_0x4bcca7(0x1f2)][_0x4bcca7(0x1ce)](_0x371571);_0xb7cd8d[_0x4bcca7(0x1fb)](0xc9)[_0x4bcca7(0x1fc)]({'success':!![],'message':'User\x20created\x20successfully','result':_0x3c3d2e});}catch(_0xc6b71f){_0x57a59f(_0xc6b71f);}},this[_0x3ecddd(0x1e1)]=async(_0x792d75,_0x1c8f25,_0x5607ee)=>{const _0x3d3ea4=_0x3ecddd;try{const {id:_0x53b9c3}=_0x792d75[_0x3d3ea4(0x1f4)];await this['adminService'][_0x3d3ea4(0x1e1)](_0x53b9c3),_0x1c8f25[_0x3d3ea4(0x1fc)]({'success':!![],'message':'User\x20deleted\x20successfully'});}catch(_0x6413d8){_0x5607ee(_0x6413d8);}},this[_0x3ecddd(0x1f2)]=new adminService_1[(_0x3ecddd(0x1de))](),this[_0x3ecddd(0x1a7)]=new paymentLinkService_1[(_0x3ecddd(0x1fe))]();}}exports['AdminController']=AdminController;