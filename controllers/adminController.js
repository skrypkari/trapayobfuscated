'use strict';const a3_0x1880d6=a3_0x5e1d;function a3_0x5e1d(_0x3125e6,_0x24b586){const _0x57ae64=a3_0x57ae();return a3_0x5e1d=function(_0x5e1dba,_0x555111){_0x5e1dba=_0x5e1dba-0x9f;let _0x4f8ad1=_0x57ae64[_0x5e1dba];return _0x4f8ad1;},a3_0x5e1d(_0x3125e6,_0x24b586);}function a3_0x57ae(){const _0x558664=['adminService','getStatistics','getAllPayments','REFUND','getMerchantStatistics','chargeback','âœ…\x20Payment\x20link\x20counter\x20updated\x20for\x20payment\x20','User\x20activated\x20successfully','getUserById','5264970ECOwhO','createUser','updatePaymentStatus','__esModule','Payout\x20not\x20found','Payment\x20not\x20found','5021235lzbiOf','toUpperCase','error','7DvhcOK','paymentLinkService','8HYPWvS','Payout\x20deleted\x20successfully','4617948wjmaxE','body','refund','4438284WMqzFM','30d','query','gateway','failed','ðŸ“±\x20Skipping\x20Telegram\x20notification\x20for\x20status\x20change\x20to:\x20','../services/paymentLinkService','status','AdminController','payouts','User\x20not\x20found','PaymentLinkService',',\x20sending\x20Telegram\x20notification','role','month','json','ðŸ”„\x20Admin\x20updating\x20customer\x20data\x20for\x20payment\x20','Admin\x20access\x20confirmed','updateUser','activateUser','expired','getMerchantsAwaitingPayout','user','processing','suspendUser','pagination','getPaymentById','username','users','Payment\x20updated\x20successfully','getAllUsers','getMerchantsSelection','1670710pfCZWE','sendPaymentNotification','summary','User\x20deleted\x20successfully','ðŸ“Š\x20Admin\x20requesting\x20merchant\x20statistics\x20with\x20filters:','../services/telegramBotService','ðŸ“ˆ\x20Admin\x20changed\x20payment\x20','params','paid','Payout\x20created\x20successfully','getAllPayouts','\x20to\x20PAID,\x20updating\x20payment\x20link\x20counter','PAID','getSystemStatistics','712202HwXWsF','log','7023288ayVfAG','User\x20updated\x20successfully','updateCustomerData','shopId','CHARGEBACK','deletePayout','2pDmVax','createPayout','Failed\x20to\x20send\x20Telegram\x20notification\x20for\x20status\x20change:','payments','getPayoutById','updatePayment','defineProperty','deleteUser','\x20to\x20','getPayouts'];a3_0x57ae=function(){return _0x558664;};return a3_0x57ae();}(function(_0x369b6f,_0x438b43){const _0x16e256=a3_0x5e1d,_0xa2528e=_0x369b6f();while(!![]){try{const _0xb386a8=parseInt(_0x16e256(0xef))/0x1*(-parseInt(_0x16e256(0xf7))/0x2)+parseInt(_0x16e256(0xc1))/0x3+parseInt(_0x16e256(0xbc))/0x4*(parseInt(_0x16e256(0xe1))/0x5)+-parseInt(_0x16e256(0xbe))/0x6+-parseInt(_0x16e256(0xba))/0x7*(parseInt(_0x16e256(0xf1))/0x8)+parseInt(_0x16e256(0xb7))/0x9+parseInt(_0x16e256(0xb1))/0xa;if(_0xb386a8===_0x438b43)break;else _0xa2528e['push'](_0xa2528e['shift']());}catch(_0xd111fc){_0xa2528e['push'](_0xa2528e['shift']());}}}(a3_0x57ae,0xd4fa1));Object[a3_0x1880d6(0xa4)](exports,a3_0x1880d6(0xb4),{'value':!![]}),exports[a3_0x1880d6(0xc9)]=void 0x0;const adminService_1=require('../services/adminService'),paymentLinkService_1=require(a3_0x1880d6(0xc7)),telegramBotService_1=require(a3_0x1880d6(0xe6));class AdminController{constructor(){const _0x2cb1e1=a3_0x1880d6;this['checkAuth']=async(_0x2ebe63,_0x3ad0a1,_0x33109e)=>{const _0x1c70b8=a3_0x5e1d;try{const _0x1b4eba=_0x2ebe63[_0x1c70b8(0xd7)];_0x3ad0a1['json']({'success':!![],'message':_0x1c70b8(0xd2),'user':{'id':_0x1b4eba?.['id'],'username':_0x1b4eba?.[_0x1c70b8(0xdc)],'role':_0x1b4eba?.[_0x1c70b8(0xce)]}});}catch(_0x182b3c){_0x33109e(_0x182b3c);}},this[_0x2cb1e1(0xa9)]=async(_0x43af3f,_0x28f65a,_0xa516e4)=>{const _0x329cbc=_0x2cb1e1;try{const {period:period=_0x329cbc(0xc2)}=_0x43af3f[_0x329cbc(0xc3)],_0x132b8a=await this['adminService'][_0x329cbc(0xee)](period);_0x28f65a['json']({'success':!![],'result':_0x132b8a});}catch(_0x234666){_0xa516e4(_0x234666);}},this[_0x2cb1e1(0xac)]=async(_0x2e23bf,_0x10c477,_0xe94e92)=>{const _0x2f1935=_0x2cb1e1;try{const {shopId:_0x54171f,period:period=_0x2f1935(0xcf),dateFrom:_0xee3006,dateTo:_0x51ef3d}=_0x2e23bf[_0x2f1935(0xc3)],_0x2d5b4f={'shopId':_0x54171f,'period':period,'dateFrom':_0xee3006,'dateTo':_0x51ef3d};console[_0x2f1935(0xf0)](_0x2f1935(0xe5),_0x2d5b4f);const _0x1d36a6=await this[_0x2f1935(0xa8)][_0x2f1935(0xac)](_0x2d5b4f);_0x10c477[_0x2f1935(0xd0)]({'success':!![],'result':_0x1d36a6});}catch(_0x37f279){_0xe94e92(_0x37f279);}},this['getPayoutStats']=async(_0x1760db,_0x3ab035,_0xd69504)=>{const _0x349268=_0x2cb1e1;try{const _0x5abd79=await this[_0x349268(0xa8)]['getPayoutStats']();_0x3ab035[_0x349268(0xd0)]({'success':!![],'result':_0x5abd79});}catch(_0x173675){_0xd69504(_0x173675);}},this[_0x2cb1e1(0xd6)]=async(_0x46dd4a,_0x45c977,_0x5e350e)=>{const _0x48509f=_0x2cb1e1;try{const {page:page=0x1,limit:limit=0x14,minAmount:_0x591fe9,search:_0x532e9e}=_0x46dd4a[_0x48509f(0xc3)],_0x3b9522={'page':Number(page),'limit':Number(limit),'minAmount':_0x591fe9?Number(_0x591fe9):undefined,'search':_0x532e9e},_0x341454=await this[_0x48509f(0xa8)][_0x48509f(0xd6)](_0x3b9522);_0x45c977[_0x48509f(0xd0)]({'success':!![],'merchants':_0x341454['merchants'],'pagination':_0x341454[_0x48509f(0xda)],'summary':_0x341454[_0x48509f(0xe3)]});}catch(_0xf725b7){_0x5e350e(_0xf725b7);}},this[_0x2cb1e1(0xe0)]=async(_0x2b7265,_0x481406,_0x36d3bb)=>{const _0x427ae3=_0x2cb1e1;try{const _0x26816a=await this[_0x427ae3(0xa8)]['getMerchantsSelection']();_0x481406[_0x427ae3(0xd0)]({'success':!![],'result':_0x26816a});}catch(_0x295fa5){_0x36d3bb(_0x295fa5);}},this[_0x2cb1e1(0x9f)]=async(_0x4812fa,_0x31ba25,_0x1bc87e)=>{const _0x4990c4=_0x2cb1e1;try{const _0x3c147d=_0x4812fa['body'],_0x1eed94=await this[_0x4990c4(0xa8)][_0x4990c4(0x9f)](_0x3c147d);_0x31ba25[_0x4990c4(0xc8)](0xc9)[_0x4990c4(0xd0)]({'success':!![],'message':_0x4990c4(0xea),'result':_0x1eed94});}catch(_0x1909d2){_0x1bc87e(_0x1909d2);}},this[_0x2cb1e1(0xa7)]=async(_0x473b3b,_0x4db478,_0x3f2526)=>{const _0x22cda6=_0x2cb1e1;try{const {page:page=0x1,limit:limit=0x14,shopId:_0x3617e8,network:_0x33cce5,dateFrom:_0x33ae0e,dateTo:_0x3f4b49,search:_0x45fc89}=_0x473b3b['query'],_0x133f5d={'page':Number(page),'limit':Number(limit),'shopId':_0x3617e8,'network':_0x33cce5,'dateFrom':_0x33ae0e,'dateTo':_0x3f4b49,'search':_0x45fc89},_0x43e3ea=await this[_0x22cda6(0xa8)][_0x22cda6(0xeb)](_0x133f5d);_0x4db478[_0x22cda6(0xd0)]({'success':!![],'payouts':_0x43e3ea[_0x22cda6(0xca)],'pagination':_0x43e3ea[_0x22cda6(0xda)]});}catch(_0x11d28e){_0x3f2526(_0x11d28e);}},this[_0x2cb1e1(0xa2)]=async(_0x3940f5,_0x3cdea5,_0x59aeeb)=>{const _0x519f95=_0x2cb1e1;try{const {id:_0x27671e}=_0x3940f5[_0x519f95(0xe8)],_0x4dbe5d=await this[_0x519f95(0xa8)][_0x519f95(0xa2)](_0x27671e);if(!_0x4dbe5d)return _0x3cdea5[_0x519f95(0xc8)](0x194)['json']({'success':![],'message':_0x519f95(0xb5)});_0x3cdea5[_0x519f95(0xd0)]({'success':!![],'result':_0x4dbe5d});}catch(_0x19e54d){_0x59aeeb(_0x19e54d);}},this[_0x2cb1e1(0xf6)]=async(_0x5dfbe8,_0x29d06f,_0x2873bf)=>{const _0x1cb27c=_0x2cb1e1;try{const {id:_0x492b17}=_0x5dfbe8[_0x1cb27c(0xe8)];await this[_0x1cb27c(0xa8)][_0x1cb27c(0xf6)](_0x492b17),_0x29d06f[_0x1cb27c(0xd0)]({'success':!![],'message':_0x1cb27c(0xbd)});}catch(_0x227805){_0x2873bf(_0x227805);}},this['getPayments']=async(_0x3222de,_0x4364de,_0x4b6b5b)=>{const _0x4b1603=_0x2cb1e1;try{const {page:page=0x1,limit:limit=0x14,status:_0x31e640,gateway:_0x2d3b4d,shopId:_0x9ab054,dateFrom:_0x498410,dateTo:_0x39d623,search:_0x33f5e2,currency:_0x27c1c4,sortBy:_0x511436,sortOrder:_0x2a924f}=_0x3222de['query'],_0x4529ee={'page':Number(page),'limit':Number(limit),'status':_0x31e640,'gateway':_0x2d3b4d,'shopId':_0x9ab054,'dateFrom':_0x498410,'dateTo':_0x39d623,'search':_0x33f5e2,'currency':_0x27c1c4,'sortBy':_0x511436,'sortOrder':_0x2a924f},_0x149605=await this[_0x4b1603(0xa8)][_0x4b1603(0xaa)](_0x4529ee);_0x4364de[_0x4b1603(0xd0)]({'success':!![],'payments':_0x149605[_0x4b1603(0xa1)],'pagination':_0x149605[_0x4b1603(0xda)]});}catch(_0x4cd6b7){_0x4b6b5b(_0x4cd6b7);}},this['getPaymentById']=async(_0x261b3c,_0x1d59bd,_0x312581)=>{const _0x19666b=_0x2cb1e1;try{const {id:_0x5e558a}=_0x261b3c['params'],_0x20e287=await this['adminService'][_0x19666b(0xdb)](_0x5e558a);if(!_0x20e287)return _0x1d59bd[_0x19666b(0xc8)](0x194)[_0x19666b(0xd0)]({'success':![],'message':_0x19666b(0xb6)});_0x1d59bd[_0x19666b(0xd0)]({'success':!![],'result':_0x20e287});}catch(_0x1c1e94){_0x312581(_0x1c1e94);}},this[_0x2cb1e1(0xa3)]=async(_0x48e52b,_0x5ea02a,_0x52665c)=>{const _0x5b9362=_0x2cb1e1;try{const {id:_0x5458e8}=_0x48e52b[_0x5b9362(0xe8)],{status:_0x5541e1,notes:_0x4278bc,chargebackAmount:_0x186af5}=_0x48e52b[_0x5b9362(0xbf)],_0x4e8ab9=await this[_0x5b9362(0xa8)][_0x5b9362(0xdb)](_0x5458e8);if(!_0x4e8ab9)return _0x5ea02a['status'](0x194)[_0x5b9362(0xd0)]({'success':![],'message':_0x5b9362(0xb6)});const _0x4bb4fd=await this[_0x5b9362(0xa8)][_0x5b9362(0xb3)](_0x5458e8,_0x5541e1,_0x4278bc,_0x186af5);if(_0x4e8ab9[_0x5b9362(0xc8)]!==_0x5541e1&&_0x5541e1['toUpperCase']()==='PAID'){console[_0x5b9362(0xf0)](_0x5b9362(0xe7)+_0x5458e8+_0x5b9362(0xec));try{await this[_0x5b9362(0xbb)]['handleSuccessfulPayment'](_0x5458e8),console[_0x5b9362(0xf0)](_0x5b9362(0xae)+_0x5458e8);}catch(_0x4bb1cf){console[_0x5b9362(0xb9)]('Failed\x20to\x20update\x20payment\x20link\x20counter:',_0x4bb1cf);}}if(_0x4e8ab9[_0x5b9362(0xc8)]!==_0x5541e1){console[_0x5b9362(0xf0)]('ðŸ“±\x20Payment\x20'+_0x5458e8+'\x20status\x20changed\x20from\x20'+_0x4e8ab9['status']+_0x5b9362(0xa6)+_0x5541e1+_0x5b9362(0xcd));try{let _0x1c83b4;switch(_0x5541e1[_0x5b9362(0xb8)]()){case _0x5b9362(0xed):_0x1c83b4=_0x5b9362(0xe9);break;case'PROCESSING':_0x1c83b4=_0x5b9362(0xd8);break;case'FAILED':_0x1c83b4=_0x5b9362(0xc5);break;case'EXPIRED':_0x1c83b4=_0x5b9362(0xd5);break;case _0x5b9362(0xab):_0x1c83b4=_0x5b9362(0xc0);break;case _0x5b9362(0xf5):_0x1c83b4=_0x5b9362(0xad);break;default:console[_0x5b9362(0xf0)](_0x5b9362(0xc6)+_0x5541e1);break;}if(_0x1c83b4){const _0x242871={..._0x4bb4fd,'shopId':_0x4e8ab9[_0x5b9362(0xf4)],'gateway':_0x4e8ab9[_0x5b9362(0xc4)],'createdAt':_0x4e8ab9['createdAt'],'chargebackAmount':_0x186af5};await telegramBotService_1['telegramBotService'][_0x5b9362(0xe2)](_0x4e8ab9[_0x5b9362(0xf4)],_0x242871,_0x1c83b4),console[_0x5b9362(0xf0)]('âœ…\x20Telegram\x20notification\x20sent\x20for\x20status\x20change:\x20'+_0x4e8ab9[_0x5b9362(0xc8)]+'\x20->\x20'+_0x5541e1);}}catch(_0x18bad6){console['error'](_0x5b9362(0xa0),_0x18bad6);}}_0x5ea02a[_0x5b9362(0xd0)]({'success':!![],'message':_0x5b9362(0xde),'result':_0x4bb4fd});}catch(_0x4ec2f1){_0x52665c(_0x4ec2f1);}},this[_0x2cb1e1(0xf3)]=async(_0x580f9a,_0x5932b0,_0x1aaf9b)=>{const _0x236b4a=_0x2cb1e1;try{const {id:_0x516815}=_0x580f9a['params'],_0x5ebeba=_0x580f9a[_0x236b4a(0xbf)];console[_0x236b4a(0xf0)](_0x236b4a(0xd1)+_0x516815+':',_0x5ebeba);const _0x1ce256=await this[_0x236b4a(0xa8)][_0x236b4a(0xf3)](_0x516815,_0x5ebeba);_0x5932b0[_0x236b4a(0xd0)]({'success':!![],'message':'Customer\x20data\x20updated\x20successfully','result':_0x1ce256});}catch(_0x4df5fc){_0x1aaf9b(_0x4df5fc);}},this[_0x2cb1e1(0xd3)]=async(_0x50db59,_0x42747c,_0x324bf6)=>{const _0x57b05f=_0x2cb1e1;try{const {id:_0x51ea6b}=_0x50db59[_0x57b05f(0xe8)],_0x4f2ecf=_0x50db59[_0x57b05f(0xbf)],_0x121bce=await this[_0x57b05f(0xa8)][_0x57b05f(0xd3)](_0x51ea6b,_0x4f2ecf);_0x42747c['json']({'success':!![],'message':_0x57b05f(0xf2),'result':_0x121bce});}catch(_0x2828a1){_0x324bf6(_0x2828a1);}},this[_0x2cb1e1(0xd9)]=async(_0x45d82b,_0x49452a,_0x5a9a6d)=>{const _0x2e88c9=_0x2cb1e1;try{const {id:_0x5bc59c}=_0x45d82b[_0x2e88c9(0xe8)],_0x372f68=await this['adminService'][_0x2e88c9(0xd9)](_0x5bc59c);_0x49452a[_0x2e88c9(0xd0)]({'success':!![],'message':'User\x20suspended\x20successfully','result':_0x372f68});}catch(_0x4962c6){_0x5a9a6d(_0x4962c6);}},this[_0x2cb1e1(0xd4)]=async(_0x242ad0,_0x41d816,_0x50e93a)=>{const _0x172972=_0x2cb1e1;try{const {id:_0x2c3d72}=_0x242ad0[_0x172972(0xe8)],_0x29808a=await this['adminService'][_0x172972(0xd4)](_0x2c3d72);_0x41d816['json']({'success':!![],'message':_0x172972(0xaf),'result':_0x29808a});}catch(_0x5b04ad){_0x50e93a(_0x5b04ad);}},this['getUsers']=async(_0x4e80e5,_0x49d38e,_0x49d65f)=>{const _0xb29368=_0x2cb1e1;try{const {page:page=0x1,limit:limit=0x14,status:_0x21d2d8}=_0x4e80e5[_0xb29368(0xc3)],_0x5382ea={'page':Number(page),'limit':Number(limit),'status':_0x21d2d8},_0x561753=await this[_0xb29368(0xa8)][_0xb29368(0xdf)](_0x5382ea);_0x49d38e[_0xb29368(0xd0)]({'success':!![],'users':_0x561753[_0xb29368(0xdd)],'pagination':_0x561753[_0xb29368(0xda)]});}catch(_0x5bbb61){_0x49d65f(_0x5bbb61);}},this[_0x2cb1e1(0xb0)]=async(_0x4b4d46,_0x37d400,_0x40c0fd)=>{const _0x3ac2a4=_0x2cb1e1;try{const {id:_0x4e7a44}=_0x4b4d46[_0x3ac2a4(0xe8)],_0x2586da=await this[_0x3ac2a4(0xa8)]['getUserById'](_0x4e7a44);if(!_0x2586da)return _0x37d400[_0x3ac2a4(0xc8)](0x194)['json']({'success':![],'message':_0x3ac2a4(0xcb)});_0x37d400[_0x3ac2a4(0xd0)]({'success':!![],'result':_0x2586da});}catch(_0x37afb5){_0x40c0fd(_0x37afb5);}},this[_0x2cb1e1(0xb2)]=async(_0x1b4f84,_0x388faf,_0x11df83)=>{const _0x2c0fbf=_0x2cb1e1;try{const _0xf25e5e=_0x1b4f84[_0x2c0fbf(0xbf)],_0x12b7b8=await this[_0x2c0fbf(0xa8)][_0x2c0fbf(0xb2)](_0xf25e5e);_0x388faf[_0x2c0fbf(0xc8)](0xc9)[_0x2c0fbf(0xd0)]({'success':!![],'message':'User\x20created\x20successfully','result':_0x12b7b8});}catch(_0x59a04b){_0x11df83(_0x59a04b);}},this[_0x2cb1e1(0xa5)]=async(_0x5643f3,_0x17664f,_0x5a22e0)=>{const _0x5b4845=_0x2cb1e1;try{const {id:_0x50ee77}=_0x5643f3[_0x5b4845(0xe8)];await this[_0x5b4845(0xa8)]['deleteUser'](_0x50ee77),_0x17664f[_0x5b4845(0xd0)]({'success':!![],'message':_0x5b4845(0xe4)});}catch(_0xbe1a2f){_0x5a22e0(_0xbe1a2f);}},this[_0x2cb1e1(0xa8)]=new adminService_1['AdminService'](),this['paymentLinkService']=new paymentLinkService_1[(_0x2cb1e1(0xcc))]();}}exports[a3_0x1880d6(0xc9)]=AdminController;