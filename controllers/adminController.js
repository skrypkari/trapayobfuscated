'use strict';const a4_0x4b2257=a4_0x2c93;(function(_0x586656,_0x5c73ac){const _0x47797d=a4_0x2c93,_0x57347c=_0x586656();while(!![]){try{const _0x424c5f=parseInt(_0x47797d(0x208))/0x1+parseInt(_0x47797d(0x20c))/0x2*(-parseInt(_0x47797d(0x1f5))/0x3)+-parseInt(_0x47797d(0x21e))/0x4*(parseInt(_0x47797d(0x1bf))/0x5)+-parseInt(_0x47797d(0x21d))/0x6+parseInt(_0x47797d(0x209))/0x7*(parseInt(_0x47797d(0x20f))/0x8)+-parseInt(_0x47797d(0x1b2))/0x9*(parseInt(_0x47797d(0x249))/0xa)+parseInt(_0x47797d(0x1cc))/0xb;if(_0x424c5f===_0x5c73ac)break;else _0x57347c['push'](_0x57347c['shift']());}catch(_0x300594){_0x57347c['push'](_0x57347c['shift']());}}}(a4_0x3861,0x92155));var __createBinding=this&&this[a4_0x4b2257(0x1a4)]||(Object[a4_0x4b2257(0x1a1)]?function(_0x1bd5e1,_0x20e23b,_0x22137c,_0x4d2748){const _0x3feddd=a4_0x4b2257;if(_0x4d2748===undefined)_0x4d2748=_0x22137c;var _0x46eea6=Object['getOwnPropertyDescriptor'](_0x20e23b,_0x22137c);(!_0x46eea6||(_0x3feddd(0x1f8)in _0x46eea6?!_0x20e23b[_0x3feddd(0x1b5)]:_0x46eea6[_0x3feddd(0x224)]||_0x46eea6[_0x3feddd(0x1b0)]))&&(_0x46eea6={'enumerable':!![],'get':function(){return _0x20e23b[_0x22137c];}}),Object[_0x3feddd(0x20a)](_0x1bd5e1,_0x4d2748,_0x46eea6);}:function(_0x51c532,_0x5a6b29,_0x54e692,_0x4badc9){if(_0x4badc9===undefined)_0x4badc9=_0x54e692;_0x51c532[_0x4badc9]=_0x5a6b29[_0x54e692];}),__setModuleDefault=this&&this[a4_0x4b2257(0x201)]||(Object[a4_0x4b2257(0x1a1)]?function(_0x4b9bdb,_0x1706fa){const _0x16961d=a4_0x4b2257;Object[_0x16961d(0x20a)](_0x4b9bdb,'default',{'enumerable':!![],'value':_0x1706fa});}:function(_0x381ece,_0x56474a){const _0x3b901c=a4_0x4b2257;_0x381ece[_0x3b901c(0x1e6)]=_0x56474a;}),__importStar=this&&this['__importStar']||(function(){var _0x344c00=function(_0x67c38e){return _0x344c00=Object['getOwnPropertyNames']||function(_0x2a8a5c){const _0x1cf18b=a4_0x2c93;var _0x17b189=[];for(var _0x2802dd in _0x2a8a5c)if(Object[_0x1cf18b(0x1ed)][_0x1cf18b(0x1ec)][_0x1cf18b(0x1a5)](_0x2a8a5c,_0x2802dd))_0x17b189[_0x17b189[_0x1cf18b(0x1f1)]]=_0x2802dd;return _0x17b189;},_0x344c00(_0x67c38e);};return function(_0x25e48e){const _0x1704da=a4_0x2c93;if(_0x25e48e&&_0x25e48e['__esModule'])return _0x25e48e;var _0x323b8f={};if(_0x25e48e!=null){for(var _0x215d67=_0x344c00(_0x25e48e),_0x2cf28d=0x0;_0x2cf28d<_0x215d67[_0x1704da(0x1f1)];_0x2cf28d++)if(_0x215d67[_0x2cf28d]!==_0x1704da(0x1e6))__createBinding(_0x323b8f,_0x25e48e,_0x215d67[_0x2cf28d]);}return __setModuleDefault(_0x323b8f,_0x25e48e),_0x323b8f;};}()),__importDefault=this&&this['__importDefault']||function(_0x58f40b){const _0x5a23e0=a4_0x4b2257;return _0x58f40b&&_0x58f40b[_0x5a23e0(0x1b5)]?_0x58f40b:{'default':_0x58f40b};};Object[a4_0x4b2257(0x20a)](exports,'__esModule',{'value':!![]}),exports[a4_0x4b2257(0x1ff)]=void 0x0;const adminService_1=require('../services/adminService'),paymentLinkService_1=require(a4_0x4b2257(0x1b9)),paymentCleanupService_1=require(a4_0x4b2257(0x211)),telegramBotService_1=require(a4_0x4b2257(0x203)),gatewaySettingsService_1=require('../services/gatewaySettingsService'),database_1=__importDefault(require(a4_0x4b2257(0x20d)));function a4_0x3861(){const _0x241963=['Payout\x20deleted\x20successfully','ðŸ“Š\x20[GATEWAY\x20STATS]\x20Gateway\x20ID\x20','PaymentLinkService','getAllPayments','default','Payment\x20cleanup\x20(PROCESSING\x20+\x20PENDING)\x20with\x20report\x20completed\x20successfully','gatewaySettingsService','ðŸ“Š\x20Admin\x20requesting\x20payout\x20reports:','count','Payment\x20updated\x20successfully','hasOwnProperty','prototype','summary','findMany','getAllPayouts','length','createPayout','pagination','getProcessingPaymentsStats','14505OJOzhE','ðŸ’¸\x20[GATEWAY\x20STATS]\x20Refund\x20count:\x20','getMerchantsAwaitingPayout','get','getPayoutById','json','aggregate','log','ðŸ“±\x20Payment\x20','status','AdminController','shopId\x20and\x20amount\x20are\x20required','__setModuleDefault','âœ…\x20Payment\x20link\x20counter\x20updated\x20for\x20payment\x20','../services/telegramBotService','expired','gateway','\x20\x20\x20-\x20Total\x20Turnover:\x20','ðŸ§¹\x20Manual\x20PROCESSING\x20payment\x20cleanup\x20initiated\x20by\x20admin:\x20','785681KVVfom','4690xXHljW','defineProperty','body','326AjePmy','../config/database','ðŸ’°\x20[GATEWAY\x20STATS]\x20Paid\x20payments\x20result:','3624vDqMGi','\x20status\x20changed\x20from\x20','../services/paymentCleanupService','get2FASettings','âŒ\x20[GATEWAY\x20STATS]\x20Error:','telegramBotService','setupAdmin2FA','â°\x20Manual\x20PENDING\x20payment\x20cleanup\x20initiated\x20by\x20admin:\x20','PAID','toUpperCase','periodFrom,\x20periodTo,\x20and\x20gateway\x20are\x20required','User\x20updated\x20successfully','\x20\x20\x20-\x20Chargeback\x20Rate:\x20','depositBalance','1833036YmYoaQ','2348DFWAwE','updatePayment','enableAdmin2FA','getPayments','failed','cleanupStalePendingPayments','writable','query','getStatistics','Token\x20is\x20required','getPayoutStats','ðŸ“±\x20Skipping\x20Telegram\x20notification\x20for\x20status\x20change\x20to:\x20','Admin\x202FA\x20disabled\x20successfully','Payout\x20not\x20found','cleanupStaleProcessingPayments','error','total','params','desc',',\x20sending\x20Telegram\x20notification','then','_sum','ðŸ“Š\x20Admin\x20requesting\x20merchant\x20statistics\x20with\x20filters:','getUsers','ðŸ“ˆ\x20Admin\x20changed\x20payment\x20','ðŸ”™\x20[GATEWAY\x20STATS]\x20Chargeback\x20count:\x20','\x22\x20and\x20status=\x22PAID\x22','2FA\x20disabled\x20successfully','getMerchantStatistics','updatePayout','sendPaymentNotification','expireSinglePaymentLinks','User\x20created\x20successfully','\x20->\x20','all','processed','loginLog','AdminService','Payout\x20updated\x20successfully','Gateway\x20settings\x20updated\x20successfully','changeAdminPassword','getGatewayStatistics','paymentCleanupService','2024090pyhRlu','REFUND','disableAdmin2FA','ðŸ”\x20[GATEWAY\x20STATS]\x20Sample\x20payments\x20for\x20','getShopWallets','user','deleteUser','\x20->\x20Gateway\x20Name:\x20','payment','User\x20activated\x20successfully','getPayoutReports','Failed\x20to\x20send\x20Telegram\x20notification\x20for\x20status\x20change:','\x20to\x20','\x20\x20\x20-\x20Total\x20Commission:\x20','create','Amount\x20must\x20be\x20greater\x20than\x200','setup2FA','__createBinding','call','true','CHARGEBACK','getUserById','payouts','statistics','adminService','User\x20not\x20found','stringify','ceil','disable2FA','configurable','Admin\x20password\x20changed\x20successfully','45qdWGBo','getAllGatewaysWithSettings','refund','__esModule','amountUSDT','hasPayoutHistory','âŒ\x20[GATEWAY\x20STATS]\x20Gateway\x20not\x20found\x20for\x20ID:\x20','../services/paymentLinkService','EXPIRED','errors','\x20to\x20PAID,\x20updating\x20payment\x20link\x20counter','getPaymentById','\x20with\x20data:','4280cHxSxR','checkAuth','resolve','../types/gateway','updatePaymentStatus','getMerchantsSelection','month','Gateway\x20not\x20found','suspendUser','_count','User\x20suspended\x20successfully','Admin\x20access\x20confirmed','paymentLinkService','23290234xniQrs','createUser','toFixed','enable2FA','ðŸ“Š\x20Manual\x20payment\x20cleanup\x20(PROCESSING\x20+\x20PENDING)\x20with\x20report\x20initiated\x20by\x20admin:\x20','Payout\x20created\x20successfully','FAILED','amountAfterGatewayCommissionUSDT','username','paid','PROCESSING\x20payment\x20cleanup\x20completed\x20successfully','cleanupStalePayments','PROCESSING','updateGatewaySettings','deletePayout','handleSuccessfulPayment','ðŸ“Š\x20[GATEWAY\x20STATS]\x20Requesting\x20statistics\x20for\x20gateway\x20ID:\x20','âœ…\x20Telegram\x20notification\x20sent\x20for\x20status\x20change:\x20','activateUser','User\x20deleted\x20successfully','PENDING\x20payment\x20cleanup\x20completed\x20successfully','getSystemStatistics'];a4_0x3861=function(){return _0x241963;};return a4_0x3861();}function a4_0x2c93(_0xbd806a,_0x2f7a74){_0xbd806a=_0xbd806a-0x1a0;const _0x386135=a4_0x3861();let _0x2c9388=_0x386135[_0xbd806a];return _0x2c9388;}class AdminController{constructor(){const _0x42760=a4_0x4b2257;this[_0x42760(0x1c0)]=async(_0x4393de,_0x4c2399,_0x1ccfce)=>{const _0x340c32=_0x42760;try{const _0x53d679=_0x4393de[_0x340c32(0x24e)];_0x4c2399['json']({'success':!![],'message':_0x340c32(0x1ca),'user':{'id':_0x53d679?.['id'],'username':_0x53d679?.[_0x340c32(0x1d4)],'role':_0x53d679?.['role']}});}catch(_0xe97b9e){_0x1ccfce(_0xe97b9e);}},this[_0x42760(0x226)]=async(_0x46a2e3,_0x3706e5,_0x48897d)=>{const _0x3f8362=_0x42760;try{const {period:period='30d',currentDate:_0x54e4d3}=_0x46a2e3[_0x3f8362(0x225)],_0x254a77=await this[_0x3f8362(0x1ab)][_0x3f8362(0x1e1)](period,_0x54e4d3);_0x3706e5[_0x3f8362(0x1fa)]({'success':!![],'result':_0x254a77});}catch(_0x10a5b8){_0x48897d(_0x10a5b8);}},this[_0x42760(0x23a)]=async(_0xeffc52,_0x482df1,_0x56ca3d)=>{const _0x220ca8=_0x42760;try{const {shopId:_0x1bf26c,period:period=_0x220ca8(0x1c5),dateFrom:_0xcc367f,dateTo:_0xbd85d5}=_0xeffc52['query'],_0xdbec30={'shopId':_0x1bf26c,'period':period,'dateFrom':_0xcc367f,'dateTo':_0xbd85d5};console[_0x220ca8(0x1fc)](_0x220ca8(0x234),_0xdbec30);const _0x49df57=await this[_0x220ca8(0x1ab)][_0x220ca8(0x23a)](_0xdbec30);_0x482df1[_0x220ca8(0x1fa)]({'success':!![],'result':_0x49df57});}catch(_0xe17550){_0x56ca3d(_0xe17550);}},this[_0x42760(0x253)]=async(_0x1350e5,_0x413812,_0x3e6560)=>{const _0x1af3d2=_0x42760;try{const {periodFrom:_0x25bdb5,periodTo:_0x29036a,gateway:_0x224258}=_0x1350e5[_0x1af3d2(0x225)];if(!_0x25bdb5||!_0x29036a||!_0x224258)return _0x413812[_0x1af3d2(0x1fe)](0x190)[_0x1af3d2(0x1fa)]({'success':![],'message':_0x1af3d2(0x219)});console['log'](_0x1af3d2(0x1e9),{'periodFrom':_0x25bdb5,'periodTo':_0x29036a,'gateway':_0x224258});const _0x347cd1=await this[_0x1af3d2(0x1ab)][_0x1af3d2(0x253)]({'periodFrom':_0x25bdb5,'periodTo':_0x29036a,'gateway':_0x224258});_0x413812['json']({'success':!![],'reports':_0x347cd1});}catch(_0x38d090){_0x3e6560(_0x38d090);}},this[_0x42760(0x228)]=async(_0x5b822f,_0x5cd750,_0x58aff5)=>{const _0x2322c7=_0x42760;try{const _0x195d98=await this[_0x2322c7(0x1ab)][_0x2322c7(0x228)]();_0x5cd750[_0x2322c7(0x1fa)]({'success':!![],'result':_0x195d98});}catch(_0x6d314){_0x58aff5(_0x6d314);}},this[_0x42760(0x1f7)]=async(_0x5d27cd,_0x17bbe8,_0x4f6f33)=>{const _0x3176d5=_0x42760;try{const {page:page=0x1,limit:limit=0x14,minAmount:_0x3477ed,search:_0x15644d}=_0x5d27cd[_0x3176d5(0x225)],_0x2d4049={'page':Number(page),'limit':Number(limit),'minAmount':_0x3477ed?Number(_0x3477ed):undefined,'search':_0x15644d},_0x33f185=await this['adminService'][_0x3176d5(0x1f7)](_0x2d4049);_0x17bbe8[_0x3176d5(0x1fa)]({'success':!![],'merchants':_0x33f185['merchants'],'pagination':_0x33f185[_0x3176d5(0x1f3)],'summary':_0x33f185[_0x3176d5(0x1ee)]});}catch(_0x284b2d){_0x4f6f33(_0x284b2d);}},this[_0x42760(0x1c4)]=async(_0x39ba9c,_0x51db6f,_0x93f610)=>{const _0x59d907=_0x42760;try{const _0x43e945=_0x39ba9c[_0x59d907(0x225)][_0x59d907(0x1b7)]===_0x59d907(0x1a6),_0x554533=await this[_0x59d907(0x1ab)]['getMerchantsSelection'](_0x43e945);_0x51db6f[_0x59d907(0x1fa)]({'success':!![],'result':_0x554533});}catch(_0x38c33c){_0x93f610(_0x38c33c);}},this[_0x42760(0x1f2)]=async(_0x38ac43,_0x24ac1c,_0x181393)=>{const _0x14c9e8=_0x42760;try{const _0x2a1cc2=_0x38ac43['body'];console[_0x14c9e8(0x1fc)]('ðŸŽ¯\x20[CONTROLLER]\x20Creating\x20payout\x20with\x20data:',_0x2a1cc2);const _0x5267f2=await this[_0x14c9e8(0x1ab)][_0x14c9e8(0x1f2)](_0x2a1cc2);_0x24ac1c[_0x14c9e8(0x1fe)](0xc9)[_0x14c9e8(0x1fa)]({'success':!![],'message':_0x14c9e8(0x1d1),'result':_0x5267f2});}catch(_0x1ec0d3){_0x181393(_0x1ec0d3);}},this['updatePayout']=async(_0xca8706,_0x10adef,_0x116b02)=>{const _0x367e29=_0x42760;try{const {id:_0x5adba7}=_0xca8706[_0x367e29(0x22f)],_0xdbcd84=_0xca8706[_0x367e29(0x20b)];console[_0x367e29(0x1fc)]('ðŸŽ¯\x20[CONTROLLER]\x20Updating\x20payout\x20'+_0x5adba7+_0x367e29(0x1be),_0xdbcd84);const _0x3723ab=await this[_0x367e29(0x1ab)][_0x367e29(0x23b)](_0x5adba7,_0xdbcd84);_0x10adef[_0x367e29(0x1fa)]({'success':!![],'message':_0x367e29(0x244),'result':_0x3723ab});}catch(_0x286fe5){_0x116b02(_0x286fe5);}},this['getPayouts']=async(_0x136f70,_0x34a4b9,_0x414d1e)=>{const _0x46d3f6=_0x42760;try{const {page:page=0x1,limit:limit=0x14,shopId:_0x29bf14,network:_0x280a60,dateFrom:_0x522e38,dateTo:_0x107e70,search:_0x3ee661}=_0x136f70[_0x46d3f6(0x225)],_0x2a33be={'page':Number(page),'limit':Number(limit),'shopId':_0x29bf14,'network':_0x280a60,'dateFrom':_0x522e38,'dateTo':_0x107e70,'search':_0x3ee661},_0x5afef9=await this['adminService'][_0x46d3f6(0x1f0)](_0x2a33be);_0x34a4b9[_0x46d3f6(0x1fa)]({'success':!![],'payouts':_0x5afef9[_0x46d3f6(0x1a9)],'pagination':_0x5afef9[_0x46d3f6(0x1f3)]});}catch(_0x466d5a){_0x414d1e(_0x466d5a);}},this[_0x42760(0x1f9)]=async(_0x2c934f,_0x457f03,_0xa5a82b)=>{const _0x76c306=_0x42760;try{const {id:_0x10b59b}=_0x2c934f['params'],_0x52f6bd=await this['adminService']['getPayoutById'](_0x10b59b);if(!_0x52f6bd)return _0x457f03['status'](0x194)[_0x76c306(0x1fa)]({'success':![],'message':_0x76c306(0x22b)});_0x457f03[_0x76c306(0x1fa)]({'success':!![],'result':_0x52f6bd});}catch(_0x4578b1){_0xa5a82b(_0x4578b1);}},this[_0x42760(0x1da)]=async(_0x2a078e,_0x9523de,_0x5a02e7)=>{const _0x4a5b16=_0x42760;try{const {id:_0x376d8f}=_0x2a078e[_0x4a5b16(0x22f)];await this[_0x4a5b16(0x1ab)][_0x4a5b16(0x1da)](_0x376d8f),_0x9523de['json']({'success':!![],'message':_0x4a5b16(0x1e2)});}catch(_0x5519fc){_0x5a02e7(_0x5519fc);}},this[_0x42760(0x221)]=async(_0x59e870,_0x4b6b1a,_0x4b27c7)=>{const _0x2e406a=_0x42760;try{const {page:page=0x1,limit:limit=0x14,status:_0x24afac,gateway:_0x4c8400,shopId:_0x5a67cf,dateFrom:_0x196e89,dateTo:_0x1e5e27,search:_0x36daa6,currency:_0x336276,sortBy:_0x27a362,sortOrder:_0x1ce00b}=_0x59e870['query'],_0x559054={'page':Number(page),'limit':Number(limit),'status':_0x24afac,'gateway':_0x4c8400,'shopId':_0x5a67cf,'dateFrom':_0x196e89,'dateTo':_0x1e5e27,'search':_0x36daa6,'currency':_0x336276,'sortBy':_0x27a362,'sortOrder':_0x1ce00b},_0x486e57=await this[_0x2e406a(0x1ab)][_0x2e406a(0x1e5)](_0x559054);_0x4b6b1a[_0x2e406a(0x1fa)]({'success':!![],'payments':_0x486e57['payments'],'pagination':_0x486e57[_0x2e406a(0x1f3)],'statistics':_0x486e57[_0x2e406a(0x1aa)]});}catch(_0x447993){_0x4b27c7(_0x447993);}},this[_0x42760(0x1bd)]=async(_0x10c692,_0x29387f,_0x762fb3)=>{const _0x224210=_0x42760;try{const {id:_0x1b4a2d}=_0x10c692[_0x224210(0x22f)],_0x412fae=await this['adminService'][_0x224210(0x1bd)](_0x1b4a2d);if(!_0x412fae)return _0x29387f[_0x224210(0x1fe)](0x194)['json']({'success':![],'message':'Payment\x20not\x20found'});_0x29387f[_0x224210(0x1fa)]({'success':!![],'result':_0x412fae});}catch(_0x58feab){_0x762fb3(_0x58feab);}},this[_0x42760(0x21f)]=async(_0x4bca55,_0x1467a0,_0x1ca90f)=>{const _0x2366f5=_0x42760;try{const {id:_0x55139}=_0x4bca55[_0x2366f5(0x22f)],{status:_0x4bbf2c,notes:_0x5b57e3,chargebackAmount:_0x27da57}=_0x4bca55['body'],_0x1cd5a6=await this[_0x2366f5(0x1ab)][_0x2366f5(0x1bd)](_0x55139);if(!_0x1cd5a6)return _0x1467a0[_0x2366f5(0x1fe)](0x194)[_0x2366f5(0x1fa)]({'success':![],'message':'Payment\x20not\x20found'});const _0x412ced=await this[_0x2366f5(0x1ab)][_0x2366f5(0x1c3)](_0x55139,_0x4bbf2c,_0x5b57e3,_0x27da57);if(_0x1cd5a6[_0x2366f5(0x1fe)]!==_0x4bbf2c&&_0x4bbf2c[_0x2366f5(0x218)]()===_0x2366f5(0x217)){console[_0x2366f5(0x1fc)](_0x2366f5(0x236)+_0x55139+_0x2366f5(0x1bc));try{await this[_0x2366f5(0x1cb)][_0x2366f5(0x1db)](_0x55139),console[_0x2366f5(0x1fc)](_0x2366f5(0x202)+_0x55139);}catch(_0x43c781){console[_0x2366f5(0x22d)]('Failed\x20to\x20update\x20payment\x20link\x20counter:',_0x43c781);}}if(_0x1cd5a6['status']!==_0x4bbf2c){console[_0x2366f5(0x1fc)](_0x2366f5(0x1fd)+_0x55139+_0x2366f5(0x210)+_0x1cd5a6[_0x2366f5(0x1fe)]+_0x2366f5(0x255)+_0x4bbf2c+_0x2366f5(0x231));try{let _0x20faae;switch(_0x4bbf2c[_0x2366f5(0x218)]()){case _0x2366f5(0x217):_0x20faae=_0x2366f5(0x1d5);break;case _0x2366f5(0x1d8):_0x20faae='processing';break;case _0x2366f5(0x1d2):_0x20faae=_0x2366f5(0x222);break;case _0x2366f5(0x1ba):_0x20faae=_0x2366f5(0x204);break;case _0x2366f5(0x24a):_0x20faae=_0x2366f5(0x1b4);break;case _0x2366f5(0x1a7):_0x20faae='chargeback';break;default:console[_0x2366f5(0x1fc)](_0x2366f5(0x229)+_0x4bbf2c);break;}if(_0x20faae){const _0x1897dd={..._0x412ced,'shopId':_0x1cd5a6['shopId'],'gateway':_0x1cd5a6[_0x2366f5(0x205)],'createdAt':_0x1cd5a6['createdAt'],'chargebackAmount':_0x27da57};await telegramBotService_1[_0x2366f5(0x214)][_0x2366f5(0x23c)](_0x1cd5a6['shopId'],_0x1897dd,_0x20faae),console[_0x2366f5(0x1fc)](_0x2366f5(0x1dd)+_0x1cd5a6[_0x2366f5(0x1fe)]+_0x2366f5(0x23f)+_0x4bbf2c);}}catch(_0x3d2475){console[_0x2366f5(0x22d)](_0x2366f5(0x254),_0x3d2475);}}_0x1467a0[_0x2366f5(0x1fa)]({'success':!![],'message':_0x2366f5(0x1eb),'result':_0x412ced});}catch(_0x327409){_0x1ca90f(_0x327409);}},this['updateCustomerData']=async(_0x4d25d9,_0x1a9d60,_0x557062)=>{const _0x215a78=_0x42760;try{const {id:_0x47c406}=_0x4d25d9[_0x215a78(0x22f)],_0x3d7ab7=_0x4d25d9[_0x215a78(0x20b)];console['log']('ðŸ”„\x20Admin\x20updating\x20customer\x20data\x20for\x20payment\x20'+_0x47c406+':',_0x3d7ab7);const _0x5ca549=await this[_0x215a78(0x1ab)]['updateCustomerData'](_0x47c406,_0x3d7ab7);_0x1a9d60[_0x215a78(0x1fa)]({'success':!![],'message':'Customer\x20data\x20updated\x20successfully','result':_0x5ca549});}catch(_0x2fa166){_0x557062(_0x2fa166);}},this['updateUser']=async(_0x44ba0a,_0x42cf98,_0x205f3b)=>{const _0x2b9561=_0x42760;try{const {id:_0x1342e4}=_0x44ba0a[_0x2b9561(0x22f)],_0x1b05eb=_0x44ba0a[_0x2b9561(0x20b)],_0x5b86ae=await this['adminService']['updateUser'](_0x1342e4,_0x1b05eb);_0x42cf98[_0x2b9561(0x1fa)]({'success':!![],'message':_0x2b9561(0x21a),'result':_0x5b86ae});}catch(_0x2dda03){_0x205f3b(_0x2dda03);}},this['suspendUser']=async(_0x5c7808,_0x2a7948,_0x157b8d)=>{const _0x63cec1=_0x42760;try{const {id:_0x4d28bd}=_0x5c7808[_0x63cec1(0x22f)],_0xd2cde7=await this[_0x63cec1(0x1ab)][_0x63cec1(0x1c7)](_0x4d28bd);_0x2a7948[_0x63cec1(0x1fa)]({'success':!![],'message':_0x63cec1(0x1c9),'result':_0xd2cde7});}catch(_0x1e4f88){_0x157b8d(_0x1e4f88);}},this[_0x42760(0x1de)]=async(_0x59503f,_0x3a6ae8,_0x11180b)=>{const _0x1d99b9=_0x42760;try{const {id:_0x2ddd43}=_0x59503f['params'],_0x2cd5ee=await this['adminService'][_0x1d99b9(0x1de)](_0x2ddd43);_0x3a6ae8[_0x1d99b9(0x1fa)]({'success':!![],'message':_0x1d99b9(0x252),'result':_0x2cd5ee});}catch(_0x421931){_0x11180b(_0x421931);}},this[_0x42760(0x235)]=async(_0x1ddf70,_0x3f0503,_0x236264)=>{const _0xd7ae30=_0x42760;try{const {page:page=0x1,limit:limit=0x14,status:_0x72d70,search:_0x2399bc}=_0x1ddf70[_0xd7ae30(0x225)],_0x451ae1={'page':Number(page),'limit':Number(limit),'status':_0x72d70,'search':_0x2399bc},_0xee92af=await this[_0xd7ae30(0x1ab)]['getAllUsers'](_0x451ae1);_0x3f0503['json']({'success':!![],'users':_0xee92af['users'],'pagination':_0xee92af[_0xd7ae30(0x1f3)]});}catch(_0x2fbeba){_0x236264(_0x2fbeba);}},this[_0x42760(0x1a8)]=async(_0x5e96d7,_0x54c1b5,_0x35aa55)=>{const _0x34a966=_0x42760;try{const {id:_0x13cf51}=_0x5e96d7[_0x34a966(0x22f)],_0x256e63=await this['adminService'][_0x34a966(0x1a8)](_0x13cf51);if(!_0x256e63)return _0x54c1b5[_0x34a966(0x1fe)](0x194)[_0x34a966(0x1fa)]({'success':![],'message':_0x34a966(0x1ac)});_0x54c1b5['json']({'success':!![],'result':_0x256e63});}catch(_0x5960f1){_0x35aa55(_0x5960f1);}},this[_0x42760(0x1cd)]=async(_0x2b1a91,_0x576c4b,_0x565a73)=>{const _0x1b8d23=_0x42760;try{const _0x566033=_0x2b1a91[_0x1b8d23(0x20b)],_0x472ebe=await this[_0x1b8d23(0x1ab)][_0x1b8d23(0x1cd)](_0x566033);_0x576c4b[_0x1b8d23(0x1fe)](0xc9)['json']({'success':!![],'message':_0x1b8d23(0x23e),'result':_0x472ebe});}catch(_0x4c6a89){_0x565a73(_0x4c6a89);}},this[_0x42760(0x24f)]=async(_0x223d6b,_0x4c8f3d,_0x585ed7)=>{const _0x264540=_0x42760;try{const {id:_0x1741b5}=_0x223d6b[_0x264540(0x22f)],{twoFactorToken:_0x1676c4}=_0x223d6b['body'];await this[_0x264540(0x1ab)][_0x264540(0x24f)](_0x1741b5,_0x1676c4),_0x4c8f3d[_0x264540(0x1fa)]({'success':!![],'message':_0x264540(0x1df)});}catch(_0x2d7650){_0x585ed7(_0x2d7650);}},this[_0x42760(0x24d)]=async(_0x2ce3b4,_0x73740d,_0x55bdfd)=>{const _0x2db276=_0x42760;try{const {shopId:_0x8b1de7}=_0x2ce3b4[_0x2db276(0x22f)],_0x421034=await this[_0x2db276(0x1ab)][_0x2db276(0x24d)](_0x8b1de7);_0x73740d['json']({'success':!![],'wallets':_0x421034});}catch(_0x3848e4){_0x55bdfd(_0x3848e4);}},this['setup2FA']=async(_0x110795,_0x48e6c8,_0x5e1b49)=>{const _0x2035c2=_0x42760;try{const {shopId:_0x688283}=_0x110795[_0x2035c2(0x22f)],_0x3ead0e=await this[_0x2035c2(0x1ab)][_0x2035c2(0x1a3)](_0x688283);_0x48e6c8['json']({'success':!![],'result':_0x3ead0e});}catch(_0x129c1c){_0x5e1b49(_0x129c1c);}},this[_0x42760(0x1cf)]=async(_0x246775,_0x2b4f20,_0xef169b)=>{const _0x4ccec8=_0x42760;try{const {shopId:_0x3d61c4}=_0x246775[_0x4ccec8(0x22f)],{token:_0x1a5996}=_0x246775[_0x4ccec8(0x20b)];if(!_0x1a5996)return _0x2b4f20[_0x4ccec8(0x1fe)](0x190)[_0x4ccec8(0x1fa)]({'success':![],'message':_0x4ccec8(0x227)});const _0x16df63=await this[_0x4ccec8(0x1ab)][_0x4ccec8(0x1cf)](_0x3d61c4,_0x1a5996);_0x2b4f20['json']({'success':!![],'message':'2FA\x20enabled\x20successfully','result':_0x16df63});}catch(_0x234dde){_0xef169b(_0x234dde);}},this[_0x42760(0x1af)]=async(_0xb0c947,_0x406ab,_0x9ec52e)=>{const _0x909225=_0x42760;try{const {shopId:_0x577d75}=_0xb0c947[_0x909225(0x22f)];await this[_0x909225(0x1ab)][_0x909225(0x1af)](_0x577d75),_0x406ab[_0x909225(0x1fa)]({'success':!![],'message':_0x909225(0x239)});}catch(_0x2f7120){_0x9ec52e(_0x2f7120);}},this['getProcessingPaymentsStats']=async(_0x45c151,_0x14b6e6,_0x2b71d3)=>{const _0x5cdcce=_0x42760;try{const _0x3a35f7=await paymentCleanupService_1[_0x5cdcce(0x248)][_0x5cdcce(0x1f4)]();_0x14b6e6[_0x5cdcce(0x1fa)]({'success':!![],'result':_0x3a35f7});}catch(_0x53ab65){_0x2b71d3(_0x53ab65);}},this[_0x42760(0x1d7)]=async(_0x5f90ed,_0x40dd63,_0x526657)=>{const _0x10b322=_0x42760;try{console[_0x10b322(0x1fc)](_0x10b322(0x207)+_0x5f90ed[_0x10b322(0x24e)]?.[_0x10b322(0x1d4)]+'\x20('+_0x5f90ed[_0x10b322(0x24e)]?.['id']+')');const _0x571dfc=await paymentCleanupService_1['paymentCleanupService'][_0x10b322(0x22c)]();_0x40dd63[_0x10b322(0x1fa)]({'success':!![],'message':_0x10b322(0x1d6),'result':{'processed':_0x571dfc['processed'],'failed':_0x571dfc['failed'],'errors':_0x571dfc[_0x10b322(0x1bb)]}});}catch(_0x1d0587){_0x526657(_0x1d0587);}},this['cleanupStalePendingPayments']=async(_0x137eb7,_0x19053c,_0x2ec3b5)=>{const _0x23e0df=_0x42760;try{console[_0x23e0df(0x1fc)](_0x23e0df(0x216)+_0x137eb7['user']?.[_0x23e0df(0x1d4)]+'\x20('+_0x137eb7[_0x23e0df(0x24e)]?.['id']+')');const _0x1f0c23=await paymentCleanupService_1['paymentCleanupService'][_0x23e0df(0x223)]();_0x19053c[_0x23e0df(0x1fa)]({'success':!![],'message':_0x23e0df(0x1e0),'result':{'processed':_0x1f0c23['processed'],'failed':_0x1f0c23[_0x23e0df(0x222)],'errors':_0x1f0c23[_0x23e0df(0x1bb)]}});}catch(_0x1f20e1){_0x2ec3b5(_0x1f20e1);}},this['cleanupStalePaymentsWithReport']=async(_0x23b11f,_0x34c732,_0x39ccc7)=>{const _0x5abeb2=_0x42760;try{console['log'](_0x5abeb2(0x1d0)+_0x23b11f[_0x5abeb2(0x24e)]?.[_0x5abeb2(0x1d4)]+'\x20('+_0x23b11f['user']?.['id']+')');const _0x2de594=await paymentCleanupService_1[_0x5abeb2(0x248)][_0x5abeb2(0x1f4)](),_0x58ec06=await paymentCleanupService_1['paymentCleanupService'][_0x5abeb2(0x22c)](),_0x4cd2e3=await paymentCleanupService_1['paymentCleanupService']['cleanupStalePendingPayments'](),_0x170f00=await paymentCleanupService_1[_0x5abeb2(0x248)][_0x5abeb2(0x1f4)]();_0x34c732[_0x5abeb2(0x1fa)]({'success':!![],'message':_0x5abeb2(0x1e7),'result':{'cleanup':{'processing':{'processed':_0x58ec06['processed'],'failed':_0x58ec06['failed'],'errors':_0x58ec06['errors']},'pending':{'processed':_0x4cd2e3['processed'],'failed':_0x4cd2e3[_0x5abeb2(0x222)],'errors':_0x4cd2e3[_0x5abeb2(0x1bb)]},'total':{'processed':_0x58ec06[_0x5abeb2(0x241)]+_0x4cd2e3[_0x5abeb2(0x241)],'failed':_0x58ec06[_0x5abeb2(0x222)]+_0x4cd2e3['failed'],'errors':[..._0x58ec06[_0x5abeb2(0x1bb)],..._0x4cd2e3['errors']]}},'statistics':{'before':_0x2de594,'after':_0x170f00,'reduced':_0x2de594[_0x5abeb2(0x22e)]-_0x170f00[_0x5abeb2(0x22e)]}}});}catch(_0x5696a8){_0x39ccc7(_0x5696a8);}},this['expirePaymentLinks']=async(_0x380341,_0xb7618c,_0x377340)=>{const _0x12e0c8=_0x42760;try{const _0x576104=await paymentCleanupService_1[_0x12e0c8(0x248)][_0x12e0c8(0x23d)]();_0xb7618c[_0x12e0c8(0x1fa)]({'success':!![],'message':'Payment\x20link\x20expiration\x20check\x20completed\x20successfully','result':{'expired':_0x576104[_0x12e0c8(0x204)],'errors':_0x576104[_0x12e0c8(0x1bb)]}});}catch(_0xbea433){_0x377340(_0xbea433);}},this[_0x42760(0x246)]=async(_0x39a2ab,_0x6e1ee1,_0x3e4d03)=>{const _0x157451=_0x42760;try{const {currentPassword:_0x279ce7,newPassword:_0x33535b,confirmNewPassword:_0x7e1f8e,twoFactorToken:_0x58e5d6}=_0x39a2ab['body'];await this[_0x157451(0x1ab)][_0x157451(0x246)](_0x279ce7,_0x33535b,_0x7e1f8e,_0x58e5d6),_0x6e1ee1['json']({'success':!![],'message':_0x157451(0x1b1)});}catch(_0x155975){_0x3e4d03(_0x155975);}},this[_0x42760(0x212)]=async(_0x533a60,_0x276b8a,_0x2944c3)=>{const _0x2a0859=_0x42760;try{const _0x1b4f0d=await this['adminService'][_0x2a0859(0x212)]();_0x276b8a[_0x2a0859(0x1fa)]({'success':!![],'result':_0x1b4f0d});}catch(_0x304dbb){_0x2944c3(_0x304dbb);}},this[_0x42760(0x215)]=async(_0xdeafae,_0x307cb1,_0x52957e)=>{const _0x5a0420=_0x42760;try{const _0x4f6750=await this[_0x5a0420(0x1ab)]['setupAdmin2FA']();_0x307cb1[_0x5a0420(0x1fa)]({'success':!![],'result':_0x4f6750});}catch(_0x29d0af){_0x52957e(_0x29d0af);}},this[_0x42760(0x220)]=async(_0x149070,_0xef0b14,_0x39bf14)=>{const _0x38bb82=_0x42760;try{const {token:_0x6e0913}=_0x149070[_0x38bb82(0x20b)],_0x519514=await this[_0x38bb82(0x1ab)][_0x38bb82(0x220)](_0x6e0913);_0xef0b14['json']({'success':!![],'result':_0x519514});}catch(_0x533a19){_0x39bf14(_0x533a19);}},this[_0x42760(0x24b)]=async(_0x10697a,_0x56b0e2,_0x51f48f)=>{const _0x409830=_0x42760;try{await this['adminService'][_0x409830(0x24b)](),_0x56b0e2['json']({'success':!![],'message':_0x409830(0x22a)});}catch(_0x3a8676){_0x51f48f(_0x3a8676);}},this[_0x42760(0x21c)]=async(_0x12211a,_0x3f15df,_0x1725c9)=>{const _0x43693c=_0x42760;try{const {shopId:_0x5d7609,amount:_0x34742e,notes:_0x43a2f9}=_0x12211a['body'];if(!_0x5d7609||!_0x34742e)return _0x3f15df['status'](0x190)[_0x43693c(0x1fa)]({'success':![],'message':_0x43693c(0x200)});if(_0x34742e<=0x0)return _0x3f15df['status'](0x190)[_0x43693c(0x1fa)]({'success':![],'message':_0x43693c(0x1a2)});await this[_0x43693c(0x1ab)][_0x43693c(0x21c)](_0x5d7609,_0x34742e,_0x43a2f9),_0x3f15df[_0x43693c(0x1fa)]({'success':!![],'message':'Balance\x20deposited\x20successfully'});}catch(_0x50344f){_0x1725c9(_0x50344f);}},this['getLoginLogs']=async(_0x194b5a,_0x46a7eb,_0x7375fb)=>{const _0x3c9013=_0x42760;try{const {shopId:_0xc39a43}=_0x194b5a[_0x3c9013(0x22f)],{page:page='1',limit:limit='20'}=_0x194b5a[_0x3c9013(0x225)],_0x380f92=(await Promise[_0x3c9013(0x1c1)]()[_0x3c9013(0x232)](()=>__importStar(require(_0x3c9013(0x20d)))))[_0x3c9013(0x1e6)],_0xd0d48d=parseInt(page,0xa),_0xdd59e4=parseInt(limit,0xa),_0x5df320=(_0xd0d48d-0x1)*_0xdd59e4,[_0x33ff94,_0xb2ed2a]=await Promise[_0x3c9013(0x240)]([_0x380f92['loginLog'][_0x3c9013(0x1ef)]({'where':{'shopId':_0xc39a43},'orderBy':{'createdAt':_0x3c9013(0x230)},'skip':_0x5df320,'take':_0xdd59e4}),_0x380f92[_0x3c9013(0x242)][_0x3c9013(0x1ea)]({'where':{'shopId':_0xc39a43}})]);_0x46a7eb['json']({'success':!![],'result':{'logs':_0x33ff94,'pagination':{'page':_0xd0d48d,'limit':_0xdd59e4,'total':_0xb2ed2a,'totalPages':Math[_0x3c9013(0x1ae)](_0xb2ed2a/_0xdd59e4)}}});}catch(_0xe38636){_0x7375fb(_0xe38636);}},this['getGatewaySettings']=async(_0x5258b3,_0x2cdad8,_0x5ef469)=>{const _0x51883e=_0x42760;try{const _0x5c7244=gatewaySettingsService_1[_0x51883e(0x1e8)][_0x51883e(0x1b3)]();_0x2cdad8[_0x51883e(0x1fa)]({'success':!![],'result':_0x5c7244});}catch(_0x199cdf){_0x5ef469(_0x199cdf);}},this[_0x42760(0x1d9)]=async(_0x1c7e0d,_0x182b97,_0x4ff364)=>{const _0x2d7dcd=_0x42760;try{const {gatewayId:_0x585939}=_0x1c7e0d['params'],{minAmount:_0x1bd681,maxAmount:_0x241ad0,payoutDelay:_0x56a4f2,gatewayCommission:_0x4ca3a0}=_0x1c7e0d[_0x2d7dcd(0x20b)],_0x15bc15=gatewaySettingsService_1[_0x2d7dcd(0x1e8)]['updateSettings'](_0x585939,{'minAmount':_0x1bd681!==undefined?Number(_0x1bd681):undefined,'maxAmount':_0x241ad0!==undefined?Number(_0x241ad0):undefined,'payoutDelay':_0x56a4f2!==undefined?Number(_0x56a4f2):undefined,'gatewayCommission':_0x4ca3a0!==undefined?Number(_0x4ca3a0):undefined});_0x182b97[_0x2d7dcd(0x1fa)]({'success':!![],'message':_0x2d7dcd(0x245),'result':_0x15bc15});}catch(_0x4313c4){_0x4ff364(_0x4313c4);}},this[_0x42760(0x247)]=async(_0x1ecdda,_0x4a422b,_0x30c8eb)=>{const _0x36378a=_0x42760;try{const {gatewayId:_0x1c1083}=_0x1ecdda['params'];console['log'](_0x36378a(0x1dc)+_0x1c1083);const {GATEWAY_ID_MAP:_0x428a34}=await Promise['resolve']()[_0x36378a(0x232)](()=>__importStar(require(_0x36378a(0x1c2)))),_0x17b0bc=_0x428a34[_0x1c1083];console[_0x36378a(0x1fc)](_0x36378a(0x1e3)+_0x1c1083+_0x36378a(0x250)+_0x17b0bc);if(!_0x17b0bc)return console['log'](_0x36378a(0x1b8)+_0x1c1083),_0x4a422b['status'](0x194)[_0x36378a(0x1fa)]({'success':![],'message':_0x36378a(0x1c6)});console[_0x36378a(0x1fc)]('ðŸ”\x20[GATEWAY\x20STATS]\x20Querying\x20payments\x20with\x20gateway=\x22'+_0x17b0bc+_0x36378a(0x238));const _0x425c25=await database_1['default'][_0x36378a(0x251)][_0x36378a(0x1ef)]({'where':{'gateway':_0x17b0bc},'select':{'id':!![],'status':!![],'amountUSDT':!![]},'take':0x5});console[_0x36378a(0x1fc)](_0x36378a(0x24c)+_0x17b0bc+':',JSON[_0x36378a(0x1ad)](_0x425c25,null,0x2));const _0x276a53=await database_1['default']['payment'][_0x36378a(0x1fb)]({'where':{'gateway':_0x17b0bc,'status':'PAID'},'_sum':{'amountUSDT':!![],'amountAfterGatewayCommissionUSDT':!![]},'_count':{'_all':!![]}});console[_0x36378a(0x1fc)](_0x36378a(0x20e),JSON['stringify'](_0x276a53,null,0x2));const _0x26a4a0=await database_1[_0x36378a(0x1e6)][_0x36378a(0x251)][_0x36378a(0x1ea)]({'where':{'gateway':_0x17b0bc,'status':_0x36378a(0x1a7)}});console[_0x36378a(0x1fc)](_0x36378a(0x237)+_0x26a4a0);const _0x3f34da=await database_1[_0x36378a(0x1e6)][_0x36378a(0x251)][_0x36378a(0x1ea)]({'where':{'gateway':_0x17b0bc,'status':_0x36378a(0x24a)}});console[_0x36378a(0x1fc)](_0x36378a(0x1f6)+_0x3f34da);const _0x4ea9c6=_0x276a53[_0x36378a(0x233)][_0x36378a(0x1b6)]||0x0,_0x24b611=(_0x276a53[_0x36378a(0x233)]['amountUSDT']||0x0)-(_0x276a53[_0x36378a(0x233)][_0x36378a(0x1d3)]||0x0),_0x52fb59=_0x276a53[_0x36378a(0x1c8)]['_all'],_0x2e6ed0=_0x52fb59>0x0?_0x26a4a0/_0x52fb59*0x64:0x0;console[_0x36378a(0x1fc)]('ðŸ“ˆ\x20[GATEWAY\x20STATS]\x20Calculated\x20statistics:'),console[_0x36378a(0x1fc)](_0x36378a(0x206)+_0x4ea9c6),console[_0x36378a(0x1fc)](_0x36378a(0x1a0)+_0x24b611),console[_0x36378a(0x1fc)]('\x20\x20\x20-\x20Successful\x20Payments:\x20'+_0x52fb59),console[_0x36378a(0x1fc)](_0x36378a(0x21b)+_0x2e6ed0+'%'),_0x4a422b[_0x36378a(0x1fa)]({'success':!![],'result':{'gatewayId':_0x1c1083,'totalTurnover':Number(_0x4ea9c6[_0x36378a(0x1ce)](0x2)),'totalCommission':Number(_0x24b611[_0x36378a(0x1ce)](0x2)),'successfulPayments':_0x52fb59,'chargebackCount':_0x26a4a0,'chargebackRate':Number(_0x2e6ed0[_0x36378a(0x1ce)](0x2)),'refundCount':_0x3f34da}});}catch(_0x3d95d5){console['error'](_0x36378a(0x213),_0x3d95d5),_0x30c8eb(_0x3d95d5);}},this[_0x42760(0x1ab)]=new adminService_1[(_0x42760(0x243))](),this['paymentLinkService']=new paymentLinkService_1[(_0x42760(0x1e4))]();}}exports[a4_0x4b2257(0x1ff)]=AdminController;