'use strict';const a4_0x4adefa=a4_0x2fed;(function(_0xd5a5e6,_0x682bc7){const _0x515e12=a4_0x2fed,_0x369545=_0xd5a5e6();while(!![]){try{const _0x592501=parseInt(_0x515e12(0x1db))/0x1*(-parseInt(_0x515e12(0x13f))/0x2)+-parseInt(_0x515e12(0x168))/0x3*(parseInt(_0x515e12(0x178))/0x4)+parseInt(_0x515e12(0x197))/0x5*(parseInt(_0x515e12(0x1d4))/0x6)+-parseInt(_0x515e12(0x15f))/0x7*(parseInt(_0x515e12(0x1eb))/0x8)+parseInt(_0x515e12(0x1ec))/0x9*(-parseInt(_0x515e12(0x170))/0xa)+parseInt(_0x515e12(0x173))/0xb+parseInt(_0x515e12(0x146))/0xc;if(_0x592501===_0x682bc7)break;else _0x369545['push'](_0x369545['shift']());}catch(_0x16ef59){_0x369545['push'](_0x369545['shift']());}}}(a4_0x1e57,0x6a6b6));var __createBinding=this&&this[a4_0x4adefa(0x1c4)]||(Object['create']?function(_0x327760,_0x448d7d,_0x24abf8,_0x155039){const _0x289e84=a4_0x4adefa;if(_0x155039===undefined)_0x155039=_0x24abf8;var _0x295f14=Object['getOwnPropertyDescriptor'](_0x448d7d,_0x24abf8);(!_0x295f14||(_0x289e84(0x14e)in _0x295f14?!_0x448d7d[_0x289e84(0x1dc)]:_0x295f14['writable']||_0x295f14[_0x289e84(0x18d)]))&&(_0x295f14={'enumerable':!![],'get':function(){return _0x448d7d[_0x24abf8];}}),Object[_0x289e84(0x19c)](_0x327760,_0x155039,_0x295f14);}:function(_0x1f2240,_0x2877ae,_0x4dc7da,_0x14ec34){if(_0x14ec34===undefined)_0x14ec34=_0x4dc7da;_0x1f2240[_0x14ec34]=_0x2877ae[_0x4dc7da];}),__setModuleDefault=this&&this[a4_0x4adefa(0x18e)]||(Object['create']?function(_0x50bbeb,_0xc92340){const _0x30731b=a4_0x4adefa;Object[_0x30731b(0x19c)](_0x50bbeb,_0x30731b(0x150),{'enumerable':!![],'value':_0xc92340});}:function(_0x3b3137,_0x5a5394){const _0x3d6615=a4_0x4adefa;_0x3b3137[_0x3d6615(0x150)]=_0x5a5394;}),__importStar=this&&this['__importStar']||(function(){var _0x31032a=function(_0x53f3f7){const _0x2fbc5e=a4_0x2fed;return _0x31032a=Object[_0x2fbc5e(0x1a4)]||function(_0x5497e4){const _0x48ced0=_0x2fbc5e;var _0x3f9d31=[];for(var _0x1e8fc2 in _0x5497e4)if(Object[_0x48ced0(0x183)][_0x48ced0(0x1c0)][_0x48ced0(0x1dd)](_0x5497e4,_0x1e8fc2))_0x3f9d31[_0x3f9d31['length']]=_0x1e8fc2;return _0x3f9d31;},_0x31032a(_0x53f3f7);};return function(_0x24b1c9){const _0x393ef8=a4_0x2fed;if(_0x24b1c9&&_0x24b1c9[_0x393ef8(0x1dc)])return _0x24b1c9;var _0x4a23cd={};if(_0x24b1c9!=null){for(var _0x57e0df=_0x31032a(_0x24b1c9),_0x5ca8a=0x0;_0x5ca8a<_0x57e0df[_0x393ef8(0x1c8)];_0x5ca8a++)if(_0x57e0df[_0x5ca8a]!==_0x393ef8(0x150))__createBinding(_0x4a23cd,_0x24b1c9,_0x57e0df[_0x5ca8a]);}return __setModuleDefault(_0x4a23cd,_0x24b1c9),_0x4a23cd;};}()),__importDefault=this&&this[a4_0x4adefa(0x1b5)]||function(_0x3376ad){const _0x4bc2a6=a4_0x4adefa;return _0x3376ad&&_0x3376ad[_0x4bc2a6(0x1dc)]?_0x3376ad:{'default':_0x3376ad};};Object[a4_0x4adefa(0x19c)](exports,a4_0x4adefa(0x1dc),{'value':!![]}),exports[a4_0x4adefa(0x1b9)]=void 0x0;function a4_0x2fed(_0x5c6d13,_0x28fd34){_0x5c6d13=_0x5c6d13-0x13f;const _0x1e5778=a4_0x1e57();let _0x2fed01=_0x1e5778[_0x5c6d13];return _0x2fed01;}const adminService_1=require(a4_0x4adefa(0x1d9)),paymentLinkService_1=require(a4_0x4adefa(0x1c2)),paymentCleanupService_1=require('../services/paymentCleanupService'),telegramBotService_1=require(a4_0x4adefa(0x18a)),gatewaySettingsService_1=require('../services/gatewaySettingsService'),database_1=__importDefault(require(a4_0x4adefa(0x19b)));class AdminController{constructor(){const _0x244ddd=a4_0x4adefa;this[_0x244ddd(0x165)]=async(_0x1dd7b1,_0x17f554,_0x369604)=>{const _0x481e21=_0x244ddd;try{const _0x2f240c=_0x1dd7b1[_0x481e21(0x172)];_0x17f554['json']({'success':!![],'message':_0x481e21(0x1a3),'user':{'id':_0x2f240c?.['id'],'username':_0x2f240c?.[_0x481e21(0x191)],'role':_0x2f240c?.[_0x481e21(0x1bd)]}});}catch(_0x6608b4){_0x369604(_0x6608b4);}},this[_0x244ddd(0x17d)]=async(_0x536200,_0x4a2395,_0x1c438a)=>{const _0x4f41bd=_0x244ddd;try{const {period:period=_0x4f41bd(0x1be),currentDate:_0x2a4879}=_0x536200['query'],_0x19463a=await this[_0x4f41bd(0x1ac)][_0x4f41bd(0x145)](period,_0x2a4879);_0x4a2395['json']({'success':!![],'result':_0x19463a});}catch(_0x34506c){_0x1c438a(_0x34506c);}},this[_0x244ddd(0x1cc)]=async(_0x34da2e,_0x4fbc7c,_0x48a454)=>{const _0x4346e9=_0x244ddd;try{const {shopId:_0x1812b5,period:period=_0x4346e9(0x181),dateFrom:_0x9e37f1,dateTo:_0x31f872}=_0x34da2e[_0x4346e9(0x1ce)],_0x244d42={'shopId':_0x1812b5,'period':period,'dateFrom':_0x9e37f1,'dateTo':_0x31f872};console['log'](_0x4346e9(0x1b1),_0x244d42);const _0x1fad90=await this[_0x4346e9(0x1ac)]['getMerchantStatistics'](_0x244d42);_0x4fbc7c[_0x4346e9(0x177)]({'success':!![],'result':_0x1fad90});}catch(_0x30fc18){_0x48a454(_0x30fc18);}},this[_0x244ddd(0x1a5)]=async(_0x305887,_0x4b7455,_0x10ff02)=>{const _0x5a3d3a=_0x244ddd;try{const {periodFrom:_0x4c539b,periodTo:_0x26b431,gateway:_0x2c172a}=_0x305887[_0x5a3d3a(0x1ce)];if(!_0x4c539b||!_0x26b431||!_0x2c172a)return _0x4b7455[_0x5a3d3a(0x185)](0x190)[_0x5a3d3a(0x177)]({'success':![],'message':_0x5a3d3a(0x18f)});console[_0x5a3d3a(0x1df)](_0x5a3d3a(0x1c9),{'periodFrom':_0x4c539b,'periodTo':_0x26b431,'gateway':_0x2c172a});const _0x53629f=await this['adminService'][_0x5a3d3a(0x1a5)]({'periodFrom':_0x4c539b,'periodTo':_0x26b431,'gateway':_0x2c172a});_0x4b7455[_0x5a3d3a(0x177)]({'success':!![],'reports':_0x53629f});}catch(_0x23ba32){_0x10ff02(_0x23ba32);}},this[_0x244ddd(0x1d0)]=async(_0x4b64e9,_0x4041b7,_0x36dd46)=>{const _0x33e978=_0x244ddd;try{const _0x525a13=await this[_0x33e978(0x1ac)][_0x33e978(0x1d0)]();_0x4041b7[_0x33e978(0x177)]({'success':!![],'result':_0x525a13});}catch(_0x2440ac){_0x36dd46(_0x2440ac);}},this['getMerchantsAwaitingPayout']=async(_0x4f45bd,_0x3adc3d,_0x1aa216)=>{const _0x59c4c4=_0x244ddd;try{const {page:page=0x1,limit:limit=0x14,minAmount:_0x533235,search:_0xcb8015}=_0x4f45bd[_0x59c4c4(0x1ce)],_0x358074={'page':Number(page),'limit':Number(limit),'minAmount':_0x533235?Number(_0x533235):undefined,'search':_0xcb8015},_0x1f4882=await this[_0x59c4c4(0x1ac)][_0x59c4c4(0x194)](_0x358074);_0x3adc3d[_0x59c4c4(0x177)]({'success':!![],'merchants':_0x1f4882[_0x59c4c4(0x175)],'pagination':_0x1f4882[_0x59c4c4(0x1a2)],'summary':_0x1f4882[_0x59c4c4(0x161)]});}catch(_0x261a8b){_0x1aa216(_0x261a8b);}},this[_0x244ddd(0x158)]=async(_0x23dde1,_0x48c0c9,_0x3f34f6)=>{const _0x3d85e0=_0x244ddd;try{const _0x50df7a=_0x23dde1[_0x3d85e0(0x1ce)][_0x3d85e0(0x186)]==='true',_0x45a7a9=await this['adminService'][_0x3d85e0(0x158)](_0x50df7a);_0x48c0c9[_0x3d85e0(0x177)]({'success':!![],'result':_0x45a7a9});}catch(_0x56922a){_0x3f34f6(_0x56922a);}},this['createPayout']=async(_0x4b5236,_0x138271,_0x170482)=>{const _0x21751b=_0x244ddd;try{const _0x257ecf=_0x4b5236['body'];console[_0x21751b(0x1df)](_0x21751b(0x1e5),_0x257ecf);const _0x1bba9b=await this['adminService']['createPayout'](_0x257ecf);_0x138271['status'](0xc9)['json']({'success':!![],'message':'Payout\x20created\x20successfully','result':_0x1bba9b});}catch(_0x5d2f08){_0x170482(_0x5d2f08);}},this['updatePayout']=async(_0xd7872d,_0xf185af,_0x1b9bb0)=>{const _0x3153c8=_0x244ddd;try{const {id:_0x53a067}=_0xd7872d[_0x3153c8(0x14c)],_0x52e8cb=_0xd7872d[_0x3153c8(0x1a6)];console[_0x3153c8(0x1df)](_0x3153c8(0x159)+_0x53a067+_0x3153c8(0x1c6),_0x52e8cb);const _0x5b9f39=await this[_0x3153c8(0x1ac)]['updatePayout'](_0x53a067,_0x52e8cb);_0xf185af[_0x3153c8(0x177)]({'success':!![],'message':_0x3153c8(0x192),'result':_0x5b9f39});}catch(_0x3b7eff){_0x1b9bb0(_0x3b7eff);}},this[_0x244ddd(0x1d6)]=async(_0x5c876f,_0x1cf8ab,_0x4efc84)=>{const _0x4c0de4=_0x244ddd;try{const {page:page=0x1,limit:limit=0x14,shopId:_0x3d90d4,network:_0xfbf569,dateFrom:_0x57d73a,dateTo:_0x401ad8,search:_0x454eb1}=_0x5c876f[_0x4c0de4(0x1ce)],_0x498dd9={'page':Number(page),'limit':Number(limit),'shopId':_0x3d90d4,'network':_0xfbf569,'dateFrom':_0x57d73a,'dateTo':_0x401ad8,'search':_0x454eb1},_0x6f1d59=await this['adminService'][_0x4c0de4(0x1a7)](_0x498dd9);_0x1cf8ab[_0x4c0de4(0x177)]({'success':!![],'payouts':_0x6f1d59['payouts'],'pagination':_0x6f1d59[_0x4c0de4(0x1a2)]});}catch(_0x4ed7db){_0x4efc84(_0x4ed7db);}},this[_0x244ddd(0x199)]=async(_0xe3cc4f,_0x1b56bd,_0x5ee14b)=>{const _0x54129d=_0x244ddd;try{const {id:_0x3a88e8}=_0xe3cc4f['params'],_0x1a432b=await this[_0x54129d(0x1ac)]['getPayoutById'](_0x3a88e8);if(!_0x1a432b)return _0x1b56bd['status'](0x194)['json']({'success':![],'message':_0x54129d(0x1b2)});_0x1b56bd[_0x54129d(0x177)]({'success':!![],'result':_0x1a432b});}catch(_0x5b0eda){_0x5ee14b(_0x5b0eda);}},this[_0x244ddd(0x1e2)]=async(_0x116643,_0x25b144,_0x214a67)=>{const _0x220004=_0x244ddd;try{const {id:_0x5c8617}=_0x116643[_0x220004(0x14c)];await this[_0x220004(0x1ac)][_0x220004(0x1e2)](_0x5c8617),_0x25b144[_0x220004(0x177)]({'success':!![],'message':'Payout\x20deleted\x20successfully'});}catch(_0x672c95){_0x214a67(_0x672c95);}},this['getPayments']=async(_0x33daa1,_0x21a90d,_0x4803d0)=>{const _0x298ec2=_0x244ddd;try{const {page:page=0x1,limit:limit=0x14,status:_0x432a95,gateway:_0x5a2b57,shopId:_0x2c868e,dateFrom:_0x39e4ab,dateTo:_0x2e2f47,search:_0x57fcee,currency:_0x573c98,sortBy:_0x352e00,sortOrder:_0x422ab2}=_0x33daa1[_0x298ec2(0x1ce)],_0x334f13={'page':Number(page),'limit':Number(limit),'status':_0x432a95,'gateway':_0x5a2b57,'shopId':_0x2c868e,'dateFrom':_0x39e4ab,'dateTo':_0x2e2f47,'search':_0x57fcee,'currency':_0x573c98,'sortBy':_0x352e00,'sortOrder':_0x422ab2},_0x450fa7=await this[_0x298ec2(0x1ac)][_0x298ec2(0x16a)](_0x334f13);_0x21a90d[_0x298ec2(0x177)]({'success':!![],'payments':_0x450fa7[_0x298ec2(0x1bf)],'pagination':_0x450fa7[_0x298ec2(0x1a2)],'statistics':_0x450fa7[_0x298ec2(0x182)]});}catch(_0x9c631c){_0x4803d0(_0x9c631c);}},this[_0x244ddd(0x1ca)]=async(_0x599673,_0xc8ccc3,_0x16f301)=>{const _0x4a5613=_0x244ddd;try{const {id:_0x880c9f}=_0x599673['params'],_0x8dea40=await this['adminService'][_0x4a5613(0x1ca)](_0x880c9f);if(!_0x8dea40)return _0xc8ccc3[_0x4a5613(0x185)](0x194)[_0x4a5613(0x177)]({'success':![],'message':_0x4a5613(0x1d5)});_0xc8ccc3['json']({'success':!![],'result':_0x8dea40});}catch(_0x3d4478){_0x16f301(_0x3d4478);}},this[_0x244ddd(0x16f)]=async(_0xca712d,_0x5041f7,_0x327f2d)=>{const _0x1d1738=_0x244ddd;try{const {id:_0x4a3f0f}=_0xca712d[_0x1d1738(0x14c)],{status:_0x211f50,notes:_0x1aa5e1,chargebackAmount:_0x433504}=_0xca712d[_0x1d1738(0x1a6)],_0x21bf2c=await this[_0x1d1738(0x1ac)][_0x1d1738(0x1ca)](_0x4a3f0f);if(!_0x21bf2c)return _0x5041f7[_0x1d1738(0x185)](0x194)[_0x1d1738(0x177)]({'success':![],'message':'Payment\x20not\x20found'});const _0x1e0e1a=await this[_0x1d1738(0x1ac)][_0x1d1738(0x15e)](_0x4a3f0f,_0x211f50,_0x1aa5e1,_0x433504);if(_0x21bf2c[_0x1d1738(0x185)]!==_0x211f50&&_0x211f50[_0x1d1738(0x143)]()==='PAID'){console[_0x1d1738(0x1df)](_0x1d1738(0x1e6)+_0x4a3f0f+'\x20to\x20PAID,\x20updating\x20payment\x20link\x20counter');try{await this[_0x1d1738(0x148)][_0x1d1738(0x1b4)](_0x4a3f0f),console['log'](_0x1d1738(0x1a0)+_0x4a3f0f);}catch(_0x272a53){console[_0x1d1738(0x189)](_0x1d1738(0x179),_0x272a53);}}if(_0x21bf2c['status']!==_0x211f50){console[_0x1d1738(0x1df)](_0x1d1738(0x198)+_0x4a3f0f+_0x1d1738(0x1e8)+_0x21bf2c[_0x1d1738(0x185)]+_0x1d1738(0x1e9)+_0x211f50+_0x1d1738(0x1b0));try{let _0x48cd46;switch(_0x211f50['toUpperCase']()){case _0x1d1738(0x154):_0x48cd46=_0x1d1738(0x195);break;case _0x1d1738(0x17f):_0x48cd46='processing';break;case _0x1d1738(0x17c):_0x48cd46=_0x1d1738(0x1b3);break;case'EXPIRED':_0x48cd46=_0x1d1738(0x1ed);break;case _0x1d1738(0x19e):_0x48cd46=_0x1d1738(0x15d);break;case _0x1d1738(0x1ee):_0x48cd46='chargeback';break;default:console[_0x1d1738(0x1df)](_0x1d1738(0x19a)+_0x211f50);break;}if(_0x48cd46){const _0x5ca91e={..._0x1e0e1a,'shopId':_0x21bf2c[_0x1d1738(0x1c5)],'gateway':_0x21bf2c[_0x1d1738(0x14a)],'createdAt':_0x21bf2c[_0x1d1738(0x141)],'chargebackAmount':_0x433504};await telegramBotService_1[_0x1d1738(0x1cd)]['sendPaymentNotification'](_0x21bf2c[_0x1d1738(0x1c5)],_0x5ca91e,_0x48cd46),console[_0x1d1738(0x1df)](_0x1d1738(0x156)+_0x21bf2c[_0x1d1738(0x185)]+_0x1d1738(0x19f)+_0x211f50);}}catch(_0x5ae807){console[_0x1d1738(0x189)](_0x1d1738(0x174),_0x5ae807);}}_0x5041f7[_0x1d1738(0x177)]({'success':!![],'message':'Payment\x20updated\x20successfully','result':_0x1e0e1a});}catch(_0x4292e8){_0x327f2d(_0x4292e8);}},this['updateCustomerData']=async(_0xf1500c,_0x241ea3,_0x23d40f)=>{const _0x44d806=_0x244ddd;try{const {id:_0x2ed078}=_0xf1500c['params'],_0xcb0c31=_0xf1500c[_0x44d806(0x1a6)];console['log'](_0x44d806(0x162)+_0x2ed078+':',_0xcb0c31);const _0x10d12f=await this['adminService'][_0x44d806(0x167)](_0x2ed078,_0xcb0c31);_0x241ea3[_0x44d806(0x177)]({'success':!![],'message':_0x44d806(0x1d8),'result':_0x10d12f});}catch(_0x529bd){_0x23d40f(_0x529bd);}},this[_0x244ddd(0x1ab)]=async(_0x5cd02a,_0x413299,_0x51ede7)=>{const _0x451f21=_0x244ddd;try{const {id:_0x4e66cc}=_0x5cd02a[_0x451f21(0x14c)],_0x196cc2=_0x5cd02a['body'],_0x1dc7ea=await this[_0x451f21(0x1ac)][_0x451f21(0x1ab)](_0x4e66cc,_0x196cc2);_0x413299[_0x451f21(0x177)]({'success':!![],'message':_0x451f21(0x1de),'result':_0x1dc7ea});}catch(_0x301913){_0x51ede7(_0x301913);}},this[_0x244ddd(0x144)]=async(_0x5aeebe,_0x24d882,_0x1dd194)=>{const _0x49469e=_0x244ddd;try{const {id:_0x112c34}=_0x5aeebe[_0x49469e(0x14c)],_0x2658f8=await this[_0x49469e(0x1ac)][_0x49469e(0x144)](_0x112c34);_0x24d882['json']({'success':!![],'message':'User\x20suspended\x20successfully','result':_0x2658f8});}catch(_0x445f35){_0x1dd194(_0x445f35);}},this[_0x244ddd(0x1cf)]=async(_0x153c6f,_0x2eb304,_0x201f95)=>{const _0x1f15a1=_0x244ddd;try{const {id:_0xfb6f02}=_0x153c6f['params'],_0x2cca7c=await this[_0x1f15a1(0x1ac)][_0x1f15a1(0x1cf)](_0xfb6f02);_0x2eb304[_0x1f15a1(0x177)]({'success':!![],'message':_0x1f15a1(0x18c),'result':_0x2cca7c});}catch(_0x34b6b4){_0x201f95(_0x34b6b4);}},this[_0x244ddd(0x1d2)]=async(_0x3731a0,_0x96970b,_0x432c9e)=>{const _0x5625a4=_0x244ddd;try{const {page:page=0x1,limit:limit=0x14,status:_0x3ac19b,search:_0x4893f6}=_0x3731a0[_0x5625a4(0x1ce)],_0x395984={'page':Number(page),'limit':Number(limit),'status':_0x3ac19b,'search':_0x4893f6},_0x23515d=await this[_0x5625a4(0x1ac)][_0x5625a4(0x1f0)](_0x395984);_0x96970b[_0x5625a4(0x177)]({'success':!![],'users':_0x23515d['users'],'pagination':_0x23515d[_0x5625a4(0x1a2)]});}catch(_0x1b3e5d){_0x432c9e(_0x1b3e5d);}},this['getUserById']=async(_0x40023f,_0x277c92,_0x5bcb6d)=>{const _0xc7654b=_0x244ddd;try{const {id:_0x5dbcff}=_0x40023f[_0xc7654b(0x14c)],_0x467d99=await this['adminService'][_0xc7654b(0x166)](_0x5dbcff);if(!_0x467d99)return _0x277c92[_0xc7654b(0x185)](0x194)['json']({'success':![],'message':_0xc7654b(0x14d)});_0x277c92[_0xc7654b(0x177)]({'success':!![],'result':_0x467d99});}catch(_0x58ef59){_0x5bcb6d(_0x58ef59);}},this['createUser']=async(_0x495f48,_0x52dc96,_0x2f88ed)=>{const _0x47c00b=_0x244ddd;try{const _0x4333cc=_0x495f48['body'],_0x329d72=await this['adminService'][_0x47c00b(0x1a1)](_0x4333cc);_0x52dc96['status'](0xc9)[_0x47c00b(0x177)]({'success':!![],'message':_0x47c00b(0x157),'result':_0x329d72});}catch(_0x5a1b33){_0x2f88ed(_0x5a1b33);}},this['deleteUser']=async(_0x33c9e2,_0x50daea,_0xd3314c)=>{const _0x3eaa4d=_0x244ddd;try{const {id:_0x19366d}=_0x33c9e2[_0x3eaa4d(0x14c)],{twoFactorToken:_0x401630}=_0x33c9e2[_0x3eaa4d(0x1a6)];await this[_0x3eaa4d(0x1ac)][_0x3eaa4d(0x1a8)](_0x19366d,_0x401630),_0x50daea['json']({'success':!![],'message':_0x3eaa4d(0x1ba)});}catch(_0x38759a){_0xd3314c(_0x38759a);}},this[_0x244ddd(0x15a)]=async(_0x2e1d31,_0x1c136e,_0x51dcae)=>{const _0x4a67aa=_0x244ddd;try{const {shopId:_0x58e3a4}=_0x2e1d31[_0x4a67aa(0x14c)],_0x15c8f4=await this[_0x4a67aa(0x1ac)]['getShopWallets'](_0x58e3a4);_0x1c136e[_0x4a67aa(0x177)]({'success':!![],'wallets':_0x15c8f4});}catch(_0x38c751){_0x51dcae(_0x38c751);}},this[_0x244ddd(0x15b)]=async(_0x412d33,_0x36e319,_0x3a8e7f)=>{const _0x21e1eb=_0x244ddd;try{const {shopId:_0x2d05aa}=_0x412d33[_0x21e1eb(0x14c)],_0xe3c102=await this[_0x21e1eb(0x1ac)][_0x21e1eb(0x15b)](_0x2d05aa);_0x36e319[_0x21e1eb(0x177)]({'success':!![],'result':_0xe3c102});}catch(_0x3ab81c){_0x3a8e7f(_0x3ab81c);}},this[_0x244ddd(0x155)]=async(_0x1e712b,_0x1d2ccc,_0x4d7aa5)=>{const _0x44469f=_0x244ddd;try{const {shopId:_0x4a2472}=_0x1e712b[_0x44469f(0x14c)],{token:_0x334ffb}=_0x1e712b[_0x44469f(0x1a6)];if(!_0x334ffb)return _0x1d2ccc['status'](0x190)['json']({'success':![],'message':'Token\x20is\x20required'});const _0x7550d8=await this[_0x44469f(0x1ac)][_0x44469f(0x155)](_0x4a2472,_0x334ffb);_0x1d2ccc['json']({'success':!![],'message':_0x44469f(0x1b6),'result':_0x7550d8});}catch(_0x5b606f){_0x4d7aa5(_0x5b606f);}},this['disable2FA']=async(_0x239e69,_0x1eb9ca,_0x6fe671)=>{const _0x2fa17f=_0x244ddd;try{const {shopId:_0x1d6c37}=_0x239e69[_0x2fa17f(0x14c)];await this[_0x2fa17f(0x1ac)][_0x2fa17f(0x171)](_0x1d6c37),_0x1eb9ca[_0x2fa17f(0x177)]({'success':!![],'message':_0x2fa17f(0x164)});}catch(_0x2bf6de){_0x6fe671(_0x2bf6de);}},this[_0x244ddd(0x176)]=async(_0x292cf7,_0x8feecf,_0x4cc4c4)=>{const _0x4d7bfb=_0x244ddd;try{const _0x571be6=await paymentCleanupService_1[_0x4d7bfb(0x1bc)][_0x4d7bfb(0x176)]();_0x8feecf[_0x4d7bfb(0x177)]({'success':!![],'result':_0x571be6});}catch(_0x2d77a1){_0x4cc4c4(_0x2d77a1);}},this[_0x244ddd(0x184)]=async(_0x281b90,_0x89380f,_0xbcce6c)=>{const _0x157006=_0x244ddd;try{console[_0x157006(0x1df)]('üßπ\x20Manual\x20PROCESSING\x20payment\x20cleanup\x20initiated\x20by\x20admin:\x20'+_0x281b90[_0x157006(0x172)]?.['username']+'\x20('+_0x281b90[_0x157006(0x172)]?.['id']+')');const _0x4756e5=await paymentCleanupService_1['paymentCleanupService']['cleanupStaleProcessingPayments']();_0x89380f[_0x157006(0x177)]({'success':!![],'message':_0x157006(0x140),'result':{'processed':_0x4756e5[_0x157006(0x1ea)],'failed':_0x4756e5[_0x157006(0x1b3)],'errors':_0x4756e5[_0x157006(0x1da)]}});}catch(_0x4ecec0){_0xbcce6c(_0x4ecec0);}},this['cleanupStalePendingPayments']=async(_0x49cbb7,_0x32ef18,_0x76e61f)=>{const _0x351d06=_0x244ddd;try{console['log'](_0x351d06(0x16d)+_0x49cbb7[_0x351d06(0x172)]?.[_0x351d06(0x191)]+'\x20('+_0x49cbb7['user']?.['id']+')');const _0x367c33=await paymentCleanupService_1[_0x351d06(0x1bc)][_0x351d06(0x16c)]();_0x32ef18[_0x351d06(0x177)]({'success':!![],'message':_0x351d06(0x149),'result':{'processed':_0x367c33[_0x351d06(0x1ea)],'failed':_0x367c33[_0x351d06(0x1b3)],'errors':_0x367c33[_0x351d06(0x1da)]}});}catch(_0x39df8b){_0x76e61f(_0x39df8b);}},this[_0x244ddd(0x188)]=async(_0x3ebb6f,_0x1db87d,_0x1296ed)=>{const _0x50289f=_0x244ddd;try{console[_0x50289f(0x1df)](_0x50289f(0x180)+_0x3ebb6f[_0x50289f(0x172)]?.[_0x50289f(0x191)]+'\x20('+_0x3ebb6f[_0x50289f(0x172)]?.['id']+')');const _0x342e87=await paymentCleanupService_1['paymentCleanupService'][_0x50289f(0x176)](),_0x40788e=await paymentCleanupService_1[_0x50289f(0x1bc)][_0x50289f(0x16b)](),_0x41af29=await paymentCleanupService_1[_0x50289f(0x1bc)][_0x50289f(0x16c)](),_0x5141a6=await paymentCleanupService_1[_0x50289f(0x1bc)][_0x50289f(0x176)]();_0x1db87d[_0x50289f(0x177)]({'success':!![],'message':_0x50289f(0x1b7),'result':{'cleanup':{'processing':{'processed':_0x40788e[_0x50289f(0x1ea)],'failed':_0x40788e[_0x50289f(0x1b3)],'errors':_0x40788e[_0x50289f(0x1da)]},'pending':{'processed':_0x41af29[_0x50289f(0x1ea)],'failed':_0x41af29['failed'],'errors':_0x41af29[_0x50289f(0x1da)]},'total':{'processed':_0x40788e[_0x50289f(0x1ea)]+_0x41af29['processed'],'failed':_0x40788e[_0x50289f(0x1b3)]+_0x41af29[_0x50289f(0x1b3)],'errors':[..._0x40788e[_0x50289f(0x1da)],..._0x41af29[_0x50289f(0x1da)]]}},'statistics':{'before':_0x342e87,'after':_0x5141a6,'reduced':_0x342e87[_0x50289f(0x142)]-_0x5141a6[_0x50289f(0x142)]}}});}catch(_0x2e8d6c){_0x1296ed(_0x2e8d6c);}},this['expirePaymentLinks']=async(_0x206fdf,_0x48c431,_0x326304)=>{const _0x4bfda1=_0x244ddd;try{const _0x14e111=await paymentCleanupService_1[_0x4bfda1(0x1bc)][_0x4bfda1(0x19d)]();_0x48c431[_0x4bfda1(0x177)]({'success':!![],'message':_0x4bfda1(0x1e0),'result':{'expired':_0x14e111['expired'],'errors':_0x14e111['errors']}});}catch(_0x5e21e0){_0x326304(_0x5e21e0);}},this[_0x244ddd(0x1e4)]=async(_0x6922f4,_0x5500c9,_0x340e10)=>{const _0x23a24d=_0x244ddd;try{const {currentPassword:_0x213f06,newPassword:_0x2fcf9b,confirmNewPassword:_0x2d141a,twoFactorToken:_0x176d12}=_0x6922f4['body'];await this[_0x23a24d(0x1ac)][_0x23a24d(0x1e4)](_0x213f06,_0x2fcf9b,_0x2d141a,_0x176d12),_0x5500c9[_0x23a24d(0x177)]({'success':!![],'message':_0x23a24d(0x187)});}catch(_0xa08803){_0x340e10(_0xa08803);}},this[_0x244ddd(0x1ad)]=async(_0x43553a,_0x59db3f,_0x20c8c9)=>{const _0x46bd6b=_0x244ddd;try{const _0x46134c=await this[_0x46bd6b(0x1ac)][_0x46bd6b(0x1ad)]();_0x59db3f[_0x46bd6b(0x177)]({'success':!![],'result':_0x46134c});}catch(_0xdcf0bd){_0x20c8c9(_0xdcf0bd);}},this[_0x244ddd(0x1aa)]=async(_0xb31c15,_0x1efc19,_0x476d88)=>{const _0x4a6698=_0x244ddd;try{const _0x54c0d9=await this[_0x4a6698(0x1ac)][_0x4a6698(0x1aa)]();_0x1efc19[_0x4a6698(0x177)]({'success':!![],'result':_0x54c0d9});}catch(_0x53f17e){_0x476d88(_0x53f17e);}},this[_0x244ddd(0x1d3)]=async(_0x4c4fc2,_0x4caa97,_0x39de1e)=>{const _0xddb90d=_0x244ddd;try{const {token:_0x16e0b3}=_0x4c4fc2[_0xddb90d(0x1a6)],_0x1ac7a3=await this[_0xddb90d(0x1ac)]['enableAdmin2FA'](_0x16e0b3);_0x4caa97[_0xddb90d(0x177)]({'success':!![],'result':_0x1ac7a3});}catch(_0x5b6111){_0x39de1e(_0x5b6111);}},this['disableAdmin2FA']=async(_0x16b308,_0x382ca4,_0x4a14ee)=>{const _0x2a668c=_0x244ddd;try{await this[_0x2a668c(0x1ac)][_0x2a668c(0x14b)](),_0x382ca4[_0x2a668c(0x177)]({'success':!![],'message':'Admin\x202FA\x20disabled\x20successfully'});}catch(_0x2f7c9f){_0x4a14ee(_0x2f7c9f);}},this['depositBalance']=async(_0x2a284a,_0x19f8a8,_0x1f6a4a)=>{const _0x485694=_0x244ddd;try{const {shopId:_0x2fad57,amount:_0x3c767b,notes:_0x2a426a}=_0x2a284a[_0x485694(0x1a6)];if(!_0x2fad57||!_0x3c767b)return _0x19f8a8[_0x485694(0x185)](0x190)['json']({'success':![],'message':_0x485694(0x151)});if(_0x3c767b<=0x0)return _0x19f8a8['status'](0x190)[_0x485694(0x177)]({'success':![],'message':'Amount\x20must\x20be\x20greater\x20than\x200'});await this[_0x485694(0x1ac)]['depositBalance'](_0x2fad57,_0x3c767b,_0x2a426a),_0x19f8a8[_0x485694(0x177)]({'success':!![],'message':_0x485694(0x17e)});}catch(_0x1f12ed){_0x1f6a4a(_0x1f12ed);}},this['getLoginLogs']=async(_0x4913eb,_0x1e44f7,_0x54222a)=>{const _0x29c47b=_0x244ddd;try{const {shopId:_0x536e08}=_0x4913eb['params'],{page:page='1',limit:limit='20'}=_0x4913eb[_0x29c47b(0x1ce)],_0x2f3fb6=(await Promise[_0x29c47b(0x17a)]()[_0x29c47b(0x1b8)](()=>__importStar(require(_0x29c47b(0x19b)))))[_0x29c47b(0x150)],_0x9d40f5=parseInt(page,0xa),_0x5d7659=parseInt(limit,0xa),_0x120a70=(_0x9d40f5-0x1)*_0x5d7659,[_0x11ef84,_0x3b3a0b]=await Promise[_0x29c47b(0x1ef)]([_0x2f3fb6[_0x29c47b(0x1c3)][_0x29c47b(0x1ae)]({'where':{'shopId':_0x536e08},'orderBy':{'createdAt':_0x29c47b(0x1af)},'skip':_0x120a70,'take':_0x5d7659}),_0x2f3fb6[_0x29c47b(0x1c3)]['count']({'where':{'shopId':_0x536e08}})]);_0x1e44f7[_0x29c47b(0x177)]({'success':!![],'result':{'logs':_0x11ef84,'pagination':{'page':_0x9d40f5,'limit':_0x5d7659,'total':_0x3b3a0b,'totalPages':Math[_0x29c47b(0x160)](_0x3b3a0b/_0x5d7659)}}});}catch(_0x173622){_0x54222a(_0x173622);}},this['getGatewaySettings']=async(_0x507c69,_0x192007,_0x1b0112)=>{const _0x4d290e=_0x244ddd;try{const _0x3a063b=gatewaySettingsService_1[_0x4d290e(0x196)]['getAllGatewaysWithSettings']();_0x192007[_0x4d290e(0x177)]({'success':!![],'result':_0x3a063b});}catch(_0x2b1f47){_0x1b0112(_0x2b1f47);}},this[_0x244ddd(0x152)]=async(_0xa282ab,_0x5e7d26,_0x37e653)=>{const _0x1f0d80=_0x244ddd;try{const {gatewayId:_0x1b44ce}=_0xa282ab[_0x1f0d80(0x14c)],{minAmount:_0x2fe164,maxAmount:_0x3f3fc9,payoutDelay:_0x23995e,gatewayCommission:_0x3b697c}=_0xa282ab[_0x1f0d80(0x1a6)],_0x3837b7=gatewaySettingsService_1[_0x1f0d80(0x196)]['updateSettings'](_0x1b44ce,{'minAmount':_0x2fe164!==undefined?Number(_0x2fe164):undefined,'maxAmount':_0x3f3fc9!==undefined?Number(_0x3f3fc9):undefined,'payoutDelay':_0x23995e!==undefined?Number(_0x23995e):undefined,'gatewayCommission':_0x3b697c!==undefined?Number(_0x3b697c):undefined});_0x5e7d26[_0x1f0d80(0x177)]({'success':!![],'message':_0x1f0d80(0x163),'result':_0x3837b7});}catch(_0x4c2870){_0x37e653(_0x4c2870);}},this[_0x244ddd(0x1f1)]=async(_0x31b10d,_0x5367f7,_0x53140e)=>{const _0x260434=_0x244ddd;try{const {gatewayId:_0x4af9e5}=_0x31b10d[_0x260434(0x14c)];console[_0x260434(0x1df)](_0x260434(0x1cb)+_0x4af9e5);const {GATEWAY_ID_MAP:_0x518bce}=await Promise[_0x260434(0x17a)]()[_0x260434(0x1b8)](()=>__importStar(require(_0x260434(0x1d7)))),_0x43fe72=_0x518bce[_0x4af9e5];console[_0x260434(0x1df)]('üìä\x20[GATEWAY\x20STATS]\x20Gateway\x20ID\x20'+_0x4af9e5+'\x20->\x20Gateway\x20Name:\x20'+_0x43fe72);if(!_0x43fe72)return console['log'](_0x260434(0x1c7)+_0x4af9e5),_0x5367f7[_0x260434(0x185)](0x194)['json']({'success':![],'message':'Gateway\x20not\x20found'});console[_0x260434(0x1df)](_0x260434(0x18b)+_0x43fe72+_0x260434(0x1e3));const _0x5f3021=await database_1['default']['payment'][_0x260434(0x1ae)]({'where':{'gateway':_0x43fe72},'select':{'id':!![],'status':!![],'amountUSDT':!![]},'take':0x5});console[_0x260434(0x1df)]('üîç\x20[GATEWAY\x20STATS]\x20Sample\x20payments\x20for\x20'+_0x43fe72+':',JSON[_0x260434(0x147)](_0x5f3021,null,0x2));const _0x370860=await database_1[_0x260434(0x150)][_0x260434(0x1e7)]['findMany']({'where':{'gateway':_0x43fe72,'status':_0x260434(0x154)},'select':{'amountUSDT':!![]}});console[_0x260434(0x1df)](_0x260434(0x1a9)+_0x370860[_0x260434(0x1c8)]+_0x260434(0x16e)+_0x43fe72);const _0x3c24e4=await database_1[_0x260434(0x150)][_0x260434(0x1e7)]['count']({'where':{'gateway':_0x43fe72,'status':_0x260434(0x154)}}),_0x451264=await database_1[_0x260434(0x150)][_0x260434(0x1e7)][_0x260434(0x1d1)]({'where':{'gateway':_0x43fe72,'status':_0x260434(0x1ee)}});console[_0x260434(0x1df)]('üîô\x20[GATEWAY\x20STATS]\x20Chargeback\x20count:\x20'+_0x451264);const _0x35c5e1=await database_1[_0x260434(0x150)]['payment'][_0x260434(0x1d1)]({'where':{'gateway':_0x43fe72,'status':_0x260434(0x19e)}});console[_0x260434(0x1df)](_0x260434(0x1e1)+_0x35c5e1);const {gatewaySettingsService:_0x55d4b0}=await Promise['resolve']()[_0x260434(0x1b8)](()=>__importStar(require('../services/gatewaySettingsService'))),_0x548016=_0x55d4b0['getSettingsByGatewayId'](_0x4af9e5),_0x1c39f2=_0x548016?.[_0x260434(0x190)]||0x0;console[_0x260434(0x1df)]('üìä\x20[GATEWAY\x20STATS]\x20Gateway\x20commission:\x20'+_0x1c39f2+'%');let _0x3b540c=0x0,_0x17b615=0x0;_0x370860[_0x260434(0x193)](_0x9f12e4=>{const _0x26e42f=_0x9f12e4['amountUSDT']||0x0;_0x3b540c+=_0x26e42f;const _0x5e9ad3=_0x26e42f*(_0x1c39f2/0x64);_0x17b615+=_0x5e9ad3;});const _0x2cc5a9=_0x3c24e4,_0x48cd0a=_0x2cc5a9>0x0?_0x451264/_0x2cc5a9*0x64:0x0;console[_0x260434(0x1df)](_0x260434(0x15c)),console['log'](_0x260434(0x17b)+_0x3b540c),console['log']('\x20\x20\x20-\x20Total\x20Commission:\x20'+_0x17b615),console[_0x260434(0x1df)](_0x260434(0x1c1)+_0x2cc5a9),console[_0x260434(0x1df)](_0x260434(0x169)+_0x48cd0a+'%'),_0x5367f7[_0x260434(0x177)]({'success':!![],'result':{'gatewayId':_0x4af9e5,'totalTurnover':Number(_0x3b540c[_0x260434(0x1bb)](0x2)),'totalCommission':Number(_0x17b615['toFixed'](0x2)),'successfulPayments':_0x2cc5a9,'chargebackCount':_0x451264,'chargebackRate':Number(_0x48cd0a[_0x260434(0x1bb)](0x2)),'refundCount':_0x35c5e1}});}catch(_0x1a202e){console[_0x260434(0x189)](_0x260434(0x14f),_0x1a202e),_0x53140e(_0x1a202e);}},this['adminService']=new adminService_1['AdminService'](),this['paymentLinkService']=new paymentLinkService_1[(_0x244ddd(0x153))]();}}exports['AdminController']=AdminController;function a4_0x1e57(){const _0x219f6d=['Payment\x20link\x20expiration\x20check\x20completed\x20successfully','üí∏\x20[GATEWAY\x20STATS]\x20Refund\x20count:\x20','deletePayout','\x22\x20and\x20status=\x22PAID\x22','changeAdminPassword','üéØ\x20[CONTROLLER]\x20Creating\x20payout\x20with\x20data:','üìà\x20Admin\x20changed\x20payment\x20','payment','\x20status\x20changed\x20from\x20','\x20to\x20','processed','3234152nnmnlv','1408725xzOVfD','expired','CHARGEBACK','all','getAllUsers','getGatewayStatistics','57290PCrYuK','PROCESSING\x20payment\x20cleanup\x20completed\x20successfully','createdAt','total','toUpperCase','suspendUser','getSystemStatistics','8303364baswtB','stringify','paymentLinkService','PENDING\x20payment\x20cleanup\x20completed\x20successfully','gateway','disableAdmin2FA','params','User\x20not\x20found','get','‚ùå\x20[GATEWAY\x20STATS]\x20Error:','default','shopId\x20and\x20amount\x20are\x20required','updateGatewaySettings','PaymentLinkService','PAID','enable2FA','‚úÖ\x20Telegram\x20notification\x20sent\x20for\x20status\x20change:\x20','User\x20created\x20successfully','getMerchantsSelection','üéØ\x20[CONTROLLER]\x20Updating\x20payout\x20','getShopWallets','setup2FA','üìà\x20[GATEWAY\x20STATS]\x20Calculated\x20statistics:','refund','updatePaymentStatus','7uqLChu','ceil','summary','üîÑ\x20Admin\x20updating\x20customer\x20data\x20for\x20payment\x20','Gateway\x20settings\x20updated\x20successfully','2FA\x20disabled\x20successfully','checkAuth','getUserById','updateCustomerData','6dZRzGa','\x20\x20\x20-\x20Chargeback\x20Rate:\x20','getAllPayments','cleanupStaleProcessingPayments','cleanupStalePendingPayments','‚è∞\x20Manual\x20PENDING\x20payment\x20cleanup\x20initiated\x20by\x20admin:\x20','\x20paid\x20payments\x20for\x20','updatePayment','30EtAvve','disable2FA','user','2789303YMjlOy','Failed\x20to\x20send\x20Telegram\x20notification\x20for\x20status\x20change:','merchants','getProcessingPaymentsStats','json','280520WdjrOy','Failed\x20to\x20update\x20payment\x20link\x20counter:','resolve','\x20\x20\x20-\x20Total\x20Turnover:\x20','FAILED','getStatistics','Balance\x20deposited\x20successfully','PROCESSING','üìä\x20Manual\x20payment\x20cleanup\x20(PROCESSING\x20+\x20PENDING)\x20with\x20report\x20initiated\x20by\x20admin:\x20','month','statistics','prototype','cleanupStalePayments','status','hasPayoutHistory','Admin\x20password\x20changed\x20successfully','cleanupStalePaymentsWithReport','error','../services/telegramBotService','üîç\x20[GATEWAY\x20STATS]\x20Querying\x20payments\x20with\x20gateway=\x22','User\x20activated\x20successfully','configurable','__setModuleDefault','periodFrom,\x20periodTo,\x20and\x20gateway\x20are\x20required','gatewayCommission','username','Payout\x20updated\x20successfully','forEach','getMerchantsAwaitingPayout','paid','gatewaySettingsService','14090JsZIOu','üì±\x20Payment\x20','getPayoutById','üì±\x20Skipping\x20Telegram\x20notification\x20for\x20status\x20change\x20to:\x20','../config/database','defineProperty','expireSinglePaymentLinks','REFUND','\x20->\x20','‚úÖ\x20Payment\x20link\x20counter\x20updated\x20for\x20payment\x20','createUser','pagination','Admin\x20access\x20confirmed','getOwnPropertyNames','getPayoutReports','body','getAllPayouts','deleteUser','üí∞\x20[GATEWAY\x20STATS]\x20Found\x20','setupAdmin2FA','updateUser','adminService','get2FASettings','findMany','desc',',\x20sending\x20Telegram\x20notification','üìä\x20Admin\x20requesting\x20merchant\x20statistics\x20with\x20filters:','Payout\x20not\x20found','failed','handleSuccessfulPayment','__importDefault','2FA\x20enabled\x20successfully','Payment\x20cleanup\x20(PROCESSING\x20+\x20PENDING)\x20with\x20report\x20completed\x20successfully','then','AdminController','User\x20deleted\x20successfully','toFixed','paymentCleanupService','role','30d','payments','hasOwnProperty','\x20\x20\x20-\x20Successful\x20Payments:\x20','../services/paymentLinkService','loginLog','__createBinding','shopId','\x20with\x20data:','‚ùå\x20[GATEWAY\x20STATS]\x20Gateway\x20not\x20found\x20for\x20ID:\x20','length','üìä\x20Admin\x20requesting\x20payout\x20reports:','getPaymentById','üìä\x20[GATEWAY\x20STATS]\x20Requesting\x20statistics\x20for\x20gateway\x20ID:\x20','getMerchantStatistics','telegramBotService','query','activateUser','getPayoutStats','count','getUsers','enableAdmin2FA','1806QVdLYv','Payment\x20not\x20found','getPayouts','../types/gateway','Customer\x20data\x20updated\x20successfully','../services/adminService','errors','12ClYHQK','__esModule','call','User\x20updated\x20successfully','log'];a4_0x1e57=function(){return _0x219f6d;};return a4_0x1e57();}