'use strict';function a10_0x35ee(_0x3c6f8a,_0x3ee0e1){_0x3c6f8a=_0x3c6f8a-0xb2;const _0x598769=a10_0x5987();let _0x35ee9f=_0x598769[_0x3c6f8a];return _0x35ee9f;}const a10_0x5138ad=a10_0x35ee;(function(_0x3674c3,_0x5c76d7){const _0x147953=a10_0x35ee,_0x325d7e=_0x3674c3();while(!![]){try{const _0x16811c=parseInt(_0x147953(0x103))/0x1+-parseInt(_0x147953(0x115))/0x2+parseInt(_0x147953(0x108))/0x3+-parseInt(_0x147953(0xe8))/0x4+parseInt(_0x147953(0xc4))/0x5*(parseInt(_0x147953(0xce))/0x6)+-parseInt(_0x147953(0x10c))/0x7*(parseInt(_0x147953(0xd1))/0x8)+parseInt(_0x147953(0xe1))/0x9*(parseInt(_0x147953(0x110))/0xa);if(_0x16811c===_0x5c76d7)break;else _0x325d7e['push'](_0x325d7e['shift']());}catch(_0x3f6063){_0x325d7e['push'](_0x325d7e['shift']());}}}(a10_0x5987,0xaea0e));var __importDefault=this&&this[a10_0x5138ad(0xb9)]||function(_0x4b311f){const _0x52ec72=a10_0x5138ad;return _0x4b311f&&_0x4b311f[_0x52ec72(0xff)]?_0x4b311f:{'default':_0x4b311f};};Object[a10_0x5138ad(0xcf)](exports,a10_0x5138ad(0xff),{'value':!![]}),exports[a10_0x5138ad(0xc5)]=exports['ManualPaymentController']=void 0x0;function a10_0x5987(){const _0x58b5c2=['base64','Please\x20complete\x20a\x20SEPA\x20bank\x20transfer\x20for\x20',',\x20size:\x20','update','connection','sendShopNotification','78bHKRuM','defineProperty','‚è≥\x20Payment\x20is\x20now\x20awaiting\x20manual\x20verification...','1912HLGgYo','replace','uploadPaymentProof','amount','üåê\x20Client\x20IP:\x20','jpeg','params','üí∞\x20Amount:\x20','length','üì§\x20Upload\x20payment\x20proof\x20request\x20for\x20payment:\x20','name','shop','sepa','.\x20Supported:\x20','pdf','message','9YMeZzF','Interac\x20e-Transfer','File\x20data\x20is\x20required','sendDirectMessage','interac','log','updatedAt','4310708gfzwDL','SEPA\x20Bank\x20Transfer','payment_proof_','\x20Payment\x20Proof\x20Received\x0a\x0a','üí≥\x20Payment\x20ID:\x20','üîÑ\x20','unknown','‚ùå\x20Upload\x20payment\x20proof\x20error:','heic','join','status','üì±\x20Admin\x20notification\x20and\x20file\x20sent','Admin\x20copy\x20-\x20Payment\x20proof\x20for\x20','‚ùå\x20Payment\x20not\x20found:\x20','body','Payment\x20ID\x20is\x20required','payment','üåê\x20Customer\x20IP:\x20','username','telegramBotService','split','default','7867339505','__esModule','findUnique','File\x20type\x20is\x20required','10MB','866176UYEgTx','üìä\x20Status:\x20PENDING\x20‚Üí\x20PROCESSING\x0a','json','üè™\x20Shop:\x20','Unknown\x20error','3298551znRgfy','Internal\x20server\x20error','‚ö†Ô∏è\x20Please\x20verify\x20and\x20approve\x20this\x20payment\x20manually.','includes','22897Xpgnrq','Invalid\x20base64\x20file\x20data','../services/telegramBotService','currency','4931390ABSQEj','error','../config/database','\x20\x20\x20-\x20File\x20type:\x20','sendDirectFile','145060Bnfyle','Manual\x20payment\x20info\x20not\x20available\x20for\x20gateway:\x20','\x20\x20\x20-\x20Payment\x20ID:\x20','JPG','üìÅ\x20File\x20type:\x20','Payment\x20not\x20found','HEIC','PDF','Unsupported\x20file\x20type:\x20','Payment\x20proof\x20for\x20','üì±\x20Notification\x20and\x20file\x20sent\x20to\x20merchant','üìÅ\x20File:\x20','File\x20too\x20large.\x20Maximum\x20size:\x2010MB','jpg','sendShopFile','KB)\x0a','‚ùå\x20Get\x20manual\x20payment\x20info\x20error:','__importDefault','from','\x20\x20\x20-\x20Status:\x20PENDING\x20->\x20PROCESSING','Manual\x20proof\x20upload\x20not\x20supported\x20for\x20gateway:\x20','shopId','toUpperCase','round','\x20and\x20upload\x20a\x20screenshot\x20of\x20the\x20confirmation.','gateway','remoteAddress','toLowerCase','72470layPPT','manualPaymentController','\x20\x20\x20-\x20Gateway:\x20','‚úÖ\x20Payment\x20proof\x20uploaded\x20successfully:'];a10_0x5987=function(){return _0x58b5c2;};return a10_0x5987();}const database_1=__importDefault(require(a10_0x5138ad(0x112))),telegramBotService_1=require(a10_0x5138ad(0x10e));class ManualPaymentController{async[a10_0x5138ad(0xd3)](_0x12b003,_0x38aa91){const _0x1253fe=a10_0x5138ad;try{const {paymentId:_0x233d56,fileData:_0x4881f6,fileType:_0x4ebcc9,fileName:_0x344cd9}=_0x12b003[_0x1253fe(0xf6)],_0x4d93ca=_0x12b003['ip']||_0x12b003[_0x1253fe(0xcc)]?.[_0x1253fe(0xc2)]||_0x1253fe(0xee);console['log'](_0x1253fe(0xda)+_0x233d56),console[_0x1253fe(0xe6)](_0x1253fe(0x119)+_0x4ebcc9+_0x1253fe(0xca)+(_0x4881f6?Math[_0x1253fe(0xbf)](_0x4881f6[_0x1253fe(0xd9)]*0.75/0x400):0x0)+'KB'),console[_0x1253fe(0xe6)](_0x1253fe(0xd5)+_0x4d93ca);if(!_0x233d56){_0x38aa91[_0x1253fe(0xf2)](0x190)[_0x1253fe(0x105)]({'success':![],'error':_0x1253fe(0xf7)});return;}if(!_0x4881f6){_0x38aa91[_0x1253fe(0xf2)](0x190)['json']({'success':![],'error':_0x1253fe(0xe3)});return;}if(!_0x4ebcc9){_0x38aa91['status'](0x190)[_0x1253fe(0x105)]({'success':![],'error':_0x1253fe(0x101)});return;}const _0x4af9de=['png',_0x1253fe(0xb5),_0x1253fe(0xd6),_0x1253fe(0xf0),_0x1253fe(0xdf)],_0x47f178=_0x4ebcc9[_0x1253fe(0xc3)]()[_0x1253fe(0xd2)]('.','');if(!_0x4af9de['includes'](_0x47f178)){_0x38aa91[_0x1253fe(0xf2)](0x190)['json']({'success':![],'error':_0x1253fe(0x11d)+_0x4ebcc9+_0x1253fe(0xde)+_0x4af9de[_0x1253fe(0xf1)](',\x20')});return;}const _0x358543=0xa*0x400*0x400;if(_0x4881f6[_0x1253fe(0xd9)]>_0x358543){_0x38aa91['status'](0x190)[_0x1253fe(0x105)]({'success':![],'error':_0x1253fe(0xb4)});return;}const _0xaba65=await database_1[_0x1253fe(0xfd)][_0x1253fe(0xf8)][_0x1253fe(0x100)]({'where':{'id':_0x233d56},'include':{'shop':{'select':{'name':!![],'username':!![]}}}});if(!_0xaba65){console['log'](_0x1253fe(0xf5)+_0x233d56),_0x38aa91[_0x1253fe(0xf2)](0x194)[_0x1253fe(0x105)]({'success':![],'error':_0x1253fe(0x11a)});return;}if(_0xaba65['gateway']!==_0x1253fe(0xe5)&&_0xaba65[_0x1253fe(0xc1)]!=='sepa'){console[_0x1253fe(0xe6)]('‚ùå\x20Invalid\x20gateway\x20for\x20manual\x20payment:\x20'+_0xaba65['gateway']),_0x38aa91[_0x1253fe(0xf2)](0x190)[_0x1253fe(0x105)]({'success':![],'error':_0x1253fe(0xbc)+_0xaba65[_0x1253fe(0xc1)]});return;}let _0x5ccd48=_0x4881f6;_0x4881f6[_0x1253fe(0x10b)](',')&&(_0x5ccd48=_0x4881f6[_0x1253fe(0xfc)](',')[0x1]);try{Buffer[_0x1253fe(0xba)](_0x5ccd48,_0x1253fe(0xc8));}catch(_0x2e9f12){_0x38aa91[_0x1253fe(0xf2)](0x190)[_0x1253fe(0x105)]({'success':![],'error':_0x1253fe(0x10d)});return;}const _0x4e0d3e=await database_1[_0x1253fe(0xfd)][_0x1253fe(0xf8)][_0x1253fe(0xcb)]({'where':{'id':_0x233d56},'data':{'status':'PROCESSING','updatedAt':new Date()}});console[_0x1253fe(0xe6)](_0x1253fe(0xc7)),console[_0x1253fe(0xe6)](_0x1253fe(0x117)+_0x233d56),console[_0x1253fe(0xe6)](_0x1253fe(0xc6)+_0xaba65[_0x1253fe(0xc1)][_0x1253fe(0xbe)]()),console[_0x1253fe(0xe6)](_0x1253fe(0x113)+_0x47f178),console[_0x1253fe(0xe6)]('\x20\x20\x20-\x20File\x20size:\x20'+Math[_0x1253fe(0xbf)](_0x5ccd48[_0x1253fe(0xd9)]*0.75/0x400)+'KB'),console[_0x1253fe(0xe6)](_0x1253fe(0xbb));try{const _0xd36899=_0xaba65[_0x1253fe(0xc1)]['toUpperCase'](),_0xec3dcf=_0xaba65[_0x1253fe(0xdc)][_0x1253fe(0xdb)]||_0xaba65[_0x1253fe(0xdc)][_0x1253fe(0xfa)],_0x120919=Math[_0x1253fe(0xbf)](_0x5ccd48[_0x1253fe(0xd9)]*0.75/0x400),_0x25bb20='üîÑ\x20'+_0xd36899+_0x1253fe(0xeb)+(_0x1253fe(0xec)+_0x233d56+'\x0a')+(_0x1253fe(0xd8)+_0xaba65[_0x1253fe(0xd4)]+'\x20'+_0xaba65[_0x1253fe(0x10f)]+'\x0a')+(_0x1253fe(0xb3)+_0x47f178[_0x1253fe(0xbe)]()+'\x20('+_0x120919+_0x1253fe(0xb7))+_0x1253fe(0x104)+(_0x1253fe(0xf9)+_0x4d93ca+'\x0a\x0a')+_0x1253fe(0xd0);await telegramBotService_1['telegramBotService'][_0x1253fe(0xcd)](_0xaba65[_0x1253fe(0xbd)],_0x25bb20,{'parse_mode':'Markdown'});const _0x3c85be=Buffer[_0x1253fe(0xba)](_0x5ccd48,_0x1253fe(0xc8)),_0x7406c0=_0x1253fe(0xea)+_0x233d56+'.'+_0x47f178;await telegramBotService_1[_0x1253fe(0xfb)][_0x1253fe(0xb6)](_0xaba65[_0x1253fe(0xbd)],_0x3c85be,_0x7406c0,_0x1253fe(0x11e)+_0x233d56),console[_0x1253fe(0xe6)](_0x1253fe(0xb2));const _0xe0e351=_0x1253fe(0xfe),_0x3b6c9e=_0x1253fe(0xed)+_0xd36899+'\x20Payment\x20Proof\x20(Admin\x20Copy)\x0a\x0a'+(_0x1253fe(0xec)+_0x233d56+'\x0a')+(_0x1253fe(0x106)+_0xec3dcf+'\x0a')+(_0x1253fe(0xd8)+_0xaba65['amount']+'\x20'+_0xaba65[_0x1253fe(0x10f)]+'\x0a')+(_0x1253fe(0xb3)+_0x47f178[_0x1253fe(0xbe)]()+'\x20('+_0x120919+_0x1253fe(0xb7))+_0x1253fe(0x104)+(_0x1253fe(0xf9)+_0x4d93ca+'\x0a\x0a')+_0x1253fe(0x10a);await telegramBotService_1[_0x1253fe(0xfb)][_0x1253fe(0xe4)](parseInt(_0xe0e351),_0x3b6c9e),await telegramBotService_1['telegramBotService'][_0x1253fe(0x114)](parseInt(_0xe0e351),_0x3c85be,_0x7406c0,_0x1253fe(0xf4)+_0x233d56),console[_0x1253fe(0xe6)](_0x1253fe(0xf3));}catch(_0xf9ea){console[_0x1253fe(0x111)]('‚ùå\x20Failed\x20to\x20send\x20Telegram\x20notifications:',_0xf9ea);}_0x38aa91[_0x1253fe(0x105)]({'success':!![],'message':'Payment\x20proof\x20uploaded\x20successfully','data':{'paymentId':_0x4e0d3e['id'],'status':_0x4e0d3e[_0x1253fe(0xf2)],'gateway':_0xaba65['gateway'],'fileType':_0x47f178,'fileSize':Math[_0x1253fe(0xbf)](_0x5ccd48[_0x1253fe(0xd9)]*0.75/0x400)+'KB','uploadedAt':_0x4e0d3e[_0x1253fe(0xe7)]}});}catch(_0x2f27cb){console[_0x1253fe(0x111)](_0x1253fe(0xef),_0x2f27cb),_0x38aa91['status'](0x1f4)['json']({'success':![],'error':_0x1253fe(0x109),'details':_0x2f27cb instanceof Error?_0x2f27cb[_0x1253fe(0xe0)]:_0x1253fe(0x107)});}}async['getManualPaymentInfo'](_0x35fd17,_0xd89c1f){const _0x5b153b=a10_0x5138ad;try{const {paymentId:_0x5ac9c2}=_0x35fd17[_0x5b153b(0xd7)];console[_0x5b153b(0xe6)]('üìã\x20Get\x20manual\x20payment\x20info:\x20'+_0x5ac9c2);const _0x4d52c4=await database_1['default'][_0x5b153b(0xf8)]['findUnique']({'where':{'id':_0x5ac9c2},'include':{'shop':{'select':{'name':!![],'username':!![]}}}});if(!_0x4d52c4){_0xd89c1f[_0x5b153b(0xf2)](0x194)[_0x5b153b(0x105)]({'success':![],'error':'Payment\x20not\x20found'});return;}if(_0x4d52c4['gateway']!==_0x5b153b(0xe5)&&_0x4d52c4[_0x5b153b(0xc1)]!==_0x5b153b(0xdd)){_0xd89c1f[_0x5b153b(0xf2)](0x190)[_0x5b153b(0x105)]({'success':![],'error':_0x5b153b(0x116)+_0x4d52c4[_0x5b153b(0xc1)]});return;}let _0x2d9bd4='',_0x2fa0e5=_0x4d52c4[_0x5b153b(0x10f)],_0x23f050='';if(_0x4d52c4[_0x5b153b(0xc1)]===_0x5b153b(0xe5))_0x23f050=_0x5b153b(0xe2),_0x2fa0e5='CAD',_0x2d9bd4='Please\x20complete\x20an\x20Interac\x20e-Transfer\x20for\x20'+_0x4d52c4[_0x5b153b(0xd4)]+'\x20'+_0x2fa0e5+_0x5b153b(0xc0);else _0x4d52c4[_0x5b153b(0xc1)]===_0x5b153b(0xdd)&&(_0x23f050=_0x5b153b(0xe9),_0x2fa0e5='EUR',_0x2d9bd4=_0x5b153b(0xc9)+_0x4d52c4[_0x5b153b(0xd4)]+'\x20'+_0x2fa0e5+_0x5b153b(0xc0));const _0x4c3fd3={'success':!![],'data':{'paymentId':_0x4d52c4['id'],'gateway':_0x4d52c4[_0x5b153b(0xc1)],'gatewayName':_0x4d52c4[_0x5b153b(0xc1)][_0x5b153b(0xbe)](),'transferType':_0x23f050,'amount':_0x4d52c4[_0x5b153b(0xd4)],'currency':_0x2fa0e5,'status':_0x4d52c4[_0x5b153b(0xf2)],'instructions':_0x2d9bd4,'shopName':_0x4d52c4[_0x5b153b(0xdc)]['name']||_0x4d52c4['shop'][_0x5b153b(0xfa)],'hasProof':![],'proofType':null,'createdAt':_0x4d52c4['createdAt'],'updatedAt':_0x4d52c4[_0x5b153b(0xe7)],'supportedFileTypes':['PNG',_0x5b153b(0x118),'JPEG',_0x5b153b(0x11b),_0x5b153b(0x11c)],'maxFileSize':_0x5b153b(0x102)}};_0xd89c1f[_0x5b153b(0x105)](_0x4c3fd3);}catch(_0x2561e2){console[_0x5b153b(0x111)](_0x5b153b(0xb8),_0x2561e2),_0xd89c1f[_0x5b153b(0xf2)](0x1f4)[_0x5b153b(0x105)]({'success':![],'error':_0x5b153b(0x109),'details':_0x2561e2 instanceof Error?_0x2561e2[_0x5b153b(0xe0)]:_0x5b153b(0x107)});}}}exports['ManualPaymentController']=ManualPaymentController,exports['manualPaymentController']=new ManualPaymentController();