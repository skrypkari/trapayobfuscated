'use strict';function a8_0x4e03(_0x108887,_0x28c768){const _0x5a26bc=a8_0x5a26();return a8_0x4e03=function(_0x4e03d1,_0x4e9f3c){_0x4e03d1=_0x4e03d1-0x8a;let _0x1a6647=_0x5a26bc[_0x4e03d1];return _0x1a6647;},a8_0x4e03(_0x108887,_0x28c768);}const a8_0x22a154=a8_0x4e03;(function(_0x440901,_0x1e49b8){const _0x35cb34=a8_0x4e03,_0x19b1c5=_0x440901();while(!![]){try{const _0x48e420=parseInt(_0x35cb34(0xa7))/0x1*(parseInt(_0x35cb34(0xaa))/0x2)+-parseInt(_0x35cb34(0x91))/0x3+-parseInt(_0x35cb34(0x9e))/0x4*(-parseInt(_0x35cb34(0xc1))/0x5)+parseInt(_0x35cb34(0x98))/0x6*(-parseInt(_0x35cb34(0xba))/0x7)+-parseInt(_0x35cb34(0xb3))/0x8*(parseInt(_0x35cb34(0xc3))/0x9)+-parseInt(_0x35cb34(0xad))/0xa+parseInt(_0x35cb34(0xcd))/0xb*(parseInt(_0x35cb34(0xa4))/0xc);if(_0x48e420===_0x1e49b8)break;else _0x19b1c5['push'](_0x19b1c5['shift']());}catch(_0x34ccf8){_0x19b1c5['push'](_0x19b1c5['shift']());}}}(a8_0x5a26,0x9b543));var __importDefault=this&&this['__importDefault']||function(_0x480dc6){const _0x2505bf=a8_0x4e03;return _0x480dc6&&_0x480dc6[_0x2505bf(0x99)]?_0x480dc6:{'default':_0x480dc6};};Object['defineProperty'](exports,a8_0x22a154(0x99),{'value':!![]}),exports['manualPaymentController']=exports['ManualPaymentController']=void 0x0;const database_1=__importDefault(require(a8_0x22a154(0x8d)));class ManualPaymentController{async[a8_0x22a154(0xce)](_0x2e4f7b,_0xce2a21){const _0x1e420b=a8_0x22a154;try{const {paymentId:_0x4bdd35,fileData:_0x45da2e,fileType:_0xceea1e,fileName:_0x2df771}=_0x2e4f7b[_0x1e420b(0xc0)],_0x4b5ae7=_0x2e4f7b['ip']||_0x2e4f7b[_0x1e420b(0xbd)]?.[_0x1e420b(0x93)]||_0x1e420b(0xdc);console[_0x1e420b(0x9f)](_0x1e420b(0xd2)+_0x4bdd35),console[_0x1e420b(0x9f)](_0x1e420b(0xb7)+_0xceea1e+_0x1e420b(0xb2)+(_0x45da2e?Math['round'](_0x45da2e[_0x1e420b(0x9c)]*0.75/0x400):0x0)+'KB'),console[_0x1e420b(0x9f)](_0x1e420b(0xdd)+_0x4b5ae7);if(!_0x4bdd35){_0xce2a21[_0x1e420b(0xc2)](0x190)[_0x1e420b(0xc9)]({'success':![],'error':'Payment\x20ID\x20is\x20required'});return;}if(!_0x45da2e){_0xce2a21[_0x1e420b(0xc2)](0x190)['json']({'success':![],'error':_0x1e420b(0x9b)});return;}if(!_0xceea1e){_0xce2a21[_0x1e420b(0xc2)](0x190)[_0x1e420b(0xc9)]({'success':![],'error':_0x1e420b(0xd0)});return;}const _0x223abf=['png','jpg','jpeg',_0x1e420b(0xa2),_0x1e420b(0xb1)],_0x3723c9=_0xceea1e[_0x1e420b(0xc5)]()[_0x1e420b(0xa1)]('.','');if(!_0x223abf[_0x1e420b(0xd5)](_0x3723c9)){_0xce2a21[_0x1e420b(0xc2)](0x190)[_0x1e420b(0xc9)]({'success':![],'error':_0x1e420b(0x8f)+_0xceea1e+_0x1e420b(0xa9)+_0x223abf[_0x1e420b(0xc7)](',\x20')});return;}const _0x2e997a=0xa*0x400*0x400;if(_0x45da2e[_0x1e420b(0x9c)]>_0x2e997a){_0xce2a21[_0x1e420b(0xc2)](0x190)[_0x1e420b(0xc9)]({'success':![],'error':_0x1e420b(0xc4)});return;}const _0x53b736=await database_1[_0x1e420b(0xc8)][_0x1e420b(0xa8)][_0x1e420b(0xb4)]({'where':{'id':_0x4bdd35},'include':{'shop':{'select':{'name':!![],'username':!![]}}}});if(!_0x53b736){console[_0x1e420b(0x9f)](_0x1e420b(0xd4)+_0x4bdd35),_0xce2a21[_0x1e420b(0xc2)](0x194)[_0x1e420b(0xc9)]({'success':![],'error':_0x1e420b(0xd8)});return;}if(_0x53b736[_0x1e420b(0xbe)]!==_0x1e420b(0xa6)&&_0x53b736[_0x1e420b(0xbe)]!==_0x1e420b(0xda)){console[_0x1e420b(0x9f)]('‚ùå\x20Invalid\x20gateway\x20for\x20manual\x20payment:\x20'+_0x53b736['gateway']),_0xce2a21[_0x1e420b(0xc2)](0x190)['json']({'success':![],'error':_0x1e420b(0xa0)+_0x53b736[_0x1e420b(0xbe)]});return;}let _0x44ac35=_0x45da2e;_0x45da2e[_0x1e420b(0xd5)](',')&&(_0x44ac35=_0x45da2e[_0x1e420b(0x96)](',')[0x1]);try{Buffer[_0x1e420b(0xd6)](_0x44ac35,'base64');}catch(_0x1d98f5){_0xce2a21[_0x1e420b(0xc2)](0x190)[_0x1e420b(0xc9)]({'success':![],'error':_0x1e420b(0xcf)});return;}const _0x1cdae7=await database_1[_0x1e420b(0xc8)][_0x1e420b(0xa8)][_0x1e420b(0xcb)]({'where':{'id':_0x4bdd35},'data':{'paymentProof':_0x44ac35,'paymentProofType':_0x3723c9,'status':_0x1e420b(0xb0),'updatedAt':new Date()}});console[_0x1e420b(0x9f)]('‚úÖ\x20Payment\x20proof\x20uploaded\x20successfully:'),console[_0x1e420b(0x9f)]('\x20\x20\x20-\x20Payment\x20ID:\x20'+_0x4bdd35),console[_0x1e420b(0x9f)](_0x1e420b(0xb8)+_0x53b736[_0x1e420b(0xbe)][_0x1e420b(0xcc)]()),console[_0x1e420b(0x9f)](_0x1e420b(0xbc)+_0x3723c9),console[_0x1e420b(0x9f)](_0x1e420b(0xd3)+Math[_0x1e420b(0xae)](_0x44ac35[_0x1e420b(0x9c)]*0.75/0x400)+'KB'),console[_0x1e420b(0x9f)](_0x1e420b(0xac)),_0xce2a21[_0x1e420b(0xc9)]({'success':!![],'message':'Payment\x20proof\x20uploaded\x20successfully','data':{'paymentId':_0x1cdae7['id'],'status':_0x1cdae7[_0x1e420b(0xc2)],'gateway':_0x53b736[_0x1e420b(0xbe)],'fileType':_0x3723c9,'fileSize':Math[_0x1e420b(0xae)](_0x44ac35[_0x1e420b(0x9c)]*0.75/0x400)+'KB','uploadedAt':_0x1cdae7[_0x1e420b(0xc6)]}});}catch(_0x52415b){console[_0x1e420b(0x92)]('‚ùå\x20Upload\x20payment\x20proof\x20error:',_0x52415b),_0xce2a21['status'](0x1f4)[_0x1e420b(0xc9)]({'success':![],'error':_0x1e420b(0x9a),'details':_0x52415b instanceof Error?_0x52415b[_0x1e420b(0xab)]:'Unknown\x20error'});}}async[a8_0x22a154(0x90)](_0x426b80,_0x50292d){const _0x114429=a8_0x22a154;try{const {paymentId:_0x5a2d50}=_0x426b80[_0x114429(0xd1)];console[_0x114429(0x9f)](_0x114429(0x8e)+_0x5a2d50);const _0x55d63d=await database_1['default'][_0x114429(0xa8)]['findUnique']({'where':{'id':_0x5a2d50},'include':{'shop':{'select':{'name':!![],'username':!![]}}}});if(!_0x55d63d){_0x50292d[_0x114429(0xc2)](0x194)[_0x114429(0xc9)]({'success':![],'error':_0x114429(0xd8)});return;}if(_0x55d63d['gateway']!==_0x114429(0xa6)&&_0x55d63d[_0x114429(0xbe)]!==_0x114429(0xda)){_0x50292d[_0x114429(0xc2)](0x190)[_0x114429(0xc9)]({'success':![],'error':_0x114429(0xa3)+_0x55d63d['gateway']});return;}let _0x3a5fad='',_0x2c245e=_0x55d63d['currency'],_0x5c052e='';if(_0x55d63d[_0x114429(0xbe)]===_0x114429(0xa6))_0x5c052e=_0x114429(0x8c),_0x2c245e=_0x114429(0x8a),_0x3a5fad='Please\x20complete\x20an\x20Interac\x20e-Transfer\x20for\x20'+_0x55d63d[_0x114429(0xb9)]+'\x20'+_0x2c245e+_0x114429(0x97);else _0x55d63d[_0x114429(0xbe)]===_0x114429(0xda)&&(_0x5c052e=_0x114429(0xd7),_0x2c245e=_0x114429(0xaf),_0x3a5fad=_0x114429(0xdb)+_0x55d63d[_0x114429(0xb9)]+'\x20'+_0x2c245e+_0x114429(0x97));const _0x59d61c={'success':!![],'data':{'paymentId':_0x55d63d['id'],'gateway':_0x55d63d[_0x114429(0xbe)],'gatewayName':_0x55d63d['gateway'][_0x114429(0xcc)](),'transferType':_0x5c052e,'amount':_0x55d63d['amount'],'currency':_0x2c245e,'status':_0x55d63d['status'],'instructions':_0x3a5fad,'shopName':_0x55d63d['shop'][_0x114429(0x8b)]||_0x55d63d[_0x114429(0xbb)]['username'],'hasProof':![],'proofType':null,'createdAt':_0x55d63d[_0x114429(0xa5)],'updatedAt':_0x55d63d[_0x114429(0xc6)],'supportedFileTypes':[_0x114429(0xb5),_0x114429(0xb6),'JPEG',_0x114429(0xd9),_0x114429(0x94)],'maxFileSize':'10MB'}};_0x50292d[_0x114429(0xc9)](_0x59d61c);}catch(_0x3b5dad){console[_0x114429(0x92)](_0x114429(0x9d),_0x3b5dad),_0x50292d[_0x114429(0xc2)](0x1f4)['json']({'success':![],'error':_0x114429(0x9a),'details':_0x3b5dad instanceof Error?_0x3b5dad[_0x114429(0xab)]:_0x114429(0xca)});}}}function a8_0x5a26(){const _0x1c6005=['Manual\x20proof\x20upload\x20not\x20supported\x20for\x20gateway:\x20','replace','heic','Manual\x20payment\x20info\x20not\x20available\x20for\x20gateway:\x20','104028AAKlYL','createdAt','interac','163mOkGyW','payment','.\x20Supported:\x20','9854wDZnZf','message','\x20\x20\x20-\x20Status:\x20PENDING\x20->\x20PROCESSING','5914160sasYOm','round','EUR','PROCESSING','pdf',',\x20size:\x20','6680sxoSez','findUnique','PNG','JPG','üìÅ\x20File\x20type:\x20','\x20\x20\x20-\x20Gateway:\x20','amount','1101989YwASlL','shop','\x20\x20\x20-\x20File\x20type:\x20','connection','gateway','ManualPaymentController','body','3238190MlbwcR','status','11529nJMCLz','File\x20too\x20large.\x20Maximum\x20size:\x2010MB','toLowerCase','updatedAt','join','default','json','Unknown\x20error','update','toUpperCase','2816TCcOha','uploadPaymentProof','Invalid\x20base64\x20file\x20data','File\x20type\x20is\x20required','params','üì§\x20Upload\x20payment\x20proof\x20request\x20for\x20payment:\x20','\x20\x20\x20-\x20File\x20size:\x20','‚ùå\x20Payment\x20not\x20found:\x20','includes','from','SEPA\x20Bank\x20Transfer','Payment\x20not\x20found','HEIC','sepa','Please\x20complete\x20a\x20SEPA\x20bank\x20transfer\x20for\x20','unknown','üåê\x20Client\x20IP:\x20','CAD','name','Interac\x20e-Transfer','../config/database','üìã\x20Get\x20manual\x20payment\x20info:\x20','Unsupported\x20file\x20type:\x20','getManualPaymentInfo','1756770JToZyB','error','remoteAddress','PDF','manualPaymentController','split','\x20and\x20upload\x20a\x20screenshot\x20of\x20the\x20confirmation.','30qzoHmD','__esModule','Internal\x20server\x20error','File\x20data\x20is\x20required','length','‚ùå\x20Get\x20manual\x20payment\x20info\x20error:','4ptZupf','log'];a8_0x5a26=function(){return _0x1c6005;};return a8_0x5a26();}exports[a8_0x22a154(0xbf)]=ManualPaymentController,exports[a8_0x22a154(0x95)]=new ManualPaymentController();