'use strict';function a17_0x85ad(_0x4ba938,_0x15affb){_0x4ba938=_0x4ba938-0x69;const _0x57f70c=a17_0x57f7();let _0x85adf7=_0x57f70c[_0x4ba938];return _0x85adf7;}const a17_0x221b7b=a17_0x85ad;(function(_0x3cbc16,_0x56041c){const _0x5d9f2a=a17_0x85ad,_0x474871=_0x3cbc16();while(!![]){try{const _0x542b11=parseInt(_0x5d9f2a(0x8c))/0x1+parseInt(_0x5d9f2a(0xaa))/0x2+-parseInt(_0x5d9f2a(0x97))/0x3+-parseInt(_0x5d9f2a(0x76))/0x4+-parseInt(_0x5d9f2a(0x7a))/0x5*(-parseInt(_0x5d9f2a(0x7c))/0x6)+-parseInt(_0x5d9f2a(0x83))/0x7*(parseInt(_0x5d9f2a(0x9d))/0x8)+-parseInt(_0x5d9f2a(0x7f))/0x9*(-parseInt(_0x5d9f2a(0x78))/0xa);if(_0x542b11===_0x56041c)break;else _0x474871['push'](_0x474871['shift']());}catch(_0x11b8d1){_0x474871['push'](_0x474871['shift']());}}}(a17_0x57f7,0xe93e5));var __importDefault=this&&this['__importDefault']||function(_0x3b2546){return _0x3b2546&&_0x3b2546['__esModule']?_0x3b2546:{'default':_0x3b2546};};Object[a17_0x221b7b(0x85)](exports,'__esModule',{'value':!![]}),exports[a17_0x221b7b(0xb5)]=void 0x0;const telegramBotService_1=require(a17_0x221b7b(0x9f)),database_1=__importDefault(require(a17_0x221b7b(0xb4)));class TelegramController{constructor(){const _0x7bdc4c=a17_0x221b7b;this[_0x7bdc4c(0x86)]=async(_0x5d5713,_0x37797b,_0x519368)=>{const _0x5931d5=_0x7bdc4c;try{const _0x26057b=telegramBotService_1[_0x5931d5(0x70)][_0x5931d5(0x92)](),_0x3c7bf8=await database_1[_0x5931d5(0x94)]['telegramUser'][_0x5931d5(0xa6)](),_0x49afe3=await database_1[_0x5931d5(0x94)]['telegramUser'][_0x5931d5(0xa6)]({'where':{'isVerified':!![]}}),_0x44679f=await database_1[_0x5931d5(0x94)][_0x5931d5(0xa5)][_0x5931d5(0xaf)]({'by':[_0x5931d5(0xb3)],'where':{'isVerified':!![],'shopId':{'not':null}},'_count':{'shopId':!![]}});_0x37797b['json']({'success':!![],'result':{'bot':{'isActive':_0x26057b[_0x5931d5(0x82)],'username':_0x26057b['username']},'statistics':{'totalUsers':_0x3c7bf8,'verifiedUsers':_0x49afe3,'unverifiedUsers':_0x3c7bf8-_0x49afe3,'connectedShops':_0x44679f[_0x5931d5(0x72)]}}});}catch(_0x5f1654){_0x519368(_0x5f1654);}},this[_0x7bdc4c(0x69)]=async(_0x3ea3a8,_0x12b60e,_0x4cce26)=>{const _0x5899b3=_0x7bdc4c;try{const {page:page=0x1,limit:limit=0x14,verified:_0x5668ba}=_0x3ea3a8[_0x5899b3(0x6f)],_0x2dfb6b=(Number(page)-0x1)*Number(limit),_0x468d2c={};_0x5668ba!==undefined&&(_0x468d2c['isVerified']=_0x5668ba===_0x5899b3(0x93));const [_0x24aea1,_0x1dfa20]=await Promise[_0x5899b3(0x9a)]([database_1[_0x5899b3(0x94)]['telegramUser'][_0x5899b3(0xb8)]({'where':_0x468d2c,'skip':_0x2dfb6b,'take':Number(limit),'orderBy':{'createdAt':_0x5899b3(0x7d)},'include':{'shop':{'select':{'id':!![],'name':!![],'username':!![]}}}}),database_1[_0x5899b3(0x94)]['telegramUser'][_0x5899b3(0xa6)]({'where':_0x468d2c})]);_0x12b60e['json']({'success':!![],'users':_0x24aea1[_0x5899b3(0xa1)](_0x3ae45f=>({'id':_0x3ae45f['id'],'telegramId':_0x3ae45f['telegramId'],'username':_0x3ae45f[_0x5899b3(0x6c)],'firstName':_0x3ae45f[_0x5899b3(0x98)],'lastName':_0x3ae45f[_0x5899b3(0xb2)],'isVerified':_0x3ae45f[_0x5899b3(0xae)],'shop':_0x3ae45f[_0x5899b3(0xb6)],'createdAt':_0x3ae45f[_0x5899b3(0xa7)],'updatedAt':_0x3ae45f['updatedAt']})),'pagination':{'page':Number(page),'limit':Number(limit),'total':_0x1dfa20,'totalPages':Math[_0x5899b3(0x79)](_0x1dfa20/Number(limit))}});}catch(_0x367654){_0x4cce26(_0x367654);}},this[_0x7bdc4c(0x75)]=async(_0x237c43,_0x531583,_0x4386d4)=>{const _0x4e32b2=_0x7bdc4c;try{const {message:_0x1bab98,shopId:_0x28cc26}=_0x237c43[_0x4e32b2(0x81)];if(!_0x1bab98)return _0x531583[_0x4e32b2(0xb0)](0x190)[_0x4e32b2(0xb1)]({'success':![],'message':_0x4e32b2(0xac)});if(_0x28cc26)await telegramBotService_1['telegramBotService'][_0x4e32b2(0x6a)](_0x28cc26,_0x1bab98,{'parse_mode':_0x4e32b2(0x7e)});else{const _0x3c3987=await database_1[_0x4e32b2(0x94)][_0x4e32b2(0xa5)][_0x4e32b2(0xb8)]({'where':{'isVerified':!![]},'select':{'shopId':!![]}}),_0x3ae8ff=[...new Set(_0x3c3987[_0x4e32b2(0xa1)](_0x16c0d1=>_0x16c0d1['shopId'])[_0x4e32b2(0x9b)](Boolean))];for(const _0x214e32 of _0x3ae8ff){_0x214e32&&await telegramBotService_1['telegramBotService'][_0x4e32b2(0x6a)](_0x214e32,_0x1bab98,{'parse_mode':_0x4e32b2(0x7e)});}}_0x531583[_0x4e32b2(0xb1)]({'success':!![],'message':_0x4e32b2(0x90)});}catch(_0x46f9c3){_0x4386d4(_0x46f9c3);}},this[_0x7bdc4c(0x8a)]=async(_0x37dd38,_0x373614,_0x3a2606)=>{const _0x5ba9ac=_0x7bdc4c;try{const {telegramId:_0x190b86}=_0x37dd38['params'],_0x26aa69=await database_1[_0x5ba9ac(0x94)]['telegramUser']['findUnique']({'where':{'telegramId':_0x190b86},'include':{'shop':!![]}});if(!_0x26aa69)return _0x373614['status'](0x194)[_0x5ba9ac(0xb1)]({'success':![],'message':_0x5ba9ac(0xa9)});await database_1[_0x5ba9ac(0x94)]['telegramUser'][_0x5ba9ac(0x91)]({'where':{'telegramId':_0x190b86},'data':{'shopId':null,'isVerified':![]}}),_0x373614['json']({'success':!![],'message':_0x5ba9ac(0x84)});}catch(_0xe0b3b2){_0x3a2606(_0xe0b3b2);}},this[_0x7bdc4c(0x80)]=async(_0x5280f8,_0x4362d0,_0x415bf5)=>{const _0x5a4657=_0x7bdc4c;try{const {shopId:_0xa6cd40,type:type=_0x5a4657(0xab),testData:_0x9dbcfa}=_0x5280f8[_0x5a4657(0x81)];if(!_0xa6cd40)return _0x4362d0['status'](0x190)[_0x5a4657(0xb1)]({'success':![],'message':_0x5a4657(0x96)});const _0x58ec9d=await database_1['default']['shop'][_0x5a4657(0x6b)]({'where':{'id':_0xa6cd40},'select':{'id':!![],'name':!![]}});if(!_0x58ec9d)return _0x4362d0[_0x5a4657(0xb0)](0x194)[_0x5a4657(0xb1)]({'success':![],'message':_0x5a4657(0xa3)});switch(type){case _0x5a4657(0xab):const _0x4cc427={'id':_0x5a4657(0xa8),'amount':_0x9dbcfa?.[_0x5a4657(0xa0)]||0x64,'currency':_0x9dbcfa?.[_0x5a4657(0x7b)]||_0x5a4657(0x87),'productName':_0x9dbcfa?.[_0x5a4657(0x8f)]||_0x5a4657(0x77),'gateway':_0x9dbcfa?.[_0x5a4657(0xa2)]||_0x5a4657(0x9e),'createdAt':new Date(),..._0x9dbcfa};await telegramBotService_1[_0x5a4657(0x70)][_0x5a4657(0x89)](_0xa6cd40,_0x4cc427,_0x5a4657(0x71));break;case'payout':const _0x3e3b4e={'id':_0x5a4657(0x8b),'amount':_0x9dbcfa?.[_0x5a4657(0xa0)]||0x1f4,'network':_0x9dbcfa?.[_0x5a4657(0xb7)]||_0x5a4657(0x99),'wallet':_0x9dbcfa?.[_0x5a4657(0x9c)]||'TR7NHqjeKQxGTCi8q8ZY4pL8otSzgjLj6t','period':_0x5a4657(0xad),'createdAt':new Date(),'txid':_0x9dbcfa?.[_0x5a4657(0x74)]||null,..._0x9dbcfa};await telegramBotService_1[_0x5a4657(0x70)][_0x5a4657(0x8e)](_0xa6cd40,_0x3e3b4e);break;case _0x5a4657(0x6d):await telegramBotService_1['telegramBotService'][_0x5a4657(0xa4)](_0xa6cd40,_0x9dbcfa?.[_0x5a4657(0x95)]||'Test\x20Notification',_0x9dbcfa?.[_0x5a4657(0x6e)]||{'message':_0x5a4657(0x73)});break;default:return _0x4362d0['status'](0x190)[_0x5a4657(0xb1)]({'success':![],'message':_0x5a4657(0x8d)});}_0x4362d0[_0x5a4657(0xb1)]({'success':!![],'message':_0x5a4657(0x88)+type+_0x5a4657(0xb9)});}catch(_0x217e8d){_0x415bf5(_0x217e8d);}};}}function a17_0x57f7(){const _0x4b2a8e=['This\x20is\x20a\x20test\x20notification','txid','sendBroadcast','5961944aVrdgt','Test\x20Product','11645580tMwVTn','ceil','15bYLFTx','currency','1631958jvHpdE','desc','Markdown','18aVtThy','sendTestNotification','body','isActive','11677036pTowhz','User\x20disconnected\x20successfully','defineProperty','getBotStatus','USD','Test\x20','sendPaymentNotification','disconnectUser','test_payout_123','1676769xxIiaJ','Invalid\x20notification\x20type.\x20Use:\x20payment,\x20payout,\x20or\x20custom','sendPayoutNotification','productName','Broadcast\x20message\x20sent\x20successfully','update','getBotInfo','true','default','title','Shop\x20ID\x20is\x20required','4585089NJmScn','firstName','TRC20','all','filter','wallet','8fiUniP','plisio','../services/telegramBotService','amount','map','gateway','Shop\x20not\x20found','sendCustomNotification','telegramUser','count','createdAt','test_payment_123','Telegram\x20user\x20not\x20found','1640996xbvTUr','payment','Message\x20is\x20required','Тестовый\x20период','isVerified','groupBy','status','json','lastName','shopId','../config/database','TelegramController','shop','network','findMany','\x20notification\x20sent\x20successfully','getTelegramUsers','sendShopNotification','findUnique','username','custom','details','query','telegramBotService','paid','length'];a17_0x57f7=function(){return _0x4b2a8e;};return a17_0x57f7();}exports['TelegramController']=TelegramController;