'use strict';const a12_0x2192e7=a12_0x4273;(function(_0x540032,_0x51713f){const _0x461e8f=a12_0x4273,_0x3a4f55=_0x540032();while(!![]){try{const _0x48d822=parseInt(_0x461e8f(0x15e))/0x1*(-parseInt(_0x461e8f(0x17b))/0x2)+-parseInt(_0x461e8f(0x154))/0x3+parseInt(_0x461e8f(0x145))/0x4*(parseInt(_0x461e8f(0x16a))/0x5)+parseInt(_0x461e8f(0x150))/0x6+parseInt(_0x461e8f(0x159))/0x7+-parseInt(_0x461e8f(0x141))/0x8+-parseInt(_0x461e8f(0x13a))/0x9;if(_0x48d822===_0x51713f)break;else _0x3a4f55['push'](_0x3a4f55['shift']());}catch(_0xdcc821){_0x3a4f55['push'](_0x3a4f55['shift']());}}}(a12_0x18f4,0x82ddc));function a12_0x4273(_0x4e7d77,_0x574e91){const _0x18f40f=a12_0x18f4();return a12_0x4273=function(_0x427312,_0x244dad){_0x427312=_0x427312-0x138;let _0x3bada8=_0x18f40f[_0x427312];return _0x3bada8;},a12_0x4273(_0x4e7d77,_0x574e91);}var __importDefault=this&&this['__importDefault']||function(_0x263910){const _0x343798=a12_0x4273;return _0x263910&&_0x263910[_0x343798(0x16f)]?_0x263910:{'default':_0x263910};};Object[a12_0x2192e7(0x138)](exports,a12_0x2192e7(0x16f),{'value':!![]}),exports[a12_0x2192e7(0x173)]=void 0x0;const telegramBotService_1=require(a12_0x2192e7(0x147)),database_1=__importDefault(require(a12_0x2192e7(0x152)));class TelegramController{constructor(){const _0x15c81b=a12_0x2192e7;this[_0x15c81b(0x155)]=async(_0x2aa376,_0x1bf70b,_0x17098a)=>{const _0x216fc6=_0x15c81b;try{const _0x323ac8=telegramBotService_1[_0x216fc6(0x157)][_0x216fc6(0x179)](),_0x4223ca=await database_1['default'][_0x216fc6(0x168)][_0x216fc6(0x156)](),_0xfa5ef7=await database_1[_0x216fc6(0x14f)]['telegramUser'][_0x216fc6(0x156)]({'where':{'isVerified':!![]}}),_0x543e36=await database_1[_0x216fc6(0x14f)][_0x216fc6(0x168)][_0x216fc6(0x16e)]({'by':['shopId'],'where':{'isVerified':!![],'shopId':{'not':null}},'_count':{'shopId':!![]}});_0x1bf70b['json']({'success':!![],'result':{'bot':{'isActive':_0x323ac8[_0x216fc6(0x143)],'username':_0x323ac8[_0x216fc6(0x165)]},'statistics':{'totalUsers':_0x4223ca,'verifiedUsers':_0xfa5ef7,'unverifiedUsers':_0x4223ca-_0xfa5ef7,'connectedShops':_0x543e36['length']}}});}catch(_0x170e71){_0x17098a(_0x170e71);}},this[_0x15c81b(0x15d)]=async(_0xf11a7d,_0x4c4fd9,_0x2a2741)=>{const _0x5e453a=_0x15c81b;try{const {page:page=0x1,limit:limit=0x14,verified:_0x4759f6}=_0xf11a7d['query'],_0x233dcc=(Number(page)-0x1)*Number(limit),_0xc88a9b={};_0x4759f6!==undefined&&(_0xc88a9b[_0x5e453a(0x164)]=_0x4759f6==='true');const [_0x4dde79,_0x48a4a8]=await Promise[_0x5e453a(0x15c)]([database_1[_0x5e453a(0x14f)][_0x5e453a(0x168)][_0x5e453a(0x160)]({'where':_0xc88a9b,'skip':_0x233dcc,'take':Number(limit),'orderBy':{'createdAt':_0x5e453a(0x17f)},'include':{'shop':{'select':{'id':!![],'name':!![],'username':!![]}}}}),database_1['default'][_0x5e453a(0x168)][_0x5e453a(0x156)]({'where':_0xc88a9b})]);_0x4c4fd9[_0x5e453a(0x174)]({'success':!![],'users':_0x4dde79['map'](_0x32801c=>({'id':_0x32801c['id'],'telegramId':_0x32801c[_0x5e453a(0x146)],'username':_0x32801c[_0x5e453a(0x165)],'firstName':_0x32801c[_0x5e453a(0x17e)],'lastName':_0x32801c[_0x5e453a(0x14e)],'isVerified':_0x32801c[_0x5e453a(0x164)],'shop':_0x32801c[_0x5e453a(0x151)],'createdAt':_0x32801c[_0x5e453a(0x16b)],'updatedAt':_0x32801c[_0x5e453a(0x13e)]})),'pagination':{'page':Number(page),'limit':Number(limit),'total':_0x48a4a8,'totalPages':Math['ceil'](_0x48a4a8/Number(limit))}});}catch(_0x105533){_0x2a2741(_0x105533);}},this[_0x15c81b(0x167)]=async(_0x2443bc,_0x1453e3,_0x3e6313)=>{const _0x1f12af=_0x15c81b;try{const {message:_0x32bb10,shopId:_0x3c6bf1}=_0x2443bc['body'];if(!_0x32bb10)return _0x1453e3['status'](0x190)[_0x1f12af(0x174)]({'success':![],'message':_0x1f12af(0x170)});if(_0x3c6bf1)await telegramBotService_1[_0x1f12af(0x157)][_0x1f12af(0x158)](_0x3c6bf1,_0x32bb10,{'parse_mode':_0x1f12af(0x15a)});else{const _0x490e32=await database_1[_0x1f12af(0x14f)][_0x1f12af(0x168)][_0x1f12af(0x160)]({'where':{'isVerified':!![]},'select':{'shopId':!![]}}),_0xd0205d=[...new Set(_0x490e32['map'](_0x3275ff=>_0x3275ff['shopId'])[_0x1f12af(0x16c)](Boolean))];for(const _0x3c6e82 of _0xd0205d){_0x3c6e82&&await telegramBotService_1[_0x1f12af(0x157)][_0x1f12af(0x158)](_0x3c6e82,_0x32bb10,{'parse_mode':'Markdown'});}}_0x1453e3[_0x1f12af(0x174)]({'success':!![],'message':'Broadcast\x20message\x20sent\x20successfully'});}catch(_0xb8e097){_0x3e6313(_0xb8e097);}},this[_0x15c81b(0x148)]=async(_0x49e81d,_0x11bb41,_0x21113f)=>{const _0x1f3a50=_0x15c81b;try{const {telegramId:_0x204d93}=_0x49e81d['params'],_0x21e0af=await database_1[_0x1f3a50(0x14f)][_0x1f3a50(0x168)][_0x1f3a50(0x169)]({'where':{'telegramId':_0x204d93},'include':{'shop':!![]}});if(!_0x21e0af)return _0x11bb41[_0x1f3a50(0x13c)](0x194)['json']({'success':![],'message':_0x1f3a50(0x14c)});await database_1[_0x1f3a50(0x14f)][_0x1f3a50(0x168)][_0x1f3a50(0x17c)]({'where':{'telegramId':_0x204d93},'data':{'shopId':null,'isVerified':![]}}),_0x11bb41[_0x1f3a50(0x174)]({'success':!![],'message':_0x1f3a50(0x162)});}catch(_0x2afe88){_0x21113f(_0x2afe88);}},this[_0x15c81b(0x176)]=async(_0x11d7d3,_0x3d038b,_0xdd777)=>{const _0x4379c8=_0x15c81b;try{const {shopId:_0x2731f1,type:type=_0x4379c8(0x15b),testData:_0xd57449}=_0x11d7d3['body'];if(!_0x2731f1)return _0x3d038b['status'](0x190)['json']({'success':![],'message':_0x4379c8(0x177)});const _0x1095ff=await database_1[_0x4379c8(0x14f)][_0x4379c8(0x151)][_0x4379c8(0x169)]({'where':{'id':_0x2731f1},'select':{'id':!![],'name':!![]}});if(!_0x1095ff)return _0x3d038b['status'](0x194)[_0x4379c8(0x174)]({'success':![],'message':_0x4379c8(0x142)});switch(type){case _0x4379c8(0x15b):const _0x507468={'id':_0x4379c8(0x172),'amount':_0xd57449?.[_0x4379c8(0x144)]||0x64,'currency':_0xd57449?.['currency']||_0x4379c8(0x14b),'productName':_0xd57449?.[_0x4379c8(0x149)]||_0x4379c8(0x161),'gateway':_0xd57449?.[_0x4379c8(0x17d)]||_0x4379c8(0x15f),'createdAt':new Date(),..._0xd57449};await telegramBotService_1[_0x4379c8(0x157)][_0x4379c8(0x140)](_0x2731f1,_0x507468,_0x4379c8(0x171));break;case _0x4379c8(0x14d):const _0xf9b3e={'id':_0x4379c8(0x13d),'amount':_0xd57449?.[_0x4379c8(0x144)]||0x1f4,'method':_0xd57449?.[_0x4379c8(0x13b)]||_0x4379c8(0x175),'createdAt':new Date(),..._0xd57449};await telegramBotService_1[_0x4379c8(0x157)]['sendPayoutNotification'](_0x2731f1,_0xf9b3e,_0x4379c8(0x17a));break;case _0x4379c8(0x13f):await telegramBotService_1[_0x4379c8(0x157)][_0x4379c8(0x163)](_0x2731f1,_0xd57449?.['title']||_0x4379c8(0x153),_0xd57449?.[_0x4379c8(0x166)]||{'message':_0x4379c8(0x16d)});break;default:return _0x3d038b[_0x4379c8(0x13c)](0x190)[_0x4379c8(0x174)]({'success':![],'message':_0x4379c8(0x139)});}_0x3d038b[_0x4379c8(0x174)]({'success':!![],'message':_0x4379c8(0x178)+type+_0x4379c8(0x14a)});}catch(_0x579de2){_0xdd777(_0x579de2);}};}}exports[a12_0x2192e7(0x173)]=TelegramController;function a12_0x18f4(){const _0xcee6c5=['57644BzestQ','telegramId','../services/telegramBotService','disconnectUser','productName','\x20notification\x20sent\x20successfully','USD','Telegram\x20user\x20not\x20found','payout','lastName','default','4489278FzVZvL','shop','../config/database','Test\x20Notification','1924458QJRPlW','getBotStatus','count','telegramBotService','sendShopNotification','6381249UDYYyx','Markdown','payment','all','getTelegramUsers','127irkPay','plisio','findMany','Test\x20Product','User\x20disconnected\x20successfully','sendCustomNotification','isVerified','username','details','sendBroadcast','telegramUser','findUnique','340IUJFKO','createdAt','filter','This\x20is\x20a\x20test\x20notification','groupBy','__esModule','Message\x20is\x20required','paid','test_payment_123','TelegramController','json','bank_transfer','sendTestNotification','Shop\x20ID\x20is\x20required','Test\x20','getBotInfo','completed','9266SmAnGh','update','gateway','firstName','desc','defineProperty','Invalid\x20notification\x20type.\x20Use:\x20payment,\x20payout,\x20or\x20custom','1453032TikNvl','method','status','test_payout_123','updatedAt','custom','sendPaymentNotification','5699320tyZgAe','Shop\x20not\x20found','isActive','amount'];a12_0x18f4=function(){return _0xcee6c5;};return a12_0x18f4();}