'use strict';const a12_0x32dbde=a12_0x49d0;(function(_0x301aa8,_0x27b0be){const _0x3c5823=a12_0x49d0,_0x4dc5c8=_0x301aa8();while(!![]){try{const _0x3c5615=-parseInt(_0x3c5823(0x1ce))/0x1*(parseInt(_0x3c5823(0x18e))/0x2)+-parseInt(_0x3c5823(0x1a4))/0x3+parseInt(_0x3c5823(0x1b7))/0x4*(parseInt(_0x3c5823(0x1c7))/0x5)+-parseInt(_0x3c5823(0x1cb))/0x6+parseInt(_0x3c5823(0x1ad))/0x7*(-parseInt(_0x3c5823(0x1ba))/0x8)+parseInt(_0x3c5823(0x1b0))/0x9+parseInt(_0x3c5823(0x197))/0xa*(parseInt(_0x3c5823(0x1b5))/0xb);if(_0x3c5615===_0x27b0be)break;else _0x4dc5c8['push'](_0x4dc5c8['shift']());}catch(_0x22f52a){_0x4dc5c8['push'](_0x4dc5c8['shift']());}}}(a12_0xbe10,0x53405));function a12_0xbe10(){const _0x4ca3f8=['telegramBotService','status','2654AFIWrZ','currency','bank_transfer','shop','firstName','sendTestNotification','User\x20disconnected\x20successfully','getBotStatus','ceil','10mYlUqU','Markdown','sendCustomNotification','desc','Telegram\x20user\x20not\x20found','findUnique','TelegramController','params','sendPayoutNotification','shopId','updatedAt','telegramUser','findMany','774477mUqyZO','Shop\x20not\x20found','sendBroadcast','Broadcast\x20message\x20sent\x20successfully','payout','payment','default','json','username','14whmnpJ','../services/telegramBotService','update','944829XoVotN','true','details','getBotInfo','isVerified','7450036obLUYE','Message\x20is\x20required','225352IipTOP','getTelegramUsers','count','862584kJYybe','query','This\x20is\x20a\x20test\x20notification','__importDefault','productName','method','plisio','telegramId','body','Test\x20Notification','../config/database','amount','sendPaymentNotification','55xKXjsx','__esModule','lastName','all','1803246VROMsF','length','sendShopNotification','216NGqzBw','isActive','groupBy','Shop\x20ID\x20is\x20required','disconnectUser','paid','custom','\x20notification\x20sent\x20successfully','Invalid\x20notification\x20type.\x20Use:\x20payment,\x20payout,\x20or\x20custom','completed'];a12_0xbe10=function(){return _0x4ca3f8;};return a12_0xbe10();}function a12_0x49d0(_0x5273c2,_0x2d1348){const _0xbe1067=a12_0xbe10();return a12_0x49d0=function(_0x49d019,_0x236241){_0x49d019=_0x49d019-0x188;let _0x2c6d5b=_0xbe1067[_0x49d019];return _0x2c6d5b;},a12_0x49d0(_0x5273c2,_0x2d1348);}var __importDefault=this&&this[a12_0x32dbde(0x1bd)]||function(_0x112be5){const _0x58721d=a12_0x32dbde;return _0x112be5&&_0x112be5[_0x58721d(0x1c8)]?_0x112be5:{'default':_0x112be5};};Object['defineProperty'](exports,'__esModule',{'value':!![]}),exports[a12_0x32dbde(0x19d)]=void 0x0;const telegramBotService_1=require(a12_0x32dbde(0x1ae)),database_1=__importDefault(require(a12_0x32dbde(0x1c4)));class TelegramController{constructor(){const _0x2cab55=a12_0x32dbde;this[_0x2cab55(0x195)]=async(_0x471c0c,_0x2d8314,_0x57e232)=>{const _0x23b46b=_0x2cab55;try{const _0x4d3db2=telegramBotService_1[_0x23b46b(0x18c)][_0x23b46b(0x1b3)](),_0x3f574f=await database_1[_0x23b46b(0x1aa)][_0x23b46b(0x1a2)]['count'](),_0x1cfb27=await database_1[_0x23b46b(0x1aa)][_0x23b46b(0x1a2)]['count']({'where':{'isVerified':!![]}}),_0x74ec3d=await database_1[_0x23b46b(0x1aa)]['telegramUser'][_0x23b46b(0x1d0)]({'by':[_0x23b46b(0x1a0)],'where':{'isVerified':!![],'shopId':{'not':null}},'_count':{'shopId':!![]}});_0x2d8314[_0x23b46b(0x1ab)]({'success':!![],'result':{'bot':{'isActive':_0x4d3db2[_0x23b46b(0x1cf)],'username':_0x4d3db2['username']},'statistics':{'totalUsers':_0x3f574f,'verifiedUsers':_0x1cfb27,'unverifiedUsers':_0x3f574f-_0x1cfb27,'connectedShops':_0x74ec3d[_0x23b46b(0x1cc)]}}});}catch(_0x4e1f6c){_0x57e232(_0x4e1f6c);}},this[_0x2cab55(0x1b8)]=async(_0x5e3473,_0x1fba6d,_0x130ee6)=>{const _0x350642=_0x2cab55;try{const {page:page=0x1,limit:limit=0x14,verified:_0x189b75}=_0x5e3473[_0x350642(0x1bb)],_0x28a5b2=(Number(page)-0x1)*Number(limit),_0x47c894={};_0x189b75!==undefined&&(_0x47c894[_0x350642(0x1b4)]=_0x189b75===_0x350642(0x1b1));const [_0x54b332,_0x1b4181]=await Promise[_0x350642(0x1ca)]([database_1['default'][_0x350642(0x1a2)][_0x350642(0x1a3)]({'where':_0x47c894,'skip':_0x28a5b2,'take':Number(limit),'orderBy':{'createdAt':_0x350642(0x19a)},'include':{'shop':{'select':{'id':!![],'name':!![],'username':!![]}}}}),database_1[_0x350642(0x1aa)]['telegramUser'][_0x350642(0x1b9)]({'where':_0x47c894})]);_0x1fba6d['json']({'success':!![],'users':_0x54b332['map'](_0x122928=>({'id':_0x122928['id'],'telegramId':_0x122928[_0x350642(0x1c1)],'username':_0x122928[_0x350642(0x1ac)],'firstName':_0x122928[_0x350642(0x192)],'lastName':_0x122928[_0x350642(0x1c9)],'isVerified':_0x122928[_0x350642(0x1b4)],'shop':_0x122928[_0x350642(0x191)],'createdAt':_0x122928['createdAt'],'updatedAt':_0x122928[_0x350642(0x1a1)]})),'pagination':{'page':Number(page),'limit':Number(limit),'total':_0x1b4181,'totalPages':Math[_0x350642(0x196)](_0x1b4181/Number(limit))}});}catch(_0x186861){_0x130ee6(_0x186861);}},this[_0x2cab55(0x1a6)]=async(_0x4b4a09,_0x2f9ee7,_0x46377f)=>{const _0x16f2f5=_0x2cab55;try{const {message:_0x4c6af7,shopId:_0x389527}=_0x4b4a09[_0x16f2f5(0x1c2)];if(!_0x4c6af7)return _0x2f9ee7[_0x16f2f5(0x18d)](0x190)[_0x16f2f5(0x1ab)]({'success':![],'message':_0x16f2f5(0x1b6)});if(_0x389527)await telegramBotService_1[_0x16f2f5(0x18c)][_0x16f2f5(0x1cd)](_0x389527,_0x4c6af7,{'parse_mode':_0x16f2f5(0x198)});else{const _0x2e6618=await database_1['default'][_0x16f2f5(0x1a2)][_0x16f2f5(0x1a3)]({'where':{'isVerified':!![]},'select':{'shopId':!![]}}),_0x1882ef=[...new Set(_0x2e6618['map'](_0x2321e0=>_0x2321e0[_0x16f2f5(0x1a0)])['filter'](Boolean))];for(const _0x5ba2b7 of _0x1882ef){_0x5ba2b7&&await telegramBotService_1[_0x16f2f5(0x18c)][_0x16f2f5(0x1cd)](_0x5ba2b7,_0x4c6af7,{'parse_mode':_0x16f2f5(0x198)});}}_0x2f9ee7[_0x16f2f5(0x1ab)]({'success':!![],'message':_0x16f2f5(0x1a7)});}catch(_0x84ff07){_0x46377f(_0x84ff07);}},this[_0x2cab55(0x1d2)]=async(_0x3f8002,_0x2ec75b,_0x2ee886)=>{const _0x2a38ee=_0x2cab55;try{const {telegramId:_0x5adea6}=_0x3f8002[_0x2a38ee(0x19e)],_0x350d97=await database_1[_0x2a38ee(0x1aa)][_0x2a38ee(0x1a2)]['findUnique']({'where':{'telegramId':_0x5adea6},'include':{'shop':!![]}});if(!_0x350d97)return _0x2ec75b['status'](0x194)[_0x2a38ee(0x1ab)]({'success':![],'message':_0x2a38ee(0x19b)});await database_1[_0x2a38ee(0x1aa)]['telegramUser'][_0x2a38ee(0x1af)]({'where':{'telegramId':_0x5adea6},'data':{'shopId':null,'isVerified':![]}}),_0x2ec75b[_0x2a38ee(0x1ab)]({'success':!![],'message':_0x2a38ee(0x194)});}catch(_0xf71e59){_0x2ee886(_0xf71e59);}},this[_0x2cab55(0x193)]=async(_0x3f8b50,_0x35dd0d,_0x13a310)=>{const _0x5a83b0=_0x2cab55;try{const {shopId:_0x5e37d3,type:type='payment',testData:_0x1121e3}=_0x3f8b50[_0x5a83b0(0x1c2)];if(!_0x5e37d3)return _0x35dd0d['status'](0x190)[_0x5a83b0(0x1ab)]({'success':![],'message':_0x5a83b0(0x1d1)});const _0x4d87c8=await database_1[_0x5a83b0(0x1aa)]['shop'][_0x5a83b0(0x19c)]({'where':{'id':_0x5e37d3},'select':{'id':!![],'name':!![]}});if(!_0x4d87c8)return _0x35dd0d['status'](0x194)[_0x5a83b0(0x1ab)]({'success':![],'message':_0x5a83b0(0x1a5)});switch(type){case _0x5a83b0(0x1a9):const _0x3a4600={'id':'test_payment_123','amount':_0x1121e3?.[_0x5a83b0(0x1c5)]||0x64,'currency':_0x1121e3?.[_0x5a83b0(0x18f)]||'USD','productName':_0x1121e3?.[_0x5a83b0(0x1be)]||'Test\x20Product','gateway':_0x1121e3?.['gateway']||_0x5a83b0(0x1c0),'createdAt':new Date(),..._0x1121e3};await telegramBotService_1[_0x5a83b0(0x18c)][_0x5a83b0(0x1c6)](_0x5e37d3,_0x3a4600,_0x5a83b0(0x1d3));break;case _0x5a83b0(0x1a8):const _0x99a04b={'id':'test_payout_123','amount':_0x1121e3?.[_0x5a83b0(0x1c5)]||0x1f4,'method':_0x1121e3?.[_0x5a83b0(0x1bf)]||_0x5a83b0(0x190),'createdAt':new Date(),..._0x1121e3};await telegramBotService_1[_0x5a83b0(0x18c)][_0x5a83b0(0x19f)](_0x5e37d3,_0x99a04b,_0x5a83b0(0x18b));break;case _0x5a83b0(0x188):await telegramBotService_1[_0x5a83b0(0x18c)][_0x5a83b0(0x199)](_0x5e37d3,_0x1121e3?.['title']||_0x5a83b0(0x1c3),_0x1121e3?.[_0x5a83b0(0x1b2)]||{'message':_0x5a83b0(0x1bc)});break;default:return _0x35dd0d[_0x5a83b0(0x18d)](0x190)[_0x5a83b0(0x1ab)]({'success':![],'message':_0x5a83b0(0x18a)});}_0x35dd0d[_0x5a83b0(0x1ab)]({'success':!![],'message':'Test\x20'+type+_0x5a83b0(0x189)});}catch(_0xaed6b9){_0x13a310(_0xaed6b9);}};}}exports[a12_0x32dbde(0x19d)]=TelegramController;