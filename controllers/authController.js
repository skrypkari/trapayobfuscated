'use strict';const a4_0xc1aa1=a4_0x53ac;(function(_0x2d8c4b,_0x10d291){const _0x4abcda=a4_0x53ac,_0x57bc53=_0x2d8c4b();while(!![]){try{const _0x20cee2=-parseInt(_0x4abcda(0x1ae))/0x1*(parseInt(_0x4abcda(0x1af))/0x2)+parseInt(_0x4abcda(0x1b4))/0x3*(parseInt(_0x4abcda(0x19d))/0x4)+parseInt(_0x4abcda(0x1aa))/0x5+parseInt(_0x4abcda(0x1bb))/0x6+-parseInt(_0x4abcda(0x1a7))/0x7+parseInt(_0x4abcda(0x1b3))/0x8*(-parseInt(_0x4abcda(0x1a9))/0x9)+-parseInt(_0x4abcda(0x1c1))/0xa;if(_0x20cee2===_0x10d291)break;else _0x57bc53['push'](_0x57bc53['shift']());}catch(_0x546def){_0x57bc53['push'](_0x57bc53['shift']());}}}(a4_0x3be2,0x785a2));var __createBinding=this&&this['__createBinding']||(Object[a4_0xc1aa1(0x1c7)]?function(_0x1584ed,_0x31a089,_0x4b9f86,_0x30a973){const _0x1f69d7=a4_0xc1aa1;if(_0x30a973===undefined)_0x30a973=_0x4b9f86;var _0x8581e4=Object[_0x1f69d7(0x1c9)](_0x31a089,_0x4b9f86);(!_0x8581e4||(_0x1f69d7(0x1a5)in _0x8581e4?!_0x31a089['__esModule']:_0x8581e4[_0x1f69d7(0x19b)]||_0x8581e4[_0x1f69d7(0x199)]))&&(_0x8581e4={'enumerable':!![],'get':function(){return _0x31a089[_0x4b9f86];}}),Object[_0x1f69d7(0x1a4)](_0x1584ed,_0x30a973,_0x8581e4);}:function(_0x2f0eb3,_0x3456d9,_0x3cb68d,_0xfe86bd){if(_0xfe86bd===undefined)_0xfe86bd=_0x3cb68d;_0x2f0eb3[_0xfe86bd]=_0x3456d9[_0x3cb68d];}),__setModuleDefault=this&&this[a4_0xc1aa1(0x1a0)]||(Object['create']?function(_0x31bcf5,_0x5733b2){const _0x2e35fc=a4_0xc1aa1;Object[_0x2e35fc(0x1a4)](_0x31bcf5,'default',{'enumerable':!![],'value':_0x5733b2});}:function(_0x103277,_0x2353ae){const _0x1324d6=a4_0xc1aa1;_0x103277[_0x1324d6(0x1b5)]=_0x2353ae;}),__importStar=this&&this[a4_0xc1aa1(0x1b2)]||(function(){var _0x491c18=function(_0x31dc7d){const _0x4474df=a4_0x53ac;return _0x491c18=Object[_0x4474df(0x19a)]||function(_0x543e03){const _0x1ce712=_0x4474df;var _0x55fb25=[];for(var _0x816812 in _0x543e03)if(Object[_0x1ce712(0x19f)][_0x1ce712(0x1c8)][_0x1ce712(0x1b9)](_0x543e03,_0x816812))_0x55fb25[_0x55fb25[_0x1ce712(0x1b0)]]=_0x816812;return _0x55fb25;},_0x491c18(_0x31dc7d);};return function(_0x2076e3){const _0x5b97a2=a4_0x53ac;if(_0x2076e3&&_0x2076e3[_0x5b97a2(0x1b7)])return _0x2076e3;var _0x2cb782={};if(_0x2076e3!=null){for(var _0x1f3e5f=_0x491c18(_0x2076e3),_0x57107a=0x0;_0x57107a<_0x1f3e5f[_0x5b97a2(0x1b0)];_0x57107a++)if(_0x1f3e5f[_0x57107a]!=='default')__createBinding(_0x2cb782,_0x2076e3,_0x1f3e5f[_0x57107a]);}return __setModuleDefault(_0x2cb782,_0x2076e3),_0x2cb782;};}());function a4_0x53ac(_0x344b73,_0x2c7df9){const _0x3be20a=a4_0x3be2();return a4_0x53ac=function(_0x53ac52,_0x307cc1){_0x53ac52=_0x53ac52-0x199;let _0x4d70cc=_0x3be20a[_0x53ac52];return _0x4d70cc;},a4_0x53ac(_0x344b73,_0x2c7df9);}Object[a4_0xc1aa1(0x1a4)](exports,'__esModule',{'value':!![]}),exports[a4_0xc1aa1(0x1bf)]=void 0x0;const authService_1=require(a4_0xc1aa1(0x1b1)),tokenBlacklistService_1=require(a4_0xc1aa1(0x1a8)),telegramBotService_1=require('../services/telegramBotService');function a4_0x3be2(){const _0x1cd26d=['user','defineProperty','get','authService','1803102GZzMMZ','../services/tokenBlacklistService','9NSXOsO','2229760CXxEPt','blacklistToken','../config/database','getBlacklistStats','130549xKtJqj','6rsminc','length','../services/authService','__importStar','7471848ddohqH','926103tLAPZB','default','Failed\x20to\x20send\x20failed\x20login\x20notification:','__esModule','User-Agent','call','logout','5102142jAeBdu','exp','getStats','findUnique','AuthController','username','1462360YDKpkI','tokenBlacklistService','Logged\x20out\x20successfully','body','json','role','create','hasOwnProperty','getOwnPropertyDescriptor','remoteAddress','configurable','getOwnPropertyNames','writable','sendLoginNotification','12HPmNlP','resolve','prototype','__setModuleDefault','then','shop'];a4_0x3be2=function(){return _0x1cd26d;};return a4_0x3be2();}class AuthController{constructor(){const _0x5bf127=a4_0xc1aa1;this['login']=async(_0x3596b4,_0x1337a6,_0x493bb7)=>{const _0x5e0afb=a4_0x53ac;try{const _0x51555f=_0x3596b4[_0x5e0afb(0x1c4)],_0x5751f6=_0x3596b4['ip']||_0x3596b4['connection'][_0x5e0afb(0x1ca)]||'unknown',_0x27882c=_0x3596b4['get'](_0x5e0afb(0x1b8))||'unknown';let _0x937564=![],_0x2ca8a0=null;try{const _0x2ab3f3=await this[_0x5e0afb(0x1a6)]['login'](_0x51555f);_0x937564=!![],_0x2ab3f3[_0x5e0afb(0x1c6)]===_0x5e0afb(0x1a2)&&_0x2ab3f3['user']?.['id']&&(_0x2ca8a0=_0x2ab3f3[_0x5e0afb(0x1a3)]['id']),_0x2ca8a0&&await telegramBotService_1['telegramBotService'][_0x5e0afb(0x19c)](_0x2ca8a0,{'username':_0x51555f[_0x5e0afb(0x1c0)],'ipAddress':_0x5751f6,'userAgent':_0x27882c,'timestamp':new Date(),'success':!![]}),_0x1337a6[_0x5e0afb(0x1c5)]({'success':!![],'result':_0x2ab3f3});}catch(_0x47a97f){try{const _0x7af69c=(await Promise[_0x5e0afb(0x19e)]()[_0x5e0afb(0x1a1)](()=>__importStar(require(_0x5e0afb(0x1ac)))))['default'],_0x37940f=await _0x7af69c[_0x5e0afb(0x1a2)][_0x5e0afb(0x1be)]({'where':{'username':_0x51555f[_0x5e0afb(0x1c0)]},'select':{'id':!![]}});_0x37940f&&await telegramBotService_1['telegramBotService'][_0x5e0afb(0x19c)](_0x37940f['id'],{'username':_0x51555f[_0x5e0afb(0x1c0)],'ipAddress':_0x5751f6,'userAgent':_0x27882c,'timestamp':new Date(),'success':![]});}catch(_0x59feed){console['error'](_0x5e0afb(0x1b6),_0x59feed);}throw _0x47a97f;}}catch(_0x342a0a){_0x493bb7(_0x342a0a);}},this['me']=async(_0x54abc0,_0x5290ad,_0x1202ee)=>{const _0xd38165=a4_0x53ac;try{const _0x5e9b0b=_0x54abc0[_0xd38165(0x1a3)];_0x5290ad[_0xd38165(0x1c5)]({'success':!![],'result':{'id':_0x5e9b0b?.['id'],'username':_0x5e9b0b?.[_0xd38165(0x1c0)],'role':_0x5e9b0b?.[_0xd38165(0x1c6)]}});}catch(_0x2d298a){_0x1202ee(_0x2d298a);}},this[_0x5bf127(0x1ba)]=async(_0x23f4ee,_0x589b08,_0xd908d0)=>{const _0x34f079=_0x5bf127;try{const _0x4f4e50=_0x23f4ee['token'],_0x3b0682=_0x23f4ee[_0x34f079(0x1a3)];_0x4f4e50&&_0x3b0682?.[_0x34f079(0x1bc)]&&tokenBlacklistService_1['tokenBlacklistService'][_0x34f079(0x1ab)](_0x4f4e50,_0x3b0682[_0x34f079(0x1bc)]),_0x589b08[_0x34f079(0x1c5)]({'success':!![],'message':_0x34f079(0x1c3)});}catch(_0x5b2d53){_0xd908d0(_0x5b2d53);}},this[_0x5bf127(0x1ad)]=async(_0x418991,_0x205eec,_0x3bcd77)=>{const _0x4ea428=_0x5bf127;try{const _0xb5496c=tokenBlacklistService_1[_0x4ea428(0x1c2)][_0x4ea428(0x1bd)]();_0x205eec[_0x4ea428(0x1c5)]({'success':!![],'result':_0xb5496c});}catch(_0x420ec2){_0x3bcd77(_0x420ec2);}},this['authService']=new authService_1['AuthService']();}}exports['AuthController']=AuthController;