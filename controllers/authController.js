'use strict';const a4_0x333f31=a4_0x2c1b;(function(_0x4d5c1e,_0x416175){const _0x57879c=a4_0x2c1b,_0x4879c9=_0x4d5c1e();while(!![]){try{const _0x3fecf8=-parseInt(_0x57879c(0x150))/0x1*(parseInt(_0x57879c(0x165))/0x2)+-parseInt(_0x57879c(0x135))/0x3+-parseInt(_0x57879c(0x149))/0x4+-parseInt(_0x57879c(0x147))/0x5*(parseInt(_0x57879c(0x151))/0x6)+parseInt(_0x57879c(0x140))/0x7*(-parseInt(_0x57879c(0x14d))/0x8)+parseInt(_0x57879c(0x153))/0x9*(parseInt(_0x57879c(0x14e))/0xa)+parseInt(_0x57879c(0x137))/0xb;if(_0x3fecf8===_0x416175)break;else _0x4879c9['push'](_0x4879c9['shift']());}catch(_0x3cb7f0){_0x4879c9['push'](_0x4879c9['shift']());}}}(a4_0xa808,0x678de));var __createBinding=this&&this[a4_0x333f31(0x15b)]||(Object[a4_0x333f31(0x157)]?function(_0x233878,_0x3891c9,_0x53ac1f,_0x1e0753){const _0x2c62f7=a4_0x333f31;if(_0x1e0753===undefined)_0x1e0753=_0x53ac1f;var _0x2d0ea5=Object['getOwnPropertyDescriptor'](_0x3891c9,_0x53ac1f);(!_0x2d0ea5||(_0x2c62f7(0x146)in _0x2d0ea5?!_0x3891c9[_0x2c62f7(0x141)]:_0x2d0ea5['writable']||_0x2d0ea5[_0x2c62f7(0x14b)]))&&(_0x2d0ea5={'enumerable':!![],'get':function(){return _0x3891c9[_0x53ac1f];}}),Object[_0x2c62f7(0x160)](_0x233878,_0x1e0753,_0x2d0ea5);}:function(_0x193409,_0x557129,_0x2ff860,_0x22f04a){if(_0x22f04a===undefined)_0x22f04a=_0x2ff860;_0x193409[_0x22f04a]=_0x557129[_0x2ff860];}),__setModuleDefault=this&&this['__setModuleDefault']||(Object['create']?function(_0x179770,_0x3ec9d3){const _0x4af88f=a4_0x333f31;Object[_0x4af88f(0x160)](_0x179770,_0x4af88f(0x161),{'enumerable':!![],'value':_0x3ec9d3});}:function(_0x31e4bc,_0x5b3e0f){const _0x4ebe7f=a4_0x333f31;_0x31e4bc[_0x4ebe7f(0x161)]=_0x5b3e0f;}),__importStar=this&&this['__importStar']||(function(){var _0x3dc552=function(_0x5c01d9){const _0x1bf98a=a4_0x2c1b;return _0x3dc552=Object[_0x1bf98a(0x154)]||function(_0x2683e2){const _0x87bc46=_0x1bf98a;var _0x48ca46=[];for(var _0x31fcb7 in _0x2683e2)if(Object[_0x87bc46(0x15f)][_0x87bc46(0x158)]['call'](_0x2683e2,_0x31fcb7))_0x48ca46[_0x48ca46['length']]=_0x31fcb7;return _0x48ca46;},_0x3dc552(_0x5c01d9);};return function(_0x3b4a3a){const _0x4584cb=a4_0x2c1b;if(_0x3b4a3a&&_0x3b4a3a['__esModule'])return _0x3b4a3a;var _0x22f7d3={};if(_0x3b4a3a!=null){for(var _0xb096e=_0x3dc552(_0x3b4a3a),_0x34d9d4=0x0;_0x34d9d4<_0xb096e[_0x4584cb(0x14a)];_0x34d9d4++)if(_0xb096e[_0x34d9d4]!==_0x4584cb(0x161))__createBinding(_0x22f7d3,_0x3b4a3a,_0xb096e[_0x34d9d4]);}return __setModuleDefault(_0x22f7d3,_0x3b4a3a),_0x22f7d3;};}());function a4_0xa808(){const _0x59ac23=['getStats','1174552TIpBHE','6175480BsGqoX','User-Agent','14fengrw','233154sjiKYM','sendLoginNotification','9LsvGYJ','getOwnPropertyNames','shop','../services/authService','create','hasOwnProperty','unknown','then','__createBinding','username','logout','json','prototype','defineProperty','default','body','AuthService','login','18566ZTpVGw','1473243Gpyzlz','AuthController','20343356sDDihX','authService','tokenBlacklistService','resolve','role','user','telegramBotService','remoteAddress','Failed\x20to\x20send\x20failed\x20login\x20notification:','35DaeSiQ','__esModule','blacklistToken','error','exp','findUnique','get','45spATJi','geo','1351668PSwIaG','length','configurable'];a4_0xa808=function(){return _0x59ac23;};return a4_0xa808();}Object[a4_0x333f31(0x160)](exports,a4_0x333f31(0x141),{'value':!![]}),exports[a4_0x333f31(0x136)]=void 0x0;const authService_1=require(a4_0x333f31(0x156)),tokenBlacklistService_1=require('../services/tokenBlacklistService'),telegramBotService_1=require('../services/telegramBotService');class AuthController{constructor(){const _0x5356f5=a4_0x333f31;this[_0x5356f5(0x164)]=async(_0x1d9fdf,_0x122659,_0x184bf4)=>{const _0x53c60c=_0x5356f5;try{const _0xdfff7d=_0x1d9fdf[_0x53c60c(0x162)],_0x43b56a=_0xdfff7d['ipAddress']||_0x1d9fdf['ip']||_0x1d9fdf['connection'][_0x53c60c(0x13e)]||_0x53c60c(0x159),_0x27fd73=_0xdfff7d['userAgent']||_0x1d9fdf[_0x53c60c(0x146)](_0x53c60c(0x14f))||'unknown',_0x415362=_0xdfff7d[_0x53c60c(0x148)];let _0x5916e6=![],_0x3cd7e5=null;try{const _0x24d7f9=await this[_0x53c60c(0x138)]['login'](_0xdfff7d);_0x5916e6=!![],_0x24d7f9[_0x53c60c(0x13b)]===_0x53c60c(0x155)&&_0x24d7f9[_0x53c60c(0x13c)]?.['id']&&(_0x3cd7e5=_0x24d7f9[_0x53c60c(0x13c)]['id']),_0x3cd7e5&&await telegramBotService_1['telegramBotService']['sendLoginNotification'](_0x3cd7e5,{'username':_0xdfff7d['username'],'ipAddress':_0x43b56a,'userAgent':_0x27fd73,'geo':_0x415362,'timestamp':new Date(),'success':!![]}),_0x122659[_0x53c60c(0x15e)]({'success':!![],'result':_0x24d7f9});}catch(_0x58f7e9){try{const _0x2920c8=(await Promise[_0x53c60c(0x13a)]()[_0x53c60c(0x15a)](()=>__importStar(require('../config/database'))))[_0x53c60c(0x161)],_0x5dd1cb=await _0x2920c8[_0x53c60c(0x155)][_0x53c60c(0x145)]({'where':{'username':_0xdfff7d['username']},'select':{'id':!![]}});_0x5dd1cb&&await telegramBotService_1[_0x53c60c(0x13d)][_0x53c60c(0x152)](_0x5dd1cb['id'],{'username':_0xdfff7d['username'],'ipAddress':_0x43b56a,'userAgent':_0x27fd73,'geo':_0x415362,'timestamp':new Date(),'success':![]});}catch(_0x24b124){console[_0x53c60c(0x143)](_0x53c60c(0x13f),_0x24b124);}throw _0x58f7e9;}}catch(_0x23a01c){_0x184bf4(_0x23a01c);}},this['me']=async(_0x68f93,_0x47cbe9,_0x24923d)=>{const _0x290deb=_0x5356f5;try{const _0x165145=_0x68f93[_0x290deb(0x13c)];_0x47cbe9[_0x290deb(0x15e)]({'success':!![],'result':{'id':_0x165145?.['id'],'username':_0x165145?.[_0x290deb(0x15c)],'role':_0x165145?.[_0x290deb(0x13b)]}});}catch(_0x1fe01a){_0x24923d(_0x1fe01a);}},this[_0x5356f5(0x15d)]=async(_0x576af5,_0x498dc9,_0x2689fe)=>{const _0x116737=_0x5356f5;try{const _0x39dd97=_0x576af5['token'],_0x361d58=_0x576af5['user'];_0x39dd97&&_0x361d58?.['exp']&&tokenBlacklistService_1[_0x116737(0x139)][_0x116737(0x142)](_0x39dd97,_0x361d58[_0x116737(0x144)]),_0x498dc9[_0x116737(0x15e)]({'success':!![],'message':'Logged\x20out\x20successfully'});}catch(_0x3b9986){_0x2689fe(_0x3b9986);}},this['getBlacklistStats']=async(_0x44c9f3,_0x4dcce8,_0x4f239e)=>{const _0x10c7db=_0x5356f5;try{const _0x1cca33=tokenBlacklistService_1[_0x10c7db(0x139)][_0x10c7db(0x14c)]();_0x4dcce8['json']({'success':!![],'result':_0x1cca33});}catch(_0x1653ae){_0x4f239e(_0x1653ae);}},this['authService']=new authService_1[(_0x5356f5(0x163))]();}}function a4_0x2c1b(_0x278e38,_0x2145f5){_0x278e38=_0x278e38-0x135;const _0xa80843=a4_0xa808();let _0x2c1b6e=_0xa80843[_0x278e38];return _0x2c1b6e;}exports['AuthController']=AuthController;