'use strict';const a4_0x30ba9e=a4_0x4265;(function(_0x1774b6,_0xfb7826){const _0x50d93d=a4_0x4265,_0xdd1428=_0x1774b6();while(!![]){try{const _0x513f6b=parseInt(_0x50d93d(0x177))/0x1*(-parseInt(_0x50d93d(0x18f))/0x2)+-parseInt(_0x50d93d(0x191))/0x3+-parseInt(_0x50d93d(0x17a))/0x4+parseInt(_0x50d93d(0x19a))/0x5+parseInt(_0x50d93d(0x18c))/0x6+parseInt(_0x50d93d(0x18e))/0x7*(parseInt(_0x50d93d(0x189))/0x8)+parseInt(_0x50d93d(0x17f))/0x9;if(_0x513f6b===_0xfb7826)break;else _0xdd1428['push'](_0xdd1428['shift']());}catch(_0x369a21){_0xdd1428['push'](_0xdd1428['shift']());}}}(a4_0x4108,0x4ecaa));var __createBinding=this&&this[a4_0x30ba9e(0x1a5)]||(Object[a4_0x30ba9e(0x1a2)]?function(_0x230f03,_0x55af59,_0x3af616,_0x51ac5f){const _0x3d674d=a4_0x30ba9e;if(_0x51ac5f===undefined)_0x51ac5f=_0x3af616;var _0x26f273=Object[_0x3d674d(0x17d)](_0x55af59,_0x3af616);(!_0x26f273||(_0x3d674d(0x17c)in _0x26f273?!_0x55af59[_0x3d674d(0x1a3)]:_0x26f273['writable']||_0x26f273[_0x3d674d(0x19b)]))&&(_0x26f273={'enumerable':!![],'get':function(){return _0x55af59[_0x3af616];}}),Object[_0x3d674d(0x19c)](_0x230f03,_0x51ac5f,_0x26f273);}:function(_0x278a21,_0x14348f,_0xe73d5c,_0x27a603){if(_0x27a603===undefined)_0x27a603=_0xe73d5c;_0x278a21[_0x27a603]=_0x14348f[_0xe73d5c];}),__setModuleDefault=this&&this['__setModuleDefault']||(Object[a4_0x30ba9e(0x1a2)]?function(_0x154c30,_0xcad667){const _0x2a9531=a4_0x30ba9e;Object[_0x2a9531(0x19c)](_0x154c30,_0x2a9531(0x182),{'enumerable':!![],'value':_0xcad667});}:function(_0x4d61ef,_0x2778cf){const _0x4a6534=a4_0x30ba9e;_0x4d61ef[_0x4a6534(0x182)]=_0x2778cf;}),__importStar=this&&this[a4_0x30ba9e(0x176)]||(function(){var _0x3b3960=function(_0x366ae1){const _0x40d6f0=a4_0x4265;return _0x3b3960=Object[_0x40d6f0(0x18d)]||function(_0x5c7f80){const _0x4c1ad9=_0x40d6f0;var _0x5d8d5d=[];for(var _0x41bdf0 in _0x5c7f80)if(Object[_0x4c1ad9(0x193)]['hasOwnProperty']['call'](_0x5c7f80,_0x41bdf0))_0x5d8d5d[_0x5d8d5d[_0x4c1ad9(0x18a)]]=_0x41bdf0;return _0x5d8d5d;},_0x3b3960(_0x366ae1);};return function(_0x1b734c){const _0x14db25=a4_0x4265;if(_0x1b734c&&_0x1b734c[_0x14db25(0x1a3)])return _0x1b734c;var _0x24ec87={};if(_0x1b734c!=null){for(var _0x1d0af7=_0x3b3960(_0x1b734c),_0xffa469=0x0;_0xffa469<_0x1d0af7[_0x14db25(0x18a)];_0xffa469++)if(_0x1d0af7[_0xffa469]!==_0x14db25(0x182))__createBinding(_0x24ec87,_0x1b734c,_0x1d0af7[_0xffa469]);}return __setModuleDefault(_0x24ec87,_0x1b734c),_0x24ec87;};}());Object[a4_0x30ba9e(0x19c)](exports,a4_0x30ba9e(0x1a3),{'value':!![]}),exports[a4_0x30ba9e(0x192)]=void 0x0;function a4_0x4265(_0x38f0c8,_0x33d1e0){const _0x410800=a4_0x4108();return a4_0x4265=function(_0x426524,_0x5cc48f){_0x426524=_0x426524-0x175;let _0x13cbed=_0x410800[_0x426524];return _0x13cbed;},a4_0x4265(_0x38f0c8,_0x33d1e0);}const authService_1=require(a4_0x30ba9e(0x17b)),tokenBlacklistService_1=require('../services/tokenBlacklistService'),telegramBotService_1=require(a4_0x30ba9e(0x180));class AuthController{constructor(){const _0x215deb=a4_0x30ba9e;this[_0x215deb(0x187)]=async(_0x124b44,_0x22582d,_0x193deb)=>{const _0x51d284=_0x215deb;try{const _0x303496=_0x124b44[_0x51d284(0x175)],_0x31c7f4=_0x124b44['ip']||_0x124b44[_0x51d284(0x190)][_0x51d284(0x181)]||_0x51d284(0x188),_0x1235ac=_0x124b44[_0x51d284(0x17c)](_0x51d284(0x178))||_0x51d284(0x188);let _0x251e86=![],_0x1341ab=null;try{const _0x372766=await this[_0x51d284(0x199)][_0x51d284(0x187)](_0x303496);_0x251e86=!![],_0x372766['role']==='shop'&&_0x372766['user']?.['id']&&(_0x1341ab=_0x372766[_0x51d284(0x19f)]['id']),_0x1341ab&&await telegramBotService_1[_0x51d284(0x186)][_0x51d284(0x197)](_0x1341ab,{'username':_0x303496['username'],'ipAddress':_0x31c7f4,'userAgent':_0x1235ac,'timestamp':new Date(),'success':!![]}),_0x22582d[_0x51d284(0x184)]({'success':!![],'result':_0x372766});}catch(_0x5d5131){try{const _0x49f7f0=(await Promise[_0x51d284(0x1a1)]()[_0x51d284(0x1a0)](()=>__importStar(require(_0x51d284(0x19e)))))[_0x51d284(0x182)],_0x33a14c=await _0x49f7f0[_0x51d284(0x185)][_0x51d284(0x195)]({'where':{'username':_0x303496[_0x51d284(0x1a4)]},'select':{'id':!![]}});_0x33a14c&&await telegramBotService_1[_0x51d284(0x186)]['sendLoginNotification'](_0x33a14c['id'],{'username':_0x303496[_0x51d284(0x1a4)],'ipAddress':_0x31c7f4,'userAgent':_0x1235ac,'timestamp':new Date(),'success':![]});}catch(_0x41cec5){console['error'](_0x51d284(0x183),_0x41cec5);}throw _0x5d5131;}}catch(_0x2f6dad){_0x193deb(_0x2f6dad);}},this['me']=async(_0x41261f,_0x115e79,_0x58a5c9)=>{const _0x591abc=_0x215deb;try{const _0xbf67d7=_0x41261f['user'];_0x115e79[_0x591abc(0x184)]({'success':!![],'result':{'id':_0xbf67d7?.['id'],'username':_0xbf67d7?.[_0x591abc(0x1a4)],'role':_0xbf67d7?.['role']}});}catch(_0x29705a){_0x58a5c9(_0x29705a);}},this['logout']=async(_0x3fa617,_0x50fa2b,_0x252f24)=>{const _0x2f64bc=_0x215deb;try{const _0x41a7ba=_0x3fa617['token'],_0x4add0b=_0x3fa617[_0x2f64bc(0x19f)];_0x41a7ba&&_0x4add0b?.['exp']&&tokenBlacklistService_1[_0x2f64bc(0x19d)][_0x2f64bc(0x17e)](_0x41a7ba,_0x4add0b[_0x2f64bc(0x198)]),_0x50fa2b[_0x2f64bc(0x184)]({'success':!![],'message':_0x2f64bc(0x18b)});}catch(_0x2890f7){_0x252f24(_0x2890f7);}},this[_0x215deb(0x194)]=async(_0x38d318,_0x2524a0,_0x2615cc)=>{const _0x47b6ec=_0x215deb;try{const _0x3c641c=tokenBlacklistService_1[_0x47b6ec(0x19d)][_0x47b6ec(0x179)]();_0x2524a0[_0x47b6ec(0x184)]({'success':!![],'result':_0x3c641c});}catch(_0x3c0cfa){_0x2615cc(_0x3c0cfa);}},this[_0x215deb(0x199)]=new authService_1[(_0x215deb(0x196))]();}}function a4_0x4108(){const _0x2c0321=['__importStar','421JMwkRD','User-Agent','getStats','1315852oUPAQv','../services/authService','get','getOwnPropertyDescriptor','blacklistToken','8932086BvYVTm','../services/telegramBotService','remoteAddress','default','Failed\x20to\x20send\x20failed\x20login\x20notification:','json','shop','telegramBotService','login','unknown','24576HKCxCV','length','Logged\x20out\x20successfully','2237418uFOyPu','getOwnPropertyNames','301TtVzIg','2536iwIkzK','connection','1730001vbLBhe','AuthController','prototype','getBlacklistStats','findUnique','AuthService','sendLoginNotification','exp','authService','1323675aPruIK','configurable','defineProperty','tokenBlacklistService','../config/database','user','then','resolve','create','__esModule','username','__createBinding','body'];a4_0x4108=function(){return _0x2c0321;};return a4_0x4108();}exports[a4_0x30ba9e(0x192)]=AuthController;