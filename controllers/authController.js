'use strict';function a4_0x17e5(){const _0x5ddba8=['login','Logged\x20out\x20successfully','resolve','findUnique','exp','writable','2GOXdMN','error','getBlacklistStats','user','username','shop','ipAddress','../services/telegramBotService','length','geo','getStats','unknown','../services/authService','remoteAddress','../services/tokenBlacklistService','defineProperty','4295328OCDgzy','telegramBotService','__importStar','json','__createBinding','get','626273ayDoNY','token','AuthController','prototype','role','create','__esModule','__setModuleDefault','getOwnPropertyNames','call','AuthService','authService','body','hasOwnProperty','connection','977631dONWSf','2647384jVFdcI','../config/database','logout','564785sAzGTC','sendLoginNotification','3097752XzIqgw','configurable','2451500iUBIgm','default','getOwnPropertyDescriptor'];a4_0x17e5=function(){return _0x5ddba8;};return a4_0x17e5();}const a4_0x4afa13=a4_0x1f06;(function(_0x2e09b2,_0x517ed){const _0x1d0192=a4_0x1f06,_0x5874fc=_0x2e09b2();while(!![]){try{const _0x18b597=-parseInt(_0x1d0192(0x14e))/0x1+-parseInt(_0x1d0192(0x138))/0x2*(-parseInt(_0x1d0192(0x15d))/0x3)+parseInt(_0x1d0192(0x12f))/0x4+parseInt(_0x1d0192(0x161))/0x5+-parseInt(_0x1d0192(0x148))/0x6+parseInt(_0x1d0192(0x163))/0x7+parseInt(_0x1d0192(0x15e))/0x8;if(_0x18b597===_0x517ed)break;else _0x5874fc['push'](_0x5874fc['shift']());}catch(_0x29ebf2){_0x5874fc['push'](_0x5874fc['shift']());}}}(a4_0x17e5,0x75ebf));var __createBinding=this&&this[a4_0x4afa13(0x14c)]||(Object['create']?function(_0x3f76ff,_0x122536,_0x26e729,_0x286af9){const _0x2f7447=a4_0x4afa13;if(_0x286af9===undefined)_0x286af9=_0x26e729;var _0xfe343e=Object[_0x2f7447(0x131)](_0x122536,_0x26e729);(!_0xfe343e||('get'in _0xfe343e?!_0x122536[_0x2f7447(0x154)]:_0xfe343e[_0x2f7447(0x137)]||_0xfe343e[_0x2f7447(0x12e)]))&&(_0xfe343e={'enumerable':!![],'get':function(){return _0x122536[_0x26e729];}}),Object[_0x2f7447(0x147)](_0x3f76ff,_0x286af9,_0xfe343e);}:function(_0x1cb44f,_0x517357,_0x4983b7,_0x46439b){if(_0x46439b===undefined)_0x46439b=_0x4983b7;_0x1cb44f[_0x46439b]=_0x517357[_0x4983b7];}),__setModuleDefault=this&&this[a4_0x4afa13(0x155)]||(Object[a4_0x4afa13(0x153)]?function(_0xc8246e,_0x35a815){const _0x489f58=a4_0x4afa13;Object[_0x489f58(0x147)](_0xc8246e,_0x489f58(0x130),{'enumerable':!![],'value':_0x35a815});}:function(_0x25b27f,_0x280325){const _0x37bf38=a4_0x4afa13;_0x25b27f[_0x37bf38(0x130)]=_0x280325;}),__importStar=this&&this[a4_0x4afa13(0x14a)]||(function(){var _0x4f5232=function(_0x32c084){const _0x16cf03=a4_0x1f06;return _0x4f5232=Object[_0x16cf03(0x156)]||function(_0x385208){const _0x5ed52d=_0x16cf03;var _0x15342c=[];for(var _0x14d24a in _0x385208)if(Object[_0x5ed52d(0x151)][_0x5ed52d(0x15b)][_0x5ed52d(0x157)](_0x385208,_0x14d24a))_0x15342c[_0x15342c[_0x5ed52d(0x140)]]=_0x14d24a;return _0x15342c;},_0x4f5232(_0x32c084);};return function(_0x19be50){const _0x10343a=a4_0x1f06;if(_0x19be50&&_0x19be50[_0x10343a(0x154)])return _0x19be50;var _0x24abcc={};if(_0x19be50!=null){for(var _0x185d71=_0x4f5232(_0x19be50),_0x5e4f70=0x0;_0x5e4f70<_0x185d71[_0x10343a(0x140)];_0x5e4f70++)if(_0x185d71[_0x5e4f70]!==_0x10343a(0x130))__createBinding(_0x24abcc,_0x19be50,_0x185d71[_0x5e4f70]);}return __setModuleDefault(_0x24abcc,_0x19be50),_0x24abcc;};}());function a4_0x1f06(_0x27047e,_0x1e239a){_0x27047e=_0x27047e-0x12e;const _0x17e5e9=a4_0x17e5();let _0x1f0667=_0x17e5e9[_0x27047e];return _0x1f0667;}Object[a4_0x4afa13(0x147)](exports,a4_0x4afa13(0x154),{'value':!![]}),exports[a4_0x4afa13(0x150)]=void 0x0;const authService_1=require(a4_0x4afa13(0x144)),tokenBlacklistService_1=require(a4_0x4afa13(0x146)),telegramBotService_1=require(a4_0x4afa13(0x13f));class AuthController{constructor(){const _0xe70940=a4_0x4afa13;this[_0xe70940(0x132)]=async(_0x1aea8a,_0x4ec958,_0x282fb4)=>{const _0x2852c8=_0xe70940;try{const _0x4234cb=_0x1aea8a[_0x2852c8(0x15a)],_0x289313=_0x4234cb[_0x2852c8(0x13e)]||_0x1aea8a['ip']||_0x1aea8a[_0x2852c8(0x15c)][_0x2852c8(0x145)]||'unknown',_0x3a61a3=_0x4234cb['userAgent']||_0x1aea8a[_0x2852c8(0x14d)]('User-Agent')||_0x2852c8(0x143),_0x41fa42=_0x4234cb[_0x2852c8(0x141)];let _0x16801f=![],_0x170d15=null;try{const _0x2ef9a7=await this[_0x2852c8(0x159)][_0x2852c8(0x132)](_0x4234cb);_0x16801f=!![],_0x2ef9a7[_0x2852c8(0x152)]===_0x2852c8(0x13d)&&_0x2ef9a7[_0x2852c8(0x13b)]?.['id']&&(_0x170d15=_0x2ef9a7[_0x2852c8(0x13b)]['id']),_0x170d15&&await telegramBotService_1[_0x2852c8(0x149)][_0x2852c8(0x162)](_0x170d15,{'username':_0x4234cb['username'],'ipAddress':_0x289313,'userAgent':_0x3a61a3,'geo':_0x41fa42,'timestamp':new Date(),'success':!![]}),_0x4ec958[_0x2852c8(0x14b)]({'success':!![],'result':_0x2ef9a7});}catch(_0x394fb6){try{const _0x342502=(await Promise[_0x2852c8(0x134)]()['then'](()=>__importStar(require(_0x2852c8(0x15f)))))[_0x2852c8(0x130)],_0x11c342=await _0x342502[_0x2852c8(0x13d)][_0x2852c8(0x135)]({'where':{'username':_0x4234cb[_0x2852c8(0x13c)]},'select':{'id':!![]}});_0x11c342&&await telegramBotService_1['telegramBotService'][_0x2852c8(0x162)](_0x11c342['id'],{'username':_0x4234cb[_0x2852c8(0x13c)],'ipAddress':_0x289313,'userAgent':_0x3a61a3,'geo':_0x41fa42,'timestamp':new Date(),'success':![]});}catch(_0x57f711){console[_0x2852c8(0x139)]('Failed\x20to\x20send\x20failed\x20login\x20notification:',_0x57f711);}throw _0x394fb6;}}catch(_0x50adf2){_0x282fb4(_0x50adf2);}},this['me']=async(_0x31ee3b,_0x596934,_0x346da0)=>{const _0x318aab=_0xe70940;try{const _0x35eefd=_0x31ee3b['user'];_0x596934['json']({'success':!![],'result':{'id':_0x35eefd?.['id'],'username':_0x35eefd?.['username'],'role':_0x35eefd?.[_0x318aab(0x152)]}});}catch(_0x393ba4){_0x346da0(_0x393ba4);}},this[_0xe70940(0x160)]=async(_0x33689f,_0x455020,_0xe14f45)=>{const _0x44b44b=_0xe70940;try{const _0x2f7375=_0x33689f[_0x44b44b(0x14f)],_0x45befa=_0x33689f[_0x44b44b(0x13b)];_0x2f7375&&_0x45befa?.[_0x44b44b(0x136)]&&tokenBlacklistService_1['tokenBlacklistService']['blacklistToken'](_0x2f7375,_0x45befa[_0x44b44b(0x136)]),_0x455020['json']({'success':!![],'message':_0x44b44b(0x133)});}catch(_0x27aed6){_0xe14f45(_0x27aed6);}},this[_0xe70940(0x13a)]=async(_0x5e254a,_0x1bb730,_0x73d21c)=>{const _0x484d4d=_0xe70940;try{const _0x2da425=tokenBlacklistService_1['tokenBlacklistService'][_0x484d4d(0x142)]();_0x1bb730['json']({'success':!![],'result':_0x2da425});}catch(_0x5bbb57){_0x73d21c(_0x5bbb57);}},this[_0xe70940(0x159)]=new authService_1[(_0xe70940(0x158))]();}}exports[a4_0x4afa13(0x150)]=AuthController;