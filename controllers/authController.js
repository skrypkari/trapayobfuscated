'use strict';const a4_0x2b8a00=a4_0x1310;function a4_0x2a23(){const _0x13de7d=['__createBinding','login','exp','AuthController','findUnique','16BJhwEu','connection','__setModuleDefault','7790IfMgbB','username','hasOwnProperty','sendLoginNotification','../config/database','logout','defineProperty','configurable','__esModule','authService','get','body','4570380ftDNPK','length','default','58130zxlJOK','writable','__importStar','getOwnPropertyDescriptor','create','Logged\x20out\x20successfully','762482vpSufo','telegramBotService','user','1016484uluqjM','role','4EuDbsD','then','getOwnPropertyNames','1230852fhcYFW','remoteAddress','unknown','getStats','Failed\x20to\x20send\x20failed\x20login\x20notification:','error','../services/telegramBotService','../services/authService','tokenBlacklistService','shop','AuthService','json','call','../services/tokenBlacklistService','blacklistToken','3670656Nxjxyz','User-Agent'];a4_0x2a23=function(){return _0x13de7d;};return a4_0x2a23();}(function(_0x4ac504,_0x15cc82){const _0x3e254b=a4_0x1310,_0x3ea9db=_0x4ac504();while(!![]){try{const _0x1cf2bd=parseInt(_0x3e254b(0x192))/0x1*(parseInt(_0x3e254b(0x167))/0x2)+parseInt(_0x3e254b(0x165))/0x3+parseInt(_0x3e254b(0x180))/0x4*(parseInt(_0x3e254b(0x183))/0x5)+-parseInt(_0x3e254b(0x16a))/0x6+parseInt(_0x3e254b(0x162))/0x7+parseInt(_0x3e254b(0x179))/0x8+-parseInt(_0x3e254b(0x18f))/0x9;if(_0x1cf2bd===_0x15cc82)break;else _0x3ea9db['push'](_0x3ea9db['shift']());}catch(_0x282b19){_0x3ea9db['push'](_0x3ea9db['shift']());}}}(a4_0x2a23,0x4d2d4));function a4_0x1310(_0x18d05d,_0x3f55f8){const _0x2a23a5=a4_0x2a23();return a4_0x1310=function(_0x131095,_0x4e4983){_0x131095=_0x131095-0x15f;let _0x36f0b3=_0x2a23a5[_0x131095];return _0x36f0b3;},a4_0x1310(_0x18d05d,_0x3f55f8);}var __createBinding=this&&this[a4_0x2b8a00(0x17b)]||(Object[a4_0x2b8a00(0x160)]?function(_0x3ffbf6,_0x46e877,_0x4ce80d,_0x527181){const _0x4c95f2=a4_0x2b8a00;if(_0x527181===undefined)_0x527181=_0x4ce80d;var _0x580030=Object[_0x4c95f2(0x15f)](_0x46e877,_0x4ce80d);(!_0x580030||(_0x4c95f2(0x18d)in _0x580030?!_0x46e877[_0x4c95f2(0x18b)]:_0x580030[_0x4c95f2(0x193)]||_0x580030[_0x4c95f2(0x18a)]))&&(_0x580030={'enumerable':!![],'get':function(){return _0x46e877[_0x4ce80d];}}),Object[_0x4c95f2(0x189)](_0x3ffbf6,_0x527181,_0x580030);}:function(_0x294cc3,_0x3bcffc,_0x4ed655,_0x18a24c){if(_0x18a24c===undefined)_0x18a24c=_0x4ed655;_0x294cc3[_0x18a24c]=_0x3bcffc[_0x4ed655];}),__setModuleDefault=this&&this[a4_0x2b8a00(0x182)]||(Object[a4_0x2b8a00(0x160)]?function(_0x183d68,_0x511356){const _0xc7807=a4_0x2b8a00;Object[_0xc7807(0x189)](_0x183d68,_0xc7807(0x191),{'enumerable':!![],'value':_0x511356});}:function(_0x44653f,_0x1a62b9){const _0x4b4bf2=a4_0x2b8a00;_0x44653f[_0x4b4bf2(0x191)]=_0x1a62b9;}),__importStar=this&&this[a4_0x2b8a00(0x194)]||(function(){var _0x432492=function(_0x17833e){const _0x3c9aa5=a4_0x1310;return _0x432492=Object[_0x3c9aa5(0x169)]||function(_0x5611ef){const _0x474b69=_0x3c9aa5;var _0x34cd83=[];for(var _0x44f3e7 in _0x5611ef)if(Object['prototype'][_0x474b69(0x185)][_0x474b69(0x176)](_0x5611ef,_0x44f3e7))_0x34cd83[_0x34cd83[_0x474b69(0x190)]]=_0x44f3e7;return _0x34cd83;},_0x432492(_0x17833e);};return function(_0x37ab91){const _0x4868ae=a4_0x1310;if(_0x37ab91&&_0x37ab91[_0x4868ae(0x18b)])return _0x37ab91;var _0x7adcba={};if(_0x37ab91!=null){for(var _0x293bff=_0x432492(_0x37ab91),_0x3deb0d=0x0;_0x3deb0d<_0x293bff[_0x4868ae(0x190)];_0x3deb0d++)if(_0x293bff[_0x3deb0d]!=='default')__createBinding(_0x7adcba,_0x37ab91,_0x293bff[_0x3deb0d]);}return __setModuleDefault(_0x7adcba,_0x37ab91),_0x7adcba;};}());Object[a4_0x2b8a00(0x189)](exports,'__esModule',{'value':!![]}),exports[a4_0x2b8a00(0x17e)]=void 0x0;const authService_1=require(a4_0x2b8a00(0x171)),tokenBlacklistService_1=require(a4_0x2b8a00(0x177)),telegramBotService_1=require(a4_0x2b8a00(0x170));class AuthController{constructor(){const _0x407f53=a4_0x2b8a00;this['login']=async(_0x4128b4,_0x259fc2,_0xeaaa2f)=>{const _0x28315f=a4_0x1310;try{const _0x490025=_0x4128b4[_0x28315f(0x18e)],_0x215e50=_0x4128b4['ip']||_0x4128b4[_0x28315f(0x181)][_0x28315f(0x16b)]||_0x28315f(0x16c),_0x3cc0f5=_0x4128b4[_0x28315f(0x18d)](_0x28315f(0x17a))||_0x28315f(0x16c);let _0x21fff1=![],_0x3ed166=null;try{const _0x4c90ec=await this[_0x28315f(0x18c)][_0x28315f(0x17c)](_0x490025);_0x21fff1=!![],_0x4c90ec[_0x28315f(0x166)]===_0x28315f(0x173)&&_0x4c90ec[_0x28315f(0x164)]?.['id']&&(_0x3ed166=_0x4c90ec[_0x28315f(0x164)]['id']),_0x3ed166&&await telegramBotService_1[_0x28315f(0x163)]['sendLoginNotification'](_0x3ed166,{'username':_0x490025[_0x28315f(0x184)],'ipAddress':_0x215e50,'userAgent':_0x3cc0f5,'timestamp':new Date(),'success':!![]}),_0x259fc2[_0x28315f(0x175)]({'success':!![],'result':_0x4c90ec});}catch(_0x2e30ec){try{const _0x133425=(await Promise['resolve']()[_0x28315f(0x168)](()=>__importStar(require(_0x28315f(0x187)))))[_0x28315f(0x191)],_0x3e1f1a=await _0x133425[_0x28315f(0x173)][_0x28315f(0x17f)]({'where':{'username':_0x490025[_0x28315f(0x184)]},'select':{'id':!![]}});_0x3e1f1a&&await telegramBotService_1[_0x28315f(0x163)][_0x28315f(0x186)](_0x3e1f1a['id'],{'username':_0x490025[_0x28315f(0x184)],'ipAddress':_0x215e50,'userAgent':_0x3cc0f5,'timestamp':new Date(),'success':![]});}catch(_0x2cbe80){console[_0x28315f(0x16f)](_0x28315f(0x16e),_0x2cbe80);}throw _0x2e30ec;}}catch(_0x4c0ed5){_0xeaaa2f(_0x4c0ed5);}},this['me']=async(_0x1172e5,_0x17a7fc,_0x2212ad)=>{const _0x4f13f9=a4_0x1310;try{const _0x1eb66c=_0x1172e5[_0x4f13f9(0x164)];_0x17a7fc['json']({'success':!![],'result':{'id':_0x1eb66c?.['id'],'username':_0x1eb66c?.['username'],'role':_0x1eb66c?.['role']}});}catch(_0x1b24f5){_0x2212ad(_0x1b24f5);}},this[_0x407f53(0x188)]=async(_0x2b874d,_0x14f75d,_0x537773)=>{const _0x4361ff=_0x407f53;try{const _0x475d47=_0x2b874d['token'],_0x1e4487=_0x2b874d[_0x4361ff(0x164)];_0x475d47&&_0x1e4487?.[_0x4361ff(0x17d)]&&tokenBlacklistService_1['tokenBlacklistService'][_0x4361ff(0x178)](_0x475d47,_0x1e4487['exp']),_0x14f75d[_0x4361ff(0x175)]({'success':!![],'message':_0x4361ff(0x161)});}catch(_0x5d11ff){_0x537773(_0x5d11ff);}},this['getBlacklistStats']=async(_0x17a62a,_0x26a9a5,_0x334dbb)=>{const _0x4eaeca=_0x407f53;try{const _0x456e86=tokenBlacklistService_1[_0x4eaeca(0x172)][_0x4eaeca(0x16d)]();_0x26a9a5[_0x4eaeca(0x175)]({'success':!![],'result':_0x456e86});}catch(_0x85c800){_0x334dbb(_0x85c800);}},this[_0x407f53(0x18c)]=new authService_1[(_0x407f53(0x174))]();}}exports[a4_0x2b8a00(0x17e)]=AuthController;