'use strict';const a4_0x1884b5=a4_0x5898;(function(_0x4b609f,_0x184713){const _0x1906ca=a4_0x5898,_0x48ab81=_0x4b609f();while(!![]){try{const _0x48b942=parseInt(_0x1906ca(0x20d))/0x1*(parseInt(_0x1906ca(0x1e7))/0x2)+parseInt(_0x1906ca(0x1de))/0x3*(-parseInt(_0x1906ca(0x1f1))/0x4)+-parseInt(_0x1906ca(0x1e0))/0x5*(-parseInt(_0x1906ca(0x1ea))/0x6)+-parseInt(_0x1906ca(0x207))/0x7+-parseInt(_0x1906ca(0x1ec))/0x8*(parseInt(_0x1906ca(0x203))/0x9)+-parseInt(_0x1906ca(0x1fc))/0xa+-parseInt(_0x1906ca(0x1fe))/0xb*(-parseInt(_0x1906ca(0x1e4))/0xc);if(_0x48b942===_0x184713)break;else _0x48ab81['push'](_0x48ab81['shift']());}catch(_0x5c69f1){_0x48ab81['push'](_0x48ab81['shift']());}}}(a4_0x1216,0x1be25));var __createBinding=this&&this[a4_0x1884b5(0x206)]||(Object[a4_0x1884b5(0x1fb)]?function(_0x25f4cf,_0x357739,_0x38e31b,_0x5eeb9c){const _0x2ff104=a4_0x1884b5;if(_0x5eeb9c===undefined)_0x5eeb9c=_0x38e31b;var _0x29cd69=Object['getOwnPropertyDescriptor'](_0x357739,_0x38e31b);(!_0x29cd69||('get'in _0x29cd69?!_0x357739[_0x2ff104(0x1e9)]:_0x29cd69[_0x2ff104(0x1ef)]||_0x29cd69[_0x2ff104(0x1db)]))&&(_0x29cd69={'enumerable':!![],'get':function(){return _0x357739[_0x38e31b];}}),Object[_0x2ff104(0x1e3)](_0x25f4cf,_0x5eeb9c,_0x29cd69);}:function(_0x52f238,_0x241856,_0x465652,_0x331e91){if(_0x331e91===undefined)_0x331e91=_0x465652;_0x52f238[_0x331e91]=_0x241856[_0x465652];}),__setModuleDefault=this&&this['__setModuleDefault']||(Object[a4_0x1884b5(0x1fb)]?function(_0x98ec18,_0x205e0f){const _0x15861a=a4_0x1884b5;Object[_0x15861a(0x1e3)](_0x98ec18,_0x15861a(0x20b),{'enumerable':!![],'value':_0x205e0f});}:function(_0x1ec98b,_0x195c84){const _0x5e4c42=a4_0x1884b5;_0x1ec98b[_0x5e4c42(0x20b)]=_0x195c84;}),__importStar=this&&this['__importStar']||(function(){var _0x5e4a5a=function(_0x4f00a){const _0x170213=a4_0x5898;return _0x5e4a5a=Object[_0x170213(0x1f4)]||function(_0x47a08d){const _0x1a78cd=_0x170213;var _0xa47bbb=[];for(var _0x1666c8 in _0x47a08d)if(Object[_0x1a78cd(0x1eb)]['hasOwnProperty']['call'](_0x47a08d,_0x1666c8))_0xa47bbb[_0xa47bbb[_0x1a78cd(0x200)]]=_0x1666c8;return _0xa47bbb;},_0x5e4a5a(_0x4f00a);};return function(_0x5623fa){const _0x1c3d32=a4_0x5898;if(_0x5623fa&&_0x5623fa[_0x1c3d32(0x1e9)])return _0x5623fa;var _0x336364={};if(_0x5623fa!=null){for(var _0x3fce64=_0x5e4a5a(_0x5623fa),_0x31c532=0x0;_0x31c532<_0x3fce64[_0x1c3d32(0x200)];_0x31c532++)if(_0x3fce64[_0x31c532]!==_0x1c3d32(0x20b))__createBinding(_0x336364,_0x5623fa,_0x3fce64[_0x31c532]);}return __setModuleDefault(_0x336364,_0x5623fa),_0x336364;};}());Object['defineProperty'](exports,a4_0x1884b5(0x1e9),{'value':!![]}),exports[a4_0x1884b5(0x1e6)]=void 0x0;const authService_1=require(a4_0x1884b5(0x1f3)),tokenBlacklistService_1=require(a4_0x1884b5(0x209)),telegramBotService_1=require(a4_0x1884b5(0x208));function a4_0x1216(){const _0x22568f=['33epvfRg','resolve','length','json','findUnique','1059174hLKJWF','Failed\x20to\x20send\x20failed\x20login\x20notification:','exp','__createBinding','1065330tPjlqN','../services/telegramBotService','../services/tokenBlacklistService','error','default','tokenBlacklistService','83gVDJYU','username','configurable','then','Logged\x20out\x20successfully','259503thVaxn','role','5PwnvNJ','login','body','defineProperty','2153364DeTcZh','unknown','AuthController','1654uGiNcT','authService','__esModule','345378ICKKyb','prototype','8UGZVsy','blacklistToken','User-Agent','writable','sendLoginNotification','4cnSXtf','shop','../services/authService','getOwnPropertyNames','connection','token','logout','user','telegramBotService','getStats','create','1939550GoRrqa','AuthService'];a4_0x1216=function(){return _0x22568f;};return a4_0x1216();}class AuthController{constructor(){const _0x402a3e=a4_0x1884b5;this['login']=async(_0x181c2a,_0x24dc26,_0x3670e2)=>{const _0x5b8411=a4_0x5898;try{const _0x320c87=_0x181c2a[_0x5b8411(0x1e2)],_0x210715=_0x181c2a['ip']||_0x181c2a[_0x5b8411(0x1f5)]['remoteAddress']||_0x5b8411(0x1e5),_0x4c09a8=_0x181c2a['get'](_0x5b8411(0x1ee))||_0x5b8411(0x1e5);let _0x535bd3=![],_0x3e3ab3=null;try{const _0x12b938=await this[_0x5b8411(0x1e8)][_0x5b8411(0x1e1)](_0x320c87);_0x535bd3=!![],_0x12b938[_0x5b8411(0x1df)]===_0x5b8411(0x1f2)&&_0x12b938['user']?.['id']&&(_0x3e3ab3=_0x12b938[_0x5b8411(0x1f8)]['id']),_0x3e3ab3&&await telegramBotService_1['telegramBotService'][_0x5b8411(0x1f0)](_0x3e3ab3,{'username':_0x320c87['username'],'ipAddress':_0x210715,'userAgent':_0x4c09a8,'timestamp':new Date(),'success':!![]}),_0x24dc26[_0x5b8411(0x201)]({'success':!![],'result':_0x12b938});}catch(_0x1dcdda){try{const _0x38f50f=(await Promise[_0x5b8411(0x1ff)]()[_0x5b8411(0x1dc)](()=>__importStar(require('../config/database'))))[_0x5b8411(0x20b)],_0x331dd2=await _0x38f50f[_0x5b8411(0x1f2)][_0x5b8411(0x202)]({'where':{'username':_0x320c87[_0x5b8411(0x1da)]},'select':{'id':!![]}});_0x331dd2&&await telegramBotService_1[_0x5b8411(0x1f9)][_0x5b8411(0x1f0)](_0x331dd2['id'],{'username':_0x320c87[_0x5b8411(0x1da)],'ipAddress':_0x210715,'userAgent':_0x4c09a8,'timestamp':new Date(),'success':![]});}catch(_0x5ce5fc){console[_0x5b8411(0x20a)](_0x5b8411(0x204),_0x5ce5fc);}throw _0x1dcdda;}}catch(_0x226e8e){_0x3670e2(_0x226e8e);}},this['me']=async(_0x5cf4f4,_0x4bc9cb,_0x170782)=>{const _0x38097e=a4_0x5898;try{const _0x54baca=_0x5cf4f4[_0x38097e(0x1f8)];_0x4bc9cb[_0x38097e(0x201)]({'success':!![],'result':{'id':_0x54baca?.['id'],'username':_0x54baca?.['username'],'role':_0x54baca?.[_0x38097e(0x1df)]}});}catch(_0x194288){_0x170782(_0x194288);}},this[_0x402a3e(0x1f7)]=async(_0x93f66c,_0x846136,_0x53b50f)=>{const _0x2973f5=_0x402a3e;try{const _0x159287=_0x93f66c[_0x2973f5(0x1f6)],_0x130f69=_0x93f66c['user'];_0x159287&&_0x130f69?.[_0x2973f5(0x205)]&&tokenBlacklistService_1[_0x2973f5(0x20c)][_0x2973f5(0x1ed)](_0x159287,_0x130f69['exp']),_0x846136['json']({'success':!![],'message':_0x2973f5(0x1dd)});}catch(_0x31502a){_0x53b50f(_0x31502a);}},this['getBlacklistStats']=async(_0x172205,_0x20acf5,_0x446d80)=>{const _0x3bdb21=_0x402a3e;try{const _0x325a71=tokenBlacklistService_1[_0x3bdb21(0x20c)][_0x3bdb21(0x1fa)]();_0x20acf5['json']({'success':!![],'result':_0x325a71});}catch(_0x2159ef){_0x446d80(_0x2159ef);}},this[_0x402a3e(0x1e8)]=new authService_1[(_0x402a3e(0x1fd))]();}}function a4_0x5898(_0x310f80,_0x336fbe){const _0x121611=a4_0x1216();return a4_0x5898=function(_0x5898ef,_0x194abc){_0x5898ef=_0x5898ef-0x1da;let _0x1358fb=_0x121611[_0x5898ef];return _0x1358fb;},a4_0x5898(_0x310f80,_0x336fbe);}exports[a4_0x1884b5(0x1e6)]=AuthController;