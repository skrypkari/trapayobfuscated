'use strict';const a4_0xfcc2d9=a4_0x20e6;(function(_0x4b2d41,_0x13f5f2){const _0x31cc47=a4_0x20e6,_0x264799=_0x4b2d41();while(!![]){try{const _0x2ea8d7=-parseInt(_0x31cc47(0x15f))/0x1+parseInt(_0x31cc47(0x150))/0x2+parseInt(_0x31cc47(0x14a))/0x3*(-parseInt(_0x31cc47(0x155))/0x4)+-parseInt(_0x31cc47(0x170))/0x5*(parseInt(_0x31cc47(0x142))/0x6)+-parseInt(_0x31cc47(0x157))/0x7+parseInt(_0x31cc47(0x163))/0x8*(parseInt(_0x31cc47(0x151))/0x9)+-parseInt(_0x31cc47(0x16f))/0xa*(-parseInt(_0x31cc47(0x14d))/0xb);if(_0x2ea8d7===_0x13f5f2)break;else _0x264799['push'](_0x264799['shift']());}catch(_0x53d17d){_0x264799['push'](_0x264799['shift']());}}}(a4_0xca07,0x1f0a9));var __createBinding=this&&this[a4_0xfcc2d9(0x144)]||(Object[a4_0xfcc2d9(0x154)]?function(_0x5778e9,_0x1a73bc,_0x3800eb,_0x2834e2){const _0x4f4a76=a4_0xfcc2d9;if(_0x2834e2===undefined)_0x2834e2=_0x3800eb;var _0x534856=Object[_0x4f4a76(0x164)](_0x1a73bc,_0x3800eb);(!_0x534856||(_0x4f4a76(0x153)in _0x534856?!_0x1a73bc[_0x4f4a76(0x15a)]:_0x534856[_0x4f4a76(0x15d)]||_0x534856[_0x4f4a76(0x168)]))&&(_0x534856={'enumerable':!![],'get':function(){return _0x1a73bc[_0x3800eb];}}),Object[_0x4f4a76(0x16e)](_0x5778e9,_0x2834e2,_0x534856);}:function(_0x145439,_0x1320a3,_0x421ffd,_0xf0f6bb){if(_0xf0f6bb===undefined)_0xf0f6bb=_0x421ffd;_0x145439[_0xf0f6bb]=_0x1320a3[_0x421ffd];}),__setModuleDefault=this&&this[a4_0xfcc2d9(0x148)]||(Object[a4_0xfcc2d9(0x154)]?function(_0x1d5c30,_0x3d4184){const _0x347c9a=a4_0xfcc2d9;Object[_0x347c9a(0x16e)](_0x1d5c30,_0x347c9a(0x161),{'enumerable':!![],'value':_0x3d4184});}:function(_0x4768be,_0x3628fc){_0x4768be['default']=_0x3628fc;}),__importStar=this&&this[a4_0xfcc2d9(0x145)]||(function(){var _0x52c2fe=function(_0x3e322b){const _0x17f155=a4_0x20e6;return _0x52c2fe=Object[_0x17f155(0x15c)]||function(_0x43f64b){const _0x2dc1f9=_0x17f155;var _0x106669=[];for(var _0x74cf97 in _0x43f64b)if(Object[_0x2dc1f9(0x167)][_0x2dc1f9(0x156)][_0x2dc1f9(0x159)](_0x43f64b,_0x74cf97))_0x106669[_0x106669[_0x2dc1f9(0x152)]]=_0x74cf97;return _0x106669;},_0x52c2fe(_0x3e322b);};return function(_0x3de2c0){const _0x105626=a4_0x20e6;if(_0x3de2c0&&_0x3de2c0[_0x105626(0x15a)])return _0x3de2c0;var _0xc3f018={};if(_0x3de2c0!=null){for(var _0x535d4f=_0x52c2fe(_0x3de2c0),_0x2e4c14=0x0;_0x2e4c14<_0x535d4f[_0x105626(0x152)];_0x2e4c14++)if(_0x535d4f[_0x2e4c14]!==_0x105626(0x161))__createBinding(_0xc3f018,_0x3de2c0,_0x535d4f[_0x2e4c14]);}return __setModuleDefault(_0xc3f018,_0x3de2c0),_0xc3f018;};}());Object[a4_0xfcc2d9(0x16e)](exports,a4_0xfcc2d9(0x15a),{'value':!![]}),exports[a4_0xfcc2d9(0x14b)]=void 0x0;function a4_0x20e6(_0x34923d,_0x15fe5b){const _0xca07c7=a4_0xca07();return a4_0x20e6=function(_0x20e65a,_0x31c9b0){_0x20e65a=_0x20e65a-0x141;let _0x5eea30=_0xca07c7[_0x20e65a];return _0x5eea30;},a4_0x20e6(_0x34923d,_0x15fe5b);}const authService_1=require('../services/authService'),tokenBlacklistService_1=require(a4_0xfcc2d9(0x171)),telegramBotService_1=require('../services/telegramBotService');function a4_0xca07(){const _0x1ce955=['prototype','configurable','exp','json','username','Failed\x20to\x20send\x20failed\x20login\x20notification:','getStats','defineProperty','240dvliuM','442435NXQsUC','../services/tokenBlacklistService','connection','6KYLoHr','User-Agent','__createBinding','__importStar','logout','role','__setModuleDefault','telegramBotService','687CThATr','AuthController','sendLoginNotification','89364LQawNn','shop','tokenBlacklistService','492388JgCszr','1548621zKfVAU','length','get','create','4412zxKpAs','hasOwnProperty','858088HnrINg','login','call','__esModule','getBlacklistStats','getOwnPropertyNames','writable','authService','22436yMUuSr','then','default','error','8dXjvKE','getOwnPropertyDescriptor','unknown','user'];a4_0xca07=function(){return _0x1ce955;};return a4_0xca07();}class AuthController{constructor(){const _0x4b47a1=a4_0xfcc2d9;this[_0x4b47a1(0x158)]=async(_0x544cd1,_0x3bf112,_0x11b9e1)=>{const _0x5c3e27=_0x4b47a1;try{const _0x1805c6=_0x544cd1['body'],_0x51bd98=_0x544cd1['ip']||_0x544cd1[_0x5c3e27(0x141)]['remoteAddress']||_0x5c3e27(0x165),_0x3fe967=_0x544cd1[_0x5c3e27(0x153)](_0x5c3e27(0x143))||_0x5c3e27(0x165);let _0xc7d0d8=![],_0x343cac=null;try{const _0x3d0ab5=await this[_0x5c3e27(0x15e)]['login'](_0x1805c6);_0xc7d0d8=!![],_0x3d0ab5[_0x5c3e27(0x147)]===_0x5c3e27(0x14e)&&_0x3d0ab5['user']?.['id']&&(_0x343cac=_0x3d0ab5['user']['id']),_0x343cac&&await telegramBotService_1[_0x5c3e27(0x149)][_0x5c3e27(0x14c)](_0x343cac,{'username':_0x1805c6[_0x5c3e27(0x16b)],'ipAddress':_0x51bd98,'userAgent':_0x3fe967,'timestamp':new Date(),'success':!![]}),_0x3bf112[_0x5c3e27(0x16a)]({'success':!![],'result':_0x3d0ab5});}catch(_0x32b30f){try{const _0x1856c0=(await Promise['resolve']()[_0x5c3e27(0x160)](()=>__importStar(require('../config/database'))))[_0x5c3e27(0x161)],_0x53995f=await _0x1856c0[_0x5c3e27(0x14e)]['findUnique']({'where':{'username':_0x1805c6[_0x5c3e27(0x16b)]},'select':{'id':!![]}});_0x53995f&&await telegramBotService_1[_0x5c3e27(0x149)][_0x5c3e27(0x14c)](_0x53995f['id'],{'username':_0x1805c6[_0x5c3e27(0x16b)],'ipAddress':_0x51bd98,'userAgent':_0x3fe967,'timestamp':new Date(),'success':![]});}catch(_0x358ea3){console[_0x5c3e27(0x162)](_0x5c3e27(0x16c),_0x358ea3);}throw _0x32b30f;}}catch(_0x31dcca){_0x11b9e1(_0x31dcca);}},this['me']=async(_0x3855fa,_0x4c001c,_0x31e533)=>{const _0x4bb4e3=_0x4b47a1;try{const _0x71b3ca=_0x3855fa[_0x4bb4e3(0x166)];_0x4c001c[_0x4bb4e3(0x16a)]({'success':!![],'result':{'id':_0x71b3ca?.['id'],'username':_0x71b3ca?.[_0x4bb4e3(0x16b)],'role':_0x71b3ca?.[_0x4bb4e3(0x147)]}});}catch(_0x197346){_0x31e533(_0x197346);}},this[_0x4b47a1(0x146)]=async(_0x193d6b,_0x17e32e,_0x3431a1)=>{const _0x6d56e3=_0x4b47a1;try{const _0x1f19f3=_0x193d6b['token'],_0x448b25=_0x193d6b['user'];_0x1f19f3&&_0x448b25?.[_0x6d56e3(0x169)]&&tokenBlacklistService_1['tokenBlacklistService']['blacklistToken'](_0x1f19f3,_0x448b25[_0x6d56e3(0x169)]),_0x17e32e['json']({'success':!![],'message':'Logged\x20out\x20successfully'});}catch(_0x850d85){_0x3431a1(_0x850d85);}},this[_0x4b47a1(0x15b)]=async(_0x2d7828,_0x2269da,_0x253b74)=>{const _0x15cf56=_0x4b47a1;try{const _0x2df404=tokenBlacklistService_1[_0x15cf56(0x14f)][_0x15cf56(0x16d)]();_0x2269da[_0x15cf56(0x16a)]({'success':!![],'result':_0x2df404});}catch(_0x576945){_0x253b74(_0x576945);}},this[_0x4b47a1(0x15e)]=new authService_1['AuthService']();}}exports[a4_0xfcc2d9(0x14b)]=AuthController;