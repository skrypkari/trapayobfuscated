'use strict';const a4_0x53004d=a4_0x1173;(function(_0x56a588,_0x3a4d4d){const _0x194628=a4_0x1173,_0x163fb6=_0x56a588();while(!![]){try{const _0x857032=-parseInt(_0x194628(0x1f4))/0x1+parseInt(_0x194628(0x1f0))/0x2*(-parseInt(_0x194628(0x210))/0x3)+parseInt(_0x194628(0x20b))/0x4+-parseInt(_0x194628(0x20d))/0x5*(-parseInt(_0x194628(0x1e3))/0x6)+-parseInt(_0x194628(0x1f2))/0x7*(parseInt(_0x194628(0x1e1))/0x8)+parseInt(_0x194628(0x1df))/0x9*(parseInt(_0x194628(0x1ef))/0xa)+parseInt(_0x194628(0x1f9))/0xb;if(_0x857032===_0x3a4d4d)break;else _0x163fb6['push'](_0x163fb6['shift']());}catch(_0x2a2a8d){_0x163fb6['push'](_0x163fb6['shift']());}}}(a4_0x5167,0x94afc));var __createBinding=this&&this[a4_0x53004d(0x202)]||(Object[a4_0x53004d(0x200)]?function(_0x7e36c9,_0x6347b1,_0x30adeb,_0x55d5c4){const _0x4d6c3f=a4_0x53004d;if(_0x55d5c4===undefined)_0x55d5c4=_0x30adeb;var _0x519ade=Object[_0x4d6c3f(0x20a)](_0x6347b1,_0x30adeb);(!_0x519ade||(_0x4d6c3f(0x1fe)in _0x519ade?!_0x6347b1[_0x4d6c3f(0x1fc)]:_0x519ade[_0x4d6c3f(0x214)]||_0x519ade[_0x4d6c3f(0x20c)]))&&(_0x519ade={'enumerable':!![],'get':function(){return _0x6347b1[_0x30adeb];}}),Object[_0x4d6c3f(0x211)](_0x7e36c9,_0x55d5c4,_0x519ade);}:function(_0x2cf325,_0x52cea3,_0x2ad605,_0x3c18a5){if(_0x3c18a5===undefined)_0x3c18a5=_0x2ad605;_0x2cf325[_0x3c18a5]=_0x52cea3[_0x2ad605];}),__setModuleDefault=this&&this[a4_0x53004d(0x20f)]||(Object[a4_0x53004d(0x200)]?function(_0x4d6b07,_0x323358){const _0x9ea72a=a4_0x53004d;Object[_0x9ea72a(0x211)](_0x4d6b07,_0x9ea72a(0x213),{'enumerable':!![],'value':_0x323358});}:function(_0x53b890,_0x350b43){const _0xd5dd01=a4_0x53004d;_0x53b890[_0xd5dd01(0x213)]=_0x350b43;}),__importStar=this&&this[a4_0x53004d(0x1f8)]||(function(){var _0x5d19cb=function(_0x1ee9f3){const _0x22775c=a4_0x1173;return _0x5d19cb=Object[_0x22775c(0x1ee)]||function(_0x4a81a7){const _0x325f93=_0x22775c;var _0x164e4e=[];for(var _0x1a9334 in _0x4a81a7)if(Object[_0x325f93(0x209)]['hasOwnProperty'][_0x325f93(0x1f5)](_0x4a81a7,_0x1a9334))_0x164e4e[_0x164e4e[_0x325f93(0x1e0)]]=_0x1a9334;return _0x164e4e;},_0x5d19cb(_0x1ee9f3);};return function(_0x1cf95d){const _0x40f34e=a4_0x1173;if(_0x1cf95d&&_0x1cf95d[_0x40f34e(0x1fc)])return _0x1cf95d;var _0x246b35={};if(_0x1cf95d!=null){for(var _0x1ba3a6=_0x5d19cb(_0x1cf95d),_0xa160d9=0x0;_0xa160d9<_0x1ba3a6[_0x40f34e(0x1e0)];_0xa160d9++)if(_0x1ba3a6[_0xa160d9]!==_0x40f34e(0x213))__createBinding(_0x246b35,_0x1cf95d,_0x1ba3a6[_0xa160d9]);}return __setModuleDefault(_0x246b35,_0x1cf95d),_0x246b35;};}());function a4_0x1173(_0x2559c3,_0x26ae18){_0x2559c3=_0x2559c3-0x1df;const _0x5167d3=a4_0x5167();let _0x11737d=_0x5167d3[_0x2559c3];return _0x11737d;}Object[a4_0x53004d(0x211)](exports,a4_0x53004d(0x1fc),{'value':!![]}),exports[a4_0x53004d(0x206)]=void 0x0;const authService_1=require(a4_0x53004d(0x1fd)),tokenBlacklistService_1=require(a4_0x53004d(0x1e6)),telegramBotService_1=require(a4_0x53004d(0x207));function a4_0x5167(){const _0x3a539c=['../services/authService','get','AuthService','create','exp','__createBinding','connection','body','ipAddress','AuthController','../services/telegramBotService','tokenBlacklistService','prototype','getOwnPropertyDescriptor','2411100ayjkCr','configurable','6595BWpGjn','authService','__setModuleDefault','73833SoSMsn','defineProperty','unknown','default','writable','error','shop','role','18099YnXkYu','length','3040064LutQUC','login','432mEPlJu','findUnique','sendLoginNotification','../services/tokenBlacklistService','User-Agent','json','Failed\x20to\x20send\x20failed\x20login\x20notification:','blacklistToken','telegramBotService','username','user','getOwnPropertyNames','1910bIGgvL','24jwSYuw','logout','14ohhBLe','then','1120963abBryB','call','remoteAddress','geo','__importStar','18738357mwITLP','token','resolve','__esModule'];a4_0x5167=function(){return _0x3a539c;};return a4_0x5167();}class AuthController{constructor(){const _0x10bff0=a4_0x53004d;this[_0x10bff0(0x1e2)]=async(_0x4952a1,_0x59ce5a,_0x17c7eb)=>{const _0xb81779=_0x10bff0;try{const _0x207340=_0x4952a1[_0xb81779(0x204)],_0x48208f=_0x207340[_0xb81779(0x205)]||_0x4952a1['ip']||_0x4952a1[_0xb81779(0x203)][_0xb81779(0x1f6)]||_0xb81779(0x212),_0x1317b0=_0x207340['userAgent']||_0x4952a1[_0xb81779(0x1fe)](_0xb81779(0x1e7))||_0xb81779(0x212),_0x74a048=_0x207340[_0xb81779(0x1f7)];let _0xc4f0ab=![],_0x1815d3=null;try{const _0x455923=await this[_0xb81779(0x20e)]['login'](_0x207340);_0xc4f0ab=!![],_0x455923['role']==='shop'&&_0x455923[_0xb81779(0x1ed)]?.['id']&&(_0x1815d3=_0x455923['user']['id']),_0x1815d3&&await telegramBotService_1[_0xb81779(0x1eb)][_0xb81779(0x1e5)](_0x1815d3,{'username':_0x207340[_0xb81779(0x1ec)],'ipAddress':_0x48208f,'userAgent':_0x1317b0,'geo':_0x74a048,'timestamp':new Date(),'success':!![]}),_0x59ce5a[_0xb81779(0x1e8)]({'success':!![],'result':_0x455923});}catch(_0x57ba01){try{const _0x37b29c=(await Promise[_0xb81779(0x1fb)]()[_0xb81779(0x1f3)](()=>__importStar(require('../config/database'))))['default'],_0x4b357a=await _0x37b29c[_0xb81779(0x216)][_0xb81779(0x1e4)]({'where':{'username':_0x207340[_0xb81779(0x1ec)]},'select':{'id':!![]}});_0x4b357a&&await telegramBotService_1[_0xb81779(0x1eb)][_0xb81779(0x1e5)](_0x4b357a['id'],{'username':_0x207340[_0xb81779(0x1ec)],'ipAddress':_0x48208f,'userAgent':_0x1317b0,'geo':_0x74a048,'timestamp':new Date(),'success':![]});}catch(_0x2f59b7){console[_0xb81779(0x215)](_0xb81779(0x1e9),_0x2f59b7);}throw _0x57ba01;}}catch(_0x4d9689){_0x17c7eb(_0x4d9689);}},this['me']=async(_0x139c4a,_0x2d9db5,_0x5c012e)=>{const _0x4071d5=_0x10bff0;try{const _0x4aab80=_0x139c4a[_0x4071d5(0x1ed)];_0x2d9db5['json']({'success':!![],'result':{'id':_0x4aab80?.['id'],'username':_0x4aab80?.[_0x4071d5(0x1ec)],'role':_0x4aab80?.[_0x4071d5(0x217)]}});}catch(_0x1c1e51){_0x5c012e(_0x1c1e51);}},this[_0x10bff0(0x1f1)]=async(_0x1869c1,_0x37fba3,_0x502b69)=>{const _0x2d6592=_0x10bff0;try{const _0x6aa5d5=_0x1869c1[_0x2d6592(0x1fa)],_0x4a0e0d=_0x1869c1[_0x2d6592(0x1ed)];_0x6aa5d5&&_0x4a0e0d?.[_0x2d6592(0x201)]&&tokenBlacklistService_1[_0x2d6592(0x208)][_0x2d6592(0x1ea)](_0x6aa5d5,_0x4a0e0d['exp']),_0x37fba3[_0x2d6592(0x1e8)]({'success':!![],'message':'Logged\x20out\x20successfully'});}catch(_0x111a0e){_0x502b69(_0x111a0e);}},this['getBlacklistStats']=async(_0x3f3a0e,_0x4bfb45,_0x101a52)=>{const _0x1de80f=_0x10bff0;try{const _0xc57d01=tokenBlacklistService_1[_0x1de80f(0x208)]['getStats']();_0x4bfb45[_0x1de80f(0x1e8)]({'success':!![],'result':_0xc57d01});}catch(_0x4099da){_0x101a52(_0x4099da);}},this[_0x10bff0(0x20e)]=new authService_1[(_0x10bff0(0x1ff))]();}}exports[a4_0x53004d(0x206)]=AuthController;