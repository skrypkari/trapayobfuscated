'use strict';const a4_0x5478c8=a4_0x1c29;(function(_0x97553f,_0x20030f){const _0x31d4c4=a4_0x1c29,_0x495ab4=_0x97553f();while(!![]){try{const _0x141d0f=parseInt(_0x31d4c4(0x11b))/0x1+parseInt(_0x31d4c4(0x10d))/0x2*(-parseInt(_0x31d4c4(0xfe))/0x3)+-parseInt(_0x31d4c4(0xf3))/0x4*(parseInt(_0x31d4c4(0x10a))/0x5)+-parseInt(_0x31d4c4(0xfd))/0x6*(parseInt(_0x31d4c4(0x108))/0x7)+parseInt(_0x31d4c4(0x105))/0x8+-parseInt(_0x31d4c4(0x10f))/0x9*(-parseInt(_0x31d4c4(0x11f))/0xa)+-parseInt(_0x31d4c4(0x100))/0xb;if(_0x141d0f===_0x20030f)break;else _0x495ab4['push'](_0x495ab4['shift']());}catch(_0x3cc480){_0x495ab4['push'](_0x495ab4['shift']());}}}(a4_0xdd75,0xd4d57));function a4_0x1c29(_0x2a59d4,_0x586f68){const _0xdd75d8=a4_0xdd75();return a4_0x1c29=function(_0x1c29a5,_0x573e2e){_0x1c29a5=_0x1c29a5-0xed;let _0x3e9e69=_0xdd75d8[_0x1c29a5];return _0x3e9e69;},a4_0x1c29(_0x2a59d4,_0x586f68);}var __createBinding=this&&this[a4_0x5478c8(0xf0)]||(Object[a4_0x5478c8(0xf6)]?function(_0x5bd130,_0x590b08,_0x2d4524,_0x4daba8){const _0x208b2f=a4_0x5478c8;if(_0x4daba8===undefined)_0x4daba8=_0x2d4524;var _0x3a52e1=Object['getOwnPropertyDescriptor'](_0x590b08,_0x2d4524);(!_0x3a52e1||(_0x208b2f(0x107)in _0x3a52e1?!_0x590b08['__esModule']:_0x3a52e1[_0x208b2f(0x118)]||_0x3a52e1['configurable']))&&(_0x3a52e1={'enumerable':!![],'get':function(){return _0x590b08[_0x2d4524];}}),Object['defineProperty'](_0x5bd130,_0x4daba8,_0x3a52e1);}:function(_0xcde96b,_0x5a6502,_0x47d483,_0x29ba4f){if(_0x29ba4f===undefined)_0x29ba4f=_0x47d483;_0xcde96b[_0x29ba4f]=_0x5a6502[_0x47d483];}),__setModuleDefault=this&&this[a4_0x5478c8(0x113)]||(Object[a4_0x5478c8(0xf6)]?function(_0x8dc77a,_0x33614e){const _0x429c08=a4_0x5478c8;Object[_0x429c08(0x120)](_0x8dc77a,_0x429c08(0x102),{'enumerable':!![],'value':_0x33614e});}:function(_0x106c30,_0x413607){const _0xc34d00=a4_0x5478c8;_0x106c30[_0xc34d00(0x102)]=_0x413607;}),__importStar=this&&this[a4_0x5478c8(0xef)]||(function(){var _0x1c82f1=function(_0x51161e){const _0x52ec1f=a4_0x1c29;return _0x1c82f1=Object[_0x52ec1f(0xf8)]||function(_0x4c53d7){const _0x15e982=_0x52ec1f;var _0x275d34=[];for(var _0x53e400 in _0x4c53d7)if(Object[_0x15e982(0x115)][_0x15e982(0x119)][_0x15e982(0x116)](_0x4c53d7,_0x53e400))_0x275d34[_0x275d34[_0x15e982(0xfb)]]=_0x53e400;return _0x275d34;},_0x1c82f1(_0x51161e);};return function(_0x5d8789){const _0x4764cf=a4_0x1c29;if(_0x5d8789&&_0x5d8789['__esModule'])return _0x5d8789;var _0x576659={};if(_0x5d8789!=null){for(var _0x5a281c=_0x1c82f1(_0x5d8789),_0x424a64=0x0;_0x424a64<_0x5a281c['length'];_0x424a64++)if(_0x5a281c[_0x424a64]!==_0x4764cf(0x102))__createBinding(_0x576659,_0x5d8789,_0x5a281c[_0x424a64]);}return __setModuleDefault(_0x576659,_0x5d8789),_0x576659;};}());Object[a4_0x5478c8(0x120)](exports,a4_0x5478c8(0x10b),{'value':!![]}),exports[a4_0x5478c8(0xee)]=void 0x0;const authService_1=require(a4_0x5478c8(0x11a)),tokenBlacklistService_1=require(a4_0x5478c8(0x101)),telegramBotService_1=require(a4_0x5478c8(0x110));class AuthController{constructor(){const _0x45c9e8=a4_0x5478c8;this[_0x45c9e8(0x10c)]=async(_0xb8be53,_0x1d8af8,_0x4e4ff7)=>{const _0x225d1e=_0x45c9e8;try{const _0x21aa86=_0xb8be53[_0x225d1e(0x106)],_0x5b517d=_0xb8be53['ip']||_0xb8be53[_0x225d1e(0x103)]['remoteAddress']||'unknown',_0x14c7ed=_0xb8be53[_0x225d1e(0x107)](_0x225d1e(0x11e))||_0x225d1e(0xed);let _0x370de9=![],_0x301b1a=null;try{const _0x4976a8=await this[_0x225d1e(0x111)][_0x225d1e(0x10c)](_0x21aa86);_0x370de9=!![],_0x4976a8['role']===_0x225d1e(0xf7)&&_0x4976a8[_0x225d1e(0x104)]?.['id']&&(_0x301b1a=_0x4976a8[_0x225d1e(0x104)]['id']),_0x301b1a&&await telegramBotService_1[_0x225d1e(0xfa)]['sendLoginNotification'](_0x301b1a,{'username':_0x21aa86[_0x225d1e(0xf9)],'ipAddress':_0x5b517d,'userAgent':_0x14c7ed,'timestamp':new Date(),'success':!![]}),_0x1d8af8[_0x225d1e(0xfc)]({'success':!![],'result':_0x4976a8});}catch(_0xf47072){try{const _0x25e6a5=(await Promise[_0x225d1e(0x109)]()['then'](()=>__importStar(require(_0x225d1e(0x11c)))))['default'],_0x34bc4a=await _0x25e6a5[_0x225d1e(0xf7)]['findUnique']({'where':{'username':_0x21aa86[_0x225d1e(0xf9)]},'select':{'id':!![]}});_0x34bc4a&&await telegramBotService_1[_0x225d1e(0xfa)][_0x225d1e(0xf2)](_0x34bc4a['id'],{'username':_0x21aa86[_0x225d1e(0xf9)],'ipAddress':_0x5b517d,'userAgent':_0x14c7ed,'timestamp':new Date(),'success':![]});}catch(_0x4e1532){console[_0x225d1e(0x117)](_0x225d1e(0xf5),_0x4e1532);}throw _0xf47072;}}catch(_0x1efa7f){_0x4e4ff7(_0x1efa7f);}},this['me']=async(_0x487091,_0x54e89e,_0x3f9f38)=>{const _0x3788b5=_0x45c9e8;try{const _0x1d0694=_0x487091[_0x3788b5(0x104)];_0x54e89e[_0x3788b5(0xfc)]({'success':!![],'result':{'id':_0x1d0694?.['id'],'username':_0x1d0694?.[_0x3788b5(0xf9)],'role':_0x1d0694?.['role']}});}catch(_0xa7e4fc){_0x3f9f38(_0xa7e4fc);}},this[_0x45c9e8(0x10e)]=async(_0x443a36,_0x5ed5eb,_0x54c6d2)=>{const _0x3b7419=_0x45c9e8;try{const _0x389112=_0x443a36[_0x3b7419(0x11d)],_0x12ffea=_0x443a36[_0x3b7419(0x104)];_0x389112&&_0x12ffea?.[_0x3b7419(0x114)]&&tokenBlacklistService_1[_0x3b7419(0x112)]['blacklistToken'](_0x389112,_0x12ffea[_0x3b7419(0x114)]),_0x5ed5eb[_0x3b7419(0xfc)]({'success':!![],'message':_0x3b7419(0xff)});}catch(_0x577c20){_0x54c6d2(_0x577c20);}},this[_0x45c9e8(0xf4)]=async(_0x364259,_0x3503eb,_0x4e5b77)=>{const _0x5e54af=_0x45c9e8;try{const _0x48b052=tokenBlacklistService_1[_0x5e54af(0x112)]['getStats']();_0x3503eb[_0x5e54af(0xfc)]({'success':!![],'result':_0x48b052});}catch(_0x2bb93c){_0x4e5b77(_0x2bb93c);}},this[_0x45c9e8(0x111)]=new authService_1[(_0x45c9e8(0xf1))]();}}function a4_0xdd75(){const _0x2e595a=['AuthController','__importStar','__createBinding','AuthService','sendLoginNotification','932JfeCvc','getBlacklistStats','Failed\x20to\x20send\x20failed\x20login\x20notification:','create','shop','getOwnPropertyNames','username','telegramBotService','length','json','17106DzpDub','903bLQpiE','Logged\x20out\x20successfully','3211186EqcJaI','../services/tokenBlacklistService','default','connection','user','2611664YEhVZr','body','get','2135ZncnXX','resolve','11755btgeNX','__esModule','login','3022dmXeRX','logout','1172709zVRnkU','../services/telegramBotService','authService','tokenBlacklistService','__setModuleDefault','exp','prototype','call','error','writable','hasOwnProperty','../services/authService','1015471yQjhxg','../config/database','token','User-Agent','130JiFhZt','defineProperty','unknown'];a4_0xdd75=function(){return _0x2e595a;};return a4_0xdd75();}exports[a4_0x5478c8(0xee)]=AuthController;