'use strict';const a4_0x1f10ae=a4_0x16a8;(function(_0x1d00b0,_0xb970b0){const _0x142dd7=a4_0x16a8,_0x4406bf=_0x1d00b0();while(!![]){try{const _0x4d519b=-parseInt(_0x142dd7(0x1d4))/0x1*(-parseInt(_0x142dd7(0x1e3))/0x2)+parseInt(_0x142dd7(0x1cd))/0x3*(parseInt(_0x142dd7(0x1e0))/0x4)+-parseInt(_0x142dd7(0x1d8))/0x5*(parseInt(_0x142dd7(0x1bc))/0x6)+parseInt(_0x142dd7(0x1d0))/0x7+parseInt(_0x142dd7(0x1c1))/0x8+parseInt(_0x142dd7(0x1d7))/0x9+-parseInt(_0x142dd7(0x1c9))/0xa;if(_0x4d519b===_0xb970b0)break;else _0x4406bf['push'](_0x4406bf['shift']());}catch(_0x1622dd){_0x4406bf['push'](_0x4406bf['shift']());}}}(a4_0x4cd8,0xc11e4));function a4_0x16a8(_0x2c3d54,_0x23157f){const _0x4cd82a=a4_0x4cd8();return a4_0x16a8=function(_0x16a861,_0x152ea4){_0x16a861=_0x16a861-0x1b9;let _0x1650a0=_0x4cd82a[_0x16a861];return _0x1650a0;},a4_0x16a8(_0x2c3d54,_0x23157f);}var __createBinding=this&&this['__createBinding']||(Object['create']?function(_0x338bb7,_0x14fb6f,_0x3c40aa,_0x1e5c7b){const _0x2a69ff=a4_0x16a8;if(_0x1e5c7b===undefined)_0x1e5c7b=_0x3c40aa;var _0x5f0a41=Object[_0x2a69ff(0x1ce)](_0x14fb6f,_0x3c40aa);(!_0x5f0a41||(_0x2a69ff(0x1ca)in _0x5f0a41?!_0x14fb6f[_0x2a69ff(0x1d2)]:_0x5f0a41[_0x2a69ff(0x1cb)]||_0x5f0a41[_0x2a69ff(0x1bd)]))&&(_0x5f0a41={'enumerable':!![],'get':function(){return _0x14fb6f[_0x3c40aa];}}),Object['defineProperty'](_0x338bb7,_0x1e5c7b,_0x5f0a41);}:function(_0x279fc2,_0x2838f2,_0xa63b09,_0x3654ed){if(_0x3654ed===undefined)_0x3654ed=_0xa63b09;_0x279fc2[_0x3654ed]=_0x2838f2[_0xa63b09];}),__setModuleDefault=this&&this[a4_0x1f10ae(0x1e5)]||(Object['create']?function(_0x32bb7c,_0x52b359){const _0x4700d=a4_0x1f10ae;Object[_0x4700d(0x1be)](_0x32bb7c,_0x4700d(0x1d1),{'enumerable':!![],'value':_0x52b359});}:function(_0x5aaaa8,_0x5b2a8c){_0x5aaaa8['default']=_0x5b2a8c;}),__importStar=this&&this[a4_0x1f10ae(0x1c5)]||(function(){var _0x1eba88=function(_0x108637){return _0x1eba88=Object['getOwnPropertyNames']||function(_0x5ef557){const _0x496599=a4_0x16a8;var _0x200c8f=[];for(var _0x5f4266 in _0x5ef557)if(Object[_0x496599(0x1e1)][_0x496599(0x1bb)][_0x496599(0x1c3)](_0x5ef557,_0x5f4266))_0x200c8f[_0x200c8f['length']]=_0x5f4266;return _0x200c8f;},_0x1eba88(_0x108637);};return function(_0xa83666){const _0x13837e=a4_0x16a8;if(_0xa83666&&_0xa83666[_0x13837e(0x1d2)])return _0xa83666;var _0x4ddf55={};if(_0xa83666!=null){for(var _0x36043e=_0x1eba88(_0xa83666),_0x3e2b5c=0x0;_0x3e2b5c<_0x36043e[_0x13837e(0x1c2)];_0x3e2b5c++)if(_0x36043e[_0x3e2b5c]!==_0x13837e(0x1d1))__createBinding(_0x4ddf55,_0xa83666,_0x36043e[_0x3e2b5c]);}return __setModuleDefault(_0x4ddf55,_0xa83666),_0x4ddf55;};}());Object[a4_0x1f10ae(0x1be)](exports,a4_0x1f10ae(0x1d2),{'value':!![]}),exports['AuthController']=void 0x0;const authService_1=require('../services/authService'),tokenBlacklistService_1=require(a4_0x1f10ae(0x1db)),telegramBotService_1=require(a4_0x1f10ae(0x1d5));class AuthController{constructor(){const _0x38a9b7=a4_0x1f10ae;this['login']=async(_0x156dcb,_0x371592,_0x23a58a)=>{const _0x104758=a4_0x16a8;try{const _0xf7542e=_0x156dcb['body'],_0xd9d36b=_0x156dcb['ip']||_0x156dcb[_0x104758(0x1df)][_0x104758(0x1cc)]||_0x104758(0x1b9),_0x276790=_0x156dcb['get']('User-Agent')||_0x104758(0x1b9);let _0x42e9c3=![],_0x58db6f=null;try{const _0xd3be41=await this[_0x104758(0x1c8)]['login'](_0xf7542e);_0x42e9c3=!![],_0xd3be41[_0x104758(0x1d3)]==='shop'&&_0xd3be41['user']?.['id']&&(_0x58db6f=_0xd3be41[_0x104758(0x1e6)]['id']),_0x58db6f&&await telegramBotService_1[_0x104758(0x1c7)][_0x104758(0x1bf)](_0x58db6f,{'username':_0xf7542e[_0x104758(0x1c4)],'ipAddress':_0xd9d36b,'userAgent':_0x276790,'timestamp':new Date(),'success':!![]}),_0x371592[_0x104758(0x1d6)]({'success':!![],'result':_0xd3be41});}catch(_0x5b048a){try{const _0x5ea3db=(await Promise[_0x104758(0x1e2)]()[_0x104758(0x1e7)](()=>__importStar(require(_0x104758(0x1e4)))))[_0x104758(0x1d1)],_0xd8bd4=await _0x5ea3db['shop'][_0x104758(0x1dc)]({'where':{'username':_0xf7542e[_0x104758(0x1c4)]},'select':{'id':!![]}});_0xd8bd4&&await telegramBotService_1['telegramBotService']['sendLoginNotification'](_0xd8bd4['id'],{'username':_0xf7542e[_0x104758(0x1c4)],'ipAddress':_0xd9d36b,'userAgent':_0x276790,'timestamp':new Date(),'success':![]});}catch(_0x174a6d){console['error'](_0x104758(0x1de),_0x174a6d);}throw _0x5b048a;}}catch(_0x27803a){_0x23a58a(_0x27803a);}},this['me']=async(_0x386b28,_0x1d50e2,_0x426773)=>{const _0xeb647d=a4_0x16a8;try{const _0x38e8c6=_0x386b28[_0xeb647d(0x1e6)];_0x1d50e2[_0xeb647d(0x1d6)]({'success':!![],'result':{'id':_0x38e8c6?.['id'],'username':_0x38e8c6?.[_0xeb647d(0x1c4)],'role':_0x38e8c6?.[_0xeb647d(0x1d3)]}});}catch(_0x27bae7){_0x426773(_0x27bae7);}},this[_0x38a9b7(0x1d9)]=async(_0x167dd3,_0x46c313,_0x418170)=>{const _0x22f365=_0x38a9b7;try{const _0x28d399=_0x167dd3[_0x22f365(0x1cf)],_0x1a06f9=_0x167dd3['user'];_0x28d399&&_0x1a06f9?.[_0x22f365(0x1da)]&&tokenBlacklistService_1[_0x22f365(0x1ba)][_0x22f365(0x1c0)](_0x28d399,_0x1a06f9[_0x22f365(0x1da)]),_0x46c313[_0x22f365(0x1d6)]({'success':!![],'message':'Logged\x20out\x20successfully'});}catch(_0x4e8545){_0x418170(_0x4e8545);}},this['getBlacklistStats']=async(_0x168375,_0x3b0e1b,_0x2eb82a)=>{const _0x5baeeb=_0x38a9b7;try{const _0x634a65=tokenBlacklistService_1[_0x5baeeb(0x1ba)]['getStats']();_0x3b0e1b[_0x5baeeb(0x1d6)]({'success':!![],'result':_0x634a65});}catch(_0x1d3710){_0x2eb82a(_0x1d3710);}},this[_0x38a9b7(0x1c8)]=new authService_1[(_0x38a9b7(0x1dd))]();}}function a4_0x4cd8(){const _0x4f632d=['205cOJqae','logout','exp','../services/tokenBlacklistService','findUnique','AuthService','Failed\x20to\x20send\x20failed\x20login\x20notification:','connection','1131380bIkyeG','prototype','resolve','2150452BlzQuL','../config/database','__setModuleDefault','user','then','unknown','tokenBlacklistService','hasOwnProperty','48588EFpYCk','configurable','defineProperty','sendLoginNotification','blacklistToken','5986208wqlnoG','length','call','username','__importStar','AuthController','telegramBotService','authService','19954410szTsLr','get','writable','remoteAddress','3lTbgqm','getOwnPropertyDescriptor','token','3794063vHvLIu','default','__esModule','role','1FpAhOL','../services/telegramBotService','json','4231035zDLtzl'];a4_0x4cd8=function(){return _0x4f632d;};return a4_0x4cd8();}exports[a4_0x1f10ae(0x1c6)]=AuthController;