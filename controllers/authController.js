'use strict';function a4_0x2904(){const _0x1f0cec=['__esModule','__setModuleDefault','4iZdnqM','getBlacklistStats','__importStar','70720iNtSkt','login','126368dlvWjD','logout','call','../services/tokenBlacklistService','body','AuthService','error','5768DqdGWW','json','resolve','User-Agent','connection','user','../services/authService','prototype','blacklistToken','username','AuthController','defineProperty','unknown','configurable','role','2227239VQoGhk','10482lMAZsJ','sendLoginNotification','shop','5121awXVQV','684iSJeTB','1280736sHpwpx','getStats','length','../config/database','Failed\x20to\x20send\x20failed\x20login\x20notification:','../services/telegramBotService','tokenBlacklistService','190bKupPn','146261QlwSDH','exp','default','get','authService','getOwnPropertyNames','telegramBotService','findUnique','3YHbSVH','create','remoteAddress'];a4_0x2904=function(){return _0x1f0cec;};return a4_0x2904();}const a4_0x3f89ed=a4_0xc1a8;(function(_0x5cb2ad,_0xac5d40){const _0x327044=a4_0xc1a8,_0x4d874a=_0x5cb2ad();while(!![]){try{const _0x39daf4=-parseInt(_0x327044(0x117))/0x1*(parseInt(_0x327044(0x124))/0x2)+-parseInt(_0x327044(0x11f))/0x3*(parseInt(_0x327044(0x10f))/0x4)+-parseInt(_0x327044(0x116))/0x5*(-parseInt(_0x327044(0x10a))/0x6)+-parseInt(_0x327044(0x109))/0x7+parseInt(_0x327044(0xfa))/0x8*(parseInt(_0x327044(0x10d))/0x9)+parseInt(_0x327044(0x127))/0xa+parseInt(_0x327044(0x129))/0xb*(parseInt(_0x327044(0x10e))/0xc);if(_0x39daf4===_0xac5d40)break;else _0x4d874a['push'](_0x4d874a['shift']());}catch(_0x229e7f){_0x4d874a['push'](_0x4d874a['shift']());}}}(a4_0x2904,0x32b18));var __createBinding=this&&this['__createBinding']||(Object[a4_0x3f89ed(0x120)]?function(_0xe54e0c,_0xa1c658,_0x5f54da,_0x4d0840){const _0x5ee300=a4_0x3f89ed;if(_0x4d0840===undefined)_0x4d0840=_0x5f54da;var _0x45d963=Object['getOwnPropertyDescriptor'](_0xa1c658,_0x5f54da);(!_0x45d963||(_0x5ee300(0x11a)in _0x45d963?!_0xa1c658[_0x5ee300(0x122)]:_0x45d963['writable']||_0x45d963[_0x5ee300(0x107)]))&&(_0x45d963={'enumerable':!![],'get':function(){return _0xa1c658[_0x5f54da];}}),Object[_0x5ee300(0x105)](_0xe54e0c,_0x4d0840,_0x45d963);}:function(_0x33d909,_0x4042f3,_0x30676c,_0x5e2080){if(_0x5e2080===undefined)_0x5e2080=_0x30676c;_0x33d909[_0x5e2080]=_0x4042f3[_0x30676c];}),__setModuleDefault=this&&this[a4_0x3f89ed(0x123)]||(Object[a4_0x3f89ed(0x120)]?function(_0x39017a,_0x39781e){const _0x2091e2=a4_0x3f89ed;Object[_0x2091e2(0x105)](_0x39017a,_0x2091e2(0x119),{'enumerable':!![],'value':_0x39781e});}:function(_0x2c8e11,_0x3cf3b5){const _0x4a0fcb=a4_0x3f89ed;_0x2c8e11[_0x4a0fcb(0x119)]=_0x3cf3b5;}),__importStar=this&&this[a4_0x3f89ed(0x126)]||(function(){var _0xed271b=function(_0x53f9f1){const _0x238c42=a4_0xc1a8;return _0xed271b=Object[_0x238c42(0x11c)]||function(_0x572c92){const _0x154104=_0x238c42;var _0x143321=[];for(var _0x1e3b54 in _0x572c92)if(Object[_0x154104(0x101)]['hasOwnProperty'][_0x154104(0x12b)](_0x572c92,_0x1e3b54))_0x143321[_0x143321[_0x154104(0x111)]]=_0x1e3b54;return _0x143321;},_0xed271b(_0x53f9f1);};return function(_0x24550d){const _0x2cc5ce=a4_0xc1a8;if(_0x24550d&&_0x24550d[_0x2cc5ce(0x122)])return _0x24550d;var _0x207013={};if(_0x24550d!=null){for(var _0x5f3cd5=_0xed271b(_0x24550d),_0x15ef6a=0x0;_0x15ef6a<_0x5f3cd5['length'];_0x15ef6a++)if(_0x5f3cd5[_0x15ef6a]!=='default')__createBinding(_0x207013,_0x24550d,_0x5f3cd5[_0x15ef6a]);}return __setModuleDefault(_0x207013,_0x24550d),_0x207013;};}());Object[a4_0x3f89ed(0x105)](exports,'__esModule',{'value':!![]}),exports[a4_0x3f89ed(0x104)]=void 0x0;function a4_0xc1a8(_0x2607d5,_0x14b090){const _0x2904ca=a4_0x2904();return a4_0xc1a8=function(_0xc1a873,_0xc52802){_0xc1a873=_0xc1a873-0xf9;let _0x4ae4a3=_0x2904ca[_0xc1a873];return _0x4ae4a3;},a4_0xc1a8(_0x2607d5,_0x14b090);}const authService_1=require(a4_0x3f89ed(0x100)),tokenBlacklistService_1=require(a4_0x3f89ed(0x12c)),telegramBotService_1=require(a4_0x3f89ed(0x114));class AuthController{constructor(){const _0x283177=a4_0x3f89ed;this[_0x283177(0x128)]=async(_0x4cfbe0,_0x56b250,_0xa6f5c)=>{const _0x1655b6=_0x283177;try{const _0x1f945f=_0x4cfbe0[_0x1655b6(0x12d)],_0x2b2039=_0x4cfbe0['ip']||_0x4cfbe0[_0x1655b6(0xfe)][_0x1655b6(0x121)]||_0x1655b6(0x106),_0x32ad68=_0x4cfbe0[_0x1655b6(0x11a)](_0x1655b6(0xfd))||_0x1655b6(0x106);let _0x36216f=![],_0x411c87=null;try{const _0x431f80=await this['authService'][_0x1655b6(0x128)](_0x1f945f);_0x36216f=!![],_0x431f80[_0x1655b6(0x108)]===_0x1655b6(0x10c)&&_0x431f80['user']?.['id']&&(_0x411c87=_0x431f80[_0x1655b6(0xff)]['id']),_0x411c87&&await telegramBotService_1[_0x1655b6(0x11d)]['sendLoginNotification'](_0x411c87,{'username':_0x1f945f[_0x1655b6(0x103)],'ipAddress':_0x2b2039,'userAgent':_0x32ad68,'timestamp':new Date(),'success':!![]}),_0x56b250['json']({'success':!![],'result':_0x431f80});}catch(_0x5e9c77){try{const _0x397552=(await Promise[_0x1655b6(0xfc)]()['then'](()=>__importStar(require(_0x1655b6(0x112)))))[_0x1655b6(0x119)],_0x1fcf8c=await _0x397552[_0x1655b6(0x10c)][_0x1655b6(0x11e)]({'where':{'username':_0x1f945f[_0x1655b6(0x103)]},'select':{'id':!![]}});_0x1fcf8c&&await telegramBotService_1[_0x1655b6(0x11d)][_0x1655b6(0x10b)](_0x1fcf8c['id'],{'username':_0x1f945f[_0x1655b6(0x103)],'ipAddress':_0x2b2039,'userAgent':_0x32ad68,'timestamp':new Date(),'success':![]});}catch(_0x37f3fa){console[_0x1655b6(0xf9)](_0x1655b6(0x113),_0x37f3fa);}throw _0x5e9c77;}}catch(_0x3652c2){_0xa6f5c(_0x3652c2);}},this['me']=async(_0x488c88,_0xb9c3e2,_0x55aa3a)=>{const _0x2a7b8f=_0x283177;try{const _0x1d757e=_0x488c88[_0x2a7b8f(0xff)];_0xb9c3e2[_0x2a7b8f(0xfb)]({'success':!![],'result':{'id':_0x1d757e?.['id'],'username':_0x1d757e?.['username'],'role':_0x1d757e?.[_0x2a7b8f(0x108)]}});}catch(_0x15e269){_0x55aa3a(_0x15e269);}},this[_0x283177(0x12a)]=async(_0x166d2b,_0x5e89ca,_0x46297a)=>{const _0x1cf06f=_0x283177;try{const _0x533bf8=_0x166d2b['token'],_0x5e6aab=_0x166d2b[_0x1cf06f(0xff)];_0x533bf8&&_0x5e6aab?.['exp']&&tokenBlacklistService_1[_0x1cf06f(0x115)][_0x1cf06f(0x102)](_0x533bf8,_0x5e6aab[_0x1cf06f(0x118)]),_0x5e89ca['json']({'success':!![],'message':'Logged\x20out\x20successfully'});}catch(_0x1157ae){_0x46297a(_0x1157ae);}},this[_0x283177(0x125)]=async(_0x4552a5,_0x41aa15,_0x1e9624)=>{const _0x1cad24=_0x283177;try{const _0x317903=tokenBlacklistService_1[_0x1cad24(0x115)][_0x1cad24(0x110)]();_0x41aa15['json']({'success':!![],'result':_0x317903});}catch(_0x3f5708){_0x1e9624(_0x3f5708);}},this[_0x283177(0x11b)]=new authService_1[(_0x283177(0x12e))]();}}exports[a4_0x3f89ed(0x104)]=AuthController;