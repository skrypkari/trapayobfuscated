'use strict';const a4_0x1740f7=a4_0x1b00;(function(_0x49bdac,_0x2b1048){const _0x36cae4=a4_0x1b00,_0x5f2153=_0x49bdac();while(!![]){try{const _0x376d66=parseInt(_0x36cae4(0xa0))/0x1+parseInt(_0x36cae4(0x87))/0x2*(parseInt(_0x36cae4(0x9d))/0x3)+parseInt(_0x36cae4(0xa2))/0x4+-parseInt(_0x36cae4(0xad))/0x5*(-parseInt(_0x36cae4(0x9e))/0x6)+parseInt(_0x36cae4(0x82))/0x7*(parseInt(_0x36cae4(0xae))/0x8)+parseInt(_0x36cae4(0x93))/0x9+-parseInt(_0x36cae4(0x83))/0xa*(parseInt(_0x36cae4(0x86))/0xb);if(_0x376d66===_0x2b1048)break;else _0x5f2153['push'](_0x5f2153['shift']());}catch(_0x5cb7c7){_0x5f2153['push'](_0x5f2153['shift']());}}}(a4_0x26dd,0xe5037));function a4_0x1b00(_0x53503c,_0x3637d1){const _0x26dd6a=a4_0x26dd();return a4_0x1b00=function(_0x1b0065,_0x28a3aa){_0x1b0065=_0x1b0065-0x82;let _0x50e0cc=_0x26dd6a[_0x1b0065];return _0x50e0cc;},a4_0x1b00(_0x53503c,_0x3637d1);}var __createBinding=this&&this['__createBinding']||(Object[a4_0x1740f7(0xac)]?function(_0x20ea65,_0x5daab1,_0x1bd7e9,_0x1d696a){const _0x21488d=a4_0x1740f7;if(_0x1d696a===undefined)_0x1d696a=_0x1bd7e9;var _0x62c353=Object[_0x21488d(0x92)](_0x5daab1,_0x1bd7e9);(!_0x62c353||(_0x21488d(0x99)in _0x62c353?!_0x5daab1[_0x21488d(0x9a)]:_0x62c353[_0x21488d(0x9c)]||_0x62c353[_0x21488d(0xab)]))&&(_0x62c353={'enumerable':!![],'get':function(){return _0x5daab1[_0x1bd7e9];}}),Object['defineProperty'](_0x20ea65,_0x1d696a,_0x62c353);}:function(_0x17e622,_0x4eac64,_0x4d86a9,_0x26a8c1){if(_0x26a8c1===undefined)_0x26a8c1=_0x4d86a9;_0x17e622[_0x26a8c1]=_0x4eac64[_0x4d86a9];}),__setModuleDefault=this&&this[a4_0x1740f7(0x91)]||(Object['create']?function(_0x476985,_0x558bdb){Object['defineProperty'](_0x476985,'default',{'enumerable':!![],'value':_0x558bdb});}:function(_0xf7fa1d,_0x52cff0){_0xf7fa1d['default']=_0x52cff0;}),__importStar=this&&this[a4_0x1740f7(0x8b)]||(function(){var _0x319a9e=function(_0x13a108){return _0x319a9e=Object['getOwnPropertyNames']||function(_0x57c5a8){const _0xcd52db=a4_0x1b00;var _0xf47c74=[];for(var _0x349759 in _0x57c5a8)if(Object[_0xcd52db(0x84)][_0xcd52db(0xa3)][_0xcd52db(0xb4)](_0x57c5a8,_0x349759))_0xf47c74[_0xf47c74['length']]=_0x349759;return _0xf47c74;},_0x319a9e(_0x13a108);};return function(_0x546da2){const _0x507c1d=a4_0x1b00;if(_0x546da2&&_0x546da2[_0x507c1d(0x9a)])return _0x546da2;var _0x18ddb9={};if(_0x546da2!=null){for(var _0xe2d8e6=_0x319a9e(_0x546da2),_0xb573a0=0x0;_0xb573a0<_0xe2d8e6[_0x507c1d(0xa6)];_0xb573a0++)if(_0xe2d8e6[_0xb573a0]!==_0x507c1d(0x8e))__createBinding(_0x18ddb9,_0x546da2,_0xe2d8e6[_0xb573a0]);}return __setModuleDefault(_0x18ddb9,_0x546da2),_0x18ddb9;};}());function a4_0x26dd(){const _0xbb4d0b=['defineProperty','../services/telegramBotService','Logged\x20out\x20successfully','tokenBlacklistService','call','8813jclHgP','38650fVDFEb','prototype','resolve','6831Ucdvav','771980CCzPMX','exp','logout','user','__importStar','sendLoginNotification','authService','default','connection','getStats','__setModuleDefault','getOwnPropertyDescriptor','5258511RyofDb','then','../services/tokenBlacklistService','AuthController','token','User-Agent','get','__esModule','unknown','writable','3JNgFaG','911418CyCLyw','blacklistToken','54953QSsseR','username','1117632OwCZgq','hasOwnProperty','json','telegramBotService','length','getBlacklistStats','error','login','shop','configurable','create','40nkYCgS','5200gQeoIc','../config/database'];a4_0x26dd=function(){return _0xbb4d0b;};return a4_0x26dd();}Object[a4_0x1740f7(0xb0)](exports,'__esModule',{'value':!![]}),exports[a4_0x1740f7(0x96)]=void 0x0;const authService_1=require('../services/authService'),tokenBlacklistService_1=require(a4_0x1740f7(0x95)),telegramBotService_1=require(a4_0x1740f7(0xb1));class AuthController{constructor(){const _0x539cf2=a4_0x1740f7;this[_0x539cf2(0xa9)]=async(_0x11a9bc,_0x431f1e,_0x319f6d)=>{const _0x5ef512=_0x539cf2;try{const _0x3424b9=_0x11a9bc['body'],_0x349ca9=_0x11a9bc['ip']||_0x11a9bc[_0x5ef512(0x8f)]['remoteAddress']||_0x5ef512(0x9b),_0x36c547=_0x11a9bc['get'](_0x5ef512(0x98))||'unknown';let _0x11cd98=![],_0x1baf99=null;try{const _0x2e1640=await this[_0x5ef512(0x8d)][_0x5ef512(0xa9)](_0x3424b9);_0x11cd98=!![],_0x2e1640['role']===_0x5ef512(0xaa)&&_0x2e1640[_0x5ef512(0x8a)]?.['id']&&(_0x1baf99=_0x2e1640[_0x5ef512(0x8a)]['id']),_0x1baf99&&await telegramBotService_1[_0x5ef512(0xa5)][_0x5ef512(0x8c)](_0x1baf99,{'username':_0x3424b9[_0x5ef512(0xa1)],'ipAddress':_0x349ca9,'userAgent':_0x36c547,'timestamp':new Date(),'success':!![]}),_0x431f1e['json']({'success':!![],'result':_0x2e1640});}catch(_0x26f643){try{const _0x487751=(await Promise[_0x5ef512(0x85)]()[_0x5ef512(0x94)](()=>__importStar(require(_0x5ef512(0xaf)))))[_0x5ef512(0x8e)],_0x133ee9=await _0x487751['shop']['findUnique']({'where':{'username':_0x3424b9[_0x5ef512(0xa1)]},'select':{'id':!![]}});_0x133ee9&&await telegramBotService_1[_0x5ef512(0xa5)][_0x5ef512(0x8c)](_0x133ee9['id'],{'username':_0x3424b9[_0x5ef512(0xa1)],'ipAddress':_0x349ca9,'userAgent':_0x36c547,'timestamp':new Date(),'success':![]});}catch(_0x33e7f0){console[_0x5ef512(0xa8)]('Failed\x20to\x20send\x20failed\x20login\x20notification:',_0x33e7f0);}throw _0x26f643;}}catch(_0x49d6e5){_0x319f6d(_0x49d6e5);}},this['me']=async(_0x3142d0,_0x251eeb,_0x517aaa)=>{const _0x48b44e=_0x539cf2;try{const _0x4e72f1=_0x3142d0[_0x48b44e(0x8a)];_0x251eeb[_0x48b44e(0xa4)]({'success':!![],'result':{'id':_0x4e72f1?.['id'],'username':_0x4e72f1?.[_0x48b44e(0xa1)],'role':_0x4e72f1?.['role']}});}catch(_0x37b5d7){_0x517aaa(_0x37b5d7);}},this[_0x539cf2(0x89)]=async(_0x2fdd65,_0x5f21e8,_0x3a10b1)=>{const _0x414020=_0x539cf2;try{const _0x6fbab6=_0x2fdd65[_0x414020(0x97)],_0x478e55=_0x2fdd65[_0x414020(0x8a)];_0x6fbab6&&_0x478e55?.['exp']&&tokenBlacklistService_1['tokenBlacklistService'][_0x414020(0x9f)](_0x6fbab6,_0x478e55[_0x414020(0x88)]),_0x5f21e8[_0x414020(0xa4)]({'success':!![],'message':_0x414020(0xb2)});}catch(_0x544303){_0x3a10b1(_0x544303);}},this[_0x539cf2(0xa7)]=async(_0x52af0a,_0x283eed,_0x49068c)=>{const _0x227853=_0x539cf2;try{const _0x38d055=tokenBlacklistService_1[_0x227853(0xb3)][_0x227853(0x90)]();_0x283eed[_0x227853(0xa4)]({'success':!![],'result':_0x38d055});}catch(_0x28f43e){_0x49068c(_0x28f43e);}},this[_0x539cf2(0x8d)]=new authService_1['AuthService']();}}exports[a4_0x1740f7(0x96)]=AuthController;