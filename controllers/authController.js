'use strict';const a4_0x2954eb=a4_0x5684;function a4_0x120b(){const _0x5e8396=['tokenBlacklistService','200260oQVOOs','shop','__esModule','142705YLHLxT','../services/authService','json','blacklistToken','25322550TWVLgi','length','exp','resolve','role','437659qAjrrB','120SDnHPU','writable','1616skhNrJ','then','__setModuleDefault','getBlacklistStats','sendLoginNotification','hasOwnProperty','connection','defineProperty','32628bsCPSM','authService','create','prototype','default','geo','get','body','User-Agent','telegramBotService','unknown','getOwnPropertyDescriptor','508DwfCOm','47619LyNLab','getOwnPropertyNames','Logged\x20out\x20successfully','Failed\x20to\x20send\x20failed\x20login\x20notification:','../services/tokenBlacklistService','login','user','__importStar','userAgent','AuthService','AuthController','username','getStats','configurable','error','../services/telegramBotService','6122368KCdSgL','remoteAddress'];a4_0x120b=function(){return _0x5e8396;};return a4_0x120b();}(function(_0x5def75,_0x1485b8){const _0x3e3c58=a4_0x5684,_0x40c9ab=_0x5def75();while(!![]){try{const _0x566104=-parseInt(_0x3e3c58(0x116))/0x1+-parseInt(_0x3e3c58(0x141))/0x2+parseInt(_0x3e3c58(0x121))/0x3*(-parseInt(_0x3e3c58(0x12d))/0x4)+-parseInt(_0x3e3c58(0x144))/0x5*(-parseInt(_0x3e3c58(0x117))/0x6)+parseInt(_0x3e3c58(0x13e))/0x7+parseInt(_0x3e3c58(0x119))/0x8*(-parseInt(_0x3e3c58(0x12e))/0x9)+parseInt(_0x3e3c58(0x148))/0xa;if(_0x566104===_0x1485b8)break;else _0x40c9ab['push'](_0x40c9ab['shift']());}catch(_0x1dcd2d){_0x40c9ab['push'](_0x40c9ab['shift']());}}}(a4_0x120b,0xf1ab4));var __createBinding=this&&this['__createBinding']||(Object['create']?function(_0x168149,_0x38320a,_0x3723bc,_0x5dfba1){const _0x15e43a=a4_0x5684;if(_0x5dfba1===undefined)_0x5dfba1=_0x3723bc;var _0x41920e=Object[_0x15e43a(0x12c)](_0x38320a,_0x3723bc);(!_0x41920e||(_0x15e43a(0x127)in _0x41920e?!_0x38320a[_0x15e43a(0x143)]:_0x41920e[_0x15e43a(0x118)]||_0x41920e[_0x15e43a(0x13b)]))&&(_0x41920e={'enumerable':!![],'get':function(){return _0x38320a[_0x3723bc];}}),Object[_0x15e43a(0x120)](_0x168149,_0x5dfba1,_0x41920e);}:function(_0x4fa17a,_0x4f0081,_0xbb6588,_0x40518b){if(_0x40518b===undefined)_0x40518b=_0xbb6588;_0x4fa17a[_0x40518b]=_0x4f0081[_0xbb6588];}),__setModuleDefault=this&&this[a4_0x2954eb(0x11b)]||(Object[a4_0x2954eb(0x123)]?function(_0x36853d,_0x343b9d){const _0x34798f=a4_0x2954eb;Object[_0x34798f(0x120)](_0x36853d,_0x34798f(0x125),{'enumerable':!![],'value':_0x343b9d});}:function(_0x33a2b9,_0x384f05){_0x33a2b9['default']=_0x384f05;}),__importStar=this&&this[a4_0x2954eb(0x135)]||(function(){var _0x2dc14b=function(_0x467ed8){const _0x236646=a4_0x5684;return _0x2dc14b=Object[_0x236646(0x12f)]||function(_0x1d1950){const _0x4b4295=_0x236646;var _0x2a2116=[];for(var _0x276280 in _0x1d1950)if(Object[_0x4b4295(0x124)][_0x4b4295(0x11e)]['call'](_0x1d1950,_0x276280))_0x2a2116[_0x2a2116['length']]=_0x276280;return _0x2a2116;},_0x2dc14b(_0x467ed8);};return function(_0x3db111){const _0x27217c=a4_0x5684;if(_0x3db111&&_0x3db111[_0x27217c(0x143)])return _0x3db111;var _0x46cc67={};if(_0x3db111!=null){for(var _0x1f049b=_0x2dc14b(_0x3db111),_0x39ff76=0x0;_0x39ff76<_0x1f049b[_0x27217c(0x149)];_0x39ff76++)if(_0x1f049b[_0x39ff76]!==_0x27217c(0x125))__createBinding(_0x46cc67,_0x3db111,_0x1f049b[_0x39ff76]);}return __setModuleDefault(_0x46cc67,_0x3db111),_0x46cc67;};}());function a4_0x5684(_0x198882,_0x58fb9d){_0x198882=_0x198882-0x115;const _0x120b91=a4_0x120b();let _0x5684a0=_0x120b91[_0x198882];return _0x5684a0;}Object[a4_0x2954eb(0x120)](exports,a4_0x2954eb(0x143),{'value':!![]}),exports[a4_0x2954eb(0x138)]=void 0x0;const authService_1=require(a4_0x2954eb(0x145)),tokenBlacklistService_1=require(a4_0x2954eb(0x132)),telegramBotService_1=require(a4_0x2954eb(0x13d));class AuthController{constructor(){const _0x3b4882=a4_0x2954eb;this[_0x3b4882(0x133)]=async(_0x2a0c69,_0x27d1d7,_0x39e054)=>{const _0x34fcea=_0x3b4882;try{const _0x3077c5=_0x2a0c69[_0x34fcea(0x128)],_0x3c30d3=_0x3077c5['ipAddress']||_0x2a0c69['ip']||_0x2a0c69[_0x34fcea(0x11f)][_0x34fcea(0x13f)]||_0x34fcea(0x12b),_0x543f60=_0x3077c5[_0x34fcea(0x136)]||_0x2a0c69[_0x34fcea(0x127)](_0x34fcea(0x129))||_0x34fcea(0x12b),_0x5811b0=_0x3077c5[_0x34fcea(0x126)];let _0x2ce8fc=![],_0xe01da7=null;try{const _0x4714e9=await this[_0x34fcea(0x122)][_0x34fcea(0x133)](_0x3077c5);_0x2ce8fc=!![],_0x4714e9[_0x34fcea(0x115)]===_0x34fcea(0x142)&&_0x4714e9[_0x34fcea(0x134)]?.['id']&&(_0xe01da7=_0x4714e9[_0x34fcea(0x134)]['id']),_0xe01da7&&await telegramBotService_1[_0x34fcea(0x12a)]['sendLoginNotification'](_0xe01da7,{'username':_0x3077c5[_0x34fcea(0x139)],'ipAddress':_0x3c30d3,'userAgent':_0x543f60,'geo':_0x5811b0,'timestamp':new Date(),'success':!![]}),_0x27d1d7[_0x34fcea(0x146)]({'success':!![],'result':_0x4714e9});}catch(_0x16e910){try{const _0x47cb17=(await Promise[_0x34fcea(0x14b)]()[_0x34fcea(0x11a)](()=>__importStar(require('../config/database'))))[_0x34fcea(0x125)],_0x438dbd=await _0x47cb17[_0x34fcea(0x142)]['findUnique']({'where':{'username':_0x3077c5['username']},'select':{'id':!![]}});_0x438dbd&&await telegramBotService_1[_0x34fcea(0x12a)][_0x34fcea(0x11d)](_0x438dbd['id'],{'username':_0x3077c5['username'],'ipAddress':_0x3c30d3,'userAgent':_0x543f60,'geo':_0x5811b0,'timestamp':new Date(),'success':![]});}catch(_0x23af25){console[_0x34fcea(0x13c)](_0x34fcea(0x131),_0x23af25);}throw _0x16e910;}}catch(_0x65f253){_0x39e054(_0x65f253);}},this['me']=async(_0x37c8fb,_0x381e2f,_0xf1fa2f)=>{const _0x56c505=_0x3b4882;try{const _0x5798a3=_0x37c8fb[_0x56c505(0x134)];_0x381e2f[_0x56c505(0x146)]({'success':!![],'result':{'id':_0x5798a3?.['id'],'username':_0x5798a3?.[_0x56c505(0x139)],'role':_0x5798a3?.[_0x56c505(0x115)]}});}catch(_0x366cc3){_0xf1fa2f(_0x366cc3);}},this['logout']=async(_0x4c1a88,_0x52d7b3,_0x5638eb)=>{const _0x9e452f=_0x3b4882;try{const _0x1186c2=_0x4c1a88['token'],_0x18ad3d=_0x4c1a88[_0x9e452f(0x134)];_0x1186c2&&_0x18ad3d?.[_0x9e452f(0x14a)]&&tokenBlacklistService_1['tokenBlacklistService'][_0x9e452f(0x147)](_0x1186c2,_0x18ad3d[_0x9e452f(0x14a)]),_0x52d7b3[_0x9e452f(0x146)]({'success':!![],'message':_0x9e452f(0x130)});}catch(_0x37bf87){_0x5638eb(_0x37bf87);}},this[_0x3b4882(0x11c)]=async(_0x1dffa8,_0x4050c7,_0x239c78)=>{const _0xe0b5d6=_0x3b4882;try{const _0x29133c=tokenBlacklistService_1[_0xe0b5d6(0x140)][_0xe0b5d6(0x13a)]();_0x4050c7['json']({'success':!![],'result':_0x29133c});}catch(_0x3bd3a3){_0x239c78(_0x3bd3a3);}},this[_0x3b4882(0x122)]=new authService_1[(_0x3b4882(0x137))]();}}exports[a4_0x2954eb(0x138)]=AuthController;