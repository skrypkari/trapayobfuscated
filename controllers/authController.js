'use strict';const a4_0xb0d678=a4_0x55f9;(function(_0x311ac5,_0x374c87){const _0x248e50=a4_0x55f9,_0x2a3790=_0x311ac5();while(!![]){try{const _0x4dc352=parseInt(_0x248e50(0x9b))/0x1+-parseInt(_0x248e50(0xc1))/0x2*(-parseInt(_0x248e50(0xad))/0x3)+parseInt(_0x248e50(0x95))/0x4*(parseInt(_0x248e50(0xb9))/0x5)+parseInt(_0x248e50(0x96))/0x6+parseInt(_0x248e50(0xae))/0x7*(parseInt(_0x248e50(0xc2))/0x8)+-parseInt(_0x248e50(0xaa))/0x9+parseInt(_0x248e50(0x97))/0xa*(-parseInt(_0x248e50(0xa0))/0xb);if(_0x4dc352===_0x374c87)break;else _0x2a3790['push'](_0x2a3790['shift']());}catch(_0x8b1f0f){_0x2a3790['push'](_0x2a3790['shift']());}}}(a4_0x2b5c,0x68f5f));function a4_0x2b5c(){const _0x27e01b=['configurable','__importStar','getOwnPropertyDescriptor','../config/database','Failed\x20to\x20send\x20failed\x20login\x20notification:','unknown','prototype','18lxQhpT','4804680tRGqEf','length','role','error','default','8befQiu','358440OhZcrp','110bZEiVQ','user','hasOwnProperty','findUnique','702200taxYyb','blacklistToken','remoteAddress','../services/telegramBotService','then','1107128EkGgLl','defineProperty','create','call','username','authService','AuthController','resolve','json','exp','4392963qdSKYq','sendLoginNotification','body','208605bzcvJn','7ngOxfF','shop','telegramBotService','User-Agent','tokenBlacklistService','../services/tokenBlacklistService','writable','get','__esModule','login','geo','92035QwIJrF'];a4_0x2b5c=function(){return _0x27e01b;};return a4_0x2b5c();}var __createBinding=this&&this['__createBinding']||(Object['create']?function(_0x3f60c8,_0x493cb6,_0x1da7ba,_0x5cbcf6){const _0x504f49=a4_0x55f9;if(_0x5cbcf6===undefined)_0x5cbcf6=_0x1da7ba;var _0x48e435=Object[_0x504f49(0xbc)](_0x493cb6,_0x1da7ba);(!_0x48e435||('get'in _0x48e435?!_0x493cb6[_0x504f49(0xb6)]:_0x48e435[_0x504f49(0xb4)]||_0x48e435[_0x504f49(0xba)]))&&(_0x48e435={'enumerable':!![],'get':function(){return _0x493cb6[_0x1da7ba];}}),Object['defineProperty'](_0x3f60c8,_0x5cbcf6,_0x48e435);}:function(_0x2e5902,_0x4c9782,_0x3e105e,_0x311c94){if(_0x311c94===undefined)_0x311c94=_0x3e105e;_0x2e5902[_0x311c94]=_0x4c9782[_0x3e105e];}),__setModuleDefault=this&&this['__setModuleDefault']||(Object[a4_0xb0d678(0xa2)]?function(_0x5811ed,_0x338a26){const _0x1502c6=a4_0xb0d678;Object[_0x1502c6(0xa1)](_0x5811ed,_0x1502c6(0x94),{'enumerable':!![],'value':_0x338a26});}:function(_0xeb44ba,_0xe47a6e){const _0x51ec19=a4_0xb0d678;_0xeb44ba[_0x51ec19(0x94)]=_0xe47a6e;}),__importStar=this&&this[a4_0xb0d678(0xbb)]||(function(){var _0x520a68=function(_0x540b6b){return _0x520a68=Object['getOwnPropertyNames']||function(_0x5208b4){const _0x73fed3=a4_0x55f9;var _0x35f575=[];for(var _0x18d2e3 in _0x5208b4)if(Object[_0x73fed3(0xc0)][_0x73fed3(0x99)][_0x73fed3(0xa3)](_0x5208b4,_0x18d2e3))_0x35f575[_0x35f575[_0x73fed3(0xc3)]]=_0x18d2e3;return _0x35f575;},_0x520a68(_0x540b6b);};return function(_0xcaa190){const _0x1330fd=a4_0x55f9;if(_0xcaa190&&_0xcaa190['__esModule'])return _0xcaa190;var _0x1444ac={};if(_0xcaa190!=null){for(var _0x132b10=_0x520a68(_0xcaa190),_0x86bcff=0x0;_0x86bcff<_0x132b10[_0x1330fd(0xc3)];_0x86bcff++)if(_0x132b10[_0x86bcff]!==_0x1330fd(0x94))__createBinding(_0x1444ac,_0xcaa190,_0x132b10[_0x86bcff]);}return __setModuleDefault(_0x1444ac,_0xcaa190),_0x1444ac;};}());function a4_0x55f9(_0x3bc6bd,_0x17be92){const _0x2b5c47=a4_0x2b5c();return a4_0x55f9=function(_0x55f918,_0xd98fc2){_0x55f918=_0x55f918-0x94;let _0x48597b=_0x2b5c47[_0x55f918];return _0x48597b;},a4_0x55f9(_0x3bc6bd,_0x17be92);}Object['defineProperty'](exports,a4_0xb0d678(0xb6),{'value':!![]}),exports[a4_0xb0d678(0xa6)]=void 0x0;const authService_1=require('../services/authService'),tokenBlacklistService_1=require(a4_0xb0d678(0xb3)),telegramBotService_1=require(a4_0xb0d678(0x9e));class AuthController{constructor(){const _0x12b9c=a4_0xb0d678;this['login']=async(_0x409236,_0x4d794e,_0x365613)=>{const _0x13e725=a4_0x55f9;try{const _0x1906c0=_0x409236[_0x13e725(0xac)],_0x5b95f8=_0x1906c0['ipAddress']||_0x409236['ip']||_0x409236['connection'][_0x13e725(0x9d)]||'unknown',_0x32f867=_0x1906c0['userAgent']||_0x409236[_0x13e725(0xb5)](_0x13e725(0xb1))||_0x13e725(0xbf),_0x109b4c=_0x1906c0[_0x13e725(0xb8)];let _0xf909f2=![],_0x264778=null;try{const _0x2aaec8=await this[_0x13e725(0xa5)][_0x13e725(0xb7)](_0x1906c0);_0xf909f2=!![],_0x2aaec8[_0x13e725(0xc4)]===_0x13e725(0xaf)&&_0x2aaec8['user']?.['id']&&(_0x264778=_0x2aaec8[_0x13e725(0x98)]['id']),_0x264778&&await telegramBotService_1['telegramBotService'][_0x13e725(0xab)](_0x264778,{'username':_0x1906c0['username'],'ipAddress':_0x5b95f8,'userAgent':_0x32f867,'geo':_0x109b4c,'timestamp':new Date(),'success':!![]}),_0x4d794e[_0x13e725(0xa8)]({'success':!![],'result':_0x2aaec8});}catch(_0x29d914){try{const _0x5cf296=(await Promise[_0x13e725(0xa7)]()[_0x13e725(0x9f)](()=>__importStar(require(_0x13e725(0xbd)))))['default'],_0x11179c=await _0x5cf296[_0x13e725(0xaf)][_0x13e725(0x9a)]({'where':{'username':_0x1906c0[_0x13e725(0xa4)]},'select':{'id':!![]}});_0x11179c&&await telegramBotService_1[_0x13e725(0xb0)][_0x13e725(0xab)](_0x11179c['id'],{'username':_0x1906c0[_0x13e725(0xa4)],'ipAddress':_0x5b95f8,'userAgent':_0x32f867,'geo':_0x109b4c,'timestamp':new Date(),'success':![]});}catch(_0x227b57){console[_0x13e725(0xc5)](_0x13e725(0xbe),_0x227b57);}throw _0x29d914;}}catch(_0xcec895){_0x365613(_0xcec895);}},this['me']=async(_0x285df4,_0x4ce7a1,_0x468b1e)=>{const _0xdd3d8c=a4_0x55f9;try{const _0x439545=_0x285df4[_0xdd3d8c(0x98)];_0x4ce7a1[_0xdd3d8c(0xa8)]({'success':!![],'result':{'id':_0x439545?.['id'],'username':_0x439545?.['username'],'role':_0x439545?.[_0xdd3d8c(0xc4)]}});}catch(_0x252e36){_0x468b1e(_0x252e36);}},this['logout']=async(_0x20417b,_0x3d17b3,_0x967dbd)=>{const _0x13e4a8=a4_0x55f9;try{const _0x4ce154=_0x20417b['token'],_0x39e85f=_0x20417b[_0x13e4a8(0x98)];_0x4ce154&&_0x39e85f?.[_0x13e4a8(0xa9)]&&tokenBlacklistService_1[_0x13e4a8(0xb2)][_0x13e4a8(0x9c)](_0x4ce154,_0x39e85f[_0x13e4a8(0xa9)]),_0x3d17b3[_0x13e4a8(0xa8)]({'success':!![],'message':'Logged\x20out\x20successfully'});}catch(_0x432abd){_0x967dbd(_0x432abd);}},this['getBlacklistStats']=async(_0x3ba6c2,_0x30b64b,_0x33751d)=>{const _0x1f86cb=a4_0x55f9;try{const _0x5c856b=tokenBlacklistService_1['tokenBlacklistService']['getStats']();_0x30b64b[_0x1f86cb(0xa8)]({'success':!![],'result':_0x5c856b});}catch(_0x16d2c7){_0x33751d(_0x16d2c7);}},this[_0x12b9c(0xa5)]=new authService_1['AuthService']();}}exports['AuthController']=AuthController;