'use strict';function a4_0x5396(){const _0x390569=['connection','resolve','logout','default','get','70uyIInj','findUnique','username','length','telegramBotService','shop','exp','620917uAtqzR','16xjTiKC','737174TkoYNd','__importStar','unknown','tokenBlacklistService','545411bwPsjv','10wZvPuo','configurable','AuthService','role','user','User-Agent','AuthController','63436DgCRlu','getStats','defineProperty','body','../config/database','../services/telegramBotService','error','login','__esModule','getOwnPropertyNames','../services/tokenBlacklistService','blacklistToken','token','452305blKTyf','getBlacklistStats','2283852ycxjaS','then','remoteAddress','396774JdYrKO','json','42FpuzzG','sendLoginNotification','writable'];a4_0x5396=function(){return _0x390569;};return a4_0x5396();}const a4_0x56cb66=a4_0x50c5;(function(_0x702f0b,_0x4a481c){const _0x15ce6b=a4_0x50c5,_0x13bf4e=_0x702f0b();while(!![]){try{const _0x33fedb=-parseInt(_0x15ce6b(0xbb))/0x1+parseInt(_0x15ce6b(0xb7))/0x2+-parseInt(_0x15ce6b(0xa6))/0x3*(-parseInt(_0x15ce6b(0xc3))/0x4)+parseInt(_0x15ce6b(0xbc))/0x5*(parseInt(_0x15ce6b(0xa1))/0x6)+-parseInt(_0x15ce6b(0x9f))/0x7*(-parseInt(_0x15ce6b(0xb6))/0x8)+parseInt(_0x15ce6b(0xa4))/0x9+parseInt(_0x15ce6b(0xae))/0xa*(-parseInt(_0x15ce6b(0xb5))/0xb);if(_0x33fedb===_0x4a481c)break;else _0x13bf4e['push'](_0x13bf4e['shift']());}catch(_0x4432d6){_0x13bf4e['push'](_0x13bf4e['shift']());}}}(a4_0x5396,0x8ebe1));var __createBinding=this&&this['__createBinding']||(Object['create']?function(_0x5d2c96,_0x56dae4,_0x5007de,_0xb24529){const _0x2f8245=a4_0x50c5;if(_0xb24529===undefined)_0xb24529=_0x5007de;var _0x631a77=Object['getOwnPropertyDescriptor'](_0x56dae4,_0x5007de);(!_0x631a77||(_0x2f8245(0xad)in _0x631a77?!_0x56dae4[_0x2f8245(0x9a)]:_0x631a77[_0x2f8245(0xa8)]||_0x631a77[_0x2f8245(0xbd)]))&&(_0x631a77={'enumerable':!![],'get':function(){return _0x56dae4[_0x5007de];}}),Object[_0x2f8245(0xc5)](_0x5d2c96,_0xb24529,_0x631a77);}:function(_0x229fce,_0x366df5,_0x4fc0cc,_0x3ddba6){if(_0x3ddba6===undefined)_0x3ddba6=_0x4fc0cc;_0x229fce[_0x3ddba6]=_0x366df5[_0x4fc0cc];}),__setModuleDefault=this&&this['__setModuleDefault']||(Object['create']?function(_0x3154cd,_0x3c11a1){const _0x4f3129=a4_0x50c5;Object[_0x4f3129(0xc5)](_0x3154cd,_0x4f3129(0xac),{'enumerable':!![],'value':_0x3c11a1});}:function(_0x3a1845,_0x53e810){const _0x452f7a=a4_0x50c5;_0x3a1845[_0x452f7a(0xac)]=_0x53e810;}),__importStar=this&&this[a4_0x56cb66(0xb8)]||(function(){var _0x143f5a=function(_0x7cf4b2){const _0x1fc82f=a4_0x50c5;return _0x143f5a=Object[_0x1fc82f(0x9b)]||function(_0x51b5f7){const _0x586857=_0x1fc82f;var _0x3a0a0f=[];for(var _0x5e4a99 in _0x51b5f7)if(Object['prototype']['hasOwnProperty']['call'](_0x51b5f7,_0x5e4a99))_0x3a0a0f[_0x3a0a0f[_0x586857(0xb1)]]=_0x5e4a99;return _0x3a0a0f;},_0x143f5a(_0x7cf4b2);};return function(_0x5b0357){const _0x515a55=a4_0x50c5;if(_0x5b0357&&_0x5b0357[_0x515a55(0x9a)])return _0x5b0357;var _0x104d69={};if(_0x5b0357!=null){for(var _0xa79eab=_0x143f5a(_0x5b0357),_0x33cca8=0x0;_0x33cca8<_0xa79eab['length'];_0x33cca8++)if(_0xa79eab[_0x33cca8]!==_0x515a55(0xac))__createBinding(_0x104d69,_0x5b0357,_0xa79eab[_0x33cca8]);}return __setModuleDefault(_0x104d69,_0x5b0357),_0x104d69;};}());Object[a4_0x56cb66(0xc5)](exports,a4_0x56cb66(0x9a),{'value':!![]}),exports[a4_0x56cb66(0xc2)]=void 0x0;const authService_1=require('../services/authService'),tokenBlacklistService_1=require(a4_0x56cb66(0x9c)),telegramBotService_1=require(a4_0x56cb66(0xc8));function a4_0x50c5(_0x1246c1,_0x5bc99f){const _0x53960d=a4_0x5396();return a4_0x50c5=function(_0x50c56e,_0x82e050){_0x50c56e=_0x50c56e-0x99;let _0x53f064=_0x53960d[_0x50c56e];return _0x53f064;},a4_0x50c5(_0x1246c1,_0x5bc99f);}class AuthController{constructor(){const _0xf04205=a4_0x56cb66;this[_0xf04205(0x99)]=async(_0x4de707,_0x398b29,_0x457543)=>{const _0x2ff24d=_0xf04205;try{const _0x271e5b=_0x4de707[_0x2ff24d(0xc6)],_0x39adec=_0x4de707['ip']||_0x4de707[_0x2ff24d(0xa9)][_0x2ff24d(0xa3)]||_0x2ff24d(0xb9),_0x5caa57=_0x4de707[_0x2ff24d(0xad)](_0x2ff24d(0xc1))||_0x2ff24d(0xb9);let _0x167db8=![],_0x587f4d=null;try{const _0x115c25=await this['authService']['login'](_0x271e5b);_0x167db8=!![],_0x115c25[_0x2ff24d(0xbf)]===_0x2ff24d(0xb3)&&_0x115c25[_0x2ff24d(0xc0)]?.['id']&&(_0x587f4d=_0x115c25[_0x2ff24d(0xc0)]['id']),_0x587f4d&&await telegramBotService_1['telegramBotService'][_0x2ff24d(0xa7)](_0x587f4d,{'username':_0x271e5b[_0x2ff24d(0xb0)],'ipAddress':_0x39adec,'userAgent':_0x5caa57,'timestamp':new Date(),'success':!![]}),_0x398b29[_0x2ff24d(0xa5)]({'success':!![],'result':_0x115c25});}catch(_0x151bec){try{const _0x312c2e=(await Promise[_0x2ff24d(0xaa)]()[_0x2ff24d(0xa2)](()=>__importStar(require(_0x2ff24d(0xc7)))))[_0x2ff24d(0xac)],_0x400bcf=await _0x312c2e[_0x2ff24d(0xb3)][_0x2ff24d(0xaf)]({'where':{'username':_0x271e5b['username']},'select':{'id':!![]}});_0x400bcf&&await telegramBotService_1[_0x2ff24d(0xb2)]['sendLoginNotification'](_0x400bcf['id'],{'username':_0x271e5b[_0x2ff24d(0xb0)],'ipAddress':_0x39adec,'userAgent':_0x5caa57,'timestamp':new Date(),'success':![]});}catch(_0x20f9d6){console[_0x2ff24d(0xc9)]('Failed\x20to\x20send\x20failed\x20login\x20notification:',_0x20f9d6);}throw _0x151bec;}}catch(_0x58f61a){_0x457543(_0x58f61a);}},this['me']=async(_0x2130e8,_0x4a343b,_0x2c094c)=>{const _0xec3e0d=_0xf04205;try{const _0x318213=_0x2130e8[_0xec3e0d(0xc0)];_0x4a343b[_0xec3e0d(0xa5)]({'success':!![],'result':{'id':_0x318213?.['id'],'username':_0x318213?.['username'],'role':_0x318213?.[_0xec3e0d(0xbf)]}});}catch(_0x3d6c17){_0x2c094c(_0x3d6c17);}},this[_0xf04205(0xab)]=async(_0x451e53,_0x5622e9,_0x49a592)=>{const _0x299a83=_0xf04205;try{const _0x506401=_0x451e53[_0x299a83(0x9e)],_0xf0a72c=_0x451e53[_0x299a83(0xc0)];_0x506401&&_0xf0a72c?.['exp']&&tokenBlacklistService_1['tokenBlacklistService'][_0x299a83(0x9d)](_0x506401,_0xf0a72c[_0x299a83(0xb4)]),_0x5622e9[_0x299a83(0xa5)]({'success':!![],'message':'Logged\x20out\x20successfully'});}catch(_0x2b3a3b){_0x49a592(_0x2b3a3b);}},this[_0xf04205(0xa0)]=async(_0x3614bb,_0x3a5ad6,_0x37670f)=>{const _0x1fa106=_0xf04205;try{const _0x49fe08=tokenBlacklistService_1[_0x1fa106(0xba)][_0x1fa106(0xc4)]();_0x3a5ad6[_0x1fa106(0xa5)]({'success':!![],'result':_0x49fe08});}catch(_0x30d661){_0x37670f(_0x30d661);}},this['authService']=new authService_1[(_0xf04205(0xbe))]();}}exports[a4_0x56cb66(0xc2)]=AuthController;