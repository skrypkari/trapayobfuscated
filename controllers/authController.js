'use strict';const a4_0x34d30c=a4_0x36d5;(function(_0x519f3a,_0x4ab6a5){const _0x13e3cc=a4_0x36d5,_0x151241=_0x519f3a();while(!![]){try{const _0x18c567=parseInt(_0x13e3cc(0xea))/0x1+parseInt(_0x13e3cc(0x112))/0x2+parseInt(_0x13e3cc(0x10c))/0x3+parseInt(_0x13e3cc(0xe7))/0x4*(parseInt(_0x13e3cc(0x117))/0x5)+parseInt(_0x13e3cc(0x115))/0x6*(parseInt(_0x13e3cc(0xfb))/0x7)+parseInt(_0x13e3cc(0x109))/0x8+parseInt(_0x13e3cc(0xfe))/0x9*(-parseInt(_0x13e3cc(0xe8))/0xa);if(_0x18c567===_0x4ab6a5)break;else _0x151241['push'](_0x151241['shift']());}catch(_0xfa2e7d){_0x151241['push'](_0x151241['shift']());}}}(a4_0x312e,0x41922));var __createBinding=this&&this[a4_0x34d30c(0xef)]||(Object[a4_0x34d30c(0x105)]?function(_0x501c36,_0x5b895d,_0x55838a,_0x36824c){const _0x45d3c9=a4_0x34d30c;if(_0x36824c===undefined)_0x36824c=_0x55838a;var _0xf781f6=Object[_0x45d3c9(0x103)](_0x5b895d,_0x55838a);(!_0xf781f6||(_0x45d3c9(0x108)in _0xf781f6?!_0x5b895d['__esModule']:_0xf781f6[_0x45d3c9(0xe6)]||_0xf781f6[_0x45d3c9(0x110)]))&&(_0xf781f6={'enumerable':!![],'get':function(){return _0x5b895d[_0x55838a];}}),Object[_0x45d3c9(0x10e)](_0x501c36,_0x36824c,_0xf781f6);}:function(_0x5df0e4,_0x39983f,_0x3f45ac,_0x671573){if(_0x671573===undefined)_0x671573=_0x3f45ac;_0x5df0e4[_0x671573]=_0x39983f[_0x3f45ac];}),__setModuleDefault=this&&this[a4_0x34d30c(0x102)]||(Object[a4_0x34d30c(0x105)]?function(_0x228ebb,_0x454537){const _0x350521=a4_0x34d30c;Object[_0x350521(0x10e)](_0x228ebb,'default',{'enumerable':!![],'value':_0x454537});}:function(_0x1ad7c5,_0x288583){const _0x7c4fc2=a4_0x34d30c;_0x1ad7c5[_0x7c4fc2(0xf3)]=_0x288583;}),__importStar=this&&this[a4_0x34d30c(0xf9)]||(function(){var _0x5655cb=function(_0x3b1049){const _0x38feab=a4_0x36d5;return _0x5655cb=Object[_0x38feab(0xe5)]||function(_0x3827b2){const _0x3d73dd=_0x38feab;var _0x4c85da=[];for(var _0x477b58 in _0x3827b2)if(Object['prototype'][_0x3d73dd(0xfc)][_0x3d73dd(0x10f)](_0x3827b2,_0x477b58))_0x4c85da[_0x4c85da['length']]=_0x477b58;return _0x4c85da;},_0x5655cb(_0x3b1049);};return function(_0x96834f){const _0x3521c6=a4_0x36d5;if(_0x96834f&&_0x96834f[_0x3521c6(0x10a)])return _0x96834f;var _0xf422cd={};if(_0x96834f!=null){for(var _0x24089b=_0x5655cb(_0x96834f),_0x26bbf3=0x0;_0x26bbf3<_0x24089b['length'];_0x26bbf3++)if(_0x24089b[_0x26bbf3]!=='default')__createBinding(_0xf422cd,_0x96834f,_0x24089b[_0x26bbf3]);}return __setModuleDefault(_0xf422cd,_0x96834f),_0xf422cd;};}());Object[a4_0x34d30c(0x10e)](exports,a4_0x34d30c(0x10a),{'value':!![]}),exports[a4_0x34d30c(0x106)]=void 0x0;const authService_1=require(a4_0x34d30c(0x111)),tokenBlacklistService_1=require(a4_0x34d30c(0x101)),telegramBotService_1=require(a4_0x34d30c(0x116));function a4_0x36d5(_0x52c337,_0x5b0b54){const _0x312e70=a4_0x312e();return a4_0x36d5=function(_0x36d58d,_0x190731){_0x36d58d=_0x36d58d-0xe5;let _0x558c21=_0x312e70[_0x36d58d];return _0x558c21;},a4_0x36d5(_0x52c337,_0x5b0b54);}function a4_0x312e(){const _0xc42616=['94716SJwfTG','AuthService','resolve','../services/tokenBlacklistService','__setModuleDefault','getOwnPropertyDescriptor','unknown','create','AuthController','tokenBlacklistService','get','2431200EXaqKQ','__esModule','shop','569454aRQcmZ','token','defineProperty','call','configurable','../services/authService','316820GRGfMl','error','logout','12HEVhVo','../services/telegramBotService','5RVqVTo','role','sendLoginNotification','getOwnPropertyNames','writable','1049104NzjkaW','1180QEFPPT','../config/database','115020CuTwHz','user','json','getBlacklistStats','authService','__createBinding','login','connection','body','default','User-Agent','exp','getStats','remoteAddress','username','__importStar','then','1683451VqZBbf','hasOwnProperty','telegramBotService'];a4_0x312e=function(){return _0xc42616;};return a4_0x312e();}class AuthController{constructor(){const _0x10dd63=a4_0x34d30c;this[_0x10dd63(0xf0)]=async(_0x40fd74,_0x1cd399,_0x1c4d64)=>{const _0x3db132=_0x10dd63;try{const _0x121ef7=_0x40fd74[_0x3db132(0xf2)],_0x39f674=_0x40fd74['ip']||_0x40fd74[_0x3db132(0xf1)][_0x3db132(0xf7)]||_0x3db132(0x104),_0x3e7b8e=_0x40fd74[_0x3db132(0x108)](_0x3db132(0xf4))||_0x3db132(0x104);let _0x570219=![],_0x51b723=null;try{const _0x30dfa3=await this[_0x3db132(0xee)][_0x3db132(0xf0)](_0x121ef7);_0x570219=!![],_0x30dfa3[_0x3db132(0x118)]===_0x3db132(0x10b)&&_0x30dfa3['user']?.['id']&&(_0x51b723=_0x30dfa3[_0x3db132(0xeb)]['id']),_0x51b723&&await telegramBotService_1[_0x3db132(0xfd)][_0x3db132(0x119)](_0x51b723,{'username':_0x121ef7[_0x3db132(0xf8)],'ipAddress':_0x39f674,'userAgent':_0x3e7b8e,'timestamp':new Date(),'success':!![]}),_0x1cd399[_0x3db132(0xec)]({'success':!![],'result':_0x30dfa3});}catch(_0x176b9e){try{const _0x400491=(await Promise[_0x3db132(0x100)]()[_0x3db132(0xfa)](()=>__importStar(require(_0x3db132(0xe9)))))[_0x3db132(0xf3)],_0x751f6a=await _0x400491[_0x3db132(0x10b)]['findUnique']({'where':{'username':_0x121ef7[_0x3db132(0xf8)]},'select':{'id':!![]}});_0x751f6a&&await telegramBotService_1[_0x3db132(0xfd)]['sendLoginNotification'](_0x751f6a['id'],{'username':_0x121ef7[_0x3db132(0xf8)],'ipAddress':_0x39f674,'userAgent':_0x3e7b8e,'timestamp':new Date(),'success':![]});}catch(_0x474cf8){console[_0x3db132(0x113)]('Failed\x20to\x20send\x20failed\x20login\x20notification:',_0x474cf8);}throw _0x176b9e;}}catch(_0x43d902){_0x1c4d64(_0x43d902);}},this['me']=async(_0x1e6695,_0x3cb43d,_0x2175e0)=>{const _0x17bea8=_0x10dd63;try{const _0x3525d5=_0x1e6695[_0x17bea8(0xeb)];_0x3cb43d[_0x17bea8(0xec)]({'success':!![],'result':{'id':_0x3525d5?.['id'],'username':_0x3525d5?.[_0x17bea8(0xf8)],'role':_0x3525d5?.[_0x17bea8(0x118)]}});}catch(_0x5a5d5f){_0x2175e0(_0x5a5d5f);}},this[_0x10dd63(0x114)]=async(_0x45f744,_0x28d926,_0xfa0385)=>{const _0x332a0e=_0x10dd63;try{const _0x6244df=_0x45f744[_0x332a0e(0x10d)],_0xf8ff54=_0x45f744[_0x332a0e(0xeb)];_0x6244df&&_0xf8ff54?.[_0x332a0e(0xf5)]&&tokenBlacklistService_1[_0x332a0e(0x107)]['blacklistToken'](_0x6244df,_0xf8ff54['exp']),_0x28d926[_0x332a0e(0xec)]({'success':!![],'message':'Logged\x20out\x20successfully'});}catch(_0x3573ed){_0xfa0385(_0x3573ed);}},this[_0x10dd63(0xed)]=async(_0x8029f2,_0xf07976,_0x3db817)=>{const _0x236aeb=_0x10dd63;try{const _0x45357a=tokenBlacklistService_1['tokenBlacklistService'][_0x236aeb(0xf6)]();_0xf07976[_0x236aeb(0xec)]({'success':!![],'result':_0x45357a});}catch(_0x36ede8){_0x3db817(_0x36ede8);}},this['authService']=new authService_1[(_0x10dd63(0xff))]();}}exports['AuthController']=AuthController;