'use strict';const a4_0x4ab732=a4_0x50a7;function a4_0x4b8d(){const _0x3da9f9=['telegramBotService','../services/tokenBlacklistService','connection','126891HQEUSE','User-Agent','3728285KXZRQV','312885FduXvw','AuthService','user','getBlacklistStats','__importStar','configurable','role','1846632HUTDvT','default','AuthController','__setModuleDefault','username','8374100nUQhtI','writable','token','2RVxLCs','then','65292ifMqgy','authService','ipAddress','exp','get','../config/database','create','__esModule','shop','defineProperty','getOwnPropertyNames','json','136BNBiPP','tokenBlacklistService','sendLoginNotification','body','434GqxBBo','__createBinding','Logged\x20out\x20successfully','remoteAddress','153998WgBOBX','resolve','prototype','blacklistToken','length','logout','login'];a4_0x4b8d=function(){return _0x3da9f9;};return a4_0x4b8d();}(function(_0x207e2e,_0x2b13ce){const _0x2e569e=a4_0x50a7,_0x58f675=_0x207e2e();while(!![]){try{const _0x253a7f=parseInt(_0x2e569e(0xf0))/0x1*(parseInt(_0x2e569e(0xda))/0x2)+parseInt(_0x2e569e(0xfd))/0x3+-parseInt(_0x2e569e(0xd2))/0x4+-parseInt(_0x2e569e(0xfc))/0x5+parseInt(_0x2e569e(0xdc))/0x6*(parseInt(_0x2e569e(0xec))/0x7)+parseInt(_0x2e569e(0xe8))/0x8*(parseInt(_0x2e569e(0xfa))/0x9)+parseInt(_0x2e569e(0xd7))/0xa;if(_0x253a7f===_0x2b13ce)break;else _0x58f675['push'](_0x58f675['shift']());}catch(_0x4283f3){_0x58f675['push'](_0x58f675['shift']());}}}(a4_0x4b8d,0xc3fc3));var __createBinding=this&&this[a4_0x4ab732(0xed)]||(Object['create']?function(_0x3dfc57,_0x263fe4,_0x44f4bf,_0x20ed20){const _0x3d1c70=a4_0x4ab732;if(_0x20ed20===undefined)_0x20ed20=_0x44f4bf;var _0x3358db=Object['getOwnPropertyDescriptor'](_0x263fe4,_0x44f4bf);(!_0x3358db||('get'in _0x3358db?!_0x263fe4[_0x3d1c70(0xe3)]:_0x3358db[_0x3d1c70(0xd8)]||_0x3358db[_0x3d1c70(0xd0)]))&&(_0x3358db={'enumerable':!![],'get':function(){return _0x263fe4[_0x44f4bf];}}),Object[_0x3d1c70(0xe5)](_0x3dfc57,_0x20ed20,_0x3358db);}:function(_0x317bbc,_0x13ed3d,_0x1ac70c,_0x424e8a){if(_0x424e8a===undefined)_0x424e8a=_0x1ac70c;_0x317bbc[_0x424e8a]=_0x13ed3d[_0x1ac70c];}),__setModuleDefault=this&&this[a4_0x4ab732(0xd5)]||(Object[a4_0x4ab732(0xe2)]?function(_0x1be685,_0x39f2db){const _0x41fec8=a4_0x4ab732;Object[_0x41fec8(0xe5)](_0x1be685,_0x41fec8(0xd3),{'enumerable':!![],'value':_0x39f2db});}:function(_0x406ad8,_0x2c4b05){const _0x3e4c4e=a4_0x4ab732;_0x406ad8[_0x3e4c4e(0xd3)]=_0x2c4b05;}),__importStar=this&&this[a4_0x4ab732(0xcf)]||(function(){var _0x22ecb6=function(_0x1bbd14){const _0x5c9b4d=a4_0x50a7;return _0x22ecb6=Object[_0x5c9b4d(0xe6)]||function(_0x3db8e5){const _0x58c4f0=_0x5c9b4d;var _0x3da8df=[];for(var _0x1d9d6a in _0x3db8e5)if(Object[_0x58c4f0(0xf2)]['hasOwnProperty']['call'](_0x3db8e5,_0x1d9d6a))_0x3da8df[_0x3da8df[_0x58c4f0(0xf4)]]=_0x1d9d6a;return _0x3da8df;},_0x22ecb6(_0x1bbd14);};return function(_0x25f34f){const _0x47bd1d=a4_0x50a7;if(_0x25f34f&&_0x25f34f[_0x47bd1d(0xe3)])return _0x25f34f;var _0x332ca4={};if(_0x25f34f!=null){for(var _0xe3924b=_0x22ecb6(_0x25f34f),_0x10308f=0x0;_0x10308f<_0xe3924b['length'];_0x10308f++)if(_0xe3924b[_0x10308f]!==_0x47bd1d(0xd3))__createBinding(_0x332ca4,_0x25f34f,_0xe3924b[_0x10308f]);}return __setModuleDefault(_0x332ca4,_0x25f34f),_0x332ca4;};}());Object['defineProperty'](exports,a4_0x4ab732(0xe3),{'value':!![]}),exports[a4_0x4ab732(0xd4)]=void 0x0;function a4_0x50a7(_0x31e12c,_0x26b62d){_0x31e12c=_0x31e12c-0xcf;const _0x4b8d4b=a4_0x4b8d();let _0x50a733=_0x4b8d4b[_0x31e12c];return _0x50a733;}const authService_1=require('../services/authService'),tokenBlacklistService_1=require(a4_0x4ab732(0xf8)),telegramBotService_1=require('../services/telegramBotService');class AuthController{constructor(){const _0x5e7111=a4_0x4ab732;this[_0x5e7111(0xf6)]=async(_0x531761,_0x1a204a,_0x28bbc4)=>{const _0x109e34=_0x5e7111;try{const _0x142e88=_0x531761[_0x109e34(0xeb)],_0x20f923=_0x142e88[_0x109e34(0xde)]||_0x531761['ip']||_0x531761[_0x109e34(0xf9)][_0x109e34(0xef)]||'unknown',_0x4e5c65=_0x142e88['userAgent']||_0x531761[_0x109e34(0xe0)](_0x109e34(0xfb))||'unknown',_0x124994=_0x142e88['geo'];let _0x44ade7=![],_0x519df3=null;try{const _0x14c3cb=await this[_0x109e34(0xdd)][_0x109e34(0xf6)](_0x142e88);_0x44ade7=!![],_0x14c3cb[_0x109e34(0xd1)]===_0x109e34(0xe4)&&_0x14c3cb[_0x109e34(0xff)]?.['id']&&(_0x519df3=_0x14c3cb['user']['id']),_0x519df3&&await telegramBotService_1[_0x109e34(0xf7)]['sendLoginNotification'](_0x519df3,{'username':_0x142e88[_0x109e34(0xd6)],'ipAddress':_0x20f923,'userAgent':_0x4e5c65,'geo':_0x124994,'timestamp':new Date(),'success':!![]}),_0x1a204a['json']({'success':!![],'result':_0x14c3cb});}catch(_0x56f7ed){try{const _0x42649f=(await Promise[_0x109e34(0xf1)]()[_0x109e34(0xdb)](()=>__importStar(require(_0x109e34(0xe1)))))[_0x109e34(0xd3)],_0x4da067=await _0x42649f[_0x109e34(0xe4)]['findUnique']({'where':{'username':_0x142e88[_0x109e34(0xd6)]},'select':{'id':!![]}});_0x4da067&&await telegramBotService_1[_0x109e34(0xf7)][_0x109e34(0xea)](_0x4da067['id'],{'username':_0x142e88[_0x109e34(0xd6)],'ipAddress':_0x20f923,'userAgent':_0x4e5c65,'geo':_0x124994,'timestamp':new Date(),'success':![]});}catch(_0x2a4461){console['error']('Failed\x20to\x20send\x20failed\x20login\x20notification:',_0x2a4461);}throw _0x56f7ed;}}catch(_0x1b41f8){_0x28bbc4(_0x1b41f8);}},this['me']=async(_0x237000,_0x5ba6b7,_0xc92aa0)=>{const _0x1b7a19=_0x5e7111;try{const _0x149c6b=_0x237000[_0x1b7a19(0xff)];_0x5ba6b7[_0x1b7a19(0xe7)]({'success':!![],'result':{'id':_0x149c6b?.['id'],'username':_0x149c6b?.[_0x1b7a19(0xd6)],'role':_0x149c6b?.[_0x1b7a19(0xd1)]}});}catch(_0x518cd2){_0xc92aa0(_0x518cd2);}},this[_0x5e7111(0xf5)]=async(_0x1d65e2,_0x35033a,_0x593821)=>{const _0x353a72=_0x5e7111;try{const _0x3c241b=_0x1d65e2[_0x353a72(0xd9)],_0x1e3a66=_0x1d65e2[_0x353a72(0xff)];_0x3c241b&&_0x1e3a66?.[_0x353a72(0xdf)]&&tokenBlacklistService_1[_0x353a72(0xe9)][_0x353a72(0xf3)](_0x3c241b,_0x1e3a66['exp']),_0x35033a[_0x353a72(0xe7)]({'success':!![],'message':_0x353a72(0xee)});}catch(_0x5c16ca){_0x593821(_0x5c16ca);}},this[_0x5e7111(0x100)]=async(_0x42d0c2,_0x6f0ebc,_0x37d44f)=>{const _0x122ccd=_0x5e7111;try{const _0x4de30d=tokenBlacklistService_1['tokenBlacklistService']['getStats']();_0x6f0ebc[_0x122ccd(0xe7)]({'success':!![],'result':_0x4de30d});}catch(_0x232e8f){_0x37d44f(_0x232e8f);}},this['authService']=new authService_1[(_0x5e7111(0xfe))]();}}exports[a4_0x4ab732(0xd4)]=AuthController;