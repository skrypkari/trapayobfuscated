'use strict';const a4_0x184357=a4_0x3bc8;(function(_0x13d8c8,_0x1c2606){const _0x4e79ed=a4_0x3bc8,_0x364e3c=_0x13d8c8();while(!![]){try{const _0x3fea6e=-parseInt(_0x4e79ed(0xf0))/0x1*(parseInt(_0x4e79ed(0x107))/0x2)+-parseInt(_0x4e79ed(0x120))/0x3+-parseInt(_0x4e79ed(0x11a))/0x4*(-parseInt(_0x4e79ed(0xfa))/0x5)+-parseInt(_0x4e79ed(0x105))/0x6+-parseInt(_0x4e79ed(0x11b))/0x7+-parseInt(_0x4e79ed(0x117))/0x8*(parseInt(_0x4e79ed(0x10e))/0x9)+parseInt(_0x4e79ed(0xf9))/0xa*(parseInt(_0x4e79ed(0x11e))/0xb);if(_0x3fea6e===_0x1c2606)break;else _0x364e3c['push'](_0x364e3c['shift']());}catch(_0x2a7925){_0x364e3c['push'](_0x364e3c['shift']());}}}(a4_0x29ff,0xbf50f));var __createBinding=this&&this[a4_0x184357(0x11d)]||(Object[a4_0x184357(0x104)]?function(_0x4f2ff6,_0xd497c,_0x53a679,_0x150a9b){const _0x186b5f=a4_0x184357;if(_0x150a9b===undefined)_0x150a9b=_0x53a679;var _0x3f7830=Object['getOwnPropertyDescriptor'](_0xd497c,_0x53a679);(!_0x3f7830||(_0x186b5f(0x10a)in _0x3f7830?!_0xd497c[_0x186b5f(0xf6)]:_0x3f7830[_0x186b5f(0x11c)]||_0x3f7830[_0x186b5f(0x103)]))&&(_0x3f7830={'enumerable':!![],'get':function(){return _0xd497c[_0x53a679];}}),Object[_0x186b5f(0xf8)](_0x4f2ff6,_0x150a9b,_0x3f7830);}:function(_0x71408a,_0x56cd0f,_0x53a584,_0x36438c){if(_0x36438c===undefined)_0x36438c=_0x53a584;_0x71408a[_0x36438c]=_0x56cd0f[_0x53a584];}),__setModuleDefault=this&&this[a4_0x184357(0x109)]||(Object[a4_0x184357(0x104)]?function(_0x796418,_0x54d6b1){const _0x1c4a1e=a4_0x184357;Object[_0x1c4a1e(0xf8)](_0x796418,'default',{'enumerable':!![],'value':_0x54d6b1});}:function(_0x5117cb,_0x4d1341){const _0x8c2d9e=a4_0x184357;_0x5117cb[_0x8c2d9e(0x119)]=_0x4d1341;}),__importStar=this&&this[a4_0x184357(0xf1)]||(function(){var _0x515d3d=function(_0x169a15){const _0x31dd84=a4_0x3bc8;return _0x515d3d=Object[_0x31dd84(0x10b)]||function(_0x3dfccd){const _0x6f365f=_0x31dd84;var _0x2b22d0=[];for(var _0x566a68 in _0x3dfccd)if(Object[_0x6f365f(0x115)]['hasOwnProperty'][_0x6f365f(0xf3)](_0x3dfccd,_0x566a68))_0x2b22d0[_0x2b22d0[_0x6f365f(0x111)]]=_0x566a68;return _0x2b22d0;},_0x515d3d(_0x169a15);};return function(_0x413646){const _0x9ae414=a4_0x3bc8;if(_0x413646&&_0x413646[_0x9ae414(0xf6)])return _0x413646;var _0x50e124={};if(_0x413646!=null){for(var _0x18a2ee=_0x515d3d(_0x413646),_0x2dbaa4=0x0;_0x2dbaa4<_0x18a2ee[_0x9ae414(0x111)];_0x2dbaa4++)if(_0x18a2ee[_0x2dbaa4]!==_0x9ae414(0x119))__createBinding(_0x50e124,_0x413646,_0x18a2ee[_0x2dbaa4]);}return __setModuleDefault(_0x50e124,_0x413646),_0x50e124;};}());function a4_0x29ff(){const _0x3d55ab=['prototype','../services/authService','339496BZSedk','tokenBlacklistService','default','900744vzhwbj','6014113CeDqmD','writable','__createBinding','41677570GtTkdL','../config/database','1704720fpAPuI','blacklistToken','1026911amUmoL','__importStar','remoteAddress','call','connection','getStats','__esModule','sendLoginNotification','defineProperty','10yCzIur','25WjiUqS','username','Failed\x20to\x20send\x20failed\x20login\x20notification:','getBlacklistStats','findUnique','user','authService','unknown','shop','configurable','create','8788044nGbtkR','json','2fKOKJv','User-Agent','__setModuleDefault','get','getOwnPropertyNames','telegramBotService','resolve','45xrnVnc','role','../services/tokenBlacklistService','length','login','exp','logout'];a4_0x29ff=function(){return _0x3d55ab;};return a4_0x29ff();}Object['defineProperty'](exports,'__esModule',{'value':!![]}),exports['AuthController']=void 0x0;const authService_1=require(a4_0x184357(0x116)),tokenBlacklistService_1=require(a4_0x184357(0x110)),telegramBotService_1=require('../services/telegramBotService');function a4_0x3bc8(_0x44df8a,_0x4d0539){const _0x29ffd6=a4_0x29ff();return a4_0x3bc8=function(_0x3bc862,_0x4cf721){_0x3bc862=_0x3bc862-0xf0;let _0x2e3b5b=_0x29ffd6[_0x3bc862];return _0x2e3b5b;},a4_0x3bc8(_0x44df8a,_0x4d0539);}class AuthController{constructor(){const _0x204a0f=a4_0x184357;this[_0x204a0f(0x112)]=async(_0x57a2ed,_0x59b948,_0x5cf266)=>{const _0x17bf72=_0x204a0f;try{const _0x5a0849=_0x57a2ed['body'],_0x51e075=_0x57a2ed['ip']||_0x57a2ed[_0x17bf72(0xf4)][_0x17bf72(0xf2)]||_0x17bf72(0x101),_0x2fa5a2=_0x57a2ed[_0x17bf72(0x10a)](_0x17bf72(0x108))||_0x17bf72(0x101);let _0x20e917=![],_0x132dfc=null;try{const _0x4affad=await this[_0x17bf72(0x100)][_0x17bf72(0x112)](_0x5a0849);_0x20e917=!![],_0x4affad['role']===_0x17bf72(0x102)&&_0x4affad[_0x17bf72(0xff)]?.['id']&&(_0x132dfc=_0x4affad[_0x17bf72(0xff)]['id']),_0x132dfc&&await telegramBotService_1[_0x17bf72(0x10c)][_0x17bf72(0xf7)](_0x132dfc,{'username':_0x5a0849[_0x17bf72(0xfb)],'ipAddress':_0x51e075,'userAgent':_0x2fa5a2,'timestamp':new Date(),'success':!![]}),_0x59b948['json']({'success':!![],'result':_0x4affad});}catch(_0x2e7e57){try{const _0x300e0a=(await Promise[_0x17bf72(0x10d)]()['then'](()=>__importStar(require(_0x17bf72(0x11f)))))[_0x17bf72(0x119)],_0x200060=await _0x300e0a['shop'][_0x17bf72(0xfe)]({'where':{'username':_0x5a0849['username']},'select':{'id':!![]}});_0x200060&&await telegramBotService_1[_0x17bf72(0x10c)][_0x17bf72(0xf7)](_0x200060['id'],{'username':_0x5a0849[_0x17bf72(0xfb)],'ipAddress':_0x51e075,'userAgent':_0x2fa5a2,'timestamp':new Date(),'success':![]});}catch(_0x7fbe5e){console['error'](_0x17bf72(0xfc),_0x7fbe5e);}throw _0x2e7e57;}}catch(_0x3e57c0){_0x5cf266(_0x3e57c0);}},this['me']=async(_0x3a579b,_0xc49419,_0x8699dc)=>{const _0x308cc8=_0x204a0f;try{const _0x2cadb4=_0x3a579b['user'];_0xc49419[_0x308cc8(0x106)]({'success':!![],'result':{'id':_0x2cadb4?.['id'],'username':_0x2cadb4?.[_0x308cc8(0xfb)],'role':_0x2cadb4?.[_0x308cc8(0x10f)]}});}catch(_0x1faa8e){_0x8699dc(_0x1faa8e);}},this[_0x204a0f(0x114)]=async(_0x1e1fa9,_0x43772b,_0x1b002)=>{const _0xe41acd=_0x204a0f;try{const _0x259cab=_0x1e1fa9['token'],_0x559054=_0x1e1fa9[_0xe41acd(0xff)];_0x259cab&&_0x559054?.[_0xe41acd(0x113)]&&tokenBlacklistService_1[_0xe41acd(0x118)][_0xe41acd(0x121)](_0x259cab,_0x559054[_0xe41acd(0x113)]),_0x43772b[_0xe41acd(0x106)]({'success':!![],'message':'Logged\x20out\x20successfully'});}catch(_0x1e1fa8){_0x1b002(_0x1e1fa8);}},this[_0x204a0f(0xfd)]=async(_0x344698,_0x543633,_0x5d9daf)=>{const _0x596ef9=_0x204a0f;try{const _0x45b8a1=tokenBlacklistService_1['tokenBlacklistService'][_0x596ef9(0xf5)]();_0x543633[_0x596ef9(0x106)]({'success':!![],'result':_0x45b8a1});}catch(_0x232017){_0x5d9daf(_0x232017);}},this['authService']=new authService_1['AuthService']();}}exports['AuthController']=AuthController;