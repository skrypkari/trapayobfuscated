'use strict';function a4_0x5781(_0x2a38e4,_0x23e543){const _0x9a7a30=a4_0x9a7a();return a4_0x5781=function(_0x578191,_0x3665f9){_0x578191=_0x578191-0x135;let _0x432ed5=_0x9a7a30[_0x578191];return _0x432ed5;},a4_0x5781(_0x2a38e4,_0x23e543);}const a4_0x54d605=a4_0x5781;(function(_0x2b859a,_0x34ed83){const _0x4058a5=a4_0x5781,_0x1dd42e=_0x2b859a();while(!![]){try{const _0x4e5843=parseInt(_0x4058a5(0x137))/0x1+-parseInt(_0x4058a5(0x15a))/0x2+parseInt(_0x4058a5(0x14c))/0x3*(parseInt(_0x4058a5(0x15c))/0x4)+parseInt(_0x4058a5(0x158))/0x5+parseInt(_0x4058a5(0x138))/0x6+parseInt(_0x4058a5(0x15b))/0x7+parseInt(_0x4058a5(0x146))/0x8*(-parseInt(_0x4058a5(0x13c))/0x9);if(_0x4e5843===_0x34ed83)break;else _0x1dd42e['push'](_0x1dd42e['shift']());}catch(_0x2dd5be){_0x1dd42e['push'](_0x1dd42e['shift']());}}}(a4_0x9a7a,0x6c41f));var __createBinding=this&&this[a4_0x54d605(0x136)]||(Object['create']?function(_0x4d1fcf,_0x2a59e4,_0x679434,_0x4be5ff){const _0x43febd=a4_0x54d605;if(_0x4be5ff===undefined)_0x4be5ff=_0x679434;var _0x42b179=Object[_0x43febd(0x159)](_0x2a59e4,_0x679434);(!_0x42b179||('get'in _0x42b179?!_0x2a59e4[_0x43febd(0x154)]:_0x42b179[_0x43febd(0x151)]||_0x42b179['configurable']))&&(_0x42b179={'enumerable':!![],'get':function(){return _0x2a59e4[_0x679434];}}),Object['defineProperty'](_0x4d1fcf,_0x4be5ff,_0x42b179);}:function(_0x540ca5,_0x5c757a,_0x58aa71,_0x573989){if(_0x573989===undefined)_0x573989=_0x58aa71;_0x540ca5[_0x573989]=_0x5c757a[_0x58aa71];}),__setModuleDefault=this&&this[a4_0x54d605(0x157)]||(Object[a4_0x54d605(0x14a)]?function(_0x309185,_0x3e14ea){const _0x17bfc5=a4_0x54d605;Object['defineProperty'](_0x309185,_0x17bfc5(0x153),{'enumerable':!![],'value':_0x3e14ea});}:function(_0x32406f,_0x54617f){const _0x8cdbd1=a4_0x54d605;_0x32406f[_0x8cdbd1(0x153)]=_0x54617f;}),__importStar=this&&this[a4_0x54d605(0x14e)]||(function(){var _0x54d0b3=function(_0x1f44a2){const _0x264b34=a4_0x5781;return _0x54d0b3=Object[_0x264b34(0x150)]||function(_0x465287){const _0x10f9ff=_0x264b34;var _0x1e5b28=[];for(var _0x3a3af9 in _0x465287)if(Object[_0x10f9ff(0x135)][_0x10f9ff(0x14d)][_0x10f9ff(0x140)](_0x465287,_0x3a3af9))_0x1e5b28[_0x1e5b28['length']]=_0x3a3af9;return _0x1e5b28;},_0x54d0b3(_0x1f44a2);};return function(_0x4634c8){const _0x57c0f1=a4_0x5781;if(_0x4634c8&&_0x4634c8[_0x57c0f1(0x154)])return _0x4634c8;var _0x4c2e7c={};if(_0x4634c8!=null){for(var _0x34495c=_0x54d0b3(_0x4634c8),_0x44e6ea=0x0;_0x44e6ea<_0x34495c[_0x57c0f1(0x13a)];_0x44e6ea++)if(_0x34495c[_0x44e6ea]!==_0x57c0f1(0x153))__createBinding(_0x4c2e7c,_0x4634c8,_0x34495c[_0x44e6ea]);}return __setModuleDefault(_0x4c2e7c,_0x4634c8),_0x4c2e7c;};}());Object[a4_0x54d605(0x14f)](exports,'__esModule',{'value':!![]}),exports['AuthController']=void 0x0;function a4_0x9a7a(){const _0x3ff615=['error','11509464gvQUJU','exp','json','sendLoginNotification','create','AuthController','2235336FLgVIw','hasOwnProperty','__importStar','defineProperty','getOwnPropertyNames','writable','tokenBlacklistService','default','__esModule','Logged\x20out\x20successfully','User-Agent','__setModuleDefault','3833785DeyJRG','getOwnPropertyDescriptor','188956EhPuZt','1422869mpzbCC','4haUsxX','get','shop','getBlacklistStats','unknown','resolve','authService','prototype','__createBinding','29410AUYJBy','1392228OjqZhp','login','length','user','9bHDONM','AuthService','role','../services/telegramBotService','call','username','../config/database','token','../services/tokenBlacklistService'];a4_0x9a7a=function(){return _0x3ff615;};return a4_0x9a7a();}const authService_1=require('../services/authService'),tokenBlacklistService_1=require(a4_0x54d605(0x144)),telegramBotService_1=require(a4_0x54d605(0x13f));class AuthController{constructor(){const _0xbc28f0=a4_0x54d605;this[_0xbc28f0(0x139)]=async(_0x3d61c2,_0x4c670b,_0x10954c)=>{const _0x2c1779=_0xbc28f0;try{const _0x3bc575=_0x3d61c2['body'],_0x39a261=_0x3d61c2['ip']||_0x3d61c2['connection']['remoteAddress']||_0x2c1779(0x160),_0x318b0d=_0x3d61c2[_0x2c1779(0x15d)](_0x2c1779(0x156))||_0x2c1779(0x160);let _0x3b7e62=![],_0x5d780d=null;try{const _0x38037d=await this[_0x2c1779(0x162)][_0x2c1779(0x139)](_0x3bc575);_0x3b7e62=!![],_0x38037d[_0x2c1779(0x13e)]===_0x2c1779(0x15e)&&_0x38037d['user']?.['id']&&(_0x5d780d=_0x38037d[_0x2c1779(0x13b)]['id']),_0x5d780d&&await telegramBotService_1['telegramBotService'][_0x2c1779(0x149)](_0x5d780d,{'username':_0x3bc575[_0x2c1779(0x141)],'ipAddress':_0x39a261,'userAgent':_0x318b0d,'timestamp':new Date(),'success':!![]}),_0x4c670b[_0x2c1779(0x148)]({'success':!![],'result':_0x38037d});}catch(_0x493388){try{const _0x45426f=(await Promise[_0x2c1779(0x161)]()['then'](()=>__importStar(require(_0x2c1779(0x142)))))[_0x2c1779(0x153)],_0x57c30c=await _0x45426f['shop']['findUnique']({'where':{'username':_0x3bc575[_0x2c1779(0x141)]},'select':{'id':!![]}});_0x57c30c&&await telegramBotService_1['telegramBotService']['sendLoginNotification'](_0x57c30c['id'],{'username':_0x3bc575[_0x2c1779(0x141)],'ipAddress':_0x39a261,'userAgent':_0x318b0d,'timestamp':new Date(),'success':![]});}catch(_0x10add6){console[_0x2c1779(0x145)]('Failed\x20to\x20send\x20failed\x20login\x20notification:',_0x10add6);}throw _0x493388;}}catch(_0x475780){_0x10954c(_0x475780);}},this['me']=async(_0x5e843c,_0x83802e,_0x2720ac)=>{const _0x18ad57=_0xbc28f0;try{const _0x4bec30=_0x5e843c[_0x18ad57(0x13b)];_0x83802e[_0x18ad57(0x148)]({'success':!![],'result':{'id':_0x4bec30?.['id'],'username':_0x4bec30?.['username'],'role':_0x4bec30?.[_0x18ad57(0x13e)]}});}catch(_0x20bfd8){_0x2720ac(_0x20bfd8);}},this['logout']=async(_0x37ff89,_0xc1ed22,_0x845b11)=>{const _0x51a962=_0xbc28f0;try{const _0x24798c=_0x37ff89[_0x51a962(0x143)],_0x363719=_0x37ff89['user'];_0x24798c&&_0x363719?.[_0x51a962(0x147)]&&tokenBlacklistService_1[_0x51a962(0x152)]['blacklistToken'](_0x24798c,_0x363719[_0x51a962(0x147)]),_0xc1ed22[_0x51a962(0x148)]({'success':!![],'message':_0x51a962(0x155)});}catch(_0x4f592d){_0x845b11(_0x4f592d);}},this[_0xbc28f0(0x15f)]=async(_0x598fbb,_0x526580,_0xe90140)=>{const _0x3c049d=_0xbc28f0;try{const _0x45f185=tokenBlacklistService_1[_0x3c049d(0x152)]['getStats']();_0x526580[_0x3c049d(0x148)]({'success':!![],'result':_0x45f185});}catch(_0x54e99b){_0xe90140(_0x54e99b);}},this['authService']=new authService_1[(_0xbc28f0(0x13d))]();}}exports[a4_0x54d605(0x14b)]=AuthController;