'use strict';const a4_0x37303b=a4_0x90be;function a4_0xced7(){const _0x318534=['__importStar','sendLoginNotification','resolve','getBlacklistStats','../services/tokenBlacklistService','exp','configurable','203602flmWRU','remoteAddress','authService','AuthService','1408758mQZGAL','4703166POBDSd','call','Failed\x20to\x20send\x20failed\x20login\x20notification:','blacklistToken','199921FzTvSp','__setModuleDefault','writable','defineProperty','username','get','../services/telegramBotService','getStats','534428dHWEmT','tokenBlacklistService','then','shop','token','login','../services/authService','logout','user','telegramBotService','role','create','default','getOwnPropertyDescriptor','AuthController','../config/database','252030qaSdEq','connection','getOwnPropertyNames','__esModule','body','unknown','56tkVVMO','json','674061RJpBdY','2QccCVa','error','hasOwnProperty'];a4_0xced7=function(){return _0x318534;};return a4_0xced7();}(function(_0x3bcbfc,_0x2a9783){const _0xbda468=a4_0x90be,_0x46a8a5=_0x3bcbfc();while(!![]){try{const _0x229adf=-parseInt(_0xbda468(0x9a))/0x1*(parseInt(_0xbda468(0xbb))/0x2)+parseInt(_0xbda468(0xba))/0x3+parseInt(_0xbda468(0xa2))/0x4+parseInt(_0xbda468(0xb2))/0x5+parseInt(_0xbda468(0x95))/0x6+-parseInt(_0xbda468(0x91))/0x7*(-parseInt(_0xbda468(0xb8))/0x8)+-parseInt(_0xbda468(0x96))/0x9;if(_0x229adf===_0x2a9783)break;else _0x46a8a5['push'](_0x46a8a5['shift']());}catch(_0x5295bf){_0x46a8a5['push'](_0x46a8a5['shift']());}}}(a4_0xced7,0x1e6b8));var __createBinding=this&&this['__createBinding']||(Object[a4_0x37303b(0xad)]?function(_0x427cc9,_0x441718,_0x3c0584,_0x484ef1){const _0x82b9f0=a4_0x37303b;if(_0x484ef1===undefined)_0x484ef1=_0x3c0584;var _0x21834e=Object[_0x82b9f0(0xaf)](_0x441718,_0x3c0584);(!_0x21834e||(_0x82b9f0(0x9f)in _0x21834e?!_0x441718[_0x82b9f0(0xb5)]:_0x21834e[_0x82b9f0(0x9c)]||_0x21834e[_0x82b9f0(0x90)]))&&(_0x21834e={'enumerable':!![],'get':function(){return _0x441718[_0x3c0584];}}),Object[_0x82b9f0(0x9d)](_0x427cc9,_0x484ef1,_0x21834e);}:function(_0x56f608,_0x259628,_0xb02ab5,_0x3ac3b9){if(_0x3ac3b9===undefined)_0x3ac3b9=_0xb02ab5;_0x56f608[_0x3ac3b9]=_0x259628[_0xb02ab5];}),__setModuleDefault=this&&this[a4_0x37303b(0x9b)]||(Object[a4_0x37303b(0xad)]?function(_0x54d6c7,_0x3394cf){const _0x50c67b=a4_0x37303b;Object[_0x50c67b(0x9d)](_0x54d6c7,'default',{'enumerable':!![],'value':_0x3394cf});}:function(_0x59608f,_0x18856e){const _0x4f2d9d=a4_0x37303b;_0x59608f[_0x4f2d9d(0xae)]=_0x18856e;}),__importStar=this&&this[a4_0x37303b(0xbe)]||(function(){var _0x14b75f=function(_0x2e0c00){const _0x5995eb=a4_0x90be;return _0x14b75f=Object[_0x5995eb(0xb4)]||function(_0x6546e0){const _0x551580=_0x5995eb;var _0x5a4f9f=[];for(var _0x2be2af in _0x6546e0)if(Object['prototype'][_0x551580(0xbd)][_0x551580(0x97)](_0x6546e0,_0x2be2af))_0x5a4f9f[_0x5a4f9f['length']]=_0x2be2af;return _0x5a4f9f;},_0x14b75f(_0x2e0c00);};return function(_0x5cfde1){const _0x4262cb=a4_0x90be;if(_0x5cfde1&&_0x5cfde1[_0x4262cb(0xb5)])return _0x5cfde1;var _0x526275={};if(_0x5cfde1!=null){for(var _0x5f1db6=_0x14b75f(_0x5cfde1),_0x53d8b5=0x0;_0x53d8b5<_0x5f1db6['length'];_0x53d8b5++)if(_0x5f1db6[_0x53d8b5]!==_0x4262cb(0xae))__createBinding(_0x526275,_0x5cfde1,_0x5f1db6[_0x53d8b5]);}return __setModuleDefault(_0x526275,_0x5cfde1),_0x526275;};}());Object[a4_0x37303b(0x9d)](exports,'__esModule',{'value':!![]}),exports[a4_0x37303b(0xb0)]=void 0x0;const authService_1=require(a4_0x37303b(0xa8)),tokenBlacklistService_1=require(a4_0x37303b(0x8e)),telegramBotService_1=require(a4_0x37303b(0xa0));class AuthController{constructor(){const _0x341f2d=a4_0x37303b;this['login']=async(_0x508b8c,_0x469e10,_0x4a501d)=>{const _0x496956=a4_0x90be;try{const _0x5002f4=_0x508b8c[_0x496956(0xb6)],_0x4f2d88=_0x508b8c['ip']||_0x508b8c[_0x496956(0xb3)][_0x496956(0x92)]||'unknown',_0x1d9d1b=_0x508b8c[_0x496956(0x9f)]('User-Agent')||_0x496956(0xb7);let _0x376e0d=![],_0x4b9dc6=null;try{const _0x415a8e=await this[_0x496956(0x93)][_0x496956(0xa7)](_0x5002f4);_0x376e0d=!![],_0x415a8e[_0x496956(0xac)]===_0x496956(0xa5)&&_0x415a8e[_0x496956(0xaa)]?.['id']&&(_0x4b9dc6=_0x415a8e['user']['id']),_0x4b9dc6&&await telegramBotService_1[_0x496956(0xab)][_0x496956(0xbf)](_0x4b9dc6,{'username':_0x5002f4[_0x496956(0x9e)],'ipAddress':_0x4f2d88,'userAgent':_0x1d9d1b,'timestamp':new Date(),'success':!![]}),_0x469e10[_0x496956(0xb9)]({'success':!![],'result':_0x415a8e});}catch(_0x1d6af1){try{const _0x1d10fa=(await Promise[_0x496956(0x8c)]()[_0x496956(0xa4)](()=>__importStar(require(_0x496956(0xb1)))))[_0x496956(0xae)],_0x45a6b8=await _0x1d10fa[_0x496956(0xa5)]['findUnique']({'where':{'username':_0x5002f4[_0x496956(0x9e)]},'select':{'id':!![]}});_0x45a6b8&&await telegramBotService_1[_0x496956(0xab)]['sendLoginNotification'](_0x45a6b8['id'],{'username':_0x5002f4[_0x496956(0x9e)],'ipAddress':_0x4f2d88,'userAgent':_0x1d9d1b,'timestamp':new Date(),'success':![]});}catch(_0x4e5c74){console[_0x496956(0xbc)](_0x496956(0x98),_0x4e5c74);}throw _0x1d6af1;}}catch(_0x25ac49){_0x4a501d(_0x25ac49);}},this['me']=async(_0x12840d,_0x1aedea,_0x2761b4)=>{const _0x20f4e5=a4_0x90be;try{const _0x181539=_0x12840d[_0x20f4e5(0xaa)];_0x1aedea[_0x20f4e5(0xb9)]({'success':!![],'result':{'id':_0x181539?.['id'],'username':_0x181539?.['username'],'role':_0x181539?.[_0x20f4e5(0xac)]}});}catch(_0x267d13){_0x2761b4(_0x267d13);}},this[_0x341f2d(0xa9)]=async(_0x5b57fd,_0x61d629,_0x55d4ea)=>{const _0x1bcea7=_0x341f2d;try{const _0x5ed57f=_0x5b57fd[_0x1bcea7(0xa6)],_0x56dc66=_0x5b57fd[_0x1bcea7(0xaa)];_0x5ed57f&&_0x56dc66?.[_0x1bcea7(0x8f)]&&tokenBlacklistService_1[_0x1bcea7(0xa3)][_0x1bcea7(0x99)](_0x5ed57f,_0x56dc66[_0x1bcea7(0x8f)]),_0x61d629[_0x1bcea7(0xb9)]({'success':!![],'message':'Logged\x20out\x20successfully'});}catch(_0x3ccf36){_0x55d4ea(_0x3ccf36);}},this[_0x341f2d(0x8d)]=async(_0x279a5b,_0x3bbfbd,_0x2bca22)=>{const _0x46c2b3=_0x341f2d;try{const _0x24e43c=tokenBlacklistService_1['tokenBlacklistService'][_0x46c2b3(0xa1)]();_0x3bbfbd['json']({'success':!![],'result':_0x24e43c});}catch(_0x5c0009){_0x2bca22(_0x5c0009);}},this['authService']=new authService_1[(_0x341f2d(0x94))]();}}function a4_0x90be(_0x170465,_0x34b092){const _0xced703=a4_0xced7();return a4_0x90be=function(_0x90bed1,_0x3bffdf){_0x90bed1=_0x90bed1-0x8c;let _0x3f51fd=_0xced703[_0x90bed1];return _0x3f51fd;},a4_0x90be(_0x170465,_0x34b092);}exports['AuthController']=AuthController;