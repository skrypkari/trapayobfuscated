'use strict';const a4_0x3e7e00=a4_0x55e3;function a4_0x55e3(_0x444b11,_0x2e0b89){const _0x3262fb=a4_0x3262();return a4_0x55e3=function(_0x55e300,_0x17e59d){_0x55e300=_0x55e300-0x184;let _0x1863f7=_0x3262fb[_0x55e300];return _0x1863f7;},a4_0x55e3(_0x444b11,_0x2e0b89);}(function(_0x1674bd,_0xd5180d){const _0x56759e=a4_0x55e3,_0x4d336e=_0x1674bd();while(!![]){try{const _0x4becfb=parseInt(_0x56759e(0x193))/0x1*(parseInt(_0x56759e(0x18d))/0x2)+-parseInt(_0x56759e(0x19c))/0x3+-parseInt(_0x56759e(0x192))/0x4+-parseInt(_0x56759e(0x1af))/0x5+parseInt(_0x56759e(0x196))/0x6+-parseInt(_0x56759e(0x195))/0x7+parseInt(_0x56759e(0x19b))/0x8*(parseInt(_0x56759e(0x1a1))/0x9);if(_0x4becfb===_0xd5180d)break;else _0x4d336e['push'](_0x4d336e['shift']());}catch(_0x1f1e17){_0x4d336e['push'](_0x4d336e['shift']());}}}(a4_0x3262,0x5f47b));function a4_0x3262(){const _0x15c54a=['getOwnPropertyNames','1474977jzYaAy','1806810dCNYWi','AuthController','remoteAddress','../services/telegramBotService','username','8qgLeYw','310272RfluDn','hasOwnProperty','../services/authService','../config/database','sendLoginNotification','2532051hJIFfH','tokenBlacklistService','logout','AuthService','Failed\x20to\x20send\x20failed\x20login\x20notification:','login','body','resolve','__esModule','telegramBotService','Logged\x20out\x20successfully','role','unknown','length','2544555sVZqcb','defineProperty','default','exp','then','__setModuleDefault','shop','configurable','authService','__createBinding','2ubvuKM','get','create','json','user','14796GVouJC','634538bJMlJW'];a4_0x3262=function(){return _0x15c54a;};return a4_0x3262();}var __createBinding=this&&this[a4_0x3e7e00(0x18c)]||(Object[a4_0x3e7e00(0x18f)]?function(_0x6f0659,_0x5ca077,_0x448f91,_0x1de9ed){const _0x2bd5d1=a4_0x3e7e00;if(_0x1de9ed===undefined)_0x1de9ed=_0x448f91;var _0x307bc4=Object['getOwnPropertyDescriptor'](_0x5ca077,_0x448f91);(!_0x307bc4||(_0x2bd5d1(0x18e)in _0x307bc4?!_0x5ca077[_0x2bd5d1(0x1a9)]:_0x307bc4['writable']||_0x307bc4[_0x2bd5d1(0x18a)]))&&(_0x307bc4={'enumerable':!![],'get':function(){return _0x5ca077[_0x448f91];}}),Object[_0x2bd5d1(0x184)](_0x6f0659,_0x1de9ed,_0x307bc4);}:function(_0x5cd43b,_0x29e747,_0x1b48d9,_0x5b5830){if(_0x5b5830===undefined)_0x5b5830=_0x1b48d9;_0x5cd43b[_0x5b5830]=_0x29e747[_0x1b48d9];}),__setModuleDefault=this&&this[a4_0x3e7e00(0x188)]||(Object[a4_0x3e7e00(0x18f)]?function(_0x585a54,_0x2feb2a){const _0x1c451f=a4_0x3e7e00;Object['defineProperty'](_0x585a54,_0x1c451f(0x185),{'enumerable':!![],'value':_0x2feb2a});}:function(_0x45c346,_0x2e0751){const _0x5c602b=a4_0x3e7e00;_0x45c346[_0x5c602b(0x185)]=_0x2e0751;}),__importStar=this&&this['__importStar']||(function(){var _0x15520c=function(_0x4ae473){const _0x3e397d=a4_0x55e3;return _0x15520c=Object[_0x3e397d(0x194)]||function(_0x258700){const _0x341d11=_0x3e397d;var _0x160e2d=[];for(var _0xd7755f in _0x258700)if(Object['prototype'][_0x341d11(0x19d)]['call'](_0x258700,_0xd7755f))_0x160e2d[_0x160e2d[_0x341d11(0x1ae)]]=_0xd7755f;return _0x160e2d;},_0x15520c(_0x4ae473);};return function(_0x30ab8f){const _0x4cbb75=a4_0x55e3;if(_0x30ab8f&&_0x30ab8f[_0x4cbb75(0x1a9)])return _0x30ab8f;var _0x5f5241={};if(_0x30ab8f!=null){for(var _0x547732=_0x15520c(_0x30ab8f),_0x5c8be0=0x0;_0x5c8be0<_0x547732[_0x4cbb75(0x1ae)];_0x5c8be0++)if(_0x547732[_0x5c8be0]!==_0x4cbb75(0x185))__createBinding(_0x5f5241,_0x30ab8f,_0x547732[_0x5c8be0]);}return __setModuleDefault(_0x5f5241,_0x30ab8f),_0x5f5241;};}());Object[a4_0x3e7e00(0x184)](exports,a4_0x3e7e00(0x1a9),{'value':!![]}),exports[a4_0x3e7e00(0x197)]=void 0x0;const authService_1=require(a4_0x3e7e00(0x19e)),tokenBlacklistService_1=require('../services/tokenBlacklistService'),telegramBotService_1=require(a4_0x3e7e00(0x199));class AuthController{constructor(){const _0xc9a081=a4_0x3e7e00;this[_0xc9a081(0x1a6)]=async(_0x5f2b96,_0x41f43c,_0x4d2477)=>{const _0x481a85=_0xc9a081;try{const _0xf426a=_0x5f2b96[_0x481a85(0x1a7)],_0x312486=_0x5f2b96['ip']||_0x5f2b96['connection'][_0x481a85(0x198)]||'unknown',_0x21e92c=_0x5f2b96[_0x481a85(0x18e)]('User-Agent')||_0x481a85(0x1ad);let _0xf27285=![],_0x137d92=null;try{const _0x1ef04e=await this[_0x481a85(0x18b)][_0x481a85(0x1a6)](_0xf426a);_0xf27285=!![],_0x1ef04e[_0x481a85(0x1ac)]===_0x481a85(0x189)&&_0x1ef04e['user']?.['id']&&(_0x137d92=_0x1ef04e[_0x481a85(0x191)]['id']),_0x137d92&&await telegramBotService_1[_0x481a85(0x1aa)][_0x481a85(0x1a0)](_0x137d92,{'username':_0xf426a[_0x481a85(0x19a)],'ipAddress':_0x312486,'userAgent':_0x21e92c,'timestamp':new Date(),'success':!![]}),_0x41f43c[_0x481a85(0x190)]({'success':!![],'result':_0x1ef04e});}catch(_0x24545d){try{const _0x2bcd04=(await Promise[_0x481a85(0x1a8)]()[_0x481a85(0x187)](()=>__importStar(require(_0x481a85(0x19f)))))[_0x481a85(0x185)],_0x1df5a7=await _0x2bcd04[_0x481a85(0x189)]['findUnique']({'where':{'username':_0xf426a['username']},'select':{'id':!![]}});_0x1df5a7&&await telegramBotService_1[_0x481a85(0x1aa)][_0x481a85(0x1a0)](_0x1df5a7['id'],{'username':_0xf426a[_0x481a85(0x19a)],'ipAddress':_0x312486,'userAgent':_0x21e92c,'timestamp':new Date(),'success':![]});}catch(_0x1fd0da){console['error'](_0x481a85(0x1a5),_0x1fd0da);}throw _0x24545d;}}catch(_0x5efa5c){_0x4d2477(_0x5efa5c);}},this['me']=async(_0x50a218,_0x2529a9,_0x49a258)=>{const _0x5d1609=_0xc9a081;try{const _0x5961e6=_0x50a218[_0x5d1609(0x191)];_0x2529a9[_0x5d1609(0x190)]({'success':!![],'result':{'id':_0x5961e6?.['id'],'username':_0x5961e6?.['username'],'role':_0x5961e6?.[_0x5d1609(0x1ac)]}});}catch(_0x15b639){_0x49a258(_0x15b639);}},this[_0xc9a081(0x1a3)]=async(_0x289835,_0x38956c,_0x1f84a8)=>{const _0x17e8f2=_0xc9a081;try{const _0x1d8400=_0x289835['token'],_0xd355f2=_0x289835[_0x17e8f2(0x191)];_0x1d8400&&_0xd355f2?.[_0x17e8f2(0x186)]&&tokenBlacklistService_1[_0x17e8f2(0x1a2)]['blacklistToken'](_0x1d8400,_0xd355f2['exp']),_0x38956c[_0x17e8f2(0x190)]({'success':!![],'message':_0x17e8f2(0x1ab)});}catch(_0x3cd24e){_0x1f84a8(_0x3cd24e);}},this['getBlacklistStats']=async(_0xe97dd,_0x4dda99,_0x820487)=>{const _0x9c7732=_0xc9a081;try{const _0x192074=tokenBlacklistService_1[_0x9c7732(0x1a2)]['getStats']();_0x4dda99[_0x9c7732(0x190)]({'success':!![],'result':_0x192074});}catch(_0x389886){_0x820487(_0x389886);}},this[_0xc9a081(0x18b)]=new authService_1[(_0xc9a081(0x1a4))]();}}exports['AuthController']=AuthController;