'use strict';const a4_0x2c04b9=a4_0x5b73;(function(_0x5775a8,_0x3cab37){const _0x4f4607=a4_0x5b73,_0x982fbe=_0x5775a8();while(!![]){try{const _0x523afb=parseInt(_0x4f4607(0xd2))/0x1*(-parseInt(_0x4f4607(0x100))/0x2)+-parseInt(_0x4f4607(0xdc))/0x3+-parseInt(_0x4f4607(0xda))/0x4+parseInt(_0x4f4607(0xee))/0x5*(-parseInt(_0x4f4607(0xe9))/0x6)+parseInt(_0x4f4607(0xec))/0x7*(parseInt(_0x4f4607(0xd9))/0x8)+parseInt(_0x4f4607(0xe8))/0x9+parseInt(_0x4f4607(0xe7))/0xa;if(_0x523afb===_0x3cab37)break;else _0x982fbe['push'](_0x982fbe['shift']());}catch(_0x46ab19){_0x982fbe['push'](_0x982fbe['shift']());}}}(a4_0x5568,0x84453));function a4_0x5b73(_0x2a080a,_0x3569cc){const _0x55683f=a4_0x5568();return a4_0x5b73=function(_0x5b73ce,_0x4f6961){_0x5b73ce=_0x5b73ce-0xcd;let _0x5b4d10=_0x55683f[_0x5b73ce];return _0x5b4d10;},a4_0x5b73(_0x2a080a,_0x3569cc);}var __createBinding=this&&this[a4_0x2c04b9(0xf9)]||(Object[a4_0x2c04b9(0xdf)]?function(_0x20e987,_0x5e778c,_0xcd0ad0,_0x598c74){const _0x5c9501=a4_0x2c04b9;if(_0x598c74===undefined)_0x598c74=_0xcd0ad0;var _0x4b898b=Object[_0x5c9501(0xfa)](_0x5e778c,_0xcd0ad0);(!_0x4b898b||('get'in _0x4b898b?!_0x5e778c['__esModule']:_0x4b898b[_0x5c9501(0xe0)]||_0x4b898b[_0x5c9501(0xd1)]))&&(_0x4b898b={'enumerable':!![],'get':function(){return _0x5e778c[_0xcd0ad0];}}),Object['defineProperty'](_0x20e987,_0x598c74,_0x4b898b);}:function(_0x1c87a7,_0x50e6bb,_0x2a0d35,_0xa4bc6d){if(_0xa4bc6d===undefined)_0xa4bc6d=_0x2a0d35;_0x1c87a7[_0xa4bc6d]=_0x50e6bb[_0x2a0d35];}),__setModuleDefault=this&&this[a4_0x2c04b9(0xfe)]||(Object['create']?function(_0x423192,_0x48fc9e){const _0x2862e2=a4_0x2c04b9;Object[_0x2862e2(0xf1)](_0x423192,_0x2862e2(0xea),{'enumerable':!![],'value':_0x48fc9e});}:function(_0x3f5040,_0x209440){const _0x437ddc=a4_0x2c04b9;_0x3f5040[_0x437ddc(0xea)]=_0x209440;}),__importStar=this&&this[a4_0x2c04b9(0xe1)]||(function(){var _0x2e5d36=function(_0x130646){const _0x3db407=a4_0x5b73;return _0x2e5d36=Object[_0x3db407(0xeb)]||function(_0xc36e84){const _0x376714=_0x3db407;var _0xf2ecfd=[];for(var _0x2c5248 in _0xc36e84)if(Object[_0x376714(0xe5)][_0x376714(0xd3)][_0x376714(0xdb)](_0xc36e84,_0x2c5248))_0xf2ecfd[_0xf2ecfd[_0x376714(0xdd)]]=_0x2c5248;return _0xf2ecfd;},_0x2e5d36(_0x130646);};return function(_0x59ff95){const _0x325408=a4_0x5b73;if(_0x59ff95&&_0x59ff95[_0x325408(0xf3)])return _0x59ff95;var _0x50c470={};if(_0x59ff95!=null){for(var _0x31ed4c=_0x2e5d36(_0x59ff95),_0x1c8a63=0x0;_0x1c8a63<_0x31ed4c[_0x325408(0xdd)];_0x1c8a63++)if(_0x31ed4c[_0x1c8a63]!==_0x325408(0xea))__createBinding(_0x50c470,_0x59ff95,_0x31ed4c[_0x1c8a63]);}return __setModuleDefault(_0x50c470,_0x59ff95),_0x50c470;};}());Object['defineProperty'](exports,a4_0x2c04b9(0xf3),{'value':!![]}),exports[a4_0x2c04b9(0xd8)]=void 0x0;const authService_1=require(a4_0x2c04b9(0xe4)),tokenBlacklistService_1=require(a4_0x2c04b9(0xe3)),telegramBotService_1=require(a4_0x2c04b9(0xd0));class AuthController{constructor(){const _0x20fe84=a4_0x2c04b9;this[_0x20fe84(0xf6)]=async(_0xfb11f8,_0x5a8fa2,_0x3c7987)=>{const _0x136121=_0x20fe84;try{const _0x282284=_0xfb11f8[_0x136121(0xcf)],_0x3a38cb=_0xfb11f8['ip']||_0xfb11f8['connection'][_0x136121(0xed)]||_0x136121(0xf4),_0x122595=_0xfb11f8[_0x136121(0xef)](_0x136121(0xfc))||'unknown';let _0x10c208=![],_0x5a9460=null;try{const _0x47eea3=await this[_0x136121(0xfd)]['login'](_0x282284);_0x10c208=!![],_0x47eea3['role']==='shop'&&_0x47eea3['user']?.['id']&&(_0x5a9460=_0x47eea3['user']['id']),_0x5a9460&&await telegramBotService_1['telegramBotService']['sendLoginNotification'](_0x5a9460,{'username':_0x282284[_0x136121(0xe2)],'ipAddress':_0x3a38cb,'userAgent':_0x122595,'timestamp':new Date(),'success':!![]}),_0x5a8fa2[_0x136121(0xfb)]({'success':!![],'result':_0x47eea3});}catch(_0x1cb43b){try{const _0x441634=(await Promise[_0x136121(0xd5)]()['then'](()=>__importStar(require(_0x136121(0xf8)))))[_0x136121(0xea)],_0x4de699=await _0x441634[_0x136121(0xd7)][_0x136121(0xce)]({'where':{'username':_0x282284['username']},'select':{'id':!![]}});_0x4de699&&await telegramBotService_1[_0x136121(0x101)][_0x136121(0xcd)](_0x4de699['id'],{'username':_0x282284[_0x136121(0xe2)],'ipAddress':_0x3a38cb,'userAgent':_0x122595,'timestamp':new Date(),'success':![]});}catch(_0x44d51e){console['error']('Failed\x20to\x20send\x20failed\x20login\x20notification:',_0x44d51e);}throw _0x1cb43b;}}catch(_0x371e33){_0x3c7987(_0x371e33);}},this['me']=async(_0x2b0e19,_0x1aee6a,_0x50c568)=>{const _0x49a7eb=_0x20fe84;try{const _0x11eb28=_0x2b0e19['user'];_0x1aee6a[_0x49a7eb(0xfb)]({'success':!![],'result':{'id':_0x11eb28?.['id'],'username':_0x11eb28?.[_0x49a7eb(0xe2)],'role':_0x11eb28?.[_0x49a7eb(0xf7)]}});}catch(_0x593142){_0x50c568(_0x593142);}},this[_0x20fe84(0xe6)]=async(_0x31d2e0,_0x1b1e83,_0x9494a8)=>{const _0x22a7b6=_0x20fe84;try{const _0x481aaa=_0x31d2e0[_0x22a7b6(0xff)],_0x473eee=_0x31d2e0['user'];_0x481aaa&&_0x473eee?.[_0x22a7b6(0xd6)]&&tokenBlacklistService_1[_0x22a7b6(0xf5)][_0x22a7b6(0xf2)](_0x481aaa,_0x473eee[_0x22a7b6(0xd6)]),_0x1b1e83[_0x22a7b6(0xfb)]({'success':!![],'message':_0x22a7b6(0xf0)});}catch(_0x3bd385){_0x9494a8(_0x3bd385);}},this[_0x20fe84(0xd4)]=async(_0x1ac883,_0x195515,_0x5c4ace)=>{const _0x43db5e=_0x20fe84;try{const _0x5eb1f6=tokenBlacklistService_1['tokenBlacklistService'][_0x43db5e(0xde)]();_0x195515[_0x43db5e(0xfb)]({'success':!![],'result':_0x5eb1f6});}catch(_0x3f48e5){_0x5c4ace(_0x3f48e5);}},this['authService']=new authService_1['AuthService']();}}function a4_0x5568(){const _0x4617c5=['946477oQTRYC','remoteAddress','5158445lGDDNI','get','Logged\x20out\x20successfully','defineProperty','blacklistToken','__esModule','unknown','tokenBlacklistService','login','role','../config/database','__createBinding','getOwnPropertyDescriptor','json','User-Agent','authService','__setModuleDefault','token','1882lypndM','telegramBotService','sendLoginNotification','findUnique','body','../services/telegramBotService','configurable','545PEwnqI','hasOwnProperty','getBlacklistStats','resolve','exp','shop','AuthController','8PQwhPC','1891256TjOeqr','call','2505066FRJXuS','length','getStats','create','writable','__importStar','username','../services/tokenBlacklistService','../services/authService','prototype','logout','22085420AavDih','9453564OGoTXJ','6TmTXJQ','default','getOwnPropertyNames'];a4_0x5568=function(){return _0x4617c5;};return a4_0x5568();}exports[a4_0x2c04b9(0xd8)]=AuthController;