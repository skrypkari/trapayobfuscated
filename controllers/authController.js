'use strict';const a4_0x2272ac=a4_0xf2cc;(function(_0x349cea,_0xe9b611){const _0x4f4ece=a4_0xf2cc,_0x1e3667=_0x349cea();while(!![]){try{const _0x2e3d04=-parseInt(_0x4f4ece(0x14b))/0x1*(parseInt(_0x4f4ece(0x177))/0x2)+-parseInt(_0x4f4ece(0x14a))/0x3+-parseInt(_0x4f4ece(0x163))/0x4*(-parseInt(_0x4f4ece(0x15a))/0x5)+-parseInt(_0x4f4ece(0x178))/0x6*(-parseInt(_0x4f4ece(0x167))/0x7)+parseInt(_0x4f4ece(0x165))/0x8+parseInt(_0x4f4ece(0x153))/0x9*(parseInt(_0x4f4ece(0x15e))/0xa)+-parseInt(_0x4f4ece(0x16a))/0xb;if(_0x2e3d04===_0xe9b611)break;else _0x1e3667['push'](_0x1e3667['shift']());}catch(_0x2fd7ca){_0x1e3667['push'](_0x1e3667['shift']());}}}(a4_0x4650,0x93424));function a4_0xf2cc(_0x22a083,_0x21adbd){const _0x465058=a4_0x4650();return a4_0xf2cc=function(_0xf2cc92,_0x4acd00){_0xf2cc92=_0xf2cc92-0x148;let _0x315948=_0x465058[_0xf2cc92];return _0x315948;},a4_0xf2cc(_0x22a083,_0x21adbd);}function a4_0x4650(){const _0x20941e=['getOwnPropertyDescriptor','create','defineProperty','__importStar','AuthController','3080vbWBpV','login','sendLoginNotification','prototype','1035530elMzrR','telegramBotService','configurable','../config/database','logout','292sFsCWd','resolve','9149472gyMjAT','default','119ICeujP','error','unknown','24328612PcZZdA','findUnique','body','get','__createBinding','role','../services/authService','AuthService','__esModule','user','shop','length','getStats','1388jmvdXb','417654LpmayU','tokenBlacklistService','token','614934RwsENp','111bNXVlb','../services/telegramBotService','call','json','getOwnPropertyNames','__setModuleDefault','getBlacklistStats','username','63cjwxjq','blacklistToken'];a4_0x4650=function(){return _0x20941e;};return a4_0x4650();}var __createBinding=this&&this[a4_0x2272ac(0x16e)]||(Object[a4_0x2272ac(0x156)]?function(_0x3e93e9,_0x1a3952,_0xc72662,_0x29f6c8){const _0x4a33d4=a4_0x2272ac;if(_0x29f6c8===undefined)_0x29f6c8=_0xc72662;var _0x1576ef=Object[_0x4a33d4(0x155)](_0x1a3952,_0xc72662);(!_0x1576ef||('get'in _0x1576ef?!_0x1a3952[_0x4a33d4(0x172)]:_0x1576ef['writable']||_0x1576ef[_0x4a33d4(0x160)]))&&(_0x1576ef={'enumerable':!![],'get':function(){return _0x1a3952[_0xc72662];}}),Object['defineProperty'](_0x3e93e9,_0x29f6c8,_0x1576ef);}:function(_0x464d88,_0x2c6a9f,_0x326cdd,_0x37f757){if(_0x37f757===undefined)_0x37f757=_0x326cdd;_0x464d88[_0x37f757]=_0x2c6a9f[_0x326cdd];}),__setModuleDefault=this&&this[a4_0x2272ac(0x150)]||(Object['create']?function(_0x2c8607,_0x5ea373){const _0x34c536=a4_0x2272ac;Object[_0x34c536(0x157)](_0x2c8607,_0x34c536(0x166),{'enumerable':!![],'value':_0x5ea373});}:function(_0x2ea85b,_0x42be3a){const _0x1d35f9=a4_0x2272ac;_0x2ea85b[_0x1d35f9(0x166)]=_0x42be3a;}),__importStar=this&&this[a4_0x2272ac(0x158)]||(function(){var _0x4cdd90=function(_0x1da704){const _0x585bf5=a4_0xf2cc;return _0x4cdd90=Object[_0x585bf5(0x14f)]||function(_0xabf403){const _0x370ab3=_0x585bf5;var _0x36797f=[];for(var _0x2aed20 in _0xabf403)if(Object[_0x370ab3(0x15d)]['hasOwnProperty'][_0x370ab3(0x14d)](_0xabf403,_0x2aed20))_0x36797f[_0x36797f[_0x370ab3(0x175)]]=_0x2aed20;return _0x36797f;},_0x4cdd90(_0x1da704);};return function(_0x11e5cf){const _0x3d4667=a4_0xf2cc;if(_0x11e5cf&&_0x11e5cf[_0x3d4667(0x172)])return _0x11e5cf;var _0x1162a7={};if(_0x11e5cf!=null){for(var _0x42ece4=_0x4cdd90(_0x11e5cf),_0x29b81d=0x0;_0x29b81d<_0x42ece4[_0x3d4667(0x175)];_0x29b81d++)if(_0x42ece4[_0x29b81d]!==_0x3d4667(0x166))__createBinding(_0x1162a7,_0x11e5cf,_0x42ece4[_0x29b81d]);}return __setModuleDefault(_0x1162a7,_0x11e5cf),_0x1162a7;};}());Object[a4_0x2272ac(0x157)](exports,a4_0x2272ac(0x172),{'value':!![]}),exports[a4_0x2272ac(0x159)]=void 0x0;const authService_1=require(a4_0x2272ac(0x170)),tokenBlacklistService_1=require('../services/tokenBlacklistService'),telegramBotService_1=require(a4_0x2272ac(0x14c));class AuthController{constructor(){const _0x516f86=a4_0x2272ac;this['login']=async(_0x2abb74,_0x553256,_0x470bf3)=>{const _0x211018=a4_0xf2cc;try{const _0x983a9d=_0x2abb74[_0x211018(0x16c)],_0x283c5f=_0x2abb74['ip']||_0x2abb74['connection']['remoteAddress']||_0x211018(0x169),_0x3c10c8=_0x2abb74[_0x211018(0x16d)]('User-Agent')||_0x211018(0x169);let _0x20a150=![],_0x180a5f=null;try{const _0x9799c1=await this['authService'][_0x211018(0x15b)](_0x983a9d);_0x20a150=!![],_0x9799c1[_0x211018(0x16f)]===_0x211018(0x174)&&_0x9799c1[_0x211018(0x173)]?.['id']&&(_0x180a5f=_0x9799c1[_0x211018(0x173)]['id']),_0x180a5f&&await telegramBotService_1['telegramBotService'][_0x211018(0x15c)](_0x180a5f,{'username':_0x983a9d[_0x211018(0x152)],'ipAddress':_0x283c5f,'userAgent':_0x3c10c8,'timestamp':new Date(),'success':!![]}),_0x553256['json']({'success':!![],'result':_0x9799c1});}catch(_0x1b1f61){try{const _0x3925b5=(await Promise[_0x211018(0x164)]()['then'](()=>__importStar(require(_0x211018(0x161)))))[_0x211018(0x166)],_0x4c1fdd=await _0x3925b5['shop'][_0x211018(0x16b)]({'where':{'username':_0x983a9d[_0x211018(0x152)]},'select':{'id':!![]}});_0x4c1fdd&&await telegramBotService_1[_0x211018(0x15f)][_0x211018(0x15c)](_0x4c1fdd['id'],{'username':_0x983a9d[_0x211018(0x152)],'ipAddress':_0x283c5f,'userAgent':_0x3c10c8,'timestamp':new Date(),'success':![]});}catch(_0x6feb03){console[_0x211018(0x168)]('Failed\x20to\x20send\x20failed\x20login\x20notification:',_0x6feb03);}throw _0x1b1f61;}}catch(_0x367e43){_0x470bf3(_0x367e43);}},this['me']=async(_0xf471ea,_0x5b8928,_0x105379)=>{const _0x462d9e=a4_0xf2cc;try{const _0x544c43=_0xf471ea[_0x462d9e(0x173)];_0x5b8928[_0x462d9e(0x14e)]({'success':!![],'result':{'id':_0x544c43?.['id'],'username':_0x544c43?.[_0x462d9e(0x152)],'role':_0x544c43?.[_0x462d9e(0x16f)]}});}catch(_0x73d2f6){_0x105379(_0x73d2f6);}},this[_0x516f86(0x162)]=async(_0x543d42,_0x448125,_0x3e3745)=>{const _0x334434=_0x516f86;try{const _0x50c734=_0x543d42[_0x334434(0x149)],_0x4c670f=_0x543d42[_0x334434(0x173)];_0x50c734&&_0x4c670f?.['exp']&&tokenBlacklistService_1[_0x334434(0x148)][_0x334434(0x154)](_0x50c734,_0x4c670f['exp']),_0x448125[_0x334434(0x14e)]({'success':!![],'message':'Logged\x20out\x20successfully'});}catch(_0x9e8412){_0x3e3745(_0x9e8412);}},this[_0x516f86(0x151)]=async(_0x299c3a,_0x5a24b8,_0x1bc74f)=>{const _0x4d2b40=_0x516f86;try{const _0x513d22=tokenBlacklistService_1[_0x4d2b40(0x148)][_0x4d2b40(0x176)]();_0x5a24b8[_0x4d2b40(0x14e)]({'success':!![],'result':_0x513d22});}catch(_0x4df28e){_0x1bc74f(_0x4df28e);}},this['authService']=new authService_1[(_0x516f86(0x171))]();}}exports[a4_0x2272ac(0x159)]=AuthController;