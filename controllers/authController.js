'use strict';const a4_0x3f3764=a4_0x4710;(function(_0x485ed1,_0x326958){const _0x1bb40e=a4_0x4710,_0x220f09=_0x485ed1();while(!![]){try{const _0x49cde7=-parseInt(_0x1bb40e(0x7b))/0x1+parseInt(_0x1bb40e(0x82))/0x2+-parseInt(_0x1bb40e(0x9b))/0x3+parseInt(_0x1bb40e(0x9c))/0x4+-parseInt(_0x1bb40e(0x84))/0x5+parseInt(_0x1bb40e(0xa7))/0x6*(parseInt(_0x1bb40e(0x87))/0x7)+-parseInt(_0x1bb40e(0x91))/0x8*(parseInt(_0x1bb40e(0x80))/0x9);if(_0x49cde7===_0x326958)break;else _0x220f09['push'](_0x220f09['shift']());}catch(_0x1336c1){_0x220f09['push'](_0x220f09['shift']());}}}(a4_0x26b3,0xc580d));var __createBinding=this&&this['__createBinding']||(Object[a4_0x3f3764(0xa3)]?function(_0x59d054,_0x1c6c1d,_0x1c79d0,_0x489916){const _0x232388=a4_0x3f3764;if(_0x489916===undefined)_0x489916=_0x1c79d0;var _0x246237=Object['getOwnPropertyDescriptor'](_0x1c6c1d,_0x1c79d0);(!_0x246237||('get'in _0x246237?!_0x1c6c1d[_0x232388(0x98)]:_0x246237[_0x232388(0x7e)]||_0x246237['configurable']))&&(_0x246237={'enumerable':!![],'get':function(){return _0x1c6c1d[_0x1c79d0];}}),Object[_0x232388(0x89)](_0x59d054,_0x489916,_0x246237);}:function(_0x6b6157,_0x3570f4,_0xe759d1,_0x1193db){if(_0x1193db===undefined)_0x1193db=_0xe759d1;_0x6b6157[_0x1193db]=_0x3570f4[_0xe759d1];}),__setModuleDefault=this&&this[a4_0x3f3764(0x7c)]||(Object['create']?function(_0x23752b,_0x72891e){const _0x3972ff=a4_0x3f3764;Object[_0x3972ff(0x89)](_0x23752b,_0x3972ff(0x8a),{'enumerable':!![],'value':_0x72891e});}:function(_0x45eb88,_0x52008b){const _0x50e1ff=a4_0x3f3764;_0x45eb88[_0x50e1ff(0x8a)]=_0x52008b;}),__importStar=this&&this[a4_0x3f3764(0x85)]||(function(){var _0x3cff65=function(_0x559ef4){return _0x3cff65=Object['getOwnPropertyNames']||function(_0x154e14){const _0x212612=a4_0x4710;var _0xf8baad=[];for(var _0x143787 in _0x154e14)if(Object[_0x212612(0x94)][_0x212612(0x99)][_0x212612(0x8d)](_0x154e14,_0x143787))_0xf8baad[_0xf8baad[_0x212612(0x7a)]]=_0x143787;return _0xf8baad;},_0x3cff65(_0x559ef4);};return function(_0x54a0b2){const _0x2137ad=a4_0x4710;if(_0x54a0b2&&_0x54a0b2[_0x2137ad(0x98)])return _0x54a0b2;var _0x43e1ec={};if(_0x54a0b2!=null){for(var _0x17a785=_0x3cff65(_0x54a0b2),_0x4f542c=0x0;_0x4f542c<_0x17a785[_0x2137ad(0x7a)];_0x4f542c++)if(_0x17a785[_0x4f542c]!==_0x2137ad(0x8a))__createBinding(_0x43e1ec,_0x54a0b2,_0x17a785[_0x4f542c]);}return __setModuleDefault(_0x43e1ec,_0x54a0b2),_0x43e1ec;};}());Object['defineProperty'](exports,a4_0x3f3764(0x98),{'value':!![]}),exports[a4_0x3f3764(0x81)]=void 0x0;function a4_0x26b3(){const _0x1256a1=['token','authService','exp','354LxzyzV','body','user','json','login','length','324894CyuYNw','__setModuleDefault','connection','writable','../services/tokenBlacklistService','2887902CvRVlm','AuthController','2115826UenmWE','../services/authService','7858590Gatdmk','__importStar','findUnique','177961GvEyLL','unknown','defineProperty','default','tokenBlacklistService','getBlacklistStats','call','shop','get','AuthService','8MeQeve','resolve','sendLoginNotification','prototype','remoteAddress','username','User-Agent','__esModule','hasOwnProperty','role','431805bMYwPa','2450112tyJlUe','telegramBotService','blacklistToken','Failed\x20to\x20send\x20failed\x20login\x20notification:','error','then','logout','create'];a4_0x26b3=function(){return _0x1256a1;};return a4_0x26b3();}function a4_0x4710(_0x2d2a2f,_0x366c96){const _0x26b3fc=a4_0x26b3();return a4_0x4710=function(_0x4710de,_0x17da0d){_0x4710de=_0x4710de-0x7a;let _0xd34ef9=_0x26b3fc[_0x4710de];return _0xd34ef9;},a4_0x4710(_0x2d2a2f,_0x366c96);}const authService_1=require(a4_0x3f3764(0x83)),tokenBlacklistService_1=require(a4_0x3f3764(0x7f)),telegramBotService_1=require('../services/telegramBotService');class AuthController{constructor(){const _0x179b70=a4_0x3f3764;this[_0x179b70(0xab)]=async(_0x151c00,_0x9b591a,_0x5e6413)=>{const _0x54c9b1=_0x179b70;try{const _0x426c11=_0x151c00[_0x54c9b1(0xa8)],_0x1e4bf3=_0x151c00['ip']||_0x151c00[_0x54c9b1(0x7d)][_0x54c9b1(0x95)]||_0x54c9b1(0x88),_0x35fbdc=_0x151c00[_0x54c9b1(0x8f)](_0x54c9b1(0x97))||_0x54c9b1(0x88);let _0x361b01=![],_0x37d5bc=null;try{const _0x18f8f1=await this['authService'][_0x54c9b1(0xab)](_0x426c11);_0x361b01=!![],_0x18f8f1[_0x54c9b1(0x9a)]===_0x54c9b1(0x8e)&&_0x18f8f1[_0x54c9b1(0xa9)]?.['id']&&(_0x37d5bc=_0x18f8f1[_0x54c9b1(0xa9)]['id']),_0x37d5bc&&await telegramBotService_1[_0x54c9b1(0x9d)][_0x54c9b1(0x93)](_0x37d5bc,{'username':_0x426c11[_0x54c9b1(0x96)],'ipAddress':_0x1e4bf3,'userAgent':_0x35fbdc,'timestamp':new Date(),'success':!![]}),_0x9b591a['json']({'success':!![],'result':_0x18f8f1});}catch(_0x10219b){try{const _0x25bd20=(await Promise[_0x54c9b1(0x92)]()[_0x54c9b1(0xa1)](()=>__importStar(require('../config/database'))))[_0x54c9b1(0x8a)],_0xa7025e=await _0x25bd20[_0x54c9b1(0x8e)][_0x54c9b1(0x86)]({'where':{'username':_0x426c11[_0x54c9b1(0x96)]},'select':{'id':!![]}});_0xa7025e&&await telegramBotService_1[_0x54c9b1(0x9d)][_0x54c9b1(0x93)](_0xa7025e['id'],{'username':_0x426c11['username'],'ipAddress':_0x1e4bf3,'userAgent':_0x35fbdc,'timestamp':new Date(),'success':![]});}catch(_0x5bd8f2){console[_0x54c9b1(0xa0)](_0x54c9b1(0x9f),_0x5bd8f2);}throw _0x10219b;}}catch(_0x3e0d6b){_0x5e6413(_0x3e0d6b);}},this['me']=async(_0x3d4ad6,_0x137292,_0x19883d)=>{const _0x197e43=_0x179b70;try{const _0x37f4a8=_0x3d4ad6[_0x197e43(0xa9)];_0x137292[_0x197e43(0xaa)]({'success':!![],'result':{'id':_0x37f4a8?.['id'],'username':_0x37f4a8?.[_0x197e43(0x96)],'role':_0x37f4a8?.[_0x197e43(0x9a)]}});}catch(_0x2e7572){_0x19883d(_0x2e7572);}},this[_0x179b70(0xa2)]=async(_0x40150d,_0x1ccda9,_0x588d25)=>{const _0x30e49d=_0x179b70;try{const _0x4c97ce=_0x40150d[_0x30e49d(0xa4)],_0x701ad2=_0x40150d[_0x30e49d(0xa9)];_0x4c97ce&&_0x701ad2?.['exp']&&tokenBlacklistService_1['tokenBlacklistService'][_0x30e49d(0x9e)](_0x4c97ce,_0x701ad2[_0x30e49d(0xa6)]),_0x1ccda9[_0x30e49d(0xaa)]({'success':!![],'message':'Logged\x20out\x20successfully'});}catch(_0x509221){_0x588d25(_0x509221);}},this[_0x179b70(0x8c)]=async(_0x1477fe,_0x223b17,_0x21526e)=>{const _0x557b20=_0x179b70;try{const _0xfa70e5=tokenBlacklistService_1[_0x557b20(0x8b)]['getStats']();_0x223b17[_0x557b20(0xaa)]({'success':!![],'result':_0xfa70e5});}catch(_0x4d834f){_0x21526e(_0x4d834f);}},this[_0x179b70(0xa5)]=new authService_1[(_0x179b70(0x90))]();}}exports[a4_0x3f3764(0x81)]=AuthController;