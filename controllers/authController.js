'use strict';function a4_0x4d60(){const _0x16e409=['exp','then','username','getBlacklistStats','login','telegramBotService','findUnique','create','1100UiQPCD','__createBinding','AuthService','3667254oBYYgm','shop','authService','__importStar','AuthController','../services/telegramBotService','User-Agent','blacklistToken','20978380UONTtp','210147LVgVkG','configurable','../services/tokenBlacklistService','call','245440cbKmIO','unknown','prototype','Failed\x20to\x20send\x20failed\x20login\x20notification:','7640AKcGMY','184oVhPEh','tokenBlacklistService','3wBBIvk','sendLoginNotification','get','__setModuleDefault','json','1209194YcvOKU','../config/database','resolve','4602393mjvJbP','defineProperty','Logged\x20out\x20successfully','__esModule','user','default','../services/authService'];a4_0x4d60=function(){return _0x16e409;};return a4_0x4d60();}const a4_0x108768=a4_0x55ce;function a4_0x55ce(_0x217c1d,_0x3092a9){const _0x4d60bd=a4_0x4d60();return a4_0x55ce=function(_0x55ce77,_0x62d02b){_0x55ce77=_0x55ce77-0xa2;let _0x5c7ba4=_0x4d60bd[_0x55ce77];return _0x5c7ba4;},a4_0x55ce(_0x217c1d,_0x3092a9);}(function(_0x100e4a,_0x1eaea0){const _0x4b1083=a4_0x55ce,_0x573f85=_0x100e4a();while(!![]){try{const _0x4fcd82=parseInt(_0x4b1083(0xa2))/0x1+-parseInt(_0x4b1083(0xae))/0x2*(parseInt(_0x4b1083(0xa9))/0x3)+parseInt(_0x4b1083(0xc0))/0x4*(parseInt(_0x4b1083(0xa6))/0x5)+-parseInt(_0x4b1083(0xc3))/0x6+parseInt(_0x4b1083(0xcc))/0x7*(-parseInt(_0x4b1083(0xa7))/0x8)+-parseInt(_0x4b1083(0xb1))/0x9+parseInt(_0x4b1083(0xcb))/0xa;if(_0x4fcd82===_0x1eaea0)break;else _0x573f85['push'](_0x573f85['shift']());}catch(_0xc198ad){_0x573f85['push'](_0x573f85['shift']());}}}(a4_0x4d60,0x546d4));var __createBinding=this&&this[a4_0x108768(0xc1)]||(Object[a4_0x108768(0xbf)]?function(_0x3c48a1,_0x10b2fd,_0xe910e2,_0x3e154e){const _0x16b82b=a4_0x108768;if(_0x3e154e===undefined)_0x3e154e=_0xe910e2;var _0x396d4b=Object['getOwnPropertyDescriptor'](_0x10b2fd,_0xe910e2);(!_0x396d4b||(_0x16b82b(0xab)in _0x396d4b?!_0x10b2fd[_0x16b82b(0xb4)]:_0x396d4b['writable']||_0x396d4b[_0x16b82b(0xcd)]))&&(_0x396d4b={'enumerable':!![],'get':function(){return _0x10b2fd[_0xe910e2];}}),Object['defineProperty'](_0x3c48a1,_0x3e154e,_0x396d4b);}:function(_0x8bdd87,_0x1fd2d3,_0x4d5ac4,_0x101501){if(_0x101501===undefined)_0x101501=_0x4d5ac4;_0x8bdd87[_0x101501]=_0x1fd2d3[_0x4d5ac4];}),__setModuleDefault=this&&this[a4_0x108768(0xac)]||(Object['create']?function(_0x478899,_0x36bc0d){const _0x203bfe=a4_0x108768;Object[_0x203bfe(0xb2)](_0x478899,_0x203bfe(0xb6),{'enumerable':!![],'value':_0x36bc0d});}:function(_0x3c006a,_0x3d1066){const _0x5d63d7=a4_0x108768;_0x3c006a[_0x5d63d7(0xb6)]=_0x3d1066;}),__importStar=this&&this[a4_0x108768(0xc6)]||(function(){var _0x5836a4=function(_0x53d286){return _0x5836a4=Object['getOwnPropertyNames']||function(_0x36cca1){const _0x46f9bc=a4_0x55ce;var _0x787ea3=[];for(var _0x16bd64 in _0x36cca1)if(Object[_0x46f9bc(0xa4)]['hasOwnProperty'][_0x46f9bc(0xcf)](_0x36cca1,_0x16bd64))_0x787ea3[_0x787ea3['length']]=_0x16bd64;return _0x787ea3;},_0x5836a4(_0x53d286);};return function(_0xc26e47){const _0x59da80=a4_0x55ce;if(_0xc26e47&&_0xc26e47['__esModule'])return _0xc26e47;var _0x2fdfc6={};if(_0xc26e47!=null){for(var _0x288598=_0x5836a4(_0xc26e47),_0x112f32=0x0;_0x112f32<_0x288598['length'];_0x112f32++)if(_0x288598[_0x112f32]!==_0x59da80(0xb6))__createBinding(_0x2fdfc6,_0xc26e47,_0x288598[_0x112f32]);}return __setModuleDefault(_0x2fdfc6,_0xc26e47),_0x2fdfc6;};}());Object[a4_0x108768(0xb2)](exports,a4_0x108768(0xb4),{'value':!![]}),exports[a4_0x108768(0xc7)]=void 0x0;const authService_1=require(a4_0x108768(0xb7)),tokenBlacklistService_1=require(a4_0x108768(0xce)),telegramBotService_1=require(a4_0x108768(0xc8));class AuthController{constructor(){const _0x449f0a=a4_0x108768;this[_0x449f0a(0xbc)]=async(_0x5b844b,_0x52390f,_0x176a6c)=>{const _0x431f4f=_0x449f0a;try{const _0x2f94ef=_0x5b844b['body'],_0x833408=_0x5b844b['ip']||_0x5b844b['connection']['remoteAddress']||_0x431f4f(0xa3),_0x390c58=_0x5b844b[_0x431f4f(0xab)](_0x431f4f(0xc9))||_0x431f4f(0xa3);let _0xa189eb=![],_0x8cabb7=null;try{const _0x350cab=await this[_0x431f4f(0xc5)]['login'](_0x2f94ef);_0xa189eb=!![],_0x350cab['role']===_0x431f4f(0xc4)&&_0x350cab[_0x431f4f(0xb5)]?.['id']&&(_0x8cabb7=_0x350cab['user']['id']),_0x8cabb7&&await telegramBotService_1[_0x431f4f(0xbd)][_0x431f4f(0xaa)](_0x8cabb7,{'username':_0x2f94ef['username'],'ipAddress':_0x833408,'userAgent':_0x390c58,'timestamp':new Date(),'success':!![]}),_0x52390f[_0x431f4f(0xad)]({'success':!![],'result':_0x350cab});}catch(_0x264475){try{const _0x4ff68c=(await Promise[_0x431f4f(0xb0)]()[_0x431f4f(0xb9)](()=>__importStar(require(_0x431f4f(0xaf)))))[_0x431f4f(0xb6)],_0x52fce0=await _0x4ff68c[_0x431f4f(0xc4)][_0x431f4f(0xbe)]({'where':{'username':_0x2f94ef[_0x431f4f(0xba)]},'select':{'id':!![]}});_0x52fce0&&await telegramBotService_1[_0x431f4f(0xbd)][_0x431f4f(0xaa)](_0x52fce0['id'],{'username':_0x2f94ef[_0x431f4f(0xba)],'ipAddress':_0x833408,'userAgent':_0x390c58,'timestamp':new Date(),'success':![]});}catch(_0x4d5937){console['error'](_0x431f4f(0xa5),_0x4d5937);}throw _0x264475;}}catch(_0x375f1e){_0x176a6c(_0x375f1e);}},this['me']=async(_0x57c167,_0x770825,_0x6bfc97)=>{const _0x132e14=_0x449f0a;try{const _0x424268=_0x57c167[_0x132e14(0xb5)];_0x770825[_0x132e14(0xad)]({'success':!![],'result':{'id':_0x424268?.['id'],'username':_0x424268?.['username'],'role':_0x424268?.['role']}});}catch(_0x313972){_0x6bfc97(_0x313972);}},this['logout']=async(_0x48b1cc,_0x1cecd0,_0x144541)=>{const _0x55cd1e=_0x449f0a;try{const _0x577d83=_0x48b1cc['token'],_0x160f78=_0x48b1cc['user'];_0x577d83&&_0x160f78?.['exp']&&tokenBlacklistService_1[_0x55cd1e(0xa8)][_0x55cd1e(0xca)](_0x577d83,_0x160f78[_0x55cd1e(0xb8)]),_0x1cecd0['json']({'success':!![],'message':_0x55cd1e(0xb3)});}catch(_0x49d9b4){_0x144541(_0x49d9b4);}},this[_0x449f0a(0xbb)]=async(_0x5a8d99,_0x6fb6fe,_0x38d9f8)=>{const _0x13d6da=_0x449f0a;try{const _0x424c80=tokenBlacklistService_1['tokenBlacklistService']['getStats']();_0x6fb6fe[_0x13d6da(0xad)]({'success':!![],'result':_0x424c80});}catch(_0x2a74ee){_0x38d9f8(_0x2a74ee);}},this['authService']=new authService_1[(_0x449f0a(0xc2))]();}}exports[a4_0x108768(0xc7)]=AuthController;