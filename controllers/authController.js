'use strict';const a4_0x19d8ca=a4_0x52d5;(function(_0x415162,_0x39b0bd){const _0x10ea23=a4_0x52d5,_0x2061b5=_0x415162();while(!![]){try{const _0x3cfdde=-parseInt(_0x10ea23(0xfc))/0x1+-parseInt(_0x10ea23(0xf5))/0x2*(parseInt(_0x10ea23(0x113))/0x3)+-parseInt(_0x10ea23(0x112))/0x4+parseInt(_0x10ea23(0x122))/0x5*(parseInt(_0x10ea23(0x10a))/0x6)+parseInt(_0x10ea23(0x11d))/0x7*(parseInt(_0x10ea23(0x105))/0x8)+parseInt(_0x10ea23(0x117))/0x9*(-parseInt(_0x10ea23(0x10b))/0xa)+-parseInt(_0x10ea23(0x116))/0xb*(-parseInt(_0x10ea23(0x108))/0xc);if(_0x3cfdde===_0x39b0bd)break;else _0x2061b5['push'](_0x2061b5['shift']());}catch(_0x3d19b4){_0x2061b5['push'](_0x2061b5['shift']());}}}(a4_0x6cd3,0xecfa5));function a4_0x6cd3(){const _0x37b911=['unknown','remoteAddress','__setModuleDefault','User-Agent','856770Ytxuwl','../config/database','body','getOwnPropertyNames','username','call','sendLoginNotification','1397131iPUXJF','telegramBotService','getStats','AuthService','exp','token','__esModule','AuthController','../services/telegramBotService','16hzSZKr','create','__createBinding','24KNwXrp','json','6qaGnXJ','957130HDjnlM','error','Logged\x20out\x20successfully','get','__importStar','getBlacklistStats','../services/tokenBlacklistService','6470508YDUEDC','3rTIUCa','hasOwnProperty','length','24037651nsgNoX','63drPAKW','role','login','findUnique','defineProperty','Failed\x20to\x20send\x20failed\x20login\x20notification:','2035012HhFCVz','default','user','writable','../services/authService','659405DgrXvZ','getOwnPropertyDescriptor'];a4_0x6cd3=function(){return _0x37b911;};return a4_0x6cd3();}var __createBinding=this&&this[a4_0x19d8ca(0x107)]||(Object['create']?function(_0xc7d254,_0x26a9a6,_0x552f7e,_0x200aed){const _0x2a39ba=a4_0x19d8ca;if(_0x200aed===undefined)_0x200aed=_0x552f7e;var _0x5bb0f0=Object[_0x2a39ba(0x123)](_0x26a9a6,_0x552f7e);(!_0x5bb0f0||(_0x2a39ba(0x10e)in _0x5bb0f0?!_0x26a9a6[_0x2a39ba(0x102)]:_0x5bb0f0[_0x2a39ba(0x120)]||_0x5bb0f0['configurable']))&&(_0x5bb0f0={'enumerable':!![],'get':function(){return _0x26a9a6[_0x552f7e];}}),Object[_0x2a39ba(0x11b)](_0xc7d254,_0x200aed,_0x5bb0f0);}:function(_0x3a2943,_0x2f8c70,_0x44e4d0,_0x54969a){if(_0x54969a===undefined)_0x54969a=_0x44e4d0;_0x3a2943[_0x54969a]=_0x2f8c70[_0x44e4d0];}),__setModuleDefault=this&&this[a4_0x19d8ca(0x126)]||(Object[a4_0x19d8ca(0x106)]?function(_0xbe9ada,_0x458820){const _0x3e3062=a4_0x19d8ca;Object[_0x3e3062(0x11b)](_0xbe9ada,'default',{'enumerable':!![],'value':_0x458820});}:function(_0x543945,_0x383885){const _0x5dbd33=a4_0x19d8ca;_0x543945[_0x5dbd33(0x11e)]=_0x383885;}),__importStar=this&&this[a4_0x19d8ca(0x10f)]||(function(){var _0x4e7b28=function(_0x38d5c8){const _0x258890=a4_0x52d5;return _0x4e7b28=Object[_0x258890(0xf8)]||function(_0x1acdef){const _0x11af76=_0x258890;var _0x17e7a3=[];for(var _0x36746d in _0x1acdef)if(Object['prototype'][_0x11af76(0x114)][_0x11af76(0xfa)](_0x1acdef,_0x36746d))_0x17e7a3[_0x17e7a3[_0x11af76(0x115)]]=_0x36746d;return _0x17e7a3;},_0x4e7b28(_0x38d5c8);};return function(_0x29358c){const _0x2a0fc0=a4_0x52d5;if(_0x29358c&&_0x29358c[_0x2a0fc0(0x102)])return _0x29358c;var _0x102758={};if(_0x29358c!=null){for(var _0x4f55d1=_0x4e7b28(_0x29358c),_0x639cf9=0x0;_0x639cf9<_0x4f55d1[_0x2a0fc0(0x115)];_0x639cf9++)if(_0x4f55d1[_0x639cf9]!==_0x2a0fc0(0x11e))__createBinding(_0x102758,_0x29358c,_0x4f55d1[_0x639cf9]);}return __setModuleDefault(_0x102758,_0x29358c),_0x102758;};}());Object['defineProperty'](exports,'__esModule',{'value':!![]}),exports[a4_0x19d8ca(0x103)]=void 0x0;function a4_0x52d5(_0x272435,_0x4c65a2){const _0x6cd34f=a4_0x6cd3();return a4_0x52d5=function(_0x52d5ca,_0x5d3273){_0x52d5ca=_0x52d5ca-0xf5;let _0x501359=_0x6cd34f[_0x52d5ca];return _0x501359;},a4_0x52d5(_0x272435,_0x4c65a2);}const authService_1=require(a4_0x19d8ca(0x121)),tokenBlacklistService_1=require(a4_0x19d8ca(0x111)),telegramBotService_1=require(a4_0x19d8ca(0x104));class AuthController{constructor(){const _0x1d53ae=a4_0x19d8ca;this['login']=async(_0x405768,_0x31d556,_0x5ec668)=>{const _0x223884=a4_0x52d5;try{const _0x4abd64=_0x405768[_0x223884(0xf7)],_0xce1830=_0x405768['ip']||_0x405768['connection'][_0x223884(0x125)]||_0x223884(0x124),_0x3acc6=_0x405768[_0x223884(0x10e)](_0x223884(0x127))||_0x223884(0x124);let _0xe1ab39=![],_0x593f33=null;try{const _0x386ac2=await this['authService'][_0x223884(0x119)](_0x4abd64);_0xe1ab39=!![],_0x386ac2[_0x223884(0x118)]==='shop'&&_0x386ac2['user']?.['id']&&(_0x593f33=_0x386ac2[_0x223884(0x11f)]['id']),_0x593f33&&await telegramBotService_1[_0x223884(0xfd)]['sendLoginNotification'](_0x593f33,{'username':_0x4abd64['username'],'ipAddress':_0xce1830,'userAgent':_0x3acc6,'timestamp':new Date(),'success':!![]}),_0x31d556[_0x223884(0x109)]({'success':!![],'result':_0x386ac2});}catch(_0xc11bc9){try{const _0x358821=(await Promise['resolve']()['then'](()=>__importStar(require(_0x223884(0xf6)))))['default'],_0x40bdd4=await _0x358821['shop'][_0x223884(0x11a)]({'where':{'username':_0x4abd64['username']},'select':{'id':!![]}});_0x40bdd4&&await telegramBotService_1[_0x223884(0xfd)][_0x223884(0xfb)](_0x40bdd4['id'],{'username':_0x4abd64[_0x223884(0xf9)],'ipAddress':_0xce1830,'userAgent':_0x3acc6,'timestamp':new Date(),'success':![]});}catch(_0x55e834){console[_0x223884(0x10c)](_0x223884(0x11c),_0x55e834);}throw _0xc11bc9;}}catch(_0xacaeb5){_0x5ec668(_0xacaeb5);}},this['me']=async(_0x2d4a89,_0x44385d,_0x2b34fe)=>{const _0x42865f=a4_0x52d5;try{const _0x41bdb9=_0x2d4a89[_0x42865f(0x11f)];_0x44385d[_0x42865f(0x109)]({'success':!![],'result':{'id':_0x41bdb9?.['id'],'username':_0x41bdb9?.['username'],'role':_0x41bdb9?.[_0x42865f(0x118)]}});}catch(_0x57c81c){_0x2b34fe(_0x57c81c);}},this['logout']=async(_0xbc5a,_0x24970d,_0x693897)=>{const _0x599f27=a4_0x52d5;try{const _0x446338=_0xbc5a[_0x599f27(0x101)],_0x1d8c94=_0xbc5a['user'];_0x446338&&_0x1d8c94?.[_0x599f27(0x100)]&&tokenBlacklistService_1['tokenBlacklistService']['blacklistToken'](_0x446338,_0x1d8c94[_0x599f27(0x100)]),_0x24970d[_0x599f27(0x109)]({'success':!![],'message':_0x599f27(0x10d)});}catch(_0xed0408){_0x693897(_0xed0408);}},this[_0x1d53ae(0x110)]=async(_0x573adb,_0x370b51,_0x401379)=>{const _0x143ca3=_0x1d53ae;try{const _0x20a04c=tokenBlacklistService_1['tokenBlacklistService'][_0x143ca3(0xfe)]();_0x370b51['json']({'success':!![],'result':_0x20a04c});}catch(_0x2a2335){_0x401379(_0x2a2335);}},this['authService']=new authService_1[(_0x1d53ae(0xff))]();}}exports[a4_0x19d8ca(0x103)]=AuthController;