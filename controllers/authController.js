'use strict';function a4_0xd735(){const _0x2c4a0f=['blacklistToken','getOwnPropertyNames','error','AuthService','exp','create','configurable','token','__esModule','login','connection','getStats','findUnique','resolve','45955ZFkMNT','170868RmlQHY','get','../services/telegramBotService','186759AVCJWj','getOwnPropertyDescriptor','48eQXVRk','../services/tokenBlacklistService','body','username','tokenBlacklistService','637724bsFDpc','5zNNcNu','AuthController','20iPWWTg','getBlacklistStats','default','8onrkil','defineProperty','writable','hasOwnProperty','757656ASvTaw','__importStar','telegramBotService','../config/database','remoteAddress','404117eScZYp','length','../services/authService','1437645dLRZzr','then','user','json','authService','shop'];a4_0xd735=function(){return _0x2c4a0f;};return a4_0xd735();}const a4_0x31e183=a4_0x4496;function a4_0x4496(_0x108363,_0x430fd3){const _0xd7350e=a4_0xd735();return a4_0x4496=function(_0x449600,_0x5a7ed1){_0x449600=_0x449600-0x8d;let _0x2a859c=_0xd7350e[_0x449600];return _0x2a859c;},a4_0x4496(_0x108363,_0x430fd3);}(function(_0x598a04,_0x1cd50f){const _0x3112cf=a4_0x4496,_0x5968b5=_0x598a04();while(!![]){try{const _0x2575be=parseInt(_0x3112cf(0xa2))/0x1+-parseInt(_0x3112cf(0xb3))/0x2*(-parseInt(_0x3112cf(0xa3))/0x3)+-parseInt(_0x3112cf(0xad))/0x4*(-parseInt(_0x3112cf(0xae))/0x5)+parseInt(_0x3112cf(0xb7))/0x6+-parseInt(_0x3112cf(0xbc))/0x7+parseInt(_0x3112cf(0xa8))/0x8*(-parseInt(_0x3112cf(0xa6))/0x9)+parseInt(_0x3112cf(0xb0))/0xa*(-parseInt(_0x3112cf(0x8e))/0xb);if(_0x2575be===_0x1cd50f)break;else _0x5968b5['push'](_0x5968b5['shift']());}catch(_0x3c6cf8){_0x5968b5['push'](_0x5968b5['shift']());}}}(a4_0xd735,0x1c493));var __createBinding=this&&this['__createBinding']||(Object[a4_0x31e183(0x99)]?function(_0x572b96,_0x44685b,_0x38692d,_0x18d11c){const _0xfe61c6=a4_0x31e183;if(_0x18d11c===undefined)_0x18d11c=_0x38692d;var _0x87f956=Object[_0xfe61c6(0xa7)](_0x44685b,_0x38692d);(!_0x87f956||(_0xfe61c6(0xa4)in _0x87f956?!_0x44685b[_0xfe61c6(0x9c)]:_0x87f956[_0xfe61c6(0xb5)]||_0x87f956[_0xfe61c6(0x9a)]))&&(_0x87f956={'enumerable':!![],'get':function(){return _0x44685b[_0x38692d];}}),Object[_0xfe61c6(0xb4)](_0x572b96,_0x18d11c,_0x87f956);}:function(_0x144e04,_0x105c08,_0x2aef5c,_0x506674){if(_0x506674===undefined)_0x506674=_0x2aef5c;_0x144e04[_0x506674]=_0x105c08[_0x2aef5c];}),__setModuleDefault=this&&this['__setModuleDefault']||(Object['create']?function(_0xd20009,_0x1b4102){const _0x1709a3=a4_0x31e183;Object[_0x1709a3(0xb4)](_0xd20009,_0x1709a3(0xb2),{'enumerable':!![],'value':_0x1b4102});}:function(_0x3c4c0e,_0x305d5b){const _0x19185c=a4_0x31e183;_0x3c4c0e[_0x19185c(0xb2)]=_0x305d5b;}),__importStar=this&&this[a4_0x31e183(0xb8)]||(function(){var _0x3817e7=function(_0x443c4b){const _0x164599=a4_0x4496;return _0x3817e7=Object[_0x164599(0x95)]||function(_0xe0835c){const _0x2c5071=_0x164599;var _0x3c4dae=[];for(var _0x3ff851 in _0xe0835c)if(Object['prototype'][_0x2c5071(0xb6)]['call'](_0xe0835c,_0x3ff851))_0x3c4dae[_0x3c4dae[_0x2c5071(0xbd)]]=_0x3ff851;return _0x3c4dae;},_0x3817e7(_0x443c4b);};return function(_0x1567f4){const _0xb13594=a4_0x4496;if(_0x1567f4&&_0x1567f4[_0xb13594(0x9c)])return _0x1567f4;var _0x4c003f={};if(_0x1567f4!=null){for(var _0x34f3e4=_0x3817e7(_0x1567f4),_0x812ef1=0x0;_0x812ef1<_0x34f3e4[_0xb13594(0xbd)];_0x812ef1++)if(_0x34f3e4[_0x812ef1]!=='default')__createBinding(_0x4c003f,_0x1567f4,_0x34f3e4[_0x812ef1]);}return __setModuleDefault(_0x4c003f,_0x1567f4),_0x4c003f;};}());Object[a4_0x31e183(0xb4)](exports,'__esModule',{'value':!![]}),exports[a4_0x31e183(0xaf)]=void 0x0;const authService_1=require(a4_0x31e183(0x8d)),tokenBlacklistService_1=require(a4_0x31e183(0xa9)),telegramBotService_1=require(a4_0x31e183(0xa5));class AuthController{constructor(){const _0x24cfa3=a4_0x31e183;this[_0x24cfa3(0x9d)]=async(_0x2dcd9b,_0x1956ad,_0x5d8968)=>{const _0x55d92c=_0x24cfa3;try{const _0x57b23f=_0x2dcd9b[_0x55d92c(0xaa)],_0x13d604=_0x2dcd9b['ip']||_0x2dcd9b[_0x55d92c(0x9e)][_0x55d92c(0xbb)]||'unknown',_0x203272=_0x2dcd9b[_0x55d92c(0xa4)]('User-Agent')||'unknown';let _0x242ba5=![],_0x4d72ee=null;try{const _0x5d2bce=await this[_0x55d92c(0x92)][_0x55d92c(0x9d)](_0x57b23f);_0x242ba5=!![],_0x5d2bce['role']===_0x55d92c(0x93)&&_0x5d2bce['user']?.['id']&&(_0x4d72ee=_0x5d2bce['user']['id']),_0x4d72ee&&await telegramBotService_1[_0x55d92c(0xb9)]['sendLoginNotification'](_0x4d72ee,{'username':_0x57b23f['username'],'ipAddress':_0x13d604,'userAgent':_0x203272,'timestamp':new Date(),'success':!![]}),_0x1956ad[_0x55d92c(0x91)]({'success':!![],'result':_0x5d2bce});}catch(_0x1927d4){try{const _0x4502cb=(await Promise[_0x55d92c(0xa1)]()[_0x55d92c(0x8f)](()=>__importStar(require(_0x55d92c(0xba)))))[_0x55d92c(0xb2)],_0x193f9d=await _0x4502cb['shop'][_0x55d92c(0xa0)]({'where':{'username':_0x57b23f['username']},'select':{'id':!![]}});_0x193f9d&&await telegramBotService_1[_0x55d92c(0xb9)]['sendLoginNotification'](_0x193f9d['id'],{'username':_0x57b23f[_0x55d92c(0xab)],'ipAddress':_0x13d604,'userAgent':_0x203272,'timestamp':new Date(),'success':![]});}catch(_0xd7d876){console[_0x55d92c(0x96)]('Failed\x20to\x20send\x20failed\x20login\x20notification:',_0xd7d876);}throw _0x1927d4;}}catch(_0x4815d2){_0x5d8968(_0x4815d2);}},this['me']=async(_0x37bfdc,_0x3fe8b0,_0x26430a)=>{const _0x406f9c=_0x24cfa3;try{const _0x55448d=_0x37bfdc[_0x406f9c(0x90)];_0x3fe8b0[_0x406f9c(0x91)]({'success':!![],'result':{'id':_0x55448d?.['id'],'username':_0x55448d?.[_0x406f9c(0xab)],'role':_0x55448d?.['role']}});}catch(_0x3ebbc4){_0x26430a(_0x3ebbc4);}},this['logout']=async(_0x2927d8,_0x273a09,_0x1fdc56)=>{const _0x105030=_0x24cfa3;try{const _0x4f4b5c=_0x2927d8[_0x105030(0x9b)],_0x4fed0f=_0x2927d8[_0x105030(0x90)];_0x4f4b5c&&_0x4fed0f?.[_0x105030(0x98)]&&tokenBlacklistService_1[_0x105030(0xac)][_0x105030(0x94)](_0x4f4b5c,_0x4fed0f['exp']),_0x273a09[_0x105030(0x91)]({'success':!![],'message':'Logged\x20out\x20successfully'});}catch(_0x405620){_0x1fdc56(_0x405620);}},this[_0x24cfa3(0xb1)]=async(_0x32cf6c,_0x3516f3,_0x306a0f)=>{const _0x2e7458=_0x24cfa3;try{const _0x5703d6=tokenBlacklistService_1[_0x2e7458(0xac)][_0x2e7458(0x9f)]();_0x3516f3[_0x2e7458(0x91)]({'success':!![],'result':_0x5703d6});}catch(_0x10a63c){_0x306a0f(_0x10a63c);}},this['authService']=new authService_1[(_0x24cfa3(0x97))]();}}exports[a4_0x31e183(0xaf)]=AuthController;