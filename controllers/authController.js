'use strict';const a4_0x8f8ae3=a4_0x219d;function a4_0x45ec(){const _0x7fadd9=['1469937PNDXeK','213648ZnNawR','../services/tokenBlacklistService','149880clRcTD','getOwnPropertyDescriptor','getBlacklistStats','then','findUnique','json','getOwnPropertyNames','login','default','__setModuleDefault','__esModule','call','20UPzVSZ','../config/database','unknown','../services/telegramBotService','authService','shop','exp','blacklistToken','body','18171HFfhHx','writable','User-Agent','321095Zfigva','username','AuthController','6IRCGak','logout','create','length','connection','token','sendLoginNotification','get','user','645064aTKzex','role','__importStar','tokenBlacklistService','prototype','3620160FmGQQg','Failed\x20to\x20send\x20failed\x20login\x20notification:','remoteAddress','defineProperty'];a4_0x45ec=function(){return _0x7fadd9;};return a4_0x45ec();}(function(_0x468754,_0x57b5d5){const _0x311bdf=a4_0x219d,_0x1b0bd4=_0x468754();while(!![]){try{const _0x26596a=-parseInt(_0x311bdf(0x150))/0x1+-parseInt(_0x311bdf(0x14e))/0x2+parseInt(_0x311bdf(0x165))/0x3*(parseInt(_0x311bdf(0x15c))/0x4)+-parseInt(_0x311bdf(0x168))/0x5*(-parseInt(_0x311bdf(0x16b))/0x6)+-parseInt(_0x311bdf(0x14d))/0x7+parseInt(_0x311bdf(0x174))/0x8+parseInt(_0x311bdf(0x179))/0x9;if(_0x26596a===_0x57b5d5)break;else _0x1b0bd4['push'](_0x1b0bd4['shift']());}catch(_0x3a6e8d){_0x1b0bd4['push'](_0x1b0bd4['shift']());}}}(a4_0x45ec,0x1b05a));var __createBinding=this&&this['__createBinding']||(Object[a4_0x8f8ae3(0x16d)]?function(_0x332db4,_0x2eed7c,_0x39c680,_0x5b329c){const _0x355ddd=a4_0x8f8ae3;if(_0x5b329c===undefined)_0x5b329c=_0x39c680;var _0x2e3aa5=Object[_0x355ddd(0x151)](_0x2eed7c,_0x39c680);(!_0x2e3aa5||(_0x355ddd(0x172)in _0x2e3aa5?!_0x2eed7c[_0x355ddd(0x15a)]:_0x2e3aa5[_0x355ddd(0x166)]||_0x2e3aa5['configurable']))&&(_0x2e3aa5={'enumerable':!![],'get':function(){return _0x2eed7c[_0x39c680];}}),Object[_0x355ddd(0x17c)](_0x332db4,_0x5b329c,_0x2e3aa5);}:function(_0x179c5f,_0x27808c,_0x105b37,_0x23bb14){if(_0x23bb14===undefined)_0x23bb14=_0x105b37;_0x179c5f[_0x23bb14]=_0x27808c[_0x105b37];}),__setModuleDefault=this&&this[a4_0x8f8ae3(0x159)]||(Object['create']?function(_0x3eedf9,_0x1a650a){const _0x5a5822=a4_0x8f8ae3;Object[_0x5a5822(0x17c)](_0x3eedf9,_0x5a5822(0x158),{'enumerable':!![],'value':_0x1a650a});}:function(_0x38d74c,_0x5502d3){const _0x5dc228=a4_0x8f8ae3;_0x38d74c[_0x5dc228(0x158)]=_0x5502d3;}),__importStar=this&&this[a4_0x8f8ae3(0x176)]||(function(){var _0x132e34=function(_0x4b0129){const _0x31992d=a4_0x219d;return _0x132e34=Object[_0x31992d(0x156)]||function(_0x236238){const _0x562ee2=_0x31992d;var _0x2ba204=[];for(var _0x23ed5c in _0x236238)if(Object[_0x562ee2(0x178)]['hasOwnProperty'][_0x562ee2(0x15b)](_0x236238,_0x23ed5c))_0x2ba204[_0x2ba204[_0x562ee2(0x16e)]]=_0x23ed5c;return _0x2ba204;},_0x132e34(_0x4b0129);};return function(_0x2f776b){const _0x4b97a3=a4_0x219d;if(_0x2f776b&&_0x2f776b[_0x4b97a3(0x15a)])return _0x2f776b;var _0x5d966e={};if(_0x2f776b!=null){for(var _0x43349f=_0x132e34(_0x2f776b),_0x4a99cc=0x0;_0x4a99cc<_0x43349f[_0x4b97a3(0x16e)];_0x4a99cc++)if(_0x43349f[_0x4a99cc]!==_0x4b97a3(0x158))__createBinding(_0x5d966e,_0x2f776b,_0x43349f[_0x4a99cc]);}return __setModuleDefault(_0x5d966e,_0x2f776b),_0x5d966e;};}());Object[a4_0x8f8ae3(0x17c)](exports,a4_0x8f8ae3(0x15a),{'value':!![]}),exports[a4_0x8f8ae3(0x16a)]=void 0x0;const authService_1=require('../services/authService'),tokenBlacklistService_1=require(a4_0x8f8ae3(0x14f)),telegramBotService_1=require(a4_0x8f8ae3(0x15f));function a4_0x219d(_0x55c0b1,_0x3da2b6){const _0x45ec5c=a4_0x45ec();return a4_0x219d=function(_0x219df8,_0x43f896){_0x219df8=_0x219df8-0x14d;let _0x1622cd=_0x45ec5c[_0x219df8];return _0x1622cd;},a4_0x219d(_0x55c0b1,_0x3da2b6);}class AuthController{constructor(){const _0x4a6fac=a4_0x8f8ae3;this[_0x4a6fac(0x157)]=async(_0x58a06d,_0x5e1f4e,_0x36aeb7)=>{const _0x524f42=_0x4a6fac;try{const _0x4421ed=_0x58a06d[_0x524f42(0x164)],_0x3e79a4=_0x58a06d['ip']||_0x58a06d[_0x524f42(0x16f)][_0x524f42(0x17b)]||_0x524f42(0x15e),_0x538293=_0x58a06d[_0x524f42(0x172)](_0x524f42(0x167))||_0x524f42(0x15e);let _0x28ef91=![],_0x3128cb=null;try{const _0x102e46=await this['authService']['login'](_0x4421ed);_0x28ef91=!![],_0x102e46['role']===_0x524f42(0x161)&&_0x102e46['user']?.['id']&&(_0x3128cb=_0x102e46[_0x524f42(0x173)]['id']),_0x3128cb&&await telegramBotService_1['telegramBotService'][_0x524f42(0x171)](_0x3128cb,{'username':_0x4421ed[_0x524f42(0x169)],'ipAddress':_0x3e79a4,'userAgent':_0x538293,'timestamp':new Date(),'success':!![]}),_0x5e1f4e[_0x524f42(0x155)]({'success':!![],'result':_0x102e46});}catch(_0x563a79){try{const _0x53891d=(await Promise['resolve']()[_0x524f42(0x153)](()=>__importStar(require(_0x524f42(0x15d)))))['default'],_0x244cd3=await _0x53891d['shop'][_0x524f42(0x154)]({'where':{'username':_0x4421ed['username']},'select':{'id':!![]}});_0x244cd3&&await telegramBotService_1['telegramBotService'][_0x524f42(0x171)](_0x244cd3['id'],{'username':_0x4421ed[_0x524f42(0x169)],'ipAddress':_0x3e79a4,'userAgent':_0x538293,'timestamp':new Date(),'success':![]});}catch(_0x325fda){console['error'](_0x524f42(0x17a),_0x325fda);}throw _0x563a79;}}catch(_0x2d5db7){_0x36aeb7(_0x2d5db7);}},this['me']=async(_0x20d364,_0x340ef9,_0x425d5a)=>{const _0x3f08b6=_0x4a6fac;try{const _0x3a6f0e=_0x20d364[_0x3f08b6(0x173)];_0x340ef9[_0x3f08b6(0x155)]({'success':!![],'result':{'id':_0x3a6f0e?.['id'],'username':_0x3a6f0e?.['username'],'role':_0x3a6f0e?.[_0x3f08b6(0x175)]}});}catch(_0x4826d7){_0x425d5a(_0x4826d7);}},this[_0x4a6fac(0x16c)]=async(_0xcfacca,_0x3efd94,_0x1314bf)=>{const _0x33b776=_0x4a6fac;try{const _0x5f2ae0=_0xcfacca[_0x33b776(0x170)],_0x2508ce=_0xcfacca['user'];_0x5f2ae0&&_0x2508ce?.[_0x33b776(0x162)]&&tokenBlacklistService_1[_0x33b776(0x177)][_0x33b776(0x163)](_0x5f2ae0,_0x2508ce[_0x33b776(0x162)]),_0x3efd94[_0x33b776(0x155)]({'success':!![],'message':'Logged\x20out\x20successfully'});}catch(_0x587a3c){_0x1314bf(_0x587a3c);}},this[_0x4a6fac(0x152)]=async(_0x26d1a5,_0xef19e3,_0x45ecd0)=>{const _0x5bc1d0=_0x4a6fac;try{const _0x44ab7d=tokenBlacklistService_1[_0x5bc1d0(0x177)]['getStats']();_0xef19e3['json']({'success':!![],'result':_0x44ab7d});}catch(_0x2a0b24){_0x45ecd0(_0x2a0b24);}},this[_0x4a6fac(0x160)]=new authService_1['AuthService']();}}exports[a4_0x8f8ae3(0x16a)]=AuthController;