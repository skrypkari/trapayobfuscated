'use strict';const a4_0x4b29e3=a4_0x12b3;(function(_0x15fa35,_0x48bf1d){const _0x5b96bf=a4_0x12b3,_0x1ed855=_0x15fa35();while(!![]){try{const _0x5b4ac6=parseInt(_0x5b96bf(0x1b4))/0x1*(parseInt(_0x5b96bf(0x1a4))/0x2)+parseInt(_0x5b96bf(0x1b3))/0x3+parseInt(_0x5b96bf(0x1cd))/0x4+-parseInt(_0x5b96bf(0x1ce))/0x5+parseInt(_0x5b96bf(0x1c4))/0x6*(parseInt(_0x5b96bf(0x1be))/0x7)+-parseInt(_0x5b96bf(0x1a1))/0x8+parseInt(_0x5b96bf(0x1a9))/0x9*(-parseInt(_0x5b96bf(0x1ae))/0xa);if(_0x5b4ac6===_0x48bf1d)break;else _0x1ed855['push'](_0x1ed855['shift']());}catch(_0x1156f2){_0x1ed855['push'](_0x1ed855['shift']());}}}(a4_0x5bd3,0x9565e));function a4_0x12b3(_0x2eb397,_0x52bf7d){const _0x5bd359=a4_0x5bd3();return a4_0x12b3=function(_0x12b3a6,_0x146c3e){_0x12b3a6=_0x12b3a6-0x1a1;let _0x5afe9d=_0x5bd359[_0x12b3a6];return _0x5afe9d;},a4_0x12b3(_0x2eb397,_0x52bf7d);}var __createBinding=this&&this[a4_0x4b29e3(0x1aa)]||(Object[a4_0x4b29e3(0x1cc)]?function(_0xd140e,_0x393bcc,_0x5d6530,_0x14f9e7){const _0x1613cc=a4_0x4b29e3;if(_0x14f9e7===undefined)_0x14f9e7=_0x5d6530;var _0x5a83ad=Object['getOwnPropertyDescriptor'](_0x393bcc,_0x5d6530);(!_0x5a83ad||(_0x1613cc(0x1bd)in _0x5a83ad?!_0x393bcc[_0x1613cc(0x1c3)]:_0x5a83ad['writable']||_0x5a83ad['configurable']))&&(_0x5a83ad={'enumerable':!![],'get':function(){return _0x393bcc[_0x5d6530];}}),Object[_0x1613cc(0x1a8)](_0xd140e,_0x14f9e7,_0x5a83ad);}:function(_0x2ef46b,_0x2bbae3,_0x289e60,_0x106454){if(_0x106454===undefined)_0x106454=_0x289e60;_0x2ef46b[_0x106454]=_0x2bbae3[_0x289e60];}),__setModuleDefault=this&&this[a4_0x4b29e3(0x1a6)]||(Object['create']?function(_0x23153b,_0x5930f6){const _0x491084=a4_0x4b29e3;Object[_0x491084(0x1a8)](_0x23153b,_0x491084(0x1ca),{'enumerable':!![],'value':_0x5930f6});}:function(_0x5213fb,_0x473f6f){const _0x5c6bbb=a4_0x4b29e3;_0x5213fb[_0x5c6bbb(0x1ca)]=_0x473f6f;}),__importStar=this&&this[a4_0x4b29e3(0x1c7)]||(function(){var _0x2096d5=function(_0x80974e){const _0x589283=a4_0x12b3;return _0x2096d5=Object[_0x589283(0x1ab)]||function(_0x25ae79){const _0x2517bd=_0x589283;var _0x4939d9=[];for(var _0x4baf67 in _0x25ae79)if(Object['prototype'][_0x2517bd(0x1b2)][_0x2517bd(0x1b6)](_0x25ae79,_0x4baf67))_0x4939d9[_0x4939d9[_0x2517bd(0x1bc)]]=_0x4baf67;return _0x4939d9;},_0x2096d5(_0x80974e);};return function(_0x6b46){const _0x177ad1=a4_0x12b3;if(_0x6b46&&_0x6b46[_0x177ad1(0x1c3)])return _0x6b46;var _0x324449={};if(_0x6b46!=null){for(var _0x3fcc22=_0x2096d5(_0x6b46),_0x569fe7=0x0;_0x569fe7<_0x3fcc22[_0x177ad1(0x1bc)];_0x569fe7++)if(_0x3fcc22[_0x569fe7]!==_0x177ad1(0x1ca))__createBinding(_0x324449,_0x6b46,_0x3fcc22[_0x569fe7]);}return __setModuleDefault(_0x324449,_0x6b46),_0x324449;};}());Object[a4_0x4b29e3(0x1a8)](exports,a4_0x4b29e3(0x1c3),{'value':!![]}),exports[a4_0x4b29e3(0x1ad)]=void 0x0;const authService_1=require(a4_0x4b29e3(0x1c0)),tokenBlacklistService_1=require(a4_0x4b29e3(0x1ac)),telegramBotService_1=require('../services/telegramBotService');function a4_0x5bd3(){const _0xc16283=['username','User-Agent','hasOwnProperty','152022cCMrid','3xLEafC','AuthService','call','getStats','shop','logout','authService','json','length','get','629013tPyRSd','error','../services/authService','../config/database','getBlacklistStats','__esModule','18uFMpwD','user','role','__importStar','body','connection','default','sendLoginNotification','create','4256064KThPHt','1560650KQMOjv','exp','then','6826056bkYfia','unknown','login','562102FjKZcp','telegramBotService','__setModuleDefault','findUnique','defineProperty','27tnbhDK','__createBinding','getOwnPropertyNames','../services/tokenBlacklistService','AuthController','1500330gVXrVe','tokenBlacklistService'];a4_0x5bd3=function(){return _0xc16283;};return a4_0x5bd3();}class AuthController{constructor(){const _0x2b9bd7=a4_0x4b29e3;this[_0x2b9bd7(0x1a3)]=async(_0x51390f,_0x359728,_0x3c13a9)=>{const _0x14a7f7=_0x2b9bd7;try{const _0x5a784c=_0x51390f[_0x14a7f7(0x1c8)],_0x5c7902=_0x51390f['ip']||_0x51390f[_0x14a7f7(0x1c9)]['remoteAddress']||_0x14a7f7(0x1a2),_0x3aa6df=_0x51390f[_0x14a7f7(0x1bd)](_0x14a7f7(0x1b1))||_0x14a7f7(0x1a2);let _0x56a18a=![],_0x4c5f48=null;try{const _0x8b1e1=await this[_0x14a7f7(0x1ba)]['login'](_0x5a784c);_0x56a18a=!![],_0x8b1e1[_0x14a7f7(0x1c6)]===_0x14a7f7(0x1b8)&&_0x8b1e1['user']?.['id']&&(_0x4c5f48=_0x8b1e1[_0x14a7f7(0x1c5)]['id']),_0x4c5f48&&await telegramBotService_1['telegramBotService']['sendLoginNotification'](_0x4c5f48,{'username':_0x5a784c['username'],'ipAddress':_0x5c7902,'userAgent':_0x3aa6df,'timestamp':new Date(),'success':!![]}),_0x359728[_0x14a7f7(0x1bb)]({'success':!![],'result':_0x8b1e1});}catch(_0x7bcef8){try{const _0x46d8db=(await Promise['resolve']()[_0x14a7f7(0x1d0)](()=>__importStar(require(_0x14a7f7(0x1c1)))))[_0x14a7f7(0x1ca)],_0x16d429=await _0x46d8db[_0x14a7f7(0x1b8)][_0x14a7f7(0x1a7)]({'where':{'username':_0x5a784c[_0x14a7f7(0x1b0)]},'select':{'id':!![]}});_0x16d429&&await telegramBotService_1[_0x14a7f7(0x1a5)][_0x14a7f7(0x1cb)](_0x16d429['id'],{'username':_0x5a784c[_0x14a7f7(0x1b0)],'ipAddress':_0x5c7902,'userAgent':_0x3aa6df,'timestamp':new Date(),'success':![]});}catch(_0xad26b9){console[_0x14a7f7(0x1bf)]('Failed\x20to\x20send\x20failed\x20login\x20notification:',_0xad26b9);}throw _0x7bcef8;}}catch(_0x1a18fc){_0x3c13a9(_0x1a18fc);}},this['me']=async(_0x257685,_0x4feb99,_0x2ea8d9)=>{const _0x1506ad=_0x2b9bd7;try{const _0x48357c=_0x257685[_0x1506ad(0x1c5)];_0x4feb99[_0x1506ad(0x1bb)]({'success':!![],'result':{'id':_0x48357c?.['id'],'username':_0x48357c?.[_0x1506ad(0x1b0)],'role':_0x48357c?.[_0x1506ad(0x1c6)]}});}catch(_0x39bde5){_0x2ea8d9(_0x39bde5);}},this[_0x2b9bd7(0x1b9)]=async(_0x386502,_0x4283f4,_0x45205a)=>{const _0x350963=_0x2b9bd7;try{const _0x4d9adc=_0x386502['token'],_0x342eb2=_0x386502['user'];_0x4d9adc&&_0x342eb2?.[_0x350963(0x1cf)]&&tokenBlacklistService_1['tokenBlacklistService']['blacklistToken'](_0x4d9adc,_0x342eb2[_0x350963(0x1cf)]),_0x4283f4['json']({'success':!![],'message':'Logged\x20out\x20successfully'});}catch(_0x3dbd59){_0x45205a(_0x3dbd59);}},this[_0x2b9bd7(0x1c2)]=async(_0x35df26,_0x571f6e,_0x3fc73c)=>{const _0x5293b5=_0x2b9bd7;try{const _0x45d3e4=tokenBlacklistService_1[_0x5293b5(0x1af)][_0x5293b5(0x1b7)]();_0x571f6e[_0x5293b5(0x1bb)]({'success':!![],'result':_0x45d3e4});}catch(_0x3caf4e){_0x3fc73c(_0x3caf4e);}},this['authService']=new authService_1[(_0x2b9bd7(0x1b5))]();}}exports['AuthController']=AuthController;