'use strict';const a4_0x4efdf3=a4_0x52e3;(function(_0x4f63c8,_0x48e76a){const _0x1c4a88=a4_0x52e3,_0x29edd7=_0x4f63c8();while(!![]){try{const _0x596d5=-parseInt(_0x1c4a88(0x16a))/0x1*(-parseInt(_0x1c4a88(0x18a))/0x2)+parseInt(_0x1c4a88(0x178))/0x3+-parseInt(_0x1c4a88(0x179))/0x4*(parseInt(_0x1c4a88(0x186))/0x5)+parseInt(_0x1c4a88(0x170))/0x6*(parseInt(_0x1c4a88(0x18e))/0x7)+-parseInt(_0x1c4a88(0x16e))/0x8*(-parseInt(_0x1c4a88(0x16d))/0x9)+parseInt(_0x1c4a88(0x196))/0xa*(parseInt(_0x1c4a88(0x187))/0xb)+-parseInt(_0x1c4a88(0x18d))/0xc*(parseInt(_0x1c4a88(0x17e))/0xd);if(_0x596d5===_0x48e76a)break;else _0x29edd7['push'](_0x29edd7['shift']());}catch(_0x1f8e3b){_0x29edd7['push'](_0x29edd7['shift']());}}}(a4_0x2303,0xde785));function a4_0x2303(){const _0x29e086=['AuthController','findUnique','get','authService','sendLoginNotification','shop','147100XpuxGp','default','user','Logged\x20out\x20successfully','getOwnPropertyDescriptor','login','__createBinding','3yApByZ','getStats','role','883107qYLtth','8OZoSQh','hasOwnProperty','6845940ySaStv','json','username','__esModule','connection','../services/authService','../services/telegramBotService','configurable','2709378NIXHKP','288412rVJEXb','resolve','getOwnPropertyNames','then','prototype','13LLURKi','body','tokenBlacklistService','__importStar','telegramBotService','token','create','defineProperty','45PaRhUv','682gPkRAk','__setModuleDefault','exp','284818WBfpNz','User-Agent','length','23055864hDckAj','7StpBnR','unknown'];a4_0x2303=function(){return _0x29e086;};return a4_0x2303();}var __createBinding=this&&this[a4_0x4efdf3(0x169)]||(Object[a4_0x4efdf3(0x184)]?function(_0x50cbde,_0x2bb04a,_0x49a382,_0x29b446){const _0x29fa71=a4_0x4efdf3;if(_0x29b446===undefined)_0x29b446=_0x49a382;var _0x39a2f2=Object[_0x29fa71(0x19a)](_0x2bb04a,_0x49a382);(!_0x39a2f2||('get'in _0x39a2f2?!_0x2bb04a['__esModule']:_0x39a2f2['writable']||_0x39a2f2[_0x29fa71(0x177)]))&&(_0x39a2f2={'enumerable':!![],'get':function(){return _0x2bb04a[_0x49a382];}}),Object['defineProperty'](_0x50cbde,_0x29b446,_0x39a2f2);}:function(_0x1e0253,_0x327903,_0x1ba387,_0x597c8a){if(_0x597c8a===undefined)_0x597c8a=_0x1ba387;_0x1e0253[_0x597c8a]=_0x327903[_0x1ba387];}),__setModuleDefault=this&&this[a4_0x4efdf3(0x188)]||(Object[a4_0x4efdf3(0x184)]?function(_0x3da69d,_0x3de682){const _0x4dc3b1=a4_0x4efdf3;Object[_0x4dc3b1(0x185)](_0x3da69d,'default',{'enumerable':!![],'value':_0x3de682});}:function(_0x45dc8e,_0x3e2422){const _0x4971a2=a4_0x4efdf3;_0x45dc8e[_0x4971a2(0x197)]=_0x3e2422;}),__importStar=this&&this[a4_0x4efdf3(0x181)]||(function(){var _0x4ea630=function(_0x41e9e3){const _0x47939b=a4_0x52e3;return _0x4ea630=Object[_0x47939b(0x17b)]||function(_0x8464a6){const _0x2603f4=_0x47939b;var _0x5802d5=[];for(var _0x536a49 in _0x8464a6)if(Object[_0x2603f4(0x17d)][_0x2603f4(0x16f)]['call'](_0x8464a6,_0x536a49))_0x5802d5[_0x5802d5[_0x2603f4(0x18c)]]=_0x536a49;return _0x5802d5;},_0x4ea630(_0x41e9e3);};return function(_0x10c314){const _0x40b39d=a4_0x52e3;if(_0x10c314&&_0x10c314[_0x40b39d(0x173)])return _0x10c314;var _0x5731c1={};if(_0x10c314!=null){for(var _0x345fac=_0x4ea630(_0x10c314),_0x1859e2=0x0;_0x1859e2<_0x345fac[_0x40b39d(0x18c)];_0x1859e2++)if(_0x345fac[_0x1859e2]!==_0x40b39d(0x197))__createBinding(_0x5731c1,_0x10c314,_0x345fac[_0x1859e2]);}return __setModuleDefault(_0x5731c1,_0x10c314),_0x5731c1;};}());Object[a4_0x4efdf3(0x185)](exports,a4_0x4efdf3(0x173),{'value':!![]}),exports[a4_0x4efdf3(0x190)]=void 0x0;const authService_1=require(a4_0x4efdf3(0x175)),tokenBlacklistService_1=require('../services/tokenBlacklistService'),telegramBotService_1=require(a4_0x4efdf3(0x176));function a4_0x52e3(_0x4249d0,_0x5bd636){const _0x230336=a4_0x2303();return a4_0x52e3=function(_0x52e3b6,_0x42d482){_0x52e3b6=_0x52e3b6-0x168;let _0x47a636=_0x230336[_0x52e3b6];return _0x47a636;},a4_0x52e3(_0x4249d0,_0x5bd636);}class AuthController{constructor(){const _0x34ea3a=a4_0x4efdf3;this[_0x34ea3a(0x168)]=async(_0x3d7c63,_0x557cc2,_0x12e0b7)=>{const _0x3ca877=_0x34ea3a;try{const _0x1c9250=_0x3d7c63[_0x3ca877(0x17f)],_0x37de05=_0x3d7c63['ip']||_0x3d7c63[_0x3ca877(0x174)]['remoteAddress']||'unknown',_0x1246c5=_0x3d7c63[_0x3ca877(0x192)](_0x3ca877(0x18b))||_0x3ca877(0x18f);let _0xe3b941=![],_0x5f3e86=null;try{const _0x55376d=await this['authService'][_0x3ca877(0x168)](_0x1c9250);_0xe3b941=!![],_0x55376d[_0x3ca877(0x16c)]===_0x3ca877(0x195)&&_0x55376d[_0x3ca877(0x198)]?.['id']&&(_0x5f3e86=_0x55376d['user']['id']),_0x5f3e86&&await telegramBotService_1[_0x3ca877(0x182)][_0x3ca877(0x194)](_0x5f3e86,{'username':_0x1c9250[_0x3ca877(0x172)],'ipAddress':_0x37de05,'userAgent':_0x1246c5,'timestamp':new Date(),'success':!![]}),_0x557cc2[_0x3ca877(0x171)]({'success':!![],'result':_0x55376d});}catch(_0xc6cfde){try{const _0x33d1e4=(await Promise[_0x3ca877(0x17a)]()[_0x3ca877(0x17c)](()=>__importStar(require('../config/database'))))[_0x3ca877(0x197)],_0x6b3c70=await _0x33d1e4[_0x3ca877(0x195)][_0x3ca877(0x191)]({'where':{'username':_0x1c9250['username']},'select':{'id':!![]}});_0x6b3c70&&await telegramBotService_1[_0x3ca877(0x182)][_0x3ca877(0x194)](_0x6b3c70['id'],{'username':_0x1c9250['username'],'ipAddress':_0x37de05,'userAgent':_0x1246c5,'timestamp':new Date(),'success':![]});}catch(_0xe28f90){console['error']('Failed\x20to\x20send\x20failed\x20login\x20notification:',_0xe28f90);}throw _0xc6cfde;}}catch(_0x402e2b){_0x12e0b7(_0x402e2b);}},this['me']=async(_0x2c2086,_0x2d1d03,_0x4b2655)=>{const _0x2a4795=_0x34ea3a;try{const _0x432512=_0x2c2086[_0x2a4795(0x198)];_0x2d1d03[_0x2a4795(0x171)]({'success':!![],'result':{'id':_0x432512?.['id'],'username':_0x432512?.['username'],'role':_0x432512?.[_0x2a4795(0x16c)]}});}catch(_0x16e8e6){_0x4b2655(_0x16e8e6);}},this['logout']=async(_0x5b0013,_0x11529a,_0x2ef79c)=>{const _0x4d8785=_0x34ea3a;try{const _0x46cd3f=_0x5b0013[_0x4d8785(0x183)],_0x5abaab=_0x5b0013[_0x4d8785(0x198)];_0x46cd3f&&_0x5abaab?.['exp']&&tokenBlacklistService_1['tokenBlacklistService']['blacklistToken'](_0x46cd3f,_0x5abaab[_0x4d8785(0x189)]),_0x11529a['json']({'success':!![],'message':_0x4d8785(0x199)});}catch(_0x2401fb){_0x2ef79c(_0x2401fb);}},this['getBlacklistStats']=async(_0x33456c,_0x3e6a69,_0x3cf903)=>{const _0x55bf1d=_0x34ea3a;try{const _0x1a8145=tokenBlacklistService_1[_0x55bf1d(0x180)][_0x55bf1d(0x16b)]();_0x3e6a69[_0x55bf1d(0x171)]({'success':!![],'result':_0x1a8145});}catch(_0xdcf4a7){_0x3cf903(_0xdcf4a7);}},this[_0x34ea3a(0x193)]=new authService_1['AuthService']();}}exports[a4_0x4efdf3(0x190)]=AuthController;