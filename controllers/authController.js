'use strict';function a4_0x32da(){const _0x317296=['../config/database','length','sendLoginNotification','username','__setModuleDefault','6510136KGQEBA','getBlacklistStats','132osBHqC','../services/tokenBlacklistService','remoteAddress','user','authService','login','AuthService','logout','configurable','3110312CCitbE','getOwnPropertyNames','role','Failed\x20to\x20send\x20failed\x20login\x20notification:','270977damLvW','AuthController','default','User-Agent','body','unknown','328790yrlHER','15492438AymOfT','json','7449WXnTIP','findUnique','then','resolve','706XEeGdv','shop','exp','468907AyveRc','__importStar','__createBinding','telegramBotService','getOwnPropertyDescriptor','__esModule','defineProperty','error','tokenBlacklistService','blacklistToken','connection','call'];a4_0x32da=function(){return _0x317296;};return a4_0x32da();}const a4_0x146661=a4_0x56eb;(function(_0x67833d,_0x9547c3){const _0x39de07=a4_0x56eb,_0x4aacca=_0x67833d();while(!![]){try{const _0x38a735=parseInt(_0x39de07(0x127))/0x1+-parseInt(_0x39de07(0x124))/0x2*(parseInt(_0x39de07(0x120))/0x3)+-parseInt(_0x39de07(0x143))/0x4+parseInt(_0x39de07(0x11d))/0x5+parseInt(_0x39de07(0x13a))/0x6*(-parseInt(_0x39de07(0x117))/0x7)+parseInt(_0x39de07(0x138))/0x8+parseInt(_0x39de07(0x11e))/0x9;if(_0x38a735===_0x9547c3)break;else _0x4aacca['push'](_0x4aacca['shift']());}catch(_0x1fcf41){_0x4aacca['push'](_0x4aacca['shift']());}}}(a4_0x32da,0x89b7f));var __createBinding=this&&this[a4_0x146661(0x129)]||(Object['create']?function(_0xe42046,_0x33c4f4,_0x19e88e,_0x4aba60){const _0x17081b=a4_0x146661;if(_0x4aba60===undefined)_0x4aba60=_0x19e88e;var _0x5c0a53=Object[_0x17081b(0x12b)](_0x33c4f4,_0x19e88e);(!_0x5c0a53||('get'in _0x5c0a53?!_0x33c4f4[_0x17081b(0x12c)]:_0x5c0a53['writable']||_0x5c0a53[_0x17081b(0x142)]))&&(_0x5c0a53={'enumerable':!![],'get':function(){return _0x33c4f4[_0x19e88e];}}),Object[_0x17081b(0x12d)](_0xe42046,_0x4aba60,_0x5c0a53);}:function(_0x255434,_0x1ed808,_0x16a152,_0x10170e){if(_0x10170e===undefined)_0x10170e=_0x16a152;_0x255434[_0x10170e]=_0x1ed808[_0x16a152];}),__setModuleDefault=this&&this[a4_0x146661(0x137)]||(Object['create']?function(_0x30ca9c,_0x41f435){const _0x37ae89=a4_0x146661;Object[_0x37ae89(0x12d)](_0x30ca9c,_0x37ae89(0x119),{'enumerable':!![],'value':_0x41f435});}:function(_0xe0af29,_0x32e96d){_0xe0af29['default']=_0x32e96d;}),__importStar=this&&this[a4_0x146661(0x128)]||(function(){var _0x362af6=function(_0x45c998){const _0x9e72d2=a4_0x56eb;return _0x362af6=Object[_0x9e72d2(0x144)]||function(_0x37af98){const _0x43ab65=_0x9e72d2;var _0x301db7=[];for(var _0x5aa4da in _0x37af98)if(Object['prototype']['hasOwnProperty'][_0x43ab65(0x132)](_0x37af98,_0x5aa4da))_0x301db7[_0x301db7[_0x43ab65(0x134)]]=_0x5aa4da;return _0x301db7;},_0x362af6(_0x45c998);};return function(_0x2167a1){const _0x115352=a4_0x56eb;if(_0x2167a1&&_0x2167a1[_0x115352(0x12c)])return _0x2167a1;var _0x3ebeec={};if(_0x2167a1!=null){for(var _0x50bb6d=_0x362af6(_0x2167a1),_0x83b5f4=0x0;_0x83b5f4<_0x50bb6d[_0x115352(0x134)];_0x83b5f4++)if(_0x50bb6d[_0x83b5f4]!==_0x115352(0x119))__createBinding(_0x3ebeec,_0x2167a1,_0x50bb6d[_0x83b5f4]);}return __setModuleDefault(_0x3ebeec,_0x2167a1),_0x3ebeec;};}());Object[a4_0x146661(0x12d)](exports,a4_0x146661(0x12c),{'value':!![]}),exports[a4_0x146661(0x118)]=void 0x0;const authService_1=require('../services/authService'),tokenBlacklistService_1=require(a4_0x146661(0x13b)),telegramBotService_1=require('../services/telegramBotService');class AuthController{constructor(){const _0x444ccd=a4_0x146661;this[_0x444ccd(0x13f)]=async(_0x15ec58,_0x360e0f,_0x34aff7)=>{const _0x30a709=_0x444ccd;try{const _0x5f0193=_0x15ec58[_0x30a709(0x11b)],_0x58f8c9=_0x15ec58['ip']||_0x15ec58[_0x30a709(0x131)][_0x30a709(0x13c)]||_0x30a709(0x11c),_0x2d4bea=_0x15ec58['get'](_0x30a709(0x11a))||_0x30a709(0x11c);let _0x434975=![],_0x468674=null;try{const _0x56d9b7=await this['authService'][_0x30a709(0x13f)](_0x5f0193);_0x434975=!![],_0x56d9b7[_0x30a709(0x145)]===_0x30a709(0x125)&&_0x56d9b7[_0x30a709(0x13d)]?.['id']&&(_0x468674=_0x56d9b7[_0x30a709(0x13d)]['id']),_0x468674&&await telegramBotService_1[_0x30a709(0x12a)][_0x30a709(0x135)](_0x468674,{'username':_0x5f0193[_0x30a709(0x136)],'ipAddress':_0x58f8c9,'userAgent':_0x2d4bea,'timestamp':new Date(),'success':!![]}),_0x360e0f[_0x30a709(0x11f)]({'success':!![],'result':_0x56d9b7});}catch(_0x3db3f0){try{const _0x48d1b8=(await Promise[_0x30a709(0x123)]()[_0x30a709(0x122)](()=>__importStar(require(_0x30a709(0x133)))))[_0x30a709(0x119)],_0x141aca=await _0x48d1b8['shop'][_0x30a709(0x121)]({'where':{'username':_0x5f0193[_0x30a709(0x136)]},'select':{'id':!![]}});_0x141aca&&await telegramBotService_1[_0x30a709(0x12a)][_0x30a709(0x135)](_0x141aca['id'],{'username':_0x5f0193['username'],'ipAddress':_0x58f8c9,'userAgent':_0x2d4bea,'timestamp':new Date(),'success':![]});}catch(_0x4e9eed){console[_0x30a709(0x12e)](_0x30a709(0x146),_0x4e9eed);}throw _0x3db3f0;}}catch(_0x2de8bb){_0x34aff7(_0x2de8bb);}},this['me']=async(_0x22fafd,_0x312bcf,_0x5d005b)=>{const _0x53dd52=_0x444ccd;try{const _0x20a499=_0x22fafd[_0x53dd52(0x13d)];_0x312bcf[_0x53dd52(0x11f)]({'success':!![],'result':{'id':_0x20a499?.['id'],'username':_0x20a499?.[_0x53dd52(0x136)],'role':_0x20a499?.[_0x53dd52(0x145)]}});}catch(_0x18fca2){_0x5d005b(_0x18fca2);}},this[_0x444ccd(0x141)]=async(_0x4f0713,_0x5c0c6f,_0x5e1a61)=>{const _0x3850e7=_0x444ccd;try{const _0x88f9b0=_0x4f0713['token'],_0x73bdc6=_0x4f0713[_0x3850e7(0x13d)];_0x88f9b0&&_0x73bdc6?.[_0x3850e7(0x126)]&&tokenBlacklistService_1[_0x3850e7(0x12f)][_0x3850e7(0x130)](_0x88f9b0,_0x73bdc6[_0x3850e7(0x126)]),_0x5c0c6f[_0x3850e7(0x11f)]({'success':!![],'message':'Logged\x20out\x20successfully'});}catch(_0x2598dc){_0x5e1a61(_0x2598dc);}},this[_0x444ccd(0x139)]=async(_0x2b1a75,_0x257bb3,_0x310d96)=>{const _0x55282b=_0x444ccd;try{const _0x1ef390=tokenBlacklistService_1['tokenBlacklistService']['getStats']();_0x257bb3[_0x55282b(0x11f)]({'success':!![],'result':_0x1ef390});}catch(_0x5eafe2){_0x310d96(_0x5eafe2);}},this[_0x444ccd(0x13e)]=new authService_1[(_0x444ccd(0x140))]();}}function a4_0x56eb(_0x6ed865,_0x30af20){const _0x32da7c=a4_0x32da();return a4_0x56eb=function(_0x56ebb1,_0x26acb9){_0x56ebb1=_0x56ebb1-0x117;let _0xef9496=_0x32da7c[_0x56ebb1];return _0xef9496;},a4_0x56eb(_0x6ed865,_0x30af20);}exports[a4_0x146661(0x118)]=AuthController;