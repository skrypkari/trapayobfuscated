'use strict';const a4_0x47b259=a4_0x174f;(function(_0x5b70a1,_0x309c0a){const _0xe66bea=a4_0x174f,_0x28e71d=_0x5b70a1();while(!![]){try{const _0x42a848=parseInt(_0xe66bea(0x84))/0x1*(-parseInt(_0xe66bea(0xa7))/0x2)+parseInt(_0xe66bea(0x8f))/0x3*(parseInt(_0xe66bea(0xb2))/0x4)+parseInt(_0xe66bea(0x9c))/0x5*(parseInt(_0xe66bea(0x82))/0x6)+parseInt(_0xe66bea(0x97))/0x7+parseInt(_0xe66bea(0x8a))/0x8*(parseInt(_0xe66bea(0x8b))/0x9)+-parseInt(_0xe66bea(0xa0))/0xa+-parseInt(_0xe66bea(0xa2))/0xb*(parseInt(_0xe66bea(0x8d))/0xc);if(_0x42a848===_0x309c0a)break;else _0x28e71d['push'](_0x28e71d['shift']());}catch(_0x1837f6){_0x28e71d['push'](_0x28e71d['shift']());}}}(a4_0x5844,0x6de50));function a4_0x174f(_0x859fdd,_0xe6f6db){const _0x58444e=a4_0x5844();return a4_0x174f=function(_0x174f29,_0x11832c){_0x174f29=_0x174f29-0x81;let _0x9fc20b=_0x58444e[_0x174f29];return _0x9fc20b;},a4_0x174f(_0x859fdd,_0xe6f6db);}function a4_0x5844(){const _0x581e90=['token','78966BGMNUT','Failed\x20to\x20send\x20failed\x20login\x20notification:','writable','call','blacklistToken','remoteAddress','defineProperty','hasOwnProperty','5401585UXipHN','default','body','unknown','error','2515JTWGZK','telegramBotService','tokenBlacklistService','authService','1577080wUAiXr','get','46332GmMiSX','__esModule','Logged\x20out\x20successfully','getOwnPropertyNames','AuthService','424fYVvGU','create','__setModuleDefault','login','configurable','__createBinding','AuthController','length','getOwnPropertyDescriptor','exp','role','8pbvIXH','getBlacklistStats','../services/authService','username','714drQIGo','User-Agent','3436JYEeiH','../config/database','user','shop','prototype','json','1666144GahvoF','27UTKdaH','sendLoginNotification','492dzoGDl'];a4_0x5844=function(){return _0x581e90;};return a4_0x5844();}var __createBinding=this&&this[a4_0x47b259(0xac)]||(Object[a4_0x47b259(0xa8)]?function(_0x4fe88c,_0x590623,_0x1fe2e0,_0x1bf02c){const _0x4f9aaf=a4_0x47b259;if(_0x1bf02c===undefined)_0x1bf02c=_0x1fe2e0;var _0x1aadc4=Object[_0x4f9aaf(0xaf)](_0x590623,_0x1fe2e0);(!_0x1aadc4||(_0x4f9aaf(0xa1)in _0x1aadc4?!_0x590623['__esModule']:_0x1aadc4[_0x4f9aaf(0x91)]||_0x1aadc4[_0x4f9aaf(0xab)]))&&(_0x1aadc4={'enumerable':!![],'get':function(){return _0x590623[_0x1fe2e0];}}),Object[_0x4f9aaf(0x95)](_0x4fe88c,_0x1bf02c,_0x1aadc4);}:function(_0x58ed09,_0x1fe9c0,_0x2854ab,_0x3024dc){if(_0x3024dc===undefined)_0x3024dc=_0x2854ab;_0x58ed09[_0x3024dc]=_0x1fe9c0[_0x2854ab];}),__setModuleDefault=this&&this[a4_0x47b259(0xa9)]||(Object['create']?function(_0x719954,_0x174e4d){const _0x265555=a4_0x47b259;Object[_0x265555(0x95)](_0x719954,_0x265555(0x98),{'enumerable':!![],'value':_0x174e4d});}:function(_0x39c2e3,_0x105ac1){const _0x281084=a4_0x47b259;_0x39c2e3[_0x281084(0x98)]=_0x105ac1;}),__importStar=this&&this['__importStar']||(function(){var _0x18344e=function(_0x56112b){const _0x3db5f4=a4_0x174f;return _0x18344e=Object[_0x3db5f4(0xa5)]||function(_0x1d0054){const _0x589d5e=_0x3db5f4;var _0x28d589=[];for(var _0x373ad6 in _0x1d0054)if(Object[_0x589d5e(0x88)][_0x589d5e(0x96)][_0x589d5e(0x92)](_0x1d0054,_0x373ad6))_0x28d589[_0x28d589[_0x589d5e(0xae)]]=_0x373ad6;return _0x28d589;},_0x18344e(_0x56112b);};return function(_0x1532e3){const _0x16d52d=a4_0x174f;if(_0x1532e3&&_0x1532e3[_0x16d52d(0xa3)])return _0x1532e3;var _0x211cc7={};if(_0x1532e3!=null){for(var _0x3950ce=_0x18344e(_0x1532e3),_0x4b415c=0x0;_0x4b415c<_0x3950ce[_0x16d52d(0xae)];_0x4b415c++)if(_0x3950ce[_0x4b415c]!==_0x16d52d(0x98))__createBinding(_0x211cc7,_0x1532e3,_0x3950ce[_0x4b415c]);}return __setModuleDefault(_0x211cc7,_0x1532e3),_0x211cc7;};}());Object[a4_0x47b259(0x95)](exports,a4_0x47b259(0xa3),{'value':!![]}),exports[a4_0x47b259(0xad)]=void 0x0;const authService_1=require(a4_0x47b259(0xb4)),tokenBlacklistService_1=require('../services/tokenBlacklistService'),telegramBotService_1=require('../services/telegramBotService');class AuthController{constructor(){const _0xbc1876=a4_0x47b259;this['login']=async(_0x2ce963,_0x6b335c,_0x448d28)=>{const _0x51084f=a4_0x174f;try{const _0x415a7a=_0x2ce963[_0x51084f(0x99)],_0xa1640b=_0x2ce963['ip']||_0x2ce963['connection'][_0x51084f(0x94)]||_0x51084f(0x9a),_0x475aca=_0x2ce963[_0x51084f(0xa1)](_0x51084f(0x83))||_0x51084f(0x9a);let _0x50ecbe=![],_0x4f31b2=null;try{const _0x10494a=await this[_0x51084f(0x9f)][_0x51084f(0xaa)](_0x415a7a);_0x50ecbe=!![],_0x10494a['role']===_0x51084f(0x87)&&_0x10494a[_0x51084f(0x86)]?.['id']&&(_0x4f31b2=_0x10494a[_0x51084f(0x86)]['id']),_0x4f31b2&&await telegramBotService_1[_0x51084f(0x9d)][_0x51084f(0x8c)](_0x4f31b2,{'username':_0x415a7a[_0x51084f(0x81)],'ipAddress':_0xa1640b,'userAgent':_0x475aca,'timestamp':new Date(),'success':!![]}),_0x6b335c[_0x51084f(0x89)]({'success':!![],'result':_0x10494a});}catch(_0xf6b143){try{const _0x4f8dde=(await Promise['resolve']()['then'](()=>__importStar(require(_0x51084f(0x85)))))[_0x51084f(0x98)],_0x512e62=await _0x4f8dde[_0x51084f(0x87)]['findUnique']({'where':{'username':_0x415a7a[_0x51084f(0x81)]},'select':{'id':!![]}});_0x512e62&&await telegramBotService_1[_0x51084f(0x9d)][_0x51084f(0x8c)](_0x512e62['id'],{'username':_0x415a7a[_0x51084f(0x81)],'ipAddress':_0xa1640b,'userAgent':_0x475aca,'timestamp':new Date(),'success':![]});}catch(_0x2c2e50){console[_0x51084f(0x9b)](_0x51084f(0x90),_0x2c2e50);}throw _0xf6b143;}}catch(_0x5ad1a7){_0x448d28(_0x5ad1a7);}},this['me']=async(_0x214179,_0x2e676d,_0x51de87)=>{const _0x4b60c3=a4_0x174f;try{const _0x2d240d=_0x214179[_0x4b60c3(0x86)];_0x2e676d['json']({'success':!![],'result':{'id':_0x2d240d?.['id'],'username':_0x2d240d?.[_0x4b60c3(0x81)],'role':_0x2d240d?.[_0x4b60c3(0xb1)]}});}catch(_0x4adbce){_0x51de87(_0x4adbce);}},this['logout']=async(_0x4a1caa,_0x6a2369,_0x3e7aa5)=>{const _0x5d9da2=a4_0x174f;try{const _0x4c1fb3=_0x4a1caa[_0x5d9da2(0x8e)],_0x1a8dc8=_0x4a1caa[_0x5d9da2(0x86)];_0x4c1fb3&&_0x1a8dc8?.[_0x5d9da2(0xb0)]&&tokenBlacklistService_1[_0x5d9da2(0x9e)][_0x5d9da2(0x93)](_0x4c1fb3,_0x1a8dc8['exp']),_0x6a2369['json']({'success':!![],'message':_0x5d9da2(0xa4)});}catch(_0x1c8aae){_0x3e7aa5(_0x1c8aae);}},this[_0xbc1876(0xb3)]=async(_0x168603,_0x563fe1,_0x2ff6eb)=>{const _0x4873f8=_0xbc1876;try{const _0x2f3a34=tokenBlacklistService_1[_0x4873f8(0x9e)]['getStats']();_0x563fe1[_0x4873f8(0x89)]({'success':!![],'result':_0x2f3a34});}catch(_0x2ff703){_0x2ff6eb(_0x2ff703);}},this[_0xbc1876(0x9f)]=new authService_1[(_0xbc1876(0xa6))]();}}exports[a4_0x47b259(0xad)]=AuthController;