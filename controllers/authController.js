'use strict';const a4_0x161d9e=a4_0xea08;(function(_0x251ee5,_0x46eb58){const _0x544fc4=a4_0xea08,_0x38ec36=_0x251ee5();while(!![]){try{const _0xd583a2=-parseInt(_0x544fc4(0x10c))/0x1+parseInt(_0x544fc4(0x13a))/0x2+-parseInt(_0x544fc4(0x134))/0x3*(parseInt(_0x544fc4(0x126))/0x4)+parseInt(_0x544fc4(0x138))/0x5+parseInt(_0x544fc4(0x141))/0x6+parseInt(_0x544fc4(0x142))/0x7*(parseInt(_0x544fc4(0x143))/0x8)+-parseInt(_0x544fc4(0x139))/0x9;if(_0xd583a2===_0x46eb58)break;else _0x38ec36['push'](_0x38ec36['shift']());}catch(_0xce167d){_0x38ec36['push'](_0x38ec36['shift']());}}}(a4_0x43e8,0x2b000));var __createBinding=this&&this['__createBinding']||(Object['create']?function(_0x2afdad,_0x7f3a3f,_0x2d7b56,_0x17643b){const _0x589cc2=a4_0xea08;if(_0x17643b===undefined)_0x17643b=_0x2d7b56;var _0x3668c8=Object[_0x589cc2(0x10e)](_0x7f3a3f,_0x2d7b56);(!_0x3668c8||(_0x589cc2(0x12f)in _0x3668c8?!_0x7f3a3f[_0x589cc2(0x136)]:_0x3668c8[_0x589cc2(0x110)]||_0x3668c8[_0x589cc2(0x10f)]))&&(_0x3668c8={'enumerable':!![],'get':function(){return _0x7f3a3f[_0x2d7b56];}}),Object['defineProperty'](_0x2afdad,_0x17643b,_0x3668c8);}:function(_0x532c6b,_0x353656,_0x218105,_0x20da86){if(_0x20da86===undefined)_0x20da86=_0x218105;_0x532c6b[_0x20da86]=_0x353656[_0x218105];}),__setModuleDefault=this&&this[a4_0x161d9e(0x11e)]||(Object[a4_0x161d9e(0x10d)]?function(_0x804aa0,_0x502304){const _0x499f6e=a4_0x161d9e;Object[_0x499f6e(0x130)](_0x804aa0,_0x499f6e(0x11a),{'enumerable':!![],'value':_0x502304});}:function(_0x5b9b7f,_0xa8e31a){const _0x15bdd7=a4_0x161d9e;_0x5b9b7f[_0x15bdd7(0x11a)]=_0xa8e31a;}),__importStar=this&&this[a4_0x161d9e(0x13b)]||(function(){var _0x4c41d1=function(_0x4b0c18){const _0x480767=a4_0xea08;return _0x4c41d1=Object[_0x480767(0x11d)]||function(_0x5dbaf7){const _0x32c974=_0x480767;var _0x3889ba=[];for(var _0x194284 in _0x5dbaf7)if(Object[_0x32c974(0x11c)]['hasOwnProperty']['call'](_0x5dbaf7,_0x194284))_0x3889ba[_0x3889ba[_0x32c974(0x118)]]=_0x194284;return _0x3889ba;},_0x4c41d1(_0x4b0c18);};return function(_0x480d01){const _0x5c6c18=a4_0xea08;if(_0x480d01&&_0x480d01[_0x5c6c18(0x136)])return _0x480d01;var _0x1599cf={};if(_0x480d01!=null){for(var _0x4cbba5=_0x4c41d1(_0x480d01),_0x50ca8b=0x0;_0x50ca8b<_0x4cbba5[_0x5c6c18(0x118)];_0x50ca8b++)if(_0x4cbba5[_0x50ca8b]!==_0x5c6c18(0x11a))__createBinding(_0x1599cf,_0x480d01,_0x4cbba5[_0x50ca8b]);}return __setModuleDefault(_0x1599cf,_0x480d01),_0x1599cf;};}());Object['defineProperty'](exports,a4_0x161d9e(0x136),{'value':!![]}),exports[a4_0x161d9e(0x112)]=void 0x0;const authService_1=require(a4_0x161d9e(0x121)),tokenBlacklistService_1=require(a4_0x161d9e(0x11f)),telegramBotService_1=require(a4_0x161d9e(0x125));class AuthController{constructor(){const _0x26dc9b=a4_0x161d9e;this['login']=async(_0x383b24,_0x26e333,_0x2d6d86)=>{const _0x4c8612=a4_0xea08;try{const _0x13f0d7=_0x383b24[_0x4c8612(0x113)],_0x1da30b=_0x383b24['ip']||_0x383b24[_0x4c8612(0x111)][_0x4c8612(0x140)]||_0x4c8612(0x13d),_0x206b1d=_0x383b24[_0x4c8612(0x12f)](_0x4c8612(0x119))||_0x4c8612(0x13d);let _0x1fb417=![],_0x430888=null;try{const _0x4861fd=await this['authService'][_0x4c8612(0x129)](_0x13f0d7);_0x1fb417=!![],_0x4861fd[_0x4c8612(0x13c)]===_0x4c8612(0x12b)&&_0x4861fd[_0x4c8612(0x11b)]?.['id']&&(_0x430888=_0x4861fd[_0x4c8612(0x11b)]['id']),_0x430888&&await telegramBotService_1['telegramBotService'][_0x4c8612(0x133)](_0x430888,{'username':_0x13f0d7[_0x4c8612(0x128)],'ipAddress':_0x1da30b,'userAgent':_0x206b1d,'timestamp':new Date(),'success':!![]}),_0x26e333['json']({'success':!![],'result':_0x4861fd});}catch(_0x443be8){try{const _0x47f281=(await Promise[_0x4c8612(0x116)]()['then'](()=>__importStar(require(_0x4c8612(0x114)))))[_0x4c8612(0x11a)],_0x3d2329=await _0x47f281[_0x4c8612(0x12b)][_0x4c8612(0x12e)]({'where':{'username':_0x13f0d7[_0x4c8612(0x128)]},'select':{'id':!![]}});_0x3d2329&&await telegramBotService_1['telegramBotService']['sendLoginNotification'](_0x3d2329['id'],{'username':_0x13f0d7[_0x4c8612(0x128)],'ipAddress':_0x1da30b,'userAgent':_0x206b1d,'timestamp':new Date(),'success':![]});}catch(_0x55cfe1){console['error'](_0x4c8612(0x124),_0x55cfe1);}throw _0x443be8;}}catch(_0x5c8038){_0x2d6d86(_0x5c8038);}},this['me']=async(_0x27b7f0,_0x264227,_0x1d7407)=>{const _0x543263=a4_0xea08;try{const _0x23ca5f=_0x27b7f0['user'];_0x264227[_0x543263(0x135)]({'success':!![],'result':{'id':_0x23ca5f?.['id'],'username':_0x23ca5f?.['username'],'role':_0x23ca5f?.[_0x543263(0x13c)]}});}catch(_0x541f42){_0x1d7407(_0x541f42);}},this[_0x26dc9b(0x120)]=async(_0x2a98da,_0x55beec,_0x135ce1)=>{const _0x5b61d6=_0x26dc9b;try{const _0x30fb12=_0x2a98da[_0x5b61d6(0x12c)],_0x5f51bb=_0x2a98da[_0x5b61d6(0x11b)];_0x30fb12&&_0x5f51bb?.[_0x5b61d6(0x13f)]&&tokenBlacklistService_1[_0x5b61d6(0x115)][_0x5b61d6(0x117)](_0x30fb12,_0x5f51bb[_0x5b61d6(0x13f)]),_0x55beec[_0x5b61d6(0x135)]({'success':!![],'message':_0x5b61d6(0x122)});}catch(_0x676135){_0x135ce1(_0x676135);}},this[_0x26dc9b(0x12d)]=async(_0x29fa5c,_0x20b14f,_0xc9896c)=>{const _0x912bc0=_0x26dc9b;try{const _0x3ad6a4=tokenBlacklistService_1[_0x912bc0(0x115)]['getStats']();_0x20b14f[_0x912bc0(0x135)]({'success':!![],'result':_0x3ad6a4});}catch(_0x3200cb){_0xc9896c(_0x3200cb);}},this[_0x26dc9b(0x131)]=async(_0x3f9ab8,_0x245b92,_0x45518b)=>{const _0x4eee83=_0x26dc9b;try{if(!_0x3f9ab8[_0x4eee83(0x11b)]||_0x3f9ab8[_0x4eee83(0x11b)]['role']!==_0x4eee83(0x12b))return _0x245b92[_0x4eee83(0x132)](0x193)[_0x4eee83(0x135)]({'success':![],'message':_0x4eee83(0x127)});const {PrismaClient:_0x30f754}=require('@prisma/client'),_0x4c30f=new _0x30f754(),_0x250048=await _0x4c30f[_0x4eee83(0x12b)][_0x4eee83(0x12e)]({'where':{'id':_0x3f9ab8[_0x4eee83(0x11b)]['id']},'select':{'id':!![],'name':!![],'username':!![],'status':!![]}});if(!_0x250048)return _0x245b92[_0x4eee83(0x132)](0x194)[_0x4eee83(0x135)]({'success':![],'message':_0x4eee83(0x137)});await _0x4c30f[_0x4eee83(0x123)](),_0x245b92[_0x4eee83(0x135)]({'success':!![],'result':{'id':_0x250048['id'],'name':_0x250048['name'],'username':_0x250048[_0x4eee83(0x128)],'status':_0x250048[_0x4eee83(0x132)],'suspended':_0x250048[_0x4eee83(0x132)]===_0x4eee83(0x10b),'active':_0x250048[_0x4eee83(0x132)]===_0x4eee83(0x13e),'canCreatePayments':_0x250048['status']==='ACTIVE'}});}catch(_0x137b69){_0x45518b(_0x137b69);}},this[_0x26dc9b(0x144)]=new authService_1[(_0x26dc9b(0x12a))]();}}function a4_0xea08(_0x52edd2,_0x1058ae){const _0x43e87f=a4_0x43e8();return a4_0xea08=function(_0xea082a,_0x19184b){_0xea082a=_0xea082a-0x10b;let _0x4e7e09=_0x43e87f[_0xea082a];return _0x4e7e09;},a4_0xea08(_0x52edd2,_0x1058ae);}exports['AuthController']=AuthController;function a4_0x43e8(){const _0x53a59b=['User-Agent','default','user','prototype','getOwnPropertyNames','__setModuleDefault','../services/tokenBlacklistService','logout','../services/authService','Logged\x20out\x20successfully','$disconnect','Failed\x20to\x20send\x20failed\x20login\x20notification:','../services/telegramBotService','752wFdPrd','Shop\x20access\x20required','username','login','AuthService','shop','token','getBlacklistStats','findUnique','get','defineProperty','getAccountStatus','status','sendLoginNotification','1506jANNcj','json','__esModule','Shop\x20not\x20found','1511795lihsDV','2633274zbDPiH','519098rnRWUC','__importStar','role','unknown','ACTIVE','exp','remoteAddress','645876PcFXSt','2023lmdCPN','2488fiiAyB','authService','SUSPENDED','196343PEqqae','create','getOwnPropertyDescriptor','configurable','writable','connection','AuthController','body','../config/database','tokenBlacklistService','resolve','blacklistToken','length'];a4_0x43e8=function(){return _0x53a59b;};return a4_0x43e8();}