'use strict';const a4_0x5edddb=a4_0x3760;(function(_0x2d0fd2,_0x519f21){const _0xa609dd=a4_0x3760,_0xe521a5=_0x2d0fd2();while(!![]){try{const _0x414ba2=parseInt(_0xa609dd(0x132))/0x1+-parseInt(_0xa609dd(0x134))/0x2+parseInt(_0xa609dd(0x135))/0x3*(-parseInt(_0xa609dd(0x11a))/0x4)+parseInt(_0xa609dd(0x125))/0x5+-parseInt(_0xa609dd(0x111))/0x6+parseInt(_0xa609dd(0x10f))/0x7*(-parseInt(_0xa609dd(0x11b))/0x8)+parseInt(_0xa609dd(0x107))/0x9*(parseInt(_0xa609dd(0x124))/0xa);if(_0x414ba2===_0x519f21)break;else _0xe521a5['push'](_0xe521a5['shift']());}catch(_0x39c884){_0xe521a5['push'](_0xe521a5['shift']());}}}(a4_0x1a4c,0x36ae9));function a4_0x3760(_0x1cad27,_0x17da97){const _0x1a4ced=a4_0x1a4c();return a4_0x3760=function(_0x376076,_0x4f6b96){_0x376076=_0x376076-0x107;let _0x55a906=_0x1a4ced[_0x376076];return _0x55a906;},a4_0x3760(_0x1cad27,_0x17da97);}var __createBinding=this&&this[a4_0x5edddb(0x109)]||(Object['create']?function(_0x59cf1d,_0x453ff0,_0x57336b,_0x3f5a44){const _0x4c9bb7=a4_0x5edddb;if(_0x3f5a44===undefined)_0x3f5a44=_0x57336b;var _0x54fe11=Object[_0x4c9bb7(0x12d)](_0x453ff0,_0x57336b);(!_0x54fe11||('get'in _0x54fe11?!_0x453ff0['__esModule']:_0x54fe11[_0x4c9bb7(0x117)]||_0x54fe11[_0x4c9bb7(0x10a)]))&&(_0x54fe11={'enumerable':!![],'get':function(){return _0x453ff0[_0x57336b];}}),Object[_0x4c9bb7(0x118)](_0x59cf1d,_0x3f5a44,_0x54fe11);}:function(_0x30d787,_0x555784,_0x2a9ba5,_0x43036c){if(_0x43036c===undefined)_0x43036c=_0x2a9ba5;_0x30d787[_0x43036c]=_0x555784[_0x2a9ba5];}),__setModuleDefault=this&&this[a4_0x5edddb(0x120)]||(Object[a4_0x5edddb(0x11f)]?function(_0x37e81b,_0x48fcf3){Object['defineProperty'](_0x37e81b,'default',{'enumerable':!![],'value':_0x48fcf3});}:function(_0x48e2ea,_0x5886e8){const _0x1bd4ae=a4_0x5edddb;_0x48e2ea[_0x1bd4ae(0x114)]=_0x5886e8;}),__importStar=this&&this['__importStar']||(function(){var _0x5c9ace=function(_0x226a73){const _0x4110f1=a4_0x3760;return _0x5c9ace=Object[_0x4110f1(0x121)]||function(_0x33e29f){const _0x2d5ed1=_0x4110f1;var _0x3921b1=[];for(var _0x976659 in _0x33e29f)if(Object[_0x2d5ed1(0x116)][_0x2d5ed1(0x110)]['call'](_0x33e29f,_0x976659))_0x3921b1[_0x3921b1['length']]=_0x976659;return _0x3921b1;},_0x5c9ace(_0x226a73);};return function(_0x47381e){const _0x497a26=a4_0x3760;if(_0x47381e&&_0x47381e[_0x497a26(0x133)])return _0x47381e;var _0x325428={};if(_0x47381e!=null){for(var _0x3544b0=_0x5c9ace(_0x47381e),_0x49b80b=0x0;_0x49b80b<_0x3544b0['length'];_0x49b80b++)if(_0x3544b0[_0x49b80b]!==_0x497a26(0x114))__createBinding(_0x325428,_0x47381e,_0x3544b0[_0x49b80b]);}return __setModuleDefault(_0x325428,_0x47381e),_0x325428;};}());Object[a4_0x5edddb(0x118)](exports,a4_0x5edddb(0x133),{'value':!![]}),exports[a4_0x5edddb(0x10c)]=void 0x0;const authService_1=require(a4_0x5edddb(0x131)),tokenBlacklistService_1=require('../services/tokenBlacklistService'),telegramBotService_1=require('../services/telegramBotService');class AuthController{constructor(){const _0x474387=a4_0x5edddb;this['login']=async(_0x2eb7fc,_0x2f4054,_0x393750)=>{const _0xa70bc4=a4_0x3760;try{const _0x576c36=_0x2eb7fc[_0xa70bc4(0x112)],_0x5bbc30=_0x2eb7fc['ip']||_0x2eb7fc[_0xa70bc4(0x12c)][_0xa70bc4(0x12f)]||_0xa70bc4(0x11c),_0x3f00c1=_0x2eb7fc[_0xa70bc4(0x12a)](_0xa70bc4(0x128))||_0xa70bc4(0x11c);let _0x20aa96=![],_0x1ad564=null;try{const _0x52a7fc=await this[_0xa70bc4(0x129)][_0xa70bc4(0x115)](_0x576c36);_0x20aa96=!![],_0x52a7fc[_0xa70bc4(0x11e)]==='shop'&&_0x52a7fc[_0xa70bc4(0x12b)]?.['id']&&(_0x1ad564=_0x52a7fc[_0xa70bc4(0x12b)]['id']),_0x1ad564&&await telegramBotService_1['telegramBotService']['sendLoginNotification'](_0x1ad564,{'username':_0x576c36[_0xa70bc4(0x136)],'ipAddress':_0x5bbc30,'userAgent':_0x3f00c1,'timestamp':new Date(),'success':!![]}),_0x2f4054[_0xa70bc4(0x12e)]({'success':!![],'result':_0x52a7fc});}catch(_0x43e0e8){try{const _0x26a50f=(await Promise['resolve']()[_0xa70bc4(0x130)](()=>__importStar(require(_0xa70bc4(0x123)))))[_0xa70bc4(0x114)],_0x557a3f=await _0x26a50f[_0xa70bc4(0x10e)][_0xa70bc4(0x127)]({'where':{'username':_0x576c36[_0xa70bc4(0x136)]},'select':{'id':!![]}});_0x557a3f&&await telegramBotService_1[_0xa70bc4(0x10d)]['sendLoginNotification'](_0x557a3f['id'],{'username':_0x576c36[_0xa70bc4(0x136)],'ipAddress':_0x5bbc30,'userAgent':_0x3f00c1,'timestamp':new Date(),'success':![]});}catch(_0x4dc3ec){console[_0xa70bc4(0x10b)]('Failed\x20to\x20send\x20failed\x20login\x20notification:',_0x4dc3ec);}throw _0x43e0e8;}}catch(_0x517d5f){_0x393750(_0x517d5f);}},this['me']=async(_0x5520c8,_0x5dacda,_0x304e1d)=>{const _0x52454d=a4_0x3760;try{const _0x36d992=_0x5520c8['user'];_0x5dacda['json']({'success':!![],'result':{'id':_0x36d992?.['id'],'username':_0x36d992?.['username'],'role':_0x36d992?.[_0x52454d(0x11e)]}});}catch(_0x3a212d){_0x304e1d(_0x3a212d);}},this['logout']=async(_0x326531,_0x47b704,_0x129364)=>{const _0x1c3a19=a4_0x3760;try{const _0x234bb5=_0x326531[_0x1c3a19(0x119)],_0x30a7c6=_0x326531[_0x1c3a19(0x12b)];_0x234bb5&&_0x30a7c6?.[_0x1c3a19(0x11d)]&&tokenBlacklistService_1['tokenBlacklistService']['blacklistToken'](_0x234bb5,_0x30a7c6['exp']),_0x47b704[_0x1c3a19(0x12e)]({'success':!![],'message':_0x1c3a19(0x113)});}catch(_0xafa192){_0x129364(_0xafa192);}},this[_0x474387(0x108)]=async(_0x422b9e,_0x484947,_0x2c0320)=>{const _0x412937=_0x474387;try{const _0x410abb=tokenBlacklistService_1[_0x412937(0x126)]['getStats']();_0x484947[_0x412937(0x12e)]({'success':!![],'result':_0x410abb});}catch(_0x3d4e99){_0x2c0320(_0x3d4e99);}},this[_0x474387(0x129)]=new authService_1[(_0x474387(0x122))]();}}function a4_0x1a4c(){const _0x522196=['connection','getOwnPropertyDescriptor','json','remoteAddress','then','../services/authService','347965edMSzx','__esModule','674264pIADKJ','19383PhSHUn','username','1370466tcVjhg','getBlacklistStats','__createBinding','configurable','error','AuthController','telegramBotService','shop','7yZQrxD','hasOwnProperty','1252380AKnsPs','body','Logged\x20out\x20successfully','default','login','prototype','writable','defineProperty','token','228ZCgmOu','3111176bgUsoQ','unknown','exp','role','create','__setModuleDefault','getOwnPropertyNames','AuthService','../config/database','70EHpser','565650dQkqWO','tokenBlacklistService','findUnique','User-Agent','authService','get','user'];a4_0x1a4c=function(){return _0x522196;};return a4_0x1a4c();}exports['AuthController']=AuthController;