'use strict';const a4_0x327973=a4_0x2c8c;(function(_0x41e40b,_0x1e21a2){const _0x1aa6f0=a4_0x2c8c,_0x1a2e52=_0x41e40b();while(!![]){try{const _0x50d877=-parseInt(_0x1aa6f0(0xf3))/0x1*(-parseInt(_0x1aa6f0(0xea))/0x2)+parseInt(_0x1aa6f0(0xf7))/0x3+parseInt(_0x1aa6f0(0xf2))/0x4*(parseInt(_0x1aa6f0(0xd1))/0x5)+-parseInt(_0x1aa6f0(0xe1))/0x6*(parseInt(_0x1aa6f0(0xe4))/0x7)+parseInt(_0x1aa6f0(0xef))/0x8+-parseInt(_0x1aa6f0(0xd6))/0x9*(-parseInt(_0x1aa6f0(0xc8))/0xa)+-parseInt(_0x1aa6f0(0xe7))/0xb;if(_0x50d877===_0x1e21a2)break;else _0x1a2e52['push'](_0x1a2e52['shift']());}catch(_0x31d592){_0x1a2e52['push'](_0x1a2e52['shift']());}}}(a4_0x3cb2,0x78acc));function a4_0x3cb2(){const _0x5c5b67=['getOwnPropertyDescriptor','getStats','default','__createBinding','token','exp','../config/database','length','get','6GuGfgp','hasOwnProperty','defineProperty','5540591IuDZxp','call','authService','13848054wsNEXj','__importStar','__setModuleDefault','832hGBlUz','findUnique','role','../services/tokenBlacklistService','AuthController','3771008VKldqM','json','username','116RRmCyK','939XOABhN','Logged\x20out\x20successfully','create','unknown','2145201wEkfye','2010eNDJhk','writable','sendLoginNotification','error','../services/authService','login','User-Agent','user','shop','92985TvdzPO','__esModule','logout','AuthService','remoteAddress','19179JHtOFI','Failed\x20to\x20send\x20failed\x20login\x20notification:'];a4_0x3cb2=function(){return _0x5c5b67;};return a4_0x3cb2();}var __createBinding=this&&this[a4_0x327973(0xdb)]||(Object[a4_0x327973(0xf5)]?function(_0x3be9e9,_0x5f194d,_0x3e515c,_0x3d0738){const _0x324cd4=a4_0x327973;if(_0x3d0738===undefined)_0x3d0738=_0x3e515c;var _0x409e83=Object[_0x324cd4(0xd8)](_0x5f194d,_0x3e515c);(!_0x409e83||(_0x324cd4(0xe0)in _0x409e83?!_0x5f194d[_0x324cd4(0xd2)]:_0x409e83[_0x324cd4(0xc9)]||_0x409e83['configurable']))&&(_0x409e83={'enumerable':!![],'get':function(){return _0x5f194d[_0x3e515c];}}),Object[_0x324cd4(0xe3)](_0x3be9e9,_0x3d0738,_0x409e83);}:function(_0x4acc30,_0xafc338,_0x1e7f8c,_0x3efc01){if(_0x3efc01===undefined)_0x3efc01=_0x1e7f8c;_0x4acc30[_0x3efc01]=_0xafc338[_0x1e7f8c];}),__setModuleDefault=this&&this[a4_0x327973(0xe9)]||(Object['create']?function(_0x44f961,_0xad9c86){const _0x397b64=a4_0x327973;Object[_0x397b64(0xe3)](_0x44f961,'default',{'enumerable':!![],'value':_0xad9c86});}:function(_0x9b6fd2,_0x3148d9){const _0x48183e=a4_0x327973;_0x9b6fd2[_0x48183e(0xda)]=_0x3148d9;}),__importStar=this&&this[a4_0x327973(0xe8)]||(function(){var _0x561bfd=function(_0x4d8427){return _0x561bfd=Object['getOwnPropertyNames']||function(_0x36731a){const _0xc1c1e1=a4_0x2c8c;var _0x278f82=[];for(var _0x183098 in _0x36731a)if(Object['prototype'][_0xc1c1e1(0xe2)][_0xc1c1e1(0xe5)](_0x36731a,_0x183098))_0x278f82[_0x278f82[_0xc1c1e1(0xdf)]]=_0x183098;return _0x278f82;},_0x561bfd(_0x4d8427);};return function(_0x85df9e){const _0x40386b=a4_0x2c8c;if(_0x85df9e&&_0x85df9e[_0x40386b(0xd2)])return _0x85df9e;var _0x2c42a9={};if(_0x85df9e!=null){for(var _0x32904e=_0x561bfd(_0x85df9e),_0x14dbb1=0x0;_0x14dbb1<_0x32904e[_0x40386b(0xdf)];_0x14dbb1++)if(_0x32904e[_0x14dbb1]!=='default')__createBinding(_0x2c42a9,_0x85df9e,_0x32904e[_0x14dbb1]);}return __setModuleDefault(_0x2c42a9,_0x85df9e),_0x2c42a9;};}());function a4_0x2c8c(_0x3ca0f0,_0x2215ec){const _0x3cb2f8=a4_0x3cb2();return a4_0x2c8c=function(_0x2c8cdf,_0x34298e){_0x2c8cdf=_0x2c8cdf-0xc8;let _0x3be28a=_0x3cb2f8[_0x2c8cdf];return _0x3be28a;},a4_0x2c8c(_0x3ca0f0,_0x2215ec);}Object[a4_0x327973(0xe3)](exports,a4_0x327973(0xd2),{'value':!![]}),exports[a4_0x327973(0xee)]=void 0x0;const authService_1=require(a4_0x327973(0xcc)),tokenBlacklistService_1=require(a4_0x327973(0xed)),telegramBotService_1=require('../services/telegramBotService');class AuthController{constructor(){const _0x587670=a4_0x327973;this[_0x587670(0xcd)]=async(_0x4645b6,_0xc76f33,_0x3e3a1d)=>{const _0x480d1f=_0x587670;try{const _0x156513=_0x4645b6['body'],_0x26390d=_0x4645b6['ip']||_0x4645b6['connection'][_0x480d1f(0xd5)]||_0x480d1f(0xf6),_0x285625=_0x4645b6[_0x480d1f(0xe0)](_0x480d1f(0xce))||_0x480d1f(0xf6);let _0x4c7714=![],_0x5ec322=null;try{const _0x2fd1f9=await this[_0x480d1f(0xe6)][_0x480d1f(0xcd)](_0x156513);_0x4c7714=!![],_0x2fd1f9[_0x480d1f(0xec)]===_0x480d1f(0xd0)&&_0x2fd1f9[_0x480d1f(0xcf)]?.['id']&&(_0x5ec322=_0x2fd1f9['user']['id']),_0x5ec322&&await telegramBotService_1['telegramBotService']['sendLoginNotification'](_0x5ec322,{'username':_0x156513[_0x480d1f(0xf1)],'ipAddress':_0x26390d,'userAgent':_0x285625,'timestamp':new Date(),'success':!![]}),_0xc76f33[_0x480d1f(0xf0)]({'success':!![],'result':_0x2fd1f9});}catch(_0x3e1a5f){try{const _0x1abcd0=(await Promise['resolve']()['then'](()=>__importStar(require(_0x480d1f(0xde)))))[_0x480d1f(0xda)],_0x5fecec=await _0x1abcd0[_0x480d1f(0xd0)][_0x480d1f(0xeb)]({'where':{'username':_0x156513[_0x480d1f(0xf1)]},'select':{'id':!![]}});_0x5fecec&&await telegramBotService_1['telegramBotService'][_0x480d1f(0xca)](_0x5fecec['id'],{'username':_0x156513['username'],'ipAddress':_0x26390d,'userAgent':_0x285625,'timestamp':new Date(),'success':![]});}catch(_0xaefb){console[_0x480d1f(0xcb)](_0x480d1f(0xd7),_0xaefb);}throw _0x3e1a5f;}}catch(_0x8643fb){_0x3e3a1d(_0x8643fb);}},this['me']=async(_0x24d498,_0x197414,_0xe0cce1)=>{const _0x51d7a0=_0x587670;try{const _0x1aace9=_0x24d498[_0x51d7a0(0xcf)];_0x197414[_0x51d7a0(0xf0)]({'success':!![],'result':{'id':_0x1aace9?.['id'],'username':_0x1aace9?.['username'],'role':_0x1aace9?.[_0x51d7a0(0xec)]}});}catch(_0x26e1e7){_0xe0cce1(_0x26e1e7);}},this[_0x587670(0xd3)]=async(_0x5b8784,_0x12528b,_0xf34ea8)=>{const _0x29b942=_0x587670;try{const _0x208091=_0x5b8784[_0x29b942(0xdc)],_0x56b3e3=_0x5b8784[_0x29b942(0xcf)];_0x208091&&_0x56b3e3?.[_0x29b942(0xdd)]&&tokenBlacklistService_1['tokenBlacklistService']['blacklistToken'](_0x208091,_0x56b3e3[_0x29b942(0xdd)]),_0x12528b[_0x29b942(0xf0)]({'success':!![],'message':_0x29b942(0xf4)});}catch(_0x269b98){_0xf34ea8(_0x269b98);}},this['getBlacklistStats']=async(_0x225c7a,_0x1b2bce,_0x2083ae)=>{const _0x56e0b7=_0x587670;try{const _0x282b3f=tokenBlacklistService_1['tokenBlacklistService'][_0x56e0b7(0xd9)]();_0x1b2bce[_0x56e0b7(0xf0)]({'success':!![],'result':_0x282b3f});}catch(_0x30d446){_0x2083ae(_0x30d446);}},this[_0x587670(0xe6)]=new authService_1[(_0x587670(0xd4))]();}}exports[a4_0x327973(0xee)]=AuthController;