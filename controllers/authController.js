'use strict';const a4_0x1d6324=a4_0xe1df;(function(_0x1a33f6,_0x8c2fe3){const _0x3a9dd7=a4_0xe1df,_0x484aef=_0x1a33f6();while(!![]){try{const _0x4f0edc=parseInt(_0x3a9dd7(0x9e))/0x1+parseInt(_0x3a9dd7(0x8c))/0x2*(-parseInt(_0x3a9dd7(0x9a))/0x3)+parseInt(_0x3a9dd7(0x96))/0x4*(-parseInt(_0x3a9dd7(0xaf))/0x5)+-parseInt(_0x3a9dd7(0xbf))/0x6+parseInt(_0x3a9dd7(0x9f))/0x7*(parseInt(_0x3a9dd7(0x91))/0x8)+-parseInt(_0x3a9dd7(0xa2))/0x9*(parseInt(_0x3a9dd7(0xbc))/0xa)+parseInt(_0x3a9dd7(0xbd))/0xb;if(_0x4f0edc===_0x8c2fe3)break;else _0x484aef['push'](_0x484aef['shift']());}catch(_0x8991a1){_0x484aef['push'](_0x484aef['shift']());}}}(a4_0x7c29,0x3ebb7));function a4_0xe1df(_0x22b5f5,_0x53d52b){const _0x7c29bd=a4_0x7c29();return a4_0xe1df=function(_0xe1df95,_0x270b11){_0xe1df95=_0xe1df95-0x8c;let _0x5c2a57=_0x7c29bd[_0xe1df95];return _0x5c2a57;},a4_0xe1df(_0x22b5f5,_0x53d52b);}var __createBinding=this&&this[a4_0x1d6324(0xa5)]||(Object['create']?function(_0x36ce94,_0x346a05,_0x1f8d02,_0x5c9142){const _0x40fcab=a4_0x1d6324;if(_0x5c9142===undefined)_0x5c9142=_0x1f8d02;var _0xfe3068=Object[_0x40fcab(0xa4)](_0x346a05,_0x1f8d02);(!_0xfe3068||(_0x40fcab(0xb5)in _0xfe3068?!_0x346a05['__esModule']:_0xfe3068['writable']||_0xfe3068['configurable']))&&(_0xfe3068={'enumerable':!![],'get':function(){return _0x346a05[_0x1f8d02];}}),Object[_0x40fcab(0x8e)](_0x36ce94,_0x5c9142,_0xfe3068);}:function(_0x4a0dd4,_0xc69a42,_0x13f121,_0x56dfa5){if(_0x56dfa5===undefined)_0x56dfa5=_0x13f121;_0x4a0dd4[_0x56dfa5]=_0xc69a42[_0x13f121];}),__setModuleDefault=this&&this[a4_0x1d6324(0xa9)]||(Object[a4_0x1d6324(0xa7)]?function(_0x432f2e,_0x3cbe48){const _0x39a1a4=a4_0x1d6324;Object['defineProperty'](_0x432f2e,_0x39a1a4(0xa6),{'enumerable':!![],'value':_0x3cbe48});}:function(_0x48e1d6,_0x2e0a51){const _0x291b11=a4_0x1d6324;_0x48e1d6[_0x291b11(0xa6)]=_0x2e0a51;}),__importStar=this&&this[a4_0x1d6324(0xa3)]||(function(){var _0x230ca6=function(_0x33ecd4){const _0x5a26a1=a4_0xe1df;return _0x230ca6=Object[_0x5a26a1(0xa1)]||function(_0x14b80c){const _0x28299d=_0x5a26a1;var _0x205e2e=[];for(var _0x128d05 in _0x14b80c)if(Object[_0x28299d(0xb3)][_0x28299d(0x94)][_0x28299d(0xac)](_0x14b80c,_0x128d05))_0x205e2e[_0x205e2e['length']]=_0x128d05;return _0x205e2e;},_0x230ca6(_0x33ecd4);};return function(_0x21a634){const _0x13323a=a4_0xe1df;if(_0x21a634&&_0x21a634['__esModule'])return _0x21a634;var _0xe4f356={};if(_0x21a634!=null){for(var _0x21279a=_0x230ca6(_0x21a634),_0x1370fb=0x0;_0x1370fb<_0x21279a[_0x13323a(0xb2)];_0x1370fb++)if(_0x21279a[_0x1370fb]!==_0x13323a(0xa6))__createBinding(_0xe4f356,_0x21a634,_0x21279a[_0x1370fb]);}return __setModuleDefault(_0xe4f356,_0x21a634),_0xe4f356;};}());Object[a4_0x1d6324(0x8e)](exports,a4_0x1d6324(0x99),{'value':!![]}),exports[a4_0x1d6324(0x92)]=void 0x0;const authService_1=require(a4_0x1d6324(0x93)),tokenBlacklistService_1=require(a4_0x1d6324(0xb9)),telegramBotService_1=require('../services/telegramBotService');function a4_0x7c29(){const _0x31b7f8=['defineProperty','User-Agent','telegramBotService','328dXFjJJ','AuthController','../services/authService','hasOwnProperty','shop','12ypiMlW','blacklistToken','AuthService','__esModule','9201qbVPrM','exp','role','user','424293asAgAN','72499hHhhWt','getBlacklistStats','getOwnPropertyNames','954fhgwBN','__importStar','getOwnPropertyDescriptor','__createBinding','default','create','token','__setModuleDefault','../config/database','resolve','call','getStats','json','669385nRZdLT','findUnique','sendLoginNotification','length','prototype','body','get','username','remoteAddress','error','../services/tokenBlacklistService','authService','logout','10010KJVcur','1663541cYAEfr','connection','1357632qjWgoZ','6kMWhsZ','unknown'];a4_0x7c29=function(){return _0x31b7f8;};return a4_0x7c29();}class AuthController{constructor(){const _0x51bceb=a4_0x1d6324;this['login']=async(_0x55cb02,_0x1e7258,_0x21d9a7)=>{const _0xb0d0dd=a4_0xe1df;try{const _0x570f71=_0x55cb02[_0xb0d0dd(0xb4)],_0x53a98c=_0x55cb02['ip']||_0x55cb02[_0xb0d0dd(0xbe)][_0xb0d0dd(0xb7)]||_0xb0d0dd(0x8d),_0x1b7172=_0x55cb02['get'](_0xb0d0dd(0x8f))||_0xb0d0dd(0x8d);let _0x42541c=![],_0x4f3a98=null;try{const _0x1b5fce=await this[_0xb0d0dd(0xba)]['login'](_0x570f71);_0x42541c=!![],_0x1b5fce[_0xb0d0dd(0x9c)]===_0xb0d0dd(0x95)&&_0x1b5fce[_0xb0d0dd(0x9d)]?.['id']&&(_0x4f3a98=_0x1b5fce[_0xb0d0dd(0x9d)]['id']),_0x4f3a98&&await telegramBotService_1[_0xb0d0dd(0x90)][_0xb0d0dd(0xb1)](_0x4f3a98,{'username':_0x570f71[_0xb0d0dd(0xb6)],'ipAddress':_0x53a98c,'userAgent':_0x1b7172,'timestamp':new Date(),'success':!![]}),_0x1e7258[_0xb0d0dd(0xae)]({'success':!![],'result':_0x1b5fce});}catch(_0x428769){try{const _0x194f00=(await Promise[_0xb0d0dd(0xab)]()['then'](()=>__importStar(require(_0xb0d0dd(0xaa)))))['default'],_0x5d916e=await _0x194f00[_0xb0d0dd(0x95)][_0xb0d0dd(0xb0)]({'where':{'username':_0x570f71['username']},'select':{'id':!![]}});_0x5d916e&&await telegramBotService_1[_0xb0d0dd(0x90)][_0xb0d0dd(0xb1)](_0x5d916e['id'],{'username':_0x570f71[_0xb0d0dd(0xb6)],'ipAddress':_0x53a98c,'userAgent':_0x1b7172,'timestamp':new Date(),'success':![]});}catch(_0x335165){console[_0xb0d0dd(0xb8)]('Failed\x20to\x20send\x20failed\x20login\x20notification:',_0x335165);}throw _0x428769;}}catch(_0x40d7b0){_0x21d9a7(_0x40d7b0);}},this['me']=async(_0x509fa1,_0x5bef8e,_0x37cf1d)=>{const _0x4fedf0=a4_0xe1df;try{const _0x5505b5=_0x509fa1[_0x4fedf0(0x9d)];_0x5bef8e[_0x4fedf0(0xae)]({'success':!![],'result':{'id':_0x5505b5?.['id'],'username':_0x5505b5?.[_0x4fedf0(0xb6)],'role':_0x5505b5?.['role']}});}catch(_0x16f8fe){_0x37cf1d(_0x16f8fe);}},this[_0x51bceb(0xbb)]=async(_0x2d8f68,_0x150a30,_0x2623a4)=>{const _0x3abd05=_0x51bceb;try{const _0x4e9503=_0x2d8f68[_0x3abd05(0xa8)],_0x200587=_0x2d8f68[_0x3abd05(0x9d)];_0x4e9503&&_0x200587?.['exp']&&tokenBlacklistService_1['tokenBlacklistService'][_0x3abd05(0x97)](_0x4e9503,_0x200587[_0x3abd05(0x9b)]),_0x150a30[_0x3abd05(0xae)]({'success':!![],'message':'Logged\x20out\x20successfully'});}catch(_0x228162){_0x2623a4(_0x228162);}},this[_0x51bceb(0xa0)]=async(_0x409a5a,_0x23d8e9,_0x512b5a)=>{const _0x30fc8e=_0x51bceb;try{const _0x49458e=tokenBlacklistService_1['tokenBlacklistService'][_0x30fc8e(0xad)]();_0x23d8e9[_0x30fc8e(0xae)]({'success':!![],'result':_0x49458e});}catch(_0x541450){_0x512b5a(_0x541450);}},this['authService']=new authService_1[(_0x51bceb(0x98))]();}}exports[a4_0x1d6324(0x92)]=AuthController;