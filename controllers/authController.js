'use strict';const a4_0x2b3752=a4_0x8f0f;(function(_0x5307cc,_0x1f2394){const _0x31eefc=a4_0x8f0f,_0x363240=_0x5307cc();while(!![]){try{const _0x51fb46=-parseInt(_0x31eefc(0xbc))/0x1*(-parseInt(_0x31eefc(0xce))/0x2)+-parseInt(_0x31eefc(0xca))/0x3*(-parseInt(_0x31eefc(0xd4))/0x4)+-parseInt(_0x31eefc(0xdb))/0x5+parseInt(_0x31eefc(0xb1))/0x6*(-parseInt(_0x31eefc(0xcd))/0x7)+parseInt(_0x31eefc(0xd0))/0x8*(parseInt(_0x31eefc(0xb5))/0x9)+parseInt(_0x31eefc(0xae))/0xa*(-parseInt(_0x31eefc(0xc4))/0xb)+parseInt(_0x31eefc(0xc0))/0xc;if(_0x51fb46===_0x1f2394)break;else _0x363240['push'](_0x363240['shift']());}catch(_0x89e54b){_0x363240['push'](_0x363240['shift']());}}}(a4_0xdebd,0xac7d9));function a4_0xdebd(){const _0x23ae3a=['hasOwnProperty','configurable','json','authService','logout','shop','200IzQdTI','token','../services/telegramBotService','93540eaPKCc','Failed\x20to\x20send\x20failed\x20login\x20notification:','telegramBotService','ipAddress','333GeFhWX','unknown','length','__createBinding','username','userAgent','remoteAddress','21qDAGVq','AuthService','defineProperty','default','2645208VQPfMz','exp','create','resolve','471317nZLypR','Logged\x20out\x20successfully','error','body','getOwnPropertyNames','../services/authService','3LIuUbX','AuthController','__esModule','161wMbQBu','120068fFPpEO','role','109672jxkngz','prototype','writable','login','2593456boTriZ','__setModuleDefault','call','getBlacklistStats','sendLoginNotification','tokenBlacklistService','user','3573570pqztbc','getStats','get'];a4_0xdebd=function(){return _0x23ae3a;};return a4_0xdebd();}var __createBinding=this&&this[a4_0x2b3752(0xb8)]||(Object[a4_0x2b3752(0xc2)]?function(_0x43a150,_0x2812b7,_0x590780,_0x346aed){const _0x4fe278=a4_0x2b3752;if(_0x346aed===undefined)_0x346aed=_0x590780;var _0xdd16c9=Object['getOwnPropertyDescriptor'](_0x2812b7,_0x590780);(!_0xdd16c9||(_0x4fe278(0xdd)in _0xdd16c9?!_0x2812b7[_0x4fe278(0xcc)]:_0xdd16c9[_0x4fe278(0xd2)]||_0xdd16c9[_0x4fe278(0xdf)]))&&(_0xdd16c9={'enumerable':!![],'get':function(){return _0x2812b7[_0x590780];}}),Object['defineProperty'](_0x43a150,_0x346aed,_0xdd16c9);}:function(_0xc33067,_0x19a57d,_0x31e780,_0x572d06){if(_0x572d06===undefined)_0x572d06=_0x31e780;_0xc33067[_0x572d06]=_0x19a57d[_0x31e780];}),__setModuleDefault=this&&this[a4_0x2b3752(0xd5)]||(Object[a4_0x2b3752(0xc2)]?function(_0x3f5d1b,_0xfb42c8){const _0x212343=a4_0x2b3752;Object[_0x212343(0xbe)](_0x3f5d1b,'default',{'enumerable':!![],'value':_0xfb42c8});}:function(_0x1b13c7,_0x233860){const _0x5e2b00=a4_0x2b3752;_0x1b13c7[_0x5e2b00(0xbf)]=_0x233860;}),__importStar=this&&this['__importStar']||(function(){var _0x9d1221=function(_0x3699b7){const _0x41edc5=a4_0x8f0f;return _0x9d1221=Object[_0x41edc5(0xc8)]||function(_0x50f84a){const _0x279f47=_0x41edc5;var _0x4e1947=[];for(var _0x42e78c in _0x50f84a)if(Object[_0x279f47(0xd1)][_0x279f47(0xde)][_0x279f47(0xd6)](_0x50f84a,_0x42e78c))_0x4e1947[_0x4e1947[_0x279f47(0xb7)]]=_0x42e78c;return _0x4e1947;},_0x9d1221(_0x3699b7);};return function(_0x297bd2){const _0x24cddf=a4_0x8f0f;if(_0x297bd2&&_0x297bd2[_0x24cddf(0xcc)])return _0x297bd2;var _0x1c3773={};if(_0x297bd2!=null){for(var _0x34fd3e=_0x9d1221(_0x297bd2),_0x104789=0x0;_0x104789<_0x34fd3e[_0x24cddf(0xb7)];_0x104789++)if(_0x34fd3e[_0x104789]!=='default')__createBinding(_0x1c3773,_0x297bd2,_0x34fd3e[_0x104789]);}return __setModuleDefault(_0x1c3773,_0x297bd2),_0x1c3773;};}());Object[a4_0x2b3752(0xbe)](exports,a4_0x2b3752(0xcc),{'value':!![]}),exports[a4_0x2b3752(0xcb)]=void 0x0;const authService_1=require(a4_0x2b3752(0xc9)),tokenBlacklistService_1=require('../services/tokenBlacklistService'),telegramBotService_1=require(a4_0x2b3752(0xb0));class AuthController{constructor(){const _0x1f9fbe=a4_0x2b3752;this['login']=async(_0x2cea45,_0x29c5f2,_0x4b03f9)=>{const _0x2a7a2f=a4_0x8f0f;try{const _0x47d1d2=_0x2cea45[_0x2a7a2f(0xc7)],_0x84d444=_0x47d1d2[_0x2a7a2f(0xb4)]||_0x2cea45['ip']||_0x2cea45['connection'][_0x2a7a2f(0xbb)]||'unknown',_0x3cf6d4=_0x47d1d2[_0x2a7a2f(0xba)]||_0x2cea45[_0x2a7a2f(0xdd)]('User-Agent')||_0x2a7a2f(0xb6),_0x14295c=_0x47d1d2['geo'];let _0x482de6=![],_0x42d73b=null;try{const _0x344428=await this[_0x2a7a2f(0xe1)][_0x2a7a2f(0xd3)](_0x47d1d2);_0x482de6=!![],_0x344428[_0x2a7a2f(0xcf)]==='shop'&&_0x344428[_0x2a7a2f(0xda)]?.['id']&&(_0x42d73b=_0x344428['user']['id']),_0x42d73b&&await telegramBotService_1['telegramBotService'][_0x2a7a2f(0xd8)](_0x42d73b,{'username':_0x47d1d2['username'],'ipAddress':_0x84d444,'userAgent':_0x3cf6d4,'geo':_0x14295c,'timestamp':new Date(),'success':!![]}),_0x29c5f2['json']({'success':!![],'result':_0x344428});}catch(_0x2b4f75){try{const _0x2a9ac1=(await Promise[_0x2a7a2f(0xc3)]()['then'](()=>__importStar(require('../config/database'))))['default'],_0x3b0fbb=await _0x2a9ac1[_0x2a7a2f(0xad)]['findUnique']({'where':{'username':_0x47d1d2[_0x2a7a2f(0xb9)]},'select':{'id':!![]}});_0x3b0fbb&&await telegramBotService_1[_0x2a7a2f(0xb3)][_0x2a7a2f(0xd8)](_0x3b0fbb['id'],{'username':_0x47d1d2[_0x2a7a2f(0xb9)],'ipAddress':_0x84d444,'userAgent':_0x3cf6d4,'geo':_0x14295c,'timestamp':new Date(),'success':![]});}catch(_0x3c7f59){console[_0x2a7a2f(0xc6)](_0x2a7a2f(0xb2),_0x3c7f59);}throw _0x2b4f75;}}catch(_0x1aa67b){_0x4b03f9(_0x1aa67b);}},this['me']=async(_0x4a0652,_0x58e35e,_0xe750c5)=>{const _0x3e867b=a4_0x8f0f;try{const _0x4ecf61=_0x4a0652[_0x3e867b(0xda)];_0x58e35e[_0x3e867b(0xe0)]({'success':!![],'result':{'id':_0x4ecf61?.['id'],'username':_0x4ecf61?.[_0x3e867b(0xb9)],'role':_0x4ecf61?.['role']}});}catch(_0x23cd8c){_0xe750c5(_0x23cd8c);}},this[_0x1f9fbe(0xac)]=async(_0x3995da,_0x499668,_0x1dd927)=>{const _0x417004=_0x1f9fbe;try{const _0x439461=_0x3995da[_0x417004(0xaf)],_0x1badb2=_0x3995da[_0x417004(0xda)];_0x439461&&_0x1badb2?.[_0x417004(0xc1)]&&tokenBlacklistService_1[_0x417004(0xd9)]['blacklistToken'](_0x439461,_0x1badb2['exp']),_0x499668[_0x417004(0xe0)]({'success':!![],'message':_0x417004(0xc5)});}catch(_0x270405){_0x1dd927(_0x270405);}},this[_0x1f9fbe(0xd7)]=async(_0x3959d4,_0x421c76,_0x45908c)=>{const _0x5542e2=_0x1f9fbe;try{const _0x2d078f=tokenBlacklistService_1[_0x5542e2(0xd9)][_0x5542e2(0xdc)]();_0x421c76[_0x5542e2(0xe0)]({'success':!![],'result':_0x2d078f});}catch(_0x5b5a86){_0x45908c(_0x5b5a86);}},this['authService']=new authService_1[(_0x1f9fbe(0xbd))]();}}function a4_0x8f0f(_0x39cb6c,_0x540f6b){const _0xdebd3e=a4_0xdebd();return a4_0x8f0f=function(_0x8f0fe0,_0x36d94c){_0x8f0fe0=_0x8f0fe0-0xac;let _0x533f4f=_0xdebd3e[_0x8f0fe0];return _0x533f4f;},a4_0x8f0f(_0x39cb6c,_0x540f6b);}exports['AuthController']=AuthController;