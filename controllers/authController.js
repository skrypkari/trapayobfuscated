'use strict';const a4_0x34be30=a4_0xfbbf;(function(_0x382c31,_0x3d08ae){const _0x27ead7=a4_0xfbbf,_0x2c0ee0=_0x382c31();while(!![]){try{const _0x492f7b=-parseInt(_0x27ead7(0x97))/0x1*(parseInt(_0x27ead7(0xac))/0x2)+-parseInt(_0x27ead7(0x96))/0x3+parseInt(_0x27ead7(0x9a))/0x4+parseInt(_0x27ead7(0xb1))/0x5+-parseInt(_0x27ead7(0x94))/0x6+-parseInt(_0x27ead7(0x88))/0x7+parseInt(_0x27ead7(0x9d))/0x8*(parseInt(_0x27ead7(0xa3))/0x9);if(_0x492f7b===_0x3d08ae)break;else _0x2c0ee0['push'](_0x2c0ee0['shift']());}catch(_0x1862d3){_0x2c0ee0['push'](_0x2c0ee0['shift']());}}}(a4_0x2aa9,0x7a62e));function a4_0xfbbf(_0x10d3f2,_0x32ae75){_0x10d3f2=_0x10d3f2-0x88;const _0x2aa9db=a4_0x2aa9();let _0xfbbf45=_0x2aa9db[_0x10d3f2];return _0xfbbf45;}var __createBinding=this&&this['__createBinding']||(Object[a4_0x34be30(0xa1)]?function(_0x124cb1,_0x27f895,_0x1e6552,_0x4449bb){const _0x1693dd=a4_0x34be30;if(_0x4449bb===undefined)_0x4449bb=_0x1e6552;var _0x209874=Object[_0x1693dd(0x89)](_0x27f895,_0x1e6552);(!_0x209874||(_0x1693dd(0x9e)in _0x209874?!_0x27f895[_0x1693dd(0xb3)]:_0x209874[_0x1693dd(0xa6)]||_0x209874['configurable']))&&(_0x209874={'enumerable':!![],'get':function(){return _0x27f895[_0x1e6552];}}),Object[_0x1693dd(0xa8)](_0x124cb1,_0x4449bb,_0x209874);}:function(_0x2cb47b,_0x2254d2,_0x4d7dd1,_0x502284){if(_0x502284===undefined)_0x502284=_0x4d7dd1;_0x2cb47b[_0x502284]=_0x2254d2[_0x4d7dd1];}),__setModuleDefault=this&&this[a4_0x34be30(0xae)]||(Object['create']?function(_0x4e3e8e,_0x2145c2){const _0x2b0fe6=a4_0x34be30;Object[_0x2b0fe6(0xa8)](_0x4e3e8e,_0x2b0fe6(0xb7),{'enumerable':!![],'value':_0x2145c2});}:function(_0x394426,_0x14fe71){const _0x247a4b=a4_0x34be30;_0x394426[_0x247a4b(0xb7)]=_0x14fe71;}),__importStar=this&&this['__importStar']||(function(){var _0x4031df=function(_0x119af0){const _0x4169dd=a4_0xfbbf;return _0x4031df=Object[_0x4169dd(0x92)]||function(_0x175ac1){var _0x2ff416=[];for(var _0x27e22c in _0x175ac1)if(Object['prototype']['hasOwnProperty']['call'](_0x175ac1,_0x27e22c))_0x2ff416[_0x2ff416['length']]=_0x27e22c;return _0x2ff416;},_0x4031df(_0x119af0);};return function(_0x406b5e){const _0x486af6=a4_0xfbbf;if(_0x406b5e&&_0x406b5e[_0x486af6(0xb3)])return _0x406b5e;var _0x45ac4c={};if(_0x406b5e!=null){for(var _0x70a512=_0x4031df(_0x406b5e),_0x1bb076=0x0;_0x1bb076<_0x70a512['length'];_0x1bb076++)if(_0x70a512[_0x1bb076]!=='default')__createBinding(_0x45ac4c,_0x406b5e,_0x70a512[_0x1bb076]);}return __setModuleDefault(_0x45ac4c,_0x406b5e),_0x45ac4c;};}());Object['defineProperty'](exports,a4_0x34be30(0xb3),{'value':!![]}),exports[a4_0x34be30(0xa7)]=void 0x0;function a4_0x2aa9(){const _0x3ed4f1=['AuthController','defineProperty','findUnique','AuthService','unknown','10QbXgpU','shop','__setModuleDefault','../services/tokenBlacklistService','getBlacklistStats','4314625ZzjIgz','authService','__esModule','telegramBotService','../services/authService','User-Agent','default','5635315EWLrqF','getOwnPropertyDescriptor','token','tokenBlacklistService','body','username','then','exp','sendLoginNotification','remoteAddress','getOwnPropertyNames','Failed\x20to\x20send\x20failed\x20login\x20notification:','598488UdVMXX','geo','455853rRAwPX','139394wAlyWO','getStats','connection','3072204owmOMt','userAgent','../config/database','312016icpEQg','get','json','resolve','create','../services/telegramBotService','144hxXyWG','user','ipAddress','writable'];a4_0x2aa9=function(){return _0x3ed4f1;};return a4_0x2aa9();}const authService_1=require(a4_0x34be30(0xb5)),tokenBlacklistService_1=require(a4_0x34be30(0xaf)),telegramBotService_1=require(a4_0x34be30(0xa2));class AuthController{constructor(){const _0x313eea=a4_0x34be30;this['login']=async(_0x4e834f,_0x237c22,_0x3c461a)=>{const _0x36492a=a4_0xfbbf;try{const _0x184bc6=_0x4e834f[_0x36492a(0x8c)],_0x2c6e25=_0x184bc6[_0x36492a(0xa5)]||_0x4e834f['ip']||_0x4e834f[_0x36492a(0x99)][_0x36492a(0x91)]||'unknown',_0x151a71=_0x184bc6[_0x36492a(0x9b)]||_0x4e834f[_0x36492a(0x9e)](_0x36492a(0xb6))||_0x36492a(0xab),_0x1186b7=_0x184bc6[_0x36492a(0x95)];let _0x16baa3=![],_0x2ce58e=null;try{const _0x5d9404=await this[_0x36492a(0xb2)]['login'](_0x184bc6);_0x16baa3=!![],_0x5d9404['role']==='shop'&&_0x5d9404[_0x36492a(0xa4)]?.['id']&&(_0x2ce58e=_0x5d9404[_0x36492a(0xa4)]['id']),_0x2ce58e&&await telegramBotService_1['telegramBotService'][_0x36492a(0x90)](_0x2ce58e,{'username':_0x184bc6[_0x36492a(0x8d)],'ipAddress':_0x2c6e25,'userAgent':_0x151a71,'geo':_0x1186b7,'timestamp':new Date(),'success':!![]}),_0x237c22[_0x36492a(0x9f)]({'success':!![],'result':_0x5d9404});}catch(_0x19d914){try{const _0x5a4042=(await Promise[_0x36492a(0xa0)]()[_0x36492a(0x8e)](()=>__importStar(require(_0x36492a(0x9c)))))[_0x36492a(0xb7)],_0x300c6f=await _0x5a4042[_0x36492a(0xad)][_0x36492a(0xa9)]({'where':{'username':_0x184bc6[_0x36492a(0x8d)]},'select':{'id':!![]}});_0x300c6f&&await telegramBotService_1[_0x36492a(0xb4)][_0x36492a(0x90)](_0x300c6f['id'],{'username':_0x184bc6['username'],'ipAddress':_0x2c6e25,'userAgent':_0x151a71,'geo':_0x1186b7,'timestamp':new Date(),'success':![]});}catch(_0x41fcb0){console['error'](_0x36492a(0x93),_0x41fcb0);}throw _0x19d914;}}catch(_0x3ffd39){_0x3c461a(_0x3ffd39);}},this['me']=async(_0x42a643,_0x5d574d,_0x2c1547)=>{const _0x3fc766=a4_0xfbbf;try{const _0x2bfa35=_0x42a643[_0x3fc766(0xa4)];_0x5d574d['json']({'success':!![],'result':{'id':_0x2bfa35?.['id'],'username':_0x2bfa35?.[_0x3fc766(0x8d)],'role':_0x2bfa35?.['role']}});}catch(_0x365fb9){_0x2c1547(_0x365fb9);}},this['logout']=async(_0x5d8a85,_0xd0834b,_0x36376c)=>{const _0x5c789a=a4_0xfbbf;try{const _0x50d948=_0x5d8a85[_0x5c789a(0x8a)],_0x4237c1=_0x5d8a85[_0x5c789a(0xa4)];_0x50d948&&_0x4237c1?.[_0x5c789a(0x8f)]&&tokenBlacklistService_1[_0x5c789a(0x8b)]['blacklistToken'](_0x50d948,_0x4237c1['exp']),_0xd0834b[_0x5c789a(0x9f)]({'success':!![],'message':'Logged\x20out\x20successfully'});}catch(_0x308abd){_0x36376c(_0x308abd);}},this[_0x313eea(0xb0)]=async(_0x2c5f6e,_0x530ca4,_0x125685)=>{const _0x20ecfb=_0x313eea;try{const _0x2da0f3=tokenBlacklistService_1[_0x20ecfb(0x8b)][_0x20ecfb(0x98)]();_0x530ca4[_0x20ecfb(0x9f)]({'success':!![],'result':_0x2da0f3});}catch(_0x54a4d8){_0x125685(_0x54a4d8);}},this[_0x313eea(0xb2)]=new authService_1[(_0x313eea(0xaa))]();}}exports[a4_0x34be30(0xa7)]=AuthController;