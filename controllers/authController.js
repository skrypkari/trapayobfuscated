'use strict';const a4_0x5a757c=a4_0x3ded;function a4_0x1b2d(){const _0x5b51c1=['default','unknown','user','shop','__setModuleDefault','30DsPsRX','User-Agent','token','blacklistToken','username','../services/authService','create','4662236rTeKPw','tokenBlacklistService','Logged\x20out\x20successfully','authService','2973837fCbkCL','get','hasOwnProperty','length','exp','call','json','Failed\x20to\x20send\x20failed\x20login\x20notification:','80IwGlzW','error','connection','AuthController','getOwnPropertyNames','body','login','resolve','__esModule','defineProperty','sendLoginNotification','logout','findUnique','role','180620ddfXdh','8608328CqROkz','telegramBotService','2694771mJuNkD','1078810nELChl','getStats','4419828CGXbEj','2MKLmbm','../config/database','getOwnPropertyDescriptor'];a4_0x1b2d=function(){return _0x5b51c1;};return a4_0x1b2d();}(function(_0xc505a1,_0x10d97e){const _0x3e3546=a4_0x3ded,_0x5698d9=_0xc505a1();while(!![]){try{const _0x4920fb=-parseInt(_0x3e3546(0x15a))/0x1+-parseInt(_0x3e3546(0x161))/0x2*(parseInt(_0x3e3546(0x174))/0x3)+-parseInt(_0x3e3546(0x170))/0x4+-parseInt(_0x3e3546(0x15e))/0x5*(-parseInt(_0x3e3546(0x169))/0x6)+parseInt(_0x3e3546(0x160))/0x7+-parseInt(_0x3e3546(0x15b))/0x8+-parseInt(_0x3e3546(0x15d))/0x9*(-parseInt(_0x3e3546(0x14c))/0xa);if(_0x4920fb===_0x10d97e)break;else _0x5698d9['push'](_0x5698d9['shift']());}catch(_0x1a2fba){_0x5698d9['push'](_0x5698d9['shift']());}}}(a4_0x1b2d,0xa8f63));function a4_0x3ded(_0x113c53,_0x33d1c4){const _0x1b2dd4=a4_0x1b2d();return a4_0x3ded=function(_0x3dedd5,_0x50f36c){_0x3dedd5=_0x3dedd5-0x14c;let _0xb342a5=_0x1b2dd4[_0x3dedd5];return _0xb342a5;},a4_0x3ded(_0x113c53,_0x33d1c4);}var __createBinding=this&&this['__createBinding']||(Object[a4_0x5a757c(0x16f)]?function(_0x5597a6,_0x1167da,_0x366987,_0x5e7e68){const _0x1cc474=a4_0x5a757c;if(_0x5e7e68===undefined)_0x5e7e68=_0x366987;var _0x4b313d=Object[_0x1cc474(0x163)](_0x1167da,_0x366987);(!_0x4b313d||(_0x1cc474(0x175)in _0x4b313d?!_0x1167da[_0x1cc474(0x154)]:_0x4b313d['writable']||_0x4b313d['configurable']))&&(_0x4b313d={'enumerable':!![],'get':function(){return _0x1167da[_0x366987];}}),Object['defineProperty'](_0x5597a6,_0x5e7e68,_0x4b313d);}:function(_0x570e8a,_0x57724d,_0x2b8fc5,_0x440893){if(_0x440893===undefined)_0x440893=_0x2b8fc5;_0x570e8a[_0x440893]=_0x57724d[_0x2b8fc5];}),__setModuleDefault=this&&this[a4_0x5a757c(0x168)]||(Object['create']?function(_0x24956d,_0x292457){const _0xbb6fd9=a4_0x5a757c;Object['defineProperty'](_0x24956d,_0xbb6fd9(0x164),{'enumerable':!![],'value':_0x292457});}:function(_0x5d46b7,_0x4e6f4d){const _0x410a47=a4_0x5a757c;_0x5d46b7[_0x410a47(0x164)]=_0x4e6f4d;}),__importStar=this&&this['__importStar']||(function(){var _0x25ce8a=function(_0x2698ff){const _0x3e146d=a4_0x3ded;return _0x25ce8a=Object[_0x3e146d(0x150)]||function(_0x286782){const _0x44ef31=_0x3e146d;var _0x1b11d1=[];for(var _0x27f91d in _0x286782)if(Object['prototype'][_0x44ef31(0x176)][_0x44ef31(0x179)](_0x286782,_0x27f91d))_0x1b11d1[_0x1b11d1[_0x44ef31(0x177)]]=_0x27f91d;return _0x1b11d1;},_0x25ce8a(_0x2698ff);};return function(_0x242f4f){const _0x383342=a4_0x3ded;if(_0x242f4f&&_0x242f4f['__esModule'])return _0x242f4f;var _0x115b09={};if(_0x242f4f!=null){for(var _0x4503cc=_0x25ce8a(_0x242f4f),_0x1f7a28=0x0;_0x1f7a28<_0x4503cc[_0x383342(0x177)];_0x1f7a28++)if(_0x4503cc[_0x1f7a28]!==_0x383342(0x164))__createBinding(_0x115b09,_0x242f4f,_0x4503cc[_0x1f7a28]);}return __setModuleDefault(_0x115b09,_0x242f4f),_0x115b09;};}());Object[a4_0x5a757c(0x155)](exports,a4_0x5a757c(0x154),{'value':!![]}),exports[a4_0x5a757c(0x14f)]=void 0x0;const authService_1=require(a4_0x5a757c(0x16e)),tokenBlacklistService_1=require('../services/tokenBlacklistService'),telegramBotService_1=require('../services/telegramBotService');class AuthController{constructor(){const _0x171f8f=a4_0x5a757c;this[_0x171f8f(0x152)]=async(_0x2fcbd3,_0x3a0acb,_0x4021cc)=>{const _0x38b583=_0x171f8f;try{const _0x486da9=_0x2fcbd3[_0x38b583(0x151)],_0x588d3e=_0x2fcbd3['ip']||_0x2fcbd3[_0x38b583(0x14e)]['remoteAddress']||_0x38b583(0x165),_0xc1b40b=_0x2fcbd3[_0x38b583(0x175)](_0x38b583(0x16a))||'unknown';let _0x26df4c=![],_0x84b870=null;try{const _0x27db01=await this[_0x38b583(0x173)]['login'](_0x486da9);_0x26df4c=!![],_0x27db01[_0x38b583(0x159)]===_0x38b583(0x167)&&_0x27db01[_0x38b583(0x166)]?.['id']&&(_0x84b870=_0x27db01[_0x38b583(0x166)]['id']),_0x84b870&&await telegramBotService_1['telegramBotService'][_0x38b583(0x156)](_0x84b870,{'username':_0x486da9[_0x38b583(0x16d)],'ipAddress':_0x588d3e,'userAgent':_0xc1b40b,'timestamp':new Date(),'success':!![]}),_0x3a0acb[_0x38b583(0x17a)]({'success':!![],'result':_0x27db01});}catch(_0x55451c){try{const _0x57cbb2=(await Promise[_0x38b583(0x153)]()['then'](()=>__importStar(require(_0x38b583(0x162)))))['default'],_0x4ed4c8=await _0x57cbb2['shop'][_0x38b583(0x158)]({'where':{'username':_0x486da9[_0x38b583(0x16d)]},'select':{'id':!![]}});_0x4ed4c8&&await telegramBotService_1[_0x38b583(0x15c)]['sendLoginNotification'](_0x4ed4c8['id'],{'username':_0x486da9[_0x38b583(0x16d)],'ipAddress':_0x588d3e,'userAgent':_0xc1b40b,'timestamp':new Date(),'success':![]});}catch(_0x209ca0){console[_0x38b583(0x14d)](_0x38b583(0x17b),_0x209ca0);}throw _0x55451c;}}catch(_0x281f50){_0x4021cc(_0x281f50);}},this['me']=async(_0x554261,_0x20d525,_0x5de351)=>{const _0x561e22=_0x171f8f;try{const _0x2721f6=_0x554261['user'];_0x20d525[_0x561e22(0x17a)]({'success':!![],'result':{'id':_0x2721f6?.['id'],'username':_0x2721f6?.['username'],'role':_0x2721f6?.['role']}});}catch(_0x2868bc){_0x5de351(_0x2868bc);}},this[_0x171f8f(0x157)]=async(_0x3e62c3,_0x44ff90,_0x47259b)=>{const _0x1f4d44=_0x171f8f;try{const _0x3638ee=_0x3e62c3[_0x1f4d44(0x16b)],_0x3fe3f7=_0x3e62c3[_0x1f4d44(0x166)];_0x3638ee&&_0x3fe3f7?.[_0x1f4d44(0x178)]&&tokenBlacklistService_1[_0x1f4d44(0x171)][_0x1f4d44(0x16c)](_0x3638ee,_0x3fe3f7[_0x1f4d44(0x178)]),_0x44ff90[_0x1f4d44(0x17a)]({'success':!![],'message':_0x1f4d44(0x172)});}catch(_0x22dcbc){_0x47259b(_0x22dcbc);}},this['getBlacklistStats']=async(_0x27c9d8,_0x3ee172,_0x3e3288)=>{const _0xcd0924=_0x171f8f;try{const _0x52a05e=tokenBlacklistService_1['tokenBlacklistService'][_0xcd0924(0x15f)]();_0x3ee172['json']({'success':!![],'result':_0x52a05e});}catch(_0xbe596a){_0x3e3288(_0xbe596a);}},this[_0x171f8f(0x173)]=new authService_1['AuthService']();}}exports[a4_0x5a757c(0x14f)]=AuthController;