'use strict';function a4_0x5949(_0x3c5400,_0x474261){const _0x1bc76d=a4_0x1bc7();return a4_0x5949=function(_0x5949b2,_0x11eeba){_0x5949b2=_0x5949b2-0x15c;let _0xf16e01=_0x1bc76d[_0x5949b2];return _0xf16e01;},a4_0x5949(_0x3c5400,_0x474261);}const a4_0xb516a2=a4_0x5949;(function(_0x55331a,_0x49f960){const _0x5e4b97=a4_0x5949,_0x1a22a4=_0x55331a();while(!![]){try{const _0x2a195f=-parseInt(_0x5e4b97(0x18c))/0x1+-parseInt(_0x5e4b97(0x15f))/0x2+parseInt(_0x5e4b97(0x170))/0x3+parseInt(_0x5e4b97(0x16d))/0x4*(-parseInt(_0x5e4b97(0x16c))/0x5)+parseInt(_0x5e4b97(0x174))/0x6*(parseInt(_0x5e4b97(0x163))/0x7)+parseInt(_0x5e4b97(0x15e))/0x8+parseInt(_0x5e4b97(0x17a))/0x9;if(_0x2a195f===_0x49f960)break;else _0x1a22a4['push'](_0x1a22a4['shift']());}catch(_0x5317fa){_0x1a22a4['push'](_0x1a22a4['shift']());}}}(a4_0x1bc7,0x9514f));function a4_0x1bc7(){const _0x1df355=['42APRpte','then','get','user','call','__setModuleDefault','Logged\x20out\x20successfully','username','getBlacklistStats','5iklpWY','4495844BzLsxY','role','length','1911603YhsxdC','remoteAddress','error','findUnique','742752JWQGBg','connection','authService','AuthController','body','json','8459541Rnozkg','__esModule','blacklistToken','shop','getStats','writable','configurable','default','sendLoginNotification','getOwnPropertyNames','token','../config/database','exp','../services/tokenBlacklistService','__importStar','prototype','create','unknown','752167cJNeXI','tokenBlacklistService','telegramBotService','3042512MwOaPU','426898ByKCMn','defineProperty','AuthService','Failed\x20to\x20send\x20failed\x20login\x20notification:'];a4_0x1bc7=function(){return _0x1df355;};return a4_0x1bc7();}var __createBinding=this&&this['__createBinding']||(Object[a4_0xb516a2(0x18a)]?function(_0x1731ff,_0xb0b318,_0x4b1941,_0x4aa3cd){const _0x43b6e2=a4_0xb516a2;if(_0x4aa3cd===undefined)_0x4aa3cd=_0x4b1941;var _0x1f84fd=Object['getOwnPropertyDescriptor'](_0xb0b318,_0x4b1941);(!_0x1f84fd||(_0x43b6e2(0x165)in _0x1f84fd?!_0xb0b318['__esModule']:_0x1f84fd[_0x43b6e2(0x17f)]||_0x1f84fd[_0x43b6e2(0x180)]))&&(_0x1f84fd={'enumerable':!![],'get':function(){return _0xb0b318[_0x4b1941];}}),Object[_0x43b6e2(0x160)](_0x1731ff,_0x4aa3cd,_0x1f84fd);}:function(_0x58cf09,_0x505b42,_0xbbf399,_0x14374c){if(_0x14374c===undefined)_0x14374c=_0xbbf399;_0x58cf09[_0x14374c]=_0x505b42[_0xbbf399];}),__setModuleDefault=this&&this[a4_0xb516a2(0x168)]||(Object[a4_0xb516a2(0x18a)]?function(_0x31a5be,_0xc957c8){const _0x15a7c7=a4_0xb516a2;Object[_0x15a7c7(0x160)](_0x31a5be,'default',{'enumerable':!![],'value':_0xc957c8});}:function(_0x4cd995,_0x41a845){const _0x486f49=a4_0xb516a2;_0x4cd995[_0x486f49(0x181)]=_0x41a845;}),__importStar=this&&this[a4_0xb516a2(0x188)]||(function(){var _0x283a3c=function(_0x19d27d){const _0x2532f4=a4_0x5949;return _0x283a3c=Object[_0x2532f4(0x183)]||function(_0x24a90e){const _0xfe1c20=_0x2532f4;var _0x39510c=[];for(var _0x5740c4 in _0x24a90e)if(Object[_0xfe1c20(0x189)]['hasOwnProperty'][_0xfe1c20(0x167)](_0x24a90e,_0x5740c4))_0x39510c[_0x39510c[_0xfe1c20(0x16f)]]=_0x5740c4;return _0x39510c;},_0x283a3c(_0x19d27d);};return function(_0x379912){const _0xdb9f57=a4_0x5949;if(_0x379912&&_0x379912['__esModule'])return _0x379912;var _0x1e8f40={};if(_0x379912!=null){for(var _0x5d227d=_0x283a3c(_0x379912),_0x201cc5=0x0;_0x201cc5<_0x5d227d[_0xdb9f57(0x16f)];_0x201cc5++)if(_0x5d227d[_0x201cc5]!==_0xdb9f57(0x181))__createBinding(_0x1e8f40,_0x379912,_0x5d227d[_0x201cc5]);}return __setModuleDefault(_0x1e8f40,_0x379912),_0x1e8f40;};}());Object['defineProperty'](exports,a4_0xb516a2(0x17b),{'value':!![]}),exports[a4_0xb516a2(0x177)]=void 0x0;const authService_1=require('../services/authService'),tokenBlacklistService_1=require(a4_0xb516a2(0x187)),telegramBotService_1=require('../services/telegramBotService');class AuthController{constructor(){const _0x4e657a=a4_0xb516a2;this['login']=async(_0x1e0064,_0x1d3973,_0x11c412)=>{const _0x35bac4=a4_0x5949;try{const _0x2d3183=_0x1e0064[_0x35bac4(0x178)],_0x2a0697=_0x1e0064['ip']||_0x1e0064[_0x35bac4(0x175)][_0x35bac4(0x171)]||_0x35bac4(0x18b),_0x5e4acd=_0x1e0064['get']('User-Agent')||_0x35bac4(0x18b);let _0x4013aa=![],_0x404311=null;try{const _0x47e3cd=await this['authService']['login'](_0x2d3183);_0x4013aa=!![],_0x47e3cd[_0x35bac4(0x16e)]===_0x35bac4(0x17d)&&_0x47e3cd[_0x35bac4(0x166)]?.['id']&&(_0x404311=_0x47e3cd[_0x35bac4(0x166)]['id']),_0x404311&&await telegramBotService_1[_0x35bac4(0x15d)][_0x35bac4(0x182)](_0x404311,{'username':_0x2d3183[_0x35bac4(0x16a)],'ipAddress':_0x2a0697,'userAgent':_0x5e4acd,'timestamp':new Date(),'success':!![]}),_0x1d3973['json']({'success':!![],'result':_0x47e3cd});}catch(_0x2ad14a){try{const _0x4a1db9=(await Promise['resolve']()[_0x35bac4(0x164)](()=>__importStar(require(_0x35bac4(0x185)))))[_0x35bac4(0x181)],_0x468b00=await _0x4a1db9[_0x35bac4(0x17d)][_0x35bac4(0x173)]({'where':{'username':_0x2d3183['username']},'select':{'id':!![]}});_0x468b00&&await telegramBotService_1['telegramBotService']['sendLoginNotification'](_0x468b00['id'],{'username':_0x2d3183[_0x35bac4(0x16a)],'ipAddress':_0x2a0697,'userAgent':_0x5e4acd,'timestamp':new Date(),'success':![]});}catch(_0x2c5428){console[_0x35bac4(0x172)](_0x35bac4(0x162),_0x2c5428);}throw _0x2ad14a;}}catch(_0x15024e){_0x11c412(_0x15024e);}},this['me']=async(_0x3474de,_0x357810,_0x21744b)=>{const _0x5a48ad=a4_0x5949;try{const _0x28545a=_0x3474de[_0x5a48ad(0x166)];_0x357810[_0x5a48ad(0x179)]({'success':!![],'result':{'id':_0x28545a?.['id'],'username':_0x28545a?.['username'],'role':_0x28545a?.[_0x5a48ad(0x16e)]}});}catch(_0x3d4359){_0x21744b(_0x3d4359);}},this['logout']=async(_0x1026f6,_0x5cb27e,_0x1742b5)=>{const _0x1cb0ec=a4_0x5949;try{const _0x4ec96d=_0x1026f6[_0x1cb0ec(0x184)],_0x52f261=_0x1026f6[_0x1cb0ec(0x166)];_0x4ec96d&&_0x52f261?.['exp']&&tokenBlacklistService_1[_0x1cb0ec(0x15c)][_0x1cb0ec(0x17c)](_0x4ec96d,_0x52f261[_0x1cb0ec(0x186)]),_0x5cb27e[_0x1cb0ec(0x179)]({'success':!![],'message':_0x1cb0ec(0x169)});}catch(_0x12c033){_0x1742b5(_0x12c033);}},this[_0x4e657a(0x16b)]=async(_0x5044f7,_0x1afcb7,_0x15f1a8)=>{const _0x6cd038=_0x4e657a;try{const _0xdcaf5a=tokenBlacklistService_1[_0x6cd038(0x15c)][_0x6cd038(0x17e)]();_0x1afcb7['json']({'success':!![],'result':_0xdcaf5a});}catch(_0x5a2267){_0x15f1a8(_0x5a2267);}},this[_0x4e657a(0x176)]=new authService_1[(_0x4e657a(0x161))]();}}exports[a4_0xb516a2(0x177)]=AuthController;