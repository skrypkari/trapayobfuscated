'use strict';function a4_0x2f2d(){const _0x1faab7=['../config/database','24788slmdvq','remoteAddress','create','error','connection','get','call','default','getStats','105UMFgnw','defineProperty','getOwnPropertyDescriptor','204783JpUdEZ','../services/tokenBlacklistService','sendLoginNotification','__importStar','unknown','findUnique','username','../services/telegramBotService','blacklistToken','AuthService','authService','445839dYRXGS','prototype','45WOfVEp','1783110rHuyfK','role','telegramBotService','AuthController','resolve','__esModule','json','hasOwnProperty','32sRnYPy','2hyPpYS','user','body','getBlacklistStats','login','Failed\x20to\x20send\x20failed\x20login\x20notification:','getOwnPropertyNames','3714HWeMXh','tokenBlacklistService','1347544LGCXbk','350568qwhRDz','logout'];a4_0x2f2d=function(){return _0x1faab7;};return a4_0x2f2d();}const a4_0x212200=a4_0x2fe6;(function(_0x717ed4,_0x534f6d){const _0x1b4ca2=a4_0x2fe6,_0x401f90=_0x717ed4();while(!![]){try{const _0x201452=parseInt(_0x1b4ca2(0xcd))/0x1*(-parseInt(_0x1b4ca2(0xb4))/0x2)+parseInt(_0x1b4ca2(0xd8))/0x3+parseInt(_0x1b4ca2(0xc1))/0x4*(parseInt(_0x1b4ca2(0xaa))/0x5)+-parseInt(_0x1b4ca2(0xbb))/0x6*(-parseInt(_0x1b4ca2(0xca))/0x7)+parseInt(_0x1b4ca2(0xb3))/0x8*(parseInt(_0x1b4ca2(0xbe))/0x9)+-parseInt(_0x1b4ca2(0xab))/0xa+parseInt(_0x1b4ca2(0xbd))/0xb;if(_0x201452===_0x534f6d)break;else _0x401f90['push'](_0x401f90['shift']());}catch(_0x6a1909){_0x401f90['push'](_0x401f90['shift']());}}}(a4_0x2f2d,0x1a959));var __createBinding=this&&this['__createBinding']||(Object[a4_0x212200(0xc3)]?function(_0x5d8171,_0x4065c4,_0x152266,_0x37acb9){const _0x1a72d8=a4_0x212200;if(_0x37acb9===undefined)_0x37acb9=_0x152266;var _0x5b59aa=Object[_0x1a72d8(0xcc)](_0x4065c4,_0x152266);(!_0x5b59aa||(_0x1a72d8(0xc6)in _0x5b59aa?!_0x4065c4['__esModule']:_0x5b59aa['writable']||_0x5b59aa['configurable']))&&(_0x5b59aa={'enumerable':!![],'get':function(){return _0x4065c4[_0x152266];}}),Object['defineProperty'](_0x5d8171,_0x37acb9,_0x5b59aa);}:function(_0x3bc970,_0x293eb3,_0x2df639,_0x5235ac){if(_0x5235ac===undefined)_0x5235ac=_0x2df639;_0x3bc970[_0x5235ac]=_0x293eb3[_0x2df639];}),__setModuleDefault=this&&this['__setModuleDefault']||(Object[a4_0x212200(0xc3)]?function(_0x40a9aa,_0x5ad467){const _0x5715b2=a4_0x212200;Object[_0x5715b2(0xcb)](_0x40a9aa,_0x5715b2(0xc8),{'enumerable':!![],'value':_0x5ad467});}:function(_0x481026,_0xa638b8){const _0x2f3756=a4_0x212200;_0x481026[_0x2f3756(0xc8)]=_0xa638b8;}),__importStar=this&&this[a4_0x212200(0xd0)]||(function(){var _0x1f15d5=function(_0x327090){const _0x2f8143=a4_0x2fe6;return _0x1f15d5=Object[_0x2f8143(0xba)]||function(_0x1a12b8){const _0x34e60e=_0x2f8143;var _0x2ea84e=[];for(var _0x4a8489 in _0x1a12b8)if(Object[_0x34e60e(0xd9)][_0x34e60e(0xb2)][_0x34e60e(0xc7)](_0x1a12b8,_0x4a8489))_0x2ea84e[_0x2ea84e['length']]=_0x4a8489;return _0x2ea84e;},_0x1f15d5(_0x327090);};return function(_0x5ce377){const _0x5dd1b9=a4_0x2fe6;if(_0x5ce377&&_0x5ce377[_0x5dd1b9(0xb0)])return _0x5ce377;var _0x434f4b={};if(_0x5ce377!=null){for(var _0x37acdc=_0x1f15d5(_0x5ce377),_0x3c22b1=0x0;_0x3c22b1<_0x37acdc['length'];_0x3c22b1++)if(_0x37acdc[_0x3c22b1]!=='default')__createBinding(_0x434f4b,_0x5ce377,_0x37acdc[_0x3c22b1]);}return __setModuleDefault(_0x434f4b,_0x5ce377),_0x434f4b;};}());Object[a4_0x212200(0xcb)](exports,'__esModule',{'value':!![]}),exports[a4_0x212200(0xae)]=void 0x0;const authService_1=require('../services/authService'),tokenBlacklistService_1=require(a4_0x212200(0xce)),telegramBotService_1=require(a4_0x212200(0xd4));class AuthController{constructor(){const _0x2b893e=a4_0x212200;this[_0x2b893e(0xb8)]=async(_0x1a4af0,_0x290f4a,_0x382b1)=>{const _0x2c9683=_0x2b893e;try{const _0xc5741c=_0x1a4af0[_0x2c9683(0xb6)],_0x246c7c=_0x1a4af0['ip']||_0x1a4af0[_0x2c9683(0xc5)][_0x2c9683(0xc2)]||_0x2c9683(0xd1),_0x5a3a81=_0x1a4af0['get']('User-Agent')||'unknown';let _0x153bda=![],_0x5b0f3d=null;try{const _0x5afd91=await this['authService'][_0x2c9683(0xb8)](_0xc5741c);_0x153bda=!![],_0x5afd91[_0x2c9683(0xac)]==='shop'&&_0x5afd91[_0x2c9683(0xb5)]?.['id']&&(_0x5b0f3d=_0x5afd91['user']['id']),_0x5b0f3d&&await telegramBotService_1[_0x2c9683(0xad)][_0x2c9683(0xcf)](_0x5b0f3d,{'username':_0xc5741c['username'],'ipAddress':_0x246c7c,'userAgent':_0x5a3a81,'timestamp':new Date(),'success':!![]}),_0x290f4a[_0x2c9683(0xb1)]({'success':!![],'result':_0x5afd91});}catch(_0x45f405){try{const _0xc73661=(await Promise[_0x2c9683(0xaf)]()['then'](()=>__importStar(require(_0x2c9683(0xc0)))))[_0x2c9683(0xc8)],_0x40cf33=await _0xc73661['shop'][_0x2c9683(0xd2)]({'where':{'username':_0xc5741c[_0x2c9683(0xd3)]},'select':{'id':!![]}});_0x40cf33&&await telegramBotService_1[_0x2c9683(0xad)]['sendLoginNotification'](_0x40cf33['id'],{'username':_0xc5741c[_0x2c9683(0xd3)],'ipAddress':_0x246c7c,'userAgent':_0x5a3a81,'timestamp':new Date(),'success':![]});}catch(_0x2844ba){console[_0x2c9683(0xc4)](_0x2c9683(0xb9),_0x2844ba);}throw _0x45f405;}}catch(_0x362a0c){_0x382b1(_0x362a0c);}},this['me']=async(_0x43667c,_0x3b9f36,_0xd11999)=>{const _0x318103=_0x2b893e;try{const _0x4247ad=_0x43667c[_0x318103(0xb5)];_0x3b9f36[_0x318103(0xb1)]({'success':!![],'result':{'id':_0x4247ad?.['id'],'username':_0x4247ad?.[_0x318103(0xd3)],'role':_0x4247ad?.['role']}});}catch(_0x59c41d){_0xd11999(_0x59c41d);}},this[_0x2b893e(0xbf)]=async(_0x5181e5,_0x484781,_0x4116eb)=>{const _0x2a3189=_0x2b893e;try{const _0x18c734=_0x5181e5['token'],_0x597a66=_0x5181e5[_0x2a3189(0xb5)];_0x18c734&&_0x597a66?.['exp']&&tokenBlacklistService_1[_0x2a3189(0xbc)][_0x2a3189(0xd5)](_0x18c734,_0x597a66['exp']),_0x484781[_0x2a3189(0xb1)]({'success':!![],'message':'Logged\x20out\x20successfully'});}catch(_0x2380e8){_0x4116eb(_0x2380e8);}},this[_0x2b893e(0xb7)]=async(_0x626c2,_0xb6c725,_0x512a84)=>{const _0x3dfe98=_0x2b893e;try{const _0x43fee2=tokenBlacklistService_1[_0x3dfe98(0xbc)][_0x3dfe98(0xc9)]();_0xb6c725[_0x3dfe98(0xb1)]({'success':!![],'result':_0x43fee2});}catch(_0xb9decc){_0x512a84(_0xb9decc);}},this[_0x2b893e(0xd7)]=new authService_1[(_0x2b893e(0xd6))]();}}function a4_0x2fe6(_0x18d028,_0x4cf961){const _0x2f2d02=a4_0x2f2d();return a4_0x2fe6=function(_0x2fe681,_0xc5b291){_0x2fe681=_0x2fe681-0xaa;let _0x19e47c=_0x2f2d02[_0x2fe681];return _0x19e47c;},a4_0x2fe6(_0x18d028,_0x4cf961);}exports[a4_0x212200(0xae)]=AuthController;