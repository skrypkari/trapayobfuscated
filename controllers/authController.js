'use strict';const a4_0x580138=a4_0xb3f2;(function(_0x1a7201,_0x1aa5fb){const _0x43cdae=a4_0xb3f2,_0x4ce735=_0x1a7201();while(!![]){try{const _0x37ef00=parseInt(_0x43cdae(0x17d))/0x1*(-parseInt(_0x43cdae(0x180))/0x2)+-parseInt(_0x43cdae(0x192))/0x3*(parseInt(_0x43cdae(0x18f))/0x4)+parseInt(_0x43cdae(0x196))/0x5+-parseInt(_0x43cdae(0x184))/0x6*(parseInt(_0x43cdae(0x168))/0x7)+-parseInt(_0x43cdae(0x16d))/0x8+parseInt(_0x43cdae(0x193))/0x9+parseInt(_0x43cdae(0x181))/0xa;if(_0x37ef00===_0x1aa5fb)break;else _0x4ce735['push'](_0x4ce735['shift']());}catch(_0x3c6287){_0x4ce735['push'](_0x4ce735['shift']());}}}(a4_0x4cb1,0xdbbb3));var __createBinding=this&&this[a4_0x580138(0x18c)]||(Object[a4_0x580138(0x16f)]?function(_0x4be522,_0x6232ea,_0x295268,_0x21170d){const _0x38ea31=a4_0x580138;if(_0x21170d===undefined)_0x21170d=_0x295268;var _0x385994=Object[_0x38ea31(0x169)](_0x6232ea,_0x295268);(!_0x385994||(_0x38ea31(0x189)in _0x385994?!_0x6232ea[_0x38ea31(0x188)]:_0x385994[_0x38ea31(0x18b)]||_0x385994[_0x38ea31(0x17e)]))&&(_0x385994={'enumerable':!![],'get':function(){return _0x6232ea[_0x295268];}}),Object[_0x38ea31(0x16e)](_0x4be522,_0x21170d,_0x385994);}:function(_0x3b51c5,_0xcb590a,_0xd4cf1b,_0x5c6f23){if(_0x5c6f23===undefined)_0x5c6f23=_0xd4cf1b;_0x3b51c5[_0x5c6f23]=_0xcb590a[_0xd4cf1b];}),__setModuleDefault=this&&this['__setModuleDefault']||(Object[a4_0x580138(0x16f)]?function(_0x8b3c89,_0x4ce130){const _0x47f76c=a4_0x580138;Object[_0x47f76c(0x16e)](_0x8b3c89,_0x47f76c(0x186),{'enumerable':!![],'value':_0x4ce130});}:function(_0x526b4b,_0x381ee1){const _0x140651=a4_0x580138;_0x526b4b[_0x140651(0x186)]=_0x381ee1;}),__importStar=this&&this[a4_0x580138(0x195)]||(function(){var _0x52eaba=function(_0x43edc5){const _0x1f626b=a4_0xb3f2;return _0x52eaba=Object[_0x1f626b(0x16a)]||function(_0x183914){const _0x3315d8=_0x1f626b;var _0x818b52=[];for(var _0x187b8a in _0x183914)if(Object[_0x3315d8(0x175)]['hasOwnProperty'][_0x3315d8(0x177)](_0x183914,_0x187b8a))_0x818b52[_0x818b52['length']]=_0x187b8a;return _0x818b52;},_0x52eaba(_0x43edc5);};return function(_0x57ae3d){const _0x26101c=a4_0xb3f2;if(_0x57ae3d&&_0x57ae3d[_0x26101c(0x188)])return _0x57ae3d;var _0x23abba={};if(_0x57ae3d!=null){for(var _0x190887=_0x52eaba(_0x57ae3d),_0x12034e=0x0;_0x12034e<_0x190887[_0x26101c(0x18d)];_0x12034e++)if(_0x190887[_0x12034e]!==_0x26101c(0x186))__createBinding(_0x23abba,_0x57ae3d,_0x190887[_0x12034e]);}return __setModuleDefault(_0x23abba,_0x57ae3d),_0x23abba;};}());Object['defineProperty'](exports,a4_0x580138(0x188),{'value':!![]}),exports['AuthController']=void 0x0;const authService_1=require(a4_0x580138(0x17a)),tokenBlacklistService_1=require(a4_0x580138(0x183)),telegramBotService_1=require(a4_0x580138(0x167));class AuthController{constructor(){const _0x5dc852=a4_0x580138;this[_0x5dc852(0x171)]=async(_0x36fbdc,_0x5aa21c,_0x46a743)=>{const _0x585801=_0x5dc852;try{const _0x58e9ad=_0x36fbdc[_0x585801(0x16c)],_0x357831=_0x36fbdc['ip']||_0x36fbdc[_0x585801(0x190)][_0x585801(0x17c)]||'unknown',_0x5673b6=_0x36fbdc[_0x585801(0x189)](_0x585801(0x173))||'unknown';let _0x2344e2=![],_0x20d1d5=null;try{const _0x25558f=await this[_0x585801(0x170)]['login'](_0x58e9ad);_0x2344e2=!![],_0x25558f['role']===_0x585801(0x194)&&_0x25558f[_0x585801(0x182)]?.['id']&&(_0x20d1d5=_0x25558f['user']['id']),_0x20d1d5&&await telegramBotService_1[_0x585801(0x185)][_0x585801(0x17f)](_0x20d1d5,{'username':_0x58e9ad[_0x585801(0x178)],'ipAddress':_0x357831,'userAgent':_0x5673b6,'timestamp':new Date(),'success':!![]}),_0x5aa21c['json']({'success':!![],'result':_0x25558f});}catch(_0x2084b8){try{const _0x4ad193=(await Promise[_0x585801(0x187)]()[_0x585801(0x17b)](()=>__importStar(require(_0x585801(0x191)))))['default'],_0x2ca406=await _0x4ad193[_0x585801(0x194)]['findUnique']({'where':{'username':_0x58e9ad[_0x585801(0x178)]},'select':{'id':!![]}});_0x2ca406&&await telegramBotService_1['telegramBotService']['sendLoginNotification'](_0x2ca406['id'],{'username':_0x58e9ad[_0x585801(0x178)],'ipAddress':_0x357831,'userAgent':_0x5673b6,'timestamp':new Date(),'success':![]});}catch(_0x124e49){console[_0x585801(0x18a)]('Failed\x20to\x20send\x20failed\x20login\x20notification:',_0x124e49);}throw _0x2084b8;}}catch(_0x34edee){_0x46a743(_0x34edee);}},this['me']=async(_0x4c3a01,_0x213318,_0x2d4b00)=>{const _0x31e067=_0x5dc852;try{const _0x32f19d=_0x4c3a01[_0x31e067(0x182)];_0x213318['json']({'success':!![],'result':{'id':_0x32f19d?.['id'],'username':_0x32f19d?.[_0x31e067(0x178)],'role':_0x32f19d?.[_0x31e067(0x174)]}});}catch(_0x24854c){_0x2d4b00(_0x24854c);}},this[_0x5dc852(0x176)]=async(_0x502e70,_0xbbf2f6,_0x37ca14)=>{const _0x21762d=_0x5dc852;try{const _0x48c6a4=_0x502e70['token'],_0x5970bf=_0x502e70['user'];_0x48c6a4&&_0x5970bf?.[_0x21762d(0x165)]&&tokenBlacklistService_1[_0x21762d(0x16b)]['blacklistToken'](_0x48c6a4,_0x5970bf[_0x21762d(0x165)]),_0xbbf2f6[_0x21762d(0x179)]({'success':!![],'message':_0x21762d(0x172)});}catch(_0x3156b6){_0x37ca14(_0x3156b6);}},this[_0x5dc852(0x164)]=async(_0x2118e1,_0xfe7bc7,_0x27c82a)=>{const _0x3c6609=_0x5dc852;try{const _0x41d512=tokenBlacklistService_1['tokenBlacklistService']['getStats']();_0xfe7bc7[_0x3c6609(0x179)]({'success':!![],'result':_0x41d512});}catch(_0x5c1203){_0x27c82a(_0x5c1203);}},this[_0x5dc852(0x170)]=new authService_1[(_0x5dc852(0x166))]();}}function a4_0xb3f2(_0x2cfb82,_0x332099){const _0x4cb13d=a4_0x4cb1();return a4_0xb3f2=function(_0xb3f29b,_0x8d6353){_0xb3f29b=_0xb3f29b-0x164;let _0x5cbf01=_0x4cb13d[_0xb3f29b];return _0x5cbf01;},a4_0xb3f2(_0x2cfb82,_0x332099);}exports[a4_0x580138(0x18e)]=AuthController;function a4_0x4cb1(){const _0x2d394c=['4500295dITfIX','getBlacklistStats','exp','AuthService','../services/telegramBotService','76118WatrJj','getOwnPropertyDescriptor','getOwnPropertyNames','tokenBlacklistService','body','14028600HRoRiA','defineProperty','create','authService','login','Logged\x20out\x20successfully','User-Agent','role','prototype','logout','call','username','json','../services/authService','then','remoteAddress','137RnNSco','configurable','sendLoginNotification','18584mMdDtY','38275910ABCKOY','user','../services/tokenBlacklistService','456VcmGOt','telegramBotService','default','resolve','__esModule','get','error','writable','__createBinding','length','AuthController','4kEMCoP','connection','../config/database','210147GzuAxm','858789VLoQzR','shop','__importStar'];a4_0x4cb1=function(){return _0x2d394c;};return a4_0x4cb1();}