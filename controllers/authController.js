'use strict';function a4_0x291a(){const _0x14e1ca=['tokenBlacklistService','json','body','resolve','getStats','6nxGBdt','authService','1923DipqFJ','1607480fnLxdK','get','../services/tokenBlacklistService','writable','configurable','getOwnPropertyDescriptor','Logged\x20out\x20successfully','connection','user','token','prototype','__setModuleDefault','findUnique','__esModule','default','5806955YmfQTC','error','create','AuthController','remoteAddress','850419jRHbmK','__createBinding','1072925qjQuse','login','45477enrxBb','../services/authService','sendLoginNotification','1912SHYSqD','11toFjfm','role','318110zCIJUY','1608cJIKld','../config/database','telegramBotService','exp','../services/telegramBotService','defineProperty','unknown','User-Agent','username','blacklistToken','__importStar'];a4_0x291a=function(){return _0x14e1ca;};return a4_0x291a();}const a4_0x36a3a6=a4_0x13af;(function(_0x1ee4d1,_0x1de148){const _0x5933cf=a4_0x13af,_0xd59d2d=_0x1ee4d1();while(!![]){try{const _0x3a5028=parseInt(_0x5933cf(0x9c))/0x1+-parseInt(_0x5933cf(0xa3))/0x2*(parseInt(_0x5933cf(0x87))/0x3)+parseInt(_0x5933cf(0x88))/0x4+parseInt(_0x5933cf(0x97))/0x5*(parseInt(_0x5933cf(0x85))/0x6)+-parseInt(_0x5933cf(0x9e))/0x7+-parseInt(_0x5933cf(0xa7))/0x8*(parseInt(_0x5933cf(0xa0))/0x9)+-parseInt(_0x5933cf(0xa6))/0xa*(parseInt(_0x5933cf(0xa4))/0xb);if(_0x3a5028===_0x1de148)break;else _0xd59d2d['push'](_0xd59d2d['shift']());}catch(_0x56ed27){_0xd59d2d['push'](_0xd59d2d['shift']());}}}(a4_0x291a,0x92851));function a4_0x13af(_0x5ec854,_0xb23503){const _0x291a72=a4_0x291a();return a4_0x13af=function(_0x13af99,_0x27c029){_0x13af99=_0x13af99-0x84;let _0x30018b=_0x291a72[_0x13af99];return _0x30018b;},a4_0x13af(_0x5ec854,_0xb23503);}var __createBinding=this&&this[a4_0x36a3a6(0x9d)]||(Object[a4_0x36a3a6(0x99)]?function(_0xa57324,_0x12e5bf,_0x456f78,_0x98c6b9){const _0x2c006d=a4_0x36a3a6;if(_0x98c6b9===undefined)_0x98c6b9=_0x456f78;var _0x378a42=Object[_0x2c006d(0x8d)](_0x12e5bf,_0x456f78);(!_0x378a42||(_0x2c006d(0x89)in _0x378a42?!_0x12e5bf[_0x2c006d(0x95)]:_0x378a42[_0x2c006d(0x8b)]||_0x378a42[_0x2c006d(0x8c)]))&&(_0x378a42={'enumerable':!![],'get':function(){return _0x12e5bf[_0x456f78];}}),Object[_0x2c006d(0xac)](_0xa57324,_0x98c6b9,_0x378a42);}:function(_0x331c7a,_0x24d4ca,_0x4dd67c,_0x437916){if(_0x437916===undefined)_0x437916=_0x4dd67c;_0x331c7a[_0x437916]=_0x24d4ca[_0x4dd67c];}),__setModuleDefault=this&&this[a4_0x36a3a6(0x93)]||(Object[a4_0x36a3a6(0x99)]?function(_0x3d73af,_0x26e0f5){const _0x248048=a4_0x36a3a6;Object[_0x248048(0xac)](_0x3d73af,_0x248048(0x96),{'enumerable':!![],'value':_0x26e0f5});}:function(_0x289092,_0x410227){const _0x2965bf=a4_0x36a3a6;_0x289092[_0x2965bf(0x96)]=_0x410227;}),__importStar=this&&this[a4_0x36a3a6(0xb1)]||(function(){var _0x48e04e=function(_0x3919ae){return _0x48e04e=Object['getOwnPropertyNames']||function(_0x4df534){const _0x1cc3ce=a4_0x13af;var _0x44bfb1=[];for(var _0xd90ad3 in _0x4df534)if(Object[_0x1cc3ce(0x92)]['hasOwnProperty']['call'](_0x4df534,_0xd90ad3))_0x44bfb1[_0x44bfb1['length']]=_0xd90ad3;return _0x44bfb1;},_0x48e04e(_0x3919ae);};return function(_0x43cec6){const _0x3f10f0=a4_0x13af;if(_0x43cec6&&_0x43cec6['__esModule'])return _0x43cec6;var _0xada320={};if(_0x43cec6!=null){for(var _0x52dfc0=_0x48e04e(_0x43cec6),_0x44e122=0x0;_0x44e122<_0x52dfc0['length'];_0x44e122++)if(_0x52dfc0[_0x44e122]!==_0x3f10f0(0x96))__createBinding(_0xada320,_0x43cec6,_0x52dfc0[_0x44e122]);}return __setModuleDefault(_0xada320,_0x43cec6),_0xada320;};}());Object['defineProperty'](exports,a4_0x36a3a6(0x95),{'value':!![]}),exports[a4_0x36a3a6(0x9a)]=void 0x0;const authService_1=require(a4_0x36a3a6(0xa1)),tokenBlacklistService_1=require(a4_0x36a3a6(0x8a)),telegramBotService_1=require(a4_0x36a3a6(0xab));class AuthController{constructor(){this['login']=async(_0x4d2c2f,_0x3aa7e8,_0x5a3f09)=>{const _0x3b1573=a4_0x13af;try{const _0x5031ec=_0x4d2c2f[_0x3b1573(0xb4)],_0x51aa9e=_0x4d2c2f['ip']||_0x4d2c2f[_0x3b1573(0x8f)][_0x3b1573(0x9b)]||_0x3b1573(0xad),_0xd07de7=_0x4d2c2f[_0x3b1573(0x89)](_0x3b1573(0xae))||'unknown';let _0x4f717a=![],_0xe05ac5=null;try{const _0x3e3d81=await this[_0x3b1573(0x86)][_0x3b1573(0x9f)](_0x5031ec);_0x4f717a=!![],_0x3e3d81[_0x3b1573(0xa5)]==='shop'&&_0x3e3d81[_0x3b1573(0x90)]?.['id']&&(_0xe05ac5=_0x3e3d81['user']['id']),_0xe05ac5&&await telegramBotService_1[_0x3b1573(0xa9)][_0x3b1573(0xa2)](_0xe05ac5,{'username':_0x5031ec['username'],'ipAddress':_0x51aa9e,'userAgent':_0xd07de7,'timestamp':new Date(),'success':!![]}),_0x3aa7e8[_0x3b1573(0xb3)]({'success':!![],'result':_0x3e3d81});}catch(_0x4b33df){try{const _0x5df90b=(await Promise[_0x3b1573(0xb5)]()['then'](()=>__importStar(require(_0x3b1573(0xa8)))))[_0x3b1573(0x96)],_0x3c6992=await _0x5df90b['shop'][_0x3b1573(0x94)]({'where':{'username':_0x5031ec[_0x3b1573(0xaf)]},'select':{'id':!![]}});_0x3c6992&&await telegramBotService_1[_0x3b1573(0xa9)]['sendLoginNotification'](_0x3c6992['id'],{'username':_0x5031ec[_0x3b1573(0xaf)],'ipAddress':_0x51aa9e,'userAgent':_0xd07de7,'timestamp':new Date(),'success':![]});}catch(_0x4316c4){console[_0x3b1573(0x98)]('Failed\x20to\x20send\x20failed\x20login\x20notification:',_0x4316c4);}throw _0x4b33df;}}catch(_0x51b216){_0x5a3f09(_0x51b216);}},this['me']=async(_0x380f5c,_0x32422d,_0x479757)=>{const _0x448cd8=a4_0x13af;try{const _0x59838b=_0x380f5c['user'];_0x32422d['json']({'success':!![],'result':{'id':_0x59838b?.['id'],'username':_0x59838b?.['username'],'role':_0x59838b?.[_0x448cd8(0xa5)]}});}catch(_0x1164d3){_0x479757(_0x1164d3);}},this['logout']=async(_0x341578,_0x27a48f,_0xe0598e)=>{const _0x24f457=a4_0x13af;try{const _0xe9d2bf=_0x341578[_0x24f457(0x91)],_0x18aeb4=_0x341578[_0x24f457(0x90)];_0xe9d2bf&&_0x18aeb4?.[_0x24f457(0xaa)]&&tokenBlacklistService_1['tokenBlacklistService'][_0x24f457(0xb0)](_0xe9d2bf,_0x18aeb4[_0x24f457(0xaa)]),_0x27a48f['json']({'success':!![],'message':_0x24f457(0x8e)});}catch(_0x5c5b28){_0xe0598e(_0x5c5b28);}},this['getBlacklistStats']=async(_0x41c4dc,_0x351625,_0x5cf340)=>{const _0x12016c=a4_0x13af;try{const _0xef4dd3=tokenBlacklistService_1[_0x12016c(0xb2)][_0x12016c(0x84)]();_0x351625['json']({'success':!![],'result':_0xef4dd3});}catch(_0x1fbb52){_0x5cf340(_0x1fbb52);}},this['authService']=new authService_1['AuthService']();}}exports[a4_0x36a3a6(0x9a)]=AuthController;