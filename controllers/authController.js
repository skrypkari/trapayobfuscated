'use strict';const a4_0x335b17=a4_0x389e;function a4_0x7383(){const _0x45d23d=['1974WNQpgf','1937871AKfNsw','unknown','authService','tokenBlacklistService','96743kFEIjt','__createBinding','getOwnPropertyNames','blacklistToken','208dwTsEy','then','User-Agent','5664gqiTKJ','__setModuleDefault','getBlacklistStats','getStats','shop','prototype','call','configurable','sendLoginNotification','AuthService','get','hasOwnProperty','283922kEUiBD','default','connection','remoteAddress','login','error','__esModule','exp','body','token','defineProperty','704840yYWCrR','length','resolve','user','../config/database','../services/authService','351190YnHMba','1656kZDQIq','AuthController','json','username','telegramBotService'];a4_0x7383=function(){return _0x45d23d;};return a4_0x7383();}(function(_0xa11d44,_0x401eca){const _0x3d4fda=a4_0x389e,_0x411b4a=_0xa11d44();while(!![]){try{const _0x529aa2=parseInt(_0x3d4fda(0x134))/0x1+-parseInt(_0x3d4fda(0x147))/0x2+parseInt(_0x3d4fda(0x13b))/0x3*(-parseInt(_0x3d4fda(0x138))/0x4)+parseInt(_0x3d4fda(0x158))/0x5+parseInt(_0x3d4fda(0x159))/0x6*(parseInt(_0x3d4fda(0x15e))/0x7)+-parseInt(_0x3d4fda(0x152))/0x8+parseInt(_0x3d4fda(0x130))/0x9;if(_0x529aa2===_0x401eca)break;else _0x411b4a['push'](_0x411b4a['shift']());}catch(_0x14dc60){_0x411b4a['push'](_0x411b4a['shift']());}}}(a4_0x7383,0x20332));var __createBinding=this&&this[a4_0x335b17(0x135)]||(Object['create']?function(_0x130a56,_0x4e528a,_0x4e4993,_0x1566e6){const _0x2fc13b=a4_0x335b17;if(_0x1566e6===undefined)_0x1566e6=_0x4e4993;var _0x4eb4e0=Object['getOwnPropertyDescriptor'](_0x4e528a,_0x4e4993);(!_0x4eb4e0||(_0x2fc13b(0x145)in _0x4eb4e0?!_0x4e528a[_0x2fc13b(0x14d)]:_0x4eb4e0['writable']||_0x4eb4e0[_0x2fc13b(0x142)]))&&(_0x4eb4e0={'enumerable':!![],'get':function(){return _0x4e528a[_0x4e4993];}}),Object['defineProperty'](_0x130a56,_0x1566e6,_0x4eb4e0);}:function(_0x922342,_0x35cdc2,_0x3a0c19,_0xcc6f91){if(_0xcc6f91===undefined)_0xcc6f91=_0x3a0c19;_0x922342[_0xcc6f91]=_0x35cdc2[_0x3a0c19];}),__setModuleDefault=this&&this[a4_0x335b17(0x13c)]||(Object['create']?function(_0x3b6443,_0x4068d8){const _0x3b5545=a4_0x335b17;Object[_0x3b5545(0x151)](_0x3b6443,_0x3b5545(0x148),{'enumerable':!![],'value':_0x4068d8});}:function(_0x67ee24,_0x19740d){_0x67ee24['default']=_0x19740d;}),__importStar=this&&this['__importStar']||(function(){var _0x3f2063=function(_0x495088){const _0x4965e2=a4_0x389e;return _0x3f2063=Object[_0x4965e2(0x136)]||function(_0x23d40d){const _0x41403b=_0x4965e2;var _0x513c6b=[];for(var _0x56747e in _0x23d40d)if(Object[_0x41403b(0x140)][_0x41403b(0x146)][_0x41403b(0x141)](_0x23d40d,_0x56747e))_0x513c6b[_0x513c6b[_0x41403b(0x153)]]=_0x56747e;return _0x513c6b;},_0x3f2063(_0x495088);};return function(_0x40a2f5){const _0x4f0825=a4_0x389e;if(_0x40a2f5&&_0x40a2f5[_0x4f0825(0x14d)])return _0x40a2f5;var _0x3f94e4={};if(_0x40a2f5!=null){for(var _0x15e050=_0x3f2063(_0x40a2f5),_0x5e7417=0x0;_0x5e7417<_0x15e050[_0x4f0825(0x153)];_0x5e7417++)if(_0x15e050[_0x5e7417]!==_0x4f0825(0x148))__createBinding(_0x3f94e4,_0x40a2f5,_0x15e050[_0x5e7417]);}return __setModuleDefault(_0x3f94e4,_0x40a2f5),_0x3f94e4;};}());function a4_0x389e(_0x11d53c,_0x1fa6df){const _0x738337=a4_0x7383();return a4_0x389e=function(_0x389e8a,_0x9b3a3c){_0x389e8a=_0x389e8a-0x130;let _0x2950e5=_0x738337[_0x389e8a];return _0x2950e5;},a4_0x389e(_0x11d53c,_0x1fa6df);}Object[a4_0x335b17(0x151)](exports,a4_0x335b17(0x14d),{'value':!![]}),exports[a4_0x335b17(0x15a)]=void 0x0;const authService_1=require(a4_0x335b17(0x157)),tokenBlacklistService_1=require('../services/tokenBlacklistService'),telegramBotService_1=require('../services/telegramBotService');class AuthController{constructor(){const _0x343752=a4_0x335b17;this[_0x343752(0x14b)]=async(_0x284fbb,_0xc0be04,_0x292f1a)=>{const _0x61be5d=_0x343752;try{const _0x19348f=_0x284fbb[_0x61be5d(0x14f)],_0x55a349=_0x284fbb['ip']||_0x284fbb[_0x61be5d(0x149)][_0x61be5d(0x14a)]||_0x61be5d(0x131),_0x2c2540=_0x284fbb[_0x61be5d(0x145)](_0x61be5d(0x13a))||_0x61be5d(0x131);let _0x1c690d=![],_0x3c7151=null;try{const _0x15a6ff=await this[_0x61be5d(0x132)][_0x61be5d(0x14b)](_0x19348f);_0x1c690d=!![],_0x15a6ff['role']===_0x61be5d(0x13f)&&_0x15a6ff[_0x61be5d(0x155)]?.['id']&&(_0x3c7151=_0x15a6ff[_0x61be5d(0x155)]['id']),_0x3c7151&&await telegramBotService_1[_0x61be5d(0x15d)][_0x61be5d(0x143)](_0x3c7151,{'username':_0x19348f[_0x61be5d(0x15c)],'ipAddress':_0x55a349,'userAgent':_0x2c2540,'timestamp':new Date(),'success':!![]}),_0xc0be04[_0x61be5d(0x15b)]({'success':!![],'result':_0x15a6ff});}catch(_0x3866f1){try{const _0x18946f=(await Promise[_0x61be5d(0x154)]()[_0x61be5d(0x139)](()=>__importStar(require(_0x61be5d(0x156)))))['default'],_0x35e2cf=await _0x18946f[_0x61be5d(0x13f)]['findUnique']({'where':{'username':_0x19348f[_0x61be5d(0x15c)]},'select':{'id':!![]}});_0x35e2cf&&await telegramBotService_1[_0x61be5d(0x15d)][_0x61be5d(0x143)](_0x35e2cf['id'],{'username':_0x19348f['username'],'ipAddress':_0x55a349,'userAgent':_0x2c2540,'timestamp':new Date(),'success':![]});}catch(_0x273c30){console[_0x61be5d(0x14c)]('Failed\x20to\x20send\x20failed\x20login\x20notification:',_0x273c30);}throw _0x3866f1;}}catch(_0x53bcb0){_0x292f1a(_0x53bcb0);}},this['me']=async(_0x41c6e4,_0x199e55,_0x2f2c50)=>{const _0x2ce7dc=_0x343752;try{const _0x347ad3=_0x41c6e4[_0x2ce7dc(0x155)];_0x199e55['json']({'success':!![],'result':{'id':_0x347ad3?.['id'],'username':_0x347ad3?.[_0x2ce7dc(0x15c)],'role':_0x347ad3?.['role']}});}catch(_0x380abd){_0x2f2c50(_0x380abd);}},this['logout']=async(_0x545cd9,_0x656fb9,_0x277eb4)=>{const _0x3fa658=_0x343752;try{const _0x241fdf=_0x545cd9[_0x3fa658(0x150)],_0x1848dd=_0x545cd9[_0x3fa658(0x155)];_0x241fdf&&_0x1848dd?.[_0x3fa658(0x14e)]&&tokenBlacklistService_1[_0x3fa658(0x133)][_0x3fa658(0x137)](_0x241fdf,_0x1848dd['exp']),_0x656fb9['json']({'success':!![],'message':'Logged\x20out\x20successfully'});}catch(_0x589892){_0x277eb4(_0x589892);}},this[_0x343752(0x13d)]=async(_0x31b43a,_0x2dfb1b,_0x13ef5e)=>{const _0x20f1e7=_0x343752;try{const _0xf17e3b=tokenBlacklistService_1[_0x20f1e7(0x133)][_0x20f1e7(0x13e)]();_0x2dfb1b[_0x20f1e7(0x15b)]({'success':!![],'result':_0xf17e3b});}catch(_0x1b9c23){_0x13ef5e(_0x1b9c23);}},this[_0x343752(0x132)]=new authService_1[(_0x343752(0x144))]();}}exports[a4_0x335b17(0x15a)]=AuthController;