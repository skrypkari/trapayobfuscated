'use strict';const a4_0x250a15=a4_0x2340;(function(_0x225956,_0x46d0fe){const _0x73843d=a4_0x2340,_0x4eff80=_0x225956();while(!![]){try{const _0x4c5e45=parseInt(_0x73843d(0x11a))/0x1*(-parseInt(_0x73843d(0x12c))/0x2)+-parseInt(_0x73843d(0x135))/0x3+parseInt(_0x73843d(0x130))/0x4*(-parseInt(_0x73843d(0x119))/0x5)+-parseInt(_0x73843d(0x12f))/0x6+-parseInt(_0x73843d(0x124))/0x7+-parseInt(_0x73843d(0x126))/0x8*(-parseInt(_0x73843d(0x112))/0x9)+parseInt(_0x73843d(0x11b))/0xa;if(_0x4c5e45===_0x46d0fe)break;else _0x4eff80['push'](_0x4eff80['shift']());}catch(_0x56263a){_0x4eff80['push'](_0x4eff80['shift']());}}}(a4_0x2f63,0xf0d07));function a4_0x2f63(){const _0x1bec96=['User-Agent','login','error','unknown','then','hasOwnProperty','create','11533970vImyCO','connection','1351192dTzzVv','length','writable','exp','blacklistToken','defineProperty','10KtaRlQ','role','AuthService','542880GxfmNQ','32kjuOfE','Failed\x20to\x20send\x20failed\x20login\x20notification:','telegramBotService','tokenBlacklistService','getStats','1016628UtmcQG','get','__createBinding','sendLoginNotification','../config/database','ipAddress','call','user','userAgent','getOwnPropertyDescriptor','default','9qAaNRp','remoteAddress','__esModule','configurable','AuthController','authService','json','785885hBlRzT','335747SGMZjB','58306930FCLvXh','prototype'];a4_0x2f63=function(){return _0x1bec96;};return a4_0x2f63();}function a4_0x2340(_0x46082e,_0x3c98e4){_0x46082e=_0x46082e-0x110;const _0x2f63e8=a4_0x2f63();let _0x23404f=_0x2f63e8[_0x46082e];return _0x23404f;}var __createBinding=this&&this[a4_0x250a15(0x137)]||(Object[a4_0x250a15(0x123)]?function(_0x8811a8,_0x222c45,_0x5a012c,_0x1b4908){const _0x78be42=a4_0x250a15;if(_0x1b4908===undefined)_0x1b4908=_0x5a012c;var _0x5a760e=Object[_0x78be42(0x110)](_0x222c45,_0x5a012c);(!_0x5a760e||(_0x78be42(0x136)in _0x5a760e?!_0x222c45['__esModule']:_0x5a760e[_0x78be42(0x128)]||_0x5a760e[_0x78be42(0x115)]))&&(_0x5a760e={'enumerable':!![],'get':function(){return _0x222c45[_0x5a012c];}}),Object['defineProperty'](_0x8811a8,_0x1b4908,_0x5a760e);}:function(_0x244f0d,_0x390142,_0x170444,_0x34604c){if(_0x34604c===undefined)_0x34604c=_0x170444;_0x244f0d[_0x34604c]=_0x390142[_0x170444];}),__setModuleDefault=this&&this['__setModuleDefault']||(Object[a4_0x250a15(0x123)]?function(_0x1ed851,_0x130710){const _0x440184=a4_0x250a15;Object[_0x440184(0x12b)](_0x1ed851,_0x440184(0x111),{'enumerable':!![],'value':_0x130710});}:function(_0x5ae451,_0x2f068c){const _0x23433a=a4_0x250a15;_0x5ae451[_0x23433a(0x111)]=_0x2f068c;}),__importStar=this&&this['__importStar']||(function(){var _0x453f07=function(_0x25dd9b){return _0x453f07=Object['getOwnPropertyNames']||function(_0x22eedc){const _0x1903dc=a4_0x2340;var _0x3184df=[];for(var _0x3dd57d in _0x22eedc)if(Object[_0x1903dc(0x11c)][_0x1903dc(0x122)][_0x1903dc(0x13b)](_0x22eedc,_0x3dd57d))_0x3184df[_0x3184df[_0x1903dc(0x127)]]=_0x3dd57d;return _0x3184df;},_0x453f07(_0x25dd9b);};return function(_0xa79cf5){const _0x182242=a4_0x2340;if(_0xa79cf5&&_0xa79cf5[_0x182242(0x114)])return _0xa79cf5;var _0x202c59={};if(_0xa79cf5!=null){for(var _0x21699e=_0x453f07(_0xa79cf5),_0x4f59df=0x0;_0x4f59df<_0x21699e['length'];_0x4f59df++)if(_0x21699e[_0x4f59df]!==_0x182242(0x111))__createBinding(_0x202c59,_0xa79cf5,_0x21699e[_0x4f59df]);}return __setModuleDefault(_0x202c59,_0xa79cf5),_0x202c59;};}());Object['defineProperty'](exports,a4_0x250a15(0x114),{'value':!![]}),exports[a4_0x250a15(0x116)]=void 0x0;const authService_1=require('../services/authService'),tokenBlacklistService_1=require('../services/tokenBlacklistService'),telegramBotService_1=require('../services/telegramBotService');class AuthController{constructor(){const _0x530ae2=a4_0x250a15;this[_0x530ae2(0x11e)]=async(_0x5bf1a2,_0x58aea1,_0xf3b9d5)=>{const _0x3273a2=_0x530ae2;try{const _0x4610be=_0x5bf1a2['body'],_0xcc92dc=_0x4610be[_0x3273a2(0x13a)]||_0x5bf1a2['ip']||_0x5bf1a2[_0x3273a2(0x125)][_0x3273a2(0x113)]||_0x3273a2(0x120),_0x299a92=_0x4610be[_0x3273a2(0x13d)]||_0x5bf1a2[_0x3273a2(0x136)](_0x3273a2(0x11d))||'unknown',_0x24cced=_0x4610be['geo'];let _0x101489=![],_0x104a63=null;try{const _0x34495d=await this[_0x3273a2(0x117)][_0x3273a2(0x11e)](_0x4610be);_0x101489=!![],_0x34495d[_0x3273a2(0x12d)]==='shop'&&_0x34495d[_0x3273a2(0x13c)]?.['id']&&(_0x104a63=_0x34495d['user']['id']),_0x104a63&&await telegramBotService_1[_0x3273a2(0x132)][_0x3273a2(0x138)](_0x104a63,{'username':_0x4610be['username'],'ipAddress':_0xcc92dc,'userAgent':_0x299a92,'geo':_0x24cced,'timestamp':new Date(),'success':!![]}),_0x58aea1[_0x3273a2(0x118)]({'success':!![],'result':_0x34495d});}catch(_0xcfa38c){try{const _0x29112e=(await Promise['resolve']()[_0x3273a2(0x121)](()=>__importStar(require(_0x3273a2(0x139)))))[_0x3273a2(0x111)],_0x199f36=await _0x29112e['shop']['findUnique']({'where':{'username':_0x4610be['username']},'select':{'id':!![]}});_0x199f36&&await telegramBotService_1['telegramBotService']['sendLoginNotification'](_0x199f36['id'],{'username':_0x4610be['username'],'ipAddress':_0xcc92dc,'userAgent':_0x299a92,'geo':_0x24cced,'timestamp':new Date(),'success':![]});}catch(_0x564ef9){console[_0x3273a2(0x11f)](_0x3273a2(0x131),_0x564ef9);}throw _0xcfa38c;}}catch(_0x5f55ba){_0xf3b9d5(_0x5f55ba);}},this['me']=async(_0x1b029a,_0xafc14a,_0x4f8053)=>{const _0x4b5aa6=_0x530ae2;try{const _0x54ee50=_0x1b029a[_0x4b5aa6(0x13c)];_0xafc14a[_0x4b5aa6(0x118)]({'success':!![],'result':{'id':_0x54ee50?.['id'],'username':_0x54ee50?.['username'],'role':_0x54ee50?.['role']}});}catch(_0x23d6f3){_0x4f8053(_0x23d6f3);}},this['logout']=async(_0x301058,_0x4a9ca2,_0x9fcf55)=>{const _0x139d4f=_0x530ae2;try{const _0x1dbaeb=_0x301058['token'],_0x2fc74a=_0x301058[_0x139d4f(0x13c)];_0x1dbaeb&&_0x2fc74a?.[_0x139d4f(0x129)]&&tokenBlacklistService_1[_0x139d4f(0x133)][_0x139d4f(0x12a)](_0x1dbaeb,_0x2fc74a[_0x139d4f(0x129)]),_0x4a9ca2['json']({'success':!![],'message':'Logged\x20out\x20successfully'});}catch(_0x472abf){_0x9fcf55(_0x472abf);}},this['getBlacklistStats']=async(_0x2c6f0e,_0x188789,_0x12c12e)=>{const _0x4e0022=_0x530ae2;try{const _0x906d7f=tokenBlacklistService_1['tokenBlacklistService'][_0x4e0022(0x134)]();_0x188789['json']({'success':!![],'result':_0x906d7f});}catch(_0x55fce7){_0x12c12e(_0x55fce7);}},this['authService']=new authService_1[(_0x530ae2(0x12e))]();}}exports['AuthController']=AuthController;