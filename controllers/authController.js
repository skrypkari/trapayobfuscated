'use strict';const a4_0x1d3833=a4_0x537f;function a4_0xc7f0(){const _0x328119=['defineProperty','getStats','authService','4525928tsvhYh','4servlH','__importStar','133373GtdQqd','findUnique','../config/database','AuthService','blacklistToken','remoteAddress','__setModuleDefault','prototype','json','5447670cBXkqj','login','create','12qfBDSN','getOwnPropertyDescriptor','call','139570WLotah','hasOwnProperty','../services/authService','5226340icHIFT','logout','shop','get','tokenBlacklistService','userAgent','user','4500183MBYmXN','sendLoginNotification','exp','getBlacklistStats','ipAddress','username','27lBWPgx','unknown','length','642300FgRAGQ','Failed\x20to\x20send\x20failed\x20login\x20notification:','default','__esModule','../services/telegramBotService','body','role'];a4_0xc7f0=function(){return _0x328119;};return a4_0xc7f0();}(function(_0x19bb65,_0x507fa2){const _0x4ed703=a4_0x537f,_0xe47ff=_0x19bb65();while(!![]){try{const _0x535a97=-parseInt(_0x4ed703(0x203))/0x1*(-parseInt(_0x4ed703(0x1e0))/0x2)+parseInt(_0x4ed703(0x1ed))/0x3*(parseInt(_0x4ed703(0x201))/0x4)+parseInt(_0x4ed703(0x1f6))/0x5+parseInt(_0x4ed703(0x20c))/0x6+-parseInt(_0x4ed703(0x1e6))/0x7+parseInt(_0x4ed703(0x200))/0x8*(-parseInt(_0x4ed703(0x1f3))/0x9)+parseInt(_0x4ed703(0x1e3))/0xa;if(_0x535a97===_0x507fa2)break;else _0xe47ff['push'](_0xe47ff['shift']());}catch(_0x49219b){_0xe47ff['push'](_0xe47ff['shift']());}}}(a4_0xc7f0,0xdd642));function a4_0x537f(_0x379a10,_0x33df97){_0x379a10=_0x379a10-0x1df;const _0xc7f05e=a4_0xc7f0();let _0x537f17=_0xc7f05e[_0x379a10];return _0x537f17;}var __createBinding=this&&this['__createBinding']||(Object[a4_0x1d3833(0x1df)]?function(_0x2aa25e,_0x497552,_0x4c81d9,_0x34f044){const _0x4b77fd=a4_0x1d3833;if(_0x34f044===undefined)_0x34f044=_0x4c81d9;var _0x4bcb57=Object[_0x4b77fd(0x1e1)](_0x497552,_0x4c81d9);(!_0x4bcb57||(_0x4b77fd(0x1e9)in _0x4bcb57?!_0x497552[_0x4b77fd(0x1f9)]:_0x4bcb57['writable']||_0x4bcb57['configurable']))&&(_0x4bcb57={'enumerable':!![],'get':function(){return _0x497552[_0x4c81d9];}}),Object['defineProperty'](_0x2aa25e,_0x34f044,_0x4bcb57);}:function(_0x233b77,_0xcada8,_0x30b7f5,_0x2828aa){if(_0x2828aa===undefined)_0x2828aa=_0x30b7f5;_0x233b77[_0x2828aa]=_0xcada8[_0x30b7f5];}),__setModuleDefault=this&&this[a4_0x1d3833(0x209)]||(Object['create']?function(_0x28e937,_0x3862bb){const _0x4d43ba=a4_0x1d3833;Object[_0x4d43ba(0x1fd)](_0x28e937,_0x4d43ba(0x1f8),{'enumerable':!![],'value':_0x3862bb});}:function(_0x145345,_0x75ab54){const _0x49a706=a4_0x1d3833;_0x145345[_0x49a706(0x1f8)]=_0x75ab54;}),__importStar=this&&this[a4_0x1d3833(0x202)]||(function(){var _0x3d6817=function(_0x4b099b){return _0x3d6817=Object['getOwnPropertyNames']||function(_0x5ddc09){const _0x560a65=a4_0x537f;var _0x3b7870=[];for(var _0x27cbb5 in _0x5ddc09)if(Object[_0x560a65(0x20a)][_0x560a65(0x1e4)][_0x560a65(0x1e2)](_0x5ddc09,_0x27cbb5))_0x3b7870[_0x3b7870[_0x560a65(0x1f5)]]=_0x27cbb5;return _0x3b7870;},_0x3d6817(_0x4b099b);};return function(_0x33ea49){const _0x46b44f=a4_0x537f;if(_0x33ea49&&_0x33ea49[_0x46b44f(0x1f9)])return _0x33ea49;var _0x47d5b4={};if(_0x33ea49!=null){for(var _0x402b72=_0x3d6817(_0x33ea49),_0x38477b=0x0;_0x38477b<_0x402b72['length'];_0x38477b++)if(_0x402b72[_0x38477b]!=='default')__createBinding(_0x47d5b4,_0x33ea49,_0x402b72[_0x38477b]);}return __setModuleDefault(_0x47d5b4,_0x33ea49),_0x47d5b4;};}());Object['defineProperty'](exports,a4_0x1d3833(0x1f9),{'value':!![]}),exports['AuthController']=void 0x0;const authService_1=require(a4_0x1d3833(0x1e5)),tokenBlacklistService_1=require('../services/tokenBlacklistService'),telegramBotService_1=require(a4_0x1d3833(0x1fa));class AuthController{constructor(){const _0x3ac5f6=a4_0x1d3833;this[_0x3ac5f6(0x20d)]=async(_0x5d5064,_0x44a89b,_0x57c330)=>{const _0x287e4e=_0x3ac5f6;try{const _0x4b195e=_0x5d5064[_0x287e4e(0x1fb)],_0x17ae42=_0x4b195e[_0x287e4e(0x1f1)]||_0x5d5064['ip']||_0x5d5064['connection'][_0x287e4e(0x208)]||_0x287e4e(0x1f4),_0x223fcb=_0x4b195e[_0x287e4e(0x1eb)]||_0x5d5064[_0x287e4e(0x1e9)]('User-Agent')||'unknown',_0x43528f=_0x4b195e['geo'];let _0x3dd6e9=![],_0x1e395b=null;try{const _0x5285c6=await this[_0x287e4e(0x1ff)][_0x287e4e(0x20d)](_0x4b195e);_0x3dd6e9=!![],_0x5285c6[_0x287e4e(0x1fc)]===_0x287e4e(0x1e8)&&_0x5285c6[_0x287e4e(0x1ec)]?.['id']&&(_0x1e395b=_0x5285c6[_0x287e4e(0x1ec)]['id']),_0x1e395b&&await telegramBotService_1['telegramBotService'][_0x287e4e(0x1ee)](_0x1e395b,{'username':_0x4b195e['username'],'ipAddress':_0x17ae42,'userAgent':_0x223fcb,'geo':_0x43528f,'timestamp':new Date(),'success':!![]}),_0x44a89b[_0x287e4e(0x20b)]({'success':!![],'result':_0x5285c6});}catch(_0x397951){try{const _0x38cd79=(await Promise['resolve']()['then'](()=>__importStar(require(_0x287e4e(0x205)))))[_0x287e4e(0x1f8)],_0x463f09=await _0x38cd79['shop'][_0x287e4e(0x204)]({'where':{'username':_0x4b195e[_0x287e4e(0x1f2)]},'select':{'id':!![]}});_0x463f09&&await telegramBotService_1['telegramBotService']['sendLoginNotification'](_0x463f09['id'],{'username':_0x4b195e[_0x287e4e(0x1f2)],'ipAddress':_0x17ae42,'userAgent':_0x223fcb,'geo':_0x43528f,'timestamp':new Date(),'success':![]});}catch(_0x59f366){console['error'](_0x287e4e(0x1f7),_0x59f366);}throw _0x397951;}}catch(_0x116fd9){_0x57c330(_0x116fd9);}},this['me']=async(_0x56f87c,_0x2a5b8a,_0x3505d1)=>{const _0x247fc8=_0x3ac5f6;try{const _0x157b04=_0x56f87c[_0x247fc8(0x1ec)];_0x2a5b8a[_0x247fc8(0x20b)]({'success':!![],'result':{'id':_0x157b04?.['id'],'username':_0x157b04?.[_0x247fc8(0x1f2)],'role':_0x157b04?.[_0x247fc8(0x1fc)]}});}catch(_0x7f60d6){_0x3505d1(_0x7f60d6);}},this[_0x3ac5f6(0x1e7)]=async(_0x116b43,_0xf04511,_0x3951b8)=>{const _0x338c30=_0x3ac5f6;try{const _0x1ddad6=_0x116b43['token'],_0x3ddf56=_0x116b43[_0x338c30(0x1ec)];_0x1ddad6&&_0x3ddf56?.['exp']&&tokenBlacklistService_1[_0x338c30(0x1ea)][_0x338c30(0x207)](_0x1ddad6,_0x3ddf56[_0x338c30(0x1ef)]),_0xf04511[_0x338c30(0x20b)]({'success':!![],'message':'Logged\x20out\x20successfully'});}catch(_0x125000){_0x3951b8(_0x125000);}},this[_0x3ac5f6(0x1f0)]=async(_0x17d811,_0x5ecc6d,_0x502a61)=>{const _0x13bfa0=_0x3ac5f6;try{const _0x531771=tokenBlacklistService_1[_0x13bfa0(0x1ea)][_0x13bfa0(0x1fe)]();_0x5ecc6d[_0x13bfa0(0x20b)]({'success':!![],'result':_0x531771});}catch(_0x4a74cf){_0x502a61(_0x4a74cf);}},this['authService']=new authService_1[(_0x3ac5f6(0x206))]();}}exports['AuthController']=AuthController;