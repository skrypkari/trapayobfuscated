'use strict';const a4_0x16b3de=a4_0x3653;(function(_0x5ded5a,_0x38d56e){const _0x373d31=a4_0x3653,_0x355db5=_0x5ded5a();while(!![]){try{const _0x19a941=-parseInt(_0x373d31(0x90))/0x1+-parseInt(_0x373d31(0x87))/0x2*(-parseInt(_0x373d31(0x70))/0x3)+parseInt(_0x373d31(0x8b))/0x4*(parseInt(_0x373d31(0x7f))/0x5)+-parseInt(_0x373d31(0x84))/0x6+parseInt(_0x373d31(0x89))/0x7*(-parseInt(_0x373d31(0x77))/0x8)+parseInt(_0x373d31(0x7b))/0x9+-parseInt(_0x373d31(0x74))/0xa;if(_0x19a941===_0x38d56e)break;else _0x355db5['push'](_0x355db5['shift']());}catch(_0x4ead08){_0x355db5['push'](_0x355db5['shift']());}}}(a4_0x5652,0xdc379));function a4_0x3653(_0x9578bc,_0x1c0cb6){const _0x5652d8=a4_0x5652();return a4_0x3653=function(_0x365349,_0x4a52f4){_0x365349=_0x365349-0x6f;let _0x42ba66=_0x5652d8[_0x365349];return _0x42ba66;},a4_0x3653(_0x9578bc,_0x1c0cb6);}var __createBinding=this&&this['__createBinding']||(Object[a4_0x16b3de(0x7a)]?function(_0x47889e,_0x35a9d8,_0x17cd4f,_0x14606e){const _0x59ec88=a4_0x16b3de;if(_0x14606e===undefined)_0x14606e=_0x17cd4f;var _0x553728=Object[_0x59ec88(0x7c)](_0x35a9d8,_0x17cd4f);(!_0x553728||('get'in _0x553728?!_0x35a9d8[_0x59ec88(0x93)]:_0x553728['writable']||_0x553728[_0x59ec88(0x82)]))&&(_0x553728={'enumerable':!![],'get':function(){return _0x35a9d8[_0x17cd4f];}}),Object['defineProperty'](_0x47889e,_0x14606e,_0x553728);}:function(_0x339da5,_0x50dba2,_0xbb7d4a,_0x1c96b9){if(_0x1c96b9===undefined)_0x1c96b9=_0xbb7d4a;_0x339da5[_0x1c96b9]=_0x50dba2[_0xbb7d4a];}),__setModuleDefault=this&&this[a4_0x16b3de(0x86)]||(Object['create']?function(_0x3e6a8d,_0x2c5f43){Object['defineProperty'](_0x3e6a8d,'default',{'enumerable':!![],'value':_0x2c5f43});}:function(_0x1df947,_0x5d48cc){const _0x514253=a4_0x16b3de;_0x1df947[_0x514253(0x91)]=_0x5d48cc;}),__importStar=this&&this[a4_0x16b3de(0x97)]||(function(){var _0x33733c=function(_0x4e62bd){const _0xdef423=a4_0x3653;return _0x33733c=Object[_0xdef423(0x98)]||function(_0x1bbf9a){const _0x444fbe=_0xdef423;var _0x5366e2=[];for(var _0x290965 in _0x1bbf9a)if(Object[_0x444fbe(0x8c)][_0x444fbe(0x79)][_0x444fbe(0x72)](_0x1bbf9a,_0x290965))_0x5366e2[_0x5366e2[_0x444fbe(0x80)]]=_0x290965;return _0x5366e2;},_0x33733c(_0x4e62bd);};return function(_0x5d21f0){const _0x280c42=a4_0x3653;if(_0x5d21f0&&_0x5d21f0[_0x280c42(0x93)])return _0x5d21f0;var _0x26807d={};if(_0x5d21f0!=null){for(var _0x5e8e5f=_0x33733c(_0x5d21f0),_0x5088b2=0x0;_0x5088b2<_0x5e8e5f[_0x280c42(0x80)];_0x5088b2++)if(_0x5e8e5f[_0x5088b2]!==_0x280c42(0x91))__createBinding(_0x26807d,_0x5d21f0,_0x5e8e5f[_0x5088b2]);}return __setModuleDefault(_0x26807d,_0x5d21f0),_0x26807d;};}());Object['defineProperty'](exports,a4_0x16b3de(0x93),{'value':!![]}),exports['AuthController']=void 0x0;const authService_1=require(a4_0x16b3de(0x96)),tokenBlacklistService_1=require('../services/tokenBlacklistService'),telegramBotService_1=require(a4_0x16b3de(0x92));class AuthController{constructor(){const _0x30f437=a4_0x16b3de;this[_0x30f437(0x9c)]=async(_0x169756,_0x26902e,_0x457a3a)=>{const _0x1908ee=_0x30f437;try{const _0x5e2027=_0x169756['body'],_0x276315=_0x169756['ip']||_0x169756[_0x1908ee(0x7d)]['remoteAddress']||_0x1908ee(0x76),_0x556a8f=_0x169756['get'](_0x1908ee(0x73))||'unknown';let _0x247835=![],_0x3f41f1=null;try{const _0x30ec5e=await this[_0x1908ee(0x94)]['login'](_0x5e2027);_0x247835=!![],_0x30ec5e[_0x1908ee(0x99)]==='shop'&&_0x30ec5e[_0x1908ee(0x6f)]?.['id']&&(_0x3f41f1=_0x30ec5e[_0x1908ee(0x6f)]['id']),_0x3f41f1&&await telegramBotService_1[_0x1908ee(0x83)][_0x1908ee(0x95)](_0x3f41f1,{'username':_0x5e2027[_0x1908ee(0x9a)],'ipAddress':_0x276315,'userAgent':_0x556a8f,'timestamp':new Date(),'success':!![]}),_0x26902e[_0x1908ee(0x8d)]({'success':!![],'result':_0x30ec5e});}catch(_0x4d15a3){try{const _0x2fae69=(await Promise['resolve']()[_0x1908ee(0x8e)](()=>__importStar(require(_0x1908ee(0x78)))))[_0x1908ee(0x91)],_0x428b29=await _0x2fae69[_0x1908ee(0x8f)]['findUnique']({'where':{'username':_0x5e2027[_0x1908ee(0x9a)]},'select':{'id':!![]}});_0x428b29&&await telegramBotService_1[_0x1908ee(0x83)][_0x1908ee(0x95)](_0x428b29['id'],{'username':_0x5e2027[_0x1908ee(0x9a)],'ipAddress':_0x276315,'userAgent':_0x556a8f,'timestamp':new Date(),'success':![]});}catch(_0x2c1236){console[_0x1908ee(0x71)](_0x1908ee(0x8a),_0x2c1236);}throw _0x4d15a3;}}catch(_0x1c9c5e){_0x457a3a(_0x1c9c5e);}},this['me']=async(_0x4df1d3,_0x12bcd0,_0xbe6c48)=>{const _0x1cb6ae=_0x30f437;try{const _0x5bd7b0=_0x4df1d3['user'];_0x12bcd0[_0x1cb6ae(0x8d)]({'success':!![],'result':{'id':_0x5bd7b0?.['id'],'username':_0x5bd7b0?.[_0x1cb6ae(0x9a)],'role':_0x5bd7b0?.[_0x1cb6ae(0x99)]}});}catch(_0x558941){_0xbe6c48(_0x558941);}},this[_0x30f437(0x85)]=async(_0x40dbec,_0x5a0a17,_0x1c82c7)=>{const _0x47f365=_0x30f437;try{const _0x5acda4=_0x40dbec['token'],_0x1ffcd9=_0x40dbec['user'];_0x5acda4&&_0x1ffcd9?.['exp']&&tokenBlacklistService_1[_0x47f365(0x9b)][_0x47f365(0x88)](_0x5acda4,_0x1ffcd9[_0x47f365(0x75)]),_0x5a0a17['json']({'success':!![],'message':'Logged\x20out\x20successfully'});}catch(_0x36ea3a){_0x1c82c7(_0x36ea3a);}},this[_0x30f437(0x81)]=async(_0x3ea7a6,_0x47e960,_0x390829)=>{const _0x28b015=_0x30f437;try{const _0x13bf4b=tokenBlacklistService_1['tokenBlacklistService']['getStats']();_0x47e960[_0x28b015(0x8d)]({'success':!![],'result':_0x13bf4b});}catch(_0x29a03e){_0x390829(_0x29a03e);}},this[_0x30f437(0x94)]=new authService_1['AuthService']();}}exports[a4_0x16b3de(0x7e)]=AuthController;function a4_0x5652(){const _0x1f54c6=['getBlacklistStats','configurable','telegramBotService','3088524UIEEuC','logout','__setModuleDefault','41542kpGsCu','blacklistToken','1596413Ucwwtr','Failed\x20to\x20send\x20failed\x20login\x20notification:','10764MambUG','prototype','json','then','shop','1220122vNxIta','default','../services/telegramBotService','__esModule','authService','sendLoginNotification','../services/authService','__importStar','getOwnPropertyNames','role','username','tokenBlacklistService','login','user','219SboCAH','error','call','User-Agent','5891090BhJucB','exp','unknown','32IYJmWk','../config/database','hasOwnProperty','create','8073144NTPyhn','getOwnPropertyDescriptor','connection','AuthController','3205xGQjMJ','length'];a4_0x5652=function(){return _0x1f54c6;};return a4_0x5652();}