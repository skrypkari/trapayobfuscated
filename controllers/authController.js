'use strict';const a4_0x5ce1b4=a4_0x43c7;(function(_0x19309a,_0x29b26f){const _0x4921ac=a4_0x43c7,_0x11ae44=_0x19309a();while(!![]){try{const _0x8b67c3=-parseInt(_0x4921ac(0xfb))/0x1+parseInt(_0x4921ac(0xed))/0x2*(-parseInt(_0x4921ac(0xe6))/0x3)+parseInt(_0x4921ac(0xfd))/0x4*(parseInt(_0x4921ac(0xfa))/0x5)+-parseInt(_0x4921ac(0xdb))/0x6*(parseInt(_0x4921ac(0xd5))/0x7)+parseInt(_0x4921ac(0xdc))/0x8+-parseInt(_0x4921ac(0xcb))/0x9*(parseInt(_0x4921ac(0xda))/0xa)+parseInt(_0x4921ac(0xee))/0xb;if(_0x8b67c3===_0x29b26f)break;else _0x11ae44['push'](_0x11ae44['shift']());}catch(_0x5a7882){_0x11ae44['push'](_0x11ae44['shift']());}}}(a4_0x4689,0xda891));var __createBinding=this&&this[a4_0x5ce1b4(0xd7)]||(Object['create']?function(_0x3c0c89,_0x9bb07,_0x375698,_0x590a68){const _0x173825=a4_0x5ce1b4;if(_0x590a68===undefined)_0x590a68=_0x375698;var _0x5c1abb=Object[_0x173825(0xd8)](_0x9bb07,_0x375698);(!_0x5c1abb||(_0x173825(0xf3)in _0x5c1abb?!_0x9bb07['__esModule']:_0x5c1abb[_0x173825(0xf2)]||_0x5c1abb[_0x173825(0xf7)]))&&(_0x5c1abb={'enumerable':!![],'get':function(){return _0x9bb07[_0x375698];}}),Object[_0x173825(0xd9)](_0x3c0c89,_0x590a68,_0x5c1abb);}:function(_0x3e2c6d,_0x2e29f7,_0x3fe790,_0x5af9c5){if(_0x5af9c5===undefined)_0x5af9c5=_0x3fe790;_0x3e2c6d[_0x5af9c5]=_0x2e29f7[_0x3fe790];}),__setModuleDefault=this&&this[a4_0x5ce1b4(0xca)]||(Object[a4_0x5ce1b4(0xe7)]?function(_0x583030,_0x51f5a7){const _0x6d595d=a4_0x5ce1b4;Object[_0x6d595d(0xd9)](_0x583030,_0x6d595d(0xdd),{'enumerable':!![],'value':_0x51f5a7});}:function(_0x246fc1,_0x5816e4){const _0xeadc58=a4_0x5ce1b4;_0x246fc1[_0xeadc58(0xdd)]=_0x5816e4;}),__importStar=this&&this[a4_0x5ce1b4(0xd4)]||(function(){var _0x12a9f6=function(_0x361c10){const _0x2dc148=a4_0x43c7;return _0x12a9f6=Object[_0x2dc148(0xe0)]||function(_0xa75b2d){const _0x13fabb=_0x2dc148;var _0x19aa70=[];for(var _0x2f45bd in _0xa75b2d)if(Object['prototype'][_0x13fabb(0xfc)][_0x13fabb(0xe4)](_0xa75b2d,_0x2f45bd))_0x19aa70[_0x19aa70[_0x13fabb(0xcc)]]=_0x2f45bd;return _0x19aa70;},_0x12a9f6(_0x361c10);};return function(_0x4a6969){const _0x5762fa=a4_0x43c7;if(_0x4a6969&&_0x4a6969['__esModule'])return _0x4a6969;var _0x373922={};if(_0x4a6969!=null){for(var _0x103ecd=_0x12a9f6(_0x4a6969),_0x386cc5=0x0;_0x386cc5<_0x103ecd['length'];_0x386cc5++)if(_0x103ecd[_0x386cc5]!==_0x5762fa(0xdd))__createBinding(_0x373922,_0x4a6969,_0x103ecd[_0x386cc5]);}return __setModuleDefault(_0x373922,_0x4a6969),_0x373922;};}());function a4_0x4689(){const _0x261e13=['getStats','getBlacklistStats','sendLoginNotification','configurable','userAgent','exp','7379585KfViaO','1702271nWUXWG','hasOwnProperty','4zXKsxD','authService','__esModule','__setModuleDefault','10782IaxJOe','length','json','role','username','unknown','Failed\x20to\x20send\x20failed\x20login\x20notification:','body','User-Agent','__importStar','315MkUjPz','../services/telegramBotService','__createBinding','getOwnPropertyDescriptor','defineProperty','1340CiVgqT','144750BGgOZd','7667704BmSLUD','default','AuthService','../services/authService','getOwnPropertyNames','blacklistToken','shop','user','call','remoteAddress','75RQMXpY','create','login','AuthController','then','telegramBotService','error','20506EUMaRo','18320434aVUkHF','../services/tokenBlacklistService','logout','tokenBlacklistService','writable','get'];a4_0x4689=function(){return _0x261e13;};return a4_0x4689();}function a4_0x43c7(_0x33e90d,_0x68290f){_0x33e90d=_0x33e90d-0xc8;const _0x468968=a4_0x4689();let _0x43c718=_0x468968[_0x33e90d];return _0x43c718;}Object[a4_0x5ce1b4(0xd9)](exports,a4_0x5ce1b4(0xc9),{'value':!![]}),exports[a4_0x5ce1b4(0xe9)]=void 0x0;const authService_1=require(a4_0x5ce1b4(0xdf)),tokenBlacklistService_1=require(a4_0x5ce1b4(0xef)),telegramBotService_1=require(a4_0x5ce1b4(0xd6));class AuthController{constructor(){const _0xcae8db=a4_0x5ce1b4;this[_0xcae8db(0xe8)]=async(_0x51da93,_0x95709f,_0x9a00b)=>{const _0x5cb1fe=_0xcae8db;try{const _0x8ce408=_0x51da93[_0x5cb1fe(0xd2)],_0x417109=_0x8ce408['ipAddress']||_0x51da93['ip']||_0x51da93['connection'][_0x5cb1fe(0xe5)]||_0x5cb1fe(0xd0),_0xe75148=_0x8ce408[_0x5cb1fe(0xf8)]||_0x51da93['get'](_0x5cb1fe(0xd3))||_0x5cb1fe(0xd0),_0x1d2e5f=_0x8ce408['geo'];let _0x3ce2ef=![],_0x44b768=null;try{const _0x2a5922=await this['authService'][_0x5cb1fe(0xe8)](_0x8ce408);_0x3ce2ef=!![],_0x2a5922['role']==='shop'&&_0x2a5922[_0x5cb1fe(0xe3)]?.['id']&&(_0x44b768=_0x2a5922['user']['id']),_0x44b768&&await telegramBotService_1[_0x5cb1fe(0xeb)][_0x5cb1fe(0xf6)](_0x44b768,{'username':_0x8ce408[_0x5cb1fe(0xcf)],'ipAddress':_0x417109,'userAgent':_0xe75148,'geo':_0x1d2e5f,'timestamp':new Date(),'success':!![]}),_0x95709f[_0x5cb1fe(0xcd)]({'success':!![],'result':_0x2a5922});}catch(_0x2b1da2){try{const _0x3b322b=(await Promise['resolve']()[_0x5cb1fe(0xea)](()=>__importStar(require('../config/database'))))['default'],_0x201da5=await _0x3b322b[_0x5cb1fe(0xe2)]['findUnique']({'where':{'username':_0x8ce408[_0x5cb1fe(0xcf)]},'select':{'id':!![]}});_0x201da5&&await telegramBotService_1[_0x5cb1fe(0xeb)][_0x5cb1fe(0xf6)](_0x201da5['id'],{'username':_0x8ce408[_0x5cb1fe(0xcf)],'ipAddress':_0x417109,'userAgent':_0xe75148,'geo':_0x1d2e5f,'timestamp':new Date(),'success':![]});}catch(_0x5e54bc){console[_0x5cb1fe(0xec)](_0x5cb1fe(0xd1),_0x5e54bc);}throw _0x2b1da2;}}catch(_0xd76e1){_0x9a00b(_0xd76e1);}},this['me']=async(_0x4764c3,_0x418b88,_0x1675e4)=>{const _0x346295=_0xcae8db;try{const _0x4701bd=_0x4764c3[_0x346295(0xe3)];_0x418b88[_0x346295(0xcd)]({'success':!![],'result':{'id':_0x4701bd?.['id'],'username':_0x4701bd?.['username'],'role':_0x4701bd?.[_0x346295(0xce)]}});}catch(_0x27d972){_0x1675e4(_0x27d972);}},this[_0xcae8db(0xf0)]=async(_0x31282c,_0xea7d50,_0x192e2b)=>{const _0x114e24=_0xcae8db;try{const _0x558a55=_0x31282c['token'],_0x537f4a=_0x31282c[_0x114e24(0xe3)];_0x558a55&&_0x537f4a?.['exp']&&tokenBlacklistService_1[_0x114e24(0xf1)][_0x114e24(0xe1)](_0x558a55,_0x537f4a[_0x114e24(0xf9)]),_0xea7d50['json']({'success':!![],'message':'Logged\x20out\x20successfully'});}catch(_0x201c56){_0x192e2b(_0x201c56);}},this[_0xcae8db(0xf5)]=async(_0x384263,_0x2fdf67,_0x40c987)=>{const _0x2c6ad0=_0xcae8db;try{const _0x2e4970=tokenBlacklistService_1['tokenBlacklistService'][_0x2c6ad0(0xf4)]();_0x2fdf67[_0x2c6ad0(0xcd)]({'success':!![],'result':_0x2e4970});}catch(_0x49df25){_0x40c987(_0x49df25);}},this[_0xcae8db(0xc8)]=new authService_1[(_0xcae8db(0xde))]();}}exports['AuthController']=AuthController;