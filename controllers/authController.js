'use strict';const a4_0x3258eb=a4_0x8f47;(function(_0x30c09c,_0x456fee){const _0x4383de=a4_0x8f47,_0x2fab52=_0x30c09c();while(!![]){try{const _0x121d35=-parseInt(_0x4383de(0x166))/0x1*(parseInt(_0x4383de(0x146))/0x2)+parseInt(_0x4383de(0x167))/0x3+-parseInt(_0x4383de(0x155))/0x4+-parseInt(_0x4383de(0x159))/0x5+parseInt(_0x4383de(0x162))/0x6+-parseInt(_0x4383de(0x14f))/0x7*(parseInt(_0x4383de(0x147))/0x8)+parseInt(_0x4383de(0x141))/0x9;if(_0x121d35===_0x456fee)break;else _0x2fab52['push'](_0x2fab52['shift']());}catch(_0x2d2527){_0x2fab52['push'](_0x2fab52['shift']());}}}(a4_0x1dac,0xaaec9));var __createBinding=this&&this[a4_0x3258eb(0x160)]||(Object[a4_0x3258eb(0x163)]?function(_0x1669d5,_0x20b55c,_0x35b0f3,_0x4ee20c){const _0x28b821=a4_0x3258eb;if(_0x4ee20c===undefined)_0x4ee20c=_0x35b0f3;var _0x21a086=Object['getOwnPropertyDescriptor'](_0x20b55c,_0x35b0f3);(!_0x21a086||(_0x28b821(0x15b)in _0x21a086?!_0x20b55c['__esModule']:_0x21a086['writable']||_0x21a086[_0x28b821(0x14a)]))&&(_0x21a086={'enumerable':!![],'get':function(){return _0x20b55c[_0x35b0f3];}}),Object[_0x28b821(0x14e)](_0x1669d5,_0x4ee20c,_0x21a086);}:function(_0x3c4d18,_0x12272f,_0xc79b8e,_0x547879){if(_0x547879===undefined)_0x547879=_0xc79b8e;_0x3c4d18[_0x547879]=_0x12272f[_0xc79b8e];}),__setModuleDefault=this&&this['__setModuleDefault']||(Object[a4_0x3258eb(0x163)]?function(_0x3e8b1e,_0x4cd463){const _0x2d9ceb=a4_0x3258eb;Object[_0x2d9ceb(0x14e)](_0x3e8b1e,'default',{'enumerable':!![],'value':_0x4cd463});}:function(_0x2d1879,_0x785300){const _0x54c1de=a4_0x3258eb;_0x2d1879[_0x54c1de(0x158)]=_0x785300;}),__importStar=this&&this[a4_0x3258eb(0x156)]||(function(){var _0x3fb134=function(_0x362d5b){return _0x3fb134=Object['getOwnPropertyNames']||function(_0x5b4b62){const _0x5f2dbc=a4_0x8f47;var _0x5e9faf=[];for(var _0x2f0c3f in _0x5b4b62)if(Object[_0x5f2dbc(0x154)]['hasOwnProperty']['call'](_0x5b4b62,_0x2f0c3f))_0x5e9faf[_0x5e9faf['length']]=_0x2f0c3f;return _0x5e9faf;},_0x3fb134(_0x362d5b);};return function(_0x69e0d2){const _0x4df251=a4_0x8f47;if(_0x69e0d2&&_0x69e0d2[_0x4df251(0x16a)])return _0x69e0d2;var _0x23d0d6={};if(_0x69e0d2!=null){for(var _0xd0c86=_0x3fb134(_0x69e0d2),_0x4d4290=0x0;_0x4d4290<_0xd0c86[_0x4df251(0x153)];_0x4d4290++)if(_0xd0c86[_0x4d4290]!==_0x4df251(0x158))__createBinding(_0x23d0d6,_0x69e0d2,_0xd0c86[_0x4d4290]);}return __setModuleDefault(_0x23d0d6,_0x69e0d2),_0x23d0d6;};}());Object[a4_0x3258eb(0x14e)](exports,a4_0x3258eb(0x16a),{'value':!![]}),exports['AuthController']=void 0x0;const authService_1=require(a4_0x3258eb(0x150)),tokenBlacklistService_1=require('../services/tokenBlacklistService'),telegramBotService_1=require(a4_0x3258eb(0x151));class AuthController{constructor(){const _0x127100=a4_0x3258eb;this[_0x127100(0x152)]=async(_0x559254,_0x2cd81f,_0x3d256b)=>{const _0x830c42=_0x127100;try{const _0x534c4d=_0x559254[_0x830c42(0x148)],_0xdbd20f=_0x559254['ip']||_0x559254[_0x830c42(0x165)][_0x830c42(0x164)]||_0x830c42(0x149),_0x541cbf=_0x559254[_0x830c42(0x15b)]('User-Agent')||_0x830c42(0x149);let _0x5c4106=![],_0x25ecb5=null;try{const _0x52f441=await this[_0x830c42(0x168)][_0x830c42(0x152)](_0x534c4d);_0x5c4106=!![],_0x52f441['role']==='shop'&&_0x52f441[_0x830c42(0x143)]?.['id']&&(_0x25ecb5=_0x52f441[_0x830c42(0x143)]['id']),_0x25ecb5&&await telegramBotService_1[_0x830c42(0x157)][_0x830c42(0x169)](_0x25ecb5,{'username':_0x534c4d[_0x830c42(0x16c)],'ipAddress':_0xdbd20f,'userAgent':_0x541cbf,'timestamp':new Date(),'success':!![]}),_0x2cd81f['json']({'success':!![],'result':_0x52f441});}catch(_0xc8f64d){try{const _0x40af32=(await Promise[_0x830c42(0x14d)]()['then'](()=>__importStar(require('../config/database'))))[_0x830c42(0x158)],_0x578470=await _0x40af32[_0x830c42(0x15d)]['findUnique']({'where':{'username':_0x534c4d[_0x830c42(0x16c)]},'select':{'id':!![]}});_0x578470&&await telegramBotService_1[_0x830c42(0x157)]['sendLoginNotification'](_0x578470['id'],{'username':_0x534c4d['username'],'ipAddress':_0xdbd20f,'userAgent':_0x541cbf,'timestamp':new Date(),'success':![]});}catch(_0x574ad3){console[_0x830c42(0x144)](_0x830c42(0x15c),_0x574ad3);}throw _0xc8f64d;}}catch(_0x2cb870){_0x3d256b(_0x2cb870);}},this['me']=async(_0x3be330,_0x168305,_0x1f2099)=>{const _0x49d5ea=_0x127100;try{const _0x4b413a=_0x3be330['user'];_0x168305[_0x49d5ea(0x16b)]({'success':!![],'result':{'id':_0x4b413a?.['id'],'username':_0x4b413a?.['username'],'role':_0x4b413a?.[_0x49d5ea(0x14c)]}});}catch(_0xe8c197){_0x1f2099(_0xe8c197);}},this['logout']=async(_0x363003,_0x552c67,_0x1aa94b)=>{const _0x3de4fb=_0x127100;try{const _0x4637fd=_0x363003[_0x3de4fb(0x161)],_0x4670f1=_0x363003[_0x3de4fb(0x143)];_0x4637fd&&_0x4670f1?.[_0x3de4fb(0x15a)]&&tokenBlacklistService_1[_0x3de4fb(0x15e)]['blacklistToken'](_0x4637fd,_0x4670f1['exp']),_0x552c67[_0x3de4fb(0x16b)]({'success':!![],'message':_0x3de4fb(0x142)});}catch(_0x23c570){_0x1aa94b(_0x23c570);}},this[_0x127100(0x15f)]=async(_0x346f1c,_0x3f8dd4,_0x5b24a2)=>{const _0x38cc36=_0x127100;try{const _0x2b1e18=tokenBlacklistService_1[_0x38cc36(0x15e)][_0x38cc36(0x14b)]();_0x3f8dd4[_0x38cc36(0x16b)]({'success':!![],'result':_0x2b1e18});}catch(_0x58de40){_0x5b24a2(_0x58de40);}},this[_0x127100(0x168)]=new authService_1['AuthService']();}}function a4_0x8f47(_0x2ad744,_0x383bf1){const _0x1dacf5=a4_0x1dac();return a4_0x8f47=function(_0x8f47a,_0xb2c9a6){_0x8f47a=_0x8f47a-0x141;let _0x585bda=_0x1dacf5[_0x8f47a];return _0x585bda;},a4_0x8f47(_0x2ad744,_0x383bf1);}exports[a4_0x3258eb(0x145)]=AuthController;function a4_0x1dac(){const _0x26c95c=['resolve','defineProperty','63vpmusP','../services/authService','../services/telegramBotService','login','length','prototype','1431620UvcCWl','__importStar','telegramBotService','default','4856385KRQKLH','exp','get','Failed\x20to\x20send\x20failed\x20login\x20notification:','shop','tokenBlacklistService','getBlacklistStats','__createBinding','token','7299984ViMSad','create','remoteAddress','connection','219683iSmINu','2365254GYBATw','authService','sendLoginNotification','__esModule','json','username','15934446fuwKot','Logged\x20out\x20successfully','user','error','AuthController','10CDTPoE','575888DgJWJI','body','unknown','configurable','getStats','role'];a4_0x1dac=function(){return _0x26c95c;};return a4_0x1dac();}