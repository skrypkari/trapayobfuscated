'use strict';const a4_0x1ca290=a4_0xad7d;(function(_0x2e7fbe,_0xbeb3d5){const _0x13ffd9=a4_0xad7d,_0x1d2937=_0x2e7fbe();while(!![]){try{const _0x36f1f3=-parseInt(_0x13ffd9(0x96))/0x1*(parseInt(_0x13ffd9(0xa5))/0x2)+-parseInt(_0x13ffd9(0x99))/0x3+-parseInt(_0x13ffd9(0xab))/0x4*(parseInt(_0x13ffd9(0x9f))/0x5)+-parseInt(_0x13ffd9(0xa8))/0x6*(-parseInt(_0x13ffd9(0x95))/0x7)+-parseInt(_0x13ffd9(0xb9))/0x8*(-parseInt(_0x13ffd9(0x8d))/0x9)+-parseInt(_0x13ffd9(0xb8))/0xa+-parseInt(_0x13ffd9(0xa4))/0xb*(-parseInt(_0x13ffd9(0xaa))/0xc);if(_0x36f1f3===_0xbeb3d5)break;else _0x1d2937['push'](_0x1d2937['shift']());}catch(_0x34a5c7){_0x1d2937['push'](_0x1d2937['shift']());}}}(a4_0x3750,0xad4c3));var __createBinding=this&&this[a4_0x1ca290(0x8e)]||(Object[a4_0x1ca290(0x94)]?function(_0x5a96cd,_0x264ebf,_0x3c561c,_0x24a104){const _0x301eb6=a4_0x1ca290;if(_0x24a104===undefined)_0x24a104=_0x3c561c;var _0x1af759=Object[_0x301eb6(0xb2)](_0x264ebf,_0x3c561c);(!_0x1af759||(_0x301eb6(0xa2)in _0x1af759?!_0x264ebf[_0x301eb6(0xb7)]:_0x1af759[_0x301eb6(0xa1)]||_0x1af759[_0x301eb6(0x93)]))&&(_0x1af759={'enumerable':!![],'get':function(){return _0x264ebf[_0x3c561c];}}),Object[_0x301eb6(0xb5)](_0x5a96cd,_0x24a104,_0x1af759);}:function(_0xc7d8d5,_0x2d6e0e,_0x2152ba,_0x37f822){if(_0x37f822===undefined)_0x37f822=_0x2152ba;_0xc7d8d5[_0x37f822]=_0x2d6e0e[_0x2152ba];}),__setModuleDefault=this&&this['__setModuleDefault']||(Object[a4_0x1ca290(0x94)]?function(_0x242b30,_0x4905b9){const _0x4dfd36=a4_0x1ca290;Object[_0x4dfd36(0xb5)](_0x242b30,_0x4dfd36(0xac),{'enumerable':!![],'value':_0x4905b9});}:function(_0x1f7f92,_0xe950ea){const _0xb46d6b=a4_0x1ca290;_0x1f7f92[_0xb46d6b(0xac)]=_0xe950ea;}),__importStar=this&&this[a4_0x1ca290(0xb1)]||(function(){var _0x404421=function(_0x2d6202){const _0xaaaa88=a4_0xad7d;return _0x404421=Object[_0xaaaa88(0xad)]||function(_0x3aec6a){const _0x33abfa=_0xaaaa88;var _0xc1aa8a=[];for(var _0x460ee9 in _0x3aec6a)if(Object[_0x33abfa(0xae)][_0x33abfa(0x88)]['call'](_0x3aec6a,_0x460ee9))_0xc1aa8a[_0xc1aa8a[_0x33abfa(0x8b)]]=_0x460ee9;return _0xc1aa8a;},_0x404421(_0x2d6202);};return function(_0x66377d){const _0x18aa49=a4_0xad7d;if(_0x66377d&&_0x66377d[_0x18aa49(0xb7)])return _0x66377d;var _0x534e55={};if(_0x66377d!=null){for(var _0x246135=_0x404421(_0x66377d),_0x13deca=0x0;_0x13deca<_0x246135[_0x18aa49(0x8b)];_0x13deca++)if(_0x246135[_0x13deca]!==_0x18aa49(0xac))__createBinding(_0x534e55,_0x66377d,_0x246135[_0x13deca]);}return __setModuleDefault(_0x534e55,_0x66377d),_0x534e55;};}());Object[a4_0x1ca290(0xb5)](exports,a4_0x1ca290(0xb7),{'value':!![]}),exports[a4_0x1ca290(0x8c)]=void 0x0;const authService_1=require('../services/authService'),tokenBlacklistService_1=require(a4_0x1ca290(0x89)),telegramBotService_1=require('../services/telegramBotService');class AuthController{constructor(){const _0x5d3740=a4_0x1ca290;this[_0x5d3740(0x9b)]=async(_0x5b774d,_0x49644b,_0x2a2e5f)=>{const _0x2b2a57=_0x5d3740;try{const _0x2a3013=_0x5b774d['body'],_0x100f11=_0x5b774d['ip']||_0x5b774d[_0x2b2a57(0xb6)][_0x2b2a57(0x91)]||_0x2b2a57(0x9c),_0x21c1d5=_0x5b774d[_0x2b2a57(0xa2)](_0x2b2a57(0x92))||_0x2b2a57(0x9c);let _0x5e5269=![],_0x31fb88=null;try{const _0x30f124=await this[_0x2b2a57(0x90)][_0x2b2a57(0x9b)](_0x2a3013);_0x5e5269=!![],_0x30f124['role']===_0x2b2a57(0xa6)&&_0x30f124['user']?.['id']&&(_0x31fb88=_0x30f124[_0x2b2a57(0xa7)]['id']),_0x31fb88&&await telegramBotService_1[_0x2b2a57(0x8f)]['sendLoginNotification'](_0x31fb88,{'username':_0x2a3013[_0x2b2a57(0x9d)],'ipAddress':_0x100f11,'userAgent':_0x21c1d5,'timestamp':new Date(),'success':!![]}),_0x49644b['json']({'success':!![],'result':_0x30f124});}catch(_0x127544){try{const _0x11505a=(await Promise[_0x2b2a57(0xa0)]()[_0x2b2a57(0x97)](()=>__importStar(require(_0x2b2a57(0xaf)))))[_0x2b2a57(0xac)],_0x5506f0=await _0x11505a[_0x2b2a57(0xa6)][_0x2b2a57(0xb0)]({'where':{'username':_0x2a3013[_0x2b2a57(0x9d)]},'select':{'id':!![]}});_0x5506f0&&await telegramBotService_1[_0x2b2a57(0x8f)]['sendLoginNotification'](_0x5506f0['id'],{'username':_0x2a3013[_0x2b2a57(0x9d)],'ipAddress':_0x100f11,'userAgent':_0x21c1d5,'timestamp':new Date(),'success':![]});}catch(_0x1d1851){console[_0x2b2a57(0x9e)]('Failed\x20to\x20send\x20failed\x20login\x20notification:',_0x1d1851);}throw _0x127544;}}catch(_0x2954b2){_0x2a2e5f(_0x2954b2);}},this['me']=async(_0x29ae27,_0x28da54,_0x126847)=>{const _0x5e5849=_0x5d3740;try{const _0x54092e=_0x29ae27[_0x5e5849(0xa7)];_0x28da54[_0x5e5849(0x9a)]({'success':!![],'result':{'id':_0x54092e?.['id'],'username':_0x54092e?.[_0x5e5849(0x9d)],'role':_0x54092e?.[_0x5e5849(0x8a)]}});}catch(_0xaeaa77){_0x126847(_0xaeaa77);}},this[_0x5d3740(0xa9)]=async(_0x5c2464,_0x4b685a,_0x26eb54)=>{const _0x2723f2=_0x5d3740;try{const _0x55338f=_0x5c2464['token'],_0x2d9d99=_0x5c2464['user'];_0x55338f&&_0x2d9d99?.[_0x2723f2(0x98)]&&tokenBlacklistService_1[_0x2723f2(0xb4)][_0x2723f2(0xa3)](_0x55338f,_0x2d9d99[_0x2723f2(0x98)]),_0x4b685a[_0x2723f2(0x9a)]({'success':!![],'message':_0x2723f2(0xba)});}catch(_0x317198){_0x26eb54(_0x317198);}},this['getBlacklistStats']=async(_0x40e18b,_0x4bbe83,_0xd2bae7)=>{const _0x5f276e=_0x5d3740;try{const _0x30c623=tokenBlacklistService_1[_0x5f276e(0xb4)][_0x5f276e(0xb3)]();_0x4bbe83[_0x5f276e(0x9a)]({'success':!![],'result':_0x30c623});}catch(_0xc76066){_0xd2bae7(_0xc76066);}},this[_0x5d3740(0x90)]=new authService_1['AuthService']();}}function a4_0x3750(){const _0x4172ee=['780kXEfBE','default','getOwnPropertyNames','prototype','../config/database','findUnique','__importStar','getOwnPropertyDescriptor','getStats','tokenBlacklistService','defineProperty','connection','__esModule','4008820FavZwI','3439272gaRaLA','Logged\x20out\x20successfully','hasOwnProperty','../services/tokenBlacklistService','role','length','AuthController','9NuiKeE','__createBinding','telegramBotService','authService','remoteAddress','User-Agent','configurable','create','287XjwFHk','12102YqyfVU','then','exp','2843658dfhlOP','json','login','unknown','username','error','19105nhUrjp','resolve','writable','get','blacklistToken','253nWlkAo','64oZBukq','shop','user','82374TMRBcS','logout','1146864FtOuZa'];a4_0x3750=function(){return _0x4172ee;};return a4_0x3750();}function a4_0xad7d(_0xddddd1,_0x32ee70){const _0x375041=a4_0x3750();return a4_0xad7d=function(_0xad7d8a,_0x378cf9){_0xad7d8a=_0xad7d8a-0x88;let _0x55a705=_0x375041[_0xad7d8a];return _0x55a705;},a4_0xad7d(_0xddddd1,_0x32ee70);}exports['AuthController']=AuthController;