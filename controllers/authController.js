'use strict';const a4_0x4a0f54=a4_0x391e;function a4_0x510f(){const _0x1292eb=['authService','connection','../services/authService','remoteAddress','getOwnPropertyDescriptor','shop','__importStar','exp','get','user','38953kFnNWq','__esModule','findUnique','ipAddress','length','sendLoginNotification','telegramBotService','unknown','defineProperty','Logged\x20out\x20successfully','9210520KmurHL','username','login','4spwPve','2261073SFkLZd','117620FBnkiM','AuthController','create','error','tokenBlacklistService','8GLhQpZ','role','resolve','User-Agent','json','userAgent','hasOwnProperty','2223781BVZCVc','default','getStats','body','writable','../services/telegramBotService','AuthService','token','then','logout','getOwnPropertyNames','blacklistToken','configurable','5674500yaOuGG','3382776RXwNTn','100BPAjpL'];a4_0x510f=function(){return _0x1292eb;};return a4_0x510f();}(function(_0x5c6287,_0x4621c4){const _0x2c2108=a4_0x391e,_0x54861c=_0x5c6287();while(!![]){try{const _0x23b0bc=-parseInt(_0x2c2108(0xbd))/0x1*(-parseInt(_0x2c2108(0x95))/0x2)+-parseInt(_0x2c2108(0x96))/0x3+-parseInt(_0x2c2108(0xb2))/0x4*(-parseInt(_0x2c2108(0x97))/0x5)+parseInt(_0x2c2108(0xb1))/0x6+-parseInt(_0x2c2108(0xa3))/0x7*(parseInt(_0x2c2108(0x9c))/0x8)+-parseInt(_0x2c2108(0xb0))/0x9+parseInt(_0x2c2108(0x92))/0xa;if(_0x23b0bc===_0x4621c4)break;else _0x54861c['push'](_0x54861c['shift']());}catch(_0x1b8fdd){_0x54861c['push'](_0x54861c['shift']());}}}(a4_0x510f,0x6d9d4));function a4_0x391e(_0x52adda,_0x280956){_0x52adda=_0x52adda-0x91;const _0x510f29=a4_0x510f();let _0x391e01=_0x510f29[_0x52adda];return _0x391e01;}var __createBinding=this&&this['__createBinding']||(Object[a4_0x4a0f54(0x99)]?function(_0x580549,_0xde6692,_0x231410,_0x2bf540){const _0x4eb6ec=a4_0x4a0f54;if(_0x2bf540===undefined)_0x2bf540=_0x231410;var _0x30c834=Object[_0x4eb6ec(0xb7)](_0xde6692,_0x231410);(!_0x30c834||(_0x4eb6ec(0xbb)in _0x30c834?!_0xde6692[_0x4eb6ec(0xbe)]:_0x30c834[_0x4eb6ec(0xa7)]||_0x30c834[_0x4eb6ec(0xaf)]))&&(_0x30c834={'enumerable':!![],'get':function(){return _0xde6692[_0x231410];}}),Object[_0x4eb6ec(0xc5)](_0x580549,_0x2bf540,_0x30c834);}:function(_0x5c868e,_0xea6adb,_0x321946,_0xe49a3f){if(_0xe49a3f===undefined)_0xe49a3f=_0x321946;_0x5c868e[_0xe49a3f]=_0xea6adb[_0x321946];}),__setModuleDefault=this&&this['__setModuleDefault']||(Object[a4_0x4a0f54(0x99)]?function(_0x5d768c,_0x5d11e0){const _0x181c2d=a4_0x4a0f54;Object[_0x181c2d(0xc5)](_0x5d768c,_0x181c2d(0xa4),{'enumerable':!![],'value':_0x5d11e0});}:function(_0x2130ad,_0x3069e2){const _0x3e5f77=a4_0x4a0f54;_0x2130ad[_0x3e5f77(0xa4)]=_0x3069e2;}),__importStar=this&&this[a4_0x4a0f54(0xb9)]||(function(){var _0x3c6e2b=function(_0x530f56){const _0x4ace5e=a4_0x391e;return _0x3c6e2b=Object[_0x4ace5e(0xad)]||function(_0x1d9837){const _0x5bcdd2=_0x4ace5e;var _0x40d8ad=[];for(var _0x30df01 in _0x1d9837)if(Object['prototype'][_0x5bcdd2(0xa2)]['call'](_0x1d9837,_0x30df01))_0x40d8ad[_0x40d8ad[_0x5bcdd2(0xc1)]]=_0x30df01;return _0x40d8ad;},_0x3c6e2b(_0x530f56);};return function(_0x23c434){const _0x506356=a4_0x391e;if(_0x23c434&&_0x23c434['__esModule'])return _0x23c434;var _0x13439b={};if(_0x23c434!=null){for(var _0x3b667f=_0x3c6e2b(_0x23c434),_0x4eb171=0x0;_0x4eb171<_0x3b667f[_0x506356(0xc1)];_0x4eb171++)if(_0x3b667f[_0x4eb171]!==_0x506356(0xa4))__createBinding(_0x13439b,_0x23c434,_0x3b667f[_0x4eb171]);}return __setModuleDefault(_0x13439b,_0x23c434),_0x13439b;};}());Object[a4_0x4a0f54(0xc5)](exports,a4_0x4a0f54(0xbe),{'value':!![]}),exports[a4_0x4a0f54(0x98)]=void 0x0;const authService_1=require(a4_0x4a0f54(0xb5)),tokenBlacklistService_1=require('../services/tokenBlacklistService'),telegramBotService_1=require(a4_0x4a0f54(0xa8));class AuthController{constructor(){const _0x14fe90=a4_0x4a0f54;this['login']=async(_0x48309a,_0x3586a4,_0x2d9378)=>{const _0x10b3ea=a4_0x391e;try{const _0xacec05=_0x48309a[_0x10b3ea(0xa6)],_0x12e63c=_0xacec05[_0x10b3ea(0xc0)]||_0x48309a['ip']||_0x48309a[_0x10b3ea(0xb4)][_0x10b3ea(0xb6)]||'unknown',_0x33b2dc=_0xacec05[_0x10b3ea(0xa1)]||_0x48309a['get'](_0x10b3ea(0x9f))||_0x10b3ea(0xc4),_0x4edc0c=_0xacec05['geo'];let _0x2b10ff=![],_0x5d1ad2=null;try{const _0x1d5fd1=await this[_0x10b3ea(0xb3)][_0x10b3ea(0x94)](_0xacec05);_0x2b10ff=!![],_0x1d5fd1[_0x10b3ea(0x9d)]===_0x10b3ea(0xb8)&&_0x1d5fd1[_0x10b3ea(0xbc)]?.['id']&&(_0x5d1ad2=_0x1d5fd1[_0x10b3ea(0xbc)]['id']),_0x5d1ad2&&await telegramBotService_1['telegramBotService'][_0x10b3ea(0xc2)](_0x5d1ad2,{'username':_0xacec05['username'],'ipAddress':_0x12e63c,'userAgent':_0x33b2dc,'geo':_0x4edc0c,'timestamp':new Date(),'success':!![]}),_0x3586a4['json']({'success':!![],'result':_0x1d5fd1});}catch(_0x539690){try{const _0x376eab=(await Promise[_0x10b3ea(0x9e)]()[_0x10b3ea(0xab)](()=>__importStar(require('../config/database'))))[_0x10b3ea(0xa4)],_0x3d8853=await _0x376eab['shop'][_0x10b3ea(0xbf)]({'where':{'username':_0xacec05[_0x10b3ea(0x93)]},'select':{'id':!![]}});_0x3d8853&&await telegramBotService_1[_0x10b3ea(0xc3)]['sendLoginNotification'](_0x3d8853['id'],{'username':_0xacec05['username'],'ipAddress':_0x12e63c,'userAgent':_0x33b2dc,'geo':_0x4edc0c,'timestamp':new Date(),'success':![]});}catch(_0x468fb0){console[_0x10b3ea(0x9a)]('Failed\x20to\x20send\x20failed\x20login\x20notification:',_0x468fb0);}throw _0x539690;}}catch(_0x2d0470){_0x2d9378(_0x2d0470);}},this['me']=async(_0x2f8f85,_0x3539f6,_0x49297a)=>{const _0x50abbe=a4_0x391e;try{const _0x380589=_0x2f8f85[_0x50abbe(0xbc)];_0x3539f6[_0x50abbe(0xa0)]({'success':!![],'result':{'id':_0x380589?.['id'],'username':_0x380589?.['username'],'role':_0x380589?.[_0x50abbe(0x9d)]}});}catch(_0x23a4d2){_0x49297a(_0x23a4d2);}},this[_0x14fe90(0xac)]=async(_0xbab8d,_0x9f8429,_0x140832)=>{const _0x3b33c1=_0x14fe90;try{const _0x532bd9=_0xbab8d[_0x3b33c1(0xaa)],_0x1012ba=_0xbab8d['user'];_0x532bd9&&_0x1012ba?.[_0x3b33c1(0xba)]&&tokenBlacklistService_1[_0x3b33c1(0x9b)][_0x3b33c1(0xae)](_0x532bd9,_0x1012ba[_0x3b33c1(0xba)]),_0x9f8429[_0x3b33c1(0xa0)]({'success':!![],'message':_0x3b33c1(0x91)});}catch(_0x5508de){_0x140832(_0x5508de);}},this['getBlacklistStats']=async(_0x5777b4,_0x34d484,_0x275ec5)=>{const _0x301558=_0x14fe90;try{const _0x28df78=tokenBlacklistService_1['tokenBlacklistService'][_0x301558(0xa5)]();_0x34d484[_0x301558(0xa0)]({'success':!![],'result':_0x28df78});}catch(_0x11d5b6){_0x275ec5(_0x11d5b6);}},this['authService']=new authService_1[(_0x14fe90(0xa9))]();}}exports['AuthController']=AuthController;