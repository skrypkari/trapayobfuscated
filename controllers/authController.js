'use strict';const a4_0x1dfe8d=a4_0x2c8f;(function(_0x484a7a,_0x5a0063){const _0x3d9347=a4_0x2c8f,_0x114cbb=_0x484a7a();while(!![]){try{const _0x46be57=parseInt(_0x3d9347(0x19f))/0x1+parseInt(_0x3d9347(0x188))/0x2*(-parseInt(_0x3d9347(0x187))/0x3)+-parseInt(_0x3d9347(0x1af))/0x4*(parseInt(_0x3d9347(0x199))/0x5)+-parseInt(_0x3d9347(0x190))/0x6*(parseInt(_0x3d9347(0x185))/0x7)+-parseInt(_0x3d9347(0x1a7))/0x8+parseInt(_0x3d9347(0x19b))/0x9*(-parseInt(_0x3d9347(0x18e))/0xa)+-parseInt(_0x3d9347(0x194))/0xb*(-parseInt(_0x3d9347(0x19e))/0xc);if(_0x46be57===_0x5a0063)break;else _0x114cbb['push'](_0x114cbb['shift']());}catch(_0x5b4544){_0x114cbb['push'](_0x114cbb['shift']());}}}(a4_0x3c4b,0x90174));function a4_0x2c8f(_0x1d11e1,_0x1f2d65){const _0x3c4be6=a4_0x3c4b();return a4_0x2c8f=function(_0x2c8f0e,_0x1077e0){_0x2c8f0e=_0x2c8f0e-0x185;let _0x4b6e9f=_0x3c4be6[_0x2c8f0e];return _0x4b6e9f;},a4_0x2c8f(_0x1d11e1,_0x1f2d65);}var __createBinding=this&&this[a4_0x1dfe8d(0x1ac)]||(Object['create']?function(_0x159f01,_0xaec813,_0x3309b2,_0x53da13){const _0x1bbf06=a4_0x1dfe8d;if(_0x53da13===undefined)_0x53da13=_0x3309b2;var _0x1f2724=Object[_0x1bbf06(0x1b7)](_0xaec813,_0x3309b2);(!_0x1f2724||('get'in _0x1f2724?!_0xaec813['__esModule']:_0x1f2724[_0x1bbf06(0x1a4)]||_0x1f2724[_0x1bbf06(0x18f)]))&&(_0x1f2724={'enumerable':!![],'get':function(){return _0xaec813[_0x3309b2];}}),Object[_0x1bbf06(0x1b1)](_0x159f01,_0x53da13,_0x1f2724);}:function(_0x2519f4,_0xedc7b8,_0x53764e,_0x12c84d){if(_0x12c84d===undefined)_0x12c84d=_0x53764e;_0x2519f4[_0x12c84d]=_0xedc7b8[_0x53764e];}),__setModuleDefault=this&&this['__setModuleDefault']||(Object[a4_0x1dfe8d(0x1a6)]?function(_0x508472,_0x4f070c){const _0x8ea961=a4_0x1dfe8d;Object['defineProperty'](_0x508472,_0x8ea961(0x197),{'enumerable':!![],'value':_0x4f070c});}:function(_0x39692f,_0x109a85){const _0x47ea54=a4_0x1dfe8d;_0x39692f[_0x47ea54(0x197)]=_0x109a85;}),__importStar=this&&this['__importStar']||(function(){var _0x1fb898=function(_0x19ffc5){const _0x42d910=a4_0x2c8f;return _0x1fb898=Object[_0x42d910(0x1a3)]||function(_0x6242c1){const _0x679ee9=_0x42d910;var _0x13b5b7=[];for(var _0x2122b5 in _0x6242c1)if(Object[_0x679ee9(0x1a1)][_0x679ee9(0x19a)][_0x679ee9(0x19d)](_0x6242c1,_0x2122b5))_0x13b5b7[_0x13b5b7[_0x679ee9(0x191)]]=_0x2122b5;return _0x13b5b7;},_0x1fb898(_0x19ffc5);};return function(_0x18cfc6){const _0x31bc17=a4_0x2c8f;if(_0x18cfc6&&_0x18cfc6[_0x31bc17(0x19c)])return _0x18cfc6;var _0xd7a7d4={};if(_0x18cfc6!=null){for(var _0x306dcd=_0x1fb898(_0x18cfc6),_0x33532b=0x0;_0x33532b<_0x306dcd[_0x31bc17(0x191)];_0x33532b++)if(_0x306dcd[_0x33532b]!==_0x31bc17(0x197))__createBinding(_0xd7a7d4,_0x18cfc6,_0x306dcd[_0x33532b]);}return __setModuleDefault(_0xd7a7d4,_0x18cfc6),_0xd7a7d4;};}());Object[a4_0x1dfe8d(0x1b1)](exports,'__esModule',{'value':!![]}),exports[a4_0x1dfe8d(0x1a5)]=void 0x0;const authService_1=require(a4_0x1dfe8d(0x193)),tokenBlacklistService_1=require('../services/tokenBlacklistService'),telegramBotService_1=require('../services/telegramBotService');class AuthController{constructor(){const _0x1754fb=a4_0x1dfe8d;this[_0x1754fb(0x189)]=async(_0x28060a,_0x1703b6,_0x468ac1)=>{const _0xca0cd2=_0x1754fb;try{const _0x22ed1b=_0x28060a['body'],_0x3779dc=_0x28060a['ip']||_0x28060a['connection'][_0xca0cd2(0x186)]||'unknown',_0x349993=_0x28060a['get'](_0xca0cd2(0x1ab))||'unknown';let _0x3c88b3=![],_0x1a37e9=null;try{const _0x17943b=await this[_0xca0cd2(0x192)][_0xca0cd2(0x189)](_0x22ed1b);_0x3c88b3=!![],_0x17943b['role']===_0xca0cd2(0x1a8)&&_0x17943b['user']?.['id']&&(_0x1a37e9=_0x17943b['user']['id']),_0x1a37e9&&await telegramBotService_1['telegramBotService']['sendLoginNotification'](_0x1a37e9,{'username':_0x22ed1b['username'],'ipAddress':_0x3779dc,'userAgent':_0x349993,'timestamp':new Date(),'success':!![]}),_0x1703b6['json']({'success':!![],'result':_0x17943b});}catch(_0x1b6e8b){try{const _0x439b69=(await Promise[_0xca0cd2(0x198)]()[_0xca0cd2(0x18a)](()=>__importStar(require(_0xca0cd2(0x1ae)))))[_0xca0cd2(0x197)],_0x33970f=await _0x439b69[_0xca0cd2(0x1a8)][_0xca0cd2(0x1b6)]({'where':{'username':_0x22ed1b[_0xca0cd2(0x1a0)]},'select':{'id':!![]}});_0x33970f&&await telegramBotService_1[_0xca0cd2(0x1a2)][_0xca0cd2(0x1b5)](_0x33970f['id'],{'username':_0x22ed1b[_0xca0cd2(0x1a0)],'ipAddress':_0x3779dc,'userAgent':_0x349993,'timestamp':new Date(),'success':![]});}catch(_0xd46dcd){console[_0xca0cd2(0x195)](_0xca0cd2(0x1b4),_0xd46dcd);}throw _0x1b6e8b;}}catch(_0x201f69){_0x468ac1(_0x201f69);}},this['me']=async(_0x1ad48d,_0x3cc595,_0x5da4f7)=>{const _0x5455e0=_0x1754fb;try{const _0x45f5d9=_0x1ad48d['user'];_0x3cc595[_0x5455e0(0x18d)]({'success':!![],'result':{'id':_0x45f5d9?.['id'],'username':_0x45f5d9?.[_0x5455e0(0x1a0)],'role':_0x45f5d9?.[_0x5455e0(0x1a9)]}});}catch(_0x4e633f){_0x5da4f7(_0x4e633f);}},this[_0x1754fb(0x1aa)]=async(_0x25c7a8,_0x18be7f,_0x5830e3)=>{const _0x4ce310=_0x1754fb;try{const _0x45e039=_0x25c7a8[_0x4ce310(0x1ad)],_0x1b0035=_0x25c7a8['user'];_0x45e039&&_0x1b0035?.['exp']&&tokenBlacklistService_1[_0x4ce310(0x18b)]['blacklistToken'](_0x45e039,_0x1b0035[_0x4ce310(0x1b2)]),_0x18be7f[_0x4ce310(0x18d)]({'success':!![],'message':_0x4ce310(0x1b3)});}catch(_0x47b2ad){_0x5830e3(_0x47b2ad);}},this[_0x1754fb(0x1b0)]=async(_0x3af604,_0x1321cf,_0xf1b071)=>{const _0x31ccc9=_0x1754fb;try{const _0x528d9f=tokenBlacklistService_1[_0x31ccc9(0x18b)][_0x31ccc9(0x196)]();_0x1321cf[_0x31ccc9(0x18d)]({'success':!![],'result':_0x528d9f});}catch(_0x18310d){_0xf1b071(_0x18310d);}},this['authService']=new authService_1[(_0x1754fb(0x18c))]();}}exports[a4_0x1dfe8d(0x1a5)]=AuthController;function a4_0x3c4b(){const _0x55d9d2=['defineProperty','exp','Logged\x20out\x20successfully','Failed\x20to\x20send\x20failed\x20login\x20notification:','sendLoginNotification','findUnique','getOwnPropertyDescriptor','7mMCrEL','remoteAddress','347217Uvwdph','2jDVuvq','login','then','tokenBlacklistService','AuthService','json','4670CpyRpk','configurable','6381762RMNOxi','length','authService','../services/authService','275xZvDSh','error','getStats','default','resolve','5xvuxdX','hasOwnProperty','22689TQJDsf','__esModule','call','1095792eNuPdF','1151282ugrjDI','username','prototype','telegramBotService','getOwnPropertyNames','writable','AuthController','create','2096688eKoKDm','shop','role','logout','User-Agent','__createBinding','token','../config/database','900908ucKXTf','getBlacklistStats'];a4_0x3c4b=function(){return _0x55d9d2;};return a4_0x3c4b();}