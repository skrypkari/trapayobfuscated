'use strict';const a4_0xae5899=a4_0x2a4c;(function(_0x178dd9,_0x515095){const _0x5a9e6e=a4_0x2a4c,_0x4ff8e8=_0x178dd9();while(!![]){try{const _0x3900b2=-parseInt(_0x5a9e6e(0x1dd))/0x1*(-parseInt(_0x5a9e6e(0x1ea))/0x2)+-parseInt(_0x5a9e6e(0x1f4))/0x3*(parseInt(_0x5a9e6e(0x1b5))/0x4)+parseInt(_0x5a9e6e(0x1d2))/0x5*(parseInt(_0x5a9e6e(0x1d1))/0x6)+-parseInt(_0x5a9e6e(0x1e0))/0x7*(-parseInt(_0x5a9e6e(0x1f5))/0x8)+parseInt(_0x5a9e6e(0x1cf))/0x9+parseInt(_0x5a9e6e(0x1f2))/0xa+-parseInt(_0x5a9e6e(0x1dc))/0xb*(parseInt(_0x5a9e6e(0x1c9))/0xc);if(_0x3900b2===_0x515095)break;else _0x4ff8e8['push'](_0x4ff8e8['shift']());}catch(_0x4109e8){_0x4ff8e8['push'](_0x4ff8e8['shift']());}}}(a4_0x5d29,0x33268));var __createBinding=this&&this[a4_0xae5899(0x1bc)]||(Object[a4_0xae5899(0x1ec)]?function(_0x484356,_0x43e138,_0x488323,_0x2b0b95){const _0x1235f8=a4_0xae5899;if(_0x2b0b95===undefined)_0x2b0b95=_0x488323;var _0x338109=Object['getOwnPropertyDescriptor'](_0x43e138,_0x488323);(!_0x338109||(_0x1235f8(0x1e9)in _0x338109?!_0x43e138['__esModule']:_0x338109['writable']||_0x338109['configurable']))&&(_0x338109={'enumerable':!![],'get':function(){return _0x43e138[_0x488323];}}),Object[_0x1235f8(0x1de)](_0x484356,_0x2b0b95,_0x338109);}:function(_0x264a8e,_0xae09e1,_0x1e6062,_0x4a8c70){if(_0x4a8c70===undefined)_0x4a8c70=_0x1e6062;_0x264a8e[_0x4a8c70]=_0xae09e1[_0x1e6062];}),__setModuleDefault=this&&this[a4_0xae5899(0x1ba)]||(Object[a4_0xae5899(0x1ec)]?function(_0x2a5e68,_0x213935){const _0x1b87a2=a4_0xae5899;Object[_0x1b87a2(0x1de)](_0x2a5e68,'default',{'enumerable':!![],'value':_0x213935});}:function(_0x306bca,_0x3213a0){const _0x16b8a0=a4_0xae5899;_0x306bca[_0x16b8a0(0x1e5)]=_0x3213a0;}),__importStar=this&&this[a4_0xae5899(0x1f7)]||(function(){var _0x28598d=function(_0x361a44){const _0x504e04=a4_0x2a4c;return _0x28598d=Object[_0x504e04(0x1d7)]||function(_0x17bf21){const _0x4acdca=_0x504e04;var _0x5d20c4=[];for(var _0x344fa5 in _0x17bf21)if(Object[_0x4acdca(0x1be)][_0x4acdca(0x1c0)]['call'](_0x17bf21,_0x344fa5))_0x5d20c4[_0x5d20c4[_0x4acdca(0x1d0)]]=_0x344fa5;return _0x5d20c4;},_0x28598d(_0x361a44);};return function(_0x1944c2){const _0x1a4336=a4_0x2a4c;if(_0x1944c2&&_0x1944c2['__esModule'])return _0x1944c2;var _0x5cb476={};if(_0x1944c2!=null){for(var _0x21520f=_0x28598d(_0x1944c2),_0x371bae=0x0;_0x371bae<_0x21520f[_0x1a4336(0x1d0)];_0x371bae++)if(_0x21520f[_0x371bae]!=='default')__createBinding(_0x5cb476,_0x1944c2,_0x21520f[_0x371bae]);}return __setModuleDefault(_0x5cb476,_0x1944c2),_0x5cb476;};}());Object[a4_0xae5899(0x1de)](exports,'__esModule',{'value':!![]}),exports[a4_0xae5899(0x1cd)]=void 0x0;function a4_0x5d29(){const _0x6fa07d=['requestId\x20query\x20parameter\x20is\x20required','then','body','AuthController','resolve','1331676HvRbKP','length','1093782TViiiL','5wtKmOA','tokenBlacklistService','anJngmXQVawz37L0S21u','unknown','../services/tokenBlacklistService','getOwnPropertyNames','data','userAgent','remoteAddress','username','2539141gHWwFk','22yZhRlQ','defineProperty','country','962171shsyAJ','connection','authService','code','token','default','blacklistToken','User-Agent','geo','get','16792KDGWTt','getBlacklistStats','create','GET','products','exp','application/json','ipAddress','1444710agIAyn','ipInfo','400629YzCLMx','24VXSBWR','https://eu.api.fpjs.io/events/','__importStar','login','user','12HhTgJe','status','address','AuthService','role','__setModuleDefault','../services/authService','__createBinding','telegramBotService','prototype','Failed\x20to\x20send\x20failed\x20login\x20notification:','hasOwnProperty','../services/telegramBotService','geolocation','Logged\x20out\x20successfully','../config/database','query','findUnique','Failed\x20to\x20retrieve\x20fingerprint\x20data','json','24IAujmM'];a4_0x5d29=function(){return _0x6fa07d;};return a4_0x5d29();}const authService_1=require(a4_0xae5899(0x1bb)),tokenBlacklistService_1=require(a4_0xae5899(0x1d6)),telegramBotService_1=require(a4_0xae5899(0x1c1));class AuthController{constructor(){const _0x48686a=a4_0xae5899;this[_0x48686a(0x1f8)]=async(_0x142ac2,_0x485392,_0xed576e)=>{const _0x3fdf43=_0x48686a;try{const _0x3cf6fe=_0x142ac2[_0x3fdf43(0x1cc)],_0x164afe=_0x3cf6fe[_0x3fdf43(0x1f1)]||_0x142ac2['ip']||_0x142ac2[_0x3fdf43(0x1e1)][_0x3fdf43(0x1da)]||_0x3fdf43(0x1d5),_0x38c5fc=_0x3cf6fe[_0x3fdf43(0x1d9)]||_0x142ac2[_0x3fdf43(0x1e9)](_0x3fdf43(0x1e7))||_0x3fdf43(0x1d5),_0x5757f6=_0x3cf6fe[_0x3fdf43(0x1e8)];let _0x45aada=![],_0x53bb3d=null;try{const _0xee0fc=await this[_0x3fdf43(0x1e2)][_0x3fdf43(0x1f8)](_0x3cf6fe);_0x45aada=!![],_0xee0fc[_0x3fdf43(0x1b9)]==='shop'&&_0xee0fc['user']?.['id']&&(_0x53bb3d=_0xee0fc[_0x3fdf43(0x1f9)]['id']),_0x53bb3d&&await telegramBotService_1[_0x3fdf43(0x1bd)]['sendLoginNotification'](_0x53bb3d,{'username':_0x3cf6fe[_0x3fdf43(0x1db)],'ipAddress':_0x164afe,'userAgent':_0x38c5fc,'geo':_0x5757f6,'timestamp':new Date(),'success':!![]}),_0x485392[_0x3fdf43(0x1c8)]({'success':!![],'result':_0xee0fc});}catch(_0x48a21c){try{const _0x2d5a98=(await Promise[_0x3fdf43(0x1ce)]()[_0x3fdf43(0x1cb)](()=>__importStar(require(_0x3fdf43(0x1c4)))))[_0x3fdf43(0x1e5)],_0x50f197=await _0x2d5a98['shop'][_0x3fdf43(0x1c6)]({'where':{'username':_0x3cf6fe[_0x3fdf43(0x1db)]},'select':{'id':!![]}});_0x50f197&&await telegramBotService_1[_0x3fdf43(0x1bd)]['sendLoginNotification'](_0x50f197['id'],{'username':_0x3cf6fe[_0x3fdf43(0x1db)],'ipAddress':_0x164afe,'userAgent':_0x38c5fc,'geo':_0x5757f6,'timestamp':new Date(),'success':![]});}catch(_0x180817){console['error'](_0x3fdf43(0x1bf),_0x180817);}throw _0x48a21c;}}catch(_0x4a0c8a){_0xed576e(_0x4a0c8a);}},this['me']=async(_0x1d9b90,_0x76c2c1,_0x4d4654)=>{const _0x22c228=_0x48686a;try{const _0x1464ca=_0x1d9b90['user'];_0x76c2c1[_0x22c228(0x1c8)]({'success':!![],'result':{'id':_0x1464ca?.['id'],'username':_0x1464ca?.['username'],'role':_0x1464ca?.[_0x22c228(0x1b9)]}});}catch(_0xfed9fe){_0x4d4654(_0xfed9fe);}},this['logout']=async(_0x46de1e,_0x3c3ecc,_0x59aa13)=>{const _0x4f92fb=_0x48686a;try{const _0x52d7f9=_0x46de1e[_0x4f92fb(0x1e4)],_0x5e7d1a=_0x46de1e[_0x4f92fb(0x1f9)];_0x52d7f9&&_0x5e7d1a?.[_0x4f92fb(0x1ef)]&&tokenBlacklistService_1[_0x4f92fb(0x1d3)][_0x4f92fb(0x1e6)](_0x52d7f9,_0x5e7d1a[_0x4f92fb(0x1ef)]),_0x3c3ecc[_0x4f92fb(0x1c8)]({'success':!![],'message':_0x4f92fb(0x1c3)});}catch(_0x5c0fc9){_0x59aa13(_0x5c0fc9);}},this[_0x48686a(0x1eb)]=async(_0x170f03,_0x469a21,_0x255514)=>{const _0x4287ff=_0x48686a;try{const _0x25f29c=tokenBlacklistService_1[_0x4287ff(0x1d3)]['getStats']();_0x469a21[_0x4287ff(0x1c8)]({'success':!![],'result':_0x25f29c});}catch(_0x3e2b36){_0x255514(_0x3e2b36);}},this['getFingerprintInfo']=async(_0x4e55e3,_0x4d8309,_0x59462b)=>{const _0xf464=_0x48686a;try{const {requestId:_0x2024cf}=_0x4e55e3[_0xf464(0x1c5)];if(typeof _0x2024cf!=='string')return _0x4d8309[_0xf464(0x1b6)](0x190)[_0xf464(0x1c8)]({'success':![],'message':_0xf464(0x1ca)});const _0x2c985f=_0xf464(0x1f6)+_0x2024cf,_0x444eb0=await fetch(_0x2c985f,{'method':_0xf464(0x1ed),'headers':{'Content-Type':_0xf464(0x1f0),'Auth-API-Key':_0xf464(0x1d4)}});if(!_0x444eb0['ok'])return _0x4d8309['status'](_0x444eb0[_0xf464(0x1b6)])[_0xf464(0x1c8)]({'success':![],'message':_0xf464(0x1c7)});const _0x5b7384=await _0x444eb0[_0xf464(0x1c8)](),_0x37eac0=_0x5b7384[_0xf464(0x1ee)]?.[_0xf464(0x1f3)]?.[_0xf464(0x1d8)]?.['v4']?.[_0xf464(0x1b7)]||_0x5b7384[_0xf464(0x1ee)]?.['ipInfo']?.[_0xf464(0x1d8)]?.['v6']?.[_0xf464(0x1b7)]||'',_0x269bd2=_0x5b7384[_0xf464(0x1ee)]?.[_0xf464(0x1f3)]?.[_0xf464(0x1d8)]?.['v4']?.[_0xf464(0x1c2)]?.['country']?.[_0xf464(0x1e3)]||_0x5b7384[_0xf464(0x1ee)]?.[_0xf464(0x1f3)]?.[_0xf464(0x1d8)]?.['v6']?.[_0xf464(0x1c2)]?.[_0xf464(0x1df)]?.[_0xf464(0x1e3)]||'';_0x4d8309['json']({'success':!![],'result':{'ipAddress':_0x37eac0,'countryCode':_0x269bd2}});}catch(_0x370fab){_0x59462b(_0x370fab);}},this[_0x48686a(0x1e2)]=new authService_1[(_0x48686a(0x1b8))]();}}function a4_0x2a4c(_0x49d752,_0x31da1d){_0x49d752=_0x49d752-0x1b5;const _0x5d291b=a4_0x5d29();let _0x2a4c06=_0x5d291b[_0x49d752];return _0x2a4c06;}exports[a4_0xae5899(0x1cd)]=AuthController;