'use strict';function a4_0x17c6(){const _0x8b7b18=['7lrVGtQ','4248568kQLEGE','json','../services/tokenBlacklistService','43742qgaRiN','exp','connection','__importStar','user','getStats','17271djuiij','call','hasOwnProperty','body','../services/authService','unknown','Failed\x20to\x20send\x20failed\x20login\x20notification:','writable','__setModuleDefault','5899896ycamvl','username','length','telegramBotService','__esModule','prototype','__createBinding','getOwnPropertyDescriptor','findUnique','default','error','get','create','User-Agent','1333065dUmxxR','role','configurable','defineProperty','2999910nVmqVW','../config/database','tokenBlacklistService','authService','resolve','sendLoginNotification','shop','3483652lMZrrU','login'];a4_0x17c6=function(){return _0x8b7b18;};return a4_0x17c6();}const a4_0xc25d7=a4_0x4f6a;(function(_0x3b0dec,_0xa38dce){const _0x332b57=a4_0x4f6a,_0x54c387=_0x3b0dec();while(!![]){try{const _0xbb236a=-parseInt(_0x332b57(0xfb))/0x1+-parseInt(_0x332b57(0xf5))/0x2+parseInt(_0x332b57(0x116))/0x3+parseInt(_0x332b57(0xef))/0x4+parseInt(_0x332b57(0x112))/0x5+-parseInt(_0x332b57(0x104))/0x6+-parseInt(_0x332b57(0xf1))/0x7*(parseInt(_0x332b57(0xf2))/0x8);if(_0xbb236a===_0xa38dce)break;else _0x54c387['push'](_0x54c387['shift']());}catch(_0x1ef886){_0x54c387['push'](_0x54c387['shift']());}}}(a4_0x17c6,0x8e91f));function a4_0x4f6a(_0xb2a924,_0x27cbfa){const _0x17c61f=a4_0x17c6();return a4_0x4f6a=function(_0x4f6acc,_0x3ca279){_0x4f6acc=_0x4f6acc-0xef;let _0x7a0640=_0x17c61f[_0x4f6acc];return _0x7a0640;},a4_0x4f6a(_0xb2a924,_0x27cbfa);}var __createBinding=this&&this[a4_0xc25d7(0x10a)]||(Object[a4_0xc25d7(0x110)]?function(_0x4b9e78,_0x336852,_0x546f4e,_0x430ebf){const _0x22e297=a4_0xc25d7;if(_0x430ebf===undefined)_0x430ebf=_0x546f4e;var _0x4966e0=Object[_0x22e297(0x10b)](_0x336852,_0x546f4e);(!_0x4966e0||(_0x22e297(0x10f)in _0x4966e0?!_0x336852[_0x22e297(0x108)]:_0x4966e0[_0x22e297(0x102)]||_0x4966e0[_0x22e297(0x114)]))&&(_0x4966e0={'enumerable':!![],'get':function(){return _0x336852[_0x546f4e];}}),Object[_0x22e297(0x115)](_0x4b9e78,_0x430ebf,_0x4966e0);}:function(_0x488cdf,_0x270272,_0x3d8d6c,_0x572106){if(_0x572106===undefined)_0x572106=_0x3d8d6c;_0x488cdf[_0x572106]=_0x270272[_0x3d8d6c];}),__setModuleDefault=this&&this[a4_0xc25d7(0x103)]||(Object['create']?function(_0x1a74e8,_0x45fdb6){const _0x2dd141=a4_0xc25d7;Object[_0x2dd141(0x115)](_0x1a74e8,_0x2dd141(0x10d),{'enumerable':!![],'value':_0x45fdb6});}:function(_0x871d89,_0x289dee){_0x871d89['default']=_0x289dee;}),__importStar=this&&this[a4_0xc25d7(0xf8)]||(function(){var _0x27fc95=function(_0x2d8cf1){return _0x27fc95=Object['getOwnPropertyNames']||function(_0xa8c6e4){const _0x54dee5=a4_0x4f6a;var _0x8c7ae=[];for(var _0x26a43d in _0xa8c6e4)if(Object[_0x54dee5(0x109)][_0x54dee5(0xfd)][_0x54dee5(0xfc)](_0xa8c6e4,_0x26a43d))_0x8c7ae[_0x8c7ae['length']]=_0x26a43d;return _0x8c7ae;},_0x27fc95(_0x2d8cf1);};return function(_0x2799ba){const _0xf3c6f5=a4_0x4f6a;if(_0x2799ba&&_0x2799ba[_0xf3c6f5(0x108)])return _0x2799ba;var _0x1bd34f={};if(_0x2799ba!=null){for(var _0x1cc59c=_0x27fc95(_0x2799ba),_0x17bead=0x0;_0x17bead<_0x1cc59c[_0xf3c6f5(0x106)];_0x17bead++)if(_0x1cc59c[_0x17bead]!==_0xf3c6f5(0x10d))__createBinding(_0x1bd34f,_0x2799ba,_0x1cc59c[_0x17bead]);}return __setModuleDefault(_0x1bd34f,_0x2799ba),_0x1bd34f;};}());Object[a4_0xc25d7(0x115)](exports,a4_0xc25d7(0x108),{'value':!![]}),exports['AuthController']=void 0x0;const authService_1=require(a4_0xc25d7(0xff)),tokenBlacklistService_1=require(a4_0xc25d7(0xf4)),telegramBotService_1=require('../services/telegramBotService');class AuthController{constructor(){const _0x3607fd=a4_0xc25d7;this['login']=async(_0x19cd44,_0x433727,_0x5bc19b)=>{const _0x51c190=a4_0x4f6a;try{const _0x4263c4=_0x19cd44[_0x51c190(0xfe)],_0x6f86c9=_0x19cd44['ip']||_0x19cd44[_0x51c190(0xf7)]['remoteAddress']||_0x51c190(0x100),_0x2ed275=_0x19cd44[_0x51c190(0x10f)](_0x51c190(0x111))||_0x51c190(0x100);let _0x4845e9=![],_0x55ac5a=null;try{const _0x5c2585=await this[_0x51c190(0x119)][_0x51c190(0xf0)](_0x4263c4);_0x4845e9=!![],_0x5c2585[_0x51c190(0x113)]===_0x51c190(0x11c)&&_0x5c2585['user']?.['id']&&(_0x55ac5a=_0x5c2585[_0x51c190(0xf9)]['id']),_0x55ac5a&&await telegramBotService_1[_0x51c190(0x107)][_0x51c190(0x11b)](_0x55ac5a,{'username':_0x4263c4['username'],'ipAddress':_0x6f86c9,'userAgent':_0x2ed275,'timestamp':new Date(),'success':!![]}),_0x433727[_0x51c190(0xf3)]({'success':!![],'result':_0x5c2585});}catch(_0x2ab25d){try{const _0x31eb37=(await Promise[_0x51c190(0x11a)]()['then'](()=>__importStar(require(_0x51c190(0x117)))))['default'],_0x34dae=await _0x31eb37[_0x51c190(0x11c)][_0x51c190(0x10c)]({'where':{'username':_0x4263c4[_0x51c190(0x105)]},'select':{'id':!![]}});_0x34dae&&await telegramBotService_1[_0x51c190(0x107)]['sendLoginNotification'](_0x34dae['id'],{'username':_0x4263c4[_0x51c190(0x105)],'ipAddress':_0x6f86c9,'userAgent':_0x2ed275,'timestamp':new Date(),'success':![]});}catch(_0x48549d){console[_0x51c190(0x10e)](_0x51c190(0x101),_0x48549d);}throw _0x2ab25d;}}catch(_0x54a2e3){_0x5bc19b(_0x54a2e3);}},this['me']=async(_0x555ddb,_0x2fadee,_0xa27304)=>{const _0x20f1be=a4_0x4f6a;try{const _0x5a1d01=_0x555ddb[_0x20f1be(0xf9)];_0x2fadee[_0x20f1be(0xf3)]({'success':!![],'result':{'id':_0x5a1d01?.['id'],'username':_0x5a1d01?.[_0x20f1be(0x105)],'role':_0x5a1d01?.[_0x20f1be(0x113)]}});}catch(_0x27952d){_0xa27304(_0x27952d);}},this['logout']=async(_0xc84554,_0x1531c7,_0x5b02a1)=>{const _0x42d6b5=a4_0x4f6a;try{const _0x5d91a5=_0xc84554['token'],_0x46a614=_0xc84554[_0x42d6b5(0xf9)];_0x5d91a5&&_0x46a614?.[_0x42d6b5(0xf6)]&&tokenBlacklistService_1[_0x42d6b5(0x118)]['blacklistToken'](_0x5d91a5,_0x46a614[_0x42d6b5(0xf6)]),_0x1531c7[_0x42d6b5(0xf3)]({'success':!![],'message':'Logged\x20out\x20successfully'});}catch(_0x4497ea){_0x5b02a1(_0x4497ea);}},this['getBlacklistStats']=async(_0x46bedf,_0x3419ca,_0x20d072)=>{const _0x675096=a4_0x4f6a;try{const _0x44c686=tokenBlacklistService_1[_0x675096(0x118)][_0x675096(0xfa)]();_0x3419ca['json']({'success':!![],'result':_0x44c686});}catch(_0xe68d07){_0x20d072(_0xe68d07);}},this[_0x3607fd(0x119)]=new authService_1['AuthService']();}}exports['AuthController']=AuthController;