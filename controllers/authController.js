'use strict';const a4_0xd81ca6=a4_0x1306;(function(_0x381978,_0x343c02){const _0x5beb16=a4_0x1306,_0x43b09f=_0x381978();while(!![]){try{const _0x35c10c=parseInt(_0x5beb16(0x15f))/0x1*(-parseInt(_0x5beb16(0x164))/0x2)+-parseInt(_0x5beb16(0x16c))/0x3+parseInt(_0x5beb16(0x17a))/0x4*(-parseInt(_0x5beb16(0x177))/0x5)+parseInt(_0x5beb16(0x15c))/0x6*(parseInt(_0x5beb16(0x157))/0x7)+-parseInt(_0x5beb16(0x185))/0x8*(-parseInt(_0x5beb16(0x169))/0x9)+-parseInt(_0x5beb16(0x174))/0xa+parseInt(_0x5beb16(0x184))/0xb;if(_0x35c10c===_0x343c02)break;else _0x43b09f['push'](_0x43b09f['shift']());}catch(_0x3a7f6b){_0x43b09f['push'](_0x43b09f['shift']());}}}(a4_0x38fa,0x5b0b5));var __createBinding=this&&this[a4_0xd81ca6(0x15d)]||(Object[a4_0xd81ca6(0x16b)]?function(_0x4582d8,_0xfd1cfd,_0xd0287d,_0x29a559){const _0x3b2632=a4_0xd81ca6;if(_0x29a559===undefined)_0x29a559=_0xd0287d;var _0x1d667e=Object[_0x3b2632(0x166)](_0xfd1cfd,_0xd0287d);(!_0x1d667e||(_0x3b2632(0x183)in _0x1d667e?!_0xfd1cfd[_0x3b2632(0x187)]:_0x1d667e['writable']||_0x1d667e[_0x3b2632(0x182)]))&&(_0x1d667e={'enumerable':!![],'get':function(){return _0xfd1cfd[_0xd0287d];}}),Object[_0x3b2632(0x186)](_0x4582d8,_0x29a559,_0x1d667e);}:function(_0x37740f,_0x364ad7,_0x221f0f,_0x349e82){if(_0x349e82===undefined)_0x349e82=_0x221f0f;_0x37740f[_0x349e82]=_0x364ad7[_0x221f0f];}),__setModuleDefault=this&&this[a4_0xd81ca6(0x17b)]||(Object['create']?function(_0x5233b3,_0x6b59e5){const _0x4cdb4e=a4_0xd81ca6;Object[_0x4cdb4e(0x186)](_0x5233b3,_0x4cdb4e(0x17d),{'enumerable':!![],'value':_0x6b59e5});}:function(_0x459ce9,_0x1ddaee){_0x459ce9['default']=_0x1ddaee;}),__importStar=this&&this[a4_0xd81ca6(0x159)]||(function(){var _0x14d84b=function(_0x32ce28){const _0x50d289=a4_0x1306;return _0x14d84b=Object[_0x50d289(0x161)]||function(_0x236f20){const _0x3190a0=_0x50d289;var _0x336694=[];for(var _0x5c7bf2 in _0x236f20)if(Object[_0x3190a0(0x16f)][_0x3190a0(0x173)]['call'](_0x236f20,_0x5c7bf2))_0x336694[_0x336694['length']]=_0x5c7bf2;return _0x336694;},_0x14d84b(_0x32ce28);};return function(_0x2c6700){const _0x32f8e4=a4_0x1306;if(_0x2c6700&&_0x2c6700[_0x32f8e4(0x187)])return _0x2c6700;var _0x3ab5dc={};if(_0x2c6700!=null){for(var _0xc705a=_0x14d84b(_0x2c6700),_0x45b48f=0x0;_0x45b48f<_0xc705a[_0x32f8e4(0x17e)];_0x45b48f++)if(_0xc705a[_0x45b48f]!==_0x32f8e4(0x17d))__createBinding(_0x3ab5dc,_0x2c6700,_0xc705a[_0x45b48f]);}return __setModuleDefault(_0x3ab5dc,_0x2c6700),_0x3ab5dc;};}());function a4_0x1306(_0x1dad50,_0x51a126){const _0x38faeb=a4_0x38fa();return a4_0x1306=function(_0x13067d,_0x3ba19e){_0x13067d=_0x13067d-0x155;let _0x20e1ae=_0x38faeb[_0x13067d];return _0x20e1ae;},a4_0x1306(_0x1dad50,_0x51a126);}Object['defineProperty'](exports,a4_0xd81ca6(0x187),{'value':!![]}),exports['AuthController']=void 0x0;function a4_0x38fa(){const _0x108d43=['User-Agent','184534JBefzr','getStats','__importStar','blacklistToken','sendLoginNotification','168abNnAJ','__createBinding','getBlacklistStats','195gDYgYo','AuthController','getOwnPropertyNames','shop','json','5974MXvHuw','then','getOwnPropertyDescriptor','telegramBotService','AuthService','996327zTtZKi','Logged\x20out\x20successfully','create','108342CRsxjF','../services/authService','login','prototype','../services/tokenBlacklistService','remoteAddress','body','hasOwnProperty','5422120OkpUjP','error','ipAddress','314860EkWNbi','tokenBlacklistService','userAgent','44BYDCfx','__setModuleDefault','authService','default','length','unknown','../config/database','user','configurable','get','11499972GNBsWe','32wqtACK','defineProperty','__esModule','username','role'];a4_0x38fa=function(){return _0x108d43;};return a4_0x38fa();}const authService_1=require(a4_0xd81ca6(0x16d)),tokenBlacklistService_1=require(a4_0xd81ca6(0x170)),telegramBotService_1=require('../services/telegramBotService');class AuthController{constructor(){const _0x2a909f=a4_0xd81ca6;this[_0x2a909f(0x16e)]=async(_0x18e827,_0x397315,_0xee0a2d)=>{const _0x13de4c=_0x2a909f;try{const _0x1cd76a=_0x18e827[_0x13de4c(0x172)],_0x570ab9=_0x1cd76a[_0x13de4c(0x176)]||_0x18e827['ip']||_0x18e827['connection'][_0x13de4c(0x171)]||_0x13de4c(0x17f),_0x422680=_0x1cd76a[_0x13de4c(0x179)]||_0x18e827[_0x13de4c(0x183)](_0x13de4c(0x156))||_0x13de4c(0x17f),_0x12e40c=_0x1cd76a['geo'];let _0x5e648d=![],_0x2fd328=null;try{const _0xd68a23=await this[_0x13de4c(0x17c)][_0x13de4c(0x16e)](_0x1cd76a);_0x5e648d=!![],_0xd68a23[_0x13de4c(0x155)]===_0x13de4c(0x162)&&_0xd68a23['user']?.['id']&&(_0x2fd328=_0xd68a23[_0x13de4c(0x181)]['id']),_0x2fd328&&await telegramBotService_1['telegramBotService'][_0x13de4c(0x15b)](_0x2fd328,{'username':_0x1cd76a[_0x13de4c(0x188)],'ipAddress':_0x570ab9,'userAgent':_0x422680,'geo':_0x12e40c,'timestamp':new Date(),'success':!![]}),_0x397315['json']({'success':!![],'result':_0xd68a23});}catch(_0x3221f9){try{const _0x285c54=(await Promise['resolve']()[_0x13de4c(0x165)](()=>__importStar(require(_0x13de4c(0x180)))))[_0x13de4c(0x17d)],_0x1520cd=await _0x285c54[_0x13de4c(0x162)]['findUnique']({'where':{'username':_0x1cd76a[_0x13de4c(0x188)]},'select':{'id':!![]}});_0x1520cd&&await telegramBotService_1[_0x13de4c(0x167)][_0x13de4c(0x15b)](_0x1520cd['id'],{'username':_0x1cd76a['username'],'ipAddress':_0x570ab9,'userAgent':_0x422680,'geo':_0x12e40c,'timestamp':new Date(),'success':![]});}catch(_0x277672){console[_0x13de4c(0x175)]('Failed\x20to\x20send\x20failed\x20login\x20notification:',_0x277672);}throw _0x3221f9;}}catch(_0x6cb1b6){_0xee0a2d(_0x6cb1b6);}},this['me']=async(_0x1e96e6,_0x4cf6b5,_0x311483)=>{const _0x2e24ba=_0x2a909f;try{const _0x2878b4=_0x1e96e6[_0x2e24ba(0x181)];_0x4cf6b5[_0x2e24ba(0x163)]({'success':!![],'result':{'id':_0x2878b4?.['id'],'username':_0x2878b4?.['username'],'role':_0x2878b4?.[_0x2e24ba(0x155)]}});}catch(_0x3c40f7){_0x311483(_0x3c40f7);}},this['logout']=async(_0x390606,_0x4d9087,_0x989ccb)=>{const _0xf1ad9d=_0x2a909f;try{const _0x554b1a=_0x390606['token'],_0x22f278=_0x390606[_0xf1ad9d(0x181)];_0x554b1a&&_0x22f278?.['exp']&&tokenBlacklistService_1[_0xf1ad9d(0x178)][_0xf1ad9d(0x15a)](_0x554b1a,_0x22f278['exp']),_0x4d9087['json']({'success':!![],'message':_0xf1ad9d(0x16a)});}catch(_0x4660a8){_0x989ccb(_0x4660a8);}},this[_0x2a909f(0x15e)]=async(_0x5cd36e,_0x40d9ad,_0xff7f8)=>{const _0x161f19=_0x2a909f;try{const _0x3a8e38=tokenBlacklistService_1[_0x161f19(0x178)][_0x161f19(0x158)]();_0x40d9ad[_0x161f19(0x163)]({'success':!![],'result':_0x3a8e38});}catch(_0x261d35){_0xff7f8(_0x261d35);}},this[_0x2a909f(0x17c)]=new authService_1[(_0x2a909f(0x168))]();}}exports[a4_0xd81ca6(0x160)]=AuthController;