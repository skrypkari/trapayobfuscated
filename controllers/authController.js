'use strict';const a4_0x2d16c2=a4_0x3d97;function a4_0x3d97(_0x46ca2a,_0x5f2192){const _0x349f1b=a4_0x349f();return a4_0x3d97=function(_0x3d97e0,_0x432896){_0x3d97e0=_0x3d97e0-0x8c;let _0x546a60=_0x349f1b[_0x3d97e0];return _0x546a60;},a4_0x3d97(_0x46ca2a,_0x5f2192);}(function(_0x3e7a8c,_0x368464){const _0x484b7d=a4_0x3d97,_0x3cba4a=_0x3e7a8c();while(!![]){try{const _0x4a6163=-parseInt(_0x484b7d(0x98))/0x1+-parseInt(_0x484b7d(0xa1))/0x2*(parseInt(_0x484b7d(0x95))/0x3)+-parseInt(_0x484b7d(0xab))/0x4+parseInt(_0x484b7d(0xaa))/0x5+-parseInt(_0x484b7d(0xac))/0x6+-parseInt(_0x484b7d(0xaf))/0x7*(parseInt(_0x484b7d(0xa0))/0x8)+parseInt(_0x484b7d(0xae))/0x9;if(_0x4a6163===_0x368464)break;else _0x3cba4a['push'](_0x3cba4a['shift']());}catch(_0x256da7){_0x3cba4a['push'](_0x3cba4a['shift']());}}}(a4_0x349f,0xea97f));function a4_0x349f(){const _0x328d49=['tokenBlacklistService','length','AuthController','sendLoginNotification','__setModuleDefault','Logged\x20out\x20successfully','call','__esModule','get','3681fbFeGL','create','shop','1697498uqEinF','defineProperty','blacklistToken','../services/telegramBotService','role','configurable','logout','resolve','32fIVOUH','526iFAmGQ','../services/authService','unknown','User-Agent','findUnique','getStats','authService','error','username','2440375dnEttr','7257468jtWXVC','3614658UOdMfO','default','53515449FsXPYU','1813581WCujOv','user','../config/database','getBlacklistStats','then','exp','writable','../services/tokenBlacklistService','body','telegramBotService','json','remoteAddress','prototype'];a4_0x349f=function(){return _0x328d49;};return a4_0x349f();}var __createBinding=this&&this['__createBinding']||(Object['create']?function(_0x42bbd6,_0x5ab65b,_0x42d142,_0x3342a9){const _0x4c7b46=a4_0x3d97;if(_0x3342a9===undefined)_0x3342a9=_0x42d142;var _0x41f930=Object['getOwnPropertyDescriptor'](_0x5ab65b,_0x42d142);(!_0x41f930||('get'in _0x41f930?!_0x5ab65b[_0x4c7b46(0x93)]:_0x41f930[_0x4c7b46(0xb5)]||_0x41f930[_0x4c7b46(0x9d)]))&&(_0x41f930={'enumerable':!![],'get':function(){return _0x5ab65b[_0x42d142];}}),Object[_0x4c7b46(0x99)](_0x42bbd6,_0x3342a9,_0x41f930);}:function(_0x285f43,_0x5782e7,_0x2c5903,_0x56d3eb){if(_0x56d3eb===undefined)_0x56d3eb=_0x2c5903;_0x285f43[_0x56d3eb]=_0x5782e7[_0x2c5903];}),__setModuleDefault=this&&this[a4_0x2d16c2(0x90)]||(Object[a4_0x2d16c2(0x96)]?function(_0x2b7b25,_0x5562c3){Object['defineProperty'](_0x2b7b25,'default',{'enumerable':!![],'value':_0x5562c3});}:function(_0x7bc6c3,_0x308f5c){const _0x513c9f=a4_0x2d16c2;_0x7bc6c3[_0x513c9f(0xad)]=_0x308f5c;}),__importStar=this&&this['__importStar']||(function(){var _0x268a3e=function(_0x40cdb2){return _0x268a3e=Object['getOwnPropertyNames']||function(_0x2900b0){const _0x1c3c14=a4_0x3d97;var _0x1cc408=[];for(var _0x4cd17d in _0x2900b0)if(Object[_0x1c3c14(0xbb)]['hasOwnProperty'][_0x1c3c14(0x92)](_0x2900b0,_0x4cd17d))_0x1cc408[_0x1cc408[_0x1c3c14(0x8d)]]=_0x4cd17d;return _0x1cc408;},_0x268a3e(_0x40cdb2);};return function(_0x4f13d8){const _0x2ff211=a4_0x3d97;if(_0x4f13d8&&_0x4f13d8[_0x2ff211(0x93)])return _0x4f13d8;var _0x13e4e9={};if(_0x4f13d8!=null){for(var _0x5bf8c0=_0x268a3e(_0x4f13d8),_0x9310c9=0x0;_0x9310c9<_0x5bf8c0[_0x2ff211(0x8d)];_0x9310c9++)if(_0x5bf8c0[_0x9310c9]!==_0x2ff211(0xad))__createBinding(_0x13e4e9,_0x4f13d8,_0x5bf8c0[_0x9310c9]);}return __setModuleDefault(_0x13e4e9,_0x4f13d8),_0x13e4e9;};}());Object[a4_0x2d16c2(0x99)](exports,a4_0x2d16c2(0x93),{'value':!![]}),exports[a4_0x2d16c2(0x8e)]=void 0x0;const authService_1=require(a4_0x2d16c2(0xa2)),tokenBlacklistService_1=require(a4_0x2d16c2(0xb6)),telegramBotService_1=require(a4_0x2d16c2(0x9b));class AuthController{constructor(){const _0x8fe13c=a4_0x2d16c2;this['login']=async(_0x2aad44,_0x14afd7,_0x44f5e4)=>{const _0x224599=a4_0x3d97;try{const _0x51b2e0=_0x2aad44[_0x224599(0xb7)],_0x214486=_0x2aad44['ip']||_0x2aad44['connection'][_0x224599(0xba)]||_0x224599(0xa3),_0x4d02ed=_0x2aad44[_0x224599(0x94)](_0x224599(0xa4))||_0x224599(0xa3);let _0x1a7f0d=![],_0x5054ad=null;try{const _0xa228b6=await this[_0x224599(0xa7)]['login'](_0x51b2e0);_0x1a7f0d=!![],_0xa228b6['role']==='shop'&&_0xa228b6[_0x224599(0xb0)]?.['id']&&(_0x5054ad=_0xa228b6[_0x224599(0xb0)]['id']),_0x5054ad&&await telegramBotService_1[_0x224599(0xb8)]['sendLoginNotification'](_0x5054ad,{'username':_0x51b2e0[_0x224599(0xa9)],'ipAddress':_0x214486,'userAgent':_0x4d02ed,'timestamp':new Date(),'success':!![]}),_0x14afd7[_0x224599(0xb9)]({'success':!![],'result':_0xa228b6});}catch(_0x4c24c0){try{const _0x501a2f=(await Promise[_0x224599(0x9f)]()[_0x224599(0xb3)](()=>__importStar(require(_0x224599(0xb1)))))[_0x224599(0xad)],_0x491446=await _0x501a2f[_0x224599(0x97)][_0x224599(0xa5)]({'where':{'username':_0x51b2e0['username']},'select':{'id':!![]}});_0x491446&&await telegramBotService_1[_0x224599(0xb8)][_0x224599(0x8f)](_0x491446['id'],{'username':_0x51b2e0[_0x224599(0xa9)],'ipAddress':_0x214486,'userAgent':_0x4d02ed,'timestamp':new Date(),'success':![]});}catch(_0x45d907){console[_0x224599(0xa8)]('Failed\x20to\x20send\x20failed\x20login\x20notification:',_0x45d907);}throw _0x4c24c0;}}catch(_0x3fe700){_0x44f5e4(_0x3fe700);}},this['me']=async(_0x402ae8,_0x4790b3,_0x36c62e)=>{const _0x5d4102=a4_0x3d97;try{const _0xabca30=_0x402ae8[_0x5d4102(0xb0)];_0x4790b3[_0x5d4102(0xb9)]({'success':!![],'result':{'id':_0xabca30?.['id'],'username':_0xabca30?.[_0x5d4102(0xa9)],'role':_0xabca30?.[_0x5d4102(0x9c)]}});}catch(_0x56a378){_0x36c62e(_0x56a378);}},this[_0x8fe13c(0x9e)]=async(_0x2a2c80,_0x3a48f5,_0xc48d75)=>{const _0x3065bc=_0x8fe13c;try{const _0x366aaf=_0x2a2c80['token'],_0x2b759b=_0x2a2c80[_0x3065bc(0xb0)];_0x366aaf&&_0x2b759b?.[_0x3065bc(0xb4)]&&tokenBlacklistService_1[_0x3065bc(0x8c)][_0x3065bc(0x9a)](_0x366aaf,_0x2b759b[_0x3065bc(0xb4)]),_0x3a48f5[_0x3065bc(0xb9)]({'success':!![],'message':_0x3065bc(0x91)});}catch(_0x31610b){_0xc48d75(_0x31610b);}},this[_0x8fe13c(0xb2)]=async(_0x390c3e,_0x87abbb,_0x99033c)=>{const _0x552b87=_0x8fe13c;try{const _0x2433b0=tokenBlacklistService_1['tokenBlacklistService'][_0x552b87(0xa6)]();_0x87abbb[_0x552b87(0xb9)]({'success':!![],'result':_0x2433b0});}catch(_0x2f21b2){_0x99033c(_0x2f21b2);}},this['authService']=new authService_1['AuthService']();}}exports[a4_0x2d16c2(0x8e)]=AuthController;