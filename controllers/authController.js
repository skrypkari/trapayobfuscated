'use strict';const a4_0x1ecdca=a4_0x5a61;(function(_0x8237b4,_0x2946a2){const _0x3f6ba9=a4_0x5a61,_0x4499fb=_0x8237b4();while(!![]){try{const _0x448da7=parseInt(_0x3f6ba9(0x93))/0x1*(-parseInt(_0x3f6ba9(0x80))/0x2)+-parseInt(_0x3f6ba9(0x7f))/0x3*(parseInt(_0x3f6ba9(0x7d))/0x4)+parseInt(_0x3f6ba9(0x9a))/0x5*(-parseInt(_0x3f6ba9(0x9c))/0x6)+-parseInt(_0x3f6ba9(0x95))/0x7*(parseInt(_0x3f6ba9(0x8f))/0x8)+parseInt(_0x3f6ba9(0x81))/0x9+parseInt(_0x3f6ba9(0x97))/0xa+-parseInt(_0x3f6ba9(0x9b))/0xb*(-parseInt(_0x3f6ba9(0x86))/0xc);if(_0x448da7===_0x2946a2)break;else _0x4499fb['push'](_0x4499fb['shift']());}catch(_0x3cea06){_0x4499fb['push'](_0x4499fb['shift']());}}}(a4_0xb52b,0x1c38a));var __createBinding=this&&this[a4_0x1ecdca(0x92)]||(Object[a4_0x1ecdca(0x83)]?function(_0x18dff5,_0x24d976,_0x2f35c2,_0x170e68){const _0x12fdf6=a4_0x1ecdca;if(_0x170e68===undefined)_0x170e68=_0x2f35c2;var _0x38e118=Object[_0x12fdf6(0x77)](_0x24d976,_0x2f35c2);(!_0x38e118||(_0x12fdf6(0x8e)in _0x38e118?!_0x24d976['__esModule']:_0x38e118[_0x12fdf6(0x79)]||_0x38e118['configurable']))&&(_0x38e118={'enumerable':!![],'get':function(){return _0x24d976[_0x2f35c2];}}),Object[_0x12fdf6(0x72)](_0x18dff5,_0x170e68,_0x38e118);}:function(_0xe10140,_0x1c2f2c,_0x2f352c,_0x274866){if(_0x274866===undefined)_0x274866=_0x2f352c;_0xe10140[_0x274866]=_0x1c2f2c[_0x2f352c];}),__setModuleDefault=this&&this[a4_0x1ecdca(0x7c)]||(Object['create']?function(_0x4a760e,_0x3b15ff){const _0x97c2f3=a4_0x1ecdca;Object['defineProperty'](_0x4a760e,_0x97c2f3(0x8d),{'enumerable':!![],'value':_0x3b15ff});}:function(_0x566221,_0x231047){_0x566221['default']=_0x231047;}),__importStar=this&&this['__importStar']||(function(){var _0x47c29c=function(_0x5c8667){const _0x4c2f48=a4_0x5a61;return _0x47c29c=Object[_0x4c2f48(0x99)]||function(_0x123f6e){const _0x53d86f=_0x4c2f48;var _0x1fee31=[];for(var _0xd300b1 in _0x123f6e)if(Object[_0x53d86f(0x8c)][_0x53d86f(0x91)][_0x53d86f(0x7b)](_0x123f6e,_0xd300b1))_0x1fee31[_0x1fee31[_0x53d86f(0x9d)]]=_0xd300b1;return _0x1fee31;},_0x47c29c(_0x5c8667);};return function(_0x27b53b){const _0x2e9bb9=a4_0x5a61;if(_0x27b53b&&_0x27b53b[_0x2e9bb9(0x78)])return _0x27b53b;var _0x582031={};if(_0x27b53b!=null){for(var _0x5b69d5=_0x47c29c(_0x27b53b),_0x2d43a2=0x0;_0x2d43a2<_0x5b69d5[_0x2e9bb9(0x9d)];_0x2d43a2++)if(_0x5b69d5[_0x2d43a2]!==_0x2e9bb9(0x8d))__createBinding(_0x582031,_0x27b53b,_0x5b69d5[_0x2d43a2]);}return __setModuleDefault(_0x582031,_0x27b53b),_0x582031;};}());function a4_0x5a61(_0x31bf27,_0x34a54f){const _0xb52b95=a4_0xb52b();return a4_0x5a61=function(_0x5a61bc,_0x584236){_0x5a61bc=_0x5a61bc-0x6f;let _0x74c5de=_0xb52b95[_0x5a61bc];return _0x74c5de;},a4_0x5a61(_0x31bf27,_0x34a54f);}Object[a4_0x1ecdca(0x72)](exports,a4_0x1ecdca(0x78),{'value':!![]}),exports[a4_0x1ecdca(0x7a)]=void 0x0;const authService_1=require(a4_0x1ecdca(0x90)),tokenBlacklistService_1=require('../services/tokenBlacklistService'),telegramBotService_1=require(a4_0x1ecdca(0x85));function a4_0xb52b(){const _0x33fe0c=['get','8VGpxdR','../services/authService','hasOwnProperty','__createBinding','17007UOpdbv','then','907193DaKFHs','unknown','895120qayapA','exp','getOwnPropertyNames','5ALPkmm','2149037JPpdjp','715854uPztxv','length','tokenBlacklistService','logout','connection','user','defineProperty','Failed\x20to\x20send\x20failed\x20login\x20notification:','username','telegramBotService','json','getOwnPropertyDescriptor','__esModule','writable','AuthController','call','__setModuleDefault','464sNlmZw','login','849uJUpVT','6NqzwJJ','1471248YxwBLA','body','create','resolve','../services/telegramBotService','12ShDcRV','remoteAddress','authService','getStats','shop','role','prototype','default'];a4_0xb52b=function(){return _0x33fe0c;};return a4_0xb52b();}class AuthController{constructor(){const _0x5775d9=a4_0x1ecdca;this[_0x5775d9(0x7e)]=async(_0x371fa8,_0x36d428,_0x1e5fa2)=>{const _0x2f349b=_0x5775d9;try{const _0x8e6b38=_0x371fa8[_0x2f349b(0x82)],_0x471035=_0x371fa8['ip']||_0x371fa8[_0x2f349b(0x70)][_0x2f349b(0x87)]||_0x2f349b(0x96),_0x10b43b=_0x371fa8[_0x2f349b(0x8e)]('User-Agent')||'unknown';let _0x5901da=![],_0x14ebeb=null;try{const _0x275b30=await this[_0x2f349b(0x88)][_0x2f349b(0x7e)](_0x8e6b38);_0x5901da=!![],_0x275b30[_0x2f349b(0x8b)]===_0x2f349b(0x8a)&&_0x275b30[_0x2f349b(0x71)]?.['id']&&(_0x14ebeb=_0x275b30['user']['id']),_0x14ebeb&&await telegramBotService_1[_0x2f349b(0x75)]['sendLoginNotification'](_0x14ebeb,{'username':_0x8e6b38[_0x2f349b(0x74)],'ipAddress':_0x471035,'userAgent':_0x10b43b,'timestamp':new Date(),'success':!![]}),_0x36d428['json']({'success':!![],'result':_0x275b30});}catch(_0x47ca6c){try{const _0x114ea3=(await Promise[_0x2f349b(0x84)]()[_0x2f349b(0x94)](()=>__importStar(require('../config/database'))))[_0x2f349b(0x8d)],_0x173ea8=await _0x114ea3[_0x2f349b(0x8a)]['findUnique']({'where':{'username':_0x8e6b38['username']},'select':{'id':!![]}});_0x173ea8&&await telegramBotService_1[_0x2f349b(0x75)]['sendLoginNotification'](_0x173ea8['id'],{'username':_0x8e6b38[_0x2f349b(0x74)],'ipAddress':_0x471035,'userAgent':_0x10b43b,'timestamp':new Date(),'success':![]});}catch(_0x4d1a27){console['error'](_0x2f349b(0x73),_0x4d1a27);}throw _0x47ca6c;}}catch(_0x1ed4db){_0x1e5fa2(_0x1ed4db);}},this['me']=async(_0x2a45a2,_0x337164,_0x16a122)=>{const _0x402409=_0x5775d9;try{const _0x347e9f=_0x2a45a2[_0x402409(0x71)];_0x337164['json']({'success':!![],'result':{'id':_0x347e9f?.['id'],'username':_0x347e9f?.[_0x402409(0x74)],'role':_0x347e9f?.['role']}});}catch(_0x2ed60f){_0x16a122(_0x2ed60f);}},this[_0x5775d9(0x6f)]=async(_0x456d4d,_0x3fef23,_0x1f74c6)=>{const _0x105509=_0x5775d9;try{const _0x4ddcae=_0x456d4d['token'],_0x58778e=_0x456d4d[_0x105509(0x71)];_0x4ddcae&&_0x58778e?.['exp']&&tokenBlacklistService_1[_0x105509(0x9e)]['blacklistToken'](_0x4ddcae,_0x58778e[_0x105509(0x98)]),_0x3fef23[_0x105509(0x76)]({'success':!![],'message':'Logged\x20out\x20successfully'});}catch(_0x138189){_0x1f74c6(_0x138189);}},this['getBlacklistStats']=async(_0x23d852,_0x39d9e3,_0xc9ae82)=>{const _0x281cf9=_0x5775d9;try{const _0x392e42=tokenBlacklistService_1[_0x281cf9(0x9e)][_0x281cf9(0x89)]();_0x39d9e3[_0x281cf9(0x76)]({'success':!![],'result':_0x392e42});}catch(_0x4dc2d7){_0xc9ae82(_0x4dc2d7);}},this['authService']=new authService_1['AuthService']();}}exports[a4_0x1ecdca(0x7a)]=AuthController;