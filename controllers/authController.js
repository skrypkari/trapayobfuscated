'use strict';const a4_0x4b9422=a4_0x3709;function a4_0x3709(_0x1d3280,_0x436381){const _0x5dae72=a4_0x5dae();return a4_0x3709=function(_0x370927,_0x2367f3){_0x370927=_0x370927-0x128;let _0x16f9b3=_0x5dae72[_0x370927];return _0x16f9b3;},a4_0x3709(_0x1d3280,_0x436381);}(function(_0x61f97d,_0x5bfb70){const _0x1e59de=a4_0x3709,_0x345624=_0x61f97d();while(!![]){try{const _0xcc8a92=parseInt(_0x1e59de(0x14f))/0x1+-parseInt(_0x1e59de(0x157))/0x2*(parseInt(_0x1e59de(0x14b))/0x3)+parseInt(_0x1e59de(0x12c))/0x4*(-parseInt(_0x1e59de(0x140))/0x5)+-parseInt(_0x1e59de(0x147))/0x6*(-parseInt(_0x1e59de(0x153))/0x7)+-parseInt(_0x1e59de(0x133))/0x8*(parseInt(_0x1e59de(0x12d))/0x9)+-parseInt(_0x1e59de(0x12e))/0xa+parseInt(_0x1e59de(0x14a))/0xb;if(_0xcc8a92===_0x5bfb70)break;else _0x345624['push'](_0x345624['shift']());}catch(_0x1447dd){_0x345624['push'](_0x345624['shift']());}}}(a4_0x5dae,0x5c857));function a4_0x5dae(){const _0x1c8a56=['unknown','username','remoteAddress','__createBinding','hasOwnProperty','AuthController','getBlacklistStats','__esModule','getOwnPropertyDescriptor','create','22992UooQEg','81INXfOI','1552540AyKUgC','resolve','__setModuleDefault','role','authService','449320CnfrTv','token','call','defineProperty','Logged\x20out\x20successfully','user','sendLoginNotification','prototype','default','configurable','shop','exp','error','415lcUftD','Failed\x20to\x20send\x20failed\x20login\x20notification:','length','../config/database','../services/telegramBotService','tokenBlacklistService','get','438654VIZIpo','connection','__importStar','11466554NOGkQB','123YXNvBQ','writable','telegramBotService','getOwnPropertyNames','405636JplcKp','logout','../services/authService','body','28unSjBe','login','json','then','10912HPiFIy'];a4_0x5dae=function(){return _0x1c8a56;};return a4_0x5dae();}var __createBinding=this&&this[a4_0x4b9422(0x15b)]||(Object[a4_0x4b9422(0x12b)]?function(_0x2b0bc1,_0xd1988,_0x3644f5,_0xd45995){const _0x41b4c3=a4_0x4b9422;if(_0xd45995===undefined)_0xd45995=_0x3644f5;var _0xca3351=Object[_0x41b4c3(0x12a)](_0xd1988,_0x3644f5);(!_0xca3351||(_0x41b4c3(0x146)in _0xca3351?!_0xd1988['__esModule']:_0xca3351[_0x41b4c3(0x14c)]||_0xca3351[_0x41b4c3(0x13c)]))&&(_0xca3351={'enumerable':!![],'get':function(){return _0xd1988[_0x3644f5];}}),Object[_0x41b4c3(0x136)](_0x2b0bc1,_0xd45995,_0xca3351);}:function(_0x4ea212,_0xe10425,_0x19d7b9,_0x4bfd3f){if(_0x4bfd3f===undefined)_0x4bfd3f=_0x19d7b9;_0x4ea212[_0x4bfd3f]=_0xe10425[_0x19d7b9];}),__setModuleDefault=this&&this[a4_0x4b9422(0x130)]||(Object[a4_0x4b9422(0x12b)]?function(_0x30fbef,_0x1de693){const _0x3d7f1d=a4_0x4b9422;Object[_0x3d7f1d(0x136)](_0x30fbef,'default',{'enumerable':!![],'value':_0x1de693});}:function(_0x2e1776,_0xe3bae3){_0x2e1776['default']=_0xe3bae3;}),__importStar=this&&this[a4_0x4b9422(0x149)]||(function(){var _0x43ef35=function(_0xfd655b){const _0x109fda=a4_0x3709;return _0x43ef35=Object[_0x109fda(0x14e)]||function(_0x1dfe53){const _0x103985=_0x109fda;var _0x271366=[];for(var _0x45fa12 in _0x1dfe53)if(Object[_0x103985(0x13a)][_0x103985(0x15c)][_0x103985(0x135)](_0x1dfe53,_0x45fa12))_0x271366[_0x271366[_0x103985(0x142)]]=_0x45fa12;return _0x271366;},_0x43ef35(_0xfd655b);};return function(_0x5c0e99){const _0x59b6d3=a4_0x3709;if(_0x5c0e99&&_0x5c0e99[_0x59b6d3(0x129)])return _0x5c0e99;var _0x2ae38d={};if(_0x5c0e99!=null){for(var _0x22773e=_0x43ef35(_0x5c0e99),_0x1cc46c=0x0;_0x1cc46c<_0x22773e[_0x59b6d3(0x142)];_0x1cc46c++)if(_0x22773e[_0x1cc46c]!==_0x59b6d3(0x13b))__createBinding(_0x2ae38d,_0x5c0e99,_0x22773e[_0x1cc46c]);}return __setModuleDefault(_0x2ae38d,_0x5c0e99),_0x2ae38d;};}());Object['defineProperty'](exports,a4_0x4b9422(0x129),{'value':!![]}),exports[a4_0x4b9422(0x15d)]=void 0x0;const authService_1=require(a4_0x4b9422(0x151)),tokenBlacklistService_1=require('../services/tokenBlacklistService'),telegramBotService_1=require(a4_0x4b9422(0x144));class AuthController{constructor(){const _0x396dd6=a4_0x4b9422;this[_0x396dd6(0x154)]=async(_0x20887e,_0x3dd5b1,_0x16e18d)=>{const _0x2a2829=_0x396dd6;try{const _0x24d92d=_0x20887e[_0x2a2829(0x152)],_0x518c10=_0x20887e['ip']||_0x20887e[_0x2a2829(0x148)][_0x2a2829(0x15a)]||_0x2a2829(0x158),_0x51a75f=_0x20887e[_0x2a2829(0x146)]('User-Agent')||_0x2a2829(0x158);let _0x5791e1=![],_0x308d40=null;try{const _0x434db3=await this[_0x2a2829(0x132)][_0x2a2829(0x154)](_0x24d92d);_0x5791e1=!![],_0x434db3['role']===_0x2a2829(0x13d)&&_0x434db3['user']?.['id']&&(_0x308d40=_0x434db3['user']['id']),_0x308d40&&await telegramBotService_1[_0x2a2829(0x14d)][_0x2a2829(0x139)](_0x308d40,{'username':_0x24d92d[_0x2a2829(0x159)],'ipAddress':_0x518c10,'userAgent':_0x51a75f,'timestamp':new Date(),'success':!![]}),_0x3dd5b1[_0x2a2829(0x155)]({'success':!![],'result':_0x434db3});}catch(_0x22c6ff){try{const _0x24d492=(await Promise[_0x2a2829(0x12f)]()[_0x2a2829(0x156)](()=>__importStar(require(_0x2a2829(0x143)))))[_0x2a2829(0x13b)],_0x3a0f69=await _0x24d492['shop']['findUnique']({'where':{'username':_0x24d92d[_0x2a2829(0x159)]},'select':{'id':!![]}});_0x3a0f69&&await telegramBotService_1[_0x2a2829(0x14d)][_0x2a2829(0x139)](_0x3a0f69['id'],{'username':_0x24d92d[_0x2a2829(0x159)],'ipAddress':_0x518c10,'userAgent':_0x51a75f,'timestamp':new Date(),'success':![]});}catch(_0x540b43){console[_0x2a2829(0x13f)](_0x2a2829(0x141),_0x540b43);}throw _0x22c6ff;}}catch(_0x5695c0){_0x16e18d(_0x5695c0);}},this['me']=async(_0x2c335c,_0x2838f0,_0x155759)=>{const _0x25a900=_0x396dd6;try{const _0x219385=_0x2c335c[_0x25a900(0x138)];_0x2838f0[_0x25a900(0x155)]({'success':!![],'result':{'id':_0x219385?.['id'],'username':_0x219385?.['username'],'role':_0x219385?.[_0x25a900(0x131)]}});}catch(_0x2d9e7f){_0x155759(_0x2d9e7f);}},this[_0x396dd6(0x150)]=async(_0x297684,_0x283d4e,_0x5a4325)=>{const _0x3f3db8=_0x396dd6;try{const _0x131acd=_0x297684[_0x3f3db8(0x134)],_0x30e53d=_0x297684[_0x3f3db8(0x138)];_0x131acd&&_0x30e53d?.['exp']&&tokenBlacklistService_1[_0x3f3db8(0x145)]['blacklistToken'](_0x131acd,_0x30e53d[_0x3f3db8(0x13e)]),_0x283d4e[_0x3f3db8(0x155)]({'success':!![],'message':_0x3f3db8(0x137)});}catch(_0x49fd7b){_0x5a4325(_0x49fd7b);}},this[_0x396dd6(0x128)]=async(_0xa77184,_0x52edd9,_0x29ed08)=>{const _0xc9e1c0=_0x396dd6;try{const _0x3a85b4=tokenBlacklistService_1[_0xc9e1c0(0x145)]['getStats']();_0x52edd9[_0xc9e1c0(0x155)]({'success':!![],'result':_0x3a85b4});}catch(_0xe63777){_0x29ed08(_0xe63777);}},this['authService']=new authService_1['AuthService']();}}exports[a4_0x4b9422(0x15d)]=AuthController;