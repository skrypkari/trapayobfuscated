'use strict';function a4_0x202c(){const _0x3bc5fd=['get','then','error','../config/database','logout','getBlacklistStats','findUnique','unknown','length','exp','create','blacklistToken','__createBinding','980028rmwawh','../services/tokenBlacklistService','AuthController','getStats','286jrrxiF','Logged\x20out\x20successfully','getOwnPropertyNames','sendLoginNotification','resolve','default','json','18sPqpXZ','defineProperty','../services/authService','__setModuleDefault','__importStar','login','211570cBmMJZ','__esModule','AuthService','../services/telegramBotService','hasOwnProperty','authService','username','65xiaOze','connection','token','164700qvnoRO','319DoepHb','23678sgoVHC','tokenBlacklistService','shop','user','628117iwAlAK','call','255SSwFba','88yrVxdD','User-Agent','telegramBotService','writable','2142357hqDGkP','432207UtQSRM','role'];a4_0x202c=function(){return _0x3bc5fd;};return a4_0x202c();}const a4_0x4b2de8=a4_0x4a1a;(function(_0x5db020,_0x2df685){const _0x22e9a9=a4_0x4a1a,_0x3df41e=_0x5db020();while(!![]){try{const _0x4c75af=-parseInt(_0x22e9a9(0x207))/0x1+parseInt(_0x22e9a9(0x203))/0x2*(parseInt(_0x22e9a9(0x209))/0x3)+parseInt(_0x22e9a9(0x201))/0x4*(parseInt(_0x22e9a9(0x1fe))/0x5)+-parseInt(_0x22e9a9(0x1f1))/0x6*(parseInt(_0x22e9a9(0x1d6))/0x7)+parseInt(_0x22e9a9(0x20a))/0x8*(-parseInt(_0x22e9a9(0x1d7))/0x9)+-parseInt(_0x22e9a9(0x1f7))/0xa*(parseInt(_0x22e9a9(0x202))/0xb)+-parseInt(_0x22e9a9(0x1e6))/0xc*(-parseInt(_0x22e9a9(0x1ea))/0xd);if(_0x4c75af===_0x2df685)break;else _0x3df41e['push'](_0x3df41e['shift']());}catch(_0x4652e1){_0x3df41e['push'](_0x3df41e['shift']());}}}(a4_0x202c,0x9ebf8));var __createBinding=this&&this[a4_0x4b2de8(0x1e5)]||(Object[a4_0x4b2de8(0x1e3)]?function(_0x2f20ca,_0x2138c3,_0x59eb33,_0x41d757){const _0x31246e=a4_0x4b2de8;if(_0x41d757===undefined)_0x41d757=_0x59eb33;var _0x275ffa=Object['getOwnPropertyDescriptor'](_0x2138c3,_0x59eb33);(!_0x275ffa||(_0x31246e(0x1d9)in _0x275ffa?!_0x2138c3[_0x31246e(0x1f8)]:_0x275ffa[_0x31246e(0x20d)]||_0x275ffa['configurable']))&&(_0x275ffa={'enumerable':!![],'get':function(){return _0x2138c3[_0x59eb33];}}),Object['defineProperty'](_0x2f20ca,_0x41d757,_0x275ffa);}:function(_0x2b1f3f,_0x2d7f07,_0xaa7fc3,_0x392910){if(_0x392910===undefined)_0x392910=_0xaa7fc3;_0x2b1f3f[_0x392910]=_0x2d7f07[_0xaa7fc3];}),__setModuleDefault=this&&this[a4_0x4b2de8(0x1f4)]||(Object[a4_0x4b2de8(0x1e3)]?function(_0x1d5c08,_0x2f176c){const _0x2f1a23=a4_0x4b2de8;Object[_0x2f1a23(0x1f2)](_0x1d5c08,'default',{'enumerable':!![],'value':_0x2f176c});}:function(_0x327f4a,_0x283b98){const _0x570021=a4_0x4b2de8;_0x327f4a[_0x570021(0x1ef)]=_0x283b98;}),__importStar=this&&this[a4_0x4b2de8(0x1f5)]||(function(){var _0x26dde1=function(_0x51a1aa){const _0x9a99b0=a4_0x4a1a;return _0x26dde1=Object[_0x9a99b0(0x1ec)]||function(_0x415876){const _0x18bdf6=_0x9a99b0;var _0x2d4ebb=[];for(var _0x9da7c8 in _0x415876)if(Object['prototype'][_0x18bdf6(0x1fb)][_0x18bdf6(0x208)](_0x415876,_0x9da7c8))_0x2d4ebb[_0x2d4ebb['length']]=_0x9da7c8;return _0x2d4ebb;},_0x26dde1(_0x51a1aa);};return function(_0x2bfeff){const _0x2d9fe7=a4_0x4a1a;if(_0x2bfeff&&_0x2bfeff[_0x2d9fe7(0x1f8)])return _0x2bfeff;var _0x11b9b6={};if(_0x2bfeff!=null){for(var _0x586cbb=_0x26dde1(_0x2bfeff),_0x5e9678=0x0;_0x5e9678<_0x586cbb[_0x2d9fe7(0x1e1)];_0x5e9678++)if(_0x586cbb[_0x5e9678]!==_0x2d9fe7(0x1ef))__createBinding(_0x11b9b6,_0x2bfeff,_0x586cbb[_0x5e9678]);}return __setModuleDefault(_0x11b9b6,_0x2bfeff),_0x11b9b6;};}());function a4_0x4a1a(_0x3e1d48,_0x61c084){const _0x202c55=a4_0x202c();return a4_0x4a1a=function(_0x4a1a64,_0x4570e1){_0x4a1a64=_0x4a1a64-0x1d6;let _0x96ee89=_0x202c55[_0x4a1a64];return _0x96ee89;},a4_0x4a1a(_0x3e1d48,_0x61c084);}Object['defineProperty'](exports,a4_0x4b2de8(0x1f8),{'value':!![]}),exports[a4_0x4b2de8(0x1e8)]=void 0x0;const authService_1=require(a4_0x4b2de8(0x1f3)),tokenBlacklistService_1=require(a4_0x4b2de8(0x1e7)),telegramBotService_1=require(a4_0x4b2de8(0x1fa));class AuthController{constructor(){const _0x318660=a4_0x4b2de8;this[_0x318660(0x1f6)]=async(_0x310fd9,_0x4254e0,_0x5e2de3)=>{const _0x3d873f=_0x318660;try{const _0x1c6950=_0x310fd9['body'],_0x4c8355=_0x310fd9['ip']||_0x310fd9[_0x3d873f(0x1ff)]['remoteAddress']||_0x3d873f(0x1e0),_0x340964=_0x310fd9[_0x3d873f(0x1d9)](_0x3d873f(0x20b))||'unknown';let _0x45ea7e=![],_0x38a7d1=null;try{const _0x1330c3=await this[_0x3d873f(0x1fc)][_0x3d873f(0x1f6)](_0x1c6950);_0x45ea7e=!![],_0x1330c3[_0x3d873f(0x1d8)]===_0x3d873f(0x205)&&_0x1330c3[_0x3d873f(0x206)]?.['id']&&(_0x38a7d1=_0x1330c3[_0x3d873f(0x206)]['id']),_0x38a7d1&&await telegramBotService_1[_0x3d873f(0x20c)][_0x3d873f(0x1ed)](_0x38a7d1,{'username':_0x1c6950[_0x3d873f(0x1fd)],'ipAddress':_0x4c8355,'userAgent':_0x340964,'timestamp':new Date(),'success':!![]}),_0x4254e0['json']({'success':!![],'result':_0x1330c3});}catch(_0x38bdfc){try{const _0x280a94=(await Promise[_0x3d873f(0x1ee)]()[_0x3d873f(0x1da)](()=>__importStar(require(_0x3d873f(0x1dc)))))[_0x3d873f(0x1ef)],_0x6ad646=await _0x280a94[_0x3d873f(0x205)][_0x3d873f(0x1df)]({'where':{'username':_0x1c6950['username']},'select':{'id':!![]}});_0x6ad646&&await telegramBotService_1['telegramBotService']['sendLoginNotification'](_0x6ad646['id'],{'username':_0x1c6950[_0x3d873f(0x1fd)],'ipAddress':_0x4c8355,'userAgent':_0x340964,'timestamp':new Date(),'success':![]});}catch(_0x2e04fb){console[_0x3d873f(0x1db)]('Failed\x20to\x20send\x20failed\x20login\x20notification:',_0x2e04fb);}throw _0x38bdfc;}}catch(_0x20ca3c){_0x5e2de3(_0x20ca3c);}},this['me']=async(_0x51cbea,_0x181da1,_0x5a6461)=>{const _0x2b0201=_0x318660;try{const _0x4219a6=_0x51cbea[_0x2b0201(0x206)];_0x181da1[_0x2b0201(0x1f0)]({'success':!![],'result':{'id':_0x4219a6?.['id'],'username':_0x4219a6?.[_0x2b0201(0x1fd)],'role':_0x4219a6?.['role']}});}catch(_0x14fe67){_0x5a6461(_0x14fe67);}},this[_0x318660(0x1dd)]=async(_0x18e6b2,_0x4c2fa2,_0x45bd17)=>{const _0x5f2133=_0x318660;try{const _0x3e85cd=_0x18e6b2[_0x5f2133(0x200)],_0x5fb6e8=_0x18e6b2[_0x5f2133(0x206)];_0x3e85cd&&_0x5fb6e8?.[_0x5f2133(0x1e2)]&&tokenBlacklistService_1[_0x5f2133(0x204)][_0x5f2133(0x1e4)](_0x3e85cd,_0x5fb6e8[_0x5f2133(0x1e2)]),_0x4c2fa2['json']({'success':!![],'message':_0x5f2133(0x1eb)});}catch(_0x4e22d6){_0x45bd17(_0x4e22d6);}},this[_0x318660(0x1de)]=async(_0x542a7e,_0x3fac21,_0x27db43)=>{const _0x563a1e=_0x318660;try{const _0x43989d=tokenBlacklistService_1[_0x563a1e(0x204)][_0x563a1e(0x1e9)]();_0x3fac21[_0x563a1e(0x1f0)]({'success':!![],'result':_0x43989d});}catch(_0x57bd7c){_0x27db43(_0x57bd7c);}},this[_0x318660(0x1fc)]=new authService_1[(_0x318660(0x1f9))]();}}exports[a4_0x4b2de8(0x1e8)]=AuthController;