'use strict';function a4_0x4a0c(_0x8fa6a0,_0x76512c){const _0x28f514=a4_0x28f5();return a4_0x4a0c=function(_0x4a0c15,_0x3e08de){_0x4a0c15=_0x4a0c15-0x108;let _0xb41802=_0x28f514[_0x4a0c15];return _0xb41802;},a4_0x4a0c(_0x8fa6a0,_0x76512c);}const a4_0x15f0a8=a4_0x4a0c;(function(_0x2f2d87,_0x545b45){const _0x20c827=a4_0x4a0c,_0x25b75d=_0x2f2d87();while(!![]){try{const _0x190b3d=parseInt(_0x20c827(0x13a))/0x1*(parseInt(_0x20c827(0x13c))/0x2)+-parseInt(_0x20c827(0x117))/0x3+-parseInt(_0x20c827(0x125))/0x4+-parseInt(_0x20c827(0x11c))/0x5*(-parseInt(_0x20c827(0x135))/0x6)+parseInt(_0x20c827(0x112))/0x7*(parseInt(_0x20c827(0x11d))/0x8)+-parseInt(_0x20c827(0x10d))/0x9*(-parseInt(_0x20c827(0x12a))/0xa)+-parseInt(_0x20c827(0x11e))/0xb*(-parseInt(_0x20c827(0x12e))/0xc);if(_0x190b3d===_0x545b45)break;else _0x25b75d['push'](_0x25b75d['shift']());}catch(_0x3f7de2){_0x25b75d['push'](_0x25b75d['shift']());}}}(a4_0x28f5,0x96754));var __createBinding=this&&this[a4_0x15f0a8(0x11a)]||(Object['create']?function(_0x4ee720,_0x28c408,_0x1e41ab,_0x2e56bb){const _0x5734eb=a4_0x15f0a8;if(_0x2e56bb===undefined)_0x2e56bb=_0x1e41ab;var _0x49642e=Object['getOwnPropertyDescriptor'](_0x28c408,_0x1e41ab);(!_0x49642e||('get'in _0x49642e?!_0x28c408[_0x5734eb(0x10b)]:_0x49642e[_0x5734eb(0x131)]||_0x49642e[_0x5734eb(0x121)]))&&(_0x49642e={'enumerable':!![],'get':function(){return _0x28c408[_0x1e41ab];}}),Object[_0x5734eb(0x12d)](_0x4ee720,_0x2e56bb,_0x49642e);}:function(_0x11bc5d,_0x483685,_0x4faa36,_0x1d52a2){if(_0x1d52a2===undefined)_0x1d52a2=_0x4faa36;_0x11bc5d[_0x1d52a2]=_0x483685[_0x4faa36];}),__setModuleDefault=this&&this[a4_0x15f0a8(0x132)]||(Object[a4_0x15f0a8(0x120)]?function(_0x9cb6ac,_0x30169a){const _0x31df10=a4_0x15f0a8;Object[_0x31df10(0x12d)](_0x9cb6ac,_0x31df10(0x137),{'enumerable':!![],'value':_0x30169a});}:function(_0x4c4d83,_0x3697e7){const _0x261e40=a4_0x15f0a8;_0x4c4d83[_0x261e40(0x137)]=_0x3697e7;}),__importStar=this&&this[a4_0x15f0a8(0x11f)]||(function(){var _0x4262a1=function(_0x383b50){return _0x4262a1=Object['getOwnPropertyNames']||function(_0x2c13ec){const _0x12cb61=a4_0x4a0c;var _0x54e291=[];for(var _0x2eef80 in _0x2c13ec)if(Object[_0x12cb61(0x12c)][_0x12cb61(0x123)][_0x12cb61(0x133)](_0x2c13ec,_0x2eef80))_0x54e291[_0x54e291[_0x12cb61(0x124)]]=_0x2eef80;return _0x54e291;},_0x4262a1(_0x383b50);};return function(_0x52dc83){const _0x810a28=a4_0x4a0c;if(_0x52dc83&&_0x52dc83['__esModule'])return _0x52dc83;var _0x59d5aa={};if(_0x52dc83!=null){for(var _0x3149b5=_0x4262a1(_0x52dc83),_0x893e2c=0x0;_0x893e2c<_0x3149b5[_0x810a28(0x124)];_0x893e2c++)if(_0x3149b5[_0x893e2c]!==_0x810a28(0x137))__createBinding(_0x59d5aa,_0x52dc83,_0x3149b5[_0x893e2c]);}return __setModuleDefault(_0x59d5aa,_0x52dc83),_0x59d5aa;};}());function a4_0x28f5(){const _0x1b5490=['role','token','../services/telegramBotService','getStats','1310eDxJYi','shop','prototype','defineProperty','252ZHodAU','findUnique','then','writable','__setModuleDefault','call','AuthController','167958iRXSDh','logout','default','AuthService','User-Agent','37RbxIml','username','42982RlAFeb','json','../services/tokenBlacklistService','unknown','__esModule','remoteAddress','1035UHvEho','Logged\x20out\x20successfully','getBlacklistStats','error','blacklistToken','112WQRCvD','exp','user','authService','telegramBotService','1581543ZqhxKt','get','login','__createBinding','sendLoginNotification','5XvIEpn','30904rtbroa','426635nAwSyo','__importStar','create','configurable','tokenBlacklistService','hasOwnProperty','length','2284244haDsPg'];a4_0x28f5=function(){return _0x1b5490;};return a4_0x28f5();}Object[a4_0x15f0a8(0x12d)](exports,a4_0x15f0a8(0x10b),{'value':!![]}),exports[a4_0x15f0a8(0x134)]=void 0x0;const authService_1=require('../services/authService'),tokenBlacklistService_1=require(a4_0x15f0a8(0x109)),telegramBotService_1=require(a4_0x15f0a8(0x128));class AuthController{constructor(){const _0x28ad25=a4_0x15f0a8;this[_0x28ad25(0x119)]=async(_0x55fe0b,_0x11c2eb,_0x53b98e)=>{const _0x594f52=_0x28ad25;try{const _0x300ab7=_0x55fe0b['body'],_0x42a3a4=_0x55fe0b['ip']||_0x55fe0b['connection'][_0x594f52(0x10c)]||_0x594f52(0x10a),_0x4f3c15=_0x55fe0b[_0x594f52(0x118)](_0x594f52(0x139))||'unknown';let _0x1c9d00=![],_0x22adc4=null;try{const _0x2e6fa8=await this[_0x594f52(0x115)][_0x594f52(0x119)](_0x300ab7);_0x1c9d00=!![],_0x2e6fa8[_0x594f52(0x126)]===_0x594f52(0x12b)&&_0x2e6fa8[_0x594f52(0x114)]?.['id']&&(_0x22adc4=_0x2e6fa8['user']['id']),_0x22adc4&&await telegramBotService_1[_0x594f52(0x116)][_0x594f52(0x11b)](_0x22adc4,{'username':_0x300ab7[_0x594f52(0x13b)],'ipAddress':_0x42a3a4,'userAgent':_0x4f3c15,'timestamp':new Date(),'success':!![]}),_0x11c2eb[_0x594f52(0x108)]({'success':!![],'result':_0x2e6fa8});}catch(_0x150ac5){try{const _0x3ffcb2=(await Promise['resolve']()[_0x594f52(0x130)](()=>__importStar(require('../config/database'))))[_0x594f52(0x137)],_0x400f6c=await _0x3ffcb2[_0x594f52(0x12b)][_0x594f52(0x12f)]({'where':{'username':_0x300ab7['username']},'select':{'id':!![]}});_0x400f6c&&await telegramBotService_1[_0x594f52(0x116)][_0x594f52(0x11b)](_0x400f6c['id'],{'username':_0x300ab7[_0x594f52(0x13b)],'ipAddress':_0x42a3a4,'userAgent':_0x4f3c15,'timestamp':new Date(),'success':![]});}catch(_0x361d8f){console[_0x594f52(0x110)]('Failed\x20to\x20send\x20failed\x20login\x20notification:',_0x361d8f);}throw _0x150ac5;}}catch(_0x507059){_0x53b98e(_0x507059);}},this['me']=async(_0x1e81ca,_0x38009d,_0x3026d7)=>{const _0x5ca9b5=_0x28ad25;try{const _0x508f94=_0x1e81ca[_0x5ca9b5(0x114)];_0x38009d['json']({'success':!![],'result':{'id':_0x508f94?.['id'],'username':_0x508f94?.[_0x5ca9b5(0x13b)],'role':_0x508f94?.[_0x5ca9b5(0x126)]}});}catch(_0x46f0f8){_0x3026d7(_0x46f0f8);}},this[_0x28ad25(0x136)]=async(_0x124e17,_0x249709,_0x24917e)=>{const _0x5306fb=_0x28ad25;try{const _0x4455b5=_0x124e17[_0x5306fb(0x127)],_0x4290db=_0x124e17[_0x5306fb(0x114)];_0x4455b5&&_0x4290db?.[_0x5306fb(0x113)]&&tokenBlacklistService_1[_0x5306fb(0x122)][_0x5306fb(0x111)](_0x4455b5,_0x4290db[_0x5306fb(0x113)]),_0x249709[_0x5306fb(0x108)]({'success':!![],'message':_0x5306fb(0x10e)});}catch(_0x11b1da){_0x24917e(_0x11b1da);}},this[_0x28ad25(0x10f)]=async(_0x1d5a5d,_0x436483,_0x53bc88)=>{const _0x4e49bd=_0x28ad25;try{const _0x535a11=tokenBlacklistService_1['tokenBlacklistService'][_0x4e49bd(0x129)]();_0x436483[_0x4e49bd(0x108)]({'success':!![],'result':_0x535a11});}catch(_0x5234fc){_0x53bc88(_0x5234fc);}},this[_0x28ad25(0x115)]=new authService_1[(_0x28ad25(0x138))]();}}exports[a4_0x15f0a8(0x134)]=AuthController;