'use strict';const a4_0x40c6d7=a4_0x568b;(function(_0x329f8a,_0x33e9f6){const _0x3c101d=a4_0x568b,_0x228994=_0x329f8a();while(!![]){try{const _0x88212d=-parseInt(_0x3c101d(0x8c))/0x1*(-parseInt(_0x3c101d(0x8f))/0x2)+-parseInt(_0x3c101d(0x88))/0x3+parseInt(_0x3c101d(0x77))/0x4+-parseInt(_0x3c101d(0x93))/0x5*(parseInt(_0x3c101d(0x70))/0x6)+-parseInt(_0x3c101d(0x98))/0x7*(parseInt(_0x3c101d(0x75))/0x8)+-parseInt(_0x3c101d(0x76))/0x9+-parseInt(_0x3c101d(0x86))/0xa*(-parseInt(_0x3c101d(0x85))/0xb);if(_0x88212d===_0x33e9f6)break;else _0x228994['push'](_0x228994['shift']());}catch(_0x381910){_0x228994['push'](_0x228994['shift']());}}}(a4_0x38be,0x26f27));function a4_0x568b(_0x45320d,_0x3c92b8){const _0x38be52=a4_0x38be();return a4_0x568b=function(_0x568ba2,_0x477f2f){_0x568ba2=_0x568ba2-0x6a;let _0xb81e67=_0x38be52[_0x568ba2];return _0xb81e67;},a4_0x568b(_0x45320d,_0x3c92b8);}var __createBinding=this&&this[a4_0x40c6d7(0x71)]||(Object[a4_0x40c6d7(0x91)]?function(_0x2e7458,_0xd5231,_0x4d32e8,_0x5a4c9b){const _0x12e2bc=a4_0x40c6d7;if(_0x5a4c9b===undefined)_0x5a4c9b=_0x4d32e8;var _0x50b384=Object[_0x12e2bc(0x8e)](_0xd5231,_0x4d32e8);(!_0x50b384||(_0x12e2bc(0x90)in _0x50b384?!_0xd5231[_0x12e2bc(0x80)]:_0x50b384[_0x12e2bc(0x7e)]||_0x50b384[_0x12e2bc(0x6a)]))&&(_0x50b384={'enumerable':!![],'get':function(){return _0xd5231[_0x4d32e8];}}),Object[_0x12e2bc(0x81)](_0x2e7458,_0x5a4c9b,_0x50b384);}:function(_0x2412f9,_0x372465,_0xa9ef9e,_0x3cfe99){if(_0x3cfe99===undefined)_0x3cfe99=_0xa9ef9e;_0x2412f9[_0x3cfe99]=_0x372465[_0xa9ef9e];}),__setModuleDefault=this&&this[a4_0x40c6d7(0x6c)]||(Object[a4_0x40c6d7(0x91)]?function(_0x325b6f,_0x2d89df){const _0x593f84=a4_0x40c6d7;Object['defineProperty'](_0x325b6f,_0x593f84(0x7b),{'enumerable':!![],'value':_0x2d89df});}:function(_0x368696,_0x4b3e2b){const _0x4676cb=a4_0x40c6d7;_0x368696[_0x4676cb(0x7b)]=_0x4b3e2b;}),__importStar=this&&this['__importStar']||(function(){var _0x118645=function(_0x59ceb9){const _0x3f3ea6=a4_0x568b;return _0x118645=Object[_0x3f3ea6(0x6e)]||function(_0x4a7325){const _0x2ee6df=_0x3f3ea6;var _0x87be8a=[];for(var _0x3c0f5c in _0x4a7325)if(Object['prototype']['hasOwnProperty'][_0x2ee6df(0x74)](_0x4a7325,_0x3c0f5c))_0x87be8a[_0x87be8a[_0x2ee6df(0x97)]]=_0x3c0f5c;return _0x87be8a;},_0x118645(_0x59ceb9);};return function(_0x11ab8c){const _0x5a53b3=a4_0x568b;if(_0x11ab8c&&_0x11ab8c[_0x5a53b3(0x80)])return _0x11ab8c;var _0x5713fb={};if(_0x11ab8c!=null){for(var _0x49fb8c=_0x118645(_0x11ab8c),_0x4efa0c=0x0;_0x4efa0c<_0x49fb8c['length'];_0x4efa0c++)if(_0x49fb8c[_0x4efa0c]!==_0x5a53b3(0x7b))__createBinding(_0x5713fb,_0x11ab8c,_0x49fb8c[_0x4efa0c]);}return __setModuleDefault(_0x5713fb,_0x11ab8c),_0x5713fb;};}());Object[a4_0x40c6d7(0x81)](exports,a4_0x40c6d7(0x80),{'value':!![]}),exports[a4_0x40c6d7(0x7c)]=void 0x0;const authService_1=require(a4_0x40c6d7(0x8a)),tokenBlacklistService_1=require(a4_0x40c6d7(0x96)),telegramBotService_1=require('../services/telegramBotService');function a4_0x38be(){const _0xe593bf=['getOwnPropertyDescriptor','472RNEsDD','get','create','shop','75575OURuAc','login','role','../services/tokenBlacklistService','length','35KGtIyt','exp','authService','username','configurable','json','__setModuleDefault','error','getOwnPropertyNames','logout','24ySdVAe','__createBinding','then','token','call','64168zYWzcm','704457uVNqOc','14512cvDIAO','user','tokenBlacklistService','remoteAddress','default','AuthController','body','writable','sendLoginNotification','__esModule','defineProperty','telegramBotService','connection','Failed\x20to\x20send\x20failed\x20login\x20notification:','919303OyujdI','30juNScx','getBlacklistStats','430458uOpKID','Logged\x20out\x20successfully','../services/authService','User-Agent','964KhSnQX','blacklistToken'];a4_0x38be=function(){return _0xe593bf;};return a4_0x38be();}class AuthController{constructor(){const _0x28c7dc=a4_0x40c6d7;this[_0x28c7dc(0x94)]=async(_0x539f5b,_0x2b5ddb,_0x1b2ffa)=>{const _0x2e5c3f=_0x28c7dc;try{const _0x575b00=_0x539f5b[_0x2e5c3f(0x7d)],_0x106b4c=_0x539f5b['ip']||_0x539f5b[_0x2e5c3f(0x83)][_0x2e5c3f(0x7a)]||'unknown',_0x1e3495=_0x539f5b[_0x2e5c3f(0x90)](_0x2e5c3f(0x8b))||'unknown';let _0x4824b9=![],_0x5b2f21=null;try{const _0x2d1508=await this['authService'][_0x2e5c3f(0x94)](_0x575b00);_0x4824b9=!![],_0x2d1508[_0x2e5c3f(0x95)]==='shop'&&_0x2d1508[_0x2e5c3f(0x78)]?.['id']&&(_0x5b2f21=_0x2d1508[_0x2e5c3f(0x78)]['id']),_0x5b2f21&&await telegramBotService_1[_0x2e5c3f(0x82)][_0x2e5c3f(0x7f)](_0x5b2f21,{'username':_0x575b00[_0x2e5c3f(0x9b)],'ipAddress':_0x106b4c,'userAgent':_0x1e3495,'timestamp':new Date(),'success':!![]}),_0x2b5ddb[_0x2e5c3f(0x6b)]({'success':!![],'result':_0x2d1508});}catch(_0x40918b){try{const _0x379c59=(await Promise['resolve']()[_0x2e5c3f(0x72)](()=>__importStar(require('../config/database'))))[_0x2e5c3f(0x7b)],_0x46ceea=await _0x379c59[_0x2e5c3f(0x92)]['findUnique']({'where':{'username':_0x575b00['username']},'select':{'id':!![]}});_0x46ceea&&await telegramBotService_1[_0x2e5c3f(0x82)]['sendLoginNotification'](_0x46ceea['id'],{'username':_0x575b00[_0x2e5c3f(0x9b)],'ipAddress':_0x106b4c,'userAgent':_0x1e3495,'timestamp':new Date(),'success':![]});}catch(_0x34175f){console[_0x2e5c3f(0x6d)](_0x2e5c3f(0x84),_0x34175f);}throw _0x40918b;}}catch(_0x3b85cd){_0x1b2ffa(_0x3b85cd);}},this['me']=async(_0x29407d,_0x18bab7,_0x48a8cb)=>{const _0x345344=_0x28c7dc;try{const _0x589af8=_0x29407d[_0x345344(0x78)];_0x18bab7[_0x345344(0x6b)]({'success':!![],'result':{'id':_0x589af8?.['id'],'username':_0x589af8?.[_0x345344(0x9b)],'role':_0x589af8?.['role']}});}catch(_0x29bd30){_0x48a8cb(_0x29bd30);}},this[_0x28c7dc(0x6f)]=async(_0x1582d2,_0x1934af,_0x58d6f7)=>{const _0x4b640e=_0x28c7dc;try{const _0x367be1=_0x1582d2[_0x4b640e(0x73)],_0x1ab43b=_0x1582d2['user'];_0x367be1&&_0x1ab43b?.['exp']&&tokenBlacklistService_1[_0x4b640e(0x79)][_0x4b640e(0x8d)](_0x367be1,_0x1ab43b[_0x4b640e(0x99)]),_0x1934af['json']({'success':!![],'message':_0x4b640e(0x89)});}catch(_0x337c8e){_0x58d6f7(_0x337c8e);}},this[_0x28c7dc(0x87)]=async(_0x26ef74,_0x5f253a,_0x31afd4)=>{const _0x402438=_0x28c7dc;try{const _0x34e10f=tokenBlacklistService_1[_0x402438(0x79)]['getStats']();_0x5f253a[_0x402438(0x6b)]({'success':!![],'result':_0x34e10f});}catch(_0x5633ec){_0x31afd4(_0x5633ec);}},this[_0x28c7dc(0x9a)]=new authService_1['AuthService']();}}exports[a4_0x40c6d7(0x7c)]=AuthController;