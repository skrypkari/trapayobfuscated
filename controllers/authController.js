'use strict';const a4_0x3bb58b=a4_0x3bfe;(function(_0x18539d,_0x137650){const _0x3945fd=a4_0x3bfe,_0x5b07f0=_0x18539d();while(!![]){try{const _0x43ff9f=parseInt(_0x3945fd(0x141))/0x1*(parseInt(_0x3945fd(0x13f))/0x2)+-parseInt(_0x3945fd(0x15a))/0x3+-parseInt(_0x3945fd(0x145))/0x4*(parseInt(_0x3945fd(0x157))/0x5)+parseInt(_0x3945fd(0x14b))/0x6*(parseInt(_0x3945fd(0x138))/0x7)+-parseInt(_0x3945fd(0x13c))/0x8*(parseInt(_0x3945fd(0x159))/0x9)+parseInt(_0x3945fd(0x14e))/0xa+parseInt(_0x3945fd(0x132))/0xb;if(_0x43ff9f===_0x137650)break;else _0x5b07f0['push'](_0x5b07f0['shift']());}catch(_0x3c7397){_0x5b07f0['push'](_0x5b07f0['shift']());}}}(a4_0x5e8d,0xc1c92));var __createBinding=this&&this[a4_0x3bb58b(0x13e)]||(Object[a4_0x3bb58b(0x139)]?function(_0x5509c1,_0x455f7c,_0x5eb894,_0x1262c0){const _0x477e59=a4_0x3bb58b;if(_0x1262c0===undefined)_0x1262c0=_0x5eb894;var _0x5c1333=Object[_0x477e59(0x146)](_0x455f7c,_0x5eb894);(!_0x5c1333||(_0x477e59(0x151)in _0x5c1333?!_0x455f7c['__esModule']:_0x5c1333[_0x477e59(0x15d)]||_0x5c1333['configurable']))&&(_0x5c1333={'enumerable':!![],'get':function(){return _0x455f7c[_0x5eb894];}}),Object[_0x477e59(0x15b)](_0x5509c1,_0x1262c0,_0x5c1333);}:function(_0x5873a4,_0x2a95bb,_0x411aee,_0x198fa1){if(_0x198fa1===undefined)_0x198fa1=_0x411aee;_0x5873a4[_0x198fa1]=_0x2a95bb[_0x411aee];}),__setModuleDefault=this&&this['__setModuleDefault']||(Object[a4_0x3bb58b(0x139)]?function(_0x2f326e,_0xbbb8a2){const _0x1061f2=a4_0x3bb58b;Object['defineProperty'](_0x2f326e,_0x1061f2(0x137),{'enumerable':!![],'value':_0xbbb8a2});}:function(_0x7c6891,_0x1053cd){const _0xcdbe68=a4_0x3bb58b;_0x7c6891[_0xcdbe68(0x137)]=_0x1053cd;}),__importStar=this&&this['__importStar']||(function(){var _0x5aa6c7=function(_0x299a5f){return _0x5aa6c7=Object['getOwnPropertyNames']||function(_0x4ccc5d){const _0x1572bf=a4_0x3bfe;var _0x1ae93f=[];for(var _0x545c27 in _0x4ccc5d)if(Object[_0x1572bf(0x14c)]['hasOwnProperty']['call'](_0x4ccc5d,_0x545c27))_0x1ae93f[_0x1ae93f[_0x1572bf(0x142)]]=_0x545c27;return _0x1ae93f;},_0x5aa6c7(_0x299a5f);};return function(_0x4fcae4){const _0x2cee91=a4_0x3bfe;if(_0x4fcae4&&_0x4fcae4[_0x2cee91(0x155)])return _0x4fcae4;var _0x34dc6e={};if(_0x4fcae4!=null){for(var _0x9d49e5=_0x5aa6c7(_0x4fcae4),_0x4f130b=0x0;_0x4f130b<_0x9d49e5[_0x2cee91(0x142)];_0x4f130b++)if(_0x9d49e5[_0x4f130b]!==_0x2cee91(0x137))__createBinding(_0x34dc6e,_0x4fcae4,_0x9d49e5[_0x4f130b]);}return __setModuleDefault(_0x34dc6e,_0x4fcae4),_0x34dc6e;};}());Object[a4_0x3bb58b(0x15b)](exports,'__esModule',{'value':!![]}),exports[a4_0x3bb58b(0x147)]=void 0x0;const authService_1=require(a4_0x3bb58b(0x143)),tokenBlacklistService_1=require(a4_0x3bb58b(0x156)),telegramBotService_1=require(a4_0x3bb58b(0x153));function a4_0x3bfe(_0x53b718,_0x52bc9d){const _0x5e8db8=a4_0x5e8d();return a4_0x3bfe=function(_0x3bfe95,_0x1a0b6d){_0x3bfe95=_0x3bfe95-0x130;let _0x141aed=_0x5e8db8[_0x3bfe95];return _0x141aed;},a4_0x3bfe(_0x53b718,_0x52bc9d);}function a4_0x5e8d(){const _0xe417e=['body','Failed\x20to\x20send\x20failed\x20login\x20notification:','3032148zWVZSM','prototype','Logged\x20out\x20successfully','15340520LxAsAu','shop','username','get','unknown','../services/telegramBotService','AuthService','__esModule','../services/tokenBlacklistService','5OQrMGW','exp','9wmvmsR','4087434aCyJtE','defineProperty','user','writable','User-Agent','telegramBotService','error','logout','token','18252817qSCftk','resolve','getBlacklistStats','json','role','default','7jdArgn','create','authService','then','10163296xlJjbq','login','__createBinding','4hBYhwK','../config/database','241085FPmUwC','length','../services/authService','tokenBlacklistService','3017164ztqPLO','getOwnPropertyDescriptor','AuthController','sendLoginNotification'];a4_0x5e8d=function(){return _0xe417e;};return a4_0x5e8d();}class AuthController{constructor(){const _0x31d0ef=a4_0x3bb58b;this[_0x31d0ef(0x13d)]=async(_0x4b831d,_0x2d3d4e,_0x600113)=>{const _0x581368=_0x31d0ef;try{const _0x50d822=_0x4b831d[_0x581368(0x149)],_0xc02fb3=_0x4b831d['ip']||_0x4b831d['connection']['remoteAddress']||_0x581368(0x152),_0x5c990c=_0x4b831d['get'](_0x581368(0x15e))||'unknown';let _0x119d3d=![],_0x1d918a=null;try{const _0x4a446b=await this[_0x581368(0x13a)][_0x581368(0x13d)](_0x50d822);_0x119d3d=!![],_0x4a446b[_0x581368(0x136)]===_0x581368(0x14f)&&_0x4a446b['user']?.['id']&&(_0x1d918a=_0x4a446b[_0x581368(0x15c)]['id']),_0x1d918a&&await telegramBotService_1['telegramBotService']['sendLoginNotification'](_0x1d918a,{'username':_0x50d822[_0x581368(0x150)],'ipAddress':_0xc02fb3,'userAgent':_0x5c990c,'timestamp':new Date(),'success':!![]}),_0x2d3d4e[_0x581368(0x135)]({'success':!![],'result':_0x4a446b});}catch(_0xaa68a){try{const _0x5a9532=(await Promise[_0x581368(0x133)]()[_0x581368(0x13b)](()=>__importStar(require(_0x581368(0x140)))))['default'],_0x350752=await _0x5a9532[_0x581368(0x14f)]['findUnique']({'where':{'username':_0x50d822[_0x581368(0x150)]},'select':{'id':!![]}});_0x350752&&await telegramBotService_1[_0x581368(0x15f)][_0x581368(0x148)](_0x350752['id'],{'username':_0x50d822[_0x581368(0x150)],'ipAddress':_0xc02fb3,'userAgent':_0x5c990c,'timestamp':new Date(),'success':![]});}catch(_0x4db761){console[_0x581368(0x160)](_0x581368(0x14a),_0x4db761);}throw _0xaa68a;}}catch(_0x304417){_0x600113(_0x304417);}},this['me']=async(_0x5f3a34,_0x329e6c,_0x4edbc8)=>{const _0x59a557=_0x31d0ef;try{const _0x3e4096=_0x5f3a34[_0x59a557(0x15c)];_0x329e6c[_0x59a557(0x135)]({'success':!![],'result':{'id':_0x3e4096?.['id'],'username':_0x3e4096?.['username'],'role':_0x3e4096?.[_0x59a557(0x136)]}});}catch(_0x2606f2){_0x4edbc8(_0x2606f2);}},this[_0x31d0ef(0x130)]=async(_0x386e5f,_0x34befa,_0x37b7ce)=>{const _0x523564=_0x31d0ef;try{const _0x143fa8=_0x386e5f[_0x523564(0x131)],_0x10b547=_0x386e5f['user'];_0x143fa8&&_0x10b547?.['exp']&&tokenBlacklistService_1[_0x523564(0x144)]['blacklistToken'](_0x143fa8,_0x10b547[_0x523564(0x158)]),_0x34befa[_0x523564(0x135)]({'success':!![],'message':_0x523564(0x14d)});}catch(_0x56a4d4){_0x37b7ce(_0x56a4d4);}},this[_0x31d0ef(0x134)]=async(_0x134f71,_0xf08a15,_0x3e74a7)=>{const _0x9d6f51=_0x31d0ef;try{const _0x157ae4=tokenBlacklistService_1['tokenBlacklistService']['getStats']();_0xf08a15[_0x9d6f51(0x135)]({'success':!![],'result':_0x157ae4});}catch(_0x24449d){_0x3e74a7(_0x24449d);}},this[_0x31d0ef(0x13a)]=new authService_1[(_0x31d0ef(0x154))]();}}exports[a4_0x3bb58b(0x147)]=AuthController;