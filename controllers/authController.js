'use strict';const a4_0x1275f0=a4_0xc7f3;function a4_0x181d(){const _0x559712=['hasOwnProperty','../services/authService','token','sendLoginNotification','ipAddress','2121365XsxjNK','writable','3RInLOp','body','7228024JxAPth','tokenBlacklistService','User-Agent','8430021ENiPtX','2596jKhjEy','remoteAddress','shop','json','4910MohdZF','create','prototype','2489704AhkzxM','username','resolve','getStats','configurable','geo','exp','1105112mnRiPk','user','__esModule','../services/tokenBlacklistService','12dXorrc','__importStar','AuthController','then','length','connection','get','authService','default','Logged\x20out\x20successfully','telegramBotService','Failed\x20to\x20send\x20failed\x20login\x20notification:','__createBinding','defineProperty','login','2MZwWLt','AuthService','../config/database','5468645NvzgFm','../services/telegramBotService','unknown','role'];a4_0x181d=function(){return _0x559712;};return a4_0x181d();}(function(_0x50dc4a,_0x58d6e9){const _0x400795=a4_0xc7f3,_0x317075=_0x50dc4a();while(!![]){try{const _0x2d4c55=parseInt(_0x400795(0x128))/0x1*(parseInt(_0x400795(0x115))/0x2)+parseInt(_0x400795(0x101))/0x3*(-parseInt(_0x400795(0x10e))/0x4)+-parseInt(_0x400795(0xff))/0x5*(-parseInt(_0x400795(0x119))/0x6)+-parseInt(_0x400795(0xf6))/0x7+-parseInt(_0x400795(0x103))/0x8+parseInt(_0x400795(0x106))/0x9+-parseInt(_0x400795(0x10b))/0xa*(-parseInt(_0x400795(0x107))/0xb);if(_0x2d4c55===_0x58d6e9)break;else _0x317075['push'](_0x317075['shift']());}catch(_0x272ec5){_0x317075['push'](_0x317075['shift']());}}}(a4_0x181d,0xaaa9f));var __createBinding=this&&this[a4_0x1275f0(0x125)]||(Object[a4_0x1275f0(0x10c)]?function(_0x29c8a3,_0x41983d,_0x107762,_0x5acbaf){const _0x3e8659=a4_0x1275f0;if(_0x5acbaf===undefined)_0x5acbaf=_0x107762;var _0x4a2081=Object['getOwnPropertyDescriptor'](_0x41983d,_0x107762);(!_0x4a2081||(_0x3e8659(0x11f)in _0x4a2081?!_0x41983d[_0x3e8659(0x117)]:_0x4a2081[_0x3e8659(0x100)]||_0x4a2081[_0x3e8659(0x112)]))&&(_0x4a2081={'enumerable':!![],'get':function(){return _0x41983d[_0x107762];}}),Object[_0x3e8659(0x126)](_0x29c8a3,_0x5acbaf,_0x4a2081);}:function(_0xbfd219,_0x4df817,_0x4f9b8d,_0x34d5f2){if(_0x34d5f2===undefined)_0x34d5f2=_0x4f9b8d;_0xbfd219[_0x34d5f2]=_0x4df817[_0x4f9b8d];}),__setModuleDefault=this&&this['__setModuleDefault']||(Object['create']?function(_0x32d9e6,_0x505df4){const _0x3b2ee9=a4_0x1275f0;Object[_0x3b2ee9(0x126)](_0x32d9e6,_0x3b2ee9(0x121),{'enumerable':!![],'value':_0x505df4});}:function(_0x1c88d7,_0x2a937f){_0x1c88d7['default']=_0x2a937f;}),__importStar=this&&this[a4_0x1275f0(0x11a)]||(function(){var _0x1adca8=function(_0x528f8a){return _0x1adca8=Object['getOwnPropertyNames']||function(_0x259199){const _0x35900c=a4_0xc7f3;var _0x53e5f5=[];for(var _0x1111d7 in _0x259199)if(Object[_0x35900c(0x10d)][_0x35900c(0xfa)]['call'](_0x259199,_0x1111d7))_0x53e5f5[_0x53e5f5[_0x35900c(0x11d)]]=_0x1111d7;return _0x53e5f5;},_0x1adca8(_0x528f8a);};return function(_0x194540){const _0x323e56=a4_0xc7f3;if(_0x194540&&_0x194540[_0x323e56(0x117)])return _0x194540;var _0x46b1e5={};if(_0x194540!=null){for(var _0x8eb2b8=_0x1adca8(_0x194540),_0x5aee2c=0x0;_0x5aee2c<_0x8eb2b8[_0x323e56(0x11d)];_0x5aee2c++)if(_0x8eb2b8[_0x5aee2c]!==_0x323e56(0x121))__createBinding(_0x46b1e5,_0x194540,_0x8eb2b8[_0x5aee2c]);}return __setModuleDefault(_0x46b1e5,_0x194540),_0x46b1e5;};}());Object[a4_0x1275f0(0x126)](exports,'__esModule',{'value':!![]}),exports[a4_0x1275f0(0x11b)]=void 0x0;const authService_1=require(a4_0x1275f0(0xfb)),tokenBlacklistService_1=require(a4_0x1275f0(0x118)),telegramBotService_1=require(a4_0x1275f0(0xf7));function a4_0xc7f3(_0x1c0082,_0x1af32b){_0x1c0082=_0x1c0082-0xf6;const _0x181d55=a4_0x181d();let _0xc7f39a=_0x181d55[_0x1c0082];return _0xc7f39a;}class AuthController{constructor(){const _0x54922e=a4_0x1275f0;this[_0x54922e(0x127)]=async(_0x151867,_0x2950e3,_0x4e0fc2)=>{const _0x299ba7=_0x54922e;try{const _0xd20d14=_0x151867[_0x299ba7(0x102)],_0x1f1dd2=_0xd20d14[_0x299ba7(0xfe)]||_0x151867['ip']||_0x151867[_0x299ba7(0x11e)][_0x299ba7(0x108)]||'unknown',_0x5e5b38=_0xd20d14['userAgent']||_0x151867[_0x299ba7(0x11f)](_0x299ba7(0x105))||_0x299ba7(0xf8),_0x3cb8e8=_0xd20d14[_0x299ba7(0x113)];let _0x1d0c51=![],_0x3d1da=null;try{const _0x491517=await this[_0x299ba7(0x120)][_0x299ba7(0x127)](_0xd20d14);_0x1d0c51=!![],_0x491517[_0x299ba7(0xf9)]==='shop'&&_0x491517[_0x299ba7(0x116)]?.['id']&&(_0x3d1da=_0x491517[_0x299ba7(0x116)]['id']),_0x3d1da&&await telegramBotService_1[_0x299ba7(0x123)]['sendLoginNotification'](_0x3d1da,{'username':_0xd20d14[_0x299ba7(0x10f)],'ipAddress':_0x1f1dd2,'userAgent':_0x5e5b38,'geo':_0x3cb8e8,'timestamp':new Date(),'success':!![]}),_0x2950e3[_0x299ba7(0x10a)]({'success':!![],'result':_0x491517});}catch(_0x39412e){try{const _0x58d4b2=(await Promise[_0x299ba7(0x110)]()[_0x299ba7(0x11c)](()=>__importStar(require(_0x299ba7(0x12a)))))[_0x299ba7(0x121)],_0x5651ef=await _0x58d4b2[_0x299ba7(0x109)]['findUnique']({'where':{'username':_0xd20d14[_0x299ba7(0x10f)]},'select':{'id':!![]}});_0x5651ef&&await telegramBotService_1[_0x299ba7(0x123)][_0x299ba7(0xfd)](_0x5651ef['id'],{'username':_0xd20d14[_0x299ba7(0x10f)],'ipAddress':_0x1f1dd2,'userAgent':_0x5e5b38,'geo':_0x3cb8e8,'timestamp':new Date(),'success':![]});}catch(_0x1200fa){console['error'](_0x299ba7(0x124),_0x1200fa);}throw _0x39412e;}}catch(_0x8b6ca4){_0x4e0fc2(_0x8b6ca4);}},this['me']=async(_0x4b0f67,_0x2e96e7,_0x5e994b)=>{const _0x196772=_0x54922e;try{const _0x6da236=_0x4b0f67['user'];_0x2e96e7['json']({'success':!![],'result':{'id':_0x6da236?.['id'],'username':_0x6da236?.[_0x196772(0x10f)],'role':_0x6da236?.[_0x196772(0xf9)]}});}catch(_0x35bd9e){_0x5e994b(_0x35bd9e);}},this['logout']=async(_0x231948,_0x499f40,_0x4bfe24)=>{const _0x3a1f02=_0x54922e;try{const _0x4b8ddd=_0x231948[_0x3a1f02(0xfc)],_0x51ccb8=_0x231948[_0x3a1f02(0x116)];_0x4b8ddd&&_0x51ccb8?.['exp']&&tokenBlacklistService_1[_0x3a1f02(0x104)]['blacklistToken'](_0x4b8ddd,_0x51ccb8[_0x3a1f02(0x114)]),_0x499f40[_0x3a1f02(0x10a)]({'success':!![],'message':_0x3a1f02(0x122)});}catch(_0x323704){_0x4bfe24(_0x323704);}},this['getBlacklistStats']=async(_0x2910df,_0x1bd68c,_0x522484)=>{const _0x3025cc=_0x54922e;try{const _0x54e2bf=tokenBlacklistService_1[_0x3025cc(0x104)][_0x3025cc(0x111)]();_0x1bd68c['json']({'success':!![],'result':_0x54e2bf});}catch(_0x3323b6){_0x522484(_0x3323b6);}},this[_0x54922e(0x120)]=new authService_1[(_0x54922e(0x129))]();}}exports[a4_0x1275f0(0x11b)]=AuthController;