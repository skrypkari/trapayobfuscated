'use strict';const a4_0x9f353=a4_0x3a0b;(function(_0x4c352b,_0x22074c){const _0x29e526=a4_0x3a0b,_0x1d0ae2=_0x4c352b();while(!![]){try{const _0x3cfdee=-parseInt(_0x29e526(0xa4))/0x1+parseInt(_0x29e526(0xb2))/0x2*(-parseInt(_0x29e526(0xc9))/0x3)+parseInt(_0x29e526(0xa7))/0x4+-parseInt(_0x29e526(0xc6))/0x5*(parseInt(_0x29e526(0xb8))/0x6)+-parseInt(_0x29e526(0xc7))/0x7*(-parseInt(_0x29e526(0xa5))/0x8)+parseInt(_0x29e526(0xac))/0x9+parseInt(_0x29e526(0x9e))/0xa*(parseInt(_0x29e526(0xa2))/0xb);if(_0x3cfdee===_0x22074c)break;else _0x1d0ae2['push'](_0x1d0ae2['shift']());}catch(_0x3d530d){_0x1d0ae2['push'](_0x1d0ae2['shift']());}}}(a4_0x304c,0x9325b));var __createBinding=this&&this[a4_0x9f353(0xb3)]||(Object[a4_0x9f353(0xb5)]?function(_0x4382cb,_0x287386,_0xe79dba,_0x2bd6eb){const _0x11179a=a4_0x9f353;if(_0x2bd6eb===undefined)_0x2bd6eb=_0xe79dba;var _0x1a5427=Object[_0x11179a(0xc0)](_0x287386,_0xe79dba);(!_0x1a5427||(_0x11179a(0xb1)in _0x1a5427?!_0x287386[_0x11179a(0xa1)]:_0x1a5427[_0x11179a(0xc1)]||_0x1a5427[_0x11179a(0xbb)]))&&(_0x1a5427={'enumerable':!![],'get':function(){return _0x287386[_0xe79dba];}}),Object[_0x11179a(0xb4)](_0x4382cb,_0x2bd6eb,_0x1a5427);}:function(_0x39cda7,_0x178f9b,_0xd858c0,_0x4a89c6){if(_0x4a89c6===undefined)_0x4a89c6=_0xd858c0;_0x39cda7[_0x4a89c6]=_0x178f9b[_0xd858c0];}),__setModuleDefault=this&&this['__setModuleDefault']||(Object[a4_0x9f353(0xb5)]?function(_0x445d67,_0x338bae){const _0x5e99a7=a4_0x9f353;Object[_0x5e99a7(0xb4)](_0x445d67,_0x5e99a7(0x9d),{'enumerable':!![],'value':_0x338bae});}:function(_0x5757c4,_0x397090){const _0x26788c=a4_0x9f353;_0x5757c4[_0x26788c(0x9d)]=_0x397090;}),__importStar=this&&this[a4_0x9f353(0xc8)]||(function(){var _0x5b6daf=function(_0x2d1334){const _0x4ff712=a4_0x3a0b;return _0x5b6daf=Object[_0x4ff712(0xc3)]||function(_0x378325){const _0x2d3f66=_0x4ff712;var _0x131e52=[];for(var _0x5a2ca2 in _0x378325)if(Object[_0x2d3f66(0xbd)][_0x2d3f66(0xa8)][_0x2d3f66(0x9c)](_0x378325,_0x5a2ca2))_0x131e52[_0x131e52[_0x2d3f66(0xbe)]]=_0x5a2ca2;return _0x131e52;},_0x5b6daf(_0x2d1334);};return function(_0x106a6a){const _0x576260=a4_0x3a0b;if(_0x106a6a&&_0x106a6a[_0x576260(0xa1)])return _0x106a6a;var _0x22d492={};if(_0x106a6a!=null){for(var _0x344f75=_0x5b6daf(_0x106a6a),_0x138b66=0x0;_0x138b66<_0x344f75[_0x576260(0xbe)];_0x138b66++)if(_0x344f75[_0x138b66]!==_0x576260(0x9d))__createBinding(_0x22d492,_0x106a6a,_0x344f75[_0x138b66]);}return __setModuleDefault(_0x22d492,_0x106a6a),_0x22d492;};}());function a4_0x3a0b(_0x3d5579,_0x107b4b){const _0x304c23=a4_0x304c();return a4_0x3a0b=function(_0x3a0b47,_0x363f5e){_0x3a0b47=_0x3a0b47-0x9c;let _0x472cc2=_0x304c23[_0x3a0b47];return _0x472cc2;},a4_0x3a0b(_0x3d5579,_0x107b4b);}Object[a4_0x9f353(0xb4)](exports,a4_0x9f353(0xa1),{'value':!![]}),exports['AuthController']=void 0x0;function a4_0x304c(){const _0x1487dc=['../config/database','exp','54528XokqYG','error','User-Agent','configurable','AuthController','prototype','length','sendLoginNotification','getOwnPropertyDescriptor','writable','getStats','getOwnPropertyNames','logout','telegramBotService','395YLLUeJ','1444702cpkBxa','__importStar','38328ZDnMhJ','unknown','authService','findUnique','remoteAddress','role','blacklistToken','call','default','12646650bTnooj','../services/authService','user','__esModule','11kAHTmq','getBlacklistStats','334300PEWvhW','8smvKob','username','3755492bCUtJL','hasOwnProperty','../services/tokenBlacklistService','json','AuthService','3668931oSsqiZ','login','tokenBlacklistService','connection','resolve','get','182kjogJr','__createBinding','defineProperty','create'];a4_0x304c=function(){return _0x1487dc;};return a4_0x304c();}const authService_1=require(a4_0x9f353(0x9f)),tokenBlacklistService_1=require(a4_0x9f353(0xa9)),telegramBotService_1=require('../services/telegramBotService');class AuthController{constructor(){const _0x24ac62=a4_0x9f353;this['login']=async(_0x16e272,_0x353254,_0x542511)=>{const _0x5e50c8=a4_0x3a0b;try{const _0x1d9d5d=_0x16e272['body'],_0x478ac0=_0x16e272['ip']||_0x16e272[_0x5e50c8(0xaf)][_0x5e50c8(0xcd)]||_0x5e50c8(0xca),_0x2c789e=_0x16e272[_0x5e50c8(0xb1)](_0x5e50c8(0xba))||'unknown';let _0x3caf24=![],_0x348811=null;try{const _0xe9ce4b=await this[_0x5e50c8(0xcb)][_0x5e50c8(0xad)](_0x1d9d5d);_0x3caf24=!![],_0xe9ce4b[_0x5e50c8(0xce)]==='shop'&&_0xe9ce4b[_0x5e50c8(0xa0)]?.['id']&&(_0x348811=_0xe9ce4b[_0x5e50c8(0xa0)]['id']),_0x348811&&await telegramBotService_1[_0x5e50c8(0xc5)]['sendLoginNotification'](_0x348811,{'username':_0x1d9d5d[_0x5e50c8(0xa6)],'ipAddress':_0x478ac0,'userAgent':_0x2c789e,'timestamp':new Date(),'success':!![]}),_0x353254[_0x5e50c8(0xaa)]({'success':!![],'result':_0xe9ce4b});}catch(_0x5be633){try{const _0x3afd8e=(await Promise[_0x5e50c8(0xb0)]()['then'](()=>__importStar(require(_0x5e50c8(0xb6)))))['default'],_0x354068=await _0x3afd8e['shop'][_0x5e50c8(0xcc)]({'where':{'username':_0x1d9d5d[_0x5e50c8(0xa6)]},'select':{'id':!![]}});_0x354068&&await telegramBotService_1[_0x5e50c8(0xc5)][_0x5e50c8(0xbf)](_0x354068['id'],{'username':_0x1d9d5d[_0x5e50c8(0xa6)],'ipAddress':_0x478ac0,'userAgent':_0x2c789e,'timestamp':new Date(),'success':![]});}catch(_0x52d756){console[_0x5e50c8(0xb9)]('Failed\x20to\x20send\x20failed\x20login\x20notification:',_0x52d756);}throw _0x5be633;}}catch(_0x5bac11){_0x542511(_0x5bac11);}},this['me']=async(_0x5733e0,_0x2933b2,_0x187c88)=>{const _0x54e279=a4_0x3a0b;try{const _0x5f2c1d=_0x5733e0[_0x54e279(0xa0)];_0x2933b2[_0x54e279(0xaa)]({'success':!![],'result':{'id':_0x5f2c1d?.['id'],'username':_0x5f2c1d?.[_0x54e279(0xa6)],'role':_0x5f2c1d?.[_0x54e279(0xce)]}});}catch(_0x293f0b){_0x187c88(_0x293f0b);}},this[_0x24ac62(0xc4)]=async(_0x21d183,_0x3dbfa5,_0x48ea83)=>{const _0x16b518=_0x24ac62;try{const _0x29250a=_0x21d183['token'],_0x441ab3=_0x21d183[_0x16b518(0xa0)];_0x29250a&&_0x441ab3?.[_0x16b518(0xb7)]&&tokenBlacklistService_1['tokenBlacklistService'][_0x16b518(0xcf)](_0x29250a,_0x441ab3[_0x16b518(0xb7)]),_0x3dbfa5['json']({'success':!![],'message':'Logged\x20out\x20successfully'});}catch(_0x2630da){_0x48ea83(_0x2630da);}},this[_0x24ac62(0xa3)]=async(_0x102c5f,_0x1f7871,_0x3d1470)=>{const _0x28282b=_0x24ac62;try{const _0xa79a7e=tokenBlacklistService_1[_0x28282b(0xae)][_0x28282b(0xc2)]();_0x1f7871[_0x28282b(0xaa)]({'success':!![],'result':_0xa79a7e});}catch(_0x4965d9){_0x3d1470(_0x4965d9);}},this[_0x24ac62(0xcb)]=new authService_1[(_0x24ac62(0xab))]();}}exports[a4_0x9f353(0xbc)]=AuthController;