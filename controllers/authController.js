'use strict';function a4_0x5ab6(_0x2fc0c4,_0x165186){const _0x4b7121=a4_0x4b71();return a4_0x5ab6=function(_0x5ab61c,_0x202277){_0x5ab61c=_0x5ab61c-0xef;let _0x1515a4=_0x4b7121[_0x5ab61c];return _0x1515a4;},a4_0x5ab6(_0x2fc0c4,_0x165186);}function a4_0x4b71(){const _0xbc3255=['Logged\x20out\x20successfully','login','tokenBlacklistService','get','getStats','1oNhDAT','User-Agent','hasOwnProperty','body','686120HlOLgm','573tSctPn','create','__setModuleDefault','prototype','../services/tokenBlacklistService','AuthService','__esModule','AuthController','username','findUnique','authService','length','error','4742739uSXsHK','resolve','2408819fZZwJP','exp','1548BfymBh','getBlacklistStats','user','190XfDzgy','../services/telegramBotService','16sGsJgc','connection','default','defineProperty','294305FZzOqQ','getOwnPropertyNames','telegramBotService','__importStar','shop','json','blacklistToken','39464cugnmL','sendLoginNotification','writable','1753008hYffyT','__createBinding','unknown','then','getOwnPropertyDescriptor'];a4_0x4b71=function(){return _0xbc3255;};return a4_0x4b71();}const a4_0x531433=a4_0x5ab6;(function(_0x46a0d1,_0x3c01c9){const _0x531d59=a4_0x5ab6,_0x120771=_0x46a0d1();while(!![]){try{const _0x4116f0=parseInt(_0x531d59(0xff))/0x1*(parseInt(_0x531d59(0xf2))/0x2)+parseInt(_0x531d59(0x104))/0x3*(parseInt(_0x531d59(0x115))/0x4)+-parseInt(_0x531d59(0x103))/0x5+-parseInt(_0x531d59(0xf5))/0x6+-parseInt(_0x531d59(0x113))/0x7*(-parseInt(_0x531d59(0x11a))/0x8)+parseInt(_0x531d59(0x111))/0x9+-parseInt(_0x531d59(0x118))/0xa*(parseInt(_0x531d59(0x11e))/0xb);if(_0x4116f0===_0x3c01c9)break;else _0x120771['push'](_0x120771['shift']());}catch(_0x978e16){_0x120771['push'](_0x120771['shift']());}}}(a4_0x4b71,0x5a9ad));var __createBinding=this&&this[a4_0x531433(0xf6)]||(Object[a4_0x531433(0x105)]?function(_0x5accd7,_0x4ad6f3,_0x4eb75b,_0x55b06d){const _0x126c7d=a4_0x531433;if(_0x55b06d===undefined)_0x55b06d=_0x4eb75b;var _0x57025a=Object[_0x126c7d(0xf9)](_0x4ad6f3,_0x4eb75b);(!_0x57025a||(_0x126c7d(0xfd)in _0x57025a?!_0x4ad6f3[_0x126c7d(0x10a)]:_0x57025a[_0x126c7d(0xf4)]||_0x57025a['configurable']))&&(_0x57025a={'enumerable':!![],'get':function(){return _0x4ad6f3[_0x4eb75b];}}),Object[_0x126c7d(0x11d)](_0x5accd7,_0x55b06d,_0x57025a);}:function(_0xbeb8ee,_0x2c61fe,_0x3132ac,_0x3b5efb){if(_0x3b5efb===undefined)_0x3b5efb=_0x3132ac;_0xbeb8ee[_0x3b5efb]=_0x2c61fe[_0x3132ac];}),__setModuleDefault=this&&this[a4_0x531433(0x106)]||(Object[a4_0x531433(0x105)]?function(_0x327d09,_0x2e52c3){const _0x36f62e=a4_0x531433;Object[_0x36f62e(0x11d)](_0x327d09,_0x36f62e(0x11c),{'enumerable':!![],'value':_0x2e52c3});}:function(_0x4c5e60,_0x5b2272){const _0x486a43=a4_0x531433;_0x4c5e60[_0x486a43(0x11c)]=_0x5b2272;}),__importStar=this&&this[a4_0x531433(0x121)]||(function(){var _0x5d8fc6=function(_0x9e815b){const _0x345f00=a4_0x5ab6;return _0x5d8fc6=Object[_0x345f00(0x11f)]||function(_0x413b92){const _0x29251e=_0x345f00;var _0x400e27=[];for(var _0x18d341 in _0x413b92)if(Object[_0x29251e(0x107)][_0x29251e(0x101)]['call'](_0x413b92,_0x18d341))_0x400e27[_0x400e27[_0x29251e(0x10f)]]=_0x18d341;return _0x400e27;},_0x5d8fc6(_0x9e815b);};return function(_0xfd9c42){const _0x4b58b=a4_0x5ab6;if(_0xfd9c42&&_0xfd9c42[_0x4b58b(0x10a)])return _0xfd9c42;var _0x5ab105={};if(_0xfd9c42!=null){for(var _0x4bcd24=_0x5d8fc6(_0xfd9c42),_0x5b92c4=0x0;_0x5b92c4<_0x4bcd24[_0x4b58b(0x10f)];_0x5b92c4++)if(_0x4bcd24[_0x5b92c4]!==_0x4b58b(0x11c))__createBinding(_0x5ab105,_0xfd9c42,_0x4bcd24[_0x5b92c4]);}return __setModuleDefault(_0x5ab105,_0xfd9c42),_0x5ab105;};}());Object['defineProperty'](exports,a4_0x531433(0x10a),{'value':!![]}),exports[a4_0x531433(0x10b)]=void 0x0;const authService_1=require('../services/authService'),tokenBlacklistService_1=require(a4_0x531433(0x108)),telegramBotService_1=require(a4_0x531433(0x119));class AuthController{constructor(){const _0x3d5c38=a4_0x531433;this[_0x3d5c38(0xfb)]=async(_0x335336,_0x3e76af,_0x4f4371)=>{const _0x55d68b=_0x3d5c38;try{const _0x258656=_0x335336[_0x55d68b(0x102)],_0x42814c=_0x335336['ip']||_0x335336[_0x55d68b(0x11b)]['remoteAddress']||_0x55d68b(0xf7),_0x155011=_0x335336[_0x55d68b(0xfd)](_0x55d68b(0x100))||'unknown';let _0x68c54e=![],_0x3a7037=null;try{const _0x5ace3b=await this[_0x55d68b(0x10e)][_0x55d68b(0xfb)](_0x258656);_0x68c54e=!![],_0x5ace3b['role']===_0x55d68b(0xef)&&_0x5ace3b['user']?.['id']&&(_0x3a7037=_0x5ace3b[_0x55d68b(0x117)]['id']),_0x3a7037&&await telegramBotService_1[_0x55d68b(0x120)][_0x55d68b(0xf3)](_0x3a7037,{'username':_0x258656[_0x55d68b(0x10c)],'ipAddress':_0x42814c,'userAgent':_0x155011,'timestamp':new Date(),'success':!![]}),_0x3e76af['json']({'success':!![],'result':_0x5ace3b});}catch(_0x22d4ae){try{const _0x11549a=(await Promise[_0x55d68b(0x112)]()[_0x55d68b(0xf8)](()=>__importStar(require('../config/database'))))[_0x55d68b(0x11c)],_0x5b678d=await _0x11549a['shop'][_0x55d68b(0x10d)]({'where':{'username':_0x258656['username']},'select':{'id':!![]}});_0x5b678d&&await telegramBotService_1[_0x55d68b(0x120)][_0x55d68b(0xf3)](_0x5b678d['id'],{'username':_0x258656[_0x55d68b(0x10c)],'ipAddress':_0x42814c,'userAgent':_0x155011,'timestamp':new Date(),'success':![]});}catch(_0x1386ef){console[_0x55d68b(0x110)]('Failed\x20to\x20send\x20failed\x20login\x20notification:',_0x1386ef);}throw _0x22d4ae;}}catch(_0x1e9dd5){_0x4f4371(_0x1e9dd5);}},this['me']=async(_0x49680a,_0x495fdd,_0x2647f3)=>{const _0x14fd56=_0x3d5c38;try{const _0x3d73bd=_0x49680a[_0x14fd56(0x117)];_0x495fdd[_0x14fd56(0xf0)]({'success':!![],'result':{'id':_0x3d73bd?.['id'],'username':_0x3d73bd?.[_0x14fd56(0x10c)],'role':_0x3d73bd?.['role']}});}catch(_0x2b0c03){_0x2647f3(_0x2b0c03);}},this['logout']=async(_0x25ad58,_0x137fcd,_0x547768)=>{const _0x1d2f54=_0x3d5c38;try{const _0x3e127e=_0x25ad58['token'],_0x1e27f6=_0x25ad58[_0x1d2f54(0x117)];_0x3e127e&&_0x1e27f6?.[_0x1d2f54(0x114)]&&tokenBlacklistService_1[_0x1d2f54(0xfc)][_0x1d2f54(0xf1)](_0x3e127e,_0x1e27f6[_0x1d2f54(0x114)]),_0x137fcd[_0x1d2f54(0xf0)]({'success':!![],'message':_0x1d2f54(0xfa)});}catch(_0x39ba3e){_0x547768(_0x39ba3e);}},this[_0x3d5c38(0x116)]=async(_0x33d2fa,_0x1d7649,_0x449c79)=>{const _0x5c035f=_0x3d5c38;try{const _0x52bfe1=tokenBlacklistService_1['tokenBlacklistService'][_0x5c035f(0xfe)]();_0x1d7649[_0x5c035f(0xf0)]({'success':!![],'result':_0x52bfe1});}catch(_0x341526){_0x449c79(_0x341526);}},this[_0x3d5c38(0x10e)]=new authService_1[(_0x3d5c38(0x109))]();}}exports[a4_0x531433(0x10b)]=AuthController;