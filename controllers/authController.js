'use strict';const a4_0x25d8b7=a4_0x262f;(function(_0x4cd20d,_0x2b6db2){const _0x4f1e0d=a4_0x262f,_0x89b1da=_0x4cd20d();while(!![]){try{const _0x23ac6d=parseInt(_0x4f1e0d(0xe4))/0x1+parseInt(_0x4f1e0d(0x109))/0x2*(parseInt(_0x4f1e0d(0xf4))/0x3)+-parseInt(_0x4f1e0d(0x105))/0x4+parseInt(_0x4f1e0d(0xfb))/0x5+-parseInt(_0x4f1e0d(0xed))/0x6+parseInt(_0x4f1e0d(0xf7))/0x7*(parseInt(_0x4f1e0d(0xec))/0x8)+-parseInt(_0x4f1e0d(0xe5))/0x9;if(_0x23ac6d===_0x2b6db2)break;else _0x89b1da['push'](_0x89b1da['shift']());}catch(_0x40420a){_0x89b1da['push'](_0x89b1da['shift']());}}}(a4_0x3bf7,0x1db4d));var __createBinding=this&&this[a4_0x25d8b7(0xef)]||(Object[a4_0x25d8b7(0xfc)]?function(_0xf17b1d,_0x2650cc,_0x1c862f,_0x37f274){const _0xbee447=a4_0x25d8b7;if(_0x37f274===undefined)_0x37f274=_0x1c862f;var _0x24af5b=Object['getOwnPropertyDescriptor'](_0x2650cc,_0x1c862f);(!_0x24af5b||(_0xbee447(0x108)in _0x24af5b?!_0x2650cc[_0xbee447(0xe8)]:_0x24af5b[_0xbee447(0xf1)]||_0x24af5b[_0xbee447(0x10a)]))&&(_0x24af5b={'enumerable':!![],'get':function(){return _0x2650cc[_0x1c862f];}}),Object[_0xbee447(0xee)](_0xf17b1d,_0x37f274,_0x24af5b);}:function(_0x27d99e,_0x55ef2b,_0x2a280d,_0xf1f8fb){if(_0xf1f8fb===undefined)_0xf1f8fb=_0x2a280d;_0x27d99e[_0xf1f8fb]=_0x55ef2b[_0x2a280d];}),__setModuleDefault=this&&this[a4_0x25d8b7(0x110)]||(Object['create']?function(_0x592d83,_0x200650){const _0x13c9db=a4_0x25d8b7;Object['defineProperty'](_0x592d83,_0x13c9db(0x104),{'enumerable':!![],'value':_0x200650});}:function(_0x1723a6,_0x295ac4){const _0x1c4059=a4_0x25d8b7;_0x1723a6[_0x1c4059(0x104)]=_0x295ac4;}),__importStar=this&&this[a4_0x25d8b7(0x111)]||(function(){var _0x170c51=function(_0x515207){const _0x50d167=a4_0x262f;return _0x170c51=Object[_0x50d167(0x107)]||function(_0x1f3a14){const _0x214cec=_0x50d167;var _0x455d89=[];for(var _0x550cb4 in _0x1f3a14)if(Object[_0x214cec(0xf6)][_0x214cec(0x10e)]['call'](_0x1f3a14,_0x550cb4))_0x455d89[_0x455d89[_0x214cec(0xfe)]]=_0x550cb4;return _0x455d89;},_0x170c51(_0x515207);};return function(_0x1d2f37){const _0x513f8c=a4_0x262f;if(_0x1d2f37&&_0x1d2f37['__esModule'])return _0x1d2f37;var _0x47ba4a={};if(_0x1d2f37!=null){for(var _0x39a38c=_0x170c51(_0x1d2f37),_0x504920=0x0;_0x504920<_0x39a38c[_0x513f8c(0xfe)];_0x504920++)if(_0x39a38c[_0x504920]!==_0x513f8c(0x104))__createBinding(_0x47ba4a,_0x1d2f37,_0x39a38c[_0x504920]);}return __setModuleDefault(_0x47ba4a,_0x1d2f37),_0x47ba4a;};}());Object[a4_0x25d8b7(0xee)](exports,'__esModule',{'value':!![]}),exports[a4_0x25d8b7(0xf3)]=void 0x0;function a4_0x262f(_0x5a84c3,_0x39aa47){const _0x3bf7b7=a4_0x3bf7();return a4_0x262f=function(_0x262f3f,_0x5433dc){_0x262f3f=_0x262f3f-0xe3;let _0x5459fc=_0x3bf7b7[_0x262f3f];return _0x5459fc;},a4_0x262f(_0x5a84c3,_0x39aa47);}const authService_1=require('../services/authService'),tokenBlacklistService_1=require(a4_0x25d8b7(0xf2)),telegramBotService_1=require(a4_0x25d8b7(0xe7));class AuthController{constructor(){const _0x5c8c19=a4_0x25d8b7;this[_0x5c8c19(0x106)]=async(_0x8575a9,_0x4ef3b0,_0x13f35a)=>{const _0x47f89d=_0x5c8c19;try{const _0x1834a5=_0x8575a9[_0x47f89d(0xeb)],_0x497c0a=_0x8575a9['ip']||_0x8575a9[_0x47f89d(0xff)][_0x47f89d(0x101)]||_0x47f89d(0xfd),_0x32f14f=_0x8575a9[_0x47f89d(0x108)]('User-Agent')||_0x47f89d(0xfd);let _0x18598e=![],_0x8b9e04=null;try{const _0x301c2a=await this[_0x47f89d(0x100)]['login'](_0x1834a5);_0x18598e=!![],_0x301c2a[_0x47f89d(0x10f)]==='shop'&&_0x301c2a[_0x47f89d(0xea)]?.['id']&&(_0x8b9e04=_0x301c2a[_0x47f89d(0xea)]['id']),_0x8b9e04&&await telegramBotService_1['telegramBotService']['sendLoginNotification'](_0x8b9e04,{'username':_0x1834a5[_0x47f89d(0xe9)],'ipAddress':_0x497c0a,'userAgent':_0x32f14f,'timestamp':new Date(),'success':!![]}),_0x4ef3b0[_0x47f89d(0xf5)]({'success':!![],'result':_0x301c2a});}catch(_0x32d49a){try{const _0x547355=(await Promise[_0x47f89d(0x102)]()['then'](()=>__importStar(require(_0x47f89d(0xfa)))))[_0x47f89d(0x104)],_0x5e814b=await _0x547355[_0x47f89d(0x10c)]['findUnique']({'where':{'username':_0x1834a5[_0x47f89d(0xe9)]},'select':{'id':!![]}});_0x5e814b&&await telegramBotService_1[_0x47f89d(0x103)][_0x47f89d(0xf8)](_0x5e814b['id'],{'username':_0x1834a5[_0x47f89d(0xe9)],'ipAddress':_0x497c0a,'userAgent':_0x32f14f,'timestamp':new Date(),'success':![]});}catch(_0x5568c2){console['error']('Failed\x20to\x20send\x20failed\x20login\x20notification:',_0x5568c2);}throw _0x32d49a;}}catch(_0xa04c2){_0x13f35a(_0xa04c2);}},this['me']=async(_0x48a682,_0x350e8f,_0x2a8838)=>{const _0x5dd756=_0x5c8c19;try{const _0xc799d9=_0x48a682[_0x5dd756(0xea)];_0x350e8f[_0x5dd756(0xf5)]({'success':!![],'result':{'id':_0xc799d9?.['id'],'username':_0xc799d9?.[_0x5dd756(0xe9)],'role':_0xc799d9?.[_0x5dd756(0x10f)]}});}catch(_0x59eb6d){_0x2a8838(_0x59eb6d);}},this[_0x5c8c19(0xf9)]=async(_0x1b23e2,_0x412ff8,_0x162f1c)=>{const _0x243b3d=_0x5c8c19;try{const _0x591522=_0x1b23e2[_0x243b3d(0x10b)],_0x5b11f4=_0x1b23e2[_0x243b3d(0xea)];_0x591522&&_0x5b11f4?.[_0x243b3d(0xe6)]&&tokenBlacklistService_1['tokenBlacklistService']['blacklistToken'](_0x591522,_0x5b11f4[_0x243b3d(0xe6)]),_0x412ff8['json']({'success':!![],'message':_0x243b3d(0xf0)});}catch(_0x2a1174){_0x162f1c(_0x2a1174);}},this['getBlacklistStats']=async(_0x28feb3,_0x5b1ba7,_0x351ef8)=>{const _0x129bc6=_0x5c8c19;try{const _0x3344e0=tokenBlacklistService_1[_0x129bc6(0x10d)][_0x129bc6(0xe3)]();_0x5b1ba7[_0x129bc6(0xf5)]({'success':!![],'result':_0x3344e0});}catch(_0x17b727){_0x351ef8(_0x17b727);}},this[_0x5c8c19(0x100)]=new authService_1['AuthService']();}}function a4_0x3bf7(){const _0x5e5e93=['322968uRmqYX','defineProperty','__createBinding','Logged\x20out\x20successfully','writable','../services/tokenBlacklistService','AuthController','280344DcYnbn','json','prototype','302701xJTMNF','sendLoginNotification','logout','../config/database','1001220vdVXNZ','create','unknown','length','connection','authService','remoteAddress','resolve','telegramBotService','default','734008zgKJrh','login','getOwnPropertyNames','get','2TyiIvX','configurable','token','shop','tokenBlacklistService','hasOwnProperty','role','__setModuleDefault','__importStar','getStats','180662DPjGKt','2594871dJPbaa','exp','../services/telegramBotService','__esModule','username','user','body','32VMaGua'];a4_0x3bf7=function(){return _0x5e5e93;};return a4_0x3bf7();}exports[a4_0x25d8b7(0xf3)]=AuthController;