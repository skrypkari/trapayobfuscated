'use strict';function a4_0x4b5f(){const _0x560246=['remoteAddress','telegramBotService','__esModule','then','32865745dnMlrb','9044110QzwEUF','authService','Failed\x20to\x20send\x20failed\x20login\x20notification:','7069705EkpeVe','../services/telegramBotService','length','getOwnPropertyDescriptor','9085815vGxfFs','../services/authService','defineProperty','__setModuleDefault','resolve','shop','unknown','username','exp','tokenBlacklistService','__importStar','sendLoginNotification','user','findUnique','User-Agent','writable','body','238SIQjHw','default','get','AuthService','130vngjOo','role','getBlacklistStats','json','configurable','4778Lokmnk','login','__createBinding','AuthController','5052qhgFiy','8XuJpwj','../config/database','prototype','12378qMfqUK','error','hasOwnProperty','388InubkR'];a4_0x4b5f=function(){return _0x560246;};return a4_0x4b5f();}const a4_0x5dc088=a4_0x436f;function a4_0x436f(_0x2dc2ff,_0x17ca6d){const _0x4b5fd8=a4_0x4b5f();return a4_0x436f=function(_0x436f39,_0x53efa1){_0x436f39=_0x436f39-0xb8;let _0x41a118=_0x4b5fd8[_0x436f39];return _0x41a118;},a4_0x436f(_0x2dc2ff,_0x17ca6d);}(function(_0x14eba1,_0x10ce4e){const _0x1a8250=a4_0x436f,_0xf596c5=_0x14eba1();while(!![]){try{const _0x23fd8e=parseInt(_0x1a8250(0xc0))/0x1*(-parseInt(_0x1a8250(0xc5))/0x2)+parseInt(_0x1a8250(0xcd))/0x3*(-parseInt(_0x1a8250(0xd0))/0x4)+-parseInt(_0x1a8250(0xd9))/0x5+-parseInt(_0x1a8250(0xc9))/0x6*(parseInt(_0x1a8250(0xbc))/0x7)+-parseInt(_0x1a8250(0xca))/0x8*(-parseInt(_0x1a8250(0xdd))/0x9)+-parseInt(_0x1a8250(0xd6))/0xa+parseInt(_0x1a8250(0xd5))/0xb;if(_0x23fd8e===_0x10ce4e)break;else _0xf596c5['push'](_0xf596c5['shift']());}catch(_0x468eff){_0xf596c5['push'](_0xf596c5['shift']());}}}(a4_0x4b5f,0xe5626));var __createBinding=this&&this[a4_0x5dc088(0xc7)]||(Object['create']?function(_0xec83fb,_0x3a5695,_0x20fc15,_0x5f1150){const _0x4b0ae8=a4_0x5dc088;if(_0x5f1150===undefined)_0x5f1150=_0x20fc15;var _0x360244=Object[_0x4b0ae8(0xdc)](_0x3a5695,_0x20fc15);(!_0x360244||(_0x4b0ae8(0xbe)in _0x360244?!_0x3a5695[_0x4b0ae8(0xd3)]:_0x360244[_0x4b0ae8(0xba)]||_0x360244[_0x4b0ae8(0xc4)]))&&(_0x360244={'enumerable':!![],'get':function(){return _0x3a5695[_0x20fc15];}}),Object[_0x4b0ae8(0xdf)](_0xec83fb,_0x5f1150,_0x360244);}:function(_0x4231e1,_0xe582fb,_0x19edac,_0x4d3546){if(_0x4d3546===undefined)_0x4d3546=_0x19edac;_0x4231e1[_0x4d3546]=_0xe582fb[_0x19edac];}),__setModuleDefault=this&&this[a4_0x5dc088(0xe0)]||(Object['create']?function(_0x43dc83,_0x44c5da){const _0x2f7ece=a4_0x5dc088;Object[_0x2f7ece(0xdf)](_0x43dc83,'default',{'enumerable':!![],'value':_0x44c5da});}:function(_0xc30af4,_0x24a2af){const _0x1d2052=a4_0x5dc088;_0xc30af4[_0x1d2052(0xbd)]=_0x24a2af;}),__importStar=this&&this[a4_0x5dc088(0xe7)]||(function(){var _0x251251=function(_0x1ee97a){return _0x251251=Object['getOwnPropertyNames']||function(_0x1be466){const _0x387973=a4_0x436f;var _0x5930ec=[];for(var _0x21fd83 in _0x1be466)if(Object[_0x387973(0xcc)][_0x387973(0xcf)]['call'](_0x1be466,_0x21fd83))_0x5930ec[_0x5930ec[_0x387973(0xdb)]]=_0x21fd83;return _0x5930ec;},_0x251251(_0x1ee97a);};return function(_0x4f80e0){const _0xd8e608=a4_0x436f;if(_0x4f80e0&&_0x4f80e0[_0xd8e608(0xd3)])return _0x4f80e0;var _0x5b5dc4={};if(_0x4f80e0!=null){for(var _0x27170a=_0x251251(_0x4f80e0),_0x205e3d=0x0;_0x205e3d<_0x27170a[_0xd8e608(0xdb)];_0x205e3d++)if(_0x27170a[_0x205e3d]!==_0xd8e608(0xbd))__createBinding(_0x5b5dc4,_0x4f80e0,_0x27170a[_0x205e3d]);}return __setModuleDefault(_0x5b5dc4,_0x4f80e0),_0x5b5dc4;};}());Object[a4_0x5dc088(0xdf)](exports,a4_0x5dc088(0xd3),{'value':!![]}),exports[a4_0x5dc088(0xc8)]=void 0x0;const authService_1=require(a4_0x5dc088(0xde)),tokenBlacklistService_1=require('../services/tokenBlacklistService'),telegramBotService_1=require(a4_0x5dc088(0xda));class AuthController{constructor(){const _0x1479a3=a4_0x5dc088;this[_0x1479a3(0xc6)]=async(_0x5b5d74,_0x2ef95f,_0x15d80a)=>{const _0x437f3b=_0x1479a3;try{const _0x5ba389=_0x5b5d74[_0x437f3b(0xbb)],_0x12af36=_0x5b5d74['ip']||_0x5b5d74['connection'][_0x437f3b(0xd1)]||_0x437f3b(0xe3),_0x12d3e7=_0x5b5d74[_0x437f3b(0xbe)](_0x437f3b(0xb9))||_0x437f3b(0xe3);let _0x477e61=![],_0x51a161=null;try{const _0x5772f2=await this[_0x437f3b(0xd7)][_0x437f3b(0xc6)](_0x5ba389);_0x477e61=!![],_0x5772f2[_0x437f3b(0xc1)]===_0x437f3b(0xe2)&&_0x5772f2[_0x437f3b(0xe9)]?.['id']&&(_0x51a161=_0x5772f2[_0x437f3b(0xe9)]['id']),_0x51a161&&await telegramBotService_1[_0x437f3b(0xd2)][_0x437f3b(0xe8)](_0x51a161,{'username':_0x5ba389[_0x437f3b(0xe4)],'ipAddress':_0x12af36,'userAgent':_0x12d3e7,'timestamp':new Date(),'success':!![]}),_0x2ef95f[_0x437f3b(0xc3)]({'success':!![],'result':_0x5772f2});}catch(_0x3f87ea){try{const _0x2ab2f5=(await Promise[_0x437f3b(0xe1)]()[_0x437f3b(0xd4)](()=>__importStar(require(_0x437f3b(0xcb)))))[_0x437f3b(0xbd)],_0x10fa1e=await _0x2ab2f5[_0x437f3b(0xe2)][_0x437f3b(0xb8)]({'where':{'username':_0x5ba389[_0x437f3b(0xe4)]},'select':{'id':!![]}});_0x10fa1e&&await telegramBotService_1['telegramBotService'][_0x437f3b(0xe8)](_0x10fa1e['id'],{'username':_0x5ba389[_0x437f3b(0xe4)],'ipAddress':_0x12af36,'userAgent':_0x12d3e7,'timestamp':new Date(),'success':![]});}catch(_0x329cac){console[_0x437f3b(0xce)](_0x437f3b(0xd8),_0x329cac);}throw _0x3f87ea;}}catch(_0x3e61ae){_0x15d80a(_0x3e61ae);}},this['me']=async(_0x3cbac4,_0x4c6637,_0x46bf60)=>{const _0x582d6b=_0x1479a3;try{const _0x3ed39c=_0x3cbac4[_0x582d6b(0xe9)];_0x4c6637[_0x582d6b(0xc3)]({'success':!![],'result':{'id':_0x3ed39c?.['id'],'username':_0x3ed39c?.[_0x582d6b(0xe4)],'role':_0x3ed39c?.[_0x582d6b(0xc1)]}});}catch(_0x1c15f5){_0x46bf60(_0x1c15f5);}},this['logout']=async(_0x3f1d11,_0x26e2ba,_0x41c64c)=>{const _0x5e3582=_0x1479a3;try{const _0x39e1af=_0x3f1d11['token'],_0x53c1ec=_0x3f1d11[_0x5e3582(0xe9)];_0x39e1af&&_0x53c1ec?.[_0x5e3582(0xe5)]&&tokenBlacklistService_1[_0x5e3582(0xe6)]['blacklistToken'](_0x39e1af,_0x53c1ec[_0x5e3582(0xe5)]),_0x26e2ba[_0x5e3582(0xc3)]({'success':!![],'message':'Logged\x20out\x20successfully'});}catch(_0x33d7cf){_0x41c64c(_0x33d7cf);}},this[_0x1479a3(0xc2)]=async(_0x3fc93b,_0x2aa8db,_0x3f6f83)=>{const _0x441308=_0x1479a3;try{const _0x59bee4=tokenBlacklistService_1[_0x441308(0xe6)]['getStats']();_0x2aa8db['json']({'success':!![],'result':_0x59bee4});}catch(_0x11828d){_0x3f6f83(_0x11828d);}},this[_0x1479a3(0xd7)]=new authService_1[(_0x1479a3(0xbf))]();}}exports[a4_0x5dc088(0xc8)]=AuthController;