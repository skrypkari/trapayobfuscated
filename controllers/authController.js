'use strict';function a4_0x3335(_0x1bab9f,_0x5e9f21){_0x1bab9f=_0x1bab9f-0x6a;const _0x22f87b=a4_0x22f8();let _0x333513=_0x22f87b[_0x1bab9f];return _0x333513;}const a4_0x1b98e7=a4_0x3335;(function(_0x5bd163,_0x3d0105){const _0x273446=a4_0x3335,_0x3acbee=_0x5bd163();while(!![]){try{const _0xd7cdcb=parseInt(_0x273446(0x73))/0x1*(parseInt(_0x273446(0x75))/0x2)+parseInt(_0x273446(0x7d))/0x3+parseInt(_0x273446(0x90))/0x4+-parseInt(_0x273446(0x77))/0x5+-parseInt(_0x273446(0x7e))/0x6+parseInt(_0x273446(0x98))/0x7*(parseInt(_0x273446(0x6a))/0x8)+-parseInt(_0x273446(0x92))/0x9;if(_0xd7cdcb===_0x3d0105)break;else _0x3acbee['push'](_0x3acbee['shift']());}catch(_0x5bc7a3){_0x3acbee['push'](_0x3acbee['shift']());}}}(a4_0x22f8,0xac2e1));var __createBinding=this&&this[a4_0x1b98e7(0x8d)]||(Object[a4_0x1b98e7(0x81)]?function(_0x2f6040,_0x341233,_0x2b3460,_0x139404){const _0x19e1a0=a4_0x1b98e7;if(_0x139404===undefined)_0x139404=_0x2b3460;var _0x1d45c2=Object[_0x19e1a0(0x94)](_0x341233,_0x2b3460);(!_0x1d45c2||('get'in _0x1d45c2?!_0x341233[_0x19e1a0(0x6c)]:_0x1d45c2[_0x19e1a0(0x7f)]||_0x1d45c2[_0x19e1a0(0x70)]))&&(_0x1d45c2={'enumerable':!![],'get':function(){return _0x341233[_0x2b3460];}}),Object[_0x19e1a0(0x71)](_0x2f6040,_0x139404,_0x1d45c2);}:function(_0x2623c6,_0x580a96,_0x431c98,_0x21d9c9){if(_0x21d9c9===undefined)_0x21d9c9=_0x431c98;_0x2623c6[_0x21d9c9]=_0x580a96[_0x431c98];}),__setModuleDefault=this&&this[a4_0x1b98e7(0x86)]||(Object[a4_0x1b98e7(0x81)]?function(_0x3deaaf,_0x56a37a){const _0x43b24d=a4_0x1b98e7;Object[_0x43b24d(0x71)](_0x3deaaf,'default',{'enumerable':!![],'value':_0x56a37a});}:function(_0x7cdfe7,_0x1f5032){const _0x4f488f=a4_0x1b98e7;_0x7cdfe7[_0x4f488f(0x79)]=_0x1f5032;}),__importStar=this&&this['__importStar']||(function(){var _0x30b1ae=function(_0x5441cc){return _0x30b1ae=Object['getOwnPropertyNames']||function(_0x10cdb8){const _0x17031b=a4_0x3335;var _0x4ee4a7=[];for(var _0x5156cd in _0x10cdb8)if(Object['prototype'][_0x17031b(0x85)]['call'](_0x10cdb8,_0x5156cd))_0x4ee4a7[_0x4ee4a7[_0x17031b(0x8c)]]=_0x5156cd;return _0x4ee4a7;},_0x30b1ae(_0x5441cc);};return function(_0x1274f6){const _0x47882d=a4_0x3335;if(_0x1274f6&&_0x1274f6['__esModule'])return _0x1274f6;var _0x43267c={};if(_0x1274f6!=null){for(var _0x5e6e8b=_0x30b1ae(_0x1274f6),_0xeda1f8=0x0;_0xeda1f8<_0x5e6e8b[_0x47882d(0x8c)];_0xeda1f8++)if(_0x5e6e8b[_0xeda1f8]!==_0x47882d(0x79))__createBinding(_0x43267c,_0x1274f6,_0x5e6e8b[_0xeda1f8]);}return __setModuleDefault(_0x43267c,_0x1274f6),_0x43267c;};}());Object[a4_0x1b98e7(0x71)](exports,'__esModule',{'value':!![]}),exports[a4_0x1b98e7(0x8e)]=void 0x0;const authService_1=require(a4_0x1b98e7(0x6d)),tokenBlacklistService_1=require(a4_0x1b98e7(0x7b)),telegramBotService_1=require(a4_0x1b98e7(0x6f));class AuthController{constructor(){const _0x4e93dd=a4_0x1b98e7;this[_0x4e93dd(0x8a)]=async(_0x352b55,_0x5aa062,_0x577e49)=>{const _0x303092=_0x4e93dd;try{const _0x4a5506=_0x352b55[_0x303092(0x80)],_0x56da94=_0x4a5506[_0x303092(0x78)]||_0x352b55['ip']||_0x352b55['connection'][_0x303092(0x76)]||'unknown',_0x3e4f30=_0x4a5506['userAgent']||_0x352b55[_0x303092(0x84)](_0x303092(0x72))||'unknown',_0x224529=_0x4a5506[_0x303092(0x6e)];let _0x58d2ae=![],_0xeeb12b=null;try{const _0x1e5920=await this['authService'][_0x303092(0x8a)](_0x4a5506);_0x58d2ae=!![],_0x1e5920['role']===_0x303092(0x8b)&&_0x1e5920['user']?.['id']&&(_0xeeb12b=_0x1e5920[_0x303092(0x83)]['id']),_0xeeb12b&&await telegramBotService_1[_0x303092(0x87)]['sendLoginNotification'](_0xeeb12b,{'username':_0x4a5506[_0x303092(0x6b)],'ipAddress':_0x56da94,'userAgent':_0x3e4f30,'geo':_0x224529,'timestamp':new Date(),'success':!![]}),_0x5aa062[_0x303092(0x74)]({'success':!![],'result':_0x1e5920});}catch(_0x6fecb2){try{const _0x5c84be=(await Promise['resolve']()[_0x303092(0x89)](()=>__importStar(require(_0x303092(0x95)))))[_0x303092(0x79)],_0xad3045=await _0x5c84be[_0x303092(0x8b)][_0x303092(0x91)]({'where':{'username':_0x4a5506['username']},'select':{'id':!![]}});_0xad3045&&await telegramBotService_1['telegramBotService']['sendLoginNotification'](_0xad3045['id'],{'username':_0x4a5506['username'],'ipAddress':_0x56da94,'userAgent':_0x3e4f30,'geo':_0x224529,'timestamp':new Date(),'success':![]});}catch(_0x11552a){console[_0x303092(0x82)]('Failed\x20to\x20send\x20failed\x20login\x20notification:',_0x11552a);}throw _0x6fecb2;}}catch(_0x61ca30){_0x577e49(_0x61ca30);}},this['me']=async(_0x2f4e4e,_0x5ee13c,_0x1969c9)=>{const _0x4a96be=_0x4e93dd;try{const _0x23e4cc=_0x2f4e4e[_0x4a96be(0x83)];_0x5ee13c[_0x4a96be(0x74)]({'success':!![],'result':{'id':_0x23e4cc?.['id'],'username':_0x23e4cc?.['username'],'role':_0x23e4cc?.[_0x4a96be(0x97)]}});}catch(_0x5bcf02){_0x1969c9(_0x5bcf02);}},this[_0x4e93dd(0x7c)]=async(_0x4f9c49,_0x4fa497,_0x5c2e6b)=>{const _0x1ee7fb=_0x4e93dd;try{const _0x428cbc=_0x4f9c49[_0x1ee7fb(0x88)],_0x109f06=_0x4f9c49[_0x1ee7fb(0x83)];_0x428cbc&&_0x109f06?.[_0x1ee7fb(0x93)]&&tokenBlacklistService_1['tokenBlacklistService']['blacklistToken'](_0x428cbc,_0x109f06[_0x1ee7fb(0x93)]),_0x4fa497[_0x1ee7fb(0x74)]({'success':!![],'message':_0x1ee7fb(0x7a)});}catch(_0x31bd0f){_0x5c2e6b(_0x31bd0f);}},this['getBlacklistStats']=async(_0x269598,_0x23f3f5,_0x12a151)=>{const _0x3c46a6=_0x4e93dd;try{const _0x763bcb=tokenBlacklistService_1['tokenBlacklistService']['getStats']();_0x23f3f5[_0x3c46a6(0x74)]({'success':!![],'result':_0x763bcb});}catch(_0x31e622){_0x12a151(_0x31e622);}},this[_0x4e93dd(0x96)]=new authService_1[(_0x4e93dd(0x8f))]();}}exports[a4_0x1b98e7(0x8e)]=AuthController;function a4_0x22f8(){const _0x36120b=['body','create','error','user','get','hasOwnProperty','__setModuleDefault','telegramBotService','token','then','login','shop','length','__createBinding','AuthController','AuthService','918400RGBFuf','findUnique','13236363EfoKKD','exp','getOwnPropertyDescriptor','../config/database','authService','role','157171daVahA','80HTZFCT','username','__esModule','../services/authService','geo','../services/telegramBotService','configurable','defineProperty','User-Agent','47REzyCJ','json','52376rUQtkF','remoteAddress','2247785BFNKUm','ipAddress','default','Logged\x20out\x20successfully','../services/tokenBlacklistService','logout','3113106xFDyNh','582930ZHdyCJ','writable'];a4_0x22f8=function(){return _0x36120b;};return a4_0x22f8();}