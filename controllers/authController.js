'use strict';const a4_0x318584=a4_0x40a8;function a4_0x1522(){const _0x1d2519=['198167RaciSt','authService','366ZOxGNQ','7209670EKOEaa','__createBinding','blacklistToken','12opiarY','1513797gjtGln','User-Agent','user','__esModule','json','role','shop','AuthService','../services/authService','error','resolve','7944YmHlYz','username','token','../services/tokenBlacklistService','unknown','5312252AuAyGU','body','default','writable','findUnique','__importStar','7434yGKwJZ','hasOwnProperty','call','54446yeiwyB','133880CAQeMo','exp','length','get','getStats','configurable','../config/database','telegramBotService','70dwtIrg','getOwnPropertyNames','../services/telegramBotService','AuthController','Failed\x20to\x20send\x20failed\x20login\x20notification:','login','tokenBlacklistService','sendLoginNotification','prototype','defineProperty','getBlacklistStats'];a4_0x1522=function(){return _0x1d2519;};return a4_0x1522();}(function(_0x8c39c0,_0x36d315){const _0x3347b7=a4_0x40a8,_0x20ecbb=_0x8c39c0();while(!![]){try{const _0x494e4d=parseInt(_0x3347b7(0xa4))/0x1*(parseInt(_0x3347b7(0xaa))/0x2)+parseInt(_0x3347b7(0x77))/0x3+-parseInt(_0x3347b7(0x91))/0x4*(-parseInt(_0x3347b7(0x99))/0x5)+-parseInt(_0x3347b7(0xa6))/0x6*(-parseInt(_0x3347b7(0x90))/0x7)+-parseInt(_0x3347b7(0x82))/0x8*(parseInt(_0x3347b7(0x8d))/0x9)+-parseInt(_0x3347b7(0xa7))/0xa+-parseInt(_0x3347b7(0x87))/0xb;if(_0x494e4d===_0x36d315)break;else _0x20ecbb['push'](_0x20ecbb['shift']());}catch(_0xc904c7){_0x20ecbb['push'](_0x20ecbb['shift']());}}}(a4_0x1522,0x958aa));function a4_0x40a8(_0x4c0b3e,_0x38599c){const _0x152232=a4_0x1522();return a4_0x40a8=function(_0x40a85f,_0x4ec575){_0x40a85f=_0x40a85f-0x77;let _0x50c265=_0x152232[_0x40a85f];return _0x50c265;},a4_0x40a8(_0x4c0b3e,_0x38599c);}var __createBinding=this&&this[a4_0x318584(0xa8)]||(Object['create']?function(_0x20aaa4,_0x36c7df,_0x355967,_0x5a87cf){const _0x2a67b6=a4_0x318584;if(_0x5a87cf===undefined)_0x5a87cf=_0x355967;var _0x3da15c=Object['getOwnPropertyDescriptor'](_0x36c7df,_0x355967);(!_0x3da15c||('get'in _0x3da15c?!_0x36c7df[_0x2a67b6(0x7a)]:_0x3da15c[_0x2a67b6(0x8a)]||_0x3da15c[_0x2a67b6(0x96)]))&&(_0x3da15c={'enumerable':!![],'get':function(){return _0x36c7df[_0x355967];}}),Object[_0x2a67b6(0xa2)](_0x20aaa4,_0x5a87cf,_0x3da15c);}:function(_0x1b0529,_0x3920ab,_0x2f8f5c,_0x2d6e40){if(_0x2d6e40===undefined)_0x2d6e40=_0x2f8f5c;_0x1b0529[_0x2d6e40]=_0x3920ab[_0x2f8f5c];}),__setModuleDefault=this&&this['__setModuleDefault']||(Object['create']?function(_0x3f8ecf,_0x58fb8c){const _0x55e689=a4_0x318584;Object['defineProperty'](_0x3f8ecf,_0x55e689(0x89),{'enumerable':!![],'value':_0x58fb8c});}:function(_0x561a83,_0x8ef8ab){const _0x5ddf52=a4_0x318584;_0x561a83[_0x5ddf52(0x89)]=_0x8ef8ab;}),__importStar=this&&this[a4_0x318584(0x8c)]||(function(){var _0x3f5017=function(_0x2f06c0){const _0xd514e2=a4_0x40a8;return _0x3f5017=Object[_0xd514e2(0x9a)]||function(_0x5496cf){const _0x2316e0=_0xd514e2;var _0x3f2053=[];for(var _0x377053 in _0x5496cf)if(Object[_0x2316e0(0xa1)][_0x2316e0(0x8e)][_0x2316e0(0x8f)](_0x5496cf,_0x377053))_0x3f2053[_0x3f2053[_0x2316e0(0x93)]]=_0x377053;return _0x3f2053;},_0x3f5017(_0x2f06c0);};return function(_0xa910ae){const _0x3d7ecb=a4_0x40a8;if(_0xa910ae&&_0xa910ae[_0x3d7ecb(0x7a)])return _0xa910ae;var _0x575ab8={};if(_0xa910ae!=null){for(var _0x1ed821=_0x3f5017(_0xa910ae),_0x155bf7=0x0;_0x155bf7<_0x1ed821[_0x3d7ecb(0x93)];_0x155bf7++)if(_0x1ed821[_0x155bf7]!=='default')__createBinding(_0x575ab8,_0xa910ae,_0x1ed821[_0x155bf7]);}return __setModuleDefault(_0x575ab8,_0xa910ae),_0x575ab8;};}());Object['defineProperty'](exports,a4_0x318584(0x7a),{'value':!![]}),exports[a4_0x318584(0x9c)]=void 0x0;const authService_1=require(a4_0x318584(0x7f)),tokenBlacklistService_1=require(a4_0x318584(0x85)),telegramBotService_1=require(a4_0x318584(0x9b));class AuthController{constructor(){const _0xe6bb1d=a4_0x318584;this[_0xe6bb1d(0x9e)]=async(_0x1865e4,_0x5232ac,_0xa88461)=>{const _0x4db315=_0xe6bb1d;try{const _0x4dd52d=_0x1865e4[_0x4db315(0x88)],_0x2ca39a=_0x1865e4['ip']||_0x1865e4['connection']['remoteAddress']||_0x4db315(0x86),_0x502844=_0x1865e4[_0x4db315(0x94)](_0x4db315(0x78))||_0x4db315(0x86);let _0x111731=![],_0x3e36aa=null;try{const _0x58010c=await this[_0x4db315(0xa5)]['login'](_0x4dd52d);_0x111731=!![],_0x58010c['role']===_0x4db315(0x7d)&&_0x58010c[_0x4db315(0x79)]?.['id']&&(_0x3e36aa=_0x58010c[_0x4db315(0x79)]['id']),_0x3e36aa&&await telegramBotService_1['telegramBotService'][_0x4db315(0xa0)](_0x3e36aa,{'username':_0x4dd52d[_0x4db315(0x83)],'ipAddress':_0x2ca39a,'userAgent':_0x502844,'timestamp':new Date(),'success':!![]}),_0x5232ac[_0x4db315(0x7b)]({'success':!![],'result':_0x58010c});}catch(_0x1b60e9){try{const _0x4a2233=(await Promise[_0x4db315(0x81)]()['then'](()=>__importStar(require(_0x4db315(0x97)))))[_0x4db315(0x89)],_0x1a4407=await _0x4a2233[_0x4db315(0x7d)][_0x4db315(0x8b)]({'where':{'username':_0x4dd52d['username']},'select':{'id':!![]}});_0x1a4407&&await telegramBotService_1[_0x4db315(0x98)]['sendLoginNotification'](_0x1a4407['id'],{'username':_0x4dd52d[_0x4db315(0x83)],'ipAddress':_0x2ca39a,'userAgent':_0x502844,'timestamp':new Date(),'success':![]});}catch(_0x68f3ad){console[_0x4db315(0x80)](_0x4db315(0x9d),_0x68f3ad);}throw _0x1b60e9;}}catch(_0x3297b6){_0xa88461(_0x3297b6);}},this['me']=async(_0x54951f,_0x2d8f48,_0x3770fa)=>{const _0x84cabb=_0xe6bb1d;try{const _0x5521f2=_0x54951f[_0x84cabb(0x79)];_0x2d8f48[_0x84cabb(0x7b)]({'success':!![],'result':{'id':_0x5521f2?.['id'],'username':_0x5521f2?.[_0x84cabb(0x83)],'role':_0x5521f2?.[_0x84cabb(0x7c)]}});}catch(_0x271853){_0x3770fa(_0x271853);}},this['logout']=async(_0x12fd0e,_0x1a2312,_0x9f9f0b)=>{const _0x53c2e0=_0xe6bb1d;try{const _0x3f29d1=_0x12fd0e[_0x53c2e0(0x84)],_0x2cc07c=_0x12fd0e[_0x53c2e0(0x79)];_0x3f29d1&&_0x2cc07c?.['exp']&&tokenBlacklistService_1[_0x53c2e0(0x9f)][_0x53c2e0(0xa9)](_0x3f29d1,_0x2cc07c[_0x53c2e0(0x92)]),_0x1a2312['json']({'success':!![],'message':'Logged\x20out\x20successfully'});}catch(_0x3e5b4f){_0x9f9f0b(_0x3e5b4f);}},this[_0xe6bb1d(0xa3)]=async(_0x1820d0,_0x2fbab4,_0xbc39e4)=>{const _0x4709ea=_0xe6bb1d;try{const _0x526006=tokenBlacklistService_1[_0x4709ea(0x9f)][_0x4709ea(0x95)]();_0x2fbab4[_0x4709ea(0x7b)]({'success':!![],'result':_0x526006});}catch(_0x2c9bfd){_0xbc39e4(_0x2c9bfd);}},this[_0xe6bb1d(0xa5)]=new authService_1[(_0xe6bb1d(0x7e))]();}}exports[a4_0x318584(0x9c)]=AuthController;