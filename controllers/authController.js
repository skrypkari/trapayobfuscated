'use strict';const a4_0x248afd=a4_0x18e3;(function(_0x13bc39,_0x3106de){const _0x3a7bdf=a4_0x18e3,_0xb84a29=_0x13bc39();while(!![]){try{const _0x4c6462=-parseInt(_0x3a7bdf(0x163))/0x1+-parseInt(_0x3a7bdf(0x155))/0x2*(-parseInt(_0x3a7bdf(0x151))/0x3)+-parseInt(_0x3a7bdf(0x154))/0x4*(-parseInt(_0x3a7bdf(0x180))/0x5)+parseInt(_0x3a7bdf(0x15b))/0x6+parseInt(_0x3a7bdf(0x165))/0x7*(-parseInt(_0x3a7bdf(0x158))/0x8)+-parseInt(_0x3a7bdf(0x15d))/0x9+-parseInt(_0x3a7bdf(0x153))/0xa*(-parseInt(_0x3a7bdf(0x15a))/0xb);if(_0x4c6462===_0x3106de)break;else _0xb84a29['push'](_0xb84a29['shift']());}catch(_0x442358){_0xb84a29['push'](_0xb84a29['shift']());}}}(a4_0x29fa,0x38b63));var __createBinding=this&&this[a4_0x248afd(0x14d)]||(Object[a4_0x248afd(0x174)]?function(_0x44ad74,_0x5a02a5,_0x1824ca,_0x2c0667){const _0x31d9e5=a4_0x248afd;if(_0x2c0667===undefined)_0x2c0667=_0x1824ca;var _0x44d6ab=Object['getOwnPropertyDescriptor'](_0x5a02a5,_0x1824ca);(!_0x44d6ab||(_0x31d9e5(0x16c)in _0x44d6ab?!_0x5a02a5[_0x31d9e5(0x15f)]:_0x44d6ab[_0x31d9e5(0x168)]||_0x44d6ab[_0x31d9e5(0x16e)]))&&(_0x44d6ab={'enumerable':!![],'get':function(){return _0x5a02a5[_0x1824ca];}}),Object[_0x31d9e5(0x15c)](_0x44ad74,_0x2c0667,_0x44d6ab);}:function(_0x1141e5,_0x33405f,_0x2f8f93,_0xe352f4){if(_0xe352f4===undefined)_0xe352f4=_0x2f8f93;_0x1141e5[_0xe352f4]=_0x33405f[_0x2f8f93];}),__setModuleDefault=this&&this[a4_0x248afd(0x14e)]||(Object[a4_0x248afd(0x174)]?function(_0x4024ab,_0x493a9a){const _0x440f03=a4_0x248afd;Object['defineProperty'](_0x4024ab,_0x440f03(0x159),{'enumerable':!![],'value':_0x493a9a});}:function(_0x5dc906,_0xee45b2){_0x5dc906['default']=_0xee45b2;}),__importStar=this&&this[a4_0x248afd(0x157)]||(function(){var _0x313d3f=function(_0x58cf56){const _0x6f42e7=a4_0x18e3;return _0x313d3f=Object[_0x6f42e7(0x16b)]||function(_0x39debb){const _0x302d6b=_0x6f42e7;var _0x3931f6=[];for(var _0xf562fd in _0x39debb)if(Object[_0x302d6b(0x176)]['hasOwnProperty'][_0x302d6b(0x17d)](_0x39debb,_0xf562fd))_0x3931f6[_0x3931f6[_0x302d6b(0x17e)]]=_0xf562fd;return _0x3931f6;},_0x313d3f(_0x58cf56);};return function(_0x454e14){const _0x220e87=a4_0x18e3;if(_0x454e14&&_0x454e14[_0x220e87(0x15f)])return _0x454e14;var _0x516519={};if(_0x454e14!=null){for(var _0x4c4571=_0x313d3f(_0x454e14),_0x2f260c=0x0;_0x2f260c<_0x4c4571[_0x220e87(0x17e)];_0x2f260c++)if(_0x4c4571[_0x2f260c]!==_0x220e87(0x159))__createBinding(_0x516519,_0x454e14,_0x4c4571[_0x2f260c]);}return __setModuleDefault(_0x516519,_0x454e14),_0x516519;};}());Object[a4_0x248afd(0x15c)](exports,a4_0x248afd(0x15f),{'value':!![]}),exports[a4_0x248afd(0x160)]=void 0x0;function a4_0x18e3(_0x487d29,_0x568513){const _0x29fa12=a4_0x29fa();return a4_0x18e3=function(_0x18e384,_0x535edd){_0x18e384=_0x18e384-0x14d;let _0x59cd12=_0x29fa12[_0x18e384];return _0x59cd12;},a4_0x18e3(_0x487d29,_0x568513);}function a4_0x29fa(){const _0xb95a4d=['364144GeChjq','308466eDxmaN','defineProperty','660942HWHZgh','connection','__esModule','AuthController','resolve','unknown','339035NSZdVH','telegramBotService','1624OAhGgF','then','login','writable','../services/tokenBlacklistService','sendLoginNotification','getOwnPropertyNames','get','json','configurable','tokenBlacklistService','user','username','User-Agent','shop','create','logout','prototype','../config/database','Logged\x20out\x20successfully','exp','getBlacklistStats','../services/telegramBotService','error','call','length','../services/authService','35dbeQRx','findUnique','__createBinding','__setModuleDefault','token','role','3EzZCgs','authService','30oTeWCl','203108aSGkhz','510596qBsVtd','getStats','__importStar','4024FvtPia','default'];a4_0x29fa=function(){return _0xb95a4d;};return a4_0x29fa();}const authService_1=require(a4_0x248afd(0x17f)),tokenBlacklistService_1=require(a4_0x248afd(0x169)),telegramBotService_1=require(a4_0x248afd(0x17b));class AuthController{constructor(){const _0x2832f2=a4_0x248afd;this[_0x2832f2(0x167)]=async(_0x39b372,_0xce852,_0xfd8038)=>{const _0x5ea809=_0x2832f2;try{const _0x50202e=_0x39b372['body'],_0x4c5629=_0x39b372['ip']||_0x39b372[_0x5ea809(0x15e)]['remoteAddress']||_0x5ea809(0x162),_0x1ce08f=_0x39b372[_0x5ea809(0x16c)](_0x5ea809(0x172))||_0x5ea809(0x162);let _0x2beea3=![],_0x208ad1=null;try{const _0x3b4507=await this[_0x5ea809(0x152)][_0x5ea809(0x167)](_0x50202e);_0x2beea3=!![],_0x3b4507['role']===_0x5ea809(0x173)&&_0x3b4507[_0x5ea809(0x170)]?.['id']&&(_0x208ad1=_0x3b4507[_0x5ea809(0x170)]['id']),_0x208ad1&&await telegramBotService_1['telegramBotService'][_0x5ea809(0x16a)](_0x208ad1,{'username':_0x50202e[_0x5ea809(0x171)],'ipAddress':_0x4c5629,'userAgent':_0x1ce08f,'timestamp':new Date(),'success':!![]}),_0xce852[_0x5ea809(0x16d)]({'success':!![],'result':_0x3b4507});}catch(_0x3e829c){try{const _0x1d6a96=(await Promise[_0x5ea809(0x161)]()[_0x5ea809(0x166)](()=>__importStar(require(_0x5ea809(0x177)))))['default'],_0x3b3ef7=await _0x1d6a96[_0x5ea809(0x173)][_0x5ea809(0x181)]({'where':{'username':_0x50202e[_0x5ea809(0x171)]},'select':{'id':!![]}});_0x3b3ef7&&await telegramBotService_1[_0x5ea809(0x164)][_0x5ea809(0x16a)](_0x3b3ef7['id'],{'username':_0x50202e[_0x5ea809(0x171)],'ipAddress':_0x4c5629,'userAgent':_0x1ce08f,'timestamp':new Date(),'success':![]});}catch(_0x34b4ef){console[_0x5ea809(0x17c)]('Failed\x20to\x20send\x20failed\x20login\x20notification:',_0x34b4ef);}throw _0x3e829c;}}catch(_0x44a709){_0xfd8038(_0x44a709);}},this['me']=async(_0x574bfc,_0x2bc85c,_0x6a3090)=>{const _0x50a9ec=_0x2832f2;try{const _0x4e84c1=_0x574bfc[_0x50a9ec(0x170)];_0x2bc85c[_0x50a9ec(0x16d)]({'success':!![],'result':{'id':_0x4e84c1?.['id'],'username':_0x4e84c1?.['username'],'role':_0x4e84c1?.[_0x50a9ec(0x150)]}});}catch(_0x5b3d06){_0x6a3090(_0x5b3d06);}},this[_0x2832f2(0x175)]=async(_0x1a6853,_0x4f7fca,_0x48c47d)=>{const _0x13d8b4=_0x2832f2;try{const _0x46ab90=_0x1a6853[_0x13d8b4(0x14f)],_0x29878d=_0x1a6853[_0x13d8b4(0x170)];_0x46ab90&&_0x29878d?.['exp']&&tokenBlacklistService_1[_0x13d8b4(0x16f)]['blacklistToken'](_0x46ab90,_0x29878d[_0x13d8b4(0x179)]),_0x4f7fca['json']({'success':!![],'message':_0x13d8b4(0x178)});}catch(_0x19f76b){_0x48c47d(_0x19f76b);}},this[_0x2832f2(0x17a)]=async(_0x5183c2,_0x46dc21,_0x58b7eb)=>{const _0x280b0f=_0x2832f2;try{const _0x1f2f6a=tokenBlacklistService_1[_0x280b0f(0x16f)][_0x280b0f(0x156)]();_0x46dc21[_0x280b0f(0x16d)]({'success':!![],'result':_0x1f2f6a});}catch(_0x4eca9e){_0x58b7eb(_0x4eca9e);}},this[_0x2832f2(0x152)]=new authService_1['AuthService']();}}exports[a4_0x248afd(0x160)]=AuthController;