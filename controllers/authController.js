'use strict';const a4_0xa459ba=a4_0x3cbf;(function(_0x4a6a5e,_0x593959){const _0x30715e=a4_0x3cbf,_0x18c997=_0x4a6a5e();while(!![]){try{const _0x283d22=-parseInt(_0x30715e(0x17a))/0x1*(parseInt(_0x30715e(0x17d))/0x2)+parseInt(_0x30715e(0x16f))/0x3+-parseInt(_0x30715e(0x180))/0x4*(-parseInt(_0x30715e(0x182))/0x5)+parseInt(_0x30715e(0x17f))/0x6*(-parseInt(_0x30715e(0x15a))/0x7)+parseInt(_0x30715e(0x15b))/0x8*(-parseInt(_0x30715e(0x16a))/0x9)+parseInt(_0x30715e(0x162))/0xa+parseInt(_0x30715e(0x17c))/0xb*(parseInt(_0x30715e(0x161))/0xc);if(_0x283d22===_0x593959)break;else _0x18c997['push'](_0x18c997['shift']());}catch(_0x446507){_0x18c997['push'](_0x18c997['shift']());}}}(a4_0x4075,0xe1010));function a4_0x4075(){const _0x41a44c=['shop','json','exp','telegramBotService','getOwnPropertyDescriptor','username','sendLoginNotification','__esModule','default','then','3921113XmCRHE','179824gmBTJm','create','get','Failed\x20to\x20send\x20failed\x20login\x20notification:','login','defineProperty','246180xKbkWa','6281640aVjVhA','../services/tokenBlacklistService','authService','__importStar','token','findUnique','length','tokenBlacklistService','117qkbbSC','AuthService','role','configurable','../config/database','2177886mdqqCU','body','getBlacklistStats','__createBinding','../services/telegramBotService','logout','resolve','AuthController','unknown','writable','user','1FtVEyC','blacklistToken','594FxwvMU','201558yKpiYP','connection','18FmxzPx','213260RPjDfE','__setModuleDefault','50wDwEzZ','getOwnPropertyNames'];a4_0x4075=function(){return _0x41a44c;};return a4_0x4075();}function a4_0x3cbf(_0x321eec,_0x40c0c9){const _0x407570=a4_0x4075();return a4_0x3cbf=function(_0x3cbf9a,_0x487e74){_0x3cbf9a=_0x3cbf9a-0x150;let _0x2e9e21=_0x407570[_0x3cbf9a];return _0x2e9e21;},a4_0x3cbf(_0x321eec,_0x40c0c9);}var __createBinding=this&&this[a4_0xa459ba(0x172)]||(Object[a4_0xa459ba(0x15c)]?function(_0x3d63c7,_0xc419eb,_0x1e4c49,_0x551e3e){const _0x573716=a4_0xa459ba;if(_0x551e3e===undefined)_0x551e3e=_0x1e4c49;var _0x118dac=Object[_0x573716(0x154)](_0xc419eb,_0x1e4c49);(!_0x118dac||(_0x573716(0x15d)in _0x118dac?!_0xc419eb[_0x573716(0x157)]:_0x118dac[_0x573716(0x178)]||_0x118dac[_0x573716(0x16d)]))&&(_0x118dac={'enumerable':!![],'get':function(){return _0xc419eb[_0x1e4c49];}}),Object[_0x573716(0x160)](_0x3d63c7,_0x551e3e,_0x118dac);}:function(_0x1ddd6d,_0xb0b00c,_0x4b9028,_0x32fc72){if(_0x32fc72===undefined)_0x32fc72=_0x4b9028;_0x1ddd6d[_0x32fc72]=_0xb0b00c[_0x4b9028];}),__setModuleDefault=this&&this[a4_0xa459ba(0x181)]||(Object[a4_0xa459ba(0x15c)]?function(_0x3a87a2,_0x423096){const _0x3f5358=a4_0xa459ba;Object[_0x3f5358(0x160)](_0x3a87a2,_0x3f5358(0x158),{'enumerable':!![],'value':_0x423096});}:function(_0x557e90,_0x3fd52d){const _0x3d8f96=a4_0xa459ba;_0x557e90[_0x3d8f96(0x158)]=_0x3fd52d;}),__importStar=this&&this[a4_0xa459ba(0x165)]||(function(){var _0x341e63=function(_0x2e8141){const _0x2611a3=a4_0x3cbf;return _0x341e63=Object[_0x2611a3(0x183)]||function(_0x4bb117){const _0x137fa6=_0x2611a3;var _0xda11dc=[];for(var _0x4d601e in _0x4bb117)if(Object['prototype']['hasOwnProperty']['call'](_0x4bb117,_0x4d601e))_0xda11dc[_0xda11dc[_0x137fa6(0x168)]]=_0x4d601e;return _0xda11dc;},_0x341e63(_0x2e8141);};return function(_0x12028b){const _0x2946cf=a4_0x3cbf;if(_0x12028b&&_0x12028b[_0x2946cf(0x157)])return _0x12028b;var _0x26e6bc={};if(_0x12028b!=null){for(var _0x2e4f6b=_0x341e63(_0x12028b),_0x4842be=0x0;_0x4842be<_0x2e4f6b[_0x2946cf(0x168)];_0x4842be++)if(_0x2e4f6b[_0x4842be]!==_0x2946cf(0x158))__createBinding(_0x26e6bc,_0x12028b,_0x2e4f6b[_0x4842be]);}return __setModuleDefault(_0x26e6bc,_0x12028b),_0x26e6bc;};}());Object[a4_0xa459ba(0x160)](exports,a4_0xa459ba(0x157),{'value':!![]}),exports[a4_0xa459ba(0x176)]=void 0x0;const authService_1=require('../services/authService'),tokenBlacklistService_1=require(a4_0xa459ba(0x163)),telegramBotService_1=require(a4_0xa459ba(0x173));class AuthController{constructor(){const _0x220999=a4_0xa459ba;this[_0x220999(0x15f)]=async(_0x392e33,_0x41e273,_0x2b5771)=>{const _0x53ab0a=_0x220999;try{const _0x55689b=_0x392e33[_0x53ab0a(0x170)],_0x2bb070=_0x392e33['ip']||_0x392e33[_0x53ab0a(0x17e)]['remoteAddress']||_0x53ab0a(0x177),_0x464d8c=_0x392e33[_0x53ab0a(0x15d)]('User-Agent')||'unknown';let _0x1ca3e3=![],_0x55900e=null;try{const _0x44089d=await this[_0x53ab0a(0x164)][_0x53ab0a(0x15f)](_0x55689b);_0x1ca3e3=!![],_0x44089d['role']===_0x53ab0a(0x150)&&_0x44089d[_0x53ab0a(0x179)]?.['id']&&(_0x55900e=_0x44089d[_0x53ab0a(0x179)]['id']),_0x55900e&&await telegramBotService_1[_0x53ab0a(0x153)][_0x53ab0a(0x156)](_0x55900e,{'username':_0x55689b[_0x53ab0a(0x155)],'ipAddress':_0x2bb070,'userAgent':_0x464d8c,'timestamp':new Date(),'success':!![]}),_0x41e273['json']({'success':!![],'result':_0x44089d});}catch(_0x3e9ef2){try{const _0x291906=(await Promise[_0x53ab0a(0x175)]()[_0x53ab0a(0x159)](()=>__importStar(require(_0x53ab0a(0x16e)))))[_0x53ab0a(0x158)],_0x4539aa=await _0x291906[_0x53ab0a(0x150)][_0x53ab0a(0x167)]({'where':{'username':_0x55689b[_0x53ab0a(0x155)]},'select':{'id':!![]}});_0x4539aa&&await telegramBotService_1[_0x53ab0a(0x153)]['sendLoginNotification'](_0x4539aa['id'],{'username':_0x55689b[_0x53ab0a(0x155)],'ipAddress':_0x2bb070,'userAgent':_0x464d8c,'timestamp':new Date(),'success':![]});}catch(_0x37ea98){console['error'](_0x53ab0a(0x15e),_0x37ea98);}throw _0x3e9ef2;}}catch(_0x19d2a2){_0x2b5771(_0x19d2a2);}},this['me']=async(_0x488948,_0x2577bf,_0x1a0cec)=>{const _0x3390d0=_0x220999;try{const _0xc257c=_0x488948['user'];_0x2577bf[_0x3390d0(0x151)]({'success':!![],'result':{'id':_0xc257c?.['id'],'username':_0xc257c?.['username'],'role':_0xc257c?.[_0x3390d0(0x16c)]}});}catch(_0x7d31f0){_0x1a0cec(_0x7d31f0);}},this[_0x220999(0x174)]=async(_0x333953,_0x27d49e,_0x48c6ca)=>{const _0x37c332=_0x220999;try{const _0x3d38f3=_0x333953[_0x37c332(0x166)],_0x4c5aef=_0x333953['user'];_0x3d38f3&&_0x4c5aef?.[_0x37c332(0x152)]&&tokenBlacklistService_1['tokenBlacklistService'][_0x37c332(0x17b)](_0x3d38f3,_0x4c5aef[_0x37c332(0x152)]),_0x27d49e[_0x37c332(0x151)]({'success':!![],'message':'Logged\x20out\x20successfully'});}catch(_0xe97850){_0x48c6ca(_0xe97850);}},this[_0x220999(0x171)]=async(_0x44d118,_0x6ae5a1,_0x499490)=>{const _0x143fb2=_0x220999;try{const _0xb54ae9=tokenBlacklistService_1[_0x143fb2(0x169)]['getStats']();_0x6ae5a1[_0x143fb2(0x151)]({'success':!![],'result':_0xb54ae9});}catch(_0x2f02a7){_0x499490(_0x2f02a7);}},this[_0x220999(0x164)]=new authService_1[(_0x220999(0x16b))]();}}exports[a4_0xa459ba(0x176)]=AuthController;