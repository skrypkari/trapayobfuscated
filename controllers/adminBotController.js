'use strict';const a3_0x21f4a1=a3_0xb9cc;(function(_0x553fce,_0x1003dd){const _0x4946ba=a3_0xb9cc,_0xb56d9f=_0x553fce();while(!![]){try{const _0x427a0b=parseInt(_0x4946ba(0xe7))/0x1+parseInt(_0x4946ba(0xf4))/0x2*(parseInt(_0x4946ba(0xde))/0x3)+-parseInt(_0x4946ba(0xfa))/0x4+-parseInt(_0x4946ba(0x10f))/0x5*(parseInt(_0x4946ba(0xf0))/0x6)+parseInt(_0x4946ba(0xd9))/0x7+-parseInt(_0x4946ba(0xee))/0x8+parseInt(_0x4946ba(0xfb))/0x9*(parseInt(_0x4946ba(0xf9))/0xa);if(_0x427a0b===_0x1003dd)break;else _0xb56d9f['push'](_0xb56d9f['shift']());}catch(_0x3e8f08){_0xb56d9f['push'](_0xb56d9f['shift']());}}}(a3_0x4387,0xc765e));var __createBinding=this&&this[a3_0x21f4a1(0xe3)]||(Object[a3_0x21f4a1(0x101)]?function(_0x2f5198,_0x24f454,_0x2eeb2e,_0x206cd9){const _0x4292d9=a3_0x21f4a1;if(_0x206cd9===undefined)_0x206cd9=_0x2eeb2e;var _0x151015=Object[_0x4292d9(0xed)](_0x24f454,_0x2eeb2e);(!_0x151015||(_0x4292d9(0x10e)in _0x151015?!_0x24f454[_0x4292d9(0x110)]:_0x151015[_0x4292d9(0x102)]||_0x151015[_0x4292d9(0xf8)]))&&(_0x151015={'enumerable':!![],'get':function(){return _0x24f454[_0x2eeb2e];}}),Object[_0x4292d9(0xf5)](_0x2f5198,_0x206cd9,_0x151015);}:function(_0x66b31f,_0x30f66b,_0x5bfba4,_0x61a8d2){if(_0x61a8d2===undefined)_0x61a8d2=_0x5bfba4;_0x66b31f[_0x61a8d2]=_0x30f66b[_0x5bfba4];}),__setModuleDefault=this&&this[a3_0x21f4a1(0xd7)]||(Object['create']?function(_0x78a0c1,_0x54e4cd){const _0x2c35f3=a3_0x21f4a1;Object[_0x2c35f3(0xf5)](_0x78a0c1,'default',{'enumerable':!![],'value':_0x54e4cd});}:function(_0x4c42b6,_0x46f100){const _0x2c02cc=a3_0x21f4a1;_0x4c42b6[_0x2c02cc(0xf7)]=_0x46f100;}),__importStar=this&&this[a3_0x21f4a1(0xd8)]||(function(){var _0xe13506=function(_0x1f6c2d){const _0x208104=a3_0xb9cc;return _0xe13506=Object[_0x208104(0xda)]||function(_0xe4a6ee){const _0x47e6d9=_0x208104;var _0x3be107=[];for(var _0x22aa93 in _0xe4a6ee)if(Object[_0x47e6d9(0xf2)]['hasOwnProperty'][_0x47e6d9(0x103)](_0xe4a6ee,_0x22aa93))_0x3be107[_0x3be107['length']]=_0x22aa93;return _0x3be107;},_0xe13506(_0x1f6c2d);};return function(_0x1a840d){const _0x153f8e=a3_0xb9cc;if(_0x1a840d&&_0x1a840d['__esModule'])return _0x1a840d;var _0x3d5ecf={};if(_0x1a840d!=null){for(var _0x5ef024=_0xe13506(_0x1a840d),_0x34da70=0x0;_0x34da70<_0x5ef024['length'];_0x34da70++)if(_0x5ef024[_0x34da70]!==_0x153f8e(0xf7))__createBinding(_0x3d5ecf,_0x1a840d,_0x5ef024[_0x34da70]);}return __setModuleDefault(_0x3d5ecf,_0x1a840d),_0x3d5ecf;};}()),__importDefault=this&&this[a3_0x21f4a1(0x109)]||function(_0x3c07e4){return _0x3c07e4&&_0x3c07e4['__esModule']?_0x3c07e4:{'default':_0x3c07e4};};Object[a3_0x21f4a1(0xf5)](exports,'__esModule',{'value':!![]}),exports[a3_0x21f4a1(0x106)]=exports[a3_0x21f4a1(0xd5)]=void 0x0;function a3_0xb9cc(_0x469dc5,_0x30947c){_0x469dc5=_0x469dc5-0xd5;const _0x4387a2=a3_0x4387();let _0xb9cc2c=_0x4387a2[_0x469dc5];return _0xb9cc2c;}const adminBotService_1=require(a3_0x21f4a1(0x111)),speakeasy_1=__importDefault(require('speakeasy')),bcryptjs_1=__importDefault(require(a3_0x21f4a1(0x10b))),config_1=require('../config/config'),updateAdminBotSettings=async(_0x504b02,_0x5b574b)=>{const _0x26ebb5=a3_0x21f4a1;try{const {telegramId1:_0x13d011,telegramId2:_0x590d5c,twoFactorToken:_0x3f036e}=_0x504b02[_0x26ebb5(0xdb)],_0x181094=_0x504b02[_0x26ebb5(0xe8)]?.['id'];if(!_0x181094)return _0x5b574b[_0x26ebb5(0xf6)](0x191)[_0x26ebb5(0x114)]({'success':![],'message':_0x26ebb5(0xdc)});if(config_1[_0x26ebb5(0xe6)][_0x26ebb5(0xd6)]['twoFactorEnabled']){if(!_0x3f036e)return _0x5b574b[_0x26ebb5(0xf6)](0x190)[_0x26ebb5(0x114)]({'success':![],'message':_0x26ebb5(0xf3)});const _0x3d1a51=speakeasy_1[_0x26ebb5(0xf7)]['totp']['verify']({'secret':config_1['config']['admin'][_0x26ebb5(0x100)],'encoding':_0x26ebb5(0xfd),'token':_0x3f036e,'window':0x2});if(!_0x3d1a51){let _0x1b69d9=![];if(config_1['config'][_0x26ebb5(0xd6)]['backupCodes']){const _0x1fa427=JSON[_0x26ebb5(0xdf)](config_1[_0x26ebb5(0xe6)][_0x26ebb5(0xd6)][_0x26ebb5(0x10d)]);for(let _0x48bba8=0x0;_0x48bba8<_0x1fa427[_0x26ebb5(0xe1)];_0x48bba8++){const _0x330523=await bcryptjs_1[_0x26ebb5(0xf7)][_0x26ebb5(0xec)](_0x3f036e,_0x1fa427[_0x48bba8]);if(_0x330523){_0x1b69d9=!![],_0x1fa427['splice'](_0x48bba8,0x1);const _0x48ab3f=await Promise['resolve']()[_0x26ebb5(0xff)](()=>__importStar(require('fs'))),_0x5c4ce4=await Promise[_0x26ebb5(0xeb)]()[_0x26ebb5(0xff)](()=>__importStar(require('path'))),_0x3c549a=_0x5c4ce4['join'](process[_0x26ebb5(0x108)](),_0x26ebb5(0x10c));if(_0x48ab3f['existsSync'](_0x3c549a)){let _0x2f10fc=_0x48ab3f['readFileSync'](_0x3c549a,_0x26ebb5(0xe5));const _0x541cec=_0x2f10fc[_0x26ebb5(0xfe)]('\x0a');for(let _0x3012a6=0x0;_0x3012a6<_0x541cec[_0x26ebb5(0xe1)];_0x3012a6++){if(_0x541cec[_0x3012a6]['startsWith'](_0x26ebb5(0x105))){_0x541cec[_0x3012a6]=_0x26ebb5(0x105)+JSON[_0x26ebb5(0x104)](_0x1fa427);break;}}_0x48ab3f[_0x26ebb5(0xe4)](_0x3c549a,_0x541cec[_0x26ebb5(0xfc)]('\x0a'),'utf8');}break;}}}if(!_0x1b69d9)return _0x5b574b[_0x26ebb5(0xf6)](0x190)[_0x26ebb5(0x114)]({'success':![],'message':_0x26ebb5(0x112)});}}const _0x5f4e1e=[];_0x13d011&&_0x13d011[_0x26ebb5(0xe0)]()&&_0x5f4e1e['push'](_0x13d011[_0x26ebb5(0xe0)]()),_0x590d5c&&_0x590d5c['trim']()&&_0x5f4e1e['push'](_0x590d5c[_0x26ebb5(0xe0)]()),adminBotService_1[_0x26ebb5(0xdd)]['updateAdminIds'](_0x5f4e1e),_0x5b574b[_0x26ebb5(0x114)]({'success':!![],'message':_0x26ebb5(0xe2),'result':{'adminIds':_0x5f4e1e,'botActive':adminBotService_1[_0x26ebb5(0xdd)][_0x26ebb5(0xea)]()[_0x26ebb5(0xf1)]}});}catch(_0x2861e3){console[_0x26ebb5(0x113)](_0x26ebb5(0xe9),_0x2861e3),_0x5b574b['status'](0x1f4)[_0x26ebb5(0x114)]({'success':![],'message':_0x26ebb5(0x10a)});}};exports[a3_0x21f4a1(0xd5)]=updateAdminBotSettings;const getAdminBotSettings=async(_0x3c01f8,_0x122286)=>{const _0x1684fd=a3_0x21f4a1;try{const _0x469b17=adminBotService_1['adminBotService'][_0x1684fd(0x107)](),_0x40c5a7=adminBotService_1[_0x1684fd(0xdd)][_0x1684fd(0xea)]();_0x122286[_0x1684fd(0x114)]({'success':!![],'result':{'telegramId1':_0x469b17[0x0]||'','telegramId2':_0x469b17[0x1]||'',..._0x40c5a7}});}catch(_0x350dca){console['error']('Error\x20getting\x20admin\x20bot\x20settings:',_0x350dca),_0x122286['status'](0x1f4)[_0x1684fd(0x114)]({'success':![],'message':_0x1684fd(0xef)});}};function a3_0x4387(){const _0x1f7730=['writeFileSync','utf8','config','197057cTrRIq','user','Error\x20updating\x20admin\x20bot\x20settings:','getBotInfo','resolve','compare','getOwnPropertyDescriptor','522064ksmgRn','Failed\x20to\x20get\x20admin\x20bot\x20settings','1221474vNDyTF','isActive','prototype','2FA\x20token\x20is\x20required','88WoStgl','defineProperty','status','default','configurable','170NTPJEj','3478936poRcnl','689211ALrdeO','join','base32','split','then','twoFactorSecret','create','writable','call','stringify','ADMIN_BACKUP_CODES=','getAdminBotSettings','getAdminIds','cwd','__importDefault','Failed\x20to\x20update\x20admin\x20bot\x20settings','bcryptjs','.env','backupCodes','get','20VNobPI','__esModule','../services/adminBotService','Invalid\x202FA\x20token\x20or\x20backup\x20code','error','json','updateAdminBotSettings','admin','__setModuleDefault','__importStar','3399158djvwLS','getOwnPropertyNames','body','Unauthorized','adminBotService','39651qfesVh','parse','trim','length','Admin\x20bot\x20settings\x20updated\x20successfully','__createBinding'];a3_0x4387=function(){return _0x1f7730;};return a3_0x4387();}exports[a3_0x21f4a1(0x106)]=getAdminBotSettings;