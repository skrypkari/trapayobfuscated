'use strict';const a103_0x45bf81=a103_0xcfba;function a103_0xcfba(_0x3cfb04,_0x41ce94){_0x3cfb04=_0x3cfb04-0xfa;const _0x58302d=a103_0x5830();let _0xcfba9c=_0x58302d[_0x3cfb04];return _0xcfba9c;}(function(_0x4741e9,_0x1f7193){const _0x58b985=a103_0xcfba,_0x3daf26=_0x4741e9();while(!![]){try{const _0x103fb9=-parseInt(_0x58b985(0x11b))/0x1+-parseInt(_0x58b985(0x117))/0x2*(parseInt(_0x58b985(0xfe))/0x3)+parseInt(_0x58b985(0x111))/0x4*(-parseInt(_0x58b985(0x100))/0x5)+parseInt(_0x58b985(0x112))/0x6+parseInt(_0x58b985(0x104))/0x7+-parseInt(_0x58b985(0xfd))/0x8+parseInt(_0x58b985(0x10f))/0x9*(parseInt(_0x58b985(0x103))/0xa);if(_0x103fb9===_0x1f7193)break;else _0x3daf26['push'](_0x3daf26['shift']());}catch(_0x12d19e){_0x3daf26['push'](_0x3daf26['shift']());}}}(a103_0x5830,0x2be64));function a103_0x5830(){const _0x2ec1a5=['317674avRwdP','trim','localhost','x-client-ip','toString','968528NMRgsn','921cwLLCC','socket.remoteAddress','674915TDcExh','x-real-ip','test','230rOcjHZ','936348oEkLuZ','forwarded','x-forwarded-for','headers','cf-connecting-ip','x-forwarded','remoteAddress','__esModule','getClientIP','unknown','forwarded-for','138897GYggZT','replace','4iNuPDS','2036478gKxPIO','every','user-agent','socket','connection.remoteAddress','486dYsWHd','x-cluster-client-ip','connection','split'];a103_0x5830=function(){return _0x2ec1a5;};return a103_0x5830();}Object['defineProperty'](exports,a103_0x45bf81(0x10b),{'value':!![]}),exports[a103_0x45bf81(0x10c)]=getClientIP,exports['getDetailedIPInfo']=getDetailedIPInfo;function getClientIP(_0x1b69b9){const _0x268999=a103_0x45bf81,_0x2c132d=[_0x1b69b9['headers'][_0x268999(0x101)],_0x1b69b9[_0x268999(0x107)][_0x268999(0x106)],_0x1b69b9[_0x268999(0x107)][_0x268999(0xfb)],_0x1b69b9[_0x268999(0x107)][_0x268999(0x108)],_0x1b69b9[_0x268999(0x107)]['x-cluster-client-ip'],_0x1b69b9[_0x268999(0x107)][_0x268999(0x109)],_0x1b69b9[_0x268999(0x107)][_0x268999(0x10e)],_0x1b69b9[_0x268999(0x107)][_0x268999(0x105)],_0x1b69b9[_0x268999(0x119)]?.['remoteAddress'],_0x1b69b9[_0x268999(0x115)]?.['remoteAddress'],_0x1b69b9[_0x268999(0x119)]?.['socket']?.[_0x268999(0x10a)]];for(const _0x58b002 of _0x2c132d){if(_0x58b002){const _0x1c2bbf=Array['isArray'](_0x58b002)?_0x58b002[0x0]:_0x58b002['toString'](),_0x119434=_0x1c2bbf[_0x268999(0x11a)](',')[0x0][_0x268999(0x11c)](),_0x401e70=_0x119434[_0x268999(0x110)](/^::ffff:/,'');if(isValidIP(_0x401e70))return _0x401e70;}}return _0x268999(0x10d);}function isValidIP(_0x265345){const _0x55dafc=a103_0x45bf81,_0x568b6f=/^(\d{1,3}\.){3}\d{1,3}$/,_0x278e8a=/^([0-9a-fA-F]{1,4}:){7}[0-9a-fA-F]{1,4}$/;if(_0x568b6f[_0x55dafc(0x102)](_0x265345)){const _0x87cc51=_0x265345[_0x55dafc(0x11a)]('.');return _0x87cc51[_0x55dafc(0x113)](_0x5e2e97=>{const _0x2bdcfc=parseInt(_0x5e2e97,0xa);return _0x2bdcfc>=0x0&&_0x2bdcfc<=0xff;});}return _0x278e8a[_0x55dafc(0x102)](_0x265345)||_0x265345===_0x55dafc(0xfa)||_0x265345==='::1';}function getDetailedIPInfo(_0x319cc6){const _0x511c55=a103_0x45bf81,_0x111e6d=getClientIP(_0x319cc6);let _0x46f07f=_0x511c55(0x10d);if(_0x319cc6[_0x511c55(0x107)][_0x511c55(0x101)])_0x46f07f=_0x511c55(0x101);else{if(_0x319cc6[_0x511c55(0x107)]['x-forwarded-for'])_0x46f07f=_0x511c55(0x106);else{if(_0x319cc6['headers']['x-client-ip'])_0x46f07f=_0x511c55(0xfb);else{if(_0x319cc6[_0x511c55(0x107)][_0x511c55(0x108)])_0x46f07f=_0x511c55(0x108);else{if(_0x319cc6[_0x511c55(0x107)][_0x511c55(0x118)])_0x46f07f=_0x511c55(0x118);else{if(_0x319cc6['headers'][_0x511c55(0x109)])_0x46f07f='x-forwarded';else{if(_0x319cc6[_0x511c55(0x107)][_0x511c55(0x10e)])_0x46f07f=_0x511c55(0x10e);else{if(_0x319cc6[_0x511c55(0x107)][_0x511c55(0x105)])_0x46f07f='forwarded';else{if(_0x319cc6[_0x511c55(0x119)]?.[_0x511c55(0x10a)])_0x46f07f=_0x511c55(0x116);else{if(_0x319cc6[_0x511c55(0x115)]?.['remoteAddress'])_0x46f07f=_0x511c55(0xff);}}}}}}}}}return{'ip':_0x111e6d,'source':_0x46f07f,'allHeaders':{'x-real-ip':_0x319cc6[_0x511c55(0x107)][_0x511c55(0x101)]?.[_0x511c55(0xfc)](),'x-forwarded-for':_0x319cc6['headers']['x-forwarded-for']?.[_0x511c55(0xfc)](),'x-client-ip':_0x319cc6[_0x511c55(0x107)][_0x511c55(0xfb)]?.[_0x511c55(0xfc)](),'cf-connecting-ip':_0x319cc6[_0x511c55(0x107)][_0x511c55(0x108)]?.[_0x511c55(0xfc)](),'x-cluster-client-ip':_0x319cc6[_0x511c55(0x107)]['x-cluster-client-ip']?.[_0x511c55(0xfc)](),'x-forwarded':_0x319cc6['headers'][_0x511c55(0x109)]?.[_0x511c55(0xfc)](),'forwarded-for':_0x319cc6[_0x511c55(0x107)]['forwarded-for']?.[_0x511c55(0xfc)](),'forwarded':_0x319cc6[_0x511c55(0x107)][_0x511c55(0x105)]?.[_0x511c55(0xfc)]()},'connectionInfo':{'remoteAddress':_0x319cc6[_0x511c55(0x119)]?.[_0x511c55(0x10a)],'socketRemoteAddress':_0x319cc6['socket']?.['remoteAddress'],'userAgent':_0x319cc6['headers'][_0x511c55(0x114)]}};}