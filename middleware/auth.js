'use strict';const a16_0x5cbf5b=a16_0x4445;(function(_0x2aff4b,_0xd039bd){const _0x19bcbe=a16_0x4445,_0x5002ee=_0x2aff4b();while(!![]){try{const _0x3c7d18=-parseInt(_0x19bcbe(0x1dc))/0x1*(parseInt(_0x19bcbe(0x1d6))/0x2)+-parseInt(_0x19bcbe(0x1ea))/0x3+parseInt(_0x19bcbe(0x1fe))/0x4+parseInt(_0x19bcbe(0x1ee))/0x5*(parseInt(_0x19bcbe(0x1e1))/0x6)+-parseInt(_0x19bcbe(0x1ef))/0x7+parseInt(_0x19bcbe(0x1df))/0x8+parseInt(_0x19bcbe(0x1f1))/0x9;if(_0x3c7d18===_0xd039bd)break;else _0x5002ee['push'](_0x5002ee['shift']());}catch(_0x41883d){_0x5002ee['push'](_0x5002ee['shift']());}}}(a16_0x592c,0x647cf));var __importDefault=this&&this['__importDefault']||function(_0x2465c8){const _0x5390dc=a16_0x4445;return _0x2465c8&&_0x2465c8[_0x5390dc(0x1fd)]?_0x2465c8:{'default':_0x2465c8};};function a16_0x4445(_0x5e3e35,_0x2a2331){const _0x592cc5=a16_0x592c();return a16_0x4445=function(_0x44457a,_0x3e0bce){_0x44457a=_0x44457a-0x1d6;let _0x372457=_0x592cc5[_0x44457a];return _0x372457;},a16_0x4445(_0x5e3e35,_0x2a2331);}Object['defineProperty'](exports,a16_0x5cbf5b(0x1fd),{'value':!![]}),exports['requireActiveShop']=exports[a16_0x5cbf5b(0x1d7)]=exports['requireAdmin']=exports[a16_0x5cbf5b(0x1fb)]=void 0x0;const jsonwebtoken_1=__importDefault(require(a16_0x5cbf5b(0x1d8))),config_1=require(a16_0x5cbf5b(0x1f6)),tokenBlacklistService_1=require(a16_0x5cbf5b(0x1e0)),authenticateToken=(_0x194a5c,_0x90f9bc,_0xac87ac)=>{const _0x46a922=a16_0x5cbf5b,_0x2e2ba2=_0x194a5c[_0x46a922(0x1dd)][_0x46a922(0x1f8)],_0x5465c8=_0x2e2ba2&&_0x2e2ba2[_0x46a922(0x1e2)]('\x20')[0x1];if(!_0x5465c8)return _0x90f9bc['status'](0x191)[_0x46a922(0x1f9)]({'success':![],'message':_0x46a922(0x1d9)});if(tokenBlacklistService_1[_0x46a922(0x1e4)]['isTokenBlacklisted'](_0x5465c8))return _0x90f9bc[_0x46a922(0x1da)](0x191)[_0x46a922(0x1f9)]({'success':![],'message':_0x46a922(0x1e3)});jsonwebtoken_1[_0x46a922(0x1e5)][_0x46a922(0x1f0)](_0x5465c8,config_1[_0x46a922(0x1ff)][_0x46a922(0x200)]['secret'],(_0x1225bf,_0x20f84e)=>{const _0x192922=_0x46a922;if(_0x1225bf)return _0x90f9bc['status'](0x193)['json']({'success':![],'message':_0x192922(0x1f4)});_0x194a5c[_0x192922(0x1e9)]=_0x20f84e,_0x194a5c[_0x192922(0x1f5)]=_0x5465c8,_0xac87ac();});};exports[a16_0x5cbf5b(0x1fb)]=authenticateToken;function a16_0x592c(){const _0x2f8294=['headers','admin','5144064vimQNc','../services/tokenBlacklistService','42auyQqk','split','Token\x20has\x20been\x20revoked','tokenBlacklistService','default','shop','requireActiveShop','../config/database','user','2138487BwVTJz','role','Admin\x20access\x20required','Error\x20checking\x20account\x20status:','146550uKVSgy','2838192bxzWEe','verify','5177916nkSIvt','Account\x20is\x20suspended\x20or\x20inactive.\x20Contact\x20administrator\x20to\x20activate\x20your\x20account.','Shop\x20access\x20required','Invalid\x20or\x20expired\x20token','token','../config/config','ACTIVE','authorization','json','findUnique','authenticateToken','Error\x20checking\x20account\x20status','__esModule','1010064nZxRBb','config','jwt','146134KxAiZc','requireShop','jsonwebtoken','Access\x20token\x20required','status','SUSPENDED','2sFjwGv'];a16_0x592c=function(){return _0x2f8294;};return a16_0x592c();}const requireAdmin=(_0xa7589,_0xa05fe1,_0x532ae3)=>{const _0x3b9558=a16_0x5cbf5b;if(!_0xa7589[_0x3b9558(0x1e9)]||_0xa7589[_0x3b9558(0x1e9)]['role']!==_0x3b9558(0x1de))return _0xa05fe1['status'](0x193)['json']({'success':![],'message':_0x3b9558(0x1ec)});_0x532ae3();};exports['requireAdmin']=requireAdmin;const requireShop=(_0x4d48ad,_0x72f2f5,_0x1d6392)=>{const _0x2e2936=a16_0x5cbf5b;if(!_0x4d48ad[_0x2e2936(0x1e9)]||_0x4d48ad[_0x2e2936(0x1e9)][_0x2e2936(0x1eb)]!=='shop')return _0x72f2f5['status'](0x193)['json']({'success':![],'message':_0x2e2936(0x1f3)});_0x1d6392();};exports['requireShop']=requireShop;const requireActiveShop=async(_0x3d5979,_0x1bf5fd,_0x461f24)=>{const _0xa16c37=a16_0x5cbf5b;if(!_0x3d5979[_0xa16c37(0x1e9)]||_0x3d5979['user'][_0xa16c37(0x1eb)]!==_0xa16c37(0x1e6))return _0x1bf5fd[_0xa16c37(0x1da)](0x193)[_0xa16c37(0x1f9)]({'success':![],'message':'Shop\x20access\x20required'});try{const _0x175426=require(_0xa16c37(0x1e8))[_0xa16c37(0x1e5)],_0x487dbd=await _0x175426[_0xa16c37(0x1e6)][_0xa16c37(0x1fa)]({'where':{'id':_0x3d5979[_0xa16c37(0x1e9)]['id']},'select':{'status':!![]}});if(!_0x487dbd||_0x487dbd[_0xa16c37(0x1da)]!==_0xa16c37(0x1f7))return _0x1bf5fd[_0xa16c37(0x1da)](0x193)['json']({'success':![],'message':_0xa16c37(0x1f2),'suspended':_0x487dbd?.[_0xa16c37(0x1da)]===_0xa16c37(0x1db)});_0x461f24();}catch(_0x3f52b7){return console['error'](_0xa16c37(0x1ed),_0x3f52b7),_0x1bf5fd['status'](0x1f4)[_0xa16c37(0x1f9)]({'success':![],'message':_0xa16c37(0x1fc)});}};exports[a16_0x5cbf5b(0x1e7)]=requireActiveShop;