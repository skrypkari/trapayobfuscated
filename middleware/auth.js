'use strict';const a16_0x1337ee=a16_0x1fa3;(function(_0x193323,_0x50c888){const _0x15e1e2=a16_0x1fa3,_0x5d91b7=_0x193323();while(!![]){try{const _0x28f57a=-parseInt(_0x15e1e2(0x80))/0x1+parseInt(_0x15e1e2(0x8a))/0x2*(-parseInt(_0x15e1e2(0x9d))/0x3)+parseInt(_0x15e1e2(0x99))/0x4*(-parseInt(_0x15e1e2(0x85))/0x5)+-parseInt(_0x15e1e2(0x9a))/0x6*(-parseInt(_0x15e1e2(0x87))/0x7)+parseInt(_0x15e1e2(0x86))/0x8*(-parseInt(_0x15e1e2(0x9e))/0x9)+parseInt(_0x15e1e2(0x7f))/0xa*(parseInt(_0x15e1e2(0x96))/0xb)+parseInt(_0x15e1e2(0x9b))/0xc*(parseInt(_0x15e1e2(0x81))/0xd);if(_0x28f57a===_0x50c888)break;else _0x5d91b7['push'](_0x5d91b7['shift']());}catch(_0x36d060){_0x5d91b7['push'](_0x5d91b7['shift']());}}}(a16_0x3640,0xe59dc));function a16_0x3640(){const _0x95a3e8=['../services/tokenBlacklistService','18wbIjAC','45arjBhX','tokenBlacklistService','json','Admin\x20access\x20required','admin','670EnzaoF','382318dnGpJS','511901uKqcpf','config','__esModule','authenticateToken','5RzUZWO','1459016dBoJhc','1379OzjZWv','status','user','390444kvrgrE','../config/config','split','requireShop','isTokenBlacklisted','requireAdmin','jwt','headers','Token\x20has\x20been\x20revoked','token','Access\x20token\x20required','Invalid\x20or\x20expired\x20token','221617UTtfBY','role','secret','4237204SLfNeA','30126hAcGsX','648NAEGeI'];a16_0x3640=function(){return _0x95a3e8;};return a16_0x3640();}var __importDefault=this&&this['__importDefault']||function(_0x19a33d){const _0x3b3652=a16_0x1fa3;return _0x19a33d&&_0x19a33d[_0x3b3652(0x83)]?_0x19a33d:{'default':_0x19a33d};};function a16_0x1fa3(_0x998c0c,_0x32dc0a){const _0x364075=a16_0x3640();return a16_0x1fa3=function(_0x1fa3cd,_0x463aa8){_0x1fa3cd=_0x1fa3cd-0x7f;let _0x4bc5d5=_0x364075[_0x1fa3cd];return _0x4bc5d5;},a16_0x1fa3(_0x998c0c,_0x32dc0a);}Object['defineProperty'](exports,a16_0x1337ee(0x83),{'value':!![]}),exports[a16_0x1337ee(0x8d)]=exports[a16_0x1337ee(0x8f)]=exports['authenticateToken']=void 0x0;const jsonwebtoken_1=__importDefault(require('jsonwebtoken')),config_1=require(a16_0x1337ee(0x8b)),tokenBlacklistService_1=require(a16_0x1337ee(0x9c)),authenticateToken=(_0x3b9209,_0x36956f,_0x5b2684)=>{const _0x2318e3=a16_0x1337ee,_0x2a84af=_0x3b9209[_0x2318e3(0x91)]['authorization'],_0x532250=_0x2a84af&&_0x2a84af[_0x2318e3(0x8c)]('\x20')[0x1];if(!_0x532250)return _0x36956f[_0x2318e3(0x88)](0x191)[_0x2318e3(0xa0)]({'success':![],'message':_0x2318e3(0x94)});if(tokenBlacklistService_1[_0x2318e3(0x9f)][_0x2318e3(0x8e)](_0x532250))return _0x36956f[_0x2318e3(0x88)](0x191)['json']({'success':![],'message':_0x2318e3(0x92)});jsonwebtoken_1['default']['verify'](_0x532250,config_1[_0x2318e3(0x82)][_0x2318e3(0x90)][_0x2318e3(0x98)],(_0x439200,_0x10b93f)=>{const _0x272d40=_0x2318e3;if(_0x439200)return _0x36956f[_0x272d40(0x88)](0x193)[_0x272d40(0xa0)]({'success':![],'message':_0x272d40(0x95)});_0x3b9209[_0x272d40(0x89)]=_0x10b93f,_0x3b9209[_0x272d40(0x93)]=_0x532250,_0x5b2684();});};exports[a16_0x1337ee(0x84)]=authenticateToken;const requireAdmin=(_0x4c00dd,_0x5ce0f1,_0x2f7488)=>{const _0x423b32=a16_0x1337ee;if(!_0x4c00dd['user']||_0x4c00dd[_0x423b32(0x89)][_0x423b32(0x97)]!==_0x423b32(0xa2))return _0x5ce0f1[_0x423b32(0x88)](0x193)[_0x423b32(0xa0)]({'success':![],'message':_0x423b32(0xa1)});_0x2f7488();};exports[a16_0x1337ee(0x8f)]=requireAdmin;const requireShop=(_0x2047af,_0x1b6bb0,_0x258eef)=>{const _0x5646d0=a16_0x1337ee;if(!_0x2047af[_0x5646d0(0x89)]||_0x2047af[_0x5646d0(0x89)][_0x5646d0(0x97)]!=='shop')return _0x1b6bb0['status'](0x193)[_0x5646d0(0xa0)]({'success':![],'message':'Shop\x20access\x20required'});_0x258eef();};exports[a16_0x1337ee(0x8d)]=requireShop;