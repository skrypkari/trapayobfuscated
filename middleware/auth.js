'use strict';const a18_0x4c9bea=a18_0x2acb;(function(_0x2c0073,_0x1b60ca){const _0x26db17=a18_0x2acb,_0x36c606=_0x2c0073();while(!![]){try{const _0x3b2ec9=parseInt(_0x26db17(0xda))/0x1+parseInt(_0x26db17(0xc1))/0x2*(parseInt(_0x26db17(0xc9))/0x3)+-parseInt(_0x26db17(0xbf))/0x4+-parseInt(_0x26db17(0xcb))/0x5+-parseInt(_0x26db17(0xc6))/0x6+parseInt(_0x26db17(0xc5))/0x7*(parseInt(_0x26db17(0xbb))/0x8)+-parseInt(_0x26db17(0xdb))/0x9*(-parseInt(_0x26db17(0xdc))/0xa);if(_0x3b2ec9===_0x1b60ca)break;else _0x36c606['push'](_0x36c606['shift']());}catch(_0x4259cc){_0x36c606['push'](_0x36c606['shift']());}}}(a18_0x2ecf,0x8f752));var __importDefault=this&&this[a18_0x4c9bea(0xd7)]||function(_0x31660d){const _0x302c6a=a18_0x4c9bea;return _0x31660d&&_0x31660d[_0x302c6a(0xe5)]?_0x31660d:{'default':_0x31660d};};Object[a18_0x4c9bea(0xc2)](exports,a18_0x4c9bea(0xe5),{'value':!![]}),exports['requireActiveShop']=exports[a18_0x4c9bea(0xd8)]=exports[a18_0x4c9bea(0xe3)]=exports['authenticateToken']=void 0x0;function a18_0x2ecf(){const _0x396c7c=['488luNvuY','admin','SUSPENDED','user','3030016BdHKvd','config','67580rHzjfr','defineProperty','Token\x20has\x20been\x20revoked','Error\x20checking\x20account\x20status','75425KNcQfm','2240214ecAMmi','status','split','6bRkkan','findUnique','1743610xOtoYy','tokenBlacklistService','../config/database','Access\x20token\x20required','authenticateToken','error','authorization','shop','Admin\x20access\x20required','verify','Shop\x20access\x20required','jwt','__importDefault','requireShop','default','214554nKwPuG','18umWTGJ','5638940DEoKqX','token','requireActiveShop','role','Error\x20checking\x20account\x20status:','json','../config/config','requireAdmin','isTokenBlacklisted','__esModule'];a18_0x2ecf=function(){return _0x396c7c;};return a18_0x2ecf();}const jsonwebtoken_1=__importDefault(require('jsonwebtoken')),config_1=require(a18_0x4c9bea(0xe2)),tokenBlacklistService_1=require('../services/tokenBlacklistService'),authenticateToken=(_0x56cf7a,_0x46fd9c,_0x15e90e)=>{const _0x37bfa0=a18_0x4c9bea,_0x50f141=_0x56cf7a['headers'][_0x37bfa0(0xd1)],_0x5e77d3=_0x50f141&&_0x50f141[_0x37bfa0(0xc8)]('\x20')[0x1];if(!_0x5e77d3)return _0x46fd9c[_0x37bfa0(0xc7)](0x191)[_0x37bfa0(0xe1)]({'success':![],'message':_0x37bfa0(0xce)});if(tokenBlacklistService_1[_0x37bfa0(0xcc)][_0x37bfa0(0xe4)](_0x5e77d3))return _0x46fd9c[_0x37bfa0(0xc7)](0x191)['json']({'success':![],'message':_0x37bfa0(0xc3)});jsonwebtoken_1[_0x37bfa0(0xd9)][_0x37bfa0(0xd4)](_0x5e77d3,config_1[_0x37bfa0(0xc0)][_0x37bfa0(0xd6)]['secret'],(_0x346912,_0x5ceb20)=>{const _0x616318=_0x37bfa0;if(_0x346912)return _0x46fd9c[_0x616318(0xc7)](0x193)[_0x616318(0xe1)]({'success':![],'message':'Invalid\x20or\x20expired\x20token'});_0x56cf7a[_0x616318(0xbe)]=_0x5ceb20,_0x56cf7a[_0x616318(0xdd)]=_0x5e77d3,_0x15e90e();});};exports[a18_0x4c9bea(0xcf)]=authenticateToken;const requireAdmin=(_0x39f429,_0x316096,_0x330025)=>{const _0x14f01a=a18_0x4c9bea;if(!_0x39f429[_0x14f01a(0xbe)]||_0x39f429[_0x14f01a(0xbe)][_0x14f01a(0xdf)]!==_0x14f01a(0xbc))return _0x316096['status'](0x193)[_0x14f01a(0xe1)]({'success':![],'message':_0x14f01a(0xd3)});_0x330025();};function a18_0x2acb(_0x2df4a3,_0x3af44d){const _0x2ecfff=a18_0x2ecf();return a18_0x2acb=function(_0x2acb0f,_0x28bb5d){_0x2acb0f=_0x2acb0f-0xbb;let _0xce96ac=_0x2ecfff[_0x2acb0f];return _0xce96ac;},a18_0x2acb(_0x2df4a3,_0x3af44d);}exports[a18_0x4c9bea(0xe3)]=requireAdmin;const requireShop=(_0xb853de,_0x137ab6,_0x452e5a)=>{const _0x785f49=a18_0x4c9bea;if(!_0xb853de[_0x785f49(0xbe)]||_0xb853de['user'][_0x785f49(0xdf)]!==_0x785f49(0xd2))return _0x137ab6[_0x785f49(0xc7)](0x193)[_0x785f49(0xe1)]({'success':![],'message':_0x785f49(0xd5)});_0x452e5a();};exports['requireShop']=requireShop;const requireActiveShop=async(_0x43775c,_0x492cb0,_0x11086e)=>{const _0x15ce7b=a18_0x4c9bea;if(!_0x43775c[_0x15ce7b(0xbe)]||_0x43775c[_0x15ce7b(0xbe)][_0x15ce7b(0xdf)]!==_0x15ce7b(0xd2))return _0x492cb0['status'](0x193)[_0x15ce7b(0xe1)]({'success':![],'message':_0x15ce7b(0xd5)});try{const _0xe45d9f=require(_0x15ce7b(0xcd))['default'],_0x502a90=await _0xe45d9f[_0x15ce7b(0xd2)][_0x15ce7b(0xca)]({'where':{'id':_0x43775c[_0x15ce7b(0xbe)]['id']},'select':{'status':!![]}});if(!_0x502a90||_0x502a90[_0x15ce7b(0xc7)]!=='ACTIVE')return _0x492cb0[_0x15ce7b(0xc7)](0x193)['json']({'success':![],'message':'Account\x20is\x20suspended\x20or\x20inactive.\x20Contact\x20administrator\x20to\x20activate\x20your\x20account.','suspended':_0x502a90?.[_0x15ce7b(0xc7)]===_0x15ce7b(0xbd)});_0x11086e();}catch(_0x2307e9){return console[_0x15ce7b(0xd0)](_0x15ce7b(0xe0),_0x2307e9),_0x492cb0[_0x15ce7b(0xc7)](0x1f4)[_0x15ce7b(0xe1)]({'success':![],'message':_0x15ce7b(0xc4)});}};exports[a18_0x4c9bea(0xde)]=requireActiveShop;