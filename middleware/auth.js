'use strict';const a16_0x76bd7e=a16_0x534d;(function(_0x49b1e8,_0x50df35){const _0x5a7c5f=a16_0x534d,_0x5dc483=_0x49b1e8();while(!![]){try{const _0x571485=parseInt(_0x5a7c5f(0x1b4))/0x1+parseInt(_0x5a7c5f(0x1ac))/0x2+-parseInt(_0x5a7c5f(0x1a5))/0x3*(-parseInt(_0x5a7c5f(0x1a1))/0x4)+-parseInt(_0x5a7c5f(0x1a8))/0x5*(-parseInt(_0x5a7c5f(0x19d))/0x6)+-parseInt(_0x5a7c5f(0x1aa))/0x7+parseInt(_0x5a7c5f(0x1b2))/0x8*(parseInt(_0x5a7c5f(0x199))/0x9)+-parseInt(_0x5a7c5f(0x1a2))/0xa;if(_0x571485===_0x50df35)break;else _0x5dc483['push'](_0x5dc483['shift']());}catch(_0x5249cf){_0x5dc483['push'](_0x5dc483['shift']());}}}(a16_0x423e,0x427aa));var __importDefault=this&&this[a16_0x76bd7e(0x1a6)]||function(_0x113c08){return _0x113c08&&_0x113c08['__esModule']?_0x113c08:{'default':_0x113c08};};Object['defineProperty'](exports,a16_0x76bd7e(0x198),{'value':!![]}),exports[a16_0x76bd7e(0x197)]=exports[a16_0x76bd7e(0x1bb)]=exports[a16_0x76bd7e(0x1ab)]=exports[a16_0x76bd7e(0x1a4)]=void 0x0;const jsonwebtoken_1=__importDefault(require(a16_0x76bd7e(0x1a3))),config_1=require(a16_0x76bd7e(0x19c)),tokenBlacklistService_1=require(a16_0x76bd7e(0x1ae)),authenticateToken=(_0x56fed7,_0x2e9429,_0xf071f0)=>{const _0x596ff5=a16_0x76bd7e,_0x26208e=_0x56fed7[_0x596ff5(0x1a7)]['authorization'],_0x3c4074=_0x26208e&&_0x26208e[_0x596ff5(0x195)]('\x20')[0x1];if(!_0x3c4074)return _0x2e9429[_0x596ff5(0x19f)](0x191)['json']({'success':![],'message':'Access\x20token\x20required'});if(tokenBlacklistService_1['tokenBlacklistService'][_0x596ff5(0x1b3)](_0x3c4074))return _0x2e9429[_0x596ff5(0x19f)](0x191)[_0x596ff5(0x1a0)]({'success':![],'message':_0x596ff5(0x1b0)});jsonwebtoken_1[_0x596ff5(0x1ad)][_0x596ff5(0x1b6)](_0x3c4074,config_1[_0x596ff5(0x196)][_0x596ff5(0x1a9)][_0x596ff5(0x1b1)],(_0x32c77f,_0x3fa936)=>{const _0x74433f=_0x596ff5;if(_0x32c77f)return _0x2e9429[_0x74433f(0x19f)](0x193)[_0x74433f(0x1a0)]({'success':![],'message':_0x74433f(0x1af)});_0x56fed7[_0x74433f(0x1b7)]=_0x3fa936,_0x56fed7[_0x74433f(0x194)]=_0x3c4074,_0xf071f0();});};exports[a16_0x76bd7e(0x1a4)]=authenticateToken;function a16_0x534d(_0x3d9762,_0x2703a8){const _0x423efb=a16_0x423e();return a16_0x534d=function(_0x534d1d,_0x38c9b3){_0x534d1d=_0x534d1d-0x194;let _0x115a71=_0x423efb[_0x534d1d];return _0x115a71;},a16_0x534d(_0x3d9762,_0x2703a8);}const requireAdmin=(_0x189999,_0x25900a,_0x1cd61e)=>{const _0x5e9b1f=a16_0x76bd7e;if(!_0x189999[_0x5e9b1f(0x1b7)]||_0x189999[_0x5e9b1f(0x1b7)][_0x5e9b1f(0x1b5)]!=='admin')return _0x25900a['status'](0x193)['json']({'success':![],'message':_0x5e9b1f(0x19a)});_0x1cd61e();};function a16_0x423e(){const _0xf42a7=['token','split','config','requireActiveShop','__esModule','9vFVMmz','Admin\x20access\x20required','Account\x20is\x20suspended\x20or\x20inactive.\x20Contact\x20administrator\x20to\x20activate\x20your\x20account.','../config/config','12GOVnjK','Shop\x20access\x20required','status','json','1696484EBvOBY','17757850PCJGwx','jsonwebtoken','authenticateToken','3QoLORj','__importDefault','headers','1292645wdPCRS','jwt','4613xRUasa','requireAdmin','736140cWdcmw','default','../services/tokenBlacklistService','Invalid\x20or\x20expired\x20token','Token\x20has\x20been\x20revoked','secret','3930040PuvsAM','isTokenBlacklisted','248238VFXqgz','role','verify','user','../config/database','ACTIVE','shop','requireShop'];a16_0x423e=function(){return _0xf42a7;};return a16_0x423e();}exports[a16_0x76bd7e(0x1ab)]=requireAdmin;const requireShop=(_0x4837fd,_0x33ab8f,_0x4f11d5)=>{const _0x680457=a16_0x76bd7e;if(!_0x4837fd['user']||_0x4837fd[_0x680457(0x1b7)]['role']!=='shop')return _0x33ab8f['status'](0x193)[_0x680457(0x1a0)]({'success':![],'message':'Shop\x20access\x20required'});_0x4f11d5();};exports[a16_0x76bd7e(0x1bb)]=requireShop;const requireActiveShop=async(_0x55fa84,_0x4824b9,_0x23e905)=>{const _0x4b9a55=a16_0x76bd7e;if(!_0x55fa84[_0x4b9a55(0x1b7)]||_0x55fa84[_0x4b9a55(0x1b7)]['role']!==_0x4b9a55(0x1ba))return _0x4824b9[_0x4b9a55(0x19f)](0x193)['json']({'success':![],'message':_0x4b9a55(0x19e)});try{const _0x1522fb=require(_0x4b9a55(0x1b8))[_0x4b9a55(0x1ad)],_0x54a82c=await _0x1522fb[_0x4b9a55(0x1ba)]['findUnique']({'where':{'id':_0x55fa84[_0x4b9a55(0x1b7)]['id']},'select':{'status':!![]}});if(!_0x54a82c||_0x54a82c[_0x4b9a55(0x19f)]!==_0x4b9a55(0x1b9))return _0x4824b9[_0x4b9a55(0x19f)](0x193)[_0x4b9a55(0x1a0)]({'success':![],'message':_0x4b9a55(0x19b),'suspended':_0x54a82c?.[_0x4b9a55(0x19f)]==='SUSPENDED'});_0x23e905();}catch(_0xd213cb){return console['error']('Error\x20checking\x20account\x20status:',_0xd213cb),_0x4824b9['status'](0x1f4)['json']({'success':![],'message':'Error\x20checking\x20account\x20status'});}};exports['requireActiveShop']=requireActiveShop;