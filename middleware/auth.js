'use strict';const a16_0x543876=a16_0x3fd5;(function(_0x21eff3,_0x3c819e){const _0x1c5c05=a16_0x3fd5,_0x12d838=_0x21eff3();while(!![]){try{const _0x22cb41=-parseInt(_0x1c5c05(0xb4))/0x1*(parseInt(_0x1c5c05(0xc1))/0x2)+-parseInt(_0x1c5c05(0xc6))/0x3*(parseInt(_0x1c5c05(0xd4))/0x4)+-parseInt(_0x1c5c05(0xd3))/0x5+parseInt(_0x1c5c05(0xd0))/0x6*(parseInt(_0x1c5c05(0xc9))/0x7)+-parseInt(_0x1c5c05(0xb6))/0x8+parseInt(_0x1c5c05(0xc3))/0x9*(parseInt(_0x1c5c05(0xcb))/0xa)+parseInt(_0x1c5c05(0xdb))/0xb*(parseInt(_0x1c5c05(0xdc))/0xc);if(_0x22cb41===_0x3c819e)break;else _0x12d838['push'](_0x12d838['shift']());}catch(_0x3972e3){_0x12d838['push'](_0x12d838['shift']());}}}(a16_0x68bd,0x1da5c));var __importDefault=this&&this[a16_0x543876(0xb9)]||function(_0x1f4025){const _0x376d26=a16_0x543876;return _0x1f4025&&_0x1f4025[_0x376d26(0xd5)]?_0x1f4025:{'default':_0x1f4025};};function a16_0x3fd5(_0x47096d,_0xce72a3){const _0x68bd15=a16_0x68bd();return a16_0x3fd5=function(_0x3fd5b6,_0xd82d8e){_0x3fd5b6=_0x3fd5b6-0xb2;let _0x25d296=_0x68bd15[_0x3fd5b6];return _0x25d296;},a16_0x3fd5(_0x47096d,_0xce72a3);}Object[a16_0x543876(0xd6)](exports,a16_0x543876(0xd5),{'value':!![]}),exports[a16_0x543876(0xc8)]=exports[a16_0x543876(0xd1)]=exports[a16_0x543876(0xcf)]=exports['authenticateToken']=void 0x0;const jsonwebtoken_1=__importDefault(require(a16_0x543876(0xbb))),config_1=require('../config/config'),tokenBlacklistService_1=require('../services/tokenBlacklistService'),authenticateToken=(_0x37b855,_0x108159,_0x56302f)=>{const _0x1ba42a=a16_0x543876,_0x5208aa=_0x37b855['headers'][_0x1ba42a(0xb2)],_0x55e855=_0x5208aa&&_0x5208aa['split']('\x20')[0x1];if(!_0x55e855)return _0x108159['status'](0x191)[_0x1ba42a(0xbd)]({'success':![],'message':'Access\x20token\x20required'});if(tokenBlacklistService_1[_0x1ba42a(0xcd)]['isTokenBlacklisted'](_0x55e855))return _0x108159[_0x1ba42a(0xb3)](0x191)[_0x1ba42a(0xbd)]({'success':![],'message':_0x1ba42a(0xda)});jsonwebtoken_1[_0x1ba42a(0xd8)][_0x1ba42a(0xc4)](_0x55e855,config_1[_0x1ba42a(0xcc)][_0x1ba42a(0xc7)][_0x1ba42a(0xd9)],(_0x369435,_0x570d19)=>{const _0x138107=_0x1ba42a;if(_0x369435)return _0x108159[_0x138107(0xb3)](0x193)[_0x138107(0xbd)]({'success':![],'message':_0x138107(0xbc)});_0x37b855[_0x138107(0xba)]=_0x570d19,_0x37b855[_0x138107(0xd7)]=_0x55e855,_0x56302f();});};exports['authenticateToken']=authenticateToken;const requireAdmin=(_0x1cf61c,_0x3a9dc5,_0x31bae3)=>{const _0x2df64a=a16_0x543876;if(!_0x1cf61c[_0x2df64a(0xba)]||_0x1cf61c['user']['role']!==_0x2df64a(0xc0))return _0x3a9dc5[_0x2df64a(0xb3)](0x193)['json']({'success':![],'message':_0x2df64a(0xd2)});_0x31bae3();};exports[a16_0x543876(0xcf)]=requireAdmin;const requireShop=(_0x3136c9,_0x4e21a5,_0x295a52)=>{const _0x259a96=a16_0x543876;if(!_0x3136c9[_0x259a96(0xba)]||_0x3136c9['user']['role']!==_0x259a96(0xb8))return _0x4e21a5['status'](0x193)[_0x259a96(0xbd)]({'success':![],'message':_0x259a96(0xb7)});_0x295a52();};function a16_0x68bd(){const _0x1d38fb=['token','default','secret','Token\x20has\x20been\x20revoked','1936qCzmam','38148AOZXLK','authorization','status','1HMapYu','Account\x20is\x20suspended\x20or\x20inactive.\x20Contact\x20administrator\x20to\x20activate\x20your\x20account.','608688yTJxUQ','Shop\x20access\x20required','shop','__importDefault','user','jsonwebtoken','Invalid\x20or\x20expired\x20token','json','role','../config/database','admin','451322VxaiKo','findUnique','18HeobAt','verify','Error\x20checking\x20account\x20status:','6enxsIY','jwt','requireActiveShop','33131YZKApz','Error\x20checking\x20account\x20status','690700xbGLcn','config','tokenBlacklistService','ACTIVE','requireAdmin','114mMiqKW','requireShop','Admin\x20access\x20required','860540haauus','384560UtCENv','__esModule','defineProperty'];a16_0x68bd=function(){return _0x1d38fb;};return a16_0x68bd();}exports[a16_0x543876(0xd1)]=requireShop;const requireActiveShop=async(_0x118832,_0x5eb57a,_0x44a858)=>{const _0x2871a6=a16_0x543876;if(!_0x118832['user']||_0x118832[_0x2871a6(0xba)][_0x2871a6(0xbe)]!==_0x2871a6(0xb8))return _0x5eb57a[_0x2871a6(0xb3)](0x193)[_0x2871a6(0xbd)]({'success':![],'message':'Shop\x20access\x20required'});try{const _0x3d5167=require(_0x2871a6(0xbf))['default'],_0x32e4dc=await _0x3d5167[_0x2871a6(0xb8)][_0x2871a6(0xc2)]({'where':{'id':_0x118832[_0x2871a6(0xba)]['id']},'select':{'status':!![]}});if(!_0x32e4dc||_0x32e4dc[_0x2871a6(0xb3)]!==_0x2871a6(0xce))return _0x5eb57a[_0x2871a6(0xb3)](0x193)[_0x2871a6(0xbd)]({'success':![],'message':_0x2871a6(0xb5),'suspended':_0x32e4dc?.[_0x2871a6(0xb3)]==='SUSPENDED'});_0x44a858();}catch(_0x53e6cb){return console['error'](_0x2871a6(0xc5),_0x53e6cb),_0x5eb57a[_0x2871a6(0xb3)](0x1f4)['json']({'success':![],'message':_0x2871a6(0xca)});}};exports[a16_0x543876(0xc8)]=requireActiveShop;