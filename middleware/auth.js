'use strict';const a17_0x5db553=a17_0x46fb;(function(_0xc32708,_0x437f9a){const _0x108d3d=a17_0x46fb,_0x6634a4=_0xc32708();while(!![]){try{const _0x3e34e8=parseInt(_0x108d3d(0xc8))/0x1*(-parseInt(_0x108d3d(0xd9))/0x2)+-parseInt(_0x108d3d(0xcc))/0x3+-parseInt(_0x108d3d(0xdb))/0x4+-parseInt(_0x108d3d(0xc3))/0x5+-parseInt(_0x108d3d(0xc6))/0x6*(parseInt(_0x108d3d(0xc5))/0x7)+-parseInt(_0x108d3d(0xd6))/0x8*(parseInt(_0x108d3d(0xbc))/0x9)+parseInt(_0x108d3d(0xca))/0xa*(parseInt(_0x108d3d(0xbd))/0xb);if(_0x3e34e8===_0x437f9a)break;else _0x6634a4['push'](_0x6634a4['shift']());}catch(_0x18c116){_0x6634a4['push'](_0x6634a4['shift']());}}}(a17_0x4287,0xd2f11));function a17_0x46fb(_0x1d61b5,_0xbd278a){const _0x42872a=a17_0x4287();return a17_0x46fb=function(_0x46fb1f,_0x1b0df4){_0x46fb1f=_0x46fb1f-0xb4;let _0x18f984=_0x42872a[_0x46fb1f];return _0x18f984;},a17_0x46fb(_0x1d61b5,_0xbd278a);}var __importDefault=this&&this[a17_0x5db553(0xd1)]||function(_0x411b00){const _0x4cebc8=a17_0x5db553;return _0x411b00&&_0x411b00[_0x4cebc8(0xb5)]?_0x411b00:{'default':_0x411b00};};Object['defineProperty'](exports,'__esModule',{'value':!![]}),exports[a17_0x5db553(0xb8)]=exports[a17_0x5db553(0xc4)]=exports[a17_0x5db553(0xc1)]=exports[a17_0x5db553(0xb7)]=void 0x0;const jsonwebtoken_1=__importDefault(require(a17_0x5db553(0xbe))),config_1=require('../config/config'),tokenBlacklistService_1=require(a17_0x5db553(0xbb)),authenticateToken=(_0x292a99,_0x2762fc,_0x203657)=>{const _0x5e8b52=a17_0x5db553,_0x323668=_0x292a99[_0x5e8b52(0xb6)][_0x5e8b52(0xcb)],_0xae4e2a=_0x323668&&_0x323668[_0x5e8b52(0xd3)]('\x20')[0x1];if(!_0xae4e2a)return _0x2762fc[_0x5e8b52(0xd5)](0x191)[_0x5e8b52(0xc0)]({'success':![],'message':'Access\x20token\x20required'});if(tokenBlacklistService_1[_0x5e8b52(0xce)]['isTokenBlacklisted'](_0xae4e2a))return _0x2762fc[_0x5e8b52(0xd5)](0x191)[_0x5e8b52(0xc0)]({'success':![],'message':_0x5e8b52(0xd4)});jsonwebtoken_1[_0x5e8b52(0xc9)][_0x5e8b52(0xb4)](_0xae4e2a,config_1[_0x5e8b52(0xd0)]['jwt'][_0x5e8b52(0xd7)],(_0xd71cbe,_0x539058)=>{const _0x14d3ab=_0x5e8b52;if(_0xd71cbe)return _0x2762fc[_0x14d3ab(0xd5)](0x193)[_0x14d3ab(0xc0)]({'success':![],'message':_0x14d3ab(0xdc)});_0x292a99[_0x14d3ab(0xdd)]=_0x539058,_0x292a99[_0x14d3ab(0xd8)]=_0xae4e2a,_0x203657();});};exports[a17_0x5db553(0xb7)]=authenticateToken;const requireAdmin=(_0x2263d3,_0x577589,_0x2039a9)=>{const _0xd17473=a17_0x5db553;if(!_0x2263d3['user']||_0x2263d3[_0xd17473(0xdd)]['role']!==_0xd17473(0xcf))return _0x577589['status'](0x193)[_0xd17473(0xc0)]({'success':![],'message':_0xd17473(0xc7)});_0x2039a9();};exports[a17_0x5db553(0xc1)]=requireAdmin;const requireShop=(_0x493c09,_0x465a01,_0x292f4c)=>{const _0x208226=a17_0x5db553;if(!_0x493c09['user']||_0x493c09[_0x208226(0xdd)][_0x208226(0xb9)]!==_0x208226(0xbf))return _0x465a01[_0x208226(0xd5)](0x193)['json']({'success':![],'message':_0x208226(0xba)});_0x292f4c();};exports['requireShop']=requireShop;function a17_0x4287(){const _0x5d8038=['9MwPsQP','33HUPfjl','jsonwebtoken','shop','json','requireAdmin','error','742640rXDsqn','requireShop','632219NoUWqQ','78zNBQfm','Admin\x20access\x20required','39956jdIfwk','default','20773990yQaZNS','authorization','3860682FbEOjV','Error\x20checking\x20account\x20status:','tokenBlacklistService','admin','config','__importDefault','SUSPENDED','split','Token\x20has\x20been\x20revoked','status','8325792SoOoIs','secret','token','64UzVhYa','findUnique','1757284dWhJoI','Invalid\x20or\x20expired\x20token','user','../config/database','verify','__esModule','headers','authenticateToken','requireActiveShop','role','Shop\x20access\x20required','../services/tokenBlacklistService'];a17_0x4287=function(){return _0x5d8038;};return a17_0x4287();}const requireActiveShop=async(_0x1bc86b,_0x413986,_0xe5d2db)=>{const _0x5edf9c=a17_0x5db553;if(!_0x1bc86b[_0x5edf9c(0xdd)]||_0x1bc86b['user'][_0x5edf9c(0xb9)]!==_0x5edf9c(0xbf))return _0x413986[_0x5edf9c(0xd5)](0x193)['json']({'success':![],'message':_0x5edf9c(0xba)});try{const _0x308ca4=require(_0x5edf9c(0xde))['default'],_0x31c23c=await _0x308ca4['shop'][_0x5edf9c(0xda)]({'where':{'id':_0x1bc86b[_0x5edf9c(0xdd)]['id']},'select':{'status':!![]}});if(!_0x31c23c||_0x31c23c['status']!=='ACTIVE')return _0x413986['status'](0x193)[_0x5edf9c(0xc0)]({'success':![],'message':'Account\x20is\x20suspended\x20or\x20inactive.\x20Contact\x20administrator\x20to\x20activate\x20your\x20account.','suspended':_0x31c23c?.[_0x5edf9c(0xd5)]===_0x5edf9c(0xd2)});_0xe5d2db();}catch(_0x475e43){return console[_0x5edf9c(0xc2)](_0x5edf9c(0xcd),_0x475e43),_0x413986[_0x5edf9c(0xd5)](0x1f4)[_0x5edf9c(0xc0)]({'success':![],'message':'Error\x20checking\x20account\x20status'});}};exports[a17_0x5db553(0xb8)]=requireActiveShop;