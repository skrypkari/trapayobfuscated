'use strict';const a16_0x2e50d1=a16_0x531c;function a16_0x531c(_0x59dc9d,_0x3d8375){const _0x49eeed=a16_0x49ee();return a16_0x531c=function(_0x531cc6,_0x23fb1b){_0x531cc6=_0x531cc6-0xec;let _0x1ca3cd=_0x49eeed[_0x531cc6];return _0x1ca3cd;},a16_0x531c(_0x59dc9d,_0x3d8375);}(function(_0x19dc60,_0x7eb601){const _0x5b84fb=a16_0x531c,_0x4a749e=_0x19dc60();while(!![]){try{const _0x27e113=-parseInt(_0x5b84fb(0xf9))/0x1+parseInt(_0x5b84fb(0x103))/0x2*(-parseInt(_0x5b84fb(0xed))/0x3)+-parseInt(_0x5b84fb(0xf4))/0x4*(parseInt(_0x5b84fb(0xfd))/0x5)+parseInt(_0x5b84fb(0x10c))/0x6*(-parseInt(_0x5b84fb(0x116))/0x7)+parseInt(_0x5b84fb(0x117))/0x8*(-parseInt(_0x5b84fb(0xfb))/0x9)+parseInt(_0x5b84fb(0xf7))/0xa+parseInt(_0x5b84fb(0xec))/0xb*(parseInt(_0x5b84fb(0x112))/0xc);if(_0x27e113===_0x7eb601)break;else _0x4a749e['push'](_0x4a749e['shift']());}catch(_0x5d84f1){_0x4a749e['push'](_0x4a749e['shift']());}}}(a16_0x49ee,0x2882c));var __importDefault=this&&this[a16_0x2e50d1(0xfc)]||function(_0xd91a61){const _0xd4a28d=a16_0x2e50d1;return _0xd91a61&&_0xd91a61[_0xd4a28d(0x10b)]?_0xd91a61:{'default':_0xd91a61};};Object[a16_0x2e50d1(0xf6)](exports,a16_0x2e50d1(0x10b),{'value':!![]}),exports['requireActiveShop']=exports[a16_0x2e50d1(0x114)]=exports['requireAdmin']=exports[a16_0x2e50d1(0x111)]=void 0x0;const jsonwebtoken_1=__importDefault(require('jsonwebtoken')),config_1=require(a16_0x2e50d1(0xff)),tokenBlacklistService_1=require(a16_0x2e50d1(0x109)),authenticateToken=(_0x578fe2,_0x2e2047,_0x104d64)=>{const _0x26c27b=a16_0x2e50d1,_0x1c03a8=_0x578fe2['headers'][_0x26c27b(0x10e)],_0x3566d5=_0x1c03a8&&_0x1c03a8[_0x26c27b(0xef)]('\x20')[0x1];if(!_0x3566d5)return _0x2e2047[_0x26c27b(0xf1)](0x191)[_0x26c27b(0x100)]({'success':![],'message':'Access\x20token\x20required'});if(tokenBlacklistService_1[_0x26c27b(0xf5)][_0x26c27b(0x108)](_0x3566d5))return _0x2e2047[_0x26c27b(0xf1)](0x191)['json']({'success':![],'message':_0x26c27b(0x102)});jsonwebtoken_1[_0x26c27b(0x101)]['verify'](_0x3566d5,config_1[_0x26c27b(0xf8)]['jwt'][_0x26c27b(0xfe)],(_0x418af4,_0x75bc0f)=>{const _0x5776eb=_0x26c27b;if(_0x418af4)return _0x2e2047[_0x5776eb(0xf1)](0x193)['json']({'success':![],'message':_0x5776eb(0xfa)});_0x578fe2[_0x5776eb(0x106)]=_0x75bc0f,_0x578fe2[_0x5776eb(0x107)]=_0x3566d5,_0x104d64();});};exports['authenticateToken']=authenticateToken;const requireAdmin=(_0x4e4599,_0x259224,_0x49d6ae)=>{const _0x31bca7=a16_0x2e50d1;if(!_0x4e4599[_0x31bca7(0x106)]||_0x4e4599['user'][_0x31bca7(0xf3)]!==_0x31bca7(0x115))return _0x259224[_0x31bca7(0xf1)](0x193)[_0x31bca7(0x100)]({'success':![],'message':_0x31bca7(0x104)});_0x49d6ae();};exports[a16_0x2e50d1(0x105)]=requireAdmin;const requireShop=(_0x55bb32,_0xc4d859,_0x28e0c0)=>{const _0x2ecea7=a16_0x2e50d1;if(!_0x55bb32[_0x2ecea7(0x106)]||_0x55bb32['user'][_0x2ecea7(0xf3)]!==_0x2ecea7(0x10d))return _0xc4d859[_0x2ecea7(0xf1)](0x193)[_0x2ecea7(0x100)]({'success':![],'message':_0x2ecea7(0x110)});_0x28e0c0();};function a16_0x49ee(){const _0x2926b6=['requireShop','admin','56rYNjvg','216vwWlIT','517bpRkcA','5151DihcmI','Error\x20checking\x20account\x20status:','split','requireActiveShop','status','SUSPENDED','role','8qComDL','tokenBlacklistService','defineProperty','102740FmkGIJ','config','219814OILwEL','Invalid\x20or\x20expired\x20token','70479PEdpNh','__importDefault','80690NiSFBh','secret','../config/config','json','default','Token\x20has\x20been\x20revoked','258xoqnIT','Admin\x20access\x20required','requireAdmin','user','token','isTokenBlacklisted','../services/tokenBlacklistService','Error\x20checking\x20account\x20status','__esModule','236994XjZVCR','shop','authorization','findUnique','Shop\x20access\x20required','authenticateToken','295320PbzdBX','../config/database'];a16_0x49ee=function(){return _0x2926b6;};return a16_0x49ee();}exports[a16_0x2e50d1(0x114)]=requireShop;const requireActiveShop=async(_0x410516,_0x1f3e92,_0x5ec103)=>{const _0x47a89f=a16_0x2e50d1;if(!_0x410516[_0x47a89f(0x106)]||_0x410516['user'][_0x47a89f(0xf3)]!=='shop')return _0x1f3e92[_0x47a89f(0xf1)](0x193)[_0x47a89f(0x100)]({'success':![],'message':_0x47a89f(0x110)});try{const _0xc006cf=require(_0x47a89f(0x113))[_0x47a89f(0x101)],_0x5af918=await _0xc006cf[_0x47a89f(0x10d)][_0x47a89f(0x10f)]({'where':{'id':_0x410516[_0x47a89f(0x106)]['id']},'select':{'status':!![]}});if(!_0x5af918||_0x5af918[_0x47a89f(0xf1)]!=='ACTIVE')return _0x1f3e92['status'](0x193)[_0x47a89f(0x100)]({'success':![],'message':'Account\x20is\x20suspended\x20or\x20inactive.\x20Contact\x20administrator\x20to\x20activate\x20your\x20account.','suspended':_0x5af918?.['status']===_0x47a89f(0xf2)});_0x5ec103();}catch(_0x741115){return console['error'](_0x47a89f(0xee),_0x741115),_0x1f3e92[_0x47a89f(0xf1)](0x1f4)[_0x47a89f(0x100)]({'success':![],'message':_0x47a89f(0x10a)});}};exports[a16_0x2e50d1(0xf0)]=requireActiveShop;