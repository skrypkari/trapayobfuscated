'use strict';const a22_0x516686=a22_0x2376;(function(_0x526ed4,_0x4fb1e6){const _0x2dd7f0=a22_0x2376,_0x199aad=_0x526ed4();while(!![]){try{const _0x386a0d=-parseInt(_0x2dd7f0(0x174))/0x1+parseInt(_0x2dd7f0(0x17a))/0x2*(-parseInt(_0x2dd7f0(0x17f))/0x3)+-parseInt(_0x2dd7f0(0x184))/0x4+-parseInt(_0x2dd7f0(0x189))/0x5+-parseInt(_0x2dd7f0(0x18d))/0x6*(-parseInt(_0x2dd7f0(0x176))/0x7)+-parseInt(_0x2dd7f0(0x178))/0x8+parseInt(_0x2dd7f0(0x187))/0x9;if(_0x386a0d===_0x4fb1e6)break;else _0x199aad['push'](_0x199aad['shift']());}catch(_0x24ccb1){_0x199aad['push'](_0x199aad['shift']());}}}(a22_0x34f4,0xec442));var __importDefault=this&&this[a22_0x516686(0x185)]||function(_0x4f80f1){const _0x2a4aec=a22_0x516686;return _0x4f80f1&&_0x4f80f1[_0x2a4aec(0x183)]?_0x4f80f1:{'default':_0x4f80f1};};Object['defineProperty'](exports,a22_0x516686(0x183),{'value':!![]}),exports[a22_0x516686(0x181)]=exports[a22_0x516686(0x170)]=exports[a22_0x516686(0x18f)]=exports[a22_0x516686(0x198)]=void 0x0;const jsonwebtoken_1=__importDefault(require(a22_0x516686(0x17d))),config_1=require(a22_0x516686(0x18e)),tokenBlacklistService_1=require('../services/tokenBlacklistService'),authenticateToken=(_0x4d7a18,_0x1bb229,_0x7e8fbf)=>{const _0xecd5c7=a22_0x516686,_0xb3f752=_0x4d7a18[_0xecd5c7(0x192)][_0xecd5c7(0x196)],_0x2fe32b=_0xb3f752&&_0xb3f752[_0xecd5c7(0x173)]('\x20')[0x1];if(!_0x2fe32b)return _0x1bb229[_0xecd5c7(0x177)](0x191)[_0xecd5c7(0x197)]({'success':![],'message':_0xecd5c7(0x186)});if(tokenBlacklistService_1[_0xecd5c7(0x199)]['isTokenBlacklisted'](_0x2fe32b))return _0x1bb229[_0xecd5c7(0x177)](0x191)[_0xecd5c7(0x197)]({'success':![],'message':'Token\x20has\x20been\x20revoked'});jsonwebtoken_1[_0xecd5c7(0x193)][_0xecd5c7(0x180)](_0x2fe32b,config_1[_0xecd5c7(0x172)]['jwt'][_0xecd5c7(0x171)],(_0x57329b,_0x569855)=>{const _0x52e3ab=_0xecd5c7;if(_0x57329b)return _0x1bb229[_0x52e3ab(0x177)](0x193)['json']({'success':![],'message':_0x52e3ab(0x179)});_0x4d7a18[_0x52e3ab(0x194)]=_0x569855,_0x4d7a18[_0x52e3ab(0x191)]=_0x2fe32b,_0x7e8fbf();});};exports['authenticateToken']=authenticateToken;const requireAdmin=(_0xcf11e7,_0x38e357,_0x113b14)=>{const _0x3b269e=a22_0x516686;if(!_0xcf11e7[_0x3b269e(0x194)]||_0xcf11e7['user']['role']!==_0x3b269e(0x17e))return _0x38e357[_0x3b269e(0x177)](0x193)[_0x3b269e(0x197)]({'success':![],'message':_0x3b269e(0x17b)});_0x113b14();};exports[a22_0x516686(0x18f)]=requireAdmin;function a22_0x2376(_0x5186b0,_0x5039f8){_0x5186b0=_0x5186b0-0x170;const _0x34f46d=a22_0x34f4();let _0x23769c=_0x34f46d[_0x5186b0];return _0x23769c;}const requireShop=(_0x1ebbd0,_0x43ffb3,_0x290223)=>{const _0x350286=a22_0x516686;if(!_0x1ebbd0['user']||_0x1ebbd0['user'][_0x350286(0x188)]!=='shop')return _0x43ffb3[_0x350286(0x177)](0x193)[_0x350286(0x197)]({'success':![],'message':_0x350286(0x182)});_0x290223();};function a22_0x34f4(){const _0x51715a=['json','authenticateToken','tokenBlacklistService','requireShop','secret','config','split','1198469qumHEa','shop','1463eqQenP','status','9378928RIKVPY','Invalid\x20or\x20expired\x20token','2GCNVMv','Admin\x20access\x20required','error','jsonwebtoken','admin','5489331muMxCH','verify','requireActiveShop','Shop\x20access\x20required','__esModule','142116HmmYHh','__importDefault','Access\x20token\x20required','49288059sHXiPo','role','8142780qyKKid','ACTIVE','findUnique','../config/database','38928zjGxMt','../config/config','requireAdmin','Error\x20checking\x20account\x20status:','token','headers','default','user','Error\x20checking\x20account\x20status','authorization'];a22_0x34f4=function(){return _0x51715a;};return a22_0x34f4();}exports[a22_0x516686(0x170)]=requireShop;const requireActiveShop=async(_0x5d387d,_0x25f035,_0x5f05ab)=>{const _0x1f932e=a22_0x516686;if(!_0x5d387d[_0x1f932e(0x194)]||_0x5d387d[_0x1f932e(0x194)][_0x1f932e(0x188)]!==_0x1f932e(0x175))return _0x25f035[_0x1f932e(0x177)](0x193)[_0x1f932e(0x197)]({'success':![],'message':_0x1f932e(0x182)});try{const _0x273622=require(_0x1f932e(0x18c))[_0x1f932e(0x193)],_0x459b36=await _0x273622[_0x1f932e(0x175)][_0x1f932e(0x18b)]({'where':{'id':_0x5d387d['user']['id']},'select':{'status':!![]}});if(!_0x459b36||_0x459b36[_0x1f932e(0x177)]!==_0x1f932e(0x18a))return _0x25f035[_0x1f932e(0x177)](0x193)[_0x1f932e(0x197)]({'success':![],'message':'Account\x20is\x20suspended\x20or\x20inactive.\x20Contact\x20administrator\x20to\x20activate\x20your\x20account.','suspended':_0x459b36?.[_0x1f932e(0x177)]==='SUSPENDED'});_0x5f05ab();}catch(_0x1af6b4){return console[_0x1f932e(0x17c)](_0x1f932e(0x190),_0x1af6b4),_0x25f035[_0x1f932e(0x177)](0x1f4)['json']({'success':![],'message':_0x1f932e(0x195)});}};exports[a22_0x516686(0x181)]=requireActiveShop;