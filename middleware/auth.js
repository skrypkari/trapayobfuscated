'use strict';function a15_0x519b(){const _0x4aa215=['isTokenBlacklisted','shop','split','secret','38418210BVtHtp','requireShop','52861WTUphH','Admin\x20access\x20required','headers','14FTApEJ','57285vfXbds','__esModule','3615273ZLuAgZ','role','config','1060vzzDaP','465zeSGJK','authorization','jsonwebtoken','default','requireAdmin','Token\x20has\x20been\x20revoked','../config/config','7259888WRMzFn','48pygldO','token','status','user','defineProperty','authenticateToken','json','__importDefault','../services/tokenBlacklistService','906084nqfaLe','verify'];a15_0x519b=function(){return _0x4aa215;};return a15_0x519b();}const a15_0x47b9e0=a15_0x178f;(function(_0x257ed6,_0x5a9741){const _0x57cc85=a15_0x178f,_0x598b43=_0x257ed6();while(!![]){try{const _0xd28f8b=parseInt(_0x57cc85(0x151))/0x1*(-parseInt(_0x57cc85(0x163))/0x2)+-parseInt(_0x57cc85(0x157))/0x3+-parseInt(_0x57cc85(0x15a))/0x4*(parseInt(_0x57cc85(0x15b))/0x5)+-parseInt(_0x57cc85(0x149))/0x6*(-parseInt(_0x57cc85(0x154))/0x7)+-parseInt(_0x57cc85(0x162))/0x8+parseInt(_0x57cc85(0x155))/0x9+parseInt(_0x57cc85(0x14f))/0xa;if(_0xd28f8b===_0x5a9741)break;else _0x598b43['push'](_0x598b43['shift']());}catch(_0xc16733){_0x598b43['push'](_0x598b43['shift']());}}}(a15_0x519b,0xb5b88));var __importDefault=this&&this[a15_0x47b9e0(0x16a)]||function(_0x2db3cf){const _0x2707c8=a15_0x47b9e0;return _0x2db3cf&&_0x2db3cf[_0x2707c8(0x156)]?_0x2db3cf:{'default':_0x2db3cf};};Object[a15_0x47b9e0(0x167)](exports,a15_0x47b9e0(0x156),{'value':!![]}),exports[a15_0x47b9e0(0x150)]=exports['requireAdmin']=exports[a15_0x47b9e0(0x168)]=void 0x0;const jsonwebtoken_1=__importDefault(require(a15_0x47b9e0(0x15d))),config_1=require(a15_0x47b9e0(0x161)),tokenBlacklistService_1=require(a15_0x47b9e0(0x148)),authenticateToken=(_0x1aca14,_0x29d0c3,_0x1e4258)=>{const _0x2d4405=a15_0x47b9e0,_0x428e8f=_0x1aca14[_0x2d4405(0x153)][_0x2d4405(0x15c)],_0x23015e=_0x428e8f&&_0x428e8f[_0x2d4405(0x14d)]('\x20')[0x1];if(!_0x23015e)return _0x29d0c3[_0x2d4405(0x165)](0x191)['json']({'success':![],'message':'Access\x20token\x20required'});if(tokenBlacklistService_1['tokenBlacklistService'][_0x2d4405(0x14b)](_0x23015e))return _0x29d0c3[_0x2d4405(0x165)](0x191)[_0x2d4405(0x169)]({'success':![],'message':_0x2d4405(0x160)});jsonwebtoken_1[_0x2d4405(0x15e)][_0x2d4405(0x14a)](_0x23015e,config_1[_0x2d4405(0x159)]['jwt'][_0x2d4405(0x14e)],(_0x1c668c,_0x273cff)=>{const _0x2f9379=_0x2d4405;if(_0x1c668c)return _0x29d0c3['status'](0x193)['json']({'success':![],'message':'Invalid\x20or\x20expired\x20token'});_0x1aca14['user']=_0x273cff,_0x1aca14[_0x2f9379(0x164)]=_0x23015e,_0x1e4258();});};exports[a15_0x47b9e0(0x168)]=authenticateToken;function a15_0x178f(_0x568139,_0x291c2e){const _0x519bfe=a15_0x519b();return a15_0x178f=function(_0x178faf,_0x573bcd){_0x178faf=_0x178faf-0x148;let _0x25d643=_0x519bfe[_0x178faf];return _0x25d643;},a15_0x178f(_0x568139,_0x291c2e);}const requireAdmin=(_0x6db09e,_0xaceac0,_0x5668ae)=>{const _0x4066cb=a15_0x47b9e0;if(!_0x6db09e['user']||_0x6db09e[_0x4066cb(0x166)]['role']!=='admin')return _0xaceac0[_0x4066cb(0x165)](0x193)[_0x4066cb(0x169)]({'success':![],'message':_0x4066cb(0x152)});_0x5668ae();};exports[a15_0x47b9e0(0x15f)]=requireAdmin;const requireShop=(_0x491d1e,_0x234f27,_0x172b5d)=>{const _0x244715=a15_0x47b9e0;if(!_0x491d1e[_0x244715(0x166)]||_0x491d1e[_0x244715(0x166)][_0x244715(0x158)]!==_0x244715(0x14c))return _0x234f27[_0x244715(0x165)](0x193)['json']({'success':![],'message':'Shop\x20access\x20required'});_0x172b5d();};exports[a15_0x47b9e0(0x150)]=requireShop;