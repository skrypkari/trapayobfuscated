'use strict';const a17_0x3b0695=a17_0x5669;(function(_0x4f3e0e,_0x4f2423){const _0x46aa3f=a17_0x5669,_0x339f01=_0x4f3e0e();while(!![]){try{const _0x100569=parseInt(_0x46aa3f(0x112))/0x1+-parseInt(_0x46aa3f(0x100))/0x2*(-parseInt(_0x46aa3f(0x108))/0x3)+-parseInt(_0x46aa3f(0x121))/0x4*(-parseInt(_0x46aa3f(0x128))/0x5)+parseInt(_0x46aa3f(0x126))/0x6*(-parseInt(_0x46aa3f(0x115))/0x7)+-parseInt(_0x46aa3f(0x117))/0x8+-parseInt(_0x46aa3f(0x109))/0x9*(parseInt(_0x46aa3f(0x122))/0xa)+-parseInt(_0x46aa3f(0x10a))/0xb;if(_0x100569===_0x4f2423)break;else _0x339f01['push'](_0x339f01['shift']());}catch(_0xd3ccc3){_0x339f01['push'](_0x339f01['shift']());}}}(a17_0x251a,0xa5ab7));var __importDefault=this&&this[a17_0x3b0695(0x113)]||function(_0x356975){return _0x356975&&_0x356975['__esModule']?_0x356975:{'default':_0x356975};};Object[a17_0x3b0695(0x125)](exports,a17_0x3b0695(0x12a),{'value':!![]}),exports[a17_0x3b0695(0x114)]=exports['requireShop']=exports[a17_0x3b0695(0x120)]=exports['authenticateToken']=void 0x0;const jsonwebtoken_1=__importDefault(require(a17_0x3b0695(0x123))),config_1=require(a17_0x3b0695(0x118)),tokenBlacklistService_1=require(a17_0x3b0695(0x129)),authenticateToken=(_0x44d631,_0x121bb5,_0x4fb57e)=>{const _0x3bade1=a17_0x3b0695,_0x43c285=_0x44d631[_0x3bade1(0x124)][_0x3bade1(0x102)],_0x1e4213=_0x43c285&&_0x43c285[_0x3bade1(0x127)]('\x20')[0x1];if(!_0x1e4213)return _0x121bb5[_0x3bade1(0x11f)](0x191)['json']({'success':![],'message':_0x3bade1(0x10c)});if(tokenBlacklistService_1[_0x3bade1(0x104)]['isTokenBlacklisted'](_0x1e4213))return _0x121bb5[_0x3bade1(0x11f)](0x191)[_0x3bade1(0x11e)]({'success':![],'message':_0x3bade1(0x107)});jsonwebtoken_1[_0x3bade1(0x10e)]['verify'](_0x1e4213,config_1['config'][_0x3bade1(0x11a)]['secret'],(_0x3f438c,_0x495328)=>{const _0xdcdfe5=_0x3bade1;if(_0x3f438c)return _0x121bb5[_0xdcdfe5(0x11f)](0x193)[_0xdcdfe5(0x11e)]({'success':![],'message':_0xdcdfe5(0x111)});_0x44d631[_0xdcdfe5(0x10f)]=_0x495328,_0x44d631[_0xdcdfe5(0x110)]=_0x1e4213,_0x4fb57e();});};function a17_0x251a(){const _0x28b340=['shop','jwt','Shop\x20access\x20required','Admin\x20access\x20required','findUnique','json','status','requireAdmin','20NJoOvP','10dQKOpb','jsonwebtoken','headers','defineProperty','456312iDjtQN','split','662830QsEhZP','../services/tokenBlacklistService','__esModule','role','SUSPENDED','43856NTNwhL','error','authorization','../config/database','tokenBlacklistService','ACTIVE','admin','Token\x20has\x20been\x20revoked','123qICmfL','2955051NAXgNM','10838542lPnqWd','Error\x20checking\x20account\x20status:','Access\x20token\x20required','Account\x20is\x20suspended\x20or\x20inactive.\x20Contact\x20administrator\x20to\x20activate\x20your\x20account.','default','user','token','Invalid\x20or\x20expired\x20token','1301854YRhJyD','__importDefault','requireActiveShop','7UmUJgi','requireShop','6363488xSbETN','../config/config'];a17_0x251a=function(){return _0x28b340;};return a17_0x251a();}function a17_0x5669(_0x132d30,_0x5c0ef4){const _0x251a1a=a17_0x251a();return a17_0x5669=function(_0x566937,_0x402c43){_0x566937=_0x566937-0xff;let _0x3067d6=_0x251a1a[_0x566937];return _0x3067d6;},a17_0x5669(_0x132d30,_0x5c0ef4);}exports['authenticateToken']=authenticateToken;const requireAdmin=(_0x5a4165,_0x65217d,_0x237ea5)=>{const _0x2293db=a17_0x3b0695;if(!_0x5a4165[_0x2293db(0x10f)]||_0x5a4165[_0x2293db(0x10f)][_0x2293db(0x12b)]!==_0x2293db(0x106))return _0x65217d[_0x2293db(0x11f)](0x193)[_0x2293db(0x11e)]({'success':![],'message':_0x2293db(0x11c)});_0x237ea5();};exports[a17_0x3b0695(0x120)]=requireAdmin;const requireShop=(_0xb3dd02,_0x4855c8,_0x5c6b88)=>{const _0x1014a5=a17_0x3b0695;if(!_0xb3dd02['user']||_0xb3dd02[_0x1014a5(0x10f)][_0x1014a5(0x12b)]!==_0x1014a5(0x119))return _0x4855c8['status'](0x193)['json']({'success':![],'message':_0x1014a5(0x11b)});_0x5c6b88();};exports[a17_0x3b0695(0x116)]=requireShop;const requireActiveShop=async(_0x583ad4,_0x455091,_0x3f38b5)=>{const _0x9b5286=a17_0x3b0695;if(!_0x583ad4[_0x9b5286(0x10f)]||_0x583ad4[_0x9b5286(0x10f)][_0x9b5286(0x12b)]!==_0x9b5286(0x119))return _0x455091[_0x9b5286(0x11f)](0x193)['json']({'success':![],'message':_0x9b5286(0x11b)});try{const _0x10bb8f=require(_0x9b5286(0x103))['default'],_0xfcc26c=await _0x10bb8f[_0x9b5286(0x119)][_0x9b5286(0x11d)]({'where':{'id':_0x583ad4[_0x9b5286(0x10f)]['id']},'select':{'status':!![]}});if(!_0xfcc26c||_0xfcc26c[_0x9b5286(0x11f)]!==_0x9b5286(0x105))return _0x455091[_0x9b5286(0x11f)](0x193)[_0x9b5286(0x11e)]({'success':![],'message':_0x9b5286(0x10d),'suspended':_0xfcc26c?.['status']===_0x9b5286(0xff)});_0x3f38b5();}catch(_0x20e587){return console[_0x9b5286(0x101)](_0x9b5286(0x10b),_0x20e587),_0x455091['status'](0x1f4)[_0x9b5286(0x11e)]({'success':![],'message':'Error\x20checking\x20account\x20status'});}};exports[a17_0x3b0695(0x114)]=requireActiveShop;