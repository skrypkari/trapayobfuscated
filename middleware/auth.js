'use strict';const a16_0xc2b0f8=a16_0x5073;(function(_0x4c726d,_0x51c560){const _0x35c487=a16_0x5073,_0x5c4775=_0x4c726d();while(!![]){try{const _0x23a828=parseInt(_0x35c487(0x16d))/0x1*(parseInt(_0x35c487(0x18d))/0x2)+-parseInt(_0x35c487(0x177))/0x3*(parseInt(_0x35c487(0x18b))/0x4)+parseInt(_0x35c487(0x17a))/0x5*(-parseInt(_0x35c487(0x167))/0x6)+-parseInt(_0x35c487(0x17d))/0x7+parseInt(_0x35c487(0x17c))/0x8+-parseInt(_0x35c487(0x191))/0x9*(parseInt(_0x35c487(0x180))/0xa)+parseInt(_0x35c487(0x170))/0xb;if(_0x23a828===_0x51c560)break;else _0x5c4775['push'](_0x5c4775['shift']());}catch(_0xecba76){_0x5c4775['push'](_0x5c4775['shift']());}}}(a16_0xb924,0x68470));var __importDefault=this&&this[a16_0xc2b0f8(0x18c)]||function(_0x12b8f8){const _0x5b4039=a16_0xc2b0f8;return _0x12b8f8&&_0x12b8f8[_0x5b4039(0x18e)]?_0x12b8f8:{'default':_0x12b8f8};};function a16_0xb924(){const _0x281428=['SUSPENDED','Shop\x20access\x20required','2266970iuhXmN','isTokenBlacklisted','Access\x20token\x20required','authorization','status','findUnique','split','defineProperty','verify','config','jwt','4tfuDzZ','__importDefault','150834lVabcp','__esModule','requireActiveShop','shop','18KamiPE','error','../services/tokenBlacklistService','419412EsTcdR','Token\x20has\x20been\x20revoked','headers','Invalid\x20or\x20expired\x20token','token','../config/config','2ZtIlJZ','admin','user','12005312xGwCcJ','authenticateToken','Error\x20checking\x20account\x20status:','requireAdmin','Admin\x20access\x20required','Error\x20checking\x20account\x20status','role','511641FcfNxC','jsonwebtoken','requireShop','15YuJDvQ','json','6079968STImVx','5190185AejsqC'];a16_0xb924=function(){return _0x281428;};return a16_0xb924();}Object[a16_0xc2b0f8(0x187)](exports,a16_0xc2b0f8(0x18e),{'value':!![]}),exports[a16_0xc2b0f8(0x18f)]=exports['requireShop']=exports[a16_0xc2b0f8(0x173)]=exports[a16_0xc2b0f8(0x171)]=void 0x0;const jsonwebtoken_1=__importDefault(require(a16_0xc2b0f8(0x178))),config_1=require(a16_0xc2b0f8(0x16c)),tokenBlacklistService_1=require(a16_0xc2b0f8(0x166)),authenticateToken=(_0x2b2d06,_0x28c86d,_0x32af4f)=>{const _0x52ee25=a16_0xc2b0f8,_0x532860=_0x2b2d06[_0x52ee25(0x169)][_0x52ee25(0x183)],_0x5c6713=_0x532860&&_0x532860[_0x52ee25(0x186)]('\x20')[0x1];if(!_0x5c6713)return _0x28c86d[_0x52ee25(0x184)](0x191)['json']({'success':![],'message':_0x52ee25(0x182)});if(tokenBlacklistService_1['tokenBlacklistService'][_0x52ee25(0x181)](_0x5c6713))return _0x28c86d[_0x52ee25(0x184)](0x191)[_0x52ee25(0x17b)]({'success':![],'message':_0x52ee25(0x168)});jsonwebtoken_1['default'][_0x52ee25(0x188)](_0x5c6713,config_1[_0x52ee25(0x189)][_0x52ee25(0x18a)]['secret'],(_0x29b8f8,_0xc5cfb0)=>{const _0x30e661=_0x52ee25;if(_0x29b8f8)return _0x28c86d[_0x30e661(0x184)](0x193)[_0x30e661(0x17b)]({'success':![],'message':_0x30e661(0x16a)});_0x2b2d06[_0x30e661(0x16f)]=_0xc5cfb0,_0x2b2d06[_0x30e661(0x16b)]=_0x5c6713,_0x32af4f();});};exports[a16_0xc2b0f8(0x171)]=authenticateToken;const requireAdmin=(_0x5ee3db,_0x3a3ef0,_0x3a4422)=>{const _0x1a47a5=a16_0xc2b0f8;if(!_0x5ee3db[_0x1a47a5(0x16f)]||_0x5ee3db['user'][_0x1a47a5(0x176)]!==_0x1a47a5(0x16e))return _0x3a3ef0['status'](0x193)[_0x1a47a5(0x17b)]({'success':![],'message':_0x1a47a5(0x174)});_0x3a4422();};exports[a16_0xc2b0f8(0x173)]=requireAdmin;const requireShop=(_0x447f7f,_0x548906,_0x23da24)=>{const _0x5be3ed=a16_0xc2b0f8;if(!_0x447f7f[_0x5be3ed(0x16f)]||_0x447f7f['user'][_0x5be3ed(0x176)]!=='shop')return _0x548906['status'](0x193)[_0x5be3ed(0x17b)]({'success':![],'message':_0x5be3ed(0x17f)});_0x23da24();};function a16_0x5073(_0x52c322,_0x134cf1){const _0xb92432=a16_0xb924();return a16_0x5073=function(_0x5073a0,_0x1fec88){_0x5073a0=_0x5073a0-0x165;let _0x32788e=_0xb92432[_0x5073a0];return _0x32788e;},a16_0x5073(_0x52c322,_0x134cf1);}exports[a16_0xc2b0f8(0x179)]=requireShop;const requireActiveShop=async(_0x48dba6,_0x436bbd,_0x3e5c89)=>{const _0x52f9fd=a16_0xc2b0f8;if(!_0x48dba6[_0x52f9fd(0x16f)]||_0x48dba6[_0x52f9fd(0x16f)]['role']!==_0x52f9fd(0x190))return _0x436bbd['status'](0x193)[_0x52f9fd(0x17b)]({'success':![],'message':'Shop\x20access\x20required'});try{const _0x1df20f=require('../config/database')['default'],_0x377fa5=await _0x1df20f[_0x52f9fd(0x190)][_0x52f9fd(0x185)]({'where':{'id':_0x48dba6['user']['id']},'select':{'status':!![]}});if(!_0x377fa5||_0x377fa5[_0x52f9fd(0x184)]!=='ACTIVE')return _0x436bbd[_0x52f9fd(0x184)](0x193)[_0x52f9fd(0x17b)]({'success':![],'message':'Account\x20is\x20suspended\x20or\x20inactive.\x20Contact\x20administrator\x20to\x20activate\x20your\x20account.','suspended':_0x377fa5?.['status']===_0x52f9fd(0x17e)});_0x3e5c89();}catch(_0x124aea){return console[_0x52f9fd(0x165)](_0x52f9fd(0x172),_0x124aea),_0x436bbd[_0x52f9fd(0x184)](0x1f4)[_0x52f9fd(0x17b)]({'success':![],'message':_0x52f9fd(0x175)});}};exports[a16_0xc2b0f8(0x18f)]=requireActiveShop;