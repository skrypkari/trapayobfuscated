'use strict';const a16_0x5648cf=a16_0x5436;(function(_0x4dd95d,_0x42a3f4){const _0x13d86b=a16_0x5436,_0x368030=_0x4dd95d();while(!![]){try{const _0xe37d54=parseInt(_0x13d86b(0xf1))/0x1+-parseInt(_0x13d86b(0x100))/0x2+-parseInt(_0x13d86b(0x105))/0x3*(parseInt(_0x13d86b(0xfa))/0x4)+parseInt(_0x13d86b(0xf9))/0x5*(parseInt(_0x13d86b(0x101))/0x6)+parseInt(_0x13d86b(0xfd))/0x7+parseInt(_0x13d86b(0xea))/0x8*(parseInt(_0x13d86b(0xf4))/0x9)+parseInt(_0x13d86b(0xf2))/0xa*(-parseInt(_0x13d86b(0xfb))/0xb);if(_0xe37d54===_0x42a3f4)break;else _0x368030['push'](_0x368030['shift']());}catch(_0xda5aef){_0x368030['push'](_0x368030['shift']());}}}(a16_0x20c5,0xea7c8));var __importDefault=this&&this[a16_0x5648cf(0xfc)]||function(_0x295769){const _0x1e11f4=a16_0x5648cf;return _0x295769&&_0x295769[_0x1e11f4(0xec)]?_0x295769:{'default':_0x295769};};Object[a16_0x5648cf(0xed)](exports,'__esModule',{'value':!![]}),exports[a16_0x5648cf(0xf7)]=exports[a16_0x5648cf(0x109)]=exports[a16_0x5648cf(0xf5)]=void 0x0;function a16_0x5436(_0x39574d,_0x3984c7){const _0x20c5e1=a16_0x20c5();return a16_0x5436=function(_0x5436db,_0x8dcfbe){_0x5436db=_0x5436db-0xea;let _0xefee1=_0x20c5e1[_0x5436db];return _0xefee1;},a16_0x5436(_0x39574d,_0x3984c7);}const jsonwebtoken_1=__importDefault(require(a16_0x5648cf(0xf6))),config_1=require(a16_0x5648cf(0x10a)),tokenBlacklistService_1=require('../services/tokenBlacklistService'),authenticateToken=(_0x1a6ba4,_0x50c28a,_0xc1567e)=>{const _0x1353e3=a16_0x5648cf,_0x4cf516=_0x1a6ba4[_0x1353e3(0x108)]['authorization'],_0x3b98ec=_0x4cf516&&_0x4cf516['split']('\x20')[0x1];if(!_0x3b98ec)return _0x50c28a[_0x1353e3(0x103)](0x191)[_0x1353e3(0xf8)]({'success':![],'message':'Access\x20token\x20required'});if(tokenBlacklistService_1[_0x1353e3(0x107)][_0x1353e3(0xff)](_0x3b98ec))return _0x50c28a['status'](0x191)['json']({'success':![],'message':_0x1353e3(0x106)});jsonwebtoken_1['default']['verify'](_0x3b98ec,config_1[_0x1353e3(0xef)][_0x1353e3(0xee)][_0x1353e3(0x102)],(_0x5f1160,_0x53b296)=>{const _0x365aff=_0x1353e3;if(_0x5f1160)return _0x50c28a['status'](0x193)[_0x365aff(0xf8)]({'success':![],'message':'Invalid\x20or\x20expired\x20token'});_0x1a6ba4[_0x365aff(0xf3)]=_0x53b296,_0x1a6ba4[_0x365aff(0xfe)]=_0x3b98ec,_0xc1567e();});};exports[a16_0x5648cf(0xf5)]=authenticateToken;const requireAdmin=(_0x2e71be,_0x48c999,_0x331bcd)=>{const _0x59dd9d=a16_0x5648cf;if(!_0x2e71be[_0x59dd9d(0xf3)]||_0x2e71be[_0x59dd9d(0xf3)][_0x59dd9d(0xeb)]!=='admin')return _0x48c999[_0x59dd9d(0x103)](0x193)['json']({'success':![],'message':_0x59dd9d(0x104)});_0x331bcd();};exports[a16_0x5648cf(0x109)]=requireAdmin;const requireShop=(_0x43ab62,_0x4263ea,_0x5bfaad)=>{const _0x53054d=a16_0x5648cf;if(!_0x43ab62[_0x53054d(0xf3)]||_0x43ab62[_0x53054d(0xf3)][_0x53054d(0xeb)]!=='shop')return _0x4263ea[_0x53054d(0x103)](0x193)[_0x53054d(0xf8)]({'success':![],'message':_0x53054d(0xf0)});_0x5bfaad();};exports[a16_0x5648cf(0xf7)]=requireShop;function a16_0x20c5(){const _0x22c9e6=['238722WstPAE','__importDefault','6106618bixrTK','token','isTokenBlacklisted','1942094KJSxZI','1014VpXxlF','secret','status','Admin\x20access\x20required','2403xlKrsM','Token\x20has\x20been\x20revoked','tokenBlacklistService','headers','requireAdmin','../config/config','32XEwnAt','role','__esModule','defineProperty','jwt','config','Shop\x20access\x20required','1279307LTVgqe','630pQmMjh','user','1200501kkzpDz','authenticateToken','jsonwebtoken','requireShop','json','36185rTQoOW','3044RiOgYU'];a16_0x20c5=function(){return _0x22c9e6;};return a16_0x20c5();}