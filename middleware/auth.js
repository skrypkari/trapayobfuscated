'use strict';const a16_0xfb43e1=a16_0x3a26;(function(_0x2031ae,_0x4c6cca){const _0x190012=a16_0x3a26,_0x5369b3=_0x2031ae();while(!![]){try{const _0x32e108=-parseInt(_0x190012(0x19d))/0x1*(-parseInt(_0x190012(0x1a1))/0x2)+parseInt(_0x190012(0x1b0))/0x3*(parseInt(_0x190012(0x1b8))/0x4)+parseInt(_0x190012(0x1a8))/0x5+parseInt(_0x190012(0x1b4))/0x6*(parseInt(_0x190012(0x1a6))/0x7)+-parseInt(_0x190012(0x19a))/0x8*(parseInt(_0x190012(0x1ac))/0x9)+parseInt(_0x190012(0x1a7))/0xa+-parseInt(_0x190012(0x19f))/0xb;if(_0x32e108===_0x4c6cca)break;else _0x5369b3['push'](_0x5369b3['shift']());}catch(_0x20c376){_0x5369b3['push'](_0x5369b3['shift']());}}}(a16_0x3324,0x86e89));var __importDefault=this&&this[a16_0xfb43e1(0x1b2)]||function(_0x27e5cd){return _0x27e5cd&&_0x27e5cd['__esModule']?_0x27e5cd:{'default':_0x27e5cd};};Object[a16_0xfb43e1(0x1bf)](exports,a16_0xfb43e1(0x199),{'value':!![]}),exports[a16_0xfb43e1(0x1b3)]=exports[a16_0xfb43e1(0x1bb)]=exports['requireAdmin']=exports['authenticateToken']=void 0x0;const jsonwebtoken_1=__importDefault(require(a16_0xfb43e1(0x1b1))),config_1=require('../config/config'),tokenBlacklistService_1=require(a16_0xfb43e1(0x1be)),authenticateToken=(_0x2fe418,_0x56e919,_0x4402af)=>{const _0x4daa47=a16_0xfb43e1,_0x33cce5=_0x2fe418[_0x4daa47(0x19e)][_0x4daa47(0x1b5)],_0xe5f642=_0x33cce5&&_0x33cce5['split']('\x20')[0x1];if(!_0xe5f642)return _0x56e919['status'](0x191)['json']({'success':![],'message':_0x4daa47(0x19b)});if(tokenBlacklistService_1['tokenBlacklistService']['isTokenBlacklisted'](_0xe5f642))return _0x56e919[_0x4daa47(0x1bd)](0x191)[_0x4daa47(0x1ba)]({'success':![],'message':'Token\x20has\x20been\x20revoked'});jsonwebtoken_1[_0x4daa47(0x1a0)]['verify'](_0xe5f642,config_1['config'][_0x4daa47(0x1a3)][_0x4daa47(0x1b9)],(_0x13be13,_0x5b52c8)=>{const _0x1d1841=_0x4daa47;if(_0x13be13)return _0x56e919[_0x1d1841(0x1bd)](0x193)[_0x1d1841(0x1ba)]({'success':![],'message':'Invalid\x20or\x20expired\x20token'});_0x2fe418[_0x1d1841(0x19c)]=_0x5b52c8,_0x2fe418[_0x1d1841(0x1ab)]=_0xe5f642,_0x4402af();});};exports[a16_0xfb43e1(0x1ae)]=authenticateToken;const requireAdmin=(_0x1c14d2,_0x278e69,_0x2d34d2)=>{const _0x2ca3eb=a16_0xfb43e1;if(!_0x1c14d2['user']||_0x1c14d2[_0x2ca3eb(0x19c)][_0x2ca3eb(0x1a2)]!==_0x2ca3eb(0x1a9))return _0x278e69[_0x2ca3eb(0x1bd)](0x193)['json']({'success':![],'message':'Admin\x20access\x20required'});_0x2d34d2();};function a16_0x3324(){const _0x367dbd=['21332146xQYPQS','default','20ktkTCU','role','jwt','../config/database','Shop\x20access\x20required','168259KxOrEn','8866600kDJUdx','578985MErjVg','admin','shop','token','36QMKUkD','error','authenticateToken','SUSPENDED','243prgqtK','jsonwebtoken','__importDefault','requireActiveShop','6hZAKmh','authorization','findUnique','Error\x20checking\x20account\x20status:','38420bwMEMP','secret','json','requireShop','ACTIVE','status','../services/tokenBlacklistService','defineProperty','Account\x20is\x20suspended\x20or\x20inactive.\x20Contact\x20administrator\x20to\x20activate\x20your\x20account.','__esModule','562616XdJJwn','Access\x20token\x20required','user','96868uqWeup','headers'];a16_0x3324=function(){return _0x367dbd;};return a16_0x3324();}exports['requireAdmin']=requireAdmin;const requireShop=(_0x295da9,_0x47fe1e,_0x11f2e6)=>{const _0x13b23f=a16_0xfb43e1;if(!_0x295da9[_0x13b23f(0x19c)]||_0x295da9['user'][_0x13b23f(0x1a2)]!=='shop')return _0x47fe1e[_0x13b23f(0x1bd)](0x193)[_0x13b23f(0x1ba)]({'success':![],'message':_0x13b23f(0x1a5)});_0x11f2e6();};function a16_0x3a26(_0x5e9390,_0x23d68f){const _0x3324c2=a16_0x3324();return a16_0x3a26=function(_0x3a2660,_0x38a588){_0x3a2660=_0x3a2660-0x199;let _0x10684d=_0x3324c2[_0x3a2660];return _0x10684d;},a16_0x3a26(_0x5e9390,_0x23d68f);}exports['requireShop']=requireShop;const requireActiveShop=async(_0x2b76e6,_0x4a0afd,_0x157c1d)=>{const _0x1cc9d2=a16_0xfb43e1;if(!_0x2b76e6[_0x1cc9d2(0x19c)]||_0x2b76e6['user'][_0x1cc9d2(0x1a2)]!==_0x1cc9d2(0x1aa))return _0x4a0afd[_0x1cc9d2(0x1bd)](0x193)['json']({'success':![],'message':_0x1cc9d2(0x1a5)});try{const _0x7993a9=require(_0x1cc9d2(0x1a4))[_0x1cc9d2(0x1a0)],_0x448b79=await _0x7993a9[_0x1cc9d2(0x1aa)][_0x1cc9d2(0x1b6)]({'where':{'id':_0x2b76e6['user']['id']},'select':{'status':!![]}});if(!_0x448b79||_0x448b79['status']!==_0x1cc9d2(0x1bc))return _0x4a0afd['status'](0x193)[_0x1cc9d2(0x1ba)]({'success':![],'message':_0x1cc9d2(0x1c0),'suspended':_0x448b79?.[_0x1cc9d2(0x1bd)]===_0x1cc9d2(0x1af)});_0x157c1d();}catch(_0x2f6aa6){return console[_0x1cc9d2(0x1ad)](_0x1cc9d2(0x1b7),_0x2f6aa6),_0x4a0afd[_0x1cc9d2(0x1bd)](0x1f4)[_0x1cc9d2(0x1ba)]({'success':![],'message':'Error\x20checking\x20account\x20status'});}};exports[a16_0xfb43e1(0x1b3)]=requireActiveShop;