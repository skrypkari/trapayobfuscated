'use strict';const a16_0x231b18=a16_0x489b;(function(_0x88011c,_0x12af1f){const _0x591f53=a16_0x489b,_0x240da9=_0x88011c();while(!![]){try{const _0xb37768=parseInt(_0x591f53(0x73))/0x1*(-parseInt(_0x591f53(0x7f))/0x2)+-parseInt(_0x591f53(0x88))/0x3+-parseInt(_0x591f53(0x91))/0x4+parseInt(_0x591f53(0x6a))/0x5*(parseInt(_0x591f53(0x89))/0x6)+-parseInt(_0x591f53(0x6d))/0x7*(parseInt(_0x591f53(0x82))/0x8)+parseInt(_0x591f53(0x93))/0x9*(-parseInt(_0x591f53(0x80))/0xa)+-parseInt(_0x591f53(0x90))/0xb*(-parseInt(_0x591f53(0x8b))/0xc);if(_0xb37768===_0x12af1f)break;else _0x240da9['push'](_0x240da9['shift']());}catch(_0x5e554f){_0x240da9['push'](_0x240da9['shift']());}}}(a16_0x3b61,0x2325c));var __importDefault=this&&this[a16_0x231b18(0x84)]||function(_0x33be41){return _0x33be41&&_0x33be41['__esModule']?_0x33be41:{'default':_0x33be41};};function a16_0x3b61(){const _0x5b39f7=['requireShop','837612waDMvV','2442gQSbNr','__esModule','84ZnIRjQ','requireActiveShop','jsonwebtoken','user','config','970783MqTnNo','1093780NJYYzn','Shop\x20access\x20required','9AcJvfM','headers','2165hyODhH','authorization','findUnique','13503RRiYhI','verify','Admin\x20access\x20required','Account\x20is\x20suspended\x20or\x20inactive.\x20Contact\x20administrator\x20to\x20activate\x20your\x20account.','token','Access\x20token\x20required','895UNgQLn','json','Error\x20checking\x20account\x20status:','status','shop','ACTIVE','authenticateToken','secret','error','tokenBlacklistService','SUSPENDED','default','78pNzoLC','296910UfNNVj','split','136FAvNIG','requireAdmin','__importDefault','role','isTokenBlacklisted'];a16_0x3b61=function(){return _0x5b39f7;};return a16_0x3b61();}Object['defineProperty'](exports,a16_0x231b18(0x8a),{'value':!![]}),exports[a16_0x231b18(0x8c)]=exports[a16_0x231b18(0x87)]=exports[a16_0x231b18(0x83)]=exports['authenticateToken']=void 0x0;const jsonwebtoken_1=__importDefault(require(a16_0x231b18(0x8d))),config_1=require('../config/config'),tokenBlacklistService_1=require('../services/tokenBlacklistService'),authenticateToken=(_0x2f0149,_0x5168ef,_0x233a37)=>{const _0x42afe1=a16_0x231b18,_0x182511=_0x2f0149[_0x42afe1(0x69)][_0x42afe1(0x6b)],_0x23ad44=_0x182511&&_0x182511[_0x42afe1(0x81)]('\x20')[0x1];if(!_0x23ad44)return _0x5168ef[_0x42afe1(0x76)](0x191)[_0x42afe1(0x74)]({'success':![],'message':_0x42afe1(0x72)});if(tokenBlacklistService_1[_0x42afe1(0x7c)][_0x42afe1(0x86)](_0x23ad44))return _0x5168ef[_0x42afe1(0x76)](0x191)[_0x42afe1(0x74)]({'success':![],'message':'Token\x20has\x20been\x20revoked'});jsonwebtoken_1[_0x42afe1(0x7e)][_0x42afe1(0x6e)](_0x23ad44,config_1[_0x42afe1(0x8f)]['jwt'][_0x42afe1(0x7a)],(_0x38643e,_0x59706d)=>{const _0x50c4aa=_0x42afe1;if(_0x38643e)return _0x5168ef['status'](0x193)[_0x50c4aa(0x74)]({'success':![],'message':'Invalid\x20or\x20expired\x20token'});_0x2f0149[_0x50c4aa(0x8e)]=_0x59706d,_0x2f0149[_0x50c4aa(0x71)]=_0x23ad44,_0x233a37();});};exports[a16_0x231b18(0x79)]=authenticateToken;const requireAdmin=(_0x267930,_0x42df0c,_0x1824a2)=>{const _0x5cfa2f=a16_0x231b18;if(!_0x267930['user']||_0x267930[_0x5cfa2f(0x8e)][_0x5cfa2f(0x85)]!=='admin')return _0x42df0c[_0x5cfa2f(0x76)](0x193)['json']({'success':![],'message':_0x5cfa2f(0x6f)});_0x1824a2();};exports[a16_0x231b18(0x83)]=requireAdmin;const requireShop=(_0xc66459,_0x2a5397,_0x83ea90)=>{const _0x41b8a7=a16_0x231b18;if(!_0xc66459[_0x41b8a7(0x8e)]||_0xc66459[_0x41b8a7(0x8e)]['role']!==_0x41b8a7(0x77))return _0x2a5397['status'](0x193)[_0x41b8a7(0x74)]({'success':![],'message':_0x41b8a7(0x92)});_0x83ea90();};exports['requireShop']=requireShop;const requireActiveShop=async(_0xa93500,_0x5c55a5,_0xeca1d1)=>{const _0x489bd2=a16_0x231b18;if(!_0xa93500[_0x489bd2(0x8e)]||_0xa93500[_0x489bd2(0x8e)][_0x489bd2(0x85)]!=='shop')return _0x5c55a5[_0x489bd2(0x76)](0x193)[_0x489bd2(0x74)]({'success':![],'message':_0x489bd2(0x92)});try{const _0x1206a4=require('../config/database')[_0x489bd2(0x7e)],_0x1babc2=await _0x1206a4[_0x489bd2(0x77)][_0x489bd2(0x6c)]({'where':{'id':_0xa93500[_0x489bd2(0x8e)]['id']},'select':{'status':!![]}});if(!_0x1babc2||_0x1babc2[_0x489bd2(0x76)]!==_0x489bd2(0x78))return _0x5c55a5[_0x489bd2(0x76)](0x193)[_0x489bd2(0x74)]({'success':![],'message':_0x489bd2(0x70),'suspended':_0x1babc2?.[_0x489bd2(0x76)]===_0x489bd2(0x7d)});_0xeca1d1();}catch(_0x5bad47){return console[_0x489bd2(0x7b)](_0x489bd2(0x75),_0x5bad47),_0x5c55a5[_0x489bd2(0x76)](0x1f4)['json']({'success':![],'message':'Error\x20checking\x20account\x20status'});}};function a16_0x489b(_0x228025,_0x19e6a8){const _0x3b6134=a16_0x3b61();return a16_0x489b=function(_0x489b0f,_0x53074f){_0x489b0f=_0x489b0f-0x69;let _0x2e1377=_0x3b6134[_0x489b0f];return _0x2e1377;},a16_0x489b(_0x228025,_0x19e6a8);}exports['requireActiveShop']=requireActiveShop;