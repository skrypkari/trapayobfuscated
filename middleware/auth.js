'use strict';const a22_0x50e152=a22_0x3cb0;(function(_0x447146,_0x2c1397){const _0x14cf6d=a22_0x3cb0,_0x4b91be=_0x447146();while(!![]){try{const _0x1f9b94=parseInt(_0x14cf6d(0x161))/0x1+parseInt(_0x14cf6d(0x151))/0x2+parseInt(_0x14cf6d(0x14c))/0x3+-parseInt(_0x14cf6d(0x15c))/0x4+-parseInt(_0x14cf6d(0x147))/0x5*(parseInt(_0x14cf6d(0x146))/0x6)+-parseInt(_0x14cf6d(0x15b))/0x7*(parseInt(_0x14cf6d(0x15e))/0x8)+parseInt(_0x14cf6d(0x14f))/0x9;if(_0x1f9b94===_0x2c1397)break;else _0x4b91be['push'](_0x4b91be['shift']());}catch(_0x5396af){_0x4b91be['push'](_0x4b91be['shift']());}}}(a22_0x280f,0xd3b31));var __importDefault=this&&this[a22_0x50e152(0x145)]||function(_0xf01a41){const _0x3e9a56=a22_0x50e152;return _0xf01a41&&_0xf01a41[_0x3e9a56(0x156)]?_0xf01a41:{'default':_0xf01a41};};Object[a22_0x50e152(0x149)](exports,'__esModule',{'value':!![]}),exports[a22_0x50e152(0x164)]=exports[a22_0x50e152(0x14b)]=exports[a22_0x50e152(0x152)]=exports[a22_0x50e152(0x157)]=void 0x0;const jsonwebtoken_1=__importDefault(require(a22_0x50e152(0x160))),config_1=require(a22_0x50e152(0x148)),tokenBlacklistService_1=require('../services/tokenBlacklistService'),authenticateToken=(_0x3106dc,_0x871fb4,_0x58329a)=>{const _0x2bceea=a22_0x50e152,_0x1732bd=_0x3106dc['headers'][_0x2bceea(0x141)],_0x1befe2=_0x1732bd&&_0x1732bd[_0x2bceea(0x155)]('\x20')[0x1];if(!_0x1befe2)return _0x871fb4[_0x2bceea(0x15f)](0x191)[_0x2bceea(0x142)]({'success':![],'message':_0x2bceea(0x140)});if(tokenBlacklistService_1['tokenBlacklistService'][_0x2bceea(0x143)](_0x1befe2))return _0x871fb4[_0x2bceea(0x15f)](0x191)[_0x2bceea(0x142)]({'success':![],'message':_0x2bceea(0x154)});jsonwebtoken_1['default'][_0x2bceea(0x150)](_0x1befe2,config_1[_0x2bceea(0x166)][_0x2bceea(0x165)][_0x2bceea(0x14d)],(_0x37aab8,_0x53b6f2)=>{const _0x482454=_0x2bceea;if(_0x37aab8)return _0x871fb4['status'](0x193)['json']({'success':![],'message':'Invalid\x20or\x20expired\x20token'});_0x3106dc[_0x482454(0x14e)]=_0x53b6f2,_0x3106dc[_0x482454(0x159)]=_0x1befe2,_0x58329a();});};exports[a22_0x50e152(0x157)]=authenticateToken;const requireAdmin=(_0x43b59d,_0x406ca7,_0x2cd32f)=>{const _0x1f891c=a22_0x50e152;if(!_0x43b59d[_0x1f891c(0x14e)]||_0x43b59d[_0x1f891c(0x14e)]['role']!=='admin')return _0x406ca7[_0x1f891c(0x15f)](0x193)[_0x1f891c(0x142)]({'success':![],'message':'Admin\x20access\x20required'});_0x2cd32f();};exports['requireAdmin']=requireAdmin;const requireShop=(_0x463063,_0x263516,_0x87d2d9)=>{const _0x5bddb1=a22_0x50e152;if(!_0x463063[_0x5bddb1(0x14e)]||_0x463063[_0x5bddb1(0x14e)][_0x5bddb1(0x163)]!=='shop')return _0x263516[_0x5bddb1(0x15f)](0x193)[_0x5bddb1(0x142)]({'success':![],'message':_0x5bddb1(0x167)});_0x87d2d9();};exports['requireShop']=requireShop;const requireActiveShop=async(_0x4af3e2,_0x2bb911,_0x2519a)=>{const _0x349313=a22_0x50e152;if(!_0x4af3e2[_0x349313(0x14e)]||_0x4af3e2[_0x349313(0x14e)][_0x349313(0x163)]!==_0x349313(0x144))return _0x2bb911[_0x349313(0x15f)](0x193)[_0x349313(0x142)]({'success':![],'message':_0x349313(0x167)});try{const _0x30c895=require('../config/database')[_0x349313(0x158)],_0x5d86a5=await _0x30c895['shop'][_0x349313(0x15a)]({'where':{'id':_0x4af3e2[_0x349313(0x14e)]['id']},'select':{'status':!![]}});if(!_0x5d86a5||_0x5d86a5[_0x349313(0x15f)]!==_0x349313(0x153))return _0x2bb911[_0x349313(0x15f)](0x193)[_0x349313(0x142)]({'success':![],'message':_0x349313(0x14a),'suspended':_0x5d86a5?.[_0x349313(0x15f)]===_0x349313(0x162)});_0x2519a();}catch(_0x2ea64d){return console[_0x349313(0x15d)]('Error\x20checking\x20account\x20status:',_0x2ea64d),_0x2bb911[_0x349313(0x15f)](0x1f4)[_0x349313(0x142)]({'success':![],'message':'Error\x20checking\x20account\x20status'});}};exports[a22_0x50e152(0x164)]=requireActiveShop;function a22_0x3cb0(_0x1b3205,_0x39cf76){_0x1b3205=_0x1b3205-0x140;const _0x280f0c=a22_0x280f();let _0x3cb03c=_0x280f0c[_0x1b3205];return _0x3cb03c;}function a22_0x280f(){const _0x38f17f=['role','requireActiveShop','jwt','config','Shop\x20access\x20required','Access\x20token\x20required','authorization','json','isTokenBlacklisted','shop','__importDefault','739002MrRJNV','10mqLPmz','../config/config','defineProperty','Account\x20is\x20suspended\x20or\x20inactive.\x20Contact\x20administrator\x20to\x20activate\x20your\x20account.','requireShop','1593909wpVXsT','secret','user','16163127mIGArg','verify','1237352KoyqcC','requireAdmin','ACTIVE','Token\x20has\x20been\x20revoked','split','__esModule','authenticateToken','default','token','findUnique','10670065JvIMtt','2462220bHrhdv','error','8wVFwGN','status','jsonwebtoken','307423cOpMTx','SUSPENDED'];a22_0x280f=function(){return _0x38f17f;};return a22_0x280f();}