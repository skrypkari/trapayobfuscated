'use strict';const a16_0x310f0a=a16_0x4fcf;(function(_0x4005ef,_0x5f527b){const _0x3b6502=a16_0x4fcf,_0x3235ea=_0x4005ef();while(!![]){try{const _0x3ac07e=parseInt(_0x3b6502(0x151))/0x1*(-parseInt(_0x3b6502(0x15f))/0x2)+parseInt(_0x3b6502(0x14f))/0x3*(parseInt(_0x3b6502(0x160))/0x4)+-parseInt(_0x3b6502(0x157))/0x5+parseInt(_0x3b6502(0x164))/0x6*(parseInt(_0x3b6502(0x154))/0x7)+-parseInt(_0x3b6502(0x155))/0x8*(parseInt(_0x3b6502(0x14c))/0x9)+parseInt(_0x3b6502(0x144))/0xa+-parseInt(_0x3b6502(0x152))/0xb*(-parseInt(_0x3b6502(0x158))/0xc);if(_0x3ac07e===_0x5f527b)break;else _0x3235ea['push'](_0x3235ea['shift']());}catch(_0x50d95e){_0x3235ea['push'](_0x3235ea['shift']());}}}(a16_0x375a,0x40051));var __importDefault=this&&this['__importDefault']||function(_0x2ed22e){return _0x2ed22e&&_0x2ed22e['__esModule']?_0x2ed22e:{'default':_0x2ed22e};};Object['defineProperty'](exports,a16_0x310f0a(0x15c),{'value':!![]}),exports[a16_0x310f0a(0x15d)]=exports[a16_0x310f0a(0x161)]=exports[a16_0x310f0a(0x15a)]=exports[a16_0x310f0a(0x147)]=void 0x0;const jsonwebtoken_1=__importDefault(require('jsonwebtoken')),config_1=require(a16_0x310f0a(0x143)),tokenBlacklistService_1=require('../services/tokenBlacklistService'),authenticateToken=(_0x364604,_0x3d0bec,_0x3d2418)=>{const _0x382a6a=a16_0x310f0a,_0x1ef186=_0x364604[_0x382a6a(0x156)][_0x382a6a(0x142)],_0x1e367e=_0x1ef186&&_0x1ef186['split']('\x20')[0x1];if(!_0x1e367e)return _0x3d0bec[_0x382a6a(0x148)](0x191)[_0x382a6a(0x163)]({'success':![],'message':_0x382a6a(0x14a)});if(tokenBlacklistService_1['tokenBlacklistService']['isTokenBlacklisted'](_0x1e367e))return _0x3d0bec['status'](0x191)['json']({'success':![],'message':'Token\x20has\x20been\x20revoked'});jsonwebtoken_1[_0x382a6a(0x150)]['verify'](_0x1e367e,config_1[_0x382a6a(0x15b)]['jwt']['secret'],(_0x14a5bf,_0x178ba6)=>{const _0xbd7f60=_0x382a6a;if(_0x14a5bf)return _0x3d0bec[_0xbd7f60(0x148)](0x193)[_0xbd7f60(0x163)]({'success':![],'message':_0xbd7f60(0x15e)});_0x364604[_0xbd7f60(0x166)]=_0x178ba6,_0x364604[_0xbd7f60(0x153)]=_0x1e367e,_0x3d2418();});};function a16_0x4fcf(_0x57506e,_0x2b626b){const _0x375a84=a16_0x375a();return a16_0x4fcf=function(_0x4fcfeb,_0x58ab1f){_0x4fcfeb=_0x4fcfeb-0x141;let _0x8c559=_0x375a84[_0x4fcfeb];return _0x8c559;},a16_0x4fcf(_0x57506e,_0x2b626b);}exports[a16_0x310f0a(0x147)]=authenticateToken;const requireAdmin=(_0x4a01c7,_0xccd09a,_0x3c7204)=>{const _0x30c878=a16_0x310f0a;if(!_0x4a01c7[_0x30c878(0x166)]||_0x4a01c7[_0x30c878(0x166)][_0x30c878(0x145)]!==_0x30c878(0x14b))return _0xccd09a[_0x30c878(0x148)](0x193)[_0x30c878(0x163)]({'success':![],'message':_0x30c878(0x146)});_0x3c7204();};function a16_0x375a(){const _0x33372b=['16qmaFqy','requireShop','shop','json','46122VggdcD','../config/database','user','findUnique','authorization','../config/config','4463190iORLgd','role','Admin\x20access\x20required','authenticateToken','status','ACTIVE','Access\x20token\x20required','admin','2439tFLyiL','Error\x20checking\x20account\x20status:','SUSPENDED','126573nnInHP','default','2pGeaHS','22MRaeGt','token','350BWvHlO','13736iQxfCS','headers','1699175hQqTnG','3186060GmfOTx','Shop\x20access\x20required','requireAdmin','config','__esModule','requireActiveShop','Invalid\x20or\x20expired\x20token','463076PZRynU'];a16_0x375a=function(){return _0x33372b;};return a16_0x375a();}exports[a16_0x310f0a(0x15a)]=requireAdmin;const requireShop=(_0x5aaf0f,_0x1ad792,_0x257ed2)=>{const _0x51f790=a16_0x310f0a;if(!_0x5aaf0f[_0x51f790(0x166)]||_0x5aaf0f[_0x51f790(0x166)][_0x51f790(0x145)]!==_0x51f790(0x162))return _0x1ad792[_0x51f790(0x148)](0x193)[_0x51f790(0x163)]({'success':![],'message':_0x51f790(0x159)});_0x257ed2();};exports[a16_0x310f0a(0x161)]=requireShop;const requireActiveShop=async(_0x4495b6,_0x230829,_0x358a63)=>{const _0x454484=a16_0x310f0a;if(!_0x4495b6['user']||_0x4495b6[_0x454484(0x166)][_0x454484(0x145)]!==_0x454484(0x162))return _0x230829[_0x454484(0x148)](0x193)['json']({'success':![],'message':_0x454484(0x159)});try{const _0x36ce66=require(_0x454484(0x165))[_0x454484(0x150)],_0x12a6c9=await _0x36ce66[_0x454484(0x162)][_0x454484(0x141)]({'where':{'id':_0x4495b6[_0x454484(0x166)]['id']},'select':{'status':!![]}});if(!_0x12a6c9||_0x12a6c9[_0x454484(0x148)]!==_0x454484(0x149))return _0x230829[_0x454484(0x148)](0x193)[_0x454484(0x163)]({'success':![],'message':'Account\x20is\x20suspended\x20or\x20inactive.\x20Contact\x20administrator\x20to\x20activate\x20your\x20account.','suspended':_0x12a6c9?.[_0x454484(0x148)]===_0x454484(0x14e)});_0x358a63();}catch(_0x56eef6){return console['error'](_0x454484(0x14d),_0x56eef6),_0x230829[_0x454484(0x148)](0x1f4)['json']({'success':![],'message':'Error\x20checking\x20account\x20status'});}};exports[a16_0x310f0a(0x15d)]=requireActiveShop;