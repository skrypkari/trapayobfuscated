'use strict';const a16_0x172769=a16_0x463a;(function(_0x2850f2,_0x1a0aa1){const _0x20f5d8=a16_0x463a,_0x338b30=_0x2850f2();while(!![]){try{const _0x1464a0=parseInt(_0x20f5d8(0xc6))/0x1*(-parseInt(_0x20f5d8(0xde))/0x2)+-parseInt(_0x20f5d8(0xca))/0x3*(parseInt(_0x20f5d8(0xd6))/0x4)+-parseInt(_0x20f5d8(0xdd))/0x5*(-parseInt(_0x20f5d8(0xdf))/0x6)+parseInt(_0x20f5d8(0xcf))/0x7+-parseInt(_0x20f5d8(0xc1))/0x8*(-parseInt(_0x20f5d8(0xe5))/0x9)+parseInt(_0x20f5d8(0xc4))/0xa+parseInt(_0x20f5d8(0xd3))/0xb;if(_0x1464a0===_0x1a0aa1)break;else _0x338b30['push'](_0x338b30['shift']());}catch(_0xf889b8){_0x338b30['push'](_0x338b30['shift']());}}}(a16_0x5ac3,0x3f03e));function a16_0x463a(_0x1f9b9b,_0x46fec1){const _0x5ac352=a16_0x5ac3();return a16_0x463a=function(_0x463a39,_0x31aca5){_0x463a39=_0x463a39-0xc1;let _0x156d16=_0x5ac352[_0x463a39];return _0x156d16;},a16_0x463a(_0x1f9b9b,_0x46fec1);}var __importDefault=this&&this[a16_0x172769(0xd0)]||function(_0x5be8d8){const _0x5518d8=a16_0x172769;return _0x5be8d8&&_0x5be8d8[_0x5518d8(0xd9)]?_0x5be8d8:{'default':_0x5be8d8};};Object['defineProperty'](exports,a16_0x172769(0xd9),{'value':!![]}),exports[a16_0x172769(0xc3)]=exports['requireShop']=exports[a16_0x172769(0xe7)]=exports[a16_0x172769(0xd4)]=void 0x0;function a16_0x5ac3(){const _0x245b5e=['54NNQyuh','authorization','Error\x20checking\x20account\x20status','status','Invalid\x20or\x20expired\x20token','Shop\x20access\x20required','38187KZLyZx','verify','requireAdmin','shop','176aNRXUa','../config/config','requireActiveShop','2522900nWLWwR','jwt','71PgfZnt','headers','jsonwebtoken','Token\x20has\x20been\x20revoked','111RZSckz','user','default','Error\x20checking\x20account\x20status:','../config/database','617050mnLybg','__importDefault','config','../services/tokenBlacklistService','3093805fDkrSc','authenticateToken','role','25116cvgQPG','isTokenBlacklisted','json','__esModule','error','SUSPENDED','tokenBlacklistService','60370nanSaV','9388tTNvZw'];a16_0x5ac3=function(){return _0x245b5e;};return a16_0x5ac3();}const jsonwebtoken_1=__importDefault(require(a16_0x172769(0xc8))),config_1=require(a16_0x172769(0xc2)),tokenBlacklistService_1=require(a16_0x172769(0xd2)),authenticateToken=(_0x572f6a,_0x54aeaf,_0x2268a5)=>{const _0x863346=a16_0x172769,_0x2e7fa8=_0x572f6a[_0x863346(0xc7)][_0x863346(0xe0)],_0xbe6704=_0x2e7fa8&&_0x2e7fa8['split']('\x20')[0x1];if(!_0xbe6704)return _0x54aeaf[_0x863346(0xe2)](0x191)[_0x863346(0xd8)]({'success':![],'message':'Access\x20token\x20required'});if(tokenBlacklistService_1[_0x863346(0xdc)][_0x863346(0xd7)](_0xbe6704))return _0x54aeaf[_0x863346(0xe2)](0x191)[_0x863346(0xd8)]({'success':![],'message':_0x863346(0xc9)});jsonwebtoken_1[_0x863346(0xcc)][_0x863346(0xe6)](_0xbe6704,config_1[_0x863346(0xd1)][_0x863346(0xc5)]['secret'],(_0x5e4547,_0x452212)=>{const _0x1aae6c=_0x863346;if(_0x5e4547)return _0x54aeaf['status'](0x193)[_0x1aae6c(0xd8)]({'success':![],'message':_0x1aae6c(0xe3)});_0x572f6a[_0x1aae6c(0xcb)]=_0x452212,_0x572f6a['token']=_0xbe6704,_0x2268a5();});};exports[a16_0x172769(0xd4)]=authenticateToken;const requireAdmin=(_0x477fc5,_0x40235e,_0x2f83c9)=>{const _0x3811da=a16_0x172769;if(!_0x477fc5[_0x3811da(0xcb)]||_0x477fc5[_0x3811da(0xcb)]['role']!=='admin')return _0x40235e[_0x3811da(0xe2)](0x193)[_0x3811da(0xd8)]({'success':![],'message':'Admin\x20access\x20required'});_0x2f83c9();};exports[a16_0x172769(0xe7)]=requireAdmin;const requireShop=(_0x438784,_0x52ff7b,_0x752350)=>{const _0x51d250=a16_0x172769;if(!_0x438784[_0x51d250(0xcb)]||_0x438784['user'][_0x51d250(0xd5)]!==_0x51d250(0xe8))return _0x52ff7b[_0x51d250(0xe2)](0x193)[_0x51d250(0xd8)]({'success':![],'message':_0x51d250(0xe4)});_0x752350();};exports['requireShop']=requireShop;const requireActiveShop=async(_0x32278b,_0x31db08,_0x59a52d)=>{const _0x5acb79=a16_0x172769;if(!_0x32278b[_0x5acb79(0xcb)]||_0x32278b['user'][_0x5acb79(0xd5)]!=='shop')return _0x31db08[_0x5acb79(0xe2)](0x193)[_0x5acb79(0xd8)]({'success':![],'message':_0x5acb79(0xe4)});try{const _0x40cb1e=require(_0x5acb79(0xce))['default'],_0xcab546=await _0x40cb1e['shop']['findUnique']({'where':{'id':_0x32278b[_0x5acb79(0xcb)]['id']},'select':{'status':!![]}});if(!_0xcab546||_0xcab546[_0x5acb79(0xe2)]!=='ACTIVE')return _0x31db08[_0x5acb79(0xe2)](0x193)[_0x5acb79(0xd8)]({'success':![],'message':'Account\x20is\x20suspended\x20or\x20inactive.\x20Contact\x20administrator\x20to\x20activate\x20your\x20account.','suspended':_0xcab546?.[_0x5acb79(0xe2)]===_0x5acb79(0xdb)});_0x59a52d();}catch(_0x2c37e7){return console[_0x5acb79(0xda)](_0x5acb79(0xcd),_0x2c37e7),_0x31db08[_0x5acb79(0xe2)](0x1f4)[_0x5acb79(0xd8)]({'success':![],'message':_0x5acb79(0xe1)});}};exports[a16_0x172769(0xc3)]=requireActiveShop;