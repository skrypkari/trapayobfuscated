'use strict';const a16_0x120dcb=a16_0x107e;(function(_0xeda972,_0x2b31c8){const _0x37197f=a16_0x107e,_0x4947af=_0xeda972();while(!![]){try{const _0x217016=parseInt(_0x37197f(0xbd))/0x1*(-parseInt(_0x37197f(0xb5))/0x2)+parseInt(_0x37197f(0xa6))/0x3*(-parseInt(_0x37197f(0xa3))/0x4)+-parseInt(_0x37197f(0xbb))/0x5+-parseInt(_0x37197f(0xca))/0x6*(-parseInt(_0x37197f(0xa8))/0x7)+parseInt(_0x37197f(0xc5))/0x8*(-parseInt(_0x37197f(0xc7))/0x9)+-parseInt(_0x37197f(0xc4))/0xa+parseInt(_0x37197f(0xb8))/0xb;if(_0x217016===_0x2b31c8)break;else _0x4947af['push'](_0x4947af['shift']());}catch(_0x4b804c){_0x4947af['push'](_0x4947af['shift']());}}}(a16_0xe6e7,0x2dca3));function a16_0x107e(_0xb935c8,_0x3e33e6){const _0xe6e788=a16_0xe6e7();return a16_0x107e=function(_0x107eb1,_0x22754b){_0x107eb1=_0x107eb1-0xa3;let _0x55d9ae=_0xe6e788[_0x107eb1];return _0x55d9ae;},a16_0x107e(_0xb935c8,_0x3e33e6);}var __importDefault=this&&this['__importDefault']||function(_0x169987){const _0x564b4d=a16_0x107e;return _0x169987&&_0x169987[_0x564b4d(0xcb)]?_0x169987:{'default':_0x169987};};Object[a16_0x120dcb(0xab)](exports,'__esModule',{'value':!![]}),exports[a16_0x120dcb(0xc6)]=exports[a16_0x120dcb(0xad)]=exports[a16_0x120dcb(0xc0)]=exports[a16_0x120dcb(0xac)]=void 0x0;const jsonwebtoken_1=__importDefault(require('jsonwebtoken')),config_1=require(a16_0x120dcb(0xc2)),tokenBlacklistService_1=require(a16_0x120dcb(0xa5)),authenticateToken=(_0x2a738a,_0x4c8497,_0x2fbd2b)=>{const _0x474fbb=a16_0x120dcb,_0x16cc7d=_0x2a738a[_0x474fbb(0xb1)]['authorization'],_0x1e502f=_0x16cc7d&&_0x16cc7d[_0x474fbb(0xb0)]('\x20')[0x1];if(!_0x1e502f)return _0x4c8497['status'](0x191)['json']({'success':![],'message':_0x474fbb(0xb4)});if(tokenBlacklistService_1['tokenBlacklistService'][_0x474fbb(0xba)](_0x1e502f))return _0x4c8497['status'](0x191)[_0x474fbb(0xbe)]({'success':![],'message':_0x474fbb(0xc3)});jsonwebtoken_1[_0x474fbb(0xb7)][_0x474fbb(0xa4)](_0x1e502f,config_1['config'][_0x474fbb(0xae)][_0x474fbb(0xa7)],(_0x184207,_0x171eaa)=>{const _0x156cd5=_0x474fbb;if(_0x184207)return _0x4c8497['status'](0x193)[_0x156cd5(0xbe)]({'success':![],'message':_0x156cd5(0xb3)});_0x2a738a[_0x156cd5(0xc8)]=_0x171eaa,_0x2a738a['token']=_0x1e502f,_0x2fbd2b();});};exports['authenticateToken']=authenticateToken;function a16_0xe6e7(){const _0x54a618=['Token\x20has\x20been\x20revoked','3692690vzZGNu','32OldGQD','requireActiveShop','314802DvXfCK','user','../config/database','126DhUkGk','__esModule','Shop\x20access\x20required','Error\x20checking\x20account\x20status:','549104BAozwX','verify','../services/tokenBlacklistService','3ubKxjx','secret','4375IaOWTY','findUnique','Admin\x20access\x20required','defineProperty','authenticateToken','requireShop','jwt','role','split','headers','SUSPENDED','Invalid\x20or\x20expired\x20token','Access\x20token\x20required','17026MLNISF','ACTIVE','default','13569710oUkQMl','shop','isTokenBlacklisted','744100Gnkeja','Account\x20is\x20suspended\x20or\x20inactive.\x20Contact\x20administrator\x20to\x20activate\x20your\x20account.','31kLUkHW','json','status','requireAdmin','error','../config/config'];a16_0xe6e7=function(){return _0x54a618;};return a16_0xe6e7();}const requireAdmin=(_0x1fa3c6,_0x871c4b,_0x3ff82d)=>{const _0xf42fa=a16_0x120dcb;if(!_0x1fa3c6[_0xf42fa(0xc8)]||_0x1fa3c6[_0xf42fa(0xc8)]['role']!=='admin')return _0x871c4b[_0xf42fa(0xbf)](0x193)[_0xf42fa(0xbe)]({'success':![],'message':_0xf42fa(0xaa)});_0x3ff82d();};exports[a16_0x120dcb(0xc0)]=requireAdmin;const requireShop=(_0x2034e8,_0x6dcd10,_0x26e331)=>{const _0xd30f4=a16_0x120dcb;if(!_0x2034e8[_0xd30f4(0xc8)]||_0x2034e8[_0xd30f4(0xc8)][_0xd30f4(0xaf)]!=='shop')return _0x6dcd10[_0xd30f4(0xbf)](0x193)[_0xd30f4(0xbe)]({'success':![],'message':_0xd30f4(0xcc)});_0x26e331();};exports[a16_0x120dcb(0xad)]=requireShop;const requireActiveShop=async(_0x59f5ff,_0x10c788,_0x10256f)=>{const _0x3ec0e6=a16_0x120dcb;if(!_0x59f5ff[_0x3ec0e6(0xc8)]||_0x59f5ff[_0x3ec0e6(0xc8)][_0x3ec0e6(0xaf)]!==_0x3ec0e6(0xb9))return _0x10c788[_0x3ec0e6(0xbf)](0x193)['json']({'success':![],'message':_0x3ec0e6(0xcc)});try{const _0x4bce5d=require(_0x3ec0e6(0xc9))[_0x3ec0e6(0xb7)],_0x44d754=await _0x4bce5d[_0x3ec0e6(0xb9)][_0x3ec0e6(0xa9)]({'where':{'id':_0x59f5ff['user']['id']},'select':{'status':!![]}});if(!_0x44d754||_0x44d754[_0x3ec0e6(0xbf)]!==_0x3ec0e6(0xb6))return _0x10c788['status'](0x193)[_0x3ec0e6(0xbe)]({'success':![],'message':_0x3ec0e6(0xbc),'suspended':_0x44d754?.[_0x3ec0e6(0xbf)]===_0x3ec0e6(0xb2)});_0x10256f();}catch(_0x35d44b){return console[_0x3ec0e6(0xc1)](_0x3ec0e6(0xcd),_0x35d44b),_0x10c788[_0x3ec0e6(0xbf)](0x1f4)[_0x3ec0e6(0xbe)]({'success':![],'message':'Error\x20checking\x20account\x20status'});}};exports[a16_0x120dcb(0xc6)]=requireActiveShop;