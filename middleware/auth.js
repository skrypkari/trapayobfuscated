'use strict';function a24_0x5156(_0x4bc723,_0x3beba4){_0x4bc723=_0x4bc723-0x170;const _0x359eda=a24_0x359e();let _0x5156a4=_0x359eda[_0x4bc723];return _0x5156a4;}const a24_0x1db3e5=a24_0x5156;(function(_0x36edaf,_0x2fa9ea){const _0x3c49e2=a24_0x5156,_0x59699e=_0x36edaf();while(!![]){try{const _0x4210b5=-parseInt(_0x3c49e2(0x18c))/0x1+-parseInt(_0x3c49e2(0x178))/0x2+parseInt(_0x3c49e2(0x170))/0x3+parseInt(_0x3c49e2(0x176))/0x4*(parseInt(_0x3c49e2(0x187))/0x5)+parseInt(_0x3c49e2(0x192))/0x6+-parseInt(_0x3c49e2(0x180))/0x7+parseInt(_0x3c49e2(0x17d))/0x8;if(_0x4210b5===_0x2fa9ea)break;else _0x59699e['push'](_0x59699e['shift']());}catch(_0xbf96ed){_0x59699e['push'](_0x59699e['shift']());}}}(a24_0x359e,0x900da));var __importDefault=this&&this[a24_0x1db3e5(0x190)]||function(_0x4b1d92){const _0x464deb=a24_0x1db3e5;return _0x4b1d92&&_0x4b1d92[_0x464deb(0x186)]?_0x4b1d92:{'default':_0x4b1d92};};Object['defineProperty'](exports,'__esModule',{'value':!![]}),exports[a24_0x1db3e5(0x175)]=exports[a24_0x1db3e5(0x18b)]=exports[a24_0x1db3e5(0x18e)]=exports['authenticateToken']=void 0x0;const jsonwebtoken_1=__importDefault(require('jsonwebtoken')),config_1=require(a24_0x1db3e5(0x18d)),tokenBlacklistService_1=require(a24_0x1db3e5(0x173)),authenticateToken=(_0x1f1345,_0x23cef5,_0x17f788)=>{const _0x744d56=a24_0x1db3e5,_0x3852cc=_0x1f1345['headers'][_0x744d56(0x179)],_0x418a1d=_0x3852cc&&_0x3852cc[_0x744d56(0x181)]('\x20')[0x1];if(!_0x418a1d)return _0x23cef5[_0x744d56(0x17a)](0x191)['json']({'success':![],'message':_0x744d56(0x18a)});if(tokenBlacklistService_1['tokenBlacklistService']['isTokenBlacklisted'](_0x418a1d))return _0x23cef5['status'](0x191)[_0x744d56(0x185)]({'success':![],'message':_0x744d56(0x177)});jsonwebtoken_1['default'][_0x744d56(0x17b)](_0x418a1d,config_1['config'][_0x744d56(0x195)][_0x744d56(0x17f)],(_0x5c3fb6,_0x4b9818)=>{const _0xcc19cd=_0x744d56;if(_0x5c3fb6)return _0x23cef5[_0xcc19cd(0x17a)](0x193)[_0xcc19cd(0x185)]({'success':![],'message':_0xcc19cd(0x174)});_0x1f1345[_0xcc19cd(0x184)]=_0x4b9818,_0x1f1345[_0xcc19cd(0x182)]=_0x418a1d,_0x17f788();});};exports[a24_0x1db3e5(0x18f)]=authenticateToken;function a24_0x359e(){const _0x2eae16=['../config/config','requireAdmin','authenticateToken','__importDefault','role','2094858LOwYpl','Shop\x20access\x20required','ACTIVE','jwt','2357109UrUeUX','admin','Error\x20checking\x20account\x20status:','../services/tokenBlacklistService','Invalid\x20or\x20expired\x20token','requireActiveShop','4WgwNfz','Token\x20has\x20been\x20revoked','2353428RCdkBN','authorization','status','verify','Error\x20checking\x20account\x20status','10610056ZgAKGT','shop','secret','4845890XUfbwq','split','token','findUnique','user','json','__esModule','3910535OEBPPT','Admin\x20access\x20required','Account\x20is\x20suspended\x20or\x20inactive.\x20Contact\x20administrator\x20to\x20activate\x20your\x20account.','Access\x20token\x20required','requireShop','784184GjfNxM'];a24_0x359e=function(){return _0x2eae16;};return a24_0x359e();}const requireAdmin=(_0x43c7cf,_0x26b5de,_0x56c3a8)=>{const _0x2bc075=a24_0x1db3e5;if(!_0x43c7cf[_0x2bc075(0x184)]||_0x43c7cf[_0x2bc075(0x184)]['role']!==_0x2bc075(0x171))return _0x26b5de[_0x2bc075(0x17a)](0x193)['json']({'success':![],'message':_0x2bc075(0x188)});_0x56c3a8();};exports[a24_0x1db3e5(0x18e)]=requireAdmin;const requireShop=(_0x1cb48c,_0x279d8f,_0x5ccfdd)=>{const _0x4e603b=a24_0x1db3e5;if(!_0x1cb48c[_0x4e603b(0x184)]||_0x1cb48c[_0x4e603b(0x184)]['role']!=='shop')return _0x279d8f[_0x4e603b(0x17a)](0x193)[_0x4e603b(0x185)]({'success':![],'message':_0x4e603b(0x193)});_0x5ccfdd();};exports[a24_0x1db3e5(0x18b)]=requireShop;const requireActiveShop=async(_0x23afab,_0x25fe56,_0x41dc88)=>{const _0x4cbd1b=a24_0x1db3e5;if(!_0x23afab[_0x4cbd1b(0x184)]||_0x23afab[_0x4cbd1b(0x184)][_0x4cbd1b(0x191)]!==_0x4cbd1b(0x17e))return _0x25fe56[_0x4cbd1b(0x17a)](0x193)[_0x4cbd1b(0x185)]({'success':![],'message':_0x4cbd1b(0x193)});try{const _0x31f501=require('../config/database')['default'],_0x5cf8ee=await _0x31f501[_0x4cbd1b(0x17e)][_0x4cbd1b(0x183)]({'where':{'id':_0x23afab[_0x4cbd1b(0x184)]['id']},'select':{'status':!![]}});if(!_0x5cf8ee||_0x5cf8ee[_0x4cbd1b(0x17a)]!==_0x4cbd1b(0x194))return _0x25fe56['status'](0x193)['json']({'success':![],'message':_0x4cbd1b(0x189),'suspended':_0x5cf8ee?.[_0x4cbd1b(0x17a)]==='SUSPENDED'});_0x41dc88();}catch(_0x113bf5){return console['error'](_0x4cbd1b(0x172),_0x113bf5),_0x25fe56['status'](0x1f4)['json']({'success':![],'message':_0x4cbd1b(0x17c)});}};exports[a24_0x1db3e5(0x175)]=requireActiveShop;