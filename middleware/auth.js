'use strict';const a18_0x2bb436=a18_0x54ce;(function(_0x45c796,_0x4550b5){const _0x25e733=a18_0x54ce,_0x10e43e=_0x45c796();while(!![]){try{const _0x3e0c52=parseInt(_0x25e733(0x111))/0x1+-parseInt(_0x25e733(0xfb))/0x2*(parseInt(_0x25e733(0xf3))/0x3)+parseInt(_0x25e733(0xef))/0x4+-parseInt(_0x25e733(0xfd))/0x5*(parseInt(_0x25e733(0x113))/0x6)+parseInt(_0x25e733(0x101))/0x7*(-parseInt(_0x25e733(0x104))/0x8)+-parseInt(_0x25e733(0x110))/0x9+parseInt(_0x25e733(0x107))/0xa;if(_0x3e0c52===_0x4550b5)break;else _0x10e43e['push'](_0x10e43e['shift']());}catch(_0x5e4179){_0x10e43e['push'](_0x10e43e['shift']());}}}(a18_0x1105,0x35f13));function a18_0x54ce(_0x292c9c,_0x1bc396){const _0x110518=a18_0x1105();return a18_0x54ce=function(_0x54ce85,_0x133e2b){_0x54ce85=_0x54ce85-0xef;let _0x43f37b=_0x110518[_0x54ce85];return _0x43f37b;},a18_0x54ce(_0x292c9c,_0x1bc396);}var __importDefault=this&&this[a18_0x2bb436(0xf8)]||function(_0x29af84){const _0x23071a=a18_0x2bb436;return _0x29af84&&_0x29af84[_0x23071a(0xf0)]?_0x29af84:{'default':_0x29af84};};Object[a18_0x2bb436(0xfc)](exports,a18_0x2bb436(0xf0),{'value':!![]}),exports[a18_0x2bb436(0xf9)]=exports['requireShop']=exports[a18_0x2bb436(0x106)]=exports['authenticateToken']=void 0x0;const jsonwebtoken_1=__importDefault(require(a18_0x2bb436(0x114))),config_1=require(a18_0x2bb436(0x10a)),tokenBlacklistService_1=require('../services/tokenBlacklistService'),authenticateToken=(_0x509274,_0x504121,_0x199ca6)=>{const _0x2c6247=a18_0x2bb436,_0x562345=_0x509274[_0x2c6247(0x112)]['authorization'],_0x2c81f4=_0x562345&&_0x562345[_0x2c6247(0x109)]('\x20')[0x1];if(!_0x2c81f4)return _0x504121['status'](0x191)['json']({'success':![],'message':'Access\x20token\x20required'});if(tokenBlacklistService_1[_0x2c6247(0xf2)][_0x2c6247(0x10e)](_0x2c81f4))return _0x504121[_0x2c6247(0xf1)](0x191)[_0x2c6247(0xf5)]({'success':![],'message':_0x2c6247(0x102)});jsonwebtoken_1['default'][_0x2c6247(0xff)](_0x2c81f4,config_1['config'][_0x2c6247(0xf4)]['secret'],(_0x1e9a87,_0x39ac86)=>{const _0x453c5f=_0x2c6247;if(_0x1e9a87)return _0x504121['status'](0x193)[_0x453c5f(0xf5)]({'success':![],'message':_0x453c5f(0xfe)});_0x509274[_0x453c5f(0x10f)]=_0x39ac86,_0x509274['token']=_0x2c81f4,_0x199ca6();});};exports[a18_0x2bb436(0x103)]=authenticateToken;const requireAdmin=(_0x3169f0,_0xc8aa99,_0x4cd01e)=>{const _0x2f0233=a18_0x2bb436;if(!_0x3169f0[_0x2f0233(0x10f)]||_0x3169f0[_0x2f0233(0x10f)]['role']!==_0x2f0233(0xf6))return _0xc8aa99[_0x2f0233(0xf1)](0x193)['json']({'success':![],'message':'Admin\x20access\x20required'});_0x4cd01e();};function a18_0x1105(){const _0x2b0b8e=['verify','error','28hQwMhC','Token\x20has\x20been\x20revoked','authenticateToken','687320TOMyxp','SUSPENDED','requireAdmin','3243510lFQydU','Error\x20checking\x20account\x20status','split','../config/config','Error\x20checking\x20account\x20status:','shop','Shop\x20access\x20required','isTokenBlacklisted','user','1538451OUihcc','139471EkxHxL','headers','6SICCRM','jsonwebtoken','1409712YxibtF','__esModule','status','tokenBlacklistService','7947mUBLrP','jwt','json','admin','role','__importDefault','requireActiveShop','findUnique','2OQQRdo','defineProperty','390275MskeXQ','Invalid\x20or\x20expired\x20token'];a18_0x1105=function(){return _0x2b0b8e;};return a18_0x1105();}exports[a18_0x2bb436(0x106)]=requireAdmin;const requireShop=(_0x342506,_0x23d3da,_0x18868b)=>{const _0xcfcc74=a18_0x2bb436;if(!_0x342506[_0xcfcc74(0x10f)]||_0x342506[_0xcfcc74(0x10f)][_0xcfcc74(0xf7)]!==_0xcfcc74(0x10c))return _0x23d3da[_0xcfcc74(0xf1)](0x193)[_0xcfcc74(0xf5)]({'success':![],'message':_0xcfcc74(0x10d)});_0x18868b();};exports['requireShop']=requireShop;const requireActiveShop=async(_0x3429a9,_0x56dce5,_0x41c1cd)=>{const _0xd0c1ba=a18_0x2bb436;if(!_0x3429a9['user']||_0x3429a9[_0xd0c1ba(0x10f)][_0xd0c1ba(0xf7)]!=='shop')return _0x56dce5[_0xd0c1ba(0xf1)](0x193)['json']({'success':![],'message':'Shop\x20access\x20required'});try{const _0x1069b6=require('../config/database')['default'],_0x3946b6=await _0x1069b6[_0xd0c1ba(0x10c)][_0xd0c1ba(0xfa)]({'where':{'id':_0x3429a9['user']['id']},'select':{'status':!![]}});if(!_0x3946b6||_0x3946b6['status']!=='ACTIVE')return _0x56dce5['status'](0x193)['json']({'success':![],'message':'Account\x20is\x20suspended\x20or\x20inactive.\x20Contact\x20administrator\x20to\x20activate\x20your\x20account.','suspended':_0x3946b6?.[_0xd0c1ba(0xf1)]===_0xd0c1ba(0x105)});_0x41c1cd();}catch(_0x2d4087){return console[_0xd0c1ba(0x100)](_0xd0c1ba(0x10b),_0x2d4087),_0x56dce5[_0xd0c1ba(0xf1)](0x1f4)[_0xd0c1ba(0xf5)]({'success':![],'message':_0xd0c1ba(0x108)});}};exports[a18_0x2bb436(0xf9)]=requireActiveShop;