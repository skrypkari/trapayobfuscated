'use strict';const a16_0x3b2c85=a16_0x17ff;(function(_0x5a5c20,_0x1ffac8){const _0x5dd151=a16_0x17ff,_0x30ce41=_0x5a5c20();while(!![]){try{const _0x21365d=-parseInt(_0x5dd151(0xa8))/0x1+parseInt(_0x5dd151(0xa0))/0x2+-parseInt(_0x5dd151(0x9a))/0x3*(parseInt(_0x5dd151(0xa5))/0x4)+-parseInt(_0x5dd151(0xa9))/0x5*(parseInt(_0x5dd151(0x86))/0x6)+parseInt(_0x5dd151(0xac))/0x7*(-parseInt(_0x5dd151(0x99))/0x8)+-parseInt(_0x5dd151(0x9f))/0x9+-parseInt(_0x5dd151(0x98))/0xa*(-parseInt(_0x5dd151(0x8d))/0xb);if(_0x21365d===_0x1ffac8)break;else _0x30ce41['push'](_0x30ce41['shift']());}catch(_0xd36754){_0x30ce41['push'](_0x30ce41['shift']());}}}(a16_0x1101,0x6ddfd));var __importDefault=this&&this['__importDefault']||function(_0x2cd77d){const _0x2ef9a4=a16_0x17ff;return _0x2cd77d&&_0x2cd77d[_0x2ef9a4(0x92)]?_0x2cd77d:{'default':_0x2cd77d};};Object[a16_0x3b2c85(0x9d)](exports,a16_0x3b2c85(0x92),{'value':!![]}),exports[a16_0x3b2c85(0x9e)]=exports[a16_0x3b2c85(0x88)]=exports[a16_0x3b2c85(0x8e)]=exports['authenticateToken']=void 0x0;function a16_0x1101(){const _0x3f3550=['defineProperty','requireActiveShop','3507894VBmyne','1764128yyBkwy','../config/database','Account\x20is\x20suspended\x20or\x20inactive.\x20Contact\x20administrator\x20to\x20activate\x20your\x20account.','authenticateToken','shop','3170464uyYHkt','ACTIVE','findUnique','330600gRxNXX','5UCOVrJ','error','role','189742TFlavV','Admin\x20access\x20required','Error\x20checking\x20account\x20status:','json','2654292xilHZZ','../config/config','requireShop','verify','headers','config','jsonwebtoken','17054961JmrBRw','requireAdmin','default','secret','tokenBlacklistService','__esModule','Access\x20token\x20required','status','Error\x20checking\x20account\x20status','../services/tokenBlacklistService','user','10iPJjec','8aHISZA','3QBQnEq','split','Shop\x20access\x20required'];a16_0x1101=function(){return _0x3f3550;};return a16_0x1101();}const jsonwebtoken_1=__importDefault(require(a16_0x3b2c85(0x8c))),config_1=require(a16_0x3b2c85(0x87)),tokenBlacklistService_1=require(a16_0x3b2c85(0x96)),authenticateToken=(_0x25a2cb,_0x58e831,_0x1e7196)=>{const _0x30345c=a16_0x3b2c85,_0x49cf18=_0x25a2cb[_0x30345c(0x8a)]['authorization'],_0x15ae03=_0x49cf18&&_0x49cf18[_0x30345c(0x9b)]('\x20')[0x1];if(!_0x15ae03)return _0x58e831[_0x30345c(0x94)](0x191)['json']({'success':![],'message':_0x30345c(0x93)});if(tokenBlacklistService_1[_0x30345c(0x91)]['isTokenBlacklisted'](_0x15ae03))return _0x58e831[_0x30345c(0x94)](0x191)[_0x30345c(0x85)]({'success':![],'message':'Token\x20has\x20been\x20revoked'});jsonwebtoken_1[_0x30345c(0x8f)][_0x30345c(0x89)](_0x15ae03,config_1[_0x30345c(0x8b)]['jwt'][_0x30345c(0x90)],(_0x357053,_0x4b9c22)=>{const _0x529869=_0x30345c;if(_0x357053)return _0x58e831[_0x529869(0x94)](0x193)['json']({'success':![],'message':'Invalid\x20or\x20expired\x20token'});_0x25a2cb['user']=_0x4b9c22,_0x25a2cb['token']=_0x15ae03,_0x1e7196();});};exports[a16_0x3b2c85(0xa3)]=authenticateToken;const requireAdmin=(_0x510b8b,_0x5e3aed,_0x2e1731)=>{const _0x38ffc0=a16_0x3b2c85;if(!_0x510b8b[_0x38ffc0(0x97)]||_0x510b8b[_0x38ffc0(0x97)][_0x38ffc0(0xab)]!=='admin')return _0x5e3aed[_0x38ffc0(0x94)](0x193)[_0x38ffc0(0x85)]({'success':![],'message':_0x38ffc0(0xad)});_0x2e1731();};exports[a16_0x3b2c85(0x8e)]=requireAdmin;function a16_0x17ff(_0x3f338d,_0x489d9f){const _0x11019b=a16_0x1101();return a16_0x17ff=function(_0x17ffa0,_0x58b680){_0x17ffa0=_0x17ffa0-0x84;let _0x5048b5=_0x11019b[_0x17ffa0];return _0x5048b5;},a16_0x17ff(_0x3f338d,_0x489d9f);}const requireShop=(_0x1231a6,_0x4a8324,_0x1f8d9e)=>{const _0x553631=a16_0x3b2c85;if(!_0x1231a6['user']||_0x1231a6['user'][_0x553631(0xab)]!=='shop')return _0x4a8324[_0x553631(0x94)](0x193)[_0x553631(0x85)]({'success':![],'message':_0x553631(0x9c)});_0x1f8d9e();};exports[a16_0x3b2c85(0x88)]=requireShop;const requireActiveShop=async(_0x56ca16,_0x2cb15d,_0x150805)=>{const _0x3f5885=a16_0x3b2c85;if(!_0x56ca16[_0x3f5885(0x97)]||_0x56ca16['user'][_0x3f5885(0xab)]!==_0x3f5885(0xa4))return _0x2cb15d[_0x3f5885(0x94)](0x193)['json']({'success':![],'message':_0x3f5885(0x9c)});try{const _0x7f2a9=require(_0x3f5885(0xa1))['default'],_0xa930ba=await _0x7f2a9[_0x3f5885(0xa4)][_0x3f5885(0xa7)]({'where':{'id':_0x56ca16[_0x3f5885(0x97)]['id']},'select':{'status':!![]}});if(!_0xa930ba||_0xa930ba['status']!==_0x3f5885(0xa6))return _0x2cb15d[_0x3f5885(0x94)](0x193)['json']({'success':![],'message':_0x3f5885(0xa2),'suspended':_0xa930ba?.[_0x3f5885(0x94)]==='SUSPENDED'});_0x150805();}catch(_0x1e4aa2){return console[_0x3f5885(0xaa)](_0x3f5885(0x84),_0x1e4aa2),_0x2cb15d[_0x3f5885(0x94)](0x1f4)[_0x3f5885(0x85)]({'success':![],'message':_0x3f5885(0x95)});}};exports[a16_0x3b2c85(0x9e)]=requireActiveShop;