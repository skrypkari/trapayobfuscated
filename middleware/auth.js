'use strict';const a21_0x507216=a21_0x3996;(function(_0x58a873,_0xc15204){const _0x15cc3e=a21_0x3996,_0x5ee7fc=_0x58a873();while(!![]){try{const _0x539d0f=-parseInt(_0x15cc3e(0x1e9))/0x1+parseInt(_0x15cc3e(0x1fc))/0x2+parseInt(_0x15cc3e(0x20b))/0x3*(parseInt(_0x15cc3e(0x1e7))/0x4)+parseInt(_0x15cc3e(0x1f0))/0x5+-parseInt(_0x15cc3e(0x202))/0x6*(parseInt(_0x15cc3e(0x1f7))/0x7)+parseInt(_0x15cc3e(0x1f1))/0x8*(parseInt(_0x15cc3e(0x1f2))/0x9)+-parseInt(_0x15cc3e(0x1e6))/0xa;if(_0x539d0f===_0xc15204)break;else _0x5ee7fc['push'](_0x5ee7fc['shift']());}catch(_0x29bb82){_0x5ee7fc['push'](_0x5ee7fc['shift']());}}}(a21_0x3bc7,0xb6e17));var __importDefault=this&&this['__importDefault']||function(_0x5bd16f){const _0x2e4ad3=a21_0x3996;return _0x5bd16f&&_0x5bd16f[_0x2e4ad3(0x20c)]?_0x5bd16f:{'default':_0x5bd16f};};Object['defineProperty'](exports,a21_0x507216(0x20c),{'value':!![]}),exports[a21_0x507216(0x1f9)]=exports['requireShop']=exports['requireAdmin']=exports['authenticateToken']=void 0x0;function a21_0x3996(_0x590b42,_0x1fbf68){_0x590b42=_0x590b42-0x1e5;const _0x3bc725=a21_0x3bc7();let _0x399673=_0x3bc725[_0x590b42];return _0x399673;}const jsonwebtoken_1=__importDefault(require('jsonwebtoken')),config_1=require('../config/config'),tokenBlacklistService_1=require(a21_0x507216(0x204)),authenticateToken=(_0x5bd071,_0x2fd773,_0x54e38b)=>{const _0x120b41=a21_0x507216,_0x4e128d=_0x5bd071[_0x120b41(0x1ed)][_0x120b41(0x1e8)],_0x1a66b5=_0x4e128d&&_0x4e128d[_0x120b41(0x206)]('\x20')[0x1];if(!_0x1a66b5)return _0x2fd773[_0x120b41(0x203)](0x191)['json']({'success':![],'message':_0x120b41(0x1ff)});if(tokenBlacklistService_1['tokenBlacklistService'][_0x120b41(0x209)](_0x1a66b5))return _0x2fd773[_0x120b41(0x203)](0x191)[_0x120b41(0x207)]({'success':![],'message':_0x120b41(0x205)});jsonwebtoken_1[_0x120b41(0x1ee)][_0x120b41(0x208)](_0x1a66b5,config_1[_0x120b41(0x1f3)]['jwt'][_0x120b41(0x1eb)],(_0x3233fc,_0x5d892c)=>{const _0x4ea725=_0x120b41;if(_0x3233fc)return _0x2fd773['status'](0x193)['json']({'success':![],'message':_0x4ea725(0x1fd)});_0x5bd071[_0x4ea725(0x1f8)]=_0x5d892c,_0x5bd071[_0x4ea725(0x1e5)]=_0x1a66b5,_0x54e38b();});};exports[a21_0x507216(0x1fb)]=authenticateToken;const requireAdmin=(_0x3a2f8c,_0x47fa0c,_0x3ea52d)=>{const _0xe8e8c7=a21_0x507216;if(!_0x3a2f8c[_0xe8e8c7(0x1f8)]||_0x3a2f8c['user'][_0xe8e8c7(0x1fa)]!==_0xe8e8c7(0x1ec))return _0x47fa0c[_0xe8e8c7(0x203)](0x193)[_0xe8e8c7(0x207)]({'success':![],'message':'Admin\x20access\x20required'});_0x3ea52d();};exports['requireAdmin']=requireAdmin;const requireShop=(_0x37104c,_0x3e81a4,_0x5998dc)=>{const _0x2ec472=a21_0x507216;if(!_0x37104c['user']||_0x37104c['user'][_0x2ec472(0x1fa)]!==_0x2ec472(0x201))return _0x3e81a4[_0x2ec472(0x203)](0x193)[_0x2ec472(0x207)]({'success':![],'message':_0x2ec472(0x1f6)});_0x5998dc();};exports[a21_0x507216(0x200)]=requireShop;function a21_0x3bc7(){const _0x1a6825=['8433985ARawSD','user','requireActiveShop','role','authenticateToken','83276WgDiBq','Invalid\x20or\x20expired\x20token','Error\x20checking\x20account\x20status:','Access\x20token\x20required','requireShop','shop','6nkllmG','status','../services/tokenBlacklistService','Token\x20has\x20been\x20revoked','split','json','verify','isTokenBlacklisted','Account\x20is\x20suspended\x20or\x20inactive.\x20Contact\x20administrator\x20to\x20activate\x20your\x20account.','1779753RvVXuz','__esModule','token','2845640cXYmRI','8RcSJGh','authorization','391499QCoMJK','../config/database','secret','admin','headers','default','error','3533600HcjHpj','8984vnywjx','5571FeDBLX','config','ACTIVE','findUnique','Shop\x20access\x20required'];a21_0x3bc7=function(){return _0x1a6825;};return a21_0x3bc7();}const requireActiveShop=async(_0x3211bc,_0x3147b5,_0x14b8db)=>{const _0x5747e6=a21_0x507216;if(!_0x3211bc[_0x5747e6(0x1f8)]||_0x3211bc[_0x5747e6(0x1f8)][_0x5747e6(0x1fa)]!==_0x5747e6(0x201))return _0x3147b5[_0x5747e6(0x203)](0x193)[_0x5747e6(0x207)]({'success':![],'message':_0x5747e6(0x1f6)});try{const _0x2ec4da=require(_0x5747e6(0x1ea))[_0x5747e6(0x1ee)],_0x2b905a=await _0x2ec4da[_0x5747e6(0x201)][_0x5747e6(0x1f5)]({'where':{'id':_0x3211bc['user']['id']},'select':{'status':!![]}});if(!_0x2b905a||_0x2b905a[_0x5747e6(0x203)]!==_0x5747e6(0x1f4))return _0x3147b5['status'](0x193)[_0x5747e6(0x207)]({'success':![],'message':_0x5747e6(0x20a),'suspended':_0x2b905a?.[_0x5747e6(0x203)]==='SUSPENDED'});_0x14b8db();}catch(_0x3fc261){return console[_0x5747e6(0x1ef)](_0x5747e6(0x1fe),_0x3fc261),_0x3147b5[_0x5747e6(0x203)](0x1f4)[_0x5747e6(0x207)]({'success':![],'message':'Error\x20checking\x20account\x20status'});}};exports[a21_0x507216(0x1f9)]=requireActiveShop;