'use strict';const a18_0x4d5995=a18_0x22d7;(function(_0x17a8c6,_0x5055cc){const _0x44bfb2=a18_0x22d7,_0x23855a=_0x17a8c6();while(!![]){try{const _0x3b6239=parseInt(_0x44bfb2(0x1eb))/0x1+parseInt(_0x44bfb2(0x1f9))/0x2*(-parseInt(_0x44bfb2(0x1f2))/0x3)+-parseInt(_0x44bfb2(0x1fc))/0x4*(parseInt(_0x44bfb2(0x1e7))/0x5)+-parseInt(_0x44bfb2(0x208))/0x6+-parseInt(_0x44bfb2(0x20a))/0x7+-parseInt(_0x44bfb2(0x1e4))/0x8*(parseInt(_0x44bfb2(0x206))/0x9)+parseInt(_0x44bfb2(0x1f3))/0xa*(parseInt(_0x44bfb2(0x1ea))/0xb);if(_0x3b6239===_0x5055cc)break;else _0x23855a['push'](_0x23855a['shift']());}catch(_0x1d3c09){_0x23855a['push'](_0x23855a['shift']());}}}(a18_0x6ef7,0x5ca62));var __importDefault=this&&this[a18_0x4d5995(0x204)]||function(_0x4c011b){const _0x4cc73a=a18_0x4d5995;return _0x4c011b&&_0x4c011b[_0x4cc73a(0x1fb)]?_0x4c011b:{'default':_0x4c011b};};Object['defineProperty'](exports,a18_0x4d5995(0x1fb),{'value':!![]}),exports[a18_0x4d5995(0x1fd)]=exports[a18_0x4d5995(0x1f0)]=exports['requireAdmin']=exports[a18_0x4d5995(0x201)]=void 0x0;const jsonwebtoken_1=__importDefault(require(a18_0x4d5995(0x1f7))),config_1=require('../config/config'),tokenBlacklistService_1=require('../services/tokenBlacklistService'),authenticateToken=(_0xfee648,_0x5d6ffa,_0x4b90fc)=>{const _0x16ed9b=a18_0x4d5995,_0x25ce69=_0xfee648[_0x16ed9b(0x1e5)][_0x16ed9b(0x1f5)],_0x20e956=_0x25ce69&&_0x25ce69[_0x16ed9b(0x1e3)]('\x20')[0x1];if(!_0x20e956)return _0x5d6ffa[_0x16ed9b(0x203)](0x191)[_0x16ed9b(0x205)]({'success':![],'message':_0x16ed9b(0x1e8)});if(tokenBlacklistService_1[_0x16ed9b(0x1f8)][_0x16ed9b(0x1fa)](_0x20e956))return _0x5d6ffa[_0x16ed9b(0x203)](0x191)[_0x16ed9b(0x205)]({'success':![],'message':'Token\x20has\x20been\x20revoked'});jsonwebtoken_1['default']['verify'](_0x20e956,config_1[_0x16ed9b(0x1e6)][_0x16ed9b(0x1ed)]['secret'],(_0x5726fa,_0x2e9df9)=>{const _0xde07ef=_0x16ed9b;if(_0x5726fa)return _0x5d6ffa[_0xde07ef(0x203)](0x193)['json']({'success':![],'message':_0xde07ef(0x1f6)});_0xfee648[_0xde07ef(0x20b)]=_0x2e9df9,_0xfee648[_0xde07ef(0x1f1)]=_0x20e956,_0x4b90fc();});};exports['authenticateToken']=authenticateToken;const requireAdmin=(_0x22128c,_0x2d2ec8,_0x4c589c)=>{const _0x518b8e=a18_0x4d5995;if(!_0x22128c['user']||_0x22128c[_0x518b8e(0x20b)]['role']!==_0x518b8e(0x209))return _0x2d2ec8[_0x518b8e(0x203)](0x193)['json']({'success':![],'message':_0x518b8e(0x1ec)});_0x4c589c();};exports['requireAdmin']=requireAdmin;const requireShop=(_0x3e26ba,_0x21b5e6,_0x17de40)=>{const _0x1a8055=a18_0x4d5995;if(!_0x3e26ba[_0x1a8055(0x20b)]||_0x3e26ba[_0x1a8055(0x20b)][_0x1a8055(0x1ee)]!==_0x1a8055(0x207))return _0x21b5e6[_0x1a8055(0x203)](0x193)[_0x1a8055(0x205)]({'success':![],'message':_0x1a8055(0x1f4)});_0x17de40();};exports[a18_0x4d5995(0x1f0)]=requireShop;function a18_0x22d7(_0x3afe58,_0x311307){const _0x6ef771=a18_0x6ef7();return a18_0x22d7=function(_0x22d760,_0x23734b){_0x22d760=_0x22d760-0x1e3;let _0x5e8a27=_0x6ef771[_0x22d760];return _0x5e8a27;},a18_0x22d7(_0x3afe58,_0x311307);}function a18_0x6ef7(){const _0x5440d2=['Admin\x20access\x20required','jwt','role','Error\x20checking\x20account\x20status','requireShop','token','3tzQcEB','802370rNonLo','Shop\x20access\x20required','authorization','Invalid\x20or\x20expired\x20token','jsonwebtoken','tokenBlacklistService','677576LQjeEd','isTokenBlacklisted','__esModule','1379316JDlkss','requireActiveShop','../config/database','default','SUSPENDED','authenticateToken','ACTIVE','status','__importDefault','json','70407uHbdwI','shop','3120930HTaGkt','admin','2374869oZojcj','user','split','112gbbrnz','headers','config','5ATlIbp','Access\x20token\x20required','error','187qGHoBp','668022rjUdhN'];a18_0x6ef7=function(){return _0x5440d2;};return a18_0x6ef7();}const requireActiveShop=async(_0x2f6556,_0x1f2832,_0x6e0aca)=>{const _0x4d1940=a18_0x4d5995;if(!_0x2f6556[_0x4d1940(0x20b)]||_0x2f6556[_0x4d1940(0x20b)][_0x4d1940(0x1ee)]!==_0x4d1940(0x207))return _0x1f2832[_0x4d1940(0x203)](0x193)[_0x4d1940(0x205)]({'success':![],'message':_0x4d1940(0x1f4)});try{const _0x3846b1=require(_0x4d1940(0x1fe))[_0x4d1940(0x1ff)],_0xb7d60e=await _0x3846b1[_0x4d1940(0x207)]['findUnique']({'where':{'id':_0x2f6556['user']['id']},'select':{'status':!![]}});if(!_0xb7d60e||_0xb7d60e[_0x4d1940(0x203)]!==_0x4d1940(0x202))return _0x1f2832[_0x4d1940(0x203)](0x193)['json']({'success':![],'message':'Account\x20is\x20suspended\x20or\x20inactive.\x20Contact\x20administrator\x20to\x20activate\x20your\x20account.','suspended':_0xb7d60e?.['status']===_0x4d1940(0x200)});_0x6e0aca();}catch(_0x27bd4d){return console[_0x4d1940(0x1e9)]('Error\x20checking\x20account\x20status:',_0x27bd4d),_0x1f2832[_0x4d1940(0x203)](0x1f4)['json']({'success':![],'message':_0x4d1940(0x1ef)});}};exports[a18_0x4d5995(0x1fd)]=requireActiveShop;