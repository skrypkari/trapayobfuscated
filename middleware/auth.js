'use strict';const a21_0x34aa70=a21_0x10df;function a21_0x3b95(){const _0x1fffb4=['isTokenBlacklisted','1576858iWKUuc','16290jdXlUJ','findUnique','tokenBlacklistService','shop','4699760tOdBcU','config','role','32052zOkoRs','requireActiveShop','default','2196jsCcIJ','3xxvulQ','__esModule','requireShop','error','26147TdbTwS','token','json','Shop\x20access\x20required','SUSPENDED','2437004qqgBxP','253855WxjBJD','status','Account\x20is\x20suspended\x20or\x20inactive.\x20Contact\x20administrator\x20to\x20activate\x20your\x20account.','Access\x20token\x20required','user','authenticateToken','jwt','304mndsOH','secret','admin','ACTIVE','10406691XlKtZL','__importDefault','authorization','verify','Error\x20checking\x20account\x20status:','defineProperty','1hZyhyz'];a21_0x3b95=function(){return _0x1fffb4;};return a21_0x3b95();}(function(_0x189877,_0x44d396){const _0x192d23=a21_0x10df,_0x334766=_0x189877();while(!![]){try{const _0x512ae4=parseInt(_0x192d23(0x163))/0x1*(-parseInt(_0x192d23(0x165))/0x2)+parseInt(_0x192d23(0x171))/0x3*(-parseInt(_0x192d23(0x17a))/0x4)+-parseInt(_0x192d23(0x166))/0x5*(parseInt(_0x192d23(0x170))/0x6)+parseInt(_0x192d23(0x17b))/0x7*(-parseInt(_0x192d23(0x182))/0x8)+-parseInt(_0x192d23(0x186))/0x9+-parseInt(_0x192d23(0x16a))/0xa+parseInt(_0x192d23(0x175))/0xb*(parseInt(_0x192d23(0x16d))/0xc);if(_0x512ae4===_0x44d396)break;else _0x334766['push'](_0x334766['shift']());}catch(_0x48a811){_0x334766['push'](_0x334766['shift']());}}}(a21_0x3b95,0xb8352));function a21_0x10df(_0x48f0b2,_0xde6bca){_0x48f0b2=_0x48f0b2-0x15e;const _0x3b9506=a21_0x3b95();let _0x10dff1=_0x3b9506[_0x48f0b2];return _0x10dff1;}var __importDefault=this&&this[a21_0x34aa70(0x15e)]||function(_0x409540){const _0x2f6e06=a21_0x34aa70;return _0x409540&&_0x409540[_0x2f6e06(0x172)]?_0x409540:{'default':_0x409540};};Object[a21_0x34aa70(0x162)](exports,a21_0x34aa70(0x172),{'value':!![]}),exports['requireActiveShop']=exports['requireShop']=exports['requireAdmin']=exports[a21_0x34aa70(0x180)]=void 0x0;const jsonwebtoken_1=__importDefault(require('jsonwebtoken')),config_1=require('../config/config'),tokenBlacklistService_1=require('../services/tokenBlacklistService'),authenticateToken=(_0x20aba3,_0x47a890,_0x17d08e)=>{const _0x1920e6=a21_0x34aa70,_0x4efbe3=_0x20aba3['headers'][_0x1920e6(0x15f)],_0x534166=_0x4efbe3&&_0x4efbe3['split']('\x20')[0x1];if(!_0x534166)return _0x47a890[_0x1920e6(0x17c)](0x191)[_0x1920e6(0x177)]({'success':![],'message':_0x1920e6(0x17e)});if(tokenBlacklistService_1[_0x1920e6(0x168)][_0x1920e6(0x164)](_0x534166))return _0x47a890[_0x1920e6(0x17c)](0x191)['json']({'success':![],'message':'Token\x20has\x20been\x20revoked'});jsonwebtoken_1['default'][_0x1920e6(0x160)](_0x534166,config_1[_0x1920e6(0x16b)][_0x1920e6(0x181)][_0x1920e6(0x183)],(_0x12ad64,_0x41685d)=>{const _0x1ea577=_0x1920e6;if(_0x12ad64)return _0x47a890[_0x1ea577(0x17c)](0x193)[_0x1ea577(0x177)]({'success':![],'message':'Invalid\x20or\x20expired\x20token'});_0x20aba3['user']=_0x41685d,_0x20aba3[_0x1ea577(0x176)]=_0x534166,_0x17d08e();});};exports[a21_0x34aa70(0x180)]=authenticateToken;const requireAdmin=(_0x76123e,_0xf03d39,_0xa35b90)=>{const _0x3e7d6a=a21_0x34aa70;if(!_0x76123e[_0x3e7d6a(0x17f)]||_0x76123e[_0x3e7d6a(0x17f)][_0x3e7d6a(0x16c)]!==_0x3e7d6a(0x184))return _0xf03d39[_0x3e7d6a(0x17c)](0x193)[_0x3e7d6a(0x177)]({'success':![],'message':'Admin\x20access\x20required'});_0xa35b90();};exports['requireAdmin']=requireAdmin;const requireShop=(_0x42934c,_0x1e967c,_0x3b5051)=>{const _0x44e5de=a21_0x34aa70;if(!_0x42934c['user']||_0x42934c[_0x44e5de(0x17f)]['role']!==_0x44e5de(0x169))return _0x1e967c[_0x44e5de(0x17c)](0x193)[_0x44e5de(0x177)]({'success':![],'message':_0x44e5de(0x178)});_0x3b5051();};exports[a21_0x34aa70(0x173)]=requireShop;const requireActiveShop=async(_0x54535a,_0x29da7e,_0x2aacb2)=>{const _0x479929=a21_0x34aa70;if(!_0x54535a[_0x479929(0x17f)]||_0x54535a[_0x479929(0x17f)]['role']!==_0x479929(0x169))return _0x29da7e[_0x479929(0x17c)](0x193)[_0x479929(0x177)]({'success':![],'message':_0x479929(0x178)});try{const _0xc31963=require('../config/database')[_0x479929(0x16f)],_0x423f0a=await _0xc31963[_0x479929(0x169)][_0x479929(0x167)]({'where':{'id':_0x54535a[_0x479929(0x17f)]['id']},'select':{'status':!![]}});if(!_0x423f0a||_0x423f0a[_0x479929(0x17c)]!==_0x479929(0x185))return _0x29da7e[_0x479929(0x17c)](0x193)[_0x479929(0x177)]({'success':![],'message':_0x479929(0x17d),'suspended':_0x423f0a?.[_0x479929(0x17c)]===_0x479929(0x179)});_0x2aacb2();}catch(_0x1d1686){return console[_0x479929(0x174)](_0x479929(0x161),_0x1d1686),_0x29da7e[_0x479929(0x17c)](0x1f4)[_0x479929(0x177)]({'success':![],'message':'Error\x20checking\x20account\x20status'});}};exports[a21_0x34aa70(0x16e)]=requireActiveShop;