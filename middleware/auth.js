'use strict';function a16_0x418d(_0x327237,_0x5cb3bf){const _0x11edb2=a16_0x11ed();return a16_0x418d=function(_0x418db3,_0x40f8ca){_0x418db3=_0x418db3-0x84;let _0x25e08e=_0x11edb2[_0x418db3];return _0x25e08e;},a16_0x418d(_0x327237,_0x5cb3bf);}const a16_0xccba12=a16_0x418d;(function(_0x1a1bd1,_0x42d2a3){const _0x5bd199=a16_0x418d,_0x2a3ce9=_0x1a1bd1();while(!![]){try{const _0x253b19=parseInt(_0x5bd199(0x95))/0x1+-parseInt(_0x5bd199(0xac))/0x2+parseInt(_0x5bd199(0x85))/0x3+-parseInt(_0x5bd199(0xa1))/0x4*(-parseInt(_0x5bd199(0x86))/0x5)+parseInt(_0x5bd199(0xa8))/0x6+-parseInt(_0x5bd199(0x96))/0x7*(parseInt(_0x5bd199(0xad))/0x8)+parseInt(_0x5bd199(0x8f))/0x9*(-parseInt(_0x5bd199(0xa0))/0xa);if(_0x253b19===_0x42d2a3)break;else _0x2a3ce9['push'](_0x2a3ce9['shift']());}catch(_0x18840e){_0x2a3ce9['push'](_0x2a3ce9['shift']());}}}(a16_0x11ed,0x959dd));function a16_0x11ed(){const _0x5ad946=['5307936KlCzAp','requireActiveShop','user','status','857020lRYEoj','8389648ahvadI','Error\x20checking\x20account\x20status','role','2100201DFRXCh','5820860EEPAfm','default','jwt','admin','isTokenBlacklisted','error','../config/database','json','Access\x20token\x20required','15137064ynQBOi','authorization','requireAdmin','Account\x20is\x20suspended\x20or\x20inactive.\x20Contact\x20administrator\x20to\x20activate\x20your\x20account.','SUSPENDED','../services/tokenBlacklistService','1023046leOJbR','7TRzTZb','Invalid\x20or\x20expired\x20token','Shop\x20access\x20required','verify','tokenBlacklistService','requireShop','ACTIVE','headers','split','jsonwebtoken','10xRjTHr','4fhUbth','authenticateToken','Token\x20has\x20been\x20revoked','token','__esModule','shop','Admin\x20access\x20required'];a16_0x11ed=function(){return _0x5ad946;};return a16_0x11ed();}var __importDefault=this&&this['__importDefault']||function(_0x139e5f){return _0x139e5f&&_0x139e5f['__esModule']?_0x139e5f:{'default':_0x139e5f};};Object['defineProperty'](exports,a16_0xccba12(0xa5),{'value':!![]}),exports[a16_0xccba12(0xa9)]=exports[a16_0xccba12(0x9b)]=exports[a16_0xccba12(0x91)]=exports[a16_0xccba12(0xa2)]=void 0x0;const jsonwebtoken_1=__importDefault(require(a16_0xccba12(0x9f))),config_1=require('../config/config'),tokenBlacklistService_1=require(a16_0xccba12(0x94)),authenticateToken=(_0x257588,_0x48cd21,_0x50c6fc)=>{const _0x30a0dc=a16_0xccba12,_0x39e63c=_0x257588[_0x30a0dc(0x9d)][_0x30a0dc(0x90)],_0xf44701=_0x39e63c&&_0x39e63c[_0x30a0dc(0x9e)]('\x20')[0x1];if(!_0xf44701)return _0x48cd21['status'](0x191)[_0x30a0dc(0x8d)]({'success':![],'message':_0x30a0dc(0x8e)});if(tokenBlacklistService_1[_0x30a0dc(0x9a)][_0x30a0dc(0x8a)](_0xf44701))return _0x48cd21[_0x30a0dc(0xab)](0x191)['json']({'success':![],'message':_0x30a0dc(0xa3)});jsonwebtoken_1[_0x30a0dc(0x87)][_0x30a0dc(0x99)](_0xf44701,config_1['config'][_0x30a0dc(0x88)]['secret'],(_0x3a646d,_0x40791d)=>{const _0x1b402a=_0x30a0dc;if(_0x3a646d)return _0x48cd21[_0x1b402a(0xab)](0x193)[_0x1b402a(0x8d)]({'success':![],'message':_0x1b402a(0x97)});_0x257588['user']=_0x40791d,_0x257588[_0x1b402a(0xa4)]=_0xf44701,_0x50c6fc();});};exports[a16_0xccba12(0xa2)]=authenticateToken;const requireAdmin=(_0x5d647c,_0x11074c,_0x256288)=>{const _0x14dc5a=a16_0xccba12;if(!_0x5d647c[_0x14dc5a(0xaa)]||_0x5d647c['user']['role']!==_0x14dc5a(0x89))return _0x11074c['status'](0x193)['json']({'success':![],'message':_0x14dc5a(0xa7)});_0x256288();};exports[a16_0xccba12(0x91)]=requireAdmin;const requireShop=(_0x47be78,_0xafa532,_0xbdfbc2)=>{const _0xda7860=a16_0xccba12;if(!_0x47be78[_0xda7860(0xaa)]||_0x47be78[_0xda7860(0xaa)][_0xda7860(0x84)]!==_0xda7860(0xa6))return _0xafa532[_0xda7860(0xab)](0x193)[_0xda7860(0x8d)]({'success':![],'message':_0xda7860(0x98)});_0xbdfbc2();};exports[a16_0xccba12(0x9b)]=requireShop;const requireActiveShop=async(_0xaee014,_0x12930d,_0x4b48d0)=>{const _0x8af5fd=a16_0xccba12;if(!_0xaee014[_0x8af5fd(0xaa)]||_0xaee014['user']['role']!==_0x8af5fd(0xa6))return _0x12930d[_0x8af5fd(0xab)](0x193)[_0x8af5fd(0x8d)]({'success':![],'message':'Shop\x20access\x20required'});try{const _0x27f414=require(_0x8af5fd(0x8c))[_0x8af5fd(0x87)],_0x1980aa=await _0x27f414[_0x8af5fd(0xa6)]['findUnique']({'where':{'id':_0xaee014[_0x8af5fd(0xaa)]['id']},'select':{'status':!![]}});if(!_0x1980aa||_0x1980aa['status']!==_0x8af5fd(0x9c))return _0x12930d[_0x8af5fd(0xab)](0x193)['json']({'success':![],'message':_0x8af5fd(0x92),'suspended':_0x1980aa?.['status']===_0x8af5fd(0x93)});_0x4b48d0();}catch(_0x5de9c9){return console[_0x8af5fd(0x8b)]('Error\x20checking\x20account\x20status:',_0x5de9c9),_0x12930d[_0x8af5fd(0xab)](0x1f4)['json']({'success':![],'message':_0x8af5fd(0xae)});}};exports['requireActiveShop']=requireActiveShop;