'use strict';const a16_0x100a2f=a16_0x41f2;(function(_0x3e5d52,_0x433410){const _0x4f75a6=a16_0x41f2,_0x3d2f28=_0x3e5d52();while(!![]){try{const _0x4d520e=-parseInt(_0x4f75a6(0x102))/0x1+parseInt(_0x4f75a6(0x11f))/0x2*(-parseInt(_0x4f75a6(0x115))/0x3)+parseInt(_0x4f75a6(0x11e))/0x4*(-parseInt(_0x4f75a6(0x103))/0x5)+-parseInt(_0x4f75a6(0x11b))/0x6*(parseInt(_0x4f75a6(0x124))/0x7)+-parseInt(_0x4f75a6(0x104))/0x8*(parseInt(_0x4f75a6(0x110))/0x9)+parseInt(_0x4f75a6(0x113))/0xa*(-parseInt(_0x4f75a6(0x10e))/0xb)+parseInt(_0x4f75a6(0x10f))/0xc;if(_0x4d520e===_0x433410)break;else _0x3d2f28['push'](_0x3d2f28['shift']());}catch(_0x291f03){_0x3d2f28['push'](_0x3d2f28['shift']());}}}(a16_0x503e,0xdc0e6));function a16_0x41f2(_0x16336b,_0x37f9bb){const _0x503e17=a16_0x503e();return a16_0x41f2=function(_0x41f297,_0x1645d3){_0x41f297=_0x41f297-0xfe;let _0x5d28e1=_0x503e17[_0x41f297];return _0x5d28e1;},a16_0x41f2(_0x16336b,_0x37f9bb);}var __importDefault=this&&this['__importDefault']||function(_0x5b6ace){const _0x23fcd8=a16_0x41f2;return _0x5b6ace&&_0x5b6ace[_0x23fcd8(0x117)]?_0x5b6ace:{'default':_0x5b6ace};};Object['defineProperty'](exports,a16_0x100a2f(0x117),{'value':!![]}),exports[a16_0x100a2f(0x120)]=exports['requireShop']=exports[a16_0x100a2f(0x10c)]=exports['authenticateToken']=void 0x0;const jsonwebtoken_1=__importDefault(require(a16_0x100a2f(0x119))),config_1=require(a16_0x100a2f(0x106)),tokenBlacklistService_1=require(a16_0x100a2f(0x109)),authenticateToken=(_0x10074b,_0x1e1b4f,_0x19a5a9)=>{const _0x2ab1f0=a16_0x100a2f,_0x195be6=_0x10074b[_0x2ab1f0(0x126)][_0x2ab1f0(0x123)],_0x3715fc=_0x195be6&&_0x195be6['split']('\x20')[0x1];if(!_0x3715fc)return _0x1e1b4f[_0x2ab1f0(0x100)](0x191)['json']({'success':![],'message':_0x2ab1f0(0x111)});if(tokenBlacklistService_1[_0x2ab1f0(0x112)]['isTokenBlacklisted'](_0x3715fc))return _0x1e1b4f[_0x2ab1f0(0x100)](0x191)[_0x2ab1f0(0x118)]({'success':![],'message':_0x2ab1f0(0x11c)});jsonwebtoken_1[_0x2ab1f0(0x105)][_0x2ab1f0(0x10d)](_0x3715fc,config_1['config'][_0x2ab1f0(0x11d)]['secret'],(_0x1a1696,_0x3b62cb)=>{const _0x3e9818=_0x2ab1f0;if(_0x1a1696)return _0x1e1b4f['status'](0x193)[_0x3e9818(0x118)]({'success':![],'message':'Invalid\x20or\x20expired\x20token'});_0x10074b[_0x3e9818(0x125)]=_0x3b62cb,_0x10074b[_0x3e9818(0x114)]=_0x3715fc,_0x19a5a9();});};function a16_0x503e(){const _0x5a8141=['error','3808086AufZAF','Token\x20has\x20been\x20revoked','jwt','76HsVrOP','8qMmJlH','requireActiveShop','shop','role','authorization','14fgAumV','user','headers','authenticateToken','Shop\x20access\x20required','admin','status','SUSPENDED','1383471iHPjbS','3680VxVNOP','824uuCADP','default','../config/config','requireShop','../config/database','../services/tokenBlacklistService','Error\x20checking\x20account\x20status','ACTIVE','requireAdmin','verify','154QOXAbE','65468976iIWNuu','88461DQSGPF','Access\x20token\x20required','tokenBlacklistService','26090mQYyRh','token','629001IBsOuO','findUnique','__esModule','json','jsonwebtoken'];a16_0x503e=function(){return _0x5a8141;};return a16_0x503e();}exports[a16_0x100a2f(0x127)]=authenticateToken;const requireAdmin=(_0x546c1c,_0x26739e,_0x20d760)=>{const _0x29c103=a16_0x100a2f;if(!_0x546c1c['user']||_0x546c1c['user'][_0x29c103(0x122)]!==_0x29c103(0xff))return _0x26739e[_0x29c103(0x100)](0x193)['json']({'success':![],'message':'Admin\x20access\x20required'});_0x20d760();};exports[a16_0x100a2f(0x10c)]=requireAdmin;const requireShop=(_0x57fe50,_0x139028,_0x32f803)=>{const _0xd58ac3=a16_0x100a2f;if(!_0x57fe50[_0xd58ac3(0x125)]||_0x57fe50['user'][_0xd58ac3(0x122)]!==_0xd58ac3(0x121))return _0x139028['status'](0x193)[_0xd58ac3(0x118)]({'success':![],'message':_0xd58ac3(0xfe)});_0x32f803();};exports[a16_0x100a2f(0x107)]=requireShop;const requireActiveShop=async(_0x498602,_0x223ddf,_0x15701e)=>{const _0x1f8b88=a16_0x100a2f;if(!_0x498602[_0x1f8b88(0x125)]||_0x498602[_0x1f8b88(0x125)][_0x1f8b88(0x122)]!==_0x1f8b88(0x121))return _0x223ddf[_0x1f8b88(0x100)](0x193)[_0x1f8b88(0x118)]({'success':![],'message':_0x1f8b88(0xfe)});try{const _0x55fa85=require(_0x1f8b88(0x108))[_0x1f8b88(0x105)],_0x35d8e9=await _0x55fa85[_0x1f8b88(0x121)][_0x1f8b88(0x116)]({'where':{'id':_0x498602[_0x1f8b88(0x125)]['id']},'select':{'status':!![]}});if(!_0x35d8e9||_0x35d8e9[_0x1f8b88(0x100)]!==_0x1f8b88(0x10b))return _0x223ddf[_0x1f8b88(0x100)](0x193)['json']({'success':![],'message':'Account\x20is\x20suspended\x20or\x20inactive.\x20Contact\x20administrator\x20to\x20activate\x20your\x20account.','suspended':_0x35d8e9?.[_0x1f8b88(0x100)]===_0x1f8b88(0x101)});_0x15701e();}catch(_0x553da5){return console[_0x1f8b88(0x11a)]('Error\x20checking\x20account\x20status:',_0x553da5),_0x223ddf['status'](0x1f4)['json']({'success':![],'message':_0x1f8b88(0x10a)});}};exports[a16_0x100a2f(0x120)]=requireActiveShop;