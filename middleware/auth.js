'use strict';function a17_0x1fb7(){const _0x2d1a4f=['json','authenticateToken','Shop\x20access\x20required','defineProperty','jwt','2NCcPHM','Admin\x20access\x20required','7244560bXXvTT','secret','tokenBlacklistService','__importDefault','shop','split','requireShop','194391JDRgKh','isTokenBlacklisted','3786fFduNf','2590xYQNsP','8EuNZCP','user','247829TNDOwB','Error\x20checking\x20account\x20status:','2022951RDhxml','status','../config/database','ACTIVE','Account\x20is\x20suspended\x20or\x20inactive.\x20Contact\x20administrator\x20to\x20activate\x20your\x20account.','Error\x20checking\x20account\x20status','headers','config','__esModule','requireActiveShop','Token\x20has\x20been\x20revoked','759656hEsVRk','requireAdmin','1322154DILHxx','role','../config/config','SUSPENDED'];a17_0x1fb7=function(){return _0x2d1a4f;};return a17_0x1fb7();}const a17_0x328622=a17_0x561f;(function(_0x4dc7ae,_0x1bf535){const _0x208521=a17_0x561f,_0x284c2f=_0x4dc7ae();while(!![]){try{const _0x5910e2=parseInt(_0x208521(0x1c8))/0x1*(-parseInt(_0x208521(0x1b9))/0x2)+parseInt(_0x208521(0x1c2))/0x3+-parseInt(_0x208521(0x1ae))/0x4+-parseInt(_0x208521(0x1c5))/0x5*(parseInt(_0x208521(0x1c4))/0x6)+-parseInt(_0x208521(0x1a3))/0x7*(-parseInt(_0x208521(0x1c6))/0x8)+-parseInt(_0x208521(0x1b0))/0x9+parseInt(_0x208521(0x1bb))/0xa;if(_0x5910e2===_0x1bf535)break;else _0x284c2f['push'](_0x284c2f['shift']());}catch(_0xd48a90){_0x284c2f['push'](_0x284c2f['shift']());}}}(a17_0x1fb7,0x28b53));var __importDefault=this&&this[a17_0x328622(0x1be)]||function(_0x3de6dd){const _0x1e6704=a17_0x328622;return _0x3de6dd&&_0x3de6dd[_0x1e6704(0x1ab)]?_0x3de6dd:{'default':_0x3de6dd};};Object[a17_0x328622(0x1b7)](exports,a17_0x328622(0x1ab),{'value':!![]}),exports[a17_0x328622(0x1ac)]=exports[a17_0x328622(0x1c1)]=exports[a17_0x328622(0x1af)]=exports[a17_0x328622(0x1b5)]=void 0x0;function a17_0x561f(_0x1a4bdf,_0x50e052){const _0x1fb787=a17_0x1fb7();return a17_0x561f=function(_0x561f9b,_0x23afa0){_0x561f9b=_0x561f9b-0x1a3;let _0x214fa7=_0x1fb787[_0x561f9b];return _0x214fa7;},a17_0x561f(_0x1a4bdf,_0x50e052);}const jsonwebtoken_1=__importDefault(require('jsonwebtoken')),config_1=require(a17_0x328622(0x1b2)),tokenBlacklistService_1=require('../services/tokenBlacklistService'),authenticateToken=(_0x2a02f5,_0x454354,_0x54c480)=>{const _0x4a37b1=a17_0x328622,_0x474e1b=_0x2a02f5[_0x4a37b1(0x1a9)]['authorization'],_0x3a3e55=_0x474e1b&&_0x474e1b[_0x4a37b1(0x1c0)]('\x20')[0x1];if(!_0x3a3e55)return _0x454354['status'](0x191)[_0x4a37b1(0x1b4)]({'success':![],'message':'Access\x20token\x20required'});if(tokenBlacklistService_1[_0x4a37b1(0x1bd)][_0x4a37b1(0x1c3)](_0x3a3e55))return _0x454354['status'](0x191)[_0x4a37b1(0x1b4)]({'success':![],'message':_0x4a37b1(0x1ad)});jsonwebtoken_1['default']['verify'](_0x3a3e55,config_1[_0x4a37b1(0x1aa)][_0x4a37b1(0x1b8)][_0x4a37b1(0x1bc)],(_0x4f1157,_0x27aabd)=>{const _0x515cde=_0x4a37b1;if(_0x4f1157)return _0x454354[_0x515cde(0x1a4)](0x193)[_0x515cde(0x1b4)]({'success':![],'message':'Invalid\x20or\x20expired\x20token'});_0x2a02f5[_0x515cde(0x1c7)]=_0x27aabd,_0x2a02f5['token']=_0x3a3e55,_0x54c480();});};exports[a17_0x328622(0x1b5)]=authenticateToken;const requireAdmin=(_0x455e35,_0x17e8e1,_0x315e4a)=>{const _0x2ae9f0=a17_0x328622;if(!_0x455e35[_0x2ae9f0(0x1c7)]||_0x455e35[_0x2ae9f0(0x1c7)][_0x2ae9f0(0x1b1)]!=='admin')return _0x17e8e1[_0x2ae9f0(0x1a4)](0x193)[_0x2ae9f0(0x1b4)]({'success':![],'message':_0x2ae9f0(0x1ba)});_0x315e4a();};exports['requireAdmin']=requireAdmin;const requireShop=(_0x1d4209,_0x21b3d9,_0x5690d5)=>{const _0x11c142=a17_0x328622;if(!_0x1d4209[_0x11c142(0x1c7)]||_0x1d4209[_0x11c142(0x1c7)][_0x11c142(0x1b1)]!==_0x11c142(0x1bf))return _0x21b3d9[_0x11c142(0x1a4)](0x193)[_0x11c142(0x1b4)]({'success':![],'message':_0x11c142(0x1b6)});_0x5690d5();};exports[a17_0x328622(0x1c1)]=requireShop;const requireActiveShop=async(_0x2fccb6,_0x2bea32,_0x50b866)=>{const _0x1343d5=a17_0x328622;if(!_0x2fccb6[_0x1343d5(0x1c7)]||_0x2fccb6[_0x1343d5(0x1c7)]['role']!=='shop')return _0x2bea32[_0x1343d5(0x1a4)](0x193)[_0x1343d5(0x1b4)]({'success':![],'message':_0x1343d5(0x1b6)});try{const _0x272a2d=require(_0x1343d5(0x1a5))['default'],_0x2173ef=await _0x272a2d[_0x1343d5(0x1bf)]['findUnique']({'where':{'id':_0x2fccb6[_0x1343d5(0x1c7)]['id']},'select':{'status':!![]}});if(!_0x2173ef||_0x2173ef[_0x1343d5(0x1a4)]!==_0x1343d5(0x1a6))return _0x2bea32[_0x1343d5(0x1a4)](0x193)['json']({'success':![],'message':_0x1343d5(0x1a7),'suspended':_0x2173ef?.[_0x1343d5(0x1a4)]===_0x1343d5(0x1b3)});_0x50b866();}catch(_0x5aa88d){return console['error'](_0x1343d5(0x1c9),_0x5aa88d),_0x2bea32['status'](0x1f4)[_0x1343d5(0x1b4)]({'success':![],'message':_0x1343d5(0x1a8)});}};exports[a17_0x328622(0x1ac)]=requireActiveShop;