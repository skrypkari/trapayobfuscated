'use strict';const a18_0x5501a2=a18_0x3e7f;(function(_0xbecf0d,_0x17364c){const _0x1b2197=a18_0x3e7f,_0xa0bafe=_0xbecf0d();while(!![]){try{const _0x1e994d=parseInt(_0x1b2197(0xf5))/0x1+parseInt(_0x1b2197(0xff))/0x2*(parseInt(_0x1b2197(0x10f))/0x3)+parseInt(_0x1b2197(0xe9))/0x4+-parseInt(_0x1b2197(0x110))/0x5+parseInt(_0x1b2197(0xf2))/0x6+-parseInt(_0x1b2197(0xfa))/0x7+parseInt(_0x1b2197(0xf3))/0x8*(-parseInt(_0x1b2197(0x106))/0x9);if(_0x1e994d===_0x17364c)break;else _0xa0bafe['push'](_0xa0bafe['shift']());}catch(_0x2bf9d0){_0xa0bafe['push'](_0xa0bafe['shift']());}}}(a18_0x3609,0x9b03c));var __importDefault=this&&this['__importDefault']||function(_0x542c32){const _0x3d4799=a18_0x3e7f;return _0x542c32&&_0x542c32[_0x3d4799(0x10c)]?_0x542c32:{'default':_0x542c32};};Object['defineProperty'](exports,'__esModule',{'value':!![]}),exports[a18_0x5501a2(0xe8)]=exports[a18_0x5501a2(0x104)]=exports[a18_0x5501a2(0xf4)]=exports[a18_0x5501a2(0x10e)]=void 0x0;const jsonwebtoken_1=__importDefault(require('jsonwebtoken')),config_1=require('../config/config'),tokenBlacklistService_1=require('../services/tokenBlacklistService'),authenticateToken=(_0x42be3a,_0x76519e,_0x9b8e37)=>{const _0x24ae01=a18_0x5501a2,_0x95682d=_0x42be3a[_0x24ae01(0x108)][_0x24ae01(0x109)],_0x4f5aed=_0x95682d&&_0x95682d[_0x24ae01(0xef)]('\x20')[0x1];if(!_0x4f5aed)return _0x76519e[_0x24ae01(0xf6)](0x191)[_0x24ae01(0x107)]({'success':![],'message':'Access\x20token\x20required'});if(tokenBlacklistService_1[_0x24ae01(0xf7)][_0x24ae01(0xeb)](_0x4f5aed))return _0x76519e[_0x24ae01(0xf6)](0x191)[_0x24ae01(0x107)]({'success':![],'message':_0x24ae01(0xe7)});jsonwebtoken_1[_0x24ae01(0xf1)][_0x24ae01(0x103)](_0x4f5aed,config_1[_0x24ae01(0x100)][_0x24ae01(0xf0)][_0x24ae01(0xfd)],(_0xef816d,_0x233bf6)=>{const _0x557062=_0x24ae01;if(_0xef816d)return _0x76519e[_0x557062(0xf6)](0x193)[_0x557062(0x107)]({'success':![],'message':_0x557062(0xec)});_0x42be3a['user']=_0x233bf6,_0x42be3a[_0x557062(0xee)]=_0x4f5aed,_0x9b8e37();});};exports[a18_0x5501a2(0x10e)]=authenticateToken;function a18_0x3609(){const _0x5d9b9c=['3531472JUboJJ','ACTIVE','isTokenBlacklisted','Invalid\x20or\x20expired\x20token','Error\x20checking\x20account\x20status','token','split','jwt','default','7437276JwSllC','16GFWCKP','requireAdmin','1161831yvbkRy','status','tokenBlacklistService','admin','Admin\x20access\x20required','7654304zSWlME','shop','user','secret','role','204752vsTpEl','config','error','../config/database','verify','requireShop','SUSPENDED','3367899DuzqIq','json','headers','authorization','Account\x20is\x20suspended\x20or\x20inactive.\x20Contact\x20administrator\x20to\x20activate\x20your\x20account.','Error\x20checking\x20account\x20status:','__esModule','Shop\x20access\x20required','authenticateToken','12puSopt','6084575oQVBXC','Token\x20has\x20been\x20revoked','requireActiveShop'];a18_0x3609=function(){return _0x5d9b9c;};return a18_0x3609();}const requireAdmin=(_0x3ec706,_0x481229,_0x183218)=>{const _0x3d38e7=a18_0x5501a2;if(!_0x3ec706['user']||_0x3ec706['user'][_0x3d38e7(0xfe)]!==_0x3d38e7(0xf8))return _0x481229[_0x3d38e7(0xf6)](0x193)[_0x3d38e7(0x107)]({'success':![],'message':_0x3d38e7(0xf9)});_0x183218();};exports[a18_0x5501a2(0xf4)]=requireAdmin;const requireShop=(_0x1bab6e,_0x1a0142,_0x38a1a9)=>{const _0xc86c4a=a18_0x5501a2;if(!_0x1bab6e[_0xc86c4a(0xfc)]||_0x1bab6e[_0xc86c4a(0xfc)][_0xc86c4a(0xfe)]!==_0xc86c4a(0xfb))return _0x1a0142[_0xc86c4a(0xf6)](0x193)[_0xc86c4a(0x107)]({'success':![],'message':_0xc86c4a(0x10d)});_0x38a1a9();};exports['requireShop']=requireShop;function a18_0x3e7f(_0x396157,_0x53cea9){const _0x360924=a18_0x3609();return a18_0x3e7f=function(_0x3e7f92,_0x26a7c5){_0x3e7f92=_0x3e7f92-0xe7;let _0x2909de=_0x360924[_0x3e7f92];return _0x2909de;},a18_0x3e7f(_0x396157,_0x53cea9);}const requireActiveShop=async(_0x4b9996,_0xea5207,_0x5b1f03)=>{const _0x563582=a18_0x5501a2;if(!_0x4b9996[_0x563582(0xfc)]||_0x4b9996['user'][_0x563582(0xfe)]!==_0x563582(0xfb))return _0xea5207[_0x563582(0xf6)](0x193)[_0x563582(0x107)]({'success':![],'message':'Shop\x20access\x20required'});try{const _0x2ec0cc=require(_0x563582(0x102))[_0x563582(0xf1)],_0xe6691a=await _0x2ec0cc[_0x563582(0xfb)]['findUnique']({'where':{'id':_0x4b9996[_0x563582(0xfc)]['id']},'select':{'status':!![]}});if(!_0xe6691a||_0xe6691a[_0x563582(0xf6)]!==_0x563582(0xea))return _0xea5207[_0x563582(0xf6)](0x193)['json']({'success':![],'message':_0x563582(0x10a),'suspended':_0xe6691a?.[_0x563582(0xf6)]===_0x563582(0x105)});_0x5b1f03();}catch(_0x3ff293){return console[_0x563582(0x101)](_0x563582(0x10b),_0x3ff293),_0xea5207[_0x563582(0xf6)](0x1f4)['json']({'success':![],'message':_0x563582(0xed)});}};exports[a18_0x5501a2(0xe8)]=requireActiveShop;