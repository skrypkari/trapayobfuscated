'use strict';const a17_0x1d2563=a17_0x5174;(function(_0x60b26d,_0x3e6561){const _0x4bb4bc=a17_0x5174,_0x49e392=_0x60b26d();while(!![]){try{const _0x152a2f=parseInt(_0x4bb4bc(0xbb))/0x1*(-parseInt(_0x4bb4bc(0xb3))/0x2)+-parseInt(_0x4bb4bc(0x9e))/0x3+-parseInt(_0x4bb4bc(0x99))/0x4*(-parseInt(_0x4bb4bc(0xb5))/0x5)+parseInt(_0x4bb4bc(0xa3))/0x6*(parseInt(_0x4bb4bc(0xa6))/0x7)+parseInt(_0x4bb4bc(0xa0))/0x8+-parseInt(_0x4bb4bc(0xad))/0x9*(parseInt(_0x4bb4bc(0x9c))/0xa)+-parseInt(_0x4bb4bc(0x97))/0xb;if(_0x152a2f===_0x3e6561)break;else _0x49e392['push'](_0x49e392['shift']());}catch(_0x408602){_0x49e392['push'](_0x49e392['shift']());}}}(a17_0x1b74,0x42b3e));function a17_0x5174(_0x21c779,_0x3d16d1){const _0x1b74ab=a17_0x1b74();return a17_0x5174=function(_0x51745d,_0x1d8f03){_0x51745d=_0x51745d-0x91;let _0x126029=_0x1b74ab[_0x51745d];return _0x126029;},a17_0x5174(_0x21c779,_0x3d16d1);}function a17_0x1b74(){const _0x2b1708=['requireAdmin','verify','4012QIdVDh','requireActiveShop','Token\x20has\x20been\x20revoked','error','requireShop','../services/tokenBlacklistService','Shop\x20access\x20required','Admin\x20access\x20required','split','authenticateToken','482691XcUCmj','Invalid\x20or\x20expired\x20token','1356WAMbvi','user','isTokenBlacklisted','30490oxxRbA','config','1273719bpBodZ','default','840696zTxVLn','SUSPENDED','Access\x20token\x20required','6PshbVu','findUnique','tokenBlacklistService','2267321zOFXAw','__esModule','role','ACTIVE','../config/database','Error\x20checking\x20account\x20status:','defineProperty','117JRWwDg','admin','__importDefault','json','secret','../config/config','76AmPZnx','status','7445gDOgND','jwt','shop','Error\x20checking\x20account\x20status'];a17_0x1b74=function(){return _0x2b1708;};return a17_0x1b74();}var __importDefault=this&&this[a17_0x1d2563(0xaf)]||function(_0x54725d){return _0x54725d&&_0x54725d['__esModule']?_0x54725d:{'default':_0x54725d};};Object[a17_0x1d2563(0xac)](exports,a17_0x1d2563(0xa7),{'value':!![]}),exports[a17_0x1d2563(0xbc)]=exports[a17_0x1d2563(0x91)]=exports['requireAdmin']=exports[a17_0x1d2563(0x96)]=void 0x0;const jsonwebtoken_1=__importDefault(require('jsonwebtoken')),config_1=require(a17_0x1d2563(0xb2)),tokenBlacklistService_1=require(a17_0x1d2563(0x92)),authenticateToken=(_0x4d24ca,_0x1d86ef,_0x19b153)=>{const _0x3a2f87=a17_0x1d2563,_0x3d9db0=_0x4d24ca['headers']['authorization'],_0x3c137e=_0x3d9db0&&_0x3d9db0[_0x3a2f87(0x95)]('\x20')[0x1];if(!_0x3c137e)return _0x1d86ef[_0x3a2f87(0xb4)](0x191)['json']({'success':![],'message':_0x3a2f87(0xa2)});if(tokenBlacklistService_1[_0x3a2f87(0xa5)][_0x3a2f87(0x9b)](_0x3c137e))return _0x1d86ef[_0x3a2f87(0xb4)](0x191)[_0x3a2f87(0xb0)]({'success':![],'message':_0x3a2f87(0xbd)});jsonwebtoken_1['default'][_0x3a2f87(0xba)](_0x3c137e,config_1[_0x3a2f87(0x9d)][_0x3a2f87(0xb6)][_0x3a2f87(0xb1)],(_0x9228f0,_0x2023e4)=>{const _0xb960af=_0x3a2f87;if(_0x9228f0)return _0x1d86ef[_0xb960af(0xb4)](0x193)[_0xb960af(0xb0)]({'success':![],'message':_0xb960af(0x98)});_0x4d24ca['user']=_0x2023e4,_0x4d24ca['token']=_0x3c137e,_0x19b153();});};exports[a17_0x1d2563(0x96)]=authenticateToken;const requireAdmin=(_0x84d012,_0x1b25f5,_0x56e7fb)=>{const _0x111d5c=a17_0x1d2563;if(!_0x84d012[_0x111d5c(0x9a)]||_0x84d012[_0x111d5c(0x9a)][_0x111d5c(0xa8)]!==_0x111d5c(0xae))return _0x1b25f5[_0x111d5c(0xb4)](0x193)[_0x111d5c(0xb0)]({'success':![],'message':_0x111d5c(0x94)});_0x56e7fb();};exports[a17_0x1d2563(0xb9)]=requireAdmin;const requireShop=(_0x3481ce,_0x493293,_0x232a97)=>{const _0x2795f8=a17_0x1d2563;if(!_0x3481ce[_0x2795f8(0x9a)]||_0x3481ce[_0x2795f8(0x9a)][_0x2795f8(0xa8)]!=='shop')return _0x493293[_0x2795f8(0xb4)](0x193)['json']({'success':![],'message':_0x2795f8(0x93)});_0x232a97();};exports[a17_0x1d2563(0x91)]=requireShop;const requireActiveShop=async(_0x30d385,_0x18911e,_0x50263d)=>{const _0x58582d=a17_0x1d2563;if(!_0x30d385['user']||_0x30d385[_0x58582d(0x9a)][_0x58582d(0xa8)]!=='shop')return _0x18911e[_0x58582d(0xb4)](0x193)[_0x58582d(0xb0)]({'success':![],'message':_0x58582d(0x93)});try{const _0x204d54=require(_0x58582d(0xaa))[_0x58582d(0x9f)],_0x302d4b=await _0x204d54[_0x58582d(0xb7)][_0x58582d(0xa4)]({'where':{'id':_0x30d385[_0x58582d(0x9a)]['id']},'select':{'status':!![]}});if(!_0x302d4b||_0x302d4b[_0x58582d(0xb4)]!==_0x58582d(0xa9))return _0x18911e[_0x58582d(0xb4)](0x193)[_0x58582d(0xb0)]({'success':![],'message':'Account\x20is\x20suspended\x20or\x20inactive.\x20Contact\x20administrator\x20to\x20activate\x20your\x20account.','suspended':_0x302d4b?.['status']===_0x58582d(0xa1)});_0x50263d();}catch(_0x3a0eb9){return console[_0x58582d(0xbe)](_0x58582d(0xab),_0x3a0eb9),_0x18911e[_0x58582d(0xb4)](0x1f4)[_0x58582d(0xb0)]({'success':![],'message':_0x58582d(0xb8)});}};exports[a17_0x1d2563(0xbc)]=requireActiveShop;