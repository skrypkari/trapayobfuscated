'use strict';const a16_0x21c435=a16_0x5455;function a16_0x5455(_0x2e85b8,_0x26738c){const _0x5c5e52=a16_0x5c5e();return a16_0x5455=function(_0x545550,_0xf18b30){_0x545550=_0x545550-0xa0;let _0x3aa63a=_0x5c5e52[_0x545550];return _0x3aa63a;},a16_0x5455(_0x2e85b8,_0x26738c);}(function(_0x4b97cc,_0x5d7806){const _0x1eb9f8=a16_0x5455,_0x4ff2a2=_0x4b97cc();while(!![]){try{const _0x3d9695=-parseInt(_0x1eb9f8(0xa4))/0x1+parseInt(_0x1eb9f8(0xaf))/0x2+parseInt(_0x1eb9f8(0xc5))/0x3+-parseInt(_0x1eb9f8(0xc0))/0x4+-parseInt(_0x1eb9f8(0xc1))/0x5*(-parseInt(_0x1eb9f8(0xa6))/0x6)+parseInt(_0x1eb9f8(0xc7))/0x7+parseInt(_0x1eb9f8(0xaa))/0x8;if(_0x3d9695===_0x5d7806)break;else _0x4ff2a2['push'](_0x4ff2a2['shift']());}catch(_0x3afa9a){_0x4ff2a2['push'](_0x4ff2a2['shift']());}}}(a16_0x5c5e,0xea27f));var __importDefault=this&&this[a16_0x21c435(0xa0)]||function(_0x9bf2f3){const _0x51062a=a16_0x21c435;return _0x9bf2f3&&_0x9bf2f3[_0x51062a(0xb8)]?_0x9bf2f3:{'default':_0x9bf2f3};};Object[a16_0x21c435(0xa5)](exports,a16_0x21c435(0xb8),{'value':!![]}),exports[a16_0x21c435(0xb2)]=exports['requireShop']=exports['requireAdmin']=exports[a16_0x21c435(0xc9)]=void 0x0;const jsonwebtoken_1=__importDefault(require(a16_0x21c435(0xb9))),config_1=require('../config/config'),tokenBlacklistService_1=require(a16_0x21c435(0xa8)),authenticateToken=(_0x179fee,_0x3c6897,_0x574d81)=>{const _0x2985d4=a16_0x21c435,_0x33c08d=_0x179fee[_0x2985d4(0xc8)][_0x2985d4(0xa1)],_0x3ad0ca=_0x33c08d&&_0x33c08d[_0x2985d4(0xbd)]('\x20')[0x1];if(!_0x3ad0ca)return _0x3c6897[_0x2985d4(0xa2)](0x191)[_0x2985d4(0xae)]({'success':![],'message':_0x2985d4(0xb7)});if(tokenBlacklistService_1['tokenBlacklistService'][_0x2985d4(0xac)](_0x3ad0ca))return _0x3c6897[_0x2985d4(0xa2)](0x191)['json']({'success':![],'message':_0x2985d4(0xc3)});jsonwebtoken_1['default'][_0x2985d4(0xbf)](_0x3ad0ca,config_1['config'][_0x2985d4(0xb4)]['secret'],(_0x8c960a,_0x5a0faf)=>{const _0x3cfa98=_0x2985d4;if(_0x8c960a)return _0x3c6897[_0x3cfa98(0xa2)](0x193)[_0x3cfa98(0xae)]({'success':![],'message':_0x3cfa98(0xa9)});_0x179fee[_0x3cfa98(0xa3)]=_0x5a0faf,_0x179fee[_0x3cfa98(0xc4)]=_0x3ad0ca,_0x574d81();});};exports[a16_0x21c435(0xc9)]=authenticateToken;const requireAdmin=(_0x2a4931,_0x1c62fc,_0x3798cf)=>{const _0x5b2c6a=a16_0x21c435;if(!_0x2a4931['user']||_0x2a4931['user'][_0x5b2c6a(0xbe)]!==_0x5b2c6a(0xab))return _0x1c62fc[_0x5b2c6a(0xa2)](0x193)[_0x5b2c6a(0xae)]({'success':![],'message':_0x5b2c6a(0xba)});_0x3798cf();};exports['requireAdmin']=requireAdmin;const requireShop=(_0xdf72e8,_0x16cdd1,_0x5397fd)=>{const _0x43a02c=a16_0x21c435;if(!_0xdf72e8[_0x43a02c(0xa3)]||_0xdf72e8[_0x43a02c(0xa3)]['role']!==_0x43a02c(0xbb))return _0x16cdd1['status'](0x193)['json']({'success':![],'message':'Shop\x20access\x20required'});_0x5397fd();};exports[a16_0x21c435(0xad)]=requireShop;function a16_0x5c5e(){const _0x4f9097=['Invalid\x20or\x20expired\x20token','5408576CVPRPL','admin','isTokenBlacklisted','requireShop','json','1022674rBCyVN','Error\x20checking\x20account\x20status','findUnique','requireActiveShop','ACTIVE','jwt','Account\x20is\x20suspended\x20or\x20inactive.\x20Contact\x20administrator\x20to\x20activate\x20your\x20account.','../config/database','Access\x20token\x20required','__esModule','jsonwebtoken','Admin\x20access\x20required','shop','Shop\x20access\x20required','split','role','verify','2965708wHURTV','5511215ORUycq','SUSPENDED','Token\x20has\x20been\x20revoked','token','400350PASZCG','error','3192098pIOFgB','headers','authenticateToken','__importDefault','authorization','status','user','1178586WcrAlL','defineProperty','6ulKlUH','Error\x20checking\x20account\x20status:','../services/tokenBlacklistService'];a16_0x5c5e=function(){return _0x4f9097;};return a16_0x5c5e();}const requireActiveShop=async(_0x4be45f,_0x5dad05,_0x5cf06d)=>{const _0xa3be60=a16_0x21c435;if(!_0x4be45f[_0xa3be60(0xa3)]||_0x4be45f[_0xa3be60(0xa3)][_0xa3be60(0xbe)]!==_0xa3be60(0xbb))return _0x5dad05[_0xa3be60(0xa2)](0x193)[_0xa3be60(0xae)]({'success':![],'message':_0xa3be60(0xbc)});try{const _0x4548df=require(_0xa3be60(0xb6))['default'],_0x351936=await _0x4548df[_0xa3be60(0xbb)][_0xa3be60(0xb1)]({'where':{'id':_0x4be45f[_0xa3be60(0xa3)]['id']},'select':{'status':!![]}});if(!_0x351936||_0x351936[_0xa3be60(0xa2)]!==_0xa3be60(0xb3))return _0x5dad05[_0xa3be60(0xa2)](0x193)[_0xa3be60(0xae)]({'success':![],'message':_0xa3be60(0xb5),'suspended':_0x351936?.[_0xa3be60(0xa2)]===_0xa3be60(0xc2)});_0x5cf06d();}catch(_0x1b47cc){return console[_0xa3be60(0xc6)](_0xa3be60(0xa7),_0x1b47cc),_0x5dad05[_0xa3be60(0xa2)](0x1f4)[_0xa3be60(0xae)]({'success':![],'message':_0xa3be60(0xb0)});}};exports[a16_0x21c435(0xb2)]=requireActiveShop;