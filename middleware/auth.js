'use strict';const a16_0x56cde9=a16_0x45a2;function a16_0x45a2(_0x4bc1a8,_0xfa0887){const _0x1a76df=a16_0x1a76();return a16_0x45a2=function(_0x45a2ca,_0x130f95){_0x45a2ca=_0x45a2ca-0x1cd;let _0x112124=_0x1a76df[_0x45a2ca];return _0x112124;},a16_0x45a2(_0x4bc1a8,_0xfa0887);}(function(_0x43ee34,_0x801ddd){const _0x479c8a=a16_0x45a2,_0x13abb4=_0x43ee34();while(!![]){try{const _0x3b53ff=-parseInt(_0x479c8a(0x1ec))/0x1+-parseInt(_0x479c8a(0x1f2))/0x2+parseInt(_0x479c8a(0x1dc))/0x3*(-parseInt(_0x479c8a(0x1df))/0x4)+-parseInt(_0x479c8a(0x1ef))/0x5+parseInt(_0x479c8a(0x1e1))/0x6+parseInt(_0x479c8a(0x1d1))/0x7*(parseInt(_0x479c8a(0x1f4))/0x8)+parseInt(_0x479c8a(0x1d8))/0x9;if(_0x3b53ff===_0x801ddd)break;else _0x13abb4['push'](_0x13abb4['shift']());}catch(_0x465b50){_0x13abb4['push'](_0x13abb4['shift']());}}}(a16_0x1a76,0x95be3));var __importDefault=this&&this[a16_0x56cde9(0x1e0)]||function(_0x4a4915){const _0x1ca907=a16_0x56cde9;return _0x4a4915&&_0x4a4915[_0x1ca907(0x1de)]?_0x4a4915:{'default':_0x4a4915};};Object[a16_0x56cde9(0x1d4)](exports,'__esModule',{'value':!![]}),exports[a16_0x56cde9(0x1fa)]=exports[a16_0x56cde9(0x1dd)]=exports[a16_0x56cde9(0x1ee)]=exports[a16_0x56cde9(0x1f7)]=void 0x0;const jsonwebtoken_1=__importDefault(require(a16_0x56cde9(0x1d9))),config_1=require('../config/config'),tokenBlacklistService_1=require(a16_0x56cde9(0x1d5)),authenticateToken=(_0x5711a2,_0x170024,_0x4980e2)=>{const _0x17d031=a16_0x56cde9,_0x2a04c1=_0x5711a2[_0x17d031(0x1e9)][_0x17d031(0x1cf)],_0x401fff=_0x2a04c1&&_0x2a04c1[_0x17d031(0x1db)]('\x20')[0x1];if(!_0x401fff)return _0x170024[_0x17d031(0x1e8)](0x191)[_0x17d031(0x1da)]({'success':![],'message':_0x17d031(0x1eb)});if(tokenBlacklistService_1[_0x17d031(0x1f9)][_0x17d031(0x1f3)](_0x401fff))return _0x170024[_0x17d031(0x1e8)](0x191)[_0x17d031(0x1da)]({'success':![],'message':_0x17d031(0x1f6)});jsonwebtoken_1[_0x17d031(0x1e2)][_0x17d031(0x1ea)](_0x401fff,config_1[_0x17d031(0x1d3)][_0x17d031(0x1e6)][_0x17d031(0x1d0)],(_0x1b7add,_0x52e528)=>{const _0x199a9c=_0x17d031;if(_0x1b7add)return _0x170024[_0x199a9c(0x1e8)](0x193)[_0x199a9c(0x1da)]({'success':![],'message':_0x199a9c(0x1d2)});_0x5711a2[_0x199a9c(0x1ed)]=_0x52e528,_0x5711a2[_0x199a9c(0x1e4)]=_0x401fff,_0x4980e2();});};exports[a16_0x56cde9(0x1f7)]=authenticateToken;const requireAdmin=(_0x157275,_0x1cdb54,_0x19714b)=>{const _0x2a563b=a16_0x56cde9;if(!_0x157275['user']||_0x157275[_0x2a563b(0x1ed)][_0x2a563b(0x1e7)]!==_0x2a563b(0x1f5))return _0x1cdb54['status'](0x193)[_0x2a563b(0x1da)]({'success':![],'message':_0x2a563b(0x1ce)});_0x19714b();};function a16_0x1a76(){const _0x2e6178=['Invalid\x20or\x20expired\x20token','config','defineProperty','../services/tokenBlacklistService','Error\x20checking\x20account\x20status','findUnique','14520528CYhWpx','jsonwebtoken','json','split','2355RaflCJ','requireShop','__esModule','1676TonhON','__importDefault','698196UiXYdz','default','Shop\x20access\x20required','token','SUSPENDED','jwt','role','status','headers','verify','Access\x20token\x20required','842807hEWemu','user','requireAdmin','1542860qGnooj','error','Error\x20checking\x20account\x20status:','748214mVXmkh','isTokenBlacklisted','590392yUXswQ','admin','Token\x20has\x20been\x20revoked','authenticateToken','ACTIVE','tokenBlacklistService','requireActiveShop','shop','Admin\x20access\x20required','authorization','secret','70RzKQow'];a16_0x1a76=function(){return _0x2e6178;};return a16_0x1a76();}exports['requireAdmin']=requireAdmin;const requireShop=(_0x34a1b1,_0x3504ff,_0x424943)=>{const _0x3cbc8d=a16_0x56cde9;if(!_0x34a1b1['user']||_0x34a1b1[_0x3cbc8d(0x1ed)][_0x3cbc8d(0x1e7)]!=='shop')return _0x3504ff['status'](0x193)[_0x3cbc8d(0x1da)]({'success':![],'message':_0x3cbc8d(0x1e3)});_0x424943();};exports[a16_0x56cde9(0x1dd)]=requireShop;const requireActiveShop=async(_0x353b59,_0x4fc1e5,_0x9a1d3c)=>{const _0x2b2dd6=a16_0x56cde9;if(!_0x353b59[_0x2b2dd6(0x1ed)]||_0x353b59['user'][_0x2b2dd6(0x1e7)]!==_0x2b2dd6(0x1cd))return _0x4fc1e5['status'](0x193)[_0x2b2dd6(0x1da)]({'success':![],'message':'Shop\x20access\x20required'});try{const _0x25353a=require('../config/database')['default'],_0x4dd115=await _0x25353a[_0x2b2dd6(0x1cd)][_0x2b2dd6(0x1d7)]({'where':{'id':_0x353b59['user']['id']},'select':{'status':!![]}});if(!_0x4dd115||_0x4dd115[_0x2b2dd6(0x1e8)]!==_0x2b2dd6(0x1f8))return _0x4fc1e5[_0x2b2dd6(0x1e8)](0x193)['json']({'success':![],'message':'Account\x20is\x20suspended\x20or\x20inactive.\x20Contact\x20administrator\x20to\x20activate\x20your\x20account.','suspended':_0x4dd115?.[_0x2b2dd6(0x1e8)]===_0x2b2dd6(0x1e5)});_0x9a1d3c();}catch(_0x20a24e){return console[_0x2b2dd6(0x1f0)](_0x2b2dd6(0x1f1),_0x20a24e),_0x4fc1e5['status'](0x1f4)[_0x2b2dd6(0x1da)]({'success':![],'message':_0x2b2dd6(0x1d6)});}};exports[a16_0x56cde9(0x1fa)]=requireActiveShop;