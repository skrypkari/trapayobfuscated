'use strict';const a16_0x2754d3=a16_0x38d1;function a16_0x3fbd(){const _0x20de9e=['33dHFGdR','shop','4926AlwBrH','headers','isTokenBlacklisted','requireActiveShop','verify','json','Access\x20token\x20required','../config/config','10hqjgSs','../services/tokenBlacklistService','Error\x20checking\x20account\x20status:','Shop\x20access\x20required','14tspDnm','Admin\x20access\x20required','authenticateToken','jsonwebtoken','user','__importDefault','SUSPENDED','requireShop','token','tokenBlacklistService','__esModule','error','15644772qgPdlZ','8531721ACEfFW','defineProperty','findUnique','admin','default','4600qguaNz','Invalid\x20or\x20expired\x20token','Error\x20checking\x20account\x20status','Account\x20is\x20suspended\x20or\x20inactive.\x20Contact\x20administrator\x20to\x20activate\x20your\x20account.','415638KLLNQE','role','134455GpOCpl','split','733481HmenTH','../config/database','status','24HkUUns','1300624MnnXlr','requireAdmin'];a16_0x3fbd=function(){return _0x20de9e;};return a16_0x3fbd();}function a16_0x38d1(_0x2ab88a,_0x15f989){const _0x3fbd38=a16_0x3fbd();return a16_0x38d1=function(_0x38d10a,_0x31a69c){_0x38d10a=_0x38d10a-0x11e;let _0x37c091=_0x3fbd38[_0x38d10a];return _0x37c091;},a16_0x38d1(_0x2ab88a,_0x15f989);}(function(_0x2fe5de,_0x17e94b){const _0x363e85=a16_0x38d1,_0x36a8b1=_0x2fe5de();while(!![]){try{const _0x3092fb=parseInt(_0x363e85(0x148))/0x1*(-parseInt(_0x363e85(0x130))/0x2)+-parseInt(_0x363e85(0x146))/0x3+-parseInt(_0x363e85(0x120))/0x4+parseInt(_0x363e85(0x142))/0x5*(-parseInt(_0x363e85(0x124))/0x6)+parseInt(_0x363e85(0x14a))/0x7*(-parseInt(_0x363e85(0x11f))/0x8)+-parseInt(_0x363e85(0x13d))/0x9*(parseInt(_0x363e85(0x12c))/0xa)+parseInt(_0x363e85(0x122))/0xb*(parseInt(_0x363e85(0x13c))/0xc);if(_0x3092fb===_0x17e94b)break;else _0x36a8b1['push'](_0x36a8b1['shift']());}catch(_0x53c08f){_0x36a8b1['push'](_0x36a8b1['shift']());}}}(a16_0x3fbd,0x774dc));var __importDefault=this&&this[a16_0x2754d3(0x135)]||function(_0x41132c){const _0x9abbb5=a16_0x2754d3;return _0x41132c&&_0x41132c[_0x9abbb5(0x13a)]?_0x41132c:{'default':_0x41132c};};Object[a16_0x2754d3(0x13e)](exports,a16_0x2754d3(0x13a),{'value':!![]}),exports[a16_0x2754d3(0x127)]=exports[a16_0x2754d3(0x137)]=exports[a16_0x2754d3(0x121)]=exports[a16_0x2754d3(0x132)]=void 0x0;const jsonwebtoken_1=__importDefault(require(a16_0x2754d3(0x133))),config_1=require(a16_0x2754d3(0x12b)),tokenBlacklistService_1=require(a16_0x2754d3(0x12d)),authenticateToken=(_0x2c8fdd,_0x23367b,_0xa6a4b)=>{const _0x482b46=a16_0x2754d3,_0x5c2cbb=_0x2c8fdd[_0x482b46(0x125)]['authorization'],_0x189346=_0x5c2cbb&&_0x5c2cbb[_0x482b46(0x149)]('\x20')[0x1];if(!_0x189346)return _0x23367b[_0x482b46(0x11e)](0x191)[_0x482b46(0x129)]({'success':![],'message':_0x482b46(0x12a)});if(tokenBlacklistService_1[_0x482b46(0x139)][_0x482b46(0x126)](_0x189346))return _0x23367b[_0x482b46(0x11e)](0x191)['json']({'success':![],'message':'Token\x20has\x20been\x20revoked'});jsonwebtoken_1[_0x482b46(0x141)][_0x482b46(0x128)](_0x189346,config_1['config']['jwt']['secret'],(_0x4c8abb,_0x26f616)=>{const _0xbe7aa3=_0x482b46;if(_0x4c8abb)return _0x23367b[_0xbe7aa3(0x11e)](0x193)[_0xbe7aa3(0x129)]({'success':![],'message':_0xbe7aa3(0x143)});_0x2c8fdd[_0xbe7aa3(0x134)]=_0x26f616,_0x2c8fdd[_0xbe7aa3(0x138)]=_0x189346,_0xa6a4b();});};exports[a16_0x2754d3(0x132)]=authenticateToken;const requireAdmin=(_0x51e685,_0x20f4ed,_0x5e512c)=>{const _0x26f520=a16_0x2754d3;if(!_0x51e685[_0x26f520(0x134)]||_0x51e685[_0x26f520(0x134)][_0x26f520(0x147)]!==_0x26f520(0x140))return _0x20f4ed[_0x26f520(0x11e)](0x193)[_0x26f520(0x129)]({'success':![],'message':_0x26f520(0x131)});_0x5e512c();};exports['requireAdmin']=requireAdmin;const requireShop=(_0x59e31f,_0x40c8d2,_0x1d38c0)=>{const _0x1dcb93=a16_0x2754d3;if(!_0x59e31f[_0x1dcb93(0x134)]||_0x59e31f[_0x1dcb93(0x134)]['role']!==_0x1dcb93(0x123))return _0x40c8d2[_0x1dcb93(0x11e)](0x193)[_0x1dcb93(0x129)]({'success':![],'message':_0x1dcb93(0x12f)});_0x1d38c0();};exports['requireShop']=requireShop;const requireActiveShop=async(_0xfe21cf,_0x5a2819,_0x57a410)=>{const _0x2478ad=a16_0x2754d3;if(!_0xfe21cf[_0x2478ad(0x134)]||_0xfe21cf['user'][_0x2478ad(0x147)]!==_0x2478ad(0x123))return _0x5a2819[_0x2478ad(0x11e)](0x193)[_0x2478ad(0x129)]({'success':![],'message':_0x2478ad(0x12f)});try{const _0x5c4896=require(_0x2478ad(0x14b))[_0x2478ad(0x141)],_0x2ffd11=await _0x5c4896[_0x2478ad(0x123)][_0x2478ad(0x13f)]({'where':{'id':_0xfe21cf[_0x2478ad(0x134)]['id']},'select':{'status':!![]}});if(!_0x2ffd11||_0x2ffd11[_0x2478ad(0x11e)]!=='ACTIVE')return _0x5a2819['status'](0x193)[_0x2478ad(0x129)]({'success':![],'message':_0x2478ad(0x145),'suspended':_0x2ffd11?.[_0x2478ad(0x11e)]===_0x2478ad(0x136)});_0x57a410();}catch(_0x5c68de){return console[_0x2478ad(0x13b)](_0x2478ad(0x12e),_0x5c68de),_0x5a2819[_0x2478ad(0x11e)](0x1f4)[_0x2478ad(0x129)]({'success':![],'message':_0x2478ad(0x144)});}};exports[a16_0x2754d3(0x127)]=requireActiveShop;