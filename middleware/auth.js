'use strict';function a16_0x345a(_0x1897c0,_0x2c16e1){const _0x49c06f=a16_0x49c0();return a16_0x345a=function(_0x345a57,_0x5c9244){_0x345a57=_0x345a57-0x92;let _0x3afd24=_0x49c06f[_0x345a57];return _0x3afd24;},a16_0x345a(_0x1897c0,_0x2c16e1);}const a16_0x511ae8=a16_0x345a;(function(_0x5e8fec,_0x4509dd){const _0x2ab1d4=a16_0x345a,_0x4363b2=_0x5e8fec();while(!![]){try{const _0x39ad75=parseInt(_0x2ab1d4(0x94))/0x1+parseInt(_0x2ab1d4(0x98))/0x2+parseInt(_0x2ab1d4(0x9e))/0x3*(parseInt(_0x2ab1d4(0xa3))/0x4)+parseInt(_0x2ab1d4(0x96))/0x5+-parseInt(_0x2ab1d4(0x9a))/0x6*(-parseInt(_0x2ab1d4(0xa4))/0x7)+-parseInt(_0x2ab1d4(0xb0))/0x8*(-parseInt(_0x2ab1d4(0x9d))/0x9)+-parseInt(_0x2ab1d4(0xa6))/0xa;if(_0x39ad75===_0x4509dd)break;else _0x4363b2['push'](_0x4363b2['shift']());}catch(_0x2522bb){_0x4363b2['push'](_0x4363b2['shift']());}}}(a16_0x49c0,0xb45fb));var __importDefault=this&&this[a16_0x511ae8(0xac)]||function(_0x3edee6){const _0x2806c4=a16_0x511ae8;return _0x3edee6&&_0x3edee6[_0x2806c4(0xaa)]?_0x3edee6:{'default':_0x3edee6};};Object[a16_0x511ae8(0xab)](exports,a16_0x511ae8(0xaa),{'value':!![]}),exports[a16_0x511ae8(0x93)]=exports[a16_0x511ae8(0xa9)]=exports[a16_0x511ae8(0xb5)]=exports[a16_0x511ae8(0x9b)]=void 0x0;const jsonwebtoken_1=__importDefault(require('jsonwebtoken')),config_1=require(a16_0x511ae8(0x99)),tokenBlacklistService_1=require(a16_0x511ae8(0xa5)),authenticateToken=(_0x413fc,_0x1e2e83,_0x50abd5)=>{const _0x1cb0ac=a16_0x511ae8,_0x323af1=_0x413fc[_0x1cb0ac(0xb2)][_0x1cb0ac(0xbd)],_0x569f31=_0x323af1&&_0x323af1['split']('\x20')[0x1];if(!_0x569f31)return _0x1e2e83[_0x1cb0ac(0xbc)](0x191)[_0x1cb0ac(0xa1)]({'success':![],'message':_0x1cb0ac(0xb8)});if(tokenBlacklistService_1[_0x1cb0ac(0xa8)][_0x1cb0ac(0xae)](_0x569f31))return _0x1e2e83[_0x1cb0ac(0xbc)](0x191)[_0x1cb0ac(0xa1)]({'success':![],'message':_0x1cb0ac(0xb6)});jsonwebtoken_1[_0x1cb0ac(0xa7)][_0x1cb0ac(0xbe)](_0x569f31,config_1[_0x1cb0ac(0x97)][_0x1cb0ac(0xad)][_0x1cb0ac(0xaf)],(_0x6711d4,_0x88599a)=>{const _0x3a68dc=_0x1cb0ac;if(_0x6711d4)return _0x1e2e83['status'](0x193)[_0x3a68dc(0xa1)]({'success':![],'message':_0x3a68dc(0x9f)});_0x413fc[_0x3a68dc(0xc0)]=_0x88599a,_0x413fc[_0x3a68dc(0xb4)]=_0x569f31,_0x50abd5();});};exports[a16_0x511ae8(0x9b)]=authenticateToken;const requireAdmin=(_0x478774,_0x12eb44,_0x17c8d5)=>{const _0x1d6ad1=a16_0x511ae8;if(!_0x478774['user']||_0x478774[_0x1d6ad1(0xc0)][_0x1d6ad1(0x9c)]!==_0x1d6ad1(0x92))return _0x12eb44[_0x1d6ad1(0xbc)](0x193)['json']({'success':![],'message':_0x1d6ad1(0xa0)});_0x17c8d5();};exports[a16_0x511ae8(0xb5)]=requireAdmin;const requireShop=(_0x266d31,_0x37dc86,_0x1e3973)=>{const _0xf79dc7=a16_0x511ae8;if(!_0x266d31[_0xf79dc7(0xc0)]||_0x266d31[_0xf79dc7(0xc0)][_0xf79dc7(0x9c)]!==_0xf79dc7(0xb7))return _0x37dc86[_0xf79dc7(0xbc)](0x193)[_0xf79dc7(0xa1)]({'success':![],'message':_0xf79dc7(0xa2)});_0x1e3973();};function a16_0x49c0(){const _0x37ebb1=['jwt','isTokenBlacklisted','secret','6667576TsHKhS','Error\x20checking\x20account\x20status:','headers','../config/database','token','requireAdmin','Token\x20has\x20been\x20revoked','shop','Access\x20token\x20required','Error\x20checking\x20account\x20status','Account\x20is\x20suspended\x20or\x20inactive.\x20Contact\x20administrator\x20to\x20activate\x20your\x20account.','error','status','authorization','verify','findUnique','user','admin','requireActiveShop','1078975OvTABb','ACTIVE','64575haEepe','config','2469490LOoHjP','../config/config','378966PSpEpI','authenticateToken','role','9OeWuEa','795813VLswTY','Invalid\x20or\x20expired\x20token','Admin\x20access\x20required','json','Shop\x20access\x20required','4NcWBoD','14hVLfuc','../services/tokenBlacklistService','28128640PIRPSi','default','tokenBlacklistService','requireShop','__esModule','defineProperty','__importDefault'];a16_0x49c0=function(){return _0x37ebb1;};return a16_0x49c0();}exports['requireShop']=requireShop;const requireActiveShop=async(_0xa0d9b,_0x5d0f7c,_0x4b9efb)=>{const _0x58adf5=a16_0x511ae8;if(!_0xa0d9b[_0x58adf5(0xc0)]||_0xa0d9b[_0x58adf5(0xc0)]['role']!==_0x58adf5(0xb7))return _0x5d0f7c[_0x58adf5(0xbc)](0x193)[_0x58adf5(0xa1)]({'success':![],'message':_0x58adf5(0xa2)});try{const _0x3594b3=require(_0x58adf5(0xb3))[_0x58adf5(0xa7)],_0x5cf07b=await _0x3594b3[_0x58adf5(0xb7)][_0x58adf5(0xbf)]({'where':{'id':_0xa0d9b[_0x58adf5(0xc0)]['id']},'select':{'status':!![]}});if(!_0x5cf07b||_0x5cf07b[_0x58adf5(0xbc)]!==_0x58adf5(0x95))return _0x5d0f7c['status'](0x193)['json']({'success':![],'message':_0x58adf5(0xba),'suspended':_0x5cf07b?.[_0x58adf5(0xbc)]==='SUSPENDED'});_0x4b9efb();}catch(_0x102c03){return console[_0x58adf5(0xbb)](_0x58adf5(0xb1),_0x102c03),_0x5d0f7c[_0x58adf5(0xbc)](0x1f4)[_0x58adf5(0xa1)]({'success':![],'message':_0x58adf5(0xb9)});}};exports['requireActiveShop']=requireActiveShop;