'use strict';const a16_0x3884fd=a16_0x583d;(function(_0x2ebf1f,_0x36577f){const _0x490850=a16_0x583d,_0x3a6cbd=_0x2ebf1f();while(!![]){try{const _0xa99e4f=parseInt(_0x490850(0x10d))/0x1*(-parseInt(_0x490850(0x11a))/0x2)+-parseInt(_0x490850(0x11e))/0x3*(-parseInt(_0x490850(0xf2))/0x4)+-parseInt(_0x490850(0x114))/0x5*(-parseInt(_0x490850(0x103))/0x6)+-parseInt(_0x490850(0xfb))/0x7*(parseInt(_0x490850(0x107))/0x8)+-parseInt(_0x490850(0x116))/0x9+parseInt(_0x490850(0xfe))/0xa+-parseInt(_0x490850(0x111))/0xb*(-parseInt(_0x490850(0x105))/0xc);if(_0xa99e4f===_0x36577f)break;else _0x3a6cbd['push'](_0x3a6cbd['shift']());}catch(_0x3f6e56){_0x3a6cbd['push'](_0x3a6cbd['shift']());}}}(a16_0x4b7b,0x541f5));function a16_0x583d(_0x271af1,_0x514f6f){const _0x4b7b20=a16_0x4b7b();return a16_0x583d=function(_0x583db3,_0x254607){_0x583db3=_0x583db3-0xf0;let _0x30a886=_0x4b7b20[_0x583db3];return _0x30a886;},a16_0x583d(_0x271af1,_0x514f6f);}var __importDefault=this&&this[a16_0x3884fd(0x10f)]||function(_0x593403){const _0x4ec4d6=a16_0x3884fd;return _0x593403&&_0x593403[_0x4ec4d6(0x117)]?_0x593403:{'default':_0x593403};};Object['defineProperty'](exports,'__esModule',{'value':!![]}),exports[a16_0x3884fd(0xf6)]=exports[a16_0x3884fd(0xf1)]=exports['requireAdmin']=exports[a16_0x3884fd(0x11d)]=void 0x0;const jsonwebtoken_1=__importDefault(require(a16_0x3884fd(0xf5))),config_1=require(a16_0x3884fd(0x100)),tokenBlacklistService_1=require(a16_0x3884fd(0x119)),authenticateToken=(_0x29b8c0,_0x45da55,_0x59fdc1)=>{const _0x514baa=a16_0x3884fd,_0x3d22de=_0x29b8c0['headers'][_0x514baa(0x106)],_0x46b6f3=_0x3d22de&&_0x3d22de[_0x514baa(0x10a)]('\x20')[0x1];if(!_0x46b6f3)return _0x45da55[_0x514baa(0x11b)](0x191)[_0x514baa(0xfc)]({'success':![],'message':_0x514baa(0xf7)});if(tokenBlacklistService_1[_0x514baa(0x102)][_0x514baa(0x101)](_0x46b6f3))return _0x45da55[_0x514baa(0x11b)](0x191)['json']({'success':![],'message':_0x514baa(0x10e)});jsonwebtoken_1[_0x514baa(0xfa)]['verify'](_0x46b6f3,config_1[_0x514baa(0x109)][_0x514baa(0x112)][_0x514baa(0xf0)],(_0x30f4fa,_0x3c2e2c)=>{const _0x38de13=_0x514baa;if(_0x30f4fa)return _0x45da55[_0x38de13(0x11b)](0x193)['json']({'success':![],'message':_0x38de13(0x104)});_0x29b8c0[_0x38de13(0x118)]=_0x3c2e2c,_0x29b8c0[_0x38de13(0x10c)]=_0x46b6f3,_0x59fdc1();});};function a16_0x4b7b(){const _0x31125a=['admin','7073yMZTsY','jwt','role','1175uVfIqq','shop','5933925kugAcB','__esModule','user','../services/tokenBlacklistService','157246vwbIgW','status','Admin\x20access\x20required','authenticateToken','30yfNKmm','secret','requireShop','174412nrHCdZ','Shop\x20access\x20required','findUnique','jsonwebtoken','requireActiveShop','Access\x20token\x20required','Error\x20checking\x20account\x20status:','Account\x20is\x20suspended\x20or\x20inactive.\x20Contact\x20administrator\x20to\x20activate\x20your\x20account.','default','35nLYPHh','json','ACTIVE','2366380aIjGhz','requireAdmin','../config/config','isTokenBlacklisted','tokenBlacklistService','9426qZOftk','Invalid\x20or\x20expired\x20token','13128mdtqvl','authorization','557264joahfv','../config/database','config','split','SUSPENDED','token','5JALtKW','Token\x20has\x20been\x20revoked','__importDefault'];a16_0x4b7b=function(){return _0x31125a;};return a16_0x4b7b();}exports[a16_0x3884fd(0x11d)]=authenticateToken;const requireAdmin=(_0x40330d,_0x5002f4,_0xbf2e01)=>{const _0x462824=a16_0x3884fd;if(!_0x40330d['user']||_0x40330d['user']['role']!==_0x462824(0x110))return _0x5002f4[_0x462824(0x11b)](0x193)[_0x462824(0xfc)]({'success':![],'message':_0x462824(0x11c)});_0xbf2e01();};exports[a16_0x3884fd(0xff)]=requireAdmin;const requireShop=(_0xe88341,_0x1238f5,_0x5a7604)=>{const _0x3352ac=a16_0x3884fd;if(!_0xe88341[_0x3352ac(0x118)]||_0xe88341[_0x3352ac(0x118)][_0x3352ac(0x113)]!=='shop')return _0x1238f5[_0x3352ac(0x11b)](0x193)[_0x3352ac(0xfc)]({'success':![],'message':_0x3352ac(0xf3)});_0x5a7604();};exports[a16_0x3884fd(0xf1)]=requireShop;const requireActiveShop=async(_0x3b9acd,_0x5006c1,_0x2c3bd4)=>{const _0x112f40=a16_0x3884fd;if(!_0x3b9acd[_0x112f40(0x118)]||_0x3b9acd[_0x112f40(0x118)][_0x112f40(0x113)]!=='shop')return _0x5006c1[_0x112f40(0x11b)](0x193)[_0x112f40(0xfc)]({'success':![],'message':_0x112f40(0xf3)});try{const _0x5bb1bb=require(_0x112f40(0x108))[_0x112f40(0xfa)],_0x855219=await _0x5bb1bb[_0x112f40(0x115)][_0x112f40(0xf4)]({'where':{'id':_0x3b9acd['user']['id']},'select':{'status':!![]}});if(!_0x855219||_0x855219[_0x112f40(0x11b)]!==_0x112f40(0xfd))return _0x5006c1[_0x112f40(0x11b)](0x193)[_0x112f40(0xfc)]({'success':![],'message':_0x112f40(0xf9),'suspended':_0x855219?.[_0x112f40(0x11b)]===_0x112f40(0x10b)});_0x2c3bd4();}catch(_0x527927){return console['error'](_0x112f40(0xf8),_0x527927),_0x5006c1[_0x112f40(0x11b)](0x1f4)[_0x112f40(0xfc)]({'success':![],'message':'Error\x20checking\x20account\x20status'});}};exports[a16_0x3884fd(0xf6)]=requireActiveShop;