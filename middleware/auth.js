'use strict';function a16_0xcfd8(){const _0x514dca=['shop','../config/database','secret','Error\x20checking\x20account\x20status','26800irTEuY','Token\x20has\x20been\x20revoked','jsonwebtoken','findUnique','authenticateToken','Account\x20is\x20suspended\x20or\x20inactive.\x20Contact\x20administrator\x20to\x20activate\x20your\x20account.','SUSPENDED','verify','__esModule','../config/config','error','requireActiveShop','2570usomfp','__importDefault','requireShop','202986MRYbhZ','headers','user','config','Invalid\x20or\x20expired\x20token','17501fGHCHP','3398760EHolOH','140niDHRm','status','role','defineProperty','24BFsleK','7761qHyGCQ','Admin\x20access\x20required','json','requireAdmin','token','default','13629auKPqI','56oIDIpP','2270007KSWqjc','jwt'];a16_0xcfd8=function(){return _0x514dca;};return a16_0xcfd8();}const a16_0x1852a6=a16_0x43dd;(function(_0xa69d9b,_0x530b7e){const _0xb2bb3c=a16_0x43dd,_0x4dd432=_0xa69d9b();while(!![]){try{const _0x462068=-parseInt(_0xb2bb3c(0x148))/0x1+-parseInt(_0xb2bb3c(0x153))/0x2*(parseInt(_0xb2bb3c(0x154))/0x3)+-parseInt(_0xb2bb3c(0x14f))/0x4*(-parseInt(_0xb2bb3c(0x139))/0x5)+parseInt(_0xb2bb3c(0x14e))/0x6+-parseInt(_0xb2bb3c(0x15a))/0x7*(-parseInt(_0xb2bb3c(0x15b))/0x8)+parseInt(_0xb2bb3c(0x15c))/0x9+parseInt(_0xb2bb3c(0x145))/0xa*(-parseInt(_0xb2bb3c(0x14d))/0xb);if(_0x462068===_0x530b7e)break;else _0x4dd432['push'](_0x4dd432['shift']());}catch(_0x49abf8){_0x4dd432['push'](_0x4dd432['shift']());}}}(a16_0xcfd8,0x5c0a3));var __importDefault=this&&this[a16_0x1852a6(0x146)]||function(_0x209d2c){const _0x349248=a16_0x1852a6;return _0x209d2c&&_0x209d2c[_0x349248(0x141)]?_0x209d2c:{'default':_0x209d2c};};Object[a16_0x1852a6(0x152)](exports,a16_0x1852a6(0x141),{'value':!![]}),exports[a16_0x1852a6(0x144)]=exports[a16_0x1852a6(0x147)]=exports[a16_0x1852a6(0x157)]=exports[a16_0x1852a6(0x13d)]=void 0x0;const jsonwebtoken_1=__importDefault(require(a16_0x1852a6(0x13b))),config_1=require(a16_0x1852a6(0x142)),tokenBlacklistService_1=require('../services/tokenBlacklistService'),authenticateToken=(_0x26a628,_0x9d8cc,_0x3aa454)=>{const _0x3264a0=a16_0x1852a6,_0x52f51e=_0x26a628[_0x3264a0(0x149)]['authorization'],_0x31d280=_0x52f51e&&_0x52f51e['split']('\x20')[0x1];if(!_0x31d280)return _0x9d8cc['status'](0x191)[_0x3264a0(0x156)]({'success':![],'message':'Access\x20token\x20required'});if(tokenBlacklistService_1['tokenBlacklistService']['isTokenBlacklisted'](_0x31d280))return _0x9d8cc[_0x3264a0(0x150)](0x191)[_0x3264a0(0x156)]({'success':![],'message':_0x3264a0(0x13a)});jsonwebtoken_1[_0x3264a0(0x159)][_0x3264a0(0x140)](_0x31d280,config_1[_0x3264a0(0x14b)][_0x3264a0(0x15d)][_0x3264a0(0x137)],(_0x30485a,_0x516246)=>{const _0x59b5ae=_0x3264a0;if(_0x30485a)return _0x9d8cc[_0x59b5ae(0x150)](0x193)[_0x59b5ae(0x156)]({'success':![],'message':_0x59b5ae(0x14c)});_0x26a628['user']=_0x516246,_0x26a628[_0x59b5ae(0x158)]=_0x31d280,_0x3aa454();});};exports[a16_0x1852a6(0x13d)]=authenticateToken;function a16_0x43dd(_0x341450,_0x314854){const _0xcfd84c=a16_0xcfd8();return a16_0x43dd=function(_0x43dd34,_0x58b220){_0x43dd34=_0x43dd34-0x136;let _0x18410e=_0xcfd84c[_0x43dd34];return _0x18410e;},a16_0x43dd(_0x341450,_0x314854);}const requireAdmin=(_0xad68c8,_0x5132db,_0x48a7c9)=>{const _0x2aa092=a16_0x1852a6;if(!_0xad68c8[_0x2aa092(0x14a)]||_0xad68c8[_0x2aa092(0x14a)][_0x2aa092(0x151)]!=='admin')return _0x5132db[_0x2aa092(0x150)](0x193)[_0x2aa092(0x156)]({'success':![],'message':_0x2aa092(0x155)});_0x48a7c9();};exports[a16_0x1852a6(0x157)]=requireAdmin;const requireShop=(_0xbb8cc4,_0x13b5aa,_0x45a3e3)=>{const _0x5bf58a=a16_0x1852a6;if(!_0xbb8cc4[_0x5bf58a(0x14a)]||_0xbb8cc4['user']['role']!==_0x5bf58a(0x15e))return _0x13b5aa['status'](0x193)[_0x5bf58a(0x156)]({'success':![],'message':'Shop\x20access\x20required'});_0x45a3e3();};exports['requireShop']=requireShop;const requireActiveShop=async(_0x126801,_0x155307,_0x460cdd)=>{const _0x9e5efb=a16_0x1852a6;if(!_0x126801[_0x9e5efb(0x14a)]||_0x126801[_0x9e5efb(0x14a)][_0x9e5efb(0x151)]!==_0x9e5efb(0x15e))return _0x155307[_0x9e5efb(0x150)](0x193)[_0x9e5efb(0x156)]({'success':![],'message':'Shop\x20access\x20required'});try{const _0x57fee7=require(_0x9e5efb(0x136))[_0x9e5efb(0x159)],_0x500a50=await _0x57fee7[_0x9e5efb(0x15e)][_0x9e5efb(0x13c)]({'where':{'id':_0x126801[_0x9e5efb(0x14a)]['id']},'select':{'status':!![]}});if(!_0x500a50||_0x500a50['status']!=='ACTIVE')return _0x155307[_0x9e5efb(0x150)](0x193)['json']({'success':![],'message':_0x9e5efb(0x13e),'suspended':_0x500a50?.[_0x9e5efb(0x150)]===_0x9e5efb(0x13f)});_0x460cdd();}catch(_0x1e6066){return console[_0x9e5efb(0x143)]('Error\x20checking\x20account\x20status:',_0x1e6066),_0x155307[_0x9e5efb(0x150)](0x1f4)[_0x9e5efb(0x156)]({'success':![],'message':_0x9e5efb(0x138)});}};exports[a16_0x1852a6(0x144)]=requireActiveShop;