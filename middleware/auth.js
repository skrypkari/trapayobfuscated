'use strict';function a17_0x5b26(_0xfa4997,_0x4375cd){const _0x31b1fd=a17_0x31b1();return a17_0x5b26=function(_0x5b260c,_0x4d802c){_0x5b260c=_0x5b260c-0x148;let _0x1c6e45=_0x31b1fd[_0x5b260c];return _0x1c6e45;},a17_0x5b26(_0xfa4997,_0x4375cd);}const a17_0x423630=a17_0x5b26;(function(_0x593a9d,_0x27c76b){const _0x2a1de4=a17_0x5b26,_0xf7514b=_0x593a9d();while(!![]){try{const _0x216986=-parseInt(_0x2a1de4(0x15e))/0x1+parseInt(_0x2a1de4(0x154))/0x2*(-parseInt(_0x2a1de4(0x148))/0x3)+-parseInt(_0x2a1de4(0x15d))/0x4*(-parseInt(_0x2a1de4(0x14d))/0x5)+parseInt(_0x2a1de4(0x16f))/0x6*(-parseInt(_0x2a1de4(0x171))/0x7)+-parseInt(_0x2a1de4(0x152))/0x8+-parseInt(_0x2a1de4(0x16b))/0x9+-parseInt(_0x2a1de4(0x16c))/0xa*(-parseInt(_0x2a1de4(0x153))/0xb);if(_0x216986===_0x27c76b)break;else _0xf7514b['push'](_0xf7514b['shift']());}catch(_0x11d4fa){_0xf7514b['push'](_0xf7514b['shift']());}}}(a17_0x31b1,0x40bd0));var __importDefault=this&&this['__importDefault']||function(_0x3cc965){const _0x56f3d8=a17_0x5b26;return _0x3cc965&&_0x3cc965[_0x56f3d8(0x158)]?_0x3cc965:{'default':_0x3cc965};};Object[a17_0x423630(0x16a)](exports,a17_0x423630(0x158),{'value':!![]}),exports[a17_0x423630(0x16e)]=exports[a17_0x423630(0x150)]=exports[a17_0x423630(0x166)]=exports[a17_0x423630(0x149)]=void 0x0;const jsonwebtoken_1=__importDefault(require('jsonwebtoken')),config_1=require('../config/config'),tokenBlacklistService_1=require(a17_0x423630(0x14a)),authenticateToken=(_0x1591dd,_0x39e1c9,_0x136e40)=>{const _0x4cf7e3=a17_0x423630,_0x10c27d=_0x1591dd[_0x4cf7e3(0x14b)][_0x4cf7e3(0x14f)],_0x5c8d8f=_0x10c27d&&_0x10c27d['split']('\x20')[0x1];if(!_0x5c8d8f)return _0x39e1c9['status'](0x191)['json']({'success':![],'message':_0x4cf7e3(0x156)});if(tokenBlacklistService_1['tokenBlacklistService'][_0x4cf7e3(0x151)](_0x5c8d8f))return _0x39e1c9['status'](0x191)[_0x4cf7e3(0x170)]({'success':![],'message':_0x4cf7e3(0x14c)});jsonwebtoken_1['default'][_0x4cf7e3(0x161)](_0x5c8d8f,config_1[_0x4cf7e3(0x162)]['jwt'][_0x4cf7e3(0x169)],(_0x16c756,_0xb586b0)=>{const _0x280f82=_0x4cf7e3;if(_0x16c756)return _0x39e1c9[_0x280f82(0x168)](0x193)[_0x280f82(0x170)]({'success':![],'message':_0x280f82(0x14e)});_0x1591dd[_0x280f82(0x155)]=_0xb586b0,_0x1591dd[_0x280f82(0x15b)]=_0x5c8d8f,_0x136e40();});};function a17_0x31b1(){const _0x71522e=['Token\x20has\x20been\x20revoked','270DqHzoa','Invalid\x20or\x20expired\x20token','authorization','requireShop','isTokenBlacklisted','664784EfMFgZ','352RWNaAJ','42DWuddd','user','Access\x20token\x20required','Account\x20is\x20suspended\x20or\x20inactive.\x20Contact\x20administrator\x20to\x20activate\x20your\x20account.','__esModule','ACTIVE','SUSPENDED','token','default','29084tZQNmB','521350PgkDjt','Admin\x20access\x20required','role','verify','config','Shop\x20access\x20required','shop','Error\x20checking\x20account\x20status','requireAdmin','../config/database','status','secret','defineProperty','2770839hWwYNF','473610GrmCHy','findUnique','requireActiveShop','12OeeAyy','json','1356383sfRLNZ','49023xZIaHv','authenticateToken','../services/tokenBlacklistService','headers'];a17_0x31b1=function(){return _0x71522e;};return a17_0x31b1();}exports[a17_0x423630(0x149)]=authenticateToken;const requireAdmin=(_0x56be29,_0xf5574,_0x588a20)=>{const _0x33562b=a17_0x423630;if(!_0x56be29[_0x33562b(0x155)]||_0x56be29[_0x33562b(0x155)][_0x33562b(0x160)]!=='admin')return _0xf5574[_0x33562b(0x168)](0x193)['json']({'success':![],'message':_0x33562b(0x15f)});_0x588a20();};exports[a17_0x423630(0x166)]=requireAdmin;const requireShop=(_0x4a645a,_0x34edce,_0x56076e)=>{const _0x3d91b2=a17_0x423630;if(!_0x4a645a[_0x3d91b2(0x155)]||_0x4a645a[_0x3d91b2(0x155)][_0x3d91b2(0x160)]!==_0x3d91b2(0x164))return _0x34edce['status'](0x193)[_0x3d91b2(0x170)]({'success':![],'message':_0x3d91b2(0x163)});_0x56076e();};exports['requireShop']=requireShop;const requireActiveShop=async(_0x160a4b,_0x5d94bd,_0x2b55bb)=>{const _0x2caba1=a17_0x423630;if(!_0x160a4b[_0x2caba1(0x155)]||_0x160a4b[_0x2caba1(0x155)][_0x2caba1(0x160)]!=='shop')return _0x5d94bd[_0x2caba1(0x168)](0x193)[_0x2caba1(0x170)]({'success':![],'message':_0x2caba1(0x163)});try{const _0x30729d=require(_0x2caba1(0x167))[_0x2caba1(0x15c)],_0x657abc=await _0x30729d['shop'][_0x2caba1(0x16d)]({'where':{'id':_0x160a4b[_0x2caba1(0x155)]['id']},'select':{'status':!![]}});if(!_0x657abc||_0x657abc[_0x2caba1(0x168)]!==_0x2caba1(0x159))return _0x5d94bd['status'](0x193)['json']({'success':![],'message':_0x2caba1(0x157),'suspended':_0x657abc?.[_0x2caba1(0x168)]===_0x2caba1(0x15a)});_0x2b55bb();}catch(_0x5d2606){return console['error']('Error\x20checking\x20account\x20status:',_0x5d2606),_0x5d94bd[_0x2caba1(0x168)](0x1f4)[_0x2caba1(0x170)]({'success':![],'message':_0x2caba1(0x165)});}};exports[a17_0x423630(0x16e)]=requireActiveShop;