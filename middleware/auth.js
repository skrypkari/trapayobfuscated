'use strict';const a24_0x51ea6d=a24_0x235c;(function(_0x2d314f,_0x2a1857){const _0xe8571b=a24_0x235c,_0x3cf2bb=_0x2d314f();while(!![]){try{const _0x576f60=-parseInt(_0xe8571b(0x1f0))/0x1*(-parseInt(_0xe8571b(0x1ee))/0x2)+parseInt(_0xe8571b(0x1f4))/0x3*(-parseInt(_0xe8571b(0x1f2))/0x4)+parseInt(_0xe8571b(0x1e2))/0x5+parseInt(_0xe8571b(0x1ce))/0x6+-parseInt(_0xe8571b(0x1f3))/0x7*(parseInt(_0xe8571b(0x1df))/0x8)+parseInt(_0xe8571b(0x1e1))/0x9*(-parseInt(_0xe8571b(0x1d8))/0xa)+parseInt(_0xe8571b(0x1cc))/0xb;if(_0x576f60===_0x2a1857)break;else _0x3cf2bb['push'](_0x3cf2bb['shift']());}catch(_0x284e95){_0x3cf2bb['push'](_0x3cf2bb['shift']());}}}(a24_0xf082,0x36a2e));var __importDefault=this&&this[a24_0x51ea6d(0x1e0)]||function(_0x2f8fda){const _0x101b3a=a24_0x51ea6d;return _0x2f8fda&&_0x2f8fda[_0x101b3a(0x1e4)]?_0x2f8fda:{'default':_0x2f8fda};};Object[a24_0x51ea6d(0x1cf)](exports,a24_0x51ea6d(0x1e4),{'value':!![]}),exports[a24_0x51ea6d(0x1d7)]=exports['requireShop']=exports['requireAdmin']=exports[a24_0x51ea6d(0x1f5)]=void 0x0;const jsonwebtoken_1=__importDefault(require('jsonwebtoken')),config_1=require('../config/config'),tokenBlacklistService_1=require(a24_0x51ea6d(0x1f6)),authenticateToken=(_0x14e74f,_0xc3a5fc,_0x23fd78)=>{const _0x54c560=a24_0x51ea6d,_0x501be5=_0x14e74f[_0x54c560(0x1da)]['authorization'],_0x3b03bf=_0x501be5&&_0x501be5[_0x54c560(0x1e3)]('\x20')[0x1];if(!_0x3b03bf)return _0xc3a5fc[_0x54c560(0x1ec)](0x191)[_0x54c560(0x1e7)]({'success':![],'message':'Access\x20token\x20required'});if(tokenBlacklistService_1[_0x54c560(0x1ed)][_0x54c560(0x1d5)](_0x3b03bf))return _0xc3a5fc[_0x54c560(0x1ec)](0x191)[_0x54c560(0x1e7)]({'success':![],'message':_0x54c560(0x1db)});jsonwebtoken_1['default'][_0x54c560(0x1d3)](_0x3b03bf,config_1['config'][_0x54c560(0x1de)][_0x54c560(0x1d6)],(_0x2135d4,_0x1fe115)=>{const _0x533705=_0x54c560;if(_0x2135d4)return _0xc3a5fc[_0x533705(0x1ec)](0x193)[_0x533705(0x1e7)]({'success':![],'message':_0x533705(0x1e6)});_0x14e74f[_0x533705(0x1d2)]=_0x1fe115,_0x14e74f[_0x533705(0x1ef)]=_0x3b03bf,_0x23fd78();});};exports[a24_0x51ea6d(0x1f5)]=authenticateToken;function a24_0x235c(_0x41083b,_0x222289){_0x41083b=_0x41083b-0x1cc;const _0xf082b1=a24_0xf082();let _0x235cb8=_0xf082b1[_0x41083b];return _0x235cb8;}const requireAdmin=(_0x2f43bc,_0x1b742f,_0x18d447)=>{const _0xcbf64f=a24_0x51ea6d;if(!_0x2f43bc[_0xcbf64f(0x1d2)]||_0x2f43bc[_0xcbf64f(0x1d2)][_0xcbf64f(0x1f1)]!==_0xcbf64f(0x1e5))return _0x1b742f[_0xcbf64f(0x1ec)](0x193)[_0xcbf64f(0x1e7)]({'success':![],'message':_0xcbf64f(0x1dd)});_0x18d447();};exports[a24_0x51ea6d(0x1ea)]=requireAdmin;const requireShop=(_0x5dd0f6,_0x33e4b6,_0x4b5397)=>{const _0x41ac4d=a24_0x51ea6d;if(!_0x5dd0f6[_0x41ac4d(0x1d2)]||_0x5dd0f6[_0x41ac4d(0x1d2)][_0x41ac4d(0x1f1)]!==_0x41ac4d(0x1eb))return _0x33e4b6['status'](0x193)[_0x41ac4d(0x1e7)]({'success':![],'message':_0x41ac4d(0x1e9)});_0x4b5397();};exports['requireShop']=requireShop;const requireActiveShop=async(_0x5a6bd9,_0x29fa44,_0x2ce4ac)=>{const _0x3063b7=a24_0x51ea6d;if(!_0x5a6bd9[_0x3063b7(0x1d2)]||_0x5a6bd9['user']['role']!=='shop')return _0x29fa44[_0x3063b7(0x1ec)](0x193)[_0x3063b7(0x1e7)]({'success':![],'message':_0x3063b7(0x1e9)});try{const _0x3fd729=require(_0x3063b7(0x1d1))[_0x3063b7(0x1d9)],_0x120c70=await _0x3fd729[_0x3063b7(0x1eb)]['findUnique']({'where':{'id':_0x5a6bd9['user']['id']},'select':{'status':!![]}});if(!_0x120c70||_0x120c70[_0x3063b7(0x1ec)]!==_0x3063b7(0x1dc))return _0x29fa44['status'](0x193)[_0x3063b7(0x1e7)]({'success':![],'message':'Account\x20is\x20suspended\x20or\x20inactive.\x20Contact\x20administrator\x20to\x20activate\x20your\x20account.','suspended':_0x120c70?.[_0x3063b7(0x1ec)]===_0x3063b7(0x1cd)});_0x2ce4ac();}catch(_0x6902ad){return console[_0x3063b7(0x1d0)](_0x3063b7(0x1d4),_0x6902ad),_0x29fa44[_0x3063b7(0x1ec)](0x1f4)[_0x3063b7(0x1e7)]({'success':![],'message':_0x3063b7(0x1e8)});}};function a24_0xf082(){const _0x51df73=['4050bIglph','default','headers','Token\x20has\x20been\x20revoked','ACTIVE','Admin\x20access\x20required','jwt','904tEhBjQ','__importDefault','2610TUHzcn','1351085DEYxiX','split','__esModule','admin','Invalid\x20or\x20expired\x20token','json','Error\x20checking\x20account\x20status','Shop\x20access\x20required','requireAdmin','shop','status','tokenBlacklistService','10ygCGWJ','token','34455ExGbFt','role','431796dkoCOr','16730YpGwxE','9gvaOwh','authenticateToken','../services/tokenBlacklistService','3480444SzcwvU','SUSPENDED','1057566MwlvZf','defineProperty','error','../config/database','user','verify','Error\x20checking\x20account\x20status:','isTokenBlacklisted','secret','requireActiveShop'];a24_0xf082=function(){return _0x51df73;};return a24_0xf082();}exports['requireActiveShop']=requireActiveShop;