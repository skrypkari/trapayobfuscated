'use strict';const a17_0x1019a1=a17_0x5bd6;(function(_0x5b9583,_0x2fe7d5){const _0x1ba6b7=a17_0x5bd6,_0x1c1aba=_0x5b9583();while(!![]){try{const _0x2046a3=parseInt(_0x1ba6b7(0x154))/0x1*(-parseInt(_0x1ba6b7(0x15d))/0x2)+parseInt(_0x1ba6b7(0x140))/0x3+parseInt(_0x1ba6b7(0x160))/0x4+parseInt(_0x1ba6b7(0x145))/0x5*(parseInt(_0x1ba6b7(0x13e))/0x6)+-parseInt(_0x1ba6b7(0x15f))/0x7*(parseInt(_0x1ba6b7(0x159))/0x8)+-parseInt(_0x1ba6b7(0x150))/0x9*(-parseInt(_0x1ba6b7(0x13f))/0xa)+-parseInt(_0x1ba6b7(0x164))/0xb;if(_0x2046a3===_0x2fe7d5)break;else _0x1c1aba['push'](_0x1c1aba['shift']());}catch(_0x3c5c20){_0x1c1aba['push'](_0x1c1aba['shift']());}}}(a17_0x308b,0x3fff5));var __importDefault=this&&this[a17_0x1019a1(0x15c)]||function(_0x5e00ff){const _0xb3d067=a17_0x1019a1;return _0x5e00ff&&_0x5e00ff[_0xb3d067(0x165)]?_0x5e00ff:{'default':_0x5e00ff};};Object[a17_0x1019a1(0x162)](exports,a17_0x1019a1(0x165),{'value':!![]}),exports[a17_0x1019a1(0x144)]=exports[a17_0x1019a1(0x15b)]=exports[a17_0x1019a1(0x14f)]=exports[a17_0x1019a1(0x149)]=void 0x0;const jsonwebtoken_1=__importDefault(require(a17_0x1019a1(0x167))),config_1=require(a17_0x1019a1(0x151)),tokenBlacklistService_1=require(a17_0x1019a1(0x14d)),authenticateToken=(_0xb55a90,_0x39afd9,_0x5f2e09)=>{const _0x3af528=a17_0x1019a1,_0x347057=_0xb55a90[_0x3af528(0x13d)][_0x3af528(0x157)],_0x4b2860=_0x347057&&_0x347057[_0x3af528(0x152)]('\x20')[0x1];if(!_0x4b2860)return _0x39afd9['status'](0x191)[_0x3af528(0x161)]({'success':![],'message':'Access\x20token\x20required'});if(tokenBlacklistService_1[_0x3af528(0x14c)]['isTokenBlacklisted'](_0x4b2860))return _0x39afd9[_0x3af528(0x14e)](0x191)[_0x3af528(0x161)]({'success':![],'message':'Token\x20has\x20been\x20revoked'});jsonwebtoken_1[_0x3af528(0x143)]['verify'](_0x4b2860,config_1[_0x3af528(0x15e)]['jwt'][_0x3af528(0x146)],(_0x103fc8,_0x2f1e54)=>{const _0x354280=_0x3af528;if(_0x103fc8)return _0x39afd9[_0x354280(0x14e)](0x193)['json']({'success':![],'message':_0x354280(0x141)});_0xb55a90[_0x354280(0x147)]=_0x2f1e54,_0xb55a90[_0x354280(0x153)]=_0x4b2860,_0x5f2e09();});};function a17_0x308b(){const _0x491286=['Shop\x20access\x20required','authenticateToken','../config/database','findUnique','tokenBlacklistService','../services/tokenBlacklistService','status','requireAdmin','15831BWwowJ','../config/config','split','token','12601fpkwHn','Admin\x20access\x20required','shop','authorization','SUSPENDED','232rmOXTM','admin','requireShop','__importDefault','10eUUrWO','config','38507CWqdRW','1714248IiTUTP','json','defineProperty','error','9965956cyDdYm','__esModule','Account\x20is\x20suspended\x20or\x20inactive.\x20Contact\x20administrator\x20to\x20activate\x20your\x20account.','jsonwebtoken','Error\x20checking\x20account\x20status','role','headers','2793786ZNmMMl','2680dUTKTg','75174hWvcAP','Invalid\x20or\x20expired\x20token','Error\x20checking\x20account\x20status:','default','requireActiveShop','5EZEzdx','secret','user'];a17_0x308b=function(){return _0x491286;};return a17_0x308b();}exports['authenticateToken']=authenticateToken;const requireAdmin=(_0x46a7ca,_0x588dd8,_0x4c63ac)=>{const _0xfb024=a17_0x1019a1;if(!_0x46a7ca[_0xfb024(0x147)]||_0x46a7ca['user']['role']!==_0xfb024(0x15a))return _0x588dd8['status'](0x193)[_0xfb024(0x161)]({'success':![],'message':_0xfb024(0x155)});_0x4c63ac();};function a17_0x5bd6(_0xb1fb60,_0x510eb6){const _0x308b44=a17_0x308b();return a17_0x5bd6=function(_0x5bd6cc,_0x54da90){_0x5bd6cc=_0x5bd6cc-0x13d;let _0x4895bb=_0x308b44[_0x5bd6cc];return _0x4895bb;},a17_0x5bd6(_0xb1fb60,_0x510eb6);}exports[a17_0x1019a1(0x14f)]=requireAdmin;const requireShop=(_0x5f1b2b,_0x21bc61,_0x14907c)=>{const _0xae426a=a17_0x1019a1;if(!_0x5f1b2b[_0xae426a(0x147)]||_0x5f1b2b['user'][_0xae426a(0x169)]!==_0xae426a(0x156))return _0x21bc61[_0xae426a(0x14e)](0x193)[_0xae426a(0x161)]({'success':![],'message':'Shop\x20access\x20required'});_0x14907c();};exports[a17_0x1019a1(0x15b)]=requireShop;const requireActiveShop=async(_0x241f40,_0x5019cc,_0x57515f)=>{const _0x223946=a17_0x1019a1;if(!_0x241f40[_0x223946(0x147)]||_0x241f40['user']['role']!=='shop')return _0x5019cc[_0x223946(0x14e)](0x193)[_0x223946(0x161)]({'success':![],'message':_0x223946(0x148)});try{const _0x5d3bb2=require(_0x223946(0x14a))[_0x223946(0x143)],_0x519b91=await _0x5d3bb2[_0x223946(0x156)][_0x223946(0x14b)]({'where':{'id':_0x241f40[_0x223946(0x147)]['id']},'select':{'status':!![]}});if(!_0x519b91||_0x519b91['status']!=='ACTIVE')return _0x5019cc['status'](0x193)[_0x223946(0x161)]({'success':![],'message':_0x223946(0x166),'suspended':_0x519b91?.[_0x223946(0x14e)]===_0x223946(0x158)});_0x57515f();}catch(_0x11fdf9){return console[_0x223946(0x163)](_0x223946(0x142),_0x11fdf9),_0x5019cc['status'](0x1f4)['json']({'success':![],'message':_0x223946(0x168)});}};exports[a17_0x1019a1(0x144)]=requireActiveShop;