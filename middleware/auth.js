'use strict';function a16_0xb107(){const _0x287f74=['role','ACTIVE','status','secret','requireActiveShop','shop','headers','12088WnvtXk','authorization','56NatyNO','default','../services/tokenBlacklistService','5JjmgsB','Error\x20checking\x20account\x20status','Shop\x20access\x20required','Token\x20has\x20been\x20revoked','split','json','233pFOMRF','__importDefault','admin','requireAdmin','Admin\x20access\x20required','Access\x20token\x20required','9133218xrEFnZ','tokenBlacklistService','Error\x20checking\x20account\x20status:','findUnique','__esModule','jwt','Invalid\x20or\x20expired\x20token','authenticateToken','../config/database','user','1827396nStReZ','86480lqGUPD','verify','10326771jLeobF','SUSPENDED','config','defineProperty','error','1782810fvTiwv','60411080UlFSKS','requireShop'];a16_0xb107=function(){return _0x287f74;};return a16_0xb107();}const a16_0x37eb77=a16_0x307b;(function(_0x4d5f9c,_0x5f3c86){const _0x57ea30=a16_0x307b,_0x320595=_0x4d5f9c();while(!![]){try{const _0x5d7fec=-parseInt(_0x57ea30(0x1f4))/0x1*(parseInt(_0x57ea30(0x1e9))/0x2)+-parseInt(_0x57ea30(0x1df))/0x3+-parseInt(_0x57ea30(0x204))/0x4+parseInt(_0x57ea30(0x1ee))/0x5*(-parseInt(_0x57ea30(0x1fa))/0x6)+parseInt(_0x57ea30(0x1eb))/0x7*(parseInt(_0x57ea30(0x205))/0x8)+-parseInt(_0x57ea30(0x1da))/0x9+parseInt(_0x57ea30(0x1e0))/0xa;if(_0x5d7fec===_0x5f3c86)break;else _0x320595['push'](_0x320595['shift']());}catch(_0x57f615){_0x320595['push'](_0x320595['shift']());}}}(a16_0xb107,0xf3cc3));var __importDefault=this&&this[a16_0x37eb77(0x1f5)]||function(_0x46f6ea){const _0x5af541=a16_0x37eb77;return _0x46f6ea&&_0x46f6ea[_0x5af541(0x1fe)]?_0x46f6ea:{'default':_0x46f6ea};};Object[a16_0x37eb77(0x1dd)](exports,a16_0x37eb77(0x1fe),{'value':!![]}),exports[a16_0x37eb77(0x1e6)]=exports[a16_0x37eb77(0x1e1)]=exports['requireAdmin']=exports['authenticateToken']=void 0x0;const jsonwebtoken_1=__importDefault(require('jsonwebtoken')),config_1=require('../config/config'),tokenBlacklistService_1=require(a16_0x37eb77(0x1ed)),authenticateToken=(_0x41fa56,_0x1912f3,_0x431936)=>{const _0xf6931a=a16_0x37eb77,_0x19bb47=_0x41fa56[_0xf6931a(0x1e8)][_0xf6931a(0x1ea)],_0x14002f=_0x19bb47&&_0x19bb47[_0xf6931a(0x1f2)]('\x20')[0x1];if(!_0x14002f)return _0x1912f3[_0xf6931a(0x1e4)](0x191)[_0xf6931a(0x1f3)]({'success':![],'message':_0xf6931a(0x1f9)});if(tokenBlacklistService_1[_0xf6931a(0x1fb)]['isTokenBlacklisted'](_0x14002f))return _0x1912f3['status'](0x191)[_0xf6931a(0x1f3)]({'success':![],'message':_0xf6931a(0x1f1)});jsonwebtoken_1[_0xf6931a(0x1ec)][_0xf6931a(0x1d9)](_0x14002f,config_1[_0xf6931a(0x1dc)][_0xf6931a(0x1ff)][_0xf6931a(0x1e5)],(_0x23ae27,_0x33ff33)=>{const _0x204f6f=_0xf6931a;if(_0x23ae27)return _0x1912f3[_0x204f6f(0x1e4)](0x193)['json']({'success':![],'message':_0x204f6f(0x200)});_0x41fa56[_0x204f6f(0x203)]=_0x33ff33,_0x41fa56['token']=_0x14002f,_0x431936();});};function a16_0x307b(_0x346968,_0x12d9e5){const _0xb10752=a16_0xb107();return a16_0x307b=function(_0x307b98,_0x165d5d){_0x307b98=_0x307b98-0x1d9;let _0x4fa448=_0xb10752[_0x307b98];return _0x4fa448;},a16_0x307b(_0x346968,_0x12d9e5);}exports[a16_0x37eb77(0x201)]=authenticateToken;const requireAdmin=(_0x4dfdba,_0x43f536,_0x255c6b)=>{const _0x10e040=a16_0x37eb77;if(!_0x4dfdba['user']||_0x4dfdba[_0x10e040(0x203)]['role']!==_0x10e040(0x1f6))return _0x43f536['status'](0x193)['json']({'success':![],'message':_0x10e040(0x1f8)});_0x255c6b();};exports[a16_0x37eb77(0x1f7)]=requireAdmin;const requireShop=(_0x1d33db,_0x39ed8b,_0x4e2610)=>{const _0x219f5e=a16_0x37eb77;if(!_0x1d33db[_0x219f5e(0x203)]||_0x1d33db[_0x219f5e(0x203)][_0x219f5e(0x1e2)]!=='shop')return _0x39ed8b['status'](0x193)[_0x219f5e(0x1f3)]({'success':![],'message':_0x219f5e(0x1f0)});_0x4e2610();};exports['requireShop']=requireShop;const requireActiveShop=async(_0x436cc4,_0x285335,_0x5e6bcd)=>{const _0x24b1e1=a16_0x37eb77;if(!_0x436cc4[_0x24b1e1(0x203)]||_0x436cc4[_0x24b1e1(0x203)][_0x24b1e1(0x1e2)]!==_0x24b1e1(0x1e7))return _0x285335[_0x24b1e1(0x1e4)](0x193)[_0x24b1e1(0x1f3)]({'success':![],'message':_0x24b1e1(0x1f0)});try{const _0x357051=require(_0x24b1e1(0x202))[_0x24b1e1(0x1ec)],_0x3dd4d0=await _0x357051[_0x24b1e1(0x1e7)][_0x24b1e1(0x1fd)]({'where':{'id':_0x436cc4[_0x24b1e1(0x203)]['id']},'select':{'status':!![]}});if(!_0x3dd4d0||_0x3dd4d0[_0x24b1e1(0x1e4)]!==_0x24b1e1(0x1e3))return _0x285335['status'](0x193)[_0x24b1e1(0x1f3)]({'success':![],'message':'Account\x20is\x20suspended\x20or\x20inactive.\x20Contact\x20administrator\x20to\x20activate\x20your\x20account.','suspended':_0x3dd4d0?.['status']===_0x24b1e1(0x1db)});_0x5e6bcd();}catch(_0x28e152){return console[_0x24b1e1(0x1de)](_0x24b1e1(0x1fc),_0x28e152),_0x285335[_0x24b1e1(0x1e4)](0x1f4)['json']({'success':![],'message':_0x24b1e1(0x1ef)});}};exports['requireActiveShop']=requireActiveShop;