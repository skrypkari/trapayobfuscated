'use strict';const a16_0x4c0104=a16_0x22c3;function a16_0x5b68(){const _0x275027=['15YnaUwf','SUSPENDED','status','token','isTokenBlacklisted','user','authenticateToken','50519vtFhzY','role','Invalid\x20or\x20expired\x20token','authorization','__esModule','config','20188elHfNL','headers','6398352ZgECfX','ACTIVE','requireAdmin','requireActiveShop','Access\x20token\x20required','3uLViMV','default','verify','11OCWVfU','447812QZeDGS','shop','16278930gnSMWU','../config/config','json','../services/tokenBlacklistService','Error\x20checking\x20account\x20status','1467654BQwyQn','Account\x20is\x20suspended\x20or\x20inactive.\x20Contact\x20administrator\x20to\x20activate\x20your\x20account.','916818AGkmFk','secret','requireShop','jwt','456bNLEMw','defineProperty','../config/database','Shop\x20access\x20required','Error\x20checking\x20account\x20status:'];a16_0x5b68=function(){return _0x275027;};return a16_0x5b68();}(function(_0x1b9265,_0x17e7ec){const _0x57dc16=a16_0x22c3,_0x49dd8f=_0x1b9265();while(!![]){try{const _0x3fc721=-parseInt(_0x57dc16(0x13a))/0x1+parseInt(_0x57dc16(0x143))/0x2+parseInt(_0x57dc16(0x136))/0x3*(parseInt(_0x57dc16(0x12f))/0x4)+parseInt(_0x57dc16(0x14c))/0x5*(-parseInt(_0x57dc16(0x141))/0x6)+-parseInt(_0x57dc16(0x129))/0x7*(-parseInt(_0x57dc16(0x147))/0x8)+-parseInt(_0x57dc16(0x131))/0x9+parseInt(_0x57dc16(0x13c))/0xa*(parseInt(_0x57dc16(0x139))/0xb);if(_0x3fc721===_0x17e7ec)break;else _0x49dd8f['push'](_0x49dd8f['shift']());}catch(_0x349c92){_0x49dd8f['push'](_0x49dd8f['shift']());}}}(a16_0x5b68,0x94f67));function a16_0x22c3(_0x535936,_0x41a384){const _0x5b68bc=a16_0x5b68();return a16_0x22c3=function(_0x22c35a,_0x29c330){_0x22c35a=_0x22c35a-0x129;let _0x2cf5c0=_0x5b68bc[_0x22c35a];return _0x2cf5c0;},a16_0x22c3(_0x535936,_0x41a384);}var __importDefault=this&&this['__importDefault']||function(_0x44147b){const _0x246917=a16_0x22c3;return _0x44147b&&_0x44147b[_0x246917(0x12d)]?_0x44147b:{'default':_0x44147b};};Object[a16_0x4c0104(0x148)](exports,a16_0x4c0104(0x12d),{'value':!![]}),exports[a16_0x4c0104(0x134)]=exports[a16_0x4c0104(0x145)]=exports[a16_0x4c0104(0x133)]=exports['authenticateToken']=void 0x0;const jsonwebtoken_1=__importDefault(require('jsonwebtoken')),config_1=require(a16_0x4c0104(0x13d)),tokenBlacklistService_1=require(a16_0x4c0104(0x13f)),authenticateToken=(_0x577646,_0x1d1edb,_0x51989c)=>{const _0x340a1e=a16_0x4c0104,_0x4b55aa=_0x577646[_0x340a1e(0x130)][_0x340a1e(0x12c)],_0x557293=_0x4b55aa&&_0x4b55aa['split']('\x20')[0x1];if(!_0x557293)return _0x1d1edb[_0x340a1e(0x14e)](0x191)[_0x340a1e(0x13e)]({'success':![],'message':_0x340a1e(0x135)});if(tokenBlacklistService_1['tokenBlacklistService'][_0x340a1e(0x150)](_0x557293))return _0x1d1edb['status'](0x191)['json']({'success':![],'message':'Token\x20has\x20been\x20revoked'});jsonwebtoken_1[_0x340a1e(0x137)][_0x340a1e(0x138)](_0x557293,config_1[_0x340a1e(0x12e)][_0x340a1e(0x146)][_0x340a1e(0x144)],(_0x3bf5e0,_0x1fd3b7)=>{const _0x29257f=_0x340a1e;if(_0x3bf5e0)return _0x1d1edb[_0x29257f(0x14e)](0x193)[_0x29257f(0x13e)]({'success':![],'message':_0x29257f(0x12b)});_0x577646[_0x29257f(0x151)]=_0x1fd3b7,_0x577646[_0x29257f(0x14f)]=_0x557293,_0x51989c();});};exports[a16_0x4c0104(0x152)]=authenticateToken;const requireAdmin=(_0x21c8a1,_0x1c7f11,_0x1c3a41)=>{const _0x5b62c2=a16_0x4c0104;if(!_0x21c8a1[_0x5b62c2(0x151)]||_0x21c8a1['user'][_0x5b62c2(0x12a)]!=='admin')return _0x1c7f11[_0x5b62c2(0x14e)](0x193)[_0x5b62c2(0x13e)]({'success':![],'message':'Admin\x20access\x20required'});_0x1c3a41();};exports['requireAdmin']=requireAdmin;const requireShop=(_0x104a3f,_0x303618,_0x194830)=>{const _0x45f76f=a16_0x4c0104;if(!_0x104a3f['user']||_0x104a3f[_0x45f76f(0x151)][_0x45f76f(0x12a)]!=='shop')return _0x303618[_0x45f76f(0x14e)](0x193)[_0x45f76f(0x13e)]({'success':![],'message':_0x45f76f(0x14a)});_0x194830();};exports['requireShop']=requireShop;const requireActiveShop=async(_0x5eee54,_0x547045,_0x44a9fb)=>{const _0xa2fd49=a16_0x4c0104;if(!_0x5eee54[_0xa2fd49(0x151)]||_0x5eee54[_0xa2fd49(0x151)][_0xa2fd49(0x12a)]!==_0xa2fd49(0x13b))return _0x547045[_0xa2fd49(0x14e)](0x193)['json']({'success':![],'message':_0xa2fd49(0x14a)});try{const _0x32886d=require(_0xa2fd49(0x149))[_0xa2fd49(0x137)],_0x31d4f7=await _0x32886d[_0xa2fd49(0x13b)]['findUnique']({'where':{'id':_0x5eee54[_0xa2fd49(0x151)]['id']},'select':{'status':!![]}});if(!_0x31d4f7||_0x31d4f7[_0xa2fd49(0x14e)]!==_0xa2fd49(0x132))return _0x547045['status'](0x193)[_0xa2fd49(0x13e)]({'success':![],'message':_0xa2fd49(0x142),'suspended':_0x31d4f7?.[_0xa2fd49(0x14e)]===_0xa2fd49(0x14d)});_0x44a9fb();}catch(_0x35a566){return console['error'](_0xa2fd49(0x14b),_0x35a566),_0x547045[_0xa2fd49(0x14e)](0x1f4)[_0xa2fd49(0x13e)]({'success':![],'message':_0xa2fd49(0x140)});}};exports['requireActiveShop']=requireActiveShop;