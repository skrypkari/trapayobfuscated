'use strict';const a16_0x39b38f=a16_0x42a3;(function(_0x1fc4df,_0xa7ed7a){const _0x5932d7=a16_0x42a3,_0x701ed2=_0x1fc4df();while(!![]){try{const _0x11eaff=parseInt(_0x5932d7(0xae))/0x1*(-parseInt(_0x5932d7(0x9d))/0x2)+-parseInt(_0x5932d7(0xb6))/0x3*(-parseInt(_0x5932d7(0xb7))/0x4)+-parseInt(_0x5932d7(0xab))/0x5*(-parseInt(_0x5932d7(0xbd))/0x6)+-parseInt(_0x5932d7(0xa7))/0x7+-parseInt(_0x5932d7(0xbc))/0x8+parseInt(_0x5932d7(0xc0))/0x9*(parseInt(_0x5932d7(0xb9))/0xa)+-parseInt(_0x5932d7(0xac))/0xb;if(_0x11eaff===_0xa7ed7a)break;else _0x701ed2['push'](_0x701ed2['shift']());}catch(_0x9a72ad){_0x701ed2['push'](_0x701ed2['shift']());}}}(a16_0x47e7,0xabff2));var __importDefault=this&&this['__importDefault']||function(_0x29b282){const _0xd40df2=a16_0x42a3;return _0x29b282&&_0x29b282[_0xd40df2(0x9f)]?_0x29b282:{'default':_0x29b282};};Object['defineProperty'](exports,a16_0x39b38f(0x9f),{'value':!![]}),exports['requireActiveShop']=exports[a16_0x39b38f(0xb1)]=exports['requireAdmin']=exports[a16_0x39b38f(0xa2)]=void 0x0;const jsonwebtoken_1=__importDefault(require('jsonwebtoken')),config_1=require('../config/config'),tokenBlacklistService_1=require(a16_0x39b38f(0xaa)),authenticateToken=(_0x5aef46,_0x55afed,_0x2d7779)=>{const _0x14f5b1=a16_0x39b38f,_0x57623a=_0x5aef46[_0x14f5b1(0xbe)][_0x14f5b1(0x9c)],_0xfed4c8=_0x57623a&&_0x57623a[_0x14f5b1(0xa1)]('\x20')[0x1];if(!_0xfed4c8)return _0x55afed[_0x14f5b1(0xaf)](0x191)[_0x14f5b1(0xb0)]({'success':![],'message':'Access\x20token\x20required'});if(tokenBlacklistService_1[_0x14f5b1(0xad)][_0x14f5b1(0xa5)](_0xfed4c8))return _0x55afed['status'](0x191)[_0x14f5b1(0xb0)]({'success':![],'message':_0x14f5b1(0xb3)});jsonwebtoken_1[_0x14f5b1(0x9e)]['verify'](_0xfed4c8,config_1[_0x14f5b1(0xa4)]['jwt'][_0x14f5b1(0xb8)],(_0x3922c0,_0x1da12b)=>{const _0x4000db=_0x14f5b1;if(_0x3922c0)return _0x55afed['status'](0x193)[_0x4000db(0xb0)]({'success':![],'message':_0x4000db(0xb4)});_0x5aef46[_0x4000db(0xa3)]=_0x1da12b,_0x5aef46[_0x4000db(0xbf)]=_0xfed4c8,_0x2d7779();});};exports[a16_0x39b38f(0xa2)]=authenticateToken;const requireAdmin=(_0x589112,_0x46650d,_0x54f2b3)=>{const _0x433b00=a16_0x39b38f;if(!_0x589112[_0x433b00(0xa3)]||_0x589112['user'][_0x433b00(0xc2)]!==_0x433b00(0xc4))return _0x46650d[_0x433b00(0xaf)](0x193)['json']({'success':![],'message':_0x433b00(0xb5)});_0x54f2b3();};function a16_0x42a3(_0x4cc9ef,_0xd17888){const _0x47e71b=a16_0x47e7();return a16_0x42a3=function(_0x42a38e,_0x54c22d){_0x42a38e=_0x42a38e-0x9c;let _0x1f7f1a=_0x47e71b[_0x42a38e];return _0x1f7f1a;},a16_0x42a3(_0x4cc9ef,_0xd17888);}exports['requireAdmin']=requireAdmin;function a16_0x47e7(){const _0x469521=['split','authenticateToken','user','config','isTokenBlacklisted','shop','1343804OSSlIy','Shop\x20access\x20required','Error\x20checking\x20account\x20status:','../services/tokenBlacklistService','5089510lyAZbX','6910101ZbKFOC','tokenBlacklistService','200644TyDnER','status','json','requireShop','requireActiveShop','Token\x20has\x20been\x20revoked','Invalid\x20or\x20expired\x20token','Admin\x20access\x20required','2287917GYmZrT','4GpCFZF','secret','125390VQkFcs','findUnique','ACTIVE','1144072dAeHpy','6KZeoqT','headers','token','63YptQul','../config/database','role','Error\x20checking\x20account\x20status','admin','authorization','2ESfAzY','default','__esModule','Account\x20is\x20suspended\x20or\x20inactive.\x20Contact\x20administrator\x20to\x20activate\x20your\x20account.'];a16_0x47e7=function(){return _0x469521;};return a16_0x47e7();}const requireShop=(_0x5310e0,_0x699ec7,_0x5a3915)=>{const _0x352750=a16_0x39b38f;if(!_0x5310e0[_0x352750(0xa3)]||_0x5310e0['user'][_0x352750(0xc2)]!==_0x352750(0xa6))return _0x699ec7[_0x352750(0xaf)](0x193)[_0x352750(0xb0)]({'success':![],'message':'Shop\x20access\x20required'});_0x5a3915();};exports[a16_0x39b38f(0xb1)]=requireShop;const requireActiveShop=async(_0x1bb060,_0x1c97f4,_0x56b39a)=>{const _0x3932fe=a16_0x39b38f;if(!_0x1bb060[_0x3932fe(0xa3)]||_0x1bb060['user'][_0x3932fe(0xc2)]!==_0x3932fe(0xa6))return _0x1c97f4[_0x3932fe(0xaf)](0x193)[_0x3932fe(0xb0)]({'success':![],'message':_0x3932fe(0xa8)});try{const _0x471a03=require(_0x3932fe(0xc1))['default'],_0x2402d9=await _0x471a03['shop'][_0x3932fe(0xba)]({'where':{'id':_0x1bb060[_0x3932fe(0xa3)]['id']},'select':{'status':!![]}});if(!_0x2402d9||_0x2402d9[_0x3932fe(0xaf)]!==_0x3932fe(0xbb))return _0x1c97f4[_0x3932fe(0xaf)](0x193)['json']({'success':![],'message':_0x3932fe(0xa0),'suspended':_0x2402d9?.['status']==='SUSPENDED'});_0x56b39a();}catch(_0x18232d){return console['error'](_0x3932fe(0xa9),_0x18232d),_0x1c97f4['status'](0x1f4)['json']({'success':![],'message':_0x3932fe(0xc3)});}};exports[a16_0x39b38f(0xb2)]=requireActiveShop;