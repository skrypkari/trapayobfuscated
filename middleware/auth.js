'use strict';const a16_0x10767d=a16_0x5254;function a16_0x5254(_0x373fec,_0x453e9d){const _0x5cb653=a16_0x5cb6();return a16_0x5254=function(_0x525474,_0x5b182a){_0x525474=_0x525474-0x169;let _0x4065dd=_0x5cb653[_0x525474];return _0x4065dd;},a16_0x5254(_0x373fec,_0x453e9d);}function a16_0x5cb6(){const _0x191ac5=['default','346778xoahQo','__esModule','headers','31542ERNftz','1382748vNBLRO','role','admin','defineProperty','shop','tokenBlacklistService','status','isTokenBlacklisted','5823EtTzDW','34XsXEvU','1022dPXBKD','Admin\x20access\x20required','requireShop','19288ZetipV','15870zTXevh','secret','Token\x20has\x20been\x20revoked','authenticateToken','json','jwt','__importDefault','1491580CHyYdw','Shop\x20access\x20required','../config/config','user','../services/tokenBlacklistService','requireAdmin','1261860GSkdza','verify'];a16_0x5cb6=function(){return _0x191ac5;};return a16_0x5cb6();}(function(_0x11061b,_0x1856f1){const _0x4e2e6a=a16_0x5254,_0x1d27dd=_0x11061b();while(!![]){try{const _0x435ff7=-parseInt(_0x4e2e6a(0x17a))/0x1+-parseInt(_0x4e2e6a(0x187))/0x2*(-parseInt(_0x4e2e6a(0x17d))/0x3)+-parseInt(_0x4e2e6a(0x177))/0x4+parseInt(_0x4e2e6a(0x171))/0x5+-parseInt(_0x4e2e6a(0x17e))/0x6+parseInt(_0x4e2e6a(0x188))/0x7*(-parseInt(_0x4e2e6a(0x169))/0x8)+-parseInt(_0x4e2e6a(0x186))/0x9*(-parseInt(_0x4e2e6a(0x16a))/0xa);if(_0x435ff7===_0x1856f1)break;else _0x1d27dd['push'](_0x1d27dd['shift']());}catch(_0x311b12){_0x1d27dd['push'](_0x1d27dd['shift']());}}}(a16_0x5cb6,0x3f440));var __importDefault=this&&this[a16_0x10767d(0x170)]||function(_0x364798){const _0x531c91=a16_0x10767d;return _0x364798&&_0x364798[_0x531c91(0x17b)]?_0x364798:{'default':_0x364798};};Object[a16_0x10767d(0x181)](exports,a16_0x10767d(0x17b),{'value':!![]}),exports[a16_0x10767d(0x18a)]=exports['requireAdmin']=exports['authenticateToken']=void 0x0;const jsonwebtoken_1=__importDefault(require('jsonwebtoken')),config_1=require(a16_0x10767d(0x173)),tokenBlacklistService_1=require(a16_0x10767d(0x175)),authenticateToken=(_0x1c13ea,_0x50a8ca,_0x5d9832)=>{const _0x22ce5e=a16_0x10767d,_0x298df9=_0x1c13ea[_0x22ce5e(0x17c)]['authorization'],_0x15f72e=_0x298df9&&_0x298df9['split']('\x20')[0x1];if(!_0x15f72e)return _0x50a8ca[_0x22ce5e(0x184)](0x191)[_0x22ce5e(0x16e)]({'success':![],'message':'Access\x20token\x20required'});if(tokenBlacklistService_1[_0x22ce5e(0x183)][_0x22ce5e(0x185)](_0x15f72e))return _0x50a8ca['status'](0x191)[_0x22ce5e(0x16e)]({'success':![],'message':_0x22ce5e(0x16c)});jsonwebtoken_1[_0x22ce5e(0x179)][_0x22ce5e(0x178)](_0x15f72e,config_1['config'][_0x22ce5e(0x16f)][_0x22ce5e(0x16b)],(_0x3795c9,_0x2d61e7)=>{const _0x588295=_0x22ce5e;if(_0x3795c9)return _0x50a8ca[_0x588295(0x184)](0x193)[_0x588295(0x16e)]({'success':![],'message':'Invalid\x20or\x20expired\x20token'});_0x1c13ea[_0x588295(0x174)]=_0x2d61e7,_0x1c13ea['token']=_0x15f72e,_0x5d9832();});};exports[a16_0x10767d(0x16d)]=authenticateToken;const requireAdmin=(_0x2f1e9f,_0x411a29,_0x33392f)=>{const _0x4f5d12=a16_0x10767d;if(!_0x2f1e9f[_0x4f5d12(0x174)]||_0x2f1e9f['user'][_0x4f5d12(0x17f)]!==_0x4f5d12(0x180))return _0x411a29[_0x4f5d12(0x184)](0x193)[_0x4f5d12(0x16e)]({'success':![],'message':_0x4f5d12(0x189)});_0x33392f();};exports[a16_0x10767d(0x176)]=requireAdmin;const requireShop=(_0xefe6fb,_0x18b3d7,_0x33f5aa)=>{const _0x71efe8=a16_0x10767d;if(!_0xefe6fb[_0x71efe8(0x174)]||_0xefe6fb[_0x71efe8(0x174)]['role']!==_0x71efe8(0x182))return _0x18b3d7[_0x71efe8(0x184)](0x193)[_0x71efe8(0x16e)]({'success':![],'message':_0x71efe8(0x172)});_0x33f5aa();};exports[a16_0x10767d(0x18a)]=requireShop;