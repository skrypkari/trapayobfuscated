'use strict';const a15_0x66a88e=a15_0x34aa;(function(_0x58714f,_0x3891ea){const _0x271609=a15_0x34aa,_0x39b6d2=_0x58714f();while(!![]){try{const _0x57019c=-parseInt(_0x271609(0x90))/0x1*(-parseInt(_0x271609(0x9a))/0x2)+-parseInt(_0x271609(0x9d))/0x3*(-parseInt(_0x271609(0x96))/0x4)+-parseInt(_0x271609(0x8b))/0x5*(parseInt(_0x271609(0x9b))/0x6)+-parseInt(_0x271609(0x98))/0x7+-parseInt(_0x271609(0x8f))/0x8*(-parseInt(_0x271609(0x93))/0x9)+-parseInt(_0x271609(0x86))/0xa+-parseInt(_0x271609(0x88))/0xb*(-parseInt(_0x271609(0x95))/0xc);if(_0x57019c===_0x3891ea)break;else _0x39b6d2['push'](_0x39b6d2['shift']());}catch(_0x2b7931){_0x39b6d2['push'](_0x39b6d2['shift']());}}}(a15_0x27c1,0x9db67));function a15_0x27c1(){const _0x559ba5=['../services/tokenBlacklistService','10zpqmxV','shop','jwt','default','8pQSeQv','109903eleOtZ','headers','verify','195687lVaeeE','Shop\x20access\x20required','13262820HZMlOJ','728356XoBQiv','authorization','8560986aHCKGf','requireShop','10Tmdjfb','295338DqsreP','../config/config','6aIyxPO','status','config','role','__esModule','user','requireAdmin','Token\x20has\x20been\x20revoked','defineProperty','authenticateToken','Admin\x20access\x20required','Invalid\x20or\x20expired\x20token','732360qsdyfR','admin','11irKFJL','json'];a15_0x27c1=function(){return _0x559ba5;};return a15_0x27c1();}var __importDefault=this&&this['__importDefault']||function(_0x24c7a0){const _0x2bfbfc=a15_0x34aa;return _0x24c7a0&&_0x24c7a0[_0x2bfbfc(0x7e)]?_0x24c7a0:{'default':_0x24c7a0};};Object[a15_0x66a88e(0x82)](exports,'__esModule',{'value':!![]}),exports[a15_0x66a88e(0x99)]=exports['requireAdmin']=exports[a15_0x66a88e(0x83)]=void 0x0;const jsonwebtoken_1=__importDefault(require('jsonwebtoken')),config_1=require(a15_0x66a88e(0x9c)),tokenBlacklistService_1=require(a15_0x66a88e(0x8a)),authenticateToken=(_0x3674f5,_0x3844fa,_0x5e0625)=>{const _0x2f1e6e=a15_0x66a88e,_0x31173e=_0x3674f5[_0x2f1e6e(0x91)][_0x2f1e6e(0x97)],_0x293aac=_0x31173e&&_0x31173e['split']('\x20')[0x1];if(!_0x293aac)return _0x3844fa['status'](0x191)[_0x2f1e6e(0x89)]({'success':![],'message':'Access\x20token\x20required'});if(tokenBlacklistService_1['tokenBlacklistService']['isTokenBlacklisted'](_0x293aac))return _0x3844fa['status'](0x191)['json']({'success':![],'message':_0x2f1e6e(0x81)});jsonwebtoken_1[_0x2f1e6e(0x8e)][_0x2f1e6e(0x92)](_0x293aac,config_1[_0x2f1e6e(0x9f)][_0x2f1e6e(0x8d)]['secret'],(_0xfa0e7d,_0x301174)=>{const _0xe88b85=_0x2f1e6e;if(_0xfa0e7d)return _0x3844fa['status'](0x193)[_0xe88b85(0x89)]({'success':![],'message':_0xe88b85(0x85)});_0x3674f5[_0xe88b85(0x7f)]=_0x301174,_0x3674f5['token']=_0x293aac,_0x5e0625();});};function a15_0x34aa(_0x2c1cf5,_0x47300e){const _0x27c16f=a15_0x27c1();return a15_0x34aa=function(_0x34aa80,_0x1eea60){_0x34aa80=_0x34aa80-0x7d;let _0xda8a25=_0x27c16f[_0x34aa80];return _0xda8a25;},a15_0x34aa(_0x2c1cf5,_0x47300e);}exports[a15_0x66a88e(0x83)]=authenticateToken;const requireAdmin=(_0x4bb27f,_0x33cfb3,_0x5b63bb)=>{const _0x3308a9=a15_0x66a88e;if(!_0x4bb27f[_0x3308a9(0x7f)]||_0x4bb27f[_0x3308a9(0x7f)][_0x3308a9(0x7d)]!==_0x3308a9(0x87))return _0x33cfb3[_0x3308a9(0x9e)](0x193)['json']({'success':![],'message':_0x3308a9(0x84)});_0x5b63bb();};exports[a15_0x66a88e(0x80)]=requireAdmin;const requireShop=(_0x11c5a8,_0x4f8857,_0x58ed57)=>{const _0x1d7e25=a15_0x66a88e;if(!_0x11c5a8[_0x1d7e25(0x7f)]||_0x11c5a8[_0x1d7e25(0x7f)]['role']!==_0x1d7e25(0x8c))return _0x4f8857['status'](0x193)[_0x1d7e25(0x89)]({'success':![],'message':_0x1d7e25(0x94)});_0x58ed57();};exports[a15_0x66a88e(0x99)]=requireShop;