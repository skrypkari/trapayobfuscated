'use strict';const a16_0x3ddfe4=a16_0x2c7b;(function(_0x243c80,_0x2d4b4e){const _0x26518c=a16_0x2c7b,_0x35838d=_0x243c80();while(!![]){try{const _0x330b42=-parseInt(_0x26518c(0x1ef))/0x1+parseInt(_0x26518c(0x201))/0x2*(parseInt(_0x26518c(0x20a))/0x3)+parseInt(_0x26518c(0x203))/0x4+parseInt(_0x26518c(0x1f8))/0x5*(parseInt(_0x26518c(0x1fb))/0x6)+-parseInt(_0x26518c(0x1e1))/0x7*(-parseInt(_0x26518c(0x1f1))/0x8)+parseInt(_0x26518c(0x1e9))/0x9+-parseInt(_0x26518c(0x1f3))/0xa;if(_0x330b42===_0x2d4b4e)break;else _0x35838d['push'](_0x35838d['shift']());}catch(_0x4330cb){_0x35838d['push'](_0x35838d['shift']());}}}(a16_0x352f,0x33a3d));function a16_0x2c7b(_0xf3abf9,_0x2b1c08){const _0x352fbc=a16_0x352f();return a16_0x2c7b=function(_0x2c7ba0,_0x51a50f){_0x2c7ba0=_0x2c7ba0-0x1e0;let _0x16de9c=_0x352fbc[_0x2c7ba0];return _0x16de9c;},a16_0x2c7b(_0xf3abf9,_0x2b1c08);}var __importDefault=this&&this[a16_0x3ddfe4(0x1ec)]||function(_0x2b7ec8){return _0x2b7ec8&&_0x2b7ec8['__esModule']?_0x2b7ec8:{'default':_0x2b7ec8};};Object['defineProperty'](exports,a16_0x3ddfe4(0x206),{'value':!![]}),exports[a16_0x3ddfe4(0x1e4)]=exports[a16_0x3ddfe4(0x209)]=exports[a16_0x3ddfe4(0x1ea)]=exports['authenticateToken']=void 0x0;function a16_0x352f(){const _0x48eae2=['Account\x20is\x20suspended\x20or\x20inactive.\x20Contact\x20administrator\x20to\x20activate\x20your\x20account.','8flfZCW','Token\x20has\x20been\x20revoked','4761650SkkLxR','../config/database','authorization','error','json','10zvNGvS','SUSPENDED','config','656004seHKUY','user','Admin\x20access\x20required','role','verify','jwt','2jjpdEN','headers','808832uJmjYH','authenticateToken','Error\x20checking\x20account\x20status:','__esModule','Access\x20token\x20required','token','requireShop','486273mrdrZf','../config/config','2754619MlctuK','isTokenBlacklisted','status','requireActiveShop','jsonwebtoken','shop','default','Error\x20checking\x20account\x20status','828612WiVRQp','requireAdmin','secret','__importDefault','Shop\x20access\x20required','split','380870NcIdDr'];a16_0x352f=function(){return _0x48eae2;};return a16_0x352f();}const jsonwebtoken_1=__importDefault(require(a16_0x3ddfe4(0x1e5))),config_1=require(a16_0x3ddfe4(0x1e0)),tokenBlacklistService_1=require('../services/tokenBlacklistService'),authenticateToken=(_0x2e6472,_0x28652b,_0x23a39d)=>{const _0x2ca915=a16_0x3ddfe4,_0x2a1e15=_0x2e6472[_0x2ca915(0x202)][_0x2ca915(0x1f5)],_0xd890d4=_0x2a1e15&&_0x2a1e15[_0x2ca915(0x1ee)]('\x20')[0x1];if(!_0xd890d4)return _0x28652b[_0x2ca915(0x1e3)](0x191)[_0x2ca915(0x1f7)]({'success':![],'message':_0x2ca915(0x207)});if(tokenBlacklistService_1['tokenBlacklistService'][_0x2ca915(0x1e2)](_0xd890d4))return _0x28652b[_0x2ca915(0x1e3)](0x191)[_0x2ca915(0x1f7)]({'success':![],'message':_0x2ca915(0x1f2)});jsonwebtoken_1[_0x2ca915(0x1e7)][_0x2ca915(0x1ff)](_0xd890d4,config_1[_0x2ca915(0x1fa)][_0x2ca915(0x200)][_0x2ca915(0x1eb)],(_0x58667a,_0x148c01)=>{const _0xf30b9=_0x2ca915;if(_0x58667a)return _0x28652b[_0xf30b9(0x1e3)](0x193)[_0xf30b9(0x1f7)]({'success':![],'message':'Invalid\x20or\x20expired\x20token'});_0x2e6472[_0xf30b9(0x1fc)]=_0x148c01,_0x2e6472[_0xf30b9(0x208)]=_0xd890d4,_0x23a39d();});};exports[a16_0x3ddfe4(0x204)]=authenticateToken;const requireAdmin=(_0x49e207,_0x16691f,_0x2c840f)=>{const _0x1bdc73=a16_0x3ddfe4;if(!_0x49e207[_0x1bdc73(0x1fc)]||_0x49e207[_0x1bdc73(0x1fc)]['role']!=='admin')return _0x16691f[_0x1bdc73(0x1e3)](0x193)[_0x1bdc73(0x1f7)]({'success':![],'message':_0x1bdc73(0x1fd)});_0x2c840f();};exports[a16_0x3ddfe4(0x1ea)]=requireAdmin;const requireShop=(_0x10a449,_0x2e508b,_0x30ff8c)=>{const _0x3a0124=a16_0x3ddfe4;if(!_0x10a449[_0x3a0124(0x1fc)]||_0x10a449[_0x3a0124(0x1fc)][_0x3a0124(0x1fe)]!=='shop')return _0x2e508b[_0x3a0124(0x1e3)](0x193)['json']({'success':![],'message':_0x3a0124(0x1ed)});_0x30ff8c();};exports[a16_0x3ddfe4(0x209)]=requireShop;const requireActiveShop=async(_0x5e2b34,_0x5b6cb8,_0x13d6fe)=>{const _0x4ccebc=a16_0x3ddfe4;if(!_0x5e2b34[_0x4ccebc(0x1fc)]||_0x5e2b34[_0x4ccebc(0x1fc)][_0x4ccebc(0x1fe)]!=='shop')return _0x5b6cb8[_0x4ccebc(0x1e3)](0x193)[_0x4ccebc(0x1f7)]({'success':![],'message':_0x4ccebc(0x1ed)});try{const _0x3f0888=require(_0x4ccebc(0x1f4))[_0x4ccebc(0x1e7)],_0x26196a=await _0x3f0888[_0x4ccebc(0x1e6)]['findUnique']({'where':{'id':_0x5e2b34[_0x4ccebc(0x1fc)]['id']},'select':{'status':!![]}});if(!_0x26196a||_0x26196a['status']!=='ACTIVE')return _0x5b6cb8[_0x4ccebc(0x1e3)](0x193)['json']({'success':![],'message':_0x4ccebc(0x1f0),'suspended':_0x26196a?.['status']===_0x4ccebc(0x1f9)});_0x13d6fe();}catch(_0x55bd04){return console[_0x4ccebc(0x1f6)](_0x4ccebc(0x205),_0x55bd04),_0x5b6cb8[_0x4ccebc(0x1e3)](0x1f4)['json']({'success':![],'message':_0x4ccebc(0x1e8)});}};exports[a16_0x3ddfe4(0x1e4)]=requireActiveShop;