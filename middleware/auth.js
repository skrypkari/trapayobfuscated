'use strict';const a16_0x52086b=a16_0xc2a1;(function(_0x2065e9,_0x20ddfd){const _0x46eafa=a16_0xc2a1,_0x5dc8b5=_0x2065e9();while(!![]){try{const _0x5c49ab=parseInt(_0x46eafa(0xaa))/0x1+-parseInt(_0x46eafa(0xb6))/0x2*(-parseInt(_0x46eafa(0x9a))/0x3)+-parseInt(_0x46eafa(0x9f))/0x4+parseInt(_0x46eafa(0xa5))/0x5+-parseInt(_0x46eafa(0xa4))/0x6+-parseInt(_0x46eafa(0xc0))/0x7+-parseInt(_0x46eafa(0x9d))/0x8*(-parseInt(_0x46eafa(0xa6))/0x9);if(_0x5c49ab===_0x20ddfd)break;else _0x5dc8b5['push'](_0x5dc8b5['shift']());}catch(_0x237b8c){_0x5dc8b5['push'](_0x5dc8b5['shift']());}}}(a16_0x31ec,0x40e72));function a16_0xc2a1(_0x4276d9,_0x5899ab){const _0x31ecf6=a16_0x31ec();return a16_0xc2a1=function(_0xc2a13b,_0x36447c){_0xc2a13b=_0xc2a13b-0x97;let _0x145386=_0x31ecf6[_0xc2a13b];return _0x145386;},a16_0xc2a1(_0x4276d9,_0x5899ab);}var __importDefault=this&&this[a16_0x52086b(0xbd)]||function(_0x2db434){const _0x2ea75d=a16_0x52086b;return _0x2db434&&_0x2db434[_0x2ea75d(0x97)]?_0x2db434:{'default':_0x2db434};};Object[a16_0x52086b(0xa8)](exports,a16_0x52086b(0x97),{'value':!![]}),exports[a16_0x52086b(0xb0)]=exports['requireShop']=exports[a16_0x52086b(0xbb)]=exports[a16_0x52086b(0xad)]=void 0x0;const jsonwebtoken_1=__importDefault(require(a16_0x52086b(0xb9))),config_1=require('../config/config'),tokenBlacklistService_1=require(a16_0x52086b(0xae)),authenticateToken=(_0x44fef1,_0x459b8a,_0x2e8322)=>{const _0x5cd2ad=a16_0x52086b,_0x48261a=_0x44fef1[_0x5cd2ad(0xa3)][_0x5cd2ad(0xb3)],_0x5026f8=_0x48261a&&_0x48261a['split']('\x20')[0x1];if(!_0x5026f8)return _0x459b8a[_0x5cd2ad(0xb8)](0x191)[_0x5cd2ad(0xa0)]({'success':![],'message':_0x5cd2ad(0xb5)});if(tokenBlacklistService_1[_0x5cd2ad(0x99)]['isTokenBlacklisted'](_0x5026f8))return _0x459b8a['status'](0x191)['json']({'success':![],'message':_0x5cd2ad(0xb2)});jsonwebtoken_1['default']['verify'](_0x5026f8,config_1[_0x5cd2ad(0x9c)][_0x5cd2ad(0xa1)][_0x5cd2ad(0x9e)],(_0x2a88de,_0xa3c9ea)=>{const _0x3170da=_0x5cd2ad;if(_0x2a88de)return _0x459b8a[_0x3170da(0xb8)](0x193)[_0x3170da(0xa0)]({'success':![],'message':'Invalid\x20or\x20expired\x20token'});_0x44fef1[_0x3170da(0xbe)]=_0xa3c9ea,_0x44fef1[_0x3170da(0xb7)]=_0x5026f8,_0x2e8322();});};function a16_0x31ec(){const _0x3a0289=['default','Access\x20token\x20required','144TrXOEv','token','status','jsonwebtoken','role','requireAdmin','../config/database','__importDefault','user','findUnique','730002SbRHwp','__esModule','shop','tokenBlacklistService','12240TFbRle','Account\x20is\x20suspended\x20or\x20inactive.\x20Contact\x20administrator\x20to\x20activate\x20your\x20account.','config','968LdttkW','secret','554432KJgOXZ','json','jwt','Shop\x20access\x20required','headers','1995342OqEeFv','122065LFdiFV','5049OLPdhg','admin','defineProperty','requireShop','455239pteWLn','Error\x20checking\x20account\x20status','ACTIVE','authenticateToken','../services/tokenBlacklistService','Error\x20checking\x20account\x20status:','requireActiveShop','Admin\x20access\x20required','Token\x20has\x20been\x20revoked','authorization'];a16_0x31ec=function(){return _0x3a0289;};return a16_0x31ec();}exports['authenticateToken']=authenticateToken;const requireAdmin=(_0x125d2d,_0x57afde,_0x5dcd79)=>{const _0x4fd0a9=a16_0x52086b;if(!_0x125d2d[_0x4fd0a9(0xbe)]||_0x125d2d[_0x4fd0a9(0xbe)]['role']!==_0x4fd0a9(0xa7))return _0x57afde[_0x4fd0a9(0xb8)](0x193)[_0x4fd0a9(0xa0)]({'success':![],'message':_0x4fd0a9(0xb1)});_0x5dcd79();};exports[a16_0x52086b(0xbb)]=requireAdmin;const requireShop=(_0x434b95,_0xaf5664,_0x545651)=>{const _0x251a75=a16_0x52086b;if(!_0x434b95[_0x251a75(0xbe)]||_0x434b95[_0x251a75(0xbe)][_0x251a75(0xba)]!=='shop')return _0xaf5664[_0x251a75(0xb8)](0x193)['json']({'success':![],'message':_0x251a75(0xa2)});_0x545651();};exports[a16_0x52086b(0xa9)]=requireShop;const requireActiveShop=async(_0x35f19,_0x3e3b88,_0x4cac8c)=>{const _0x192a4a=a16_0x52086b;if(!_0x35f19[_0x192a4a(0xbe)]||_0x35f19[_0x192a4a(0xbe)][_0x192a4a(0xba)]!==_0x192a4a(0x98))return _0x3e3b88[_0x192a4a(0xb8)](0x193)[_0x192a4a(0xa0)]({'success':![],'message':_0x192a4a(0xa2)});try{const _0x5f278b=require(_0x192a4a(0xbc))[_0x192a4a(0xb4)],_0x2e3f1d=await _0x5f278b[_0x192a4a(0x98)][_0x192a4a(0xbf)]({'where':{'id':_0x35f19[_0x192a4a(0xbe)]['id']},'select':{'status':!![]}});if(!_0x2e3f1d||_0x2e3f1d[_0x192a4a(0xb8)]!==_0x192a4a(0xac))return _0x3e3b88[_0x192a4a(0xb8)](0x193)['json']({'success':![],'message':_0x192a4a(0x9b),'suspended':_0x2e3f1d?.[_0x192a4a(0xb8)]==='SUSPENDED'});_0x4cac8c();}catch(_0x37306c){return console['error'](_0x192a4a(0xaf),_0x37306c),_0x3e3b88['status'](0x1f4)[_0x192a4a(0xa0)]({'success':![],'message':_0x192a4a(0xab)});}};exports['requireActiveShop']=requireActiveShop;