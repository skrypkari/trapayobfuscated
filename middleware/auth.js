'use strict';const a16_0x57eee4=a16_0x1bfe;(function(_0x159749,_0x2c46dc){const _0x854ff8=a16_0x1bfe,_0x10baf=_0x159749();while(!![]){try{const _0xda6dd=-parseInt(_0x854ff8(0x1bc))/0x1*(parseInt(_0x854ff8(0x1a7))/0x2)+-parseInt(_0x854ff8(0x1b2))/0x3+parseInt(_0x854ff8(0x1b3))/0x4+parseInt(_0x854ff8(0x1a5))/0x5+parseInt(_0x854ff8(0x1b8))/0x6+parseInt(_0x854ff8(0x1b7))/0x7+-parseInt(_0x854ff8(0x197))/0x8;if(_0xda6dd===_0x2c46dc)break;else _0x10baf['push'](_0x10baf['shift']());}catch(_0x3c5a9b){_0x10baf['push'](_0x10baf['shift']());}}}(a16_0x2ec8,0x63ada));var __importDefault=this&&this[a16_0x57eee4(0x19f)]||function(_0x49c6a0){const _0x56a2f4=a16_0x57eee4;return _0x49c6a0&&_0x49c6a0[_0x56a2f4(0x1ba)]?_0x49c6a0:{'default':_0x49c6a0};};function a16_0x1bfe(_0x865427,_0x3fa5b6){const _0x2ec8d1=a16_0x2ec8();return a16_0x1bfe=function(_0x1bfea5,_0x57f1a8){_0x1bfea5=_0x1bfea5-0x196;let _0x4848eb=_0x2ec8d1[_0x1bfea5];return _0x4848eb;},a16_0x1bfe(_0x865427,_0x3fa5b6);}Object[a16_0x57eee4(0x1b0)](exports,'__esModule',{'value':!![]}),exports[a16_0x57eee4(0x1a1)]=exports['requireShop']=exports['requireAdmin']=exports['authenticateToken']=void 0x0;const jsonwebtoken_1=__importDefault(require('jsonwebtoken')),config_1=require(a16_0x57eee4(0x1ab)),tokenBlacklistService_1=require(a16_0x57eee4(0x1a2)),authenticateToken=(_0x4862a4,_0x35f807,_0x37fc20)=>{const _0x1af089=a16_0x57eee4,_0x7c209e=_0x4862a4[_0x1af089(0x1bb)][_0x1af089(0x1b1)],_0x394d14=_0x7c209e&&_0x7c209e[_0x1af089(0x1aa)]('\x20')[0x1];if(!_0x394d14)return _0x35f807[_0x1af089(0x1ad)](0x191)[_0x1af089(0x1a8)]({'success':![],'message':_0x1af089(0x1a4)});if(tokenBlacklistService_1[_0x1af089(0x1a0)][_0x1af089(0x1ae)](_0x394d14))return _0x35f807[_0x1af089(0x1ad)](0x191)[_0x1af089(0x1a8)]({'success':![],'message':_0x1af089(0x196)});jsonwebtoken_1[_0x1af089(0x1a9)][_0x1af089(0x19d)](_0x394d14,config_1['config'][_0x1af089(0x1bd)][_0x1af089(0x19e)],(_0x4f52bf,_0x3e663a)=>{const _0x17063d=_0x1af089;if(_0x4f52bf)return _0x35f807[_0x17063d(0x1ad)](0x193)['json']({'success':![],'message':_0x17063d(0x198)});_0x4862a4['user']=_0x3e663a,_0x4862a4[_0x17063d(0x19c)]=_0x394d14,_0x37fc20();});};function a16_0x2ec8(){const _0x15ad52=['jwt','Token\x20has\x20been\x20revoked','4223576CbmKQu','Invalid\x20or\x20expired\x20token','requireShop','SUSPENDED','ACTIVE','token','verify','secret','__importDefault','tokenBlacklistService','requireActiveShop','../services/tokenBlacklistService','user','Access\x20token\x20required','2232410WbbmjJ','requireAdmin','2KuBGLu','json','default','split','../config/config','role','status','isTokenBlacklisted','findUnique','defineProperty','authorization','464112rsgkZN','1891332QCDxvy','shop','error','../config/database','4714500xHLGve','745746SSQqMK','authenticateToken','__esModule','headers','626173GtOKaq'];a16_0x2ec8=function(){return _0x15ad52;};return a16_0x2ec8();}exports[a16_0x57eee4(0x1b9)]=authenticateToken;const requireAdmin=(_0x5f4de6,_0x120fbc,_0xdb6a76)=>{const _0x32822e=a16_0x57eee4;if(!_0x5f4de6[_0x32822e(0x1a3)]||_0x5f4de6[_0x32822e(0x1a3)]['role']!=='admin')return _0x120fbc[_0x32822e(0x1ad)](0x193)['json']({'success':![],'message':'Admin\x20access\x20required'});_0xdb6a76();};exports[a16_0x57eee4(0x1a6)]=requireAdmin;const requireShop=(_0x2452fd,_0x8cba48,_0x10f5f2)=>{const _0x2234ca=a16_0x57eee4;if(!_0x2452fd[_0x2234ca(0x1a3)]||_0x2452fd[_0x2234ca(0x1a3)][_0x2234ca(0x1ac)]!==_0x2234ca(0x1b4))return _0x8cba48['status'](0x193)[_0x2234ca(0x1a8)]({'success':![],'message':'Shop\x20access\x20required'});_0x10f5f2();};exports[a16_0x57eee4(0x199)]=requireShop;const requireActiveShop=async(_0x2ab256,_0x4a6bb4,_0x210dc4)=>{const _0x59e26f=a16_0x57eee4;if(!_0x2ab256['user']||_0x2ab256[_0x59e26f(0x1a3)][_0x59e26f(0x1ac)]!==_0x59e26f(0x1b4))return _0x4a6bb4[_0x59e26f(0x1ad)](0x193)[_0x59e26f(0x1a8)]({'success':![],'message':'Shop\x20access\x20required'});try{const _0x2493ff=require(_0x59e26f(0x1b6))['default'],_0xb54cba=await _0x2493ff[_0x59e26f(0x1b4)][_0x59e26f(0x1af)]({'where':{'id':_0x2ab256[_0x59e26f(0x1a3)]['id']},'select':{'status':!![]}});if(!_0xb54cba||_0xb54cba[_0x59e26f(0x1ad)]!==_0x59e26f(0x19b))return _0x4a6bb4[_0x59e26f(0x1ad)](0x193)[_0x59e26f(0x1a8)]({'success':![],'message':'Account\x20is\x20suspended\x20or\x20inactive.\x20Contact\x20administrator\x20to\x20activate\x20your\x20account.','suspended':_0xb54cba?.[_0x59e26f(0x1ad)]===_0x59e26f(0x19a)});_0x210dc4();}catch(_0x467256){return console[_0x59e26f(0x1b5)]('Error\x20checking\x20account\x20status:',_0x467256),_0x4a6bb4[_0x59e26f(0x1ad)](0x1f4)['json']({'success':![],'message':'Error\x20checking\x20account\x20status'});}};exports[a16_0x57eee4(0x1a1)]=requireActiveShop;