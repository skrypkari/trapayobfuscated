'use strict';function a15_0x5b34(_0x35bf3f,_0x25070c){const _0x44eb72=a15_0x44eb();return a15_0x5b34=function(_0x5b3445,_0x3dc6b2){_0x5b3445=_0x5b3445-0xb0;let _0x574a17=_0x44eb72[_0x5b3445];return _0x574a17;},a15_0x5b34(_0x35bf3f,_0x25070c);}const a15_0x58f97d=a15_0x5b34;function a15_0x44eb(){const _0xdb358b=['__esModule','status','admin','5248nBHnCp','jsonwebtoken','Access\x20token\x20required','requireShop','1238251zWsyXl','isTokenBlacklisted','11004jqhPZu','2FTLuOh','Shop\x20access\x20required','__importDefault','jwt','Token\x20has\x20been\x20revoked','4374627WJPruS','authorization','role','1867932JVkfzj','defineProperty','authenticateToken','3999880YsgiTV','verify','3374568MCPJnl','shop','Admin\x20access\x20required','default','json','headers','user','52593237leIXZN','split','requireAdmin','tokenBlacklistService','../config/config','config'];a15_0x44eb=function(){return _0xdb358b;};return a15_0x44eb();}(function(_0x4e40e6,_0x25dcfe){const _0x3b9c9a=a15_0x5b34,_0x3f1213=_0x4e40e6();while(!![]){try{const _0x7976e8=parseInt(_0x3b9c9a(0xbd))/0x1*(-parseInt(_0x3b9c9a(0xc0))/0x2)+-parseInt(_0x3b9c9a(0xc5))/0x3+-parseInt(_0x3b9c9a(0xcd))/0x4+-parseInt(_0x3b9c9a(0xcb))/0x5+parseInt(_0x3b9c9a(0xc8))/0x6+-parseInt(_0x3b9c9a(0xbf))/0x7*(parseInt(_0x3b9c9a(0xb9))/0x8)+parseInt(_0x3b9c9a(0xb0))/0x9;if(_0x7976e8===_0x25dcfe)break;else _0x3f1213['push'](_0x3f1213['shift']());}catch(_0x4e8eda){_0x3f1213['push'](_0x3f1213['shift']());}}}(a15_0x44eb,0xbf559));var __importDefault=this&&this[a15_0x58f97d(0xc2)]||function(_0x57d43e){const _0x9b9b03=a15_0x58f97d;return _0x57d43e&&_0x57d43e[_0x9b9b03(0xb6)]?_0x57d43e:{'default':_0x57d43e};};Object[a15_0x58f97d(0xc9)](exports,'__esModule',{'value':!![]}),exports[a15_0x58f97d(0xbc)]=exports[a15_0x58f97d(0xb2)]=exports[a15_0x58f97d(0xca)]=void 0x0;const jsonwebtoken_1=__importDefault(require(a15_0x58f97d(0xba))),config_1=require(a15_0x58f97d(0xb4)),tokenBlacklistService_1=require('../services/tokenBlacklistService'),authenticateToken=(_0x436461,_0x150abe,_0x14c157)=>{const _0x2369fc=a15_0x58f97d,_0x11a53a=_0x436461[_0x2369fc(0xd2)][_0x2369fc(0xc6)],_0x4e6574=_0x11a53a&&_0x11a53a[_0x2369fc(0xb1)]('\x20')[0x1];if(!_0x4e6574)return _0x150abe[_0x2369fc(0xb7)](0x191)[_0x2369fc(0xd1)]({'success':![],'message':_0x2369fc(0xbb)});if(tokenBlacklistService_1[_0x2369fc(0xb3)][_0x2369fc(0xbe)](_0x4e6574))return _0x150abe[_0x2369fc(0xb7)](0x191)['json']({'success':![],'message':_0x2369fc(0xc4)});jsonwebtoken_1[_0x2369fc(0xd0)][_0x2369fc(0xcc)](_0x4e6574,config_1[_0x2369fc(0xb5)][_0x2369fc(0xc3)]['secret'],(_0x2b1d07,_0x1e61f7)=>{const _0x1f58bc=_0x2369fc;if(_0x2b1d07)return _0x150abe[_0x1f58bc(0xb7)](0x193)['json']({'success':![],'message':'Invalid\x20or\x20expired\x20token'});_0x436461[_0x1f58bc(0xd3)]=_0x1e61f7,_0x436461['token']=_0x4e6574,_0x14c157();});};exports['authenticateToken']=authenticateToken;const requireAdmin=(_0x2aecee,_0x51a899,_0x657c5a)=>{const _0x1c4a9d=a15_0x58f97d;if(!_0x2aecee['user']||_0x2aecee[_0x1c4a9d(0xd3)]['role']!==_0x1c4a9d(0xb8))return _0x51a899[_0x1c4a9d(0xb7)](0x193)[_0x1c4a9d(0xd1)]({'success':![],'message':_0x1c4a9d(0xcf)});_0x657c5a();};exports[a15_0x58f97d(0xb2)]=requireAdmin;const requireShop=(_0x3e03f4,_0x1f6869,_0x32cbf9)=>{const _0x59a3b6=a15_0x58f97d;if(!_0x3e03f4[_0x59a3b6(0xd3)]||_0x3e03f4[_0x59a3b6(0xd3)][_0x59a3b6(0xc7)]!==_0x59a3b6(0xce))return _0x1f6869[_0x59a3b6(0xb7)](0x193)[_0x59a3b6(0xd1)]({'success':![],'message':_0x59a3b6(0xc1)});_0x32cbf9();};exports[a15_0x58f97d(0xbc)]=requireShop;