'use strict';const a16_0x2b3c29=a16_0x2486;(function(_0x535bb6,_0x59f453){const _0x142d70=a16_0x2486,_0x39215f=_0x535bb6();while(!![]){try{const _0x49af94=parseInt(_0x142d70(0x1e2))/0x1*(parseInt(_0x142d70(0x1e4))/0x2)+-parseInt(_0x142d70(0x1fe))/0x3+parseInt(_0x142d70(0x203))/0x4+parseInt(_0x142d70(0x207))/0x5*(parseInt(_0x142d70(0x1f3))/0x6)+parseInt(_0x142d70(0x1f7))/0x7*(parseInt(_0x142d70(0x209))/0x8)+-parseInt(_0x142d70(0x1e8))/0x9*(-parseInt(_0x142d70(0x1ea))/0xa)+-parseInt(_0x142d70(0x1fb))/0xb;if(_0x49af94===_0x59f453)break;else _0x39215f['push'](_0x39215f['shift']());}catch(_0x4a11c7){_0x39215f['push'](_0x39215f['shift']());}}}(a16_0x2cd0,0x88f22));function a16_0x2cd0(){const _0x364588=['Account\x20is\x20suspended\x20or\x20inactive.\x20Contact\x20administrator\x20to\x20activate\x20your\x20account.','user','3997204oGHSsv','json','__esModule','ACTIVE','882095GaYJCg','admin','208584uKgRns','Token\x20has\x20been\x20revoked','Access\x20token\x20required','secret','289xClgNR','findUnique','28amLUOw','error','Shop\x20access\x20required','jsonwebtoken','9JVPfna','status','10416740BPeCxp','requireActiveShop','isTokenBlacklisted','default','shop','__importDefault','Error\x20checking\x20account\x20status:','requireAdmin','../config/config','12aqSdwH','role','requireShop','Admin\x20access\x20required','91yWKvZK','../config/database','Error\x20checking\x20account\x20status','Invalid\x20or\x20expired\x20token','17644836bdDMNp','tokenBlacklistService','jwt','1715406GblRXn','authenticateToken','config'];a16_0x2cd0=function(){return _0x364588;};return a16_0x2cd0();}var __importDefault=this&&this[a16_0x2b3c29(0x1ef)]||function(_0x3a33eb){const _0x3669ca=a16_0x2b3c29;return _0x3a33eb&&_0x3a33eb[_0x3669ca(0x205)]?_0x3a33eb:{'default':_0x3a33eb};};function a16_0x2486(_0x1c52c1,_0x91a1ee){const _0x2cd04a=a16_0x2cd0();return a16_0x2486=function(_0x2486d4,_0x33443f){_0x2486d4=_0x2486d4-0x1e1;let _0x2292ca=_0x2cd04a[_0x2486d4];return _0x2292ca;},a16_0x2486(_0x1c52c1,_0x91a1ee);}Object['defineProperty'](exports,'__esModule',{'value':!![]}),exports[a16_0x2b3c29(0x1eb)]=exports['requireShop']=exports[a16_0x2b3c29(0x1f1)]=exports[a16_0x2b3c29(0x1ff)]=void 0x0;const jsonwebtoken_1=__importDefault(require(a16_0x2b3c29(0x1e7))),config_1=require(a16_0x2b3c29(0x1f2)),tokenBlacklistService_1=require('../services/tokenBlacklistService'),authenticateToken=(_0x371232,_0xd70387,_0x3d85a0)=>{const _0xe04788=a16_0x2b3c29,_0x32aebf=_0x371232['headers']['authorization'],_0x3ec6ea=_0x32aebf&&_0x32aebf['split']('\x20')[0x1];if(!_0x3ec6ea)return _0xd70387[_0xe04788(0x1e9)](0x191)['json']({'success':![],'message':_0xe04788(0x20b)});if(tokenBlacklistService_1[_0xe04788(0x1fc)][_0xe04788(0x1ec)](_0x3ec6ea))return _0xd70387['status'](0x191)[_0xe04788(0x204)]({'success':![],'message':_0xe04788(0x20a)});jsonwebtoken_1['default']['verify'](_0x3ec6ea,config_1[_0xe04788(0x200)][_0xe04788(0x1fd)][_0xe04788(0x1e1)],(_0x1d955b,_0x329417)=>{const _0x25ae66=_0xe04788;if(_0x1d955b)return _0xd70387[_0x25ae66(0x1e9)](0x193)[_0x25ae66(0x204)]({'success':![],'message':_0x25ae66(0x1fa)});_0x371232[_0x25ae66(0x202)]=_0x329417,_0x371232['token']=_0x3ec6ea,_0x3d85a0();});};exports['authenticateToken']=authenticateToken;const requireAdmin=(_0x805082,_0x519ef2,_0x574e86)=>{const _0x4b511a=a16_0x2b3c29;if(!_0x805082[_0x4b511a(0x202)]||_0x805082[_0x4b511a(0x202)][_0x4b511a(0x1f4)]!==_0x4b511a(0x208))return _0x519ef2[_0x4b511a(0x1e9)](0x193)['json']({'success':![],'message':_0x4b511a(0x1f6)});_0x574e86();};exports[a16_0x2b3c29(0x1f1)]=requireAdmin;const requireShop=(_0x57a19f,_0x2acbf2,_0x3a7fc4)=>{const _0xa466f2=a16_0x2b3c29;if(!_0x57a19f[_0xa466f2(0x202)]||_0x57a19f[_0xa466f2(0x202)][_0xa466f2(0x1f4)]!==_0xa466f2(0x1ee))return _0x2acbf2[_0xa466f2(0x1e9)](0x193)['json']({'success':![],'message':_0xa466f2(0x1e6)});_0x3a7fc4();};exports[a16_0x2b3c29(0x1f5)]=requireShop;const requireActiveShop=async(_0xf50392,_0x397aa2,_0x317c9b)=>{const _0xc5318f=a16_0x2b3c29;if(!_0xf50392['user']||_0xf50392[_0xc5318f(0x202)][_0xc5318f(0x1f4)]!==_0xc5318f(0x1ee))return _0x397aa2[_0xc5318f(0x1e9)](0x193)[_0xc5318f(0x204)]({'success':![],'message':_0xc5318f(0x1e6)});try{const _0x562fd6=require(_0xc5318f(0x1f8))[_0xc5318f(0x1ed)],_0xa7f027=await _0x562fd6[_0xc5318f(0x1ee)][_0xc5318f(0x1e3)]({'where':{'id':_0xf50392[_0xc5318f(0x202)]['id']},'select':{'status':!![]}});if(!_0xa7f027||_0xa7f027[_0xc5318f(0x1e9)]!==_0xc5318f(0x206))return _0x397aa2[_0xc5318f(0x1e9)](0x193)[_0xc5318f(0x204)]({'success':![],'message':_0xc5318f(0x201),'suspended':_0xa7f027?.[_0xc5318f(0x1e9)]==='SUSPENDED'});_0x317c9b();}catch(_0x4a7cf2){return console[_0xc5318f(0x1e5)](_0xc5318f(0x1f0),_0x4a7cf2),_0x397aa2[_0xc5318f(0x1e9)](0x1f4)[_0xc5318f(0x204)]({'success':![],'message':_0xc5318f(0x1f9)});}};exports['requireActiveShop']=requireActiveShop;