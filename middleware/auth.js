'use strict';const a16_0x10251f=a16_0x9e31;(function(_0x153c9f,_0x2967f4){const _0x4ffa53=a16_0x9e31,_0xf8efaf=_0x153c9f();while(!![]){try{const _0x13f279=parseInt(_0x4ffa53(0x103))/0x1+-parseInt(_0x4ffa53(0x10b))/0x2+parseInt(_0x4ffa53(0xff))/0x3+-parseInt(_0x4ffa53(0x10a))/0x4*(parseInt(_0x4ffa53(0x108))/0x5)+-parseInt(_0x4ffa53(0x109))/0x6*(-parseInt(_0x4ffa53(0xee))/0x7)+-parseInt(_0x4ffa53(0x111))/0x8+-parseInt(_0x4ffa53(0xfc))/0x9;if(_0x13f279===_0x2967f4)break;else _0xf8efaf['push'](_0xf8efaf['shift']());}catch(_0x17c5d3){_0xf8efaf['push'](_0xf8efaf['shift']());}}}(a16_0x1f63,0xc6cbf));var __importDefault=this&&this[a16_0x10251f(0x107)]||function(_0x22e381){return _0x22e381&&_0x22e381['__esModule']?_0x22e381:{'default':_0x22e381};};Object[a16_0x10251f(0xf9)](exports,'__esModule',{'value':!![]}),exports[a16_0x10251f(0xfb)]=exports[a16_0x10251f(0xec)]=exports[a16_0x10251f(0xf3)]=exports['authenticateToken']=void 0x0;const jsonwebtoken_1=__importDefault(require(a16_0x10251f(0x10c))),config_1=require(a16_0x10251f(0xf8)),tokenBlacklistService_1=require('../services/tokenBlacklistService'),authenticateToken=(_0x4bd519,_0x24a61e,_0x434f28)=>{const _0x151f88=a16_0x10251f,_0x3d1a67=_0x4bd519[_0x151f88(0xfa)]['authorization'],_0x39bc2e=_0x3d1a67&&_0x3d1a67[_0x151f88(0xf0)]('\x20')[0x1];if(!_0x39bc2e)return _0x24a61e['status'](0x191)[_0x151f88(0xef)]({'success':![],'message':_0x151f88(0x106)});if(tokenBlacklistService_1[_0x151f88(0x110)]['isTokenBlacklisted'](_0x39bc2e))return _0x24a61e['status'](0x191)[_0x151f88(0xef)]({'success':![],'message':_0x151f88(0xf7)});jsonwebtoken_1[_0x151f88(0xf5)][_0x151f88(0xf6)](_0x39bc2e,config_1[_0x151f88(0xfe)]['jwt'][_0x151f88(0x102)],(_0x540449,_0x33e529)=>{const _0x45975e=_0x151f88;if(_0x540449)return _0x24a61e['status'](0x193)[_0x45975e(0xef)]({'success':![],'message':_0x45975e(0x101)});_0x4bd519['user']=_0x33e529,_0x4bd519['token']=_0x39bc2e,_0x434f28();});};exports[a16_0x10251f(0x10d)]=authenticateToken;const requireAdmin=(_0x388867,_0x352c64,_0x2ae8fa)=>{const _0x175aa6=a16_0x10251f;if(!_0x388867[_0x175aa6(0x104)]||_0x388867['user'][_0x175aa6(0xed)]!==_0x175aa6(0xf2))return _0x352c64[_0x175aa6(0xfd)](0x193)[_0x175aa6(0xef)]({'success':![],'message':_0x175aa6(0xf4)});_0x2ae8fa();};exports[a16_0x10251f(0xf3)]=requireAdmin;function a16_0x9e31(_0x2f27ac,_0x5ae2e0){const _0x1f634e=a16_0x1f63();return a16_0x9e31=function(_0x9e3106,_0x61f3ab){_0x9e3106=_0x9e3106-0xe8;let _0x5f9085=_0x1f634e[_0x9e3106];return _0x5f9085;},a16_0x9e31(_0x2f27ac,_0x5ae2e0);}const requireShop=(_0x4dfcd0,_0x206e71,_0x4feeea)=>{const _0x15ac07=a16_0x10251f;if(!_0x4dfcd0[_0x15ac07(0x104)]||_0x4dfcd0[_0x15ac07(0x104)][_0x15ac07(0xed)]!=='shop')return _0x206e71[_0x15ac07(0xfd)](0x193)[_0x15ac07(0xef)]({'success':![],'message':_0x15ac07(0x10e)});_0x4feeea();};exports[a16_0x10251f(0xec)]=requireShop;function a16_0x1f63(){const _0x17be1f=['SUSPENDED','shop','../config/database','requireShop','role','49XEIdXt','json','split','error','admin','requireAdmin','Admin\x20access\x20required','default','verify','Token\x20has\x20been\x20revoked','../config/config','defineProperty','headers','requireActiveShop','13348854fjtWTf','status','config','4526733EESriC','Account\x20is\x20suspended\x20or\x20inactive.\x20Contact\x20administrator\x20to\x20activate\x20your\x20account.','Invalid\x20or\x20expired\x20token','secret','1605510KHQalD','user','findUnique','Access\x20token\x20required','__importDefault','555jdLFFC','1287540HKuVgw','53852rnBzEC','885666kRxvqZ','jsonwebtoken','authenticateToken','Shop\x20access\x20required','Error\x20checking\x20account\x20status:','tokenBlacklistService','3054784drnHnf','Error\x20checking\x20account\x20status'];a16_0x1f63=function(){return _0x17be1f;};return a16_0x1f63();}const requireActiveShop=async(_0x218898,_0x31096d,_0x5f2dd4)=>{const _0x114cb6=a16_0x10251f;if(!_0x218898[_0x114cb6(0x104)]||_0x218898['user'][_0x114cb6(0xed)]!=='shop')return _0x31096d[_0x114cb6(0xfd)](0x193)['json']({'success':![],'message':_0x114cb6(0x10e)});try{const _0x2ef4c0=require(_0x114cb6(0xeb))[_0x114cb6(0xf5)],_0x2f5681=await _0x2ef4c0[_0x114cb6(0xea)][_0x114cb6(0x105)]({'where':{'id':_0x218898[_0x114cb6(0x104)]['id']},'select':{'status':!![]}});if(!_0x2f5681||_0x2f5681[_0x114cb6(0xfd)]!=='ACTIVE')return _0x31096d[_0x114cb6(0xfd)](0x193)['json']({'success':![],'message':_0x114cb6(0x100),'suspended':_0x2f5681?.['status']===_0x114cb6(0xe9)});_0x5f2dd4();}catch(_0x5dc488){return console[_0x114cb6(0xf1)](_0x114cb6(0x10f),_0x5dc488),_0x31096d[_0x114cb6(0xfd)](0x1f4)[_0x114cb6(0xef)]({'success':![],'message':_0x114cb6(0xe8)});}};exports[a16_0x10251f(0xfb)]=requireActiveShop;