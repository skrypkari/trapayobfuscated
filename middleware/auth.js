'use strict';const a16_0x346f82=a16_0x5352;(function(_0x5544d0,_0x2a9614){const _0x4a9fb3=a16_0x5352,_0x46bb43=_0x5544d0();while(!![]){try{const _0x2c63bd=parseInt(_0x4a9fb3(0x108))/0x1*(parseInt(_0x4a9fb3(0x110))/0x2)+-parseInt(_0x4a9fb3(0x120))/0x3+-parseInt(_0x4a9fb3(0xfe))/0x4+-parseInt(_0x4a9fb3(0x127))/0x5+parseInt(_0x4a9fb3(0x11f))/0x6+parseInt(_0x4a9fb3(0x119))/0x7+parseInt(_0x4a9fb3(0x128))/0x8;if(_0x2c63bd===_0x2a9614)break;else _0x46bb43['push'](_0x46bb43['shift']());}catch(_0x419f9b){_0x46bb43['push'](_0x46bb43['shift']());}}}(a16_0x137d,0xd3151));var __importDefault=this&&this[a16_0x346f82(0x112)]||function(_0x30f368){const _0x2a7d79=a16_0x346f82;return _0x30f368&&_0x30f368[_0x2a7d79(0x118)]?_0x30f368:{'default':_0x30f368};};Object[a16_0x346f82(0x103)](exports,'__esModule',{'value':!![]}),exports[a16_0x346f82(0x106)]=exports['requireShop']=exports[a16_0x346f82(0xff)]=exports[a16_0x346f82(0x111)]=void 0x0;function a16_0x137d(){const _0x3b235c=['json','Error\x20checking\x20account\x20status:','Invalid\x20or\x20expired\x20token','status','Account\x20is\x20suspended\x20or\x20inactive.\x20Contact\x20administrator\x20to\x20activate\x20your\x20account.','secret','6546845YPQQSK','21105576JCjTPY','5225568ZeNieU','requireAdmin','config','jsonwebtoken','user','defineProperty','jwt','findUnique','requireActiveShop','Shop\x20access\x20required','93368lMPKEl','isTokenBlacklisted','authorization','../config/database','error','role','Access\x20token\x20required','Error\x20checking\x20account\x20status','8onXvOP','authenticateToken','__importDefault','Admin\x20access\x20required','Token\x20has\x20been\x20revoked','split','default','ACTIVE','__esModule','8906156kECgeV','../services/tokenBlacklistService','SUSPENDED','shop','verify','requireShop','650838XHOJNG','2736288UBhugE'];a16_0x137d=function(){return _0x3b235c;};return a16_0x137d();}const jsonwebtoken_1=__importDefault(require(a16_0x346f82(0x101))),config_1=require('../config/config'),tokenBlacklistService_1=require(a16_0x346f82(0x11a)),authenticateToken=(_0x5d7f59,_0x3b7d5f,_0x48d1ee)=>{const _0x36c457=a16_0x346f82,_0x4cc68f=_0x5d7f59['headers'][_0x36c457(0x10a)],_0xa6d6fd=_0x4cc68f&&_0x4cc68f[_0x36c457(0x115)]('\x20')[0x1];if(!_0xa6d6fd)return _0x3b7d5f[_0x36c457(0x124)](0x191)[_0x36c457(0x121)]({'success':![],'message':_0x36c457(0x10e)});if(tokenBlacklistService_1['tokenBlacklistService'][_0x36c457(0x109)](_0xa6d6fd))return _0x3b7d5f['status'](0x191)[_0x36c457(0x121)]({'success':![],'message':_0x36c457(0x114)});jsonwebtoken_1[_0x36c457(0x116)][_0x36c457(0x11d)](_0xa6d6fd,config_1[_0x36c457(0x100)][_0x36c457(0x104)][_0x36c457(0x126)],(_0x330032,_0x135cfc)=>{const _0x5c93ec=_0x36c457;if(_0x330032)return _0x3b7d5f['status'](0x193)['json']({'success':![],'message':_0x5c93ec(0x123)});_0x5d7f59[_0x5c93ec(0x102)]=_0x135cfc,_0x5d7f59['token']=_0xa6d6fd,_0x48d1ee();});};exports[a16_0x346f82(0x111)]=authenticateToken;const requireAdmin=(_0x17e9f7,_0x56fb97,_0x29d44a)=>{const _0x4291ce=a16_0x346f82;if(!_0x17e9f7[_0x4291ce(0x102)]||_0x17e9f7[_0x4291ce(0x102)][_0x4291ce(0x10d)]!=='admin')return _0x56fb97['status'](0x193)[_0x4291ce(0x121)]({'success':![],'message':_0x4291ce(0x113)});_0x29d44a();};function a16_0x5352(_0x2a6d3d,_0x314a83){const _0x137dde=a16_0x137d();return a16_0x5352=function(_0x535272,_0x255e02){_0x535272=_0x535272-0xfe;let _0x12ab4d=_0x137dde[_0x535272];return _0x12ab4d;},a16_0x5352(_0x2a6d3d,_0x314a83);}exports[a16_0x346f82(0xff)]=requireAdmin;const requireShop=(_0x21d389,_0x57a469,_0x3693e9)=>{const _0x44071c=a16_0x346f82;if(!_0x21d389['user']||_0x21d389[_0x44071c(0x102)][_0x44071c(0x10d)]!=='shop')return _0x57a469[_0x44071c(0x124)](0x193)['json']({'success':![],'message':_0x44071c(0x107)});_0x3693e9();};exports[a16_0x346f82(0x11e)]=requireShop;const requireActiveShop=async(_0x3c25cb,_0x18168f,_0x3f1693)=>{const _0xf845f6=a16_0x346f82;if(!_0x3c25cb[_0xf845f6(0x102)]||_0x3c25cb[_0xf845f6(0x102)]['role']!==_0xf845f6(0x11c))return _0x18168f['status'](0x193)[_0xf845f6(0x121)]({'success':![],'message':'Shop\x20access\x20required'});try{const _0x4659bc=require(_0xf845f6(0x10b))[_0xf845f6(0x116)],_0xf8bf1c=await _0x4659bc['shop'][_0xf845f6(0x105)]({'where':{'id':_0x3c25cb[_0xf845f6(0x102)]['id']},'select':{'status':!![]}});if(!_0xf8bf1c||_0xf8bf1c[_0xf845f6(0x124)]!==_0xf845f6(0x117))return _0x18168f[_0xf845f6(0x124)](0x193)['json']({'success':![],'message':_0xf845f6(0x125),'suspended':_0xf8bf1c?.[_0xf845f6(0x124)]===_0xf845f6(0x11b)});_0x3f1693();}catch(_0x26e967){return console[_0xf845f6(0x10c)](_0xf845f6(0x122),_0x26e967),_0x18168f['status'](0x1f4)['json']({'success':![],'message':_0xf845f6(0x10f)});}};exports[a16_0x346f82(0x106)]=requireActiveShop;