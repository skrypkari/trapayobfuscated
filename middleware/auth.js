'use strict';const a18_0x1f10ab=a18_0x1ea5;function a18_0x1ea5(_0x2a9cf7,_0x438124){const _0x2d1cd9=a18_0x2d1c();return a18_0x1ea5=function(_0x1ea5ed,_0x3f955e){_0x1ea5ed=_0x1ea5ed-0xcc;let _0x4e6fe8=_0x2d1cd9[_0x1ea5ed];return _0x4e6fe8;},a18_0x1ea5(_0x2a9cf7,_0x438124);}(function(_0x59db19,_0x456ebf){const _0x41fa85=a18_0x1ea5,_0x4f2bce=_0x59db19();while(!![]){try{const _0x168ee1=parseInt(_0x41fa85(0xef))/0x1+parseInt(_0x41fa85(0xe0))/0x2+-parseInt(_0x41fa85(0xe6))/0x3+parseInt(_0x41fa85(0xe2))/0x4+-parseInt(_0x41fa85(0xf1))/0x5+parseInt(_0x41fa85(0xe5))/0x6+-parseInt(_0x41fa85(0xed))/0x7;if(_0x168ee1===_0x456ebf)break;else _0x4f2bce['push'](_0x4f2bce['shift']());}catch(_0xf13055){_0x4f2bce['push'](_0x4f2bce['shift']());}}}(a18_0x2d1c,0x257da));var __importDefault=this&&this[a18_0x1f10ab(0xf2)]||function(_0x214d0a){const _0x42e5ee=a18_0x1f10ab;return _0x214d0a&&_0x214d0a[_0x42e5ee(0xd6)]?_0x214d0a:{'default':_0x214d0a};};Object[a18_0x1f10ab(0xec)](exports,a18_0x1f10ab(0xd6),{'value':!![]}),exports[a18_0x1f10ab(0xcc)]=exports[a18_0x1f10ab(0xd3)]=exports[a18_0x1f10ab(0xd9)]=exports[a18_0x1f10ab(0xee)]=void 0x0;const jsonwebtoken_1=__importDefault(require('jsonwebtoken')),config_1=require(a18_0x1f10ab(0xe9)),tokenBlacklistService_1=require(a18_0x1f10ab(0xdc)),authenticateToken=(_0x4c06a7,_0x24c6ff,_0x3b9cc1)=>{const _0x60ee39=a18_0x1f10ab,_0x171755=_0x4c06a7['headers'][_0x60ee39(0xf3)],_0x3e7b95=_0x171755&&_0x171755[_0x60ee39(0xd2)]('\x20')[0x1];if(!_0x3e7b95)return _0x24c6ff[_0x60ee39(0xd1)](0x191)[_0x60ee39(0xdb)]({'success':![],'message':_0x60ee39(0xea)});if(tokenBlacklistService_1[_0x60ee39(0xd7)][_0x60ee39(0xe8)](_0x3e7b95))return _0x24c6ff['status'](0x191)[_0x60ee39(0xdb)]({'success':![],'message':'Token\x20has\x20been\x20revoked'});jsonwebtoken_1[_0x60ee39(0xe7)][_0x60ee39(0xdf)](_0x3e7b95,config_1['config'][_0x60ee39(0xeb)][_0x60ee39(0xf4)],(_0x524e81,_0x44a568)=>{const _0x46f07e=_0x60ee39;if(_0x524e81)return _0x24c6ff[_0x46f07e(0xd1)](0x193)[_0x46f07e(0xdb)]({'success':![],'message':_0x46f07e(0xe4)});_0x4c06a7[_0x46f07e(0xd8)]=_0x44a568,_0x4c06a7[_0x46f07e(0xd4)]=_0x3e7b95,_0x3b9cc1();});};exports['authenticateToken']=authenticateToken;const requireAdmin=(_0x31750a,_0x5a169a,_0xc8ba9)=>{const _0x1a4463=a18_0x1f10ab;if(!_0x31750a[_0x1a4463(0xd8)]||_0x31750a['user'][_0x1a4463(0xdd)]!==_0x1a4463(0xda))return _0x5a169a['status'](0x193)[_0x1a4463(0xdb)]({'success':![],'message':_0x1a4463(0xd0)});_0xc8ba9();};exports[a18_0x1f10ab(0xd9)]=requireAdmin;const requireShop=(_0x5a11fb,_0x58b964,_0x260f59)=>{const _0x16ebb9=a18_0x1f10ab;if(!_0x5a11fb[_0x16ebb9(0xd8)]||_0x5a11fb[_0x16ebb9(0xd8)][_0x16ebb9(0xdd)]!==_0x16ebb9(0xd5))return _0x58b964[_0x16ebb9(0xd1)](0x193)['json']({'success':![],'message':_0x16ebb9(0xce)});_0x260f59();};exports[a18_0x1f10ab(0xd3)]=requireShop;const requireActiveShop=async(_0x587cad,_0xf6c501,_0x5a77a0)=>{const _0x495a16=a18_0x1f10ab;if(!_0x587cad[_0x495a16(0xd8)]||_0x587cad[_0x495a16(0xd8)][_0x495a16(0xdd)]!==_0x495a16(0xd5))return _0xf6c501[_0x495a16(0xd1)](0x193)['json']({'success':![],'message':_0x495a16(0xce)});try{const _0x1ec4bf=require(_0x495a16(0xde))[_0x495a16(0xe7)],_0x1feca3=await _0x1ec4bf[_0x495a16(0xd5)][_0x495a16(0xcd)]({'where':{'id':_0x587cad[_0x495a16(0xd8)]['id']},'select':{'status':!![]}});if(!_0x1feca3||_0x1feca3[_0x495a16(0xd1)]!==_0x495a16(0xe3))return _0xf6c501[_0x495a16(0xd1)](0x193)[_0x495a16(0xdb)]({'success':![],'message':_0x495a16(0xf0),'suspended':_0x1feca3?.[_0x495a16(0xd1)]==='SUSPENDED'});_0x5a77a0();}catch(_0xbe6d93){return console[_0x495a16(0xcf)]('Error\x20checking\x20account\x20status:',_0xbe6d93),_0xf6c501[_0x495a16(0xd1)](0x1f4)[_0x495a16(0xdb)]({'success':![],'message':_0x495a16(0xe1)});}};function a18_0x2d1c(){const _0x4862fb=['secret','requireActiveShop','findUnique','Shop\x20access\x20required','error','Admin\x20access\x20required','status','split','requireShop','token','shop','__esModule','tokenBlacklistService','user','requireAdmin','admin','json','../services/tokenBlacklistService','role','../config/database','verify','547210MCHXZQ','Error\x20checking\x20account\x20status','895884jbKqmr','ACTIVE','Invalid\x20or\x20expired\x20token','134232tgQSiI','205311kGQrJe','default','isTokenBlacklisted','../config/config','Access\x20token\x20required','jwt','defineProperty','1470805pDoqrh','authenticateToken','71777KDYQSq','Account\x20is\x20suspended\x20or\x20inactive.\x20Contact\x20administrator\x20to\x20activate\x20your\x20account.','798055sNBIbq','__importDefault','authorization'];a18_0x2d1c=function(){return _0x4862fb;};return a18_0x2d1c();}exports['requireActiveShop']=requireActiveShop;