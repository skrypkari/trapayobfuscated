'use strict';const a16_0x472bc6=a16_0x32bf;(function(_0x1c4ec9,_0x5e2c12){const _0x351676=a16_0x32bf,_0x11e7b2=_0x1c4ec9();while(!![]){try{const _0x530acf=-parseInt(_0x351676(0x1d0))/0x1+parseInt(_0x351676(0x1d1))/0x2+-parseInt(_0x351676(0x1bb))/0x3+-parseInt(_0x351676(0x1b6))/0x4+-parseInt(_0x351676(0x1c9))/0x5+parseInt(_0x351676(0x1c7))/0x6*(-parseInt(_0x351676(0x1c4))/0x7)+parseInt(_0x351676(0x1bf))/0x8;if(_0x530acf===_0x5e2c12)break;else _0x11e7b2['push'](_0x11e7b2['shift']());}catch(_0x457692){_0x11e7b2['push'](_0x11e7b2['shift']());}}}(a16_0xc90b,0xb9091));function a16_0x32bf(_0x55de0e,_0x223e92){const _0xc90bc=a16_0xc90b();return a16_0x32bf=function(_0x32bf58,_0x46e44a){_0x32bf58=_0x32bf58-0x1b6;let _0x2c51f7=_0xc90bc[_0x32bf58];return _0x2c51f7;},a16_0x32bf(_0x55de0e,_0x223e92);}var __importDefault=this&&this[a16_0x472bc6(0x1cd)]||function(_0x3480bb){return _0x3480bb&&_0x3480bb['__esModule']?_0x3480bb:{'default':_0x3480bb};};Object['defineProperty'](exports,a16_0x472bc6(0x1d2),{'value':!![]}),exports[a16_0x472bc6(0x1cb)]=exports[a16_0x472bc6(0x1c5)]=exports[a16_0x472bc6(0x1c8)]=exports[a16_0x472bc6(0x1ca)]=void 0x0;function a16_0xc90b(){const _0x366a39=['isTokenBlacklisted','Invalid\x20or\x20expired\x20token','findUnique','tokenBlacklistService','jsonwebtoken','2601612cpkLkv','SUSPENDED','user','Error\x20checking\x20account\x20status:','role','1374879uoyOYQ','status','admin','error','26215512AiRveu','default','jwt','shop','config','14vmnbHY','requireShop','token','2727708JBbGeM','requireAdmin','2579110TSHrde','authenticateToken','requireActiveShop','ACTIVE','__importDefault','Error\x20checking\x20account\x20status','json','108570YRIlgk','246580URzaVS','__esModule','Account\x20is\x20suspended\x20or\x20inactive.\x20Contact\x20administrator\x20to\x20activate\x20your\x20account.','Shop\x20access\x20required','verify','../services/tokenBlacklistService'];a16_0xc90b=function(){return _0x366a39;};return a16_0xc90b();}const jsonwebtoken_1=__importDefault(require(a16_0x472bc6(0x1db))),config_1=require('../config/config'),tokenBlacklistService_1=require(a16_0x472bc6(0x1d6)),authenticateToken=(_0x330292,_0x472d9a,_0xf26793)=>{const _0x258415=a16_0x472bc6,_0x5ba5d=_0x330292['headers']['authorization'],_0x159047=_0x5ba5d&&_0x5ba5d['split']('\x20')[0x1];if(!_0x159047)return _0x472d9a[_0x258415(0x1bc)](0x191)[_0x258415(0x1cf)]({'success':![],'message':'Access\x20token\x20required'});if(tokenBlacklistService_1[_0x258415(0x1da)][_0x258415(0x1d7)](_0x159047))return _0x472d9a[_0x258415(0x1bc)](0x191)[_0x258415(0x1cf)]({'success':![],'message':'Token\x20has\x20been\x20revoked'});jsonwebtoken_1['default'][_0x258415(0x1d5)](_0x159047,config_1[_0x258415(0x1c3)][_0x258415(0x1c1)]['secret'],(_0x5d0847,_0x3096a4)=>{const _0x4318af=_0x258415;if(_0x5d0847)return _0x472d9a['status'](0x193)[_0x4318af(0x1cf)]({'success':![],'message':_0x4318af(0x1d8)});_0x330292[_0x4318af(0x1b8)]=_0x3096a4,_0x330292[_0x4318af(0x1c6)]=_0x159047,_0xf26793();});};exports[a16_0x472bc6(0x1ca)]=authenticateToken;const requireAdmin=(_0x59042f,_0x1c5149,_0x3d53a5)=>{const _0x194597=a16_0x472bc6;if(!_0x59042f[_0x194597(0x1b8)]||_0x59042f[_0x194597(0x1b8)][_0x194597(0x1ba)]!==_0x194597(0x1bd))return _0x1c5149[_0x194597(0x1bc)](0x193)['json']({'success':![],'message':'Admin\x20access\x20required'});_0x3d53a5();};exports[a16_0x472bc6(0x1c8)]=requireAdmin;const requireShop=(_0x211bfe,_0x538f3b,_0x3c086a)=>{const _0xc72676=a16_0x472bc6;if(!_0x211bfe[_0xc72676(0x1b8)]||_0x211bfe[_0xc72676(0x1b8)][_0xc72676(0x1ba)]!==_0xc72676(0x1c2))return _0x538f3b[_0xc72676(0x1bc)](0x193)[_0xc72676(0x1cf)]({'success':![],'message':_0xc72676(0x1d4)});_0x3c086a();};exports[a16_0x472bc6(0x1c5)]=requireShop;const requireActiveShop=async(_0x408461,_0x100c1f,_0x5d65de)=>{const _0x15df94=a16_0x472bc6;if(!_0x408461[_0x15df94(0x1b8)]||_0x408461['user'][_0x15df94(0x1ba)]!==_0x15df94(0x1c2))return _0x100c1f['status'](0x193)[_0x15df94(0x1cf)]({'success':![],'message':'Shop\x20access\x20required'});try{const _0x44fc01=require('../config/database')[_0x15df94(0x1c0)],_0x142f54=await _0x44fc01['shop'][_0x15df94(0x1d9)]({'where':{'id':_0x408461[_0x15df94(0x1b8)]['id']},'select':{'status':!![]}});if(!_0x142f54||_0x142f54[_0x15df94(0x1bc)]!==_0x15df94(0x1cc))return _0x100c1f[_0x15df94(0x1bc)](0x193)[_0x15df94(0x1cf)]({'success':![],'message':_0x15df94(0x1d3),'suspended':_0x142f54?.[_0x15df94(0x1bc)]===_0x15df94(0x1b7)});_0x5d65de();}catch(_0x3f4b98){return console[_0x15df94(0x1be)](_0x15df94(0x1b9),_0x3f4b98),_0x100c1f['status'](0x1f4)['json']({'success':![],'message':_0x15df94(0x1ce)});}};exports[a16_0x472bc6(0x1cb)]=requireActiveShop;