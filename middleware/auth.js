'use strict';const a16_0x5b5fb2=a16_0x3d1b;(function(_0x1534c2,_0x332f35){const _0x49545e=a16_0x3d1b,_0x5ad57a=_0x1534c2();while(!![]){try{const _0x33ee63=-parseInt(_0x49545e(0xd9))/0x1*(-parseInt(_0x49545e(0xe4))/0x2)+-parseInt(_0x49545e(0xdc))/0x3*(parseInt(_0x49545e(0xe6))/0x4)+parseInt(_0x49545e(0xe5))/0x5+-parseInt(_0x49545e(0xc6))/0x6+parseInt(_0x49545e(0xd8))/0x7*(-parseInt(_0x49545e(0xd5))/0x8)+parseInt(_0x49545e(0xca))/0x9+parseInt(_0x49545e(0xce))/0xa*(parseInt(_0x49545e(0xd7))/0xb);if(_0x33ee63===_0x332f35)break;else _0x5ad57a['push'](_0x5ad57a['shift']());}catch(_0x4134d1){_0x5ad57a['push'](_0x5ad57a['shift']());}}}(a16_0x13b1,0xe05cd));var __importDefault=this&&this[a16_0x5b5fb2(0xda)]||function(_0x4d644d){const _0x8e27d7=a16_0x5b5fb2;return _0x4d644d&&_0x4d644d[_0x8e27d7(0xe0)]?_0x4d644d:{'default':_0x4d644d};};Object['defineProperty'](exports,'__esModule',{'value':!![]}),exports[a16_0x5b5fb2(0xc3)]=exports['requireAdmin']=exports['authenticateToken']=void 0x0;const jsonwebtoken_1=__importDefault(require(a16_0x5b5fb2(0xe2))),config_1=require(a16_0x5b5fb2(0xd0)),tokenBlacklistService_1=require(a16_0x5b5fb2(0xd3)),authenticateToken=(_0x1a15d1,_0x415988,_0x348722)=>{const _0x36237c=a16_0x5b5fb2,_0x2309f5=_0x1a15d1['headers'][_0x36237c(0xcc)],_0x4b2d5e=_0x2309f5&&_0x2309f5[_0x36237c(0xd6)]('\x20')[0x1];if(!_0x4b2d5e)return _0x415988[_0x36237c(0xdb)](0x191)[_0x36237c(0xc4)]({'success':![],'message':_0x36237c(0xdd)});if(tokenBlacklistService_1[_0x36237c(0xcb)][_0x36237c(0xdf)](_0x4b2d5e))return _0x415988[_0x36237c(0xdb)](0x191)[_0x36237c(0xc4)]({'success':![],'message':'Token\x20has\x20been\x20revoked'});jsonwebtoken_1[_0x36237c(0xc9)][_0x36237c(0xcf)](_0x4b2d5e,config_1[_0x36237c(0xc5)][_0x36237c(0xd2)]['secret'],(_0x5aac32,_0x5f54d3)=>{const _0x53fdd8=_0x36237c;if(_0x5aac32)return _0x415988[_0x53fdd8(0xdb)](0x193)[_0x53fdd8(0xc4)]({'success':![],'message':'Invalid\x20or\x20expired\x20token'});_0x1a15d1[_0x53fdd8(0xe1)]=_0x5f54d3,_0x1a15d1[_0x53fdd8(0xde)]=_0x4b2d5e,_0x348722();});};exports['authenticateToken']=authenticateToken;const requireAdmin=(_0x30d0b9,_0xbc1f60,_0x4654ac)=>{const _0x3c530f=a16_0x5b5fb2;if(!_0x30d0b9[_0x3c530f(0xe1)]||_0x30d0b9['user']['role']!==_0x3c530f(0xd1))return _0xbc1f60[_0x3c530f(0xdb)](0x193)['json']({'success':![],'message':_0x3c530f(0xd4)});_0x4654ac();};function a16_0x13b1(){const _0x13a637=['184agCdJn','split','18401449XPBHgr','514171ssqfTR','288061wLaugv','__importDefault','status','12ULyyVN','Access\x20token\x20required','token','isTokenBlacklisted','__esModule','user','jsonwebtoken','Shop\x20access\x20required','6FVGOtn','364555lWwaAM','943300hfzFIc','requireShop','json','config','5200980NZFVUO','requireAdmin','shop','default','16277265klkswj','tokenBlacklistService','authorization','role','10XegLcc','verify','../config/config','admin','jwt','../services/tokenBlacklistService','Admin\x20access\x20required'];a16_0x13b1=function(){return _0x13a637;};return a16_0x13b1();}exports[a16_0x5b5fb2(0xc7)]=requireAdmin;function a16_0x3d1b(_0x1a6ae8,_0x5ab269){const _0x13b190=a16_0x13b1();return a16_0x3d1b=function(_0x3d1b44,_0x1d4999){_0x3d1b44=_0x3d1b44-0xc3;let _0x3046c5=_0x13b190[_0x3d1b44];return _0x3046c5;},a16_0x3d1b(_0x1a6ae8,_0x5ab269);}const requireShop=(_0x236993,_0x50dcc2,_0x1feb68)=>{const _0x5e3719=a16_0x5b5fb2;if(!_0x236993['user']||_0x236993[_0x5e3719(0xe1)][_0x5e3719(0xcd)]!==_0x5e3719(0xc8))return _0x50dcc2[_0x5e3719(0xdb)](0x193)[_0x5e3719(0xc4)]({'success':![],'message':_0x5e3719(0xe3)});_0x1feb68();};exports[a16_0x5b5fb2(0xc3)]=requireShop;