'use strict';const a16_0x9a65f=a16_0x24bb;(function(_0x42e013,_0x18cabf){const _0x5646c6=a16_0x24bb,_0x280025=_0x42e013();while(!![]){try{const _0x475ef6=-parseInt(_0x5646c6(0xd6))/0x1+parseInt(_0x5646c6(0xc7))/0x2+parseInt(_0x5646c6(0xcb))/0x3+parseInt(_0x5646c6(0xd5))/0x4+-parseInt(_0x5646c6(0xdb))/0x5*(parseInt(_0x5646c6(0xcf))/0x6)+-parseInt(_0x5646c6(0xd7))/0x7+parseInt(_0x5646c6(0xde))/0x8;if(_0x475ef6===_0x18cabf)break;else _0x280025['push'](_0x280025['shift']());}catch(_0x29fe9c){_0x280025['push'](_0x280025['shift']());}}}(a16_0x1b6a,0xd4859));function a16_0x1b6a(){const _0x33a72f=['__esModule','7445952gUdYAK','user','shop','Invalid\x20or\x20expired\x20token','defineProperty','Shop\x20access\x20required','jsonwebtoken','authenticateToken','../config/config','650898BvGigZ','secret','Admin\x20access\x20required','config','1617615cydycY','token','admin','authorization','10692uZiOrI','json','role','Access\x20token\x20required','../services/tokenBlacklistService','Token\x20has\x20been\x20revoked','6132732wsqazG','219360bZpiEC','8548470mngRLI','status','requireShop','default','2855unUeWP','__importDefault'];a16_0x1b6a=function(){return _0x33a72f;};return a16_0x1b6a();}var __importDefault=this&&this[a16_0x9a65f(0xdc)]||function(_0x1c15df){const _0x18d750=a16_0x9a65f;return _0x1c15df&&_0x1c15df[_0x18d750(0xdd)]?_0x1c15df:{'default':_0x1c15df};};function a16_0x24bb(_0x13d335,_0x1ef218){const _0x1b6a7a=a16_0x1b6a();return a16_0x24bb=function(_0x24bb9b,_0x28567b){_0x24bb9b=_0x24bb9b-0xc1;let _0x4e0058=_0x1b6a7a[_0x24bb9b];return _0x4e0058;},a16_0x24bb(_0x13d335,_0x1ef218);}Object[a16_0x9a65f(0xc2)](exports,a16_0x9a65f(0xdd),{'value':!![]}),exports['requireShop']=exports['requireAdmin']=exports[a16_0x9a65f(0xc5)]=void 0x0;const jsonwebtoken_1=__importDefault(require(a16_0x9a65f(0xc4))),config_1=require(a16_0x9a65f(0xc6)),tokenBlacklistService_1=require(a16_0x9a65f(0xd3)),authenticateToken=(_0x3c6b5f,_0x12925f,_0x102f18)=>{const _0x1b2225=a16_0x9a65f,_0x1a48dc=_0x3c6b5f['headers'][_0x1b2225(0xce)],_0x4e123e=_0x1a48dc&&_0x1a48dc['split']('\x20')[0x1];if(!_0x4e123e)return _0x12925f['status'](0x191)['json']({'success':![],'message':_0x1b2225(0xd2)});if(tokenBlacklistService_1['tokenBlacklistService']['isTokenBlacklisted'](_0x4e123e))return _0x12925f[_0x1b2225(0xd8)](0x191)[_0x1b2225(0xd0)]({'success':![],'message':_0x1b2225(0xd4)});jsonwebtoken_1[_0x1b2225(0xda)]['verify'](_0x4e123e,config_1[_0x1b2225(0xca)]['jwt'][_0x1b2225(0xc8)],(_0x27b92a,_0xa87510)=>{const _0x2299f9=_0x1b2225;if(_0x27b92a)return _0x12925f['status'](0x193)['json']({'success':![],'message':_0x2299f9(0xc1)});_0x3c6b5f['user']=_0xa87510,_0x3c6b5f[_0x2299f9(0xcc)]=_0x4e123e,_0x102f18();});};exports[a16_0x9a65f(0xc5)]=authenticateToken;const requireAdmin=(_0x27477c,_0x36da27,_0x1cff95)=>{const _0x3e41e0=a16_0x9a65f;if(!_0x27477c[_0x3e41e0(0xdf)]||_0x27477c[_0x3e41e0(0xdf)][_0x3e41e0(0xd1)]!==_0x3e41e0(0xcd))return _0x36da27[_0x3e41e0(0xd8)](0x193)[_0x3e41e0(0xd0)]({'success':![],'message':_0x3e41e0(0xc9)});_0x1cff95();};exports['requireAdmin']=requireAdmin;const requireShop=(_0x52b55f,_0x444121,_0xc4e275)=>{const _0x3b21e2=a16_0x9a65f;if(!_0x52b55f[_0x3b21e2(0xdf)]||_0x52b55f['user']['role']!==_0x3b21e2(0xe0))return _0x444121[_0x3b21e2(0xd8)](0x193)[_0x3b21e2(0xd0)]({'success':![],'message':_0x3b21e2(0xc3)});_0xc4e275();};exports[a16_0x9a65f(0xd9)]=requireShop;