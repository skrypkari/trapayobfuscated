'use strict';const a16_0x31e8d1=a16_0x1f9c;(function(_0x23b74e,_0x46b30c){const _0x823f29=a16_0x1f9c,_0x440a66=_0x23b74e();while(!![]){try{const _0xbd358=parseInt(_0x823f29(0xeb))/0x1*(-parseInt(_0x823f29(0xee))/0x2)+parseInt(_0x823f29(0xe2))/0x3+-parseInt(_0x823f29(0xcd))/0x4+parseInt(_0x823f29(0xe9))/0x5*(-parseInt(_0x823f29(0xd7))/0x6)+-parseInt(_0x823f29(0xd5))/0x7+-parseInt(_0x823f29(0xcf))/0x8+parseInt(_0x823f29(0xea))/0x9;if(_0xbd358===_0x46b30c)break;else _0x440a66['push'](_0x440a66['shift']());}catch(_0x487657){_0x440a66['push'](_0x440a66['shift']());}}}(a16_0x1c8e,0x1b556));var __importDefault=this&&this[a16_0x31e8d1(0xed)]||function(_0x379c1a){const _0x3204f2=a16_0x31e8d1;return _0x379c1a&&_0x379c1a[_0x3204f2(0xd6)]?_0x379c1a:{'default':_0x379c1a};};Object[a16_0x31e8d1(0xda)](exports,'__esModule',{'value':!![]}),exports[a16_0x31e8d1(0xcb)]=exports['requireShop']=exports['requireAdmin']=exports[a16_0x31e8d1(0xdb)]=void 0x0;const jsonwebtoken_1=__importDefault(require(a16_0x31e8d1(0xce))),config_1=require(a16_0x31e8d1(0xd4)),tokenBlacklistService_1=require(a16_0x31e8d1(0xf1)),authenticateToken=(_0x59eab6,_0x9cdc11,_0x33f07d)=>{const _0x1d21d0=a16_0x31e8d1,_0x51c7ab=_0x59eab6[_0x1d21d0(0xe4)][_0x1d21d0(0xde)],_0x3ecc67=_0x51c7ab&&_0x51c7ab[_0x1d21d0(0xcc)]('\x20')[0x1];if(!_0x3ecc67)return _0x9cdc11['status'](0x191)[_0x1d21d0(0xdd)]({'success':![],'message':'Access\x20token\x20required'});if(tokenBlacklistService_1[_0x1d21d0(0xca)]['isTokenBlacklisted'](_0x3ecc67))return _0x9cdc11[_0x1d21d0(0xd0)](0x191)[_0x1d21d0(0xdd)]({'success':![],'message':_0x1d21d0(0xd3)});jsonwebtoken_1[_0x1d21d0(0xe8)]['verify'](_0x3ecc67,config_1[_0x1d21d0(0xd1)][_0x1d21d0(0xef)]['secret'],(_0x14a73d,_0x9223ca)=>{const _0x471aa0=_0x1d21d0;if(_0x14a73d)return _0x9cdc11['status'](0x193)[_0x471aa0(0xdd)]({'success':![],'message':_0x471aa0(0xe6)});_0x59eab6[_0x471aa0(0xf0)]=_0x9223ca,_0x59eab6[_0x471aa0(0xd8)]=_0x3ecc67,_0x33f07d();});};exports['authenticateToken']=authenticateToken;const requireAdmin=(_0x511488,_0x2645a5,_0x50c45a)=>{const _0x1bdb3f=a16_0x31e8d1;if(!_0x511488[_0x1bdb3f(0xf0)]||_0x511488[_0x1bdb3f(0xf0)][_0x1bdb3f(0xdf)]!==_0x1bdb3f(0xd9))return _0x2645a5['status'](0x193)[_0x1bdb3f(0xdd)]({'success':![],'message':'Admin\x20access\x20required'});_0x50c45a();};exports[a16_0x31e8d1(0xd2)]=requireAdmin;const requireShop=(_0x2dd006,_0x28a25e,_0x489c59)=>{const _0x3640dc=a16_0x31e8d1;if(!_0x2dd006['user']||_0x2dd006[_0x3640dc(0xf0)][_0x3640dc(0xdf)]!==_0x3640dc(0xec))return _0x28a25e[_0x3640dc(0xd0)](0x193)[_0x3640dc(0xdd)]({'success':![],'message':_0x3640dc(0xe1)});_0x489c59();};function a16_0x1c8e(){const _0x4113c2=['admin','defineProperty','authenticateToken','../config/database','json','authorization','role','error','Shop\x20access\x20required','229062rWjpZq','ACTIVE','headers','Error\x20checking\x20account\x20status','Invalid\x20or\x20expired\x20token','requireShop','default','10ohZdci','4469076rpMIUB','25669ITPZDv','shop','__importDefault','2auOQeB','jwt','user','../services/tokenBlacklistService','tokenBlacklistService','requireActiveShop','split','73696qjQLQL','jsonwebtoken','890008ltised','status','config','requireAdmin','Token\x20has\x20been\x20revoked','../config/config','1512070FpptRh','__esModule','268818RLoJpn','token'];a16_0x1c8e=function(){return _0x4113c2;};return a16_0x1c8e();}function a16_0x1f9c(_0x162642,_0x1c40ed){const _0x1c8e96=a16_0x1c8e();return a16_0x1f9c=function(_0x1f9cbc,_0x2e455c){_0x1f9cbc=_0x1f9cbc-0xca;let _0x507614=_0x1c8e96[_0x1f9cbc];return _0x507614;},a16_0x1f9c(_0x162642,_0x1c40ed);}exports[a16_0x31e8d1(0xe7)]=requireShop;const requireActiveShop=async(_0x452417,_0x287792,_0x4fea47)=>{const _0x59fc2=a16_0x31e8d1;if(!_0x452417[_0x59fc2(0xf0)]||_0x452417['user'][_0x59fc2(0xdf)]!==_0x59fc2(0xec))return _0x287792[_0x59fc2(0xd0)](0x193)['json']({'success':![],'message':'Shop\x20access\x20required'});try{const _0x206f41=require(_0x59fc2(0xdc))[_0x59fc2(0xe8)],_0x355e2c=await _0x206f41[_0x59fc2(0xec)]['findUnique']({'where':{'id':_0x452417[_0x59fc2(0xf0)]['id']},'select':{'status':!![]}});if(!_0x355e2c||_0x355e2c['status']!==_0x59fc2(0xe3))return _0x287792[_0x59fc2(0xd0)](0x193)[_0x59fc2(0xdd)]({'success':![],'message':'Account\x20is\x20suspended\x20or\x20inactive.\x20Contact\x20administrator\x20to\x20activate\x20your\x20account.','suspended':_0x355e2c?.[_0x59fc2(0xd0)]==='SUSPENDED'});_0x4fea47();}catch(_0x243cc8){return console[_0x59fc2(0xe0)]('Error\x20checking\x20account\x20status:',_0x243cc8),_0x287792[_0x59fc2(0xd0)](0x1f4)[_0x59fc2(0xdd)]({'success':![],'message':_0x59fc2(0xe5)});}};exports[a16_0x31e8d1(0xcb)]=requireActiveShop;