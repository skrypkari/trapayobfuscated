'use strict';const a16_0x5a5571=a16_0x2e51;function a16_0x2e51(_0x14677c,_0xbae2ee){const _0x46f67f=a16_0x46f6();return a16_0x2e51=function(_0x2e5188,_0x28255e){_0x2e5188=_0x2e5188-0xc2;let _0x167895=_0x46f67f[_0x2e5188];return _0x167895;},a16_0x2e51(_0x14677c,_0xbae2ee);}(function(_0x6b2736,_0x2a3ac8){const _0x40e938=a16_0x2e51,_0x1c7844=_0x6b2736();while(!![]){try{const _0x11dea2=parseInt(_0x40e938(0xc4))/0x1+parseInt(_0x40e938(0xee))/0x2*(parseInt(_0x40e938(0xd8))/0x3)+-parseInt(_0x40e938(0xdd))/0x4*(-parseInt(_0x40e938(0xed))/0x5)+-parseInt(_0x40e938(0xdc))/0x6*(-parseInt(_0x40e938(0xc3))/0x7)+-parseInt(_0x40e938(0xea))/0x8*(parseInt(_0x40e938(0xe0))/0x9)+-parseInt(_0x40e938(0xca))/0xa+parseInt(_0x40e938(0xce))/0xb*(-parseInt(_0x40e938(0xd4))/0xc);if(_0x11dea2===_0x2a3ac8)break;else _0x1c7844['push'](_0x1c7844['shift']());}catch(_0x3ef78d){_0x1c7844['push'](_0x1c7844['shift']());}}}(a16_0x46f6,0x1decb));var __importDefault=this&&this[a16_0x5a5571(0xc8)]||function(_0xd7c208){const _0x41617f=a16_0x5a5571;return _0xd7c208&&_0xd7c208[_0x41617f(0xc5)]?_0xd7c208:{'default':_0xd7c208};};Object[a16_0x5a5571(0xdf)](exports,a16_0x5a5571(0xc5),{'value':!![]}),exports[a16_0x5a5571(0xe3)]=exports['requireShop']=exports[a16_0x5a5571(0xcf)]=exports[a16_0x5a5571(0xc6)]=void 0x0;function a16_0x46f6(){const _0x1893ef=['Admin\x20access\x20required','requireActiveShop','ACTIVE','split','SUSPENDED','shop','tokenBlacklistService','json','175624acuCLV','../config/config','verify','20RWBlzp','956YNTRiZ','status','3955DuLiFe','9028rxYGVU','__esModule','authenticateToken','headers','__importDefault','findUnique','626370odlVJa','../config/database','requireShop','Error\x20checking\x20account\x20status:','77cIAdhS','requireAdmin','Shop\x20access\x20required','jwt','../services/tokenBlacklistService','user','206664hkiUhe','Access\x20token\x20required','Invalid\x20or\x20expired\x20token','role','189vOdwAv','Error\x20checking\x20account\x20status','default','secret','1860MoLUwt','223188ZmNImp','isTokenBlacklisted','defineProperty','54IalCKz','config'];a16_0x46f6=function(){return _0x1893ef;};return a16_0x46f6();}const jsonwebtoken_1=__importDefault(require('jsonwebtoken')),config_1=require(a16_0x5a5571(0xeb)),tokenBlacklistService_1=require(a16_0x5a5571(0xd2)),authenticateToken=(_0x500799,_0x4c8ae5,_0x12c061)=>{const _0x17a520=a16_0x5a5571,_0x362026=_0x500799[_0x17a520(0xc7)]['authorization'],_0x96ffdd=_0x362026&&_0x362026[_0x17a520(0xe5)]('\x20')[0x1];if(!_0x96ffdd)return _0x4c8ae5['status'](0x191)[_0x17a520(0xe9)]({'success':![],'message':_0x17a520(0xd5)});if(tokenBlacklistService_1[_0x17a520(0xe8)][_0x17a520(0xde)](_0x96ffdd))return _0x4c8ae5[_0x17a520(0xc2)](0x191)[_0x17a520(0xe9)]({'success':![],'message':'Token\x20has\x20been\x20revoked'});jsonwebtoken_1[_0x17a520(0xda)][_0x17a520(0xec)](_0x96ffdd,config_1[_0x17a520(0xe1)][_0x17a520(0xd1)][_0x17a520(0xdb)],(_0x475c5d,_0x11c617)=>{const _0x51547a=_0x17a520;if(_0x475c5d)return _0x4c8ae5['status'](0x193)['json']({'success':![],'message':_0x51547a(0xd6)});_0x500799[_0x51547a(0xd3)]=_0x11c617,_0x500799['token']=_0x96ffdd,_0x12c061();});};exports['authenticateToken']=authenticateToken;const requireAdmin=(_0x4330cf,_0x2a7be6,_0x198860)=>{const _0x5dd6cc=a16_0x5a5571;if(!_0x4330cf[_0x5dd6cc(0xd3)]||_0x4330cf['user'][_0x5dd6cc(0xd7)]!=='admin')return _0x2a7be6[_0x5dd6cc(0xc2)](0x193)[_0x5dd6cc(0xe9)]({'success':![],'message':_0x5dd6cc(0xe2)});_0x198860();};exports[a16_0x5a5571(0xcf)]=requireAdmin;const requireShop=(_0x16ec96,_0x5703ad,_0x53544d)=>{const _0x3b806b=a16_0x5a5571;if(!_0x16ec96[_0x3b806b(0xd3)]||_0x16ec96[_0x3b806b(0xd3)][_0x3b806b(0xd7)]!==_0x3b806b(0xe7))return _0x5703ad[_0x3b806b(0xc2)](0x193)[_0x3b806b(0xe9)]({'success':![],'message':_0x3b806b(0xd0)});_0x53544d();};exports[a16_0x5a5571(0xcc)]=requireShop;const requireActiveShop=async(_0x12ca5c,_0x1e5868,_0x3911ba)=>{const _0x4f577c=a16_0x5a5571;if(!_0x12ca5c[_0x4f577c(0xd3)]||_0x12ca5c[_0x4f577c(0xd3)][_0x4f577c(0xd7)]!=='shop')return _0x1e5868['status'](0x193)[_0x4f577c(0xe9)]({'success':![],'message':_0x4f577c(0xd0)});try{const _0x2680b3=require(_0x4f577c(0xcb))['default'],_0x17f31f=await _0x2680b3['shop'][_0x4f577c(0xc9)]({'where':{'id':_0x12ca5c[_0x4f577c(0xd3)]['id']},'select':{'status':!![]}});if(!_0x17f31f||_0x17f31f[_0x4f577c(0xc2)]!==_0x4f577c(0xe4))return _0x1e5868[_0x4f577c(0xc2)](0x193)[_0x4f577c(0xe9)]({'success':![],'message':'Account\x20is\x20suspended\x20or\x20inactive.\x20Contact\x20administrator\x20to\x20activate\x20your\x20account.','suspended':_0x17f31f?.['status']===_0x4f577c(0xe6)});_0x3911ba();}catch(_0x3036cf){return console['error'](_0x4f577c(0xcd),_0x3036cf),_0x1e5868[_0x4f577c(0xc2)](0x1f4)['json']({'success':![],'message':_0x4f577c(0xd9)});}};exports['requireActiveShop']=requireActiveShop;