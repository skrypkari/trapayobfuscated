'use strict';const a16_0x63c20a=a16_0x2fb8;function a16_0x2fb8(_0x1d011c,_0x48c5c1){const _0x4634d7=a16_0x4634();return a16_0x2fb8=function(_0x2fb867,_0x33e36a){_0x2fb867=_0x2fb867-0x1ab;let _0x3a33ee=_0x4634d7[_0x2fb867];return _0x3a33ee;},a16_0x2fb8(_0x1d011c,_0x48c5c1);}(function(_0x57d9ed,_0x145a32){const _0x242190=a16_0x2fb8,_0x36c7e3=_0x57d9ed();while(!![]){try{const _0x28ea1f=-parseInt(_0x242190(0x1c7))/0x1*(parseInt(_0x242190(0x1bb))/0x2)+-parseInt(_0x242190(0x1bc))/0x3+-parseInt(_0x242190(0x1b7))/0x4*(-parseInt(_0x242190(0x1c8))/0x5)+-parseInt(_0x242190(0x1cc))/0x6*(parseInt(_0x242190(0x1bf))/0x7)+parseInt(_0x242190(0x1bd))/0x8+-parseInt(_0x242190(0x1ac))/0x9+parseInt(_0x242190(0x1ab))/0xa;if(_0x28ea1f===_0x145a32)break;else _0x36c7e3['push'](_0x36c7e3['shift']());}catch(_0x125092){_0x36c7e3['push'](_0x36c7e3['shift']());}}}(a16_0x4634,0x723d0));var __importDefault=this&&this[a16_0x63c20a(0x1ce)]||function(_0x3f50a3){const _0xd76628=a16_0x63c20a;return _0x3f50a3&&_0x3f50a3[_0xd76628(0x1b0)]?_0x3f50a3:{'default':_0x3f50a3};};Object[a16_0x63c20a(0x1b1)](exports,a16_0x63c20a(0x1b0),{'value':!![]}),exports[a16_0x63c20a(0x1ad)]=exports[a16_0x63c20a(0x1c4)]=exports[a16_0x63c20a(0x1be)]=exports['authenticateToken']=void 0x0;function a16_0x4634(){const _0x4aae3f=['requireActiveShop','../config/database','ACTIVE','__esModule','defineProperty','user','Admin\x20access\x20required','default','error','config','3092LTNPNR','secret','Shop\x20access\x20required','role','2764bFLhBJ','2753439oxbrGi','3204816ViZQYz','requireAdmin','490308MBGRgK','Access\x20token\x20required','Invalid\x20or\x20expired\x20token','status','jwt','requireShop','json','authenticateToken','267TEBqei','3235pdnfaV','shop','../services/tokenBlacklistService','headers','24NMWPJa','Token\x20has\x20been\x20revoked','__importDefault','Error\x20checking\x20account\x20status:','findUnique','20008270BusEgm','7799913TulTEt'];a16_0x4634=function(){return _0x4aae3f;};return a16_0x4634();}const jsonwebtoken_1=__importDefault(require('jsonwebtoken')),config_1=require('../config/config'),tokenBlacklistService_1=require(a16_0x63c20a(0x1ca)),authenticateToken=(_0x5383cd,_0x3d85ec,_0x37252f)=>{const _0x1e8b61=a16_0x63c20a,_0x5e0ef2=_0x5383cd[_0x1e8b61(0x1cb)]['authorization'],_0x19d582=_0x5e0ef2&&_0x5e0ef2['split']('\x20')[0x1];if(!_0x19d582)return _0x3d85ec[_0x1e8b61(0x1c2)](0x191)[_0x1e8b61(0x1c5)]({'success':![],'message':_0x1e8b61(0x1c0)});if(tokenBlacklistService_1['tokenBlacklistService']['isTokenBlacklisted'](_0x19d582))return _0x3d85ec['status'](0x191)[_0x1e8b61(0x1c5)]({'success':![],'message':_0x1e8b61(0x1cd)});jsonwebtoken_1[_0x1e8b61(0x1b4)]['verify'](_0x19d582,config_1[_0x1e8b61(0x1b6)][_0x1e8b61(0x1c3)][_0x1e8b61(0x1b8)],(_0x3fb102,_0x1ac402)=>{const _0x548087=_0x1e8b61;if(_0x3fb102)return _0x3d85ec[_0x548087(0x1c2)](0x193)[_0x548087(0x1c5)]({'success':![],'message':_0x548087(0x1c1)});_0x5383cd['user']=_0x1ac402,_0x5383cd['token']=_0x19d582,_0x37252f();});};exports[a16_0x63c20a(0x1c6)]=authenticateToken;const requireAdmin=(_0x2a9fdb,_0x19343a,_0x3074c6)=>{const _0x5e36aa=a16_0x63c20a;if(!_0x2a9fdb[_0x5e36aa(0x1b2)]||_0x2a9fdb['user'][_0x5e36aa(0x1ba)]!=='admin')return _0x19343a[_0x5e36aa(0x1c2)](0x193)['json']({'success':![],'message':_0x5e36aa(0x1b3)});_0x3074c6();};exports[a16_0x63c20a(0x1be)]=requireAdmin;const requireShop=(_0x43baf6,_0x3278d0,_0x15fdfd)=>{const _0x52e889=a16_0x63c20a;if(!_0x43baf6[_0x52e889(0x1b2)]||_0x43baf6['user']['role']!==_0x52e889(0x1c9))return _0x3278d0[_0x52e889(0x1c2)](0x193)['json']({'success':![],'message':_0x52e889(0x1b9)});_0x15fdfd();};exports[a16_0x63c20a(0x1c4)]=requireShop;const requireActiveShop=async(_0x402b18,_0x1f99bf,_0x465b49)=>{const _0x713765=a16_0x63c20a;if(!_0x402b18[_0x713765(0x1b2)]||_0x402b18[_0x713765(0x1b2)]['role']!==_0x713765(0x1c9))return _0x1f99bf['status'](0x193)[_0x713765(0x1c5)]({'success':![],'message':_0x713765(0x1b9)});try{const _0x54b549=require(_0x713765(0x1ae))[_0x713765(0x1b4)],_0x535531=await _0x54b549['shop'][_0x713765(0x1d0)]({'where':{'id':_0x402b18[_0x713765(0x1b2)]['id']},'select':{'status':!![]}});if(!_0x535531||_0x535531[_0x713765(0x1c2)]!==_0x713765(0x1af))return _0x1f99bf[_0x713765(0x1c2)](0x193)[_0x713765(0x1c5)]({'success':![],'message':'Account\x20is\x20suspended\x20or\x20inactive.\x20Contact\x20administrator\x20to\x20activate\x20your\x20account.','suspended':_0x535531?.[_0x713765(0x1c2)]==='SUSPENDED'});_0x465b49();}catch(_0x281e6c){return console[_0x713765(0x1b5)](_0x713765(0x1cf),_0x281e6c),_0x1f99bf[_0x713765(0x1c2)](0x1f4)[_0x713765(0x1c5)]({'success':![],'message':'Error\x20checking\x20account\x20status'});}};exports[a16_0x63c20a(0x1ad)]=requireActiveShop;