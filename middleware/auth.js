'use strict';const a15_0x513b0b=a15_0x12e6;(function(_0x4e76bc,_0x3de40e){const _0x1291aa=a15_0x12e6,_0x2be2e8=_0x4e76bc();while(!![]){try{const _0x17f3ca=-parseInt(_0x1291aa(0xa7))/0x1*(parseInt(_0x1291aa(0xae))/0x2)+parseInt(_0x1291aa(0x9c))/0x3*(-parseInt(_0x1291aa(0xa1))/0x4)+parseInt(_0x1291aa(0x9f))/0x5*(-parseInt(_0x1291aa(0xa0))/0x6)+parseInt(_0x1291aa(0x99))/0x7+-parseInt(_0x1291aa(0x92))/0x8*(parseInt(_0x1291aa(0xac))/0x9)+parseInt(_0x1291aa(0xa8))/0xa*(-parseInt(_0x1291aa(0x8d))/0xb)+parseInt(_0x1291aa(0xb3))/0xc;if(_0x17f3ca===_0x3de40e)break;else _0x2be2e8['push'](_0x2be2e8['shift']());}catch(_0x5edc97){_0x2be2e8['push'](_0x2be2e8['shift']());}}}(a15_0x139b,0x3eedb));function a15_0x139b(){const _0x4d7725=['77140OmryEd','Invalid\x20or\x20expired\x20token','secret','Token\x20has\x20been\x20revoked','9LxGAKl','jwt','8MqCZiU','../services/tokenBlacklistService','json','split','default','10670280orHwWc','11zouMuF','authenticateToken','status','Shop\x20access\x20required','requireShop','1600672ZHFCWc','requireAdmin','__esModule','admin','role','token','Admin\x20access\x20required','2326828GTbsEo','user','headers','3EYASnk','isTokenBlacklisted','jsonwebtoken','1730355arWgjn','6gCKAWg','893176gcFkUX','__importDefault','defineProperty','authorization','config','../config/config','46669CCCPku'];a15_0x139b=function(){return _0x4d7725;};return a15_0x139b();}var __importDefault=this&&this[a15_0x513b0b(0xa2)]||function(_0x15af2e){const _0x1202bd=a15_0x513b0b;return _0x15af2e&&_0x15af2e[_0x1202bd(0x94)]?_0x15af2e:{'default':_0x15af2e};};Object[a15_0x513b0b(0xa3)](exports,'__esModule',{'value':!![]}),exports[a15_0x513b0b(0x91)]=exports[a15_0x513b0b(0x93)]=exports[a15_0x513b0b(0x8e)]=void 0x0;const jsonwebtoken_1=__importDefault(require(a15_0x513b0b(0x9e))),config_1=require(a15_0x513b0b(0xa6)),tokenBlacklistService_1=require(a15_0x513b0b(0xaf)),authenticateToken=(_0x457b2c,_0x54ac0c,_0x126b7d)=>{const _0x260c09=a15_0x513b0b,_0x3cf0c6=_0x457b2c[_0x260c09(0x9b)][_0x260c09(0xa4)],_0x531195=_0x3cf0c6&&_0x3cf0c6[_0x260c09(0xb1)]('\x20')[0x1];if(!_0x531195)return _0x54ac0c[_0x260c09(0x8f)](0x191)['json']({'success':![],'message':'Access\x20token\x20required'});if(tokenBlacklistService_1['tokenBlacklistService'][_0x260c09(0x9d)](_0x531195))return _0x54ac0c[_0x260c09(0x8f)](0x191)[_0x260c09(0xb0)]({'success':![],'message':_0x260c09(0xab)});jsonwebtoken_1[_0x260c09(0xb2)]['verify'](_0x531195,config_1[_0x260c09(0xa5)][_0x260c09(0xad)][_0x260c09(0xaa)],(_0x537a5e,_0x5c2890)=>{const _0x446b8b=_0x260c09;if(_0x537a5e)return _0x54ac0c['status'](0x193)['json']({'success':![],'message':_0x446b8b(0xa9)});_0x457b2c['user']=_0x5c2890,_0x457b2c[_0x446b8b(0x97)]=_0x531195,_0x126b7d();});};exports[a15_0x513b0b(0x8e)]=authenticateToken;const requireAdmin=(_0x2a1259,_0x3f35ae,_0x21744e)=>{const _0x2f0c2e=a15_0x513b0b;if(!_0x2a1259[_0x2f0c2e(0x9a)]||_0x2a1259[_0x2f0c2e(0x9a)][_0x2f0c2e(0x96)]!==_0x2f0c2e(0x95))return _0x3f35ae[_0x2f0c2e(0x8f)](0x193)[_0x2f0c2e(0xb0)]({'success':![],'message':_0x2f0c2e(0x98)});_0x21744e();};function a15_0x12e6(_0x4b9ff7,_0x39d162){const _0x139b78=a15_0x139b();return a15_0x12e6=function(_0x12e6bc,_0x4037b9){_0x12e6bc=_0x12e6bc-0x8d;let _0x12d61e=_0x139b78[_0x12e6bc];return _0x12d61e;},a15_0x12e6(_0x4b9ff7,_0x39d162);}exports[a15_0x513b0b(0x93)]=requireAdmin;const requireShop=(_0x105c9d,_0x396684,_0x143d16)=>{const _0x241fdd=a15_0x513b0b;if(!_0x105c9d[_0x241fdd(0x9a)]||_0x105c9d[_0x241fdd(0x9a)][_0x241fdd(0x96)]!=='shop')return _0x396684[_0x241fdd(0x8f)](0x193)[_0x241fdd(0xb0)]({'success':![],'message':_0x241fdd(0x90)});_0x143d16();};exports[a15_0x513b0b(0x91)]=requireShop;