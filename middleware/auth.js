'use strict';const a21_0x48eece=a21_0x3886;(function(_0xe57309,_0x239e39){const _0x57dbbb=a21_0x3886,_0x2eb1e2=_0xe57309();while(!![]){try{const _0x4eef4f=-parseInt(_0x57dbbb(0x1b3))/0x1+parseInt(_0x57dbbb(0x1a9))/0x2+parseInt(_0x57dbbb(0x1b0))/0x3+-parseInt(_0x57dbbb(0x1b1))/0x4*(-parseInt(_0x57dbbb(0x1bc))/0x5)+-parseInt(_0x57dbbb(0x1cc))/0x6*(-parseInt(_0x57dbbb(0x1c6))/0x7)+-parseInt(_0x57dbbb(0x1c0))/0x8*(parseInt(_0x57dbbb(0x1ba))/0x9)+parseInt(_0x57dbbb(0x1c4))/0xa*(-parseInt(_0x57dbbb(0x1ab))/0xb);if(_0x4eef4f===_0x239e39)break;else _0x2eb1e2['push'](_0x2eb1e2['shift']());}catch(_0x34b48d){_0x2eb1e2['push'](_0x2eb1e2['shift']());}}}(a21_0xa393,0x84874));function a21_0xa393(){const _0x5dada1=['requireShop','Invalid\x20or\x20expired\x20token','3530478sIAjBU','Error\x20checking\x20account\x20status','json','Shop\x20access\x20required','user','547624LwrMdM','admin','156035SZnenn','authenticateToken','error','role','secret','2262405daOBwB','2372644YdkCVG','headers','770006VTwETx','__importDefault','requireAdmin','isTokenBlacklisted','__esModule','authorization','default','6410466BNLtvo','jsonwebtoken','5KxmkXk','jwt','Token\x20has\x20been\x20revoked','status','8spTKHI','findUnique','shop','../services/tokenBlacklistService','130qIVikY','requireActiveShop','7UgCchB','Admin\x20access\x20required','config','Error\x20checking\x20account\x20status:'];a21_0xa393=function(){return _0x5dada1;};return a21_0xa393();}var __importDefault=this&&this[a21_0x48eece(0x1b4)]||function(_0x4920e2){const _0xd69397=a21_0x48eece;return _0x4920e2&&_0x4920e2[_0xd69397(0x1b7)]?_0x4920e2:{'default':_0x4920e2};};Object['defineProperty'](exports,a21_0x48eece(0x1b7),{'value':!![]}),exports[a21_0x48eece(0x1c5)]=exports[a21_0x48eece(0x1ca)]=exports[a21_0x48eece(0x1b5)]=exports[a21_0x48eece(0x1ac)]=void 0x0;const jsonwebtoken_1=__importDefault(require(a21_0x48eece(0x1bb))),config_1=require('../config/config'),tokenBlacklistService_1=require(a21_0x48eece(0x1c3)),authenticateToken=(_0x40929d,_0x20c9a1,_0x419133)=>{const _0x5c88f3=a21_0x48eece,_0x3b3413=_0x40929d[_0x5c88f3(0x1b2)][_0x5c88f3(0x1b8)],_0x59478d=_0x3b3413&&_0x3b3413['split']('\x20')[0x1];if(!_0x59478d)return _0x20c9a1['status'](0x191)[_0x5c88f3(0x1ce)]({'success':![],'message':'Access\x20token\x20required'});if(tokenBlacklistService_1['tokenBlacklistService'][_0x5c88f3(0x1b6)](_0x59478d))return _0x20c9a1['status'](0x191)[_0x5c88f3(0x1ce)]({'success':![],'message':_0x5c88f3(0x1be)});jsonwebtoken_1['default']['verify'](_0x59478d,config_1[_0x5c88f3(0x1c8)][_0x5c88f3(0x1bd)][_0x5c88f3(0x1af)],(_0x3393f4,_0x4e970c)=>{const _0x5073a8=_0x5c88f3;if(_0x3393f4)return _0x20c9a1[_0x5073a8(0x1bf)](0x193)[_0x5073a8(0x1ce)]({'success':![],'message':_0x5073a8(0x1cb)});_0x40929d['user']=_0x4e970c,_0x40929d['token']=_0x59478d,_0x419133();});};exports[a21_0x48eece(0x1ac)]=authenticateToken;const requireAdmin=(_0x18f237,_0x527d4d,_0x4a2a71)=>{const _0x68b149=a21_0x48eece;if(!_0x18f237[_0x68b149(0x1d0)]||_0x18f237[_0x68b149(0x1d0)]['role']!==_0x68b149(0x1aa))return _0x527d4d[_0x68b149(0x1bf)](0x193)[_0x68b149(0x1ce)]({'success':![],'message':_0x68b149(0x1c7)});_0x4a2a71();};exports['requireAdmin']=requireAdmin;const requireShop=(_0x22afb7,_0x5221b5,_0x3cfb9c)=>{const _0x32aabc=a21_0x48eece;if(!_0x22afb7['user']||_0x22afb7[_0x32aabc(0x1d0)][_0x32aabc(0x1ae)]!==_0x32aabc(0x1c2))return _0x5221b5[_0x32aabc(0x1bf)](0x193)[_0x32aabc(0x1ce)]({'success':![],'message':_0x32aabc(0x1cf)});_0x3cfb9c();};exports[a21_0x48eece(0x1ca)]=requireShop;const requireActiveShop=async(_0x3b7395,_0x5ad952,_0x11a3d3)=>{const _0x3f8c48=a21_0x48eece;if(!_0x3b7395[_0x3f8c48(0x1d0)]||_0x3b7395[_0x3f8c48(0x1d0)][_0x3f8c48(0x1ae)]!==_0x3f8c48(0x1c2))return _0x5ad952[_0x3f8c48(0x1bf)](0x193)['json']({'success':![],'message':_0x3f8c48(0x1cf)});try{const _0x49f10a=require('../config/database')[_0x3f8c48(0x1b9)],_0x504eea=await _0x49f10a['shop'][_0x3f8c48(0x1c1)]({'where':{'id':_0x3b7395[_0x3f8c48(0x1d0)]['id']},'select':{'status':!![]}});if(!_0x504eea||_0x504eea['status']!=='ACTIVE')return _0x5ad952[_0x3f8c48(0x1bf)](0x193)[_0x3f8c48(0x1ce)]({'success':![],'message':'Account\x20is\x20suspended\x20or\x20inactive.\x20Contact\x20administrator\x20to\x20activate\x20your\x20account.','suspended':_0x504eea?.['status']==='SUSPENDED'});_0x11a3d3();}catch(_0xff761d){return console[_0x3f8c48(0x1ad)](_0x3f8c48(0x1c9),_0xff761d),_0x5ad952[_0x3f8c48(0x1bf)](0x1f4)[_0x3f8c48(0x1ce)]({'success':![],'message':_0x3f8c48(0x1cd)});}};function a21_0x3886(_0x4acd27,_0x2770f0){_0x4acd27=_0x4acd27-0x1a9;const _0xa39302=a21_0xa393();let _0x3886cf=_0xa39302[_0x4acd27];return _0x3886cf;}exports[a21_0x48eece(0x1c5)]=requireActiveShop;