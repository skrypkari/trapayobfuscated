'use strict';const a16_0x1482d=a16_0x45e1;(function(_0x641c1c,_0x3dfd35){const _0x166800=a16_0x45e1,_0x3a42ac=_0x641c1c();while(!![]){try{const _0x4840dc=parseInt(_0x166800(0x1fb))/0x1+-parseInt(_0x166800(0x20a))/0x2*(parseInt(_0x166800(0x21b))/0x3)+-parseInt(_0x166800(0x1f5))/0x4+-parseInt(_0x166800(0x207))/0x5*(parseInt(_0x166800(0x20d))/0x6)+-parseInt(_0x166800(0x1fc))/0x7*(parseInt(_0x166800(0x1f8))/0x8)+-parseInt(_0x166800(0x1f4))/0x9+parseInt(_0x166800(0x212))/0xa*(parseInt(_0x166800(0x21c))/0xb);if(_0x4840dc===_0x3dfd35)break;else _0x3a42ac['push'](_0x3a42ac['shift']());}catch(_0x32745e){_0x3a42ac['push'](_0x3a42ac['shift']());}}}(a16_0x3a8e,0xd3d8a));var __importDefault=this&&this[a16_0x1482d(0x20e)]||function(_0x50bf3f){const _0x43e27b=a16_0x1482d;return _0x50bf3f&&_0x50bf3f[_0x43e27b(0x1fa)]?_0x50bf3f:{'default':_0x50bf3f};};function a16_0x3a8e(){const _0x38be68=['ACTIVE','2044346wuAIUH','default','error','9390QDhWLT','__importDefault','authenticateToken','requireActiveShop','../config/config','36106450yIIgCB','secret','isTokenBlacklisted','../config/database','Invalid\x20or\x20expired\x20token','shop','headers','jsonwebtoken','requireShop','3DQLzPn','11ATQRpF','2290140rwPHND','3226492TSdLmG','Access\x20token\x20required','role','72agoSdi','authorization','__esModule','1056238zEunGu','547050eUJczD','user','Admin\x20access\x20required','findUnique','verify','SUSPENDED','Shop\x20access\x20required','../services/tokenBlacklistService','status','json','admin','3235oaaVgl','token'];a16_0x3a8e=function(){return _0x38be68;};return a16_0x3a8e();}Object['defineProperty'](exports,a16_0x1482d(0x1fa),{'value':!![]}),exports[a16_0x1482d(0x210)]=exports['requireShop']=exports['requireAdmin']=exports['authenticateToken']=void 0x0;const jsonwebtoken_1=__importDefault(require(a16_0x1482d(0x219))),config_1=require(a16_0x1482d(0x211)),tokenBlacklistService_1=require(a16_0x1482d(0x203)),authenticateToken=(_0x2d2571,_0x20e5d6,_0x405ca1)=>{const _0x557147=a16_0x1482d,_0x1ddf19=_0x2d2571[_0x557147(0x218)][_0x557147(0x1f9)],_0x26f8fd=_0x1ddf19&&_0x1ddf19['split']('\x20')[0x1];if(!_0x26f8fd)return _0x20e5d6['status'](0x191)[_0x557147(0x205)]({'success':![],'message':_0x557147(0x1f6)});if(tokenBlacklistService_1['tokenBlacklistService'][_0x557147(0x214)](_0x26f8fd))return _0x20e5d6[_0x557147(0x204)](0x191)[_0x557147(0x205)]({'success':![],'message':'Token\x20has\x20been\x20revoked'});jsonwebtoken_1[_0x557147(0x20b)][_0x557147(0x200)](_0x26f8fd,config_1['config']['jwt'][_0x557147(0x213)],(_0x207ecc,_0x245977)=>{const _0x2cfa1c=_0x557147;if(_0x207ecc)return _0x20e5d6[_0x2cfa1c(0x204)](0x193)['json']({'success':![],'message':_0x2cfa1c(0x216)});_0x2d2571[_0x2cfa1c(0x1fd)]=_0x245977,_0x2d2571[_0x2cfa1c(0x208)]=_0x26f8fd,_0x405ca1();});};exports[a16_0x1482d(0x20f)]=authenticateToken;const requireAdmin=(_0x5890ba,_0x54bc07,_0x116acf)=>{const _0x508436=a16_0x1482d;if(!_0x5890ba[_0x508436(0x1fd)]||_0x5890ba[_0x508436(0x1fd)]['role']!==_0x508436(0x206))return _0x54bc07[_0x508436(0x204)](0x193)['json']({'success':![],'message':_0x508436(0x1fe)});_0x116acf();};exports['requireAdmin']=requireAdmin;const requireShop=(_0x2769f7,_0x2780ca,_0xd0395)=>{const _0x1810a9=a16_0x1482d;if(!_0x2769f7['user']||_0x2769f7['user'][_0x1810a9(0x1f7)]!==_0x1810a9(0x217))return _0x2780ca[_0x1810a9(0x204)](0x193)[_0x1810a9(0x205)]({'success':![],'message':'Shop\x20access\x20required'});_0xd0395();};function a16_0x45e1(_0x433d61,_0x16bb19){const _0x3a8e00=a16_0x3a8e();return a16_0x45e1=function(_0x45e1e6,_0x165ba6){_0x45e1e6=_0x45e1e6-0x1f4;let _0x1d4ca4=_0x3a8e00[_0x45e1e6];return _0x1d4ca4;},a16_0x45e1(_0x433d61,_0x16bb19);}exports[a16_0x1482d(0x21a)]=requireShop;const requireActiveShop=async(_0x4ba26b,_0x146259,_0xfe62d0)=>{const _0x53123e=a16_0x1482d;if(!_0x4ba26b[_0x53123e(0x1fd)]||_0x4ba26b['user'][_0x53123e(0x1f7)]!==_0x53123e(0x217))return _0x146259[_0x53123e(0x204)](0x193)[_0x53123e(0x205)]({'success':![],'message':_0x53123e(0x202)});try{const _0x2cb812=require(_0x53123e(0x215))['default'],_0x3174a1=await _0x2cb812[_0x53123e(0x217)][_0x53123e(0x1ff)]({'where':{'id':_0x4ba26b['user']['id']},'select':{'status':!![]}});if(!_0x3174a1||_0x3174a1['status']!==_0x53123e(0x209))return _0x146259[_0x53123e(0x204)](0x193)[_0x53123e(0x205)]({'success':![],'message':'Account\x20is\x20suspended\x20or\x20inactive.\x20Contact\x20administrator\x20to\x20activate\x20your\x20account.','suspended':_0x3174a1?.[_0x53123e(0x204)]===_0x53123e(0x201)});_0xfe62d0();}catch(_0x16e760){return console[_0x53123e(0x20c)]('Error\x20checking\x20account\x20status:',_0x16e760),_0x146259[_0x53123e(0x204)](0x1f4)['json']({'success':![],'message':'Error\x20checking\x20account\x20status'});}};exports[a16_0x1482d(0x210)]=requireActiveShop;