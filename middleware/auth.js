'use strict';const a16_0x30dbad=a16_0x3564;function a16_0x3564(_0x24b6c6,_0x5c710f){const _0x57addf=a16_0x57ad();return a16_0x3564=function(_0x356418,_0x4477d3){_0x356418=_0x356418-0x84;let _0x6d016d=_0x57addf[_0x356418];return _0x6d016d;},a16_0x3564(_0x24b6c6,_0x5c710f);}(function(_0x3edc7b,_0x337bd6){const _0x16ec2c=a16_0x3564,_0x4da027=_0x3edc7b();while(!![]){try{const _0x381fae=parseInt(_0x16ec2c(0xa1))/0x1+parseInt(_0x16ec2c(0x9c))/0x2+-parseInt(_0x16ec2c(0x94))/0x3+-parseInt(_0x16ec2c(0x8a))/0x4*(parseInt(_0x16ec2c(0x9e))/0x5)+parseInt(_0x16ec2c(0xa3))/0x6+parseInt(_0x16ec2c(0x86))/0x7+parseInt(_0x16ec2c(0x99))/0x8;if(_0x381fae===_0x337bd6)break;else _0x4da027['push'](_0x4da027['shift']());}catch(_0x1f131f){_0x4da027['push'](_0x4da027['shift']());}}}(a16_0x57ad,0xb283e));var __importDefault=this&&this[a16_0x30dbad(0x95)]||function(_0x367b09){const _0x4156a3=a16_0x30dbad;return _0x367b09&&_0x367b09[_0x4156a3(0x97)]?_0x367b09:{'default':_0x367b09};};Object[a16_0x30dbad(0x93)](exports,a16_0x30dbad(0x97),{'value':!![]}),exports[a16_0x30dbad(0x8d)]=exports[a16_0x30dbad(0x8e)]=exports['authenticateToken']=void 0x0;const jsonwebtoken_1=__importDefault(require(a16_0x30dbad(0x8b))),config_1=require('../config/config'),tokenBlacklistService_1=require(a16_0x30dbad(0xa2)),authenticateToken=(_0x42baba,_0x5db27e,_0x21b697)=>{const _0x583baa=a16_0x30dbad,_0x1527ff=_0x42baba[_0x583baa(0x8f)][_0x583baa(0x89)],_0x1b11cb=_0x1527ff&&_0x1527ff[_0x583baa(0x9d)]('\x20')[0x1];if(!_0x1b11cb)return _0x5db27e['status'](0x191)[_0x583baa(0x9a)]({'success':![],'message':_0x583baa(0x9f)});if(tokenBlacklistService_1[_0x583baa(0x87)]['isTokenBlacklisted'](_0x1b11cb))return _0x5db27e[_0x583baa(0x85)](0x191)[_0x583baa(0x9a)]({'success':![],'message':_0x583baa(0x91)});jsonwebtoken_1[_0x583baa(0x98)]['verify'](_0x1b11cb,config_1['config'][_0x583baa(0x84)][_0x583baa(0x90)],(_0x57a43d,_0x137026)=>{const _0x30781e=_0x583baa;if(_0x57a43d)return _0x5db27e[_0x30781e(0x85)](0x193)[_0x30781e(0x9a)]({'success':![],'message':_0x30781e(0x8c)});_0x42baba['user']=_0x137026,_0x42baba[_0x30781e(0xa0)]=_0x1b11cb,_0x21b697();});};exports[a16_0x30dbad(0x9b)]=authenticateToken;const requireAdmin=(_0x4b2081,_0x55e1e6,_0x46366b)=>{const _0x213dec=a16_0x30dbad;if(!_0x4b2081['user']||_0x4b2081[_0x213dec(0x96)]['role']!==_0x213dec(0xa4))return _0x55e1e6[_0x213dec(0x85)](0x193)[_0x213dec(0x9a)]({'success':![],'message':_0x213dec(0x92)});_0x46366b();};function a16_0x57ad(){const _0x4ab044=['authorization','44BBuUoo','jsonwebtoken','Invalid\x20or\x20expired\x20token','requireShop','requireAdmin','headers','secret','Token\x20has\x20been\x20revoked','Admin\x20access\x20required','defineProperty','3683619qFoqkQ','__importDefault','user','__esModule','default','7675840rtbRGN','json','authenticateToken','1585226Xfchzb','split','387610PpTTna','Access\x20token\x20required','token','482907buyCun','../services/tokenBlacklistService','734454oOqOLk','admin','jwt','status','3180828OnzALk','tokenBlacklistService','Shop\x20access\x20required'];a16_0x57ad=function(){return _0x4ab044;};return a16_0x57ad();}exports[a16_0x30dbad(0x8e)]=requireAdmin;const requireShop=(_0xb9b16c,_0x42393a,_0x2a4287)=>{const _0x24064f=a16_0x30dbad;if(!_0xb9b16c[_0x24064f(0x96)]||_0xb9b16c[_0x24064f(0x96)]['role']!=='shop')return _0x42393a[_0x24064f(0x85)](0x193)['json']({'success':![],'message':_0x24064f(0x88)});_0x2a4287();};exports[a16_0x30dbad(0x8d)]=requireShop;