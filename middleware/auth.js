'use strict';const a18_0x3864df=a18_0x5313;function a18_0x10fc(){const _0x1964ae=['tokenBlacklistService','role','requireShop','authenticateToken','../services/tokenBlacklistService','token','Admin\x20access\x20required','__esModule','../config/database','1192782vzLTPw','16RXeiZh','1905277Ulrxct','default','headers','79962RJZMQu','1zflsST','70ZPvOZA','3894537aOtlEY','4muCbtq','shop','config','admin','findUnique','../config/config','Access\x20token\x20required','status','40pvhWoi','5506284yJahmn','requireActiveShop','3824127audnlX','Shop\x20access\x20required','Token\x20has\x20been\x20revoked','SUSPENDED','__importDefault','json','requireAdmin','authorization','verify','Invalid\x20or\x20expired\x20token','user','ACTIVE','Account\x20is\x20suspended\x20or\x20inactive.\x20Contact\x20administrator\x20to\x20activate\x20your\x20account.','27399012YuCKVQ'];a18_0x10fc=function(){return _0x1964ae;};return a18_0x10fc();}(function(_0x5f3ed7,_0x39389c){const _0x37864f=a18_0x5313,_0x3e21c6=_0x5f3ed7();while(!![]){try{const _0x39b743=-parseInt(_0x37864f(0x84))/0x1*(-parseInt(_0x37864f(0x7e))/0x2)+-parseInt(_0x37864f(0x86))/0x3*(-parseInt(_0x37864f(0x87))/0x4)+parseInt(_0x37864f(0x8f))/0x5*(-parseInt(_0x37864f(0x83))/0x6)+-parseInt(_0x37864f(0x90))/0x7*(parseInt(_0x37864f(0x7f))/0x8)+-parseInt(_0x37864f(0x92))/0x9+parseInt(_0x37864f(0x85))/0xa*(-parseInt(_0x37864f(0x80))/0xb)+parseInt(_0x37864f(0x74))/0xc;if(_0x39b743===_0x39389c)break;else _0x3e21c6['push'](_0x3e21c6['shift']());}catch(_0x35663a){_0x3e21c6['push'](_0x3e21c6['shift']());}}}(a18_0x10fc,0xd21d5));var __importDefault=this&&this[a18_0x3864df(0x6b)]||function(_0x3e6836){return _0x3e6836&&_0x3e6836['__esModule']?_0x3e6836:{'default':_0x3e6836};};function a18_0x5313(_0x2ee7c5,_0x2a7981){const _0x10fcdf=a18_0x10fc();return a18_0x5313=function(_0x531325,_0x521c87){_0x531325=_0x531325-0x69;let _0x5299f2=_0x10fcdf[_0x531325];return _0x5299f2;},a18_0x5313(_0x2ee7c5,_0x2a7981);}Object['defineProperty'](exports,a18_0x3864df(0x7c),{'value':!![]}),exports[a18_0x3864df(0x91)]=exports['requireShop']=exports[a18_0x3864df(0x6d)]=exports[a18_0x3864df(0x78)]=void 0x0;const jsonwebtoken_1=__importDefault(require('jsonwebtoken')),config_1=require(a18_0x3864df(0x8c)),tokenBlacklistService_1=require(a18_0x3864df(0x79)),authenticateToken=(_0x1f78ce,_0x5d24a3,_0x20fdf2)=>{const _0x2e12f6=a18_0x3864df,_0x35c05e=_0x1f78ce[_0x2e12f6(0x82)][_0x2e12f6(0x6e)],_0x114d6d=_0x35c05e&&_0x35c05e['split']('\x20')[0x1];if(!_0x114d6d)return _0x5d24a3[_0x2e12f6(0x8e)](0x191)[_0x2e12f6(0x6c)]({'success':![],'message':_0x2e12f6(0x8d)});if(tokenBlacklistService_1[_0x2e12f6(0x75)]['isTokenBlacklisted'](_0x114d6d))return _0x5d24a3[_0x2e12f6(0x8e)](0x191)['json']({'success':![],'message':_0x2e12f6(0x69)});jsonwebtoken_1['default'][_0x2e12f6(0x6f)](_0x114d6d,config_1[_0x2e12f6(0x89)]['jwt']['secret'],(_0x50e86d,_0x443893)=>{const _0x1c28cd=_0x2e12f6;if(_0x50e86d)return _0x5d24a3['status'](0x193)[_0x1c28cd(0x6c)]({'success':![],'message':_0x1c28cd(0x70)});_0x1f78ce[_0x1c28cd(0x71)]=_0x443893,_0x1f78ce[_0x1c28cd(0x7a)]=_0x114d6d,_0x20fdf2();});};exports[a18_0x3864df(0x78)]=authenticateToken;const requireAdmin=(_0x5e54c2,_0x2db17d,_0x5c4141)=>{const _0x3d4d9a=a18_0x3864df;if(!_0x5e54c2[_0x3d4d9a(0x71)]||_0x5e54c2[_0x3d4d9a(0x71)][_0x3d4d9a(0x76)]!==_0x3d4d9a(0x8a))return _0x2db17d[_0x3d4d9a(0x8e)](0x193)[_0x3d4d9a(0x6c)]({'success':![],'message':_0x3d4d9a(0x7b)});_0x5c4141();};exports[a18_0x3864df(0x6d)]=requireAdmin;const requireShop=(_0xfa5dc,_0x428a1b,_0x4c9209)=>{const _0x141064=a18_0x3864df;if(!_0xfa5dc[_0x141064(0x71)]||_0xfa5dc[_0x141064(0x71)][_0x141064(0x76)]!=='shop')return _0x428a1b[_0x141064(0x8e)](0x193)[_0x141064(0x6c)]({'success':![],'message':_0x141064(0x93)});_0x4c9209();};exports[a18_0x3864df(0x77)]=requireShop;const requireActiveShop=async(_0x780bb9,_0x53e77f,_0x2b1e25)=>{const _0x410f73=a18_0x3864df;if(!_0x780bb9[_0x410f73(0x71)]||_0x780bb9['user'][_0x410f73(0x76)]!==_0x410f73(0x88))return _0x53e77f[_0x410f73(0x8e)](0x193)[_0x410f73(0x6c)]({'success':![],'message':'Shop\x20access\x20required'});try{const _0x8cb40b=require(_0x410f73(0x7d))[_0x410f73(0x81)],_0x434d08=await _0x8cb40b[_0x410f73(0x88)][_0x410f73(0x8b)]({'where':{'id':_0x780bb9['user']['id']},'select':{'status':!![]}});if(!_0x434d08||_0x434d08['status']!==_0x410f73(0x72))return _0x53e77f[_0x410f73(0x8e)](0x193)[_0x410f73(0x6c)]({'success':![],'message':_0x410f73(0x73),'suspended':_0x434d08?.[_0x410f73(0x8e)]===_0x410f73(0x6a)});_0x2b1e25();}catch(_0x2d4f08){return console['error']('Error\x20checking\x20account\x20status:',_0x2d4f08),_0x53e77f[_0x410f73(0x8e)](0x1f4)[_0x410f73(0x6c)]({'success':![],'message':'Error\x20checking\x20account\x20status'});}};exports['requireActiveShop']=requireActiveShop;