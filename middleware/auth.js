'use strict';const a16_0x3ffa9f=a16_0x44a3;function a16_0x15c9(){const _0x4026d3=['jsonwebtoken','isTokenBlacklisted','split','requireAdmin','Access\x20token\x20required','findUnique','defineProperty','1320654egEStu','verify','2816sraPVF','authorization','112PKobwW','config','error','requireShop','status','__importDefault','tokenBlacklistService','requireActiveShop','admin','Invalid\x20or\x20expired\x20token','130QhuQBc','ACTIVE','token','headers','../config/config','Error\x20checking\x20account\x20status','135267vlvFde','1395522ZXEqJS','315821vWUqmF','default','shop','json','Shop\x20access\x20required','336118FgmIYX','../config/database','Account\x20is\x20suspended\x20or\x20inactive.\x20Contact\x20administrator\x20to\x20activate\x20your\x20account.','2caBLjv','role','Error\x20checking\x20account\x20status:','750abNoPO','../services/tokenBlacklistService','213192WBKtFi','Admin\x20access\x20required','user','Token\x20has\x20been\x20revoked'];a16_0x15c9=function(){return _0x4026d3;};return a16_0x15c9();}(function(_0x24ef6d,_0x16d51b){const _0x11a894=a16_0x44a3,_0x1a0a8b=_0x24ef6d();while(!![]){try{const _0x261621=parseInt(_0x11a894(0x138))/0x1*(parseInt(_0x11a894(0x13b))/0x2)+-parseInt(_0x11a894(0x131))/0x3+parseInt(_0x11a894(0x14d))/0x4*(parseInt(_0x11a894(0x13e))/0x5)+-parseInt(_0x11a894(0x14b))/0x6+parseInt(_0x11a894(0x140))/0x7*(-parseInt(_0x11a894(0x121))/0x8)+parseInt(_0x11a894(0x132))/0x9+-parseInt(_0x11a894(0x12b))/0xa*(-parseInt(_0x11a894(0x133))/0xb);if(_0x261621===_0x16d51b)break;else _0x1a0a8b['push'](_0x1a0a8b['shift']());}catch(_0x154e5f){_0x1a0a8b['push'](_0x1a0a8b['shift']());}}}(a16_0x15c9,0x43fa5));var __importDefault=this&&this[a16_0x3ffa9f(0x126)]||function(_0x2e7779){return _0x2e7779&&_0x2e7779['__esModule']?_0x2e7779:{'default':_0x2e7779};};Object[a16_0x3ffa9f(0x14a)](exports,'__esModule',{'value':!![]}),exports[a16_0x3ffa9f(0x128)]=exports[a16_0x3ffa9f(0x124)]=exports[a16_0x3ffa9f(0x147)]=exports['authenticateToken']=void 0x0;function a16_0x44a3(_0xae4977,_0x4a58d3){const _0x15c976=a16_0x15c9();return a16_0x44a3=function(_0x44a375,_0xb33633){_0x44a375=_0x44a375-0x120;let _0x3f7a61=_0x15c976[_0x44a375];return _0x3f7a61;},a16_0x44a3(_0xae4977,_0x4a58d3);}const jsonwebtoken_1=__importDefault(require(a16_0x3ffa9f(0x144))),config_1=require(a16_0x3ffa9f(0x12f)),tokenBlacklistService_1=require(a16_0x3ffa9f(0x13f)),authenticateToken=(_0x135c25,_0x39cbe7,_0x1445f2)=>{const _0x5f4cbe=a16_0x3ffa9f,_0x5cf1ab=_0x135c25[_0x5f4cbe(0x12e)][_0x5f4cbe(0x120)],_0x5220da=_0x5cf1ab&&_0x5cf1ab[_0x5f4cbe(0x146)]('\x20')[0x1];if(!_0x5220da)return _0x39cbe7['status'](0x191)[_0x5f4cbe(0x136)]({'success':![],'message':_0x5f4cbe(0x148)});if(tokenBlacklistService_1[_0x5f4cbe(0x127)][_0x5f4cbe(0x145)](_0x5220da))return _0x39cbe7[_0x5f4cbe(0x125)](0x191)[_0x5f4cbe(0x136)]({'success':![],'message':_0x5f4cbe(0x143)});jsonwebtoken_1[_0x5f4cbe(0x134)][_0x5f4cbe(0x14c)](_0x5220da,config_1[_0x5f4cbe(0x122)]['jwt']['secret'],(_0x1ea89e,_0xd97c5c)=>{const _0x33e605=_0x5f4cbe;if(_0x1ea89e)return _0x39cbe7[_0x33e605(0x125)](0x193)['json']({'success':![],'message':_0x33e605(0x12a)});_0x135c25[_0x33e605(0x142)]=_0xd97c5c,_0x135c25[_0x33e605(0x12d)]=_0x5220da,_0x1445f2();});};exports['authenticateToken']=authenticateToken;const requireAdmin=(_0x578ff2,_0x594322,_0x2088d4)=>{const _0x2242d9=a16_0x3ffa9f;if(!_0x578ff2[_0x2242d9(0x142)]||_0x578ff2[_0x2242d9(0x142)][_0x2242d9(0x13c)]!==_0x2242d9(0x129))return _0x594322[_0x2242d9(0x125)](0x193)['json']({'success':![],'message':_0x2242d9(0x141)});_0x2088d4();};exports[a16_0x3ffa9f(0x147)]=requireAdmin;const requireShop=(_0x20a5fb,_0x18fd2d,_0x2ace5f)=>{const _0x52cece=a16_0x3ffa9f;if(!_0x20a5fb[_0x52cece(0x142)]||_0x20a5fb['user'][_0x52cece(0x13c)]!==_0x52cece(0x135))return _0x18fd2d[_0x52cece(0x125)](0x193)[_0x52cece(0x136)]({'success':![],'message':'Shop\x20access\x20required'});_0x2ace5f();};exports[a16_0x3ffa9f(0x124)]=requireShop;const requireActiveShop=async(_0x475ad0,_0x32db73,_0x655463)=>{const _0x52d2ab=a16_0x3ffa9f;if(!_0x475ad0[_0x52d2ab(0x142)]||_0x475ad0[_0x52d2ab(0x142)][_0x52d2ab(0x13c)]!==_0x52d2ab(0x135))return _0x32db73[_0x52d2ab(0x125)](0x193)[_0x52d2ab(0x136)]({'success':![],'message':_0x52d2ab(0x137)});try{const _0x240b43=require(_0x52d2ab(0x139))[_0x52d2ab(0x134)],_0x1de211=await _0x240b43[_0x52d2ab(0x135)][_0x52d2ab(0x149)]({'where':{'id':_0x475ad0[_0x52d2ab(0x142)]['id']},'select':{'status':!![]}});if(!_0x1de211||_0x1de211[_0x52d2ab(0x125)]!==_0x52d2ab(0x12c))return _0x32db73[_0x52d2ab(0x125)](0x193)[_0x52d2ab(0x136)]({'success':![],'message':_0x52d2ab(0x13a),'suspended':_0x1de211?.[_0x52d2ab(0x125)]==='SUSPENDED'});_0x655463();}catch(_0x43d3d2){return console[_0x52d2ab(0x123)](_0x52d2ab(0x13d),_0x43d3d2),_0x32db73[_0x52d2ab(0x125)](0x1f4)['json']({'success':![],'message':_0x52d2ab(0x130)});}};exports[a16_0x3ffa9f(0x128)]=requireActiveShop;