'use strict';const a16_0x3469ed=a16_0x335c;(function(_0xdfd005,_0x259f40){const _0x211131=a16_0x335c,_0x59623a=_0xdfd005();while(!![]){try{const _0x268fa1=-parseInt(_0x211131(0xb0))/0x1+-parseInt(_0x211131(0xc2))/0x2*(-parseInt(_0x211131(0xb2))/0x3)+parseInt(_0x211131(0xa1))/0x4*(-parseInt(_0x211131(0x9d))/0x5)+-parseInt(_0x211131(0xaa))/0x6*(-parseInt(_0x211131(0xc1))/0x7)+parseInt(_0x211131(0xa4))/0x8+-parseInt(_0x211131(0xb1))/0x9+parseInt(_0x211131(0xa3))/0xa;if(_0x268fa1===_0x259f40)break;else _0x59623a['push'](_0x59623a['shift']());}catch(_0x1c049b){_0x59623a['push'](_0x59623a['shift']());}}}(a16_0x3b00,0x3e745));var __importDefault=this&&this[a16_0x3469ed(0xad)]||function(_0x27bd77){const _0x8408bd=a16_0x3469ed;return _0x27bd77&&_0x27bd77[_0x8408bd(0xac)]?_0x27bd77:{'default':_0x27bd77};};Object[a16_0x3469ed(0xb7)](exports,a16_0x3469ed(0xac),{'value':!![]}),exports[a16_0x3469ed(0xae)]=exports[a16_0x3469ed(0xb8)]=exports[a16_0x3469ed(0xbd)]=exports[a16_0x3469ed(0xa8)]=void 0x0;const jsonwebtoken_1=__importDefault(require(a16_0x3469ed(0x99))),config_1=require(a16_0x3469ed(0xb5)),tokenBlacklistService_1=require(a16_0x3469ed(0xba)),authenticateToken=(_0x259a0d,_0xea4384,_0xd911d1)=>{const _0x259e96=a16_0x3469ed,_0x28323e=_0x259a0d[_0x259e96(0xc0)][_0x259e96(0xa2)],_0x5eba26=_0x28323e&&_0x28323e[_0x259e96(0xaf)]('\x20')[0x1];if(!_0x5eba26)return _0xea4384['status'](0x191)[_0x259e96(0xa6)]({'success':![],'message':_0x259e96(0xbc)});if(tokenBlacklistService_1['tokenBlacklistService'][_0x259e96(0xab)](_0x5eba26))return _0xea4384['status'](0x191)[_0x259e96(0xa6)]({'success':![],'message':_0x259e96(0x9a)});jsonwebtoken_1[_0x259e96(0xb6)]['verify'](_0x5eba26,config_1[_0x259e96(0xbf)][_0x259e96(0x9e)]['secret'],(_0x8e944f,_0x4c386d)=>{const _0x3f2751=_0x259e96;if(_0x8e944f)return _0xea4384['status'](0x193)['json']({'success':![],'message':'Invalid\x20or\x20expired\x20token'});_0x259a0d[_0x3f2751(0xa7)]=_0x4c386d,_0x259a0d[_0x3f2751(0xa5)]=_0x5eba26,_0xd911d1();});};exports[a16_0x3469ed(0xa8)]=authenticateToken;const requireAdmin=(_0x5a9cc7,_0x1d34a5,_0x4a012a)=>{const _0x1c2db6=a16_0x3469ed;if(!_0x5a9cc7[_0x1c2db6(0xa7)]||_0x5a9cc7['user'][_0x1c2db6(0xa9)]!==_0x1c2db6(0x9b))return _0x1d34a5[_0x1c2db6(0x9f)](0x193)[_0x1c2db6(0xa6)]({'success':![],'message':_0x1c2db6(0xb3)});_0x4a012a();};function a16_0x335c(_0x4804df,_0x4332e3){const _0x3b0012=a16_0x3b00();return a16_0x335c=function(_0x335c99,_0x2de264){_0x335c99=_0x335c99-0x99;let _0x4a99fa=_0x3b0012[_0x335c99];return _0x4a99fa;},a16_0x335c(_0x4804df,_0x4332e3);}exports[a16_0x3469ed(0xbd)]=requireAdmin;const requireShop=(_0x254b18,_0x1b65ae,_0x5609b1)=>{const _0x1574cb=a16_0x3469ed;if(!_0x254b18[_0x1574cb(0xa7)]||_0x254b18['user'][_0x1574cb(0xa9)]!==_0x1574cb(0xb9))return _0x1b65ae[_0x1574cb(0x9f)](0x193)[_0x1574cb(0xa6)]({'success':![],'message':_0x1574cb(0xbb)});_0x5609b1();};function a16_0x3b00(){const _0x44fc06=['default','defineProperty','requireShop','shop','../services/tokenBlacklistService','Shop\x20access\x20required','Access\x20token\x20required','requireAdmin','findUnique','config','headers','1281SABLHH','284714qqFtRm','Account\x20is\x20suspended\x20or\x20inactive.\x20Contact\x20administrator\x20to\x20activate\x20your\x20account.','jsonwebtoken','Token\x20has\x20been\x20revoked','admin','../config/database','461665OGbWto','jwt','status','SUSPENDED','16tFlIQb','authorization','1346960XkAePk','1038400nqkwek','token','json','user','authenticateToken','role','10644JNykXE','isTokenBlacklisted','__esModule','__importDefault','requireActiveShop','split','130162ODjPdR','1066905XZXSGt','6uWdsDv','Admin\x20access\x20required','ACTIVE','../config/config'];a16_0x3b00=function(){return _0x44fc06;};return a16_0x3b00();}exports[a16_0x3469ed(0xb8)]=requireShop;const requireActiveShop=async(_0x101be8,_0x20e416,_0x17d752)=>{const _0x36e752=a16_0x3469ed;if(!_0x101be8[_0x36e752(0xa7)]||_0x101be8[_0x36e752(0xa7)]['role']!=='shop')return _0x20e416[_0x36e752(0x9f)](0x193)[_0x36e752(0xa6)]({'success':![],'message':_0x36e752(0xbb)});try{const _0x4d8adf=require(_0x36e752(0x9c))['default'],_0x3b0776=await _0x4d8adf['shop'][_0x36e752(0xbe)]({'where':{'id':_0x101be8[_0x36e752(0xa7)]['id']},'select':{'status':!![]}});if(!_0x3b0776||_0x3b0776[_0x36e752(0x9f)]!==_0x36e752(0xb4))return _0x20e416[_0x36e752(0x9f)](0x193)[_0x36e752(0xa6)]({'success':![],'message':_0x36e752(0xc3),'suspended':_0x3b0776?.[_0x36e752(0x9f)]===_0x36e752(0xa0)});_0x17d752();}catch(_0x2f81da){return console['error']('Error\x20checking\x20account\x20status:',_0x2f81da),_0x20e416[_0x36e752(0x9f)](0x1f4)['json']({'success':![],'message':'Error\x20checking\x20account\x20status'});}};exports[a16_0x3469ed(0xae)]=requireActiveShop;