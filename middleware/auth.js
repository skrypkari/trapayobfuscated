'use strict';const a15_0x33512d=a15_0x43e2;(function(_0x23a370,_0x44e66d){const _0x1ecd5d=a15_0x43e2,_0x2da44a=_0x23a370();while(!![]){try{const _0x529fd9=parseInt(_0x1ecd5d(0x1d3))/0x1*(-parseInt(_0x1ecd5d(0x1bf))/0x2)+parseInt(_0x1ecd5d(0x1d9))/0x3*(parseInt(_0x1ecd5d(0x1c7))/0x4)+parseInt(_0x1ecd5d(0x1c1))/0x5+-parseInt(_0x1ecd5d(0x1d1))/0x6*(parseInt(_0x1ecd5d(0x1cc))/0x7)+parseInt(_0x1ecd5d(0x1dd))/0x8+-parseInt(_0x1ecd5d(0x1be))/0x9*(parseInt(_0x1ecd5d(0x1c4))/0xa)+-parseInt(_0x1ecd5d(0x1d6))/0xb*(-parseInt(_0x1ecd5d(0x1d5))/0xc);if(_0x529fd9===_0x44e66d)break;else _0x2da44a['push'](_0x2da44a['shift']());}catch(_0x5a01a2){_0x2da44a['push'](_0x2da44a['shift']());}}}(a15_0x319c,0x690b7));var __importDefault=this&&this[a15_0x33512d(0x1d0)]||function(_0x5aa522){const _0x379e46=a15_0x33512d;return _0x5aa522&&_0x5aa522[_0x379e46(0x1c3)]?_0x5aa522:{'default':_0x5aa522};};function a15_0x43e2(_0x4809b0,_0x3339c1){const _0x319c5b=a15_0x319c();return a15_0x43e2=function(_0x43e285,_0x1fbe67){_0x43e285=_0x43e285-0x1bd;let _0x4dfe2e=_0x319c5b[_0x43e285];return _0x4dfe2e;},a15_0x43e2(_0x4809b0,_0x3339c1);}Object[a15_0x33512d(0x1ca)](exports,a15_0x33512d(0x1c3),{'value':!![]}),exports['requireShop']=exports[a15_0x33512d(0x1d7)]=exports[a15_0x33512d(0x1db)]=void 0x0;function a15_0x319c(){const _0x5176ba=['split','3403476LcoABG','266PlCtuS','headers','425090fYxhPx','verify','__esModule','10UCAKpJ','config','token','5788hMqJgm','admin','jwt','defineProperty','Shop\x20access\x20required','8309fkVhZY','isTokenBlacklisted','json','role','__importDefault','2466snWRdM','tokenBlacklistService','2477rSZObf','jsonwebtoken','67908jOneuf','616FoVMBt','requireAdmin','../services/tokenBlacklistService','1158uSRshu','status','authenticateToken','Admin\x20access\x20required','5322088zorHqM','user','authorization','requireShop','secret'];a15_0x319c=function(){return _0x5176ba;};return a15_0x319c();}const jsonwebtoken_1=__importDefault(require(a15_0x33512d(0x1d4))),config_1=require('../config/config'),tokenBlacklistService_1=require(a15_0x33512d(0x1d8)),authenticateToken=(_0x3f19b7,_0x1fdf95,_0x550b93)=>{const _0x594f81=a15_0x33512d,_0x12ae01=_0x3f19b7[_0x594f81(0x1c0)][_0x594f81(0x1df)],_0x3ecb4a=_0x12ae01&&_0x12ae01[_0x594f81(0x1bd)]('\x20')[0x1];if(!_0x3ecb4a)return _0x1fdf95[_0x594f81(0x1da)](0x191)['json']({'success':![],'message':'Access\x20token\x20required'});if(tokenBlacklistService_1[_0x594f81(0x1d2)][_0x594f81(0x1cd)](_0x3ecb4a))return _0x1fdf95[_0x594f81(0x1da)](0x191)[_0x594f81(0x1ce)]({'success':![],'message':'Token\x20has\x20been\x20revoked'});jsonwebtoken_1['default'][_0x594f81(0x1c2)](_0x3ecb4a,config_1[_0x594f81(0x1c5)][_0x594f81(0x1c9)][_0x594f81(0x1e1)],(_0x4f91bb,_0x1eb8c6)=>{const _0x19979a=_0x594f81;if(_0x4f91bb)return _0x1fdf95[_0x19979a(0x1da)](0x193)[_0x19979a(0x1ce)]({'success':![],'message':'Invalid\x20or\x20expired\x20token'});_0x3f19b7[_0x19979a(0x1de)]=_0x1eb8c6,_0x3f19b7[_0x19979a(0x1c6)]=_0x3ecb4a,_0x550b93();});};exports['authenticateToken']=authenticateToken;const requireAdmin=(_0x434ef1,_0x37ebef,_0x44ad4c)=>{const _0x43c5a6=a15_0x33512d;if(!_0x434ef1[_0x43c5a6(0x1de)]||_0x434ef1[_0x43c5a6(0x1de)]['role']!==_0x43c5a6(0x1c8))return _0x37ebef['status'](0x193)[_0x43c5a6(0x1ce)]({'success':![],'message':_0x43c5a6(0x1dc)});_0x44ad4c();};exports[a15_0x33512d(0x1d7)]=requireAdmin;const requireShop=(_0x3fc47b,_0x261973,_0x316d9f)=>{const _0x5c0418=a15_0x33512d;if(!_0x3fc47b[_0x5c0418(0x1de)]||_0x3fc47b[_0x5c0418(0x1de)][_0x5c0418(0x1cf)]!=='shop')return _0x261973[_0x5c0418(0x1da)](0x193)['json']({'success':![],'message':_0x5c0418(0x1cb)});_0x316d9f();};exports[a15_0x33512d(0x1e0)]=requireShop;