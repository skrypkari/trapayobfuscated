'use strict';const a16_0x576236=a16_0x3996;(function(_0x27d07c,_0x5dec4b){const _0x521b29=a16_0x3996,_0x4264a5=_0x27d07c();while(!![]){try{const _0x43f681=parseInt(_0x521b29(0x1c9))/0x1*(-parseInt(_0x521b29(0x1bc))/0x2)+parseInt(_0x521b29(0x1d6))/0x3+parseInt(_0x521b29(0x1d9))/0x4*(parseInt(_0x521b29(0x1dc))/0x5)+-parseInt(_0x521b29(0x1b9))/0x6*(parseInt(_0x521b29(0x1c4))/0x7)+-parseInt(_0x521b29(0x1c1))/0x8+parseInt(_0x521b29(0x1cb))/0x9+-parseInt(_0x521b29(0x1c6))/0xa;if(_0x43f681===_0x5dec4b)break;else _0x4264a5['push'](_0x4264a5['shift']());}catch(_0x36a17f){_0x4264a5['push'](_0x4264a5['shift']());}}}(a16_0x3d3a,0xb318b));var __importDefault=this&&this[a16_0x576236(0x1d1)]||function(_0x423846){const _0x4904f3=a16_0x576236;return _0x423846&&_0x423846[_0x4904f3(0x1bf)]?_0x423846:{'default':_0x423846};};Object[a16_0x576236(0x1d8)](exports,a16_0x576236(0x1bf),{'value':!![]}),exports[a16_0x576236(0x1c2)]=exports[a16_0x576236(0x1d4)]=exports['requireAdmin']=exports[a16_0x576236(0x1d3)]=void 0x0;const jsonwebtoken_1=__importDefault(require('jsonwebtoken')),config_1=require('../config/config'),tokenBlacklistService_1=require(a16_0x576236(0x1da)),authenticateToken=(_0x559cf5,_0x5c512e,_0x18156b)=>{const _0x4c803f=a16_0x576236,_0x409705=_0x559cf5['headers'][_0x4c803f(0x1ca)],_0x40d2b8=_0x409705&&_0x409705[_0x4c803f(0x1ba)]('\x20')[0x1];if(!_0x40d2b8)return _0x5c512e['status'](0x191)[_0x4c803f(0x1be)]({'success':![],'message':_0x4c803f(0x1de)});if(tokenBlacklistService_1['tokenBlacklistService'][_0x4c803f(0x1dd)](_0x40d2b8))return _0x5c512e[_0x4c803f(0x1b8)](0x191)[_0x4c803f(0x1be)]({'success':![],'message':_0x4c803f(0x1d5)});jsonwebtoken_1[_0x4c803f(0x1cf)]['verify'](_0x40d2b8,config_1['config'][_0x4c803f(0x1c0)]['secret'],(_0x3b629b,_0x1f0229)=>{const _0x19b9e7=_0x4c803f;if(_0x3b629b)return _0x5c512e[_0x19b9e7(0x1b8)](0x193)[_0x19b9e7(0x1be)]({'success':![],'message':'Invalid\x20or\x20expired\x20token'});_0x559cf5[_0x19b9e7(0x1c7)]=_0x1f0229,_0x559cf5[_0x19b9e7(0x1bd)]=_0x40d2b8,_0x18156b();});};exports['authenticateToken']=authenticateToken;function a16_0x3996(_0x3f9489,_0x3a6706){const _0x3d3a3b=a16_0x3d3a();return a16_0x3996=function(_0x399683,_0x4bac57){_0x399683=_0x399683-0x1b8;let _0x457734=_0x3d3a3b[_0x399683];return _0x457734;},a16_0x3996(_0x3f9489,_0x3a6706);}const requireAdmin=(_0x512435,_0x8138cf,_0x4bdfdd)=>{const _0x4461ac=a16_0x576236;if(!_0x512435[_0x4461ac(0x1c7)]||_0x512435['user']['role']!==_0x4461ac(0x1d2))return _0x8138cf[_0x4461ac(0x1b8)](0x193)['json']({'success':![],'message':_0x4461ac(0x1d0)});_0x4bdfdd();};function a16_0x3d3a(){const _0x274b7a=['4878qRfMVB','token','json','__esModule','jwt','3623096XKuJwq','requireActiveShop','SUSPENDED','6811mXehPk','Error\x20checking\x20account\x20status','6602260WevwiC','user','Account\x20is\x20suspended\x20or\x20inactive.\x20Contact\x20administrator\x20to\x20activate\x20your\x20account.','55VUMdvy','authorization','1151172DaoEby','shop','role','Error\x20checking\x20account\x20status:','default','Admin\x20access\x20required','__importDefault','admin','authenticateToken','requireShop','Token\x20has\x20been\x20revoked','2454603LuzutW','Shop\x20access\x20required','defineProperty','4OwZVfY','../services/tokenBlacklistService','../config/database','6521245Kibaoj','isTokenBlacklisted','Access\x20token\x20required','status','1662oDolgr','split','requireAdmin'];a16_0x3d3a=function(){return _0x274b7a;};return a16_0x3d3a();}exports[a16_0x576236(0x1bb)]=requireAdmin;const requireShop=(_0x12cdca,_0x1b8bdc,_0x47cb57)=>{const _0x10d74f=a16_0x576236;if(!_0x12cdca[_0x10d74f(0x1c7)]||_0x12cdca[_0x10d74f(0x1c7)][_0x10d74f(0x1cd)]!=='shop')return _0x1b8bdc['status'](0x193)[_0x10d74f(0x1be)]({'success':![],'message':_0x10d74f(0x1d7)});_0x47cb57();};exports[a16_0x576236(0x1d4)]=requireShop;const requireActiveShop=async(_0x6ec7b1,_0x58a5d3,_0x5e5419)=>{const _0x39b21d=a16_0x576236;if(!_0x6ec7b1[_0x39b21d(0x1c7)]||_0x6ec7b1['user']['role']!==_0x39b21d(0x1cc))return _0x58a5d3[_0x39b21d(0x1b8)](0x193)[_0x39b21d(0x1be)]({'success':![],'message':_0x39b21d(0x1d7)});try{const _0x2509d9=require(_0x39b21d(0x1db))[_0x39b21d(0x1cf)],_0x48d870=await _0x2509d9[_0x39b21d(0x1cc)]['findUnique']({'where':{'id':_0x6ec7b1[_0x39b21d(0x1c7)]['id']},'select':{'status':!![]}});if(!_0x48d870||_0x48d870[_0x39b21d(0x1b8)]!=='ACTIVE')return _0x58a5d3[_0x39b21d(0x1b8)](0x193)[_0x39b21d(0x1be)]({'success':![],'message':_0x39b21d(0x1c8),'suspended':_0x48d870?.[_0x39b21d(0x1b8)]===_0x39b21d(0x1c3)});_0x5e5419();}catch(_0x361b90){return console['error'](_0x39b21d(0x1ce),_0x361b90),_0x58a5d3[_0x39b21d(0x1b8)](0x1f4)[_0x39b21d(0x1be)]({'success':![],'message':_0x39b21d(0x1c5)});}};exports[a16_0x576236(0x1c2)]=requireActiveShop;