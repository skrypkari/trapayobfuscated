'use strict';const a16_0x374b97=a16_0x2adc;(function(_0x5979e0,_0x27a575){const _0x2173f1=a16_0x2adc,_0x34822a=_0x5979e0();while(!![]){try{const _0x8c586a=parseInt(_0x2173f1(0x164))/0x1+-parseInt(_0x2173f1(0x148))/0x2+parseInt(_0x2173f1(0x163))/0x3+-parseInt(_0x2173f1(0x162))/0x4*(-parseInt(_0x2173f1(0x15e))/0x5)+parseInt(_0x2173f1(0x147))/0x6+-parseInt(_0x2173f1(0x15c))/0x7+-parseInt(_0x2173f1(0x155))/0x8*(-parseInt(_0x2173f1(0x165))/0x9);if(_0x8c586a===_0x27a575)break;else _0x34822a['push'](_0x34822a['shift']());}catch(_0x3eb0c8){_0x34822a['push'](_0x34822a['shift']());}}}(a16_0x4fc7,0xad7e2));var __importDefault=this&&this[a16_0x374b97(0x14c)]||function(_0x4e7ee4){return _0x4e7ee4&&_0x4e7ee4['__esModule']?_0x4e7ee4:{'default':_0x4e7ee4};};function a16_0x4fc7(){const _0x71c3d0=['authorization','Token\x20has\x20been\x20revoked','../services/tokenBlacklistService','status','shop','jwt','8842897kzBVyG','../config/config','815PhmexQ','user','defineProperty','Access\x20token\x20required','1076VIWfDY','240489RSllPa','1021215MFLzXu','365067lrVQlD','Admin\x20access\x20required','default','secret','8101818XlKwuR','1773396LetbPP','__esModule','admin','jsonwebtoken','__importDefault','authenticateToken','requireShop','verify','isTokenBlacklisted','json','tokenBlacklistService','Invalid\x20or\x20expired\x20token','config','72NIPAlg'];a16_0x4fc7=function(){return _0x71c3d0;};return a16_0x4fc7();}Object[a16_0x374b97(0x160)](exports,a16_0x374b97(0x149),{'value':!![]}),exports['requireShop']=exports['requireAdmin']=exports['authenticateToken']=void 0x0;const jsonwebtoken_1=__importDefault(require(a16_0x374b97(0x14b))),config_1=require(a16_0x374b97(0x15d)),tokenBlacklistService_1=require(a16_0x374b97(0x158)),authenticateToken=(_0xdbcd01,_0x74e911,_0x3cf232)=>{const _0x1f46c0=a16_0x374b97,_0x154411=_0xdbcd01['headers'][_0x1f46c0(0x156)],_0x2a309b=_0x154411&&_0x154411['split']('\x20')[0x1];if(!_0x2a309b)return _0x74e911[_0x1f46c0(0x159)](0x191)['json']({'success':![],'message':_0x1f46c0(0x161)});if(tokenBlacklistService_1[_0x1f46c0(0x152)][_0x1f46c0(0x150)](_0x2a309b))return _0x74e911[_0x1f46c0(0x159)](0x191)[_0x1f46c0(0x151)]({'success':![],'message':_0x1f46c0(0x157)});jsonwebtoken_1[_0x1f46c0(0x145)][_0x1f46c0(0x14f)](_0x2a309b,config_1[_0x1f46c0(0x154)][_0x1f46c0(0x15b)][_0x1f46c0(0x146)],(_0x565d71,_0x3cb1a6)=>{const _0x3e8215=_0x1f46c0;if(_0x565d71)return _0x74e911[_0x3e8215(0x159)](0x193)[_0x3e8215(0x151)]({'success':![],'message':_0x3e8215(0x153)});_0xdbcd01[_0x3e8215(0x15f)]=_0x3cb1a6,_0xdbcd01['token']=_0x2a309b,_0x3cf232();});};exports[a16_0x374b97(0x14d)]=authenticateToken;function a16_0x2adc(_0x10fbb3,_0x520a65){const _0x4fc78e=a16_0x4fc7();return a16_0x2adc=function(_0x2adc4b,_0x3dfa50){_0x2adc4b=_0x2adc4b-0x145;let _0x255242=_0x4fc78e[_0x2adc4b];return _0x255242;},a16_0x2adc(_0x10fbb3,_0x520a65);}const requireAdmin=(_0x57a54d,_0x5a5d2f,_0x2bdd4c)=>{const _0x1e09c6=a16_0x374b97;if(!_0x57a54d[_0x1e09c6(0x15f)]||_0x57a54d[_0x1e09c6(0x15f)]['role']!==_0x1e09c6(0x14a))return _0x5a5d2f[_0x1e09c6(0x159)](0x193)[_0x1e09c6(0x151)]({'success':![],'message':_0x1e09c6(0x166)});_0x2bdd4c();};exports['requireAdmin']=requireAdmin;const requireShop=(_0xa553b4,_0x3762ae,_0x38d2cd)=>{const _0xcb02a3=a16_0x374b97;if(!_0xa553b4[_0xcb02a3(0x15f)]||_0xa553b4['user']['role']!==_0xcb02a3(0x15a))return _0x3762ae[_0xcb02a3(0x159)](0x193)[_0xcb02a3(0x151)]({'success':![],'message':'Shop\x20access\x20required'});_0x38d2cd();};exports[a16_0x374b97(0x14e)]=requireShop;