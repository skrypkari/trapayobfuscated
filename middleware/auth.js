'use strict';const a16_0x56ceed=a16_0x1d68;function a16_0x1d68(_0x596bd5,_0x2fde37){const _0x594871=a16_0x5948();return a16_0x1d68=function(_0x1d680a,_0x498339){_0x1d680a=_0x1d680a-0x117;let _0x5ca91e=_0x594871[_0x1d680a];return _0x5ca91e;},a16_0x1d68(_0x596bd5,_0x2fde37);}(function(_0x4444a7,_0x4910dc){const _0x45461c=a16_0x1d68,_0x20ca84=_0x4444a7();while(!![]){try{const _0x2c7d2a=-parseInt(_0x45461c(0x13f))/0x1+parseInt(_0x45461c(0x12f))/0x2*(-parseInt(_0x45461c(0x13c))/0x3)+parseInt(_0x45461c(0x134))/0x4+parseInt(_0x45461c(0x118))/0x5+parseInt(_0x45461c(0x140))/0x6*(parseInt(_0x45461c(0x11d))/0x7)+-parseInt(_0x45461c(0x126))/0x8+parseInt(_0x45461c(0x137))/0x9;if(_0x2c7d2a===_0x4910dc)break;else _0x20ca84['push'](_0x20ca84['shift']());}catch(_0x5394fd){_0x20ca84['push'](_0x20ca84['shift']());}}}(a16_0x5948,0xa0115));var __importDefault=this&&this[a16_0x56ceed(0x139)]||function(_0x4151ee){const _0x41986b=a16_0x56ceed;return _0x4151ee&&_0x4151ee[_0x41986b(0x119)]?_0x4151ee:{'default':_0x4151ee};};Object[a16_0x56ceed(0x13a)](exports,a16_0x56ceed(0x119),{'value':!![]}),exports[a16_0x56ceed(0x13e)]=exports[a16_0x56ceed(0x131)]=exports[a16_0x56ceed(0x127)]=exports[a16_0x56ceed(0x124)]=void 0x0;const jsonwebtoken_1=__importDefault(require(a16_0x56ceed(0x130))),config_1=require('../config/config'),tokenBlacklistService_1=require(a16_0x56ceed(0x128)),authenticateToken=(_0x290bce,_0x593d0a,_0x159b5f)=>{const _0x3297a9=a16_0x56ceed,_0x495bb0=_0x290bce['headers'][_0x3297a9(0x129)],_0x4af642=_0x495bb0&&_0x495bb0['split']('\x20')[0x1];if(!_0x4af642)return _0x593d0a[_0x3297a9(0x135)](0x191)['json']({'success':![],'message':_0x3297a9(0x13b)});if(tokenBlacklistService_1[_0x3297a9(0x132)][_0x3297a9(0x12d)](_0x4af642))return _0x593d0a['status'](0x191)[_0x3297a9(0x120)]({'success':![],'message':_0x3297a9(0x11b)});jsonwebtoken_1[_0x3297a9(0x136)][_0x3297a9(0x12e)](_0x4af642,config_1[_0x3297a9(0x13d)][_0x3297a9(0x12c)][_0x3297a9(0x121)],(_0x1cba4b,_0x2d515e)=>{const _0x4349c7=_0x3297a9;if(_0x1cba4b)return _0x593d0a[_0x4349c7(0x135)](0x193)[_0x4349c7(0x120)]({'success':![],'message':'Invalid\x20or\x20expired\x20token'});_0x290bce[_0x4349c7(0x125)]=_0x2d515e,_0x290bce[_0x4349c7(0x141)]=_0x4af642,_0x159b5f();});};exports[a16_0x56ceed(0x124)]=authenticateToken;const requireAdmin=(_0x129ce2,_0x5f4f87,_0x2e0a4e)=>{const _0xbba07d=a16_0x56ceed;if(!_0x129ce2[_0xbba07d(0x125)]||_0x129ce2[_0xbba07d(0x125)]['role']!==_0xbba07d(0x122))return _0x5f4f87[_0xbba07d(0x135)](0x193)['json']({'success':![],'message':_0xbba07d(0x117)});_0x2e0a4e();};exports['requireAdmin']=requireAdmin;const requireShop=(_0x14aa2e,_0xfd2e08,_0x402fc7)=>{const _0x106157=a16_0x56ceed;if(!_0x14aa2e[_0x106157(0x125)]||_0x14aa2e['user'][_0x106157(0x11e)]!==_0x106157(0x138))return _0xfd2e08[_0x106157(0x135)](0x193)[_0x106157(0x120)]({'success':![],'message':_0x106157(0x11c)});_0x402fc7();};exports[a16_0x56ceed(0x131)]=requireShop;const requireActiveShop=async(_0x5132ff,_0xb2a37e,_0xa851de)=>{const _0x15c0c8=a16_0x56ceed;if(!_0x5132ff[_0x15c0c8(0x125)]||_0x5132ff['user'][_0x15c0c8(0x11e)]!=='shop')return _0xb2a37e['status'](0x193)[_0x15c0c8(0x120)]({'success':![],'message':_0x15c0c8(0x11c)});try{const _0x71e5cc=require(_0x15c0c8(0x12a))[_0x15c0c8(0x136)],_0x5738f9=await _0x71e5cc[_0x15c0c8(0x138)][_0x15c0c8(0x11a)]({'where':{'id':_0x5132ff[_0x15c0c8(0x125)]['id']},'select':{'status':!![]}});if(!_0x5738f9||_0x5738f9['status']!==_0x15c0c8(0x133))return _0xb2a37e[_0x15c0c8(0x135)](0x193)[_0x15c0c8(0x120)]({'success':![],'message':_0x15c0c8(0x123),'suspended':_0x5738f9?.[_0x15c0c8(0x135)]===_0x15c0c8(0x11f)});_0xa851de();}catch(_0x44d9dc){return console['error'](_0x15c0c8(0x12b),_0x44d9dc),_0xb2a37e['status'](0x1f4)[_0x15c0c8(0x120)]({'success':![],'message':'Error\x20checking\x20account\x20status'});}};function a16_0x5948(){const _0x522af2=['Access\x20token\x20required','21ezmdXP','config','requireActiveShop','498733ofZGMw','5319858EAcpeS','token','Admin\x20access\x20required','6124635NIJrbo','__esModule','findUnique','Token\x20has\x20been\x20revoked','Shop\x20access\x20required','7qMNuOk','role','SUSPENDED','json','secret','admin','Account\x20is\x20suspended\x20or\x20inactive.\x20Contact\x20administrator\x20to\x20activate\x20your\x20account.','authenticateToken','user','10096536HKgpiq','requireAdmin','../services/tokenBlacklistService','authorization','../config/database','Error\x20checking\x20account\x20status:','jwt','isTokenBlacklisted','verify','244094sGlnBS','jsonwebtoken','requireShop','tokenBlacklistService','ACTIVE','3951096rrvnYT','status','default','1542798iwBybZ','shop','__importDefault','defineProperty'];a16_0x5948=function(){return _0x522af2;};return a16_0x5948();}exports[a16_0x56ceed(0x13e)]=requireActiveShop;