'use strict';const a15_0x158a44=a15_0x45f7;function a15_0x45f7(_0x5a7482,_0x1dbcdb){const _0x43460c=a15_0x4346();return a15_0x45f7=function(_0x45f7fe,_0x52359){_0x45f7fe=_0x45f7fe-0xf3;let _0x4a92fa=_0x43460c[_0x45f7fe];return _0x4a92fa;},a15_0x45f7(_0x5a7482,_0x1dbcdb);}function a15_0x4346(){const _0x11bfa8=['secret','Token\x20has\x20been\x20revoked','14EErYuh','Invalid\x20or\x20expired\x20token','tokenBlacklistService','__esModule','10376973fFQJaw','689893cbcehl','verify','authorization','shop','authenticateToken','../services/tokenBlacklistService','json','headers','__importDefault','643755lPfWKf','3176772bqqWpS','user','1218860GcwClA','jwt','isTokenBlacklisted','token','role','status','jsonwebtoken','1041960QFkIzc','../config/config','2Gtonkj','4900504zUVkhd','split','requireShop','requireAdmin','defineProperty','Access\x20token\x20required'];a15_0x4346=function(){return _0x11bfa8;};return a15_0x4346();}(function(_0x255893,_0x4b9565){const _0x358858=a15_0x45f7,_0x431cd2=_0x255893();while(!![]){try{const _0x56a65f=-parseInt(_0x358858(0x109))/0x1*(-parseInt(_0x358858(0xfb))/0x2)+parseInt(_0x358858(0xf9))/0x3+parseInt(_0x358858(0x115))/0x4+-parseInt(_0x358858(0x112))/0x5+parseInt(_0x358858(0x113))/0x6*(-parseInt(_0x358858(0x104))/0x7)+-parseInt(_0x358858(0xfc))/0x8+parseInt(_0x358858(0x108))/0x9;if(_0x56a65f===_0x4b9565)break;else _0x431cd2['push'](_0x431cd2['shift']());}catch(_0x32fa65){_0x431cd2['push'](_0x431cd2['shift']());}}}(a15_0x4346,0xa999f));var __importDefault=this&&this[a15_0x158a44(0x111)]||function(_0x55b63b){const _0x4d9e66=a15_0x158a44;return _0x55b63b&&_0x55b63b[_0x4d9e66(0x107)]?_0x55b63b:{'default':_0x55b63b};};Object[a15_0x158a44(0x100)](exports,a15_0x158a44(0x107),{'value':!![]}),exports[a15_0x158a44(0xfe)]=exports[a15_0x158a44(0xff)]=exports[a15_0x158a44(0x10d)]=void 0x0;const jsonwebtoken_1=__importDefault(require(a15_0x158a44(0xf8))),config_1=require(a15_0x158a44(0xfa)),tokenBlacklistService_1=require(a15_0x158a44(0x10e)),authenticateToken=(_0x2fe572,_0x4e2a59,_0x49e27a)=>{const _0x189186=a15_0x158a44,_0x2b9173=_0x2fe572[_0x189186(0x110)][_0x189186(0x10b)],_0x27cf24=_0x2b9173&&_0x2b9173[_0x189186(0xfd)]('\x20')[0x1];if(!_0x27cf24)return _0x4e2a59[_0x189186(0xf7)](0x191)[_0x189186(0x10f)]({'success':![],'message':_0x189186(0x101)});if(tokenBlacklistService_1[_0x189186(0x106)][_0x189186(0xf4)](_0x27cf24))return _0x4e2a59[_0x189186(0xf7)](0x191)[_0x189186(0x10f)]({'success':![],'message':_0x189186(0x103)});jsonwebtoken_1['default'][_0x189186(0x10a)](_0x27cf24,config_1['config'][_0x189186(0xf3)][_0x189186(0x102)],(_0x481668,_0x12b0d3)=>{const _0x346c50=_0x189186;if(_0x481668)return _0x4e2a59[_0x346c50(0xf7)](0x193)[_0x346c50(0x10f)]({'success':![],'message':_0x346c50(0x105)});_0x2fe572[_0x346c50(0x114)]=_0x12b0d3,_0x2fe572[_0x346c50(0xf5)]=_0x27cf24,_0x49e27a();});};exports[a15_0x158a44(0x10d)]=authenticateToken;const requireAdmin=(_0x2d58c6,_0x136184,_0x4a6daa)=>{const _0x191929=a15_0x158a44;if(!_0x2d58c6[_0x191929(0x114)]||_0x2d58c6['user']['role']!=='admin')return _0x136184['status'](0x193)[_0x191929(0x10f)]({'success':![],'message':'Admin\x20access\x20required'});_0x4a6daa();};exports[a15_0x158a44(0xff)]=requireAdmin;const requireShop=(_0x30b553,_0xaa8199,_0x4f7257)=>{const _0x5bdf82=a15_0x158a44;if(!_0x30b553['user']||_0x30b553[_0x5bdf82(0x114)][_0x5bdf82(0xf6)]!==_0x5bdf82(0x10c))return _0xaa8199[_0x5bdf82(0xf7)](0x193)[_0x5bdf82(0x10f)]({'success':![],'message':'Shop\x20access\x20required'});_0x4f7257();};exports[a15_0x158a44(0xfe)]=requireShop;