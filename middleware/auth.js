'use strict';const a22_0x4e6e48=a22_0x4565;(function(_0xd97456,_0x268e3a){const _0x229384=a22_0x4565,_0x474bff=_0xd97456();while(!![]){try{const _0x945287=parseInt(_0x229384(0x180))/0x1*(parseInt(_0x229384(0x17b))/0x2)+parseInt(_0x229384(0x172))/0x3*(-parseInt(_0x229384(0x167))/0x4)+parseInt(_0x229384(0x15e))/0x5*(parseInt(_0x229384(0x177))/0x6)+parseInt(_0x229384(0x182))/0x7*(-parseInt(_0x229384(0x166))/0x8)+-parseInt(_0x229384(0x16c))/0x9+parseInt(_0x229384(0x15b))/0xa+parseInt(_0x229384(0x17a))/0xb;if(_0x945287===_0x268e3a)break;else _0x474bff['push'](_0x474bff['shift']());}catch(_0x399dd6){_0x474bff['push'](_0x474bff['shift']());}}}(a22_0x15c4,0xafeb4));var __importDefault=this&&this['__importDefault']||function(_0x18fdfe){const _0x3b0f39=a22_0x4565;return _0x18fdfe&&_0x18fdfe[_0x3b0f39(0x178)]?_0x18fdfe:{'default':_0x18fdfe};};Object['defineProperty'](exports,'__esModule',{'value':!![]}),exports[a22_0x4e6e48(0x17e)]=exports[a22_0x4e6e48(0x158)]=exports[a22_0x4e6e48(0x15f)]=exports['authenticateToken']=void 0x0;function a22_0x15c4(){const _0x5455e5=['22240YdzqKU','109392MpNutZ','user','isTokenBlacklisted','headers','error','12908295FcMilk','Error\x20checking\x20account\x20status:','config','authorization','ACTIVE','Admin\x20access\x20required','132xgRBrv','admin','json','Invalid\x20or\x20expired\x20token','jsonwebtoken','2067612XEDIwm','__esModule','findUnique','17222172UbSHaD','8ezKoEO','verify','default','requireActiveShop','status','180029kZNprI','Shop\x20access\x20required','1281LevyxE','../config/database','token','secret','requireShop','shop','../services/tokenBlacklistService','2026950vREnAl','SUSPENDED','split','20dVSZjU','requireAdmin','Token\x20has\x20been\x20revoked','jwt','role','../config/config','Account\x20is\x20suspended\x20or\x20inactive.\x20Contact\x20administrator\x20to\x20activate\x20your\x20account.','Error\x20checking\x20account\x20status'];a22_0x15c4=function(){return _0x5455e5;};return a22_0x15c4();}const jsonwebtoken_1=__importDefault(require(a22_0x4e6e48(0x176))),config_1=require(a22_0x4e6e48(0x163)),tokenBlacklistService_1=require(a22_0x4e6e48(0x15a)),authenticateToken=(_0x1cf21d,_0x2da76f,_0x44145b)=>{const _0x522d0f=a22_0x4e6e48,_0x4baf46=_0x1cf21d[_0x522d0f(0x16a)][_0x522d0f(0x16f)],_0x1aae30=_0x4baf46&&_0x4baf46[_0x522d0f(0x15d)]('\x20')[0x1];if(!_0x1aae30)return _0x2da76f[_0x522d0f(0x17f)](0x191)['json']({'success':![],'message':'Access\x20token\x20required'});if(tokenBlacklistService_1['tokenBlacklistService'][_0x522d0f(0x169)](_0x1aae30))return _0x2da76f[_0x522d0f(0x17f)](0x191)['json']({'success':![],'message':_0x522d0f(0x160)});jsonwebtoken_1[_0x522d0f(0x17d)][_0x522d0f(0x17c)](_0x1aae30,config_1[_0x522d0f(0x16e)][_0x522d0f(0x161)][_0x522d0f(0x185)],(_0x91d1ed,_0x14aec0)=>{const _0x5a268e=_0x522d0f;if(_0x91d1ed)return _0x2da76f['status'](0x193)[_0x5a268e(0x174)]({'success':![],'message':_0x5a268e(0x175)});_0x1cf21d[_0x5a268e(0x168)]=_0x14aec0,_0x1cf21d[_0x5a268e(0x184)]=_0x1aae30,_0x44145b();});};exports['authenticateToken']=authenticateToken;function a22_0x4565(_0x2a00b8,_0x46eef2){_0x2a00b8=_0x2a00b8-0x158;const _0x15c402=a22_0x15c4();let _0x45657e=_0x15c402[_0x2a00b8];return _0x45657e;}const requireAdmin=(_0x48aae8,_0xc6fb1f,_0x497da5)=>{const _0x5e1148=a22_0x4e6e48;if(!_0x48aae8['user']||_0x48aae8['user'][_0x5e1148(0x162)]!==_0x5e1148(0x173))return _0xc6fb1f[_0x5e1148(0x17f)](0x193)['json']({'success':![],'message':_0x5e1148(0x171)});_0x497da5();};exports[a22_0x4e6e48(0x15f)]=requireAdmin;const requireShop=(_0x1dd375,_0x248c48,_0x2c86d2)=>{const _0x5a3f8f=a22_0x4e6e48;if(!_0x1dd375['user']||_0x1dd375['user'][_0x5a3f8f(0x162)]!=='shop')return _0x248c48['status'](0x193)[_0x5a3f8f(0x174)]({'success':![],'message':'Shop\x20access\x20required'});_0x2c86d2();};exports[a22_0x4e6e48(0x158)]=requireShop;const requireActiveShop=async(_0x329085,_0x33438f,_0x2ba19e)=>{const _0x4b79be=a22_0x4e6e48;if(!_0x329085['user']||_0x329085[_0x4b79be(0x168)][_0x4b79be(0x162)]!=='shop')return _0x33438f[_0x4b79be(0x17f)](0x193)[_0x4b79be(0x174)]({'success':![],'message':_0x4b79be(0x181)});try{const _0x2bc5b4=require(_0x4b79be(0x183))[_0x4b79be(0x17d)],_0x24c638=await _0x2bc5b4[_0x4b79be(0x159)][_0x4b79be(0x179)]({'where':{'id':_0x329085[_0x4b79be(0x168)]['id']},'select':{'status':!![]}});if(!_0x24c638||_0x24c638[_0x4b79be(0x17f)]!==_0x4b79be(0x170))return _0x33438f[_0x4b79be(0x17f)](0x193)[_0x4b79be(0x174)]({'success':![],'message':_0x4b79be(0x164),'suspended':_0x24c638?.[_0x4b79be(0x17f)]===_0x4b79be(0x15c)});_0x2ba19e();}catch(_0x5eff22){return console[_0x4b79be(0x16b)](_0x4b79be(0x16d),_0x5eff22),_0x33438f[_0x4b79be(0x17f)](0x1f4)['json']({'success':![],'message':_0x4b79be(0x165)});}};exports[a22_0x4e6e48(0x17e)]=requireActiveShop;