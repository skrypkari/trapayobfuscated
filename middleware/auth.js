'use strict';function a16_0x35dd(){const _0x26240d=['shop','124872hLyCvE','secret','findUnique','ACTIVE','25Xyepfv','Token\x20has\x20been\x20revoked','authenticateToken','802131MttwIy','__importDefault','196091KgtZSn','Error\x20checking\x20account\x20status','jwt','3394200KzFSFx','1248472qxdqQR','__esModule','Error\x20checking\x20account\x20status:','error','role','user','7VKMYot','requireShop','split','status','tokenBlacklistService','../services/tokenBlacklistService','requireAdmin','464913DoXVFI','../config/database','authorization','default','json','requireActiveShop','defineProperty','SUSPENDED','207132aAMmjL','Admin\x20access\x20required','Account\x20is\x20suspended\x20or\x20inactive.\x20Contact\x20administrator\x20to\x20activate\x20your\x20account.','Access\x20token\x20required','2zoCwdr','Invalid\x20or\x20expired\x20token'];a16_0x35dd=function(){return _0x26240d;};return a16_0x35dd();}const a16_0x2140dd=a16_0x2810;(function(_0x59939a,_0x3dabfb){const _0x5755d4=a16_0x2810,_0x1c2128=_0x59939a();while(!![]){try{const _0x32aef7=parseInt(_0x5755d4(0xb0))/0x1*(-parseInt(_0x5755d4(0xa4))/0x2)+parseInt(_0x5755d4(0xae))/0x3+parseInt(_0x5755d4(0xc9))/0x4*(parseInt(_0x5755d4(0xab))/0x5)+parseInt(_0x5755d4(0xa7))/0x6+-parseInt(_0x5755d4(0xba))/0x7*(-parseInt(_0x5755d4(0xb4))/0x8)+parseInt(_0x5755d4(0xc1))/0x9+-parseInt(_0x5755d4(0xb3))/0xa;if(_0x32aef7===_0x3dabfb)break;else _0x1c2128['push'](_0x1c2128['shift']());}catch(_0x55064c){_0x1c2128['push'](_0x1c2128['shift']());}}}(a16_0x35dd,0x358ad));var __importDefault=this&&this[a16_0x2140dd(0xaf)]||function(_0x4d38b7){const _0x30da01=a16_0x2140dd;return _0x4d38b7&&_0x4d38b7[_0x30da01(0xb5)]?_0x4d38b7:{'default':_0x4d38b7};};Object[a16_0x2140dd(0xc7)](exports,a16_0x2140dd(0xb5),{'value':!![]}),exports['requireActiveShop']=exports[a16_0x2140dd(0xbb)]=exports[a16_0x2140dd(0xc0)]=exports[a16_0x2140dd(0xad)]=void 0x0;const jsonwebtoken_1=__importDefault(require('jsonwebtoken')),config_1=require('../config/config'),tokenBlacklistService_1=require(a16_0x2140dd(0xbf)),authenticateToken=(_0x5abcb1,_0x2061c2,_0x2b525a)=>{const _0x43781a=a16_0x2140dd,_0x1af6ee=_0x5abcb1['headers'][_0x43781a(0xc3)],_0x6da05=_0x1af6ee&&_0x1af6ee[_0x43781a(0xbc)]('\x20')[0x1];if(!_0x6da05)return _0x2061c2[_0x43781a(0xbd)](0x191)[_0x43781a(0xc5)]({'success':![],'message':_0x43781a(0xcc)});if(tokenBlacklistService_1[_0x43781a(0xbe)]['isTokenBlacklisted'](_0x6da05))return _0x2061c2[_0x43781a(0xbd)](0x191)['json']({'success':![],'message':_0x43781a(0xac)});jsonwebtoken_1[_0x43781a(0xc4)]['verify'](_0x6da05,config_1['config'][_0x43781a(0xb2)][_0x43781a(0xa8)],(_0x21699e,_0x3a7649)=>{const _0x5b09db=_0x43781a;if(_0x21699e)return _0x2061c2[_0x5b09db(0xbd)](0x193)[_0x5b09db(0xc5)]({'success':![],'message':_0x5b09db(0xa5)});_0x5abcb1['user']=_0x3a7649,_0x5abcb1['token']=_0x6da05,_0x2b525a();});};exports[a16_0x2140dd(0xad)]=authenticateToken;function a16_0x2810(_0x495fd4,_0x4d0cc1){const _0x35ddd8=a16_0x35dd();return a16_0x2810=function(_0x2810aa,_0x5660a7){_0x2810aa=_0x2810aa-0xa4;let _0x5c6d2a=_0x35ddd8[_0x2810aa];return _0x5c6d2a;},a16_0x2810(_0x495fd4,_0x4d0cc1);}const requireAdmin=(_0x333547,_0x369b3f,_0x4fe9cf)=>{const _0x4df5a5=a16_0x2140dd;if(!_0x333547[_0x4df5a5(0xb9)]||_0x333547[_0x4df5a5(0xb9)][_0x4df5a5(0xb8)]!=='admin')return _0x369b3f['status'](0x193)[_0x4df5a5(0xc5)]({'success':![],'message':_0x4df5a5(0xca)});_0x4fe9cf();};exports[a16_0x2140dd(0xc0)]=requireAdmin;const requireShop=(_0x9abe7,_0x5226d2,_0x16acda)=>{const _0x118486=a16_0x2140dd;if(!_0x9abe7['user']||_0x9abe7['user'][_0x118486(0xb8)]!=='shop')return _0x5226d2[_0x118486(0xbd)](0x193)[_0x118486(0xc5)]({'success':![],'message':'Shop\x20access\x20required'});_0x16acda();};exports[a16_0x2140dd(0xbb)]=requireShop;const requireActiveShop=async(_0xda886f,_0x534c63,_0x404164)=>{const _0x14a4e7=a16_0x2140dd;if(!_0xda886f[_0x14a4e7(0xb9)]||_0xda886f[_0x14a4e7(0xb9)]['role']!==_0x14a4e7(0xa6))return _0x534c63[_0x14a4e7(0xbd)](0x193)[_0x14a4e7(0xc5)]({'success':![],'message':'Shop\x20access\x20required'});try{const _0x5951cb=require(_0x14a4e7(0xc2))['default'],_0x3656e8=await _0x5951cb[_0x14a4e7(0xa6)][_0x14a4e7(0xa9)]({'where':{'id':_0xda886f['user']['id']},'select':{'status':!![]}});if(!_0x3656e8||_0x3656e8['status']!==_0x14a4e7(0xaa))return _0x534c63['status'](0x193)[_0x14a4e7(0xc5)]({'success':![],'message':_0x14a4e7(0xcb),'suspended':_0x3656e8?.['status']===_0x14a4e7(0xc8)});_0x404164();}catch(_0x1307a7){return console[_0x14a4e7(0xb7)](_0x14a4e7(0xb6),_0x1307a7),_0x534c63[_0x14a4e7(0xbd)](0x1f4)['json']({'success':![],'message':_0x14a4e7(0xb1)});}};exports[a16_0x2140dd(0xc6)]=requireActiveShop;