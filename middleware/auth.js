'use strict';const a15_0x2a57d8=a15_0x17b7;(function(_0x46062d,_0x1c52bd){const _0x26953f=a15_0x17b7,_0x5a21be=_0x46062d();while(!![]){try{const _0xb6cb7f=-parseInt(_0x26953f(0x76))/0x1+-parseInt(_0x26953f(0x80))/0x2*(-parseInt(_0x26953f(0x77))/0x3)+-parseInt(_0x26953f(0x8b))/0x4+-parseInt(_0x26953f(0x8a))/0x5*(-parseInt(_0x26953f(0x6f))/0x6)+-parseInt(_0x26953f(0x88))/0x7*(parseInt(_0x26953f(0x69))/0x8)+-parseInt(_0x26953f(0x6a))/0x9+-parseInt(_0x26953f(0x7c))/0xa*(-parseInt(_0x26953f(0x83))/0xb);if(_0xb6cb7f===_0x1c52bd)break;else _0x5a21be['push'](_0x5a21be['shift']());}catch(_0x1305ef){_0x5a21be['push'](_0x5a21be['shift']());}}}(a15_0x2a75,0xaebc0));var __importDefault=this&&this[a15_0x2a57d8(0x73)]||function(_0x2b101d){const _0x31acc0=a15_0x2a57d8;return _0x2b101d&&_0x2b101d[_0x31acc0(0x87)]?_0x2b101d:{'default':_0x2b101d};};function a15_0x2a75(){const _0x130fe4=['Access\x20token\x20required','2RRhugr','jwt','authenticateToken','264ZvZewu','../config/config','verify','shop','__esModule','3720829uZXaQa','admin','80qJmsSW','525036ZPKypa','16zsGmeH','3279060FqLUUY','role','user','config','split','392556hTlrEE','status','headers','requireShop','__importDefault','requireAdmin','default','1101136sqjYOP','2661279qFLnYO','authorization','json','secret','Admin\x20access\x20required','600680LWwkUd','token','isTokenBlacklisted'];a15_0x2a75=function(){return _0x130fe4;};return a15_0x2a75();}Object['defineProperty'](exports,a15_0x2a57d8(0x87),{'value':!![]}),exports[a15_0x2a57d8(0x72)]=exports[a15_0x2a57d8(0x74)]=exports['authenticateToken']=void 0x0;const jsonwebtoken_1=__importDefault(require('jsonwebtoken')),config_1=require(a15_0x2a57d8(0x84)),tokenBlacklistService_1=require('../services/tokenBlacklistService'),authenticateToken=(_0x4513c7,_0x414298,_0x1be093)=>{const _0x5e202b=a15_0x2a57d8,_0x663f98=_0x4513c7[_0x5e202b(0x71)][_0x5e202b(0x78)],_0x411a67=_0x663f98&&_0x663f98[_0x5e202b(0x6e)]('\x20')[0x1];if(!_0x411a67)return _0x414298[_0x5e202b(0x70)](0x191)['json']({'success':![],'message':_0x5e202b(0x7f)});if(tokenBlacklistService_1['tokenBlacklistService'][_0x5e202b(0x7e)](_0x411a67))return _0x414298[_0x5e202b(0x70)](0x191)[_0x5e202b(0x79)]({'success':![],'message':'Token\x20has\x20been\x20revoked'});jsonwebtoken_1[_0x5e202b(0x75)][_0x5e202b(0x85)](_0x411a67,config_1[_0x5e202b(0x6d)][_0x5e202b(0x81)][_0x5e202b(0x7a)],(_0x3a119c,_0x4dc708)=>{const _0x44d566=_0x5e202b;if(_0x3a119c)return _0x414298[_0x44d566(0x70)](0x193)['json']({'success':![],'message':'Invalid\x20or\x20expired\x20token'});_0x4513c7['user']=_0x4dc708,_0x4513c7[_0x44d566(0x7d)]=_0x411a67,_0x1be093();});};exports[a15_0x2a57d8(0x82)]=authenticateToken;function a15_0x17b7(_0x36db1c,_0x167447){const _0x2a75e7=a15_0x2a75();return a15_0x17b7=function(_0x17b700,_0x9308e0){_0x17b700=_0x17b700-0x69;let _0x2175cc=_0x2a75e7[_0x17b700];return _0x2175cc;},a15_0x17b7(_0x36db1c,_0x167447);}const requireAdmin=(_0x23bbcc,_0x317e19,_0x5ec869)=>{const _0x3f52a9=a15_0x2a57d8;if(!_0x23bbcc[_0x3f52a9(0x6c)]||_0x23bbcc[_0x3f52a9(0x6c)]['role']!==_0x3f52a9(0x89))return _0x317e19[_0x3f52a9(0x70)](0x193)[_0x3f52a9(0x79)]({'success':![],'message':_0x3f52a9(0x7b)});_0x5ec869();};exports[a15_0x2a57d8(0x74)]=requireAdmin;const requireShop=(_0x4167e3,_0x18c94d,_0x2fb0ae)=>{const _0x519cdf=a15_0x2a57d8;if(!_0x4167e3[_0x519cdf(0x6c)]||_0x4167e3[_0x519cdf(0x6c)][_0x519cdf(0x6b)]!==_0x519cdf(0x86))return _0x18c94d['status'](0x193)['json']({'success':![],'message':'Shop\x20access\x20required'});_0x2fb0ae();};exports[a15_0x2a57d8(0x72)]=requireShop;