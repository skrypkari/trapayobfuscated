'use strict';const a16_0x3da8c3=a16_0x1755;(function(_0x5cdb49,_0x3e3114){const _0x3f0300=a16_0x1755,_0x150b17=_0x5cdb49();while(!![]){try{const _0x17684b=-parseInt(_0x3f0300(0x159))/0x1+-parseInt(_0x3f0300(0x160))/0x2*(-parseInt(_0x3f0300(0x164))/0x3)+-parseInt(_0x3f0300(0x14e))/0x4+-parseInt(_0x3f0300(0x154))/0x5+parseInt(_0x3f0300(0x161))/0x6*(-parseInt(_0x3f0300(0x15d))/0x7)+parseInt(_0x3f0300(0x16d))/0x8*(parseInt(_0x3f0300(0x14f))/0x9)+parseInt(_0x3f0300(0x168))/0xa;if(_0x17684b===_0x3e3114)break;else _0x150b17['push'](_0x150b17['shift']());}catch(_0xaa5645){_0x150b17['push'](_0x150b17['shift']());}}}(a16_0x4707,0x4c29c));function a16_0x1755(_0x480167,_0xbcf2dc){const _0x47071b=a16_0x4707();return a16_0x1755=function(_0x1755bd,_0x24288e){_0x1755bd=_0x1755bd-0x14d;let _0x2a3841=_0x47071b[_0x1755bd];return _0x2a3841;},a16_0x1755(_0x480167,_0xbcf2dc);}var __importDefault=this&&this[a16_0x3da8c3(0x15b)]||function(_0x5b9a03){const _0x999590=a16_0x3da8c3;return _0x5b9a03&&_0x5b9a03[_0x999590(0x16b)]?_0x5b9a03:{'default':_0x5b9a03};};Object[a16_0x3da8c3(0x162)](exports,a16_0x3da8c3(0x16b),{'value':!![]}),exports[a16_0x3da8c3(0x15f)]=exports[a16_0x3da8c3(0x14d)]=exports[a16_0x3da8c3(0x151)]=void 0x0;function a16_0x4707(){const _0x1160b7=['authenticateToken','split','Access\x20token\x20required','996235xNIcDG','config','tokenBlacklistService','json','status','3938PioiDt','authorization','__importDefault','Admin\x20access\x20required','476lZiblX','admin','requireShop','634oPgMDU','18702OZSnqR','defineProperty','Shop\x20access\x20required','3285ZRsFFN','../services/tokenBlacklistService','../config/config','isTokenBlacklisted','5322050ScqvUN','Invalid\x20or\x20expired\x20token','jsonwebtoken','__esModule','Token\x20has\x20been\x20revoked','348336fnHtFP','user','requireAdmin','2002204BVfBaT','72cCQUhd','verify'];a16_0x4707=function(){return _0x1160b7;};return a16_0x4707();}const jsonwebtoken_1=__importDefault(require(a16_0x3da8c3(0x16a))),config_1=require(a16_0x3da8c3(0x166)),tokenBlacklistService_1=require(a16_0x3da8c3(0x165)),authenticateToken=(_0x191cff,_0x3bcf54,_0x40656d)=>{const _0x199072=a16_0x3da8c3,_0x4d1869=_0x191cff['headers'][_0x199072(0x15a)],_0x3d1c75=_0x4d1869&&_0x4d1869[_0x199072(0x152)]('\x20')[0x1];if(!_0x3d1c75)return _0x3bcf54[_0x199072(0x158)](0x191)[_0x199072(0x157)]({'success':![],'message':_0x199072(0x153)});if(tokenBlacklistService_1[_0x199072(0x156)][_0x199072(0x167)](_0x3d1c75))return _0x3bcf54[_0x199072(0x158)](0x191)[_0x199072(0x157)]({'success':![],'message':_0x199072(0x16c)});jsonwebtoken_1['default'][_0x199072(0x150)](_0x3d1c75,config_1[_0x199072(0x155)]['jwt']['secret'],(_0x32caff,_0x413047)=>{const _0x27517e=_0x199072;if(_0x32caff)return _0x3bcf54[_0x27517e(0x158)](0x193)[_0x27517e(0x157)]({'success':![],'message':_0x27517e(0x169)});_0x191cff['user']=_0x413047,_0x191cff['token']=_0x3d1c75,_0x40656d();});};exports[a16_0x3da8c3(0x151)]=authenticateToken;const requireAdmin=(_0x1a2b3a,_0x2ef9d9,_0x4e3874)=>{const _0xb00426=a16_0x3da8c3;if(!_0x1a2b3a[_0xb00426(0x16e)]||_0x1a2b3a[_0xb00426(0x16e)]['role']!==_0xb00426(0x15e))return _0x2ef9d9[_0xb00426(0x158)](0x193)[_0xb00426(0x157)]({'success':![],'message':_0xb00426(0x15c)});_0x4e3874();};exports[a16_0x3da8c3(0x14d)]=requireAdmin;const requireShop=(_0x33a8fa,_0x21a154,_0x3d3e74)=>{const _0x25be27=a16_0x3da8c3;if(!_0x33a8fa[_0x25be27(0x16e)]||_0x33a8fa[_0x25be27(0x16e)]['role']!=='shop')return _0x21a154[_0x25be27(0x158)](0x193)[_0x25be27(0x157)]({'success':![],'message':_0x25be27(0x163)});_0x3d3e74();};exports[a16_0x3da8c3(0x15f)]=requireShop;