'use strict';const a16_0x2e08f2=a16_0x5602;(function(_0x2aa96b,_0x5c069e){const _0x433b8a=a16_0x5602,_0x303848=_0x2aa96b();while(!![]){try{const _0x17dc80=-parseInt(_0x433b8a(0x1f7))/0x1*(parseInt(_0x433b8a(0x1f9))/0x2)+parseInt(_0x433b8a(0x1fd))/0x3*(parseInt(_0x433b8a(0x204))/0x4)+-parseInt(_0x433b8a(0x1ff))/0x5+-parseInt(_0x433b8a(0x1f5))/0x6*(parseInt(_0x433b8a(0x1ed))/0x7)+parseInt(_0x433b8a(0x1fa))/0x8+parseInt(_0x433b8a(0x1f1))/0x9*(parseInt(_0x433b8a(0x203))/0xa)+-parseInt(_0x433b8a(0x1f3))/0xb*(-parseInt(_0x433b8a(0x207))/0xc);if(_0x17dc80===_0x5c069e)break;else _0x303848['push'](_0x303848['shift']());}catch(_0x6ed9c4){_0x303848['push'](_0x303848['shift']());}}}(a16_0x3f12,0x19ebd));var __importDefault=this&&this[a16_0x2e08f2(0x1e8)]||function(_0x1a3a5e){return _0x1a3a5e&&_0x1a3a5e['__esModule']?_0x1a3a5e:{'default':_0x1a3a5e};};Object['defineProperty'](exports,a16_0x2e08f2(0x202),{'value':!![]}),exports[a16_0x2e08f2(0x206)]=exports[a16_0x2e08f2(0x1f2)]=exports['authenticateToken']=void 0x0;const jsonwebtoken_1=__importDefault(require(a16_0x2e08f2(0x1e7))),config_1=require('../config/config'),tokenBlacklistService_1=require(a16_0x2e08f2(0x1ee)),authenticateToken=(_0x5b5ecc,_0x1ff209,_0x1eda0a)=>{const _0x399f49=a16_0x2e08f2,_0x3d4fe9=_0x5b5ecc[_0x399f49(0x1f0)][_0x399f49(0x1eb)],_0x2bf5bc=_0x3d4fe9&&_0x3d4fe9[_0x399f49(0x209)]('\x20')[0x1];if(!_0x2bf5bc)return _0x1ff209[_0x399f49(0x205)](0x191)[_0x399f49(0x1f8)]({'success':![],'message':_0x399f49(0x20a)});if(tokenBlacklistService_1[_0x399f49(0x1fe)]['isTokenBlacklisted'](_0x2bf5bc))return _0x1ff209[_0x399f49(0x205)](0x191)['json']({'success':![],'message':'Token\x20has\x20been\x20revoked'});jsonwebtoken_1['default'][_0x399f49(0x1f4)](_0x2bf5bc,config_1[_0x399f49(0x1ea)][_0x399f49(0x1ef)][_0x399f49(0x1fc)],(_0x21032b,_0x2012d0)=>{const _0x3e0093=_0x399f49;if(_0x21032b)return _0x1ff209[_0x3e0093(0x205)](0x193)[_0x3e0093(0x1f8)]({'success':![],'message':_0x3e0093(0x1ec)});_0x5b5ecc[_0x3e0093(0x208)]=_0x2012d0,_0x5b5ecc[_0x3e0093(0x1f6)]=_0x2bf5bc,_0x1eda0a();});};exports[a16_0x2e08f2(0x1e9)]=authenticateToken;const requireAdmin=(_0x32e39c,_0x1eadf9,_0x3efa05)=>{const _0x331f9a=a16_0x2e08f2;if(!_0x32e39c['user']||_0x32e39c[_0x331f9a(0x208)][_0x331f9a(0x201)]!==_0x331f9a(0x200))return _0x1eadf9[_0x331f9a(0x205)](0x193)[_0x331f9a(0x1f8)]({'success':![],'message':_0x331f9a(0x1fb)});_0x3efa05();};function a16_0x3f12(){const _0x343136=['tokenBlacklistService','745045DLSURJ','admin','role','__esModule','179770YeNtoQ','77932pIjBkv','status','requireShop','327264VZgOfI','user','split','Access\x20token\x20required','jsonwebtoken','__importDefault','authenticateToken','config','authorization','Invalid\x20or\x20expired\x20token','39151ZhnZab','../services/tokenBlacklistService','jwt','headers','27uWLajV','requireAdmin','55BcHSMJ','verify','48WsOoNZ','token','100zfTjeE','json','3706ewVGYR','1268432AKOKXV','Admin\x20access\x20required','secret','21oqSaEu'];a16_0x3f12=function(){return _0x343136;};return a16_0x3f12();}exports[a16_0x2e08f2(0x1f2)]=requireAdmin;function a16_0x5602(_0x10b9f8,_0x4e880b){const _0x3f12da=a16_0x3f12();return a16_0x5602=function(_0x560284,_0x32c9ce){_0x560284=_0x560284-0x1e7;let _0x2274f0=_0x3f12da[_0x560284];return _0x2274f0;},a16_0x5602(_0x10b9f8,_0x4e880b);}const requireShop=(_0x596e98,_0x1456ae,_0x4f58cb)=>{const _0x2d55cf=a16_0x2e08f2;if(!_0x596e98[_0x2d55cf(0x208)]||_0x596e98['user'][_0x2d55cf(0x201)]!=='shop')return _0x1456ae[_0x2d55cf(0x205)](0x193)[_0x2d55cf(0x1f8)]({'success':![],'message':'Shop\x20access\x20required'});_0x4f58cb();};exports[a16_0x2e08f2(0x206)]=requireShop;