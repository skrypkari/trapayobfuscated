'use strict';const a17_0x5cf5f2=a17_0x2a86;function a17_0x2a86(_0x5e74ab,_0x49fd49){const _0x5b581d=a17_0x5b58();return a17_0x2a86=function(_0x2a8699,_0x15bd4e){_0x2a8699=_0x2a8699-0x1f1;let _0x4facf5=_0x5b581d[_0x2a8699];return _0x4facf5;},a17_0x2a86(_0x5e74ab,_0x49fd49);}(function(_0x2e1056,_0xc176fd){const _0x34a181=a17_0x2a86,_0x5a1e9f=_0x2e1056();while(!![]){try{const _0x44db6b=parseInt(_0x34a181(0x1f2))/0x1*(-parseInt(_0x34a181(0x1fa))/0x2)+-parseInt(_0x34a181(0x21c))/0x3*(-parseInt(_0x34a181(0x219))/0x4)+-parseInt(_0x34a181(0x20b))/0x5*(parseInt(_0x34a181(0x1f5))/0x6)+parseInt(_0x34a181(0x204))/0x7*(-parseInt(_0x34a181(0x218))/0x8)+parseInt(_0x34a181(0x21a))/0x9*(parseInt(_0x34a181(0x217))/0xa)+-parseInt(_0x34a181(0x216))/0xb+parseInt(_0x34a181(0x1ff))/0xc*(parseInt(_0x34a181(0x1fc))/0xd);if(_0x44db6b===_0xc176fd)break;else _0x5a1e9f['push'](_0x5a1e9f['shift']());}catch(_0x1486ee){_0x5a1e9f['push'](_0x5a1e9f['shift']());}}}(a17_0x5b58,0xf0549));var __importDefault=this&&this['__importDefault']||function(_0xe304c){const _0x5e0f16=a17_0x2a86;return _0xe304c&&_0xe304c[_0x5e0f16(0x1f6)]?_0xe304c:{'default':_0xe304c};};Object[a17_0x5cf5f2(0x212)](exports,'__esModule',{'value':!![]}),exports['requireActiveShop']=exports[a17_0x5cf5f2(0x20e)]=exports[a17_0x5cf5f2(0x215)]=exports['authenticateToken']=void 0x0;const jsonwebtoken_1=__importDefault(require(a17_0x5cf5f2(0x202))),config_1=require(a17_0x5cf5f2(0x208)),tokenBlacklistService_1=require(a17_0x5cf5f2(0x213)),authenticateToken=(_0x4646ad,_0x38a535,_0x14bfca)=>{const _0x18eb3b=a17_0x5cf5f2,_0x5106ed=_0x4646ad[_0x18eb3b(0x1f1)][_0x18eb3b(0x1fb)],_0x178fce=_0x5106ed&&_0x5106ed[_0x18eb3b(0x214)]('\x20')[0x1];if(!_0x178fce)return _0x38a535[_0x18eb3b(0x20a)](0x191)[_0x18eb3b(0x205)]({'success':![],'message':_0x18eb3b(0x21b)});if(tokenBlacklistService_1[_0x18eb3b(0x210)]['isTokenBlacklisted'](_0x178fce))return _0x38a535[_0x18eb3b(0x20a)](0x191)['json']({'success':![],'message':_0x18eb3b(0x1f9)});jsonwebtoken_1[_0x18eb3b(0x1fe)][_0x18eb3b(0x1f4)](_0x178fce,config_1[_0x18eb3b(0x20f)]['jwt']['secret'],(_0x4482a3,_0x38c614)=>{const _0x4bebfe=_0x18eb3b;if(_0x4482a3)return _0x38a535[_0x4bebfe(0x20a)](0x193)['json']({'success':![],'message':_0x4bebfe(0x1f7)});_0x4646ad['user']=_0x38c614,_0x4646ad[_0x4bebfe(0x203)]=_0x178fce,_0x14bfca();});};function a17_0x5b58(){const _0x5d3e68=['tokenBlacklistService','admin','defineProperty','../services/tokenBlacklistService','split','requireAdmin','4469960HtfXmx','2490Dwaclh','187320XTudyv','7840724BofpNK','13527eHInHV','Access\x20token\x20required','3VIZhof','headers','573842leexMR','shop','verify','298434XFcpHi','__esModule','Invalid\x20or\x20expired\x20token','Account\x20is\x20suspended\x20or\x20inactive.\x20Contact\x20administrator\x20to\x20activate\x20your\x20account.','Token\x20has\x20been\x20revoked','4DddYQK','authorization','1079pHhARy','../config/database','default','458484TRqHJT','Error\x20checking\x20account\x20status','Admin\x20access\x20required','jsonwebtoken','token','322UEEaHV','json','requireActiveShop','user','../config/config','role','status','190adFmIQ','error','Error\x20checking\x20account\x20status:','requireShop','config'];a17_0x5b58=function(){return _0x5d3e68;};return a17_0x5b58();}exports['authenticateToken']=authenticateToken;const requireAdmin=(_0x11a724,_0x5ec50b,_0x4db845)=>{const _0x1370e9=a17_0x5cf5f2;if(!_0x11a724['user']||_0x11a724[_0x1370e9(0x207)]['role']!==_0x1370e9(0x211))return _0x5ec50b['status'](0x193)[_0x1370e9(0x205)]({'success':![],'message':_0x1370e9(0x201)});_0x4db845();};exports[a17_0x5cf5f2(0x215)]=requireAdmin;const requireShop=(_0x28a482,_0x3e2646,_0x1166be)=>{const _0x57bc79=a17_0x5cf5f2;if(!_0x28a482['user']||_0x28a482[_0x57bc79(0x207)][_0x57bc79(0x209)]!==_0x57bc79(0x1f3))return _0x3e2646[_0x57bc79(0x20a)](0x193)[_0x57bc79(0x205)]({'success':![],'message':'Shop\x20access\x20required'});_0x1166be();};exports['requireShop']=requireShop;const requireActiveShop=async(_0x2d2a77,_0x291341,_0x54caf7)=>{const _0x5bfea2=a17_0x5cf5f2;if(!_0x2d2a77[_0x5bfea2(0x207)]||_0x2d2a77['user'][_0x5bfea2(0x209)]!==_0x5bfea2(0x1f3))return _0x291341[_0x5bfea2(0x20a)](0x193)['json']({'success':![],'message':'Shop\x20access\x20required'});try{const _0x5c521a=require(_0x5bfea2(0x1fd))['default'],_0x1bb116=await _0x5c521a[_0x5bfea2(0x1f3)]['findUnique']({'where':{'id':_0x2d2a77[_0x5bfea2(0x207)]['id']},'select':{'status':!![]}});if(!_0x1bb116||_0x1bb116['status']!=='ACTIVE')return _0x291341[_0x5bfea2(0x20a)](0x193)[_0x5bfea2(0x205)]({'success':![],'message':_0x5bfea2(0x1f8),'suspended':_0x1bb116?.['status']==='SUSPENDED'});_0x54caf7();}catch(_0x4177e2){return console[_0x5bfea2(0x20c)](_0x5bfea2(0x20d),_0x4177e2),_0x291341[_0x5bfea2(0x20a)](0x1f4)['json']({'success':![],'message':_0x5bfea2(0x200)});}};exports[a17_0x5cf5f2(0x206)]=requireActiveShop;