'use strict';const a16_0x46af2a=a16_0x5d63;function a16_0x7356(){const _0x3757c2=['findUnique','authorization','Error\x20checking\x20account\x20status:','tokenBlacklistService','status','2365188AOvyky','jsonwebtoken','Account\x20is\x20suspended\x20or\x20inactive.\x20Contact\x20administrator\x20to\x20activate\x20your\x20account.','requireActiveShop','Error\x20checking\x20account\x20status','1596UwxqNt','132sYVuIL','role','4500792Sbvjds','../config/database','107885wVlrZA','__importDefault','isTokenBlacklisted','shop','../services/tokenBlacklistService','jwt','1456ByCoUE','20956185tBfyHo','default','SUSPENDED','ACTIVE','verify','Invalid\x20or\x20expired\x20token','requireShop','token','Token\x20has\x20been\x20revoked','user','../config/config','json','1551678AUfoIN','error','Shop\x20access\x20required','__esModule','defineProperty','141545eeUuuS'];a16_0x7356=function(){return _0x3757c2;};return a16_0x7356();}(function(_0xbd22d0,_0x4de834){const _0x173867=a16_0x5d63,_0x287d76=_0xbd22d0();while(!![]){try{const _0x3e9af2=parseInt(_0x173867(0xc8))/0x1+-parseInt(_0x173867(0xb3))/0x2+-parseInt(_0x173867(0xbe))/0x3+parseInt(_0x173867(0xc4))/0x4*(-parseInt(_0x173867(0xb8))/0x5)+-parseInt(_0x173867(0xc3))/0x6*(-parseInt(_0x173867(0xce))/0x7)+parseInt(_0x173867(0xc6))/0x8+parseInt(_0x173867(0xcf))/0x9;if(_0x3e9af2===_0x4de834)break;else _0x287d76['push'](_0x287d76['shift']());}catch(_0x304533){_0x287d76['push'](_0x287d76['shift']());}}}(a16_0x7356,0x87b45));var __importDefault=this&&this[a16_0x46af2a(0xc9)]||function(_0x4ef5fb){const _0x1fdbe5=a16_0x46af2a;return _0x4ef5fb&&_0x4ef5fb[_0x1fdbe5(0xb6)]?_0x4ef5fb:{'default':_0x4ef5fb};};Object[a16_0x46af2a(0xb7)](exports,a16_0x46af2a(0xb6),{'value':!![]}),exports['requireActiveShop']=exports[a16_0x46af2a(0xd5)]=exports['requireAdmin']=exports['authenticateToken']=void 0x0;const jsonwebtoken_1=__importDefault(require(a16_0x46af2a(0xbf))),config_1=require(a16_0x46af2a(0xb1)),tokenBlacklistService_1=require(a16_0x46af2a(0xcc)),authenticateToken=(_0x4a5974,_0x3ecfb5,_0x2ce78a)=>{const _0x2bc529=a16_0x46af2a,_0x3ca1ac=_0x4a5974['headers'][_0x2bc529(0xba)],_0x50a0b8=_0x3ca1ac&&_0x3ca1ac['split']('\x20')[0x1];if(!_0x50a0b8)return _0x3ecfb5[_0x2bc529(0xbd)](0x191)['json']({'success':![],'message':'Access\x20token\x20required'});if(tokenBlacklistService_1[_0x2bc529(0xbc)][_0x2bc529(0xca)](_0x50a0b8))return _0x3ecfb5[_0x2bc529(0xbd)](0x191)['json']({'success':![],'message':_0x2bc529(0xd7)});jsonwebtoken_1[_0x2bc529(0xd0)][_0x2bc529(0xd3)](_0x50a0b8,config_1['config'][_0x2bc529(0xcd)]['secret'],(_0x5020c0,_0x23f7bd)=>{const _0x3c12bb=_0x2bc529;if(_0x5020c0)return _0x3ecfb5[_0x3c12bb(0xbd)](0x193)['json']({'success':![],'message':_0x3c12bb(0xd4)});_0x4a5974['user']=_0x23f7bd,_0x4a5974[_0x3c12bb(0xd6)]=_0x50a0b8,_0x2ce78a();});};exports['authenticateToken']=authenticateToken;const requireAdmin=(_0x245e65,_0x17b57d,_0x4fa462)=>{const _0x57bdf2=a16_0x46af2a;if(!_0x245e65['user']||_0x245e65[_0x57bdf2(0xb0)][_0x57bdf2(0xc5)]!=='admin')return _0x17b57d['status'](0x193)[_0x57bdf2(0xb2)]({'success':![],'message':'Admin\x20access\x20required'});_0x4fa462();};exports['requireAdmin']=requireAdmin;const requireShop=(_0x2ef348,_0x7f141,_0x27f7b6)=>{const _0x125329=a16_0x46af2a;if(!_0x2ef348[_0x125329(0xb0)]||_0x2ef348[_0x125329(0xb0)]['role']!==_0x125329(0xcb))return _0x7f141['status'](0x193)['json']({'success':![],'message':'Shop\x20access\x20required'});_0x27f7b6();};function a16_0x5d63(_0x5c08ae,_0x4ed288){const _0x73565e=a16_0x7356();return a16_0x5d63=function(_0x5d632b,_0x1eb06c){_0x5d632b=_0x5d632b-0xb0;let _0x19adfb=_0x73565e[_0x5d632b];return _0x19adfb;},a16_0x5d63(_0x5c08ae,_0x4ed288);}exports[a16_0x46af2a(0xd5)]=requireShop;const requireActiveShop=async(_0xe8f435,_0x1dea63,_0x2163fa)=>{const _0xf83121=a16_0x46af2a;if(!_0xe8f435[_0xf83121(0xb0)]||_0xe8f435[_0xf83121(0xb0)]['role']!==_0xf83121(0xcb))return _0x1dea63[_0xf83121(0xbd)](0x193)[_0xf83121(0xb2)]({'success':![],'message':_0xf83121(0xb5)});try{const _0x3a85ab=require(_0xf83121(0xc7))[_0xf83121(0xd0)],_0x37a2bd=await _0x3a85ab[_0xf83121(0xcb)][_0xf83121(0xb9)]({'where':{'id':_0xe8f435[_0xf83121(0xb0)]['id']},'select':{'status':!![]}});if(!_0x37a2bd||_0x37a2bd[_0xf83121(0xbd)]!==_0xf83121(0xd2))return _0x1dea63[_0xf83121(0xbd)](0x193)['json']({'success':![],'message':_0xf83121(0xc0),'suspended':_0x37a2bd?.[_0xf83121(0xbd)]===_0xf83121(0xd1)});_0x2163fa();}catch(_0x292de4){return console[_0xf83121(0xb4)](_0xf83121(0xbb),_0x292de4),_0x1dea63[_0xf83121(0xbd)](0x1f4)[_0xf83121(0xb2)]({'success':![],'message':_0xf83121(0xc2)});}};exports[a16_0x46af2a(0xc1)]=requireActiveShop;