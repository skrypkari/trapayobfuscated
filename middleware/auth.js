'use strict';const a18_0x52c377=a18_0x4936;(function(_0x77638e,_0x4e683c){const _0x23a477=a18_0x4936,_0x6e9993=_0x77638e();while(!![]){try{const _0x426851=parseInt(_0x23a477(0x1ab))/0x1+-parseInt(_0x23a477(0x199))/0x2*(-parseInt(_0x23a477(0x18c))/0x3)+-parseInt(_0x23a477(0x1a8))/0x4+parseInt(_0x23a477(0x1a7))/0x5*(parseInt(_0x23a477(0x18e))/0x6)+-parseInt(_0x23a477(0x1b0))/0x7*(parseInt(_0x23a477(0x19b))/0x8)+parseInt(_0x23a477(0x1b4))/0x9+parseInt(_0x23a477(0x190))/0xa*(-parseInt(_0x23a477(0x1a6))/0xb);if(_0x426851===_0x4e683c)break;else _0x6e9993['push'](_0x6e9993['shift']());}catch(_0x4f2a33){_0x6e9993['push'](_0x6e9993['shift']());}}}(a18_0x5e60,0x4ecf2));var __importDefault=this&&this[a18_0x52c377(0x1b1)]||function(_0x2cc8b9){const _0x4fe092=a18_0x52c377;return _0x2cc8b9&&_0x2cc8b9[_0x4fe092(0x1a4)]?_0x2cc8b9:{'default':_0x2cc8b9};};Object[a18_0x52c377(0x19e)](exports,a18_0x52c377(0x1a4),{'value':!![]}),exports[a18_0x52c377(0x1af)]=exports[a18_0x52c377(0x1a0)]=exports['requireAdmin']=exports[a18_0x52c377(0x1a2)]=void 0x0;const jsonwebtoken_1=__importDefault(require(a18_0x52c377(0x19f))),config_1=require(a18_0x52c377(0x19a)),tokenBlacklistService_1=require('../services/tokenBlacklistService'),authenticateToken=(_0x2f739b,_0x2eefcd,_0x67edd)=>{const _0x1be4d8=a18_0x52c377,_0x357392=_0x2f739b[_0x1be4d8(0x1b3)][_0x1be4d8(0x1b2)],_0x2ed32f=_0x357392&&_0x357392[_0x1be4d8(0x192)]('\x20')[0x1];if(!_0x2ed32f)return _0x2eefcd[_0x1be4d8(0x1aa)](0x191)['json']({'success':![],'message':_0x1be4d8(0x191)});if(tokenBlacklistService_1[_0x1be4d8(0x18d)]['isTokenBlacklisted'](_0x2ed32f))return _0x2eefcd[_0x1be4d8(0x1aa)](0x191)[_0x1be4d8(0x1ad)]({'success':![],'message':_0x1be4d8(0x1ae)});jsonwebtoken_1['default'][_0x1be4d8(0x19d)](_0x2ed32f,config_1['config']['jwt'][_0x1be4d8(0x19c)],(_0xaaadbd,_0x38d3b9)=>{const _0x541278=_0x1be4d8;if(_0xaaadbd)return _0x2eefcd[_0x541278(0x1aa)](0x193)[_0x541278(0x1ad)]({'success':![],'message':_0x541278(0x1a1)});_0x2f739b[_0x541278(0x196)]=_0x38d3b9,_0x2f739b[_0x541278(0x195)]=_0x2ed32f,_0x67edd();});};function a18_0x5e60(){const _0x5cd4e2=['Admin\x20access\x20required','1630TbnWbn','../config/config','508184qHBoMO','secret','verify','defineProperty','jsonwebtoken','requireShop','Invalid\x20or\x20expired\x20token','authenticateToken','Account\x20is\x20suspended\x20or\x20inactive.\x20Contact\x20administrator\x20to\x20activate\x20your\x20account.','__esModule','../config/database','110YGBLUw','1390kuUpuz','1208596AUNgLp','Shop\x20access\x20required','status','609757ayeSzn','shop','json','Token\x20has\x20been\x20revoked','requireActiveShop','42EgccSs','__importDefault','authorization','headers','5724909VLUEni','723htCiVY','tokenBlacklistService','8862JBoRRe','default','846790kuSIyL','Access\x20token\x20required','split','role','requireAdmin','token','user','Error\x20checking\x20account\x20status:'];a18_0x5e60=function(){return _0x5cd4e2;};return a18_0x5e60();}exports[a18_0x52c377(0x1a2)]=authenticateToken;const requireAdmin=(_0x34f3e9,_0x5c9468,_0x2b7a5b)=>{const _0x2ce96d=a18_0x52c377;if(!_0x34f3e9[_0x2ce96d(0x196)]||_0x34f3e9['user']['role']!=='admin')return _0x5c9468[_0x2ce96d(0x1aa)](0x193)[_0x2ce96d(0x1ad)]({'success':![],'message':_0x2ce96d(0x198)});_0x2b7a5b();};function a18_0x4936(_0x3581ac,_0x2cfe85){const _0x5e60cb=a18_0x5e60();return a18_0x4936=function(_0x4936a7,_0x49bcc6){_0x4936a7=_0x4936a7-0x18c;let _0x5c66a5=_0x5e60cb[_0x4936a7];return _0x5c66a5;},a18_0x4936(_0x3581ac,_0x2cfe85);}exports[a18_0x52c377(0x194)]=requireAdmin;const requireShop=(_0x6ba0da,_0x4ba277,_0x2afd3e)=>{const _0x36fd8c=a18_0x52c377;if(!_0x6ba0da[_0x36fd8c(0x196)]||_0x6ba0da[_0x36fd8c(0x196)][_0x36fd8c(0x193)]!==_0x36fd8c(0x1ac))return _0x4ba277['status'](0x193)['json']({'success':![],'message':_0x36fd8c(0x1a9)});_0x2afd3e();};exports['requireShop']=requireShop;const requireActiveShop=async(_0x1431ac,_0x5a313d,_0x50e56c)=>{const _0x33b554=a18_0x52c377;if(!_0x1431ac[_0x33b554(0x196)]||_0x1431ac[_0x33b554(0x196)][_0x33b554(0x193)]!==_0x33b554(0x1ac))return _0x5a313d[_0x33b554(0x1aa)](0x193)[_0x33b554(0x1ad)]({'success':![],'message':'Shop\x20access\x20required'});try{const _0x3f9b76=require(_0x33b554(0x1a5))[_0x33b554(0x18f)],_0x1a903e=await _0x3f9b76[_0x33b554(0x1ac)]['findUnique']({'where':{'id':_0x1431ac['user']['id']},'select':{'status':!![]}});if(!_0x1a903e||_0x1a903e[_0x33b554(0x1aa)]!=='ACTIVE')return _0x5a313d['status'](0x193)['json']({'success':![],'message':_0x33b554(0x1a3),'suspended':_0x1a903e?.[_0x33b554(0x1aa)]==='SUSPENDED'});_0x50e56c();}catch(_0x3abdf9){return console['error'](_0x33b554(0x197),_0x3abdf9),_0x5a313d[_0x33b554(0x1aa)](0x1f4)[_0x33b554(0x1ad)]({'success':![],'message':'Error\x20checking\x20account\x20status'});}};exports[a18_0x52c377(0x1af)]=requireActiveShop;