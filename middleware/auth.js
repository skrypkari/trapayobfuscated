'use strict';const a16_0x2910a5=a16_0x397c;function a16_0x397c(_0x192a9c,_0x4931ef){const _0x45ef4f=a16_0x45ef();return a16_0x397c=function(_0x397ce1,_0x3d330d){_0x397ce1=_0x397ce1-0x158;let _0x2f3d23=_0x45ef4f[_0x397ce1];return _0x2f3d23;},a16_0x397c(_0x192a9c,_0x4931ef);}(function(_0x1d48a8,_0x5ab011){const _0x3c767a=a16_0x397c,_0x5ccc08=_0x1d48a8();while(!![]){try{const _0x27e984=-parseInt(_0x3c767a(0x168))/0x1+-parseInt(_0x3c767a(0x16d))/0x2+parseInt(_0x3c767a(0x16e))/0x3*(parseInt(_0x3c767a(0x172))/0x4)+parseInt(_0x3c767a(0x166))/0x5+-parseInt(_0x3c767a(0x15a))/0x6+parseInt(_0x3c767a(0x173))/0x7+parseInt(_0x3c767a(0x165))/0x8*(-parseInt(_0x3c767a(0x162))/0x9);if(_0x27e984===_0x5ab011)break;else _0x5ccc08['push'](_0x5ccc08['shift']());}catch(_0x2251da){_0x5ccc08['push'](_0x5ccc08['shift']());}}}(a16_0x45ef,0x4b55c));function a16_0x45ef(){const _0x47047a=['json','isTokenBlacklisted','__esModule','user','../services/tokenBlacklistService','Access\x20token\x20required','18MNYfcQ','headers','tokenBlacklistService','57312wqYXqP','1694070JkeRHc','jwt','235647ziQpIF','status','split','Token\x20has\x20been\x20revoked','requireShop','204846tFdDMr','1363827VSJISw','authenticateToken','default','__importDefault','4hfAgMY','2627198RiQCKy','defineProperty','role','../config/config','authorization','requireAdmin','3046602bhIDWe','shop'];a16_0x45ef=function(){return _0x47047a;};return a16_0x45ef();}var __importDefault=this&&this[a16_0x2910a5(0x171)]||function(_0x3bb853){const _0x2c2c77=a16_0x2910a5;return _0x3bb853&&_0x3bb853[_0x2c2c77(0x15e)]?_0x3bb853:{'default':_0x3bb853};};Object[a16_0x2910a5(0x174)](exports,a16_0x2910a5(0x15e),{'value':!![]}),exports[a16_0x2910a5(0x16c)]=exports[a16_0x2910a5(0x159)]=exports[a16_0x2910a5(0x16f)]=void 0x0;const jsonwebtoken_1=__importDefault(require('jsonwebtoken')),config_1=require(a16_0x2910a5(0x176)),tokenBlacklistService_1=require(a16_0x2910a5(0x160)),authenticateToken=(_0x142aa9,_0x237adc,_0x3a0cec)=>{const _0xa3765d=a16_0x2910a5,_0x33097f=_0x142aa9[_0xa3765d(0x163)][_0xa3765d(0x158)],_0x263a31=_0x33097f&&_0x33097f[_0xa3765d(0x16a)]('\x20')[0x1];if(!_0x263a31)return _0x237adc[_0xa3765d(0x169)](0x191)[_0xa3765d(0x15c)]({'success':![],'message':_0xa3765d(0x161)});if(tokenBlacklistService_1[_0xa3765d(0x164)][_0xa3765d(0x15d)](_0x263a31))return _0x237adc['status'](0x191)[_0xa3765d(0x15c)]({'success':![],'message':_0xa3765d(0x16b)});jsonwebtoken_1[_0xa3765d(0x170)]['verify'](_0x263a31,config_1['config'][_0xa3765d(0x167)]['secret'],(_0x4e6724,_0x55a8a1)=>{const _0x34097e=_0xa3765d;if(_0x4e6724)return _0x237adc[_0x34097e(0x169)](0x193)[_0x34097e(0x15c)]({'success':![],'message':'Invalid\x20or\x20expired\x20token'});_0x142aa9[_0x34097e(0x15f)]=_0x55a8a1,_0x142aa9['token']=_0x263a31,_0x3a0cec();});};exports['authenticateToken']=authenticateToken;const requireAdmin=(_0x34025a,_0x1da7af,_0x45e576)=>{const _0x39ab2e=a16_0x2910a5;if(!_0x34025a[_0x39ab2e(0x15f)]||_0x34025a[_0x39ab2e(0x15f)]['role']!=='admin')return _0x1da7af[_0x39ab2e(0x169)](0x193)['json']({'success':![],'message':'Admin\x20access\x20required'});_0x45e576();};exports[a16_0x2910a5(0x159)]=requireAdmin;const requireShop=(_0x2c5be4,_0x34623b,_0x559996)=>{const _0x3cde87=a16_0x2910a5;if(!_0x2c5be4[_0x3cde87(0x15f)]||_0x2c5be4[_0x3cde87(0x15f)][_0x3cde87(0x175)]!==_0x3cde87(0x15b))return _0x34623b[_0x3cde87(0x169)](0x193)[_0x3cde87(0x15c)]({'success':![],'message':'Shop\x20access\x20required'});_0x559996();};exports['requireShop']=requireShop;