'use strict';const a21_0x153f20=a21_0xec9c;(function(_0x2a12d9,_0x25561f){const _0x4bcd3b=a21_0xec9c,_0x1bd5f1=_0x2a12d9();while(!![]){try{const _0x43cc92=parseInt(_0x4bcd3b(0x18c))/0x1+-parseInt(_0x4bcd3b(0x185))/0x2+parseInt(_0x4bcd3b(0x194))/0x3*(-parseInt(_0x4bcd3b(0x1a2))/0x4)+parseInt(_0x4bcd3b(0x18e))/0x5*(-parseInt(_0x4bcd3b(0x19e))/0x6)+-parseInt(_0x4bcd3b(0x182))/0x7*(-parseInt(_0x4bcd3b(0x197))/0x8)+-parseInt(_0x4bcd3b(0x196))/0x9*(-parseInt(_0x4bcd3b(0x18d))/0xa)+-parseInt(_0x4bcd3b(0x192))/0xb;if(_0x43cc92===_0x25561f)break;else _0x1bd5f1['push'](_0x1bd5f1['shift']());}catch(_0x4d42f6){_0x1bd5f1['push'](_0x1bd5f1['shift']());}}}(a21_0x16b3,0xbabf6));var __importDefault=this&&this['__importDefault']||function(_0x120299){return _0x120299&&_0x120299['__esModule']?_0x120299:{'default':_0x120299};};Object['defineProperty'](exports,a21_0x153f20(0x1a4),{'value':!![]}),exports[a21_0x153f20(0x181)]=exports[a21_0x153f20(0x19b)]=exports[a21_0x153f20(0x1a0)]=exports[a21_0x153f20(0x184)]=void 0x0;const jsonwebtoken_1=__importDefault(require(a21_0x153f20(0x1a5))),config_1=require('../config/config'),tokenBlacklistService_1=require('../services/tokenBlacklistService'),authenticateToken=(_0x41e952,_0x13e709,_0x3f9d8e)=>{const _0x1a360b=a21_0x153f20,_0x15b19f=_0x41e952['headers'][_0x1a360b(0x190)],_0x5c643e=_0x15b19f&&_0x15b19f[_0x1a360b(0x188)]('\x20')[0x1];if(!_0x5c643e)return _0x13e709[_0x1a360b(0x189)](0x191)[_0x1a360b(0x1a1)]({'success':![],'message':_0x1a360b(0x195)});if(tokenBlacklistService_1[_0x1a360b(0x186)]['isTokenBlacklisted'](_0x5c643e))return _0x13e709['status'](0x191)[_0x1a360b(0x1a1)]({'success':![],'message':'Token\x20has\x20been\x20revoked'});jsonwebtoken_1['default'][_0x1a360b(0x180)](_0x5c643e,config_1['config'][_0x1a360b(0x191)][_0x1a360b(0x18b)],(_0x4f2a50,_0x3e1653)=>{const _0x5113d9=_0x1a360b;if(_0x4f2a50)return _0x13e709[_0x5113d9(0x189)](0x193)[_0x5113d9(0x1a1)]({'success':![],'message':_0x5113d9(0x18a)});_0x41e952[_0x5113d9(0x19d)]=_0x3e1653,_0x41e952[_0x5113d9(0x19a)]=_0x5c643e,_0x3f9d8e();});};exports[a21_0x153f20(0x184)]=authenticateToken;const requireAdmin=(_0x363c13,_0x2b573d,_0x5a966b)=>{const _0x1683d2=a21_0x153f20;if(!_0x363c13[_0x1683d2(0x19d)]||_0x363c13['user'][_0x1683d2(0x18f)]!==_0x1683d2(0x193))return _0x2b573d[_0x1683d2(0x189)](0x193)[_0x1683d2(0x1a1)]({'success':![],'message':_0x1683d2(0x187)});_0x5a966b();};function a21_0xec9c(_0x5bb7d0,_0x2d8919){_0x5bb7d0=_0x5bb7d0-0x180;const _0x16b339=a21_0x16b3();let _0xec9c55=_0x16b339[_0x5bb7d0];return _0xec9c55;}exports[a21_0x153f20(0x1a0)]=requireAdmin;function a21_0x16b3(){const _0x52e465=['4joRZWe','Error\x20checking\x20account\x20status','__esModule','jsonwebtoken','verify','requireActiveShop','490OfUqSU','shop','authenticateToken','2474180XyWTDP','tokenBlacklistService','Admin\x20access\x20required','split','status','Invalid\x20or\x20expired\x20token','secret','945608BvyXLf','7469650xRemtW','265BmkorX','role','authorization','jwt','3800709JHGswB','admin','2383146hzDReV','Access\x20token\x20required','18TnogDo','87800EbfjjR','Account\x20is\x20suspended\x20or\x20inactive.\x20Contact\x20administrator\x20to\x20activate\x20your\x20account.','default','token','requireShop','Error\x20checking\x20account\x20status:','user','7458XiHYYY','Shop\x20access\x20required','requireAdmin','json'];a21_0x16b3=function(){return _0x52e465;};return a21_0x16b3();}const requireShop=(_0x1d7b08,_0x559b89,_0x163ebf)=>{const _0x5baf04=a21_0x153f20;if(!_0x1d7b08[_0x5baf04(0x19d)]||_0x1d7b08[_0x5baf04(0x19d)][_0x5baf04(0x18f)]!==_0x5baf04(0x183))return _0x559b89[_0x5baf04(0x189)](0x193)['json']({'success':![],'message':_0x5baf04(0x19f)});_0x163ebf();};exports['requireShop']=requireShop;const requireActiveShop=async(_0x10d90f,_0x268438,_0xf7581)=>{const _0x167528=a21_0x153f20;if(!_0x10d90f[_0x167528(0x19d)]||_0x10d90f[_0x167528(0x19d)][_0x167528(0x18f)]!==_0x167528(0x183))return _0x268438[_0x167528(0x189)](0x193)['json']({'success':![],'message':_0x167528(0x19f)});try{const _0x52406f=require('../config/database')[_0x167528(0x199)],_0x2d3522=await _0x52406f[_0x167528(0x183)]['findUnique']({'where':{'id':_0x10d90f[_0x167528(0x19d)]['id']},'select':{'status':!![]}});if(!_0x2d3522||_0x2d3522[_0x167528(0x189)]!=='ACTIVE')return _0x268438[_0x167528(0x189)](0x193)[_0x167528(0x1a1)]({'success':![],'message':_0x167528(0x198),'suspended':_0x2d3522?.['status']==='SUSPENDED'});_0xf7581();}catch(_0x4783bd){return console['error'](_0x167528(0x19c),_0x4783bd),_0x268438[_0x167528(0x189)](0x1f4)['json']({'success':![],'message':_0x167528(0x1a3)});}};exports['requireActiveShop']=requireActiveShop;