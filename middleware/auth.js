'use strict';const a24_0x18f032=a24_0x12ce;(function(_0x7abc4,_0xc30d0b){const _0xcbcb25=a24_0x12ce,_0x7fc41b=_0x7abc4();while(!![]){try{const _0x18269a=parseInt(_0xcbcb25(0x8e))/0x1+parseInt(_0xcbcb25(0xa3))/0x2+-parseInt(_0xcbcb25(0x93))/0x3+parseInt(_0xcbcb25(0xa2))/0x4+-parseInt(_0xcbcb25(0x9e))/0x5*(parseInt(_0xcbcb25(0x96))/0x6)+parseInt(_0xcbcb25(0xb4))/0x7+-parseInt(_0xcbcb25(0xb2))/0x8;if(_0x18269a===_0xc30d0b)break;else _0x7fc41b['push'](_0x7fc41b['shift']());}catch(_0x72b2f1){_0x7fc41b['push'](_0x7fc41b['shift']());}}}(a24_0x2b82,0x30b7a));function a24_0x12ce(_0x18042,_0x27832f){_0x18042=_0x18042-0x8e;const _0x2b82ef=a24_0x2b82();let _0x12cedf=_0x2b82ef[_0x18042];return _0x12cedf;}var __importDefault=this&&this['__importDefault']||function(_0x279784){const _0x314eed=a24_0x12ce;return _0x279784&&_0x279784[_0x314eed(0xb1)]?_0x279784:{'default':_0x279784};};Object[a24_0x18f032(0xa0)](exports,'__esModule',{'value':!![]}),exports[a24_0x18f032(0x9a)]=exports[a24_0x18f032(0x90)]=exports[a24_0x18f032(0xa6)]=exports[a24_0x18f032(0x92)]=void 0x0;const jsonwebtoken_1=__importDefault(require(a24_0x18f032(0xaa))),config_1=require(a24_0x18f032(0xa4)),tokenBlacklistService_1=require('../services/tokenBlacklistService'),authenticateToken=(_0x101323,_0x32d550,_0x2af412)=>{const _0x2aacb9=a24_0x18f032,_0x251ffa=_0x101323[_0x2aacb9(0x98)]['authorization'],_0x369701=_0x251ffa&&_0x251ffa[_0x2aacb9(0xa7)]('\x20')[0x1];if(!_0x369701)return _0x32d550[_0x2aacb9(0x9f)](0x191)[_0x2aacb9(0x8f)]({'success':![],'message':_0x2aacb9(0xa8)});if(tokenBlacklistService_1['tokenBlacklistService'][_0x2aacb9(0x99)](_0x369701))return _0x32d550[_0x2aacb9(0x9f)](0x191)[_0x2aacb9(0x8f)]({'success':![],'message':_0x2aacb9(0xad)});jsonwebtoken_1['default'][_0x2aacb9(0x91)](_0x369701,config_1['config'][_0x2aacb9(0x94)][_0x2aacb9(0xaf)],(_0x4a23a6,_0x49ea83)=>{const _0x10d82a=_0x2aacb9;if(_0x4a23a6)return _0x32d550[_0x10d82a(0x9f)](0x193)[_0x10d82a(0x8f)]({'success':![],'message':_0x10d82a(0xa5)});_0x101323[_0x10d82a(0x9b)]=_0x49ea83,_0x101323[_0x10d82a(0x95)]=_0x369701,_0x2af412();});};exports[a24_0x18f032(0x92)]=authenticateToken;const requireAdmin=(_0x46ac28,_0x5869a7,_0x3e897b)=>{const _0x404f21=a24_0x18f032;if(!_0x46ac28[_0x404f21(0x9b)]||_0x46ac28[_0x404f21(0x9b)][_0x404f21(0x97)]!=='admin')return _0x5869a7['status'](0x193)[_0x404f21(0x8f)]({'success':![],'message':_0x404f21(0xb0)});_0x3e897b();};exports[a24_0x18f032(0xa6)]=requireAdmin;const requireShop=(_0x29fc8e,_0x49f999,_0x4131aa)=>{const _0x4d9ee1=a24_0x18f032;if(!_0x29fc8e[_0x4d9ee1(0x9b)]||_0x29fc8e[_0x4d9ee1(0x9b)][_0x4d9ee1(0x97)]!==_0x4d9ee1(0xb5))return _0x49f999[_0x4d9ee1(0x9f)](0x193)[_0x4d9ee1(0x8f)]({'success':![],'message':'Shop\x20access\x20required'});_0x4131aa();};exports[a24_0x18f032(0x90)]=requireShop;const requireActiveShop=async(_0x136b29,_0x353997,_0x4214fd)=>{const _0x47af8e=a24_0x18f032;if(!_0x136b29[_0x47af8e(0x9b)]||_0x136b29['user'][_0x47af8e(0x97)]!=='shop')return _0x353997['status'](0x193)['json']({'success':![],'message':_0x47af8e(0xa9)});try{const _0x31776c=require(_0x47af8e(0xb3))[_0x47af8e(0xae)],_0x4c9108=await _0x31776c[_0x47af8e(0xb5)][_0x47af8e(0xac)]({'where':{'id':_0x136b29['user']['id']},'select':{'status':!![]}});if(!_0x4c9108||_0x4c9108[_0x47af8e(0x9f)]!=='ACTIVE')return _0x353997['status'](0x193)[_0x47af8e(0x8f)]({'success':![],'message':_0x47af8e(0x9c),'suspended':_0x4c9108?.[_0x47af8e(0x9f)]===_0x47af8e(0x9d)});_0x4214fd();}catch(_0x13f1a5){return console[_0x47af8e(0xab)](_0x47af8e(0xa1),_0x13f1a5),_0x353997[_0x47af8e(0x9f)](0x1f4)[_0x47af8e(0x8f)]({'success':![],'message':'Error\x20checking\x20account\x20status'});}};function a24_0x2b82(){const _0x11b68f=['secret','Admin\x20access\x20required','__esModule','736520snzfFR','../config/database','2762991mAsbGe','shop','100828rCZgJw','json','requireShop','verify','authenticateToken','539928HqLDal','jwt','token','1194UOMtSD','role','headers','isTokenBlacklisted','requireActiveShop','user','Account\x20is\x20suspended\x20or\x20inactive.\x20Contact\x20administrator\x20to\x20activate\x20your\x20account.','SUSPENDED','9665yGJlyT','status','defineProperty','Error\x20checking\x20account\x20status:','893704WHXREY','274574LtJjtD','../config/config','Invalid\x20or\x20expired\x20token','requireAdmin','split','Access\x20token\x20required','Shop\x20access\x20required','jsonwebtoken','error','findUnique','Token\x20has\x20been\x20revoked','default'];a24_0x2b82=function(){return _0x11b68f;};return a24_0x2b82();}exports[a24_0x18f032(0x9a)]=requireActiveShop;