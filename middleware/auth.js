'use strict';const a16_0x10b9fe=a16_0x1eac;(function(_0xcaf9b6,_0x1db6b1){const _0x20ee24=a16_0x1eac,_0x5a3c55=_0xcaf9b6();while(!![]){try{const _0x5a93de=-parseInt(_0x20ee24(0x158))/0x1+-parseInt(_0x20ee24(0x172))/0x2*(parseInt(_0x20ee24(0x157))/0x3)+-parseInt(_0x20ee24(0x174))/0x4*(-parseInt(_0x20ee24(0x177))/0x5)+-parseInt(_0x20ee24(0x14e))/0x6+-parseInt(_0x20ee24(0x165))/0x7*(parseInt(_0x20ee24(0x156))/0x8)+-parseInt(_0x20ee24(0x153))/0x9+parseInt(_0x20ee24(0x164))/0xa;if(_0x5a93de===_0x1db6b1)break;else _0x5a3c55['push'](_0x5a3c55['shift']());}catch(_0x1bd3a5){_0x5a3c55['push'](_0x5a3c55['shift']());}}}(a16_0x383b,0x4b9cb));var __importDefault=this&&this[a16_0x10b9fe(0x14f)]||function(_0x31f290){return _0x31f290&&_0x31f290['__esModule']?_0x31f290:{'default':_0x31f290};};function a16_0x1eac(_0xf8dde4,_0x1bda40){const _0x383b67=a16_0x383b();return a16_0x1eac=function(_0x1eac1d,_0x37ff5c){_0x1eac1d=_0x1eac1d-0x14e;let _0x2cd20f=_0x383b67[_0x1eac1d];return _0x2cd20f;},a16_0x1eac(_0xf8dde4,_0x1bda40);}Object[a16_0x10b9fe(0x159)](exports,'__esModule',{'value':!![]}),exports['requireActiveShop']=exports[a16_0x10b9fe(0x162)]=exports[a16_0x10b9fe(0x168)]=exports['authenticateToken']=void 0x0;function a16_0x383b(){const _0x995241=['4ReNkTo','Error\x20checking\x20account\x20status','Error\x20checking\x20account\x20status:','73805jicIXn','ACTIVE','2139864QnygIB','__importDefault','authorization','../services/tokenBlacklistService','role','5525766GEBITF','SUSPENDED','requireActiveShop','15344ulcHWX','45TAGHyg','522502mTLoTT','defineProperty','default','authenticateToken','shop','error','tokenBlacklistService','Shop\x20access\x20required','jwt','status','requireShop','../config/config','23338430DxXCdp','1988EOyaXE','jsonwebtoken','json','requireAdmin','config','user','Account\x20is\x20suspended\x20or\x20inactive.\x20Contact\x20administrator\x20to\x20activate\x20your\x20account.','Invalid\x20or\x20expired\x20token','verify','split','Admin\x20access\x20required','Access\x20token\x20required','Token\x20has\x20been\x20revoked','142plwtYC','../config/database'];a16_0x383b=function(){return _0x995241;};return a16_0x383b();}const jsonwebtoken_1=__importDefault(require(a16_0x10b9fe(0x166))),config_1=require(a16_0x10b9fe(0x163)),tokenBlacklistService_1=require(a16_0x10b9fe(0x151)),authenticateToken=(_0x58c133,_0x1367d6,_0x34596e)=>{const _0x57049c=a16_0x10b9fe,_0x226370=_0x58c133['headers'][_0x57049c(0x150)],_0x533d41=_0x226370&&_0x226370[_0x57049c(0x16e)]('\x20')[0x1];if(!_0x533d41)return _0x1367d6[_0x57049c(0x161)](0x191)[_0x57049c(0x167)]({'success':![],'message':_0x57049c(0x170)});if(tokenBlacklistService_1[_0x57049c(0x15e)]['isTokenBlacklisted'](_0x533d41))return _0x1367d6[_0x57049c(0x161)](0x191)[_0x57049c(0x167)]({'success':![],'message':_0x57049c(0x171)});jsonwebtoken_1[_0x57049c(0x15a)][_0x57049c(0x16d)](_0x533d41,config_1[_0x57049c(0x169)][_0x57049c(0x160)]['secret'],(_0x484a47,_0x3aaa4f)=>{const _0x46a020=_0x57049c;if(_0x484a47)return _0x1367d6[_0x46a020(0x161)](0x193)[_0x46a020(0x167)]({'success':![],'message':_0x46a020(0x16c)});_0x58c133['user']=_0x3aaa4f,_0x58c133['token']=_0x533d41,_0x34596e();});};exports[a16_0x10b9fe(0x15b)]=authenticateToken;const requireAdmin=(_0x1958c5,_0x3d8855,_0x125b5d)=>{const _0x4eedba=a16_0x10b9fe;if(!_0x1958c5[_0x4eedba(0x16a)]||_0x1958c5['user'][_0x4eedba(0x152)]!=='admin')return _0x3d8855[_0x4eedba(0x161)](0x193)[_0x4eedba(0x167)]({'success':![],'message':_0x4eedba(0x16f)});_0x125b5d();};exports['requireAdmin']=requireAdmin;const requireShop=(_0x372f3c,_0x104241,_0x23ce5b)=>{const _0x256bce=a16_0x10b9fe;if(!_0x372f3c[_0x256bce(0x16a)]||_0x372f3c[_0x256bce(0x16a)][_0x256bce(0x152)]!==_0x256bce(0x15c))return _0x104241[_0x256bce(0x161)](0x193)[_0x256bce(0x167)]({'success':![],'message':_0x256bce(0x15f)});_0x23ce5b();};exports[a16_0x10b9fe(0x162)]=requireShop;const requireActiveShop=async(_0x487a92,_0x171dff,_0x8fcd2c)=>{const _0xcc5f82=a16_0x10b9fe;if(!_0x487a92[_0xcc5f82(0x16a)]||_0x487a92['user'][_0xcc5f82(0x152)]!=='shop')return _0x171dff['status'](0x193)['json']({'success':![],'message':_0xcc5f82(0x15f)});try{const _0x216dde=require(_0xcc5f82(0x173))[_0xcc5f82(0x15a)],_0x295608=await _0x216dde[_0xcc5f82(0x15c)]['findUnique']({'where':{'id':_0x487a92[_0xcc5f82(0x16a)]['id']},'select':{'status':!![]}});if(!_0x295608||_0x295608[_0xcc5f82(0x161)]!==_0xcc5f82(0x178))return _0x171dff[_0xcc5f82(0x161)](0x193)[_0xcc5f82(0x167)]({'success':![],'message':_0xcc5f82(0x16b),'suspended':_0x295608?.[_0xcc5f82(0x161)]===_0xcc5f82(0x154)});_0x8fcd2c();}catch(_0x465274){return console[_0xcc5f82(0x15d)](_0xcc5f82(0x176),_0x465274),_0x171dff[_0xcc5f82(0x161)](0x1f4)[_0xcc5f82(0x167)]({'success':![],'message':_0xcc5f82(0x175)});}};exports[a16_0x10b9fe(0x155)]=requireActiveShop;