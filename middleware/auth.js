'use strict';const a21_0x1adf02=a21_0x2e29;(function(_0x24bfee,_0x54cfa2){const _0x4a232b=a21_0x2e29,_0x2ce9a4=_0x24bfee();while(!![]){try{const _0x24f47d=parseInt(_0x4a232b(0x1a3))/0x1+parseInt(_0x4a232b(0x1a6))/0x2*(-parseInt(_0x4a232b(0x1bb))/0x3)+-parseInt(_0x4a232b(0x1ad))/0x4+parseInt(_0x4a232b(0x1b3))/0x5+-parseInt(_0x4a232b(0x1be))/0x6+-parseInt(_0x4a232b(0x19f))/0x7*(parseInt(_0x4a232b(0x1a9))/0x8)+parseInt(_0x4a232b(0x1b6))/0x9;if(_0x24f47d===_0x54cfa2)break;else _0x2ce9a4['push'](_0x2ce9a4['shift']());}catch(_0x1c82f9){_0x2ce9a4['push'](_0x2ce9a4['shift']());}}}(a21_0x5455,0xc9ab4));function a21_0x2e29(_0x57317d,_0x36920e){_0x57317d=_0x57317d-0x19e;const _0x54556c=a21_0x5455();let _0x2e29d9=_0x54556c[_0x57317d];return _0x2e29d9;}var __importDefault=this&&this['__importDefault']||function(_0x2e21a7){const _0x15812b=a21_0x2e29;return _0x2e21a7&&_0x2e21a7[_0x15812b(0x1a7)]?_0x2e21a7:{'default':_0x2e21a7};};Object[a21_0x1adf02(0x1b1)](exports,'__esModule',{'value':!![]}),exports[a21_0x1adf02(0x1b8)]=exports['requireShop']=exports[a21_0x1adf02(0x1bd)]=exports[a21_0x1adf02(0x1c2)]=void 0x0;const jsonwebtoken_1=__importDefault(require(a21_0x1adf02(0x1a0))),config_1=require('../config/config'),tokenBlacklistService_1=require(a21_0x1adf02(0x1b2)),authenticateToken=(_0x304de3,_0x3ee8ed,_0x27afa3)=>{const _0x117cde=a21_0x1adf02,_0x88f51c=_0x304de3[_0x117cde(0x1c4)][_0x117cde(0x1c3)],_0x19f19a=_0x88f51c&&_0x88f51c[_0x117cde(0x1a2)]('\x20')[0x1];if(!_0x19f19a)return _0x3ee8ed[_0x117cde(0x1ba)](0x191)['json']({'success':![],'message':_0x117cde(0x1b5)});if(tokenBlacklistService_1[_0x117cde(0x1c5)][_0x117cde(0x1c1)](_0x19f19a))return _0x3ee8ed['status'](0x191)['json']({'success':![],'message':_0x117cde(0x1b9)});jsonwebtoken_1[_0x117cde(0x1bc)][_0x117cde(0x1a1)](_0x19f19a,config_1[_0x117cde(0x1aa)]['jwt'][_0x117cde(0x1bf)],(_0x5d559c,_0x1400fe)=>{const _0x1643df=_0x117cde;if(_0x5d559c)return _0x3ee8ed[_0x1643df(0x1ba)](0x193)[_0x1643df(0x1a8)]({'success':![],'message':_0x1643df(0x1af)});_0x304de3[_0x1643df(0x19e)]=_0x1400fe,_0x304de3[_0x1643df(0x1c0)]=_0x19f19a,_0x27afa3();});};exports[a21_0x1adf02(0x1c2)]=authenticateToken;const requireAdmin=(_0x37c734,_0xd5a9c6,_0x145b49)=>{const _0x546918=a21_0x1adf02;if(!_0x37c734[_0x546918(0x19e)]||_0x37c734[_0x546918(0x19e)][_0x546918(0x1a4)]!=='admin')return _0xd5a9c6['status'](0x193)[_0x546918(0x1a8)]({'success':![],'message':_0x546918(0x1b0)});_0x145b49();};function a21_0x5455(){const _0x3dd477=['json','651416CDiLhR','config','Account\x20is\x20suspended\x20or\x20inactive.\x20Contact\x20administrator\x20to\x20activate\x20your\x20account.','Shop\x20access\x20required','4663636YGWZjP','ACTIVE','Invalid\x20or\x20expired\x20token','Admin\x20access\x20required','defineProperty','../services/tokenBlacklistService','5605965fYbKxG','shop','Access\x20token\x20required','22442832AUvKru','../config/database','requireActiveShop','Token\x20has\x20been\x20revoked','status','66SwATIT','default','requireAdmin','9882666lDUODh','secret','token','isTokenBlacklisted','authenticateToken','authorization','headers','tokenBlacklistService','requireShop','user','98nUjiFT','jsonwebtoken','verify','split','1518107QWOdAm','role','findUnique','32174hQwYWD','__esModule'];a21_0x5455=function(){return _0x3dd477;};return a21_0x5455();}exports[a21_0x1adf02(0x1bd)]=requireAdmin;const requireShop=(_0x21f828,_0x4cca25,_0x5421b2)=>{const _0x5e7db0=a21_0x1adf02;if(!_0x21f828[_0x5e7db0(0x19e)]||_0x21f828[_0x5e7db0(0x19e)][_0x5e7db0(0x1a4)]!=='shop')return _0x4cca25[_0x5e7db0(0x1ba)](0x193)[_0x5e7db0(0x1a8)]({'success':![],'message':_0x5e7db0(0x1ac)});_0x5421b2();};exports[a21_0x1adf02(0x1c6)]=requireShop;const requireActiveShop=async(_0x50a95e,_0x112c6f,_0x459bc7)=>{const _0x5e4e21=a21_0x1adf02;if(!_0x50a95e[_0x5e4e21(0x19e)]||_0x50a95e['user'][_0x5e4e21(0x1a4)]!==_0x5e4e21(0x1b4))return _0x112c6f[_0x5e4e21(0x1ba)](0x193)['json']({'success':![],'message':'Shop\x20access\x20required'});try{const _0x3424e5=require(_0x5e4e21(0x1b7))[_0x5e4e21(0x1bc)],_0x3ae4a9=await _0x3424e5[_0x5e4e21(0x1b4)][_0x5e4e21(0x1a5)]({'where':{'id':_0x50a95e[_0x5e4e21(0x19e)]['id']},'select':{'status':!![]}});if(!_0x3ae4a9||_0x3ae4a9['status']!==_0x5e4e21(0x1ae))return _0x112c6f['status'](0x193)[_0x5e4e21(0x1a8)]({'success':![],'message':_0x5e4e21(0x1ab),'suspended':_0x3ae4a9?.['status']==='SUSPENDED'});_0x459bc7();}catch(_0x7da3a1){return console['error']('Error\x20checking\x20account\x20status:',_0x7da3a1),_0x112c6f[_0x5e4e21(0x1ba)](0x1f4)['json']({'success':![],'message':'Error\x20checking\x20account\x20status'});}};exports[a21_0x1adf02(0x1b8)]=requireActiveShop;