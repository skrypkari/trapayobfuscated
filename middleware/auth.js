'use strict';const a16_0x5833bc=a16_0x202d;(function(_0x42c288,_0x27683c){const _0x366ccc=a16_0x202d,_0x5f34fd=_0x42c288();while(!![]){try{const _0x37db5e=-parseInt(_0x366ccc(0x12f))/0x1+-parseInt(_0x366ccc(0x121))/0x2+-parseInt(_0x366ccc(0x11f))/0x3+parseInt(_0x366ccc(0x12d))/0x4+-parseInt(_0x366ccc(0x12a))/0x5*(-parseInt(_0x366ccc(0x110))/0x6)+parseInt(_0x366ccc(0x10e))/0x7*(parseInt(_0x366ccc(0x113))/0x8)+parseInt(_0x366ccc(0x10a))/0x9;if(_0x37db5e===_0x27683c)break;else _0x5f34fd['push'](_0x5f34fd['shift']());}catch(_0x246eac){_0x5f34fd['push'](_0x5f34fd['shift']());}}}(a16_0x153b,0xb7def));var __importDefault=this&&this[a16_0x5833bc(0x12e)]||function(_0x14cf37){const _0x5909c2=a16_0x5833bc;return _0x14cf37&&_0x14cf37[_0x5909c2(0x130)]?_0x14cf37:{'default':_0x14cf37};};Object[a16_0x5833bc(0x11a)](exports,a16_0x5833bc(0x130),{'value':!![]}),exports['requireActiveShop']=exports[a16_0x5833bc(0x129)]=exports[a16_0x5833bc(0x131)]=exports['authenticateToken']=void 0x0;const jsonwebtoken_1=__importDefault(require(a16_0x5833bc(0x114))),config_1=require(a16_0x5833bc(0x123)),tokenBlacklistService_1=require(a16_0x5833bc(0x10f)),authenticateToken=(_0x25961f,_0x1ebc62,_0x45c4a4)=>{const _0x3fce97=a16_0x5833bc,_0x138587=_0x25961f['headers']['authorization'],_0x49267e=_0x138587&&_0x138587[_0x3fce97(0x10b)]('\x20')[0x1];if(!_0x49267e)return _0x1ebc62[_0x3fce97(0x10d)](0x191)[_0x3fce97(0x11c)]({'success':![],'message':_0x3fce97(0x116)});if(tokenBlacklistService_1['tokenBlacklistService']['isTokenBlacklisted'](_0x49267e))return _0x1ebc62[_0x3fce97(0x10d)](0x191)['json']({'success':![],'message':_0x3fce97(0x12c)});jsonwebtoken_1[_0x3fce97(0x124)][_0x3fce97(0x127)](_0x49267e,config_1[_0x3fce97(0x122)][_0x3fce97(0x11d)]['secret'],(_0x17ae0b,_0x2107ba)=>{const _0x3c9300=_0x3fce97;if(_0x17ae0b)return _0x1ebc62[_0x3c9300(0x10d)](0x193)['json']({'success':![],'message':_0x3c9300(0x117)});_0x25961f[_0x3c9300(0x126)]=_0x2107ba,_0x25961f[_0x3c9300(0x118)]=_0x49267e,_0x45c4a4();});};exports[a16_0x5833bc(0x11e)]=authenticateToken;const requireAdmin=(_0x1137c3,_0x1c3e45,_0x17a0e2)=>{const _0x4de26a=a16_0x5833bc;if(!_0x1137c3[_0x4de26a(0x126)]||_0x1137c3['user']['role']!==_0x4de26a(0x115))return _0x1c3e45['status'](0x193)[_0x4de26a(0x11c)]({'success':![],'message':_0x4de26a(0x11b)});_0x17a0e2();};function a16_0x153b(){const _0x259b5b=['user','verify','Shop\x20access\x20required','requireShop','189695BELKcZ','SUSPENDED','Token\x20has\x20been\x20revoked','5585404Itpxaa','__importDefault','598721bZhpGW','__esModule','requireAdmin','13589091mhlXHG','split','ACTIVE','status','3380244DVjOux','../services/tokenBlacklistService','54QlgEWc','shop','../config/database','8QywnyU','jsonwebtoken','admin','Access\x20token\x20required','Invalid\x20or\x20expired\x20token','token','Account\x20is\x20suspended\x20or\x20inactive.\x20Contact\x20administrator\x20to\x20activate\x20your\x20account.','defineProperty','Admin\x20access\x20required','json','jwt','authenticateToken','2898093kDpXMY','Error\x20checking\x20account\x20status:','2825412rwxiaq','config','../config/config','default','error'];a16_0x153b=function(){return _0x259b5b;};return a16_0x153b();}exports['requireAdmin']=requireAdmin;const requireShop=(_0x41d4f6,_0x50b6bc,_0x3c3bc1)=>{const _0x220b31=a16_0x5833bc;if(!_0x41d4f6['user']||_0x41d4f6['user']['role']!==_0x220b31(0x111))return _0x50b6bc[_0x220b31(0x10d)](0x193)[_0x220b31(0x11c)]({'success':![],'message':_0x220b31(0x128)});_0x3c3bc1();};exports[a16_0x5833bc(0x129)]=requireShop;function a16_0x202d(_0x461147,_0x1fc826){const _0x153b4d=a16_0x153b();return a16_0x202d=function(_0x202d77,_0x48a1ab){_0x202d77=_0x202d77-0x10a;let _0x29970b=_0x153b4d[_0x202d77];return _0x29970b;},a16_0x202d(_0x461147,_0x1fc826);}const requireActiveShop=async(_0x54f41b,_0x2137a1,_0x2f35e0)=>{const _0x37ab8d=a16_0x5833bc;if(!_0x54f41b['user']||_0x54f41b[_0x37ab8d(0x126)]['role']!==_0x37ab8d(0x111))return _0x2137a1[_0x37ab8d(0x10d)](0x193)['json']({'success':![],'message':_0x37ab8d(0x128)});try{const _0x394dd9=require(_0x37ab8d(0x112))[_0x37ab8d(0x124)],_0x49ac59=await _0x394dd9[_0x37ab8d(0x111)]['findUnique']({'where':{'id':_0x54f41b['user']['id']},'select':{'status':!![]}});if(!_0x49ac59||_0x49ac59[_0x37ab8d(0x10d)]!==_0x37ab8d(0x10c))return _0x2137a1[_0x37ab8d(0x10d)](0x193)[_0x37ab8d(0x11c)]({'success':![],'message':_0x37ab8d(0x119),'suspended':_0x49ac59?.[_0x37ab8d(0x10d)]===_0x37ab8d(0x12b)});_0x2f35e0();}catch(_0x3cd8c6){return console[_0x37ab8d(0x125)](_0x37ab8d(0x120),_0x3cd8c6),_0x2137a1['status'](0x1f4)[_0x37ab8d(0x11c)]({'success':![],'message':'Error\x20checking\x20account\x20status'});}};exports['requireActiveShop']=requireActiveShop;