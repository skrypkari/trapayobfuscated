'use strict';const a16_0x1898a9=a16_0x47be;(function(_0x1d44c9,_0x156be4){const _0x3e2a88=a16_0x47be,_0x4f6649=_0x1d44c9();while(!![]){try{const _0x448eb3=parseInt(_0x3e2a88(0x159))/0x1+parseInt(_0x3e2a88(0x13a))/0x2*(-parseInt(_0x3e2a88(0x130))/0x3)+parseInt(_0x3e2a88(0x155))/0x4+parseInt(_0x3e2a88(0x14c))/0x5+-parseInt(_0x3e2a88(0x148))/0x6+-parseInt(_0x3e2a88(0x136))/0x7+parseInt(_0x3e2a88(0x143))/0x8*(parseInt(_0x3e2a88(0x14b))/0x9);if(_0x448eb3===_0x156be4)break;else _0x4f6649['push'](_0x4f6649['shift']());}catch(_0x12acf8){_0x4f6649['push'](_0x4f6649['shift']());}}}(a16_0x3893,0xc194a));var __importDefault=this&&this[a16_0x1898a9(0x149)]||function(_0x58c41d){const _0x38b668=a16_0x1898a9;return _0x58c41d&&_0x58c41d[_0x38b668(0x142)]?_0x58c41d:{'default':_0x58c41d};};Object['defineProperty'](exports,a16_0x1898a9(0x142),{'value':!![]}),exports[a16_0x1898a9(0x131)]=exports['requireShop']=exports[a16_0x1898a9(0x153)]=exports['authenticateToken']=void 0x0;function a16_0x3893(){const _0x2a16ba=['Invalid\x20or\x20expired\x20token','20Qbobhv','secret','../services/tokenBlacklistService','Error\x20checking\x20account\x20status:','Admin\x20access\x20required','Error\x20checking\x20account\x20status','token','error','__esModule','1779560vHzaKJ','user','SUSPENDED','jwt','headers','7374846vKOvqZ','__importDefault','../config/config','81QlNZss','2789815uSoMAX','admin','jsonwebtoken','status','role','verify','authenticateToken','requireAdmin','tokenBlacklistService','4606928VLezbV','json','../config/database','findUnique','1151675IiEaEQ','config','isTokenBlacklisted','406863Nehqly','requireActiveShop','Shop\x20access\x20required','default','split','authorization','10395826PzajOn','shop','Account\x20is\x20suspended\x20or\x20inactive.\x20Contact\x20administrator\x20to\x20activate\x20your\x20account.'];a16_0x3893=function(){return _0x2a16ba;};return a16_0x3893();}const jsonwebtoken_1=__importDefault(require(a16_0x1898a9(0x14e))),config_1=require(a16_0x1898a9(0x14a)),tokenBlacklistService_1=require(a16_0x1898a9(0x13c)),authenticateToken=(_0x124ccd,_0x1ae9fa,_0x2c505f)=>{const _0x50af63=a16_0x1898a9,_0x548d46=_0x124ccd[_0x50af63(0x147)][_0x50af63(0x135)],_0x13e678=_0x548d46&&_0x548d46[_0x50af63(0x134)]('\x20')[0x1];if(!_0x13e678)return _0x1ae9fa['status'](0x191)[_0x50af63(0x156)]({'success':![],'message':'Access\x20token\x20required'});if(tokenBlacklistService_1[_0x50af63(0x154)][_0x50af63(0x15b)](_0x13e678))return _0x1ae9fa[_0x50af63(0x14f)](0x191)[_0x50af63(0x156)]({'success':![],'message':'Token\x20has\x20been\x20revoked'});jsonwebtoken_1['default'][_0x50af63(0x151)](_0x13e678,config_1[_0x50af63(0x15a)][_0x50af63(0x146)][_0x50af63(0x13b)],(_0x2dbe24,_0x45cdaf)=>{const _0x30ac70=_0x50af63;if(_0x2dbe24)return _0x1ae9fa['status'](0x193)[_0x30ac70(0x156)]({'success':![],'message':_0x30ac70(0x139)});_0x124ccd[_0x30ac70(0x144)]=_0x45cdaf,_0x124ccd[_0x30ac70(0x140)]=_0x13e678,_0x2c505f();});};function a16_0x47be(_0x36ca6d,_0x33844a){const _0x389398=a16_0x3893();return a16_0x47be=function(_0x47bedd,_0x288b2b){_0x47bedd=_0x47bedd-0x130;let _0x165dd2=_0x389398[_0x47bedd];return _0x165dd2;},a16_0x47be(_0x36ca6d,_0x33844a);}exports[a16_0x1898a9(0x152)]=authenticateToken;const requireAdmin=(_0x44c9f9,_0x2439e1,_0x9834c2)=>{const _0x3deaa8=a16_0x1898a9;if(!_0x44c9f9[_0x3deaa8(0x144)]||_0x44c9f9['user']['role']!==_0x3deaa8(0x14d))return _0x2439e1[_0x3deaa8(0x14f)](0x193)[_0x3deaa8(0x156)]({'success':![],'message':_0x3deaa8(0x13e)});_0x9834c2();};exports['requireAdmin']=requireAdmin;const requireShop=(_0x296682,_0x1b3504,_0x3e7b85)=>{const _0x4cfb14=a16_0x1898a9;if(!_0x296682['user']||_0x296682['user'][_0x4cfb14(0x150)]!==_0x4cfb14(0x137))return _0x1b3504[_0x4cfb14(0x14f)](0x193)[_0x4cfb14(0x156)]({'success':![],'message':_0x4cfb14(0x132)});_0x3e7b85();};exports['requireShop']=requireShop;const requireActiveShop=async(_0x3c863d,_0x31e6d5,_0x124a51)=>{const _0x3d57a1=a16_0x1898a9;if(!_0x3c863d[_0x3d57a1(0x144)]||_0x3c863d['user'][_0x3d57a1(0x150)]!==_0x3d57a1(0x137))return _0x31e6d5[_0x3d57a1(0x14f)](0x193)['json']({'success':![],'message':_0x3d57a1(0x132)});try{const _0x5a5ca9=require(_0x3d57a1(0x157))[_0x3d57a1(0x133)],_0x2cc2a9=await _0x5a5ca9['shop'][_0x3d57a1(0x158)]({'where':{'id':_0x3c863d['user']['id']},'select':{'status':!![]}});if(!_0x2cc2a9||_0x2cc2a9[_0x3d57a1(0x14f)]!=='ACTIVE')return _0x31e6d5[_0x3d57a1(0x14f)](0x193)[_0x3d57a1(0x156)]({'success':![],'message':_0x3d57a1(0x138),'suspended':_0x2cc2a9?.['status']===_0x3d57a1(0x145)});_0x124a51();}catch(_0x26aee6){return console[_0x3d57a1(0x141)](_0x3d57a1(0x13d),_0x26aee6),_0x31e6d5[_0x3d57a1(0x14f)](0x1f4)['json']({'success':![],'message':_0x3d57a1(0x13f)});}};exports['requireActiveShop']=requireActiveShop;