'use strict';const a22_0x293798=a22_0x374a;(function(_0x2e2b37,_0x2dc743){const _0x5c7efe=a22_0x374a,_0x35a982=_0x2e2b37();while(!![]){try{const _0xf27f69=parseInt(_0x5c7efe(0x1f9))/0x1+parseInt(_0x5c7efe(0x1f7))/0x2*(-parseInt(_0x5c7efe(0x1e2))/0x3)+-parseInt(_0x5c7efe(0x1d8))/0x4+parseInt(_0x5c7efe(0x1e3))/0x5+-parseInt(_0x5c7efe(0x1d9))/0x6+parseInt(_0x5c7efe(0x1e5))/0x7*(-parseInt(_0x5c7efe(0x1e6))/0x8)+-parseInt(_0x5c7efe(0x1d6))/0x9*(-parseInt(_0x5c7efe(0x1f2))/0xa);if(_0xf27f69===_0x2dc743)break;else _0x35a982['push'](_0x35a982['shift']());}catch(_0x118bf0){_0x35a982['push'](_0x35a982['shift']());}}}(a22_0x13f9,0xc29bd));var __importDefault=this&&this[a22_0x293798(0x1f4)]||function(_0xa777c3){return _0xa777c3&&_0xa777c3['__esModule']?_0xa777c3:{'default':_0xa777c3};};Object['defineProperty'](exports,a22_0x293798(0x1f5),{'value':!![]}),exports['requireActiveShop']=exports[a22_0x293798(0x1ec)]=exports[a22_0x293798(0x1f8)]=exports[a22_0x293798(0x1e4)]=void 0x0;const jsonwebtoken_1=__importDefault(require(a22_0x293798(0x1df))),config_1=require(a22_0x293798(0x1eb)),tokenBlacklistService_1=require('../services/tokenBlacklistService'),authenticateToken=(_0x19cc98,_0x1d953d,_0x400aba)=>{const _0x5b9422=a22_0x293798,_0x228e5d=_0x19cc98[_0x5b9422(0x1db)]['authorization'],_0x20f8ac=_0x228e5d&&_0x228e5d[_0x5b9422(0x1e0)]('\x20')[0x1];if(!_0x20f8ac)return _0x1d953d[_0x5b9422(0x1ea)](0x191)[_0x5b9422(0x1ef)]({'success':![],'message':_0x5b9422(0x1f6)});if(tokenBlacklistService_1[_0x5b9422(0x1dd)][_0x5b9422(0x1da)](_0x20f8ac))return _0x1d953d['status'](0x191)[_0x5b9422(0x1ef)]({'success':![],'message':_0x5b9422(0x1f1)});jsonwebtoken_1['default']['verify'](_0x20f8ac,config_1[_0x5b9422(0x1de)][_0x5b9422(0x1e8)]['secret'],(_0x5a190a,_0xaf56ef)=>{const _0x35c3aa=_0x5b9422;if(_0x5a190a)return _0x1d953d[_0x35c3aa(0x1ea)](0x193)[_0x35c3aa(0x1ef)]({'success':![],'message':_0x35c3aa(0x1f0)});_0x19cc98[_0x35c3aa(0x1ed)]=_0xaf56ef,_0x19cc98['token']=_0x20f8ac,_0x400aba();});};exports[a22_0x293798(0x1e4)]=authenticateToken;const requireAdmin=(_0xc0359e,_0x128592,_0x26d3f0)=>{const _0x16bb34=a22_0x293798;if(!_0xc0359e['user']||_0xc0359e[_0x16bb34(0x1ed)]['role']!=='admin')return _0x128592[_0x16bb34(0x1ea)](0x193)[_0x16bb34(0x1ef)]({'success':![],'message':'Admin\x20access\x20required'});_0x26d3f0();};exports[a22_0x293798(0x1f8)]=requireAdmin;const requireShop=(_0x3ca316,_0x34da75,_0x4590e2)=>{const _0x2b31ba=a22_0x293798;if(!_0x3ca316[_0x2b31ba(0x1ed)]||_0x3ca316['user'][_0x2b31ba(0x1e9)]!==_0x2b31ba(0x1d5))return _0x34da75[_0x2b31ba(0x1ea)](0x193)[_0x2b31ba(0x1ef)]({'success':![],'message':_0x2b31ba(0x1d7)});_0x4590e2();};function a22_0x374a(_0x4b5d09,_0x264f61){_0x4b5d09=_0x4b5d09-0x1d5;const _0x13f9f3=a22_0x13f9();let _0x374a5e=_0x13f9f3[_0x4b5d09];return _0x374a5e;}function a22_0x13f9(){const _0x5e27eb=['default','__importDefault','__esModule','Access\x20token\x20required','1208458hhjiJI','requireAdmin','370958KycLfT','shop','9EwuCay','Shop\x20access\x20required','4640536kNYNig','894444tgVZik','isTokenBlacklisted','headers','../config/database','tokenBlacklistService','config','jsonwebtoken','split','requireActiveShop','6CJIAWI','7339735tOyUrK','authenticateToken','3580773AZxxyP','8gWeFal','error','jwt','role','status','../config/config','requireShop','user','Account\x20is\x20suspended\x20or\x20inactive.\x20Contact\x20administrator\x20to\x20activate\x20your\x20account.','json','Invalid\x20or\x20expired\x20token','Token\x20has\x20been\x20revoked','19874170mRuhcB'];a22_0x13f9=function(){return _0x5e27eb;};return a22_0x13f9();}exports['requireShop']=requireShop;const requireActiveShop=async(_0x4a8894,_0x539e8b,_0x1bda96)=>{const _0x4d7d70=a22_0x293798;if(!_0x4a8894[_0x4d7d70(0x1ed)]||_0x4a8894[_0x4d7d70(0x1ed)][_0x4d7d70(0x1e9)]!==_0x4d7d70(0x1d5))return _0x539e8b[_0x4d7d70(0x1ea)](0x193)[_0x4d7d70(0x1ef)]({'success':![],'message':_0x4d7d70(0x1d7)});try{const _0x4b34f5=require(_0x4d7d70(0x1dc))[_0x4d7d70(0x1f3)],_0x39f146=await _0x4b34f5[_0x4d7d70(0x1d5)]['findUnique']({'where':{'id':_0x4a8894['user']['id']},'select':{'status':!![]}});if(!_0x39f146||_0x39f146['status']!=='ACTIVE')return _0x539e8b[_0x4d7d70(0x1ea)](0x193)[_0x4d7d70(0x1ef)]({'success':![],'message':_0x4d7d70(0x1ee),'suspended':_0x39f146?.['status']==='SUSPENDED'});_0x1bda96();}catch(_0x42e4cf){return console[_0x4d7d70(0x1e7)]('Error\x20checking\x20account\x20status:',_0x42e4cf),_0x539e8b[_0x4d7d70(0x1ea)](0x1f4)[_0x4d7d70(0x1ef)]({'success':![],'message':'Error\x20checking\x20account\x20status'});}};exports[a22_0x293798(0x1e1)]=requireActiveShop;