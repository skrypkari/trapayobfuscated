'use strict';const a16_0x387cdf=a16_0x12ae;(function(_0x8bc80c,_0x39471d){const _0x4966c3=a16_0x12ae,_0x487f89=_0x8bc80c();while(!![]){try{const _0x5e0f18=-parseInt(_0x4966c3(0x18b))/0x1+-parseInt(_0x4966c3(0x185))/0x2*(parseInt(_0x4966c3(0x190))/0x3)+-parseInt(_0x4966c3(0x183))/0x4*(-parseInt(_0x4966c3(0x197))/0x5)+-parseInt(_0x4966c3(0x189))/0x6*(-parseInt(_0x4966c3(0x19c))/0x7)+parseInt(_0x4966c3(0x182))/0x8*(-parseInt(_0x4966c3(0x193))/0x9)+-parseInt(_0x4966c3(0x181))/0xa*(parseInt(_0x4966c3(0x198))/0xb)+parseInt(_0x4966c3(0x186))/0xc;if(_0x5e0f18===_0x39471d)break;else _0x487f89['push'](_0x487f89['shift']());}catch(_0x1737a9){_0x487f89['push'](_0x487f89['shift']());}}}(a16_0x2758,0xd62ed));var __importDefault=this&&this[a16_0x387cdf(0x17f)]||function(_0x3536c6){const _0x579e67=a16_0x387cdf;return _0x3536c6&&_0x3536c6[_0x579e67(0x19b)]?_0x3536c6:{'default':_0x3536c6};};Object[a16_0x387cdf(0x188)](exports,'__esModule',{'value':!![]}),exports[a16_0x387cdf(0x19f)]=exports[a16_0x387cdf(0x192)]=exports[a16_0x387cdf(0x18d)]=void 0x0;const jsonwebtoken_1=__importDefault(require('jsonwebtoken')),config_1=require(a16_0x387cdf(0x184)),tokenBlacklistService_1=require('../services/tokenBlacklistService'),authenticateToken=(_0xa5a2cc,_0x56a030,_0x821f18)=>{const _0x197f0f=a16_0x387cdf,_0x558829=_0xa5a2cc['headers'][_0x197f0f(0x19a)],_0x245d26=_0x558829&&_0x558829[_0x197f0f(0x199)]('\x20')[0x1];if(!_0x245d26)return _0x56a030['status'](0x191)[_0x197f0f(0x1a0)]({'success':![],'message':'Access\x20token\x20required'});if(tokenBlacklistService_1[_0x197f0f(0x196)][_0x197f0f(0x18e)](_0x245d26))return _0x56a030[_0x197f0f(0x19e)](0x191)[_0x197f0f(0x1a0)]({'success':![],'message':'Token\x20has\x20been\x20revoked'});jsonwebtoken_1[_0x197f0f(0x19d)][_0x197f0f(0x18f)](_0x245d26,config_1[_0x197f0f(0x1a1)]['jwt'][_0x197f0f(0x180)],(_0x4ac2a7,_0x322414)=>{const _0x2c8a55=_0x197f0f;if(_0x4ac2a7)return _0x56a030['status'](0x193)[_0x2c8a55(0x1a0)]({'success':![],'message':_0x2c8a55(0x18c)});_0xa5a2cc[_0x2c8a55(0x187)]=_0x322414,_0xa5a2cc[_0x2c8a55(0x18a)]=_0x245d26,_0x821f18();});};exports[a16_0x387cdf(0x18d)]=authenticateToken;const requireAdmin=(_0x2fd4e0,_0x47422c,_0x5b656d)=>{const _0x276a4f=a16_0x387cdf;if(!_0x2fd4e0[_0x276a4f(0x187)]||_0x2fd4e0[_0x276a4f(0x187)]['role']!=='admin')return _0x47422c['status'](0x193)['json']({'success':![],'message':_0x276a4f(0x194)});_0x5b656d();};exports[a16_0x387cdf(0x192)]=requireAdmin;const requireShop=(_0x324771,_0x1ebf3d,_0x15fb5b)=>{const _0x3a4feb=a16_0x387cdf;if(!_0x324771['user']||_0x324771[_0x3a4feb(0x187)][_0x3a4feb(0x1a2)]!==_0x3a4feb(0x191))return _0x1ebf3d[_0x3a4feb(0x19e)](0x193)[_0x3a4feb(0x1a0)]({'success':![],'message':_0x3a4feb(0x195)});_0x15fb5b();};function a16_0x2758(){const _0x5dc9f3=['18eqrWWX','Admin\x20access\x20required','Shop\x20access\x20required','tokenBlacklistService','10PVMeoO','10450wYtZeH','split','authorization','__esModule','112npbPRZ','default','status','requireShop','json','config','role','__importDefault','secret','15670HSgTNd','349352cMPEFk','3394052isAkcn','../config/config','3156470aYoqaS','26157432xgAIsJ','user','defineProperty','612300jfBAvb','token','1478096NYbrNF','Invalid\x20or\x20expired\x20token','authenticateToken','isTokenBlacklisted','verify','3oMDugi','shop','requireAdmin'];a16_0x2758=function(){return _0x5dc9f3;};return a16_0x2758();}function a16_0x12ae(_0x1045d8,_0x49abff){const _0x27586a=a16_0x2758();return a16_0x12ae=function(_0x12aef,_0x1fc5f0){_0x12aef=_0x12aef-0x17f;let _0x4a74be=_0x27586a[_0x12aef];return _0x4a74be;},a16_0x12ae(_0x1045d8,_0x49abff);}exports[a16_0x387cdf(0x19f)]=requireShop;