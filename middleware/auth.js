'use strict';const a18_0x2916aa=a18_0x478e;(function(_0x29c62c,_0x753cf1){const _0x5e2493=a18_0x478e,_0x1200ba=_0x29c62c();while(!![]){try{const _0x30e000=-parseInt(_0x5e2493(0xa0))/0x1+parseInt(_0x5e2493(0x96))/0x2*(-parseInt(_0x5e2493(0xa9))/0x3)+parseInt(_0x5e2493(0xb6))/0x4*(parseInt(_0x5e2493(0x98))/0x5)+parseInt(_0x5e2493(0x9b))/0x6+-parseInt(_0x5e2493(0xa3))/0x7*(-parseInt(_0x5e2493(0xb3))/0x8)+parseInt(_0x5e2493(0xbd))/0x9+-parseInt(_0x5e2493(0xb7))/0xa;if(_0x30e000===_0x753cf1)break;else _0x1200ba['push'](_0x1200ba['shift']());}catch(_0x2badb3){_0x1200ba['push'](_0x1200ba['shift']());}}}(a18_0x30af,0x4ee57));var __importDefault=this&&this[a18_0x2916aa(0xa1)]||function(_0x4ff523){const _0x2426f9=a18_0x2916aa;return _0x4ff523&&_0x4ff523[_0x2426f9(0x9f)]?_0x4ff523:{'default':_0x4ff523};};Object[a18_0x2916aa(0xad)](exports,a18_0x2916aa(0x9f),{'value':!![]}),exports[a18_0x2916aa(0x99)]=exports[a18_0x2916aa(0x9c)]=exports[a18_0x2916aa(0x9e)]=exports[a18_0x2916aa(0xb8)]=void 0x0;const jsonwebtoken_1=__importDefault(require(a18_0x2916aa(0xa8))),config_1=require(a18_0x2916aa(0xac)),tokenBlacklistService_1=require('../services/tokenBlacklistService'),authenticateToken=(_0x18bda0,_0xeb6ddf,_0x30c344)=>{const _0x575385=a18_0x2916aa,_0xe1347c=_0x18bda0[_0x575385(0x9d)][_0x575385(0xa2)],_0x4c0c09=_0xe1347c&&_0xe1347c['split']('\x20')[0x1];if(!_0x4c0c09)return _0xeb6ddf[_0x575385(0xa6)](0x191)['json']({'success':![],'message':_0x575385(0xb2)});if(tokenBlacklistService_1[_0x575385(0xaa)]['isTokenBlacklisted'](_0x4c0c09))return _0xeb6ddf[_0x575385(0xa6)](0x191)[_0x575385(0xb0)]({'success':![],'message':_0x575385(0xb4)});jsonwebtoken_1[_0x575385(0xb9)][_0x575385(0xbc)](_0x4c0c09,config_1[_0x575385(0xaf)][_0x575385(0x97)]['secret'],(_0x5aabc6,_0x6bc197)=>{const _0x394386=_0x575385;if(_0x5aabc6)return _0xeb6ddf[_0x394386(0xa6)](0x193)[_0x394386(0xb0)]({'success':![],'message':_0x394386(0xa4)});_0x18bda0['user']=_0x6bc197,_0x18bda0[_0x394386(0x93)]=_0x4c0c09,_0x30c344();});};function a18_0x30af(){const _0x51090d=['headers','requireAdmin','__esModule','177191oekuNB','__importDefault','authorization','217CgUCFz','Invalid\x20or\x20expired\x20token','Shop\x20access\x20required','status','Account\x20is\x20suspended\x20or\x20inactive.\x20Contact\x20administrator\x20to\x20activate\x20your\x20account.','jsonwebtoken','301443VUqymD','tokenBlacklistService','ACTIVE','../config/config','defineProperty','SUSPENDED','config','json','role','Access\x20token\x20required','127544dovLKk','Token\x20has\x20been\x20revoked','user','272EgLgzw','9030790BKkRkz','authenticateToken','default','findUnique','Admin\x20access\x20required','verify','5497533neTkbQ','token','error','../config/database','10BkRPup','jwt','41025gEnhAH','requireActiveShop','Error\x20checking\x20account\x20status','1456944MjdWFg','requireShop'];a18_0x30af=function(){return _0x51090d;};return a18_0x30af();}function a18_0x478e(_0x1dfba4,_0x23b36d){const _0x30af20=a18_0x30af();return a18_0x478e=function(_0x478e07,_0x27ea72){_0x478e07=_0x478e07-0x93;let _0x351578=_0x30af20[_0x478e07];return _0x351578;},a18_0x478e(_0x1dfba4,_0x23b36d);}exports[a18_0x2916aa(0xb8)]=authenticateToken;const requireAdmin=(_0x35e790,_0x2461da,_0xb5d812)=>{const _0x2bdf2c=a18_0x2916aa;if(!_0x35e790[_0x2bdf2c(0xb5)]||_0x35e790[_0x2bdf2c(0xb5)][_0x2bdf2c(0xb1)]!=='admin')return _0x2461da[_0x2bdf2c(0xa6)](0x193)[_0x2bdf2c(0xb0)]({'success':![],'message':_0x2bdf2c(0xbb)});_0xb5d812();};exports['requireAdmin']=requireAdmin;const requireShop=(_0x97d169,_0x279da6,_0x32a772)=>{const _0x2eb81d=a18_0x2916aa;if(!_0x97d169[_0x2eb81d(0xb5)]||_0x97d169[_0x2eb81d(0xb5)][_0x2eb81d(0xb1)]!=='shop')return _0x279da6[_0x2eb81d(0xa6)](0x193)[_0x2eb81d(0xb0)]({'success':![],'message':_0x2eb81d(0xa5)});_0x32a772();};exports[a18_0x2916aa(0x9c)]=requireShop;const requireActiveShop=async(_0x289ae0,_0x400aea,_0x2307be)=>{const _0x1d487d=a18_0x2916aa;if(!_0x289ae0[_0x1d487d(0xb5)]||_0x289ae0[_0x1d487d(0xb5)][_0x1d487d(0xb1)]!=='shop')return _0x400aea[_0x1d487d(0xa6)](0x193)[_0x1d487d(0xb0)]({'success':![],'message':'Shop\x20access\x20required'});try{const _0x32f994=require(_0x1d487d(0x95))[_0x1d487d(0xb9)],_0x2624be=await _0x32f994['shop'][_0x1d487d(0xba)]({'where':{'id':_0x289ae0[_0x1d487d(0xb5)]['id']},'select':{'status':!![]}});if(!_0x2624be||_0x2624be[_0x1d487d(0xa6)]!==_0x1d487d(0xab))return _0x400aea[_0x1d487d(0xa6)](0x193)['json']({'success':![],'message':_0x1d487d(0xa7),'suspended':_0x2624be?.[_0x1d487d(0xa6)]===_0x1d487d(0xae)});_0x2307be();}catch(_0x4cd3f0){return console[_0x1d487d(0x94)]('Error\x20checking\x20account\x20status:',_0x4cd3f0),_0x400aea[_0x1d487d(0xa6)](0x1f4)[_0x1d487d(0xb0)]({'success':![],'message':_0x1d487d(0x9a)});}};exports['requireActiveShop']=requireActiveShop;