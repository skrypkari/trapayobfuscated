'use strict';const a16_0x3b7d71=a16_0x36bd;(function(_0x2d72bd,_0x968cb8){const _0x45c315=a16_0x36bd,_0x228101=_0x2d72bd();while(!![]){try{const _0x2a234b=-parseInt(_0x45c315(0x8e))/0x1*(-parseInt(_0x45c315(0x86))/0x2)+-parseInt(_0x45c315(0x8f))/0x3+parseInt(_0x45c315(0x9c))/0x4*(-parseInt(_0x45c315(0x95))/0x5)+parseInt(_0x45c315(0x82))/0x6+parseInt(_0x45c315(0x9f))/0x7+parseInt(_0x45c315(0x85))/0x8+parseInt(_0x45c315(0x9d))/0x9*(-parseInt(_0x45c315(0x8a))/0xa);if(_0x2a234b===_0x968cb8)break;else _0x228101['push'](_0x228101['shift']());}catch(_0x545834){_0x228101['push'](_0x228101['shift']());}}}(a16_0x355a,0xa9452));function a16_0x355a(){const _0x7d0136=['4598586gugoDQ','json','../config/config','2010912TNUMHz','215692SQHFll','role','Shop\x20access\x20required','__importDefault','126220cfbrLa','isTokenBlacklisted','default','defineProperty','2rbSmNn','2678994sSRekh','user','secret','status','Invalid\x20or\x20expired\x20token','headers','5yoFcTL','authenticateToken','Token\x20has\x20been\x20revoked','requireShop','verify','authorization','admin','986520ILUzue','9WTMcrD','__esModule','4284651IkqMjx','config','shop','Access\x20token\x20required','jwt','tokenBlacklistService'];a16_0x355a=function(){return _0x7d0136;};return a16_0x355a();}var __importDefault=this&&this[a16_0x3b7d71(0x89)]||function(_0x48fc37){return _0x48fc37&&_0x48fc37['__esModule']?_0x48fc37:{'default':_0x48fc37};};Object[a16_0x3b7d71(0x8d)](exports,a16_0x3b7d71(0x9e),{'value':!![]}),exports[a16_0x3b7d71(0x98)]=exports['requireAdmin']=exports[a16_0x3b7d71(0x96)]=void 0x0;const jsonwebtoken_1=__importDefault(require('jsonwebtoken')),config_1=require(a16_0x3b7d71(0x84)),tokenBlacklistService_1=require('../services/tokenBlacklistService'),authenticateToken=(_0xcd2677,_0x582af6,_0xe6b195)=>{const _0x543aba=a16_0x3b7d71,_0x32726b=_0xcd2677[_0x543aba(0x94)][_0x543aba(0x9a)],_0x128d6e=_0x32726b&&_0x32726b['split']('\x20')[0x1];if(!_0x128d6e)return _0x582af6[_0x543aba(0x92)](0x191)['json']({'success':![],'message':_0x543aba(0x7f)});if(tokenBlacklistService_1[_0x543aba(0x81)][_0x543aba(0x8b)](_0x128d6e))return _0x582af6[_0x543aba(0x92)](0x191)['json']({'success':![],'message':_0x543aba(0x97)});jsonwebtoken_1[_0x543aba(0x8c)][_0x543aba(0x99)](_0x128d6e,config_1[_0x543aba(0xa0)][_0x543aba(0x80)][_0x543aba(0x91)],(_0x22a5d7,_0x631c99)=>{const _0x2bfba9=_0x543aba;if(_0x22a5d7)return _0x582af6[_0x2bfba9(0x92)](0x193)['json']({'success':![],'message':_0x2bfba9(0x93)});_0xcd2677[_0x2bfba9(0x90)]=_0x631c99,_0xcd2677['token']=_0x128d6e,_0xe6b195();});};exports[a16_0x3b7d71(0x96)]=authenticateToken;const requireAdmin=(_0x502e00,_0x5c6e6a,_0x26623c)=>{const _0x53aba5=a16_0x3b7d71;if(!_0x502e00[_0x53aba5(0x90)]||_0x502e00['user'][_0x53aba5(0x87)]!==_0x53aba5(0x9b))return _0x5c6e6a[_0x53aba5(0x92)](0x193)[_0x53aba5(0x83)]({'success':![],'message':'Admin\x20access\x20required'});_0x26623c();};exports['requireAdmin']=requireAdmin;function a16_0x36bd(_0x2bb703,_0x32eb81){const _0x355a1b=a16_0x355a();return a16_0x36bd=function(_0x36bded,_0x5f089b){_0x36bded=_0x36bded-0x7f;let _0x36d17d=_0x355a1b[_0x36bded];return _0x36d17d;},a16_0x36bd(_0x2bb703,_0x32eb81);}const requireShop=(_0x19e169,_0x2b193d,_0x365d06)=>{const _0x1f709f=a16_0x3b7d71;if(!_0x19e169['user']||_0x19e169[_0x1f709f(0x90)][_0x1f709f(0x87)]!==_0x1f709f(0xa1))return _0x2b193d[_0x1f709f(0x92)](0x193)[_0x1f709f(0x83)]({'success':![],'message':_0x1f709f(0x88)});_0x365d06();};exports[a16_0x3b7d71(0x98)]=requireShop;