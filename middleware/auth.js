'use strict';const a18_0x287783=a18_0x4c31;(function(_0x7f6ef5,_0x12fc5b){const _0x4ad42c=a18_0x4c31,_0x472d79=_0x7f6ef5();while(!![]){try{const _0x291dd0=parseInt(_0x4ad42c(0x134))/0x1*(-parseInt(_0x4ad42c(0x137))/0x2)+parseInt(_0x4ad42c(0x12f))/0x3+-parseInt(_0x4ad42c(0x14a))/0x4+-parseInt(_0x4ad42c(0x13b))/0x5*(-parseInt(_0x4ad42c(0x12e))/0x6)+-parseInt(_0x4ad42c(0x146))/0x7*(-parseInt(_0x4ad42c(0x144))/0x8)+parseInt(_0x4ad42c(0x13e))/0x9+parseInt(_0x4ad42c(0x147))/0xa;if(_0x291dd0===_0x12fc5b)break;else _0x472d79['push'](_0x472d79['shift']());}catch(_0x36514b){_0x472d79['push'](_0x472d79['shift']());}}}(a18_0x1f2b,0x4b91c));var __importDefault=this&&this[a18_0x287783(0x143)]||function(_0x1db99a){const _0x385f0a=a18_0x287783;return _0x1db99a&&_0x1db99a[_0x385f0a(0x14f)]?_0x1db99a:{'default':_0x1db99a};};Object['defineProperty'](exports,a18_0x287783(0x14f),{'value':!![]}),exports['requireActiveShop']=exports[a18_0x287783(0x14e)]=exports['requireAdmin']=exports['authenticateToken']=void 0x0;function a18_0x1f2b(){const _0xb8b5e=['requireAdmin','Token\x20has\x20been\x20revoked','182108XQMoTO','default','Admin\x20access\x20required','Error\x20checking\x20account\x20status','requireShop','__esModule','authorization','shop','admin','token','user','requireActiveShop','SUSPENDED','headers','33414Btigjc','717252xjiEUR','verify','role','tokenBlacklistService','../services/tokenBlacklistService','241Ohkgoc','split','error','796ELMofv','findUnique','jwt','../config/database','35hpOqhg','Error\x20checking\x20account\x20status:','isTokenBlacklisted','972774bEFRAa','status','Shop\x20access\x20required','config','authenticateToken','__importDefault','8XKJobh','json','33964VcRbtq','599720eilDNA'];a18_0x1f2b=function(){return _0xb8b5e;};return a18_0x1f2b();}const jsonwebtoken_1=__importDefault(require('jsonwebtoken')),config_1=require('../config/config'),tokenBlacklistService_1=require(a18_0x287783(0x133)),authenticateToken=(_0x56d2fb,_0x272394,_0x3be310)=>{const _0x3d47c4=a18_0x287783,_0x3d5d53=_0x56d2fb[_0x3d47c4(0x157)][_0x3d47c4(0x150)],_0x179175=_0x3d5d53&&_0x3d5d53[_0x3d47c4(0x135)]('\x20')[0x1];if(!_0x179175)return _0x272394['status'](0x191)['json']({'success':![],'message':'Access\x20token\x20required'});if(tokenBlacklistService_1[_0x3d47c4(0x132)][_0x3d47c4(0x13d)](_0x179175))return _0x272394['status'](0x191)[_0x3d47c4(0x145)]({'success':![],'message':_0x3d47c4(0x149)});jsonwebtoken_1[_0x3d47c4(0x14b)][_0x3d47c4(0x130)](_0x179175,config_1[_0x3d47c4(0x141)][_0x3d47c4(0x139)]['secret'],(_0x4cadf7,_0x18ba4d)=>{const _0x28c91c=_0x3d47c4;if(_0x4cadf7)return _0x272394[_0x28c91c(0x13f)](0x193)[_0x28c91c(0x145)]({'success':![],'message':'Invalid\x20or\x20expired\x20token'});_0x56d2fb[_0x28c91c(0x154)]=_0x18ba4d,_0x56d2fb[_0x28c91c(0x153)]=_0x179175,_0x3be310();});};exports[a18_0x287783(0x142)]=authenticateToken;const requireAdmin=(_0x15db65,_0x440230,_0x225405)=>{const _0xc82dfa=a18_0x287783;if(!_0x15db65[_0xc82dfa(0x154)]||_0x15db65['user'][_0xc82dfa(0x131)]!==_0xc82dfa(0x152))return _0x440230[_0xc82dfa(0x13f)](0x193)['json']({'success':![],'message':_0xc82dfa(0x14c)});_0x225405();};function a18_0x4c31(_0x21dca8,_0x3bcf14){const _0x1f2bf6=a18_0x1f2b();return a18_0x4c31=function(_0x4c314b,_0x462f5b){_0x4c314b=_0x4c314b-0x12e;let _0x3ddcc5=_0x1f2bf6[_0x4c314b];return _0x3ddcc5;},a18_0x4c31(_0x21dca8,_0x3bcf14);}exports[a18_0x287783(0x148)]=requireAdmin;const requireShop=(_0x52c606,_0x3fb49d,_0x113a29)=>{const _0x27dbb6=a18_0x287783;if(!_0x52c606[_0x27dbb6(0x154)]||_0x52c606[_0x27dbb6(0x154)][_0x27dbb6(0x131)]!==_0x27dbb6(0x151))return _0x3fb49d[_0x27dbb6(0x13f)](0x193)['json']({'success':![],'message':'Shop\x20access\x20required'});_0x113a29();};exports[a18_0x287783(0x14e)]=requireShop;const requireActiveShop=async(_0x4281dd,_0x2cfc36,_0x390267)=>{const _0x303d5d=a18_0x287783;if(!_0x4281dd[_0x303d5d(0x154)]||_0x4281dd[_0x303d5d(0x154)]['role']!=='shop')return _0x2cfc36['status'](0x193)[_0x303d5d(0x145)]({'success':![],'message':_0x303d5d(0x140)});try{const _0x94361f=require(_0x303d5d(0x13a))['default'],_0x6c58c8=await _0x94361f[_0x303d5d(0x151)][_0x303d5d(0x138)]({'where':{'id':_0x4281dd[_0x303d5d(0x154)]['id']},'select':{'status':!![]}});if(!_0x6c58c8||_0x6c58c8[_0x303d5d(0x13f)]!=='ACTIVE')return _0x2cfc36[_0x303d5d(0x13f)](0x193)[_0x303d5d(0x145)]({'success':![],'message':'Account\x20is\x20suspended\x20or\x20inactive.\x20Contact\x20administrator\x20to\x20activate\x20your\x20account.','suspended':_0x6c58c8?.[_0x303d5d(0x13f)]===_0x303d5d(0x156)});_0x390267();}catch(_0x4e3b0c){return console[_0x303d5d(0x136)](_0x303d5d(0x13c),_0x4e3b0c),_0x2cfc36[_0x303d5d(0x13f)](0x1f4)[_0x303d5d(0x145)]({'success':![],'message':_0x303d5d(0x14d)});}};exports[a18_0x287783(0x155)]=requireActiveShop;