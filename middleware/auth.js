'use strict';const a23_0x308eed=a23_0x1865;function a23_0x3d16(){const _0x35cd91=['requireActiveShop','27ZyMcwB','3155856hcPaEP','findUnique','verify','requireShop','requireAdmin','config','30722unZzOX','1328327pQrnnA','defineProperty','shop','split','63HjAsuW','__importDefault','../config/database','json','ACTIVE','Invalid\x20or\x20expired\x20token','Token\x20has\x20been\x20revoked','jsonwebtoken','error','authorization','Shop\x20access\x20required','Error\x20checking\x20account\x20status','SUSPENDED','12QRrvCv','__esModule','status','secret','default','313660JXZYyZ','tokenBlacklistService','authenticateToken','headers','Error\x20checking\x20account\x20status:','193304CbMHuR','Admin\x20access\x20required','4504160uWOoBJ','isTokenBlacklisted','11360NfmuoB','role','user','584avEcgJ','Access\x20token\x20required'];a23_0x3d16=function(){return _0x35cd91;};return a23_0x3d16();}(function(_0x2c3551,_0x1d27c9){const _0x3cf67a=a23_0x1865,_0x5a3a2b=_0x2c3551();while(!![]){try{const _0x251d53=-parseInt(_0x3cf67a(0x1ca))/0x1+-parseInt(_0x3cf67a(0x1e0))/0x2*(-parseInt(_0x3cf67a(0x1d9))/0x3)+parseInt(_0x3cf67a(0x1d6))/0x4*(parseInt(_0x3cf67a(0x1d3))/0x5)+-parseInt(_0x3cf67a(0x1f2))/0x6*(-parseInt(_0x3cf67a(0x1e1))/0x7)+-parseInt(_0x3cf67a(0x1cf))/0x8*(-parseInt(_0x3cf67a(0x1e5))/0x9)+-parseInt(_0x3cf67a(0x1d1))/0xa+parseInt(_0x3cf67a(0x1da))/0xb;if(_0x251d53===_0x1d27c9)break;else _0x5a3a2b['push'](_0x5a3a2b['shift']());}catch(_0x4eb6f6){_0x5a3a2b['push'](_0x5a3a2b['shift']());}}}(a23_0x3d16,0x84304));var __importDefault=this&&this[a23_0x308eed(0x1e6)]||function(_0x32c5c3){const _0xcb31e4=a23_0x308eed;return _0x32c5c3&&_0x32c5c3[_0xcb31e4(0x1f3)]?_0x32c5c3:{'default':_0x32c5c3};};Object[a23_0x308eed(0x1e2)](exports,a23_0x308eed(0x1f3),{'value':!![]}),exports[a23_0x308eed(0x1d8)]=exports['requireShop']=exports[a23_0x308eed(0x1de)]=exports[a23_0x308eed(0x1cc)]=void 0x0;const jsonwebtoken_1=__importDefault(require(a23_0x308eed(0x1ec))),config_1=require('../config/config'),tokenBlacklistService_1=require('../services/tokenBlacklistService'),authenticateToken=(_0x23fc03,_0x59b3c9,_0x213e8e)=>{const _0x44c406=a23_0x308eed,_0x417d10=_0x23fc03[_0x44c406(0x1cd)][_0x44c406(0x1ee)],_0x11d563=_0x417d10&&_0x417d10[_0x44c406(0x1e4)]('\x20')[0x1];if(!_0x11d563)return _0x59b3c9[_0x44c406(0x1f4)](0x191)[_0x44c406(0x1e8)]({'success':![],'message':_0x44c406(0x1d7)});if(tokenBlacklistService_1[_0x44c406(0x1cb)][_0x44c406(0x1d2)](_0x11d563))return _0x59b3c9[_0x44c406(0x1f4)](0x191)[_0x44c406(0x1e8)]({'success':![],'message':_0x44c406(0x1eb)});jsonwebtoken_1[_0x44c406(0x1c9)][_0x44c406(0x1dc)](_0x11d563,config_1[_0x44c406(0x1df)]['jwt'][_0x44c406(0x1f5)],(_0x544992,_0x4f13b7)=>{const _0x56eace=_0x44c406;if(_0x544992)return _0x59b3c9[_0x56eace(0x1f4)](0x193)[_0x56eace(0x1e8)]({'success':![],'message':_0x56eace(0x1ea)});_0x23fc03[_0x56eace(0x1d5)]=_0x4f13b7,_0x23fc03['token']=_0x11d563,_0x213e8e();});};exports[a23_0x308eed(0x1cc)]=authenticateToken;const requireAdmin=(_0x308464,_0x403c72,_0x18e3b8)=>{const _0x53ab96=a23_0x308eed;if(!_0x308464['user']||_0x308464['user'][_0x53ab96(0x1d4)]!=='admin')return _0x403c72[_0x53ab96(0x1f4)](0x193)['json']({'success':![],'message':_0x53ab96(0x1d0)});_0x18e3b8();};exports[a23_0x308eed(0x1de)]=requireAdmin;function a23_0x1865(_0x280858,_0x490d3c){_0x280858=_0x280858-0x1c9;const _0x3d16e6=a23_0x3d16();let _0x186533=_0x3d16e6[_0x280858];return _0x186533;}const requireShop=(_0x1b12fe,_0x43cbf6,_0x195fcc)=>{const _0x4b25be=a23_0x308eed;if(!_0x1b12fe['user']||_0x1b12fe['user'][_0x4b25be(0x1d4)]!==_0x4b25be(0x1e3))return _0x43cbf6['status'](0x193)['json']({'success':![],'message':_0x4b25be(0x1ef)});_0x195fcc();};exports[a23_0x308eed(0x1dd)]=requireShop;const requireActiveShop=async(_0x5040d2,_0x59e516,_0x59916b)=>{const _0x541f27=a23_0x308eed;if(!_0x5040d2[_0x541f27(0x1d5)]||_0x5040d2[_0x541f27(0x1d5)][_0x541f27(0x1d4)]!=='shop')return _0x59e516[_0x541f27(0x1f4)](0x193)[_0x541f27(0x1e8)]({'success':![],'message':_0x541f27(0x1ef)});try{const _0x1b2b4e=require(_0x541f27(0x1e7))[_0x541f27(0x1c9)],_0x28130f=await _0x1b2b4e[_0x541f27(0x1e3)][_0x541f27(0x1db)]({'where':{'id':_0x5040d2[_0x541f27(0x1d5)]['id']},'select':{'status':!![]}});if(!_0x28130f||_0x28130f[_0x541f27(0x1f4)]!==_0x541f27(0x1e9))return _0x59e516[_0x541f27(0x1f4)](0x193)['json']({'success':![],'message':'Account\x20is\x20suspended\x20or\x20inactive.\x20Contact\x20administrator\x20to\x20activate\x20your\x20account.','suspended':_0x28130f?.[_0x541f27(0x1f4)]===_0x541f27(0x1f1)});_0x59916b();}catch(_0x460a4c){return console[_0x541f27(0x1ed)](_0x541f27(0x1ce),_0x460a4c),_0x59e516['status'](0x1f4)[_0x541f27(0x1e8)]({'success':![],'message':_0x541f27(0x1f0)});}};exports['requireActiveShop']=requireActiveShop;