'use strict';const a16_0x3eb7f6=a16_0x1a2d;(function(_0x2db062,_0x54a915){const _0xf6c214=a16_0x1a2d,_0x41476e=_0x2db062();while(!![]){try{const _0x57f028=-parseInt(_0xf6c214(0x8e))/0x1*(parseInt(_0xf6c214(0x9b))/0x2)+parseInt(_0xf6c214(0x90))/0x3*(-parseInt(_0xf6c214(0x96))/0x4)+-parseInt(_0xf6c214(0xa8))/0x5+-parseInt(_0xf6c214(0x8c))/0x6+parseInt(_0xf6c214(0xb4))/0x7+parseInt(_0xf6c214(0x99))/0x8*(parseInt(_0xf6c214(0xab))/0x9)+parseInt(_0xf6c214(0xaf))/0xa*(parseInt(_0xf6c214(0x93))/0xb);if(_0x57f028===_0x54a915)break;else _0x41476e['push'](_0x41476e['shift']());}catch(_0x378c4e){_0x41476e['push'](_0x41476e['shift']());}}}(a16_0x4418,0x975ad));var __importDefault=this&&this[a16_0x3eb7f6(0xad)]||function(_0x807497){const _0x3e7420=a16_0x3eb7f6;return _0x807497&&_0x807497[_0x3e7420(0x9d)]?_0x807497:{'default':_0x807497};};function a16_0x1a2d(_0x2cdb5a,_0x50379e){const _0x44189f=a16_0x4418();return a16_0x1a2d=function(_0x1a2d81,_0x1a13bf){_0x1a2d81=_0x1a2d81-0x8c;let _0x297c55=_0x44189f[_0x1a2d81];return _0x297c55;},a16_0x1a2d(_0x2cdb5a,_0x50379e);}Object['defineProperty'](exports,'__esModule',{'value':!![]}),exports[a16_0x3eb7f6(0x95)]=exports['requireShop']=exports[a16_0x3eb7f6(0xa5)]=exports['authenticateToken']=void 0x0;const jsonwebtoken_1=__importDefault(require(a16_0x3eb7f6(0x98))),config_1=require(a16_0x3eb7f6(0xac)),tokenBlacklistService_1=require(a16_0x3eb7f6(0x9c)),authenticateToken=(_0x52a1d5,_0xaa52df,_0x16a6b4)=>{const _0x59f667=a16_0x3eb7f6,_0x4ca8a6=_0x52a1d5[_0x59f667(0x8f)][_0x59f667(0x91)],_0x498172=_0x4ca8a6&&_0x4ca8a6[_0x59f667(0xa9)]('\x20')[0x1];if(!_0x498172)return _0xaa52df[_0x59f667(0xae)](0x191)[_0x59f667(0x92)]({'success':![],'message':'Access\x20token\x20required'});if(tokenBlacklistService_1[_0x59f667(0xa0)][_0x59f667(0x9f)](_0x498172))return _0xaa52df['status'](0x191)['json']({'success':![],'message':_0x59f667(0xb0)});jsonwebtoken_1[_0x59f667(0xa3)][_0x59f667(0xb2)](_0x498172,config_1['config']['jwt'][_0x59f667(0xa1)],(_0x243f7d,_0xe9163f)=>{const _0xf80711=_0x59f667;if(_0x243f7d)return _0xaa52df[_0xf80711(0xae)](0x193)[_0xf80711(0x92)]({'success':![],'message':_0xf80711(0x9e)});_0x52a1d5[_0xf80711(0xb5)]=_0xe9163f,_0x52a1d5[_0xf80711(0xa7)]=_0x498172,_0x16a6b4();});};exports[a16_0x3eb7f6(0xb1)]=authenticateToken;function a16_0x4418(){const _0x19b327=['Account\x20is\x20suspended\x20or\x20inactive.\x20Contact\x20administrator\x20to\x20activate\x20your\x20account.','jsonwebtoken','994856MOuoYI','ACTIVE','42628txslYO','../services/tokenBlacklistService','__esModule','Invalid\x20or\x20expired\x20token','isTokenBlacklisted','tokenBlacklistService','secret','admin','default','Error\x20checking\x20account\x20status','requireAdmin','../config/database','token','960475neaeml','split','role','45HwJSqd','../config/config','__importDefault','status','30KWhQNn','Token\x20has\x20been\x20revoked','authenticateToken','verify','Shop\x20access\x20required','5175786NtcTKT','user','requireShop','Error\x20checking\x20account\x20status:','84174szxykR','Admin\x20access\x20required','22kVNLQB','headers','21PQmMmr','authorization','json','1872629eKKIIH','shop','requireActiveShop','329668tfgvcq'];a16_0x4418=function(){return _0x19b327;};return a16_0x4418();}const requireAdmin=(_0x53787b,_0x55071e,_0x164680)=>{const _0x15a6b8=a16_0x3eb7f6;if(!_0x53787b[_0x15a6b8(0xb5)]||_0x53787b[_0x15a6b8(0xb5)][_0x15a6b8(0xaa)]!==_0x15a6b8(0xa2))return _0x55071e[_0x15a6b8(0xae)](0x193)[_0x15a6b8(0x92)]({'success':![],'message':_0x15a6b8(0x8d)});_0x164680();};exports[a16_0x3eb7f6(0xa5)]=requireAdmin;const requireShop=(_0x2d956d,_0x363ba3,_0xbaecd1)=>{const _0xc2bc81=a16_0x3eb7f6;if(!_0x2d956d['user']||_0x2d956d[_0xc2bc81(0xb5)][_0xc2bc81(0xaa)]!==_0xc2bc81(0x94))return _0x363ba3[_0xc2bc81(0xae)](0x193)[_0xc2bc81(0x92)]({'success':![],'message':'Shop\x20access\x20required'});_0xbaecd1();};exports[a16_0x3eb7f6(0xb6)]=requireShop;const requireActiveShop=async(_0x442edc,_0x3d1485,_0x3857b4)=>{const _0x115a89=a16_0x3eb7f6;if(!_0x442edc['user']||_0x442edc[_0x115a89(0xb5)]['role']!==_0x115a89(0x94))return _0x3d1485[_0x115a89(0xae)](0x193)[_0x115a89(0x92)]({'success':![],'message':_0x115a89(0xb3)});try{const _0x20aaae=require(_0x115a89(0xa6))[_0x115a89(0xa3)],_0x217bbb=await _0x20aaae[_0x115a89(0x94)]['findUnique']({'where':{'id':_0x442edc[_0x115a89(0xb5)]['id']},'select':{'status':!![]}});if(!_0x217bbb||_0x217bbb['status']!==_0x115a89(0x9a))return _0x3d1485[_0x115a89(0xae)](0x193)[_0x115a89(0x92)]({'success':![],'message':_0x115a89(0x97),'suspended':_0x217bbb?.[_0x115a89(0xae)]==='SUSPENDED'});_0x3857b4();}catch(_0x1d166c){return console['error'](_0x115a89(0xb7),_0x1d166c),_0x3d1485[_0x115a89(0xae)](0x1f4)[_0x115a89(0x92)]({'success':![],'message':_0x115a89(0xa4)});}};exports[a16_0x3eb7f6(0x95)]=requireActiveShop;