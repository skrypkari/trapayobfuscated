'use strict';const a16_0x4a8b32=a16_0x37bd;(function(_0x14146c,_0x249ecc){const _0x1fb7ae=a16_0x37bd,_0x5eaef1=_0x14146c();while(!![]){try{const _0x1ba534=parseInt(_0x1fb7ae(0xa1))/0x1+-parseInt(_0x1fb7ae(0x9b))/0x2+parseInt(_0x1fb7ae(0x87))/0x3+parseInt(_0x1fb7ae(0x96))/0x4*(-parseInt(_0x1fb7ae(0x93))/0x5)+-parseInt(_0x1fb7ae(0x7e))/0x6+parseInt(_0x1fb7ae(0x89))/0x7+parseInt(_0x1fb7ae(0x8e))/0x8*(parseInt(_0x1fb7ae(0x9a))/0x9);if(_0x1ba534===_0x249ecc)break;else _0x5eaef1['push'](_0x5eaef1['shift']());}catch(_0x38a261){_0x5eaef1['push'](_0x5eaef1['shift']());}}}(a16_0x4645,0xccd99));function a16_0x4645(){const _0x288605=['isTokenBlacklisted','Error\x20checking\x20account\x20status','authenticateToken','Account\x20is\x20suspended\x20or\x20inactive.\x20Contact\x20administrator\x20to\x20activate\x20your\x20account.','Access\x20token\x20required','171873HTljJS','Shop\x20access\x20required','Admin\x20access\x20required','authorization','requireAdmin','Token\x20has\x20been\x20revoked','user','9390918uyYWsy','shop','requireShop','__esModule','Invalid\x20or\x20expired\x20token','verify','../services/tokenBlacklistService','split','../config/config','3250494gghNKX','status','6122046ajZanP','findUnique','../config/database','requireActiveShop','headers','1272688CQCfMQ','token','role','json','SUSPENDED','5541010HNIJik','defineProperty','tokenBlacklistService','4rNkvvl','default','admin','jwt','99FskWdp','734950YfGtLg'];a16_0x4645=function(){return _0x288605;};return a16_0x4645();}function a16_0x37bd(_0x51290c,_0x5082f3){const _0x464511=a16_0x4645();return a16_0x37bd=function(_0x37bd23,_0x57f148){_0x37bd23=_0x37bd23-0x7c;let _0x142575=_0x464511[_0x37bd23];return _0x142575;},a16_0x37bd(_0x51290c,_0x5082f3);}var __importDefault=this&&this['__importDefault']||function(_0x2e90e3){const _0x32b5c6=a16_0x37bd;return _0x2e90e3&&_0x2e90e3[_0x32b5c6(0x81)]?_0x2e90e3:{'default':_0x2e90e3};};Object[a16_0x4a8b32(0x94)](exports,'__esModule',{'value':!![]}),exports[a16_0x4a8b32(0x8c)]=exports[a16_0x4a8b32(0x80)]=exports[a16_0x4a8b32(0xa5)]=exports['authenticateToken']=void 0x0;const jsonwebtoken_1=__importDefault(require('jsonwebtoken')),config_1=require(a16_0x4a8b32(0x86)),tokenBlacklistService_1=require(a16_0x4a8b32(0x84)),authenticateToken=(_0x3585fe,_0x209cb9,_0x395ae1)=>{const _0x58dbe3=a16_0x4a8b32,_0x2b18d4=_0x3585fe[_0x58dbe3(0x8d)][_0x58dbe3(0xa4)],_0x36442e=_0x2b18d4&&_0x2b18d4[_0x58dbe3(0x85)]('\x20')[0x1];if(!_0x36442e)return _0x209cb9[_0x58dbe3(0x88)](0x191)['json']({'success':![],'message':_0x58dbe3(0xa0)});if(tokenBlacklistService_1[_0x58dbe3(0x95)][_0x58dbe3(0x9c)](_0x36442e))return _0x209cb9[_0x58dbe3(0x88)](0x191)[_0x58dbe3(0x91)]({'success':![],'message':_0x58dbe3(0x7c)});jsonwebtoken_1[_0x58dbe3(0x97)][_0x58dbe3(0x83)](_0x36442e,config_1['config'][_0x58dbe3(0x99)]['secret'],(_0x3c747b,_0x4b9322)=>{const _0x33d19a=_0x58dbe3;if(_0x3c747b)return _0x209cb9['status'](0x193)['json']({'success':![],'message':_0x33d19a(0x82)});_0x3585fe[_0x33d19a(0x7d)]=_0x4b9322,_0x3585fe[_0x33d19a(0x8f)]=_0x36442e,_0x395ae1();});};exports[a16_0x4a8b32(0x9e)]=authenticateToken;const requireAdmin=(_0x526fde,_0x260ee0,_0x4bb3d4)=>{const _0x5c980f=a16_0x4a8b32;if(!_0x526fde['user']||_0x526fde[_0x5c980f(0x7d)][_0x5c980f(0x90)]!==_0x5c980f(0x98))return _0x260ee0[_0x5c980f(0x88)](0x193)[_0x5c980f(0x91)]({'success':![],'message':_0x5c980f(0xa3)});_0x4bb3d4();};exports[a16_0x4a8b32(0xa5)]=requireAdmin;const requireShop=(_0x409cef,_0x496fbc,_0x442987)=>{const _0xa3dae6=a16_0x4a8b32;if(!_0x409cef[_0xa3dae6(0x7d)]||_0x409cef[_0xa3dae6(0x7d)][_0xa3dae6(0x90)]!==_0xa3dae6(0x7f))return _0x496fbc['status'](0x193)[_0xa3dae6(0x91)]({'success':![],'message':_0xa3dae6(0xa2)});_0x442987();};exports[a16_0x4a8b32(0x80)]=requireShop;const requireActiveShop=async(_0x507a8e,_0x395fc2,_0xaa633d)=>{const _0x6db4dc=a16_0x4a8b32;if(!_0x507a8e['user']||_0x507a8e['user']['role']!=='shop')return _0x395fc2['status'](0x193)[_0x6db4dc(0x91)]({'success':![],'message':'Shop\x20access\x20required'});try{const _0x35b317=require(_0x6db4dc(0x8b))[_0x6db4dc(0x97)],_0x17d87e=await _0x35b317[_0x6db4dc(0x7f)][_0x6db4dc(0x8a)]({'where':{'id':_0x507a8e['user']['id']},'select':{'status':!![]}});if(!_0x17d87e||_0x17d87e[_0x6db4dc(0x88)]!=='ACTIVE')return _0x395fc2[_0x6db4dc(0x88)](0x193)['json']({'success':![],'message':_0x6db4dc(0x9f),'suspended':_0x17d87e?.[_0x6db4dc(0x88)]===_0x6db4dc(0x92)});_0xaa633d();}catch(_0x4d58ce){return console['error']('Error\x20checking\x20account\x20status:',_0x4d58ce),_0x395fc2[_0x6db4dc(0x88)](0x1f4)[_0x6db4dc(0x91)]({'success':![],'message':_0x6db4dc(0x9d)});}};exports['requireActiveShop']=requireActiveShop;