'use strict';const a16_0x3d9e5d=a16_0x91bc;(function(_0x19e895,_0x2cf114){const _0x5a8c20=a16_0x91bc,_0x39d51f=_0x19e895();while(!![]){try{const _0x302074=parseInt(_0x5a8c20(0x118))/0x1*(-parseInt(_0x5a8c20(0x11e))/0x2)+-parseInt(_0x5a8c20(0x10e))/0x3*(-parseInt(_0x5a8c20(0x10b))/0x4)+parseInt(_0x5a8c20(0x103))/0x5+-parseInt(_0x5a8c20(0xfb))/0x6*(parseInt(_0x5a8c20(0x10c))/0x7)+-parseInt(_0x5a8c20(0x11f))/0x8*(parseInt(_0x5a8c20(0x100))/0x9)+parseInt(_0x5a8c20(0xfc))/0xa*(-parseInt(_0x5a8c20(0x104))/0xb)+parseInt(_0x5a8c20(0x102))/0xc*(parseInt(_0x5a8c20(0x11c))/0xd);if(_0x302074===_0x2cf114)break;else _0x39d51f['push'](_0x39d51f['shift']());}catch(_0x22b8e2){_0x39d51f['push'](_0x39d51f['shift']());}}}(a16_0xe550,0x5197f));var __importDefault=this&&this[a16_0x3d9e5d(0x124)]||function(_0x501ec0){const _0x364332=a16_0x3d9e5d;return _0x501ec0&&_0x501ec0[_0x364332(0xfd)]?_0x501ec0:{'default':_0x501ec0};};Object[a16_0x3d9e5d(0x121)](exports,a16_0x3d9e5d(0xfd),{'value':!![]}),exports[a16_0x3d9e5d(0x120)]=exports[a16_0x3d9e5d(0x113)]=exports['requireAdmin']=exports['authenticateToken']=void 0x0;function a16_0xe550(){const _0x188078=['../config/database','shop','role','18IbPwNI','1747210jSGLhw','__esModule','default','tokenBlacklistService','33381EPAWqD','authorization','13160904qItghM','1379060xzgXpB','11HitlBM','json','jwt','Error\x20checking\x20account\x20status:','Admin\x20access\x20required','jsonwebtoken','token','4dGjlvL','567854Ltajjk','split','217608QFQvYd','Error\x20checking\x20account\x20status','verify','../services/tokenBlacklistService','ACTIVE','requireShop','status','Invalid\x20or\x20expired\x20token','admin','isTokenBlacklisted','32834AEINWk','config','Token\x20has\x20been\x20revoked','error','13Boaznz','user','30YtSIaR','432sAGXyL','requireActiveShop','defineProperty','Shop\x20access\x20required','Access\x20token\x20required','__importDefault','Account\x20is\x20suspended\x20or\x20inactive.\x20Contact\x20administrator\x20to\x20activate\x20your\x20account.'];a16_0xe550=function(){return _0x188078;};return a16_0xe550();}function a16_0x91bc(_0x54f78a,_0x29e265){const _0xe55027=a16_0xe550();return a16_0x91bc=function(_0x91bc87,_0x53686e){_0x91bc87=_0x91bc87-0xfa;let _0x2da024=_0xe55027[_0x91bc87];return _0x2da024;},a16_0x91bc(_0x54f78a,_0x29e265);}const jsonwebtoken_1=__importDefault(require(a16_0x3d9e5d(0x109))),config_1=require('../config/config'),tokenBlacklistService_1=require(a16_0x3d9e5d(0x111)),authenticateToken=(_0x3c3502,_0x573542,_0x555d92)=>{const _0x3fcef4=a16_0x3d9e5d,_0x518041=_0x3c3502['headers'][_0x3fcef4(0x101)],_0x36cb9e=_0x518041&&_0x518041[_0x3fcef4(0x10d)]('\x20')[0x1];if(!_0x36cb9e)return _0x573542[_0x3fcef4(0x114)](0x191)[_0x3fcef4(0x105)]({'success':![],'message':_0x3fcef4(0x123)});if(tokenBlacklistService_1[_0x3fcef4(0xff)][_0x3fcef4(0x117)](_0x36cb9e))return _0x573542[_0x3fcef4(0x114)](0x191)['json']({'success':![],'message':_0x3fcef4(0x11a)});jsonwebtoken_1[_0x3fcef4(0xfe)][_0x3fcef4(0x110)](_0x36cb9e,config_1[_0x3fcef4(0x119)][_0x3fcef4(0x106)]['secret'],(_0x54a4e8,_0x4b3771)=>{const _0x52eb4d=_0x3fcef4;if(_0x54a4e8)return _0x573542[_0x52eb4d(0x114)](0x193)[_0x52eb4d(0x105)]({'success':![],'message':_0x52eb4d(0x115)});_0x3c3502[_0x52eb4d(0x11d)]=_0x4b3771,_0x3c3502[_0x52eb4d(0x10a)]=_0x36cb9e,_0x555d92();});};exports['authenticateToken']=authenticateToken;const requireAdmin=(_0x38c5cb,_0x3d68b8,_0x2c49f0)=>{const _0x1cde9d=a16_0x3d9e5d;if(!_0x38c5cb[_0x1cde9d(0x11d)]||_0x38c5cb['user'][_0x1cde9d(0xfa)]!==_0x1cde9d(0x116))return _0x3d68b8['status'](0x193)[_0x1cde9d(0x105)]({'success':![],'message':_0x1cde9d(0x108)});_0x2c49f0();};exports['requireAdmin']=requireAdmin;const requireShop=(_0x4b010a,_0x3d4f91,_0x31a9d2)=>{const _0x1876f7=a16_0x3d9e5d;if(!_0x4b010a[_0x1876f7(0x11d)]||_0x4b010a['user']['role']!==_0x1876f7(0x127))return _0x3d4f91['status'](0x193)[_0x1876f7(0x105)]({'success':![],'message':_0x1876f7(0x122)});_0x31a9d2();};exports[a16_0x3d9e5d(0x113)]=requireShop;const requireActiveShop=async(_0x5b83b5,_0x56a99e,_0x2fcc6f)=>{const _0x3daaf0=a16_0x3d9e5d;if(!_0x5b83b5['user']||_0x5b83b5[_0x3daaf0(0x11d)]['role']!==_0x3daaf0(0x127))return _0x56a99e[_0x3daaf0(0x114)](0x193)[_0x3daaf0(0x105)]({'success':![],'message':_0x3daaf0(0x122)});try{const _0x405c38=require(_0x3daaf0(0x126))['default'],_0x2b2204=await _0x405c38[_0x3daaf0(0x127)]['findUnique']({'where':{'id':_0x5b83b5['user']['id']},'select':{'status':!![]}});if(!_0x2b2204||_0x2b2204['status']!==_0x3daaf0(0x112))return _0x56a99e[_0x3daaf0(0x114)](0x193)[_0x3daaf0(0x105)]({'success':![],'message':_0x3daaf0(0x125),'suspended':_0x2b2204?.[_0x3daaf0(0x114)]==='SUSPENDED'});_0x2fcc6f();}catch(_0x364c0f){return console[_0x3daaf0(0x11b)](_0x3daaf0(0x107),_0x364c0f),_0x56a99e[_0x3daaf0(0x114)](0x1f4)[_0x3daaf0(0x105)]({'success':![],'message':_0x3daaf0(0x10f)});}};exports[a16_0x3d9e5d(0x120)]=requireActiveShop;