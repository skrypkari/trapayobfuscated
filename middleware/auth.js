'use strict';const a17_0x362322=a17_0x4a92;(function(_0x3631da,_0x5abc15){const _0x1edfd3=a17_0x4a92,_0x76c112=_0x3631da();while(!![]){try{const _0x551371=parseInt(_0x1edfd3(0x1cc))/0x1*(parseInt(_0x1edfd3(0x1b5))/0x2)+parseInt(_0x1edfd3(0x1dc))/0x3+-parseInt(_0x1edfd3(0x1c5))/0x4*(-parseInt(_0x1edfd3(0x1c0))/0x5)+-parseInt(_0x1edfd3(0x1ca))/0x6+parseInt(_0x1edfd3(0x1cf))/0x7*(-parseInt(_0x1edfd3(0x1d6))/0x8)+-parseInt(_0x1edfd3(0x1b9))/0x9+-parseInt(_0x1edfd3(0x1cb))/0xa;if(_0x551371===_0x5abc15)break;else _0x76c112['push'](_0x76c112['shift']());}catch(_0x2ff0dd){_0x76c112['push'](_0x76c112['shift']());}}}(a17_0x1c46,0x609aa));var __importDefault=this&&this[a17_0x362322(0x1ba)]||function(_0x2826aa){const _0x2203b3=a17_0x362322;return _0x2826aa&&_0x2826aa[_0x2203b3(0x1db)]?_0x2826aa:{'default':_0x2826aa};};function a17_0x1c46(){const _0xd24c5c=['3382290zANBjd','__importDefault','json','role','SUSPENDED','isTokenBlacklisted','admin','645DJPKhF','user','secret','findUnique','Token\x20has\x20been\x20revoked','15888wVPVhV','default','Error\x20checking\x20account\x20status:','requireAdmin','shop','201354laLYBU','1826080NYUusI','198QcWlQY','requireActiveShop','Shop\x20access\x20required','21BFdYsT','config','status','authorization','../config/database','Account\x20is\x20suspended\x20or\x20inactive.\x20Contact\x20administrator\x20to\x20activate\x20your\x20account.','../config/config','1270376bMzYtn','split','../services/tokenBlacklistService','jwt','requireShop','__esModule','1242300Eymvxs','defineProperty','5430przzoU','Error\x20checking\x20account\x20status','jsonwebtoken','authenticateToken'];a17_0x1c46=function(){return _0xd24c5c;};return a17_0x1c46();}Object[a17_0x362322(0x1dd)](exports,a17_0x362322(0x1db),{'value':!![]}),exports[a17_0x362322(0x1cd)]=exports['requireShop']=exports['requireAdmin']=exports[a17_0x362322(0x1b8)]=void 0x0;const jsonwebtoken_1=__importDefault(require(a17_0x362322(0x1b7))),config_1=require(a17_0x362322(0x1d5)),tokenBlacklistService_1=require(a17_0x362322(0x1d8)),authenticateToken=(_0x16b2d3,_0x2b3850,_0x5deef1)=>{const _0x3e91c2=a17_0x362322,_0x50ec8c=_0x16b2d3['headers'][_0x3e91c2(0x1d2)],_0x219c89=_0x50ec8c&&_0x50ec8c[_0x3e91c2(0x1d7)]('\x20')[0x1];if(!_0x219c89)return _0x2b3850[_0x3e91c2(0x1d1)](0x191)[_0x3e91c2(0x1bb)]({'success':![],'message':'Access\x20token\x20required'});if(tokenBlacklistService_1['tokenBlacklistService'][_0x3e91c2(0x1be)](_0x219c89))return _0x2b3850[_0x3e91c2(0x1d1)](0x191)[_0x3e91c2(0x1bb)]({'success':![],'message':_0x3e91c2(0x1c4)});jsonwebtoken_1[_0x3e91c2(0x1c6)]['verify'](_0x219c89,config_1[_0x3e91c2(0x1d0)][_0x3e91c2(0x1d9)][_0x3e91c2(0x1c2)],(_0x1eb33f,_0x996bf5)=>{const _0x201a31=_0x3e91c2;if(_0x1eb33f)return _0x2b3850[_0x201a31(0x1d1)](0x193)[_0x201a31(0x1bb)]({'success':![],'message':'Invalid\x20or\x20expired\x20token'});_0x16b2d3['user']=_0x996bf5,_0x16b2d3['token']=_0x219c89,_0x5deef1();});};exports[a17_0x362322(0x1b8)]=authenticateToken;const requireAdmin=(_0x401616,_0x5884a6,_0x5540d4)=>{const _0x339122=a17_0x362322;if(!_0x401616[_0x339122(0x1c1)]||_0x401616[_0x339122(0x1c1)][_0x339122(0x1bc)]!==_0x339122(0x1bf))return _0x5884a6[_0x339122(0x1d1)](0x193)[_0x339122(0x1bb)]({'success':![],'message':'Admin\x20access\x20required'});_0x5540d4();};exports[a17_0x362322(0x1c8)]=requireAdmin;function a17_0x4a92(_0x1f71c9,_0xdb938f){const _0x1c46a6=a17_0x1c46();return a17_0x4a92=function(_0x4a9210,_0x96d62a){_0x4a9210=_0x4a9210-0x1b5;let _0x398680=_0x1c46a6[_0x4a9210];return _0x398680;},a17_0x4a92(_0x1f71c9,_0xdb938f);}const requireShop=(_0x546732,_0x8bb4a7,_0x41629a)=>{const _0x3b770d=a17_0x362322;if(!_0x546732[_0x3b770d(0x1c1)]||_0x546732[_0x3b770d(0x1c1)]['role']!==_0x3b770d(0x1c9))return _0x8bb4a7[_0x3b770d(0x1d1)](0x193)[_0x3b770d(0x1bb)]({'success':![],'message':_0x3b770d(0x1ce)});_0x41629a();};exports[a17_0x362322(0x1da)]=requireShop;const requireActiveShop=async(_0x1378ed,_0x47a4f5,_0xb8701b)=>{const _0x4fd5b2=a17_0x362322;if(!_0x1378ed[_0x4fd5b2(0x1c1)]||_0x1378ed[_0x4fd5b2(0x1c1)]['role']!==_0x4fd5b2(0x1c9))return _0x47a4f5['status'](0x193)[_0x4fd5b2(0x1bb)]({'success':![],'message':_0x4fd5b2(0x1ce)});try{const _0x4f4b52=require(_0x4fd5b2(0x1d3))[_0x4fd5b2(0x1c6)],_0x4809a1=await _0x4f4b52['shop'][_0x4fd5b2(0x1c3)]({'where':{'id':_0x1378ed[_0x4fd5b2(0x1c1)]['id']},'select':{'status':!![]}});if(!_0x4809a1||_0x4809a1['status']!=='ACTIVE')return _0x47a4f5['status'](0x193)['json']({'success':![],'message':_0x4fd5b2(0x1d4),'suspended':_0x4809a1?.[_0x4fd5b2(0x1d1)]===_0x4fd5b2(0x1bd)});_0xb8701b();}catch(_0x2bdd63){return console['error'](_0x4fd5b2(0x1c7),_0x2bdd63),_0x47a4f5['status'](0x1f4)[_0x4fd5b2(0x1bb)]({'success':![],'message':_0x4fd5b2(0x1b6)});}};exports[a17_0x362322(0x1cd)]=requireActiveShop;