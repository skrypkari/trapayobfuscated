'use strict';const a24_0x5871af=a24_0xb222;(function(_0x30e5e6,_0x40a0e3){const _0x86a7ba=a24_0xb222,_0x556e40=_0x30e5e6();while(!![]){try{const _0x21e72d=parseInt(_0x86a7ba(0x15a))/0x1+parseInt(_0x86a7ba(0x166))/0x2*(parseInt(_0x86a7ba(0x150))/0x3)+-parseInt(_0x86a7ba(0x161))/0x4*(-parseInt(_0x86a7ba(0x14c))/0x5)+parseInt(_0x86a7ba(0x13d))/0x6*(-parseInt(_0x86a7ba(0x144))/0x7)+parseInt(_0x86a7ba(0x147))/0x8+-parseInt(_0x86a7ba(0x148))/0x9+-parseInt(_0x86a7ba(0x13b))/0xa;if(_0x21e72d===_0x40a0e3)break;else _0x556e40['push'](_0x556e40['shift']());}catch(_0x1c748f){_0x556e40['push'](_0x556e40['shift']());}}}(a24_0x42d7,0xaf86b));var __importDefault=this&&this[a24_0x5871af(0x15d)]||function(_0xc13ea0){return _0xc13ea0&&_0xc13ea0['__esModule']?_0xc13ea0:{'default':_0xc13ea0};};Object[a24_0x5871af(0x15b)](exports,a24_0x5871af(0x14f),{'value':!![]}),exports[a24_0x5871af(0x139)]=exports[a24_0x5871af(0x151)]=exports['requireAdmin']=exports[a24_0x5871af(0x14b)]=void 0x0;const jsonwebtoken_1=__importDefault(require(a24_0x5871af(0x14a))),config_1=require('../config/config'),tokenBlacklistService_1=require(a24_0x5871af(0x141)),authenticateToken=(_0x416fa3,_0xb4b57d,_0x3c7df1)=>{const _0x294091=a24_0x5871af,_0x4a1f68=_0x416fa3[_0x294091(0x13f)][_0x294091(0x15e)],_0x543c24=_0x4a1f68&&_0x4a1f68['split']('\x20')[0x1];if(!_0x543c24)return _0xb4b57d['status'](0x191)[_0x294091(0x13c)]({'success':![],'message':_0x294091(0x158)});if(tokenBlacklistService_1[_0x294091(0x163)][_0x294091(0x13e)](_0x543c24))return _0xb4b57d[_0x294091(0x157)](0x191)[_0x294091(0x13c)]({'success':![],'message':'Token\x20has\x20been\x20revoked'});jsonwebtoken_1[_0x294091(0x149)][_0x294091(0x153)](_0x543c24,config_1[_0x294091(0x14d)][_0x294091(0x152)][_0x294091(0x154)],(_0x2844a8,_0x37490f)=>{const _0x1c6343=_0x294091;if(_0x2844a8)return _0xb4b57d['status'](0x193)[_0x1c6343(0x13c)]({'success':![],'message':_0x1c6343(0x145)});_0x416fa3[_0x1c6343(0x15c)]=_0x37490f,_0x416fa3[_0x1c6343(0x165)]=_0x543c24,_0x3c7df1();});};exports[a24_0x5871af(0x14b)]=authenticateToken;const requireAdmin=(_0x5452c9,_0x4a480e,_0x39b884)=>{const _0x4888f8=a24_0x5871af;if(!_0x5452c9[_0x4888f8(0x15c)]||_0x5452c9[_0x4888f8(0x15c)][_0x4888f8(0x164)]!==_0x4888f8(0x142))return _0x4a480e[_0x4888f8(0x157)](0x193)['json']({'success':![],'message':_0x4888f8(0x156)});_0x39b884();};exports[a24_0x5871af(0x15f)]=requireAdmin;const requireShop=(_0x2cfbaa,_0x44de36,_0x492ca2)=>{const _0x35782a=a24_0x5871af;if(!_0x2cfbaa['user']||_0x2cfbaa[_0x35782a(0x15c)][_0x35782a(0x164)]!==_0x35782a(0x160))return _0x44de36[_0x35782a(0x157)](0x193)[_0x35782a(0x13c)]({'success':![],'message':_0x35782a(0x155)});_0x492ca2();};exports[a24_0x5871af(0x151)]=requireShop;function a24_0x42d7(){const _0x3c29be=['8383617HSohkf','default','jsonwebtoken','authenticateToken','3635AboGdS','config','Error\x20checking\x20account\x20status','__esModule','25179lQPvbf','requireShop','jwt','verify','secret','Shop\x20access\x20required','Admin\x20access\x20required','status','Access\x20token\x20required','ACTIVE','912541Nclitq','defineProperty','user','__importDefault','authorization','requireAdmin','shop','2108VHuHMs','Error\x20checking\x20account\x20status:','tokenBlacklistService','role','token','182xORBBQ','requireActiveShop','Account\x20is\x20suspended\x20or\x20inactive.\x20Contact\x20administrator\x20to\x20activate\x20your\x20account.','5850490LgrEYM','json','66wvUCPF','isTokenBlacklisted','headers','findUnique','../services/tokenBlacklistService','admin','../config/database','524321SGLDKD','Invalid\x20or\x20expired\x20token','SUSPENDED','8000136ZvjZIH'];a24_0x42d7=function(){return _0x3c29be;};return a24_0x42d7();}function a24_0xb222(_0x241ca1,_0x1cb4ad){_0x241ca1=_0x241ca1-0x139;const _0x42d710=a24_0x42d7();let _0xb22252=_0x42d710[_0x241ca1];return _0xb22252;}const requireActiveShop=async(_0x205e00,_0x41ab67,_0x114236)=>{const _0x29e18c=a24_0x5871af;if(!_0x205e00[_0x29e18c(0x15c)]||_0x205e00[_0x29e18c(0x15c)][_0x29e18c(0x164)]!==_0x29e18c(0x160))return _0x41ab67[_0x29e18c(0x157)](0x193)[_0x29e18c(0x13c)]({'success':![],'message':_0x29e18c(0x155)});try{const _0x4e2fa6=require(_0x29e18c(0x143))[_0x29e18c(0x149)],_0xb9f291=await _0x4e2fa6[_0x29e18c(0x160)][_0x29e18c(0x140)]({'where':{'id':_0x205e00['user']['id']},'select':{'status':!![]}});if(!_0xb9f291||_0xb9f291[_0x29e18c(0x157)]!==_0x29e18c(0x159))return _0x41ab67[_0x29e18c(0x157)](0x193)[_0x29e18c(0x13c)]({'success':![],'message':_0x29e18c(0x13a),'suspended':_0xb9f291?.[_0x29e18c(0x157)]===_0x29e18c(0x146)});_0x114236();}catch(_0x5dfb53){return console['error'](_0x29e18c(0x162),_0x5dfb53),_0x41ab67['status'](0x1f4)[_0x29e18c(0x13c)]({'success':![],'message':_0x29e18c(0x14e)});}};exports[a24_0x5871af(0x139)]=requireActiveShop;