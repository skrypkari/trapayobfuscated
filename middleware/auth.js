'use strict';const a15_0x5123f4=a15_0x3c6a;function a15_0x20dc(){const _0xe65eac=['Access\x20token\x20required','__esModule','9dDlwwx','2925000LmFqer','12ffRlPN','defineProperty','status','jsonwebtoken','Admin\x20access\x20required','561022eleoop','role','token','admin','2452420UraAnN','json','requireShop','386770dFQROl','../config/config','32691DirKgU','Shop\x20access\x20required','config','2654530akdPJj','requireAdmin','154098ulizYp','user','82bBVpdr','Invalid\x20or\x20expired\x20token','tokenBlacklistService','verify','Token\x20has\x20been\x20revoked','jwt','isTokenBlacklisted','secret','split'];a15_0x20dc=function(){return _0xe65eac;};return a15_0x20dc();}(function(_0xf8c2bf,_0x4344dc){const _0x219b38=a15_0x3c6a,_0x5d1661=_0xf8c2bf();while(!![]){try{const _0x463398=-parseInt(_0x219b38(0x179))/0x1+parseInt(_0x219b38(0x17b))/0x2*(-parseInt(_0x219b38(0x174))/0x3)+parseInt(_0x219b38(0x191))/0x4+parseInt(_0x219b38(0x177))/0x5+-parseInt(_0x219b38(0x188))/0x6*(-parseInt(_0x219b38(0x18d))/0x7)+-parseInt(_0x219b38(0x187))/0x8+-parseInt(_0x219b38(0x186))/0x9*(-parseInt(_0x219b38(0x172))/0xa);if(_0x463398===_0x4344dc)break;else _0x5d1661['push'](_0x5d1661['shift']());}catch(_0x421647){_0x5d1661['push'](_0x5d1661['shift']());}}}(a15_0x20dc,0x5bea0));function a15_0x3c6a(_0x40998a,_0x39ce2a){const _0x20dc1d=a15_0x20dc();return a15_0x3c6a=function(_0x3c6aa0,_0x1c4ad0){_0x3c6aa0=_0x3c6aa0-0x171;let _0x13243e=_0x20dc1d[_0x3c6aa0];return _0x13243e;},a15_0x3c6a(_0x40998a,_0x39ce2a);}var __importDefault=this&&this['__importDefault']||function(_0x56f358){return _0x56f358&&_0x56f358['__esModule']?_0x56f358:{'default':_0x56f358};};Object[a15_0x5123f4(0x189)](exports,a15_0x5123f4(0x185),{'value':!![]}),exports[a15_0x5123f4(0x171)]=exports[a15_0x5123f4(0x178)]=exports['authenticateToken']=void 0x0;const jsonwebtoken_1=__importDefault(require(a15_0x5123f4(0x18b))),config_1=require(a15_0x5123f4(0x173)),tokenBlacklistService_1=require('../services/tokenBlacklistService'),authenticateToken=(_0x594327,_0x45ded3,_0x10237a)=>{const _0x6536e9=a15_0x5123f4,_0xfd93e1=_0x594327['headers']['authorization'],_0x510081=_0xfd93e1&&_0xfd93e1[_0x6536e9(0x183)]('\x20')[0x1];if(!_0x510081)return _0x45ded3[_0x6536e9(0x18a)](0x191)[_0x6536e9(0x192)]({'success':![],'message':_0x6536e9(0x184)});if(tokenBlacklistService_1[_0x6536e9(0x17d)][_0x6536e9(0x181)](_0x510081))return _0x45ded3[_0x6536e9(0x18a)](0x191)['json']({'success':![],'message':_0x6536e9(0x17f)});jsonwebtoken_1['default'][_0x6536e9(0x17e)](_0x510081,config_1[_0x6536e9(0x176)][_0x6536e9(0x180)][_0x6536e9(0x182)],(_0x512cfa,_0x3312b7)=>{const _0x3fd31e=_0x6536e9;if(_0x512cfa)return _0x45ded3[_0x3fd31e(0x18a)](0x193)[_0x3fd31e(0x192)]({'success':![],'message':_0x3fd31e(0x17c)});_0x594327[_0x3fd31e(0x17a)]=_0x3312b7,_0x594327[_0x3fd31e(0x18f)]=_0x510081,_0x10237a();});};exports['authenticateToken']=authenticateToken;const requireAdmin=(_0x293826,_0x12efb7,_0x457bdb)=>{const _0x2472f3=a15_0x5123f4;if(!_0x293826[_0x2472f3(0x17a)]||_0x293826[_0x2472f3(0x17a)][_0x2472f3(0x18e)]!==_0x2472f3(0x190))return _0x12efb7[_0x2472f3(0x18a)](0x193)['json']({'success':![],'message':_0x2472f3(0x18c)});_0x457bdb();};exports[a15_0x5123f4(0x178)]=requireAdmin;const requireShop=(_0x481b49,_0x29330b,_0x51497b)=>{const _0xe2dd1f=a15_0x5123f4;if(!_0x481b49[_0xe2dd1f(0x17a)]||_0x481b49[_0xe2dd1f(0x17a)]['role']!=='shop')return _0x29330b[_0xe2dd1f(0x18a)](0x193)['json']({'success':![],'message':_0xe2dd1f(0x175)});_0x51497b();};exports['requireShop']=requireShop;