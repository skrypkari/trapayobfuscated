'use strict';const a21_0x161842=a21_0x4dae;(function(_0x304ef5,_0x4b58cd){const _0x39b25c=a21_0x4dae,_0x325ea2=_0x304ef5();while(!![]){try{const _0x4e0494=-parseInt(_0x39b25c(0x19f))/0x1*(-parseInt(_0x39b25c(0x181))/0x2)+-parseInt(_0x39b25c(0x199))/0x3+parseInt(_0x39b25c(0x18d))/0x4*(parseInt(_0x39b25c(0x188))/0x5)+-parseInt(_0x39b25c(0x196))/0x6+parseInt(_0x39b25c(0x187))/0x7*(parseInt(_0x39b25c(0x1a5))/0x8)+-parseInt(_0x39b25c(0x194))/0x9*(-parseInt(_0x39b25c(0x1a7))/0xa)+-parseInt(_0x39b25c(0x1a2))/0xb*(parseInt(_0x39b25c(0x18f))/0xc);if(_0x4e0494===_0x4b58cd)break;else _0x325ea2['push'](_0x325ea2['shift']());}catch(_0x4ab452){_0x325ea2['push'](_0x325ea2['shift']());}}}(a21_0x5a67,0x25c93));function a21_0x5a67(){const _0x413c5c=['25352ADqTBz','Account\x20is\x20suspended\x20or\x20inactive.\x20Contact\x20administrator\x20to\x20activate\x20your\x20account.','110csirSV','requireActiveShop','status','defineProperty','66GoVYrf','__esModule','isTokenBlacklisted','../config/config','user','__importDefault','7YubIee','3665mSnywC','authenticateToken','shop','requireShop','secret','1676JBJVxh','Token\x20has\x20been\x20revoked','31572lqHbAp','tokenBlacklistService','Error\x20checking\x20account\x20status','Error\x20checking\x20account\x20status:','error','165303MSDgZf','../services/tokenBlacklistService','109794dhqPqK','Shop\x20access\x20required','role','218256srKqcw','authorization','headers','json','SUSPENDED','jwt','3883BzVqQI','config','requireAdmin','1650vsjYfz','default','split'];a21_0x5a67=function(){return _0x413c5c;};return a21_0x5a67();}var __importDefault=this&&this[a21_0x161842(0x186)]||function(_0xd4103d){const _0x2d02cd=a21_0x161842;return _0xd4103d&&_0xd4103d[_0x2d02cd(0x182)]?_0xd4103d:{'default':_0xd4103d};};Object[a21_0x161842(0x180)](exports,a21_0x161842(0x182),{'value':!![]}),exports[a21_0x161842(0x17e)]=exports[a21_0x161842(0x18b)]=exports[a21_0x161842(0x1a1)]=exports[a21_0x161842(0x189)]=void 0x0;const jsonwebtoken_1=__importDefault(require('jsonwebtoken')),config_1=require(a21_0x161842(0x184)),tokenBlacklistService_1=require(a21_0x161842(0x195)),authenticateToken=(_0x474e26,_0x4799d7,_0x574f58)=>{const _0x395996=a21_0x161842,_0x174ac0=_0x474e26[_0x395996(0x19b)][_0x395996(0x19a)],_0xdfbe9=_0x174ac0&&_0x174ac0[_0x395996(0x1a4)]('\x20')[0x1];if(!_0xdfbe9)return _0x4799d7[_0x395996(0x17f)](0x191)[_0x395996(0x19c)]({'success':![],'message':'Access\x20token\x20required'});if(tokenBlacklistService_1[_0x395996(0x190)][_0x395996(0x183)](_0xdfbe9))return _0x4799d7['status'](0x191)[_0x395996(0x19c)]({'success':![],'message':_0x395996(0x18e)});jsonwebtoken_1[_0x395996(0x1a3)]['verify'](_0xdfbe9,config_1[_0x395996(0x1a0)][_0x395996(0x19e)][_0x395996(0x18c)],(_0x30a460,_0x3d5243)=>{const _0x4a24e8=_0x395996;if(_0x30a460)return _0x4799d7[_0x4a24e8(0x17f)](0x193)[_0x4a24e8(0x19c)]({'success':![],'message':'Invalid\x20or\x20expired\x20token'});_0x474e26[_0x4a24e8(0x185)]=_0x3d5243,_0x474e26['token']=_0xdfbe9,_0x574f58();});};exports['authenticateToken']=authenticateToken;const requireAdmin=(_0x1e2268,_0x1fdb1b,_0x37448b)=>{const _0x376164=a21_0x161842;if(!_0x1e2268[_0x376164(0x185)]||_0x1e2268[_0x376164(0x185)][_0x376164(0x198)]!=='admin')return _0x1fdb1b[_0x376164(0x17f)](0x193)['json']({'success':![],'message':'Admin\x20access\x20required'});_0x37448b();};exports[a21_0x161842(0x1a1)]=requireAdmin;function a21_0x4dae(_0x521536,_0x26ed20){_0x521536=_0x521536-0x17e;const _0x5a67f=a21_0x5a67();let _0x4daef0=_0x5a67f[_0x521536];return _0x4daef0;}const requireShop=(_0x4620e8,_0x3ce56e,_0x374c7b)=>{const _0xfa0377=a21_0x161842;if(!_0x4620e8[_0xfa0377(0x185)]||_0x4620e8[_0xfa0377(0x185)][_0xfa0377(0x198)]!==_0xfa0377(0x18a))return _0x3ce56e[_0xfa0377(0x17f)](0x193)['json']({'success':![],'message':'Shop\x20access\x20required'});_0x374c7b();};exports['requireShop']=requireShop;const requireActiveShop=async(_0x26c663,_0x2d1ec0,_0x26be41)=>{const _0x23ac68=a21_0x161842;if(!_0x26c663[_0x23ac68(0x185)]||_0x26c663[_0x23ac68(0x185)]['role']!==_0x23ac68(0x18a))return _0x2d1ec0[_0x23ac68(0x17f)](0x193)[_0x23ac68(0x19c)]({'success':![],'message':_0x23ac68(0x197)});try{const _0x1e8b94=require('../config/database')[_0x23ac68(0x1a3)],_0x4784ea=await _0x1e8b94[_0x23ac68(0x18a)]['findUnique']({'where':{'id':_0x26c663[_0x23ac68(0x185)]['id']},'select':{'status':!![]}});if(!_0x4784ea||_0x4784ea['status']!=='ACTIVE')return _0x2d1ec0[_0x23ac68(0x17f)](0x193)[_0x23ac68(0x19c)]({'success':![],'message':_0x23ac68(0x1a6),'suspended':_0x4784ea?.[_0x23ac68(0x17f)]===_0x23ac68(0x19d)});_0x26be41();}catch(_0x2d041d){return console[_0x23ac68(0x193)](_0x23ac68(0x192),_0x2d041d),_0x2d1ec0[_0x23ac68(0x17f)](0x1f4)[_0x23ac68(0x19c)]({'success':![],'message':_0x23ac68(0x191)});}};exports['requireActiveShop']=requireActiveShop;