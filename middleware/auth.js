'use strict';function a16_0x559c(){const _0x403e46=['4aTLkAE','admin','3293559pBqVNz','defineProperty','status','requireActiveShop','Token\x20has\x20been\x20revoked','../config/config','authenticateToken','Access\x20token\x20required','requireShop','1IdAjLd','810909zLqdNq','1132454bxWMbq','230ydMbNq','secret','699167XWovLj','user','Shop\x20access\x20required','requireAdmin','token','Invalid\x20or\x20expired\x20token','jwt','config','ACTIVE','headers','role','Admin\x20access\x20required','2978514UVbxeM','isTokenBlacklisted','jsonwebtoken','error','2448520ejEGKs','../services/tokenBlacklistService','default','1051449FgXKOJ','__importDefault','verify','24KmTOfZ','shop','Error\x20checking\x20account\x20status:','json','__esModule'];a16_0x559c=function(){return _0x403e46;};return a16_0x559c();}const a16_0x27d632=a16_0x23ad;(function(_0x4adf03,_0x1a227e){const _0xbbba3a=a16_0x23ad,_0x1a516a=_0x4adf03();while(!![]){try{const _0xb04d34=parseInt(_0xbbba3a(0x1ff))/0x1*(-parseInt(_0xbbba3a(0x201))/0x2)+-parseInt(_0xbbba3a(0x1ec))/0x3*(parseInt(_0xbbba3a(0x1f4))/0x4)+-parseInt(_0xbbba3a(0x1e9))/0x5+-parseInt(_0xbbba3a(0x1e5))/0x6+-parseInt(_0xbbba3a(0x204))/0x7*(-parseInt(_0xbbba3a(0x1ef))/0x8)+parseInt(_0xbbba3a(0x1f6))/0x9+-parseInt(_0xbbba3a(0x202))/0xa*(-parseInt(_0xbbba3a(0x200))/0xb);if(_0xb04d34===_0x1a227e)break;else _0x1a516a['push'](_0x1a516a['shift']());}catch(_0x5e457d){_0x1a516a['push'](_0x1a516a['shift']());}}}(a16_0x559c,0x6fe3a));var __importDefault=this&&this[a16_0x27d632(0x1ed)]||function(_0xf7ecb8){const _0x270dcd=a16_0x27d632;return _0xf7ecb8&&_0xf7ecb8[_0x270dcd(0x1f3)]?_0xf7ecb8:{'default':_0xf7ecb8};};Object[a16_0x27d632(0x1f7)](exports,a16_0x27d632(0x1f3),{'value':!![]}),exports[a16_0x27d632(0x1f9)]=exports[a16_0x27d632(0x1fe)]=exports[a16_0x27d632(0x207)]=exports[a16_0x27d632(0x1fc)]=void 0x0;const jsonwebtoken_1=__importDefault(require(a16_0x27d632(0x1e7))),config_1=require(a16_0x27d632(0x1fb)),tokenBlacklistService_1=require(a16_0x27d632(0x1ea)),authenticateToken=(_0x2391ac,_0x27e44f,_0x3be897)=>{const _0x500bb6=a16_0x27d632,_0x1d117b=_0x2391ac[_0x500bb6(0x20d)]['authorization'],_0x17b0ca=_0x1d117b&&_0x1d117b['split']('\x20')[0x1];if(!_0x17b0ca)return _0x27e44f[_0x500bb6(0x1f8)](0x191)['json']({'success':![],'message':_0x500bb6(0x1fd)});if(tokenBlacklistService_1['tokenBlacklistService'][_0x500bb6(0x1e6)](_0x17b0ca))return _0x27e44f['status'](0x191)[_0x500bb6(0x1f2)]({'success':![],'message':_0x500bb6(0x1fa)});jsonwebtoken_1['default'][_0x500bb6(0x1ee)](_0x17b0ca,config_1[_0x500bb6(0x20b)][_0x500bb6(0x20a)][_0x500bb6(0x203)],(_0x32503d,_0x3101ad)=>{const _0x1c2924=_0x500bb6;if(_0x32503d)return _0x27e44f['status'](0x193)[_0x1c2924(0x1f2)]({'success':![],'message':_0x1c2924(0x209)});_0x2391ac['user']=_0x3101ad,_0x2391ac[_0x1c2924(0x208)]=_0x17b0ca,_0x3be897();});};exports[a16_0x27d632(0x1fc)]=authenticateToken;const requireAdmin=(_0x2b4125,_0x5156a2,_0x3d822a)=>{const _0x2d44ad=a16_0x27d632;if(!_0x2b4125[_0x2d44ad(0x205)]||_0x2b4125[_0x2d44ad(0x205)][_0x2d44ad(0x20e)]!==_0x2d44ad(0x1f5))return _0x5156a2[_0x2d44ad(0x1f8)](0x193)['json']({'success':![],'message':_0x2d44ad(0x20f)});_0x3d822a();};exports[a16_0x27d632(0x207)]=requireAdmin;function a16_0x23ad(_0x5f018a,_0x13eef8){const _0x559cd5=a16_0x559c();return a16_0x23ad=function(_0x23ada7,_0x13516e){_0x23ada7=_0x23ada7-0x1e5;let _0x1ccb6d=_0x559cd5[_0x23ada7];return _0x1ccb6d;},a16_0x23ad(_0x5f018a,_0x13eef8);}const requireShop=(_0x5a5568,_0x49c03b,_0x5d5200)=>{const _0xb2ee3c=a16_0x27d632;if(!_0x5a5568[_0xb2ee3c(0x205)]||_0x5a5568[_0xb2ee3c(0x205)][_0xb2ee3c(0x20e)]!==_0xb2ee3c(0x1f0))return _0x49c03b[_0xb2ee3c(0x1f8)](0x193)[_0xb2ee3c(0x1f2)]({'success':![],'message':'Shop\x20access\x20required'});_0x5d5200();};exports['requireShop']=requireShop;const requireActiveShop=async(_0x36a96c,_0x2f8448,_0x15ef03)=>{const _0xe9eac4=a16_0x27d632;if(!_0x36a96c[_0xe9eac4(0x205)]||_0x36a96c[_0xe9eac4(0x205)]['role']!==_0xe9eac4(0x1f0))return _0x2f8448[_0xe9eac4(0x1f8)](0x193)[_0xe9eac4(0x1f2)]({'success':![],'message':_0xe9eac4(0x206)});try{const _0x22d761=require('../config/database')[_0xe9eac4(0x1eb)],_0x2da466=await _0x22d761[_0xe9eac4(0x1f0)]['findUnique']({'where':{'id':_0x36a96c[_0xe9eac4(0x205)]['id']},'select':{'status':!![]}});if(!_0x2da466||_0x2da466['status']!==_0xe9eac4(0x20c))return _0x2f8448['status'](0x193)['json']({'success':![],'message':'Account\x20is\x20suspended\x20or\x20inactive.\x20Contact\x20administrator\x20to\x20activate\x20your\x20account.','suspended':_0x2da466?.['status']==='SUSPENDED'});_0x15ef03();}catch(_0x304bfa){return console[_0xe9eac4(0x1e8)](_0xe9eac4(0x1f1),_0x304bfa),_0x2f8448[_0xe9eac4(0x1f8)](0x1f4)[_0xe9eac4(0x1f2)]({'success':![],'message':'Error\x20checking\x20account\x20status'});}};exports['requireActiveShop']=requireActiveShop;