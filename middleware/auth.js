'use strict';const a16_0x5b0830=a16_0x5c9a;(function(_0x29ea84,_0x382b53){const _0x4fff2f=a16_0x5c9a,_0x1c2062=_0x29ea84();while(!![]){try{const _0x4eba5b=parseInt(_0x4fff2f(0x1c1))/0x1+parseInt(_0x4fff2f(0x1d8))/0x2*(parseInt(_0x4fff2f(0x1d7))/0x3)+-parseInt(_0x4fff2f(0x1e6))/0x4+parseInt(_0x4fff2f(0x1ea))/0x5+parseInt(_0x4fff2f(0x1d9))/0x6*(-parseInt(_0x4fff2f(0x1cf))/0x7)+-parseInt(_0x4fff2f(0x1cb))/0x8*(-parseInt(_0x4fff2f(0x1e4))/0x9)+parseInt(_0x4fff2f(0x1cd))/0xa;if(_0x4eba5b===_0x382b53)break;else _0x1c2062['push'](_0x1c2062['shift']());}catch(_0x471033){_0x1c2062['push'](_0x1c2062['shift']());}}}(a16_0x321c,0x1ab29));var __importDefault=this&&this[a16_0x5b0830(0x1d0)]||function(_0x4c236f){return _0x4c236f&&_0x4c236f['__esModule']?_0x4c236f:{'default':_0x4c236f};};Object[a16_0x5b0830(0x1e1)](exports,a16_0x5b0830(0x1c9),{'value':!![]}),exports[a16_0x5b0830(0x1d5)]=exports[a16_0x5b0830(0x1d2)]=exports[a16_0x5b0830(0x1db)]=exports['authenticateToken']=void 0x0;const jsonwebtoken_1=__importDefault(require(a16_0x5b0830(0x1e2))),config_1=require('../config/config'),tokenBlacklistService_1=require(a16_0x5b0830(0x1c4)),authenticateToken=(_0x6b93a4,_0x457d77,_0x304a66)=>{const _0x2f93b1=a16_0x5b0830,_0x55ef22=_0x6b93a4[_0x2f93b1(0x1c7)]['authorization'],_0x37172c=_0x55ef22&&_0x55ef22[_0x2f93b1(0x1e9)]('\x20')[0x1];if(!_0x37172c)return _0x457d77[_0x2f93b1(0x1df)](0x191)[_0x2f93b1(0x1ca)]({'success':![],'message':_0x2f93b1(0x1cc)});if(tokenBlacklistService_1[_0x2f93b1(0x1c6)]['isTokenBlacklisted'](_0x37172c))return _0x457d77['status'](0x191)[_0x2f93b1(0x1ca)]({'success':![],'message':_0x2f93b1(0x1de)});jsonwebtoken_1['default'][_0x2f93b1(0x1e7)](_0x37172c,config_1['config'][_0x2f93b1(0x1c2)]['secret'],(_0x362aa0,_0x5c2078)=>{const _0x48bfd3=_0x2f93b1;if(_0x362aa0)return _0x457d77[_0x48bfd3(0x1df)](0x193)[_0x48bfd3(0x1ca)]({'success':![],'message':_0x48bfd3(0x1d1)});_0x6b93a4[_0x48bfd3(0x1e0)]=_0x5c2078,_0x6b93a4['token']=_0x37172c,_0x304a66();});};function a16_0x321c(){const _0x335725=['398340bFGsrF','51584xyekVf','jwt','Error\x20checking\x20account\x20status','../services/tokenBlacklistService','SUSPENDED','tokenBlacklistService','headers','Account\x20is\x20suspended\x20or\x20inactive.\x20Contact\x20administrator\x20to\x20activate\x20your\x20account.','__esModule','json','920NojaFr','Access\x20token\x20required','1476840GdGvTx','../config/database','364pJCGHg','__importDefault','Invalid\x20or\x20expired\x20token','requireShop','role','findUnique','requireActiveShop','Shop\x20access\x20required','3SEWXwL','205984GCncod','23844Zslwbi','authenticateToken','requireAdmin','error','shop','Token\x20has\x20been\x20revoked','status','user','defineProperty','jsonwebtoken','Error\x20checking\x20account\x20status:','3222FOSiSn','admin','428388Xibgkh','verify','default','split'];a16_0x321c=function(){return _0x335725;};return a16_0x321c();}exports[a16_0x5b0830(0x1da)]=authenticateToken;const requireAdmin=(_0x45e3cc,_0x1932d2,_0x215815)=>{const _0x4d7df0=a16_0x5b0830;if(!_0x45e3cc[_0x4d7df0(0x1e0)]||_0x45e3cc['user']['role']!==_0x4d7df0(0x1e5))return _0x1932d2[_0x4d7df0(0x1df)](0x193)[_0x4d7df0(0x1ca)]({'success':![],'message':'Admin\x20access\x20required'});_0x215815();};function a16_0x5c9a(_0x1cc4db,_0x4edd3c){const _0x321c36=a16_0x321c();return a16_0x5c9a=function(_0x5c9a00,_0x1756dc){_0x5c9a00=_0x5c9a00-0x1c1;let _0x2a754f=_0x321c36[_0x5c9a00];return _0x2a754f;},a16_0x5c9a(_0x1cc4db,_0x4edd3c);}exports[a16_0x5b0830(0x1db)]=requireAdmin;const requireShop=(_0x5f377a,_0x1cf168,_0x9ee51f)=>{const _0x33a773=a16_0x5b0830;if(!_0x5f377a['user']||_0x5f377a[_0x33a773(0x1e0)][_0x33a773(0x1d3)]!==_0x33a773(0x1dd))return _0x1cf168['status'](0x193)['json']({'success':![],'message':_0x33a773(0x1d6)});_0x9ee51f();};exports[a16_0x5b0830(0x1d2)]=requireShop;const requireActiveShop=async(_0x1ccdf1,_0x51bf5b,_0x294063)=>{const _0x426746=a16_0x5b0830;if(!_0x1ccdf1[_0x426746(0x1e0)]||_0x1ccdf1[_0x426746(0x1e0)][_0x426746(0x1d3)]!==_0x426746(0x1dd))return _0x51bf5b['status'](0x193)[_0x426746(0x1ca)]({'success':![],'message':_0x426746(0x1d6)});try{const _0x298682=require(_0x426746(0x1ce))[_0x426746(0x1e8)],_0x165af0=await _0x298682[_0x426746(0x1dd)][_0x426746(0x1d4)]({'where':{'id':_0x1ccdf1[_0x426746(0x1e0)]['id']},'select':{'status':!![]}});if(!_0x165af0||_0x165af0[_0x426746(0x1df)]!=='ACTIVE')return _0x51bf5b[_0x426746(0x1df)](0x193)[_0x426746(0x1ca)]({'success':![],'message':_0x426746(0x1c8),'suspended':_0x165af0?.[_0x426746(0x1df)]===_0x426746(0x1c5)});_0x294063();}catch(_0x41e376){return console[_0x426746(0x1dc)](_0x426746(0x1e3),_0x41e376),_0x51bf5b[_0x426746(0x1df)](0x1f4)[_0x426746(0x1ca)]({'success':![],'message':_0x426746(0x1c3)});}};exports['requireActiveShop']=requireActiveShop;