'use strict';function a16_0x1fa2(){const _0x133ab2=['../services/tokenBlacklistService','isTokenBlacklisted','requireShop','Error\x20checking\x20account\x20status:','role','headers','2529174hlLCFd','Admin\x20access\x20required','requireAdmin','6350309wjLgSx','authorization','secret','1216834uYAQTo','jsonwebtoken','SUSPENDED','error','16EjEHew','Shop\x20access\x20required','Token\x20has\x20been\x20revoked','split','../config/config','tokenBlacklistService','requireActiveShop','shop','json','defineProperty','user','admin','__esModule','Error\x20checking\x20account\x20status','config','328148DFJTky','3111778cdYMuS','token','__importDefault','Account\x20is\x20suspended\x20or\x20inactive.\x20Contact\x20administrator\x20to\x20activate\x20your\x20account.','25etYdFC','status','authenticateToken','2122611ZgxdUH','default','Access\x20token\x20required','776826zsLvSC'];a16_0x1fa2=function(){return _0x133ab2;};return a16_0x1fa2();}const a16_0x555df0=a16_0x1b8a;(function(_0x359862,_0x477633){const _0x26616e=a16_0x1b8a,_0x85c302=_0x359862();while(!![]){try{const _0x533a50=-parseInt(_0x26616e(0x9d))/0x1+parseInt(_0x26616e(0x86))/0x2+parseInt(_0x26616e(0x8d))/0x3+-parseInt(_0x26616e(0x85))/0x4*(-parseInt(_0x26616e(0x8a))/0x5)+parseInt(_0x26616e(0x97))/0x6+-parseInt(_0x26616e(0x9a))/0x7+parseInt(_0x26616e(0xa1))/0x8*(-parseInt(_0x26616e(0x90))/0x9);if(_0x533a50===_0x477633)break;else _0x85c302['push'](_0x85c302['shift']());}catch(_0x4f0b5a){_0x85c302['push'](_0x85c302['shift']());}}}(a16_0x1fa2,0xc2f1b));var __importDefault=this&&this[a16_0x555df0(0x88)]||function(_0x2fd9a3){const _0x378b23=a16_0x555df0;return _0x2fd9a3&&_0x2fd9a3[_0x378b23(0x82)]?_0x2fd9a3:{'default':_0x2fd9a3};};Object[a16_0x555df0(0x7f)](exports,a16_0x555df0(0x82),{'value':!![]}),exports[a16_0x555df0(0x7c)]=exports['requireShop']=exports[a16_0x555df0(0x99)]=exports[a16_0x555df0(0x8c)]=void 0x0;function a16_0x1b8a(_0x23857e,_0x2c7b96){const _0x1fa2cb=a16_0x1fa2();return a16_0x1b8a=function(_0x1b8aa9,_0xb12ee3){_0x1b8aa9=_0x1b8aa9-0x7c;let _0x3b00f5=_0x1fa2cb[_0x1b8aa9];return _0x3b00f5;},a16_0x1b8a(_0x23857e,_0x2c7b96);}const jsonwebtoken_1=__importDefault(require(a16_0x555df0(0x9e))),config_1=require(a16_0x555df0(0xa5)),tokenBlacklistService_1=require(a16_0x555df0(0x91)),authenticateToken=(_0x45b42f,_0x52efa2,_0x223b05)=>{const _0x570758=a16_0x555df0,_0x57fe91=_0x45b42f[_0x570758(0x96)][_0x570758(0x9b)],_0x142ba2=_0x57fe91&&_0x57fe91[_0x570758(0xa4)]('\x20')[0x1];if(!_0x142ba2)return _0x52efa2[_0x570758(0x8b)](0x191)[_0x570758(0x7e)]({'success':![],'message':_0x570758(0x8f)});if(tokenBlacklistService_1[_0x570758(0xa6)][_0x570758(0x92)](_0x142ba2))return _0x52efa2[_0x570758(0x8b)](0x191)[_0x570758(0x7e)]({'success':![],'message':_0x570758(0xa3)});jsonwebtoken_1['default']['verify'](_0x142ba2,config_1[_0x570758(0x84)]['jwt'][_0x570758(0x9c)],(_0x34f9d3,_0x150fef)=>{const _0x3d91f6=_0x570758;if(_0x34f9d3)return _0x52efa2[_0x3d91f6(0x8b)](0x193)[_0x3d91f6(0x7e)]({'success':![],'message':'Invalid\x20or\x20expired\x20token'});_0x45b42f['user']=_0x150fef,_0x45b42f[_0x3d91f6(0x87)]=_0x142ba2,_0x223b05();});};exports[a16_0x555df0(0x8c)]=authenticateToken;const requireAdmin=(_0x39b399,_0x328d21,_0x55ec62)=>{const _0x5753b0=a16_0x555df0;if(!_0x39b399[_0x5753b0(0x80)]||_0x39b399[_0x5753b0(0x80)][_0x5753b0(0x95)]!==_0x5753b0(0x81))return _0x328d21['status'](0x193)[_0x5753b0(0x7e)]({'success':![],'message':_0x5753b0(0x98)});_0x55ec62();};exports[a16_0x555df0(0x99)]=requireAdmin;const requireShop=(_0xdbcadd,_0x1ddf05,_0x38ceb2)=>{const _0x213585=a16_0x555df0;if(!_0xdbcadd[_0x213585(0x80)]||_0xdbcadd[_0x213585(0x80)][_0x213585(0x95)]!=='shop')return _0x1ddf05[_0x213585(0x8b)](0x193)[_0x213585(0x7e)]({'success':![],'message':_0x213585(0xa2)});_0x38ceb2();};exports[a16_0x555df0(0x93)]=requireShop;const requireActiveShop=async(_0x507dcc,_0x5f39f2,_0x3d1e3b)=>{const _0x4004cb=a16_0x555df0;if(!_0x507dcc[_0x4004cb(0x80)]||_0x507dcc[_0x4004cb(0x80)][_0x4004cb(0x95)]!==_0x4004cb(0x7d))return _0x5f39f2[_0x4004cb(0x8b)](0x193)['json']({'success':![],'message':_0x4004cb(0xa2)});try{const _0x54e3b1=require('../config/database')[_0x4004cb(0x8e)],_0x5a7f6c=await _0x54e3b1[_0x4004cb(0x7d)]['findUnique']({'where':{'id':_0x507dcc[_0x4004cb(0x80)]['id']},'select':{'status':!![]}});if(!_0x5a7f6c||_0x5a7f6c[_0x4004cb(0x8b)]!=='ACTIVE')return _0x5f39f2[_0x4004cb(0x8b)](0x193)['json']({'success':![],'message':_0x4004cb(0x89),'suspended':_0x5a7f6c?.[_0x4004cb(0x8b)]===_0x4004cb(0x9f)});_0x3d1e3b();}catch(_0x3f4049){return console[_0x4004cb(0xa0)](_0x4004cb(0x94),_0x3f4049),_0x5f39f2[_0x4004cb(0x8b)](0x1f4)['json']({'success':![],'message':_0x4004cb(0x83)});}};exports[a16_0x555df0(0x7c)]=requireActiveShop;