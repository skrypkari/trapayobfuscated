'use strict';function a18_0x13ae(_0xe439b3,_0x1fc589){const _0x46cb6e=a18_0x46cb();return a18_0x13ae=function(_0x13aec6,_0x256a87){_0x13aec6=_0x13aec6-0xe6;let _0x188fbc=_0x46cb6e[_0x13aec6];return _0x188fbc;},a18_0x13ae(_0xe439b3,_0x1fc589);}function a18_0x46cb(){const _0x425ead=['isTokenBlacklisted','2888KWlnNM','tokenBlacklistService','error','1591840kvYyGx','shop','secret','Invalid\x20or\x20expired\x20token','findUnique','3549XKbHng','role','../config/config','default','Access\x20token\x20required','json','split','1401312lObjxV','Admin\x20access\x20required','4564oIgQSh','user','__esModule','Error\x20checking\x20account\x20status','headers','jwt','197284zHDLWd','status','Error\x20checking\x20account\x20status:','Token\x20has\x20been\x20revoked','authorization','7659ZhNbWY','../config/database','requireAdmin','requireActiveShop','jsonwebtoken','86116ruUWAl','requireShop','admin','authenticateToken','Shop\x20access\x20required','Account\x20is\x20suspended\x20or\x20inactive.\x20Contact\x20administrator\x20to\x20activate\x20your\x20account.','verify','6878298FDtBND'];a18_0x46cb=function(){return _0x425ead;};return a18_0x46cb();}const a18_0x28bb5d=a18_0x13ae;(function(_0x4922d1,_0x9227fb){const _0x3c3fce=a18_0x13ae,_0x11c920=_0x4922d1();while(!![]){try{const _0x5b223b=parseInt(_0x3c3fce(0x109))/0x1+-parseInt(_0x3c3fce(0xff))/0x2+-parseInt(_0x3c3fce(0xf0))/0x3*(-parseInt(_0x3c3fce(0xf9))/0x4)+parseInt(_0x3c3fce(0xeb))/0x5+-parseInt(_0x3c3fce(0xf7))/0x6+-parseInt(_0x3c3fce(0xe6))/0x7+-parseInt(_0x3c3fce(0xe8))/0x8*(-parseInt(_0x3c3fce(0x104))/0x9);if(_0x5b223b===_0x9227fb)break;else _0x11c920['push'](_0x11c920['shift']());}catch(_0x403ca3){_0x11c920['push'](_0x11c920['shift']());}}}(a18_0x46cb,0xb64c2));var __importDefault=this&&this['__importDefault']||function(_0x37289c){return _0x37289c&&_0x37289c['__esModule']?_0x37289c:{'default':_0x37289c};};Object['defineProperty'](exports,a18_0x28bb5d(0xfb),{'value':!![]}),exports[a18_0x28bb5d(0x107)]=exports[a18_0x28bb5d(0x10a)]=exports[a18_0x28bb5d(0x106)]=exports[a18_0x28bb5d(0x10c)]=void 0x0;const jsonwebtoken_1=__importDefault(require(a18_0x28bb5d(0x108))),config_1=require(a18_0x28bb5d(0xf2)),tokenBlacklistService_1=require('../services/tokenBlacklistService'),authenticateToken=(_0x1463b2,_0x39b66e,_0x409181)=>{const _0xccb42b=a18_0x28bb5d,_0x21f725=_0x1463b2[_0xccb42b(0xfd)][_0xccb42b(0x103)],_0x683ec2=_0x21f725&&_0x21f725[_0xccb42b(0xf6)]('\x20')[0x1];if(!_0x683ec2)return _0x39b66e['status'](0x191)[_0xccb42b(0xf5)]({'success':![],'message':_0xccb42b(0xf4)});if(tokenBlacklistService_1[_0xccb42b(0xe9)][_0xccb42b(0xe7)](_0x683ec2))return _0x39b66e['status'](0x191)[_0xccb42b(0xf5)]({'success':![],'message':_0xccb42b(0x102)});jsonwebtoken_1[_0xccb42b(0xf3)][_0xccb42b(0x10f)](_0x683ec2,config_1['config'][_0xccb42b(0xfe)][_0xccb42b(0xed)],(_0x2de2ff,_0x12600e)=>{const _0x31a85b=_0xccb42b;if(_0x2de2ff)return _0x39b66e[_0x31a85b(0x100)](0x193)['json']({'success':![],'message':_0x31a85b(0xee)});_0x1463b2[_0x31a85b(0xfa)]=_0x12600e,_0x1463b2['token']=_0x683ec2,_0x409181();});};exports[a18_0x28bb5d(0x10c)]=authenticateToken;const requireAdmin=(_0xba256f,_0x4bd30a,_0x33fb53)=>{const _0xca719c=a18_0x28bb5d;if(!_0xba256f[_0xca719c(0xfa)]||_0xba256f[_0xca719c(0xfa)][_0xca719c(0xf1)]!==_0xca719c(0x10b))return _0x4bd30a[_0xca719c(0x100)](0x193)[_0xca719c(0xf5)]({'success':![],'message':_0xca719c(0xf8)});_0x33fb53();};exports[a18_0x28bb5d(0x106)]=requireAdmin;const requireShop=(_0x546b03,_0x20f746,_0x5a5a09)=>{const _0x18f2e2=a18_0x28bb5d;if(!_0x546b03[_0x18f2e2(0xfa)]||_0x546b03['user']['role']!=='shop')return _0x20f746['status'](0x193)[_0x18f2e2(0xf5)]({'success':![],'message':_0x18f2e2(0x10d)});_0x5a5a09();};exports[a18_0x28bb5d(0x10a)]=requireShop;const requireActiveShop=async(_0x4a5e63,_0x1ba76e,_0x4a8055)=>{const _0x3fd1ce=a18_0x28bb5d;if(!_0x4a5e63['user']||_0x4a5e63['user']['role']!==_0x3fd1ce(0xec))return _0x1ba76e[_0x3fd1ce(0x100)](0x193)[_0x3fd1ce(0xf5)]({'success':![],'message':_0x3fd1ce(0x10d)});try{const _0x18fe61=require(_0x3fd1ce(0x105))[_0x3fd1ce(0xf3)],_0x162cd7=await _0x18fe61['shop'][_0x3fd1ce(0xef)]({'where':{'id':_0x4a5e63[_0x3fd1ce(0xfa)]['id']},'select':{'status':!![]}});if(!_0x162cd7||_0x162cd7[_0x3fd1ce(0x100)]!=='ACTIVE')return _0x1ba76e[_0x3fd1ce(0x100)](0x193)[_0x3fd1ce(0xf5)]({'success':![],'message':_0x3fd1ce(0x10e),'suspended':_0x162cd7?.['status']==='SUSPENDED'});_0x4a8055();}catch(_0x34c528){return console[_0x3fd1ce(0xea)](_0x3fd1ce(0x101),_0x34c528),_0x1ba76e[_0x3fd1ce(0x100)](0x1f4)[_0x3fd1ce(0xf5)]({'success':![],'message':_0x3fd1ce(0xfc)});}};exports[a18_0x28bb5d(0x107)]=requireActiveShop;