'use strict';const a16_0x451745=a16_0x11e8;(function(_0x37843d,_0x3a7a59){const _0x4ba8b2=a16_0x11e8,_0x2e6dad=_0x37843d();while(!![]){try{const _0x198576=parseInt(_0x4ba8b2(0xfc))/0x1+parseInt(_0x4ba8b2(0x10a))/0x2+parseInt(_0x4ba8b2(0xfa))/0x3+-parseInt(_0x4ba8b2(0xf9))/0x4*(parseInt(_0x4ba8b2(0x100))/0x5)+parseInt(_0x4ba8b2(0x10b))/0x6*(parseInt(_0x4ba8b2(0x108))/0x7)+parseInt(_0x4ba8b2(0xf7))/0x8+-parseInt(_0x4ba8b2(0x111))/0x9*(parseInt(_0x4ba8b2(0x104))/0xa);if(_0x198576===_0x3a7a59)break;else _0x2e6dad['push'](_0x2e6dad['shift']());}catch(_0xcc9722){_0x2e6dad['push'](_0x2e6dad['shift']());}}}(a16_0x10e8,0x81a2f));var __importDefault=this&&this['__importDefault']||function(_0x2dd088){const _0x280168=a16_0x11e8;return _0x2dd088&&_0x2dd088[_0x280168(0x103)]?_0x2dd088:{'default':_0x2dd088};};function a16_0x10e8(){const _0x4c7d22=['14GdcWho','verify','1697394jCRYPw','1072002oPzBIJ','ACTIVE','config','../services/tokenBlacklistService','jsonwebtoken','Error\x20checking\x20account\x20status','261lKfIsv','Shop\x20access\x20required','json','user','../config/config','status','findUnique','authenticateToken','Token\x20has\x20been\x20revoked','SUSPENDED','../config/database','145696hWOMws','default','16808mZXUih','2862741wpGOSE','requireAdmin','87096mtqiHQ','defineProperty','jwt','Invalid\x20or\x20expired\x20token','260Dkldyl','role','split','__esModule','522790LceWIL','shop','tokenBlacklistService','secret'];a16_0x10e8=function(){return _0x4c7d22;};return a16_0x10e8();}Object[a16_0x451745(0xfd)](exports,'__esModule',{'value':!![]}),exports['requireActiveShop']=exports['requireShop']=exports[a16_0x451745(0xfb)]=exports[a16_0x451745(0xf3)]=void 0x0;const jsonwebtoken_1=__importDefault(require(a16_0x451745(0x10f))),config_1=require(a16_0x451745(0x115)),tokenBlacklistService_1=require(a16_0x451745(0x10e)),authenticateToken=(_0x449234,_0x10b9e8,_0x489a6f)=>{const _0x1d172f=a16_0x451745,_0x4dbd18=_0x449234['headers']['authorization'],_0x41af96=_0x4dbd18&&_0x4dbd18[_0x1d172f(0x102)]('\x20')[0x1];if(!_0x41af96)return _0x10b9e8[_0x1d172f(0x116)](0x191)['json']({'success':![],'message':'Access\x20token\x20required'});if(tokenBlacklistService_1[_0x1d172f(0x106)]['isTokenBlacklisted'](_0x41af96))return _0x10b9e8[_0x1d172f(0x116)](0x191)[_0x1d172f(0x113)]({'success':![],'message':_0x1d172f(0xf4)});jsonwebtoken_1['default'][_0x1d172f(0x109)](_0x41af96,config_1[_0x1d172f(0x10d)][_0x1d172f(0xfe)][_0x1d172f(0x107)],(_0x522b29,_0x59bd5b)=>{const _0x25b505=_0x1d172f;if(_0x522b29)return _0x10b9e8[_0x25b505(0x116)](0x193)['json']({'success':![],'message':_0x25b505(0xff)});_0x449234[_0x25b505(0x114)]=_0x59bd5b,_0x449234['token']=_0x41af96,_0x489a6f();});};function a16_0x11e8(_0x2f3026,_0x257d36){const _0x10e88e=a16_0x10e8();return a16_0x11e8=function(_0x11e88a,_0x2b7d25){_0x11e88a=_0x11e88a-0xf3;let _0x333ffb=_0x10e88e[_0x11e88a];return _0x333ffb;},a16_0x11e8(_0x2f3026,_0x257d36);}exports[a16_0x451745(0xf3)]=authenticateToken;const requireAdmin=(_0x393fc9,_0x5c7d6b,_0x490210)=>{const _0x2f42fd=a16_0x451745;if(!_0x393fc9[_0x2f42fd(0x114)]||_0x393fc9[_0x2f42fd(0x114)][_0x2f42fd(0x101)]!=='admin')return _0x5c7d6b[_0x2f42fd(0x116)](0x193)['json']({'success':![],'message':'Admin\x20access\x20required'});_0x490210();};exports[a16_0x451745(0xfb)]=requireAdmin;const requireShop=(_0x2a2a0c,_0x7a98e1,_0x12f73d)=>{const _0x3dbeb4=a16_0x451745;if(!_0x2a2a0c[_0x3dbeb4(0x114)]||_0x2a2a0c['user'][_0x3dbeb4(0x101)]!==_0x3dbeb4(0x105))return _0x7a98e1[_0x3dbeb4(0x116)](0x193)[_0x3dbeb4(0x113)]({'success':![],'message':_0x3dbeb4(0x112)});_0x12f73d();};exports['requireShop']=requireShop;const requireActiveShop=async(_0x485904,_0x58adb9,_0x237414)=>{const _0x2f7001=a16_0x451745;if(!_0x485904[_0x2f7001(0x114)]||_0x485904[_0x2f7001(0x114)]['role']!==_0x2f7001(0x105))return _0x58adb9[_0x2f7001(0x116)](0x193)[_0x2f7001(0x113)]({'success':![],'message':'Shop\x20access\x20required'});try{const _0x4986f5=require(_0x2f7001(0xf6))[_0x2f7001(0xf8)],_0x2d7dca=await _0x4986f5[_0x2f7001(0x105)][_0x2f7001(0x117)]({'where':{'id':_0x485904[_0x2f7001(0x114)]['id']},'select':{'status':!![]}});if(!_0x2d7dca||_0x2d7dca['status']!==_0x2f7001(0x10c))return _0x58adb9['status'](0x193)[_0x2f7001(0x113)]({'success':![],'message':'Account\x20is\x20suspended\x20or\x20inactive.\x20Contact\x20administrator\x20to\x20activate\x20your\x20account.','suspended':_0x2d7dca?.['status']===_0x2f7001(0xf5)});_0x237414();}catch(_0x1f9576){return console['error']('Error\x20checking\x20account\x20status:',_0x1f9576),_0x58adb9[_0x2f7001(0x116)](0x1f4)[_0x2f7001(0x113)]({'success':![],'message':_0x2f7001(0x110)});}};exports['requireActiveShop']=requireActiveShop;