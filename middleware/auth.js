'use strict';const a18_0x43522b=a18_0x212f;function a18_0x212f(_0x107127,_0x5d0c23){const _0x4a8c7b=a18_0x4a8c();return a18_0x212f=function(_0x212f5f,_0x513785){_0x212f5f=_0x212f5f-0xc5;let _0x8def0e=_0x4a8c7b[_0x212f5f];return _0x8def0e;},a18_0x212f(_0x107127,_0x5d0c23);}(function(_0x4ef75f,_0xeed6f4){const _0x44274d=a18_0x212f,_0x4c036f=_0x4ef75f();while(!![]){try{const _0x59b0c1=parseInt(_0x44274d(0xdf))/0x1*(parseInt(_0x44274d(0xe9))/0x2)+parseInt(_0x44274d(0xe1))/0x3+parseInt(_0x44274d(0xd6))/0x4+-parseInt(_0x44274d(0xd0))/0x5+-parseInt(_0x44274d(0xf0))/0x6*(-parseInt(_0x44274d(0xde))/0x7)+-parseInt(_0x44274d(0xd3))/0x8*(parseInt(_0x44274d(0xec))/0x9)+-parseInt(_0x44274d(0xd9))/0xa;if(_0x59b0c1===_0xeed6f4)break;else _0x4c036f['push'](_0x4c036f['shift']());}catch(_0x446adc){_0x4c036f['push'](_0x4c036f['shift']());}}}(a18_0x4a8c,0xbedaa));var __importDefault=this&&this[a18_0x43522b(0xcb)]||function(_0x579843){const _0x522e64=a18_0x43522b;return _0x579843&&_0x579843[_0x522e64(0xc7)]?_0x579843:{'default':_0x579843};};Object['defineProperty'](exports,a18_0x43522b(0xc7),{'value':!![]}),exports[a18_0x43522b(0xe5)]=exports[a18_0x43522b(0xee)]=exports[a18_0x43522b(0xc8)]=exports[a18_0x43522b(0xce)]=void 0x0;function a18_0x4a8c(){const _0x13d4eb=['10112oSxSaz','jwt','authorization','2805864OinPhb','../config/config','findUnique','8127910iErQde','Shop\x20access\x20required','Invalid\x20or\x20expired\x20token','jsonwebtoken','Account\x20is\x20suspended\x20or\x20inactive.\x20Contact\x20administrator\x20to\x20activate\x20your\x20account.','4816385xMRcjG','44xDbmTB','Error\x20checking\x20account\x20status:','546681XpgnUC','split','shop','json','requireActiveShop','default','Error\x20checking\x20account\x20status','isTokenBlacklisted','2942qUohjc','tokenBlacklistService','user','522voNqbR','ACTIVE','requireShop','admin','12nSomTG','secret','Access\x20token\x20required','config','__esModule','requireAdmin','../services/tokenBlacklistService','../config/database','__importDefault','Admin\x20access\x20required','role','authenticateToken','status','3283430pwAYOk','Token\x20has\x20been\x20revoked','SUSPENDED'];a18_0x4a8c=function(){return _0x13d4eb;};return a18_0x4a8c();}const jsonwebtoken_1=__importDefault(require(a18_0x43522b(0xdc))),config_1=require(a18_0x43522b(0xd7)),tokenBlacklistService_1=require(a18_0x43522b(0xc9)),authenticateToken=(_0x3dd793,_0xdd5af6,_0x16879b)=>{const _0x4f3154=a18_0x43522b,_0x40a2ec=_0x3dd793['headers'][_0x4f3154(0xd5)],_0x8a6626=_0x40a2ec&&_0x40a2ec[_0x4f3154(0xe2)]('\x20')[0x1];if(!_0x8a6626)return _0xdd5af6[_0x4f3154(0xcf)](0x191)[_0x4f3154(0xe4)]({'success':![],'message':_0x4f3154(0xc5)});if(tokenBlacklistService_1[_0x4f3154(0xea)][_0x4f3154(0xe8)](_0x8a6626))return _0xdd5af6[_0x4f3154(0xcf)](0x191)[_0x4f3154(0xe4)]({'success':![],'message':_0x4f3154(0xd1)});jsonwebtoken_1[_0x4f3154(0xe6)]['verify'](_0x8a6626,config_1[_0x4f3154(0xc6)][_0x4f3154(0xd4)][_0x4f3154(0xf1)],(_0x338c87,_0x529daf)=>{const _0x52dcae=_0x4f3154;if(_0x338c87)return _0xdd5af6[_0x52dcae(0xcf)](0x193)[_0x52dcae(0xe4)]({'success':![],'message':_0x52dcae(0xdb)});_0x3dd793['user']=_0x529daf,_0x3dd793['token']=_0x8a6626,_0x16879b();});};exports[a18_0x43522b(0xce)]=authenticateToken;const requireAdmin=(_0x44bb77,_0x376253,_0xfcfa08)=>{const _0xfb96b8=a18_0x43522b;if(!_0x44bb77['user']||_0x44bb77['user'][_0xfb96b8(0xcd)]!==_0xfb96b8(0xef))return _0x376253[_0xfb96b8(0xcf)](0x193)[_0xfb96b8(0xe4)]({'success':![],'message':_0xfb96b8(0xcc)});_0xfcfa08();};exports[a18_0x43522b(0xc8)]=requireAdmin;const requireShop=(_0x5a0e66,_0x5c79cf,_0x2d7afc)=>{const _0x3996ff=a18_0x43522b;if(!_0x5a0e66[_0x3996ff(0xeb)]||_0x5a0e66['user']['role']!==_0x3996ff(0xe3))return _0x5c79cf[_0x3996ff(0xcf)](0x193)[_0x3996ff(0xe4)]({'success':![],'message':'Shop\x20access\x20required'});_0x2d7afc();};exports[a18_0x43522b(0xee)]=requireShop;const requireActiveShop=async(_0x27d468,_0x46eb9d,_0x8ec647)=>{const _0x302e4c=a18_0x43522b;if(!_0x27d468['user']||_0x27d468['user']['role']!=='shop')return _0x46eb9d[_0x302e4c(0xcf)](0x193)[_0x302e4c(0xe4)]({'success':![],'message':_0x302e4c(0xda)});try{const _0x56c22b=require(_0x302e4c(0xca))[_0x302e4c(0xe6)],_0xa00a86=await _0x56c22b[_0x302e4c(0xe3)][_0x302e4c(0xd8)]({'where':{'id':_0x27d468['user']['id']},'select':{'status':!![]}});if(!_0xa00a86||_0xa00a86[_0x302e4c(0xcf)]!==_0x302e4c(0xed))return _0x46eb9d[_0x302e4c(0xcf)](0x193)['json']({'success':![],'message':_0x302e4c(0xdd),'suspended':_0xa00a86?.[_0x302e4c(0xcf)]===_0x302e4c(0xd2)});_0x8ec647();}catch(_0x3c13a5){return console['error'](_0x302e4c(0xe0),_0x3c13a5),_0x46eb9d[_0x302e4c(0xcf)](0x1f4)[_0x302e4c(0xe4)]({'success':![],'message':_0x302e4c(0xe7)});}};exports[a18_0x43522b(0xe5)]=requireActiveShop;