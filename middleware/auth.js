'use strict';const a21_0x25b92b=a21_0x1e7a;(function(_0x50a533,_0x3d0f82){const _0x19c2a9=a21_0x1e7a,_0x4c019c=_0x50a533();while(!![]){try{const _0x42d08e=parseInt(_0x19c2a9(0x1de))/0x1*(-parseInt(_0x19c2a9(0x1f6))/0x2)+parseInt(_0x19c2a9(0x1f1))/0x3*(-parseInt(_0x19c2a9(0x1df))/0x4)+parseInt(_0x19c2a9(0x203))/0x5*(parseInt(_0x19c2a9(0x1e4))/0x6)+-parseInt(_0x19c2a9(0x1ee))/0x7*(-parseInt(_0x19c2a9(0x1e2))/0x8)+-parseInt(_0x19c2a9(0x200))/0x9*(parseInt(_0x19c2a9(0x206))/0xa)+parseInt(_0x19c2a9(0x20d))/0xb+-parseInt(_0x19c2a9(0x1e5))/0xc;if(_0x42d08e===_0x3d0f82)break;else _0x4c019c['push'](_0x4c019c['shift']());}catch(_0x349924){_0x4c019c['push'](_0x4c019c['shift']());}}}(a21_0x451b,0x99cfa));var __importDefault=this&&this[a21_0x25b92b(0x1e3)]||function(_0x238a43){const _0x105e2c=a21_0x25b92b;return _0x238a43&&_0x238a43[_0x105e2c(0x1eb)]?_0x238a43:{'default':_0x238a43};};function a21_0x1e7a(_0x3175eb,_0x4dc30d){_0x3175eb=_0x3175eb-0x1db;const _0x451b41=a21_0x451b();let _0x1e7adc=_0x451b41[_0x3175eb];return _0x1e7adc;}Object[a21_0x25b92b(0x1ed)](exports,'__esModule',{'value':!![]}),exports[a21_0x25b92b(0x1e8)]=exports['requireShop']=exports[a21_0x25b92b(0x1db)]=exports[a21_0x25b92b(0x1f3)]=void 0x0;const jsonwebtoken_1=__importDefault(require(a21_0x25b92b(0x202))),config_1=require(a21_0x25b92b(0x20c)),tokenBlacklistService_1=require(a21_0x25b92b(0x1dc)),authenticateToken=(_0x1f32cf,_0x3dca28,_0x2b85e3)=>{const _0x5c4dc8=a21_0x25b92b,_0x3c2574=_0x1f32cf[_0x5c4dc8(0x1fb)][_0x5c4dc8(0x204)],_0x261a56=_0x3c2574&&_0x3c2574[_0x5c4dc8(0x208)]('\x20')[0x1];if(!_0x261a56)return _0x3dca28[_0x5c4dc8(0x1fd)](0x191)[_0x5c4dc8(0x1e6)]({'success':![],'message':_0x5c4dc8(0x1f5)});if(tokenBlacklistService_1[_0x5c4dc8(0x1f7)][_0x5c4dc8(0x1ef)](_0x261a56))return _0x3dca28['status'](0x191)[_0x5c4dc8(0x1e6)]({'success':![],'message':_0x5c4dc8(0x1e7)});jsonwebtoken_1[_0x5c4dc8(0x1dd)][_0x5c4dc8(0x1f2)](_0x261a56,config_1[_0x5c4dc8(0x20b)][_0x5c4dc8(0x201)][_0x5c4dc8(0x1f9)],(_0x492edf,_0xdd6d33)=>{const _0x3525b1=_0x5c4dc8;if(_0x492edf)return _0x3dca28[_0x3525b1(0x1fd)](0x193)[_0x3525b1(0x1e6)]({'success':![],'message':_0x3525b1(0x1e0)});_0x1f32cf[_0x3525b1(0x1f8)]=_0xdd6d33,_0x1f32cf[_0x3525b1(0x20a)]=_0x261a56,_0x2b85e3();});};function a21_0x451b(){const _0x4f99ae=['1348mWTVvX','Invalid\x20or\x20expired\x20token','admin','1832ENcRXM','__importDefault','12SbqNBg','117132gTQyHv','json','Token\x20has\x20been\x20revoked','requireActiveShop','shop','Error\x20checking\x20account\x20status','__esModule','ACTIVE','defineProperty','31913KsmCPT','isTokenBlacklisted','Error\x20checking\x20account\x20status:','228OcFMFN','verify','authenticateToken','requireShop','Access\x20token\x20required','348202CeYGCq','tokenBlacklistService','user','secret','role','headers','Admin\x20access\x20required','status','Shop\x20access\x20required','error','10622421ukqRmr','jwt','jsonwebtoken','2014520qQMAFI','authorization','findUnique','10mIyLfT','../config/database','split','SUSPENDED','token','config','../config/config','9529718BwHjVd','requireAdmin','../services/tokenBlacklistService','default','5YOnObT'];a21_0x451b=function(){return _0x4f99ae;};return a21_0x451b();}exports[a21_0x25b92b(0x1f3)]=authenticateToken;const requireAdmin=(_0x92befa,_0x4ac47a,_0x37fc99)=>{const _0x3c7aab=a21_0x25b92b;if(!_0x92befa[_0x3c7aab(0x1f8)]||_0x92befa['user'][_0x3c7aab(0x1fa)]!==_0x3c7aab(0x1e1))return _0x4ac47a[_0x3c7aab(0x1fd)](0x193)['json']({'success':![],'message':_0x3c7aab(0x1fc)});_0x37fc99();};exports[a21_0x25b92b(0x1db)]=requireAdmin;const requireShop=(_0x1f7e89,_0x5728f2,_0x64abb2)=>{const _0x54b549=a21_0x25b92b;if(!_0x1f7e89[_0x54b549(0x1f8)]||_0x1f7e89[_0x54b549(0x1f8)][_0x54b549(0x1fa)]!==_0x54b549(0x1e9))return _0x5728f2[_0x54b549(0x1fd)](0x193)[_0x54b549(0x1e6)]({'success':![],'message':_0x54b549(0x1fe)});_0x64abb2();};exports[a21_0x25b92b(0x1f4)]=requireShop;const requireActiveShop=async(_0x515d01,_0x2f058d,_0x588c3e)=>{const _0x246eba=a21_0x25b92b;if(!_0x515d01[_0x246eba(0x1f8)]||_0x515d01[_0x246eba(0x1f8)]['role']!==_0x246eba(0x1e9))return _0x2f058d['status'](0x193)[_0x246eba(0x1e6)]({'success':![],'message':_0x246eba(0x1fe)});try{const _0x3061e3=require(_0x246eba(0x207))[_0x246eba(0x1dd)],_0x4463e2=await _0x3061e3[_0x246eba(0x1e9)][_0x246eba(0x205)]({'where':{'id':_0x515d01['user']['id']},'select':{'status':!![]}});if(!_0x4463e2||_0x4463e2['status']!==_0x246eba(0x1ec))return _0x2f058d[_0x246eba(0x1fd)](0x193)[_0x246eba(0x1e6)]({'success':![],'message':'Account\x20is\x20suspended\x20or\x20inactive.\x20Contact\x20administrator\x20to\x20activate\x20your\x20account.','suspended':_0x4463e2?.[_0x246eba(0x1fd)]===_0x246eba(0x209)});_0x588c3e();}catch(_0x4fcf75){return console[_0x246eba(0x1ff)](_0x246eba(0x1f0),_0x4fcf75),_0x2f058d['status'](0x1f4)[_0x246eba(0x1e6)]({'success':![],'message':_0x246eba(0x1ea)});}};exports[a21_0x25b92b(0x1e8)]=requireActiveShop;