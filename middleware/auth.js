'use strict';const a15_0x130f67=a15_0x3387;(function(_0x78971d,_0x427059){const _0x1adf25=a15_0x3387,_0x1d9b23=_0x78971d();while(!![]){try{const _0x41267b=-parseInt(_0x1adf25(0x176))/0x1+-parseInt(_0x1adf25(0x159))/0x2*(-parseInt(_0x1adf25(0x15d))/0x3)+-parseInt(_0x1adf25(0x174))/0x4+parseInt(_0x1adf25(0x173))/0x5+parseInt(_0x1adf25(0x164))/0x6+parseInt(_0x1adf25(0x162))/0x7+-parseInt(_0x1adf25(0x15f))/0x8*(parseInt(_0x1adf25(0x169))/0x9);if(_0x41267b===_0x427059)break;else _0x1d9b23['push'](_0x1d9b23['shift']());}catch(_0x59009c){_0x1d9b23['push'](_0x1d9b23['shift']());}}}(a15_0x4307,0x94739));function a15_0x3387(_0x40fbde,_0x55598e){const _0x430738=a15_0x4307();return a15_0x3387=function(_0x33876d,_0x20febb){_0x33876d=_0x33876d-0x157;let _0x4c3d82=_0x430738[_0x33876d];return _0x4c3d82;},a15_0x3387(_0x40fbde,_0x55598e);}var __importDefault=this&&this[a15_0x130f67(0x163)]||function(_0x3683ba){return _0x3683ba&&_0x3683ba['__esModule']?_0x3683ba:{'default':_0x3683ba};};Object[a15_0x130f67(0x161)](exports,a15_0x130f67(0x157),{'value':!![]}),exports[a15_0x130f67(0x16f)]=exports[a15_0x130f67(0x15a)]=exports[a15_0x130f67(0x170)]=void 0x0;const jsonwebtoken_1=__importDefault(require(a15_0x130f67(0x16a))),config_1=require(a15_0x130f67(0x16b)),tokenBlacklistService_1=require('../services/tokenBlacklistService'),authenticateToken=(_0x13affa,_0x17d00f,_0x12589b)=>{const _0x522719=a15_0x130f67,_0x25cff3=_0x13affa['headers'][_0x522719(0x167)],_0x3c05eb=_0x25cff3&&_0x25cff3[_0x522719(0x165)]('\x20')[0x1];if(!_0x3c05eb)return _0x17d00f['status'](0x191)[_0x522719(0x171)]({'success':![],'message':_0x522719(0x168)});if(tokenBlacklistService_1['tokenBlacklistService'][_0x522719(0x178)](_0x3c05eb))return _0x17d00f[_0x522719(0x16d)](0x191)[_0x522719(0x171)]({'success':![],'message':_0x522719(0x16c)});jsonwebtoken_1['default'][_0x522719(0x15b)](_0x3c05eb,config_1[_0x522719(0x15c)][_0x522719(0x158)]['secret'],(_0x4b2961,_0x2b8772)=>{const _0x4ba961=_0x522719;if(_0x4b2961)return _0x17d00f['status'](0x193)[_0x4ba961(0x171)]({'success':![],'message':_0x4ba961(0x16e)});_0x13affa[_0x4ba961(0x177)]=_0x2b8772,_0x13affa[_0x4ba961(0x175)]=_0x3c05eb,_0x12589b();});};exports[a15_0x130f67(0x170)]=authenticateToken;const requireAdmin=(_0x168071,_0x2ae05f,_0x310a5a)=>{const _0x1626c9=a15_0x130f67;if(!_0x168071[_0x1626c9(0x177)]||_0x168071[_0x1626c9(0x177)][_0x1626c9(0x172)]!==_0x1626c9(0x160))return _0x2ae05f[_0x1626c9(0x16d)](0x193)[_0x1626c9(0x171)]({'success':![],'message':'Admin\x20access\x20required'});_0x310a5a();};exports[a15_0x130f67(0x15a)]=requireAdmin;function a15_0x4307(){const _0x298416=['authorization','Access\x20token\x20required','9oJlWgV','jsonwebtoken','../config/config','Token\x20has\x20been\x20revoked','status','Invalid\x20or\x20expired\x20token','requireShop','authenticateToken','json','role','391245aWUbdK','4254632HHjKvJ','token','34272GlYsXB','user','isTokenBlacklisted','__esModule','jwt','166CJNmCL','requireAdmin','verify','config','28983woPqLr','Shop\x20access\x20required','1784632WHaWdi','admin','defineProperty','4768015OCaVXC','__importDefault','2206854PqmKku','split','shop'];a15_0x4307=function(){return _0x298416;};return a15_0x4307();}const requireShop=(_0xc56526,_0x30485f,_0x2987bb)=>{const _0x14bbd4=a15_0x130f67;if(!_0xc56526[_0x14bbd4(0x177)]||_0xc56526[_0x14bbd4(0x177)][_0x14bbd4(0x172)]!==_0x14bbd4(0x166))return _0x30485f['status'](0x193)[_0x14bbd4(0x171)]({'success':![],'message':_0x14bbd4(0x15e)});_0x2987bb();};exports['requireShop']=requireShop;