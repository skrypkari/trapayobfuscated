'use strict';const a17_0x519e73=a17_0x3bac;(function(_0x244965,_0x53f4a2){const _0x462e7e=a17_0x3bac,_0x54cad4=_0x244965();while(!![]){try{const _0x1e2593=-parseInt(_0x462e7e(0xf5))/0x1*(parseInt(_0x462e7e(0xf1))/0x2)+-parseInt(_0x462e7e(0xe9))/0x3+parseInt(_0x462e7e(0xe5))/0x4*(parseInt(_0x462e7e(0xd6))/0x5)+-parseInt(_0x462e7e(0xe6))/0x6+parseInt(_0x462e7e(0xd9))/0x7*(parseInt(_0x462e7e(0xf9))/0x8)+-parseInt(_0x462e7e(0xf4))/0x9*(parseInt(_0x462e7e(0xec))/0xa)+-parseInt(_0x462e7e(0xd7))/0xb*(-parseInt(_0x462e7e(0xd8))/0xc);if(_0x1e2593===_0x53f4a2)break;else _0x54cad4['push'](_0x54cad4['shift']());}catch(_0x2fa631){_0x54cad4['push'](_0x54cad4['shift']());}}}(a17_0xc09e,0x68a99));function a17_0x3bac(_0x4f4353,_0x19b946){const _0xc09e87=a17_0xc09e();return a17_0x3bac=function(_0x3bac5c,_0x352e53){_0x3bac5c=_0x3bac5c-0xd2;let _0x7ff0ea=_0xc09e87[_0x3bac5c];return _0x7ff0ea;},a17_0x3bac(_0x4f4353,_0x19b946);}var __importDefault=this&&this['__importDefault']||function(_0x4605e7){const _0x4a1521=a17_0x3bac;return _0x4605e7&&_0x4605e7[_0x4a1521(0xfa)]?_0x4605e7:{'default':_0x4605e7};};Object['defineProperty'](exports,a17_0x519e73(0xfa),{'value':!![]}),exports[a17_0x519e73(0xf0)]=exports[a17_0x519e73(0xe7)]=exports[a17_0x519e73(0xeb)]=exports['authenticateToken']=void 0x0;const jsonwebtoken_1=__importDefault(require(a17_0x519e73(0xf6))),config_1=require(a17_0x519e73(0xe8)),tokenBlacklistService_1=require(a17_0x519e73(0xed)),authenticateToken=(_0x112a55,_0x1a02db,_0x149a0d)=>{const _0x16bb7b=a17_0x519e73,_0x47b38e=_0x112a55[_0x16bb7b(0xf8)][_0x16bb7b(0xd4)],_0x556c1b=_0x47b38e&&_0x47b38e[_0x16bb7b(0xe2)]('\x20')[0x1];if(!_0x556c1b)return _0x1a02db[_0x16bb7b(0xd3)](0x191)[_0x16bb7b(0xef)]({'success':![],'message':_0x16bb7b(0xe3)});if(tokenBlacklistService_1[_0x16bb7b(0xdc)]['isTokenBlacklisted'](_0x556c1b))return _0x1a02db[_0x16bb7b(0xd3)](0x191)[_0x16bb7b(0xef)]({'success':![],'message':'Token\x20has\x20been\x20revoked'});jsonwebtoken_1[_0x16bb7b(0xdd)][_0x16bb7b(0xe1)](_0x556c1b,config_1[_0x16bb7b(0xee)]['jwt'][_0x16bb7b(0xea)],(_0x1293d6,_0x390cba)=>{const _0x540b07=_0x16bb7b;if(_0x1293d6)return _0x1a02db[_0x540b07(0xd3)](0x193)[_0x540b07(0xef)]({'success':![],'message':'Invalid\x20or\x20expired\x20token'});_0x112a55[_0x540b07(0xe0)]=_0x390cba,_0x112a55[_0x540b07(0xf7)]=_0x556c1b,_0x149a0d();});};exports[a17_0x519e73(0xe4)]=authenticateToken;const requireAdmin=(_0x5eb0a3,_0x3411d6,_0xdaa98f)=>{const _0xe7cfc5=a17_0x519e73;if(!_0x5eb0a3[_0xe7cfc5(0xe0)]||_0x5eb0a3[_0xe7cfc5(0xe0)][_0xe7cfc5(0xdf)]!==_0xe7cfc5(0xd2))return _0x3411d6[_0xe7cfc5(0xd3)](0x193)['json']({'success':![],'message':_0xe7cfc5(0xda)});_0xdaa98f();};exports[a17_0x519e73(0xeb)]=requireAdmin;function a17_0xc09e(){const _0x49f496=['headers','1528ndkzWo','__esModule','admin','status','authorization','shop','1059300RlVYbT','1275791aqcbZi','96YXptDd','6293agZZiA','Admin\x20access\x20required','Shop\x20access\x20required','tokenBlacklistService','default','ACTIVE','role','user','verify','split','Access\x20token\x20required','authenticateToken','4XkuQft','692892ipwrAy','requireShop','../config/config','24912ZYZRvV','secret','requireAdmin','1972690kduOaT','../services/tokenBlacklistService','config','json','requireActiveShop','2958jFbJzh','findUnique','Error\x20checking\x20account\x20status','27JqzHCN','113fMIxwW','jsonwebtoken','token'];a17_0xc09e=function(){return _0x49f496;};return a17_0xc09e();}const requireShop=(_0x82c66d,_0x4627ac,_0x137679)=>{const _0x2c8dfe=a17_0x519e73;if(!_0x82c66d[_0x2c8dfe(0xe0)]||_0x82c66d[_0x2c8dfe(0xe0)]['role']!==_0x2c8dfe(0xd5))return _0x4627ac[_0x2c8dfe(0xd3)](0x193)['json']({'success':![],'message':_0x2c8dfe(0xdb)});_0x137679();};exports[a17_0x519e73(0xe7)]=requireShop;const requireActiveShop=async(_0x15103c,_0x3a2bf7,_0x7a4c57)=>{const _0x4ad2e1=a17_0x519e73;if(!_0x15103c[_0x4ad2e1(0xe0)]||_0x15103c[_0x4ad2e1(0xe0)]['role']!==_0x4ad2e1(0xd5))return _0x3a2bf7['status'](0x193)[_0x4ad2e1(0xef)]({'success':![],'message':_0x4ad2e1(0xdb)});try{const _0x437723=require('../config/database')[_0x4ad2e1(0xdd)],_0x3c2f25=await _0x437723[_0x4ad2e1(0xd5)][_0x4ad2e1(0xf2)]({'where':{'id':_0x15103c['user']['id']},'select':{'status':!![]}});if(!_0x3c2f25||_0x3c2f25[_0x4ad2e1(0xd3)]!==_0x4ad2e1(0xde))return _0x3a2bf7['status'](0x193)['json']({'success':![],'message':'Account\x20is\x20suspended\x20or\x20inactive.\x20Contact\x20administrator\x20to\x20activate\x20your\x20account.','suspended':_0x3c2f25?.[_0x4ad2e1(0xd3)]==='SUSPENDED'});_0x7a4c57();}catch(_0x480cf0){return console['error']('Error\x20checking\x20account\x20status:',_0x480cf0),_0x3a2bf7[_0x4ad2e1(0xd3)](0x1f4)['json']({'success':![],'message':_0x4ad2e1(0xf3)});}};exports[a17_0x519e73(0xf0)]=requireActiveShop;