'use strict';function a15_0x4d03(){const _0x1f438f=['requireShop','verify','1LJDhva','split','authenticateToken','requireAdmin','user','18846542BpZhJF','Token\x20has\x20been\x20revoked','138010XdAElG','authorization','headers','shop','152RAdQYf','489377ZeMvVf','Access\x20token\x20required','4uFLudV','defineProperty','__esModule','token','tokenBlacklistService','13OUuxJY','role','161485HOLcEy','Shop\x20access\x20required','status','default','../services/tokenBlacklistService','27kaevbb','19885956djphzh','json','jsonwebtoken','306XppKRq','2901174KIjNkJ','Invalid\x20or\x20expired\x20token','jwt','__importDefault','1639390DnYGho'];a15_0x4d03=function(){return _0x1f438f;};return a15_0x4d03();}const a15_0xcbef63=a15_0x2d6f;(function(_0x37e9e0,_0x47bd14){const _0x765e5e=a15_0x2d6f,_0x4af5be=_0x37e9e0();while(!![]){try{const _0x30bc04=-parseInt(_0x765e5e(0x7d))/0x1*(parseInt(_0x765e5e(0x84))/0x2)+-parseInt(_0x765e5e(0x9c))/0x3*(-parseInt(_0x765e5e(0x8b))/0x4)+parseInt(_0x765e5e(0x92))/0x5*(parseInt(_0x765e5e(0x9b))/0x6)+parseInt(_0x765e5e(0x89))/0x7*(parseInt(_0x765e5e(0x88))/0x8)+-parseInt(_0x765e5e(0x97))/0x9*(-parseInt(_0x765e5e(0x7a))/0xa)+-parseInt(_0x765e5e(0x82))/0xb+parseInt(_0x765e5e(0x98))/0xc*(-parseInt(_0x765e5e(0x90))/0xd);if(_0x30bc04===_0x47bd14)break;else _0x4af5be['push'](_0x4af5be['shift']());}catch(_0x51a2a1){_0x4af5be['push'](_0x4af5be['shift']());}}}(a15_0x4d03,0xf2e19));var __importDefault=this&&this[a15_0xcbef63(0x79)]||function(_0x384981){return _0x384981&&_0x384981['__esModule']?_0x384981:{'default':_0x384981};};Object[a15_0xcbef63(0x8c)](exports,a15_0xcbef63(0x8d),{'value':!![]}),exports[a15_0xcbef63(0x7b)]=exports[a15_0xcbef63(0x80)]=exports[a15_0xcbef63(0x7f)]=void 0x0;const jsonwebtoken_1=__importDefault(require(a15_0xcbef63(0x9a))),config_1=require('../config/config'),tokenBlacklistService_1=require(a15_0xcbef63(0x96)),authenticateToken=(_0x3c8d6a,_0x2a8d7b,_0x840c84)=>{const _0x2d2be1=a15_0xcbef63,_0x2a018e=_0x3c8d6a[_0x2d2be1(0x86)][_0x2d2be1(0x85)],_0x5712b2=_0x2a018e&&_0x2a018e[_0x2d2be1(0x7e)]('\x20')[0x1];if(!_0x5712b2)return _0x2a8d7b[_0x2d2be1(0x94)](0x191)[_0x2d2be1(0x99)]({'success':![],'message':_0x2d2be1(0x8a)});if(tokenBlacklistService_1[_0x2d2be1(0x8f)]['isTokenBlacklisted'](_0x5712b2))return _0x2a8d7b[_0x2d2be1(0x94)](0x191)['json']({'success':![],'message':_0x2d2be1(0x83)});jsonwebtoken_1[_0x2d2be1(0x95)][_0x2d2be1(0x7c)](_0x5712b2,config_1['config'][_0x2d2be1(0x78)]['secret'],(_0x31c790,_0x2630b8)=>{const _0x5aaafd=_0x2d2be1;if(_0x31c790)return _0x2a8d7b['status'](0x193)['json']({'success':![],'message':_0x5aaafd(0x9d)});_0x3c8d6a['user']=_0x2630b8,_0x3c8d6a[_0x5aaafd(0x8e)]=_0x5712b2,_0x840c84();});};exports['authenticateToken']=authenticateToken;const requireAdmin=(_0x23c44d,_0x3fa99d,_0x41b50e)=>{const _0x5d9e87=a15_0xcbef63;if(!_0x23c44d[_0x5d9e87(0x81)]||_0x23c44d[_0x5d9e87(0x81)][_0x5d9e87(0x91)]!=='admin')return _0x3fa99d[_0x5d9e87(0x94)](0x193)['json']({'success':![],'message':'Admin\x20access\x20required'});_0x41b50e();};exports[a15_0xcbef63(0x80)]=requireAdmin;function a15_0x2d6f(_0x36d66d,_0x70831f){const _0x4d033f=a15_0x4d03();return a15_0x2d6f=function(_0x2d6f9b,_0xe1be17){_0x2d6f9b=_0x2d6f9b-0x78;let _0x3a1de3=_0x4d033f[_0x2d6f9b];return _0x3a1de3;},a15_0x2d6f(_0x36d66d,_0x70831f);}const requireShop=(_0x5bb536,_0x4a6955,_0x524cb1)=>{const _0x16b3a7=a15_0xcbef63;if(!_0x5bb536[_0x16b3a7(0x81)]||_0x5bb536[_0x16b3a7(0x81)][_0x16b3a7(0x91)]!==_0x16b3a7(0x87))return _0x4a6955[_0x16b3a7(0x94)](0x193)[_0x16b3a7(0x99)]({'success':![],'message':_0x16b3a7(0x93)});_0x524cb1();};exports['requireShop']=requireShop;