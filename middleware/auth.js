'use strict';const a16_0x38d789=a16_0x3212;function a16_0x4675(){const _0x360c30=['3070293oUImyN','authorization','Token\x20has\x20been\x20revoked','headers','58728EJvSIF','7154959NGiQBp','status','__esModule','token','requireShop','defineProperty','authenticateToken','requireAdmin','830YQvyTY','user','15965064MnEZag','jwt','jsonwebtoken','default','11NwJoQg','../services/tokenBlacklistService','role','__importDefault','Shop\x20access\x20required','8rrexWH','2926090vpEvbz','Access\x20token\x20required','Invalid\x20or\x20expired\x20token','isTokenBlacklisted','config','4gqJZOZ','1675202bxGHYX','verify','1375958udnIoT','secret','Admin\x20access\x20required','json','admin'];a16_0x4675=function(){return _0x360c30;};return a16_0x4675();}(function(_0x53522f,_0x1a0a74){const _0x20ba81=a16_0x3212,_0x4383a3=_0x53522f();while(!![]){try{const _0x64ff06=-parseInt(_0x20ba81(0x168))/0x1+parseInt(_0x20ba81(0x16a))/0x2+-parseInt(_0x20ba81(0x16f))/0x3*(-parseInt(_0x20ba81(0x167))/0x4)+parseInt(_0x20ba81(0x17c))/0x5*(-parseInt(_0x20ba81(0x173))/0x6)+-parseInt(_0x20ba81(0x174))/0x7*(-parseInt(_0x20ba81(0x161))/0x8)+parseInt(_0x20ba81(0x17e))/0x9+-parseInt(_0x20ba81(0x162))/0xa*(parseInt(_0x20ba81(0x15c))/0xb);if(_0x64ff06===_0x1a0a74)break;else _0x4383a3['push'](_0x4383a3['shift']());}catch(_0x1f21b9){_0x4383a3['push'](_0x4383a3['shift']());}}}(a16_0x4675,0xdf588));function a16_0x3212(_0x260aa2,_0x5ab1af){const _0x4675c6=a16_0x4675();return a16_0x3212=function(_0x3212fd,_0x570655){_0x3212fd=_0x3212fd-0x15a;let _0x213550=_0x4675c6[_0x3212fd];return _0x213550;},a16_0x3212(_0x260aa2,_0x5ab1af);}var __importDefault=this&&this[a16_0x38d789(0x15f)]||function(_0x3e275b){return _0x3e275b&&_0x3e275b['__esModule']?_0x3e275b:{'default':_0x3e275b};};Object[a16_0x38d789(0x179)](exports,a16_0x38d789(0x176),{'value':!![]}),exports[a16_0x38d789(0x178)]=exports[a16_0x38d789(0x17b)]=exports['authenticateToken']=void 0x0;const jsonwebtoken_1=__importDefault(require(a16_0x38d789(0x15a))),config_1=require('../config/config'),tokenBlacklistService_1=require(a16_0x38d789(0x15d)),authenticateToken=(_0xd5ed6a,_0x496650,_0x5d42e6)=>{const _0x5a0d1f=a16_0x38d789,_0x96ab0f=_0xd5ed6a[_0x5a0d1f(0x172)][_0x5a0d1f(0x170)],_0x1324d6=_0x96ab0f&&_0x96ab0f['split']('\x20')[0x1];if(!_0x1324d6)return _0x496650[_0x5a0d1f(0x175)](0x191)[_0x5a0d1f(0x16d)]({'success':![],'message':_0x5a0d1f(0x163)});if(tokenBlacklistService_1['tokenBlacklistService'][_0x5a0d1f(0x165)](_0x1324d6))return _0x496650['status'](0x191)[_0x5a0d1f(0x16d)]({'success':![],'message':_0x5a0d1f(0x171)});jsonwebtoken_1[_0x5a0d1f(0x15b)][_0x5a0d1f(0x169)](_0x1324d6,config_1[_0x5a0d1f(0x166)][_0x5a0d1f(0x17f)][_0x5a0d1f(0x16b)],(_0x17208a,_0x44586b)=>{const _0x174886=_0x5a0d1f;if(_0x17208a)return _0x496650['status'](0x193)[_0x174886(0x16d)]({'success':![],'message':_0x174886(0x164)});_0xd5ed6a['user']=_0x44586b,_0xd5ed6a[_0x174886(0x177)]=_0x1324d6,_0x5d42e6();});};exports[a16_0x38d789(0x17a)]=authenticateToken;const requireAdmin=(_0x58fbc0,_0x5cc8c8,_0x56f3fa)=>{const _0xa95d97=a16_0x38d789;if(!_0x58fbc0[_0xa95d97(0x17d)]||_0x58fbc0['user'][_0xa95d97(0x15e)]!==_0xa95d97(0x16e))return _0x5cc8c8[_0xa95d97(0x175)](0x193)[_0xa95d97(0x16d)]({'success':![],'message':_0xa95d97(0x16c)});_0x56f3fa();};exports[a16_0x38d789(0x17b)]=requireAdmin;const requireShop=(_0x3a8123,_0x2077a0,_0x5728c0)=>{const _0x2bc3f6=a16_0x38d789;if(!_0x3a8123[_0x2bc3f6(0x17d)]||_0x3a8123['user']['role']!=='shop')return _0x2077a0[_0x2bc3f6(0x175)](0x193)[_0x2bc3f6(0x16d)]({'success':![],'message':_0x2bc3f6(0x160)});_0x5728c0();};exports[a16_0x38d789(0x178)]=requireShop;