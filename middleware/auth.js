'use strict';const a16_0xc635f8=a16_0x4d4f;(function(_0x541545,_0x205e88){const _0x122261=a16_0x4d4f,_0x5c90ba=_0x541545();while(!![]){try{const _0x14a47d=parseInt(_0x122261(0x19d))/0x1+-parseInt(_0x122261(0x192))/0x2+parseInt(_0x122261(0x1a1))/0x3*(-parseInt(_0x122261(0x195))/0x4)+-parseInt(_0x122261(0x186))/0x5+-parseInt(_0x122261(0x1a8))/0x6*(parseInt(_0x122261(0x18c))/0x7)+parseInt(_0x122261(0x196))/0x8*(-parseInt(_0x122261(0x1a3))/0x9)+parseInt(_0x122261(0x19c))/0xa;if(_0x14a47d===_0x205e88)break;else _0x5c90ba['push'](_0x5c90ba['shift']());}catch(_0x3ddbf1){_0x5c90ba['push'](_0x5c90ba['shift']());}}}(a16_0x2504,0x48f2b));var __importDefault=this&&this['__importDefault']||function(_0x3d51c0){const _0x52c4b9=a16_0x4d4f;return _0x3d51c0&&_0x3d51c0[_0x52c4b9(0x182)]?_0x3d51c0:{'default':_0x3d51c0};};Object['defineProperty'](exports,a16_0xc635f8(0x182),{'value':!![]}),exports['requireActiveShop']=exports[a16_0xc635f8(0x1a0)]=exports['requireAdmin']=exports['authenticateToken']=void 0x0;const jsonwebtoken_1=__importDefault(require(a16_0xc635f8(0x197))),config_1=require(a16_0xc635f8(0x193)),tokenBlacklistService_1=require(a16_0xc635f8(0x198)),authenticateToken=(_0x2214c6,_0x2ad398,_0x23282f)=>{const _0x8ff8a0=a16_0xc635f8,_0x37070a=_0x2214c6['headers'][_0x8ff8a0(0x18b)],_0xc2ad70=_0x37070a&&_0x37070a[_0x8ff8a0(0x18a)]('\x20')[0x1];if(!_0xc2ad70)return _0x2ad398['status'](0x191)['json']({'success':![],'message':_0x8ff8a0(0x185)});if(tokenBlacklistService_1[_0x8ff8a0(0x188)][_0x8ff8a0(0x1a9)](_0xc2ad70))return _0x2ad398[_0x8ff8a0(0x18f)](0x191)['json']({'success':![],'message':_0x8ff8a0(0x1a5)});jsonwebtoken_1['default'][_0x8ff8a0(0x191)](_0xc2ad70,config_1['config']['jwt'][_0x8ff8a0(0x19b)],(_0x482194,_0x268923)=>{const _0xb8b2ea=_0x8ff8a0;if(_0x482194)return _0x2ad398[_0xb8b2ea(0x18f)](0x193)[_0xb8b2ea(0x1a7)]({'success':![],'message':_0xb8b2ea(0x190)});_0x2214c6[_0xb8b2ea(0x1a6)]=_0x268923,_0x2214c6['token']=_0xc2ad70,_0x23282f();});};exports[a16_0xc635f8(0x1a4)]=authenticateToken;const requireAdmin=(_0x565fcd,_0x4608cf,_0x3b3bec)=>{const _0x143c1a=a16_0xc635f8;if(!_0x565fcd[_0x143c1a(0x1a6)]||_0x565fcd[_0x143c1a(0x1a6)][_0x143c1a(0x184)]!==_0x143c1a(0x187))return _0x4608cf[_0x143c1a(0x18f)](0x193)[_0x143c1a(0x1a7)]({'success':![],'message':'Admin\x20access\x20required'});_0x3b3bec();};function a16_0x2504(){const _0x4f8a42=['error','default','requireShop','479355PsaOcP','shop','157761OkZKin','authenticateToken','Token\x20has\x20been\x20revoked','user','json','1592358nqzwDk','isTokenBlacklisted','__esModule','findUnique','role','Access\x20token\x20required','2819485nbikcp','admin','tokenBlacklistService','requireAdmin','split','authorization','7fMLKOz','SUSPENDED','Account\x20is\x20suspended\x20or\x20inactive.\x20Contact\x20administrator\x20to\x20activate\x20your\x20account.','status','Invalid\x20or\x20expired\x20token','verify','863232hYaFLu','../config/config','requireActiveShop','12mMkvka','56ZTNZFl','jsonwebtoken','../services/tokenBlacklistService','Shop\x20access\x20required','../config/database','secret','20127550AygOhX','149004OITbZc'];a16_0x2504=function(){return _0x4f8a42;};return a16_0x2504();}exports[a16_0xc635f8(0x189)]=requireAdmin;const requireShop=(_0x1aea09,_0x4649a4,_0x5bcd7c)=>{const _0x41b718=a16_0xc635f8;if(!_0x1aea09[_0x41b718(0x1a6)]||_0x1aea09[_0x41b718(0x1a6)]['role']!==_0x41b718(0x1a2))return _0x4649a4[_0x41b718(0x18f)](0x193)[_0x41b718(0x1a7)]({'success':![],'message':'Shop\x20access\x20required'});_0x5bcd7c();};function a16_0x4d4f(_0x4024ca,_0x49f61e){const _0x250496=a16_0x2504();return a16_0x4d4f=function(_0x4d4f04,_0x10d402){_0x4d4f04=_0x4d4f04-0x182;let _0x368609=_0x250496[_0x4d4f04];return _0x368609;},a16_0x4d4f(_0x4024ca,_0x49f61e);}exports[a16_0xc635f8(0x1a0)]=requireShop;const requireActiveShop=async(_0x3818fd,_0x2d2869,_0x35ab69)=>{const _0x2e1ead=a16_0xc635f8;if(!_0x3818fd[_0x2e1ead(0x1a6)]||_0x3818fd['user'][_0x2e1ead(0x184)]!==_0x2e1ead(0x1a2))return _0x2d2869[_0x2e1ead(0x18f)](0x193)[_0x2e1ead(0x1a7)]({'success':![],'message':_0x2e1ead(0x199)});try{const _0x2f8a21=require(_0x2e1ead(0x19a))[_0x2e1ead(0x19f)],_0x3e4319=await _0x2f8a21[_0x2e1ead(0x1a2)][_0x2e1ead(0x183)]({'where':{'id':_0x3818fd[_0x2e1ead(0x1a6)]['id']},'select':{'status':!![]}});if(!_0x3e4319||_0x3e4319[_0x2e1ead(0x18f)]!=='ACTIVE')return _0x2d2869[_0x2e1ead(0x18f)](0x193)['json']({'success':![],'message':_0x2e1ead(0x18e),'suspended':_0x3e4319?.[_0x2e1ead(0x18f)]===_0x2e1ead(0x18d)});_0x35ab69();}catch(_0x531e15){return console[_0x2e1ead(0x19e)]('Error\x20checking\x20account\x20status:',_0x531e15),_0x2d2869['status'](0x1f4)[_0x2e1ead(0x1a7)]({'success':![],'message':'Error\x20checking\x20account\x20status'});}};exports[a16_0xc635f8(0x194)]=requireActiveShop;