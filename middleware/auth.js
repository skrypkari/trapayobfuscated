'use strict';const a15_0x40fb36=a15_0x4216;function a15_0x31a9(){const _0x348d81=['11TCJVWJ','role','Access\x20token\x20required','headers','defineProperty','json','config','Admin\x20access\x20required','__esModule','default','verify','token','Token\x20has\x20been\x20revoked','jwt','20ocLNPJ','jsonwebtoken','user','authorization','tokenBlacklistService','Shop\x20access\x20required','status','3640488rSLIsc','secret','944805hPJPEV','112mDxJXa','isTokenBlacklisted','../config/config','shop','194081XTkKlX','requireAdmin','110HGWsYW','requireShop','authenticateToken','78525KrnMKl','2LkIWtW','__importDefault','admin','1349028KKGZGJ','371650pKiLwD','120702xWSoEB','Invalid\x20or\x20expired\x20token'];a15_0x31a9=function(){return _0x348d81;};return a15_0x31a9();}(function(_0x59dbfe,_0x31494c){const _0x3dec4a=a15_0x4216,_0x56740d=_0x59dbfe();while(!![]){try{const _0x4400a1=parseInt(_0x3dec4a(0x1b1))/0x1+parseInt(_0x3dec4a(0x1b7))/0x2*(parseInt(_0x3dec4a(0x1ac))/0x3)+-parseInt(_0x3dec4a(0x1a3))/0x4*(parseInt(_0x3dec4a(0x1bb))/0x5)+parseInt(_0x3dec4a(0x1bc))/0x6*(-parseInt(_0x3dec4a(0x1ad))/0x7)+parseInt(_0x3dec4a(0x1aa))/0x8+-parseInt(_0x3dec4a(0x1b6))/0x9*(parseInt(_0x3dec4a(0x1b3))/0xa)+-parseInt(_0x3dec4a(0x1be))/0xb*(-parseInt(_0x3dec4a(0x1ba))/0xc);if(_0x4400a1===_0x31494c)break;else _0x56740d['push'](_0x56740d['shift']());}catch(_0x563da1){_0x56740d['push'](_0x56740d['shift']());}}}(a15_0x31a9,0x46117));function a15_0x4216(_0x3d359d,_0xdf9bcd){const _0x31a9ce=a15_0x31a9();return a15_0x4216=function(_0x42165b,_0x5ea18b){_0x42165b=_0x42165b-0x19c;let _0x4face9=_0x31a9ce[_0x42165b];return _0x4face9;},a15_0x4216(_0x3d359d,_0xdf9bcd);}var __importDefault=this&&this[a15_0x40fb36(0x1b8)]||function(_0x10bde6){const _0x48e911=a15_0x40fb36;return _0x10bde6&&_0x10bde6[_0x48e911(0x19d)]?_0x10bde6:{'default':_0x10bde6};};Object[a15_0x40fb36(0x1c2)](exports,a15_0x40fb36(0x19d),{'value':!![]}),exports[a15_0x40fb36(0x1b4)]=exports[a15_0x40fb36(0x1b2)]=exports[a15_0x40fb36(0x1b5)]=void 0x0;const jsonwebtoken_1=__importDefault(require(a15_0x40fb36(0x1a4))),config_1=require(a15_0x40fb36(0x1af)),tokenBlacklistService_1=require('../services/tokenBlacklistService'),authenticateToken=(_0x34e700,_0x5cbc11,_0x4447dd)=>{const _0x36dc11=a15_0x40fb36,_0x495ff7=_0x34e700[_0x36dc11(0x1c1)][_0x36dc11(0x1a6)],_0x543059=_0x495ff7&&_0x495ff7['split']('\x20')[0x1];if(!_0x543059)return _0x5cbc11['status'](0x191)[_0x36dc11(0x1c3)]({'success':![],'message':_0x36dc11(0x1c0)});if(tokenBlacklistService_1[_0x36dc11(0x1a7)][_0x36dc11(0x1ae)](_0x543059))return _0x5cbc11[_0x36dc11(0x1a9)](0x191)[_0x36dc11(0x1c3)]({'success':![],'message':_0x36dc11(0x1a1)});jsonwebtoken_1[_0x36dc11(0x19e)][_0x36dc11(0x19f)](_0x543059,config_1[_0x36dc11(0x1c4)][_0x36dc11(0x1a2)][_0x36dc11(0x1ab)],(_0x534144,_0x1779bc)=>{const _0x6eaf2b=_0x36dc11;if(_0x534144)return _0x5cbc11[_0x6eaf2b(0x1a9)](0x193)[_0x6eaf2b(0x1c3)]({'success':![],'message':_0x6eaf2b(0x1bd)});_0x34e700['user']=_0x1779bc,_0x34e700[_0x6eaf2b(0x1a0)]=_0x543059,_0x4447dd();});};exports['authenticateToken']=authenticateToken;const requireAdmin=(_0x1d4e97,_0x510a91,_0x10dc1a)=>{const _0xbf5cdf=a15_0x40fb36;if(!_0x1d4e97[_0xbf5cdf(0x1a5)]||_0x1d4e97['user'][_0xbf5cdf(0x1bf)]!==_0xbf5cdf(0x1b9))return _0x510a91[_0xbf5cdf(0x1a9)](0x193)[_0xbf5cdf(0x1c3)]({'success':![],'message':_0xbf5cdf(0x19c)});_0x10dc1a();};exports[a15_0x40fb36(0x1b2)]=requireAdmin;const requireShop=(_0x267076,_0x344885,_0x293bd7)=>{const _0x1653ff=a15_0x40fb36;if(!_0x267076['user']||_0x267076[_0x1653ff(0x1a5)][_0x1653ff(0x1bf)]!==_0x1653ff(0x1b0))return _0x344885['status'](0x193)[_0x1653ff(0x1c3)]({'success':![],'message':_0x1653ff(0x1a8)});_0x293bd7();};exports['requireShop']=requireShop;