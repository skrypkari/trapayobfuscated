'use strict';const a24_0x50e4d6=a24_0x1045;function a24_0x597e(){const _0x35867d=['Admin\x20access\x20required','2537910Tvyuep','Access\x20token\x20required','error','Token\x20has\x20been\x20revoked','headers','token','config','15AGLTDA','Invalid\x20or\x20expired\x20token','16juFcIc','1237376mSzsZZ','authorization','requireShop','ACTIVE','status','json','Error\x20checking\x20account\x20status','requireActiveShop','verify','admin','1467784kdEWuN','shop','split','2971430KacuRH','user','requireAdmin','13276KhBdAG','152169VaGTOX','Error\x20checking\x20account\x20status:','211482YmVgMi','role','../config/database','authenticateToken','defineProperty','Shop\x20access\x20required','jsonwebtoken','Account\x20is\x20suspended\x20or\x20inactive.\x20Contact\x20administrator\x20to\x20activate\x20your\x20account.','findUnique','38ijdawe','__esModule','default','isTokenBlacklisted'];a24_0x597e=function(){return _0x35867d;};return a24_0x597e();}(function(_0x2e4012,_0x4fd05e){const _0x225ef7=a24_0x1045,_0x347ffb=_0x2e4012();while(!![]){try{const _0x4883b5=-parseInt(_0x225ef7(0x19c))/0x1*(-parseInt(_0x225ef7(0x190))/0x2)+parseInt(_0x225ef7(0x191))/0x3*(-parseInt(_0x225ef7(0x1aa))/0x4)+-parseInt(_0x225ef7(0x1a8))/0x5*(-parseInt(_0x225ef7(0x193))/0x6)+-parseInt(_0x225ef7(0x1ab))/0x7+parseInt(_0x225ef7(0x18a))/0x8+parseInt(_0x225ef7(0x1a1))/0x9+-parseInt(_0x225ef7(0x18d))/0xa;if(_0x4883b5===_0x4fd05e)break;else _0x347ffb['push'](_0x347ffb['shift']());}catch(_0x14ea34){_0x347ffb['push'](_0x347ffb['shift']());}}}(a24_0x597e,0x23cd5));var __importDefault=this&&this['__importDefault']||function(_0x4dcea6){const _0x1e983c=a24_0x1045;return _0x4dcea6&&_0x4dcea6[_0x1e983c(0x19d)]?_0x4dcea6:{'default':_0x4dcea6};};Object[a24_0x50e4d6(0x197)](exports,'__esModule',{'value':!![]}),exports[a24_0x50e4d6(0x187)]=exports[a24_0x50e4d6(0x1ad)]=exports[a24_0x50e4d6(0x18f)]=exports[a24_0x50e4d6(0x196)]=void 0x0;const jsonwebtoken_1=__importDefault(require(a24_0x50e4d6(0x199))),config_1=require('../config/config'),tokenBlacklistService_1=require('../services/tokenBlacklistService'),authenticateToken=(_0x5db47e,_0x24ebf7,_0x3b1732)=>{const _0x3fa654=a24_0x50e4d6,_0xd8d2ec=_0x5db47e[_0x3fa654(0x1a5)][_0x3fa654(0x1ac)],_0x51eda4=_0xd8d2ec&&_0xd8d2ec[_0x3fa654(0x18c)]('\x20')[0x1];if(!_0x51eda4)return _0x24ebf7[_0x3fa654(0x184)](0x191)[_0x3fa654(0x185)]({'success':![],'message':_0x3fa654(0x1a2)});if(tokenBlacklistService_1['tokenBlacklistService'][_0x3fa654(0x19f)](_0x51eda4))return _0x24ebf7['status'](0x191)['json']({'success':![],'message':_0x3fa654(0x1a4)});jsonwebtoken_1['default'][_0x3fa654(0x188)](_0x51eda4,config_1[_0x3fa654(0x1a7)]['jwt']['secret'],(_0x7e29e9,_0x571556)=>{const _0xe1768a=_0x3fa654;if(_0x7e29e9)return _0x24ebf7[_0xe1768a(0x184)](0x193)[_0xe1768a(0x185)]({'success':![],'message':_0xe1768a(0x1a9)});_0x5db47e['user']=_0x571556,_0x5db47e[_0xe1768a(0x1a6)]=_0x51eda4,_0x3b1732();});};exports['authenticateToken']=authenticateToken;const requireAdmin=(_0x1d42ec,_0xb8c70e,_0x49a0bb)=>{const _0x5683b1=a24_0x50e4d6;if(!_0x1d42ec['user']||_0x1d42ec[_0x5683b1(0x18e)][_0x5683b1(0x194)]!==_0x5683b1(0x189))return _0xb8c70e[_0x5683b1(0x184)](0x193)[_0x5683b1(0x185)]({'success':![],'message':_0x5683b1(0x1a0)});_0x49a0bb();};exports[a24_0x50e4d6(0x18f)]=requireAdmin;const requireShop=(_0x3627b6,_0x2706c1,_0x140ebb)=>{const _0x300a9d=a24_0x50e4d6;if(!_0x3627b6[_0x300a9d(0x18e)]||_0x3627b6['user'][_0x300a9d(0x194)]!=='shop')return _0x2706c1['status'](0x193)['json']({'success':![],'message':'Shop\x20access\x20required'});_0x140ebb();};function a24_0x1045(_0x33db90,_0x315e58){_0x33db90=_0x33db90-0x183;const _0x597e72=a24_0x597e();let _0x1045e=_0x597e72[_0x33db90];return _0x1045e;}exports['requireShop']=requireShop;const requireActiveShop=async(_0x12cf73,_0x5bc04a,_0x103f7f)=>{const _0x4390f1=a24_0x50e4d6;if(!_0x12cf73[_0x4390f1(0x18e)]||_0x12cf73['user'][_0x4390f1(0x194)]!==_0x4390f1(0x18b))return _0x5bc04a[_0x4390f1(0x184)](0x193)[_0x4390f1(0x185)]({'success':![],'message':_0x4390f1(0x198)});try{const _0x28d8d3=require(_0x4390f1(0x195))[_0x4390f1(0x19e)],_0x3d3930=await _0x28d8d3[_0x4390f1(0x18b)][_0x4390f1(0x19b)]({'where':{'id':_0x12cf73[_0x4390f1(0x18e)]['id']},'select':{'status':!![]}});if(!_0x3d3930||_0x3d3930['status']!==_0x4390f1(0x183))return _0x5bc04a[_0x4390f1(0x184)](0x193)[_0x4390f1(0x185)]({'success':![],'message':_0x4390f1(0x19a),'suspended':_0x3d3930?.['status']==='SUSPENDED'});_0x103f7f();}catch(_0x20b2e8){return console[_0x4390f1(0x1a3)](_0x4390f1(0x192),_0x20b2e8),_0x5bc04a['status'](0x1f4)[_0x4390f1(0x185)]({'success':![],'message':_0x4390f1(0x186)});}};exports['requireActiveShop']=requireActiveShop;