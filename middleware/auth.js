'use strict';const a17_0x1c5c8f=a17_0xa1d2;(function(_0x4ed7e6,_0x56f47d){const _0x265823=a17_0xa1d2,_0x43f232=_0x4ed7e6();while(!![]){try{const _0x4e2b59=-parseInt(_0x265823(0xee))/0x1*(-parseInt(_0x265823(0xdc))/0x2)+-parseInt(_0x265823(0xf7))/0x3*(-parseInt(_0x265823(0xe7))/0x4)+parseInt(_0x265823(0xf1))/0x5*(-parseInt(_0x265823(0xf6))/0x6)+-parseInt(_0x265823(0xd0))/0x7*(-parseInt(_0x265823(0xcf))/0x8)+parseInt(_0x265823(0xd5))/0x9*(-parseInt(_0x265823(0xcd))/0xa)+parseInt(_0x265823(0xf5))/0xb+-parseInt(_0x265823(0xe2))/0xc*(-parseInt(_0x265823(0xd9))/0xd);if(_0x4e2b59===_0x56f47d)break;else _0x43f232['push'](_0x43f232['shift']());}catch(_0x4f73fe){_0x43f232['push'](_0x43f232['shift']());}}}(a17_0x2d6c,0x8755a));function a17_0xa1d2(_0x2f5ced,_0x531b10){const _0x2d6c0a=a17_0x2d6c();return a17_0xa1d2=function(_0xa1d2e0,_0x2bfa1a){_0xa1d2e0=_0xa1d2e0-0xca;let _0x5aa4c8=_0x2d6c0a[_0xa1d2e0];return _0x5aa4c8;},a17_0xa1d2(_0x2f5ced,_0x531b10);}var __importDefault=this&&this[a17_0x1c5c8f(0xe4)]||function(_0x420677){const _0x4eb9b9=a17_0x1c5c8f;return _0x420677&&_0x420677[_0x4eb9b9(0xf4)]?_0x420677:{'default':_0x420677};};Object[a17_0x1c5c8f(0xf0)](exports,a17_0x1c5c8f(0xf4),{'value':!![]}),exports[a17_0x1c5c8f(0xde)]=exports[a17_0x1c5c8f(0xd8)]=exports['requireAdmin']=exports[a17_0x1c5c8f(0xea)]=void 0x0;const jsonwebtoken_1=__importDefault(require(a17_0x1c5c8f(0xdb))),config_1=require('../config/config'),tokenBlacklistService_1=require(a17_0x1c5c8f(0xe3)),authenticateToken=(_0x1addee,_0x5315e0,_0x4e3b25)=>{const _0x3bed15=a17_0x1c5c8f,_0x28b8a2=_0x1addee[_0x3bed15(0xeb)]['authorization'],_0x45e823=_0x28b8a2&&_0x28b8a2[_0x3bed15(0xcc)]('\x20')[0x1];if(!_0x45e823)return _0x5315e0[_0x3bed15(0xed)](0x191)['json']({'success':![],'message':_0x3bed15(0xca)});if(tokenBlacklistService_1['tokenBlacklistService']['isTokenBlacklisted'](_0x45e823))return _0x5315e0[_0x3bed15(0xed)](0x191)[_0x3bed15(0xe8)]({'success':![],'message':_0x3bed15(0xd7)});jsonwebtoken_1[_0x3bed15(0xef)][_0x3bed15(0xf3)](_0x45e823,config_1['config'][_0x3bed15(0xec)][_0x3bed15(0xe9)],(_0x3ea644,_0x1c2e6c)=>{const _0x2c9f27=_0x3bed15;if(_0x3ea644)return _0x5315e0[_0x2c9f27(0xed)](0x193)['json']({'success':![],'message':'Invalid\x20or\x20expired\x20token'});_0x1addee[_0x2c9f27(0xd1)]=_0x1c2e6c,_0x1addee[_0x2c9f27(0xdd)]=_0x45e823,_0x4e3b25();});};exports[a17_0x1c5c8f(0xea)]=authenticateToken;const requireAdmin=(_0x5dc273,_0xcf6d15,_0x26a24f)=>{const _0x38c70d=a17_0x1c5c8f;if(!_0x5dc273['user']||_0x5dc273[_0x38c70d(0xd1)][_0x38c70d(0xf8)]!==_0x38c70d(0xe6))return _0xcf6d15['status'](0x193)[_0x38c70d(0xe8)]({'success':![],'message':_0x38c70d(0xcb)});_0x26a24f();};exports[a17_0x1c5c8f(0xda)]=requireAdmin;const requireShop=(_0x2e67b2,_0x4ee1e1,_0xc58a68)=>{const _0x144a93=a17_0x1c5c8f;if(!_0x2e67b2['user']||_0x2e67b2[_0x144a93(0xd1)][_0x144a93(0xf8)]!==_0x144a93(0xe5))return _0x4ee1e1['status'](0x193)[_0x144a93(0xe8)]({'success':![],'message':_0x144a93(0xce)});_0xc58a68();};exports[a17_0x1c5c8f(0xd8)]=requireShop;function a17_0x2d6c(){const _0xbabb9c=['9899163NxtZNq','../config/database','Token\x20has\x20been\x20revoked','requireShop','299THHUNa','requireAdmin','jsonwebtoken','26ERgUqg','token','requireActiveShop','error','SUSPENDED','ACTIVE','572172VJPPTZ','../services/tokenBlacklistService','__importDefault','shop','admin','45268NLelva','json','secret','authenticateToken','headers','jwt','status','3823PEQtwM','default','defineProperty','55gLmWEy','Account\x20is\x20suspended\x20or\x20inactive.\x20Contact\x20administrator\x20to\x20activate\x20your\x20account.','verify','__esModule','60445AFwBOT','456474yieAbL','75pPtutS','role','Access\x20token\x20required','Admin\x20access\x20required','split','10jfdXjV','Shop\x20access\x20required','1824eQLGTx','32431VKbctW','user','Error\x20checking\x20account\x20status:','Error\x20checking\x20account\x20status','findUnique'];a17_0x2d6c=function(){return _0xbabb9c;};return a17_0x2d6c();}const requireActiveShop=async(_0x35c9c7,_0x3999f6,_0x57c857)=>{const _0x2169e7=a17_0x1c5c8f;if(!_0x35c9c7[_0x2169e7(0xd1)]||_0x35c9c7[_0x2169e7(0xd1)][_0x2169e7(0xf8)]!==_0x2169e7(0xe5))return _0x3999f6[_0x2169e7(0xed)](0x193)['json']({'success':![],'message':_0x2169e7(0xce)});try{const _0x5a20e6=require(_0x2169e7(0xd6))[_0x2169e7(0xef)],_0x19facf=await _0x5a20e6[_0x2169e7(0xe5)][_0x2169e7(0xd4)]({'where':{'id':_0x35c9c7['user']['id']},'select':{'status':!![]}});if(!_0x19facf||_0x19facf['status']!==_0x2169e7(0xe1))return _0x3999f6['status'](0x193)['json']({'success':![],'message':_0x2169e7(0xf2),'suspended':_0x19facf?.[_0x2169e7(0xed)]===_0x2169e7(0xe0)});_0x57c857();}catch(_0x274a38){return console[_0x2169e7(0xdf)](_0x2169e7(0xd2),_0x274a38),_0x3999f6[_0x2169e7(0xed)](0x1f4)[_0x2169e7(0xe8)]({'success':![],'message':_0x2169e7(0xd3)});}};exports[a17_0x1c5c8f(0xde)]=requireActiveShop;