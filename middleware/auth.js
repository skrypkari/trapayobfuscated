'use strict';const a16_0x226c0a=a16_0x48d4;(function(_0x14b22f,_0xdf61f5){const _0x2afba5=a16_0x48d4,_0x390419=_0x14b22f();while(!![]){try{const _0x4bb332=-parseInt(_0x2afba5(0x133))/0x1*(-parseInt(_0x2afba5(0x14d))/0x2)+parseInt(_0x2afba5(0x13d))/0x3+-parseInt(_0x2afba5(0x135))/0x4*(parseInt(_0x2afba5(0x15f))/0x5)+parseInt(_0x2afba5(0x157))/0x6*(parseInt(_0x2afba5(0x15d))/0x7)+-parseInt(_0x2afba5(0x151))/0x8+-parseInt(_0x2afba5(0x153))/0x9*(-parseInt(_0x2afba5(0x145))/0xa)+-parseInt(_0x2afba5(0x13f))/0xb*(parseInt(_0x2afba5(0x14b))/0xc);if(_0x4bb332===_0xdf61f5)break;else _0x390419['push'](_0x390419['shift']());}catch(_0x35e2e1){_0x390419['push'](_0x390419['shift']());}}}(a16_0x4e16,0x6f4dd));function a16_0x48d4(_0x3c4da9,_0x41ae8c){const _0x4e1694=a16_0x4e16();return a16_0x48d4=function(_0x48d4ce,_0x254851){_0x48d4ce=_0x48d4ce-0x132;let _0x4fb9fc=_0x4e1694[_0x48d4ce];return _0x4fb9fc;},a16_0x48d4(_0x3c4da9,_0x41ae8c);}function a16_0x4e16(){const _0xae5042=['7YcRUYV','authenticateToken','30BYEkHh','shop','requireShop','1UHPOuC','../config/config','77732OCDaNk','error','isTokenBlacklisted','../config/database','SUSPENDED','token','findUnique','split','585744jUrxYP','../services/tokenBlacklistService','583gyRPPa','config','jsonwebtoken','authorization','secret','__esModule','30enGPja','tokenBlacklistService','json','requireAdmin','Account\x20is\x20suspended\x20or\x20inactive.\x20Contact\x20administrator\x20to\x20activate\x20your\x20account.','Access\x20token\x20required','228348faFwNc','headers','1555612aGDzWc','status','role','ACTIVE','6512576HhQcOF','user','2141973xFZyZj','Shop\x20access\x20required','Error\x20checking\x20account\x20status','requireActiveShop','4248378PtnJAc','jwt','Error\x20checking\x20account\x20status:','defineProperty','Admin\x20access\x20required','__importDefault'];a16_0x4e16=function(){return _0xae5042;};return a16_0x4e16();}var __importDefault=this&&this[a16_0x226c0a(0x15c)]||function(_0x5c0efc){return _0x5c0efc&&_0x5c0efc['__esModule']?_0x5c0efc:{'default':_0x5c0efc};};Object[a16_0x226c0a(0x15a)](exports,a16_0x226c0a(0x144),{'value':!![]}),exports[a16_0x226c0a(0x156)]=exports[a16_0x226c0a(0x132)]=exports[a16_0x226c0a(0x148)]=exports['authenticateToken']=void 0x0;const jsonwebtoken_1=__importDefault(require(a16_0x226c0a(0x141))),config_1=require(a16_0x226c0a(0x134)),tokenBlacklistService_1=require(a16_0x226c0a(0x13e)),authenticateToken=(_0x388a39,_0x415aa7,_0x332418)=>{const _0x398bd2=a16_0x226c0a,_0x39be8e=_0x388a39[_0x398bd2(0x14c)][_0x398bd2(0x142)],_0x360905=_0x39be8e&&_0x39be8e[_0x398bd2(0x13c)]('\x20')[0x1];if(!_0x360905)return _0x415aa7[_0x398bd2(0x14e)](0x191)['json']({'success':![],'message':_0x398bd2(0x14a)});if(tokenBlacklistService_1[_0x398bd2(0x146)][_0x398bd2(0x137)](_0x360905))return _0x415aa7[_0x398bd2(0x14e)](0x191)[_0x398bd2(0x147)]({'success':![],'message':'Token\x20has\x20been\x20revoked'});jsonwebtoken_1['default']['verify'](_0x360905,config_1[_0x398bd2(0x140)][_0x398bd2(0x158)][_0x398bd2(0x143)],(_0xaf1cd7,_0x241c76)=>{const _0x329f50=_0x398bd2;if(_0xaf1cd7)return _0x415aa7[_0x329f50(0x14e)](0x193)[_0x329f50(0x147)]({'success':![],'message':'Invalid\x20or\x20expired\x20token'});_0x388a39[_0x329f50(0x152)]=_0x241c76,_0x388a39[_0x329f50(0x13a)]=_0x360905,_0x332418();});};exports[a16_0x226c0a(0x15e)]=authenticateToken;const requireAdmin=(_0x4dc447,_0x40ed49,_0x2aee63)=>{const _0x54c964=a16_0x226c0a;if(!_0x4dc447[_0x54c964(0x152)]||_0x4dc447[_0x54c964(0x152)]['role']!=='admin')return _0x40ed49[_0x54c964(0x14e)](0x193)['json']({'success':![],'message':_0x54c964(0x15b)});_0x2aee63();};exports[a16_0x226c0a(0x148)]=requireAdmin;const requireShop=(_0x50fa68,_0x3822d7,_0x723244)=>{const _0x52ef34=a16_0x226c0a;if(!_0x50fa68[_0x52ef34(0x152)]||_0x50fa68[_0x52ef34(0x152)][_0x52ef34(0x14f)]!==_0x52ef34(0x160))return _0x3822d7['status'](0x193)['json']({'success':![],'message':_0x52ef34(0x154)});_0x723244();};exports[a16_0x226c0a(0x132)]=requireShop;const requireActiveShop=async(_0x22c7de,_0x506315,_0x402b9a)=>{const _0x5bd004=a16_0x226c0a;if(!_0x22c7de[_0x5bd004(0x152)]||_0x22c7de[_0x5bd004(0x152)][_0x5bd004(0x14f)]!==_0x5bd004(0x160))return _0x506315[_0x5bd004(0x14e)](0x193)[_0x5bd004(0x147)]({'success':![],'message':_0x5bd004(0x154)});try{const _0x296bb3=require(_0x5bd004(0x138))['default'],_0x29dffd=await _0x296bb3[_0x5bd004(0x160)][_0x5bd004(0x13b)]({'where':{'id':_0x22c7de[_0x5bd004(0x152)]['id']},'select':{'status':!![]}});if(!_0x29dffd||_0x29dffd[_0x5bd004(0x14e)]!==_0x5bd004(0x150))return _0x506315[_0x5bd004(0x14e)](0x193)[_0x5bd004(0x147)]({'success':![],'message':_0x5bd004(0x149),'suspended':_0x29dffd?.[_0x5bd004(0x14e)]===_0x5bd004(0x139)});_0x402b9a();}catch(_0x40f3c6){return console[_0x5bd004(0x136)](_0x5bd004(0x159),_0x40f3c6),_0x506315[_0x5bd004(0x14e)](0x1f4)[_0x5bd004(0x147)]({'success':![],'message':_0x5bd004(0x155)});}};exports[a16_0x226c0a(0x156)]=requireActiveShop;