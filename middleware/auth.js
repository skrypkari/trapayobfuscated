'use strict';const a17_0x16710a=a17_0x2ae5;(function(_0xa99d4d,_0x37c719){const _0x4136be=a17_0x2ae5,_0x38f24e=_0xa99d4d();while(!![]){try{const _0x4ae232=parseInt(_0x4136be(0x11c))/0x1+parseInt(_0x4136be(0x104))/0x2*(-parseInt(_0x4136be(0xf6))/0x3)+parseInt(_0x4136be(0x112))/0x4+-parseInt(_0x4136be(0x116))/0x5+-parseInt(_0x4136be(0x109))/0x6*(parseInt(_0x4136be(0x117))/0x7)+-parseInt(_0x4136be(0x118))/0x8+parseInt(_0x4136be(0xf9))/0x9;if(_0x4ae232===_0x37c719)break;else _0x38f24e['push'](_0x38f24e['shift']());}catch(_0x15a898){_0x38f24e['push'](_0x38f24e['shift']());}}}(a17_0x48d7,0x21970));var __importDefault=this&&this[a17_0x16710a(0x101)]||function(_0x547435){const _0x5e3655=a17_0x16710a;return _0x547435&&_0x547435[_0x5e3655(0x10c)]?_0x547435:{'default':_0x547435};};function a17_0x48d7(){const _0x305cb4=['split','60104qnIXuZ','status','error','default','requireAdmin','requireShop','Admin\x20access\x20required','282090Jqfqlm','Access\x20token\x20required','defineProperty','6198147eVSKHB','verify','authenticateToken','jwt','requireActiveShop','Invalid\x20or\x20expired\x20token','json','admin','__importDefault','token','../config/config','4wtCEgS','ACTIVE','Account\x20is\x20suspended\x20or\x20inactive.\x20Contact\x20administrator\x20to\x20activate\x20your\x20account.','Token\x20has\x20been\x20revoked','Error\x20checking\x20account\x20status','12IShFbs','SUSPENDED','secret','__esModule','shop','jsonwebtoken','Shop\x20access\x20required','tokenBlacklistService','user','893512ieDNPq','isTokenBlacklisted','role','config','1121175bTPthF','895097yZVcGX','1332352OwEtCx','../config/database','findUnique'];a17_0x48d7=function(){return _0x305cb4;};return a17_0x48d7();}Object[a17_0x16710a(0xf8)](exports,a17_0x16710a(0x10c),{'value':!![]}),exports['requireActiveShop']=exports[a17_0x16710a(0xf4)]=exports['requireAdmin']=exports['authenticateToken']=void 0x0;const jsonwebtoken_1=__importDefault(require(a17_0x16710a(0x10e))),config_1=require(a17_0x16710a(0x103)),tokenBlacklistService_1=require('../services/tokenBlacklistService'),authenticateToken=(_0x131f68,_0x348bd8,_0x2f4daf)=>{const _0x2d6923=a17_0x16710a,_0x2c768b=_0x131f68['headers']['authorization'],_0x25fab2=_0x2c768b&&_0x2c768b[_0x2d6923(0x11b)]('\x20')[0x1];if(!_0x25fab2)return _0x348bd8[_0x2d6923(0x11d)](0x191)[_0x2d6923(0xff)]({'success':![],'message':_0x2d6923(0xf7)});if(tokenBlacklistService_1[_0x2d6923(0x110)][_0x2d6923(0x113)](_0x25fab2))return _0x348bd8[_0x2d6923(0x11d)](0x191)[_0x2d6923(0xff)]({'success':![],'message':_0x2d6923(0x107)});jsonwebtoken_1[_0x2d6923(0xf2)][_0x2d6923(0xfa)](_0x25fab2,config_1[_0x2d6923(0x115)][_0x2d6923(0xfc)][_0x2d6923(0x10b)],(_0x4a8a84,_0xd54936)=>{const _0x2d3a98=_0x2d6923;if(_0x4a8a84)return _0x348bd8[_0x2d3a98(0x11d)](0x193)[_0x2d3a98(0xff)]({'success':![],'message':_0x2d3a98(0xfe)});_0x131f68['user']=_0xd54936,_0x131f68[_0x2d3a98(0x102)]=_0x25fab2,_0x2f4daf();});};exports[a17_0x16710a(0xfb)]=authenticateToken;const requireAdmin=(_0x43d118,_0x5a6585,_0x388f57)=>{const _0xf1fb08=a17_0x16710a;if(!_0x43d118['user']||_0x43d118[_0xf1fb08(0x111)][_0xf1fb08(0x114)]!==_0xf1fb08(0x100))return _0x5a6585[_0xf1fb08(0x11d)](0x193)[_0xf1fb08(0xff)]({'success':![],'message':_0xf1fb08(0xf5)});_0x388f57();};exports[a17_0x16710a(0xf3)]=requireAdmin;const requireShop=(_0x743613,_0x18d880,_0x12e122)=>{const _0x1d845b=a17_0x16710a;if(!_0x743613[_0x1d845b(0x111)]||_0x743613[_0x1d845b(0x111)][_0x1d845b(0x114)]!==_0x1d845b(0x10d))return _0x18d880['status'](0x193)[_0x1d845b(0xff)]({'success':![],'message':_0x1d845b(0x10f)});_0x12e122();};exports[a17_0x16710a(0xf4)]=requireShop;function a17_0x2ae5(_0x1d621d,_0x388621){const _0x48d784=a17_0x48d7();return a17_0x2ae5=function(_0x2ae5c6,_0x403af2){_0x2ae5c6=_0x2ae5c6-0xf1;let _0x4ee850=_0x48d784[_0x2ae5c6];return _0x4ee850;},a17_0x2ae5(_0x1d621d,_0x388621);}const requireActiveShop=async(_0xc1235a,_0x261932,_0x1f455c)=>{const _0x332d7c=a17_0x16710a;if(!_0xc1235a[_0x332d7c(0x111)]||_0xc1235a[_0x332d7c(0x111)][_0x332d7c(0x114)]!==_0x332d7c(0x10d))return _0x261932[_0x332d7c(0x11d)](0x193)[_0x332d7c(0xff)]({'success':![],'message':'Shop\x20access\x20required'});try{const _0x54b910=require(_0x332d7c(0x119))['default'],_0x4dc580=await _0x54b910[_0x332d7c(0x10d)][_0x332d7c(0x11a)]({'where':{'id':_0xc1235a[_0x332d7c(0x111)]['id']},'select':{'status':!![]}});if(!_0x4dc580||_0x4dc580[_0x332d7c(0x11d)]!==_0x332d7c(0x105))return _0x261932['status'](0x193)[_0x332d7c(0xff)]({'success':![],'message':_0x332d7c(0x106),'suspended':_0x4dc580?.[_0x332d7c(0x11d)]===_0x332d7c(0x10a)});_0x1f455c();}catch(_0x1211e2){return console[_0x332d7c(0xf1)]('Error\x20checking\x20account\x20status:',_0x1211e2),_0x261932['status'](0x1f4)[_0x332d7c(0xff)]({'success':![],'message':_0x332d7c(0x108)});}};exports[a17_0x16710a(0xfd)]=requireActiveShop;