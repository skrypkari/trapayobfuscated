'use strict';const a21_0x4f8de7=a21_0x41fc;function a21_0x41fc(_0x5b6ac1,_0x27de7d){_0x5b6ac1=_0x5b6ac1-0x134;const _0x53afb1=a21_0x53af();let _0x41fc94=_0x53afb1[_0x5b6ac1];return _0x41fc94;}function a21_0x53af(){const _0x131792=['Shop\x20access\x20required','9rSRjfM','default','authorization','4023248nNqkEQ','../services/tokenBlacklistService','verify','Admin\x20access\x20required','requireAdmin','3021222ZSRpmL','9YZdNNq','Error\x20checking\x20account\x20status:','../config/config','json','token','error','isTokenBlacklisted','config','requireActiveShop','shop','Error\x20checking\x20account\x20status','admin','10980910uTrXxB','1622488yvzvRs','../config/database','split','1915260QhmXvA','requireShop','role','__importDefault','findUnique','Access\x20token\x20required','authenticateToken','tokenBlacklistService','3439630irRmQB','4HASFUz','Account\x20is\x20suspended\x20or\x20inactive.\x20Contact\x20administrator\x20to\x20activate\x20your\x20account.','Token\x20has\x20been\x20revoked','headers','65614zrLRlc','jsonwebtoken','__esModule','status','jwt','SUSPENDED','user'];a21_0x53af=function(){return _0x131792;};return a21_0x53af();}(function(_0x5bb8b4,_0x2cde1a){const _0x24ddae=a21_0x41fc,_0x28b3b2=_0x5bb8b4();while(!![]){try{const _0x132c5d=-parseInt(_0x24ddae(0x144))/0x1*(parseInt(_0x24ddae(0x13c))/0x2)+-parseInt(_0x24ddae(0x14c))/0x3*(parseInt(_0x24ddae(0x138))/0x4)+parseInt(_0x24ddae(0x137))/0x5+parseInt(_0x24ddae(0x15d))/0x6+parseInt(_0x24ddae(0x15a))/0x7+-parseInt(_0x24ddae(0x147))/0x8+parseInt(_0x24ddae(0x14d))/0x9*(parseInt(_0x24ddae(0x159))/0xa);if(_0x132c5d===_0x2cde1a)break;else _0x28b3b2['push'](_0x28b3b2['shift']());}catch(_0x6783e6){_0x28b3b2['push'](_0x28b3b2['shift']());}}}(a21_0x53af,0x81d38));var __importDefault=this&&this[a21_0x4f8de7(0x160)]||function(_0x393afc){const _0x1458fb=a21_0x4f8de7;return _0x393afc&&_0x393afc[_0x1458fb(0x13e)]?_0x393afc:{'default':_0x393afc};};Object['defineProperty'](exports,a21_0x4f8de7(0x13e),{'value':!![]}),exports['requireActiveShop']=exports[a21_0x4f8de7(0x15e)]=exports[a21_0x4f8de7(0x14b)]=exports[a21_0x4f8de7(0x135)]=void 0x0;const jsonwebtoken_1=__importDefault(require(a21_0x4f8de7(0x13d))),config_1=require(a21_0x4f8de7(0x14f)),tokenBlacklistService_1=require(a21_0x4f8de7(0x148)),authenticateToken=(_0x266aa1,_0x4fe5ad,_0x3261b5)=>{const _0x350fce=a21_0x4f8de7,_0x172ddf=_0x266aa1[_0x350fce(0x13b)][_0x350fce(0x146)],_0x4fa3be=_0x172ddf&&_0x172ddf[_0x350fce(0x15c)]('\x20')[0x1];if(!_0x4fa3be)return _0x4fe5ad[_0x350fce(0x13f)](0x191)[_0x350fce(0x150)]({'success':![],'message':_0x350fce(0x134)});if(tokenBlacklistService_1[_0x350fce(0x136)][_0x350fce(0x153)](_0x4fa3be))return _0x4fe5ad[_0x350fce(0x13f)](0x191)[_0x350fce(0x150)]({'success':![],'message':_0x350fce(0x13a)});jsonwebtoken_1[_0x350fce(0x145)][_0x350fce(0x149)](_0x4fa3be,config_1[_0x350fce(0x154)][_0x350fce(0x140)]['secret'],(_0x25b16e,_0x4c43b3)=>{const _0x376d9e=_0x350fce;if(_0x25b16e)return _0x4fe5ad[_0x376d9e(0x13f)](0x193)[_0x376d9e(0x150)]({'success':![],'message':'Invalid\x20or\x20expired\x20token'});_0x266aa1[_0x376d9e(0x142)]=_0x4c43b3,_0x266aa1[_0x376d9e(0x151)]=_0x4fa3be,_0x3261b5();});};exports[a21_0x4f8de7(0x135)]=authenticateToken;const requireAdmin=(_0x20e0e7,_0x5dbebf,_0x2e5122)=>{const _0x396420=a21_0x4f8de7;if(!_0x20e0e7[_0x396420(0x142)]||_0x20e0e7[_0x396420(0x142)][_0x396420(0x15f)]!==_0x396420(0x158))return _0x5dbebf[_0x396420(0x13f)](0x193)[_0x396420(0x150)]({'success':![],'message':_0x396420(0x14a)});_0x2e5122();};exports['requireAdmin']=requireAdmin;const requireShop=(_0x3f5a64,_0xca61e8,_0x306946)=>{const _0x2bfcbb=a21_0x4f8de7;if(!_0x3f5a64['user']||_0x3f5a64[_0x2bfcbb(0x142)][_0x2bfcbb(0x15f)]!=='shop')return _0xca61e8[_0x2bfcbb(0x13f)](0x193)[_0x2bfcbb(0x150)]({'success':![],'message':_0x2bfcbb(0x143)});_0x306946();};exports[a21_0x4f8de7(0x15e)]=requireShop;const requireActiveShop=async(_0xded5b9,_0x594343,_0x57a0d9)=>{const _0x42f866=a21_0x4f8de7;if(!_0xded5b9[_0x42f866(0x142)]||_0xded5b9[_0x42f866(0x142)][_0x42f866(0x15f)]!==_0x42f866(0x156))return _0x594343['status'](0x193)['json']({'success':![],'message':_0x42f866(0x143)});try{const _0x255b66=require(_0x42f866(0x15b))[_0x42f866(0x145)],_0x3fdd0b=await _0x255b66['shop'][_0x42f866(0x161)]({'where':{'id':_0xded5b9['user']['id']},'select':{'status':!![]}});if(!_0x3fdd0b||_0x3fdd0b[_0x42f866(0x13f)]!=='ACTIVE')return _0x594343[_0x42f866(0x13f)](0x193)[_0x42f866(0x150)]({'success':![],'message':_0x42f866(0x139),'suspended':_0x3fdd0b?.[_0x42f866(0x13f)]===_0x42f866(0x141)});_0x57a0d9();}catch(_0x990393){return console[_0x42f866(0x152)](_0x42f866(0x14e),_0x990393),_0x594343[_0x42f866(0x13f)](0x1f4)[_0x42f866(0x150)]({'success':![],'message':_0x42f866(0x157)});}};exports[a21_0x4f8de7(0x155)]=requireActiveShop;