'use strict';const a15_0x9778e4=a15_0x3b82;(function(_0x3d33a2,_0x2b6479){const _0x3b53d2=a15_0x3b82,_0x92d8b2=_0x3d33a2();while(!![]){try{const _0x4b3be4=parseInt(_0x3b53d2(0x18d))/0x1*(parseInt(_0x3b53d2(0x193))/0x2)+-parseInt(_0x3b53d2(0x182))/0x3*(parseInt(_0x3b53d2(0x19a))/0x4)+parseInt(_0x3b53d2(0x188))/0x5+parseInt(_0x3b53d2(0x18c))/0x6*(-parseInt(_0x3b53d2(0x1a6))/0x7)+-parseInt(_0x3b53d2(0x1a5))/0x8*(-parseInt(_0x3b53d2(0x190))/0x9)+parseInt(_0x3b53d2(0x184))/0xa*(-parseInt(_0x3b53d2(0x1a7))/0xb)+parseInt(_0x3b53d2(0x1a3))/0xc*(parseInt(_0x3b53d2(0x192))/0xd);if(_0x4b3be4===_0x2b6479)break;else _0x92d8b2['push'](_0x92d8b2['shift']());}catch(_0x5a1065){_0x92d8b2['push'](_0x92d8b2['shift']());}}}(a15_0x3604,0xe3bdc));var __importDefault=this&&this[a15_0x9778e4(0x19c)]||function(_0xe57604){const _0x202534=a15_0x9778e4;return _0xe57604&&_0xe57604[_0x202534(0x187)]?_0xe57604:{'default':_0xe57604};};Object[a15_0x9778e4(0x181)](exports,a15_0x9778e4(0x187),{'value':!![]}),exports[a15_0x9778e4(0x185)]=exports['requireAdmin']=exports[a15_0x9778e4(0x19b)]=void 0x0;function a15_0x3604(){const _0x2af001=['29239788WAiBly','Token\x20has\x20been\x20revoked','72bDRAyH','21xsEhvg','20256643Xqdjbf','headers','status','defineProperty','154059RjJxbK','../services/tokenBlacklistService','10glZDXM','requireShop','admin','__esModule','265760PEaoQZ','../config/config','json','authorization','326346wbTsQO','673963fsWZey','Invalid\x20or\x20expired\x20token','Admin\x20access\x20required','749457GXuOvl','tokenBlacklistService','13weVhJS','2kGoWSk','Shop\x20access\x20required','token','jwt','secret','verify','user','76bMVDyv','authenticateToken','__importDefault','Access\x20token\x20required','role','requireAdmin','default','config','jsonwebtoken'];a15_0x3604=function(){return _0x2af001;};return a15_0x3604();}const jsonwebtoken_1=__importDefault(require(a15_0x9778e4(0x1a2))),config_1=require(a15_0x9778e4(0x189)),tokenBlacklistService_1=require(a15_0x9778e4(0x183)),authenticateToken=(_0x83afed,_0x225f67,_0x16ec44)=>{const _0x203827=a15_0x9778e4,_0x374b0c=_0x83afed[_0x203827(0x1a8)][_0x203827(0x18b)],_0x2757d5=_0x374b0c&&_0x374b0c['split']('\x20')[0x1];if(!_0x2757d5)return _0x225f67['status'](0x191)[_0x203827(0x18a)]({'success':![],'message':_0x203827(0x19d)});if(tokenBlacklistService_1[_0x203827(0x191)]['isTokenBlacklisted'](_0x2757d5))return _0x225f67[_0x203827(0x180)](0x191)[_0x203827(0x18a)]({'success':![],'message':_0x203827(0x1a4)});jsonwebtoken_1[_0x203827(0x1a0)][_0x203827(0x198)](_0x2757d5,config_1[_0x203827(0x1a1)][_0x203827(0x196)][_0x203827(0x197)],(_0x2836c1,_0x123e2b)=>{const _0x396915=_0x203827;if(_0x2836c1)return _0x225f67[_0x396915(0x180)](0x193)['json']({'success':![],'message':_0x396915(0x18e)});_0x83afed['user']=_0x123e2b,_0x83afed[_0x396915(0x195)]=_0x2757d5,_0x16ec44();});};exports['authenticateToken']=authenticateToken;const requireAdmin=(_0xb6e712,_0x245886,_0x5c7a36)=>{const _0x41b97f=a15_0x9778e4;if(!_0xb6e712['user']||_0xb6e712['user'][_0x41b97f(0x19e)]!==_0x41b97f(0x186))return _0x245886[_0x41b97f(0x180)](0x193)['json']({'success':![],'message':_0x41b97f(0x18f)});_0x5c7a36();};function a15_0x3b82(_0x1dd1ec,_0x30c81c){const _0x360464=a15_0x3604();return a15_0x3b82=function(_0x3b820c,_0x32dc3d){_0x3b820c=_0x3b820c-0x180;let _0x37eda6=_0x360464[_0x3b820c];return _0x37eda6;},a15_0x3b82(_0x1dd1ec,_0x30c81c);}exports[a15_0x9778e4(0x19f)]=requireAdmin;const requireShop=(_0x26fa74,_0x2554b6,_0x2c258e)=>{const _0x38ed14=a15_0x9778e4;if(!_0x26fa74[_0x38ed14(0x199)]||_0x26fa74[_0x38ed14(0x199)][_0x38ed14(0x19e)]!=='shop')return _0x2554b6[_0x38ed14(0x180)](0x193)[_0x38ed14(0x18a)]({'success':![],'message':_0x38ed14(0x194)});_0x2c258e();};exports['requireShop']=requireShop;