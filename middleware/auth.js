'use strict';const a16_0x58d9b6=a16_0x533d;(function(_0x190255,_0x3bbb46){const _0x1d36f5=a16_0x533d,_0x26fe1a=_0x190255();while(!![]){try{const _0x2cca9a=-parseInt(_0x1d36f5(0x1cc))/0x1*(-parseInt(_0x1d36f5(0x1d7))/0x2)+-parseInt(_0x1d36f5(0x1d3))/0x3+-parseInt(_0x1d36f5(0x1be))/0x4+-parseInt(_0x1d36f5(0x1d5))/0x5*(-parseInt(_0x1d36f5(0x1d6))/0x6)+parseInt(_0x1d36f5(0x1b7))/0x7+parseInt(_0x1d36f5(0x1bb))/0x8+-parseInt(_0x1d36f5(0x1c6))/0x9;if(_0x2cca9a===_0x3bbb46)break;else _0x26fe1a['push'](_0x26fe1a['shift']());}catch(_0x2fdfa4){_0x26fe1a['push'](_0x26fe1a['shift']());}}}(a16_0x5517,0x28b51));function a16_0x5517(){const _0x323bc2=['admin','Admin\x20access\x20required','__esModule','12488tryZIA','Error\x20checking\x20account\x20status:','verify','../config/database','444440KVynWG','Access\x20token\x20required','tokenBlacklistService','55872mVyLet','Token\x20has\x20been\x20revoked','ACTIVE','Account\x20is\x20suspended\x20or\x20inactive.\x20Contact\x20administrator\x20to\x20activate\x20your\x20account.','requireActiveShop','requireShop','json','status','86121lPCpUk','default','Shop\x20access\x20required','requireAdmin','role','findUnique','81358RwhTgx','authorization','../config/config','isTokenBlacklisted','split','user','shop','743679LylADU','authenticateToken','10CGXkZE','898410HiBgPV','2iKlXKi','__importDefault'];a16_0x5517=function(){return _0x323bc2;};return a16_0x5517();}function a16_0x533d(_0x4d3712,_0x28b3f8){const _0x55171d=a16_0x5517();return a16_0x533d=function(_0x533d3e,_0x31ddc3){_0x533d3e=_0x533d3e-0x1b7;let _0x3536af=_0x55171d[_0x533d3e];return _0x3536af;},a16_0x533d(_0x4d3712,_0x28b3f8);}var __importDefault=this&&this[a16_0x58d9b6(0x1d8)]||function(_0x2b23d2){const _0x76b083=a16_0x58d9b6;return _0x2b23d2&&_0x2b23d2[_0x76b083(0x1db)]?_0x2b23d2:{'default':_0x2b23d2};};Object['defineProperty'](exports,a16_0x58d9b6(0x1db),{'value':!![]}),exports[a16_0x58d9b6(0x1c2)]=exports[a16_0x58d9b6(0x1c3)]=exports[a16_0x58d9b6(0x1c9)]=exports[a16_0x58d9b6(0x1d4)]=void 0x0;const jsonwebtoken_1=__importDefault(require('jsonwebtoken')),config_1=require(a16_0x58d9b6(0x1ce)),tokenBlacklistService_1=require('../services/tokenBlacklistService'),authenticateToken=(_0x482765,_0x47573f,_0x500989)=>{const _0xfc10a1=a16_0x58d9b6,_0x3e941b=_0x482765['headers'][_0xfc10a1(0x1cd)],_0x4c17ce=_0x3e941b&&_0x3e941b[_0xfc10a1(0x1d0)]('\x20')[0x1];if(!_0x4c17ce)return _0x47573f['status'](0x191)[_0xfc10a1(0x1c4)]({'success':![],'message':_0xfc10a1(0x1bc)});if(tokenBlacklistService_1[_0xfc10a1(0x1bd)][_0xfc10a1(0x1cf)](_0x4c17ce))return _0x47573f[_0xfc10a1(0x1c5)](0x191)[_0xfc10a1(0x1c4)]({'success':![],'message':_0xfc10a1(0x1bf)});jsonwebtoken_1[_0xfc10a1(0x1c7)][_0xfc10a1(0x1b9)](_0x4c17ce,config_1['config']['jwt']['secret'],(_0x372055,_0x98132b)=>{const _0x5dd7fe=_0xfc10a1;if(_0x372055)return _0x47573f['status'](0x193)[_0x5dd7fe(0x1c4)]({'success':![],'message':'Invalid\x20or\x20expired\x20token'});_0x482765[_0x5dd7fe(0x1d1)]=_0x98132b,_0x482765['token']=_0x4c17ce,_0x500989();});};exports[a16_0x58d9b6(0x1d4)]=authenticateToken;const requireAdmin=(_0x1ce93c,_0x1a401a,_0x232504)=>{const _0x2bc789=a16_0x58d9b6;if(!_0x1ce93c[_0x2bc789(0x1d1)]||_0x1ce93c['user']['role']!==_0x2bc789(0x1d9))return _0x1a401a['status'](0x193)[_0x2bc789(0x1c4)]({'success':![],'message':_0x2bc789(0x1da)});_0x232504();};exports[a16_0x58d9b6(0x1c9)]=requireAdmin;const requireShop=(_0xed112f,_0x4cedd9,_0x3da8d8)=>{const _0x33ae70=a16_0x58d9b6;if(!_0xed112f[_0x33ae70(0x1d1)]||_0xed112f[_0x33ae70(0x1d1)]['role']!==_0x33ae70(0x1d2))return _0x4cedd9[_0x33ae70(0x1c5)](0x193)[_0x33ae70(0x1c4)]({'success':![],'message':_0x33ae70(0x1c8)});_0x3da8d8();};exports[a16_0x58d9b6(0x1c3)]=requireShop;const requireActiveShop=async(_0x1671f0,_0x47c63c,_0x362de9)=>{const _0x163c7b=a16_0x58d9b6;if(!_0x1671f0[_0x163c7b(0x1d1)]||_0x1671f0[_0x163c7b(0x1d1)][_0x163c7b(0x1ca)]!==_0x163c7b(0x1d2))return _0x47c63c[_0x163c7b(0x1c5)](0x193)[_0x163c7b(0x1c4)]({'success':![],'message':_0x163c7b(0x1c8)});try{const _0x9c2f39=require(_0x163c7b(0x1ba))[_0x163c7b(0x1c7)],_0x1eb86e=await _0x9c2f39[_0x163c7b(0x1d2)][_0x163c7b(0x1cb)]({'where':{'id':_0x1671f0[_0x163c7b(0x1d1)]['id']},'select':{'status':!![]}});if(!_0x1eb86e||_0x1eb86e[_0x163c7b(0x1c5)]!==_0x163c7b(0x1c0))return _0x47c63c[_0x163c7b(0x1c5)](0x193)[_0x163c7b(0x1c4)]({'success':![],'message':_0x163c7b(0x1c1),'suspended':_0x1eb86e?.[_0x163c7b(0x1c5)]==='SUSPENDED'});_0x362de9();}catch(_0x399c44){return console['error'](_0x163c7b(0x1b8),_0x399c44),_0x47c63c[_0x163c7b(0x1c5)](0x1f4)[_0x163c7b(0x1c4)]({'success':![],'message':'Error\x20checking\x20account\x20status'});}};exports['requireActiveShop']=requireActiveShop;