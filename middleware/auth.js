'use strict';const a17_0x3a0e68=a17_0x47ad;function a17_0x50ab(){const _0xff9a21=['role','default','status','error','__importDefault','user','headers','__esModule','Account\x20is\x20suspended\x20or\x20inactive.\x20Contact\x20administrator\x20to\x20activate\x20your\x20account.','authenticateToken','shop','split','requireShop','../services/tokenBlacklistService','192xkdWTn','285176EmDpWk','admin','SUSPENDED','tokenBlacklistService','Admin\x20access\x20required','secret','1858150ByFDvP','jwt','jsonwebtoken','ACTIVE','669777IFsgrm','authorization','config','234330nSXVGq','Error\x20checking\x20account\x20status:','2fBFkIv','1836220zUIotZ','22XCVral','isTokenBlacklisted','Token\x20has\x20been\x20revoked','requireAdmin','24731SPTYjp','verify','defineProperty','Shop\x20access\x20required','1064LDxYdO','requireActiveShop','json','2593872ySeJHl'];a17_0x50ab=function(){return _0xff9a21;};return a17_0x50ab();}function a17_0x47ad(_0x1b4670,_0x454456){const _0x50ab6a=a17_0x50ab();return a17_0x47ad=function(_0x47adf4,_0x2a0311){_0x47adf4=_0x47adf4-0x167;let _0x4d2774=_0x50ab6a[_0x47adf4];return _0x4d2774;},a17_0x47ad(_0x1b4670,_0x454456);}(function(_0x93a077,_0x2304ba){const _0x294571=a17_0x47ad,_0x4afeaa=_0x93a077();while(!![]){try{const _0x3202f4=parseInt(_0x294571(0x189))/0x1+parseInt(_0x294571(0x16c))/0x2*(-parseInt(_0x294571(0x167))/0x3)+-parseInt(_0x294571(0x16d))/0x4+-parseInt(_0x294571(0x16a))/0x5*(-parseInt(_0x294571(0x188))/0x6)+parseInt(_0x294571(0x172))/0x7*(parseInt(_0x294571(0x176))/0x8)+-parseInt(_0x294571(0x179))/0x9+parseInt(_0x294571(0x18f))/0xa*(-parseInt(_0x294571(0x16e))/0xb);if(_0x3202f4===_0x2304ba)break;else _0x4afeaa['push'](_0x4afeaa['shift']());}catch(_0x33219b){_0x4afeaa['push'](_0x4afeaa['shift']());}}}(a17_0x50ab,0xdecf1));var __importDefault=this&&this[a17_0x3a0e68(0x17e)]||function(_0x1a54bd){return _0x1a54bd&&_0x1a54bd['__esModule']?_0x1a54bd:{'default':_0x1a54bd};};Object[a17_0x3a0e68(0x174)](exports,a17_0x3a0e68(0x181),{'value':!![]}),exports[a17_0x3a0e68(0x177)]=exports[a17_0x3a0e68(0x186)]=exports[a17_0x3a0e68(0x171)]=exports[a17_0x3a0e68(0x183)]=void 0x0;const jsonwebtoken_1=__importDefault(require(a17_0x3a0e68(0x191))),config_1=require('../config/config'),tokenBlacklistService_1=require(a17_0x3a0e68(0x187)),authenticateToken=(_0x44c07c,_0x41feed,_0x1d2707)=>{const _0x1d0982=a17_0x3a0e68,_0x1be9ac=_0x44c07c[_0x1d0982(0x180)][_0x1d0982(0x168)],_0x535062=_0x1be9ac&&_0x1be9ac[_0x1d0982(0x185)]('\x20')[0x1];if(!_0x535062)return _0x41feed[_0x1d0982(0x17c)](0x191)[_0x1d0982(0x178)]({'success':![],'message':'Access\x20token\x20required'});if(tokenBlacklistService_1[_0x1d0982(0x18c)][_0x1d0982(0x16f)](_0x535062))return _0x41feed['status'](0x191)[_0x1d0982(0x178)]({'success':![],'message':_0x1d0982(0x170)});jsonwebtoken_1[_0x1d0982(0x17b)][_0x1d0982(0x173)](_0x535062,config_1[_0x1d0982(0x169)][_0x1d0982(0x190)][_0x1d0982(0x18e)],(_0x51830f,_0x1bf448)=>{const _0xc472c1=_0x1d0982;if(_0x51830f)return _0x41feed[_0xc472c1(0x17c)](0x193)[_0xc472c1(0x178)]({'success':![],'message':'Invalid\x20or\x20expired\x20token'});_0x44c07c[_0xc472c1(0x17f)]=_0x1bf448,_0x44c07c['token']=_0x535062,_0x1d2707();});};exports[a17_0x3a0e68(0x183)]=authenticateToken;const requireAdmin=(_0x416ef9,_0x385e3d,_0x2e2dc4)=>{const _0x1b60ef=a17_0x3a0e68;if(!_0x416ef9[_0x1b60ef(0x17f)]||_0x416ef9['user']['role']!==_0x1b60ef(0x18a))return _0x385e3d[_0x1b60ef(0x17c)](0x193)[_0x1b60ef(0x178)]({'success':![],'message':_0x1b60ef(0x18d)});_0x2e2dc4();};exports[a17_0x3a0e68(0x171)]=requireAdmin;const requireShop=(_0x1ad1f,_0x35cf57,_0x3fa710)=>{const _0x231253=a17_0x3a0e68;if(!_0x1ad1f[_0x231253(0x17f)]||_0x1ad1f[_0x231253(0x17f)][_0x231253(0x17a)]!==_0x231253(0x184))return _0x35cf57[_0x231253(0x17c)](0x193)['json']({'success':![],'message':_0x231253(0x175)});_0x3fa710();};exports[a17_0x3a0e68(0x186)]=requireShop;const requireActiveShop=async(_0x957a2f,_0x18d963,_0x2ba18e)=>{const _0x25dcbd=a17_0x3a0e68;if(!_0x957a2f['user']||_0x957a2f['user'][_0x25dcbd(0x17a)]!==_0x25dcbd(0x184))return _0x18d963[_0x25dcbd(0x17c)](0x193)[_0x25dcbd(0x178)]({'success':![],'message':_0x25dcbd(0x175)});try{const _0x318963=require('../config/database')[_0x25dcbd(0x17b)],_0x5e32b9=await _0x318963[_0x25dcbd(0x184)]['findUnique']({'where':{'id':_0x957a2f[_0x25dcbd(0x17f)]['id']},'select':{'status':!![]}});if(!_0x5e32b9||_0x5e32b9['status']!==_0x25dcbd(0x192))return _0x18d963[_0x25dcbd(0x17c)](0x193)[_0x25dcbd(0x178)]({'success':![],'message':_0x25dcbd(0x182),'suspended':_0x5e32b9?.['status']===_0x25dcbd(0x18b)});_0x2ba18e();}catch(_0x5098d0){return console[_0x25dcbd(0x17d)](_0x25dcbd(0x16b),_0x5098d0),_0x18d963[_0x25dcbd(0x17c)](0x1f4)[_0x25dcbd(0x178)]({'success':![],'message':'Error\x20checking\x20account\x20status'});}};exports[a17_0x3a0e68(0x177)]=requireActiveShop;