'use strict';const a24_0x422f06=a24_0x38aa;(function(_0x3856d9,_0x3bc420){const _0x5ce3bb=a24_0x38aa,_0x38add7=_0x3856d9();while(!![]){try{const _0x240e28=-parseInt(_0x5ce3bb(0x1ed))/0x1+-parseInt(_0x5ce3bb(0x1df))/0x2+-parseInt(_0x5ce3bb(0x1cd))/0x3*(parseInt(_0x5ce3bb(0x1cf))/0x4)+parseInt(_0x5ce3bb(0x1e9))/0x5*(-parseInt(_0x5ce3bb(0x1d5))/0x6)+-parseInt(_0x5ce3bb(0x1da))/0x7*(parseInt(_0x5ce3bb(0x1d1))/0x8)+-parseInt(_0x5ce3bb(0x1ea))/0x9*(parseInt(_0x5ce3bb(0x1d8))/0xa)+parseInt(_0x5ce3bb(0x1cb))/0xb*(parseInt(_0x5ce3bb(0x1e0))/0xc);if(_0x240e28===_0x3bc420)break;else _0x38add7['push'](_0x38add7['shift']());}catch(_0xfa4ec4){_0x38add7['push'](_0x38add7['shift']());}}}(a24_0x5ce3,0xac6f9));var __importDefault=this&&this[a24_0x422f06(0x1e6)]||function(_0x3d3116){const _0x35a43e=a24_0x422f06;return _0x3d3116&&_0x3d3116[_0x35a43e(0x1d0)]?_0x3d3116:{'default':_0x3d3116};};Object[a24_0x422f06(0x1d9)](exports,a24_0x422f06(0x1d0),{'value':!![]}),exports[a24_0x422f06(0x1e4)]=exports[a24_0x422f06(0x1d4)]=exports[a24_0x422f06(0x1de)]=exports[a24_0x422f06(0x1e3)]=void 0x0;function a24_0x38aa(_0x15dbd3,_0x545d5a){_0x15dbd3=_0x15dbd3-0x1c3;const _0x5ce376=a24_0x5ce3();let _0x38aa82=_0x5ce376[_0x15dbd3];return _0x38aa82;}const jsonwebtoken_1=__importDefault(require(a24_0x422f06(0x1dd))),config_1=require(a24_0x422f06(0x1ca)),tokenBlacklistService_1=require(a24_0x422f06(0x1e8)),authenticateToken=(_0x78d55c,_0x328c56,_0x2ae7df)=>{const _0x482a67=a24_0x422f06,_0x12de49=_0x78d55c[_0x482a67(0x1cc)][_0x482a67(0x1dc)],_0x16f0ea=_0x12de49&&_0x12de49[_0x482a67(0x1c7)]('\x20')[0x1];if(!_0x16f0ea)return _0x328c56[_0x482a67(0x1ce)](0x191)[_0x482a67(0x1d7)]({'success':![],'message':_0x482a67(0x1e1)});if(tokenBlacklistService_1['tokenBlacklistService'][_0x482a67(0x1c6)](_0x16f0ea))return _0x328c56[_0x482a67(0x1ce)](0x191)[_0x482a67(0x1d7)]({'success':![],'message':_0x482a67(0x1eb)});jsonwebtoken_1['default']['verify'](_0x16f0ea,config_1[_0x482a67(0x1e2)][_0x482a67(0x1c4)][_0x482a67(0x1ef)],(_0x32272f,_0x320930)=>{const _0x32cd3b=_0x482a67;if(_0x32272f)return _0x328c56['status'](0x193)[_0x32cd3b(0x1d7)]({'success':![],'message':'Invalid\x20or\x20expired\x20token'});_0x78d55c[_0x32cd3b(0x1c5)]=_0x320930,_0x78d55c['token']=_0x16f0ea,_0x2ae7df();});};exports['authenticateToken']=authenticateToken;const requireAdmin=(_0x4beef7,_0x17bbe7,_0x440167)=>{const _0x530199=a24_0x422f06;if(!_0x4beef7['user']||_0x4beef7[_0x530199(0x1c5)][_0x530199(0x1db)]!=='admin')return _0x17bbe7['status'](0x193)[_0x530199(0x1d7)]({'success':![],'message':_0x530199(0x1c3)});_0x440167();};function a24_0x5ce3(){const _0x3c9af1=['jsonwebtoken','requireAdmin','1674484fLKfzP','2315652bQKcAZ','Access\x20token\x20required','config','authenticateToken','requireActiveShop','error','__importDefault','Error\x20checking\x20account\x20status','../services/tokenBlacklistService','545adfSUn','189jbunYV','Token\x20has\x20been\x20revoked','Shop\x20access\x20required','11119pMnEKJ','ACTIVE','secret','Account\x20is\x20suspended\x20or\x20inactive.\x20Contact\x20administrator\x20to\x20activate\x20your\x20account.','Admin\x20access\x20required','jwt','user','isTokenBlacklisted','split','SUSPENDED','../config/database','../config/config','253cLebGu','headers','36381VgXwec','status','164HiOUfL','__esModule','923720NLbfri','shop','default','requireShop','67494bBmPuw','Error\x20checking\x20account\x20status:','json','442570BuwTAe','defineProperty','14ZlSccn','role','authorization'];a24_0x5ce3=function(){return _0x3c9af1;};return a24_0x5ce3();}exports[a24_0x422f06(0x1de)]=requireAdmin;const requireShop=(_0x43a7ff,_0xb44193,_0x4598c7)=>{const _0x10da64=a24_0x422f06;if(!_0x43a7ff['user']||_0x43a7ff['user'][_0x10da64(0x1db)]!==_0x10da64(0x1d2))return _0xb44193[_0x10da64(0x1ce)](0x193)[_0x10da64(0x1d7)]({'success':![],'message':'Shop\x20access\x20required'});_0x4598c7();};exports[a24_0x422f06(0x1d4)]=requireShop;const requireActiveShop=async(_0x5d726d,_0x5c7d90,_0x50ef10)=>{const _0x491187=a24_0x422f06;if(!_0x5d726d['user']||_0x5d726d['user'][_0x491187(0x1db)]!=='shop')return _0x5c7d90[_0x491187(0x1ce)](0x193)['json']({'success':![],'message':_0x491187(0x1ec)});try{const _0x486bca=require(_0x491187(0x1c9))[_0x491187(0x1d3)],_0x4785bc=await _0x486bca[_0x491187(0x1d2)]['findUnique']({'where':{'id':_0x5d726d[_0x491187(0x1c5)]['id']},'select':{'status':!![]}});if(!_0x4785bc||_0x4785bc[_0x491187(0x1ce)]!==_0x491187(0x1ee))return _0x5c7d90[_0x491187(0x1ce)](0x193)['json']({'success':![],'message':_0x491187(0x1f0),'suspended':_0x4785bc?.[_0x491187(0x1ce)]===_0x491187(0x1c8)});_0x50ef10();}catch(_0x5327cd){return console[_0x491187(0x1e5)](_0x491187(0x1d6),_0x5327cd),_0x5c7d90['status'](0x1f4)[_0x491187(0x1d7)]({'success':![],'message':_0x491187(0x1e7)});}};exports[a24_0x422f06(0x1e4)]=requireActiveShop;