'use strict';const a17_0x37619c=a17_0x18d1;(function(_0x5584c6,_0x55c5ac){const _0x5872ea=a17_0x18d1,_0xb55781=_0x5584c6();while(!![]){try{const _0x4642e8=-parseInt(_0x5872ea(0x1a7))/0x1*(-parseInt(_0x5872ea(0x1c0))/0x2)+-parseInt(_0x5872ea(0x1ba))/0x3*(parseInt(_0x5872ea(0x1ae))/0x4)+-parseInt(_0x5872ea(0x1a3))/0x5+parseInt(_0x5872ea(0x1bf))/0x6+-parseInt(_0x5872ea(0x1b9))/0x7*(parseInt(_0x5872ea(0x1b2))/0x8)+parseInt(_0x5872ea(0x1a0))/0x9*(-parseInt(_0x5872ea(0x1bc))/0xa)+parseInt(_0x5872ea(0x1a9))/0xb*(parseInt(_0x5872ea(0x1ab))/0xc);if(_0x4642e8===_0x55c5ac)break;else _0xb55781['push'](_0xb55781['shift']());}catch(_0x4c54e1){_0xb55781['push'](_0xb55781['shift']());}}}(a17_0x2035,0xb1b82));var __importDefault=this&&this[a17_0x37619c(0x1bd)]||function(_0x204e94){const _0xadd9d3=a17_0x37619c;return _0x204e94&&_0x204e94[_0xadd9d3(0x1c1)]?_0x204e94:{'default':_0x204e94};};Object['defineProperty'](exports,a17_0x37619c(0x1c1),{'value':!![]}),exports['requireActiveShop']=exports[a17_0x37619c(0x1c4)]=exports['requireAdmin']=exports[a17_0x37619c(0x1b6)]=void 0x0;const jsonwebtoken_1=__importDefault(require(a17_0x37619c(0x19e))),config_1=require(a17_0x37619c(0x1b0)),tokenBlacklistService_1=require('../services/tokenBlacklistService'),authenticateToken=(_0x2acaf6,_0x655f7a,_0x4dda6d)=>{const _0x37d203=a17_0x37619c,_0x7cef04=_0x2acaf6[_0x37d203(0x1a5)][_0x37d203(0x1b7)],_0x5eeddc=_0x7cef04&&_0x7cef04['split']('\x20')[0x1];if(!_0x5eeddc)return _0x655f7a[_0x37d203(0x1a6)](0x191)[_0x37d203(0x1aa)]({'success':![],'message':_0x37d203(0x1a8)});if(tokenBlacklistService_1['tokenBlacklistService']['isTokenBlacklisted'](_0x5eeddc))return _0x655f7a[_0x37d203(0x1a6)](0x191)[_0x37d203(0x1aa)]({'success':![],'message':_0x37d203(0x1bb)});jsonwebtoken_1[_0x37d203(0x1be)][_0x37d203(0x1c2)](_0x5eeddc,config_1['config'][_0x37d203(0x1b4)]['secret'],(_0x993cf5,_0x8dfddf)=>{const _0x55ec59=_0x37d203;if(_0x993cf5)return _0x655f7a['status'](0x193)['json']({'success':![],'message':_0x55ec59(0x1a1)});_0x2acaf6[_0x55ec59(0x1b1)]=_0x8dfddf,_0x2acaf6[_0x55ec59(0x19f)]=_0x5eeddc,_0x4dda6d();});};function a17_0x18d1(_0x49ce8f,_0x48a3f2){const _0x203579=a17_0x2035();return a17_0x18d1=function(_0x18d1eb,_0x33ada5){_0x18d1eb=_0x18d1eb-0x19e;let _0x39c96d=_0x203579[_0x18d1eb];return _0x39c96d;},a17_0x18d1(_0x49ce8f,_0x48a3f2);}function a17_0x2035(){const _0x4c57b5=['Invalid\x20or\x20expired\x20token','SUSPENDED','1232205gAFoaF','error','headers','status','2buUwnS','Access\x20token\x20required','77eMmqjz','json','2241156wWkMza','admin','role','11060DxSTzq','Error\x20checking\x20account\x20status:','../config/config','user','112PSQECs','shop','jwt','Shop\x20access\x20required','authenticateToken','authorization','Account\x20is\x20suspended\x20or\x20inactive.\x20Contact\x20administrator\x20to\x20activate\x20your\x20account.','22330YXlRpl','819xYEZyb','Token\x20has\x20been\x20revoked','7870aiOFrl','__importDefault','default','563076hrUoYn','1379270EhnWDA','__esModule','verify','findUnique','requireShop','jsonwebtoken','token','11511vbySfR'];a17_0x2035=function(){return _0x4c57b5;};return a17_0x2035();}exports[a17_0x37619c(0x1b6)]=authenticateToken;const requireAdmin=(_0x362c90,_0x1bf7ac,_0x317f1a)=>{const _0x106f18=a17_0x37619c;if(!_0x362c90[_0x106f18(0x1b1)]||_0x362c90[_0x106f18(0x1b1)][_0x106f18(0x1ad)]!==_0x106f18(0x1ac))return _0x1bf7ac[_0x106f18(0x1a6)](0x193)[_0x106f18(0x1aa)]({'success':![],'message':'Admin\x20access\x20required'});_0x317f1a();};exports['requireAdmin']=requireAdmin;const requireShop=(_0x541c08,_0x39fb2d,_0x48028b)=>{const _0x1ee095=a17_0x37619c;if(!_0x541c08[_0x1ee095(0x1b1)]||_0x541c08['user'][_0x1ee095(0x1ad)]!==_0x1ee095(0x1b3))return _0x39fb2d[_0x1ee095(0x1a6)](0x193)[_0x1ee095(0x1aa)]({'success':![],'message':_0x1ee095(0x1b5)});_0x48028b();};exports[a17_0x37619c(0x1c4)]=requireShop;const requireActiveShop=async(_0x351e1b,_0x5d32a7,_0x405155)=>{const _0x4be367=a17_0x37619c;if(!_0x351e1b[_0x4be367(0x1b1)]||_0x351e1b['user'][_0x4be367(0x1ad)]!==_0x4be367(0x1b3))return _0x5d32a7[_0x4be367(0x1a6)](0x193)[_0x4be367(0x1aa)]({'success':![],'message':_0x4be367(0x1b5)});try{const _0x3363a0=require('../config/database')[_0x4be367(0x1be)],_0x7124a9=await _0x3363a0[_0x4be367(0x1b3)][_0x4be367(0x1c3)]({'where':{'id':_0x351e1b[_0x4be367(0x1b1)]['id']},'select':{'status':!![]}});if(!_0x7124a9||_0x7124a9[_0x4be367(0x1a6)]!=='ACTIVE')return _0x5d32a7[_0x4be367(0x1a6)](0x193)[_0x4be367(0x1aa)]({'success':![],'message':_0x4be367(0x1b8),'suspended':_0x7124a9?.[_0x4be367(0x1a6)]===_0x4be367(0x1a2)});_0x405155();}catch(_0xe1bd98){return console[_0x4be367(0x1a4)](_0x4be367(0x1af),_0xe1bd98),_0x5d32a7[_0x4be367(0x1a6)](0x1f4)[_0x4be367(0x1aa)]({'success':![],'message':'Error\x20checking\x20account\x20status'});}};exports['requireActiveShop']=requireActiveShop;