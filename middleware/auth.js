'use strict';const a24_0x5ceae6=a24_0x59d9;function a24_0x59d9(_0x34cf4f,_0x68586c){_0x34cf4f=_0x34cf4f-0x1da;const _0x4a1bf9=a24_0x4a1b();let _0x59d918=_0x4a1bf9[_0x34cf4f];return _0x59d918;}(function(_0x198d03,_0x83789e){const _0x22d232=a24_0x59d9,_0x1ba8a2=_0x198d03();while(!![]){try{const _0x35a71c=-parseInt(_0x22d232(0x1ee))/0x1*(parseInt(_0x22d232(0x1f3))/0x2)+-parseInt(_0x22d232(0x1f0))/0x3*(-parseInt(_0x22d232(0x1fd))/0x4)+parseInt(_0x22d232(0x1e6))/0x5*(-parseInt(_0x22d232(0x1f4))/0x6)+-parseInt(_0x22d232(0x1dd))/0x7*(parseInt(_0x22d232(0x1ef))/0x8)+parseInt(_0x22d232(0x1df))/0x9+parseInt(_0x22d232(0x202))/0xa+parseInt(_0x22d232(0x1e0))/0xb*(parseInt(_0x22d232(0x1fa))/0xc);if(_0x35a71c===_0x83789e)break;else _0x1ba8a2['push'](_0x1ba8a2['shift']());}catch(_0x5bed49){_0x1ba8a2['push'](_0x1ba8a2['shift']());}}}(a24_0x4a1b,0x31ed7));var __importDefault=this&&this[a24_0x5ceae6(0x1ff)]||function(_0x218270){const _0x51d4f4=a24_0x5ceae6;return _0x218270&&_0x218270[_0x51d4f4(0x1f1)]?_0x218270:{'default':_0x218270};};Object['defineProperty'](exports,a24_0x5ceae6(0x1f1),{'value':!![]}),exports[a24_0x5ceae6(0x1e1)]=exports[a24_0x5ceae6(0x1fe)]=exports[a24_0x5ceae6(0x1fc)]=exports[a24_0x5ceae6(0x1f5)]=void 0x0;const jsonwebtoken_1=__importDefault(require(a24_0x5ceae6(0x1e2))),config_1=require('../config/config'),tokenBlacklistService_1=require(a24_0x5ceae6(0x1f7)),authenticateToken=(_0x334f9f,_0x30ea5f,_0x269f7c)=>{const _0xb125f0=a24_0x5ceae6,_0x30fcb6=_0x334f9f[_0xb125f0(0x1e3)]['authorization'],_0x1761c5=_0x30fcb6&&_0x30fcb6[_0xb125f0(0x1ea)]('\x20')[0x1];if(!_0x1761c5)return _0x30ea5f[_0xb125f0(0x1f2)](0x191)[_0xb125f0(0x1ec)]({'success':![],'message':_0xb125f0(0x1e7)});if(tokenBlacklistService_1[_0xb125f0(0x1dc)]['isTokenBlacklisted'](_0x1761c5))return _0x30ea5f[_0xb125f0(0x1f2)](0x191)['json']({'success':![],'message':_0xb125f0(0x201)});jsonwebtoken_1['default']['verify'](_0x1761c5,config_1[_0xb125f0(0x1e5)][_0xb125f0(0x1de)][_0xb125f0(0x200)],(_0x13d9ce,_0x1a60f2)=>{const _0x95f458=_0xb125f0;if(_0x13d9ce)return _0x30ea5f[_0x95f458(0x1f2)](0x193)[_0x95f458(0x1ec)]({'success':![],'message':_0x95f458(0x1e9)});_0x334f9f[_0x95f458(0x1ed)]=_0x1a60f2,_0x334f9f[_0x95f458(0x1db)]=_0x1761c5,_0x269f7c();});};exports[a24_0x5ceae6(0x1f5)]=authenticateToken;const requireAdmin=(_0x2baa5b,_0x534478,_0x5acc9e)=>{const _0x3d87e6=a24_0x5ceae6;if(!_0x2baa5b['user']||_0x2baa5b[_0x3d87e6(0x1ed)][_0x3d87e6(0x1fb)]!==_0x3d87e6(0x1f6))return _0x534478[_0x3d87e6(0x1f2)](0x193)[_0x3d87e6(0x1ec)]({'success':![],'message':'Admin\x20access\x20required'});_0x5acc9e();};function a24_0x4a1b(){const _0x2da64a=['status','2aZkIoy','3858WEHqBf','authenticateToken','admin','../services/tokenBlacklistService','Error\x20checking\x20account\x20status:','Shop\x20access\x20required','62400ApYYtt','role','requireAdmin','432116DLTpqU','requireShop','__importDefault','secret','Token\x20has\x20been\x20revoked','312620namiqE','../config/database','token','tokenBlacklistService','1936417PoTwto','jwt','49743hmsBge','671hOJfjM','requireActiveShop','jsonwebtoken','headers','default','config','1140DUxHUX','Access\x20token\x20required','shop','Invalid\x20or\x20expired\x20token','split','Error\x20checking\x20account\x20status','json','user','50338mvXXee','8rakwGo','9bzZkbD','__esModule'];a24_0x4a1b=function(){return _0x2da64a;};return a24_0x4a1b();}exports[a24_0x5ceae6(0x1fc)]=requireAdmin;const requireShop=(_0x4794be,_0x25d62c,_0x1dfb4f)=>{const _0x299d11=a24_0x5ceae6;if(!_0x4794be[_0x299d11(0x1ed)]||_0x4794be[_0x299d11(0x1ed)][_0x299d11(0x1fb)]!==_0x299d11(0x1e8))return _0x25d62c[_0x299d11(0x1f2)](0x193)['json']({'success':![],'message':'Shop\x20access\x20required'});_0x1dfb4f();};exports[a24_0x5ceae6(0x1fe)]=requireShop;const requireActiveShop=async(_0x8dce72,_0x1c4bd8,_0x57a9ab)=>{const _0x46bcd3=a24_0x5ceae6;if(!_0x8dce72['user']||_0x8dce72[_0x46bcd3(0x1ed)][_0x46bcd3(0x1fb)]!=='shop')return _0x1c4bd8[_0x46bcd3(0x1f2)](0x193)['json']({'success':![],'message':_0x46bcd3(0x1f9)});try{const _0x548d3e=require(_0x46bcd3(0x1da))[_0x46bcd3(0x1e4)],_0x5c13c6=await _0x548d3e[_0x46bcd3(0x1e8)]['findUnique']({'where':{'id':_0x8dce72[_0x46bcd3(0x1ed)]['id']},'select':{'status':!![]}});if(!_0x5c13c6||_0x5c13c6['status']!=='ACTIVE')return _0x1c4bd8[_0x46bcd3(0x1f2)](0x193)[_0x46bcd3(0x1ec)]({'success':![],'message':'Account\x20is\x20suspended\x20or\x20inactive.\x20Contact\x20administrator\x20to\x20activate\x20your\x20account.','suspended':_0x5c13c6?.[_0x46bcd3(0x1f2)]==='SUSPENDED'});_0x57a9ab();}catch(_0x2f0f0f){return console['error'](_0x46bcd3(0x1f8),_0x2f0f0f),_0x1c4bd8[_0x46bcd3(0x1f2)](0x1f4)[_0x46bcd3(0x1ec)]({'success':![],'message':_0x46bcd3(0x1eb)});}};exports['requireActiveShop']=requireActiveShop;