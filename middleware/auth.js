'use strict';const a16_0x5b6d2f=a16_0x1d7c;(function(_0x1d33b4,_0x8c0216){const _0x3baba7=a16_0x1d7c,_0x41fe1=_0x1d33b4();while(!![]){try{const _0x21eaf8=-parseInt(_0x3baba7(0x19d))/0x1*(parseInt(_0x3baba7(0x192))/0x2)+-parseInt(_0x3baba7(0x190))/0x3+parseInt(_0x3baba7(0x1a5))/0x4+parseInt(_0x3baba7(0x1ac))/0x5+-parseInt(_0x3baba7(0x1b0))/0x6*(-parseInt(_0x3baba7(0x1a3))/0x7)+parseInt(_0x3baba7(0x18f))/0x8*(parseInt(_0x3baba7(0x19c))/0x9)+parseInt(_0x3baba7(0x1a8))/0xa*(-parseInt(_0x3baba7(0x18b))/0xb);if(_0x21eaf8===_0x8c0216)break;else _0x41fe1['push'](_0x41fe1['shift']());}catch(_0x4a5197){_0x41fe1['push'](_0x41fe1['shift']());}}}(a16_0x3ec5,0x8dd1a));var __importDefault=this&&this[a16_0x5b6d2f(0x1a7)]||function(_0x872a84){return _0x872a84&&_0x872a84['__esModule']?_0x872a84:{'default':_0x872a84};};Object[a16_0x5b6d2f(0x1ae)](exports,a16_0x5b6d2f(0x197),{'value':!![]}),exports['requireActiveShop']=exports[a16_0x5b6d2f(0x1aa)]=exports[a16_0x5b6d2f(0x1ab)]=exports[a16_0x5b6d2f(0x198)]=void 0x0;function a16_0x3ec5(){const _0xc15905=['isTokenBlacklisted','1946694xCfLrj','json','../services/tokenBlacklistService','../config/config','split','verify','22RUluUx','jsonwebtoken','tokenBlacklistService','Account\x20is\x20suspended\x20or\x20inactive.\x20Contact\x20administrator\x20to\x20activate\x20your\x20account.','1528ZTABVP','117804YLtrmY','ACTIVE','1099726Zajygy','user','secret','SUSPENDED','default','__esModule','authenticateToken','Shop\x20access\x20required','../config/database','config','36594cboYYo','1HCKwZg','admin','Error\x20checking\x20account\x20status:','authorization','Invalid\x20or\x20expired\x20token','role','7oiXRhI','shop','2249660RdvFWc','error','__importDefault','7687660CWmmDl','Token\x20has\x20been\x20revoked','requireShop','requireAdmin','5220415vYExZc','status','defineProperty'];a16_0x3ec5=function(){return _0xc15905;};return a16_0x3ec5();}const jsonwebtoken_1=__importDefault(require(a16_0x5b6d2f(0x18c))),config_1=require(a16_0x5b6d2f(0x1b3)),tokenBlacklistService_1=require(a16_0x5b6d2f(0x1b2)),authenticateToken=(_0x1c2329,_0x538b01,_0x35a2be)=>{const _0x1e28f9=a16_0x5b6d2f,_0xa7a9a1=_0x1c2329['headers'][_0x1e28f9(0x1a0)],_0x3aaf1f=_0xa7a9a1&&_0xa7a9a1[_0x1e28f9(0x1b4)]('\x20')[0x1];if(!_0x3aaf1f)return _0x538b01[_0x1e28f9(0x1ad)](0x191)[_0x1e28f9(0x1b1)]({'success':![],'message':'Access\x20token\x20required'});if(tokenBlacklistService_1[_0x1e28f9(0x18d)][_0x1e28f9(0x1af)](_0x3aaf1f))return _0x538b01[_0x1e28f9(0x1ad)](0x191)[_0x1e28f9(0x1b1)]({'success':![],'message':_0x1e28f9(0x1a9)});jsonwebtoken_1[_0x1e28f9(0x196)][_0x1e28f9(0x1b5)](_0x3aaf1f,config_1[_0x1e28f9(0x19b)]['jwt'][_0x1e28f9(0x194)],(_0x416bdf,_0x3e65f6)=>{const _0x119d90=_0x1e28f9;if(_0x416bdf)return _0x538b01[_0x119d90(0x1ad)](0x193)[_0x119d90(0x1b1)]({'success':![],'message':_0x119d90(0x1a1)});_0x1c2329['user']=_0x3e65f6,_0x1c2329['token']=_0x3aaf1f,_0x35a2be();});};function a16_0x1d7c(_0xa8aed7,_0x48a21e){const _0x3ec5e4=a16_0x3ec5();return a16_0x1d7c=function(_0x1d7c9c,_0x5777be){_0x1d7c9c=_0x1d7c9c-0x18b;let _0x2d81f7=_0x3ec5e4[_0x1d7c9c];return _0x2d81f7;},a16_0x1d7c(_0xa8aed7,_0x48a21e);}exports[a16_0x5b6d2f(0x198)]=authenticateToken;const requireAdmin=(_0xe24e6,_0x5d161f,_0x5cdbaf)=>{const _0x2929e6=a16_0x5b6d2f;if(!_0xe24e6[_0x2929e6(0x193)]||_0xe24e6[_0x2929e6(0x193)]['role']!==_0x2929e6(0x19e))return _0x5d161f[_0x2929e6(0x1ad)](0x193)[_0x2929e6(0x1b1)]({'success':![],'message':'Admin\x20access\x20required'});_0x5cdbaf();};exports[a16_0x5b6d2f(0x1ab)]=requireAdmin;const requireShop=(_0xae4a,_0x3fc746,_0x5983f1)=>{const _0x22f07d=a16_0x5b6d2f;if(!_0xae4a[_0x22f07d(0x193)]||_0xae4a[_0x22f07d(0x193)][_0x22f07d(0x1a2)]!==_0x22f07d(0x1a4))return _0x3fc746['status'](0x193)[_0x22f07d(0x1b1)]({'success':![],'message':_0x22f07d(0x199)});_0x5983f1();};exports['requireShop']=requireShop;const requireActiveShop=async(_0x376564,_0x5a3f4f,_0x596bdc)=>{const _0x57e18f=a16_0x5b6d2f;if(!_0x376564['user']||_0x376564['user'][_0x57e18f(0x1a2)]!==_0x57e18f(0x1a4))return _0x5a3f4f['status'](0x193)['json']({'success':![],'message':_0x57e18f(0x199)});try{const _0x5626e0=require(_0x57e18f(0x19a))[_0x57e18f(0x196)],_0x551198=await _0x5626e0[_0x57e18f(0x1a4)]['findUnique']({'where':{'id':_0x376564['user']['id']},'select':{'status':!![]}});if(!_0x551198||_0x551198[_0x57e18f(0x1ad)]!==_0x57e18f(0x191))return _0x5a3f4f[_0x57e18f(0x1ad)](0x193)['json']({'success':![],'message':_0x57e18f(0x18e),'suspended':_0x551198?.[_0x57e18f(0x1ad)]===_0x57e18f(0x195)});_0x596bdc();}catch(_0x469d87){return console[_0x57e18f(0x1a6)](_0x57e18f(0x19f),_0x469d87),_0x5a3f4f['status'](0x1f4)[_0x57e18f(0x1b1)]({'success':![],'message':'Error\x20checking\x20account\x20status'});}};exports['requireActiveShop']=requireActiveShop;