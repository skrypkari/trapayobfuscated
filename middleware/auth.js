'use strict';function a15_0xc578(){const _0x2ab16c=['verify','../services/tokenBlacklistService','default','90RnXbAf','926SuXUQn','tokenBlacklistService','authenticateToken','jsonwebtoken','../config/config','user','json','2870pDBNWk','token','headers','secret','status','requireAdmin','2792734azvQZV','1364hFyiZr','__importDefault','213320ViNyoq','isTokenBlacklisted','3723uCmmtv','169712vuTopd','406438cdEFut','config','requireShop','Admin\x20access\x20required','414RpPRNq','Invalid\x20or\x20expired\x20token','__esModule','defineProperty','split','1294830fQnrQB','Token\x20has\x20been\x20revoked','jwt','Access\x20token\x20required','role'];a15_0xc578=function(){return _0x2ab16c;};return a15_0xc578();}function a15_0x271c(_0xaaac0,_0x523fde){const _0xc57893=a15_0xc578();return a15_0x271c=function(_0x271c78,_0xd0d201){_0x271c78=_0x271c78-0x84;let _0x27d083=_0xc57893[_0x271c78];return _0x27d083;},a15_0x271c(_0xaaac0,_0x523fde);}const a15_0x478b9b=a15_0x271c;(function(_0x2534e0,_0x3ef442){const _0x199797=a15_0x271c,_0xc540fd=_0x2534e0();while(!![]){try{const _0x434790=parseInt(_0x199797(0x90))/0x1+-parseInt(_0x199797(0xa2))/0x2*(parseInt(_0x199797(0x8e))/0x3)+-parseInt(_0x199797(0x8c))/0x4*(parseInt(_0x199797(0xa1))/0x5)+parseInt(_0x199797(0x99))/0x6+parseInt(_0x199797(0x89))/0x7+-parseInt(_0x199797(0x8f))/0x8*(-parseInt(_0x199797(0x94))/0x9)+parseInt(_0x199797(0xa9))/0xa*(parseInt(_0x199797(0x8a))/0xb);if(_0x434790===_0x3ef442)break;else _0xc540fd['push'](_0xc540fd['shift']());}catch(_0x17a437){_0xc540fd['push'](_0xc540fd['shift']());}}}(a15_0xc578,0x799c2));var __importDefault=this&&this[a15_0x478b9b(0x8b)]||function(_0x104dc0){return _0x104dc0&&_0x104dc0['__esModule']?_0x104dc0:{'default':_0x104dc0};};Object[a15_0x478b9b(0x97)](exports,a15_0x478b9b(0x96),{'value':!![]}),exports[a15_0x478b9b(0x92)]=exports[a15_0x478b9b(0x88)]=exports[a15_0x478b9b(0xa4)]=void 0x0;const jsonwebtoken_1=__importDefault(require(a15_0x478b9b(0xa5))),config_1=require(a15_0x478b9b(0xa6)),tokenBlacklistService_1=require(a15_0x478b9b(0x9f)),authenticateToken=(_0x5001df,_0x2ad3f3,_0xbd459c)=>{const _0x4f4fc7=a15_0x478b9b,_0xa84dda=_0x5001df[_0x4f4fc7(0x85)]['authorization'],_0x5d904c=_0xa84dda&&_0xa84dda[_0x4f4fc7(0x98)]('\x20')[0x1];if(!_0x5d904c)return _0x2ad3f3[_0x4f4fc7(0x87)](0x191)['json']({'success':![],'message':_0x4f4fc7(0x9c)});if(tokenBlacklistService_1[_0x4f4fc7(0xa3)][_0x4f4fc7(0x8d)](_0x5d904c))return _0x2ad3f3['status'](0x191)['json']({'success':![],'message':_0x4f4fc7(0x9a)});jsonwebtoken_1[_0x4f4fc7(0xa0)][_0x4f4fc7(0x9e)](_0x5d904c,config_1[_0x4f4fc7(0x91)][_0x4f4fc7(0x9b)][_0x4f4fc7(0x86)],(_0x2d0de9,_0x54597a)=>{const _0x2c7be2=_0x4f4fc7;if(_0x2d0de9)return _0x2ad3f3['status'](0x193)['json']({'success':![],'message':_0x2c7be2(0x95)});_0x5001df[_0x2c7be2(0xa7)]=_0x54597a,_0x5001df[_0x2c7be2(0x84)]=_0x5d904c,_0xbd459c();});};exports['authenticateToken']=authenticateToken;const requireAdmin=(_0x43645f,_0x51cdbe,_0x481a1a)=>{const _0x1b7262=a15_0x478b9b;if(!_0x43645f[_0x1b7262(0xa7)]||_0x43645f[_0x1b7262(0xa7)][_0x1b7262(0x9d)]!=='admin')return _0x51cdbe['status'](0x193)[_0x1b7262(0xa8)]({'success':![],'message':_0x1b7262(0x93)});_0x481a1a();};exports[a15_0x478b9b(0x88)]=requireAdmin;const requireShop=(_0x58d62d,_0xc99985,_0x53979f)=>{const _0x5cca03=a15_0x478b9b;if(!_0x58d62d['user']||_0x58d62d[_0x5cca03(0xa7)][_0x5cca03(0x9d)]!=='shop')return _0xc99985[_0x5cca03(0x87)](0x193)[_0x5cca03(0xa8)]({'success':![],'message':'Shop\x20access\x20required'});_0x53979f();};exports[a15_0x478b9b(0x92)]=requireShop;