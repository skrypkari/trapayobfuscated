'use strict';const a16_0x127aad=a16_0x33a0;function a16_0x33a0(_0x181104,_0x3c789b){const _0x5859f4=a16_0x5859();return a16_0x33a0=function(_0x33a0c5,_0x2d186d){_0x33a0c5=_0x33a0c5-0xdb;let _0x584bb4=_0x5859f4[_0x33a0c5];return _0x584bb4;},a16_0x33a0(_0x181104,_0x3c789b);}function a16_0x5859(){const _0x188397=['isTokenBlacklisted','error','../config/config','4YamQEf','jsonwebtoken','authenticateToken','findUnique','Error\x20checking\x20account\x20status:','user','status','tokenBlacklistService','Token\x20has\x20been\x20revoked','secret','shop','6193026ZtodWe','Access\x20token\x20required','authorization','token','453924kRDAsX','requireActiveShop','8MkPzKG','ACTIVE','Shop\x20access\x20required','requireAdmin','requireShop','65tMUZCY','admin','defineProperty','../services/tokenBlacklistService','1136217JUqtWN','22sgwtqY','config','__esModule','Admin\x20access\x20required','Error\x20checking\x20account\x20status','verify','jwt','../config/database','183216sKbvuy','json','__importDefault','946148DVKWjW','3886870QsvrDZ','role','Invalid\x20or\x20expired\x20token','398580RpVcII'];a16_0x5859=function(){return _0x188397;};return a16_0x5859();}(function(_0x44ee62,_0x5782fe){const _0x584d52=a16_0x33a0,_0x2d8296=_0x44ee62();while(!![]){try{const _0x2a8aa1=parseInt(_0x584d52(0xe6))/0x1*(parseInt(_0x584d52(0x105))/0x2)+-parseInt(_0x584d52(0xf1))/0x3+parseInt(_0x584d52(0x101))/0x4+-parseInt(_0x584d52(0xed))/0x5*(parseInt(_0x584d52(0xfa))/0x6)+-parseInt(_0x584d52(0xfd))/0x7*(-parseInt(_0x584d52(0xe8))/0x8)+-parseInt(_0x584d52(0xe2))/0x9+-parseInt(_0x584d52(0xfe))/0xa*(-parseInt(_0x584d52(0xf2))/0xb);if(_0x2a8aa1===_0x5782fe)break;else _0x2d8296['push'](_0x2d8296['shift']());}catch(_0x3efda2){_0x2d8296['push'](_0x2d8296['shift']());}}}(a16_0x5859,0x6f612));var __importDefault=this&&this[a16_0x127aad(0xfc)]||function(_0x2ee834){const _0x51c8a0=a16_0x127aad;return _0x2ee834&&_0x2ee834[_0x51c8a0(0xf4)]?_0x2ee834:{'default':_0x2ee834};};Object[a16_0x127aad(0xef)](exports,a16_0x127aad(0xf4),{'value':!![]}),exports[a16_0x127aad(0xe7)]=exports['requireShop']=exports[a16_0x127aad(0xeb)]=exports['authenticateToken']=void 0x0;const jsonwebtoken_1=__importDefault(require(a16_0x127aad(0x106))),config_1=require(a16_0x127aad(0x104)),tokenBlacklistService_1=require(a16_0x127aad(0xf0)),authenticateToken=(_0x4213a8,_0x11ac6d,_0xc0bf20)=>{const _0x218a5e=a16_0x127aad,_0x32bb7f=_0x4213a8['headers'][_0x218a5e(0xe4)],_0x34e51c=_0x32bb7f&&_0x32bb7f['split']('\x20')[0x1];if(!_0x34e51c)return _0x11ac6d[_0x218a5e(0xdd)](0x191)[_0x218a5e(0xfb)]({'success':![],'message':_0x218a5e(0xe3)});if(tokenBlacklistService_1[_0x218a5e(0xde)][_0x218a5e(0x102)](_0x34e51c))return _0x11ac6d[_0x218a5e(0xdd)](0x191)[_0x218a5e(0xfb)]({'success':![],'message':_0x218a5e(0xdf)});jsonwebtoken_1['default'][_0x218a5e(0xf7)](_0x34e51c,config_1[_0x218a5e(0xf3)][_0x218a5e(0xf8)][_0x218a5e(0xe0)],(_0x1aa1a2,_0x5d003b)=>{const _0x527ee8=_0x218a5e;if(_0x1aa1a2)return _0x11ac6d['status'](0x193)['json']({'success':![],'message':_0x527ee8(0x100)});_0x4213a8[_0x527ee8(0xdc)]=_0x5d003b,_0x4213a8[_0x527ee8(0xe5)]=_0x34e51c,_0xc0bf20();});};exports[a16_0x127aad(0x107)]=authenticateToken;const requireAdmin=(_0x4adb4a,_0x35abbb,_0x4882f3)=>{const _0xd99c41=a16_0x127aad;if(!_0x4adb4a[_0xd99c41(0xdc)]||_0x4adb4a[_0xd99c41(0xdc)]['role']!==_0xd99c41(0xee))return _0x35abbb[_0xd99c41(0xdd)](0x193)[_0xd99c41(0xfb)]({'success':![],'message':_0xd99c41(0xf5)});_0x4882f3();};exports[a16_0x127aad(0xeb)]=requireAdmin;const requireShop=(_0x1b6417,_0x1fce1c,_0x11a39a)=>{const _0x13bb95=a16_0x127aad;if(!_0x1b6417[_0x13bb95(0xdc)]||_0x1b6417[_0x13bb95(0xdc)]['role']!==_0x13bb95(0xe1))return _0x1fce1c[_0x13bb95(0xdd)](0x193)[_0x13bb95(0xfb)]({'success':![],'message':_0x13bb95(0xea)});_0x11a39a();};exports[a16_0x127aad(0xec)]=requireShop;const requireActiveShop=async(_0x28a2cf,_0x15a5c5,_0x995fa1)=>{const _0xb8e413=a16_0x127aad;if(!_0x28a2cf[_0xb8e413(0xdc)]||_0x28a2cf[_0xb8e413(0xdc)][_0xb8e413(0xff)]!=='shop')return _0x15a5c5[_0xb8e413(0xdd)](0x193)[_0xb8e413(0xfb)]({'success':![],'message':_0xb8e413(0xea)});try{const _0x5e6395=require(_0xb8e413(0xf9))['default'],_0xd94353=await _0x5e6395[_0xb8e413(0xe1)][_0xb8e413(0x108)]({'where':{'id':_0x28a2cf[_0xb8e413(0xdc)]['id']},'select':{'status':!![]}});if(!_0xd94353||_0xd94353[_0xb8e413(0xdd)]!==_0xb8e413(0xe9))return _0x15a5c5[_0xb8e413(0xdd)](0x193)[_0xb8e413(0xfb)]({'success':![],'message':'Account\x20is\x20suspended\x20or\x20inactive.\x20Contact\x20administrator\x20to\x20activate\x20your\x20account.','suspended':_0xd94353?.[_0xb8e413(0xdd)]==='SUSPENDED'});_0x995fa1();}catch(_0xd8eb48){return console[_0xb8e413(0x103)](_0xb8e413(0xdb),_0xd8eb48),_0x15a5c5[_0xb8e413(0xdd)](0x1f4)[_0xb8e413(0xfb)]({'success':![],'message':_0xb8e413(0xf6)});}};exports[a16_0x127aad(0xe7)]=requireActiveShop;