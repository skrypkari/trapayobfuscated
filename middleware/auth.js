'use strict';function a16_0x461e(_0xe6369f,_0x3948d6){const _0x5434fb=a16_0x5434();return a16_0x461e=function(_0x461e7c,_0x2abaca){_0x461e7c=_0x461e7c-0x16e;let _0x3d3ad5=_0x5434fb[_0x461e7c];return _0x3d3ad5;},a16_0x461e(_0xe6369f,_0x3948d6);}const a16_0x19d353=a16_0x461e;(function(_0x58b909,_0x260c1a){const _0x114d2b=a16_0x461e,_0x254ed2=_0x58b909();while(!![]){try{const _0x154acd=-parseInt(_0x114d2b(0x182))/0x1+-parseInt(_0x114d2b(0x185))/0x2*(parseInt(_0x114d2b(0x177))/0x3)+parseInt(_0x114d2b(0x180))/0x4*(-parseInt(_0x114d2b(0x18b))/0x5)+-parseInt(_0x114d2b(0x17d))/0x6*(-parseInt(_0x114d2b(0x172))/0x7)+-parseInt(_0x114d2b(0x17b))/0x8*(-parseInt(_0x114d2b(0x190))/0x9)+parseInt(_0x114d2b(0x184))/0xa+parseInt(_0x114d2b(0x192))/0xb;if(_0x154acd===_0x260c1a)break;else _0x254ed2['push'](_0x254ed2['shift']());}catch(_0xf1b0b7){_0x254ed2['push'](_0x254ed2['shift']());}}}(a16_0x5434,0xa64cc));var __importDefault=this&&this[a16_0x19d353(0x181)]||function(_0xebc2d5){const _0x49f72b=a16_0x19d353;return _0xebc2d5&&_0xebc2d5[_0x49f72b(0x189)]?_0xebc2d5:{'default':_0xebc2d5};};Object['defineProperty'](exports,'__esModule',{'value':!![]}),exports[a16_0x19d353(0x186)]=exports[a16_0x19d353(0x17f)]=exports[a16_0x19d353(0x170)]=void 0x0;function a16_0x5434(){const _0x2f3235=['Token\x20has\x20been\x20revoked','5046616ADNcaH','token','18FgznSn','Shop\x20access\x20required','requireAdmin','1045628BtcCKL','__importDefault','800342xXMFWD','status','2831080SBDlsv','4SkgDtq','requireShop','jwt','role','__esModule','Access\x20token\x20required','5OceTGq','authorization','user','headers','jsonwebtoken','9FGxufK','admin','9231101iMWpje','Invalid\x20or\x20expired\x20token','Admin\x20access\x20required','shop','authenticateToken','config','922257UIlzvx','verify','secret','../config/config','tokenBlacklistService','608199THPMnx','json','split'];a16_0x5434=function(){return _0x2f3235;};return a16_0x5434();}const jsonwebtoken_1=__importDefault(require(a16_0x19d353(0x18f))),config_1=require(a16_0x19d353(0x175)),tokenBlacklistService_1=require('../services/tokenBlacklistService'),authenticateToken=(_0x408a2c,_0x91bf44,_0x30c000)=>{const _0x256b11=a16_0x19d353,_0x36cd70=_0x408a2c[_0x256b11(0x18e)][_0x256b11(0x18c)],_0x28a740=_0x36cd70&&_0x36cd70[_0x256b11(0x179)]('\x20')[0x1];if(!_0x28a740)return _0x91bf44['status'](0x191)[_0x256b11(0x178)]({'success':![],'message':_0x256b11(0x18a)});if(tokenBlacklistService_1[_0x256b11(0x176)]['isTokenBlacklisted'](_0x28a740))return _0x91bf44[_0x256b11(0x183)](0x191)[_0x256b11(0x178)]({'success':![],'message':_0x256b11(0x17a)});jsonwebtoken_1['default'][_0x256b11(0x173)](_0x28a740,config_1[_0x256b11(0x171)][_0x256b11(0x187)][_0x256b11(0x174)],(_0x2fd697,_0x332212)=>{const _0x439375=_0x256b11;if(_0x2fd697)return _0x91bf44['status'](0x193)[_0x439375(0x178)]({'success':![],'message':_0x439375(0x193)});_0x408a2c['user']=_0x332212,_0x408a2c[_0x439375(0x17c)]=_0x28a740,_0x30c000();});};exports[a16_0x19d353(0x170)]=authenticateToken;const requireAdmin=(_0x23ec20,_0x4a5d9b,_0x22d383)=>{const _0x57a6b7=a16_0x19d353;if(!_0x23ec20[_0x57a6b7(0x18d)]||_0x23ec20[_0x57a6b7(0x18d)]['role']!==_0x57a6b7(0x191))return _0x4a5d9b[_0x57a6b7(0x183)](0x193)[_0x57a6b7(0x178)]({'success':![],'message':_0x57a6b7(0x16e)});_0x22d383();};exports['requireAdmin']=requireAdmin;const requireShop=(_0x139073,_0x3457bf,_0x514095)=>{const _0x181e6c=a16_0x19d353;if(!_0x139073[_0x181e6c(0x18d)]||_0x139073[_0x181e6c(0x18d)][_0x181e6c(0x188)]!==_0x181e6c(0x16f))return _0x3457bf[_0x181e6c(0x183)](0x193)['json']({'success':![],'message':_0x181e6c(0x17e)});_0x514095();};exports[a16_0x19d353(0x186)]=requireShop;