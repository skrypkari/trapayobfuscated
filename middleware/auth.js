'use strict';function a16_0x2ea2(){const _0x1b5ed7=['default','Invalid\x20or\x20expired\x20token','tokenBlacklistService','11LFQPhF','Admin\x20access\x20required','12PjxkVL','error','config','Access\x20token\x20required','1LjMwbV','1136360WqsVvL','defineProperty','shop','../config/database','Error\x20checking\x20account\x20status','28806qNmMhA','requireShop','authenticateToken','__importDefault','34904GInJGI','SUSPENDED','authorization','user','secret','status','split','requireActiveShop','21333KMnSER','role','Account\x20is\x20suspended\x20or\x20inactive.\x20Contact\x20administrator\x20to\x20activate\x20your\x20account.','json','68106vZssGh','isTokenBlacklisted','__esModule','ACTIVE','jsonwebtoken','findUnique','Shop\x20access\x20required','1356XMCcRy','requireAdmin','386566NJhdtk','7LUuMTe','1372869LayoxP','5rmWuCy'];a16_0x2ea2=function(){return _0x1b5ed7;};return a16_0x2ea2();}const a16_0x5246e5=a16_0x100d;(function(_0x1c9a83,_0x3bbb86){const _0x5c6160=a16_0x100d,_0x40d0de=_0x1c9a83();while(!![]){try{const _0x5cdbe1=parseInt(_0x5c6160(0x151))/0x1*(parseInt(_0x5c6160(0x144))/0x2)+parseInt(_0x5c6160(0x13b))/0x3*(parseInt(_0x5c6160(0x14d))/0x4)+parseInt(_0x5c6160(0x147))/0x5*(-parseInt(_0x5c6160(0x157))/0x6)+-parseInt(_0x5c6160(0x145))/0x7*(-parseInt(_0x5c6160(0x15b))/0x8)+parseInt(_0x5c6160(0x146))/0x9+parseInt(_0x5c6160(0x152))/0xa*(-parseInt(_0x5c6160(0x14b))/0xb)+parseInt(_0x5c6160(0x142))/0xc*(-parseInt(_0x5c6160(0x163))/0xd);if(_0x5cdbe1===_0x3bbb86)break;else _0x40d0de['push'](_0x40d0de['shift']());}catch(_0x18b4ec){_0x40d0de['push'](_0x40d0de['shift']());}}}(a16_0x2ea2,0x1bef7));var __importDefault=this&&this[a16_0x5246e5(0x15a)]||function(_0x311be8){const _0x432304=a16_0x5246e5;return _0x311be8&&_0x311be8[_0x432304(0x13d)]?_0x311be8:{'default':_0x311be8};};Object[a16_0x5246e5(0x153)](exports,'__esModule',{'value':!![]}),exports[a16_0x5246e5(0x162)]=exports[a16_0x5246e5(0x158)]=exports['requireAdmin']=exports[a16_0x5246e5(0x159)]=void 0x0;const jsonwebtoken_1=__importDefault(require(a16_0x5246e5(0x13f))),config_1=require('../config/config'),tokenBlacklistService_1=require('../services/tokenBlacklistService'),authenticateToken=(_0x576cb8,_0xe39e94,_0x31e3b7)=>{const _0x9a4cb1=a16_0x5246e5,_0x38cb70=_0x576cb8['headers'][_0x9a4cb1(0x15d)],_0x394771=_0x38cb70&&_0x38cb70[_0x9a4cb1(0x161)]('\x20')[0x1];if(!_0x394771)return _0xe39e94[_0x9a4cb1(0x160)](0x191)['json']({'success':![],'message':_0x9a4cb1(0x150)});if(tokenBlacklistService_1[_0x9a4cb1(0x14a)][_0x9a4cb1(0x13c)](_0x394771))return _0xe39e94['status'](0x191)[_0x9a4cb1(0x166)]({'success':![],'message':'Token\x20has\x20been\x20revoked'});jsonwebtoken_1['default']['verify'](_0x394771,config_1[_0x9a4cb1(0x14f)]['jwt'][_0x9a4cb1(0x15f)],(_0x15b484,_0xa9d3cf)=>{const _0xa043bc=_0x9a4cb1;if(_0x15b484)return _0xe39e94[_0xa043bc(0x160)](0x193)['json']({'success':![],'message':_0xa043bc(0x149)});_0x576cb8[_0xa043bc(0x15e)]=_0xa9d3cf,_0x576cb8['token']=_0x394771,_0x31e3b7();});};exports[a16_0x5246e5(0x159)]=authenticateToken;const requireAdmin=(_0x4757dc,_0x195f40,_0x436129)=>{const _0x37ed28=a16_0x5246e5;if(!_0x4757dc['user']||_0x4757dc[_0x37ed28(0x15e)][_0x37ed28(0x164)]!=='admin')return _0x195f40[_0x37ed28(0x160)](0x193)[_0x37ed28(0x166)]({'success':![],'message':_0x37ed28(0x14c)});_0x436129();};exports[a16_0x5246e5(0x143)]=requireAdmin;const requireShop=(_0x3b5d5c,_0x3a971b,_0x1d4491)=>{const _0x2a864b=a16_0x5246e5;if(!_0x3b5d5c['user']||_0x3b5d5c['user'][_0x2a864b(0x164)]!==_0x2a864b(0x154))return _0x3a971b[_0x2a864b(0x160)](0x193)[_0x2a864b(0x166)]({'success':![],'message':_0x2a864b(0x141)});_0x1d4491();};exports['requireShop']=requireShop;const requireActiveShop=async(_0x1544ff,_0x34820c,_0x4a0d7b)=>{const _0x278e51=a16_0x5246e5;if(!_0x1544ff[_0x278e51(0x15e)]||_0x1544ff[_0x278e51(0x15e)][_0x278e51(0x164)]!=='shop')return _0x34820c[_0x278e51(0x160)](0x193)[_0x278e51(0x166)]({'success':![],'message':_0x278e51(0x141)});try{const _0x44094e=require(_0x278e51(0x155))[_0x278e51(0x148)],_0x5bb9ac=await _0x44094e[_0x278e51(0x154)][_0x278e51(0x140)]({'where':{'id':_0x1544ff[_0x278e51(0x15e)]['id']},'select':{'status':!![]}});if(!_0x5bb9ac||_0x5bb9ac['status']!==_0x278e51(0x13e))return _0x34820c['status'](0x193)[_0x278e51(0x166)]({'success':![],'message':_0x278e51(0x165),'suspended':_0x5bb9ac?.['status']===_0x278e51(0x15c)});_0x4a0d7b();}catch(_0x433b14){return console[_0x278e51(0x14e)]('Error\x20checking\x20account\x20status:',_0x433b14),_0x34820c[_0x278e51(0x160)](0x1f4)[_0x278e51(0x166)]({'success':![],'message':_0x278e51(0x156)});}};function a16_0x100d(_0x429d35,_0x149607){const _0x2ea2c2=a16_0x2ea2();return a16_0x100d=function(_0x100dd5,_0x1929fd){_0x100dd5=_0x100dd5-0x13b;let _0x41d465=_0x2ea2c2[_0x100dd5];return _0x41d465;},a16_0x100d(_0x429d35,_0x149607);}exports[a16_0x5246e5(0x162)]=requireActiveShop;