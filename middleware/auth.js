'use strict';const a17_0x48d0cd=a17_0x4f16;(function(_0x468734,_0x2ea2a8){const _0x308f66=a17_0x4f16,_0x2e301c=_0x468734();while(!![]){try{const _0x5ee253=-parseInt(_0x308f66(0x14a))/0x1+parseInt(_0x308f66(0x156))/0x2*(parseInt(_0x308f66(0x132))/0x3)+parseInt(_0x308f66(0x13b))/0x4+parseInt(_0x308f66(0x14c))/0x5*(parseInt(_0x308f66(0x135))/0x6)+parseInt(_0x308f66(0x137))/0x7+parseInt(_0x308f66(0x143))/0x8+-parseInt(_0x308f66(0x134))/0x9;if(_0x5ee253===_0x2ea2a8)break;else _0x2e301c['push'](_0x2e301c['shift']());}catch(_0x1a95dd){_0x2e301c['push'](_0x2e301c['shift']());}}}(a17_0x433a,0xb6109));function a17_0x433a(){const _0x1a7eb0=['shop','3boHiMB','Token\x20has\x20been\x20revoked','13650714IAMbTT','12bjCewk','jwt','5293057aBDrSC','authorization','ACTIVE','authenticateToken','479800aUbdTi','SUSPENDED','Error\x20checking\x20account\x20status','Admin\x20access\x20required','requireActiveShop','token','jsonwebtoken','../config/database','6456576qLfgtD','split','../config/config','admin','Access\x20token\x20required','Error\x20checking\x20account\x20status:','requireAdmin','1145057sQQSEB','secret','913085DgUdfW','headers','role','verify','defineProperty','findUnique','status','Shop\x20access\x20required','requireShop','json','2718266PKqSrA','config','error','user','Account\x20is\x20suspended\x20or\x20inactive.\x20Contact\x20administrator\x20to\x20activate\x20your\x20account.','__esModule'];a17_0x433a=function(){return _0x1a7eb0;};return a17_0x433a();}function a17_0x4f16(_0x1303de,_0x30bb82){const _0x433a2d=a17_0x433a();return a17_0x4f16=function(_0x4f16dc,_0x42ccd2){_0x4f16dc=_0x4f16dc-0x12f;let _0x5cb67d=_0x433a2d[_0x4f16dc];return _0x5cb67d;},a17_0x4f16(_0x1303de,_0x30bb82);}var __importDefault=this&&this['__importDefault']||function(_0x155a92){const _0x89e722=a17_0x4f16;return _0x155a92&&_0x155a92[_0x89e722(0x130)]?_0x155a92:{'default':_0x155a92};};Object[a17_0x48d0cd(0x150)](exports,a17_0x48d0cd(0x130),{'value':!![]}),exports[a17_0x48d0cd(0x13f)]=exports['requireShop']=exports[a17_0x48d0cd(0x149)]=exports[a17_0x48d0cd(0x13a)]=void 0x0;const jsonwebtoken_1=__importDefault(require(a17_0x48d0cd(0x141))),config_1=require(a17_0x48d0cd(0x145)),tokenBlacklistService_1=require('../services/tokenBlacklistService'),authenticateToken=(_0x223cd1,_0x18bdeb,_0x219709)=>{const _0x32c48a=a17_0x48d0cd,_0x43e96c=_0x223cd1[_0x32c48a(0x14d)][_0x32c48a(0x138)],_0x4d9584=_0x43e96c&&_0x43e96c[_0x32c48a(0x144)]('\x20')[0x1];if(!_0x4d9584)return _0x18bdeb[_0x32c48a(0x152)](0x191)[_0x32c48a(0x155)]({'success':![],'message':_0x32c48a(0x147)});if(tokenBlacklistService_1['tokenBlacklistService']['isTokenBlacklisted'](_0x4d9584))return _0x18bdeb['status'](0x191)['json']({'success':![],'message':_0x32c48a(0x133)});jsonwebtoken_1['default'][_0x32c48a(0x14f)](_0x4d9584,config_1[_0x32c48a(0x157)][_0x32c48a(0x136)][_0x32c48a(0x14b)],(_0x12f873,_0x5df3b2)=>{const _0x1e6c9f=_0x32c48a;if(_0x12f873)return _0x18bdeb['status'](0x193)[_0x1e6c9f(0x155)]({'success':![],'message':'Invalid\x20or\x20expired\x20token'});_0x223cd1[_0x1e6c9f(0x159)]=_0x5df3b2,_0x223cd1[_0x1e6c9f(0x140)]=_0x4d9584,_0x219709();});};exports[a17_0x48d0cd(0x13a)]=authenticateToken;const requireAdmin=(_0x18171e,_0x5c283c,_0x54c6dc)=>{const _0x1b8499=a17_0x48d0cd;if(!_0x18171e['user']||_0x18171e['user'][_0x1b8499(0x14e)]!==_0x1b8499(0x146))return _0x5c283c[_0x1b8499(0x152)](0x193)['json']({'success':![],'message':_0x1b8499(0x13e)});_0x54c6dc();};exports[a17_0x48d0cd(0x149)]=requireAdmin;const requireShop=(_0x2d9b16,_0x256831,_0x48b43f)=>{const _0xfa79cb=a17_0x48d0cd;if(!_0x2d9b16[_0xfa79cb(0x159)]||_0x2d9b16[_0xfa79cb(0x159)][_0xfa79cb(0x14e)]!==_0xfa79cb(0x131))return _0x256831[_0xfa79cb(0x152)](0x193)['json']({'success':![],'message':_0xfa79cb(0x153)});_0x48b43f();};exports[a17_0x48d0cd(0x154)]=requireShop;const requireActiveShop=async(_0x42c1c4,_0x1c344d,_0x386e04)=>{const _0x31dd46=a17_0x48d0cd;if(!_0x42c1c4['user']||_0x42c1c4[_0x31dd46(0x159)]['role']!=='shop')return _0x1c344d[_0x31dd46(0x152)](0x193)['json']({'success':![],'message':_0x31dd46(0x153)});try{const _0x206092=require(_0x31dd46(0x142))['default'],_0x1b2c07=await _0x206092[_0x31dd46(0x131)][_0x31dd46(0x151)]({'where':{'id':_0x42c1c4[_0x31dd46(0x159)]['id']},'select':{'status':!![]}});if(!_0x1b2c07||_0x1b2c07[_0x31dd46(0x152)]!==_0x31dd46(0x139))return _0x1c344d[_0x31dd46(0x152)](0x193)['json']({'success':![],'message':_0x31dd46(0x12f),'suspended':_0x1b2c07?.[_0x31dd46(0x152)]===_0x31dd46(0x13c)});_0x386e04();}catch(_0x4ec529){return console[_0x31dd46(0x158)](_0x31dd46(0x148),_0x4ec529),_0x1c344d[_0x31dd46(0x152)](0x1f4)[_0x31dd46(0x155)]({'success':![],'message':_0x31dd46(0x13d)});}};exports['requireActiveShop']=requireActiveShop;