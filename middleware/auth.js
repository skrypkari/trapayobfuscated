'use strict';const a16_0x4e43d1=a16_0x30be;(function(_0x26ab3b,_0xb9c527){const _0x32c3b4=a16_0x30be,_0x30ca22=_0x26ab3b();while(!![]){try{const _0x2010eb=parseInt(_0x32c3b4(0xb8))/0x1+parseInt(_0x32c3b4(0xc2))/0x2+parseInt(_0x32c3b4(0xc9))/0x3+-parseInt(_0x32c3b4(0xba))/0x4+parseInt(_0x32c3b4(0xbb))/0x5+-parseInt(_0x32c3b4(0xb0))/0x6+parseInt(_0x32c3b4(0xb4))/0x7*(-parseInt(_0x32c3b4(0xcd))/0x8);if(_0x2010eb===_0xb9c527)break;else _0x30ca22['push'](_0x30ca22['shift']());}catch(_0x5928dc){_0x30ca22['push'](_0x30ca22['shift']());}}}(a16_0x4ecb,0x7e75b));var __importDefault=this&&this[a16_0x4e43d1(0xd0)]||function(_0x41dab4){const _0x1520d2=a16_0x4e43d1;return _0x41dab4&&_0x41dab4[_0x1520d2(0xc7)]?_0x41dab4:{'default':_0x41dab4};};Object[a16_0x4e43d1(0xc5)](exports,'__esModule',{'value':!![]}),exports[a16_0x4e43d1(0xb6)]=exports[a16_0x4e43d1(0xaf)]=exports[a16_0x4e43d1(0xa6)]=exports[a16_0x4e43d1(0xac)]=void 0x0;function a16_0x4ecb(){const _0x5016ce=['authenticateToken','error','admin','requireShop','3274326wDupVU','secret','split','shop','600908JZAatw','../services/tokenBlacklistService','requireActiveShop','json','974167RlGpTh','Token\x20has\x20been\x20revoked','717980bXRkCW','371830owcsqQ','Shop\x20access\x20required','headers','Admin\x20access\x20required','Access\x20token\x20required','user','Error\x20checking\x20account\x20status','1770252UcQNNf','Invalid\x20or\x20expired\x20token','../config/config','defineProperty','tokenBlacklistService','__esModule','Account\x20is\x20suspended\x20or\x20inactive.\x20Contact\x20administrator\x20to\x20activate\x20your\x20account.','1791588ZoHjKA','role','SUSPENDED','config','120eyjhhi','default','verify','__importDefault','requireAdmin','status','findUnique','authorization','token','jsonwebtoken'];a16_0x4ecb=function(){return _0x5016ce;};return a16_0x4ecb();}const jsonwebtoken_1=__importDefault(require(a16_0x4e43d1(0xab))),config_1=require(a16_0x4e43d1(0xc4)),tokenBlacklistService_1=require(a16_0x4e43d1(0xb5)),authenticateToken=(_0x119552,_0x235490,_0x28ba83)=>{const _0x9b0704=a16_0x4e43d1,_0x40d575=_0x119552[_0x9b0704(0xbd)][_0x9b0704(0xa9)],_0x13264c=_0x40d575&&_0x40d575[_0x9b0704(0xb2)]('\x20')[0x1];if(!_0x13264c)return _0x235490[_0x9b0704(0xa7)](0x191)[_0x9b0704(0xb7)]({'success':![],'message':_0x9b0704(0xbf)});if(tokenBlacklistService_1[_0x9b0704(0xc6)]['isTokenBlacklisted'](_0x13264c))return _0x235490[_0x9b0704(0xa7)](0x191)[_0x9b0704(0xb7)]({'success':![],'message':_0x9b0704(0xb9)});jsonwebtoken_1['default'][_0x9b0704(0xcf)](_0x13264c,config_1[_0x9b0704(0xcc)]['jwt'][_0x9b0704(0xb1)],(_0x10ee12,_0x1c7c81)=>{const _0x5f4417=_0x9b0704;if(_0x10ee12)return _0x235490['status'](0x193)[_0x5f4417(0xb7)]({'success':![],'message':_0x5f4417(0xc3)});_0x119552['user']=_0x1c7c81,_0x119552[_0x5f4417(0xaa)]=_0x13264c,_0x28ba83();});};exports[a16_0x4e43d1(0xac)]=authenticateToken;function a16_0x30be(_0x53574a,_0x17fe71){const _0x4ecbc7=a16_0x4ecb();return a16_0x30be=function(_0x30be29,_0x2e56ef){_0x30be29=_0x30be29-0xa6;let _0x3b8e1f=_0x4ecbc7[_0x30be29];return _0x3b8e1f;},a16_0x30be(_0x53574a,_0x17fe71);}const requireAdmin=(_0x5ea0c3,_0x4149ed,_0x15a989)=>{const _0x4e0caf=a16_0x4e43d1;if(!_0x5ea0c3[_0x4e0caf(0xc0)]||_0x5ea0c3[_0x4e0caf(0xc0)][_0x4e0caf(0xca)]!==_0x4e0caf(0xae))return _0x4149ed[_0x4e0caf(0xa7)](0x193)[_0x4e0caf(0xb7)]({'success':![],'message':_0x4e0caf(0xbe)});_0x15a989();};exports[a16_0x4e43d1(0xa6)]=requireAdmin;const requireShop=(_0x5c6d86,_0x3894e3,_0x4d5afd)=>{const _0x436442=a16_0x4e43d1;if(!_0x5c6d86[_0x436442(0xc0)]||_0x5c6d86['user'][_0x436442(0xca)]!==_0x436442(0xb3))return _0x3894e3[_0x436442(0xa7)](0x193)[_0x436442(0xb7)]({'success':![],'message':_0x436442(0xbc)});_0x4d5afd();};exports['requireShop']=requireShop;const requireActiveShop=async(_0x5106cb,_0x59b823,_0x254cb7)=>{const _0x2a0cd6=a16_0x4e43d1;if(!_0x5106cb[_0x2a0cd6(0xc0)]||_0x5106cb[_0x2a0cd6(0xc0)]['role']!==_0x2a0cd6(0xb3))return _0x59b823[_0x2a0cd6(0xa7)](0x193)[_0x2a0cd6(0xb7)]({'success':![],'message':'Shop\x20access\x20required'});try{const _0x4b635f=require('../config/database')[_0x2a0cd6(0xce)],_0x4e419d=await _0x4b635f[_0x2a0cd6(0xb3)][_0x2a0cd6(0xa8)]({'where':{'id':_0x5106cb[_0x2a0cd6(0xc0)]['id']},'select':{'status':!![]}});if(!_0x4e419d||_0x4e419d[_0x2a0cd6(0xa7)]!=='ACTIVE')return _0x59b823[_0x2a0cd6(0xa7)](0x193)[_0x2a0cd6(0xb7)]({'success':![],'message':_0x2a0cd6(0xc8),'suspended':_0x4e419d?.[_0x2a0cd6(0xa7)]===_0x2a0cd6(0xcb)});_0x254cb7();}catch(_0x33b967){return console[_0x2a0cd6(0xad)]('Error\x20checking\x20account\x20status:',_0x33b967),_0x59b823['status'](0x1f4)['json']({'success':![],'message':_0x2a0cd6(0xc1)});}};exports[a16_0x4e43d1(0xb6)]=requireActiveShop;