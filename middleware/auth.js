'use strict';function a21_0x1c13(){const _0x27e7ad=['Invalid\x20or\x20expired\x20token','6076540gVYTjw','../config/database','authorization','user','headers','authenticateToken','token','secret','2695904yAKUIP','780318JecVjH','ACTIVE','4zJxthv','Error\x20checking\x20account\x20status:','admin','../services/tokenBlacklistService','requireActiveShop','Error\x20checking\x20account\x20status','__esModule','18PIfQaH','requireShop','error','4040064oCtEtI','1175643nKnqco','6rRfZWZ','role','requireAdmin','json','Shop\x20access\x20required','172918oQihvT','verify','jsonwebtoken','shop','status','default','Account\x20is\x20suspended\x20or\x20inactive.\x20Contact\x20administrator\x20to\x20activate\x20your\x20account.','592745ebsXln','tokenBlacklistService'];a21_0x1c13=function(){return _0x27e7ad;};return a21_0x1c13();}const a21_0x19291f=a21_0x1f5a;(function(_0x4d2d1a,_0x2444d2){const _0x36e5f9=a21_0x1f5a,_0x3e81f4=_0x4d2d1a();while(!![]){try{const _0x2ceb0f=parseInt(_0x36e5f9(0xf2))/0x1*(parseInt(_0x36e5f9(0xed))/0x2)+-parseInt(_0x36e5f9(0xec))/0x3+-parseInt(_0x36e5f9(0x107))/0x4*(parseInt(_0x36e5f9(0xf9))/0x5)+-parseInt(_0x36e5f9(0x105))/0x6+parseInt(_0x36e5f9(0xeb))/0x7+parseInt(_0x36e5f9(0x104))/0x8*(-parseInt(_0x36e5f9(0xe8))/0x9)+parseInt(_0x36e5f9(0xfc))/0xa;if(_0x2ceb0f===_0x2444d2)break;else _0x3e81f4['push'](_0x3e81f4['shift']());}catch(_0x58350d){_0x3e81f4['push'](_0x3e81f4['shift']());}}}(a21_0x1c13,0x5efed));var __importDefault=this&&this['__importDefault']||function(_0x3f8762){const _0x2077ba=a21_0x1f5a;return _0x3f8762&&_0x3f8762[_0x2077ba(0xe7)]?_0x3f8762:{'default':_0x3f8762};};Object['defineProperty'](exports,a21_0x19291f(0xe7),{'value':!![]}),exports['requireActiveShop']=exports[a21_0x19291f(0xe9)]=exports[a21_0x19291f(0xef)]=exports[a21_0x19291f(0x101)]=void 0x0;const jsonwebtoken_1=__importDefault(require(a21_0x19291f(0xf4))),config_1=require('../config/config'),tokenBlacklistService_1=require(a21_0x19291f(0xe4)),authenticateToken=(_0x53cd33,_0x4aeb90,_0x38e088)=>{const _0x3742c2=a21_0x19291f,_0x4550b7=_0x53cd33[_0x3742c2(0x100)][_0x3742c2(0xfe)],_0x446449=_0x4550b7&&_0x4550b7['split']('\x20')[0x1];if(!_0x446449)return _0x4aeb90[_0x3742c2(0xf6)](0x191)[_0x3742c2(0xf0)]({'success':![],'message':'Access\x20token\x20required'});if(tokenBlacklistService_1[_0x3742c2(0xfa)]['isTokenBlacklisted'](_0x446449))return _0x4aeb90['status'](0x191)[_0x3742c2(0xf0)]({'success':![],'message':'Token\x20has\x20been\x20revoked'});jsonwebtoken_1[_0x3742c2(0xf7)][_0x3742c2(0xf3)](_0x446449,config_1['config']['jwt'][_0x3742c2(0x103)],(_0x45bed8,_0x2b1092)=>{const _0x34bbbd=_0x3742c2;if(_0x45bed8)return _0x4aeb90[_0x34bbbd(0xf6)](0x193)[_0x34bbbd(0xf0)]({'success':![],'message':_0x34bbbd(0xfb)});_0x53cd33[_0x34bbbd(0xff)]=_0x2b1092,_0x53cd33[_0x34bbbd(0x102)]=_0x446449,_0x38e088();});};exports[a21_0x19291f(0x101)]=authenticateToken;function a21_0x1f5a(_0x59e2b0,_0x17e53d){_0x59e2b0=_0x59e2b0-0xe4;const _0x1c1365=a21_0x1c13();let _0x1f5ab5=_0x1c1365[_0x59e2b0];return _0x1f5ab5;}const requireAdmin=(_0x8a7438,_0x35b3ab,_0x3760eb)=>{const _0x35125c=a21_0x19291f;if(!_0x8a7438[_0x35125c(0xff)]||_0x8a7438[_0x35125c(0xff)][_0x35125c(0xee)]!==_0x35125c(0x109))return _0x35b3ab[_0x35125c(0xf6)](0x193)[_0x35125c(0xf0)]({'success':![],'message':'Admin\x20access\x20required'});_0x3760eb();};exports[a21_0x19291f(0xef)]=requireAdmin;const requireShop=(_0xfc0609,_0x2955fb,_0x3fea49)=>{const _0xcefeb1=a21_0x19291f;if(!_0xfc0609['user']||_0xfc0609[_0xcefeb1(0xff)][_0xcefeb1(0xee)]!==_0xcefeb1(0xf5))return _0x2955fb['status'](0x193)[_0xcefeb1(0xf0)]({'success':![],'message':_0xcefeb1(0xf1)});_0x3fea49();};exports[a21_0x19291f(0xe9)]=requireShop;const requireActiveShop=async(_0x1cb5f0,_0x228c61,_0x4a6885)=>{const _0x51cf37=a21_0x19291f;if(!_0x1cb5f0[_0x51cf37(0xff)]||_0x1cb5f0[_0x51cf37(0xff)]['role']!=='shop')return _0x228c61['status'](0x193)[_0x51cf37(0xf0)]({'success':![],'message':_0x51cf37(0xf1)});try{const _0x4f0e92=require(_0x51cf37(0xfd))[_0x51cf37(0xf7)],_0x21e7ee=await _0x4f0e92[_0x51cf37(0xf5)]['findUnique']({'where':{'id':_0x1cb5f0[_0x51cf37(0xff)]['id']},'select':{'status':!![]}});if(!_0x21e7ee||_0x21e7ee[_0x51cf37(0xf6)]!==_0x51cf37(0x106))return _0x228c61['status'](0x193)[_0x51cf37(0xf0)]({'success':![],'message':_0x51cf37(0xf8),'suspended':_0x21e7ee?.['status']==='SUSPENDED'});_0x4a6885();}catch(_0x1333ba){return console[_0x51cf37(0xea)](_0x51cf37(0x108),_0x1333ba),_0x228c61[_0x51cf37(0xf6)](0x1f4)[_0x51cf37(0xf0)]({'success':![],'message':_0x51cf37(0xe6)});}};exports[a21_0x19291f(0xe5)]=requireActiveShop;