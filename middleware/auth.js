'use strict';const a16_0x21e68b=a16_0x2203;function a16_0x3eb8(){const _0x57b585=['1476540uRUepn','requireAdmin','7973883URFjBs','role','jsonwebtoken','441537eDHLUO','3165855mlOkdO','requireShop','tokenBlacklistService','jwt','defineProperty','verify','3943458YeZKAJ','json','8sTdmbE','Admin\x20access\x20required','shop','user','status','Token\x20has\x20been\x20revoked','admin','SUSPENDED','__esModule','error','split','28407590UefFPM','8FlJZuY','findUnique','../config/database','__importDefault','authorization','secret','Account\x20is\x20suspended\x20or\x20inactive.\x20Contact\x20administrator\x20to\x20activate\x20your\x20account.','ACTIVE','default','isTokenBlacklisted','Shop\x20access\x20required','1422367cyWgZi','requireActiveShop','2dLSFAl','authenticateToken','Invalid\x20or\x20expired\x20token','config'];a16_0x3eb8=function(){return _0x57b585;};return a16_0x3eb8();}(function(_0x5c15a1,_0xa09560){const _0x3dc17d=a16_0x2203,_0x4dc888=_0x5c15a1();while(!![]){try{const _0x2695fb=-parseInt(_0x3dc17d(0x185))/0x1*(parseInt(_0x3dc17d(0x187))/0x2)+parseInt(_0x3dc17d(0x190))/0x3*(parseInt(_0x3dc17d(0x17a))/0x4)+parseInt(_0x3dc17d(0x18b))/0x5+-parseInt(_0x3dc17d(0x197))/0x6+parseInt(_0x3dc17d(0x191))/0x7+parseInt(_0x3dc17d(0x199))/0x8*(-parseInt(_0x3dc17d(0x18d))/0x9)+parseInt(_0x3dc17d(0x179))/0xa;if(_0x2695fb===_0xa09560)break;else _0x4dc888['push'](_0x4dc888['shift']());}catch(_0x2ea6fa){_0x4dc888['push'](_0x4dc888['shift']());}}}(a16_0x3eb8,0xdfe65));var __importDefault=this&&this[a16_0x21e68b(0x17d)]||function(_0xd7d591){const _0x27149f=a16_0x21e68b;return _0xd7d591&&_0xd7d591[_0x27149f(0x176)]?_0xd7d591:{'default':_0xd7d591};};Object[a16_0x21e68b(0x195)](exports,a16_0x21e68b(0x176),{'value':!![]}),exports[a16_0x21e68b(0x186)]=exports[a16_0x21e68b(0x192)]=exports[a16_0x21e68b(0x18c)]=exports[a16_0x21e68b(0x188)]=void 0x0;const jsonwebtoken_1=__importDefault(require(a16_0x21e68b(0x18f))),config_1=require('../config/config'),tokenBlacklistService_1=require('../services/tokenBlacklistService'),authenticateToken=(_0x14f747,_0x28ea03,_0x2db09e)=>{const _0x21dac3=a16_0x21e68b,_0x272ffa=_0x14f747['headers'][_0x21dac3(0x17e)],_0x456508=_0x272ffa&&_0x272ffa[_0x21dac3(0x178)]('\x20')[0x1];if(!_0x456508)return _0x28ea03[_0x21dac3(0x172)](0x191)[_0x21dac3(0x198)]({'success':![],'message':'Access\x20token\x20required'});if(tokenBlacklistService_1[_0x21dac3(0x193)][_0x21dac3(0x183)](_0x456508))return _0x28ea03[_0x21dac3(0x172)](0x191)['json']({'success':![],'message':_0x21dac3(0x173)});jsonwebtoken_1[_0x21dac3(0x182)][_0x21dac3(0x196)](_0x456508,config_1[_0x21dac3(0x18a)][_0x21dac3(0x194)][_0x21dac3(0x17f)],(_0x133839,_0x485ccb)=>{const _0x31998a=_0x21dac3;if(_0x133839)return _0x28ea03[_0x31998a(0x172)](0x193)['json']({'success':![],'message':_0x31998a(0x189)});_0x14f747[_0x31998a(0x19c)]=_0x485ccb,_0x14f747['token']=_0x456508,_0x2db09e();});};exports[a16_0x21e68b(0x188)]=authenticateToken;const requireAdmin=(_0x14eed9,_0x498a0c,_0x294d7e)=>{const _0x59aeac=a16_0x21e68b;if(!_0x14eed9[_0x59aeac(0x19c)]||_0x14eed9['user']['role']!==_0x59aeac(0x174))return _0x498a0c[_0x59aeac(0x172)](0x193)['json']({'success':![],'message':_0x59aeac(0x19a)});_0x294d7e();};exports[a16_0x21e68b(0x18c)]=requireAdmin;const requireShop=(_0x3a8c7e,_0x12eb0c,_0x2b10d2)=>{const _0x3822dd=a16_0x21e68b;if(!_0x3a8c7e[_0x3822dd(0x19c)]||_0x3a8c7e[_0x3822dd(0x19c)][_0x3822dd(0x18e)]!=='shop')return _0x12eb0c['status'](0x193)[_0x3822dd(0x198)]({'success':![],'message':_0x3822dd(0x184)});_0x2b10d2();};exports[a16_0x21e68b(0x192)]=requireShop;function a16_0x2203(_0x48a0cd,_0x30a3ba){const _0x3eb8cb=a16_0x3eb8();return a16_0x2203=function(_0x220373,_0x17efa8){_0x220373=_0x220373-0x172;let _0x154a21=_0x3eb8cb[_0x220373];return _0x154a21;},a16_0x2203(_0x48a0cd,_0x30a3ba);}const requireActiveShop=async(_0x1a01a6,_0x3a9ba8,_0x213e3f)=>{const _0x41c8ab=a16_0x21e68b;if(!_0x1a01a6[_0x41c8ab(0x19c)]||_0x1a01a6[_0x41c8ab(0x19c)][_0x41c8ab(0x18e)]!==_0x41c8ab(0x19b))return _0x3a9ba8[_0x41c8ab(0x172)](0x193)[_0x41c8ab(0x198)]({'success':![],'message':_0x41c8ab(0x184)});try{const _0x221d1f=require(_0x41c8ab(0x17c))['default'],_0x1405f5=await _0x221d1f[_0x41c8ab(0x19b)][_0x41c8ab(0x17b)]({'where':{'id':_0x1a01a6['user']['id']},'select':{'status':!![]}});if(!_0x1405f5||_0x1405f5['status']!==_0x41c8ab(0x181))return _0x3a9ba8['status'](0x193)['json']({'success':![],'message':_0x41c8ab(0x180),'suspended':_0x1405f5?.[_0x41c8ab(0x172)]===_0x41c8ab(0x175)});_0x213e3f();}catch(_0x17fe38){return console[_0x41c8ab(0x177)]('Error\x20checking\x20account\x20status:',_0x17fe38),_0x3a9ba8[_0x41c8ab(0x172)](0x1f4)[_0x41c8ab(0x198)]({'success':![],'message':'Error\x20checking\x20account\x20status'});}};exports['requireActiveShop']=requireActiveShop;