'use strict';const a22_0x25b57c=a22_0x5db0;(function(_0x45a005,_0x1f22ab){const _0x12bb16=a22_0x5db0,_0x3a1623=_0x45a005();while(!![]){try{const _0x210c17=-parseInt(_0x12bb16(0x1f3))/0x1*(parseInt(_0x12bb16(0x1f9))/0x2)+parseInt(_0x12bb16(0x1e9))/0x3*(-parseInt(_0x12bb16(0x1d5))/0x4)+-parseInt(_0x12bb16(0x1f2))/0x5*(parseInt(_0x12bb16(0x1fd))/0x6)+-parseInt(_0x12bb16(0x1ea))/0x7*(-parseInt(_0x12bb16(0x1ef))/0x8)+-parseInt(_0x12bb16(0x1cf))/0x9*(-parseInt(_0x12bb16(0x1dc))/0xa)+-parseInt(_0x12bb16(0x1e1))/0xb*(-parseInt(_0x12bb16(0x1fb))/0xc)+parseInt(_0x12bb16(0x1de))/0xd;if(_0x210c17===_0x1f22ab)break;else _0x3a1623['push'](_0x3a1623['shift']());}catch(_0x28d5fb){_0x3a1623['push'](_0x3a1623['shift']());}}}(a22_0x1b8b,0x23006));function a22_0x1b8b(){const _0x21ff6f=['7vvdiQM','user','jsonwebtoken','../config/config','role','1986904ouFTus','requireShop','defineProperty','125090yIdwuU','64219XZdpBG','ACTIVE','SUSPENDED','__esModule','../config/database','secret','2kWUKXI','findUnique','3320964uxIryt','authorization','48aJDrRV','Account\x20is\x20suspended\x20or\x20inactive.\x20Contact\x20administrator\x20to\x20activate\x20your\x20account.','9729fpXuKY','headers','json','__importDefault','shop','Error\x20checking\x20account\x20status','116sUtOCF','verify','split','Error\x20checking\x20account\x20status:','requireActiveShop','config','Shop\x20access\x20required','330vEfVZI','isTokenBlacklisted','1215175UyyBMF','Access\x20token\x20required','default','11RzdgOo','Admin\x20access\x20required','Invalid\x20or\x20expired\x20token','tokenBlacklistService','requireAdmin','authenticateToken','admin','status','25503airRxa'];a22_0x1b8b=function(){return _0x21ff6f;};return a22_0x1b8b();}function a22_0x5db0(_0x397ee2,_0x593750){_0x397ee2=_0x397ee2-0x1ce;const _0x1b8b3a=a22_0x1b8b();let _0x5db068=_0x1b8b3a[_0x397ee2];return _0x5db068;}var __importDefault=this&&this[a22_0x25b57c(0x1d2)]||function(_0x2c9d22){const _0x314423=a22_0x25b57c;return _0x2c9d22&&_0x2c9d22[_0x314423(0x1f6)]?_0x2c9d22:{'default':_0x2c9d22};};Object[a22_0x25b57c(0x1f1)](exports,a22_0x25b57c(0x1f6),{'value':!![]}),exports[a22_0x25b57c(0x1d9)]=exports[a22_0x25b57c(0x1f0)]=exports['requireAdmin']=exports[a22_0x25b57c(0x1e6)]=void 0x0;const jsonwebtoken_1=__importDefault(require(a22_0x25b57c(0x1ec))),config_1=require(a22_0x25b57c(0x1ed)),tokenBlacklistService_1=require('../services/tokenBlacklistService'),authenticateToken=(_0x2b5c24,_0x132016,_0x2b80c8)=>{const _0x2b24fa=a22_0x25b57c,_0x1c0574=_0x2b5c24[_0x2b24fa(0x1d0)][_0x2b24fa(0x1fc)],_0xab8667=_0x1c0574&&_0x1c0574[_0x2b24fa(0x1d7)]('\x20')[0x1];if(!_0xab8667)return _0x132016[_0x2b24fa(0x1e8)](0x191)[_0x2b24fa(0x1d1)]({'success':![],'message':_0x2b24fa(0x1df)});if(tokenBlacklistService_1[_0x2b24fa(0x1e4)][_0x2b24fa(0x1dd)](_0xab8667))return _0x132016[_0x2b24fa(0x1e8)](0x191)['json']({'success':![],'message':'Token\x20has\x20been\x20revoked'});jsonwebtoken_1[_0x2b24fa(0x1e0)][_0x2b24fa(0x1d6)](_0xab8667,config_1[_0x2b24fa(0x1da)]['jwt'][_0x2b24fa(0x1f8)],(_0x14c153,_0x4156fb)=>{const _0x1a4fd9=_0x2b24fa;if(_0x14c153)return _0x132016[_0x1a4fd9(0x1e8)](0x193)[_0x1a4fd9(0x1d1)]({'success':![],'message':_0x1a4fd9(0x1e3)});_0x2b5c24['user']=_0x4156fb,_0x2b5c24['token']=_0xab8667,_0x2b80c8();});};exports[a22_0x25b57c(0x1e6)]=authenticateToken;const requireAdmin=(_0x3b07f9,_0x5f030a,_0xe6d57)=>{const _0x335834=a22_0x25b57c;if(!_0x3b07f9[_0x335834(0x1eb)]||_0x3b07f9[_0x335834(0x1eb)][_0x335834(0x1ee)]!==_0x335834(0x1e7))return _0x5f030a[_0x335834(0x1e8)](0x193)[_0x335834(0x1d1)]({'success':![],'message':_0x335834(0x1e2)});_0xe6d57();};exports[a22_0x25b57c(0x1e5)]=requireAdmin;const requireShop=(_0x126487,_0x5f2fa6,_0x556048)=>{const _0x10ca83=a22_0x25b57c;if(!_0x126487[_0x10ca83(0x1eb)]||_0x126487[_0x10ca83(0x1eb)]['role']!==_0x10ca83(0x1d3))return _0x5f2fa6['status'](0x193)[_0x10ca83(0x1d1)]({'success':![],'message':'Shop\x20access\x20required'});_0x556048();};exports['requireShop']=requireShop;const requireActiveShop=async(_0x388b9b,_0x221250,_0x2ce2b7)=>{const _0x5e787b=a22_0x25b57c;if(!_0x388b9b[_0x5e787b(0x1eb)]||_0x388b9b[_0x5e787b(0x1eb)]['role']!=='shop')return _0x221250[_0x5e787b(0x1e8)](0x193)['json']({'success':![],'message':_0x5e787b(0x1db)});try{const _0x970ec9=require(_0x5e787b(0x1f7))[_0x5e787b(0x1e0)],_0x227675=await _0x970ec9[_0x5e787b(0x1d3)][_0x5e787b(0x1fa)]({'where':{'id':_0x388b9b[_0x5e787b(0x1eb)]['id']},'select':{'status':!![]}});if(!_0x227675||_0x227675['status']!==_0x5e787b(0x1f4))return _0x221250['status'](0x193)[_0x5e787b(0x1d1)]({'success':![],'message':_0x5e787b(0x1ce),'suspended':_0x227675?.[_0x5e787b(0x1e8)]===_0x5e787b(0x1f5)});_0x2ce2b7();}catch(_0x224418){return console['error'](_0x5e787b(0x1d8),_0x224418),_0x221250['status'](0x1f4)['json']({'success':![],'message':_0x5e787b(0x1d4)});}};exports['requireActiveShop']=requireActiveShop;