'use strict';function a15_0x16ab(_0x49424b,_0x5894c9){const _0x3ca550=a15_0x3ca5();return a15_0x16ab=function(_0x16ab0b,_0x1cc427){_0x16ab0b=_0x16ab0b-0xcb;let _0x3d052d=_0x3ca550[_0x16ab0b];return _0x3d052d;},a15_0x16ab(_0x49424b,_0x5894c9);}const a15_0x84f316=a15_0x16ab;(function(_0x5882e1,_0x1db45c){const _0x42ad99=a15_0x16ab,_0x2f1b1c=_0x5882e1();while(!![]){try{const _0xb38da7=-parseInt(_0x42ad99(0xd3))/0x1*(-parseInt(_0x42ad99(0xd7))/0x2)+parseInt(_0x42ad99(0xcf))/0x3*(parseInt(_0x42ad99(0xde))/0x4)+parseInt(_0x42ad99(0xdb))/0x5*(parseInt(_0x42ad99(0xdd))/0x6)+-parseInt(_0x42ad99(0xcc))/0x7+-parseInt(_0x42ad99(0xe2))/0x8+-parseInt(_0x42ad99(0xd4))/0x9*(parseInt(_0x42ad99(0xe3))/0xa)+parseInt(_0x42ad99(0xd1))/0xb;if(_0xb38da7===_0x1db45c)break;else _0x2f1b1c['push'](_0x2f1b1c['shift']());}catch(_0xb0072){_0x2f1b1c['push'](_0x2f1b1c['shift']());}}}(a15_0x3ca5,0x413a3));function a15_0x3ca5(){const _0x38bad0=['Token\x20has\x20been\x20revoked','config','Access\x20token\x20required','headers','requireShop','__importDefault','947296fqajLU','status','secret','575079aYFFQa','requireAdmin','25498SGaUUH','jwt','461523TYchPh','18ByfcNZ','Admin\x20access\x20required','__esModule','2jrezNV','isTokenBlacklisted','role','token','2440835PcRYUo','../services/tokenBlacklistService','6BepRqH','4sOFTvs','admin','authorization','shop','4204704MrgDOe','1078070DdVaFI','defineProperty','default','authenticateToken','user','json','Shop\x20access\x20required'];a15_0x3ca5=function(){return _0x38bad0;};return a15_0x3ca5();}var __importDefault=this&&this[a15_0x84f316(0xcb)]||function(_0x553584){const _0x1f2ac6=a15_0x84f316;return _0x553584&&_0x553584[_0x1f2ac6(0xd6)]?_0x553584:{'default':_0x553584};};Object[a15_0x84f316(0xe4)](exports,'__esModule',{'value':!![]}),exports[a15_0x84f316(0xee)]=exports[a15_0x84f316(0xd0)]=exports['authenticateToken']=void 0x0;const jsonwebtoken_1=__importDefault(require('jsonwebtoken')),config_1=require('../config/config'),tokenBlacklistService_1=require(a15_0x84f316(0xdc)),authenticateToken=(_0x5385fd,_0x573dc6,_0x29d68c)=>{const _0x4179ef=a15_0x84f316,_0x14c7c4=_0x5385fd[_0x4179ef(0xed)][_0x4179ef(0xe0)],_0x26a8b0=_0x14c7c4&&_0x14c7c4['split']('\x20')[0x1];if(!_0x26a8b0)return _0x573dc6[_0x4179ef(0xcd)](0x191)[_0x4179ef(0xe8)]({'success':![],'message':_0x4179ef(0xec)});if(tokenBlacklistService_1['tokenBlacklistService'][_0x4179ef(0xd8)](_0x26a8b0))return _0x573dc6[_0x4179ef(0xcd)](0x191)[_0x4179ef(0xe8)]({'success':![],'message':_0x4179ef(0xea)});jsonwebtoken_1[_0x4179ef(0xe5)]['verify'](_0x26a8b0,config_1[_0x4179ef(0xeb)][_0x4179ef(0xd2)][_0x4179ef(0xce)],(_0x9b0763,_0x2afde5)=>{const _0x24d832=_0x4179ef;if(_0x9b0763)return _0x573dc6['status'](0x193)[_0x24d832(0xe8)]({'success':![],'message':'Invalid\x20or\x20expired\x20token'});_0x5385fd[_0x24d832(0xe7)]=_0x2afde5,_0x5385fd[_0x24d832(0xda)]=_0x26a8b0,_0x29d68c();});};exports[a15_0x84f316(0xe6)]=authenticateToken;const requireAdmin=(_0x5cd7d6,_0x2baaef,_0x199dcb)=>{const _0x4022b1=a15_0x84f316;if(!_0x5cd7d6['user']||_0x5cd7d6[_0x4022b1(0xe7)][_0x4022b1(0xd9)]!==_0x4022b1(0xdf))return _0x2baaef[_0x4022b1(0xcd)](0x193)['json']({'success':![],'message':_0x4022b1(0xd5)});_0x199dcb();};exports[a15_0x84f316(0xd0)]=requireAdmin;const requireShop=(_0x1da167,_0x1de243,_0xad3735)=>{const _0x300b93=a15_0x84f316;if(!_0x1da167[_0x300b93(0xe7)]||_0x1da167[_0x300b93(0xe7)]['role']!==_0x300b93(0xe1))return _0x1de243[_0x300b93(0xcd)](0x193)['json']({'success':![],'message':_0x300b93(0xe9)});_0xad3735();};exports[a15_0x84f316(0xee)]=requireShop;