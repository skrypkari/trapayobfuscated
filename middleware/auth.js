'use strict';const a18_0x5bdc30=a18_0xa9d0;(function(_0x1eddf1,_0x199655){const _0x23b8a5=a18_0xa9d0,_0x357097=_0x1eddf1();while(!![]){try{const _0x399189=-parseInt(_0x23b8a5(0x1f1))/0x1*(parseInt(_0x23b8a5(0x1ee))/0x2)+parseInt(_0x23b8a5(0x1fd))/0x3+parseInt(_0x23b8a5(0x20a))/0x4*(parseInt(_0x23b8a5(0x201))/0x5)+parseInt(_0x23b8a5(0x1ea))/0x6*(-parseInt(_0x23b8a5(0x1f8))/0x7)+parseInt(_0x23b8a5(0x1eb))/0x8*(-parseInt(_0x23b8a5(0x1f0))/0x9)+-parseInt(_0x23b8a5(0x1f2))/0xa+-parseInt(_0x23b8a5(0x203))/0xb*(-parseInt(_0x23b8a5(0x1e7))/0xc);if(_0x399189===_0x199655)break;else _0x357097['push'](_0x357097['shift']());}catch(_0x4379ec){_0x357097['push'](_0x357097['shift']());}}}(a18_0x45e7,0x4e484));function a18_0xa9d0(_0x7db9,_0x51ee91){const _0x45e7f5=a18_0x45e7();return a18_0xa9d0=function(_0xa9d046,_0x119520){_0xa9d046=_0xa9d046-0x1e5;let _0x29dfde=_0x45e7f5[_0xa9d046];return _0x29dfde;},a18_0xa9d0(_0x7db9,_0x51ee91);}var __importDefault=this&&this[a18_0x5bdc30(0x1e8)]||function(_0x15953a){const _0x204cb8=a18_0x5bdc30;return _0x15953a&&_0x15953a[_0x204cb8(0x20d)]?_0x15953a:{'default':_0x15953a};};Object['defineProperty'](exports,a18_0x5bdc30(0x20d),{'value':!![]}),exports[a18_0x5bdc30(0x1fe)]=exports['requireShop']=exports['requireAdmin']=exports[a18_0x5bdc30(0x20b)]=void 0x0;const jsonwebtoken_1=__importDefault(require(a18_0x5bdc30(0x20c))),config_1=require(a18_0x5bdc30(0x1e5)),tokenBlacklistService_1=require(a18_0x5bdc30(0x1ef)),authenticateToken=(_0x368e86,_0x3ca46a,_0x2856df)=>{const _0x25dbb5=a18_0x5bdc30,_0x1fa928=_0x368e86[_0x25dbb5(0x208)][_0x25dbb5(0x1ec)],_0x5cd195=_0x1fa928&&_0x1fa928[_0x25dbb5(0x209)]('\x20')[0x1];if(!_0x5cd195)return _0x3ca46a[_0x25dbb5(0x1e6)](0x191)[_0x25dbb5(0x1f3)]({'success':![],'message':'Access\x20token\x20required'});if(tokenBlacklistService_1[_0x25dbb5(0x204)][_0x25dbb5(0x1f9)](_0x5cd195))return _0x3ca46a[_0x25dbb5(0x1e6)](0x191)['json']({'success':![],'message':_0x25dbb5(0x202)});jsonwebtoken_1[_0x25dbb5(0x1f6)]['verify'](_0x5cd195,config_1['config'][_0x25dbb5(0x1fb)][_0x25dbb5(0x1ff)],(_0x20030c,_0x427680)=>{const _0xc83c2=_0x25dbb5;if(_0x20030c)return _0x3ca46a[_0xc83c2(0x1e6)](0x193)[_0xc83c2(0x1f3)]({'success':![],'message':'Invalid\x20or\x20expired\x20token'});_0x368e86['user']=_0x427680,_0x368e86[_0xc83c2(0x1e9)]=_0x5cd195,_0x2856df();});};exports['authenticateToken']=authenticateToken;const requireAdmin=(_0x1a96d1,_0x1e2f1,_0x4e1557)=>{const _0xb761c0=a18_0x5bdc30;if(!_0x1a96d1['user']||_0x1a96d1[_0xb761c0(0x1ed)][_0xb761c0(0x205)]!==_0xb761c0(0x200))return _0x1e2f1[_0xb761c0(0x1e6)](0x193)['json']({'success':![],'message':'Admin\x20access\x20required'});_0x4e1557();};exports[a18_0x5bdc30(0x206)]=requireAdmin;const requireShop=(_0x595df4,_0xca77cc,_0xccf067)=>{const _0x5425d8=a18_0x5bdc30;if(!_0x595df4['user']||_0x595df4[_0x5425d8(0x1ed)]['role']!==_0x5425d8(0x1fc))return _0xca77cc[_0x5425d8(0x1e6)](0x193)[_0x5425d8(0x1f3)]({'success':![],'message':_0x5425d8(0x1fa)});_0xccf067();};function a18_0x45e7(){const _0x2dc689=['Shop\x20access\x20required','jwt','shop','862860Chyjgi','requireActiveShop','secret','admin','1070GbUzOT','Token\x20has\x20been\x20revoked','296461jjNxmd','tokenBlacklistService','role','requireAdmin','ACTIVE','headers','split','6012AdAhcE','authenticateToken','jsonwebtoken','__esModule','../config/config','status','168lXOhhv','__importDefault','token','228zPiIRB','248RkLZLi','authorization','user','8258LrHcjT','../services/tokenBlacklistService','1503ZpsZTv','37XhIBYx','4079660djEohZ','json','SUSPENDED','Error\x20checking\x20account\x20status:','default','findUnique','18424vGVNyT','isTokenBlacklisted'];a18_0x45e7=function(){return _0x2dc689;};return a18_0x45e7();}exports['requireShop']=requireShop;const requireActiveShop=async(_0x932077,_0x796843,_0x4a2943)=>{const _0x53087c=a18_0x5bdc30;if(!_0x932077[_0x53087c(0x1ed)]||_0x932077[_0x53087c(0x1ed)]['role']!==_0x53087c(0x1fc))return _0x796843['status'](0x193)[_0x53087c(0x1f3)]({'success':![],'message':_0x53087c(0x1fa)});try{const _0x1d3dbc=require('../config/database')[_0x53087c(0x1f6)],_0x255909=await _0x1d3dbc['shop'][_0x53087c(0x1f7)]({'where':{'id':_0x932077[_0x53087c(0x1ed)]['id']},'select':{'status':!![]}});if(!_0x255909||_0x255909[_0x53087c(0x1e6)]!==_0x53087c(0x207))return _0x796843[_0x53087c(0x1e6)](0x193)[_0x53087c(0x1f3)]({'success':![],'message':'Account\x20is\x20suspended\x20or\x20inactive.\x20Contact\x20administrator\x20to\x20activate\x20your\x20account.','suspended':_0x255909?.[_0x53087c(0x1e6)]===_0x53087c(0x1f4)});_0x4a2943();}catch(_0x1b3b65){return console['error'](_0x53087c(0x1f5),_0x1b3b65),_0x796843[_0x53087c(0x1e6)](0x1f4)[_0x53087c(0x1f3)]({'success':![],'message':'Error\x20checking\x20account\x20status'});}};exports['requireActiveShop']=requireActiveShop;