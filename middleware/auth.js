'use strict';const a22_0x405988=a22_0x175b;(function(_0x4d2d7e,_0x4ae5a1){const _0x27d1ca=a22_0x175b,_0xe5e8be=_0x4d2d7e();while(!![]){try{const _0x131d06=-parseInt(_0x27d1ca(0x167))/0x1*(-parseInt(_0x27d1ca(0x17c))/0x2)+parseInt(_0x27d1ca(0x161))/0x3*(-parseInt(_0x27d1ca(0x16a))/0x4)+-parseInt(_0x27d1ca(0x16d))/0x5+parseInt(_0x27d1ca(0x15c))/0x6*(parseInt(_0x27d1ca(0x17b))/0x7)+parseInt(_0x27d1ca(0x15e))/0x8+-parseInt(_0x27d1ca(0x15b))/0x9*(parseInt(_0x27d1ca(0x17a))/0xa)+parseInt(_0x27d1ca(0x174))/0xb;if(_0x131d06===_0x4ae5a1)break;else _0xe5e8be['push'](_0xe5e8be['shift']());}catch(_0x5db988){_0xe5e8be['push'](_0xe5e8be['shift']());}}}(a22_0x5004,0x55501));function a22_0x5004(){const _0x45abd9=['4JWfmrA','json','verify','1761950WUjlbW','role','Invalid\x20or\x20expired\x20token','Error\x20checking\x20account\x20status','tokenBlacklistService','default','error','7169492dLhyTP','Token\x20has\x20been\x20revoked','Account\x20is\x20suspended\x20or\x20inactive.\x20Contact\x20administrator\x20to\x20activate\x20your\x20account.','../config/config','user','jsonwebtoken','10RFMvkg','39557FHkLnN','370aHKhfw','token','findUnique','requireShop','../config/database','requireActiveShop','secret','3479472IsPosS','228iaYhRh','authorization','3595960XIPyxH','shop','Access\x20token\x20required','1602333ZiFyDd','admin','authenticateToken','ACTIVE','status','config','1657GnupVU','defineProperty','SUSPENDED'];a22_0x5004=function(){return _0x45abd9;};return a22_0x5004();}function a22_0x175b(_0x44d320,_0x1a3c7d){_0x44d320=_0x44d320-0x155;const _0x50044a=a22_0x5004();let _0x175bca=_0x50044a[_0x44d320];return _0x175bca;}var __importDefault=this&&this['__importDefault']||function(_0x11ac49){return _0x11ac49&&_0x11ac49['__esModule']?_0x11ac49:{'default':_0x11ac49};};Object[a22_0x405988(0x168)](exports,'__esModule',{'value':!![]}),exports[a22_0x405988(0x159)]=exports['requireShop']=exports['requireAdmin']=exports[a22_0x405988(0x163)]=void 0x0;const jsonwebtoken_1=__importDefault(require(a22_0x405988(0x179))),config_1=require(a22_0x405988(0x177)),tokenBlacklistService_1=require('../services/tokenBlacklistService'),authenticateToken=(_0x3cc629,_0x217f2c,_0x5dbeb6)=>{const _0x48226c=a22_0x405988,_0x52b502=_0x3cc629['headers'][_0x48226c(0x15d)],_0x451599=_0x52b502&&_0x52b502['split']('\x20')[0x1];if(!_0x451599)return _0x217f2c[_0x48226c(0x165)](0x191)[_0x48226c(0x16b)]({'success':![],'message':_0x48226c(0x160)});if(tokenBlacklistService_1[_0x48226c(0x171)]['isTokenBlacklisted'](_0x451599))return _0x217f2c[_0x48226c(0x165)](0x191)[_0x48226c(0x16b)]({'success':![],'message':_0x48226c(0x175)});jsonwebtoken_1['default'][_0x48226c(0x16c)](_0x451599,config_1[_0x48226c(0x166)]['jwt'][_0x48226c(0x15a)],(_0xdb400,_0x5be2ef)=>{const _0x2720f8=_0x48226c;if(_0xdb400)return _0x217f2c['status'](0x193)[_0x2720f8(0x16b)]({'success':![],'message':_0x2720f8(0x16f)});_0x3cc629['user']=_0x5be2ef,_0x3cc629[_0x2720f8(0x155)]=_0x451599,_0x5dbeb6();});};exports[a22_0x405988(0x163)]=authenticateToken;const requireAdmin=(_0x37eb26,_0x1acbb2,_0x51100e)=>{const _0x4bfa38=a22_0x405988;if(!_0x37eb26[_0x4bfa38(0x178)]||_0x37eb26[_0x4bfa38(0x178)][_0x4bfa38(0x16e)]!==_0x4bfa38(0x162))return _0x1acbb2['status'](0x193)[_0x4bfa38(0x16b)]({'success':![],'message':'Admin\x20access\x20required'});_0x51100e();};exports['requireAdmin']=requireAdmin;const requireShop=(_0x12c09a,_0x58ffe1,_0x48b7bf)=>{const _0x429745=a22_0x405988;if(!_0x12c09a[_0x429745(0x178)]||_0x12c09a[_0x429745(0x178)][_0x429745(0x16e)]!==_0x429745(0x15f))return _0x58ffe1['status'](0x193)[_0x429745(0x16b)]({'success':![],'message':'Shop\x20access\x20required'});_0x48b7bf();};exports[a22_0x405988(0x157)]=requireShop;const requireActiveShop=async(_0x3f1943,_0x17a7b3,_0x403b20)=>{const _0x4bd019=a22_0x405988;if(!_0x3f1943[_0x4bd019(0x178)]||_0x3f1943[_0x4bd019(0x178)][_0x4bd019(0x16e)]!==_0x4bd019(0x15f))return _0x17a7b3[_0x4bd019(0x165)](0x193)['json']({'success':![],'message':'Shop\x20access\x20required'});try{const _0x58f44b=require(_0x4bd019(0x158))[_0x4bd019(0x172)],_0x2f5f5b=await _0x58f44b['shop'][_0x4bd019(0x156)]({'where':{'id':_0x3f1943[_0x4bd019(0x178)]['id']},'select':{'status':!![]}});if(!_0x2f5f5b||_0x2f5f5b[_0x4bd019(0x165)]!==_0x4bd019(0x164))return _0x17a7b3['status'](0x193)['json']({'success':![],'message':_0x4bd019(0x176),'suspended':_0x2f5f5b?.[_0x4bd019(0x165)]===_0x4bd019(0x169)});_0x403b20();}catch(_0x39d60d){return console[_0x4bd019(0x173)]('Error\x20checking\x20account\x20status:',_0x39d60d),_0x17a7b3['status'](0x1f4)[_0x4bd019(0x16b)]({'success':![],'message':_0x4bd019(0x170)});}};exports['requireActiveShop']=requireActiveShop;