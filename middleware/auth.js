'use strict';function a15_0x2cb2(_0x10fd8b,_0x111f4e){const _0x986c10=a15_0x986c();return a15_0x2cb2=function(_0x2cb2d3,_0x5960bd){_0x2cb2d3=_0x2cb2d3-0xe0;let _0x1dfd3c=_0x986c10[_0x2cb2d3];return _0x1dfd3c;},a15_0x2cb2(_0x10fd8b,_0x111f4e);}const a15_0x10bf6a=a15_0x2cb2;(function(_0x1de7cb,_0x121f58){const _0xefe2e7=a15_0x2cb2,_0x1013f6=_0x1de7cb();while(!![]){try{const _0x510fed=parseInt(_0xefe2e7(0xff))/0x1*(-parseInt(_0xefe2e7(0xeb))/0x2)+-parseInt(_0xefe2e7(0xea))/0x3+parseInt(_0xefe2e7(0xfc))/0x4+-parseInt(_0xefe2e7(0xee))/0x5*(parseInt(_0xefe2e7(0xf0))/0x6)+-parseInt(_0xefe2e7(0xfe))/0x7+-parseInt(_0xefe2e7(0xf6))/0x8*(parseInt(_0xefe2e7(0xf1))/0x9)+-parseInt(_0xefe2e7(0xfb))/0xa*(-parseInt(_0xefe2e7(0xe0))/0xb);if(_0x510fed===_0x121f58)break;else _0x1013f6['push'](_0x1013f6['shift']());}catch(_0x24628d){_0x1013f6['push'](_0x1013f6['shift']());}}}(a15_0x986c,0x591cb));function a15_0x986c(){const _0x14878f=['1853784TfagTb','shop','user','Shop\x20access\x20required','requireAdmin','16hiiJvk','config','tokenBlacklistService','admin','headers','4820CEmfzs','2197624kSQjdD','default','437283KdNWka','17SmkhiZ','jwt','secret','35354nPlKMs','status','authorization','Token\x20has\x20been\x20revoked','json','isTokenBlacklisted','requireShop','role','Invalid\x20or\x20expired\x20token','Access\x20token\x20required','1779057QIcaZW','40438TvLWgy','jsonwebtoken','authenticateToken','8620kWMRal','split','1122xNMRnF'];a15_0x986c=function(){return _0x14878f;};return a15_0x986c();}var __importDefault=this&&this['__importDefault']||function(_0x1a30f7){return _0x1a30f7&&_0x1a30f7['__esModule']?_0x1a30f7:{'default':_0x1a30f7};};Object['defineProperty'](exports,'__esModule',{'value':!![]}),exports[a15_0x10bf6a(0xe6)]=exports[a15_0x10bf6a(0xf5)]=exports[a15_0x10bf6a(0xed)]=void 0x0;const jsonwebtoken_1=__importDefault(require(a15_0x10bf6a(0xec))),config_1=require('../config/config'),tokenBlacklistService_1=require('../services/tokenBlacklistService'),authenticateToken=(_0x4c9c62,_0x519e93,_0xf4783a)=>{const _0x40b08e=a15_0x10bf6a,_0x4f8f5e=_0x4c9c62[_0x40b08e(0xfa)][_0x40b08e(0xe2)],_0x21f415=_0x4f8f5e&&_0x4f8f5e[_0x40b08e(0xef)]('\x20')[0x1];if(!_0x21f415)return _0x519e93['status'](0x191)[_0x40b08e(0xe4)]({'success':![],'message':_0x40b08e(0xe9)});if(tokenBlacklistService_1[_0x40b08e(0xf8)][_0x40b08e(0xe5)](_0x21f415))return _0x519e93[_0x40b08e(0xe1)](0x191)[_0x40b08e(0xe4)]({'success':![],'message':_0x40b08e(0xe3)});jsonwebtoken_1[_0x40b08e(0xfd)]['verify'](_0x21f415,config_1[_0x40b08e(0xf7)][_0x40b08e(0x100)][_0x40b08e(0x101)],(_0x1ceadd,_0x3f0805)=>{const _0x4f99e2=_0x40b08e;if(_0x1ceadd)return _0x519e93[_0x4f99e2(0xe1)](0x193)['json']({'success':![],'message':_0x4f99e2(0xe8)});_0x4c9c62[_0x4f99e2(0xf3)]=_0x3f0805,_0x4c9c62['token']=_0x21f415,_0xf4783a();});};exports[a15_0x10bf6a(0xed)]=authenticateToken;const requireAdmin=(_0x250027,_0x1a3131,_0x41d575)=>{const _0x42ee45=a15_0x10bf6a;if(!_0x250027[_0x42ee45(0xf3)]||_0x250027[_0x42ee45(0xf3)][_0x42ee45(0xe7)]!==_0x42ee45(0xf9))return _0x1a3131['status'](0x193)[_0x42ee45(0xe4)]({'success':![],'message':'Admin\x20access\x20required'});_0x41d575();};exports[a15_0x10bf6a(0xf5)]=requireAdmin;const requireShop=(_0x51aa4f,_0x307e79,_0x594a30)=>{const _0x43cbe2=a15_0x10bf6a;if(!_0x51aa4f[_0x43cbe2(0xf3)]||_0x51aa4f[_0x43cbe2(0xf3)][_0x43cbe2(0xe7)]!==_0x43cbe2(0xf2))return _0x307e79[_0x43cbe2(0xe1)](0x193)[_0x43cbe2(0xe4)]({'success':![],'message':_0x43cbe2(0xf4)});_0x594a30();};exports[a15_0x10bf6a(0xe6)]=requireShop;