'use strict';function a16_0x2f1f(){const _0x38f038=['4351020vGBzXS','Token\x20has\x20been\x20revoked','9ZvfyhV','findUnique','5793448tlheDs','config','tokenBlacklistService','error','verify','json','__esModule','jsonwebtoken','requireAdmin','1645174cNCLXQ','authenticateToken','requireActiveShop','124056FhorzD','Account\x20is\x20suspended\x20or\x20inactive.\x20Contact\x20administrator\x20to\x20activate\x20your\x20account.','token','authorization','1229898GEwSjL','Invalid\x20or\x20expired\x20token','shop','Error\x20checking\x20account\x20status','role','Access\x20token\x20required','split','user','headers','isTokenBlacklisted','jwt','308160rnAXRN','49xybXHV','default','Shop\x20access\x20required','Admin\x20access\x20required','requireShop','__importDefault','../config/database','../config/config','ACTIVE','SUSPENDED','status','7409430ijjyQq'];a16_0x2f1f=function(){return _0x38f038;};return a16_0x2f1f();}const a16_0x38bbac=a16_0x4a02;(function(_0x163ff8,_0x6c46c9){const _0x50396e=a16_0x4a02,_0x108959=_0x163ff8();while(!![]){try{const _0x1e089c=-parseInt(_0x50396e(0x9e))/0x1+-parseInt(_0x50396e(0x9b))/0x2+parseInt(_0x50396e(0xad))/0x3+parseInt(_0x50396e(0xba))/0x4+-parseInt(_0x50396e(0xb9))/0x5+-parseInt(_0x50396e(0xa2))/0x6*(-parseInt(_0x50396e(0xae))/0x7)+-parseInt(_0x50396e(0xbe))/0x8*(-parseInt(_0x50396e(0xbc))/0x9);if(_0x1e089c===_0x6c46c9)break;else _0x108959['push'](_0x108959['shift']());}catch(_0xea03b5){_0x108959['push'](_0x108959['shift']());}}}(a16_0x2f1f,0xe0db0));var __importDefault=this&&this[a16_0x38bbac(0xb3)]||function(_0x3e41a8){return _0x3e41a8&&_0x3e41a8['__esModule']?_0x3e41a8:{'default':_0x3e41a8};};Object['defineProperty'](exports,a16_0x38bbac(0x98),{'value':!![]}),exports['requireActiveShop']=exports[a16_0x38bbac(0xb2)]=exports[a16_0x38bbac(0x9a)]=exports[a16_0x38bbac(0x9c)]=void 0x0;const jsonwebtoken_1=__importDefault(require(a16_0x38bbac(0x99))),config_1=require(a16_0x38bbac(0xb5)),tokenBlacklistService_1=require('../services/tokenBlacklistService'),authenticateToken=(_0x5966cc,_0x394997,_0x170340)=>{const _0x13406d=a16_0x38bbac,_0x2cabbb=_0x5966cc[_0x13406d(0xaa)][_0x13406d(0xa1)],_0x438672=_0x2cabbb&&_0x2cabbb[_0x13406d(0xa8)]('\x20')[0x1];if(!_0x438672)return _0x394997['status'](0x191)['json']({'success':![],'message':_0x13406d(0xa7)});if(tokenBlacklistService_1[_0x13406d(0x94)][_0x13406d(0xab)](_0x438672))return _0x394997[_0x13406d(0xb8)](0x191)['json']({'success':![],'message':_0x13406d(0xbb)});jsonwebtoken_1['default'][_0x13406d(0x96)](_0x438672,config_1[_0x13406d(0x93)][_0x13406d(0xac)]['secret'],(_0x1fe55d,_0x36adba)=>{const _0x4e04ab=_0x13406d;if(_0x1fe55d)return _0x394997[_0x4e04ab(0xb8)](0x193)[_0x4e04ab(0x97)]({'success':![],'message':_0x4e04ab(0xa3)});_0x5966cc[_0x4e04ab(0xa9)]=_0x36adba,_0x5966cc[_0x4e04ab(0xa0)]=_0x438672,_0x170340();});};exports['authenticateToken']=authenticateToken;const requireAdmin=(_0x3284d2,_0x374c5a,_0x4c1075)=>{const _0x1f5d03=a16_0x38bbac;if(!_0x3284d2['user']||_0x3284d2[_0x1f5d03(0xa9)][_0x1f5d03(0xa6)]!=='admin')return _0x374c5a[_0x1f5d03(0xb8)](0x193)[_0x1f5d03(0x97)]({'success':![],'message':_0x1f5d03(0xb1)});_0x4c1075();};exports[a16_0x38bbac(0x9a)]=requireAdmin;const requireShop=(_0x590c20,_0x1453dd,_0x17b435)=>{const _0x17e402=a16_0x38bbac;if(!_0x590c20[_0x17e402(0xa9)]||_0x590c20[_0x17e402(0xa9)][_0x17e402(0xa6)]!==_0x17e402(0xa4))return _0x1453dd[_0x17e402(0xb8)](0x193)[_0x17e402(0x97)]({'success':![],'message':'Shop\x20access\x20required'});_0x17b435();};exports[a16_0x38bbac(0xb2)]=requireShop;const requireActiveShop=async(_0x351508,_0x18eaaf,_0x4bbe5a)=>{const _0x24ae6b=a16_0x38bbac;if(!_0x351508[_0x24ae6b(0xa9)]||_0x351508[_0x24ae6b(0xa9)][_0x24ae6b(0xa6)]!=='shop')return _0x18eaaf['status'](0x193)[_0x24ae6b(0x97)]({'success':![],'message':_0x24ae6b(0xb0)});try{const _0x210f40=require(_0x24ae6b(0xb4))[_0x24ae6b(0xaf)],_0x6d9aa=await _0x210f40['shop'][_0x24ae6b(0xbd)]({'where':{'id':_0x351508[_0x24ae6b(0xa9)]['id']},'select':{'status':!![]}});if(!_0x6d9aa||_0x6d9aa['status']!==_0x24ae6b(0xb6))return _0x18eaaf[_0x24ae6b(0xb8)](0x193)[_0x24ae6b(0x97)]({'success':![],'message':_0x24ae6b(0x9f),'suspended':_0x6d9aa?.['status']===_0x24ae6b(0xb7)});_0x4bbe5a();}catch(_0x3f0281){return console[_0x24ae6b(0x95)]('Error\x20checking\x20account\x20status:',_0x3f0281),_0x18eaaf['status'](0x1f4)[_0x24ae6b(0x97)]({'success':![],'message':_0x24ae6b(0xa5)});}};function a16_0x4a02(_0x19235c,_0x341802){const _0x2f1f3b=a16_0x2f1f();return a16_0x4a02=function(_0x4a0242,_0xf859e9){_0x4a0242=_0x4a0242-0x93;let _0x3d49eb=_0x2f1f3b[_0x4a0242];return _0x3d49eb;},a16_0x4a02(_0x19235c,_0x341802);}exports[a16_0x38bbac(0x9d)]=requireActiveShop;