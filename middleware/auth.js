'use strict';const a24_0x5396d6=a24_0x55f0;(function(_0x1d1b17,_0x20e793){const _0x10113a=a24_0x55f0,_0x2a7020=_0x1d1b17();while(!![]){try{const _0x30d355=parseInt(_0x10113a(0x14c))/0x1+parseInt(_0x10113a(0x151))/0x2*(parseInt(_0x10113a(0x144))/0x3)+-parseInt(_0x10113a(0x166))/0x4+-parseInt(_0x10113a(0x155))/0x5+parseInt(_0x10113a(0x16e))/0x6+parseInt(_0x10113a(0x14d))/0x7*(parseInt(_0x10113a(0x150))/0x8)+parseInt(_0x10113a(0x159))/0x9*(-parseInt(_0x10113a(0x160))/0xa);if(_0x30d355===_0x20e793)break;else _0x2a7020['push'](_0x2a7020['shift']());}catch(_0x194a17){_0x2a7020['push'](_0x2a7020['shift']());}}}(a24_0x1a13,0x212ae));var __importDefault=this&&this[a24_0x5396d6(0x165)]||function(_0x1e7877){return _0x1e7877&&_0x1e7877['__esModule']?_0x1e7877:{'default':_0x1e7877};};function a24_0x1a13(){const _0x1545d6=['requireAdmin','user','Invalid\x20or\x20expired\x20token','secret','config','Error\x20checking\x20account\x20status:','1010NwAChF','isTokenBlacklisted','split','../config/config','role','__importDefault','355304pADgDd','defineProperty','ACTIVE','requireActiveShop','verify','json','authorization','Token\x20has\x20been\x20revoked','1406262oPRQNB','3HaUtOC','Account\x20is\x20suspended\x20or\x20inactive.\x20Contact\x20administrator\x20to\x20activate\x20your\x20account.','jwt','status','Access\x20token\x20required','token','Error\x20checking\x20account\x20status','shop','223726JUeJzg','7JqMIKW','SUSPENDED','requireShop','1466248ORtQkv','168802GovONa','headers','tokenBlacklistService','authenticateToken','665810OUmzLs','Shop\x20access\x20required','__esModule','../config/database','32787JgMYbI'];a24_0x1a13=function(){return _0x1545d6;};return a24_0x1a13();}Object[a24_0x5396d6(0x167)](exports,a24_0x5396d6(0x157),{'value':!![]}),exports[a24_0x5396d6(0x169)]=exports[a24_0x5396d6(0x14f)]=exports[a24_0x5396d6(0x15a)]=exports[a24_0x5396d6(0x154)]=void 0x0;const jsonwebtoken_1=__importDefault(require('jsonwebtoken')),config_1=require(a24_0x5396d6(0x163)),tokenBlacklistService_1=require('../services/tokenBlacklistService'),authenticateToken=(_0x53ad24,_0x5df102,_0x446e53)=>{const _0x2d3e46=a24_0x5396d6,_0x1aa364=_0x53ad24[_0x2d3e46(0x152)][_0x2d3e46(0x16c)],_0x5c617c=_0x1aa364&&_0x1aa364[_0x2d3e46(0x162)]('\x20')[0x1];if(!_0x5c617c)return _0x5df102[_0x2d3e46(0x147)](0x191)['json']({'success':![],'message':_0x2d3e46(0x148)});if(tokenBlacklistService_1[_0x2d3e46(0x153)][_0x2d3e46(0x161)](_0x5c617c))return _0x5df102[_0x2d3e46(0x147)](0x191)['json']({'success':![],'message':_0x2d3e46(0x16d)});jsonwebtoken_1['default'][_0x2d3e46(0x16a)](_0x5c617c,config_1[_0x2d3e46(0x15e)][_0x2d3e46(0x146)][_0x2d3e46(0x15d)],(_0x11fd06,_0x186b28)=>{const _0x36d0b4=_0x2d3e46;if(_0x11fd06)return _0x5df102['status'](0x193)['json']({'success':![],'message':_0x36d0b4(0x15c)});_0x53ad24[_0x36d0b4(0x15b)]=_0x186b28,_0x53ad24[_0x36d0b4(0x149)]=_0x5c617c,_0x446e53();});};exports[a24_0x5396d6(0x154)]=authenticateToken;const requireAdmin=(_0x3db6dc,_0x32474f,_0x292b17)=>{const _0x52be41=a24_0x5396d6;if(!_0x3db6dc[_0x52be41(0x15b)]||_0x3db6dc[_0x52be41(0x15b)]['role']!=='admin')return _0x32474f[_0x52be41(0x147)](0x193)[_0x52be41(0x16b)]({'success':![],'message':'Admin\x20access\x20required'});_0x292b17();};exports[a24_0x5396d6(0x15a)]=requireAdmin;const requireShop=(_0x1c75bb,_0x2a0cdd,_0x487484)=>{const _0x4223a1=a24_0x5396d6;if(!_0x1c75bb[_0x4223a1(0x15b)]||_0x1c75bb['user'][_0x4223a1(0x164)]!=='shop')return _0x2a0cdd[_0x4223a1(0x147)](0x193)[_0x4223a1(0x16b)]({'success':![],'message':_0x4223a1(0x156)});_0x487484();};exports['requireShop']=requireShop;function a24_0x55f0(_0x540b53,_0x4e7bee){_0x540b53=_0x540b53-0x144;const _0x1a13ae=a24_0x1a13();let _0x55f048=_0x1a13ae[_0x540b53];return _0x55f048;}const requireActiveShop=async(_0x33f21b,_0x16b5a1,_0x5bdc9c)=>{const _0x516771=a24_0x5396d6;if(!_0x33f21b[_0x516771(0x15b)]||_0x33f21b[_0x516771(0x15b)]['role']!==_0x516771(0x14b))return _0x16b5a1[_0x516771(0x147)](0x193)[_0x516771(0x16b)]({'success':![],'message':_0x516771(0x156)});try{const _0x56407a=require(_0x516771(0x158))['default'],_0x3f815e=await _0x56407a['shop']['findUnique']({'where':{'id':_0x33f21b[_0x516771(0x15b)]['id']},'select':{'status':!![]}});if(!_0x3f815e||_0x3f815e[_0x516771(0x147)]!==_0x516771(0x168))return _0x16b5a1[_0x516771(0x147)](0x193)['json']({'success':![],'message':_0x516771(0x145),'suspended':_0x3f815e?.[_0x516771(0x147)]===_0x516771(0x14e)});_0x5bdc9c();}catch(_0x537520){return console['error'](_0x516771(0x15f),_0x537520),_0x16b5a1[_0x516771(0x147)](0x1f4)['json']({'success':![],'message':_0x516771(0x14a)});}};exports[a24_0x5396d6(0x169)]=requireActiveShop;