'use strict';const a16_0x49260e=a16_0x54be;function a16_0x3a25(){const _0x1e944a=['827487ioGMHd','Token\x20has\x20been\x20revoked','headers','609804TUJZav','token','authenticateToken','80xGltrL','status','config','81474gYQvZy','json','__importDefault','secret','2AbKtQJ','Admin\x20access\x20required','jsonwebtoken','user','Access\x20token\x20required','261480wdtPyK','requireAdmin','2169420NERzrG','requireShop','isTokenBlacklisted','__esModule','jwt','387734wPqnwK','default','role','8cjIELV','Invalid\x20or\x20expired\x20token','verify','2877252TLrucE','../config/config','tokenBlacklistService'];a16_0x3a25=function(){return _0x1e944a;};return a16_0x3a25();}(function(_0x38fe9b,_0x33bbd6){const _0x46672f=a16_0x54be,_0x53ebb5=_0x38fe9b();while(!![]){try{const _0x68ac66=parseInt(_0x46672f(0xe2))/0x1*(parseInt(_0x46672f(0xee))/0x2)+parseInt(_0x46672f(0xe7))/0x3+-parseInt(_0x46672f(0xfa))/0x4+-parseInt(_0x46672f(0xfd))/0x5*(-parseInt(_0x46672f(0xde))/0x6)+-parseInt(_0x46672f(0xf4))/0x7+-parseInt(_0x46672f(0xf1))/0x8*(parseInt(_0x46672f(0xf7))/0x9)+parseInt(_0x46672f(0xe9))/0xa;if(_0x68ac66===_0x33bbd6)break;else _0x53ebb5['push'](_0x53ebb5['shift']());}catch(_0x577df2){_0x53ebb5['push'](_0x53ebb5['shift']());}}}(a16_0x3a25,0x3dee6));var __importDefault=this&&this[a16_0x49260e(0xe0)]||function(_0x465db3){const _0xf0a816=a16_0x49260e;return _0x465db3&&_0x465db3[_0xf0a816(0xec)]?_0x465db3:{'default':_0x465db3};};Object['defineProperty'](exports,a16_0x49260e(0xec),{'value':!![]}),exports[a16_0x49260e(0xea)]=exports[a16_0x49260e(0xe8)]=exports[a16_0x49260e(0xfc)]=void 0x0;const jsonwebtoken_1=__importDefault(require(a16_0x49260e(0xe4))),config_1=require(a16_0x49260e(0xf5)),tokenBlacklistService_1=require('../services/tokenBlacklistService'),authenticateToken=(_0xb6e6ba,_0x3eb9ac,_0xcd812)=>{const _0x122ee8=a16_0x49260e,_0x273073=_0xb6e6ba[_0x122ee8(0xf9)]['authorization'],_0x4cf502=_0x273073&&_0x273073['split']('\x20')[0x1];if(!_0x4cf502)return _0x3eb9ac[_0x122ee8(0xfe)](0x191)['json']({'success':![],'message':_0x122ee8(0xe6)});if(tokenBlacklistService_1[_0x122ee8(0xf6)][_0x122ee8(0xeb)](_0x4cf502))return _0x3eb9ac['status'](0x191)[_0x122ee8(0xdf)]({'success':![],'message':_0x122ee8(0xf8)});jsonwebtoken_1[_0x122ee8(0xef)][_0x122ee8(0xf3)](_0x4cf502,config_1[_0x122ee8(0xdd)][_0x122ee8(0xed)][_0x122ee8(0xe1)],(_0x45b764,_0x147c44)=>{const _0x23bd0d=_0x122ee8;if(_0x45b764)return _0x3eb9ac['status'](0x193)[_0x23bd0d(0xdf)]({'success':![],'message':_0x23bd0d(0xf2)});_0xb6e6ba[_0x23bd0d(0xe5)]=_0x147c44,_0xb6e6ba[_0x23bd0d(0xfb)]=_0x4cf502,_0xcd812();});};function a16_0x54be(_0x577147,_0x487e8f){const _0x3a2575=a16_0x3a25();return a16_0x54be=function(_0x54bebd,_0xe1eafe){_0x54bebd=_0x54bebd-0xdd;let _0x498320=_0x3a2575[_0x54bebd];return _0x498320;},a16_0x54be(_0x577147,_0x487e8f);}exports[a16_0x49260e(0xfc)]=authenticateToken;const requireAdmin=(_0x274a8a,_0x254096,_0x418654)=>{const _0x96840a=a16_0x49260e;if(!_0x274a8a[_0x96840a(0xe5)]||_0x274a8a[_0x96840a(0xe5)]['role']!=='admin')return _0x254096[_0x96840a(0xfe)](0x193)['json']({'success':![],'message':_0x96840a(0xe3)});_0x418654();};exports[a16_0x49260e(0xe8)]=requireAdmin;const requireShop=(_0x42ba5f,_0x4ae836,_0x25500d)=>{const _0x3e547c=a16_0x49260e;if(!_0x42ba5f[_0x3e547c(0xe5)]||_0x42ba5f[_0x3e547c(0xe5)][_0x3e547c(0xf0)]!=='shop')return _0x4ae836[_0x3e547c(0xfe)](0x193)[_0x3e547c(0xdf)]({'success':![],'message':'Shop\x20access\x20required'});_0x25500d();};exports['requireShop']=requireShop;