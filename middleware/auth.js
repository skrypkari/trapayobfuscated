'use strict';const a16_0x5d2ccc=a16_0x5d91;(function(_0x501610,_0x29827a){const _0x165cb2=a16_0x5d91,_0x4e6523=_0x501610();while(!![]){try{const _0x1b8694=parseInt(_0x165cb2(0xb5))/0x1*(-parseInt(_0x165cb2(0xb9))/0x2)+-parseInt(_0x165cb2(0xcb))/0x3+-parseInt(_0x165cb2(0xa9))/0x4*(-parseInt(_0x165cb2(0xd2))/0x5)+-parseInt(_0x165cb2(0xad))/0x6+-parseInt(_0x165cb2(0xae))/0x7*(-parseInt(_0x165cb2(0xb7))/0x8)+-parseInt(_0x165cb2(0xaa))/0x9*(-parseInt(_0x165cb2(0xb8))/0xa)+-parseInt(_0x165cb2(0xbe))/0xb*(-parseInt(_0x165cb2(0xb1))/0xc);if(_0x1b8694===_0x29827a)break;else _0x4e6523['push'](_0x4e6523['shift']());}catch(_0x43b328){_0x4e6523['push'](_0x4e6523['shift']());}}}(a16_0x50ae,0x5d6d2));var __importDefault=this&&this[a16_0x5d2ccc(0xac)]||function(_0x13533a){const _0x33c490=a16_0x5d2ccc;return _0x13533a&&_0x13533a[_0x33c490(0xbf)]?_0x13533a:{'default':_0x13533a};};function a16_0x5d91(_0x5b7b4d,_0x1d354b){const _0x50aea8=a16_0x50ae();return a16_0x5d91=function(_0x5d9146,_0x578595){_0x5d9146=_0x5d9146-0xa9;let _0x2bf15b=_0x50aea8[_0x5d9146];return _0x2bf15b;},a16_0x5d91(_0x5b7b4d,_0x1d354b);}Object['defineProperty'](exports,a16_0x5d2ccc(0xbf),{'value':!![]}),exports['requireActiveShop']=exports[a16_0x5d2ccc(0xb3)]=exports[a16_0x5d2ccc(0xc5)]=exports[a16_0x5d2ccc(0xb6)]=void 0x0;const jsonwebtoken_1=__importDefault(require(a16_0x5d2ccc(0xce))),config_1=require(a16_0x5d2ccc(0xab)),tokenBlacklistService_1=require('../services/tokenBlacklistService'),authenticateToken=(_0x68a1a9,_0x27efb0,_0x3e5323)=>{const _0x30298a=a16_0x5d2ccc,_0xf61c62=_0x68a1a9[_0x30298a(0xbc)]['authorization'],_0x571969=_0xf61c62&&_0xf61c62[_0x30298a(0xbd)]('\x20')[0x1];if(!_0x571969)return _0x27efb0[_0x30298a(0xb0)](0x191)[_0x30298a(0xcd)]({'success':![],'message':_0x30298a(0xd0)});if(tokenBlacklistService_1['tokenBlacklistService'][_0x30298a(0xb2)](_0x571969))return _0x27efb0[_0x30298a(0xb0)](0x191)[_0x30298a(0xcd)]({'success':![],'message':_0x30298a(0xcf)});jsonwebtoken_1[_0x30298a(0xc0)]['verify'](_0x571969,config_1[_0x30298a(0xc8)]['jwt'][_0x30298a(0xbb)],(_0x1240ca,_0x403c06)=>{const _0x86b048=_0x30298a;if(_0x1240ca)return _0x27efb0['status'](0x193)[_0x86b048(0xcd)]({'success':![],'message':_0x86b048(0xc1)});_0x68a1a9[_0x86b048(0xaf)]=_0x403c06,_0x68a1a9[_0x86b048(0xba)]=_0x571969,_0x3e5323();});};exports[a16_0x5d2ccc(0xb6)]=authenticateToken;function a16_0x50ae(){const _0x117810=['isTokenBlacklisted','requireShop','ACTIVE','2913cHRWLd','authenticateToken','8iacmpT','190GVcjvT','100vlJRdp','token','secret','headers','split','33XweVYD','__esModule','default','Invalid\x20or\x20expired\x20token','Admin\x20access\x20required','admin','error','requireAdmin','findUnique','Shop\x20access\x20required','config','Error\x20checking\x20account\x20status:','role','1455654mfiBog','../config/database','json','jsonwebtoken','Token\x20has\x20been\x20revoked','Access\x20token\x20required','Account\x20is\x20suspended\x20or\x20inactive.\x20Contact\x20administrator\x20to\x20activate\x20your\x20account.','59065IHyjxR','168DsFjsq','101826KZgjZR','../config/config','__importDefault','837966QvYNPq','2075654mioYGr','user','status','582276YWJbxq'];a16_0x50ae=function(){return _0x117810;};return a16_0x50ae();}const requireAdmin=(_0x21d77c,_0x3baecb,_0x56b950)=>{const _0x227c15=a16_0x5d2ccc;if(!_0x21d77c[_0x227c15(0xaf)]||_0x21d77c[_0x227c15(0xaf)][_0x227c15(0xca)]!==_0x227c15(0xc3))return _0x3baecb[_0x227c15(0xb0)](0x193)[_0x227c15(0xcd)]({'success':![],'message':_0x227c15(0xc2)});_0x56b950();};exports[a16_0x5d2ccc(0xc5)]=requireAdmin;const requireShop=(_0x4acaa3,_0x50d34d,_0x4bc6e5)=>{const _0x34fe0b=a16_0x5d2ccc;if(!_0x4acaa3[_0x34fe0b(0xaf)]||_0x4acaa3[_0x34fe0b(0xaf)][_0x34fe0b(0xca)]!=='shop')return _0x50d34d[_0x34fe0b(0xb0)](0x193)[_0x34fe0b(0xcd)]({'success':![],'message':'Shop\x20access\x20required'});_0x4bc6e5();};exports[a16_0x5d2ccc(0xb3)]=requireShop;const requireActiveShop=async(_0x340528,_0x4bf942,_0xfdd1cc)=>{const _0x3e6c95=a16_0x5d2ccc;if(!_0x340528['user']||_0x340528[_0x3e6c95(0xaf)][_0x3e6c95(0xca)]!=='shop')return _0x4bf942['status'](0x193)[_0x3e6c95(0xcd)]({'success':![],'message':_0x3e6c95(0xc7)});try{const _0x182821=require(_0x3e6c95(0xcc))[_0x3e6c95(0xc0)],_0x52e43e=await _0x182821['shop'][_0x3e6c95(0xc6)]({'where':{'id':_0x340528[_0x3e6c95(0xaf)]['id']},'select':{'status':!![]}});if(!_0x52e43e||_0x52e43e[_0x3e6c95(0xb0)]!==_0x3e6c95(0xb4))return _0x4bf942[_0x3e6c95(0xb0)](0x193)['json']({'success':![],'message':_0x3e6c95(0xd1),'suspended':_0x52e43e?.[_0x3e6c95(0xb0)]==='SUSPENDED'});_0xfdd1cc();}catch(_0x38d95b){return console[_0x3e6c95(0xc4)](_0x3e6c95(0xc9),_0x38d95b),_0x4bf942['status'](0x1f4)[_0x3e6c95(0xcd)]({'success':![],'message':'Error\x20checking\x20account\x20status'});}};exports['requireActiveShop']=requireActiveShop;