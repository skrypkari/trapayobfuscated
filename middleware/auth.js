'use strict';const a16_0x132910=a16_0x5ac5;(function(_0x1ae89c,_0x4ef7c0){const _0x1e1323=a16_0x5ac5,_0x4ab3a0=_0x1ae89c();while(!![]){try{const _0x17645d=-parseInt(_0x1e1323(0x1b2))/0x1*(-parseInt(_0x1e1323(0x1a9))/0x2)+parseInt(_0x1e1323(0x198))/0x3*(parseInt(_0x1e1323(0x1b7))/0x4)+-parseInt(_0x1e1323(0x1ae))/0x5+parseInt(_0x1e1323(0x1b0))/0x6+parseInt(_0x1e1323(0x1a8))/0x7+-parseInt(_0x1e1323(0x1b6))/0x8*(parseInt(_0x1e1323(0x1b5))/0x9)+parseInt(_0x1e1323(0x196))/0xa*(-parseInt(_0x1e1323(0x195))/0xb);if(_0x17645d===_0x4ef7c0)break;else _0x4ab3a0['push'](_0x4ab3a0['shift']());}catch(_0x35cf9){_0x4ab3a0['push'](_0x4ab3a0['shift']());}}}(a16_0x2bcc,0x8e80e));var __importDefault=this&&this[a16_0x132910(0x1a5)]||function(_0x427a33){const _0x419d68=a16_0x132910;return _0x427a33&&_0x427a33[_0x419d68(0x1a7)]?_0x427a33:{'default':_0x427a33};};function a16_0x2bcc(){const _0x3529d3=['Error\x20checking\x20account\x20status:','config','../config/config','tokenBlacklistService','67690CvrJpt','Error\x20checking\x20account\x20status','4360734QjahoZ','authorization','106954nTbjhI','user','defineProperty','63dRcIUk','558568fHbtqb','14960gpKeRf','default','ACTIVE','secret','split','findUnique','status','admin','11WyLzPE','17489070MMEFIp','jsonwebtoken','147mTAYAa','json','../config/database','requireAdmin','../services/tokenBlacklistService','token','Shop\x20access\x20required','role','authenticateToken','shop','Admin\x20access\x20required','Account\x20is\x20suspended\x20or\x20inactive.\x20Contact\x20administrator\x20to\x20activate\x20your\x20account.','requireActiveShop','__importDefault','isTokenBlacklisted','__esModule','5987079DEVAmg','20zbBDdu'];a16_0x2bcc=function(){return _0x3529d3;};return a16_0x2bcc();}Object[a16_0x132910(0x1b4)](exports,a16_0x132910(0x1a7),{'value':!![]}),exports['requireActiveShop']=exports['requireShop']=exports['requireAdmin']=exports[a16_0x132910(0x1a0)]=void 0x0;function a16_0x5ac5(_0x45c99d,_0x364f36){const _0x2bccae=a16_0x2bcc();return a16_0x5ac5=function(_0x5ac54,_0x237844){_0x5ac54=_0x5ac54-0x192;let _0x1b3b37=_0x2bccae[_0x5ac54];return _0x1b3b37;},a16_0x5ac5(_0x45c99d,_0x364f36);}const jsonwebtoken_1=__importDefault(require(a16_0x132910(0x197))),config_1=require(a16_0x132910(0x1ac)),tokenBlacklistService_1=require(a16_0x132910(0x19c)),authenticateToken=(_0x16bd21,_0x2db63d,_0x523287)=>{const _0x13f931=a16_0x132910,_0x43bc23=_0x16bd21['headers'][_0x13f931(0x1b1)],_0x57495d=_0x43bc23&&_0x43bc23[_0x13f931(0x1bb)]('\x20')[0x1];if(!_0x57495d)return _0x2db63d[_0x13f931(0x193)](0x191)[_0x13f931(0x199)]({'success':![],'message':'Access\x20token\x20required'});if(tokenBlacklistService_1[_0x13f931(0x1ad)][_0x13f931(0x1a6)](_0x57495d))return _0x2db63d[_0x13f931(0x193)](0x191)['json']({'success':![],'message':'Token\x20has\x20been\x20revoked'});jsonwebtoken_1[_0x13f931(0x1b8)]['verify'](_0x57495d,config_1[_0x13f931(0x1ab)]['jwt'][_0x13f931(0x1ba)],(_0xb1f2cc,_0x2ef30e)=>{const _0x4fba77=_0x13f931;if(_0xb1f2cc)return _0x2db63d[_0x4fba77(0x193)](0x193)[_0x4fba77(0x199)]({'success':![],'message':'Invalid\x20or\x20expired\x20token'});_0x16bd21[_0x4fba77(0x1b3)]=_0x2ef30e,_0x16bd21[_0x4fba77(0x19d)]=_0x57495d,_0x523287();});};exports['authenticateToken']=authenticateToken;const requireAdmin=(_0x5057b2,_0x5ed4d3,_0x6ffd84)=>{const _0x41a034=a16_0x132910;if(!_0x5057b2[_0x41a034(0x1b3)]||_0x5057b2['user'][_0x41a034(0x19f)]!==_0x41a034(0x194))return _0x5ed4d3[_0x41a034(0x193)](0x193)['json']({'success':![],'message':_0x41a034(0x1a2)});_0x6ffd84();};exports[a16_0x132910(0x19b)]=requireAdmin;const requireShop=(_0x154732,_0x32063f,_0x1346fe)=>{const _0x33673f=a16_0x132910;if(!_0x154732[_0x33673f(0x1b3)]||_0x154732[_0x33673f(0x1b3)][_0x33673f(0x19f)]!=='shop')return _0x32063f[_0x33673f(0x193)](0x193)[_0x33673f(0x199)]({'success':![],'message':_0x33673f(0x19e)});_0x1346fe();};exports['requireShop']=requireShop;const requireActiveShop=async(_0x3bacbf,_0x2eed4a,_0x3db586)=>{const _0xda4d59=a16_0x132910;if(!_0x3bacbf[_0xda4d59(0x1b3)]||_0x3bacbf[_0xda4d59(0x1b3)]['role']!==_0xda4d59(0x1a1))return _0x2eed4a[_0xda4d59(0x193)](0x193)[_0xda4d59(0x199)]({'success':![],'message':_0xda4d59(0x19e)});try{const _0x48acce=require(_0xda4d59(0x19a))[_0xda4d59(0x1b8)],_0x84c4b1=await _0x48acce['shop'][_0xda4d59(0x192)]({'where':{'id':_0x3bacbf[_0xda4d59(0x1b3)]['id']},'select':{'status':!![]}});if(!_0x84c4b1||_0x84c4b1['status']!==_0xda4d59(0x1b9))return _0x2eed4a[_0xda4d59(0x193)](0x193)[_0xda4d59(0x199)]({'success':![],'message':_0xda4d59(0x1a3),'suspended':_0x84c4b1?.['status']==='SUSPENDED'});_0x3db586();}catch(_0x11708d){return console['error'](_0xda4d59(0x1aa),_0x11708d),_0x2eed4a['status'](0x1f4)[_0xda4d59(0x199)]({'success':![],'message':_0xda4d59(0x1af)});}};exports[a16_0x132910(0x1a4)]=requireActiveShop;