'use strict';const a17_0x14c30c=a17_0x3798;(function(_0x1cf532,_0xb5ef39){const _0x4a83e2=a17_0x3798,_0x99ed1c=_0x1cf532();while(!![]){try{const _0x1222bd=parseInt(_0x4a83e2(0xda))/0x1+parseInt(_0x4a83e2(0xdc))/0x2*(-parseInt(_0x4a83e2(0xee))/0x3)+-parseInt(_0x4a83e2(0xd1))/0x4+parseInt(_0x4a83e2(0xcd))/0x5*(parseInt(_0x4a83e2(0xd3))/0x6)+-parseInt(_0x4a83e2(0xd7))/0x7*(parseInt(_0x4a83e2(0xd9))/0x8)+parseInt(_0x4a83e2(0xe8))/0x9+parseInt(_0x4a83e2(0xec))/0xa*(parseInt(_0x4a83e2(0xce))/0xb);if(_0x1222bd===_0xb5ef39)break;else _0x99ed1c['push'](_0x99ed1c['shift']());}catch(_0x225620){_0x99ed1c['push'](_0x99ed1c['shift']());}}}(a17_0x32e7,0x81fa6));function a17_0x32e7(){const _0x342c9e=['shop','json','token','ACTIVE','user','headers','Shop\x20access\x20required','tokenBlacklistService','../config/config','9285642sanURf','requireShop','Error\x20checking\x20account\x20status','Access\x20token\x20required','10DlRjVH','default','3CDLiuX','requireAdmin','defineProperty','jwt','../services/tokenBlacklistService','config','secret','__esModule','authenticateToken','25swKLxc','1020987ESRjUr','status','Admin\x20access\x20required','1184580EpJsNx','authorization','1251078HWoaVu','../config/database','admin','requireActiveShop','763hKXNYA','__importDefault','46584NAToak','205567EVanmQ','Error\x20checking\x20account\x20status:','1818890CEljij','role','split'];a17_0x32e7=function(){return _0x342c9e;};return a17_0x32e7();}var __importDefault=this&&this[a17_0x14c30c(0xd8)]||function(_0x3c3541){const _0x1b14bd=a17_0x14c30c;return _0x3c3541&&_0x3c3541[_0x1b14bd(0xf5)]?_0x3c3541:{'default':_0x3c3541};};Object[a17_0x14c30c(0xf0)](exports,a17_0x14c30c(0xf5),{'value':!![]}),exports[a17_0x14c30c(0xd6)]=exports[a17_0x14c30c(0xe9)]=exports['requireAdmin']=exports['authenticateToken']=void 0x0;const jsonwebtoken_1=__importDefault(require('jsonwebtoken')),config_1=require(a17_0x14c30c(0xe7)),tokenBlacklistService_1=require(a17_0x14c30c(0xf2)),authenticateToken=(_0x38cb49,_0x58f4c4,_0x4aadf4)=>{const _0x40e33=a17_0x14c30c,_0x2dc2aa=_0x38cb49[_0x40e33(0xe4)][_0x40e33(0xd2)],_0x1cb586=_0x2dc2aa&&_0x2dc2aa[_0x40e33(0xde)]('\x20')[0x1];if(!_0x1cb586)return _0x58f4c4[_0x40e33(0xcf)](0x191)[_0x40e33(0xe0)]({'success':![],'message':_0x40e33(0xeb)});if(tokenBlacklistService_1[_0x40e33(0xe6)]['isTokenBlacklisted'](_0x1cb586))return _0x58f4c4[_0x40e33(0xcf)](0x191)[_0x40e33(0xe0)]({'success':![],'message':'Token\x20has\x20been\x20revoked'});jsonwebtoken_1[_0x40e33(0xed)]['verify'](_0x1cb586,config_1[_0x40e33(0xf3)][_0x40e33(0xf1)][_0x40e33(0xf4)],(_0x18f8c5,_0x9631aa)=>{const _0x34cb9a=_0x40e33;if(_0x18f8c5)return _0x58f4c4['status'](0x193)[_0x34cb9a(0xe0)]({'success':![],'message':'Invalid\x20or\x20expired\x20token'});_0x38cb49['user']=_0x9631aa,_0x38cb49[_0x34cb9a(0xe1)]=_0x1cb586,_0x4aadf4();});};exports[a17_0x14c30c(0xcc)]=authenticateToken;const requireAdmin=(_0x4261f6,_0x1c7684,_0x478278)=>{const _0x29b20b=a17_0x14c30c;if(!_0x4261f6[_0x29b20b(0xe3)]||_0x4261f6[_0x29b20b(0xe3)]['role']!==_0x29b20b(0xd5))return _0x1c7684[_0x29b20b(0xcf)](0x193)[_0x29b20b(0xe0)]({'success':![],'message':_0x29b20b(0xd0)});_0x478278();};exports[a17_0x14c30c(0xef)]=requireAdmin;const requireShop=(_0x38d0d6,_0x7358be,_0x46dcc6)=>{const _0x1970d8=a17_0x14c30c;if(!_0x38d0d6[_0x1970d8(0xe3)]||_0x38d0d6[_0x1970d8(0xe3)][_0x1970d8(0xdd)]!==_0x1970d8(0xdf))return _0x7358be['status'](0x193)[_0x1970d8(0xe0)]({'success':![],'message':'Shop\x20access\x20required'});_0x46dcc6();};function a17_0x3798(_0x4166a0,_0x3561c8){const _0x32e71e=a17_0x32e7();return a17_0x3798=function(_0x379875,_0xd48d3){_0x379875=_0x379875-0xcc;let _0x4df324=_0x32e71e[_0x379875];return _0x4df324;},a17_0x3798(_0x4166a0,_0x3561c8);}exports[a17_0x14c30c(0xe9)]=requireShop;const requireActiveShop=async(_0x273fe6,_0x327ade,_0xa8ce21)=>{const _0x3b3296=a17_0x14c30c;if(!_0x273fe6[_0x3b3296(0xe3)]||_0x273fe6[_0x3b3296(0xe3)][_0x3b3296(0xdd)]!=='shop')return _0x327ade[_0x3b3296(0xcf)](0x193)['json']({'success':![],'message':_0x3b3296(0xe5)});try{const _0x101502=require(_0x3b3296(0xd4))[_0x3b3296(0xed)],_0x1a0f55=await _0x101502['shop']['findUnique']({'where':{'id':_0x273fe6[_0x3b3296(0xe3)]['id']},'select':{'status':!![]}});if(!_0x1a0f55||_0x1a0f55[_0x3b3296(0xcf)]!==_0x3b3296(0xe2))return _0x327ade['status'](0x193)[_0x3b3296(0xe0)]({'success':![],'message':'Account\x20is\x20suspended\x20or\x20inactive.\x20Contact\x20administrator\x20to\x20activate\x20your\x20account.','suspended':_0x1a0f55?.[_0x3b3296(0xcf)]==='SUSPENDED'});_0xa8ce21();}catch(_0x2ad8fa){return console['error'](_0x3b3296(0xdb),_0x2ad8fa),_0x327ade[_0x3b3296(0xcf)](0x1f4)[_0x3b3296(0xe0)]({'success':![],'message':_0x3b3296(0xea)});}};exports[a17_0x14c30c(0xd6)]=requireActiveShop;