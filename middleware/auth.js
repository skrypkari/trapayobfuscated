'use strict';const a16_0x2eed8d=a16_0x1e70;(function(_0x402017,_0x23be1c){const _0x217e7d=a16_0x1e70,_0x19c35e=_0x402017();while(!![]){try{const _0x418040=-parseInt(_0x217e7d(0xe4))/0x1+-parseInt(_0x217e7d(0xec))/0x2*(parseInt(_0x217e7d(0xd6))/0x3)+-parseInt(_0x217e7d(0xce))/0x4+-parseInt(_0x217e7d(0xed))/0x5+parseInt(_0x217e7d(0xe0))/0x6*(-parseInt(_0x217e7d(0xcd))/0x7)+-parseInt(_0x217e7d(0xc8))/0x8*(-parseInt(_0x217e7d(0xef))/0x9)+parseInt(_0x217e7d(0xda))/0xa;if(_0x418040===_0x23be1c)break;else _0x19c35e['push'](_0x19c35e['shift']());}catch(_0x4912dd){_0x19c35e['push'](_0x19c35e['shift']());}}}(a16_0x2f06,0x77e11));var __importDefault=this&&this['__importDefault']||function(_0x3b32d6){const _0x1e516f=a16_0x1e70;return _0x3b32d6&&_0x3b32d6[_0x1e516f(0xe2)]?_0x3b32d6:{'default':_0x3b32d6};};function a16_0x1e70(_0x33a05a,_0x3232b0){const _0x2f065d=a16_0x2f06();return a16_0x1e70=function(_0x1e7015,_0x526f2d){_0x1e7015=_0x1e7015-0xc8;let _0x19247a=_0x2f065d[_0x1e7015];return _0x19247a;},a16_0x1e70(_0x33a05a,_0x3232b0);}Object[a16_0x2eed8d(0xcf)](exports,a16_0x2eed8d(0xe2),{'value':!![]}),exports[a16_0x2eed8d(0xd7)]=exports['requireShop']=exports['requireAdmin']=exports['authenticateToken']=void 0x0;function a16_0x2f06(){const _0xdf554f=['isTokenBlacklisted','Shop\x20access\x20required','requireShop','split','json','$disconnect','Error\x20checking\x20account\x20status','1868824eitcuX','2651660FtqORf','headers','1486539raxZiO','../services/tokenBlacklistService','8IbXkkQ','jsonwebtoken','Invalid\x20or\x20expired\x20token','jwt','secret','518JAzuRT','1835884QNOVPD','defineProperty','ACTIVE','authenticateToken','status','@prisma/client','Account\x20is\x20suspended\x20or\x20inactive.\x20Contact\x20administrator\x20to\x20activate\x20your\x20account.','role','3SXYKZh','requireActiveShop','SUSPENDED','findUnique','27242260ZCxfOj','shop','tokenBlacklistService','default','Access\x20token\x20required','Admin\x20access\x20required','19590DhntyO','config','__esModule','user','233047pBhavN'];a16_0x2f06=function(){return _0xdf554f;};return a16_0x2f06();}const jsonwebtoken_1=__importDefault(require(a16_0x2eed8d(0xc9))),config_1=require('../config/config'),tokenBlacklistService_1=require(a16_0x2eed8d(0xf0)),authenticateToken=(_0x5a66da,_0x2d4df3,_0xf3775e)=>{const _0x49e208=a16_0x2eed8d,_0x32bb04=_0x5a66da[_0x49e208(0xee)]['authorization'],_0x4ce705=_0x32bb04&&_0x32bb04[_0x49e208(0xe8)]('\x20')[0x1];if(!_0x4ce705)return _0x2d4df3[_0x49e208(0xd2)](0x191)['json']({'success':![],'message':_0x49e208(0xde)});if(tokenBlacklistService_1[_0x49e208(0xdc)][_0x49e208(0xe5)](_0x4ce705))return _0x2d4df3['status'](0x191)[_0x49e208(0xe9)]({'success':![],'message':'Token\x20has\x20been\x20revoked'});jsonwebtoken_1[_0x49e208(0xdd)]['verify'](_0x4ce705,config_1[_0x49e208(0xe1)][_0x49e208(0xcb)][_0x49e208(0xcc)],(_0x1a9f9d,_0x51fc1e)=>{const _0x58e4fe=_0x49e208;if(_0x1a9f9d)return _0x2d4df3[_0x58e4fe(0xd2)](0x193)[_0x58e4fe(0xe9)]({'success':![],'message':_0x58e4fe(0xca)});_0x5a66da[_0x58e4fe(0xe3)]=_0x51fc1e,_0x5a66da['token']=_0x4ce705,_0xf3775e();});};exports[a16_0x2eed8d(0xd1)]=authenticateToken;const requireAdmin=(_0x52a5c7,_0x591a24,_0x3cc95c)=>{const _0x4cb28a=a16_0x2eed8d;if(!_0x52a5c7[_0x4cb28a(0xe3)]||_0x52a5c7[_0x4cb28a(0xe3)][_0x4cb28a(0xd5)]!=='admin')return _0x591a24[_0x4cb28a(0xd2)](0x193)['json']({'success':![],'message':_0x4cb28a(0xdf)});_0x3cc95c();};exports['requireAdmin']=requireAdmin;const requireShop=(_0x1805e1,_0x565fb0,_0x4296db)=>{const _0x4985cd=a16_0x2eed8d;if(!_0x1805e1['user']||_0x1805e1['user'][_0x4985cd(0xd5)]!==_0x4985cd(0xdb))return _0x565fb0[_0x4985cd(0xd2)](0x193)['json']({'success':![],'message':_0x4985cd(0xe6)});_0x4296db();};exports[a16_0x2eed8d(0xe7)]=requireShop;const requireActiveShop=async(_0x4b090d,_0x5184fc,_0x4386f9)=>{const _0x281ce6=a16_0x2eed8d;if(!_0x4b090d[_0x281ce6(0xe3)]||_0x4b090d['user'][_0x281ce6(0xd5)]!==_0x281ce6(0xdb))return _0x5184fc[_0x281ce6(0xd2)](0x193)['json']({'success':![],'message':_0x281ce6(0xe6)});try{const {PrismaClient:_0x1b1f0a}=require(_0x281ce6(0xd3)),_0x28decf=new _0x1b1f0a(),_0x5586a1=await _0x28decf[_0x281ce6(0xdb)][_0x281ce6(0xd9)]({'where':{'id':_0x4b090d[_0x281ce6(0xe3)]['id']},'select':{'status':!![]}});if(!_0x5586a1||_0x5586a1[_0x281ce6(0xd2)]!==_0x281ce6(0xd0))return _0x5184fc[_0x281ce6(0xd2)](0x193)[_0x281ce6(0xe9)]({'success':![],'message':_0x281ce6(0xd4),'suspended':_0x5586a1?.['status']===_0x281ce6(0xd8)});await _0x28decf[_0x281ce6(0xea)](),_0x4386f9();}catch(_0x457ee7){return _0x5184fc[_0x281ce6(0xd2)](0x1f4)[_0x281ce6(0xe9)]({'success':![],'message':_0x281ce6(0xeb)});}};exports[a16_0x2eed8d(0xd7)]=requireActiveShop;