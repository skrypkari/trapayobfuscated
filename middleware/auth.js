'use strict';const a18_0x5ada50=a18_0x2c65;(function(_0x35bc5f,_0x52283a){const _0x181ed8=a18_0x2c65,_0x1be40c=_0x35bc5f();while(!![]){try{const _0x39702b=-parseInt(_0x181ed8(0xa5))/0x1+-parseInt(_0x181ed8(0xa0))/0x2*(-parseInt(_0x181ed8(0xa9))/0x3)+parseInt(_0x181ed8(0xc8))/0x4+parseInt(_0x181ed8(0xbb))/0x5*(parseInt(_0x181ed8(0xb3))/0x6)+-parseInt(_0x181ed8(0xc5))/0x7*(-parseInt(_0x181ed8(0xc1))/0x8)+-parseInt(_0x181ed8(0x9f))/0x9+-parseInt(_0x181ed8(0xb9))/0xa;if(_0x39702b===_0x52283a)break;else _0x1be40c['push'](_0x1be40c['shift']());}catch(_0x4e3d0a){_0x1be40c['push'](_0x1be40c['shift']());}}}(a18_0x419e,0xc7dd2));function a18_0x419e(){const _0x371fd0=['headers','Token\x20has\x20been\x20revoked','requireShop','SUSPENDED','shop','2414418hdrXxP','__esModule','ACTIVE','token','Account\x20is\x20suspended\x20or\x20inactive.\x20Contact\x20administrator\x20to\x20activate\x20your\x20account.','json','19857140IkiURn','authenticateToken','10wmJAcj','authorization','requireActiveShop','Shop\x20access\x20required','status','Admin\x20access\x20required','56rBaJKl','defineProperty','Error\x20checking\x20account\x20status','admin','1145403GnETnO','verify','jsonwebtoken','4994160YUtOZj','user','split','tokenBlacklistService','14720517npvnXv','2NIrdBl','secret','Invalid\x20or\x20expired\x20token','role','findUnique','276831BpXzlR','requireAdmin','../config/database','isTokenBlacklisted','4554153wZVEOK','Access\x20token\x20required','../services/tokenBlacklistService','default','jwt'];a18_0x419e=function(){return _0x371fd0;};return a18_0x419e();}var __importDefault=this&&this['__importDefault']||function(_0xc65923){const _0x244b24=a18_0x2c65;return _0xc65923&&_0xc65923[_0x244b24(0xb4)]?_0xc65923:{'default':_0xc65923};};Object[a18_0x5ada50(0xc2)](exports,a18_0x5ada50(0xb4),{'value':!![]}),exports[a18_0x5ada50(0xbd)]=exports[a18_0x5ada50(0xb0)]=exports[a18_0x5ada50(0xa6)]=exports['authenticateToken']=void 0x0;function a18_0x2c65(_0x2e100b,_0x371614){const _0x419e78=a18_0x419e();return a18_0x2c65=function(_0x2c6591,_0x48fde5){_0x2c6591=_0x2c6591-0x9d;let _0x1ec476=_0x419e78[_0x2c6591];return _0x1ec476;},a18_0x2c65(_0x2e100b,_0x371614);}const jsonwebtoken_1=__importDefault(require(a18_0x5ada50(0xc7))),config_1=require('../config/config'),tokenBlacklistService_1=require(a18_0x5ada50(0xab)),authenticateToken=(_0x48013f,_0x2d655a,_0x175b05)=>{const _0x23a223=a18_0x5ada50,_0x37c7c2=_0x48013f[_0x23a223(0xae)][_0x23a223(0xbc)],_0x27f6a7=_0x37c7c2&&_0x37c7c2[_0x23a223(0x9d)]('\x20')[0x1];if(!_0x27f6a7)return _0x2d655a[_0x23a223(0xbf)](0x191)[_0x23a223(0xb8)]({'success':![],'message':_0x23a223(0xaa)});if(tokenBlacklistService_1[_0x23a223(0x9e)][_0x23a223(0xa8)](_0x27f6a7))return _0x2d655a[_0x23a223(0xbf)](0x191)['json']({'success':![],'message':_0x23a223(0xaf)});jsonwebtoken_1[_0x23a223(0xac)][_0x23a223(0xc6)](_0x27f6a7,config_1['config'][_0x23a223(0xad)][_0x23a223(0xa1)],(_0x3d58c3,_0x840ef2)=>{const _0x5eac0b=_0x23a223;if(_0x3d58c3)return _0x2d655a[_0x5eac0b(0xbf)](0x193)[_0x5eac0b(0xb8)]({'success':![],'message':_0x5eac0b(0xa2)});_0x48013f[_0x5eac0b(0xc9)]=_0x840ef2,_0x48013f[_0x5eac0b(0xb6)]=_0x27f6a7,_0x175b05();});};exports[a18_0x5ada50(0xba)]=authenticateToken;const requireAdmin=(_0x3aa2d2,_0x3229bc,_0x43c640)=>{const _0x130c27=a18_0x5ada50;if(!_0x3aa2d2[_0x130c27(0xc9)]||_0x3aa2d2[_0x130c27(0xc9)][_0x130c27(0xa3)]!==_0x130c27(0xc4))return _0x3229bc[_0x130c27(0xbf)](0x193)['json']({'success':![],'message':_0x130c27(0xc0)});_0x43c640();};exports[a18_0x5ada50(0xa6)]=requireAdmin;const requireShop=(_0x2454d9,_0xa8e263,_0x5c45c0)=>{const _0x3565de=a18_0x5ada50;if(!_0x2454d9[_0x3565de(0xc9)]||_0x2454d9[_0x3565de(0xc9)][_0x3565de(0xa3)]!==_0x3565de(0xb2))return _0xa8e263[_0x3565de(0xbf)](0x193)[_0x3565de(0xb8)]({'success':![],'message':_0x3565de(0xbe)});_0x5c45c0();};exports[a18_0x5ada50(0xb0)]=requireShop;const requireActiveShop=async(_0x3265d4,_0x313381,_0x39dde8)=>{const _0x46158=a18_0x5ada50;if(!_0x3265d4[_0x46158(0xc9)]||_0x3265d4['user'][_0x46158(0xa3)]!==_0x46158(0xb2))return _0x313381[_0x46158(0xbf)](0x193)[_0x46158(0xb8)]({'success':![],'message':_0x46158(0xbe)});try{const _0x3ab5e8=require(_0x46158(0xa7))[_0x46158(0xac)],_0x4739e6=await _0x3ab5e8[_0x46158(0xb2)][_0x46158(0xa4)]({'where':{'id':_0x3265d4['user']['id']},'select':{'status':!![]}});if(!_0x4739e6||_0x4739e6[_0x46158(0xbf)]!==_0x46158(0xb5))return _0x313381[_0x46158(0xbf)](0x193)[_0x46158(0xb8)]({'success':![],'message':_0x46158(0xb7),'suspended':_0x4739e6?.[_0x46158(0xbf)]===_0x46158(0xb1)});_0x39dde8();}catch(_0x297644){return console['error']('Error\x20checking\x20account\x20status:',_0x297644),_0x313381['status'](0x1f4)[_0x46158(0xb8)]({'success':![],'message':_0x46158(0xc3)});}};exports[a18_0x5ada50(0xbd)]=requireActiveShop;