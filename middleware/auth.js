'use strict';const a16_0x2e2f6a=a16_0x5e7e;(function(_0xceccce,_0x23f7e5){const _0x4e4d38=a16_0x5e7e,_0x5e0771=_0xceccce();while(!![]){try{const _0x4ffb7e=parseInt(_0x4e4d38(0x119))/0x1*(-parseInt(_0x4e4d38(0x127))/0x2)+-parseInt(_0x4e4d38(0x106))/0x3*(-parseInt(_0x4e4d38(0x11b))/0x4)+-parseInt(_0x4e4d38(0x114))/0x5*(parseInt(_0x4e4d38(0x129))/0x6)+parseInt(_0x4e4d38(0x128))/0x7+parseInt(_0x4e4d38(0x109))/0x8*(parseInt(_0x4e4d38(0x11d))/0x9)+-parseInt(_0x4e4d38(0x10f))/0xa*(-parseInt(_0x4e4d38(0x108))/0xb)+-parseInt(_0x4e4d38(0x123))/0xc;if(_0x4ffb7e===_0x23f7e5)break;else _0x5e0771['push'](_0x5e0771['shift']());}catch(_0x247418){_0x5e0771['push'](_0x5e0771['shift']());}}}(a16_0x3381,0xf34a0));var __importDefault=this&&this[a16_0x2e2f6a(0x10e)]||function(_0xd1dd16){const _0x138370=a16_0x2e2f6a;return _0xd1dd16&&_0xd1dd16[_0x138370(0x105)]?_0xd1dd16:{'default':_0xd1dd16};};function a16_0x3381(){const _0x20d417=['default','jsonwebtoken','__esModule','33vlPuzt','SUSPENDED','22LwlLSA','7864704glzkgR','role','headers','status','shop','__importDefault','2632100fVMXGL','Admin\x20access\x20required','Token\x20has\x20been\x20revoked','jwt','config','2605dOuYwK','requireAdmin','../services/tokenBlacklistService','json','../config/config','1zekOHh','user','558672EtXEuR','findUnique','18KRsFjM','requireShop','Account\x20is\x20suspended\x20or\x20inactive.\x20Contact\x20administrator\x20to\x20activate\x20your\x20account.','Error\x20checking\x20account\x20status','secret','ACTIVE','28505568KfaSPG','Error\x20checking\x20account\x20status:','authorization','tokenBlacklistService','1048326czNNTq','12808614FUwWGL','22602IfGjIw','token','../config/database','requireActiveShop'];a16_0x3381=function(){return _0x20d417;};return a16_0x3381();}Object['defineProperty'](exports,'__esModule',{'value':!![]}),exports[a16_0x2e2f6a(0x102)]=exports['requireShop']=exports[a16_0x2e2f6a(0x115)]=exports['authenticateToken']=void 0x0;const jsonwebtoken_1=__importDefault(require(a16_0x2e2f6a(0x104))),config_1=require(a16_0x2e2f6a(0x118)),tokenBlacklistService_1=require(a16_0x2e2f6a(0x116)),authenticateToken=(_0x44f18b,_0x246a8c,_0xca19a5)=>{const _0x452aa6=a16_0x2e2f6a,_0xa17fae=_0x44f18b[_0x452aa6(0x10b)][_0x452aa6(0x125)],_0xbd5b45=_0xa17fae&&_0xa17fae['split']('\x20')[0x1];if(!_0xbd5b45)return _0x246a8c['status'](0x191)['json']({'success':![],'message':'Access\x20token\x20required'});if(tokenBlacklistService_1[_0x452aa6(0x126)]['isTokenBlacklisted'](_0xbd5b45))return _0x246a8c['status'](0x191)[_0x452aa6(0x117)]({'success':![],'message':_0x452aa6(0x111)});jsonwebtoken_1[_0x452aa6(0x103)]['verify'](_0xbd5b45,config_1[_0x452aa6(0x113)][_0x452aa6(0x112)][_0x452aa6(0x121)],(_0x16fb6e,_0x544736)=>{const _0x5b67f9=_0x452aa6;if(_0x16fb6e)return _0x246a8c[_0x5b67f9(0x10c)](0x193)['json']({'success':![],'message':'Invalid\x20or\x20expired\x20token'});_0x44f18b['user']=_0x544736,_0x44f18b[_0x5b67f9(0x100)]=_0xbd5b45,_0xca19a5();});};exports['authenticateToken']=authenticateToken;const requireAdmin=(_0x418db2,_0x33d451,_0x70daa7)=>{const _0x3ec2db=a16_0x2e2f6a;if(!_0x418db2['user']||_0x418db2[_0x3ec2db(0x11a)]['role']!=='admin')return _0x33d451[_0x3ec2db(0x10c)](0x193)[_0x3ec2db(0x117)]({'success':![],'message':_0x3ec2db(0x110)});_0x70daa7();};exports[a16_0x2e2f6a(0x115)]=requireAdmin;function a16_0x5e7e(_0x9708a2,_0x4b5d9b){const _0x338130=a16_0x3381();return a16_0x5e7e=function(_0x5e7e94,_0xcd7db0){_0x5e7e94=_0x5e7e94-0x100;let _0x1e31b8=_0x338130[_0x5e7e94];return _0x1e31b8;},a16_0x5e7e(_0x9708a2,_0x4b5d9b);}const requireShop=(_0x20af97,_0x4fffc3,_0xff0680)=>{const _0x1f417b=a16_0x2e2f6a;if(!_0x20af97[_0x1f417b(0x11a)]||_0x20af97[_0x1f417b(0x11a)]['role']!==_0x1f417b(0x10d))return _0x4fffc3[_0x1f417b(0x10c)](0x193)[_0x1f417b(0x117)]({'success':![],'message':'Shop\x20access\x20required'});_0xff0680();};exports[a16_0x2e2f6a(0x11e)]=requireShop;const requireActiveShop=async(_0x2c9427,_0x2ecb2e,_0x1824f5)=>{const _0x244b0b=a16_0x2e2f6a;if(!_0x2c9427['user']||_0x2c9427[_0x244b0b(0x11a)][_0x244b0b(0x10a)]!==_0x244b0b(0x10d))return _0x2ecb2e['status'](0x193)['json']({'success':![],'message':'Shop\x20access\x20required'});try{const _0x24274b=require(_0x244b0b(0x101))[_0x244b0b(0x103)],_0x385988=await _0x24274b[_0x244b0b(0x10d)][_0x244b0b(0x11c)]({'where':{'id':_0x2c9427[_0x244b0b(0x11a)]['id']},'select':{'status':!![]}});if(!_0x385988||_0x385988['status']!==_0x244b0b(0x122))return _0x2ecb2e[_0x244b0b(0x10c)](0x193)[_0x244b0b(0x117)]({'success':![],'message':_0x244b0b(0x11f),'suspended':_0x385988?.[_0x244b0b(0x10c)]===_0x244b0b(0x107)});_0x1824f5();}catch(_0x4b37b4){return console['error'](_0x244b0b(0x124),_0x4b37b4),_0x2ecb2e[_0x244b0b(0x10c)](0x1f4)[_0x244b0b(0x117)]({'success':![],'message':_0x244b0b(0x120)});}};exports['requireActiveShop']=requireActiveShop;