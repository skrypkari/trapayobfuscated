'use strict';const a21_0x46a0e8=a21_0x4795;(function(_0x1e6b08,_0x2960c9){const _0x4d8436=a21_0x4795,_0x5b6372=_0x1e6b08();while(!![]){try{const _0x16f7ea=parseInt(_0x4d8436(0x193))/0x1*(parseInt(_0x4d8436(0x1a9))/0x2)+parseInt(_0x4d8436(0x1b5))/0x3*(-parseInt(_0x4d8436(0x1b4))/0x4)+parseInt(_0x4d8436(0x195))/0x5+parseInt(_0x4d8436(0x1a0))/0x6*(parseInt(_0x4d8436(0x1aa))/0x7)+parseInt(_0x4d8436(0x194))/0x8+parseInt(_0x4d8436(0x1a1))/0x9*(parseInt(_0x4d8436(0x1ad))/0xa)+-parseInt(_0x4d8436(0x1a6))/0xb*(parseInt(_0x4d8436(0x1a7))/0xc);if(_0x16f7ea===_0x2960c9)break;else _0x5b6372['push'](_0x5b6372['shift']());}catch(_0x29d3a7){_0x5b6372['push'](_0x5b6372['shift']());}}}(a21_0x1ef5,0xda39a));function a21_0x4795(_0x3f3494,_0x108293){_0x3f3494=_0x3f3494-0x190;const _0x1ef511=a21_0x1ef5();let _0x4795d6=_0x1ef511[_0x3f3494];return _0x4795d6;}var __importDefault=this&&this[a21_0x46a0e8(0x1bb)]||function(_0x2dd032){const _0x52ec32=a21_0x46a0e8;return _0x2dd032&&_0x2dd032[_0x52ec32(0x190)]?_0x2dd032:{'default':_0x2dd032};};Object[a21_0x46a0e8(0x19e)](exports,'__esModule',{'value':!![]}),exports[a21_0x46a0e8(0x19b)]=exports[a21_0x46a0e8(0x196)]=exports[a21_0x46a0e8(0x1af)]=exports[a21_0x46a0e8(0x192)]=void 0x0;const jsonwebtoken_1=__importDefault(require(a21_0x46a0e8(0x19f))),config_1=require(a21_0x46a0e8(0x1be)),tokenBlacklistService_1=require(a21_0x46a0e8(0x1ab)),authenticateToken=(_0x4f4049,_0x36113d,_0x100c5a)=>{const _0x5c8f8c=a21_0x46a0e8,_0x55e446=_0x4f4049['headers'][_0x5c8f8c(0x191)],_0x57c840=_0x55e446&&_0x55e446[_0x5c8f8c(0x1ae)]('\x20')[0x1];if(!_0x57c840)return _0x36113d[_0x5c8f8c(0x19d)](0x191)[_0x5c8f8c(0x1b3)]({'success':![],'message':_0x5c8f8c(0x1a4)});if(tokenBlacklistService_1[_0x5c8f8c(0x1b6)][_0x5c8f8c(0x199)](_0x57c840))return _0x36113d[_0x5c8f8c(0x19d)](0x191)[_0x5c8f8c(0x1b3)]({'success':![],'message':_0x5c8f8c(0x1b0)});jsonwebtoken_1[_0x5c8f8c(0x198)][_0x5c8f8c(0x1bf)](_0x57c840,config_1[_0x5c8f8c(0x1b9)][_0x5c8f8c(0x1a3)][_0x5c8f8c(0x1ac)],(_0x357c77,_0x4e9db4)=>{const _0x18a624=_0x5c8f8c;if(_0x357c77)return _0x36113d[_0x18a624(0x19d)](0x193)[_0x18a624(0x1b3)]({'success':![],'message':'Invalid\x20or\x20expired\x20token'});_0x4f4049[_0x18a624(0x19c)]=_0x4e9db4,_0x4f4049[_0x18a624(0x1bd)]=_0x57c840,_0x100c5a();});};exports[a21_0x46a0e8(0x192)]=authenticateToken;function a21_0x1ef5(){const _0x405c0e=['config','ACTIVE','__importDefault','error','token','../config/config','verify','findUnique','__esModule','authorization','authenticateToken','4kNzrbP','6625016ZqNXTW','6211125howCvC','requireShop','role','default','isTokenBlacklisted','admin','requireActiveShop','user','status','defineProperty','jsonwebtoken','144780yafucI','9gzetKR','shop','jwt','Access\x20token\x20required','Error\x20checking\x20account\x20status','36534509gkQqJH','12dpCFYN','SUSPENDED','859174HpIMWd','231tgCRaL','../services/tokenBlacklistService','secret','5160110olfMZB','split','requireAdmin','Token\x20has\x20been\x20revoked','Shop\x20access\x20required','Error\x20checking\x20account\x20status:','json','885832GvTZSZ','12andbMX','tokenBlacklistService','../config/database','Account\x20is\x20suspended\x20or\x20inactive.\x20Contact\x20administrator\x20to\x20activate\x20your\x20account.'];a21_0x1ef5=function(){return _0x405c0e;};return a21_0x1ef5();}const requireAdmin=(_0x1fd91e,_0x3aab4f,_0x42192c)=>{const _0x1afd16=a21_0x46a0e8;if(!_0x1fd91e[_0x1afd16(0x19c)]||_0x1fd91e[_0x1afd16(0x19c)][_0x1afd16(0x197)]!==_0x1afd16(0x19a))return _0x3aab4f['status'](0x193)[_0x1afd16(0x1b3)]({'success':![],'message':'Admin\x20access\x20required'});_0x42192c();};exports[a21_0x46a0e8(0x1af)]=requireAdmin;const requireShop=(_0xd2e3d6,_0x16fcf4,_0x44eae6)=>{const _0x2ffe18=a21_0x46a0e8;if(!_0xd2e3d6['user']||_0xd2e3d6[_0x2ffe18(0x19c)][_0x2ffe18(0x197)]!==_0x2ffe18(0x1a2))return _0x16fcf4[_0x2ffe18(0x19d)](0x193)['json']({'success':![],'message':_0x2ffe18(0x1b1)});_0x44eae6();};exports['requireShop']=requireShop;const requireActiveShop=async(_0x62c10b,_0xb0c9fb,_0xbf4a37)=>{const _0x5c6690=a21_0x46a0e8;if(!_0x62c10b['user']||_0x62c10b[_0x5c6690(0x19c)][_0x5c6690(0x197)]!=='shop')return _0xb0c9fb['status'](0x193)[_0x5c6690(0x1b3)]({'success':![],'message':_0x5c6690(0x1b1)});try{const _0x157a66=require(_0x5c6690(0x1b7))[_0x5c6690(0x198)],_0x5b9a97=await _0x157a66[_0x5c6690(0x1a2)][_0x5c6690(0x1c0)]({'where':{'id':_0x62c10b[_0x5c6690(0x19c)]['id']},'select':{'status':!![]}});if(!_0x5b9a97||_0x5b9a97[_0x5c6690(0x19d)]!==_0x5c6690(0x1ba))return _0xb0c9fb[_0x5c6690(0x19d)](0x193)[_0x5c6690(0x1b3)]({'success':![],'message':_0x5c6690(0x1b8),'suspended':_0x5b9a97?.[_0x5c6690(0x19d)]===_0x5c6690(0x1a8)});_0xbf4a37();}catch(_0x5400a4){return console[_0x5c6690(0x1bc)](_0x5c6690(0x1b2),_0x5400a4),_0xb0c9fb[_0x5c6690(0x19d)](0x1f4)[_0x5c6690(0x1b3)]({'success':![],'message':_0x5c6690(0x1a5)});}};exports['requireActiveShop']=requireActiveShop;