'use strict';const a21_0xfa8a03=a21_0x5b19;(function(_0x577bf4,_0x5bbc47){const _0x23c23f=a21_0x5b19,_0xf4723b=_0x577bf4();while(!![]){try{const _0x29806c=parseInt(_0x23c23f(0x165))/0x1*(parseInt(_0x23c23f(0x145))/0x2)+parseInt(_0x23c23f(0x149))/0x3+parseInt(_0x23c23f(0x14e))/0x4*(-parseInt(_0x23c23f(0x14b))/0x5)+parseInt(_0x23c23f(0x164))/0x6*(parseInt(_0x23c23f(0x144))/0x7)+-parseInt(_0x23c23f(0x146))/0x8*(parseInt(_0x23c23f(0x15e))/0x9)+-parseInt(_0x23c23f(0x159))/0xa+-parseInt(_0x23c23f(0x154))/0xb;if(_0x29806c===_0x5bbc47)break;else _0xf4723b['push'](_0xf4723b['shift']());}catch(_0x307699){_0xf4723b['push'](_0xf4723b['shift']());}}}(a21_0x56d2,0xb4b0c));function a21_0x56d2(){const _0x3df5bb=['2624zNaRZe','../config/database','shop','2386146jAjJMX','verify','2765rILWUD','Token\x20has\x20been\x20revoked','__esModule','3404sPBWuI','headers','requireShop','Invalid\x20or\x20expired\x20token','defineProperty','error','5752516asavXO','findUnique','user','requireActiveShop','authenticateToken','1883630tCDtZn','../services/tokenBlacklistService','status','Account\x20is\x20suspended\x20or\x20inactive.\x20Contact\x20administrator\x20to\x20activate\x20your\x20account.','jwt','36054tJPtUO','__importDefault','json','Shop\x20access\x20required','default','requireAdmin','5960766CyPCuh','3qpHcWq','split','role','7nrEWBp','964770KoyNRY'];a21_0x56d2=function(){return _0x3df5bb;};return a21_0x56d2();}function a21_0x5b19(_0x357b4d,_0x399528){_0x357b4d=_0x357b4d-0x143;const _0x56d2bc=a21_0x56d2();let _0x5b1900=_0x56d2bc[_0x357b4d];return _0x5b1900;}var __importDefault=this&&this[a21_0xfa8a03(0x15f)]||function(_0x13e036){const _0x50c12b=a21_0xfa8a03;return _0x13e036&&_0x13e036[_0x50c12b(0x14d)]?_0x13e036:{'default':_0x13e036};};Object[a21_0xfa8a03(0x152)](exports,a21_0xfa8a03(0x14d),{'value':!![]}),exports[a21_0xfa8a03(0x157)]=exports['requireShop']=exports[a21_0xfa8a03(0x163)]=exports[a21_0xfa8a03(0x158)]=void 0x0;const jsonwebtoken_1=__importDefault(require('jsonwebtoken')),config_1=require('../config/config'),tokenBlacklistService_1=require(a21_0xfa8a03(0x15a)),authenticateToken=(_0x3d4832,_0x5bb412,_0x189a7d)=>{const _0x3f1d99=a21_0xfa8a03,_0x51ae1b=_0x3d4832[_0x3f1d99(0x14f)]['authorization'],_0x28d3fa=_0x51ae1b&&_0x51ae1b[_0x3f1d99(0x166)]('\x20')[0x1];if(!_0x28d3fa)return _0x5bb412[_0x3f1d99(0x15b)](0x191)[_0x3f1d99(0x160)]({'success':![],'message':'Access\x20token\x20required'});if(tokenBlacklistService_1['tokenBlacklistService']['isTokenBlacklisted'](_0x28d3fa))return _0x5bb412[_0x3f1d99(0x15b)](0x191)['json']({'success':![],'message':_0x3f1d99(0x14c)});jsonwebtoken_1['default'][_0x3f1d99(0x14a)](_0x28d3fa,config_1['config'][_0x3f1d99(0x15d)]['secret'],(_0x2d2d55,_0x2462d3)=>{const _0x7aceea=_0x3f1d99;if(_0x2d2d55)return _0x5bb412[_0x7aceea(0x15b)](0x193)['json']({'success':![],'message':_0x7aceea(0x151)});_0x3d4832[_0x7aceea(0x156)]=_0x2462d3,_0x3d4832['token']=_0x28d3fa,_0x189a7d();});};exports[a21_0xfa8a03(0x158)]=authenticateToken;const requireAdmin=(_0x331b31,_0x26d56c,_0x5d131c)=>{const _0x1b5931=a21_0xfa8a03;if(!_0x331b31[_0x1b5931(0x156)]||_0x331b31[_0x1b5931(0x156)][_0x1b5931(0x143)]!=='admin')return _0x26d56c[_0x1b5931(0x15b)](0x193)[_0x1b5931(0x160)]({'success':![],'message':'Admin\x20access\x20required'});_0x5d131c();};exports[a21_0xfa8a03(0x163)]=requireAdmin;const requireShop=(_0x9fe2c7,_0x54982b,_0x3acd4d)=>{const _0x4bd051=a21_0xfa8a03;if(!_0x9fe2c7[_0x4bd051(0x156)]||_0x9fe2c7[_0x4bd051(0x156)][_0x4bd051(0x143)]!=='shop')return _0x54982b[_0x4bd051(0x15b)](0x193)['json']({'success':![],'message':_0x4bd051(0x161)});_0x3acd4d();};exports[a21_0xfa8a03(0x150)]=requireShop;const requireActiveShop=async(_0x5ea59a,_0x3b65b9,_0x1411a7)=>{const _0x154650=a21_0xfa8a03;if(!_0x5ea59a[_0x154650(0x156)]||_0x5ea59a[_0x154650(0x156)][_0x154650(0x143)]!=='shop')return _0x3b65b9[_0x154650(0x15b)](0x193)['json']({'success':![],'message':_0x154650(0x161)});try{const _0x285634=require(_0x154650(0x147))[_0x154650(0x162)],_0x37a506=await _0x285634[_0x154650(0x148)][_0x154650(0x155)]({'where':{'id':_0x5ea59a[_0x154650(0x156)]['id']},'select':{'status':!![]}});if(!_0x37a506||_0x37a506['status']!=='ACTIVE')return _0x3b65b9[_0x154650(0x15b)](0x193)[_0x154650(0x160)]({'success':![],'message':_0x154650(0x15c),'suspended':_0x37a506?.[_0x154650(0x15b)]==='SUSPENDED'});_0x1411a7();}catch(_0x2642e0){return console[_0x154650(0x153)]('Error\x20checking\x20account\x20status:',_0x2642e0),_0x3b65b9['status'](0x1f4)[_0x154650(0x160)]({'success':![],'message':'Error\x20checking\x20account\x20status'});}};exports[a21_0xfa8a03(0x157)]=requireActiveShop;