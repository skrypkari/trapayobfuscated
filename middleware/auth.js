'use strict';function a22_0x608a(_0x572781,_0x2fa49c){_0x572781=_0x572781-0x153;const _0x263e73=a22_0x263e();let _0x608a0d=_0x263e73[_0x572781];return _0x608a0d;}const a22_0x2c936e=a22_0x608a;(function(_0x5f33e3,_0x1f75aa){const _0x155f4c=a22_0x608a,_0x35f8ed=_0x5f33e3();while(!![]){try{const _0x2422c2=parseInt(_0x155f4c(0x175))/0x1+parseInt(_0x155f4c(0x16a))/0x2+parseInt(_0x155f4c(0x159))/0x3+parseInt(_0x155f4c(0x164))/0x4+-parseInt(_0x155f4c(0x16c))/0x5+-parseInt(_0x155f4c(0x157))/0x6+-parseInt(_0x155f4c(0x161))/0x7*(parseInt(_0x155f4c(0x17c))/0x8);if(_0x2422c2===_0x1f75aa)break;else _0x35f8ed['push'](_0x35f8ed['shift']());}catch(_0x17f1b0){_0x35f8ed['push'](_0x35f8ed['shift']());}}}(a22_0x263e,0xce676));var __importDefault=this&&this['__importDefault']||function(_0x53dfcf){const _0x3e782f=a22_0x608a;return _0x53dfcf&&_0x53dfcf[_0x3e782f(0x178)]?_0x53dfcf:{'default':_0x53dfcf};};Object[a22_0x2c936e(0x153)](exports,a22_0x2c936e(0x178),{'value':!![]}),exports[a22_0x2c936e(0x167)]=exports[a22_0x2c936e(0x156)]=exports[a22_0x2c936e(0x172)]=exports[a22_0x2c936e(0x162)]=void 0x0;const jsonwebtoken_1=__importDefault(require(a22_0x2c936e(0x16d))),config_1=require('../config/config'),tokenBlacklistService_1=require(a22_0x2c936e(0x168)),authenticateToken=(_0x528a61,_0x5c6cca,_0x4f6a13)=>{const _0x3cade0=a22_0x2c936e,_0x2ee86a=_0x528a61['headers'][_0x3cade0(0x15a)],_0x444b39=_0x2ee86a&&_0x2ee86a[_0x3cade0(0x163)]('\x20')[0x1];if(!_0x444b39)return _0x5c6cca[_0x3cade0(0x173)](0x191)[_0x3cade0(0x15e)]({'success':![],'message':_0x3cade0(0x16f)});if(tokenBlacklistService_1['tokenBlacklistService'][_0x3cade0(0x15f)](_0x444b39))return _0x5c6cca[_0x3cade0(0x173)](0x191)[_0x3cade0(0x15e)]({'success':![],'message':_0x3cade0(0x155)});jsonwebtoken_1[_0x3cade0(0x158)][_0x3cade0(0x169)](_0x444b39,config_1[_0x3cade0(0x160)][_0x3cade0(0x179)][_0x3cade0(0x170)],(_0x3a9e3d,_0x44dee6)=>{const _0x1f431c=_0x3cade0;if(_0x3a9e3d)return _0x5c6cca['status'](0x193)[_0x1f431c(0x15e)]({'success':![],'message':_0x1f431c(0x177)});_0x528a61[_0x1f431c(0x15b)]=_0x44dee6,_0x528a61[_0x1f431c(0x154)]=_0x444b39,_0x4f6a13();});};exports[a22_0x2c936e(0x162)]=authenticateToken;function a22_0x263e(){const _0x534543=['admin','requireActiveShop','../services/tokenBlacklistService','verify','2959522dYHSOV','../config/database','5607650ThNiuK','jsonwebtoken','SUSPENDED','Access\x20token\x20required','secret','shop','requireAdmin','status','Error\x20checking\x20account\x20status','1516872gFzfmM','Account\x20is\x20suspended\x20or\x20inactive.\x20Contact\x20administrator\x20to\x20activate\x20your\x20account.','Invalid\x20or\x20expired\x20token','__esModule','jwt','role','Shop\x20access\x20required','8LVllAb','Error\x20checking\x20account\x20status:','defineProperty','token','Token\x20has\x20been\x20revoked','requireShop','5004402VmUsDz','default','4482114jokvmb','authorization','user','error','Admin\x20access\x20required','json','isTokenBlacklisted','config','16940728HlrZgo','authenticateToken','split','2921840iJMYrm','ACTIVE'];a22_0x263e=function(){return _0x534543;};return a22_0x263e();}const requireAdmin=(_0x22f45a,_0x37c62f,_0x451fcb)=>{const _0x8eaa15=a22_0x2c936e;if(!_0x22f45a[_0x8eaa15(0x15b)]||_0x22f45a['user']['role']!==_0x8eaa15(0x166))return _0x37c62f['status'](0x193)[_0x8eaa15(0x15e)]({'success':![],'message':_0x8eaa15(0x15d)});_0x451fcb();};exports[a22_0x2c936e(0x172)]=requireAdmin;const requireShop=(_0x240873,_0x2646fb,_0x4c04b7)=>{const _0x22adf8=a22_0x2c936e;if(!_0x240873[_0x22adf8(0x15b)]||_0x240873[_0x22adf8(0x15b)]['role']!==_0x22adf8(0x171))return _0x2646fb[_0x22adf8(0x173)](0x193)[_0x22adf8(0x15e)]({'success':![],'message':_0x22adf8(0x17b)});_0x4c04b7();};exports['requireShop']=requireShop;const requireActiveShop=async(_0x41ff5a,_0x22647f,_0x3c1243)=>{const _0x3fb3c5=a22_0x2c936e;if(!_0x41ff5a[_0x3fb3c5(0x15b)]||_0x41ff5a['user'][_0x3fb3c5(0x17a)]!=='shop')return _0x22647f[_0x3fb3c5(0x173)](0x193)[_0x3fb3c5(0x15e)]({'success':![],'message':_0x3fb3c5(0x17b)});try{const _0x28eac3=require(_0x3fb3c5(0x16b))[_0x3fb3c5(0x158)],_0x5e41bd=await _0x28eac3[_0x3fb3c5(0x171)]['findUnique']({'where':{'id':_0x41ff5a[_0x3fb3c5(0x15b)]['id']},'select':{'status':!![]}});if(!_0x5e41bd||_0x5e41bd[_0x3fb3c5(0x173)]!==_0x3fb3c5(0x165))return _0x22647f[_0x3fb3c5(0x173)](0x193)[_0x3fb3c5(0x15e)]({'success':![],'message':_0x3fb3c5(0x176),'suspended':_0x5e41bd?.[_0x3fb3c5(0x173)]===_0x3fb3c5(0x16e)});_0x3c1243();}catch(_0x18d6b3){return console[_0x3fb3c5(0x15c)](_0x3fb3c5(0x17d),_0x18d6b3),_0x22647f[_0x3fb3c5(0x173)](0x1f4)[_0x3fb3c5(0x15e)]({'success':![],'message':_0x3fb3c5(0x174)});}};exports[a22_0x2c936e(0x167)]=requireActiveShop;