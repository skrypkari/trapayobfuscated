'use strict';const a16_0x169212=a16_0xff47;(function(_0x4a97ea,_0x5ed752){const _0x3583fa=a16_0xff47,_0x56273f=_0x4a97ea();while(!![]){try{const _0x4e7b2e=parseInt(_0x3583fa(0x131))/0x1*(parseInt(_0x3583fa(0x12c))/0x2)+-parseInt(_0x3583fa(0x13a))/0x3+parseInt(_0x3583fa(0x137))/0x4*(-parseInt(_0x3583fa(0x120))/0x5)+parseInt(_0x3583fa(0x138))/0x6*(parseInt(_0x3583fa(0x136))/0x7)+-parseInt(_0x3583fa(0x13c))/0x8+-parseInt(_0x3583fa(0x139))/0x9+parseInt(_0x3583fa(0x12b))/0xa*(parseInt(_0x3583fa(0x147))/0xb);if(_0x4e7b2e===_0x5ed752)break;else _0x56273f['push'](_0x56273f['shift']());}catch(_0x23a9f0){_0x56273f['push'](_0x56273f['shift']());}}}(a16_0x2a5f,0xae6f6));function a16_0x2a5f(){const _0x45952b=['Token\x20has\x20been\x20revoked','status','requireShop','82YkABDv','authenticateToken','SUSPENDED','user','findUnique','21pOcPkD','4TSYJNC','2252802mhNphR','5513706MiwANx','73662wHtwYG','requireAdmin','5850928iKOtzj','__importDefault','requireActiveShop','isTokenBlacklisted','../config/database','Shop\x20access\x20required','Account\x20is\x20suspended\x20or\x20inactive.\x20Contact\x20administrator\x20to\x20activate\x20your\x20account.','admin','../config/config','headers','role','11rZonYH','Admin\x20access\x20required','439330FqWJad','../services/tokenBlacklistService','token','Access\x20token\x20required','defineProperty','json','authorization','__esModule','default','Error\x20checking\x20account\x20status','Invalid\x20or\x20expired\x20token','3753030rOHPjD','16322iGbbGr','shop'];a16_0x2a5f=function(){return _0x45952b;};return a16_0x2a5f();}var __importDefault=this&&this[a16_0x169212(0x13d)]||function(_0x4360b3){const _0x2ff901=a16_0x169212;return _0x4360b3&&_0x4360b3[_0x2ff901(0x127)]?_0x4360b3:{'default':_0x4360b3};};Object[a16_0x169212(0x124)](exports,a16_0x169212(0x127),{'value':!![]}),exports[a16_0x169212(0x13e)]=exports[a16_0x169212(0x130)]=exports[a16_0x169212(0x13b)]=exports['authenticateToken']=void 0x0;const jsonwebtoken_1=__importDefault(require('jsonwebtoken')),config_1=require(a16_0x169212(0x144)),tokenBlacklistService_1=require(a16_0x169212(0x121)),authenticateToken=(_0xcac3c7,_0xe33ea2,_0x3266a6)=>{const _0x2e7153=a16_0x169212,_0x39cf47=_0xcac3c7[_0x2e7153(0x145)][_0x2e7153(0x126)],_0x1f89ff=_0x39cf47&&_0x39cf47['split']('\x20')[0x1];if(!_0x1f89ff)return _0xe33ea2['status'](0x191)[_0x2e7153(0x125)]({'success':![],'message':_0x2e7153(0x123)});if(tokenBlacklistService_1['tokenBlacklistService'][_0x2e7153(0x13f)](_0x1f89ff))return _0xe33ea2[_0x2e7153(0x12f)](0x191)[_0x2e7153(0x125)]({'success':![],'message':_0x2e7153(0x12e)});jsonwebtoken_1[_0x2e7153(0x128)]['verify'](_0x1f89ff,config_1['config']['jwt']['secret'],(_0x523876,_0x13f4b7)=>{const _0x4420a6=_0x2e7153;if(_0x523876)return _0xe33ea2[_0x4420a6(0x12f)](0x193)['json']({'success':![],'message':_0x4420a6(0x12a)});_0xcac3c7[_0x4420a6(0x134)]=_0x13f4b7,_0xcac3c7[_0x4420a6(0x122)]=_0x1f89ff,_0x3266a6();});};exports[a16_0x169212(0x132)]=authenticateToken;const requireAdmin=(_0x23cee5,_0x36ebdd,_0x4073be)=>{const _0x124f83=a16_0x169212;if(!_0x23cee5[_0x124f83(0x134)]||_0x23cee5[_0x124f83(0x134)][_0x124f83(0x146)]!==_0x124f83(0x143))return _0x36ebdd[_0x124f83(0x12f)](0x193)['json']({'success':![],'message':_0x124f83(0x148)});_0x4073be();};function a16_0xff47(_0x3020f4,_0x3229de){const _0x2a5f2b=a16_0x2a5f();return a16_0xff47=function(_0xff4729,_0x26ac54){_0xff4729=_0xff4729-0x120;let _0x179623=_0x2a5f2b[_0xff4729];return _0x179623;},a16_0xff47(_0x3020f4,_0x3229de);}exports[a16_0x169212(0x13b)]=requireAdmin;const requireShop=(_0x106bcc,_0x2478ad,_0x26259a)=>{const _0x54f86e=a16_0x169212;if(!_0x106bcc[_0x54f86e(0x134)]||_0x106bcc[_0x54f86e(0x134)][_0x54f86e(0x146)]!=='shop')return _0x2478ad[_0x54f86e(0x12f)](0x193)['json']({'success':![],'message':_0x54f86e(0x141)});_0x26259a();};exports[a16_0x169212(0x130)]=requireShop;const requireActiveShop=async(_0x176c86,_0x2df8d3,_0x3313bb)=>{const _0x316ec4=a16_0x169212;if(!_0x176c86['user']||_0x176c86[_0x316ec4(0x134)][_0x316ec4(0x146)]!==_0x316ec4(0x12d))return _0x2df8d3[_0x316ec4(0x12f)](0x193)[_0x316ec4(0x125)]({'success':![],'message':_0x316ec4(0x141)});try{const _0x2561ba=require(_0x316ec4(0x140))[_0x316ec4(0x128)],_0x3308fb=await _0x2561ba[_0x316ec4(0x12d)][_0x316ec4(0x135)]({'where':{'id':_0x176c86[_0x316ec4(0x134)]['id']},'select':{'status':!![]}});if(!_0x3308fb||_0x3308fb[_0x316ec4(0x12f)]!=='ACTIVE')return _0x2df8d3[_0x316ec4(0x12f)](0x193)['json']({'success':![],'message':_0x316ec4(0x142),'suspended':_0x3308fb?.[_0x316ec4(0x12f)]===_0x316ec4(0x133)});_0x3313bb();}catch(_0x1f461f){return console['error']('Error\x20checking\x20account\x20status:',_0x1f461f),_0x2df8d3[_0x316ec4(0x12f)](0x1f4)[_0x316ec4(0x125)]({'success':![],'message':_0x316ec4(0x129)});}};exports['requireActiveShop']=requireActiveShop;