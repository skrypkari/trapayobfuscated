'use strict';const a15_0x647355=a15_0x20cb;(function(_0x49a749,_0x2e7120){const _0x359a72=a15_0x20cb,_0x2d7944=_0x49a749();while(!![]){try{const _0x1c5ef6=parseInt(_0x359a72(0xfa))/0x1+parseInt(_0x359a72(0xee))/0x2+parseInt(_0x359a72(0xfd))/0x3*(parseInt(_0x359a72(0xf6))/0x4)+parseInt(_0x359a72(0xe9))/0x5*(-parseInt(_0x359a72(0xef))/0x6)+-parseInt(_0x359a72(0x103))/0x7+-parseInt(_0x359a72(0xe7))/0x8*(parseInt(_0x359a72(0xfe))/0x9)+-parseInt(_0x359a72(0x106))/0xa*(-parseInt(_0x359a72(0xf5))/0xb);if(_0x1c5ef6===_0x2e7120)break;else _0x2d7944['push'](_0x2d7944['shift']());}catch(_0x58247f){_0x2d7944['push'](_0x2d7944['shift']());}}}(a15_0xefcd,0xac735));var __importDefault=this&&this['__importDefault']||function(_0x464861){const _0x289ab8=a15_0x20cb;return _0x464861&&_0x464861[_0x289ab8(0x107)]?_0x464861:{'default':_0x464861};};function a15_0x20cb(_0x328c5a,_0x237766){const _0xefcda4=a15_0xefcd();return a15_0x20cb=function(_0x20cb46,_0x46ea95){_0x20cb46=_0x20cb46-0xe6;let _0x47aeb6=_0xefcda4[_0x20cb46];return _0x47aeb6;},a15_0x20cb(_0x328c5a,_0x237766);}Object[a15_0x647355(0xfb)](exports,'__esModule',{'value':!![]}),exports[a15_0x647355(0xf8)]=exports[a15_0x647355(0xe6)]=exports[a15_0x647355(0xea)]=void 0x0;const jsonwebtoken_1=__importDefault(require(a15_0x647355(0xf4))),config_1=require(a15_0x647355(0xed)),tokenBlacklistService_1=require('../services/tokenBlacklistService'),authenticateToken=(_0x58dad2,_0x30b962,_0x29aa85)=>{const _0x108fb3=a15_0x647355,_0x297138=_0x58dad2[_0x108fb3(0x102)][_0x108fb3(0x105)],_0x45eb9d=_0x297138&&_0x297138['split']('\x20')[0x1];if(!_0x45eb9d)return _0x30b962['status'](0x191)[_0x108fb3(0xf7)]({'success':![],'message':_0x108fb3(0xeb)});if(tokenBlacklistService_1[_0x108fb3(0xe8)][_0x108fb3(0x101)](_0x45eb9d))return _0x30b962[_0x108fb3(0xfc)](0x191)[_0x108fb3(0xf7)]({'success':![],'message':'Token\x20has\x20been\x20revoked'});jsonwebtoken_1[_0x108fb3(0xf0)]['verify'](_0x45eb9d,config_1[_0x108fb3(0x104)][_0x108fb3(0x100)]['secret'],(_0x2513b2,_0x420662)=>{const _0x33a576=_0x108fb3;if(_0x2513b2)return _0x30b962[_0x33a576(0xfc)](0x193)['json']({'success':![],'message':'Invalid\x20or\x20expired\x20token'});_0x58dad2[_0x33a576(0xec)]=_0x420662,_0x58dad2[_0x33a576(0xf1)]=_0x45eb9d,_0x29aa85();});};exports['authenticateToken']=authenticateToken;function a15_0xefcd(){const _0x2c5143=['default','token','role','admin','jsonwebtoken','9912463sZAQhD','116oTTINv','json','requireShop','Admin\x20access\x20required','1293045ZYTVDN','defineProperty','status','52053bvDGHS','8487891rdYGcu','shop','jwt','isTokenBlacklisted','headers','3081932geipbA','config','authorization','10sxcCaG','__esModule','requireAdmin','8ozSPWv','tokenBlacklistService','881190zaFARy','authenticateToken','Access\x20token\x20required','user','../config/config','899606noLGyD','36XghpTz'];a15_0xefcd=function(){return _0x2c5143;};return a15_0xefcd();}const requireAdmin=(_0xba1b0d,_0x4db341,_0x1b79bf)=>{const _0x2654c1=a15_0x647355;if(!_0xba1b0d[_0x2654c1(0xec)]||_0xba1b0d[_0x2654c1(0xec)][_0x2654c1(0xf2)]!==_0x2654c1(0xf3))return _0x4db341[_0x2654c1(0xfc)](0x193)['json']({'success':![],'message':_0x2654c1(0xf9)});_0x1b79bf();};exports[a15_0x647355(0xe6)]=requireAdmin;const requireShop=(_0x19d6a1,_0x5d8117,_0x523856)=>{const _0x3e558d=a15_0x647355;if(!_0x19d6a1[_0x3e558d(0xec)]||_0x19d6a1['user'][_0x3e558d(0xf2)]!==_0x3e558d(0xff))return _0x5d8117['status'](0x193)[_0x3e558d(0xf7)]({'success':![],'message':'Shop\x20access\x20required'});_0x523856();};exports[a15_0x647355(0xf8)]=requireShop;