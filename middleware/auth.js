'use strict';const a17_0x4f54b8=a17_0x1dd3;(function(_0x205d20,_0x2fbc83){const _0xfc05f7=a17_0x1dd3,_0x22afab=_0x205d20();while(!![]){try{const _0x4f2d78=parseInt(_0xfc05f7(0x7f))/0x1*(-parseInt(_0xfc05f7(0x8b))/0x2)+-parseInt(_0xfc05f7(0x8e))/0x3*(-parseInt(_0xfc05f7(0x91))/0x4)+parseInt(_0xfc05f7(0x73))/0x5*(-parseInt(_0xfc05f7(0x78))/0x6)+parseInt(_0xfc05f7(0x8a))/0x7+-parseInt(_0xfc05f7(0x74))/0x8*(-parseInt(_0xfc05f7(0x87))/0x9)+parseInt(_0xfc05f7(0x8d))/0xa+parseInt(_0xfc05f7(0x93))/0xb*(-parseInt(_0xfc05f7(0x6e))/0xc);if(_0x4f2d78===_0x2fbc83)break;else _0x22afab['push'](_0x22afab['shift']());}catch(_0x4224b5){_0x22afab['push'](_0x22afab['shift']());}}}(a17_0x2825,0x3f922));var __importDefault=this&&this['__importDefault']||function(_0x308df4){const _0x1f0e06=a17_0x1dd3;return _0x308df4&&_0x308df4[_0x1f0e06(0x95)]?_0x308df4:{'default':_0x308df4};};Object[a17_0x4f54b8(0x81)](exports,'__esModule',{'value':!![]}),exports[a17_0x4f54b8(0x7c)]=exports[a17_0x4f54b8(0x80)]=exports[a17_0x4f54b8(0x99)]=exports[a17_0x4f54b8(0x83)]=void 0x0;function a17_0x2825(){const _0x1d0cc1=['headers','../config/database','12JsvSnO','Token\x20has\x20been\x20revoked','status','verify','requireActiveShop','tokenBlacklistService','error','354fAaohX','requireShop','defineProperty','jsonwebtoken','authenticateToken','Access\x20token\x20required','Error\x20checking\x20account\x20status','../config/config','622971winwmq','Shop\x20access\x20required','Admin\x20access\x20required','2941701HJgvWV','2758OoTiks','json','3137660AvGNZP','12IKhjzt','default','user','57436cghCwD','Error\x20checking\x20account\x20status:','1837SLCQAO','findUnique','__esModule','../services/tokenBlacklistService','secret','config','requireAdmin','SUSPENDED','16872RZkeZN','role','token','admin','shop','731560zqYOcL','56USQkdr','ACTIVE'];a17_0x2825=function(){return _0x1d0cc1;};return a17_0x2825();}const jsonwebtoken_1=__importDefault(require(a17_0x4f54b8(0x82))),config_1=require(a17_0x4f54b8(0x86)),tokenBlacklistService_1=require(a17_0x4f54b8(0x96)),authenticateToken=(_0x45367c,_0x43ab89,_0x56070e)=>{const _0x443b3d=a17_0x4f54b8,_0x4c59ae=_0x45367c[_0x443b3d(0x76)]['authorization'],_0x7e6833=_0x4c59ae&&_0x4c59ae['split']('\x20')[0x1];if(!_0x7e6833)return _0x43ab89[_0x443b3d(0x7a)](0x191)['json']({'success':![],'message':_0x443b3d(0x84)});if(tokenBlacklistService_1[_0x443b3d(0x7d)]['isTokenBlacklisted'](_0x7e6833))return _0x43ab89[_0x443b3d(0x7a)](0x191)[_0x443b3d(0x8c)]({'success':![],'message':_0x443b3d(0x79)});jsonwebtoken_1[_0x443b3d(0x8f)][_0x443b3d(0x7b)](_0x7e6833,config_1[_0x443b3d(0x98)]['jwt'][_0x443b3d(0x97)],(_0x9409f8,_0xe3399a)=>{const _0x10ed27=_0x443b3d;if(_0x9409f8)return _0x43ab89[_0x10ed27(0x7a)](0x193)[_0x10ed27(0x8c)]({'success':![],'message':'Invalid\x20or\x20expired\x20token'});_0x45367c[_0x10ed27(0x90)]=_0xe3399a,_0x45367c[_0x10ed27(0x70)]=_0x7e6833,_0x56070e();});};exports[a17_0x4f54b8(0x83)]=authenticateToken;const requireAdmin=(_0x34adfb,_0x3af2cb,_0x4f2d49)=>{const _0x2f1a37=a17_0x4f54b8;if(!_0x34adfb[_0x2f1a37(0x90)]||_0x34adfb[_0x2f1a37(0x90)]['role']!==_0x2f1a37(0x71))return _0x3af2cb['status'](0x193)[_0x2f1a37(0x8c)]({'success':![],'message':_0x2f1a37(0x89)});_0x4f2d49();};exports[a17_0x4f54b8(0x99)]=requireAdmin;const requireShop=(_0x4be7f1,_0x2e1d07,_0xd3553f)=>{const _0x57a2b0=a17_0x4f54b8;if(!_0x4be7f1[_0x57a2b0(0x90)]||_0x4be7f1[_0x57a2b0(0x90)][_0x57a2b0(0x6f)]!==_0x57a2b0(0x72))return _0x2e1d07[_0x57a2b0(0x7a)](0x193)['json']({'success':![],'message':_0x57a2b0(0x88)});_0xd3553f();};function a17_0x1dd3(_0x5dc7a2,_0x28e3dc){const _0x282544=a17_0x2825();return a17_0x1dd3=function(_0x1dd3f2,_0x5ab6b1){_0x1dd3f2=_0x1dd3f2-0x6e;let _0x187906=_0x282544[_0x1dd3f2];return _0x187906;},a17_0x1dd3(_0x5dc7a2,_0x28e3dc);}exports[a17_0x4f54b8(0x80)]=requireShop;const requireActiveShop=async(_0x1b4c77,_0x5ec48a,_0x58e690)=>{const _0x4748a9=a17_0x4f54b8;if(!_0x1b4c77[_0x4748a9(0x90)]||_0x1b4c77[_0x4748a9(0x90)][_0x4748a9(0x6f)]!=='shop')return _0x5ec48a['status'](0x193)[_0x4748a9(0x8c)]({'success':![],'message':'Shop\x20access\x20required'});try{const _0x46523a=require(_0x4748a9(0x77))[_0x4748a9(0x8f)],_0x30c3c7=await _0x46523a['shop'][_0x4748a9(0x94)]({'where':{'id':_0x1b4c77['user']['id']},'select':{'status':!![]}});if(!_0x30c3c7||_0x30c3c7[_0x4748a9(0x7a)]!==_0x4748a9(0x75))return _0x5ec48a[_0x4748a9(0x7a)](0x193)[_0x4748a9(0x8c)]({'success':![],'message':'Account\x20is\x20suspended\x20or\x20inactive.\x20Contact\x20administrator\x20to\x20activate\x20your\x20account.','suspended':_0x30c3c7?.['status']===_0x4748a9(0x9a)});_0x58e690();}catch(_0x195d33){return console[_0x4748a9(0x7e)](_0x4748a9(0x92),_0x195d33),_0x5ec48a['status'](0x1f4)[_0x4748a9(0x8c)]({'success':![],'message':_0x4748a9(0x85)});}};exports[a17_0x4f54b8(0x7c)]=requireActiveShop;