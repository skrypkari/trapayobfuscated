'use strict';const a18_0x4db714=a18_0xc782;(function(_0x1f0c8f,_0x31468b){const _0x4fe4c2=a18_0xc782,_0x3d8cc6=_0x1f0c8f();while(!![]){try{const _0x3653d5=-parseInt(_0x4fe4c2(0x86))/0x1+parseInt(_0x4fe4c2(0x77))/0x2+parseInt(_0x4fe4c2(0x9c))/0x3+-parseInt(_0x4fe4c2(0x84))/0x4+parseInt(_0x4fe4c2(0x9f))/0x5*(-parseInt(_0x4fe4c2(0x9d))/0x6)+parseInt(_0x4fe4c2(0x95))/0x7*(parseInt(_0x4fe4c2(0x93))/0x8)+-parseInt(_0x4fe4c2(0x89))/0x9*(-parseInt(_0x4fe4c2(0x9a))/0xa);if(_0x3653d5===_0x31468b)break;else _0x3d8cc6['push'](_0x3d8cc6['shift']());}catch(_0xcd6caa){_0x3d8cc6['push'](_0x3d8cc6['shift']());}}}(a18_0xb82d,0x2d433));var __importDefault=this&&this[a18_0x4db714(0x9e)]||function(_0x4643e2){const _0x363618=a18_0x4db714;return _0x4643e2&&_0x4643e2[_0x363618(0x7c)]?_0x4643e2:{'default':_0x4643e2};};Object[a18_0x4db714(0x8e)](exports,a18_0x4db714(0x7c),{'value':!![]}),exports[a18_0x4db714(0x81)]=exports['requireShop']=exports[a18_0x4db714(0x76)]=exports[a18_0x4db714(0x79)]=void 0x0;function a18_0xc782(_0x12243d,_0x35d8ee){const _0xb82d76=a18_0xb82d();return a18_0xc782=function(_0xc78296,_0x1430d3){_0xc78296=_0xc78296-0x74;let _0x31c58d=_0xb82d76[_0xc78296];return _0x31c58d;},a18_0xc782(_0x12243d,_0x35d8ee);}const jsonwebtoken_1=__importDefault(require(a18_0x4db714(0xa0))),config_1=require(a18_0x4db714(0x85)),tokenBlacklistService_1=require(a18_0x4db714(0x7f)),authenticateToken=(_0x41a776,_0x280a55,_0x598484)=>{const _0x5cfe76=a18_0x4db714,_0x599abb=_0x41a776['headers'][_0x5cfe76(0xa2)],_0x32624c=_0x599abb&&_0x599abb[_0x5cfe76(0x8d)]('\x20')[0x1];if(!_0x32624c)return _0x280a55[_0x5cfe76(0x92)](0x191)[_0x5cfe76(0x8c)]({'success':![],'message':_0x5cfe76(0x94)});if(tokenBlacklistService_1[_0x5cfe76(0x75)][_0x5cfe76(0x8b)](_0x32624c))return _0x280a55[_0x5cfe76(0x92)](0x191)[_0x5cfe76(0x8c)]({'success':![],'message':_0x5cfe76(0x80)});jsonwebtoken_1[_0x5cfe76(0x7a)][_0x5cfe76(0x97)](_0x32624c,config_1[_0x5cfe76(0x78)][_0x5cfe76(0x7e)][_0x5cfe76(0x7b)],(_0x232f72,_0x3ada95)=>{const _0xd22346=_0x5cfe76;if(_0x232f72)return _0x280a55['status'](0x193)[_0xd22346(0x8c)]({'success':![],'message':_0xd22346(0x90)});_0x41a776['user']=_0x3ada95,_0x41a776[_0xd22346(0x7d)]=_0x32624c,_0x598484();});};function a18_0xb82d(){const _0x4e4762=['requireActiveShop','user','error','345180osCtDc','../config/config','349952poLijZ','Shop\x20access\x20required','role','9rRxRCR','SUSPENDED','isTokenBlacklisted','json','split','defineProperty','../config/database','Invalid\x20or\x20expired\x20token','Account\x20is\x20suspended\x20or\x20inactive.\x20Contact\x20administrator\x20to\x20activate\x20your\x20account.','status','2922872aFjUYh','Access\x20token\x20required','7bJuwPO','requireShop','verify','findUnique','shop','2003810RFElnU','Error\x20checking\x20account\x20status','234975xSYQtY','1903662wHBMEh','__importDefault','5dWvNpu','jsonwebtoken','ACTIVE','authorization','Admin\x20access\x20required','tokenBlacklistService','requireAdmin','589708uRmnbu','config','authenticateToken','default','secret','__esModule','token','jwt','../services/tokenBlacklistService','Token\x20has\x20been\x20revoked'];a18_0xb82d=function(){return _0x4e4762;};return a18_0xb82d();}exports[a18_0x4db714(0x79)]=authenticateToken;const requireAdmin=(_0x3262be,_0x35be13,_0x4c1f66)=>{const _0x2f7c39=a18_0x4db714;if(!_0x3262be[_0x2f7c39(0x82)]||_0x3262be[_0x2f7c39(0x82)]['role']!=='admin')return _0x35be13[_0x2f7c39(0x92)](0x193)['json']({'success':![],'message':_0x2f7c39(0x74)});_0x4c1f66();};exports[a18_0x4db714(0x76)]=requireAdmin;const requireShop=(_0x5a56a9,_0x20e9d5,_0x31dc2c)=>{const _0x5d1037=a18_0x4db714;if(!_0x5a56a9[_0x5d1037(0x82)]||_0x5a56a9[_0x5d1037(0x82)][_0x5d1037(0x88)]!==_0x5d1037(0x99))return _0x20e9d5['status'](0x193)[_0x5d1037(0x8c)]({'success':![],'message':_0x5d1037(0x87)});_0x31dc2c();};exports[a18_0x4db714(0x96)]=requireShop;const requireActiveShop=async(_0x4a8f22,_0xeefc59,_0x2853fd)=>{const _0x4eb80b=a18_0x4db714;if(!_0x4a8f22['user']||_0x4a8f22['user']['role']!==_0x4eb80b(0x99))return _0xeefc59[_0x4eb80b(0x92)](0x193)[_0x4eb80b(0x8c)]({'success':![],'message':_0x4eb80b(0x87)});try{const _0x1fce43=require(_0x4eb80b(0x8f))['default'],_0x585245=await _0x1fce43[_0x4eb80b(0x99)][_0x4eb80b(0x98)]({'where':{'id':_0x4a8f22[_0x4eb80b(0x82)]['id']},'select':{'status':!![]}});if(!_0x585245||_0x585245[_0x4eb80b(0x92)]!==_0x4eb80b(0xa1))return _0xeefc59[_0x4eb80b(0x92)](0x193)['json']({'success':![],'message':_0x4eb80b(0x91),'suspended':_0x585245?.[_0x4eb80b(0x92)]===_0x4eb80b(0x8a)});_0x2853fd();}catch(_0x44ab94){return console[_0x4eb80b(0x83)]('Error\x20checking\x20account\x20status:',_0x44ab94),_0xeefc59[_0x4eb80b(0x92)](0x1f4)[_0x4eb80b(0x8c)]({'success':![],'message':_0x4eb80b(0x9b)});}};exports[a18_0x4db714(0x81)]=requireActiveShop;