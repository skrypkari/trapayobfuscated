'use strict';function a16_0x257e(_0x6eb6d8,_0x182f40){const _0x1d5977=a16_0x1d59();return a16_0x257e=function(_0x257eea,_0x187d19){_0x257eea=_0x257eea-0xda;let _0x1fd9b1=_0x1d5977[_0x257eea];return _0x1fd9b1;},a16_0x257e(_0x6eb6d8,_0x182f40);}const a16_0x3b1bb3=a16_0x257e;(function(_0x1d12ab,_0x4f919e){const _0x5a3c4=a16_0x257e,_0x26d556=_0x1d12ab();while(!![]){try{const _0x362ac6=parseInt(_0x5a3c4(0xdf))/0x1+-parseInt(_0x5a3c4(0xfa))/0x2+-parseInt(_0x5a3c4(0xec))/0x3*(-parseInt(_0x5a3c4(0xf3))/0x4)+-parseInt(_0x5a3c4(0xef))/0x5+parseInt(_0x5a3c4(0xdb))/0x6+parseInt(_0x5a3c4(0xe0))/0x7+parseInt(_0x5a3c4(0xf5))/0x8;if(_0x362ac6===_0x4f919e)break;else _0x26d556['push'](_0x26d556['shift']());}catch(_0x4967cb){_0x26d556['push'](_0x26d556['shift']());}}}(a16_0x1d59,0x6a428));function a16_0x1d59(){const _0x4873c8=['secret','authorization','14529GfpZNp','headers','config','2700515Cbmxtp','tokenBlacklistService','requireShop','__importDefault','36IjNlNv','Shop\x20access\x20required','9323296BHVAKM','__esModule','Access\x20token\x20required','Admin\x20access\x20required','isTokenBlacklisted','1673244iKnRMF','default','2826030RZkRBM','role','Token\x20has\x20been\x20revoked','requireAdmin','52841jugxOq','553840EJyPUY','token','user','split','authenticateToken','json','status','defineProperty','../config/config','shop'];a16_0x1d59=function(){return _0x4873c8;};return a16_0x1d59();}var __importDefault=this&&this[a16_0x3b1bb3(0xf2)]||function(_0x27ac27){const _0x45fe1b=a16_0x3b1bb3;return _0x27ac27&&_0x27ac27[_0x45fe1b(0xf6)]?_0x27ac27:{'default':_0x27ac27};};Object[a16_0x3b1bb3(0xe7)](exports,'__esModule',{'value':!![]}),exports['requireShop']=exports[a16_0x3b1bb3(0xde)]=exports['authenticateToken']=void 0x0;const jsonwebtoken_1=__importDefault(require('jsonwebtoken')),config_1=require(a16_0x3b1bb3(0xe8)),tokenBlacklistService_1=require('../services/tokenBlacklistService'),authenticateToken=(_0x346acb,_0x19585b,_0x27af4f)=>{const _0x1db5ca=a16_0x3b1bb3,_0x492e32=_0x346acb[_0x1db5ca(0xed)][_0x1db5ca(0xeb)],_0x2b02e0=_0x492e32&&_0x492e32[_0x1db5ca(0xe3)]('\x20')[0x1];if(!_0x2b02e0)return _0x19585b[_0x1db5ca(0xe6)](0x191)[_0x1db5ca(0xe5)]({'success':![],'message':_0x1db5ca(0xf7)});if(tokenBlacklistService_1[_0x1db5ca(0xf0)][_0x1db5ca(0xf9)](_0x2b02e0))return _0x19585b[_0x1db5ca(0xe6)](0x191)[_0x1db5ca(0xe5)]({'success':![],'message':_0x1db5ca(0xdd)});jsonwebtoken_1[_0x1db5ca(0xda)]['verify'](_0x2b02e0,config_1[_0x1db5ca(0xee)]['jwt'][_0x1db5ca(0xea)],(_0x4b0f9e,_0x350432)=>{const _0x5322da=_0x1db5ca;if(_0x4b0f9e)return _0x19585b[_0x5322da(0xe6)](0x193)['json']({'success':![],'message':'Invalid\x20or\x20expired\x20token'});_0x346acb[_0x5322da(0xe2)]=_0x350432,_0x346acb[_0x5322da(0xe1)]=_0x2b02e0,_0x27af4f();});};exports[a16_0x3b1bb3(0xe4)]=authenticateToken;const requireAdmin=(_0x46cceb,_0x2c7e63,_0x14d1e5)=>{const _0x121b01=a16_0x3b1bb3;if(!_0x46cceb[_0x121b01(0xe2)]||_0x46cceb['user'][_0x121b01(0xdc)]!=='admin')return _0x2c7e63[_0x121b01(0xe6)](0x193)[_0x121b01(0xe5)]({'success':![],'message':_0x121b01(0xf8)});_0x14d1e5();};exports[a16_0x3b1bb3(0xde)]=requireAdmin;const requireShop=(_0x57c137,_0x3313a9,_0x31c7dc)=>{const _0x1b1207=a16_0x3b1bb3;if(!_0x57c137[_0x1b1207(0xe2)]||_0x57c137[_0x1b1207(0xe2)][_0x1b1207(0xdc)]!==_0x1b1207(0xe9))return _0x3313a9[_0x1b1207(0xe6)](0x193)[_0x1b1207(0xe5)]({'success':![],'message':_0x1b1207(0xf4)});_0x31c7dc();};exports[a16_0x3b1bb3(0xf1)]=requireShop;