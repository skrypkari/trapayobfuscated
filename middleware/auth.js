'use strict';const a16_0x5879da=a16_0x231a;function a16_0x231a(_0x41b845,_0x311513){const _0x26819b=a16_0x2681();return a16_0x231a=function(_0x231ada,_0x47eb15){_0x231ada=_0x231ada-0xf6;let _0x4c740c=_0x26819b[_0x231ada];return _0x4c740c;},a16_0x231a(_0x41b845,_0x311513);}(function(_0x28ab08,_0x2ccd2b){const _0x3f0b54=a16_0x231a,_0x5bd3d0=_0x28ab08();while(!![]){try{const _0x39a63d=-parseInt(_0x3f0b54(0xfc))/0x1+-parseInt(_0x3f0b54(0x10e))/0x2*(parseInt(_0x3f0b54(0x105))/0x3)+parseInt(_0x3f0b54(0xf8))/0x4*(-parseInt(_0x3f0b54(0x10a))/0x5)+parseInt(_0x3f0b54(0x107))/0x6+-parseInt(_0x3f0b54(0x11b))/0x7*(parseInt(_0x3f0b54(0x116))/0x8)+parseInt(_0x3f0b54(0xf7))/0x9+-parseInt(_0x3f0b54(0x11f))/0xa*(-parseInt(_0x3f0b54(0xf6))/0xb);if(_0x39a63d===_0x2ccd2b)break;else _0x5bd3d0['push'](_0x5bd3d0['shift']());}catch(_0x482db3){_0x5bd3d0['push'](_0x5bd3d0['shift']());}}}(a16_0x2681,0x9df53));var __importDefault=this&&this[a16_0x5879da(0x10c)]||function(_0x44ac1d){const _0x4d07a8=a16_0x5879da;return _0x44ac1d&&_0x44ac1d[_0x4d07a8(0x101)]?_0x44ac1d:{'default':_0x44ac1d};};function a16_0x2681(){const _0x4e99e1=['findUnique','144151mQPHzp','Error\x20checking\x20account\x20status:','shop','requireShop','650IibjqR','Shop\x20access\x20required','config','Account\x20is\x20suspended\x20or\x20inactive.\x20Contact\x20administrator\x20to\x20activate\x20your\x20account.','defineProperty','446787KTcRPI','9971766WAghMh','447748UYuJOh','../config/config','authorization','user','567926eMdtRd','role','Token\x20has\x20been\x20revoked','verify','status','__esModule','../config/database','admin','ACTIVE','279LLCwyV','error','1813326jkNPwt','jwt','json','45BXeAGR','split','__importDefault','Invalid\x20or\x20expired\x20token','25582swWoOI','default','isTokenBlacklisted','Error\x20checking\x20account\x20status','authenticateToken','headers','requireActiveShop','tokenBlacklistService','248uiwjcu','secret','Admin\x20access\x20required','SUSPENDED'];a16_0x2681=function(){return _0x4e99e1;};return a16_0x2681();}Object[a16_0x5879da(0x123)](exports,a16_0x5879da(0x101),{'value':!![]}),exports[a16_0x5879da(0x114)]=exports[a16_0x5879da(0x11e)]=exports['requireAdmin']=exports[a16_0x5879da(0x112)]=void 0x0;const jsonwebtoken_1=__importDefault(require('jsonwebtoken')),config_1=require(a16_0x5879da(0xf9)),tokenBlacklistService_1=require('../services/tokenBlacklistService'),authenticateToken=(_0x1c4191,_0x32a85f,_0x9ad3fc)=>{const _0x1134ca=a16_0x5879da,_0x4aa32e=_0x1c4191[_0x1134ca(0x113)][_0x1134ca(0xfa)],_0x56d675=_0x4aa32e&&_0x4aa32e[_0x1134ca(0x10b)]('\x20')[0x1];if(!_0x56d675)return _0x32a85f[_0x1134ca(0x100)](0x191)[_0x1134ca(0x109)]({'success':![],'message':'Access\x20token\x20required'});if(tokenBlacklistService_1[_0x1134ca(0x115)][_0x1134ca(0x110)](_0x56d675))return _0x32a85f[_0x1134ca(0x100)](0x191)[_0x1134ca(0x109)]({'success':![],'message':_0x1134ca(0xfe)});jsonwebtoken_1[_0x1134ca(0x10f)][_0x1134ca(0xff)](_0x56d675,config_1[_0x1134ca(0x121)][_0x1134ca(0x108)][_0x1134ca(0x117)],(_0x4d8a45,_0x3e171f)=>{const _0x4a4cbe=_0x1134ca;if(_0x4d8a45)return _0x32a85f['status'](0x193)['json']({'success':![],'message':_0x4a4cbe(0x10d)});_0x1c4191[_0x4a4cbe(0xfb)]=_0x3e171f,_0x1c4191['token']=_0x56d675,_0x9ad3fc();});};exports[a16_0x5879da(0x112)]=authenticateToken;const requireAdmin=(_0x45233e,_0xdc0151,_0xeac25f)=>{const _0x59e8d5=a16_0x5879da;if(!_0x45233e['user']||_0x45233e[_0x59e8d5(0xfb)][_0x59e8d5(0xfd)]!==_0x59e8d5(0x103))return _0xdc0151['status'](0x193)['json']({'success':![],'message':_0x59e8d5(0x118)});_0xeac25f();};exports['requireAdmin']=requireAdmin;const requireShop=(_0x748855,_0x239dcf,_0x5a7e18)=>{const _0x3a23a8=a16_0x5879da;if(!_0x748855['user']||_0x748855[_0x3a23a8(0xfb)]['role']!==_0x3a23a8(0x11d))return _0x239dcf[_0x3a23a8(0x100)](0x193)[_0x3a23a8(0x109)]({'success':![],'message':'Shop\x20access\x20required'});_0x5a7e18();};exports[a16_0x5879da(0x11e)]=requireShop;const requireActiveShop=async(_0x2d4585,_0x2354e5,_0x419de0)=>{const _0x34d7a0=a16_0x5879da;if(!_0x2d4585['user']||_0x2d4585[_0x34d7a0(0xfb)][_0x34d7a0(0xfd)]!==_0x34d7a0(0x11d))return _0x2354e5['status'](0x193)[_0x34d7a0(0x109)]({'success':![],'message':_0x34d7a0(0x120)});try{const _0x3e712d=require(_0x34d7a0(0x102))[_0x34d7a0(0x10f)],_0x46e3ea=await _0x3e712d[_0x34d7a0(0x11d)][_0x34d7a0(0x11a)]({'where':{'id':_0x2d4585[_0x34d7a0(0xfb)]['id']},'select':{'status':!![]}});if(!_0x46e3ea||_0x46e3ea['status']!==_0x34d7a0(0x104))return _0x2354e5[_0x34d7a0(0x100)](0x193)['json']({'success':![],'message':_0x34d7a0(0x122),'suspended':_0x46e3ea?.[_0x34d7a0(0x100)]===_0x34d7a0(0x119)});_0x419de0();}catch(_0x5f5a07){return console[_0x34d7a0(0x106)](_0x34d7a0(0x11c),_0x5f5a07),_0x2354e5[_0x34d7a0(0x100)](0x1f4)[_0x34d7a0(0x109)]({'success':![],'message':_0x34d7a0(0x111)});}};exports['requireActiveShop']=requireActiveShop;