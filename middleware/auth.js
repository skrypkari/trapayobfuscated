'use strict';const a15_0x15045a=a15_0x29b5;(function(_0x378444,_0x4a59cd){const _0x3ca338=a15_0x29b5,_0x33d383=_0x378444();while(!![]){try{const _0x330f4e=parseInt(_0x3ca338(0x1f7))/0x1*(parseInt(_0x3ca338(0x1f5))/0x2)+-parseInt(_0x3ca338(0x1ff))/0x3*(parseInt(_0x3ca338(0x1f8))/0x4)+-parseInt(_0x3ca338(0x208))/0x5+parseInt(_0x3ca338(0x211))/0x6+-parseInt(_0x3ca338(0x201))/0x7*(-parseInt(_0x3ca338(0x1f9))/0x8)+-parseInt(_0x3ca338(0x20a))/0x9+parseInt(_0x3ca338(0x202))/0xa;if(_0x330f4e===_0x4a59cd)break;else _0x33d383['push'](_0x33d383['shift']());}catch(_0x43937e){_0x33d383['push'](_0x33d383['shift']());}}}(a15_0x63f7,0xe1dd6));function a15_0x29b5(_0x3edc7b,_0x1c4034){const _0x63f70d=a15_0x63f7();return a15_0x29b5=function(_0x29b5ff,_0x6f949a){_0x29b5ff=_0x29b5ff-0x1f0;let _0x279228=_0x63f70d[_0x29b5ff];return _0x279228;},a15_0x29b5(_0x3edc7b,_0x1c4034);}var __importDefault=this&&this['__importDefault']||function(_0x22e914){return _0x22e914&&_0x22e914['__esModule']?_0x22e914:{'default':_0x22e914};};function a15_0x63f7(){const _0x4a535d=['user','Shop\x20access\x20required','8759095jvfJHr','authenticateToken','12224889NDWYdh','Token\x20has\x20been\x20revoked','role','../services/tokenBlacklistService','default','isTokenBlacklisted','jwt','7399794iPmuzQ','split','tokenBlacklistService','requireAdmin','requireShop','config','admin','1641850yVJFtY','shop','2oJJJMo','596YfzAPW','8218936HMxhBt','secret','Invalid\x20or\x20expired\x20token','Admin\x20access\x20required','Access\x20token\x20required','headers','16698CtrPce','authorization','7RekRSM','9621000liaUgc','status','defineProperty','json'];a15_0x63f7=function(){return _0x4a535d;};return a15_0x63f7();}Object[a15_0x15045a(0x204)](exports,'__esModule',{'value':!![]}),exports[a15_0x15045a(0x1f2)]=exports[a15_0x15045a(0x1f1)]=exports[a15_0x15045a(0x209)]=void 0x0;const jsonwebtoken_1=__importDefault(require('jsonwebtoken')),config_1=require('../config/config'),tokenBlacklistService_1=require(a15_0x15045a(0x20d)),authenticateToken=(_0x4ac7bc,_0x4e92ee,_0x49a22e)=>{const _0x512379=a15_0x15045a,_0x1891cd=_0x4ac7bc[_0x512379(0x1fe)][_0x512379(0x200)],_0x32864a=_0x1891cd&&_0x1891cd[_0x512379(0x212)]('\x20')[0x1];if(!_0x32864a)return _0x4e92ee[_0x512379(0x203)](0x191)[_0x512379(0x205)]({'success':![],'message':_0x512379(0x1fd)});if(tokenBlacklistService_1[_0x512379(0x1f0)][_0x512379(0x20f)](_0x32864a))return _0x4e92ee['status'](0x191)[_0x512379(0x205)]({'success':![],'message':_0x512379(0x20b)});jsonwebtoken_1[_0x512379(0x20e)]['verify'](_0x32864a,config_1[_0x512379(0x1f3)][_0x512379(0x210)][_0x512379(0x1fa)],(_0x291cea,_0x49ce50)=>{const _0x1a0ee5=_0x512379;if(_0x291cea)return _0x4e92ee[_0x1a0ee5(0x203)](0x193)['json']({'success':![],'message':_0x1a0ee5(0x1fb)});_0x4ac7bc['user']=_0x49ce50,_0x4ac7bc['token']=_0x32864a,_0x49a22e();});};exports['authenticateToken']=authenticateToken;const requireAdmin=(_0x31a6c5,_0x204ef6,_0x138546)=>{const _0x1713bf=a15_0x15045a;if(!_0x31a6c5[_0x1713bf(0x206)]||_0x31a6c5[_0x1713bf(0x206)][_0x1713bf(0x20c)]!==_0x1713bf(0x1f4))return _0x204ef6[_0x1713bf(0x203)](0x193)[_0x1713bf(0x205)]({'success':![],'message':_0x1713bf(0x1fc)});_0x138546();};exports[a15_0x15045a(0x1f1)]=requireAdmin;const requireShop=(_0x38b232,_0x36f8cd,_0x4aed49)=>{const _0xeaad6=a15_0x15045a;if(!_0x38b232[_0xeaad6(0x206)]||_0x38b232[_0xeaad6(0x206)]['role']!==_0xeaad6(0x1f6))return _0x36f8cd[_0xeaad6(0x203)](0x193)['json']({'success':![],'message':_0xeaad6(0x207)});_0x4aed49();};exports[a15_0x15045a(0x1f2)]=requireShop;