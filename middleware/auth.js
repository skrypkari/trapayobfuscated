'use strict';const a21_0x27a333=a21_0x1f22;(function(_0x416f7c,_0x259ba7){const _0x31f31d=a21_0x1f22,_0x31527c=_0x416f7c();while(!![]){try{const _0x1448bc=parseInt(_0x31f31d(0x1ec))/0x1*(parseInt(_0x31f31d(0x1fd))/0x2)+-parseInt(_0x31f31d(0x1e2))/0x3+parseInt(_0x31f31d(0x1f3))/0x4*(-parseInt(_0x31f31d(0x1de))/0x5)+parseInt(_0x31f31d(0x1e4))/0x6*(parseInt(_0x31f31d(0x1f4))/0x7)+-parseInt(_0x31f31d(0x1d8))/0x8+-parseInt(_0x31f31d(0x1dd))/0x9*(parseInt(_0x31f31d(0x1f5))/0xa)+parseInt(_0x31f31d(0x1e5))/0xb*(parseInt(_0x31f31d(0x1f2))/0xc);if(_0x1448bc===_0x259ba7)break;else _0x31527c['push'](_0x31527c['shift']());}catch(_0x339453){_0x31527c['push'](_0x31527c['shift']());}}}(a21_0x2ffd,0x85b98));function a21_0x1f22(_0xe15e3d,_0x14ebbe){_0xe15e3d=_0xe15e3d-0x1d6;const _0x2ffd7c=a21_0x2ffd();let _0x1f2259=_0x2ffd7c[_0xe15e3d];return _0x1f2259;}var __importDefault=this&&this[a21_0x27a333(0x1ed)]||function(_0x494188){const _0x305ce7=a21_0x27a333;return _0x494188&&_0x494188[_0x305ce7(0x1f7)]?_0x494188:{'default':_0x494188};};Object['defineProperty'](exports,'__esModule',{'value':!![]}),exports[a21_0x27a333(0x1e8)]=exports[a21_0x27a333(0x201)]=exports[a21_0x27a333(0x1d9)]=exports['authenticateToken']=void 0x0;const jsonwebtoken_1=__importDefault(require(a21_0x27a333(0x1f0))),config_1=require(a21_0x27a333(0x1d7)),tokenBlacklistService_1=require(a21_0x27a333(0x1f1)),authenticateToken=(_0x512963,_0x1e6585,_0x523e76)=>{const _0x59b536=a21_0x27a333,_0x11d244=_0x512963[_0x59b536(0x200)][_0x59b536(0x1da)],_0x1bd9ca=_0x11d244&&_0x11d244['split']('\x20')[0x1];if(!_0x1bd9ca)return _0x1e6585[_0x59b536(0x1ea)](0x191)['json']({'success':![],'message':'Access\x20token\x20required'});if(tokenBlacklistService_1[_0x59b536(0x1ee)]['isTokenBlacklisted'](_0x1bd9ca))return _0x1e6585[_0x59b536(0x1ea)](0x191)[_0x59b536(0x1df)]({'success':![],'message':'Token\x20has\x20been\x20revoked'});jsonwebtoken_1['default'][_0x59b536(0x1d6)](_0x1bd9ca,config_1[_0x59b536(0x1ef)][_0x59b536(0x1fc)][_0x59b536(0x1dc)],(_0x5302fd,_0x2abfd9)=>{const _0x5e6b42=_0x59b536;if(_0x5302fd)return _0x1e6585[_0x5e6b42(0x1ea)](0x193)['json']({'success':![],'message':_0x5e6b42(0x1e9)});_0x512963['user']=_0x2abfd9,_0x512963['token']=_0x1bd9ca,_0x523e76();});};exports[a21_0x27a333(0x1e0)]=authenticateToken;function a21_0x2ffd(){const _0x2aae01=['11958IzdlMp','2234716xmFyWX','admin','Account\x20is\x20suspended\x20or\x20inactive.\x20Contact\x20administrator\x20to\x20activate\x20your\x20account.','requireActiveShop','Invalid\x20or\x20expired\x20token','status','Shop\x20access\x20required','1wWXzlE','__importDefault','tokenBlacklistService','config','jsonwebtoken','../services/tokenBlacklistService','96aZXvxQ','128648yUoEhj','868iyQXUW','3450xvvOel','role','__esModule','../config/database','ACTIVE','user','Admin\x20access\x20required','jwt','1806938VkiOIf','Error\x20checking\x20account\x20status','SUSPENDED','headers','requireShop','verify','../config/config','5069768iIisOC','requireAdmin','authorization','shop','secret','17739BgPkqo','10lejeWJ','json','authenticateToken','findUnique','2550219clSYTf','Error\x20checking\x20account\x20status:'];a21_0x2ffd=function(){return _0x2aae01;};return a21_0x2ffd();}const requireAdmin=(_0x17c0d6,_0x2e0a95,_0x4c24c0)=>{const _0x41548f=a21_0x27a333;if(!_0x17c0d6[_0x41548f(0x1fa)]||_0x17c0d6[_0x41548f(0x1fa)]['role']!==_0x41548f(0x1e6))return _0x2e0a95['status'](0x193)[_0x41548f(0x1df)]({'success':![],'message':_0x41548f(0x1fb)});_0x4c24c0();};exports[a21_0x27a333(0x1d9)]=requireAdmin;const requireShop=(_0x4ca7ef,_0x2430e0,_0x2efb64)=>{const _0x1116dc=a21_0x27a333;if(!_0x4ca7ef[_0x1116dc(0x1fa)]||_0x4ca7ef[_0x1116dc(0x1fa)][_0x1116dc(0x1f6)]!=='shop')return _0x2430e0[_0x1116dc(0x1ea)](0x193)[_0x1116dc(0x1df)]({'success':![],'message':_0x1116dc(0x1eb)});_0x2efb64();};exports[a21_0x27a333(0x201)]=requireShop;const requireActiveShop=async(_0x2af24f,_0x1bb4fa,_0x239777)=>{const _0x574454=a21_0x27a333;if(!_0x2af24f[_0x574454(0x1fa)]||_0x2af24f[_0x574454(0x1fa)][_0x574454(0x1f6)]!==_0x574454(0x1db))return _0x1bb4fa[_0x574454(0x1ea)](0x193)[_0x574454(0x1df)]({'success':![],'message':_0x574454(0x1eb)});try{const _0x2dcab7=require(_0x574454(0x1f8))['default'],_0x1c4803=await _0x2dcab7[_0x574454(0x1db)][_0x574454(0x1e1)]({'where':{'id':_0x2af24f[_0x574454(0x1fa)]['id']},'select':{'status':!![]}});if(!_0x1c4803||_0x1c4803[_0x574454(0x1ea)]!==_0x574454(0x1f9))return _0x1bb4fa[_0x574454(0x1ea)](0x193)[_0x574454(0x1df)]({'success':![],'message':_0x574454(0x1e7),'suspended':_0x1c4803?.[_0x574454(0x1ea)]===_0x574454(0x1ff)});_0x239777();}catch(_0x5274c1){return console['error'](_0x574454(0x1e3),_0x5274c1),_0x1bb4fa['status'](0x1f4)[_0x574454(0x1df)]({'success':![],'message':_0x574454(0x1fe)});}};exports[a21_0x27a333(0x1e8)]=requireActiveShop;