'use strict';function a18_0x5cfc(){const _0x4de689=['Access\x20token\x20required','__importDefault','__esModule','requireAdmin','25857320idJmRP','Account\x20is\x20suspended\x20or\x20inactive.\x20Contact\x20administrator\x20to\x20activate\x20your\x20account.','Admin\x20access\x20required','tokenBlacklistService','7790454jiJEsJ','2977086fIbKsX','2914954IfAQqK','user','split','Shop\x20access\x20required','requireShop','7115QdsWsM','config','verify','isTokenBlacklisted','error','Error\x20checking\x20account\x20status:','default','role','../config/config','requireActiveShop','ACTIVE','shop','status','json','token','486890PoosxL','secret','../config/database','786340jyVYTr','authenticateToken','authorization','defineProperty','SUSPENDED','../services/tokenBlacklistService','jwt','Error\x20checking\x20account\x20status','2156QfYBEi','Token\x20has\x20been\x20revoked'];a18_0x5cfc=function(){return _0x4de689;};return a18_0x5cfc();}const a18_0x2c6d8d=a18_0x9921;(function(_0x579789,_0xcc88cc){const _0x5c6d95=a18_0x9921,_0x37b570=_0x579789();while(!![]){try{const _0x34166c=-parseInt(_0x5c6d95(0xcd))/0x1+parseInt(_0x5c6d95(0xca))/0x2+-parseInt(_0x5c6d95(0xb5))/0x3+-parseInt(_0x5c6d95(0xd5))/0x4*(-parseInt(_0x5c6d95(0xbb))/0x5)+-parseInt(_0x5c6d95(0xb4))/0x6+-parseInt(_0x5c6d95(0xb6))/0x7+parseInt(_0x5c6d95(0xb0))/0x8;if(_0x34166c===_0xcc88cc)break;else _0x37b570['push'](_0x37b570['shift']());}catch(_0x5815db){_0x37b570['push'](_0x37b570['shift']());}}}(a18_0x5cfc,0xb6e12));var __importDefault=this&&this[a18_0x2c6d8d(0xd8)]||function(_0x1dc9f3){const _0x71a0f9=a18_0x2c6d8d;return _0x1dc9f3&&_0x1dc9f3[_0x71a0f9(0xd9)]?_0x1dc9f3:{'default':_0x1dc9f3};};function a18_0x9921(_0x4329b7,_0x1b056b){const _0x5cfc80=a18_0x5cfc();return a18_0x9921=function(_0x992177,_0x48487f){_0x992177=_0x992177-0xaf;let _0x382ac3=_0x5cfc80[_0x992177];return _0x382ac3;},a18_0x9921(_0x4329b7,_0x1b056b);}Object[a18_0x2c6d8d(0xd0)](exports,'__esModule',{'value':!![]}),exports['requireActiveShop']=exports[a18_0x2c6d8d(0xba)]=exports[a18_0x2c6d8d(0xaf)]=exports[a18_0x2c6d8d(0xce)]=void 0x0;const jsonwebtoken_1=__importDefault(require('jsonwebtoken')),config_1=require(a18_0x2c6d8d(0xc3)),tokenBlacklistService_1=require(a18_0x2c6d8d(0xd2)),authenticateToken=(_0x5c96b7,_0x51e558,_0x57109b)=>{const _0x37d4e7=a18_0x2c6d8d,_0xb7d5f2=_0x5c96b7['headers'][_0x37d4e7(0xcf)],_0x1613e3=_0xb7d5f2&&_0xb7d5f2[_0x37d4e7(0xb8)]('\x20')[0x1];if(!_0x1613e3)return _0x51e558[_0x37d4e7(0xc7)](0x191)[_0x37d4e7(0xc8)]({'success':![],'message':_0x37d4e7(0xd7)});if(tokenBlacklistService_1[_0x37d4e7(0xb3)][_0x37d4e7(0xbe)](_0x1613e3))return _0x51e558[_0x37d4e7(0xc7)](0x191)[_0x37d4e7(0xc8)]({'success':![],'message':_0x37d4e7(0xd6)});jsonwebtoken_1[_0x37d4e7(0xc1)][_0x37d4e7(0xbd)](_0x1613e3,config_1[_0x37d4e7(0xbc)][_0x37d4e7(0xd3)][_0x37d4e7(0xcb)],(_0x3b3044,_0x283fb)=>{const _0x14cbd0=_0x37d4e7;if(_0x3b3044)return _0x51e558[_0x14cbd0(0xc7)](0x193)[_0x14cbd0(0xc8)]({'success':![],'message':'Invalid\x20or\x20expired\x20token'});_0x5c96b7[_0x14cbd0(0xb7)]=_0x283fb,_0x5c96b7[_0x14cbd0(0xc9)]=_0x1613e3,_0x57109b();});};exports['authenticateToken']=authenticateToken;const requireAdmin=(_0x195a07,_0x334529,_0x5e5327)=>{const _0x1c394a=a18_0x2c6d8d;if(!_0x195a07[_0x1c394a(0xb7)]||_0x195a07[_0x1c394a(0xb7)][_0x1c394a(0xc2)]!=='admin')return _0x334529['status'](0x193)[_0x1c394a(0xc8)]({'success':![],'message':_0x1c394a(0xb2)});_0x5e5327();};exports['requireAdmin']=requireAdmin;const requireShop=(_0x74a7a4,_0x4fb939,_0x3a9e94)=>{const _0x269ea0=a18_0x2c6d8d;if(!_0x74a7a4['user']||_0x74a7a4[_0x269ea0(0xb7)]['role']!=='shop')return _0x4fb939[_0x269ea0(0xc7)](0x193)[_0x269ea0(0xc8)]({'success':![],'message':_0x269ea0(0xb9)});_0x3a9e94();};exports[a18_0x2c6d8d(0xba)]=requireShop;const requireActiveShop=async(_0x1b688a,_0x54c5d1,_0x240a02)=>{const _0xdea33a=a18_0x2c6d8d;if(!_0x1b688a[_0xdea33a(0xb7)]||_0x1b688a[_0xdea33a(0xb7)][_0xdea33a(0xc2)]!==_0xdea33a(0xc6))return _0x54c5d1[_0xdea33a(0xc7)](0x193)[_0xdea33a(0xc8)]({'success':![],'message':'Shop\x20access\x20required'});try{const _0x2a7693=require(_0xdea33a(0xcc))[_0xdea33a(0xc1)],_0x59ce56=await _0x2a7693[_0xdea33a(0xc6)]['findUnique']({'where':{'id':_0x1b688a[_0xdea33a(0xb7)]['id']},'select':{'status':!![]}});if(!_0x59ce56||_0x59ce56[_0xdea33a(0xc7)]!==_0xdea33a(0xc5))return _0x54c5d1[_0xdea33a(0xc7)](0x193)[_0xdea33a(0xc8)]({'success':![],'message':_0xdea33a(0xb1),'suspended':_0x59ce56?.[_0xdea33a(0xc7)]===_0xdea33a(0xd1)});_0x240a02();}catch(_0x47c530){return console[_0xdea33a(0xbf)](_0xdea33a(0xc0),_0x47c530),_0x54c5d1[_0xdea33a(0xc7)](0x1f4)['json']({'success':![],'message':_0xdea33a(0xd4)});}};exports[a18_0x2c6d8d(0xc4)]=requireActiveShop;