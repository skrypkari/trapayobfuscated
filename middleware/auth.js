'use strict';const a15_0x56099b=a15_0x3e8c;function a15_0x3e8c(_0x1ec382,_0x4e5774){const _0x5e6e94=a15_0x5e6e();return a15_0x3e8c=function(_0x3e8c70,_0x20fdcc){_0x3e8c70=_0x3e8c70-0xa5;let _0x1e2770=_0x5e6e94[_0x3e8c70];return _0x1e2770;},a15_0x3e8c(_0x1ec382,_0x4e5774);}(function(_0x5000dd,_0x11a108){const _0x57b409=a15_0x3e8c,_0x7ce1bf=_0x5000dd();while(!![]){try{const _0x1b3f62=-parseInt(_0x57b409(0xb3))/0x1*(-parseInt(_0x57b409(0xbc))/0x2)+parseInt(_0x57b409(0xc0))/0x3+parseInt(_0x57b409(0xb4))/0x4*(parseInt(_0x57b409(0xa7))/0x5)+-parseInt(_0x57b409(0xac))/0x6+-parseInt(_0x57b409(0xb2))/0x7+parseInt(_0x57b409(0xb1))/0x8*(parseInt(_0x57b409(0xbf))/0x9)+parseInt(_0x57b409(0xa6))/0xa;if(_0x1b3f62===_0x11a108)break;else _0x7ce1bf['push'](_0x7ce1bf['shift']());}catch(_0x27ed1c){_0x7ce1bf['push'](_0x7ce1bf['shift']());}}}(a15_0x5e6e,0xc85c9));var __importDefault=this&&this[a15_0x56099b(0xc1)]||function(_0x254767){const _0x496f03=a15_0x56099b;return _0x254767&&_0x254767[_0x496f03(0xbe)]?_0x254767:{'default':_0x254767};};Object['defineProperty'](exports,a15_0x56099b(0xbe),{'value':!![]}),exports[a15_0x56099b(0xb0)]=exports['requireAdmin']=exports[a15_0x56099b(0xbd)]=void 0x0;const jsonwebtoken_1=__importDefault(require('jsonwebtoken')),config_1=require('../config/config'),tokenBlacklistService_1=require(a15_0x56099b(0xaf)),authenticateToken=(_0x24993e,_0x5bc533,_0x1c55e6)=>{const _0x48ff0e=a15_0x56099b,_0x118ad4=_0x24993e[_0x48ff0e(0xc4)][_0x48ff0e(0xbb)],_0x2a84b7=_0x118ad4&&_0x118ad4[_0x48ff0e(0xad)]('\x20')[0x1];if(!_0x2a84b7)return _0x5bc533[_0x48ff0e(0xab)](0x191)[_0x48ff0e(0xc2)]({'success':![],'message':_0x48ff0e(0xa8)});if(tokenBlacklistService_1['tokenBlacklistService'][_0x48ff0e(0xc5)](_0x2a84b7))return _0x5bc533['status'](0x191)[_0x48ff0e(0xc2)]({'success':![],'message':'Token\x20has\x20been\x20revoked'});jsonwebtoken_1[_0x48ff0e(0xb6)][_0x48ff0e(0xb8)](_0x2a84b7,config_1['config'][_0x48ff0e(0xa9)][_0x48ff0e(0xb5)],(_0x4596a1,_0x3bc8a6)=>{const _0xcc2952=_0x48ff0e;if(_0x4596a1)return _0x5bc533[_0xcc2952(0xab)](0x193)['json']({'success':![],'message':_0xcc2952(0xa5)});_0x24993e[_0xcc2952(0xaa)]=_0x3bc8a6,_0x24993e[_0xcc2952(0xae)]=_0x2a84b7,_0x1c55e6();});};exports[a15_0x56099b(0xbd)]=authenticateToken;const requireAdmin=(_0x2cefb1,_0x272162,_0x5c6947)=>{const _0x4cab2a=a15_0x56099b;if(!_0x2cefb1[_0x4cab2a(0xaa)]||_0x2cefb1[_0x4cab2a(0xaa)][_0x4cab2a(0xc3)]!==_0x4cab2a(0xb7))return _0x272162[_0x4cab2a(0xab)](0x193)['json']({'success':![],'message':'Admin\x20access\x20required'});_0x5c6947();};exports[a15_0x56099b(0xba)]=requireAdmin;function a15_0x5e6e(){const _0x49b506=['Access\x20token\x20required','jwt','user','status','8203644dDKZzf','split','token','../services/tokenBlacklistService','requireShop','56PNduuL','1449987cDLfAg','1zhQoUU','476lymymZ','secret','default','admin','verify','shop','requireAdmin','authorization','2864634ffoCdQ','authenticateToken','__esModule','667521XvqylF','554253yECzYy','__importDefault','json','role','headers','isTokenBlacklisted','Shop\x20access\x20required','Invalid\x20or\x20expired\x20token','502380IhnWRh','8765mdvhUI'];a15_0x5e6e=function(){return _0x49b506;};return a15_0x5e6e();}const requireShop=(_0xabab61,_0x606d86,_0x23c842)=>{const _0x1d5831=a15_0x56099b;if(!_0xabab61[_0x1d5831(0xaa)]||_0xabab61[_0x1d5831(0xaa)][_0x1d5831(0xc3)]!==_0x1d5831(0xb9))return _0x606d86[_0x1d5831(0xab)](0x193)[_0x1d5831(0xc2)]({'success':![],'message':_0x1d5831(0xc6)});_0x23c842();};exports['requireShop']=requireShop;