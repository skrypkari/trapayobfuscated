'use strict';const a37_0x37e2f2=a37_0x108c;(function(_0x2be88c,_0x52e05a){const _0x4f04b7=a37_0x108c,_0x1ffa61=_0x2be88c();while(!![]){try{const _0x35828a=-parseInt(_0x4f04b7(0x179))/0x1+parseInt(_0x4f04b7(0x18d))/0x2+parseInt(_0x4f04b7(0xfa))/0x3+parseInt(_0x4f04b7(0x144))/0x4*(parseInt(_0x4f04b7(0xc0))/0x5)+parseInt(_0x4f04b7(0xe2))/0x6+-parseInt(_0x4f04b7(0x16e))/0x7*(parseInt(_0x4f04b7(0x149))/0x8)+-parseInt(_0x4f04b7(0x19f))/0x9*(parseInt(_0x4f04b7(0xe7))/0xa);if(_0x35828a===_0x52e05a)break;else _0x1ffa61['push'](_0x1ffa61['shift']());}catch(_0xce5c48){_0x1ffa61['push'](_0x1ffa61['shift']());}}}(a37_0x36f4,0x5a6c7));var __createBinding=this&&this['__createBinding']||(Object[a37_0x37e2f2(0x137)]?function(_0x1534b7,_0x8b255c,_0x4a11cc,_0x3508b4){const _0x61dde2=a37_0x37e2f2;if(_0x3508b4===undefined)_0x3508b4=_0x4a11cc;var _0x40fe8a=Object['getOwnPropertyDescriptor'](_0x8b255c,_0x4a11cc);(!_0x40fe8a||('get'in _0x40fe8a?!_0x8b255c[_0x61dde2(0xdb)]:_0x40fe8a['writable']||_0x40fe8a[_0x61dde2(0x19c)]))&&(_0x40fe8a={'enumerable':!![],'get':function(){return _0x8b255c[_0x4a11cc];}}),Object[_0x61dde2(0xee)](_0x1534b7,_0x3508b4,_0x40fe8a);}:function(_0x2249e3,_0x334b6b,_0xb4140e,_0x3083d7){if(_0x3083d7===undefined)_0x3083d7=_0xb4140e;_0x2249e3[_0x3083d7]=_0x334b6b[_0xb4140e];}),__setModuleDefault=this&&this['__setModuleDefault']||(Object[a37_0x37e2f2(0x137)]?function(_0xc0e6b8,_0x55adc7){const _0x2195b2=a37_0x37e2f2;Object[_0x2195b2(0xee)](_0xc0e6b8,_0x2195b2(0x114),{'enumerable':!![],'value':_0x55adc7});}:function(_0x364961,_0x4599dd){const _0x4c8b08=a37_0x37e2f2;_0x364961[_0x4c8b08(0x114)]=_0x4599dd;}),__importStar=this&&this[a37_0x37e2f2(0x19b)]||(function(){var _0xd40a89=function(_0x4b61e4){const _0x5d8fbb=a37_0x108c;return _0xd40a89=Object[_0x5d8fbb(0x115)]||function(_0x44acc4){const _0x290f4b=_0x5d8fbb;var _0x129764=[];for(var _0x4dbd1b in _0x44acc4)if(Object[_0x290f4b(0x18f)][_0x290f4b(0x18e)][_0x290f4b(0xda)](_0x44acc4,_0x4dbd1b))_0x129764[_0x129764[_0x290f4b(0x100)]]=_0x4dbd1b;return _0x129764;},_0xd40a89(_0x4b61e4);};return function(_0x5137a5){const _0x1e3177=a37_0x108c;if(_0x5137a5&&_0x5137a5['__esModule'])return _0x5137a5;var _0x24d2e9={};if(_0x5137a5!=null){for(var _0x5a56ae=_0xd40a89(_0x5137a5),_0x3334a7=0x0;_0x3334a7<_0x5a56ae['length'];_0x3334a7++)if(_0x5a56ae[_0x3334a7]!==_0x1e3177(0x114))__createBinding(_0x24d2e9,_0x5137a5,_0x5a56ae[_0x3334a7]);}return __setModuleDefault(_0x24d2e9,_0x5137a5),_0x24d2e9;};}()),__importDefault=this&&this[a37_0x37e2f2(0x1a2)]||function(_0x2b0b6e){const _0x10efd6=a37_0x37e2f2;return _0x2b0b6e&&_0x2b0b6e[_0x10efd6(0xdb)]?_0x2b0b6e:{'default':_0x2b0b6e};};Object[a37_0x37e2f2(0xee)](exports,a37_0x37e2f2(0xdb),{'value':!![]}),exports[a37_0x37e2f2(0xd4)]=exports['CoinToPayStatusService']=void 0x0;const coinToPayService_1=require('./gateways/coinToPayService'),database_1=__importDefault(require(a37_0x37e2f2(0x10a))),telegramBotService_1=require(a37_0x37e2f2(0x180)),loggerService_1=require(a37_0x37e2f2(0xbe));function a37_0x108c(_0x41d05a,_0x41aaff){const _0x36f483=a37_0x36f4();return a37_0x108c=function(_0x108ced,_0x3be81c){_0x108ced=_0x108ced-0xbd;let _0x34c375=_0x36f483[_0x108ced];return _0x34c375;},a37_0x108c(_0x41d05a,_0x41aaff);}class CoinToPayStatusService{constructor(){const _0x146e3e=a37_0x37e2f2;this[_0x146e3e(0xe3)]=null,this['GLOBAL_CHECK_INTERVAL_MS']=0x3c*0x3c*0x3e8,this['EXPIRY_DAYS']=0x5,this['paymentTimers']=new Map(),this[_0x146e3e(0x139)]=new coinToPayService_1[(_0x146e3e(0x131))](),console[_0x146e3e(0xf9)](_0x146e3e(0x191));}['schedulePaymentChecks'](_0x1f70a6,_0x41ddf1){const _0x4b8a11=a37_0x37e2f2;console[_0x4b8a11(0xf9)](_0x4b8a11(0x168)),console[_0x4b8a11(0xf9)](_0x4b8a11(0x106)+_0x1f70a6),console[_0x4b8a11(0xf9)](_0x4b8a11(0x118)+_0x41ddf1),this[_0x4b8a11(0xc1)](_0x1f70a6);const _0x17b5e7=[],_0x5a2c5d=new Date(),_0x1c99db=[{'delay':0x1*0x3c*0x3e8,'description':_0x4b8a11(0x13a)},{'delay':0x2*0x3c*0x3e8,'description':'2\x20minutes'},{'delay':0x5*0x3c*0x3e8,'description':_0x4b8a11(0x171)},{'delay':0x5*0x3c*0x3e8,'description':_0x4b8a11(0x171)}];console[_0x4b8a11(0xf9)](_0x4b8a11(0x1a1)+_0x1c99db[_0x4b8a11(0x100)]+_0x4b8a11(0x172)+_0x1f70a6);let _0xc19cbf=0x0;_0x1c99db['forEach']((_0x2cbfae,_0x59feb3)=>{const _0x276e22=_0x4b8a11;_0xc19cbf+=_0x2cbfae[_0x276e22(0x174)];const _0x2e5c67=setTimeout(async()=>{const _0x543406=_0x276e22;console[_0x543406(0xf9)](_0x543406(0x199)+(_0x59feb3+0x1)+_0x543406(0xf8)+_0x1f70a6+_0x543406(0xc2)+_0x2cbfae['description']+')');try{await this[_0x543406(0x160)](_0x1f70a6),console[_0x543406(0xf9)](_0x543406(0x19a)+(_0x59feb3+0x1)+_0x543406(0x13d)+_0x1f70a6);}catch(_0x1c2019){console[_0x543406(0xd6)](_0x543406(0xcc)+(_0x59feb3+0x1)+'\x20for\x20payment\x20'+_0x1f70a6+':',_0x1c2019),this['logCoinToPayError'](_0x1f70a6,_0x41ddf1,_0x1c2019,'status_check',{'checkNumber':_0x59feb3+0x1,'scheduledAfter':_0x2cbfae[_0x543406(0x119)],'isIndividualCheck':!![]});}},_0xc19cbf);_0x17b5e7[_0x276e22(0x188)](_0x2e5c67),console['log'](_0x276e22(0x182)+(_0x59feb3+0x1)+'\x20for\x20payment\x20'+_0x1f70a6+_0x276e22(0xe8)+_0xc19cbf/0x3e8+_0x276e22(0x12c)+_0x2cbfae['description']+')');});const _0x34b845=setInterval(async()=>{const _0x399229=_0x4b8a11;console[_0x399229(0xf9)](_0x399229(0x17b)+_0x1f70a6);try{const _0x4a48c2=await database_1[_0x399229(0x114)]['payment']['findUnique']({'where':{'id':_0x1f70a6},'select':{'id':!![],'status':!![],'createdAt':!![],'gatewayPaymentId':!![]}});if(!_0x4a48c2){console['log'](_0x399229(0xe6)+_0x1f70a6+_0x399229(0x134)),this['clearPaymentTimers'](_0x1f70a6);return;}console[_0x399229(0xf9)](_0x399229(0xe0)+_0x1f70a6+'\x20current\x20status:\x20'+_0x4a48c2[_0x399229(0x13f)]);if(_0x4a48c2[_0x399229(0x13f)]!==_0x399229(0xd7)){console[_0x399229(0xf9)](_0x399229(0x116)+_0x1f70a6+_0x399229(0x10d)+_0x4a48c2[_0x399229(0x13f)]+_0x399229(0x1a3)),this[_0x399229(0xc1)](_0x1f70a6);return;}const _0x179e34=Math['floor']((Date['now']()-_0x4a48c2['createdAt'][_0x399229(0x1a7)]())/(0x3e8*0x3c*0x3c*0x18));if(_0x179e34>=this['EXPIRY_DAYS']){console[_0x399229(0xf9)](_0x399229(0x12b)+_0x1f70a6+_0x399229(0x195)+this[_0x399229(0x1ad)]+'\x20days,\x20will\x20be\x20handled\x20by\x20global\x20expiry\x20check'),this[_0x399229(0xc1)](_0x1f70a6);return;}await this['checkSinglePaymentById'](_0x1f70a6),console['log']('‚úÖ\x20[HOURLY]\x20Hourly\x20check\x20completed\x20for\x20payment\x20'+_0x1f70a6);}catch(_0x4b837e){console[_0x399229(0xd6)](_0x399229(0x189)+_0x1f70a6+':',_0x4b837e),this[_0x399229(0x156)](_0x1f70a6,_0x41ddf1,_0x4b837e,_0x399229(0x198),{'isHourlyCheck':!![],'isIndividualCheck':!![]});}},0x3c*0x3c*0x3e8);_0x17b5e7['push'](_0x34b845),this[_0x4b8a11(0xc9)][_0x4b8a11(0x11e)](_0x1f70a6,{'timers':_0x17b5e7,'paymentId':_0x1f70a6,'gatewayPaymentId':_0x41ddf1,'createdAt':_0x5a2c5d}),console[_0x4b8a11(0xf9)](_0x4b8a11(0x147)+_0x1c99db[_0x4b8a11(0x100)]+'\x20initial\x20checks\x20+\x20hourly\x20checks\x20for\x20payment\x20'+_0x1f70a6),console['log']('üìä\x20[DEBUG]\x20Total\x20active\x20payment\x20timers:\x20'+this[_0x4b8a11(0xc9)][_0x4b8a11(0xde)]),this['logCoinToPayStatus'](_0x1f70a6,_0x41ddf1,_0x4b8a11(0xd7),_0x4b8a11(0xd7),_0x4b8a11(0x198),{'action':_0x4b8a11(0xfe),'scheduledChecks':_0x1c99db[_0x4b8a11(0x100)],'firstCheckIn':_0x1c99db[0x0][_0x4b8a11(0x174)]/0x3e8,'totalTimers':this[_0x4b8a11(0xc9)][_0x4b8a11(0xde)]});}[a37_0x37e2f2(0xc1)](_0x364181){const _0x464e9c=a37_0x37e2f2,_0x372c41=this[_0x464e9c(0xc9)][_0x464e9c(0x145)](_0x364181);_0x372c41?(console[_0x464e9c(0xf9)](_0x464e9c(0x152)+_0x372c41[_0x464e9c(0x153)][_0x464e9c(0x100)]+'\x20timers\x20for\x20payment\x20'+_0x364181),_0x372c41[_0x464e9c(0x153)]['forEach']((_0x260b20,_0x2d1e3d)=>{const _0x30b286=_0x464e9c;_0x260b20&&(clearTimeout(_0x260b20),clearInterval(_0x260b20),console['log']('üßπ\x20[DEBUG]\x20Cleared\x20timer\x20#'+(_0x2d1e3d+0x1)+_0x30b286(0xca)+_0x364181));}),this[_0x464e9c(0xc9)][_0x464e9c(0x10f)](_0x364181),console[_0x464e9c(0xf9)](_0x464e9c(0x11d)+_0x364181+_0x464e9c(0x129)+this['paymentTimers'][_0x464e9c(0xde)])):console[_0x464e9c(0xf9)](_0x464e9c(0x16d)+_0x364181+'\x20to\x20clear');}async[a37_0x37e2f2(0x160)](_0x3b2b9c){const _0x2a6e04=a37_0x37e2f2;console['log'](_0x2a6e04(0x192)+_0x3b2b9c);const _0xaf93ba=await database_1[_0x2a6e04(0x114)][_0x2a6e04(0x17e)][_0x2a6e04(0x14b)]({'where':{'id':_0x3b2b9c},'select':{'id':!![],'gatewayPaymentId':!![],'amount':!![],'currency':!![],'status':!![],'shopId':!![],'createdAt':!![],'gateway':!![],'shop':{'select':{'id':!![],'name':!![],'settings':{'select':{'webhookUrl':!![],'webhookEvents':!![]}}}}}});if(!_0xaf93ba){console['log'](_0x2a6e04(0x121)+_0x3b2b9c+_0x2a6e04(0x11f));return;}console[_0x2a6e04(0xf9)](_0x2a6e04(0x15b)+_0x3b2b9c+_0x2a6e04(0x197)),console['log'](_0x2a6e04(0xe1)+_0xaf93ba['gateway']),console[_0x2a6e04(0xf9)](_0x2a6e04(0xea)+_0xaf93ba[_0x2a6e04(0x13f)]),console[_0x2a6e04(0xf9)](_0x2a6e04(0x170)+_0xaf93ba['gatewayPaymentId']),console['log'](_0x2a6e04(0x17d)+_0xaf93ba['amount']+'\x20'+_0xaf93ba[_0x2a6e04(0x162)]),console[_0x2a6e04(0xf9)](_0x2a6e04(0x104)+_0xaf93ba['shopId']);if(_0xaf93ba[_0x2a6e04(0xeb)]!==_0x2a6e04(0x178)){console[_0x2a6e04(0xf9)]('‚ö†Ô∏è\x20[CHECK]\x20Payment\x20'+_0x3b2b9c+'\x20is\x20not\x20a\x20CoinToPay\x20payment\x20(gateway:\x20'+_0xaf93ba[_0x2a6e04(0xeb)]+')');return;}if(_0xaf93ba[_0x2a6e04(0x13f)]!=='PENDING'){console[_0x2a6e04(0xf9)](_0x2a6e04(0x159)+_0x3b2b9c+_0x2a6e04(0x10d)+_0xaf93ba[_0x2a6e04(0x13f)]+_0x2a6e04(0x1a3)),this[_0x2a6e04(0xc1)](_0x3b2b9c);return;}if(!_0xaf93ba[_0x2a6e04(0xf3)]){console[_0x2a6e04(0xf9)](_0x2a6e04(0x159)+_0x3b2b9c+_0x2a6e04(0x10c));return;}console['log']('‚úÖ\x20[CHECK]\x20Payment\x20'+_0x3b2b9c+'\x20is\x20valid\x20for\x20checking,\x20proceeding...'),await this[_0x2a6e04(0x166)](_0xaf93ba);}[a37_0x37e2f2(0xcb)](_0x5a1d27,_0x5b6037,_0x20f361,_0x142dc0,_0x5cb021,_0x127bef){const _0x23ddae=a37_0x37e2f2,_0x2dbd81={'type':'COINTOPAY_STATUS_CHANGE','paymentId':_0x5a1d27,'gatewayPaymentId':_0x5b6037,'oldStatus':_0x20f361,'newStatus':_0x142dc0,'source':_0x5cb021,'timestamp':new Date()['toISOString'](),'details':_0x127bef||{}};loggerService_1[_0x23ddae(0x17f)][_0x23ddae(0xcb)](_0x2dbd81),console[_0x23ddae(0xf9)](_0x23ddae(0x14e)+_0x5a1d27+'\x20('+_0x5b6037+')'),console['log']('\x20\x20\x20üìä\x20Status:\x20'+_0x20f361+_0x23ddae(0x17a)+_0x142dc0),console[_0x23ddae(0xf9)]('\x20\x20\x20üìç\x20Source:\x20'+_0x5cb021),console[_0x23ddae(0xf9)](_0x23ddae(0x11b)+_0x2dbd81[_0x23ddae(0xc3)]),_0x127bef&&console['log'](_0x23ddae(0x12d),_0x127bef);}[a37_0x37e2f2(0x156)](_0x548e19,_0x2cf7b9,_0x7a378a,_0x58f101,_0x3b539e){const _0x55f0a3=a37_0x37e2f2,_0x19df02={'type':_0x55f0a3(0x1a4),'paymentId':_0x548e19,'gatewayPaymentId':_0x2cf7b9,'error':_0x7a378a instanceof Error?{'message':_0x7a378a['message'],'stack':_0x7a378a[_0x55f0a3(0x194)]}:_0x7a378a,'source':_0x58f101,'timestamp':new Date()[_0x55f0a3(0x151)](),'context':_0x3b539e||{}};loggerService_1[_0x55f0a3(0x17f)][_0x55f0a3(0x156)](_0x19df02),console[_0x55f0a3(0xd6)](_0x55f0a3(0x105)+_0x548e19+'\x20('+_0x2cf7b9+')'),console[_0x55f0a3(0xd6)](_0x55f0a3(0x132)+(_0x7a378a instanceof Error?_0x7a378a[_0x55f0a3(0x141)]:_0x7a378a)),console[_0x55f0a3(0xd6)](_0x55f0a3(0x190)+_0x58f101),console[_0x55f0a3(0xd6)](_0x55f0a3(0x11b)+_0x19df02[_0x55f0a3(0xc3)]),_0x3b539e&&console[_0x55f0a3(0xd6)]('\x20\x20\x20üìù\x20Context:',_0x3b539e);}[a37_0x37e2f2(0x181)](){const _0x3179d0=a37_0x37e2f2;console['log']('ü™ô\x20[INIT]\x20Starting\x20CoinToPay\x20periodic\x20status\x20checking\x20(global\x20checks\x20every\x201\x20hour)'),this[_0x3179d0(0x1a0)]()[_0x3179d0(0x1ab)](_0x2c7f49=>{const _0x44c6b8=_0x3179d0;console[_0x44c6b8(0xd6)](_0x44c6b8(0x15a),_0x2c7f49);}),this[_0x3179d0(0xe3)]=setInterval(async()=>{const _0x189aaf=_0x3179d0;try{console[_0x189aaf(0xf9)]('ü™ô\x20[GLOBAL]\x20Starting\x20global\x20check\x20cycle...'),await this[_0x189aaf(0x1a0)](),console[_0x189aaf(0xf9)](_0x189aaf(0xdf));}catch(_0x30e788){console[_0x189aaf(0xd6)](_0x189aaf(0x169),_0x30e788);}},this['GLOBAL_CHECK_INTERVAL_MS']),console[_0x3179d0(0xf9)](_0x3179d0(0xbd));}['stopPeriodicStatusCheck'](){const _0x3a6d08=a37_0x37e2f2;console[_0x3a6d08(0xf9)]('üõë\x20[SHUTDOWN]\x20Stopping\x20CoinToPay\x20status\x20checking\x20service...');this['globalCheckInterval']&&(clearInterval(this[_0x3a6d08(0xe3)]),this['globalCheckInterval']=null,console['log'](_0x3a6d08(0xed)));const _0x25fcc6=this[_0x3a6d08(0xc9)]['size'];for(const [_0x43aaac]of this[_0x3a6d08(0xc9)]){this['clearPaymentTimers'](_0x43aaac);}console[_0x3a6d08(0xf9)](_0x3a6d08(0x15e)+_0x25fcc6+_0x3a6d08(0x14d));}async[a37_0x37e2f2(0x1a0)](){const _0x324a35=a37_0x37e2f2;try{console[_0x324a35(0xf9)]('ü™ô\x20[GLOBAL]\x20Getting\x20all\x20pending\x20CoinToPay\x20payments...');const _0x5e44ca=await database_1[_0x324a35(0x114)][_0x324a35(0x17e)]['findMany']({'where':{'gateway':_0x324a35(0x178),'status':_0x324a35(0xd7),'gatewayPaymentId':{'not':null}},'select':{'id':!![],'gatewayPaymentId':!![],'amount':!![],'currency':!![],'status':!![],'shopId':!![],'createdAt':!![],'shop':{'select':{'id':!![],'name':!![],'settings':{'select':{'webhookUrl':!![],'webhookEvents':!![]}}}}}});console[_0x324a35(0xf9)](_0x324a35(0x136)+_0x5e44ca[_0x324a35(0x100)]+_0x324a35(0x148));if(_0x5e44ca[_0x324a35(0x100)]===0x0){console[_0x324a35(0xf9)](_0x324a35(0x17c));return;}const _0x4c9ee0=await this['checkExpiredPayments'](_0x5e44ca);console['log'](_0x324a35(0x184)+_0x4c9ee0[_0x324a35(0x100)]+_0x324a35(0x110));let _0x51c951=0x0,_0x27a1cb=0x0;for(const _0x525dab of _0x5e44ca){try{if(_0x4c9ee0[_0x324a35(0x1a9)](_0x525dab['id'])){console[_0x324a35(0xf9)](_0x324a35(0x117)+_0x525dab['id']+'\x20already\x20marked\x20as\x20expired,\x20skipping\x20global\x20check'),_0x27a1cb++;continue;}if(this[_0x324a35(0xc9)][_0x324a35(0x1a5)](_0x525dab['id'])){console[_0x324a35(0xf9)](_0x324a35(0x117)+_0x525dab['id']+_0x324a35(0x1a8)),_0x27a1cb++;continue;}const _0x22c216=(Date['now']()-_0x525dab['createdAt'][_0x324a35(0x1a7)]())/(0x3e8*0x3c*0x3c);if(_0x22c216<0x1){console['log'](_0x324a35(0x117)+_0x525dab['id']+_0x324a35(0x108)+_0x22c216[_0x324a35(0x123)](0x1)+_0x324a35(0x107)),_0x27a1cb++;continue;}console[_0x324a35(0xf9)](_0x324a35(0x173)+_0x525dab['id']+_0x324a35(0x12e)+_0x22c216[_0x324a35(0x123)](0x1)+'h)'),await this[_0x324a35(0x166)](_0x525dab),_0x51c951++,await new Promise(_0x19f6ea=>setTimeout(_0x19f6ea,0x7d0));}catch(_0x267008){console[_0x324a35(0xd6)](_0x324a35(0x187)+_0x525dab['id']+':',_0x267008),this[_0x324a35(0x156)](_0x525dab['id'],_0x525dab[_0x324a35(0xf3)]||'unknown',_0x267008,'status_check',{'isGlobalCheck':!![],'paymentAmount':_0x525dab['amount'],'paymentCurrency':_0x525dab[_0x324a35(0x162)],'shopId':_0x525dab[_0x324a35(0x112)],'createdAt':_0x525dab[_0x324a35(0xfb)]}),loggerService_1['loggerService']['logWhiteDomainError']('cointopay','/status/'+_0x525dab[_0x324a35(0xf3)],_0x267008);}}console['log'](_0x324a35(0x15d)+_0x51c951+'\x20checked,\x20'+_0x27a1cb+'\x20skipped,\x20'+_0x4c9ee0[_0x324a35(0x100)]+_0x324a35(0xd3));}catch(_0x1ae19f){console['error'](_0x324a35(0x13b),_0x1ae19f);}}async[a37_0x37e2f2(0x164)](_0x44c12e){const _0x1b6547=a37_0x37e2f2,_0x4a5db3=[],_0x118672=new Date();_0x118672[_0x1b6547(0x175)](_0x118672['getDate']()-this['EXPIRY_DAYS']),console['log'](_0x1b6547(0x176)+this[_0x1b6547(0x1ad)]+_0x1b6547(0xbf)+_0x118672[_0x1b6547(0x151)]()+')');for(const _0x3d888c of _0x44c12e){if(_0x3d888c[_0x1b6547(0xfb)]<_0x118672){console[_0x1b6547(0xf9)](_0x1b6547(0x127)+_0x3d888c['id']+'\x20is\x20older\x20than\x20'+this['EXPIRY_DAYS']+'\x20days,\x20marking\x20as\x20EXPIRED');try{this['logCoinToPayStatus'](_0x3d888c['id'],_0x3d888c['gatewayPaymentId']||_0x1b6547(0xd9),_0x1b6547(0xd7),_0x1b6547(0x165),'auto_expire',{'reason':_0x1b6547(0x1a6)+this[_0x1b6547(0x1ad)]+_0x1b6547(0x18b),'createdAt':_0x3d888c[_0x1b6547(0xfb)],'daysSinceCreation':Math[_0x1b6547(0xfc)]((Date[_0x1b6547(0xfd)]()-_0x3d888c[_0x1b6547(0xfb)][_0x1b6547(0x1a7)]())/(0x3e8*0x3c*0x3c*0x18)),'paymentAmount':_0x3d888c[_0x1b6547(0x19e)],'paymentCurrency':_0x3d888c['currency'],'shopId':_0x3d888c[_0x1b6547(0x112)]}),await database_1[_0x1b6547(0x114)][_0x1b6547(0x17e)][_0x1b6547(0x128)]({'where':{'id':_0x3d888c['id']},'data':{'status':_0x1b6547(0x165),'updatedAt':new Date(),'adminNotes':_0x1b6547(0xf4)+this['EXPIRY_DAYS']+_0x1b6547(0xdd)}}),await database_1[_0x1b6547(0x114)][_0x1b6547(0x12a)][_0x1b6547(0x137)]({'data':{'paymentId':_0x3d888c['id'],'shopId':_0x3d888c['shopId'],'event':'cointopay_auto_expired','statusCode':0xc8,'responseBody':JSON[_0x1b6547(0x18c)]({'reason':_0x1b6547(0x1a6)+this['EXPIRY_DAYS']+_0x1b6547(0x18b),'createdAt':_0x3d888c[_0x1b6547(0xfb)],'expiredAt':new Date()[_0x1b6547(0x151)](),'daysSinceCreation':Math[_0x1b6547(0xfc)]((Date[_0x1b6547(0xfd)]()-_0x3d888c[_0x1b6547(0xfb)][_0x1b6547(0x1a7)]())/(0x3e8*0x3c*0x3c*0x18))})}}),await this[_0x1b6547(0x15c)](_0x3d888c,'EXPIRED'),await this[_0x1b6547(0x109)](_0x3d888c,_0x1b6547(0x165)),this[_0x1b6547(0xc1)](_0x3d888c['id']),_0x4a5db3[_0x1b6547(0x188)](_0x3d888c['id']),console[_0x1b6547(0xf9)](_0x1b6547(0xd2)+_0x3d888c['id']+_0x1b6547(0x183)+this['EXPIRY_DAYS']+'-day\x20timeout');}catch(_0x586d37){console['error'](_0x1b6547(0xec)+_0x3d888c['id']+':',_0x586d37),this[_0x1b6547(0x156)](_0x3d888c['id'],_0x3d888c[_0x1b6547(0xf3)]||'unknown',_0x586d37,_0x1b6547(0x177),{'reason':_0x1b6547(0x140),'createdAt':_0x3d888c[_0x1b6547(0xfb)],'daysSinceCreation':Math['floor']((Date[_0x1b6547(0xfd)]()-_0x3d888c[_0x1b6547(0xfb)][_0x1b6547(0x1a7)]())/(0x3e8*0x3c*0x3c*0x18))});}}}return _0x4a5db3;}async[a37_0x37e2f2(0x166)](_0x26328c){const _0x2556fa=a37_0x37e2f2;if(!_0x26328c[_0x2556fa(0xf3)]){console[_0x2556fa(0xf9)]('‚ö†Ô∏è\x20[CHECK]\x20Payment\x20'+_0x26328c['id']+_0x2556fa(0x133));return;}console[_0x2556fa(0xf9)](_0x2556fa(0xc4)+_0x26328c['id']+'\x20('+_0x26328c[_0x2556fa(0xf3)]+')');try{const _0x4eedc5=await this['coinToPayService'][_0x2556fa(0x16b)](_0x26328c[_0x2556fa(0xf3)]);console[_0x2556fa(0xf9)](_0x2556fa(0x15b)+_0x26328c['id']+_0x2556fa(0x1aa)+_0x4eedc5[_0x2556fa(0x13f)]);_0x4eedc5['paymentDetails']&&console[_0x2556fa(0xf9)](_0x2556fa(0x15b)+_0x26328c['id']+_0x2556fa(0xc8),{'iban':_0x4eedc5[_0x2556fa(0xf1)][_0x2556fa(0x16f)]||_0x2556fa(0x158),'transactionId':_0x4eedc5[_0x2556fa(0xf1)]['transactionId'],'createdOn':_0x4eedc5[_0x2556fa(0xf1)][_0x2556fa(0x126)],'confirmedOn':_0x4eedc5[_0x2556fa(0xf1)][_0x2556fa(0x1ac)]||_0x2556fa(0x142)});if(_0x4eedc5['status']!==_0x26328c[_0x2556fa(0x13f)]){console[_0x2556fa(0xf9)](_0x2556fa(0x19d)+_0x26328c['id']+'\x20status\x20from\x20'+_0x26328c['status']+_0x2556fa(0x113)+_0x4eedc5[_0x2556fa(0x13f)]),this['logCoinToPayStatus'](_0x26328c['id'],_0x26328c[_0x2556fa(0xf3)],_0x26328c[_0x2556fa(0x13f)],_0x4eedc5[_0x2556fa(0x13f)],_0x2556fa(0x198),{'paymentDetails':_0x4eedc5[_0x2556fa(0xf1)],'amount':_0x4eedc5['amount'],'currency':_0x4eedc5[_0x2556fa(0x162)],'shopId':_0x26328c[_0x2556fa(0x112)],'checkTimestamp':new Date()[_0x2556fa(0x151)]()});const _0x7812b2={'status':_0x4eedc5['status'],'updatedAt':new Date()};_0x4eedc5[_0x2556fa(0x13f)]===_0x2556fa(0x16c)&&_0x26328c[_0x2556fa(0x13f)]!==_0x2556fa(0x16c)&&(_0x7812b2['paidAt']=new Date(),console[_0x2556fa(0xf9)](_0x2556fa(0x157)+_0x26328c['id']+_0x2556fa(0x196)+_0x7812b2['paidAt'][_0x2556fa(0x151)]()));if(_0x4eedc5[_0x2556fa(0xf1)]){const _0x1154d9=_0x4eedc5[_0x2556fa(0xf1)];_0x1154d9[_0x2556fa(0x16f)]&&(_0x7812b2[_0x2556fa(0x14f)]=_0x1154d9[_0x2556fa(0x16f)],console['log'](_0x2556fa(0xc5)+_0x1154d9[_0x2556fa(0x16f)]));if(_0x1154d9[_0x2556fa(0xcf)]){const _0x8daf15=_0x26328c['adminNotes']||'',_0x24b784=_0x2556fa(0x135)+_0x1154d9['bankDetails'];_0x7812b2[_0x2556fa(0x193)]=_0x8daf15?_0x8daf15+'\x0a\x0a'+_0x24b784:_0x24b784,console['log'](_0x2556fa(0x101));}_0x1154d9['transactionId']&&console[_0x2556fa(0xf9)](_0x2556fa(0xd8)+_0x1154d9[_0x2556fa(0xff)]),_0x1154d9[_0x2556fa(0x1ac)]&&console['log']('‚úÖ\x20[CHECK]\x20Transaction\x20confirmed\x20on:\x20'+_0x1154d9[_0x2556fa(0x1ac)]);}await database_1[_0x2556fa(0x114)]['payment']['update']({'where':{'id':_0x26328c['id']},'data':_0x7812b2}),await database_1[_0x2556fa(0x114)][_0x2556fa(0x12a)]['create']({'data':{'paymentId':_0x26328c['id'],'shopId':_0x26328c[_0x2556fa(0x112)],'event':_0x2556fa(0x14c)+_0x4eedc5[_0x2556fa(0x13f)]['toLowerCase'](),'statusCode':0xc8,'responseBody':JSON[_0x2556fa(0x18c)]({'oldStatus':_0x26328c[_0x2556fa(0x13f)],'newStatus':_0x4eedc5[_0x2556fa(0x13f)],'paymentDetails':_0x4eedc5[_0x2556fa(0xf1)],'checkedAt':new Date()['toISOString']()})}}),await this['sendShopWebhook'](_0x26328c,_0x4eedc5['status']),await this[_0x2556fa(0x109)](_0x26328c,_0x4eedc5[_0x2556fa(0x13f)]);if(_0x4eedc5[_0x2556fa(0x13f)]===_0x2556fa(0x16c)&&_0x26328c[_0x2556fa(0x13f)]!=='PAID')try{const {PaymentLinkService:_0x1c3c05}=await Promise[_0x2556fa(0x111)]()[_0x2556fa(0xf0)](()=>__importStar(require('./paymentLinkService'))),_0x33b2b0=new _0x1c3c05();await _0x33b2b0[_0x2556fa(0xef)](_0x26328c['id']),console['log'](_0x2556fa(0x18a)+_0x26328c['id']);}catch(_0x3ad439){console[_0x2556fa(0xd6)](_0x2556fa(0x125)+_0x26328c['id']+':',_0x3ad439);}_0x4eedc5[_0x2556fa(0x13f)]!==_0x2556fa(0xd7)&&(console[_0x2556fa(0xf9)](_0x2556fa(0x14a)+_0x26328c['id']+'\x20status\x20changed\x20to\x20'+_0x4eedc5[_0x2556fa(0x13f)]+_0x2556fa(0xd0)),this[_0x2556fa(0xc1)](_0x26328c['id'])),console[_0x2556fa(0xf9)](_0x2556fa(0x161)+_0x26328c['id']+_0x2556fa(0xce));}else console[_0x2556fa(0xf9)]('üìä\x20[CHECK]\x20Payment\x20'+_0x26328c['id']+'\x20status\x20unchanged\x20('+_0x4eedc5['status']+')'),this['logCoinToPayStatus'](_0x26328c['id'],_0x26328c[_0x2556fa(0xf3)],_0x26328c[_0x2556fa(0x13f)],_0x4eedc5[_0x2556fa(0x13f)],_0x2556fa(0x198),{'statusUnchanged':!![],'paymentDetails':_0x4eedc5[_0x2556fa(0xf1)],'amount':_0x4eedc5[_0x2556fa(0x19e)],'currency':_0x4eedc5['currency'],'shopId':_0x26328c[_0x2556fa(0x112)],'checkTimestamp':new Date()[_0x2556fa(0x151)]()});}catch(_0x11927b){console['error'](_0x2556fa(0x11a)+_0x26328c['id']+':',_0x11927b),this[_0x2556fa(0x156)](_0x26328c['id'],_0x26328c[_0x2556fa(0xf3)],_0x11927b,_0x2556fa(0x198),{'paymentAmount':_0x26328c[_0x2556fa(0x19e)],'paymentCurrency':_0x26328c[_0x2556fa(0x162)],'shopId':_0x26328c['shopId'],'createdAt':_0x26328c[_0x2556fa(0xfb)]}),await database_1['default'][_0x2556fa(0x12a)][_0x2556fa(0x137)]({'data':{'paymentId':_0x26328c['id'],'shopId':_0x26328c['shopId'],'event':_0x2556fa(0xe4),'statusCode':0x1f4,'responseBody':JSON['stringify']({'error':_0x11927b instanceof Error?_0x11927b['message']:_0x2556fa(0x15f),'gatewayPaymentId':_0x26328c[_0x2556fa(0xf3)],'checkedAt':new Date()[_0x2556fa(0x151)]()})}});}}async[a37_0x37e2f2(0x15c)](_0x11d69f,_0x3d5749){const _0xf9dd23=a37_0x37e2f2,_0x2b134d=Date[_0xf9dd23(0xfd)]();try{const _0x12015b=_0x11d69f[_0xf9dd23(0x186)],_0x962388=_0x12015b[_0xf9dd23(0x13c)];if(!_0x962388?.[_0xf9dd23(0x13e)]){console[_0xf9dd23(0xf9)]('No\x20webhook\x20URL\x20configured\x20for\x20shop\x20'+_0x12015b['id']);return;}const _0x57b0c7=_0x3d5749===_0xf9dd23(0x16c)?_0xf9dd23(0x154):_0x3d5749===_0xf9dd23(0x12f)?'payment.failed':_0x3d5749===_0xf9dd23(0x165)?'payment.failed':'payment.pending';if(!_0x962388['webhookEvents']?.[_0xf9dd23(0x1a9)](_0x57b0c7)){console[_0xf9dd23(0xf9)](_0xf9dd23(0xf5)+_0x57b0c7+_0xf9dd23(0x16a)+_0x12015b['id']);return;}const _0x3ff15b={'event':_0x57b0c7,'payment':{'id':_0x11d69f['id'],'order_id':_0x11d69f[_0xf9dd23(0x138)],'gateway_order_id':_0x11d69f[_0xf9dd23(0x167)],'gateway':_0xf9dd23(0x163),'amount':_0x11d69f['amount'],'currency':_0x11d69f[_0xf9dd23(0x162)],'status':_0x3d5749[_0xf9dd23(0x102)](),'customer_email':_0x11d69f['customerEmail'],'customer_name':_0x11d69f[_0xf9dd23(0xcd)],'created_at':_0x11d69f['createdAt'],'updated_at':new Date()}},_0x178932=await fetch(_0x962388[_0xf9dd23(0x13e)],{'method':_0xf9dd23(0x120),'headers':{'Content-Type':_0xf9dd23(0xd1),'User-Agent':'TesSoft\x20Payment\x20System/1.0'},'body':JSON[_0xf9dd23(0x18c)](_0x3ff15b)}),_0x876761=Date[_0xf9dd23(0xfd)]()-_0x2b134d,_0x4c66f1=_0x178932['ok']?_0xf9dd23(0xf6):await _0x178932['text']();loggerService_1[_0xf9dd23(0x17f)]['logShopWebhookSent'](_0x11d69f[_0xf9dd23(0x112)],_0x962388[_0xf9dd23(0x13e)],_0x57b0c7,_0x178932[_0xf9dd23(0x13f)],_0x876761,_0x3ff15b),console[_0xf9dd23(0xf9)]('Shop\x20webhook\x20sent\x20to\x20'+_0x962388[_0xf9dd23(0x13e)]+_0xf9dd23(0xf2)+_0x178932[_0xf9dd23(0x13f)]+'\x20('+_0x876761+_0xf9dd23(0x124));}catch(_0x44d394){console['error'](_0xf9dd23(0xd5),_0x44d394),loggerService_1['loggerService'][_0xf9dd23(0xdc)](_0x11d69f[_0xf9dd23(0x112)],_0x11d69f[_0xf9dd23(0x186)]?.[_0xf9dd23(0x13c)]?.[_0xf9dd23(0x13e)]||'unknown',_0xf9dd23(0x10b),_0x44d394,{});}}async['sendPaymentStatusNotification'](_0x12657a,_0x9e17f6){const _0x9b419b=a37_0x37e2f2;try{const _0xf6efc4={'PENDING':_0x9b419b(0xf7),'PAID':_0x9b419b(0x10e),'FAILED':'failed','EXPIRED':_0x9b419b(0x122)},_0x117ed1=_0xf6efc4[_0x9e17f6];if(!_0x117ed1||_0x117ed1===_0x9b419b(0xf7))return;await telegramBotService_1['telegramBotService'][_0x9b419b(0x103)](_0x12657a[_0x9b419b(0x112)],_0x12657a,_0x117ed1);}catch(_0x586893){console[_0x9b419b(0xd6)](_0x9b419b(0x11c),_0x586893);}}async['checkPaymentById'](_0x1e6f96){const _0x5b0445=a37_0x37e2f2;console['log'](_0x5b0445(0x150)+_0x1e6f96);const _0x24d6a0=await database_1[_0x5b0445(0x114)][_0x5b0445(0x17e)][_0x5b0445(0x14b)]({'where':{'id':_0x1e6f96},'include':{'shop':{'select':{'id':!![],'name':!![],'settings':{'select':{'webhookUrl':!![],'webhookEvents':!![]}}}}}});if(!_0x24d6a0)throw new Error(_0x5b0445(0x146));if(_0x24d6a0[_0x5b0445(0xeb)]!==_0x5b0445(0x178))throw new Error(_0x5b0445(0x143));console['log'](_0x5b0445(0x155)+_0x1e6f96),await this[_0x5b0445(0x166)](_0x24d6a0),console['log']('‚úÖ\x20[MANUAL]\x20Manual\x20check\x20completed\x20for\x20payment\x20'+_0x1e6f96);}['getServiceStats'](){const _0x238249=a37_0x37e2f2,_0x28404c=this['globalCheckInterval']?this[_0x238249(0x130)]:undefined,_0x479707=Array[_0x238249(0xc7)](this[_0x238249(0xc9)][_0x238249(0xe5)]())[_0x238249(0xe9)](_0x450aab=>({'paymentId':_0x450aab[_0x238249(0x185)],'gatewayPaymentId':_0x450aab['gatewayPaymentId'],'createdAt':_0x450aab[_0x238249(0xfb)],'timersCount':_0x450aab[_0x238249(0x153)]['length']}));return{'isActive':!!this[_0x238249(0xe3)],'globalCheckIntervalMinutes':this['GLOBAL_CHECK_INTERVAL_MS']/(0x3e8*0x3c),'expiryDays':this[_0x238249(0x1ad)],'activeIndividualTimers':this[_0x238249(0xc9)]['size'],'nextGlobalCheckIn':_0x28404c,'paymentTimersDetails':_0x479707};}[a37_0x37e2f2(0xc6)](_0x5a3dc5){const _0x1d21b3=a37_0x37e2f2,_0x15c4d9=this[_0x1d21b3(0xc9)][_0x1d21b3(0x145)](_0x5a3dc5);if(_0x15c4d9)return{'hasTimers':!![],'timersCount':_0x15c4d9[_0x1d21b3(0x153)][_0x1d21b3(0x100)],'createdAt':_0x15c4d9[_0x1d21b3(0xfb)],'gatewayPaymentId':_0x15c4d9[_0x1d21b3(0xf3)]};return{'hasTimers':![]};}}exports['CoinToPayStatusService']=CoinToPayStatusService,exports['coinToPayStatusService']=new CoinToPayStatusService();function a37_0x36f4(){const _0x5bb3f0=['settings','\x20completed\x20for\x20payment\x20','webhookUrl','status','Failed\x20to\x20mark\x20payment\x20as\x20expired','message','not\x20confirmed','Payment\x20is\x20not\x20a\x20CoinToPay\x20payment','23260JFYwfm','get','Payment\x20not\x20found','‚úÖ\x20[DEBUG]\x20Successfully\x20scheduled\x20','\x20pending\x20CoinToPay\x20payments','538256UHaljL','üßπ\x20[CHECK]\x20Payment\x20','findUnique','cointopay_status_check_','\x20individual\x20payment\x20timers','ü™ô\x20[LOG]\x20CoinToPay\x20Status\x20Change:\x20','remitterIban','üîç\x20[MANUAL]\x20Manual\x20check\x20requested\x20for\x20payment:\x20','toISOString','üßπ\x20[DEBUG]\x20Clearing\x20','timers','payment.success','‚úÖ\x20[MANUAL]\x20Starting\x20manual\x20check\x20for\x20CoinToPay\x20payment\x20','logCoinToPayError','üí∞\x20[CHECK]\x20Payment\x20','not\x20found','‚ö†Ô∏è\x20[CHECK]\x20Payment\x20','‚ùå\x20[INIT]\x20Initial\x20CoinToPay\x20status\x20check\x20failed:','üìä\x20[CHECK]\x20Payment\x20','sendShopWebhook','‚úÖ\x20[GLOBAL]\x20Global\x20check\x20completed:\x20','üõë\x20[SHUTDOWN]\x20Cleared\x20','Unknown\x20error','checkSinglePaymentById','‚úÖ\x20[CHECK]\x20Payment\x20','currency','0100','checkExpiredPayments','EXPIRED','checkSinglePayment','gatewayOrderId','ü™ô\x20[DEBUG]\x20schedulePaymentChecks\x20called\x20with:','‚ùå\x20[GLOBAL]\x20Periodic\x20CoinToPay\x20status\x20check\x20failed:','\x20not\x20enabled\x20for\x20shop\x20','checkPaymentStatus','PAID','‚ö†Ô∏è\x20[DEBUG]\x20No\x20timers\x20found\x20for\x20payment\x20','28OPBZJw','iban','\x20\x20\x20-\x20GatewayPaymentId:\x20','5\x20minutes','\x20initial\x20timers\x20for\x20payment\x20','üîç\x20[GLOBAL]\x20Checking\x20old\x20payment\x20','delay','setDate','‚è∞\x20[EXPIRY]\x20Checking\x20for\x20CoinToPay\x20payments\x20older\x20than\x20','auto_expire','cointopay','127955UElgEd','\x20->\x20','ü™ô\x20[HOURLY]\x20Hourly\x20check\x20triggered\x20for\x20payment\x20','ü™ô\x20[GLOBAL]\x20No\x20pending\x20CoinToPay\x20payments\x20to\x20check','\x20\x20\x20-\x20Amount:\x20','payment','loggerService','./telegramBotService','startPeriodicStatusCheck','‚è∞\x20[DEBUG]\x20Scheduled\x20check\x20#','\x20marked\x20as\x20EXPIRED\x20due\x20to\x20','‚è∞\x20[GLOBAL]\x20Found\x20','paymentId','shop','‚ùå\x20[GLOBAL]\x20Failed\x20to\x20check\x20CoinToPay\x20payment\x20','push','‚ùå\x20[HOURLY]\x20Failed\x20hourly\x20check\x20for\x20payment\x20','üìà\x20[CHECK]\x20Payment\x20link\x20counter\x20updated\x20for\x20payment\x20','\x20days','stringify','1342700sZPLpo','hasOwnProperty','prototype','\x20\x20\x20üìç\x20Source:\x20','ü™ô\x20CoinToPayStatusService\x20initialized','üîç\x20[CHECK]\x20Starting\x20check\x20for\x20payment\x20ID:\x20','adminNotes','stack','\x20is\x20older\x20than\x20','\x20marked\x20as\x20paid\x20at:\x20','\x20found:','status_check','ü™ô\x20[TIMER]\x20Individual\x20check\x20#','‚úÖ\x20[TIMER]\x20Individual\x20check\x20#','__importStar','configurable','üîÑ\x20[CHECK]\x20Updating\x20payment\x20','amount','225TLKEyg','checkAllPendingPayments','ü™ô\x20[DEBUG]\x20Creating\x20','__importDefault',',\x20stopping\x20individual\x20checks','COINTOPAY_ERROR','has','Payment\x20older\x20than\x20','getTime','\x20has\x20individual\x20timers,\x20skipping\x20global\x20check','includes','\x20status:\x20','catch','confirmedOn','EXPIRY_DAYS','‚úÖ\x20[INIT]\x20CoinToPay\x20status\x20checking\x20service\x20started\x20(global\x20hourly\x20checks\x20+\x20individual\x20payment\x20timers)','./loggerService','\x20days\x20(created\x20before\x20','75bbcKrd','clearPaymentTimers','\x20(after\x20','timestamp','üîç\x20[CHECK]\x20Checking\x20CoinToPay\x20payment\x20','üè¶\x20[CHECK]\x20Saved\x20IBAN:\x20','getPaymentTimerInfo','from','\x20details:','paymentTimers','\x20for\x20payment\x20','logCoinToPayStatus','‚ùå\x20[TIMER]\x20Failed\x20individual\x20check\x20#','customerName','\x20updated\x20successfully','bankDetails',',\x20clearing\x20individual\x20timers','application/json','‚úÖ\x20[EXPIRY]\x20Payment\x20','\x20expired','coinToPayStatusService','Failed\x20to\x20send\x20shop\x20webhook:','error','PENDING','üÜî\x20[CHECK]\x20Transaction\x20ID:\x20','unknown','call','__esModule','logShopWebhookError','\x20days\x20without\x20payment\x20confirmation','size','‚úÖ\x20[GLOBAL]\x20Global\x20check\x20cycle\x20completed','üìä\x20[HOURLY]\x20Payment\x20','\x20\x20\x20-\x20Gateway:\x20','77352lnAaqn','globalCheckInterval','cointopay_status_check_error','values','‚ùå\x20[HOURLY]\x20Payment\x20','11270nNhYcx','\x20in\x20','map','\x20\x20\x20-\x20Status:\x20','gateway','‚ùå\x20[EXPIRY]\x20Failed\x20to\x20expire\x20payment\x20','üõë\x20[SHUTDOWN]\x20CoinToPay\x20global\x20status\x20checking\x20stopped','defineProperty','handleSuccessfulPayment','then','paymentDetails','\x20with\x20status\x20','gatewayPaymentId','Automatically\x20expired\x20after\x20','Webhook\x20event\x20','Success','created','\x20triggered\x20for\x20payment\x20','log','72498AizUQX','createdAt','floor','now','schedule_created','transactionId','length','üè¶\x20[CHECK]\x20Saved\x20bank\x20details\x20to\x20admin\x20notes','toLowerCase','sendPaymentNotification','\x20\x20\x20-\x20ShopId:\x20','ü™ô\x20[ERROR]\x20CoinToPay\x20Error:\x20','\x20\x20\x20-\x20paymentId:\x20','h),\x20skipping\x20global\x20check','\x20is\x20too\x20new\x20(','sendPaymentStatusNotification','../config/database','webhook_send','\x20has\x20no\x20gatewayPaymentId','\x20status\x20is\x20','paid','delete','\x20expired\x20CoinToPay\x20payments','resolve','shopId','\x20to\x20','default','getOwnPropertyNames','‚úÖ\x20[HOURLY]\x20Payment\x20','‚è∞\x20[GLOBAL]\x20Payment\x20','\x20\x20\x20-\x20gatewayPaymentId:\x20','description','‚ùå\x20[CHECK]\x20Failed\x20to\x20check\x20payment\x20','\x20\x20\x20üìÖ\x20Time:\x20','Failed\x20to\x20send\x20Telegram\x20payment\x20notification:','‚úÖ\x20[DEBUG]\x20All\x20timers\x20cleared\x20for\x20payment\x20','set','\x20not\x20found\x20in\x20database','POST','‚ùå\x20[CHECK]\x20Payment\x20','expired','toFixed','ms)','‚ùå\x20[CHECK]\x20Failed\x20to\x20update\x20payment\x20link\x20counter\x20for\x20payment\x20','createdOn','‚è∞\x20[EXPIRY]\x20Payment\x20','update','.\x20Remaining\x20active\x20timers:\x20','webhookLog','‚è∞\x20[HOURLY]\x20Payment\x20','\x20seconds\x20(','\x20\x20\x20üìù\x20Details:','\x20(age:\x20','FAILED','GLOBAL_CHECK_INTERVAL_MS','CoinToPayService','\x20\x20\x20‚ùå\x20Error:\x20','\x20has\x20no\x20gatewayPaymentId,\x20skipping','\x20not\x20found,\x20clearing\x20timers','Bank\x20Details:\x20','ü™ô\x20[GLOBAL]\x20Found\x20','create','orderId','coinToPayService','1\x20minute','‚ùå\x20[GLOBAL]\x20Failed\x20to\x20get\x20pending\x20CoinToPay\x20payments:'];a37_0x36f4=function(){return _0x5bb3f0;};return a37_0x36f4();}