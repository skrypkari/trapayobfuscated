'use strict';const a37_0x5479c3=a37_0x5e48;(function(_0x5d61c0,_0x37636a){const _0x9bac78=a37_0x5e48,_0x9dfa38=_0x5d61c0();while(!![]){try{const _0x1f329a=parseInt(_0x9bac78(0xa4))/0x1+parseInt(_0x9bac78(0x154))/0x2*(parseInt(_0x9bac78(0xdb))/0x3)+parseInt(_0x9bac78(0xd7))/0x4+-parseInt(_0x9bac78(0x15b))/0x5+-parseInt(_0x9bac78(0x146))/0x6*(parseInt(_0x9bac78(0x134))/0x7)+parseInt(_0x9bac78(0xde))/0x8*(parseInt(_0x9bac78(0x133))/0x9)+-parseInt(_0x9bac78(0x173))/0xa*(parseInt(_0x9bac78(0x108))/0xb);if(_0x1f329a===_0x37636a)break;else _0x9dfa38['push'](_0x9dfa38['shift']());}catch(_0x11daab){_0x9dfa38['push'](_0x9dfa38['shift']());}}}(a37_0xc6a0,0x2ff11));function a37_0x5e48(_0x2a075a,_0x3ffcfe){const _0xc6a01a=a37_0xc6a0();return a37_0x5e48=function(_0x5e4820,_0x31b53b){_0x5e4820=_0x5e4820-0x90;let _0x2d33b7=_0xc6a01a[_0x5e4820];return _0x2d33b7;},a37_0x5e48(_0x2a075a,_0x3ffcfe);}var __createBinding=this&&this[a37_0x5479c3(0x16a)]||(Object[a37_0x5479c3(0x13c)]?function(_0x137d47,_0x3d012d,_0x4b7da7,_0x206ad0){const _0x159f7b=a37_0x5479c3;if(_0x206ad0===undefined)_0x206ad0=_0x4b7da7;var _0x267c42=Object['getOwnPropertyDescriptor'](_0x3d012d,_0x4b7da7);(!_0x267c42||(_0x159f7b(0xc7)in _0x267c42?!_0x3d012d[_0x159f7b(0x10d)]:_0x267c42[_0x159f7b(0x13d)]||_0x267c42[_0x159f7b(0x15e)]))&&(_0x267c42={'enumerable':!![],'get':function(){return _0x3d012d[_0x4b7da7];}}),Object[_0x159f7b(0xf6)](_0x137d47,_0x206ad0,_0x267c42);}:function(_0x4861ee,_0x2405b5,_0x51a329,_0x4b7fb5){if(_0x4b7fb5===undefined)_0x4b7fb5=_0x51a329;_0x4861ee[_0x4b7fb5]=_0x2405b5[_0x51a329];}),__setModuleDefault=this&&this['__setModuleDefault']||(Object[a37_0x5479c3(0x13c)]?function(_0x2a5bd3,_0xeb429a){const _0x5f16b6=a37_0x5479c3;Object['defineProperty'](_0x2a5bd3,_0x5f16b6(0x15f),{'enumerable':!![],'value':_0xeb429a});}:function(_0x3f2d3d,_0x147267){_0x3f2d3d['default']=_0x147267;}),__importStar=this&&this[a37_0x5479c3(0x151)]||(function(){var _0x274f12=function(_0x25d318){const _0xf421b=a37_0x5e48;return _0x274f12=Object[_0xf421b(0xb7)]||function(_0xd6735f){const _0x5f0101=_0xf421b;var _0x4f2d1f=[];for(var _0x4b5256 in _0xd6735f)if(Object['prototype']['hasOwnProperty'][_0x5f0101(0xc6)](_0xd6735f,_0x4b5256))_0x4f2d1f[_0x4f2d1f[_0x5f0101(0x12a)]]=_0x4b5256;return _0x4f2d1f;},_0x274f12(_0x25d318);};return function(_0x3ce690){const _0x385c7a=a37_0x5e48;if(_0x3ce690&&_0x3ce690[_0x385c7a(0x10d)])return _0x3ce690;var _0x198acc={};if(_0x3ce690!=null){for(var _0x19280f=_0x274f12(_0x3ce690),_0x3d2c72=0x0;_0x3d2c72<_0x19280f[_0x385c7a(0x12a)];_0x3d2c72++)if(_0x19280f[_0x3d2c72]!==_0x385c7a(0x15f))__createBinding(_0x198acc,_0x3ce690,_0x19280f[_0x3d2c72]);}return __setModuleDefault(_0x198acc,_0x3ce690),_0x198acc;};}()),__importDefault=this&&this[a37_0x5479c3(0xfe)]||function(_0x27cb4c){const _0x104de8=a37_0x5479c3;return _0x27cb4c&&_0x27cb4c[_0x104de8(0x10d)]?_0x27cb4c:{'default':_0x27cb4c};};Object['defineProperty'](exports,'__esModule',{'value':!![]}),exports['coinToPayStatusService']=exports[a37_0x5479c3(0x9e)]=void 0x0;const coinToPayService_1=require(a37_0x5479c3(0x147)),database_1=__importDefault(require(a37_0x5479c3(0x161))),telegramBotService_1=require(a37_0x5479c3(0xae)),loggerService_1=require(a37_0x5479c3(0xfc));function a37_0xc6a0(){const _0x50256d=['stringify','✅\x20[HOURLY]\x20Hourly\x20check\x20completed\x20for\x20payment\x20','settings','\x20for\x20payment\x20','./loggerService','telegramBotService','__importDefault','timestamp','\x20initial\x20checks\x20+\x20hourly\x20checks\x20for\x20payment\x20','toISOString','checkPaymentStatus','\x20days,\x20marking\x20as\x20EXPIRED','size','stack','delete','createdAt','2116147qpafcf','payment.failed','GLOBAL_CHECK_INTERVAL_MS','amount','remitterIban','__esModule','findUnique','failed','floor','update','\x20\x20\x20-\x20Status:\x20','📊\x20[CHECK]\x20Payment\x20','COINTOPAY_ERROR','\x20marked\x20as\x20paid\x20at:\x20','logWhiteDomainError','PAID','created','not\x20confirmed','transactionId','Success','toFixed','\x20not\x20enabled\x20for\x20shop\x20','⏰\x20[GLOBAL]\x20Payment\x20','🪙\x20[GLOBAL]\x20No\x20pending\x20CoinToPay\x20payments\x20to\x20check','Unknown\x20error','PENDING','logShopWebhookError','logCoinToPayStatus','⚠️\x20[DEBUG]\x20No\x20timers\x20found\x20for\x20payment\x20','❌\x20[CHECK]\x20Payment\x20','❌\x20[HOURLY]\x20Failed\x20hourly\x20check\x20for\x20payment\x20','\x20days\x20(created\x20before\x20','coinToPayService','message','length','checkPaymentById','handleSuccessfulPayment','delay','\x20\x20\x20-\x20ShopId:\x20','webhook_send','🪙\x20[GLOBAL]\x20Found\x20','unknown','timers','9PLPpsj','119XhTlKp','shopId','\x20expired\x20CoinToPay\x20payments','description','\x20to\x20','\x20\x20\x20📝\x20Details:','Payment\x20older\x20than\x20','catch','create','writable','COINTOPAY_STATUS_CHANGE','🪙\x20[LOG]\x20CoinToPay\x20Status\x20Change:\x20','checkSinglePayment','gatewayOrderId','error','🛑\x20[SHUTDOWN]\x20Cleared\x20','not\x20found','includes','55098dILwXZ','./gateways/coinToPayService','📊\x20[HOURLY]\x20Payment\x20','cointopay','EXPIRY_DAYS','\x20timers\x20for\x20payment\x20','push','cointopay_status_check_error','\x20\x20\x20📅\x20Time:\x20','\x20status\x20is\x20','\x20(after\x20','__importStar','✅\x20[MANUAL]\x20Manual\x20check\x20completed\x20for\x20payment\x20','setDate','2eufWef','resolve','\x20in\x20','payment.pending','forEach','⏰\x20[EXPIRY]\x20Checking\x20for\x20CoinToPay\x20payments\x20older\x20than\x20','\x20\x20\x20📊\x20Status:\x20','298525soswPb','iban','getTime','configurable','default','log','../config/database','Bank\x20Details:\x20','\x20\x20\x20-\x20Amount:\x20','payment','🪙\x20[ERROR]\x20CoinToPay\x20Error:\x20','-day\x20timeout','🏦\x20[CHECK]\x20Saved\x20bank\x20details\x20to\x20admin\x20notes','🔍\x20[CHECK]\x20Checking\x20CoinToPay\x20payment\x20','orderId','__createBinding','📈\x20[CHECK]\x20Payment\x20link\x20counter\x20updated\x20for\x20payment\x20','toLowerCase','\x20is\x20too\x20new\x20(','gatewayPaymentId','\x20\x20\x20-\x20GatewayPaymentId:\x20','\x20to\x20clear','currency','POST','50DuyxLD','5\x20minutes','\x20\x20\x20-\x20gatewayPaymentId:\x20','❌\x20[GLOBAL]\x20Failed\x20to\x20get\x20pending\x20CoinToPay\x20payments:','cointopay_auto_expired','gateway','✅\x20[GLOBAL]\x20Global\x20check\x20completed:\x20','schedulePaymentChecks','\x20\x20\x20-\x20paymentId:\x20','\x20is\x20not\x20a\x20CoinToPay\x20payment\x20(gateway:\x20','confirmedOn','webhookLog','❌\x20[INIT]\x20Initial\x20CoinToPay\x20status\x20check\x20failed:','🔍\x20[GLOBAL]\x20Checking\x20old\x20payment\x20','adminNotes','\x20triggered\x20for\x20payment\x20','globalCheckInterval','map','paymentDetails','Failed\x20to\x20send\x20Telegram\x20payment\x20notification:','\x20not\x20found\x20in\x20database','paymentTimers','loggerService','FAILED','CoinToPayService','✅\x20[TIMER]\x20Individual\x20check\x20#','CoinToPayStatusService',',\x20clearing\x20individual\x20timers','\x20has\x20no\x20gatewayPaymentId','Failed\x20to\x20send\x20shop\x20webhook:','⏰\x20[GLOBAL]\x20Found\x20','\x20completed\x20for\x20payment\x20','348148lMNPHZ','\x20already\x20marked\x20as\x20expired,\x20skipping\x20global\x20check','text','✅\x20[GLOBAL]\x20Global\x20check\x20cycle\x20completed','\x20details:','webhookUrl','\x20marked\x20as\x20EXPIRED\x20due\x20to\x20','Shop\x20webhook\x20sent\x20to\x20','bankDetails','getDate','./telegramBotService','🧹\x20[CHECK]\x20Payment\x20','now','customerName','❌\x20[GLOBAL]\x20Periodic\x20CoinToPay\x20status\x20check\x20failed:','✅\x20[HOURLY]\x20Payment\x20','\x20found:','\x20\x20\x20📍\x20Source:\x20','\x20status\x20changed\x20to\x20','getOwnPropertyNames','⚠️\x20[CHECK]\x20Payment\x20','coinToPayStatusService','status','\x20\x20\x20-\x20Gateway:\x20','❌\x20[EXPIRY]\x20Failed\x20to\x20expire\x20payment\x20','\x20not\x20found,\x20clearing\x20timers','✅\x20[EXPIRY]\x20Payment\x20','\x20initial\x20timers\x20for\x20payment\x20','✅\x20[DEBUG]\x20Successfully\x20scheduled\x20','/status/','0100','\x20days,\x20will\x20be\x20handled\x20by\x20global\x20expiry\x20check','🔍\x20[CHECK]\x20Starting\x20check\x20for\x20payment\x20ID:\x20','createdOn','call','get','🆔\x20[CHECK]\x20Transaction\x20ID:\x20','logCoinToPayError','getPaymentTimerInfo','status_check','h),\x20skipping\x20global\x20check','\x20updated\x20successfully','1\x20minute','checkSinglePaymentById','2\x20minutes','🛑\x20[SHUTDOWN]\x20CoinToPay\x20global\x20status\x20checking\x20stopped','sendPaymentStatusNotification',',\x20stopping\x20individual\x20checks','checkAllPendingPayments','\x20skipped,\x20','🔄\x20[CHECK]\x20Updating\x20payment\x20','1389328lxyclO','✅\x20[MANUAL]\x20Starting\x20manual\x20check\x20for\x20CoinToPay\x20payment\x20','\x20current\x20status:\x20','⏰\x20[HOURLY]\x20Payment\x20','1162731ZssIUH','\x20days','paid','2328104USeGfe','\x20status\x20from\x20','\x20->\x20','\x20is\x20valid\x20for\x20checking,\x20proceeding...','sendPaymentNotification','ms)','auto_expire','✅\x20[CHECK]\x20Transaction\x20confirmed\x20on:\x20','\x20with\x20status\x20','then','EXPIRED','stopPeriodicStatusCheck','expired','🪙\x20[DEBUG]\x20Creating\x20','sendShopWebhook','Automatically\x20expired\x20after\x20','paidAt','payment.success','checkExpiredPayments','🪙\x20[GLOBAL]\x20Getting\x20all\x20pending\x20CoinToPay\x20payments...','clearPaymentTimers','set','\x20individual\x20payment\x20timers','✅\x20[DEBUG]\x20All\x20timers\x20cleared\x20for\x20payment\x20','defineProperty','🛑\x20[SHUTDOWN]\x20Stopping\x20CoinToPay\x20status\x20checking\x20service...'];a37_0xc6a0=function(){return _0x50256d;};return a37_0xc6a0();}class CoinToPayStatusService{constructor(){const _0x3a0067=a37_0x5479c3;this[_0x3a0067(0x94)]=null,this['GLOBAL_CHECK_INTERVAL_MS']=0x3c*0x3c*0x3e8,this[_0x3a0067(0x14a)]=0x5,this[_0x3a0067(0x99)]=new Map(),this[_0x3a0067(0x128)]=new coinToPayService_1[(_0x3a0067(0x9c))](),console[_0x3a0067(0x160)]('🪙\x20CoinToPayStatusService\x20initialized');}[a37_0x5479c3(0x17a)](_0x1df1e8,_0x7f5288){const _0x5e2b87=a37_0x5479c3;console['log']('🪙\x20[DEBUG]\x20schedulePaymentChecks\x20called\x20with:'),console['log'](_0x5e2b87(0x17b)+_0x1df1e8),console[_0x5e2b87(0x160)](_0x5e2b87(0x175)+_0x7f5288),this['clearPaymentTimers'](_0x1df1e8);const _0x4d5981=[],_0x3569f3=new Date(),_0x1bd5aa=[{'delay':0x1*0x3c*0x3e8,'description':_0x5e2b87(0xce)},{'delay':0x2*0x3c*0x3e8,'description':_0x5e2b87(0xd0)},{'delay':0x5*0x3c*0x3e8,'description':'5\x20minutes'},{'delay':0x5*0x3c*0x3e8,'description':_0x5e2b87(0x174)}];console[_0x5e2b87(0x160)](_0x5e2b87(0xeb)+_0x1bd5aa[_0x5e2b87(0x12a)]+_0x5e2b87(0xbf)+_0x1df1e8);let _0x155ce0=0x0;_0x1bd5aa[_0x5e2b87(0x158)]((_0x1853e8,_0x418702)=>{const _0x210fc0=_0x5e2b87;_0x155ce0+=_0x1853e8[_0x210fc0(0x12d)];const _0x21a21f=setTimeout(async()=>{const _0x3670cb=_0x210fc0;console[_0x3670cb(0x160)]('🪙\x20[TIMER]\x20Individual\x20check\x20#'+(_0x418702+0x1)+_0x3670cb(0x93)+_0x1df1e8+_0x3670cb(0x150)+_0x1853e8[_0x3670cb(0x137)]+')');try{await this[_0x3670cb(0xcf)](_0x1df1e8),console[_0x3670cb(0x160)](_0x3670cb(0x9d)+(_0x418702+0x1)+_0x3670cb(0xa3)+_0x1df1e8);}catch(_0x6cd7c4){console[_0x3670cb(0x142)]('❌\x20[TIMER]\x20Failed\x20individual\x20check\x20#'+(_0x418702+0x1)+_0x3670cb(0xfb)+_0x1df1e8+':',_0x6cd7c4),this[_0x3670cb(0xc9)](_0x1df1e8,_0x7f5288,_0x6cd7c4,_0x3670cb(0xcb),{'checkNumber':_0x418702+0x1,'scheduledAfter':_0x1853e8['description'],'isIndividualCheck':!![]});}},_0x155ce0);_0x4d5981[_0x210fc0(0x14c)](_0x21a21f),console['log']('⏰\x20[DEBUG]\x20Scheduled\x20check\x20#'+(_0x418702+0x1)+_0x210fc0(0xfb)+_0x1df1e8+_0x210fc0(0x156)+_0x155ce0/0x3e8+'\x20seconds\x20('+_0x1853e8[_0x210fc0(0x137)]+')');});const _0x4f6782=setInterval(async()=>{const _0x3f71de=_0x5e2b87;console[_0x3f71de(0x160)]('🪙\x20[HOURLY]\x20Hourly\x20check\x20triggered\x20for\x20payment\x20'+_0x1df1e8);try{const _0x256074=await database_1[_0x3f71de(0x15f)][_0x3f71de(0x164)]['findUnique']({'where':{'id':_0x1df1e8},'select':{'id':!![],'status':!![],'createdAt':!![],'gatewayPaymentId':!![]}});if(!_0x256074){console[_0x3f71de(0x160)]('❌\x20[HOURLY]\x20Payment\x20'+_0x1df1e8+_0x3f71de(0xbd)),this[_0x3f71de(0xf2)](_0x1df1e8);return;}console[_0x3f71de(0x160)](_0x3f71de(0x148)+_0x1df1e8+_0x3f71de(0xd9)+_0x256074[_0x3f71de(0xba)]);if(_0x256074[_0x3f71de(0xba)]!==_0x3f71de(0x121)){console[_0x3f71de(0x160)](_0x3f71de(0xb3)+_0x1df1e8+'\x20status\x20is\x20'+_0x256074['status']+',\x20stopping\x20individual\x20checks'),this[_0x3f71de(0xf2)](_0x1df1e8);return;}const _0x50d36b=Math[_0x3f71de(0x110)]((Date[_0x3f71de(0xb0)]()-_0x256074[_0x3f71de(0x107)]['getTime']())/(0x3e8*0x3c*0x3c*0x18));if(_0x50d36b>=this[_0x3f71de(0x14a)]){console[_0x3f71de(0x160)](_0x3f71de(0xda)+_0x1df1e8+'\x20is\x20older\x20than\x20'+this[_0x3f71de(0x14a)]+_0x3f71de(0xc3)),this[_0x3f71de(0xf2)](_0x1df1e8);return;}await this[_0x3f71de(0xcf)](_0x1df1e8),console[_0x3f71de(0x160)](_0x3f71de(0xf9)+_0x1df1e8);}catch(_0x1f385b){console[_0x3f71de(0x142)](_0x3f71de(0x126)+_0x1df1e8+':',_0x1f385b),this['logCoinToPayError'](_0x1df1e8,_0x7f5288,_0x1f385b,'status_check',{'isHourlyCheck':!![],'isIndividualCheck':!![]});}},0x3c*0x3c*0x3e8);_0x4d5981[_0x5e2b87(0x14c)](_0x4f6782),this['paymentTimers'][_0x5e2b87(0xf3)](_0x1df1e8,{'timers':_0x4d5981,'paymentId':_0x1df1e8,'gatewayPaymentId':_0x7f5288,'createdAt':_0x3569f3}),console[_0x5e2b87(0x160)](_0x5e2b87(0xc0)+_0x1bd5aa['length']+_0x5e2b87(0x100)+_0x1df1e8),console[_0x5e2b87(0x160)]('📊\x20[DEBUG]\x20Total\x20active\x20payment\x20timers:\x20'+this[_0x5e2b87(0x99)]['size']),this[_0x5e2b87(0x123)](_0x1df1e8,_0x7f5288,_0x5e2b87(0x121),_0x5e2b87(0x121),'status_check',{'action':'schedule_created','scheduledChecks':_0x1bd5aa[_0x5e2b87(0x12a)],'firstCheckIn':_0x1bd5aa[0x0]['delay']/0x3e8,'totalTimers':this[_0x5e2b87(0x99)][_0x5e2b87(0x104)]});}[a37_0x5479c3(0xf2)](_0x15e56e){const _0x1e9228=a37_0x5479c3,_0x4f692c=this[_0x1e9228(0x99)][_0x1e9228(0xc7)](_0x15e56e);_0x4f692c?(console[_0x1e9228(0x160)]('🧹\x20[DEBUG]\x20Clearing\x20'+_0x4f692c[_0x1e9228(0x132)]['length']+_0x1e9228(0x14b)+_0x15e56e),_0x4f692c['timers']['forEach']((_0x49ce7c,_0x5f4c0e)=>{const _0x36d024=_0x1e9228;_0x49ce7c&&(clearTimeout(_0x49ce7c),clearInterval(_0x49ce7c),console['log']('🧹\x20[DEBUG]\x20Cleared\x20timer\x20#'+(_0x5f4c0e+0x1)+_0x36d024(0xfb)+_0x15e56e));}),this[_0x1e9228(0x99)][_0x1e9228(0x106)](_0x15e56e),console[_0x1e9228(0x160)](_0x1e9228(0xf5)+_0x15e56e+'.\x20Remaining\x20active\x20timers:\x20'+this[_0x1e9228(0x99)][_0x1e9228(0x104)])):console[_0x1e9228(0x160)](_0x1e9228(0x124)+_0x15e56e+_0x1e9228(0x170));}async[a37_0x5479c3(0xcf)](_0x1ea38c){const _0x172ba7=a37_0x5479c3;console['log'](_0x172ba7(0xc4)+_0x1ea38c);const _0x568469=await database_1['default'][_0x172ba7(0x164)][_0x172ba7(0x10e)]({'where':{'id':_0x1ea38c},'select':{'id':!![],'gatewayPaymentId':!![],'amount':!![],'currency':!![],'status':!![],'shopId':!![],'createdAt':!![],'gateway':!![],'shop':{'select':{'id':!![],'name':!![],'settings':{'select':{'webhookUrl':!![],'webhookEvents':!![]}}}}}});if(!_0x568469){console[_0x172ba7(0x160)](_0x172ba7(0x125)+_0x1ea38c+_0x172ba7(0x98));return;}console[_0x172ba7(0x160)](_0x172ba7(0x113)+_0x1ea38c+_0x172ba7(0xb4)),console[_0x172ba7(0x160)](_0x172ba7(0xbb)+_0x568469[_0x172ba7(0x178)]),console[_0x172ba7(0x160)](_0x172ba7(0x112)+_0x568469[_0x172ba7(0xba)]),console[_0x172ba7(0x160)](_0x172ba7(0x16f)+_0x568469[_0x172ba7(0x16e)]),console[_0x172ba7(0x160)](_0x172ba7(0x163)+_0x568469[_0x172ba7(0x10b)]+'\x20'+_0x568469['currency']),console[_0x172ba7(0x160)](_0x172ba7(0x12e)+_0x568469[_0x172ba7(0x135)]);if(_0x568469[_0x172ba7(0x178)]!==_0x172ba7(0x149)){console[_0x172ba7(0x160)](_0x172ba7(0xb8)+_0x1ea38c+_0x172ba7(0x17c)+_0x568469[_0x172ba7(0x178)]+')');return;}if(_0x568469[_0x172ba7(0xba)]!==_0x172ba7(0x121)){console['log'](_0x172ba7(0xb8)+_0x1ea38c+_0x172ba7(0x14f)+_0x568469[_0x172ba7(0xba)]+_0x172ba7(0xd3)),this[_0x172ba7(0xf2)](_0x1ea38c);return;}if(!_0x568469[_0x172ba7(0x16e)]){console[_0x172ba7(0x160)]('⚠️\x20[CHECK]\x20Payment\x20'+_0x1ea38c+_0x172ba7(0xa0));return;}console[_0x172ba7(0x160)]('✅\x20[CHECK]\x20Payment\x20'+_0x1ea38c+_0x172ba7(0xe1)),await this[_0x172ba7(0x140)](_0x568469);}['logCoinToPayStatus'](_0x1d65e2,_0x5004f2,_0x19b542,_0x2831c4,_0x9d3291,_0x170ff5){const _0x3126a2=a37_0x5479c3,_0xd1a0f7={'type':_0x3126a2(0x13e),'paymentId':_0x1d65e2,'gatewayPaymentId':_0x5004f2,'oldStatus':_0x19b542,'newStatus':_0x2831c4,'source':_0x9d3291,'timestamp':new Date()[_0x3126a2(0x101)](),'details':_0x170ff5||{}};loggerService_1[_0x3126a2(0x9a)][_0x3126a2(0x123)](_0xd1a0f7),console[_0x3126a2(0x160)](_0x3126a2(0x13f)+_0x1d65e2+'\x20('+_0x5004f2+')'),console['log'](_0x3126a2(0x15a)+_0x19b542+_0x3126a2(0xe0)+_0x2831c4),console[_0x3126a2(0x160)](_0x3126a2(0xb5)+_0x9d3291),console[_0x3126a2(0x160)](_0x3126a2(0x14e)+_0xd1a0f7[_0x3126a2(0xff)]),_0x170ff5&&console[_0x3126a2(0x160)](_0x3126a2(0x139),_0x170ff5);}[a37_0x5479c3(0xc9)](_0x3ba56e,_0x4e5451,_0x44f564,_0x4137e8,_0x40ed9b){const _0x3dfbea=a37_0x5479c3,_0x59eed9={'type':_0x3dfbea(0x114),'paymentId':_0x3ba56e,'gatewayPaymentId':_0x4e5451,'error':_0x44f564 instanceof Error?{'message':_0x44f564[_0x3dfbea(0x129)],'stack':_0x44f564[_0x3dfbea(0x105)]}:_0x44f564,'source':_0x4137e8,'timestamp':new Date()[_0x3dfbea(0x101)](),'context':_0x40ed9b||{}};loggerService_1[_0x3dfbea(0x9a)]['logCoinToPayError'](_0x59eed9),console[_0x3dfbea(0x142)](_0x3dfbea(0x165)+_0x3ba56e+'\x20('+_0x4e5451+')'),console['error']('\x20\x20\x20❌\x20Error:\x20'+(_0x44f564 instanceof Error?_0x44f564[_0x3dfbea(0x129)]:_0x44f564)),console[_0x3dfbea(0x142)](_0x3dfbea(0xb5)+_0x4137e8),console[_0x3dfbea(0x142)](_0x3dfbea(0x14e)+_0x59eed9[_0x3dfbea(0xff)]),_0x40ed9b&&console[_0x3dfbea(0x142)]('\x20\x20\x20📝\x20Context:',_0x40ed9b);}['startPeriodicStatusCheck'](){const _0xed6c99=a37_0x5479c3;console[_0xed6c99(0x160)]('🪙\x20[INIT]\x20Starting\x20CoinToPay\x20periodic\x20status\x20checking\x20(global\x20checks\x20every\x201\x20hour)'),this[_0xed6c99(0xd4)]()[_0xed6c99(0x13b)](_0x5574d3=>{const _0x1b6041=_0xed6c99;console[_0x1b6041(0x142)](_0x1b6041(0x90),_0x5574d3);}),this['globalCheckInterval']=setInterval(async()=>{const _0x50af3f=_0xed6c99;try{console[_0x50af3f(0x160)]('🪙\x20[GLOBAL]\x20Starting\x20global\x20check\x20cycle...'),await this[_0x50af3f(0xd4)](),console['log'](_0x50af3f(0xa7));}catch(_0x92c339){console[_0x50af3f(0x142)](_0x50af3f(0xb2),_0x92c339);}},this[_0xed6c99(0x10a)]),console[_0xed6c99(0x160)]('✅\x20[INIT]\x20CoinToPay\x20status\x20checking\x20service\x20started\x20(global\x20hourly\x20checks\x20+\x20individual\x20payment\x20timers)');}[a37_0x5479c3(0xe9)](){const _0x23e517=a37_0x5479c3;console[_0x23e517(0x160)](_0x23e517(0xf7));this['globalCheckInterval']&&(clearInterval(this[_0x23e517(0x94)]),this[_0x23e517(0x94)]=null,console[_0x23e517(0x160)](_0x23e517(0xd1)));const _0x239ecc=this[_0x23e517(0x99)][_0x23e517(0x104)];for(const [_0x1114df]of this[_0x23e517(0x99)]){this[_0x23e517(0xf2)](_0x1114df);}console[_0x23e517(0x160)](_0x23e517(0x143)+_0x239ecc+_0x23e517(0xf4));}async[a37_0x5479c3(0xd4)](){const _0x24e03f=a37_0x5479c3;try{console[_0x24e03f(0x160)](_0x24e03f(0xf1));const _0x427184=await database_1[_0x24e03f(0x15f)][_0x24e03f(0x164)]['findMany']({'where':{'gateway':_0x24e03f(0x149),'status':_0x24e03f(0x121),'gatewayPaymentId':{'not':null}},'select':{'id':!![],'gatewayPaymentId':!![],'amount':!![],'currency':!![],'status':!![],'shopId':!![],'createdAt':!![],'shop':{'select':{'id':!![],'name':!![],'settings':{'select':{'webhookUrl':!![],'webhookEvents':!![]}}}}}});console[_0x24e03f(0x160)](_0x24e03f(0x130)+_0x427184[_0x24e03f(0x12a)]+'\x20pending\x20CoinToPay\x20payments');if(_0x427184['length']===0x0){console['log'](_0x24e03f(0x11f));return;}const _0x3eba58=await this[_0x24e03f(0xf0)](_0x427184);console[_0x24e03f(0x160)](_0x24e03f(0xa2)+_0x3eba58['length']+_0x24e03f(0x136));let _0x559c05=0x0,_0x4d6182=0x0;for(const _0x4c0b3d of _0x427184){try{if(_0x3eba58[_0x24e03f(0x145)](_0x4c0b3d['id'])){console[_0x24e03f(0x160)](_0x24e03f(0x11e)+_0x4c0b3d['id']+_0x24e03f(0xa5)),_0x4d6182++;continue;}if(this['paymentTimers']['has'](_0x4c0b3d['id'])){console[_0x24e03f(0x160)](_0x24e03f(0x11e)+_0x4c0b3d['id']+'\x20has\x20individual\x20timers,\x20skipping\x20global\x20check'),_0x4d6182++;continue;}const _0x5286c3=(Date['now']()-_0x4c0b3d['createdAt'][_0x24e03f(0x15d)]())/(0x3e8*0x3c*0x3c);if(_0x5286c3<0x1){console[_0x24e03f(0x160)]('⏰\x20[GLOBAL]\x20Payment\x20'+_0x4c0b3d['id']+_0x24e03f(0x16d)+_0x5286c3[_0x24e03f(0x11c)](0x1)+_0x24e03f(0xcc)),_0x4d6182++;continue;}console[_0x24e03f(0x160)](_0x24e03f(0x91)+_0x4c0b3d['id']+'\x20(age:\x20'+_0x5286c3['toFixed'](0x1)+'h)'),await this[_0x24e03f(0x140)](_0x4c0b3d),_0x559c05++,await new Promise(_0x4a9d30=>setTimeout(_0x4a9d30,0x7d0));}catch(_0x11f04a){console[_0x24e03f(0x142)]('❌\x20[GLOBAL]\x20Failed\x20to\x20check\x20CoinToPay\x20payment\x20'+_0x4c0b3d['id']+':',_0x11f04a),this[_0x24e03f(0xc9)](_0x4c0b3d['id'],_0x4c0b3d[_0x24e03f(0x16e)]||'unknown',_0x11f04a,_0x24e03f(0xcb),{'isGlobalCheck':!![],'paymentAmount':_0x4c0b3d['amount'],'paymentCurrency':_0x4c0b3d[_0x24e03f(0x171)],'shopId':_0x4c0b3d[_0x24e03f(0x135)],'createdAt':_0x4c0b3d['createdAt']}),loggerService_1[_0x24e03f(0x9a)][_0x24e03f(0x116)](_0x24e03f(0x149),_0x24e03f(0xc1)+_0x4c0b3d['gatewayPaymentId'],_0x11f04a);}}console[_0x24e03f(0x160)](_0x24e03f(0x179)+_0x559c05+'\x20checked,\x20'+_0x4d6182+_0x24e03f(0xd5)+_0x3eba58[_0x24e03f(0x12a)]+'\x20expired');}catch(_0x5cd386){console[_0x24e03f(0x142)](_0x24e03f(0x176),_0x5cd386);}}async['checkExpiredPayments'](_0x3706bc){const _0x571661=a37_0x5479c3,_0x8d46e5=[],_0x4737d9=new Date();_0x4737d9[_0x571661(0x153)](_0x4737d9[_0x571661(0xad)]()-this[_0x571661(0x14a)]),console[_0x571661(0x160)](_0x571661(0x159)+this[_0x571661(0x14a)]+_0x571661(0x127)+_0x4737d9[_0x571661(0x101)]()+')');for(const _0x4ee4d4 of _0x3706bc){if(_0x4ee4d4[_0x571661(0x107)]<_0x4737d9){console['log']('⏰\x20[EXPIRY]\x20Payment\x20'+_0x4ee4d4['id']+'\x20is\x20older\x20than\x20'+this[_0x571661(0x14a)]+_0x571661(0x103));try{this[_0x571661(0x123)](_0x4ee4d4['id'],_0x4ee4d4['gatewayPaymentId']||_0x571661(0x131),'PENDING',_0x571661(0xe8),_0x571661(0xe4),{'reason':_0x571661(0x13a)+this['EXPIRY_DAYS']+_0x571661(0xdc),'createdAt':_0x4ee4d4[_0x571661(0x107)],'daysSinceCreation':Math[_0x571661(0x110)]((Date['now']()-_0x4ee4d4[_0x571661(0x107)][_0x571661(0x15d)]())/(0x3e8*0x3c*0x3c*0x18)),'paymentAmount':_0x4ee4d4['amount'],'paymentCurrency':_0x4ee4d4[_0x571661(0x171)],'shopId':_0x4ee4d4[_0x571661(0x135)]}),await database_1[_0x571661(0x15f)][_0x571661(0x164)][_0x571661(0x111)]({'where':{'id':_0x4ee4d4['id']},'data':{'status':_0x571661(0xe8),'updatedAt':new Date(),'adminNotes':_0x571661(0xed)+this[_0x571661(0x14a)]+'\x20days\x20without\x20payment\x20confirmation'}}),await database_1[_0x571661(0x15f)][_0x571661(0x17e)][_0x571661(0x13c)]({'data':{'paymentId':_0x4ee4d4['id'],'shopId':_0x4ee4d4[_0x571661(0x135)],'event':_0x571661(0x177),'statusCode':0xc8,'responseBody':JSON[_0x571661(0xf8)]({'reason':_0x571661(0x13a)+this['EXPIRY_DAYS']+_0x571661(0xdc),'createdAt':_0x4ee4d4['createdAt'],'expiredAt':new Date()['toISOString'](),'daysSinceCreation':Math[_0x571661(0x110)]((Date[_0x571661(0xb0)]()-_0x4ee4d4[_0x571661(0x107)][_0x571661(0x15d)]())/(0x3e8*0x3c*0x3c*0x18))})}}),await this['sendShopWebhook'](_0x4ee4d4,'EXPIRED'),await this[_0x571661(0xd2)](_0x4ee4d4,_0x571661(0xe8)),this[_0x571661(0xf2)](_0x4ee4d4['id']),_0x8d46e5[_0x571661(0x14c)](_0x4ee4d4['id']),console[_0x571661(0x160)](_0x571661(0xbe)+_0x4ee4d4['id']+_0x571661(0xaa)+this[_0x571661(0x14a)]+_0x571661(0x166));}catch(_0x1e6330){console['error'](_0x571661(0xbc)+_0x4ee4d4['id']+':',_0x1e6330),this['logCoinToPayError'](_0x4ee4d4['id'],_0x4ee4d4['gatewayPaymentId']||_0x571661(0x131),_0x1e6330,'auto_expire',{'reason':'Failed\x20to\x20mark\x20payment\x20as\x20expired','createdAt':_0x4ee4d4[_0x571661(0x107)],'daysSinceCreation':Math[_0x571661(0x110)]((Date[_0x571661(0xb0)]()-_0x4ee4d4[_0x571661(0x107)][_0x571661(0x15d)]())/(0x3e8*0x3c*0x3c*0x18))});}}}return _0x8d46e5;}async['checkSinglePayment'](_0x5a3065){const _0x3db729=a37_0x5479c3;if(!_0x5a3065[_0x3db729(0x16e)]){console['log'](_0x3db729(0xb8)+_0x5a3065['id']+'\x20has\x20no\x20gatewayPaymentId,\x20skipping');return;}console[_0x3db729(0x160)](_0x3db729(0x168)+_0x5a3065['id']+'\x20('+_0x5a3065['gatewayPaymentId']+')');try{const _0x3710b2=await this['coinToPayService'][_0x3db729(0x102)](_0x5a3065[_0x3db729(0x16e)]);console['log'](_0x3db729(0x113)+_0x5a3065['id']+'\x20status:\x20'+_0x3710b2[_0x3db729(0xba)]);_0x3710b2[_0x3db729(0x96)]&&console[_0x3db729(0x160)](_0x3db729(0x113)+_0x5a3065['id']+_0x3db729(0xa8),{'iban':_0x3710b2['paymentDetails'][_0x3db729(0x15c)]||_0x3db729(0x144),'transactionId':_0x3710b2['paymentDetails'][_0x3db729(0x11a)],'createdOn':_0x3710b2[_0x3db729(0x96)][_0x3db729(0xc5)],'confirmedOn':_0x3710b2[_0x3db729(0x96)][_0x3db729(0x17d)]||_0x3db729(0x119)});if(_0x3710b2[_0x3db729(0xba)]!==_0x5a3065[_0x3db729(0xba)]){console[_0x3db729(0x160)](_0x3db729(0xd6)+_0x5a3065['id']+_0x3db729(0xdf)+_0x5a3065[_0x3db729(0xba)]+_0x3db729(0x138)+_0x3710b2[_0x3db729(0xba)]),this[_0x3db729(0x123)](_0x5a3065['id'],_0x5a3065[_0x3db729(0x16e)],_0x5a3065[_0x3db729(0xba)],_0x3710b2['status'],_0x3db729(0xcb),{'paymentDetails':_0x3710b2[_0x3db729(0x96)],'amount':_0x3710b2[_0x3db729(0x10b)],'currency':_0x3710b2[_0x3db729(0x171)],'shopId':_0x5a3065['shopId'],'checkTimestamp':new Date()[_0x3db729(0x101)]()});const _0x5056fa={'status':_0x3710b2[_0x3db729(0xba)],'updatedAt':new Date()};_0x3710b2[_0x3db729(0xba)]===_0x3db729(0x117)&&_0x5a3065[_0x3db729(0xba)]!==_0x3db729(0x117)&&(_0x5056fa[_0x3db729(0xee)]=new Date(),console[_0x3db729(0x160)]('💰\x20[CHECK]\x20Payment\x20'+_0x5a3065['id']+_0x3db729(0x115)+_0x5056fa[_0x3db729(0xee)][_0x3db729(0x101)]()));if(_0x3710b2[_0x3db729(0x96)]){const _0x538ee2=_0x3710b2[_0x3db729(0x96)];_0x538ee2[_0x3db729(0x15c)]&&(_0x5056fa[_0x3db729(0x10c)]=_0x538ee2[_0x3db729(0x15c)],console[_0x3db729(0x160)]('🏦\x20[CHECK]\x20Saved\x20IBAN:\x20'+_0x538ee2[_0x3db729(0x15c)]));if(_0x538ee2[_0x3db729(0xac)]){const _0x38d566=_0x5a3065[_0x3db729(0x92)]||'',_0xbe17b8=_0x3db729(0x162)+_0x538ee2['bankDetails'];_0x5056fa[_0x3db729(0x92)]=_0x38d566?_0x38d566+'\x0a\x0a'+_0xbe17b8:_0xbe17b8,console[_0x3db729(0x160)](_0x3db729(0x167));}_0x538ee2[_0x3db729(0x11a)]&&console['log'](_0x3db729(0xc8)+_0x538ee2[_0x3db729(0x11a)]),_0x538ee2['confirmedOn']&&console[_0x3db729(0x160)](_0x3db729(0xe5)+_0x538ee2['confirmedOn']);}await database_1[_0x3db729(0x15f)]['payment'][_0x3db729(0x111)]({'where':{'id':_0x5a3065['id']},'data':_0x5056fa}),await database_1[_0x3db729(0x15f)][_0x3db729(0x17e)]['create']({'data':{'paymentId':_0x5a3065['id'],'shopId':_0x5a3065[_0x3db729(0x135)],'event':'cointopay_status_check_'+_0x3710b2[_0x3db729(0xba)][_0x3db729(0x16c)](),'statusCode':0xc8,'responseBody':JSON[_0x3db729(0xf8)]({'oldStatus':_0x5a3065['status'],'newStatus':_0x3710b2[_0x3db729(0xba)],'paymentDetails':_0x3710b2['paymentDetails'],'checkedAt':new Date()[_0x3db729(0x101)]()})}}),await this[_0x3db729(0xec)](_0x5a3065,_0x3710b2[_0x3db729(0xba)]),await this['sendPaymentStatusNotification'](_0x5a3065,_0x3710b2[_0x3db729(0xba)]);if(_0x3710b2[_0x3db729(0xba)]==='PAID'&&_0x5a3065[_0x3db729(0xba)]!==_0x3db729(0x117))try{const {PaymentLinkService:_0x410746}=await Promise[_0x3db729(0x155)]()[_0x3db729(0xe7)](()=>__importStar(require('./paymentLinkService'))),_0x1c6af4=new _0x410746();await _0x1c6af4[_0x3db729(0x12c)](_0x5a3065['id']),console[_0x3db729(0x160)](_0x3db729(0x16b)+_0x5a3065['id']);}catch(_0x3d6ba5){console[_0x3db729(0x142)]('❌\x20[CHECK]\x20Failed\x20to\x20update\x20payment\x20link\x20counter\x20for\x20payment\x20'+_0x5a3065['id']+':',_0x3d6ba5);}_0x3710b2[_0x3db729(0xba)]!==_0x3db729(0x121)&&(console[_0x3db729(0x160)](_0x3db729(0xaf)+_0x5a3065['id']+_0x3db729(0xb6)+_0x3710b2['status']+_0x3db729(0x9f)),this[_0x3db729(0xf2)](_0x5a3065['id'])),console['log']('✅\x20[CHECK]\x20Payment\x20'+_0x5a3065['id']+_0x3db729(0xcd));}else console['log'](_0x3db729(0x113)+_0x5a3065['id']+'\x20status\x20unchanged\x20('+_0x3710b2[_0x3db729(0xba)]+')'),this[_0x3db729(0x123)](_0x5a3065['id'],_0x5a3065[_0x3db729(0x16e)],_0x5a3065['status'],_0x3710b2[_0x3db729(0xba)],_0x3db729(0xcb),{'statusUnchanged':!![],'paymentDetails':_0x3710b2[_0x3db729(0x96)],'amount':_0x3710b2['amount'],'currency':_0x3710b2[_0x3db729(0x171)],'shopId':_0x5a3065[_0x3db729(0x135)],'checkTimestamp':new Date()[_0x3db729(0x101)]()});}catch(_0x1dc2c3){console['error']('❌\x20[CHECK]\x20Failed\x20to\x20check\x20payment\x20'+_0x5a3065['id']+':',_0x1dc2c3),this[_0x3db729(0xc9)](_0x5a3065['id'],_0x5a3065[_0x3db729(0x16e)],_0x1dc2c3,_0x3db729(0xcb),{'paymentAmount':_0x5a3065[_0x3db729(0x10b)],'paymentCurrency':_0x5a3065['currency'],'shopId':_0x5a3065[_0x3db729(0x135)],'createdAt':_0x5a3065[_0x3db729(0x107)]}),await database_1[_0x3db729(0x15f)]['webhookLog'][_0x3db729(0x13c)]({'data':{'paymentId':_0x5a3065['id'],'shopId':_0x5a3065[_0x3db729(0x135)],'event':_0x3db729(0x14d),'statusCode':0x1f4,'responseBody':JSON['stringify']({'error':_0x1dc2c3 instanceof Error?_0x1dc2c3[_0x3db729(0x129)]:_0x3db729(0x120),'gatewayPaymentId':_0x5a3065[_0x3db729(0x16e)],'checkedAt':new Date()[_0x3db729(0x101)]()})}});}}async[a37_0x5479c3(0xec)](_0x1be16a,_0x2b660b){const _0x20ea30=a37_0x5479c3,_0x3bbf35=Date['now']();try{const _0x451b2f=_0x1be16a['shop'],_0x2dddaa=_0x451b2f[_0x20ea30(0xfa)];if(!_0x2dddaa?.[_0x20ea30(0xa9)]){console[_0x20ea30(0x160)]('No\x20webhook\x20URL\x20configured\x20for\x20shop\x20'+_0x451b2f['id']);return;}const _0x32cfbe=_0x2b660b===_0x20ea30(0x117)?_0x20ea30(0xef):_0x2b660b===_0x20ea30(0x9b)?_0x20ea30(0x109):_0x2b660b==='EXPIRED'?'payment.failed':_0x20ea30(0x157);if(!_0x2dddaa['webhookEvents']?.[_0x20ea30(0x145)](_0x32cfbe)){console[_0x20ea30(0x160)]('Webhook\x20event\x20'+_0x32cfbe+_0x20ea30(0x11d)+_0x451b2f['id']);return;}const _0x55823e={'event':_0x32cfbe,'payment':{'id':_0x1be16a['id'],'order_id':_0x1be16a[_0x20ea30(0x169)],'gateway_order_id':_0x1be16a[_0x20ea30(0x141)],'gateway':_0x20ea30(0xc2),'amount':_0x1be16a[_0x20ea30(0x10b)],'currency':_0x1be16a['currency'],'status':_0x2b660b[_0x20ea30(0x16c)](),'customer_email':_0x1be16a['customerEmail'],'customer_name':_0x1be16a[_0x20ea30(0xb1)],'created_at':_0x1be16a[_0x20ea30(0x107)],'updated_at':new Date()}},_0x5f2238=await fetch(_0x2dddaa[_0x20ea30(0xa9)],{'method':_0x20ea30(0x172),'headers':{'Content-Type':'application/json','User-Agent':'TesSoft\x20Payment\x20System/1.0'},'body':JSON[_0x20ea30(0xf8)](_0x55823e)}),_0x448e4b=Date[_0x20ea30(0xb0)]()-_0x3bbf35,_0x1e36b7=_0x5f2238['ok']?_0x20ea30(0x11b):await _0x5f2238[_0x20ea30(0xa6)]();loggerService_1['loggerService']['logShopWebhookSent'](_0x1be16a[_0x20ea30(0x135)],_0x2dddaa[_0x20ea30(0xa9)],_0x32cfbe,_0x5f2238[_0x20ea30(0xba)],_0x448e4b,_0x55823e),console[_0x20ea30(0x160)](_0x20ea30(0xab)+_0x2dddaa['webhookUrl']+_0x20ea30(0xe6)+_0x5f2238[_0x20ea30(0xba)]+'\x20('+_0x448e4b+_0x20ea30(0xe3));}catch(_0x3745c8){console['error'](_0x20ea30(0xa1),_0x3745c8),loggerService_1['loggerService'][_0x20ea30(0x122)](_0x1be16a['shopId'],_0x1be16a['shop']?.[_0x20ea30(0xfa)]?.[_0x20ea30(0xa9)]||_0x20ea30(0x131),_0x20ea30(0x12f),_0x3745c8,{});}}async['sendPaymentStatusNotification'](_0x39035d,_0x3b3f13){const _0x12d5ac=a37_0x5479c3;try{const _0x192866={'PENDING':_0x12d5ac(0x118),'PAID':_0x12d5ac(0xdd),'FAILED':_0x12d5ac(0x10f),'EXPIRED':_0x12d5ac(0xea)},_0x60bd9e=_0x192866[_0x3b3f13];if(!_0x60bd9e||_0x60bd9e===_0x12d5ac(0x118))return;await telegramBotService_1[_0x12d5ac(0xfd)][_0x12d5ac(0xe2)](_0x39035d[_0x12d5ac(0x135)],_0x39035d,_0x60bd9e);}catch(_0x4583b8){console[_0x12d5ac(0x142)](_0x12d5ac(0x97),_0x4583b8);}}async[a37_0x5479c3(0x12b)](_0x212eb0){const _0x26d42f=a37_0x5479c3;console['log']('🔍\x20[MANUAL]\x20Manual\x20check\x20requested\x20for\x20payment:\x20'+_0x212eb0);const _0x5ad5e4=await database_1[_0x26d42f(0x15f)][_0x26d42f(0x164)]['findUnique']({'where':{'id':_0x212eb0},'include':{'shop':{'select':{'id':!![],'name':!![],'settings':{'select':{'webhookUrl':!![],'webhookEvents':!![]}}}}}});if(!_0x5ad5e4)throw new Error('Payment\x20not\x20found');if(_0x5ad5e4[_0x26d42f(0x178)]!==_0x26d42f(0x149))throw new Error('Payment\x20is\x20not\x20a\x20CoinToPay\x20payment');console[_0x26d42f(0x160)](_0x26d42f(0xd8)+_0x212eb0),await this[_0x26d42f(0x140)](_0x5ad5e4),console['log'](_0x26d42f(0x152)+_0x212eb0);}['getServiceStats'](){const _0xbdc698=a37_0x5479c3,_0x2e8350=this[_0xbdc698(0x94)]?this[_0xbdc698(0x10a)]:undefined,_0x1c8a98=Array['from'](this['paymentTimers']['values']())[_0xbdc698(0x95)](_0x18ad1c=>({'paymentId':_0x18ad1c['paymentId'],'gatewayPaymentId':_0x18ad1c[_0xbdc698(0x16e)],'createdAt':_0x18ad1c[_0xbdc698(0x107)],'timersCount':_0x18ad1c[_0xbdc698(0x132)]['length']}));return{'isActive':!!this[_0xbdc698(0x94)],'globalCheckIntervalMinutes':this[_0xbdc698(0x10a)]/(0x3e8*0x3c),'expiryDays':this[_0xbdc698(0x14a)],'activeIndividualTimers':this[_0xbdc698(0x99)]['size'],'nextGlobalCheckIn':_0x2e8350,'paymentTimersDetails':_0x1c8a98};}[a37_0x5479c3(0xca)](_0x443a4b){const _0x6d3dbf=a37_0x5479c3,_0x254986=this[_0x6d3dbf(0x99)][_0x6d3dbf(0xc7)](_0x443a4b);if(_0x254986)return{'hasTimers':!![],'timersCount':_0x254986[_0x6d3dbf(0x132)][_0x6d3dbf(0x12a)],'createdAt':_0x254986[_0x6d3dbf(0x107)],'gatewayPaymentId':_0x254986[_0x6d3dbf(0x16e)]};return{'hasTimers':![]};}}exports[a37_0x5479c3(0x9e)]=CoinToPayStatusService,exports[a37_0x5479c3(0xb9)]=new CoinToPayStatusService();