'use strict';const a37_0x3071f2=a37_0x6065;(function(_0x3c8d12,_0x4186a1){const _0x2ca7f6=a37_0x6065,_0xf5aab2=_0x3c8d12();while(!![]){try{const _0x130cb2=-parseInt(_0x2ca7f6(0x14b))/0x1*(-parseInt(_0x2ca7f6(0x12a))/0x2)+parseInt(_0x2ca7f6(0x16f))/0x3+parseInt(_0x2ca7f6(0xe9))/0x4+parseInt(_0x2ca7f6(0x1b3))/0x5+parseInt(_0x2ca7f6(0x19b))/0x6*(parseInt(_0x2ca7f6(0x117))/0x7)+parseInt(_0x2ca7f6(0x1c5))/0x8*(-parseInt(_0x2ca7f6(0xee))/0x9)+parseInt(_0x2ca7f6(0x185))/0xa*(-parseInt(_0x2ca7f6(0x107))/0xb);if(_0x130cb2===_0x4186a1)break;else _0xf5aab2['push'](_0xf5aab2['shift']());}catch(_0x3f14b0){_0xf5aab2['push'](_0xf5aab2['shift']());}}}(a37_0x5399,0x46dc2));var __createBinding=this&&this[a37_0x3071f2(0x1c6)]||(Object[a37_0x3071f2(0x181)]?function(_0x3aa63f,_0x459df4,_0x2760c0,_0x58ac4a){const _0x9edd06=a37_0x3071f2;if(_0x58ac4a===undefined)_0x58ac4a=_0x2760c0;var _0x37067a=Object['getOwnPropertyDescriptor'](_0x459df4,_0x2760c0);(!_0x37067a||(_0x9edd06(0x146)in _0x37067a?!_0x459df4['__esModule']:_0x37067a[_0x9edd06(0x17e)]||_0x37067a[_0x9edd06(0x144)]))&&(_0x37067a={'enumerable':!![],'get':function(){return _0x459df4[_0x2760c0];}}),Object[_0x9edd06(0x145)](_0x3aa63f,_0x58ac4a,_0x37067a);}:function(_0x36bfb9,_0x333583,_0x4a716f,_0x1efd2d){if(_0x1efd2d===undefined)_0x1efd2d=_0x4a716f;_0x36bfb9[_0x1efd2d]=_0x333583[_0x4a716f];}),__setModuleDefault=this&&this[a37_0x3071f2(0x191)]||(Object[a37_0x3071f2(0x181)]?function(_0x4b6ed5,_0x36961c){const _0x2ecbeb=a37_0x3071f2;Object[_0x2ecbeb(0x145)](_0x4b6ed5,_0x2ecbeb(0x138),{'enumerable':!![],'value':_0x36961c});}:function(_0x58274f,_0x36e772){const _0x5cc5ac=a37_0x3071f2;_0x58274f[_0x5cc5ac(0x138)]=_0x36e772;}),__importStar=this&&this['__importStar']||(function(){var _0x3e50a8=function(_0x431a89){const _0x29e27a=a37_0x6065;return _0x3e50a8=Object[_0x29e27a(0x18c)]||function(_0x23cf8b){const _0x340c89=_0x29e27a;var _0x32036e=[];for(var _0x27aba2 in _0x23cf8b)if(Object[_0x340c89(0x1b2)][_0x340c89(0x15d)][_0x340c89(0x157)](_0x23cf8b,_0x27aba2))_0x32036e[_0x32036e['length']]=_0x27aba2;return _0x32036e;},_0x3e50a8(_0x431a89);};return function(_0x503626){const _0x99709b=a37_0x6065;if(_0x503626&&_0x503626['__esModule'])return _0x503626;var _0x2d7605={};if(_0x503626!=null){for(var _0x532b64=_0x3e50a8(_0x503626),_0x540e5b=0x0;_0x540e5b<_0x532b64[_0x99709b(0x14e)];_0x540e5b++)if(_0x532b64[_0x540e5b]!==_0x99709b(0x138))__createBinding(_0x2d7605,_0x503626,_0x532b64[_0x540e5b]);}return __setModuleDefault(_0x2d7605,_0x503626),_0x2d7605;};}()),__importDefault=this&&this['__importDefault']||function(_0x222905){const _0x530901=a37_0x3071f2;return _0x222905&&_0x222905[_0x530901(0x12c)]?_0x222905:{'default':_0x222905};};Object['defineProperty'](exports,a37_0x3071f2(0x12c),{'value':!![]}),exports[a37_0x3071f2(0x187)]=exports[a37_0x3071f2(0x174)]=void 0x0;const coinToPayService_1=require(a37_0x3071f2(0x12f)),database_1=__importDefault(require(a37_0x3071f2(0x15e))),telegramBotService_1=require('./telegramBotService'),loggerService_1=require(a37_0x3071f2(0x1a0));class CoinToPayStatusService{constructor(){const _0x57f41a=a37_0x3071f2;this[_0x57f41a(0x17a)]=null,this[_0x57f41a(0x15a)]=0x3c*0x3c*0x3e8,this[_0x57f41a(0x11d)]=0x5,this[_0x57f41a(0x1d1)]=new Map(),this[_0x57f41a(0x173)]=new coinToPayService_1[(_0x57f41a(0x1c0))](),console[_0x57f41a(0x16e)](_0x57f41a(0x1b6));}['schedulePaymentChecks'](_0x267d5a,_0x585b1c){const _0x4ede9d=a37_0x3071f2;console[_0x4ede9d(0x16e)]('ü™ô\x20[DEBUG]\x20schedulePaymentChecks\x20called\x20with:'),console[_0x4ede9d(0x16e)]('\x20\x20\x20-\x20paymentId:\x20'+_0x267d5a),console[_0x4ede9d(0x16e)]('\x20\x20\x20-\x20gatewayPaymentId:\x20'+_0x585b1c),this[_0x4ede9d(0xe5)](_0x267d5a);const _0x369962=[],_0x4cd850=new Date(),_0x43d10a=[{'delay':0x1*0x3c*0x3e8,'description':_0x4ede9d(0x1d6)},{'delay':0x2*0x3c*0x3e8,'description':_0x4ede9d(0x16d)},{'delay':0x5*0x3c*0x3e8,'description':_0x4ede9d(0x1b8)},{'delay':0x5*0x3c*0x3e8,'description':'5\x20minutes'}];console[_0x4ede9d(0x16e)](_0x4ede9d(0x11b)+_0x43d10a[_0x4ede9d(0x14e)]+_0x4ede9d(0x104)+_0x267d5a);let _0x5bc391=0x0;_0x43d10a['forEach']((_0x34c998,_0x51ba16)=>{const _0x1943e9=_0x4ede9d;_0x5bc391+=_0x34c998[_0x1943e9(0x11f)];const _0x4a43ce=setTimeout(async()=>{const _0x4a2715=_0x1943e9;console['log'](_0x4a2715(0xf7)+(_0x51ba16+0x1)+_0x4a2715(0x15b)+_0x267d5a+_0x4a2715(0xff)+_0x34c998[_0x4a2715(0xf3)]+')');try{await this[_0x4a2715(0x1a8)](_0x267d5a),console[_0x4a2715(0x16e)]('‚úÖ\x20[TIMER]\x20Individual\x20check\x20#'+(_0x51ba16+0x1)+'\x20completed\x20for\x20payment\x20'+_0x267d5a);}catch(_0x4c861a){console[_0x4a2715(0x133)](_0x4a2715(0xfb)+(_0x51ba16+0x1)+_0x4a2715(0x135)+_0x267d5a+':',_0x4c861a),this['logCoinToPayError'](_0x267d5a,_0x585b1c,_0x4c861a,_0x4a2715(0x16c),{'checkNumber':_0x51ba16+0x1,'scheduledAfter':_0x34c998[_0x4a2715(0xf3)],'isIndividualCheck':!![]});}},_0x5bc391);_0x369962[_0x1943e9(0x1cb)](_0x4a43ce),console['log'](_0x1943e9(0x1ba)+(_0x51ba16+0x1)+_0x1943e9(0x135)+_0x267d5a+'\x20in\x20'+_0x5bc391/0x3e8+_0x1943e9(0x176)+_0x34c998['description']+')');});const _0x3e5c16=setInterval(async()=>{const _0x562c41=_0x4ede9d;console[_0x562c41(0x16e)](_0x562c41(0xfe)+_0x267d5a);try{const _0x475760=await database_1[_0x562c41(0x138)][_0x562c41(0x1aa)]['findUnique']({'where':{'id':_0x267d5a},'select':{'id':!![],'status':!![],'createdAt':!![],'gatewayPaymentId':!![]}});if(!_0x475760){console['log']('‚ùå\x20[HOURLY]\x20Payment\x20'+_0x267d5a+_0x562c41(0x193)),this[_0x562c41(0xe5)](_0x267d5a);return;}console[_0x562c41(0x16e)](_0x562c41(0x105)+_0x267d5a+_0x562c41(0x153)+_0x475760[_0x562c41(0xfc)]);if(_0x475760[_0x562c41(0xfc)]!=='PENDING'){console[_0x562c41(0x16e)](_0x562c41(0x1be)+_0x267d5a+'\x20status\x20is\x20'+_0x475760[_0x562c41(0xfc)]+_0x562c41(0xf9)),this[_0x562c41(0xe5)](_0x267d5a);return;}const _0x12de9c=Math[_0x562c41(0x1a4)]((Date[_0x562c41(0x11e)]()-_0x475760[_0x562c41(0x1b1)][_0x562c41(0x190)]())/(0x3e8*0x3c*0x3c*0x18));if(_0x12de9c>=this[_0x562c41(0x11d)]){console['log']('‚è∞\x20[HOURLY]\x20Payment\x20'+_0x267d5a+'\x20is\x20older\x20than\x20'+this[_0x562c41(0x11d)]+_0x562c41(0x1bc)),this['clearPaymentTimers'](_0x267d5a);return;}await this[_0x562c41(0x1a8)](_0x267d5a),console[_0x562c41(0x16e)](_0x562c41(0x192)+_0x267d5a);}catch(_0x1c5cfe){console[_0x562c41(0x133)](_0x562c41(0x1a9)+_0x267d5a+':',_0x1c5cfe),this['logCoinToPayError'](_0x267d5a,_0x585b1c,_0x1c5cfe,_0x562c41(0x16c),{'isHourlyCheck':!![],'isIndividualCheck':!![]});}},0x3c*0x3c*0x3e8);_0x369962['push'](_0x3e5c16),this['paymentTimers'][_0x4ede9d(0x1cd)](_0x267d5a,{'timers':_0x369962,'paymentId':_0x267d5a,'gatewayPaymentId':_0x585b1c,'createdAt':_0x4cd850}),console[_0x4ede9d(0x16e)](_0x4ede9d(0x1a3)+_0x43d10a[_0x4ede9d(0x14e)]+_0x4ede9d(0x10c)+_0x267d5a),console['log']('üìä\x20[DEBUG]\x20Total\x20active\x20payment\x20timers:\x20'+this[_0x4ede9d(0x1d1)][_0x4ede9d(0x126)]),this[_0x4ede9d(0x14a)](_0x267d5a,_0x585b1c,_0x4ede9d(0x136),_0x4ede9d(0x136),_0x4ede9d(0x16c),{'action':_0x4ede9d(0x158),'scheduledChecks':_0x43d10a['length'],'firstCheckIn':_0x43d10a[0x0][_0x4ede9d(0x11f)]/0x3e8,'totalTimers':this[_0x4ede9d(0x1d1)][_0x4ede9d(0x126)]});}[a37_0x3071f2(0xe5)](_0x171060){const _0x588bc1=a37_0x3071f2,_0x3d8f16=this[_0x588bc1(0x1d1)][_0x588bc1(0x146)](_0x171060);_0x3d8f16?(console['log']('üßπ\x20[DEBUG]\x20Clearing\x20'+_0x3d8f16['timers']['length']+'\x20timers\x20for\x20payment\x20'+_0x171060),_0x3d8f16[_0x588bc1(0x130)][_0x588bc1(0x120)]((_0x5bb205,_0x569f0e)=>{const _0x276faa=_0x588bc1;_0x5bb205&&(clearTimeout(_0x5bb205),clearInterval(_0x5bb205),console[_0x276faa(0x16e)](_0x276faa(0x16b)+(_0x569f0e+0x1)+'\x20for\x20payment\x20'+_0x171060));}),this[_0x588bc1(0x1d1)][_0x588bc1(0xf5)](_0x171060),console[_0x588bc1(0x16e)](_0x588bc1(0x1cc)+_0x171060+_0x588bc1(0xf4)+this[_0x588bc1(0x1d1)][_0x588bc1(0x126)])):console[_0x588bc1(0x16e)](_0x588bc1(0x1a1)+_0x171060+_0x588bc1(0x18b));}async[a37_0x3071f2(0x1a8)](_0x1d2182){const _0x2446f7=a37_0x3071f2;console[_0x2446f7(0x16e)](_0x2446f7(0x16a)+_0x1d2182);const _0x51fe3b=await database_1[_0x2446f7(0x138)][_0x2446f7(0x1aa)][_0x2446f7(0x121)]({'where':{'id':_0x1d2182},'select':{'id':!![],'gatewayPaymentId':!![],'amount':!![],'currency':!![],'status':!![],'shopId':!![],'createdAt':!![],'gateway':!![],'shop':{'select':{'id':!![],'name':!![],'settings':{'select':{'webhookUrl':!![],'webhookEvents':!![]}}}}}});if(!_0x51fe3b){console['log'](_0x2446f7(0x165)+_0x1d2182+'\x20not\x20found\x20in\x20database');return;}console[_0x2446f7(0x16e)](_0x2446f7(0x1d0)+_0x1d2182+_0x2446f7(0xf6)),console['log'](_0x2446f7(0x172)+_0x51fe3b[_0x2446f7(0x1ac)]),console[_0x2446f7(0x16e)](_0x2446f7(0x119)+_0x51fe3b[_0x2446f7(0xfc)]),console[_0x2446f7(0x16e)]('\x20\x20\x20-\x20GatewayPaymentId:\x20'+_0x51fe3b[_0x2446f7(0x156)]),console[_0x2446f7(0x16e)](_0x2446f7(0x18a)+_0x51fe3b[_0x2446f7(0x1bf)]+'\x20'+_0x51fe3b[_0x2446f7(0x15f)]),console[_0x2446f7(0x16e)](_0x2446f7(0x141)+_0x51fe3b[_0x2446f7(0x14f)]);if(_0x51fe3b[_0x2446f7(0x1ac)]!==_0x2446f7(0x175)){console['log'](_0x2446f7(0x177)+_0x1d2182+'\x20is\x20not\x20a\x20CoinToPay\x20payment\x20(gateway:\x20'+_0x51fe3b[_0x2446f7(0x1ac)]+')');return;}if(_0x51fe3b[_0x2446f7(0xfc)]!==_0x2446f7(0x136)){console[_0x2446f7(0x16e)]('‚ö†Ô∏è\x20[CHECK]\x20Payment\x20'+_0x1d2182+_0x2446f7(0x183)+_0x51fe3b[_0x2446f7(0xfc)]+_0x2446f7(0xf9)),this[_0x2446f7(0xe5)](_0x1d2182);return;}if(!_0x51fe3b[_0x2446f7(0x156)]){console[_0x2446f7(0x16e)](_0x2446f7(0x177)+_0x1d2182+_0x2446f7(0x194));return;}console[_0x2446f7(0x16e)](_0x2446f7(0x1a7)+_0x1d2182+_0x2446f7(0x17b)),await this[_0x2446f7(0x109)](_0x51fe3b);}[a37_0x3071f2(0x14a)](_0x8796a5,_0x5da996,_0x3e353e,_0x32e46d,_0x5ed1a3,_0x3f6ba3){const _0x5d41f2=a37_0x3071f2,_0x12f260={'type':_0x5d41f2(0x1ab),'paymentId':_0x8796a5,'gatewayPaymentId':_0x5da996,'oldStatus':_0x3e353e,'newStatus':_0x32e46d,'source':_0x5ed1a3,'timestamp':new Date()['toISOString'](),'details':_0x3f6ba3||{}};loggerService_1[_0x5d41f2(0x18d)][_0x5d41f2(0x14a)](_0x12f260),console[_0x5d41f2(0x16e)]('ü™ô\x20[LOG]\x20CoinToPay\x20Status\x20Change:\x20'+_0x8796a5+'\x20('+_0x5da996+')'),console[_0x5d41f2(0x16e)]('\x20\x20\x20üìä\x20Status:\x20'+_0x3e353e+_0x5d41f2(0x15c)+_0x32e46d),console['log'](_0x5d41f2(0x106)+_0x5ed1a3),console[_0x5d41f2(0x16e)](_0x5d41f2(0xed)+_0x12f260[_0x5d41f2(0x11c)]),_0x3f6ba3&&console[_0x5d41f2(0x16e)]('\x20\x20\x20üìù\x20Details:',_0x3f6ba3);}['logCoinToPayError'](_0x3fba61,_0xefeb58,_0x53d2b6,_0x4a9f88,_0x36a926){const _0x498257=a37_0x3071f2,_0x1410f5={'type':_0x498257(0x1ce),'paymentId':_0x3fba61,'gatewayPaymentId':_0xefeb58,'error':_0x53d2b6 instanceof Error?{'message':_0x53d2b6[_0x498257(0xe3)],'stack':_0x53d2b6[_0x498257(0x189)]}:_0x53d2b6,'source':_0x4a9f88,'timestamp':new Date()[_0x498257(0x137)](),'context':_0x36a926||{}};loggerService_1['loggerService'][_0x498257(0x196)](_0x1410f5),console['error'](_0x498257(0x125)+_0x3fba61+'\x20('+_0xefeb58+')'),console['error'](_0x498257(0x127)+(_0x53d2b6 instanceof Error?_0x53d2b6[_0x498257(0xe3)]:_0x53d2b6)),console[_0x498257(0x133)]('\x20\x20\x20üìç\x20Source:\x20'+_0x4a9f88),console['error'](_0x498257(0xed)+_0x1410f5[_0x498257(0x11c)]),_0x36a926&&console[_0x498257(0x133)](_0x498257(0xe6),_0x36a926);}[a37_0x3071f2(0x1c7)](){const _0x5bd4f9=a37_0x3071f2;console[_0x5bd4f9(0x16e)]('ü™ô\x20[INIT]\x20Starting\x20CoinToPay\x20periodic\x20status\x20checking\x20(global\x20checks\x20every\x201\x20hour)'),this[_0x5bd4f9(0x13f)]()[_0x5bd4f9(0x159)](_0x16853c=>{const _0x534832=_0x5bd4f9;console[_0x534832(0x133)](_0x534832(0x1c3),_0x16853c);}),this[_0x5bd4f9(0x17a)]=setInterval(async()=>{const _0x1b0c1f=_0x5bd4f9;try{console['log']('ü™ô\x20[GLOBAL]\x20Starting\x20global\x20check\x20cycle...'),await this[_0x1b0c1f(0x13f)](),console[_0x1b0c1f(0x16e)](_0x1b0c1f(0x103));}catch(_0x2ae862){console[_0x1b0c1f(0x133)](_0x1b0c1f(0x19c),_0x2ae862);}},this['GLOBAL_CHECK_INTERVAL_MS']),console[_0x5bd4f9(0x16e)](_0x5bd4f9(0x154));}[a37_0x3071f2(0x124)](){const _0x3668a4=a37_0x3071f2;console[_0x3668a4(0x16e)](_0x3668a4(0x19f));this[_0x3668a4(0x17a)]&&(clearInterval(this[_0x3668a4(0x17a)]),this[_0x3668a4(0x17a)]=null,console[_0x3668a4(0x16e)](_0x3668a4(0x13a)));const _0x4d0543=this[_0x3668a4(0x1d1)][_0x3668a4(0x126)];for(const [_0x1435ae]of this[_0x3668a4(0x1d1)]){this[_0x3668a4(0xe5)](_0x1435ae);}console[_0x3668a4(0x16e)](_0x3668a4(0x122)+_0x4d0543+'\x20individual\x20payment\x20timers');}async[a37_0x3071f2(0x13f)](){const _0x53af75=a37_0x3071f2;try{console[_0x53af75(0x16e)](_0x53af75(0x1c9));const _0x59dd1e=await database_1[_0x53af75(0x138)][_0x53af75(0x1aa)]['findMany']({'where':{'gateway':'cointopay','status':_0x53af75(0x136),'gatewayPaymentId':{'not':null}},'select':{'id':!![],'gatewayPaymentId':!![],'amount':!![],'currency':!![],'status':!![],'shopId':!![],'createdAt':!![],'shop':{'select':{'id':!![],'name':!![],'settings':{'select':{'webhookUrl':!![],'webhookEvents':!![]}}}}}});console['log'](_0x53af75(0x171)+_0x59dd1e[_0x53af75(0x14e)]+_0x53af75(0x170));if(_0x59dd1e[_0x53af75(0x14e)]===0x0){console[_0x53af75(0x16e)](_0x53af75(0xf2));return;}const _0x2a2d38=await this['checkExpiredPayments'](_0x59dd1e);console[_0x53af75(0x16e)](_0x53af75(0x1cf)+_0x2a2d38[_0x53af75(0x14e)]+_0x53af75(0xfd));let _0x45a46d=0x0,_0x47424e=0x0;for(const _0x4b7e6a of _0x59dd1e){try{if(_0x2a2d38[_0x53af75(0x19d)](_0x4b7e6a['id'])){console[_0x53af75(0x16e)](_0x53af75(0x140)+_0x4b7e6a['id']+'\x20already\x20marked\x20as\x20expired,\x20skipping\x20global\x20check'),_0x47424e++;continue;}if(this[_0x53af75(0x1d1)][_0x53af75(0x179)](_0x4b7e6a['id'])){console[_0x53af75(0x16e)]('‚è∞\x20[GLOBAL]\x20Payment\x20'+_0x4b7e6a['id']+_0x53af75(0x1c1)),_0x47424e++;continue;}const _0x32eba3=(Date[_0x53af75(0x11e)]()-_0x4b7e6a[_0x53af75(0x1b1)][_0x53af75(0x190)]())/(0x3e8*0x3c*0x3c);if(_0x32eba3<0x1){console[_0x53af75(0x16e)](_0x53af75(0x140)+_0x4b7e6a['id']+_0x53af75(0x195)+_0x32eba3['toFixed'](0x1)+_0x53af75(0x14d)),_0x47424e++;continue;}console['log']('üîç\x20[GLOBAL]\x20Checking\x20old\x20payment\x20'+_0x4b7e6a['id']+_0x53af75(0x198)+_0x32eba3[_0x53af75(0x199)](0x1)+'h)'),await this[_0x53af75(0x109)](_0x4b7e6a),_0x45a46d++,await new Promise(_0x3bb640=>setTimeout(_0x3bb640,0x7d0));}catch(_0x2a9bd8){console[_0x53af75(0x133)](_0x53af75(0x10e)+_0x4b7e6a['id']+':',_0x2a9bd8),this[_0x53af75(0x196)](_0x4b7e6a['id'],_0x4b7e6a['gatewayPaymentId']||'unknown',_0x2a9bd8,_0x53af75(0x16c),{'isGlobalCheck':!![],'paymentAmount':_0x4b7e6a[_0x53af75(0x1bf)],'paymentCurrency':_0x4b7e6a[_0x53af75(0x15f)],'shopId':_0x4b7e6a[_0x53af75(0x14f)],'createdAt':_0x4b7e6a[_0x53af75(0x1b1)]}),loggerService_1[_0x53af75(0x18d)][_0x53af75(0x10b)](_0x53af75(0x175),_0x53af75(0x1c2)+_0x4b7e6a['gatewayPaymentId'],_0x2a9bd8);}}console['log'](_0x53af75(0x1d2)+_0x45a46d+_0x53af75(0xe4)+_0x47424e+'\x20skipped,\x20'+_0x2a2d38[_0x53af75(0x14e)]+_0x53af75(0x115));}catch(_0x1cea20){console[_0x53af75(0x133)](_0x53af75(0x102),_0x1cea20);}}async['checkExpiredPayments'](_0x318601){const _0x13b7d3=a37_0x3071f2,_0x23889=[],_0x631d8c=new Date();_0x631d8c[_0x13b7d3(0xea)](_0x631d8c['getDate']()-this[_0x13b7d3(0x11d)]),console['log'](_0x13b7d3(0x1d3)+this['EXPIRY_DAYS']+_0x13b7d3(0x131)+_0x631d8c[_0x13b7d3(0x137)]()+')');for(const _0x52f6c1 of _0x318601){if(_0x52f6c1[_0x13b7d3(0x1b1)]<_0x631d8c){console[_0x13b7d3(0x16e)]('‚è∞\x20[EXPIRY]\x20Payment\x20'+_0x52f6c1['id']+_0x13b7d3(0x147)+this['EXPIRY_DAYS']+_0x13b7d3(0x150));try{this[_0x13b7d3(0x14a)](_0x52f6c1['id'],_0x52f6c1['gatewayPaymentId']||_0x13b7d3(0x1b5),_0x13b7d3(0x136),_0x13b7d3(0x1a5),_0x13b7d3(0x1ae),{'reason':_0x13b7d3(0x17f)+this[_0x13b7d3(0x11d)]+_0x13b7d3(0x116),'createdAt':_0x52f6c1[_0x13b7d3(0x1b1)],'daysSinceCreation':Math[_0x13b7d3(0x1a4)]((Date['now']()-_0x52f6c1['createdAt']['getTime']())/(0x3e8*0x3c*0x3c*0x18)),'paymentAmount':_0x52f6c1[_0x13b7d3(0x1bf)],'paymentCurrency':_0x52f6c1['currency'],'shopId':_0x52f6c1[_0x13b7d3(0x14f)]}),await database_1['default'][_0x13b7d3(0x1aa)]['update']({'where':{'id':_0x52f6c1['id']},'data':{'status':_0x13b7d3(0x1a5),'updatedAt':new Date(),'adminNotes':_0x13b7d3(0xec)+this[_0x13b7d3(0x11d)]+'\x20days\x20without\x20payment\x20confirmation'}}),await database_1['default'][_0x13b7d3(0x1a6)][_0x13b7d3(0x181)]({'data':{'paymentId':_0x52f6c1['id'],'shopId':_0x52f6c1[_0x13b7d3(0x14f)],'event':_0x13b7d3(0xf1),'statusCode':0xc8,'responseBody':JSON[_0x13b7d3(0x1af)]({'reason':_0x13b7d3(0x17f)+this[_0x13b7d3(0x11d)]+'\x20days','createdAt':_0x52f6c1['createdAt'],'expiredAt':new Date()['toISOString'](),'daysSinceCreation':Math[_0x13b7d3(0x1a4)]((Date[_0x13b7d3(0x11e)]()-_0x52f6c1[_0x13b7d3(0x1b1)][_0x13b7d3(0x190)]())/(0x3e8*0x3c*0x3c*0x18))})}}),await this[_0x13b7d3(0x19e)](_0x52f6c1,'EXPIRED'),await this[_0x13b7d3(0x163)](_0x52f6c1,_0x13b7d3(0x1a5)),this['clearPaymentTimers'](_0x52f6c1['id']),_0x23889[_0x13b7d3(0x1cb)](_0x52f6c1['id']),console[_0x13b7d3(0x16e)]('‚úÖ\x20[EXPIRY]\x20Payment\x20'+_0x52f6c1['id']+'\x20marked\x20as\x20EXPIRED\x20due\x20to\x20'+this[_0x13b7d3(0x11d)]+_0x13b7d3(0x18e));}catch(_0xccc5b0){console['error']('‚ùå\x20[EXPIRY]\x20Failed\x20to\x20expire\x20payment\x20'+_0x52f6c1['id']+':',_0xccc5b0),this[_0x13b7d3(0x196)](_0x52f6c1['id'],_0x52f6c1['gatewayPaymentId']||_0x13b7d3(0x1b5),_0xccc5b0,_0x13b7d3(0x1ae),{'reason':'Failed\x20to\x20mark\x20payment\x20as\x20expired','createdAt':_0x52f6c1[_0x13b7d3(0x1b1)],'daysSinceCreation':Math['floor']((Date[_0x13b7d3(0x11e)]()-_0x52f6c1[_0x13b7d3(0x1b1)][_0x13b7d3(0x190)]())/(0x3e8*0x3c*0x3c*0x18))});}}}return _0x23889;}async['checkSinglePayment'](_0x30f01f){const _0x11cb69=a37_0x3071f2;if(!_0x30f01f[_0x11cb69(0x156)]){console[_0x11cb69(0x16e)](_0x11cb69(0x177)+_0x30f01f['id']+'\x20has\x20no\x20gatewayPaymentId,\x20skipping');return;}console[_0x11cb69(0x16e)](_0x11cb69(0x1ca)+_0x30f01f['id']+'\x20('+_0x30f01f[_0x11cb69(0x156)]+')');try{const _0x108850=await this['coinToPayService'][_0x11cb69(0x13d)](_0x30f01f[_0x11cb69(0x156)]);console['log'](_0x11cb69(0x1d0)+_0x30f01f['id']+_0x11cb69(0x114)+_0x108850['status']);_0x108850[_0x11cb69(0x10f)]&&console[_0x11cb69(0x16e)](_0x11cb69(0x1d0)+_0x30f01f['id']+_0x11cb69(0x113),{'iban':_0x108850[_0x11cb69(0x10f)][_0x11cb69(0x182)]||_0x11cb69(0x10d),'transactionId':_0x108850[_0x11cb69(0x10f)][_0x11cb69(0x168)],'createdOn':_0x108850[_0x11cb69(0x10f)][_0x11cb69(0x12d)],'confirmedOn':_0x108850['paymentDetails'][_0x11cb69(0x166)]||_0x11cb69(0x178)});if(_0x108850[_0x11cb69(0xfc)]!==_0x30f01f[_0x11cb69(0xfc)]){console['log'](_0x11cb69(0x108)+_0x30f01f['id']+_0x11cb69(0x1c8)+_0x30f01f['status']+'\x20to\x20'+_0x108850[_0x11cb69(0xfc)]),this['logCoinToPayStatus'](_0x30f01f['id'],_0x30f01f['gatewayPaymentId'],_0x30f01f[_0x11cb69(0xfc)],_0x108850[_0x11cb69(0xfc)],'status_check',{'paymentDetails':_0x108850[_0x11cb69(0x10f)],'amount':_0x108850[_0x11cb69(0x1bf)],'currency':_0x108850['currency'],'shopId':_0x30f01f[_0x11cb69(0x14f)],'checkTimestamp':new Date()[_0x11cb69(0x137)]()});const _0x1254b4={'status':_0x108850['status'],'updatedAt':new Date()};_0x108850[_0x11cb69(0xfc)]===_0x11cb69(0x1d5)&&_0x30f01f[_0x11cb69(0xfc)]!==_0x11cb69(0x1d5)&&(_0x1254b4[_0x11cb69(0x13e)]=new Date(),console[_0x11cb69(0x16e)](_0x11cb69(0xf0)+_0x30f01f['id']+_0x11cb69(0x142)+_0x1254b4[_0x11cb69(0x13e)][_0x11cb69(0x137)]()));if(_0x108850['paymentDetails']){const _0x25984a=_0x108850[_0x11cb69(0x10f)];_0x25984a[_0x11cb69(0x182)]&&(_0x1254b4[_0x11cb69(0x1c4)]=_0x25984a[_0x11cb69(0x182)],console['log'](_0x11cb69(0x162)+_0x25984a[_0x11cb69(0x182)]));if(_0x25984a[_0x11cb69(0x1bd)]){const _0x2225bf=_0x30f01f['adminNotes']||'',_0x15a9ce=_0x11cb69(0x148)+_0x25984a['bankDetails'];_0x1254b4[_0x11cb69(0xfa)]=_0x2225bf?_0x2225bf+'\x0a\x0a'+_0x15a9ce:_0x15a9ce,console[_0x11cb69(0x16e)]('üè¶\x20[CHECK]\x20Saved\x20bank\x20details\x20to\x20admin\x20notes');}_0x25984a['transactionId']&&console[_0x11cb69(0x16e)](_0x11cb69(0x1bb)+_0x25984a[_0x11cb69(0x168)]),_0x25984a['confirmedOn']&&console[_0x11cb69(0x16e)]('‚úÖ\x20[CHECK]\x20Transaction\x20confirmed\x20on:\x20'+_0x25984a[_0x11cb69(0x166)]);}await database_1[_0x11cb69(0x138)][_0x11cb69(0x1aa)][_0x11cb69(0x186)]({'where':{'id':_0x30f01f['id']},'data':_0x1254b4}),await database_1['default'][_0x11cb69(0x1a6)][_0x11cb69(0x181)]({'data':{'paymentId':_0x30f01f['id'],'shopId':_0x30f01f[_0x11cb69(0x14f)],'event':'cointopay_status_check_'+_0x108850['status'][_0x11cb69(0x111)](),'statusCode':0xc8,'responseBody':JSON[_0x11cb69(0x1af)]({'oldStatus':_0x30f01f[_0x11cb69(0xfc)],'newStatus':_0x108850['status'],'paymentDetails':_0x108850[_0x11cb69(0x10f)],'checkedAt':new Date()[_0x11cb69(0x137)]()})}}),await this['sendShopWebhook'](_0x30f01f,_0x108850[_0x11cb69(0xfc)]),await this[_0x11cb69(0x163)](_0x30f01f,_0x108850[_0x11cb69(0xfc)]);if(_0x108850[_0x11cb69(0xfc)]==='PAID'&&_0x30f01f[_0x11cb69(0xfc)]!==_0x11cb69(0x1d5))try{const {PaymentLinkService:_0xb34d6d}=await Promise['resolve']()['then'](()=>__importStar(require(_0x11cb69(0x10a)))),_0x4c6424=new _0xb34d6d();await _0x4c6424[_0x11cb69(0xe8)](_0x30f01f['id']),console['log'](_0x11cb69(0x118)+_0x30f01f['id']);}catch(_0x75c085){console['error'](_0x11cb69(0x110)+_0x30f01f['id']+':',_0x75c085);}_0x108850[_0x11cb69(0xfc)]!==_0x11cb69(0x136)&&(console['log'](_0x11cb69(0x180)+_0x30f01f['id']+_0x11cb69(0x1b7)+_0x108850['status']+_0x11cb69(0x1ad)),this['clearPaymentTimers'](_0x30f01f['id'])),console[_0x11cb69(0x16e)]('‚úÖ\x20[CHECK]\x20Payment\x20'+_0x30f01f['id']+_0x11cb69(0x139));}else console[_0x11cb69(0x16e)](_0x11cb69(0x1d0)+_0x30f01f['id']+'\x20status\x20unchanged\x20('+_0x108850['status']+')'),this['logCoinToPayStatus'](_0x30f01f['id'],_0x30f01f['gatewayPaymentId'],_0x30f01f[_0x11cb69(0xfc)],_0x108850[_0x11cb69(0xfc)],_0x11cb69(0x16c),{'statusUnchanged':!![],'paymentDetails':_0x108850[_0x11cb69(0x10f)],'amount':_0x108850[_0x11cb69(0x1bf)],'currency':_0x108850[_0x11cb69(0x15f)],'shopId':_0x30f01f[_0x11cb69(0x14f)],'checkTimestamp':new Date()[_0x11cb69(0x137)]()});}catch(_0x3b965c){console['error'](_0x11cb69(0x132)+_0x30f01f['id']+':',_0x3b965c),this['logCoinToPayError'](_0x30f01f['id'],_0x30f01f[_0x11cb69(0x156)],_0x3b965c,_0x11cb69(0x16c),{'paymentAmount':_0x30f01f[_0x11cb69(0x1bf)],'paymentCurrency':_0x30f01f[_0x11cb69(0x15f)],'shopId':_0x30f01f[_0x11cb69(0x14f)],'createdAt':_0x30f01f[_0x11cb69(0x1b1)]}),await database_1[_0x11cb69(0x138)][_0x11cb69(0x1a6)]['create']({'data':{'paymentId':_0x30f01f['id'],'shopId':_0x30f01f[_0x11cb69(0x14f)],'event':_0x11cb69(0x13b),'statusCode':0x1f4,'responseBody':JSON['stringify']({'error':_0x3b965c instanceof Error?_0x3b965c[_0x11cb69(0xe3)]:'Unknown\x20error','gatewayPaymentId':_0x30f01f[_0x11cb69(0x156)],'checkedAt':new Date()[_0x11cb69(0x137)]()})}});}}async[a37_0x3071f2(0x19e)](_0x1dd13c,_0x3c9086){const _0x240b64=a37_0x3071f2,_0x219366=Date['now']();try{const _0x310dbb=_0x1dd13c[_0x240b64(0x134)],_0x4969a5=_0x310dbb['settings'];if(!_0x4969a5?.[_0x240b64(0x155)]){console[_0x240b64(0x16e)](_0x240b64(0x112)+_0x310dbb['id']);return;}const _0x10e411=_0x3c9086===_0x240b64(0x1d5)?_0x240b64(0x149):_0x3c9086===_0x240b64(0x101)?_0x240b64(0x1d4):_0x3c9086===_0x240b64(0x1a5)?_0x240b64(0x1d4):_0x240b64(0x129);if(!_0x4969a5[_0x240b64(0x160)]?.[_0x240b64(0x19d)](_0x10e411)){console[_0x240b64(0x16e)](_0x240b64(0x1b4)+_0x10e411+'\x20not\x20enabled\x20for\x20shop\x20'+_0x310dbb['id']);return;}const _0x539497={'event':_0x10e411,'payment':{'id':_0x1dd13c['id'],'order_id':_0x1dd13c['orderId'],'gateway_order_id':_0x1dd13c['gatewayOrderId'],'gateway':_0x240b64(0x161),'amount':_0x1dd13c[_0x240b64(0x1bf)],'currency':_0x1dd13c[_0x240b64(0x15f)],'status':_0x3c9086[_0x240b64(0x111)](),'customer_email':_0x1dd13c[_0x240b64(0x151)],'customer_name':_0x1dd13c[_0x240b64(0x14c)],'created_at':_0x1dd13c[_0x240b64(0x1b1)],'updated_at':new Date()}},_0x4c8389=await fetch(_0x4969a5[_0x240b64(0x155)],{'method':_0x240b64(0x19a),'headers':{'Content-Type':_0x240b64(0x18f),'User-Agent':_0x240b64(0x1a2)},'body':JSON[_0x240b64(0x1af)](_0x539497)}),_0x232fb1=Date[_0x240b64(0x11e)]()-_0x219366,_0x3cc3fe=_0x4c8389['ok']?_0x240b64(0x13c):await _0x4c8389['text']();loggerService_1[_0x240b64(0x18d)]['logShopWebhookSent'](_0x1dd13c[_0x240b64(0x14f)],_0x4969a5[_0x240b64(0x155)],_0x10e411,_0x4c8389['status'],_0x232fb1,_0x539497),console['log'](_0x240b64(0x12e)+_0x4969a5[_0x240b64(0x155)]+_0x240b64(0x188)+_0x4c8389[_0x240b64(0xfc)]+'\x20('+_0x232fb1+_0x240b64(0x169));}catch(_0x236726){console[_0x240b64(0x133)](_0x240b64(0x197),_0x236726),loggerService_1[_0x240b64(0x18d)][_0x240b64(0x100)](_0x1dd13c[_0x240b64(0x14f)],_0x1dd13c['shop']?.[_0x240b64(0x12b)]?.['webhookUrl']||_0x240b64(0x1b5),_0x240b64(0x123),_0x236726,{});}}async[a37_0x3071f2(0x163)](_0x2c9438,_0x34b9a0){const _0x34c5ec=a37_0x3071f2;try{const _0x4cae3d={'PENDING':_0x34c5ec(0x17c),'PAID':_0x34c5ec(0xeb),'FAILED':_0x34c5ec(0xef),'EXPIRED':'expired'},_0x5d9d1a=_0x4cae3d[_0x34b9a0];if(!_0x5d9d1a||_0x5d9d1a===_0x34c5ec(0x17c))return;await telegramBotService_1['telegramBotService'][_0x34c5ec(0x184)](_0x2c9438[_0x34c5ec(0x14f)],_0x2c9438,_0x5d9d1a);}catch(_0x6caab){console[_0x34c5ec(0x133)](_0x34c5ec(0xf8),_0x6caab);}}async[a37_0x3071f2(0x143)](_0x68e93f){const _0x11481a=a37_0x3071f2;console[_0x11481a(0x16e)](_0x11481a(0x152)+_0x68e93f);const _0x1619bb=await database_1['default'][_0x11481a(0x1aa)]['findUnique']({'where':{'id':_0x68e93f},'include':{'shop':{'select':{'id':!![],'name':!![],'settings':{'select':{'webhookUrl':!![],'webhookEvents':!![]}}}}}});if(!_0x1619bb)throw new Error(_0x11481a(0x1b9));if(_0x1619bb[_0x11481a(0x1ac)]!==_0x11481a(0x175))throw new Error(_0x11481a(0x11a));console['log']('‚úÖ\x20[MANUAL]\x20Starting\x20manual\x20check\x20for\x20CoinToPay\x20payment\x20'+_0x68e93f),await this[_0x11481a(0x109)](_0x1619bb),console[_0x11481a(0x16e)]('‚úÖ\x20[MANUAL]\x20Manual\x20check\x20completed\x20for\x20payment\x20'+_0x68e93f);}[a37_0x3071f2(0x167)](){const _0x4b3f07=a37_0x3071f2,_0x2481e5=this[_0x4b3f07(0x17a)]?this[_0x4b3f07(0x15a)]:undefined,_0x146307=Array[_0x4b3f07(0x17d)](this[_0x4b3f07(0x1d1)][_0x4b3f07(0x164)]())[_0x4b3f07(0xe7)](_0x2e7470=>({'paymentId':_0x2e7470[_0x4b3f07(0x128)],'gatewayPaymentId':_0x2e7470['gatewayPaymentId'],'createdAt':_0x2e7470[_0x4b3f07(0x1b1)],'timersCount':_0x2e7470[_0x4b3f07(0x130)][_0x4b3f07(0x14e)]}));return{'isActive':!!this['globalCheckInterval'],'globalCheckIntervalMinutes':this[_0x4b3f07(0x15a)]/(0x3e8*0x3c),'expiryDays':this['EXPIRY_DAYS'],'activeIndividualTimers':this[_0x4b3f07(0x1d1)][_0x4b3f07(0x126)],'nextGlobalCheckIn':_0x2481e5,'paymentTimersDetails':_0x146307};}[a37_0x3071f2(0x1b0)](_0x51e6f2){const _0x114d75=a37_0x3071f2,_0x39457a=this['paymentTimers'][_0x114d75(0x146)](_0x51e6f2);if(_0x39457a)return{'hasTimers':!![],'timersCount':_0x39457a[_0x114d75(0x130)][_0x114d75(0x14e)],'createdAt':_0x39457a['createdAt'],'gatewayPaymentId':_0x39457a[_0x114d75(0x156)]};return{'hasTimers':![]};}}exports['CoinToPayStatusService']=CoinToPayStatusService,exports[a37_0x3071f2(0x187)]=new CoinToPayStatusService();function a37_0x6065(_0x19a667,_0x3bbc3f){const _0x5399a4=a37_0x5399();return a37_0x6065=function(_0x606505,_0x574807){_0x606505=_0x606505-0xe3;let _0x2b100f=_0x5399a4[_0x606505];return _0x2b100f;},a37_0x6065(_0x19a667,_0x3bbc3f);}function a37_0x5399(){const _0x217683=['has','globalCheckInterval','\x20is\x20valid\x20for\x20checking,\x20proceeding...','created','from','writable','Payment\x20older\x20than\x20','üßπ\x20[CHECK]\x20Payment\x20','create','iban','\x20status\x20is\x20','sendPaymentNotification','80HHXJmV','update','coinToPayStatusService','\x20with\x20status\x20','stack','\x20\x20\x20-\x20Amount:\x20','\x20to\x20clear','getOwnPropertyNames','loggerService','-day\x20timeout','application/json','getTime','__setModuleDefault','‚úÖ\x20[HOURLY]\x20Hourly\x20check\x20completed\x20for\x20payment\x20','\x20not\x20found,\x20clearing\x20timers','\x20has\x20no\x20gatewayPaymentId','\x20is\x20too\x20new\x20(','logCoinToPayError','Failed\x20to\x20send\x20shop\x20webhook:','\x20(age:\x20','toFixed','POST','6tqFwoJ','‚ùå\x20[GLOBAL]\x20Periodic\x20CoinToPay\x20status\x20check\x20failed:','includes','sendShopWebhook','üõë\x20[SHUTDOWN]\x20Stopping\x20CoinToPay\x20status\x20checking\x20service...','./loggerService','‚ö†Ô∏è\x20[DEBUG]\x20No\x20timers\x20found\x20for\x20payment\x20','TesSoft\x20Payment\x20System/1.0','‚úÖ\x20[DEBUG]\x20Successfully\x20scheduled\x20','floor','EXPIRED','webhookLog','‚úÖ\x20[CHECK]\x20Payment\x20','checkSinglePaymentById','‚ùå\x20[HOURLY]\x20Failed\x20hourly\x20check\x20for\x20payment\x20','payment','COINTOPAY_STATUS_CHANGE','gateway',',\x20clearing\x20individual\x20timers','auto_expire','stringify','getPaymentTimerInfo','createdAt','prototype','783215dHYutG','Webhook\x20event\x20','unknown','ü™ô\x20CoinToPayStatusService\x20initialized','\x20status\x20changed\x20to\x20','5\x20minutes','Payment\x20not\x20found','‚è∞\x20[DEBUG]\x20Scheduled\x20check\x20#','üÜî\x20[CHECK]\x20Transaction\x20ID:\x20','\x20days,\x20will\x20be\x20handled\x20by\x20global\x20expiry\x20check','bankDetails','‚úÖ\x20[HOURLY]\x20Payment\x20','amount','CoinToPayService','\x20has\x20individual\x20timers,\x20skipping\x20global\x20check','/status/','‚ùå\x20[INIT]\x20Initial\x20CoinToPay\x20status\x20check\x20failed:','remitterIban','496624ELZbOM','__createBinding','startPeriodicStatusCheck','\x20status\x20from\x20','ü™ô\x20[GLOBAL]\x20Getting\x20all\x20pending\x20CoinToPay\x20payments...','üîç\x20[CHECK]\x20Checking\x20CoinToPay\x20payment\x20','push','‚úÖ\x20[DEBUG]\x20All\x20timers\x20cleared\x20for\x20payment\x20','set','COINTOPAY_ERROR','‚è∞\x20[GLOBAL]\x20Found\x20','üìä\x20[CHECK]\x20Payment\x20','paymentTimers','‚úÖ\x20[GLOBAL]\x20Global\x20check\x20completed:\x20','‚è∞\x20[EXPIRY]\x20Checking\x20for\x20CoinToPay\x20payments\x20older\x20than\x20','payment.failed','PAID','1\x20minute','message','\x20checked,\x20','clearPaymentTimers','\x20\x20\x20üìù\x20Context:','map','handleSuccessfulPayment','2257836qamnZm','setDate','paid','Automatically\x20expired\x20after\x20','\x20\x20\x20üìÖ\x20Time:\x20','36dWuJXQ','failed','üí∞\x20[CHECK]\x20Payment\x20','cointopay_auto_expired','ü™ô\x20[GLOBAL]\x20No\x20pending\x20CoinToPay\x20payments\x20to\x20check','description','.\x20Remaining\x20active\x20timers:\x20','delete','\x20found:','ü™ô\x20[TIMER]\x20Individual\x20check\x20#','Failed\x20to\x20send\x20Telegram\x20payment\x20notification:',',\x20stopping\x20individual\x20checks','adminNotes','‚ùå\x20[TIMER]\x20Failed\x20individual\x20check\x20#','status','\x20expired\x20CoinToPay\x20payments','ü™ô\x20[HOURLY]\x20Hourly\x20check\x20triggered\x20for\x20payment\x20','\x20(after\x20','logShopWebhookError','FAILED','‚ùå\x20[GLOBAL]\x20Failed\x20to\x20get\x20pending\x20CoinToPay\x20payments:','‚úÖ\x20[GLOBAL]\x20Global\x20check\x20cycle\x20completed','\x20initial\x20timers\x20for\x20payment\x20','üìä\x20[HOURLY]\x20Payment\x20','\x20\x20\x20üìç\x20Source:\x20','1248544kodKWj','üîÑ\x20[CHECK]\x20Updating\x20payment\x20','checkSinglePayment','./paymentLinkService','logWhiteDomainError','\x20initial\x20checks\x20+\x20hourly\x20checks\x20for\x20payment\x20','not\x20found','‚ùå\x20[GLOBAL]\x20Failed\x20to\x20check\x20CoinToPay\x20payment\x20','paymentDetails','‚ùå\x20[CHECK]\x20Failed\x20to\x20update\x20payment\x20link\x20counter\x20for\x20payment\x20','toLowerCase','No\x20webhook\x20URL\x20configured\x20for\x20shop\x20','\x20details:','\x20status:\x20','\x20expired','\x20days','1254435ObUXBs','üìà\x20[CHECK]\x20Payment\x20link\x20counter\x20updated\x20for\x20payment\x20','\x20\x20\x20-\x20Status:\x20','Payment\x20is\x20not\x20a\x20CoinToPay\x20payment','ü™ô\x20[DEBUG]\x20Creating\x20','timestamp','EXPIRY_DAYS','now','delay','forEach','findUnique','üõë\x20[SHUTDOWN]\x20Cleared\x20','webhook_send','stopPeriodicStatusCheck','ü™ô\x20[ERROR]\x20CoinToPay\x20Error:\x20','size','\x20\x20\x20‚ùå\x20Error:\x20','paymentId','payment.pending','1762fmMeGn','settings','__esModule','createdOn','Shop\x20webhook\x20sent\x20to\x20','./gateways/coinToPayService','timers','\x20days\x20(created\x20before\x20','‚ùå\x20[CHECK]\x20Failed\x20to\x20check\x20payment\x20','error','shop','\x20for\x20payment\x20','PENDING','toISOString','default','\x20updated\x20successfully','üõë\x20[SHUTDOWN]\x20CoinToPay\x20global\x20status\x20checking\x20stopped','cointopay_status_check_error','Success','checkPaymentStatus','paidAt','checkAllPendingPayments','‚è∞\x20[GLOBAL]\x20Payment\x20','\x20\x20\x20-\x20ShopId:\x20','\x20marked\x20as\x20paid\x20at:\x20','checkPaymentById','configurable','defineProperty','get','\x20is\x20older\x20than\x20','Bank\x20Details:\x20','payment.success','logCoinToPayStatus','466KSrpsF','customerName','h),\x20skipping\x20global\x20check','length','shopId','\x20days,\x20marking\x20as\x20EXPIRED','customerEmail','üîç\x20[MANUAL]\x20Manual\x20check\x20requested\x20for\x20payment:\x20','\x20current\x20status:\x20','‚úÖ\x20[INIT]\x20CoinToPay\x20status\x20checking\x20service\x20started\x20(global\x20hourly\x20checks\x20+\x20individual\x20payment\x20timers)','webhookUrl','gatewayPaymentId','call','schedule_created','catch','GLOBAL_CHECK_INTERVAL_MS','\x20triggered\x20for\x20payment\x20','\x20->\x20','hasOwnProperty','../config/database','currency','webhookEvents','0100','üè¶\x20[CHECK]\x20Saved\x20IBAN:\x20','sendPaymentStatusNotification','values','‚ùå\x20[CHECK]\x20Payment\x20','confirmedOn','getServiceStats','transactionId','ms)','üîç\x20[CHECK]\x20Starting\x20check\x20for\x20payment\x20ID:\x20','üßπ\x20[DEBUG]\x20Cleared\x20timer\x20#','status_check','2\x20minutes','log','407199iDuXUw','\x20pending\x20CoinToPay\x20payments','ü™ô\x20[GLOBAL]\x20Found\x20','\x20\x20\x20-\x20Gateway:\x20','coinToPayService','CoinToPayStatusService','cointopay','\x20seconds\x20(','‚ö†Ô∏è\x20[CHECK]\x20Payment\x20','not\x20confirmed'];a37_0x5399=function(){return _0x217683;};return a37_0x5399();}