'use strict';const a77_0x24293e=a77_0x1890;(function(_0x8748d1,_0x29f188){const _0x2c7523=a77_0x1890,_0x3a9a80=_0x8748d1();while(!![]){try{const _0x4b0b65=parseInt(_0x2c7523(0x155))/0x1*(-parseInt(_0x2c7523(0x174))/0x2)+-parseInt(_0x2c7523(0x109))/0x3*(-parseInt(_0x2c7523(0x130))/0x4)+parseInt(_0x2c7523(0x101))/0x5*(-parseInt(_0x2c7523(0x110))/0x6)+-parseInt(_0x2c7523(0xe3))/0x7*(parseInt(_0x2c7523(0x197))/0x8)+parseInt(_0x2c7523(0x192))/0x9*(parseInt(_0x2c7523(0xe1))/0xa)+-parseInt(_0x2c7523(0x163))/0xb+parseInt(_0x2c7523(0x157))/0xc;if(_0x4b0b65===_0x29f188)break;else _0x3a9a80['push'](_0x3a9a80['shift']());}catch(_0x5c6b49){_0x3a9a80['push'](_0x3a9a80['shift']());}}}(a77_0xba69,0x5fe39));function a77_0xba69(){const _0x4bb145=['USD','last_week','ðŸ“…\x20Final\x20date\x20range:\x20','30d','split','199746TCZbni','message','createdAt','\x20\x20\x20â³\x20Awaiting\x20payout:\x20','this_week','8776fVFlxW','status','gateways','USDT\x20TRC20','startsWith',',\x20period:\x20','shopUrl','all','createPublicPayment','paymentGateways','USDT\x20ERC20','count','getPaymentsByShop','fullName','\x20USDT\x20(current\x20balance)','KLYME\x20EU','__esModule','webhookLog','getPayoutStats','length','custom_','Noda','erc20_usdc','defineProperty','ðŸ“…\x20Period\x20start:\x20','sourceCurrency','lte','180FhezpR','findUnique','1883iyVhBL','usdtErcWallet','getUTCFullYear','isArray','formatNetworkName','90d','Plisio','notes','getShopPayoutStats','getGatewayDisplayName','network','./paymentService','round','\x20\x20\x20ðŸ“…\x20This\x20month:\x20','test_payment_123','PENDING','gateway','error','getMonth','ðŸ“Š\x20Final\x20WHERE\x20conditions:','push','getUTCMonth','USDC\x20Ethereum','balance','customer','getDate','payout','ðŸ“…\x20Custom\x20period:\x20','...','name','35vClgJz','filter','ceil','CHARGEBACK','getFullYear','\x20USDT','USDC\x20Polygon','parse','1053NAHgAA','replace','webhookEvents','asc','updateWallets','convertToUSDT','UTC','620988nztlPA','Unknown\x20error','payment','POST','usdcErcWallet','amountUSDT','KLYME\x20DE','Failed\x20to\x20send\x20webhook:\x20','findMany','webhookUrl','telegram','generateDailyStatistics','ðŸ“Š\x20Shop\x20','event','merchantUrl','ðŸ“…\x20Date\x20end:\x20','redirectUrl','dailyRevenue','deletePayment','\x20to\x20','REFUND','REJECTED','test','gte','currencyService','today','wallets','usdcPolygonWallet','settings','username','country','paymentService','5260fvtwFC','usdtPolygonWallet','ShopService','_sum','test_gateway','getPayouts','set','desc','ðŸ“…\x20Custom\x20date\x20range:\x20','retryCount','shop','ðŸŒ\x20Method\x20filter:\x20','updatePayment','\x20USDT\x20(total\x20payouts)','COMPLETED','getPaymentByShopAndId','aggregate','ðŸ“…\x20Period\x20end:\x20','createPayment','toISOString','gatewaySettings','USDT\x20Polygon','getTime','setDate','../types/gateway','thisMonth','yesterday','findFirst','setHours','YESTERDAY','shopId','PAID','setUTCDate','getWebhookLogs','default','usdtTrcWallet','getPayments','416497CTdQup','reduce','13444368suiwMc','amountAfterGatewayCommissionUSDT','getUTCDay','Error\x20parsing\x20webhook\x20events:','getUTCDate','paymentId','totalPaidOut','log','getPayoutById','amount','./currencyService','all_time','1678424uTDcAG','getShopProfile','test_order_123','__importDefault','txid','dailyPayments','publicKey','get','CoinToPay','toUpperCase','currency','map','Payment\x20not\x20found','ðŸŒ\x20Network\x20filter:\x20','periodFrom','amountIsEditable','getPaymentById','2ypXaxd','this_month','last_month','AVAILABLE_GATEWAYS','stringify','Shop\x20not\x20found','customerEmail','getPayoutStatistics','polygon','language','erc20','paid','\x20\x20\x20ðŸ’µ\x20Available\x20balance:\x20','update','application/json','Test\x20webhook\x20sent\x20successfully\x20(','revenue','customerName','EXPIRED','Test\x20Gateway','ðŸ“Š\x20Calculating\x20shop\x20payout\x20stats\x20for\x20shop\x20','polygon_usdc','Webhook\x20returned\x20error:\x20','Payment\x20System/1.0\x20(Test)','usage'];a77_0xba69=function(){return _0x4bb145;};return a77_0xba69();}var __importDefault=this&&this[a77_0x24293e(0x166)]||function(_0x4a2b29){const _0x138e3e=a77_0x24293e;return _0x4a2b29&&_0x4a2b29[_0x138e3e(0xd6)]?_0x4a2b29:{'default':_0x4a2b29};};Object[a77_0x24293e(0xdd)](exports,'__esModule',{'value':!![]}),exports[a77_0x24293e(0x132)]=void 0x0;function a77_0x1890(_0x2b950a,_0x466321){_0x2b950a=_0x2b950a-0xc9;const _0xba6918=a77_0xba69();let _0x18907b=_0xba6918[_0x2b950a];return _0x18907b;}const database_1=__importDefault(require('../config/database')),currencyService_1=require(a77_0x24293e(0x161)),paymentService_1=require(a77_0x24293e(0xee)),gateway_1=require(a77_0x24293e(0x148));class ShopService{constructor(){const _0x435b5c=a77_0x24293e;this[_0x435b5c(0x12f)]=new paymentService_1['PaymentService']();}async[a77_0x24293e(0x164)](_0x28d026){const _0x2279a5=a77_0x24293e,_0x2c2384=await database_1[_0x2279a5(0x152)]['shop'][_0x2279a5(0xe2)]({'where':{'id':_0x28d026},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'usdcErcWallet':!![],'status':!![],'createdAt':!![],'settings':{'select':{'webhookUrl':!![],'webhookEvents':!![]}}}});if(!_0x2c2384)throw new Error(_0x2279a5(0x179));let _0x2b700d=[];if(_0x2c2384['settings']?.[_0x2279a5(0x10b)])try{_0x2b700d=Array[_0x2279a5(0xe6)](_0x2c2384[_0x2279a5(0x12c)][_0x2279a5(0x10b)])?_0x2c2384[_0x2279a5(0x12c)][_0x2279a5(0x10b)]:JSON['parse'](_0x2c2384[_0x2279a5(0x12c)][_0x2279a5(0x10b)]);}catch(_0x956197){console[_0x2279a5(0xf4)](_0x2279a5(0x15a),_0x956197),_0x2b700d=[];}const _0x24040d=gateway_1[_0x2279a5(0x177)][_0x2279a5(0x102)](_0x458e7a=>_0x458e7a['isActive'])[_0x2279a5(0x16e)](_0x116355=>_0x116355[_0x2279a5(0x100)]);let _0x53a5c3=_0x2c2384[_0x2279a5(0xcf)]?JSON[_0x2279a5(0x108)](_0x2c2384[_0x2279a5(0xcf)]):[];return Array[_0x2279a5(0xe6)](_0x53a5c3)&&(_0x53a5c3=_0x53a5c3[_0x2279a5(0x102)](_0x5bc46d=>_0x24040d['includes'](_0x5bc46d))),{'id':_0x2c2384['id'],'fullName':_0x2c2384['name'],'username':_0x2c2384[_0x2279a5(0x12d)],'telegramId':_0x2c2384[_0x2279a5(0x11a)],'merchantUrl':_0x2c2384[_0x2279a5(0xcc)],'gateways':_0x53a5c3,'gatewaySettings':_0x2c2384['gatewaySettings']?JSON[_0x2279a5(0x108)](_0x2c2384[_0x2279a5(0x144)]):null,'publicKey':_0x2c2384[_0x2279a5(0x169)],'webhookUrl':_0x2c2384[_0x2279a5(0x12c)]?.[_0x2279a5(0x119)]||null,'webhookEvents':_0x2b700d,'wallets':{'usdtPolygonWallet':_0x2c2384[_0x2279a5(0x131)],'usdtTrcWallet':_0x2c2384[_0x2279a5(0x153)],'usdtErcWallet':_0x2c2384[_0x2279a5(0xe4)],'usdcPolygonWallet':_0x2c2384['usdcPolygonWallet'],'usdcErcWallet':_0x2c2384[_0x2279a5(0x114)]},'status':_0x2c2384[_0x2279a5(0x198)],'createdAt':_0x2c2384[_0x2279a5(0x194)]};}async['updateShopProfile'](_0x369ae8,_0x1964ae){const _0x3119ab=a77_0x24293e,_0x1bdb58={};_0x1964ae['fullName']&&(_0x1bdb58['name']=_0x1964ae[_0x3119ab(0xd3)]);_0x1964ae['telegramId']!==undefined&&(_0x1bdb58['telegram']=_0x1964ae['telegramId']||null);_0x1964ae[_0x3119ab(0x11e)]&&(_0x1bdb58['shopUrl']=_0x1964ae['merchantUrl']);_0x1964ae[_0x3119ab(0x199)]&&(_0x1bdb58[_0x3119ab(0xcf)]=JSON[_0x3119ab(0x178)](_0x1964ae[_0x3119ab(0x199)]));_0x1964ae[_0x3119ab(0x144)]&&(_0x1bdb58[_0x3119ab(0x144)]=JSON[_0x3119ab(0x178)](_0x1964ae[_0x3119ab(0x144)]));_0x1964ae['wallets']&&(_0x1964ae[_0x3119ab(0x12a)][_0x3119ab(0x131)]!==undefined&&(_0x1bdb58[_0x3119ab(0x131)]=_0x1964ae[_0x3119ab(0x12a)][_0x3119ab(0x131)]||null),_0x1964ae['wallets']['usdtTrcWallet']!==undefined&&(_0x1bdb58[_0x3119ab(0x153)]=_0x1964ae[_0x3119ab(0x12a)][_0x3119ab(0x153)]||null),_0x1964ae[_0x3119ab(0x12a)][_0x3119ab(0xe4)]!==undefined&&(_0x1bdb58[_0x3119ab(0xe4)]=_0x1964ae['wallets'][_0x3119ab(0xe4)]||null),_0x1964ae['wallets']['usdcPolygonWallet']!==undefined&&(_0x1bdb58[_0x3119ab(0x12b)]=_0x1964ae[_0x3119ab(0x12a)][_0x3119ab(0x12b)]||null));const _0x2a393f=await database_1[_0x3119ab(0x152)][_0x3119ab(0x13a)][_0x3119ab(0x181)]({'where':{'id':_0x369ae8},'data':_0x1bdb58,'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'usdcErcWallet':!![],'status':!![],'createdAt':!![],'settings':{'select':{'webhookUrl':!![],'webhookEvents':!![]}}}});let _0x341630=[];if(_0x2a393f['settings']?.[_0x3119ab(0x10b)])try{_0x341630=Array[_0x3119ab(0xe6)](_0x2a393f[_0x3119ab(0x12c)]['webhookEvents'])?_0x2a393f[_0x3119ab(0x12c)][_0x3119ab(0x10b)]:JSON[_0x3119ab(0x108)](_0x2a393f[_0x3119ab(0x12c)]['webhookEvents']);}catch(_0x1d0d34){console[_0x3119ab(0xf4)](_0x3119ab(0x15a),_0x1d0d34),_0x341630=[];}return{'id':_0x2a393f['id'],'fullName':_0x2a393f[_0x3119ab(0x100)],'username':_0x2a393f['username'],'telegramId':_0x2a393f[_0x3119ab(0x11a)],'merchantUrl':_0x2a393f['shopUrl'],'gateways':_0x2a393f['paymentGateways']?JSON[_0x3119ab(0x108)](_0x2a393f['paymentGateways']):null,'gatewaySettings':_0x2a393f[_0x3119ab(0x144)]?JSON[_0x3119ab(0x108)](_0x2a393f[_0x3119ab(0x144)]):null,'publicKey':_0x2a393f[_0x3119ab(0x169)],'webhookUrl':_0x2a393f[_0x3119ab(0x12c)]?.[_0x3119ab(0x119)]||null,'webhookEvents':_0x341630,'wallets':{'usdtPolygonWallet':_0x2a393f[_0x3119ab(0x131)],'usdtTrcWallet':_0x2a393f[_0x3119ab(0x153)],'usdtErcWallet':_0x2a393f[_0x3119ab(0xe4)],'usdcPolygonWallet':_0x2a393f['usdcPolygonWallet'],'usdcErcWallet':_0x2a393f['usdcErcWallet']},'status':_0x2a393f[_0x3119ab(0x198)],'createdAt':_0x2a393f[_0x3119ab(0x194)]};}async[a77_0x24293e(0x10d)](_0x1cecdc,_0x3a2789){const _0x547a27=a77_0x24293e,_0x193296={};_0x3a2789[_0x547a27(0x131)]!==undefined&&(_0x193296[_0x547a27(0x131)]=_0x3a2789['usdtPolygonWallet']||null),_0x3a2789[_0x547a27(0x153)]!==undefined&&(_0x193296[_0x547a27(0x153)]=_0x3a2789['usdtTrcWallet']||null),_0x3a2789[_0x547a27(0xe4)]!==undefined&&(_0x193296[_0x547a27(0xe4)]=_0x3a2789[_0x547a27(0xe4)]||null),_0x3a2789['usdcPolygonWallet']!==undefined&&(_0x193296[_0x547a27(0x12b)]=_0x3a2789['usdcPolygonWallet']||null),_0x3a2789[_0x547a27(0x114)]!==undefined&&(_0x193296[_0x547a27(0x114)]=_0x3a2789[_0x547a27(0x114)]||null),await database_1['default'][_0x547a27(0x13a)][_0x547a27(0x181)]({'where':{'id':_0x1cecdc},'data':_0x193296});}async['testWebhook'](_0x127913){const _0x2a3a8d=a77_0x24293e,_0x22bbdd=await database_1[_0x2a3a8d(0x152)]['shop'][_0x2a3a8d(0xe2)]({'where':{'id':_0x127913},'include':{'settings':{'select':{'webhookUrl':!![]}}}});if(!_0x22bbdd?.[_0x2a3a8d(0x12c)]?.[_0x2a3a8d(0x119)])throw new Error('No\x20webhook\x20URL\x20configured');const _0x59086c={'event':_0x2a3a8d(0x126),'payment':{'id':_0x2a3a8d(0xf1),'order_id':_0x2a3a8d(0x165),'gateway':_0x2a3a8d(0x126),'amount':0x64,'currency':_0x2a3a8d(0x18d),'status':_0x2a3a8d(0x17f),'created_at':new Date()[_0x2a3a8d(0x143)]()}};try{const _0x2c8159=await fetch(_0x22bbdd[_0x2a3a8d(0x12c)][_0x2a3a8d(0x119)],{'method':_0x2a3a8d(0x113),'headers':{'Content-Type':_0x2a3a8d(0x182),'User-Agent':_0x2a3a8d(0x18b)},'body':JSON[_0x2a3a8d(0x178)](_0x59086c)});return _0x2c8159['ok']?{'success':!![],'message':_0x2a3a8d(0x183)+_0x2c8159[_0x2a3a8d(0x198)]+')'}:{'success':![],'message':_0x2a3a8d(0x18a)+_0x2c8159[_0x2a3a8d(0x198)]+'\x20'+_0x2c8159['statusText']};}catch(_0x1301df){return{'success':![],'message':_0x2a3a8d(0x117)+(_0x1301df instanceof Error?_0x1301df[_0x2a3a8d(0x193)]:_0x2a3a8d(0x111))};}}async[a77_0x24293e(0x142)](_0x523a6f){const _0x23b675=a77_0x24293e;return this[_0x23b675(0x12f)][_0x23b675(0xce)]({'public_key':'','gateway':_0x523a6f[_0x23b675(0xf3)],'order_id':undefined,'amount':_0x523a6f[_0x23b675(0x160)],'currency':_0x523a6f['currency'],'source_currency':_0x523a6f[_0x23b675(0xdf)],'usage':_0x523a6f[_0x23b675(0x18c)],'expires_at':_0x523a6f['expiresAt']?.[_0x23b675(0x143)](),'success_url':_0x523a6f[_0x23b675(0x120)],'fail_url':_0x523a6f[_0x23b675(0x120)],'customer_email':_0x523a6f[_0x23b675(0x17a)],'customer_name':_0x523a6f[_0x23b675(0x185)],'country':_0x523a6f[_0x23b675(0x12e)],'language':_0x523a6f[_0x23b675(0x17d)],'amount_is_editable':_0x523a6f[_0x23b675(0x172)],'max_payments':_0x523a6f['maxPayments'],'customer':_0x523a6f[_0x23b675(0xfb)]});}async[a77_0x24293e(0x154)](_0x154a30,_0x3b1dea){const _0x3bbd67=a77_0x24293e;return this[_0x3bbd67(0x12f)][_0x3bbd67(0xd2)](_0x154a30,_0x3b1dea);}async[a77_0x24293e(0x173)](_0x465690,_0x58f965){const _0x39787e=a77_0x24293e;return this[_0x39787e(0x12f)][_0x39787e(0x13f)](_0x465690,_0x58f965);}async[a77_0x24293e(0x13c)](_0x37688d,_0x45d6a4,_0x410582){const _0x2d7b44=a77_0x24293e,_0x32415c=await database_1[_0x2d7b44(0x152)][_0x2d7b44(0x112)][_0x2d7b44(0x14b)]({'where':{'id':_0x45d6a4,'shopId':_0x37688d}});if(!_0x32415c)throw new Error(_0x2d7b44(0x16f));const _0x17c69a=await database_1[_0x2d7b44(0x152)][_0x2d7b44(0x112)][_0x2d7b44(0x181)]({'where':{'id':_0x45d6a4},'data':{..._0x410582,'updatedAt':new Date()}});return _0x17c69a;}async[a77_0x24293e(0x122)](_0x5be3cc,_0x40887c){const _0x5cc1c8=a77_0x24293e,_0x348a3e=await database_1['default'][_0x5cc1c8(0x112)][_0x5cc1c8(0x14b)]({'where':{'id':_0x40887c,'shopId':_0x5be3cc}});if(!_0x348a3e)throw new Error(_0x5cc1c8(0x16f));await database_1['default'][_0x5cc1c8(0x112)]['delete']({'where':{'id':_0x40887c}});}[a77_0x24293e(0xe7)](_0x3686fb){const _0x24d099=a77_0x24293e,_0x2cb88b={'polygon':_0x24d099(0x145),'trc20':_0x24d099(0xc9),'erc20':_0x24d099(0xd0),'bsc':'USDT\x20BSC','polygon_usdc':_0x24d099(0x107),'erc20_usdc':_0x24d099(0xf9)};return _0x2cb88b[_0x3686fb]||_0x3686fb;}async[a77_0x24293e(0x135)](_0x21fb91,_0x2cf753){const _0x5f4bab=a77_0x24293e,{page:_0x33b030,limit:_0x29bca3,status:_0x5543b4,method:_0x2a4d92,network:_0xa9e4bd,dateFrom:_0x3445f7,dateTo:_0x59f36b,periodFrom:_0x1ddf86,periodTo:_0x38dc39}=_0x2cf753,_0x3d03c4=(_0x33b030-0x1)*_0x29bca3;console[_0x5f4bab(0x15e)]('ðŸ’°\x20Getting\x20payouts\x20with\x20filters:',_0x2cf753);const _0x19fa31={'shopId':_0x21fb91};_0x5543b4&&(_0x19fa31[_0x5f4bab(0x198)]=_0x5543b4[_0x5f4bab(0x16c)](),console[_0x5f4bab(0x15e)]('ðŸ“Š\x20Status\x20filter:\x20'+_0x5543b4[_0x5f4bab(0x16c)]()));if(_0x2a4d92)_0x19fa31[_0x5f4bab(0xed)]=_0x2a4d92,console[_0x5f4bab(0x15e)](_0x5f4bab(0x13b)+_0x2a4d92);else _0xa9e4bd&&(_0x19fa31[_0x5f4bab(0xed)]=_0xa9e4bd,console['log'](_0x5f4bab(0x170)+_0xa9e4bd));if(_0x3445f7||_0x59f36b||_0x1ddf86||_0x38dc39){_0x19fa31[_0x5f4bab(0x194)]={};if(_0x1ddf86){const _0x416315=new Date(_0x1ddf86);_0x416315['setHours'](0x0,0x0,0x0,0x1),_0x19fa31['createdAt'][_0x5f4bab(0x127)]=_0x416315,console[_0x5f4bab(0x15e)](_0x5f4bab(0xde)+_0x416315['toISOString']());}else{if(_0x3445f7){const _0x26b0a9=new Date(_0x3445f7);_0x26b0a9[_0x5f4bab(0x14c)](0x0,0x0,0x0,0x1),_0x19fa31[_0x5f4bab(0x194)][_0x5f4bab(0x127)]=_0x26b0a9,console[_0x5f4bab(0x15e)]('ðŸ“…\x20Date\x20start:\x20'+_0x26b0a9[_0x5f4bab(0x143)]());}}if(_0x38dc39){const _0x55c62d=new Date(_0x38dc39);_0x55c62d[_0x5f4bab(0x14c)](0x17,0x3b,0x3b,0x3e7),_0x19fa31[_0x5f4bab(0x194)][_0x5f4bab(0xe0)]=_0x55c62d,console['log'](_0x5f4bab(0x141)+_0x55c62d[_0x5f4bab(0x143)]());}else{if(_0x59f36b){const _0x496b27=new Date(_0x59f36b);_0x496b27[_0x5f4bab(0x14c)](0x17,0x3b,0x3b,0x3e7),_0x19fa31[_0x5f4bab(0x194)][_0x5f4bab(0xe0)]=_0x496b27,console['log'](_0x5f4bab(0x11f)+_0x496b27[_0x5f4bab(0x143)]());}}}console[_0x5f4bab(0x15e)](_0x5f4bab(0xf6),JSON['stringify'](_0x19fa31,null,0x2));const [_0x5e8a03,_0x2b60fd]=await Promise[_0x5f4bab(0xcd)]([database_1[_0x5f4bab(0x152)][_0x5f4bab(0xfd)][_0x5f4bab(0x118)]({'where':_0x19fa31,'skip':_0x3d03c4,'take':_0x29bca3,'orderBy':{'createdAt':_0x5f4bab(0x137)},'include':{'shop':{'select':{'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'usdcErcWallet':!![]}}}}),database_1[_0x5f4bab(0x152)][_0x5f4bab(0xfd)][_0x5f4bab(0xd1)]({'where':_0x19fa31})]);return{'payouts':_0x5e8a03[_0x5f4bab(0x16e)](_0x9d1b55=>{const _0x48635f=_0x5f4bab;let _0x2a8739=null;switch(_0x9d1b55[_0x48635f(0xed)]){case _0x48635f(0x17c):_0x2a8739=_0x9d1b55[_0x48635f(0x13a)]['usdtPolygonWallet'];break;case'trc20':_0x2a8739=_0x9d1b55[_0x48635f(0x13a)][_0x48635f(0x153)];break;case _0x48635f(0x17e):_0x2a8739=_0x9d1b55[_0x48635f(0x13a)]['usdtErcWallet'];break;case _0x48635f(0x189):_0x2a8739=_0x9d1b55['shop'][_0x48635f(0x12b)];break;case _0x48635f(0xdc):_0x2a8739=_0x9d1b55[_0x48635f(0x13a)][_0x48635f(0x114)];break;}return{'id':_0x9d1b55['id'],'amount':_0x9d1b55['amount'],'network':this[_0x48635f(0xe7)](_0x9d1b55['network']),'wallet':_0x2a8739,'status':_0x9d1b55[_0x48635f(0x198)],'txid':_0x9d1b55[_0x48635f(0x167)],'notes':_0x9d1b55['notes'],'periodFrom':_0x9d1b55[_0x48635f(0x171)],'periodTo':_0x9d1b55['periodTo'],'createdAt':_0x9d1b55[_0x48635f(0x194)],'paidAt':_0x9d1b55['paidAt']};}),'pagination':{'page':_0x33b030,'limit':_0x29bca3,'total':_0x2b60fd,'totalPages':Math[_0x5f4bab(0x103)](_0x2b60fd/_0x29bca3)}};}async[a77_0x24293e(0x15f)](_0x213f4d,_0x32b94a){const _0x3a6205=a77_0x24293e,_0x2b125d=await database_1[_0x3a6205(0x152)][_0x3a6205(0xfd)][_0x3a6205(0x14b)]({'where':{'id':_0x32b94a,'shopId':_0x213f4d}});if(!_0x2b125d)return null;return{'id':_0x2b125d['id'],'amount':_0x2b125d[_0x3a6205(0x160)],'network':_0x2b125d['network'],'status':_0x2b125d['status'],'txid':_0x2b125d['txid'],'notes':_0x2b125d[_0x3a6205(0xea)],'createdAt':_0x2b125d[_0x3a6205(0x194)],'paidAt':_0x2b125d['paidAt']};}async[a77_0x24293e(0x17b)](_0x4ad8f9,_0x36d069){const _0x529561=a77_0x24293e,_0x416070=new Date();let _0xf31187,_0x3a9132;switch(_0x36d069){case _0x529561(0x14a):case _0x529561(0x14d):const _0x295f28=new Date(_0x416070);_0x295f28[_0x529561(0x147)](_0x295f28[_0x529561(0xfc)]()-0x1),_0xf31187=new Date(_0x295f28),_0xf31187['setHours'](0x0,0x0,0x0,0x0),_0x3a9132=new Date(_0x295f28),_0x3a9132[_0x529561(0x14c)](0x17,0x3b,0x3b,0x3e7);break;case'7d':_0xf31187=new Date(_0x416070[_0x529561(0x146)]()-0x7*0x18*0x3c*0x3c*0x3e8);break;case _0x529561(0x190):_0xf31187=new Date(_0x416070[_0x529561(0x146)]()-0x1e*0x18*0x3c*0x3c*0x3e8);break;case _0x529561(0xe8):_0xf31187=new Date(_0x416070[_0x529561(0x146)]()-0x5a*0x18*0x3c*0x3c*0x3e8);break;default:_0xf31187=new Date(_0x416070['getTime']()-0x1e*0x18*0x3c*0x3c*0x3e8);}const _0x2a048b={'gte':_0xf31187};_0x3a9132&&(_0x2a048b[_0x529561(0xe0)]=_0x3a9132);const [_0x117eb5,_0x47e0fe,_0x4ebb87,_0x2d79f7,_0x30fb47,_0x55a914]=await Promise[_0x529561(0xcd)]([database_1['default'][_0x529561(0xfd)][_0x529561(0xd1)]({'where':{'shopId':_0x4ad8f9,'createdAt':_0x2a048b}}),database_1['default'][_0x529561(0xfd)][_0x529561(0xd1)]({'where':{'shopId':_0x4ad8f9,'status':_0x529561(0x13e),'createdAt':_0x2a048b}}),database_1[_0x529561(0x152)]['payout'][_0x529561(0xd1)]({'where':{'shopId':_0x4ad8f9,'status':_0x529561(0xf2),'createdAt':_0x2a048b}}),database_1[_0x529561(0x152)]['payout'][_0x529561(0xd1)]({'where':{'shopId':_0x4ad8f9,'status':_0x529561(0x125),'createdAt':_0x2a048b}}),database_1[_0x529561(0x152)][_0x529561(0xfd)][_0x529561(0x118)]({'where':{'shopId':_0x4ad8f9,'createdAt':_0x2a048b},'select':{'amount':!![],'status':!![],'network':!![]}}),database_1[_0x529561(0x152)]['payout'][_0x529561(0x118)]({'where':{'shopId':_0x4ad8f9},'take':0xa,'orderBy':{'createdAt':_0x529561(0x137)},'select':{'id':!![],'amount':!![],'network':!![],'status':!![],'txid':!![],'createdAt':!![],'paidAt':!![]}})]),_0x508a16=_0x30fb47['reduce']((_0x309302,_0x19cca2)=>_0x309302+_0x19cca2['amount'],0x0),_0x4fb1d2=_0x30fb47[_0x529561(0x102)](_0x52eaa3=>_0x52eaa3[_0x529561(0x198)]==='COMPLETED')[_0x529561(0x156)]((_0x419906,_0x33b459)=>_0x419906+_0x33b459['amount'],0x0),_0x5f1bbd=_0x30fb47['filter'](_0x4ff258=>_0x4ff258['status']===_0x529561(0xf2))[_0x529561(0x156)]((_0xd05600,_0x2ae3e4)=>_0xd05600+_0x2ae3e4[_0x529561(0x160)],0x0),_0x165676=_0x30fb47['reduce']((_0x479002,_0x1c2e2d)=>{const _0x4e331a=_0x529561;return _0x479002[_0x1c2e2d[_0x4e331a(0xed)]]=(_0x479002[_0x1c2e2d[_0x4e331a(0xed)]]||0x0)+0x1,_0x479002;},{}),_0x44521e=_0x30fb47['reduce']((_0x323b1c,_0x1bf8bf)=>{return _0x323b1c[_0x1bf8bf['status']]=(_0x323b1c[_0x1bf8bf['status']]||0x0)+0x1,_0x323b1c;},{});return{'totalPayouts':_0x117eb5,'completedPayouts':_0x47e0fe,'pendingPayouts':_0x4ebb87,'rejectedPayouts':_0x2d79f7,'totalAmount':_0x508a16,'completedAmount':_0x4fb1d2,'pendingAmount':_0x5f1bbd,'payoutsByMethod':_0x165676,'payoutsByStatus':_0x44521e,'recentPayouts':_0x55a914['map'](_0x3cac27=>({'id':_0x3cac27['id'],'shopId':_0x4ad8f9,'amount':_0x3cac27['amount'],'method':_0x3cac27['network'],'status':_0x3cac27[_0x529561(0x198)],'txid':_0x3cac27[_0x529561(0x167)],'createdAt':_0x3cac27['createdAt'],'paidAt':_0x3cac27['paidAt']}))};}async[a77_0x24293e(0xeb)](_0xc0623d){const _0x1a7829=a77_0x24293e;console['log'](_0x1a7829(0x188)+_0xc0623d+_0x1a7829(0xff));const _0x4a62b8=await database_1[_0x1a7829(0x152)]['shop']['findUnique']({'where':{'id':_0xc0623d},'select':{'id':!![],'name':!![],'username':!![],'balance':!![],'totalPaidOut':!![]}});if(!_0x4a62b8)throw new Error(_0x1a7829(0x179));const _0x3c84f7=new Date(),_0x33483e=new Date(_0x3c84f7[_0x1a7829(0x105)](),_0x3c84f7[_0x1a7829(0xf5)](),0x1),_0x3c0eed=new Date(_0x3c84f7[_0x1a7829(0x105)](),_0x3c84f7[_0x1a7829(0xf5)]()+0x1,0x0,0x17,0x3b,0x3b,0x3e7),_0x412d98=await database_1[_0x1a7829(0x152)][_0x1a7829(0xfd)][_0x1a7829(0x140)]({'_sum':{'amount':!![]},'where':{'shopId':_0xc0623d,'createdAt':{'gte':_0x33483e,'lte':_0x3c0eed},'status':_0x1a7829(0x13e)}}),_0x26c561=_0x412d98[_0x1a7829(0x133)][_0x1a7829(0x160)]||0x0,_0x24456c={'availableBalance':Math[_0x1a7829(0xef)](_0x4a62b8[_0x1a7829(0xfa)]*0x64)/0x64,'totalPaidOut':Math['round'](_0x4a62b8[_0x1a7829(0x15d)]*0x64)/0x64,'awaitingPayout':Math['round'](_0x4a62b8['balance']*0x64)/0x64,'thisMonth':Math[_0x1a7829(0xef)](_0x26c561*0x64)/0x64};return console['log'](_0x1a7829(0x11c)+_0x4a62b8[_0x1a7829(0x12d)]+'\x20payout\x20statistics\x20calculated:'),console['log'](_0x1a7829(0x180)+_0x24456c['availableBalance']+_0x1a7829(0xd4)),console[_0x1a7829(0x15e)]('\x20\x20\x20ðŸ’°\x20Total\x20paid\x20out:\x20'+_0x24456c[_0x1a7829(0x15d)]+_0x1a7829(0x13d)),console['log'](_0x1a7829(0x195)+_0x24456c['awaitingPayout']+_0x1a7829(0xd4)),console[_0x1a7829(0x15e)](_0x1a7829(0xf0)+_0x24456c[_0x1a7829(0x149)]+_0x1a7829(0x106)),_0x24456c;}[a77_0x24293e(0xec)](_0x14c18){const _0x5c3bee=a77_0x24293e,_0x20cc85={'test_gateway':_0x5c3bee(0x187),'plisio':_0x5c3bee(0xe9),'rapyd':'Rapyd','noda':_0x5c3bee(0xdb),'cointopay':_0x5c3bee(0x16b),'klyme_eu':_0x5c3bee(0xd5),'klyme_gb':'KLYME\x20GB','klyme_de':_0x5c3bee(0x116)};return _0x20cc85[_0x14c18]||_0x14c18;}async[a77_0x24293e(0xd8)](_0x40aa2f){const _0x28b8ef=a77_0x24293e;return this[_0x28b8ef(0xeb)](_0x40aa2f);}async[a77_0x24293e(0x151)](_0x5966e5,_0x52e336){const _0x52b61f=a77_0x24293e,{page:_0x3a948b,limit:_0x312b7f,paymentId:_0x596bb7}=_0x52e336,_0x17b8c3=(_0x3a948b-0x1)*_0x312b7f,_0x1d60b5={'shopId':_0x5966e5};_0x596bb7&&(_0x1d60b5[_0x52b61f(0x15c)]=_0x596bb7);const [_0x1166cf,_0x6accb2]=await Promise[_0x52b61f(0xcd)]([database_1[_0x52b61f(0x152)][_0x52b61f(0xd7)][_0x52b61f(0x118)]({'where':_0x1d60b5,'skip':_0x17b8c3,'take':_0x312b7f,'orderBy':{'createdAt':'desc'},'include':{'payment':{'select':{'id':!![],'amount':!![],'currency':!![]}}}}),database_1[_0x52b61f(0x152)][_0x52b61f(0xd7)][_0x52b61f(0xd1)]({'where':_0x1d60b5})]);return{'logs':_0x1166cf[_0x52b61f(0x16e)](_0xdb4f9f=>({'id':_0xdb4f9f['id'],'paymentId':_0xdb4f9f[_0x52b61f(0x15c)],'shopId':_0xdb4f9f[_0x52b61f(0x14e)],'event':_0xdb4f9f[_0x52b61f(0x11d)],'statusCode':_0xdb4f9f['statusCode'],'retryCount':_0xdb4f9f[_0x52b61f(0x139)],'responseBody':_0xdb4f9f['responseBody'],'createdAt':_0xdb4f9f['createdAt'],'payment':_0xdb4f9f['payment']})),'pagination':{'page':_0x3a948b,'limit':_0x312b7f,'total':_0x6accb2,'totalPages':Math[_0x52b61f(0x103)](_0x6accb2/_0x312b7f)}};}async['getStatistics'](_0x3d860b,_0x4e6e96,_0x3847e2,_0x38a243,_0x15a22d){const _0x560bfa=a77_0x24293e;console[_0x560bfa(0x15e)]('ðŸ“Š\x20Getting\x20statistics\x20for\x20shop\x20'+_0x3d860b+_0x560bfa(0xcb)+_0x4e6e96+',\x20dateFrom:\x20'+_0x3847e2+',\x20dateTo:\x20'+_0x38a243);const _0x54cfc3=_0x15a22d?new Date(_0x15a22d):new Date();let _0x554b4e,_0x89570;if(_0x3847e2&&_0x38a243){const _0x4d28aa=new Date(_0x3847e2),_0x33da30=new Date(_0x38a243);_0x554b4e=new Date(Date[_0x560bfa(0x10f)](_0x4d28aa['getUTCFullYear'](),_0x4d28aa[_0x560bfa(0xf8)](),_0x4d28aa['getUTCDate'](),0x0,0x0,0x0,0x0)),_0x89570=new Date(Date[_0x560bfa(0x10f)](_0x33da30[_0x560bfa(0xe5)](),_0x33da30[_0x560bfa(0xf8)](),_0x33da30[_0x560bfa(0x15b)](),0x17,0x3b,0x3b,0x3e7)),console['log'](_0x560bfa(0x138)+_0x554b4e['toISOString']()+_0x560bfa(0x123)+_0x89570['toISOString']());}else{if(_0x4e6e96&&_0x4e6e96[_0x560bfa(0xca)](_0x560bfa(0xda))){const _0x330722=_0x4e6e96[_0x560bfa(0x10a)](_0x560bfa(0xda),'')[_0x560bfa(0x191)]('_');if(_0x330722[_0x560bfa(0xd9)]===0x2){const _0x4924f8=new Date(_0x330722[0x0]),_0x2b2a7c=new Date(_0x330722[0x1]);_0x554b4e=new Date(Date[_0x560bfa(0x10f)](_0x4924f8[_0x560bfa(0xe5)](),_0x4924f8[_0x560bfa(0xf8)](),_0x4924f8[_0x560bfa(0x15b)](),0x0,0x0,0x0,0x0)),_0x89570=new Date(Date[_0x560bfa(0x10f)](_0x2b2a7c[_0x560bfa(0xe5)](),_0x2b2a7c['getUTCMonth'](),_0x2b2a7c[_0x560bfa(0x15b)](),0x17,0x3b,0x3b,0x3e7)),console[_0x560bfa(0x15e)](_0x560bfa(0xfe)+_0x554b4e[_0x560bfa(0x143)]()+_0x560bfa(0x123)+_0x89570['toISOString']());}else{const _0x5a29fc=new Date(Date[_0x560bfa(0x10f)](_0x54cfc3[_0x560bfa(0xe5)](),_0x54cfc3[_0x560bfa(0xf8)](),_0x54cfc3[_0x560bfa(0x15b)]()-0x1e));_0x554b4e=new Date(Date['UTC'](_0x5a29fc[_0x560bfa(0xe5)](),_0x5a29fc['getUTCMonth'](),_0x5a29fc[_0x560bfa(0x15b)](),0x0,0x0,0x0,0x0)),_0x89570=new Date(Date[_0x560bfa(0x10f)](_0x54cfc3[_0x560bfa(0xe5)](),_0x54cfc3[_0x560bfa(0xf8)](),_0x54cfc3[_0x560bfa(0x15b)](),0x17,0x3b,0x3b,0x3e7));}}else{const _0x3112db=_0x4e6e96||'this_month';switch(_0x3112db['toLowerCase']()){case _0x560bfa(0x129):_0x554b4e=new Date(Date[_0x560bfa(0x10f)](_0x54cfc3[_0x560bfa(0xe5)](),_0x54cfc3[_0x560bfa(0xf8)](),_0x54cfc3[_0x560bfa(0x15b)](),0x0,0x0,0x0,0x0)),_0x89570=new Date(Date[_0x560bfa(0x10f)](_0x54cfc3[_0x560bfa(0xe5)](),_0x54cfc3[_0x560bfa(0xf8)](),_0x54cfc3[_0x560bfa(0x15b)](),0x17,0x3b,0x3b,0x3e7));break;case _0x560bfa(0x14a):const _0x79ae59=new Date(_0x54cfc3);_0x79ae59[_0x560bfa(0x150)](_0x79ae59[_0x560bfa(0x15b)]()-0x1),_0x554b4e=new Date(Date[_0x560bfa(0x10f)](_0x79ae59['getUTCFullYear'](),_0x79ae59[_0x560bfa(0xf8)](),_0x79ae59[_0x560bfa(0x15b)](),0x0,0x0,0x0,0x0)),_0x89570=new Date(Date[_0x560bfa(0x10f)](_0x79ae59[_0x560bfa(0xe5)](),_0x79ae59[_0x560bfa(0xf8)](),_0x79ae59['getUTCDate'](),0x17,0x3b,0x3b,0x3e7));break;case _0x560bfa(0x196):const _0x4c425f=_0x54cfc3[_0x560bfa(0x159)](),_0x4759bf=_0x4c425f===0x0?-0x6:0x1-_0x4c425f,_0x1ccad9=_0x54cfc3[_0x560bfa(0x15b)]()+_0x4759bf;_0x554b4e=new Date(Date[_0x560bfa(0x10f)](_0x54cfc3[_0x560bfa(0xe5)](),_0x54cfc3[_0x560bfa(0xf8)](),_0x1ccad9,0x0,0x0,0x0,0x0)),_0x89570=new Date(Date[_0x560bfa(0x10f)](_0x54cfc3[_0x560bfa(0xe5)](),_0x54cfc3[_0x560bfa(0xf8)](),_0x54cfc3[_0x560bfa(0x15b)](),0x17,0x3b,0x3b,0x3e7));break;case _0x560bfa(0x18e):const _0x293fe6=new Date(Date[_0x560bfa(0x10f)](_0x54cfc3[_0x560bfa(0xe5)](),_0x54cfc3[_0x560bfa(0xf8)](),_0x54cfc3[_0x560bfa(0x15b)]()-0x7)),_0x44a3d1=_0x293fe6[_0x560bfa(0x159)](),_0x317bc5=_0x44a3d1===0x0?-0x6:0x1-_0x44a3d1,_0xe61704=_0x293fe6[_0x560bfa(0x15b)]()+_0x317bc5;_0x554b4e=new Date(Date['UTC'](_0x293fe6[_0x560bfa(0xe5)](),_0x293fe6['getUTCMonth'](),_0xe61704,0x0,0x0,0x0,0x0)),_0x89570=new Date(Date['UTC'](_0x293fe6[_0x560bfa(0xe5)](),_0x293fe6[_0x560bfa(0xf8)](),_0xe61704+0x6,0x17,0x3b,0x3b,0x3e7));break;case _0x560bfa(0x175):_0x554b4e=new Date(Date[_0x560bfa(0x10f)](_0x54cfc3[_0x560bfa(0xe5)](),_0x54cfc3[_0x560bfa(0xf8)](),0x1,0x0,0x0,0x0,0x0)),_0x89570=new Date(Date[_0x560bfa(0x10f)](_0x54cfc3['getUTCFullYear'](),_0x54cfc3[_0x560bfa(0xf8)](),_0x54cfc3[_0x560bfa(0x15b)](),0x17,0x3b,0x3b,0x3e7));break;case _0x560bfa(0x176):_0x554b4e=new Date(Date[_0x560bfa(0x10f)](_0x54cfc3[_0x560bfa(0xe5)](),_0x54cfc3[_0x560bfa(0xf8)]()-0x1,0x1,0x0,0x0,0x0,0x0)),_0x89570=new Date(Date['UTC'](_0x54cfc3[_0x560bfa(0xe5)](),_0x54cfc3['getUTCMonth'](),0x0,0x17,0x3b,0x3b,0x3e7));break;case _0x560bfa(0x162):_0x554b4e=new Date(Date[_0x560bfa(0x10f)](0x7e9,0x5,0xe,0x0,0x0,0x0,0x0)),_0x89570=new Date(Date['UTC'](_0x54cfc3[_0x560bfa(0xe5)](),_0x54cfc3[_0x560bfa(0xf8)](),_0x54cfc3['getUTCDate'](),0x17,0x3b,0x3b,0x3e7));break;default:_0x554b4e=new Date(Date[_0x560bfa(0x10f)](_0x54cfc3[_0x560bfa(0xe5)](),_0x54cfc3[_0x560bfa(0xf8)](),0x1,0x0,0x0,0x0,0x0)),_0x89570=new Date(Date[_0x560bfa(0x10f)](_0x54cfc3[_0x560bfa(0xe5)](),_0x54cfc3[_0x560bfa(0xf8)](),_0x54cfc3['getUTCDate'](),0x17,0x3b,0x3b,0x3e7));}}}console[_0x560bfa(0x15e)](_0x560bfa(0x18f)+_0x554b4e[_0x560bfa(0x143)]()+_0x560bfa(0x123)+_0x89570[_0x560bfa(0x143)]());const _0x165be8={'gte':_0x554b4e,'lte':_0x89570},[_0x54f9df,_0x1a0683,_0x307370,_0x179dc5,_0x32d2a8,_0x4fd44b,_0x126309,_0x553fec,_0x24c187,_0x12ab75]=await Promise[_0x560bfa(0xcd)]([database_1[_0x560bfa(0x152)][_0x560bfa(0x112)][_0x560bfa(0xd1)]({'where':{'shopId':_0x3d860b,'gateway':{'not':_0x560bfa(0x134)},'status':{'notIn':[_0x560bfa(0xf2),_0x560bfa(0x186)]},'createdAt':_0x165be8}}),database_1[_0x560bfa(0x152)]['payment'][_0x560bfa(0xd1)]({'where':{'shopId':_0x3d860b,'gateway':{'not':'test_gateway'},'status':_0x560bfa(0x14f),'createdAt':_0x165be8}}),database_1[_0x560bfa(0x152)]['payment'][_0x560bfa(0xd1)]({'where':{'shopId':_0x3d860b,'gateway':{'not':_0x560bfa(0x134)},'status':_0x560bfa(0x104)}}),database_1['default'][_0x560bfa(0x112)][_0x560bfa(0xd1)]({'where':{'shopId':_0x3d860b,'gateway':{'not':'test_gateway'},'status':_0x560bfa(0x124)}}),database_1[_0x560bfa(0x152)][_0x560bfa(0x112)]['findMany']({'where':{'shopId':_0x3d860b,'gateway':{'not':'test_gateway'},'status':'PAID','createdAt':_0x165be8},'select':{'amount':!![],'currency':!![],'amountUSDT':!![],'amountAfterGatewayCommissionUSDT':!![],'createdAt':!![]}}),database_1[_0x560bfa(0x152)]['payment']['findMany']({'where':{'shopId':_0x3d860b,'gateway':{'not':'test_gateway'}},'take':0xa,'orderBy':{'createdAt':'desc'},'select':{'id':!![],'gateway':!![],'amount':!![],'currency':!![],'status':!![],'createdAt':!![]}}),database_1[_0x560bfa(0x152)][_0x560bfa(0x112)][_0x560bfa(0x118)]({'where':{'shopId':_0x3d860b,'gateway':{'not':_0x560bfa(0x134)},'createdAt':_0x165be8},'select':{'status':!![],'amountUSDT':!![],'createdAt':!![]},'orderBy':{'createdAt':_0x560bfa(0x10c)}}),database_1['default']['payment'][_0x560bfa(0xd1)]({'where':{'shopId':_0x3d860b,'gateway':{'not':_0x560bfa(0x134)},'status':'PAID'}}),database_1['default'][_0x560bfa(0x112)][_0x560bfa(0x118)]({'where':{'shopId':_0x3d860b,'gateway':{'not':_0x560bfa(0x134)},'status':_0x560bfa(0x14f)},'select':{'amountAfterGatewayCommissionUSDT':!![]}}),database_1[_0x560bfa(0x152)][_0x560bfa(0x13a)][_0x560bfa(0xe2)]({'where':{'id':_0x3d860b},'select':{'balance':!![]}})]);let _0x308f7a=0x0,_0x49c751=0x0;for(const _0x37d4d3 of _0x32d2a8){if(_0x37d4d3['amountUSDT'])_0x308f7a+=_0x37d4d3[_0x560bfa(0x115)];else{const _0x5e7d67=await currencyService_1[_0x560bfa(0x128)][_0x560bfa(0x10e)](_0x37d4d3['amount'],_0x37d4d3[_0x560bfa(0x16d)]);_0x308f7a+=_0x5e7d67;}_0x37d4d3[_0x560bfa(0x158)]&&(_0x49c751+=_0x37d4d3[_0x560bfa(0x158)]);}let _0x4eabd7=0x0;for(const _0x10f4c9 of _0x24c187){_0x10f4c9[_0x560bfa(0x158)]&&(_0x4eabd7+=_0x10f4c9['amountAfterGatewayCommissionUSDT']);}const _0x27773d=this[_0x560bfa(0x11b)](_0x126309,_0x554b4e,_0x89570||_0x54cfc3),_0x453e41=_0x54f9df>0x0?_0x1a0683/_0x54f9df*0x64:0x0,_0x59cb82=_0x553fec>0x0?_0x307370/_0x553fec*0x64:0x0;return{'totalPayments':_0x54f9df,'successfulPayments':_0x1a0683,'totalRevenue':Math[_0x560bfa(0xef)](_0x308f7a*0x64)/0x64,'merchantEarnings':Math['round'](_0x49c751*0x64)/0x64,'merchantTotalRevenue':Math[_0x560bfa(0xef)](_0x4eabd7*0x64)/0x64,'payoutBalance':Math[_0x560bfa(0xef)]((_0x12ab75?.[_0x560bfa(0xfa)]||0x0)*0x64)/0x64,'conversionRate':Math['round'](_0x453e41*0x64)/0x64,'chargebackRate':Math[_0x560bfa(0xef)](_0x59cb82*0x64)/0x64,'chargebacks':_0x307370,'refunds':_0x179dc5,'dailyRevenue':_0x27773d[_0x560bfa(0x121)],'dailyPayments':_0x27773d[_0x560bfa(0x168)],'recentPayments':_0x4fd44b[_0x560bfa(0x16e)](_0x358a3c=>({'id':_0x358a3c['id'],'gateway':_0x358a3c[_0x560bfa(0xf3)],'amount':_0x358a3c['amount'],'currency':_0x358a3c['currency'],'status':_0x358a3c['status'],'createdAt':_0x358a3c[_0x560bfa(0x194)]}))};}[a77_0x24293e(0x11b)](_0x1de5a7,_0x4a63c5,_0x154b53){const _0x4c64bc=a77_0x24293e,_0x1e68e8=new Map(),_0x1746b7=new Date(_0x4a63c5);while(_0x1746b7<=_0x154b53){const _0x5a7352=_0x1746b7[_0x4c64bc(0x143)]()['split']('T')[0x0];_0x1e68e8[_0x4c64bc(0x136)](_0x5a7352,{'revenue':0x0,'count':0x0}),_0x1746b7['setDate'](_0x1746b7[_0x4c64bc(0xfc)]()+0x1);}for(const _0x3e4a91 of _0x1de5a7){const _0x93f8c9=_0x3e4a91['createdAt']['toISOString']()[_0x4c64bc(0x191)]('T')[0x0],_0x444154=_0x1e68e8[_0x4c64bc(0x16a)](_0x93f8c9);_0x444154&&(_0x444154[_0x4c64bc(0xd1)]+=0x1,_0x3e4a91[_0x4c64bc(0x198)]===_0x4c64bc(0x14f)&&_0x3e4a91['amountUSDT']&&(_0x444154[_0x4c64bc(0x184)]+=_0x3e4a91[_0x4c64bc(0x115)]));}const _0x3e018a=[],_0x19f3c0=[];for(const [_0x47d2f0,_0x4fc888]of _0x1e68e8){_0x3e018a[_0x4c64bc(0xf7)]({'date':_0x47d2f0,'amount':Math['round'](_0x4fc888[_0x4c64bc(0x184)]*0x64)/0x64}),_0x19f3c0[_0x4c64bc(0xf7)]({'date':_0x47d2f0,'count':_0x4fc888[_0x4c64bc(0xd1)]});}return{'dailyRevenue':_0x3e018a,'dailyPayments':_0x19f3c0};}}exports[a77_0x24293e(0x132)]=ShopService;