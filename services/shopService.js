'use strict';const a76_0x589f22=a76_0x3e13;(function(_0x32b43a,_0x42a046){const _0x146dc5=a76_0x3e13,_0x3322ea=_0x32b43a();while(!![]){try{const _0x2fc3b9=parseInt(_0x146dc5(0x117))/0x1+parseInt(_0x146dc5(0x14b))/0x2*(-parseInt(_0x146dc5(0x198))/0x3)+-parseInt(_0x146dc5(0x163))/0x4+parseInt(_0x146dc5(0x19b))/0x5*(parseInt(_0x146dc5(0x182))/0x6)+parseInt(_0x146dc5(0x183))/0x7+-parseInt(_0x146dc5(0x185))/0x8*(-parseInt(_0x146dc5(0x152))/0x9)+-parseInt(_0x146dc5(0x181))/0xa;if(_0x2fc3b9===_0x42a046)break;else _0x3322ea['push'](_0x3322ea['shift']());}catch(_0x5bbfd7){_0x3322ea['push'](_0x3322ea['shift']());}}}(a76_0x5c02,0x6894a));function a76_0x5c02(){const _0x34c43f=['customer','Rapyd','KLYME\x20DE','map','639nDmjGE','90d','this_month','this_week','usdcErcWallet','dailyRevenue','yesterday','\x20\x20\x20ğŸ’µ\x20Available\x20balance:\x20','totalPaidOut','gte','usage','shop','name','testWebhook','ShopService','updatePayment','Payment\x20not\x20found','678224xdusxL','getTime','gatewaySettings','ğŸŒ\x20Method\x20filter:\x20','custom_','getGatewayDisplayName','push','PaymentService','getUTCDay','default','\x20USDT\x20(total\x20payouts)','payout','Shop\x20not\x20found','event','updateShopProfile','country','asc','Test\x20Gateway','getUTCMonth','getStatistics','formatNetworkName','../config/database','setDate','CoinToPay','awaitingPayout','30d','gateways','delete','USDC\x20Ethereum','parse','8237840SqbWKP','90FOueRR','1949458ZuNbRs','round','18160CtNjuw','currencyService','customerEmail','log','getUTCFullYear','polygon_usdc','reduce','expiresAt','webhookEvents','usdtPolygonWallet','all','application/json','txid','settings','last_month','_sum','paymentGateways','getUTCDate','USDT\x20BSC','6dSzgyK','REJECTED','ğŸ“…\x20Final\x20date\x20range:\x20','110230xaUoHl','paymentId','amount','USDT\x20TRC20','toISOString','createPublicPayment','\x20to\x20','test_order_123','paidAt','deletePayment','getShopProfile','PAID','redirectUrl','createPayment','USDT\x20Polygon','getMonth','createdAt','ğŸ“…\x20Period\x20start:\x20','isArray','usdtTrcWallet','responseBody','Error\x20parsing\x20webhook\x20events:','ğŸŒ\x20Network\x20filter:\x20','UTC','\x20USDT\x20(current\x20balance)','update','polygon','stringify','defineProperty','usdcPolygonWallet','merchantUrl','ğŸ’°\x20Getting\x20payouts\x20with\x20filters:','KLYME\x20GB','retryCount','split','findUnique','error','__importDefault','username','notes','amountUSDT','generateDailyStatistics','status','CHARGEBACK','__esModule','aggregate','findFirst','ğŸ“Š\x20Final\x20WHERE\x20conditions:','ğŸ“…\x20Date\x20start:\x20','USDC\x20Polygon','ceil','Webhook\x20returned\x20error:\x20','trc20','getShopPayoutStats','getPayoutStatistics','gateway','webhookLog','shopUrl','797504XlwBHS','getPaymentsByShop','paymentService','periodFrom','PENDING','balance','publicKey','desc','fullName','getPayoutById','statusText','No\x20webhook\x20URL\x20configured','setHours','\x20\x20\x20ğŸ’°\x20Total\x20paid\x20out:\x20','getDate','findMany','./paymentService','usdtErcWallet','customerName',',\x20dateFrom:\x20','all_time','ğŸ“…\x20Custom\x20date\x20range:\x20','webhookUrl','amountIsEditable','sourceCurrency','test_payment_123','count','network','revenue','test_gateway','startsWith','getPayouts','toUpperCase','POST','ğŸ“…\x20Date\x20end:\x20','getPayments','ğŸ“Š\x20Calculating\x20shop\x20payout\x20stats\x20for\x20shop\x20','paid','erc20','currency','wallets','last_week','lte','COMPLETED','amountAfterGatewayCommissionUSDT','replace','shopId','\x20payout\x20statistics\x20calculated:','dailyPayments','telegram','statusCode','ğŸ“Š\x20Shop\x20','146156qVRwSw','\x20USDT','payment'];a76_0x5c02=function(){return _0x34c43f;};return a76_0x5c02();}var __importDefault=this&&this[a76_0x589f22(0x1c0)]||function(_0x1c760f){const _0x41364a=a76_0x589f22;return _0x1c760f&&_0x1c760f[_0x41364a(0x1c7)]?_0x1c760f:{'default':_0x1c760f};};function a76_0x3e13(_0x4c29f2,_0x1e8b4b){_0x4c29f2=_0x4c29f2-0x111;const _0x5c0242=a76_0x5c02();let _0x3e138a=_0x5c0242[_0x4c29f2];return _0x3e138a;}Object[a76_0x589f22(0x1b7)](exports,a76_0x589f22(0x1c7),{'value':!![]}),exports[a76_0x589f22(0x160)]=void 0x0;const database_1=__importDefault(require(a76_0x589f22(0x178))),currencyService_1=require('./currencyService'),paymentService_1=require(a76_0x589f22(0x127));class ShopService{constructor(){const _0x527880=a76_0x589f22;this[_0x527880(0x119)]=new paymentService_1[(_0x527880(0x16a))]();}async[a76_0x589f22(0x1a5)](_0x1c8efa){const _0x7c29d3=a76_0x589f22,_0xdd9c82=await database_1[_0x7c29d3(0x16c)]['shop'][_0x7c29d3(0x1be)]({'where':{'id':_0x1c8efa},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'usdcErcWallet':!![],'status':!![],'createdAt':!![],'settings':{'select':{'webhookUrl':!![],'webhookEvents':!![]}}}});if(!_0xdd9c82)throw new Error(_0x7c29d3(0x16f));let _0x503178=[];if(_0xdd9c82[_0x7c29d3(0x192)]?.['webhookEvents'])try{_0x503178=Array[_0x7c29d3(0x1ad)](_0xdd9c82[_0x7c29d3(0x192)][_0x7c29d3(0x18d)])?_0xdd9c82['settings'][_0x7c29d3(0x18d)]:JSON[_0x7c29d3(0x180)](_0xdd9c82[_0x7c29d3(0x192)][_0x7c29d3(0x18d)]);}catch(_0x1a9fd4){console[_0x7c29d3(0x1bf)](_0x7c29d3(0x1b0),_0x1a9fd4),_0x503178=[];}return{'id':_0xdd9c82['id'],'fullName':_0xdd9c82[_0x7c29d3(0x15e)],'username':_0xdd9c82[_0x7c29d3(0x1c1)],'telegramId':_0xdd9c82[_0x7c29d3(0x148)],'merchantUrl':_0xdd9c82[_0x7c29d3(0x116)],'gateways':_0xdd9c82['paymentGateways']?JSON[_0x7c29d3(0x180)](_0xdd9c82[_0x7c29d3(0x195)]):null,'gatewaySettings':_0xdd9c82['gatewaySettings']?JSON['parse'](_0xdd9c82['gatewaySettings']):null,'publicKey':_0xdd9c82[_0x7c29d3(0x11d)],'webhookUrl':_0xdd9c82[_0x7c29d3(0x192)]?.['webhookUrl']||null,'webhookEvents':_0x503178,'wallets':{'usdtPolygonWallet':_0xdd9c82[_0x7c29d3(0x18e)],'usdtTrcWallet':_0xdd9c82['usdtTrcWallet'],'usdtErcWallet':_0xdd9c82[_0x7c29d3(0x128)],'usdcPolygonWallet':_0xdd9c82[_0x7c29d3(0x1b8)],'usdcErcWallet':_0xdd9c82['usdcErcWallet']},'status':_0xdd9c82[_0x7c29d3(0x1c5)],'createdAt':_0xdd9c82[_0x7c29d3(0x1ab)]};}async[a76_0x589f22(0x171)](_0x2ab7b5,_0x545ac4){const _0x2b0f67=a76_0x589f22,_0x3abb71={};_0x545ac4[_0x2b0f67(0x11f)]&&(_0x3abb71[_0x2b0f67(0x15e)]=_0x545ac4[_0x2b0f67(0x11f)]);_0x545ac4['telegramId']!==undefined&&(_0x3abb71['telegram']=_0x545ac4['telegramId']||null);_0x545ac4[_0x2b0f67(0x1b9)]&&(_0x3abb71['shopUrl']=_0x545ac4[_0x2b0f67(0x1b9)]);_0x545ac4['gateways']&&(_0x3abb71[_0x2b0f67(0x195)]=JSON[_0x2b0f67(0x1b6)](_0x545ac4[_0x2b0f67(0x17d)]));_0x545ac4['gatewaySettings']&&(_0x3abb71[_0x2b0f67(0x165)]=JSON[_0x2b0f67(0x1b6)](_0x545ac4[_0x2b0f67(0x165)]));_0x545ac4['wallets']&&(_0x545ac4[_0x2b0f67(0x13f)][_0x2b0f67(0x18e)]!==undefined&&(_0x3abb71['usdtPolygonWallet']=_0x545ac4[_0x2b0f67(0x13f)][_0x2b0f67(0x18e)]||null),_0x545ac4[_0x2b0f67(0x13f)][_0x2b0f67(0x1ae)]!==undefined&&(_0x3abb71['usdtTrcWallet']=_0x545ac4[_0x2b0f67(0x13f)]['usdtTrcWallet']||null),_0x545ac4[_0x2b0f67(0x13f)][_0x2b0f67(0x128)]!==undefined&&(_0x3abb71[_0x2b0f67(0x128)]=_0x545ac4['wallets'][_0x2b0f67(0x128)]||null),_0x545ac4['wallets']['usdcPolygonWallet']!==undefined&&(_0x3abb71[_0x2b0f67(0x1b8)]=_0x545ac4[_0x2b0f67(0x13f)]['usdcPolygonWallet']||null));const _0x5a723f=await database_1[_0x2b0f67(0x16c)][_0x2b0f67(0x15d)]['update']({'where':{'id':_0x2ab7b5},'data':_0x3abb71,'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'usdcErcWallet':!![],'status':!![],'createdAt':!![],'settings':{'select':{'webhookUrl':!![],'webhookEvents':!![]}}}});let _0x50b97c=[];if(_0x5a723f[_0x2b0f67(0x192)]?.[_0x2b0f67(0x18d)])try{_0x50b97c=Array[_0x2b0f67(0x1ad)](_0x5a723f[_0x2b0f67(0x192)][_0x2b0f67(0x18d)])?_0x5a723f[_0x2b0f67(0x192)][_0x2b0f67(0x18d)]:JSON[_0x2b0f67(0x180)](_0x5a723f[_0x2b0f67(0x192)][_0x2b0f67(0x18d)]);}catch(_0x560447){console[_0x2b0f67(0x1bf)]('Error\x20parsing\x20webhook\x20events:',_0x560447),_0x50b97c=[];}return{'id':_0x5a723f['id'],'fullName':_0x5a723f[_0x2b0f67(0x15e)],'username':_0x5a723f[_0x2b0f67(0x1c1)],'telegramId':_0x5a723f[_0x2b0f67(0x148)],'merchantUrl':_0x5a723f[_0x2b0f67(0x116)],'gateways':_0x5a723f['paymentGateways']?JSON[_0x2b0f67(0x180)](_0x5a723f['paymentGateways']):null,'gatewaySettings':_0x5a723f['gatewaySettings']?JSON[_0x2b0f67(0x180)](_0x5a723f[_0x2b0f67(0x165)]):null,'publicKey':_0x5a723f['publicKey'],'webhookUrl':_0x5a723f[_0x2b0f67(0x192)]?.['webhookUrl']||null,'webhookEvents':_0x50b97c,'wallets':{'usdtPolygonWallet':_0x5a723f[_0x2b0f67(0x18e)],'usdtTrcWallet':_0x5a723f[_0x2b0f67(0x1ae)],'usdtErcWallet':_0x5a723f['usdtErcWallet'],'usdcPolygonWallet':_0x5a723f[_0x2b0f67(0x1b8)],'usdcErcWallet':_0x5a723f['usdcErcWallet']},'status':_0x5a723f[_0x2b0f67(0x1c5)],'createdAt':_0x5a723f[_0x2b0f67(0x1ab)]};}async['updateWallets'](_0xe7c3db,_0x214732){const _0x4179bc=a76_0x589f22,_0x2bbf90={};_0x214732[_0x4179bc(0x18e)]!==undefined&&(_0x2bbf90[_0x4179bc(0x18e)]=_0x214732[_0x4179bc(0x18e)]||null),_0x214732[_0x4179bc(0x1ae)]!==undefined&&(_0x2bbf90[_0x4179bc(0x1ae)]=_0x214732[_0x4179bc(0x1ae)]||null),_0x214732[_0x4179bc(0x128)]!==undefined&&(_0x2bbf90[_0x4179bc(0x128)]=_0x214732[_0x4179bc(0x128)]||null),_0x214732['usdcPolygonWallet']!==undefined&&(_0x2bbf90[_0x4179bc(0x1b8)]=_0x214732['usdcPolygonWallet']||null),_0x214732['usdcErcWallet']!==undefined&&(_0x2bbf90[_0x4179bc(0x156)]=_0x214732[_0x4179bc(0x156)]||null),await database_1[_0x4179bc(0x16c)][_0x4179bc(0x15d)][_0x4179bc(0x1b4)]({'where':{'id':_0xe7c3db},'data':_0x2bbf90});}async[a76_0x589f22(0x15f)](_0x4ddac6){const _0x3bbd3d=a76_0x589f22,_0x1a8219=await database_1[_0x3bbd3d(0x16c)][_0x3bbd3d(0x15d)][_0x3bbd3d(0x1be)]({'where':{'id':_0x4ddac6},'include':{'settings':{'select':{'webhookUrl':!![]}}}});if(!_0x1a8219?.[_0x3bbd3d(0x192)]?.[_0x3bbd3d(0x12d)])throw new Error(_0x3bbd3d(0x122));const _0x3dbc6d={'event':'test','payment':{'id':_0x3bbd3d(0x130),'order_id':_0x3bbd3d(0x1a2),'gateway':'test','amount':0x64,'currency':'USD','status':_0x3bbd3d(0x13c),'created_at':new Date()[_0x3bbd3d(0x19f)]()}};try{const _0x720a3e=await fetch(_0x1a8219[_0x3bbd3d(0x192)][_0x3bbd3d(0x12d)],{'method':_0x3bbd3d(0x138),'headers':{'Content-Type':_0x3bbd3d(0x190),'User-Agent':'Payment\x20System/1.0\x20(Test)'},'body':JSON[_0x3bbd3d(0x1b6)](_0x3dbc6d)});return _0x720a3e['ok']?{'success':!![],'message':'Test\x20webhook\x20sent\x20successfully\x20('+_0x720a3e[_0x3bbd3d(0x1c5)]+')'}:{'success':![],'message':_0x3bbd3d(0x1ce)+_0x720a3e[_0x3bbd3d(0x1c5)]+'\x20'+_0x720a3e[_0x3bbd3d(0x121)]};}catch(_0x49cd7b){return{'success':![],'message':'Failed\x20to\x20send\x20webhook:\x20'+(_0x49cd7b instanceof Error?_0x49cd7b['message']:'Unknown\x20error')};}}async[a76_0x589f22(0x1a8)](_0xfb02af){const _0x347ede=a76_0x589f22;return this[_0x347ede(0x119)][_0x347ede(0x1a0)]({'public_key':'','gateway':_0xfb02af[_0x347ede(0x114)],'order_id':undefined,'amount':_0xfb02af[_0x347ede(0x19d)],'currency':_0xfb02af['currency'],'source_currency':_0xfb02af[_0x347ede(0x12f)],'usage':_0xfb02af[_0x347ede(0x15c)],'expires_at':_0xfb02af[_0x347ede(0x18c)]?.[_0x347ede(0x19f)](),'success_url':_0xfb02af['redirectUrl'],'fail_url':_0xfb02af[_0x347ede(0x1a7)],'customer_email':_0xfb02af[_0x347ede(0x187)],'customer_name':_0xfb02af[_0x347ede(0x129)],'country':_0xfb02af[_0x347ede(0x172)],'language':_0xfb02af['language'],'amount_is_editable':_0xfb02af[_0x347ede(0x12e)],'max_payments':_0xfb02af['maxPayments'],'customer':_0xfb02af[_0x347ede(0x14e)]});}async[a76_0x589f22(0x13a)](_0x1bfe34,_0x556a5b){const _0x336070=a76_0x589f22;return this[_0x336070(0x119)][_0x336070(0x118)](_0x1bfe34,_0x556a5b);}async['getPaymentById'](_0x5e252a,_0x245f4f){const _0x1c75ea=a76_0x589f22;return this[_0x1c75ea(0x119)]['getPaymentByShopAndId'](_0x5e252a,_0x245f4f);}async[a76_0x589f22(0x161)](_0x22fb14,_0x1a8075,_0x1855dc){const _0x25bfa4=a76_0x589f22,_0x443e8c=await database_1[_0x25bfa4(0x16c)][_0x25bfa4(0x14d)]['findFirst']({'where':{'id':_0x1a8075,'shopId':_0x22fb14}});if(!_0x443e8c)throw new Error(_0x25bfa4(0x162));const _0x304ecc=await database_1[_0x25bfa4(0x16c)][_0x25bfa4(0x14d)][_0x25bfa4(0x1b4)]({'where':{'id':_0x1a8075},'data':{..._0x1855dc,'updatedAt':new Date()}});return _0x304ecc;}async[a76_0x589f22(0x1a4)](_0x4c44fa,_0x4d51b1){const _0x2e93a8=a76_0x589f22,_0x11c617=await database_1['default']['payment'][_0x2e93a8(0x1c9)]({'where':{'id':_0x4d51b1,'shopId':_0x4c44fa}});if(!_0x11c617)throw new Error('Payment\x20not\x20found');await database_1[_0x2e93a8(0x16c)]['payment'][_0x2e93a8(0x17e)]({'where':{'id':_0x4d51b1}});}[a76_0x589f22(0x177)](_0x4ee498){const _0x4c4c98=a76_0x589f22,_0x52e9d5={'polygon':_0x4c4c98(0x1a9),'trc20':_0x4c4c98(0x19e),'erc20':'USDT\x20ERC20','bsc':_0x4c4c98(0x197),'polygon_usdc':_0x4c4c98(0x1cc),'erc20_usdc':_0x4c4c98(0x17f)};return _0x52e9d5[_0x4ee498]||_0x4ee498;}async[a76_0x589f22(0x136)](_0x10fe37,_0x3b7795){const _0x44095a=a76_0x589f22,{page:_0x49963a,limit:_0x3ebe9b,status:_0x3b2864,method:_0x4f0fd7,network:_0x2b2d79,dateFrom:_0x350177,dateTo:_0x1ff573,periodFrom:_0x1b2f42,periodTo:_0x17494a}=_0x3b7795,_0x329d97=(_0x49963a-0x1)*_0x3ebe9b;console[_0x44095a(0x188)](_0x44095a(0x1ba),_0x3b7795);const _0x54ea5a={'shopId':_0x10fe37};_0x3b2864&&(_0x54ea5a['status']=_0x3b2864[_0x44095a(0x137)](),console[_0x44095a(0x188)]('ğŸ“Š\x20Status\x20filter:\x20'+_0x3b2864['toUpperCase']()));if(_0x4f0fd7)_0x54ea5a[_0x44095a(0x132)]=_0x4f0fd7,console[_0x44095a(0x188)](_0x44095a(0x166)+_0x4f0fd7);else _0x2b2d79&&(_0x54ea5a[_0x44095a(0x132)]=_0x2b2d79,console['log'](_0x44095a(0x1b1)+_0x2b2d79));if(_0x350177||_0x1ff573||_0x1b2f42||_0x17494a){_0x54ea5a[_0x44095a(0x1ab)]={};if(_0x1b2f42){const _0x3cb0d2=new Date(_0x1b2f42);_0x3cb0d2[_0x44095a(0x123)](0x0,0x0,0x0,0x1),_0x54ea5a[_0x44095a(0x1ab)][_0x44095a(0x15b)]=_0x3cb0d2,console[_0x44095a(0x188)](_0x44095a(0x1ac)+_0x3cb0d2['toISOString']());}else{if(_0x350177){const _0x2e3756=new Date(_0x350177);_0x2e3756['setHours'](0x0,0x0,0x0,0x1),_0x54ea5a['createdAt'][_0x44095a(0x15b)]=_0x2e3756,console[_0x44095a(0x188)](_0x44095a(0x1cb)+_0x2e3756['toISOString']());}}if(_0x17494a){const _0x3f2e24=new Date(_0x17494a);_0x3f2e24[_0x44095a(0x123)](0x17,0x3b,0x3b,0x3e7),_0x54ea5a[_0x44095a(0x1ab)][_0x44095a(0x141)]=_0x3f2e24,console[_0x44095a(0x188)]('ğŸ“…\x20Period\x20end:\x20'+_0x3f2e24[_0x44095a(0x19f)]());}else{if(_0x1ff573){const _0x330c85=new Date(_0x1ff573);_0x330c85[_0x44095a(0x123)](0x17,0x3b,0x3b,0x3e7),_0x54ea5a[_0x44095a(0x1ab)][_0x44095a(0x141)]=_0x330c85,console[_0x44095a(0x188)](_0x44095a(0x139)+_0x330c85[_0x44095a(0x19f)]());}}}console[_0x44095a(0x188)](_0x44095a(0x1ca),JSON[_0x44095a(0x1b6)](_0x54ea5a,null,0x2));const [_0xd83029,_0x318360]=await Promise[_0x44095a(0x18f)]([database_1['default'][_0x44095a(0x16e)][_0x44095a(0x126)]({'where':_0x54ea5a,'skip':_0x329d97,'take':_0x3ebe9b,'orderBy':{'createdAt':_0x44095a(0x11e)},'include':{'shop':{'select':{'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'usdcErcWallet':!![]}}}}),database_1[_0x44095a(0x16c)][_0x44095a(0x16e)][_0x44095a(0x131)]({'where':_0x54ea5a})]);return{'payouts':_0xd83029[_0x44095a(0x151)](_0x1a4e86=>{const _0x223e16=_0x44095a;let _0xbfffc1=null;switch(_0x1a4e86[_0x223e16(0x132)]){case _0x223e16(0x1b5):_0xbfffc1=_0x1a4e86[_0x223e16(0x15d)]['usdtPolygonWallet'];break;case _0x223e16(0x111):_0xbfffc1=_0x1a4e86[_0x223e16(0x15d)][_0x223e16(0x1ae)];break;case _0x223e16(0x13d):_0xbfffc1=_0x1a4e86[_0x223e16(0x15d)]['usdtErcWallet'];break;case _0x223e16(0x18a):_0xbfffc1=_0x1a4e86[_0x223e16(0x15d)][_0x223e16(0x1b8)];break;case'erc20_usdc':_0xbfffc1=_0x1a4e86[_0x223e16(0x15d)]['usdcErcWallet'];break;}return{'id':_0x1a4e86['id'],'amount':_0x1a4e86[_0x223e16(0x19d)],'network':this[_0x223e16(0x177)](_0x1a4e86['network']),'wallet':_0xbfffc1,'status':_0x1a4e86[_0x223e16(0x1c5)],'txid':_0x1a4e86[_0x223e16(0x191)],'notes':_0x1a4e86['notes'],'periodFrom':_0x1a4e86[_0x223e16(0x11a)],'periodTo':_0x1a4e86['periodTo'],'createdAt':_0x1a4e86[_0x223e16(0x1ab)],'paidAt':_0x1a4e86['paidAt']};}),'pagination':{'page':_0x49963a,'limit':_0x3ebe9b,'total':_0x318360,'totalPages':Math[_0x44095a(0x1cd)](_0x318360/_0x3ebe9b)}};}async[a76_0x589f22(0x120)](_0x1e058b,_0x8b214d){const _0x4fadf9=a76_0x589f22,_0x3c1433=await database_1[_0x4fadf9(0x16c)][_0x4fadf9(0x16e)][_0x4fadf9(0x1c9)]({'where':{'id':_0x8b214d,'shopId':_0x1e058b}});if(!_0x3c1433)return null;return{'id':_0x3c1433['id'],'amount':_0x3c1433['amount'],'network':_0x3c1433[_0x4fadf9(0x132)],'status':_0x3c1433[_0x4fadf9(0x1c5)],'txid':_0x3c1433[_0x4fadf9(0x191)],'notes':_0x3c1433[_0x4fadf9(0x1c2)],'createdAt':_0x3c1433[_0x4fadf9(0x1ab)],'paidAt':_0x3c1433['paidAt']};}async[a76_0x589f22(0x113)](_0x1664f4,_0x3ae331){const _0x35f56a=a76_0x589f22,_0x4ebac9=new Date();let _0x4ee261,_0x3431a5;switch(_0x3ae331){case _0x35f56a(0x158):case'YESTERDAY':const _0x53c7ca=new Date(_0x4ebac9);_0x53c7ca[_0x35f56a(0x179)](_0x53c7ca[_0x35f56a(0x125)]()-0x1),_0x4ee261=new Date(_0x53c7ca),_0x4ee261['setHours'](0x0,0x0,0x0,0x0),_0x3431a5=new Date(_0x53c7ca),_0x3431a5[_0x35f56a(0x123)](0x17,0x3b,0x3b,0x3e7);break;case'7d':_0x4ee261=new Date(_0x4ebac9['getTime']()-0x7*0x18*0x3c*0x3c*0x3e8);break;case _0x35f56a(0x17c):_0x4ee261=new Date(_0x4ebac9[_0x35f56a(0x164)]()-0x1e*0x18*0x3c*0x3c*0x3e8);break;case _0x35f56a(0x153):_0x4ee261=new Date(_0x4ebac9[_0x35f56a(0x164)]()-0x5a*0x18*0x3c*0x3c*0x3e8);break;default:_0x4ee261=new Date(_0x4ebac9['getTime']()-0x1e*0x18*0x3c*0x3c*0x3e8);}const _0x8ae6bb={'gte':_0x4ee261};_0x3431a5&&(_0x8ae6bb[_0x35f56a(0x141)]=_0x3431a5);const [_0x89313c,_0x3da16b,_0x3cffe1,_0x2b83e1,_0x3ece20,_0x3dc0f2]=await Promise['all']([database_1[_0x35f56a(0x16c)][_0x35f56a(0x16e)][_0x35f56a(0x131)]({'where':{'shopId':_0x1664f4,'createdAt':_0x8ae6bb}}),database_1['default'][_0x35f56a(0x16e)][_0x35f56a(0x131)]({'where':{'shopId':_0x1664f4,'status':'COMPLETED','createdAt':_0x8ae6bb}}),database_1['default']['payout'][_0x35f56a(0x131)]({'where':{'shopId':_0x1664f4,'status':_0x35f56a(0x11b),'createdAt':_0x8ae6bb}}),database_1['default'][_0x35f56a(0x16e)][_0x35f56a(0x131)]({'where':{'shopId':_0x1664f4,'status':_0x35f56a(0x199),'createdAt':_0x8ae6bb}}),database_1[_0x35f56a(0x16c)][_0x35f56a(0x16e)][_0x35f56a(0x126)]({'where':{'shopId':_0x1664f4,'createdAt':_0x8ae6bb},'select':{'amount':!![],'status':!![],'network':!![]}}),database_1[_0x35f56a(0x16c)][_0x35f56a(0x16e)][_0x35f56a(0x126)]({'where':{'shopId':_0x1664f4},'take':0xa,'orderBy':{'createdAt':_0x35f56a(0x11e)},'select':{'id':!![],'amount':!![],'network':!![],'status':!![],'txid':!![],'createdAt':!![],'paidAt':!![]}})]),_0x3aef45=_0x3ece20['reduce']((_0xce354,_0x1e46ad)=>_0xce354+_0x1e46ad['amount'],0x0),_0x3c75bc=_0x3ece20['filter'](_0x47f383=>_0x47f383[_0x35f56a(0x1c5)]==='COMPLETED')['reduce']((_0xccc1ea,_0x26d450)=>_0xccc1ea+_0x26d450[_0x35f56a(0x19d)],0x0),_0x398b3a=_0x3ece20['filter'](_0x2f4c60=>_0x2f4c60[_0x35f56a(0x1c5)]==='PENDING')['reduce']((_0x2ce4d7,_0xab0092)=>_0x2ce4d7+_0xab0092['amount'],0x0),_0x262417=_0x3ece20['reduce']((_0x3cd87e,_0x3b521c)=>{const _0x31fa67=_0x35f56a;return _0x3cd87e[_0x3b521c['network']]=(_0x3cd87e[_0x3b521c[_0x31fa67(0x132)]]||0x0)+0x1,_0x3cd87e;},{}),_0x18b3a8=_0x3ece20[_0x35f56a(0x18b)]((_0x4731d4,_0x51dee7)=>{const _0x791fe=_0x35f56a;return _0x4731d4[_0x51dee7[_0x791fe(0x1c5)]]=(_0x4731d4[_0x51dee7[_0x791fe(0x1c5)]]||0x0)+0x1,_0x4731d4;},{});return{'totalPayouts':_0x89313c,'completedPayouts':_0x3da16b,'pendingPayouts':_0x3cffe1,'rejectedPayouts':_0x2b83e1,'totalAmount':_0x3aef45,'completedAmount':_0x3c75bc,'pendingAmount':_0x398b3a,'payoutsByMethod':_0x262417,'payoutsByStatus':_0x18b3a8,'recentPayouts':_0x3dc0f2['map'](_0x5dae61=>({'id':_0x5dae61['id'],'shopId':_0x1664f4,'amount':_0x5dae61[_0x35f56a(0x19d)],'method':_0x5dae61[_0x35f56a(0x132)],'status':_0x5dae61[_0x35f56a(0x1c5)],'txid':_0x5dae61[_0x35f56a(0x191)],'createdAt':_0x5dae61[_0x35f56a(0x1ab)],'paidAt':_0x5dae61[_0x35f56a(0x1a3)]}))};}async[a76_0x589f22(0x112)](_0x1a5558){const _0x16632b=a76_0x589f22;console['log'](_0x16632b(0x13b)+_0x1a5558+'...');const _0x270d18=await database_1[_0x16632b(0x16c)]['shop'][_0x16632b(0x1be)]({'where':{'id':_0x1a5558},'select':{'id':!![],'name':!![],'username':!![],'balance':!![],'totalPaidOut':!![]}});if(!_0x270d18)throw new Error(_0x16632b(0x16f));const _0x46f27f=new Date(),_0x764987=new Date(_0x46f27f['getFullYear'](),_0x46f27f[_0x16632b(0x1aa)](),0x1),_0x2547e5=new Date(_0x46f27f['getFullYear'](),_0x46f27f[_0x16632b(0x1aa)]()+0x1,0x0,0x17,0x3b,0x3b,0x3e7),_0x39ea57=await database_1['default'][_0x16632b(0x16e)][_0x16632b(0x1c8)]({'_sum':{'amount':!![]},'where':{'shopId':_0x1a5558,'createdAt':{'gte':_0x764987,'lte':_0x2547e5},'status':_0x16632b(0x142)}}),_0x300e9b=_0x39ea57[_0x16632b(0x194)][_0x16632b(0x19d)]||0x0,_0x5bf470={'availableBalance':Math[_0x16632b(0x184)](_0x270d18[_0x16632b(0x11c)]*0x64)/0x64,'totalPaidOut':Math[_0x16632b(0x184)](_0x270d18[_0x16632b(0x15a)]*0x64)/0x64,'awaitingPayout':Math[_0x16632b(0x184)](_0x270d18[_0x16632b(0x11c)]*0x64)/0x64,'thisMonth':Math[_0x16632b(0x184)](_0x300e9b*0x64)/0x64};return console[_0x16632b(0x188)](_0x16632b(0x14a)+_0x270d18['username']+_0x16632b(0x146)),console[_0x16632b(0x188)](_0x16632b(0x159)+_0x5bf470['availableBalance']+_0x16632b(0x1b3)),console[_0x16632b(0x188)](_0x16632b(0x124)+_0x5bf470[_0x16632b(0x15a)]+_0x16632b(0x16d)),console[_0x16632b(0x188)]('\x20\x20\x20â³\x20Awaiting\x20payout:\x20'+_0x5bf470[_0x16632b(0x17b)]+'\x20USDT\x20(current\x20balance)'),console['log']('\x20\x20\x20ğŸ“…\x20This\x20month:\x20'+_0x5bf470['thisMonth']+_0x16632b(0x14c)),_0x5bf470;}[a76_0x589f22(0x168)](_0x1f3d00){const _0x4c1fa2=a76_0x589f22,_0x31d6ae={'test_gateway':_0x4c1fa2(0x174),'plisio':'Plisio','rapyd':_0x4c1fa2(0x14f),'noda':'Noda','cointopay':_0x4c1fa2(0x17a),'klyme_eu':'KLYME\x20EU','klyme_gb':_0x4c1fa2(0x1bb),'klyme_de':_0x4c1fa2(0x150)};return _0x31d6ae[_0x1f3d00]||_0x1f3d00;}async['getPayoutStats'](_0x302fa5){const _0xedaea5=a76_0x589f22;return this[_0xedaea5(0x112)](_0x302fa5);}async['getWebhookLogs'](_0x123380,_0x16c724){const _0x3b528b=a76_0x589f22,{page:_0x507720,limit:_0x2ff012,paymentId:_0x2fd09a}=_0x16c724,_0x41a3aa=(_0x507720-0x1)*_0x2ff012,_0x1c4e3b={'shopId':_0x123380};_0x2fd09a&&(_0x1c4e3b[_0x3b528b(0x19c)]=_0x2fd09a);const [_0x103c77,_0x1b1136]=await Promise[_0x3b528b(0x18f)]([database_1[_0x3b528b(0x16c)]['webhookLog'][_0x3b528b(0x126)]({'where':_0x1c4e3b,'skip':_0x41a3aa,'take':_0x2ff012,'orderBy':{'createdAt':'desc'},'include':{'payment':{'select':{'id':!![],'amount':!![],'currency':!![]}}}}),database_1[_0x3b528b(0x16c)][_0x3b528b(0x115)][_0x3b528b(0x131)]({'where':_0x1c4e3b})]);return{'logs':_0x103c77[_0x3b528b(0x151)](_0x13e0dc=>({'id':_0x13e0dc['id'],'paymentId':_0x13e0dc[_0x3b528b(0x19c)],'shopId':_0x13e0dc[_0x3b528b(0x145)],'event':_0x13e0dc[_0x3b528b(0x170)],'statusCode':_0x13e0dc[_0x3b528b(0x149)],'retryCount':_0x13e0dc[_0x3b528b(0x1bc)],'responseBody':_0x13e0dc[_0x3b528b(0x1af)],'createdAt':_0x13e0dc[_0x3b528b(0x1ab)],'payment':_0x13e0dc[_0x3b528b(0x14d)]})),'pagination':{'page':_0x507720,'limit':_0x2ff012,'total':_0x1b1136,'totalPages':Math['ceil'](_0x1b1136/_0x2ff012)}};}async[a76_0x589f22(0x176)](_0x5b6904,_0x340919,_0x1661ff,_0x1ef659,_0x3897f3){const _0x2406ed=a76_0x589f22;console[_0x2406ed(0x188)]('ğŸ“Š\x20Getting\x20statistics\x20for\x20shop\x20'+_0x5b6904+',\x20period:\x20'+_0x340919+_0x2406ed(0x12a)+_0x1661ff+',\x20dateTo:\x20'+_0x1ef659);const _0xc4d8af=_0x3897f3?new Date(_0x3897f3):new Date();let _0x2215b3,_0xf2cda1;if(_0x1661ff&&_0x1ef659){const _0x52c474=new Date(_0x1661ff),_0x551d1d=new Date(_0x1ef659);_0x2215b3=new Date(Date[_0x2406ed(0x1b2)](_0x52c474[_0x2406ed(0x189)](),_0x52c474[_0x2406ed(0x175)](),_0x52c474[_0x2406ed(0x196)](),0x0,0x0,0x0,0x0)),_0xf2cda1=new Date(Date['UTC'](_0x551d1d[_0x2406ed(0x189)](),_0x551d1d[_0x2406ed(0x175)](),_0x551d1d[_0x2406ed(0x196)](),0x17,0x3b,0x3b,0x3e7)),console[_0x2406ed(0x188)](_0x2406ed(0x12c)+_0x2215b3['toISOString']()+_0x2406ed(0x1a1)+_0xf2cda1['toISOString']());}else{if(_0x340919&&_0x340919[_0x2406ed(0x135)](_0x2406ed(0x167))){const _0x57392c=_0x340919[_0x2406ed(0x144)](_0x2406ed(0x167),'')[_0x2406ed(0x1bd)]('_');if(_0x57392c['length']===0x2){const _0x80fc8c=new Date(_0x57392c[0x0]),_0x533535=new Date(_0x57392c[0x1]);_0x2215b3=new Date(Date[_0x2406ed(0x1b2)](_0x80fc8c[_0x2406ed(0x189)](),_0x80fc8c[_0x2406ed(0x175)](),_0x80fc8c[_0x2406ed(0x196)](),0x0,0x0,0x0,0x0)),_0xf2cda1=new Date(Date[_0x2406ed(0x1b2)](_0x533535['getUTCFullYear'](),_0x533535['getUTCMonth'](),_0x533535['getUTCDate'](),0x17,0x3b,0x3b,0x3e7)),console['log']('ğŸ“…\x20Custom\x20period:\x20'+_0x2215b3[_0x2406ed(0x19f)]()+_0x2406ed(0x1a1)+_0xf2cda1[_0x2406ed(0x19f)]());}else{const _0x2a4500=new Date(Date[_0x2406ed(0x1b2)](_0xc4d8af[_0x2406ed(0x189)](),_0xc4d8af[_0x2406ed(0x175)](),_0xc4d8af[_0x2406ed(0x196)]()-0x1e));_0x2215b3=new Date(Date[_0x2406ed(0x1b2)](_0x2a4500[_0x2406ed(0x189)](),_0x2a4500[_0x2406ed(0x175)](),_0x2a4500['getUTCDate'](),0x0,0x0,0x0,0x0)),_0xf2cda1=new Date(Date[_0x2406ed(0x1b2)](_0xc4d8af[_0x2406ed(0x189)](),_0xc4d8af[_0x2406ed(0x175)](),_0xc4d8af[_0x2406ed(0x196)](),0x17,0x3b,0x3b,0x3e7));}}else{const _0x50a75b=_0x340919||'this_month';switch(_0x50a75b['toLowerCase']()){case'today':_0x2215b3=new Date(Date[_0x2406ed(0x1b2)](_0xc4d8af['getUTCFullYear'](),_0xc4d8af[_0x2406ed(0x175)](),_0xc4d8af['getUTCDate'](),0x0,0x0,0x0,0x0)),_0xf2cda1=new Date(Date[_0x2406ed(0x1b2)](_0xc4d8af['getUTCFullYear'](),_0xc4d8af[_0x2406ed(0x175)](),_0xc4d8af[_0x2406ed(0x196)](),0x17,0x3b,0x3b,0x3e7));break;case'yesterday':const _0x2ec50a=new Date(_0xc4d8af);_0x2ec50a['setUTCDate'](_0x2ec50a[_0x2406ed(0x196)]()-0x1),_0x2215b3=new Date(Date[_0x2406ed(0x1b2)](_0x2ec50a[_0x2406ed(0x189)](),_0x2ec50a[_0x2406ed(0x175)](),_0x2ec50a['getUTCDate'](),0x0,0x0,0x0,0x0)),_0xf2cda1=new Date(Date[_0x2406ed(0x1b2)](_0x2ec50a[_0x2406ed(0x189)](),_0x2ec50a[_0x2406ed(0x175)](),_0x2ec50a[_0x2406ed(0x196)](),0x17,0x3b,0x3b,0x3e7));break;case _0x2406ed(0x155):const _0x190496=_0xc4d8af[_0x2406ed(0x16b)](),_0x165b3d=_0x190496===0x0?-0x6:0x1-_0x190496,_0xe6eb54=_0xc4d8af[_0x2406ed(0x196)]()+_0x165b3d;_0x2215b3=new Date(Date[_0x2406ed(0x1b2)](_0xc4d8af[_0x2406ed(0x189)](),_0xc4d8af['getUTCMonth'](),_0xe6eb54,0x0,0x0,0x0,0x0)),_0xf2cda1=new Date(Date[_0x2406ed(0x1b2)](_0xc4d8af[_0x2406ed(0x189)](),_0xc4d8af['getUTCMonth'](),_0xc4d8af[_0x2406ed(0x196)](),0x17,0x3b,0x3b,0x3e7));break;case _0x2406ed(0x140):const _0x49986d=new Date(Date[_0x2406ed(0x1b2)](_0xc4d8af[_0x2406ed(0x189)](),_0xc4d8af[_0x2406ed(0x175)](),_0xc4d8af['getUTCDate']()-0x7)),_0x40f1a1=_0x49986d[_0x2406ed(0x16b)](),_0x268338=_0x40f1a1===0x0?-0x6:0x1-_0x40f1a1,_0x41b5ff=_0x49986d['getUTCDate']()+_0x268338;_0x2215b3=new Date(Date[_0x2406ed(0x1b2)](_0x49986d[_0x2406ed(0x189)](),_0x49986d['getUTCMonth'](),_0x41b5ff,0x0,0x0,0x0,0x0)),_0xf2cda1=new Date(Date[_0x2406ed(0x1b2)](_0x49986d['getUTCFullYear'](),_0x49986d[_0x2406ed(0x175)](),_0x41b5ff+0x6,0x17,0x3b,0x3b,0x3e7));break;case _0x2406ed(0x154):_0x2215b3=new Date(Date[_0x2406ed(0x1b2)](_0xc4d8af[_0x2406ed(0x189)](),_0xc4d8af[_0x2406ed(0x175)](),0x1,0x0,0x0,0x0,0x0)),_0xf2cda1=new Date(Date[_0x2406ed(0x1b2)](_0xc4d8af[_0x2406ed(0x189)](),_0xc4d8af[_0x2406ed(0x175)](),_0xc4d8af[_0x2406ed(0x196)](),0x17,0x3b,0x3b,0x3e7));break;case _0x2406ed(0x193):_0x2215b3=new Date(Date[_0x2406ed(0x1b2)](_0xc4d8af[_0x2406ed(0x189)](),_0xc4d8af[_0x2406ed(0x175)]()-0x1,0x1,0x0,0x0,0x0,0x0)),_0xf2cda1=new Date(Date[_0x2406ed(0x1b2)](_0xc4d8af[_0x2406ed(0x189)](),_0xc4d8af['getUTCMonth'](),0x0,0x17,0x3b,0x3b,0x3e7));break;case _0x2406ed(0x12b):_0x2215b3=new Date(Date[_0x2406ed(0x1b2)](0x7e9,0x5,0xe,0x0,0x0,0x0,0x0)),_0xf2cda1=new Date(Date['UTC'](_0xc4d8af['getUTCFullYear'](),_0xc4d8af[_0x2406ed(0x175)](),_0xc4d8af[_0x2406ed(0x196)](),0x17,0x3b,0x3b,0x3e7));break;default:_0x2215b3=new Date(Date['UTC'](_0xc4d8af[_0x2406ed(0x189)](),_0xc4d8af['getUTCMonth'](),0x1,0x0,0x0,0x0,0x0)),_0xf2cda1=new Date(Date[_0x2406ed(0x1b2)](_0xc4d8af[_0x2406ed(0x189)](),_0xc4d8af[_0x2406ed(0x175)](),_0xc4d8af[_0x2406ed(0x196)](),0x17,0x3b,0x3b,0x3e7));}}}console['log'](_0x2406ed(0x19a)+_0x2215b3['toISOString']()+_0x2406ed(0x1a1)+_0xf2cda1[_0x2406ed(0x19f)]());const _0x19aa30={'gte':_0x2215b3,'lte':_0xf2cda1},[_0x4c0d93,_0x56a85a,_0x4f2277,_0x181e27,_0x4319ba,_0x3db2f7,_0x21516d,_0x406b5e,_0x6df057,_0x2539ec]=await Promise[_0x2406ed(0x18f)]([database_1[_0x2406ed(0x16c)][_0x2406ed(0x14d)][_0x2406ed(0x131)]({'where':{'shopId':_0x5b6904,'gateway':{'not':'test_gateway'},'status':{'notIn':['PENDING','EXPIRED']},'createdAt':_0x19aa30}}),database_1['default'][_0x2406ed(0x14d)][_0x2406ed(0x131)]({'where':{'shopId':_0x5b6904,'gateway':{'not':_0x2406ed(0x134)},'status':_0x2406ed(0x1a6),'createdAt':_0x19aa30}}),database_1[_0x2406ed(0x16c)][_0x2406ed(0x14d)]['count']({'where':{'shopId':_0x5b6904,'gateway':{'not':_0x2406ed(0x134)},'status':_0x2406ed(0x1c6)}}),database_1['default'][_0x2406ed(0x14d)][_0x2406ed(0x131)]({'where':{'shopId':_0x5b6904,'gateway':{'not':_0x2406ed(0x134)},'status':'REFUND'}}),database_1[_0x2406ed(0x16c)][_0x2406ed(0x14d)]['findMany']({'where':{'shopId':_0x5b6904,'gateway':{'not':'test_gateway'},'status':_0x2406ed(0x1a6),'createdAt':_0x19aa30},'select':{'amount':!![],'currency':!![],'amountUSDT':!![],'amountAfterGatewayCommissionUSDT':!![],'createdAt':!![]}}),database_1[_0x2406ed(0x16c)][_0x2406ed(0x14d)][_0x2406ed(0x126)]({'where':{'shopId':_0x5b6904,'gateway':{'not':'test_gateway'}},'take':0xa,'orderBy':{'createdAt':_0x2406ed(0x11e)},'select':{'id':!![],'gateway':!![],'amount':!![],'currency':!![],'status':!![],'createdAt':!![]}}),database_1['default'][_0x2406ed(0x14d)][_0x2406ed(0x126)]({'where':{'shopId':_0x5b6904,'gateway':{'not':_0x2406ed(0x134)},'createdAt':_0x19aa30},'select':{'status':!![],'amountUSDT':!![],'createdAt':!![]},'orderBy':{'createdAt':_0x2406ed(0x173)}}),database_1['default'][_0x2406ed(0x14d)][_0x2406ed(0x131)]({'where':{'shopId':_0x5b6904,'gateway':{'not':_0x2406ed(0x134)},'status':_0x2406ed(0x1a6)}}),database_1['default'][_0x2406ed(0x14d)][_0x2406ed(0x126)]({'where':{'shopId':_0x5b6904,'gateway':{'not':_0x2406ed(0x134)},'status':_0x2406ed(0x1a6)},'select':{'amountAfterGatewayCommissionUSDT':!![]}}),database_1[_0x2406ed(0x16c)][_0x2406ed(0x15d)]['findUnique']({'where':{'id':_0x5b6904},'select':{'balance':!![]}})]);let _0x54c9c9=0x0,_0x4dd53c=0x0;for(const _0x2b633c of _0x4319ba){if(_0x2b633c[_0x2406ed(0x1c3)])_0x54c9c9+=_0x2b633c['amountUSDT'];else{const _0x50b7d4=await currencyService_1[_0x2406ed(0x186)]['convertToUSDT'](_0x2b633c[_0x2406ed(0x19d)],_0x2b633c['currency']);_0x54c9c9+=_0x50b7d4;}_0x2b633c[_0x2406ed(0x143)]&&(_0x4dd53c+=_0x2b633c[_0x2406ed(0x143)]);}let _0x48fce9=0x0;for(const _0x33ad42 of _0x6df057){_0x33ad42[_0x2406ed(0x143)]&&(_0x48fce9+=_0x33ad42[_0x2406ed(0x143)]);}const _0x2be568=this[_0x2406ed(0x1c4)](_0x21516d,_0x2215b3,_0xf2cda1||_0xc4d8af),_0x4292d0=_0x4c0d93>0x0?_0x56a85a/_0x4c0d93*0x64:0x0,_0x2681f5=_0x406b5e>0x0?_0x4f2277/_0x406b5e*0x64:0x0;return{'totalPayments':_0x4c0d93,'successfulPayments':_0x56a85a,'totalRevenue':Math[_0x2406ed(0x184)](_0x54c9c9*0x64)/0x64,'merchantEarnings':Math[_0x2406ed(0x184)](_0x4dd53c*0x64)/0x64,'merchantTotalRevenue':Math[_0x2406ed(0x184)](_0x48fce9*0x64)/0x64,'payoutBalance':Math[_0x2406ed(0x184)]((_0x2539ec?.[_0x2406ed(0x11c)]||0x0)*0x64)/0x64,'conversionRate':Math[_0x2406ed(0x184)](_0x4292d0*0x64)/0x64,'chargebackRate':Math[_0x2406ed(0x184)](_0x2681f5*0x64)/0x64,'chargebacks':_0x4f2277,'refunds':_0x181e27,'dailyRevenue':_0x2be568[_0x2406ed(0x157)],'dailyPayments':_0x2be568[_0x2406ed(0x147)],'recentPayments':_0x3db2f7['map'](_0x1eb541=>({'id':_0x1eb541['id'],'gateway':_0x1eb541[_0x2406ed(0x114)],'amount':_0x1eb541[_0x2406ed(0x19d)],'currency':_0x1eb541[_0x2406ed(0x13e)],'status':_0x1eb541[_0x2406ed(0x1c5)],'createdAt':_0x1eb541[_0x2406ed(0x1ab)]}))};}['generateDailyStatistics'](_0x3f19af,_0x323ca9,_0x51c6d6){const _0x5fe4ee=a76_0x589f22,_0x18572e=new Map(),_0x32be60=new Date(_0x323ca9);while(_0x32be60<=_0x51c6d6){const _0x560354=_0x32be60[_0x5fe4ee(0x19f)]()[_0x5fe4ee(0x1bd)]('T')[0x0];_0x18572e['set'](_0x560354,{'revenue':0x0,'count':0x0}),_0x32be60['setDate'](_0x32be60[_0x5fe4ee(0x125)]()+0x1);}for(const _0x1c8f22 of _0x3f19af){const _0x15c611=_0x1c8f22[_0x5fe4ee(0x1ab)]['toISOString']()['split']('T')[0x0],_0x3b5ffa=_0x18572e['get'](_0x15c611);_0x3b5ffa&&(_0x3b5ffa[_0x5fe4ee(0x131)]+=0x1,_0x1c8f22[_0x5fe4ee(0x1c5)]==='PAID'&&_0x1c8f22['amountUSDT']&&(_0x3b5ffa[_0x5fe4ee(0x133)]+=_0x1c8f22[_0x5fe4ee(0x1c3)]));}const _0x206f83=[],_0x5214b3=[];for(const [_0x570cc7,_0x3a2753]of _0x18572e){_0x206f83[_0x5fe4ee(0x169)]({'date':_0x570cc7,'amount':Math[_0x5fe4ee(0x184)](_0x3a2753[_0x5fe4ee(0x133)]*0x64)/0x64}),_0x5214b3[_0x5fe4ee(0x169)]({'date':_0x570cc7,'count':_0x3a2753['count']});}return{'dailyRevenue':_0x206f83,'dailyPayments':_0x5214b3};}}exports[a76_0x589f22(0x160)]=ShopService;