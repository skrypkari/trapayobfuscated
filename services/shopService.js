'use strict';function a77_0xecfb(_0x13f081,_0x304eeb){_0x13f081=_0x13f081-0x12f;const _0xe8b279=a77_0xe8b2();let _0xecfb96=_0xe8b279[_0x13f081];return _0xecfb96;}function a77_0xe8b2(){const _0x2a96fa=['COMPLETED','push','11556919sfuuXH','getPayoutById','customer','telegram','CoinToPay','getPaymentById','updateWallets','shop','usdcErcWallet','publicKey','default','./currencyService','./paymentService','amountUSDT','427aeOjJZ','__esModule','paymentId','PAID','\x20\x20\x20ðŸ’°\x20Total\x20paid\x20out:\x20','erc20_usdc','erc20','replace','sourceCurrency','event','66876lvfmSF','8787384fTaRxX','3IKWgBG','test_order_123','stringify','aggregate','../types/gateway','Unknown\x20error','getPaymentsByShop','\x20USDT','YESTERDAY','custom_','merchantUrl','getPayoutStatistics','count','webhookEvents','asc','gatewaySettings','setDate','ðŸŒ\x20Network\x20filter:\x20',',\x20dateTo:\x20','customerEmail','ðŸ“Š\x20Status\x20filter:\x20','KLYME\x20GB','usdtPolygonWallet','round','createPublicPayment','startsWith','username','Payment\x20not\x20found','AVAILABLE_GATEWAYS','name','90d','customerName','paymentService','ðŸ“Š\x20Calculating\x20shop\x20payout\x20stats\x20for\x20shop\x20','parse','usdtTrcWallet','getFullYear','setHours','fullName','getShopPayoutStats','trc20','lte','Shop\x20not\x20found','get','Noda','ðŸ“…\x20Final\x20date\x20range:\x20','\x20USDT\x20(current\x20balance)','language','usdcPolygonWallet','notes','REFUND','ðŸ“…\x20Period\x20start:\x20','PENDING','EXPIRED','_sum','toUpperCase','updatePayment','ceil','amount','isArray','\x20\x20\x20ðŸ“…\x20This\x20month:\x20','KLYME\x20DE','Failed\x20to\x20send\x20webhook:\x20','768140BAfmVx','maxPayments','createdAt','test_payment_123','getUTCFullYear','Error\x20parsing\x20webhook\x20events:','ShopService','webhookLog','redirectUrl','getPayoutStats','updateShopProfile','reduce','last_month','USDT\x20Polygon','set','ðŸ“…\x20Date\x20end:\x20','periodFrom','10zqixlJ','formatNetworkName','USDT\x20TRC20','\x20USDT\x20(total\x20payouts)','toLowerCase','../config/database','getUTCMonth','shopUrl','update','desc','1957360DIYPoR','message','responseBody','gateways','network','amountAfterGatewayCommissionUSDT','generateDailyStatistics','test','ðŸ“…\x20Date\x20start:\x20','3680660NKkoaM','testWebhook','availableBalance','payment','getUTCDate','test_gateway','convertToUSDT','getMonth','Webhook\x20returned\x20error:\x20','status','statusText','all','log','KLYME\x20EU','wallets','paid','findFirst','\x20\x20\x20â³\x20Awaiting\x20payout:\x20','delete','all_time','USDC\x20Ethereum','dailyRevenue','Test\x20Gateway','polygon_usdc','balance','paidAt','length','toISOString','usdtErcWallet','\x20to\x20','amountIsEditable','revenue','last_week','yesterday','getTime','map','ðŸŒ\x20Method\x20filter:\x20','periodTo','28KsLAcC','webhookUrl','findUnique','\x20\x20\x20ðŸ’µ\x20Available\x20balance:\x20','Plisio','error','filter','telegramId','paymentGateways','UTC','Payment\x20System/1.0\x20(Test)','POST','statusCode','this_month','ðŸ“Š\x20Getting\x20statistics\x20for\x20shop\x20','gte','deletePayment','62065VLAsgp','awaitingPayout','settings','CHARGEBACK','getUTCDay',',\x20dateFrom:\x20','txid','totalPaidOut','currency','retryCount','payout','ðŸ“Š\x20Final\x20WHERE\x20conditions:','USD','...','findMany','split','gateway',',\x20period:\x20','REJECTED','country','PaymentService','includes','getGatewayDisplayName','ðŸ“…\x20Custom\x20date\x20range:\x20','this_week','today','USDT\x20ERC20','thisMonth'];a77_0xe8b2=function(){return _0x2a96fa;};return a77_0xe8b2();}const a77_0x271f80=a77_0xecfb;(function(_0x47a528,_0x5d760d){const _0x426039=a77_0xecfb,_0x23d576=_0x47a528();while(!![]){try{const _0x502f1d=-parseInt(_0x426039(0x1fb))/0x1*(-parseInt(_0x426039(0x1ea))/0x2)+-parseInt(_0x426039(0x161))/0x3*(-parseInt(_0x426039(0x1c4))/0x4)+-parseInt(_0x426039(0x1a0))/0x5+parseInt(_0x426039(0x15f))/0x6*(-parseInt(_0x426039(0x155))/0x7)+-parseInt(_0x426039(0x1bb))/0x8+parseInt(_0x426039(0x160))/0x9+parseInt(_0x426039(0x1b1))/0xa*(-parseInt(_0x426039(0x147))/0xb);if(_0x502f1d===_0x5d760d)break;else _0x23d576['push'](_0x23d576['shift']());}catch(_0x358977){_0x23d576['push'](_0x23d576['shift']());}}}(a77_0xe8b2,0x9b6ca));var __importDefault=this&&this['__importDefault']||function(_0x516dd0){const _0x283e9d=a77_0xecfb;return _0x516dd0&&_0x516dd0[_0x283e9d(0x156)]?_0x516dd0:{'default':_0x516dd0};};Object['defineProperty'](exports,a77_0x271f80(0x156),{'value':!![]}),exports[a77_0x271f80(0x1a6)]=void 0x0;const database_1=__importDefault(require(a77_0x271f80(0x1b6))),currencyService_1=require(a77_0x271f80(0x152)),paymentService_1=require(a77_0x271f80(0x153)),gateway_1=require(a77_0x271f80(0x165));class ShopService{constructor(){const _0x950ca2=a77_0x271f80;this[_0x950ca2(0x181)]=new paymentService_1[(_0x950ca2(0x13d))]();}async['getShopProfile'](_0x2491f0){const _0xb34867=a77_0x271f80,_0x5c43cc=await database_1[_0xb34867(0x151)][_0xb34867(0x14e)][_0xb34867(0x1ec)]({'where':{'id':_0x2491f0},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'usdcErcWallet':!![],'status':!![],'createdAt':!![],'settings':{'select':{'webhookUrl':!![],'webhookEvents':!![]}}}});if(!_0x5c43cc)throw new Error('Shop\x20not\x20found');let _0x595691=[];if(_0x5c43cc[_0xb34867(0x1fd)]?.['webhookEvents'])try{_0x595691=Array[_0xb34867(0x19c)](_0x5c43cc[_0xb34867(0x1fd)]['webhookEvents'])?_0x5c43cc['settings']['webhookEvents']:JSON[_0xb34867(0x183)](_0x5c43cc['settings'][_0xb34867(0x16e)]);}catch(_0x29808d){console[_0xb34867(0x1ef)](_0xb34867(0x1a5),_0x29808d),_0x595691=[];}const _0x40f319=gateway_1[_0xb34867(0x17d)][_0xb34867(0x1f0)](_0x6fada0=>_0x6fada0['isActive'])[_0xb34867(0x1e7)](_0x2b3b75=>_0x2b3b75[_0xb34867(0x17e)]);let _0x7ab34f=_0x5c43cc[_0xb34867(0x1f2)]?JSON[_0xb34867(0x183)](_0x5c43cc[_0xb34867(0x1f2)]):[];return Array[_0xb34867(0x19c)](_0x7ab34f)&&(_0x7ab34f=_0x7ab34f[_0xb34867(0x1f0)](_0xa9a7d1=>_0x40f319[_0xb34867(0x13e)](_0xa9a7d1))),{'id':_0x5c43cc['id'],'fullName':_0x5c43cc[_0xb34867(0x17e)],'username':_0x5c43cc['username'],'telegramId':_0x5c43cc['telegram'],'merchantUrl':_0x5c43cc[_0xb34867(0x1b8)],'gateways':_0x7ab34f,'gatewaySettings':_0x5c43cc[_0xb34867(0x170)]?JSON['parse'](_0x5c43cc[_0xb34867(0x170)]):null,'publicKey':_0x5c43cc[_0xb34867(0x150)],'webhookUrl':_0x5c43cc['settings']?.[_0xb34867(0x1eb)]||null,'webhookEvents':_0x595691,'wallets':{'usdtPolygonWallet':_0x5c43cc[_0xb34867(0x177)],'usdtTrcWallet':_0x5c43cc['usdtTrcWallet'],'usdtErcWallet':_0x5c43cc['usdtErcWallet'],'usdcPolygonWallet':_0x5c43cc['usdcPolygonWallet'],'usdcErcWallet':_0x5c43cc[_0xb34867(0x14f)]},'status':_0x5c43cc[_0xb34867(0x1cd)],'createdAt':_0x5c43cc[_0xb34867(0x1a2)]};}async[a77_0x271f80(0x1aa)](_0x7adc5c,_0x4f6ea3){const _0x10bdb3=a77_0x271f80,_0x19846e={};_0x4f6ea3['fullName']&&(_0x19846e['name']=_0x4f6ea3[_0x10bdb3(0x187)]);_0x4f6ea3[_0x10bdb3(0x1f1)]!==undefined&&(_0x19846e[_0x10bdb3(0x14a)]=_0x4f6ea3[_0x10bdb3(0x1f1)]||null);_0x4f6ea3[_0x10bdb3(0x16b)]&&(_0x19846e[_0x10bdb3(0x1b8)]=_0x4f6ea3[_0x10bdb3(0x16b)]);_0x4f6ea3[_0x10bdb3(0x1be)]&&(_0x19846e[_0x10bdb3(0x1f2)]=JSON[_0x10bdb3(0x163)](_0x4f6ea3[_0x10bdb3(0x1be)]));_0x4f6ea3[_0x10bdb3(0x170)]&&(_0x19846e[_0x10bdb3(0x170)]=JSON[_0x10bdb3(0x163)](_0x4f6ea3[_0x10bdb3(0x170)]));_0x4f6ea3[_0x10bdb3(0x1d2)]&&(_0x4f6ea3['wallets']['usdtPolygonWallet']!==undefined&&(_0x19846e[_0x10bdb3(0x177)]=_0x4f6ea3[_0x10bdb3(0x1d2)][_0x10bdb3(0x177)]||null),_0x4f6ea3[_0x10bdb3(0x1d2)][_0x10bdb3(0x184)]!==undefined&&(_0x19846e[_0x10bdb3(0x184)]=_0x4f6ea3[_0x10bdb3(0x1d2)][_0x10bdb3(0x184)]||null),_0x4f6ea3[_0x10bdb3(0x1d2)][_0x10bdb3(0x1e0)]!==undefined&&(_0x19846e[_0x10bdb3(0x1e0)]=_0x4f6ea3[_0x10bdb3(0x1d2)]['usdtErcWallet']||null),_0x4f6ea3['wallets'][_0x10bdb3(0x191)]!==undefined&&(_0x19846e[_0x10bdb3(0x191)]=_0x4f6ea3[_0x10bdb3(0x1d2)]['usdcPolygonWallet']||null));const _0x27eae9=await database_1[_0x10bdb3(0x151)][_0x10bdb3(0x14e)]['update']({'where':{'id':_0x7adc5c},'data':_0x19846e,'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'usdcErcWallet':!![],'status':!![],'createdAt':!![],'settings':{'select':{'webhookUrl':!![],'webhookEvents':!![]}}}});let _0x1622a7=[];if(_0x27eae9[_0x10bdb3(0x1fd)]?.[_0x10bdb3(0x16e)])try{_0x1622a7=Array[_0x10bdb3(0x19c)](_0x27eae9[_0x10bdb3(0x1fd)]['webhookEvents'])?_0x27eae9[_0x10bdb3(0x1fd)][_0x10bdb3(0x16e)]:JSON[_0x10bdb3(0x183)](_0x27eae9[_0x10bdb3(0x1fd)][_0x10bdb3(0x16e)]);}catch(_0x1a163f){console[_0x10bdb3(0x1ef)](_0x10bdb3(0x1a5),_0x1a163f),_0x1622a7=[];}return{'id':_0x27eae9['id'],'fullName':_0x27eae9[_0x10bdb3(0x17e)],'username':_0x27eae9[_0x10bdb3(0x17b)],'telegramId':_0x27eae9[_0x10bdb3(0x14a)],'merchantUrl':_0x27eae9[_0x10bdb3(0x1b8)],'gateways':_0x27eae9[_0x10bdb3(0x1f2)]?JSON[_0x10bdb3(0x183)](_0x27eae9['paymentGateways']):null,'gatewaySettings':_0x27eae9[_0x10bdb3(0x170)]?JSON['parse'](_0x27eae9[_0x10bdb3(0x170)]):null,'publicKey':_0x27eae9['publicKey'],'webhookUrl':_0x27eae9[_0x10bdb3(0x1fd)]?.['webhookUrl']||null,'webhookEvents':_0x1622a7,'wallets':{'usdtPolygonWallet':_0x27eae9[_0x10bdb3(0x177)],'usdtTrcWallet':_0x27eae9[_0x10bdb3(0x184)],'usdtErcWallet':_0x27eae9['usdtErcWallet'],'usdcPolygonWallet':_0x27eae9['usdcPolygonWallet'],'usdcErcWallet':_0x27eae9['usdcErcWallet']},'status':_0x27eae9[_0x10bdb3(0x1cd)],'createdAt':_0x27eae9['createdAt']};}async[a77_0x271f80(0x14d)](_0x2c5de7,_0x52f8e8){const _0x481852=a77_0x271f80,_0x54db12={};_0x52f8e8['usdtPolygonWallet']!==undefined&&(_0x54db12[_0x481852(0x177)]=_0x52f8e8[_0x481852(0x177)]||null),_0x52f8e8['usdtTrcWallet']!==undefined&&(_0x54db12[_0x481852(0x184)]=_0x52f8e8[_0x481852(0x184)]||null),_0x52f8e8[_0x481852(0x1e0)]!==undefined&&(_0x54db12[_0x481852(0x1e0)]=_0x52f8e8[_0x481852(0x1e0)]||null),_0x52f8e8[_0x481852(0x191)]!==undefined&&(_0x54db12[_0x481852(0x191)]=_0x52f8e8[_0x481852(0x191)]||null),_0x52f8e8[_0x481852(0x14f)]!==undefined&&(_0x54db12[_0x481852(0x14f)]=_0x52f8e8['usdcErcWallet']||null),await database_1['default'][_0x481852(0x14e)][_0x481852(0x1b9)]({'where':{'id':_0x2c5de7},'data':_0x54db12});}async[a77_0x271f80(0x1c5)](_0x354886){const _0x5618b9=a77_0x271f80,_0x12b54c=await database_1[_0x5618b9(0x151)][_0x5618b9(0x14e)][_0x5618b9(0x1ec)]({'where':{'id':_0x354886},'include':{'settings':{'select':{'webhookUrl':!![]}}}});if(!_0x12b54c?.['settings']?.['webhookUrl'])throw new Error('No\x20webhook\x20URL\x20configured');const _0x205116={'event':_0x5618b9(0x1c2),'payment':{'id':_0x5618b9(0x1a3),'order_id':_0x5618b9(0x162),'gateway':_0x5618b9(0x1c2),'amount':0x64,'currency':_0x5618b9(0x135),'status':_0x5618b9(0x1d3),'created_at':new Date()[_0x5618b9(0x1df)]()}};try{const _0x265d07=await fetch(_0x12b54c[_0x5618b9(0x1fd)][_0x5618b9(0x1eb)],{'method':_0x5618b9(0x1f5),'headers':{'Content-Type':'application/json','User-Agent':_0x5618b9(0x1f4)},'body':JSON[_0x5618b9(0x163)](_0x205116)});return _0x265d07['ok']?{'success':!![],'message':'Test\x20webhook\x20sent\x20successfully\x20('+_0x265d07['status']+')'}:{'success':![],'message':_0x5618b9(0x1cc)+_0x265d07['status']+'\x20'+_0x265d07[_0x5618b9(0x1ce)]};}catch(_0x38f0e7){return{'success':![],'message':_0x5618b9(0x19f)+(_0x38f0e7 instanceof Error?_0x38f0e7[_0x5618b9(0x1bc)]:_0x5618b9(0x166))};}}async['createPayment'](_0x57646d){const _0x1f04f6=a77_0x271f80;return this[_0x1f04f6(0x181)][_0x1f04f6(0x179)]({'public_key':'','gateway':_0x57646d[_0x1f04f6(0x139)],'order_id':undefined,'amount':_0x57646d[_0x1f04f6(0x19b)],'currency':_0x57646d[_0x1f04f6(0x131)],'source_currency':_0x57646d[_0x1f04f6(0x15d)],'usage':_0x57646d['usage'],'expires_at':_0x57646d['expiresAt']?.[_0x1f04f6(0x1df)](),'success_url':_0x57646d['redirectUrl'],'fail_url':_0x57646d[_0x1f04f6(0x1a8)],'customer_email':_0x57646d[_0x1f04f6(0x174)],'customer_name':_0x57646d[_0x1f04f6(0x180)],'country':_0x57646d[_0x1f04f6(0x13c)],'language':_0x57646d[_0x1f04f6(0x190)],'amount_is_editable':_0x57646d[_0x1f04f6(0x1e2)],'max_payments':_0x57646d[_0x1f04f6(0x1a1)],'customer':_0x57646d[_0x1f04f6(0x149)]});}async['getPayments'](_0x2676bd,_0xa03d26){const _0x120e8e=a77_0x271f80;return this[_0x120e8e(0x181)][_0x120e8e(0x167)](_0x2676bd,_0xa03d26);}async[a77_0x271f80(0x14c)](_0x1ad604,_0x26d153){const _0x2b1201=a77_0x271f80;return this[_0x2b1201(0x181)]['getPaymentByShopAndId'](_0x1ad604,_0x26d153);}async[a77_0x271f80(0x199)](_0x4ce39f,_0x3c1092,_0x23fd0b){const _0x257b0a=a77_0x271f80,_0x35521f=await database_1['default'][_0x257b0a(0x1c7)]['findFirst']({'where':{'id':_0x3c1092,'shopId':_0x4ce39f}});if(!_0x35521f)throw new Error(_0x257b0a(0x17c));const _0x169237=await database_1[_0x257b0a(0x151)][_0x257b0a(0x1c7)][_0x257b0a(0x1b9)]({'where':{'id':_0x3c1092},'data':{..._0x23fd0b,'updatedAt':new Date()}});return _0x169237;}async[a77_0x271f80(0x1fa)](_0x6db6f5,_0x530595){const _0x38be57=a77_0x271f80,_0x11830c=await database_1[_0x38be57(0x151)][_0x38be57(0x1c7)]['findFirst']({'where':{'id':_0x530595,'shopId':_0x6db6f5}});if(!_0x11830c)throw new Error(_0x38be57(0x17c));await database_1[_0x38be57(0x151)]['payment'][_0x38be57(0x1d6)]({'where':{'id':_0x530595}});}[a77_0x271f80(0x1b2)](_0x3b205f){const _0x3abfcb=a77_0x271f80,_0xda3e6d={'polygon':_0x3abfcb(0x1ad),'trc20':_0x3abfcb(0x1b3),'erc20':_0x3abfcb(0x143),'bsc':'USDT\x20BSC','polygon_usdc':'USDC\x20Polygon','erc20_usdc':_0x3abfcb(0x1d8)};return _0xda3e6d[_0x3b205f]||_0x3b205f;}async['getPayouts'](_0x2cd9f3,_0x3030c0){const _0x5c25c2=a77_0x271f80,{page:_0x338d14,limit:_0x2a17c0,status:_0x384901,method:_0x399cec,network:_0x1f6f37,dateFrom:_0xfac003,dateTo:_0x5f5aca,periodFrom:_0x670828,periodTo:_0x1f101}=_0x3030c0,_0xd4a7b=(_0x338d14-0x1)*_0x2a17c0;console[_0x5c25c2(0x1d0)]('ðŸ’°\x20Getting\x20payouts\x20with\x20filters:',_0x3030c0);const _0x1c7f35={'shopId':_0x2cd9f3};_0x384901&&(_0x1c7f35['status']=_0x384901[_0x5c25c2(0x198)](),console[_0x5c25c2(0x1d0)](_0x5c25c2(0x175)+_0x384901[_0x5c25c2(0x198)]()));if(_0x399cec)_0x1c7f35[_0x5c25c2(0x1bf)]=_0x399cec,console[_0x5c25c2(0x1d0)](_0x5c25c2(0x1e8)+_0x399cec);else _0x1f6f37&&(_0x1c7f35[_0x5c25c2(0x1bf)]=_0x1f6f37,console['log'](_0x5c25c2(0x172)+_0x1f6f37));if(_0xfac003||_0x5f5aca||_0x670828||_0x1f101){_0x1c7f35['createdAt']={};if(_0x670828){const _0x5f2575=new Date(_0x670828);_0x5f2575['setHours'](0x0,0x0,0x0,0x1),_0x1c7f35['createdAt'][_0x5c25c2(0x1f9)]=_0x5f2575,console[_0x5c25c2(0x1d0)](_0x5c25c2(0x194)+_0x5f2575[_0x5c25c2(0x1df)]());}else{if(_0xfac003){const _0x14947b=new Date(_0xfac003);_0x14947b[_0x5c25c2(0x186)](0x0,0x0,0x0,0x1),_0x1c7f35[_0x5c25c2(0x1a2)][_0x5c25c2(0x1f9)]=_0x14947b,console[_0x5c25c2(0x1d0)](_0x5c25c2(0x1c3)+_0x14947b[_0x5c25c2(0x1df)]());}}if(_0x1f101){const _0x2a3abf=new Date(_0x1f101);_0x2a3abf['setHours'](0x17,0x3b,0x3b,0x3e7),_0x1c7f35[_0x5c25c2(0x1a2)][_0x5c25c2(0x18a)]=_0x2a3abf,console['log']('ðŸ“…\x20Period\x20end:\x20'+_0x2a3abf[_0x5c25c2(0x1df)]());}else{if(_0x5f5aca){const _0x95a1bb=new Date(_0x5f5aca);_0x95a1bb[_0x5c25c2(0x186)](0x17,0x3b,0x3b,0x3e7),_0x1c7f35['createdAt'][_0x5c25c2(0x18a)]=_0x95a1bb,console['log'](_0x5c25c2(0x1af)+_0x95a1bb[_0x5c25c2(0x1df)]());}}}console[_0x5c25c2(0x1d0)](_0x5c25c2(0x134),JSON[_0x5c25c2(0x163)](_0x1c7f35,null,0x2));const [_0x521eac,_0x1ea833]=await Promise[_0x5c25c2(0x1cf)]([database_1[_0x5c25c2(0x151)][_0x5c25c2(0x133)][_0x5c25c2(0x137)]({'where':_0x1c7f35,'skip':_0xd4a7b,'take':_0x2a17c0,'orderBy':{'createdAt':_0x5c25c2(0x1ba)},'include':{'shop':{'select':{'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'usdcErcWallet':!![]}}}}),database_1[_0x5c25c2(0x151)][_0x5c25c2(0x133)]['count']({'where':_0x1c7f35})]);return{'payouts':_0x521eac[_0x5c25c2(0x1e7)](_0x564f40=>{const _0x2d0036=_0x5c25c2;let _0x1be1ef=null;switch(_0x564f40['network']){case'polygon':_0x1be1ef=_0x564f40[_0x2d0036(0x14e)][_0x2d0036(0x177)];break;case _0x2d0036(0x189):_0x1be1ef=_0x564f40[_0x2d0036(0x14e)][_0x2d0036(0x184)];break;case _0x2d0036(0x15b):_0x1be1ef=_0x564f40[_0x2d0036(0x14e)][_0x2d0036(0x1e0)];break;case _0x2d0036(0x1db):_0x1be1ef=_0x564f40['shop'][_0x2d0036(0x191)];break;case _0x2d0036(0x15a):_0x1be1ef=_0x564f40[_0x2d0036(0x14e)][_0x2d0036(0x14f)];break;}return{'id':_0x564f40['id'],'amount':_0x564f40[_0x2d0036(0x19b)],'network':this[_0x2d0036(0x1b2)](_0x564f40[_0x2d0036(0x1bf)]),'wallet':_0x1be1ef,'status':_0x564f40['status'],'txid':_0x564f40['txid'],'notes':_0x564f40[_0x2d0036(0x192)],'periodFrom':_0x564f40[_0x2d0036(0x1b0)],'periodTo':_0x564f40[_0x2d0036(0x1e9)],'createdAt':_0x564f40[_0x2d0036(0x1a2)],'paidAt':_0x564f40['paidAt']};}),'pagination':{'page':_0x338d14,'limit':_0x2a17c0,'total':_0x1ea833,'totalPages':Math[_0x5c25c2(0x19a)](_0x1ea833/_0x2a17c0)}};}async[a77_0x271f80(0x148)](_0x2ed3b5,_0x55e817){const _0x5c88f0=a77_0x271f80,_0x14e0b2=await database_1[_0x5c88f0(0x151)][_0x5c88f0(0x133)][_0x5c88f0(0x1d4)]({'where':{'id':_0x55e817,'shopId':_0x2ed3b5}});if(!_0x14e0b2)return null;return{'id':_0x14e0b2['id'],'amount':_0x14e0b2[_0x5c88f0(0x19b)],'network':_0x14e0b2[_0x5c88f0(0x1bf)],'status':_0x14e0b2[_0x5c88f0(0x1cd)],'txid':_0x14e0b2[_0x5c88f0(0x12f)],'notes':_0x14e0b2[_0x5c88f0(0x192)],'createdAt':_0x14e0b2[_0x5c88f0(0x1a2)],'paidAt':_0x14e0b2['paidAt']};}async[a77_0x271f80(0x16c)](_0x160e10,_0x14715d){const _0x35d601=a77_0x271f80,_0xcb6cd3=new Date();let _0x48a0d6,_0x5850d7;switch(_0x14715d){case _0x35d601(0x1e5):case _0x35d601(0x169):const _0x32ce75=new Date(_0xcb6cd3);_0x32ce75[_0x35d601(0x171)](_0x32ce75['getDate']()-0x1),_0x48a0d6=new Date(_0x32ce75),_0x48a0d6[_0x35d601(0x186)](0x0,0x0,0x0,0x0),_0x5850d7=new Date(_0x32ce75),_0x5850d7[_0x35d601(0x186)](0x17,0x3b,0x3b,0x3e7);break;case'7d':_0x48a0d6=new Date(_0xcb6cd3[_0x35d601(0x1e6)]()-0x7*0x18*0x3c*0x3c*0x3e8);break;case'30d':_0x48a0d6=new Date(_0xcb6cd3['getTime']()-0x1e*0x18*0x3c*0x3c*0x3e8);break;case _0x35d601(0x17f):_0x48a0d6=new Date(_0xcb6cd3[_0x35d601(0x1e6)]()-0x5a*0x18*0x3c*0x3c*0x3e8);break;default:_0x48a0d6=new Date(_0xcb6cd3['getTime']()-0x1e*0x18*0x3c*0x3c*0x3e8);}const _0x274e8f={'gte':_0x48a0d6};_0x5850d7&&(_0x274e8f[_0x35d601(0x18a)]=_0x5850d7);const [_0x3ba045,_0x1ee3d1,_0x10359f,_0x358731,_0x2602af,_0x356ec3]=await Promise['all']([database_1[_0x35d601(0x151)][_0x35d601(0x133)][_0x35d601(0x16d)]({'where':{'shopId':_0x160e10,'createdAt':_0x274e8f}}),database_1['default'][_0x35d601(0x133)]['count']({'where':{'shopId':_0x160e10,'status':_0x35d601(0x145),'createdAt':_0x274e8f}}),database_1[_0x35d601(0x151)][_0x35d601(0x133)][_0x35d601(0x16d)]({'where':{'shopId':_0x160e10,'status':_0x35d601(0x195),'createdAt':_0x274e8f}}),database_1[_0x35d601(0x151)][_0x35d601(0x133)][_0x35d601(0x16d)]({'where':{'shopId':_0x160e10,'status':_0x35d601(0x13b),'createdAt':_0x274e8f}}),database_1[_0x35d601(0x151)]['payout'][_0x35d601(0x137)]({'where':{'shopId':_0x160e10,'createdAt':_0x274e8f},'select':{'amount':!![],'status':!![],'network':!![]}}),database_1[_0x35d601(0x151)]['payout'][_0x35d601(0x137)]({'where':{'shopId':_0x160e10},'take':0xa,'orderBy':{'createdAt':_0x35d601(0x1ba)},'select':{'id':!![],'amount':!![],'network':!![],'status':!![],'txid':!![],'createdAt':!![],'paidAt':!![]}})]),_0x40b915=_0x2602af['reduce']((_0x543da6,_0x234cbf)=>_0x543da6+_0x234cbf[_0x35d601(0x19b)],0x0),_0x203cf0=_0x2602af['filter'](_0x458f0b=>_0x458f0b['status']===_0x35d601(0x145))['reduce']((_0x5b9941,_0x4584fc)=>_0x5b9941+_0x4584fc['amount'],0x0),_0x4eab4a=_0x2602af[_0x35d601(0x1f0)](_0x375b4f=>_0x375b4f[_0x35d601(0x1cd)]==='PENDING')['reduce']((_0x1cae9a,_0x4250f4)=>_0x1cae9a+_0x4250f4[_0x35d601(0x19b)],0x0),_0x58070e=_0x2602af[_0x35d601(0x1ab)]((_0x463eec,_0x47c779)=>{const _0x211d2b=_0x35d601;return _0x463eec[_0x47c779[_0x211d2b(0x1bf)]]=(_0x463eec[_0x47c779[_0x211d2b(0x1bf)]]||0x0)+0x1,_0x463eec;},{}),_0x19ef06=_0x2602af[_0x35d601(0x1ab)]((_0x2b152f,_0x56a809)=>{const _0x39bd06=_0x35d601;return _0x2b152f[_0x56a809[_0x39bd06(0x1cd)]]=(_0x2b152f[_0x56a809[_0x39bd06(0x1cd)]]||0x0)+0x1,_0x2b152f;},{});return{'totalPayouts':_0x3ba045,'completedPayouts':_0x1ee3d1,'pendingPayouts':_0x10359f,'rejectedPayouts':_0x358731,'totalAmount':_0x40b915,'completedAmount':_0x203cf0,'pendingAmount':_0x4eab4a,'payoutsByMethod':_0x58070e,'payoutsByStatus':_0x19ef06,'recentPayouts':_0x356ec3[_0x35d601(0x1e7)](_0x135e4d=>({'id':_0x135e4d['id'],'shopId':_0x160e10,'amount':_0x135e4d[_0x35d601(0x19b)],'method':_0x135e4d[_0x35d601(0x1bf)],'status':_0x135e4d['status'],'txid':_0x135e4d[_0x35d601(0x12f)],'createdAt':_0x135e4d['createdAt'],'paidAt':_0x135e4d[_0x35d601(0x1dd)]}))};}async[a77_0x271f80(0x188)](_0x4aa636){const _0x53628e=a77_0x271f80;console['log'](_0x53628e(0x182)+_0x4aa636+_0x53628e(0x136));const _0x4825ad=await database_1[_0x53628e(0x151)]['shop'][_0x53628e(0x1ec)]({'where':{'id':_0x4aa636},'select':{'id':!![],'name':!![],'username':!![],'balance':!![],'totalPaidOut':!![]}});if(!_0x4825ad)throw new Error(_0x53628e(0x18b));const _0x194e9b=new Date(),_0x331978=new Date(_0x194e9b[_0x53628e(0x185)](),_0x194e9b[_0x53628e(0x1cb)](),0x1),_0x37226a=new Date(_0x194e9b[_0x53628e(0x185)](),_0x194e9b[_0x53628e(0x1cb)]()+0x1,0x0,0x17,0x3b,0x3b,0x3e7),_0x4e1784=await database_1[_0x53628e(0x151)]['payout'][_0x53628e(0x164)]({'_sum':{'amount':!![]},'where':{'shopId':_0x4aa636,'createdAt':{'gte':_0x331978,'lte':_0x37226a},'status':_0x53628e(0x145)}}),_0x19fe54=_0x4e1784[_0x53628e(0x197)][_0x53628e(0x19b)]||0x0,_0x28e1e0={'availableBalance':Math[_0x53628e(0x178)](_0x4825ad['balance']*0x64)/0x64,'totalPaidOut':Math[_0x53628e(0x178)](_0x4825ad['totalPaidOut']*0x64)/0x64,'awaitingPayout':Math[_0x53628e(0x178)](_0x4825ad['balance']*0x64)/0x64,'thisMonth':Math[_0x53628e(0x178)](_0x19fe54*0x64)/0x64};return console[_0x53628e(0x1d0)]('ðŸ“Š\x20Shop\x20'+_0x4825ad[_0x53628e(0x17b)]+'\x20payout\x20statistics\x20calculated:'),console[_0x53628e(0x1d0)](_0x53628e(0x1ed)+_0x28e1e0[_0x53628e(0x1c6)]+_0x53628e(0x18f)),console['log'](_0x53628e(0x159)+_0x28e1e0[_0x53628e(0x130)]+_0x53628e(0x1b4)),console[_0x53628e(0x1d0)](_0x53628e(0x1d5)+_0x28e1e0[_0x53628e(0x1fc)]+_0x53628e(0x18f)),console[_0x53628e(0x1d0)](_0x53628e(0x19d)+_0x28e1e0[_0x53628e(0x144)]+_0x53628e(0x168)),_0x28e1e0;}[a77_0x271f80(0x13f)](_0x1cdeea){const _0x121c55=a77_0x271f80,_0x5dbf63={'test_gateway':_0x121c55(0x1da),'plisio':_0x121c55(0x1ee),'rapyd':'Rapyd','noda':_0x121c55(0x18d),'cointopay':_0x121c55(0x14b),'klyme_eu':_0x121c55(0x1d1),'klyme_gb':_0x121c55(0x176),'klyme_de':_0x121c55(0x19e)};return _0x5dbf63[_0x1cdeea]||_0x1cdeea;}async[a77_0x271f80(0x1a9)](_0x545894){return this['getShopPayoutStats'](_0x545894);}async['getWebhookLogs'](_0x60f357,_0x446671){const _0x556c02=a77_0x271f80,{page:_0x274aa9,limit:_0x47ffea,paymentId:_0x66c223}=_0x446671,_0x51c598=(_0x274aa9-0x1)*_0x47ffea,_0x48e4ed={'shopId':_0x60f357};_0x66c223&&(_0x48e4ed[_0x556c02(0x157)]=_0x66c223);const [_0x4a0f25,_0x348454]=await Promise[_0x556c02(0x1cf)]([database_1[_0x556c02(0x151)]['webhookLog']['findMany']({'where':_0x48e4ed,'skip':_0x51c598,'take':_0x47ffea,'orderBy':{'createdAt':_0x556c02(0x1ba)},'include':{'payment':{'select':{'id':!![],'amount':!![],'currency':!![]}}}}),database_1[_0x556c02(0x151)][_0x556c02(0x1a7)]['count']({'where':_0x48e4ed})]);return{'logs':_0x4a0f25[_0x556c02(0x1e7)](_0x3fdf37=>({'id':_0x3fdf37['id'],'paymentId':_0x3fdf37[_0x556c02(0x157)],'shopId':_0x3fdf37['shopId'],'event':_0x3fdf37[_0x556c02(0x15e)],'statusCode':_0x3fdf37[_0x556c02(0x1f6)],'retryCount':_0x3fdf37[_0x556c02(0x132)],'responseBody':_0x3fdf37[_0x556c02(0x1bd)],'createdAt':_0x3fdf37[_0x556c02(0x1a2)],'payment':_0x3fdf37['payment']})),'pagination':{'page':_0x274aa9,'limit':_0x47ffea,'total':_0x348454,'totalPages':Math[_0x556c02(0x19a)](_0x348454/_0x47ffea)}};}async['getStatistics'](_0x2e7778,_0xdfe284,_0xcd6017,_0x2b7bcf,_0xa88092){const _0x597247=a77_0x271f80;console[_0x597247(0x1d0)](_0x597247(0x1f8)+_0x2e7778+_0x597247(0x13a)+_0xdfe284+_0x597247(0x200)+_0xcd6017+_0x597247(0x173)+_0x2b7bcf);const _0x7d102e=_0xa88092?new Date(_0xa88092):new Date();let _0x312fa3,_0x5ab0fd;if(_0xcd6017&&_0x2b7bcf){const _0x38b5af=new Date(_0xcd6017),_0x189480=new Date(_0x2b7bcf);_0x312fa3=new Date(Date[_0x597247(0x1f3)](_0x38b5af['getUTCFullYear'](),_0x38b5af[_0x597247(0x1b7)](),_0x38b5af[_0x597247(0x1c8)](),0x0,0x0,0x0,0x0)),_0x5ab0fd=new Date(Date[_0x597247(0x1f3)](_0x189480[_0x597247(0x1a4)](),_0x189480[_0x597247(0x1b7)](),_0x189480['getUTCDate'](),0x17,0x3b,0x3b,0x3e7)),console['log'](_0x597247(0x140)+_0x312fa3[_0x597247(0x1df)]()+_0x597247(0x1e1)+_0x5ab0fd[_0x597247(0x1df)]());}else{if(_0xdfe284&&_0xdfe284[_0x597247(0x17a)](_0x597247(0x16a))){const _0xcc04f4=_0xdfe284[_0x597247(0x15c)](_0x597247(0x16a),'')[_0x597247(0x138)]('_');if(_0xcc04f4[_0x597247(0x1de)]===0x2){const _0x220641=new Date(_0xcc04f4[0x0]),_0x1eadc5=new Date(_0xcc04f4[0x1]);_0x312fa3=new Date(Date[_0x597247(0x1f3)](_0x220641[_0x597247(0x1a4)](),_0x220641['getUTCMonth'](),_0x220641[_0x597247(0x1c8)](),0x0,0x0,0x0,0x0)),_0x5ab0fd=new Date(Date['UTC'](_0x1eadc5[_0x597247(0x1a4)](),_0x1eadc5[_0x597247(0x1b7)](),_0x1eadc5['getUTCDate'](),0x17,0x3b,0x3b,0x3e7)),console[_0x597247(0x1d0)]('ðŸ“…\x20Custom\x20period:\x20'+_0x312fa3[_0x597247(0x1df)]()+_0x597247(0x1e1)+_0x5ab0fd[_0x597247(0x1df)]());}else{const _0x3c5089=new Date(Date[_0x597247(0x1f3)](_0x7d102e[_0x597247(0x1a4)](),_0x7d102e['getUTCMonth'](),_0x7d102e[_0x597247(0x1c8)]()-0x1e));_0x312fa3=new Date(Date[_0x597247(0x1f3)](_0x3c5089[_0x597247(0x1a4)](),_0x3c5089[_0x597247(0x1b7)](),_0x3c5089[_0x597247(0x1c8)](),0x0,0x0,0x0,0x0)),_0x5ab0fd=new Date(Date[_0x597247(0x1f3)](_0x7d102e['getUTCFullYear'](),_0x7d102e[_0x597247(0x1b7)](),_0x7d102e[_0x597247(0x1c8)](),0x17,0x3b,0x3b,0x3e7));}}else{const _0x30ccbc=_0xdfe284||'this_month';switch(_0x30ccbc[_0x597247(0x1b5)]()){case _0x597247(0x142):_0x312fa3=new Date(Date[_0x597247(0x1f3)](_0x7d102e['getUTCFullYear'](),_0x7d102e[_0x597247(0x1b7)](),_0x7d102e[_0x597247(0x1c8)](),0x0,0x0,0x0,0x0)),_0x5ab0fd=new Date(Date['UTC'](_0x7d102e['getUTCFullYear'](),_0x7d102e[_0x597247(0x1b7)](),_0x7d102e['getUTCDate'](),0x17,0x3b,0x3b,0x3e7));break;case _0x597247(0x1e5):const _0xfdacd6=new Date(_0x7d102e);_0xfdacd6['setUTCDate'](_0xfdacd6[_0x597247(0x1c8)]()-0x1),_0x312fa3=new Date(Date[_0x597247(0x1f3)](_0xfdacd6['getUTCFullYear'](),_0xfdacd6[_0x597247(0x1b7)](),_0xfdacd6[_0x597247(0x1c8)](),0x0,0x0,0x0,0x0)),_0x5ab0fd=new Date(Date['UTC'](_0xfdacd6[_0x597247(0x1a4)](),_0xfdacd6[_0x597247(0x1b7)](),_0xfdacd6[_0x597247(0x1c8)](),0x17,0x3b,0x3b,0x3e7));break;case _0x597247(0x141):const _0x5c5b8c=_0x7d102e[_0x597247(0x1ff)](),_0x5c332f=_0x5c5b8c===0x0?-0x6:0x1-_0x5c5b8c,_0x23df48=_0x7d102e['getUTCDate']()+_0x5c332f;_0x312fa3=new Date(Date[_0x597247(0x1f3)](_0x7d102e['getUTCFullYear'](),_0x7d102e['getUTCMonth'](),_0x23df48,0x0,0x0,0x0,0x0)),_0x5ab0fd=new Date(Date[_0x597247(0x1f3)](_0x7d102e[_0x597247(0x1a4)](),_0x7d102e[_0x597247(0x1b7)](),_0x7d102e[_0x597247(0x1c8)](),0x17,0x3b,0x3b,0x3e7));break;case _0x597247(0x1e4):const _0x2d32f8=new Date(Date['UTC'](_0x7d102e[_0x597247(0x1a4)](),_0x7d102e['getUTCMonth'](),_0x7d102e[_0x597247(0x1c8)]()-0x7)),_0x23b2a0=_0x2d32f8['getUTCDay'](),_0x5697ca=_0x23b2a0===0x0?-0x6:0x1-_0x23b2a0,_0x1b1a58=_0x2d32f8[_0x597247(0x1c8)]()+_0x5697ca;_0x312fa3=new Date(Date[_0x597247(0x1f3)](_0x2d32f8[_0x597247(0x1a4)](),_0x2d32f8['getUTCMonth'](),_0x1b1a58,0x0,0x0,0x0,0x0)),_0x5ab0fd=new Date(Date[_0x597247(0x1f3)](_0x2d32f8[_0x597247(0x1a4)](),_0x2d32f8[_0x597247(0x1b7)](),_0x1b1a58+0x6,0x17,0x3b,0x3b,0x3e7));break;case _0x597247(0x1f7):_0x312fa3=new Date(Date['UTC'](_0x7d102e[_0x597247(0x1a4)](),_0x7d102e[_0x597247(0x1b7)](),0x1,0x0,0x0,0x0,0x0)),_0x5ab0fd=new Date(Date['UTC'](_0x7d102e['getUTCFullYear'](),_0x7d102e[_0x597247(0x1b7)](),_0x7d102e[_0x597247(0x1c8)](),0x17,0x3b,0x3b,0x3e7));break;case _0x597247(0x1ac):_0x312fa3=new Date(Date['UTC'](_0x7d102e['getUTCFullYear'](),_0x7d102e[_0x597247(0x1b7)]()-0x1,0x1,0x0,0x0,0x0,0x0)),_0x5ab0fd=new Date(Date[_0x597247(0x1f3)](_0x7d102e[_0x597247(0x1a4)](),_0x7d102e['getUTCMonth'](),0x0,0x17,0x3b,0x3b,0x3e7));break;case _0x597247(0x1d7):_0x312fa3=new Date(Date[_0x597247(0x1f3)](0x7e9,0x5,0xe,0x0,0x0,0x0,0x0)),_0x5ab0fd=new Date(Date['UTC'](_0x7d102e['getUTCFullYear'](),_0x7d102e['getUTCMonth'](),_0x7d102e[_0x597247(0x1c8)](),0x17,0x3b,0x3b,0x3e7));break;default:_0x312fa3=new Date(Date[_0x597247(0x1f3)](_0x7d102e[_0x597247(0x1a4)](),_0x7d102e['getUTCMonth'](),0x1,0x0,0x0,0x0,0x0)),_0x5ab0fd=new Date(Date['UTC'](_0x7d102e[_0x597247(0x1a4)](),_0x7d102e['getUTCMonth'](),_0x7d102e[_0x597247(0x1c8)](),0x17,0x3b,0x3b,0x3e7));}}}console[_0x597247(0x1d0)](_0x597247(0x18e)+_0x312fa3[_0x597247(0x1df)]()+_0x597247(0x1e1)+_0x5ab0fd[_0x597247(0x1df)]());const _0xdae78c={'gte':_0x312fa3,'lte':_0x5ab0fd},[_0x4f71d8,_0x4d6aec,_0x3998dd,_0xb9fcdc,_0xa5e6f3,_0x41eb3f,_0x4c8c31,_0x493088,_0x511a9c,_0x493312]=await Promise['all']([database_1[_0x597247(0x151)][_0x597247(0x1c7)][_0x597247(0x16d)]({'where':{'shopId':_0x2e7778,'gateway':{'not':_0x597247(0x1c9)},'status':{'notIn':[_0x597247(0x195),_0x597247(0x196)]},'createdAt':_0xdae78c}}),database_1[_0x597247(0x151)][_0x597247(0x1c7)][_0x597247(0x16d)]({'where':{'shopId':_0x2e7778,'gateway':{'not':_0x597247(0x1c9)},'status':_0x597247(0x158),'createdAt':_0xdae78c}}),database_1[_0x597247(0x151)][_0x597247(0x1c7)][_0x597247(0x16d)]({'where':{'shopId':_0x2e7778,'gateway':{'not':_0x597247(0x1c9)},'status':_0x597247(0x1fe)}}),database_1['default'][_0x597247(0x1c7)][_0x597247(0x16d)]({'where':{'shopId':_0x2e7778,'gateway':{'not':_0x597247(0x1c9)},'status':_0x597247(0x193)}}),database_1[_0x597247(0x151)][_0x597247(0x1c7)]['findMany']({'where':{'shopId':_0x2e7778,'gateway':{'not':_0x597247(0x1c9)},'status':'PAID','createdAt':_0xdae78c},'select':{'amount':!![],'currency':!![],'amountUSDT':!![],'amountAfterGatewayCommissionUSDT':!![],'createdAt':!![]}}),database_1[_0x597247(0x151)][_0x597247(0x1c7)][_0x597247(0x137)]({'where':{'shopId':_0x2e7778,'gateway':{'not':_0x597247(0x1c9)}},'take':0xa,'orderBy':{'createdAt':_0x597247(0x1ba)},'select':{'id':!![],'gateway':!![],'amount':!![],'currency':!![],'status':!![],'createdAt':!![]}}),database_1[_0x597247(0x151)]['payment']['findMany']({'where':{'shopId':_0x2e7778,'gateway':{'not':_0x597247(0x1c9)},'createdAt':_0xdae78c},'select':{'status':!![],'amountUSDT':!![],'createdAt':!![]},'orderBy':{'createdAt':_0x597247(0x16f)}}),database_1['default'][_0x597247(0x1c7)][_0x597247(0x16d)]({'where':{'shopId':_0x2e7778,'gateway':{'not':_0x597247(0x1c9)},'status':_0x597247(0x158)}}),database_1[_0x597247(0x151)][_0x597247(0x1c7)][_0x597247(0x137)]({'where':{'shopId':_0x2e7778,'gateway':{'not':_0x597247(0x1c9)},'status':_0x597247(0x158)},'select':{'amountAfterGatewayCommissionUSDT':!![]}}),database_1['default']['shop'][_0x597247(0x1ec)]({'where':{'id':_0x2e7778},'select':{'balance':!![]}})]);let _0x21bd39=0x0,_0x12454f=0x0;for(const _0x5ad031 of _0xa5e6f3){if(_0x5ad031['amountUSDT'])_0x21bd39+=_0x5ad031['amountUSDT'];else{const _0x245f7d=await currencyService_1['currencyService'][_0x597247(0x1ca)](_0x5ad031[_0x597247(0x19b)],_0x5ad031['currency']);_0x21bd39+=_0x245f7d;}_0x5ad031[_0x597247(0x1c0)]&&(_0x12454f+=_0x5ad031[_0x597247(0x1c0)]);}let _0x427910=0x0;for(const _0xc71491 of _0x511a9c){_0xc71491[_0x597247(0x1c0)]&&(_0x427910+=_0xc71491[_0x597247(0x1c0)]);}const _0xae7603=this['generateDailyStatistics'](_0x4c8c31,_0x312fa3,_0x5ab0fd||_0x7d102e),_0x1d9644=_0x4f71d8>0x0?_0x4d6aec/_0x4f71d8*0x64:0x0,_0x13426a=_0x493088>0x0?_0x3998dd/_0x493088*0x64:0x0;return{'totalPayments':_0x4f71d8,'successfulPayments':_0x4d6aec,'totalRevenue':Math[_0x597247(0x178)](_0x21bd39*0x64)/0x64,'merchantEarnings':Math[_0x597247(0x178)](_0x12454f*0x64)/0x64,'merchantTotalRevenue':Math[_0x597247(0x178)](_0x427910*0x64)/0x64,'payoutBalance':Math[_0x597247(0x178)]((_0x493312?.[_0x597247(0x1dc)]||0x0)*0x64)/0x64,'conversionRate':Math['round'](_0x1d9644*0x64)/0x64,'chargebackRate':Math[_0x597247(0x178)](_0x13426a*0x64)/0x64,'chargebacks':_0x3998dd,'refunds':_0xb9fcdc,'dailyRevenue':_0xae7603[_0x597247(0x1d9)],'dailyPayments':_0xae7603['dailyPayments'],'recentPayments':_0x41eb3f['map'](_0x36a543=>({'id':_0x36a543['id'],'gateway':_0x36a543[_0x597247(0x139)],'amount':_0x36a543[_0x597247(0x19b)],'currency':_0x36a543['currency'],'status':_0x36a543[_0x597247(0x1cd)],'createdAt':_0x36a543[_0x597247(0x1a2)]}))};}[a77_0x271f80(0x1c1)](_0x55b4be,_0x75c505,_0x1f0e40){const _0x23666d=a77_0x271f80,_0x5807bb=new Map(),_0x2c9ef5=new Date(_0x75c505);while(_0x2c9ef5<=_0x1f0e40){const _0x422680=_0x2c9ef5[_0x23666d(0x1df)]()[_0x23666d(0x138)]('T')[0x0];_0x5807bb[_0x23666d(0x1ae)](_0x422680,{'revenue':0x0,'count':0x0}),_0x2c9ef5[_0x23666d(0x171)](_0x2c9ef5['getDate']()+0x1);}for(const _0x111f50 of _0x55b4be){const _0x21eb78=_0x111f50[_0x23666d(0x1a2)]['toISOString']()['split']('T')[0x0],_0x500f28=_0x5807bb[_0x23666d(0x18c)](_0x21eb78);_0x500f28&&(_0x500f28[_0x23666d(0x16d)]+=0x1,_0x111f50[_0x23666d(0x1cd)]===_0x23666d(0x158)&&_0x111f50[_0x23666d(0x154)]&&(_0x500f28[_0x23666d(0x1e3)]+=_0x111f50['amountUSDT']));}const _0x546bd1=[],_0x4680e0=[];for(const [_0x27eaa8,_0x26eab7]of _0x5807bb){_0x546bd1[_0x23666d(0x146)]({'date':_0x27eaa8,'amount':Math[_0x23666d(0x178)](_0x26eab7['revenue']*0x64)/0x64}),_0x4680e0[_0x23666d(0x146)]({'date':_0x27eaa8,'count':_0x26eab7[_0x23666d(0x16d)]});}return{'dailyRevenue':_0x546bd1,'dailyPayments':_0x4680e0};}}exports[a77_0x271f80(0x1a6)]=ShopService;