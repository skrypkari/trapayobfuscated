'use strict';const a38_0x30d62c=a38_0x8a02;(function(_0x225db2,_0x2e1e2f){const _0x2add98=a38_0x8a02,_0x2c7f68=_0x225db2();while(!![]){try{const _0x585ee6=parseInt(_0x2add98(0xdc))/0x1+-parseInt(_0x2add98(0x111))/0x2*(parseInt(_0x2add98(0xe2))/0x3)+parseInt(_0x2add98(0xc5))/0x4+parseInt(_0x2add98(0x12b))/0x5*(-parseInt(_0x2add98(0xeb))/0x6)+parseInt(_0x2add98(0x108))/0x7*(parseInt(_0x2add98(0xf1))/0x8)+parseInt(_0x2add98(0x123))/0x9*(-parseInt(_0x2add98(0x110))/0xa)+-parseInt(_0x2add98(0x103))/0xb*(-parseInt(_0x2add98(0xca))/0xc);if(_0x585ee6===_0x2e1e2f)break;else _0x2c7f68['push'](_0x2c7f68['shift']());}catch(_0x2411f5){_0x2c7f68['push'](_0x2c7f68['shift']());}}}(a38_0x3d12,0x934ba));function a38_0x3d12(){const _0x2869d5=['Error\x20getting\x20all\x20rates:','xdr','\x20USDT,\x20with\x20','sats',',\x20using\x201\x20as\x20fallback','aud','\x20to\x20','ltc','4603632nbniFJ','Error\x20getting\x20rates\x20status:','MARKUP_PERCENTAGE','thb','gel','24732WNpItZ','updateCurrencyRates','toUpperCase','log','forEach','findFirst','🔄\x20Updating\x20currency\x20rates\x20from\x20CoinGecko...','updatedAt','xrp','eth','error','rate','php','currencyService','application/json','yfi','default','length','65278IPkPAM','findMany','czk','eos','hkd','__esModule','27tDdjPE','getAllRates','desc','🛑\x20Currency\x20rates\x20periodic\x20updates\x20stopped','COINGECKO_URL','try','updateInterval','bnb','warn','276270amhXXN','gbp','catch','btc','entries','cny','1083304LAlhlt','rub','✅\x20Currency\x20rates\x20updated\x20successfully','statusText','getRatesStatus','sar','convertMultipleToUSDT','Failed\x20to\x20update\x20rate\x20for\x20','Periodic\x20currency\x20rates\x20update\x20failed:','dkk','xag','krw','eur','map','\x20USDT\x20(rate:\x20','defineProperty','getCurrencyRate','json','4433FFyFMO','mmk','myr','bch','allSettled','35EtBppl','TesSoft\x20Payment\x20System/1.0','?ids=tether&vs_currencies=','ars','\x20USDT','%\x20markup\x20to\x20','bmd','📊\x20Received\x20rates\x20for\x20','337930SVylCp','59694bSxqwW','uah','upsert','\x20currencies','startPeriodicUpdates','CurrencyService','currencyRate','pkr','all','\x20USDT\x20=\x20','bits','CURRENCIES','clp','lkr','dot','tether','__importDefault','sek','297sYIwaV','status','link','❌\x20Failed\x20to\x20update\x20currency\x20rates:','xlm','nok','currency','cad','80XSsWCF','toFixed','../config/database','inr','ils','✅\x20Currency\x20rates\x20service\x20started\x20with\x20hourly\x20updates','stopPeriodicUpdates','ngn','Initial\x20currency\x20rates\x20update\x20failed:','convertToUSDT','Error\x20converting\x20','bhd','zar','Error\x20getting\x20rate\x20for\x20currency\x20','keys','toLowerCase','chf','mxn','nzd','aed','asc','usdt','💱\x20Applied\x20','No\x20rate\x20found\x20for\x20currency:\x20','count','CoinGecko\x20API\x20error:\x20','usd'];a38_0x3d12=function(){return _0x2869d5;};return a38_0x3d12();}var __importDefault=this&&this[a38_0x30d62c(0x121)]||function(_0x4bfffd){return _0x4bfffd&&_0x4bfffd['__esModule']?_0x4bfffd:{'default':_0x4bfffd};};Object[a38_0x30d62c(0x100)](exports,a38_0x30d62c(0xe1),{'value':!![]}),exports[a38_0x30d62c(0xd7)]=exports[a38_0x30d62c(0x116)]=void 0x0;const database_1=__importDefault(require(a38_0x30d62c(0x12d)));function a38_0x8a02(_0x5e204d,_0x2ec95d){const _0x3d12b5=a38_0x3d12();return a38_0x8a02=function(_0x8a0239,_0x488466){_0x8a0239=_0x8a0239-0xbc;let _0x537539=_0x3d12b5[_0x8a0239];return _0x537539;},a38_0x8a02(_0x5e204d,_0x2ec95d);}class CurrencyService{constructor(){const _0x368217=a38_0x30d62c;this[_0x368217(0xe6)]='https://api.coingecko.com/api/v3/simple/price',this[_0x368217(0x11c)]=[_0x368217(0xee),_0x368217(0xd3),_0x368217(0xc4),_0x368217(0x106),_0x368217(0xe9),_0x368217(0xdf),_0x368217(0xd2),_0x368217(0x127),_0x368217(0x125),_0x368217(0x11f),_0x368217(0xd9),_0x368217(0xbc),_0x368217(0x13e),_0x368217(0x10b),_0x368217(0xc2),'bdt',_0x368217(0x136),_0x368217(0x10e),'brl',_0x368217(0x12a),_0x368217(0x13b),_0x368217(0x11d),_0x368217(0xf0),_0x368217(0xde),_0x368217(0xfa),_0x368217(0xfd),_0x368217(0xec),_0x368217(0xc9),_0x368217(0xe0),'huf','idr',_0x368217(0x12f),_0x368217(0x12e),'jpy',_0x368217(0xfc),'kwd',_0x368217(0x11e),_0x368217(0x104),_0x368217(0x13c),_0x368217(0x105),_0x368217(0x132),_0x368217(0x128),_0x368217(0x13d),_0x368217(0xd6),_0x368217(0x118),'pln',_0x368217(0xf2),_0x368217(0xf6),_0x368217(0x122),'sgd',_0x368217(0xc8),_0x368217(0xe7),'twd',_0x368217(0x112),'vef','vnd',_0x368217(0x137),_0x368217(0xbe),_0x368217(0xfb),'xau',_0x368217(0x11b),_0x368217(0xc0)],this[_0x368217(0xe8)]=null,this[_0x368217(0xc7)]=0x3,this[_0x368217(0x115)]();}[a38_0x30d62c(0x115)](){const _0x195b58=a38_0x30d62c;this['updateCurrencyRates']()[_0x195b58(0xed)](_0x37e45a=>{const _0xaa122a=_0x195b58;console[_0xaa122a(0xd4)](_0xaa122a(0x133),_0x37e45a);}),this[_0x195b58(0xe8)]=setInterval(async()=>{const _0x3af5f6=_0x195b58;try{await this[_0x3af5f6(0xcb)]();}catch(_0x27c8f4){console['error'](_0x3af5f6(0xf9),_0x27c8f4);}},0x3c*0x3c*0x3e8),console[_0x195b58(0xcd)](_0x195b58(0x130));}[a38_0x30d62c(0x131)](){const _0x444922=a38_0x30d62c;this[_0x444922(0xe8)]&&(clearInterval(this[_0x444922(0xe8)]),this[_0x444922(0xe8)]=null,console[_0x444922(0xcd)](_0x444922(0xe5)));}async[a38_0x30d62c(0xcb)](){const _0x411360=a38_0x30d62c;try{console[_0x411360(0xcd)](_0x411360(0xd0));const _0x12fd4e=this[_0x411360(0x11c)]['join'](','),_0x5995be=this[_0x411360(0xe6)]+_0x411360(0x10a)+_0x12fd4e,_0x1bac3b=await fetch(_0x5995be,{'headers':{'Accept':_0x411360(0xd8),'User-Agent':_0x411360(0x109)}});if(!_0x1bac3b['ok'])throw new Error(_0x411360(0x144)+_0x1bac3b[_0x411360(0x124)]+'\x20'+_0x1bac3b[_0x411360(0xf4)]);const _0x50f458=await _0x1bac3b[_0x411360(0x102)]();if(!_0x50f458[_0x411360(0x120)])throw new Error('Invalid\x20response\x20format\x20from\x20CoinGecko\x20API');const _0x1c2e0e=_0x50f458[_0x411360(0x120)];console[_0x411360(0xcd)](_0x411360(0x10f)+Object[_0x411360(0x139)](_0x1c2e0e)[_0x411360(0xdb)]+_0x411360(0x114));const _0x47c7e4=Object[_0x411360(0xef)](_0x1c2e0e)[_0x411360(0xfe)](async([_0x255517,_0x3d2426])=>{const _0x1dce3c=_0x411360;try{await database_1['default'][_0x1dce3c(0x117)][_0x1dce3c(0x113)]({'where':{'currency':_0x255517[_0x1dce3c(0x13a)]()},'update':{'rate':_0x3d2426},'create':{'currency':_0x255517['toLowerCase'](),'rate':_0x3d2426}});}catch(_0x55bc56){console[_0x1dce3c(0xd4)](_0x1dce3c(0xf8)+_0x255517+':',_0x55bc56);}});await Promise[_0x411360(0x107)](_0x47c7e4),console['log'](_0x411360(0xf3));}catch(_0x43585d){console[_0x411360(0xd4)](_0x411360(0x126),_0x43585d);throw _0x43585d;}}async[a38_0x30d62c(0x101)](_0x224e7b){const _0xffb993=a38_0x30d62c,_0x4c1868=_0x224e7b['toLowerCase']();if(_0x4c1868===_0xffb993(0x140))return 0x1;try{const _0x559e8b=await database_1['default']['currencyRate']['findUnique']({'where':{'currency':_0x4c1868}});if(!_0x559e8b)return console[_0xffb993(0xea)](_0xffb993(0x142)+_0x224e7b+_0xffb993(0xc1)),0x1;return _0x559e8b[_0xffb993(0xd5)];}catch(_0x5117c7){return console[_0xffb993(0xd4)](_0xffb993(0x138)+_0x224e7b+':',_0x5117c7),0x1;}}async[a38_0x30d62c(0x134)](_0x124a1b,_0x51cf15){const _0x137693=a38_0x30d62c,_0x3f4496=_0x51cf15[_0x137693(0x13a)]();if(_0x3f4496===_0x137693(0x140)){const _0x16f6fb=_0x124a1b*(0x1+this[_0x137693(0xc7)]/0x64);return console[_0x137693(0xcd)](_0x137693(0x141)+this[_0x137693(0xc7)]+_0x137693(0x10d)+_0x124a1b+_0x137693(0x11a)+_0x16f6fb[_0x137693(0x12c)](0x6)+_0x137693(0x10c)),_0x16f6fb;}try{const _0xc159fb=await this[_0x137693(0x101)](_0x3f4496),_0x5bdb3a=_0x124a1b/_0xc159fb,_0x33a6ee=_0x5bdb3a*(0x1+this['MARKUP_PERCENTAGE']/0x64);return console['log']('💱\x20Converted\x20'+_0x124a1b+'\x20'+_0x51cf15[_0x137693(0xcc)]()+_0x137693(0xc3)+_0x5bdb3a['toFixed'](0x6)+_0x137693(0xbf)+this[_0x137693(0xc7)]+'%\x20markup\x20=\x20'+_0x33a6ee[_0x137693(0x12c)](0x6)+_0x137693(0xff)+_0xc159fb+')'),_0x33a6ee;}catch(_0x384bd1){console[_0x137693(0xd4)](_0x137693(0x135)+_0x124a1b+'\x20'+_0x51cf15+'\x20to\x20USDT:',_0x384bd1);const _0x53f5d5=_0x124a1b*(0x1+this[_0x137693(0xc7)]/0x64);return _0x53f5d5;}}async[a38_0x30d62c(0xf7)](_0x751375){const _0x2dd675=a38_0x30d62c;let _0x47fede=0x0;for(const {amount:_0x3d4c39,currency:_0x1ce1ca}of _0x751375){const _0x102f23=await this[_0x2dd675(0x134)](_0x3d4c39,_0x1ce1ca);_0x47fede+=_0x102f23;}return _0x47fede;}async[a38_0x30d62c(0xe3)](){const _0x488ec1=a38_0x30d62c;try{const _0x4ae378=await database_1['default'][_0x488ec1(0x117)][_0x488ec1(0xdd)]({'select':{'currency':!![],'rate':!![]}}),_0x592515={'usdt':0x1};return _0x4ae378[_0x488ec1(0xce)](_0x14eafd=>{const _0x22ab84=_0x488ec1;_0x592515[_0x14eafd[_0x22ab84(0x129)]]=_0x14eafd[_0x22ab84(0xd5)];}),_0x592515;}catch(_0x5e2e68){return console['error'](_0x488ec1(0xbd),_0x5e2e68),{'usdt':0x1};}}async[a38_0x30d62c(0xf5)](){const _0x295eed=a38_0x30d62c;try{const [_0x30e86a,_0x2f9e7c,_0x188b59]=await Promise[_0x295eed(0x119)]([database_1[_0x295eed(0xda)][_0x295eed(0x117)][_0x295eed(0x143)](),database_1[_0x295eed(0xda)][_0x295eed(0x117)][_0x295eed(0xcf)]({'orderBy':{'updatedAt':_0x295eed(0xe4)},'select':{'updatedAt':!![]}}),database_1[_0x295eed(0xda)][_0x295eed(0x117)][_0x295eed(0xcf)]({'orderBy':{'updatedAt':_0x295eed(0x13f)},'select':{'updatedAt':!![]}})]);return{'totalRates':_0x30e86a,'lastUpdated':_0x2f9e7c?.[_0x295eed(0xd1)]||null,'oldestRate':_0x188b59?.[_0x295eed(0xd1)]||null,'markupPercentage':this[_0x295eed(0xc7)]};}catch(_0x4d2d1a){return console[_0x295eed(0xd4)](_0x295eed(0xc6),_0x4d2d1a),{'totalRates':0x0,'lastUpdated':null,'oldestRate':null,'markupPercentage':this[_0x295eed(0xc7)]};}}['getMarkupPercentage'](){const _0x5ca126=a38_0x30d62c;return this[_0x5ca126(0xc7)];}}exports[a38_0x30d62c(0x116)]=CurrencyService,exports[a38_0x30d62c(0xd7)]=new CurrencyService();