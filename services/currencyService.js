'use strict';const a36_0x218169=a36_0x1b07;(function(_0x15c09b,_0x538d2d){const _0x15fb1f=a36_0x1b07,_0x7e0f36=_0x15c09b();while(!![]){try{const _0xf6840a=-parseInt(_0x15fb1f(0x1e1))/0x1+parseInt(_0x15fb1f(0x18b))/0x2*(-parseInt(_0x15fb1f(0x1bc))/0x3)+parseInt(_0x15fb1f(0x1f5))/0x4*(-parseInt(_0x15fb1f(0x200))/0x5)+parseInt(_0x15fb1f(0x1b7))/0x6*(parseInt(_0x15fb1f(0x1d1))/0x7)+parseInt(_0x15fb1f(0x1eb))/0x8+-parseInt(_0x15fb1f(0x201))/0x9*(parseInt(_0x15fb1f(0x1d4))/0xa)+-parseInt(_0x15fb1f(0x1c4))/0xb*(-parseInt(_0x15fb1f(0x195))/0xc);if(_0xf6840a===_0x538d2d)break;else _0x7e0f36['push'](_0x7e0f36['shift']());}catch(_0x2197c2){_0x7e0f36['push'](_0x7e0f36['shift']());}}}(a36_0x199b,0x93737));function a36_0x199b(){const _0x12b3a9=['yfi','jpy','55VUJhDJ','keys','aed','ðŸ’±\x20Applied\x20','status','bits','link','dot','?ids=tether&vs_currencies=','currencyRate','ðŸ“Š\x20Received\x20rates\x20for\x20','catch','getCurrencyRate','30058Ucllnp','MARKUP_PERCENTAGE','upsert','40tAqqXu','https://api.coingecko.com/api/v3/simple/price','updatedAt','bdt','ltc','updateCurrencyRates','btc','âœ…\x20Currency\x20rates\x20updated\x20successfully','TesSoft\x20Payment\x20System/1.0','krw','currencyService','asc','map','163756HurqHx','startPeriodicUpdates','\x20to\x20USDT:','pln','%\x20markup\x20=\x20','ngn','vnd','idr','php','toUpperCase','249992WPytVR','log','usdt','Invalid\x20response\x20format\x20from\x20CoinGecko\x20API','nzd','stopPeriodicUpdates','xdr','chf','__esModule','defineProperty','381828UcDGgH','xlm','toLowerCase','findMany','CurrencyService','xrp','currency','Error\x20getting\x20rates\x20status:','ðŸ›‘\x20Currency\x20rates\x20periodic\x20updates\x20stopped','../config/database','CURRENCIES','45LxJNHT','1961451cYuQSo','bhd','getAllRates','gbp','\x20USDT,\x20with\x20','lkr','bmd','xag','gel','Error\x20getting\x20all\x20rates:','cny','pkr','convertToUSDT','ils','270vbfIVH','default','Error\x20converting\x20','mmk','application/json','findFirst','uah','twd','length','\x20to\x20','7959516BMPgmy','error','COINGECKO_URL','brl','cad','mxn','inr','ars','\x20currencies','allSettled','clp','join','usd','updateInterval','Initial\x20currency\x20rates\x20update\x20failed:','xau','No\x20rate\x20found\x20for\x20currency:\x20','all','json','rub','tether','âœ…\x20Currency\x20rates\x20service\x20started\x20with\x20hourly\x20updates','Periodic\x20currency\x20rates\x20update\x20failed:','dkk','%\x20markup\x20to\x20','getMarkupPercentage','eth','kwd','ðŸ’±\x20Converted\x20','count','\x20USDT\x20=\x20','__importDefault','\x20USDT','eos','120vZmOUa','âŒ\x20Failed\x20to\x20update\x20currency\x20rates:','sats','forEach','ðŸ”„\x20Updating\x20currency\x20rates\x20from\x20CoinGecko...','20778GTRaYF','eur','\x20USDT\x20(rate:\x20','toFixed','statusText','sar'];a36_0x199b=function(){return _0x12b3a9;};return a36_0x199b();}var __importDefault=this&&this[a36_0x218169(0x1b4)]||function(_0x27b714){const _0x582290=a36_0x218169;return _0x27b714&&_0x27b714[_0x582290(0x1f3)]?_0x27b714:{'default':_0x27b714};};Object[a36_0x218169(0x1f4)](exports,'__esModule',{'value':!![]}),exports[a36_0x218169(0x1de)]=exports[a36_0x218169(0x1f9)]=void 0x0;const database_1=__importDefault(require(a36_0x218169(0x1fe)));function a36_0x1b07(_0x17bb1b,_0x12e9e9){const _0x199bab=a36_0x199b();return a36_0x1b07=function(_0x1b079c,_0x1c1ec9){_0x1b079c=_0x1b079c-0x184;let _0xed6ec1=_0x199bab[_0x1b079c];return _0xed6ec1;},a36_0x1b07(_0x17bb1b,_0x12e9e9);}class CurrencyService{constructor(){const _0x53cee5=a36_0x218169;this[_0x53cee5(0x197)]=_0x53cee5(0x1d5),this[_0x53cee5(0x1ff)]=[_0x53cee5(0x1da),_0x53cee5(0x1af),_0x53cee5(0x1d8),'bch','bnb',_0x53cee5(0x1b6),_0x53cee5(0x1fa),_0x53cee5(0x1f6),_0x53cee5(0x1ca),_0x53cee5(0x1cb),_0x53cee5(0x1c2),_0x53cee5(0x1a1),_0x53cee5(0x1c6),_0x53cee5(0x19c),'aud',_0x53cee5(0x1d7),_0x53cee5(0x202),_0x53cee5(0x207),_0x53cee5(0x198),_0x53cee5(0x199),_0x53cee5(0x1f2),_0x53cee5(0x19f),_0x53cee5(0x187),'czk',_0x53cee5(0x1ac),_0x53cee5(0x1bd),_0x53cee5(0x204),_0x53cee5(0x185),'hkd','huf',_0x53cee5(0x1e8),_0x53cee5(0x18a),_0x53cee5(0x19b),_0x53cee5(0x1c3),_0x53cee5(0x1dd),_0x53cee5(0x1b0),_0x53cee5(0x206),_0x53cee5(0x18e),_0x53cee5(0x19a),'myr',_0x53cee5(0x1e6),'nok',_0x53cee5(0x1ef),_0x53cee5(0x1e9),_0x53cee5(0x188),_0x53cee5(0x1e4),_0x53cee5(0x1a8),_0x53cee5(0x1c1),'sek','sgd','thb','try',_0x53cee5(0x192),_0x53cee5(0x191),'vef',_0x53cee5(0x1e7),'zar',_0x53cee5(0x1f1),_0x53cee5(0x184),_0x53cee5(0x1a4),_0x53cee5(0x1c9),_0x53cee5(0x1b9)],this[_0x53cee5(0x1a2)]=null,this[_0x53cee5(0x1d2)]=0x3,this[_0x53cee5(0x1e2)]();}[a36_0x218169(0x1e2)](){const _0x33d019=a36_0x218169;this['updateCurrencyRates']()[_0x33d019(0x1cf)](_0x55f6c7=>{const _0x3a4eb7=_0x33d019;console[_0x3a4eb7(0x196)](_0x3a4eb7(0x1a3),_0x55f6c7);}),this[_0x33d019(0x1a2)]=setInterval(async()=>{const _0x49bc02=_0x33d019;try{await this[_0x49bc02(0x1d9)]();}catch(_0x236d4a){console[_0x49bc02(0x196)](_0x49bc02(0x1ab),_0x236d4a);}},0x3c*0x3c*0x3e8),console['log'](_0x33d019(0x1aa));}[a36_0x218169(0x1f0)](){const _0x271c4b=a36_0x218169;this[_0x271c4b(0x1a2)]&&(clearInterval(this[_0x271c4b(0x1a2)]),this[_0x271c4b(0x1a2)]=null,console[_0x271c4b(0x1ec)](_0x271c4b(0x1fd)));}async[a36_0x218169(0x1d9)](){const _0x105e63=a36_0x218169;try{console[_0x105e63(0x1ec)](_0x105e63(0x1bb));const _0x2663a9=this[_0x105e63(0x1ff)][_0x105e63(0x1a0)](','),_0xf55533=this['COINGECKO_URL']+_0x105e63(0x1cc)+_0x2663a9,_0x4d320b=await fetch(_0xf55533,{'headers':{'Accept':_0x105e63(0x18f),'User-Agent':_0x105e63(0x1dc)}});if(!_0x4d320b['ok'])throw new Error('CoinGecko\x20API\x20error:\x20'+_0x4d320b[_0x105e63(0x1c8)]+'\x20'+_0x4d320b[_0x105e63(0x1c0)]);const _0x5b5630=await _0x4d320b[_0x105e63(0x1a7)]();if(!_0x5b5630['tether'])throw new Error(_0x105e63(0x1ee));const _0x2f9865=_0x5b5630[_0x105e63(0x1a9)];console[_0x105e63(0x1ec)](_0x105e63(0x1ce)+Object[_0x105e63(0x1c5)](_0x2f9865)[_0x105e63(0x193)]+_0x105e63(0x19d));const _0x34e5e0=Object['entries'](_0x2f9865)[_0x105e63(0x1e0)](async([_0x506b82,_0x5cf2a0])=>{const _0x3a6402=_0x105e63;try{await database_1['default'][_0x3a6402(0x1cd)][_0x3a6402(0x1d3)]({'where':{'currency':_0x506b82[_0x3a6402(0x1f7)]()},'update':{'rate':_0x5cf2a0},'create':{'currency':_0x506b82[_0x3a6402(0x1f7)](),'rate':_0x5cf2a0}});}catch(_0x30f06e){console[_0x3a6402(0x196)]('Failed\x20to\x20update\x20rate\x20for\x20'+_0x506b82+':',_0x30f06e);}});await Promise[_0x105e63(0x19e)](_0x34e5e0),console[_0x105e63(0x1ec)](_0x105e63(0x1db));}catch(_0x1f6db5){console[_0x105e63(0x196)](_0x105e63(0x1b8),_0x1f6db5);throw _0x1f6db5;}}async['getCurrencyRate'](_0x3d7e49){const _0x5accbb=a36_0x218169,_0x4f933d=_0x3d7e49[_0x5accbb(0x1f7)]();if(_0x4f933d===_0x5accbb(0x1ed))return 0x1;try{const _0x282f94=await database_1['default'][_0x5accbb(0x1cd)]['findUnique']({'where':{'currency':_0x4f933d}});if(!_0x282f94)return console['warn'](_0x5accbb(0x1a5)+_0x3d7e49+',\x20using\x201\x20as\x20fallback'),0x1;return _0x282f94['rate'];}catch(_0x102c0d){return console[_0x5accbb(0x196)]('Error\x20getting\x20rate\x20for\x20currency\x20'+_0x3d7e49+':',_0x102c0d),0x1;}}async[a36_0x218169(0x189)](_0x3f0ec2,_0x2f08a2){const _0x33a98f=a36_0x218169,_0x212ca5=_0x2f08a2['toLowerCase']();if(_0x212ca5==='usdt'){const _0x2fc299=_0x3f0ec2*(0x1+this['MARKUP_PERCENTAGE']/0x64);return console[_0x33a98f(0x1ec)](_0x33a98f(0x1c7)+this[_0x33a98f(0x1d2)]+_0x33a98f(0x1ad)+_0x3f0ec2+_0x33a98f(0x1b3)+_0x2fc299[_0x33a98f(0x1bf)](0x6)+_0x33a98f(0x1b5)),_0x2fc299;}try{const _0x5acb43=await this[_0x33a98f(0x1d0)](_0x212ca5),_0x20267a=_0x3f0ec2/_0x5acb43,_0x4af429=_0x20267a*(0x1+this[_0x33a98f(0x1d2)]/0x64);return console[_0x33a98f(0x1ec)](_0x33a98f(0x1b1)+_0x3f0ec2+'\x20'+_0x2f08a2[_0x33a98f(0x1ea)]()+_0x33a98f(0x194)+_0x20267a[_0x33a98f(0x1bf)](0x6)+_0x33a98f(0x205)+this[_0x33a98f(0x1d2)]+_0x33a98f(0x1e5)+_0x4af429[_0x33a98f(0x1bf)](0x6)+_0x33a98f(0x1be)+_0x5acb43+')'),_0x4af429;}catch(_0xc4ded0){console[_0x33a98f(0x196)](_0x33a98f(0x18d)+_0x3f0ec2+'\x20'+_0x2f08a2+_0x33a98f(0x1e3),_0xc4ded0);const _0x572f17=_0x3f0ec2*(0x1+this[_0x33a98f(0x1d2)]/0x64);return _0x572f17;}}async['convertMultipleToUSDT'](_0x58dc6c){const _0x203e27=a36_0x218169;let _0x5aaa2b=0x0;for(const {amount:_0x30a7f9,currency:_0x2c0d6a}of _0x58dc6c){const _0x44dfb5=await this[_0x203e27(0x189)](_0x30a7f9,_0x2c0d6a);_0x5aaa2b+=_0x44dfb5;}return _0x5aaa2b;}async[a36_0x218169(0x203)](){const _0x2415a9=a36_0x218169;try{const _0x2013c2=await database_1[_0x2415a9(0x18c)][_0x2415a9(0x1cd)][_0x2415a9(0x1f8)]({'select':{'currency':!![],'rate':!![]}}),_0x6f8020={'usdt':0x1};return _0x2013c2[_0x2415a9(0x1ba)](_0x4557f0=>{const _0x3cc725=_0x2415a9;_0x6f8020[_0x4557f0[_0x3cc725(0x1fb)]]=_0x4557f0['rate'];}),_0x6f8020;}catch(_0x258cf7){return console[_0x2415a9(0x196)](_0x2415a9(0x186),_0x258cf7),{'usdt':0x1};}}async['getRatesStatus'](){const _0x5d9950=a36_0x218169;try{const [_0xa40224,_0x20c3bd,_0xd84c3a]=await Promise[_0x5d9950(0x1a6)]([database_1['default'][_0x5d9950(0x1cd)][_0x5d9950(0x1b2)](),database_1[_0x5d9950(0x18c)][_0x5d9950(0x1cd)]['findFirst']({'orderBy':{'updatedAt':'desc'},'select':{'updatedAt':!![]}}),database_1['default'][_0x5d9950(0x1cd)][_0x5d9950(0x190)]({'orderBy':{'updatedAt':_0x5d9950(0x1df)},'select':{'updatedAt':!![]}})]);return{'totalRates':_0xa40224,'lastUpdated':_0x20c3bd?.[_0x5d9950(0x1d6)]||null,'oldestRate':_0xd84c3a?.[_0x5d9950(0x1d6)]||null,'markupPercentage':this['MARKUP_PERCENTAGE']};}catch(_0x41db92){return console[_0x5d9950(0x196)](_0x5d9950(0x1fc),_0x41db92),{'totalRates':0x0,'lastUpdated':null,'oldestRate':null,'markupPercentage':this['MARKUP_PERCENTAGE']};}}[a36_0x218169(0x1ae)](){const _0x150d1b=a36_0x218169;return this[_0x150d1b(0x1d2)];}}exports[a36_0x218169(0x1f9)]=CurrencyService,exports[a36_0x218169(0x1de)]=new CurrencyService();