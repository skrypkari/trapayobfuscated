'use strict';function a61_0x285c(_0x2ec9e5,_0x1b1bb4){_0x2ec9e5=_0x2ec9e5-0xaa;const _0x5a13b6=a61_0x5a13();let _0x285c2b=_0x5a13b6[_0x2ec9e5];return _0x285c2b;}const a61_0x429b0a=a61_0x285c;(function(_0x146a56,_0x455e45){const _0x58201d=a61_0x285c,_0x5c653d=_0x146a56();while(!![]){try{const _0x4fd7cf=parseInt(_0x58201d(0xdf))/0x1*(parseInt(_0x58201d(0xb1))/0x2)+-parseInt(_0x58201d(0xd3))/0x3*(parseInt(_0x58201d(0xf8))/0x4)+-parseInt(_0x58201d(0xd5))/0x5+-parseInt(_0x58201d(0xcb))/0x6+-parseInt(_0x58201d(0xc4))/0x7+parseInt(_0x58201d(0xd8))/0x8+parseInt(_0x58201d(0xe8))/0x9;if(_0x4fd7cf===_0x455e45)break;else _0x5c653d['push'](_0x5c653d['shift']());}catch(_0x59d9e0){_0x5c653d['push'](_0x5c653d['shift']());}}}(a61_0x5a13,0x26ef8));var __importDefault=this&&this[a61_0x429b0a(0xc5)]||function(_0x952248){const _0x88f089=a61_0x429b0a;return _0x952248&&_0x952248[_0x88f089(0xde)]?_0x952248:{'default':_0x952248};};function a61_0x5a13(){const _0x54eff9=['742010dCKImH','existsSync','type','1482240Ecmggo','default','method','message','join','DEPOSIT','__esModule','24195AgZUAT','callbackUrl','catch','paymentId','toString','ðŸ”„\x20Processing\x20MaxPara\x20webhook:','maxpara-requests.log','MaxPara\x20authentication\x20failed','cwd','6275151hXoGJG','401','MaxParaService','MaxPara\x20server\x20error','validateWebhookSignature','toISOString','createDeposit','log','maxpara-responses.log','processWebhook','token','Request\x20failed','Failed\x20to\x20write\x20to\x20request\x20log\x20file:','logResponse','expire_date','error','68aihyJv','orderId','currency','HTTP\x20','amount','ðŸ¦\x20Creating\x20MaxPara\x20deposit\x20for\x20','customerName','DECLINED','4MFZliu','FAILED','path','HIDDEN','includes','\x20->\x20','logs','mkdirSync','POST','Failed\x20to\x20write\x20to\x20response\x20log\x20file:','fast','logRequest','link','appendFileSync','500','/api/deposit','APPROVED','ðŸ“Š\x20MaxPara\x20webhook\x20processed:\x20','status','1641850WRkMUE','__importDefault','success','json','baseUrl','âŒ\x20MaxPara\x20API\x20error:','config','1733448YFvyvS','MaxPara\x20validation\x20error:\x20','stringify','400','application/json','defineProperty','MaxPara\x20API\x20error:\x20','PENDING','17571kYpVzB','ðŸ“¤\x20MaxPara\x20API\x20request:'];a61_0x5a13=function(){return _0x54eff9;};return a61_0x5a13();}Object[a61_0x429b0a(0xd0)](exports,a61_0x429b0a(0xde),{'value':!![]}),exports['MaxParaService']=void 0x0;const fs_1=__importDefault(require('fs')),path_1=__importDefault(require(a61_0x429b0a(0xb3)));class MaxParaService{constructor(_0x439e99){const _0xff5952=a61_0x429b0a;this[_0xff5952(0xca)]=_0x439e99;}[a61_0x429b0a(0xbc)](_0x37fac1,_0x4a06a6){const _0xd9311e=a61_0x429b0a,_0x2c7923=path_1[_0xd9311e(0xd9)][_0xd9311e(0xdc)](process[_0xd9311e(0xe7)](),_0xd9311e(0xb7)),_0x10ffc6=path_1[_0xd9311e(0xd9)]['join'](_0x2c7923,_0xd9311e(0xe5));!fs_1['default'][_0xd9311e(0xd6)](_0x2c7923)&&fs_1[_0xd9311e(0xd9)][_0xd9311e(0xb8)](_0x2c7923,{'recursive':!![]});const _0x966d2d=new Date()['toISOString'](),_0x41e32c='['+_0x966d2d+']\x20'+_0x37fac1+':\x20'+JSON['stringify'](_0x4a06a6)+'\x0a';try{fs_1['default']['appendFileSync'](_0x10ffc6,_0x41e32c);}catch(_0x295d7a){console[_0xd9311e(0xf7)](_0xd9311e(0xf4),_0x295d7a);}}[a61_0x429b0a(0xf5)](_0x32f83d,_0xeb7079){const _0x4a0eb5=a61_0x429b0a,_0x2b3048=path_1[_0x4a0eb5(0xd9)]['join'](process[_0x4a0eb5(0xe7)](),_0x4a0eb5(0xb7)),_0x272a41=path_1[_0x4a0eb5(0xd9)][_0x4a0eb5(0xdc)](_0x2b3048,_0x4a0eb5(0xf0));!fs_1['default'][_0x4a0eb5(0xd6)](_0x2b3048)&&fs_1[_0x4a0eb5(0xd9)]['mkdirSync'](_0x2b3048,{'recursive':!![]});const _0x2c16ac=new Date()[_0x4a0eb5(0xed)](),_0x42f11e='['+_0x2c16ac+']\x20'+_0x32f83d+':\x20'+JSON[_0x4a0eb5(0xcd)](_0xeb7079)+'\x0a';try{fs_1[_0x4a0eb5(0xd9)][_0x4a0eb5(0xbe)](_0x272a41,_0x42f11e);}catch(_0x3c74ef){console['error'](_0x4a0eb5(0xba),_0x3c74ef);}}async[a61_0x429b0a(0xee)](_0x4ace68){const _0x3e92a7=a61_0x429b0a;console[_0x3e92a7(0xef)](_0x3e92a7(0xae)+_0x4ace68['amount']+'\x20'+_0x4ace68[_0x3e92a7(0xab)]);try{const _0x5c0445={'key':this[_0x3e92a7(0xca)]['apiKey'],'username':_0x4ace68[_0x3e92a7(0xaf)],'user_id':_0x4ace68[_0x3e92a7(0xe2)],'token':_0x4ace68[_0x3e92a7(0xaa)],'method':_0x3e92a7(0xbb),'amount':_0x4ace68[_0x3e92a7(0xad)],'callbackUrl':_0x4ace68[_0x3e92a7(0xe0)]};this[_0x3e92a7(0xbc)](_0x3e92a7(0xc0),{..._0x5c0445,'key':_0x3e92a7(0xb4)}),console[_0x3e92a7(0xef)](_0x3e92a7(0xd4),{..._0x5c0445,'key':_0x3e92a7(0xb4)});const _0x542165=await fetch(this[_0x3e92a7(0xca)][_0x3e92a7(0xc8)]+_0x3e92a7(0xc0),{'method':_0x3e92a7(0xb9),'headers':{'Content-Type':_0x3e92a7(0xcf),'User-Agent':'TrapayUK/1.0'},'body':JSON[_0x3e92a7(0xcd)](_0x5c0445)});if(!_0x542165['ok']){const _0x2683a6=await _0x542165[_0x3e92a7(0xc7)]()[_0x3e92a7(0xe1)](()=>({}));throw new Error(_0x3e92a7(0xac)+_0x542165[_0x3e92a7(0xc3)]+':\x20'+(_0x2683a6[_0x3e92a7(0xdb)]||_0x3e92a7(0xf3)));}const _0x5929d8=await _0x542165[_0x3e92a7(0xc7)]();this[_0x3e92a7(0xf5)](_0x3e92a7(0xc0),_0x5929d8),console[_0x3e92a7(0xef)]('ðŸ“¥\x20MaxPara\x20API\x20response:',_0x5929d8);if(_0x5929d8['code']!==0xc8||_0x5929d8[_0x3e92a7(0xc3)]!==_0x3e92a7(0xc6))throw new Error('MaxPara\x20API\x20error:\x20'+(_0x5929d8[_0x3e92a7(0xdb)]||'Unknown\x20error'));return{'gateway_payment_id':_0x5929d8['token'],'payment_url':_0x5929d8[_0x3e92a7(0xbd)],'expires_at':_0x5929d8[_0x3e92a7(0xf6)]};}catch(_0x5cc872){console['error'](_0x3e92a7(0xc9),_0x5cc872['message']);if(_0x5cc872[_0x3e92a7(0xdb)]?.['includes'](_0x3e92a7(0xce)))throw new Error(_0x3e92a7(0xcc)+_0x5cc872[_0x3e92a7(0xdb)]);else{if(_0x5cc872[_0x3e92a7(0xdb)]?.[_0x3e92a7(0xb5)](_0x3e92a7(0xe9)))throw new Error(_0x3e92a7(0xe6));else{if(_0x5cc872[_0x3e92a7(0xdb)]?.[_0x3e92a7(0xb5)](_0x3e92a7(0xbf)))throw new Error(_0x3e92a7(0xeb));else throw new Error(_0x3e92a7(0xd1)+_0x5cc872[_0x3e92a7(0xdb)]);}}}}[a61_0x429b0a(0xf1)](_0x45b0f9){const _0x26af65=a61_0x429b0a;console['log'](_0x26af65(0xe4),_0x45b0f9);const _0x56dbde=_0x45b0f9[_0x26af65(0xf2)];let _0x351e90;switch(_0x45b0f9[_0x26af65(0xc3)]){case _0x26af65(0xc1):_0x351e90='PAID';break;case _0x26af65(0xb0):_0x351e90=_0x26af65(0xb2);break;default:_0x351e90=_0x26af65(0xd2);break;}const _0x53e9e1={'method':_0x45b0f9[_0x26af65(0xda)],'transactionId':_0x45b0f9['id'][_0x26af65(0xe3)]()};return _0x45b0f9[_0x26af65(0xdb)]&&(_0x53e9e1['message']=_0x45b0f9['message']),console[_0x26af65(0xef)](_0x26af65(0xc2)+_0x56dbde+_0x26af65(0xb6)+_0x351e90),{'paymentId':_0x56dbde,'status':_0x351e90,'additionalInfo':_0x53e9e1};}[a61_0x429b0a(0xec)](_0x333ce4,_0x2e27ee){const _0x182883=a61_0x429b0a;return!!(_0x333ce4['id']&&_0x333ce4[_0x182883(0xf2)]&&_0x333ce4[_0x182883(0xc3)]&&_0x333ce4[_0x182883(0xd7)]===_0x182883(0xdd));}}exports[a61_0x429b0a(0xea)]=MaxParaService;