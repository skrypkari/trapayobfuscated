'use strict';const a69_0x33dbca=a69_0x34a3;(function(_0xd9c1ed,_0x18ef3d){const _0x329c83=a69_0x34a3,_0x1ecd5d=_0xd9c1ed();while(!![]){try{const _0x4ae2ec=-parseInt(_0x329c83(0x196))/0x1+-parseInt(_0x329c83(0x19f))/0x2*(parseInt(_0x329c83(0x198))/0x3)+-parseInt(_0x329c83(0x1a2))/0x4*(parseInt(_0x329c83(0x1ab))/0x5)+-parseInt(_0x329c83(0x19c))/0x6+parseInt(_0x329c83(0x183))/0x7*(-parseInt(_0x329c83(0x1b2))/0x8)+parseInt(_0x329c83(0x18e))/0x9*(parseInt(_0x329c83(0x187))/0xa)+parseInt(_0x329c83(0x1a4))/0xb*(parseInt(_0x329c83(0x1b0))/0xc);if(_0x4ae2ec===_0x18ef3d)break;else _0x1ecd5d['push'](_0x1ecd5d['shift']());}catch(_0x13fd8a){_0x1ecd5d['push'](_0x1ecd5d['shift']());}}}(a69_0x5c67,0xd18a5));var __importDefault=this&&this[a69_0x33dbca(0x1b8)]||function(_0x46d129){return _0x46d129&&_0x46d129['__esModule']?_0x46d129:{'default':_0x46d129};};Object['defineProperty'](exports,'__esModule',{'value':!![]}),exports[a69_0x33dbca(0x1c0)]=void 0x0;const fs_1=__importDefault(require('fs')),path_1=__importDefault(require(a69_0x33dbca(0x1ba)));function a69_0x34a3(_0x32e527,_0x2b640c){_0x32e527=_0x32e527-0x180;const _0x5c67a9=a69_0x5c67();let _0x34a316=_0x5c67a9[_0x32e527];return _0x34a316;}class MaxParaService{constructor(_0x364cc3){this['config']=_0x364cc3;}['logRequest'](_0x10b642,_0x5ddc9b){const _0x3e40f2=a69_0x33dbca,_0xa08dbf=path_1[_0x3e40f2(0x1b5)]['join'](process[_0x3e40f2(0x199)](),'logs'),_0x2ad7c4=path_1['default']['join'](_0xa08dbf,'maxpara-requests.log');!fs_1['default'][_0x3e40f2(0x192)](_0xa08dbf)&&fs_1[_0x3e40f2(0x1b5)][_0x3e40f2(0x1bb)](_0xa08dbf,{'recursive':!![]});const _0x598ae1=new Date()['toISOString'](),_0x31c170='['+_0x598ae1+']\x20'+_0x10b642+':\x20'+JSON[_0x3e40f2(0x18b)](_0x5ddc9b)+'\x0a';try{fs_1[_0x3e40f2(0x1b5)][_0x3e40f2(0x1be)](_0x2ad7c4,_0x31c170);}catch(_0x14dfc5){console['error'](_0x3e40f2(0x1ae),_0x14dfc5);}}[a69_0x33dbca(0x18f)](_0x54c143,_0x2d8d78){const _0x3de38d=a69_0x33dbca,_0x39b4e1=path_1[_0x3de38d(0x1b5)][_0x3de38d(0x1c2)](process['cwd'](),_0x3de38d(0x1bd)),_0x5c9d25=path_1[_0x3de38d(0x1b5)]['join'](_0x39b4e1,_0x3de38d(0x191));!fs_1[_0x3de38d(0x1b5)][_0x3de38d(0x192)](_0x39b4e1)&&fs_1[_0x3de38d(0x1b5)][_0x3de38d(0x1bb)](_0x39b4e1,{'recursive':!![]});const _0x593197=new Date()[_0x3de38d(0x1b4)](),_0x75bd4c='['+_0x593197+']\x20'+_0x54c143+':\x20'+JSON[_0x3de38d(0x18b)](_0x2d8d78)+'\x0a';try{fs_1['default'][_0x3de38d(0x1be)](_0x5c9d25,_0x75bd4c);}catch(_0xc1aaab){console[_0x3de38d(0x1a8)]('Failed\x20to\x20write\x20to\x20response\x20log\x20file:',_0xc1aaab);}}async['createDeposit'](_0x187f89){const _0x38213f=a69_0x33dbca;console['log']('üè¶\x20Creating\x20MaxPara\x20deposit\x20for\x20'+_0x187f89[_0x38213f(0x188)]+'\x20'+_0x187f89['currency']);try{const _0x3560a1={'key':this[_0x38213f(0x1bc)][_0x38213f(0x18a)],'username':_0x187f89[_0x38213f(0x1a0)],'user_id':_0x187f89['paymentId'],'token':_0x187f89['orderId'],'method':_0x38213f(0x197),'amount':_0x187f89['amount'],'callbackUrl':_0x187f89[_0x38213f(0x185)]};this['logRequest']('/api/deposit',{..._0x3560a1,'key':_0x38213f(0x19e)}),console[_0x38213f(0x1af)](_0x38213f(0x184),{..._0x3560a1,'key':_0x38213f(0x19e)});const _0x28094f=await fetch(this[_0x38213f(0x1bc)][_0x38213f(0x1a7)]+_0x38213f(0x189),{'method':_0x38213f(0x19d),'headers':{'Content-Type':_0x38213f(0x18c),'User-Agent':'TrapayUK/1.0'},'body':JSON['stringify'](_0x3560a1)});if(!_0x28094f['ok']){const _0x4d3492=await _0x28094f[_0x38213f(0x1b9)]()[_0x38213f(0x180)](()=>({}));throw new Error(_0x38213f(0x1a6)+_0x28094f[_0x38213f(0x18d)]+':\x20'+(_0x4d3492['message']||_0x38213f(0x1a5)));}const _0x58b9c6=await _0x28094f[_0x38213f(0x1b9)]();this['logResponse'](_0x38213f(0x189),_0x58b9c6),console[_0x38213f(0x1af)](_0x38213f(0x1c1),_0x58b9c6);if(_0x58b9c6['code']!==0xc8||_0x58b9c6[_0x38213f(0x18d)]!==_0x38213f(0x1a1))throw new Error(_0x38213f(0x1b6)+(_0x58b9c6[_0x38213f(0x181)]||_0x38213f(0x1ad)));return{'gateway_payment_id':_0x58b9c6[_0x38213f(0x1a9)],'payment_url':_0x58b9c6['link'],'expires_at':_0x58b9c6['expire_date']};}catch(_0x26d50a){console[_0x38213f(0x1a8)](_0x38213f(0x1b7),_0x26d50a[_0x38213f(0x181)]);if(_0x26d50a[_0x38213f(0x181)]?.[_0x38213f(0x19b)](_0x38213f(0x1aa)))throw new Error(_0x38213f(0x19a)+_0x26d50a[_0x38213f(0x181)]);else{if(_0x26d50a['message']?.[_0x38213f(0x19b)](_0x38213f(0x194)))throw new Error(_0x38213f(0x186));else{if(_0x26d50a[_0x38213f(0x181)]?.[_0x38213f(0x19b)](_0x38213f(0x182)))throw new Error('MaxPara\x20server\x20error');else throw new Error(_0x38213f(0x1b6)+_0x26d50a[_0x38213f(0x181)]);}}}}[a69_0x33dbca(0x1bf)](_0x3b7595){const _0x5c54f0=a69_0x33dbca;console[_0x5c54f0(0x1af)](_0x5c54f0(0x1a3),_0x3b7595);const _0xdfa05d=_0x3b7595['token'];let _0x2ab3e9;switch(_0x3b7595[_0x5c54f0(0x18d)]){case _0x5c54f0(0x190):_0x2ab3e9=_0x5c54f0(0x1b3);break;case'DECLINED':_0x2ab3e9=_0x5c54f0(0x1b1);break;default:_0x2ab3e9='PENDING';break;}const _0x32cb0d={'method':_0x3b7595[_0x5c54f0(0x195)],'transactionId':_0x3b7595['id']['toString']()};return _0x3b7595[_0x5c54f0(0x181)]&&(_0x32cb0d['message']=_0x3b7595[_0x5c54f0(0x181)]),console['log']('üìä\x20MaxPara\x20webhook\x20processed:\x20'+_0xdfa05d+_0x5c54f0(0x193)+_0x2ab3e9),{'paymentId':_0xdfa05d,'status':_0x2ab3e9,'additionalInfo':_0x32cb0d};}['validateWebhookSignature'](_0x45c86a,_0x515d77){const _0x5f36ee=a69_0x33dbca;return!!(_0x45c86a['id']&&_0x45c86a[_0x5f36ee(0x1a9)]&&_0x45c86a[_0x5f36ee(0x18d)]&&_0x45c86a[_0x5f36ee(0x1ac)]==='DEPOSIT');}}function a69_0x5c67(){const _0x46e58f=['stringify','application/json','status','426015oGfyeG','logResponse','APPROVED','maxpara-responses.log','existsSync','\x20->\x20','401','method','235244InYKBX','fast','3TUNKAL','cwd','MaxPara\x20validation\x20error:\x20','includes','1407924BRdwoK','POST','HIDDEN','1875164dKrQst','customerName','success','1015792qLjrHK','üîÑ\x20Processing\x20MaxPara\x20webhook:','11DGznnm','Request\x20failed','HTTP\x20','baseUrl','error','token','400','15xYKFgO','type','Unknown\x20error','Failed\x20to\x20write\x20to\x20request\x20log\x20file:','log','45302436echzJC','FAILED','24iMrLqa','PAID','toISOString','default','MaxPara\x20API\x20error:\x20','‚ùå\x20MaxPara\x20API\x20error:','__importDefault','json','path','mkdirSync','config','logs','appendFileSync','processWebhook','MaxParaService','üì•\x20MaxPara\x20API\x20response:','join','catch','message','500','3511578sOgzCV','üì§\x20MaxPara\x20API\x20request:','callbackUrl','MaxPara\x20authentication\x20failed','160GMQVir','amount','/api/deposit','apiKey'];a69_0x5c67=function(){return _0x46e58f;};return a69_0x5c67();}exports[a69_0x33dbca(0x1c0)]=MaxParaService;