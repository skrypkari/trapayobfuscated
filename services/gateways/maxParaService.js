'use strict';const a58_0x34b339=a58_0x1dc7;(function(_0x3bd66b,_0x1e68f9){const _0x5d1c9b=a58_0x1dc7,_0x367e7d=_0x3bd66b();while(!![]){try{const _0x21662d=-parseInt(_0x5d1c9b(0x1e9))/0x1+-parseInt(_0x5d1c9b(0x1f3))/0x2*(-parseInt(_0x5d1c9b(0x1e1))/0x3)+-parseInt(_0x5d1c9b(0x1fd))/0x4+parseInt(_0x5d1c9b(0x1ef))/0x5*(-parseInt(_0x5d1c9b(0x1e6))/0x6)+parseInt(_0x5d1c9b(0x1fc))/0x7+-parseInt(_0x5d1c9b(0x1ee))/0x8+parseInt(_0x5d1c9b(0x1da))/0x9;if(_0x21662d===_0x1e68f9)break;else _0x367e7d['push'](_0x367e7d['shift']());}catch(_0x5baf32){_0x367e7d['push'](_0x367e7d['shift']());}}}(a58_0x5f23,0xb1538));var __importDefault=this&&this[a58_0x34b339(0x213)]||function(_0x1537ea){const _0x19e05a=a58_0x34b339;return _0x1537ea&&_0x1537ea[_0x19e05a(0x1ff)]?_0x1537ea:{'default':_0x1537ea};};function a58_0x1dc7(_0x4aca13,_0x876cd9){_0x4aca13=_0x4aca13-0x1c8;const _0x5f23db=a58_0x5f23();let _0x1dc7eb=_0x5f23db[_0x4aca13];return _0x1dc7eb;}Object[a58_0x34b339(0x1ed)](exports,a58_0x34b339(0x1ff),{'value':!![]}),exports[a58_0x34b339(0x1d6)]=void 0x0;function a58_0x5f23(){const _0x358501=['error','201RNzucB','cwd','json','toISOString','includes','3159342ZuYJKw','amount','orderId','1090140DsaZmb','MaxPara\x20API\x20error:\x20','path','message','defineProperty','10348080qIDmXT','10vQndKJ','ðŸ“¤\x20MaxPara\x20API\x20request:','APPROVED','maxpara-responses.log','7660WdGQMd','/api/deposit','logRequest','MaxPara\x20server\x20error','400','fast','401','customerName','FAILED','213500lgTPNS','5445616UfDjSs','expire_date','__esModule','DEPOSIT','stringify','POST','application/json','status','logResponse','toString','createDeposit','ðŸ“¥\x20MaxPara\x20API\x20response:','MaxPara\x20validation\x20error:\x20','catch','default','link','500','ðŸ“Š\x20MaxPara\x20webhook\x20processed:\x20','\x20->\x20','ðŸ”„\x20Processing\x20MaxPara\x20webhook:','PAID','currency','__importDefault','log','âŒ\x20MaxPara\x20API\x20error:','paymentId','code','maxpara-requests.log','validateWebhookSignature','existsSync','Unknown\x20error','type','join','token','ðŸ¦\x20Creating\x20MaxPara\x20deposit\x20for\x20','logs','Request\x20failed','MaxParaService','apiKey','HIDDEN','method','47136474uHVFOp','baseUrl','TrapayUK/1.0','mkdirSync','config','MaxPara\x20authentication\x20failed'];a58_0x5f23=function(){return _0x358501;};return a58_0x5f23();}const fs_1=__importDefault(require('fs')),path_1=__importDefault(require(a58_0x34b339(0x1eb)));class MaxParaService{constructor(_0x462e16){const _0x577d58=a58_0x34b339;this[_0x577d58(0x1de)]=_0x462e16;}[a58_0x34b339(0x1f5)](_0x3fe4f9,_0x4a93c2){const _0x459a2c=a58_0x34b339,_0xc917c5=path_1[_0x459a2c(0x20b)][_0x459a2c(0x1d1)](process['cwd'](),_0x459a2c(0x1d4)),_0x2bd279=path_1[_0x459a2c(0x20b)][_0x459a2c(0x1d1)](_0xc917c5,_0x459a2c(0x1cc));!fs_1[_0x459a2c(0x20b)][_0x459a2c(0x1ce)](_0xc917c5)&&fs_1[_0x459a2c(0x20b)][_0x459a2c(0x1dd)](_0xc917c5,{'recursive':!![]});const _0x2bc182=new Date()[_0x459a2c(0x1e4)](),_0x39f812='['+_0x2bc182+']\x20'+_0x3fe4f9+':\x20'+JSON['stringify'](_0x4a93c2)+'\x0a';try{fs_1[_0x459a2c(0x20b)]['appendFileSync'](_0x2bd279,_0x39f812);}catch(_0x44fb6a){console[_0x459a2c(0x1e0)]('Failed\x20to\x20write\x20to\x20request\x20log\x20file:',_0x44fb6a);}}[a58_0x34b339(0x205)](_0x1ce0e7,_0x36c926){const _0x2d230e=a58_0x34b339,_0x45ec20=path_1[_0x2d230e(0x20b)][_0x2d230e(0x1d1)](process[_0x2d230e(0x1e2)](),'logs'),_0x5e9997=path_1[_0x2d230e(0x20b)][_0x2d230e(0x1d1)](_0x45ec20,_0x2d230e(0x1f2));!fs_1[_0x2d230e(0x20b)][_0x2d230e(0x1ce)](_0x45ec20)&&fs_1[_0x2d230e(0x20b)][_0x2d230e(0x1dd)](_0x45ec20,{'recursive':!![]});const _0x427a8b=new Date()[_0x2d230e(0x1e4)](),_0x317fcb='['+_0x427a8b+']\x20'+_0x1ce0e7+':\x20'+JSON[_0x2d230e(0x201)](_0x36c926)+'\x0a';try{fs_1[_0x2d230e(0x20b)]['appendFileSync'](_0x5e9997,_0x317fcb);}catch(_0x3a6e72){console[_0x2d230e(0x1e0)]('Failed\x20to\x20write\x20to\x20response\x20log\x20file:',_0x3a6e72);}}async[a58_0x34b339(0x207)](_0x4b2000){const _0x554c83=a58_0x34b339;console[_0x554c83(0x1c8)](_0x554c83(0x1d3)+_0x4b2000['amount']+'\x20'+_0x4b2000[_0x554c83(0x212)]);try{const _0x238438={'key':this['config'][_0x554c83(0x1d7)],'username':_0x4b2000[_0x554c83(0x1fa)],'user_id':_0x4b2000[_0x554c83(0x1ca)],'token':_0x4b2000[_0x554c83(0x1e8)],'method':_0x554c83(0x1f8),'amount':_0x4b2000[_0x554c83(0x1e7)],'callbackUrl':_0x4b2000['callbackUrl']};this[_0x554c83(0x1f5)](_0x554c83(0x1f4),{..._0x238438,'key':'HIDDEN'}),console['log'](_0x554c83(0x1f0),{..._0x238438,'key':_0x554c83(0x1d8)});const _0x4ece89=await fetch(this[_0x554c83(0x1de)][_0x554c83(0x1db)]+_0x554c83(0x1f4),{'method':_0x554c83(0x202),'headers':{'Content-Type':_0x554c83(0x203),'User-Agent':_0x554c83(0x1dc)},'body':JSON[_0x554c83(0x201)](_0x238438)});if(!_0x4ece89['ok']){const _0x21c579=await _0x4ece89[_0x554c83(0x1e3)]()[_0x554c83(0x20a)](()=>({}));throw new Error('HTTP\x20'+_0x4ece89['status']+':\x20'+(_0x21c579[_0x554c83(0x1ec)]||_0x554c83(0x1d5)));}const _0xc542d8=await _0x4ece89[_0x554c83(0x1e3)]();this['logResponse']('/api/deposit',_0xc542d8),console[_0x554c83(0x1c8)](_0x554c83(0x208),_0xc542d8);if(_0xc542d8[_0x554c83(0x1cb)]!==0xc8||_0xc542d8['status']!=='success')throw new Error(_0x554c83(0x1ea)+(_0xc542d8[_0x554c83(0x1ec)]||_0x554c83(0x1cf)));return{'gateway_payment_id':_0xc542d8[_0x554c83(0x1d2)],'payment_url':_0xc542d8[_0x554c83(0x20c)],'expires_at':_0xc542d8[_0x554c83(0x1fe)]};}catch(_0x2b1231){console[_0x554c83(0x1e0)](_0x554c83(0x1c9),_0x2b1231['message']);if(_0x2b1231['message']?.['includes'](_0x554c83(0x1f7)))throw new Error(_0x554c83(0x209)+_0x2b1231['message']);else{if(_0x2b1231[_0x554c83(0x1ec)]?.['includes'](_0x554c83(0x1f9)))throw new Error(_0x554c83(0x1df));else{if(_0x2b1231[_0x554c83(0x1ec)]?.[_0x554c83(0x1e5)](_0x554c83(0x20d)))throw new Error(_0x554c83(0x1f6));else throw new Error('MaxPara\x20API\x20error:\x20'+_0x2b1231[_0x554c83(0x1ec)]);}}}}['processWebhook'](_0x16113a){const _0x362be7=a58_0x34b339;console[_0x362be7(0x1c8)](_0x362be7(0x210),_0x16113a);const _0x493d8f=_0x16113a[_0x362be7(0x1d2)];let _0x3c3704;switch(_0x16113a[_0x362be7(0x204)]){case _0x362be7(0x1f1):_0x3c3704=_0x362be7(0x211);break;case'DECLINED':_0x3c3704=_0x362be7(0x1fb);break;default:_0x3c3704='PENDING';break;}const _0x1967e2={'method':_0x16113a[_0x362be7(0x1d9)],'transactionId':_0x16113a['id'][_0x362be7(0x206)]()};return _0x16113a['message']&&(_0x1967e2['message']=_0x16113a[_0x362be7(0x1ec)]),console[_0x362be7(0x1c8)](_0x362be7(0x20e)+_0x493d8f+_0x362be7(0x20f)+_0x3c3704),{'paymentId':_0x493d8f,'status':_0x3c3704,'additionalInfo':_0x1967e2};}[a58_0x34b339(0x1cd)](_0x2d4f77,_0x4e6d46){const _0x50192e=a58_0x34b339;return!!(_0x2d4f77['id']&&_0x2d4f77[_0x50192e(0x1d2)]&&_0x2d4f77[_0x50192e(0x204)]&&_0x2d4f77[_0x50192e(0x1d0)]===_0x50192e(0x200));}}exports['MaxParaService']=MaxParaService;