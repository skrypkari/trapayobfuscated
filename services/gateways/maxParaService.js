'use strict';const a69_0x16e29c=a69_0x1601;function a69_0x112c(){const _0xfa1811=['cwd','status','ðŸ“Š\x20MaxPara\x20webhook\x20processed:\x20','success','code','token','14377848vFypTM','__esModule','MaxPara\x20server\x20error','TrapayUK/1.0','existsSync','maxpara-requests.log','currency','3496540dykKaI','HIDDEN','ðŸ“¤\x20MaxPara\x20API\x20request:','3592jblQEs','customerName','644MDNjtV','paymentId','expire_date','PAID','mkdirSync','processWebhook','json','âŒ\x20MaxPara\x20API\x20error:','baseUrl','DEPOSIT','/api/deposit','MaxParaService','5946yAWBRG','MaxPara\x20authentication\x20failed','Request\x20failed','7VhfUWt','5262957YqjHgS','1573784TQBCeP','DECLINED','401','stringify','232feFnsa','application/json','1083678vncQWx','POST','orderId','link','11PHtyhT','400','fast','default','MaxPara\x20API\x20error:\x20','message','MaxPara\x20validation\x20error:\x20','logs','callbackUrl','join','maxpara-responses.log','createDeposit','includes','FAILED','method','10FMMIPT','appendFileSync','amount','PENDING','log','ðŸ”„\x20Processing\x20MaxPara\x20webhook:','logResponse','logRequest','path','config','catch','type','Failed\x20to\x20write\x20to\x20request\x20log\x20file:','error'];a69_0x112c=function(){return _0xfa1811;};return a69_0x112c();}(function(_0x1f56d3,_0x1bdd24){const _0x7ff02c=a69_0x1601,_0x1d1db3=_0x1f56d3();while(!![]){try{const _0xb7333e=-parseInt(_0x7ff02c(0x18c))/0x1*(-parseInt(_0x7ff02c(0x175))/0x2)+parseInt(_0x7ff02c(0x183))/0x3*(parseInt(_0x7ff02c(0x177))/0x4)+-parseInt(_0x7ff02c(0x157))/0x5*(-parseInt(_0x7ff02c(0x18e))/0x6)+parseInt(_0x7ff02c(0x186))/0x7*(parseInt(_0x7ff02c(0x188))/0x8)+parseInt(_0x7ff02c(0x187))/0x9+-parseInt(_0x7ff02c(0x172))/0xa+-parseInt(_0x7ff02c(0x148))/0xb*(parseInt(_0x7ff02c(0x16b))/0xc);if(_0xb7333e===_0x1bdd24)break;else _0x1d1db3['push'](_0x1d1db3['shift']());}catch(_0x4ad7a7){_0x1d1db3['push'](_0x1d1db3['shift']());}}}(a69_0x112c,0x50bc0));function a69_0x1601(_0x110d6a,_0x564eac){_0x110d6a=_0x110d6a-0x147;const _0x112cf2=a69_0x112c();let _0x1601a8=_0x112cf2[_0x110d6a];return _0x1601a8;}var __importDefault=this&&this['__importDefault']||function(_0x1be697){const _0x5c8b26=a69_0x1601;return _0x1be697&&_0x1be697[_0x5c8b26(0x16c)]?_0x1be697:{'default':_0x1be697};};Object['defineProperty'](exports,a69_0x16e29c(0x16c),{'value':!![]}),exports['MaxParaService']=void 0x0;const fs_1=__importDefault(require('fs')),path_1=__importDefault(require(a69_0x16e29c(0x15f)));class MaxParaService{constructor(_0x1beac0){const _0x2b6797=a69_0x16e29c;this[_0x2b6797(0x160)]=_0x1beac0;}['logRequest'](_0x20d70e,_0x1af516){const _0x146314=a69_0x16e29c,_0x4eccb5=path_1[_0x146314(0x14b)][_0x146314(0x151)](process[_0x146314(0x165)](),_0x146314(0x14f)),_0x20df15=path_1[_0x146314(0x14b)][_0x146314(0x151)](_0x4eccb5,_0x146314(0x170));!fs_1[_0x146314(0x14b)][_0x146314(0x16f)](_0x4eccb5)&&fs_1['default'][_0x146314(0x17b)](_0x4eccb5,{'recursive':!![]});const _0xbba8c2=new Date()['toISOString'](),_0x3549e7='['+_0xbba8c2+']\x20'+_0x20d70e+':\x20'+JSON['stringify'](_0x1af516)+'\x0a';try{fs_1[_0x146314(0x14b)][_0x146314(0x158)](_0x20df15,_0x3549e7);}catch(_0x6ff269){console[_0x146314(0x164)](_0x146314(0x163),_0x6ff269);}}[a69_0x16e29c(0x15d)](_0x47f32d,_0xc31188){const _0x3ef83a=a69_0x16e29c,_0x535e59=path_1['default'][_0x3ef83a(0x151)](process[_0x3ef83a(0x165)](),_0x3ef83a(0x14f)),_0x2cdf1d=path_1['default'][_0x3ef83a(0x151)](_0x535e59,_0x3ef83a(0x152));!fs_1[_0x3ef83a(0x14b)][_0x3ef83a(0x16f)](_0x535e59)&&fs_1[_0x3ef83a(0x14b)]['mkdirSync'](_0x535e59,{'recursive':!![]});const _0x2bb672=new Date()['toISOString'](),_0xb1a955='['+_0x2bb672+']\x20'+_0x47f32d+':\x20'+JSON[_0x3ef83a(0x18b)](_0xc31188)+'\x0a';try{fs_1[_0x3ef83a(0x14b)][_0x3ef83a(0x158)](_0x2cdf1d,_0xb1a955);}catch(_0x535e2d){console[_0x3ef83a(0x164)]('Failed\x20to\x20write\x20to\x20response\x20log\x20file:',_0x535e2d);}}async[a69_0x16e29c(0x153)](_0x3cc0f2){const _0x5d02e4=a69_0x16e29c;console[_0x5d02e4(0x15b)]('ðŸ¦\x20Creating\x20MaxPara\x20deposit\x20for\x20'+_0x3cc0f2[_0x5d02e4(0x159)]+'\x20'+_0x3cc0f2[_0x5d02e4(0x171)]);try{const _0x330ed3={'key':this['config']['apiKey'],'username':_0x3cc0f2[_0x5d02e4(0x176)],'user_id':_0x3cc0f2[_0x5d02e4(0x178)],'token':_0x3cc0f2[_0x5d02e4(0x190)],'method':_0x5d02e4(0x14a),'amount':_0x3cc0f2['amount'],'callbackUrl':_0x3cc0f2[_0x5d02e4(0x150)]};this[_0x5d02e4(0x15e)](_0x5d02e4(0x181),{..._0x330ed3,'key':_0x5d02e4(0x173)}),console[_0x5d02e4(0x15b)](_0x5d02e4(0x174),{..._0x330ed3,'key':_0x5d02e4(0x173)});const _0x90cecb=await fetch(this[_0x5d02e4(0x160)][_0x5d02e4(0x17f)]+_0x5d02e4(0x181),{'method':_0x5d02e4(0x18f),'headers':{'Content-Type':_0x5d02e4(0x18d),'User-Agent':_0x5d02e4(0x16e)},'body':JSON[_0x5d02e4(0x18b)](_0x330ed3)});if(!_0x90cecb['ok']){const _0x228a73=await _0x90cecb[_0x5d02e4(0x17d)]()[_0x5d02e4(0x161)](()=>({}));throw new Error('HTTP\x20'+_0x90cecb[_0x5d02e4(0x166)]+':\x20'+(_0x228a73[_0x5d02e4(0x14d)]||_0x5d02e4(0x185)));}const _0x351da0=await _0x90cecb[_0x5d02e4(0x17d)]();this[_0x5d02e4(0x15d)]('/api/deposit',_0x351da0),console[_0x5d02e4(0x15b)]('ðŸ“¥\x20MaxPara\x20API\x20response:',_0x351da0);if(_0x351da0[_0x5d02e4(0x169)]!==0xc8||_0x351da0[_0x5d02e4(0x166)]!==_0x5d02e4(0x168))throw new Error(_0x5d02e4(0x14c)+(_0x351da0[_0x5d02e4(0x14d)]||'Unknown\x20error'));return{'gateway_payment_id':_0x351da0[_0x5d02e4(0x16a)],'payment_url':_0x351da0[_0x5d02e4(0x147)],'expires_at':_0x351da0[_0x5d02e4(0x179)]};}catch(_0x2ca1f2){console[_0x5d02e4(0x164)](_0x5d02e4(0x17e),_0x2ca1f2[_0x5d02e4(0x14d)]);if(_0x2ca1f2[_0x5d02e4(0x14d)]?.['includes'](_0x5d02e4(0x149)))throw new Error(_0x5d02e4(0x14e)+_0x2ca1f2[_0x5d02e4(0x14d)]);else{if(_0x2ca1f2[_0x5d02e4(0x14d)]?.[_0x5d02e4(0x154)](_0x5d02e4(0x18a)))throw new Error(_0x5d02e4(0x184));else{if(_0x2ca1f2[_0x5d02e4(0x14d)]?.[_0x5d02e4(0x154)]('500'))throw new Error(_0x5d02e4(0x16d));else throw new Error(_0x5d02e4(0x14c)+_0x2ca1f2[_0x5d02e4(0x14d)]);}}}}[a69_0x16e29c(0x17c)](_0x443974){const _0x1291d3=a69_0x16e29c;console[_0x1291d3(0x15b)](_0x1291d3(0x15c),_0x443974);const _0x3e746c=_0x443974[_0x1291d3(0x16a)];let _0x640df5;switch(_0x443974['status']){case'APPROVED':_0x640df5=_0x1291d3(0x17a);break;case _0x1291d3(0x189):_0x640df5=_0x1291d3(0x155);break;default:_0x640df5=_0x1291d3(0x15a);break;}const _0x4d7dc1={'method':_0x443974[_0x1291d3(0x156)],'transactionId':_0x443974['id']['toString']()};return _0x443974[_0x1291d3(0x14d)]&&(_0x4d7dc1[_0x1291d3(0x14d)]=_0x443974['message']),console[_0x1291d3(0x15b)](_0x1291d3(0x167)+_0x3e746c+'\x20->\x20'+_0x640df5),{'paymentId':_0x3e746c,'status':_0x640df5,'additionalInfo':_0x4d7dc1};}['validateWebhookSignature'](_0x48000d,_0x5d089a){const _0x4f7bb7=a69_0x16e29c;return!!(_0x48000d['id']&&_0x48000d[_0x4f7bb7(0x16a)]&&_0x48000d[_0x4f7bb7(0x166)]&&_0x48000d[_0x4f7bb7(0x162)]===_0x4f7bb7(0x180));}}exports[a69_0x16e29c(0x182)]=MaxParaService;