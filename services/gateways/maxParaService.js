'use strict';function a61_0x5f43(){const _0x38f66b=['HTTP\x20','logResponse','mkdirSync','354ptdWjc','5774HipWrG','Failed\x20to\x20write\x20to\x20response\x20log\x20file:','toISOString','maxpara-requests.log','logs','MaxPara\x20authentication\x20failed','DEPOSIT','apiKey','HIDDEN','MaxParaService','MaxPara\x20server\x20error','success','1362qcnUbO','link','customerName','8dJaqAT','DECLINED','existsSync','FAILED','POST','appendFileSync','config','amount','catch','PENDING','cwd','10372977xpxGOn','/api/deposit','500','json','callbackUrl','ðŸ“¤\x20MaxPara\x20API\x20request:','401','type','default','maxpara-responses.log','join','baseUrl','message','stringify','Request\x20failed','381958kxbKLx','logRequest','ðŸ¦\x20Creating\x20MaxPara\x20deposit\x20for\x20','6113821jreqtv','__esModule','error','22745100dUsGBU','status','createDeposit','ðŸ“¥\x20MaxPara\x20API\x20response:','includes','token','ðŸ”„\x20Processing\x20MaxPara\x20webhook:','log','path','400','19685SZMqDV','2901340LnBERZ','method','expire_date','validateWebhookSignature','MaxPara\x20API\x20error:\x20','processWebhook','Unknown\x20error'];a61_0x5f43=function(){return _0x38f66b;};return a61_0x5f43();}const a61_0x1fc416=a61_0x2265;(function(_0x30e650,_0x2ff310){const _0x2beff1=a61_0x2265,_0x5b677b=_0x30e650();while(!![]){try{const _0x210d85=-parseInt(_0x2beff1(0x1a1))/0x1+-parseInt(_0x2beff1(0x178))/0x2*(-parseInt(_0x2beff1(0x184))/0x3)+-parseInt(_0x2beff1(0x16d))/0x4+parseInt(_0x2beff1(0x16c))/0x5*(parseInt(_0x2beff1(0x177))/0x6)+-parseInt(_0x2beff1(0x1a4))/0x7+-parseInt(_0x2beff1(0x187))/0x8*(parseInt(_0x2beff1(0x192))/0x9)+parseInt(_0x2beff1(0x1a7))/0xa;if(_0x210d85===_0x2ff310)break;else _0x5b677b['push'](_0x5b677b['shift']());}catch(_0x4d27f3){_0x5b677b['push'](_0x5b677b['shift']());}}}(a61_0x5f43,0xa70d2));var __importDefault=this&&this['__importDefault']||function(_0xb93b70){const _0x96108e=a61_0x2265;return _0xb93b70&&_0xb93b70[_0x96108e(0x1a5)]?_0xb93b70:{'default':_0xb93b70};};function a61_0x2265(_0x2c7f46,_0x131287){_0x2c7f46=_0x2c7f46-0x169;const _0x5f43c4=a61_0x5f43();let _0x226533=_0x5f43c4[_0x2c7f46];return _0x226533;}Object['defineProperty'](exports,'__esModule',{'value':!![]}),exports['MaxParaService']=void 0x0;const fs_1=__importDefault(require('fs')),path_1=__importDefault(require(a61_0x1fc416(0x16a)));class MaxParaService{constructor(_0x36a4a8){const _0x8e7112=a61_0x1fc416;this[_0x8e7112(0x18d)]=_0x36a4a8;}[a61_0x1fc416(0x1a2)](_0x1e9900,_0x39e232){const _0x3a7bed=a61_0x1fc416,_0x49b738=path_1['default'][_0x3a7bed(0x19c)](process[_0x3a7bed(0x191)](),_0x3a7bed(0x17c)),_0x523878=path_1[_0x3a7bed(0x19a)][_0x3a7bed(0x19c)](_0x49b738,_0x3a7bed(0x17b));!fs_1[_0x3a7bed(0x19a)][_0x3a7bed(0x189)](_0x49b738)&&fs_1[_0x3a7bed(0x19a)][_0x3a7bed(0x176)](_0x49b738,{'recursive':!![]});const _0x247702=new Date()[_0x3a7bed(0x17a)](),_0x546db3='['+_0x247702+']\x20'+_0x1e9900+':\x20'+JSON[_0x3a7bed(0x19f)](_0x39e232)+'\x0a';try{fs_1['default']['appendFileSync'](_0x523878,_0x546db3);}catch(_0x3136a){console[_0x3a7bed(0x1a6)]('Failed\x20to\x20write\x20to\x20request\x20log\x20file:',_0x3136a);}}[a61_0x1fc416(0x175)](_0xdda213,_0x4a1a91){const _0x4c697d=a61_0x1fc416,_0x782ad9=path_1[_0x4c697d(0x19a)][_0x4c697d(0x19c)](process[_0x4c697d(0x191)](),_0x4c697d(0x17c)),_0x122876=path_1[_0x4c697d(0x19a)][_0x4c697d(0x19c)](_0x782ad9,_0x4c697d(0x19b));!fs_1[_0x4c697d(0x19a)]['existsSync'](_0x782ad9)&&fs_1[_0x4c697d(0x19a)][_0x4c697d(0x176)](_0x782ad9,{'recursive':!![]});const _0x254421=new Date()[_0x4c697d(0x17a)](),_0x23aa00='['+_0x254421+']\x20'+_0xdda213+':\x20'+JSON[_0x4c697d(0x19f)](_0x4a1a91)+'\x0a';try{fs_1['default'][_0x4c697d(0x18c)](_0x122876,_0x23aa00);}catch(_0x14a41a){console[_0x4c697d(0x1a6)](_0x4c697d(0x179),_0x14a41a);}}async[a61_0x1fc416(0x1a9)](_0xc08d8e){const _0x398224=a61_0x1fc416;console[_0x398224(0x169)](_0x398224(0x1a3)+_0xc08d8e[_0x398224(0x18e)]+'\x20'+_0xc08d8e['currency']);try{const _0x14d551={'key':this['config'][_0x398224(0x17f)],'username':_0xc08d8e[_0x398224(0x186)],'user_id':_0xc08d8e['paymentId'],'token':_0xc08d8e['orderId'],'method':'fast','amount':_0xc08d8e[_0x398224(0x18e)],'callbackUrl':_0xc08d8e[_0x398224(0x196)]};this['logRequest'](_0x398224(0x193),{..._0x14d551,'key':_0x398224(0x180)}),console[_0x398224(0x169)](_0x398224(0x197),{..._0x14d551,'key':'HIDDEN'});const _0x586b01=await fetch(this[_0x398224(0x18d)][_0x398224(0x19d)]+_0x398224(0x193),{'method':_0x398224(0x18b),'headers':{'Content-Type':'application/json','User-Agent':'TrapayUK/1.0'},'body':JSON[_0x398224(0x19f)](_0x14d551)});if(!_0x586b01['ok']){const _0x3142b6=await _0x586b01[_0x398224(0x195)]()[_0x398224(0x18f)](()=>({}));throw new Error(_0x398224(0x174)+_0x586b01[_0x398224(0x1a8)]+':\x20'+(_0x3142b6['message']||_0x398224(0x1a0)));}const _0x385a05=await _0x586b01['json']();this[_0x398224(0x175)](_0x398224(0x193),_0x385a05),console[_0x398224(0x169)](_0x398224(0x1aa),_0x385a05);if(_0x385a05['code']!==0xc8||_0x385a05['status']!==_0x398224(0x183))throw new Error(_0x398224(0x171)+(_0x385a05[_0x398224(0x19e)]||_0x398224(0x173)));return{'gateway_payment_id':_0x385a05[_0x398224(0x1ac)],'payment_url':_0x385a05[_0x398224(0x185)],'expires_at':_0x385a05[_0x398224(0x16f)]};}catch(_0x56ea0d){console[_0x398224(0x1a6)]('âŒ\x20MaxPara\x20API\x20error:',_0x56ea0d[_0x398224(0x19e)]);if(_0x56ea0d[_0x398224(0x19e)]?.['includes'](_0x398224(0x16b)))throw new Error('MaxPara\x20validation\x20error:\x20'+_0x56ea0d[_0x398224(0x19e)]);else{if(_0x56ea0d[_0x398224(0x19e)]?.['includes'](_0x398224(0x198)))throw new Error(_0x398224(0x17d));else{if(_0x56ea0d[_0x398224(0x19e)]?.[_0x398224(0x1ab)](_0x398224(0x194)))throw new Error(_0x398224(0x182));else throw new Error('MaxPara\x20API\x20error:\x20'+_0x56ea0d['message']);}}}}[a61_0x1fc416(0x172)](_0x1d1042){const _0x16903b=a61_0x1fc416;console[_0x16903b(0x169)](_0x16903b(0x1ad),_0x1d1042);const _0x290c98=_0x1d1042[_0x16903b(0x1ac)];let _0x2fef20;switch(_0x1d1042['status']){case'APPROVED':_0x2fef20='PAID';break;case _0x16903b(0x188):_0x2fef20=_0x16903b(0x18a);break;default:_0x2fef20=_0x16903b(0x190);break;}const _0x1cfd4b={'method':_0x1d1042[_0x16903b(0x16e)],'transactionId':_0x1d1042['id']['toString']()};return _0x1d1042['message']&&(_0x1cfd4b[_0x16903b(0x19e)]=_0x1d1042[_0x16903b(0x19e)]),console['log']('ðŸ“Š\x20MaxPara\x20webhook\x20processed:\x20'+_0x290c98+'\x20->\x20'+_0x2fef20),{'paymentId':_0x290c98,'status':_0x2fef20,'additionalInfo':_0x1cfd4b};}[a61_0x1fc416(0x170)](_0x57f1fe,_0x38c980){const _0x3e441f=a61_0x1fc416;return!!(_0x57f1fe['id']&&_0x57f1fe[_0x3e441f(0x1ac)]&&_0x57f1fe[_0x3e441f(0x1a8)]&&_0x57f1fe[_0x3e441f(0x199)]===_0x3e441f(0x17e));}}exports[a61_0x1fc416(0x181)]=MaxParaService;