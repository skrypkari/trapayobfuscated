'use strict';const a69_0x4e21b4=a69_0x5cdb;function a69_0x5985(){const _0x2bf722=['8hONbDF','existsSync','930645vlKfLx','Request\x20failed','FAILED','HIDDEN','includes','expire_date','message','\x20->\x20','defineProperty','default','validateWebhookSignature','error','cwd','500','catch','customerName','Failed\x20to\x20write\x20to\x20response\x20log\x20file:','MaxPara\x20authentication\x20failed','maxpara-responses.log','/api/deposit','appendFileSync','HTTP\x20','67156xDkjZt','9293482OJxEiU','APPROVED','path','ðŸ“¤\x20MaxPara\x20API\x20request:','code','join','__esModule','token','success','ðŸ¦\x20Creating\x20MaxPara\x20deposit\x20for\x20','1197203NEvCFB','json','stringify','Failed\x20to\x20write\x20to\x20request\x20log\x20file:','369886VvkDSC','MaxParaService','40849jqMgoa','logRequest','15NyCzQd','createDeposit','POST','MaxPara\x20API\x20error:\x20','status','baseUrl','195972aTKZmK','logs','DEPOSIT','paymentId','link','39Kabcsw','maxpara-requests.log','toISOString','type','âŒ\x20MaxPara\x20API\x20error:','__importDefault','ðŸ“Š\x20MaxPara\x20webhook\x20processed:\x20','PAID','currency','amount','apiKey','config','10OThrEo','log','401','logResponse','MaxPara\x20validation\x20error:\x20'];a69_0x5985=function(){return _0x2bf722;};return a69_0x5985();}function a69_0x5cdb(_0x293180,_0x3bbfbe){_0x293180=_0x293180-0xd7;const _0x5985bb=a69_0x5985();let _0x5cdba5=_0x5985bb[_0x293180];return _0x5cdba5;}(function(_0x15b888,_0x3bc131){const _0x484905=a69_0x5cdb,_0x374918=_0x15b888();while(!![]){try{const _0x2cfc75=parseInt(_0x484905(0xe2))/0x1+-parseInt(_0x484905(0xe0))/0x2+parseInt(_0x484905(0xef))/0x3*(-parseInt(_0x484905(0x118))/0x4)+-parseInt(_0x484905(0xe4))/0x5*(parseInt(_0x484905(0xea))/0x6)+parseInt(_0x484905(0xdc))/0x7*(-parseInt(_0x484905(0x100))/0x8)+-parseInt(_0x484905(0x102))/0x9+-parseInt(_0x484905(0xfb))/0xa*(-parseInt(_0x484905(0x119))/0xb);if(_0x2cfc75===_0x3bc131)break;else _0x374918['push'](_0x374918['shift']());}catch(_0x364a2e){_0x374918['push'](_0x374918['shift']());}}}(a69_0x5985,0x1ae0b));var __importDefault=this&&this[a69_0x4e21b4(0xf4)]||function(_0x4a02a8){const _0x5f10e0=a69_0x4e21b4;return _0x4a02a8&&_0x4a02a8[_0x5f10e0(0xd8)]?_0x4a02a8:{'default':_0x4a02a8};};Object[a69_0x4e21b4(0x10a)](exports,a69_0x4e21b4(0xd8),{'value':!![]}),exports[a69_0x4e21b4(0xe1)]=void 0x0;const fs_1=__importDefault(require('fs')),path_1=__importDefault(require(a69_0x4e21b4(0x11b)));class MaxParaService{constructor(_0x92497c){const _0x2b5d68=a69_0x4e21b4;this[_0x2b5d68(0xfa)]=_0x92497c;}[a69_0x4e21b4(0xe3)](_0x1ffc78,_0x4a88db){const _0x5b4aa3=a69_0x4e21b4,_0x4c75fb=path_1[_0x5b4aa3(0x10b)]['join'](process[_0x5b4aa3(0x10e)](),'logs'),_0x383d67=path_1[_0x5b4aa3(0x10b)][_0x5b4aa3(0xd7)](_0x4c75fb,_0x5b4aa3(0xf0));!fs_1[_0x5b4aa3(0x10b)][_0x5b4aa3(0x101)](_0x4c75fb)&&fs_1[_0x5b4aa3(0x10b)]['mkdirSync'](_0x4c75fb,{'recursive':!![]});const _0x834d58=new Date()[_0x5b4aa3(0xf1)](),_0x2a8f98='['+_0x834d58+']\x20'+_0x1ffc78+':\x20'+JSON[_0x5b4aa3(0xde)](_0x4a88db)+'\x0a';try{fs_1[_0x5b4aa3(0x10b)][_0x5b4aa3(0x116)](_0x383d67,_0x2a8f98);}catch(_0x870a6c){console[_0x5b4aa3(0x10d)](_0x5b4aa3(0xdf),_0x870a6c);}}[a69_0x4e21b4(0xfe)](_0x793116,_0x2e204c){const _0x5cb925=a69_0x4e21b4,_0x2614b2=path_1[_0x5cb925(0x10b)][_0x5cb925(0xd7)](process[_0x5cb925(0x10e)](),_0x5cb925(0xeb)),_0x444afd=path_1[_0x5cb925(0x10b)][_0x5cb925(0xd7)](_0x2614b2,_0x5cb925(0x114));!fs_1[_0x5cb925(0x10b)][_0x5cb925(0x101)](_0x2614b2)&&fs_1[_0x5cb925(0x10b)]['mkdirSync'](_0x2614b2,{'recursive':!![]});const _0x374bde=new Date()[_0x5cb925(0xf1)](),_0x1e7b38='['+_0x374bde+']\x20'+_0x793116+':\x20'+JSON[_0x5cb925(0xde)](_0x2e204c)+'\x0a';try{fs_1[_0x5cb925(0x10b)][_0x5cb925(0x116)](_0x444afd,_0x1e7b38);}catch(_0xa24b05){console[_0x5cb925(0x10d)](_0x5cb925(0x112),_0xa24b05);}}async[a69_0x4e21b4(0xe5)](_0x12e3c0){const _0x5e86cd=a69_0x4e21b4;console[_0x5e86cd(0xfc)](_0x5e86cd(0xdb)+_0x12e3c0[_0x5e86cd(0xf8)]+'\x20'+_0x12e3c0[_0x5e86cd(0xf7)]);try{const _0x1f9e28={'key':this['config'][_0x5e86cd(0xf9)],'username':_0x12e3c0[_0x5e86cd(0x111)],'user_id':_0x12e3c0[_0x5e86cd(0xed)],'token':_0x12e3c0['orderId'],'method':'fast','amount':_0x12e3c0[_0x5e86cd(0xf8)],'callbackUrl':_0x12e3c0['callbackUrl']};this[_0x5e86cd(0xe3)]('/api/deposit',{..._0x1f9e28,'key':_0x5e86cd(0x105)}),console[_0x5e86cd(0xfc)](_0x5e86cd(0x11c),{..._0x1f9e28,'key':_0x5e86cd(0x105)});const _0xc731d2=await fetch(this['config'][_0x5e86cd(0xe9)]+_0x5e86cd(0x115),{'method':_0x5e86cd(0xe6),'headers':{'Content-Type':'application/json','User-Agent':'TrapayUK/1.0'},'body':JSON[_0x5e86cd(0xde)](_0x1f9e28)});if(!_0xc731d2['ok']){const _0x555839=await _0xc731d2[_0x5e86cd(0xdd)]()[_0x5e86cd(0x110)](()=>({}));throw new Error(_0x5e86cd(0x117)+_0xc731d2[_0x5e86cd(0xe8)]+':\x20'+(_0x555839[_0x5e86cd(0x108)]||_0x5e86cd(0x103)));}const _0x79b710=await _0xc731d2['json']();this[_0x5e86cd(0xfe)]('/api/deposit',_0x79b710),console[_0x5e86cd(0xfc)]('ðŸ“¥\x20MaxPara\x20API\x20response:',_0x79b710);if(_0x79b710[_0x5e86cd(0x11d)]!==0xc8||_0x79b710[_0x5e86cd(0xe8)]!==_0x5e86cd(0xda))throw new Error('MaxPara\x20API\x20error:\x20'+(_0x79b710[_0x5e86cd(0x108)]||'Unknown\x20error'));return{'gateway_payment_id':_0x79b710[_0x5e86cd(0xd9)],'payment_url':_0x79b710[_0x5e86cd(0xee)],'expires_at':_0x79b710[_0x5e86cd(0x107)]};}catch(_0x446f99){console[_0x5e86cd(0x10d)](_0x5e86cd(0xf3),_0x446f99['message']);if(_0x446f99[_0x5e86cd(0x108)]?.[_0x5e86cd(0x106)]('400'))throw new Error(_0x5e86cd(0xff)+_0x446f99[_0x5e86cd(0x108)]);else{if(_0x446f99[_0x5e86cd(0x108)]?.[_0x5e86cd(0x106)](_0x5e86cd(0xfd)))throw new Error(_0x5e86cd(0x113));else{if(_0x446f99[_0x5e86cd(0x108)]?.[_0x5e86cd(0x106)](_0x5e86cd(0x10f)))throw new Error('MaxPara\x20server\x20error');else throw new Error(_0x5e86cd(0xe7)+_0x446f99['message']);}}}}['processWebhook'](_0x17d1a6){const _0x347b86=a69_0x4e21b4;console[_0x347b86(0xfc)]('ðŸ”„\x20Processing\x20MaxPara\x20webhook:',_0x17d1a6);const _0x821ba7=_0x17d1a6[_0x347b86(0xd9)];let _0x27309a;switch(_0x17d1a6[_0x347b86(0xe8)]){case _0x347b86(0x11a):_0x27309a=_0x347b86(0xf6);break;case'DECLINED':_0x27309a=_0x347b86(0x104);break;default:_0x27309a='PENDING';break;}const _0x326809={'method':_0x17d1a6['method'],'transactionId':_0x17d1a6['id']['toString']()};return _0x17d1a6[_0x347b86(0x108)]&&(_0x326809['message']=_0x17d1a6['message']),console[_0x347b86(0xfc)](_0x347b86(0xf5)+_0x821ba7+_0x347b86(0x109)+_0x27309a),{'paymentId':_0x821ba7,'status':_0x27309a,'additionalInfo':_0x326809};}[a69_0x4e21b4(0x10c)](_0x5e65fe,_0x1f194c){const _0x2744a3=a69_0x4e21b4;return!!(_0x5e65fe['id']&&_0x5e65fe[_0x2744a3(0xd9)]&&_0x5e65fe[_0x2744a3(0xe8)]&&_0x5e65fe[_0x2744a3(0xf2)]===_0x2744a3(0xec));}}exports[a69_0x4e21b4(0xe1)]=MaxParaService;