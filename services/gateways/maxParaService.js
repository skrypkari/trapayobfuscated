'use strict';const a63_0x168b3a=a63_0x2e5f;(function(_0x1b9fa4,_0x5bcfe8){const _0x1247d7=a63_0x2e5f,_0x4ae7e4=_0x1b9fa4();while(!![]){try{const _0x3181bf=parseInt(_0x1247d7(0x227))/0x1*(parseInt(_0x1247d7(0x219))/0x2)+-parseInt(_0x1247d7(0x1f1))/0x3*(parseInt(_0x1247d7(0x213))/0x4)+-parseInt(_0x1247d7(0x1ec))/0x5+-parseInt(_0x1247d7(0x218))/0x6+parseInt(_0x1247d7(0x217))/0x7+parseInt(_0x1247d7(0x1fd))/0x8*(parseInt(_0x1247d7(0x21e))/0x9)+parseInt(_0x1247d7(0x20e))/0xa;if(_0x3181bf===_0x5bcfe8)break;else _0x4ae7e4['push'](_0x4ae7e4['shift']());}catch(_0x3e6b8e){_0x4ae7e4['push'](_0x4ae7e4['shift']());}}}(a63_0x2774,0xef678));var __importDefault=this&&this[a63_0x168b3a(0x1f9)]||function(_0x451fe9){const _0x578ae3=a63_0x168b3a;return _0x451fe9&&_0x451fe9[_0x578ae3(0x224)]?_0x451fe9:{'default':_0x451fe9};};function a63_0x2e5f(_0x25d6c8,_0x594a35){_0x25d6c8=_0x25d6c8-0x1eb;const _0x2774d0=a63_0x2774();let _0x2e5f99=_0x2774d0[_0x25d6c8];return _0x2e5f99;}function a63_0x2774(){const _0x1bd0d1=['PENDING','config','ðŸ“¥\x20MaxPara\x20API\x20response:','maxpara-requests.log','code','method','FAILED','toString','success','logResponse','expire_date','POST','cwd','MaxPara\x20authentication\x20failed','apiKey','16798910wtpSyP','toISOString','message','APPROVED','type','1336keUaUK','appendFileSync','Request\x20failed','existsSync','3466281LlKBuJ','8229732yMWQfE','219964yvUCJV','paymentId','500','json','join','257166ciskgR','logRequest','stringify','application/json','maxpara-responses.log','logs','__esModule','createDeposit','/api/deposit','13aDkZNp','amount','catch','currency','PAID','baseUrl','ðŸ“¤\x20MaxPara\x20API\x20request:','DECLINED','mkdirSync','processWebhook','Failed\x20to\x20write\x20to\x20request\x20log\x20file:','MaxPara\x20validation\x20error:\x20','4571100UBvRIs','default','fast','log','MaxParaService','12279kDTyZD','token','defineProperty','HIDDEN','path','validateWebhookSignature','orderId','error','__importDefault','status','Failed\x20to\x20write\x20to\x20response\x20log\x20file:','includes','288jCVhPg','MaxPara\x20API\x20error:\x20'];a63_0x2774=function(){return _0x1bd0d1;};return a63_0x2774();}Object[a63_0x168b3a(0x1f3)](exports,a63_0x168b3a(0x224),{'value':!![]}),exports[a63_0x168b3a(0x1f0)]=void 0x0;const fs_1=__importDefault(require('fs')),path_1=__importDefault(require(a63_0x168b3a(0x1f5)));class MaxParaService{constructor(_0x5f4db9){const _0x5a840d=a63_0x168b3a;this[_0x5a840d(0x200)]=_0x5f4db9;}['logRequest'](_0x244911,_0x2af41f){const _0x1b3898=a63_0x168b3a,_0x4173e2=path_1[_0x1b3898(0x1ed)][_0x1b3898(0x21d)](process[_0x1b3898(0x20b)](),_0x1b3898(0x223)),_0x1ad03e=path_1[_0x1b3898(0x1ed)][_0x1b3898(0x21d)](_0x4173e2,_0x1b3898(0x202));!fs_1[_0x1b3898(0x1ed)][_0x1b3898(0x216)](_0x4173e2)&&fs_1[_0x1b3898(0x1ed)]['mkdirSync'](_0x4173e2,{'recursive':!![]});const _0x42d77f=new Date()['toISOString'](),_0x404230='['+_0x42d77f+']\x20'+_0x244911+':\x20'+JSON['stringify'](_0x2af41f)+'\x0a';try{fs_1[_0x1b3898(0x1ed)][_0x1b3898(0x214)](_0x1ad03e,_0x404230);}catch(_0x38a23e){console[_0x1b3898(0x1f8)](_0x1b3898(0x231),_0x38a23e);}}[a63_0x168b3a(0x208)](_0x575734,_0x172aa9){const _0x4951d9=a63_0x168b3a,_0x36f596=path_1[_0x4951d9(0x1ed)]['join'](process['cwd'](),'logs'),_0x3486b6=path_1[_0x4951d9(0x1ed)][_0x4951d9(0x21d)](_0x36f596,_0x4951d9(0x222));!fs_1['default']['existsSync'](_0x36f596)&&fs_1[_0x4951d9(0x1ed)][_0x4951d9(0x22f)](_0x36f596,{'recursive':!![]});const _0x266cc0=new Date()[_0x4951d9(0x20f)](),_0x341eeb='['+_0x266cc0+']\x20'+_0x575734+':\x20'+JSON[_0x4951d9(0x220)](_0x172aa9)+'\x0a';try{fs_1[_0x4951d9(0x1ed)][_0x4951d9(0x214)](_0x3486b6,_0x341eeb);}catch(_0x2757e0){console[_0x4951d9(0x1f8)](_0x4951d9(0x1fb),_0x2757e0);}}async[a63_0x168b3a(0x225)](_0x3f16c0){const _0x41b453=a63_0x168b3a;console[_0x41b453(0x1ef)]('ðŸ¦\x20Creating\x20MaxPara\x20deposit\x20for\x20'+_0x3f16c0[_0x41b453(0x228)]+'\x20'+_0x3f16c0[_0x41b453(0x22a)]);try{const _0x2eacac={'key':this[_0x41b453(0x200)][_0x41b453(0x20d)],'username':_0x3f16c0['customerName'],'user_id':_0x3f16c0[_0x41b453(0x21a)],'token':_0x3f16c0[_0x41b453(0x1f7)],'method':_0x41b453(0x1ee),'amount':_0x3f16c0[_0x41b453(0x228)],'callbackUrl':_0x3f16c0['callbackUrl']};this[_0x41b453(0x21f)](_0x41b453(0x226),{..._0x2eacac,'key':_0x41b453(0x1f4)}),console[_0x41b453(0x1ef)](_0x41b453(0x22d),{..._0x2eacac,'key':_0x41b453(0x1f4)});const _0x10df15=await fetch(this[_0x41b453(0x200)][_0x41b453(0x22c)]+_0x41b453(0x226),{'method':_0x41b453(0x20a),'headers':{'Content-Type':_0x41b453(0x221),'User-Agent':'TrapayUK/1.0'},'body':JSON[_0x41b453(0x220)](_0x2eacac)});if(!_0x10df15['ok']){const _0x29aba6=await _0x10df15['json']()[_0x41b453(0x229)](()=>({}));throw new Error('HTTP\x20'+_0x10df15[_0x41b453(0x1fa)]+':\x20'+(_0x29aba6[_0x41b453(0x210)]||_0x41b453(0x215)));}const _0x3b41b8=await _0x10df15[_0x41b453(0x21c)]();this[_0x41b453(0x208)](_0x41b453(0x226),_0x3b41b8),console['log'](_0x41b453(0x201),_0x3b41b8);if(_0x3b41b8[_0x41b453(0x203)]!==0xc8||_0x3b41b8[_0x41b453(0x1fa)]!==_0x41b453(0x207))throw new Error(_0x41b453(0x1fe)+(_0x3b41b8[_0x41b453(0x210)]||'Unknown\x20error'));return{'gateway_payment_id':_0x3b41b8['token'],'payment_url':_0x3b41b8['link'],'expires_at':_0x3b41b8[_0x41b453(0x209)]};}catch(_0x550136){console[_0x41b453(0x1f8)]('âŒ\x20MaxPara\x20API\x20error:',_0x550136[_0x41b453(0x210)]);if(_0x550136[_0x41b453(0x210)]?.[_0x41b453(0x1fc)]('400'))throw new Error(_0x41b453(0x1eb)+_0x550136[_0x41b453(0x210)]);else{if(_0x550136['message']?.[_0x41b453(0x1fc)]('401'))throw new Error(_0x41b453(0x20c));else{if(_0x550136[_0x41b453(0x210)]?.[_0x41b453(0x1fc)](_0x41b453(0x21b)))throw new Error('MaxPara\x20server\x20error');else throw new Error(_0x41b453(0x1fe)+_0x550136[_0x41b453(0x210)]);}}}}[a63_0x168b3a(0x230)](_0x5818f6){const _0x471886=a63_0x168b3a;console['log']('ðŸ”„\x20Processing\x20MaxPara\x20webhook:',_0x5818f6);const _0x5135bc=_0x5818f6['token'];let _0x572fd5;switch(_0x5818f6[_0x471886(0x1fa)]){case _0x471886(0x211):_0x572fd5=_0x471886(0x22b);break;case _0x471886(0x22e):_0x572fd5=_0x471886(0x205);break;default:_0x572fd5=_0x471886(0x1ff);break;}const _0x4a5c09={'method':_0x5818f6[_0x471886(0x204)],'transactionId':_0x5818f6['id'][_0x471886(0x206)]()};return _0x5818f6[_0x471886(0x210)]&&(_0x4a5c09[_0x471886(0x210)]=_0x5818f6['message']),console[_0x471886(0x1ef)]('ðŸ“Š\x20MaxPara\x20webhook\x20processed:\x20'+_0x5135bc+'\x20->\x20'+_0x572fd5),{'paymentId':_0x5135bc,'status':_0x572fd5,'additionalInfo':_0x4a5c09};}[a63_0x168b3a(0x1f6)](_0x25594d,_0x39feef){const _0x175651=a63_0x168b3a;return!!(_0x25594d['id']&&_0x25594d[_0x175651(0x1f2)]&&_0x25594d[_0x175651(0x1fa)]&&_0x25594d[_0x175651(0x212)]==='DEPOSIT');}}exports[a63_0x168b3a(0x1f0)]=MaxParaService;