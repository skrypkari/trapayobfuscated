'use strict';const a69_0xd76337=a69_0x1fc7;(function(_0x25136d,_0xfeddd){const _0x2bab84=a69_0x1fc7,_0x185b90=_0x25136d();while(!![]){try{const _0x5bd9a6=parseInt(_0x2bab84(0x1bc))/0x1+-parseInt(_0x2bab84(0x188))/0x2+-parseInt(_0x2bab84(0x1b5))/0x3+parseInt(_0x2bab84(0x1af))/0x4+-parseInt(_0x2bab84(0x179))/0x5+-parseInt(_0x2bab84(0x197))/0x6*(-parseInt(_0x2bab84(0x1b7))/0x7)+parseInt(_0x2bab84(0x19d))/0x8;if(_0x5bd9a6===_0xfeddd)break;else _0x185b90['push'](_0x185b90['shift']());}catch(_0x51296e){_0x185b90['push'](_0x185b90['shift']());}}}(a69_0x4a20,0xc714f));var __importDefault=this&&this[a69_0xd76337(0x185)]||function(_0x1f87e7){const _0x4aa9ab=a69_0xd76337;return _0x1f87e7&&_0x1f87e7[_0x4aa9ab(0x1a7)]?_0x1f87e7:{'default':_0x1f87e7};};function a69_0x4a20(){const _0x4079d0=['apiKey','702760ICcyoP','log','üìä\x20MaxPara\x20webhook\x20processed:\x20','config','stringify','TrapayUK/1.0','catch','expire_date','customerName','type','__esModule','üì•\x20MaxPara\x20API\x20response:','status','appendFileSync','toString','error','token','default','3770440HVCmuf','POST','baseUrl','APPROVED','validateWebhookSignature','orderId','1451850opRPPB','code','1444436rcqySD','path','Failed\x20to\x20write\x20to\x20response\x20log\x20file:','toISOString','MaxParaService','224410iyuXxl','application/json','MaxPara\x20API\x20error:\x20','logs','PAID','logResponse','2385490Sfbsdv','defineProperty','DEPOSIT','join','500','üì§\x20MaxPara\x20API\x20request:','callbackUrl','\x20->\x20','400','logRequest','json','FAILED','__importDefault','PENDING','401','607540nFsnjp','currency','createDeposit','includes','cwd','message','method','mkdirSync','üè¶\x20Creating\x20MaxPara\x20deposit\x20for\x20','Failed\x20to\x20write\x20to\x20request\x20log\x20file:','/api/deposit','Unknown\x20error','link','MaxPara\x20validation\x20error:\x20','paymentId','24cSQqOl','HIDDEN','existsSync','maxpara-requests.log','amount'];a69_0x4a20=function(){return _0x4079d0;};return a69_0x4a20();}Object[a69_0xd76337(0x17a)](exports,a69_0xd76337(0x1a7),{'value':!![]}),exports[a69_0xd76337(0x1bb)]=void 0x0;const fs_1=__importDefault(require('fs')),path_1=__importDefault(require(a69_0xd76337(0x1b8)));function a69_0x1fc7(_0x1cdba0,_0x1a7402){_0x1cdba0=_0x1cdba0-0x179;const _0x4a205b=a69_0x4a20();let _0x1fc729=_0x4a205b[_0x1cdba0];return _0x1fc729;}class MaxParaService{constructor(_0x1d20dc){const _0x506da8=a69_0xd76337;this[_0x506da8(0x1a0)]=_0x1d20dc;}[a69_0xd76337(0x182)](_0x3b2b0d,_0x46a928){const _0x249179=a69_0xd76337,_0x57dc4d=path_1[_0x249179(0x1ae)]['join'](process[_0x249179(0x18c)](),'logs'),_0x535b0a=path_1[_0x249179(0x1ae)][_0x249179(0x17c)](_0x57dc4d,_0x249179(0x19a));!fs_1[_0x249179(0x1ae)][_0x249179(0x199)](_0x57dc4d)&&fs_1[_0x249179(0x1ae)]['mkdirSync'](_0x57dc4d,{'recursive':!![]});const _0x3d53a6=new Date()[_0x249179(0x1ba)](),_0x486d54='['+_0x3d53a6+']\x20'+_0x3b2b0d+':\x20'+JSON['stringify'](_0x46a928)+'\x0a';try{fs_1[_0x249179(0x1ae)][_0x249179(0x1aa)](_0x535b0a,_0x486d54);}catch(_0x37561e){console[_0x249179(0x1ac)](_0x249179(0x191),_0x37561e);}}[a69_0xd76337(0x1c1)](_0x22b5c4,_0x102c1b){const _0x846eba=a69_0xd76337,_0x9eeb66=path_1[_0x846eba(0x1ae)][_0x846eba(0x17c)](process[_0x846eba(0x18c)](),_0x846eba(0x1bf)),_0x2649fb=path_1['default']['join'](_0x9eeb66,'maxpara-responses.log');!fs_1[_0x846eba(0x1ae)][_0x846eba(0x199)](_0x9eeb66)&&fs_1['default'][_0x846eba(0x18f)](_0x9eeb66,{'recursive':!![]});const _0x2af8df=new Date()['toISOString'](),_0x6e18ee='['+_0x2af8df+']\x20'+_0x22b5c4+':\x20'+JSON['stringify'](_0x102c1b)+'\x0a';try{fs_1['default'][_0x846eba(0x1aa)](_0x2649fb,_0x6e18ee);}catch(_0x568425){console[_0x846eba(0x1ac)](_0x846eba(0x1b9),_0x568425);}}async[a69_0xd76337(0x18a)](_0x38aa1b){const _0x2bd355=a69_0xd76337;console[_0x2bd355(0x19e)](_0x2bd355(0x190)+_0x38aa1b['amount']+'\x20'+_0x38aa1b[_0x2bd355(0x189)]);try{const _0x3ce390={'key':this[_0x2bd355(0x1a0)][_0x2bd355(0x19c)],'username':_0x38aa1b[_0x2bd355(0x1a5)],'user_id':_0x38aa1b[_0x2bd355(0x196)],'token':_0x38aa1b[_0x2bd355(0x1b4)],'method':'fast','amount':_0x38aa1b[_0x2bd355(0x19b)],'callbackUrl':_0x38aa1b[_0x2bd355(0x17f)]};this[_0x2bd355(0x182)](_0x2bd355(0x192),{..._0x3ce390,'key':_0x2bd355(0x198)}),console['log'](_0x2bd355(0x17e),{..._0x3ce390,'key':'HIDDEN'});const _0x3fabde=await fetch(this[_0x2bd355(0x1a0)][_0x2bd355(0x1b1)]+_0x2bd355(0x192),{'method':_0x2bd355(0x1b0),'headers':{'Content-Type':_0x2bd355(0x1bd),'User-Agent':_0x2bd355(0x1a2)},'body':JSON[_0x2bd355(0x1a1)](_0x3ce390)});if(!_0x3fabde['ok']){const _0x1c742c=await _0x3fabde[_0x2bd355(0x183)]()[_0x2bd355(0x1a3)](()=>({}));throw new Error('HTTP\x20'+_0x3fabde[_0x2bd355(0x1a9)]+':\x20'+(_0x1c742c[_0x2bd355(0x18d)]||'Request\x20failed'));}const _0x463808=await _0x3fabde[_0x2bd355(0x183)]();this[_0x2bd355(0x1c1)]('/api/deposit',_0x463808),console[_0x2bd355(0x19e)](_0x2bd355(0x1a8),_0x463808);if(_0x463808[_0x2bd355(0x1b6)]!==0xc8||_0x463808[_0x2bd355(0x1a9)]!=='success')throw new Error(_0x2bd355(0x1be)+(_0x463808[_0x2bd355(0x18d)]||_0x2bd355(0x193)));return{'gateway_payment_id':_0x463808[_0x2bd355(0x1ad)],'payment_url':_0x463808[_0x2bd355(0x194)],'expires_at':_0x463808[_0x2bd355(0x1a4)]};}catch(_0x53c3b5){console[_0x2bd355(0x1ac)]('‚ùå\x20MaxPara\x20API\x20error:',_0x53c3b5['message']);if(_0x53c3b5[_0x2bd355(0x18d)]?.[_0x2bd355(0x18b)](_0x2bd355(0x181)))throw new Error(_0x2bd355(0x195)+_0x53c3b5['message']);else{if(_0x53c3b5[_0x2bd355(0x18d)]?.[_0x2bd355(0x18b)](_0x2bd355(0x187)))throw new Error('MaxPara\x20authentication\x20failed');else{if(_0x53c3b5[_0x2bd355(0x18d)]?.['includes'](_0x2bd355(0x17d)))throw new Error('MaxPara\x20server\x20error');else throw new Error(_0x2bd355(0x1be)+_0x53c3b5[_0x2bd355(0x18d)]);}}}}['processWebhook'](_0x50f589){const _0x514a96=a69_0xd76337;console[_0x514a96(0x19e)]('üîÑ\x20Processing\x20MaxPara\x20webhook:',_0x50f589);const _0x42c908=_0x50f589['token'];let _0x108860;switch(_0x50f589[_0x514a96(0x1a9)]){case _0x514a96(0x1b2):_0x108860=_0x514a96(0x1c0);break;case'DECLINED':_0x108860=_0x514a96(0x184);break;default:_0x108860=_0x514a96(0x186);break;}const _0x5baeb9={'method':_0x50f589[_0x514a96(0x18e)],'transactionId':_0x50f589['id'][_0x514a96(0x1ab)]()};return _0x50f589[_0x514a96(0x18d)]&&(_0x5baeb9['message']=_0x50f589[_0x514a96(0x18d)]),console['log'](_0x514a96(0x19f)+_0x42c908+_0x514a96(0x180)+_0x108860),{'paymentId':_0x42c908,'status':_0x108860,'additionalInfo':_0x5baeb9};}[a69_0xd76337(0x1b3)](_0xe58756,_0x2ce2b2){const _0x5a82d8=a69_0xd76337;return!!(_0xe58756['id']&&_0xe58756['token']&&_0xe58756['status']&&_0xe58756[_0x5a82d8(0x1a6)]===_0x5a82d8(0x17b));}}exports[a69_0xd76337(0x1bb)]=MaxParaService;