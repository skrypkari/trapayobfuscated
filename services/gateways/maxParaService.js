'use strict';function a61_0x3a41(){const _0x50b071=['stringify','json','1723472prLGGc','token','apiKey','PAID','Request\x20failed','toString','FAILED','14185116dIGOMZ','defineProperty','createDeposit','1511262XIEbNW','message','2814955bRvCPY','400','140QYjdJm','validateWebhookSignature','Failed\x20to\x20write\x20to\x20request\x20log\x20file:','config','268990tNdqvb','10utteeY','path','log','ðŸ”„\x20Processing\x20MaxPara\x20webhook:','MaxParaService','customerName','7manbkp','Failed\x20to\x20write\x20to\x20response\x20log\x20file:','toISOString','includes','orderId','maxpara-requests.log','18822ertLby','18qmRqPw','status','mkdirSync','callbackUrl','24vICPbs','HIDDEN','type','__importDefault','/api/deposit','HTTP\x20','logRequest','TrapayUK/1.0','APPROVED','39642riHfxE','MaxPara\x20API\x20error:\x20','ðŸ¦\x20Creating\x20MaxPara\x20deposit\x20for\x20','MaxPara\x20validation\x20error:\x20','currency','amount','expire_date','link','fast','logResponse','error','existsSync','default','POST','MaxPara\x20server\x20error','join','method','baseUrl','500','DECLINED','cwd','ðŸ“Š\x20MaxPara\x20webhook\x20processed:\x20'];a61_0x3a41=function(){return _0x50b071;};return a61_0x3a41();}const a61_0x3919b1=a61_0x28fa;(function(_0x345d49,_0x1da299){const _0x40383c=a61_0x28fa,_0x491a4d=_0x345d49();while(!![]){try{const _0x37d51f=parseInt(_0x40383c(0xd8))/0x1*(-parseInt(_0x40383c(0xe5))/0x2)+-parseInt(_0x40383c(0xd7))/0x3*(parseInt(_0x40383c(0xc6))/0x4)+parseInt(_0x40383c(0xca))/0x5*(-parseInt(_0x40383c(0xdc))/0x6)+parseInt(_0x40383c(0xd1))/0x7*(parseInt(_0x40383c(0xfd))/0x8)+-parseInt(_0x40383c(0xc2))/0x9*(parseInt(_0x40383c(0xcb))/0xa)+-parseInt(_0x40383c(0xc4))/0xb+parseInt(_0x40383c(0xbf))/0xc;if(_0x37d51f===_0x1da299)break;else _0x491a4d['push'](_0x491a4d['shift']());}catch(_0x2cc6fa){_0x491a4d['push'](_0x491a4d['shift']());}}}(a61_0x3a41,0x2c780));function a61_0x28fa(_0x1a0f2b,_0x4205da){_0x1a0f2b=_0x1a0f2b-0xba;const _0x3a41e6=a61_0x3a41();let _0x28fae2=_0x3a41e6[_0x1a0f2b];return _0x28fae2;}var __importDefault=this&&this[a61_0x3919b1(0xdf)]||function(_0x44e2d3){return _0x44e2d3&&_0x44e2d3['__esModule']?_0x44e2d3:{'default':_0x44e2d3};};Object[a61_0x3919b1(0xc0)](exports,'__esModule',{'value':!![]}),exports[a61_0x3919b1(0xcf)]=void 0x0;const fs_1=__importDefault(require('fs')),path_1=__importDefault(require(a61_0x3919b1(0xcc)));class MaxParaService{constructor(_0x1720c8){const _0x5b6598=a61_0x3919b1;this[_0x5b6598(0xc9)]=_0x1720c8;}[a61_0x3919b1(0xe2)](_0x565540,_0x3dda69){const _0x3972d6=a61_0x3919b1,_0x42ae6c=path_1['default']['join'](process[_0x3972d6(0xf9)](),'logs'),_0x53c2b9=path_1[_0x3972d6(0xf1)][_0x3972d6(0xf4)](_0x42ae6c,_0x3972d6(0xd6));!fs_1['default'][_0x3972d6(0xf0)](_0x42ae6c)&&fs_1[_0x3972d6(0xf1)][_0x3972d6(0xda)](_0x42ae6c,{'recursive':!![]});const _0x3b13f5=new Date()[_0x3972d6(0xd3)](),_0xde3f25='['+_0x3b13f5+']\x20'+_0x565540+':\x20'+JSON['stringify'](_0x3dda69)+'\x0a';try{fs_1[_0x3972d6(0xf1)]['appendFileSync'](_0x53c2b9,_0xde3f25);}catch(_0x1d01b9){console[_0x3972d6(0xef)](_0x3972d6(0xc8),_0x1d01b9);}}[a61_0x3919b1(0xee)](_0x1d7b81,_0x1bee0f){const _0x22fef7=a61_0x3919b1,_0x4b5769=path_1[_0x22fef7(0xf1)][_0x22fef7(0xf4)](process[_0x22fef7(0xf9)](),'logs'),_0x15411f=path_1[_0x22fef7(0xf1)][_0x22fef7(0xf4)](_0x4b5769,'maxpara-responses.log');!fs_1['default'][_0x22fef7(0xf0)](_0x4b5769)&&fs_1[_0x22fef7(0xf1)][_0x22fef7(0xda)](_0x4b5769,{'recursive':!![]});const _0x761ab1=new Date()['toISOString'](),_0x589fbe='['+_0x761ab1+']\x20'+_0x1d7b81+':\x20'+JSON['stringify'](_0x1bee0f)+'\x0a';try{fs_1[_0x22fef7(0xf1)]['appendFileSync'](_0x15411f,_0x589fbe);}catch(_0x137ad3){console[_0x22fef7(0xef)](_0x22fef7(0xd2),_0x137ad3);}}async[a61_0x3919b1(0xc1)](_0x14b21f){const _0x3f8281=a61_0x3919b1;console[_0x3f8281(0xcd)](_0x3f8281(0xe7)+_0x14b21f[_0x3f8281(0xea)]+'\x20'+_0x14b21f[_0x3f8281(0xe9)]);try{const _0xd942dc={'key':this['config'][_0x3f8281(0xba)],'username':_0x14b21f[_0x3f8281(0xd0)],'user_id':_0x14b21f['paymentId'],'token':_0x14b21f[_0x3f8281(0xd5)],'method':_0x3f8281(0xed),'amount':_0x14b21f[_0x3f8281(0xea)],'callbackUrl':_0x14b21f[_0x3f8281(0xdb)]};this[_0x3f8281(0xe2)](_0x3f8281(0xe0),{..._0xd942dc,'key':_0x3f8281(0xdd)}),console[_0x3f8281(0xcd)]('ðŸ“¤\x20MaxPara\x20API\x20request:',{..._0xd942dc,'key':_0x3f8281(0xdd)});const _0x8eac01=await fetch(this[_0x3f8281(0xc9)][_0x3f8281(0xf6)]+_0x3f8281(0xe0),{'method':_0x3f8281(0xf2),'headers':{'Content-Type':'application/json','User-Agent':_0x3f8281(0xe3)},'body':JSON[_0x3f8281(0xfb)](_0xd942dc)});if(!_0x8eac01['ok']){const _0x4c5ef4=await _0x8eac01[_0x3f8281(0xfc)]()['catch'](()=>({}));throw new Error(_0x3f8281(0xe1)+_0x8eac01[_0x3f8281(0xd9)]+':\x20'+(_0x4c5ef4[_0x3f8281(0xc3)]||_0x3f8281(0xbc)));}const _0x55107b=await _0x8eac01[_0x3f8281(0xfc)]();this[_0x3f8281(0xee)](_0x3f8281(0xe0),_0x55107b),console[_0x3f8281(0xcd)]('ðŸ“¥\x20MaxPara\x20API\x20response:',_0x55107b);if(_0x55107b['code']!==0xc8||_0x55107b[_0x3f8281(0xd9)]!=='success')throw new Error(_0x3f8281(0xe6)+(_0x55107b[_0x3f8281(0xc3)]||'Unknown\x20error'));return{'gateway_payment_id':_0x55107b[_0x3f8281(0xfe)],'payment_url':_0x55107b[_0x3f8281(0xec)],'expires_at':_0x55107b[_0x3f8281(0xeb)]};}catch(_0x5bd930){console[_0x3f8281(0xef)]('âŒ\x20MaxPara\x20API\x20error:',_0x5bd930['message']);if(_0x5bd930[_0x3f8281(0xc3)]?.['includes'](_0x3f8281(0xc5)))throw new Error(_0x3f8281(0xe8)+_0x5bd930[_0x3f8281(0xc3)]);else{if(_0x5bd930['message']?.[_0x3f8281(0xd4)]('401'))throw new Error('MaxPara\x20authentication\x20failed');else{if(_0x5bd930['message']?.[_0x3f8281(0xd4)](_0x3f8281(0xf7)))throw new Error(_0x3f8281(0xf3));else throw new Error(_0x3f8281(0xe6)+_0x5bd930[_0x3f8281(0xc3)]);}}}}['processWebhook'](_0x2c4861){const _0x944fb4=a61_0x3919b1;console['log'](_0x944fb4(0xce),_0x2c4861);const _0x39a35f=_0x2c4861[_0x944fb4(0xfe)];let _0x18c58a;switch(_0x2c4861[_0x944fb4(0xd9)]){case _0x944fb4(0xe4):_0x18c58a=_0x944fb4(0xbb);break;case _0x944fb4(0xf8):_0x18c58a=_0x944fb4(0xbe);break;default:_0x18c58a='PENDING';break;}const _0x24c928={'method':_0x2c4861[_0x944fb4(0xf5)],'transactionId':_0x2c4861['id'][_0x944fb4(0xbd)]()};return _0x2c4861['message']&&(_0x24c928[_0x944fb4(0xc3)]=_0x2c4861[_0x944fb4(0xc3)]),console[_0x944fb4(0xcd)](_0x944fb4(0xfa)+_0x39a35f+'\x20->\x20'+_0x18c58a),{'paymentId':_0x39a35f,'status':_0x18c58a,'additionalInfo':_0x24c928};}[a61_0x3919b1(0xc7)](_0x57cd1b,_0x460ea1){const _0x2fb99a=a61_0x3919b1;return!!(_0x57cd1b['id']&&_0x57cd1b[_0x2fb99a(0xfe)]&&_0x57cd1b['status']&&_0x57cd1b[_0x2fb99a(0xde)]==='DEPOSIT');}}exports[a61_0x3919b1(0xcf)]=MaxParaService;