'use strict';const a69_0x4ff3cb=a69_0x1992;function a69_0x7e39(){const _0x1740dc=['catch','application/json','logs','maxpara-requests.log','logResponse','üì•\x20MaxPara\x20API\x20response:','84259QEHMfC','3038100pzNJhz','stringify','code','üè¶\x20Creating\x20MaxPara\x20deposit\x20for\x20','Failed\x20to\x20write\x20to\x20response\x20log\x20file:','config','TrapayUK/1.0','mkdirSync','1706eHaSOl','includes','callbackUrl','POST','path','token','status','log','MaxParaService','__importDefault','2514940ueFoZG','message','expire_date','üìä\x20MaxPara\x20webhook\x20processed:\x20','link','üîÑ\x20Processing\x20MaxPara\x20webhook:','fast','default','toISOString','PAID','type','/api/deposit','Failed\x20to\x20write\x20to\x20request\x20log\x20file:','apiKey','881538vdkQgl','cwd','json','appendFileSync','DECLINED','Request\x20failed','orderId','paymentId','HIDDEN','validateWebhookSignature','__esModule','Unknown\x20error','\x20->\x20','defineProperty','error','401','614GlBUNX','join','PENDING','logRequest','customerName','18068697jQtPAp','MaxPara\x20server\x20error','MaxPara\x20API\x20error:\x20','252BKjuuw','4648496YfzrPa','baseUrl','amount','method'];a69_0x7e39=function(){return _0x1740dc;};return a69_0x7e39();}(function(_0x4c17a7,_0x1f1fe7){const _0x2d4e00=a69_0x1992,_0x35dd20=_0x4c17a7();while(!![]){try{const _0x54080b=-parseInt(_0x2d4e00(0x108))/0x1*(parseInt(_0x2d4e00(0xe0))/0x2)+parseInt(_0x2d4e00(0xf8))/0x3+-parseInt(_0x2d4e00(0xd8))/0x4+-parseInt(_0x2d4e00(0xea))/0x5+-parseInt(_0x2d4e00(0xcc))/0x6*(-parseInt(_0x2d4e00(0xd7))/0x7)+-parseInt(_0x2d4e00(0xcd))/0x8+parseInt(_0x2d4e00(0xc9))/0x9;if(_0x54080b===_0x1f1fe7)break;else _0x35dd20['push'](_0x35dd20['shift']());}catch(_0x2f0569){_0x35dd20['push'](_0x35dd20['shift']());}}}(a69_0x7e39,0x6b5a4));var __importDefault=this&&this[a69_0x4ff3cb(0xe9)]||function(_0x98bc13){const _0x4f31d5=a69_0x4ff3cb;return _0x98bc13&&_0x98bc13[_0x4f31d5(0x102)]?_0x98bc13:{'default':_0x98bc13};};function a69_0x1992(_0x3bb983,_0x39d32a){_0x3bb983=_0x3bb983-0xc8;const _0x7e396f=a69_0x7e39();let _0x199238=_0x7e396f[_0x3bb983];return _0x199238;}Object[a69_0x4ff3cb(0x105)](exports,'__esModule',{'value':!![]}),exports[a69_0x4ff3cb(0xe8)]=void 0x0;const fs_1=__importDefault(require('fs')),path_1=__importDefault(require(a69_0x4ff3cb(0xe4)));class MaxParaService{constructor(_0x3a7a08){this['config']=_0x3a7a08;}[a69_0x4ff3cb(0x10b)](_0x5cfa05,_0x4163b9){const _0x409d63=a69_0x4ff3cb,_0x49a848=path_1[_0x409d63(0xf1)][_0x409d63(0x109)](process[_0x409d63(0xf9)](),_0x409d63(0xd3)),_0x4a1834=path_1[_0x409d63(0xf1)][_0x409d63(0x109)](_0x49a848,_0x409d63(0xd4));!fs_1[_0x409d63(0xf1)]['existsSync'](_0x49a848)&&fs_1[_0x409d63(0xf1)][_0x409d63(0xdf)](_0x49a848,{'recursive':!![]});const _0x580907=new Date()['toISOString'](),_0x1606ae='['+_0x580907+']\x20'+_0x5cfa05+':\x20'+JSON[_0x409d63(0xd9)](_0x4163b9)+'\x0a';try{fs_1[_0x409d63(0xf1)][_0x409d63(0xfb)](_0x4a1834,_0x1606ae);}catch(_0x2c5d60){console[_0x409d63(0x106)](_0x409d63(0xf6),_0x2c5d60);}}[a69_0x4ff3cb(0xd5)](_0x489f26,_0x2b2c65){const _0x20b6c4=a69_0x4ff3cb,_0xd05487=path_1['default'][_0x20b6c4(0x109)](process[_0x20b6c4(0xf9)](),_0x20b6c4(0xd3)),_0x33b2b9=path_1[_0x20b6c4(0xf1)][_0x20b6c4(0x109)](_0xd05487,'maxpara-responses.log');!fs_1['default']['existsSync'](_0xd05487)&&fs_1[_0x20b6c4(0xf1)]['mkdirSync'](_0xd05487,{'recursive':!![]});const _0x3196ad=new Date()[_0x20b6c4(0xf2)](),_0x37f321='['+_0x3196ad+']\x20'+_0x489f26+':\x20'+JSON['stringify'](_0x2b2c65)+'\x0a';try{fs_1[_0x20b6c4(0xf1)]['appendFileSync'](_0x33b2b9,_0x37f321);}catch(_0x35b32d){console['error'](_0x20b6c4(0xdc),_0x35b32d);}}async['createDeposit'](_0x158927){const _0x21657d=a69_0x4ff3cb;console[_0x21657d(0xe7)](_0x21657d(0xdb)+_0x158927[_0x21657d(0xcf)]+'\x20'+_0x158927['currency']);try{const _0x464868={'key':this[_0x21657d(0xdd)][_0x21657d(0xf7)],'username':_0x158927[_0x21657d(0xc8)],'user_id':_0x158927[_0x21657d(0xff)],'token':_0x158927[_0x21657d(0xfe)],'method':_0x21657d(0xf0),'amount':_0x158927[_0x21657d(0xcf)],'callbackUrl':_0x158927[_0x21657d(0xe2)]};this[_0x21657d(0x10b)](_0x21657d(0xf5),{..._0x464868,'key':_0x21657d(0x100)}),console['log']('üì§\x20MaxPara\x20API\x20request:',{..._0x464868,'key':_0x21657d(0x100)});const _0x5a95e1=await fetch(this[_0x21657d(0xdd)][_0x21657d(0xce)]+'/api/deposit',{'method':_0x21657d(0xe3),'headers':{'Content-Type':_0x21657d(0xd2),'User-Agent':_0x21657d(0xde)},'body':JSON[_0x21657d(0xd9)](_0x464868)});if(!_0x5a95e1['ok']){const _0x171719=await _0x5a95e1['json']()[_0x21657d(0xd1)](()=>({}));throw new Error('HTTP\x20'+_0x5a95e1[_0x21657d(0xe6)]+':\x20'+(_0x171719[_0x21657d(0xeb)]||_0x21657d(0xfd)));}const _0x12cb4d=await _0x5a95e1[_0x21657d(0xfa)]();this['logResponse'](_0x21657d(0xf5),_0x12cb4d),console[_0x21657d(0xe7)](_0x21657d(0xd6),_0x12cb4d);if(_0x12cb4d[_0x21657d(0xda)]!==0xc8||_0x12cb4d[_0x21657d(0xe6)]!=='success')throw new Error(_0x21657d(0xcb)+(_0x12cb4d['message']||_0x21657d(0x103)));return{'gateway_payment_id':_0x12cb4d[_0x21657d(0xe5)],'payment_url':_0x12cb4d[_0x21657d(0xee)],'expires_at':_0x12cb4d[_0x21657d(0xec)]};}catch(_0xc4afbd){console['error']('‚ùå\x20MaxPara\x20API\x20error:',_0xc4afbd[_0x21657d(0xeb)]);if(_0xc4afbd[_0x21657d(0xeb)]?.[_0x21657d(0xe1)]('400'))throw new Error('MaxPara\x20validation\x20error:\x20'+_0xc4afbd['message']);else{if(_0xc4afbd['message']?.['includes'](_0x21657d(0x107)))throw new Error('MaxPara\x20authentication\x20failed');else{if(_0xc4afbd['message']?.['includes']('500'))throw new Error(_0x21657d(0xca));else throw new Error('MaxPara\x20API\x20error:\x20'+_0xc4afbd[_0x21657d(0xeb)]);}}}}['processWebhook'](_0x2ddd40){const _0x3c9272=a69_0x4ff3cb;console[_0x3c9272(0xe7)](_0x3c9272(0xef),_0x2ddd40);const _0x3fcab8=_0x2ddd40[_0x3c9272(0xe5)];let _0x1995b6;switch(_0x2ddd40[_0x3c9272(0xe6)]){case'APPROVED':_0x1995b6=_0x3c9272(0xf3);break;case _0x3c9272(0xfc):_0x1995b6='FAILED';break;default:_0x1995b6=_0x3c9272(0x10a);break;}const _0x2ef9ec={'method':_0x2ddd40[_0x3c9272(0xd0)],'transactionId':_0x2ddd40['id']['toString']()};return _0x2ddd40[_0x3c9272(0xeb)]&&(_0x2ef9ec[_0x3c9272(0xeb)]=_0x2ddd40[_0x3c9272(0xeb)]),console[_0x3c9272(0xe7)](_0x3c9272(0xed)+_0x3fcab8+_0x3c9272(0x104)+_0x1995b6),{'paymentId':_0x3fcab8,'status':_0x1995b6,'additionalInfo':_0x2ef9ec};}[a69_0x4ff3cb(0x101)](_0x1ea760,_0x776e2a){const _0x4c4bbd=a69_0x4ff3cb;return!!(_0x1ea760['id']&&_0x1ea760[_0x4c4bbd(0xe5)]&&_0x1ea760['status']&&_0x1ea760[_0x4c4bbd(0xf4)]==='DEPOSIT');}}exports[a69_0x4ff3cb(0xe8)]=MaxParaService;