'use strict';const a58_0x407cad=a58_0x2f4e;(function(_0x22dc21,_0x46a013){const _0x4dc4c7=a58_0x2f4e,_0x4b6295=_0x22dc21();while(!![]){try{const _0x3078b6=-parseInt(_0x4dc4c7(0x168))/0x1+-parseInt(_0x4dc4c7(0x159))/0x2*(-parseInt(_0x4dc4c7(0x182))/0x3)+parseInt(_0x4dc4c7(0x187))/0x4+-parseInt(_0x4dc4c7(0x18e))/0x5*(-parseInt(_0x4dc4c7(0x17d))/0x6)+-parseInt(_0x4dc4c7(0x162))/0x7+-parseInt(_0x4dc4c7(0x191))/0x8*(parseInt(_0x4dc4c7(0x190))/0x9)+-parseInt(_0x4dc4c7(0x18a))/0xa;if(_0x3078b6===_0x46a013)break;else _0x4b6295['push'](_0x4b6295['shift']());}catch(_0x56ee91){_0x4b6295['push'](_0x4b6295['shift']());}}}(a58_0x2d4b,0xceb7f));function a58_0x2d4b(){const _0x5021bd=['apiKey','9984558ZMwmdr','link','type','POST','MaxPara\x20API\x20error:\x20','1041hvqnif','paymentId','token','customerName','Unknown\x20error','5733648QJsouF','HTTP\x20','DEPOSIT','15247930BWqZvR','error','json','MaxParaService','5uryuXR','MaxPara\x20authentication\x20failed','27utTNOW','307488iJzcms','config','MaxPara\x20server\x20error','log','âŒ\x20MaxPara\x20API\x20error:','PENDING','toISOString','path','baseUrl','ðŸ“Š\x20MaxPara\x20webhook\x20processed:\x20','success','callbackUrl','/api/deposit','toString','2146ESWoAM','DECLINED','default','logs','Failed\x20to\x20write\x20to\x20response\x20log\x20file:','defineProperty','appendFileSync','401','join','4627238dCdcDX','orderId','\x20->\x20','logRequest','APPROVED','PAID','321982PhpRIj','code','status','__importDefault','logResponse','500','validateWebhookSignature','HIDDEN','fast','message','400','ðŸ”„\x20Processing\x20MaxPara\x20webhook:','ðŸ“¥\x20MaxPara\x20API\x20response:','method','stringify','ðŸ“¤\x20MaxPara\x20API\x20request:','includes','__esModule','amount','existsSync'];a58_0x2d4b=function(){return _0x5021bd;};return a58_0x2d4b();}var __importDefault=this&&this[a58_0x407cad(0x16b)]||function(_0x35ccfd){const _0x3ce171=a58_0x407cad;return _0x35ccfd&&_0x35ccfd[_0x3ce171(0x179)]?_0x35ccfd:{'default':_0x35ccfd};};function a58_0x2f4e(_0x3d1ee8,_0x4afde4){_0x3d1ee8=_0x3d1ee8-0x156;const _0x2d4b78=a58_0x2d4b();let _0x2f4e46=_0x2d4b78[_0x3d1ee8];return _0x2f4e46;}Object[a58_0x407cad(0x15e)](exports,'__esModule',{'value':!![]}),exports['MaxParaService']=void 0x0;const fs_1=__importDefault(require('fs')),path_1=__importDefault(require(a58_0x407cad(0x198)));class MaxParaService{constructor(_0x1ba8c9){const _0x247891=a58_0x407cad;this[_0x247891(0x192)]=_0x1ba8c9;}[a58_0x407cad(0x165)](_0x35cf07,_0x4d435a){const _0x5cab66=a58_0x407cad,_0x9365d7=path_1[_0x5cab66(0x15b)][_0x5cab66(0x161)](process['cwd'](),_0x5cab66(0x15c)),_0x4a6305=path_1[_0x5cab66(0x15b)][_0x5cab66(0x161)](_0x9365d7,'maxpara-requests.log');!fs_1[_0x5cab66(0x15b)][_0x5cab66(0x17b)](_0x9365d7)&&fs_1[_0x5cab66(0x15b)]['mkdirSync'](_0x9365d7,{'recursive':!![]});const _0x363332=new Date()[_0x5cab66(0x197)](),_0x489d0a='['+_0x363332+']\x20'+_0x35cf07+':\x20'+JSON[_0x5cab66(0x176)](_0x4d435a)+'\x0a';try{fs_1[_0x5cab66(0x15b)][_0x5cab66(0x15f)](_0x4a6305,_0x489d0a);}catch(_0xd4b211){console[_0x5cab66(0x18b)]('Failed\x20to\x20write\x20to\x20request\x20log\x20file:',_0xd4b211);}}[a58_0x407cad(0x16c)](_0x5dcdc9,_0x1f509a){const _0x2f5505=a58_0x407cad,_0x1c1263=path_1['default'][_0x2f5505(0x161)](process['cwd'](),_0x2f5505(0x15c)),_0x5331a1=path_1[_0x2f5505(0x15b)][_0x2f5505(0x161)](_0x1c1263,'maxpara-responses.log');!fs_1[_0x2f5505(0x15b)][_0x2f5505(0x17b)](_0x1c1263)&&fs_1['default']['mkdirSync'](_0x1c1263,{'recursive':!![]});const _0x1aee4b=new Date()[_0x2f5505(0x197)](),_0x3de15c='['+_0x1aee4b+']\x20'+_0x5dcdc9+':\x20'+JSON[_0x2f5505(0x176)](_0x1f509a)+'\x0a';try{fs_1['default'][_0x2f5505(0x15f)](_0x5331a1,_0x3de15c);}catch(_0x1612ed){console[_0x2f5505(0x18b)](_0x2f5505(0x15d),_0x1612ed);}}async['createDeposit'](_0x276890){const _0x41d976=a58_0x407cad;console[_0x41d976(0x194)]('ðŸ¦\x20Creating\x20MaxPara\x20deposit\x20for\x20'+_0x276890['amount']+'\x20'+_0x276890['currency']);try{const _0x2786cd={'key':this[_0x41d976(0x192)][_0x41d976(0x17c)],'username':_0x276890[_0x41d976(0x185)],'user_id':_0x276890[_0x41d976(0x183)],'token':_0x276890[_0x41d976(0x163)],'method':_0x41d976(0x170),'amount':_0x276890[_0x41d976(0x17a)],'callbackUrl':_0x276890[_0x41d976(0x156)]};this[_0x41d976(0x165)](_0x41d976(0x157),{..._0x2786cd,'key':_0x41d976(0x16f)}),console[_0x41d976(0x194)](_0x41d976(0x177),{..._0x2786cd,'key':_0x41d976(0x16f)});const _0x331181=await fetch(this[_0x41d976(0x192)][_0x41d976(0x199)]+_0x41d976(0x157),{'method':_0x41d976(0x180),'headers':{'Content-Type':'application/json','User-Agent':'TrapayUK/1.0'},'body':JSON[_0x41d976(0x176)](_0x2786cd)});if(!_0x331181['ok']){const _0x1beb53=await _0x331181[_0x41d976(0x18c)]()['catch'](()=>({}));throw new Error(_0x41d976(0x188)+_0x331181[_0x41d976(0x16a)]+':\x20'+(_0x1beb53[_0x41d976(0x171)]||'Request\x20failed'));}const _0x14792a=await _0x331181['json']();this[_0x41d976(0x16c)](_0x41d976(0x157),_0x14792a),console[_0x41d976(0x194)](_0x41d976(0x174),_0x14792a);if(_0x14792a[_0x41d976(0x169)]!==0xc8||_0x14792a[_0x41d976(0x16a)]!==_0x41d976(0x19b))throw new Error('MaxPara\x20API\x20error:\x20'+(_0x14792a[_0x41d976(0x171)]||_0x41d976(0x186)));return{'gateway_payment_id':_0x14792a[_0x41d976(0x184)],'payment_url':_0x14792a[_0x41d976(0x17e)],'expires_at':_0x14792a['expire_date']};}catch(_0x304a8c){console['error'](_0x41d976(0x195),_0x304a8c[_0x41d976(0x171)]);if(_0x304a8c[_0x41d976(0x171)]?.[_0x41d976(0x178)](_0x41d976(0x172)))throw new Error('MaxPara\x20validation\x20error:\x20'+_0x304a8c[_0x41d976(0x171)]);else{if(_0x304a8c[_0x41d976(0x171)]?.['includes'](_0x41d976(0x160)))throw new Error(_0x41d976(0x18f));else{if(_0x304a8c[_0x41d976(0x171)]?.['includes'](_0x41d976(0x16d)))throw new Error(_0x41d976(0x193));else throw new Error(_0x41d976(0x181)+_0x304a8c[_0x41d976(0x171)]);}}}}['processWebhook'](_0x3a9cdf){const _0x17b099=a58_0x407cad;console['log'](_0x17b099(0x173),_0x3a9cdf);const _0x5148be=_0x3a9cdf['token'];let _0x576081;switch(_0x3a9cdf[_0x17b099(0x16a)]){case _0x17b099(0x166):_0x576081=_0x17b099(0x167);break;case _0x17b099(0x15a):_0x576081='FAILED';break;default:_0x576081=_0x17b099(0x196);break;}const _0x3f91ea={'method':_0x3a9cdf[_0x17b099(0x175)],'transactionId':_0x3a9cdf['id'][_0x17b099(0x158)]()};return _0x3a9cdf[_0x17b099(0x171)]&&(_0x3f91ea['message']=_0x3a9cdf[_0x17b099(0x171)]),console[_0x17b099(0x194)](_0x17b099(0x19a)+_0x5148be+_0x17b099(0x164)+_0x576081),{'paymentId':_0x5148be,'status':_0x576081,'additionalInfo':_0x3f91ea};}[a58_0x407cad(0x16e)](_0x219bbb,_0x1f55ef){const _0x39b2b7=a58_0x407cad;return!!(_0x219bbb['id']&&_0x219bbb[_0x39b2b7(0x184)]&&_0x219bbb['status']&&_0x219bbb[_0x39b2b7(0x17f)]===_0x39b2b7(0x189));}}exports[a58_0x407cad(0x18d)]=MaxParaService;