'use strict';const a58_0x189bb8=a58_0x53f8;(function(_0x1fcdaf,_0x4234d5){const _0x2dd70b=a58_0x53f8,_0xc743d0=_0x1fcdaf();while(!![]){try{const _0x84630=-parseInt(_0x2dd70b(0x1b5))/0x1*(-parseInt(_0x2dd70b(0x1a5))/0x2)+parseInt(_0x2dd70b(0x192))/0x3+parseInt(_0x2dd70b(0x180))/0x4*(-parseInt(_0x2dd70b(0x1a8))/0x5)+parseInt(_0x2dd70b(0x17c))/0x6*(-parseInt(_0x2dd70b(0x1b1))/0x7)+-parseInt(_0x2dd70b(0x1a9))/0x8+parseInt(_0x2dd70b(0x194))/0x9+-parseInt(_0x2dd70b(0x187))/0xa;if(_0x84630===_0x4234d5)break;else _0xc743d0['push'](_0xc743d0['shift']());}catch(_0x5c1420){_0xc743d0['push'](_0xc743d0['shift']());}}}(a58_0x1e27,0x6859e));var __importDefault=this&&this[a58_0x189bb8(0x1aa)]||function(_0x2d8fba){return _0x2d8fba&&_0x2d8fba['__esModule']?_0x2d8fba:{'default':_0x2d8fba};};function a58_0x53f8(_0x25b0d2,_0x125d62){_0x25b0d2=_0x25b0d2-0x17b;const _0x1e277c=a58_0x1e27();let _0x53f8f2=_0x1e277c[_0x25b0d2];return _0x53f8f2;}function a58_0x1e27(){const _0x4d548d=['fast','message','12dRWAQx','config','customerName','code','2368LyaDKu','logRequest','amount','link','expire_date','HIDDEN','POST','366710iYGddh','Unknown\x20error','DECLINED','üì§\x20MaxPara\x20API\x20request:','MaxPara\x20server\x20error','stringify','Failed\x20to\x20write\x20to\x20request\x20log\x20file:','callbackUrl','DEPOSIT','defineProperty','/api/deposit','1151916qHpNNB','FAILED','3329856Dwazyb','APPROVED','MaxPara\x20API\x20error:\x20','toString','method','toISOString','token','existsSync','cwd','TrapayUK/1.0','\x20->\x20','appendFileSync','paymentId','join','MaxParaService','üîÑ\x20Processing\x20MaxPara\x20webhook:','apiKey','4gqDmgR','MaxPara\x20authentication\x20failed','default','960JxzqUt','1639912goplnH','__importDefault','maxpara-responses.log','validateWebhookSignature','status','createDeposit','mkdirSync','maxpara-requests.log','1260343SVsYko','logResponse','json','Request\x20failed','194444cHMWBT','includes','path','currency','logs','catch','orderId','Failed\x20to\x20write\x20to\x20response\x20log\x20file:','error','log'];a58_0x1e27=function(){return _0x4d548d;};return a58_0x1e27();}Object[a58_0x189bb8(0x190)](exports,'__esModule',{'value':!![]}),exports[a58_0x189bb8(0x1a2)]=void 0x0;const fs_1=__importDefault(require('fs')),path_1=__importDefault(require(a58_0x189bb8(0x1b7)));class MaxParaService{constructor(_0x135680){const _0x1dd7ac=a58_0x189bb8;this[_0x1dd7ac(0x17d)]=_0x135680;}[a58_0x189bb8(0x181)](_0x36d2a8,_0x232c56){const _0x3ebc12=a58_0x189bb8,_0x1c84a8=path_1[_0x3ebc12(0x1a7)]['join'](process[_0x3ebc12(0x19c)](),_0x3ebc12(0x1b9)),_0x17dffc=path_1[_0x3ebc12(0x1a7)][_0x3ebc12(0x1a1)](_0x1c84a8,_0x3ebc12(0x1b0));!fs_1[_0x3ebc12(0x1a7)][_0x3ebc12(0x19b)](_0x1c84a8)&&fs_1[_0x3ebc12(0x1a7)][_0x3ebc12(0x1af)](_0x1c84a8,{'recursive':!![]});const _0x4c0f42=new Date()[_0x3ebc12(0x199)](),_0x1bc029='['+_0x4c0f42+']\x20'+_0x36d2a8+':\x20'+JSON[_0x3ebc12(0x18c)](_0x232c56)+'\x0a';try{fs_1[_0x3ebc12(0x1a7)]['appendFileSync'](_0x17dffc,_0x1bc029);}catch(_0x4dd362){console[_0x3ebc12(0x1bd)](_0x3ebc12(0x18d),_0x4dd362);}}['logResponse'](_0x4b78d2,_0x4dad44){const _0x3f0e8f=a58_0x189bb8,_0x35a466=path_1[_0x3f0e8f(0x1a7)][_0x3f0e8f(0x1a1)](process[_0x3f0e8f(0x19c)](),_0x3f0e8f(0x1b9)),_0x18ab85=path_1[_0x3f0e8f(0x1a7)]['join'](_0x35a466,_0x3f0e8f(0x1ab));!fs_1[_0x3f0e8f(0x1a7)][_0x3f0e8f(0x19b)](_0x35a466)&&fs_1['default'][_0x3f0e8f(0x1af)](_0x35a466,{'recursive':!![]});const _0x41d609=new Date()[_0x3f0e8f(0x199)](),_0x5e80e3='['+_0x41d609+']\x20'+_0x4b78d2+':\x20'+JSON[_0x3f0e8f(0x18c)](_0x4dad44)+'\x0a';try{fs_1[_0x3f0e8f(0x1a7)][_0x3f0e8f(0x19f)](_0x18ab85,_0x5e80e3);}catch(_0x455249){console[_0x3f0e8f(0x1bd)](_0x3f0e8f(0x1bc),_0x455249);}}async[a58_0x189bb8(0x1ae)](_0x4b2ddd){const _0x2c735c=a58_0x189bb8;console[_0x2c735c(0x1be)]('üè¶\x20Creating\x20MaxPara\x20deposit\x20for\x20'+_0x4b2ddd[_0x2c735c(0x182)]+'\x20'+_0x4b2ddd[_0x2c735c(0x1b8)]);try{const _0x3747ba={'key':this[_0x2c735c(0x17d)][_0x2c735c(0x1a4)],'username':_0x4b2ddd[_0x2c735c(0x17e)],'user_id':_0x4b2ddd[_0x2c735c(0x1a0)],'token':_0x4b2ddd[_0x2c735c(0x1bb)],'method':_0x2c735c(0x1bf),'amount':_0x4b2ddd[_0x2c735c(0x182)],'callbackUrl':_0x4b2ddd[_0x2c735c(0x18e)]};this[_0x2c735c(0x181)]('/api/deposit',{..._0x3747ba,'key':_0x2c735c(0x185)}),console['log'](_0x2c735c(0x18a),{..._0x3747ba,'key':_0x2c735c(0x185)});const _0x17c988=await fetch(this[_0x2c735c(0x17d)]['baseUrl']+_0x2c735c(0x191),{'method':_0x2c735c(0x186),'headers':{'Content-Type':'application/json','User-Agent':_0x2c735c(0x19d)},'body':JSON['stringify'](_0x3747ba)});if(!_0x17c988['ok']){const _0x438fd7=await _0x17c988[_0x2c735c(0x1b3)]()[_0x2c735c(0x1ba)](()=>({}));throw new Error('HTTP\x20'+_0x17c988['status']+':\x20'+(_0x438fd7[_0x2c735c(0x17b)]||_0x2c735c(0x1b4)));}const _0x18ef1c=await _0x17c988['json']();this[_0x2c735c(0x1b2)]('/api/deposit',_0x18ef1c),console[_0x2c735c(0x1be)]('üì•\x20MaxPara\x20API\x20response:',_0x18ef1c);if(_0x18ef1c[_0x2c735c(0x17f)]!==0xc8||_0x18ef1c['status']!=='success')throw new Error(_0x2c735c(0x196)+(_0x18ef1c[_0x2c735c(0x17b)]||_0x2c735c(0x188)));return{'gateway_payment_id':_0x18ef1c['token'],'payment_url':_0x18ef1c[_0x2c735c(0x183)],'expires_at':_0x18ef1c[_0x2c735c(0x184)]};}catch(_0x450093){console[_0x2c735c(0x1bd)]('‚ùå\x20MaxPara\x20API\x20error:',_0x450093[_0x2c735c(0x17b)]);if(_0x450093[_0x2c735c(0x17b)]?.['includes']('400'))throw new Error('MaxPara\x20validation\x20error:\x20'+_0x450093['message']);else{if(_0x450093['message']?.[_0x2c735c(0x1b6)]('401'))throw new Error(_0x2c735c(0x1a6));else{if(_0x450093[_0x2c735c(0x17b)]?.[_0x2c735c(0x1b6)]('500'))throw new Error(_0x2c735c(0x18b));else throw new Error('MaxPara\x20API\x20error:\x20'+_0x450093['message']);}}}}['processWebhook'](_0xb1eb73){const _0x5df75f=a58_0x189bb8;console['log'](_0x5df75f(0x1a3),_0xb1eb73);const _0x553291=_0xb1eb73[_0x5df75f(0x19a)];let _0x906965;switch(_0xb1eb73[_0x5df75f(0x1ad)]){case _0x5df75f(0x195):_0x906965='PAID';break;case _0x5df75f(0x189):_0x906965=_0x5df75f(0x193);break;default:_0x906965='PENDING';break;}const _0x21406a={'method':_0xb1eb73[_0x5df75f(0x198)],'transactionId':_0xb1eb73['id'][_0x5df75f(0x197)]()};return _0xb1eb73[_0x5df75f(0x17b)]&&(_0x21406a[_0x5df75f(0x17b)]=_0xb1eb73[_0x5df75f(0x17b)]),console[_0x5df75f(0x1be)]('üìä\x20MaxPara\x20webhook\x20processed:\x20'+_0x553291+_0x5df75f(0x19e)+_0x906965),{'paymentId':_0x553291,'status':_0x906965,'additionalInfo':_0x21406a};}[a58_0x189bb8(0x1ac)](_0x199447,_0x35a310){const _0x2ccf5c=a58_0x189bb8;return!!(_0x199447['id']&&_0x199447[_0x2ccf5c(0x19a)]&&_0x199447[_0x2ccf5c(0x1ad)]&&_0x199447['type']===_0x2ccf5c(0x18f));}}exports[a58_0x189bb8(0x1a2)]=MaxParaService;