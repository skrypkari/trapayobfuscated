'use strict';const a58_0x2874bd=a58_0x5240;(function(_0x25510b,_0x1398b0){const _0x166e07=a58_0x5240,_0x2c5510=_0x25510b();while(!![]){try{const _0x453aa5=parseInt(_0x166e07(0x1db))/0x1*(parseInt(_0x166e07(0x1f8))/0x2)+parseInt(_0x166e07(0x212))/0x3*(parseInt(_0x166e07(0x1f5))/0x4)+parseInt(_0x166e07(0x1f1))/0x5+-parseInt(_0x166e07(0x1e6))/0x6+parseInt(_0x166e07(0x1fe))/0x7+parseInt(_0x166e07(0x210))/0x8+-parseInt(_0x166e07(0x1ed))/0x9;if(_0x453aa5===_0x1398b0)break;else _0x2c5510['push'](_0x2c5510['shift']());}catch(_0x125d44){_0x2c5510['push'](_0x2c5510['shift']());}}}(a58_0x4c2a,0x7948d));var __importDefault=this&&this[a58_0x2874bd(0x219)]||function(_0x4f90bf){const _0x508bec=a58_0x2874bd;return _0x4f90bf&&_0x4f90bf[_0x508bec(0x214)]?_0x4f90bf:{'default':_0x4f90bf};};Object[a58_0x2874bd(0x207)](exports,a58_0x2874bd(0x214),{'value':!![]}),exports[a58_0x2874bd(0x1f2)]=void 0x0;const fs_1=__importDefault(require('fs')),path_1=__importDefault(require('path'));class MaxParaService{constructor(_0x36658f){const _0x30d570=a58_0x2874bd;this[_0x30d570(0x1e9)]=_0x36658f;}[a58_0x2874bd(0x1f6)](_0x4be382,_0x3230d9){const _0x3e4fa4=a58_0x2874bd,_0x5c1d9c=path_1['default'][_0x3e4fa4(0x20d)](process[_0x3e4fa4(0x1f4)](),_0x3e4fa4(0x203)),_0x491749=path_1[_0x3e4fa4(0x201)][_0x3e4fa4(0x20d)](_0x5c1d9c,_0x3e4fa4(0x220));!fs_1[_0x3e4fa4(0x201)][_0x3e4fa4(0x211)](_0x5c1d9c)&&fs_1[_0x3e4fa4(0x201)][_0x3e4fa4(0x1fa)](_0x5c1d9c,{'recursive':!![]});const _0x1bd322=new Date()[_0x3e4fa4(0x1ec)](),_0x37db76='['+_0x1bd322+']\x20'+_0x4be382+':\x20'+JSON[_0x3e4fa4(0x1df)](_0x3230d9)+'\x0a';try{fs_1[_0x3e4fa4(0x201)]['appendFileSync'](_0x491749,_0x37db76);}catch(_0x33b795){console['error']('Failed\x20to\x20write\x20to\x20request\x20log\x20file:',_0x33b795);}}[a58_0x2874bd(0x1e3)](_0x353c61,_0x423cb3){const _0x3760ea=a58_0x2874bd,_0x5789d7=path_1['default'][_0x3760ea(0x20d)](process[_0x3760ea(0x1f4)](),_0x3760ea(0x203)),_0x57448=path_1[_0x3760ea(0x201)][_0x3760ea(0x20d)](_0x5789d7,'maxpara-responses.log');!fs_1['default'][_0x3760ea(0x211)](_0x5789d7)&&fs_1['default']['mkdirSync'](_0x5789d7,{'recursive':!![]});const _0x55deab=new Date()[_0x3760ea(0x1ec)](),_0xc7065b='['+_0x55deab+']\x20'+_0x353c61+':\x20'+JSON['stringify'](_0x423cb3)+'\x0a';try{fs_1[_0x3760ea(0x201)][_0x3760ea(0x221)](_0x57448,_0xc7065b);}catch(_0x1ed4a5){console[_0x3760ea(0x21b)](_0x3760ea(0x216),_0x1ed4a5);}}async[a58_0x2874bd(0x215)](_0x46740b){const _0x6b44a6=a58_0x2874bd;console['log'](_0x6b44a6(0x20a)+_0x46740b['amount']+'\x20'+_0x46740b[_0x6b44a6(0x1ea)]);try{const _0x1f5e39={'key':this[_0x6b44a6(0x1e9)][_0x6b44a6(0x200)],'username':_0x46740b[_0x6b44a6(0x1fb)],'user_id':_0x46740b[_0x6b44a6(0x217)],'token':_0x46740b['orderId'],'method':_0x6b44a6(0x1fc),'amount':_0x46740b[_0x6b44a6(0x1f7)],'callbackUrl':_0x46740b[_0x6b44a6(0x1fd)]};this['logRequest'](_0x6b44a6(0x1e1),{..._0x1f5e39,'key':_0x6b44a6(0x20b)}),console[_0x6b44a6(0x209)](_0x6b44a6(0x222),{..._0x1f5e39,'key':_0x6b44a6(0x20b)});const _0x1c9ecd=await fetch(this[_0x6b44a6(0x1e9)][_0x6b44a6(0x1f0)]+_0x6b44a6(0x1e1),{'method':'POST','headers':{'Content-Type':_0x6b44a6(0x1eb),'User-Agent':'TrapayUK/1.0'},'body':JSON[_0x6b44a6(0x1df)](_0x1f5e39)});if(!_0x1c9ecd['ok']){const _0x59e375=await _0x1c9ecd[_0x6b44a6(0x21d)]()[_0x6b44a6(0x1ee)](()=>({}));throw new Error(_0x6b44a6(0x205)+_0x1c9ecd[_0x6b44a6(0x1de)]+':\x20'+(_0x59e375[_0x6b44a6(0x1e7)]||_0x6b44a6(0x1f3)));}const _0x2bd7a2=await _0x1c9ecd[_0x6b44a6(0x21d)]();this[_0x6b44a6(0x1e3)]('/api/deposit',_0x2bd7a2),console[_0x6b44a6(0x209)](_0x6b44a6(0x20e),_0x2bd7a2);if(_0x2bd7a2[_0x6b44a6(0x206)]!==0xc8||_0x2bd7a2[_0x6b44a6(0x1de)]!==_0x6b44a6(0x21c))throw new Error('MaxPara\x20API\x20error:\x20'+(_0x2bd7a2[_0x6b44a6(0x1e7)]||_0x6b44a6(0x1e2)));return{'gateway_payment_id':_0x2bd7a2['token'],'payment_url':_0x2bd7a2[_0x6b44a6(0x1dc)],'expires_at':_0x2bd7a2[_0x6b44a6(0x1e0)]};}catch(_0x8f2fee){console[_0x6b44a6(0x21b)](_0x6b44a6(0x208),_0x8f2fee['message']);if(_0x8f2fee[_0x6b44a6(0x1e7)]?.[_0x6b44a6(0x1e8)]('400'))throw new Error(_0x6b44a6(0x21e)+_0x8f2fee[_0x6b44a6(0x1e7)]);else{if(_0x8f2fee[_0x6b44a6(0x1e7)]?.[_0x6b44a6(0x1e8)](_0x6b44a6(0x1f9)))throw new Error('MaxPara\x20authentication\x20failed');else{if(_0x8f2fee[_0x6b44a6(0x1e7)]?.['includes'](_0x6b44a6(0x21a)))throw new Error(_0x6b44a6(0x21f));else throw new Error(_0x6b44a6(0x1e5)+_0x8f2fee['message']);}}}}[a58_0x2874bd(0x1ef)](_0x10b06b){const _0x2fe0ad=a58_0x2874bd;console['log']('üîÑ\x20Processing\x20MaxPara\x20webhook:',_0x10b06b);const _0x944743=_0x10b06b[_0x2fe0ad(0x218)];let _0x414e4f;switch(_0x10b06b[_0x2fe0ad(0x1de)]){case'APPROVED':_0x414e4f='PAID';break;case _0x2fe0ad(0x1dd):_0x414e4f=_0x2fe0ad(0x1ff);break;default:_0x414e4f=_0x2fe0ad(0x213);break;}const _0x92e421={'method':_0x10b06b['method'],'transactionId':_0x10b06b['id']['toString']()};return _0x10b06b[_0x2fe0ad(0x1e7)]&&(_0x92e421['message']=_0x10b06b['message']),console['log'](_0x2fe0ad(0x20c)+_0x944743+_0x2fe0ad(0x204)+_0x414e4f),{'paymentId':_0x944743,'status':_0x414e4f,'additionalInfo':_0x92e421};}[a58_0x2874bd(0x1e4)](_0x2645aa,_0x2424de){const _0x4cb297=a58_0x2874bd;return!!(_0x2645aa['id']&&_0x2645aa[_0x4cb297(0x218)]&&_0x2645aa['status']&&_0x2645aa[_0x4cb297(0x202)]===_0x4cb297(0x20f));}}function a58_0x4c2a(){const _0x558a71=['baseUrl','912735iBTJlH','MaxParaService','Request\x20failed','cwd','4hPdWYP','logRequest','amount','371002SKiLkj','401','mkdirSync','customerName','fast','callbackUrl','3143672CQyEiI','FAILED','apiKey','default','type','logs','\x20->\x20','HTTP\x20','code','defineProperty','‚ùå\x20MaxPara\x20API\x20error:','log','üè¶\x20Creating\x20MaxPara\x20deposit\x20for\x20','HIDDEN','üìä\x20MaxPara\x20webhook\x20processed:\x20','join','üì•\x20MaxPara\x20API\x20response:','DEPOSIT','893480xVKAtr','existsSync','1334007FqqUIf','PENDING','__esModule','createDeposit','Failed\x20to\x20write\x20to\x20response\x20log\x20file:','paymentId','token','__importDefault','500','error','success','json','MaxPara\x20validation\x20error:\x20','MaxPara\x20server\x20error','maxpara-requests.log','appendFileSync','üì§\x20MaxPara\x20API\x20request:','5Zvbxpi','link','DECLINED','status','stringify','expire_date','/api/deposit','Unknown\x20error','logResponse','validateWebhookSignature','MaxPara\x20API\x20error:\x20','5509434XmnWoz','message','includes','config','currency','application/json','toISOString','6304338ImgyQj','catch','processWebhook'];a58_0x4c2a=function(){return _0x558a71;};return a58_0x4c2a();}function a58_0x5240(_0x4f9cdc,_0x4d5d41){_0x4f9cdc=_0x4f9cdc-0x1db;const _0x4c2a52=a58_0x4c2a();let _0x5240e4=_0x4c2a52[_0x4f9cdc];return _0x5240e4;}exports[a58_0x2874bd(0x1f2)]=MaxParaService;