'use strict';const a69_0x5b7581=a69_0x2f8e;(function(_0x145a1b,_0x1f44d8){const _0x489f6e=a69_0x2f8e,_0x58257e=_0x145a1b();while(!![]){try{const _0x536c87=-parseInt(_0x489f6e(0x14b))/0x1*(parseInt(_0x489f6e(0x165))/0x2)+-parseInt(_0x489f6e(0x14d))/0x3+-parseInt(_0x489f6e(0x157))/0x4+-parseInt(_0x489f6e(0x13f))/0x5*(-parseInt(_0x489f6e(0x138))/0x6)+-parseInt(_0x489f6e(0x136))/0x7+parseInt(_0x489f6e(0x146))/0x8+parseInt(_0x489f6e(0x123))/0x9;if(_0x536c87===_0x1f44d8)break;else _0x58257e['push'](_0x58257e['shift']());}catch(_0x4c84e1){_0x58257e['push'](_0x58257e['shift']());}}}(a69_0x4fb3,0x71885));var __importDefault=this&&this[a69_0x5b7581(0x137)]||function(_0x104984){const _0x94cb7b=a69_0x5b7581;return _0x104984&&_0x104984[_0x94cb7b(0x145)]?_0x104984:{'default':_0x104984};};function a69_0x2f8e(_0x2c1d16,_0x328d81){_0x2c1d16=_0x2c1d16-0x122;const _0x4fb349=a69_0x4fb3();let _0x2f8ed1=_0x4fb349[_0x2c1d16];return _0x2f8ed1;}function a69_0x4fb3(){const _0xfd0f05=['stringify','config','ðŸ“¥\x20MaxPara\x20API\x20response:','error','mkdirSync','baseUrl','401','maxpara-requests.log','MaxPara\x20server\x20error','MaxPara\x20validation\x20error:\x20','Request\x20failed','MaxPara\x20authentication\x20failed','Unknown\x20error','orderId','success','type','4871202FdMfeP','__importDefault','72bkHesu','MaxPara\x20API\x20error:\x20','/api/deposit','token','DECLINED','HTTP\x20','apiKey','170410XljebQ','json','appendFileSync','cwd','logResponse','MaxParaService','__esModule','570416KsOTyo','log','processWebhook','defineProperty','400','1fWxpSk','500','1254129qzeKGR','logRequest','Failed\x20to\x20write\x20to\x20request\x20log\x20file:','Failed\x20to\x20write\x20to\x20response\x20log\x20file:','application/json','message','ðŸ“¤\x20MaxPara\x20API\x20request:','FAILED','PAID','APPROVED','2110108eDmzBQ','ðŸ¦\x20Creating\x20MaxPara\x20deposit\x20for\x20','âŒ\x20MaxPara\x20API\x20error:','POST','includes','\x20->\x20','amount','createDeposit','default','ðŸ“Š\x20MaxPara\x20webhook\x20processed:\x20','expire_date','path','status','HIDDEN','818974Qyfbsa','maxpara-responses.log','PENDING','callbackUrl','18321174ZyGlOz','validateWebhookSignature','join'];a69_0x4fb3=function(){return _0xfd0f05;};return a69_0x4fb3();}Object[a69_0x5b7581(0x149)](exports,a69_0x5b7581(0x145),{'value':!![]}),exports['MaxParaService']=void 0x0;const fs_1=__importDefault(require('fs')),path_1=__importDefault(require(a69_0x5b7581(0x162)));class MaxParaService{constructor(_0x5a3684){const _0x5a6ab7=a69_0x5b7581;this[_0x5a6ab7(0x127)]=_0x5a3684;}[a69_0x5b7581(0x14e)](_0x1c9a56,_0x15c9f3){const _0x1f5761=a69_0x5b7581,_0x955bcb=path_1[_0x1f5761(0x15f)][_0x1f5761(0x125)](process[_0x1f5761(0x142)](),'logs'),_0x1940e7=path_1[_0x1f5761(0x15f)][_0x1f5761(0x125)](_0x955bcb,_0x1f5761(0x12d));!fs_1[_0x1f5761(0x15f)]['existsSync'](_0x955bcb)&&fs_1[_0x1f5761(0x15f)][_0x1f5761(0x12a)](_0x955bcb,{'recursive':!![]});const _0x3cc5c1=new Date()['toISOString'](),_0x49154e='['+_0x3cc5c1+']\x20'+_0x1c9a56+':\x20'+JSON[_0x1f5761(0x126)](_0x15c9f3)+'\x0a';try{fs_1[_0x1f5761(0x15f)][_0x1f5761(0x141)](_0x1940e7,_0x49154e);}catch(_0x1658ca){console[_0x1f5761(0x129)](_0x1f5761(0x14f),_0x1658ca);}}[a69_0x5b7581(0x143)](_0x993d2a,_0x53a44b){const _0xfca74b=a69_0x5b7581,_0x3e32a4=path_1['default']['join'](process[_0xfca74b(0x142)](),'logs'),_0x314460=path_1['default'][_0xfca74b(0x125)](_0x3e32a4,_0xfca74b(0x166));!fs_1['default']['existsSync'](_0x3e32a4)&&fs_1[_0xfca74b(0x15f)]['mkdirSync'](_0x3e32a4,{'recursive':!![]});const _0x38af66=new Date()['toISOString'](),_0x209409='['+_0x38af66+']\x20'+_0x993d2a+':\x20'+JSON['stringify'](_0x53a44b)+'\x0a';try{fs_1['default'][_0xfca74b(0x141)](_0x314460,_0x209409);}catch(_0x1d29dc){console[_0xfca74b(0x129)](_0xfca74b(0x150),_0x1d29dc);}}async[a69_0x5b7581(0x15e)](_0x2d9491){const _0x51dd83=a69_0x5b7581;console['log'](_0x51dd83(0x158)+_0x2d9491[_0x51dd83(0x15d)]+'\x20'+_0x2d9491['currency']);try{const _0x33388b={'key':this[_0x51dd83(0x127)][_0x51dd83(0x13e)],'username':_0x2d9491['customerName'],'user_id':_0x2d9491['paymentId'],'token':_0x2d9491[_0x51dd83(0x133)],'method':'fast','amount':_0x2d9491[_0x51dd83(0x15d)],'callbackUrl':_0x2d9491[_0x51dd83(0x122)]};this['logRequest'](_0x51dd83(0x13a),{..._0x33388b,'key':'HIDDEN'}),console['log'](_0x51dd83(0x153),{..._0x33388b,'key':_0x51dd83(0x164)});const _0x726223=await fetch(this[_0x51dd83(0x127)][_0x51dd83(0x12b)]+_0x51dd83(0x13a),{'method':_0x51dd83(0x15a),'headers':{'Content-Type':_0x51dd83(0x151),'User-Agent':'TrapayUK/1.0'},'body':JSON[_0x51dd83(0x126)](_0x33388b)});if(!_0x726223['ok']){const _0x369d96=await _0x726223[_0x51dd83(0x140)]()['catch'](()=>({}));throw new Error(_0x51dd83(0x13d)+_0x726223[_0x51dd83(0x163)]+':\x20'+(_0x369d96[_0x51dd83(0x152)]||_0x51dd83(0x130)));}const _0x22c6bf=await _0x726223[_0x51dd83(0x140)]();this[_0x51dd83(0x143)](_0x51dd83(0x13a),_0x22c6bf),console[_0x51dd83(0x147)](_0x51dd83(0x128),_0x22c6bf);if(_0x22c6bf['code']!==0xc8||_0x22c6bf[_0x51dd83(0x163)]!==_0x51dd83(0x134))throw new Error(_0x51dd83(0x139)+(_0x22c6bf['message']||_0x51dd83(0x132)));return{'gateway_payment_id':_0x22c6bf[_0x51dd83(0x13b)],'payment_url':_0x22c6bf['link'],'expires_at':_0x22c6bf[_0x51dd83(0x161)]};}catch(_0x2f762f){console[_0x51dd83(0x129)](_0x51dd83(0x159),_0x2f762f[_0x51dd83(0x152)]);if(_0x2f762f[_0x51dd83(0x152)]?.[_0x51dd83(0x15b)](_0x51dd83(0x14a)))throw new Error(_0x51dd83(0x12f)+_0x2f762f[_0x51dd83(0x152)]);else{if(_0x2f762f['message']?.[_0x51dd83(0x15b)](_0x51dd83(0x12c)))throw new Error(_0x51dd83(0x131));else{if(_0x2f762f[_0x51dd83(0x152)]?.[_0x51dd83(0x15b)](_0x51dd83(0x14c)))throw new Error(_0x51dd83(0x12e));else throw new Error('MaxPara\x20API\x20error:\x20'+_0x2f762f[_0x51dd83(0x152)]);}}}}[a69_0x5b7581(0x148)](_0x261d20){const _0x3bbb1c=a69_0x5b7581;console['log']('ðŸ”„\x20Processing\x20MaxPara\x20webhook:',_0x261d20);const _0x103204=_0x261d20['token'];let _0x246b0d;switch(_0x261d20[_0x3bbb1c(0x163)]){case _0x3bbb1c(0x156):_0x246b0d=_0x3bbb1c(0x155);break;case _0x3bbb1c(0x13c):_0x246b0d=_0x3bbb1c(0x154);break;default:_0x246b0d=_0x3bbb1c(0x167);break;}const _0x4cc84b={'method':_0x261d20['method'],'transactionId':_0x261d20['id']['toString']()};return _0x261d20[_0x3bbb1c(0x152)]&&(_0x4cc84b[_0x3bbb1c(0x152)]=_0x261d20['message']),console[_0x3bbb1c(0x147)](_0x3bbb1c(0x160)+_0x103204+_0x3bbb1c(0x15c)+_0x246b0d),{'paymentId':_0x103204,'status':_0x246b0d,'additionalInfo':_0x4cc84b};}[a69_0x5b7581(0x124)](_0x56c280,_0x97c058){const _0x3fba83=a69_0x5b7581;return!!(_0x56c280['id']&&_0x56c280[_0x3fba83(0x13b)]&&_0x56c280[_0x3fba83(0x163)]&&_0x56c280[_0x3fba83(0x135)]==='DEPOSIT');}}exports[a69_0x5b7581(0x144)]=MaxParaService;