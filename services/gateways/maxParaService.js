'use strict';function a69_0x3133(){const _0x151635=['APPROVED','ðŸ”„\x20Processing\x20MaxPara\x20webhook:','TrapayUK/1.0','processWebhook','36636IVsjlT','status','method','Unknown\x20error','70802ZwcxvQ','Failed\x20to\x20write\x20to\x20request\x20log\x20file:','code','PENDING','join','path','message','14NCDLBF','HIDDEN','appendFileSync','error','config','createDeposit','toString','2873zgOTIf','DEPOSIT','cwd','PAID','callbackUrl','ðŸ“¤\x20MaxPara\x20API\x20request:','type','MaxPara\x20server\x20error','16bMqnZz','token','453mddVCx','46812cwNRoT','catch','MaxPara\x20API\x20error:\x20','fast','ðŸ¦\x20Creating\x20MaxPara\x20deposit\x20for\x20','401','__esModule','POST','json','validateWebhookSignature','ðŸ“Š\x20MaxPara\x20webhook\x20processed:\x20','logRequest','MaxPara\x20validation\x20error:\x20','FAILED','mkdirSync','existsSync','ðŸ“¥\x20MaxPara\x20API\x20response:','default','maxpara-responses.log','includes','1474vQEsIi','76700kkhPTi','4332JuRpUK','MaxPara\x20authentication\x20failed','toISOString','log','Failed\x20to\x20write\x20to\x20response\x20log\x20file:','amount','9275lHLbyn','1183784EWvLih','HTTP\x20','MaxParaService','/api/deposit','application/json','1322901Jzsigd','stringify','logs'];a69_0x3133=function(){return _0x151635;};return a69_0x3133();}const a69_0x517441=a69_0x2c10;function a69_0x2c10(_0x51eaf3,_0x18a672){_0x51eaf3=_0x51eaf3-0xda;const _0x313301=a69_0x3133();let _0x2c1088=_0x313301[_0x51eaf3];return _0x2c1088;}(function(_0x44d303,_0x3d3b36){const _0x22ee5e=a69_0x2c10,_0x4287d2=_0x44d303();while(!![]){try{const _0x5d2541=parseInt(_0x22ee5e(0x110))/0x1*(parseInt(_0x22ee5e(0x117))/0x2)+-parseInt(_0x22ee5e(0xe2))/0x3*(-parseInt(_0x22ee5e(0x10c))/0x4)+-parseInt(_0x22ee5e(0xff))/0x5*(parseInt(_0x22ee5e(0xf9))/0x6)+-parseInt(_0x22ee5e(0x100))/0x7+-parseInt(_0x22ee5e(0xe0))/0x8*(-parseInt(_0x22ee5e(0x105))/0x9)+-parseInt(_0x22ee5e(0xf8))/0xa*(-parseInt(_0x22ee5e(0xf7))/0xb)+-parseInt(_0x22ee5e(0xe3))/0xc*(parseInt(_0x22ee5e(0x11e))/0xd);if(_0x5d2541===_0x3d3b36)break;else _0x4287d2['push'](_0x4287d2['shift']());}catch(_0x338139){_0x4287d2['push'](_0x4287d2['shift']());}}}(a69_0x3133,0xca98e));var __importDefault=this&&this['__importDefault']||function(_0x11a25b){return _0x11a25b&&_0x11a25b['__esModule']?_0x11a25b:{'default':_0x11a25b};};Object['defineProperty'](exports,a69_0x517441(0xe9),{'value':!![]}),exports[a69_0x517441(0x102)]=void 0x0;const fs_1=__importDefault(require('fs')),path_1=__importDefault(require(a69_0x517441(0x115)));class MaxParaService{constructor(_0x255861){this['config']=_0x255861;}[a69_0x517441(0xee)](_0x21809c,_0xbde39d){const _0x51c411=a69_0x517441,_0x22ddab=path_1['default'][_0x51c411(0x114)](process[_0x51c411(0xda)](),_0x51c411(0x107)),_0x6cbd81=path_1['default'][_0x51c411(0x114)](_0x22ddab,'maxpara-requests.log');!fs_1[_0x51c411(0xf4)][_0x51c411(0xf2)](_0x22ddab)&&fs_1[_0x51c411(0xf4)][_0x51c411(0xf1)](_0x22ddab,{'recursive':!![]});const _0x401bf0=new Date()[_0x51c411(0xfb)](),_0x1f0d9c='['+_0x401bf0+']\x20'+_0x21809c+':\x20'+JSON[_0x51c411(0x106)](_0xbde39d)+'\x0a';try{fs_1[_0x51c411(0xf4)]['appendFileSync'](_0x6cbd81,_0x1f0d9c);}catch(_0x124c8b){console[_0x51c411(0x11a)](_0x51c411(0x111),_0x124c8b);}}['logResponse'](_0x57785e,_0x4ac294){const _0x3f3298=a69_0x517441,_0xe8552b=path_1[_0x3f3298(0xf4)][_0x3f3298(0x114)](process[_0x3f3298(0xda)](),_0x3f3298(0x107)),_0x62f49=path_1[_0x3f3298(0xf4)][_0x3f3298(0x114)](_0xe8552b,_0x3f3298(0xf5));!fs_1['default'][_0x3f3298(0xf2)](_0xe8552b)&&fs_1[_0x3f3298(0xf4)]['mkdirSync'](_0xe8552b,{'recursive':!![]});const _0x41c075=new Date()[_0x3f3298(0xfb)](),_0x2b3c39='['+_0x41c075+']\x20'+_0x57785e+':\x20'+JSON['stringify'](_0x4ac294)+'\x0a';try{fs_1[_0x3f3298(0xf4)][_0x3f3298(0x119)](_0x62f49,_0x2b3c39);}catch(_0x1addb8){console[_0x3f3298(0x11a)](_0x3f3298(0xfd),_0x1addb8);}}async[a69_0x517441(0x11c)](_0xc600ef){const _0x7b09ab=a69_0x517441;console[_0x7b09ab(0xfc)](_0x7b09ab(0xe7)+_0xc600ef['amount']+'\x20'+_0xc600ef['currency']);try{const _0x466217={'key':this[_0x7b09ab(0x11b)]['apiKey'],'username':_0xc600ef['customerName'],'user_id':_0xc600ef['paymentId'],'token':_0xc600ef['orderId'],'method':_0x7b09ab(0xe6),'amount':_0xc600ef[_0x7b09ab(0xfe)],'callbackUrl':_0xc600ef[_0x7b09ab(0xdc)]};this[_0x7b09ab(0xee)](_0x7b09ab(0x103),{..._0x466217,'key':_0x7b09ab(0x118)}),console[_0x7b09ab(0xfc)](_0x7b09ab(0xdd),{..._0x466217,'key':_0x7b09ab(0x118)});const _0x37fe82=await fetch(this[_0x7b09ab(0x11b)]['baseUrl']+_0x7b09ab(0x103),{'method':_0x7b09ab(0xea),'headers':{'Content-Type':_0x7b09ab(0x104),'User-Agent':_0x7b09ab(0x10a)},'body':JSON[_0x7b09ab(0x106)](_0x466217)});if(!_0x37fe82['ok']){const _0x419cd5=await _0x37fe82['json']()[_0x7b09ab(0xe4)](()=>({}));throw new Error(_0x7b09ab(0x101)+_0x37fe82[_0x7b09ab(0x10d)]+':\x20'+(_0x419cd5[_0x7b09ab(0x116)]||'Request\x20failed'));}const _0x1e26cf=await _0x37fe82[_0x7b09ab(0xeb)]();this['logResponse'](_0x7b09ab(0x103),_0x1e26cf),console[_0x7b09ab(0xfc)](_0x7b09ab(0xf3),_0x1e26cf);if(_0x1e26cf[_0x7b09ab(0x112)]!==0xc8||_0x1e26cf[_0x7b09ab(0x10d)]!=='success')throw new Error(_0x7b09ab(0xe5)+(_0x1e26cf['message']||_0x7b09ab(0x10f)));return{'gateway_payment_id':_0x1e26cf['token'],'payment_url':_0x1e26cf['link'],'expires_at':_0x1e26cf['expire_date']};}catch(_0x52e0f0){console[_0x7b09ab(0x11a)]('âŒ\x20MaxPara\x20API\x20error:',_0x52e0f0[_0x7b09ab(0x116)]);if(_0x52e0f0['message']?.[_0x7b09ab(0xf6)]('400'))throw new Error(_0x7b09ab(0xef)+_0x52e0f0['message']);else{if(_0x52e0f0['message']?.['includes'](_0x7b09ab(0xe8)))throw new Error(_0x7b09ab(0xfa));else{if(_0x52e0f0['message']?.[_0x7b09ab(0xf6)]('500'))throw new Error(_0x7b09ab(0xdf));else throw new Error(_0x7b09ab(0xe5)+_0x52e0f0[_0x7b09ab(0x116)]);}}}}[a69_0x517441(0x10b)](_0x538ad1){const _0x4398a7=a69_0x517441;console[_0x4398a7(0xfc)](_0x4398a7(0x109),_0x538ad1);const _0x27a62f=_0x538ad1[_0x4398a7(0xe1)];let _0x3d747d;switch(_0x538ad1[_0x4398a7(0x10d)]){case _0x4398a7(0x108):_0x3d747d=_0x4398a7(0xdb);break;case'DECLINED':_0x3d747d=_0x4398a7(0xf0);break;default:_0x3d747d=_0x4398a7(0x113);break;}const _0x4fd50b={'method':_0x538ad1[_0x4398a7(0x10e)],'transactionId':_0x538ad1['id'][_0x4398a7(0x11d)]()};return _0x538ad1[_0x4398a7(0x116)]&&(_0x4fd50b[_0x4398a7(0x116)]=_0x538ad1['message']),console[_0x4398a7(0xfc)](_0x4398a7(0xed)+_0x27a62f+'\x20->\x20'+_0x3d747d),{'paymentId':_0x27a62f,'status':_0x3d747d,'additionalInfo':_0x4fd50b};}[a69_0x517441(0xec)](_0x404878,_0x17c795){const _0x4e85cb=a69_0x517441;return!!(_0x404878['id']&&_0x404878[_0x4e85cb(0xe1)]&&_0x404878[_0x4e85cb(0x10d)]&&_0x404878[_0x4e85cb(0xde)]===_0x4e85cb(0x11f));}}exports['MaxParaService']=MaxParaService;