'use strict';function a65_0xf627(_0x4d26ff,_0x4e4d35){_0x4d26ff=_0x4d26ff-0x77;const _0x3f7a85=a65_0x3f7a();let _0xf62770=_0x3f7a85[_0x4d26ff];return _0xf62770;}const a65_0x1067e1=a65_0xf627;function a65_0x3f7a(){const _0x201789=['default','status','logResponse','stringify','fast','amount','üè¶\x20Creating\x20MaxPara\x20deposit\x20for\x20','createDeposit','DEPOSIT','__esModule','success','/api/deposit','Request\x20failed','message','651411FwTBuI','path','application/json','baseUrl','existsSync','customerName','401','1571187kOaemd','MaxPara\x20API\x20error:\x20','Unknown\x20error','json','2189327UBJnSY','defineProperty','1034ztwzxw','500','link','maxpara-responses.log','paymentId','log','656KRgKuA','Failed\x20to\x20write\x20to\x20response\x20log\x20file:','APPROVED','toISOString','cwd','4672096GOeZRd','code','DECLINED','appendFileSync','\x20->\x20','Failed\x20to\x20write\x20to\x20request\x20log\x20file:','join','POST','PENDING','__importDefault','400','MaxPara\x20server\x20error','1797378SYGwpe','orderId','config','maxpara-requests.log','MaxPara\x20authentication\x20failed','2913365BuraqW','method','error','MaxParaService','expire_date','üìä\x20MaxPara\x20webhook\x20processed:\x20','üì•\x20MaxPara\x20API\x20response:','logRequest','HTTP\x20','token','logs','216RfqjqF','mkdirSync','catch','includes','TrapayUK/1.0'];a65_0x3f7a=function(){return _0x201789;};return a65_0x3f7a();}(function(_0x340d20,_0x20b3bd){const _0x3cf052=a65_0xf627,_0x311a6f=_0x340d20();while(!![]){try{const _0x2674f7=parseInt(_0x3cf052(0x99))/0x1*(parseInt(_0x3cf052(0x9f))/0x2)+parseInt(_0x3cf052(0x93))/0x3+parseInt(_0x3cf052(0xa4))/0x4+parseInt(_0x3cf052(0xb5))/0x5+-parseInt(_0x3cf052(0xb0))/0x6+parseInt(_0x3cf052(0x97))/0x7+parseInt(_0x3cf052(0x79))/0x8*(-parseInt(_0x3cf052(0x8c))/0x9);if(_0x2674f7===_0x20b3bd)break;else _0x311a6f['push'](_0x311a6f['shift']());}catch(_0x42c826){_0x311a6f['push'](_0x311a6f['shift']());}}}(a65_0x3f7a,0xa431f));var __importDefault=this&&this[a65_0x1067e1(0xad)]||function(_0x445952){const _0x43862e=a65_0x1067e1;return _0x445952&&_0x445952[_0x43862e(0x87)]?_0x445952:{'default':_0x445952};};Object[a65_0x1067e1(0x98)](exports,a65_0x1067e1(0x87),{'value':!![]}),exports[a65_0x1067e1(0xb8)]=void 0x0;const fs_1=__importDefault(require('fs')),path_1=__importDefault(require(a65_0x1067e1(0x8d)));class MaxParaService{constructor(_0x478c94){const _0x2662c2=a65_0x1067e1;this[_0x2662c2(0xb2)]=_0x478c94;}['logRequest'](_0x4d7564,_0x350b9d){const _0x2607f0=a65_0x1067e1,_0x574830=path_1[_0x2607f0(0x7e)][_0x2607f0(0xaa)](process[_0x2607f0(0xa3)](),_0x2607f0(0x78)),_0x190034=path_1[_0x2607f0(0x7e)]['join'](_0x574830,_0x2607f0(0xb3));!fs_1[_0x2607f0(0x7e)][_0x2607f0(0x90)](_0x574830)&&fs_1[_0x2607f0(0x7e)][_0x2607f0(0x7a)](_0x574830,{'recursive':!![]});const _0x15fca1=new Date()[_0x2607f0(0xa2)](),_0x4967be='['+_0x15fca1+']\x20'+_0x4d7564+':\x20'+JSON[_0x2607f0(0x81)](_0x350b9d)+'\x0a';try{fs_1[_0x2607f0(0x7e)]['appendFileSync'](_0x190034,_0x4967be);}catch(_0x4cb6ef){console['error'](_0x2607f0(0xa9),_0x4cb6ef);}}[a65_0x1067e1(0x80)](_0x163415,_0x1df912){const _0x4316a8=a65_0x1067e1,_0x2b6909=path_1[_0x4316a8(0x7e)][_0x4316a8(0xaa)](process['cwd'](),_0x4316a8(0x78)),_0x1b73c9=path_1['default'][_0x4316a8(0xaa)](_0x2b6909,_0x4316a8(0x9c));!fs_1[_0x4316a8(0x7e)][_0x4316a8(0x90)](_0x2b6909)&&fs_1[_0x4316a8(0x7e)][_0x4316a8(0x7a)](_0x2b6909,{'recursive':!![]});const _0xc47e25=new Date()[_0x4316a8(0xa2)](),_0xe717d9='['+_0xc47e25+']\x20'+_0x163415+':\x20'+JSON[_0x4316a8(0x81)](_0x1df912)+'\x0a';try{fs_1[_0x4316a8(0x7e)][_0x4316a8(0xa7)](_0x1b73c9,_0xe717d9);}catch(_0x3de149){console['error'](_0x4316a8(0xa0),_0x3de149);}}async[a65_0x1067e1(0x85)](_0x9cdd2a){const _0x314da1=a65_0x1067e1;console[_0x314da1(0x9e)](_0x314da1(0x84)+_0x9cdd2a[_0x314da1(0x83)]+'\x20'+_0x9cdd2a['currency']);try{const _0x5c6abd={'key':this[_0x314da1(0xb2)]['apiKey'],'username':_0x9cdd2a[_0x314da1(0x91)],'user_id':_0x9cdd2a[_0x314da1(0x9d)],'token':_0x9cdd2a[_0x314da1(0xb1)],'method':_0x314da1(0x82),'amount':_0x9cdd2a[_0x314da1(0x83)],'callbackUrl':_0x9cdd2a['callbackUrl']};this[_0x314da1(0xbc)](_0x314da1(0x89),{..._0x5c6abd,'key':'HIDDEN'}),console[_0x314da1(0x9e)]('üì§\x20MaxPara\x20API\x20request:',{..._0x5c6abd,'key':'HIDDEN'});const _0x27259c=await fetch(this[_0x314da1(0xb2)][_0x314da1(0x8f)]+_0x314da1(0x89),{'method':_0x314da1(0xab),'headers':{'Content-Type':_0x314da1(0x8e),'User-Agent':_0x314da1(0x7d)},'body':JSON[_0x314da1(0x81)](_0x5c6abd)});if(!_0x27259c['ok']){const _0x365da2=await _0x27259c[_0x314da1(0x96)]()[_0x314da1(0x7b)](()=>({}));throw new Error(_0x314da1(0xbd)+_0x27259c[_0x314da1(0x7f)]+':\x20'+(_0x365da2[_0x314da1(0x8b)]||_0x314da1(0x8a)));}const _0x18f103=await _0x27259c[_0x314da1(0x96)]();this[_0x314da1(0x80)]('/api/deposit',_0x18f103),console[_0x314da1(0x9e)](_0x314da1(0xbb),_0x18f103);if(_0x18f103[_0x314da1(0xa5)]!==0xc8||_0x18f103[_0x314da1(0x7f)]!==_0x314da1(0x88))throw new Error('MaxPara\x20API\x20error:\x20'+(_0x18f103[_0x314da1(0x8b)]||_0x314da1(0x95)));return{'gateway_payment_id':_0x18f103['token'],'payment_url':_0x18f103[_0x314da1(0x9b)],'expires_at':_0x18f103[_0x314da1(0xb9)]};}catch(_0xefd321){console[_0x314da1(0xb7)]('‚ùå\x20MaxPara\x20API\x20error:',_0xefd321[_0x314da1(0x8b)]);if(_0xefd321[_0x314da1(0x8b)]?.['includes'](_0x314da1(0xae)))throw new Error('MaxPara\x20validation\x20error:\x20'+_0xefd321['message']);else{if(_0xefd321[_0x314da1(0x8b)]?.[_0x314da1(0x7c)](_0x314da1(0x92)))throw new Error(_0x314da1(0xb4));else{if(_0xefd321['message']?.['includes'](_0x314da1(0x9a)))throw new Error(_0x314da1(0xaf));else throw new Error(_0x314da1(0x94)+_0xefd321[_0x314da1(0x8b)]);}}}}['processWebhook'](_0x4e95bd){const _0x2843cb=a65_0x1067e1;console[_0x2843cb(0x9e)]('üîÑ\x20Processing\x20MaxPara\x20webhook:',_0x4e95bd);const _0x4b8e24=_0x4e95bd[_0x2843cb(0x77)];let _0x24c8f6;switch(_0x4e95bd[_0x2843cb(0x7f)]){case _0x2843cb(0xa1):_0x24c8f6='PAID';break;case _0x2843cb(0xa6):_0x24c8f6='FAILED';break;default:_0x24c8f6=_0x2843cb(0xac);break;}const _0x36cfe8={'method':_0x4e95bd[_0x2843cb(0xb6)],'transactionId':_0x4e95bd['id']['toString']()};return _0x4e95bd['message']&&(_0x36cfe8[_0x2843cb(0x8b)]=_0x4e95bd['message']),console[_0x2843cb(0x9e)](_0x2843cb(0xba)+_0x4b8e24+_0x2843cb(0xa8)+_0x24c8f6),{'paymentId':_0x4b8e24,'status':_0x24c8f6,'additionalInfo':_0x36cfe8};}['validateWebhookSignature'](_0x2cb4f8,_0x19e7f2){const _0xb5e037=a65_0x1067e1;return!!(_0x2cb4f8['id']&&_0x2cb4f8[_0xb5e037(0x77)]&&_0x2cb4f8[_0xb5e037(0x7f)]&&_0x2cb4f8['type']===_0xb5e037(0x86));}}exports[a65_0x1067e1(0xb8)]=MaxParaService;