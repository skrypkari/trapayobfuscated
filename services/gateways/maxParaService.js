'use strict';const a58_0x2aec85=a58_0x441f;(function(_0x4966c1,_0x3ecdf0){const _0x473b34=a58_0x441f,_0x1a36ea=_0x4966c1();while(!![]){try{const _0x197da4=-parseInt(_0x473b34(0x7d))/0x1*(parseInt(_0x473b34(0xac))/0x2)+parseInt(_0x473b34(0x9c))/0x3*(-parseInt(_0x473b34(0x7c))/0x4)+-parseInt(_0x473b34(0xc1))/0x5*(-parseInt(_0x473b34(0x8d))/0x6)+parseInt(_0x473b34(0x97))/0x7*(-parseInt(_0x473b34(0x93))/0x8)+-parseInt(_0x473b34(0xa2))/0x9+parseInt(_0x473b34(0xbc))/0xa*(parseInt(_0x473b34(0xb0))/0xb)+-parseInt(_0x473b34(0x95))/0xc*(-parseInt(_0x473b34(0x80))/0xd);if(_0x197da4===_0x3ecdf0)break;else _0x1a36ea['push'](_0x1a36ea['shift']());}catch(_0x37a870){_0x1a36ea['push'](_0x1a36ea['shift']());}}}(a58_0x5332,0x83675));var __importDefault=this&&this[a58_0x2aec85(0xa6)]||function(_0x4dcf97){const _0x57de04=a58_0x2aec85;return _0x4dcf97&&_0x4dcf97[_0x57de04(0x7b)]?_0x4dcf97:{'default':_0x4dcf97};};Object['defineProperty'](exports,'__esModule',{'value':!![]}),exports[a58_0x2aec85(0x7f)]=void 0x0;function a58_0x441f(_0x8402f2,_0xcac3fd){_0x8402f2=_0x8402f2-0x78;const _0x533241=a58_0x5332();let _0x441f0a=_0x533241[_0x8402f2];return _0x441f0a;}const fs_1=__importDefault(require('fs')),path_1=__importDefault(require(a58_0x2aec85(0x89)));function a58_0x5332(){const _0xd34273=['customerName','currency','ðŸ“Š\x20MaxPara\x20webhook\x20processed:\x20','FAILED','message','7108fhQiUD','POST','default','code','6611rqAaHp','PAID','cwd','HIDDEN','Failed\x20to\x20write\x20to\x20response\x20log\x20file:','toString','ðŸ“¤\x20MaxPara\x20API\x20request:','Failed\x20to\x20write\x20to\x20request\x20log\x20file:','error','status','MaxPara\x20server\x20error','Request\x20failed','5660xdbCTr','DECLINED','config','expire_date','logResponse','5yeeUsh','apiKey','json','logs','TrapayUK/1.0','__esModule','128NDUjTA','63YfUylQ','validateWebhookSignature','MaxParaService','7501oIpwKd','maxpara-responses.log','mkdirSync','Unknown\x20error','success','stringify','log','orderId','callbackUrl','path','MaxPara\x20authentication\x20failed','400','401','2989284BvkeaV','ðŸ“¥\x20MaxPara\x20API\x20response:','toISOString','HTTP\x20','500','ðŸ¦\x20Creating\x20MaxPara\x20deposit\x20for\x20','2936nMHhEA','MaxPara\x20API\x20error:\x20','18084UlCLfl','includes','112Carxim','token','join','existsSync','amount','39378dbfAgN','link','application/json','MaxPara\x20validation\x20error:\x20','\x20->\x20','/api/deposit','4678956SsUoaB','âŒ\x20MaxPara\x20API\x20error:','appendFileSync','method','__importDefault'];a58_0x5332=function(){return _0xd34273;};return a58_0x5332();}class MaxParaService{constructor(_0x1a2665){this['config']=_0x1a2665;}['logRequest'](_0x21b75a,_0x55630e){const _0x55a03b=a58_0x2aec85,_0x25260e=path_1['default'][_0x55a03b(0x99)](process[_0x55a03b(0xb2)](),_0x55a03b(0x79)),_0x1ad7be=path_1[_0x55a03b(0xae)]['join'](_0x25260e,'maxpara-requests.log');!fs_1[_0x55a03b(0xae)][_0x55a03b(0x9a)](_0x25260e)&&fs_1[_0x55a03b(0xae)][_0x55a03b(0x82)](_0x25260e,{'recursive':!![]});const _0x1820f3=new Date()[_0x55a03b(0x8f)](),_0x1b2fec='['+_0x1820f3+']\x20'+_0x21b75a+':\x20'+JSON[_0x55a03b(0x85)](_0x55630e)+'\x0a';try{fs_1[_0x55a03b(0xae)][_0x55a03b(0xa4)](_0x1ad7be,_0x1b2fec);}catch(_0xf1f113){console['error'](_0x55a03b(0xb7),_0xf1f113);}}[a58_0x2aec85(0xc0)](_0x22b6d6,_0x8acb72){const _0x76c41d=a58_0x2aec85,_0x56023b=path_1[_0x76c41d(0xae)][_0x76c41d(0x99)](process[_0x76c41d(0xb2)](),'logs'),_0x384eca=path_1[_0x76c41d(0xae)][_0x76c41d(0x99)](_0x56023b,_0x76c41d(0x81));!fs_1[_0x76c41d(0xae)][_0x76c41d(0x9a)](_0x56023b)&&fs_1[_0x76c41d(0xae)][_0x76c41d(0x82)](_0x56023b,{'recursive':!![]});const _0x561d37=new Date()[_0x76c41d(0x8f)](),_0x3bf39d='['+_0x561d37+']\x20'+_0x22b6d6+':\x20'+JSON[_0x76c41d(0x85)](_0x8acb72)+'\x0a';try{fs_1[_0x76c41d(0xae)][_0x76c41d(0xa4)](_0x384eca,_0x3bf39d);}catch(_0x23dca3){console[_0x76c41d(0xb8)](_0x76c41d(0xb4),_0x23dca3);}}async['createDeposit'](_0x9d5365){const _0x3656c4=a58_0x2aec85;console[_0x3656c4(0x86)](_0x3656c4(0x92)+_0x9d5365[_0x3656c4(0x9b)]+'\x20'+_0x9d5365[_0x3656c4(0xa8)]);try{const _0x4dac8b={'key':this[_0x3656c4(0xbe)][_0x3656c4(0xc2)],'username':_0x9d5365[_0x3656c4(0xa7)],'user_id':_0x9d5365['paymentId'],'token':_0x9d5365[_0x3656c4(0x87)],'method':'fast','amount':_0x9d5365['amount'],'callbackUrl':_0x9d5365[_0x3656c4(0x88)]};this['logRequest']('/api/deposit',{..._0x4dac8b,'key':_0x3656c4(0xb3)}),console[_0x3656c4(0x86)](_0x3656c4(0xb6),{..._0x4dac8b,'key':_0x3656c4(0xb3)});const _0x5d9aa5=await fetch(this[_0x3656c4(0xbe)]['baseUrl']+_0x3656c4(0xa1),{'method':_0x3656c4(0xad),'headers':{'Content-Type':_0x3656c4(0x9e),'User-Agent':_0x3656c4(0x7a)},'body':JSON[_0x3656c4(0x85)](_0x4dac8b)});if(!_0x5d9aa5['ok']){const _0x24ff78=await _0x5d9aa5[_0x3656c4(0x78)]()['catch'](()=>({}));throw new Error(_0x3656c4(0x90)+_0x5d9aa5[_0x3656c4(0xb9)]+':\x20'+(_0x24ff78[_0x3656c4(0xab)]||_0x3656c4(0xbb)));}const _0x2fb5d3=await _0x5d9aa5[_0x3656c4(0x78)]();this[_0x3656c4(0xc0)]('/api/deposit',_0x2fb5d3),console[_0x3656c4(0x86)](_0x3656c4(0x8e),_0x2fb5d3);if(_0x2fb5d3[_0x3656c4(0xaf)]!==0xc8||_0x2fb5d3[_0x3656c4(0xb9)]!==_0x3656c4(0x84))throw new Error(_0x3656c4(0x94)+(_0x2fb5d3[_0x3656c4(0xab)]||_0x3656c4(0x83)));return{'gateway_payment_id':_0x2fb5d3['token'],'payment_url':_0x2fb5d3[_0x3656c4(0x9d)],'expires_at':_0x2fb5d3[_0x3656c4(0xbf)]};}catch(_0x25ec8c){console[_0x3656c4(0xb8)](_0x3656c4(0xa3),_0x25ec8c[_0x3656c4(0xab)]);if(_0x25ec8c[_0x3656c4(0xab)]?.[_0x3656c4(0x96)](_0x3656c4(0x8b)))throw new Error(_0x3656c4(0x9f)+_0x25ec8c[_0x3656c4(0xab)]);else{if(_0x25ec8c[_0x3656c4(0xab)]?.['includes'](_0x3656c4(0x8c)))throw new Error(_0x3656c4(0x8a));else{if(_0x25ec8c['message']?.[_0x3656c4(0x96)](_0x3656c4(0x91)))throw new Error(_0x3656c4(0xba));else throw new Error('MaxPara\x20API\x20error:\x20'+_0x25ec8c[_0x3656c4(0xab)]);}}}}['processWebhook'](_0x22f9f8){const _0x4caaf1=a58_0x2aec85;console[_0x4caaf1(0x86)]('ðŸ”„\x20Processing\x20MaxPara\x20webhook:',_0x22f9f8);const _0x279ec4=_0x22f9f8[_0x4caaf1(0x98)];let _0x155d2f;switch(_0x22f9f8[_0x4caaf1(0xb9)]){case'APPROVED':_0x155d2f=_0x4caaf1(0xb1);break;case _0x4caaf1(0xbd):_0x155d2f=_0x4caaf1(0xaa);break;default:_0x155d2f='PENDING';break;}const _0x44673e={'method':_0x22f9f8[_0x4caaf1(0xa5)],'transactionId':_0x22f9f8['id'][_0x4caaf1(0xb5)]()};return _0x22f9f8[_0x4caaf1(0xab)]&&(_0x44673e[_0x4caaf1(0xab)]=_0x22f9f8[_0x4caaf1(0xab)]),console[_0x4caaf1(0x86)](_0x4caaf1(0xa9)+_0x279ec4+_0x4caaf1(0xa0)+_0x155d2f),{'paymentId':_0x279ec4,'status':_0x155d2f,'additionalInfo':_0x44673e};}[a58_0x2aec85(0x7e)](_0x4dbc4a,_0x2cb69c){const _0x3cf366=a58_0x2aec85;return!!(_0x4dbc4a['id']&&_0x4dbc4a[_0x3cf366(0x98)]&&_0x4dbc4a[_0x3cf366(0xb9)]&&_0x4dbc4a['type']==='DEPOSIT');}}exports[a58_0x2aec85(0x7f)]=MaxParaService;