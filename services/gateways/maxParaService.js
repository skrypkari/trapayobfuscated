'use strict';const a58_0x59fa16=a58_0x269e;function a58_0x269e(_0x4e454c,_0x29a129){_0x4e454c=_0x4e454c-0x11a;const _0x343d39=a58_0x343d();let _0x269ec4=_0x343d39[_0x4e454c];return _0x269ec4;}(function(_0x3dd670,_0x4035aa){const _0x44f64a=a58_0x269e,_0x4edfed=_0x3dd670();while(!![]){try{const _0x5153d4=-parseInt(_0x44f64a(0x13b))/0x1*(-parseInt(_0x44f64a(0x15e))/0x2)+-parseInt(_0x44f64a(0x14a))/0x3*(parseInt(_0x44f64a(0x136))/0x4)+parseInt(_0x44f64a(0x13c))/0x5*(-parseInt(_0x44f64a(0x164))/0x6)+-parseInt(_0x44f64a(0x14c))/0x7+parseInt(_0x44f64a(0x12e))/0x8*(parseInt(_0x44f64a(0x15d))/0x9)+parseInt(_0x44f64a(0x12d))/0xa+-parseInt(_0x44f64a(0x13e))/0xb;if(_0x5153d4===_0x4035aa)break;else _0x4edfed['push'](_0x4edfed['shift']());}catch(_0x1763c3){_0x4edfed['push'](_0x4edfed['shift']());}}}(a58_0x343d,0xdd9a9));function a58_0x343d(){const _0x3c74a3=['5339096iIFGfQ','validateWebhookSignature','config','logs','ðŸ“¤\x20MaxPara\x20API\x20request:','\x20->\x20','logRequest','maxpara-responses.log','4hcvxFp','HTTP\x20','ðŸ“Š\x20MaxPara\x20webhook\x20processed:\x20','catch','MaxParaService','133dHIDxA','2935YXLUun','defineProperty','979979UOwQKq','401','createDeposit','MaxPara\x20API\x20error:\x20','orderId','PENDING','POST','PAID','currency','join','amount','log','752829hAkyZr','json','7622230HibMFU','HIDDEN','processWebhook','toISOString','expire_date','DECLINED','method','TrapayUK/1.0','Request\x20failed','MaxPara\x20server\x20error','fast','DEPOSIT','Unknown\x20error','/api/deposit','ðŸ”„\x20Processing\x20MaxPara\x20webhook:','MaxPara\x20authentication\x20failed','ðŸ“¥\x20MaxPara\x20API\x20response:','9vsPxhL','22424YRqyQE','__esModule','message','mkdirSync','__importDefault','status','1134rhjmsq','MaxPara\x20validation\x20error:\x20','default','âŒ\x20MaxPara\x20API\x20error:','apiKey','token','toString','maxpara-requests.log','callbackUrl','ðŸ¦\x20Creating\x20MaxPara\x20deposit\x20for\x20','appendFileSync','code','500','FAILED','error','includes','stringify','logResponse','cwd','paymentId','type','existsSync','2889710lPNxHa'];a58_0x343d=function(){return _0x3c74a3;};return a58_0x343d();}var __importDefault=this&&this[a58_0x59fa16(0x162)]||function(_0x26923b){const _0x25bdd2=a58_0x59fa16;return _0x26923b&&_0x26923b[_0x25bdd2(0x15f)]?_0x26923b:{'default':_0x26923b};};Object[a58_0x59fa16(0x13d)](exports,a58_0x59fa16(0x15f),{'value':!![]}),exports[a58_0x59fa16(0x13a)]=void 0x0;const fs_1=__importDefault(require('fs')),path_1=__importDefault(require('path'));class MaxParaService{constructor(_0x2c7c50){this['config']=_0x2c7c50;}[a58_0x59fa16(0x134)](_0x43694e,_0xd8f22b){const _0x111f7a=a58_0x59fa16,_0x444f08=path_1[_0x111f7a(0x166)][_0x111f7a(0x147)](process[_0x111f7a(0x129)](),_0x111f7a(0x131)),_0x406e6f=path_1['default'][_0x111f7a(0x147)](_0x444f08,_0x111f7a(0x11e));!fs_1[_0x111f7a(0x166)][_0x111f7a(0x12c)](_0x444f08)&&fs_1['default'][_0x111f7a(0x161)](_0x444f08,{'recursive':!![]});const _0x76723e=new Date()['toISOString'](),_0x24d780='['+_0x76723e+']\x20'+_0x43694e+':\x20'+JSON[_0x111f7a(0x127)](_0xd8f22b)+'\x0a';try{fs_1[_0x111f7a(0x166)][_0x111f7a(0x121)](_0x406e6f,_0x24d780);}catch(_0x3f0e14){console[_0x111f7a(0x125)]('Failed\x20to\x20write\x20to\x20request\x20log\x20file:',_0x3f0e14);}}[a58_0x59fa16(0x128)](_0x186c1f,_0x298795){const _0x54fe0c=a58_0x59fa16,_0x26cedd=path_1[_0x54fe0c(0x166)][_0x54fe0c(0x147)](process[_0x54fe0c(0x129)](),_0x54fe0c(0x131)),_0x3cb5c2=path_1[_0x54fe0c(0x166)][_0x54fe0c(0x147)](_0x26cedd,_0x54fe0c(0x135));!fs_1[_0x54fe0c(0x166)][_0x54fe0c(0x12c)](_0x26cedd)&&fs_1[_0x54fe0c(0x166)][_0x54fe0c(0x161)](_0x26cedd,{'recursive':!![]});const _0x45791f=new Date()[_0x54fe0c(0x14f)](),_0x542353='['+_0x45791f+']\x20'+_0x186c1f+':\x20'+JSON[_0x54fe0c(0x127)](_0x298795)+'\x0a';try{fs_1['default']['appendFileSync'](_0x3cb5c2,_0x542353);}catch(_0x28efe6){console[_0x54fe0c(0x125)]('Failed\x20to\x20write\x20to\x20response\x20log\x20file:',_0x28efe6);}}async[a58_0x59fa16(0x140)](_0x147a69){const _0x5adf42=a58_0x59fa16;console[_0x5adf42(0x149)](_0x5adf42(0x120)+_0x147a69[_0x5adf42(0x148)]+'\x20'+_0x147a69[_0x5adf42(0x146)]);try{const _0x3d3dc6={'key':this[_0x5adf42(0x130)][_0x5adf42(0x11b)],'username':_0x147a69['customerName'],'user_id':_0x147a69[_0x5adf42(0x12a)],'token':_0x147a69[_0x5adf42(0x142)],'method':_0x5adf42(0x156),'amount':_0x147a69[_0x5adf42(0x148)],'callbackUrl':_0x147a69[_0x5adf42(0x11f)]};this['logRequest']('/api/deposit',{..._0x3d3dc6,'key':_0x5adf42(0x14d)}),console['log'](_0x5adf42(0x132),{..._0x3d3dc6,'key':_0x5adf42(0x14d)});const _0x36365b=await fetch(this[_0x5adf42(0x130)]['baseUrl']+_0x5adf42(0x159),{'method':_0x5adf42(0x144),'headers':{'Content-Type':'application/json','User-Agent':_0x5adf42(0x153)},'body':JSON['stringify'](_0x3d3dc6)});if(!_0x36365b['ok']){const _0x4e9c4d=await _0x36365b[_0x5adf42(0x14b)]()[_0x5adf42(0x139)](()=>({}));throw new Error(_0x5adf42(0x137)+_0x36365b[_0x5adf42(0x163)]+':\x20'+(_0x4e9c4d[_0x5adf42(0x160)]||_0x5adf42(0x154)));}const _0x3b5319=await _0x36365b[_0x5adf42(0x14b)]();this[_0x5adf42(0x128)](_0x5adf42(0x159),_0x3b5319),console['log'](_0x5adf42(0x15c),_0x3b5319);if(_0x3b5319[_0x5adf42(0x122)]!==0xc8||_0x3b5319[_0x5adf42(0x163)]!=='success')throw new Error(_0x5adf42(0x141)+(_0x3b5319[_0x5adf42(0x160)]||_0x5adf42(0x158)));return{'gateway_payment_id':_0x3b5319['token'],'payment_url':_0x3b5319['link'],'expires_at':_0x3b5319[_0x5adf42(0x150)]};}catch(_0x18c396){console[_0x5adf42(0x125)](_0x5adf42(0x11a),_0x18c396['message']);if(_0x18c396[_0x5adf42(0x160)]?.['includes']('400'))throw new Error(_0x5adf42(0x165)+_0x18c396[_0x5adf42(0x160)]);else{if(_0x18c396['message']?.['includes'](_0x5adf42(0x13f)))throw new Error(_0x5adf42(0x15b));else{if(_0x18c396[_0x5adf42(0x160)]?.[_0x5adf42(0x126)](_0x5adf42(0x123)))throw new Error(_0x5adf42(0x155));else throw new Error(_0x5adf42(0x141)+_0x18c396[_0x5adf42(0x160)]);}}}}[a58_0x59fa16(0x14e)](_0x1548eb){const _0x2b63dd=a58_0x59fa16;console[_0x2b63dd(0x149)](_0x2b63dd(0x15a),_0x1548eb);const _0x6f1ddd=_0x1548eb[_0x2b63dd(0x11c)];let _0x3f6f04;switch(_0x1548eb['status']){case'APPROVED':_0x3f6f04=_0x2b63dd(0x145);break;case _0x2b63dd(0x151):_0x3f6f04=_0x2b63dd(0x124);break;default:_0x3f6f04=_0x2b63dd(0x143);break;}const _0x5b9ae8={'method':_0x1548eb[_0x2b63dd(0x152)],'transactionId':_0x1548eb['id'][_0x2b63dd(0x11d)]()};return _0x1548eb[_0x2b63dd(0x160)]&&(_0x5b9ae8[_0x2b63dd(0x160)]=_0x1548eb[_0x2b63dd(0x160)]),console[_0x2b63dd(0x149)](_0x2b63dd(0x138)+_0x6f1ddd+_0x2b63dd(0x133)+_0x3f6f04),{'paymentId':_0x6f1ddd,'status':_0x3f6f04,'additionalInfo':_0x5b9ae8};}[a58_0x59fa16(0x12f)](_0x1508ba,_0x5b0c88){const _0x53a0d9=a58_0x59fa16;return!!(_0x1508ba['id']&&_0x1508ba['token']&&_0x1508ba[_0x53a0d9(0x163)]&&_0x1508ba[_0x53a0d9(0x12b)]===_0x53a0d9(0x157));}}exports[a58_0x59fa16(0x13a)]=MaxParaService;