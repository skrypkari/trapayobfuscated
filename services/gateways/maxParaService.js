'use strict';function a61_0x423c(){const _0x20ffe4=['cwd','logResponse','4979988FgFhDN','MaxPara\x20validation\x20error:\x20','catch','APPROVED','3153600kUzMrR','üîÑ\x20Processing\x20MaxPara\x20webhook:','status','appendFileSync','/api/deposit','code','401','7WdZrPu','POST','PENDING','apiKey','config','application/json','mkdirSync','callbackUrl','orderId','log','1DCkkLk','logs','baseUrl','242721RxlVLk','method','122916ZsVOIa','HTTP\x20','currency','join','logRequest','default','TrapayUK/1.0','DEPOSIT','PAID','existsSync','paymentId','amount','stringify','DECLINED','validateWebhookSignature','Request\x20failed','__esModule','message','MaxPara\x20API\x20error:\x20','538509DufvtW','500','token','customerName','toISOString','Unknown\x20error','__importDefault','MaxParaService','1886840pOyyVE','fast','expire_date','90jWgYHV','type','defineProperty','275nqTltY','400','üì•\x20MaxPara\x20API\x20response:','json','\x20->\x20','363364mRXORl','12IMuHWa','path','includes','üìä\x20MaxPara\x20webhook\x20processed:\x20','Failed\x20to\x20write\x20to\x20request\x20log\x20file:','processWebhook','error','maxpara-responses.log','HIDDEN'];a61_0x423c=function(){return _0x20ffe4;};return a61_0x423c();}const a61_0x2c0b57=a61_0x4329;(function(_0x2025f3,_0x58c60d){const _0x31ba48=a61_0x4329,_0x4d08ff=_0x2025f3();while(!![]){try{const _0x35e7b5=parseInt(_0x31ba48(0x201))/0x1*(parseInt(_0x31ba48(0x1e0))/0x2)+parseInt(_0x31ba48(0x219))/0x3*(-parseInt(_0x31ba48(0x1e1))/0x4)+parseInt(_0x31ba48(0x221))/0x5+parseInt(_0x31ba48(0x1ec))/0x6+-parseInt(_0x31ba48(0x1f7))/0x7*(parseInt(_0x31ba48(0x1f0))/0x8)+parseInt(_0x31ba48(0x204))/0x9*(-parseInt(_0x31ba48(0x224))/0xa)+-parseInt(_0x31ba48(0x1db))/0xb*(-parseInt(_0x31ba48(0x206))/0xc);if(_0x35e7b5===_0x58c60d)break;else _0x4d08ff['push'](_0x4d08ff['shift']());}catch(_0x44b901){_0x4d08ff['push'](_0x4d08ff['shift']());}}}(a61_0x423c,0x72abd));var __importDefault=this&&this[a61_0x2c0b57(0x21f)]||function(_0x4f4612){const _0x413f94=a61_0x2c0b57;return _0x4f4612&&_0x4f4612[_0x413f94(0x216)]?_0x4f4612:{'default':_0x4f4612};};Object[a61_0x2c0b57(0x1da)](exports,'__esModule',{'value':!![]}),exports[a61_0x2c0b57(0x220)]=void 0x0;const fs_1=__importDefault(require('fs')),path_1=__importDefault(require(a61_0x2c0b57(0x1e2)));function a61_0x4329(_0x5b789f,_0x3be818){_0x5b789f=_0x5b789f-0x1d9;const _0x423cd4=a61_0x423c();let _0x432941=_0x423cd4[_0x5b789f];return _0x432941;}class MaxParaService{constructor(_0x128fad){const _0x1264b6=a61_0x2c0b57;this[_0x1264b6(0x1fb)]=_0x128fad;}[a61_0x2c0b57(0x20a)](_0x5a049a,_0x51cf05){const _0x4af180=a61_0x2c0b57,_0x490a77=path_1[_0x4af180(0x20b)][_0x4af180(0x209)](process['cwd'](),_0x4af180(0x202)),_0x581620=path_1[_0x4af180(0x20b)][_0x4af180(0x209)](_0x490a77,'maxpara-requests.log');!fs_1['default'][_0x4af180(0x20f)](_0x490a77)&&fs_1[_0x4af180(0x20b)][_0x4af180(0x1fd)](_0x490a77,{'recursive':!![]});const _0x5ab5ba=new Date()[_0x4af180(0x21d)](),_0x58d06e='['+_0x5ab5ba+']\x20'+_0x5a049a+':\x20'+JSON[_0x4af180(0x212)](_0x51cf05)+'\x0a';try{fs_1[_0x4af180(0x20b)]['appendFileSync'](_0x581620,_0x58d06e);}catch(_0x113cac){console[_0x4af180(0x1e7)](_0x4af180(0x1e5),_0x113cac);}}['logResponse'](_0x4017d7,_0x5cf332){const _0x21b8d6=a61_0x2c0b57,_0x5e4e9a=path_1[_0x21b8d6(0x20b)][_0x21b8d6(0x209)](process[_0x21b8d6(0x1ea)](),_0x21b8d6(0x202)),_0xce27d3=path_1[_0x21b8d6(0x20b)]['join'](_0x5e4e9a,_0x21b8d6(0x1e8));!fs_1[_0x21b8d6(0x20b)][_0x21b8d6(0x20f)](_0x5e4e9a)&&fs_1[_0x21b8d6(0x20b)][_0x21b8d6(0x1fd)](_0x5e4e9a,{'recursive':!![]});const _0x5a136a=new Date()['toISOString'](),_0x4add61='['+_0x5a136a+']\x20'+_0x4017d7+':\x20'+JSON[_0x21b8d6(0x212)](_0x5cf332)+'\x0a';try{fs_1['default'][_0x21b8d6(0x1f3)](_0xce27d3,_0x4add61);}catch(_0x4b59a6){console['error']('Failed\x20to\x20write\x20to\x20response\x20log\x20file:',_0x4b59a6);}}async['createDeposit'](_0x506f1e){const _0x113aba=a61_0x2c0b57;console[_0x113aba(0x200)]('üè¶\x20Creating\x20MaxPara\x20deposit\x20for\x20'+_0x506f1e[_0x113aba(0x211)]+'\x20'+_0x506f1e[_0x113aba(0x208)]);try{const _0x32ca36={'key':this[_0x113aba(0x1fb)][_0x113aba(0x1fa)],'username':_0x506f1e[_0x113aba(0x21c)],'user_id':_0x506f1e[_0x113aba(0x210)],'token':_0x506f1e[_0x113aba(0x1ff)],'method':_0x113aba(0x222),'amount':_0x506f1e[_0x113aba(0x211)],'callbackUrl':_0x506f1e[_0x113aba(0x1fe)]};this['logRequest'](_0x113aba(0x1f4),{..._0x32ca36,'key':'HIDDEN'}),console[_0x113aba(0x200)]('üì§\x20MaxPara\x20API\x20request:',{..._0x32ca36,'key':_0x113aba(0x1e9)});const _0x3b6371=await fetch(this[_0x113aba(0x1fb)][_0x113aba(0x203)]+'/api/deposit',{'method':_0x113aba(0x1f8),'headers':{'Content-Type':_0x113aba(0x1fc),'User-Agent':_0x113aba(0x20c)},'body':JSON[_0x113aba(0x212)](_0x32ca36)});if(!_0x3b6371['ok']){const _0x22c020=await _0x3b6371[_0x113aba(0x1de)]()[_0x113aba(0x1ee)](()=>({}));throw new Error(_0x113aba(0x207)+_0x3b6371[_0x113aba(0x1f2)]+':\x20'+(_0x22c020['message']||_0x113aba(0x215)));}const _0x22bf08=await _0x3b6371[_0x113aba(0x1de)]();this[_0x113aba(0x1eb)](_0x113aba(0x1f4),_0x22bf08),console[_0x113aba(0x200)](_0x113aba(0x1dd),_0x22bf08);if(_0x22bf08[_0x113aba(0x1f5)]!==0xc8||_0x22bf08['status']!=='success')throw new Error(_0x113aba(0x218)+(_0x22bf08[_0x113aba(0x217)]||_0x113aba(0x21e)));return{'gateway_payment_id':_0x22bf08[_0x113aba(0x21b)],'payment_url':_0x22bf08['link'],'expires_at':_0x22bf08[_0x113aba(0x223)]};}catch(_0x35b59c){console[_0x113aba(0x1e7)]('‚ùå\x20MaxPara\x20API\x20error:',_0x35b59c[_0x113aba(0x217)]);if(_0x35b59c[_0x113aba(0x217)]?.[_0x113aba(0x1e3)](_0x113aba(0x1dc)))throw new Error(_0x113aba(0x1ed)+_0x35b59c[_0x113aba(0x217)]);else{if(_0x35b59c[_0x113aba(0x217)]?.[_0x113aba(0x1e3)](_0x113aba(0x1f6)))throw new Error('MaxPara\x20authentication\x20failed');else{if(_0x35b59c[_0x113aba(0x217)]?.[_0x113aba(0x1e3)](_0x113aba(0x21a)))throw new Error('MaxPara\x20server\x20error');else throw new Error(_0x113aba(0x218)+_0x35b59c['message']);}}}}[a61_0x2c0b57(0x1e6)](_0x509d62){const _0x11e7b9=a61_0x2c0b57;console['log'](_0x11e7b9(0x1f1),_0x509d62);const _0x26043b=_0x509d62['token'];let _0x48ec00;switch(_0x509d62['status']){case _0x11e7b9(0x1ef):_0x48ec00=_0x11e7b9(0x20e);break;case _0x11e7b9(0x213):_0x48ec00='FAILED';break;default:_0x48ec00=_0x11e7b9(0x1f9);break;}const _0x206858={'method':_0x509d62[_0x11e7b9(0x205)],'transactionId':_0x509d62['id']['toString']()};return _0x509d62[_0x11e7b9(0x217)]&&(_0x206858[_0x11e7b9(0x217)]=_0x509d62[_0x11e7b9(0x217)]),console[_0x11e7b9(0x200)](_0x11e7b9(0x1e4)+_0x26043b+_0x11e7b9(0x1df)+_0x48ec00),{'paymentId':_0x26043b,'status':_0x48ec00,'additionalInfo':_0x206858};}[a61_0x2c0b57(0x214)](_0x258967,_0x3c5d24){const _0x1bdc11=a61_0x2c0b57;return!!(_0x258967['id']&&_0x258967['token']&&_0x258967['status']&&_0x258967[_0x1bdc11(0x1d9)]===_0x1bdc11(0x20d));}}exports[a61_0x2c0b57(0x220)]=MaxParaService;