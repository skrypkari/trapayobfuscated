'use strict';function a45_0x4f13(_0x3a6498,_0x26eb5c){const _0x20fe52=a45_0x20fe();return a45_0x4f13=function(_0x4f1347,_0x47f120){_0x4f1347=_0x4f1347-0x149;let _0x221c6a=_0x20fe52[_0x4f1347];return _0x221c6a;},a45_0x4f13(_0x3a6498,_0x26eb5c);}const a45_0x3f7b51=a45_0x4f13;(function(_0x321c48,_0x5a68f4){const _0x48e468=a45_0x4f13,_0x245940=_0x321c48();while(!![]){try{const _0x364953=-parseInt(_0x48e468(0x172))/0x1+parseInt(_0x48e468(0x17f))/0x2*(parseInt(_0x48e468(0x17c))/0x3)+parseInt(_0x48e468(0x15d))/0x4+parseInt(_0x48e468(0x176))/0x5+-parseInt(_0x48e468(0x16d))/0x6+-parseInt(_0x48e468(0x149))/0x7*(-parseInt(_0x48e468(0x177))/0x8)+-parseInt(_0x48e468(0x164))/0x9*(parseInt(_0x48e468(0x180))/0xa);if(_0x364953===_0x5a68f4)break;else _0x245940['push'](_0x245940['shift']());}catch(_0x5dbd26){_0x245940['push'](_0x245940['shift']());}}}(a45_0x20fe,0xe3881));function a45_0x20fe(){const _0x25d001=['apiUrl','paymentId','1590520FwbPPs','30UiKRnV','77Bajigm','PENDING','Error\x20stack:','logWhiteDomainRequest','üåê\x20Amer\x20service\x20initialized\x20with\x20api2.trapay.uk\x20domain','Payment\x20URL:','success','Unknown\x20error','&order=','&currency=','logWhiteDomainError','Failed\x20to\x20create\x20Amer\x20payment\x20link:\x20Unknown\x20error','paymentMethod','error','cardLast4','amer','https://api2.trapay.uk','Payment\x20ID:','log','orderId','7340260QOAKkV','Failed\x20to\x20create\x20Amer\x20payment\x20link:\x20','PAID','FAILED','amount','Amount:','üí∞\x20Amount:\x20','4082625jVNnZi','üí≥\x20Creating\x20Amer\x20payment\x20link\x20for\x20order\x20','defineProperty','/payment','processWebhook','loggerService','&amount=','Error\x20message:','gatewayPaymentId','4348830icYAXk','/payment/verify/','transactionId','currency','üîÑ\x20Amer\x20webhook\x20processed:\x20status=','1669393MiMNJI','Error\x20details:','GET','message','8813215VqmiZu','213872SyJJpB','stack','AmerService','toUpperCase','__esModule','3pOoSsy'];a45_0x20fe=function(){return _0x25d001;};return a45_0x20fe();}Object[a45_0x3f7b51(0x166)](exports,a45_0x3f7b51(0x17b),{'value':!![]}),exports[a45_0x3f7b51(0x179)]=void 0x0;const loggerService_1=require('../loggerService');class AmerService{constructor(){const _0x56779d=a45_0x3f7b51;this[_0x56779d(0x17d)]=_0x56779d(0x159),console['log'](_0x56779d(0x14d));}async['createPaymentLink'](_0x15dde2){const _0x167af9=a45_0x3f7b51,{paymentId:_0x1843e1,orderId:_0x50978c,orderName:_0x4f0867,amount:_0x36663f,currency:_0x15c68a,usage:_0x33f576,maxPayments:_0x477b84,successUrl:_0x170148,failUrl:_0x55642f}=_0x15dde2,_0x10b5a9=_0x15c68a[_0x167af9(0x17a)]();console[_0x167af9(0x15b)](_0x167af9(0x165)+_0x50978c),console[_0x167af9(0x15b)](_0x167af9(0x163)+_0x36663f+'\x20'+_0x10b5a9);try{const _0x33ec90=this[_0x167af9(0x17d)]+'/payment.php?payment_id='+_0x1843e1+_0x167af9(0x16a)+_0x36663f+_0x167af9(0x152)+_0x10b5a9+_0x167af9(0x151)+_0x50978c;return console[_0x167af9(0x15b)]('===\x20AMER\x20PAYMENT\x20LINK\x20CREATED\x20==='),console[_0x167af9(0x15b)](_0x167af9(0x15a),_0x1843e1),console[_0x167af9(0x15b)](_0x167af9(0x14e),_0x33ec90),console['log'](_0x167af9(0x162),_0x36663f,_0x10b5a9),loggerService_1[_0x167af9(0x169)][_0x167af9(0x14c)](_0x167af9(0x158),_0x167af9(0x167),_0x167af9(0x174),{'paymentId':_0x1843e1,'amount':_0x36663f,'currency':_0x10b5a9,'orderId':_0x50978c}),{'gateway_payment_id':_0x1843e1,'payment_url':_0x33ec90};}catch(_0x42c6a4){console['error']('===\x20AMER\x20SERVICE\x20ERROR\x20==='),console[_0x167af9(0x156)](_0x167af9(0x173),_0x42c6a4),loggerService_1[_0x167af9(0x169)][_0x167af9(0x153)](_0x167af9(0x158),_0x167af9(0x167),_0x42c6a4);if(_0x42c6a4 instanceof Error){console[_0x167af9(0x156)](_0x167af9(0x16b),_0x42c6a4['message']),console[_0x167af9(0x156)](_0x167af9(0x14b),_0x42c6a4[_0x167af9(0x178)]);throw new Error(_0x167af9(0x15e)+_0x42c6a4[_0x167af9(0x175)]);}throw new Error(_0x167af9(0x154));}}async['verifyPayment'](_0xb5b3fa){const _0x492d18=a45_0x3f7b51;console[_0x492d18(0x15b)]('üîç\x20Verifying\x20Amer\x20payment:\x20'+_0xb5b3fa);try{return loggerService_1['loggerService'][_0x492d18(0x14c)](_0x492d18(0x158),'/payment/verify/'+_0xb5b3fa,_0x492d18(0x174),{}),{'status':_0x492d18(0x14a)};}catch(_0x26fbb4){console[_0x492d18(0x156)]('Amer\x20payment\x20verification\x20error:',_0x26fbb4),loggerService_1[_0x492d18(0x169)]['logWhiteDomainError'](_0x492d18(0x158),_0x492d18(0x16e)+_0xb5b3fa,_0x26fbb4);throw new Error('Failed\x20to\x20verify\x20Amer\x20payment:\x20'+(_0x26fbb4 instanceof Error?_0x26fbb4[_0x492d18(0x175)]:_0x492d18(0x150)));}}async[a45_0x3f7b51(0x168)](_0x3eb971){const _0x37b296=a45_0x3f7b51;console[_0x37b296(0x15b)]('Processing\x20Amer\x20webhook:',_0x3eb971);let _0x5d1f3e='PENDING';if(_0x3eb971[_0x37b296(0x14f)]===!![])_0x5d1f3e=_0x37b296(0x15f);else _0x3eb971[_0x37b296(0x14f)]===![]&&(_0x5d1f3e=_0x37b296(0x160));const _0x4223ce={};return _0x3eb971[_0x37b296(0x157)]&&(_0x4223ce[_0x37b296(0x157)]=_0x3eb971[_0x37b296(0x157)]),_0x3eb971[_0x37b296(0x155)]&&(_0x4223ce['paymentMethod']=_0x3eb971['paymentMethod']),_0x3eb971[_0x37b296(0x16f)]&&(_0x4223ce[_0x37b296(0x16f)]=_0x3eb971[_0x37b296(0x16f)],_0x4223ce[_0x37b296(0x16c)]=_0x3eb971['transactionId']),console['log'](_0x37b296(0x171)+_0x5d1f3e),{'paymentId':_0x3eb971[_0x37b296(0x17e)]||_0x3eb971[_0x37b296(0x15c)]||'','status':_0x5d1f3e,'amount':_0x3eb971[_0x37b296(0x161)],'currency':_0x3eb971[_0x37b296(0x170)],'additionalInfo':_0x4223ce};}}exports[a45_0x3f7b51(0x179)]=AmerService;