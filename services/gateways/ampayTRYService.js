'use strict';const a57_0x2fec7b=a57_0x5188;(function(_0x341e69,_0x28696a){const _0x59d650=a57_0x5188,_0x322909=_0x341e69();while(!![]){try{const _0x1ed116=-parseInt(_0x59d650(0x182))/0x1*(-parseInt(_0x59d650(0x111))/0x2)+parseInt(_0x59d650(0xf4))/0x3+-parseInt(_0x59d650(0xf6))/0x4+-parseInt(_0x59d650(0x123))/0x5+parseInt(_0x59d650(0xf9))/0x6*(-parseInt(_0x59d650(0xcc))/0x7)+-parseInt(_0x59d650(0x105))/0x8*(-parseInt(_0x59d650(0xec))/0x9)+-parseInt(_0x59d650(0xf7))/0xa*(-parseInt(_0x59d650(0x188))/0xb);if(_0x1ed116===_0x28696a)break;else _0x322909['push'](_0x322909['shift']());}catch(_0x355272){_0x322909['push'](_0x322909['shift']());}}}(a57_0x98d1,0x6f3f0));function a57_0x5188(_0x6c6e01,_0x457831){_0x6c6e01=_0x6c6e01-0xc6;const _0x98d116=a57_0x98d1();let _0x51886c=_0x98d116[_0x6c6e01];return _0x51886c;}Object[a57_0x2fec7b(0x115)](exports,a57_0x2fec7b(0xfd),{'value':!![]}),exports[a57_0x2fec7b(0x10c)]=void 0x0;const loggerService_1=require(a57_0x2fec7b(0xf2));function a57_0x98d1(){const _0x224c4b=['PHL','MUS','Payment\x20URL:','API_PRIVATE_KEY','REU','MNE','Tracker\x20ID:','not\x20provided','‚ùå\x20AmPay\x20TRY\x20API\x20error:','AmPay\x20TRY\x20did\x20not\x20return\x20a\x20payment\x20URL','GUY','üìù\x20Logging\x20AmPay\x20TRY\x20payment\x20creation\x20failure...','MWI','‚ùå\x20AmPay\x20TRY\x20webhook\x20processing\x20failed:','loggerService','TrapayEnd/1.0','POL','COL','waiting','CHE','RUS','PRT','redirect_url','MEX','ZMB','Phone:','customerCountry','CYP','declined','toLowerCase','text','GAM','168twhEoN','KEN','Bank\x20Transfer\x20TR','FRA','LTU','AmPay\x20TRY\x20API\x20error:\x20','598422aVCCyn','AmPay\x20TRY\x20API\x20error:\x20HTTP\x20','YEM','failed','Order\x20ID:','expired','email','timeout','TRY','KGZ','MDG','AND','createPaymentLink','status','application/json','‚ùå\x20No\x20payment\x20ID\x20found\x20in\x20AmPay\x20TRY\x20webhook\x20data','BGD','üìù\x20AmPay\x20TRY\x20API\x20raw\x20response:','CAN','KWT','No\x20payment\x20ID\x20in\x20webhook\x20data','BTN','VAT','LBN','21szSYjr','TJK','KAZ','SUR','MKD','Unknown\x20error','MMR','AZE','message','‚ùå\x20AmPay\x20TRY\x20payment\x20creation\x20failed:','FIN','SYC','üìä\x20AmPay\x20TRY\x20parsed\x20response:','FLK','BEL','üì•\x20Processing\x20AmPay\x20TRY\x20webhook:','Invalid\x20JSON\x20response\x20from\x20AmPay\x20TRY:\x20','UGA','TrapayAPI/1.0','logWebhookReceived','success','OMN','currency','AUS','‚úÖ\x20AmPay\x20TRY\x20payment\x20created\x20successfully:','pending','SRB','parse','CHN','ECU','API_PUBLIC_KEY','IND','9czDBvB','PAID','processWebhook','VNM','paymentId','IRL','../loggerService','apiUrl','1271514UUKSol','ARM','1973720RmGqpr','100qrKoCh','error','1379394OkkmCl','URY','BRA','IRN','__esModule','üáπüá∑\x20AmPay\x20TRY\x20service\x20initialized\x20with\x20IBAN\x20Bank\x20Transfer\x20TR\x20processing','‚ö†Ô∏è\x20Unknown\x20country\x20code:\x20','HTTP\x20','MYS','stringify','completed','ARG','6685608EpqPOj','Customer\x20Country\x20(3-letter):','‚ùå\x20Failed\x20to\x20parse\x20AmPay\x20TRY\x20API\x20response:','processing','üì§\x20AmPay\x20TRY\x20API\x20request\x20data:','Amount:','https://traffer.uk/gateway/ampay-try/','AmPayTRYService','MNG','IRQ','ALB','ROU','6046jkxvbd','log','a5a059aa63392e571341bddc5148a5db66643722e9a6bf16a9395fb690a80288931d5a1180a85a28eb9f6516cf61dfc1bf4e37898f3a35261cd2db88888d3815','client_transaction_id','defineProperty','DNK','CHL','üìä\x20AmPay\x20TRY\x20response\x20data:','checkPaymentStatus','LIE','Customer:','ampay.php','BIH','üì§\x20AmPay\x20TRY\x20request\x20body:','SAU','VEN','FAILED','ZWE','3363160efvzhz','MLT','MDV','‚ùå\x20Failed\x20to\x20parse\x20AmPay\x20TRY\x20status\x20response:','toUpperCase','JPN','GHA','‚úÖ\x20AmPay\x20TRY\x20payment\x20link\x20created\x20successfully','üìù\x20Logging\x20AmPay\x20TRY\x20payment\x20creation\x20event...','lastName','KOR','ARE','failureUrl',',\x20using\x20TUR\x20as\x20fallback\x20for\x20AmPay\x20TRY','PSE','UKR','amount','GBR','verifyWebhookSignature','convert2LetterTo3LetterCountryCode','system_id','GRC','CLIENT_MERCHANT_ID','logWebhookError','phone','warn','\x20->\x20','NOR','orderId','Email:','NGA','ampay-try','BLR','üì•\x20AmPay\x20TRY\x20raw\x20response:','POST','SWE','EGY','createPayment','tracker_id','TUR','KHM','TZA','BGR','MCO','DEU','THA','GEO','LUX','TRAFFER','MDA','BHR','PRK','üîê\x20AmPay\x20TRY\x20webhook\x20signature\x20verification\x20not\x20implemented\x20yet','AFG','USA','SVK','UZB','MOZ','customerIp','ITA','üìä\x20AmPay\x20TRY\x20status\x20response:','ISL','PENDING'];a57_0x98d1=function(){return _0x224c4b;};return a57_0x98d1();}class AmPayTRYService{constructor(){const _0x184ecb=a57_0x2fec7b;this[_0x184ecb(0x139)]=_0x184ecb(0x153),this['API_PUBLIC_KEY']='58b59ccbc03dcdcfc20d830edfba765dbf9f3531c692533d84b17938e9c40bda',this[_0x184ecb(0x165)]=_0x184ecb(0x113),this[_0x184ecb(0xf3)]=_0x184ecb(0x10b),console[_0x184ecb(0x112)](_0x184ecb(0xfe));}[a57_0x2fec7b(0x136)](_0x13a855){const _0x30072f=a57_0x2fec7b,_0x5b05ab={'AD':_0x30072f(0x193),'AL':_0x30072f(0x10f),'AT':'AUT','BA':_0x30072f(0x11d),'BE':_0x30072f(0xda),'BG':_0x30072f(0x14d),'BY':_0x30072f(0x143),'CH':_0x30072f(0x175),'CY':_0x30072f(0x17d),'CZ':'CZE','DE':_0x30072f(0x14f),'DK':_0x30072f(0x116),'EE':'EST','ES':'ESP','FI':_0x30072f(0xd6),'FR':_0x30072f(0x185),'GB':_0x30072f(0x134),'GE':_0x30072f(0x151),'GR':_0x30072f(0x138),'HR':'HRV','HU':'HUN','IE':_0x30072f(0xf1),'IS':_0x30072f(0x160),'IT':_0x30072f(0x15e),'LI':_0x30072f(0x11a),'LT':_0x30072f(0x186),'LU':_0x30072f(0x152),'LV':'LVA','MC':_0x30072f(0x14e),'MD':_0x30072f(0x154),'ME':_0x30072f(0x167),'MK':_0x30072f(0xd0),'MT':_0x30072f(0x124),'NL':'NLD','NO':_0x30072f(0x13e),'PL':_0x30072f(0x172),'PT':_0x30072f(0x177),'RO':_0x30072f(0x110),'RS':_0x30072f(0xe6),'RU':_0x30072f(0x176),'SE':_0x30072f(0x146),'SI':'SVN','SK':_0x30072f(0x15a),'SM':'SMR','UA':_0x30072f(0x132),'VA':_0x30072f(0xca),'XK':'XKX','AM':_0x30072f(0xf5),'AZ':_0x30072f(0xd3),'KZ':_0x30072f(0xce),'KG':_0x30072f(0x191),'TJ':_0x30072f(0xcd),'TM':'TKM','UZ':_0x30072f(0x15b),'US':_0x30072f(0x159),'CA':_0x30072f(0xc6),'AU':_0x30072f(0xe3),'JP':_0x30072f(0x128),'CN':_0x30072f(0xe8),'IN':_0x30072f(0xeb),'BR':_0x30072f(0xfb),'MX':_0x30072f(0x179),'AR':_0x30072f(0x104),'CL':_0x30072f(0x117),'PE':'PER','CO':_0x30072f(0x173),'VE':_0x30072f(0x120),'EC':_0x30072f(0xe9),'BO':'BOL','PY':'PRY','UY':_0x30072f(0xfa),'SR':_0x30072f(0xcf),'GY':_0x30072f(0x16c),'FK':_0x30072f(0xd9),'ZA':'ZAF','EG':_0x30072f(0x147),'NG':_0x30072f(0x141),'KE':_0x30072f(0x183),'GH':_0x30072f(0x129),'TZ':_0x30072f(0x14c),'UG':_0x30072f(0xdd),'ZW':_0x30072f(0x122),'ZM':_0x30072f(0x17a),'MW':_0x30072f(0x16e),'MZ':_0x30072f(0x15c),'MG':_0x30072f(0x192),'MU':_0x30072f(0x163),'SC':_0x30072f(0xd7),'RE':_0x30072f(0x166),'TR':_0x30072f(0x14a),'IR':_0x30072f(0xfc),'IQ':_0x30072f(0x10e),'SA':_0x30072f(0x11f),'AE':_0x30072f(0x12e),'KW':_0x30072f(0xc7),'QA':'QAT','BH':_0x30072f(0x155),'OM':_0x30072f(0xe1),'YE':_0x30072f(0x18a),'JO':'JOR','LB':_0x30072f(0xcb),'SY':'SYR','IL':'ISR','PS':_0x30072f(0x131),'KR':_0x30072f(0x12d),'KP':_0x30072f(0x156),'TH':_0x30072f(0x150),'VN':_0x30072f(0xef),'MY':_0x30072f(0x101),'SG':'SGP','ID':'IDN','PH':_0x30072f(0x162),'LA':'LAO','KH':_0x30072f(0x14b),'MM':_0x30072f(0xd2),'BD':_0x30072f(0x198),'LK':'LKA','NP':'NPL','BT':_0x30072f(0xc9),'MV':_0x30072f(0x125),'AF':_0x30072f(0x158),'PK':'PAK','MN':_0x30072f(0x10d)},_0x3e10b0=_0x5b05ab[_0x13a855[_0x30072f(0x127)]()];if(!_0x3e10b0)return console[_0x30072f(0x13c)](_0x30072f(0xff)+_0x13a855+_0x30072f(0x130)),_0x30072f(0x14a);return _0x3e10b0;}async[a57_0x2fec7b(0x148)](_0x40bad4){const _0xaec18b=a57_0x2fec7b;console[_0xaec18b(0x112)]('üöÄ\x20Creating\x20AmPay\x20TRY\x20payment\x20request:',{'paymentId':_0x40bad4[_0xaec18b(0xf0)],'amount':_0x40bad4['amount'],'currency':_0x40bad4['currency'],'customerCountry':_0x40bad4['customerCountry']});try{const _0x5d114f={'client_merchant_id':this['CLIENT_MERCHANT_ID'],'payment_method':_0xaec18b(0x184),'client_transaction_id':_0x40bad4[_0xaec18b(0x13f)],'amount':_0x40bad4[_0xaec18b(0x133)],'currency':_0x40bad4[_0xaec18b(0xe2)],'callback_url':'https://traffer.uk/gateway/ampay-try/webhook.php','tracker_id':_0x40bad4[_0xaec18b(0xf0)],'redirect_url':_0x40bad4['successUrl'],'failure_url':_0x40bad4[_0xaec18b(0x12f)],'customer_first_name':_0x40bad4['firstName'],'customer_last_name':_0x40bad4[_0xaec18b(0x12c)],'customer_email':_0x40bad4[_0xaec18b(0x18e)],'customer_phone':_0x40bad4[_0xaec18b(0x13b)]||'','customer_ip':_0x40bad4[_0xaec18b(0x15d)],'customer_country':_0x40bad4[_0xaec18b(0x17c)],'api_public_key':this['API_PUBLIC_KEY']};console[_0xaec18b(0x112)](_0xaec18b(0x109),JSON[_0xaec18b(0x102)](_0x5d114f,null,0x2));const _0x483702=await fetch(this[_0xaec18b(0xf3)],{'method':_0xaec18b(0x145),'headers':{'Content-Type':_0xaec18b(0x196),'User-Agent':_0xaec18b(0x171)},'body':JSON[_0xaec18b(0x102)](_0x5d114f)});console['log']('üì°\x20AmPay\x20TRY\x20API\x20response\x20status:',_0x483702['status']);const _0x3fec6e=await _0x483702[_0xaec18b(0x180)]();console[_0xaec18b(0x112)](_0xaec18b(0x199),_0x3fec6e);let _0x3c177f;try{_0x3c177f=JSON['parse'](_0x3fec6e);}catch(_0x4da79d){console[_0xaec18b(0xf8)](_0xaec18b(0x107),_0x4da79d);throw new Error('Invalid\x20JSON\x20response\x20from\x20AmPay\x20TRY:\x20'+_0x3fec6e);}console[_0xaec18b(0x112)](_0xaec18b(0xd8),JSON[_0xaec18b(0x102)](_0x3c177f,null,0x2)),loggerService_1[_0xaec18b(0x170)][_0xaec18b(0xdf)](_0xaec18b(0x142),_0x3c177f,{});if(!_0x483702['ok']){const _0x51e0ba=_0x3c177f['error_message']||_0x3c177f[_0xaec18b(0xd4)]||_0xaec18b(0x100)+_0x483702[_0xaec18b(0x195)];console[_0xaec18b(0xf8)](_0xaec18b(0x16a),_0x51e0ba);throw new Error(_0xaec18b(0x187)+_0x51e0ba);}if(!_0x3c177f[_0xaec18b(0x178)]){console[_0xaec18b(0xf8)]('‚ùå\x20No\x20redirect_url\x20in\x20AmPay\x20TRY\x20response:',_0x3c177f);throw new Error(_0xaec18b(0x16b));}const _0x152a4e={'gateway_payment_id':_0x3c177f['system_id']||_0x40bad4[_0xaec18b(0x13f)],'payment_url':_0x3c177f[_0xaec18b(0x178)],'transaction_id':_0x3c177f[_0xaec18b(0x114)]};return console['log'](_0xaec18b(0xe4),_0x152a4e),_0x152a4e;}catch(_0x1ec71d){console[_0xaec18b(0xf8)](_0xaec18b(0xd5),_0x1ec71d),loggerService_1[_0xaec18b(0x170)][_0xaec18b(0x13a)]('ampay-try',_0x1ec71d,_0x40bad4);throw _0x1ec71d;}}async[a57_0x2fec7b(0x194)](_0x33e583){const _0x3eefc1=a57_0x2fec7b;try{const {orderId:_0x520390,amount:_0x40326f,currency:_0x49ad9c,firstName:_0x55d307,lastName:_0x2e8d4d,email:_0x48920e,phone:_0x4f91b8,customerIp:_0x256135,customerCountry:_0x49add9,successUrl:_0x3f1740,failureUrl:_0x555f2c}=_0x33e583;console[_0x3eefc1(0x112)]('üáπüá∑\x20Creating\x20AmPay\x20TRY\x20payment\x20link...'),console[_0x3eefc1(0x112)](_0x3eefc1(0x18c),_0x520390),console[_0x3eefc1(0x112)](_0x3eefc1(0x10a),_0x40326f,_0x49ad9c),console[_0x3eefc1(0x112)](_0x3eefc1(0x11b),_0x55d307+'\x20'+_0x2e8d4d),console['log'](_0x3eefc1(0x140),_0x48920e),console[_0x3eefc1(0x112)](_0x3eefc1(0x17b),_0x4f91b8||_0x3eefc1(0x169)),console['log']('Customer\x20IP:',_0x256135),console[_0x3eefc1(0x112)]('Customer\x20Country\x20(2-letter):',_0x49add9);const _0x2f2fd0=this['convert2LetterTo3LetterCountryCode'](_0x49add9);console[_0x3eefc1(0x112)](_0x3eefc1(0x106),_0x2f2fd0);const _0x5d368a={'sub_method':_0x3eefc1(0x181),'currency':_0x49ad9c[_0x3eefc1(0x127)](),'amount':_0x40326f,'callback_url':'https://traffer.uk/gateway/ampay-try/webhook.php','client_merchant_id':this[_0x3eefc1(0x139)],'client_transaction_id':_0x520390,'transaction_description':_0x520390,'customer':{'ip':_0x256135,'email':_0x48920e,'full_name':_0x55d307+'\x20'+_0x2e8d4d,'phone':_0x4f91b8||'','country':_0x2f2fd0},'success_redirect_url':_0x3f1740,'error_redirect_url':_0x555f2c};console[_0x3eefc1(0x112)](_0x3eefc1(0x11e),JSON[_0x3eefc1(0x102)](_0x5d368a,null,0x2));const _0x3cfaa5=await fetch(this[_0x3eefc1(0xf3)]+_0x3eefc1(0x11c),{'method':'POST','headers':{'Content-Type':'application/json','User-Agent':_0x3eefc1(0xde)},'body':JSON[_0x3eefc1(0x102)](_0x5d368a)}),_0x25b6fb=await _0x3cfaa5[_0x3eefc1(0x180)]();console[_0x3eefc1(0x112)](_0x3eefc1(0x144),_0x25b6fb);if(!_0x3cfaa5['ok'])throw new Error(_0x3eefc1(0x189)+_0x3cfaa5[_0x3eefc1(0x195)]+'\x20-\x20'+_0x25b6fb);let _0x360d42;try{_0x360d42=JSON[_0x3eefc1(0xe7)](_0x25b6fb);}catch(_0x44117c){throw new Error(_0x3eefc1(0xdc)+_0x25b6fb);}console[_0x3eefc1(0x112)](_0x3eefc1(0x118),JSON[_0x3eefc1(0x102)](_0x360d42,null,0x2));if(!_0x360d42['redirect_url'])throw new Error('AmPay\x20TRY\x20payment\x20creation\x20failed:\x20'+(_0x360d42['error_message']||_0x360d42[_0x3eefc1(0xd4)]||_0x3eefc1(0xd1)));const _0x73789=_0x360d42[_0x3eefc1(0x178)],_0x1a3ccf=_0x360d42[_0x3eefc1(0x137)],_0x49e855=_0x360d42[_0x3eefc1(0x149)];return console[_0x3eefc1(0x112)](_0x3eefc1(0x12a)),console[_0x3eefc1(0x112)](_0x3eefc1(0x164),_0x73789),console[_0x3eefc1(0x112)]('System\x20ID:',_0x1a3ccf),console['log'](_0x3eefc1(0x168),_0x49e855),console[_0x3eefc1(0x112)]('Status:',_0x360d42[_0x3eefc1(0x195)]),console[_0x3eefc1(0x112)](_0x3eefc1(0x12b)),{'gateway_payment_id':_0x1a3ccf||_0x49e855||_0x520390,'payment_url':_0x73789||'','transaction_id':_0x1a3ccf};}catch(_0x3d6f14){console[_0x3eefc1(0xf8)](_0x3eefc1(0xd5),_0x3d6f14),console[_0x3eefc1(0x112)](_0x3eefc1(0x16d)),loggerService_1['loggerService'][_0x3eefc1(0x13a)](_0x3eefc1(0x142),_0x3d6f14,_0x33e583);throw _0x3d6f14;}}async[a57_0x2fec7b(0x119)](_0x364290){const _0x12a706=a57_0x2fec7b;console[_0x12a706(0x112)]('üîç\x20Checking\x20AmPay\x20TRY\x20payment\x20status\x20for:',_0x364290);try{const _0x2cff6c={'client_merchant_id':this['CLIENT_MERCHANT_ID'],'system_id':_0x364290,'api_public_key':this[_0x12a706(0xea)]},_0x222edd=await fetch(this[_0x12a706(0xf3)]+'/status',{'method':_0x12a706(0x145),'headers':{'Content-Type':_0x12a706(0x196),'User-Agent':_0x12a706(0x171)},'body':JSON[_0x12a706(0x102)](_0x2cff6c)}),_0x483b1e=await _0x222edd[_0x12a706(0x180)]();console[_0x12a706(0x112)]('üìù\x20AmPay\x20TRY\x20status\x20raw\x20response:',_0x483b1e);let _0x7b6b5f;try{_0x7b6b5f=JSON[_0x12a706(0xe7)](_0x483b1e);}catch(_0xa53e70){return console[_0x12a706(0xf8)](_0x12a706(0x126),_0xa53e70),{'status':_0x12a706(0x121)};}console[_0x12a706(0x112)](_0x12a706(0x15f),JSON['stringify'](_0x7b6b5f,null,0x2));let _0x540020=_0x12a706(0x161);if(_0x7b6b5f[_0x12a706(0x195)])switch(_0x7b6b5f[_0x12a706(0x195)]['toLowerCase']()){case _0x12a706(0xe0):case _0x12a706(0x103):case'paid':_0x540020='PAID';break;case _0x12a706(0x18b):case'error':case _0x12a706(0x17e):_0x540020=_0x12a706(0x121);break;case _0x12a706(0x18d):case _0x12a706(0x18f):_0x540020='EXPIRED';break;case _0x12a706(0xe5):case _0x12a706(0x108):case'waiting':default:_0x540020=_0x12a706(0x161);break;}return{'status':_0x540020,'amount':_0x7b6b5f[_0x12a706(0x133)],'currency':_0x7b6b5f[_0x12a706(0xe2)]};}catch(_0x54cc76){return console[_0x12a706(0xf8)]('‚ùå\x20AmPay\x20TRY\x20status\x20check\x20failed:',_0x54cc76),{'status':'FAILED'};}}async[a57_0x2fec7b(0xee)](_0x4472c7){const _0x406d3b=a57_0x2fec7b;console[_0x406d3b(0x112)](_0x406d3b(0xdb),JSON[_0x406d3b(0x102)](_0x4472c7,null,0x2));try{const _0x4d1a0a=_0x4472c7[_0x406d3b(0x149)]||_0x4472c7[_0x406d3b(0x114)]||_0x4472c7[_0x406d3b(0x137)];if(!_0x4d1a0a){console[_0x406d3b(0xf8)](_0x406d3b(0x197));throw new Error(_0x406d3b(0xc8));}let _0x36cd4d='PENDING';if(_0x4472c7[_0x406d3b(0x195)])switch(_0x4472c7[_0x406d3b(0x195)][_0x406d3b(0x17f)]()){case _0x406d3b(0xe0):case _0x406d3b(0x103):case'paid':_0x36cd4d=_0x406d3b(0xed);break;case _0x406d3b(0x18b):case _0x406d3b(0xf8):case _0x406d3b(0x17e):_0x36cd4d=_0x406d3b(0x121);break;case _0x406d3b(0x18d):case'timeout':_0x36cd4d='EXPIRED';break;case'pending':case _0x406d3b(0x108):case _0x406d3b(0x174):default:_0x36cd4d=_0x406d3b(0x161);break;}return console[_0x406d3b(0x112)]('üìä\x20AmPay\x20TRY\x20webhook\x20processed:\x20'+_0x4d1a0a+_0x406d3b(0x13d)+_0x36cd4d),{'paymentId':_0x4d1a0a,'status':_0x36cd4d,'amount':_0x4472c7['amount'],'currency':_0x4472c7['currency']||_0x406d3b(0x190)};}catch(_0x31bee2){console['error'](_0x406d3b(0x16f),_0x31bee2);throw _0x31bee2;}}[a57_0x2fec7b(0x135)](_0x3482af,_0x2748b3){const _0x47e2c8=a57_0x2fec7b;return console[_0x47e2c8(0x112)](_0x47e2c8(0x157)),!![];}}exports['AmPayTRYService']=AmPayTRYService;