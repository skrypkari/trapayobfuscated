'use strict';const a47_0x4221a3=a47_0x44a1;function a47_0x44a1(_0x447e4c,_0x43da6e){const _0x1cae2e=a47_0x1cae();return a47_0x44a1=function(_0x44a188,_0x2c04a1){_0x44a188=_0x44a188-0x135;let _0x268ec9=_0x1cae2e[_0x44a188];return _0x268ec9;},a47_0x44a1(_0x447e4c,_0x43da6e);}(function(_0x28004d,_0x5d3d4a){const _0x18794c=a47_0x44a1,_0x1c25d7=_0x28004d();while(!![]){try{const _0x3057bf=parseInt(_0x18794c(0x165))/0x1*(parseInt(_0x18794c(0x1b5))/0x2)+parseInt(_0x18794c(0x1dc))/0x3*(parseInt(_0x18794c(0x17f))/0x4)+parseInt(_0x18794c(0x1fc))/0x5*(parseInt(_0x18794c(0x1cc))/0x6)+parseInt(_0x18794c(0x18d))/0x7*(parseInt(_0x18794c(0x139))/0x8)+-parseInt(_0x18794c(0x13b))/0x9+parseInt(_0x18794c(0x181))/0xa*(-parseInt(_0x18794c(0x18b))/0xb)+-parseInt(_0x18794c(0x1ae))/0xc;if(_0x3057bf===_0x5d3d4a)break;else _0x1c25d7['push'](_0x1c25d7['shift']());}catch(_0x44abba){_0x1c25d7['push'](_0x1c25d7['shift']());}}}(a47_0x1cae,0xd2694));Object[a47_0x4221a3(0x1b2)](exports,a47_0x4221a3(0x18c),{'value':!![]}),exports[a47_0x4221a3(0x1ec)]=void 0x0;const loggerService_1=require(a47_0x4221a3(0x14e));class AmPayTRYService{constructor(){const _0x242242=a47_0x4221a3;this[_0x242242(0x198)]=_0x242242(0x192),this[_0x242242(0x1e3)]='58b59ccbc03dcdcfc20d830edfba765dbf9f3531c692533d84b17938e9c40bda',this['API_PRIVATE_KEY']='a5a059aa63392e571341bddc5148a5db66643722e9a6bf16a9395fb690a80288931d5a1180a85a28eb9f6516cf61dfc1bf4e37898f3a35261cd2db88888d3815',this[_0x242242(0x146)]=_0x242242(0x159),console['log']('üáπüá∑\x20AmPay\x20TRY\x20service\x20initialized\x20with\x20IBAN\x20Bank\x20Transfer\x20TR\x20processing');}[a47_0x4221a3(0x163)](_0x26c4b0){const _0x144555=a47_0x4221a3,_0x4e5b23={'AD':_0x144555(0x168),'AL':_0x144555(0x194),'AT':_0x144555(0x156),'BA':_0x144555(0x17d),'BE':_0x144555(0x1f0),'BG':_0x144555(0x169),'BY':_0x144555(0x207),'CH':'CHE','CY':'CYP','CZ':_0x144555(0x160),'DE':_0x144555(0x176),'DK':'DNK','EE':_0x144555(0x19a),'ES':_0x144555(0x183),'FI':_0x144555(0x1f6),'FR':_0x144555(0x1bb),'GB':'GBR','GE':_0x144555(0x19f),'GR':'GRC','HR':_0x144555(0x1d7),'HU':'HUN','IE':_0x144555(0x1bf),'IS':_0x144555(0x1ee),'IT':_0x144555(0x143),'LI':_0x144555(0x16f),'LT':_0x144555(0x155),'LU':_0x144555(0x197),'LV':_0x144555(0x15e),'MC':_0x144555(0x1a1),'MD':_0x144555(0x1b3),'ME':_0x144555(0x1de),'MK':'MKD','MT':_0x144555(0x202),'NL':_0x144555(0x186),'NO':_0x144555(0x1cb),'PL':_0x144555(0x162),'PT':_0x144555(0x201),'RO':_0x144555(0x14f),'RS':'SRB','RU':_0x144555(0x1ed),'SE':_0x144555(0x1c1),'SI':_0x144555(0x13c),'SK':_0x144555(0x13f),'SM':_0x144555(0x1da),'UA':_0x144555(0x154),'VA':_0x144555(0x18f),'XK':_0x144555(0x13e),'AM':_0x144555(0x15c),'AZ':'AZE','KZ':_0x144555(0x170),'KG':_0x144555(0x14c),'TJ':_0x144555(0x16d),'TM':_0x144555(0x171),'UZ':_0x144555(0x15b),'US':_0x144555(0x1a4),'CA':_0x144555(0x1dd),'AU':'AUS','JP':_0x144555(0x15a),'CN':'CHN','IN':_0x144555(0x1e0),'BR':_0x144555(0x1a7),'MX':_0x144555(0x17a),'AR':'ARG','CL':'CHL','PE':_0x144555(0x1b4),'CO':_0x144555(0x1f9),'VE':_0x144555(0x19e),'EC':_0x144555(0x138),'BO':_0x144555(0x185),'PY':_0x144555(0x182),'UY':_0x144555(0x184),'SR':_0x144555(0x206),'GY':_0x144555(0x1af),'FK':'FLK','ZA':_0x144555(0x167),'EG':_0x144555(0x137),'NG':_0x144555(0x1f5),'KE':_0x144555(0x1ba),'GH':'GHA','TZ':'TZA','UG':_0x144555(0x209),'ZW':_0x144555(0x1c9),'ZM':_0x144555(0x1c4),'MW':_0x144555(0x145),'MZ':'MOZ','MG':_0x144555(0x1a6),'MU':'MUS','SC':_0x144555(0x14b),'RE':'REU','TR':_0x144555(0x166),'IR':_0x144555(0x1d4),'IQ':_0x144555(0x190),'SA':_0x144555(0x1a2),'AE':_0x144555(0x1bc),'KW':_0x144555(0x1d9),'QA':'QAT','BH':_0x144555(0x177),'OM':_0x144555(0x1ac),'YE':'YEM','JO':_0x144555(0x189),'LB':_0x144555(0x1ab),'SY':'SYR','IL':_0x144555(0x204),'PS':'PSE','KR':_0x144555(0x203),'KP':_0x144555(0x1bd),'TH':_0x144555(0x1e1),'VN':_0x144555(0x174),'MY':_0x144555(0x1a8),'SG':_0x144555(0x1d3),'ID':'IDN','PH':_0x144555(0x193),'LA':_0x144555(0x1b6),'KH':'KHM','MM':_0x144555(0x1fb),'BD':_0x144555(0x147),'LK':_0x144555(0x17c),'NP':_0x144555(0x191),'BT':_0x144555(0x1f3),'MV':_0x144555(0x1ad),'AF':_0x144555(0x141),'PK':'PAK','MN':_0x144555(0x1a5)},_0x5d6f94=_0x4e5b23[_0x26c4b0[_0x144555(0x1ca)]()];if(!_0x5d6f94)return console[_0x144555(0x1a0)](_0x144555(0x150)+_0x26c4b0+_0x144555(0x1c0)),_0x144555(0x166);return _0x5d6f94;}async[a47_0x4221a3(0x151)](_0x2fa0cd){const _0x44c7a6=a47_0x4221a3;console[_0x44c7a6(0x157)](_0x44c7a6(0x1cd),{'paymentId':_0x2fa0cd[_0x44c7a6(0x13a)],'amount':_0x2fa0cd['amount'],'currency':_0x2fa0cd[_0x44c7a6(0x179)],'customerCountry':_0x2fa0cd[_0x44c7a6(0x1df)]});try{const _0x5aee74={'client_merchant_id':this['CLIENT_MERCHANT_ID'],'payment_method':_0x44c7a6(0x142),'client_transaction_id':_0x2fa0cd[_0x44c7a6(0x1a3)],'amount':_0x2fa0cd[_0x44c7a6(0x161)],'currency':_0x2fa0cd[_0x44c7a6(0x179)],'callback_url':_0x44c7a6(0x16a),'tracker_id':_0x2fa0cd[_0x44c7a6(0x13a)],'redirect_url':_0x2fa0cd[_0x44c7a6(0x1fe)],'failure_url':_0x2fa0cd[_0x44c7a6(0x1e6)],'customer_first_name':_0x2fa0cd[_0x44c7a6(0x199)],'customer_last_name':_0x2fa0cd['lastName'],'customer_email':_0x2fa0cd['email'],'customer_phone':_0x2fa0cd[_0x44c7a6(0x1ea)]||'','customer_ip':_0x2fa0cd['customerIp'],'customer_country':_0x2fa0cd['customerCountry'],'api_public_key':this[_0x44c7a6(0x1e3)]};console['log'](_0x44c7a6(0x1db),JSON[_0x44c7a6(0x1d0)](_0x5aee74,null,0x2));const _0x3ea61a=await fetch(this['apiUrl'],{'method':_0x44c7a6(0x1e5),'headers':{'Content-Type':_0x44c7a6(0x180),'User-Agent':_0x44c7a6(0x1a9)},'body':JSON['stringify'](_0x5aee74)});console[_0x44c7a6(0x157)](_0x44c7a6(0x1d2),_0x3ea61a['status']);const _0x1bd6cb=await _0x3ea61a[_0x44c7a6(0x1c2)]();console[_0x44c7a6(0x157)](_0x44c7a6(0x1d8),_0x1bd6cb);let _0x235841;try{_0x235841=JSON[_0x44c7a6(0x1fa)](_0x1bd6cb);}catch(_0x240ee4){console[_0x44c7a6(0x1f4)]('‚ùå\x20Failed\x20to\x20parse\x20AmPay\x20TRY\x20API\x20response:',_0x240ee4);throw new Error(_0x44c7a6(0x17e)+_0x1bd6cb);}console[_0x44c7a6(0x157)](_0x44c7a6(0x205),JSON['stringify'](_0x235841,null,0x2)),loggerService_1[_0x44c7a6(0x144)][_0x44c7a6(0x1d6)]('ampay-try',_0x235841,{});if(!_0x3ea61a['ok']){const _0x4deb7d=_0x235841[_0x44c7a6(0x19d)]||_0x235841[_0x44c7a6(0x172)]||_0x44c7a6(0x19b)+_0x3ea61a[_0x44c7a6(0x175)];console[_0x44c7a6(0x1f4)](_0x44c7a6(0x1f1),_0x4deb7d);throw new Error('AmPay\x20TRY\x20API\x20error:\x20'+_0x4deb7d);}if(!_0x235841[_0x44c7a6(0x1aa)]){console['error'](_0x44c7a6(0x1b8),_0x235841);throw new Error(_0x44c7a6(0x1ff));}const _0x38c74c={'gateway_payment_id':_0x235841['system_id']||_0x2fa0cd[_0x44c7a6(0x1a3)],'payment_url':_0x235841[_0x44c7a6(0x1aa)],'transaction_id':_0x235841[_0x44c7a6(0x13d)]};return console[_0x44c7a6(0x157)]('‚úÖ\x20AmPay\x20TRY\x20payment\x20created\x20successfully:',_0x38c74c),_0x38c74c;}catch(_0x5e055a){console[_0x44c7a6(0x1f4)](_0x44c7a6(0x16c),_0x5e055a),loggerService_1[_0x44c7a6(0x144)][_0x44c7a6(0x18a)](_0x44c7a6(0x1c8),_0x5e055a,_0x2fa0cd);throw _0x5e055a;}}async[a47_0x4221a3(0x164)](_0x2776ca){const _0x26d129=a47_0x4221a3;try{const {orderId:_0x391587,amount:_0x230cc7,currency:_0x2c428f,firstName:_0x3007cf,lastName:_0xc4e24a,email:_0x130bbc,phone:_0x399344,customerIp:_0x54e39f,customerCountry:_0x3d3241,successUrl:_0x2ee5cd,failureUrl:_0x28fc6b}=_0x2776ca;console['log'](_0x26d129(0x18e)),console[_0x26d129(0x157)](_0x26d129(0x1fd),_0x391587),console[_0x26d129(0x157)](_0x26d129(0x208),_0x230cc7,_0x2c428f),console[_0x26d129(0x157)](_0x26d129(0x1e2),_0x3007cf+'\x20'+_0xc4e24a),console[_0x26d129(0x157)](_0x26d129(0x1eb),_0x130bbc),console[_0x26d129(0x157)](_0x26d129(0x1b0),_0x399344||_0x26d129(0x173)),console[_0x26d129(0x157)](_0x26d129(0x1c6),_0x54e39f),console[_0x26d129(0x157)](_0x26d129(0x1e4),_0x3d3241);const _0x3df2c5=this[_0x26d129(0x163)](_0x3d3241);console[_0x26d129(0x157)](_0x26d129(0x1c5),_0x3df2c5);const _0x3f8003={'sub_method':_0x26d129(0x1c3),'currency':_0x2c428f[_0x26d129(0x1ca)](),'amount':_0x230cc7,'callback_url':_0x26d129(0x16a),'client_merchant_id':this[_0x26d129(0x198)],'client_transaction_id':_0x391587,'transaction_description':_0x391587,'customer':{'ip':_0x54e39f,'email':_0x130bbc,'full_name':_0x3007cf+'\x20'+_0xc4e24a,'phone':_0x399344||'','country':_0x3df2c5},'success_redirect_url':_0x2ee5cd,'error_redirect_url':_0x28fc6b};console[_0x26d129(0x157)](_0x26d129(0x153),JSON['stringify'](_0x3f8003,null,0x2));const _0x1764b0=await fetch(this['apiUrl']+'ampay.php',{'method':'POST','headers':{'Content-Type':_0x26d129(0x180),'User-Agent':'TrapayAPI/1.0'},'body':JSON['stringify'](_0x3f8003)}),_0x23d263=await _0x1764b0[_0x26d129(0x1c2)]();console[_0x26d129(0x157)]('üì•\x20AmPay\x20TRY\x20raw\x20response:',_0x23d263);if(!_0x1764b0['ok'])throw new Error(_0x26d129(0x16b)+_0x1764b0[_0x26d129(0x175)]+'\x20-\x20'+_0x23d263);let _0x549c51;try{_0x549c51=JSON[_0x26d129(0x1fa)](_0x23d263);}catch(_0x3050c0){throw new Error(_0x26d129(0x17e)+_0x23d263);}console[_0x26d129(0x157)](_0x26d129(0x158),JSON[_0x26d129(0x1d0)](_0x549c51,null,0x2));if(!_0x549c51[_0x26d129(0x1aa)])throw new Error(_0x26d129(0x140)+(_0x549c51[_0x26d129(0x19d)]||_0x549c51[_0x26d129(0x172)]||_0x26d129(0x1be)));const _0x1a57fb=_0x549c51[_0x26d129(0x1aa)],_0x522296=_0x549c51['system_id'],_0x4b1094=_0x549c51[_0x26d129(0x19c)];return console[_0x26d129(0x157)](_0x26d129(0x1ce)),console['log'](_0x26d129(0x187),_0x1a57fb),console['log'](_0x26d129(0x200),_0x522296),console[_0x26d129(0x157)](_0x26d129(0x1d5),_0x4b1094),console[_0x26d129(0x157)]('Status:',_0x549c51[_0x26d129(0x175)]),console[_0x26d129(0x157)]('üìù\x20Logging\x20AmPay\x20TRY\x20payment\x20creation\x20event...'),{'gateway_payment_id':_0x522296||_0x4b1094||_0x391587,'payment_url':_0x1a57fb||'','transaction_id':_0x522296};}catch(_0x337570){console[_0x26d129(0x1f4)](_0x26d129(0x16c),_0x337570),console[_0x26d129(0x157)](_0x26d129(0x149)),loggerService_1['loggerService'][_0x26d129(0x18a)](_0x26d129(0x1c8),_0x337570,_0x2776ca);throw _0x337570;}}async[a47_0x4221a3(0x1d1)](_0x40c2bd){const _0x44e808=a47_0x4221a3;console[_0x44e808(0x157)]('üîç\x20Checking\x20AmPay\x20TRY\x20payment\x20status\x20for:',_0x40c2bd);try{const _0x481cb9={'client_merchant_id':this[_0x44e808(0x198)],'system_id':_0x40c2bd,'api_public_key':this[_0x44e808(0x1e3)]},_0xd14c7e=await fetch(this[_0x44e808(0x146)]+_0x44e808(0x15d),{'method':_0x44e808(0x1e5),'headers':{'Content-Type':_0x44e808(0x180),'User-Agent':'TrapayEnd/1.0'},'body':JSON['stringify'](_0x481cb9)}),_0x46b965=await _0xd14c7e[_0x44e808(0x1c2)]();console[_0x44e808(0x157)](_0x44e808(0x1b7),_0x46b965);let _0x5a5611;try{_0x5a5611=JSON[_0x44e808(0x1fa)](_0x46b965);}catch(_0x261e5a){return console[_0x44e808(0x1f4)](_0x44e808(0x1e9),_0x261e5a),{'status':_0x44e808(0x1b9)};}console[_0x44e808(0x157)](_0x44e808(0x1e8),JSON['stringify'](_0x5a5611,null,0x2));let _0x3cc6eb=_0x44e808(0x17b);if(_0x5a5611['status'])switch(_0x5a5611[_0x44e808(0x175)][_0x44e808(0x188)]()){case _0x44e808(0x135):case _0x44e808(0x152):case _0x44e808(0x1f8):_0x3cc6eb=_0x44e808(0x14a);break;case'failed':case _0x44e808(0x1f4):case _0x44e808(0x148):_0x3cc6eb='FAILED';break;case _0x44e808(0x1ef):case'timeout':_0x3cc6eb=_0x44e808(0x14d);break;case'pending':case'processing':case'waiting':default:_0x3cc6eb='PENDING';break;}return{'status':_0x3cc6eb,'amount':_0x5a5611[_0x44e808(0x161)],'currency':_0x5a5611[_0x44e808(0x179)]};}catch(_0x2a6fac){return console[_0x44e808(0x1f4)](_0x44e808(0x1f2),_0x2a6fac),{'status':_0x44e808(0x1b9)};}}async[a47_0x4221a3(0x196)](_0x355949){const _0x3c64e0=a47_0x4221a3;console['log'](_0x3c64e0(0x15f),JSON['stringify'](_0x355949,null,0x2));try{const _0x4ab8d1=_0x355949[_0x3c64e0(0x19c)]||_0x355949[_0x3c64e0(0x13d)]||_0x355949[_0x3c64e0(0x1b1)];if(!_0x4ab8d1){console[_0x3c64e0(0x1f4)](_0x3c64e0(0x1cf));throw new Error('No\x20payment\x20ID\x20in\x20webhook\x20data');}let _0x1a9903='PENDING';if(_0x355949[_0x3c64e0(0x175)])switch(_0x355949[_0x3c64e0(0x175)][_0x3c64e0(0x188)]()){case'success':case _0x3c64e0(0x152):case _0x3c64e0(0x1f8):_0x1a9903=_0x3c64e0(0x14a);break;case _0x3c64e0(0x1e7):case _0x3c64e0(0x1f4):case _0x3c64e0(0x148):_0x1a9903=_0x3c64e0(0x1b9);break;case'expired':case _0x3c64e0(0x178):_0x1a9903=_0x3c64e0(0x14d);break;case _0x3c64e0(0x1c7):case _0x3c64e0(0x1f7):case _0x3c64e0(0x136):default:_0x1a9903=_0x3c64e0(0x17b);break;}return console[_0x3c64e0(0x157)](_0x3c64e0(0x195)+_0x4ab8d1+'\x20->\x20'+_0x1a9903),{'paymentId':_0x4ab8d1,'status':_0x1a9903,'amount':_0x355949['amount'],'currency':_0x355949['currency']||_0x3c64e0(0x16e)};}catch(_0x2439ea){console['error']('‚ùå\x20AmPay\x20TRY\x20webhook\x20processing\x20failed:',_0x2439ea);throw _0x2439ea;}}['verifyWebhookSignature'](_0x4d6188,_0x28524d){const _0x427eef=a47_0x4221a3;return console[_0x427eef(0x157)]('üîê\x20AmPay\x20TRY\x20webhook\x20signature\x20verification\x20not\x20implemented\x20yet'),!![];}}function a47_0x1cae(){const _0x3348c9=['ARE','PRK','Unknown\x20error','IRL',',\x20using\x20TUR\x20as\x20fallback\x20for\x20AmPay\x20TRY','SWE','text','GAM','ZMB','Customer\x20Country\x20(3-letter):','Customer\x20IP:','pending','ampay-try','ZWE','toUpperCase','NOR','270102vmHaeS','üöÄ\x20Creating\x20AmPay\x20TRY\x20payment\x20request:','‚úÖ\x20AmPay\x20TRY\x20payment\x20link\x20created\x20successfully','‚ùå\x20No\x20payment\x20ID\x20found\x20in\x20AmPay\x20TRY\x20webhook\x20data','stringify','checkPaymentStatus','üì°\x20AmPay\x20TRY\x20API\x20response\x20status:','SGP','IRN','Tracker\x20ID:','logWebhookReceived','HRV','üìù\x20AmPay\x20TRY\x20API\x20raw\x20response:','KWT','SMR','üì§\x20AmPay\x20TRY\x20API\x20request\x20data:','1266069zCzYdw','CAN','MNE','customerCountry','IND','THA','Customer:','API_PUBLIC_KEY','Customer\x20Country\x20(2-letter):','POST','failureUrl','failed','üìä\x20AmPay\x20TRY\x20status\x20response:','‚ùå\x20Failed\x20to\x20parse\x20AmPay\x20TRY\x20status\x20response:','phone','Email:','AmPayTRYService','RUS','ISL','expired','BEL','‚ùå\x20AmPay\x20TRY\x20API\x20error:','‚ùå\x20AmPay\x20TRY\x20status\x20check\x20failed:','BTN','error','NGA','FIN','processing','paid','COL','parse','MMR','115ySGnqR','Order\x20ID:','successUrl','AmPay\x20TRY\x20did\x20not\x20return\x20a\x20payment\x20URL','System\x20ID:','PRT','MLT','KOR','ISR','üìä\x20AmPay\x20TRY\x20parsed\x20response:','SUR','BLR','Amount:','UGA','success','waiting','EGY','ECU','16zuWNOh','paymentId','535599fOCneO','SVN','client_transaction_id','XKX','SVK','AmPay\x20TRY\x20payment\x20creation\x20failed:\x20','AFG','Bank\x20Transfer\x20TR','ITA','loggerService','MWI','apiUrl','BGD','declined','üìù\x20Logging\x20AmPay\x20TRY\x20payment\x20creation\x20failure...','PAID','SYC','KGZ','EXPIRED','../loggerService','ROU','‚ö†Ô∏è\x20Unknown\x20country\x20code:\x20','createPayment','completed','üì§\x20AmPay\x20TRY\x20request\x20body:','UKR','LTU','AUT','log','üìä\x20AmPay\x20TRY\x20response\x20data:','https://traffer.uk/gateway/ampay-try/','JPN','UZB','ARM','/status','LVA','üì•\x20Processing\x20AmPay\x20TRY\x20webhook:','CZE','amount','POL','convert2LetterTo3LetterCountryCode','createPaymentLink','4877yITsbx','TUR','ZAF','AND','BGR','https://traffer.uk/gateway/ampay-try/webhook.php','AmPay\x20TRY\x20API\x20error:\x20HTTP\x20','‚ùå\x20AmPay\x20TRY\x20payment\x20creation\x20failed:','TJK','TRY','LIE','KAZ','TKM','message','not\x20provided','VNM','status','DEU','BHR','timeout','currency','MEX','PENDING','LKA','BIH','Invalid\x20JSON\x20response\x20from\x20AmPay\x20TRY:\x20','4TIvsLo','application/json','2865770mDFedR','PRY','ESP','URY','BOL','NLD','Payment\x20URL:','toLowerCase','JOR','logWebhookError','11gZbuPM','__esModule','2787358ImTFlN','üáπüá∑\x20Creating\x20AmPay\x20TRY\x20payment\x20link...','VAT','IRQ','NPL','TRAFFER','PHL','ALB','üìä\x20AmPay\x20TRY\x20webhook\x20processed:\x20','processWebhook','LUX','CLIENT_MERCHANT_ID','firstName','EST','HTTP\x20','tracker_id','error_message','VEN','GEO','warn','MCO','SAU','orderId','USA','MNG','MDG','BRA','MYS','TrapayEnd/1.0','redirect_url','LBN','OMN','MDV','25601292izOOFP','GUY','Phone:','system_id','defineProperty','MDA','PER','446gkupcH','LAO','üìù\x20AmPay\x20TRY\x20status\x20raw\x20response:','‚ùå\x20No\x20redirect_url\x20in\x20AmPay\x20TRY\x20response:','FAILED','KEN','FRA'];a47_0x1cae=function(){return _0x3348c9;};return a47_0x1cae();}exports['AmPayTRYService']=AmPayTRYService;