'use strict';const a45_0x131339=a45_0x57ae;(function(_0x1fcbba,_0x254edd){const _0xccda5c=a45_0x57ae,_0xa0a91a=_0x1fcbba();while(!![]){try{const _0x55b0eb=-parseInt(_0xccda5c(0xf9))/0x1*(-parseInt(_0xccda5c(0x7e))/0x2)+parseInt(_0xccda5c(0xed))/0x3*(-parseInt(_0xccda5c(0x94))/0x4)+-parseInt(_0xccda5c(0xe9))/0x5*(-parseInt(_0xccda5c(0xde))/0x6)+parseInt(_0xccda5c(0xbb))/0x7*(parseInt(_0xccda5c(0x76))/0x8)+-parseInt(_0xccda5c(0x9f))/0x9*(parseInt(_0xccda5c(0xd6))/0xa)+parseInt(_0xccda5c(0x13b))/0xb+parseInt(_0xccda5c(0x11d))/0xc*(-parseInt(_0xccda5c(0x89))/0xd);if(_0x55b0eb===_0x254edd)break;else _0xa0a91a['push'](_0xa0a91a['shift']());}catch(_0xc6ce98){_0xa0a91a['push'](_0xa0a91a['shift']());}}}(a45_0x2533,0x57631));Object[a45_0x131339(0x99)](exports,a45_0x131339(0x7c),{'value':!![]}),exports['AmPayTRYService']=void 0x0;const loggerService_1=require(a45_0x131339(0xf5));function a45_0x57ae(_0x5d0327,_0x4fc367){const _0x2533b8=a45_0x2533();return a45_0x57ae=function(_0x57aeb5,_0x473cce){_0x57aeb5=_0x57aeb5-0x76;let _0x1ffd5c=_0x2533b8[_0x57aeb5];return _0x1ffd5c;},a45_0x57ae(_0x5d0327,_0x4fc367);}class AmPayTRYService{constructor(){const _0x5ce6ed=a45_0x131339;this['CLIENT_MERCHANT_ID']=_0x5ce6ed(0xc7),this[_0x5ce6ed(0x127)]=_0x5ce6ed(0xd5),this[_0x5ce6ed(0xaa)]=_0x5ce6ed(0xcf),this[_0x5ce6ed(0x7b)]=_0x5ce6ed(0xb5),console[_0x5ce6ed(0xf7)](_0x5ce6ed(0xfa));}[a45_0x131339(0x86)](_0x4b66fc){const _0x398f15=a45_0x131339,_0x1f2d55={'AD':_0x398f15(0x13f),'AL':'ALB','AT':'AUT','BA':_0x398f15(0xda),'BE':'BEL','BG':_0x398f15(0xc8),'BY':'BLR','CH':_0x398f15(0xec),'CY':_0x398f15(0xd9),'CZ':_0x398f15(0xb0),'DE':_0x398f15(0x121),'DK':_0x398f15(0xf0),'EE':'EST','ES':_0x398f15(0xd1),'FI':_0x398f15(0x122),'FR':_0x398f15(0xa7),'GB':'GBR','GE':'GEO','GR':_0x398f15(0x11c),'HR':'HRV','HU':_0x398f15(0x80),'IE':'IRL','IS':_0x398f15(0x131),'IT':'ITA','LI':_0x398f15(0x85),'LT':_0x398f15(0x87),'LU':_0x398f15(0x90),'LV':_0x398f15(0xc6),'MC':_0x398f15(0xaf),'MD':'MDA','ME':'MNE','MK':_0x398f15(0xc0),'MT':'MLT','NL':_0x398f15(0x113),'NO':_0x398f15(0xac),'PL':'POL','PT':_0x398f15(0xdb),'RO':_0x398f15(0x124),'RS':_0x398f15(0xa1),'RU':_0x398f15(0xdd),'SE':_0x398f15(0x11a),'SI':_0x398f15(0xf6),'SK':_0x398f15(0x79),'SM':_0x398f15(0xf3),'UA':_0x398f15(0xab),'VA':_0x398f15(0xc5),'XK':'XKX','AM':'ARM','AZ':'AZE','KZ':_0x398f15(0x109),'KG':_0x398f15(0xeb),'TJ':_0x398f15(0xe0),'TM':_0x398f15(0x93),'UZ':'UZB','US':_0x398f15(0x8f),'CA':_0x398f15(0xe4),'AU':_0x398f15(0x107),'JP':_0x398f15(0xca),'CN':_0x398f15(0xfd),'IN':_0x398f15(0x81),'BR':'BRA','MX':_0x398f15(0xb9),'AR':_0x398f15(0xe6),'CL':'CHL','PE':_0x398f15(0x11e),'CO':_0x398f15(0x9b),'VE':'VEN','EC':_0x398f15(0x91),'BO':_0x398f15(0x82),'PY':_0x398f15(0xd4),'UY':_0x398f15(0xe1),'SR':'SUR','GY':_0x398f15(0xfe),'FK':_0x398f15(0xfc),'ZA':_0x398f15(0xb3),'EG':_0x398f15(0x104),'NG':'NGA','KE':'KEN','GH':_0x398f15(0xe2),'TZ':_0x398f15(0x136),'UG':'UGA','ZW':_0x398f15(0xcc),'ZM':_0x398f15(0xa8),'MW':_0x398f15(0xcb),'MZ':_0x398f15(0x13c),'MG':_0x398f15(0x97),'MU':_0x398f15(0xc1),'SC':'SYC','RE':_0x398f15(0x105),'TR':_0x398f15(0x112),'IR':_0x398f15(0x125),'IQ':_0x398f15(0x129),'SA':_0x398f15(0x108),'AE':'ARE','KW':'KWT','QA':_0x398f15(0xf1),'BH':'BHR','OM':'OMN','YE':_0x398f15(0x7d),'JO':_0x398f15(0x12c),'LB':_0x398f15(0x128),'SY':_0x398f15(0xb6),'IL':_0x398f15(0x103),'PS':_0x398f15(0x138),'KR':_0x398f15(0x9e),'KP':'PRK','TH':_0x398f15(0x101),'VN':_0x398f15(0xb1),'MY':_0x398f15(0xc4),'SG':'SGP','ID':_0x398f15(0x12d),'PH':'PHL','LA':_0x398f15(0x8d),'KH':'KHM','MM':'MMR','BD':_0x398f15(0x8b),'LK':_0x398f15(0x13e),'NP':_0x398f15(0x13a),'BT':_0x398f15(0x10a),'MV':_0x398f15(0xb4),'AF':_0x398f15(0xb2),'PK':'PAK','MN':'MNG'},_0x57b8f3=_0x1f2d55[_0x4b66fc[_0x398f15(0x123)]()];if(!_0x57b8f3)return console[_0x398f15(0xf8)](_0x398f15(0x12e)+_0x4b66fc+_0x398f15(0xa5)),_0x398f15(0x112);return _0x57b8f3;}async['createPayment'](_0x273f42){const _0xd9c123=a45_0x131339;console[_0xd9c123(0xf7)]('üöÄ\x20Creating\x20AmPay\x20TRY\x20payment\x20request:',{'paymentId':_0x273f42['paymentId'],'amount':_0x273f42['amount'],'currency':_0x273f42[_0xd9c123(0xcd)],'customerCountry':_0x273f42['customerCountry']});try{const _0x33bf3b={'client_merchant_id':this[_0xd9c123(0xdf)],'payment_method':_0xd9c123(0x84),'client_transaction_id':_0x273f42[_0xd9c123(0x115)],'amount':_0x273f42['amount'],'currency':_0x273f42[_0xd9c123(0xcd)],'callback_url':_0xd9c123(0x135),'tracker_id':_0x273f42[_0xd9c123(0xbc)],'redirect_url':_0x273f42[_0xd9c123(0xa9)],'failure_url':_0x273f42[_0xd9c123(0x12f)],'customer_first_name':_0x273f42[_0xd9c123(0xdc)],'customer_last_name':_0x273f42[_0xd9c123(0x10d)],'customer_email':_0x273f42[_0xd9c123(0xba)],'customer_phone':_0x273f42[_0xd9c123(0xbd)]||'','customer_ip':_0x273f42['customerIp'],'customer_country':_0x273f42[_0xd9c123(0x78)],'api_public_key':this['API_PUBLIC_KEY']};console[_0xd9c123(0xf7)](_0xd9c123(0xb7),JSON[_0xd9c123(0xc3)](_0x33bf3b,null,0x2));const _0x1a4d24=await fetch(this['apiUrl'],{'method':_0xd9c123(0x9d),'headers':{'Content-Type':_0xd9c123(0x120),'User-Agent':_0xd9c123(0xd3)},'body':JSON[_0xd9c123(0xc3)](_0x33bf3b)});console[_0xd9c123(0xf7)](_0xd9c123(0x119),_0x1a4d24[_0xd9c123(0xf2)]);const _0x42a734=await _0x1a4d24[_0xd9c123(0xc9)]();console['log'](_0xd9c123(0xe5),_0x42a734);let _0x180b8a;try{_0x180b8a=JSON[_0xd9c123(0x139)](_0x42a734);}catch(_0x104e99){console[_0xd9c123(0x10b)](_0xd9c123(0x98),_0x104e99);throw new Error(_0xd9c123(0x137)+_0x42a734);}console[_0xd9c123(0xf7)]('üìä\x20AmPay\x20TRY\x20parsed\x20response:',JSON['stringify'](_0x180b8a,null,0x2)),loggerService_1['loggerService'][_0xd9c123(0xa4)](_0xd9c123(0x118),_0x180b8a,{});if(!_0x1a4d24['ok']){const _0x870274=_0x180b8a[_0xd9c123(0x116)]||_0x180b8a['message']||_0xd9c123(0xe7)+_0x1a4d24[_0xd9c123(0xf2)];console[_0xd9c123(0x10b)](_0xd9c123(0xd8),_0x870274);throw new Error('AmPay\x20TRY\x20API\x20error:\x20'+_0x870274);}if(!_0x180b8a[_0xd9c123(0x88)]){console['error']('‚ùå\x20No\x20redirect_url\x20in\x20AmPay\x20TRY\x20response:',_0x180b8a);throw new Error('AmPay\x20TRY\x20did\x20not\x20return\x20a\x20payment\x20URL');}const _0x595038={'gateway_payment_id':_0x180b8a[_0xd9c123(0x77)]||_0x273f42[_0xd9c123(0x115)],'payment_url':_0x180b8a[_0xd9c123(0x88)],'transaction_id':_0x180b8a['client_transaction_id']};return console[_0xd9c123(0xf7)](_0xd9c123(0x7f),_0x595038),_0x595038;}catch(_0x3262cc){console[_0xd9c123(0x10b)](_0xd9c123(0x11f),_0x3262cc),loggerService_1[_0xd9c123(0xa6)][_0xd9c123(0x10f)](_0xd9c123(0x118),_0x3262cc,_0x273f42);throw _0x3262cc;}}async[a45_0x131339(0xc2)](_0x376702){const _0x3982ae=a45_0x131339;try{const {orderId:_0x419284,amount:_0x14c82e,currency:_0x374e9c,firstName:_0x165f5f,lastName:_0x2822d6,email:_0x4e36d1,customerIp:_0x2af3bd,customerCountry:_0x46021e,successUrl:_0x2be8c5,failureUrl:_0x3b84be}=_0x376702;console[_0x3982ae(0xf7)](_0x3982ae(0x133)),console[_0x3982ae(0xf7)](_0x3982ae(0xff),_0x419284),console['log'](_0x3982ae(0x134),_0x14c82e,_0x374e9c),console['log'](_0x3982ae(0xce),_0x165f5f+'\x20'+_0x2822d6),console['log'](_0x3982ae(0xe3),_0x4e36d1),console['log'](_0x3982ae(0x8a),_0x2af3bd),console[_0x3982ae(0xf7)](_0x3982ae(0x96),_0x46021e);const _0x47f588=this[_0x3982ae(0x86)](_0x46021e);console[_0x3982ae(0xf7)](_0x3982ae(0x9a),_0x47f588);const _0x4b07e9={'sub_method':'GAM','currency':_0x374e9c['toUpperCase'](),'amount':_0x14c82e,'callback_url':_0x3982ae(0x92),'client_merchant_id':this['CLIENT_MERCHANT_ID'],'client_transaction_id':_0x419284,'transaction_description':_0x419284,'customer':{'ip':_0x2af3bd,'email':_0x4e36d1,'full_name':_0x165f5f+'\x20'+_0x2822d6,'country':_0x47f588},'success_redirect_url':_0x2be8c5,'error_redirect_url':_0x3b84be};console[_0x3982ae(0xf7)](_0x3982ae(0xd2),JSON['stringify'](_0x4b07e9,null,0x2));const _0x31475f=await fetch(this[_0x3982ae(0x7b)]+_0x3982ae(0x132),{'method':_0x3982ae(0x9d),'headers':{'Content-Type':_0x3982ae(0x120),'User-Agent':_0x3982ae(0xbe)},'body':JSON[_0x3982ae(0xc3)](_0x4b07e9)}),_0x42ff15=await _0x31475f[_0x3982ae(0xc9)]();console[_0x3982ae(0xf7)](_0x3982ae(0xd0),_0x42ff15);if(!_0x31475f['ok'])throw new Error('AmPay\x20TRY\x20API\x20error:\x20HTTP\x20'+_0x31475f[_0x3982ae(0xf2)]+'\x20-\x20'+_0x42ff15);let _0x3ef27a;try{_0x3ef27a=JSON[_0x3982ae(0x139)](_0x42ff15);}catch(_0x45d223){throw new Error(_0x3982ae(0x137)+_0x42ff15);}console[_0x3982ae(0xf7)](_0x3982ae(0x111),JSON[_0x3982ae(0xc3)](_0x3ef27a,null,0x2));if(!_0x3ef27a[_0x3982ae(0x88)])throw new Error(_0x3982ae(0xef)+(_0x3ef27a['error_message']||_0x3ef27a[_0x3982ae(0x12a)]||'Unknown\x20error'));const _0x1f360a=_0x3ef27a[_0x3982ae(0x88)],_0x3212e2=_0x3ef27a[_0x3982ae(0x77)],_0x3264a4=_0x3ef27a[_0x3982ae(0x130)];return console[_0x3982ae(0xf7)](_0x3982ae(0x110)),console[_0x3982ae(0xf7)]('Payment\x20URL:',_0x1f360a),console[_0x3982ae(0xf7)]('System\x20ID:',_0x3212e2),console[_0x3982ae(0xf7)]('Tracker\x20ID:',_0x3264a4),console[_0x3982ae(0xf7)](_0x3982ae(0x7a),_0x3ef27a[_0x3982ae(0xf2)]),console[_0x3982ae(0xf7)](_0x3982ae(0xfb)),{'gateway_payment_id':_0x3212e2||_0x3264a4||_0x419284,'payment_url':_0x1f360a||'','transaction_id':_0x3212e2};}catch(_0x55ea1d){console[_0x3982ae(0x10b)](_0x3982ae(0x11f),_0x55ea1d),console[_0x3982ae(0xf7)](_0x3982ae(0x10e)),loggerService_1[_0x3982ae(0xa6)][_0x3982ae(0x10f)](_0x3982ae(0x118),_0x55ea1d,_0x376702);throw _0x55ea1d;}}async['checkPaymentStatus'](_0x4c2bc9){const _0x3096d7=a45_0x131339;console[_0x3096d7(0xf7)]('üîç\x20Checking\x20AmPay\x20TRY\x20payment\x20status\x20for:',_0x4c2bc9);try{const _0xa1e52e={'client_merchant_id':this[_0x3096d7(0xdf)],'system_id':_0x4c2bc9,'api_public_key':this[_0x3096d7(0x127)]},_0x1c6d7d=await fetch(this[_0x3096d7(0x7b)]+_0x3096d7(0x117),{'method':_0x3096d7(0x9d),'headers':{'Content-Type':_0x3096d7(0x120),'User-Agent':'TrapayEnd/1.0'},'body':JSON['stringify'](_0xa1e52e)}),_0x40b37c=await _0x1c6d7d['text']();console[_0x3096d7(0xf7)](_0x3096d7(0x8c),_0x40b37c);let _0x1b7b4e;try{_0x1b7b4e=JSON[_0x3096d7(0x139)](_0x40b37c);}catch(_0x703f93){return console[_0x3096d7(0x10b)](_0x3096d7(0xee),_0x703f93),{'status':'FAILED'};}console[_0x3096d7(0xf7)]('üìä\x20AmPay\x20TRY\x20status\x20response:',JSON['stringify'](_0x1b7b4e,null,0x2));let _0x116486=_0x3096d7(0xa0);if(_0x1b7b4e[_0x3096d7(0xf2)])switch(_0x1b7b4e[_0x3096d7(0xf2)][_0x3096d7(0xa3)]()){case _0x3096d7(0x10c):case _0x3096d7(0x114):case _0x3096d7(0xb8):_0x116486=_0x3096d7(0x13d);break;case _0x3096d7(0xbf):case'error':case'declined':_0x116486='FAILED';break;case'expired':case _0x3096d7(0x100):_0x116486=_0x3096d7(0xf4);break;case _0x3096d7(0x9c):case _0x3096d7(0x8e):case'waiting':default:_0x116486=_0x3096d7(0xa0);break;}return{'status':_0x116486,'amount':_0x1b7b4e[_0x3096d7(0xa2)],'currency':_0x1b7b4e[_0x3096d7(0xcd)]};}catch(_0x1f2257){return console['error'](_0x3096d7(0xae),_0x1f2257),{'status':_0x3096d7(0x126)};}}async['processWebhook'](_0x4f05ff){const _0x10a4e3=a45_0x131339;console[_0x10a4e3(0xf7)](_0x10a4e3(0xd7),JSON[_0x10a4e3(0xc3)](_0x4f05ff,null,0x2));try{const _0x58824d=_0x4f05ff[_0x10a4e3(0x130)]||_0x4f05ff['client_transaction_id']||_0x4f05ff[_0x10a4e3(0x77)];if(!_0x58824d){console[_0x10a4e3(0x10b)](_0x10a4e3(0xe8));throw new Error(_0x10a4e3(0x95));}let _0x562655='PENDING';if(_0x4f05ff['status'])switch(_0x4f05ff[_0x10a4e3(0xf2)][_0x10a4e3(0xa3)]()){case'success':case _0x10a4e3(0x114):case _0x10a4e3(0xb8):_0x562655=_0x10a4e3(0x13d);break;case _0x10a4e3(0xbf):case _0x10a4e3(0x10b):case _0x10a4e3(0x106):_0x562655=_0x10a4e3(0x126);break;case'expired':case'timeout':_0x562655=_0x10a4e3(0xf4);break;case'pending':case _0x10a4e3(0x8e):case'waiting':default:_0x562655=_0x10a4e3(0xa0);break;}return console[_0x10a4e3(0xf7)](_0x10a4e3(0xea)+_0x58824d+_0x10a4e3(0x11b)+_0x562655),{'paymentId':_0x58824d,'status':_0x562655,'amount':_0x4f05ff[_0x10a4e3(0xa2)],'currency':_0x4f05ff[_0x10a4e3(0xcd)]||_0x10a4e3(0x83)};}catch(_0x561983){console[_0x10a4e3(0x10b)](_0x10a4e3(0xad),_0x561983);throw _0x561983;}}[a45_0x131339(0x102)](_0xe08bf9,_0x58fb40){const _0x2d0bf6=a45_0x131339;return console[_0x2d0bf6(0xf7)](_0x2d0bf6(0x140)),!![];}}exports[a45_0x131339(0x12b)]=AmPayTRYService;function a45_0x2533(){const _0x2b01cb=['https://traffer.uk/gateway/ampay-try/','SYR','üì§\x20AmPay\x20TRY\x20API\x20request\x20data:','paid','MEX','email','7zNyWon','paymentId','phone','TrapayAPI/1.0','failed','MKD','MUS','createPaymentLink','stringify','MYS','VAT','LVA','TRAFFER','BGR','text','JPN','MWI','ZWE','currency','Customer:','a5a059aa63392e571341bddc5148a5db66643722e9a6bf16a9395fb690a80288931d5a1180a85a28eb9f6516cf61dfc1bf4e37898f3a35261cd2db88888d3815','üì•\x20AmPay\x20TRY\x20raw\x20response:','ESP','üì§\x20AmPay\x20TRY\x20request\x20body:','TrapayEnd/1.0','PRY','58b59ccbc03dcdcfc20d830edfba765dbf9f3531c692533d84b17938e9c40bda','290UQAGHq','üì•\x20Processing\x20AmPay\x20TRY\x20webhook:','‚ùå\x20AmPay\x20TRY\x20API\x20error:','CYP','BIH','PRT','firstName','RUS','6VPkwVI','CLIENT_MERCHANT_ID','TJK','URY','GHA','Email:','CAN','üìù\x20AmPay\x20TRY\x20API\x20raw\x20response:','ARG','HTTP\x20','‚ùå\x20No\x20payment\x20ID\x20found\x20in\x20AmPay\x20TRY\x20webhook\x20data','2701350wcpwOP','üìä\x20AmPay\x20TRY\x20webhook\x20processed:\x20','KGZ','CHE','18sYiFhx','‚ùå\x20Failed\x20to\x20parse\x20AmPay\x20TRY\x20status\x20response:','AmPay\x20TRY\x20payment\x20creation\x20failed:\x20','DNK','QAT','status','SMR','EXPIRED','../loggerService','SVN','log','warn','536689YRNecj','üáπüá∑\x20AmPay\x20TRY\x20service\x20initialized\x20with\x20IBAN\x20Bank\x20Transfer\x20TR\x20processing','üìù\x20Logging\x20AmPay\x20TRY\x20payment\x20creation\x20event...','FLK','CHN','GUY','Order\x20ID:','timeout','THA','verifyWebhookSignature','ISR','EGY','REU','declined','AUS','SAU','KAZ','BTN','error','success','lastName','üìù\x20Logging\x20AmPay\x20TRY\x20payment\x20creation\x20failure...','logWebhookError','‚úÖ\x20AmPay\x20TRY\x20payment\x20link\x20created\x20successfully','üìä\x20AmPay\x20TRY\x20response\x20data:','TUR','NLD','completed','orderId','error_message','/status','ampay-try','üì°\x20AmPay\x20TRY\x20API\x20response\x20status:','SWE','\x20->\x20','GRC','2020116esQSuP','PER','‚ùå\x20AmPay\x20TRY\x20payment\x20creation\x20failed:','application/json','DEU','FIN','toUpperCase','ROU','IRN','FAILED','API_PUBLIC_KEY','LBN','IRQ','message','AmPayTRYService','JOR','IDN','‚ö†Ô∏è\x20Unknown\x20country\x20code:\x20','failureUrl','tracker_id','ISL','ampay.php','üáπüá∑\x20Creating\x20AmPay\x20TRY\x20payment\x20link...','Amount:','https://traffer.uk/webhook/gateway/ampay-try','TZA','Invalid\x20JSON\x20response\x20from\x20AmPay\x20TRY:\x20','PSE','parse','NPL','3215509ohYdAd','MOZ','PAID','LKA','AND','üîê\x20AmPay\x20TRY\x20webhook\x20signature\x20verification\x20not\x20implemented\x20yet','2704648UFXyEd','system_id','customerCountry','SVK','Status:','apiUrl','__esModule','YEM','2jQiLuy','‚úÖ\x20AmPay\x20TRY\x20payment\x20created\x20successfully:','HUN','IND','BOL','TRY','Bank\x20Transfer\x20TR','LIE','convert2LetterTo3LetterCountryCode','LTU','redirect_url','39woqyQw','Customer\x20IP:','BGD','üìù\x20AmPay\x20TRY\x20status\x20raw\x20response:','LAO','processing','USA','LUX','ECU','https://traffer.uk/gateway/ampay-try/webhook.php','TKM','400780RrqSmO','No\x20payment\x20ID\x20in\x20webhook\x20data','Customer\x20Country\x20(2-letter):','MDG','‚ùå\x20Failed\x20to\x20parse\x20AmPay\x20TRY\x20API\x20response:','defineProperty','Customer\x20Country\x20(3-letter):','COL','pending','POST','KOR','75483SXAvbU','PENDING','SRB','amount','toLowerCase','logWebhookReceived',',\x20using\x20TUR\x20as\x20fallback\x20for\x20AmPay\x20TRY','loggerService','FRA','ZMB','successUrl','API_PRIVATE_KEY','UKR','NOR','‚ùå\x20AmPay\x20TRY\x20webhook\x20processing\x20failed:','‚ùå\x20AmPay\x20TRY\x20status\x20check\x20failed:','MCO','CZE','VNM','AFG','ZAF','MDV'];a45_0x2533=function(){return _0x2b01cb;};return a45_0x2533();}