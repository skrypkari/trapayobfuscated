'use strict';const a53_0x2923c2=a53_0x2feb;function a53_0xb0d6(){const _0x2ce4c3=['‚ùå\x20AmPay\x20TRY\x20webhook\x20processing\x20failed:','waiting','üì•\x20AmPay\x20TRY\x20raw\x20response:','HUN','208tuQeXk','‚ùå\x20Failed\x20to\x20parse\x20AmPay\x20TRY\x20status\x20response:','CHN',',\x20using\x20TUR\x20as\x20fallback\x20for\x20AmPay\x20TRY','GBR','BTN','SGP','EGY','log','ISR','üáπüá∑\x20Creating\x20AmPay\x20TRY\x20payment\x20link...','TrapayEnd/1.0','AmPay\x20TRY\x20did\x20not\x20return\x20a\x20payment\x20URL','RUS','üì•\x20Processing\x20AmPay\x20TRY\x20webhook:','createPayment','LBN','ARM','parse','‚ùå\x20AmPay\x20TRY\x20payment\x20creation\x20failed:','MNG','164024GKuBmY','üì°\x20AmPay\x20TRY\x20API\x20response\x20status:','ECU','SVK','üìù\x20Logging\x20AmPay\x20TRY\x20payment\x20creation\x20event...','System\x20ID:','PAID','apiUrl','XKX','ITA','CZE','NGA','expired','/status','577320zGlnbV','üìù\x20AmPay\x20TRY\x20API\x20raw\x20response:','üìä\x20AmPay\x20TRY\x20parsed\x20response:','üìù\x20Logging\x20AmPay\x20TRY\x20payment\x20creation\x20failure...','KOR','ESP','BHR','REU','BGD','LUX','PRT','paid','Payment\x20URL:','562360PJrRXz','ampay.php','application/json','toLowerCase','GRC','Email:','UGA','üìä\x20AmPay\x20TRY\x20status\x20response:','AUT','‚ùå\x20AmPay\x20TRY\x20status\x20check\x20failed:','currency','19085ULakyX','DNK','\x20->\x20','redirect_url','ZMB','POST','BIH','declined','BGR','error_message','success','loggerService','VNM','HTTP\x20','IRL','failed','Status:','FAILED','SYC','Customer\x20Country\x20(3-letter):','üáπüá∑\x20AmPay\x20TRY\x20service\x20initialized\x20with\x20IBAN\x20Bank\x20Transfer\x20TR\x20processing','MYS','logWebhookError','üîç\x20Checking\x20AmPay\x20TRY\x20payment\x20status\x20for:','IND','client_transaction_id','Phone:','GHA','MCO','KEN','IDN','URY','AmPay\x20TRY\x20payment\x20creation\x20failed:\x20','LKA','AmPay\x20TRY\x20API\x20error:\x20HTTP\x20','‚ùå\x20No\x20payment\x20ID\x20found\x20in\x20AmPay\x20TRY\x20webhook\x20data','AmPay\x20TRY\x20API\x20error:\x20','Bank\x20Transfer\x20TR','‚ùå\x20Failed\x20to\x20parse\x20AmPay\x20TRY\x20API\x20response:','LTU','TUR','TRAFFER','__esModule','MKD','system_id','MUS','GAM','processing','ZWE','üì§\x20AmPay\x20TRY\x20request\x20body:','MMR','LVA','phone','JPN','üìù\x20AmPay\x20TRY\x20status\x20raw\x20response:','MNE','üîê\x20AmPay\x20TRY\x20webhook\x20signature\x20verification\x20not\x20implemented\x20yet','amount','defineProperty','MEX','UKR','customerCountry','ALB','SRB','convert2LetterTo3LetterCountryCode','lastName','TKM','PHL','error','üìä\x20AmPay\x20TRY\x20webhook\x20processed:\x20','Customer\x20IP:','SYR','AZE','QAT','ARE','../loggerService','DEU','failureUrl','a5a059aa63392e571341bddc5148a5db66643722e9a6bf16a9395fb690a80288931d5a1180a85a28eb9f6516cf61dfc1bf4e37898f3a35261cd2db88888d3815','‚úÖ\x20AmPay\x20TRY\x20payment\x20link\x20created\x20successfully','USA','MOZ','FRA','CYP','Unknown\x20error','email','CLIENT_MERCHANT_ID','No\x20payment\x20ID\x20in\x20webhook\x20data','üìä\x20AmPay\x20TRY\x20response\x20data:','paymentId','warn','stringify','timeout','Order\x20ID:','createPaymentLink','verifyWebhookSignature','Customer:','UZB','KAZ','CHE','NLD','pending','191904zCcDIQ','TrapayAPI/1.0','tracker_id','ARG','PENDING','KWT','status','LAO','KGZ','‚ùå\x20AmPay\x20TRY\x20API\x20error:','AmPayTRYService','BLR','\x20-\x20','ampay-try','‚ö†Ô∏è\x20Unknown\x20country\x20code:\x20','BOL','COL','989412LoBYKh','text','BEL','ISL','35jeUlNk','TRY','https://traffer.uk/gateway/ampay-try/webhook.php','PAK','logWebhookReceived','TZA','HRV','SMR','processWebhook','PRY','CHL','üöÄ\x20Creating\x20AmPay\x20TRY\x20payment\x20request:','1525500MQlsJc','GEO','OMN','IRQ','MWI','NPL','‚ùå\x20No\x20redirect_url\x20in\x20AmPay\x20TRY\x20response:','58b59ccbc03dcdcfc20d830edfba765dbf9f3531c692533d84b17938e9c40bda','toUpperCase','API_PUBLIC_KEY','YEM','FLK','PRK','MDV'];a53_0xb0d6=function(){return _0x2ce4c3;};return a53_0xb0d6();}(function(_0x553762,_0x13e45a){const _0x2032f6=a53_0x2feb,_0x3ad5ed=_0x553762();while(!![]){try{const _0x164514=-parseInt(_0x2032f6(0x16a))/0x1+parseInt(_0x2032f6(0xf9))/0x2+parseInt(_0x2032f6(0xec))/0x3+-parseInt(_0x2032f6(0x19d))/0x4*(parseInt(_0x2032f6(0x104))/0x5)+-parseInt(_0x2032f6(0x17b))/0x6+parseInt(_0x2032f6(0x17f))/0x7*(parseInt(_0x2032f6(0xde))/0x8)+parseInt(_0x2032f6(0x18b))/0x9;if(_0x164514===_0x13e45a)break;else _0x3ad5ed['push'](_0x3ad5ed['shift']());}catch(_0x1730c7){_0x3ad5ed['push'](_0x3ad5ed['shift']());}}}(a53_0xb0d6,0x2e789));Object[a53_0x2923c2(0x13e)](exports,a53_0x2923c2(0x12e),{'value':!![]}),exports[a53_0x2923c2(0x174)]=void 0x0;function a53_0x2feb(_0x4983d7,_0xed249b){_0x4983d7=_0x4983d7-0xd2;const _0xb0d64f=a53_0xb0d6();let _0x2febab=_0xb0d64f[_0x4983d7];return _0x2febab;}const loggerService_1=require(a53_0x2923c2(0x14f));class AmPayTRYService{constructor(){const _0x17c9ba=a53_0x2923c2;this[_0x17c9ba(0x15a)]=_0x17c9ba(0x12d),this['API_PUBLIC_KEY']=_0x17c9ba(0x192),this['API_PRIVATE_KEY']=_0x17c9ba(0x152),this[_0x17c9ba(0xe5)]='https://traffer.uk/gateway/ampay-try/',console[_0x17c9ba(0x1a5)](_0x17c9ba(0x118));}[a53_0x2923c2(0x144)](_0x2b8a82){const _0x33affd=a53_0x2923c2,_0x491e74={'AD':'AND','AL':_0x33affd(0x142),'AT':_0x33affd(0x101),'BA':_0x33affd(0x10a),'BE':_0x33affd(0x17d),'BG':_0x33affd(0x10c),'BY':_0x33affd(0x175),'CH':_0x33affd(0x167),'CY':_0x33affd(0x157),'CZ':_0x33affd(0xe8),'DE':_0x33affd(0x150),'DK':_0x33affd(0x105),'EE':'EST','ES':_0x33affd(0xf1),'FI':'FIN','FR':_0x33affd(0x156),'GB':_0x33affd(0x1a1),'GE':_0x33affd(0x18c),'GR':_0x33affd(0xfd),'HR':_0x33affd(0x185),'HU':_0x33affd(0x19c),'IE':_0x33affd(0x112),'IS':_0x33affd(0x17e),'IT':_0x33affd(0xe7),'LI':'LIE','LT':_0x33affd(0x12b),'LU':_0x33affd(0xf5),'LV':_0x33affd(0x137),'MC':_0x33affd(0x120),'MD':'MDA','ME':_0x33affd(0x13b),'MK':_0x33affd(0x12f),'MT':'MLT','NL':_0x33affd(0x168),'NO':'NOR','PL':'POL','PT':_0x33affd(0xf6),'RO':'ROU','RS':_0x33affd(0x143),'RU':_0x33affd(0xd6),'SE':'SWE','SI':'SVN','SK':_0x33affd(0xe1),'SM':_0x33affd(0x186),'UA':_0x33affd(0x140),'VA':'VAT','XK':_0x33affd(0xe6),'AM':_0x33affd(0xda),'AZ':_0x33affd(0x14c),'KZ':_0x33affd(0x166),'KG':_0x33affd(0x172),'TJ':'TJK','TM':_0x33affd(0x146),'UZ':_0x33affd(0x165),'US':_0x33affd(0x154),'CA':'CAN','AU':'AUS','JP':_0x33affd(0x139),'CN':_0x33affd(0x19f),'IN':_0x33affd(0x11c),'BR':'BRA','MX':_0x33affd(0x13f),'AR':_0x33affd(0x16d),'CL':_0x33affd(0x189),'PE':'PER','CO':_0x33affd(0x17a),'VE':'VEN','EC':_0x33affd(0xe0),'BO':_0x33affd(0x179),'PY':_0x33affd(0x188),'UY':_0x33affd(0x123),'SR':'SUR','GY':'GUY','FK':_0x33affd(0x196),'ZA':'ZAF','EG':_0x33affd(0x1a4),'NG':_0x33affd(0xe9),'KE':_0x33affd(0x121),'GH':_0x33affd(0x11f),'TZ':_0x33affd(0x184),'UG':_0x33affd(0xff),'ZW':_0x33affd(0x134),'ZM':_0x33affd(0x108),'MW':_0x33affd(0x18f),'MZ':_0x33affd(0x155),'MG':'MDG','MU':_0x33affd(0x131),'SC':_0x33affd(0x116),'RE':_0x33affd(0xf3),'TR':_0x33affd(0x12c),'IR':'IRN','IQ':_0x33affd(0x18e),'SA':'SAU','AE':_0x33affd(0x14e),'KW':_0x33affd(0x16f),'QA':_0x33affd(0x14d),'BH':_0x33affd(0xf2),'OM':_0x33affd(0x18d),'YE':_0x33affd(0x195),'JO':'JOR','LB':_0x33affd(0xd9),'SY':_0x33affd(0x14b),'IL':_0x33affd(0xd2),'PS':'PSE','KR':_0x33affd(0xf0),'KP':_0x33affd(0x197),'TH':'THA','VN':_0x33affd(0x110),'MY':_0x33affd(0x119),'SG':_0x33affd(0x1a3),'ID':_0x33affd(0x122),'PH':_0x33affd(0x147),'LA':_0x33affd(0x171),'KH':'KHM','MM':_0x33affd(0x136),'BD':_0x33affd(0xf4),'LK':_0x33affd(0x125),'NP':_0x33affd(0x190),'BT':_0x33affd(0x1a2),'MV':_0x33affd(0x198),'AF':'AFG','PK':_0x33affd(0x182),'MN':_0x33affd(0xdd)},_0x4c7f26=_0x491e74[_0x2b8a82[_0x33affd(0x193)]()];if(!_0x4c7f26)return console[_0x33affd(0x15e)](_0x33affd(0x178)+_0x2b8a82+_0x33affd(0x1a0)),_0x33affd(0x12c);return _0x4c7f26;}async[a53_0x2923c2(0xd8)](_0x47b4f8){const _0x317f14=a53_0x2923c2;console[_0x317f14(0x1a5)](_0x317f14(0x18a),{'paymentId':_0x47b4f8[_0x317f14(0x15d)],'amount':_0x47b4f8[_0x317f14(0x13d)],'currency':_0x47b4f8['currency'],'customerCountry':_0x47b4f8['customerCountry']});try{const _0x3e2f44={'client_merchant_id':this[_0x317f14(0x15a)],'payment_method':_0x317f14(0x129),'client_transaction_id':_0x47b4f8['orderId'],'amount':_0x47b4f8[_0x317f14(0x13d)],'currency':_0x47b4f8[_0x317f14(0x103)],'callback_url':'https://traffer.uk/gateway/ampay-try/webhook.php','tracker_id':_0x47b4f8[_0x317f14(0x15d)],'redirect_url':_0x47b4f8['successUrl'],'failure_url':_0x47b4f8[_0x317f14(0x151)],'customer_first_name':_0x47b4f8['firstName'],'customer_last_name':_0x47b4f8[_0x317f14(0x145)],'customer_email':_0x47b4f8[_0x317f14(0x159)],'customer_phone':_0x47b4f8[_0x317f14(0x138)]||'','customer_ip':_0x47b4f8['customerIp'],'customer_country':_0x47b4f8[_0x317f14(0x141)],'api_public_key':this[_0x317f14(0x194)]};console['log']('üì§\x20AmPay\x20TRY\x20API\x20request\x20data:',JSON[_0x317f14(0x15f)](_0x3e2f44,null,0x2));const _0x245aeb=await fetch(this['apiUrl'],{'method':_0x317f14(0x109),'headers':{'Content-Type':'application/json','User-Agent':_0x317f14(0xd4)},'body':JSON['stringify'](_0x3e2f44)});console[_0x317f14(0x1a5)](_0x317f14(0xdf),_0x245aeb[_0x317f14(0x170)]);const _0x17b2cd=await _0x245aeb[_0x317f14(0x17c)]();console[_0x317f14(0x1a5)](_0x317f14(0xed),_0x17b2cd);let _0x572b0a;try{_0x572b0a=JSON['parse'](_0x17b2cd);}catch(_0x49c78b){console[_0x317f14(0x148)](_0x317f14(0x12a),_0x49c78b);throw new Error('Invalid\x20JSON\x20response\x20from\x20AmPay\x20TRY:\x20'+_0x17b2cd);}console[_0x317f14(0x1a5)](_0x317f14(0xee),JSON[_0x317f14(0x15f)](_0x572b0a,null,0x2)),loggerService_1[_0x317f14(0x10f)][_0x317f14(0x183)]('ampay-try',_0x572b0a,{});if(!_0x245aeb['ok']){const _0x3d1240=_0x572b0a[_0x317f14(0x10d)]||_0x572b0a['message']||_0x317f14(0x111)+_0x245aeb[_0x317f14(0x170)];console[_0x317f14(0x148)](_0x317f14(0x173),_0x3d1240);throw new Error(_0x317f14(0x128)+_0x3d1240);}if(!_0x572b0a['redirect_url']){console[_0x317f14(0x148)](_0x317f14(0x191),_0x572b0a);throw new Error(_0x317f14(0xd5));}const _0x3beecf={'gateway_payment_id':_0x572b0a[_0x317f14(0x130)]||_0x47b4f8['orderId'],'payment_url':_0x572b0a[_0x317f14(0x107)],'transaction_id':_0x572b0a[_0x317f14(0x11d)]};return console[_0x317f14(0x1a5)]('‚úÖ\x20AmPay\x20TRY\x20payment\x20created\x20successfully:',_0x3beecf),_0x3beecf;}catch(_0x153638){console[_0x317f14(0x148)]('‚ùå\x20AmPay\x20TRY\x20payment\x20creation\x20failed:',_0x153638),loggerService_1[_0x317f14(0x10f)][_0x317f14(0x11a)](_0x317f14(0x177),_0x153638,_0x47b4f8);throw _0x153638;}}async[a53_0x2923c2(0x162)](_0x5ee144){const _0x4a4506=a53_0x2923c2;try{const {orderId:_0x23b2ec,amount:_0x53e40e,currency:_0x58b7e1,firstName:_0x5594ee,lastName:_0x167497,email:_0x192d27,phone:_0x2088e2,customerIp:_0x2027a2,customerCountry:_0x26cded,successUrl:_0x24f452,failureUrl:_0x162531}=_0x5ee144;console[_0x4a4506(0x1a5)](_0x4a4506(0xd3)),console['log'](_0x4a4506(0x161),_0x23b2ec),console[_0x4a4506(0x1a5)]('Amount:',_0x53e40e,_0x58b7e1),console[_0x4a4506(0x1a5)](_0x4a4506(0x164),_0x5594ee+'\x20'+_0x167497),console['log'](_0x4a4506(0xfe),_0x192d27),console[_0x4a4506(0x1a5)](_0x4a4506(0x11e),_0x2088e2||'not\x20provided'),console[_0x4a4506(0x1a5)](_0x4a4506(0x14a),_0x2027a2),console[_0x4a4506(0x1a5)]('Customer\x20Country\x20(2-letter):',_0x26cded);const _0x229311=this['convert2LetterTo3LetterCountryCode'](_0x26cded);console[_0x4a4506(0x1a5)](_0x4a4506(0x117),_0x229311);const _0x544e33={'sub_method':_0x4a4506(0x132),'currency':_0x58b7e1['toUpperCase'](),'amount':_0x53e40e,'callback_url':_0x4a4506(0x181),'client_merchant_id':this[_0x4a4506(0x15a)],'client_transaction_id':_0x23b2ec,'transaction_description':_0x23b2ec,'customer':{'ip':_0x2027a2,'email':_0x192d27,'full_name':_0x5594ee+'\x20'+_0x167497,'phone':_0x2088e2||'','country':_0x229311},'success_redirect_url':_0x24f452,'error_redirect_url':_0x162531};console[_0x4a4506(0x1a5)](_0x4a4506(0x135),JSON[_0x4a4506(0x15f)](_0x544e33,null,0x2));const _0x2ce7a9=await fetch(this[_0x4a4506(0xe5)]+_0x4a4506(0xfa),{'method':'POST','headers':{'Content-Type':_0x4a4506(0xfb),'User-Agent':_0x4a4506(0x16b)},'body':JSON[_0x4a4506(0x15f)](_0x544e33)}),_0x167c84=await _0x2ce7a9[_0x4a4506(0x17c)]();console[_0x4a4506(0x1a5)](_0x4a4506(0x19b),_0x167c84);if(!_0x2ce7a9['ok'])throw new Error(_0x4a4506(0x126)+_0x2ce7a9['status']+_0x4a4506(0x176)+_0x167c84);let _0x334ac3;try{_0x334ac3=JSON[_0x4a4506(0xdb)](_0x167c84);}catch(_0x18bf6e){throw new Error('Invalid\x20JSON\x20response\x20from\x20AmPay\x20TRY:\x20'+_0x167c84);}console['log'](_0x4a4506(0x15c),JSON[_0x4a4506(0x15f)](_0x334ac3,null,0x2));if(!_0x334ac3[_0x4a4506(0x107)])throw new Error(_0x4a4506(0x124)+(_0x334ac3[_0x4a4506(0x10d)]||_0x334ac3['message']||_0x4a4506(0x158)));const _0x5a52f8=_0x334ac3[_0x4a4506(0x107)],_0x51a5c7=_0x334ac3[_0x4a4506(0x130)],_0x2cc3f4=_0x334ac3[_0x4a4506(0x16c)];return console[_0x4a4506(0x1a5)](_0x4a4506(0x153)),console[_0x4a4506(0x1a5)](_0x4a4506(0xf8),_0x5a52f8),console['log'](_0x4a4506(0xe3),_0x51a5c7),console['log']('Tracker\x20ID:',_0x2cc3f4),console[_0x4a4506(0x1a5)](_0x4a4506(0x114),_0x334ac3[_0x4a4506(0x170)]),console[_0x4a4506(0x1a5)](_0x4a4506(0xe2)),{'gateway_payment_id':_0x51a5c7||_0x2cc3f4||_0x23b2ec,'payment_url':_0x5a52f8||'','transaction_id':_0x51a5c7};}catch(_0x8a7a5e){console[_0x4a4506(0x148)](_0x4a4506(0xdc),_0x8a7a5e),console['log'](_0x4a4506(0xef)),loggerService_1[_0x4a4506(0x10f)][_0x4a4506(0x11a)](_0x4a4506(0x177),_0x8a7a5e,_0x5ee144);throw _0x8a7a5e;}}async['checkPaymentStatus'](_0x238746){const _0x260c09=a53_0x2923c2;console[_0x260c09(0x1a5)](_0x260c09(0x11b),_0x238746);try{const _0x285e63={'client_merchant_id':this['CLIENT_MERCHANT_ID'],'system_id':_0x238746,'api_public_key':this[_0x260c09(0x194)]},_0x5bc13e=await fetch(this[_0x260c09(0xe5)]+_0x260c09(0xeb),{'method':'POST','headers':{'Content-Type':_0x260c09(0xfb),'User-Agent':_0x260c09(0xd4)},'body':JSON[_0x260c09(0x15f)](_0x285e63)}),_0x34dd80=await _0x5bc13e[_0x260c09(0x17c)]();console[_0x260c09(0x1a5)](_0x260c09(0x13a),_0x34dd80);let _0x5494c1;try{_0x5494c1=JSON[_0x260c09(0xdb)](_0x34dd80);}catch(_0x43795b){return console[_0x260c09(0x148)](_0x260c09(0x19e),_0x43795b),{'status':_0x260c09(0x115)};}console['log'](_0x260c09(0x100),JSON[_0x260c09(0x15f)](_0x5494c1,null,0x2));let _0x2a01bd=_0x260c09(0x16e);if(_0x5494c1[_0x260c09(0x170)])switch(_0x5494c1[_0x260c09(0x170)]['toLowerCase']()){case'success':case'completed':case'paid':_0x2a01bd=_0x260c09(0xe4);break;case _0x260c09(0x113):case'error':case _0x260c09(0x10b):_0x2a01bd=_0x260c09(0x115);break;case'expired':case _0x260c09(0x160):_0x2a01bd='EXPIRED';break;case _0x260c09(0x169):case'processing':case _0x260c09(0x19a):default:_0x2a01bd='PENDING';break;}return{'status':_0x2a01bd,'amount':_0x5494c1[_0x260c09(0x13d)],'currency':_0x5494c1[_0x260c09(0x103)]};}catch(_0x2d1df7){return console[_0x260c09(0x148)](_0x260c09(0x102),_0x2d1df7),{'status':_0x260c09(0x115)};}}async[a53_0x2923c2(0x187)](_0x249568){const _0x4d0189=a53_0x2923c2;console[_0x4d0189(0x1a5)](_0x4d0189(0xd7),JSON[_0x4d0189(0x15f)](_0x249568,null,0x2));try{const _0x576cd7=_0x249568[_0x4d0189(0x16c)]||_0x249568[_0x4d0189(0x11d)]||_0x249568[_0x4d0189(0x130)];if(!_0x576cd7){console[_0x4d0189(0x148)](_0x4d0189(0x127));throw new Error(_0x4d0189(0x15b));}let _0x2f48e0='PENDING';if(_0x249568[_0x4d0189(0x170)])switch(_0x249568[_0x4d0189(0x170)][_0x4d0189(0xfc)]()){case _0x4d0189(0x10e):case'completed':case _0x4d0189(0xf7):_0x2f48e0='PAID';break;case _0x4d0189(0x113):case _0x4d0189(0x148):case _0x4d0189(0x10b):_0x2f48e0=_0x4d0189(0x115);break;case _0x4d0189(0xea):case _0x4d0189(0x160):_0x2f48e0='EXPIRED';break;case _0x4d0189(0x169):case _0x4d0189(0x133):case _0x4d0189(0x19a):default:_0x2f48e0=_0x4d0189(0x16e);break;}return console['log'](_0x4d0189(0x149)+_0x576cd7+_0x4d0189(0x106)+_0x2f48e0),{'paymentId':_0x576cd7,'status':_0x2f48e0,'amount':_0x249568[_0x4d0189(0x13d)],'currency':_0x249568[_0x4d0189(0x103)]||_0x4d0189(0x180)};}catch(_0x564d05){console[_0x4d0189(0x148)](_0x4d0189(0x199),_0x564d05);throw _0x564d05;}}[a53_0x2923c2(0x163)](_0x2decf9,_0x3377d5){const _0x5df4a2=a53_0x2923c2;return console[_0x5df4a2(0x1a5)](_0x5df4a2(0x13c)),!![];}}exports[a53_0x2923c2(0x174)]=AmPayTRYService;