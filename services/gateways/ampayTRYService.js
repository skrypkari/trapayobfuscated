'use strict';const a59_0x240460=a59_0x187a;(function(_0x5d2394,_0x23d9e6){const _0x43758f=a59_0x187a,_0x599fbb=_0x5d2394();while(!![]){try{const _0xedd4e5=parseInt(_0x43758f(0x1d8))/0x1*(-parseInt(_0x43758f(0x1f7))/0x2)+parseInt(_0x43758f(0x251))/0x3+parseInt(_0x43758f(0x22f))/0x4*(-parseInt(_0x43758f(0x248))/0x5)+-parseInt(_0x43758f(0x253))/0x6+-parseInt(_0x43758f(0x1e3))/0x7+-parseInt(_0x43758f(0x1ac))/0x8*(-parseInt(_0x43758f(0x195))/0x9)+parseInt(_0x43758f(0x1c6))/0xa;if(_0xedd4e5===_0x23d9e6)break;else _0x599fbb['push'](_0x599fbb['shift']());}catch(_0x441f35){_0x599fbb['push'](_0x599fbb['shift']());}}}(a59_0x47ce,0xee56f));Object['defineProperty'](exports,a59_0x240460(0x19d),{'value':!![]}),exports[a59_0x240460(0x1fc)]=void 0x0;const loggerService_1=require('../loggerService');function a59_0x187a(_0x33775f,_0x4605c3){_0x33775f=_0x33775f-0x193;const _0x47cec3=a59_0x47ce();let _0x187ab0=_0x47cec3[_0x33775f];return _0x187ab0;}class AmPayTRYService{constructor(){const _0x19827b=a59_0x240460;this[_0x19827b(0x1b5)]='TRAFFER',this['API_PUBLIC_KEY']='58b59ccbc03dcdcfc20d830edfba765dbf9f3531c692533d84b17938e9c40bda',this['API_PRIVATE_KEY']='a5a059aa63392e571341bddc5148a5db66643722e9a6bf16a9395fb690a80288931d5a1180a85a28eb9f6516cf61dfc1bf4e37898f3a35261cd2db88888d3815',this['apiUrl']='https://traffer.uk/gateway/ampay-try/',console['log'](_0x19827b(0x19e));}[a59_0x240460(0x1eb)](_0x154df4){const _0x86942c=a59_0x240460,_0x21c08c={'AD':_0x86942c(0x1f3),'AL':_0x86942c(0x227),'AT':_0x86942c(0x197),'BA':_0x86942c(0x1ad),'BE':_0x86942c(0x1f0),'BG':_0x86942c(0x1f2),'BY':_0x86942c(0x23a),'CH':_0x86942c(0x1f5),'CY':_0x86942c(0x1dd),'CZ':_0x86942c(0x21b),'DE':'DEU','DK':'DNK','EE':_0x86942c(0x23f),'ES':_0x86942c(0x1df),'FI':_0x86942c(0x254),'FR':_0x86942c(0x1a6),'GB':'GBR','GE':_0x86942c(0x1b0),'GR':_0x86942c(0x1a0),'HR':_0x86942c(0x1a1),'HU':_0x86942c(0x1fd),'IE':_0x86942c(0x226),'IS':'ISL','IT':'ITA','LI':_0x86942c(0x1c5),'LT':_0x86942c(0x193),'LU':_0x86942c(0x220),'LV':_0x86942c(0x1ff),'MC':_0x86942c(0x20f),'MD':_0x86942c(0x238),'ME':_0x86942c(0x20a),'MK':'MKD','MT':_0x86942c(0x1ed),'NL':'NLD','NO':_0x86942c(0x22c),'PL':_0x86942c(0x243),'PT':_0x86942c(0x210),'RO':_0x86942c(0x1e8),'RS':_0x86942c(0x1ee),'RU':'RUS','SE':_0x86942c(0x1e0),'SI':_0x86942c(0x22b),'SK':_0x86942c(0x25a),'SM':_0x86942c(0x262),'UA':_0x86942c(0x1d4),'VA':_0x86942c(0x200),'XK':_0x86942c(0x21d),'AM':_0x86942c(0x1aa),'AZ':'AZE','KZ':_0x86942c(0x252),'KG':_0x86942c(0x1da),'TJ':_0x86942c(0x1d1),'TM':'TKM','UZ':_0x86942c(0x219),'US':_0x86942c(0x242),'CA':_0x86942c(0x1f6),'AU':_0x86942c(0x1f8),'JP':_0x86942c(0x25e),'CN':_0x86942c(0x217),'IN':_0x86942c(0x1b7),'BR':_0x86942c(0x218),'MX':_0x86942c(0x204),'AR':_0x86942c(0x1d0),'CL':'CHL','PE':_0x86942c(0x1dc),'CO':_0x86942c(0x213),'VE':'VEN','EC':'ECU','BO':_0x86942c(0x1fb),'PY':_0x86942c(0x22e),'UY':_0x86942c(0x1a9),'SR':'SUR','GY':'GUY','FK':_0x86942c(0x1a8),'ZA':_0x86942c(0x208),'EG':_0x86942c(0x1c2),'NG':'NGA','KE':_0x86942c(0x19b),'GH':_0x86942c(0x1b8),'TZ':_0x86942c(0x1ba),'UG':_0x86942c(0x228),'ZW':_0x86942c(0x21e),'ZM':_0x86942c(0x245),'MW':'MWI','MZ':'MOZ','MG':_0x86942c(0x233),'MU':_0x86942c(0x25f),'SC':_0x86942c(0x209),'RE':_0x86942c(0x1ae),'TR':'TUR','IR':_0x86942c(0x21a),'IQ':_0x86942c(0x1c3),'SA':_0x86942c(0x1c8),'AE':_0x86942c(0x1cc),'KW':'KWT','QA':_0x86942c(0x258),'BH':_0x86942c(0x24e),'OM':_0x86942c(0x20c),'YE':_0x86942c(0x1cd),'JO':_0x86942c(0x1ef),'LB':_0x86942c(0x250),'SY':'SYR','IL':_0x86942c(0x194),'PS':_0x86942c(0x205),'KR':_0x86942c(0x22d),'KP':'PRK','TH':'THA','VN':_0x86942c(0x1a4),'MY':_0x86942c(0x247),'SG':_0x86942c(0x20d),'ID':'IDN','PH':_0x86942c(0x231),'LA':_0x86942c(0x1c7),'KH':_0x86942c(0x23d),'MM':_0x86942c(0x212),'BD':_0x86942c(0x1a3),'LK':_0x86942c(0x1db),'NP':_0x86942c(0x1d7),'BT':_0x86942c(0x19f),'MV':_0x86942c(0x19a),'AF':_0x86942c(0x1f4),'PK':_0x86942c(0x222),'MN':_0x86942c(0x246)},_0x50d1d9=_0x21c08c[_0x154df4[_0x86942c(0x1e7)]()];if(!_0x50d1d9)return console[_0x86942c(0x1d5)](_0x86942c(0x257)+_0x154df4+_0x86942c(0x1b3)),'TUR';return _0x50d1d9;}async[a59_0x240460(0x265)](_0x272438){const _0x5659e6=a59_0x240460;console[_0x5659e6(0x1ca)](_0x5659e6(0x23c),{'paymentId':_0x272438[_0x5659e6(0x1b2)],'amount':_0x272438[_0x5659e6(0x235)],'currency':_0x272438[_0x5659e6(0x23b)],'customerCountry':_0x272438[_0x5659e6(0x256)]});try{const _0x96b9e6={'client_merchant_id':this[_0x5659e6(0x1b5)],'payment_method':'Bank\x20Transfer\x20TR','client_transaction_id':_0x272438[_0x5659e6(0x225)],'amount':_0x272438[_0x5659e6(0x235)],'currency':_0x272438[_0x5659e6(0x23b)],'callback_url':_0x5659e6(0x236),'tracker_id':_0x272438['paymentId'],'redirect_url':_0x272438[_0x5659e6(0x260)],'failure_url':_0x272438[_0x5659e6(0x1c0)],'customer_first_name':_0x272438['firstName'],'customer_last_name':_0x272438[_0x5659e6(0x20e)],'customer_email':_0x272438[_0x5659e6(0x241)],'customer_phone':_0x272438[_0x5659e6(0x202)]||'','customer_ip':_0x272438[_0x5659e6(0x1bf)],'customer_country':_0x272438[_0x5659e6(0x256)],'api_public_key':this[_0x5659e6(0x25c)]};console[_0x5659e6(0x1ca)](_0x5659e6(0x1a5),JSON[_0x5659e6(0x1e6)](_0x96b9e6,null,0x2));const _0x3933a7=await fetch(this[_0x5659e6(0x1fa)],{'method':_0x5659e6(0x261),'headers':{'Content-Type':_0x5659e6(0x239),'User-Agent':_0x5659e6(0x24a)},'body':JSON['stringify'](_0x96b9e6)});console[_0x5659e6(0x1ca)](_0x5659e6(0x1bb),_0x3933a7[_0x5659e6(0x19c)]);const _0x356403=await _0x3933a7[_0x5659e6(0x1be)]();console[_0x5659e6(0x1ca)](_0x5659e6(0x1cb),_0x356403);let _0x1a9236;try{_0x1a9236=JSON['parse'](_0x356403);}catch(_0x329156){console[_0x5659e6(0x25d)]('‚ùå\x20Failed\x20to\x20parse\x20AmPay\x20TRY\x20API\x20response:',_0x329156);throw new Error(_0x5659e6(0x1d2)+_0x356403);}console[_0x5659e6(0x1ca)](_0x5659e6(0x21c),JSON[_0x5659e6(0x1e6)](_0x1a9236,null,0x2)),loggerService_1[_0x5659e6(0x1b1)][_0x5659e6(0x1b9)](_0x5659e6(0x266),_0x1a9236,{});if(!_0x3933a7['ok']){const _0x2fcb2f=_0x1a9236[_0x5659e6(0x1d9)]||_0x1a9236[_0x5659e6(0x201)]||_0x5659e6(0x230)+_0x3933a7[_0x5659e6(0x19c)];console[_0x5659e6(0x25d)](_0x5659e6(0x1cf),_0x2fcb2f);throw new Error(_0x5659e6(0x1c1)+_0x2fcb2f);}if(!_0x1a9236['redirect_url']){console[_0x5659e6(0x25d)](_0x5659e6(0x237),_0x1a9236);throw new Error(_0x5659e6(0x234));}const _0x5dfd2f={'gateway_payment_id':_0x1a9236['system_id']||_0x272438[_0x5659e6(0x225)],'payment_url':_0x1a9236[_0x5659e6(0x259)],'transaction_id':_0x1a9236['client_transaction_id']};return console[_0x5659e6(0x1ca)](_0x5659e6(0x221),_0x5dfd2f),_0x5dfd2f;}catch(_0x437e5d){console[_0x5659e6(0x25d)](_0x5659e6(0x1ea),_0x437e5d),loggerService_1['loggerService'][_0x5659e6(0x232)]('ampay-try',_0x437e5d,_0x272438);throw _0x437e5d;}}async['createPaymentLink'](_0xa84de6){const _0x30b62d=a59_0x240460;try{const {orderId:_0x425a7,amount:_0x12632f,currency:_0x22af8f,firstName:_0x5a07dd,lastName:_0x6dd4a1,email:_0x48cfda,phone:_0x1942c9,customerIp:_0x1bf72b,customerCountry:_0x570a18,successUrl:_0x3f0ade,failureUrl:_0x526072}=_0xa84de6;console[_0x30b62d(0x1ca)]('üáπüá∑\x20Creating\x20AmPay\x20TRY\x20payment\x20link...'),console[_0x30b62d(0x1ca)](_0x30b62d(0x1de),_0x425a7),console[_0x30b62d(0x1ca)]('Amount:',_0x12632f,_0x22af8f),console['log'](_0x30b62d(0x1e1),_0x5a07dd+'\x20'+_0x6dd4a1),console[_0x30b62d(0x1ca)](_0x30b62d(0x211),_0x48cfda),console[_0x30b62d(0x1ca)](_0x30b62d(0x229),_0x1942c9||_0x30b62d(0x1d6)),console[_0x30b62d(0x1ca)]('Customer\x20IP:',_0x1bf72b),console[_0x30b62d(0x1ca)](_0x30b62d(0x25b),_0x570a18);const _0x1f38d1=this[_0x30b62d(0x1eb)](_0x570a18);console['log'](_0x30b62d(0x223),_0x1f38d1);const _0x1fa446={'sub_method':'GAM','currency':_0x22af8f['toUpperCase'](),'amount':_0x12632f,'callback_url':'https://traffer.uk/gateway/ampay-try/webhook.php','client_merchant_id':this[_0x30b62d(0x1b5)],'client_transaction_id':_0x425a7,'transaction_description':_0x425a7,'customer':{'ip':_0x1bf72b,'email':_0x48cfda,'full_name':_0x5a07dd+'\x20'+_0x6dd4a1,'phone':_0x1942c9||'','country':_0x1f38d1},'success_redirect_url':_0x3f0ade,'error_redirect_url':_0x526072};console[_0x30b62d(0x1ca)](_0x30b62d(0x264),JSON[_0x30b62d(0x1e6)](_0x1fa446,null,0x2));const _0x1bfc42=await fetch(this['apiUrl']+'ampay.php',{'method':'POST','headers':{'Content-Type':_0x30b62d(0x239),'User-Agent':_0x30b62d(0x1bc)},'body':JSON['stringify'](_0x1fa446)}),_0x48c4ae=await _0x1bfc42['text']();console['log'](_0x30b62d(0x22a),_0x48c4ae);if(!_0x1bfc42['ok'])throw new Error(_0x30b62d(0x21f)+_0x1bfc42[_0x30b62d(0x19c)]+'\x20-\x20'+_0x48c4ae);let _0xd34cb2;try{_0xd34cb2=JSON[_0x30b62d(0x1b4)](_0x48c4ae);}catch(_0x40a17f){throw new Error('Invalid\x20JSON\x20response\x20from\x20AmPay\x20TRY:\x20'+_0x48c4ae);}console['log'](_0x30b62d(0x1ec),JSON['stringify'](_0xd34cb2,null,0x2));if(!_0xd34cb2[_0x30b62d(0x259)])throw new Error(_0x30b62d(0x1e5)+(_0xd34cb2['error_message']||_0xd34cb2['message']||_0x30b62d(0x207)));const _0x9444be=_0xd34cb2['redirect_url'],_0x19b0bd=_0xd34cb2[_0x30b62d(0x1e4)],_0x550bf4=_0xd34cb2[_0x30b62d(0x224)];return console['log'](_0x30b62d(0x1ce)),console['log'](_0x30b62d(0x206),_0x9444be),console[_0x30b62d(0x1ca)](_0x30b62d(0x1f1),_0x19b0bd),console[_0x30b62d(0x1ca)]('Tracker\x20ID:',_0x550bf4),console['log']('Status:',_0xd34cb2[_0x30b62d(0x19c)]),console[_0x30b62d(0x1ca)](_0x30b62d(0x1c4)),{'gateway_payment_id':_0x19b0bd||_0x550bf4||_0x425a7,'payment_url':_0x9444be||'','transaction_id':_0x19b0bd};}catch(_0x3672de){console[_0x30b62d(0x25d)](_0x30b62d(0x1ea),_0x3672de),console[_0x30b62d(0x1ca)](_0x30b62d(0x216)),loggerService_1[_0x30b62d(0x1b1)][_0x30b62d(0x232)](_0x30b62d(0x266),_0x3672de,_0xa84de6);throw _0x3672de;}}async[a59_0x240460(0x215)](_0x30fe34){const _0x272d38=a59_0x240460;console['log'](_0x272d38(0x263),_0x30fe34);try{const _0x142198={'client_merchant_id':this[_0x272d38(0x1b5)],'system_id':_0x30fe34,'api_public_key':this[_0x272d38(0x25c)]},_0x5f4151=await fetch(this[_0x272d38(0x1fa)]+_0x272d38(0x1bd),{'method':_0x272d38(0x261),'headers':{'Content-Type':_0x272d38(0x239),'User-Agent':_0x272d38(0x24a)},'body':JSON['stringify'](_0x142198)}),_0x49e5c8=await _0x5f4151['text']();console['log'](_0x272d38(0x199),_0x49e5c8);let _0x37c5f4;try{_0x37c5f4=JSON['parse'](_0x49e5c8);}catch(_0x26e153){return console[_0x272d38(0x25d)](_0x272d38(0x23e),_0x26e153),{'status':_0x272d38(0x1f9)};}console[_0x272d38(0x1ca)](_0x272d38(0x1d3),JSON[_0x272d38(0x1e6)](_0x37c5f4,null,0x2));let _0x490124=_0x272d38(0x1a7);if(_0x37c5f4[_0x272d38(0x19c)])switch(_0x37c5f4[_0x272d38(0x19c)][_0x272d38(0x244)]()){case _0x272d38(0x1af):case _0x272d38(0x203):case _0x272d38(0x214):_0x490124=_0x272d38(0x1c9);break;case _0x272d38(0x1e9):case'error':case _0x272d38(0x240):_0x490124=_0x272d38(0x1f9);break;case _0x272d38(0x255):case _0x272d38(0x1e2):_0x490124=_0x272d38(0x196);break;case _0x272d38(0x249):case _0x272d38(0x24b):case _0x272d38(0x24c):default:_0x490124=_0x272d38(0x1a7);break;}return{'status':_0x490124,'amount':_0x37c5f4[_0x272d38(0x235)],'currency':_0x37c5f4[_0x272d38(0x23b)]};}catch(_0x4b90d0){return console[_0x272d38(0x25d)](_0x272d38(0x24f),_0x4b90d0),{'status':_0x272d38(0x1f9)};}}async[a59_0x240460(0x1b6)](_0x19f5fb){const _0x4b1987=a59_0x240460;console[_0x4b1987(0x1ca)](_0x4b1987(0x20b),JSON[_0x4b1987(0x1e6)](_0x19f5fb,null,0x2));try{const _0x443b6c=_0x19f5fb[_0x4b1987(0x224)]||_0x19f5fb[_0x4b1987(0x1ab)]||_0x19f5fb[_0x4b1987(0x1e4)];if(!_0x443b6c){console[_0x4b1987(0x25d)]('‚ùå\x20No\x20payment\x20ID\x20found\x20in\x20AmPay\x20TRY\x20webhook\x20data');throw new Error(_0x4b1987(0x1fe));}let _0x25d7a0=_0x4b1987(0x1a7);if(_0x19f5fb[_0x4b1987(0x19c)])switch(_0x19f5fb[_0x4b1987(0x19c)][_0x4b1987(0x244)]()){case _0x4b1987(0x1af):case _0x4b1987(0x203):case _0x4b1987(0x214):_0x25d7a0=_0x4b1987(0x1c9);break;case'failed':case _0x4b1987(0x25d):case _0x4b1987(0x240):_0x25d7a0=_0x4b1987(0x1f9);break;case'expired':case _0x4b1987(0x1e2):_0x25d7a0=_0x4b1987(0x196);break;case'pending':case _0x4b1987(0x24b):case _0x4b1987(0x24c):default:_0x25d7a0=_0x4b1987(0x1a7);break;}return console[_0x4b1987(0x1ca)]('üìä\x20AmPay\x20TRY\x20webhook\x20processed:\x20'+_0x443b6c+'\x20->\x20'+_0x25d7a0),{'paymentId':_0x443b6c,'status':_0x25d7a0,'amount':_0x19f5fb[_0x4b1987(0x235)],'currency':_0x19f5fb[_0x4b1987(0x23b)]||_0x4b1987(0x198)};}catch(_0x319f77){console[_0x4b1987(0x25d)]('‚ùå\x20AmPay\x20TRY\x20webhook\x20processing\x20failed:',_0x319f77);throw _0x319f77;}}[a59_0x240460(0x24d)](_0x48e157,_0x4d542b){const _0x7d4b15=a59_0x240460;return console[_0x7d4b15(0x1ca)](_0x7d4b15(0x1a2)),!![];}}exports['AmPayTRYService']=AmPayTRYService;function a59_0x47ce(){const _0x2a66a6=['NOR','KOR','PRY','4MozSgc','HTTP\x20','PHL','logWebhookError','MDG','AmPay\x20TRY\x20did\x20not\x20return\x20a\x20payment\x20URL','amount','https://traffer.uk/gateway/ampay-try/webhook.php','‚ùå\x20No\x20redirect_url\x20in\x20AmPay\x20TRY\x20response:','MDA','application/json','BLR','currency','üöÄ\x20Creating\x20AmPay\x20TRY\x20payment\x20request:','KHM','‚ùå\x20Failed\x20to\x20parse\x20AmPay\x20TRY\x20status\x20response:','EST','declined','email','USA','POL','toLowerCase','ZMB','MNG','MYS','9676290hePWjB','pending','TrapayEnd/1.0','processing','waiting','verifyWebhookSignature','BHR','‚ùå\x20AmPay\x20TRY\x20status\x20check\x20failed:','LBN','5282877TDYDnR','KAZ','9254712HKqOvR','FIN','expired','customerCountry','‚ö†Ô∏è\x20Unknown\x20country\x20code:\x20','QAT','redirect_url','SVK','Customer\x20Country\x20(2-letter):','API_PUBLIC_KEY','error','JPN','MUS','successUrl','POST','SMR','üîç\x20Checking\x20AmPay\x20TRY\x20payment\x20status\x20for:','üì§\x20AmPay\x20TRY\x20request\x20body:','createPayment','ampay-try','LTU','ISR','9nKvKKK','EXPIRED','AUT','TRY','üìù\x20AmPay\x20TRY\x20status\x20raw\x20response:','MDV','KEN','status','__esModule','üáπüá∑\x20AmPay\x20TRY\x20service\x20initialized\x20with\x20IBAN\x20Bank\x20Transfer\x20TR\x20processing','BTN','GRC','HRV','üîê\x20AmPay\x20TRY\x20webhook\x20signature\x20verification\x20not\x20implemented\x20yet','BGD','VNM','üì§\x20AmPay\x20TRY\x20API\x20request\x20data:','FRA','PENDING','FLK','URY','ARM','client_transaction_id','8705824MkvwYq','BIH','REU','success','GEO','loggerService','paymentId',',\x20using\x20TUR\x20as\x20fallback\x20for\x20AmPay\x20TRY','parse','CLIENT_MERCHANT_ID','processWebhook','IND','GHA','logWebhookReceived','TZA','üì°\x20AmPay\x20TRY\x20API\x20response\x20status:','TrapayAPI/1.0','/status','text','customerIp','failureUrl','AmPay\x20TRY\x20API\x20error:\x20','EGY','IRQ','üìù\x20Logging\x20AmPay\x20TRY\x20payment\x20creation\x20event...','LIE','43904900vaefdh','LAO','SAU','PAID','log','üìù\x20AmPay\x20TRY\x20API\x20raw\x20response:','ARE','YEM','‚úÖ\x20AmPay\x20TRY\x20payment\x20link\x20created\x20successfully','‚ùå\x20AmPay\x20TRY\x20API\x20error:','ARG','TJK','Invalid\x20JSON\x20response\x20from\x20AmPay\x20TRY:\x20','üìä\x20AmPay\x20TRY\x20status\x20response:','UKR','warn','not\x20provided','NPL','30UlnRqk','error_message','KGZ','LKA','PER','CYP','Order\x20ID:','ESP','SWE','Customer:','timeout','10923486HHJgcJ','system_id','AmPay\x20TRY\x20payment\x20creation\x20failed:\x20','stringify','toUpperCase','ROU','failed','‚ùå\x20AmPay\x20TRY\x20payment\x20creation\x20failed:','convert2LetterTo3LetterCountryCode','üìä\x20AmPay\x20TRY\x20response\x20data:','MLT','SRB','JOR','BEL','System\x20ID:','BGR','AND','AFG','CHE','CAN','81682XkWApX','AUS','FAILED','apiUrl','BOL','AmPayTRYService','HUN','No\x20payment\x20ID\x20in\x20webhook\x20data','LVA','VAT','message','phone','completed','MEX','PSE','Payment\x20URL:','Unknown\x20error','ZAF','SYC','MNE','üì•\x20Processing\x20AmPay\x20TRY\x20webhook:','OMN','SGP','lastName','MCO','PRT','Email:','MMR','COL','paid','checkPaymentStatus','üìù\x20Logging\x20AmPay\x20TRY\x20payment\x20creation\x20failure...','CHN','BRA','UZB','IRN','CZE','üìä\x20AmPay\x20TRY\x20parsed\x20response:','XKX','ZWE','AmPay\x20TRY\x20API\x20error:\x20HTTP\x20','LUX','‚úÖ\x20AmPay\x20TRY\x20payment\x20created\x20successfully:','PAK','Customer\x20Country\x20(3-letter):','tracker_id','orderId','IRL','ALB','UGA','Phone:','üì•\x20AmPay\x20TRY\x20raw\x20response:','SVN'];a59_0x47ce=function(){return _0x2a66a6;};return a59_0x47ce();}