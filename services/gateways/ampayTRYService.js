'use strict';const a63_0x493c32=a63_0x52d8;(function(_0x1a7cb1,_0xa8f950){const _0x509ae1=a63_0x52d8,_0x4e72ee=_0x1a7cb1();while(!![]){try{const _0x4b3b1e=parseInt(_0x509ae1(0x204))/0x1+-parseInt(_0x509ae1(0x1bd))/0x2+parseInt(_0x509ae1(0x1a6))/0x3+-parseInt(_0x509ae1(0x1c5))/0x4*(parseInt(_0x509ae1(0x1df))/0x5)+parseInt(_0x509ae1(0x211))/0x6+parseInt(_0x509ae1(0x20a))/0x7*(parseInt(_0x509ae1(0x19d))/0x8)+-parseInt(_0x509ae1(0x1b8))/0x9;if(_0x4b3b1e===_0xa8f950)break;else _0x4e72ee['push'](_0x4e72ee['shift']());}catch(_0x33cfe9){_0x4e72ee['push'](_0x4e72ee['shift']());}}}(a63_0x5df5,0x6a9c0));function a63_0x5df5(){const _0x3015eb=['AZE','271304OiLhDs','EGY','AUT','BTN','not\x20provided','üìù\x20Logging\x20AmPay\x20TRY\x20payment\x20creation\x20event...','GBR','58b59ccbc03dcdcfc20d830edfba765dbf9f3531c692533d84b17938e9c40bda','4Futrfp','toLowerCase','ampay.php','logWebhookError','error','application/json','KEN','BLR','PRT','PAID','Order\x20ID:','üìù\x20AmPay\x20TRY\x20API\x20raw\x20response:','Customer\x20Country\x20(3-letter):','Unknown\x20error','Bank\x20Transfer\x20TR','TRY','ROU','KAZ','https://traffer.uk/gateway/ampay-try/','failureUrl','LUX','IRL','/status','phone','IRQ','FIN','2310240klrYEU','failed','ALB','üáπüá∑\x20Creating\x20AmPay\x20TRY\x20payment\x20link...','MUS','NGA','NLD','redirect_url','JPN','toUpperCase','message','AmPay\x20TRY\x20payment\x20creation\x20failed:\x20','System\x20ID:','lastName','success','paymentId','verifyWebhookSignature','SVN','COL','waiting','system_id','‚úÖ\x20AmPay\x20TRY\x20payment\x20created\x20successfully:','ARE','AmPay\x20TRY\x20did\x20not\x20return\x20a\x20payment\x20URL','‚ùå\x20Failed\x20to\x20parse\x20AmPay\x20TRY\x20status\x20response:','SVK','AUS','pending','GAM','NPL','TUR','MCO','UGA','TrapayEnd/1.0','USA','üì§\x20AmPay\x20TRY\x20API\x20request\x20data:','MOZ','421000mCLsVC','Customer:','OMN','EXPIRED','warn','GHA','7CplCQr','API_PUBLIC_KEY','PRY','SRB','ISR','LAO','üáπüá∑\x20AmPay\x20TRY\x20service\x20initialized\x20with\x20IBAN\x20Bank\x20Transfer\x20TR\x20processing','2963046COhxKz','TrapayAPI/1.0','timeout','üîê\x20AmPay\x20TRY\x20webhook\x20signature\x20verification\x20not\x20implemented\x20yet','API_PRIVATE_KEY','SYC','POST','YEM','processWebhook','RUS','Customer\x20IP:','üì•\x20AmPay\x20TRY\x20raw\x20response:','PER','LTU','checkPaymentStatus','ECU','email','orderId','MNE','KHM','log','AmPay\x20TRY\x20API\x20error:\x20HTTP\x20','createPayment','XKX','text','\x20->\x20','CHL','üìä\x20AmPay\x20TRY\x20parsed\x20response:','firstName','ZWE','MEX','Status:','amount','customerCountry','MLT','BRA','LVA','MDV','convert2LetterTo3LetterCountryCode','‚ùå\x20AmPay\x20TRY\x20status\x20check\x20failed:','ISL','No\x20payment\x20ID\x20in\x20webhook\x20data','loggerService','HRV','POL','NOR','HUN','DEU','expired','üìä\x20AmPay\x20TRY\x20response\x20data:','completed','Email:','THA','MKD','CAN','PENDING','status','BHR','‚ùå\x20AmPay\x20TRY\x20webhook\x20processing\x20failed:','JOR','üîç\x20Checking\x20AmPay\x20TRY\x20payment\x20status\x20for:','CHN','KGZ','ZMB','üì•\x20Processing\x20AmPay\x20TRY\x20webhook:','\x20-\x20','DNK','currency','LKA','../loggerService','MDA','MDG','CHE','BOL','MWI','MYS','GRC','tracker_id','error_message','parse','‚ùå\x20No\x20redirect_url\x20in\x20AmPay\x20TRY\x20response:','üì°\x20AmPay\x20TRY\x20API\x20response\x20status:','TJK','Phone:','VEN','ARG','Customer\x20Country\x20(2-letter):','ampay-try','customerIp','LBN','KWT','GUY','apiUrl','CLIENT_MERCHANT_ID','PSE','stringify','5989080YUOzlZ','Invalid\x20JSON\x20response\x20from\x20AmPay\x20TRY:\x20','‚ùå\x20Failed\x20to\x20parse\x20AmPay\x20TRY\x20API\x20response:','‚ùå\x20AmPay\x20TRY\x20payment\x20creation\x20failed:','SAU','SYR','URY','paid','PAK','1943040rMcctu','logWebhookReceived','UKR','‚ùå\x20No\x20payment\x20ID\x20found\x20in\x20AmPay\x20TRY\x20webhook\x20data','REU','Payment\x20URL:','CYP','HTTP\x20','client_transaction_id','BEL','LIE','MNG','AmPayTRYService','SGP','IDN','processing','FAILED','Tracker\x20ID:','11491056kCSzyK','üìù\x20AmPay\x20TRY\x20status\x20raw\x20response:','ITA','__esModule'];a63_0x5df5=function(){return _0x3015eb;};return a63_0x5df5();}function a63_0x52d8(_0x2375cc,_0x592ca9){_0x2375cc=_0x2375cc-0x183;const _0x5df514=a63_0x5df5();let _0x52d8cc=_0x5df514[_0x2375cc];return _0x52d8cc;}Object['defineProperty'](exports,a63_0x493c32(0x1bb),{'value':!![]}),exports[a63_0x493c32(0x1b2)]=void 0x0;const loggerService_1=require(a63_0x493c32(0x256));class AmPayTRYService{constructor(){const _0x2d6df6=a63_0x493c32;this[_0x2d6df6(0x19a)]='TRAFFER',this['API_PUBLIC_KEY']=_0x2d6df6(0x1c4),this[_0x2d6df6(0x215)]='a5a059aa63392e571341bddc5148a5db66643722e9a6bf16a9395fb690a80288931d5a1180a85a28eb9f6516cf61dfc1bf4e37898f3a35261cd2db88888d3815',this[_0x2d6df6(0x199)]=_0x2d6df6(0x1d7),console[_0x2d6df6(0x225)](_0x2d6df6(0x210));}[a63_0x493c32(0x237)](_0x493c27){const _0x256432=a63_0x493c32,_0x2ddce1={'AD':'AND','AL':_0x256432(0x1e1),'AT':_0x256432(0x1bf),'BA':'BIH','BE':_0x256432(0x1af),'BG':'BGR','BY':_0x256432(0x1cc),'CH':_0x256432(0x185),'CY':_0x256432(0x1ac),'CZ':'CZE','DE':_0x256432(0x240),'DK':_0x256432(0x253),'EE':'EST','ES':'ESP','FI':_0x256432(0x1de),'FR':'FRA','GB':_0x256432(0x1c3),'GE':'GEO','GR':_0x256432(0x189),'HR':_0x256432(0x23c),'HU':_0x256432(0x23f),'IE':_0x256432(0x1da),'IS':_0x256432(0x239),'IT':_0x256432(0x1ba),'LI':_0x256432(0x1b0),'LT':_0x256432(0x21e),'LU':_0x256432(0x1d9),'LV':_0x256432(0x235),'MC':_0x256432(0x1fe),'MD':_0x256432(0x183),'ME':_0x256432(0x223),'MK':_0x256432(0x246),'MT':_0x256432(0x233),'NL':_0x256432(0x1e5),'NO':_0x256432(0x23e),'PL':_0x256432(0x23d),'PT':_0x256432(0x1cd),'RO':_0x256432(0x1d5),'RS':_0x256432(0x20d),'RU':_0x256432(0x21a),'SE':'SWE','SI':_0x256432(0x1f0),'SK':_0x256432(0x1f8),'SM':'SMR','UA':_0x256432(0x1a8),'VA':'VAT','XK':_0x256432(0x228),'AM':'ARM','AZ':_0x256432(0x1bc),'KZ':_0x256432(0x1d6),'KG':_0x256432(0x24f),'TJ':_0x256432(0x18f),'TM':'TKM','UZ':'UZB','US':_0x256432(0x201),'CA':_0x256432(0x247),'AU':_0x256432(0x1f9),'JP':_0x256432(0x1e7),'CN':_0x256432(0x24e),'IN':'IND','BR':_0x256432(0x234),'MX':_0x256432(0x22f),'AR':_0x256432(0x192),'CL':_0x256432(0x22b),'PE':_0x256432(0x21d),'CO':_0x256432(0x1f1),'VE':_0x256432(0x191),'EC':_0x256432(0x220),'BO':_0x256432(0x186),'PY':_0x256432(0x20c),'UY':_0x256432(0x1a3),'SR':'SUR','GY':_0x256432(0x198),'FK':'FLK','ZA':'ZAF','EG':_0x256432(0x1be),'NG':_0x256432(0x1e4),'KE':_0x256432(0x1cb),'GH':_0x256432(0x209),'TZ':'TZA','UG':_0x256432(0x1ff),'ZW':_0x256432(0x22e),'ZM':_0x256432(0x250),'MW':_0x256432(0x187),'MZ':_0x256432(0x203),'MG':_0x256432(0x184),'MU':_0x256432(0x1e3),'SC':_0x256432(0x216),'RE':_0x256432(0x1aa),'TR':_0x256432(0x1fd),'IR':'IRN','IQ':_0x256432(0x1dd),'SA':_0x256432(0x1a1),'AE':_0x256432(0x1f5),'KW':_0x256432(0x197),'QA':'QAT','BH':_0x256432(0x24a),'OM':_0x256432(0x206),'YE':_0x256432(0x218),'JO':_0x256432(0x24c),'LB':_0x256432(0x196),'SY':_0x256432(0x1a2),'IL':_0x256432(0x20e),'PS':_0x256432(0x19b),'KR':'KOR','KP':'PRK','TH':_0x256432(0x245),'VN':'VNM','MY':_0x256432(0x188),'SG':_0x256432(0x1b3),'ID':_0x256432(0x1b4),'PH':'PHL','LA':_0x256432(0x20f),'KH':_0x256432(0x224),'MM':'MMR','BD':'BGD','LK':_0x256432(0x255),'NP':_0x256432(0x1fc),'BT':_0x256432(0x1c0),'MV':_0x256432(0x236),'AF':'AFG','PK':_0x256432(0x1a5),'MN':_0x256432(0x1b1)},_0x583f13=_0x2ddce1[_0x493c27['toUpperCase']()];if(!_0x583f13)return console[_0x256432(0x208)]('‚ö†Ô∏è\x20Unknown\x20country\x20code:\x20'+_0x493c27+',\x20using\x20TUR\x20as\x20fallback\x20for\x20AmPay\x20TRY'),_0x256432(0x1fd);return _0x583f13;}async[a63_0x493c32(0x227)](_0x5d9bdb){const _0x22d9e6=a63_0x493c32;console['log']('üöÄ\x20Creating\x20AmPay\x20TRY\x20payment\x20request:',{'paymentId':_0x5d9bdb['paymentId'],'amount':_0x5d9bdb[_0x22d9e6(0x231)],'currency':_0x5d9bdb[_0x22d9e6(0x254)],'customerCountry':_0x5d9bdb[_0x22d9e6(0x232)]});try{const _0x2ff6dc={'client_merchant_id':this[_0x22d9e6(0x19a)],'payment_method':_0x22d9e6(0x1d3),'client_transaction_id':_0x5d9bdb[_0x22d9e6(0x222)],'amount':_0x5d9bdb[_0x22d9e6(0x231)],'currency':_0x5d9bdb[_0x22d9e6(0x254)],'callback_url':'https://traffer.uk/gateway/ampay-try/webhook.php','tracker_id':_0x5d9bdb[_0x22d9e6(0x1ee)],'redirect_url':_0x5d9bdb['successUrl'],'failure_url':_0x5d9bdb[_0x22d9e6(0x1d8)],'customer_first_name':_0x5d9bdb[_0x22d9e6(0x22d)],'customer_last_name':_0x5d9bdb[_0x22d9e6(0x1ec)],'customer_email':_0x5d9bdb[_0x22d9e6(0x221)],'customer_phone':_0x5d9bdb[_0x22d9e6(0x1dc)]||'','customer_ip':_0x5d9bdb[_0x22d9e6(0x195)],'customer_country':_0x5d9bdb[_0x22d9e6(0x232)],'api_public_key':this[_0x22d9e6(0x20b)]};console[_0x22d9e6(0x225)](_0x22d9e6(0x202),JSON[_0x22d9e6(0x19c)](_0x2ff6dc,null,0x2));const _0x58da79=await fetch(this[_0x22d9e6(0x199)],{'method':_0x22d9e6(0x217),'headers':{'Content-Type':'application/json','User-Agent':_0x22d9e6(0x200)},'body':JSON[_0x22d9e6(0x19c)](_0x2ff6dc)});console[_0x22d9e6(0x225)](_0x22d9e6(0x18e),_0x58da79[_0x22d9e6(0x249)]);const _0x2e4788=await _0x58da79[_0x22d9e6(0x229)]();console[_0x22d9e6(0x225)](_0x22d9e6(0x1d0),_0x2e4788);let _0x2c0b4e;try{_0x2c0b4e=JSON[_0x22d9e6(0x18c)](_0x2e4788);}catch(_0x56dec7){console[_0x22d9e6(0x1c9)](_0x22d9e6(0x19f),_0x56dec7);throw new Error(_0x22d9e6(0x19e)+_0x2e4788);}console[_0x22d9e6(0x225)](_0x22d9e6(0x22c),JSON[_0x22d9e6(0x19c)](_0x2c0b4e,null,0x2)),loggerService_1[_0x22d9e6(0x23b)][_0x22d9e6(0x1a7)](_0x22d9e6(0x194),_0x2c0b4e,{});if(!_0x58da79['ok']){const _0x1d70dd=_0x2c0b4e['error_message']||_0x2c0b4e['message']||_0x22d9e6(0x1ad)+_0x58da79['status'];console['error']('‚ùå\x20AmPay\x20TRY\x20API\x20error:',_0x1d70dd);throw new Error('AmPay\x20TRY\x20API\x20error:\x20'+_0x1d70dd);}if(!_0x2c0b4e[_0x22d9e6(0x1e6)]){console[_0x22d9e6(0x1c9)](_0x22d9e6(0x18d),_0x2c0b4e);throw new Error(_0x22d9e6(0x1f6));}const _0x1530e6={'gateway_payment_id':_0x2c0b4e[_0x22d9e6(0x1f3)]||_0x5d9bdb[_0x22d9e6(0x222)],'payment_url':_0x2c0b4e[_0x22d9e6(0x1e6)],'transaction_id':_0x2c0b4e['client_transaction_id']};return console['log'](_0x22d9e6(0x1f4),_0x1530e6),_0x1530e6;}catch(_0x3cbad9){console[_0x22d9e6(0x1c9)](_0x22d9e6(0x1a0),_0x3cbad9),loggerService_1['loggerService'][_0x22d9e6(0x1c8)](_0x22d9e6(0x194),_0x3cbad9,_0x5d9bdb);throw _0x3cbad9;}}async['createPaymentLink'](_0x2ed721){const _0x1effd2=a63_0x493c32;try{const {orderId:_0x5ae69f,amount:_0x5cd2b7,currency:_0xcfd817,firstName:_0x30620b,lastName:_0x570abd,email:_0x24d0e9,phone:_0x8af2a7,customerIp:_0x440db0,customerCountry:_0x4a4204,successUrl:_0xbc6c6f,failureUrl:_0x4194b4}=_0x2ed721;console[_0x1effd2(0x225)](_0x1effd2(0x1e2)),console[_0x1effd2(0x225)](_0x1effd2(0x1cf),_0x5ae69f),console[_0x1effd2(0x225)]('Amount:',_0x5cd2b7,_0xcfd817),console[_0x1effd2(0x225)](_0x1effd2(0x205),_0x30620b+'\x20'+_0x570abd),console['log'](_0x1effd2(0x244),_0x24d0e9),console[_0x1effd2(0x225)](_0x1effd2(0x190),_0x8af2a7||_0x1effd2(0x1c1)),console[_0x1effd2(0x225)](_0x1effd2(0x21b),_0x440db0),console['log'](_0x1effd2(0x193),_0x4a4204);const _0x492a48=this[_0x1effd2(0x237)](_0x4a4204);console['log'](_0x1effd2(0x1d1),_0x492a48);const _0x72c2bc={'sub_method':_0x1effd2(0x1fb),'currency':_0xcfd817[_0x1effd2(0x1e8)](),'amount':_0x5cd2b7,'callback_url':'https://traffer.uk/gateway/ampay-try/webhook.php','client_merchant_id':this[_0x1effd2(0x19a)],'client_transaction_id':_0x5ae69f,'transaction_description':_0x5ae69f,'customer':{'ip':_0x440db0,'email':_0x24d0e9,'full_name':_0x30620b+'\x20'+_0x570abd,'phone':_0x8af2a7||'','country':_0x492a48},'success_redirect_url':_0xbc6c6f,'error_redirect_url':_0x4194b4};console[_0x1effd2(0x225)]('üì§\x20AmPay\x20TRY\x20request\x20body:',JSON[_0x1effd2(0x19c)](_0x72c2bc,null,0x2));const _0xc9e2a3=await fetch(this['apiUrl']+_0x1effd2(0x1c7),{'method':_0x1effd2(0x217),'headers':{'Content-Type':_0x1effd2(0x1ca),'User-Agent':_0x1effd2(0x212)},'body':JSON[_0x1effd2(0x19c)](_0x72c2bc)}),_0x2114fe=await _0xc9e2a3['text']();console[_0x1effd2(0x225)](_0x1effd2(0x21c),_0x2114fe);if(!_0xc9e2a3['ok'])throw new Error(_0x1effd2(0x226)+_0xc9e2a3[_0x1effd2(0x249)]+_0x1effd2(0x252)+_0x2114fe);let _0x52cade;try{_0x52cade=JSON[_0x1effd2(0x18c)](_0x2114fe);}catch(_0x3261b1){throw new Error(_0x1effd2(0x19e)+_0x2114fe);}console[_0x1effd2(0x225)](_0x1effd2(0x242),JSON['stringify'](_0x52cade,null,0x2));if(!_0x52cade['redirect_url'])throw new Error(_0x1effd2(0x1ea)+(_0x52cade[_0x1effd2(0x18b)]||_0x52cade[_0x1effd2(0x1e9)]||_0x1effd2(0x1d2)));const _0x599f56=_0x52cade['redirect_url'],_0x2e201b=_0x52cade[_0x1effd2(0x1f3)],_0x187602=_0x52cade[_0x1effd2(0x18a)];return console[_0x1effd2(0x225)]('‚úÖ\x20AmPay\x20TRY\x20payment\x20link\x20created\x20successfully'),console[_0x1effd2(0x225)](_0x1effd2(0x1ab),_0x599f56),console[_0x1effd2(0x225)](_0x1effd2(0x1eb),_0x2e201b),console[_0x1effd2(0x225)](_0x1effd2(0x1b7),_0x187602),console[_0x1effd2(0x225)](_0x1effd2(0x230),_0x52cade[_0x1effd2(0x249)]),console['log'](_0x1effd2(0x1c2)),{'gateway_payment_id':_0x2e201b||_0x187602||_0x5ae69f,'payment_url':_0x599f56||'','transaction_id':_0x2e201b};}catch(_0x358765){console[_0x1effd2(0x1c9)](_0x1effd2(0x1a0),_0x358765),console['log']('üìù\x20Logging\x20AmPay\x20TRY\x20payment\x20creation\x20failure...'),loggerService_1[_0x1effd2(0x23b)][_0x1effd2(0x1c8)](_0x1effd2(0x194),_0x358765,_0x2ed721);throw _0x358765;}}async[a63_0x493c32(0x21f)](_0x1541d5){const _0x143297=a63_0x493c32;console['log'](_0x143297(0x24d),_0x1541d5);try{const _0x322c67={'client_merchant_id':this['CLIENT_MERCHANT_ID'],'system_id':_0x1541d5,'api_public_key':this[_0x143297(0x20b)]},_0x4270c8=await fetch(this[_0x143297(0x199)]+_0x143297(0x1db),{'method':_0x143297(0x217),'headers':{'Content-Type':_0x143297(0x1ca),'User-Agent':_0x143297(0x200)},'body':JSON[_0x143297(0x19c)](_0x322c67)}),_0x525f44=await _0x4270c8[_0x143297(0x229)]();console[_0x143297(0x225)](_0x143297(0x1b9),_0x525f44);let _0x3a79b3;try{_0x3a79b3=JSON[_0x143297(0x18c)](_0x525f44);}catch(_0xb2f257){return console['error'](_0x143297(0x1f7),_0xb2f257),{'status':_0x143297(0x1b6)};}console['log']('üìä\x20AmPay\x20TRY\x20status\x20response:',JSON[_0x143297(0x19c)](_0x3a79b3,null,0x2));let _0x44e2fb=_0x143297(0x248);if(_0x3a79b3[_0x143297(0x249)])switch(_0x3a79b3[_0x143297(0x249)][_0x143297(0x1c6)]()){case _0x143297(0x1ed):case'completed':case'paid':_0x44e2fb='PAID';break;case _0x143297(0x1e0):case _0x143297(0x1c9):case'declined':_0x44e2fb=_0x143297(0x1b6);break;case _0x143297(0x241):case'timeout':_0x44e2fb=_0x143297(0x207);break;case _0x143297(0x1fa):case _0x143297(0x1b5):case _0x143297(0x1f2):default:_0x44e2fb=_0x143297(0x248);break;}return{'status':_0x44e2fb,'amount':_0x3a79b3['amount'],'currency':_0x3a79b3[_0x143297(0x254)]};}catch(_0xecdb78){return console[_0x143297(0x1c9)](_0x143297(0x238),_0xecdb78),{'status':'FAILED'};}}async[a63_0x493c32(0x219)](_0x5d62f3){const _0x119938=a63_0x493c32;console[_0x119938(0x225)](_0x119938(0x251),JSON[_0x119938(0x19c)](_0x5d62f3,null,0x2));try{const _0x1d071c=_0x5d62f3[_0x119938(0x18a)]||_0x5d62f3[_0x119938(0x1ae)]||_0x5d62f3['system_id'];if(!_0x1d071c){console[_0x119938(0x1c9)](_0x119938(0x1a9));throw new Error(_0x119938(0x23a));}let _0x60e127='PENDING';if(_0x5d62f3[_0x119938(0x249)])switch(_0x5d62f3['status'][_0x119938(0x1c6)]()){case _0x119938(0x1ed):case _0x119938(0x243):case _0x119938(0x1a4):_0x60e127=_0x119938(0x1ce);break;case _0x119938(0x1e0):case'error':case'declined':_0x60e127=_0x119938(0x1b6);break;case _0x119938(0x241):case _0x119938(0x213):_0x60e127='EXPIRED';break;case'pending':case'processing':case _0x119938(0x1f2):default:_0x60e127=_0x119938(0x248);break;}return console[_0x119938(0x225)]('üìä\x20AmPay\x20TRY\x20webhook\x20processed:\x20'+_0x1d071c+_0x119938(0x22a)+_0x60e127),{'paymentId':_0x1d071c,'status':_0x60e127,'amount':_0x5d62f3[_0x119938(0x231)],'currency':_0x5d62f3['currency']||_0x119938(0x1d4)};}catch(_0x2b09be){console[_0x119938(0x1c9)](_0x119938(0x24b),_0x2b09be);throw _0x2b09be;}}[a63_0x493c32(0x1ef)](_0x458fe2,_0x444d55){const _0x41f277=a63_0x493c32;return console[_0x41f277(0x225)](_0x41f277(0x214)),!![];}}exports[a63_0x493c32(0x1b2)]=AmPayTRYService;