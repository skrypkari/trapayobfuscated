'use strict';function a47_0x2982(_0x2e4a68,_0x384725){const _0xd07cb0=a47_0xd07c();return a47_0x2982=function(_0x2982c3,_0x2e2d07){_0x2982c3=_0x2982c3-0xb1;let _0xd6db21=_0xd07cb0[_0x2982c3];return _0xd6db21;},a47_0x2982(_0x2e4a68,_0x384725);}const a47_0x45b667=a47_0x2982;(function(_0x3a9b79,_0x495c27){const _0x42691c=a47_0x2982,_0x18c66d=_0x3a9b79();while(!![]){try{const _0x43d415=parseInt(_0x42691c(0x146))/0x1+parseInt(_0x42691c(0x118))/0x2*(-parseInt(_0x42691c(0x119))/0x3)+parseInt(_0x42691c(0xfe))/0x4+parseInt(_0x42691c(0x15a))/0x5+-parseInt(_0x42691c(0x100))/0x6+-parseInt(_0x42691c(0x136))/0x7*(parseInt(_0x42691c(0xc1))/0x8)+-parseInt(_0x42691c(0x173))/0x9*(-parseInt(_0x42691c(0x180))/0xa);if(_0x43d415===_0x495c27)break;else _0x18c66d['push'](_0x18c66d['shift']());}catch(_0x55a334){_0x18c66d['push'](_0x18c66d['shift']());}}}(a47_0xd07c,0x28a6f));Object[a47_0x45b667(0x177)](exports,a47_0x45b667(0x172),{'value':!![]}),exports['AmPayTRYService']=void 0x0;function a47_0xd07c(){const _0x5ce7b1=['SWE','processWebhook','message','system_id','CLIENT_MERCHANT_ID','paymentId','loggerService','üìä\x20AmPay\x20TRY\x20response\x20data:','successUrl','System\x20ID:','logWebhookReceived','AUT','PAK','BIH','NOR','545508sUFiOz','EXPIRED','1698606sxcdQO','TZA','log','ampay-try','ALB','FIN','AFG','JPN','EGY','GAM','MLT','üîê\x20AmPay\x20TRY\x20webhook\x20signature\x20verification\x20not\x20implemented\x20yet','MYS','‚ùå\x20No\x20redirect_url\x20in\x20AmPay\x20TRY\x20response:','Email:','NPL','email','AmPay\x20TRY\x20API\x20error:\x20HTTP\x20','MWI','Invalid\x20JSON\x20response\x20from\x20AmPay\x20TRY:\x20','convert2LetterTo3LetterCountryCode','tracker_id','üáπüá∑\x20AmPay\x20TRY\x20service\x20initialized\x20with\x20IBAN\x20Bank\x20Transfer\x20TR\x20processing','AUS','4GUpqJW','46194eOkkpb','üìù\x20AmPay\x20TRY\x20API\x20raw\x20response:','MKD','SYR','üìä\x20AmPay\x20TRY\x20parsed\x20response:','failed','VEN','SVN','/status',',\x20using\x20TUR\x20as\x20fallback\x20for\x20AmPay\x20TRY','üì•\x20AmPay\x20TRY\x20raw\x20response:','error','redirect_url','checkPaymentStatus','‚ùå\x20AmPay\x20TRY\x20API\x20error:','Tracker\x20ID:','ISL','SGP','FLK','CHL','BRA','CHN','Customer\x20IP:','BTN','üîç\x20Checking\x20AmPay\x20TRY\x20payment\x20status\x20for:','completed','58b59ccbc03dcdcfc20d830edfba765dbf9f3531c692533d84b17938e9c40bda','createPaymentLink','LBN','7GVDaTP','verifyWebhookSignature','createPayment','üìù\x20AmPay\x20TRY\x20status\x20raw\x20response:','\x20-\x20','ROU','‚ùå\x20Failed\x20to\x20parse\x20AmPay\x20TRY\x20status\x20response:','customerCountry','TRAFFER','Customer\x20Country\x20(3-letter):','LAO','KEN','üìä\x20AmPay\x20TRY\x20status\x20response:','MMR','XKX','MEX','99237hjSFTK','timeout','RUS','AmPay\x20TRY\x20payment\x20creation\x20failed:\x20','üì§\x20AmPay\x20TRY\x20API\x20request\x20data:','BOL','pending','BLR','‚ùå\x20AmPay\x20TRY\x20payment\x20creation\x20failed:','Amount:','PER','BHR','lastName','expired','NGA','HTTP\x20','API_PUBLIC_KEY','‚úÖ\x20AmPay\x20TRY\x20payment\x20created\x20successfully:','TrapayEnd/1.0','paid','1470620yALMjP','https://traffer.uk/gateway/ampay-try/','../loggerService','failureUrl','TJK','TUR','firstName','IDN','POST','IND','warn','client_transaction_id','üöÄ\x20Creating\x20AmPay\x20TRY\x20payment\x20request:','UKR','ZAF','FAILED','SYC','GEO','Customer\x20Country\x20(2-letter):','toUpperCase','CYP','BEL','LIE','BGD','__esModule','216bsVmYr','GBR','logWebhookError','MDV','defineProperty','Unknown\x20error','Bank\x20Transfer\x20TR','apiUrl','TRY','KOR','application/json','GHA','processing','4130sjURNJ','COL','üáπüá∑\x20Creating\x20AmPay\x20TRY\x20payment\x20link...','amount','üìù\x20Logging\x20AmPay\x20TRY\x20payment\x20creation\x20event...','JOR','TrapayAPI/1.0','üì°\x20AmPay\x20TRY\x20API\x20response\x20status:','AZE','MDA','No\x20payment\x20ID\x20in\x20webhook\x20data','waiting','ARM','‚ùå\x20AmPay\x20TRY\x20webhook\x20processing\x20failed:','Payment\x20URL:','https://traffer.uk/gateway/ampay-try/webhook.php','USA','473936RQJmwj','ISR','PSE','text','PENDING','stringify','ZMB','status','üìù\x20Logging\x20AmPay\x20TRY\x20payment\x20creation\x20failure...','not\x20provided','‚ùå\x20AmPay\x20TRY\x20status\x20check\x20failed:','NLD','LTU','currency','KWT','phone','AND','parse','SAU','UGA','PAID','ARE','declined','ESP','THA','GUY','‚ùå\x20No\x20payment\x20ID\x20found\x20in\x20AmPay\x20TRY\x20webhook\x20data','ECU','TKM','‚ùå\x20Failed\x20to\x20parse\x20AmPay\x20TRY\x20API\x20response:','HRV','OMN','UZB','toLowerCase','a5a059aa63392e571341bddc5148a5db66643722e9a6bf16a9395fb690a80288931d5a1180a85a28eb9f6516cf61dfc1bf4e37898f3a35261cd2db88888d3815','CZE','PRY','AmPay\x20TRY\x20did\x20not\x20return\x20a\x20payment\x20URL','KAZ','üì•\x20Processing\x20AmPay\x20TRY\x20webhook:','GRC','\x20->\x20','Phone:','Order\x20ID:','ampay.php','SRB'];a47_0xd07c=function(){return _0x5ce7b1;};return a47_0xd07c();}const loggerService_1=require(a47_0x45b667(0x15c));class AmPayTRYService{constructor(){const _0x44eb92=a47_0x45b667;this[_0x44eb92(0xf3)]=_0x44eb92(0x13e),this[_0x44eb92(0x156)]=_0x44eb92(0x133),this['API_PRIVATE_KEY']=_0x44eb92(0xe3),this['apiUrl']=_0x44eb92(0x15b),console['log'](_0x44eb92(0x116));}['convert2LetterTo3LetterCountryCode'](_0x4d0d1f){const _0x414f22=a47_0x45b667,_0x6f6c81={'AD':_0x414f22(0xd1),'AL':_0x414f22(0x104),'AT':_0x414f22(0xfa),'BA':_0x414f22(0xfc),'BE':_0x414f22(0x16f),'BG':'BGR','BY':_0x414f22(0x14d),'CH':'CHE','CY':_0x414f22(0x16e),'CZ':_0x414f22(0xe4),'DE':'DEU','DK':'DNK','EE':'EST','ES':_0x414f22(0xd8),'FI':_0x414f22(0x105),'FR':'FRA','GB':_0x414f22(0x174),'GE':_0x414f22(0x16b),'GR':_0x414f22(0xe9),'HR':_0x414f22(0xdf),'HU':'HUN','IE':'IRL','IS':_0x414f22(0x129),'IT':'ITA','LI':_0x414f22(0x170),'LT':_0x414f22(0xcd),'LU':'LUX','LV':'LVA','MC':'MCO','MD':_0x414f22(0xb9),'ME':'MNE','MK':_0x414f22(0x11b),'MT':_0x414f22(0x10a),'NL':_0x414f22(0xcc),'NO':_0x414f22(0xfd),'PL':'POL','PT':'PRT','RO':_0x414f22(0x13b),'RS':_0x414f22(0xee),'RU':_0x414f22(0x148),'SE':_0x414f22(0xef),'SI':_0x414f22(0x120),'SK':'SVK','SM':'SMR','UA':_0x414f22(0x167),'VA':'VAT','XK':_0x414f22(0x144),'AM':_0x414f22(0xbc),'AZ':_0x414f22(0xb8),'KZ':_0x414f22(0xe7),'KG':'KGZ','TJ':_0x414f22(0x15e),'TM':_0x414f22(0xdd),'UZ':_0x414f22(0xe1),'US':_0x414f22(0xc0),'CA':'CAN','AU':_0x414f22(0x117),'JP':_0x414f22(0x107),'CN':_0x414f22(0x12e),'IN':_0x414f22(0x163),'BR':_0x414f22(0x12d),'MX':_0x414f22(0x145),'AR':'ARG','CL':_0x414f22(0x12c),'PE':_0x414f22(0x150),'CO':_0x414f22(0xb1),'VE':_0x414f22(0x11f),'EC':_0x414f22(0xdc),'BO':_0x414f22(0x14b),'PY':_0x414f22(0xe5),'UY':'URY','SR':'SUR','GY':_0x414f22(0xda),'FK':_0x414f22(0x12b),'ZA':_0x414f22(0x168),'EG':_0x414f22(0x108),'NG':_0x414f22(0x154),'KE':_0x414f22(0x141),'GH':_0x414f22(0x17e),'TZ':_0x414f22(0x101),'UG':_0x414f22(0xd4),'ZW':'ZWE','ZM':_0x414f22(0xc7),'MW':_0x414f22(0x112),'MZ':'MOZ','MG':'MDG','MU':'MUS','SC':_0x414f22(0x16a),'RE':'REU','TR':_0x414f22(0x15f),'IR':'IRN','IQ':'IRQ','SA':_0x414f22(0xd3),'AE':_0x414f22(0xd6),'KW':_0x414f22(0xcf),'QA':'QAT','BH':_0x414f22(0x151),'OM':_0x414f22(0xe0),'YE':'YEM','JO':_0x414f22(0xb5),'LB':_0x414f22(0x135),'SY':_0x414f22(0x11c),'IL':_0x414f22(0xc2),'PS':_0x414f22(0xc3),'KR':_0x414f22(0x17c),'KP':'PRK','TH':_0x414f22(0xd9),'VN':'VNM','MY':_0x414f22(0x10c),'SG':_0x414f22(0x12a),'ID':_0x414f22(0x161),'PH':'PHL','LA':_0x414f22(0x140),'KH':'KHM','MM':_0x414f22(0x143),'BD':_0x414f22(0x171),'LK':'LKA','NP':_0x414f22(0x10f),'BT':_0x414f22(0x130),'MV':_0x414f22(0x176),'AF':_0x414f22(0x106),'PK':_0x414f22(0xfb),'MN':'MNG'},_0xe0c8a3=_0x6f6c81[_0x4d0d1f[_0x414f22(0x16d)]()];if(!_0xe0c8a3)return console[_0x414f22(0x164)]('‚ö†Ô∏è\x20Unknown\x20country\x20code:\x20'+_0x4d0d1f+_0x414f22(0x122)),_0x414f22(0x15f);return _0xe0c8a3;}async[a47_0x45b667(0x138)](_0x585732){const _0x43a02d=a47_0x45b667;console['log'](_0x43a02d(0x166),{'paymentId':_0x585732[_0x43a02d(0xf4)],'amount':_0x585732[_0x43a02d(0xb3)],'currency':_0x585732['currency'],'customerCountry':_0x585732[_0x43a02d(0x13d)]});try{const _0x1539fd={'client_merchant_id':this[_0x43a02d(0xf3)],'payment_method':_0x43a02d(0x179),'client_transaction_id':_0x585732['orderId'],'amount':_0x585732['amount'],'currency':_0x585732[_0x43a02d(0xce)],'callback_url':_0x43a02d(0xbf),'tracker_id':_0x585732[_0x43a02d(0xf4)],'redirect_url':_0x585732[_0x43a02d(0xf7)],'failure_url':_0x585732[_0x43a02d(0x15d)],'customer_first_name':_0x585732[_0x43a02d(0x160)],'customer_last_name':_0x585732[_0x43a02d(0x152)],'customer_email':_0x585732[_0x43a02d(0x110)],'customer_phone':_0x585732[_0x43a02d(0xd0)]||'','customer_ip':_0x585732['customerIp'],'customer_country':_0x585732[_0x43a02d(0x13d)],'api_public_key':this['API_PUBLIC_KEY']};console['log'](_0x43a02d(0x14a),JSON[_0x43a02d(0xc6)](_0x1539fd,null,0x2));const _0x1ebe05=await fetch(this[_0x43a02d(0x17a)],{'method':_0x43a02d(0x162),'headers':{'Content-Type':_0x43a02d(0x17d),'User-Agent':_0x43a02d(0x158)},'body':JSON[_0x43a02d(0xc6)](_0x1539fd)});console['log'](_0x43a02d(0xb7),_0x1ebe05[_0x43a02d(0xc8)]);const _0x361e82=await _0x1ebe05[_0x43a02d(0xc4)]();console[_0x43a02d(0x102)](_0x43a02d(0x11a),_0x361e82);let _0x1f7dbe;try{_0x1f7dbe=JSON[_0x43a02d(0xd2)](_0x361e82);}catch(_0x1c9521){console[_0x43a02d(0x124)](_0x43a02d(0xde),_0x1c9521);throw new Error('Invalid\x20JSON\x20response\x20from\x20AmPay\x20TRY:\x20'+_0x361e82);}console[_0x43a02d(0x102)](_0x43a02d(0x11d),JSON['stringify'](_0x1f7dbe,null,0x2)),loggerService_1['loggerService'][_0x43a02d(0xf9)](_0x43a02d(0x103),_0x1f7dbe,{});if(!_0x1ebe05['ok']){const _0x195b21=_0x1f7dbe['error_message']||_0x1f7dbe['message']||_0x43a02d(0x155)+_0x1ebe05[_0x43a02d(0xc8)];console[_0x43a02d(0x124)](_0x43a02d(0x127),_0x195b21);throw new Error('AmPay\x20TRY\x20API\x20error:\x20'+_0x195b21);}if(!_0x1f7dbe['redirect_url']){console['error'](_0x43a02d(0x10d),_0x1f7dbe);throw new Error(_0x43a02d(0xe6));}const _0xbcffa2={'gateway_payment_id':_0x1f7dbe[_0x43a02d(0xf2)]||_0x585732['orderId'],'payment_url':_0x1f7dbe[_0x43a02d(0x125)],'transaction_id':_0x1f7dbe['client_transaction_id']};return console[_0x43a02d(0x102)](_0x43a02d(0x157),_0xbcffa2),_0xbcffa2;}catch(_0x18cacd){console[_0x43a02d(0x124)]('‚ùå\x20AmPay\x20TRY\x20payment\x20creation\x20failed:',_0x18cacd),loggerService_1[_0x43a02d(0xf5)]['logWebhookError'](_0x43a02d(0x103),_0x18cacd,_0x585732);throw _0x18cacd;}}async[a47_0x45b667(0x134)](_0x484800){const _0x317d9b=a47_0x45b667;try{const {orderId:_0x21835d,amount:_0x49e7e7,currency:_0x510bbb,firstName:_0x50e184,lastName:_0x1cfe95,email:_0xf93d19,phone:_0x1fabbf,customerIp:_0x504203,customerCountry:_0x1a0cd3,successUrl:_0x266ec1,failureUrl:_0x588328}=_0x484800;console[_0x317d9b(0x102)](_0x317d9b(0xb2)),console['log'](_0x317d9b(0xec),_0x21835d),console[_0x317d9b(0x102)](_0x317d9b(0x14f),_0x49e7e7,_0x510bbb),console['log']('Customer:',_0x50e184+'\x20'+_0x1cfe95),console['log'](_0x317d9b(0x10e),_0xf93d19),console[_0x317d9b(0x102)](_0x317d9b(0xeb),_0x1fabbf||_0x317d9b(0xca)),console[_0x317d9b(0x102)](_0x317d9b(0x12f),_0x504203),console[_0x317d9b(0x102)](_0x317d9b(0x16c),_0x1a0cd3);const _0x2465c4=this[_0x317d9b(0x114)](_0x1a0cd3);console[_0x317d9b(0x102)](_0x317d9b(0x13f),_0x2465c4);const _0x276fd6={'sub_method':_0x317d9b(0x109),'currency':_0x510bbb[_0x317d9b(0x16d)](),'amount':_0x49e7e7,'callback_url':_0x317d9b(0xbf),'client_merchant_id':this['CLIENT_MERCHANT_ID'],'client_transaction_id':_0x21835d,'transaction_description':_0x21835d,'customer':{'ip':_0x504203,'email':_0xf93d19,'full_name':_0x50e184+'\x20'+_0x1cfe95,'phone':_0x1fabbf||'','country':_0x2465c4},'success_redirect_url':_0x266ec1,'error_redirect_url':_0x588328};console[_0x317d9b(0x102)]('üì§\x20AmPay\x20TRY\x20request\x20body:',JSON[_0x317d9b(0xc6)](_0x276fd6,null,0x2));const _0x3a71b5=await fetch(this[_0x317d9b(0x17a)]+_0x317d9b(0xed),{'method':_0x317d9b(0x162),'headers':{'Content-Type':_0x317d9b(0x17d),'User-Agent':_0x317d9b(0xb6)},'body':JSON[_0x317d9b(0xc6)](_0x276fd6)}),_0x422b88=await _0x3a71b5[_0x317d9b(0xc4)]();console['log'](_0x317d9b(0x123),_0x422b88);if(!_0x3a71b5['ok'])throw new Error(_0x317d9b(0x111)+_0x3a71b5[_0x317d9b(0xc8)]+_0x317d9b(0x13a)+_0x422b88);let _0x5e21c0;try{_0x5e21c0=JSON[_0x317d9b(0xd2)](_0x422b88);}catch(_0x402c1f){throw new Error(_0x317d9b(0x113)+_0x422b88);}console[_0x317d9b(0x102)](_0x317d9b(0xf6),JSON[_0x317d9b(0xc6)](_0x5e21c0,null,0x2));if(!_0x5e21c0[_0x317d9b(0x125)])throw new Error(_0x317d9b(0x149)+(_0x5e21c0['error_message']||_0x5e21c0[_0x317d9b(0xf1)]||_0x317d9b(0x178)));const _0x2a433e=_0x5e21c0['redirect_url'],_0x30e995=_0x5e21c0['system_id'],_0xd5112e=_0x5e21c0[_0x317d9b(0x115)];return console['log']('‚úÖ\x20AmPay\x20TRY\x20payment\x20link\x20created\x20successfully'),console['log'](_0x317d9b(0xbe),_0x2a433e),console[_0x317d9b(0x102)](_0x317d9b(0xf8),_0x30e995),console['log'](_0x317d9b(0x128),_0xd5112e),console[_0x317d9b(0x102)]('Status:',_0x5e21c0[_0x317d9b(0xc8)]),console[_0x317d9b(0x102)](_0x317d9b(0xb4)),{'gateway_payment_id':_0x30e995||_0xd5112e||_0x21835d,'payment_url':_0x2a433e||'','transaction_id':_0x30e995};}catch(_0x1633a3){console[_0x317d9b(0x124)](_0x317d9b(0x14e),_0x1633a3),console[_0x317d9b(0x102)](_0x317d9b(0xc9)),loggerService_1[_0x317d9b(0xf5)][_0x317d9b(0x175)]('ampay-try',_0x1633a3,_0x484800);throw _0x1633a3;}}async[a47_0x45b667(0x126)](_0x154f3d){const _0x1c141d=a47_0x45b667;console[_0x1c141d(0x102)](_0x1c141d(0x131),_0x154f3d);try{const _0x26c5b9={'client_merchant_id':this['CLIENT_MERCHANT_ID'],'system_id':_0x154f3d,'api_public_key':this[_0x1c141d(0x156)]},_0x34022f=await fetch(this[_0x1c141d(0x17a)]+_0x1c141d(0x121),{'method':_0x1c141d(0x162),'headers':{'Content-Type':_0x1c141d(0x17d),'User-Agent':_0x1c141d(0x158)},'body':JSON[_0x1c141d(0xc6)](_0x26c5b9)}),_0x25da31=await _0x34022f['text']();console[_0x1c141d(0x102)](_0x1c141d(0x139),_0x25da31);let _0x1dfe18;try{_0x1dfe18=JSON['parse'](_0x25da31);}catch(_0xf4a53f){return console[_0x1c141d(0x124)](_0x1c141d(0x13c),_0xf4a53f),{'status':_0x1c141d(0x169)};}console[_0x1c141d(0x102)](_0x1c141d(0x142),JSON[_0x1c141d(0xc6)](_0x1dfe18,null,0x2));let _0xcfce66=_0x1c141d(0xc5);if(_0x1dfe18[_0x1c141d(0xc8)])switch(_0x1dfe18['status'][_0x1c141d(0xe2)]()){case'success':case _0x1c141d(0x132):case _0x1c141d(0x159):_0xcfce66=_0x1c141d(0xd5);break;case _0x1c141d(0x11e):case _0x1c141d(0x124):case _0x1c141d(0xd7):_0xcfce66=_0x1c141d(0x169);break;case _0x1c141d(0x153):case _0x1c141d(0x147):_0xcfce66=_0x1c141d(0xff);break;case _0x1c141d(0x14c):case _0x1c141d(0x17f):case _0x1c141d(0xbb):default:_0xcfce66=_0x1c141d(0xc5);break;}return{'status':_0xcfce66,'amount':_0x1dfe18[_0x1c141d(0xb3)],'currency':_0x1dfe18['currency']};}catch(_0x16675e){return console[_0x1c141d(0x124)](_0x1c141d(0xcb),_0x16675e),{'status':_0x1c141d(0x169)};}}async[a47_0x45b667(0xf0)](_0x30f9ae){const _0x581523=a47_0x45b667;console[_0x581523(0x102)](_0x581523(0xe8),JSON[_0x581523(0xc6)](_0x30f9ae,null,0x2));try{const _0x4e80bb=_0x30f9ae['tracker_id']||_0x30f9ae[_0x581523(0x165)]||_0x30f9ae[_0x581523(0xf2)];if(!_0x4e80bb){console[_0x581523(0x124)](_0x581523(0xdb));throw new Error(_0x581523(0xba));}let _0x4ab3d4=_0x581523(0xc5);if(_0x30f9ae['status'])switch(_0x30f9ae[_0x581523(0xc8)][_0x581523(0xe2)]()){case'success':case'completed':case _0x581523(0x159):_0x4ab3d4=_0x581523(0xd5);break;case _0x581523(0x11e):case _0x581523(0x124):case _0x581523(0xd7):_0x4ab3d4=_0x581523(0x169);break;case _0x581523(0x153):case'timeout':_0x4ab3d4='EXPIRED';break;case _0x581523(0x14c):case _0x581523(0x17f):case _0x581523(0xbb):default:_0x4ab3d4=_0x581523(0xc5);break;}return console[_0x581523(0x102)]('üìä\x20AmPay\x20TRY\x20webhook\x20processed:\x20'+_0x4e80bb+_0x581523(0xea)+_0x4ab3d4),{'paymentId':_0x4e80bb,'status':_0x4ab3d4,'amount':_0x30f9ae[_0x581523(0xb3)],'currency':_0x30f9ae[_0x581523(0xce)]||_0x581523(0x17b)};}catch(_0xfec422){console[_0x581523(0x124)](_0x581523(0xbd),_0xfec422);throw _0xfec422;}}[a47_0x45b667(0x137)](_0x51b23d,_0x3015e0){const _0x3ebcfa=a47_0x45b667;return console['log'](_0x3ebcfa(0x10b)),!![];}}exports['AmPayTRYService']=AmPayTRYService;