'use strict';const a55_0x13553a=a55_0x3d4d;(function(_0x48f699,_0x4b6227){const _0x509e64=a55_0x3d4d,_0x3afca7=_0x48f699();while(!![]){try{const _0xf62a5b=parseInt(_0x509e64(0x192))/0x1*(parseInt(_0x509e64(0x189))/0x2)+parseInt(_0x509e64(0x1d7))/0x3+parseInt(_0x509e64(0x1b2))/0x4+parseInt(_0x509e64(0x17d))/0x5+-parseInt(_0x509e64(0x1fa))/0x6*(-parseInt(_0x509e64(0x143))/0x7)+-parseInt(_0x509e64(0x161))/0x8*(parseInt(_0x509e64(0x1c0))/0x9)+parseInt(_0x509e64(0x176))/0xa*(-parseInt(_0x509e64(0x1e3))/0xb);if(_0xf62a5b===_0x4b6227)break;else _0x3afca7['push'](_0x3afca7['shift']());}catch(_0x17de21){_0x3afca7['push'](_0x3afca7['shift']());}}}(a55_0x50c4,0x3b3a9));Object[a55_0x13553a(0x144)](exports,a55_0x13553a(0x180),{'value':!![]}),exports[a55_0x13553a(0x1b9)]=void 0x0;function a55_0x3d4d(_0x1ed11a,_0xe4daa0){_0x1ed11a=_0x1ed11a-0x134;const _0x50c457=a55_0x50c4();let _0x3d4db1=_0x50c457[_0x1ed11a];return _0x3d4db1;}const loggerService_1=require(a55_0x13553a(0x191));class AmPayTRYService{constructor(){const _0x3be13e=a55_0x13553a;this[_0x3be13e(0x1f7)]='TRAFFER',this[_0x3be13e(0x151)]=_0x3be13e(0x157),this[_0x3be13e(0x13e)]=_0x3be13e(0x1e8),this[_0x3be13e(0x1cf)]=_0x3be13e(0x1b4),console['log'](_0x3be13e(0x181));}[a55_0x13553a(0x18c)](_0x224fe8){const _0x4b2503=a55_0x13553a,_0xcd39ae={'AD':'AND','AL':'ALB','AT':'AUT','BA':_0x4b2503(0x177),'BE':_0x4b2503(0x1e5),'BG':_0x4b2503(0x190),'BY':_0x4b2503(0x17f),'CH':_0x4b2503(0x196),'CY':_0x4b2503(0x1a6),'CZ':'CZE','DE':'DEU','DK':_0x4b2503(0x14f),'EE':_0x4b2503(0x194),'ES':'ESP','FI':_0x4b2503(0x1aa),'FR':'FRA','GB':_0x4b2503(0x186),'GE':_0x4b2503(0x1e9),'GR':'GRC','HR':_0x4b2503(0x138),'HU':_0x4b2503(0x1bc),'IE':_0x4b2503(0x15d),'IS':_0x4b2503(0x17c),'IT':_0x4b2503(0x136),'LI':_0x4b2503(0x1cd),'LT':'LTU','LU':_0x4b2503(0x13b),'LV':_0x4b2503(0x15a),'MC':_0x4b2503(0x1ad),'MD':_0x4b2503(0x182),'ME':_0x4b2503(0x1d3),'MK':_0x4b2503(0x1a7),'MT':_0x4b2503(0x1a4),'NL':_0x4b2503(0x16e),'NO':'NOR','PL':'POL','PT':_0x4b2503(0x179),'RO':_0x4b2503(0x1c3),'RS':'SRB','RU':_0x4b2503(0x1ab),'SE':_0x4b2503(0x1a3),'SI':_0x4b2503(0x15e),'SK':_0x4b2503(0x1cc),'SM':'SMR','UA':_0x4b2503(0x1c2),'VA':'VAT','XK':'XKX','AM':'ARM','AZ':_0x4b2503(0x1a9),'KZ':_0x4b2503(0x1f2),'KG':'KGZ','TJ':_0x4b2503(0x1a2),'TM':_0x4b2503(0x1ce),'UZ':_0x4b2503(0x148),'US':_0x4b2503(0x15b),'CA':_0x4b2503(0x1d1),'AU':_0x4b2503(0x172),'JP':_0x4b2503(0x174),'CN':_0x4b2503(0x19f),'IN':_0x4b2503(0x1e0),'BR':_0x4b2503(0x170),'MX':_0x4b2503(0x1b5),'AR':'ARG','CL':_0x4b2503(0x173),'PE':'PER','CO':_0x4b2503(0x183),'VE':_0x4b2503(0x152),'EC':'ECU','BO':_0x4b2503(0x154),'PY':_0x4b2503(0x1fb),'UY':'URY','SR':'SUR','GY':_0x4b2503(0x1af),'FK':_0x4b2503(0x1ac),'ZA':_0x4b2503(0x1df),'EG':_0x4b2503(0x153),'NG':_0x4b2503(0x1ed),'KE':_0x4b2503(0x1d6),'GH':'GHA','TZ':_0x4b2503(0x1a8),'UG':_0x4b2503(0x19a),'ZW':_0x4b2503(0x1dd),'ZM':_0x4b2503(0x149),'MW':_0x4b2503(0x18f),'MZ':'MOZ','MG':'MDG','MU':'MUS','SC':'SYC','RE':_0x4b2503(0x1fd),'TR':_0x4b2503(0x13c),'IR':_0x4b2503(0x18b),'IQ':_0x4b2503(0x178),'SA':_0x4b2503(0x13d),'AE':'ARE','KW':_0x4b2503(0x146),'QA':'QAT','BH':_0x4b2503(0x164),'OM':_0x4b2503(0x187),'YE':_0x4b2503(0x163),'JO':_0x4b2503(0x17a),'LB':'LBN','SY':_0x4b2503(0x1f4),'IL':'ISR','PS':_0x4b2503(0x185),'KR':_0x4b2503(0x165),'KP':'PRK','TH':_0x4b2503(0x1ea),'VN':_0x4b2503(0x137),'MY':_0x4b2503(0x1e1),'SG':_0x4b2503(0x158),'ID':_0x4b2503(0x1e6),'PH':_0x4b2503(0x13a),'LA':_0x4b2503(0x188),'KH':_0x4b2503(0x168),'MM':_0x4b2503(0x1ba),'BD':'BGD','LK':'LKA','NP':_0x4b2503(0x1ca),'BT':_0x4b2503(0x1dc),'MV':_0x4b2503(0x1f5),'AF':_0x4b2503(0x159),'PK':_0x4b2503(0x18d),'MN':_0x4b2503(0x16a)},_0x4c7c1e=_0xcd39ae[_0x224fe8[_0x4b2503(0x204)]()];if(!_0x4c7c1e)return console[_0x4b2503(0x1da)](_0x4b2503(0x1b8)+_0x224fe8+',\x20using\x20TUR\x20as\x20fallback\x20for\x20AmPay\x20TRY'),_0x4b2503(0x13c);return _0x4c7c1e;}async[a55_0x13553a(0x1f3)](_0x2d59af){const _0x191e28=a55_0x13553a;console[_0x191e28(0x162)]('üöÄ\x20Creating\x20AmPay\x20TRY\x20payment\x20request:',{'paymentId':_0x2d59af[_0x191e28(0x19c)],'amount':_0x2d59af[_0x191e28(0x184)],'currency':_0x2d59af[_0x191e28(0x13f)],'customerCountry':_0x2d59af[_0x191e28(0x1f1)]});try{const _0x30017e={'client_merchant_id':this[_0x191e28(0x1f7)],'payment_method':_0x191e28(0x1ee),'client_transaction_id':_0x2d59af['orderId'],'amount':_0x2d59af[_0x191e28(0x184)],'currency':_0x2d59af[_0x191e28(0x13f)],'callback_url':_0x191e28(0x1de),'tracker_id':_0x2d59af[_0x191e28(0x19c)],'redirect_url':_0x2d59af[_0x191e28(0x200)],'failure_url':_0x2d59af[_0x191e28(0x1bf)],'customer_first_name':_0x2d59af['firstName'],'customer_last_name':_0x2d59af['lastName'],'customer_email':_0x2d59af[_0x191e28(0x142)],'customer_phone':_0x2d59af[_0x191e28(0x195)]||'','customer_ip':_0x2d59af[_0x191e28(0x140)],'customer_country':_0x2d59af[_0x191e28(0x1f1)],'api_public_key':this[_0x191e28(0x151)]};console['log']('üì§\x20AmPay\x20TRY\x20API\x20request\x20data:',JSON[_0x191e28(0x145)](_0x30017e,null,0x2));const _0x477aa6=await fetch(this[_0x191e28(0x1cf)],{'method':'POST','headers':{'Content-Type':_0x191e28(0x16c),'User-Agent':'TrapayEnd/1.0'},'body':JSON[_0x191e28(0x145)](_0x30017e)});console[_0x191e28(0x162)](_0x191e28(0x16d),_0x477aa6[_0x191e28(0x1e7)]);const _0x4dc3cc=await _0x477aa6['text']();console[_0x191e28(0x162)](_0x191e28(0x147),_0x4dc3cc);let _0x301598;try{_0x301598=JSON[_0x191e28(0x1ae)](_0x4dc3cc);}catch(_0x1158cf){console['error'](_0x191e28(0x1e4),_0x1158cf);throw new Error(_0x191e28(0x1fc)+_0x4dc3cc);}console[_0x191e28(0x162)]('üìä\x20AmPay\x20TRY\x20parsed\x20response:',JSON[_0x191e28(0x145)](_0x301598,null,0x2)),loggerService_1[_0x191e28(0x1ff)][_0x191e28(0x1c4)](_0x191e28(0x16f),_0x301598,{});if(!_0x477aa6['ok']){const _0x93aeb4=_0x301598[_0x191e28(0x19d)]||_0x301598[_0x191e28(0x19b)]||'HTTP\x20'+_0x477aa6[_0x191e28(0x1e7)];console['error']('‚ùå\x20AmPay\x20TRY\x20API\x20error:',_0x93aeb4);throw new Error(_0x191e28(0x1a5)+_0x93aeb4);}if(!_0x301598[_0x191e28(0x1d4)]){console[_0x191e28(0x198)](_0x191e28(0x166),_0x301598);throw new Error(_0x191e28(0x139));}const _0x47a29e={'gateway_payment_id':_0x301598[_0x191e28(0x171)]||_0x2d59af[_0x191e28(0x135)],'payment_url':_0x301598[_0x191e28(0x1d4)],'transaction_id':_0x301598[_0x191e28(0x1c1)]};return console[_0x191e28(0x162)](_0x191e28(0x1f6),_0x47a29e),_0x47a29e;}catch(_0x15dfcb){console[_0x191e28(0x198)](_0x191e28(0x1b6),_0x15dfcb),loggerService_1['loggerService'][_0x191e28(0x17b)](_0x191e28(0x16f),_0x15dfcb,_0x2d59af);throw _0x15dfcb;}}async[a55_0x13553a(0x1ec)](_0x37ace0){const _0x47738b=a55_0x13553a;try{const {orderId:_0x1901bd,amount:_0x177385,currency:_0x302758,firstName:_0x31fd4b,lastName:_0x457998,email:_0x29e6ca,phone:_0xf2f4ce,customerIp:_0x20e4b2,customerCountry:_0x213629,successUrl:_0x9b0868,failureUrl:_0xd086a}=_0x37ace0;console[_0x47738b(0x162)](_0x47738b(0x1d8)),console[_0x47738b(0x162)](_0x47738b(0x14b),_0x1901bd),console[_0x47738b(0x162)](_0x47738b(0x14a),_0x177385,_0x302758),console[_0x47738b(0x162)](_0x47738b(0x1bb),_0x31fd4b+'\x20'+_0x457998),console[_0x47738b(0x162)](_0x47738b(0x199),_0x29e6ca),console[_0x47738b(0x162)](_0x47738b(0x1cb),_0xf2f4ce||_0x47738b(0x14d)),console[_0x47738b(0x162)](_0x47738b(0x1f8),_0x20e4b2),console['log'](_0x47738b(0x1c7),_0x213629);const _0x2b25ec=this['convert2LetterTo3LetterCountryCode'](_0x213629);console[_0x47738b(0x162)](_0x47738b(0x134),_0x2b25ec);const _0x20d18e={'sub_method':_0x47738b(0x1d0),'currency':_0x302758['toUpperCase'](),'amount':_0x177385,'callback_url':'https://traffer.uk/gateway/ampay-try/webhook.php','client_merchant_id':this[_0x47738b(0x1f7)],'client_transaction_id':_0x1901bd,'transaction_description':_0x1901bd,'customer':{'ip':_0x20e4b2,'email':_0x29e6ca,'full_name':_0x31fd4b+'\x20'+_0x457998,'phone':_0xf2f4ce||'','country':_0x2b25ec},'success_redirect_url':_0x9b0868,'error_redirect_url':_0xd086a};console[_0x47738b(0x162)](_0x47738b(0x150),JSON[_0x47738b(0x145)](_0x20d18e,null,0x2));const _0x235b47=await fetch(this[_0x47738b(0x1cf)]+_0x47738b(0x1e2),{'method':_0x47738b(0x1ef),'headers':{'Content-Type':_0x47738b(0x16c),'User-Agent':_0x47738b(0x169)},'body':JSON[_0x47738b(0x145)](_0x20d18e)}),_0xc5c50f=await _0x235b47[_0x47738b(0x15c)]();console[_0x47738b(0x162)](_0x47738b(0x167),_0xc5c50f);if(!_0x235b47['ok'])throw new Error(_0x47738b(0x1f9)+_0x235b47['status']+_0x47738b(0x201)+_0xc5c50f);let _0x23d979;try{_0x23d979=JSON[_0x47738b(0x1ae)](_0xc5c50f);}catch(_0x3cfb32){throw new Error(_0x47738b(0x1fc)+_0xc5c50f);}console[_0x47738b(0x162)]('üìä\x20AmPay\x20TRY\x20response\x20data:',JSON[_0x47738b(0x145)](_0x23d979,null,0x2));if(!_0x23d979['redirect_url'])throw new Error(_0x47738b(0x1bd)+(_0x23d979['error_message']||_0x23d979[_0x47738b(0x19b)]||_0x47738b(0x1c5)));const _0x5e6c93=_0x23d979[_0x47738b(0x1d4)],_0x14a065=_0x23d979[_0x47738b(0x171)],_0x12aec3=_0x23d979[_0x47738b(0x17e)];return console['log'](_0x47738b(0x1a0)),console[_0x47738b(0x162)](_0x47738b(0x1fe),_0x5e6c93),console[_0x47738b(0x162)](_0x47738b(0x1f0),_0x14a065),console[_0x47738b(0x162)](_0x47738b(0x175),_0x12aec3),console[_0x47738b(0x162)](_0x47738b(0x1b3),_0x23d979['status']),console['log'](_0x47738b(0x1b7)),{'gateway_payment_id':_0x14a065||_0x12aec3||_0x1901bd,'payment_url':_0x5e6c93||'','transaction_id':_0x14a065};}catch(_0x2b0005){console[_0x47738b(0x198)](_0x47738b(0x1b6),_0x2b0005),console[_0x47738b(0x162)]('üìù\x20Logging\x20AmPay\x20TRY\x20payment\x20creation\x20failure...'),loggerService_1[_0x47738b(0x1ff)]['logWebhookError'](_0x47738b(0x16f),_0x2b0005,_0x37ace0);throw _0x2b0005;}}async[a55_0x13553a(0x1eb)](_0x2d7b4e){const _0x480a38=a55_0x13553a;console[_0x480a38(0x162)](_0x480a38(0x14e),_0x2d7b4e);try{const _0x1d0a45={'client_merchant_id':this[_0x480a38(0x1f7)],'system_id':_0x2d7b4e,'api_public_key':this['API_PUBLIC_KEY']},_0x27376e=await fetch(this[_0x480a38(0x1cf)]+_0x480a38(0x203),{'method':'POST','headers':{'Content-Type':_0x480a38(0x16c),'User-Agent':_0x480a38(0x1b1)},'body':JSON['stringify'](_0x1d0a45)}),_0x18a6a1=await _0x27376e[_0x480a38(0x15c)]();console[_0x480a38(0x162)](_0x480a38(0x197),_0x18a6a1);let _0x5bdef8;try{_0x5bdef8=JSON['parse'](_0x18a6a1);}catch(_0x155610){return console[_0x480a38(0x198)]('‚ùå\x20Failed\x20to\x20parse\x20AmPay\x20TRY\x20status\x20response:',_0x155610),{'status':'FAILED'};}console['log'](_0x480a38(0x15f),JSON['stringify'](_0x5bdef8,null,0x2));let _0x1a710d=_0x480a38(0x1db);if(_0x5bdef8[_0x480a38(0x1e7)])switch(_0x5bdef8['status'][_0x480a38(0x18a)]()){case _0x480a38(0x18e):case _0x480a38(0x1b0):case _0x480a38(0x19e):_0x1a710d='PAID';break;case _0x480a38(0x16b):case'error':case'declined':_0x1a710d=_0x480a38(0x1be);break;case _0x480a38(0x1c9):case _0x480a38(0x1d5):_0x1a710d=_0x480a38(0x1a1);break;case _0x480a38(0x1c8):case _0x480a38(0x14c):case _0x480a38(0x202):default:_0x1a710d=_0x480a38(0x1db);break;}return{'status':_0x1a710d,'amount':_0x5bdef8['amount'],'currency':_0x5bdef8['currency']};}catch(_0x61c89c){return console[_0x480a38(0x198)](_0x480a38(0x156),_0x61c89c),{'status':_0x480a38(0x1be)};}}async['processWebhook'](_0x29fb58){const _0x55bc94=a55_0x13553a;console[_0x55bc94(0x162)](_0x55bc94(0x1d2),JSON[_0x55bc94(0x145)](_0x29fb58,null,0x2));try{const _0x244249=_0x29fb58[_0x55bc94(0x17e)]||_0x29fb58['client_transaction_id']||_0x29fb58[_0x55bc94(0x171)];if(!_0x244249){console[_0x55bc94(0x198)](_0x55bc94(0x160));throw new Error(_0x55bc94(0x141));}let _0x56f5ec=_0x55bc94(0x1db);if(_0x29fb58['status'])switch(_0x29fb58['status'][_0x55bc94(0x18a)]()){case _0x55bc94(0x18e):case _0x55bc94(0x1b0):case'paid':_0x56f5ec='PAID';break;case _0x55bc94(0x16b):case _0x55bc94(0x198):case'declined':_0x56f5ec='FAILED';break;case _0x55bc94(0x1c9):case'timeout':_0x56f5ec=_0x55bc94(0x1a1);break;case _0x55bc94(0x1c8):case _0x55bc94(0x14c):case _0x55bc94(0x202):default:_0x56f5ec='PENDING';break;}return console[_0x55bc94(0x162)]('üìä\x20AmPay\x20TRY\x20webhook\x20processed:\x20'+_0x244249+_0x55bc94(0x1c6)+_0x56f5ec),{'paymentId':_0x244249,'status':_0x56f5ec,'amount':_0x29fb58[_0x55bc94(0x184)],'currency':_0x29fb58[_0x55bc94(0x13f)]||'TRY'};}catch(_0x2b78d4){console[_0x55bc94(0x198)](_0x55bc94(0x1d9),_0x2b78d4);throw _0x2b78d4;}}[a55_0x13553a(0x155)](_0x5cce70,_0x2f3e65){const _0x53b6cb=a55_0x13553a;return console['log'](_0x53b6cb(0x193)),!![];}}function a55_0x50c4(){const _0x5548c3=['LUX','TUR','SAU','API_PRIVATE_KEY','currency','customerIp','No\x20payment\x20ID\x20in\x20webhook\x20data','email','29778OSDnZw','defineProperty','stringify','KWT','üìù\x20AmPay\x20TRY\x20API\x20raw\x20response:','UZB','ZMB','Amount:','Order\x20ID:','processing','not\x20provided','üîç\x20Checking\x20AmPay\x20TRY\x20payment\x20status\x20for:','DNK','üì§\x20AmPay\x20TRY\x20request\x20body:','API_PUBLIC_KEY','VEN','EGY','BOL','verifyWebhookSignature','‚ùå\x20AmPay\x20TRY\x20status\x20check\x20failed:','58b59ccbc03dcdcfc20d830edfba765dbf9f3531c692533d84b17938e9c40bda','SGP','AFG','LVA','USA','text','IRL','SVN','üìä\x20AmPay\x20TRY\x20status\x20response:','‚ùå\x20No\x20payment\x20ID\x20found\x20in\x20AmPay\x20TRY\x20webhook\x20data','16wZhIVR','log','YEM','BHR','KOR','‚ùå\x20No\x20redirect_url\x20in\x20AmPay\x20TRY\x20response:','üì•\x20AmPay\x20TRY\x20raw\x20response:','KHM','TrapayAPI/1.0','MNG','failed','application/json','üì°\x20AmPay\x20TRY\x20API\x20response\x20status:','NLD','ampay-try','BRA','system_id','AUS','CHL','JPN','Tracker\x20ID:','40CXvqJu','BIH','IRQ','PRT','JOR','logWebhookError','ISL','760045NFtfHA','tracker_id','BLR','__esModule','üáπüá∑\x20AmPay\x20TRY\x20service\x20initialized\x20with\x20IBAN\x20Bank\x20Transfer\x20TR\x20processing','MDA','COL','amount','PSE','GBR','OMN','LAO','515814WuAWFC','toLowerCase','IRN','convert2LetterTo3LetterCountryCode','PAK','success','MWI','BGR','../loggerService','1uNfVsg','üîê\x20AmPay\x20TRY\x20webhook\x20signature\x20verification\x20not\x20implemented\x20yet','EST','phone','CHE','üìù\x20AmPay\x20TRY\x20status\x20raw\x20response:','error','Email:','UGA','message','paymentId','error_message','paid','CHN','‚úÖ\x20AmPay\x20TRY\x20payment\x20link\x20created\x20successfully','EXPIRED','TJK','SWE','MLT','AmPay\x20TRY\x20API\x20error:\x20','CYP','MKD','TZA','AZE','FIN','RUS','FLK','MCO','parse','GUY','completed','TrapayEnd/1.0','569932EGJVAj','Status:','https://traffer.uk/gateway/ampay-try/','MEX','‚ùå\x20AmPay\x20TRY\x20payment\x20creation\x20failed:','üìù\x20Logging\x20AmPay\x20TRY\x20payment\x20creation\x20event...','‚ö†Ô∏è\x20Unknown\x20country\x20code:\x20','AmPayTRYService','MMR','Customer:','HUN','AmPay\x20TRY\x20payment\x20creation\x20failed:\x20','FAILED','failureUrl','117594PDyakk','client_transaction_id','UKR','ROU','logWebhookReceived','Unknown\x20error','\x20->\x20','Customer\x20Country\x20(2-letter):','pending','expired','NPL','Phone:','SVK','LIE','TKM','apiUrl','GAM','CAN','üì•\x20Processing\x20AmPay\x20TRY\x20webhook:','MNE','redirect_url','timeout','KEN','642054LwrTLS','üáπüá∑\x20Creating\x20AmPay\x20TRY\x20payment\x20link...','‚ùå\x20AmPay\x20TRY\x20webhook\x20processing\x20failed:','warn','PENDING','BTN','ZWE','https://traffer.uk/gateway/ampay-try/webhook.php','ZAF','IND','MYS','ampay.php','1649395CdfkLp','‚ùå\x20Failed\x20to\x20parse\x20AmPay\x20TRY\x20API\x20response:','BEL','IDN','status','a5a059aa63392e571341bddc5148a5db66643722e9a6bf16a9395fb690a80288931d5a1180a85a28eb9f6516cf61dfc1bf4e37898f3a35261cd2db88888d3815','GEO','THA','checkPaymentStatus','createPaymentLink','NGA','Bank\x20Transfer\x20TR','POST','System\x20ID:','customerCountry','KAZ','createPayment','SYR','MDV','‚úÖ\x20AmPay\x20TRY\x20payment\x20created\x20successfully:','CLIENT_MERCHANT_ID','Customer\x20IP:','AmPay\x20TRY\x20API\x20error:\x20HTTP\x20','144Apmzmt','PRY','Invalid\x20JSON\x20response\x20from\x20AmPay\x20TRY:\x20','REU','Payment\x20URL:','loggerService','successUrl','\x20-\x20','waiting','/status','toUpperCase','Customer\x20Country\x20(3-letter):','orderId','ITA','VNM','HRV','AmPay\x20TRY\x20did\x20not\x20return\x20a\x20payment\x20URL','PHL'];a55_0x50c4=function(){return _0x5548c3;};return a55_0x50c4();}exports[a55_0x13553a(0x1b9)]=AmPayTRYService;