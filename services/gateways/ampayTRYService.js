'use strict';const a47_0x38f82e=a47_0x8586;(function(_0x430414,_0x58eb39){const _0x3d7e54=a47_0x8586,_0x258521=_0x430414();while(!![]){try{const _0x2e7fea=parseInt(_0x3d7e54(0x1dc))/0x1+parseInt(_0x3d7e54(0x1e6))/0x2+-parseInt(_0x3d7e54(0x1da))/0x3*(parseInt(_0x3d7e54(0x181))/0x4)+parseInt(_0x3d7e54(0x1a3))/0x5+parseInt(_0x3d7e54(0x17b))/0x6*(parseInt(_0x3d7e54(0x17c))/0x7)+parseInt(_0x3d7e54(0x166))/0x8*(-parseInt(_0x3d7e54(0x1ab))/0x9)+parseInt(_0x3d7e54(0x17a))/0xa*(-parseInt(_0x3d7e54(0x14b))/0xb);if(_0x2e7fea===_0x58eb39)break;else _0x258521['push'](_0x258521['shift']());}catch(_0x2df3ae){_0x258521['push'](_0x258521['shift']());}}}(a47_0x319b,0xb6db1));function a47_0x8586(_0x57437a,_0x5d6d04){const _0x319bfe=a47_0x319b();return a47_0x8586=function(_0x858685,_0x323663){_0x858685=_0x858685-0x130;let _0x44f2e9=_0x319bfe[_0x858685];return _0x44f2e9;},a47_0x8586(_0x57437a,_0x5d6d04);}Object[a47_0x38f82e(0x1f0)](exports,a47_0x38f82e(0x1a6),{'value':!![]}),exports[a47_0x38f82e(0x13c)]=void 0x0;const loggerService_1=require(a47_0x38f82e(0x195));class AmPayTRYService{constructor(){const _0x64d4e2=a47_0x38f82e;this[_0x64d4e2(0x171)]=_0x64d4e2(0x175),this[_0x64d4e2(0x1b0)]='58b59ccbc03dcdcfc20d830edfba765dbf9f3531c692533d84b17938e9c40bda',this[_0x64d4e2(0x19c)]=_0x64d4e2(0x1bb),this[_0x64d4e2(0x16a)]=_0x64d4e2(0x183),console[_0x64d4e2(0x189)]('üáπüá∑\x20AmPay\x20TRY\x20service\x20initialized\x20with\x20IBAN\x20Bank\x20Transfer\x20TR\x20processing');}[a47_0x38f82e(0x1a4)](_0x36870d){const _0x387983=a47_0x38f82e,_0x387652={'AD':_0x387983(0x169),'AL':_0x387983(0x1bf),'AT':_0x387983(0x1b4),'BA':_0x387983(0x167),'BE':_0x387983(0x1c4),'BG':_0x387983(0x18b),'BY':_0x387983(0x177),'CH':_0x387983(0x1c3),'CY':_0x387983(0x168),'CZ':_0x387983(0x150),'DE':_0x387983(0x1b9),'DK':_0x387983(0x145),'EE':_0x387983(0x193),'ES':_0x387983(0x1e7),'FI':'FIN','FR':_0x387983(0x1e9),'GB':_0x387983(0x17f),'GE':'GEO','GR':'GRC','HR':'HRV','HU':_0x387983(0x141),'IE':'IRL','IS':_0x387983(0x19f),'IT':_0x387983(0x172),'LI':_0x387983(0x1dd),'LT':'LTU','LU':'LUX','LV':_0x387983(0x143),'MC':'MCO','MD':'MDA','ME':_0x387983(0x157),'MK':_0x387983(0x1cf),'MT':_0x387983(0x1a5),'NL':'NLD','NO':_0x387983(0x14a),'PL':_0x387983(0x152),'PT':_0x387983(0x131),'RO':_0x387983(0x1f1),'RS':_0x387983(0x176),'RU':'RUS','SE':_0x387983(0x153),'SI':'SVN','SK':_0x387983(0x18d),'SM':_0x387983(0x1b1),'UA':_0x387983(0x19a),'VA':_0x387983(0x179),'XK':_0x387983(0x196),'AM':'ARM','AZ':'AZE','KZ':_0x387983(0x1cb),'KG':'KGZ','TJ':_0x387983(0x199),'TM':_0x387983(0x18e),'UZ':_0x387983(0x162),'US':_0x387983(0x1d3),'CA':_0x387983(0x191),'AU':_0x387983(0x1bc),'JP':_0x387983(0x146),'CN':_0x387983(0x14c),'IN':_0x387983(0x154),'BR':'BRA','MX':_0x387983(0x1e0),'AR':'ARG','CL':_0x387983(0x187),'PE':_0x387983(0x184),'CO':_0x387983(0x1ec),'VE':_0x387983(0x1ce),'EC':'ECU','BO':_0x387983(0x1aa),'PY':_0x387983(0x1e1),'UY':_0x387983(0x132),'SR':_0x387983(0x161),'GY':_0x387983(0x1a7),'FK':_0x387983(0x142),'ZA':_0x387983(0x15b),'EG':'EGY','NG':_0x387983(0x1c7),'KE':_0x387983(0x14f),'GH':_0x387983(0x188),'TZ':_0x387983(0x1d9),'UG':_0x387983(0x1ee),'ZW':_0x387983(0x13f),'ZM':'ZMB','MW':_0x387983(0x137),'MZ':_0x387983(0x1d1),'MG':'MDG','MU':'MUS','SC':_0x387983(0x144),'RE':_0x387983(0x194),'TR':'TUR','IR':_0x387983(0x1f9),'IQ':_0x387983(0x19e),'SA':_0x387983(0x15a),'AE':_0x387983(0x1d8),'KW':_0x387983(0x1ad),'QA':_0x387983(0x1de),'BH':_0x387983(0x1fb),'OM':_0x387983(0x1ea),'YE':_0x387983(0x151),'JO':'JOR','LB':_0x387983(0x16e),'SY':_0x387983(0x1d7),'IL':'ISR','PS':'PSE','KR':_0x387983(0x1f3),'KP':_0x387983(0x17e),'TH':_0x387983(0x1ca),'VN':_0x387983(0x1ed),'MY':_0x387983(0x15c),'SG':_0x387983(0x1b6),'ID':'IDN','PH':_0x387983(0x16d),'LA':_0x387983(0x155),'KH':_0x387983(0x198),'MM':_0x387983(0x1fa),'BD':_0x387983(0x1a0),'LK':_0x387983(0x13d),'NP':'NPL','BT':_0x387983(0x182),'MV':'MDV','AF':'AFG','PK':_0x387983(0x19d),'MN':_0x387983(0x1af)},_0x3b548=_0x387652[_0x36870d[_0x387983(0x1b2)]()];if(!_0x3b548)return console[_0x387983(0x1fe)](_0x387983(0x18f)+_0x36870d+_0x387983(0x14d)),'TUR';return _0x3b548;}async['createPayment'](_0x225a93){const _0x33b991=a47_0x38f82e;console[_0x33b991(0x189)](_0x33b991(0x160),{'paymentId':_0x225a93[_0x33b991(0x1f8)],'amount':_0x225a93[_0x33b991(0x18c)],'currency':_0x225a93[_0x33b991(0x192)],'customerCountry':_0x225a93[_0x33b991(0x1be)]});try{const _0x56d4e0={'client_merchant_id':this[_0x33b991(0x171)],'payment_method':_0x33b991(0x130),'client_transaction_id':_0x225a93['orderId'],'amount':_0x225a93[_0x33b991(0x18c)],'currency':_0x225a93['currency'],'callback_url':_0x33b991(0x1d0),'tracker_id':_0x225a93[_0x33b991(0x1f8)],'redirect_url':_0x225a93[_0x33b991(0x1f5)],'failure_url':_0x225a93[_0x33b991(0x164)],'customer_first_name':_0x225a93[_0x33b991(0x1df)],'customer_last_name':_0x225a93[_0x33b991(0x148)],'customer_email':_0x225a93[_0x33b991(0x1ac)],'customer_phone':_0x225a93['phone']||'','customer_ip':_0x225a93[_0x33b991(0x147)],'customer_country':_0x225a93['customerCountry'],'api_public_key':this[_0x33b991(0x1b0)]};console[_0x33b991(0x189)](_0x33b991(0x15f),JSON['stringify'](_0x56d4e0,null,0x2));const _0x5ccdcf=await fetch(this['apiUrl'],{'method':_0x33b991(0x136),'headers':{'Content-Type':_0x33b991(0x178),'User-Agent':_0x33b991(0x163)},'body':JSON['stringify'](_0x56d4e0)});console[_0x33b991(0x189)](_0x33b991(0x138),_0x5ccdcf['status']);const _0x2480b7=await _0x5ccdcf['text']();console[_0x33b991(0x189)](_0x33b991(0x13b),_0x2480b7);let _0x480aca;try{_0x480aca=JSON['parse'](_0x2480b7);}catch(_0x33b378){console[_0x33b991(0x1e3)]('‚ùå\x20Failed\x20to\x20parse\x20AmPay\x20TRY\x20API\x20response:',_0x33b378);throw new Error(_0x33b991(0x1b8)+_0x2480b7);}console[_0x33b991(0x189)](_0x33b991(0x1fd),JSON[_0x33b991(0x1e5)](_0x480aca,null,0x2)),loggerService_1[_0x33b991(0x1f6)][_0x33b991(0x1c2)](_0x33b991(0x174),_0x480aca,{});if(!_0x5ccdcf['ok']){const _0x29db36=_0x480aca[_0x33b991(0x1c1)]||_0x480aca[_0x33b991(0x1c0)]||_0x33b991(0x15e)+_0x5ccdcf[_0x33b991(0x170)];console[_0x33b991(0x1e3)](_0x33b991(0x1b5),_0x29db36);throw new Error('AmPay\x20TRY\x20API\x20error:\x20'+_0x29db36);}if(!_0x480aca[_0x33b991(0x16c)]){console['error'](_0x33b991(0x1c5),_0x480aca);throw new Error(_0x33b991(0x15d));}const _0xbc9c57={'gateway_payment_id':_0x480aca[_0x33b991(0x149)]||_0x225a93['orderId'],'payment_url':_0x480aca[_0x33b991(0x16c)],'transaction_id':_0x480aca[_0x33b991(0x14e)]};return console[_0x33b991(0x189)](_0x33b991(0x1a9),_0xbc9c57),_0xbc9c57;}catch(_0xa0034e){console[_0x33b991(0x1e3)]('‚ùå\x20AmPay\x20TRY\x20payment\x20creation\x20failed:',_0xa0034e),loggerService_1[_0x33b991(0x1f6)][_0x33b991(0x1f7)](_0x33b991(0x174),_0xa0034e,_0x225a93);throw _0xa0034e;}}async[a47_0x38f82e(0x1b7)](_0x5f1d1d){const _0x140d5a=a47_0x38f82e;try{const {orderId:_0x16ab7e,amount:_0x45d0c4,currency:_0x27d5a4,firstName:_0x51fb97,lastName:_0x5a80d7,email:_0x2cd87b,phone:_0x1fea5f,customerIp:_0x14e958,customerCountry:_0x45913d,successUrl:_0x124d82,failureUrl:_0xd6c63f}=_0x5f1d1d;console[_0x140d5a(0x189)](_0x140d5a(0x1ef)),console['log']('Order\x20ID:',_0x16ab7e),console[_0x140d5a(0x189)]('Amount:',_0x45d0c4,_0x27d5a4),console[_0x140d5a(0x189)](_0x140d5a(0x1f4),_0x51fb97+'\x20'+_0x5a80d7),console[_0x140d5a(0x189)]('Email:',_0x2cd87b),console[_0x140d5a(0x189)]('Phone:',_0x1fea5f||_0x140d5a(0x1bd)),console['log']('Customer\x20IP:',_0x14e958),console[_0x140d5a(0x189)](_0x140d5a(0x197),_0x45913d);const _0x35ee12=this[_0x140d5a(0x1a4)](_0x45913d);console['log'](_0x140d5a(0x1d5),_0x35ee12);const _0x81a1b9={'sub_method':'GAM','currency':_0x27d5a4[_0x140d5a(0x1b2)](),'amount':_0x45d0c4,'callback_url':'https://traffer.uk/gateway/ampay-try/webhook.php','client_merchant_id':this[_0x140d5a(0x171)],'client_transaction_id':_0x16ab7e,'transaction_description':_0x16ab7e,'customer':{'ip':_0x14e958,'email':_0x2cd87b,'full_name':_0x51fb97+'\x20'+_0x5a80d7,'phone':_0x1fea5f||'','country':_0x35ee12},'success_redirect_url':_0x124d82,'error_redirect_url':_0xd6c63f};console[_0x140d5a(0x189)](_0x140d5a(0x1cd),JSON[_0x140d5a(0x1e5)](_0x81a1b9,null,0x2));const _0x4927c7=await fetch(this['apiUrl']+_0x140d5a(0x135),{'method':_0x140d5a(0x136),'headers':{'Content-Type':_0x140d5a(0x178),'User-Agent':'TrapayAPI/1.0'},'body':JSON[_0x140d5a(0x1e5)](_0x81a1b9)}),_0x38abc6=await _0x4927c7['text']();console[_0x140d5a(0x189)](_0x140d5a(0x1e2),_0x38abc6);if(!_0x4927c7['ok'])throw new Error(_0x140d5a(0x186)+_0x4927c7[_0x140d5a(0x170)]+_0x140d5a(0x1a8)+_0x38abc6);let _0x537d84;try{_0x537d84=JSON[_0x140d5a(0x16b)](_0x38abc6);}catch(_0x7a4e69){throw new Error(_0x140d5a(0x1b8)+_0x38abc6);}console[_0x140d5a(0x189)](_0x140d5a(0x133),JSON['stringify'](_0x537d84,null,0x2));if(!_0x537d84[_0x140d5a(0x16c)])throw new Error(_0x140d5a(0x1b3)+(_0x537d84['error_message']||_0x537d84[_0x140d5a(0x1c0)]||_0x140d5a(0x1a2)));const _0xa8625a=_0x537d84[_0x140d5a(0x16c)],_0x4a5fc0=_0x537d84['system_id'],_0x1dc8b6=_0x537d84[_0x140d5a(0x180)];return console[_0x140d5a(0x189)](_0x140d5a(0x165)),console[_0x140d5a(0x189)](_0x140d5a(0x1e8),_0xa8625a),console['log']('System\x20ID:',_0x4a5fc0),console[_0x140d5a(0x189)]('Tracker\x20ID:',_0x1dc8b6),console[_0x140d5a(0x189)]('Status:',_0x537d84['status']),console[_0x140d5a(0x189)](_0x140d5a(0x13a)),{'gateway_payment_id':_0x4a5fc0||_0x1dc8b6||_0x16ab7e,'payment_url':_0xa8625a||'','transaction_id':_0x4a5fc0};}catch(_0x2bfa47){console['error'](_0x140d5a(0x1fc),_0x2bfa47),console[_0x140d5a(0x189)](_0x140d5a(0x1d4)),loggerService_1[_0x140d5a(0x1f6)][_0x140d5a(0x1f7)](_0x140d5a(0x174),_0x2bfa47,_0x5f1d1d);throw _0x2bfa47;}}async[a47_0x38f82e(0x17d)](_0x2d32c3){const _0x320e2a=a47_0x38f82e;console[_0x320e2a(0x189)]('üîç\x20Checking\x20AmPay\x20TRY\x20payment\x20status\x20for:',_0x2d32c3);try{const _0x20f658={'client_merchant_id':this['CLIENT_MERCHANT_ID'],'system_id':_0x2d32c3,'api_public_key':this[_0x320e2a(0x1b0)]},_0xe1136c=await fetch(this[_0x320e2a(0x16a)]+_0x320e2a(0x134),{'method':_0x320e2a(0x136),'headers':{'Content-Type':_0x320e2a(0x178),'User-Agent':_0x320e2a(0x163)},'body':JSON[_0x320e2a(0x1e5)](_0x20f658)}),_0x188235=await _0xe1136c[_0x320e2a(0x140)]();console[_0x320e2a(0x189)](_0x320e2a(0x1f2),_0x188235);let _0x5038ef;try{_0x5038ef=JSON[_0x320e2a(0x16b)](_0x188235);}catch(_0x32bd8d){return console['error'](_0x320e2a(0x16f),_0x32bd8d),{'status':_0x320e2a(0x18a)};}console[_0x320e2a(0x189)](_0x320e2a(0x1d6),JSON[_0x320e2a(0x1e5)](_0x5038ef,null,0x2));let _0x552c5f=_0x320e2a(0x1db);if(_0x5038ef[_0x320e2a(0x170)])switch(_0x5038ef[_0x320e2a(0x170)][_0x320e2a(0x1a1)]()){case _0x320e2a(0x1eb):case'completed':case'paid':_0x552c5f=_0x320e2a(0x158);break;case _0x320e2a(0x1c9):case _0x320e2a(0x1e3):case _0x320e2a(0x159):_0x552c5f=_0x320e2a(0x18a);break;case _0x320e2a(0x185):case'timeout':_0x552c5f=_0x320e2a(0x1ba);break;case _0x320e2a(0x1c6):case'processing':case'waiting':default:_0x552c5f=_0x320e2a(0x1db);break;}return{'status':_0x552c5f,'amount':_0x5038ef[_0x320e2a(0x18c)],'currency':_0x5038ef['currency']};}catch(_0x3cf448){return console['error'](_0x320e2a(0x190),_0x3cf448),{'status':_0x320e2a(0x18a)};}}async[a47_0x38f82e(0x1e4)](_0x37c646){const _0x2baa06=a47_0x38f82e;console[_0x2baa06(0x189)]('üì•\x20Processing\x20AmPay\x20TRY\x20webhook:',JSON['stringify'](_0x37c646,null,0x2));try{const _0x4a9406=_0x37c646[_0x2baa06(0x180)]||_0x37c646['client_transaction_id']||_0x37c646[_0x2baa06(0x149)];if(!_0x4a9406){console['error'](_0x2baa06(0x19b));throw new Error(_0x2baa06(0x1ae));}let _0x229929=_0x2baa06(0x1db);if(_0x37c646[_0x2baa06(0x170)])switch(_0x37c646[_0x2baa06(0x170)][_0x2baa06(0x1a1)]()){case _0x2baa06(0x1eb):case _0x2baa06(0x156):case _0x2baa06(0x139):_0x229929=_0x2baa06(0x158);break;case _0x2baa06(0x1c9):case _0x2baa06(0x1e3):case _0x2baa06(0x159):_0x229929=_0x2baa06(0x18a);break;case _0x2baa06(0x185):case _0x2baa06(0x1cc):_0x229929='EXPIRED';break;case _0x2baa06(0x1c6):case _0x2baa06(0x1c8):case _0x2baa06(0x1d2):default:_0x229929='PENDING';break;}return console[_0x2baa06(0x189)]('üìä\x20AmPay\x20TRY\x20webhook\x20processed:\x20'+_0x4a9406+'\x20->\x20'+_0x229929),{'paymentId':_0x4a9406,'status':_0x229929,'amount':_0x37c646[_0x2baa06(0x18c)],'currency':_0x37c646[_0x2baa06(0x192)]||_0x2baa06(0x173)};}catch(_0x44b57d){console[_0x2baa06(0x1e3)]('‚ùå\x20AmPay\x20TRY\x20webhook\x20processing\x20failed:',_0x44b57d);throw _0x44b57d;}}['verifyWebhookSignature'](_0x1fca80,_0x400e16){const _0x42de58=a47_0x38f82e;return console[_0x42de58(0x189)](_0x42de58(0x13e)),!![];}}exports[a47_0x38f82e(0x13c)]=AmPayTRYService;function a47_0x319b(){const _0x27c4ad=['expired','AmPay\x20TRY\x20API\x20error:\x20HTTP\x20','CHL','GHA','log','FAILED','BGR','amount','SVK','TKM','‚ö†Ô∏è\x20Unknown\x20country\x20code:\x20','‚ùå\x20AmPay\x20TRY\x20status\x20check\x20failed:','CAN','currency','EST','REU','../loggerService','XKX','Customer\x20Country\x20(2-letter):','KHM','TJK','UKR','‚ùå\x20No\x20payment\x20ID\x20found\x20in\x20AmPay\x20TRY\x20webhook\x20data','API_PRIVATE_KEY','PAK','IRQ','ISL','BGD','toLowerCase','Unknown\x20error','6016830mhwPzv','convert2LetterTo3LetterCountryCode','MLT','__esModule','GUY','\x20-\x20','‚úÖ\x20AmPay\x20TRY\x20payment\x20created\x20successfully:','BOL','27gyycFS','email','KWT','No\x20payment\x20ID\x20in\x20webhook\x20data','MNG','API_PUBLIC_KEY','SMR','toUpperCase','AmPay\x20TRY\x20payment\x20creation\x20failed:\x20','AUT','‚ùå\x20AmPay\x20TRY\x20API\x20error:','SGP','createPaymentLink','Invalid\x20JSON\x20response\x20from\x20AmPay\x20TRY:\x20','DEU','EXPIRED','a5a059aa63392e571341bddc5148a5db66643722e9a6bf16a9395fb690a80288931d5a1180a85a28eb9f6516cf61dfc1bf4e37898f3a35261cd2db88888d3815','AUS','not\x20provided','customerCountry','ALB','message','error_message','logWebhookReceived','CHE','BEL','‚ùå\x20No\x20redirect_url\x20in\x20AmPay\x20TRY\x20response:','pending','NGA','processing','failed','THA','KAZ','timeout','üì§\x20AmPay\x20TRY\x20request\x20body:','VEN','MKD','https://traffer.uk/gateway/ampay-try/webhook.php','MOZ','waiting','USA','üìù\x20Logging\x20AmPay\x20TRY\x20payment\x20creation\x20failure...','Customer\x20Country\x20(3-letter):','üìä\x20AmPay\x20TRY\x20status\x20response:','SYR','ARE','TZA','696567qYtAAR','PENDING','573115pSivyz','LIE','QAT','firstName','MEX','PRY','üì•\x20AmPay\x20TRY\x20raw\x20response:','error','processWebhook','stringify','2144894YVUsWh','ESP','Payment\x20URL:','FRA','OMN','success','COL','VNM','UGA','üáπüá∑\x20Creating\x20AmPay\x20TRY\x20payment\x20link...','defineProperty','ROU','üìù\x20AmPay\x20TRY\x20status\x20raw\x20response:','KOR','Customer:','successUrl','loggerService','logWebhookError','paymentId','IRN','MMR','BHR','‚ùå\x20AmPay\x20TRY\x20payment\x20creation\x20failed:','üìä\x20AmPay\x20TRY\x20parsed\x20response:','warn','Bank\x20Transfer\x20TR','PRT','URY','üìä\x20AmPay\x20TRY\x20response\x20data:','/status','ampay.php','POST','MWI','üì°\x20AmPay\x20TRY\x20API\x20response\x20status:','paid','üìù\x20Logging\x20AmPay\x20TRY\x20payment\x20creation\x20event...','üìù\x20AmPay\x20TRY\x20API\x20raw\x20response:','AmPayTRYService','LKA','üîê\x20AmPay\x20TRY\x20webhook\x20signature\x20verification\x20not\x20implemented\x20yet','ZWE','text','HUN','FLK','LVA','SYC','DNK','JPN','customerIp','lastName','system_id','NOR','11bHvEQD','CHN',',\x20using\x20TUR\x20as\x20fallback\x20for\x20AmPay\x20TRY','client_transaction_id','KEN','CZE','YEM','POL','SWE','IND','LAO','completed','MNE','PAID','declined','SAU','ZAF','MYS','AmPay\x20TRY\x20did\x20not\x20return\x20a\x20payment\x20URL','HTTP\x20','üì§\x20AmPay\x20TRY\x20API\x20request\x20data:','üöÄ\x20Creating\x20AmPay\x20TRY\x20payment\x20request:','SUR','UZB','TrapayEnd/1.0','failureUrl','‚úÖ\x20AmPay\x20TRY\x20payment\x20link\x20created\x20successfully','228568bNzflE','BIH','CYP','AND','apiUrl','parse','redirect_url','PHL','LBN','‚ùå\x20Failed\x20to\x20parse\x20AmPay\x20TRY\x20status\x20response:','status','CLIENT_MERCHANT_ID','ITA','TRY','ampay-try','TRAFFER','SRB','BLR','application/json','VAT','14349110VrASqw','17586pAForb','280txJgGQ','checkPaymentStatus','PRK','GBR','tracker_id','12EcqmKd','BTN','https://traffer.uk/gateway/ampay-try/','PER'];a47_0x319b=function(){return _0x27c4ad;};return a47_0x319b();}