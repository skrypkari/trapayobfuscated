'use strict';const a63_0x437a39=a63_0x3788;(function(_0x48d986,_0x194048){const _0x411051=a63_0x3788,_0x5e849c=_0x48d986();while(!![]){try{const _0x132251=-parseInt(_0x411051(0x135))/0x1*(-parseInt(_0x411051(0x157))/0x2)+-parseInt(_0x411051(0x137))/0x3+parseInt(_0x411051(0x1d4))/0x4+-parseInt(_0x411051(0x186))/0x5*(-parseInt(_0x411051(0x14d))/0x6)+parseInt(_0x411051(0x1e3))/0x7+parseInt(_0x411051(0x17f))/0x8+-parseInt(_0x411051(0x1b7))/0x9;if(_0x132251===_0x194048)break;else _0x5e849c['push'](_0x5e849c['shift']());}catch(_0x68e1e2){_0x5e849c['push'](_0x5e849c['shift']());}}}(a63_0x1b9e,0x849ac));function a63_0x1b9e(){const _0x4b2860=['status','MKD','MYS','KAZ','redirect_url','MMR','Payment\x20URL:','timeout','KOR','UGA','YEM','tracker_id','58b59ccbc03dcdcfc20d830edfba765dbf9f3531c692533d84b17938e9c40bda','PER','logWebhookError','NGA','checkPaymentStatus','BGR','GBR','LUX','https://traffer.uk/gateway/ampay-try/webhook.php','/status','AZE','toLowerCase','Customer\x20Country\x20(2-letter):','BGD','GRC','BEL','Amount:','13313727Smztpc','completed','‚ö†Ô∏è\x20Unknown\x20country\x20code:\x20','NOR','CLIENT_MERCHANT_ID','OMN','Invalid\x20JSON\x20response\x20from\x20AmPay\x20TRY:\x20','successUrl','üì§\x20AmPay\x20TRY\x20request\x20body:','CHE','BIH','logWebhookReceived','üìä\x20AmPay\x20TRY\x20status\x20response:','error_message','PSE','LBN','lastName','a5a059aa63392e571341bddc5148a5db66643722e9a6bf16a9395fb690a80288931d5a1180a85a28eb9f6516cf61dfc1bf4e37898f3a35261cd2db88888d3815','üìù\x20AmPay\x20TRY\x20status\x20raw\x20response:','apiUrl','ampay-try','Tracker\x20ID:','‚ùå\x20AmPay\x20TRY\x20status\x20check\x20failed:','‚ùå\x20AmPay\x20TRY\x20API\x20error:','BRA',',\x20using\x20TUR\x20as\x20fallback\x20for\x20AmPay\x20TRY','SYR','PHL','defineProperty','1435532JAtNrX','ALB','processWebhook','üáπüá∑\x20AmPay\x20TRY\x20service\x20initialized\x20with\x20IBAN\x20Bank\x20Transfer\x20TR\x20processing','AmPay\x20TRY\x20did\x20not\x20return\x20a\x20payment\x20URL','AmPayTRYService','BTN','MNG','application/json','LAO','processing','customerCountry','üì°\x20AmPay\x20TRY\x20API\x20response\x20status:','UKR','PAID','5557804xrwJkI','paymentId','\x20-\x20','ROU','createPayment','SWE','USA','AmPay\x20TRY\x20payment\x20creation\x20failed:\x20','email','orderId','message','IRN','log','failureUrl','AUS','SGP','declined','‚ùå\x20Failed\x20to\x20parse\x20AmPay\x20TRY\x20API\x20response:','LIE','System\x20ID:','SRB','PRT','AND','RUS','POST','ARG','CHL','HTTP\x20','NLD','TJK','EGY','AmPay\x20TRY\x20API\x20error:\x20HTTP\x20','success','XKX','BLR','78742frzhBQ','üìä\x20AmPay\x20TRY\x20parsed\x20response:','3044046sWTbdS','TrapayAPI/1.0','‚ùå\x20No\x20redirect_url\x20in\x20AmPay\x20TRY\x20response:','EXPIRED','API_PUBLIC_KEY','FLK','IRQ','IND','PENDING','LTU','Customer\x20IP:','POL','GEO','pending','TRY','CHN','PRK','loggerService','not\x20provided','SYC','convert2LetterTo3LetterCountryCode','failed','18usdlzS','JOR','PRY','FAILED','customerIp','Phone:','BOL','KGZ','EST','üìù\x20AmPay\x20TRY\x20API\x20raw\x20response:','16TkULJp','VAT','AmPay\x20TRY\x20API\x20error:\x20','IRL','ARE','AUT','MUS','JPN','https://traffer.uk/gateway/ampay-try/','QAT','‚ùå\x20AmPay\x20TRY\x20payment\x20creation\x20failed:','‚ùå\x20Failed\x20to\x20parse\x20AmPay\x20TRY\x20status\x20response:','currency','../loggerService','UZB','amount','phone','__esModule','LVA','Status:','HRV','MEX','ITA','No\x20payment\x20ID\x20in\x20webhook\x20data','MDV','TRAFFER','Unknown\x20error','error','SUR','system_id','\x20->\x20','SVN','BHR','ISL','‚úÖ\x20AmPay\x20TRY\x20payment\x20created\x20successfully:','FRA','MLT','waiting','toUpperCase','createPaymentLink','2997480SVuNtm','verifyWebhookSignature','expired','SMR','VEN','stringify','parse','1466095vMvcZC','GHA','THA','TKM','paid','DNK','üì•\x20AmPay\x20TRY\x20raw\x20response:','üì§\x20AmPay\x20TRY\x20API\x20request\x20data:','TrapayEnd/1.0','TUR','SAU','üìä\x20AmPay\x20TRY\x20response\x20data:','CZE','NPL','üöÄ\x20Creating\x20AmPay\x20TRY\x20payment\x20request:','SVK','VNM','HUN','text','GAM'];a63_0x1b9e=function(){return _0x4b2860;};return a63_0x1b9e();}Object[a63_0x437a39(0x1d3)](exports,a63_0x437a39(0x168),{'value':!![]}),exports[a63_0x437a39(0x1d9)]=void 0x0;function a63_0x3788(_0x521919,_0x131799){_0x521919=_0x521919-0x118;const _0x1b9ed5=a63_0x1b9e();let _0x37889=_0x1b9ed5[_0x521919];return _0x37889;}const loggerService_1=require(a63_0x437a39(0x164));class AmPayTRYService{constructor(){const _0x5e184f=a63_0x437a39;this[_0x5e184f(0x1bb)]=_0x5e184f(0x170),this[_0x5e184f(0x13b)]=_0x5e184f(0x1a6),this['API_PRIVATE_KEY']=_0x5e184f(0x1c8),this[_0x5e184f(0x1ca)]=_0x5e184f(0x15f),console[_0x5e184f(0x11e)](_0x5e184f(0x1d7));}[a63_0x437a39(0x14b)](_0x44b748){const _0x431a10=a63_0x437a39,_0x5d885a={'AD':_0x431a10(0x128),'AL':_0x431a10(0x1d5),'AT':_0x431a10(0x15c),'BA':_0x431a10(0x1c1),'BE':_0x431a10(0x1b5),'BG':_0x431a10(0x1ab),'BY':_0x431a10(0x134),'CH':_0x431a10(0x1c0),'CY':'CYP','CZ':_0x431a10(0x192),'DE':'DEU','DK':_0x431a10(0x18b),'EE':_0x431a10(0x155),'ES':'ESP','FI':'FIN','FR':_0x431a10(0x17a),'GB':_0x431a10(0x1ac),'GE':_0x431a10(0x143),'GR':_0x431a10(0x1b4),'HR':_0x431a10(0x16b),'HU':_0x431a10(0x197),'IE':_0x431a10(0x15a),'IS':_0x431a10(0x178),'IT':_0x431a10(0x16d),'LI':_0x431a10(0x124),'LT':_0x431a10(0x140),'LU':_0x431a10(0x1ad),'LV':_0x431a10(0x169),'MC':'MCO','MD':'MDA','ME':'MNE','MK':_0x431a10(0x19b),'MT':_0x431a10(0x17b),'NL':_0x431a10(0x12e),'NO':_0x431a10(0x1ba),'PL':_0x431a10(0x142),'PT':_0x431a10(0x127),'RO':_0x431a10(0x1e6),'RS':_0x431a10(0x126),'RU':_0x431a10(0x129),'SE':_0x431a10(0x1e8),'SI':_0x431a10(0x176),'SK':_0x431a10(0x195),'SM':_0x431a10(0x182),'UA':_0x431a10(0x1e1),'VA':_0x431a10(0x158),'XK':_0x431a10(0x133),'AM':'ARM','AZ':_0x431a10(0x1b0),'KZ':_0x431a10(0x19d),'KG':_0x431a10(0x154),'TJ':_0x431a10(0x12f),'TM':_0x431a10(0x189),'UZ':_0x431a10(0x165),'US':_0x431a10(0x118),'CA':'CAN','AU':_0x431a10(0x120),'JP':_0x431a10(0x15e),'CN':_0x431a10(0x146),'IN':_0x431a10(0x13e),'BR':_0x431a10(0x1cf),'MX':_0x431a10(0x16c),'AR':_0x431a10(0x12b),'CL':_0x431a10(0x12c),'PE':_0x431a10(0x1a7),'CO':'COL','VE':_0x431a10(0x183),'EC':'ECU','BO':_0x431a10(0x153),'PY':_0x431a10(0x14f),'UY':'URY','SR':_0x431a10(0x173),'GY':'GUY','FK':_0x431a10(0x13c),'ZA':'ZAF','EG':_0x431a10(0x130),'NG':_0x431a10(0x1a9),'KE':'KEN','GH':_0x431a10(0x187),'TZ':'TZA','UG':_0x431a10(0x1a3),'ZW':'ZWE','ZM':'ZMB','MW':'MWI','MZ':'MOZ','MG':'MDG','MU':_0x431a10(0x15d),'SC':_0x431a10(0x14a),'RE':'REU','TR':_0x431a10(0x18f),'IR':_0x431a10(0x11d),'IQ':_0x431a10(0x13d),'SA':_0x431a10(0x190),'AE':_0x431a10(0x15b),'KW':'KWT','QA':_0x431a10(0x160),'BH':_0x431a10(0x177),'OM':_0x431a10(0x1bc),'YE':_0x431a10(0x1a4),'JO':_0x431a10(0x14e),'LB':_0x431a10(0x1c6),'SY':_0x431a10(0x1d1),'IL':'ISR','PS':_0x431a10(0x1c5),'KR':_0x431a10(0x1a2),'KP':_0x431a10(0x147),'TH':_0x431a10(0x188),'VN':_0x431a10(0x196),'MY':_0x431a10(0x19c),'SG':_0x431a10(0x121),'ID':'IDN','PH':_0x431a10(0x1d2),'LA':_0x431a10(0x1dd),'KH':'KHM','MM':_0x431a10(0x19f),'BD':_0x431a10(0x1b3),'LK':'LKA','NP':_0x431a10(0x193),'BT':_0x431a10(0x1da),'MV':_0x431a10(0x16f),'AF':'AFG','PK':'PAK','MN':_0x431a10(0x1db)},_0x4e87de=_0x5d885a[_0x44b748[_0x431a10(0x17d)]()];if(!_0x4e87de)return console['warn'](_0x431a10(0x1b9)+_0x44b748+_0x431a10(0x1d0)),_0x431a10(0x18f);return _0x4e87de;}async[a63_0x437a39(0x1e7)](_0x2fe56b){const _0xeee271=a63_0x437a39;console[_0xeee271(0x11e)](_0xeee271(0x194),{'paymentId':_0x2fe56b[_0xeee271(0x1e4)],'amount':_0x2fe56b[_0xeee271(0x166)],'currency':_0x2fe56b[_0xeee271(0x163)],'customerCountry':_0x2fe56b['customerCountry']});try{const _0x5c0ec={'client_merchant_id':this[_0xeee271(0x1bb)],'payment_method':'Bank\x20Transfer\x20TR','client_transaction_id':_0x2fe56b[_0xeee271(0x11b)],'amount':_0x2fe56b['amount'],'currency':_0x2fe56b[_0xeee271(0x163)],'callback_url':_0xeee271(0x1ae),'tracker_id':_0x2fe56b[_0xeee271(0x1e4)],'redirect_url':_0x2fe56b[_0xeee271(0x1be)],'failure_url':_0x2fe56b[_0xeee271(0x11f)],'customer_first_name':_0x2fe56b['firstName'],'customer_last_name':_0x2fe56b[_0xeee271(0x1c7)],'customer_email':_0x2fe56b[_0xeee271(0x11a)],'customer_phone':_0x2fe56b[_0xeee271(0x167)]||'','customer_ip':_0x2fe56b[_0xeee271(0x151)],'customer_country':_0x2fe56b[_0xeee271(0x1df)],'api_public_key':this[_0xeee271(0x13b)]};console[_0xeee271(0x11e)](_0xeee271(0x18d),JSON[_0xeee271(0x184)](_0x5c0ec,null,0x2));const _0x17ddfb=await fetch(this['apiUrl'],{'method':_0xeee271(0x12a),'headers':{'Content-Type':_0xeee271(0x1dc),'User-Agent':'TrapayEnd/1.0'},'body':JSON[_0xeee271(0x184)](_0x5c0ec)});console[_0xeee271(0x11e)](_0xeee271(0x1e0),_0x17ddfb['status']);const _0x3bd26c=await _0x17ddfb['text']();console[_0xeee271(0x11e)](_0xeee271(0x156),_0x3bd26c);let _0x4c8e30;try{_0x4c8e30=JSON[_0xeee271(0x185)](_0x3bd26c);}catch(_0x35a3fa){console[_0xeee271(0x172)](_0xeee271(0x123),_0x35a3fa);throw new Error(_0xeee271(0x1bd)+_0x3bd26c);}console['log'](_0xeee271(0x136),JSON[_0xeee271(0x184)](_0x4c8e30,null,0x2)),loggerService_1[_0xeee271(0x148)][_0xeee271(0x1c2)]('ampay-try',_0x4c8e30,{});if(!_0x17ddfb['ok']){const _0x57c99d=_0x4c8e30[_0xeee271(0x1c4)]||_0x4c8e30[_0xeee271(0x11c)]||_0xeee271(0x12d)+_0x17ddfb[_0xeee271(0x19a)];console[_0xeee271(0x172)](_0xeee271(0x1ce),_0x57c99d);throw new Error(_0xeee271(0x159)+_0x57c99d);}if(!_0x4c8e30[_0xeee271(0x19e)]){console['error'](_0xeee271(0x139),_0x4c8e30);throw new Error(_0xeee271(0x1d8));}const _0x2113be={'gateway_payment_id':_0x4c8e30[_0xeee271(0x174)]||_0x2fe56b[_0xeee271(0x11b)],'payment_url':_0x4c8e30[_0xeee271(0x19e)],'transaction_id':_0x4c8e30['client_transaction_id']};return console[_0xeee271(0x11e)](_0xeee271(0x179),_0x2113be),_0x2113be;}catch(_0x152b12){console[_0xeee271(0x172)](_0xeee271(0x161),_0x152b12),loggerService_1[_0xeee271(0x148)]['logWebhookError'](_0xeee271(0x1cb),_0x152b12,_0x2fe56b);throw _0x152b12;}}async[a63_0x437a39(0x17e)](_0x353a1b){const _0xe0be8f=a63_0x437a39;try{const {orderId:_0x541b79,amount:_0x4175f1,currency:_0x2c7e3a,firstName:_0x421fbd,lastName:_0x524600,email:_0x33446e,phone:_0x434471,customerIp:_0x19b672,customerCountry:_0x365148,successUrl:_0x42f85c,failureUrl:_0x15f7a4}=_0x353a1b;console[_0xe0be8f(0x11e)]('üáπüá∑\x20Creating\x20AmPay\x20TRY\x20payment\x20link...'),console[_0xe0be8f(0x11e)]('Order\x20ID:',_0x541b79),console['log'](_0xe0be8f(0x1b6),_0x4175f1,_0x2c7e3a),console[_0xe0be8f(0x11e)]('Customer:',_0x421fbd+'\x20'+_0x524600),console[_0xe0be8f(0x11e)]('Email:',_0x33446e),console[_0xe0be8f(0x11e)](_0xe0be8f(0x152),_0x434471||_0xe0be8f(0x149)),console['log'](_0xe0be8f(0x141),_0x19b672),console[_0xe0be8f(0x11e)](_0xe0be8f(0x1b2),_0x365148);const _0x5d969c=this[_0xe0be8f(0x14b)](_0x365148);console[_0xe0be8f(0x11e)]('Customer\x20Country\x20(3-letter):',_0x5d969c);const _0x39f74b={'sub_method':_0xe0be8f(0x199),'currency':_0x2c7e3a[_0xe0be8f(0x17d)](),'amount':_0x4175f1,'callback_url':'https://traffer.uk/gateway/ampay-try/webhook.php','client_merchant_id':this[_0xe0be8f(0x1bb)],'client_transaction_id':_0x541b79,'transaction_description':_0x541b79,'customer':{'ip':_0x19b672,'email':_0x33446e,'full_name':_0x421fbd+'\x20'+_0x524600,'phone':_0x434471||'','country':_0x5d969c},'success_redirect_url':_0x42f85c,'error_redirect_url':_0x15f7a4};console[_0xe0be8f(0x11e)](_0xe0be8f(0x1bf),JSON[_0xe0be8f(0x184)](_0x39f74b,null,0x2));const _0x31f12a=await fetch(this[_0xe0be8f(0x1ca)]+'ampay.php',{'method':_0xe0be8f(0x12a),'headers':{'Content-Type':_0xe0be8f(0x1dc),'User-Agent':_0xe0be8f(0x138)},'body':JSON[_0xe0be8f(0x184)](_0x39f74b)}),_0x549bc8=await _0x31f12a['text']();console[_0xe0be8f(0x11e)](_0xe0be8f(0x18c),_0x549bc8);if(!_0x31f12a['ok'])throw new Error(_0xe0be8f(0x131)+_0x31f12a['status']+_0xe0be8f(0x1e5)+_0x549bc8);let _0x2a3df7;try{_0x2a3df7=JSON['parse'](_0x549bc8);}catch(_0x46de26){throw new Error(_0xe0be8f(0x1bd)+_0x549bc8);}console[_0xe0be8f(0x11e)](_0xe0be8f(0x191),JSON[_0xe0be8f(0x184)](_0x2a3df7,null,0x2));if(!_0x2a3df7[_0xe0be8f(0x19e)])throw new Error(_0xe0be8f(0x119)+(_0x2a3df7[_0xe0be8f(0x1c4)]||_0x2a3df7[_0xe0be8f(0x11c)]||_0xe0be8f(0x171)));const _0x7330b2=_0x2a3df7[_0xe0be8f(0x19e)],_0x492d7a=_0x2a3df7['system_id'],_0x3dd171=_0x2a3df7[_0xe0be8f(0x1a5)];return console[_0xe0be8f(0x11e)]('‚úÖ\x20AmPay\x20TRY\x20payment\x20link\x20created\x20successfully'),console['log'](_0xe0be8f(0x1a0),_0x7330b2),console['log'](_0xe0be8f(0x125),_0x492d7a),console['log'](_0xe0be8f(0x1cc),_0x3dd171),console[_0xe0be8f(0x11e)](_0xe0be8f(0x16a),_0x2a3df7[_0xe0be8f(0x19a)]),console['log']('üìù\x20Logging\x20AmPay\x20TRY\x20payment\x20creation\x20event...'),{'gateway_payment_id':_0x492d7a||_0x3dd171||_0x541b79,'payment_url':_0x7330b2||'','transaction_id':_0x492d7a};}catch(_0x230e5a){console[_0xe0be8f(0x172)](_0xe0be8f(0x161),_0x230e5a),console[_0xe0be8f(0x11e)]('üìù\x20Logging\x20AmPay\x20TRY\x20payment\x20creation\x20failure...'),loggerService_1[_0xe0be8f(0x148)][_0xe0be8f(0x1a8)]('ampay-try',_0x230e5a,_0x353a1b);throw _0x230e5a;}}async[a63_0x437a39(0x1aa)](_0x39b9d6){const _0x323df7=a63_0x437a39;console['log']('üîç\x20Checking\x20AmPay\x20TRY\x20payment\x20status\x20for:',_0x39b9d6);try{const _0x3511bc={'client_merchant_id':this[_0x323df7(0x1bb)],'system_id':_0x39b9d6,'api_public_key':this[_0x323df7(0x13b)]},_0x6d7cab=await fetch(this['apiUrl']+_0x323df7(0x1af),{'method':_0x323df7(0x12a),'headers':{'Content-Type':'application/json','User-Agent':_0x323df7(0x18e)},'body':JSON[_0x323df7(0x184)](_0x3511bc)}),_0x863b70=await _0x6d7cab[_0x323df7(0x198)]();console[_0x323df7(0x11e)](_0x323df7(0x1c9),_0x863b70);let _0x256749;try{_0x256749=JSON[_0x323df7(0x185)](_0x863b70);}catch(_0x2f8739){return console['error'](_0x323df7(0x162),_0x2f8739),{'status':_0x323df7(0x150)};}console[_0x323df7(0x11e)](_0x323df7(0x1c3),JSON[_0x323df7(0x184)](_0x256749,null,0x2));let _0x1f7acf=_0x323df7(0x13f);if(_0x256749[_0x323df7(0x19a)])switch(_0x256749['status'][_0x323df7(0x1b1)]()){case _0x323df7(0x132):case _0x323df7(0x1b8):case _0x323df7(0x18a):_0x1f7acf=_0x323df7(0x1e2);break;case _0x323df7(0x14c):case _0x323df7(0x172):case _0x323df7(0x122):_0x1f7acf=_0x323df7(0x150);break;case'expired':case _0x323df7(0x1a1):_0x1f7acf=_0x323df7(0x13a);break;case _0x323df7(0x144):case'processing':case _0x323df7(0x17c):default:_0x1f7acf=_0x323df7(0x13f);break;}return{'status':_0x1f7acf,'amount':_0x256749['amount'],'currency':_0x256749['currency']};}catch(_0x1ec534){return console[_0x323df7(0x172)](_0x323df7(0x1cd),_0x1ec534),{'status':_0x323df7(0x150)};}}async[a63_0x437a39(0x1d6)](_0x475842){const _0x47561e=a63_0x437a39;console[_0x47561e(0x11e)]('üì•\x20Processing\x20AmPay\x20TRY\x20webhook:',JSON[_0x47561e(0x184)](_0x475842,null,0x2));try{const _0x530378=_0x475842[_0x47561e(0x1a5)]||_0x475842['client_transaction_id']||_0x475842[_0x47561e(0x174)];if(!_0x530378){console[_0x47561e(0x172)]('‚ùå\x20No\x20payment\x20ID\x20found\x20in\x20AmPay\x20TRY\x20webhook\x20data');throw new Error(_0x47561e(0x16e));}let _0x1c8af8='PENDING';if(_0x475842[_0x47561e(0x19a)])switch(_0x475842[_0x47561e(0x19a)][_0x47561e(0x1b1)]()){case _0x47561e(0x132):case _0x47561e(0x1b8):case _0x47561e(0x18a):_0x1c8af8=_0x47561e(0x1e2);break;case'failed':case _0x47561e(0x172):case _0x47561e(0x122):_0x1c8af8=_0x47561e(0x150);break;case _0x47561e(0x181):case _0x47561e(0x1a1):_0x1c8af8=_0x47561e(0x13a);break;case _0x47561e(0x144):case _0x47561e(0x1de):case _0x47561e(0x17c):default:_0x1c8af8=_0x47561e(0x13f);break;}return console['log']('üìä\x20AmPay\x20TRY\x20webhook\x20processed:\x20'+_0x530378+_0x47561e(0x175)+_0x1c8af8),{'paymentId':_0x530378,'status':_0x1c8af8,'amount':_0x475842['amount'],'currency':_0x475842[_0x47561e(0x163)]||_0x47561e(0x145)};}catch(_0xf026a8){console[_0x47561e(0x172)]('‚ùå\x20AmPay\x20TRY\x20webhook\x20processing\x20failed:',_0xf026a8);throw _0xf026a8;}}[a63_0x437a39(0x180)](_0x5daf50,_0x5bbdd0){return console['log']('üîê\x20AmPay\x20TRY\x20webhook\x20signature\x20verification\x20not\x20implemented\x20yet'),!![];}}exports['AmPayTRYService']=AmPayTRYService;