'use strict';const a55_0x6b415a=a55_0x5007;(function(_0xecec3f,_0x411e46){const _0x3bd9c4=a55_0x5007,_0x96e335=_0xecec3f();while(!![]){try{const _0xbdd04c=-parseInt(_0x3bd9c4(0x125))/0x1+-parseInt(_0x3bd9c4(0x115))/0x2*(parseInt(_0x3bd9c4(0xb4))/0x3)+-parseInt(_0x3bd9c4(0xeb))/0x4+parseInt(_0x3bd9c4(0xf9))/0x5+-parseInt(_0x3bd9c4(0x13a))/0x6+parseInt(_0x3bd9c4(0x148))/0x7+parseInt(_0x3bd9c4(0xe2))/0x8;if(_0xbdd04c===_0x411e46)break;else _0x96e335['push'](_0x96e335['shift']());}catch(_0x586d65){_0x96e335['push'](_0x96e335['shift']());}}}(a55_0x29eb,0x3db10));function a55_0x5007(_0x1d228d,_0x441476){_0x1d228d=_0x1d228d-0xb2;const _0x29eb4c=a55_0x29eb();let _0x500745=_0x29eb4c[_0x1d228d];return _0x500745;}function a55_0x29eb(){const _0x499ea9=['log','PSE','Order\x20ID:','JOR','LKA','MNE','VAT','ISR','AmPay\x20TRY\x20API\x20error:\x20','error_message','IRL','Phone:','paid','orderId','LIE','checkPaymentStatus','waiting','SWE','3jSMcfZ','Invalid\x20JSON\x20response\x20from\x20AmPay\x20TRY:\x20','MWI','üìä\x20AmPay\x20TRY\x20response\x20data:','amount','BTN','ARM','‚ùå\x20AmPay\x20TRY\x20webhook\x20processing\x20failed:','üìù\x20Logging\x20AmPay\x20TRY\x20payment\x20creation\x20failure...','completed','MLT','TUR','‚ùå\x20No\x20payment\x20ID\x20found\x20in\x20AmPay\x20TRY\x20webhook\x20data',',\x20using\x20TUR\x20as\x20fallback\x20for\x20AmPay\x20TRY','LUX','BRA','Amount:','SUR','IRQ','KAZ','https://traffer.uk/gateway/ampay-try/webhook.php','üìä\x20AmPay\x20TRY\x20status\x20response:','üì•\x20Processing\x20AmPay\x20TRY\x20webhook:','PRT','customerIp','üîê\x20AmPay\x20TRY\x20webhook\x20signature\x20verification\x20not\x20implemented\x20yet','‚ùå\x20AmPay\x20TRY\x20status\x20check\x20failed:','parse','üîç\x20Checking\x20AmPay\x20TRY\x20payment\x20status\x20for:','MUS','Bank\x20Transfer\x20TR','currency','BIH','GBR','üìä\x20AmPay\x20TRY\x20webhook\x20processed:\x20','AmPay\x20TRY\x20did\x20not\x20return\x20a\x20payment\x20URL','ALB','AmPay\x20TRY\x20payment\x20creation\x20failed:\x20','GAM','Payment\x20URL:','üìù\x20Logging\x20AmPay\x20TRY\x20payment\x20creation\x20event...','application/json','KEN','toUpperCase','createPayment','AUT','348688hNNaVi','MDA','ESP','timeout','email','text','HTTP\x20','FRA','DNK','77188DArHIw','failureUrl','BGR','YEM','MDV','EXPIRED','VNM','58b59ccbc03dcdcfc20d830edfba765dbf9f3531c692533d84b17938e9c40bda','PRK','toLowerCase','defineProperty','AZE','phone','NPL','1838100sBDDia','failed','stringify','customerCountry','PENDING','HUN','MNG','GHA','üì°\x20AmPay\x20TRY\x20API\x20response\x20status:','error','‚ùå\x20No\x20redirect_url\x20in\x20AmPay\x20TRY\x20response:','ECU','üì•\x20AmPay\x20TRY\x20raw\x20response:','SAU','‚ùå\x20Failed\x20to\x20parse\x20AmPay\x20TRY\x20status\x20response:','redirect_url','üìù\x20AmPay\x20TRY\x20status\x20raw\x20response:','SRB','AND','‚ùå\x20AmPay\x20TRY\x20API\x20error:','UKR','MYS','\x20-\x20','Customer\x20Country\x20(3-letter):','üöÄ\x20Creating\x20AmPay\x20TRY\x20payment\x20request:','SMR','‚ùå\x20AmPay\x20TRY\x20payment\x20creation\x20failed:','AmPay\x20TRY\x20API\x20error:\x20HTTP\x20','889286WTkdrS','apiUrl','https://traffer.uk/gateway/ampay-try/','ARE','URY','KHM','ZMB','not\x20provided','GEO','loggerService','LTU','convert2LetterTo3LetterCountryCode','üáπüá∑\x20Creating\x20AmPay\x20TRY\x20payment\x20link...','declined','PAID','TJK','24221qOcRvH','a5a059aa63392e571341bddc5148a5db66643722e9a6bf16a9395fb690a80288931d5a1180a85a28eb9f6516cf61dfc1bf4e37898f3a35261cd2db88888d3815','success','system_id','CHN','AmPayTRYService','lastName','System\x20ID:','‚ö†Ô∏è\x20Unknown\x20country\x20code:\x20','status','ZAF','SVN','‚úÖ\x20AmPay\x20TRY\x20payment\x20created\x20successfully:','MDG','message','Customer\x20IP:','createPaymentLink','warn','IND','üì§\x20AmPay\x20TRY\x20API\x20request\x20data:','FAILED','175800DMumXl','MCO','FIN','DEU','SYC','CLIENT_MERCHANT_ID','CZE','verifyWebhookSignature','Email:','Customer\x20Country\x20(2-letter):','../loggerService','COL','KGZ','ITA','2512601sUJPDY','SVK','processing','QAT','JPN','MEX','ampay.php','XKX','IRN','üìù\x20AmPay\x20TRY\x20API\x20raw\x20response:','POST','TKM','ARG','LAO','ZWE','logWebhookError','FLK','HRV','ampay-try','EST','TZA','No\x20payment\x20ID\x20in\x20webhook\x20data','client_transaction_id','GRC','pending','TrapayEnd/1.0','tracker_id','TRY','LBN','OMN','\x20->\x20','__esModule','UZB'];a55_0x29eb=function(){return _0x499ea9;};return a55_0x29eb();}Object[a55_0x6b415a(0xf5)](exports,a55_0x6b415a(0x167),{'value':!![]}),exports[a55_0x6b415a(0x12a)]=void 0x0;const loggerService_1=require(a55_0x6b415a(0x144));class AmPayTRYService{constructor(){const _0x2b2ea8=a55_0x6b415a;this['CLIENT_MERCHANT_ID']='TRAFFER',this['API_PUBLIC_KEY']=_0x2b2ea8(0xf2),this['API_PRIVATE_KEY']=_0x2b2ea8(0x126),this[_0x2b2ea8(0x116)]=_0x2b2ea8(0x117),console[_0x2b2ea8(0x169)]('üáπüá∑\x20AmPay\x20TRY\x20service\x20initialized\x20with\x20IBAN\x20Bank\x20Transfer\x20TR\x20processing');}[a55_0x6b415a(0x120)](_0x4475a1){const _0x2af486=a55_0x6b415a,_0x30c69c={'AD':_0x2af486(0x10b),'AL':_0x2af486(0xd8),'AT':_0x2af486(0xe1),'BA':_0x2af486(0xd4),'BE':'BEL','BG':_0x2af486(0xed),'BY':'BLR','CH':'CHE','CY':'CYP','CZ':_0x2af486(0x140),'DE':_0x2af486(0x13d),'DK':_0x2af486(0xea),'EE':_0x2af486(0x15b),'ES':_0x2af486(0xe4),'FI':_0x2af486(0x13c),'FR':_0x2af486(0xe9),'GB':_0x2af486(0xd5),'GE':_0x2af486(0x11d),'GR':_0x2af486(0x15f),'HR':_0x2af486(0x159),'HU':_0x2af486(0xfe),'IE':_0x2af486(0x173),'IS':'ISL','IT':_0x2af486(0x147),'LI':_0x2af486(0x177),'LT':_0x2af486(0x11f),'LU':_0x2af486(0xc2),'LV':'LVA','MC':_0x2af486(0x13b),'MD':_0x2af486(0xe3),'ME':_0x2af486(0x16e),'MK':'MKD','MT':_0x2af486(0xbe),'NL':'NLD','NO':'NOR','PL':'POL','PT':_0x2af486(0xcb),'RO':'ROU','RS':_0x2af486(0x10a),'RU':'RUS','SE':_0x2af486(0xb3),'SI':_0x2af486(0x130),'SK':_0x2af486(0x149),'SM':_0x2af486(0x112),'UA':_0x2af486(0x10d),'VA':_0x2af486(0x16f),'XK':_0x2af486(0x14f),'AM':_0x2af486(0xba),'AZ':_0x2af486(0xf6),'KZ':_0x2af486(0xc7),'KG':_0x2af486(0x146),'TJ':_0x2af486(0x124),'TM':_0x2af486(0x153),'UZ':_0x2af486(0x168),'US':'USA','CA':'CAN','AU':'AUS','JP':_0x2af486(0x14c),'CN':_0x2af486(0x129),'IN':_0x2af486(0x137),'BR':_0x2af486(0xc3),'MX':_0x2af486(0x14d),'AR':_0x2af486(0x154),'CL':'CHL','PE':'PER','CO':_0x2af486(0x145),'VE':'VEN','EC':_0x2af486(0x104),'BO':'BOL','PY':'PRY','UY':_0x2af486(0x119),'SR':_0x2af486(0xc5),'GY':'GUY','FK':_0x2af486(0x158),'ZA':_0x2af486(0x12f),'EG':'EGY','NG':'NGA','KE':_0x2af486(0xde),'GH':_0x2af486(0x100),'TZ':_0x2af486(0x15c),'UG':'UGA','ZW':_0x2af486(0x156),'ZM':_0x2af486(0x11b),'MW':_0x2af486(0xb6),'MZ':'MOZ','MG':_0x2af486(0x132),'MU':_0x2af486(0xd1),'SC':_0x2af486(0x13e),'RE':'REU','TR':_0x2af486(0xbf),'IR':_0x2af486(0x150),'IQ':_0x2af486(0xc6),'SA':_0x2af486(0x106),'AE':_0x2af486(0x118),'KW':'KWT','QA':_0x2af486(0x14b),'BH':'BHR','OM':_0x2af486(0x165),'YE':_0x2af486(0xee),'JO':_0x2af486(0x16c),'LB':_0x2af486(0x164),'SY':'SYR','IL':_0x2af486(0x170),'PS':_0x2af486(0x16a),'KR':'KOR','KP':_0x2af486(0xf3),'TH':'THA','VN':_0x2af486(0xf1),'MY':_0x2af486(0x10e),'SG':'SGP','ID':'IDN','PH':'PHL','LA':_0x2af486(0x155),'KH':_0x2af486(0x11a),'MM':'MMR','BD':'BGD','LK':_0x2af486(0x16d),'NP':_0x2af486(0xf8),'BT':_0x2af486(0xb9),'MV':_0x2af486(0xef),'AF':'AFG','PK':'PAK','MN':_0x2af486(0xff)},_0x373996=_0x30c69c[_0x4475a1[_0x2af486(0xdf)]()];if(!_0x373996)return console[_0x2af486(0x136)](_0x2af486(0x12d)+_0x4475a1+_0x2af486(0xc1)),_0x2af486(0xbf);return _0x373996;}async[a55_0x6b415a(0xe0)](_0x5ec8dc){const _0x1e1c43=a55_0x6b415a;console[_0x1e1c43(0x169)](_0x1e1c43(0x111),{'paymentId':_0x5ec8dc['paymentId'],'amount':_0x5ec8dc[_0x1e1c43(0xb8)],'currency':_0x5ec8dc[_0x1e1c43(0xd3)],'customerCountry':_0x5ec8dc[_0x1e1c43(0xfc)]});try{const _0x194b4e={'client_merchant_id':this[_0x1e1c43(0x13f)],'payment_method':_0x1e1c43(0xd2),'client_transaction_id':_0x5ec8dc[_0x1e1c43(0x176)],'amount':_0x5ec8dc['amount'],'currency':_0x5ec8dc[_0x1e1c43(0xd3)],'callback_url':_0x1e1c43(0xc8),'tracker_id':_0x5ec8dc['paymentId'],'redirect_url':_0x5ec8dc['successUrl'],'failure_url':_0x5ec8dc[_0x1e1c43(0xec)],'customer_first_name':_0x5ec8dc['firstName'],'customer_last_name':_0x5ec8dc[_0x1e1c43(0x12b)],'customer_email':_0x5ec8dc[_0x1e1c43(0xe6)],'customer_phone':_0x5ec8dc[_0x1e1c43(0xf7)]||'','customer_ip':_0x5ec8dc[_0x1e1c43(0xcc)],'customer_country':_0x5ec8dc[_0x1e1c43(0xfc)],'api_public_key':this['API_PUBLIC_KEY']};console[_0x1e1c43(0x169)](_0x1e1c43(0x138),JSON[_0x1e1c43(0xfb)](_0x194b4e,null,0x2));const _0x2501bb=await fetch(this[_0x1e1c43(0x116)],{'method':_0x1e1c43(0x152),'headers':{'Content-Type':'application/json','User-Agent':_0x1e1c43(0x161)},'body':JSON[_0x1e1c43(0xfb)](_0x194b4e)});console[_0x1e1c43(0x169)](_0x1e1c43(0x101),_0x2501bb[_0x1e1c43(0x12e)]);const _0x287640=await _0x2501bb[_0x1e1c43(0xe7)]();console['log'](_0x1e1c43(0x151),_0x287640);let _0x550166;try{_0x550166=JSON['parse'](_0x287640);}catch(_0x41b5c2){console[_0x1e1c43(0x102)]('‚ùå\x20Failed\x20to\x20parse\x20AmPay\x20TRY\x20API\x20response:',_0x41b5c2);throw new Error(_0x1e1c43(0xb5)+_0x287640);}console['log']('üìä\x20AmPay\x20TRY\x20parsed\x20response:',JSON[_0x1e1c43(0xfb)](_0x550166,null,0x2)),loggerService_1[_0x1e1c43(0x11e)]['logWebhookReceived'](_0x1e1c43(0x15a),_0x550166,{});if(!_0x2501bb['ok']){const _0x354b71=_0x550166[_0x1e1c43(0x172)]||_0x550166[_0x1e1c43(0x133)]||_0x1e1c43(0xe8)+_0x2501bb['status'];console[_0x1e1c43(0x102)](_0x1e1c43(0x10c),_0x354b71);throw new Error(_0x1e1c43(0x171)+_0x354b71);}if(!_0x550166['redirect_url']){console[_0x1e1c43(0x102)](_0x1e1c43(0x103),_0x550166);throw new Error(_0x1e1c43(0xd7));}const _0xfb010d={'gateway_payment_id':_0x550166['system_id']||_0x5ec8dc['orderId'],'payment_url':_0x550166[_0x1e1c43(0x108)],'transaction_id':_0x550166[_0x1e1c43(0x15e)]};return console[_0x1e1c43(0x169)](_0x1e1c43(0x131),_0xfb010d),_0xfb010d;}catch(_0x18357a){console['error'](_0x1e1c43(0x113),_0x18357a),loggerService_1['loggerService'][_0x1e1c43(0x157)](_0x1e1c43(0x15a),_0x18357a,_0x5ec8dc);throw _0x18357a;}}async[a55_0x6b415a(0x135)](_0x1c6db8){const _0x3746b6=a55_0x6b415a;try{const {orderId:_0x590a92,amount:_0x1ccb5e,currency:_0x188a7b,firstName:_0x485d3d,lastName:_0x21ae4d,email:_0x587da2,phone:_0x474a0c,customerIp:_0x1dc6d4,customerCountry:_0x30e233,successUrl:_0xd99d6,failureUrl:_0x559398}=_0x1c6db8;console['log'](_0x3746b6(0x121)),console['log'](_0x3746b6(0x16b),_0x590a92),console[_0x3746b6(0x169)](_0x3746b6(0xc4),_0x1ccb5e,_0x188a7b),console[_0x3746b6(0x169)]('Customer:',_0x485d3d+'\x20'+_0x21ae4d),console['log'](_0x3746b6(0x142),_0x587da2),console[_0x3746b6(0x169)](_0x3746b6(0x174),_0x474a0c||_0x3746b6(0x11c)),console[_0x3746b6(0x169)](_0x3746b6(0x134),_0x1dc6d4),console[_0x3746b6(0x169)](_0x3746b6(0x143),_0x30e233);const _0x2d4a1d=this['convert2LetterTo3LetterCountryCode'](_0x30e233);console['log'](_0x3746b6(0x110),_0x2d4a1d);const _0x4484d1={'sub_method':_0x3746b6(0xda),'currency':_0x188a7b[_0x3746b6(0xdf)](),'amount':_0x1ccb5e,'callback_url':_0x3746b6(0xc8),'client_merchant_id':this['CLIENT_MERCHANT_ID'],'client_transaction_id':_0x590a92,'transaction_description':_0x590a92,'customer':{'ip':_0x1dc6d4,'email':_0x587da2,'full_name':_0x485d3d+'\x20'+_0x21ae4d,'phone':_0x474a0c||'','country':_0x2d4a1d},'success_redirect_url':_0xd99d6,'error_redirect_url':_0x559398};console[_0x3746b6(0x169)]('üì§\x20AmPay\x20TRY\x20request\x20body:',JSON['stringify'](_0x4484d1,null,0x2));const _0x455899=await fetch(this['apiUrl']+_0x3746b6(0x14e),{'method':_0x3746b6(0x152),'headers':{'Content-Type':'application/json','User-Agent':'TrapayAPI/1.0'},'body':JSON[_0x3746b6(0xfb)](_0x4484d1)}),_0x5bb66c=await _0x455899[_0x3746b6(0xe7)]();console[_0x3746b6(0x169)](_0x3746b6(0x105),_0x5bb66c);if(!_0x455899['ok'])throw new Error(_0x3746b6(0x114)+_0x455899['status']+_0x3746b6(0x10f)+_0x5bb66c);let _0xfccc36;try{_0xfccc36=JSON[_0x3746b6(0xcf)](_0x5bb66c);}catch(_0x2c5f6b){throw new Error('Invalid\x20JSON\x20response\x20from\x20AmPay\x20TRY:\x20'+_0x5bb66c);}console[_0x3746b6(0x169)](_0x3746b6(0xb7),JSON[_0x3746b6(0xfb)](_0xfccc36,null,0x2));if(!_0xfccc36[_0x3746b6(0x108)])throw new Error(_0x3746b6(0xd9)+(_0xfccc36[_0x3746b6(0x172)]||_0xfccc36[_0x3746b6(0x133)]||'Unknown\x20error'));const _0x3b8530=_0xfccc36[_0x3746b6(0x108)],_0x2659b1=_0xfccc36[_0x3746b6(0x128)],_0x10afb4=_0xfccc36['tracker_id'];return console[_0x3746b6(0x169)]('‚úÖ\x20AmPay\x20TRY\x20payment\x20link\x20created\x20successfully'),console[_0x3746b6(0x169)](_0x3746b6(0xdb),_0x3b8530),console[_0x3746b6(0x169)](_0x3746b6(0x12c),_0x2659b1),console[_0x3746b6(0x169)]('Tracker\x20ID:',_0x10afb4),console['log']('Status:',_0xfccc36[_0x3746b6(0x12e)]),console['log'](_0x3746b6(0xdc)),{'gateway_payment_id':_0x2659b1||_0x10afb4||_0x590a92,'payment_url':_0x3b8530||'','transaction_id':_0x2659b1};}catch(_0x2f2ae4){console[_0x3746b6(0x102)]('‚ùå\x20AmPay\x20TRY\x20payment\x20creation\x20failed:',_0x2f2ae4),console[_0x3746b6(0x169)](_0x3746b6(0xbc)),loggerService_1[_0x3746b6(0x11e)][_0x3746b6(0x157)](_0x3746b6(0x15a),_0x2f2ae4,_0x1c6db8);throw _0x2f2ae4;}}async[a55_0x6b415a(0x178)](_0x181aa5){const _0x3f5860=a55_0x6b415a;console['log'](_0x3f5860(0xd0),_0x181aa5);try{const _0x25fd3e={'client_merchant_id':this[_0x3f5860(0x13f)],'system_id':_0x181aa5,'api_public_key':this['API_PUBLIC_KEY']},_0x215d4b=await fetch(this[_0x3f5860(0x116)]+'/status',{'method':_0x3f5860(0x152),'headers':{'Content-Type':_0x3f5860(0xdd),'User-Agent':_0x3f5860(0x161)},'body':JSON[_0x3f5860(0xfb)](_0x25fd3e)}),_0x180598=await _0x215d4b[_0x3f5860(0xe7)]();console[_0x3f5860(0x169)](_0x3f5860(0x109),_0x180598);let _0x49524a;try{_0x49524a=JSON[_0x3f5860(0xcf)](_0x180598);}catch(_0x2fbb8c){return console[_0x3f5860(0x102)](_0x3f5860(0x107),_0x2fbb8c),{'status':_0x3f5860(0x139)};}console[_0x3f5860(0x169)](_0x3f5860(0xc9),JSON[_0x3f5860(0xfb)](_0x49524a,null,0x2));let _0x39451e='PENDING';if(_0x49524a[_0x3f5860(0x12e)])switch(_0x49524a['status'][_0x3f5860(0xf4)]()){case _0x3f5860(0x127):case _0x3f5860(0xbd):case _0x3f5860(0x175):_0x39451e=_0x3f5860(0x123);break;case _0x3f5860(0xfa):case _0x3f5860(0x102):case _0x3f5860(0x122):_0x39451e=_0x3f5860(0x139);break;case'expired':case _0x3f5860(0xe5):_0x39451e=_0x3f5860(0xf0);break;case _0x3f5860(0x160):case _0x3f5860(0x14a):case _0x3f5860(0xb2):default:_0x39451e=_0x3f5860(0xfd);break;}return{'status':_0x39451e,'amount':_0x49524a[_0x3f5860(0xb8)],'currency':_0x49524a['currency']};}catch(_0x2cec76){return console[_0x3f5860(0x102)](_0x3f5860(0xce),_0x2cec76),{'status':_0x3f5860(0x139)};}}async['processWebhook'](_0xfd1f84){const _0x2358f9=a55_0x6b415a;console[_0x2358f9(0x169)](_0x2358f9(0xca),JSON[_0x2358f9(0xfb)](_0xfd1f84,null,0x2));try{const _0x419e6e=_0xfd1f84[_0x2358f9(0x162)]||_0xfd1f84[_0x2358f9(0x15e)]||_0xfd1f84[_0x2358f9(0x128)];if(!_0x419e6e){console['error'](_0x2358f9(0xc0));throw new Error(_0x2358f9(0x15d));}let _0x1c554f=_0x2358f9(0xfd);if(_0xfd1f84[_0x2358f9(0x12e)])switch(_0xfd1f84[_0x2358f9(0x12e)]['toLowerCase']()){case _0x2358f9(0x127):case _0x2358f9(0xbd):case'paid':_0x1c554f=_0x2358f9(0x123);break;case _0x2358f9(0xfa):case'error':case _0x2358f9(0x122):_0x1c554f=_0x2358f9(0x139);break;case'expired':case _0x2358f9(0xe5):_0x1c554f='EXPIRED';break;case _0x2358f9(0x160):case _0x2358f9(0x14a):case'waiting':default:_0x1c554f='PENDING';break;}return console['log'](_0x2358f9(0xd6)+_0x419e6e+_0x2358f9(0x166)+_0x1c554f),{'paymentId':_0x419e6e,'status':_0x1c554f,'amount':_0xfd1f84[_0x2358f9(0xb8)],'currency':_0xfd1f84['currency']||_0x2358f9(0x163)};}catch(_0x56d9de){console[_0x2358f9(0x102)](_0x2358f9(0xbb),_0x56d9de);throw _0x56d9de;}}[a55_0x6b415a(0x141)](_0x4982d0,_0x44731a){const _0x26a1b1=a55_0x6b415a;return console['log'](_0x26a1b1(0xcd)),!![];}}exports[a55_0x6b415a(0x12a)]=AmPayTRYService;