'use strict';const a63_0x1840cf=a63_0x45bc;(function(_0x13e6a5,_0x1c4a20){const _0x2d50ed=a63_0x45bc,_0x1cff81=_0x13e6a5();while(!![]){try{const _0xa176e5=parseInt(_0x2d50ed(0x1e7))/0x1*(-parseInt(_0x2d50ed(0x223))/0x2)+parseInt(_0x2d50ed(0x1d3))/0x3+-parseInt(_0x2d50ed(0x1db))/0x4+-parseInt(_0x2d50ed(0x1d8))/0x5+-parseInt(_0x2d50ed(0x222))/0x6+parseInt(_0x2d50ed(0x204))/0x7+parseInt(_0x2d50ed(0x196))/0x8*(parseInt(_0x2d50ed(0x179))/0x9);if(_0xa176e5===_0x1c4a20)break;else _0x1cff81['push'](_0x1cff81['shift']());}catch(_0x2b80e9){_0x1cff81['push'](_0x1cff81['shift']());}}}(a63_0x129d,0x73d03));Object[a63_0x1840cf(0x186)](exports,a63_0x1840cf(0x188),{'value':!![]}),exports[a63_0x1840cf(0x202)]=void 0x0;function a63_0x45bc(_0x4da49e,_0x2835db){_0x4da49e=_0x4da49e-0x15f;const _0x129db3=a63_0x129d();let _0x45bcbd=_0x129db3[_0x4da49e];return _0x45bcbd;}const loggerService_1=require(a63_0x1840cf(0x166));function a63_0x129d(){const _0x3ced8=[',\x20using\x20TUR\x20as\x20fallback\x20for\x20AmPay\x20TRY','LUX','log','error_message','2VEPPef','EST','Phone:','TKM','expired','Invalid\x20JSON\x20response\x20from\x20AmPay\x20TRY:\x20','COL','IRN','firstName','NOR','Status:','text','KEN','logWebhookError','BGR','AmPay\x20TRY\x20API\x20error:\x20HTTP\x20','amount','\x20->\x20','POST','https://traffer.uk/gateway/ampay-try/webhook.php','toLowerCase','loggerService','PSE','USA','SAU','API_PUBLIC_KEY','message','AmPayTRYService','KHM','4731342eaotYp','email','SYC','BOL','üìä\x20AmPay\x20TRY\x20status\x20response:','tracker_id','‚ùå\x20AmPay\x20TRY\x20webhook\x20processing\x20failed:','No\x20payment\x20ID\x20in\x20webhook\x20data','currency','MNE','TrapayAPI/1.0','YEM','URY','ZMB','PRT','‚úÖ\x20AmPay\x20TRY\x20payment\x20created\x20successfully:','‚ùå\x20AmPay\x20TRY\x20status\x20check\x20failed:','üìù\x20Logging\x20AmPay\x20TRY\x20payment\x20creation\x20event...','DNK','QAT','‚ùå\x20AmPay\x20TRY\x20payment\x20creation\x20failed:','MOZ','MUS','client_transaction_id','TUR','redirect_url','‚ùå\x20No\x20redirect_url\x20in\x20AmPay\x20TRY\x20response:','AZE','status','üì°\x20AmPay\x20TRY\x20API\x20response\x20status:','4390830kCATyh','621312aAikUP','ESP','UGA','LIE','POL','MYS','parse','üìù\x20AmPay\x20TRY\x20status\x20raw\x20response:','TZA','CZE','pending','SUR','logWebhookReceived','GBR','LKA','BIH','AND','waiting','üìù\x20Logging\x20AmPay\x20TRY\x20payment\x20creation\x20failure...','Payment\x20URL:','System\x20ID:','../loggerService','VNM','NLD','createPaymentLink','CYP','AmPay\x20TRY\x20did\x20not\x20return\x20a\x20payment\x20URL','ampay.php','paid','orderId','‚ùå\x20No\x20payment\x20ID\x20found\x20in\x20AmPay\x20TRY\x20webhook\x20data','üáπüá∑\x20AmPay\x20TRY\x20service\x20initialized\x20with\x20IBAN\x20Bank\x20Transfer\x20TR\x20processing','LBN','GHA','paymentId','SVK','Email:','GEO','https://traffer.uk/gateway/ampay-try/','‚ùå\x20AmPay\x20TRY\x20API\x20error:','670671fDVlrF','FAILED','ISR','PER','MNG','ECU','BTN','SRB','üìä\x20AmPay\x20TRY\x20webhook\x20processed:\x20','THA','OMN','KAZ','AmPay\x20TRY\x20API\x20error:\x20','defineProperty','58b59ccbc03dcdcfc20d830edfba765dbf9f3531c692533d84b17938e9c40bda','__esModule','FRA','ZAF','failureUrl','lastName','processing','system_id','Customer\x20Country\x20(2-letter):','üì§\x20AmPay\x20TRY\x20API\x20request\x20data:','LAO','üîç\x20Checking\x20AmPay\x20TRY\x20payment\x20status\x20for:','MDV','apiUrl','üì•\x20AmPay\x20TRY\x20raw\x20response:','168ddkxzj','HUN','AUT','KWT','GAM','üì§\x20AmPay\x20TRY\x20request\x20body:','error','success','CHN','üìù\x20AmPay\x20TRY\x20API\x20raw\x20response:','REU','BHR','FLK','completed','checkPaymentStatus','TrapayEnd/1.0','CLIENT_MERCHANT_ID','CHL','successUrl','üáπüá∑\x20Creating\x20AmPay\x20TRY\x20payment\x20link...','RUS','Customer:','ARE','LVA','failed','IRL','BEL','EXPIRED','EGY','IDN','SGP','UKR','ZWE','‚ùå\x20Failed\x20to\x20parse\x20AmPay\x20TRY\x20API\x20response:','üìä\x20AmPay\x20TRY\x20response\x20data:','warn','MCO','Bank\x20Transfer\x20TR','stringify','KOR','FIN','NPL','PENDING','CHE','VAT','üöÄ\x20Creating\x20AmPay\x20TRY\x20payment\x20request:','ARM','NGA','PAID','ARG','MLT','Amount:','üìä\x20AmPay\x20TRY\x20parsed\x20response:','declined','ALB','‚ùå\x20Failed\x20to\x20parse\x20AmPay\x20TRY\x20status\x20response:','JOR','MMR','convert2LetterTo3LetterCountryCode','a5a059aa63392e571341bddc5148a5db66643722e9a6bf16a9395fb690a80288931d5a1180a85a28eb9f6516cf61dfc1bf4e37898f3a35261cd2db88888d3815','TJK','369051ZFycLc','KGZ','MEX','application/json','IND','847055hDBBoj','customerCountry','SWE','1467692dazBDj','UZB','‚úÖ\x20AmPay\x20TRY\x20payment\x20link\x20created\x20successfully','GRC','üîê\x20AmPay\x20TRY\x20webhook\x20signature\x20verification\x20not\x20implemented\x20yet','AFG','timeout','SYR'];a63_0x129d=function(){return _0x3ced8;};return a63_0x129d();}class AmPayTRYService{constructor(){const _0x21d8ff=a63_0x1840cf;this[_0x21d8ff(0x1a6)]='TRAFFER',this[_0x21d8ff(0x200)]=_0x21d8ff(0x187),this['API_PRIVATE_KEY']=_0x21d8ff(0x1d1),this['apiUrl']=_0x21d8ff(0x177),console[_0x21d8ff(0x1e5)](_0x21d8ff(0x170));}[a63_0x1840cf(0x1d0)](_0x120af0){const _0x573425=a63_0x1840cf,_0x2bafe3={'AD':_0x573425(0x161),'AL':_0x573425(0x1cc),'AT':_0x573425(0x198),'BA':_0x573425(0x160),'BE':_0x573425(0x1b0),'BG':_0x573425(0x1f5),'BY':'BLR','CH':_0x573425(0x1c1),'CY':_0x573425(0x16a),'CZ':_0x573425(0x22c),'DE':'DEU','DK':_0x573425(0x216),'EE':_0x573425(0x1e8),'ES':_0x573425(0x224),'FI':_0x573425(0x1be),'FR':_0x573425(0x189),'GB':_0x573425(0x230),'GE':_0x573425(0x176),'GR':_0x573425(0x1de),'HR':'HRV','HU':_0x573425(0x197),'IE':_0x573425(0x1af),'IS':'ISL','IT':'ITA','LI':_0x573425(0x226),'LT':'LTU','LU':_0x573425(0x1e4),'LV':_0x573425(0x1ad),'MC':_0x573425(0x1ba),'MD':'MDA','ME':_0x573425(0x20d),'MK':'MKD','MT':_0x573425(0x1c8),'NL':_0x573425(0x168),'NO':_0x573425(0x1f0),'PL':_0x573425(0x227),'PT':_0x573425(0x212),'RO':'ROU','RS':_0x573425(0x180),'RU':_0x573425(0x1aa),'SE':_0x573425(0x1da),'SI':'SVN','SK':_0x573425(0x174),'SM':'SMR','UA':_0x573425(0x1b5),'VA':_0x573425(0x1c2),'XK':'XKX','AM':_0x573425(0x1c4),'AZ':_0x573425(0x21f),'KZ':_0x573425(0x184),'KG':_0x573425(0x1d4),'TJ':_0x573425(0x1d2),'TM':_0x573425(0x1ea),'UZ':_0x573425(0x1dc),'US':_0x573425(0x1fe),'CA':'CAN','AU':'AUS','JP':'JPN','CN':_0x573425(0x19e),'IN':_0x573425(0x1d7),'BR':'BRA','MX':_0x573425(0x1d5),'AR':_0x573425(0x1c7),'CL':_0x573425(0x1a7),'PE':_0x573425(0x17c),'CO':_0x573425(0x1ed),'VE':'VEN','EC':_0x573425(0x17e),'BO':_0x573425(0x207),'PY':'PRY','UY':_0x573425(0x210),'SR':_0x573425(0x22e),'GY':'GUY','FK':_0x573425(0x1a2),'ZA':_0x573425(0x18a),'EG':_0x573425(0x1b2),'NG':_0x573425(0x1c5),'KE':_0x573425(0x1f3),'GH':_0x573425(0x172),'TZ':_0x573425(0x22b),'UG':_0x573425(0x225),'ZW':_0x573425(0x1b6),'ZM':_0x573425(0x211),'MW':'MWI','MZ':_0x573425(0x219),'MG':'MDG','MU':_0x573425(0x21a),'SC':_0x573425(0x206),'RE':_0x573425(0x1a0),'TR':_0x573425(0x21c),'IR':_0x573425(0x1ee),'IQ':'IRQ','SA':_0x573425(0x1ff),'AE':_0x573425(0x1ac),'KW':_0x573425(0x199),'QA':_0x573425(0x217),'BH':_0x573425(0x1a1),'OM':_0x573425(0x183),'YE':_0x573425(0x20f),'JO':_0x573425(0x1ce),'LB':_0x573425(0x171),'SY':_0x573425(0x1e2),'IL':_0x573425(0x17b),'PS':_0x573425(0x1fd),'KR':_0x573425(0x1bd),'KP':'PRK','TH':_0x573425(0x182),'VN':_0x573425(0x167),'MY':_0x573425(0x228),'SG':_0x573425(0x1b4),'ID':_0x573425(0x1b3),'PH':'PHL','LA':_0x573425(0x191),'KH':_0x573425(0x203),'MM':_0x573425(0x1cf),'BD':'BGD','LK':_0x573425(0x15f),'NP':_0x573425(0x1bf),'BT':_0x573425(0x17f),'MV':_0x573425(0x193),'AF':_0x573425(0x1e0),'PK':'PAK','MN':_0x573425(0x17d)},_0x521689=_0x2bafe3[_0x120af0['toUpperCase']()];if(!_0x521689)return console[_0x573425(0x1b9)]('‚ö†Ô∏è\x20Unknown\x20country\x20code:\x20'+_0x120af0+_0x573425(0x1e3)),_0x573425(0x21c);return _0x521689;}async['createPayment'](_0x143672){const _0x1bed9f=a63_0x1840cf;console[_0x1bed9f(0x1e5)](_0x1bed9f(0x1c3),{'paymentId':_0x143672[_0x1bed9f(0x173)],'amount':_0x143672['amount'],'currency':_0x143672[_0x1bed9f(0x20c)],'customerCountry':_0x143672[_0x1bed9f(0x1d9)]});try{const _0x5a821d={'client_merchant_id':this['CLIENT_MERCHANT_ID'],'payment_method':_0x1bed9f(0x1bb),'client_transaction_id':_0x143672[_0x1bed9f(0x16e)],'amount':_0x143672[_0x1bed9f(0x1f7)],'currency':_0x143672['currency'],'callback_url':_0x1bed9f(0x1fa),'tracker_id':_0x143672[_0x1bed9f(0x173)],'redirect_url':_0x143672[_0x1bed9f(0x1a8)],'failure_url':_0x143672[_0x1bed9f(0x18b)],'customer_first_name':_0x143672[_0x1bed9f(0x1ef)],'customer_last_name':_0x143672[_0x1bed9f(0x18c)],'customer_email':_0x143672[_0x1bed9f(0x205)],'customer_phone':_0x143672['phone']||'','customer_ip':_0x143672['customerIp'],'customer_country':_0x143672['customerCountry'],'api_public_key':this[_0x1bed9f(0x200)]};console['log'](_0x1bed9f(0x190),JSON['stringify'](_0x5a821d,null,0x2));const _0x328232=await fetch(this[_0x1bed9f(0x194)],{'method':_0x1bed9f(0x1f9),'headers':{'Content-Type':_0x1bed9f(0x1d6),'User-Agent':_0x1bed9f(0x1a5)},'body':JSON['stringify'](_0x5a821d)});console[_0x1bed9f(0x1e5)](_0x1bed9f(0x221),_0x328232[_0x1bed9f(0x220)]);const _0x715f4c=await _0x328232['text']();console[_0x1bed9f(0x1e5)](_0x1bed9f(0x19f),_0x715f4c);let _0x45c795;try{_0x45c795=JSON[_0x1bed9f(0x229)](_0x715f4c);}catch(_0x3f0f4d){console['error'](_0x1bed9f(0x1b7),_0x3f0f4d);throw new Error('Invalid\x20JSON\x20response\x20from\x20AmPay\x20TRY:\x20'+_0x715f4c);}console['log'](_0x1bed9f(0x1ca),JSON[_0x1bed9f(0x1bc)](_0x45c795,null,0x2)),loggerService_1[_0x1bed9f(0x1fc)][_0x1bed9f(0x22f)]('ampay-try',_0x45c795,{});if(!_0x328232['ok']){const _0x4a8625=_0x45c795['error_message']||_0x45c795[_0x1bed9f(0x201)]||'HTTP\x20'+_0x328232['status'];console[_0x1bed9f(0x19c)](_0x1bed9f(0x178),_0x4a8625);throw new Error(_0x1bed9f(0x185)+_0x4a8625);}if(!_0x45c795['redirect_url']){console[_0x1bed9f(0x19c)](_0x1bed9f(0x21e),_0x45c795);throw new Error(_0x1bed9f(0x16b));}const _0x4ccd7f={'gateway_payment_id':_0x45c795[_0x1bed9f(0x18e)]||_0x143672[_0x1bed9f(0x16e)],'payment_url':_0x45c795[_0x1bed9f(0x21d)],'transaction_id':_0x45c795[_0x1bed9f(0x21b)]};return console[_0x1bed9f(0x1e5)](_0x1bed9f(0x213),_0x4ccd7f),_0x4ccd7f;}catch(_0x84a3ff){console[_0x1bed9f(0x19c)](_0x1bed9f(0x218),_0x84a3ff),loggerService_1['loggerService'][_0x1bed9f(0x1f4)]('ampay-try',_0x84a3ff,_0x143672);throw _0x84a3ff;}}async[a63_0x1840cf(0x169)](_0x59f109){const _0x5d4571=a63_0x1840cf;try{const {orderId:_0x11466e,amount:_0x1a25f1,currency:_0x3cb2e5,firstName:_0x5bdd8a,lastName:_0x2bfa91,email:_0x2fb4d7,phone:_0x255563,customerIp:_0x2b5c64,customerCountry:_0x31e3ed,successUrl:_0x12f83a,failureUrl:_0x4c3009}=_0x59f109;console[_0x5d4571(0x1e5)](_0x5d4571(0x1a9)),console[_0x5d4571(0x1e5)]('Order\x20ID:',_0x11466e),console['log'](_0x5d4571(0x1c9),_0x1a25f1,_0x3cb2e5),console[_0x5d4571(0x1e5)](_0x5d4571(0x1ab),_0x5bdd8a+'\x20'+_0x2bfa91),console[_0x5d4571(0x1e5)](_0x5d4571(0x175),_0x2fb4d7),console[_0x5d4571(0x1e5)](_0x5d4571(0x1e9),_0x255563||'not\x20provided'),console[_0x5d4571(0x1e5)]('Customer\x20IP:',_0x2b5c64),console['log'](_0x5d4571(0x18f),_0x31e3ed);const _0x1be9cb=this[_0x5d4571(0x1d0)](_0x31e3ed);console[_0x5d4571(0x1e5)]('Customer\x20Country\x20(3-letter):',_0x1be9cb);const _0x51b5b2={'sub_method':_0x5d4571(0x19a),'currency':_0x3cb2e5['toUpperCase'](),'amount':_0x1a25f1,'callback_url':_0x5d4571(0x1fa),'client_merchant_id':this[_0x5d4571(0x1a6)],'client_transaction_id':_0x11466e,'transaction_description':_0x11466e,'customer':{'ip':_0x2b5c64,'email':_0x2fb4d7,'full_name':_0x5bdd8a+'\x20'+_0x2bfa91,'phone':_0x255563||'','country':_0x1be9cb},'success_redirect_url':_0x12f83a,'error_redirect_url':_0x4c3009};console['log'](_0x5d4571(0x19b),JSON[_0x5d4571(0x1bc)](_0x51b5b2,null,0x2));const _0x2d8384=await fetch(this[_0x5d4571(0x194)]+_0x5d4571(0x16c),{'method':'POST','headers':{'Content-Type':_0x5d4571(0x1d6),'User-Agent':_0x5d4571(0x20e)},'body':JSON[_0x5d4571(0x1bc)](_0x51b5b2)}),_0x153a44=await _0x2d8384['text']();console['log'](_0x5d4571(0x195),_0x153a44);if(!_0x2d8384['ok'])throw new Error(_0x5d4571(0x1f6)+_0x2d8384[_0x5d4571(0x220)]+'\x20-\x20'+_0x153a44);let _0x23e390;try{_0x23e390=JSON[_0x5d4571(0x229)](_0x153a44);}catch(_0x126d68){throw new Error(_0x5d4571(0x1ec)+_0x153a44);}console[_0x5d4571(0x1e5)](_0x5d4571(0x1b8),JSON[_0x5d4571(0x1bc)](_0x23e390,null,0x2));if(!_0x23e390['redirect_url'])throw new Error('AmPay\x20TRY\x20payment\x20creation\x20failed:\x20'+(_0x23e390[_0x5d4571(0x1e6)]||_0x23e390['message']||'Unknown\x20error'));const _0x328a87=_0x23e390[_0x5d4571(0x21d)],_0x14611a=_0x23e390[_0x5d4571(0x18e)],_0x3bbc99=_0x23e390[_0x5d4571(0x209)];return console[_0x5d4571(0x1e5)](_0x5d4571(0x1dd)),console[_0x5d4571(0x1e5)](_0x5d4571(0x164),_0x328a87),console[_0x5d4571(0x1e5)](_0x5d4571(0x165),_0x14611a),console[_0x5d4571(0x1e5)]('Tracker\x20ID:',_0x3bbc99),console['log'](_0x5d4571(0x1f1),_0x23e390[_0x5d4571(0x220)]),console[_0x5d4571(0x1e5)](_0x5d4571(0x215)),{'gateway_payment_id':_0x14611a||_0x3bbc99||_0x11466e,'payment_url':_0x328a87||'','transaction_id':_0x14611a};}catch(_0x502fb7){console[_0x5d4571(0x19c)](_0x5d4571(0x218),_0x502fb7),console[_0x5d4571(0x1e5)](_0x5d4571(0x163)),loggerService_1[_0x5d4571(0x1fc)][_0x5d4571(0x1f4)]('ampay-try',_0x502fb7,_0x59f109);throw _0x502fb7;}}async[a63_0x1840cf(0x1a4)](_0x5231ce){const _0x42edbc=a63_0x1840cf;console[_0x42edbc(0x1e5)](_0x42edbc(0x192),_0x5231ce);try{const _0x8da93={'client_merchant_id':this['CLIENT_MERCHANT_ID'],'system_id':_0x5231ce,'api_public_key':this[_0x42edbc(0x200)]},_0x2dd5bf=await fetch(this['apiUrl']+'/status',{'method':_0x42edbc(0x1f9),'headers':{'Content-Type':_0x42edbc(0x1d6),'User-Agent':_0x42edbc(0x1a5)},'body':JSON[_0x42edbc(0x1bc)](_0x8da93)}),_0x4ac38b=await _0x2dd5bf[_0x42edbc(0x1f2)]();console['log'](_0x42edbc(0x22a),_0x4ac38b);let _0x448fa8;try{_0x448fa8=JSON[_0x42edbc(0x229)](_0x4ac38b);}catch(_0x5c801f){return console[_0x42edbc(0x19c)](_0x42edbc(0x1cd),_0x5c801f),{'status':_0x42edbc(0x17a)};}console[_0x42edbc(0x1e5)](_0x42edbc(0x208),JSON[_0x42edbc(0x1bc)](_0x448fa8,null,0x2));let _0x4cc372=_0x42edbc(0x1c0);if(_0x448fa8[_0x42edbc(0x220)])switch(_0x448fa8[_0x42edbc(0x220)]['toLowerCase']()){case _0x42edbc(0x19d):case _0x42edbc(0x1a3):case _0x42edbc(0x16d):_0x4cc372=_0x42edbc(0x1c6);break;case _0x42edbc(0x1ae):case _0x42edbc(0x19c):case _0x42edbc(0x1cb):_0x4cc372=_0x42edbc(0x17a);break;case _0x42edbc(0x1eb):case'timeout':_0x4cc372=_0x42edbc(0x1b1);break;case _0x42edbc(0x22d):case _0x42edbc(0x18d):case'waiting':default:_0x4cc372=_0x42edbc(0x1c0);break;}return{'status':_0x4cc372,'amount':_0x448fa8['amount'],'currency':_0x448fa8[_0x42edbc(0x20c)]};}catch(_0xbdffcc){return console[_0x42edbc(0x19c)](_0x42edbc(0x214),_0xbdffcc),{'status':'FAILED'};}}async['processWebhook'](_0x5f3157){const _0x5e8d3f=a63_0x1840cf;console[_0x5e8d3f(0x1e5)]('üì•\x20Processing\x20AmPay\x20TRY\x20webhook:',JSON[_0x5e8d3f(0x1bc)](_0x5f3157,null,0x2));try{const _0x22f0ea=_0x5f3157[_0x5e8d3f(0x209)]||_0x5f3157[_0x5e8d3f(0x21b)]||_0x5f3157['system_id'];if(!_0x22f0ea){console[_0x5e8d3f(0x19c)](_0x5e8d3f(0x16f));throw new Error(_0x5e8d3f(0x20b));}let _0x2936fb=_0x5e8d3f(0x1c0);if(_0x5f3157[_0x5e8d3f(0x220)])switch(_0x5f3157[_0x5e8d3f(0x220)][_0x5e8d3f(0x1fb)]()){case _0x5e8d3f(0x19d):case'completed':case _0x5e8d3f(0x16d):_0x2936fb=_0x5e8d3f(0x1c6);break;case'failed':case _0x5e8d3f(0x19c):case _0x5e8d3f(0x1cb):_0x2936fb=_0x5e8d3f(0x17a);break;case _0x5e8d3f(0x1eb):case _0x5e8d3f(0x1e1):_0x2936fb='EXPIRED';break;case'pending':case'processing':case _0x5e8d3f(0x162):default:_0x2936fb=_0x5e8d3f(0x1c0);break;}return console['log'](_0x5e8d3f(0x181)+_0x22f0ea+_0x5e8d3f(0x1f8)+_0x2936fb),{'paymentId':_0x22f0ea,'status':_0x2936fb,'amount':_0x5f3157['amount'],'currency':_0x5f3157[_0x5e8d3f(0x20c)]||'TRY'};}catch(_0x2008e0){console[_0x5e8d3f(0x19c)](_0x5e8d3f(0x20a),_0x2008e0);throw _0x2008e0;}}['verifyWebhookSignature'](_0x17523f,_0x51cce){const _0x2060ea=a63_0x1840cf;return console[_0x2060ea(0x1e5)](_0x2060ea(0x1df)),!![];}}exports['AmPayTRYService']=AmPayTRYService;