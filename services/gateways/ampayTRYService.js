'use strict';const a53_0x1d0836=a53_0x2f69;function a53_0x2a5a(){const _0x11a064=['Tracker\x20ID:','HTTP\x20','PENDING','phone','BIH','üìä\x20AmPay\x20TRY\x20webhook\x20processed:\x20','client_transaction_id','TKM','DNK','58b59ccbc03dcdcfc20d830edfba765dbf9f3531c692533d84b17938e9c40bda','üì•\x20Processing\x20AmPay\x20TRY\x20webhook:','MEX','üöÄ\x20Creating\x20AmPay\x20TRY\x20payment\x20request:','JPN','SMR','PRT','AUS','TZA','PAK','SYC','ampay.php','KWT','SGP','üìù\x20Logging\x20AmPay\x20TRY\x20payment\x20creation\x20event...','AmPay\x20TRY\x20payment\x20creation\x20failed:\x20','IRQ','YEM','tracker_id','GEO','toUpperCase','ZMB','stringify','AmPay\x20TRY\x20API\x20error:\x20','VAT','MDV','GAM','üìù\x20Logging\x20AmPay\x20TRY\x20payment\x20creation\x20failure...','JOR','USA','‚ùå\x20No\x20payment\x20ID\x20found\x20in\x20AmPay\x20TRY\x20webhook\x20data','MUS','CAN','DEU','pending','createPaymentLink','SWE','‚ùå\x20AmPay\x20TRY\x20status\x20check\x20failed:','VEN','customerCountry','lastName','System\x20ID:','BLR','SVK','4585095kfemIk','completed','ZWE','SUR','system_id','KOR','KHM','POL','not\x20provided','amount','KAZ','üìù\x20AmPay\x20TRY\x20API\x20raw\x20response:','redirect_url','LUX','ITA','declined','24oIJoBR','ampay-try','5RzkgGV','üáπüá∑\x20AmPay\x20TRY\x20service\x20initialized\x20with\x20IBAN\x20Bank\x20Transfer\x20TR\x20processing','MCO','POST','FLK','TUR','a5a059aa63392e571341bddc5148a5db66643722e9a6bf16a9395fb690a80288931d5a1180a85a28eb9f6516cf61dfc1bf4e37898f3a35261cd2db88888d3815','üìä\x20AmPay\x20TRY\x20status\x20response:','‚ö†Ô∏è\x20Unknown\x20country\x20code:\x20','paid','OMN','parse','paymentId','üì§\x20AmPay\x20TRY\x20request\x20body:','processWebhook','AND','text','\x20->\x20','MDA','logWebhookReceived','GRC','üáπüá∑\x20Creating\x20AmPay\x20TRY\x20payment\x20link...','firstName','üîê\x20AmPay\x20TRY\x20webhook\x20signature\x20verification\x20not\x20implemented\x20yet','MMR','Bank\x20Transfer\x20TR','Unknown\x20error','URY','Customer\x20Country\x20(3-letter):','https://traffer.uk/gateway/ampay-try/webhook.php','üìù\x20AmPay\x20TRY\x20status\x20raw\x20response:','üìä\x20AmPay\x20TRY\x20parsed\x20response:','warn','failed','https://traffer.uk/gateway/ampay-try/','ZAF','‚ùå\x20Failed\x20to\x20parse\x20AmPay\x20TRY\x20API\x20response:','XKX','QAT','FRA','status','1271628gLPncT','NOR','‚ùå\x20Failed\x20to\x20parse\x20AmPay\x20TRY\x20status\x20response:','UKR','timeout','BRA','toLowerCase','convert2LetterTo3LetterCountryCode','FAILED','error_message','Email:','/status','customerIp','NPL','BHR','CHL','TRAFFER','BGD','ESP','EST','AmPay\x20TRY\x20API\x20error:\x20HTTP\x20','LKA','error','‚ùå\x20AmPay\x20TRY\x20webhook\x20processing\x20failed:','CYP','‚úÖ\x20AmPay\x20TRY\x20payment\x20created\x20successfully:','SYR','application/json','Amount:','MNG','1986838fYupEA','MWI','KEN','üîç\x20Checking\x20AmPay\x20TRY\x20payment\x20status\x20for:','currency','AFG','log','üì°\x20AmPay\x20TRY\x20API\x20response\x20status:','PRK','\x20-\x20','TrapayEnd/1.0','PRY','960184ydzQCU','EXPIRED','CHE','ROU','NGA','KGZ','No\x20payment\x20ID\x20in\x20webhook\x20data','Customer\x20IP:','message','Status:','processing','‚ùå\x20AmPay\x20TRY\x20payment\x20creation\x20failed:','MOZ','üì§\x20AmPay\x20TRY\x20API\x20request\x20data:','waiting','API_PRIVATE_KEY','üìä\x20AmPay\x20TRY\x20response\x20data:','loggerService','PAID','BTN','724466LDNJBj','144102raalWr','successUrl','BGR','orderId','Invalid\x20JSON\x20response\x20from\x20AmPay\x20TRY:\x20','ISL','apiUrl','AZE','TRY','ISR','verifyWebhookSignature','GUY','createPayment','CLIENT_MERCHANT_ID','ALB','GHA','üì•\x20AmPay\x20TRY\x20raw\x20response:','REU','Customer:','Phone:','FIN','email','ECU','RUS','LVA','checkPaymentStatus','CHN','24091110rDTKWu','failureUrl','__esModule','API_PUBLIC_KEY','../loggerService','logWebhookError','GBR','Customer\x20Country\x20(2-letter):','MLT','HRV','Payment\x20URL:','PER'];a53_0x2a5a=function(){return _0x11a064;};return a53_0x2a5a();}(function(_0x4022dc,_0x57b43b){const _0x178b05=a53_0x2f69,_0x387655=_0x4022dc();while(!![]){try{const _0xc149c4=parseInt(_0x178b05(0x1a3))/0x1+-parseInt(_0x178b05(0x1a4))/0x2+parseInt(_0x178b05(0x12a))/0x3+parseInt(_0x178b05(0x18f))/0x4*(parseInt(_0x178b05(0x13c))/0x5)+parseInt(_0x178b05(0x165))/0x6+-parseInt(_0x178b05(0x183))/0x7*(-parseInt(_0x178b05(0x13a))/0x8)+-parseInt(_0x178b05(0xe9))/0x9;if(_0xc149c4===_0x57b43b)break;else _0x387655['push'](_0x387655['shift']());}catch(_0x36c3b3){_0x387655['push'](_0x387655['shift']());}}}(a53_0x2a5a,0xc5234));Object['defineProperty'](exports,a53_0x1d0836(0xeb),{'value':!![]}),exports['AmPayTRYService']=void 0x0;const loggerService_1=require(a53_0x1d0836(0xed));function a53_0x2f69(_0x4634a2,_0x204d26){_0x4634a2=_0x4634a2-0xd2;const _0x2a5ad9=a53_0x2a5a();let _0x2f695d=_0x2a5ad9[_0x4634a2];return _0x2f695d;}class AmPayTRYService{constructor(){const _0x54d6f0=a53_0x1d0836;this[_0x54d6f0(0xdb)]=_0x54d6f0(0x175),this['API_PUBLIC_KEY']=_0x54d6f0(0xfe),this[_0x54d6f0(0x19e)]=_0x54d6f0(0x142),this[_0x54d6f0(0xd4)]=_0x54d6f0(0x15e),console['log'](_0x54d6f0(0x13d));}[a53_0x1d0836(0x16c)](_0x5f446d){const _0x4c1453=a53_0x1d0836,_0x3c8278={'AD':_0x4c1453(0x14b),'AL':_0x4c1453(0xdc),'AT':'AUT','BA':_0x4c1453(0xf9),'BE':'BEL','BG':_0x4c1453(0x1a6),'BY':_0x4c1453(0x128),'CH':_0x4c1453(0x191),'CY':_0x4c1453(0x17d),'CZ':'CZE','DE':_0x4c1453(0x11f),'DK':_0x4c1453(0xfd),'EE':_0x4c1453(0x178),'ES':_0x4c1453(0x177),'FI':_0x4c1453(0xe2),'FR':_0x4c1453(0x163),'GB':_0x4c1453(0xef),'GE':_0x4c1453(0x111),'GR':_0x4c1453(0x150),'HR':_0x4c1453(0xf2),'HU':'HUN','IE':'IRL','IS':_0x4c1453(0xd3),'IT':_0x4c1453(0x138),'LI':'LIE','LT':'LTU','LU':_0x4c1453(0x137),'LV':_0x4c1453(0xe6),'MC':_0x4c1453(0x13e),'MD':_0x4c1453(0x14e),'ME':'MNE','MK':'MKD','MT':_0x4c1453(0xf1),'NL':'NLD','NO':_0x4c1453(0x166),'PL':_0x4c1453(0x131),'PT':_0x4c1453(0x104),'RO':_0x4c1453(0x192),'RS':'SRB','RU':_0x4c1453(0xe5),'SE':_0x4c1453(0x122),'SI':'SVN','SK':_0x4c1453(0x129),'SM':_0x4c1453(0x103),'UA':_0x4c1453(0x168),'VA':_0x4c1453(0x116),'XK':_0x4c1453(0x161),'AM':'ARM','AZ':_0x4c1453(0xd5),'KZ':_0x4c1453(0x134),'KG':_0x4c1453(0x194),'TJ':'TJK','TM':_0x4c1453(0xfc),'UZ':'UZB','US':_0x4c1453(0x11b),'CA':_0x4c1453(0x11e),'AU':_0x4c1453(0x105),'JP':_0x4c1453(0x102),'CN':_0x4c1453(0xe8),'IN':'IND','BR':_0x4c1453(0x16a),'MX':_0x4c1453(0x100),'AR':'ARG','CL':_0x4c1453(0x174),'PE':_0x4c1453(0xf4),'CO':'COL','VE':_0x4c1453(0x124),'EC':_0x4c1453(0xe4),'BO':'BOL','PY':_0x4c1453(0x18e),'UY':_0x4c1453(0x157),'SR':_0x4c1453(0x12d),'GY':_0x4c1453(0xd9),'FK':_0x4c1453(0x140),'ZA':_0x4c1453(0x15f),'EG':'EGY','NG':_0x4c1453(0x193),'KE':_0x4c1453(0x185),'GH':_0x4c1453(0xdd),'TZ':_0x4c1453(0x106),'UG':'UGA','ZW':_0x4c1453(0x12c),'ZM':_0x4c1453(0x113),'MW':_0x4c1453(0x184),'MZ':_0x4c1453(0x19b),'MG':'MDG','MU':_0x4c1453(0x11d),'SC':_0x4c1453(0x108),'RE':_0x4c1453(0xdf),'TR':_0x4c1453(0x141),'IR':'IRN','IQ':_0x4c1453(0x10e),'SA':'SAU','AE':'ARE','KW':_0x4c1453(0x10a),'QA':_0x4c1453(0x162),'BH':_0x4c1453(0x173),'OM':_0x4c1453(0x146),'YE':_0x4c1453(0x10f),'JO':_0x4c1453(0x11a),'LB':'LBN','SY':_0x4c1453(0x17f),'IL':_0x4c1453(0xd7),'PS':'PSE','KR':_0x4c1453(0x12f),'KP':_0x4c1453(0x18b),'TH':'THA','VN':'VNM','MY':'MYS','SG':_0x4c1453(0x10b),'ID':'IDN','PH':'PHL','LA':'LAO','KH':_0x4c1453(0x130),'MM':_0x4c1453(0x154),'BD':_0x4c1453(0x176),'LK':_0x4c1453(0x17a),'NP':_0x4c1453(0x172),'BT':_0x4c1453(0x1a2),'MV':_0x4c1453(0x117),'AF':_0x4c1453(0x188),'PK':_0x4c1453(0x107),'MN':_0x4c1453(0x182)},_0x310d77=_0x3c8278[_0x5f446d[_0x4c1453(0x112)]()];if(!_0x310d77)return console[_0x4c1453(0x15c)](_0x4c1453(0x144)+_0x5f446d+',\x20using\x20TUR\x20as\x20fallback\x20for\x20AmPay\x20TRY'),_0x4c1453(0x141);return _0x310d77;}async[a53_0x1d0836(0xda)](_0x15cd74){const _0x454f15=a53_0x1d0836;console[_0x454f15(0x189)](_0x454f15(0x101),{'paymentId':_0x15cd74[_0x454f15(0x148)],'amount':_0x15cd74[_0x454f15(0x133)],'currency':_0x15cd74[_0x454f15(0x187)],'customerCountry':_0x15cd74['customerCountry']});try{const _0x30ddeb={'client_merchant_id':this[_0x454f15(0xdb)],'payment_method':_0x454f15(0x155),'client_transaction_id':_0x15cd74[_0x454f15(0x1a7)],'amount':_0x15cd74[_0x454f15(0x133)],'currency':_0x15cd74[_0x454f15(0x187)],'callback_url':_0x454f15(0x159),'tracker_id':_0x15cd74[_0x454f15(0x148)],'redirect_url':_0x15cd74[_0x454f15(0x1a5)],'failure_url':_0x15cd74[_0x454f15(0xea)],'customer_first_name':_0x15cd74[_0x454f15(0x152)],'customer_last_name':_0x15cd74[_0x454f15(0x126)],'customer_email':_0x15cd74[_0x454f15(0xe3)],'customer_phone':_0x15cd74[_0x454f15(0xf8)]||'','customer_ip':_0x15cd74[_0x454f15(0x171)],'customer_country':_0x15cd74[_0x454f15(0x125)],'api_public_key':this[_0x454f15(0xec)]};console[_0x454f15(0x189)](_0x454f15(0x19c),JSON[_0x454f15(0x114)](_0x30ddeb,null,0x2));const _0x5a721d=await fetch(this[_0x454f15(0xd4)],{'method':_0x454f15(0x13f),'headers':{'Content-Type':_0x454f15(0x180),'User-Agent':'TrapayEnd/1.0'},'body':JSON['stringify'](_0x30ddeb)});console[_0x454f15(0x189)](_0x454f15(0x18a),_0x5a721d[_0x454f15(0x164)]);const _0x3cc8f8=await _0x5a721d[_0x454f15(0x14c)]();console[_0x454f15(0x189)](_0x454f15(0x135),_0x3cc8f8);let _0x153db5;try{_0x153db5=JSON['parse'](_0x3cc8f8);}catch(_0x25acd0){console['error'](_0x454f15(0x160),_0x25acd0);throw new Error('Invalid\x20JSON\x20response\x20from\x20AmPay\x20TRY:\x20'+_0x3cc8f8);}console[_0x454f15(0x189)](_0x454f15(0x15b),JSON['stringify'](_0x153db5,null,0x2)),loggerService_1['loggerService'][_0x454f15(0x14f)](_0x454f15(0x13b),_0x153db5,{});if(!_0x5a721d['ok']){const _0x282159=_0x153db5['error_message']||_0x153db5[_0x454f15(0x197)]||_0x454f15(0xf6)+_0x5a721d[_0x454f15(0x164)];console['error']('‚ùå\x20AmPay\x20TRY\x20API\x20error:',_0x282159);throw new Error(_0x454f15(0x115)+_0x282159);}if(!_0x153db5[_0x454f15(0x136)]){console['error']('‚ùå\x20No\x20redirect_url\x20in\x20AmPay\x20TRY\x20response:',_0x153db5);throw new Error('AmPay\x20TRY\x20did\x20not\x20return\x20a\x20payment\x20URL');}const _0x413729={'gateway_payment_id':_0x153db5[_0x454f15(0x12e)]||_0x15cd74[_0x454f15(0x1a7)],'payment_url':_0x153db5[_0x454f15(0x136)],'transaction_id':_0x153db5[_0x454f15(0xfb)]};return console[_0x454f15(0x189)](_0x454f15(0x17e),_0x413729),_0x413729;}catch(_0x20bfbb){console[_0x454f15(0x17b)](_0x454f15(0x19a),_0x20bfbb),loggerService_1[_0x454f15(0x1a0)][_0x454f15(0xee)](_0x454f15(0x13b),_0x20bfbb,_0x15cd74);throw _0x20bfbb;}}async[a53_0x1d0836(0x121)](_0x100211){const _0x11f1f4=a53_0x1d0836;try{const {orderId:_0x5207ea,amount:_0x1f6177,currency:_0x4fbdfc,firstName:_0x4eb287,lastName:_0x206c93,email:_0x19fa5f,phone:_0x33aa24,customerIp:_0x3e23fc,customerCountry:_0xde5daf,successUrl:_0x35bdc9,failureUrl:_0x143427}=_0x100211;console['log'](_0x11f1f4(0x151)),console[_0x11f1f4(0x189)]('Order\x20ID:',_0x5207ea),console[_0x11f1f4(0x189)](_0x11f1f4(0x181),_0x1f6177,_0x4fbdfc),console['log'](_0x11f1f4(0xe0),_0x4eb287+'\x20'+_0x206c93),console['log'](_0x11f1f4(0x16f),_0x19fa5f),console[_0x11f1f4(0x189)](_0x11f1f4(0xe1),_0x33aa24||_0x11f1f4(0x132)),console[_0x11f1f4(0x189)](_0x11f1f4(0x196),_0x3e23fc),console[_0x11f1f4(0x189)](_0x11f1f4(0xf0),_0xde5daf);const _0x3e9dd1=this[_0x11f1f4(0x16c)](_0xde5daf);console['log'](_0x11f1f4(0x158),_0x3e9dd1);const _0x5dbcf0={'sub_method':_0x11f1f4(0x118),'currency':_0x4fbdfc[_0x11f1f4(0x112)](),'amount':_0x1f6177,'callback_url':_0x11f1f4(0x159),'client_merchant_id':this[_0x11f1f4(0xdb)],'client_transaction_id':_0x5207ea,'transaction_description':_0x5207ea,'customer':{'ip':_0x3e23fc,'email':_0x19fa5f,'full_name':_0x4eb287+'\x20'+_0x206c93,'phone':_0x33aa24||'','country':_0x3e9dd1},'success_redirect_url':_0x35bdc9,'error_redirect_url':_0x143427};console[_0x11f1f4(0x189)](_0x11f1f4(0x149),JSON[_0x11f1f4(0x114)](_0x5dbcf0,null,0x2));const _0x31f6cb=await fetch(this[_0x11f1f4(0xd4)]+_0x11f1f4(0x109),{'method':'POST','headers':{'Content-Type':_0x11f1f4(0x180),'User-Agent':'TrapayAPI/1.0'},'body':JSON['stringify'](_0x5dbcf0)}),_0x4732af=await _0x31f6cb['text']();console[_0x11f1f4(0x189)](_0x11f1f4(0xde),_0x4732af);if(!_0x31f6cb['ok'])throw new Error(_0x11f1f4(0x179)+_0x31f6cb[_0x11f1f4(0x164)]+_0x11f1f4(0x18c)+_0x4732af);let _0xcbffb6;try{_0xcbffb6=JSON[_0x11f1f4(0x147)](_0x4732af);}catch(_0x458032){throw new Error(_0x11f1f4(0xd2)+_0x4732af);}console[_0x11f1f4(0x189)](_0x11f1f4(0x19f),JSON[_0x11f1f4(0x114)](_0xcbffb6,null,0x2));if(!_0xcbffb6[_0x11f1f4(0x136)])throw new Error(_0x11f1f4(0x10d)+(_0xcbffb6[_0x11f1f4(0x16e)]||_0xcbffb6[_0x11f1f4(0x197)]||_0x11f1f4(0x156)));const _0x2dc132=_0xcbffb6['redirect_url'],_0x515edb=_0xcbffb6[_0x11f1f4(0x12e)],_0x44bf88=_0xcbffb6[_0x11f1f4(0x110)];return console['log']('‚úÖ\x20AmPay\x20TRY\x20payment\x20link\x20created\x20successfully'),console[_0x11f1f4(0x189)](_0x11f1f4(0xf3),_0x2dc132),console[_0x11f1f4(0x189)](_0x11f1f4(0x127),_0x515edb),console[_0x11f1f4(0x189)](_0x11f1f4(0xf5),_0x44bf88),console[_0x11f1f4(0x189)](_0x11f1f4(0x198),_0xcbffb6[_0x11f1f4(0x164)]),console['log'](_0x11f1f4(0x10c)),{'gateway_payment_id':_0x515edb||_0x44bf88||_0x5207ea,'payment_url':_0x2dc132||'','transaction_id':_0x515edb};}catch(_0x497c12){console[_0x11f1f4(0x17b)]('‚ùå\x20AmPay\x20TRY\x20payment\x20creation\x20failed:',_0x497c12),console['log'](_0x11f1f4(0x119)),loggerService_1[_0x11f1f4(0x1a0)][_0x11f1f4(0xee)](_0x11f1f4(0x13b),_0x497c12,_0x100211);throw _0x497c12;}}async[a53_0x1d0836(0xe7)](_0x1f9cdc){const _0x2dda4a=a53_0x1d0836;console['log'](_0x2dda4a(0x186),_0x1f9cdc);try{const _0x17ae86={'client_merchant_id':this[_0x2dda4a(0xdb)],'system_id':_0x1f9cdc,'api_public_key':this[_0x2dda4a(0xec)]},_0x568012=await fetch(this[_0x2dda4a(0xd4)]+_0x2dda4a(0x170),{'method':_0x2dda4a(0x13f),'headers':{'Content-Type':_0x2dda4a(0x180),'User-Agent':_0x2dda4a(0x18d)},'body':JSON[_0x2dda4a(0x114)](_0x17ae86)}),_0x2862fc=await _0x568012['text']();console[_0x2dda4a(0x189)](_0x2dda4a(0x15a),_0x2862fc);let _0x5ef3b0;try{_0x5ef3b0=JSON['parse'](_0x2862fc);}catch(_0x29fa4b){return console[_0x2dda4a(0x17b)](_0x2dda4a(0x167),_0x29fa4b),{'status':_0x2dda4a(0x16d)};}console[_0x2dda4a(0x189)](_0x2dda4a(0x143),JSON['stringify'](_0x5ef3b0,null,0x2));let _0x51fe5f=_0x2dda4a(0xf7);if(_0x5ef3b0['status'])switch(_0x5ef3b0[_0x2dda4a(0x164)][_0x2dda4a(0x16b)]()){case'success':case _0x2dda4a(0x12b):case'paid':_0x51fe5f='PAID';break;case _0x2dda4a(0x15d):case _0x2dda4a(0x17b):case _0x2dda4a(0x139):_0x51fe5f='FAILED';break;case'expired':case _0x2dda4a(0x169):_0x51fe5f=_0x2dda4a(0x190);break;case _0x2dda4a(0x120):case'processing':case'waiting':default:_0x51fe5f='PENDING';break;}return{'status':_0x51fe5f,'amount':_0x5ef3b0['amount'],'currency':_0x5ef3b0[_0x2dda4a(0x187)]};}catch(_0x27f4ee){return console['error'](_0x2dda4a(0x123),_0x27f4ee),{'status':_0x2dda4a(0x16d)};}}async[a53_0x1d0836(0x14a)](_0x309444){const _0x3701ef=a53_0x1d0836;console[_0x3701ef(0x189)](_0x3701ef(0xff),JSON[_0x3701ef(0x114)](_0x309444,null,0x2));try{const _0x8fac43=_0x309444[_0x3701ef(0x110)]||_0x309444[_0x3701ef(0xfb)]||_0x309444['system_id'];if(!_0x8fac43){console['error'](_0x3701ef(0x11c));throw new Error(_0x3701ef(0x195));}let _0x3a7dea=_0x3701ef(0xf7);if(_0x309444[_0x3701ef(0x164)])switch(_0x309444[_0x3701ef(0x164)][_0x3701ef(0x16b)]()){case'success':case'completed':case _0x3701ef(0x145):_0x3a7dea=_0x3701ef(0x1a1);break;case _0x3701ef(0x15d):case'error':case'declined':_0x3a7dea=_0x3701ef(0x16d);break;case'expired':case'timeout':_0x3a7dea=_0x3701ef(0x190);break;case _0x3701ef(0x120):case _0x3701ef(0x199):case _0x3701ef(0x19d):default:_0x3a7dea=_0x3701ef(0xf7);break;}return console[_0x3701ef(0x189)](_0x3701ef(0xfa)+_0x8fac43+_0x3701ef(0x14d)+_0x3a7dea),{'paymentId':_0x8fac43,'status':_0x3a7dea,'amount':_0x309444[_0x3701ef(0x133)],'currency':_0x309444['currency']||_0x3701ef(0xd6)};}catch(_0x50525f){console[_0x3701ef(0x17b)](_0x3701ef(0x17c),_0x50525f);throw _0x50525f;}}[a53_0x1d0836(0xd8)](_0x39c4e1,_0x5db8dc){const _0x42de13=a53_0x1d0836;return console[_0x42de13(0x189)](_0x42de13(0x153)),!![];}}exports['AmPayTRYService']=AmPayTRYService;