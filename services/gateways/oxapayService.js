'use strict';const a73_0x167ec4=a73_0x6143;(function(_0xbbbe63,_0x1efbf1){const _0x45be7b=a73_0x6143,_0x1427bf=_0xbbbe63();while(!![]){try{const _0x2ff3e2=parseInt(_0x45be7b(0x126))/0x1*(-parseInt(_0x45be7b(0x104))/0x2)+-parseInt(_0x45be7b(0xff))/0x3+-parseInt(_0x45be7b(0x12c))/0x4+parseInt(_0x45be7b(0x111))/0x5+parseInt(_0x45be7b(0xf3))/0x6*(-parseInt(_0x45be7b(0x117))/0x7)+parseInt(_0x45be7b(0xf8))/0x8+parseInt(_0x45be7b(0x108))/0x9;if(_0x2ff3e2===_0x1efbf1)break;else _0x1427bf['push'](_0x1427bf['shift']());}catch(_0x5ec522){_0x1427bf['push'](_0x1427bf['shift']());}}}(a73_0x2a4b,0x60f0f));function a73_0x2a4b(){const _0xa3c696=['rate','3612uWwBXQ','pay_currency','Network:','logWhiteDomainError','14458950oBNcFH','https://app.trapay.uk/payment/','parse','URL:','Parsed\x20Result:','Response\x20data:','Incomplete\x20response:\x20missing\x20track_id\x20or\x20address','address','‚ö†Ô∏è\x20OXAPAY_API_KEY\x20not\x20found\x20in\x20environment\x20variables','107355xbsVAp','PROCESSING','Amount:','===\x20OXAPAY\x20REQUEST\x20ERROR\x20===','===\x20PARSED\x20OXAPAY\x20RESPONSE\x20===','oxapayService','2940371JwcQoo','Missing\x20track_id\x20or\x20address\x20in\x20response','expired','WCXQ21-DL5OZP-H3SSHH-4GVAR4','__esModule','new','waiting','Status:','error','currency','defineProperty','under_paid_coverage','log','apiKey','apiUrl','398ZyKtYR','paying','text','Order\x20#','Unknown\x20error\x20from\x20OxaPay\x20API','paymentId','371788pxYrnP','fee_paid_by_payer','toLowerCase','===\x20OXAPAY\x20SUCCESS\x20===','now','underpaid','/payment/white-label','logWhiteDomainRequest','lifetime','POST','PAID','Error\x20Message:','getPaymentStatusFromCallback','statusText','data','Request\x20Body:','Response\x20Time:','paid','stringify','track_id','EXPIRED','===\x20OXAPAY\x20API\x20ERROR\x20===','../loggerService','Invalid\x20JSON\x20response\x20from\x20OxaPay\x20API:\x20','refunding','API\x20Error:\x20','expired_at','qr_code','loggerService','network','üí∞\x20OxaPay\x20service\x20initialized','oxapay','refunded','OxaPay\x20API\x20key\x20is\x20not\x20configured','JSON\x20Parse\x20Error:\x20','6vRiexh','OxaPay\x20API\x20error:\x20','warn','PENDING','status','1552312bOYCpW','Error:','===\x20OXAPAY\x20API\x20INCOMPLETE\x20RESPONSE\x20===','Track\x20ID:','REFUND','message','OxaPayService','579603FJlFlD','Error\x20Details:','Raw\x20Response\x20Body:','pay_amount'];a73_0x2a4b=function(){return _0xa3c696;};return a73_0x2a4b();}function a73_0x6143(_0x1b1187,_0x13c596){_0x1b1187=_0x1b1187-0xd6;const _0x2a4be6=a73_0x2a4b();let _0x61438c=_0x2a4be6[_0x1b1187];return _0x61438c;}Object[a73_0x167ec4(0x121)](exports,a73_0x167ec4(0x11b),{'value':!![]}),exports[a73_0x167ec4(0x116)]=exports[a73_0x167ec4(0xfe)]=void 0x0;const loggerService_1=require(a73_0x167ec4(0xe6));class OxaPayService{constructor(){const _0x8be853=a73_0x167ec4;this['apiUrl']='https://api.oxapay.com/v1/payment/white-label',this['apiKey']=process.env.OXAPAY_API_KEY||_0x8be853(0x11a),!this[_0x8be853(0x124)]?console[_0x8be853(0xf5)](_0x8be853(0x110)):console[_0x8be853(0x123)](_0x8be853(0xee));}async['createPayment'](_0x13f3f2){const _0x9e5412=a73_0x167ec4,{orderId:_0x3ec4a5,amount:_0x3714d4,currency:_0x581c20,payCurrency:_0x5be4e3,network:_0x5b3b46,description:_0x4b55ed,customerEmail:_0x91c6a2,lifetime:_0x57a387,feePaidByPayer:_0x94cf6,underPaidCoverage:_0x2b86aa}=_0x13f3f2;if(!this[_0x9e5412(0x124)])throw new Error(_0x9e5412(0xf1));const _0x861d64={'amount':_0x3714d4,'currency':_0x581c20[_0x9e5412(0x12e)](),'callback_url':'https://api.trapay.uk/api/oxapay/callback','order_id':_0x3ec4a5,'description':_0x4b55ed||_0x9e5412(0x129)+_0x3ec4a5};_0x5be4e3&&(_0x861d64[_0x9e5412(0x105)]=_0x5be4e3['toLowerCase']());_0x5b3b46&&(_0x861d64[_0x9e5412(0xed)]=_0x5b3b46);_0x91c6a2&&(_0x861d64['email']=_0x91c6a2);_0x57a387!==undefined?_0x861d64[_0x9e5412(0xd8)]=_0x57a387:_0x861d64['lifetime']=0x3c;_0x94cf6!==undefined&&(_0x861d64[_0x9e5412(0x12d)]=_0x94cf6);_0x2b86aa!==undefined&&(_0x861d64[_0x9e5412(0x122)]=_0x2b86aa);const _0x185230=Date[_0x9e5412(0x130)]();try{console[_0x9e5412(0x123)]('===\x20OXAPAY\x20API\x20REQUEST\x20==='),console[_0x9e5412(0x123)](_0x9e5412(0x10b),this[_0x9e5412(0x125)]),console[_0x9e5412(0x123)](_0x9e5412(0xdf),JSON['stringify'](_0x861d64,null,0x2)),loggerService_1['loggerService'][_0x9e5412(0xd7)](_0x9e5412(0xef),_0x9e5412(0xd6),_0x9e5412(0xd9),_0x861d64);const _0x2dbc6c=await fetch(this[_0x9e5412(0x125)],{'method':_0x9e5412(0xd9),'headers':{'Content-Type':'application/json','merchant_api_key':this[_0x9e5412(0x124)]},'body':JSON[_0x9e5412(0xe2)](_0x861d64)}),_0x37501e=Date[_0x9e5412(0x130)]()-_0x185230;console[_0x9e5412(0x123)]('===\x20OXAPAY\x20API\x20RESPONSE\x20==='),console[_0x9e5412(0x123)](_0x9e5412(0x11e),_0x2dbc6c[_0x9e5412(0xf7)]),console['log']('Status\x20Text:',_0x2dbc6c[_0x9e5412(0xdd)]),console['log'](_0x9e5412(0xe0),_0x37501e+'ms');const _0x5b7d27=await _0x2dbc6c[_0x9e5412(0x128)]();console[_0x9e5412(0x123)](_0x9e5412(0x101),_0x5b7d27);let _0x2d0c39;try{_0x2d0c39=JSON[_0x9e5412(0x10a)](_0x5b7d27);}catch(_0xbb279b){console[_0x9e5412(0x11f)]('Failed\x20to\x20parse\x20JSON\x20response:',_0xbb279b),loggerService_1[_0x9e5412(0xec)][_0x9e5412(0x107)](_0x9e5412(0xef),_0x9e5412(0xd6),_0x9e5412(0xf2)+_0xbb279b);throw new Error(_0x9e5412(0xe7)+_0x5b7d27);}console['log'](_0x9e5412(0x115)),console['log'](_0x9e5412(0x10c),JSON[_0x9e5412(0xe2)](_0x2d0c39,null,0x2)),loggerService_1[_0x9e5412(0xec)]['logWhiteDomainResponse'](_0x9e5412(0xef),_0x9e5412(0xd6),_0x2dbc6c[_0x9e5412(0xf7)],_0x2d0c39,_0x37501e);if(_0x2d0c39[_0x9e5412(0xf7)]!==0xc8||!_0x2d0c39[_0x9e5412(0xde)]){const _0x79f27b=_0x2d0c39['error']?.[_0x9e5412(0xfd)]||_0x2d0c39[_0x9e5412(0xfd)]||_0x9e5412(0x12a);console[_0x9e5412(0x11f)](_0x9e5412(0xe5)),console[_0x9e5412(0x11f)](_0x9e5412(0xdb),_0x79f27b),console[_0x9e5412(0x11f)](_0x9e5412(0x100),_0x2d0c39['error']),loggerService_1[_0x9e5412(0xec)]['logWhiteDomainError'](_0x9e5412(0xef),_0x9e5412(0xd6),_0x9e5412(0xe9)+_0x79f27b);throw new Error(_0x9e5412(0xf4)+_0x79f27b);}if(!_0x2d0c39[_0x9e5412(0xde)][_0x9e5412(0xe3)]||!_0x2d0c39['data'][_0x9e5412(0x10f)]){console[_0x9e5412(0x11f)](_0x9e5412(0xfa)),console[_0x9e5412(0x11f)](_0x9e5412(0x118)),console[_0x9e5412(0x11f)](_0x9e5412(0x10d),_0x2d0c39[_0x9e5412(0xde)]),loggerService_1[_0x9e5412(0xec)][_0x9e5412(0x107)](_0x9e5412(0xef),_0x9e5412(0xd6),_0x9e5412(0x10e));throw new Error('Invalid\x20response\x20from\x20OxaPay\x20API:\x20missing\x20track_id\x20or\x20address');}console[_0x9e5412(0x123)](_0x9e5412(0x12f)),console[_0x9e5412(0x123)](_0x9e5412(0xfb),_0x2d0c39[_0x9e5412(0xde)][_0x9e5412(0xe3)]),console['log']('Address:',_0x2d0c39[_0x9e5412(0xde)][_0x9e5412(0x10f)]),console[_0x9e5412(0x123)](_0x9e5412(0x113),_0x2d0c39[_0x9e5412(0xde)]['pay_amount'],_0x2d0c39[_0x9e5412(0xde)][_0x9e5412(0x105)]),console['log'](_0x9e5412(0x106),_0x2d0c39[_0x9e5412(0xde)][_0x9e5412(0xed)]);const _0x19139c=_0x9e5412(0x109)+_0x13f3f2[_0x9e5412(0x12b)];return{'gateway_payment_id':_0x2d0c39[_0x9e5412(0xde)][_0x9e5412(0xe3)],'payment_url':_0x19139c,'track_id':_0x2d0c39['data']['track_id'],'amount':_0x2d0c39[_0x9e5412(0xde)]['amount'],'currency':_0x2d0c39[_0x9e5412(0xde)][_0x9e5412(0x120)],'pay_amount':_0x2d0c39[_0x9e5412(0xde)][_0x9e5412(0x102)],'pay_currency':_0x2d0c39[_0x9e5412(0xde)][_0x9e5412(0x105)],'network':_0x2d0c39[_0x9e5412(0xde)][_0x9e5412(0xed)],'address':_0x2d0c39['data'][_0x9e5412(0x10f)],'qr_code':_0x2d0c39['data'][_0x9e5412(0xeb)],'rate':_0x2d0c39[_0x9e5412(0xde)][_0x9e5412(0x103)],'expired_at':_0x2d0c39['data'][_0x9e5412(0xea)]};}catch(_0x43cd29){console[_0x9e5412(0x11f)](_0x9e5412(0x114)),console[_0x9e5412(0x11f)](_0x9e5412(0xf9),_0x43cd29),loggerService_1[_0x9e5412(0xec)][_0x9e5412(0x107)](_0x9e5412(0xef),_0x9e5412(0xd6),_0x43cd29 instanceof Error?_0x43cd29[_0x9e5412(0xfd)]:String(_0x43cd29));throw _0x43cd29;}}[a73_0x167ec4(0xdc)](_0x46786c){const _0x1955ad=a73_0x167ec4;switch(_0x46786c[_0x1955ad(0x12e)]()){case _0x1955ad(0x11c):return _0x1955ad(0xf6);case _0x1955ad(0x11d):return _0x1955ad(0xf6);case _0x1955ad(0x127):return _0x1955ad(0x112);case _0x1955ad(0xe1):return _0x1955ad(0xda);case'manual_accept':return'PAID';case _0x1955ad(0x131):return _0x1955ad(0xda);case _0x1955ad(0xe8):return _0x1955ad(0xfc);case _0x1955ad(0xf0):return _0x1955ad(0xfc);case _0x1955ad(0x119):return _0x1955ad(0xe4);default:return _0x1955ad(0xf6);}}}exports['OxaPayService']=OxaPayService,exports[a73_0x167ec4(0x116)]=new OxaPayService();