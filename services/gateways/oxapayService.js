'use strict';const a73_0x354ea8=a73_0x345b;(function(_0x5b296d,_0x26d449){const _0x4e692b=a73_0x345b,_0x1ac7cf=_0x5b296d();while(!![]){try{const _0x231f0d=-parseInt(_0x4e692b(0x154))/0x1*(parseInt(_0x4e692b(0x128))/0x2)+parseInt(_0x4e692b(0x138))/0x3+-parseInt(_0x4e692b(0x119))/0x4*(-parseInt(_0x4e692b(0x158))/0x5)+parseInt(_0x4e692b(0x15f))/0x6*(-parseInt(_0x4e692b(0x15c))/0x7)+-parseInt(_0x4e692b(0x12b))/0x8*(parseInt(_0x4e692b(0x15a))/0x9)+-parseInt(_0x4e692b(0x10d))/0xa+-parseInt(_0x4e692b(0x152))/0xb*(-parseInt(_0x4e692b(0x14c))/0xc);if(_0x231f0d===_0x26d449)break;else _0x1ac7cf['push'](_0x1ac7cf['shift']());}catch(_0x10c04e){_0x1ac7cf['push'](_0x1ac7cf['shift']());}}}(a73_0x426e,0x5f100));function a73_0x426e(){const _0x19d174=['1525383IQcfsw','===\x20OXAPAY\x20API\x20RESPONSE\x20===','Status:','Unknown\x20error\x20from\x20OxaPay\x20API','Error\x20Message:','../loggerService','/payment/white-label','refunding','PROCESSING','üí∞\x20OxaPay\x20service\x20initialized','Track\x20ID:','message','logWhiteDomainError','network','WCXQ21-DL5OZP-H3SSHH-4GVAR4','===\x20OXAPAY\x20SUCCESS\x20===','email','currency','data','Raw\x20Response\x20Body:','8585292KeRlxv','status','track_id','https://api.trapay.uk/api/oxapay/callback','pay_amount','Error:','22vxSLaY','lifetime','47ZlkGAg','Request\x20Body:','Address:','loggerService','40VsHjli','Order\x20#','333RXFynH','Response\x20data:','294rPCYNr','POST','warn','62958aHpzgZ','paying','waiting','oxapayService','4373860PgRpaT','Response\x20Time:','pay_currency','REFUND','PENDING','OxaPayService','getPaymentStatusFromCallback','apiUrl','OxaPay\x20API\x20error:\x20','under_paid_coverage','JSON\x20Parse\x20Error:\x20','createPayment','107948CnPidh','text','https://app.trapay.uk/payment/','Invalid\x20response\x20from\x20OxaPay\x20API:\x20missing\x20track_id\x20or\x20address','===\x20OXAPAY\x20REQUEST\x20ERROR\x20===','API\x20Error:\x20','‚ö†Ô∏è\x20OXAPAY_API_KEY\x20not\x20found\x20in\x20environment\x20variables','Incomplete\x20response:\x20missing\x20track_id\x20or\x20address','apiKey','stringify','OxaPay\x20API\x20key\x20is\x20not\x20configured','defineProperty','===\x20OXAPAY\x20API\x20REQUEST\x20===','application/json','log','32714OrvVXx','new','paid','25728FCFRmE','===\x20OXAPAY\x20API\x20INCOMPLETE\x20RESPONSE\x20===','rate','now','amount','===\x20PARSED\x20OXAPAY\x20RESPONSE\x20===','Failed\x20to\x20parse\x20JSON\x20response:','https://api.oxapay.com/v1/payment/white-label','address','oxapay','Parsed\x20Result:','error','PAID'];a73_0x426e=function(){return _0x19d174;};return a73_0x426e();}function a73_0x345b(_0xcb33c9,_0x4132b9){_0xcb33c9=_0xcb33c9-0x10c;const _0x426edf=a73_0x426e();let _0x345b9d=_0x426edf[_0xcb33c9];return _0x345b9d;}Object[a73_0x354ea8(0x124)](exports,'__esModule',{'value':!![]}),exports[a73_0x354ea8(0x10c)]=exports[a73_0x354ea8(0x112)]=void 0x0;const loggerService_1=require(a73_0x354ea8(0x13d));class OxaPayService{constructor(){const _0x46b199=a73_0x354ea8;this[_0x46b199(0x114)]=_0x46b199(0x132),this[_0x46b199(0x121)]=process.env.OXAPAY_API_KEY||_0x46b199(0x146),!this[_0x46b199(0x121)]?console[_0x46b199(0x15e)](_0x46b199(0x11f)):console[_0x46b199(0x127)](_0x46b199(0x141));}async[a73_0x354ea8(0x118)](_0x37c417){const _0x32de26=a73_0x354ea8,{orderId:_0x46701d,amount:_0x3230ae,currency:_0x2c558a,payCurrency:_0x295dcd,network:_0x46080c,description:_0x53017b,customerEmail:_0x49b264,lifetime:_0x13fc8f,feePaidByPayer:_0x223945,underPaidCoverage:_0x3cac2a}=_0x37c417;if(!this[_0x32de26(0x121)])throw new Error(_0x32de26(0x123));const _0xf57aa6={'amount':_0x3230ae,'currency':_0x2c558a['toLowerCase'](),'callback_url':_0x32de26(0x14f),'order_id':_0x46701d,'description':_0x53017b||_0x32de26(0x159)+_0x46701d};_0x295dcd&&(_0xf57aa6[_0x32de26(0x10f)]=_0x295dcd['toLowerCase']());_0x46080c&&(_0xf57aa6[_0x32de26(0x145)]=_0x46080c);_0x49b264&&(_0xf57aa6[_0x32de26(0x148)]=_0x49b264);_0x13fc8f!==undefined?_0xf57aa6[_0x32de26(0x153)]=_0x13fc8f:_0xf57aa6[_0x32de26(0x153)]=0x3c;_0x223945!==undefined&&(_0xf57aa6['fee_paid_by_payer']=_0x223945);_0x3cac2a!==undefined&&(_0xf57aa6[_0x32de26(0x116)]=_0x3cac2a);const _0x3a6c02=Date[_0x32de26(0x12e)]();try{console[_0x32de26(0x127)](_0x32de26(0x125)),console['log']('URL:',this[_0x32de26(0x114)]),console['log'](_0x32de26(0x155),JSON[_0x32de26(0x122)](_0xf57aa6,null,0x2)),loggerService_1[_0x32de26(0x157)]['logWhiteDomainRequest'](_0x32de26(0x134),_0x32de26(0x13e),_0x32de26(0x15d),_0xf57aa6);const _0x3bc3e6=await fetch(this[_0x32de26(0x114)],{'method':_0x32de26(0x15d),'headers':{'Content-Type':_0x32de26(0x126),'merchant_api_key':this[_0x32de26(0x121)]},'body':JSON[_0x32de26(0x122)](_0xf57aa6)}),_0x2e07e4=Date[_0x32de26(0x12e)]()-_0x3a6c02;console['log'](_0x32de26(0x139)),console[_0x32de26(0x127)](_0x32de26(0x13a),_0x3bc3e6[_0x32de26(0x14d)]),console['log']('Status\x20Text:',_0x3bc3e6['statusText']),console['log'](_0x32de26(0x10e),_0x2e07e4+'ms');const _0x4553be=await _0x3bc3e6[_0x32de26(0x11a)]();console[_0x32de26(0x127)](_0x32de26(0x14b),_0x4553be);let _0xf0cb63;try{_0xf0cb63=JSON['parse'](_0x4553be);}catch(_0x3e9568){console['error'](_0x32de26(0x131),_0x3e9568),loggerService_1['loggerService'][_0x32de26(0x144)](_0x32de26(0x134),'/payment/white-label',_0x32de26(0x117)+_0x3e9568);throw new Error('Invalid\x20JSON\x20response\x20from\x20OxaPay\x20API:\x20'+_0x4553be);}console[_0x32de26(0x127)](_0x32de26(0x130)),console[_0x32de26(0x127)](_0x32de26(0x135),JSON[_0x32de26(0x122)](_0xf0cb63,null,0x2)),loggerService_1['loggerService']['logWhiteDomainResponse']('oxapay',_0x32de26(0x13e),_0x3bc3e6['status'],_0xf0cb63,_0x2e07e4);if(_0xf0cb63[_0x32de26(0x14d)]!==0xc8||!_0xf0cb63[_0x32de26(0x14a)]){const _0x20c927=_0xf0cb63[_0x32de26(0x136)]?.[_0x32de26(0x143)]||_0xf0cb63[_0x32de26(0x143)]||_0x32de26(0x13b);console[_0x32de26(0x136)]('===\x20OXAPAY\x20API\x20ERROR\x20==='),console['error'](_0x32de26(0x13c),_0x20c927),console['error']('Error\x20Details:',_0xf0cb63[_0x32de26(0x136)]),loggerService_1[_0x32de26(0x157)][_0x32de26(0x144)](_0x32de26(0x134),'/payment/white-label',_0x32de26(0x11e)+_0x20c927);throw new Error(_0x32de26(0x115)+_0x20c927);}if(!_0xf0cb63[_0x32de26(0x14a)]['track_id']||!_0xf0cb63[_0x32de26(0x14a)][_0x32de26(0x133)]){console['error'](_0x32de26(0x12c)),console['error']('Missing\x20track_id\x20or\x20address\x20in\x20response'),console['error'](_0x32de26(0x15b),_0xf0cb63['data']),loggerService_1[_0x32de26(0x157)][_0x32de26(0x144)](_0x32de26(0x134),_0x32de26(0x13e),_0x32de26(0x120));throw new Error(_0x32de26(0x11c));}console[_0x32de26(0x127)](_0x32de26(0x147)),console[_0x32de26(0x127)](_0x32de26(0x142),_0xf0cb63[_0x32de26(0x14a)][_0x32de26(0x14e)]),console['log'](_0x32de26(0x156),_0xf0cb63['data']['address']),console[_0x32de26(0x127)]('Amount:',_0xf0cb63['data']['pay_amount'],_0xf0cb63[_0x32de26(0x14a)][_0x32de26(0x10f)]),console['log']('Network:',_0xf0cb63['data']['network']);const _0x41a194=_0x32de26(0x11b)+_0x37c417['paymentId'];return{'gateway_payment_id':_0xf0cb63['data'][_0x32de26(0x14e)],'payment_url':_0x41a194,'track_id':_0xf0cb63[_0x32de26(0x14a)]['track_id'],'amount':_0xf0cb63['data'][_0x32de26(0x12f)],'currency':_0xf0cb63[_0x32de26(0x14a)][_0x32de26(0x149)],'pay_amount':_0xf0cb63['data'][_0x32de26(0x150)],'pay_currency':_0xf0cb63[_0x32de26(0x14a)][_0x32de26(0x10f)],'network':_0xf0cb63[_0x32de26(0x14a)][_0x32de26(0x145)],'address':_0xf0cb63[_0x32de26(0x14a)][_0x32de26(0x133)],'qr_code':_0xf0cb63[_0x32de26(0x14a)]['qr_code'],'rate':_0xf0cb63[_0x32de26(0x14a)][_0x32de26(0x12d)],'expired_at':_0xf0cb63[_0x32de26(0x14a)]['expired_at']};}catch(_0x2c3e99){console['error'](_0x32de26(0x11d)),console['error'](_0x32de26(0x151),_0x2c3e99),loggerService_1['loggerService']['logWhiteDomainError'](_0x32de26(0x134),'/payment/white-label',_0x2c3e99 instanceof Error?_0x2c3e99['message']:String(_0x2c3e99));throw _0x2c3e99;}}[a73_0x354ea8(0x113)](_0x25087c){const _0x4e025a=a73_0x354ea8;switch(_0x25087c['toLowerCase']()){case _0x4e025a(0x129):return _0x4e025a(0x111);case _0x4e025a(0x161):return _0x4e025a(0x111);case _0x4e025a(0x160):return _0x4e025a(0x140);case _0x4e025a(0x12a):return _0x4e025a(0x137);case'manual_accept':return _0x4e025a(0x137);case'underpaid':return'PAID';case _0x4e025a(0x13f):return _0x4e025a(0x110);case'refunded':return _0x4e025a(0x110);case'expired':return'EXPIRED';default:return _0x4e025a(0x111);}}}exports[a73_0x354ea8(0x112)]=OxaPayService,exports[a73_0x354ea8(0x10c)]=new OxaPayService();