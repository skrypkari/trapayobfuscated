'use strict';const a67_0x1973a5=a67_0x39f1;(function(_0x48fd12,_0x29d02e){const _0x3c97a4=a67_0x39f1,_0x3fd2bb=_0x48fd12();while(!![]){try{const _0x316c7b=parseInt(_0x3c97a4(0xbe))/0x1*(-parseInt(_0x3c97a4(0xe5))/0x2)+parseInt(_0x3c97a4(0xbd))/0x3+parseInt(_0x3c97a4(0xa0))/0x4*(-parseInt(_0x3c97a4(0xc9))/0x5)+-parseInt(_0x3c97a4(0xc8))/0x6*(parseInt(_0x3c97a4(0xe6))/0x7)+parseInt(_0x3c97a4(0xca))/0x8*(parseInt(_0x3c97a4(0xc4))/0x9)+-parseInt(_0x3c97a4(0xac))/0xa*(parseInt(_0x3c97a4(0xb4))/0xb)+parseInt(_0x3c97a4(0xe7))/0xc;if(_0x316c7b===_0x29d02e)break;else _0x3fd2bb['push'](_0x3fd2bb['shift']());}catch(_0x5b237d){_0x3fd2bb['push'](_0x3fd2bb['shift']());}}}(a67_0x38c5,0x9e4c8));Object[a67_0x1973a5(0xed)](exports,a67_0x1973a5(0xb0),{'value':!![]}),exports[a67_0x1973a5(0xb9)]=exports['OxaPayService']=void 0x0;const loggerService_1=require(a67_0x1973a5(0xf3));class OxaPayService{constructor(){const _0x116b1b=a67_0x1973a5;this['apiUrl']=_0x116b1b(0xc2),this[_0x116b1b(0xd1)]=process.env.OXAPAY_API_KEY||_0x116b1b(0xb5),!this[_0x116b1b(0xd1)]?console[_0x116b1b(0xe8)]('‚ö†Ô∏è\x20OXAPAY_API_KEY\x20not\x20found\x20in\x20environment\x20variables'):console[_0x116b1b(0xcf)](_0x116b1b(0xda));}async['createPayment'](_0x35c859){const _0x16c168=a67_0x1973a5,{orderId:_0x481728,amount:_0x2042e7,currency:_0x165a7c,payCurrency:_0x893388,network:_0x1ee6a3,description:_0x495483,customerEmail:_0x10101c,lifetime:_0x131b9c,feePaidByPayer:_0x52a52f,underPaidCoverage:_0xbecbf5}=_0x35c859;if(!this['apiKey'])throw new Error(_0x16c168(0xaa));const _0x4aef15={'amount':_0x2042e7,'currency':_0x165a7c[_0x16c168(0xe2)](),'callback_url':_0x16c168(0xcb),'order_id':_0x481728,'description':_0x495483||'Order\x20#'+_0x481728};_0x893388&&(_0x4aef15[_0x16c168(0xa8)]=_0x893388[_0x16c168(0xe2)]());_0x1ee6a3&&(_0x4aef15[_0x16c168(0xb1)]=_0x1ee6a3);_0x10101c&&(_0x4aef15[_0x16c168(0xd6)]=_0x10101c);_0x131b9c!==undefined?_0x4aef15['lifetime']=_0x131b9c:_0x4aef15[_0x16c168(0xbb)]=0x3c;_0x52a52f!==undefined&&(_0x4aef15[_0x16c168(0xe1)]=_0x52a52f);_0xbecbf5!==undefined&&(_0x4aef15['under_paid_coverage']=_0xbecbf5);const _0x3d44d9=Date['now']();try{console[_0x16c168(0xcf)](_0x16c168(0xbc)),console[_0x16c168(0xcf)]('URL:',this[_0x16c168(0xbf)]),console[_0x16c168(0xcf)](_0x16c168(0xa9),JSON[_0x16c168(0xc5)](_0x4aef15,null,0x2)),loggerService_1['loggerService'][_0x16c168(0xf4)](_0x16c168(0xcc),_0x16c168(0xdc),_0x16c168(0xce),_0x4aef15);const _0x2d96a3=await fetch(this[_0x16c168(0xbf)],{'method':_0x16c168(0xce),'headers':{'Content-Type':'application/json','merchant_api_key':this[_0x16c168(0xd1)]},'body':JSON[_0x16c168(0xc5)](_0x4aef15)}),_0x2b7e73=Date['now']()-_0x3d44d9;console['log'](_0x16c168(0xdf)),console['log'](_0x16c168(0xeb),_0x2d96a3[_0x16c168(0xaf)]),console[_0x16c168(0xcf)]('Status\x20Text:',_0x2d96a3[_0x16c168(0xa1)]),console[_0x16c168(0xcf)](_0x16c168(0xe0),_0x2b7e73+'ms');const _0x5c10f5=await _0x2d96a3[_0x16c168(0xf0)]();console[_0x16c168(0xcf)]('Raw\x20Response\x20Body:',_0x5c10f5);let _0x5f1af1;try{_0x5f1af1=JSON['parse'](_0x5c10f5);}catch(_0x55f83c){console[_0x16c168(0xba)](_0x16c168(0xe4),_0x55f83c),loggerService_1['loggerService'][_0x16c168(0xd7)](_0x16c168(0xcc),_0x16c168(0xdc),_0x16c168(0xd0)+_0x55f83c);throw new Error('Invalid\x20JSON\x20response\x20from\x20OxaPay\x20API:\x20'+_0x5c10f5);}console[_0x16c168(0xcf)](_0x16c168(0xee)),console[_0x16c168(0xcf)](_0x16c168(0xb2),JSON[_0x16c168(0xc5)](_0x5f1af1,null,0x2)),loggerService_1[_0x16c168(0xf1)][_0x16c168(0xa5)](_0x16c168(0xcc),_0x16c168(0xdc),_0x2d96a3[_0x16c168(0xaf)],_0x5f1af1,_0x2b7e73);if(_0x5f1af1[_0x16c168(0xaf)]!==0xc8||!_0x5f1af1[_0x16c168(0xa2)]){const _0x2cf3db=_0x5f1af1['error']?.[_0x16c168(0xa7)]||_0x5f1af1[_0x16c168(0xa7)]||'Unknown\x20error\x20from\x20OxaPay\x20API';console[_0x16c168(0xba)](_0x16c168(0xc1)),console[_0x16c168(0xba)](_0x16c168(0xb8),_0x2cf3db),console[_0x16c168(0xba)](_0x16c168(0xa3),_0x5f1af1['error']),loggerService_1[_0x16c168(0xf1)][_0x16c168(0xd7)]('oxapay',_0x16c168(0xdc),_0x16c168(0xad)+_0x2cf3db);throw new Error(_0x16c168(0xae)+_0x2cf3db);}if(!_0x5f1af1[_0x16c168(0xa2)][_0x16c168(0xc6)]||!_0x5f1af1[_0x16c168(0xa2)][_0x16c168(0xd4)]){console['error'](_0x16c168(0xf2)),console['error'](_0x16c168(0xdb)),console[_0x16c168(0xba)](_0x16c168(0xc3),_0x5f1af1[_0x16c168(0xa2)]),loggerService_1['loggerService']['logWhiteDomainError'](_0x16c168(0xcc),'/payment/white-label',_0x16c168(0xec));throw new Error('Invalid\x20response\x20from\x20OxaPay\x20API:\x20missing\x20track_id\x20or\x20address');}console['log'](_0x16c168(0xea)),console['log'](_0x16c168(0xd2),_0x5f1af1[_0x16c168(0xa2)][_0x16c168(0xc6)]),console[_0x16c168(0xcf)](_0x16c168(0xa6),_0x5f1af1[_0x16c168(0xa2)][_0x16c168(0xd4)]),console[_0x16c168(0xcf)](_0x16c168(0xd3),_0x5f1af1['data'][_0x16c168(0xe3)],_0x5f1af1['data'][_0x16c168(0xa8)]),console[_0x16c168(0xcf)](_0x16c168(0xa4),_0x5f1af1['data'][_0x16c168(0xb1)]);const _0x30ddaa='https://app.trapay.uk/payment/'+_0x35c859['paymentId'];return{'gateway_payment_id':_0x5f1af1[_0x16c168(0xa2)][_0x16c168(0xc6)],'payment_url':_0x30ddaa,'track_id':_0x5f1af1[_0x16c168(0xa2)][_0x16c168(0xc6)],'amount':_0x5f1af1[_0x16c168(0xa2)][_0x16c168(0xd9)],'currency':_0x5f1af1[_0x16c168(0xa2)]['currency'],'pay_amount':_0x5f1af1[_0x16c168(0xa2)][_0x16c168(0xe3)],'pay_currency':_0x5f1af1[_0x16c168(0xa2)][_0x16c168(0xa8)],'network':_0x5f1af1[_0x16c168(0xa2)][_0x16c168(0xb1)],'address':_0x5f1af1['data'][_0x16c168(0xd4)],'qr_code':_0x5f1af1[_0x16c168(0xa2)][_0x16c168(0xef)],'rate':_0x5f1af1[_0x16c168(0xa2)][_0x16c168(0xd8)],'expired_at':_0x5f1af1[_0x16c168(0xa2)][_0x16c168(0xb3)]};}catch(_0xfdce00){console['error']('===\x20OXAPAY\x20REQUEST\x20ERROR\x20==='),console['error']('Error:',_0xfdce00),loggerService_1['loggerService'][_0x16c168(0xd7)]('oxapay',_0x16c168(0xdc),_0xfdce00 instanceof Error?_0xfdce00[_0x16c168(0xa7)]:String(_0xfdce00));throw _0xfdce00;}}[a67_0x1973a5(0xab)](_0x50a47a){const _0xd6f325=a67_0x1973a5;switch(_0x50a47a[_0xd6f325(0xe2)]()){case _0xd6f325(0xe9):return _0xd6f325(0xdd);case'waiting':return _0xd6f325(0xdd);case _0xd6f325(0xc7):return'PROCESSING';case'paid':return'PAID';case _0xd6f325(0xcd):return _0xd6f325(0xb7);case'underpaid':return _0xd6f325(0xb7);case'refunding':return _0xd6f325(0xb6);case'refunded':return _0xd6f325(0xb6);case _0xd6f325(0xd5):return _0xd6f325(0xc0);default:return _0xd6f325(0xdd);}}}exports[a67_0x1973a5(0xde)]=OxaPayService,exports['oxapayService']=new OxaPayService();function a67_0x39f1(_0x57701a,_0x1b0c11){_0x57701a=_0x57701a-0xa0;const _0x38c5a3=a67_0x38c5();let _0x39f1d2=_0x38c5a3[_0x57701a];return _0x39f1d2;}function a67_0x38c5(){const _0x2e1bea=['WCXQ21-DL5OZP-H3SSHH-4GVAR4','REFUND','PAID','Error\x20Message:','oxapayService','error','lifetime','===\x20OXAPAY\x20API\x20REQUEST\x20===','3647697iMKnlZ','1291958nublRj','apiUrl','EXPIRED','===\x20OXAPAY\x20API\x20ERROR\x20===','https://api.oxapay.com/v1/payment/white-label','Response\x20data:','10288701xehqLS','stringify','track_id','paying','298572EwMONX','285wdxrLn','8sRSUnZ','https://api.trapay.uk/api/oxapay/callback','oxapay','manual_accept','POST','log','JSON\x20Parse\x20Error:\x20','apiKey','Track\x20ID:','Amount:','address','expired','email','logWhiteDomainError','rate','amount','üí∞\x20OxaPay\x20service\x20initialized','Missing\x20track_id\x20or\x20address\x20in\x20response','/payment/white-label','PENDING','OxaPayService','===\x20OXAPAY\x20API\x20RESPONSE\x20===','Response\x20Time:','fee_paid_by_payer','toLowerCase','pay_amount','Failed\x20to\x20parse\x20JSON\x20response:','2LXPAgy','119THSKte','14990868DNIulV','warn','new','===\x20OXAPAY\x20SUCCESS\x20===','Status:','Incomplete\x20response:\x20missing\x20track_id\x20or\x20address','defineProperty','===\x20PARSED\x20OXAPAY\x20RESPONSE\x20===','qr_code','text','loggerService','===\x20OXAPAY\x20API\x20INCOMPLETE\x20RESPONSE\x20===','../loggerService','logWhiteDomainRequest','44924YwRyTa','statusText','data','Error\x20Details:','Network:','logWhiteDomainResponse','Address:','message','pay_currency','Request\x20Body:','OxaPay\x20API\x20key\x20is\x20not\x20configured','getPaymentStatusFromCallback','1818560zIdECV','API\x20Error:\x20','OxaPay\x20API\x20error:\x20','status','__esModule','network','Parsed\x20Result:','expired_at','11BnZejb'];a67_0x38c5=function(){return _0x2e1bea;};return a67_0x38c5();}