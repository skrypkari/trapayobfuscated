'use strict';const a67_0x327b38=a67_0x20a1;(function(_0x127fd8,_0x3d6d28){const _0x2ba821=a67_0x20a1,_0x34ae38=_0x127fd8();while(!![]){try{const _0x3fec16=parseInt(_0x2ba821(0xf2))/0x1*(parseInt(_0x2ba821(0xda))/0x2)+-parseInt(_0x2ba821(0xa1))/0x3+parseInt(_0x2ba821(0xdd))/0x4+parseInt(_0x2ba821(0xee))/0x5+parseInt(_0x2ba821(0xe0))/0x6*(-parseInt(_0x2ba821(0xef))/0x7)+-parseInt(_0x2ba821(0xd1))/0x8+parseInt(_0x2ba821(0xcf))/0x9*(-parseInt(_0x2ba821(0xd7))/0xa);if(_0x3fec16===_0x3d6d28)break;else _0x34ae38['push'](_0x34ae38['shift']());}catch(_0x328aaa){_0x34ae38['push'](_0x34ae38['shift']());}}}(a67_0x10c9,0xf0d5b));Object[a67_0x327b38(0xea)](exports,a67_0x327b38(0x9f),{'value':!![]}),exports[a67_0x327b38(0xb5)]=exports[a67_0x327b38(0xb2)]=void 0x0;const loggerService_1=require('../loggerService');class OxaPayService{constructor(){const _0x274582=a67_0x327b38;this[_0x274582(0xe2)]=_0x274582(0xbe),this['apiKey']=process.env.OXAPAY_API_KEY||_0x274582(0xc1),!this[_0x274582(0xe4)]?console[_0x274582(0xa0)](_0x274582(0xa5)):console[_0x274582(0xca)](_0x274582(0xc0));}async[a67_0x327b38(0xad)](_0x57452e){const _0x54b862=a67_0x327b38,{orderId:_0x57b585,amount:_0x39c21e,currency:_0x33859b,payCurrency:_0x3ba9f2,network:_0x483e83,description:_0x5ce7d2,customerEmail:_0x57b52a,lifetime:_0x5f1cf3,feePaidByPayer:_0x332f17,underPaidCoverage:_0x1b7677}=_0x57452e;if(!this[_0x54b862(0xe4)])throw new Error(_0x54b862(0xa9));const _0x57cd6d={'amount':_0x39c21e,'currency':_0x33859b[_0x54b862(0xd4)](),'callback_url':_0x54b862(0xe3),'order_id':_0x57b585,'description':_0x5ce7d2||_0x54b862(0xb3)+_0x57b585};_0x3ba9f2&&(_0x57cd6d[_0x54b862(0xb4)]=_0x3ba9f2['toLowerCase']());_0x483e83&&(_0x57cd6d[_0x54b862(0x9b)]=_0x483e83);_0x57b52a&&(_0x57cd6d[_0x54b862(0xc3)]=_0x57b52a);_0x5f1cf3!==undefined?_0x57cd6d[_0x54b862(0xf5)]=_0x5f1cf3:_0x57cd6d['lifetime']=0x3c;_0x332f17!==undefined&&(_0x57cd6d['fee_paid_by_payer']=_0x332f17);_0x1b7677!==undefined&&(_0x57cd6d['under_paid_coverage']=_0x1b7677);const _0x533784=Date[_0x54b862(0xdc)]();try{console[_0x54b862(0xca)](_0x54b862(0xb6)),console[_0x54b862(0xca)]('URL:',this['apiUrl']),console[_0x54b862(0xca)](_0x54b862(0xb8),JSON['stringify'](_0x57cd6d,null,0x2)),loggerService_1[_0x54b862(0xc4)][_0x54b862(0xb1)]('oxapay',_0x54b862(0xa3),'POST',_0x57cd6d);const _0x3925d6=await fetch(this['apiUrl'],{'method':_0x54b862(0xbd),'headers':{'Content-Type':_0x54b862(0xed),'merchant_api_key':this[_0x54b862(0xe4)]},'body':JSON['stringify'](_0x57cd6d)}),_0x535d15=Date[_0x54b862(0xdc)]()-_0x533784;console[_0x54b862(0xca)](_0x54b862(0xbb)),console['log'](_0x54b862(0xd5),_0x3925d6['status']),console['log']('Status\x20Text:',_0x3925d6[_0x54b862(0xc2)]),console[_0x54b862(0xca)](_0x54b862(0xc5),_0x535d15+'ms');const _0x3addeb=await _0x3925d6[_0x54b862(0x9c)]();console[_0x54b862(0xca)](_0x54b862(0xe7),_0x3addeb);let _0x1ee489;try{_0x1ee489=JSON[_0x54b862(0xba)](_0x3addeb);}catch(_0x5a5451){console['error'](_0x54b862(0xf8),_0x5a5451),loggerService_1[_0x54b862(0xc4)][_0x54b862(0xf6)]('oxapay','/payment/white-label',_0x54b862(0xa2)+_0x5a5451);throw new Error('Invalid\x20JSON\x20response\x20from\x20OxaPay\x20API:\x20'+_0x3addeb);}console[_0x54b862(0xca)](_0x54b862(0xa8)),console[_0x54b862(0xca)](_0x54b862(0xe6),JSON[_0x54b862(0x9e)](_0x1ee489,null,0x2)),loggerService_1[_0x54b862(0xc4)]['logWhiteDomainResponse']('oxapay',_0x54b862(0xa3),_0x3925d6[_0x54b862(0xaf)],_0x1ee489,_0x535d15);if(_0x1ee489[_0x54b862(0xaf)]!==0xc8||!_0x1ee489['data']){const _0x5131dc=_0x1ee489[_0x54b862(0xc7)]?.[_0x54b862(0xe5)]||_0x1ee489['message']||_0x54b862(0xbf);console[_0x54b862(0xc7)](_0x54b862(0xbc)),console['error'](_0x54b862(0xc9),_0x5131dc),console[_0x54b862(0xc7)](_0x54b862(0xe8),_0x1ee489['error']),loggerService_1[_0x54b862(0xc4)][_0x54b862(0xf6)]('oxapay',_0x54b862(0xa3),_0x54b862(0x9d)+_0x5131dc);throw new Error('OxaPay\x20API\x20error:\x20'+_0x5131dc);}if(!_0x1ee489[_0x54b862(0xcd)][_0x54b862(0xd8)]||!_0x1ee489[_0x54b862(0xcd)][_0x54b862(0xf3)]){console[_0x54b862(0xc7)]('===\x20OXAPAY\x20API\x20INCOMPLETE\x20RESPONSE\x20==='),console[_0x54b862(0xc7)]('Missing\x20track_id\x20or\x20address\x20in\x20response'),console[_0x54b862(0xc7)](_0x54b862(0xce),_0x1ee489[_0x54b862(0xcd)]),loggerService_1['loggerService'][_0x54b862(0xf6)](_0x54b862(0xd2),_0x54b862(0xa3),_0x54b862(0xdf));throw new Error(_0x54b862(0xb0));}console['log'](_0x54b862(0xf4)),console[_0x54b862(0xca)](_0x54b862(0xc6),_0x1ee489[_0x54b862(0xcd)][_0x54b862(0xd8)]),console[_0x54b862(0xca)](_0x54b862(0xa6),_0x1ee489['data'][_0x54b862(0xf3)]),console[_0x54b862(0xca)](_0x54b862(0xaa),_0x1ee489[_0x54b862(0xcd)][_0x54b862(0xf0)],_0x1ee489[_0x54b862(0xcd)][_0x54b862(0xb4)]),console['log'](_0x54b862(0xa4),_0x1ee489[_0x54b862(0xcd)][_0x54b862(0x9b)]);const _0x37bc44=_0x54b862(0xc8)+_0x57452e[_0x54b862(0xd6)];return{'gateway_payment_id':_0x1ee489[_0x54b862(0xcd)][_0x54b862(0xd8)],'payment_url':_0x37bc44,'track_id':_0x1ee489['data'][_0x54b862(0xd8)],'amount':_0x1ee489[_0x54b862(0xcd)][_0x54b862(0xcc)],'currency':_0x1ee489['data'][_0x54b862(0xde)],'pay_amount':_0x1ee489[_0x54b862(0xcd)][_0x54b862(0xf0)],'pay_currency':_0x1ee489['data'][_0x54b862(0xb4)],'network':_0x1ee489[_0x54b862(0xcd)][_0x54b862(0x9b)],'address':_0x1ee489[_0x54b862(0xcd)]['address'],'qr_code':_0x1ee489[_0x54b862(0xcd)]['qr_code'],'rate':_0x1ee489[_0x54b862(0xcd)][_0x54b862(0xd9)],'expired_at':_0x1ee489['data']['expired_at']};}catch(_0x185ec2){console[_0x54b862(0xc7)](_0x54b862(0xf7)),console[_0x54b862(0xc7)](_0x54b862(0xec),_0x185ec2),loggerService_1['loggerService']['logWhiteDomainError'](_0x54b862(0xd2),'/payment/white-label',_0x185ec2 instanceof Error?_0x185ec2[_0x54b862(0xe5)]:String(_0x185ec2));throw _0x185ec2;}}[a67_0x327b38(0xb7)](_0x4a6088){const _0x3fbfc7=a67_0x327b38;switch(_0x4a6088['toLowerCase']()){case _0x3fbfc7(0xe9):return _0x3fbfc7(0xae);case _0x3fbfc7(0xeb):return _0x3fbfc7(0xae);case _0x3fbfc7(0xdb):return _0x3fbfc7(0xd0);case'paid':return _0x3fbfc7(0xab);case _0x3fbfc7(0xa7):return _0x3fbfc7(0xab);case _0x3fbfc7(0xcb):return'PAID';case _0x3fbfc7(0xf1):return _0x3fbfc7(0xac);case _0x3fbfc7(0xe1):return _0x3fbfc7(0xac);case _0x3fbfc7(0xb9):return _0x3fbfc7(0xd3);default:return _0x3fbfc7(0xae);}}}function a67_0x20a1(_0x57b671,_0x3159bb){_0x57b671=_0x57b671-0x9b;const _0x10c986=a67_0x10c9();let _0x20a1e5=_0x10c986[_0x57b671];return _0x20a1e5;}function a67_0x10c9(){const _0x6579b4=['waiting','Error:','application/json','5031455hUrUNl','60389damyIW','pay_amount','refunding','1Ztviwa','address','===\x20OXAPAY\x20SUCCESS\x20===','lifetime','logWhiteDomainError','===\x20OXAPAY\x20REQUEST\x20ERROR\x20===','Failed\x20to\x20parse\x20JSON\x20response:','network','text','API\x20Error:\x20','stringify','__esModule','warn','1264269GiMhQp','JSON\x20Parse\x20Error:\x20','/payment/white-label','Network:','‚ö†Ô∏è\x20OXAPAY_API_KEY\x20not\x20found\x20in\x20environment\x20variables','Address:','manual_accept','===\x20PARSED\x20OXAPAY\x20RESPONSE\x20===','OxaPay\x20API\x20key\x20is\x20not\x20configured','Amount:','PAID','REFUND','createPayment','PENDING','status','Invalid\x20response\x20from\x20OxaPay\x20API:\x20missing\x20track_id\x20or\x20address','logWhiteDomainRequest','OxaPayService','Order\x20#','pay_currency','oxapayService','===\x20OXAPAY\x20API\x20REQUEST\x20===','getPaymentStatusFromCallback','Request\x20Body:','expired','parse','===\x20OXAPAY\x20API\x20RESPONSE\x20===','===\x20OXAPAY\x20API\x20ERROR\x20===','POST','https://api.oxapay.com/v1/payment/white-label','Unknown\x20error\x20from\x20OxaPay\x20API','üí∞\x20OxaPay\x20service\x20initialized','WCXQ21-DL5OZP-H3SSHH-4GVAR4','statusText','email','loggerService','Response\x20Time:','Track\x20ID:','error','https://app.trapay.uk/payment/','Error\x20Message:','log','underpaid','amount','data','Response\x20data:','3897JvZlKt','PROCESSING','626016OhjuRV','oxapay','EXPIRED','toLowerCase','Status:','paymentId','10180OWKYUo','track_id','rate','468310XSmaOe','paying','now','3056500ZjQexs','currency','Incomplete\x20response:\x20missing\x20track_id\x20or\x20address','54JpPbHy','refunded','apiUrl','https://api.trapay.uk/api/oxapay/callback','apiKey','message','Parsed\x20Result:','Raw\x20Response\x20Body:','Error\x20Details:','new','defineProperty'];a67_0x10c9=function(){return _0x6579b4;};return a67_0x10c9();}exports[a67_0x327b38(0xb2)]=OxaPayService,exports[a67_0x327b38(0xb5)]=new OxaPayService();