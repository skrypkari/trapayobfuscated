'use strict';const a73_0x3920a6=a73_0x4f59;(function(_0x2e3a74,_0x3fc8f2){const _0x29acc5=a73_0x4f59,_0x31b179=_0x2e3a74();while(!![]){try{const _0x5d9894=-parseInt(_0x29acc5(0x1ad))/0x1+-parseInt(_0x29acc5(0x1b2))/0x2+parseInt(_0x29acc5(0x1e9))/0x3+-parseInt(_0x29acc5(0x19c))/0x4+parseInt(_0x29acc5(0x1c6))/0x5+-parseInt(_0x29acc5(0x1c2))/0x6*(-parseInt(_0x29acc5(0x1cd))/0x7)+-parseInt(_0x29acc5(0x1a2))/0x8*(parseInt(_0x29acc5(0x1cb))/0x9);if(_0x5d9894===_0x3fc8f2)break;else _0x31b179['push'](_0x31b179['shift']());}catch(_0x4c4e52){_0x31b179['push'](_0x31b179['shift']());}}}(a73_0x294c,0xb0464));Object['defineProperty'](exports,a73_0x3920a6(0x1a3),{'value':!![]}),exports[a73_0x3920a6(0x1e7)]=exports[a73_0x3920a6(0x19d)]=void 0x0;function a73_0x294c(){const _0x1dba3a=['toLowerCase','REFUND','2876404UVxJGm','OxaPayService','underpaid','Status:','status','===\x20PARSED\x20OXAPAY\x20RESPONSE\x20===','2216ZdEihw','__esModule','manual_accept','logWhiteDomainRequest','OxaPay\x20API\x20key\x20is\x20not\x20configured','oxapay','===\x20OXAPAY\x20API\x20RESPONSE\x20===','paid','pay_currency','under_paid_coverage','Status\x20Text:','235844GRNIfa','PENDING','https://api.oxapay.com/v1/payment/white-label','paying','amount','2817834JmJlbS','===\x20OXAPAY\x20SUCCESS\x20===','refunded','now','Response\x20data:','network','apiKey','paymentId','/payment/white-label','POST','OxaPay\x20API\x20error:\x20','PAID','data','waiting','Order\x20#','Raw\x20Response\x20Body:','30LQgRuW','apiUrl','Invalid\x20JSON\x20response\x20from\x20OxaPay\x20API:\x20','pay_amount','5142635KqRWVu','Unknown\x20error\x20from\x20OxaPay\x20API','üí∞\x20OxaPay\x20service\x20initialized','expired','https://app.trapay.uk/payment/','5193yGFEMH','message','1592661IFiMkH','address','warn','Parsed\x20Result:','createPayment','https://api.trapay.uk/api/oxapay/callback','Response\x20Time:','===\x20OXAPAY\x20API\x20ERROR\x20===','===\x20OXAPAY\x20API\x20REQUEST\x20===','Error\x20Details:','log','Track\x20ID:','loggerService','track_id','logWhiteDomainError','===\x20OXAPAY\x20API\x20INCOMPLETE\x20RESPONSE\x20===','logWhiteDomainResponse','API\x20Error:\x20','WCXQ21-DL5OZP-H3SSHH-4GVAR4','stringify','lifetime','fee_paid_by_payer','rate','Address:','text','JSON\x20Parse\x20Error:\x20','oxapayService','Incomplete\x20response:\x20missing\x20track_id\x20or\x20address','3238707vWDqam','error','parse','qr_code','Invalid\x20response\x20from\x20OxaPay\x20API:\x20missing\x20track_id\x20or\x20address','EXPIRED','PROCESSING','Amount:','refunding'];a73_0x294c=function(){return _0x1dba3a;};return a73_0x294c();}const loggerService_1=require('../loggerService');function a73_0x4f59(_0x43203c,_0x8b7ad9){_0x43203c=_0x43203c-0x198;const _0x294cd2=a73_0x294c();let _0x4f59e4=_0x294cd2[_0x43203c];return _0x4f59e4;}class OxaPayService{constructor(){const _0x448128=a73_0x3920a6;this[_0x448128(0x1c3)]=_0x448128(0x1af),this[_0x448128(0x1b8)]=process.env.OXAPAY_API_KEY||_0x448128(0x1df),!this['apiKey']?console[_0x448128(0x1cf)]('‚ö†Ô∏è\x20OXAPAY_API_KEY\x20not\x20found\x20in\x20environment\x20variables'):console['log'](_0x448128(0x1c8));}async[a73_0x3920a6(0x1d1)](_0x27f11d){const _0x23ba5e=a73_0x3920a6,{orderId:_0x440c02,amount:_0x4e73ba,currency:_0x539f81,payCurrency:_0x122fe4,network:_0x241154,description:_0x4afb8a,customerEmail:_0x4aac4d,lifetime:_0x3aa706,feePaidByPayer:_0x285d85,underPaidCoverage:_0x24f16b}=_0x27f11d;if(!this[_0x23ba5e(0x1b8)])throw new Error(_0x23ba5e(0x1a6));const _0x58fd6d={'amount':_0x4e73ba,'currency':_0x539f81[_0x23ba5e(0x19a)](),'callback_url':_0x23ba5e(0x1d2),'order_id':_0x440c02,'description':_0x4afb8a||_0x23ba5e(0x1c0)+_0x440c02};_0x122fe4&&(_0x58fd6d[_0x23ba5e(0x1aa)]=_0x122fe4['toLowerCase']());_0x241154&&(_0x58fd6d['network']=_0x241154);_0x4aac4d&&(_0x58fd6d['email']=_0x4aac4d);_0x3aa706!==undefined?_0x58fd6d[_0x23ba5e(0x1e1)]=_0x3aa706:_0x58fd6d[_0x23ba5e(0x1e1)]=0x3c;_0x285d85!==undefined&&(_0x58fd6d[_0x23ba5e(0x1e2)]=_0x285d85);_0x24f16b!==undefined&&(_0x58fd6d[_0x23ba5e(0x1ab)]=_0x24f16b);const _0x398216=Date[_0x23ba5e(0x1b5)]();try{console[_0x23ba5e(0x1d7)](_0x23ba5e(0x1d5)),console[_0x23ba5e(0x1d7)]('URL:',this['apiUrl']),console[_0x23ba5e(0x1d7)]('Request\x20Body:',JSON[_0x23ba5e(0x1e0)](_0x58fd6d,null,0x2)),loggerService_1[_0x23ba5e(0x1d9)][_0x23ba5e(0x1a5)](_0x23ba5e(0x1a7),_0x23ba5e(0x1ba),'POST',_0x58fd6d);const _0x4fca6b=await fetch(this[_0x23ba5e(0x1c3)],{'method':_0x23ba5e(0x1bb),'headers':{'Content-Type':'application/json','merchant_api_key':this['apiKey']},'body':JSON[_0x23ba5e(0x1e0)](_0x58fd6d)}),_0x209647=Date[_0x23ba5e(0x1b5)]()-_0x398216;console[_0x23ba5e(0x1d7)](_0x23ba5e(0x1a8)),console[_0x23ba5e(0x1d7)](_0x23ba5e(0x19f),_0x4fca6b[_0x23ba5e(0x1a0)]),console[_0x23ba5e(0x1d7)](_0x23ba5e(0x1ac),_0x4fca6b['statusText']),console[_0x23ba5e(0x1d7)](_0x23ba5e(0x1d3),_0x209647+'ms');const _0x1a252d=await _0x4fca6b[_0x23ba5e(0x1e5)]();console[_0x23ba5e(0x1d7)](_0x23ba5e(0x1c1),_0x1a252d);let _0x533d6e;try{_0x533d6e=JSON[_0x23ba5e(0x1eb)](_0x1a252d);}catch(_0x492623){console[_0x23ba5e(0x1ea)]('Failed\x20to\x20parse\x20JSON\x20response:',_0x492623),loggerService_1[_0x23ba5e(0x1d9)][_0x23ba5e(0x1db)]('oxapay','/payment/white-label',_0x23ba5e(0x1e6)+_0x492623);throw new Error(_0x23ba5e(0x1c4)+_0x1a252d);}console['log'](_0x23ba5e(0x1a1)),console[_0x23ba5e(0x1d7)](_0x23ba5e(0x1d0),JSON[_0x23ba5e(0x1e0)](_0x533d6e,null,0x2)),loggerService_1['loggerService'][_0x23ba5e(0x1dd)]('oxapay','/payment/white-label',_0x4fca6b[_0x23ba5e(0x1a0)],_0x533d6e,_0x209647);if(_0x533d6e[_0x23ba5e(0x1a0)]!==0xc8||!_0x533d6e[_0x23ba5e(0x1be)]){const _0x44dfa6=_0x533d6e[_0x23ba5e(0x1ea)]?.['message']||_0x533d6e[_0x23ba5e(0x1cc)]||_0x23ba5e(0x1c7);console['error'](_0x23ba5e(0x1d4)),console[_0x23ba5e(0x1ea)]('Error\x20Message:',_0x44dfa6),console[_0x23ba5e(0x1ea)](_0x23ba5e(0x1d6),_0x533d6e[_0x23ba5e(0x1ea)]),loggerService_1[_0x23ba5e(0x1d9)][_0x23ba5e(0x1db)](_0x23ba5e(0x1a7),'/payment/white-label',_0x23ba5e(0x1de)+_0x44dfa6);throw new Error(_0x23ba5e(0x1bc)+_0x44dfa6);}if(!_0x533d6e[_0x23ba5e(0x1be)][_0x23ba5e(0x1da)]||!_0x533d6e['data'][_0x23ba5e(0x1ce)]){console[_0x23ba5e(0x1ea)](_0x23ba5e(0x1dc)),console['error']('Missing\x20track_id\x20or\x20address\x20in\x20response'),console['error'](_0x23ba5e(0x1b6),_0x533d6e['data']),loggerService_1[_0x23ba5e(0x1d9)]['logWhiteDomainError']('oxapay',_0x23ba5e(0x1ba),_0x23ba5e(0x1e8));throw new Error(_0x23ba5e(0x1ed));}console[_0x23ba5e(0x1d7)](_0x23ba5e(0x1b3)),console[_0x23ba5e(0x1d7)](_0x23ba5e(0x1d8),_0x533d6e[_0x23ba5e(0x1be)][_0x23ba5e(0x1da)]),console[_0x23ba5e(0x1d7)](_0x23ba5e(0x1e4),_0x533d6e['data'][_0x23ba5e(0x1ce)]),console['log'](_0x23ba5e(0x198),_0x533d6e[_0x23ba5e(0x1be)]['pay_amount'],_0x533d6e[_0x23ba5e(0x1be)][_0x23ba5e(0x1aa)]),console[_0x23ba5e(0x1d7)]('Network:',_0x533d6e[_0x23ba5e(0x1be)][_0x23ba5e(0x1b7)]);const _0x387d0f=_0x23ba5e(0x1ca)+_0x27f11d[_0x23ba5e(0x1b9)];return{'gateway_payment_id':_0x533d6e['data'][_0x23ba5e(0x1da)],'payment_url':_0x387d0f,'track_id':_0x533d6e[_0x23ba5e(0x1be)][_0x23ba5e(0x1da)],'amount':_0x533d6e[_0x23ba5e(0x1be)][_0x23ba5e(0x1b1)],'currency':_0x533d6e[_0x23ba5e(0x1be)]['currency'],'pay_amount':_0x533d6e['data'][_0x23ba5e(0x1c5)],'pay_currency':_0x533d6e[_0x23ba5e(0x1be)][_0x23ba5e(0x1aa)],'network':_0x533d6e['data'][_0x23ba5e(0x1b7)],'address':_0x533d6e[_0x23ba5e(0x1be)][_0x23ba5e(0x1ce)],'qr_code':_0x533d6e[_0x23ba5e(0x1be)][_0x23ba5e(0x1ec)],'rate':_0x533d6e[_0x23ba5e(0x1be)][_0x23ba5e(0x1e3)],'expired_at':_0x533d6e['data']['expired_at']};}catch(_0x2946a5){console[_0x23ba5e(0x1ea)]('===\x20OXAPAY\x20REQUEST\x20ERROR\x20==='),console[_0x23ba5e(0x1ea)]('Error:',_0x2946a5),loggerService_1[_0x23ba5e(0x1d9)][_0x23ba5e(0x1db)](_0x23ba5e(0x1a7),'/payment/white-label',_0x2946a5 instanceof Error?_0x2946a5[_0x23ba5e(0x1cc)]:String(_0x2946a5));throw _0x2946a5;}}['getPaymentStatusFromCallback'](_0xbc7b45){const _0x54b475=a73_0x3920a6;switch(_0xbc7b45[_0x54b475(0x19a)]()){case'new':return'PENDING';case _0x54b475(0x1bf):return _0x54b475(0x1ae);case _0x54b475(0x1b0):return _0x54b475(0x1ef);case _0x54b475(0x1a9):return _0x54b475(0x1bd);case _0x54b475(0x1a4):return _0x54b475(0x1bd);case _0x54b475(0x19e):return _0x54b475(0x1bd);case _0x54b475(0x199):return _0x54b475(0x19b);case _0x54b475(0x1b4):return _0x54b475(0x19b);case _0x54b475(0x1c9):return _0x54b475(0x1ee);default:return'PENDING';}}}exports['OxaPayService']=OxaPayService,exports['oxapayService']=new OxaPayService();