'use strict';const a65_0x51cab2=a65_0x207a;(function(_0x14f522,_0x495551){const _0x4ff753=a65_0x207a,_0x3a1d90=_0x14f522();while(!![]){try{const _0x4a5693=parseInt(_0x4ff753(0xcb))/0x1+-parseInt(_0x4ff753(0xe9))/0x2*(parseInt(_0x4ff753(0xee))/0x3)+parseInt(_0x4ff753(0xaa))/0x4*(-parseInt(_0x4ff753(0xe2))/0x5)+parseInt(_0x4ff753(0xdd))/0x6*(parseInt(_0x4ff753(0xa2))/0x7)+-parseInt(_0x4ff753(0xe0))/0x8+parseInt(_0x4ff753(0xed))/0x9+parseInt(_0x4ff753(0xcf))/0xa;if(_0x4a5693===_0x495551)break;else _0x3a1d90['push'](_0x3a1d90['shift']());}catch(_0x32c07e){_0x3a1d90['push'](_0x3a1d90['shift']());}}}(a65_0x2854,0xdd955));function a65_0x207a(_0x1bfdfc,_0x5daf4c){_0x1bfdfc=_0x1bfdfc-0x9b;const _0x2854a4=a65_0x2854();let _0x207a51=_0x2854a4[_0x1bfdfc];return _0x207a51;}Object[a65_0x51cab2(0xae)](exports,a65_0x51cab2(0xd6),{'value':!![]}),exports[a65_0x51cab2(0xa0)]=exports[a65_0x51cab2(0xc7)]=void 0x0;const loggerService_1=require(a65_0x51cab2(0xa7));function a65_0x2854(){const _0x1505d2=['EXPIRED','4527186CkWQGF','Amount:','env','10642592IrLdVY','POST','176860NuuAIW','PENDING','WCXQ21-DL5OZP-H3SSHH-4GVAR4','parse','Raw\x20Response\x20Body:','https://api.trapay.uk/api/oxapay/callback','Unknown\x20error\x20from\x20OxaPay\x20API','94VamDIx','https://app.trapay.uk/payment/','qr_code','===\x20OXAPAY\x20API\x20ERROR\x20===','4759047pOzGzg','105684oXiTWu','Invalid\x20JSON\x20response\x20from\x20OxaPay\x20API:\x20','email','Order\x20#','new','paying','URL:','/payment/white-label','oxapayService','OXAPAY_API_KEY','7PyYlnE','oxapay','currency','PROCESSING','paymentId','../loggerService','address','warn','136zzCOmX','apiKey','logWhiteDomainError','createPayment','defineProperty','statusText','refunded','apiUrl','expired_at','Status:','log','===\x20OXAPAY\x20API\x20RESPONSE\x20===','lifetime','amount','https://api.oxapay.com/v1/payment/white-label','track_id','application/json','OxaPay\x20API\x20key\x20is\x20not\x20configured','data','error','network','toLowerCase','underpaid','REFUND','manual_accept','now','Parsed\x20Result:','Address:','getPaymentStatusFromCallback','OxaPayService','===\x20PARSED\x20OXAPAY\x20RESPONSE\x20===','Incomplete\x20response:\x20missing\x20track_id\x20or\x20address','===\x20OXAPAY\x20REQUEST\x20ERROR\x20===','1143544IwxdgJ','===\x20OXAPAY\x20API\x20INCOMPLETE\x20RESPONSE\x20===','API\x20Error:\x20','message','26694350PtILqk','Response\x20Time:','status','waiting','üí∞\x20OxaPay\x20service\x20initialized','stringify','JSON\x20Parse\x20Error:\x20','__esModule','Error\x20Message:','under_paid_coverage','pay_amount','pay_currency','loggerService'];a65_0x2854=function(){return _0x1505d2;};return a65_0x2854();}class OxaPayService{constructor(){const _0x205273=a65_0x51cab2;this['apiUrl']=_0x205273(0xb8),this[_0x205273(0xab)]=process[_0x205273(0xdf)][_0x205273(0xa1)]||_0x205273(0xe4),!this[_0x205273(0xab)]?console[_0x205273(0xa9)]('‚ö†Ô∏è\x20OXAPAY_API_KEY\x20not\x20found\x20in\x20environment\x20variables'):console[_0x205273(0xb4)](_0x205273(0xd3));}async[a65_0x51cab2(0xad)](_0x4762b0){const _0xbbb591=a65_0x51cab2,{orderId:_0x38d6c5,amount:_0x20196b,currency:_0x59b90b,payCurrency:_0x749701,network:_0x267311,description:_0x49cd51,customerEmail:_0x29739d,lifetime:_0x14248f,feePaidByPayer:_0xada281,underPaidCoverage:_0x40a1a8}=_0x4762b0;if(!this[_0xbbb591(0xab)])throw new Error(_0xbbb591(0xbb));const _0x1dc3b0={'amount':_0x20196b,'currency':_0x59b90b[_0xbbb591(0xbf)](),'callback_url':_0xbbb591(0xe7),'order_id':_0x38d6c5,'description':_0x49cd51||_0xbbb591(0x9b)+_0x38d6c5};_0x749701&&(_0x1dc3b0[_0xbbb591(0xda)]=_0x749701[_0xbbb591(0xbf)]());_0x267311&&(_0x1dc3b0['network']=_0x267311);_0x29739d&&(_0x1dc3b0[_0xbbb591(0xf0)]=_0x29739d);_0x14248f!==undefined?_0x1dc3b0[_0xbbb591(0xb6)]=_0x14248f:_0x1dc3b0[_0xbbb591(0xb6)]=0x3c;_0xada281!==undefined&&(_0x1dc3b0['fee_paid_by_payer']=_0xada281);_0x40a1a8!==undefined&&(_0x1dc3b0[_0xbbb591(0xd8)]=_0x40a1a8);const _0x39f50d=Date['now']();try{console[_0xbbb591(0xb4)]('===\x20OXAPAY\x20API\x20REQUEST\x20==='),console[_0xbbb591(0xb4)](_0xbbb591(0x9e),this['apiUrl']),console['log']('Request\x20Body:',JSON[_0xbbb591(0xd4)](_0x1dc3b0,null,0x2)),loggerService_1[_0xbbb591(0xdb)]['logWhiteDomainRequest'](_0xbbb591(0xa3),_0xbbb591(0x9f),'POST',_0x1dc3b0);const _0x127dd9=await fetch(this[_0xbbb591(0xb1)],{'method':_0xbbb591(0xe1),'headers':{'Content-Type':_0xbbb591(0xba),'merchant_api_key':this[_0xbbb591(0xab)]},'body':JSON[_0xbbb591(0xd4)](_0x1dc3b0)}),_0x5dc886=Date[_0xbbb591(0xc3)]()-_0x39f50d;console[_0xbbb591(0xb4)](_0xbbb591(0xb5)),console[_0xbbb591(0xb4)](_0xbbb591(0xb3),_0x127dd9[_0xbbb591(0xd1)]),console[_0xbbb591(0xb4)]('Status\x20Text:',_0x127dd9[_0xbbb591(0xaf)]),console[_0xbbb591(0xb4)](_0xbbb591(0xd0),_0x5dc886+'ms');const _0x2725d8=await _0x127dd9['text']();console[_0xbbb591(0xb4)](_0xbbb591(0xe6),_0x2725d8);let _0x3446c3;try{_0x3446c3=JSON[_0xbbb591(0xe5)](_0x2725d8);}catch(_0x40709a){console[_0xbbb591(0xbd)]('Failed\x20to\x20parse\x20JSON\x20response:',_0x40709a),loggerService_1[_0xbbb591(0xdb)]['logWhiteDomainError']('oxapay',_0xbbb591(0x9f),_0xbbb591(0xd5)+_0x40709a);throw new Error(_0xbbb591(0xef)+_0x2725d8);}console[_0xbbb591(0xb4)](_0xbbb591(0xc8)),console[_0xbbb591(0xb4)](_0xbbb591(0xc4),JSON[_0xbbb591(0xd4)](_0x3446c3,null,0x2)),loggerService_1['loggerService']['logWhiteDomainResponse'](_0xbbb591(0xa3),_0xbbb591(0x9f),_0x127dd9[_0xbbb591(0xd1)],_0x3446c3,_0x5dc886);if(_0x3446c3[_0xbbb591(0xd1)]!==0xc8||!_0x3446c3[_0xbbb591(0xbc)]){const _0x1ac050=_0x3446c3[_0xbbb591(0xbd)]?.[_0xbbb591(0xce)]||_0x3446c3[_0xbbb591(0xce)]||_0xbbb591(0xe8);console['error'](_0xbbb591(0xec)),console[_0xbbb591(0xbd)](_0xbbb591(0xd7),_0x1ac050),console['error']('Error\x20Details:',_0x3446c3[_0xbbb591(0xbd)]),loggerService_1[_0xbbb591(0xdb)][_0xbbb591(0xac)]('oxapay','/payment/white-label',_0xbbb591(0xcd)+_0x1ac050);throw new Error('OxaPay\x20API\x20error:\x20'+_0x1ac050);}if(!_0x3446c3['data'][_0xbbb591(0xb9)]||!_0x3446c3['data'][_0xbbb591(0xa8)]){console['error'](_0xbbb591(0xcc)),console[_0xbbb591(0xbd)]('Missing\x20track_id\x20or\x20address\x20in\x20response'),console[_0xbbb591(0xbd)]('Response\x20data:',_0x3446c3['data']),loggerService_1[_0xbbb591(0xdb)][_0xbbb591(0xac)](_0xbbb591(0xa3),_0xbbb591(0x9f),_0xbbb591(0xc9));throw new Error('Invalid\x20response\x20from\x20OxaPay\x20API:\x20missing\x20track_id\x20or\x20address');}console[_0xbbb591(0xb4)]('===\x20OXAPAY\x20SUCCESS\x20==='),console['log']('Track\x20ID:',_0x3446c3[_0xbbb591(0xbc)][_0xbbb591(0xb9)]),console[_0xbbb591(0xb4)](_0xbbb591(0xc5),_0x3446c3['data'][_0xbbb591(0xa8)]),console[_0xbbb591(0xb4)](_0xbbb591(0xde),_0x3446c3[_0xbbb591(0xbc)][_0xbbb591(0xd9)],_0x3446c3['data'][_0xbbb591(0xda)]),console[_0xbbb591(0xb4)]('Network:',_0x3446c3[_0xbbb591(0xbc)]['network']);const _0x491509=_0xbbb591(0xea)+_0x4762b0[_0xbbb591(0xa6)];return{'gateway_payment_id':_0x3446c3[_0xbbb591(0xbc)][_0xbbb591(0xb9)],'payment_url':_0x491509,'track_id':_0x3446c3[_0xbbb591(0xbc)][_0xbbb591(0xb9)],'amount':_0x3446c3[_0xbbb591(0xbc)][_0xbbb591(0xb7)],'currency':_0x3446c3['data'][_0xbbb591(0xa4)],'pay_amount':_0x3446c3[_0xbbb591(0xbc)]['pay_amount'],'pay_currency':_0x3446c3[_0xbbb591(0xbc)]['pay_currency'],'network':_0x3446c3[_0xbbb591(0xbc)][_0xbbb591(0xbe)],'address':_0x3446c3[_0xbbb591(0xbc)][_0xbbb591(0xa8)],'qr_code':_0x3446c3[_0xbbb591(0xbc)][_0xbbb591(0xeb)],'rate':_0x3446c3[_0xbbb591(0xbc)]['rate'],'expired_at':_0x3446c3[_0xbbb591(0xbc)][_0xbbb591(0xb2)]};}catch(_0x1d6b60){console[_0xbbb591(0xbd)](_0xbbb591(0xca)),console['error']('Error:',_0x1d6b60),loggerService_1[_0xbbb591(0xdb)][_0xbbb591(0xac)]('oxapay',_0xbbb591(0x9f),_0x1d6b60 instanceof Error?_0x1d6b60[_0xbbb591(0xce)]:String(_0x1d6b60));throw _0x1d6b60;}}[a65_0x51cab2(0xc6)](_0x2e4e78){const _0x2a2792=a65_0x51cab2;switch(_0x2e4e78[_0x2a2792(0xbf)]()){case _0x2a2792(0x9c):return _0x2a2792(0xe3);case _0x2a2792(0xd2):return _0x2a2792(0xe3);case _0x2a2792(0x9d):return _0x2a2792(0xa5);case'paid':return'PAID';case _0x2a2792(0xc2):return'PAID';case _0x2a2792(0xc0):return'PAID';case'refunding':return _0x2a2792(0xc1);case _0x2a2792(0xb0):return _0x2a2792(0xc1);case'expired':return _0x2a2792(0xdc);default:return _0x2a2792(0xe3);}}}exports['OxaPayService']=OxaPayService,exports[a65_0x51cab2(0xa0)]=new OxaPayService();