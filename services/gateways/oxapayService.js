'use strict';const a73_0x2f62d2=a73_0x4489;(function(_0x694a64,_0x2b667b){const _0x5c37fd=a73_0x4489,_0x378b9e=_0x694a64();while(!![]){try{const _0xf2707a=-parseInt(_0x5c37fd(0x9c))/0x1*(parseInt(_0x5c37fd(0xc0))/0x2)+-parseInt(_0x5c37fd(0x8a))/0x3+parseInt(_0x5c37fd(0x85))/0x4*(parseInt(_0x5c37fd(0xc7))/0x5)+-parseInt(_0x5c37fd(0xd0))/0x6+parseInt(_0x5c37fd(0xbb))/0x7*(parseInt(_0x5c37fd(0x8d))/0x8)+-parseInt(_0x5c37fd(0xa9))/0x9+parseInt(_0x5c37fd(0x8c))/0xa;if(_0xf2707a===_0x2b667b)break;else _0x378b9e['push'](_0x378b9e['shift']());}catch(_0x5ce6cb){_0x378b9e['push'](_0x378b9e['shift']());}}}(a73_0x76ac,0x9ae99));Object['defineProperty'](exports,a73_0x2f62d2(0x9d),{'value':!![]}),exports['oxapayService']=exports['OxaPayService']=void 0x0;const loggerService_1=require(a73_0x2f62d2(0xbd));class OxaPayService{constructor(){const _0x15a182=a73_0x2f62d2;this[_0x15a182(0xa6)]=_0x15a182(0xc9),this[_0x15a182(0xab)]=process.env.OXAPAY_API_KEY||_0x15a182(0xb9),!this[_0x15a182(0xab)]?console['warn'](_0x15a182(0xcd)):console[_0x15a182(0x90)](_0x15a182(0x8e));}async['createPayment'](_0x3b79d2){const _0x5efe32=a73_0x2f62d2,{orderId:_0x65b81a,amount:_0x1f9861,currency:_0x1b7e46,payCurrency:_0x5eafff,network:_0x51f325,description:_0x28f169,customerEmail:_0xb965bd,lifetime:_0x3f859d,feePaidByPayer:_0x450d1a,underPaidCoverage:_0x3518b8}=_0x3b79d2;if(!this[_0x5efe32(0xab)])throw new Error(_0x5efe32(0xb2));const _0x3d2d22={'amount':_0x1f9861,'currency':_0x1b7e46[_0x5efe32(0xa0)](),'callback_url':'https://api.trapay.uk/api/oxapay/callback','order_id':_0x65b81a,'description':_0x28f169||_0x5efe32(0xba)+_0x65b81a};_0x5eafff&&(_0x3d2d22[_0x5efe32(0x91)]=_0x5eafff[_0x5efe32(0xa0)]());_0x51f325&&(_0x3d2d22[_0x5efe32(0xae)]=_0x51f325);_0xb965bd&&(_0x3d2d22[_0x5efe32(0x86)]=_0xb965bd);_0x3f859d!==undefined?_0x3d2d22[_0x5efe32(0xa2)]=_0x3f859d:_0x3d2d22[_0x5efe32(0xa2)]=0x3c;_0x450d1a!==undefined&&(_0x3d2d22[_0x5efe32(0x8f)]=_0x450d1a);_0x3518b8!==undefined&&(_0x3d2d22[_0x5efe32(0xca)]=_0x3518b8);const _0x1675c8=Date[_0x5efe32(0xc5)]();try{console[_0x5efe32(0x90)](_0x5efe32(0xa1)),console[_0x5efe32(0x90)](_0x5efe32(0xb1),this[_0x5efe32(0xa6)]),console['log']('Request\x20Body:',JSON[_0x5efe32(0xac)](_0x3d2d22,null,0x2)),loggerService_1[_0x5efe32(0x96)][_0x5efe32(0x98)](_0x5efe32(0x87),_0x5efe32(0xc1),_0x5efe32(0xbf),_0x3d2d22);const _0x32cb29=await fetch(this[_0x5efe32(0xa6)],{'method':'POST','headers':{'Content-Type':_0x5efe32(0xc2),'merchant_api_key':this[_0x5efe32(0xab)]},'body':JSON[_0x5efe32(0xac)](_0x3d2d22)}),_0x52a6d7=Date['now']()-_0x1675c8;console['log']('===\x20OXAPAY\x20API\x20RESPONSE\x20==='),console[_0x5efe32(0x90)]('Status:',_0x32cb29[_0x5efe32(0xb6)]),console[_0x5efe32(0x90)]('Status\x20Text:',_0x32cb29['statusText']),console[_0x5efe32(0x90)]('Response\x20Time:',_0x52a6d7+'ms');const _0xc8bd80=await _0x32cb29[_0x5efe32(0x94)]();console[_0x5efe32(0x90)](_0x5efe32(0xbe),_0xc8bd80);let _0x36aa34;try{_0x36aa34=JSON['parse'](_0xc8bd80);}catch(_0x4e29d3){console[_0x5efe32(0xd3)]('Failed\x20to\x20parse\x20JSON\x20response:',_0x4e29d3),loggerService_1[_0x5efe32(0x96)][_0x5efe32(0xad)](_0x5efe32(0x87),'/payment/white-label',_0x5efe32(0x9b)+_0x4e29d3);throw new Error(_0x5efe32(0xa4)+_0xc8bd80);}console[_0x5efe32(0x90)]('===\x20PARSED\x20OXAPAY\x20RESPONSE\x20==='),console[_0x5efe32(0x90)](_0x5efe32(0xce),JSON[_0x5efe32(0xac)](_0x36aa34,null,0x2)),loggerService_1[_0x5efe32(0x96)][_0x5efe32(0xd2)](_0x5efe32(0x87),_0x5efe32(0xc1),_0x32cb29[_0x5efe32(0xb6)],_0x36aa34,_0x52a6d7);if(_0x36aa34[_0x5efe32(0xb6)]!==0xc8||!_0x36aa34[_0x5efe32(0xa8)]){const _0x3e30f3=_0x36aa34[_0x5efe32(0xd3)]?.[_0x5efe32(0xcb)]||_0x36aa34['message']||'Unknown\x20error\x20from\x20OxaPay\x20API';console['error'](_0x5efe32(0xb8)),console[_0x5efe32(0xd3)]('Error\x20Message:',_0x3e30f3),console[_0x5efe32(0xd3)](_0x5efe32(0xd1),_0x36aa34[_0x5efe32(0xd3)]),loggerService_1[_0x5efe32(0x96)][_0x5efe32(0xad)]('oxapay',_0x5efe32(0xc1),_0x5efe32(0x89)+_0x3e30f3);throw new Error(_0x5efe32(0x99)+_0x3e30f3);}if(!_0x36aa34[_0x5efe32(0xa8)][_0x5efe32(0x93)]||!_0x36aa34[_0x5efe32(0xa8)][_0x5efe32(0x9f)]){console['error']('===\x20OXAPAY\x20API\x20INCOMPLETE\x20RESPONSE\x20==='),console[_0x5efe32(0xd3)](_0x5efe32(0xb0)),console['error'](_0x5efe32(0x92),_0x36aa34[_0x5efe32(0xa8)]),loggerService_1['loggerService']['logWhiteDomainError'](_0x5efe32(0x87),'/payment/white-label',_0x5efe32(0xaf));throw new Error(_0x5efe32(0xa7));}console[_0x5efe32(0x90)]('===\x20OXAPAY\x20SUCCESS\x20==='),console[_0x5efe32(0x90)]('Track\x20ID:',_0x36aa34[_0x5efe32(0xa8)][_0x5efe32(0x93)]),console['log']('Address:',_0x36aa34[_0x5efe32(0xa8)][_0x5efe32(0x9f)]),console[_0x5efe32(0x90)](_0x5efe32(0xb7),_0x36aa34[_0x5efe32(0xa8)]['pay_amount'],_0x36aa34[_0x5efe32(0xa8)][_0x5efe32(0x91)]),console[_0x5efe32(0x90)](_0x5efe32(0x95),_0x36aa34['data'][_0x5efe32(0xae)]);const _0x42872a=_0x5efe32(0xb3)+_0x3b79d2[_0x5efe32(0xc4)];return{'gateway_payment_id':_0x36aa34[_0x5efe32(0xa8)][_0x5efe32(0x93)],'payment_url':_0x42872a,'track_id':_0x36aa34['data'][_0x5efe32(0x93)],'amount':_0x36aa34[_0x5efe32(0xa8)]['amount'],'currency':_0x36aa34[_0x5efe32(0xa8)]['currency'],'pay_amount':_0x36aa34[_0x5efe32(0xa8)]['pay_amount'],'pay_currency':_0x36aa34['data'][_0x5efe32(0x91)],'network':_0x36aa34['data'][_0x5efe32(0xae)],'address':_0x36aa34[_0x5efe32(0xa8)][_0x5efe32(0x9f)],'qr_code':_0x36aa34[_0x5efe32(0xa8)]['qr_code'],'rate':_0x36aa34[_0x5efe32(0xa8)][_0x5efe32(0x9a)],'expired_at':_0x36aa34[_0x5efe32(0xa8)][_0x5efe32(0xc3)]};}catch(_0x5e4f26){console['error']('===\x20OXAPAY\x20REQUEST\x20ERROR\x20==='),console[_0x5efe32(0xd3)](_0x5efe32(0xc8),_0x5e4f26),loggerService_1[_0x5efe32(0x96)][_0x5efe32(0xad)](_0x5efe32(0x87),_0x5efe32(0xc1),_0x5e4f26 instanceof Error?_0x5e4f26['message']:String(_0x5e4f26));throw _0x5e4f26;}}[a73_0x2f62d2(0xc6)](_0x43d683){const _0x4ae2a7=a73_0x2f62d2;switch(_0x43d683[_0x4ae2a7(0xa0)]()){case'new':return'PENDING';case _0x4ae2a7(0x9e):return _0x4ae2a7(0x97);case _0x4ae2a7(0xb4):return _0x4ae2a7(0x8b);case _0x4ae2a7(0xa3):return'PAID';case _0x4ae2a7(0xcf):return _0x4ae2a7(0xa5);case'underpaid':return _0x4ae2a7(0xa5);case'refunding':return _0x4ae2a7(0xaa);case _0x4ae2a7(0xb5):return'REFUND';case _0x4ae2a7(0xcc):return _0x4ae2a7(0x88);default:return _0x4ae2a7(0x97);}}}exports['OxaPayService']=OxaPayService,exports[a73_0x2f62d2(0xbc)]=new OxaPayService();function a73_0x4489(_0xe8261f,_0x4cee7c){_0xe8261f=_0xe8261f-0x85;const _0x76ac0b=a73_0x76ac();let _0x4489c1=_0x76ac0b[_0xe8261f];return _0x4489c1;}function a73_0x76ac(){const _0x312156=['stringify','logWhiteDomainError','network','Incomplete\x20response:\x20missing\x20track_id\x20or\x20address','Missing\x20track_id\x20or\x20address\x20in\x20response','URL:','OxaPay\x20API\x20key\x20is\x20not\x20configured','https://app.trapay.uk/payment/','paying','refunded','status','Amount:','===\x20OXAPAY\x20API\x20ERROR\x20===','WCXQ21-DL5OZP-H3SSHH-4GVAR4','Order\x20#','7hoofEM','oxapayService','../loggerService','Raw\x20Response\x20Body:','POST','2qMisEX','/payment/white-label','application/json','expired_at','paymentId','now','getPaymentStatusFromCallback','1055ntfQYN','Error:','https://api.oxapay.com/v1/payment/white-label','under_paid_coverage','message','expired','‚ö†Ô∏è\x20OXAPAY_API_KEY\x20not\x20found\x20in\x20environment\x20variables','Parsed\x20Result:','manual_accept','6737484hsiGFz','Error\x20Details:','logWhiteDomainResponse','error','14620EHJJVL','email','oxapay','EXPIRED','API\x20Error:\x20','1279425jsfhhl','PROCESSING','15798010eYiiah','3943472NcsNcu','üí∞\x20OxaPay\x20service\x20initialized','fee_paid_by_payer','log','pay_currency','Response\x20data:','track_id','text','Network:','loggerService','PENDING','logWhiteDomainRequest','OxaPay\x20API\x20error:\x20','rate','JSON\x20Parse\x20Error:\x20','559773idpzxv','__esModule','waiting','address','toLowerCase','===\x20OXAPAY\x20API\x20REQUEST\x20===','lifetime','paid','Invalid\x20JSON\x20response\x20from\x20OxaPay\x20API:\x20','PAID','apiUrl','Invalid\x20response\x20from\x20OxaPay\x20API:\x20missing\x20track_id\x20or\x20address','data','902313whreug','REFUND','apiKey'];a73_0x76ac=function(){return _0x312156;};return a73_0x76ac();}