'use strict';function a65_0x37f7(){const _0x12e4ac=['1153ckURLj','status','610158ICXUOT','logWhiteDomainResponse','REFUND','apiKey','currency','apiUrl','OxaPay\x20API\x20key\x20is\x20not\x20configured','EXPIRED','===\x20OXAPAY\x20REQUEST\x20ERROR\x20===','warn','91WQLqfF','Status:','oxapayService','520UDtVxK','pay_amount','parse','Status\x20Text:','2963658bcoKhn','network','Address:','Request\x20Body:','log','JSON\x20Parse\x20Error:\x20','5IxBDlE','logWhiteDomainError','/payment/white-label','lifetime','PENDING','address','paying','Invalid\x20response\x20from\x20OxaPay\x20API:\x20missing\x20track_id\x20or\x20address','https://api.trapay.uk/api/oxapay/callback','text','Error:','Track\x20ID:','Response\x20Time:','===\x20OXAPAY\x20API\x20INCOMPLETE\x20RESPONSE\x20===','expired','statusText','amount','logWhiteDomainRequest','now','env','expired_at','paymentId','qr_code','104229qzgIOV','loggerService','Response\x20data:','email','üí∞\x20OxaPay\x20service\x20initialized','PROCESSING','refunded','toLowerCase','Incomplete\x20response:\x20missing\x20track_id\x20or\x20address','message','PAID','application/json','WCXQ21-DL5OZP-H3SSHH-4GVAR4','Raw\x20Response\x20Body:','OxaPayService','1502rrqFKK','Missing\x20track_id\x20or\x20address\x20in\x20response','../loggerService','OXAPAY_API_KEY','track_id','createPayment','URL:','pay_currency','https://api.oxapay.com/v1/payment/white-label','API\x20Error:\x20','===\x20OXAPAY\x20API\x20ERROR\x20===','paid','stringify','Network:','under_paid_coverage','getPaymentStatusFromCallback','===\x20OXAPAY\x20SUCCESS\x20===','687476izFCjc','underpaid','22636801xvlERI','data','error','Invalid\x20JSON\x20response\x20from\x20OxaPay\x20API:\x20','Order\x20#','defineProperty','refunding','37256eTfNcN','‚ö†Ô∏è\x20OXAPAY_API_KEY\x20not\x20found\x20in\x20environment\x20variables','OxaPay\x20API\x20error:\x20','Amount:','POST','oxapay'];a65_0x37f7=function(){return _0x12e4ac;};return a65_0x37f7();}const a65_0x3dba2f=a65_0xb5b4;(function(_0xd38a8c,_0x2cd270){const _0x4d5f13=a65_0xb5b4,_0x2bdbf3=_0xd38a8c();while(!![]){try{const _0x570eb5=parseInt(_0x4d5f13(0xd7))/0x1*(parseInt(_0x4d5f13(0x116))/0x2)+parseInt(_0x4d5f13(0xea))/0x3+parseInt(_0x4d5f13(0x127))/0x4+-parseInt(_0x4d5f13(0xf0))/0x5*(parseInt(_0x4d5f13(0xd9))/0x6)+parseInt(_0x4d5f13(0xe3))/0x7*(parseInt(_0x4d5f13(0x130))/0x8)+parseInt(_0x4d5f13(0x107))/0x9*(parseInt(_0x4d5f13(0xe6))/0xa)+-parseInt(_0x4d5f13(0x129))/0xb;if(_0x570eb5===_0x2cd270)break;else _0x2bdbf3['push'](_0x2bdbf3['shift']());}catch(_0xe797d2){_0x2bdbf3['push'](_0x2bdbf3['shift']());}}}(a65_0x37f7,0x811bb));function a65_0xb5b4(_0x5abd60,_0x541cbd){_0x5abd60=_0x5abd60-0xd2;const _0x37f7fd=a65_0x37f7();let _0xb5b4b6=_0x37f7fd[_0x5abd60];return _0xb5b4b6;}Object[a65_0x3dba2f(0x12e)](exports,'__esModule',{'value':!![]}),exports[a65_0x3dba2f(0xe5)]=exports['OxaPayService']=void 0x0;const loggerService_1=require(a65_0x3dba2f(0x118));class OxaPayService{constructor(){const _0x16ebe1=a65_0x3dba2f;this[_0x16ebe1(0xde)]=_0x16ebe1(0x11e),this[_0x16ebe1(0xdc)]=process[_0x16ebe1(0x103)][_0x16ebe1(0x119)]||_0x16ebe1(0x113),!this[_0x16ebe1(0xdc)]?console[_0x16ebe1(0xe2)](_0x16ebe1(0xd2)):console[_0x16ebe1(0xee)](_0x16ebe1(0x10b));}async[a65_0x3dba2f(0x11b)](_0x5d57f4){const _0x19b5c1=a65_0x3dba2f,{orderId:_0x5a73c6,amount:_0x5c682c,currency:_0x5f519b,payCurrency:_0x50ce69,network:_0x2d1bc5,description:_0x527742,customerEmail:_0x8b1b91,lifetime:_0x781d2c,feePaidByPayer:_0x2ada92,underPaidCoverage:_0x1fd560}=_0x5d57f4;if(!this[_0x19b5c1(0xdc)])throw new Error(_0x19b5c1(0xdf));const _0x33310b={'amount':_0x5c682c,'currency':_0x5f519b[_0x19b5c1(0x10e)](),'callback_url':_0x19b5c1(0xf8),'order_id':_0x5a73c6,'description':_0x527742||_0x19b5c1(0x12d)+_0x5a73c6};_0x50ce69&&(_0x33310b['pay_currency']=_0x50ce69[_0x19b5c1(0x10e)]());_0x2d1bc5&&(_0x33310b[_0x19b5c1(0xeb)]=_0x2d1bc5);_0x8b1b91&&(_0x33310b[_0x19b5c1(0x10a)]=_0x8b1b91);_0x781d2c!==undefined?_0x33310b[_0x19b5c1(0xf3)]=_0x781d2c:_0x33310b[_0x19b5c1(0xf3)]=0x3c;_0x2ada92!==undefined&&(_0x33310b['fee_paid_by_payer']=_0x2ada92);_0x1fd560!==undefined&&(_0x33310b[_0x19b5c1(0x124)]=_0x1fd560);const _0x1f9cf9=Date[_0x19b5c1(0x102)]();try{console[_0x19b5c1(0xee)]('===\x20OXAPAY\x20API\x20REQUEST\x20==='),console[_0x19b5c1(0xee)](_0x19b5c1(0x11c),this[_0x19b5c1(0xde)]),console[_0x19b5c1(0xee)](_0x19b5c1(0xed),JSON['stringify'](_0x33310b,null,0x2)),loggerService_1['loggerService'][_0x19b5c1(0x101)](_0x19b5c1(0xd6),_0x19b5c1(0xf2),_0x19b5c1(0xd5),_0x33310b);const _0x2aa460=await fetch(this[_0x19b5c1(0xde)],{'method':_0x19b5c1(0xd5),'headers':{'Content-Type':_0x19b5c1(0x112),'merchant_api_key':this[_0x19b5c1(0xdc)]},'body':JSON['stringify'](_0x33310b)}),_0x7578cc=Date[_0x19b5c1(0x102)]()-_0x1f9cf9;console[_0x19b5c1(0xee)]('===\x20OXAPAY\x20API\x20RESPONSE\x20==='),console[_0x19b5c1(0xee)](_0x19b5c1(0xe4),_0x2aa460[_0x19b5c1(0xd8)]),console['log'](_0x19b5c1(0xe9),_0x2aa460[_0x19b5c1(0xff)]),console[_0x19b5c1(0xee)](_0x19b5c1(0xfc),_0x7578cc+'ms');const _0x5c8f54=await _0x2aa460[_0x19b5c1(0xf9)]();console[_0x19b5c1(0xee)](_0x19b5c1(0x114),_0x5c8f54);let _0x380491;try{_0x380491=JSON[_0x19b5c1(0xe8)](_0x5c8f54);}catch(_0x2f2223){console[_0x19b5c1(0x12b)]('Failed\x20to\x20parse\x20JSON\x20response:',_0x2f2223),loggerService_1[_0x19b5c1(0x108)]['logWhiteDomainError']('oxapay',_0x19b5c1(0xf2),_0x19b5c1(0xef)+_0x2f2223);throw new Error(_0x19b5c1(0x12c)+_0x5c8f54);}console[_0x19b5c1(0xee)]('===\x20PARSED\x20OXAPAY\x20RESPONSE\x20==='),console[_0x19b5c1(0xee)]('Parsed\x20Result:',JSON[_0x19b5c1(0x122)](_0x380491,null,0x2)),loggerService_1[_0x19b5c1(0x108)][_0x19b5c1(0xda)]('oxapay','/payment/white-label',_0x2aa460['status'],_0x380491,_0x7578cc);if(_0x380491[_0x19b5c1(0xd8)]!==0xc8||!_0x380491['data']){const _0x4582f6=_0x380491[_0x19b5c1(0x12b)]?.['message']||_0x380491['message']||'Unknown\x20error\x20from\x20OxaPay\x20API';console['error'](_0x19b5c1(0x120)),console['error']('Error\x20Message:',_0x4582f6),console[_0x19b5c1(0x12b)]('Error\x20Details:',_0x380491[_0x19b5c1(0x12b)]),loggerService_1[_0x19b5c1(0x108)][_0x19b5c1(0xf1)](_0x19b5c1(0xd6),'/payment/white-label',_0x19b5c1(0x11f)+_0x4582f6);throw new Error(_0x19b5c1(0xd3)+_0x4582f6);}if(!_0x380491[_0x19b5c1(0x12a)][_0x19b5c1(0x11a)]||!_0x380491[_0x19b5c1(0x12a)][_0x19b5c1(0xf5)]){console['error'](_0x19b5c1(0xfd)),console['error'](_0x19b5c1(0x117)),console[_0x19b5c1(0x12b)](_0x19b5c1(0x109),_0x380491[_0x19b5c1(0x12a)]),loggerService_1[_0x19b5c1(0x108)][_0x19b5c1(0xf1)](_0x19b5c1(0xd6),_0x19b5c1(0xf2),_0x19b5c1(0x10f));throw new Error(_0x19b5c1(0xf7));}console['log'](_0x19b5c1(0x126)),console[_0x19b5c1(0xee)](_0x19b5c1(0xfb),_0x380491['data'][_0x19b5c1(0x11a)]),console[_0x19b5c1(0xee)](_0x19b5c1(0xec),_0x380491[_0x19b5c1(0x12a)][_0x19b5c1(0xf5)]),console[_0x19b5c1(0xee)](_0x19b5c1(0xd4),_0x380491[_0x19b5c1(0x12a)][_0x19b5c1(0xe7)],_0x380491[_0x19b5c1(0x12a)][_0x19b5c1(0x11d)]),console['log'](_0x19b5c1(0x123),_0x380491[_0x19b5c1(0x12a)][_0x19b5c1(0xeb)]);const _0x24d6d5='https://app.trapay.uk/payment/'+_0x5d57f4[_0x19b5c1(0x105)];return{'gateway_payment_id':_0x380491['data'][_0x19b5c1(0x11a)],'payment_url':_0x24d6d5,'track_id':_0x380491[_0x19b5c1(0x12a)][_0x19b5c1(0x11a)],'amount':_0x380491['data'][_0x19b5c1(0x100)],'currency':_0x380491['data'][_0x19b5c1(0xdd)],'pay_amount':_0x380491[_0x19b5c1(0x12a)]['pay_amount'],'pay_currency':_0x380491[_0x19b5c1(0x12a)][_0x19b5c1(0x11d)],'network':_0x380491['data'][_0x19b5c1(0xeb)],'address':_0x380491[_0x19b5c1(0x12a)]['address'],'qr_code':_0x380491[_0x19b5c1(0x12a)][_0x19b5c1(0x106)],'rate':_0x380491[_0x19b5c1(0x12a)]['rate'],'expired_at':_0x380491[_0x19b5c1(0x12a)][_0x19b5c1(0x104)]};}catch(_0x37a18b){console[_0x19b5c1(0x12b)](_0x19b5c1(0xe1)),console[_0x19b5c1(0x12b)](_0x19b5c1(0xfa),_0x37a18b),loggerService_1[_0x19b5c1(0x108)]['logWhiteDomainError']('oxapay',_0x19b5c1(0xf2),_0x37a18b instanceof Error?_0x37a18b[_0x19b5c1(0x110)]:String(_0x37a18b));throw _0x37a18b;}}[a65_0x3dba2f(0x125)](_0x382ca7){const _0x5cb862=a65_0x3dba2f;switch(_0x382ca7[_0x5cb862(0x10e)]()){case'new':return _0x5cb862(0xf4);case'waiting':return'PENDING';case _0x5cb862(0xf6):return _0x5cb862(0x10c);case _0x5cb862(0x121):return'PAID';case'manual_accept':return _0x5cb862(0x111);case _0x5cb862(0x128):return'PAID';case _0x5cb862(0x12f):return _0x5cb862(0xdb);case _0x5cb862(0x10d):return _0x5cb862(0xdb);case _0x5cb862(0xfe):return _0x5cb862(0xe0);default:return _0x5cb862(0xf4);}}}exports[a65_0x3dba2f(0x115)]=OxaPayService,exports[a65_0x3dba2f(0xe5)]=new OxaPayService();