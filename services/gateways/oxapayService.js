'use strict';const a69_0x2284e5=a69_0x1132;(function(_0x18da02,_0x20db5d){const _0x58e169=a69_0x1132,_0x3aba87=_0x18da02();while(!![]){try{const _0x31f8c1=parseInt(_0x58e169(0x1e7))/0x1+parseInt(_0x58e169(0x1fd))/0x2+-parseInt(_0x58e169(0x21a))/0x3+parseInt(_0x58e169(0x23a))/0x4*(parseInt(_0x58e169(0x22d))/0x5)+parseInt(_0x58e169(0x21c))/0x6*(-parseInt(_0x58e169(0x217))/0x7)+parseInt(_0x58e169(0x222))/0x8*(-parseInt(_0x58e169(0x223))/0x9)+parseInt(_0x58e169(0x211))/0xa*(parseInt(_0x58e169(0x225))/0xb);if(_0x31f8c1===_0x20db5d)break;else _0x3aba87['push'](_0x3aba87['shift']());}catch(_0x430d85){_0x3aba87['push'](_0x3aba87['shift']());}}}(a69_0x32f8,0x9e8bd));Object[a69_0x2284e5(0x230)](exports,a69_0x2284e5(0x1e9),{'value':!![]}),exports[a69_0x2284e5(0x20d)]=exports[a69_0x2284e5(0x205)]=void 0x0;function a69_0x1132(_0x113517,_0x11e43b){_0x113517=_0x113517-0x1e6;const _0x32f853=a69_0x32f8();let _0x113287=_0x32f853[_0x113517];return _0x113287;}function a69_0x32f8(){const _0x317823=['status','Request\x20Body:','parse','301868IExIdf','rate','https://app.trapay.uk/payment/','data','paymentId','Network:','JSON\x20Parse\x20Error:\x20','now','OxaPayService','refunded','manual_accept','pay_currency','oxapay','Amount:','‚ö†Ô∏è\x20OXAPAY_API_KEY\x20not\x20found\x20in\x20environment\x20variables','track_id','oxapayService','createPayment','/payment/white-label','Error\x20Details:','20mlpjvV','logWhiteDomainResponse','Incomplete\x20response:\x20missing\x20track_id\x20or\x20address','Missing\x20track_id\x20or\x20address\x20in\x20response','===\x20OXAPAY\x20REQUEST\x20ERROR\x20===','Error:','7iUfutb','API\x20Error:\x20','error','3657195lABnPi','lifetime','506478YShVXo','email','logWhiteDomainError','apiKey','PAID','Address:','24YZmfVV','1223271fzQPKH','stringify','1123804yWFFxj','fee_paid_by_payer','network','paid','PROCESSING','===\x20OXAPAY\x20API\x20REQUEST\x20===','PENDING','text','10uHUFxa','===\x20OXAPAY\x20API\x20RESPONSE\x20===','https://api.oxapay.com/v1/payment/white-label','defineProperty','Raw\x20Response\x20Body:','===\x20OXAPAY\x20API\x20ERROR\x20===','amount','apiUrl','statusText','Response\x20data:','Error\x20Message:','underpaid','pay_amount','2483088QtthJj','Unknown\x20error\x20from\x20OxaPay\x20API','logWhiteDomainRequest','Invalid\x20response\x20from\x20OxaPay\x20API:\x20missing\x20track_id\x20or\x20address','URL:','===\x20PARSED\x20OXAPAY\x20RESPONSE\x20===','===\x20OXAPAY\x20SUCCESS\x20===','POST','763834sQUhds','üí∞\x20OxaPay\x20service\x20initialized','__esModule','OxaPay\x20API\x20error:\x20','loggerService','Parsed\x20Result:','Status\x20Text:','under_paid_coverage','new','address','Track\x20ID:','message','toLowerCase','Status:','REFUND','log','getPaymentStatusFromCallback','../loggerService','application/json'];a69_0x32f8=function(){return _0x317823;};return a69_0x32f8();}const loggerService_1=require(a69_0x2284e5(0x1f8));class OxaPayService{constructor(){const _0xa48a3b=a69_0x2284e5;this[_0xa48a3b(0x234)]=_0xa48a3b(0x22f),this['apiKey']=process.env.OXAPAY_API_KEY||'WCXQ21-DL5OZP-H3SSHH-4GVAR4',!this[_0xa48a3b(0x21f)]?console['warn'](_0xa48a3b(0x20b)):console['log'](_0xa48a3b(0x1e8));}async[a69_0x2284e5(0x20e)](_0x3d9500){const _0x18a765=a69_0x2284e5,{orderId:_0x35f08d,amount:_0x4a08e2,currency:_0x10a3ba,payCurrency:_0x4d9e52,network:_0x3fcd3b,description:_0x28698b,customerEmail:_0x333fb2,lifetime:_0x261de6,feePaidByPayer:_0x1a35c1,underPaidCoverage:_0x1ae52e}=_0x3d9500;if(!this[_0x18a765(0x21f)])throw new Error('OxaPay\x20API\x20key\x20is\x20not\x20configured');const _0x5d580f={'amount':_0x4a08e2,'currency':_0x10a3ba['toLowerCase'](),'callback_url':'https://api.trapay.uk/api/oxapay/callback','order_id':_0x35f08d,'description':_0x28698b||'Order\x20#'+_0x35f08d};_0x4d9e52&&(_0x5d580f[_0x18a765(0x208)]=_0x4d9e52['toLowerCase']());_0x3fcd3b&&(_0x5d580f[_0x18a765(0x227)]=_0x3fcd3b);_0x333fb2&&(_0x5d580f[_0x18a765(0x21d)]=_0x333fb2);_0x261de6!==undefined?_0x5d580f[_0x18a765(0x21b)]=_0x261de6:_0x5d580f['lifetime']=0x3c;_0x1a35c1!==undefined&&(_0x5d580f[_0x18a765(0x226)]=_0x1a35c1);_0x1ae52e!==undefined&&(_0x5d580f[_0x18a765(0x1ee)]=_0x1ae52e);const _0x415c52=Date[_0x18a765(0x204)]();try{console[_0x18a765(0x1f6)](_0x18a765(0x22a)),console[_0x18a765(0x1f6)](_0x18a765(0x23e),this[_0x18a765(0x234)]),console[_0x18a765(0x1f6)](_0x18a765(0x1fb),JSON[_0x18a765(0x224)](_0x5d580f,null,0x2)),loggerService_1['loggerService'][_0x18a765(0x23c)](_0x18a765(0x209),_0x18a765(0x20f),'POST',_0x5d580f);const _0x42489f=await fetch(this['apiUrl'],{'method':_0x18a765(0x1e6),'headers':{'Content-Type':_0x18a765(0x1f9),'merchant_api_key':this[_0x18a765(0x21f)]},'body':JSON[_0x18a765(0x224)](_0x5d580f)}),_0x5272e2=Date[_0x18a765(0x204)]()-_0x415c52;console['log'](_0x18a765(0x22e)),console[_0x18a765(0x1f6)](_0x18a765(0x1f4),_0x42489f[_0x18a765(0x1fa)]),console[_0x18a765(0x1f6)](_0x18a765(0x1ed),_0x42489f[_0x18a765(0x235)]),console['log']('Response\x20Time:',_0x5272e2+'ms');const _0x3c097d=await _0x42489f[_0x18a765(0x22c)]();console[_0x18a765(0x1f6)](_0x18a765(0x231),_0x3c097d);let _0x299b32;try{_0x299b32=JSON[_0x18a765(0x1fc)](_0x3c097d);}catch(_0x491589){console['error']('Failed\x20to\x20parse\x20JSON\x20response:',_0x491589),loggerService_1[_0x18a765(0x1eb)][_0x18a765(0x21e)](_0x18a765(0x209),_0x18a765(0x20f),_0x18a765(0x203)+_0x491589);throw new Error('Invalid\x20JSON\x20response\x20from\x20OxaPay\x20API:\x20'+_0x3c097d);}console['log'](_0x18a765(0x23f)),console[_0x18a765(0x1f6)](_0x18a765(0x1ec),JSON[_0x18a765(0x224)](_0x299b32,null,0x2)),loggerService_1[_0x18a765(0x1eb)][_0x18a765(0x212)](_0x18a765(0x209),'/payment/white-label',_0x42489f[_0x18a765(0x1fa)],_0x299b32,_0x5272e2);if(_0x299b32[_0x18a765(0x1fa)]!==0xc8||!_0x299b32[_0x18a765(0x200)]){const _0x282449=_0x299b32[_0x18a765(0x219)]?.[_0x18a765(0x1f2)]||_0x299b32[_0x18a765(0x1f2)]||_0x18a765(0x23b);console[_0x18a765(0x219)](_0x18a765(0x232)),console[_0x18a765(0x219)](_0x18a765(0x237),_0x282449),console[_0x18a765(0x219)](_0x18a765(0x210),_0x299b32[_0x18a765(0x219)]),loggerService_1[_0x18a765(0x1eb)]['logWhiteDomainError'](_0x18a765(0x209),_0x18a765(0x20f),_0x18a765(0x218)+_0x282449);throw new Error(_0x18a765(0x1ea)+_0x282449);}if(!_0x299b32[_0x18a765(0x200)][_0x18a765(0x20c)]||!_0x299b32['data']['address']){console[_0x18a765(0x219)]('===\x20OXAPAY\x20API\x20INCOMPLETE\x20RESPONSE\x20==='),console[_0x18a765(0x219)](_0x18a765(0x214)),console[_0x18a765(0x219)](_0x18a765(0x236),_0x299b32[_0x18a765(0x200)]),loggerService_1['loggerService'][_0x18a765(0x21e)]('oxapay','/payment/white-label',_0x18a765(0x213));throw new Error(_0x18a765(0x23d));}console[_0x18a765(0x1f6)](_0x18a765(0x240)),console[_0x18a765(0x1f6)](_0x18a765(0x1f1),_0x299b32[_0x18a765(0x200)][_0x18a765(0x20c)]),console[_0x18a765(0x1f6)](_0x18a765(0x221),_0x299b32[_0x18a765(0x200)][_0x18a765(0x1f0)]),console[_0x18a765(0x1f6)](_0x18a765(0x20a),_0x299b32['data'][_0x18a765(0x239)],_0x299b32[_0x18a765(0x200)]['pay_currency']),console[_0x18a765(0x1f6)](_0x18a765(0x202),_0x299b32[_0x18a765(0x200)]['network']);const _0x43300d=_0x18a765(0x1ff)+_0x3d9500[_0x18a765(0x201)];return{'gateway_payment_id':_0x299b32[_0x18a765(0x200)]['track_id'],'payment_url':_0x43300d,'track_id':_0x299b32['data']['track_id'],'amount':_0x299b32[_0x18a765(0x200)][_0x18a765(0x233)],'currency':_0x299b32[_0x18a765(0x200)]['currency'],'pay_amount':_0x299b32['data']['pay_amount'],'pay_currency':_0x299b32[_0x18a765(0x200)][_0x18a765(0x208)],'network':_0x299b32['data'][_0x18a765(0x227)],'address':_0x299b32[_0x18a765(0x200)][_0x18a765(0x1f0)],'qr_code':_0x299b32[_0x18a765(0x200)]['qr_code'],'rate':_0x299b32[_0x18a765(0x200)][_0x18a765(0x1fe)],'expired_at':_0x299b32[_0x18a765(0x200)]['expired_at']};}catch(_0x160433){console[_0x18a765(0x219)](_0x18a765(0x215)),console[_0x18a765(0x219)](_0x18a765(0x216),_0x160433),loggerService_1[_0x18a765(0x1eb)][_0x18a765(0x21e)](_0x18a765(0x209),'/payment/white-label',_0x160433 instanceof Error?_0x160433['message']:String(_0x160433));throw _0x160433;}}[a69_0x2284e5(0x1f7)](_0x5e3b44){const _0x254ceb=a69_0x2284e5;switch(_0x5e3b44[_0x254ceb(0x1f3)]()){case _0x254ceb(0x1ef):return _0x254ceb(0x22b);case'waiting':return _0x254ceb(0x22b);case'paying':return _0x254ceb(0x229);case _0x254ceb(0x228):return'PAID';case _0x254ceb(0x207):return _0x254ceb(0x220);case _0x254ceb(0x238):return _0x254ceb(0x220);case'refunding':return'REFUND';case _0x254ceb(0x206):return _0x254ceb(0x1f5);case'expired':return'EXPIRED';default:return _0x254ceb(0x22b);}}}exports[a69_0x2284e5(0x205)]=OxaPayService,exports[a69_0x2284e5(0x20d)]=new OxaPayService();