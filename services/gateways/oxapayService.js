'use strict';function a67_0x9333(_0x350de1,_0x21a6bd){_0x350de1=_0x350de1-0x1a1;const _0x3914f7=a67_0x3914();let _0x933355=_0x3914f7[_0x350de1];return _0x933355;}const a67_0x91421b=a67_0x9333;(function(_0x603fb,_0x3c670e){const _0x193417=a67_0x9333,_0x3a3f2a=_0x603fb();while(!![]){try{const _0x275eab=-parseInt(_0x193417(0x1aa))/0x1+-parseInt(_0x193417(0x1ed))/0x2*(-parseInt(_0x193417(0x1ec))/0x3)+parseInt(_0x193417(0x1ef))/0x4+-parseInt(_0x193417(0x1c0))/0x5*(parseInt(_0x193417(0x1e2))/0x6)+parseInt(_0x193417(0x1de))/0x7*(-parseInt(_0x193417(0x1d4))/0x8)+-parseInt(_0x193417(0x1bf))/0x9+parseInt(_0x193417(0x1a1))/0xa;if(_0x275eab===_0x3c670e)break;else _0x3a3f2a['push'](_0x3a3f2a['shift']());}catch(_0x3ce493){_0x3a3f2a['push'](_0x3a3f2a['shift']());}}}(a67_0x3914,0x5da33));Object[a67_0x91421b(0x1c8)](exports,a67_0x91421b(0x1f1),{'value':!![]}),exports['oxapayService']=exports[a67_0x91421b(0x1ad)]=void 0x0;function a67_0x3914(){const _0x6cb399=['6836265HSbAvs','60gQrcSL','Parsed\x20Result:','waiting','application/json','currency','../loggerService','===\x20OXAPAY\x20API\x20REQUEST\x20===','status','defineProperty','‚ö†Ô∏è\x20OXAPAY_API_KEY\x20not\x20found\x20in\x20environment\x20variables','lifetime','paymentId','POST','refunding','===\x20OXAPAY\x20API\x20ERROR\x20===','pay_currency','logWhiteDomainError','loggerService','===\x20OXAPAY\x20API\x20RESPONSE\x20===','Amount:','5873064PhLGIm','===\x20OXAPAY\x20API\x20INCOMPLETE\x20RESPONSE\x20===','oxapayService','error','under_paid_coverage','Request\x20Body:','fee_paid_by_payer','PENDING','refunded','stringify','7ujXUxC','oxapay','paid','OxaPay\x20API\x20key\x20is\x20not\x20configured','318834RPXnoA','data','===\x20OXAPAY\x20REQUEST\x20ERROR\x20===','log','getPaymentStatusFromCallback','text','Unknown\x20error\x20from\x20OxaPay\x20API','pay_amount','address','Incomplete\x20response:\x20missing\x20track_id\x20or\x20address','621ofxItz','1636tqnGpj','REFUND','221884oyNCjJ','PAID','__esModule','manual_accept','createPayment','qr_code','expired','track_id','https://api.oxapay.com/v1/payment/white-label','Track\x20ID:','apiKey','https://app.trapay.uk/payment/','27012480FSwyqh','/payment/white-label','Response\x20data:','WCXQ21-DL5OZP-H3SSHH-4GVAR4','amount','Status\x20Text:','JSON\x20Parse\x20Error:\x20','URL:','Failed\x20to\x20parse\x20JSON\x20response:','411120xgTMMq','üí∞\x20OxaPay\x20service\x20initialized','toLowerCase','OxaPayService','message','now','Invalid\x20JSON\x20response\x20from\x20OxaPay\x20API:\x20','email','logWhiteDomainRequest','network','Error:','expired_at','Missing\x20track_id\x20or\x20address\x20in\x20response','===\x20PARSED\x20OXAPAY\x20RESPONSE\x20===','Status:','Address:','warn','paying','OxaPay\x20API\x20error:\x20','apiUrl','parse'];a67_0x3914=function(){return _0x6cb399;};return a67_0x3914();}const loggerService_1=require(a67_0x91421b(0x1c5));class OxaPayService{constructor(){const _0x11df17=a67_0x91421b;this[_0x11df17(0x1bd)]=_0x11df17(0x1f7),this['apiKey']=process.env.OXAPAY_API_KEY||_0x11df17(0x1a4),!this[_0x11df17(0x1f9)]?console[_0x11df17(0x1ba)](_0x11df17(0x1c9)):console[_0x11df17(0x1e5)](_0x11df17(0x1ab));}async[a67_0x91421b(0x1f3)](_0x5bc6e9){const _0x25d792=a67_0x91421b,{orderId:_0x3d8456,amount:_0x4a7eba,currency:_0x34f938,payCurrency:_0x54787d,network:_0x2f769b,description:_0x617bae,customerEmail:_0x5ccdc3,lifetime:_0x5c5e2f,feePaidByPayer:_0x28aee2,underPaidCoverage:_0x262d7f}=_0x5bc6e9;if(!this['apiKey'])throw new Error(_0x25d792(0x1e1));const _0x425989={'amount':_0x4a7eba,'currency':_0x34f938[_0x25d792(0x1ac)](),'callback_url':'https://api.trapay.uk/api/oxapay/callback','order_id':_0x3d8456,'description':_0x617bae||'Order\x20#'+_0x3d8456};_0x54787d&&(_0x425989[_0x25d792(0x1cf)]=_0x54787d[_0x25d792(0x1ac)]());_0x2f769b&&(_0x425989['network']=_0x2f769b);_0x5ccdc3&&(_0x425989[_0x25d792(0x1b1)]=_0x5ccdc3);_0x5c5e2f!==undefined?_0x425989['lifetime']=_0x5c5e2f:_0x425989[_0x25d792(0x1ca)]=0x3c;_0x28aee2!==undefined&&(_0x425989[_0x25d792(0x1da)]=_0x28aee2);_0x262d7f!==undefined&&(_0x425989[_0x25d792(0x1d8)]=_0x262d7f);const _0x1fbfeb=Date['now']();try{console[_0x25d792(0x1e5)](_0x25d792(0x1c6)),console[_0x25d792(0x1e5)](_0x25d792(0x1a8),this[_0x25d792(0x1bd)]),console[_0x25d792(0x1e5)](_0x25d792(0x1d9),JSON[_0x25d792(0x1dd)](_0x425989,null,0x2)),loggerService_1[_0x25d792(0x1d1)][_0x25d792(0x1b2)](_0x25d792(0x1df),_0x25d792(0x1a2),_0x25d792(0x1cc),_0x425989);const _0x3b5039=await fetch(this['apiUrl'],{'method':'POST','headers':{'Content-Type':_0x25d792(0x1c3),'merchant_api_key':this[_0x25d792(0x1f9)]},'body':JSON['stringify'](_0x425989)}),_0x884a42=Date[_0x25d792(0x1af)]()-_0x1fbfeb;console[_0x25d792(0x1e5)](_0x25d792(0x1d2)),console[_0x25d792(0x1e5)](_0x25d792(0x1b8),_0x3b5039['status']),console[_0x25d792(0x1e5)](_0x25d792(0x1a6),_0x3b5039['statusText']),console[_0x25d792(0x1e5)]('Response\x20Time:',_0x884a42+'ms');const _0x5144a6=await _0x3b5039[_0x25d792(0x1e7)]();console[_0x25d792(0x1e5)]('Raw\x20Response\x20Body:',_0x5144a6);let _0x255213;try{_0x255213=JSON[_0x25d792(0x1be)](_0x5144a6);}catch(_0x4cad17){console[_0x25d792(0x1d7)](_0x25d792(0x1a9),_0x4cad17),loggerService_1['loggerService']['logWhiteDomainError']('oxapay','/payment/white-label',_0x25d792(0x1a7)+_0x4cad17);throw new Error(_0x25d792(0x1b0)+_0x5144a6);}console[_0x25d792(0x1e5)](_0x25d792(0x1b7)),console[_0x25d792(0x1e5)](_0x25d792(0x1c1),JSON[_0x25d792(0x1dd)](_0x255213,null,0x2)),loggerService_1[_0x25d792(0x1d1)]['logWhiteDomainResponse'](_0x25d792(0x1df),_0x25d792(0x1a2),_0x3b5039[_0x25d792(0x1c7)],_0x255213,_0x884a42);if(_0x255213[_0x25d792(0x1c7)]!==0xc8||!_0x255213[_0x25d792(0x1e3)]){const _0x44ba27=_0x255213[_0x25d792(0x1d7)]?.['message']||_0x255213[_0x25d792(0x1ae)]||_0x25d792(0x1e8);console[_0x25d792(0x1d7)](_0x25d792(0x1ce)),console[_0x25d792(0x1d7)]('Error\x20Message:',_0x44ba27),console[_0x25d792(0x1d7)]('Error\x20Details:',_0x255213[_0x25d792(0x1d7)]),loggerService_1['loggerService'][_0x25d792(0x1d0)](_0x25d792(0x1df),_0x25d792(0x1a2),'API\x20Error:\x20'+_0x44ba27);throw new Error(_0x25d792(0x1bc)+_0x44ba27);}if(!_0x255213[_0x25d792(0x1e3)][_0x25d792(0x1f6)]||!_0x255213[_0x25d792(0x1e3)]['address']){console[_0x25d792(0x1d7)](_0x25d792(0x1d5)),console[_0x25d792(0x1d7)](_0x25d792(0x1b6)),console[_0x25d792(0x1d7)](_0x25d792(0x1a3),_0x255213['data']),loggerService_1[_0x25d792(0x1d1)][_0x25d792(0x1d0)](_0x25d792(0x1df),_0x25d792(0x1a2),_0x25d792(0x1eb));throw new Error('Invalid\x20response\x20from\x20OxaPay\x20API:\x20missing\x20track_id\x20or\x20address');}console[_0x25d792(0x1e5)]('===\x20OXAPAY\x20SUCCESS\x20==='),console[_0x25d792(0x1e5)](_0x25d792(0x1f8),_0x255213[_0x25d792(0x1e3)]['track_id']),console[_0x25d792(0x1e5)](_0x25d792(0x1b9),_0x255213[_0x25d792(0x1e3)][_0x25d792(0x1ea)]),console[_0x25d792(0x1e5)](_0x25d792(0x1d3),_0x255213['data'][_0x25d792(0x1e9)],_0x255213['data']['pay_currency']),console[_0x25d792(0x1e5)]('Network:',_0x255213[_0x25d792(0x1e3)][_0x25d792(0x1b3)]);const _0x45ce01=_0x25d792(0x1fa)+_0x5bc6e9[_0x25d792(0x1cb)];return{'gateway_payment_id':_0x255213['data'][_0x25d792(0x1f6)],'payment_url':_0x45ce01,'track_id':_0x255213[_0x25d792(0x1e3)][_0x25d792(0x1f6)],'amount':_0x255213['data'][_0x25d792(0x1a5)],'currency':_0x255213[_0x25d792(0x1e3)][_0x25d792(0x1c4)],'pay_amount':_0x255213['data'][_0x25d792(0x1e9)],'pay_currency':_0x255213[_0x25d792(0x1e3)][_0x25d792(0x1cf)],'network':_0x255213['data'][_0x25d792(0x1b3)],'address':_0x255213[_0x25d792(0x1e3)]['address'],'qr_code':_0x255213['data'][_0x25d792(0x1f4)],'rate':_0x255213['data']['rate'],'expired_at':_0x255213[_0x25d792(0x1e3)][_0x25d792(0x1b5)]};}catch(_0x14e248){console[_0x25d792(0x1d7)](_0x25d792(0x1e4)),console['error'](_0x25d792(0x1b4),_0x14e248),loggerService_1[_0x25d792(0x1d1)][_0x25d792(0x1d0)]('oxapay','/payment/white-label',_0x14e248 instanceof Error?_0x14e248[_0x25d792(0x1ae)]:String(_0x14e248));throw _0x14e248;}}[a67_0x91421b(0x1e6)](_0x2c4188){const _0x47883f=a67_0x91421b;switch(_0x2c4188[_0x47883f(0x1ac)]()){case'new':return _0x47883f(0x1db);case _0x47883f(0x1c2):return _0x47883f(0x1db);case _0x47883f(0x1bb):return'PROCESSING';case _0x47883f(0x1e0):return _0x47883f(0x1f0);case _0x47883f(0x1f2):return _0x47883f(0x1f0);case'underpaid':return'PAID';case _0x47883f(0x1cd):return _0x47883f(0x1ee);case _0x47883f(0x1dc):return _0x47883f(0x1ee);case _0x47883f(0x1f5):return'EXPIRED';default:return _0x47883f(0x1db);}}}exports[a67_0x91421b(0x1ad)]=OxaPayService,exports[a67_0x91421b(0x1d6)]=new OxaPayService();