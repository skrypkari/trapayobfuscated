'use strict';const a67_0x370aac=a67_0x5db6;function a67_0x5db6(_0x58059d,_0x306fdb){_0x58059d=_0x58059d-0x159;const _0x2b108a=a67_0x2b10();let _0x5db688=_0x2b108a[_0x58059d];return _0x5db688;}function a67_0x2b10(){const _0x28f1e5=['‚ö†Ô∏è\x20OXAPAY_API_KEY\x20not\x20found\x20in\x20environment\x20variables','Error\x20Message:','https://api.oxapay.com/v1/payment/white-label','Track\x20ID:','statusText','oxapayService','underpaid','lifetime','address','===\x20OXAPAY\x20API\x20RESPONSE\x20===','Status\x20Text:','application/json','under_paid_coverage','Status:','fee_paid_by_payer','toLowerCase','152xUyUVk','Error\x20Details:','amount','expired_at','../loggerService','URL:','https://app.trapay.uk/payment/','5478400iHdXFP','266370KyxKCt','Failed\x20to\x20parse\x20JSON\x20response:','apiUrl','Network:','refunding','2251062IZjHcZ','defineProperty','error','Amount:','773zLuGlh','pay_amount','6358986rAIlTc','===\x20OXAPAY\x20REQUEST\x20ERROR\x20===','===\x20OXAPAY\x20SUCCESS\x20===','Request\x20Body:','paymentId','log','API\x20Error:\x20','getPaymentStatusFromCallback','9414530VtyPlK','message','PENDING','logWhiteDomainError','stringify','status','now','network','PROCESSING','__esModule','POST','loggerService','manual_accept','text','refunded','logWhiteDomainResponse','Raw\x20Response\x20Body:','paid','qr_code','oxapay','6yCUhtz','OxaPay\x20API\x20key\x20is\x20not\x20configured','new','currency','===\x20OXAPAY\x20API\x20REQUEST\x20===','PAID','/payment/white-label','paying','36HQQiUh','üí∞\x20OxaPay\x20service\x20initialized','apiKey','data','5321393sBAVYh','Error:','OxaPay\x20API\x20error:\x20','===\x20OXAPAY\x20API\x20ERROR\x20===','Unknown\x20error\x20from\x20OxaPay\x20API','===\x20PARSED\x20OXAPAY\x20RESPONSE\x20===','track_id','Incomplete\x20response:\x20missing\x20track_id\x20or\x20address','OxaPayService','pay_currency','Parsed\x20Result:','parse','createPayment','rate'];a67_0x2b10=function(){return _0x28f1e5;};return a67_0x2b10();}(function(_0x154499,_0x51004c){const _0x2f205b=a67_0x5db6,_0x1f2695=_0x154499();while(!![]){try{const _0x545c13=parseInt(_0x2f205b(0x19f))/0x1*(-parseInt(_0x2f205b(0x18e))/0x2)+parseInt(_0x2f205b(0x19b))/0x3+-parseInt(_0x2f205b(0x16c))/0x4*(parseInt(_0x2f205b(0x196))/0x5)+parseInt(_0x2f205b(0x164))/0x6*(-parseInt(_0x2f205b(0x170))/0x7)+-parseInt(_0x2f205b(0x195))/0x8+parseInt(_0x2f205b(0x1a1))/0x9+parseInt(_0x2f205b(0x1a9))/0xa;if(_0x545c13===_0x51004c)break;else _0x1f2695['push'](_0x1f2695['shift']());}catch(_0x5d1cd7){_0x1f2695['push'](_0x1f2695['shift']());}}}(a67_0x2b10,0x655ac));Object[a67_0x370aac(0x19c)](exports,a67_0x370aac(0x159),{'value':!![]}),exports[a67_0x370aac(0x183)]=exports[a67_0x370aac(0x178)]=void 0x0;const loggerService_1=require(a67_0x370aac(0x192));class OxaPayService{constructor(){const _0x3b28db=a67_0x370aac;this[_0x3b28db(0x198)]=_0x3b28db(0x180),this['apiKey']=process.env.OXAPAY_API_KEY||'WCXQ21-DL5OZP-H3SSHH-4GVAR4',!this['apiKey']?console['warn'](_0x3b28db(0x17e)):console[_0x3b28db(0x1a6)](_0x3b28db(0x16d));}async[a67_0x370aac(0x17c)](_0x11f0f4){const _0x284c11=a67_0x370aac,{orderId:_0x217d9e,amount:_0xb9af89,currency:_0x53647b,payCurrency:_0x3d7e56,network:_0x4655dc,description:_0x197da1,customerEmail:_0x5e3a07,lifetime:_0x7b2301,feePaidByPayer:_0xca1176,underPaidCoverage:_0x4f3e42}=_0x11f0f4;if(!this[_0x284c11(0x16e)])throw new Error(_0x284c11(0x165));const _0x2f7a96={'amount':_0xb9af89,'currency':_0x53647b[_0x284c11(0x18d)](),'callback_url':'https://api.trapay.uk/api/oxapay/callback','order_id':_0x217d9e,'description':_0x197da1||'Order\x20#'+_0x217d9e};_0x3d7e56&&(_0x2f7a96[_0x284c11(0x179)]=_0x3d7e56[_0x284c11(0x18d)]());_0x4655dc&&(_0x2f7a96[_0x284c11(0x1b0)]=_0x4655dc);_0x5e3a07&&(_0x2f7a96['email']=_0x5e3a07);_0x7b2301!==undefined?_0x2f7a96[_0x284c11(0x185)]=_0x7b2301:_0x2f7a96[_0x284c11(0x185)]=0x3c;_0xca1176!==undefined&&(_0x2f7a96[_0x284c11(0x18c)]=_0xca1176);_0x4f3e42!==undefined&&(_0x2f7a96[_0x284c11(0x18a)]=_0x4f3e42);const _0x451360=Date[_0x284c11(0x1af)]();try{console[_0x284c11(0x1a6)](_0x284c11(0x168)),console['log'](_0x284c11(0x193),this[_0x284c11(0x198)]),console[_0x284c11(0x1a6)](_0x284c11(0x1a4),JSON[_0x284c11(0x1ad)](_0x2f7a96,null,0x2)),loggerService_1['loggerService']['logWhiteDomainRequest'](_0x284c11(0x163),'/payment/white-label',_0x284c11(0x15a),_0x2f7a96);const _0x45095a=await fetch(this['apiUrl'],{'method':_0x284c11(0x15a),'headers':{'Content-Type':_0x284c11(0x189),'merchant_api_key':this[_0x284c11(0x16e)]},'body':JSON[_0x284c11(0x1ad)](_0x2f7a96)}),_0x604827=Date[_0x284c11(0x1af)]()-_0x451360;console[_0x284c11(0x1a6)](_0x284c11(0x187)),console[_0x284c11(0x1a6)](_0x284c11(0x18b),_0x45095a[_0x284c11(0x1ae)]),console['log'](_0x284c11(0x188),_0x45095a[_0x284c11(0x182)]),console[_0x284c11(0x1a6)]('Response\x20Time:',_0x604827+'ms');const _0xa1d029=await _0x45095a[_0x284c11(0x15d)]();console[_0x284c11(0x1a6)](_0x284c11(0x160),_0xa1d029);let _0x33c2e1;try{_0x33c2e1=JSON[_0x284c11(0x17b)](_0xa1d029);}catch(_0x257f6e){console[_0x284c11(0x19d)](_0x284c11(0x197),_0x257f6e),loggerService_1[_0x284c11(0x15b)][_0x284c11(0x1ac)](_0x284c11(0x163),_0x284c11(0x16a),'JSON\x20Parse\x20Error:\x20'+_0x257f6e);throw new Error('Invalid\x20JSON\x20response\x20from\x20OxaPay\x20API:\x20'+_0xa1d029);}console['log'](_0x284c11(0x175)),console[_0x284c11(0x1a6)](_0x284c11(0x17a),JSON[_0x284c11(0x1ad)](_0x33c2e1,null,0x2)),loggerService_1[_0x284c11(0x15b)][_0x284c11(0x15f)](_0x284c11(0x163),_0x284c11(0x16a),_0x45095a['status'],_0x33c2e1,_0x604827);if(_0x33c2e1[_0x284c11(0x1ae)]!==0xc8||!_0x33c2e1[_0x284c11(0x16f)]){const _0x150360=_0x33c2e1[_0x284c11(0x19d)]?.[_0x284c11(0x1aa)]||_0x33c2e1[_0x284c11(0x1aa)]||_0x284c11(0x174);console[_0x284c11(0x19d)](_0x284c11(0x173)),console[_0x284c11(0x19d)](_0x284c11(0x17f),_0x150360),console[_0x284c11(0x19d)](_0x284c11(0x18f),_0x33c2e1[_0x284c11(0x19d)]),loggerService_1[_0x284c11(0x15b)]['logWhiteDomainError'](_0x284c11(0x163),_0x284c11(0x16a),_0x284c11(0x1a7)+_0x150360);throw new Error(_0x284c11(0x172)+_0x150360);}if(!_0x33c2e1['data'][_0x284c11(0x176)]||!_0x33c2e1[_0x284c11(0x16f)]['address']){console[_0x284c11(0x19d)]('===\x20OXAPAY\x20API\x20INCOMPLETE\x20RESPONSE\x20==='),console[_0x284c11(0x19d)]('Missing\x20track_id\x20or\x20address\x20in\x20response'),console['error']('Response\x20data:',_0x33c2e1['data']),loggerService_1[_0x284c11(0x15b)][_0x284c11(0x1ac)](_0x284c11(0x163),_0x284c11(0x16a),_0x284c11(0x177));throw new Error('Invalid\x20response\x20from\x20OxaPay\x20API:\x20missing\x20track_id\x20or\x20address');}console[_0x284c11(0x1a6)](_0x284c11(0x1a3)),console[_0x284c11(0x1a6)](_0x284c11(0x181),_0x33c2e1[_0x284c11(0x16f)]['track_id']),console[_0x284c11(0x1a6)]('Address:',_0x33c2e1[_0x284c11(0x16f)]['address']),console[_0x284c11(0x1a6)](_0x284c11(0x19e),_0x33c2e1[_0x284c11(0x16f)]['pay_amount'],_0x33c2e1['data'][_0x284c11(0x179)]),console[_0x284c11(0x1a6)](_0x284c11(0x199),_0x33c2e1[_0x284c11(0x16f)][_0x284c11(0x1b0)]);const _0x2bff02=_0x284c11(0x194)+_0x11f0f4[_0x284c11(0x1a5)];return{'gateway_payment_id':_0x33c2e1[_0x284c11(0x16f)]['track_id'],'payment_url':_0x2bff02,'track_id':_0x33c2e1['data'][_0x284c11(0x176)],'amount':_0x33c2e1['data'][_0x284c11(0x190)],'currency':_0x33c2e1[_0x284c11(0x16f)][_0x284c11(0x167)],'pay_amount':_0x33c2e1[_0x284c11(0x16f)][_0x284c11(0x1a0)],'pay_currency':_0x33c2e1[_0x284c11(0x16f)]['pay_currency'],'network':_0x33c2e1[_0x284c11(0x16f)][_0x284c11(0x1b0)],'address':_0x33c2e1[_0x284c11(0x16f)][_0x284c11(0x186)],'qr_code':_0x33c2e1['data'][_0x284c11(0x162)],'rate':_0x33c2e1[_0x284c11(0x16f)][_0x284c11(0x17d)],'expired_at':_0x33c2e1[_0x284c11(0x16f)][_0x284c11(0x191)]};}catch(_0x1f1d32){console[_0x284c11(0x19d)](_0x284c11(0x1a2)),console[_0x284c11(0x19d)](_0x284c11(0x171),_0x1f1d32),loggerService_1[_0x284c11(0x15b)]['logWhiteDomainError'](_0x284c11(0x163),_0x284c11(0x16a),_0x1f1d32 instanceof Error?_0x1f1d32['message']:String(_0x1f1d32));throw _0x1f1d32;}}[a67_0x370aac(0x1a8)](_0x1734ff){const _0x324b74=a67_0x370aac;switch(_0x1734ff[_0x324b74(0x18d)]()){case _0x324b74(0x166):return _0x324b74(0x1ab);case'waiting':return _0x324b74(0x1ab);case _0x324b74(0x16b):return _0x324b74(0x1b1);case _0x324b74(0x161):return _0x324b74(0x169);case _0x324b74(0x15c):return _0x324b74(0x169);case _0x324b74(0x184):return _0x324b74(0x169);case _0x324b74(0x19a):return'REFUND';case _0x324b74(0x15e):return'REFUND';case'expired':return'EXPIRED';default:return _0x324b74(0x1ab);}}}exports[a67_0x370aac(0x178)]=OxaPayService,exports[a67_0x370aac(0x183)]=new OxaPayService();