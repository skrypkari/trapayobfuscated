'use strict';const a69_0x51dd3c=a69_0x40c4;(function(_0x5d93fd,_0x4d1b9c){const _0x283c03=a69_0x40c4,_0x1312c3=_0x5d93fd();while(!![]){try{const _0x3f65f4=-parseInt(_0x283c03(0x160))/0x1*(parseInt(_0x283c03(0x152))/0x2)+parseInt(_0x283c03(0x15e))/0x3*(-parseInt(_0x283c03(0x182))/0x4)+-parseInt(_0x283c03(0x16a))/0x5*(-parseInt(_0x283c03(0x176))/0x6)+-parseInt(_0x283c03(0x179))/0x7+parseInt(_0x283c03(0x18d))/0x8+parseInt(_0x283c03(0x17f))/0x9+parseInt(_0x283c03(0x145))/0xa;if(_0x3f65f4===_0x4d1b9c)break;else _0x1312c3['push'](_0x1312c3['shift']());}catch(_0x33eefa){_0x1312c3['push'](_0x1312c3['shift']());}}}(a69_0x47ff,0x96224));function a69_0x47ff(){const _0x577c8f=['50682eAOmcY','data','Raw\x20Response\x20Body:','statusText','Missing\x20track_id\x20or\x20address\x20in\x20response','email','oxapay','Request\x20Body:','qr_code','===\x20OXAPAY\x20REQUEST\x20ERROR\x20===','JSON\x20Parse\x20Error:\x20','URL:','6069cCZvDZ','PENDING','18oNvhhC','OxaPayService','https://api.trapay.uk/api/oxapay/callback','https://app.trapay.uk/payment/','refunded','Address:','refunding','application/json','/payment/white-label','address','137965KgwInf','API\x20Error:\x20','EXPIRED','WCXQ21-DL5OZP-H3SSHH-4GVAR4','lifetime','error','new','status','currency','Invalid\x20response\x20from\x20OxaPay\x20API:\x20missing\x20track_id\x20or\x20address','Error\x20Message:','expired','6yvPhqP','===\x20OXAPAY\x20API\x20REQUEST\x20===','network','3741542voCuMd','parse','text','===\x20OXAPAY\x20SUCCESS\x20===','Incomplete\x20response:\x20missing\x20track_id\x20or\x20address','expired_at','9260577ACIhVO','logWhiteDomainError','===\x20OXAPAY\x20API\x20INCOMPLETE\x20RESPONSE\x20===','1928iSmusp','message','track_id','paymentId','pay_currency','rate','===\x20OXAPAY\x20API\x20RESPONSE\x20===','‚ö†Ô∏è\x20OXAPAY_API_KEY\x20not\x20found\x20in\x20environment\x20variables','POST','__esModule','oxapayService','7819512CjIOIV','paid','Unknown\x20error\x20from\x20OxaPay\x20API','fee_paid_by_payer','toLowerCase','../loggerService','Amount:','amount','Network:','https://api.oxapay.com/v1/payment/white-label','pay_amount','apiUrl','Error:','PAID','createPayment','OxaPay\x20API\x20key\x20is\x20not\x20configured','5466930YxyFvo','defineProperty','logWhiteDomainResponse','log','OxaPay\x20API\x20error:\x20','under_paid_coverage','===\x20OXAPAY\x20API\x20ERROR\x20===','now','apiKey','loggerService','warn','underpaid','stringify'];a69_0x47ff=function(){return _0x577c8f;};return a69_0x47ff();}function a69_0x40c4(_0xb510a6,_0x1b83c0){_0xb510a6=_0xb510a6-0x13f;const _0x47ff42=a69_0x47ff();let _0x40c43b=_0x47ff42[_0xb510a6];return _0x40c43b;}Object[a69_0x51dd3c(0x146)](exports,a69_0x51dd3c(0x18b),{'value':!![]}),exports['oxapayService']=exports[a69_0x51dd3c(0x161)]=void 0x0;const loggerService_1=require(a69_0x51dd3c(0x192));class OxaPayService{constructor(){const _0x1a0f6f=a69_0x51dd3c;this[_0x1a0f6f(0x140)]=_0x1a0f6f(0x196),this['apiKey']=process.env.OXAPAY_API_KEY||_0x1a0f6f(0x16d),!this[_0x1a0f6f(0x14d)]?console[_0x1a0f6f(0x14f)](_0x1a0f6f(0x189)):console['log']('üí∞\x20OxaPay\x20service\x20initialized');}async[a69_0x51dd3c(0x143)](_0xd97385){const _0x3e5334=a69_0x51dd3c,{orderId:_0x2a25aa,amount:_0x385490,currency:_0x1080d1,payCurrency:_0x4c7818,network:_0x2afb66,description:_0x3e321a,customerEmail:_0x4bb60a,lifetime:_0x265986,feePaidByPayer:_0x24aef6,underPaidCoverage:_0x438594}=_0xd97385;if(!this[_0x3e5334(0x14d)])throw new Error(_0x3e5334(0x144));const _0x149b36={'amount':_0x385490,'currency':_0x1080d1[_0x3e5334(0x191)](),'callback_url':_0x3e5334(0x162),'order_id':_0x2a25aa,'description':_0x3e321a||'Order\x20#'+_0x2a25aa};_0x4c7818&&(_0x149b36[_0x3e5334(0x186)]=_0x4c7818[_0x3e5334(0x191)]());_0x2afb66&&(_0x149b36[_0x3e5334(0x178)]=_0x2afb66);_0x4bb60a&&(_0x149b36[_0x3e5334(0x157)]=_0x4bb60a);_0x265986!==undefined?_0x149b36[_0x3e5334(0x16e)]=_0x265986:_0x149b36[_0x3e5334(0x16e)]=0x3c;_0x24aef6!==undefined&&(_0x149b36[_0x3e5334(0x190)]=_0x24aef6);_0x438594!==undefined&&(_0x149b36[_0x3e5334(0x14a)]=_0x438594);const _0x2d6a6a=Date[_0x3e5334(0x14c)]();try{console['log'](_0x3e5334(0x177)),console[_0x3e5334(0x148)](_0x3e5334(0x15d),this['apiUrl']),console['log'](_0x3e5334(0x159),JSON['stringify'](_0x149b36,null,0x2)),loggerService_1[_0x3e5334(0x14e)]['logWhiteDomainRequest']('oxapay',_0x3e5334(0x168),_0x3e5334(0x18a),_0x149b36);const _0x167d7f=await fetch(this[_0x3e5334(0x140)],{'method':_0x3e5334(0x18a),'headers':{'Content-Type':_0x3e5334(0x167),'merchant_api_key':this[_0x3e5334(0x14d)]},'body':JSON[_0x3e5334(0x151)](_0x149b36)}),_0x10b7e6=Date[_0x3e5334(0x14c)]()-_0x2d6a6a;console[_0x3e5334(0x148)](_0x3e5334(0x188)),console[_0x3e5334(0x148)]('Status:',_0x167d7f[_0x3e5334(0x171)]),console[_0x3e5334(0x148)]('Status\x20Text:',_0x167d7f[_0x3e5334(0x155)]),console[_0x3e5334(0x148)]('Response\x20Time:',_0x10b7e6+'ms');const _0x455400=await _0x167d7f[_0x3e5334(0x17b)]();console[_0x3e5334(0x148)](_0x3e5334(0x154),_0x455400);let _0x2decbf;try{_0x2decbf=JSON[_0x3e5334(0x17a)](_0x455400);}catch(_0x10c921){console[_0x3e5334(0x16f)]('Failed\x20to\x20parse\x20JSON\x20response:',_0x10c921),loggerService_1[_0x3e5334(0x14e)]['logWhiteDomainError'](_0x3e5334(0x158),'/payment/white-label',_0x3e5334(0x15c)+_0x10c921);throw new Error('Invalid\x20JSON\x20response\x20from\x20OxaPay\x20API:\x20'+_0x455400);}console[_0x3e5334(0x148)]('===\x20PARSED\x20OXAPAY\x20RESPONSE\x20==='),console['log']('Parsed\x20Result:',JSON[_0x3e5334(0x151)](_0x2decbf,null,0x2)),loggerService_1[_0x3e5334(0x14e)][_0x3e5334(0x147)](_0x3e5334(0x158),_0x3e5334(0x168),_0x167d7f[_0x3e5334(0x171)],_0x2decbf,_0x10b7e6);if(_0x2decbf[_0x3e5334(0x171)]!==0xc8||!_0x2decbf[_0x3e5334(0x153)]){const _0xcf9394=_0x2decbf[_0x3e5334(0x16f)]?.[_0x3e5334(0x183)]||_0x2decbf['message']||_0x3e5334(0x18f);console[_0x3e5334(0x16f)](_0x3e5334(0x14b)),console[_0x3e5334(0x16f)](_0x3e5334(0x174),_0xcf9394),console[_0x3e5334(0x16f)]('Error\x20Details:',_0x2decbf[_0x3e5334(0x16f)]),loggerService_1[_0x3e5334(0x14e)][_0x3e5334(0x180)](_0x3e5334(0x158),_0x3e5334(0x168),_0x3e5334(0x16b)+_0xcf9394);throw new Error(_0x3e5334(0x149)+_0xcf9394);}if(!_0x2decbf[_0x3e5334(0x153)][_0x3e5334(0x184)]||!_0x2decbf[_0x3e5334(0x153)][_0x3e5334(0x169)]){console[_0x3e5334(0x16f)](_0x3e5334(0x181)),console[_0x3e5334(0x16f)](_0x3e5334(0x156)),console[_0x3e5334(0x16f)]('Response\x20data:',_0x2decbf[_0x3e5334(0x153)]),loggerService_1[_0x3e5334(0x14e)][_0x3e5334(0x180)](_0x3e5334(0x158),_0x3e5334(0x168),_0x3e5334(0x17d));throw new Error(_0x3e5334(0x173));}console[_0x3e5334(0x148)](_0x3e5334(0x17c)),console['log']('Track\x20ID:',_0x2decbf[_0x3e5334(0x153)][_0x3e5334(0x184)]),console[_0x3e5334(0x148)](_0x3e5334(0x165),_0x2decbf['data'][_0x3e5334(0x169)]),console['log'](_0x3e5334(0x193),_0x2decbf[_0x3e5334(0x153)]['pay_amount'],_0x2decbf['data'][_0x3e5334(0x186)]),console[_0x3e5334(0x148)](_0x3e5334(0x195),_0x2decbf[_0x3e5334(0x153)][_0x3e5334(0x178)]);const _0x25b09d=_0x3e5334(0x163)+_0xd97385[_0x3e5334(0x185)];return{'gateway_payment_id':_0x2decbf[_0x3e5334(0x153)]['track_id'],'payment_url':_0x25b09d,'track_id':_0x2decbf[_0x3e5334(0x153)][_0x3e5334(0x184)],'amount':_0x2decbf[_0x3e5334(0x153)][_0x3e5334(0x194)],'currency':_0x2decbf[_0x3e5334(0x153)][_0x3e5334(0x172)],'pay_amount':_0x2decbf[_0x3e5334(0x153)][_0x3e5334(0x13f)],'pay_currency':_0x2decbf[_0x3e5334(0x153)][_0x3e5334(0x186)],'network':_0x2decbf[_0x3e5334(0x153)][_0x3e5334(0x178)],'address':_0x2decbf[_0x3e5334(0x153)][_0x3e5334(0x169)],'qr_code':_0x2decbf[_0x3e5334(0x153)][_0x3e5334(0x15a)],'rate':_0x2decbf[_0x3e5334(0x153)][_0x3e5334(0x187)],'expired_at':_0x2decbf[_0x3e5334(0x153)][_0x3e5334(0x17e)]};}catch(_0x48f882){console['error'](_0x3e5334(0x15b)),console[_0x3e5334(0x16f)](_0x3e5334(0x141),_0x48f882),loggerService_1[_0x3e5334(0x14e)][_0x3e5334(0x180)]('oxapay',_0x3e5334(0x168),_0x48f882 instanceof Error?_0x48f882[_0x3e5334(0x183)]:String(_0x48f882));throw _0x48f882;}}['getPaymentStatusFromCallback'](_0x306770){const _0x1cb3c0=a69_0x51dd3c;switch(_0x306770[_0x1cb3c0(0x191)]()){case _0x1cb3c0(0x170):return _0x1cb3c0(0x15f);case'waiting':return'PENDING';case'paying':return'PROCESSING';case _0x1cb3c0(0x18e):return _0x1cb3c0(0x142);case'manual_accept':return _0x1cb3c0(0x142);case _0x1cb3c0(0x150):return _0x1cb3c0(0x142);case _0x1cb3c0(0x166):return'REFUND';case _0x1cb3c0(0x164):return'REFUND';case _0x1cb3c0(0x175):return _0x1cb3c0(0x16c);default:return'PENDING';}}}exports[a69_0x51dd3c(0x161)]=OxaPayService,exports[a69_0x51dd3c(0x18c)]=new OxaPayService();