'use strict';const a65_0x9c23d4=a65_0x2cbe;function a65_0x4c53(){const _0x28524d=['error','lifetime','===\x20OXAPAY\x20API\x20RESPONSE\x20===','https://app.trapay.uk/payment/','email','/payment/white-label','network','üí∞\x20OxaPay\x20service\x20initialized','Network:','Invalid\x20response\x20from\x20OxaPay\x20API:\x20missing\x20track_id\x20or\x20address','data','Order\x20#','===\x20OXAPAY\x20API\x20INCOMPLETE\x20RESPONSE\x20===','Request\x20Body:','1UljmOb','text','PAID','track_id','Error\x20Message:','pay_amount','6YAvRiy','expired','status','URL:','oxapayService','Address:','amount','1338300PhiMLy','Parsed\x20Result:','oxapay','waiting','204kwAaBf','message','PROCESSING','expired_at','env','https://api.oxapay.com/v1/payment/white-label','OxaPayService','__esModule','under_paid_coverage','PENDING','4656zwcNTg','Unknown\x20error\x20from\x20OxaPay\x20API','359416kyZfjp','789586hHEujR','WCXQ21-DL5OZP-H3SSHH-4GVAR4','Status:','apiUrl','419658nbbkyb','OXAPAY_API_KEY','loggerService','log','Error:','../loggerService','logWhiteDomainRequest','statusText','stringify','===\x20OXAPAY\x20API\x20ERROR\x20===','currency','parse','warn','‚ö†Ô∏è\x20OXAPAY_API_KEY\x20not\x20found\x20in\x20environment\x20variables','752992vvGEcQ','Amount:','address','JSON\x20Parse\x20Error:\x20','apiKey','===\x20OXAPAY\x20SUCCESS\x20===','createPayment','logWhiteDomainResponse','EXPIRED','toLowerCase','POST','Response\x20Time:','defineProperty','320694UlWdMz','fee_paid_by_payer','qr_code','refunding','Raw\x20Response\x20Body:','logWhiteDomainError','application/json','pay_currency','5KkjIrG','Status\x20Text:','underpaid','Error\x20Details:','OxaPay\x20API\x20error:\x20','getPaymentStatusFromCallback','manual_accept','API\x20Error:\x20','Failed\x20to\x20parse\x20JSON\x20response:','Missing\x20track_id\x20or\x20address\x20in\x20response','Response\x20data:','REFUND','45ERpXDu'];a65_0x4c53=function(){return _0x28524d;};return a65_0x4c53();}(function(_0x4d70f8,_0x30cbba){const _0x48d77f=a65_0x2cbe,_0x3c6636=_0x4d70f8();while(!![]){try{const _0x13834a=parseInt(_0x48d77f(0x10a))/0x1*(parseInt(_0x48d77f(0x12c))/0x2)+parseInt(_0x48d77f(0x125))/0x3+parseInt(_0x48d77f(0x13a))/0x4*(parseInt(_0x48d77f(0x14f))/0x5)+-parseInt(_0x48d77f(0x110))/0x6*(parseInt(_0x48d77f(0x128))/0x7)+-parseInt(_0x48d77f(0x127))/0x8*(-parseInt(_0x48d77f(0xfb))/0x9)+parseInt(_0x48d77f(0x117))/0xa+-parseInt(_0x48d77f(0x147))/0xb*(parseInt(_0x48d77f(0x11b))/0xc);if(_0x13834a===_0x30cbba)break;else _0x3c6636['push'](_0x3c6636['shift']());}catch(_0x4e7b44){_0x3c6636['push'](_0x3c6636['shift']());}}}(a65_0x4c53,0x248ae));Object[a65_0x9c23d4(0x146)](exports,a65_0x9c23d4(0x122),{'value':!![]}),exports['oxapayService']=exports[a65_0x9c23d4(0x121)]=void 0x0;const loggerService_1=require(a65_0x9c23d4(0x131));function a65_0x2cbe(_0xb66ff3,_0x4028f2){_0xb66ff3=_0xb66ff3-0xf6;const _0x4c533a=a65_0x4c53();let _0x2cbef0=_0x4c533a[_0xb66ff3];return _0x2cbef0;}class OxaPayService{constructor(){const _0x1881b9=a65_0x9c23d4;this[_0x1881b9(0x12b)]=_0x1881b9(0x120),this[_0x1881b9(0x13e)]=process[_0x1881b9(0x11f)][_0x1881b9(0x12d)]||_0x1881b9(0x129),!this['apiKey']?console[_0x1881b9(0x138)](_0x1881b9(0x139)):console[_0x1881b9(0x12f)](_0x1881b9(0x103));}async[a65_0x9c23d4(0x140)](_0x5a0d2e){const _0x5b219f=a65_0x9c23d4,{orderId:_0x467b9c,amount:_0xef49c6,currency:_0x4d1058,payCurrency:_0x47b5ad,network:_0x1e2421,description:_0x5abaf3,customerEmail:_0x8eff39,lifetime:_0x14c1a8,feePaidByPayer:_0x506a5c,underPaidCoverage:_0x54fb43}=_0x5a0d2e;if(!this[_0x5b219f(0x13e)])throw new Error('OxaPay\x20API\x20key\x20is\x20not\x20configured');const _0x2ae143={'amount':_0xef49c6,'currency':_0x4d1058[_0x5b219f(0x143)](),'callback_url':'https://api.trapay.uk/api/oxapay/callback','order_id':_0x467b9c,'description':_0x5abaf3||_0x5b219f(0x107)+_0x467b9c};_0x47b5ad&&(_0x2ae143[_0x5b219f(0x14e)]=_0x47b5ad[_0x5b219f(0x143)]());_0x1e2421&&(_0x2ae143[_0x5b219f(0x102)]=_0x1e2421);_0x8eff39&&(_0x2ae143[_0x5b219f(0x100)]=_0x8eff39);_0x14c1a8!==undefined?_0x2ae143[_0x5b219f(0xfd)]=_0x14c1a8:_0x2ae143['lifetime']=0x3c;_0x506a5c!==undefined&&(_0x2ae143[_0x5b219f(0x148)]=_0x506a5c);_0x54fb43!==undefined&&(_0x2ae143[_0x5b219f(0x123)]=_0x54fb43);const _0xc07ab1=Date['now']();try{console[_0x5b219f(0x12f)]('===\x20OXAPAY\x20API\x20REQUEST\x20==='),console[_0x5b219f(0x12f)](_0x5b219f(0x113),this['apiUrl']),console[_0x5b219f(0x12f)](_0x5b219f(0x109),JSON[_0x5b219f(0x134)](_0x2ae143,null,0x2)),loggerService_1['loggerService'][_0x5b219f(0x132)](_0x5b219f(0x119),_0x5b219f(0x101),_0x5b219f(0x144),_0x2ae143);const _0x30c28c=await fetch(this['apiUrl'],{'method':_0x5b219f(0x144),'headers':{'Content-Type':_0x5b219f(0x14d),'merchant_api_key':this[_0x5b219f(0x13e)]},'body':JSON[_0x5b219f(0x134)](_0x2ae143)}),_0x54fdfe=Date['now']()-_0xc07ab1;console[_0x5b219f(0x12f)](_0x5b219f(0xfe)),console[_0x5b219f(0x12f)](_0x5b219f(0x12a),_0x30c28c[_0x5b219f(0x112)]),console[_0x5b219f(0x12f)](_0x5b219f(0x150),_0x30c28c[_0x5b219f(0x133)]),console[_0x5b219f(0x12f)](_0x5b219f(0x145),_0x54fdfe+'ms');const _0x44b7da=await _0x30c28c[_0x5b219f(0x10b)]();console[_0x5b219f(0x12f)](_0x5b219f(0x14b),_0x44b7da);let _0xba367c;try{_0xba367c=JSON[_0x5b219f(0x137)](_0x44b7da);}catch(_0x3f690e){console[_0x5b219f(0xfc)](_0x5b219f(0xf7),_0x3f690e),loggerService_1[_0x5b219f(0x12e)]['logWhiteDomainError'](_0x5b219f(0x119),_0x5b219f(0x101),_0x5b219f(0x13d)+_0x3f690e);throw new Error('Invalid\x20JSON\x20response\x20from\x20OxaPay\x20API:\x20'+_0x44b7da);}console[_0x5b219f(0x12f)]('===\x20PARSED\x20OXAPAY\x20RESPONSE\x20==='),console[_0x5b219f(0x12f)](_0x5b219f(0x118),JSON[_0x5b219f(0x134)](_0xba367c,null,0x2)),loggerService_1[_0x5b219f(0x12e)][_0x5b219f(0x141)](_0x5b219f(0x119),_0x5b219f(0x101),_0x30c28c['status'],_0xba367c,_0x54fdfe);if(_0xba367c[_0x5b219f(0x112)]!==0xc8||!_0xba367c[_0x5b219f(0x106)]){const _0x876909=_0xba367c[_0x5b219f(0xfc)]?.[_0x5b219f(0x11c)]||_0xba367c[_0x5b219f(0x11c)]||_0x5b219f(0x126);console[_0x5b219f(0xfc)](_0x5b219f(0x135)),console[_0x5b219f(0xfc)](_0x5b219f(0x10e),_0x876909),console['error'](_0x5b219f(0x152),_0xba367c[_0x5b219f(0xfc)]),loggerService_1[_0x5b219f(0x12e)]['logWhiteDomainError'](_0x5b219f(0x119),_0x5b219f(0x101),_0x5b219f(0xf6)+_0x876909);throw new Error(_0x5b219f(0x153)+_0x876909);}if(!_0xba367c[_0x5b219f(0x106)][_0x5b219f(0x10d)]||!_0xba367c[_0x5b219f(0x106)][_0x5b219f(0x13c)]){console['error'](_0x5b219f(0x108)),console[_0x5b219f(0xfc)](_0x5b219f(0xf8)),console['error'](_0x5b219f(0xf9),_0xba367c['data']),loggerService_1[_0x5b219f(0x12e)][_0x5b219f(0x14c)](_0x5b219f(0x119),'/payment/white-label','Incomplete\x20response:\x20missing\x20track_id\x20or\x20address');throw new Error(_0x5b219f(0x105));}console['log'](_0x5b219f(0x13f)),console[_0x5b219f(0x12f)]('Track\x20ID:',_0xba367c[_0x5b219f(0x106)]['track_id']),console[_0x5b219f(0x12f)](_0x5b219f(0x115),_0xba367c['data']['address']),console[_0x5b219f(0x12f)](_0x5b219f(0x13b),_0xba367c[_0x5b219f(0x106)][_0x5b219f(0x10f)],_0xba367c[_0x5b219f(0x106)][_0x5b219f(0x14e)]),console[_0x5b219f(0x12f)](_0x5b219f(0x104),_0xba367c[_0x5b219f(0x106)][_0x5b219f(0x102)]);const _0x2fe14e=_0x5b219f(0xff)+_0x5a0d2e['paymentId'];return{'gateway_payment_id':_0xba367c['data'][_0x5b219f(0x10d)],'payment_url':_0x2fe14e,'track_id':_0xba367c[_0x5b219f(0x106)][_0x5b219f(0x10d)],'amount':_0xba367c[_0x5b219f(0x106)][_0x5b219f(0x116)],'currency':_0xba367c[_0x5b219f(0x106)][_0x5b219f(0x136)],'pay_amount':_0xba367c[_0x5b219f(0x106)][_0x5b219f(0x10f)],'pay_currency':_0xba367c['data'][_0x5b219f(0x14e)],'network':_0xba367c['data'][_0x5b219f(0x102)],'address':_0xba367c[_0x5b219f(0x106)]['address'],'qr_code':_0xba367c[_0x5b219f(0x106)][_0x5b219f(0x149)],'rate':_0xba367c['data']['rate'],'expired_at':_0xba367c[_0x5b219f(0x106)][_0x5b219f(0x11e)]};}catch(_0x2e27ea){console['error']('===\x20OXAPAY\x20REQUEST\x20ERROR\x20==='),console['error'](_0x5b219f(0x130),_0x2e27ea),loggerService_1[_0x5b219f(0x12e)][_0x5b219f(0x14c)]('oxapay',_0x5b219f(0x101),_0x2e27ea instanceof Error?_0x2e27ea[_0x5b219f(0x11c)]:String(_0x2e27ea));throw _0x2e27ea;}}[a65_0x9c23d4(0x154)](_0x375af2){const _0x93a6c9=a65_0x9c23d4;switch(_0x375af2[_0x93a6c9(0x143)]()){case'new':return'PENDING';case _0x93a6c9(0x11a):return _0x93a6c9(0x124);case'paying':return _0x93a6c9(0x11d);case'paid':return _0x93a6c9(0x10c);case _0x93a6c9(0x155):return _0x93a6c9(0x10c);case _0x93a6c9(0x151):return'PAID';case _0x93a6c9(0x14a):return _0x93a6c9(0xfa);case'refunded':return'REFUND';case _0x93a6c9(0x111):return _0x93a6c9(0x142);default:return _0x93a6c9(0x124);}}}exports['OxaPayService']=OxaPayService,exports[a65_0x9c23d4(0x114)]=new OxaPayService();