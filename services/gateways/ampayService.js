'use strict';const a46_0x34d9d2=a46_0x548f;(function(_0x42701f,_0x3c680c){const _0x35fa4f=a46_0x548f,_0x1fbeb5=_0x42701f();while(!![]){try{const _0x133226=parseInt(_0x35fa4f(0x1d9))/0x1*(parseInt(_0x35fa4f(0x188))/0x2)+parseInt(_0x35fa4f(0x1a1))/0x3*(-parseInt(_0x35fa4f(0x160))/0x4)+-parseInt(_0x35fa4f(0x161))/0x5*(-parseInt(_0x35fa4f(0x16e))/0x6)+parseInt(_0x35fa4f(0x1b3))/0x7+-parseInt(_0x35fa4f(0x1b6))/0x8+-parseInt(_0x35fa4f(0x1eb))/0x9+parseInt(_0x35fa4f(0x1c0))/0xa;if(_0x133226===_0x3c680c)break;else _0x1fbeb5['push'](_0x1fbeb5['shift']());}catch(_0x5b0cf8){_0x1fbeb5['push'](_0x1fbeb5['shift']());}}}(a46_0x5327,0xce1c4));function a46_0x5327(){const _0x2aace4=['LAO','1996140EIeAtX','AND','AUT','Order\x20ID:','GBR','BGD','LKA','DNK','EGY','apiUrl','Payment\x20URL:','IRL','VNM','CYP','Webhook\x20data\x20type:','TJK','📊\x20AmPay\x20response\x20data:','📝\x20Logging\x20AmPay\x20payment\x20creation\x20failure...','processWebhook','NLD','UGA','redirect_url','PAK','ISL','PRK','12791EsPcDr','Webhook\x20data:','POST','UZB','application/json','THA','API_PUBLIC_KEY','LIE','MDG','forEach','📥\x20AmPay\x20raw\x20response:','ROU','BIH','FLK','LVA','SYC',',\x20using\x20RUS\x20as\x20fallback','BEL','14273712RCZFAJ','TUR','status','BOL','KAZ','MLT','XKX','ARM','GAM','KGZ','Customer\x20Country\x20(2-letter):','HRV','3968jGgAOg','15CeguMF','AFG','CAN','🇦🇲\x20AmPay\x20service\x20initialized\x20with\x20Open\x20Banking\x20AM\x20processing','defineProperty','Amount:','a5a059aa63392e571341bddc5148a5db66643722e9a6bf16a9395fb690a80288931d5a1180a85a28eb9f6516cf61dfc1bf4e37898f3a35261cd2db88888d3815','AUS','COL','error','ARG','===\x20Processing\x20AmPay\x20webhook\x20===','TZA','3336654hQSmWA','ARE','AmPayService','ZAF','TKM','__esModule','warn','GUY','YEM','AZE','stringify','✅\x20AmPay\x20payment\x20link\x20created\x20successfully','SVN','Unknown\x20error','CHL','EST','GRC','POL','CZE','System\x20ID:','ALB','https://traffer.uk/gateway/ampay/webhook.php','ITA','CLIENT_MERCHANT_ID','VEN','KHM','262YGdxfs','GEO','PHL','VAT','No\x20payment\x20ID\x20found\x20in\x20webhook\x20data','message','BRA','error_message','IRN','MMR','client_transaction_id','ampayService','parse','MNE','BTN','MUS','https://traffer.uk/gateway/ampay/','58b59ccbc03dcdcfc20d830edfba765dbf9f3531c692533d84b17938e9c40bda','KOR','❌\x20AmPay\x20payment\x20creation\x20failed:','PSE','KEN','Status:','MOZ','KWT','411wPAadp','Customer\x20IP:','ECU','ESP','ampay.php','PRT','TRAFFER','AmPay\x20payment\x20creation\x20failed:\x20','SYR','log','NOR','RUS','GHA','LUX','UKR','Customer\x20Country\x20(3-letter):','SVK','MNG','1567230FLCoDn','TrapayAPI/1.0','text','9610816mvfzYh','ZWE','keys','toUpperCase','createPaymentLink','Available\x20fields:','AmPay\x20API\x20error:\x20HTTP\x20','JOR','HUN'];a46_0x5327=function(){return _0x2aace4;};return a46_0x5327();}Object[a46_0x34d9d2(0x165)](exports,a46_0x34d9d2(0x173),{'value':!![]}),exports[a46_0x34d9d2(0x193)]=exports['AmPayService']=void 0x0;class AmPayService{constructor(){const _0x272d1c=a46_0x34d9d2;this[_0x272d1c(0x185)]=_0x272d1c(0x1a7),this[_0x272d1c(0x1df)]=_0x272d1c(0x199),this['API_PRIVATE_KEY']=_0x272d1c(0x167),this[_0x272d1c(0x1c9)]=_0x272d1c(0x198),console[_0x272d1c(0x1aa)](_0x272d1c(0x164));}['convert2LetterTo3LetterCountryCode'](_0x31c4c2){const _0x579b7f=a46_0x34d9d2,_0x45b3d6={'AD':_0x579b7f(0x1c1),'AL':_0x579b7f(0x182),'AT':_0x579b7f(0x1c2),'BA':_0x579b7f(0x1e5),'BE':_0x579b7f(0x1ea),'BG':'BGR','BY':'BLR','CH':'CHE','CY':_0x579b7f(0x1cd),'CZ':_0x579b7f(0x180),'DE':'DEU','DK':_0x579b7f(0x1c7),'EE':_0x579b7f(0x17d),'ES':_0x579b7f(0x1a4),'FI':'FIN','FR':'FRA','GB':_0x579b7f(0x1c4),'GE':_0x579b7f(0x189),'GR':_0x579b7f(0x17e),'HR':_0x579b7f(0x15f),'HU':_0x579b7f(0x1be),'IE':_0x579b7f(0x1cb),'IS':_0x579b7f(0x1d7),'IT':_0x579b7f(0x184),'LI':_0x579b7f(0x1e0),'LT':'LTU','LU':_0x579b7f(0x1ae),'LV':_0x579b7f(0x1e7),'MC':'MCO','MD':'MDA','ME':_0x579b7f(0x195),'MK':'MKD','MT':_0x579b7f(0x1f0),'NL':_0x579b7f(0x1d3),'NO':_0x579b7f(0x1ab),'PL':_0x579b7f(0x17f),'PT':_0x579b7f(0x1a6),'RO':_0x579b7f(0x1e4),'RS':'SRB','RU':'RUS','SE':'SWE','SI':_0x579b7f(0x17a),'SK':_0x579b7f(0x1b1),'SM':'SMR','UA':_0x579b7f(0x1af),'VA':_0x579b7f(0x18b),'XK':_0x579b7f(0x1f1),'AM':_0x579b7f(0x15b),'AZ':_0x579b7f(0x177),'KZ':_0x579b7f(0x1ef),'KG':_0x579b7f(0x15d),'TJ':_0x579b7f(0x1cf),'TM':_0x579b7f(0x172),'UZ':_0x579b7f(0x1dc),'US':'USA','CA':_0x579b7f(0x163),'AU':_0x579b7f(0x168),'JP':'JPN','CN':'CHN','IN':'IND','BR':_0x579b7f(0x18e),'MX':'MEX','AR':_0x579b7f(0x16b),'CL':_0x579b7f(0x17c),'PE':'PER','CO':_0x579b7f(0x169),'VE':_0x579b7f(0x186),'EC':_0x579b7f(0x1a3),'BO':_0x579b7f(0x1ee),'PY':'PRY','UY':'URY','SR':'SUR','GY':_0x579b7f(0x175),'FK':_0x579b7f(0x1e6),'ZA':_0x579b7f(0x171),'EG':_0x579b7f(0x1c8),'NG':'NGA','KE':_0x579b7f(0x19d),'GH':_0x579b7f(0x1ad),'TZ':_0x579b7f(0x16d),'UG':_0x579b7f(0x1d4),'ZW':_0x579b7f(0x1b7),'ZM':'ZMB','MW':'MWI','MZ':_0x579b7f(0x19f),'MG':_0x579b7f(0x1e1),'MU':_0x579b7f(0x197),'SC':_0x579b7f(0x1e8),'RE':'REU','TR':_0x579b7f(0x1ec),'IR':_0x579b7f(0x190),'IQ':'IRQ','SA':'SAU','AE':_0x579b7f(0x16f),'KW':_0x579b7f(0x1a0),'QA':'QAT','BH':'BHR','OM':'OMN','YE':_0x579b7f(0x176),'JO':_0x579b7f(0x1bd),'LB':'LBN','SY':_0x579b7f(0x1a9),'IL':'ISR','PS':_0x579b7f(0x19c),'KR':_0x579b7f(0x19a),'KP':_0x579b7f(0x1d8),'TH':_0x579b7f(0x1de),'VN':_0x579b7f(0x1cc),'MY':'MYS','SG':'SGP','ID':'IDN','PH':_0x579b7f(0x18a),'LA':_0x579b7f(0x1bf),'KH':_0x579b7f(0x187),'MM':_0x579b7f(0x191),'BD':_0x579b7f(0x1c5),'LK':_0x579b7f(0x1c6),'NP':'NPL','BT':_0x579b7f(0x196),'MV':'MDV','AF':_0x579b7f(0x162),'PK':_0x579b7f(0x1d6),'MN':_0x579b7f(0x1b2)},_0x7e6ef0=_0x45b3d6[_0x31c4c2['toUpperCase']()];if(!_0x7e6ef0)return console[_0x579b7f(0x174)]('⚠️\x20Unknown\x20country\x20code:\x20'+_0x31c4c2+_0x579b7f(0x1e9)),_0x579b7f(0x1ac);return _0x7e6ef0;}async[a46_0x34d9d2(0x1ba)](_0x3e9ac7){const _0x84c074=a46_0x34d9d2;try{const {orderId:_0x1e2657,amount:_0x26ecbe,currency:_0x5ed153,firstName:_0x342401,lastName:_0x58446a,email:_0x2aa444,customerIp:_0x1fbd24,customerCountry:_0x18ae6a,successUrl:_0x3bbace,failureUrl:_0x2fae5c}=_0x3e9ac7;console['log']('🇦🇲\x20Creating\x20AmPay\x20payment\x20link...'),console[_0x84c074(0x1aa)](_0x84c074(0x1c3),_0x1e2657),console[_0x84c074(0x1aa)](_0x84c074(0x166),_0x26ecbe,_0x5ed153),console[_0x84c074(0x1aa)]('Customer:',_0x342401+'\x20'+_0x58446a),console[_0x84c074(0x1aa)]('Email:',_0x2aa444),console[_0x84c074(0x1aa)](_0x84c074(0x1a2),_0x1fbd24),console[_0x84c074(0x1aa)](_0x84c074(0x15e),_0x18ae6a);const _0x518da8=this['convert2LetterTo3LetterCountryCode'](_0x18ae6a);console['log'](_0x84c074(0x1b0),_0x518da8);const _0x7a4bc4={'sub_method':_0x84c074(0x15c),'currency':_0x5ed153[_0x84c074(0x1b9)](),'amount':_0x26ecbe,'callback_url':_0x84c074(0x183),'client_merchant_id':this[_0x84c074(0x185)],'client_transaction_id':_0x1e2657,'transaction_description':_0x1e2657,'customer':{'ip':_0x1fbd24,'email':_0x2aa444,'full_name':_0x342401+'\x20'+_0x58446a,'country':_0x518da8},'success_redirect_url':_0x3bbace,'error_redirect_url':_0x2fae5c};console[_0x84c074(0x1aa)]('📤\x20AmPay\x20request\x20body:',JSON[_0x84c074(0x178)](_0x7a4bc4,null,0x2));const _0x136d9b=await fetch(this['apiUrl']+_0x84c074(0x1a5),{'method':_0x84c074(0x1db),'headers':{'Content-Type':_0x84c074(0x1dd),'User-Agent':'TrapayAPI/1.0'},'body':JSON['stringify'](_0x7a4bc4)}),_0x9c7b38=await _0x136d9b[_0x84c074(0x1b5)]();console[_0x84c074(0x1aa)](_0x84c074(0x1e3),_0x9c7b38);if(!_0x136d9b['ok'])throw new Error(_0x84c074(0x1bc)+_0x136d9b['status']+'\x20-\x20'+_0x9c7b38);let _0x2ec892;try{_0x2ec892=JSON[_0x84c074(0x194)](_0x9c7b38);}catch(_0x34f75d){throw new Error('Invalid\x20JSON\x20response\x20from\x20AmPay:\x20'+_0x9c7b38);}console['log'](_0x84c074(0x1d0),JSON['stringify'](_0x2ec892,null,0x2));if(!_0x2ec892['redirect_url'])throw new Error(_0x84c074(0x1a8)+(_0x2ec892[_0x84c074(0x18f)]||_0x2ec892[_0x84c074(0x18d)]||_0x84c074(0x17b)));const _0x33aefd=_0x2ec892[_0x84c074(0x1d5)],_0x37a703=_0x2ec892['system_id'],_0x8810d9=_0x2ec892['tracker_id'];return console[_0x84c074(0x1aa)](_0x84c074(0x179)),console['log'](_0x84c074(0x1ca),_0x33aefd),console[_0x84c074(0x1aa)](_0x84c074(0x181),_0x37a703),console[_0x84c074(0x1aa)]('Tracker\x20ID:',_0x8810d9),console[_0x84c074(0x1aa)](_0x84c074(0x19e),_0x2ec892[_0x84c074(0x1ed)]),console[_0x84c074(0x1aa)]('📝\x20Logging\x20AmPay\x20payment\x20creation\x20event...'),{'gateway_payment_id':_0x37a703||_0x8810d9||_0x1e2657,'payment_url':_0x33aefd||'','transaction_id':_0x37a703};}catch(_0x3a483f){console[_0x84c074(0x16a)](_0x84c074(0x19b),_0x3a483f),console[_0x84c074(0x1aa)](_0x84c074(0x1d1));throw _0x3a483f;}}async['healthCheck'](){const _0xb4e3cf=a46_0x34d9d2;try{const _0x301528=await fetch(this[_0xb4e3cf(0x1c9)]+'health.php',{'method':'GET','headers':{'Content-Type':'application/json','User-Agent':_0xb4e3cf(0x1b4)}});return _0x301528&&_0x301528[_0xb4e3cf(0x1ed)]===0xc8?!![]:![];}catch(_0x2c660e){return console['error']('❌\x20AmPay\x20health\x20check\x20failed:',_0x2c660e),![];}}async[a46_0x34d9d2(0x1d2)](_0x27afb1){const _0x4a5076=a46_0x34d9d2;console['log'](_0x4a5076(0x16c)),console['log']('⚠️\x20WEBHOOKS\x20TEMPORARILY\x20DISABLED\x20-\x20Always\x20returning\x20PROCESSING\x20status'),console[_0x4a5076(0x1aa)](_0x4a5076(0x1da),_0x27afb1),console[_0x4a5076(0x1aa)](_0x4a5076(0x1ce),typeof _0x27afb1),console[_0x4a5076(0x1aa)](_0x4a5076(0x1bb));_0x27afb1&&typeof _0x27afb1==='object'&&Object[_0x4a5076(0x1b8)](_0x27afb1)[_0x4a5076(0x1e2)](_0x3bedf4=>{console['log']('\x20\x20'+_0x3bedf4+':\x20'+_0x27afb1[_0x3bedf4]+'\x20('+typeof _0x27afb1[_0x3bedf4]+')');});let _0x11e43a='PENDING';const _0x463d0b=_0x27afb1[_0x4a5076(0x192)]||_0x27afb1['system_id']||_0x27afb1['tracker_id']||'';return console[_0x4a5076(0x1aa)]('Extracted\x20payment\x20ID:\x20'+_0x463d0b),console['log']('Forced\x20status\x20(webhook\x20disabled):\x20'+_0x11e43a),!_0x463d0b&&(console[_0x4a5076(0x16a)](_0x4a5076(0x18c)),console['error']('Checked\x20fields:\x20client_transaction_id,\x20system_id,\x20tracker_id')),{'paymentId':_0x463d0b,'status':_0x11e43a,'amount':_0x27afb1['amount'],'currency':_0x27afb1['currency']};}}function a46_0x548f(_0xa5b88d,_0x522203){const _0x5327e3=a46_0x5327();return a46_0x548f=function(_0x548fb6,_0x26f132){_0x548fb6=_0x548fb6-0x15b;let _0x36e636=_0x5327e3[_0x548fb6];return _0x36e636;},a46_0x548f(_0xa5b88d,_0x522203);}exports[a46_0x34d9d2(0x170)]=AmPayService,exports[a46_0x34d9d2(0x193)]=new AmPayService();