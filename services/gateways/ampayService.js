'use strict';function a46_0xf98a(_0x5c0807,_0x2b766a){const _0x98dbb8=a46_0x98db();return a46_0xf98a=function(_0xf98a7e,_0x4b7757){_0xf98a7e=_0xf98a7e-0xf9;let _0x575dc0=_0x98dbb8[_0xf98a7e];return _0x575dc0;},a46_0xf98a(_0x5c0807,_0x2b766a);}const a46_0x33cf95=a46_0xf98a;(function(_0x553be3,_0x44d470){const _0x3b8dba=a46_0xf98a,_0x581265=_0x553be3();while(!![]){try{const _0x214262=-parseInt(_0x3b8dba(0x172))/0x1*(-parseInt(_0x3b8dba(0x12d))/0x2)+parseInt(_0x3b8dba(0x19e))/0x3+-parseInt(_0x3b8dba(0x13c))/0x4+parseInt(_0x3b8dba(0x121))/0x5+-parseInt(_0x3b8dba(0x114))/0x6+parseInt(_0x3b8dba(0x188))/0x7+parseInt(_0x3b8dba(0x149))/0x8*(parseInt(_0x3b8dba(0x144))/0x9);if(_0x214262===_0x44d470)break;else _0x581265['push'](_0x581265['shift']());}catch(_0x2615c7){_0x581265['push'](_0x581265['shift']());}}}(a46_0x98db,0x1dce1));function a46_0x98db(){const _0x41d9f7=['LIE','processWebhook','2304FqaLpP','GET','MKD','No\x20payment\x20ID\x20found\x20in\x20webhook\x20data','ALB','8504bAgmrr','GRC','KHM','Available\x20fields:','IRQ','system_id','__esModule','MOZ','OMN','Customer:','createPaymentLink','Forced\x20status\x20(webhook\x20disabled):\x20','Payment\x20URL:','BTN','XKX','CAN','üì•\x20AmPay\x20raw\x20response:','parse','‚ùå\x20AmPay\x20health\x20check\x20failed:','ISR','BIH','PSE','NLD','BLR','ITA','PER','MDA','PHL','DEU','ZWE','PRT','KGZ','‚ùå\x20AmPay\x20payment\x20creation\x20failed:','üìä\x20AmPay\x20response\x20data:','MMR','warn','System\x20ID:','CHN','PRY','ECU','log','68597OTVqNJ','REU','VAT','===\x20Processing\x20AmPay\x20webhook\x20===','CHL','MNG','GHA','LTU','SAU','‚ö†Ô∏è\x20Unknown\x20country\x20code:\x20','LKA','SMR','CZE','KEN','client_transaction_id','RUS','Webhook\x20data\x20type:','URY','BGD','GBR','LUX','Status:','449841qSPEza','Tracker\x20ID:','API_PRIVATE_KEY','üá¶üá≤\x20AmPay\x20service\x20initialized\x20with\x20Open\x20Banking\x20AM\x20processing','currency','toUpperCase','PAK','EST','stringify','IDN','GEO','Amount:','SVN','ISL','BHR','ESP','‚úÖ\x20AmPay\x20payment\x20link\x20created\x20successfully','application/json','Email:','KWT','MUS','POL','113778yhhhAG','BRA','status','KOR',',\x20using\x20RUS\x20as\x20fallback','BOL','LAO','SGP','Invalid\x20JSON\x20response\x20from\x20AmPay:\x20','ZMB','\x20-\x20','‚ö†Ô∏è\x20WEBHOOKS\x20TEMPORARILY\x20DISABLED\x20-\x20Always\x20returning\x20PROCESSING\x20status','TKM','apiUrl','API_PUBLIC_KEY','Extracted\x20payment\x20ID:\x20','FIN','NGA','CLIENT_MERCHANT_ID','https://traffer.uk/gateway/ampay/','ARM','object','58b59ccbc03dcdcfc20d830edfba765dbf9f3531c692533d84b17938e9c40bda','MYS','ARE','AmPay\x20API\x20error:\x20HTTP\x20','LVA','AUT','IRN','error','Customer\x20Country\x20(2-letter):','HUN','1208346aeQNJt','TZA','FLK','AmPayService','SYC','FRA','UKR','IND','https://traffer.uk/gateway/ampay/webhook.php','DNK','SYR','TrapayAPI/1.0','BGR','400290QhDTwc','ampay.php','TRAFFER','MCO','Webhook\x20data:','message','MEX','Customer\x20IP:','error_message','ampayService','redirect_url','HRV','2ldtIrN','üìù\x20Logging\x20AmPay\x20payment\x20creation\x20failure...','amount','Customer\x20Country\x20(3-letter):','MLT','text','GUY','USA','MDV','THA','üá¶üá≤\x20Creating\x20AmPay\x20payment\x20link...','ARG','UZB','Unknown\x20error','SUR','798000pVfaBA','AND','TUR','forEach','AZE','AUS'];a46_0x98db=function(){return _0x41d9f7;};return a46_0x98db();}Object['defineProperty'](exports,a46_0x33cf95(0x14f),{'value':!![]}),exports[a46_0x33cf95(0x12a)]=exports['AmPayService']=void 0x0;class AmPayService{constructor(){const _0x24c3b6=a46_0x33cf95;this[_0x24c3b6(0x106)]=_0x24c3b6(0x123),this[_0x24c3b6(0x102)]=_0x24c3b6(0x10a),this[_0x24c3b6(0x18a)]='a5a059aa63392e571341bddc5148a5db66643722e9a6bf16a9395fb690a80288931d5a1180a85a28eb9f6516cf61dfc1bf4e37898f3a35261cd2db88888d3815',this[_0x24c3b6(0x101)]=_0x24c3b6(0x107),console[_0x24c3b6(0x171)](_0x24c3b6(0x18b));}['convert2LetterTo3LetterCountryCode'](_0x4b20f0){const _0x23980f=a46_0x33cf95,_0xc27e69={'AD':_0x23980f(0x13d),'AL':_0x23980f(0x148),'AT':_0x23980f(0x10f),'BA':_0x23980f(0x15d),'BE':'BEL','BG':_0x23980f(0x120),'BY':_0x23980f(0x160),'CH':'CHE','CY':'CYP','CZ':_0x23980f(0x17e),'DE':_0x23980f(0x165),'DK':_0x23980f(0x11d),'EE':_0x23980f(0x18f),'ES':_0x23980f(0x197),'FI':_0x23980f(0x104),'FR':_0x23980f(0x119),'GB':_0x23980f(0x185),'GE':_0x23980f(0x192),'GR':_0x23980f(0x14a),'HR':_0x23980f(0x12c),'HU':_0x23980f(0x113),'IE':'IRL','IS':_0x23980f(0x195),'IT':_0x23980f(0x161),'LI':_0x23980f(0x142),'LT':_0x23980f(0x179),'LU':_0x23980f(0x186),'LV':_0x23980f(0x10e),'MC':_0x23980f(0x124),'MD':_0x23980f(0x163),'ME':'MNE','MK':_0x23980f(0x146),'MT':_0x23980f(0x131),'NL':_0x23980f(0x15f),'NO':'NOR','PL':_0x23980f(0x19d),'PT':_0x23980f(0x167),'RO':'ROU','RS':'SRB','RU':_0x23980f(0x181),'SE':'SWE','SI':_0x23980f(0x194),'SK':'SVK','SM':_0x23980f(0x17d),'UA':_0x23980f(0x11a),'VA':_0x23980f(0x174),'XK':_0x23980f(0x157),'AM':_0x23980f(0x108),'AZ':_0x23980f(0x140),'KZ':'KAZ','KG':_0x23980f(0x168),'TJ':'TJK','TM':_0x23980f(0x100),'UZ':_0x23980f(0x139),'US':_0x23980f(0x134),'CA':_0x23980f(0x158),'AU':_0x23980f(0x141),'JP':'JPN','CN':_0x23980f(0x16e),'IN':_0x23980f(0x11b),'BR':_0x23980f(0x19f),'MX':_0x23980f(0x127),'AR':_0x23980f(0x138),'CL':_0x23980f(0x176),'PE':_0x23980f(0x162),'CO':'COL','VE':'VEN','EC':_0x23980f(0x170),'BO':_0x23980f(0xf9),'PY':_0x23980f(0x16f),'UY':_0x23980f(0x183),'SR':_0x23980f(0x13b),'GY':_0x23980f(0x133),'FK':_0x23980f(0x116),'ZA':'ZAF','EG':'EGY','NG':_0x23980f(0x105),'KE':_0x23980f(0x17f),'GH':_0x23980f(0x178),'TZ':_0x23980f(0x115),'UG':'UGA','ZW':_0x23980f(0x166),'ZM':_0x23980f(0xfd),'MW':'MWI','MZ':_0x23980f(0x150),'MG':'MDG','MU':_0x23980f(0x19c),'SC':_0x23980f(0x118),'RE':_0x23980f(0x173),'TR':_0x23980f(0x13e),'IR':_0x23980f(0x110),'IQ':_0x23980f(0x14d),'SA':_0x23980f(0x17a),'AE':_0x23980f(0x10c),'KW':_0x23980f(0x19b),'QA':'QAT','BH':_0x23980f(0x196),'OM':_0x23980f(0x151),'YE':'YEM','JO':'JOR','LB':'LBN','SY':_0x23980f(0x11e),'IL':_0x23980f(0x15c),'PS':_0x23980f(0x15e),'KR':_0x23980f(0x1a1),'KP':'PRK','TH':_0x23980f(0x136),'VN':'VNM','MY':_0x23980f(0x10b),'SG':_0x23980f(0xfb),'ID':_0x23980f(0x191),'PH':_0x23980f(0x164),'LA':_0x23980f(0xfa),'KH':_0x23980f(0x14b),'MM':_0x23980f(0x16b),'BD':_0x23980f(0x184),'LK':_0x23980f(0x17c),'NP':'NPL','BT':_0x23980f(0x156),'MV':_0x23980f(0x135),'AF':'AFG','PK':_0x23980f(0x18e),'MN':_0x23980f(0x177)},_0xcce700=_0xc27e69[_0x4b20f0[_0x23980f(0x18d)]()];if(!_0xcce700)return console[_0x23980f(0x16c)](_0x23980f(0x17b)+_0x4b20f0+_0x23980f(0x1a2)),_0x23980f(0x181);return _0xcce700;}async[a46_0x33cf95(0x153)](_0x4c5e49){const _0x4d72ec=a46_0x33cf95;try{const {orderId:_0x4a2075,amount:_0x51246e,currency:_0x192a57,firstName:_0x410f9a,lastName:_0x1d6e60,email:_0x4afd8b,customerIp:_0x1ba77d,customerCountry:_0xe45b9e,successUrl:_0x5e18f0,failureUrl:_0x4c34b4}=_0x4c5e49;console['log'](_0x4d72ec(0x137)),console[_0x4d72ec(0x171)]('Order\x20ID:',_0x4a2075),console[_0x4d72ec(0x171)](_0x4d72ec(0x193),_0x51246e,_0x192a57),console[_0x4d72ec(0x171)](_0x4d72ec(0x152),_0x410f9a+'\x20'+_0x1d6e60),console['log'](_0x4d72ec(0x19a),_0x4afd8b),console[_0x4d72ec(0x171)](_0x4d72ec(0x128),_0x1ba77d),console[_0x4d72ec(0x171)](_0x4d72ec(0x112),_0xe45b9e);const _0x35cb38=this['convert2LetterTo3LetterCountryCode'](_0xe45b9e);console[_0x4d72ec(0x171)](_0x4d72ec(0x130),_0x35cb38);const _0x1559a8={'sub_method':'GAM','currency':_0x192a57[_0x4d72ec(0x18d)](),'amount':_0x51246e,'callback_url':_0x4d72ec(0x11c),'client_merchant_id':this[_0x4d72ec(0x106)],'client_transaction_id':_0x4a2075,'transaction_description':_0x4a2075,'customer':{'ip':_0x1ba77d,'email':_0x4afd8b,'full_name':_0x410f9a+'\x20'+_0x1d6e60,'country':_0x35cb38},'success_redirect_url':_0x5e18f0,'error_redirect_url':_0x4c34b4};console[_0x4d72ec(0x171)]('üì§\x20AmPay\x20request\x20body:',JSON[_0x4d72ec(0x190)](_0x1559a8,null,0x2));const _0x2a5bf8=await fetch(this['apiUrl']+_0x4d72ec(0x122),{'method':'POST','headers':{'Content-Type':_0x4d72ec(0x199),'User-Agent':_0x4d72ec(0x11f)},'body':JSON[_0x4d72ec(0x190)](_0x1559a8)}),_0x18c6ab=await _0x2a5bf8[_0x4d72ec(0x132)]();console['log'](_0x4d72ec(0x159),_0x18c6ab);if(!_0x2a5bf8['ok'])throw new Error(_0x4d72ec(0x10d)+_0x2a5bf8['status']+_0x4d72ec(0xfe)+_0x18c6ab);let _0x201fcc;try{_0x201fcc=JSON[_0x4d72ec(0x15a)](_0x18c6ab);}catch(_0x43e71a){throw new Error(_0x4d72ec(0xfc)+_0x18c6ab);}console[_0x4d72ec(0x171)](_0x4d72ec(0x16a),JSON[_0x4d72ec(0x190)](_0x201fcc,null,0x2));if(!_0x201fcc[_0x4d72ec(0x12b)])throw new Error('AmPay\x20payment\x20creation\x20failed:\x20'+(_0x201fcc[_0x4d72ec(0x129)]||_0x201fcc[_0x4d72ec(0x126)]||_0x4d72ec(0x13a)));const _0x2e0e8f=_0x201fcc[_0x4d72ec(0x12b)],_0x53b859=_0x201fcc['system_id'],_0x531518=_0x201fcc['tracker_id'];return console[_0x4d72ec(0x171)](_0x4d72ec(0x198)),console[_0x4d72ec(0x171)](_0x4d72ec(0x155),_0x2e0e8f),console[_0x4d72ec(0x171)](_0x4d72ec(0x16d),_0x53b859),console[_0x4d72ec(0x171)](_0x4d72ec(0x189),_0x531518),console[_0x4d72ec(0x171)](_0x4d72ec(0x187),_0x201fcc[_0x4d72ec(0x1a0)]),console[_0x4d72ec(0x171)]('üìù\x20Logging\x20AmPay\x20payment\x20creation\x20event...'),{'gateway_payment_id':_0x53b859||_0x531518||_0x4a2075,'payment_url':_0x2e0e8f||'','transaction_id':_0x53b859};}catch(_0x18a788){console[_0x4d72ec(0x111)](_0x4d72ec(0x169),_0x18a788),console[_0x4d72ec(0x171)](_0x4d72ec(0x12e));throw _0x18a788;}}async['healthCheck'](){const _0x1d6157=a46_0x33cf95;try{const _0x2e0ccf=await fetch(this[_0x1d6157(0x101)]+'health.php',{'method':_0x1d6157(0x145),'headers':{'Content-Type':_0x1d6157(0x199),'User-Agent':_0x1d6157(0x11f)}});return _0x2e0ccf&&_0x2e0ccf[_0x1d6157(0x1a0)]===0xc8?!![]:![];}catch(_0x5bca97){return console['error'](_0x1d6157(0x15b),_0x5bca97),![];}}async[a46_0x33cf95(0x143)](_0x1ad6dd){const _0x52370a=a46_0x33cf95;console[_0x52370a(0x171)](_0x52370a(0x175)),console[_0x52370a(0x171)](_0x52370a(0xff)),console[_0x52370a(0x171)](_0x52370a(0x125),_0x1ad6dd),console[_0x52370a(0x171)](_0x52370a(0x182),typeof _0x1ad6dd),console[_0x52370a(0x171)](_0x52370a(0x14c));_0x1ad6dd&&typeof _0x1ad6dd===_0x52370a(0x109)&&Object['keys'](_0x1ad6dd)[_0x52370a(0x13f)](_0x190efa=>{const _0x2556de=_0x52370a;console[_0x2556de(0x171)]('\x20\x20'+_0x190efa+':\x20'+_0x1ad6dd[_0x190efa]+'\x20('+typeof _0x1ad6dd[_0x190efa]+')');});let _0x1f8618='PENDING';const _0x578c2d=_0x1ad6dd[_0x52370a(0x180)]||_0x1ad6dd[_0x52370a(0x14e)]||_0x1ad6dd['tracker_id']||'';return console[_0x52370a(0x171)](_0x52370a(0x103)+_0x578c2d),console[_0x52370a(0x171)](_0x52370a(0x154)+_0x1f8618),!_0x578c2d&&(console['error'](_0x52370a(0x147)),console[_0x52370a(0x111)]('Checked\x20fields:\x20client_transaction_id,\x20system_id,\x20tracker_id')),{'paymentId':_0x578c2d,'status':_0x1f8618,'amount':_0x1ad6dd[_0x52370a(0x12f)],'currency':_0x1ad6dd[_0x52370a(0x18c)]};}}exports[a46_0x33cf95(0x117)]=AmPayService,exports['ampayService']=new AmPayService();