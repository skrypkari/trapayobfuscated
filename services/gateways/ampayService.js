'use strict';function a56_0x5042(){const _0x141730=['CZE','BLR','ALB','healthCheck','PRY','Customer:','SWE','error','Customer\x20Country\x20(3-letter):','âœ…\x20AmPay\x20payment\x20link\x20created\x20successfully','XKX','IND','417318FLAYDY','error_message','BIH','forEach','AmPayService','https://traffer.uk/gateway/ampay/','MEX','MDA','stringify','ðŸ“\x20Logging\x20AmPay\x20payment\x20creation\x20event...','GAM','redirect_url','NPL','NGA','TrapayAPI/1.0','KAZ','LIE','LKA','MDV','No\x20payment\x20ID\x20found\x20in\x20webhook\x20data','ARG','API_PUBLIC_KEY','LTU','58b59ccbc03dcdcfc20d830edfba765dbf9f3531c692533d84b17938e9c40bda','GUY','BRA','system_id','System\x20ID:','370209UPbxkC','ampayService','MUS','amount','PAK','SRB','API_PRIVATE_KEY','CLIENT_MERCHANT_ID','672915fKdwJW','LAO','QAT','JPN','UZB','ROU','PRT','TRAFFER','keys','ðŸ‡¦ðŸ‡²\x20Creating\x20AmPay\x20payment\x20link...','CYP','UKR','MDG','RUS','998532eKNZdI','ðŸ‡¦ðŸ‡²\x20AmPay\x20service\x20initialized\x20with\x20Open\x20Banking\x20AM\x20processing','AUS','Webhook\x20data:','===\x20Processing\x20AmPay\x20webhook\x20===','47986dkAotA','KGZ','172fSPxnZ','CAN','PENDING','a5a059aa63392e571341bddc5148a5db66643722e9a6bf16a9395fb690a80288931d5a1180a85a28eb9f6516cf61dfc1bf4e37898f3a35261cd2db88888d3815','ARM','VEN','LUX','Amount:','GBR','POL','KEN','REU','HUN','NLD','GHA','toUpperCase','BHR','POST','ðŸ“¥\x20AmPay\x20raw\x20response:','LVA','Customer\x20Country\x20(2-letter):','PSE','MNG','EGY','warn','ARE','CHN','ðŸ“\x20Logging\x20AmPay\x20payment\x20creation\x20failure...','âŒ\x20AmPay\x20payment\x20creation\x20failed:','CHE','16KjDoxP','SYC','client_transaction_id','USA',',\x20using\x20RUS\x20as\x20fallback','2yVAmGc','2792200uxdeqX','application/json','MYS','ZAF','IRL','SVN','__esModule','log','THA','convert2LetterTo3LetterCountryCode','AmPay\x20payment\x20creation\x20failed:\x20','Status:','DNK','AUT','IRQ','ðŸ“¤\x20AmPay\x20request\x20body:','BEL','FLK','TJK','16175HfpuBW','apiUrl','Invalid\x20JSON\x20response\x20from\x20AmPay:\x20','URY','text','PHL','tracker_id','ðŸ“Š\x20AmPay\x20response\x20data:','âš ï¸\x20WEBHOOKS\x20TEMPORARILY\x20DISABLED\x20-\x20Always\x20returning\x20PROCESSING\x20status','TKM','SVK','MKD','ECU','status','GET','AZE','TZA','VNM','EST','https://traffer.uk/gateway/ampay/webhook.php','PER','TUR','FIN','IRN','Unknown\x20error','YEM','SAU','ZWE','âŒ\x20AmPay\x20health\x20check\x20failed:','BOL','MCO','SUR','BTN','\x20-\x20','GRC','AmPay\x20API\x20error:\x20HTTP\x20'];a56_0x5042=function(){return _0x141730;};return a56_0x5042();}function a56_0x4195(_0x100064,_0x313b50){_0x100064=_0x100064-0x14a;const _0x504223=a56_0x5042();let _0x419566=_0x504223[_0x100064];return _0x419566;}const a56_0x2e7731=a56_0x4195;(function(_0x4ad59e,_0x5ebd25){const _0x541037=a56_0x4195,_0x1b1a55=_0x4ad59e();while(!![]){try{const _0xf855bc=-parseInt(_0x541037(0x1dc))/0x1*(-parseInt(_0x541037(0x1b7))/0x2)+parseInt(_0x541037(0x1a4))/0x3+parseInt(_0x541037(0x1b9))/0x4*(-parseInt(_0x541037(0x150))/0x5)+-parseInt(_0x541037(0x180))/0x6+parseInt(_0x541037(0x19c))/0x7*(-parseInt(_0x541037(0x1d7))/0x8)+-parseInt(_0x541037(0x1b2))/0x9+parseInt(_0x541037(0x1dd))/0xa;if(_0xf855bc===_0x5ebd25)break;else _0x1b1a55['push'](_0x1b1a55['shift']());}catch(_0x1757a0){_0x1b1a55['push'](_0x1b1a55['shift']());}}}(a56_0x5042,0x1ecb3));Object['defineProperty'](exports,a56_0x2e7731(0x1e3),{'value':!![]}),exports[a56_0x2e7731(0x19d)]=exports[a56_0x2e7731(0x184)]=void 0x0;class AmPayService{constructor(){const _0xa187e4=a56_0x2e7731;this[_0xa187e4(0x1a3)]=_0xa187e4(0x1ab),this[_0xa187e4(0x195)]=_0xa187e4(0x197),this[_0xa187e4(0x1a2)]=_0xa187e4(0x1bc),this['apiUrl']=_0xa187e4(0x185),console[_0xa187e4(0x1e4)](_0xa187e4(0x1b3));}[a56_0x2e7731(0x1e6)](_0x5e2474){const _0x38c069=a56_0x2e7731,_0x302372={'AD':'AND','AL':_0x38c069(0x176),'AT':_0x38c069(0x14a),'BA':_0x38c069(0x182),'BE':_0x38c069(0x14d),'BG':'BGR','BY':_0x38c069(0x175),'CH':_0x38c069(0x1d6),'CY':_0x38c069(0x1ae),'CZ':_0x38c069(0x174),'DE':'DEU','DK':_0x38c069(0x1e9),'EE':_0x38c069(0x162),'ES':'ESP','FI':_0x38c069(0x166),'FR':'FRA','GB':_0x38c069(0x1c1),'GE':'GEO','GR':_0x38c069(0x172),'HR':'HRV','HU':_0x38c069(0x1c5),'IE':_0x38c069(0x1e1),'IS':'ISL','IT':'ITA','LI':_0x38c069(0x190),'LT':_0x38c069(0x196),'LU':_0x38c069(0x1bf),'LV':_0x38c069(0x1cc),'MC':_0x38c069(0x16e),'MD':_0x38c069(0x187),'ME':'MNE','MK':_0x38c069(0x15b),'MT':'MLT','NL':_0x38c069(0x1c6),'NO':'NOR','PL':_0x38c069(0x1c2),'PT':_0x38c069(0x1aa),'RO':_0x38c069(0x1a9),'RS':_0x38c069(0x1a1),'RU':_0x38c069(0x1b1),'SE':_0x38c069(0x17a),'SI':_0x38c069(0x1e2),'SK':_0x38c069(0x15a),'SM':'SMR','UA':_0x38c069(0x1af),'VA':'VAT','XK':_0x38c069(0x17e),'AM':_0x38c069(0x1bd),'AZ':_0x38c069(0x15f),'KZ':_0x38c069(0x18f),'KG':_0x38c069(0x1b8),'TJ':_0x38c069(0x14f),'TM':_0x38c069(0x159),'UZ':_0x38c069(0x1a8),'US':_0x38c069(0x1da),'CA':_0x38c069(0x1ba),'AU':_0x38c069(0x1b4),'JP':_0x38c069(0x1a7),'CN':_0x38c069(0x1d3),'IN':_0x38c069(0x17f),'BR':_0x38c069(0x199),'MX':_0x38c069(0x186),'AR':_0x38c069(0x194),'CL':'CHL','PE':_0x38c069(0x164),'CO':'COL','VE':_0x38c069(0x1be),'EC':_0x38c069(0x15c),'BO':_0x38c069(0x16d),'PY':_0x38c069(0x178),'UY':_0x38c069(0x153),'SR':_0x38c069(0x16f),'GY':_0x38c069(0x198),'FK':_0x38c069(0x14e),'ZA':_0x38c069(0x1e0),'EG':_0x38c069(0x1d0),'NG':_0x38c069(0x18d),'KE':_0x38c069(0x1c3),'GH':_0x38c069(0x1c7),'TZ':_0x38c069(0x160),'UG':'UGA','ZW':_0x38c069(0x16b),'ZM':'ZMB','MW':'MWI','MZ':'MOZ','MG':_0x38c069(0x1b0),'MU':_0x38c069(0x19e),'SC':_0x38c069(0x1d8),'RE':_0x38c069(0x1c4),'TR':_0x38c069(0x165),'IR':_0x38c069(0x167),'IQ':_0x38c069(0x14b),'SA':_0x38c069(0x16a),'AE':_0x38c069(0x1d2),'KW':'KWT','QA':_0x38c069(0x1a6),'BH':_0x38c069(0x1c9),'OM':'OMN','YE':_0x38c069(0x169),'JO':'JOR','LB':'LBN','SY':'SYR','IL':'ISR','PS':_0x38c069(0x1ce),'KR':'KOR','KP':'PRK','TH':_0x38c069(0x1e5),'VN':_0x38c069(0x161),'MY':_0x38c069(0x1df),'SG':'SGP','ID':'IDN','PH':_0x38c069(0x155),'LA':_0x38c069(0x1a5),'KH':'KHM','MM':'MMR','BD':'BGD','LK':_0x38c069(0x191),'NP':_0x38c069(0x18c),'BT':_0x38c069(0x170),'MV':_0x38c069(0x192),'AF':'AFG','PK':_0x38c069(0x1a0),'MN':_0x38c069(0x1cf)},_0x13cf2a=_0x302372[_0x5e2474['toUpperCase']()];if(!_0x13cf2a)return console[_0x38c069(0x1d1)]('âš ï¸\x20Unknown\x20country\x20code:\x20'+_0x5e2474+_0x38c069(0x1db)),_0x38c069(0x1b1);return _0x13cf2a;}async['createPaymentLink'](_0x59d14a){const _0x9a8a4b=a56_0x2e7731;try{const {orderId:_0x4b00bd,amount:_0x231414,currency:_0xcefbd6,firstName:_0x2c915d,lastName:_0x5ecb16,email:_0x4c397a,customerIp:_0x8269de,customerCountry:_0x2ee7b8,successUrl:_0x156d2f,failureUrl:_0x37e850}=_0x59d14a;console['log'](_0x9a8a4b(0x1ad)),console['log']('Order\x20ID:',_0x4b00bd),console[_0x9a8a4b(0x1e4)](_0x9a8a4b(0x1c0),_0x231414,_0xcefbd6),console[_0x9a8a4b(0x1e4)](_0x9a8a4b(0x179),_0x2c915d+'\x20'+_0x5ecb16),console['log']('Email:',_0x4c397a),console[_0x9a8a4b(0x1e4)]('Customer\x20IP:',_0x8269de),console[_0x9a8a4b(0x1e4)](_0x9a8a4b(0x1cd),_0x2ee7b8);const _0x53bdb4=this['convert2LetterTo3LetterCountryCode'](_0x2ee7b8);console[_0x9a8a4b(0x1e4)](_0x9a8a4b(0x17c),_0x53bdb4);const _0x592bc3={'sub_method':_0x9a8a4b(0x18a),'currency':_0xcefbd6[_0x9a8a4b(0x1c8)](),'amount':_0x231414,'callback_url':_0x9a8a4b(0x163),'client_merchant_id':this[_0x9a8a4b(0x1a3)],'client_transaction_id':_0x4b00bd,'transaction_description':_0x4b00bd,'customer':{'ip':_0x8269de,'email':_0x4c397a,'full_name':_0x2c915d+'\x20'+_0x5ecb16,'country':_0x53bdb4},'success_redirect_url':_0x156d2f,'error_redirect_url':_0x37e850};console[_0x9a8a4b(0x1e4)](_0x9a8a4b(0x14c),JSON[_0x9a8a4b(0x188)](_0x592bc3,null,0x2));const _0x4dcf8a=await fetch(this[_0x9a8a4b(0x151)]+'ampay.php',{'method':_0x9a8a4b(0x1ca),'headers':{'Content-Type':_0x9a8a4b(0x1de),'User-Agent':'TrapayAPI/1.0'},'body':JSON['stringify'](_0x592bc3)}),_0x4b0847=await _0x4dcf8a[_0x9a8a4b(0x154)]();console['log'](_0x9a8a4b(0x1cb),_0x4b0847);if(!_0x4dcf8a['ok'])throw new Error(_0x9a8a4b(0x173)+_0x4dcf8a[_0x9a8a4b(0x15d)]+_0x9a8a4b(0x171)+_0x4b0847);let _0x1727a6;try{_0x1727a6=JSON['parse'](_0x4b0847);}catch(_0x245a73){throw new Error(_0x9a8a4b(0x152)+_0x4b0847);}console[_0x9a8a4b(0x1e4)](_0x9a8a4b(0x157),JSON['stringify'](_0x1727a6,null,0x2));if(!_0x1727a6[_0x9a8a4b(0x18b)])throw new Error(_0x9a8a4b(0x1e7)+(_0x1727a6[_0x9a8a4b(0x181)]||_0x1727a6['message']||_0x9a8a4b(0x168)));const _0x28f0c7=_0x1727a6['redirect_url'],_0x4f6a86=_0x1727a6['system_id'],_0x24a1d1=_0x1727a6['tracker_id'];return console[_0x9a8a4b(0x1e4)](_0x9a8a4b(0x17d)),console['log']('Payment\x20URL:',_0x28f0c7),console[_0x9a8a4b(0x1e4)](_0x9a8a4b(0x19b),_0x4f6a86),console['log']('Tracker\x20ID:',_0x24a1d1),console['log'](_0x9a8a4b(0x1e8),_0x1727a6['status']),console[_0x9a8a4b(0x1e4)](_0x9a8a4b(0x189)),{'gateway_payment_id':_0x4f6a86||_0x24a1d1||_0x4b00bd,'payment_url':_0x28f0c7||'','transaction_id':_0x4f6a86};}catch(_0x12e781){console['error'](_0x9a8a4b(0x1d5),_0x12e781),console[_0x9a8a4b(0x1e4)](_0x9a8a4b(0x1d4));throw _0x12e781;}}async[a56_0x2e7731(0x177)](){const _0xaf5224=a56_0x2e7731;try{const _0x2e6979=await fetch(this[_0xaf5224(0x151)]+'health.php',{'method':_0xaf5224(0x15e),'headers':{'Content-Type':'application/json','User-Agent':_0xaf5224(0x18e)}});return _0x2e6979&&_0x2e6979[_0xaf5224(0x15d)]===0xc8?!![]:![];}catch(_0x36db4b){return console[_0xaf5224(0x17b)](_0xaf5224(0x16c),_0x36db4b),![];}}async['processWebhook'](_0x1814df){const _0x50915f=a56_0x2e7731;console[_0x50915f(0x1e4)](_0x50915f(0x1b6)),console[_0x50915f(0x1e4)](_0x50915f(0x158)),console['log'](_0x50915f(0x1b5),_0x1814df),console[_0x50915f(0x1e4)]('Webhook\x20data\x20type:',typeof _0x1814df),console[_0x50915f(0x1e4)]('Available\x20fields:');_0x1814df&&typeof _0x1814df==='object'&&Object[_0x50915f(0x1ac)](_0x1814df)[_0x50915f(0x183)](_0xd93999=>{console['log']('\x20\x20'+_0xd93999+':\x20'+_0x1814df[_0xd93999]+'\x20('+typeof _0x1814df[_0xd93999]+')');});let _0x3ab40c=_0x50915f(0x1bb);const _0x5ef3f4=_0x1814df[_0x50915f(0x1d9)]||_0x1814df[_0x50915f(0x19a)]||_0x1814df[_0x50915f(0x156)]||'';return console[_0x50915f(0x1e4)]('Extracted\x20payment\x20ID:\x20'+_0x5ef3f4),console[_0x50915f(0x1e4)]('Forced\x20status\x20(webhook\x20disabled):\x20'+_0x3ab40c),!_0x5ef3f4&&(console['error'](_0x50915f(0x193)),console['error']('Checked\x20fields:\x20client_transaction_id,\x20system_id,\x20tracker_id')),{'paymentId':_0x5ef3f4,'status':_0x3ab40c,'amount':_0x1814df[_0x50915f(0x19f)],'currency':_0x1814df['currency']};}}exports[a56_0x2e7731(0x184)]=AmPayService,exports['ampayService']=new AmPayService();