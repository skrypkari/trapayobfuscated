'use strict';const a62_0x2e4ccb=a62_0xf127;function a62_0xf127(_0x4c0105,_0xefa50f){_0x4c0105=_0x4c0105-0xe4;const _0x3980b6=a62_0x3980();let _0xf127a2=_0x3980b6[_0x4c0105];return _0xf127a2;}(function(_0x53b608,_0x2def1a){const _0x2bb934=a62_0xf127,_0x5291a8=_0x53b608();while(!![]){try{const _0x548a1c=-parseInt(_0x2bb934(0x110))/0x1*(-parseInt(_0x2bb934(0x102))/0x2)+parseInt(_0x2bb934(0x113))/0x3+parseInt(_0x2bb934(0x11a))/0x4*(parseInt(_0x2bb934(0x17a))/0x5)+parseInt(_0x2bb934(0xf1))/0x6+-parseInt(_0x2bb934(0x136))/0x7*(parseInt(_0x2bb934(0x148))/0x8)+-parseInt(_0x2bb934(0xe6))/0x9+parseInt(_0x2bb934(0x179))/0xa;if(_0x548a1c===_0x2def1a)break;else _0x5291a8['push'](_0x5291a8['shift']());}catch(_0x694699){_0x5291a8['push'](_0x5291a8['shift']());}}}(a62_0x3980,0xc82f1));Object[a62_0x2e4ccb(0x15e)](exports,a62_0x2e4ccb(0x12f),{'value':!![]}),exports[a62_0x2e4ccb(0x115)]=exports[a62_0x2e4ccb(0x14b)]=void 0x0;function a62_0x3980(){const _0x3ac772=['Checked\x20fields:\x20client_transaction_id,\x20system_id,\x20tracker_id','System\x20ID:','GBR','RUS','MLT','GUY','GEO','BGD','MUS','===\x20Processing\x20AmPay\x20webhook\x20===','CHL','OMN','COL','âš ï¸\x20WEBHOOKS\x20TEMPORARILY\x20DISABLED\x20-\x20Always\x20returning\x20PROCESSING\x20status','BRA','CLIENT_MERCHANT_ID','2684TLhybm','58b59ccbc03dcdcfc20d830edfba765dbf9f3531c692533d84b17938e9c40bda','KEN','EGY','TZA','CAN','apiUrl','PSE','BOL','ðŸ“\x20Logging\x20AmPay\x20payment\x20creation\x20failure...','\x20-\x20','KWT','a5a059aa63392e571341bddc5148a5db66643722e9a6bf16a9395fb690a80288931d5a1180a85a28eb9f6516cf61dfc1bf4e37898f3a35261cd2db88888d3815','ESP','263gpDKvN','CYP','USA','2511006hjPVcL','LVA','ampayService','error','HRV','keys','SMR','776092RNQuDy','NLD','THA','PRK','PENDING','client_transaction_id','Forced\x20status\x20(webhook\x20disabled):\x20','JPN','createPaymentLink','tracker_id','UGA','SWE','PER','IRN','TUR','MNG','AUT','LAO','GAM','URY','UKR','__esModule','Customer\x20Country\x20(2-letter):','MKD','IDN','Order\x20ID:','MMR','toUpperCase','4207119qzQvkq','stringify','application/json','VAT','Customer\x20IP:','LBN','AmPay\x20payment\x20creation\x20failed:\x20','VEN','API_PUBLIC_KEY','SVK','SRB','YEM','FLK','SUR','MWI','MOZ','redirect_url','forEach','8hWlwJa','parse','HUN','AmPayService','FRA','LKA','CHE','BHR','BTN','SYR','error_message','BGR','message','LTU','IRQ','REU','Invalid\x20JSON\x20response\x20from\x20AmPay:\x20','KHM','Available\x20fields:','JOR','log','KAZ','defineProperty','PRT','TJK','ampay.php','Unknown\x20error','GRC','healthCheck','warn','FIN','ISR','AFG','ðŸ“\x20Logging\x20AmPay\x20payment\x20creation\x20event...','ðŸ“Š\x20AmPay\x20response\x20data:','MCO','KGZ','Status:','CZE','CHN','text','system_id','ECU','processWebhook','MDV','https://traffer.uk/gateway/ampay/webhook.php','POL','BIH','AND','8237210giIbOr','10rzqEkE','ARM','QAT','convert2LetterTo3LetterCountryCode','DEU','LIE','API_PRIVATE_KEY','MEX','ISL','NGA','AZE','ðŸ‡¦ðŸ‡²\x20Creating\x20AmPay\x20payment\x20link...','status','SGP','âŒ\x20AmPay\x20health\x20check\x20failed:','KOR','ARE','9047835GAelqh','SAU','ZMB','https://traffer.uk/gateway/ampay/','SVN','PHL','NPL','PRY','BEL','health.php','ðŸ‡¦ðŸ‡²\x20AmPay\x20service\x20initialized\x20with\x20Open\x20Banking\x20AM\x20processing','147420ucUWBt'];a62_0x3980=function(){return _0x3ac772;};return a62_0x3980();}class AmPayService{constructor(){const _0x439b52=a62_0x2e4ccb;this['CLIENT_MERCHANT_ID']='TRAFFER',this[_0x439b52(0x13e)]=_0x439b52(0x103),this[_0x439b52(0x180)]=_0x439b52(0x10e),this['apiUrl']=_0x439b52(0xe9),console[_0x439b52(0x15c)](_0x439b52(0xf0));}[a62_0x2e4ccb(0x17d)](_0x766739){const _0x401d6b=a62_0x2e4ccb,_0x4a2b42={'AD':_0x401d6b(0x178),'AL':'ALB','AT':_0x401d6b(0x12a),'BA':_0x401d6b(0x177),'BE':_0x401d6b(0xee),'BG':_0x401d6b(0x153),'BY':'BLR','CH':_0x401d6b(0x14e),'CY':_0x401d6b(0x111),'CZ':_0x401d6b(0x16e),'DE':_0x401d6b(0x17e),'DK':'DNK','EE':'EST','ES':_0x401d6b(0x10f),'FI':_0x401d6b(0x166),'FR':_0x401d6b(0x14c),'GB':_0x401d6b(0xf4),'GE':_0x401d6b(0xf8),'GR':_0x401d6b(0x163),'HR':_0x401d6b(0x117),'HU':_0x401d6b(0x14a),'IE':'IRL','IS':_0x401d6b(0x182),'IT':'ITA','LI':_0x401d6b(0x17f),'LT':_0x401d6b(0x155),'LU':'LUX','LV':_0x401d6b(0x114),'MC':_0x401d6b(0x16b),'MD':'MDA','ME':'MNE','MK':_0x401d6b(0x131),'MT':_0x401d6b(0xf6),'NL':_0x401d6b(0x11b),'NO':'NOR','PL':_0x401d6b(0x176),'PT':_0x401d6b(0x15f),'RO':'ROU','RS':_0x401d6b(0x140),'RU':_0x401d6b(0xf5),'SE':_0x401d6b(0x125),'SI':_0x401d6b(0xea),'SK':_0x401d6b(0x13f),'SM':_0x401d6b(0x119),'UA':_0x401d6b(0x12e),'VA':_0x401d6b(0x139),'XK':'XKX','AM':_0x401d6b(0x17b),'AZ':_0x401d6b(0x184),'KZ':_0x401d6b(0x15d),'KG':_0x401d6b(0x16c),'TJ':_0x401d6b(0x160),'TM':'TKM','UZ':'UZB','US':_0x401d6b(0x112),'CA':_0x401d6b(0x107),'AU':'AUS','JP':_0x401d6b(0x121),'CN':_0x401d6b(0x16f),'IN':'IND','BR':_0x401d6b(0x100),'MX':_0x401d6b(0x181),'AR':'ARG','CL':_0x401d6b(0xfc),'PE':_0x401d6b(0x126),'CO':_0x401d6b(0xfe),'VE':_0x401d6b(0x13d),'EC':_0x401d6b(0x172),'BO':_0x401d6b(0x10a),'PY':_0x401d6b(0xed),'UY':_0x401d6b(0x12d),'SR':_0x401d6b(0x143),'GY':_0x401d6b(0xf7),'FK':_0x401d6b(0x142),'ZA':'ZAF','EG':_0x401d6b(0x105),'NG':_0x401d6b(0x183),'KE':_0x401d6b(0x104),'GH':'GHA','TZ':_0x401d6b(0x106),'UG':_0x401d6b(0x124),'ZW':'ZWE','ZM':_0x401d6b(0xe8),'MW':_0x401d6b(0x144),'MZ':_0x401d6b(0x145),'MG':'MDG','MU':_0x401d6b(0xfa),'SC':'SYC','RE':_0x401d6b(0x157),'TR':_0x401d6b(0x128),'IR':_0x401d6b(0x127),'IQ':_0x401d6b(0x156),'SA':_0x401d6b(0xe7),'AE':_0x401d6b(0xe5),'KW':_0x401d6b(0x10d),'QA':_0x401d6b(0x17c),'BH':_0x401d6b(0x14f),'OM':_0x401d6b(0xfd),'YE':_0x401d6b(0x141),'JO':_0x401d6b(0x15b),'LB':_0x401d6b(0x13b),'SY':_0x401d6b(0x151),'IL':_0x401d6b(0x167),'PS':_0x401d6b(0x109),'KR':_0x401d6b(0xe4),'KP':_0x401d6b(0x11d),'TH':_0x401d6b(0x11c),'VN':'VNM','MY':'MYS','SG':_0x401d6b(0x187),'ID':_0x401d6b(0x132),'PH':_0x401d6b(0xeb),'LA':_0x401d6b(0x12b),'KH':_0x401d6b(0x159),'MM':_0x401d6b(0x134),'BD':_0x401d6b(0xf9),'LK':_0x401d6b(0x14d),'NP':_0x401d6b(0xec),'BT':_0x401d6b(0x150),'MV':_0x401d6b(0x174),'AF':_0x401d6b(0x168),'PK':'PAK','MN':_0x401d6b(0x129)},_0x14feaf=_0x4a2b42[_0x766739[_0x401d6b(0x135)]()];if(!_0x14feaf)return console[_0x401d6b(0x165)]('âš ï¸\x20Unknown\x20country\x20code:\x20'+_0x766739+',\x20using\x20RUS\x20as\x20fallback'),_0x401d6b(0xf5);return _0x14feaf;}async[a62_0x2e4ccb(0x122)](_0x30dd0f){const _0x5dd7cb=a62_0x2e4ccb;try{const {orderId:_0x325d62,amount:_0x63e697,currency:_0x1fd202,firstName:_0xd69e82,lastName:_0x25cb39,email:_0x260445,customerIp:_0x106364,customerCountry:_0x5c1370,successUrl:_0x5a75a,failureUrl:_0x535ac7}=_0x30dd0f;console[_0x5dd7cb(0x15c)](_0x5dd7cb(0x185)),console[_0x5dd7cb(0x15c)](_0x5dd7cb(0x133),_0x325d62),console[_0x5dd7cb(0x15c)]('Amount:',_0x63e697,_0x1fd202),console[_0x5dd7cb(0x15c)]('Customer:',_0xd69e82+'\x20'+_0x25cb39),console[_0x5dd7cb(0x15c)]('Email:',_0x260445),console['log'](_0x5dd7cb(0x13a),_0x106364),console[_0x5dd7cb(0x15c)](_0x5dd7cb(0x130),_0x5c1370);const _0x15afa6=this[_0x5dd7cb(0x17d)](_0x5c1370);console[_0x5dd7cb(0x15c)]('Customer\x20Country\x20(3-letter):',_0x15afa6);const _0x2418a6={'sub_method':_0x5dd7cb(0x12c),'currency':_0x1fd202['toUpperCase'](),'amount':_0x63e697,'callback_url':_0x5dd7cb(0x175),'client_merchant_id':this[_0x5dd7cb(0x101)],'client_transaction_id':_0x325d62,'transaction_description':_0x325d62,'customer':{'ip':_0x106364,'email':_0x260445,'full_name':_0xd69e82+'\x20'+_0x25cb39,'country':_0x15afa6},'success_redirect_url':_0x5a75a,'error_redirect_url':_0x535ac7};console[_0x5dd7cb(0x15c)]('ðŸ“¤\x20AmPay\x20request\x20body:',JSON[_0x5dd7cb(0x137)](_0x2418a6,null,0x2));const _0x3b3ba8=await fetch(this[_0x5dd7cb(0x108)]+_0x5dd7cb(0x161),{'method':'POST','headers':{'Content-Type':_0x5dd7cb(0x138),'User-Agent':'TrapayAPI/1.0'},'body':JSON[_0x5dd7cb(0x137)](_0x2418a6)}),_0x1566ef=await _0x3b3ba8[_0x5dd7cb(0x170)]();console['log']('ðŸ“¥\x20AmPay\x20raw\x20response:',_0x1566ef);if(!_0x3b3ba8['ok'])throw new Error('AmPay\x20API\x20error:\x20HTTP\x20'+_0x3b3ba8[_0x5dd7cb(0x186)]+_0x5dd7cb(0x10c)+_0x1566ef);let _0x262194;try{_0x262194=JSON[_0x5dd7cb(0x149)](_0x1566ef);}catch(_0x5a5f41){throw new Error(_0x5dd7cb(0x158)+_0x1566ef);}console[_0x5dd7cb(0x15c)](_0x5dd7cb(0x16a),JSON[_0x5dd7cb(0x137)](_0x262194,null,0x2));if(!_0x262194[_0x5dd7cb(0x146)])throw new Error(_0x5dd7cb(0x13c)+(_0x262194[_0x5dd7cb(0x152)]||_0x262194[_0x5dd7cb(0x154)]||_0x5dd7cb(0x162)));const _0x111393=_0x262194['redirect_url'],_0x343300=_0x262194['system_id'],_0x1a6c2a=_0x262194[_0x5dd7cb(0x123)];return console['log']('âœ…\x20AmPay\x20payment\x20link\x20created\x20successfully'),console[_0x5dd7cb(0x15c)]('Payment\x20URL:',_0x111393),console[_0x5dd7cb(0x15c)](_0x5dd7cb(0xf3),_0x343300),console[_0x5dd7cb(0x15c)]('Tracker\x20ID:',_0x1a6c2a),console[_0x5dd7cb(0x15c)](_0x5dd7cb(0x16d),_0x262194['status']),console['log'](_0x5dd7cb(0x169)),{'gateway_payment_id':_0x343300||_0x1a6c2a||_0x325d62,'payment_url':_0x111393||'','transaction_id':_0x343300};}catch(_0x5d47a1){console[_0x5dd7cb(0x116)]('âŒ\x20AmPay\x20payment\x20creation\x20failed:',_0x5d47a1),console[_0x5dd7cb(0x15c)](_0x5dd7cb(0x10b));throw _0x5d47a1;}}async[a62_0x2e4ccb(0x164)](){const _0x21cec0=a62_0x2e4ccb;try{const _0xcc4433=await fetch(this[_0x21cec0(0x108)]+_0x21cec0(0xef),{'method':'GET','headers':{'Content-Type':_0x21cec0(0x138),'User-Agent':'TrapayAPI/1.0'}});return _0xcc4433&&_0xcc4433[_0x21cec0(0x186)]===0xc8?!![]:![];}catch(_0x3b6c25){return console[_0x21cec0(0x116)](_0x21cec0(0x188),_0x3b6c25),![];}}async[a62_0x2e4ccb(0x173)](_0x566ec3){const _0xb797a6=a62_0x2e4ccb;console[_0xb797a6(0x15c)](_0xb797a6(0xfb)),console[_0xb797a6(0x15c)](_0xb797a6(0xff)),console['log']('Webhook\x20data:',_0x566ec3),console[_0xb797a6(0x15c)]('Webhook\x20data\x20type:',typeof _0x566ec3),console['log'](_0xb797a6(0x15a));_0x566ec3&&typeof _0x566ec3==='object'&&Object[_0xb797a6(0x118)](_0x566ec3)[_0xb797a6(0x147)](_0x2fa877=>{const _0x5e495a=_0xb797a6;console[_0x5e495a(0x15c)]('\x20\x20'+_0x2fa877+':\x20'+_0x566ec3[_0x2fa877]+'\x20('+typeof _0x566ec3[_0x2fa877]+')');});let _0x59f2fc=_0xb797a6(0x11e);const _0x41b773=_0x566ec3[_0xb797a6(0x11f)]||_0x566ec3[_0xb797a6(0x171)]||_0x566ec3[_0xb797a6(0x123)]||'';return console[_0xb797a6(0x15c)]('Extracted\x20payment\x20ID:\x20'+_0x41b773),console['log'](_0xb797a6(0x120)+_0x59f2fc),!_0x41b773&&(console[_0xb797a6(0x116)]('No\x20payment\x20ID\x20found\x20in\x20webhook\x20data'),console[_0xb797a6(0x116)](_0xb797a6(0xf2))),{'paymentId':_0x41b773,'status':_0x59f2fc,'amount':_0x566ec3['amount'],'currency':_0x566ec3['currency']};}}exports['AmPayService']=AmPayService,exports[a62_0x2e4ccb(0x115)]=new AmPayService();