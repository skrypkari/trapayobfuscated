'use strict';function a46_0x5062(_0x24389d,_0xbcd1e3){const _0x4fe2eb=a46_0x4fe2();return a46_0x5062=function(_0x5062bb,_0x35ccbf){_0x5062bb=_0x5062bb-0x6f;let _0x1daf28=_0x4fe2eb[_0x5062bb];return _0x1daf28;},a46_0x5062(_0x24389d,_0xbcd1e3);}const a46_0x5947b0=a46_0x5062;(function(_0x1fb5e6,_0x55b6ee){const _0xc227b1=a46_0x5062,_0x36a870=_0x1fb5e6();while(!![]){try{const _0x4f2248=-parseInt(_0xc227b1(0xed))/0x1+-parseInt(_0xc227b1(0xca))/0x2*(-parseInt(_0xc227b1(0xc0))/0x3)+-parseInt(_0xc227b1(0x8e))/0x4*(parseInt(_0xc227b1(0xb9))/0x5)+parseInt(_0xc227b1(0xa3))/0x6*(parseInt(_0xc227b1(0xe5))/0x7)+parseInt(_0xc227b1(0x9b))/0x8*(-parseInt(_0xc227b1(0xd5))/0x9)+parseInt(_0xc227b1(0x81))/0xa*(-parseInt(_0xc227b1(0x95))/0xb)+-parseInt(_0xc227b1(0x77))/0xc;if(_0x4f2248===_0x55b6ee)break;else _0x36a870['push'](_0x36a870['shift']());}catch(_0x53f8){_0x36a870['push'](_0x36a870['shift']());}}}(a46_0x4fe2,0x88f7b));function a46_0x4fe2(){const _0x1cb506=['convert2LetterTo3LetterCountryCode','LBN','toUpperCase','TUR','KGZ','amount','NGA','SYC','FLK','BOL','health.php','GRC','MDV','object','ALB','BLR','BGR','text','GAM','7005pukdCq','SMR','Customer\x20Country\x20(2-letter):','AZE','HUN','MDG','OMN','15qXdRvt','SVN','defineProperty','https://traffer.uk/gateway/ampay/webhook.php','58b59ccbc03dcdcfc20d830edfba765dbf9f3531c692533d84b17938e9c40bda','LAO','Webhook\x20data:','KHM','Customer\x20IP:','AUS','346734QYypka','AUT','system_id','AmPay\x20API\x20error:\x20HTTP\x20','ampayService','QAT','Invalid\x20JSON\x20response\x20from\x20AmPay:\x20','JOR','https://traffer.uk/gateway/ampay/','GHA','ROU','9DzjaKn','PER','error','SRB','MNG','TJK','PRT','GBR','❌\x20AmPay\x20health\x20check\x20failed:','keys','Customer:','Checked\x20fields:\x20client_transaction_id,\x20system_id,\x20tracker_id','log','MYS','📝\x20Logging\x20AmPay\x20payment\x20creation\x20failure...','MNE','7144711Tbryyo','processWebhook','CLIENT_MERCHANT_ID','error_message','SWE','POL','Order\x20ID:','JPN','102836xjxOyC','✅\x20AmPay\x20payment\x20link\x20created\x20successfully','apiUrl','📊\x20AmPay\x20response\x20data:','TZA','TrapayAPI/1.0','IRQ','Payment\x20URL:','❌\x20AmPay\x20payment\x20creation\x20failed:','ZMB','IRN','createPaymentLink','RUS','stringify','PRK','VEN','TKM','VAT','SGP','redirect_url','tracker_id','ARM','GET','CYP','URY','application/json','\x20-\x20','📝\x20Logging\x20AmPay\x20payment\x20creation\x20event...','AFG','📥\x20AmPay\x20raw\x20response:','SVK','MLT','PSE','⚠️\x20Unknown\x20country\x20code:\x20','LTU','ECU','PAK','3812316iIlLQb','System\x20ID:','MUS','ARG','REU','SUR','ZWE','healthCheck','EGY','CAN','30eqvEgD','currency','THA','status','AmPayService','Email:','parse','MWI','🇦🇲\x20Creating\x20AmPay\x20payment\x20link...','SYR','XKX','API_PRIVATE_KEY','NLD','1040VcXpVZ','Tracker\x20ID:','Forced\x20status\x20(webhook\x20disabled):\x20','⚠️\x20WEBHOOKS\x20TEMPORARILY\x20DISABLED\x20-\x20Always\x20returning\x20PROCESSING\x20status','BGD','UZB','message','1915595mnaXuO','📤\x20AmPay\x20request\x20body:','AND','MKD','IND','Amount:','154120ewFciH','FIN','VNM','CZE','TRAFFER','YEM','FRA','MCO','6jqhenU','No\x20payment\x20ID\x20found\x20in\x20webhook\x20data','LVA'];a46_0x4fe2=function(){return _0x1cb506;};return a46_0x4fe2();}Object[a46_0x5947b0(0xc2)](exports,'__esModule',{'value':!![]}),exports[a46_0x5947b0(0xce)]=exports['AmPayService']=void 0x0;class AmPayService{constructor(){const _0x2d5232=a46_0x5947b0;this['CLIENT_MERCHANT_ID']=_0x2d5232(0x9f),this['API_PUBLIC_KEY']=_0x2d5232(0xc4),this[_0x2d5232(0x8c)]='a5a059aa63392e571341bddc5148a5db66643722e9a6bf16a9395fb690a80288931d5a1180a85a28eb9f6516cf61dfc1bf4e37898f3a35261cd2db88888d3815',this[_0x2d5232(0xef)]=_0x2d5232(0xd2),console['log']('🇦🇲\x20AmPay\x20service\x20initialized\x20with\x20Open\x20Banking\x20AM\x20processing');}[a46_0x5947b0(0xa6)](_0x26d617){const _0x276eee=a46_0x5947b0,_0x365568={'AD':_0x276eee(0x97),'AL':_0x276eee(0xb4),'AT':_0x276eee(0xcb),'BA':'BIH','BE':'BEL','BG':_0x276eee(0xb6),'BY':_0x276eee(0xb5),'CH':'CHE','CY':_0x276eee(0x104),'CZ':_0x276eee(0x9e),'DE':'DEU','DK':'DNK','EE':'EST','ES':'ESP','FI':_0x276eee(0x9c),'FR':_0x276eee(0xa1),'GB':_0x276eee(0xdc),'GE':'GEO','GR':_0x276eee(0xb1),'HR':'HRV','HU':_0x276eee(0xbd),'IE':'IRL','IS':'ISL','IT':'ITA','LI':'LIE','LT':_0x276eee(0x74),'LU':'LUX','LV':_0x276eee(0xa5),'MC':_0x276eee(0xa2),'MD':'MDA','ME':_0x276eee(0xe4),'MK':_0x276eee(0x98),'MT':_0x276eee(0x71),'NL':_0x276eee(0x8d),'NO':'NOR','PL':_0x276eee(0xea),'PT':_0x276eee(0xdb),'RO':_0x276eee(0xd4),'RS':_0x276eee(0xd8),'RU':'RUS','SE':_0x276eee(0xe9),'SI':_0x276eee(0xc1),'SK':_0x276eee(0x70),'SM':_0x276eee(0xba),'UA':'UKR','VA':_0x276eee(0xfe),'XK':_0x276eee(0x8b),'AM':_0x276eee(0x102),'AZ':_0x276eee(0xbc),'KZ':'KAZ','KG':_0x276eee(0xaa),'TJ':_0x276eee(0xda),'TM':_0x276eee(0xfd),'UZ':_0x276eee(0x93),'US':'USA','CA':_0x276eee(0x80),'AU':_0x276eee(0xc9),'JP':_0x276eee(0xec),'CN':'CHN','IN':_0x276eee(0x99),'BR':'BRA','MX':'MEX','AR':_0x276eee(0x7a),'CL':'CHL','PE':_0x276eee(0xd6),'CO':'COL','VE':_0x276eee(0xfc),'EC':_0x276eee(0x75),'BO':_0x276eee(0xaf),'PY':'PRY','UY':_0x276eee(0x105),'SR':_0x276eee(0x7c),'GY':'GUY','FK':_0x276eee(0xae),'ZA':'ZAF','EG':_0x276eee(0x7f),'NG':_0x276eee(0xac),'KE':'KEN','GH':_0x276eee(0xd3),'TZ':_0x276eee(0xf1),'UG':'UGA','ZW':_0x276eee(0x7d),'ZM':_0x276eee(0xf6),'MW':_0x276eee(0x88),'MZ':'MOZ','MG':_0x276eee(0xbe),'MU':_0x276eee(0x79),'SC':_0x276eee(0xad),'RE':_0x276eee(0x7b),'TR':_0x276eee(0xa9),'IR':_0x276eee(0xf7),'IQ':_0x276eee(0xf3),'SA':'SAU','AE':'ARE','KW':'KWT','QA':_0x276eee(0xcf),'BH':'BHR','OM':_0x276eee(0xbf),'YE':_0x276eee(0xa0),'JO':_0x276eee(0xd1),'LB':_0x276eee(0xa7),'SY':_0x276eee(0x8a),'IL':'ISR','PS':_0x276eee(0x72),'KR':'KOR','KP':_0x276eee(0xfb),'TH':_0x276eee(0x83),'VN':_0x276eee(0x9d),'MY':_0x276eee(0xe2),'SG':_0x276eee(0xff),'ID':'IDN','PH':'PHL','LA':_0x276eee(0xc5),'KH':_0x276eee(0xc7),'MM':'MMR','BD':_0x276eee(0x92),'LK':'LKA','NP':'NPL','BT':'BTN','MV':_0x276eee(0xb2),'AF':_0x276eee(0x109),'PK':_0x276eee(0x76),'MN':_0x276eee(0xd9)},_0x5e2cf0=_0x365568[_0x26d617['toUpperCase']()];if(!_0x5e2cf0)return console['warn'](_0x276eee(0x73)+_0x26d617+',\x20using\x20RUS\x20as\x20fallback'),_0x276eee(0xf9);return _0x5e2cf0;}async[a46_0x5947b0(0xf8)](_0x2deecd){const _0x58e3fd=a46_0x5947b0;try{const {orderId:_0x1b4c01,amount:_0x10ba44,currency:_0x122795,firstName:_0x17a1a0,lastName:_0x204c0d,email:_0x287d6f,customerIp:_0x338391,customerCountry:_0x3ca38c,successUrl:_0x158576,failureUrl:_0x257e02}=_0x2deecd;console[_0x58e3fd(0xe1)](_0x58e3fd(0x89)),console[_0x58e3fd(0xe1)](_0x58e3fd(0xeb),_0x1b4c01),console[_0x58e3fd(0xe1)](_0x58e3fd(0x9a),_0x10ba44,_0x122795),console[_0x58e3fd(0xe1)](_0x58e3fd(0xdf),_0x17a1a0+'\x20'+_0x204c0d),console[_0x58e3fd(0xe1)](_0x58e3fd(0x86),_0x287d6f),console['log'](_0x58e3fd(0xc8),_0x338391),console['log'](_0x58e3fd(0xbb),_0x3ca38c);const _0x249c09=this[_0x58e3fd(0xa6)](_0x3ca38c);console[_0x58e3fd(0xe1)]('Customer\x20Country\x20(3-letter):',_0x249c09);const _0xe9984={'sub_method':_0x58e3fd(0xb8),'currency':_0x122795[_0x58e3fd(0xa8)](),'amount':_0x10ba44,'callback_url':_0x58e3fd(0xc3),'client_merchant_id':this[_0x58e3fd(0xe7)],'client_transaction_id':_0x1b4c01,'transaction_description':_0x1b4c01,'customer':{'ip':_0x338391,'email':_0x287d6f,'full_name':_0x17a1a0+'\x20'+_0x204c0d,'country':_0x249c09},'success_redirect_url':_0x158576,'error_redirect_url':_0x257e02};console[_0x58e3fd(0xe1)](_0x58e3fd(0x96),JSON[_0x58e3fd(0xfa)](_0xe9984,null,0x2));const _0x1eddd0=await fetch(this[_0x58e3fd(0xef)]+'ampay.php',{'method':'POST','headers':{'Content-Type':_0x58e3fd(0x106),'User-Agent':_0x58e3fd(0xf2)},'body':JSON[_0x58e3fd(0xfa)](_0xe9984)}),_0xbec98b=await _0x1eddd0[_0x58e3fd(0xb7)]();console[_0x58e3fd(0xe1)](_0x58e3fd(0x6f),_0xbec98b);if(!_0x1eddd0['ok'])throw new Error(_0x58e3fd(0xcd)+_0x1eddd0['status']+_0x58e3fd(0x107)+_0xbec98b);let _0x222740;try{_0x222740=JSON[_0x58e3fd(0x87)](_0xbec98b);}catch(_0x5cc931){throw new Error(_0x58e3fd(0xd0)+_0xbec98b);}console[_0x58e3fd(0xe1)](_0x58e3fd(0xf0),JSON[_0x58e3fd(0xfa)](_0x222740,null,0x2));if(!_0x222740[_0x58e3fd(0x100)])throw new Error('AmPay\x20payment\x20creation\x20failed:\x20'+(_0x222740[_0x58e3fd(0xe8)]||_0x222740[_0x58e3fd(0x94)]||'Unknown\x20error'));const _0xd6c85b=_0x222740[_0x58e3fd(0x100)],_0x37ac01=_0x222740[_0x58e3fd(0xcc)],_0x2a684f=_0x222740[_0x58e3fd(0x101)];return console[_0x58e3fd(0xe1)](_0x58e3fd(0xee)),console[_0x58e3fd(0xe1)](_0x58e3fd(0xf4),_0xd6c85b),console[_0x58e3fd(0xe1)](_0x58e3fd(0x78),_0x37ac01),console[_0x58e3fd(0xe1)](_0x58e3fd(0x8f),_0x2a684f),console[_0x58e3fd(0xe1)]('Status:',_0x222740[_0x58e3fd(0x84)]),console[_0x58e3fd(0xe1)](_0x58e3fd(0x108)),{'gateway_payment_id':_0x37ac01||_0x2a684f||_0x1b4c01,'payment_url':_0xd6c85b||'','transaction_id':_0x37ac01};}catch(_0x92ca38){console[_0x58e3fd(0xd7)](_0x58e3fd(0xf5),_0x92ca38),console[_0x58e3fd(0xe1)](_0x58e3fd(0xe3));throw _0x92ca38;}}async[a46_0x5947b0(0x7e)](){const _0x18704c=a46_0x5947b0;try{const _0x15598d=await fetch(this[_0x18704c(0xef)]+_0x18704c(0xb0),{'method':_0x18704c(0x103),'headers':{'Content-Type':_0x18704c(0x106),'User-Agent':_0x18704c(0xf2)}});return _0x15598d&&_0x15598d['status']===0xc8?!![]:![];}catch(_0x4fd4b8){return console[_0x18704c(0xd7)](_0x18704c(0xdd),_0x4fd4b8),![];}}async[a46_0x5947b0(0xe6)](_0x411b2e){const _0xa89cc=a46_0x5947b0;console[_0xa89cc(0xe1)]('===\x20Processing\x20AmPay\x20webhook\x20==='),console[_0xa89cc(0xe1)](_0xa89cc(0x91)),console[_0xa89cc(0xe1)](_0xa89cc(0xc6),_0x411b2e),console[_0xa89cc(0xe1)]('Webhook\x20data\x20type:',typeof _0x411b2e),console[_0xa89cc(0xe1)]('Available\x20fields:');_0x411b2e&&typeof _0x411b2e===_0xa89cc(0xb3)&&Object[_0xa89cc(0xde)](_0x411b2e)['forEach'](_0x15741f=>{const _0x7effe8=_0xa89cc;console[_0x7effe8(0xe1)]('\x20\x20'+_0x15741f+':\x20'+_0x411b2e[_0x15741f]+'\x20('+typeof _0x411b2e[_0x15741f]+')');});let _0x263cee='PENDING';const _0x3aefe9=_0x411b2e['client_transaction_id']||_0x411b2e[_0xa89cc(0xcc)]||_0x411b2e['tracker_id']||'';return console[_0xa89cc(0xe1)]('Extracted\x20payment\x20ID:\x20'+_0x3aefe9),console[_0xa89cc(0xe1)](_0xa89cc(0x90)+_0x263cee),!_0x3aefe9&&(console['error'](_0xa89cc(0xa4)),console[_0xa89cc(0xd7)](_0xa89cc(0xe0))),{'paymentId':_0x3aefe9,'status':_0x263cee,'amount':_0x411b2e[_0xa89cc(0xab)],'currency':_0x411b2e[_0xa89cc(0x82)]};}}exports[a46_0x5947b0(0x85)]=AmPayService,exports[a46_0x5947b0(0xce)]=new AmPayService();