'use strict';function a44_0x813b(){const _0x3402ef=['DEU','SGP','MWI','Order\x20ID:','amount','MUS','MEX','PRK','UGA','LTU','PAK','BTN','GRC','📝\x20Logging\x20AmPay\x20payment\x20creation\x20event...','Forced\x20status\x20(webhook\x20disabled):\x20','NPL','redirect_url','GET','client_transaction_id','ZMB','694530llbnex','📥\x20AmPay\x20raw\x20response:','object','tracker_id','UZB','BRA','SVN','Tracker\x20ID:','SUR','defineProperty','9556552GLwQiF','HRV','THA','GUY','apiUrl','USA','VEN','EGY','AmPay\x20payment\x20creation\x20failed:\x20','IRQ','PER','Customer:','TrapayAPI/1.0','BGD','JOR','COL','text','JPN','error','KHM','processWebhook','PRY','214155CUGOeZ','MOZ','GHA','MNE','message','9NcwgIV','PHL','CHL','log','RUS','🇦🇲\x20AmPay\x20service\x20initialized\x20with\x20Open\x20Banking\x20AM\x20processing','KWT','AUS','LVA','PENDING','MCO','IDN','HUN','REU','Email:','FRA','BHR','⚠️\x20Unknown\x20country\x20code:\x20','LAO','MKD','IRL','LUX','SYC','SRB','Checked\x20fields:\x20client_transaction_id,\x20system_id,\x20tracker_id','AFG','AUT','GBR','Customer\x20Country\x20(3-letter):','===\x20Processing\x20AmPay\x20webhook\x20===','\x20-\x20','5QGfmSo','📊\x20AmPay\x20response\x20data:','ECU','Invalid\x20JSON\x20response\x20from\x20AmPay:\x20','YEM','CAN','https://traffer.uk/gateway/ampay/','IND','Payment\x20URL:','KOR','ISL','TKM','MNG','CLIENT_MERCHANT_ID','FIN','📤\x20AmPay\x20request\x20body:','GEO','ITA','warn','TUR',',\x20using\x20RUS\x20as\x20fallback','BGR','VAT','🇦🇲\x20Creating\x20AmPay\x20payment\x20link...','Webhook\x20data\x20type:','status','LIE','health.php','PSE','API_PRIVATE_KEY','TZA','BLR','convert2LetterTo3LetterCountryCode','LKA','application/json','AmPayService','QAT','ROU','ESP','49691170KkLiTK','ampayService','888lRsROh','system_id','ampay.php','ISR','Customer\x20Country\x20(2-letter):','NOR','TRAFFER','System\x20ID:','Webhook\x20data:','9071622iViwtA','MDG','MDV','No\x20payment\x20ID\x20found\x20in\x20webhook\x20data','9066RpuAzR','Customer\x20IP:','toUpperCase','EST','IRN','AND','BEL','MYS','XKX','MDA','CHE','CHN','DNK','BIH','ARE','KGZ','TJK','URY','POL','CZE','PRT','1806112SmSUli','CYP','KAZ','❌\x20AmPay\x20health\x20check\x20failed:','KEN','⚠️\x20WEBHOOKS\x20TEMPORARILY\x20DISABLED\x20-\x20Always\x20returning\x20PROCESSING\x20status','SYR','error_message','stringify','FLK','SVK'];a44_0x813b=function(){return _0x3402ef;};return a44_0x813b();}const a44_0x52b753=a44_0x3960;(function(_0x2f8130,_0x50a9a0){const _0x1cfde6=a44_0x3960,_0x4c9d1f=_0x2f8130();while(!![]){try{const _0x457e46=parseInt(_0x1cfde6(0x145))/0x1+parseInt(_0x1cfde6(0x192))/0x2*(-parseInt(_0x1cfde6(0x19f))/0x3)+-parseInt(_0x1cfde6(0x1b4))/0x4+-parseInt(_0x1cfde6(0x169))/0x5*(parseInt(_0x1cfde6(0x125))/0x6)+-parseInt(_0x1cfde6(0x19b))/0x7+-parseInt(_0x1cfde6(0x12f))/0x8+parseInt(_0x1cfde6(0x14a))/0x9*(parseInt(_0x1cfde6(0x190))/0xa);if(_0x457e46===_0x50a9a0)break;else _0x4c9d1f['push'](_0x4c9d1f['shift']());}catch(_0xa257b9){_0x4c9d1f['push'](_0x4c9d1f['shift']());}}}(a44_0x813b,0xbf55a));Object[a44_0x52b753(0x12e)](exports,'__esModule',{'value':!![]}),exports[a44_0x52b753(0x191)]=exports[a44_0x52b753(0x18c)]=void 0x0;class AmPayService{constructor(){const _0x25c7a0=a44_0x52b753;this[_0x25c7a0(0x176)]=_0x25c7a0(0x198),this['API_PUBLIC_KEY']='58b59ccbc03dcdcfc20d830edfba765dbf9f3531c692533d84b17938e9c40bda',this[_0x25c7a0(0x186)]='a5a059aa63392e571341bddc5148a5db66643722e9a6bf16a9395fb690a80288931d5a1180a85a28eb9f6516cf61dfc1bf4e37898f3a35261cd2db88888d3815',this[_0x25c7a0(0x133)]=_0x25c7a0(0x16f),console[_0x25c7a0(0x14d)](_0x25c7a0(0x14f));}[a44_0x52b753(0x189)](_0x2ff2a6){const _0x2d1fe6=a44_0x52b753,_0x427661={'AD':_0x2d1fe6(0x1a4),'AL':'ALB','AT':_0x2d1fe6(0x164),'BA':_0x2d1fe6(0x1ac),'BE':_0x2d1fe6(0x1a5),'BG':_0x2d1fe6(0x17e),'BY':_0x2d1fe6(0x188),'CH':_0x2d1fe6(0x1a9),'CY':_0x2d1fe6(0x1b5),'CZ':_0x2d1fe6(0x1b2),'DE':_0x2d1fe6(0x1bf),'DK':_0x2d1fe6(0x1ab),'EE':_0x2d1fe6(0x1a2),'ES':_0x2d1fe6(0x18f),'FI':_0x2d1fe6(0x177),'FR':_0x2d1fe6(0x159),'GB':_0x2d1fe6(0x165),'GE':_0x2d1fe6(0x179),'GR':_0x2d1fe6(0x1cb),'HR':_0x2d1fe6(0x130),'HU':_0x2d1fe6(0x156),'IE':_0x2d1fe6(0x15e),'IS':_0x2d1fe6(0x173),'IT':_0x2d1fe6(0x17a),'LI':_0x2d1fe6(0x183),'LT':_0x2d1fe6(0x1c8),'LU':_0x2d1fe6(0x15f),'LV':_0x2d1fe6(0x152),'MC':_0x2d1fe6(0x154),'MD':_0x2d1fe6(0x1a8),'ME':_0x2d1fe6(0x148),'MK':_0x2d1fe6(0x15d),'MT':'MLT','NL':'NLD','NO':_0x2d1fe6(0x197),'PL':_0x2d1fe6(0x1b1),'PT':_0x2d1fe6(0x1b3),'RO':_0x2d1fe6(0x18e),'RS':_0x2d1fe6(0x161),'RU':_0x2d1fe6(0x14e),'SE':'SWE','SI':_0x2d1fe6(0x12b),'SK':_0x2d1fe6(0x1be),'SM':'SMR','UA':'UKR','VA':_0x2d1fe6(0x17f),'XK':_0x2d1fe6(0x1a7),'AM':'ARM','AZ':'AZE','KZ':_0x2d1fe6(0x1b6),'KG':_0x2d1fe6(0x1ae),'TJ':_0x2d1fe6(0x1af),'TM':_0x2d1fe6(0x174),'UZ':_0x2d1fe6(0x129),'US':_0x2d1fe6(0x134),'CA':_0x2d1fe6(0x16e),'AU':_0x2d1fe6(0x151),'JP':_0x2d1fe6(0x140),'CN':_0x2d1fe6(0x1aa),'IN':_0x2d1fe6(0x170),'BR':_0x2d1fe6(0x12a),'MX':_0x2d1fe6(0x1c5),'AR':'ARG','CL':_0x2d1fe6(0x14c),'PE':_0x2d1fe6(0x139),'CO':_0x2d1fe6(0x13e),'VE':_0x2d1fe6(0x135),'EC':_0x2d1fe6(0x16b),'BO':'BOL','PY':_0x2d1fe6(0x144),'UY':_0x2d1fe6(0x1b0),'SR':_0x2d1fe6(0x12d),'GY':_0x2d1fe6(0x132),'FK':_0x2d1fe6(0x1bd),'ZA':'ZAF','EG':_0x2d1fe6(0x136),'NG':'NGA','KE':_0x2d1fe6(0x1b8),'GH':_0x2d1fe6(0x147),'TZ':_0x2d1fe6(0x187),'UG':_0x2d1fe6(0x1c7),'ZW':'ZWE','ZM':_0x2d1fe6(0x124),'MW':_0x2d1fe6(0x1c1),'MZ':_0x2d1fe6(0x146),'MG':_0x2d1fe6(0x19c),'MU':_0x2d1fe6(0x1c4),'SC':_0x2d1fe6(0x160),'RE':_0x2d1fe6(0x157),'TR':_0x2d1fe6(0x17c),'IR':_0x2d1fe6(0x1a3),'IQ':_0x2d1fe6(0x138),'SA':'SAU','AE':_0x2d1fe6(0x1ad),'KW':_0x2d1fe6(0x150),'QA':_0x2d1fe6(0x18d),'BH':_0x2d1fe6(0x15a),'OM':'OMN','YE':_0x2d1fe6(0x16d),'JO':_0x2d1fe6(0x13d),'LB':'LBN','SY':_0x2d1fe6(0x1ba),'IL':_0x2d1fe6(0x195),'PS':_0x2d1fe6(0x185),'KR':_0x2d1fe6(0x172),'KP':_0x2d1fe6(0x1c6),'TH':_0x2d1fe6(0x131),'VN':'VNM','MY':_0x2d1fe6(0x1a6),'SG':_0x2d1fe6(0x1c0),'ID':_0x2d1fe6(0x155),'PH':_0x2d1fe6(0x14b),'LA':_0x2d1fe6(0x15c),'KH':_0x2d1fe6(0x142),'MM':'MMR','BD':_0x2d1fe6(0x13c),'LK':_0x2d1fe6(0x18a),'NP':_0x2d1fe6(0x1ce),'BT':_0x2d1fe6(0x1ca),'MV':_0x2d1fe6(0x19d),'AF':_0x2d1fe6(0x163),'PK':_0x2d1fe6(0x1c9),'MN':_0x2d1fe6(0x175)},_0x233f90=_0x427661[_0x2ff2a6['toUpperCase']()];if(!_0x233f90)return console[_0x2d1fe6(0x17b)](_0x2d1fe6(0x15b)+_0x2ff2a6+_0x2d1fe6(0x17d)),_0x2d1fe6(0x14e);return _0x233f90;}async['createPaymentLink'](_0x2a9074){const _0x594d15=a44_0x52b753;try{const {orderId:_0xe37b71,amount:_0x2d1242,currency:_0x18e556,firstName:_0x4afad0,lastName:_0x426e95,email:_0x5925f3,customerIp:_0x533039,customerCountry:_0x136ace,successUrl:_0x26af06,failureUrl:_0x4dbbbb}=_0x2a9074;console[_0x594d15(0x14d)](_0x594d15(0x180)),console[_0x594d15(0x14d)](_0x594d15(0x1c2),_0xe37b71),console[_0x594d15(0x14d)]('Amount:',_0x2d1242,_0x18e556),console[_0x594d15(0x14d)](_0x594d15(0x13a),_0x4afad0+'\x20'+_0x426e95),console[_0x594d15(0x14d)](_0x594d15(0x158),_0x5925f3),console['log'](_0x594d15(0x1a0),_0x533039),console[_0x594d15(0x14d)](_0x594d15(0x196),_0x136ace);const _0x44e62c=this['convert2LetterTo3LetterCountryCode'](_0x136ace);console[_0x594d15(0x14d)](_0x594d15(0x166),_0x44e62c);const _0x53cc7b={'sub_method':'GAM','currency':_0x18e556[_0x594d15(0x1a1)](),'amount':_0x2d1242,'callback_url':'https://traffer.uk/gateway/ampay/webhook.php','client_merchant_id':this[_0x594d15(0x176)],'client_transaction_id':_0xe37b71,'transaction_description':_0xe37b71,'customer':{'ip':_0x533039,'email':_0x5925f3,'full_name':_0x4afad0+'\x20'+_0x426e95,'country':_0x44e62c},'success_redirect_url':_0x26af06,'error_redirect_url':_0x4dbbbb};console[_0x594d15(0x14d)](_0x594d15(0x178),JSON['stringify'](_0x53cc7b,null,0x2));const _0x9d2756=await fetch(this['apiUrl']+_0x594d15(0x194),{'method':'POST','headers':{'Content-Type':'application/json','User-Agent':_0x594d15(0x13b)},'body':JSON['stringify'](_0x53cc7b)}),_0x1256f8=await _0x9d2756[_0x594d15(0x13f)]();console['log'](_0x594d15(0x126),_0x1256f8);if(!_0x9d2756['ok'])throw new Error('AmPay\x20API\x20error:\x20HTTP\x20'+_0x9d2756['status']+_0x594d15(0x168)+_0x1256f8);let _0x2b448f;try{_0x2b448f=JSON['parse'](_0x1256f8);}catch(_0x484ad4){throw new Error(_0x594d15(0x16c)+_0x1256f8);}console[_0x594d15(0x14d)](_0x594d15(0x16a),JSON[_0x594d15(0x1bc)](_0x2b448f,null,0x2));if(!_0x2b448f['redirect_url'])throw new Error(_0x594d15(0x137)+(_0x2b448f[_0x594d15(0x1bb)]||_0x2b448f[_0x594d15(0x149)]||'Unknown\x20error'));const _0x2e109f=_0x2b448f[_0x594d15(0x121)],_0x2357d7=_0x2b448f['system_id'],_0x45c9a5=_0x2b448f['tracker_id'];return console[_0x594d15(0x14d)]('✅\x20AmPay\x20payment\x20link\x20created\x20successfully'),console[_0x594d15(0x14d)](_0x594d15(0x171),_0x2e109f),console[_0x594d15(0x14d)](_0x594d15(0x199),_0x2357d7),console[_0x594d15(0x14d)](_0x594d15(0x12c),_0x45c9a5),console[_0x594d15(0x14d)]('Status:',_0x2b448f[_0x594d15(0x182)]),console[_0x594d15(0x14d)](_0x594d15(0x1cc)),{'gateway_payment_id':_0x2357d7||_0x45c9a5||_0xe37b71,'payment_url':_0x2e109f||'','transaction_id':_0x2357d7};}catch(_0x594667){console[_0x594d15(0x141)]('❌\x20AmPay\x20payment\x20creation\x20failed:',_0x594667),console[_0x594d15(0x14d)]('📝\x20Logging\x20AmPay\x20payment\x20creation\x20failure...');throw _0x594667;}}async['healthCheck'](){const _0xea7962=a44_0x52b753;try{const _0x199486=await fetch(this[_0xea7962(0x133)]+_0xea7962(0x184),{'method':_0xea7962(0x122),'headers':{'Content-Type':_0xea7962(0x18b),'User-Agent':_0xea7962(0x13b)}});return _0x199486&&_0x199486[_0xea7962(0x182)]===0xc8?!![]:![];}catch(_0x5c0ba8){return console['error'](_0xea7962(0x1b7),_0x5c0ba8),![];}}async[a44_0x52b753(0x143)](_0x129389){const _0xeec5fb=a44_0x52b753;console['log'](_0xeec5fb(0x167)),console[_0xeec5fb(0x14d)](_0xeec5fb(0x1b9)),console[_0xeec5fb(0x14d)](_0xeec5fb(0x19a),_0x129389),console['log'](_0xeec5fb(0x181),typeof _0x129389),console[_0xeec5fb(0x14d)]('Available\x20fields:');_0x129389&&typeof _0x129389===_0xeec5fb(0x127)&&Object['keys'](_0x129389)['forEach'](_0x261a85=>{const _0x2dad73=_0xeec5fb;console[_0x2dad73(0x14d)]('\x20\x20'+_0x261a85+':\x20'+_0x129389[_0x261a85]+'\x20('+typeof _0x129389[_0x261a85]+')');});let _0x3d6bf5=_0xeec5fb(0x153);const _0xaf207e=_0x129389[_0xeec5fb(0x123)]||_0x129389[_0xeec5fb(0x193)]||_0x129389[_0xeec5fb(0x128)]||'';return console[_0xeec5fb(0x14d)]('Extracted\x20payment\x20ID:\x20'+_0xaf207e),console[_0xeec5fb(0x14d)](_0xeec5fb(0x1cd)+_0x3d6bf5),!_0xaf207e&&(console[_0xeec5fb(0x141)](_0xeec5fb(0x19e)),console['error'](_0xeec5fb(0x162))),{'paymentId':_0xaf207e,'status':_0x3d6bf5,'amount':_0x129389[_0xeec5fb(0x1c3)],'currency':_0x129389['currency']};}}function a44_0x3960(_0x82539,_0x428d3f){const _0x813b47=a44_0x813b();return a44_0x3960=function(_0x39601d,_0x332774){_0x39601d=_0x39601d-0x121;let _0x4fc2c9=_0x813b47[_0x39601d];return _0x4fc2c9;},a44_0x3960(_0x82539,_0x428d3f);}exports['AmPayService']=AmPayService,exports['ampayService']=new AmPayService();