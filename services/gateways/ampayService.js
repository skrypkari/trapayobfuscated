'use strict';const a52_0x587c88=a52_0x80c3;function a52_0x461d(){const _0x3ffb4a=['Payment\x20URL:','6vfpchz','POL','515772jrqOJS','IRN','BGR','GUY','SMR','forEach','amount','UGA','EST','No\x20payment\x20ID\x20found\x20in\x20webhook\x20data','Checked\x20fields:\x20client_transaction_id,\x20system_id,\x20tracker_id','8083176qMNOrR','GBR','MDG','https://traffer.uk/gateway/ampay/webhook.php','__esModule','ITA','SAU','Available\x20fields:','NLD','warn','338719buSRYJ','SRB','ðŸ“¥\x20AmPay\x20raw\x20response:','ZAF','12111704xDegcU','CHE','LTU','KWT','Customer:','PER','AmPay\x20API\x20error:\x20HTTP\x20','AUT','PRK','SVK','CHL','1069460KPlsJw','ALB','status','ARG','LIE','MDV','THA','tracker_id','714228NtnfXw','XKX','âš ï¸\x20WEBHOOKS\x20TEMPORARILY\x20DISABLED\x20-\x20Always\x20returning\x20PROCESSING\x20status','\x20-\x20','MNG','API_PRIVATE_KEY','ðŸ“\x20Logging\x20AmPay\x20payment\x20creation\x20failure...','createPaymentLink','ðŸ“Š\x20AmPay\x20response\x20data:','SWE','QAT','stringify','DEU','MCO','âœ…\x20AmPay\x20payment\x20link\x20created\x20successfully','VEN','âŒ\x20AmPay\x20payment\x20creation\x20failed:','health.php','PENDING','EGY','VNM','PRY','LAO','TrapayAPI/1.0','UKR','processWebhook','PRT','CHN','CZE','AmPay\x20payment\x20creation\x20failed:\x20','7LptrzK','IND','application/json','BEL','BLR','Invalid\x20JSON\x20response\x20from\x20AmPay:\x20','Webhook\x20data\x20type:','convert2LetterTo3LetterCountryCode','Forced\x20status\x20(webhook\x20disabled):\x20','parse','58b59ccbc03dcdcfc20d830edfba765dbf9f3531c692533d84b17938e9c40bda','SGP','TKM','Customer\x20IP:','OMN','GET','USA','ðŸ‡¦ðŸ‡²\x20Creating\x20AmPay\x20payment\x20link...','ESP','API_PUBLIC_KEY','CAN','system_id','BIH','ðŸ“¤\x20AmPay\x20request\x20body:','defineProperty','redirect_url','BRA','NGA','MKD','POST','Customer\x20Country\x20(2-letter):','MLT','MUS','âŒ\x20AmPay\x20health\x20check\x20failed:','Customer\x20Country\x20(3-letter):','ISR','MWI','log','PAK','NOR','30peEAgU','ampayService','CLIENT_MERCHANT_ID','MEX','BHR','LKA',',\x20using\x20RUS\x20as\x20fallback','Extracted\x20payment\x20ID:\x20','KHM','BGD','NPL','FIN','KEN','LBN','RUS','DNK','toUpperCase','Status:','BTN','SYR','SYC','ZWE','YEM','ISL','error_message','MDA','===\x20Processing\x20AmPay\x20webhook\x20===','GAM','1278648OZOsgd','TJK','GEO','object','IDN','ðŸ“\x20Logging\x20AmPay\x20payment\x20creation\x20event...','MMR','VAT','URY','Tracker\x20ID:','ROU','IRL','KOR','error','TUR','CYP','client_transaction_id','ECU','16JrdNPl','HRV','apiUrl','ZMB','KGZ','24OaUotw','Email:','TRAFFER','AFG','Webhook\x20data:'];a52_0x461d=function(){return _0x3ffb4a;};return a52_0x461d();}(function(_0x302c75,_0x406e49){const _0x307b65=a52_0x80c3,_0x8799b=_0x302c75();while(!![]){try{const _0x4453dc=parseInt(_0x307b65(0x178))/0x1*(-parseInt(_0x307b65(0x161))/0x2)+-parseInt(_0x307b65(0x18f))/0x3*(parseInt(_0x307b65(0x156))/0x4)+-parseInt(_0x307b65(0x187))/0x5+-parseInt(_0x307b65(0x163))/0x6+parseInt(_0x307b65(0x1ad))/0x7*(parseInt(_0x307b65(0x16e))/0x8)+-parseInt(_0x307b65(0x1f1))/0x9*(parseInt(_0x307b65(0x1d5))/0xa)+parseInt(_0x307b65(0x17c))/0xb*(parseInt(_0x307b65(0x15b))/0xc);if(_0x4453dc===_0x406e49)break;else _0x8799b['push'](_0x8799b['shift']());}catch(_0x21842f){_0x8799b['push'](_0x8799b['shift']());}}}(a52_0x461d,0x7e76a));Object[a52_0x587c88(0x1c5)](exports,a52_0x587c88(0x172),{'value':!![]}),exports[a52_0x587c88(0x1d6)]=exports['AmPayService']=void 0x0;function a52_0x80c3(_0x492070,_0x2de4af){_0x492070=_0x492070-0x146;const _0x461d7c=a52_0x461d();let _0x80c3f1=_0x461d7c[_0x492070];return _0x80c3f1;}class AmPayService{constructor(){const _0x424990=a52_0x587c88;this[_0x424990(0x1d7)]=_0x424990(0x15d),this[_0x424990(0x1c0)]=_0x424990(0x1b7),this[_0x424990(0x194)]='a5a059aa63392e571341bddc5148a5db66643722e9a6bf16a9395fb690a80288931d5a1180a85a28eb9f6516cf61dfc1bf4e37898f3a35261cd2db88888d3815',this[_0x424990(0x158)]='https://traffer.uk/gateway/ampay/',console[_0x424990(0x1d2)]('ðŸ‡¦ðŸ‡²\x20AmPay\x20service\x20initialized\x20with\x20Open\x20Banking\x20AM\x20processing');}[a52_0x587c88(0x1b4)](_0x5775fb){const _0x3f3abe=a52_0x587c88,_0xb23da2={'AD':'AND','AL':_0x3f3abe(0x188),'AT':_0x3f3abe(0x183),'BA':_0x3f3abe(0x1c3),'BE':_0x3f3abe(0x1b0),'BG':_0x3f3abe(0x165),'BY':_0x3f3abe(0x1b1),'CH':_0x3f3abe(0x17d),'CY':_0x3f3abe(0x153),'CZ':_0x3f3abe(0x1ab),'DE':_0x3f3abe(0x19b),'DK':_0x3f3abe(0x1e4),'EE':_0x3f3abe(0x16b),'ES':_0x3f3abe(0x1bf),'FI':_0x3f3abe(0x1e0),'FR':'FRA','GB':_0x3f3abe(0x16f),'GE':_0x3f3abe(0x146),'GR':'GRC','HR':_0x3f3abe(0x157),'HU':'HUN','IE':_0x3f3abe(0x14f),'IS':_0x3f3abe(0x1ec),'IT':_0x3f3abe(0x173),'LI':_0x3f3abe(0x18b),'LT':_0x3f3abe(0x17e),'LU':'LUX','LV':'LVA','MC':_0x3f3abe(0x19c),'MD':_0x3f3abe(0x1ee),'ME':'MNE','MK':_0x3f3abe(0x1c9),'MT':_0x3f3abe(0x1cc),'NL':_0x3f3abe(0x176),'NO':_0x3f3abe(0x1d4),'PL':_0x3f3abe(0x162),'PT':_0x3f3abe(0x1a9),'RO':_0x3f3abe(0x14e),'RS':_0x3f3abe(0x179),'RU':_0x3f3abe(0x1e3),'SE':_0x3f3abe(0x198),'SI':'SVN','SK':_0x3f3abe(0x185),'SM':_0x3f3abe(0x167),'UA':_0x3f3abe(0x1a7),'VA':_0x3f3abe(0x14b),'XK':_0x3f3abe(0x190),'AM':'ARM','AZ':'AZE','KZ':'KAZ','KG':_0x3f3abe(0x15a),'TJ':_0x3f3abe(0x1f2),'TM':_0x3f3abe(0x1b9),'UZ':'UZB','US':_0x3f3abe(0x1bd),'CA':_0x3f3abe(0x1c1),'AU':'AUS','JP':'JPN','CN':_0x3f3abe(0x1aa),'IN':_0x3f3abe(0x1ae),'BR':_0x3f3abe(0x1c7),'MX':_0x3f3abe(0x1d8),'AR':_0x3f3abe(0x18a),'CL':_0x3f3abe(0x186),'PE':_0x3f3abe(0x181),'CO':'COL','VE':_0x3f3abe(0x19e),'EC':_0x3f3abe(0x155),'BO':'BOL','PY':_0x3f3abe(0x1a4),'UY':_0x3f3abe(0x14c),'SR':'SUR','GY':_0x3f3abe(0x166),'FK':'FLK','ZA':_0x3f3abe(0x17b),'EG':_0x3f3abe(0x1a2),'NG':_0x3f3abe(0x1c8),'KE':_0x3f3abe(0x1e1),'GH':'GHA','TZ':'TZA','UG':_0x3f3abe(0x16a),'ZW':_0x3f3abe(0x1ea),'ZM':_0x3f3abe(0x159),'MW':_0x3f3abe(0x1d1),'MZ':'MOZ','MG':_0x3f3abe(0x170),'MU':_0x3f3abe(0x1cd),'SC':_0x3f3abe(0x1e9),'RE':'REU','TR':_0x3f3abe(0x152),'IR':_0x3f3abe(0x164),'IQ':'IRQ','SA':_0x3f3abe(0x174),'AE':'ARE','KW':_0x3f3abe(0x17f),'QA':_0x3f3abe(0x199),'BH':_0x3f3abe(0x1d9),'OM':_0x3f3abe(0x1bb),'YE':_0x3f3abe(0x1eb),'JO':'JOR','LB':_0x3f3abe(0x1e2),'SY':_0x3f3abe(0x1e8),'IL':_0x3f3abe(0x1d0),'PS':'PSE','KR':_0x3f3abe(0x150),'KP':_0x3f3abe(0x184),'TH':_0x3f3abe(0x18d),'VN':_0x3f3abe(0x1a3),'MY':'MYS','SG':_0x3f3abe(0x1b8),'ID':_0x3f3abe(0x148),'PH':'PHL','LA':_0x3f3abe(0x1a5),'KH':_0x3f3abe(0x1dd),'MM':_0x3f3abe(0x14a),'BD':_0x3f3abe(0x1de),'LK':_0x3f3abe(0x1da),'NP':_0x3f3abe(0x1df),'BT':_0x3f3abe(0x1e7),'MV':_0x3f3abe(0x18c),'AF':_0x3f3abe(0x15e),'PK':_0x3f3abe(0x1d3),'MN':_0x3f3abe(0x193)},_0x76eb7a=_0xb23da2[_0x5775fb[_0x3f3abe(0x1e5)]()];if(!_0x76eb7a)return console[_0x3f3abe(0x177)]('âš ï¸\x20Unknown\x20country\x20code:\x20'+_0x5775fb+_0x3f3abe(0x1db)),_0x3f3abe(0x1e3);return _0x76eb7a;}async[a52_0x587c88(0x196)](_0x13ac9b){const _0x544cb3=a52_0x587c88;try{const {orderId:_0x16c52c,amount:_0x1b59a5,currency:_0x25952d,firstName:_0x28ea2f,lastName:_0x4c2b63,email:_0x3288a3,customerIp:_0x216339,customerCountry:_0x3d767f,successUrl:_0x1a6620,failureUrl:_0x360c9a}=_0x13ac9b;console[_0x544cb3(0x1d2)](_0x544cb3(0x1be)),console['log']('Order\x20ID:',_0x16c52c),console[_0x544cb3(0x1d2)]('Amount:',_0x1b59a5,_0x25952d),console[_0x544cb3(0x1d2)](_0x544cb3(0x180),_0x28ea2f+'\x20'+_0x4c2b63),console[_0x544cb3(0x1d2)](_0x544cb3(0x15c),_0x3288a3),console[_0x544cb3(0x1d2)](_0x544cb3(0x1ba),_0x216339),console[_0x544cb3(0x1d2)](_0x544cb3(0x1cb),_0x3d767f);const _0x5aa90e=this['convert2LetterTo3LetterCountryCode'](_0x3d767f);console[_0x544cb3(0x1d2)](_0x544cb3(0x1cf),_0x5aa90e);const _0x27db1d={'sub_method':_0x544cb3(0x1f0),'currency':_0x25952d[_0x544cb3(0x1e5)](),'amount':_0x1b59a5,'callback_url':_0x544cb3(0x171),'client_merchant_id':this[_0x544cb3(0x1d7)],'client_transaction_id':_0x16c52c,'transaction_description':_0x16c52c,'customer':{'ip':_0x216339,'email':_0x3288a3,'full_name':_0x28ea2f+'\x20'+_0x4c2b63,'country':_0x5aa90e},'success_redirect_url':_0x1a6620,'error_redirect_url':_0x360c9a};console[_0x544cb3(0x1d2)](_0x544cb3(0x1c4),JSON[_0x544cb3(0x19a)](_0x27db1d,null,0x2));const _0x1b4130=await fetch(this['apiUrl']+'ampay.php',{'method':_0x544cb3(0x1ca),'headers':{'Content-Type':'application/json','User-Agent':_0x544cb3(0x1a6)},'body':JSON['stringify'](_0x27db1d)}),_0x504708=await _0x1b4130['text']();console[_0x544cb3(0x1d2)](_0x544cb3(0x17a),_0x504708);if(!_0x1b4130['ok'])throw new Error(_0x544cb3(0x182)+_0x1b4130[_0x544cb3(0x189)]+_0x544cb3(0x192)+_0x504708);let _0x75c551;try{_0x75c551=JSON[_0x544cb3(0x1b6)](_0x504708);}catch(_0x446c13){throw new Error(_0x544cb3(0x1b2)+_0x504708);}console[_0x544cb3(0x1d2)](_0x544cb3(0x197),JSON[_0x544cb3(0x19a)](_0x75c551,null,0x2));if(!_0x75c551[_0x544cb3(0x1c6)])throw new Error(_0x544cb3(0x1ac)+(_0x75c551[_0x544cb3(0x1ed)]||_0x75c551['message']||'Unknown\x20error'));const _0x170901=_0x75c551[_0x544cb3(0x1c6)],_0x32b388=_0x75c551[_0x544cb3(0x1c2)],_0x1f4a82=_0x75c551[_0x544cb3(0x18e)];return console[_0x544cb3(0x1d2)](_0x544cb3(0x19d)),console['log'](_0x544cb3(0x160),_0x170901),console[_0x544cb3(0x1d2)]('System\x20ID:',_0x32b388),console[_0x544cb3(0x1d2)](_0x544cb3(0x14d),_0x1f4a82),console['log'](_0x544cb3(0x1e6),_0x75c551[_0x544cb3(0x189)]),console[_0x544cb3(0x1d2)](_0x544cb3(0x149)),{'gateway_payment_id':_0x32b388||_0x1f4a82||_0x16c52c,'payment_url':_0x170901||'','transaction_id':_0x32b388};}catch(_0x33c890){console['error'](_0x544cb3(0x19f),_0x33c890),console[_0x544cb3(0x1d2)](_0x544cb3(0x195));throw _0x33c890;}}async['healthCheck'](){const _0xd56e61=a52_0x587c88;try{const _0x4c76a2=await fetch(this[_0xd56e61(0x158)]+_0xd56e61(0x1a0),{'method':_0xd56e61(0x1bc),'headers':{'Content-Type':_0xd56e61(0x1af),'User-Agent':'TrapayAPI/1.0'}});return _0x4c76a2&&_0x4c76a2[_0xd56e61(0x189)]===0xc8?!![]:![];}catch(_0xcb344c){return console[_0xd56e61(0x151)](_0xd56e61(0x1ce),_0xcb344c),![];}}async[a52_0x587c88(0x1a8)](_0x289df6){const _0x3ccf9c=a52_0x587c88;console[_0x3ccf9c(0x1d2)](_0x3ccf9c(0x1ef)),console['log'](_0x3ccf9c(0x191)),console[_0x3ccf9c(0x1d2)](_0x3ccf9c(0x15f),_0x289df6),console[_0x3ccf9c(0x1d2)](_0x3ccf9c(0x1b3),typeof _0x289df6),console[_0x3ccf9c(0x1d2)](_0x3ccf9c(0x175));_0x289df6&&typeof _0x289df6===_0x3ccf9c(0x147)&&Object['keys'](_0x289df6)[_0x3ccf9c(0x168)](_0x39238c=>{console['log']('\x20\x20'+_0x39238c+':\x20'+_0x289df6[_0x39238c]+'\x20('+typeof _0x289df6[_0x39238c]+')');});let _0x285864=_0x3ccf9c(0x1a1);const _0x7a49d2=_0x289df6[_0x3ccf9c(0x154)]||_0x289df6[_0x3ccf9c(0x1c2)]||_0x289df6[_0x3ccf9c(0x18e)]||'';return console[_0x3ccf9c(0x1d2)](_0x3ccf9c(0x1dc)+_0x7a49d2),console[_0x3ccf9c(0x1d2)](_0x3ccf9c(0x1b5)+_0x285864),!_0x7a49d2&&(console[_0x3ccf9c(0x151)](_0x3ccf9c(0x16c)),console[_0x3ccf9c(0x151)](_0x3ccf9c(0x16d))),{'paymentId':_0x7a49d2,'status':_0x285864,'amount':_0x289df6[_0x3ccf9c(0x169)],'currency':_0x289df6['currency']};}}exports['AmPayService']=AmPayService,exports[a52_0x587c88(0x1d6)]=new AmPayService();