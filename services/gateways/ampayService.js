'use strict';const a44_0xb44847=a44_0x4eff;function a44_0x1013(){const _0x4a25fd=['PENDING','GHA','YEM','IRQ','12523430EpTztM','warn','DEU','OMN','MMR','VAT','IRN','KHM','status','SAU','Payment\x20URL:','JOR','POL','CZE','GRC','AmPayService','GUY','keys','HRV','ARE','ROU','MLT','client_transaction_id','BGR','health.php','BRA','UZB','NLD','processWebhook','RUS','AFG','ISL','stringify','CHN','Checked\x20fields:\x20client_transaction_id,\x20system_id,\x20tracker_id','amount','Customer\x20Country\x20(2-letter):','toUpperCase','ALB','📊\x20AmPay\x20response\x20data:','KEN','SVK','POST','MNG','Customer:','Amount:','CYP','Webhook\x20data:','SVN','PRT','SYR','7eVlPsj','MWI','Order\x20ID:','message','SWE','BHR','SUR','IND','🇦🇲\x20AmPay\x20service\x20initialized\x20with\x20Open\x20Banking\x20AM\x20processing','📝\x20Logging\x20AmPay\x20payment\x20creation\x20failure...','===\x20Processing\x20AmPay\x20webhook\x20===','error','log','33grwkVV','58b59ccbc03dcdcfc20d830edfba765dbf9f3531c692533d84b17938e9c40bda','FRA','THA','REU','IDN','LKA','forEach','AmPay\x20API\x20error:\x20HTTP\x20','Forced\x20status\x20(webhook\x20disabled):\x20','12014541aRaAYN','KGZ','API_PUBLIC_KEY','parse','MCO','ARG','LBN','PAK','createPaymentLink','ARM','AND','SRB','application/json','object','currency','AZE','🇦🇲\x20Creating\x20AmPay\x20payment\x20link...','convert2LetterTo3LetterCountryCode','AmPay\x20payment\x20creation\x20failed:\x20','CLIENT_MERCHANT_ID','KWT','TrapayAPI/1.0','TJK','TZA','PSE','Customer\x20Country\x20(3-letter):','LUX','tracker_id','859699jNmINM','Customer\x20IP:','EGY','MDA','Webhook\x20data\x20type:','NGA','1434207zydpQN','4057914GFGWxW','ZWE','ZAF','LVA','URY','KOR','GET','redirect_url','https://traffer.uk/gateway/ampay/','EST','IRL','Email:','6682680CtjMHQ','https://traffer.uk/gateway/ampay/webhook.php','MOZ','DNK','MDG','BLR','system_id','HUN','apiUrl','ampay.php','FIN','SGP','GAM','✅\x20AmPay\x20payment\x20link\x20created\x20successfully','SYC','4WAEpTS','Extracted\x20payment\x20ID:\x20','GBR','text','CHL','Unknown\x20error','MDV','ZMB','❌\x20AmPay\x20health\x20check\x20failed:','CAN','UKR','Invalid\x20JSON\x20response\x20from\x20AmPay:\x20','Status:','USA','System\x20ID:','QAT','6443725iTksFy','2MeNdii'];a44_0x1013=function(){return _0x4a25fd;};return a44_0x1013();}(function(_0x25444f,_0x3b57f4){const _0x4afab8=a44_0x4eff,_0x21d2bd=_0x25444f();while(!![]){try{const _0x232093=parseInt(_0x4afab8(0x27c))/0x1+-parseInt(_0x4afab8(0x211))/0x2*(parseInt(_0x4afab8(0x282))/0x3)+parseInt(_0x4afab8(0x200))/0x4*(parseInt(_0x4afab8(0x210))/0x5)+parseInt(_0x4afab8(0x283))/0x6*(parseInt(_0x4afab8(0x249))/0x7)+parseInt(_0x4afab8(0x1f1))/0x8+parseInt(_0x4afab8(0x260))/0x9+-parseInt(_0x4afab8(0x216))/0xa*(parseInt(_0x4afab8(0x256))/0xb);if(_0x232093===_0x3b57f4)break;else _0x21d2bd['push'](_0x21d2bd['shift']());}catch(_0x441376){_0x21d2bd['push'](_0x21d2bd['shift']());}}}(a44_0x1013,0xb988d));function a44_0x4eff(_0x56b242,_0x38680f){const _0x1013c1=a44_0x1013();return a44_0x4eff=function(_0x4eff61,_0x2016fe){_0x4eff61=_0x4eff61-0x1ed;let _0x58f77f=_0x1013c1[_0x4eff61];return _0x58f77f;},a44_0x4eff(_0x56b242,_0x38680f);}Object['defineProperty'](exports,'__esModule',{'value':!![]}),exports['ampayService']=exports[a44_0xb44847(0x225)]=void 0x0;class AmPayService{constructor(){const _0x5e7d6b=a44_0xb44847;this[_0x5e7d6b(0x273)]='TRAFFER',this[_0x5e7d6b(0x262)]=_0x5e7d6b(0x257),this['API_PRIVATE_KEY']='a5a059aa63392e571341bddc5148a5db66643722e9a6bf16a9395fb690a80288931d5a1180a85a28eb9f6516cf61dfc1bf4e37898f3a35261cd2db88888d3815',this[_0x5e7d6b(0x1f9)]=_0x5e7d6b(0x1ed),console[_0x5e7d6b(0x255)](_0x5e7d6b(0x251));}[a44_0xb44847(0x271)](_0x3be563){const _0x6e36b1=a44_0xb44847,_0x827284={'AD':_0x6e36b1(0x26a),'AL':_0x6e36b1(0x23c),'AT':'AUT','BA':'BIH','BE':'BEL','BG':_0x6e36b1(0x22d),'BY':_0x6e36b1(0x1f6),'CH':'CHE','CY':_0x6e36b1(0x244),'CZ':_0x6e36b1(0x223),'DE':_0x6e36b1(0x218),'DK':_0x6e36b1(0x1f4),'EE':_0x6e36b1(0x1ee),'ES':'ESP','FI':_0x6e36b1(0x1fb),'FR':_0x6e36b1(0x258),'GB':_0x6e36b1(0x202),'GE':'GEO','GR':_0x6e36b1(0x224),'HR':_0x6e36b1(0x228),'HU':_0x6e36b1(0x1f8),'IE':_0x6e36b1(0x1ef),'IS':_0x6e36b1(0x235),'IT':'ITA','LI':'LIE','LT':'LTU','LU':_0x6e36b1(0x27a),'LV':_0x6e36b1(0x286),'MC':_0x6e36b1(0x264),'MD':_0x6e36b1(0x27f),'ME':'MNE','MK':'MKD','MT':_0x6e36b1(0x22b),'NL':_0x6e36b1(0x231),'NO':'NOR','PL':_0x6e36b1(0x222),'PT':_0x6e36b1(0x247),'RO':_0x6e36b1(0x22a),'RS':_0x6e36b1(0x26b),'RU':'RUS','SE':_0x6e36b1(0x24d),'SI':_0x6e36b1(0x246),'SK':_0x6e36b1(0x23f),'SM':'SMR','UA':_0x6e36b1(0x20a),'VA':_0x6e36b1(0x21b),'XK':'XKX','AM':_0x6e36b1(0x269),'AZ':_0x6e36b1(0x26f),'KZ':'KAZ','KG':_0x6e36b1(0x261),'TJ':_0x6e36b1(0x276),'TM':'TKM','UZ':_0x6e36b1(0x230),'US':_0x6e36b1(0x20d),'CA':_0x6e36b1(0x209),'AU':'AUS','JP':'JPN','CN':_0x6e36b1(0x237),'IN':_0x6e36b1(0x250),'BR':_0x6e36b1(0x22f),'MX':'MEX','AR':_0x6e36b1(0x265),'CL':_0x6e36b1(0x204),'PE':'PER','CO':'COL','VE':'VEN','EC':'ECU','BO':'BOL','PY':'PRY','UY':_0x6e36b1(0x287),'SR':_0x6e36b1(0x24f),'GY':_0x6e36b1(0x226),'FK':'FLK','ZA':_0x6e36b1(0x285),'EG':_0x6e36b1(0x27e),'NG':_0x6e36b1(0x281),'KE':_0x6e36b1(0x23e),'GH':_0x6e36b1(0x213),'TZ':_0x6e36b1(0x277),'UG':'UGA','ZW':_0x6e36b1(0x284),'ZM':_0x6e36b1(0x207),'MW':_0x6e36b1(0x24a),'MZ':_0x6e36b1(0x1f3),'MG':_0x6e36b1(0x1f5),'MU':'MUS','SC':_0x6e36b1(0x1ff),'RE':_0x6e36b1(0x25a),'TR':'TUR','IR':_0x6e36b1(0x21c),'IQ':_0x6e36b1(0x215),'SA':_0x6e36b1(0x21f),'AE':_0x6e36b1(0x229),'KW':_0x6e36b1(0x274),'QA':_0x6e36b1(0x20f),'BH':_0x6e36b1(0x24e),'OM':_0x6e36b1(0x219),'YE':_0x6e36b1(0x214),'JO':_0x6e36b1(0x221),'LB':_0x6e36b1(0x266),'SY':_0x6e36b1(0x248),'IL':'ISR','PS':_0x6e36b1(0x278),'KR':_0x6e36b1(0x288),'KP':'PRK','TH':_0x6e36b1(0x259),'VN':'VNM','MY':'MYS','SG':_0x6e36b1(0x1fc),'ID':_0x6e36b1(0x25b),'PH':'PHL','LA':'LAO','KH':_0x6e36b1(0x21d),'MM':_0x6e36b1(0x21a),'BD':'BGD','LK':_0x6e36b1(0x25c),'NP':'NPL','BT':'BTN','MV':_0x6e36b1(0x206),'AF':_0x6e36b1(0x234),'PK':_0x6e36b1(0x267),'MN':_0x6e36b1(0x241)},_0x437b08=_0x827284[_0x3be563[_0x6e36b1(0x23b)]()];if(!_0x437b08)return console[_0x6e36b1(0x217)]('⚠️\x20Unknown\x20country\x20code:\x20'+_0x3be563+',\x20using\x20RUS\x20as\x20fallback'),_0x6e36b1(0x233);return _0x437b08;}async[a44_0xb44847(0x268)](_0x1da863){const _0x236a23=a44_0xb44847;try{const {orderId:_0x5480ca,amount:_0x12648a,currency:_0x49a4cf,firstName:_0xe5da8e,lastName:_0x27666c,email:_0x4a607e,customerIp:_0x575de9,customerCountry:_0x26e379,successUrl:_0x12bdda,failureUrl:_0x4bf4e2}=_0x1da863;console['log'](_0x236a23(0x270)),console[_0x236a23(0x255)](_0x236a23(0x24b),_0x5480ca),console['log'](_0x236a23(0x243),_0x12648a,_0x49a4cf),console[_0x236a23(0x255)](_0x236a23(0x242),_0xe5da8e+'\x20'+_0x27666c),console['log'](_0x236a23(0x1f0),_0x4a607e),console[_0x236a23(0x255)](_0x236a23(0x27d),_0x575de9),console[_0x236a23(0x255)](_0x236a23(0x23a),_0x26e379);const _0x3cfc48=this['convert2LetterTo3LetterCountryCode'](_0x26e379);console[_0x236a23(0x255)](_0x236a23(0x279),_0x3cfc48);const _0xaafec1={'sub_method':_0x236a23(0x1fd),'currency':_0x49a4cf['toUpperCase'](),'amount':_0x12648a,'callback_url':_0x236a23(0x1f2),'client_merchant_id':this[_0x236a23(0x273)],'client_transaction_id':_0x5480ca,'transaction_description':_0x5480ca,'customer':{'ip':_0x575de9,'email':_0x4a607e,'full_name':_0xe5da8e+'\x20'+_0x27666c,'country':_0x3cfc48},'success_redirect_url':_0x12bdda,'error_redirect_url':_0x4bf4e2};console['log']('📤\x20AmPay\x20request\x20body:',JSON[_0x236a23(0x236)](_0xaafec1,null,0x2));const _0x3da38e=await fetch(this[_0x236a23(0x1f9)]+_0x236a23(0x1fa),{'method':_0x236a23(0x240),'headers':{'Content-Type':_0x236a23(0x26c),'User-Agent':_0x236a23(0x275)},'body':JSON[_0x236a23(0x236)](_0xaafec1)}),_0x5d5df3=await _0x3da38e[_0x236a23(0x203)]();console[_0x236a23(0x255)]('📥\x20AmPay\x20raw\x20response:',_0x5d5df3);if(!_0x3da38e['ok'])throw new Error(_0x236a23(0x25e)+_0x3da38e[_0x236a23(0x21e)]+'\x20-\x20'+_0x5d5df3);let _0x500381;try{_0x500381=JSON[_0x236a23(0x263)](_0x5d5df3);}catch(_0x394f87){throw new Error(_0x236a23(0x20b)+_0x5d5df3);}console['log'](_0x236a23(0x23d),JSON[_0x236a23(0x236)](_0x500381,null,0x2));if(!_0x500381['redirect_url'])throw new Error(_0x236a23(0x272)+(_0x500381['error_message']||_0x500381[_0x236a23(0x24c)]||_0x236a23(0x205)));const _0x2c3cda=_0x500381[_0x236a23(0x28a)],_0x417f8e=_0x500381[_0x236a23(0x1f7)],_0x286d10=_0x500381[_0x236a23(0x27b)];return console['log'](_0x236a23(0x1fe)),console[_0x236a23(0x255)](_0x236a23(0x220),_0x2c3cda),console['log'](_0x236a23(0x20e),_0x417f8e),console[_0x236a23(0x255)]('Tracker\x20ID:',_0x286d10),console[_0x236a23(0x255)](_0x236a23(0x20c),_0x500381[_0x236a23(0x21e)]),console[_0x236a23(0x255)]('📝\x20Logging\x20AmPay\x20payment\x20creation\x20event...'),{'gateway_payment_id':_0x417f8e||_0x286d10||_0x5480ca,'payment_url':_0x2c3cda||'','transaction_id':_0x417f8e};}catch(_0x80b1ff){console['error']('❌\x20AmPay\x20payment\x20creation\x20failed:',_0x80b1ff),console['log'](_0x236a23(0x252));throw _0x80b1ff;}}async['healthCheck'](){const _0x11aa39=a44_0xb44847;try{const _0x26ab96=await fetch(this['apiUrl']+_0x11aa39(0x22e),{'method':_0x11aa39(0x289),'headers':{'Content-Type':_0x11aa39(0x26c),'User-Agent':_0x11aa39(0x275)}});return _0x26ab96&&_0x26ab96['status']===0xc8?!![]:![];}catch(_0x16e9e5){return console[_0x11aa39(0x254)](_0x11aa39(0x208),_0x16e9e5),![];}}async[a44_0xb44847(0x232)](_0x119a8c){const _0x3e8506=a44_0xb44847;console[_0x3e8506(0x255)](_0x3e8506(0x253)),console[_0x3e8506(0x255)]('⚠️\x20WEBHOOKS\x20TEMPORARILY\x20DISABLED\x20-\x20Always\x20returning\x20PROCESSING\x20status'),console['log'](_0x3e8506(0x245),_0x119a8c),console[_0x3e8506(0x255)](_0x3e8506(0x280),typeof _0x119a8c),console[_0x3e8506(0x255)]('Available\x20fields:');_0x119a8c&&typeof _0x119a8c===_0x3e8506(0x26d)&&Object[_0x3e8506(0x227)](_0x119a8c)[_0x3e8506(0x25d)](_0x17b522=>{const _0x5635b3=_0x3e8506;console[_0x5635b3(0x255)]('\x20\x20'+_0x17b522+':\x20'+_0x119a8c[_0x17b522]+'\x20('+typeof _0x119a8c[_0x17b522]+')');});let _0x486b96=_0x3e8506(0x212);const _0x30a59e=_0x119a8c[_0x3e8506(0x22c)]||_0x119a8c[_0x3e8506(0x1f7)]||_0x119a8c[_0x3e8506(0x27b)]||'';return console['log'](_0x3e8506(0x201)+_0x30a59e),console['log'](_0x3e8506(0x25f)+_0x486b96),!_0x30a59e&&(console[_0x3e8506(0x254)]('No\x20payment\x20ID\x20found\x20in\x20webhook\x20data'),console['error'](_0x3e8506(0x238))),{'paymentId':_0x30a59e,'status':_0x486b96,'amount':_0x119a8c[_0x3e8506(0x239)],'currency':_0x119a8c[_0x3e8506(0x26e)]};}}exports[a44_0xb44847(0x225)]=AmPayService,exports['ampayService']=new AmPayService();