'use strict';const a52_0x5a7a58=a52_0x500e;(function(_0x711a0c,_0x1f85ea){const _0xd98847=a52_0x500e,_0x217dc3=_0x711a0c();while(!![]){try{const _0x42d9d9=parseInt(_0xd98847(0x11f))/0x1*(parseInt(_0xd98847(0xf3))/0x2)+-parseInt(_0xd98847(0x14a))/0x3+parseInt(_0xd98847(0xdb))/0x4*(-parseInt(_0xd98847(0x157))/0x5)+parseInt(_0xd98847(0x171))/0x6+parseInt(_0xd98847(0x174))/0x7+-parseInt(_0xd98847(0xe4))/0x8*(-parseInt(_0xd98847(0x160))/0x9)+-parseInt(_0xd98847(0xcc))/0xa;if(_0x42d9d9===_0x1f85ea)break;else _0x217dc3['push'](_0x217dc3['shift']());}catch(_0x5a1297){_0x217dc3['push'](_0x217dc3['shift']());}}}(a52_0x3469,0x23331));function a52_0x3469(){const _0x4600cc=['ðŸ“¥\x20AmPay\x20raw\x20response:','AFG','Customer:','âš ï¸\x20WEBHOOKS\x20TEMPORARILY\x20DISABLED\x20-\x20Always\x20returning\x20PROCESSING\x20status','UZB','GAM','parse','SUR','Customer\x20Country\x20(2-letter):','IND','YEM','BGD','text','ARM','AmPayService','218337RYTymr','ISR','IRN','CZE','KAZ','a5a059aa63392e571341bddc5148a5db66643722e9a6bf16a9395fb690a80288931d5a1180a85a28eb9f6516cf61dfc1bf4e37898f3a35261cd2db88888d3815','Forced\x20status\x20(webhook\x20disabled):\x20','MUS','redirect_url','status','MLT','TJK','https://traffer.uk/gateway/ampay/','10VEpAIf','currency','error_message','ARE','Unknown\x20error','KOR','NGA','\x20-\x20','COL','72BPJTbU','AmPay\x20payment\x20creation\x20failed:\x20','===\x20Processing\x20AmPay\x20webhook\x20===','ESP','MYS','PER','MWI','CYP','MDV','âœ…\x20AmPay\x20payment\x20link\x20created\x20successfully','application/json','Customer\x20Country\x20(3-letter):','__esModule','TrapayAPI/1.0','GBR','UGA','KEN','750858OcXNLp','LIE','Extracted\x20payment\x20ID:\x20','441056nmeZfB','HUN','LVA','Email:','ðŸ“\x20Logging\x20AmPay\x20payment\x20creation\x20event...','âš ï¸\x20Unknown\x20country\x20code:\x20','3504810EHoXqm','HRV','CHL',',\x20using\x20RUS\x20as\x20fallback','GHA','GET','log','CHE','ðŸ“\x20Logging\x20AmPay\x20payment\x20creation\x20failure...','PRY','BOL','LTU','IRQ','Invalid\x20JSON\x20response\x20from\x20AmPay:\x20','SWE','217660qaeIYv','stringify','ðŸ“Š\x20AmPay\x20response\x20data:','VEN','Order\x20ID:','SYR','Amount:','NLD','SVK','285848VEQsRC','TKM','DNK','BRA','PRT','FRA','API_PRIVATE_KEY','ðŸ‡¦ðŸ‡²\x20Creating\x20AmPay\x20payment\x20link...','Status:','AND','system_id','OMN','GEO','SMR','System\x20ID:','4qfUUuu','AZE','PHL','message','GRC','USA','LUX','PENDING','ROU','MKD','API_PUBLIC_KEY','defineProperty','DEU','JOR','POST','Customer\x20IP:','GUY','KWT','MNG','SAU','VAT','BLR','object','XKX','POL','CAN','toUpperCase','URY','client_transaction_id','LBN','createPaymentLink','health.php','Webhook\x20data\x20type:','FLK','keys','processWebhook','ampay.php','MNE','error','NOR','MEX','TRAFFER','ampayService','ALB','101134kRUiOm','TZA','BHR','SRB','ZAF','KHM','amount','AmPay\x20API\x20error:\x20HTTP\x20','tracker_id','THA','ðŸ“¤\x20AmPay\x20request\x20body:','SYC','CLIENT_MERCHANT_ID','EGY','CHN','LAO','âŒ\x20AmPay\x20health\x20check\x20failed:','Webhook\x20data:','apiUrl','BIH','QAT','REU','warn','Checked\x20fields:\x20client_transaction_id,\x20system_id,\x20tracker_id','Payment\x20URL:','MMR','58b59ccbc03dcdcfc20d830edfba765dbf9f3531c692533d84b17938e9c40bda','convert2LetterTo3LetterCountryCode'];a52_0x3469=function(){return _0x4600cc;};return a52_0x3469();}Object[a52_0x5a7a58(0xfe)](exports,a52_0x5a7a58(0x16c),{'value':!![]}),exports['ampayService']=exports[a52_0x5a7a58(0x149)]=void 0x0;function a52_0x500e(_0x8715c1,_0x2ebf74){_0x8715c1=_0x8715c1-0xcc;const _0x346972=a52_0x3469();let _0x500e94=_0x346972[_0x8715c1];return _0x500e94;}class AmPayService{constructor(){const _0x268694=a52_0x5a7a58;this[_0x268694(0x12b)]=_0x268694(0x11c),this[_0x268694(0xfd)]=_0x268694(0x139),this[_0x268694(0xea)]=_0x268694(0x14f),this[_0x268694(0x131)]=_0x268694(0x156),console[_0x268694(0xd2)]('ðŸ‡¦ðŸ‡²\x20AmPay\x20service\x20initialized\x20with\x20Open\x20Banking\x20AM\x20processing');}['convert2LetterTo3LetterCountryCode'](_0x4251a0){const _0x46330f=a52_0x5a7a58,_0x171df4={'AD':_0x46330f(0xed),'AL':_0x46330f(0x11e),'AT':'AUT','BA':_0x46330f(0x132),'BE':'BEL','BG':'BGR','BY':_0x46330f(0x108),'CH':_0x46330f(0xd3),'CY':_0x46330f(0x167),'CZ':_0x46330f(0x14d),'DE':_0x46330f(0xff),'DK':_0x46330f(0xe6),'EE':'EST','ES':_0x46330f(0x163),'FI':'FIN','FR':_0x46330f(0xe9),'GB':_0x46330f(0x16e),'GE':_0x46330f(0xf0),'GR':_0x46330f(0xf7),'HR':_0x46330f(0xcd),'HU':_0x46330f(0x175),'IE':'IRL','IS':'ISL','IT':'ITA','LI':_0x46330f(0x172),'LT':_0x46330f(0xd7),'LU':_0x46330f(0xf9),'LV':_0x46330f(0x176),'MC':'MCO','MD':'MDA','ME':_0x46330f(0x118),'MK':_0x46330f(0xfc),'MT':_0x46330f(0x154),'NL':_0x46330f(0xe2),'NO':_0x46330f(0x11a),'PL':_0x46330f(0x10b),'PT':_0x46330f(0xe8),'RO':_0x46330f(0xfb),'RS':_0x46330f(0x122),'RU':'RUS','SE':_0x46330f(0xda),'SI':'SVN','SK':_0x46330f(0xe3),'SM':_0x46330f(0xf1),'UA':'UKR','VA':_0x46330f(0x107),'XK':_0x46330f(0x10a),'AM':_0x46330f(0x148),'AZ':_0x46330f(0xf4),'KZ':_0x46330f(0x14e),'KG':'KGZ','TJ':_0x46330f(0x155),'TM':_0x46330f(0xe5),'UZ':_0x46330f(0x13f),'US':_0x46330f(0xf8),'CA':_0x46330f(0x10c),'AU':'AUS','JP':'JPN','CN':_0x46330f(0x12d),'IN':_0x46330f(0x144),'BR':_0x46330f(0xe7),'MX':_0x46330f(0x11b),'AR':'ARG','CL':_0x46330f(0xce),'PE':_0x46330f(0x165),'CO':_0x46330f(0x15f),'VE':_0x46330f(0xde),'EC':'ECU','BO':_0x46330f(0xd6),'PY':_0x46330f(0xd5),'UY':_0x46330f(0x10e),'SR':_0x46330f(0x142),'GY':_0x46330f(0x103),'FK':_0x46330f(0x114),'ZA':_0x46330f(0x123),'EG':_0x46330f(0x12c),'NG':_0x46330f(0x15d),'KE':_0x46330f(0x170),'GH':_0x46330f(0xd0),'TZ':_0x46330f(0x120),'UG':_0x46330f(0x16f),'ZW':'ZWE','ZM':'ZMB','MW':_0x46330f(0x166),'MZ':'MOZ','MG':'MDG','MU':_0x46330f(0x151),'SC':_0x46330f(0x12a),'RE':_0x46330f(0x134),'TR':'TUR','IR':_0x46330f(0x14c),'IQ':_0x46330f(0xd8),'SA':_0x46330f(0x106),'AE':_0x46330f(0x15a),'KW':_0x46330f(0x104),'QA':_0x46330f(0x133),'BH':_0x46330f(0x121),'OM':_0x46330f(0xef),'YE':_0x46330f(0x145),'JO':_0x46330f(0x100),'LB':_0x46330f(0x110),'SY':_0x46330f(0xe0),'IL':_0x46330f(0x14b),'PS':'PSE','KR':_0x46330f(0x15c),'KP':'PRK','TH':_0x46330f(0x128),'VN':'VNM','MY':_0x46330f(0x164),'SG':'SGP','ID':'IDN','PH':_0x46330f(0xf5),'LA':_0x46330f(0x12e),'KH':_0x46330f(0x124),'MM':_0x46330f(0x138),'BD':_0x46330f(0x146),'LK':'LKA','NP':'NPL','BT':'BTN','MV':_0x46330f(0x168),'AF':_0x46330f(0x13c),'PK':'PAK','MN':_0x46330f(0x105)},_0x5a2e3b=_0x171df4[_0x4251a0[_0x46330f(0x10d)]()];if(!_0x5a2e3b)return console[_0x46330f(0x135)](_0x46330f(0x179)+_0x4251a0+_0x46330f(0xcf)),'RUS';return _0x5a2e3b;}async[a52_0x5a7a58(0x111)](_0x24328a){const _0x5041dc=a52_0x5a7a58;try{const {orderId:_0x14f9e7,amount:_0x288b57,currency:_0x50748e,firstName:_0x2d6e00,lastName:_0x50c846,email:_0x52a12e,customerIp:_0x16f3a6,customerCountry:_0x5b4e5e,successUrl:_0x4aa719,failureUrl:_0x325931}=_0x24328a;console[_0x5041dc(0xd2)](_0x5041dc(0xeb)),console[_0x5041dc(0xd2)](_0x5041dc(0xdf),_0x14f9e7),console['log'](_0x5041dc(0xe1),_0x288b57,_0x50748e),console['log'](_0x5041dc(0x13d),_0x2d6e00+'\x20'+_0x50c846),console[_0x5041dc(0xd2)](_0x5041dc(0x177),_0x52a12e),console[_0x5041dc(0xd2)](_0x5041dc(0x102),_0x16f3a6),console[_0x5041dc(0xd2)](_0x5041dc(0x143),_0x5b4e5e);const _0x1f455d=this[_0x5041dc(0x13a)](_0x5b4e5e);console[_0x5041dc(0xd2)](_0x5041dc(0x16b),_0x1f455d);const _0x4f03d9={'sub_method':_0x5041dc(0x140),'currency':_0x50748e[_0x5041dc(0x10d)](),'amount':_0x288b57,'callback_url':'https://traffer.uk/gateway/ampay/webhook.php','client_merchant_id':this[_0x5041dc(0x12b)],'client_transaction_id':_0x14f9e7,'transaction_description':_0x14f9e7,'customer':{'ip':_0x16f3a6,'email':_0x52a12e,'full_name':_0x2d6e00+'\x20'+_0x50c846,'country':_0x1f455d},'success_redirect_url':_0x4aa719,'error_redirect_url':_0x325931};console['log'](_0x5041dc(0x129),JSON[_0x5041dc(0xdc)](_0x4f03d9,null,0x2));const _0xfbf59e=await fetch(this[_0x5041dc(0x131)]+_0x5041dc(0x117),{'method':_0x5041dc(0x101),'headers':{'Content-Type':'application/json','User-Agent':_0x5041dc(0x16d)},'body':JSON[_0x5041dc(0xdc)](_0x4f03d9)}),_0xa1e461=await _0xfbf59e[_0x5041dc(0x147)]();console[_0x5041dc(0xd2)](_0x5041dc(0x13b),_0xa1e461);if(!_0xfbf59e['ok'])throw new Error(_0x5041dc(0x126)+_0xfbf59e['status']+_0x5041dc(0x15e)+_0xa1e461);let _0x10a610;try{_0x10a610=JSON[_0x5041dc(0x141)](_0xa1e461);}catch(_0x2b0e4b){throw new Error(_0x5041dc(0xd9)+_0xa1e461);}console['log'](_0x5041dc(0xdd),JSON[_0x5041dc(0xdc)](_0x10a610,null,0x2));if(!_0x10a610[_0x5041dc(0x152)])throw new Error(_0x5041dc(0x161)+(_0x10a610[_0x5041dc(0x159)]||_0x10a610[_0x5041dc(0xf6)]||_0x5041dc(0x15b)));const _0x4bdf6d=_0x10a610[_0x5041dc(0x152)],_0x48c564=_0x10a610[_0x5041dc(0xee)],_0x514bdc=_0x10a610[_0x5041dc(0x127)];return console[_0x5041dc(0xd2)](_0x5041dc(0x169)),console[_0x5041dc(0xd2)](_0x5041dc(0x137),_0x4bdf6d),console[_0x5041dc(0xd2)](_0x5041dc(0xf2),_0x48c564),console[_0x5041dc(0xd2)]('Tracker\x20ID:',_0x514bdc),console[_0x5041dc(0xd2)](_0x5041dc(0xec),_0x10a610[_0x5041dc(0x153)]),console['log'](_0x5041dc(0x178)),{'gateway_payment_id':_0x48c564||_0x514bdc||_0x14f9e7,'payment_url':_0x4bdf6d||'','transaction_id':_0x48c564};}catch(_0x17cc81){console['error']('âŒ\x20AmPay\x20payment\x20creation\x20failed:',_0x17cc81),console['log'](_0x5041dc(0xd4));throw _0x17cc81;}}async['healthCheck'](){const _0x11abd6=a52_0x5a7a58;try{const _0x572e73=await fetch(this['apiUrl']+_0x11abd6(0x112),{'method':_0x11abd6(0xd1),'headers':{'Content-Type':_0x11abd6(0x16a),'User-Agent':_0x11abd6(0x16d)}});return _0x572e73&&_0x572e73['status']===0xc8?!![]:![];}catch(_0x1b96cb){return console[_0x11abd6(0x119)](_0x11abd6(0x12f),_0x1b96cb),![];}}async[a52_0x5a7a58(0x116)](_0x44b5aa){const _0x3311c2=a52_0x5a7a58;console[_0x3311c2(0xd2)](_0x3311c2(0x162)),console[_0x3311c2(0xd2)](_0x3311c2(0x13e)),console['log'](_0x3311c2(0x130),_0x44b5aa),console['log'](_0x3311c2(0x113),typeof _0x44b5aa),console['log']('Available\x20fields:');_0x44b5aa&&typeof _0x44b5aa===_0x3311c2(0x109)&&Object[_0x3311c2(0x115)](_0x44b5aa)['forEach'](_0x1deb4d=>{const _0x2c5e90=_0x3311c2;console[_0x2c5e90(0xd2)]('\x20\x20'+_0x1deb4d+':\x20'+_0x44b5aa[_0x1deb4d]+'\x20('+typeof _0x44b5aa[_0x1deb4d]+')');});let _0x1cb756=_0x3311c2(0xfa);const _0x58ddc7=_0x44b5aa[_0x3311c2(0x10f)]||_0x44b5aa[_0x3311c2(0xee)]||_0x44b5aa[_0x3311c2(0x127)]||'';return console[_0x3311c2(0xd2)](_0x3311c2(0x173)+_0x58ddc7),console[_0x3311c2(0xd2)](_0x3311c2(0x150)+_0x1cb756),!_0x58ddc7&&(console[_0x3311c2(0x119)]('No\x20payment\x20ID\x20found\x20in\x20webhook\x20data'),console[_0x3311c2(0x119)](_0x3311c2(0x136))),{'paymentId':_0x58ddc7,'status':_0x1cb756,'amount':_0x44b5aa[_0x3311c2(0x125)],'currency':_0x44b5aa[_0x3311c2(0x158)]};}}exports[a52_0x5a7a58(0x149)]=AmPayService,exports[a52_0x5a7a58(0x11d)]=new AmPayService();