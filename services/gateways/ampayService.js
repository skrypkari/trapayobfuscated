'use strict';const a52_0x3d8072=a52_0x3917;function a52_0x3917(_0x27fac7,_0x1cdc45){_0x27fac7=_0x27fac7-0x93;const _0x34a537=a52_0x34a5();let _0x3917e3=_0x34a537[_0x27fac7];return _0x3917e3;}(function(_0x1ee428,_0x177124){const _0x411773=a52_0x3917,_0x572af7=_0x1ee428();while(!![]){try{const _0x43ccea=parseInt(_0x411773(0xf9))/0x1+parseInt(_0x411773(0x139))/0x2+-parseInt(_0x411773(0x104))/0x3+-parseInt(_0x411773(0xd8))/0x4*(parseInt(_0x411773(0x11f))/0x5)+parseInt(_0x411773(0x125))/0x6*(parseInt(_0x411773(0xa6))/0x7)+-parseInt(_0x411773(0xaa))/0x8*(-parseInt(_0x411773(0x13a))/0x9)+-parseInt(_0x411773(0x132))/0xa;if(_0x43ccea===_0x177124)break;else _0x572af7['push'](_0x572af7['shift']());}catch(_0x249438){_0x572af7['push'](_0x572af7['shift']());}}}(a52_0x34a5,0x7ab76));Object[a52_0x3d8072(0x106)](exports,'__esModule',{'value':!![]}),exports[a52_0x3d8072(0x9d)]=exports[a52_0x3d8072(0x9e)]=void 0x0;function a52_0x34a5(){const _0x3fb21e=['SYR','KGZ','PRT','21762kPSqzs','a5a059aa63392e571341bddc5148a5db66643722e9a6bf16a9395fb690a80288931d5a1180a85a28eb9f6516cf61dfc1bf4e37898f3a35261cd2db88888d3815','Checked\x20fields:\x20client_transaction_id,\x20system_id,\x20tracker_id','ESP',',\x20using\x20RUS\x20as\x20fallback','POL','EGY','ðŸ“¤\x20AmPay\x20request\x20body:','PENDING','PER','BLR','KWT','API_PUBLIC_KEY','10720820rqjMsF','YEM','SWE','UZB','KEN','ZMB','PAK','1679148gFvkHC','3818403OKHieP','SMR','SUR','FRA','KHM','CZE','redirect_url','UKR','Customer\x20Country\x20(3-letter):','message','URY','CHN','ARE','ampayService','AmPayService','TJK','currency','Webhook\x20data\x20type:','VNM','tracker_id','ARM','BRA','301NDsQvf','Unknown\x20error','KOR','IDN','16qHJcmS','GET','health.php','LAO','USA','COL','MWI','AmPay\x20API\x20error:\x20HTTP\x20','Status:','AFG','SVK','DNK','EST','MDV','GBR','error_message','MDG','JOR','SYC','ROU','PSE','Extracted\x20payment\x20ID:\x20','DEU','text','TZA','TKM','ðŸ“¥\x20AmPay\x20raw\x20response:','Forced\x20status\x20(webhook\x20disabled):\x20','MKD','\x20-\x20','LTU','XKX','convert2LetterTo3LetterCountryCode','SAU','Customer\x20Country\x20(2-letter):','ampay.php','ISL','MNE','MLT','TrapayAPI/1.0','ECU','âš ï¸\x20WEBHOOKS\x20TEMPORARILY\x20DISABLED\x20-\x20Always\x20returning\x20PROCESSING\x20status','HRV','JPN','Customer:','TUR','4CILcrn','AUT','Email:','Customer\x20IP:','Webhook\x20data:','âš ï¸\x20Unknown\x20country\x20code:\x20','FLK','TRAFFER','POST','âŒ\x20AmPay\x20health\x20check\x20failed:','status','createPaymentLink','keys','58b59ccbc03dcdcfc20d830edfba765dbf9f3531c692533d84b17938e9c40bda','GRC','AmPay\x20payment\x20creation\x20failed:\x20','IRQ','KAZ','ITA','LVA','VEN','client_transaction_id','system_id','amount','API_PRIVATE_KEY','ðŸ“Š\x20AmPay\x20response\x20data:','LKA','stringify','AUS','ZWE','MYS','toUpperCase','CHL','496195CXaHPR','Amount:','NPL','BGD','GEO','BIH','https://traffer.uk/gateway/ampay/','warn','healthCheck','ARG','log','2036295OjSBrf','SRB','defineProperty','RUS','AND','REU','IND','PRK','ðŸ“\x20Logging\x20AmPay\x20payment\x20creation\x20event...','HUN','processWebhook','apiUrl','MNG','MOZ','application/json','Payment\x20URL:','object','GHA','âœ…\x20AmPay\x20payment\x20link\x20created\x20successfully','BHR','error','CAN','forEach','LBN','BEL','LIE','ALB','433855fssweP','LUX','ðŸ‡¦ðŸ‡²\x20AmPay\x20service\x20initialized\x20with\x20Open\x20Banking\x20AM\x20processing'];a52_0x34a5=function(){return _0x3fb21e;};return a52_0x34a5();}class AmPayService{constructor(){const _0x34418d=a52_0x3d8072;this['CLIENT_MERCHANT_ID']=_0x34418d(0xdf),this[_0x34418d(0x131)]=_0x34418d(0xe5),this[_0x34418d(0xf0)]=_0x34418d(0x126),this[_0x34418d(0x10f)]=_0x34418d(0xff),console['log'](_0x34418d(0x121));}['convert2LetterTo3LetterCountryCode'](_0x45efbe){const _0xb5aa81=a52_0x3d8072,_0x2f8bbc={'AD':_0xb5aa81(0x108),'AL':_0xb5aa81(0x11e),'AT':_0xb5aa81(0xd9),'BA':_0xb5aa81(0xfe),'BE':_0xb5aa81(0x11c),'BG':'BGR','BY':_0xb5aa81(0x12f),'CH':'CHE','CY':'CYP','CZ':_0xb5aa81(0x95),'DE':_0xb5aa81(0xc0),'DK':_0xb5aa81(0xb5),'EE':_0xb5aa81(0xb6),'ES':_0xb5aa81(0x128),'FI':'FIN','FR':_0xb5aa81(0x93),'GB':_0xb5aa81(0xb8),'GE':_0xb5aa81(0xfd),'GR':_0xb5aa81(0xe6),'HR':_0xb5aa81(0xd4),'HU':_0xb5aa81(0x10d),'IE':'IRL','IS':_0xb5aa81(0xce),'IT':_0xb5aa81(0xea),'LI':_0xb5aa81(0x11d),'LT':_0xb5aa81(0xc8),'LU':_0xb5aa81(0x120),'LV':_0xb5aa81(0xeb),'MC':'MCO','MD':'MDA','ME':_0xb5aa81(0xcf),'MK':_0xb5aa81(0xc6),'MT':_0xb5aa81(0xd0),'NL':'NLD','NO':'NOR','PL':_0xb5aa81(0x12a),'PT':_0xb5aa81(0x124),'RO':_0xb5aa81(0xbd),'RS':_0xb5aa81(0x105),'RU':'RUS','SE':_0xb5aa81(0x134),'SI':'SVN','SK':_0xb5aa81(0xb4),'SM':_0xb5aa81(0x13b),'UA':_0xb5aa81(0x97),'VA':'VAT','XK':_0xb5aa81(0xc9),'AM':_0xb5aa81(0xa4),'AZ':'AZE','KZ':_0xb5aa81(0xe9),'KG':_0xb5aa81(0x123),'TJ':_0xb5aa81(0x9f),'TM':_0xb5aa81(0xc3),'UZ':_0xb5aa81(0x135),'US':_0xb5aa81(0xae),'CA':_0xb5aa81(0x119),'AU':_0xb5aa81(0xf4),'JP':_0xb5aa81(0xd5),'CN':_0xb5aa81(0x9b),'IN':_0xb5aa81(0x10a),'BR':_0xb5aa81(0xa5),'MX':'MEX','AR':_0xb5aa81(0x102),'CL':_0xb5aa81(0xf8),'PE':_0xb5aa81(0x12e),'CO':_0xb5aa81(0xaf),'VE':_0xb5aa81(0xec),'EC':_0xb5aa81(0xd2),'BO':'BOL','PY':'PRY','UY':_0xb5aa81(0x9a),'SR':_0xb5aa81(0x13c),'GY':'GUY','FK':_0xb5aa81(0xde),'ZA':'ZAF','EG':_0xb5aa81(0x12b),'NG':'NGA','KE':_0xb5aa81(0x136),'GH':_0xb5aa81(0x115),'TZ':_0xb5aa81(0xc2),'UG':'UGA','ZW':_0xb5aa81(0xf5),'ZM':_0xb5aa81(0x137),'MW':_0xb5aa81(0xb0),'MZ':_0xb5aa81(0x111),'MG':_0xb5aa81(0xba),'MU':'MUS','SC':_0xb5aa81(0xbc),'RE':_0xb5aa81(0x109),'TR':_0xb5aa81(0xd7),'IR':'IRN','IQ':_0xb5aa81(0xe8),'SA':_0xb5aa81(0xcb),'AE':_0xb5aa81(0x9c),'KW':_0xb5aa81(0x130),'QA':'QAT','BH':_0xb5aa81(0x117),'OM':'OMN','YE':_0xb5aa81(0x133),'JO':_0xb5aa81(0xbb),'LB':_0xb5aa81(0x11b),'SY':_0xb5aa81(0x122),'IL':'ISR','PS':_0xb5aa81(0xbe),'KR':_0xb5aa81(0xa8),'KP':_0xb5aa81(0x10b),'TH':'THA','VN':_0xb5aa81(0xa2),'MY':_0xb5aa81(0xf6),'SG':'SGP','ID':_0xb5aa81(0xa9),'PH':'PHL','LA':_0xb5aa81(0xad),'KH':_0xb5aa81(0x94),'MM':'MMR','BD':_0xb5aa81(0xfc),'LK':_0xb5aa81(0xf2),'NP':_0xb5aa81(0xfb),'BT':'BTN','MV':_0xb5aa81(0xb7),'AF':_0xb5aa81(0xb3),'PK':_0xb5aa81(0x138),'MN':_0xb5aa81(0x110)},_0x5404f5=_0x2f8bbc[_0x45efbe[_0xb5aa81(0xf7)]()];if(!_0x5404f5)return console[_0xb5aa81(0x100)](_0xb5aa81(0xdd)+_0x45efbe+_0xb5aa81(0x129)),_0xb5aa81(0x107);return _0x5404f5;}async[a52_0x3d8072(0xe3)](_0x3afa92){const _0x5b7bd7=a52_0x3d8072;try{const {orderId:_0x4ed466,amount:_0x5394ae,currency:_0x328b4d,firstName:_0x99c558,lastName:_0x4cb2f4,email:_0x1d2cbe,customerIp:_0x5ea2f3,customerCountry:_0xdfeea4,successUrl:_0x58a30c,failureUrl:_0x515fbf}=_0x3afa92;console[_0x5b7bd7(0x103)]('ðŸ‡¦ðŸ‡²\x20Creating\x20AmPay\x20payment\x20link...'),console[_0x5b7bd7(0x103)]('Order\x20ID:',_0x4ed466),console[_0x5b7bd7(0x103)](_0x5b7bd7(0xfa),_0x5394ae,_0x328b4d),console[_0x5b7bd7(0x103)](_0x5b7bd7(0xd6),_0x99c558+'\x20'+_0x4cb2f4),console[_0x5b7bd7(0x103)](_0x5b7bd7(0xda),_0x1d2cbe),console['log'](_0x5b7bd7(0xdb),_0x5ea2f3),console[_0x5b7bd7(0x103)](_0x5b7bd7(0xcc),_0xdfeea4);const _0xa46b7c=this[_0x5b7bd7(0xca)](_0xdfeea4);console[_0x5b7bd7(0x103)](_0x5b7bd7(0x98),_0xa46b7c);const _0x1f69ff={'sub_method':'GAM','currency':_0x328b4d['toUpperCase'](),'amount':_0x5394ae,'callback_url':'https://traffer.uk/gateway/ampay/webhook.php','client_merchant_id':this['CLIENT_MERCHANT_ID'],'client_transaction_id':_0x4ed466,'transaction_description':_0x4ed466,'customer':{'ip':_0x5ea2f3,'email':_0x1d2cbe,'full_name':_0x99c558+'\x20'+_0x4cb2f4,'country':_0xa46b7c},'success_redirect_url':_0x58a30c,'error_redirect_url':_0x515fbf};console['log'](_0x5b7bd7(0x12c),JSON['stringify'](_0x1f69ff,null,0x2));const _0x24bbf6=await fetch(this[_0x5b7bd7(0x10f)]+_0x5b7bd7(0xcd),{'method':_0x5b7bd7(0xe0),'headers':{'Content-Type':_0x5b7bd7(0x112),'User-Agent':_0x5b7bd7(0xd1)},'body':JSON[_0x5b7bd7(0xf3)](_0x1f69ff)}),_0x1115b9=await _0x24bbf6[_0x5b7bd7(0xc1)]();console[_0x5b7bd7(0x103)](_0x5b7bd7(0xc4),_0x1115b9);if(!_0x24bbf6['ok'])throw new Error(_0x5b7bd7(0xb1)+_0x24bbf6[_0x5b7bd7(0xe2)]+_0x5b7bd7(0xc7)+_0x1115b9);let _0x19172b;try{_0x19172b=JSON['parse'](_0x1115b9);}catch(_0x3a639c){throw new Error('Invalid\x20JSON\x20response\x20from\x20AmPay:\x20'+_0x1115b9);}console['log'](_0x5b7bd7(0xf1),JSON['stringify'](_0x19172b,null,0x2));if(!_0x19172b[_0x5b7bd7(0x96)])throw new Error(_0x5b7bd7(0xe7)+(_0x19172b[_0x5b7bd7(0xb9)]||_0x19172b[_0x5b7bd7(0x99)]||_0x5b7bd7(0xa7)));const _0x44adc7=_0x19172b[_0x5b7bd7(0x96)],_0x122afc=_0x19172b[_0x5b7bd7(0xee)],_0x4ab1ee=_0x19172b[_0x5b7bd7(0xa3)];return console[_0x5b7bd7(0x103)](_0x5b7bd7(0x116)),console[_0x5b7bd7(0x103)](_0x5b7bd7(0x113),_0x44adc7),console[_0x5b7bd7(0x103)]('System\x20ID:',_0x122afc),console[_0x5b7bd7(0x103)]('Tracker\x20ID:',_0x4ab1ee),console[_0x5b7bd7(0x103)](_0x5b7bd7(0xb2),_0x19172b['status']),console[_0x5b7bd7(0x103)](_0x5b7bd7(0x10c)),{'gateway_payment_id':_0x122afc||_0x4ab1ee||_0x4ed466,'payment_url':_0x44adc7||'','transaction_id':_0x122afc};}catch(_0x333458){console[_0x5b7bd7(0x118)]('âŒ\x20AmPay\x20payment\x20creation\x20failed:',_0x333458),console[_0x5b7bd7(0x103)]('ðŸ“\x20Logging\x20AmPay\x20payment\x20creation\x20failure...');throw _0x333458;}}async[a52_0x3d8072(0x101)](){const _0x488c3f=a52_0x3d8072;try{const _0xe7bff8=await fetch(this[_0x488c3f(0x10f)]+_0x488c3f(0xac),{'method':_0x488c3f(0xab),'headers':{'Content-Type':_0x488c3f(0x112),'User-Agent':_0x488c3f(0xd1)}});return _0xe7bff8&&_0xe7bff8['status']===0xc8?!![]:![];}catch(_0x12cee5){return console['error'](_0x488c3f(0xe1),_0x12cee5),![];}}async[a52_0x3d8072(0x10e)](_0x57fd19){const _0x5d479d=a52_0x3d8072;console[_0x5d479d(0x103)]('===\x20Processing\x20AmPay\x20webhook\x20==='),console[_0x5d479d(0x103)](_0x5d479d(0xd3)),console[_0x5d479d(0x103)](_0x5d479d(0xdc),_0x57fd19),console['log'](_0x5d479d(0xa1),typeof _0x57fd19),console['log']('Available\x20fields:');_0x57fd19&&typeof _0x57fd19===_0x5d479d(0x114)&&Object[_0x5d479d(0xe4)](_0x57fd19)[_0x5d479d(0x11a)](_0x32f01a=>{const _0x91b1fa=_0x5d479d;console[_0x91b1fa(0x103)]('\x20\x20'+_0x32f01a+':\x20'+_0x57fd19[_0x32f01a]+'\x20('+typeof _0x57fd19[_0x32f01a]+')');});let _0x39185d=_0x5d479d(0x12d);const _0x5c1181=_0x57fd19[_0x5d479d(0xed)]||_0x57fd19[_0x5d479d(0xee)]||_0x57fd19[_0x5d479d(0xa3)]||'';return console[_0x5d479d(0x103)](_0x5d479d(0xbf)+_0x5c1181),console[_0x5d479d(0x103)](_0x5d479d(0xc5)+_0x39185d),!_0x5c1181&&(console['error']('No\x20payment\x20ID\x20found\x20in\x20webhook\x20data'),console[_0x5d479d(0x118)](_0x5d479d(0x127))),{'paymentId':_0x5c1181,'status':_0x39185d,'amount':_0x57fd19[_0x5d479d(0xef)],'currency':_0x57fd19[_0x5d479d(0xa0)]};}}exports['AmPayService']=AmPayService,exports[a52_0x3d8072(0x9d)]=new AmPayService();