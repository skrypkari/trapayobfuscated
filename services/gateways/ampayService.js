'use strict';const a52_0x5cdb22=a52_0x23b8;(function(_0x1c9e81,_0x3cdd93){const _0x233ec6=a52_0x23b8,_0x4684ab=_0x1c9e81();while(!![]){try{const _0x6af447=parseInt(_0x233ec6(0xd2))/0x1*(-parseInt(_0x233ec6(0xc8))/0x2)+parseInt(_0x233ec6(0xe6))/0x3*(-parseInt(_0x233ec6(0xe4))/0x4)+-parseInt(_0x233ec6(0xeb))/0x5+parseInt(_0x233ec6(0xc7))/0x6+parseInt(_0x233ec6(0x128))/0x7+-parseInt(_0x233ec6(0xa4))/0x8+parseInt(_0x233ec6(0xa0))/0x9;if(_0x6af447===_0x3cdd93)break;else _0x4684ab['push'](_0x4684ab['shift']());}catch(_0x54d5c4){_0x4684ab['push'](_0x4684ab['shift']());}}}(a52_0x1dcc,0x6911d));Object[a52_0x5cdb22(0xdb)](exports,'__esModule',{'value':!![]}),exports['ampayService']=exports['AmPayService']=void 0x0;function a52_0x23b8(_0x3e9ca8,_0x163fce){_0x3e9ca8=_0x3e9ca8-0x95;const _0x1dcc17=a52_0x1dcc();let _0x23b8d7=_0x1dcc17[_0x3e9ca8];return _0x23b8d7;}function a52_0x1dcc(){const _0x407e07=['Checked\x20fields:\x20client_transaction_id,\x20system_id,\x20tracker_id','TZA','ZWE','4071312tUxCGA','2gyJFpM','JPN','MYS','Customer\x20Country\x20(2-letter):','ðŸ“¥\x20AmPay\x20raw\x20response:','EGY','Customer\x20Country\x20(3-letter):','error_message','KOR','CYP','601687PIMLja','ðŸ‡¦ðŸ‡²\x20Creating\x20AmPay\x20payment\x20link...','SGP','processWebhook','SMR','BRA','\x20-\x20','client_transaction_id','KGZ','defineProperty','ðŸ“¤\x20AmPay\x20request\x20body:','MEX','ECU','NPL','ARM','ESP','SAU','ARE','4TCOUca','ðŸ“\x20Logging\x20AmPay\x20payment\x20creation\x20failure...','20499eKDwqN','LVA','redirect_url','MNE','CLIENT_MERCHANT_ID','3488580SQOPKD','IDN','LTU','ampay.php','JOR','warn','parse','MDA','health.php','ITA','stringify','message','BEL','log','NLD','RUS','COL','USA','MNG','BIH','IRL','CZE','createPaymentLink','YEM','Webhook\x20data\x20type:','AUT','VAT','KHM','TUR','convert2LetterTo3LetterCountryCode','TKM','XKX','toUpperCase','status','keys','BGR','Forced\x20status\x20(webhook\x20disabled):\x20','GEO','https://traffer.uk/gateway/ampay/webhook.php','NGA','System\x20ID:','THA','LIE','GAM','===\x20Processing\x20AmPay\x20webhook\x20===','Email:','QAT','HUN','AmPayService','BTN','MWI','PRY','PENDING','CAN',',\x20using\x20RUS\x20as\x20fallback','Payment\x20URL:','KEN','TJK','object','SVN','EST','5201952aEGCpx','ISR','BHR','HRV','UKR','apiUrl','MKD','error','currency','KAZ','SRB','LBN','SYR','MUS','CHL','AUS','GRC','AFG','https://traffer.uk/gateway/ampay/','LKA','GUY','KWT','system_id','BGD','MOZ','application/json','2862099CxoRrv','âš ï¸\x20Unknown\x20country\x20code:\x20','SYC','ZAF','24784NWLXfL','âœ…\x20AmPay\x20payment\x20link\x20created\x20successfully','URY','TrapayAPI/1.0','Status:','CHN','FLK','IRN','PRK','Tracker\x20ID:','ðŸ“\x20Logging\x20AmPay\x20payment\x20creation\x20event...','No\x20payment\x20ID\x20found\x20in\x20webhook\x20data','VEN','ampayService','DNK','ISL','MDV','Webhook\x20data:','IRQ','text','âŒ\x20AmPay\x20health\x20check\x20failed:','Unknown\x20error','58b59ccbc03dcdcfc20d830edfba765dbf9f3531c692533d84b17938e9c40bda','GET','MCO','ðŸ“Š\x20AmPay\x20response\x20data:','REU','ROU','AZE','MDG','POL','forEach'];a52_0x1dcc=function(){return _0x407e07;};return a52_0x1dcc();}class AmPayService{constructor(){const _0x247e92=a52_0x5cdb22;this['CLIENT_MERCHANT_ID']='TRAFFER',this['API_PUBLIC_KEY']=_0x247e92(0xba),this['API_PRIVATE_KEY']='a5a059aa63392e571341bddc5148a5db66643722e9a6bf16a9395fb690a80288931d5a1180a85a28eb9f6516cf61dfc1bf4e37898f3a35261cd2db88888d3815',this[_0x247e92(0x12d)]=_0x247e92(0x98),console[_0x247e92(0xf8)]('ðŸ‡¦ðŸ‡²\x20AmPay\x20service\x20initialized\x20with\x20Open\x20Banking\x20AM\x20processing');}[a52_0x5cdb22(0x108)](_0x49e1c5){const _0x5ba7fd=a52_0x5cdb22,_0x46ae03={'AD':'AND','AL':'ALB','AT':_0x5ba7fd(0x104),'BA':_0x5ba7fd(0xfe),'BE':_0x5ba7fd(0xf7),'BG':_0x5ba7fd(0x10e),'BY':'BLR','CH':'CHE','CY':_0x5ba7fd(0xd1),'CZ':_0x5ba7fd(0x100),'DE':'DEU','DK':_0x5ba7fd(0xb2),'EE':_0x5ba7fd(0x127),'ES':_0x5ba7fd(0xe1),'FI':'FIN','FR':'FRA','GB':'GBR','GE':_0x5ba7fd(0x110),'GR':_0x5ba7fd(0x96),'HR':_0x5ba7fd(0x12b),'HU':_0x5ba7fd(0x11a),'IE':_0x5ba7fd(0xff),'IS':_0x5ba7fd(0xb3),'IT':_0x5ba7fd(0xf4),'LI':_0x5ba7fd(0x115),'LT':_0x5ba7fd(0xed),'LU':'LUX','LV':_0x5ba7fd(0xe7),'MC':_0x5ba7fd(0xbc),'MD':_0x5ba7fd(0xf2),'ME':_0x5ba7fd(0xe9),'MK':_0x5ba7fd(0x12e),'MT':'MLT','NL':_0x5ba7fd(0xf9),'NO':'NOR','PL':_0x5ba7fd(0xc2),'PT':'PRT','RO':_0x5ba7fd(0xbf),'RS':_0x5ba7fd(0x132),'RU':_0x5ba7fd(0xfa),'SE':'SWE','SI':_0x5ba7fd(0x126),'SK':'SVK','SM':_0x5ba7fd(0xd6),'UA':_0x5ba7fd(0x12c),'VA':_0x5ba7fd(0x105),'XK':_0x5ba7fd(0x10a),'AM':_0x5ba7fd(0xe0),'AZ':_0x5ba7fd(0xc0),'KZ':_0x5ba7fd(0x131),'KG':_0x5ba7fd(0xda),'TJ':_0x5ba7fd(0x124),'TM':_0x5ba7fd(0x109),'UZ':'UZB','US':_0x5ba7fd(0xfc),'CA':_0x5ba7fd(0x120),'AU':_0x5ba7fd(0x95),'JP':_0x5ba7fd(0xc9),'CN':_0x5ba7fd(0xa9),'IN':'IND','BR':_0x5ba7fd(0xd7),'MX':_0x5ba7fd(0xdd),'AR':'ARG','CL':_0x5ba7fd(0x136),'PE':'PER','CO':_0x5ba7fd(0xfb),'VE':_0x5ba7fd(0xb0),'EC':_0x5ba7fd(0xde),'BO':'BOL','PY':_0x5ba7fd(0x11e),'UY':_0x5ba7fd(0xa6),'SR':'SUR','GY':_0x5ba7fd(0x9a),'FK':_0x5ba7fd(0xaa),'ZA':_0x5ba7fd(0xa3),'EG':_0x5ba7fd(0xcd),'NG':_0x5ba7fd(0x112),'KE':_0x5ba7fd(0x123),'GH':'GHA','TZ':_0x5ba7fd(0xc5),'UG':'UGA','ZW':_0x5ba7fd(0xc6),'ZM':'ZMB','MW':_0x5ba7fd(0x11d),'MZ':_0x5ba7fd(0x9e),'MG':_0x5ba7fd(0xc1),'MU':_0x5ba7fd(0x135),'SC':_0x5ba7fd(0xa2),'RE':_0x5ba7fd(0xbe),'TR':_0x5ba7fd(0x107),'IR':_0x5ba7fd(0xab),'IQ':_0x5ba7fd(0xb6),'SA':_0x5ba7fd(0xe2),'AE':_0x5ba7fd(0xe3),'KW':_0x5ba7fd(0x9b),'QA':_0x5ba7fd(0x119),'BH':_0x5ba7fd(0x12a),'OM':'OMN','YE':_0x5ba7fd(0x102),'JO':_0x5ba7fd(0xef),'LB':_0x5ba7fd(0x133),'SY':_0x5ba7fd(0x134),'IL':_0x5ba7fd(0x129),'PS':'PSE','KR':_0x5ba7fd(0xd0),'KP':_0x5ba7fd(0xac),'TH':_0x5ba7fd(0x114),'VN':'VNM','MY':_0x5ba7fd(0xca),'SG':_0x5ba7fd(0xd4),'ID':_0x5ba7fd(0xec),'PH':'PHL','LA':'LAO','KH':_0x5ba7fd(0x106),'MM':'MMR','BD':_0x5ba7fd(0x9d),'LK':_0x5ba7fd(0x99),'NP':_0x5ba7fd(0xdf),'BT':_0x5ba7fd(0x11c),'MV':_0x5ba7fd(0xb4),'AF':_0x5ba7fd(0x97),'PK':'PAK','MN':_0x5ba7fd(0xfd)},_0x4282fc=_0x46ae03[_0x49e1c5[_0x5ba7fd(0x10b)]()];if(!_0x4282fc)return console[_0x5ba7fd(0xf0)](_0x5ba7fd(0xa1)+_0x49e1c5+_0x5ba7fd(0x121)),'RUS';return _0x4282fc;}async[a52_0x5cdb22(0x101)](_0x5bf27e){const _0x597d53=a52_0x5cdb22;try{const {orderId:_0x4ab00a,amount:_0x360cd4,currency:_0x201264,firstName:_0x1c4543,lastName:_0x1df9df,email:_0x2768ab,customerIp:_0x308b07,customerCountry:_0x3536cf,successUrl:_0x3af5d9,failureUrl:_0xc12936}=_0x5bf27e;console[_0x597d53(0xf8)](_0x597d53(0xd3)),console[_0x597d53(0xf8)]('Order\x20ID:',_0x4ab00a),console[_0x597d53(0xf8)]('Amount:',_0x360cd4,_0x201264),console[_0x597d53(0xf8)]('Customer:',_0x1c4543+'\x20'+_0x1df9df),console['log'](_0x597d53(0x118),_0x2768ab),console['log']('Customer\x20IP:',_0x308b07),console[_0x597d53(0xf8)](_0x597d53(0xcb),_0x3536cf);const _0x247778=this[_0x597d53(0x108)](_0x3536cf);console[_0x597d53(0xf8)](_0x597d53(0xce),_0x247778);const _0x56b7af={'sub_method':_0x597d53(0x116),'currency':_0x201264['toUpperCase'](),'amount':_0x360cd4,'callback_url':_0x597d53(0x111),'client_merchant_id':this[_0x597d53(0xea)],'client_transaction_id':_0x4ab00a,'transaction_description':_0x4ab00a,'customer':{'ip':_0x308b07,'email':_0x2768ab,'full_name':_0x1c4543+'\x20'+_0x1df9df,'country':_0x247778},'success_redirect_url':_0x3af5d9,'error_redirect_url':_0xc12936};console[_0x597d53(0xf8)](_0x597d53(0xdc),JSON['stringify'](_0x56b7af,null,0x2));const _0x2918e9=await fetch(this['apiUrl']+_0x597d53(0xee),{'method':'POST','headers':{'Content-Type':_0x597d53(0x9f),'User-Agent':_0x597d53(0xa7)},'body':JSON['stringify'](_0x56b7af)}),_0x1e1af0=await _0x2918e9[_0x597d53(0xb7)]();console['log'](_0x597d53(0xcc),_0x1e1af0);if(!_0x2918e9['ok'])throw new Error('AmPay\x20API\x20error:\x20HTTP\x20'+_0x2918e9[_0x597d53(0x10c)]+_0x597d53(0xd8)+_0x1e1af0);let _0x4d19e3;try{_0x4d19e3=JSON[_0x597d53(0xf1)](_0x1e1af0);}catch(_0x3bf20f){throw new Error('Invalid\x20JSON\x20response\x20from\x20AmPay:\x20'+_0x1e1af0);}console[_0x597d53(0xf8)](_0x597d53(0xbd),JSON[_0x597d53(0xf5)](_0x4d19e3,null,0x2));if(!_0x4d19e3[_0x597d53(0xe8)])throw new Error('AmPay\x20payment\x20creation\x20failed:\x20'+(_0x4d19e3[_0x597d53(0xcf)]||_0x4d19e3[_0x597d53(0xf6)]||_0x597d53(0xb9)));const _0x21e779=_0x4d19e3[_0x597d53(0xe8)],_0xbd8e09=_0x4d19e3[_0x597d53(0x9c)],_0x456194=_0x4d19e3['tracker_id'];return console[_0x597d53(0xf8)](_0x597d53(0xa5)),console[_0x597d53(0xf8)](_0x597d53(0x122),_0x21e779),console[_0x597d53(0xf8)](_0x597d53(0x113),_0xbd8e09),console[_0x597d53(0xf8)](_0x597d53(0xad),_0x456194),console['log'](_0x597d53(0xa8),_0x4d19e3[_0x597d53(0x10c)]),console[_0x597d53(0xf8)](_0x597d53(0xae)),{'gateway_payment_id':_0xbd8e09||_0x456194||_0x4ab00a,'payment_url':_0x21e779||'','transaction_id':_0xbd8e09};}catch(_0x5a0784){console[_0x597d53(0x12f)]('âŒ\x20AmPay\x20payment\x20creation\x20failed:',_0x5a0784),console[_0x597d53(0xf8)](_0x597d53(0xe5));throw _0x5a0784;}}async['healthCheck'](){const _0x3ef8b9=a52_0x5cdb22;try{const _0x106fd9=await fetch(this[_0x3ef8b9(0x12d)]+_0x3ef8b9(0xf3),{'method':_0x3ef8b9(0xbb),'headers':{'Content-Type':_0x3ef8b9(0x9f),'User-Agent':'TrapayAPI/1.0'}});return _0x106fd9&&_0x106fd9[_0x3ef8b9(0x10c)]===0xc8?!![]:![];}catch(_0x7c2cef){return console[_0x3ef8b9(0x12f)](_0x3ef8b9(0xb8),_0x7c2cef),![];}}async[a52_0x5cdb22(0xd5)](_0x7c4ae6){const _0x5f2fbd=a52_0x5cdb22;console['log'](_0x5f2fbd(0x117)),console[_0x5f2fbd(0xf8)]('âš ï¸\x20WEBHOOKS\x20TEMPORARILY\x20DISABLED\x20-\x20Always\x20returning\x20PROCESSING\x20status'),console[_0x5f2fbd(0xf8)](_0x5f2fbd(0xb5),_0x7c4ae6),console[_0x5f2fbd(0xf8)](_0x5f2fbd(0x103),typeof _0x7c4ae6),console[_0x5f2fbd(0xf8)]('Available\x20fields:');_0x7c4ae6&&typeof _0x7c4ae6===_0x5f2fbd(0x125)&&Object[_0x5f2fbd(0x10d)](_0x7c4ae6)[_0x5f2fbd(0xc3)](_0x429489=>{const _0xdac9d0=_0x5f2fbd;console[_0xdac9d0(0xf8)]('\x20\x20'+_0x429489+':\x20'+_0x7c4ae6[_0x429489]+'\x20('+typeof _0x7c4ae6[_0x429489]+')');});let _0x28851b=_0x5f2fbd(0x11f);const _0x2e6828=_0x7c4ae6[_0x5f2fbd(0xd9)]||_0x7c4ae6['system_id']||_0x7c4ae6['tracker_id']||'';return console[_0x5f2fbd(0xf8)]('Extracted\x20payment\x20ID:\x20'+_0x2e6828),console[_0x5f2fbd(0xf8)](_0x5f2fbd(0x10f)+_0x28851b),!_0x2e6828&&(console[_0x5f2fbd(0x12f)](_0x5f2fbd(0xaf)),console['error'](_0x5f2fbd(0xc4))),{'paymentId':_0x2e6828,'status':_0x28851b,'amount':_0x7c4ae6['amount'],'currency':_0x7c4ae6[_0x5f2fbd(0x130)]};}}exports[a52_0x5cdb22(0x11b)]=AmPayService,exports[a52_0x5cdb22(0xb1)]=new AmPayService();