'use strict';const a42_0x5a56cb=a42_0x1a5b;(function(_0xc69954,_0x3c24c7){const _0x1e6944=a42_0x1a5b,_0x552c51=_0xc69954();while(!![]){try{const _0x59cc24=parseInt(_0x1e6944(0x26d))/0x1*(-parseInt(_0x1e6944(0x268))/0x2)+parseInt(_0x1e6944(0x255))/0x3*(-parseInt(_0x1e6944(0x208))/0x4)+parseInt(_0x1e6944(0x205))/0x5*(-parseInt(_0x1e6944(0x22a))/0x6)+-parseInt(_0x1e6944(0x27b))/0x7+parseInt(_0x1e6944(0x20c))/0x8+-parseInt(_0x1e6944(0x210))/0x9+parseInt(_0x1e6944(0x265))/0xa;if(_0x59cc24===_0x3c24c7)break;else _0x552c51['push'](_0x552c51['shift']());}catch(_0x394e52){_0x552c51['push'](_0x552c51['shift']());}}}(a42_0x4fb2,0x597a8));function a42_0x4fb2(){const _0x927a19=['Order\x20ID:','System\x20ID:','amount','LBN','CAN','object','üá¶üá≤\x20AmPay\x20service\x20initialized\x20with\x20Open\x20Banking\x20AM\x20processing','Unknown\x20error','üìä\x20AmPay\x20response\x20data:','stringify','RUS','https://traffer.uk/gateway/ampay/','PHL','VAT','NPL','MNG','‚ö†Ô∏è\x20Unknown\x20country\x20code:\x20','PRT','PAK','https://api.trapay.uk/api/webhooks/gateway/ampay','TZA','Customer\x20Country\x20(3-letter):','error_message','CYP','API_PRIVATE_KEY','YEM','VNM','PER','health.php','Forced\x20status\x20(webhook\x20disabled):\x20','LTU','üì•\x20AmPay\x20raw\x20response:','processWebhook','KHM','apiUrl','message','SYR','370833SgRhAE','Checked\x20fields:\x20client_transaction_id,\x20system_id,\x20tracker_id','convert2LetterTo3LetterCountryCode','AFG','tracker_id','ARM','log','LAO','===\x20Processing\x20AmPay\x20webhook\x20===','text','ROU','VEN','MKD','MNE','TJK','ITA','12562380uQLWxK','PRK','KWT','14qcZbUR','client_transaction_id','warn','NLD','‚ùå\x20AmPay\x20health\x20check\x20failed:','61498IDKkUc','parse','MDV','JOR','UZB','error','CZE','AmPayService','üìù\x20Logging\x20AmPay\x20payment\x20creation\x20failure...','SMR','\x20-\x20','BOL','üá¶üá≤\x20Creating\x20AmPay\x20payment\x20link...','Extracted\x20payment\x20ID:\x20','1206940bknmSn','AmPay\x20payment\x20creation\x20failed:\x20','üì§\x20AmPay\x20request\x20body:','KAZ','KGZ','Customer\x20IP:','FLK','MLT','POST','COL','AZE','EST','SAU','REU','defineProperty','SGP','CLIENT_MERCHANT_ID','SVK','KEN','keys','ZAF','GRC','BGD','DNK','system_id','Amount:','MUS','AND','IRQ','AUT','Invalid\x20JSON\x20response\x20from\x20AmPay:\x20','SWE','MWI','‚ö†Ô∏è\x20WEBHOOKS\x20TEMPORARILY\x20DISABLED\x20-\x20Always\x20returning\x20PROCESSING\x20status','__esModule','IND','CHN','PSE','‚ùå\x20AmPay\x20payment\x20creation\x20failed:','MDG','SYC','FRA','forEach','LKA','createPaymentLink','XKX','DEU','UKR','BGR','LIE','BHR','ARG','toUpperCase','ampayService','Available\x20fields:','5hHKvSM','BLR','FIN','4oZlZHD','MYS','GHA','BEL','5415696ZLvmGy','URY','Email:','TUR','3462552LsScLD','application/json','Payment\x20URL:','healthCheck','API_PUBLIC_KEY','GAM','AmPay\x20API\x20error:\x20HTTP\x20','NOR','KOR','SUR','CHE','TKM','redirect_url','USA','status','a5a059aa63392e571341bddc5148a5db66643722e9a6bf16a9395fb690a80288931d5a1180a85a28eb9f6516cf61dfc1bf4e37898f3a35261cd2db88888d3815','ALB','IRN','POL','GEO','LUX','OMN','MMR','MCO','PRY','ampay.php','2732706YffoeI','ZWE','currency','IRL','ECU','TrapayAPI/1.0'];a42_0x4fb2=function(){return _0x927a19;};return a42_0x4fb2();}Object[a42_0x5a56cb(0x289)](exports,a42_0x5a56cb(0x1f0),{'value':!![]}),exports[a42_0x5a56cb(0x203)]=exports[a42_0x5a56cb(0x274)]=void 0x0;function a42_0x1a5b(_0x4beb94,_0x4ababd){const _0x4fb2d0=a42_0x4fb2();return a42_0x1a5b=function(_0x1a5b34,_0xe20750){_0x1a5b34=_0x1a5b34-0x1ea;let _0x1c72a4=_0x4fb2d0[_0x1a5b34];return _0x1c72a4;},a42_0x1a5b(_0x4beb94,_0x4ababd);}class AmPayService{constructor(){const _0x4bd76b=a42_0x5a56cb;this['CLIENT_MERCHANT_ID']='TRAFFER',this[_0x4bd76b(0x214)]='58b59ccbc03dcdcfc20d830edfba765dbf9f3531c692533d84b17938e9c40bda',this[_0x4bd76b(0x248)]=_0x4bd76b(0x21f),this['apiUrl']=_0x4bd76b(0x23b),console[_0x4bd76b(0x25b)](_0x4bd76b(0x236));}[a42_0x5a56cb(0x257)](_0x2f01fc){const _0xab0f7=a42_0x5a56cb,_0x54e467={'AD':_0xab0f7(0x296),'AL':_0xab0f7(0x220),'AT':_0xab0f7(0x1eb),'BA':'BIH','BE':_0xab0f7(0x20b),'BG':_0xab0f7(0x1fe),'BY':_0xab0f7(0x206),'CH':_0xab0f7(0x21a),'CY':_0xab0f7(0x247),'CZ':_0xab0f7(0x273),'DE':_0xab0f7(0x1fc),'DK':_0xab0f7(0x292),'EE':_0xab0f7(0x286),'ES':'ESP','FI':_0xab0f7(0x207),'FR':_0xab0f7(0x1f7),'GB':'GBR','GE':_0xab0f7(0x223),'GR':_0xab0f7(0x290),'HR':'HRV','HU':'HUN','IE':_0xab0f7(0x22d),'IS':'ISL','IT':_0xab0f7(0x264),'LI':_0xab0f7(0x1ff),'LT':_0xab0f7(0x24e),'LU':_0xab0f7(0x224),'LV':'LVA','MC':_0xab0f7(0x227),'MD':'MDA','ME':_0xab0f7(0x262),'MK':_0xab0f7(0x261),'MT':_0xab0f7(0x282),'NL':_0xab0f7(0x26b),'NO':_0xab0f7(0x217),'PL':_0xab0f7(0x222),'PT':_0xab0f7(0x241),'RO':_0xab0f7(0x25f),'RS':'SRB','RU':_0xab0f7(0x23a),'SE':_0xab0f7(0x1ed),'SI':'SVN','SK':_0xab0f7(0x28c),'SM':_0xab0f7(0x276),'UA':_0xab0f7(0x1fd),'VA':_0xab0f7(0x23d),'XK':_0xab0f7(0x1fb),'AM':_0xab0f7(0x25a),'AZ':_0xab0f7(0x285),'KZ':_0xab0f7(0x27e),'KG':_0xab0f7(0x27f),'TJ':_0xab0f7(0x263),'TM':_0xab0f7(0x21b),'UZ':_0xab0f7(0x271),'US':_0xab0f7(0x21d),'CA':_0xab0f7(0x234),'AU':'AUS','JP':'JPN','CN':_0xab0f7(0x1f2),'IN':_0xab0f7(0x1f1),'BR':'BRA','MX':'MEX','AR':_0xab0f7(0x201),'CL':'CHL','PE':_0xab0f7(0x24b),'CO':_0xab0f7(0x284),'VE':_0xab0f7(0x260),'EC':_0xab0f7(0x22e),'BO':_0xab0f7(0x278),'PY':_0xab0f7(0x228),'UY':_0xab0f7(0x20d),'SR':_0xab0f7(0x219),'GY':'GUY','FK':_0xab0f7(0x281),'ZA':_0xab0f7(0x28f),'EG':'EGY','NG':'NGA','KE':_0xab0f7(0x28d),'GH':_0xab0f7(0x20a),'TZ':_0xab0f7(0x244),'UG':'UGA','ZW':_0xab0f7(0x22b),'ZM':'ZMB','MW':_0xab0f7(0x1ee),'MZ':'MOZ','MG':_0xab0f7(0x1f5),'MU':_0xab0f7(0x295),'SC':_0xab0f7(0x1f6),'RE':_0xab0f7(0x288),'TR':_0xab0f7(0x20f),'IR':_0xab0f7(0x221),'IQ':_0xab0f7(0x1ea),'SA':_0xab0f7(0x287),'AE':'ARE','KW':_0xab0f7(0x267),'QA':'QAT','BH':_0xab0f7(0x200),'OM':_0xab0f7(0x225),'YE':_0xab0f7(0x249),'JO':_0xab0f7(0x270),'LB':_0xab0f7(0x233),'SY':_0xab0f7(0x254),'IL':'ISR','PS':_0xab0f7(0x1f3),'KR':_0xab0f7(0x218),'KP':_0xab0f7(0x266),'TH':'THA','VN':_0xab0f7(0x24a),'MY':_0xab0f7(0x209),'SG':_0xab0f7(0x28a),'ID':'IDN','PH':_0xab0f7(0x23c),'LA':_0xab0f7(0x25c),'KH':_0xab0f7(0x251),'MM':_0xab0f7(0x226),'BD':_0xab0f7(0x291),'LK':_0xab0f7(0x1f9),'NP':_0xab0f7(0x23e),'BT':'BTN','MV':_0xab0f7(0x26f),'AF':_0xab0f7(0x258),'PK':_0xab0f7(0x242),'MN':_0xab0f7(0x23f)},_0x6de1a6=_0x54e467[_0x2f01fc[_0xab0f7(0x202)]()];if(!_0x6de1a6)return console[_0xab0f7(0x26a)](_0xab0f7(0x240)+_0x2f01fc+',\x20using\x20RUS\x20as\x20fallback'),_0xab0f7(0x23a);return _0x6de1a6;}async[a42_0x5a56cb(0x1fa)](_0x16d8b7){const _0xde4c9a=a42_0x5a56cb;try{const {orderId:_0x13f0ff,amount:_0x416611,currency:_0x72b85,firstName:_0x16db00,lastName:_0x2b897b,email:_0x5dc00f,customerIp:_0x211563,customerCountry:_0x38a38b,successUrl:_0x389fba,failureUrl:_0x516c51}=_0x16d8b7;console[_0xde4c9a(0x25b)](_0xde4c9a(0x279)),console[_0xde4c9a(0x25b)](_0xde4c9a(0x230),_0x13f0ff),console[_0xde4c9a(0x25b)](_0xde4c9a(0x294),_0x416611,_0x72b85),console['log']('Customer:',_0x16db00+'\x20'+_0x2b897b),console[_0xde4c9a(0x25b)](_0xde4c9a(0x20e),_0x5dc00f),console[_0xde4c9a(0x25b)](_0xde4c9a(0x280),_0x211563),console[_0xde4c9a(0x25b)]('Customer\x20Country\x20(2-letter):',_0x38a38b);const _0x18dd2f=this['convert2LetterTo3LetterCountryCode'](_0x38a38b);console[_0xde4c9a(0x25b)](_0xde4c9a(0x245),_0x18dd2f);const _0x32c2ee={'sub_method':_0xde4c9a(0x215),'currency':_0x72b85[_0xde4c9a(0x202)](),'amount':_0x416611,'callback_url':_0xde4c9a(0x243),'client_merchant_id':this[_0xde4c9a(0x28b)],'client_transaction_id':_0x13f0ff,'transaction_description':_0x13f0ff,'customer':{'ip':_0x211563,'email':_0x5dc00f,'full_name':_0x16db00+'\x20'+_0x2b897b,'country':_0x18dd2f},'success_redirect_url':_0x389fba,'error_redirect_url':_0x516c51};console[_0xde4c9a(0x25b)](_0xde4c9a(0x27d),JSON[_0xde4c9a(0x239)](_0x32c2ee,null,0x2));const _0x5f5461=await fetch(this[_0xde4c9a(0x252)]+_0xde4c9a(0x229),{'method':_0xde4c9a(0x283),'headers':{'Content-Type':'application/json','User-Agent':'TrapayAPI/1.0'},'body':JSON[_0xde4c9a(0x239)](_0x32c2ee)}),_0x175fb5=await _0x5f5461[_0xde4c9a(0x25e)]();console['log'](_0xde4c9a(0x24f),_0x175fb5);if(!_0x5f5461['ok'])throw new Error(_0xde4c9a(0x216)+_0x5f5461[_0xde4c9a(0x21e)]+_0xde4c9a(0x277)+_0x175fb5);let _0x44ab4e;try{_0x44ab4e=JSON[_0xde4c9a(0x26e)](_0x175fb5);}catch(_0x4c50a0){throw new Error(_0xde4c9a(0x1ec)+_0x175fb5);}console[_0xde4c9a(0x25b)](_0xde4c9a(0x238),JSON[_0xde4c9a(0x239)](_0x44ab4e,null,0x2));if(!_0x44ab4e['redirect_url'])throw new Error(_0xde4c9a(0x27c)+(_0x44ab4e[_0xde4c9a(0x246)]||_0x44ab4e[_0xde4c9a(0x253)]||_0xde4c9a(0x237)));const _0x368030=_0x44ab4e[_0xde4c9a(0x21c)],_0x496928=_0x44ab4e['system_id'],_0x5854a5=_0x44ab4e[_0xde4c9a(0x259)];return console['log']('‚úÖ\x20AmPay\x20payment\x20link\x20created\x20successfully'),console[_0xde4c9a(0x25b)](_0xde4c9a(0x212),_0x368030),console[_0xde4c9a(0x25b)](_0xde4c9a(0x231),_0x496928),console['log']('Tracker\x20ID:',_0x5854a5),console[_0xde4c9a(0x25b)]('Status:',_0x44ab4e[_0xde4c9a(0x21e)]),console[_0xde4c9a(0x25b)]('üìù\x20Logging\x20AmPay\x20payment\x20creation\x20event...'),{'gateway_payment_id':_0x496928||_0x5854a5||_0x13f0ff,'payment_url':_0x368030||'','transaction_id':_0x496928};}catch(_0x3a3292){console[_0xde4c9a(0x272)](_0xde4c9a(0x1f4),_0x3a3292),console['log'](_0xde4c9a(0x275));throw _0x3a3292;}}async[a42_0x5a56cb(0x213)](){const _0x6685fa=a42_0x5a56cb;try{const _0x3b02a3=await fetch(this[_0x6685fa(0x252)]+_0x6685fa(0x24c),{'method':'GET','headers':{'Content-Type':_0x6685fa(0x211),'User-Agent':_0x6685fa(0x22f)}});return _0x3b02a3&&_0x3b02a3[_0x6685fa(0x21e)]===0xc8?!![]:![];}catch(_0x416007){return console[_0x6685fa(0x272)](_0x6685fa(0x26c),_0x416007),![];}}async[a42_0x5a56cb(0x250)](_0x55c9a7){const _0x1a66a2=a42_0x5a56cb;console[_0x1a66a2(0x25b)](_0x1a66a2(0x25d)),console[_0x1a66a2(0x25b)](_0x1a66a2(0x1ef)),console[_0x1a66a2(0x25b)]('Webhook\x20data:',_0x55c9a7),console[_0x1a66a2(0x25b)]('Webhook\x20data\x20type:',typeof _0x55c9a7),console['log'](_0x1a66a2(0x204));_0x55c9a7&&typeof _0x55c9a7===_0x1a66a2(0x235)&&Object[_0x1a66a2(0x28e)](_0x55c9a7)[_0x1a66a2(0x1f8)](_0x27d9b9=>{const _0x421851=_0x1a66a2;console[_0x421851(0x25b)]('\x20\x20'+_0x27d9b9+':\x20'+_0x55c9a7[_0x27d9b9]+'\x20('+typeof _0x55c9a7[_0x27d9b9]+')');});let _0x1d5ecc='PENDING';const _0x2d4834=_0x55c9a7[_0x1a66a2(0x269)]||_0x55c9a7[_0x1a66a2(0x293)]||_0x55c9a7['tracker_id']||'';return console[_0x1a66a2(0x25b)](_0x1a66a2(0x27a)+_0x2d4834),console['log'](_0x1a66a2(0x24d)+_0x1d5ecc),!_0x2d4834&&(console[_0x1a66a2(0x272)]('No\x20payment\x20ID\x20found\x20in\x20webhook\x20data'),console[_0x1a66a2(0x272)](_0x1a66a2(0x256))),{'paymentId':_0x2d4834,'status':_0x1d5ecc,'amount':_0x55c9a7[_0x1a66a2(0x232)],'currency':_0x55c9a7[_0x1a66a2(0x22c)]};}}exports[a42_0x5a56cb(0x274)]=AmPayService,exports[a42_0x5a56cb(0x203)]=new AmPayService();