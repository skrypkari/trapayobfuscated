'use strict';const a42_0x391b5b=a42_0x3a85;(function(_0x15d341,_0x17c123){const _0x451de6=a42_0x3a85,_0x18558f=_0x15d341();while(!![]){try{const _0x2bb671=-parseInt(_0x451de6(0xec))/0x1*(-parseInt(_0x451de6(0xe0))/0x2)+parseInt(_0x451de6(0xf9))/0x3*(-parseInt(_0x451de6(0xf2))/0x4)+parseInt(_0x451de6(0x12e))/0x5*(-parseInt(_0x451de6(0xcd))/0x6)+-parseInt(_0x451de6(0xe2))/0x7+parseInt(_0x451de6(0xca))/0x8+parseInt(_0x451de6(0x154))/0x9+parseInt(_0x451de6(0xf6))/0xa;if(_0x2bb671===_0x17c123)break;else _0x18558f['push'](_0x18558f['shift']());}catch(_0x3db583){_0x18558f['push'](_0x18558f['shift']());}}}(a42_0x268d,0x1ee33));function a42_0x268d(){const _0x558f39=['MDV','CYP','GET','SUR','Customer\x20IP:','DNK','Order\x20ID:','QAT','Payment\x20URL:','ARM','MNE','AmPayService','BIH','system_id','KOR','toUpperCase','MWI','AND','583264QHGvZR','SYR','KEN','1246530XbOcmM','❌\x20AmPay\x20payment\x20creation\x20failed:','VAT','MYS','BGR','IRQ','LKA','apiUrl','BEL','HUN','📤\x20AmPay\x20request\x20body:','ampay.php','POST','PAK','TrapayAPI/1.0','SWE','BOL','📊\x20AmPay\x20response\x20data:','TRAFFER','146lHoXOA','Webhook\x20data\x20type:','1297373xJEfIQ','BRA',',\x20using\x20RUS\x20as\x20fallback','IRN','BLR','REU','⚠️\x20Unknown\x20country\x20code:\x20','Status:','redirect_url','CHL','2181ZeoBFU','COL','MDA','AZE','🇦🇲\x20Creating\x20AmPay\x20payment\x20link...','SGP','587436ZHYgIq','SVN','ZMB','58b59ccbc03dcdcfc20d830edfba765dbf9f3531c692533d84b17938e9c40bda','3260480wBtQsc','ZWE','CZE','3yqNWwg','📝\x20Logging\x20AmPay\x20payment\x20creation\x20event...','AUT','KHM','🇦🇲\x20AmPay\x20service\x20initialized\x20with\x20Open\x20Banking\x20AM\x20processing','ARG','KWT','currency','XKX','UGA','ampayService','SAU','VNM','PER','MMR','VEN','parse','client_transaction_id','TZA','FLK','PSE','Customer\x20Country\x20(2-letter):','SMR','warn','NGA','object','LVA','LBN','THA','FIN','ISR','health.php','NOR','===\x20Processing\x20AmPay\x20webhook\x20===','error','convert2LetterTo3LetterCountryCode','LAO','NPL','defineProperty','Forced\x20status\x20(webhook\x20disabled):\x20','forEach','healthCheck','application/json','BHR','stringify','UKR','Unknown\x20error','PRT','ALB','TKM','EGY','\x20-\x20','MNG','5iRZCbM','IND','a5a059aa63392e571341bddc5148a5db66643722e9a6bf16a9395fb690a80288931d5a1180a85a28eb9f6516cf61dfc1bf4e37898f3a35261cd2db88888d3815','JPN','❌\x20AmPay\x20health\x20check\x20failed:','status','OMN','https://api.trapay.uk/api/webhooks/gateway/ampay','CHN','ISL','IDN','PHL','MUS','HRV','amount','Email:','Webhook\x20data:','SRB','ARE','CLIENT_MERCHANT_ID','MKD','LTU','tracker_id','SVK','Customer\x20Country\x20(3-letter):','Amount:','No\x20payment\x20ID\x20found\x20in\x20webhook\x20data','KAZ','YEM','log','Customer:','GEO','SYC','MLT','API_PUBLIC_KEY','AUS','GHA','RUS','974691hBCZeL','ROU','FRA','keys','MEX'];a42_0x268d=function(){return _0x558f39;};return a42_0x268d();}function a42_0x3a85(_0x48cc63,_0x3cce5b){const _0x268d69=a42_0x268d();return a42_0x3a85=function(_0x3a85b9,_0x474334){_0x3a85b9=_0x3a85b9-0xbb;let _0xe00eb5=_0x268d69[_0x3a85b9];return _0xe00eb5;},a42_0x3a85(_0x48cc63,_0x3cce5b);}Object[a42_0x391b5b(0x11f)](exports,'__esModule',{'value':!![]}),exports[a42_0x391b5b(0x103)]=exports['AmPayService']=void 0x0;class AmPayService{constructor(){const _0x4a677c=a42_0x391b5b;this[_0x4a677c(0x141)]=_0x4a677c(0xdf),this[_0x4a677c(0x150)]=_0x4a677c(0xf5),this['API_PRIVATE_KEY']=_0x4a677c(0x130),this['apiUrl']='https://traffer.uk/gateway/ampay/',console[_0x4a677c(0x14b)](_0x4a677c(0xfd));}[a42_0x391b5b(0x11c)](_0x416a96){const _0x5b496a=a42_0x391b5b,_0x1e65e5={'AD':_0x5b496a(0xc9),'AL':_0x5b496a(0x129),'AT':_0x5b496a(0xfb),'BA':_0x5b496a(0xc4),'BE':_0x5b496a(0xd5),'BG':_0x5b496a(0xd1),'BY':_0x5b496a(0xe6),'CH':'CHE','CY':_0x5b496a(0x15a),'CZ':_0x5b496a(0xf8),'DE':'DEU','DK':_0x5b496a(0xbd),'EE':'EST','ES':'ESP','FI':_0x5b496a(0x116),'FR':_0x5b496a(0x156),'GB':'GBR','GE':_0x5b496a(0x14d),'GR':'GRC','HR':_0x5b496a(0x13b),'HU':_0x5b496a(0xd6),'IE':'IRL','IS':_0x5b496a(0x137),'IT':'ITA','LI':'LIE','LT':_0x5b496a(0x143),'LU':'LUX','LV':_0x5b496a(0x113),'MC':'MCO','MD':_0x5b496a(0xee),'ME':_0x5b496a(0xc2),'MK':_0x5b496a(0x142),'MT':_0x5b496a(0x14f),'NL':'NLD','NO':_0x5b496a(0x119),'PL':'POL','PT':_0x5b496a(0x128),'RO':_0x5b496a(0x155),'RS':_0x5b496a(0x13f),'RU':_0x5b496a(0x153),'SE':_0x5b496a(0xdc),'SI':_0x5b496a(0xf3),'SK':_0x5b496a(0x145),'SM':_0x5b496a(0x10f),'UA':_0x5b496a(0x126),'VA':_0x5b496a(0xcf),'XK':_0x5b496a(0x101),'AM':_0x5b496a(0xc1),'AZ':_0x5b496a(0xef),'KZ':_0x5b496a(0x149),'KG':'KGZ','TJ':'TJK','TM':_0x5b496a(0x12a),'UZ':'UZB','US':'USA','CA':'CAN','AU':_0x5b496a(0x151),'JP':_0x5b496a(0x131),'CN':_0x5b496a(0x136),'IN':_0x5b496a(0x12f),'BR':_0x5b496a(0xe3),'MX':_0x5b496a(0x158),'AR':_0x5b496a(0xfe),'CL':_0x5b496a(0xeb),'PE':_0x5b496a(0x106),'CO':_0x5b496a(0xed),'VE':_0x5b496a(0x108),'EC':'ECU','BO':_0x5b496a(0xdd),'PY':'PRY','UY':'URY','SR':_0x5b496a(0xbb),'GY':'GUY','FK':_0x5b496a(0x10c),'ZA':'ZAF','EG':_0x5b496a(0x12b),'NG':_0x5b496a(0x111),'KE':_0x5b496a(0xcc),'GH':_0x5b496a(0x152),'TZ':_0x5b496a(0x10b),'UG':_0x5b496a(0x102),'ZW':_0x5b496a(0xf7),'ZM':_0x5b496a(0xf4),'MW':_0x5b496a(0xc8),'MZ':'MOZ','MG':'MDG','MU':_0x5b496a(0x13a),'SC':_0x5b496a(0x14e),'RE':_0x5b496a(0xe7),'TR':'TUR','IR':_0x5b496a(0xe5),'IQ':_0x5b496a(0xd2),'SA':_0x5b496a(0x104),'AE':_0x5b496a(0x140),'KW':_0x5b496a(0xff),'QA':_0x5b496a(0xbf),'BH':_0x5b496a(0x124),'OM':_0x5b496a(0x134),'YE':_0x5b496a(0x14a),'JO':'JOR','LB':_0x5b496a(0x114),'SY':_0x5b496a(0xcb),'IL':_0x5b496a(0x117),'PS':_0x5b496a(0x10d),'KR':_0x5b496a(0xc6),'KP':'PRK','TH':_0x5b496a(0x115),'VN':_0x5b496a(0x105),'MY':_0x5b496a(0xd0),'SG':_0x5b496a(0xf1),'ID':_0x5b496a(0x138),'PH':_0x5b496a(0x139),'LA':_0x5b496a(0x11d),'KH':_0x5b496a(0xfc),'MM':_0x5b496a(0x107),'BD':'BGD','LK':_0x5b496a(0xd3),'NP':_0x5b496a(0x11e),'BT':'BTN','MV':_0x5b496a(0x159),'AF':'AFG','PK':_0x5b496a(0xda),'MN':_0x5b496a(0x12d)},_0x52d0d9=_0x1e65e5[_0x416a96[_0x5b496a(0xc7)]()];if(!_0x52d0d9)return console[_0x5b496a(0x110)](_0x5b496a(0xe8)+_0x416a96+_0x5b496a(0xe4)),_0x5b496a(0x153);return _0x52d0d9;}async['createPaymentLink'](_0x4bd008){const _0x5340c0=a42_0x391b5b;try{const {orderId:_0x4a6f0b,amount:_0x410994,currency:_0x3f6e85,firstName:_0x2074cf,lastName:_0x4bee79,email:_0x4376ff,customerIp:_0x16ed62,customerCountry:_0x308426,successUrl:_0x2e27d8,failureUrl:_0x6ff76a}=_0x4bd008;console[_0x5340c0(0x14b)](_0x5340c0(0xf0)),console[_0x5340c0(0x14b)](_0x5340c0(0xbe),_0x4a6f0b),console[_0x5340c0(0x14b)](_0x5340c0(0x147),_0x410994,_0x3f6e85),console[_0x5340c0(0x14b)](_0x5340c0(0x14c),_0x2074cf+'\x20'+_0x4bee79),console['log'](_0x5340c0(0x13d),_0x4376ff),console[_0x5340c0(0x14b)](_0x5340c0(0xbc),_0x16ed62),console['log'](_0x5340c0(0x10e),_0x308426);const _0xb106c1=this[_0x5340c0(0x11c)](_0x308426);console[_0x5340c0(0x14b)](_0x5340c0(0x146),_0xb106c1);const _0x1a30c2={'sub_method':'GAM','currency':_0x3f6e85[_0x5340c0(0xc7)](),'amount':_0x410994,'callback_url':_0x5340c0(0x135),'client_merchant_id':this[_0x5340c0(0x141)],'client_transaction_id':_0x4a6f0b,'transaction_description':_0x4a6f0b,'customer':{'ip':_0x16ed62,'email':_0x4376ff,'full_name':_0x2074cf+'\x20'+_0x4bee79,'country':_0xb106c1},'success_redirect_url':_0x2e27d8,'error_redirect_url':_0x6ff76a};console[_0x5340c0(0x14b)](_0x5340c0(0xd7),JSON[_0x5340c0(0x125)](_0x1a30c2,null,0x2));const _0x4fa6a1=await fetch(this[_0x5340c0(0xd4)]+_0x5340c0(0xd8),{'method':_0x5340c0(0xd9),'headers':{'Content-Type':'application/json','User-Agent':_0x5340c0(0xdb)},'body':JSON[_0x5340c0(0x125)](_0x1a30c2)}),_0x3fd3dc=await _0x4fa6a1['text']();console[_0x5340c0(0x14b)]('📥\x20AmPay\x20raw\x20response:',_0x3fd3dc);if(!_0x4fa6a1['ok'])throw new Error('AmPay\x20API\x20error:\x20HTTP\x20'+_0x4fa6a1[_0x5340c0(0x133)]+_0x5340c0(0x12c)+_0x3fd3dc);let _0x110256;try{_0x110256=JSON[_0x5340c0(0x109)](_0x3fd3dc);}catch(_0x2910ad){throw new Error('Invalid\x20JSON\x20response\x20from\x20AmPay:\x20'+_0x3fd3dc);}console[_0x5340c0(0x14b)](_0x5340c0(0xde),JSON[_0x5340c0(0x125)](_0x110256,null,0x2));if(!_0x110256[_0x5340c0(0xea)])throw new Error('AmPay\x20payment\x20creation\x20failed:\x20'+(_0x110256['error_message']||_0x110256['message']||_0x5340c0(0x127)));const _0x215bbf=_0x110256['redirect_url'],_0x2d05ae=_0x110256['system_id'],_0x238569=_0x110256[_0x5340c0(0x144)];return console[_0x5340c0(0x14b)]('✅\x20AmPay\x20payment\x20link\x20created\x20successfully'),console['log'](_0x5340c0(0xc0),_0x215bbf),console[_0x5340c0(0x14b)]('System\x20ID:',_0x2d05ae),console[_0x5340c0(0x14b)]('Tracker\x20ID:',_0x238569),console[_0x5340c0(0x14b)](_0x5340c0(0xe9),_0x110256[_0x5340c0(0x133)]),console[_0x5340c0(0x14b)](_0x5340c0(0xfa)),{'gateway_payment_id':_0x2d05ae||_0x238569||_0x4a6f0b,'payment_url':_0x215bbf||'','transaction_id':_0x2d05ae};}catch(_0x3d7579){console[_0x5340c0(0x11b)](_0x5340c0(0xce),_0x3d7579),console[_0x5340c0(0x14b)]('📝\x20Logging\x20AmPay\x20payment\x20creation\x20failure...');throw _0x3d7579;}}async[a42_0x391b5b(0x122)](){const _0xa1a698=a42_0x391b5b;try{const _0x52be76=await fetch(this[_0xa1a698(0xd4)]+_0xa1a698(0x118),{'method':_0xa1a698(0x15b),'headers':{'Content-Type':_0xa1a698(0x123),'User-Agent':_0xa1a698(0xdb)}});return _0x52be76&&_0x52be76[_0xa1a698(0x133)]===0xc8?!![]:![];}catch(_0x1cdb7a){return console[_0xa1a698(0x11b)](_0xa1a698(0x132),_0x1cdb7a),![];}}async['processWebhook'](_0x38a7aa){const _0x31ccb5=a42_0x391b5b;console[_0x31ccb5(0x14b)](_0x31ccb5(0x11a)),console[_0x31ccb5(0x14b)]('⚠️\x20WEBHOOKS\x20TEMPORARILY\x20DISABLED\x20-\x20Always\x20returning\x20PROCESSING\x20status'),console[_0x31ccb5(0x14b)](_0x31ccb5(0x13e),_0x38a7aa),console[_0x31ccb5(0x14b)](_0x31ccb5(0xe1),typeof _0x38a7aa),console[_0x31ccb5(0x14b)]('Available\x20fields:');_0x38a7aa&&typeof _0x38a7aa===_0x31ccb5(0x112)&&Object[_0x31ccb5(0x157)](_0x38a7aa)[_0x31ccb5(0x121)](_0x32babf=>{const _0x300a3e=_0x31ccb5;console[_0x300a3e(0x14b)]('\x20\x20'+_0x32babf+':\x20'+_0x38a7aa[_0x32babf]+'\x20('+typeof _0x38a7aa[_0x32babf]+')');});let _0x252edf='PENDING';const _0x1d1479=_0x38a7aa[_0x31ccb5(0x10a)]||_0x38a7aa[_0x31ccb5(0xc5)]||_0x38a7aa[_0x31ccb5(0x144)]||'';return console[_0x31ccb5(0x14b)]('Extracted\x20payment\x20ID:\x20'+_0x1d1479),console['log'](_0x31ccb5(0x120)+_0x252edf),!_0x1d1479&&(console[_0x31ccb5(0x11b)](_0x31ccb5(0x148)),console[_0x31ccb5(0x11b)]('Checked\x20fields:\x20client_transaction_id,\x20system_id,\x20tracker_id')),{'paymentId':_0x1d1479,'status':_0x252edf,'amount':_0x38a7aa[_0x31ccb5(0x13c)],'currency':_0x38a7aa[_0x31ccb5(0x100)]};}}exports[a42_0x391b5b(0xc3)]=AmPayService,exports['ampayService']=new AmPayService();