'use strict';function a62_0x5200(){const _0x4189d3=['BEL','VNM','XKX','1034233mHqeYP','FLK','ðŸ“\x20Logging\x20AmPay\x20payment\x20creation\x20failure...','DEU','Extracted\x20payment\x20ID:\x20','252780mpzJEB','342wtQKBH','ARE','LBN','4222064XQseDS','MCO','Customer\x20Country\x20(2-letter):','MNG','ampayService','convert2LetterTo3LetterCountryCode','TZA','TrapayAPI/1.0','77KBwOmP','API_PRIVATE_KEY','MUS','https://traffer.uk/gateway/ampay/','IRN','VEN','QAT','ROU','ðŸ“¥\x20AmPay\x20raw\x20response:','UGA','THA','SYR','ðŸ“Š\x20AmPay\x20response\x20data:','102852KFzLMf','PRK','LTU','MOZ','\x20-\x20','NPL','BLR','toUpperCase','EGY','LAO','BHR','SRB','AUT','TUR','BGD','application/json','CZE','SGP','AND','MLT','UZB','CLIENT_MERCHANT_ID','LIE','MDA','AmPayService','GHA','âŒ\x20AmPay\x20payment\x20creation\x20failed:','RUS','system_id','IDN','status','CAN','AUS','client_transaction_id','No\x20payment\x20ID\x20found\x20in\x20webhook\x20data','PSE','ðŸ“¤\x20AmPay\x20request\x20body:','VAT','2685000bUYFOW','ALB','MEX','PER','192155fvaliK','IRL','PHL','MMR','âš ï¸\x20Unknown\x20country\x20code:\x20','Order\x20ID:','Forced\x20status\x20(webhook\x20disabled):\x20','MKD','Status:','forEach','Customer\x20IP:','System\x20ID:','redirect_url','KOR','MNE','ARM','warn','MDV','ampay.php','amount','ESP','IRQ','TKM','KEN','POL','GEO','1491096vDmaxx','HRV','ðŸ‡¦ðŸ‡²\x20Creating\x20AmPay\x20payment\x20link...','Checked\x20fields:\x20client_transaction_id,\x20system_id,\x20tracker_id','KHM','TJK','BGR','LUX','PRY','FIN','CYP','DNK','SMR','URY','JPN','Amount:','CHL','Unknown\x20error','GRC','tracker_id','stringify','https://traffer.uk/gateway/ampay/webhook.php','object','createPaymentLink','AmPay\x20payment\x20creation\x20failed:\x20','apiUrl','IND','SUR','USA','ZWE','YEM','LKA','2rSBAQk','log','Customer\x20Country\x20(3-letter):','NOR','text','a5a059aa63392e571341bddc5148a5db66643722e9a6bf16a9395fb690a80288931d5a1180a85a28eb9f6516cf61dfc1bf4e37898f3a35261cd2db88888d3815','90NXrHuf','BRA','PENDING','message','Webhook\x20data:','ARG','BTN','SYC','API_PUBLIC_KEY','error','ITA','68DaajLD','SAU','âœ…\x20AmPay\x20payment\x20link\x20created\x20successfully','CHN','PRT','SVN','REU','JOR','CHE','Payment\x20URL:','BOL','KAZ','GUY'];a62_0x5200=function(){return _0x4189d3;};return a62_0x5200();}function a62_0xa815(_0xb56227,_0x226768){_0xb56227=_0xb56227-0x74;const _0x52008e=a62_0x5200();let _0xa81586=_0x52008e[_0xb56227];return _0xa81586;}const a62_0x5a4c8b=a62_0xa815;(function(_0x26c32a,_0x45d268){const _0x46b2ce=a62_0xa815,_0x47b121=_0x26c32a();while(!![]){try{const _0x1a3371=parseInt(_0x46b2ce(0xbb))/0x1*(parseInt(_0x46b2ce(0x9a))/0x2)+parseInt(_0x46b2ce(0xd9))/0x3*(-parseInt(_0x46b2ce(0xab))/0x4)+-parseInt(_0x46b2ce(0x103))/0x5*(-parseInt(_0x46b2ce(0xa0))/0x6)+-parseInt(_0x46b2ce(0xc4))/0x7+parseInt(_0x46b2ce(0xff))/0x8+-parseInt(_0x46b2ce(0xc1))/0x9*(parseInt(_0x46b2ce(0xc0))/0xa)+parseInt(_0x46b2ce(0xcc))/0xb*(parseInt(_0x46b2ce(0x7a))/0xc);if(_0x1a3371===_0x45d268)break;else _0x47b121['push'](_0x47b121['shift']());}catch(_0x3f424c){_0x47b121['push'](_0x47b121['shift']());}}}(a62_0x5200,0xa3791));Object['defineProperty'](exports,'__esModule',{'value':!![]}),exports['ampayService']=exports[a62_0x5a4c8b(0xf1)]=void 0x0;class AmPayService{constructor(){const _0x3333bc=a62_0x5a4c8b;this[_0x3333bc(0xee)]='TRAFFER',this[_0x3333bc(0xa8)]='58b59ccbc03dcdcfc20d830edfba765dbf9f3531c692533d84b17938e9c40bda',this[_0x3333bc(0xcd)]=_0x3333bc(0x9f),this[_0x3333bc(0x93)]=_0x3333bc(0xcf),console[_0x3333bc(0x9b)]('ðŸ‡¦ðŸ‡²\x20AmPay\x20service\x20initialized\x20with\x20Open\x20Banking\x20AM\x20processing');}[a62_0x5a4c8b(0xc9)](_0x583d96){const _0xe166a4=a62_0x5a4c8b,_0x4b662b={'AD':_0xe166a4(0xeb),'AL':_0xe166a4(0x100),'AT':_0xe166a4(0xe5),'BA':'BIH','BE':_0xe166a4(0xb8),'BG':_0xe166a4(0x80),'BY':_0xe166a4(0xdf),'CH':_0xe166a4(0xb3),'CY':_0xe166a4(0x84),'CZ':_0xe166a4(0xe9),'DE':_0xe166a4(0xbe),'DK':_0xe166a4(0x85),'EE':'EST','ES':_0xe166a4(0x74),'FI':_0xe166a4(0x83),'FR':'FRA','GB':'GBR','GE':_0xe166a4(0x79),'GR':_0xe166a4(0x8c),'HR':_0xe166a4(0x7b),'HU':'HUN','IE':_0xe166a4(0x104),'IS':'ISL','IT':_0xe166a4(0xaa),'LI':_0xe166a4(0xef),'LT':_0xe166a4(0xdb),'LU':_0xe166a4(0x81),'LV':'LVA','MC':_0xe166a4(0xc5),'MD':_0xe166a4(0xf0),'ME':_0xe166a4(0x111),'MK':_0xe166a4(0x10a),'MT':_0xe166a4(0xec),'NL':'NLD','NO':_0xe166a4(0x9d),'PL':_0xe166a4(0x78),'PT':_0xe166a4(0xaf),'RO':_0xe166a4(0xd3),'RS':_0xe166a4(0xe4),'RU':'RUS','SE':'SWE','SI':_0xe166a4(0xb0),'SK':'SVK','SM':_0xe166a4(0x86),'UA':'UKR','VA':_0xe166a4(0xfe),'XK':_0xe166a4(0xba),'AM':_0xe166a4(0x112),'AZ':'AZE','KZ':_0xe166a4(0xb6),'KG':'KGZ','TJ':_0xe166a4(0x7f),'TM':_0xe166a4(0x76),'UZ':_0xe166a4(0xed),'US':_0xe166a4(0x96),'CA':_0xe166a4(0xf8),'AU':_0xe166a4(0xf9),'JP':_0xe166a4(0x88),'CN':_0xe166a4(0xae),'IN':_0xe166a4(0x94),'BR':_0xe166a4(0xa1),'MX':_0xe166a4(0x101),'AR':_0xe166a4(0xa5),'CL':_0xe166a4(0x8a),'PE':_0xe166a4(0x102),'CO':'COL','VE':_0xe166a4(0xd1),'EC':'ECU','BO':_0xe166a4(0xb5),'PY':_0xe166a4(0x82),'UY':_0xe166a4(0x87),'SR':_0xe166a4(0x95),'GY':_0xe166a4(0xb7),'FK':_0xe166a4(0xbc),'ZA':'ZAF','EG':_0xe166a4(0xe1),'NG':'NGA','KE':_0xe166a4(0x77),'GH':_0xe166a4(0xf2),'TZ':_0xe166a4(0xca),'UG':_0xe166a4(0xd5),'ZW':_0xe166a4(0x97),'ZM':'ZMB','MW':'MWI','MZ':_0xe166a4(0xdc),'MG':'MDG','MU':_0xe166a4(0xce),'SC':_0xe166a4(0xa7),'RE':_0xe166a4(0xb1),'TR':_0xe166a4(0xe6),'IR':_0xe166a4(0xd0),'IQ':_0xe166a4(0x75),'SA':_0xe166a4(0xac),'AE':_0xe166a4(0xc2),'KW':'KWT','QA':_0xe166a4(0xd2),'BH':_0xe166a4(0xe3),'OM':'OMN','YE':_0xe166a4(0x98),'JO':_0xe166a4(0xb2),'LB':_0xe166a4(0xc3),'SY':_0xe166a4(0xd7),'IL':'ISR','PS':_0xe166a4(0xfc),'KR':_0xe166a4(0x110),'KP':_0xe166a4(0xda),'TH':_0xe166a4(0xd6),'VN':_0xe166a4(0xb9),'MY':'MYS','SG':_0xe166a4(0xea),'ID':_0xe166a4(0xf6),'PH':_0xe166a4(0x105),'LA':_0xe166a4(0xe2),'KH':_0xe166a4(0x7e),'MM':_0xe166a4(0x106),'BD':_0xe166a4(0xe7),'LK':_0xe166a4(0x99),'NP':_0xe166a4(0xde),'BT':_0xe166a4(0xa6),'MV':_0xe166a4(0x114),'AF':'AFG','PK':'PAK','MN':_0xe166a4(0xc7)},_0x3c7d4d=_0x4b662b[_0x583d96[_0xe166a4(0xe0)]()];if(!_0x3c7d4d)return console[_0xe166a4(0x113)](_0xe166a4(0x107)+_0x583d96+',\x20using\x20RUS\x20as\x20fallback'),_0xe166a4(0xf4);return _0x3c7d4d;}async[a62_0x5a4c8b(0x91)](_0x3bc0db){const _0x9f6a4=a62_0x5a4c8b;try{const {orderId:_0x165c29,amount:_0x2f7795,currency:_0x2fc1d9,firstName:_0x1e49fd,lastName:_0x52cdab,email:_0x110d48,customerIp:_0x14912c,customerCountry:_0x4c55be,successUrl:_0x23bb01,failureUrl:_0x943274}=_0x3bc0db;console[_0x9f6a4(0x9b)](_0x9f6a4(0x7c)),console[_0x9f6a4(0x9b)](_0x9f6a4(0x108),_0x165c29),console[_0x9f6a4(0x9b)](_0x9f6a4(0x89),_0x2f7795,_0x2fc1d9),console['log']('Customer:',_0x1e49fd+'\x20'+_0x52cdab),console[_0x9f6a4(0x9b)]('Email:',_0x110d48),console[_0x9f6a4(0x9b)](_0x9f6a4(0x10d),_0x14912c),console[_0x9f6a4(0x9b)](_0x9f6a4(0xc6),_0x4c55be);const _0x51e0b1=this[_0x9f6a4(0xc9)](_0x4c55be);console[_0x9f6a4(0x9b)](_0x9f6a4(0x9c),_0x51e0b1);const _0x186953={'sub_method':'GAM','currency':_0x2fc1d9[_0x9f6a4(0xe0)](),'amount':_0x2f7795,'callback_url':_0x9f6a4(0x8f),'client_merchant_id':this[_0x9f6a4(0xee)],'client_transaction_id':_0x165c29,'transaction_description':_0x165c29,'customer':{'ip':_0x14912c,'email':_0x110d48,'full_name':_0x1e49fd+'\x20'+_0x52cdab,'country':_0x51e0b1},'success_redirect_url':_0x23bb01,'error_redirect_url':_0x943274};console[_0x9f6a4(0x9b)](_0x9f6a4(0xfd),JSON[_0x9f6a4(0x8e)](_0x186953,null,0x2));const _0x32ebbf=await fetch(this[_0x9f6a4(0x93)]+_0x9f6a4(0x115),{'method':'POST','headers':{'Content-Type':_0x9f6a4(0xe8),'User-Agent':_0x9f6a4(0xcb)},'body':JSON[_0x9f6a4(0x8e)](_0x186953)}),_0x597353=await _0x32ebbf[_0x9f6a4(0x9e)]();console[_0x9f6a4(0x9b)](_0x9f6a4(0xd4),_0x597353);if(!_0x32ebbf['ok'])throw new Error('AmPay\x20API\x20error:\x20HTTP\x20'+_0x32ebbf[_0x9f6a4(0xf7)]+_0x9f6a4(0xdd)+_0x597353);let _0x21ee35;try{_0x21ee35=JSON['parse'](_0x597353);}catch(_0x396097){throw new Error('Invalid\x20JSON\x20response\x20from\x20AmPay:\x20'+_0x597353);}console[_0x9f6a4(0x9b)](_0x9f6a4(0xd8),JSON[_0x9f6a4(0x8e)](_0x21ee35,null,0x2));if(!_0x21ee35[_0x9f6a4(0x10f)])throw new Error(_0x9f6a4(0x92)+(_0x21ee35['error_message']||_0x21ee35[_0x9f6a4(0xa3)]||_0x9f6a4(0x8b)));const _0x7b11bf=_0x21ee35[_0x9f6a4(0x10f)],_0x9d770=_0x21ee35['system_id'],_0x1b1af1=_0x21ee35[_0x9f6a4(0x8d)];return console[_0x9f6a4(0x9b)](_0x9f6a4(0xad)),console['log'](_0x9f6a4(0xb4),_0x7b11bf),console['log'](_0x9f6a4(0x10e),_0x9d770),console['log']('Tracker\x20ID:',_0x1b1af1),console[_0x9f6a4(0x9b)](_0x9f6a4(0x10b),_0x21ee35[_0x9f6a4(0xf7)]),console[_0x9f6a4(0x9b)]('ðŸ“\x20Logging\x20AmPay\x20payment\x20creation\x20event...'),{'gateway_payment_id':_0x9d770||_0x1b1af1||_0x165c29,'payment_url':_0x7b11bf||'','transaction_id':_0x9d770};}catch(_0x3612ee){console[_0x9f6a4(0xa9)](_0x9f6a4(0xf3),_0x3612ee),console['log'](_0x9f6a4(0xbd));throw _0x3612ee;}}async['healthCheck'](){const _0x349ab6=a62_0x5a4c8b;try{const _0x195e74=await fetch(this['apiUrl']+'health.php',{'method':'GET','headers':{'Content-Type':_0x349ab6(0xe8),'User-Agent':_0x349ab6(0xcb)}});return _0x195e74&&_0x195e74[_0x349ab6(0xf7)]===0xc8?!![]:![];}catch(_0x1df9e6){return console[_0x349ab6(0xa9)]('âŒ\x20AmPay\x20health\x20check\x20failed:',_0x1df9e6),![];}}async['processWebhook'](_0x458309){const _0x4f67ae=a62_0x5a4c8b;console[_0x4f67ae(0x9b)]('===\x20Processing\x20AmPay\x20webhook\x20==='),console['log']('âš ï¸\x20WEBHOOKS\x20TEMPORARILY\x20DISABLED\x20-\x20Always\x20returning\x20PROCESSING\x20status'),console[_0x4f67ae(0x9b)](_0x4f67ae(0xa4),_0x458309),console[_0x4f67ae(0x9b)]('Webhook\x20data\x20type:',typeof _0x458309),console[_0x4f67ae(0x9b)]('Available\x20fields:');_0x458309&&typeof _0x458309===_0x4f67ae(0x90)&&Object['keys'](_0x458309)[_0x4f67ae(0x10c)](_0x3bd4ad=>{const _0x49b872=_0x4f67ae;console[_0x49b872(0x9b)]('\x20\x20'+_0x3bd4ad+':\x20'+_0x458309[_0x3bd4ad]+'\x20('+typeof _0x458309[_0x3bd4ad]+')');});let _0x1afbaf=_0x4f67ae(0xa2);const _0x2a906b=_0x458309[_0x4f67ae(0xfa)]||_0x458309[_0x4f67ae(0xf5)]||_0x458309['tracker_id']||'';return console[_0x4f67ae(0x9b)](_0x4f67ae(0xbf)+_0x2a906b),console['log'](_0x4f67ae(0x109)+_0x1afbaf),!_0x2a906b&&(console['error'](_0x4f67ae(0xfb)),console['error'](_0x4f67ae(0x7d))),{'paymentId':_0x2a906b,'status':_0x1afbaf,'amount':_0x458309[_0x4f67ae(0x116)],'currency':_0x458309['currency']};}}exports[a62_0x5a4c8b(0xf1)]=AmPayService,exports[a62_0x5a4c8b(0xc8)]=new AmPayService();