'use strict';function a52_0x5944(){const _0x404f96=['LUX','redirect_url','MOZ','COL','TrapayAPI/1.0','SRB','Amount:','toUpperCase','MMR','âš ï¸\x20WEBHOOKS\x20TEMPORARILY\x20DISABLED\x20-\x20Always\x20returning\x20PROCESSING\x20status','ESP','14445SqSLGs','Email:','58b59ccbc03dcdcfc20d830edfba765dbf9f3531c692533d84b17938e9c40bda','MNG','error','ðŸ“Š\x20AmPay\x20response\x20data:','TJK','467NfsMUc','Tracker\x20ID:','âš ï¸\x20Unknown\x20country\x20code:\x20','NGA','LTU','message','ISR','1120EoWbpr','BEL','BHR','CYP','CAN','13972EkilVo','MDA','object','318KFSDLk','2442398VIuWlX','GHA','SVK','LAO','SYR','MYS','GBR','currency','Forced\x20status\x20(webhook\x20disabled):\x20','TKM','ðŸ‡¦ðŸ‡²\x20AmPay\x20service\x20initialized\x20with\x20Open\x20Banking\x20AM\x20processing','AUS','ROU','ISL','HUN','CLIENT_MERCHANT_ID','Invalid\x20JSON\x20response\x20from\x20AmPay:\x20','ampay.php','Webhook\x20data\x20type:','SVN','AmPay\x20API\x20error:\x20HTTP\x20','MNE','REU','MDG','AFG','tracker_id','stringify','VEN','ITA','apiUrl','Checked\x20fields:\x20client_transaction_id,\x20system_id,\x20tracker_id','ðŸ“\x20Logging\x20AmPay\x20payment\x20creation\x20event...','keys','NPL','MCO','VAT','PER','Order\x20ID:','ðŸ“¤\x20AmPay\x20request\x20body:','1074215rYbdie','AmPayService','1398Tlhqtl','DEU','KOR','AUT','FRA','385PCWZGC','convert2LetterTo3LetterCountryCode','IRQ','194148OKvbgN','API_PRIVATE_KEY','log','21346312JxlZxr','Customer\x20Country\x20(2-letter):','ZAF','KEN','amount','BIH','GAM','CHN','BTN','PAK','OMN','BRA','healthCheck','MEX','IRL','PSE','status','warn','DNK','IND','UKR','GEO','Status:','TRAFFER','SYC','health.php','CZE','ampayService','https://traffer.uk/gateway/ampay/','Customer\x20IP:','application/json','API_PUBLIC_KEY','CHL','ARE','EGY','LIE','ALB','18cvHkhs','SWE','System\x20ID:','VNM','URY','Payment\x20URL:',',\x20using\x20RUS\x20as\x20fallback','PRY','AmPay\x20payment\x20creation\x20failed:\x20','ðŸ“\x20Logging\x20AmPay\x20payment\x20creation\x20failure...','parse','===\x20Processing\x20AmPay\x20webhook\x20===','POL','THA','Extracted\x20payment\x20ID:\x20','client_transaction_id','BOL','GET','AZE','ZMB','Customer\x20Country\x20(3-letter):','ARG','text','KWT','HRV','PRK','ZWE','forEach','PENDING','No\x20payment\x20ID\x20found\x20in\x20webhook\x20data','KAZ','XKX','RUS','NOR','Webhook\x20data:','SMR','IDN','âœ…\x20AmPay\x20payment\x20link\x20created\x20successfully','8KkZhiU','system_id','ðŸ‡¦ðŸ‡²\x20Creating\x20AmPay\x20payment\x20link...','AND','MKD','BGR','TUR','MDV','Unknown\x20error'];a52_0x5944=function(){return _0x404f96;};return a52_0x5944();}const a52_0xd6fef0=a52_0x4737;function a52_0x4737(_0xa95e7c,_0x457988){_0xa95e7c=_0xa95e7c-0xbc;const _0x5944bd=a52_0x5944();let _0x47370f=_0x5944bd[_0xa95e7c];return _0x47370f;}(function(_0xef53b9,_0x448734){const _0x4f9171=a52_0x4737,_0x52052f=_0xef53b9();while(!![]){try{const _0x28b0fa=-parseInt(_0x4f9171(0xc5))/0x1*(-parseInt(_0x4f9171(0xfe))/0x2)+parseInt(_0x4f9171(0xd4))/0x3*(parseInt(_0x4f9171(0xd1))/0x4)+-parseInt(_0x4f9171(0xfc))/0x5*(-parseInt(_0x4f9171(0x12e))/0x6)+parseInt(_0x4f9171(0xd5))/0x7*(parseInt(_0x4f9171(0x154))/0x8)+-parseInt(_0x4f9171(0xbe))/0x9*(parseInt(_0x4f9171(0xcc))/0xa)+-parseInt(_0x4f9171(0x103))/0xb*(-parseInt(_0x4f9171(0x106))/0xc)+-parseInt(_0x4f9171(0x109))/0xd;if(_0x28b0fa===_0x448734)break;else _0x52052f['push'](_0x52052f['shift']());}catch(_0x260b0b){_0x52052f['push'](_0x52052f['shift']());}}}(a52_0x5944,0x6a1b7));Object['defineProperty'](exports,'__esModule',{'value':!![]}),exports[a52_0xd6fef0(0x124)]=exports[a52_0xd6fef0(0xfd)]=void 0x0;class AmPayService{constructor(){const _0x373289=a52_0xd6fef0;this[_0x373289(0xe4)]=_0x373289(0x120),this[_0x373289(0x128)]=_0x373289(0xc0),this[_0x373289(0x107)]='a5a059aa63392e571341bddc5148a5db66643722e9a6bf16a9395fb690a80288931d5a1180a85a28eb9f6516cf61dfc1bf4e37898f3a35261cd2db88888d3815',this[_0x373289(0xf2)]=_0x373289(0x125),console[_0x373289(0x108)](_0x373289(0xdf));}[a52_0xd6fef0(0x104)](_0x22477d){const _0x15ebb9=a52_0xd6fef0,_0x4a1b4b={'AD':_0x15ebb9(0x157),'AL':_0x15ebb9(0x12d),'AT':_0x15ebb9(0x101),'BA':_0x15ebb9(0x10e),'BE':_0x15ebb9(0xcd),'BG':_0x15ebb9(0x159),'BY':'BLR','CH':'CHE','CY':_0x15ebb9(0xcf),'CZ':_0x15ebb9(0x123),'DE':_0x15ebb9(0xff),'DK':_0x15ebb9(0x11b),'EE':'EST','ES':_0x15ebb9(0xbd),'FI':'FIN','FR':_0x15ebb9(0x102),'GB':_0x15ebb9(0xdb),'GE':_0x15ebb9(0x11e),'GR':'GRC','HR':_0x15ebb9(0x146),'HU':_0x15ebb9(0xe3),'IE':_0x15ebb9(0x117),'IS':_0x15ebb9(0xe2),'IT':_0x15ebb9(0xf1),'LI':_0x15ebb9(0x12c),'LT':_0x15ebb9(0xc9),'LU':_0x15ebb9(0x15d),'LV':'LVA','MC':_0x15ebb9(0xf7),'MD':_0x15ebb9(0xd2),'ME':_0x15ebb9(0xea),'MK':_0x15ebb9(0x158),'MT':'MLT','NL':'NLD','NO':_0x15ebb9(0x14f),'PL':_0x15ebb9(0x13a),'PT':'PRT','RO':_0x15ebb9(0xe1),'RS':_0x15ebb9(0x162),'RU':'RUS','SE':_0x15ebb9(0x12f),'SI':_0x15ebb9(0xe8),'SK':_0x15ebb9(0xd7),'SM':_0x15ebb9(0x151),'UA':_0x15ebb9(0x11d),'VA':_0x15ebb9(0xf8),'XK':_0x15ebb9(0x14d),'AM':'ARM','AZ':_0x15ebb9(0x140),'KZ':_0x15ebb9(0x14c),'KG':'KGZ','TJ':_0x15ebb9(0xc4),'TM':_0x15ebb9(0xde),'UZ':'UZB','US':'USA','CA':_0x15ebb9(0xd0),'AU':_0x15ebb9(0xe0),'JP':'JPN','CN':_0x15ebb9(0x110),'IN':_0x15ebb9(0x11c),'BR':_0x15ebb9(0x114),'MX':_0x15ebb9(0x116),'AR':_0x15ebb9(0x143),'CL':_0x15ebb9(0x129),'PE':_0x15ebb9(0xf9),'CO':_0x15ebb9(0x160),'VE':_0x15ebb9(0xf0),'EC':'ECU','BO':_0x15ebb9(0x13e),'PY':_0x15ebb9(0x135),'UY':_0x15ebb9(0x132),'SR':'SUR','GY':'GUY','FK':'FLK','ZA':_0x15ebb9(0x10b),'EG':_0x15ebb9(0x12b),'NG':_0x15ebb9(0xc8),'KE':_0x15ebb9(0x10c),'GH':_0x15ebb9(0xd6),'TZ':'TZA','UG':'UGA','ZW':_0x15ebb9(0x148),'ZM':_0x15ebb9(0x141),'MW':'MWI','MZ':_0x15ebb9(0x15f),'MG':_0x15ebb9(0xec),'MU':'MUS','SC':_0x15ebb9(0x121),'RE':_0x15ebb9(0xeb),'TR':_0x15ebb9(0x15a),'IR':'IRN','IQ':_0x15ebb9(0x105),'SA':'SAU','AE':_0x15ebb9(0x12a),'KW':_0x15ebb9(0x145),'QA':'QAT','BH':_0x15ebb9(0xce),'OM':_0x15ebb9(0x113),'YE':'YEM','JO':'JOR','LB':'LBN','SY':_0x15ebb9(0xd9),'IL':_0x15ebb9(0xcb),'PS':_0x15ebb9(0x118),'KR':_0x15ebb9(0x100),'KP':_0x15ebb9(0x147),'TH':_0x15ebb9(0x13b),'VN':_0x15ebb9(0x131),'MY':_0x15ebb9(0xda),'SG':'SGP','ID':_0x15ebb9(0x152),'PH':'PHL','LA':_0x15ebb9(0xd8),'KH':'KHM','MM':_0x15ebb9(0x165),'BD':'BGD','LK':'LKA','NP':_0x15ebb9(0xf6),'BT':_0x15ebb9(0x111),'MV':_0x15ebb9(0x15b),'AF':_0x15ebb9(0xed),'PK':_0x15ebb9(0x112),'MN':_0x15ebb9(0xc1)},_0x1d7901=_0x4a1b4b[_0x22477d[_0x15ebb9(0x164)]()];if(!_0x1d7901)return console[_0x15ebb9(0x11a)](_0x15ebb9(0xc7)+_0x22477d+_0x15ebb9(0x134)),_0x15ebb9(0x14e);return _0x1d7901;}async['createPaymentLink'](_0x54edf8){const _0x5445ee=a52_0xd6fef0;try{const {orderId:_0x652f2a,amount:_0x3bb24e,currency:_0x42a317,firstName:_0x447566,lastName:_0x248f3b,email:_0x15f12a,customerIp:_0x471ca1,customerCountry:_0x168ab0,successUrl:_0x493e17,failureUrl:_0x2e0fc7}=_0x54edf8;console[_0x5445ee(0x108)](_0x5445ee(0x156)),console[_0x5445ee(0x108)](_0x5445ee(0xfa),_0x652f2a),console[_0x5445ee(0x108)](_0x5445ee(0x163),_0x3bb24e,_0x42a317),console[_0x5445ee(0x108)]('Customer:',_0x447566+'\x20'+_0x248f3b),console[_0x5445ee(0x108)](_0x5445ee(0xbf),_0x15f12a),console[_0x5445ee(0x108)](_0x5445ee(0x126),_0x471ca1),console['log'](_0x5445ee(0x10a),_0x168ab0);const _0x45cc8b=this[_0x5445ee(0x104)](_0x168ab0);console[_0x5445ee(0x108)](_0x5445ee(0x142),_0x45cc8b);const _0x169466={'sub_method':_0x5445ee(0x10f),'currency':_0x42a317[_0x5445ee(0x164)](),'amount':_0x3bb24e,'callback_url':'https://traffer.uk/gateway/ampay/webhook.php','client_merchant_id':this[_0x5445ee(0xe4)],'client_transaction_id':_0x652f2a,'transaction_description':_0x652f2a,'customer':{'ip':_0x471ca1,'email':_0x15f12a,'full_name':_0x447566+'\x20'+_0x248f3b,'country':_0x45cc8b},'success_redirect_url':_0x493e17,'error_redirect_url':_0x2e0fc7};console[_0x5445ee(0x108)](_0x5445ee(0xfb),JSON[_0x5445ee(0xef)](_0x169466,null,0x2));const _0x40a139=await fetch(this[_0x5445ee(0xf2)]+_0x5445ee(0xe6),{'method':'POST','headers':{'Content-Type':_0x5445ee(0x127),'User-Agent':_0x5445ee(0x161)},'body':JSON['stringify'](_0x169466)}),_0x43c3da=await _0x40a139[_0x5445ee(0x144)]();console['log']('ðŸ“¥\x20AmPay\x20raw\x20response:',_0x43c3da);if(!_0x40a139['ok'])throw new Error(_0x5445ee(0xe9)+_0x40a139[_0x5445ee(0x119)]+'\x20-\x20'+_0x43c3da);let _0x10d0b9;try{_0x10d0b9=JSON[_0x5445ee(0x138)](_0x43c3da);}catch(_0x475aa8){throw new Error(_0x5445ee(0xe5)+_0x43c3da);}console[_0x5445ee(0x108)](_0x5445ee(0xc3),JSON[_0x5445ee(0xef)](_0x10d0b9,null,0x2));if(!_0x10d0b9['redirect_url'])throw new Error(_0x5445ee(0x136)+(_0x10d0b9['error_message']||_0x10d0b9[_0x5445ee(0xca)]||_0x5445ee(0x15c)));const _0x15c241=_0x10d0b9[_0x5445ee(0x15e)],_0x1abaa0=_0x10d0b9[_0x5445ee(0x155)],_0x42f87f=_0x10d0b9['tracker_id'];return console['log'](_0x5445ee(0x153)),console[_0x5445ee(0x108)](_0x5445ee(0x133),_0x15c241),console[_0x5445ee(0x108)](_0x5445ee(0x130),_0x1abaa0),console['log'](_0x5445ee(0xc6),_0x42f87f),console['log'](_0x5445ee(0x11f),_0x10d0b9['status']),console['log'](_0x5445ee(0xf4)),{'gateway_payment_id':_0x1abaa0||_0x42f87f||_0x652f2a,'payment_url':_0x15c241||'','transaction_id':_0x1abaa0};}catch(_0x2c3668){console[_0x5445ee(0xc2)]('âŒ\x20AmPay\x20payment\x20creation\x20failed:',_0x2c3668),console[_0x5445ee(0x108)](_0x5445ee(0x137));throw _0x2c3668;}}async[a52_0xd6fef0(0x115)](){const _0x17d07b=a52_0xd6fef0;try{const _0x2ef8dc=await fetch(this[_0x17d07b(0xf2)]+_0x17d07b(0x122),{'method':_0x17d07b(0x13f),'headers':{'Content-Type':_0x17d07b(0x127),'User-Agent':_0x17d07b(0x161)}});return _0x2ef8dc&&_0x2ef8dc[_0x17d07b(0x119)]===0xc8?!![]:![];}catch(_0x5990d3){return console[_0x17d07b(0xc2)]('âŒ\x20AmPay\x20health\x20check\x20failed:',_0x5990d3),![];}}async['processWebhook'](_0x378b2c){const _0x2ff683=a52_0xd6fef0;console[_0x2ff683(0x108)](_0x2ff683(0x139)),console['log'](_0x2ff683(0xbc)),console[_0x2ff683(0x108)](_0x2ff683(0x150),_0x378b2c),console[_0x2ff683(0x108)](_0x2ff683(0xe7),typeof _0x378b2c),console['log']('Available\x20fields:');_0x378b2c&&typeof _0x378b2c===_0x2ff683(0xd3)&&Object[_0x2ff683(0xf5)](_0x378b2c)[_0x2ff683(0x149)](_0x239c74=>{const _0x236ad2=_0x2ff683;console[_0x236ad2(0x108)]('\x20\x20'+_0x239c74+':\x20'+_0x378b2c[_0x239c74]+'\x20('+typeof _0x378b2c[_0x239c74]+')');});let _0x3762b0=_0x2ff683(0x14a);const _0x113756=_0x378b2c[_0x2ff683(0x13d)]||_0x378b2c[_0x2ff683(0x155)]||_0x378b2c[_0x2ff683(0xee)]||'';return console[_0x2ff683(0x108)](_0x2ff683(0x13c)+_0x113756),console[_0x2ff683(0x108)](_0x2ff683(0xdd)+_0x3762b0),!_0x113756&&(console[_0x2ff683(0xc2)](_0x2ff683(0x14b)),console[_0x2ff683(0xc2)](_0x2ff683(0xf3))),{'paymentId':_0x113756,'status':_0x3762b0,'amount':_0x378b2c[_0x2ff683(0x10d)],'currency':_0x378b2c[_0x2ff683(0xdc)]};}}exports[a52_0xd6fef0(0xfd)]=AmPayService,exports[a52_0xd6fef0(0x124)]=new AmPayService();