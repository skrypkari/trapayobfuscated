'use strict';const a46_0x2037d9=a46_0x1f83;function a46_0x1797(){const _0x4de422=['BLR','USA','BOL','ampay.php','SVK','PENDING','parse','BGR','object','AND','212016KzBGRD','Invalid\x20JSON\x20response\x20from\x20AmPay:\x20','IRN','apiUrl','IRL','JOR','🇦🇲\x20Creating\x20AmPay\x20payment\x20link...','VNM','Webhook\x20data\x20type:','MDV','6456pMxGLl','YEM','SRB','IND','RUS','TrapayAPI/1.0','ARM','ALB','MCO','ZMB','ESP','defineProperty','ISR','PRT','KAZ','UZB','COL','error_message','CZE','UKR','1CtfxcH','log','createPaymentLink','===\x20Processing\x20AmPay\x20webhook\x20===','MWI','BEL','10743170gMvAdl','SYR','CLIENT_MERCHANT_ID','GUY','API_PRIVATE_KEY','THA','LIE','health.php','BTN','PSE','GBR','✅\x20AmPay\x20payment\x20link\x20created\x20successfully','VEN','API_PUBLIC_KEY','Customer:','IRQ','Customer\x20Country\x20(2-letter):','9oTlIYU','UGA','Checked\x20fields:\x20client_transaction_id,\x20system_id,\x20tracker_id','1423754cJmIjM','📝\x20Logging\x20AmPay\x20payment\x20creation\x20failure...','FIN','stringify','LAO','Webhook\x20data:','❌\x20AmPay\x20health\x20check\x20failed:','LVA','LBN','EST','GRC','CHL','ARG','TZA','NGA','VAT','BHR','PER','2745PxnNVB','AmPay\x20payment\x20creation\x20failed:\x20','Customer\x20IP:','\x20-\x20','warn','❌\x20AmPay\x20payment\x20creation\x20failed:','TJK','KHM','ampayService','FLK','system_id','healthCheck','LKA','MUS','forEach','⚠️\x20Unknown\x20country\x20code:\x20','status',',\x20using\x20RUS\x20as\x20fallback','ARE','KEN','AUT','keys','GHA','📤\x20AmPay\x20request\x20body:','Email:','Order\x20ID:','REU','application/json','https://traffer.uk/gateway/ampay/webhook.php','🇦🇲\x20AmPay\x20service\x20initialized\x20with\x20Open\x20Banking\x20AM\x20processing','MYS','URY','error','DEU','CYP','currency','MNG','System\x20ID:','ZAF','GEO','PAK','HRV','CHE','PHL','2349788bcgzqo','SGP','toUpperCase','MEX','tracker_id','KOR','processWebhook','CHN','AFG','LTU','Tracker\x20ID:','3742464LeqUrH','ROU','KGZ','BRA','PRY','2542056fztgQN','__esModule','PRK','POL','AmPayService','Status:','📥\x20AmPay\x20raw\x20response:','XKX','Amount:','FRA','MMR','CAN','Unknown\x20error','MDA','BGD','NPL','MNE'];a46_0x1797=function(){return _0x4de422;};return a46_0x1797();}(function(_0x21b096,_0x1f02f0){const _0x204154=a46_0x1f83,_0x2841b3=_0x21b096();while(!![]){try{const _0x428ad1=-parseInt(_0x204154(0x169))/0x1*(parseInt(_0x204154(0x183))/0x2)+-parseInt(_0x204154(0x130))/0x3+parseInt(_0x204154(0x155))/0x4*(parseInt(_0x204154(0x195))/0x5)+parseInt(_0x204154(0x12b))/0x6+-parseInt(_0x204154(0x120))/0x7+parseInt(_0x204154(0x14b))/0x8+parseInt(_0x204154(0x180))/0x9*(parseInt(_0x204154(0x16f))/0xa);if(_0x428ad1===_0x1f02f0)break;else _0x2841b3['push'](_0x2841b3['shift']());}catch(_0x2f18a6){_0x2841b3['push'](_0x2841b3['shift']());}}}(a46_0x1797,0xaebd8));Object[a46_0x2037d9(0x160)](exports,a46_0x2037d9(0x131),{'value':!![]}),exports['ampayService']=exports[a46_0x2037d9(0x134)]=void 0x0;class AmPayService{constructor(){const _0x5582c1=a46_0x2037d9;this['CLIENT_MERCHANT_ID']='TRAFFER',this[_0x5582c1(0x17c)]='58b59ccbc03dcdcfc20d830edfba765dbf9f3531c692533d84b17938e9c40bda',this[_0x5582c1(0x173)]='a5a059aa63392e571341bddc5148a5db66643722e9a6bf16a9395fb690a80288931d5a1180a85a28eb9f6516cf61dfc1bf4e37898f3a35261cd2db88888d3815',this['apiUrl']='https://traffer.uk/gateway/ampay/',console[_0x5582c1(0x16a)](_0x5582c1(0x1b2));}['convert2LetterTo3LetterCountryCode'](_0x4a06ba){const _0x48fba1=a46_0x2037d9,_0x4b6c1f={'AD':_0x48fba1(0x14a),'AL':_0x48fba1(0x15c),'AT':_0x48fba1(0x1a9),'BA':'BIH','BE':_0x48fba1(0x16e),'BG':_0x48fba1(0x148),'BY':_0x48fba1(0x141),'CH':_0x48fba1(0x11e),'CY':_0x48fba1(0x1b7),'CZ':_0x48fba1(0x167),'DE':_0x48fba1(0x1b6),'DK':'DNK','EE':_0x48fba1(0x18c),'ES':_0x48fba1(0x15f),'FI':_0x48fba1(0x185),'FR':_0x48fba1(0x139),'GB':_0x48fba1(0x179),'GE':_0x48fba1(0x11b),'GR':_0x48fba1(0x18d),'HR':_0x48fba1(0x11d),'HU':'HUN','IE':_0x48fba1(0x14f),'IS':'ISL','IT':'ITA','LI':_0x48fba1(0x175),'LT':_0x48fba1(0x129),'LU':'LUX','LV':_0x48fba1(0x18a),'MC':_0x48fba1(0x15d),'MD':_0x48fba1(0x13d),'ME':_0x48fba1(0x140),'MK':'MKD','MT':'MLT','NL':'NLD','NO':'NOR','PL':_0x48fba1(0x133),'PT':_0x48fba1(0x162),'RO':_0x48fba1(0x12c),'RS':_0x48fba1(0x157),'RU':_0x48fba1(0x159),'SE':'SWE','SI':'SVN','SK':_0x48fba1(0x145),'SM':'SMR','UA':_0x48fba1(0x168),'VA':_0x48fba1(0x192),'XK':_0x48fba1(0x137),'AM':_0x48fba1(0x15b),'AZ':'AZE','KZ':_0x48fba1(0x163),'KG':_0x48fba1(0x12d),'TJ':_0x48fba1(0x19b),'TM':'TKM','UZ':_0x48fba1(0x164),'US':_0x48fba1(0x142),'CA':_0x48fba1(0x13b),'AU':'AUS','JP':'JPN','CN':_0x48fba1(0x127),'IN':_0x48fba1(0x158),'BR':_0x48fba1(0x12e),'MX':_0x48fba1(0x123),'AR':_0x48fba1(0x18f),'CL':_0x48fba1(0x18e),'PE':_0x48fba1(0x194),'CO':_0x48fba1(0x165),'VE':_0x48fba1(0x17b),'EC':'ECU','BO':_0x48fba1(0x143),'PY':_0x48fba1(0x12f),'UY':_0x48fba1(0x1b4),'SR':'SUR','GY':_0x48fba1(0x172),'FK':_0x48fba1(0x19e),'ZA':_0x48fba1(0x1bb),'EG':'EGY','NG':_0x48fba1(0x191),'KE':_0x48fba1(0x1a8),'GH':_0x48fba1(0x1ab),'TZ':_0x48fba1(0x190),'UG':_0x48fba1(0x181),'ZW':'ZWE','ZM':_0x48fba1(0x15e),'MW':_0x48fba1(0x16d),'MZ':'MOZ','MG':'MDG','MU':_0x48fba1(0x1a2),'SC':'SYC','RE':_0x48fba1(0x1af),'TR':'TUR','IR':_0x48fba1(0x14d),'IQ':_0x48fba1(0x17e),'SA':'SAU','AE':_0x48fba1(0x1a7),'KW':'KWT','QA':'QAT','BH':_0x48fba1(0x193),'OM':'OMN','YE':_0x48fba1(0x156),'JO':_0x48fba1(0x150),'LB':_0x48fba1(0x18b),'SY':_0x48fba1(0x170),'IL':_0x48fba1(0x161),'PS':_0x48fba1(0x178),'KR':_0x48fba1(0x125),'KP':_0x48fba1(0x132),'TH':_0x48fba1(0x174),'VN':_0x48fba1(0x152),'MY':_0x48fba1(0x1b3),'SG':_0x48fba1(0x121),'ID':'IDN','PH':_0x48fba1(0x11f),'LA':_0x48fba1(0x187),'KH':_0x48fba1(0x19c),'MM':_0x48fba1(0x13a),'BD':_0x48fba1(0x13e),'LK':_0x48fba1(0x1a1),'NP':_0x48fba1(0x13f),'BT':_0x48fba1(0x177),'MV':_0x48fba1(0x154),'AF':_0x48fba1(0x128),'PK':_0x48fba1(0x11c),'MN':_0x48fba1(0x1b9)},_0x41f97a=_0x4b6c1f[_0x4a06ba[_0x48fba1(0x122)]()];if(!_0x41f97a)return console[_0x48fba1(0x199)](_0x48fba1(0x1a4)+_0x4a06ba+_0x48fba1(0x1a6)),_0x48fba1(0x159);return _0x41f97a;}async[a46_0x2037d9(0x16b)](_0x404d8c){const _0x34a8dd=a46_0x2037d9;try{const {orderId:_0x271ccd,amount:_0x2d3a2c,currency:_0x24923d,firstName:_0x1261f4,lastName:_0x28abe0,email:_0x4fe9a3,customerIp:_0x323462,customerCountry:_0x23ec86,successUrl:_0x480e12,failureUrl:_0x48c477}=_0x404d8c;console[_0x34a8dd(0x16a)](_0x34a8dd(0x151)),console[_0x34a8dd(0x16a)](_0x34a8dd(0x1ae),_0x271ccd),console[_0x34a8dd(0x16a)](_0x34a8dd(0x138),_0x2d3a2c,_0x24923d),console[_0x34a8dd(0x16a)](_0x34a8dd(0x17d),_0x1261f4+'\x20'+_0x28abe0),console[_0x34a8dd(0x16a)](_0x34a8dd(0x1ad),_0x4fe9a3),console[_0x34a8dd(0x16a)](_0x34a8dd(0x197),_0x323462),console[_0x34a8dd(0x16a)](_0x34a8dd(0x17f),_0x23ec86);const _0x2d9a1c=this['convert2LetterTo3LetterCountryCode'](_0x23ec86);console[_0x34a8dd(0x16a)]('Customer\x20Country\x20(3-letter):',_0x2d9a1c);const _0x4ba40c={'sub_method':'GAM','currency':_0x24923d['toUpperCase'](),'amount':_0x2d3a2c,'callback_url':_0x34a8dd(0x1b1),'client_merchant_id':this[_0x34a8dd(0x171)],'client_transaction_id':_0x271ccd,'transaction_description':_0x271ccd,'customer':{'ip':_0x323462,'email':_0x4fe9a3,'full_name':_0x1261f4+'\x20'+_0x28abe0,'country':_0x2d9a1c},'success_redirect_url':_0x480e12,'error_redirect_url':_0x48c477};console['log'](_0x34a8dd(0x1ac),JSON[_0x34a8dd(0x186)](_0x4ba40c,null,0x2));const _0x19f532=await fetch(this[_0x34a8dd(0x14e)]+_0x34a8dd(0x144),{'method':'POST','headers':{'Content-Type':'application/json','User-Agent':_0x34a8dd(0x15a)},'body':JSON['stringify'](_0x4ba40c)}),_0x43cac2=await _0x19f532['text']();console[_0x34a8dd(0x16a)](_0x34a8dd(0x136),_0x43cac2);if(!_0x19f532['ok'])throw new Error('AmPay\x20API\x20error:\x20HTTP\x20'+_0x19f532['status']+_0x34a8dd(0x198)+_0x43cac2);let _0x4f3e45;try{_0x4f3e45=JSON[_0x34a8dd(0x147)](_0x43cac2);}catch(_0x2b44a3){throw new Error(_0x34a8dd(0x14c)+_0x43cac2);}console[_0x34a8dd(0x16a)]('📊\x20AmPay\x20response\x20data:',JSON['stringify'](_0x4f3e45,null,0x2));if(!_0x4f3e45['redirect_url'])throw new Error(_0x34a8dd(0x196)+(_0x4f3e45[_0x34a8dd(0x166)]||_0x4f3e45['message']||_0x34a8dd(0x13c)));const _0x42a2c7=_0x4f3e45['redirect_url'],_0x42d5fd=_0x4f3e45['system_id'],_0x1d9156=_0x4f3e45[_0x34a8dd(0x124)];return console[_0x34a8dd(0x16a)](_0x34a8dd(0x17a)),console[_0x34a8dd(0x16a)]('Payment\x20URL:',_0x42a2c7),console[_0x34a8dd(0x16a)](_0x34a8dd(0x1ba),_0x42d5fd),console[_0x34a8dd(0x16a)](_0x34a8dd(0x12a),_0x1d9156),console[_0x34a8dd(0x16a)](_0x34a8dd(0x135),_0x4f3e45[_0x34a8dd(0x1a5)]),console['log']('📝\x20Logging\x20AmPay\x20payment\x20creation\x20event...'),{'gateway_payment_id':_0x42d5fd||_0x1d9156||_0x271ccd,'payment_url':_0x42a2c7||'','transaction_id':_0x42d5fd};}catch(_0x177256){console[_0x34a8dd(0x1b5)](_0x34a8dd(0x19a),_0x177256),console[_0x34a8dd(0x16a)](_0x34a8dd(0x184));throw _0x177256;}}async[a46_0x2037d9(0x1a0)](){const _0x5bb2d0=a46_0x2037d9;try{const _0x109147=await fetch(this[_0x5bb2d0(0x14e)]+_0x5bb2d0(0x176),{'method':'GET','headers':{'Content-Type':_0x5bb2d0(0x1b0),'User-Agent':_0x5bb2d0(0x15a)}});return _0x109147&&_0x109147[_0x5bb2d0(0x1a5)]===0xc8?!![]:![];}catch(_0x1de541){return console[_0x5bb2d0(0x1b5)](_0x5bb2d0(0x189),_0x1de541),![];}}async[a46_0x2037d9(0x126)](_0x8b2a4b){const _0x71b400=a46_0x2037d9;console['log'](_0x71b400(0x16c)),console[_0x71b400(0x16a)]('⚠️\x20WEBHOOKS\x20TEMPORARILY\x20DISABLED\x20-\x20Always\x20returning\x20PROCESSING\x20status'),console['log'](_0x71b400(0x188),_0x8b2a4b),console[_0x71b400(0x16a)](_0x71b400(0x153),typeof _0x8b2a4b),console[_0x71b400(0x16a)]('Available\x20fields:');_0x8b2a4b&&typeof _0x8b2a4b===_0x71b400(0x149)&&Object[_0x71b400(0x1aa)](_0x8b2a4b)[_0x71b400(0x1a3)](_0x187664=>{const _0x6ddabd=_0x71b400;console[_0x6ddabd(0x16a)]('\x20\x20'+_0x187664+':\x20'+_0x8b2a4b[_0x187664]+'\x20('+typeof _0x8b2a4b[_0x187664]+')');});let _0x44397e=_0x71b400(0x146);const _0x17448a=_0x8b2a4b['client_transaction_id']||_0x8b2a4b[_0x71b400(0x19f)]||_0x8b2a4b[_0x71b400(0x124)]||'';return console[_0x71b400(0x16a)]('Extracted\x20payment\x20ID:\x20'+_0x17448a),console[_0x71b400(0x16a)]('Forced\x20status\x20(webhook\x20disabled):\x20'+_0x44397e),!_0x17448a&&(console[_0x71b400(0x1b5)]('No\x20payment\x20ID\x20found\x20in\x20webhook\x20data'),console['error'](_0x71b400(0x182))),{'paymentId':_0x17448a,'status':_0x44397e,'amount':_0x8b2a4b['amount'],'currency':_0x8b2a4b[_0x71b400(0x1b8)]};}}function a46_0x1f83(_0x2c410c,_0x44006f){const _0x17970e=a46_0x1797();return a46_0x1f83=function(_0x1f83c1,_0x459067){_0x1f83c1=_0x1f83c1-0x11b;let _0x3fed3b=_0x17970e[_0x1f83c1];return _0x3fed3b;},a46_0x1f83(_0x2c410c,_0x44006f);}exports[a46_0x2037d9(0x134)]=AmPayService,exports[a46_0x2037d9(0x19d)]=new AmPayService();