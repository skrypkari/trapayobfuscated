'use strict';function a46_0x18e5(){const _0x261425=['application/json','ESP','MCO','6sbdVie','UKR','Status:','convert2LetterTo3LetterCountryCode','status','text','PRK','Invalid\x20JSON\x20response\x20from\x20AmPay:\x20','SVN','📊\x20AmPay\x20response\x20data:','CAN','IDN','POL','error_message','BOL','✅\x20AmPay\x20payment\x20link\x20created\x20successfully','719tUsNSB','RUS','ROU','DEU','📝\x20Logging\x20AmPay\x20payment\x20creation\x20failure...','redirect_url','Webhook\x20data:','QAT','stringify','TrapayAPI/1.0','IRL','302264cVbODn','TJK','421050irUMeT','log','TZA','KOR','SGP','ZAF','VAT','https://traffer.uk/gateway/ampay/webhook.php','SWE','client_transaction_id','MEX','MDV','IRQ','error','EST','BGD','Forced\x20status\x20(webhook\x20disabled):\x20','API_PRIVATE_KEY','No\x20payment\x20ID\x20found\x20in\x20webhook\x20data','MNG','CZE','SVK','GAM','MNE','healthCheck','LBN','CLIENT_MERCHANT_ID','SMR','Customer\x20Country\x20(2-letter):','createPaymentLink',',\x20using\x20RUS\x20as\x20fallback','===\x20Processing\x20AmPay\x20webhook\x20===','tracker_id','POST','defineProperty','CHE','FIN','MMR','TKM','IRN','1858phqKxz','LIE','SAU','REU','YEM','GHA','PHL','LKA','AUT','System\x20ID:','10911780OtZJVL','LVA','MOZ','VNM','32172YTjFke','7516865qBKJxI','ARE','CYP','🇦🇲\x20AmPay\x20service\x20initialized\x20with\x20Open\x20Banking\x20AM\x20processing','ZWE','toUpperCase','message','Customer:','https://traffer.uk/gateway/ampay/','processWebhook','MKD','ISR','PAK','XKX','📝\x20Logging\x20AmPay\x20payment\x20creation\x20event...','AmPayService','API_PUBLIC_KEY','object','ITA','UGA','MUS','Amount:','JPN','BTN','NPL','SYR','MLT','9999608KACbjU','health.php','URY','ISL','58b59ccbc03dcdcfc20d830edfba765dbf9f3531c692533d84b17938e9c40bda','PER','CHL','BHR','AmPay\x20API\x20error:\x20HTTP\x20','ampayService','SRB','Checked\x20fields:\x20client_transaction_id,\x20system_id,\x20tracker_id','NOR','a5a059aa63392e571341bddc5148a5db66643722e9a6bf16a9395fb690a80288931d5a1180a85a28eb9f6516cf61dfc1bf4e37898f3a35261cd2db88888d3815','KGZ','forEach','TUR','apiUrl','keys','BIH','SUR','Email:','amount','KWT','system_id','MDG','ECU','parse','GEO','9pJddJx','📥\x20AmPay\x20raw\x20response:','COL','Tracker\x20ID:','PSE','USA','EGY','SYC','AUS','AmPay\x20payment\x20creation\x20failed:\x20','IND','BLR','GUY','❌\x20AmPay\x20payment\x20creation\x20failed:','BGR','Payment\x20URL:','BEL','GRC','BRA','HUN','MYS'];a46_0x18e5=function(){return _0x261425;};return a46_0x18e5();}const a46_0x396aa3=a46_0x29bf;function a46_0x29bf(_0x5a5738,_0x1e42dc){const _0x18e511=a46_0x18e5();return a46_0x29bf=function(_0x29bf94,_0x4f057d){_0x29bf94=_0x29bf94-0x73;let _0x36d079=_0x18e511[_0x29bf94];return _0x36d079;},a46_0x29bf(_0x5a5738,_0x1e42dc);}(function(_0x2db49f,_0x33c37d){const _0x30b2b4=a46_0x29bf,_0xa4c55=_0x2db49f();while(!![]){try{const _0x4cac4f=-parseInt(_0x30b2b4(0xc0))/0x1*(parseInt(_0x30b2b4(0xf5))/0x2)+-parseInt(_0x30b2b4(0xcd))/0x3+parseInt(_0x30b2b4(0xcb))/0x4+-parseInt(_0x30b2b4(0x104))/0x5*(-parseInt(_0x30b2b4(0xb0))/0x6)+parseInt(_0x30b2b4(0x103))/0x7+parseInt(_0x30b2b4(0x7b))/0x8+-parseInt(_0x30b2b4(0x98))/0x9*(parseInt(_0x30b2b4(0xff))/0xa);if(_0x4cac4f===_0x33c37d)break;else _0xa4c55['push'](_0xa4c55['shift']());}catch(_0x244c30){_0xa4c55['push'](_0xa4c55['shift']());}}}(a46_0x18e5,0xe4077));Object[a46_0x396aa3(0xef)](exports,'__esModule',{'value':!![]}),exports['ampayService']=exports[a46_0x396aa3(0x113)]=void 0x0;class AmPayService{constructor(){const _0x450264=a46_0x396aa3;this[_0x450264(0xe7)]='TRAFFER',this[_0x450264(0x114)]=_0x450264(0x7f),this[_0x450264(0xde)]=_0x450264(0x88),this[_0x450264(0x8c)]=_0x450264(0x10c),console[_0x450264(0xce)](_0x450264(0x107));}[a46_0x396aa3(0xb3)](_0x5c0fe2){const _0x1d9fa6=a46_0x396aa3,_0x3106e9={'AD':'AND','AL':'ALB','AT':_0x1d9fa6(0xfd),'BA':_0x1d9fa6(0x8e),'BE':_0x1d9fa6(0xa8),'BG':_0x1d9fa6(0xa6),'BY':_0x1d9fa6(0xa3),'CH':_0x1d9fa6(0xf0),'CY':_0x1d9fa6(0x106),'CZ':_0x1d9fa6(0xe1),'DE':_0x1d9fa6(0xc3),'DK':'DNK','EE':_0x1d9fa6(0xdb),'ES':_0x1d9fa6(0xae),'FI':_0x1d9fa6(0xf1),'FR':'FRA','GB':'GBR','GE':_0x1d9fa6(0x97),'GR':_0x1d9fa6(0xa9),'HR':'HRV','HU':_0x1d9fa6(0xab),'IE':_0x1d9fa6(0xca),'IS':_0x1d9fa6(0x7e),'IT':_0x1d9fa6(0x116),'LI':_0x1d9fa6(0xf6),'LT':'LTU','LU':'LUX','LV':_0x1d9fa6(0x100),'MC':_0x1d9fa6(0xaf),'MD':'MDA','ME':_0x1d9fa6(0xe4),'MK':_0x1d9fa6(0x10e),'MT':_0x1d9fa6(0x7a),'NL':'NLD','NO':_0x1d9fa6(0x87),'PL':_0x1d9fa6(0xbc),'PT':'PRT','RO':_0x1d9fa6(0xc2),'RS':_0x1d9fa6(0x85),'RU':_0x1d9fa6(0xc1),'SE':_0x1d9fa6(0xd5),'SI':_0x1d9fa6(0xb8),'SK':_0x1d9fa6(0xe2),'SM':_0x1d9fa6(0xe8),'UA':_0x1d9fa6(0xb1),'VA':_0x1d9fa6(0xd3),'XK':_0x1d9fa6(0x111),'AM':'ARM','AZ':'AZE','KZ':'KAZ','KG':_0x1d9fa6(0x89),'TJ':_0x1d9fa6(0xcc),'TM':_0x1d9fa6(0xf3),'UZ':'UZB','US':_0x1d9fa6(0x9d),'CA':_0x1d9fa6(0xba),'AU':_0x1d9fa6(0xa0),'JP':_0x1d9fa6(0x76),'CN':'CHN','IN':_0x1d9fa6(0xa2),'BR':_0x1d9fa6(0xaa),'MX':_0x1d9fa6(0xd7),'AR':'ARG','CL':_0x1d9fa6(0x81),'PE':_0x1d9fa6(0x80),'CO':_0x1d9fa6(0x9a),'VE':'VEN','EC':_0x1d9fa6(0x95),'BO':_0x1d9fa6(0xbe),'PY':'PRY','UY':_0x1d9fa6(0x7d),'SR':_0x1d9fa6(0x8f),'GY':_0x1d9fa6(0xa4),'FK':'FLK','ZA':_0x1d9fa6(0xd2),'EG':_0x1d9fa6(0x9e),'NG':'NGA','KE':'KEN','GH':_0x1d9fa6(0xfa),'TZ':_0x1d9fa6(0xcf),'UG':_0x1d9fa6(0x73),'ZW':_0x1d9fa6(0x108),'ZM':'ZMB','MW':'MWI','MZ':_0x1d9fa6(0x101),'MG':_0x1d9fa6(0x94),'MU':_0x1d9fa6(0x74),'SC':_0x1d9fa6(0x9f),'RE':_0x1d9fa6(0xf8),'TR':_0x1d9fa6(0x8b),'IR':_0x1d9fa6(0xf4),'IQ':_0x1d9fa6(0xd9),'SA':_0x1d9fa6(0xf7),'AE':_0x1d9fa6(0x105),'KW':_0x1d9fa6(0x92),'QA':_0x1d9fa6(0xc7),'BH':_0x1d9fa6(0x82),'OM':'OMN','YE':_0x1d9fa6(0xf9),'JO':'JOR','LB':_0x1d9fa6(0xe6),'SY':_0x1d9fa6(0x79),'IL':_0x1d9fa6(0x10f),'PS':_0x1d9fa6(0x9c),'KR':_0x1d9fa6(0xd0),'KP':_0x1d9fa6(0xb6),'TH':'THA','VN':_0x1d9fa6(0x102),'MY':_0x1d9fa6(0xac),'SG':_0x1d9fa6(0xd1),'ID':_0x1d9fa6(0xbb),'PH':_0x1d9fa6(0xfb),'LA':'LAO','KH':'KHM','MM':_0x1d9fa6(0xf2),'BD':_0x1d9fa6(0xdc),'LK':_0x1d9fa6(0xfc),'NP':_0x1d9fa6(0x78),'BT':_0x1d9fa6(0x77),'MV':_0x1d9fa6(0xd8),'AF':'AFG','PK':_0x1d9fa6(0x110),'MN':_0x1d9fa6(0xe0)},_0x38bcf0=_0x3106e9[_0x5c0fe2[_0x1d9fa6(0x109)]()];if(!_0x38bcf0)return console['warn']('⚠️\x20Unknown\x20country\x20code:\x20'+_0x5c0fe2+_0x1d9fa6(0xeb)),_0x1d9fa6(0xc1);return _0x38bcf0;}async[a46_0x396aa3(0xea)](_0x13b39a){const _0x371594=a46_0x396aa3;try{const {orderId:_0x3d5c99,amount:_0x1fb52f,currency:_0x364508,firstName:_0x24cbe3,lastName:_0x3fa3c4,email:_0x1b73c7,customerIp:_0x166cd7,customerCountry:_0x262f98,successUrl:_0x458f1c,failureUrl:_0x57885d}=_0x13b39a;console[_0x371594(0xce)]('🇦🇲\x20Creating\x20AmPay\x20payment\x20link...'),console[_0x371594(0xce)]('Order\x20ID:',_0x3d5c99),console['log'](_0x371594(0x75),_0x1fb52f,_0x364508),console[_0x371594(0xce)](_0x371594(0x10b),_0x24cbe3+'\x20'+_0x3fa3c4),console['log'](_0x371594(0x90),_0x1b73c7),console[_0x371594(0xce)]('Customer\x20IP:',_0x166cd7),console[_0x371594(0xce)](_0x371594(0xe9),_0x262f98);const _0x43d033=this['convert2LetterTo3LetterCountryCode'](_0x262f98);console[_0x371594(0xce)]('Customer\x20Country\x20(3-letter):',_0x43d033);const _0x2fdc33={'sub_method':_0x371594(0xe3),'currency':_0x364508[_0x371594(0x109)](),'amount':_0x1fb52f,'callback_url':_0x371594(0xd4),'client_merchant_id':this[_0x371594(0xe7)],'client_transaction_id':_0x3d5c99,'transaction_description':_0x3d5c99,'customer':{'ip':_0x166cd7,'email':_0x1b73c7,'full_name':_0x24cbe3+'\x20'+_0x3fa3c4,'country':_0x43d033},'success_redirect_url':_0x458f1c,'error_redirect_url':_0x57885d};console[_0x371594(0xce)]('📤\x20AmPay\x20request\x20body:',JSON['stringify'](_0x2fdc33,null,0x2));const _0x5139cd=await fetch(this[_0x371594(0x8c)]+'ampay.php',{'method':_0x371594(0xee),'headers':{'Content-Type':'application/json','User-Agent':'TrapayAPI/1.0'},'body':JSON[_0x371594(0xc8)](_0x2fdc33)}),_0x1b64c4=await _0x5139cd[_0x371594(0xb5)]();console[_0x371594(0xce)](_0x371594(0x99),_0x1b64c4);if(!_0x5139cd['ok'])throw new Error(_0x371594(0x83)+_0x5139cd[_0x371594(0xb4)]+'\x20-\x20'+_0x1b64c4);let _0x1a68dd;try{_0x1a68dd=JSON[_0x371594(0x96)](_0x1b64c4);}catch(_0x48e7d4){throw new Error(_0x371594(0xb7)+_0x1b64c4);}console['log'](_0x371594(0xb9),JSON[_0x371594(0xc8)](_0x1a68dd,null,0x2));if(!_0x1a68dd['redirect_url'])throw new Error(_0x371594(0xa1)+(_0x1a68dd[_0x371594(0xbd)]||_0x1a68dd[_0x371594(0x10a)]||'Unknown\x20error'));const _0x5ef3a7=_0x1a68dd[_0x371594(0xc5)],_0x5880e6=_0x1a68dd[_0x371594(0x93)],_0x35eb1c=_0x1a68dd[_0x371594(0xed)];return console[_0x371594(0xce)](_0x371594(0xbf)),console[_0x371594(0xce)](_0x371594(0xa7),_0x5ef3a7),console[_0x371594(0xce)](_0x371594(0xfe),_0x5880e6),console[_0x371594(0xce)](_0x371594(0x9b),_0x35eb1c),console[_0x371594(0xce)](_0x371594(0xb2),_0x1a68dd[_0x371594(0xb4)]),console['log'](_0x371594(0x112)),{'gateway_payment_id':_0x5880e6||_0x35eb1c||_0x3d5c99,'payment_url':_0x5ef3a7||'','transaction_id':_0x5880e6};}catch(_0x5b4505){console['error'](_0x371594(0xa5),_0x5b4505),console['log'](_0x371594(0xc4));throw _0x5b4505;}}async[a46_0x396aa3(0xe5)](){const _0x4ec44f=a46_0x396aa3;try{const _0x720963=await fetch(this[_0x4ec44f(0x8c)]+_0x4ec44f(0x7c),{'method':'GET','headers':{'Content-Type':_0x4ec44f(0xad),'User-Agent':_0x4ec44f(0xc9)}});return _0x720963&&_0x720963['status']===0xc8?!![]:![];}catch(_0x368760){return console[_0x4ec44f(0xda)]('❌\x20AmPay\x20health\x20check\x20failed:',_0x368760),![];}}async[a46_0x396aa3(0x10d)](_0x475b85){const _0xb5970=a46_0x396aa3;console[_0xb5970(0xce)](_0xb5970(0xec)),console['log']('⚠️\x20WEBHOOKS\x20TEMPORARILY\x20DISABLED\x20-\x20Always\x20returning\x20PROCESSING\x20status'),console[_0xb5970(0xce)](_0xb5970(0xc6),_0x475b85),console['log']('Webhook\x20data\x20type:',typeof _0x475b85),console['log']('Available\x20fields:');_0x475b85&&typeof _0x475b85===_0xb5970(0x115)&&Object[_0xb5970(0x8d)](_0x475b85)[_0xb5970(0x8a)](_0x18c509=>{const _0x4698fb=_0xb5970;console[_0x4698fb(0xce)]('\x20\x20'+_0x18c509+':\x20'+_0x475b85[_0x18c509]+'\x20('+typeof _0x475b85[_0x18c509]+')');});let _0x4286a8='PENDING';const _0x2e760d=_0x475b85[_0xb5970(0xd6)]||_0x475b85[_0xb5970(0x93)]||_0x475b85[_0xb5970(0xed)]||'';return console['log']('Extracted\x20payment\x20ID:\x20'+_0x2e760d),console[_0xb5970(0xce)](_0xb5970(0xdd)+_0x4286a8),!_0x2e760d&&(console[_0xb5970(0xda)](_0xb5970(0xdf)),console['error'](_0xb5970(0x86))),{'paymentId':_0x2e760d,'status':_0x4286a8,'amount':_0x475b85[_0xb5970(0x91)],'currency':_0x475b85['currency']};}}exports[a46_0x396aa3(0x113)]=AmPayService,exports[a46_0x396aa3(0x84)]=new AmPayService();