'use strict';function a46_0x2846(_0x32d2b9,_0x4865b3){const _0x56c459=a46_0x56c4();return a46_0x2846=function(_0x284637,_0xa7b126){_0x284637=_0x284637-0x9c;let _0x5a720e=_0x56c459[_0x284637];return _0x5a720e;},a46_0x2846(_0x32d2b9,_0x4865b3);}const a46_0x28e1ea=a46_0x2846;(function(_0x4508c0,_0x391ce7){const _0x571cfa=a46_0x2846,_0x8b81ff=_0x4508c0();while(!![]){try{const _0x4e0187=-parseInt(_0x571cfa(0x113))/0x1*(-parseInt(_0x571cfa(0xdf))/0x2)+parseInt(_0x571cfa(0x130))/0x3+parseInt(_0x571cfa(0xc9))/0x4*(parseInt(_0x571cfa(0xf3))/0x5)+parseInt(_0x571cfa(0xe0))/0x6*(parseInt(_0x571cfa(0xb8))/0x7)+-parseInt(_0x571cfa(0x126))/0x8+-parseInt(_0x571cfa(0x9e))/0x9*(-parseInt(_0x571cfa(0x10e))/0xa)+-parseInt(_0x571cfa(0xae))/0xb;if(_0x4e0187===_0x391ce7)break;else _0x8b81ff['push'](_0x8b81ff['shift']());}catch(_0xf78539){_0x8b81ff['push'](_0x8b81ff['shift']());}}}(a46_0x56c4,0x4783f));Object[a46_0x28e1ea(0xcc)](exports,'__esModule',{'value':!![]}),exports[a46_0x28e1ea(0xeb)]=exports[a46_0x28e1ea(0xa5)]=void 0x0;function a46_0x56c4(){const _0x48c9af=[',\x20using\x20RUS\x20as\x20fallback','client_transaction_id','COL','HUN','currency','KHM','QAT','EGY','7242543zoPuTG','KOR','BEL','Webhook\x20data:','ARM','MDV','ISR','No\x20payment\x20ID\x20found\x20in\x20webhook\x20data','LVA','MDG','7EaLkqX','DNK','MNE','Invalid\x20JSON\x20response\x20from\x20AmPay:\x20','processWebhook','THA','URY','CZE','https://traffer.uk/gateway/ampay/','AmPay\x20API\x20error:\x20HTTP\x20','KEN','ampay.php','FRA','IND','IRN','system_id','TUR','12004IstAsR','IRQ','EST','defineProperty','SVK','PENDING','Customer:','LKA','IRL','MDA','createPaymentLink','NOR','GUY','BLR','❌\x20AmPay\x20health\x20check\x20failed:','Customer\x20Country\x20(2-letter):','SRB','⚠️\x20Unknown\x20country\x20code:\x20','BHR','forEach','CLIENT_MERCHANT_ID','📝\x20Logging\x20AmPay\x20payment\x20creation\x20failure...','6tpOQaU','1506792gmCBsG','NLD','HRV','CHL','JPN','tracker_id','RUS','SYC','LTU','text','GHA','ampayService','toUpperCase','warn','Order\x20ID:','TJK','Customer\x20IP:','Status:','ARG','145PpVpWx','TRAFFER','ISL','TKM','API_PUBLIC_KEY','Available\x20fields:','AFG','===\x20Processing\x20AmPay\x20webhook\x20===','MEX','MKD','UKR','CAN','VEN','redirect_url','message','PRY','convert2LetterTo3LetterCountryCode','BTN','AND','MUS','SAU','USA','SGP','CYP','UGA','ZWE','AUS','10RNtGVl','MWI','status','Webhook\x20data\x20type:','YEM','29851VhFWRo','IDN','BOL','System\x20ID:','ROU','📝\x20Logging\x20AmPay\x20payment\x20creation\x20event...','AmPay\x20payment\x20creation\x20failed:\x20','AZE','a5a059aa63392e571341bddc5148a5db66643722e9a6bf16a9395fb690a80288931d5a1180a85a28eb9f6516cf61dfc1bf4e37898f3a35261cd2db88888d3815','Checked\x20fields:\x20client_transaction_id,\x20system_id,\x20tracker_id','LBN','error','FIN','PRK','Payment\x20URL:','POST','stringify','DEU','PAK','1064168QVWsfS','health.php','VAT','ECU','⚠️\x20WEBHOOKS\x20TEMPORARILY\x20DISABLED\x20-\x20Always\x20returning\x20PROCESSING\x20status','API_PRIVATE_KEY','PHL','MOZ','Email:','KGZ','740400dqEQgA','CHN','object','OMN','keys','Tracker\x20ID:','📊\x20AmPay\x20response\x20data:','ARE','GBR','KAZ','BGD','TrapayAPI/1.0','Forced\x20status\x20(webhook\x20disabled):\x20','\x20-\x20','SWE','parse','ZMB','3688623GJPMNs','MMR','Customer\x20Country\x20(3-letter):','log','ESP','amount','CHE','AmPayService'];a46_0x56c4=function(){return _0x48c9af;};return a46_0x56c4();}class AmPayService{constructor(){const _0x3da379=a46_0x28e1ea;this[_0x3da379(0xdd)]=_0x3da379(0xf4),this[_0x3da379(0xf7)]='58b59ccbc03dcdcfc20d830edfba765dbf9f3531c692533d84b17938e9c40bda',this[_0x3da379(0x12b)]=_0x3da379(0x11b),this['apiUrl']=_0x3da379(0xc0),console[_0x3da379(0xa1)]('🇦🇲\x20AmPay\x20service\x20initialized\x20with\x20Open\x20Banking\x20AM\x20processing');}[a46_0x28e1ea(0x103)](_0x2adbfd){const _0x34f613=a46_0x28e1ea,_0x4d0255={'AD':_0x34f613(0x105),'AL':'ALB','AT':'AUT','BA':'BIH','BE':_0x34f613(0xb0),'BG':'BGR','BY':_0x34f613(0xd6),'CH':_0x34f613(0xa4),'CY':_0x34f613(0x10a),'CZ':_0x34f613(0xbf),'DE':_0x34f613(0x124),'DK':_0x34f613(0xb9),'EE':_0x34f613(0xcb),'ES':_0x34f613(0xa2),'FI':_0x34f613(0x11f),'FR':_0x34f613(0xc4),'GB':_0x34f613(0x138),'GE':'GEO','GR':'GRC','HR':_0x34f613(0xe2),'HU':_0x34f613(0xa9),'IE':_0x34f613(0xd1),'IS':_0x34f613(0xf5),'IT':'ITA','LI':'LIE','LT':_0x34f613(0xe8),'LU':'LUX','LV':_0x34f613(0xb6),'MC':'MCO','MD':_0x34f613(0xd2),'ME':_0x34f613(0xba),'MK':_0x34f613(0xfc),'MT':'MLT','NL':_0x34f613(0xe1),'NO':_0x34f613(0xd4),'PL':'POL','PT':'PRT','RO':_0x34f613(0x117),'RS':_0x34f613(0xd9),'RU':_0x34f613(0xe6),'SE':_0x34f613(0x13e),'SI':'SVN','SK':_0x34f613(0xcd),'SM':'SMR','UA':_0x34f613(0xfd),'VA':_0x34f613(0x128),'XK':'XKX','AM':_0x34f613(0xb2),'AZ':_0x34f613(0x11a),'KZ':_0x34f613(0x139),'KG':_0x34f613(0x12f),'TJ':_0x34f613(0xef),'TM':_0x34f613(0xf6),'UZ':'UZB','US':_0x34f613(0x108),'CA':_0x34f613(0xfe),'AU':_0x34f613(0x10d),'JP':_0x34f613(0xe4),'CN':_0x34f613(0x131),'IN':_0x34f613(0xc5),'BR':'BRA','MX':_0x34f613(0xfb),'AR':_0x34f613(0xf2),'CL':_0x34f613(0xe3),'PE':'PER','CO':_0x34f613(0xa8),'VE':_0x34f613(0xff),'EC':_0x34f613(0x129),'BO':_0x34f613(0x115),'PY':_0x34f613(0x102),'UY':_0x34f613(0xbe),'SR':'SUR','GY':_0x34f613(0xd5),'FK':'FLK','ZA':'ZAF','EG':_0x34f613(0xad),'NG':'NGA','KE':_0x34f613(0xc2),'GH':_0x34f613(0xea),'TZ':'TZA','UG':_0x34f613(0x10b),'ZW':_0x34f613(0x10c),'ZM':_0x34f613(0x9d),'MW':_0x34f613(0x10f),'MZ':_0x34f613(0x12d),'MG':_0x34f613(0xb7),'MU':_0x34f613(0x106),'SC':_0x34f613(0xe7),'RE':'REU','TR':_0x34f613(0xc8),'IR':_0x34f613(0xc6),'IQ':_0x34f613(0xca),'SA':_0x34f613(0x107),'AE':_0x34f613(0x137),'KW':'KWT','QA':_0x34f613(0xac),'BH':_0x34f613(0xdb),'OM':_0x34f613(0x133),'YE':_0x34f613(0x112),'JO':'JOR','LB':_0x34f613(0x11d),'SY':'SYR','IL':_0x34f613(0xb4),'PS':'PSE','KR':_0x34f613(0xaf),'KP':_0x34f613(0x120),'TH':_0x34f613(0xbd),'VN':'VNM','MY':'MYS','SG':_0x34f613(0x109),'ID':_0x34f613(0x114),'PH':_0x34f613(0x12c),'LA':'LAO','KH':_0x34f613(0xab),'MM':_0x34f613(0x9f),'BD':_0x34f613(0x13a),'LK':_0x34f613(0xd0),'NP':'NPL','BT':_0x34f613(0x104),'MV':_0x34f613(0xb3),'AF':_0x34f613(0xf9),'PK':_0x34f613(0x125),'MN':'MNG'},_0x1fa32b=_0x4d0255[_0x2adbfd['toUpperCase']()];if(!_0x1fa32b)return console[_0x34f613(0xed)](_0x34f613(0xda)+_0x2adbfd+_0x34f613(0xa6)),_0x34f613(0xe6);return _0x1fa32b;}async[a46_0x28e1ea(0xd3)](_0x101e68){const _0x2afee4=a46_0x28e1ea;try{const {orderId:_0x2093e5,amount:_0x3acb39,currency:_0x42c872,firstName:_0x34cf93,lastName:_0xc00f88,email:_0x4a43bd,customerIp:_0xcaf6a1,customerCountry:_0x1f6858,successUrl:_0x59134a,failureUrl:_0x4b149b}=_0x101e68;console['log']('🇦🇲\x20Creating\x20AmPay\x20payment\x20link...'),console[_0x2afee4(0xa1)](_0x2afee4(0xee),_0x2093e5),console['log']('Amount:',_0x3acb39,_0x42c872),console[_0x2afee4(0xa1)](_0x2afee4(0xcf),_0x34cf93+'\x20'+_0xc00f88),console['log'](_0x2afee4(0x12e),_0x4a43bd),console[_0x2afee4(0xa1)](_0x2afee4(0xf0),_0xcaf6a1),console[_0x2afee4(0xa1)](_0x2afee4(0xd8),_0x1f6858);const _0x33813d=this['convert2LetterTo3LetterCountryCode'](_0x1f6858);console['log'](_0x2afee4(0xa0),_0x33813d);const _0x4736b4={'sub_method':'GAM','currency':_0x42c872[_0x2afee4(0xec)](),'amount':_0x3acb39,'callback_url':'https://traffer.uk/gateway/ampay/webhook.php','client_merchant_id':this['CLIENT_MERCHANT_ID'],'client_transaction_id':_0x2093e5,'transaction_description':_0x2093e5,'customer':{'ip':_0xcaf6a1,'email':_0x4a43bd,'full_name':_0x34cf93+'\x20'+_0xc00f88,'country':_0x33813d},'success_redirect_url':_0x59134a,'error_redirect_url':_0x4b149b};console[_0x2afee4(0xa1)]('📤\x20AmPay\x20request\x20body:',JSON[_0x2afee4(0x123)](_0x4736b4,null,0x2));const _0x3f7929=await fetch(this['apiUrl']+_0x2afee4(0xc3),{'method':_0x2afee4(0x122),'headers':{'Content-Type':'application/json','User-Agent':_0x2afee4(0x13b)},'body':JSON[_0x2afee4(0x123)](_0x4736b4)}),_0x19eaa7=await _0x3f7929[_0x2afee4(0xe9)]();console[_0x2afee4(0xa1)]('📥\x20AmPay\x20raw\x20response:',_0x19eaa7);if(!_0x3f7929['ok'])throw new Error(_0x2afee4(0xc1)+_0x3f7929[_0x2afee4(0x110)]+_0x2afee4(0x13d)+_0x19eaa7);let _0x3f0049;try{_0x3f0049=JSON[_0x2afee4(0x9c)](_0x19eaa7);}catch(_0x50d9b6){throw new Error(_0x2afee4(0xbb)+_0x19eaa7);}console[_0x2afee4(0xa1)](_0x2afee4(0x136),JSON[_0x2afee4(0x123)](_0x3f0049,null,0x2));if(!_0x3f0049['redirect_url'])throw new Error(_0x2afee4(0x119)+(_0x3f0049['error_message']||_0x3f0049[_0x2afee4(0x101)]||'Unknown\x20error'));const _0x14751f=_0x3f0049[_0x2afee4(0x100)],_0x494a77=_0x3f0049[_0x2afee4(0xc7)],_0x46dff9=_0x3f0049[_0x2afee4(0xe5)];return console[_0x2afee4(0xa1)]('✅\x20AmPay\x20payment\x20link\x20created\x20successfully'),console[_0x2afee4(0xa1)](_0x2afee4(0x121),_0x14751f),console['log'](_0x2afee4(0x116),_0x494a77),console['log'](_0x2afee4(0x135),_0x46dff9),console[_0x2afee4(0xa1)](_0x2afee4(0xf1),_0x3f0049[_0x2afee4(0x110)]),console[_0x2afee4(0xa1)](_0x2afee4(0x118)),{'gateway_payment_id':_0x494a77||_0x46dff9||_0x2093e5,'payment_url':_0x14751f||'','transaction_id':_0x494a77};}catch(_0x257bda){console[_0x2afee4(0x11e)]('❌\x20AmPay\x20payment\x20creation\x20failed:',_0x257bda),console[_0x2afee4(0xa1)](_0x2afee4(0xde));throw _0x257bda;}}async['healthCheck'](){const _0x29e083=a46_0x28e1ea;try{const _0x128a32=await fetch(this['apiUrl']+_0x29e083(0x127),{'method':'GET','headers':{'Content-Type':'application/json','User-Agent':_0x29e083(0x13b)}});return _0x128a32&&_0x128a32[_0x29e083(0x110)]===0xc8?!![]:![];}catch(_0x347272){return console['error'](_0x29e083(0xd7),_0x347272),![];}}async[a46_0x28e1ea(0xbc)](_0x412025){const _0x4151c6=a46_0x28e1ea;console[_0x4151c6(0xa1)](_0x4151c6(0xfa)),console[_0x4151c6(0xa1)](_0x4151c6(0x12a)),console[_0x4151c6(0xa1)](_0x4151c6(0xb1),_0x412025),console[_0x4151c6(0xa1)](_0x4151c6(0x111),typeof _0x412025),console[_0x4151c6(0xa1)](_0x4151c6(0xf8));_0x412025&&typeof _0x412025===_0x4151c6(0x132)&&Object[_0x4151c6(0x134)](_0x412025)[_0x4151c6(0xdc)](_0x4e246e=>{const _0x142b44=_0x4151c6;console[_0x142b44(0xa1)]('\x20\x20'+_0x4e246e+':\x20'+_0x412025[_0x4e246e]+'\x20('+typeof _0x412025[_0x4e246e]+')');});let _0x2080eb=_0x4151c6(0xce);const _0x104450=_0x412025[_0x4151c6(0xa7)]||_0x412025[_0x4151c6(0xc7)]||_0x412025['tracker_id']||'';return console[_0x4151c6(0xa1)]('Extracted\x20payment\x20ID:\x20'+_0x104450),console[_0x4151c6(0xa1)](_0x4151c6(0x13c)+_0x2080eb),!_0x104450&&(console[_0x4151c6(0x11e)](_0x4151c6(0xb5)),console[_0x4151c6(0x11e)](_0x4151c6(0x11c))),{'paymentId':_0x104450,'status':_0x2080eb,'amount':_0x412025[_0x4151c6(0xa3)],'currency':_0x412025[_0x4151c6(0xaa)]};}}exports[a46_0x28e1ea(0xa5)]=AmPayService,exports['ampayService']=new AmPayService();