'use strict';const a54_0x2ea47f=a54_0x18f7;(function(_0x2f65e9,_0x57a671){const _0x35ef60=a54_0x18f7,_0x19f3ef=_0x2f65e9();while(!![]){try{const _0x124c88=-parseInt(_0x35ef60(0x12f))/0x1+-parseInt(_0x35ef60(0xa9))/0x2+parseInt(_0x35ef60(0xf6))/0x3*(parseInt(_0x35ef60(0x10f))/0x4)+-parseInt(_0x35ef60(0x11f))/0x5*(-parseInt(_0x35ef60(0xd3))/0x6)+parseInt(_0x35ef60(0xe5))/0x7*(parseInt(_0x35ef60(0x121))/0x8)+-parseInt(_0x35ef60(0x147))/0x9*(-parseInt(_0x35ef60(0x10b))/0xa)+parseInt(_0x35ef60(0x123))/0xb*(-parseInt(_0x35ef60(0xb4))/0xc);if(_0x124c88===_0x57a671)break;else _0x19f3ef['push'](_0x19f3ef['shift']());}catch(_0x1c5ff6){_0x19f3ef['push'](_0x19f3ef['shift']());}}}(a54_0xb292,0x7fd5d));function a54_0x18f7(_0x15802f,_0x26dd1f){_0x15802f=_0x15802f-0xa5;const _0xb2926b=a54_0xb292();let _0x18f75=_0xb2926b[_0x15802f];return _0x18f75;}Object['defineProperty'](exports,a54_0x2ea47f(0x13e),{'value':!![]}),exports['ampayService']=exports[a54_0x2ea47f(0xf1)]=void 0x0;function a54_0xb292(){const _0x1c3ce4=['TJK','GAM','PER','ðŸ‡¦ðŸ‡²\x20AmPay\x20service\x20initialized\x20with\x20Open\x20Banking\x20AM\x20processing','MUS','__esModule','GEO','KGZ','TUR','ðŸ“¤\x20AmPay\x20request\x20body:','CHL','COL','REU','Unknown\x20error','9EZpsRN','forEach','object','MDV','PRK','VAT','ROU','QAT','createPaymentLink','KOR','PRY','58b59ccbc03dcdcfc20d830edfba765dbf9f3531c692533d84b17938e9c40bda','ZWE','Forced\x20status\x20(webhook\x20disabled):\x20','warn','API_PRIVATE_KEY','HUN','BHR','MEX','1260210PvfgxV','ZAF','redirect_url','KEN','USA','Tracker\x20ID:','UKR','IRN','âœ…\x20AmPay\x20payment\x20link\x20created\x20successfully','ECU','parse','6457524xoQwmH','POL','POST','ðŸ“\x20Logging\x20AmPay\x20payment\x20creation\x20failure...','stringify','IDN','EST','status','ARM','âŒ\x20AmPay\x20payment\x20creation\x20failed:','TrapayAPI/1.0','GUY','MNG','IRQ','system_id','LKA','LIE','processWebhook','LVA','ampay.php','Payment\x20URL:','tracker_id','MYS','BOL','NPL','SYR','FIN','CAN','MLT','BTN','Checked\x20fields:\x20client_transaction_id,\x20system_id,\x20tracker_id','6kCWznC','amount','ALB','BGR','SRB','ðŸ“¥\x20AmPay\x20raw\x20response:','health.php','âŒ\x20AmPay\x20health\x20check\x20failed:','ðŸ‡¦ðŸ‡²\x20Creating\x20AmPay\x20payment\x20link...','\x20-\x20','AmPay\x20API\x20error:\x20HTTP\x20','Webhook\x20data:','ARG','PHL','BIH','SAU','LAO','System\x20ID:','294qiDPoo','SYC','Customer\x20Country\x20(2-letter):','EGY','MDG','Webhook\x20data\x20type:','SVK','HRV','YEM','MNE','Customer:','healthCheck','AmPayService','SWE','client_transaction_id','LBN','ISL','741ruBKeN','keys','NLD','CHN','GRC','NGA','KWT','âš ï¸\x20Unknown\x20country\x20code:\x20','API_PUBLIC_KEY','ARE','ðŸ“Š\x20AmPay\x20response\x20data:','âš ï¸\x20WEBHOOKS\x20TEMPORARILY\x20DISABLED\x20-\x20Always\x20returning\x20PROCESSING\x20status','ITA','DNK','Amount:','RUS','Email:','apiUrl','log','ISR','convert2LetterTo3LetterCountryCode','7320070oOUBBp','BEL','ESP',',\x20using\x20RUS\x20as\x20fallback','11724ZwKfZS','MMR','ZMB','currency','BGD','THA','VEN','ðŸ“\x20Logging\x20AmPay\x20payment\x20creation\x20event...','Customer\x20Country\x20(3-letter):','CLIENT_MERCHANT_ID','MWI','message','DEU','OMN','TKM','error_message','2097330hlkVfo','XKX','47592kCFdfq','PSE','11cBaOea','PRT','toUpperCase','JPN','CZE','KHM','GHA','Status:','AmPay\x20payment\x20creation\x20failed:\x20','TZA','VNM','FRA','433443Kennpa','UZB','GET','AZE','BRA','No\x20payment\x20ID\x20found\x20in\x20webhook\x20data','error','===\x20Processing\x20AmPay\x20webhook\x20===','application/json','CYP'];a54_0xb292=function(){return _0x1c3ce4;};return a54_0xb292();}class AmPayService{constructor(){const _0xa3be4e=a54_0x2ea47f;this[_0xa3be4e(0x118)]='TRAFFER',this[_0xa3be4e(0xfe)]=_0xa3be4e(0x152),this[_0xa3be4e(0xa5)]='a5a059aa63392e571341bddc5148a5db66643722e9a6bf16a9395fb690a80288931d5a1180a85a28eb9f6516cf61dfc1bf4e37898f3a35261cd2db88888d3815',this[_0xa3be4e(0x107)]='https://traffer.uk/gateway/ampay/',console['log'](_0xa3be4e(0x13c));}[a54_0x2ea47f(0x10a)](_0x2a1270){const _0xc7e738=a54_0x2ea47f,_0x5d4cb2={'AD':'AND','AL':_0xc7e738(0xd5),'AT':'AUT','BA':_0xc7e738(0xe1),'BE':_0xc7e738(0x10c),'BG':_0xc7e738(0xd6),'BY':'BLR','CH':'CHE','CY':_0xc7e738(0x138),'CZ':_0xc7e738(0x127),'DE':_0xc7e738(0x11b),'DK':_0xc7e738(0x103),'EE':_0xc7e738(0xba),'ES':_0xc7e738(0x10d),'FI':_0xc7e738(0xce),'FR':_0xc7e738(0x12e),'GB':'GBR','GE':_0xc7e738(0x13f),'GR':_0xc7e738(0xfa),'HR':_0xc7e738(0xec),'HU':_0xc7e738(0xa6),'IE':'IRL','IS':_0xc7e738(0xf5),'IT':_0xc7e738(0x102),'LI':_0xc7e738(0xc4),'LT':'LTU','LU':'LUX','LV':_0xc7e738(0xc6),'MC':'MCO','MD':'MDA','ME':_0xc7e738(0xee),'MK':'MKD','MT':_0xc7e738(0xd0),'NL':_0xc7e738(0xf8),'NO':'NOR','PL':_0xc7e738(0xb5),'PT':_0xc7e738(0x124),'RO':_0xc7e738(0x14d),'RS':_0xc7e738(0xd7),'RU':_0xc7e738(0x105),'SE':_0xc7e738(0xf2),'SI':'SVN','SK':_0xc7e738(0xeb),'SM':'SMR','UA':_0xc7e738(0xaf),'VA':_0xc7e738(0x14c),'XK':_0xc7e738(0x120),'AM':_0xc7e738(0xbc),'AZ':_0xc7e738(0x132),'KZ':'KAZ','KG':_0xc7e738(0x140),'TJ':_0xc7e738(0x139),'TM':_0xc7e738(0x11d),'UZ':_0xc7e738(0x130),'US':_0xc7e738(0xad),'CA':_0xc7e738(0xcf),'AU':'AUS','JP':_0xc7e738(0x126),'CN':_0xc7e738(0xf9),'IN':'IND','BR':_0xc7e738(0x133),'MX':_0xc7e738(0xa8),'AR':_0xc7e738(0xdf),'CL':_0xc7e738(0x143),'PE':_0xc7e738(0x13b),'CO':_0xc7e738(0x144),'VE':_0xc7e738(0x115),'EC':_0xc7e738(0xb2),'BO':_0xc7e738(0xcb),'PY':_0xc7e738(0x151),'UY':'URY','SR':'SUR','GY':_0xc7e738(0xbf),'FK':'FLK','ZA':_0xc7e738(0xaa),'EG':_0xc7e738(0xe8),'NG':_0xc7e738(0xfb),'KE':_0xc7e738(0xac),'GH':_0xc7e738(0x129),'TZ':_0xc7e738(0x12c),'UG':'UGA','ZW':_0xc7e738(0x153),'ZM':_0xc7e738(0x111),'MW':_0xc7e738(0x119),'MZ':'MOZ','MG':_0xc7e738(0xe9),'MU':_0xc7e738(0x13d),'SC':_0xc7e738(0xe6),'RE':_0xc7e738(0x145),'TR':_0xc7e738(0x141),'IR':_0xc7e738(0xb0),'IQ':_0xc7e738(0xc1),'SA':_0xc7e738(0xe2),'AE':_0xc7e738(0xff),'KW':_0xc7e738(0xfc),'QA':_0xc7e738(0x14e),'BH':_0xc7e738(0xa7),'OM':_0xc7e738(0x11c),'YE':_0xc7e738(0xed),'JO':'JOR','LB':_0xc7e738(0xf4),'SY':_0xc7e738(0xcd),'IL':_0xc7e738(0x109),'PS':_0xc7e738(0x122),'KR':_0xc7e738(0x150),'KP':_0xc7e738(0x14b),'TH':_0xc7e738(0x114),'VN':_0xc7e738(0x12d),'MY':_0xc7e738(0xca),'SG':'SGP','ID':_0xc7e738(0xb9),'PH':_0xc7e738(0xe0),'LA':_0xc7e738(0xe3),'KH':_0xc7e738(0x128),'MM':_0xc7e738(0x110),'BD':_0xc7e738(0x113),'LK':_0xc7e738(0xc3),'NP':_0xc7e738(0xcc),'BT':_0xc7e738(0xd1),'MV':_0xc7e738(0x14a),'AF':'AFG','PK':'PAK','MN':_0xc7e738(0xc0)},_0x279667=_0x5d4cb2[_0x2a1270[_0xc7e738(0x125)]()];if(!_0x279667)return console[_0xc7e738(0x155)](_0xc7e738(0xfd)+_0x2a1270+_0xc7e738(0x10e)),_0xc7e738(0x105);return _0x279667;}async[a54_0x2ea47f(0x14f)](_0x31b838){const _0x31426c=a54_0x2ea47f;try{const {orderId:_0xa059f,amount:_0x45cf4b,currency:_0x516e8d,firstName:_0xeac091,lastName:_0x2f2265,email:_0x596352,customerIp:_0x4dd9c3,customerCountry:_0x4a6854,successUrl:_0x294357,failureUrl:_0x459ff6}=_0x31b838;console[_0x31426c(0x108)](_0x31426c(0xdb)),console[_0x31426c(0x108)]('Order\x20ID:',_0xa059f),console[_0x31426c(0x108)](_0x31426c(0x104),_0x45cf4b,_0x516e8d),console['log'](_0x31426c(0xef),_0xeac091+'\x20'+_0x2f2265),console[_0x31426c(0x108)](_0x31426c(0x106),_0x596352),console[_0x31426c(0x108)]('Customer\x20IP:',_0x4dd9c3),console[_0x31426c(0x108)](_0x31426c(0xe7),_0x4a6854);const _0x4dc3aa=this['convert2LetterTo3LetterCountryCode'](_0x4a6854);console[_0x31426c(0x108)](_0x31426c(0x117),_0x4dc3aa);const _0x4213f1={'sub_method':_0x31426c(0x13a),'currency':_0x516e8d[_0x31426c(0x125)](),'amount':_0x45cf4b,'callback_url':'https://traffer.uk/gateway/ampay/webhook.php','client_merchant_id':this[_0x31426c(0x118)],'client_transaction_id':_0xa059f,'transaction_description':_0xa059f,'customer':{'ip':_0x4dd9c3,'email':_0x596352,'full_name':_0xeac091+'\x20'+_0x2f2265,'country':_0x4dc3aa},'success_redirect_url':_0x294357,'error_redirect_url':_0x459ff6};console[_0x31426c(0x108)](_0x31426c(0x142),JSON[_0x31426c(0xb8)](_0x4213f1,null,0x2));const _0x123a5d=await fetch(this['apiUrl']+_0x31426c(0xc7),{'method':_0x31426c(0xb6),'headers':{'Content-Type':'application/json','User-Agent':_0x31426c(0xbe)},'body':JSON[_0x31426c(0xb8)](_0x4213f1)}),_0x330b7d=await _0x123a5d['text']();console[_0x31426c(0x108)](_0x31426c(0xd8),_0x330b7d);if(!_0x123a5d['ok'])throw new Error(_0x31426c(0xdd)+_0x123a5d[_0x31426c(0xbb)]+_0x31426c(0xdc)+_0x330b7d);let _0x3d6b62;try{_0x3d6b62=JSON[_0x31426c(0xb3)](_0x330b7d);}catch(_0x2e9e9f){throw new Error('Invalid\x20JSON\x20response\x20from\x20AmPay:\x20'+_0x330b7d);}console['log'](_0x31426c(0x100),JSON[_0x31426c(0xb8)](_0x3d6b62,null,0x2));if(!_0x3d6b62[_0x31426c(0xab)])throw new Error(_0x31426c(0x12b)+(_0x3d6b62[_0x31426c(0x11e)]||_0x3d6b62[_0x31426c(0x11a)]||_0x31426c(0x146)));const _0x34389d=_0x3d6b62['redirect_url'],_0x41cf26=_0x3d6b62['system_id'],_0x198cf9=_0x3d6b62['tracker_id'];return console[_0x31426c(0x108)](_0x31426c(0xb1)),console['log'](_0x31426c(0xc8),_0x34389d),console[_0x31426c(0x108)](_0x31426c(0xe4),_0x41cf26),console[_0x31426c(0x108)](_0x31426c(0xae),_0x198cf9),console[_0x31426c(0x108)](_0x31426c(0x12a),_0x3d6b62[_0x31426c(0xbb)]),console['log'](_0x31426c(0x116)),{'gateway_payment_id':_0x41cf26||_0x198cf9||_0xa059f,'payment_url':_0x34389d||'','transaction_id':_0x41cf26};}catch(_0x102517){console['error'](_0x31426c(0xbd),_0x102517),console[_0x31426c(0x108)](_0x31426c(0xb7));throw _0x102517;}}async[a54_0x2ea47f(0xf0)](){const _0x5cdd2a=a54_0x2ea47f;try{const _0x5f1e5e=await fetch(this[_0x5cdd2a(0x107)]+_0x5cdd2a(0xd9),{'method':_0x5cdd2a(0x131),'headers':{'Content-Type':_0x5cdd2a(0x137),'User-Agent':'TrapayAPI/1.0'}});return _0x5f1e5e&&_0x5f1e5e[_0x5cdd2a(0xbb)]===0xc8?!![]:![];}catch(_0x162c3d){return console[_0x5cdd2a(0x135)](_0x5cdd2a(0xda),_0x162c3d),![];}}async[a54_0x2ea47f(0xc5)](_0x22993f){const _0x4e81f1=a54_0x2ea47f;console[_0x4e81f1(0x108)](_0x4e81f1(0x136)),console[_0x4e81f1(0x108)](_0x4e81f1(0x101)),console[_0x4e81f1(0x108)](_0x4e81f1(0xde),_0x22993f),console[_0x4e81f1(0x108)](_0x4e81f1(0xea),typeof _0x22993f),console[_0x4e81f1(0x108)]('Available\x20fields:');_0x22993f&&typeof _0x22993f===_0x4e81f1(0x149)&&Object[_0x4e81f1(0xf7)](_0x22993f)[_0x4e81f1(0x148)](_0x57ba90=>{console['log']('\x20\x20'+_0x57ba90+':\x20'+_0x22993f[_0x57ba90]+'\x20('+typeof _0x22993f[_0x57ba90]+')');});let _0x16b977='PENDING';const _0x2b346b=_0x22993f[_0x4e81f1(0xf3)]||_0x22993f[_0x4e81f1(0xc2)]||_0x22993f[_0x4e81f1(0xc9)]||'';return console[_0x4e81f1(0x108)]('Extracted\x20payment\x20ID:\x20'+_0x2b346b),console['log'](_0x4e81f1(0x154)+_0x16b977),!_0x2b346b&&(console[_0x4e81f1(0x135)](_0x4e81f1(0x134)),console[_0x4e81f1(0x135)](_0x4e81f1(0xd2))),{'paymentId':_0x2b346b,'status':_0x16b977,'amount':_0x22993f[_0x4e81f1(0xd4)],'currency':_0x22993f[_0x4e81f1(0x112)]};}}exports[a54_0x2ea47f(0xf1)]=AmPayService,exports['ampayService']=new AmPayService();