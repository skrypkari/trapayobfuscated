'use strict';const a56_0x593142=a56_0x16eb;(function(_0x450420,_0x434ae){const _0x39f855=a56_0x16eb,_0x2a66b5=_0x450420();while(!![]){try{const _0xea209c=parseInt(_0x39f855(0x186))/0x1*(parseInt(_0x39f855(0x1c0))/0x2)+parseInt(_0x39f855(0x179))/0x3*(parseInt(_0x39f855(0x1b0))/0x4)+-parseInt(_0x39f855(0x1b7))/0x5+parseInt(_0x39f855(0x19f))/0x6+parseInt(_0x39f855(0x187))/0x7+parseInt(_0x39f855(0x170))/0x8+-parseInt(_0x39f855(0x1e0))/0x9*(parseInt(_0x39f855(0x190))/0xa);if(_0xea209c===_0x434ae)break;else _0x2a66b5['push'](_0x2a66b5['shift']());}catch(_0x2a7277){_0x2a66b5['push'](_0x2a66b5['shift']());}}}(a56_0x1448,0x4fec9));function a56_0x1448(){const _0xdc315=['system_id','2160456DfapKR','IDN','ðŸ“¥\x20AmPay\x20raw\x20response:','TrapayAPI/1.0','AND','Customer:','__esModule','BRA','log','87ObcZRp','IND','KEN','MYS','TKM','toUpperCase','object','UKR','XKX','BEL','EGY','healthCheck','Tracker\x20ID:','1282ooIMQz','23359wbEQJU','tracker_id','Unknown\x20error','redirect_url','defineProperty','MDA','PAK','SYR','PRK','35800QtQFfV','HUN','ZMB','Available\x20fields:','KGZ','Invalid\x20JSON\x20response\x20from\x20AmPay:\x20','apiUrl','âœ…\x20AmPay\x20payment\x20link\x20created\x20successfully','MDV','Email:','CHN','MMR','KAZ','convert2LetterTo3LetterCountryCode','SAU','917472sOGlfQ','TRAFFER','Amount:','OMN','AZE','COL','SWE','LUX','ALB','Forced\x20status\x20(webhook\x20disabled):\x20','keys','PSE','ZAF','FLK','MKD','MEX','MNE','24116LOSIln','LTU','SUR','ampay.php','IRL','\x20-\x20','MCO','1447360dNCRAR','message','CZE','GAM','error_message','VAT','error','BLR','YEM','354KTbPDZ','ampayService','IRQ','AFG','BIH','CLIENT_MERCHANT_ID','CAN','ITA','status','CHL','âš ï¸\x20Unknown\x20country\x20code:\x20','BOL','AmPayService','AUS','Customer\x20Country\x20(2-letter):','âŒ\x20AmPay\x20health\x20check\x20failed:','FRA','client_transaction_id','POST','Customer\x20IP:','BTN','UZB','VEN','CYP','AUT','AmPay\x20API\x20error:\x20HTTP\x20','ISL','SRB','LIE','a5a059aa63392e571341bddc5148a5db66643722e9a6bf16a9395fb690a80288931d5a1180a85a28eb9f6516cf61dfc1bf4e37898f3a35261cd2db88888d3815','Payment\x20URL:','GHA','531hLzGQD','ðŸ“Š\x20AmPay\x20response\x20data:','parse','ARM','No\x20payment\x20ID\x20found\x20in\x20webhook\x20data','API_PUBLIC_KEY','LKA','text','EST','ESP','TUR','LAO','RUS','ZWE','application/json','stringify','MNG','BHR','âš ï¸\x20WEBHOOKS\x20TEMPORARILY\x20DISABLED\x20-\x20Always\x20returning\x20PROCESSING\x20status','QAT','PRY','VNM','SVN','Status:','ISR','MUS','forEach','ARG','ðŸ‡¦ðŸ‡²\x20Creating\x20AmPay\x20payment\x20link...','Webhook\x20data\x20type:','processWebhook','GBR','System\x20ID:','Order\x20ID:','ðŸ‡¦ðŸ‡²\x20AmPay\x20service\x20initialized\x20with\x20Open\x20Banking\x20AM\x20processing','MDG','URY','FIN','AmPay\x20payment\x20creation\x20failed:\x20','BGR','amount','TJK','CHE','ðŸ“¤\x20AmPay\x20request\x20body:','NLD','THA','ROU'];a56_0x1448=function(){return _0xdc315;};return a56_0x1448();}Object[a56_0x593142(0x18b)](exports,a56_0x593142(0x176),{'value':!![]}),exports[a56_0x593142(0x1c1)]=exports[a56_0x593142(0x1cc)]=void 0x0;function a56_0x16eb(_0x3cc74a,_0x3a426e){_0x3cc74a=_0x3cc74a-0x15b;const _0x1448d0=a56_0x1448();let _0x16eb29=_0x1448d0[_0x3cc74a];return _0x16eb29;}class AmPayService{constructor(){const _0x2e6ce8=a56_0x593142;this[_0x2e6ce8(0x1c5)]=_0x2e6ce8(0x1a0),this[_0x2e6ce8(0x1e5)]='58b59ccbc03dcdcfc20d830edfba765dbf9f3531c692533d84b17938e9c40bda',this['API_PRIVATE_KEY']=_0x2e6ce8(0x1dd),this[_0x2e6ce8(0x196)]='https://traffer.uk/gateway/ampay/',console[_0x2e6ce8(0x178)](_0x2e6ce8(0x162));}[a56_0x593142(0x19d)](_0x421ead){const _0x1a94d0=a56_0x593142,_0x2fcb92={'AD':_0x1a94d0(0x174),'AL':_0x1a94d0(0x1a7),'AT':_0x1a94d0(0x1d8),'BA':_0x1a94d0(0x1c4),'BE':_0x1a94d0(0x182),'BG':_0x1a94d0(0x167),'BY':_0x1a94d0(0x1be),'CH':_0x1a94d0(0x16a),'CY':_0x1a94d0(0x1d7),'CZ':_0x1a94d0(0x1b9),'DE':'DEU','DK':'DNK','EE':_0x1a94d0(0x1e8),'ES':_0x1a94d0(0x1e9),'FI':_0x1a94d0(0x165),'FR':_0x1a94d0(0x1d0),'GB':_0x1a94d0(0x15f),'GE':'GEO','GR':'GRC','HR':'HRV','HU':_0x1a94d0(0x191),'IE':_0x1a94d0(0x1b4),'IS':_0x1a94d0(0x1da),'IT':_0x1a94d0(0x1c7),'LI':_0x1a94d0(0x1dc),'LT':_0x1a94d0(0x1b1),'LU':_0x1a94d0(0x1a6),'LV':'LVA','MC':_0x1a94d0(0x1b6),'MD':_0x1a94d0(0x18c),'ME':_0x1a94d0(0x1af),'MK':_0x1a94d0(0x1ad),'MT':'MLT','NL':_0x1a94d0(0x16c),'NO':'NOR','PL':'POL','PT':'PRT','RO':_0x1a94d0(0x16e),'RS':_0x1a94d0(0x1db),'RU':_0x1a94d0(0x1ec),'SE':_0x1a94d0(0x1a5),'SI':_0x1a94d0(0x1f6),'SK':'SVK','SM':'SMR','UA':_0x1a94d0(0x180),'VA':_0x1a94d0(0x1bc),'XK':_0x1a94d0(0x181),'AM':_0x1a94d0(0x1e3),'AZ':_0x1a94d0(0x1a3),'KZ':_0x1a94d0(0x19c),'KG':_0x1a94d0(0x194),'TJ':_0x1a94d0(0x169),'TM':_0x1a94d0(0x17d),'UZ':_0x1a94d0(0x1d5),'US':'USA','CA':_0x1a94d0(0x1c6),'AU':_0x1a94d0(0x1cd),'JP':'JPN','CN':_0x1a94d0(0x19a),'IN':_0x1a94d0(0x17a),'BR':_0x1a94d0(0x177),'MX':_0x1a94d0(0x1ae),'AR':_0x1a94d0(0x15b),'CL':_0x1a94d0(0x1c9),'PE':'PER','CO':_0x1a94d0(0x1a4),'VE':_0x1a94d0(0x1d6),'EC':'ECU','BO':_0x1a94d0(0x1cb),'PY':_0x1a94d0(0x1f4),'UY':_0x1a94d0(0x164),'SR':_0x1a94d0(0x1b2),'GY':'GUY','FK':_0x1a94d0(0x1ac),'ZA':_0x1a94d0(0x1ab),'EG':_0x1a94d0(0x183),'NG':'NGA','KE':_0x1a94d0(0x17b),'GH':_0x1a94d0(0x1df),'TZ':'TZA','UG':'UGA','ZW':_0x1a94d0(0x1ed),'ZM':_0x1a94d0(0x192),'MW':'MWI','MZ':'MOZ','MG':_0x1a94d0(0x163),'MU':_0x1a94d0(0x1f9),'SC':'SYC','RE':'REU','TR':_0x1a94d0(0x1ea),'IR':'IRN','IQ':_0x1a94d0(0x1c2),'SA':_0x1a94d0(0x19e),'AE':'ARE','KW':'KWT','QA':_0x1a94d0(0x1f3),'BH':_0x1a94d0(0x1f1),'OM':_0x1a94d0(0x1a2),'YE':_0x1a94d0(0x1bf),'JO':'JOR','LB':'LBN','SY':_0x1a94d0(0x18e),'IL':_0x1a94d0(0x1f8),'PS':_0x1a94d0(0x1aa),'KR':'KOR','KP':_0x1a94d0(0x18f),'TH':_0x1a94d0(0x16d),'VN':_0x1a94d0(0x1f5),'MY':_0x1a94d0(0x17c),'SG':'SGP','ID':_0x1a94d0(0x171),'PH':'PHL','LA':_0x1a94d0(0x1eb),'KH':'KHM','MM':_0x1a94d0(0x19b),'BD':'BGD','LK':_0x1a94d0(0x1e6),'NP':'NPL','BT':_0x1a94d0(0x1d4),'MV':_0x1a94d0(0x198),'AF':_0x1a94d0(0x1c3),'PK':_0x1a94d0(0x18d),'MN':_0x1a94d0(0x1f0)},_0x160dd1=_0x2fcb92[_0x421ead[_0x1a94d0(0x17e)]()];if(!_0x160dd1)return console['warn'](_0x1a94d0(0x1ca)+_0x421ead+',\x20using\x20RUS\x20as\x20fallback'),_0x1a94d0(0x1ec);return _0x160dd1;}async['createPaymentLink'](_0x190e39){const _0x2c63e6=a56_0x593142;try{const {orderId:_0x19b549,amount:_0x59f797,currency:_0x5602b0,firstName:_0x26cae1,lastName:_0x607856,email:_0x33ea2a,customerIp:_0x1a0a7f,customerCountry:_0x453cd1,successUrl:_0x12c2dc,failureUrl:_0x36ab39}=_0x190e39;console[_0x2c63e6(0x178)](_0x2c63e6(0x15c)),console['log'](_0x2c63e6(0x161),_0x19b549),console[_0x2c63e6(0x178)](_0x2c63e6(0x1a1),_0x59f797,_0x5602b0),console[_0x2c63e6(0x178)](_0x2c63e6(0x175),_0x26cae1+'\x20'+_0x607856),console[_0x2c63e6(0x178)](_0x2c63e6(0x199),_0x33ea2a),console['log'](_0x2c63e6(0x1d3),_0x1a0a7f),console[_0x2c63e6(0x178)](_0x2c63e6(0x1ce),_0x453cd1);const _0x5ea83f=this['convert2LetterTo3LetterCountryCode'](_0x453cd1);console[_0x2c63e6(0x178)]('Customer\x20Country\x20(3-letter):',_0x5ea83f);const _0xff8dfc={'sub_method':_0x2c63e6(0x1ba),'currency':_0x5602b0[_0x2c63e6(0x17e)](),'amount':_0x59f797,'callback_url':'https://traffer.uk/gateway/ampay/webhook.php','client_merchant_id':this[_0x2c63e6(0x1c5)],'client_transaction_id':_0x19b549,'transaction_description':_0x19b549,'customer':{'ip':_0x1a0a7f,'email':_0x33ea2a,'full_name':_0x26cae1+'\x20'+_0x607856,'country':_0x5ea83f},'success_redirect_url':_0x12c2dc,'error_redirect_url':_0x36ab39};console[_0x2c63e6(0x178)](_0x2c63e6(0x16b),JSON['stringify'](_0xff8dfc,null,0x2));const _0x98835e=await fetch(this[_0x2c63e6(0x196)]+_0x2c63e6(0x1b3),{'method':_0x2c63e6(0x1d2),'headers':{'Content-Type':_0x2c63e6(0x1ee),'User-Agent':_0x2c63e6(0x173)},'body':JSON[_0x2c63e6(0x1ef)](_0xff8dfc)}),_0x2dffa8=await _0x98835e[_0x2c63e6(0x1e7)]();console[_0x2c63e6(0x178)](_0x2c63e6(0x172),_0x2dffa8);if(!_0x98835e['ok'])throw new Error(_0x2c63e6(0x1d9)+_0x98835e[_0x2c63e6(0x1c8)]+_0x2c63e6(0x1b5)+_0x2dffa8);let _0x2d446d;try{_0x2d446d=JSON[_0x2c63e6(0x1e2)](_0x2dffa8);}catch(_0x9edcc){throw new Error(_0x2c63e6(0x195)+_0x2dffa8);}console['log'](_0x2c63e6(0x1e1),JSON[_0x2c63e6(0x1ef)](_0x2d446d,null,0x2));if(!_0x2d446d[_0x2c63e6(0x18a)])throw new Error(_0x2c63e6(0x166)+(_0x2d446d[_0x2c63e6(0x1bb)]||_0x2d446d[_0x2c63e6(0x1b8)]||_0x2c63e6(0x189)));const _0xf8da80=_0x2d446d['redirect_url'],_0x4cfb60=_0x2d446d[_0x2c63e6(0x16f)],_0x505908=_0x2d446d[_0x2c63e6(0x188)];return console[_0x2c63e6(0x178)](_0x2c63e6(0x197)),console['log'](_0x2c63e6(0x1de),_0xf8da80),console[_0x2c63e6(0x178)](_0x2c63e6(0x160),_0x4cfb60),console['log'](_0x2c63e6(0x185),_0x505908),console['log'](_0x2c63e6(0x1f7),_0x2d446d[_0x2c63e6(0x1c8)]),console[_0x2c63e6(0x178)]('ðŸ“\x20Logging\x20AmPay\x20payment\x20creation\x20event...'),{'gateway_payment_id':_0x4cfb60||_0x505908||_0x19b549,'payment_url':_0xf8da80||'','transaction_id':_0x4cfb60};}catch(_0x25af9f){console[_0x2c63e6(0x1bd)]('âŒ\x20AmPay\x20payment\x20creation\x20failed:',_0x25af9f),console[_0x2c63e6(0x178)]('ðŸ“\x20Logging\x20AmPay\x20payment\x20creation\x20failure...');throw _0x25af9f;}}async[a56_0x593142(0x184)](){const _0x3b406f=a56_0x593142;try{const _0x252815=await fetch(this[_0x3b406f(0x196)]+'health.php',{'method':'GET','headers':{'Content-Type':_0x3b406f(0x1ee),'User-Agent':_0x3b406f(0x173)}});return _0x252815&&_0x252815[_0x3b406f(0x1c8)]===0xc8?!![]:![];}catch(_0x403a40){return console[_0x3b406f(0x1bd)](_0x3b406f(0x1cf),_0x403a40),![];}}async[a56_0x593142(0x15e)](_0x45a6aa){const _0x4ab55c=a56_0x593142;console[_0x4ab55c(0x178)]('===\x20Processing\x20AmPay\x20webhook\x20==='),console['log'](_0x4ab55c(0x1f2)),console[_0x4ab55c(0x178)]('Webhook\x20data:',_0x45a6aa),console['log'](_0x4ab55c(0x15d),typeof _0x45a6aa),console[_0x4ab55c(0x178)](_0x4ab55c(0x193));_0x45a6aa&&typeof _0x45a6aa===_0x4ab55c(0x17f)&&Object[_0x4ab55c(0x1a9)](_0x45a6aa)[_0x4ab55c(0x1fa)](_0x3bd47a=>{const _0x5b1df1=_0x4ab55c;console[_0x5b1df1(0x178)]('\x20\x20'+_0x3bd47a+':\x20'+_0x45a6aa[_0x3bd47a]+'\x20('+typeof _0x45a6aa[_0x3bd47a]+')');});let _0x11e505='PENDING';const _0x49120d=_0x45a6aa[_0x4ab55c(0x1d1)]||_0x45a6aa[_0x4ab55c(0x16f)]||_0x45a6aa[_0x4ab55c(0x188)]||'';return console[_0x4ab55c(0x178)]('Extracted\x20payment\x20ID:\x20'+_0x49120d),console[_0x4ab55c(0x178)](_0x4ab55c(0x1a8)+_0x11e505),!_0x49120d&&(console[_0x4ab55c(0x1bd)](_0x4ab55c(0x1e4)),console['error']('Checked\x20fields:\x20client_transaction_id,\x20system_id,\x20tracker_id')),{'paymentId':_0x49120d,'status':_0x11e505,'amount':_0x45a6aa[_0x4ab55c(0x168)],'currency':_0x45a6aa['currency']};}}exports[a56_0x593142(0x1cc)]=AmPayService,exports[a56_0x593142(0x1c1)]=new AmPayService();