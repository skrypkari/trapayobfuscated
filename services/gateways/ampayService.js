'use strict';const a52_0x434034=a52_0x59ab;(function(_0x3fcc07,_0x168c8d){const _0xae56a4=a52_0x59ab,_0xf23f10=_0x3fcc07();while(!![]){try{const _0x219f56=parseInt(_0xae56a4(0x164))/0x1+parseInt(_0xae56a4(0xd8))/0x2*(-parseInt(_0xae56a4(0x13e))/0x3)+parseInt(_0xae56a4(0x114))/0x4+-parseInt(_0xae56a4(0xdb))/0x5+parseInt(_0xae56a4(0x136))/0x6*(-parseInt(_0xae56a4(0xcc))/0x7)+parseInt(_0xae56a4(0x14d))/0x8+parseInt(_0xae56a4(0x125))/0x9*(-parseInt(_0xae56a4(0x122))/0xa);if(_0x219f56===_0x168c8d)break;else _0xf23f10['push'](_0xf23f10['shift']());}catch(_0x419a6){_0xf23f10['push'](_0xf23f10['shift']());}}}(a52_0x4ffb,0x3d89a));function a52_0x4ffb(){const _0x176dc5=['toUpperCase','IRN','OMN','ðŸ‡¦ðŸ‡²\x20Creating\x20AmPay\x20payment\x20link...','LUX','ðŸ“Š\x20AmPay\x20response\x20data:','tracker_id','ARM','CHL','processWebhook','GRC','PSE','BOL','MMR','AmPayService','DNK','Email:','MUS','âš ï¸\x20WEBHOOKS\x20TEMPORARILY\x20DISABLED\x20-\x20Always\x20returning\x20PROCESSING\x20status','Customer:','EST','UZB','QAT','MDG','FLK','ampayService','KGZ','ROU','BLR','UGA','log','text','ZMB','Webhook\x20data:','Amount:','CZE','URY','PRT','PENDING','TZA','application/json','MDV','1716040WtvhTN','stringify','CLIENT_MERCHANT_ID','MNG','LTU','DEU','Checked\x20fields:\x20client_transaction_id,\x20system_id,\x20tracker_id','health.php','SYC','BIH','GET','IND','ARG','GAM','180iAexkB','EGY','https://traffer.uk/gateway/ampay/webhook.php','170676osHXNo','58b59ccbc03dcdcfc20d830edfba765dbf9f3531c692533d84b17938e9c40bda','KAZ','redirect_url','âŒ\x20AmPay\x20payment\x20creation\x20failed:','status','TUR','KHM','ESP','AFG','LVA','SRB','MKD','CYP','defineProperty','VAT','ðŸ“\x20Logging\x20AmPay\x20payment\x20creation\x20event...','6EmtJAn','FIN','===\x20Processing\x20AmPay\x20webhook\x20===','parse','PRK','COL','API_PUBLIC_KEY','POST','153jWzlLc','MEX','TRAFFER','ampay.php','AmPay\x20API\x20error:\x20HTTP\x20','ZWE','HRV','MWI','MCO','JPN','VNM','ISR','Available\x20fields:','REU','https://traffer.uk/gateway/ampay/','79608oSZScE','Status:','SYR','NOR','apiUrl','MDA','Unknown\x20error','SVK','Forced\x20status\x20(webhook\x20disabled):\x20','GHA','LBN','amount','BHR','MYS','âœ…\x20AmPay\x20payment\x20link\x20created\x20successfully','GEO','YEM','system_id','keys','BGR','NGA','__esModule','ITA','389534KfaiLy','AmPay\x20payment\x20creation\x20failed:\x20','IDN','KWT','Customer\x20Country\x20(2-letter):','LAO','SMR','CAN','LIE','object','MOZ','MNE','NLD','898163UmoSuX','error','POL','SGP','KOR','PER','AUS','SVN','client_transaction_id','LKA',',\x20using\x20RUS\x20as\x20fallback','JOR','2894FxwXwg','CHN','createPaymentLink','164895iYEbDW','healthCheck','TrapayAPI/1.0','message','RUS','ðŸ‡¦ðŸ‡²\x20AmPay\x20service\x20initialized\x20with\x20Open\x20Banking\x20AM\x20processing','Payment\x20URL:','Invalid\x20JSON\x20response\x20from\x20AmPay:\x20','Tracker\x20ID:','convert2LetterTo3LetterCountryCode','ðŸ“¤\x20AmPay\x20request\x20body:','Customer\x20Country\x20(3-letter):','SAU','ðŸ“¥\x20AmPay\x20raw\x20response:','FRA'];a52_0x4ffb=function(){return _0x176dc5;};return a52_0x4ffb();}function a52_0x59ab(_0x49cfd9,_0x2b7661){_0x49cfd9=_0x49cfd9-0xc9;const _0x4ffb35=a52_0x4ffb();let _0x59ab88=_0x4ffb35[_0x49cfd9];return _0x59ab88;}Object[a52_0x434034(0x133)](exports,a52_0x434034(0x162),{'value':!![]}),exports[a52_0x434034(0x103)]=exports[a52_0x434034(0xf8)]=void 0x0;class AmPayService{constructor(){const _0x4863a9=a52_0x434034;this[_0x4863a9(0x116)]=_0x4863a9(0x140),this[_0x4863a9(0x13c)]=_0x4863a9(0x126),this['API_PRIVATE_KEY']='a5a059aa63392e571341bddc5148a5db66643722e9a6bf16a9395fb690a80288931d5a1180a85a28eb9f6516cf61dfc1bf4e37898f3a35261cd2db88888d3815',this[_0x4863a9(0x151)]=_0x4863a9(0x14c),console[_0x4863a9(0x108)](_0x4863a9(0xe0));}[a52_0x434034(0xe4)](_0x31a6fa){const _0x1c81df=a52_0x434034,_0x53c201={'AD':'AND','AL':'ALB','AT':'AUT','BA':_0x1c81df(0x11d),'BE':'BEL','BG':_0x1c81df(0x160),'BY':_0x1c81df(0x106),'CH':'CHE','CY':_0x1c81df(0x132),'CZ':_0x1c81df(0x10d),'DE':_0x1c81df(0x119),'DK':_0x1c81df(0xf9),'EE':_0x1c81df(0xfe),'ES':_0x1c81df(0x12d),'FI':_0x1c81df(0x137),'FR':_0x1c81df(0xe9),'GB':'GBR','GE':_0x1c81df(0x15c),'GR':_0x1c81df(0xf4),'HR':_0x1c81df(0x144),'HU':'HUN','IE':'IRL','IS':'ISL','IT':_0x1c81df(0x163),'LI':_0x1c81df(0x16c),'LT':_0x1c81df(0x118),'LU':_0x1c81df(0xee),'LV':_0x1c81df(0x12f),'MC':_0x1c81df(0x146),'MD':_0x1c81df(0x152),'ME':_0x1c81df(0xca),'MK':_0x1c81df(0x131),'MT':'MLT','NL':_0x1c81df(0xcb),'NO':_0x1c81df(0x150),'PL':_0x1c81df(0xce),'PT':_0x1c81df(0x10f),'RO':_0x1c81df(0x105),'RS':_0x1c81df(0x130),'RU':'RUS','SE':'SWE','SI':_0x1c81df(0xd3),'SK':_0x1c81df(0x154),'SM':_0x1c81df(0x16a),'UA':'UKR','VA':_0x1c81df(0x134),'XK':'XKX','AM':_0x1c81df(0xf1),'AZ':'AZE','KZ':_0x1c81df(0x127),'KG':_0x1c81df(0x104),'TJ':'TJK','TM':'TKM','UZ':_0x1c81df(0xff),'US':'USA','CA':_0x1c81df(0x16b),'AU':_0x1c81df(0xd2),'JP':_0x1c81df(0x147),'CN':_0x1c81df(0xd9),'IN':_0x1c81df(0x11f),'BR':'BRA','MX':_0x1c81df(0x13f),'AR':_0x1c81df(0x120),'CL':_0x1c81df(0xf2),'PE':_0x1c81df(0xd1),'CO':_0x1c81df(0x13b),'VE':'VEN','EC':'ECU','BO':_0x1c81df(0xf6),'PY':'PRY','UY':_0x1c81df(0x10e),'SR':'SUR','GY':'GUY','FK':_0x1c81df(0x102),'ZA':'ZAF','EG':_0x1c81df(0x123),'NG':_0x1c81df(0x161),'KE':'KEN','GH':_0x1c81df(0x156),'TZ':_0x1c81df(0x111),'UG':_0x1c81df(0x107),'ZW':_0x1c81df(0x143),'ZM':_0x1c81df(0x10a),'MW':_0x1c81df(0x145),'MZ':_0x1c81df(0xc9),'MG':_0x1c81df(0x101),'MU':_0x1c81df(0xfb),'SC':_0x1c81df(0x11c),'RE':_0x1c81df(0x14b),'TR':_0x1c81df(0x12b),'IR':_0x1c81df(0xeb),'IQ':'IRQ','SA':_0x1c81df(0xe7),'AE':'ARE','KW':_0x1c81df(0x167),'QA':_0x1c81df(0x100),'BH':_0x1c81df(0x159),'OM':_0x1c81df(0xec),'YE':_0x1c81df(0x15d),'JO':_0x1c81df(0xd7),'LB':_0x1c81df(0x157),'SY':_0x1c81df(0x14f),'IL':_0x1c81df(0x149),'PS':_0x1c81df(0xf5),'KR':_0x1c81df(0xd0),'KP':_0x1c81df(0x13a),'TH':'THA','VN':_0x1c81df(0x148),'MY':_0x1c81df(0x15a),'SG':_0x1c81df(0xcf),'ID':_0x1c81df(0x166),'PH':'PHL','LA':_0x1c81df(0x169),'KH':_0x1c81df(0x12c),'MM':_0x1c81df(0xf7),'BD':'BGD','LK':_0x1c81df(0xd5),'NP':'NPL','BT':'BTN','MV':_0x1c81df(0x113),'AF':_0x1c81df(0x12e),'PK':'PAK','MN':_0x1c81df(0x117)},_0x2fd58d=_0x53c201[_0x31a6fa[_0x1c81df(0xea)]()];if(!_0x2fd58d)return console['warn']('âš ï¸\x20Unknown\x20country\x20code:\x20'+_0x31a6fa+_0x1c81df(0xd6)),_0x1c81df(0xdf);return _0x2fd58d;}async[a52_0x434034(0xda)](_0x50792e){const _0x5702f8=a52_0x434034;try{const {orderId:_0x55c776,amount:_0x1db5e6,currency:_0xb719d0,firstName:_0x4496d4,lastName:_0x4e0939,email:_0x4b1e72,customerIp:_0x3ba014,customerCountry:_0x28aed5,successUrl:_0x44afe5,failureUrl:_0x41f2ad}=_0x50792e;console[_0x5702f8(0x108)](_0x5702f8(0xed)),console[_0x5702f8(0x108)]('Order\x20ID:',_0x55c776),console[_0x5702f8(0x108)](_0x5702f8(0x10c),_0x1db5e6,_0xb719d0),console['log'](_0x5702f8(0xfd),_0x4496d4+'\x20'+_0x4e0939),console[_0x5702f8(0x108)](_0x5702f8(0xfa),_0x4b1e72),console[_0x5702f8(0x108)]('Customer\x20IP:',_0x3ba014),console[_0x5702f8(0x108)](_0x5702f8(0x168),_0x28aed5);const _0x1efcfd=this[_0x5702f8(0xe4)](_0x28aed5);console[_0x5702f8(0x108)](_0x5702f8(0xe6),_0x1efcfd);const _0x3ada79={'sub_method':_0x5702f8(0x121),'currency':_0xb719d0[_0x5702f8(0xea)](),'amount':_0x1db5e6,'callback_url':_0x5702f8(0x124),'client_merchant_id':this['CLIENT_MERCHANT_ID'],'client_transaction_id':_0x55c776,'transaction_description':_0x55c776,'customer':{'ip':_0x3ba014,'email':_0x4b1e72,'full_name':_0x4496d4+'\x20'+_0x4e0939,'country':_0x1efcfd},'success_redirect_url':_0x44afe5,'error_redirect_url':_0x41f2ad};console[_0x5702f8(0x108)](_0x5702f8(0xe5),JSON['stringify'](_0x3ada79,null,0x2));const _0x2e05a7=await fetch(this[_0x5702f8(0x151)]+_0x5702f8(0x141),{'method':_0x5702f8(0x13d),'headers':{'Content-Type':'application/json','User-Agent':_0x5702f8(0xdd)},'body':JSON[_0x5702f8(0x115)](_0x3ada79)}),_0x2b6e91=await _0x2e05a7[_0x5702f8(0x109)]();console[_0x5702f8(0x108)](_0x5702f8(0xe8),_0x2b6e91);if(!_0x2e05a7['ok'])throw new Error(_0x5702f8(0x142)+_0x2e05a7[_0x5702f8(0x12a)]+'\x20-\x20'+_0x2b6e91);let _0x31b990;try{_0x31b990=JSON[_0x5702f8(0x139)](_0x2b6e91);}catch(_0x59f945){throw new Error(_0x5702f8(0xe2)+_0x2b6e91);}console['log'](_0x5702f8(0xef),JSON['stringify'](_0x31b990,null,0x2));if(!_0x31b990[_0x5702f8(0x128)])throw new Error(_0x5702f8(0x165)+(_0x31b990['error_message']||_0x31b990[_0x5702f8(0xde)]||_0x5702f8(0x153)));const _0x3c50c5=_0x31b990[_0x5702f8(0x128)],_0x16d2a0=_0x31b990[_0x5702f8(0x15e)],_0x56f0d7=_0x31b990['tracker_id'];return console[_0x5702f8(0x108)](_0x5702f8(0x15b)),console['log'](_0x5702f8(0xe1),_0x3c50c5),console[_0x5702f8(0x108)]('System\x20ID:',_0x16d2a0),console['log'](_0x5702f8(0xe3),_0x56f0d7),console[_0x5702f8(0x108)](_0x5702f8(0x14e),_0x31b990[_0x5702f8(0x12a)]),console[_0x5702f8(0x108)](_0x5702f8(0x135)),{'gateway_payment_id':_0x16d2a0||_0x56f0d7||_0x55c776,'payment_url':_0x3c50c5||'','transaction_id':_0x16d2a0};}catch(_0x4295b2){console['error'](_0x5702f8(0x129),_0x4295b2),console[_0x5702f8(0x108)]('ðŸ“\x20Logging\x20AmPay\x20payment\x20creation\x20failure...');throw _0x4295b2;}}async[a52_0x434034(0xdc)](){const _0x18402b=a52_0x434034;try{const _0x1bfaf3=await fetch(this[_0x18402b(0x151)]+_0x18402b(0x11b),{'method':_0x18402b(0x11e),'headers':{'Content-Type':_0x18402b(0x112),'User-Agent':_0x18402b(0xdd)}});return _0x1bfaf3&&_0x1bfaf3[_0x18402b(0x12a)]===0xc8?!![]:![];}catch(_0xb95256){return console['error']('âŒ\x20AmPay\x20health\x20check\x20failed:',_0xb95256),![];}}async[a52_0x434034(0xf3)](_0x20f857){const _0x1c0d5f=a52_0x434034;console[_0x1c0d5f(0x108)](_0x1c0d5f(0x138)),console[_0x1c0d5f(0x108)](_0x1c0d5f(0xfc)),console[_0x1c0d5f(0x108)](_0x1c0d5f(0x10b),_0x20f857),console[_0x1c0d5f(0x108)]('Webhook\x20data\x20type:',typeof _0x20f857),console[_0x1c0d5f(0x108)](_0x1c0d5f(0x14a));_0x20f857&&typeof _0x20f857===_0x1c0d5f(0x16d)&&Object[_0x1c0d5f(0x15f)](_0x20f857)['forEach'](_0x4ef7d3=>{const _0x21881e=_0x1c0d5f;console[_0x21881e(0x108)]('\x20\x20'+_0x4ef7d3+':\x20'+_0x20f857[_0x4ef7d3]+'\x20('+typeof _0x20f857[_0x4ef7d3]+')');});let _0x1575a3=_0x1c0d5f(0x110);const _0xd509bc=_0x20f857[_0x1c0d5f(0xd4)]||_0x20f857[_0x1c0d5f(0x15e)]||_0x20f857[_0x1c0d5f(0xf0)]||'';return console[_0x1c0d5f(0x108)]('Extracted\x20payment\x20ID:\x20'+_0xd509bc),console['log'](_0x1c0d5f(0x155)+_0x1575a3),!_0xd509bc&&(console[_0x1c0d5f(0xcd)]('No\x20payment\x20ID\x20found\x20in\x20webhook\x20data'),console[_0x1c0d5f(0xcd)](_0x1c0d5f(0x11a))),{'paymentId':_0xd509bc,'status':_0x1575a3,'amount':_0x20f857[_0x1c0d5f(0x158)],'currency':_0x20f857['currency']};}}exports[a52_0x434034(0xf8)]=AmPayService,exports[a52_0x434034(0x103)]=new AmPayService();