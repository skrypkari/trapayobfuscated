'use strict';function a42_0x38b8(_0xca6cd7,_0x4a4ba1){const _0x5059e9=a42_0x5059();return a42_0x38b8=function(_0x38b883,_0x763f18){_0x38b883=_0x38b883-0x14e;let _0x3f9653=_0x5059e9[_0x38b883];return _0x3f9653;},a42_0x38b8(_0xca6cd7,_0x4a4ba1);}function a42_0x5059(){const _0x1fbdd1=['BGD','IRN','MUS','Customer\x20IP:','BTN','IDN','__esModule','COL','Status:','AmPay\x20API\x20error:\x20HTTP\x20','TZA','HUN','SMR','MNE','ARM','LVA','ECU','CHN','PENDING','application/json','NPL','GUY','defineProperty','19110789DOJdGQ','üìù\x20Logging\x20AmPay\x20payment\x20creation\x20event...','keys','DNK','CHE',',\x20using\x20RUS\x20as\x20fallback','API_PRIVATE_KEY','status','ISL','error_message','message','MWI','1953625TRHodu','PHL','PER','CZE','Order\x20ID:','XKX','tracker_id','HRV','IND','üá¶üá≤\x20AmPay\x20service\x20initialized\x20with\x20Open\x20Banking\x20AM\x20processing','7ojeFKD','No\x20payment\x20ID\x20found\x20in\x20webhook\x20data','‚úÖ\x20AmPay\x20payment\x20link\x20created\x20successfully','MLT','OMN','Unknown\x20error','23AqxNld','Invalid\x20JSON\x20response\x20from\x20AmPay:\x20','Amount:','PAK','LUX','Email:','58b59ccbc03dcdcfc20d830edfba765dbf9f3531c692533d84b17938e9c40bda','üì•\x20AmPay\x20raw\x20response:','‚ö†Ô∏è\x20WEBHOOKS\x20TEMPORARILY\x20DISABLED\x20-\x20Always\x20returning\x20PROCESSING\x20status','BEL','TUR','TJK','https://traffer.uk/gateway/ampay/','SVN','ALB','===\x20Processing\x20AmPay\x20webhook\x20===','processWebhook','redirect_url','FLK','ESP','SAU','GRC','ROU','NOR','BGR','VAT','‚ùå\x20AmPay\x20health\x20check\x20failed:','LIE','AFG','System\x20ID:','LKA','TrapayAPI/1.0','FIN','Available\x20fields:','a5a059aa63392e571341bddc5148a5db66643722e9a6bf16a9395fb690a80288931d5a1180a85a28eb9f6516cf61dfc1bf4e37898f3a35261cd2db88888d3815','https://api.trapay.uk/api/webhooks/gateway/ampay','createPaymentLink','POL','RUS','AZE','stringify','BOL','VNM','KGZ','Tracker\x20ID:','AmPayService','6284296iOeXgT','UGA','SYC','API_PUBLIC_KEY','MOZ','üì§\x20AmPay\x20request\x20body:','21614BuekfP','LTU','forEach','PRY','error','GAM','system_id','URY','apiUrl','VEN','NLD','MMR','CAN','BIH','LBN','UKR','CYP','MDV','KHM','ZMB','SRB','JOR','üá¶üá≤\x20Creating\x20AmPay\x20payment\x20link...','IRQ','1680900tTNzCr','ARE','USA','Webhook\x20data:','KOR','AND','GET','SUR','ampayService','Forced\x20status\x20(webhook\x20disabled):\x20','toUpperCase','KWT','log','warn','amount','ITA','UZB','ARG','SGP','MYS','text','IRL','1595775funYQI','3893124kRwuSV','\x20-\x20','Customer\x20Country\x20(2-letter):','NGA','convert2LetterTo3LetterCountryCode','Payment\x20URL:','MDG','SWE','Customer\x20Country\x20(3-letter):','MDA','BHR','FRA','üìù\x20Logging\x20AmPay\x20payment\x20creation\x20failure...','ZAF','CLIENT_MERCHANT_ID','health.php','TRAFFER','AUT'];a42_0x5059=function(){return _0x1fbdd1;};return a42_0x5059();}const a42_0x487555=a42_0x38b8;(function(_0x15e7bb,_0x11cb2f){const _0x41b72e=a42_0x38b8,_0x28cebf=_0x15e7bb();while(!![]){try{const _0x196f94=parseInt(_0x41b72e(0x1ac))/0x1*(-parseInt(_0x41b72e(0x1e0))/0x2)+parseInt(_0x41b72e(0x166))/0x3+parseInt(_0x41b72e(0x150))/0x4+parseInt(_0x41b72e(0x19c))/0x5+parseInt(_0x41b72e(0x167))/0x6+parseInt(_0x41b72e(0x1a6))/0x7*(parseInt(_0x41b72e(0x1da))/0x8)+-parseInt(_0x41b72e(0x190))/0x9;if(_0x196f94===_0x11cb2f)break;else _0x28cebf['push'](_0x28cebf['shift']());}catch(_0x42a3b2){_0x28cebf['push'](_0x28cebf['shift']());}}}(a42_0x5059,0x62f24));Object[a42_0x487555(0x18f)](exports,a42_0x487555(0x17f),{'value':!![]}),exports[a42_0x487555(0x158)]=exports[a42_0x487555(0x1d9)]=void 0x0;class AmPayService{constructor(){const _0x5157fd=a42_0x487555;this[_0x5157fd(0x175)]=_0x5157fd(0x177),this[_0x5157fd(0x1dd)]=_0x5157fd(0x1b2),this[_0x5157fd(0x196)]=_0x5157fd(0x1ce),this[_0x5157fd(0x1e8)]=_0x5157fd(0x1b8),console['log'](_0x5157fd(0x1a5));}[a42_0x487555(0x16b)](_0x397c62){const _0x47f7d1=a42_0x487555,_0x5da9a3={'AD':_0x47f7d1(0x155),'AL':_0x47f7d1(0x1ba),'AT':_0x47f7d1(0x178),'BA':_0x47f7d1(0x1ed),'BE':_0x47f7d1(0x1b5),'BG':_0x47f7d1(0x1c4),'BY':'BLR','CH':_0x47f7d1(0x194),'CY':_0x47f7d1(0x1f0),'CZ':_0x47f7d1(0x19f),'DE':'DEU','DK':_0x47f7d1(0x193),'EE':'EST','ES':_0x47f7d1(0x1bf),'FI':_0x47f7d1(0x1cc),'FR':_0x47f7d1(0x172),'GB':'GBR','GE':'GEO','GR':_0x47f7d1(0x1c1),'HR':_0x47f7d1(0x1a3),'HU':_0x47f7d1(0x184),'IE':_0x47f7d1(0x165),'IS':_0x47f7d1(0x198),'IT':_0x47f7d1(0x15f),'LI':_0x47f7d1(0x1c7),'LT':_0x47f7d1(0x1e1),'LU':_0x47f7d1(0x1b0),'LV':_0x47f7d1(0x188),'MC':'MCO','MD':_0x47f7d1(0x170),'ME':_0x47f7d1(0x186),'MK':'MKD','MT':_0x47f7d1(0x1a9),'NL':_0x47f7d1(0x1ea),'NO':_0x47f7d1(0x1c3),'PL':_0x47f7d1(0x1d1),'PT':'PRT','RO':_0x47f7d1(0x1c2),'RS':_0x47f7d1(0x1f4),'RU':_0x47f7d1(0x1d2),'SE':_0x47f7d1(0x16e),'SI':_0x47f7d1(0x1b9),'SK':'SVK','SM':_0x47f7d1(0x185),'UA':_0x47f7d1(0x1ef),'VA':_0x47f7d1(0x1c5),'XK':_0x47f7d1(0x1a1),'AM':_0x47f7d1(0x187),'AZ':_0x47f7d1(0x1d3),'KZ':'KAZ','KG':_0x47f7d1(0x1d7),'TJ':_0x47f7d1(0x1b7),'TM':'TKM','UZ':_0x47f7d1(0x160),'US':_0x47f7d1(0x152),'CA':_0x47f7d1(0x1ec),'AU':'AUS','JP':'JPN','CN':_0x47f7d1(0x18a),'IN':_0x47f7d1(0x1a4),'BR':'BRA','MX':'MEX','AR':_0x47f7d1(0x161),'CL':'CHL','PE':_0x47f7d1(0x19e),'CO':_0x47f7d1(0x180),'VE':_0x47f7d1(0x1e9),'EC':_0x47f7d1(0x189),'BO':_0x47f7d1(0x1d5),'PY':_0x47f7d1(0x1e3),'UY':_0x47f7d1(0x1e7),'SR':_0x47f7d1(0x157),'GY':_0x47f7d1(0x18e),'FK':_0x47f7d1(0x1be),'ZA':_0x47f7d1(0x174),'EG':'EGY','NG':_0x47f7d1(0x16a),'KE':'KEN','GH':'GHA','TZ':_0x47f7d1(0x183),'UG':_0x47f7d1(0x1db),'ZW':'ZWE','ZM':_0x47f7d1(0x1f3),'MW':_0x47f7d1(0x19b),'MZ':_0x47f7d1(0x1de),'MG':_0x47f7d1(0x16d),'MU':_0x47f7d1(0x17b),'SC':_0x47f7d1(0x1dc),'RE':'REU','TR':_0x47f7d1(0x1b6),'IR':_0x47f7d1(0x17a),'IQ':_0x47f7d1(0x14f),'SA':_0x47f7d1(0x1c0),'AE':_0x47f7d1(0x151),'KW':_0x47f7d1(0x15b),'QA':'QAT','BH':_0x47f7d1(0x171),'OM':_0x47f7d1(0x1aa),'YE':'YEM','JO':_0x47f7d1(0x1f5),'LB':_0x47f7d1(0x1ee),'SY':'SYR','IL':'ISR','PS':'PSE','KR':_0x47f7d1(0x154),'KP':'PRK','TH':'THA','VN':_0x47f7d1(0x1d6),'MY':_0x47f7d1(0x163),'SG':_0x47f7d1(0x162),'ID':_0x47f7d1(0x17e),'PH':_0x47f7d1(0x19d),'LA':'LAO','KH':_0x47f7d1(0x1f2),'MM':_0x47f7d1(0x1eb),'BD':_0x47f7d1(0x179),'LK':_0x47f7d1(0x1ca),'NP':_0x47f7d1(0x18d),'BT':_0x47f7d1(0x17d),'MV':_0x47f7d1(0x1f1),'AF':_0x47f7d1(0x1c8),'PK':_0x47f7d1(0x1af),'MN':'MNG'},_0x309545=_0x5da9a3[_0x397c62['toUpperCase']()];if(!_0x309545)return console[_0x47f7d1(0x15d)]('‚ö†Ô∏è\x20Unknown\x20country\x20code:\x20'+_0x397c62+_0x47f7d1(0x195)),'RUS';return _0x309545;}async[a42_0x487555(0x1d0)](_0x168649){const _0x28bb2d=a42_0x487555;try{const {orderId:_0x1f23b7,amount:_0x3c0c39,currency:_0x290726,firstName:_0x3f798f,lastName:_0x34e33e,email:_0x2cf65f,customerIp:_0x44cd15,customerCountry:_0x277c8b,successUrl:_0x222de2,failureUrl:_0x4cd920}=_0x168649;console['log'](_0x28bb2d(0x14e)),console['log'](_0x28bb2d(0x1a0),_0x1f23b7),console[_0x28bb2d(0x15c)](_0x28bb2d(0x1ae),_0x3c0c39,_0x290726),console[_0x28bb2d(0x15c)]('Customer:',_0x3f798f+'\x20'+_0x34e33e),console[_0x28bb2d(0x15c)](_0x28bb2d(0x1b1),_0x2cf65f),console[_0x28bb2d(0x15c)](_0x28bb2d(0x17c),_0x44cd15),console[_0x28bb2d(0x15c)](_0x28bb2d(0x169),_0x277c8b);const _0x5df26c=this['convert2LetterTo3LetterCountryCode'](_0x277c8b);console[_0x28bb2d(0x15c)](_0x28bb2d(0x16f),_0x5df26c);const _0x3e04d6={'sub_method':_0x28bb2d(0x1e5),'currency':_0x290726[_0x28bb2d(0x15a)](),'amount':_0x3c0c39,'callback_url':_0x28bb2d(0x1cf),'client_merchant_id':this[_0x28bb2d(0x175)],'client_transaction_id':_0x1f23b7,'transaction_description':_0x1f23b7,'customer':{'ip':_0x44cd15,'email':_0x2cf65f,'full_name':_0x3f798f+'\x20'+_0x34e33e,'country':_0x5df26c},'success_redirect_url':_0x222de2,'error_redirect_url':_0x4cd920};console[_0x28bb2d(0x15c)](_0x28bb2d(0x1df),JSON[_0x28bb2d(0x1d4)](_0x3e04d6,null,0x2));const _0x8f6c16=await fetch(this[_0x28bb2d(0x1e8)]+'ampay.php',{'method':'POST','headers':{'Content-Type':_0x28bb2d(0x18c),'User-Agent':_0x28bb2d(0x1cb)},'body':JSON[_0x28bb2d(0x1d4)](_0x3e04d6)}),_0x441d23=await _0x8f6c16[_0x28bb2d(0x164)]();console['log'](_0x28bb2d(0x1b3),_0x441d23);if(!_0x8f6c16['ok'])throw new Error(_0x28bb2d(0x182)+_0x8f6c16[_0x28bb2d(0x197)]+_0x28bb2d(0x168)+_0x441d23);let _0x3de8ad;try{_0x3de8ad=JSON['parse'](_0x441d23);}catch(_0x2285f9){throw new Error(_0x28bb2d(0x1ad)+_0x441d23);}console[_0x28bb2d(0x15c)]('üìä\x20AmPay\x20response\x20data:',JSON[_0x28bb2d(0x1d4)](_0x3de8ad,null,0x2));if(!_0x3de8ad[_0x28bb2d(0x1bd)])throw new Error('AmPay\x20payment\x20creation\x20failed:\x20'+(_0x3de8ad[_0x28bb2d(0x199)]||_0x3de8ad[_0x28bb2d(0x19a)]||_0x28bb2d(0x1ab)));const _0x554f8c=_0x3de8ad[_0x28bb2d(0x1bd)],_0x5bb990=_0x3de8ad[_0x28bb2d(0x1e6)],_0x17fa78=_0x3de8ad[_0x28bb2d(0x1a2)];return console[_0x28bb2d(0x15c)](_0x28bb2d(0x1a8)),console[_0x28bb2d(0x15c)](_0x28bb2d(0x16c),_0x554f8c),console[_0x28bb2d(0x15c)](_0x28bb2d(0x1c9),_0x5bb990),console[_0x28bb2d(0x15c)](_0x28bb2d(0x1d8),_0x17fa78),console[_0x28bb2d(0x15c)](_0x28bb2d(0x181),_0x3de8ad[_0x28bb2d(0x197)]),console['log'](_0x28bb2d(0x191)),{'gateway_payment_id':_0x5bb990||_0x17fa78||_0x1f23b7,'payment_url':_0x554f8c||'','transaction_id':_0x5bb990};}catch(_0x569cea){console[_0x28bb2d(0x1e4)]('‚ùå\x20AmPay\x20payment\x20creation\x20failed:',_0x569cea),console[_0x28bb2d(0x15c)](_0x28bb2d(0x173));throw _0x569cea;}}async['healthCheck'](){const _0xf5852=a42_0x487555;try{const _0x2bd639=await fetch(this[_0xf5852(0x1e8)]+_0xf5852(0x176),{'method':_0xf5852(0x156),'headers':{'Content-Type':_0xf5852(0x18c),'User-Agent':_0xf5852(0x1cb)}});return _0x2bd639&&_0x2bd639['status']===0xc8?!![]:![];}catch(_0xfbe5d7){return console[_0xf5852(0x1e4)](_0xf5852(0x1c6),_0xfbe5d7),![];}}async[a42_0x487555(0x1bc)](_0x3e86b3){const _0x49a7e8=a42_0x487555;console[_0x49a7e8(0x15c)](_0x49a7e8(0x1bb)),console['log'](_0x49a7e8(0x1b4)),console['log'](_0x49a7e8(0x153),_0x3e86b3),console[_0x49a7e8(0x15c)]('Webhook\x20data\x20type:',typeof _0x3e86b3),console[_0x49a7e8(0x15c)](_0x49a7e8(0x1cd));_0x3e86b3&&typeof _0x3e86b3==='object'&&Object[_0x49a7e8(0x192)](_0x3e86b3)[_0x49a7e8(0x1e2)](_0x57b496=>{console['log']('\x20\x20'+_0x57b496+':\x20'+_0x3e86b3[_0x57b496]+'\x20('+typeof _0x3e86b3[_0x57b496]+')');});let _0x3bf08d=_0x49a7e8(0x18b);const _0x46fb0d=_0x3e86b3['client_transaction_id']||_0x3e86b3['system_id']||_0x3e86b3[_0x49a7e8(0x1a2)]||'';return console[_0x49a7e8(0x15c)]('Extracted\x20payment\x20ID:\x20'+_0x46fb0d),console[_0x49a7e8(0x15c)](_0x49a7e8(0x159)+_0x3bf08d),!_0x46fb0d&&(console[_0x49a7e8(0x1e4)](_0x49a7e8(0x1a7)),console['error']('Checked\x20fields:\x20client_transaction_id,\x20system_id,\x20tracker_id')),{'paymentId':_0x46fb0d,'status':_0x3bf08d,'amount':_0x3e86b3[_0x49a7e8(0x15e)],'currency':_0x3e86b3['currency']};}}exports[a42_0x487555(0x1d9)]=AmPayService,exports[a42_0x487555(0x158)]=new AmPayService();