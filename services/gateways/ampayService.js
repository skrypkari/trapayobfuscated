'use strict';const a42_0xec5b4a=a42_0x382d;(function(_0x2d5808,_0x4397e5){const _0x5d82c2=a42_0x382d,_0x470046=_0x2d5808();while(!![]){try{const _0x27dc81=parseInt(_0x5d82c2(0x134))/0x1*(-parseInt(_0x5d82c2(0x164))/0x2)+-parseInt(_0x5d82c2(0xf8))/0x3+parseInt(_0x5d82c2(0x13a))/0x4+parseInt(_0x5d82c2(0x11d))/0x5+parseInt(_0x5d82c2(0x101))/0x6+-parseInt(_0x5d82c2(0x105))/0x7+parseInt(_0x5d82c2(0x168))/0x8*(parseInt(_0x5d82c2(0x16e))/0x9);if(_0x27dc81===_0x4397e5)break;else _0x470046['push'](_0x470046['shift']());}catch(_0x3202c3){_0x470046['push'](_0x470046['shift']());}}}(a42_0x2fd3,0x75b44));function a42_0x2fd3(){const _0x47a128=['DEU','Status:','EGY','TUR','ROU','keys','RUS','createPaymentLink','KAZ','IRQ','ESP','MNG','Customer\x20Country\x20(2-letter):','ARM','MWI','NGA','USA','📤\x20AmPay\x20request\x20body:','LBN','URY','REU','PENDING','text','status','GRC','AmPay\x20payment\x20creation\x20failed:\x20','QAT','MMR','2679447UrOsbU','FLK','API_PRIVATE_KEY','LTU','PRK','PAK','BGD','JPN','SUR','2342448kzKdWd','tracker_id','message','LKA','3874465pXXamj','SVK','Checked\x20fields:\x20client_transaction_id,\x20system_id,\x20tracker_id','❌\x20AmPay\x20health\x20check\x20failed:','ITA','CAN','MEX','convert2LetterTo3LetterCountryCode','application/json','Customer\x20IP:','YEM','processWebhook','amount','CYP','TRAFFER','AZE','ZAF','📥\x20AmPay\x20raw\x20response:','📝\x20Logging\x20AmPay\x20payment\x20creation\x20event...','ZMB','58b59ccbc03dcdcfc20d830edfba765dbf9f3531c692533d84b17938e9c40bda','MLT','Tracker\x20ID:','redirect_url','2596915uXWXnX','ISL','COL','system_id','JOR','AFG','⚠️\x20Unknown\x20country\x20code:\x20','Webhook\x20data\x20type:','Customer\x20Country\x20(3-letter):','SAU','SWE','NOR','THA','healthCheck','error_message','\x20-\x20','PSE','POST','MDV','===\x20Processing\x20AmPay\x20webhook\x20===','AND','ampay.php','IND','4mnFxrJ','object','Webhook\x20data:','ampayService','DNK','🇦🇲\x20AmPay\x20service\x20initialized\x20with\x20Open\x20Banking\x20AM\x20processing','2319512gELPos','IRN','IRL','📝\x20Logging\x20AmPay\x20payment\x20creation\x20failure...','BEL','error','⚠️\x20WEBHOOKS\x20TEMPORARILY\x20DISABLED\x20-\x20Always\x20returning\x20PROCESSING\x20status','currency','GBR','SRB','PRT','NPL','GEO','NLD','Forced\x20status\x20(webhook\x20disabled):\x20','MOZ','POL','FIN','GUY','BIH','CHE','Available\x20fields:','IDN','TZA','GET','No\x20payment\x20ID\x20found\x20in\x20webhook\x20data','OMN','FRA','ECU','__esModule','ZWE','EST','MUS','CLIENT_MERCHANT_ID','KWT','VAT','Email:','BLR','TrapayAPI/1.0','forEach','BOL',',\x20using\x20RUS\x20as\x20fallback','350172VIvJic','Customer:','📊\x20AmPay\x20response\x20data:','Payment\x20URL:','828680DswpyD','VNM','PER','SYC','AUT','SVN','99GhtpTF','TJK','PHL','KHM','stringify','MKD','AmPayService','apiUrl','Invalid\x20JSON\x20response\x20from\x20AmPay:\x20','HRV','LIE','CHN','UKR','log','MCO'];a42_0x2fd3=function(){return _0x47a128;};return a42_0x2fd3();}Object['defineProperty'](exports,a42_0xec5b4a(0x157),{'value':!![]}),exports[a42_0xec5b4a(0x137)]=exports[a42_0xec5b4a(0xd3)]=void 0x0;function a42_0x382d(_0x50ab7a,_0x56430e){const _0x2fd340=a42_0x2fd3();return a42_0x382d=function(_0x382d28,_0x103e53){_0x382d28=_0x382d28-0xd2;let _0x4b11c9=_0x2fd340[_0x382d28];return _0x4b11c9;},a42_0x382d(_0x50ab7a,_0x56430e);}class AmPayService{constructor(){const _0x1ac67b=a42_0xec5b4a;this[_0x1ac67b(0x15b)]=_0x1ac67b(0x113),this['API_PUBLIC_KEY']=_0x1ac67b(0x119),this[_0x1ac67b(0xfa)]='a5a059aa63392e571341bddc5148a5db66643722e9a6bf16a9395fb690a80288931d5a1180a85a28eb9f6516cf61dfc1bf4e37898f3a35261cd2db88888d3815',this[_0x1ac67b(0xd4)]='https://traffer.uk/gateway/ampay/',console[_0x1ac67b(0xda)](_0x1ac67b(0x139));}['convert2LetterTo3LetterCountryCode'](_0x509eb7){const _0x41efcf=a42_0xec5b4a,_0x5cdaf4={'AD':_0x41efcf(0x131),'AL':'ALB','AT':_0x41efcf(0x16c),'BA':_0x41efcf(0x14d),'BE':_0x41efcf(0x13e),'BG':'BGR','BY':_0x41efcf(0x15f),'CH':_0x41efcf(0x14e),'CY':_0x41efcf(0x112),'CZ':'CZE','DE':_0x41efcf(0xdc),'DK':_0x41efcf(0x138),'EE':_0x41efcf(0x159),'ES':_0x41efcf(0xe6),'FI':_0x41efcf(0x14b),'FR':_0x41efcf(0x155),'GB':_0x41efcf(0x142),'GE':_0x41efcf(0x146),'GR':_0x41efcf(0xf4),'HR':_0x41efcf(0xd6),'HU':'HUN','IE':_0x41efcf(0x13c),'IS':_0x41efcf(0x11e),'IT':_0x41efcf(0x109),'LI':_0x41efcf(0xd7),'LT':_0x41efcf(0xfb),'LU':'LUX','LV':'LVA','MC':_0x41efcf(0xdb),'MD':'MDA','ME':'MNE','MK':_0x41efcf(0xd2),'MT':_0x41efcf(0x11a),'NL':_0x41efcf(0x147),'NO':_0x41efcf(0x128),'PL':_0x41efcf(0x14a),'PT':_0x41efcf(0x144),'RO':_0x41efcf(0xe0),'RS':_0x41efcf(0x143),'RU':_0x41efcf(0xe2),'SE':_0x41efcf(0x127),'SI':_0x41efcf(0x16d),'SK':_0x41efcf(0x106),'SM':'SMR','UA':_0x41efcf(0xd9),'VA':_0x41efcf(0x15d),'XK':'XKX','AM':_0x41efcf(0xe9),'AZ':_0x41efcf(0x114),'KZ':_0x41efcf(0xe4),'KG':'KGZ','TJ':_0x41efcf(0x16f),'TM':'TKM','UZ':'UZB','US':_0x41efcf(0xec),'CA':_0x41efcf(0x10a),'AU':'AUS','JP':_0x41efcf(0xff),'CN':_0x41efcf(0xd8),'IN':_0x41efcf(0x133),'BR':'BRA','MX':_0x41efcf(0x10b),'AR':'ARG','CL':'CHL','PE':_0x41efcf(0x16a),'CO':_0x41efcf(0x11f),'VE':'VEN','EC':_0x41efcf(0x156),'BO':_0x41efcf(0x162),'PY':'PRY','UY':_0x41efcf(0xef),'SR':_0x41efcf(0x100),'GY':_0x41efcf(0x14c),'FK':_0x41efcf(0xf9),'ZA':_0x41efcf(0x115),'EG':_0x41efcf(0xde),'NG':_0x41efcf(0xeb),'KE':'KEN','GH':'GHA','TZ':_0x41efcf(0x151),'UG':'UGA','ZW':_0x41efcf(0x158),'ZM':_0x41efcf(0x118),'MW':_0x41efcf(0xea),'MZ':_0x41efcf(0x149),'MG':'MDG','MU':_0x41efcf(0x15a),'SC':_0x41efcf(0x16b),'RE':_0x41efcf(0xf0),'TR':_0x41efcf(0xdf),'IR':_0x41efcf(0x13b),'IQ':_0x41efcf(0xe5),'SA':_0x41efcf(0x126),'AE':'ARE','KW':_0x41efcf(0x15c),'QA':_0x41efcf(0xf6),'BH':'BHR','OM':_0x41efcf(0x154),'YE':_0x41efcf(0x10f),'JO':_0x41efcf(0x121),'LB':_0x41efcf(0xee),'SY':'SYR','IL':'ISR','PS':_0x41efcf(0x12d),'KR':'KOR','KP':_0x41efcf(0xfc),'TH':_0x41efcf(0x129),'VN':_0x41efcf(0x169),'MY':'MYS','SG':'SGP','ID':_0x41efcf(0x150),'PH':_0x41efcf(0x170),'LA':'LAO','KH':_0x41efcf(0x171),'MM':_0x41efcf(0xf7),'BD':_0x41efcf(0xfe),'LK':_0x41efcf(0x104),'NP':_0x41efcf(0x145),'BT':'BTN','MV':_0x41efcf(0x12f),'AF':_0x41efcf(0x122),'PK':_0x41efcf(0xfd),'MN':_0x41efcf(0xe7)},_0x26b857=_0x5cdaf4[_0x509eb7['toUpperCase']()];if(!_0x26b857)return console['warn'](_0x41efcf(0x123)+_0x509eb7+_0x41efcf(0x163)),_0x41efcf(0xe2);return _0x26b857;}async[a42_0xec5b4a(0xe3)](_0x3c3a7b){const _0x502032=a42_0xec5b4a;try{const {orderId:_0x3d6cc4,amount:_0x42c518,currency:_0x46619c,firstName:_0x1f568f,lastName:_0x37815d,email:_0x3b48b0,customerIp:_0x73dfce,customerCountry:_0x4d2a77,successUrl:_0x4c2da0,failureUrl:_0x4bc6cd}=_0x3c3a7b;console[_0x502032(0xda)]('🇦🇲\x20Creating\x20AmPay\x20payment\x20link...'),console[_0x502032(0xda)]('Order\x20ID:',_0x3d6cc4),console['log']('Amount:',_0x42c518,_0x46619c),console[_0x502032(0xda)](_0x502032(0x165),_0x1f568f+'\x20'+_0x37815d),console[_0x502032(0xda)](_0x502032(0x15e),_0x3b48b0),console[_0x502032(0xda)](_0x502032(0x10e),_0x73dfce),console['log'](_0x502032(0xe8),_0x4d2a77);const _0x1ba0fe=this[_0x502032(0x10c)](_0x4d2a77);console['log'](_0x502032(0x125),_0x1ba0fe);const _0x5ac241={'sub_method':'GAM','currency':_0x46619c['toUpperCase'](),'amount':_0x42c518,'callback_url':'https://api.trapay.uk/api/webhooks/gateway/ampay','client_merchant_id':this[_0x502032(0x15b)],'client_transaction_id':_0x3d6cc4,'transaction_description':_0x3d6cc4,'customer':{'ip':_0x73dfce,'email':_0x3b48b0,'full_name':_0x1f568f+'\x20'+_0x37815d,'country':_0x1ba0fe},'success_redirect_url':_0x4c2da0,'error_redirect_url':_0x4bc6cd};console[_0x502032(0xda)](_0x502032(0xed),JSON[_0x502032(0x172)](_0x5ac241,null,0x2));const _0x21b47d=await fetch(this[_0x502032(0xd4)]+_0x502032(0x132),{'method':_0x502032(0x12e),'headers':{'Content-Type':_0x502032(0x10d),'User-Agent':_0x502032(0x160)},'body':JSON[_0x502032(0x172)](_0x5ac241)}),_0x1c24dd=await _0x21b47d[_0x502032(0xf2)]();console[_0x502032(0xda)](_0x502032(0x116),_0x1c24dd);if(!_0x21b47d['ok'])throw new Error('AmPay\x20API\x20error:\x20HTTP\x20'+_0x21b47d[_0x502032(0xf3)]+_0x502032(0x12c)+_0x1c24dd);let _0x4edeaf;try{_0x4edeaf=JSON['parse'](_0x1c24dd);}catch(_0x319fd6){throw new Error(_0x502032(0xd5)+_0x1c24dd);}console[_0x502032(0xda)](_0x502032(0x166),JSON[_0x502032(0x172)](_0x4edeaf,null,0x2));if(!_0x4edeaf[_0x502032(0x11c)])throw new Error(_0x502032(0xf5)+(_0x4edeaf[_0x502032(0x12b)]||_0x4edeaf[_0x502032(0x103)]||'Unknown\x20error'));const _0x7a468c=_0x4edeaf[_0x502032(0x11c)],_0x36c6d6=_0x4edeaf[_0x502032(0x120)],_0x15e7fc=_0x4edeaf[_0x502032(0x102)];return console[_0x502032(0xda)]('✅\x20AmPay\x20payment\x20link\x20created\x20successfully'),console[_0x502032(0xda)](_0x502032(0x167),_0x7a468c),console[_0x502032(0xda)]('System\x20ID:',_0x36c6d6),console['log'](_0x502032(0x11b),_0x15e7fc),console[_0x502032(0xda)](_0x502032(0xdd),_0x4edeaf['status']),console[_0x502032(0xda)](_0x502032(0x117)),{'gateway_payment_id':_0x36c6d6||_0x15e7fc||_0x3d6cc4,'payment_url':_0x7a468c||'','transaction_id':_0x36c6d6};}catch(_0x273d1d){console['error']('❌\x20AmPay\x20payment\x20creation\x20failed:',_0x273d1d),console[_0x502032(0xda)](_0x502032(0x13d));throw _0x273d1d;}}async[a42_0xec5b4a(0x12a)](){const _0x2816aa=a42_0xec5b4a;try{const _0x3c02eb=await fetch(this[_0x2816aa(0xd4)]+'health.php',{'method':_0x2816aa(0x152),'headers':{'Content-Type':_0x2816aa(0x10d),'User-Agent':'TrapayAPI/1.0'}});return _0x3c02eb&&_0x3c02eb[_0x2816aa(0xf3)]===0xc8?!![]:![];}catch(_0x5d2435){return console[_0x2816aa(0x13f)](_0x2816aa(0x108),_0x5d2435),![];}}async[a42_0xec5b4a(0x110)](_0x1cbb74){const _0x394245=a42_0xec5b4a;console['log'](_0x394245(0x130)),console[_0x394245(0xda)](_0x394245(0x140)),console[_0x394245(0xda)](_0x394245(0x136),_0x1cbb74),console['log'](_0x394245(0x124),typeof _0x1cbb74),console[_0x394245(0xda)](_0x394245(0x14f));_0x1cbb74&&typeof _0x1cbb74===_0x394245(0x135)&&Object[_0x394245(0xe1)](_0x1cbb74)[_0x394245(0x161)](_0x462da8=>{console['log']('\x20\x20'+_0x462da8+':\x20'+_0x1cbb74[_0x462da8]+'\x20('+typeof _0x1cbb74[_0x462da8]+')');});let _0xf1d2f5=_0x394245(0xf1);const _0x130ccc=_0x1cbb74['client_transaction_id']||_0x1cbb74[_0x394245(0x120)]||_0x1cbb74[_0x394245(0x102)]||'';return console[_0x394245(0xda)]('Extracted\x20payment\x20ID:\x20'+_0x130ccc),console[_0x394245(0xda)](_0x394245(0x148)+_0xf1d2f5),!_0x130ccc&&(console[_0x394245(0x13f)](_0x394245(0x153)),console['error'](_0x394245(0x107))),{'paymentId':_0x130ccc,'status':_0xf1d2f5,'amount':_0x1cbb74[_0x394245(0x111)],'currency':_0x1cbb74[_0x394245(0x141)]};}}exports[a42_0xec5b4a(0xd3)]=AmPayService,exports[a42_0xec5b4a(0x137)]=new AmPayService();