'use strict';const a46_0x55865d=a46_0x3ced;function a46_0x3ced(_0x3b7d3a,_0x4485e6){const _0x37f716=a46_0x37f7();return a46_0x3ced=function(_0x3cedbf,_0x24eb53){_0x3cedbf=_0x3cedbf-0xfb;let _0x668d1a=_0x37f716[_0x3cedbf];return _0x668d1a;},a46_0x3ced(_0x3b7d3a,_0x4485e6);}(function(_0x34dc10,_0x730d59){const _0x5de172=a46_0x3ced,_0x2b13e9=_0x34dc10();while(!![]){try{const _0x585f82=-parseInt(_0x5de172(0x118))/0x1*(-parseInt(_0x5de172(0x184))/0x2)+-parseInt(_0x5de172(0x172))/0x3*(-parseInt(_0x5de172(0x195))/0x4)+-parseInt(_0x5de172(0x135))/0x5+-parseInt(_0x5de172(0x120))/0x6+-parseInt(_0x5de172(0x171))/0x7*(parseInt(_0x5de172(0x17c))/0x8)+-parseInt(_0x5de172(0x16b))/0x9*(-parseInt(_0x5de172(0x189))/0xa)+-parseInt(_0x5de172(0x110))/0xb*(-parseInt(_0x5de172(0x112))/0xc);if(_0x585f82===_0x730d59)break;else _0x2b13e9['push'](_0x2b13e9['shift']());}catch(_0x2100cd){_0x2b13e9['push'](_0x2b13e9['shift']());}}}(a46_0x37f7,0xf38ac));function a46_0x37f7(){const _0x2891fd=['KWT','system_id','CHL','LIE','VAT','health.php','3760551qSYnUv','EST','FIN','MMR','BGD','CHE','933639zMMwcR','3yrjisD','MNE','Email:','MNG','LAO','AmPay\x20API\x20error:\x20HTTP\x20','stringify','https://traffer.uk/gateway/ampay/webhook.php','Available\x20fields:','convert2LetterTo3LetterCountryCode','112NwriOo','CAN','MKD','PENDING','JPN','ampayService','HRV','===\x20Processing\x20AmPay\x20webhook\x20===','1234qbLiog','PRY','BGR','MWI','MOZ','40YawaiV','GHA','MEX','‚úÖ\x20AmPay\x20payment\x20link\x20created\x20successfully','TZA','GUY','EGY','IRQ','warn','Forced\x20status\x20(webhook\x20disabled):\x20','AUT','error','1589596nzBMIZ','client_transaction_id','LTU','FRA','ALB','XKX','LKA','apiUrl','healthCheck','üì•\x20AmPay\x20raw\x20response:','POL','QAT','AFG','ZAF','object','üá¶üá≤\x20Creating\x20AmPay\x20payment\x20link...','THA','CZE','Status:','PSE','MLT','SUR','PHL','LVA','VNM','TJK','ECU','ZWE','‚ö†Ô∏è\x20Unknown\x20country\x20code:\x20','Extracted\x20payment\x20ID:\x20','POST','KEN','Webhook\x20data\x20type:','https://traffer.uk/gateway/ampay/','Customer\x20IP:','log','üì§\x20AmPay\x20request\x20body:','tracker_id','JOR','DEU','BHR','YEM','GRC','IRN','CLIENT_MERCHANT_ID','58b59ccbc03dcdcfc20d830edfba765dbf9f3531c692533d84b17938e9c40bda','ISL','UGA','status','CHN','33559361OkRYgF','Order\x20ID:','12ptrGxE','ROU','PER','‚ö†Ô∏è\x20WEBHOOKS\x20TEMPORARILY\x20DISABLED\x20-\x20Always\x20returning\x20PROCESSING\x20status','MDA','UZB','1578qIoOPd','ZMB','forEach','IRL','AND','BRA','AmPayService','SYC','9194766pJJkiR','SVN','API_PUBLIC_KEY','CYP','KGZ','createPaymentLink','üìù\x20Logging\x20AmPay\x20payment\x20creation\x20event...','KOR','COL','SMR','GAM','PRT','VEN','KHM','Amount:','IND','BEL','ampay.php','ITA','ESP','NPL','8479725snrfDX','GBR','TRAFFER','TUR','Tracker\x20ID:','üìä\x20AmPay\x20response\x20data:','RUS','TrapayAPI/1.0','ARG','GET','keys','Payment\x20URL:','MDV','KAZ','NLD','__esModule','MDG',',\x20using\x20RUS\x20as\x20fallback','Customer\x20Country\x20(3-letter):','‚ùå\x20AmPay\x20health\x20check\x20failed:','IDN','SGP','REU','processWebhook','UKR','Invalid\x20JSON\x20response\x20from\x20AmPay:\x20','application/json','ISR','BLR','USA','LUX','Unknown\x20error','PRK','redirect_url','MCO','text','toUpperCase','SVK','API_PRIVATE_KEY','AUS','OMN','currency','BOL','MYS','AmPay\x20payment\x20creation\x20failed:\x20','NOR','SWE','error_message'];a46_0x37f7=function(){return _0x2891fd;};return a46_0x37f7();}Object['defineProperty'](exports,a46_0x55865d(0x144),{'value':!![]}),exports[a46_0x55865d(0x181)]=exports[a46_0x55865d(0x11e)]=void 0x0;class AmPayService{constructor(){const _0x29fd36=a46_0x55865d;this[_0x29fd36(0x10a)]=_0x29fd36(0x137),this[_0x29fd36(0x122)]=_0x29fd36(0x10b),this[_0x29fd36(0x15b)]='a5a059aa63392e571341bddc5148a5db66643722e9a6bf16a9395fb690a80288931d5a1180a85a28eb9f6516cf61dfc1bf4e37898f3a35261cd2db88888d3815',this[_0x29fd36(0x19c)]=_0x29fd36(0xff),console[_0x29fd36(0x101)]('üá¶üá≤\x20AmPay\x20service\x20initialized\x20with\x20Open\x20Banking\x20AM\x20processing');}['convert2LetterTo3LetterCountryCode'](_0x43b63f){const _0x475f34=a46_0x55865d,_0x124db5={'AD':_0x475f34(0x11c),'AL':_0x475f34(0x199),'AT':_0x475f34(0x193),'BA':'BIH','BE':_0x475f34(0x130),'BG':_0x475f34(0x186),'BY':_0x475f34(0x151),'CH':_0x475f34(0x170),'CY':_0x475f34(0x123),'CZ':_0x475f34(0x1a6),'DE':_0x475f34(0x105),'DK':'DNK','EE':_0x475f34(0x16c),'ES':_0x475f34(0x133),'FI':_0x475f34(0x16d),'FR':_0x475f34(0x198),'GB':_0x475f34(0x136),'GE':'GEO','GR':_0x475f34(0x108),'HR':_0x475f34(0x182),'HU':'HUN','IE':_0x475f34(0x11b),'IS':_0x475f34(0x10c),'IT':_0x475f34(0x132),'LI':_0x475f34(0x168),'LT':_0x475f34(0x197),'LU':_0x475f34(0x153),'LV':_0x475f34(0x1ac),'MC':_0x475f34(0x157),'MD':_0x475f34(0x116),'ME':_0x475f34(0x173),'MK':_0x475f34(0x17e),'MT':_0x475f34(0x1a9),'NL':_0x475f34(0x143),'NO':_0x475f34(0x162),'PL':_0x475f34(0x19f),'PT':_0x475f34(0x12b),'RO':_0x475f34(0x113),'RS':'SRB','RU':_0x475f34(0x13b),'SE':_0x475f34(0x163),'SI':_0x475f34(0x121),'SK':_0x475f34(0x15a),'SM':_0x475f34(0x129),'UA':_0x475f34(0x14d),'VA':_0x475f34(0x169),'XK':_0x475f34(0x19a),'AM':'ARM','AZ':'AZE','KZ':_0x475f34(0x142),'KG':_0x475f34(0x124),'TJ':_0x475f34(0x1ae),'TM':'TKM','UZ':_0x475f34(0x117),'US':_0x475f34(0x152),'CA':_0x475f34(0x17d),'AU':_0x475f34(0x15c),'JP':_0x475f34(0x180),'CN':_0x475f34(0x10f),'IN':_0x475f34(0x12f),'BR':_0x475f34(0x11d),'MX':_0x475f34(0x18b),'AR':_0x475f34(0x13d),'CL':_0x475f34(0x167),'PE':_0x475f34(0x114),'CO':_0x475f34(0x128),'VE':_0x475f34(0x12c),'EC':_0x475f34(0x1af),'BO':_0x475f34(0x15f),'PY':_0x475f34(0x185),'UY':'URY','SR':_0x475f34(0x1aa),'GY':_0x475f34(0x18e),'FK':'FLK','ZA':_0x475f34(0x1a2),'EG':_0x475f34(0x18f),'NG':'NGA','KE':_0x475f34(0xfd),'GH':_0x475f34(0x18a),'TZ':_0x475f34(0x18d),'UG':_0x475f34(0x10d),'ZW':_0x475f34(0x1b0),'ZM':_0x475f34(0x119),'MW':_0x475f34(0x187),'MZ':_0x475f34(0x188),'MG':_0x475f34(0x145),'MU':'MUS','SC':_0x475f34(0x11f),'RE':_0x475f34(0x14b),'TR':_0x475f34(0x138),'IR':_0x475f34(0x109),'IQ':_0x475f34(0x190),'SA':'SAU','AE':'ARE','KW':_0x475f34(0x165),'QA':_0x475f34(0x1a0),'BH':_0x475f34(0x106),'OM':_0x475f34(0x15d),'YE':_0x475f34(0x107),'JO':_0x475f34(0x104),'LB':'LBN','SY':'SYR','IL':_0x475f34(0x150),'PS':_0x475f34(0x1a8),'KR':_0x475f34(0x127),'KP':_0x475f34(0x155),'TH':_0x475f34(0x1a5),'VN':_0x475f34(0x1ad),'MY':_0x475f34(0x160),'SG':_0x475f34(0x14a),'ID':_0x475f34(0x149),'PH':_0x475f34(0x1ab),'LA':_0x475f34(0x176),'KH':_0x475f34(0x12d),'MM':_0x475f34(0x16e),'BD':_0x475f34(0x16f),'LK':_0x475f34(0x19b),'NP':_0x475f34(0x134),'BT':'BTN','MV':_0x475f34(0x141),'AF':_0x475f34(0x1a1),'PK':'PAK','MN':_0x475f34(0x175)},_0x295b83=_0x124db5[_0x43b63f['toUpperCase']()];if(!_0x295b83)return console[_0x475f34(0x191)](_0x475f34(0x1b1)+_0x43b63f+_0x475f34(0x146)),'RUS';return _0x295b83;}async[a46_0x55865d(0x125)](_0x3a0be9){const _0x598be5=a46_0x55865d;try{const {orderId:_0x399109,amount:_0x39aa0e,currency:_0x18c563,firstName:_0x2808ae,lastName:_0x308a68,email:_0x5d7b73,customerIp:_0x34f942,customerCountry:_0x1fadc2,successUrl:_0x33f16b,failureUrl:_0x22c650}=_0x3a0be9;console[_0x598be5(0x101)](_0x598be5(0x1a4)),console[_0x598be5(0x101)](_0x598be5(0x111),_0x399109),console['log'](_0x598be5(0x12e),_0x39aa0e,_0x18c563),console['log']('Customer:',_0x2808ae+'\x20'+_0x308a68),console[_0x598be5(0x101)](_0x598be5(0x174),_0x5d7b73),console[_0x598be5(0x101)](_0x598be5(0x100),_0x34f942),console['log']('Customer\x20Country\x20(2-letter):',_0x1fadc2);const _0x9470b0=this[_0x598be5(0x17b)](_0x1fadc2);console[_0x598be5(0x101)](_0x598be5(0x147),_0x9470b0);const _0x25f635={'sub_method':_0x598be5(0x12a),'currency':_0x18c563[_0x598be5(0x159)](),'amount':_0x39aa0e,'callback_url':_0x598be5(0x179),'client_merchant_id':this['CLIENT_MERCHANT_ID'],'client_transaction_id':_0x399109,'transaction_description':_0x399109,'customer':{'ip':_0x34f942,'email':_0x5d7b73,'full_name':_0x2808ae+'\x20'+_0x308a68,'country':_0x9470b0},'success_redirect_url':_0x33f16b,'error_redirect_url':_0x22c650};console['log'](_0x598be5(0x102),JSON[_0x598be5(0x178)](_0x25f635,null,0x2));const _0x1d72b1=await fetch(this[_0x598be5(0x19c)]+_0x598be5(0x131),{'method':_0x598be5(0xfc),'headers':{'Content-Type':'application/json','User-Agent':_0x598be5(0x13c)},'body':JSON[_0x598be5(0x178)](_0x25f635)}),_0x55bbe9=await _0x1d72b1[_0x598be5(0x158)]();console['log'](_0x598be5(0x19e),_0x55bbe9);if(!_0x1d72b1['ok'])throw new Error(_0x598be5(0x177)+_0x1d72b1[_0x598be5(0x10e)]+'\x20-\x20'+_0x55bbe9);let _0x23d7e2;try{_0x23d7e2=JSON['parse'](_0x55bbe9);}catch(_0x51f658){throw new Error(_0x598be5(0x14e)+_0x55bbe9);}console[_0x598be5(0x101)](_0x598be5(0x13a),JSON['stringify'](_0x23d7e2,null,0x2));if(!_0x23d7e2['redirect_url'])throw new Error(_0x598be5(0x161)+(_0x23d7e2[_0x598be5(0x164)]||_0x23d7e2['message']||_0x598be5(0x154)));const _0x4e89ee=_0x23d7e2[_0x598be5(0x156)],_0x2c4283=_0x23d7e2[_0x598be5(0x166)],_0x3106a2=_0x23d7e2['tracker_id'];return console['log'](_0x598be5(0x18c)),console[_0x598be5(0x101)](_0x598be5(0x140),_0x4e89ee),console[_0x598be5(0x101)]('System\x20ID:',_0x2c4283),console[_0x598be5(0x101)](_0x598be5(0x139),_0x3106a2),console[_0x598be5(0x101)](_0x598be5(0x1a7),_0x23d7e2[_0x598be5(0x10e)]),console['log'](_0x598be5(0x126)),{'gateway_payment_id':_0x2c4283||_0x3106a2||_0x399109,'payment_url':_0x4e89ee||'','transaction_id':_0x2c4283};}catch(_0x347d98){console[_0x598be5(0x194)]('‚ùå\x20AmPay\x20payment\x20creation\x20failed:',_0x347d98),console['log']('üìù\x20Logging\x20AmPay\x20payment\x20creation\x20failure...');throw _0x347d98;}}async[a46_0x55865d(0x19d)](){const _0xff45b6=a46_0x55865d;try{const _0x1f97f9=await fetch(this[_0xff45b6(0x19c)]+_0xff45b6(0x16a),{'method':_0xff45b6(0x13e),'headers':{'Content-Type':_0xff45b6(0x14f),'User-Agent':_0xff45b6(0x13c)}});return _0x1f97f9&&_0x1f97f9['status']===0xc8?!![]:![];}catch(_0x25407f){return console[_0xff45b6(0x194)](_0xff45b6(0x148),_0x25407f),![];}}async[a46_0x55865d(0x14c)](_0x5d40ae){const _0x56efea=a46_0x55865d;console[_0x56efea(0x101)](_0x56efea(0x183)),console['log'](_0x56efea(0x115)),console[_0x56efea(0x101)]('Webhook\x20data:',_0x5d40ae),console[_0x56efea(0x101)](_0x56efea(0xfe),typeof _0x5d40ae),console[_0x56efea(0x101)](_0x56efea(0x17a));_0x5d40ae&&typeof _0x5d40ae===_0x56efea(0x1a3)&&Object[_0x56efea(0x13f)](_0x5d40ae)[_0x56efea(0x11a)](_0x29307b=>{const _0x3b2ffe=_0x56efea;console[_0x3b2ffe(0x101)]('\x20\x20'+_0x29307b+':\x20'+_0x5d40ae[_0x29307b]+'\x20('+typeof _0x5d40ae[_0x29307b]+')');});let _0x2c5120=_0x56efea(0x17f);const _0x299ca2=_0x5d40ae[_0x56efea(0x196)]||_0x5d40ae[_0x56efea(0x166)]||_0x5d40ae[_0x56efea(0x103)]||'';return console[_0x56efea(0x101)](_0x56efea(0xfb)+_0x299ca2),console[_0x56efea(0x101)](_0x56efea(0x192)+_0x2c5120),!_0x299ca2&&(console[_0x56efea(0x194)]('No\x20payment\x20ID\x20found\x20in\x20webhook\x20data'),console[_0x56efea(0x194)]('Checked\x20fields:\x20client_transaction_id,\x20system_id,\x20tracker_id')),{'paymentId':_0x299ca2,'status':_0x2c5120,'amount':_0x5d40ae['amount'],'currency':_0x5d40ae[_0x56efea(0x15e)]};}}exports[a46_0x55865d(0x11e)]=AmPayService,exports['ampayService']=new AmPayService();