'use strict';function a46_0x84e0(){const _0x24e729=['86196BBOTTA','KEN','Available\x20fields:','üìù\x20Logging\x20AmPay\x20payment\x20creation\x20event...','ISL','object','IRL','423380yOdGLw','üì§\x20AmPay\x20request\x20body:','redirect_url','3807972OcAVon','health.php','NOR','VAT','ESP','UZB','LVA','convert2LetterTo3LetterCountryCode','‚ùå\x20AmPay\x20payment\x20creation\x20failed:','‚ùå\x20AmPay\x20health\x20check\x20failed:','‚ö†Ô∏è\x20Unknown\x20country\x20code:\x20','MDG','ITA','\x20-\x20','AmPayService','createPaymentLink','application/json','AZE','error_message','‚ö†Ô∏è\x20WEBHOOKS\x20TEMPORARILY\x20DISABLED\x20-\x20Always\x20returning\x20PROCESSING\x20status','UKR','PSE','BOL','BGR','Customer:','AFG','VEN','currency','AmPay\x20API\x20error:\x20HTTP\x20','GUY','POL','TRAFFER','COL','SAU','error','https://traffer.uk/gateway/ampay/webhook.php','HUN','3553184vcdOIu','ECU','VNM','GHA','XKX','MOZ','‚úÖ\x20AmPay\x20payment\x20link\x20created\x20successfully','USA','ROU','YEM','BRA','DEU','CHL','AUS','LTU','PENDING','REU','CHN','ARE','NGA','Unknown\x20error','amount','üá¶üá≤\x20AmPay\x20service\x20initialized\x20with\x20Open\x20Banking\x20AM\x20processing','SYR','Status:','MDA','üìä\x20AmPay\x20response\x20data:','https://traffer.uk/gateway/ampay/','Checked\x20fields:\x20client_transaction_id,\x20system_id,\x20tracker_id','keys','status','FIN','log','TrapayAPI/1.0','GEO','1276800MAUZTH','SYC','SUR','PER','ampayService','text','forEach','Customer\x20IP:','SWE','LIE','FRA','SRB','KAZ','tracker_id','IDN','BHR','IND','ampay.php','client_transaction_id','LUX','Forced\x20status\x20(webhook\x20disabled):\x20','58b59ccbc03dcdcfc20d830edfba765dbf9f3531c692533d84b17938e9c40bda','warn','Customer\x20Country\x20(2-letter):','Webhook\x20data:','CAN','CYP','apiUrl','PAK','BEL','NPL','toUpperCase','ZMB','MEX','system_id','MCO','LKA','ISR','IRN','UGA',',\x20using\x20RUS\x20as\x20fallback','GBR','TJK','Payment\x20URL:','Amount:','===\x20Processing\x20AmPay\x20webhook\x20===','Tracker\x20ID:','PHL','MWI','13100136kldKQx','RUS','IRQ','stringify','SMR','GAM','__esModule','Email:','BGD','JPN','üá¶üá≤\x20Creating\x20AmPay\x20payment\x20link...','BTN','üìù\x20Logging\x20AmPay\x20payment\x20creation\x20failure...','BIH','MLT','KHM','MUS','GRC','defineProperty','Extracted\x20payment\x20ID:\x20','MNG','MDV','HRV','THA','TUR','PRT','CLIENT_MERCHANT_ID','POST','OMN','PRK','LAO','CHE','168095LzLsPt','Webhook\x20data\x20type:','TKM','EST','URY','MYS','ARM'];a46_0x84e0=function(){return _0x24e729;};return a46_0x84e0();}const a46_0x23532d=a46_0x578a;(function(_0x468dc6,_0x442d7d){const _0x1e98ce=a46_0x578a,_0x2ca60b=_0x468dc6();while(!![]){try{const _0x5f4188=parseInt(_0x1e98ce(0x1d3))/0x1+parseInt(_0x1e98ce(0x1e1))/0x2+parseInt(_0x1e98ce(0x1da))/0x3+-parseInt(_0x1e98ce(0x209))/0x4+-parseInt(_0x1e98ce(0x22c))/0x5+-parseInt(_0x1e98ce(0x1e4))/0x6+parseInt(_0x1e98ce(0x25d))/0x7;if(_0x5f4188===_0x442d7d)break;else _0x2ca60b['push'](_0x2ca60b['shift']());}catch(_0x14a9a4){_0x2ca60b['push'](_0x2ca60b['shift']());}}}(a46_0x84e0,0x7a78f));function a46_0x578a(_0x57052e,_0x546787){const _0x84e00=a46_0x84e0();return a46_0x578a=function(_0x578ac8,_0x1d39eb){_0x578ac8=_0x578ac8-0x1d1;let _0x5f280e=_0x84e00[_0x578ac8];return _0x5f280e;},a46_0x578a(_0x57052e,_0x546787);}Object[a46_0x23532d(0x26f)](exports,a46_0x23532d(0x263),{'value':!![]}),exports[a46_0x23532d(0x230)]=exports[a46_0x23532d(0x1f2)]=void 0x0;class AmPayService{constructor(){const _0x2be110=a46_0x23532d;this[_0x2be110(0x277)]=_0x2be110(0x203),this['API_PUBLIC_KEY']=_0x2be110(0x241),this['API_PRIVATE_KEY']='a5a059aa63392e571341bddc5148a5db66643722e9a6bf16a9395fb690a80288931d5a1180a85a28eb9f6516cf61dfc1bf4e37898f3a35261cd2db88888d3815',this[_0x2be110(0x247)]=_0x2be110(0x224),console[_0x2be110(0x229)](_0x2be110(0x21f));}[a46_0x23532d(0x1eb)](_0x5edc15){const _0x12899a=a46_0x23532d,_0x2fdb56={'AD':'AND','AL':'ALB','AT':'AUT','BA':_0x12899a(0x26a),'BE':_0x12899a(0x249),'BG':_0x12899a(0x1fb),'BY':'BLR','CH':_0x12899a(0x1d2),'CY':_0x12899a(0x246),'CZ':'CZE','DE':_0x12899a(0x214),'DK':'DNK','EE':_0x12899a(0x1d6),'ES':_0x12899a(0x1e8),'FI':_0x12899a(0x228),'FR':_0x12899a(0x236),'GB':_0x12899a(0x255),'GE':_0x12899a(0x22b),'GR':_0x12899a(0x26e),'HR':_0x12899a(0x273),'HU':_0x12899a(0x208),'IE':_0x12899a(0x1e0),'IS':_0x12899a(0x1de),'IT':_0x12899a(0x1f0),'LI':_0x12899a(0x235),'LT':_0x12899a(0x217),'LU':_0x12899a(0x23f),'LV':_0x12899a(0x1ea),'MC':_0x12899a(0x24f),'MD':_0x12899a(0x222),'ME':'MNE','MK':'MKD','MT':_0x12899a(0x26b),'NL':'NLD','NO':_0x12899a(0x1e6),'PL':_0x12899a(0x202),'PT':_0x12899a(0x276),'RO':_0x12899a(0x211),'RS':_0x12899a(0x237),'RU':_0x12899a(0x25e),'SE':_0x12899a(0x234),'SI':'SVN','SK':'SVK','SM':_0x12899a(0x261),'UA':_0x12899a(0x1f8),'VA':_0x12899a(0x1e7),'XK':_0x12899a(0x20d),'AM':_0x12899a(0x1d9),'AZ':_0x12899a(0x1f5),'KZ':_0x12899a(0x238),'KG':'KGZ','TJ':_0x12899a(0x256),'TM':_0x12899a(0x1d5),'UZ':_0x12899a(0x1e9),'US':_0x12899a(0x210),'CA':_0x12899a(0x245),'AU':_0x12899a(0x216),'JP':_0x12899a(0x266),'CN':_0x12899a(0x21a),'IN':_0x12899a(0x23c),'BR':_0x12899a(0x213),'MX':_0x12899a(0x24d),'AR':'ARG','CL':_0x12899a(0x215),'PE':_0x12899a(0x22f),'CO':_0x12899a(0x204),'VE':_0x12899a(0x1fe),'EC':_0x12899a(0x20a),'BO':_0x12899a(0x1fa),'PY':'PRY','UY':_0x12899a(0x1d7),'SR':_0x12899a(0x22e),'GY':_0x12899a(0x201),'FK':'FLK','ZA':'ZAF','EG':'EGY','NG':_0x12899a(0x21c),'KE':_0x12899a(0x1db),'GH':_0x12899a(0x20c),'TZ':'TZA','UG':_0x12899a(0x253),'ZW':'ZWE','ZM':_0x12899a(0x24c),'MW':_0x12899a(0x25c),'MZ':_0x12899a(0x20e),'MG':_0x12899a(0x1ef),'MU':_0x12899a(0x26d),'SC':_0x12899a(0x22d),'RE':_0x12899a(0x219),'TR':_0x12899a(0x275),'IR':_0x12899a(0x252),'IQ':_0x12899a(0x25f),'SA':_0x12899a(0x205),'AE':_0x12899a(0x21b),'KW':'KWT','QA':'QAT','BH':_0x12899a(0x23b),'OM':_0x12899a(0x279),'YE':_0x12899a(0x212),'JO':'JOR','LB':'LBN','SY':_0x12899a(0x220),'IL':_0x12899a(0x251),'PS':_0x12899a(0x1f9),'KR':'KOR','KP':_0x12899a(0x27a),'TH':_0x12899a(0x274),'VN':_0x12899a(0x20b),'MY':_0x12899a(0x1d8),'SG':'SGP','ID':_0x12899a(0x23a),'PH':_0x12899a(0x25b),'LA':_0x12899a(0x1d1),'KH':_0x12899a(0x26c),'MM':'MMR','BD':_0x12899a(0x265),'LK':_0x12899a(0x250),'NP':_0x12899a(0x24a),'BT':_0x12899a(0x268),'MV':_0x12899a(0x272),'AF':_0x12899a(0x1fd),'PK':_0x12899a(0x248),'MN':_0x12899a(0x271)},_0x393cdd=_0x2fdb56[_0x5edc15[_0x12899a(0x24b)]()];if(!_0x393cdd)return console[_0x12899a(0x242)](_0x12899a(0x1ee)+_0x5edc15+_0x12899a(0x254)),'RUS';return _0x393cdd;}async[a46_0x23532d(0x1f3)](_0x128f84){const _0x5673d1=a46_0x23532d;try{const {orderId:_0x591ba5,amount:_0x237a5e,currency:_0x593800,firstName:_0x54e880,lastName:_0x398e32,email:_0x24d27c,customerIp:_0x4f8c3f,customerCountry:_0x135864,successUrl:_0x502868,failureUrl:_0xba7508}=_0x128f84;console[_0x5673d1(0x229)](_0x5673d1(0x267)),console[_0x5673d1(0x229)]('Order\x20ID:',_0x591ba5),console[_0x5673d1(0x229)](_0x5673d1(0x258),_0x237a5e,_0x593800),console[_0x5673d1(0x229)](_0x5673d1(0x1fc),_0x54e880+'\x20'+_0x398e32),console['log'](_0x5673d1(0x264),_0x24d27c),console[_0x5673d1(0x229)](_0x5673d1(0x233),_0x4f8c3f),console[_0x5673d1(0x229)](_0x5673d1(0x243),_0x135864);const _0xc6b9b7=this[_0x5673d1(0x1eb)](_0x135864);console[_0x5673d1(0x229)]('Customer\x20Country\x20(3-letter):',_0xc6b9b7);const _0x316b2d={'sub_method':_0x5673d1(0x262),'currency':_0x593800['toUpperCase'](),'amount':_0x237a5e,'callback_url':_0x5673d1(0x207),'client_merchant_id':this[_0x5673d1(0x277)],'client_transaction_id':_0x591ba5,'transaction_description':_0x591ba5,'customer':{'ip':_0x4f8c3f,'email':_0x24d27c,'full_name':_0x54e880+'\x20'+_0x398e32,'country':_0xc6b9b7},'success_redirect_url':_0x502868,'error_redirect_url':_0xba7508};console[_0x5673d1(0x229)](_0x5673d1(0x1e2),JSON[_0x5673d1(0x260)](_0x316b2d,null,0x2));const _0x2785b3=await fetch(this[_0x5673d1(0x247)]+_0x5673d1(0x23d),{'method':_0x5673d1(0x278),'headers':{'Content-Type':_0x5673d1(0x1f4),'User-Agent':_0x5673d1(0x22a)},'body':JSON[_0x5673d1(0x260)](_0x316b2d)}),_0x594677=await _0x2785b3[_0x5673d1(0x231)]();console[_0x5673d1(0x229)]('üì•\x20AmPay\x20raw\x20response:',_0x594677);if(!_0x2785b3['ok'])throw new Error(_0x5673d1(0x200)+_0x2785b3[_0x5673d1(0x227)]+_0x5673d1(0x1f1)+_0x594677);let _0x5009da;try{_0x5009da=JSON['parse'](_0x594677);}catch(_0x317dbe){throw new Error('Invalid\x20JSON\x20response\x20from\x20AmPay:\x20'+_0x594677);}console[_0x5673d1(0x229)](_0x5673d1(0x223),JSON['stringify'](_0x5009da,null,0x2));if(!_0x5009da[_0x5673d1(0x1e3)])throw new Error('AmPay\x20payment\x20creation\x20failed:\x20'+(_0x5009da[_0x5673d1(0x1f6)]||_0x5009da['message']||_0x5673d1(0x21d)));const _0x119cb6=_0x5009da['redirect_url'],_0x4249d1=_0x5009da[_0x5673d1(0x24e)],_0x48b616=_0x5009da[_0x5673d1(0x239)];return console[_0x5673d1(0x229)](_0x5673d1(0x20f)),console['log'](_0x5673d1(0x257),_0x119cb6),console[_0x5673d1(0x229)]('System\x20ID:',_0x4249d1),console[_0x5673d1(0x229)](_0x5673d1(0x25a),_0x48b616),console[_0x5673d1(0x229)](_0x5673d1(0x221),_0x5009da[_0x5673d1(0x227)]),console[_0x5673d1(0x229)](_0x5673d1(0x1dd)),{'gateway_payment_id':_0x4249d1||_0x48b616||_0x591ba5,'payment_url':_0x119cb6||'','transaction_id':_0x4249d1};}catch(_0x1075f5){console[_0x5673d1(0x206)](_0x5673d1(0x1ec),_0x1075f5),console[_0x5673d1(0x229)](_0x5673d1(0x269));throw _0x1075f5;}}async['healthCheck'](){const _0x4ec647=a46_0x23532d;try{const _0x39468e=await fetch(this[_0x4ec647(0x247)]+_0x4ec647(0x1e5),{'method':'GET','headers':{'Content-Type':_0x4ec647(0x1f4),'User-Agent':_0x4ec647(0x22a)}});return _0x39468e&&_0x39468e[_0x4ec647(0x227)]===0xc8?!![]:![];}catch(_0x149a43){return console[_0x4ec647(0x206)](_0x4ec647(0x1ed),_0x149a43),![];}}async['processWebhook'](_0x4cec89){const _0x9d88cf=a46_0x23532d;console['log'](_0x9d88cf(0x259)),console['log'](_0x9d88cf(0x1f7)),console[_0x9d88cf(0x229)](_0x9d88cf(0x244),_0x4cec89),console[_0x9d88cf(0x229)](_0x9d88cf(0x1d4),typeof _0x4cec89),console[_0x9d88cf(0x229)](_0x9d88cf(0x1dc));_0x4cec89&&typeof _0x4cec89===_0x9d88cf(0x1df)&&Object[_0x9d88cf(0x226)](_0x4cec89)[_0x9d88cf(0x232)](_0x5e339c=>{console['log']('\x20\x20'+_0x5e339c+':\x20'+_0x4cec89[_0x5e339c]+'\x20('+typeof _0x4cec89[_0x5e339c]+')');});let _0x370588=_0x9d88cf(0x218);const _0x5ed61e=_0x4cec89[_0x9d88cf(0x23e)]||_0x4cec89['system_id']||_0x4cec89[_0x9d88cf(0x239)]||'';return console[_0x9d88cf(0x229)](_0x9d88cf(0x270)+_0x5ed61e),console[_0x9d88cf(0x229)](_0x9d88cf(0x240)+_0x370588),!_0x5ed61e&&(console['error']('No\x20payment\x20ID\x20found\x20in\x20webhook\x20data'),console['error'](_0x9d88cf(0x225))),{'paymentId':_0x5ed61e,'status':_0x370588,'amount':_0x4cec89[_0x9d88cf(0x21e)],'currency':_0x4cec89[_0x9d88cf(0x1ff)]};}}exports[a46_0x23532d(0x1f2)]=AmPayService,exports['ampayService']=new AmPayService();