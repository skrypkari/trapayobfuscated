'use strict';const a62_0x472695=a62_0x59d1;(function(_0x4334f9,_0x19116d){const _0x4a4ca0=a62_0x59d1,_0x2600fd=_0x4334f9();while(!![]){try{const _0x21151b=parseInt(_0x4a4ca0(0x1e6))/0x1+parseInt(_0x4a4ca0(0x208))/0x2+-parseInt(_0x4a4ca0(0x1f5))/0x3+-parseInt(_0x4a4ca0(0x242))/0x4*(parseInt(_0x4a4ca0(0x1e3))/0x5)+parseInt(_0x4a4ca0(0x200))/0x6*(-parseInt(_0x4a4ca0(0x226))/0x7)+parseInt(_0x4a4ca0(0x1c5))/0x8*(parseInt(_0x4a4ca0(0x1e9))/0x9)+-parseInt(_0x4a4ca0(0x206))/0xa;if(_0x21151b===_0x19116d)break;else _0x2600fd['push'](_0x2600fd['shift']());}catch(_0x27a9f2){_0x2600fd['push'](_0x2600fd['shift']());}}}(a62_0x40c0,0x4c41e));function a62_0x59d1(_0x566054,_0x2becee){_0x566054=_0x566054-0x1ac;const _0x40c0a2=a62_0x40c0();let _0x59d186=_0x40c0a2[_0x566054];return _0x59d186;}function a62_0x40c0(){const _0x245fdd=['GRC','KAZ','Webhook\x20data:','GHA','SVN','EST','508361tvQHRX','LUX','RUS','tracker_id','PENDING','TKM','MUS','ITA','SMR','CZE','BLR','TrapayAPI/1.0','redirect_url','ðŸ“\x20Logging\x20AmPay\x20payment\x20creation\x20event...','error_message','ðŸ‡¦ðŸ‡²\x20AmPay\x20service\x20initialized\x20with\x20Open\x20Banking\x20AM\x20processing','THA','AmPayService','ðŸ“\x20Logging\x20AmPay\x20payment\x20creation\x20failure...','Checked\x20fields:\x20client_transaction_id,\x20system_id,\x20tracker_id','YEM','NLD','IND','SGP','NGA','58b59ccbc03dcdcfc20d830edfba765dbf9f3531c692533d84b17938e9c40bda','ðŸ‡¦ðŸ‡²\x20Creating\x20AmPay\x20payment\x20link...','client_transaction_id','28rQjjtu','ARE','BOL','ARM','Customer\x20Country\x20(3-letter):','SAU','ðŸ“Š\x20AmPay\x20response\x20data:','CHN','convert2LetterTo3LetterCountryCode','API_PRIVATE_KEY','POL','MLT','CHE','PAK','Tracker\x20ID:','AUS','\x20-\x20','PRK','SYR','âœ…\x20AmPay\x20payment\x20link\x20created\x20successfully','MYS','stringify','ARG','URY','error','ðŸ“¤\x20AmPay\x20request\x20body:','âŒ\x20AmPay\x20health\x20check\x20failed:','a5a059aa63392e571341bddc5148a5db66643722e9a6bf16a9395fb690a80288931d5a1180a85a28eb9f6516cf61dfc1bf4e37898f3a35261cd2db88888d3815','NOR','CYP','836592ozRXwQ','LKA','ALB','LBN','MNG','No\x20payment\x20ID\x20found\x20in\x20webhook\x20data','LTU','KHM','https://traffer.uk/gateway/ampay/','ISL','QAT','VAT','EGY','MDV','Available\x20fields:','FLK','BTN','ECU','Webhook\x20data\x20type:','warn','health.php','https://traffer.uk/gateway/ampay/webhook.php','POST','HUN','SYC','system_id','PSE','GEO','amount','KOR','102745zYStte','BGR','MMR','433720GswAXj','AmPay\x20payment\x20creation\x20failed:\x20','GBR','9scwPDd','BEL','MNE','Email:','LVA','GET','BIH','IRN','SRB','DNK','SVK','BGD','221811GPfhKX','keys','BHR','toUpperCase','AFG','Amount:','ðŸ“¥\x20AmPay\x20raw\x20response:','Order\x20ID:','createPaymentLink','SUR','forEach','30zGsuju','apiUrl','===\x20Processing\x20AmPay\x20webhook\x20===','LAO','KWT','MKD','434680djkuth','defineProperty','796838fOEZer','MEX','PHL','COL','LIE','REU','Customer:','ROU','log','MOZ','IRL','GAM','SWE','IRQ','USA','XKX','Invalid\x20JSON\x20response\x20from\x20AmPay:\x20','CLIENT_MERCHANT_ID','status','Unknown\x20error','Customer\x20Country\x20(2-letter):','PER','AmPay\x20API\x20error:\x20HTTP\x20','ampayService'];a62_0x40c0=function(){return _0x245fdd;};return a62_0x40c0();}Object[a62_0x472695(0x207)](exports,'__esModule',{'value':!![]}),exports[a62_0x472695(0x21f)]=exports['AmPayService']=void 0x0;class AmPayService{constructor(){const _0x2c911d=a62_0x472695;this['CLIENT_MERCHANT_ID']='TRAFFER',this['API_PUBLIC_KEY']=_0x2c911d(0x23f),this[_0x2c911d(0x1b0)]=_0x2c911d(0x1c2),this['apiUrl']=_0x2c911d(0x1cd),console[_0x2c911d(0x210)](_0x2c911d(0x235));}['convert2LetterTo3LetterCountryCode'](_0x14cb14){const _0x19aca8=a62_0x472695,_0x5d4d4d={'AD':'AND','AL':_0x19aca8(0x1c7),'AT':'AUT','BA':_0x19aca8(0x1ef),'BE':_0x19aca8(0x1ea),'BG':_0x19aca8(0x1e4),'BY':_0x19aca8(0x230),'CH':_0x19aca8(0x1b3),'CY':_0x19aca8(0x1c4),'CZ':_0x19aca8(0x22f),'DE':'DEU','DK':_0x19aca8(0x1f2),'EE':_0x19aca8(0x225),'ES':'ESP','FI':'FIN','FR':'FRA','GB':_0x19aca8(0x1e8),'GE':_0x19aca8(0x1e0),'GR':_0x19aca8(0x220),'HR':'HRV','HU':_0x19aca8(0x1dc),'IE':_0x19aca8(0x212),'IS':_0x19aca8(0x1ce),'IT':_0x19aca8(0x22d),'LI':_0x19aca8(0x20c),'LT':_0x19aca8(0x1cb),'LU':_0x19aca8(0x227),'LV':_0x19aca8(0x1ed),'MC':'MCO','MD':'MDA','ME':_0x19aca8(0x1eb),'MK':_0x19aca8(0x205),'MT':_0x19aca8(0x1b2),'NL':_0x19aca8(0x23b),'NO':_0x19aca8(0x1c3),'PL':_0x19aca8(0x1b1),'PT':'PRT','RO':_0x19aca8(0x20f),'RS':_0x19aca8(0x1f1),'RU':_0x19aca8(0x228),'SE':_0x19aca8(0x214),'SI':_0x19aca8(0x224),'SK':_0x19aca8(0x1f3),'SM':_0x19aca8(0x22e),'UA':'UKR','VA':_0x19aca8(0x1d0),'XK':_0x19aca8(0x217),'AM':_0x19aca8(0x245),'AZ':'AZE','KZ':_0x19aca8(0x221),'KG':'KGZ','TJ':'TJK','TM':_0x19aca8(0x22b),'UZ':'UZB','US':_0x19aca8(0x216),'CA':'CAN','AU':_0x19aca8(0x1b6),'JP':'JPN','CN':_0x19aca8(0x1ae),'IN':_0x19aca8(0x23c),'BR':'BRA','MX':_0x19aca8(0x209),'AR':_0x19aca8(0x1bd),'CL':'CHL','PE':_0x19aca8(0x21d),'CO':_0x19aca8(0x20b),'VE':'VEN','EC':_0x19aca8(0x1d6),'BO':_0x19aca8(0x244),'PY':'PRY','UY':_0x19aca8(0x1be),'SR':_0x19aca8(0x1fe),'GY':'GUY','FK':_0x19aca8(0x1d4),'ZA':'ZAF','EG':_0x19aca8(0x1d1),'NG':_0x19aca8(0x23e),'KE':'KEN','GH':_0x19aca8(0x223),'TZ':'TZA','UG':'UGA','ZW':'ZWE','ZM':'ZMB','MW':'MWI','MZ':_0x19aca8(0x211),'MG':'MDG','MU':_0x19aca8(0x22c),'SC':_0x19aca8(0x1dd),'RE':_0x19aca8(0x20d),'TR':'TUR','IR':_0x19aca8(0x1f0),'IQ':_0x19aca8(0x215),'SA':_0x19aca8(0x1ac),'AE':_0x19aca8(0x243),'KW':_0x19aca8(0x204),'QA':_0x19aca8(0x1cf),'BH':_0x19aca8(0x1f7),'OM':'OMN','YE':_0x19aca8(0x23a),'JO':'JOR','LB':_0x19aca8(0x1c8),'SY':_0x19aca8(0x1b9),'IL':'ISR','PS':_0x19aca8(0x1df),'KR':_0x19aca8(0x1e2),'KP':_0x19aca8(0x1b8),'TH':_0x19aca8(0x236),'VN':'VNM','MY':_0x19aca8(0x1bb),'SG':_0x19aca8(0x23d),'ID':'IDN','PH':_0x19aca8(0x20a),'LA':_0x19aca8(0x203),'KH':_0x19aca8(0x1cc),'MM':_0x19aca8(0x1e5),'BD':_0x19aca8(0x1f4),'LK':_0x19aca8(0x1c6),'NP':'NPL','BT':_0x19aca8(0x1d5),'MV':_0x19aca8(0x1d2),'AF':_0x19aca8(0x1f9),'PK':_0x19aca8(0x1b4),'MN':_0x19aca8(0x1c9)},_0x525b87=_0x5d4d4d[_0x14cb14[_0x19aca8(0x1f8)]()];if(!_0x525b87)return console[_0x19aca8(0x1d8)]('âš ï¸\x20Unknown\x20country\x20code:\x20'+_0x14cb14+',\x20using\x20RUS\x20as\x20fallback'),_0x19aca8(0x228);return _0x525b87;}async[a62_0x472695(0x1fd)](_0x4794d6){const _0x40833d=a62_0x472695;try{const {orderId:_0x5023e6,amount:_0x51dd7f,currency:_0x5dbe15,firstName:_0x569320,lastName:_0x5bdd7d,email:_0x5c6f8f,customerIp:_0x4c8b27,customerCountry:_0xe0e37a,successUrl:_0x5c5fc4,failureUrl:_0x3fb77f}=_0x4794d6;console[_0x40833d(0x210)](_0x40833d(0x240)),console[_0x40833d(0x210)](_0x40833d(0x1fc),_0x5023e6),console[_0x40833d(0x210)](_0x40833d(0x1fa),_0x51dd7f,_0x5dbe15),console['log'](_0x40833d(0x20e),_0x569320+'\x20'+_0x5bdd7d),console[_0x40833d(0x210)](_0x40833d(0x1ec),_0x5c6f8f),console[_0x40833d(0x210)]('Customer\x20IP:',_0x4c8b27),console[_0x40833d(0x210)](_0x40833d(0x21c),_0xe0e37a);const _0x16c900=this[_0x40833d(0x1af)](_0xe0e37a);console['log'](_0x40833d(0x246),_0x16c900);const _0x144957={'sub_method':_0x40833d(0x213),'currency':_0x5dbe15['toUpperCase'](),'amount':_0x51dd7f,'callback_url':_0x40833d(0x1da),'client_merchant_id':this[_0x40833d(0x219)],'client_transaction_id':_0x5023e6,'transaction_description':_0x5023e6,'customer':{'ip':_0x4c8b27,'email':_0x5c6f8f,'full_name':_0x569320+'\x20'+_0x5bdd7d,'country':_0x16c900},'success_redirect_url':_0x5c5fc4,'error_redirect_url':_0x3fb77f};console[_0x40833d(0x210)](_0x40833d(0x1c0),JSON['stringify'](_0x144957,null,0x2));const _0x201576=await fetch(this[_0x40833d(0x201)]+'ampay.php',{'method':_0x40833d(0x1db),'headers':{'Content-Type':'application/json','User-Agent':_0x40833d(0x231)},'body':JSON[_0x40833d(0x1bc)](_0x144957)}),_0x50bd95=await _0x201576['text']();console['log'](_0x40833d(0x1fb),_0x50bd95);if(!_0x201576['ok'])throw new Error(_0x40833d(0x21e)+_0x201576['status']+_0x40833d(0x1b7)+_0x50bd95);let _0xe80658;try{_0xe80658=JSON['parse'](_0x50bd95);}catch(_0x5bb678){throw new Error(_0x40833d(0x218)+_0x50bd95);}console[_0x40833d(0x210)](_0x40833d(0x1ad),JSON['stringify'](_0xe80658,null,0x2));if(!_0xe80658[_0x40833d(0x232)])throw new Error(_0x40833d(0x1e7)+(_0xe80658[_0x40833d(0x234)]||_0xe80658['message']||_0x40833d(0x21b)));const _0x3a7b6c=_0xe80658[_0x40833d(0x232)],_0x21787c=_0xe80658[_0x40833d(0x1de)],_0x57216f=_0xe80658[_0x40833d(0x229)];return console['log'](_0x40833d(0x1ba)),console['log']('Payment\x20URL:',_0x3a7b6c),console[_0x40833d(0x210)]('System\x20ID:',_0x21787c),console[_0x40833d(0x210)](_0x40833d(0x1b5),_0x57216f),console[_0x40833d(0x210)]('Status:',_0xe80658[_0x40833d(0x21a)]),console['log'](_0x40833d(0x233)),{'gateway_payment_id':_0x21787c||_0x57216f||_0x5023e6,'payment_url':_0x3a7b6c||'','transaction_id':_0x21787c};}catch(_0x158e87){console[_0x40833d(0x1bf)]('âŒ\x20AmPay\x20payment\x20creation\x20failed:',_0x158e87),console[_0x40833d(0x210)](_0x40833d(0x238));throw _0x158e87;}}async['healthCheck'](){const _0x3797a1=a62_0x472695;try{const _0x3a25e5=await fetch(this[_0x3797a1(0x201)]+_0x3797a1(0x1d9),{'method':_0x3797a1(0x1ee),'headers':{'Content-Type':'application/json','User-Agent':_0x3797a1(0x231)}});return _0x3a25e5&&_0x3a25e5[_0x3797a1(0x21a)]===0xc8?!![]:![];}catch(_0x41b434){return console[_0x3797a1(0x1bf)](_0x3797a1(0x1c1),_0x41b434),![];}}async['processWebhook'](_0x3f273a){const _0x389a80=a62_0x472695;console[_0x389a80(0x210)](_0x389a80(0x202)),console[_0x389a80(0x210)]('âš ï¸\x20WEBHOOKS\x20TEMPORARILY\x20DISABLED\x20-\x20Always\x20returning\x20PROCESSING\x20status'),console['log'](_0x389a80(0x222),_0x3f273a),console[_0x389a80(0x210)](_0x389a80(0x1d7),typeof _0x3f273a),console[_0x389a80(0x210)](_0x389a80(0x1d3));_0x3f273a&&typeof _0x3f273a==='object'&&Object[_0x389a80(0x1f6)](_0x3f273a)[_0x389a80(0x1ff)](_0xeb273e=>{const _0x2799a3=_0x389a80;console[_0x2799a3(0x210)]('\x20\x20'+_0xeb273e+':\x20'+_0x3f273a[_0xeb273e]+'\x20('+typeof _0x3f273a[_0xeb273e]+')');});let _0x439e38=_0x389a80(0x22a);const _0x39bf50=_0x3f273a[_0x389a80(0x241)]||_0x3f273a['system_id']||_0x3f273a[_0x389a80(0x229)]||'';return console[_0x389a80(0x210)]('Extracted\x20payment\x20ID:\x20'+_0x39bf50),console['log']('Forced\x20status\x20(webhook\x20disabled):\x20'+_0x439e38),!_0x39bf50&&(console[_0x389a80(0x1bf)](_0x389a80(0x1ca)),console['error'](_0x389a80(0x239))),{'paymentId':_0x39bf50,'status':_0x439e38,'amount':_0x3f273a[_0x389a80(0x1e1)],'currency':_0x3f273a['currency']};}}exports[a62_0x472695(0x237)]=AmPayService,exports[a62_0x472695(0x21f)]=new AmPayService();