'use strict';const a54_0x8b23ee=a54_0x579e;(function(_0x31f8b1,_0x356eca){const _0x17d926=a54_0x579e,_0x200e54=_0x31f8b1();while(!![]){try{const _0x212076=parseInt(_0x17d926(0x1a0))/0x1*(-parseInt(_0x17d926(0x149))/0x2)+parseInt(_0x17d926(0x137))/0x3+-parseInt(_0x17d926(0x13c))/0x4*(parseInt(_0x17d926(0x14e))/0x5)+-parseInt(_0x17d926(0x17a))/0x6+-parseInt(_0x17d926(0x126))/0x7*(-parseInt(_0x17d926(0x13b))/0x8)+-parseInt(_0x17d926(0x19a))/0x9*(parseInt(_0x17d926(0x10c))/0xa)+-parseInt(_0x17d926(0x153))/0xb*(-parseInt(_0x17d926(0x133))/0xc);if(_0x212076===_0x356eca)break;else _0x200e54['push'](_0x200e54['shift']());}catch(_0x4d6979){_0x200e54['push'](_0x200e54['shift']());}}}(a54_0x2571,0xa0fc4));function a54_0x579e(_0x374357,_0x3912ef){_0x374357=_0x374357-0xff;const _0x257168=a54_0x2571();let _0x579e6b=_0x257168[_0x374357];return _0x579e6b;}function a54_0x2571(){const _0x3c0f55=['KAZ','PRT','66979nNQlQF','PHL','IDN','status','parse','ðŸ“\x20Logging\x20AmPay\x20payment\x20creation\x20event...','TRAFFER','ðŸ‡¦ðŸ‡²\x20AmPay\x20service\x20initialized\x20with\x20Open\x20Banking\x20AM\x20processing','__esModule','TUR','THA','âŒ\x20AmPay\x20payment\x20creation\x20failed:','JOR','BHR','RUS','PAK','https://traffer.uk/gateway/ampay/','HRV','MLT','BTN','CHN','ARG','CHE','warn','Tracker\x20ID:','SUR','AZE','LVA','GEO','SVK','KHM','PSE','MEX','MDV','AFG','LIE','MDG','Customer\x20Country\x20(3-letter):','ampay.php','1352322XjBTCC','Forced\x20status\x20(webhook\x20disabled):\x20','Amount:','healthCheck','Payment\x20URL:','MCO','toUpperCase','Customer:','Order\x20ID:','tracker_id','EGY','REU','ampayService','processWebhook','LTU','AmPayService','KGZ','Extracted\x20payment\x20ID:\x20','AUT','MNE','PENDING','log','JPN','IRQ','YEM','No\x20payment\x20ID\x20found\x20in\x20webhook\x20data','âš ï¸\x20Unknown\x20country\x20code:\x20','CYP','API_PRIVATE_KEY','AmPay\x20API\x20error:\x20HTTP\x20','DNK','CHL','1454499nEvsKO','MYS','GUY','DEU','system_id','===\x20Processing\x20AmPay\x20webhook\x20===','1248798rWXtbI','redirect_url','ARE','KWT','FIN','LAO','ITA','TZA','SGP','NLD','LUX','convert2LetterTo3LetterCountryCode','ZMB','GRC','MOZ','MUS','message','OMN','VEN','UGA','error','SWE','70SGIRak','XKX','BOL','GET','TrapayAPI/1.0','forEach','QAT','GHA','PRK','ZWE','text','IRL','keys','VAT','MWI','ARM','EST','ðŸ“¥\x20AmPay\x20raw\x20response:','application/json','CAN','VNM','Email:','ISL','MKD','Available\x20fields:','amount','63HAsEXM','createPaymentLink','NGA','GAM','SAU','stringify','ROU','CLIENT_MERCHANT_ID','ðŸ“\x20Logging\x20AmPay\x20payment\x20creation\x20failure...','COL','LBN','Checked\x20fields:\x20client_transaction_id,\x20system_id,\x20tracker_id','ESP','7944dSyWOk','IND','AmPay\x20payment\x20creation\x20failed:\x20','BLR','1031826PqmPEX','SYC','AND','defineProperty','98272AKLLPC','2441116BQXmlT','health.php','UKR','KEN','ðŸ“¤\x20AmPay\x20request\x20body:','apiUrl','HUN','UZB','TJK','IRN','ðŸ“Š\x20AmPay\x20response\x20data:','ZAF','Customer\x20Country\x20(2-letter):','2EypLhR','MDA','URY','CZE','âš ï¸\x20WEBHOOKS\x20TEMPORARILY\x20DISABLED\x20-\x20Always\x20returning\x20PROCESSING\x20status','10rXfyMg','GBR','ALB'];a54_0x2571=function(){return _0x3c0f55;};return a54_0x2571();}Object[a54_0x8b23ee(0x13a)](exports,a54_0x8b23ee(0x15b),{'value':!![]}),exports['ampayService']=exports[a54_0x8b23ee(0x189)]=void 0x0;class AmPayService{constructor(){const _0x5b4e59=a54_0x8b23ee;this[_0x5b4e59(0x12d)]=_0x5b4e59(0x159),this['API_PUBLIC_KEY']='58b59ccbc03dcdcfc20d830edfba765dbf9f3531c692533d84b17938e9c40bda',this[_0x5b4e59(0x196)]='a5a059aa63392e571341bddc5148a5db66643722e9a6bf16a9395fb690a80288931d5a1180a85a28eb9f6516cf61dfc1bf4e37898f3a35261cd2db88888d3815',this['apiUrl']=_0x5b4e59(0x163),console[_0x5b4e59(0x18f)](_0x5b4e59(0x15a));}[a54_0x8b23ee(0x101)](_0x5c1f71){const _0x22635a=a54_0x8b23ee,_0x3099fc={'AD':_0x22635a(0x139),'AL':_0x22635a(0x150),'AT':_0x22635a(0x18c),'BA':'BIH','BE':'BEL','BG':'BGR','BY':_0x22635a(0x136),'CH':_0x22635a(0x169),'CY':_0x22635a(0x195),'CZ':_0x22635a(0x14c),'DE':_0x22635a(0x19d),'DK':_0x22635a(0x198),'EE':_0x22635a(0x11c),'ES':_0x22635a(0x132),'FI':_0x22635a(0x1a4),'FR':'FRA','GB':_0x22635a(0x14f),'GE':_0x22635a(0x16f),'GR':_0x22635a(0x103),'HR':_0x22635a(0x164),'HU':_0x22635a(0x142),'IE':_0x22635a(0x117),'IS':_0x22635a(0x122),'IT':_0x22635a(0x1a6),'LI':_0x22635a(0x176),'LT':_0x22635a(0x188),'LU':_0x22635a(0x100),'LV':_0x22635a(0x16e),'MC':_0x22635a(0x17f),'MD':_0x22635a(0x14a),'ME':_0x22635a(0x18d),'MK':_0x22635a(0x123),'MT':_0x22635a(0x165),'NL':_0x22635a(0xff),'NO':'NOR','PL':'POL','PT':_0x22635a(0x152),'RO':_0x22635a(0x12c),'RS':'SRB','RU':_0x22635a(0x161),'SE':_0x22635a(0x10b),'SI':'SVN','SK':_0x22635a(0x170),'SM':'SMR','UA':_0x22635a(0x13e),'VA':_0x22635a(0x119),'XK':_0x22635a(0x10d),'AM':_0x22635a(0x11b),'AZ':_0x22635a(0x16d),'KZ':_0x22635a(0x151),'KG':_0x22635a(0x18a),'TJ':_0x22635a(0x144),'TM':'TKM','UZ':_0x22635a(0x143),'US':'USA','CA':_0x22635a(0x11f),'AU':'AUS','JP':_0x22635a(0x190),'CN':_0x22635a(0x167),'IN':_0x22635a(0x134),'BR':'BRA','MX':_0x22635a(0x173),'AR':_0x22635a(0x168),'CL':_0x22635a(0x199),'PE':'PER','CO':_0x22635a(0x12f),'VE':_0x22635a(0x108),'EC':'ECU','BO':_0x22635a(0x10e),'PY':'PRY','UY':_0x22635a(0x14b),'SR':_0x22635a(0x16c),'GY':_0x22635a(0x19c),'FK':'FLK','ZA':_0x22635a(0x147),'EG':_0x22635a(0x184),'NG':_0x22635a(0x128),'KE':_0x22635a(0x13f),'GH':_0x22635a(0x113),'TZ':_0x22635a(0x1a7),'UG':_0x22635a(0x109),'ZW':_0x22635a(0x115),'ZM':_0x22635a(0x102),'MW':_0x22635a(0x11a),'MZ':_0x22635a(0x104),'MG':_0x22635a(0x177),'MU':_0x22635a(0x105),'SC':_0x22635a(0x138),'RE':_0x22635a(0x185),'TR':_0x22635a(0x15c),'IR':_0x22635a(0x145),'IQ':_0x22635a(0x191),'SA':_0x22635a(0x12a),'AE':_0x22635a(0x1a2),'KW':_0x22635a(0x1a3),'QA':_0x22635a(0x112),'BH':_0x22635a(0x160),'OM':_0x22635a(0x107),'YE':_0x22635a(0x192),'JO':_0x22635a(0x15f),'LB':_0x22635a(0x130),'SY':'SYR','IL':'ISR','PS':_0x22635a(0x172),'KR':'KOR','KP':_0x22635a(0x114),'TH':_0x22635a(0x15d),'VN':_0x22635a(0x120),'MY':_0x22635a(0x19b),'SG':_0x22635a(0x1a8),'ID':_0x22635a(0x155),'PH':_0x22635a(0x154),'LA':_0x22635a(0x1a5),'KH':_0x22635a(0x171),'MM':'MMR','BD':'BGD','LK':'LKA','NP':'NPL','BT':_0x22635a(0x166),'MV':_0x22635a(0x174),'AF':_0x22635a(0x175),'PK':_0x22635a(0x162),'MN':'MNG'},_0x5e42d1=_0x3099fc[_0x5c1f71[_0x22635a(0x180)]()];if(!_0x5e42d1)return console[_0x22635a(0x16a)](_0x22635a(0x194)+_0x5c1f71+',\x20using\x20RUS\x20as\x20fallback'),_0x22635a(0x161);return _0x5e42d1;}async[a54_0x8b23ee(0x127)](_0x38aa33){const _0x537570=a54_0x8b23ee;try{const {orderId:_0x5343d2,amount:_0x27e1a6,currency:_0x46b4e1,firstName:_0x8f7a3d,lastName:_0x3a75eb,email:_0x2d7bee,customerIp:_0x430e51,customerCountry:_0x4d6de1,successUrl:_0x4a38ca,failureUrl:_0x47fde1}=_0x38aa33;console['log']('ðŸ‡¦ðŸ‡²\x20Creating\x20AmPay\x20payment\x20link...'),console[_0x537570(0x18f)](_0x537570(0x182),_0x5343d2),console[_0x537570(0x18f)](_0x537570(0x17c),_0x27e1a6,_0x46b4e1),console[_0x537570(0x18f)](_0x537570(0x181),_0x8f7a3d+'\x20'+_0x3a75eb),console[_0x537570(0x18f)](_0x537570(0x121),_0x2d7bee),console['log']('Customer\x20IP:',_0x430e51),console['log'](_0x537570(0x148),_0x4d6de1);const _0x1136f7=this[_0x537570(0x101)](_0x4d6de1);console['log'](_0x537570(0x178),_0x1136f7);const _0x1a24d4={'sub_method':_0x537570(0x129),'currency':_0x46b4e1['toUpperCase'](),'amount':_0x27e1a6,'callback_url':'https://traffer.uk/gateway/ampay/webhook.php','client_merchant_id':this[_0x537570(0x12d)],'client_transaction_id':_0x5343d2,'transaction_description':_0x5343d2,'customer':{'ip':_0x430e51,'email':_0x2d7bee,'full_name':_0x8f7a3d+'\x20'+_0x3a75eb,'country':_0x1136f7},'success_redirect_url':_0x4a38ca,'error_redirect_url':_0x47fde1};console[_0x537570(0x18f)](_0x537570(0x140),JSON[_0x537570(0x12b)](_0x1a24d4,null,0x2));const _0x4ce4ef=await fetch(this[_0x537570(0x141)]+_0x537570(0x179),{'method':'POST','headers':{'Content-Type':_0x537570(0x11e),'User-Agent':'TrapayAPI/1.0'},'body':JSON['stringify'](_0x1a24d4)}),_0x2cc77a=await _0x4ce4ef[_0x537570(0x116)]();console[_0x537570(0x18f)](_0x537570(0x11d),_0x2cc77a);if(!_0x4ce4ef['ok'])throw new Error(_0x537570(0x197)+_0x4ce4ef['status']+'\x20-\x20'+_0x2cc77a);let _0x479505;try{_0x479505=JSON[_0x537570(0x157)](_0x2cc77a);}catch(_0x292784){throw new Error('Invalid\x20JSON\x20response\x20from\x20AmPay:\x20'+_0x2cc77a);}console[_0x537570(0x18f)](_0x537570(0x146),JSON['stringify'](_0x479505,null,0x2));if(!_0x479505[_0x537570(0x1a1)])throw new Error(_0x537570(0x135)+(_0x479505['error_message']||_0x479505[_0x537570(0x106)]||'Unknown\x20error'));const _0xb56f95=_0x479505[_0x537570(0x1a1)],_0xd378c4=_0x479505[_0x537570(0x19e)],_0x228520=_0x479505[_0x537570(0x183)];return console[_0x537570(0x18f)]('âœ…\x20AmPay\x20payment\x20link\x20created\x20successfully'),console[_0x537570(0x18f)](_0x537570(0x17e),_0xb56f95),console[_0x537570(0x18f)]('System\x20ID:',_0xd378c4),console[_0x537570(0x18f)](_0x537570(0x16b),_0x228520),console[_0x537570(0x18f)]('Status:',_0x479505[_0x537570(0x156)]),console[_0x537570(0x18f)](_0x537570(0x158)),{'gateway_payment_id':_0xd378c4||_0x228520||_0x5343d2,'payment_url':_0xb56f95||'','transaction_id':_0xd378c4};}catch(_0x5c5ca2){console[_0x537570(0x10a)](_0x537570(0x15e),_0x5c5ca2),console[_0x537570(0x18f)](_0x537570(0x12e));throw _0x5c5ca2;}}async[a54_0x8b23ee(0x17d)](){const _0x5565ab=a54_0x8b23ee;try{const _0xf35765=await fetch(this[_0x5565ab(0x141)]+_0x5565ab(0x13d),{'method':_0x5565ab(0x10f),'headers':{'Content-Type':_0x5565ab(0x11e),'User-Agent':_0x5565ab(0x110)}});return _0xf35765&&_0xf35765['status']===0xc8?!![]:![];}catch(_0x1c4843){return console['error']('âŒ\x20AmPay\x20health\x20check\x20failed:',_0x1c4843),![];}}async[a54_0x8b23ee(0x187)](_0x13d7b1){const _0x2fa3bc=a54_0x8b23ee;console[_0x2fa3bc(0x18f)](_0x2fa3bc(0x19f)),console[_0x2fa3bc(0x18f)](_0x2fa3bc(0x14d)),console[_0x2fa3bc(0x18f)]('Webhook\x20data:',_0x13d7b1),console['log']('Webhook\x20data\x20type:',typeof _0x13d7b1),console[_0x2fa3bc(0x18f)](_0x2fa3bc(0x124));_0x13d7b1&&typeof _0x13d7b1==='object'&&Object[_0x2fa3bc(0x118)](_0x13d7b1)[_0x2fa3bc(0x111)](_0xb6fb8e=>{const _0x3b6274=_0x2fa3bc;console[_0x3b6274(0x18f)]('\x20\x20'+_0xb6fb8e+':\x20'+_0x13d7b1[_0xb6fb8e]+'\x20('+typeof _0x13d7b1[_0xb6fb8e]+')');});let _0x3fba13=_0x2fa3bc(0x18e);const _0x295dfb=_0x13d7b1['client_transaction_id']||_0x13d7b1[_0x2fa3bc(0x19e)]||_0x13d7b1['tracker_id']||'';return console[_0x2fa3bc(0x18f)](_0x2fa3bc(0x18b)+_0x295dfb),console[_0x2fa3bc(0x18f)](_0x2fa3bc(0x17b)+_0x3fba13),!_0x295dfb&&(console[_0x2fa3bc(0x10a)](_0x2fa3bc(0x193)),console['error'](_0x2fa3bc(0x131))),{'paymentId':_0x295dfb,'status':_0x3fba13,'amount':_0x13d7b1[_0x2fa3bc(0x125)],'currency':_0x13d7b1['currency']};}}exports['AmPayService']=AmPayService,exports[a54_0x8b23ee(0x186)]=new AmPayService();