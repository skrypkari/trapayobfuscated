'use strict';const a44_0x1ac0e6=a44_0x2df6;(function(_0x5b82fb,_0x1f1c83){const _0x557ce9=a44_0x2df6,_0x492e4f=_0x5b82fb();while(!![]){try{const _0x25a2e4=parseInt(_0x557ce9(0x1fd))/0x1*(parseInt(_0x557ce9(0x1e3))/0x2)+-parseInt(_0x557ce9(0x174))/0x3*(-parseInt(_0x557ce9(0x1ed))/0x4)+-parseInt(_0x557ce9(0x1db))/0x5+parseInt(_0x557ce9(0x1fe))/0x6+parseInt(_0x557ce9(0x19c))/0x7+parseInt(_0x557ce9(0x17b))/0x8*(-parseInt(_0x557ce9(0x181))/0x9)+-parseInt(_0x557ce9(0x1bc))/0xa;if(_0x25a2e4===_0x1f1c83)break;else _0x492e4f['push'](_0x492e4f['shift']());}catch(_0x1e1fc7){_0x492e4f['push'](_0x492e4f['shift']());}}}(a44_0x1b24,0x54770));function a44_0x2df6(_0x52ff7b,_0x2a6dd8){const _0x1b24c5=a44_0x1b24();return a44_0x2df6=function(_0x2df6de,_0x32e9ab){_0x2df6de=_0x2df6de-0x16e;let _0x18fd4f=_0x1b24c5[_0x2df6de];return _0x18fd4f;},a44_0x2df6(_0x52ff7b,_0x2a6dd8);}Object[a44_0x1ac0e6(0x1fa)](exports,a44_0x1ac0e6(0x1f9),{'value':!![]}),exports['ampayService']=exports[a44_0x1ac0e6(0x204)]=void 0x0;function a44_0x1b24(){const _0x2e4f97=['LBN','5968870BoxIoM','QAT','VAT','LKA','toUpperCase','MWI','apiUrl','📊\x20AmPay\x20response\x20data:','❌\x20AmPay\x20payment\x20creation\x20failed:','NOR','HUN','application/json','CHN','BIH','Amount:','CHE','JPN','⚠️\x20Unknown\x20country\x20code:\x20','GEO','TZA','📤\x20AmPay\x20request\x20body:','📥\x20AmPay\x20raw\x20response:','FRA','ITA','healthCheck','MOZ','Forced\x20status\x20(webhook\x20disabled):\x20','convert2LetterTo3LetterCountryCode','MKD','REU','currency','463020kpLjXL','LTU','redirect_url','MNE','FIN','RUS','COL','ARG','78214BNoZDk','✅\x20AmPay\x20payment\x20link\x20created\x20successfully','system_id','USA','LVA','KHM','keys','BEL','BHR','FLK','172AfLull','GHA','POL','MUS','AND','MCO','NGA','Webhook\x20data:','ampay.php','SVN','OMN','AUS','__esModule','defineProperty','JOR','API_PRIVATE_KEY','1wGVNBH','3273234xxYdaa','LIE','error_message','KAZ','LAO','ISR','AmPayService','CHL','ALB','PRT','EGY','client_transaction_id','GBR','createPaymentLink','843bkDbZg','text','AZE','EST','IRN','CYP','AUT','888BnUUar','ZMB','ZAF','KWT','PRK','status','11889QzdYkp','AmPay\x20API\x20error:\x20HTTP\x20','amount','Status:','HRV','parse','⚠️\x20WEBHOOKS\x20TEMPORARILY\x20DISABLED\x20-\x20Always\x20returning\x20PROCESSING\x20status','Customer\x20Country\x20(3-letter):','\x20-\x20','Checked\x20fields:\x20client_transaction_id,\x20system_id,\x20tracker_id','BRA','UZB','URY','MNG','THA','UGA','API_PUBLIC_KEY','Available\x20fields:','📝\x20Logging\x20AmPay\x20payment\x20creation\x20event...','DNK','TKM','Email:','SYR','MMR','Invalid\x20JSON\x20response\x20from\x20AmPay:\x20','IND','PHL','4097527palbsU','🇦🇲\x20Creating\x20AmPay\x20payment\x20link...','Unknown\x20error','SGP','CLIENT_MERCHANT_ID','SMR','MEX','NLD','CAN','KOR','GET','58b59ccbc03dcdcfc20d830edfba765dbf9f3531c692533d84b17938e9c40bda','message','stringify','forEach','DEU','Extracted\x20payment\x20ID:\x20','Customer:','BOL','KGZ','tracker_id','GAM','log','processWebhook','TrapayAPI/1.0','SAU','PRY','🇦🇲\x20AmPay\x20service\x20initialized\x20with\x20Open\x20Banking\x20AM\x20processing','error','IRQ','Customer\x20Country\x20(2-letter):'];a44_0x1b24=function(){return _0x2e4f97;};return a44_0x1b24();}class AmPayService{constructor(){const _0x1a0d91=a44_0x1ac0e6;this[_0x1a0d91(0x1a0)]='TRAFFER',this[_0x1a0d91(0x191)]=_0x1a0d91(0x1a7),this[_0x1a0d91(0x1fc)]='a5a059aa63392e571341bddc5148a5db66643722e9a6bf16a9395fb690a80288931d5a1180a85a28eb9f6516cf61dfc1bf4e37898f3a35261cd2db88888d3815',this[_0x1a0d91(0x1c2)]='https://traffer.uk/gateway/ampay/',console[_0x1a0d91(0x1b2)](_0x1a0d91(0x1b7));}[a44_0x1ac0e6(0x1d7)](_0x4b24fc){const _0x4b726d=a44_0x1ac0e6,_0x10bb22={'AD':_0x4b726d(0x1f1),'AL':_0x4b726d(0x16e),'AT':_0x4b726d(0x17a),'BA':_0x4b726d(0x1c9),'BE':_0x4b726d(0x1ea),'BG':'BGR','BY':'BLR','CH':_0x4b726d(0x1cb),'CY':_0x4b726d(0x179),'CZ':'CZE','DE':_0x4b726d(0x1ab),'DK':_0x4b726d(0x194),'EE':_0x4b726d(0x177),'ES':'ESP','FI':_0x4b726d(0x1df),'FR':_0x4b726d(0x1d2),'GB':_0x4b726d(0x172),'GE':_0x4b726d(0x1ce),'GR':'GRC','HR':_0x4b726d(0x185),'HU':_0x4b726d(0x1c6),'IE':'IRL','IS':'ISL','IT':_0x4b726d(0x1d3),'LI':_0x4b726d(0x1ff),'LT':_0x4b726d(0x1dc),'LU':'LUX','LV':_0x4b726d(0x1e7),'MC':_0x4b726d(0x1f2),'MD':'MDA','ME':_0x4b726d(0x1de),'MK':_0x4b726d(0x1d8),'MT':'MLT','NL':_0x4b726d(0x1a3),'NO':_0x4b726d(0x1c5),'PL':_0x4b726d(0x1ef),'PT':_0x4b726d(0x16f),'RO':'ROU','RS':'SRB','RU':_0x4b726d(0x1e0),'SE':'SWE','SI':_0x4b726d(0x1f6),'SK':'SVK','SM':_0x4b726d(0x1a1),'UA':'UKR','VA':_0x4b726d(0x1be),'XK':'XKX','AM':'ARM','AZ':_0x4b726d(0x176),'KZ':_0x4b726d(0x201),'KG':_0x4b726d(0x1af),'TJ':'TJK','TM':_0x4b726d(0x195),'UZ':_0x4b726d(0x18c),'US':_0x4b726d(0x1e6),'CA':_0x4b726d(0x1a4),'AU':_0x4b726d(0x1f8),'JP':_0x4b726d(0x1cc),'CN':_0x4b726d(0x1c8),'IN':_0x4b726d(0x19a),'BR':_0x4b726d(0x18b),'MX':_0x4b726d(0x1a2),'AR':_0x4b726d(0x1e2),'CL':_0x4b726d(0x205),'PE':'PER','CO':_0x4b726d(0x1e1),'VE':'VEN','EC':'ECU','BO':_0x4b726d(0x1ae),'PY':_0x4b726d(0x1b6),'UY':_0x4b726d(0x18d),'SR':'SUR','GY':'GUY','FK':_0x4b726d(0x1ec),'ZA':_0x4b726d(0x17d),'EG':_0x4b726d(0x170),'NG':_0x4b726d(0x1f3),'KE':'KEN','GH':_0x4b726d(0x1ee),'TZ':_0x4b726d(0x1cf),'UG':_0x4b726d(0x190),'ZW':'ZWE','ZM':_0x4b726d(0x17c),'MW':_0x4b726d(0x1c1),'MZ':_0x4b726d(0x1d5),'MG':'MDG','MU':_0x4b726d(0x1f0),'SC':'SYC','RE':_0x4b726d(0x1d9),'TR':'TUR','IR':_0x4b726d(0x178),'IQ':_0x4b726d(0x1b9),'SA':_0x4b726d(0x1b5),'AE':'ARE','KW':_0x4b726d(0x17e),'QA':_0x4b726d(0x1bd),'BH':_0x4b726d(0x1eb),'OM':_0x4b726d(0x1f7),'YE':'YEM','JO':_0x4b726d(0x1fb),'LB':_0x4b726d(0x1bb),'SY':_0x4b726d(0x197),'IL':_0x4b726d(0x203),'PS':'PSE','KR':_0x4b726d(0x1a5),'KP':_0x4b726d(0x17f),'TH':_0x4b726d(0x18f),'VN':'VNM','MY':'MYS','SG':_0x4b726d(0x19f),'ID':'IDN','PH':_0x4b726d(0x19b),'LA':_0x4b726d(0x202),'KH':_0x4b726d(0x1e8),'MM':_0x4b726d(0x198),'BD':'BGD','LK':_0x4b726d(0x1bf),'NP':'NPL','BT':'BTN','MV':'MDV','AF':'AFG','PK':'PAK','MN':_0x4b726d(0x18e)},_0x2c5634=_0x10bb22[_0x4b24fc['toUpperCase']()];if(!_0x2c5634)return console['warn'](_0x4b726d(0x1cd)+_0x4b24fc+',\x20using\x20RUS\x20as\x20fallback'),'RUS';return _0x2c5634;}async[a44_0x1ac0e6(0x173)](_0x501640){const _0x2438e9=a44_0x1ac0e6;try{const {orderId:_0x635d70,amount:_0x1aa8d4,currency:_0xfa6cd,firstName:_0x220594,lastName:_0x2e7c9d,email:_0x5197ae,customerIp:_0x10e168,customerCountry:_0x51b535,successUrl:_0x575949,failureUrl:_0x379c17}=_0x501640;console[_0x2438e9(0x1b2)](_0x2438e9(0x19d)),console[_0x2438e9(0x1b2)]('Order\x20ID:',_0x635d70),console['log'](_0x2438e9(0x1ca),_0x1aa8d4,_0xfa6cd),console[_0x2438e9(0x1b2)](_0x2438e9(0x1ad),_0x220594+'\x20'+_0x2e7c9d),console[_0x2438e9(0x1b2)](_0x2438e9(0x196),_0x5197ae),console[_0x2438e9(0x1b2)]('Customer\x20IP:',_0x10e168),console[_0x2438e9(0x1b2)](_0x2438e9(0x1ba),_0x51b535);const _0x2faa61=this[_0x2438e9(0x1d7)](_0x51b535);console[_0x2438e9(0x1b2)](_0x2438e9(0x188),_0x2faa61);const _0x13fe65={'sub_method':_0x2438e9(0x1b1),'currency':_0xfa6cd[_0x2438e9(0x1c0)](),'amount':_0x1aa8d4,'callback_url':'https://traffer.uk/gateway/ampay/webhook.php','client_merchant_id':this[_0x2438e9(0x1a0)],'client_transaction_id':_0x635d70,'transaction_description':_0x635d70,'customer':{'ip':_0x10e168,'email':_0x5197ae,'full_name':_0x220594+'\x20'+_0x2e7c9d,'country':_0x2faa61},'success_redirect_url':_0x575949,'error_redirect_url':_0x379c17};console[_0x2438e9(0x1b2)](_0x2438e9(0x1d0),JSON[_0x2438e9(0x1a9)](_0x13fe65,null,0x2));const _0xa4fdb=await fetch(this[_0x2438e9(0x1c2)]+_0x2438e9(0x1f5),{'method':'POST','headers':{'Content-Type':_0x2438e9(0x1c7),'User-Agent':_0x2438e9(0x1b4)},'body':JSON[_0x2438e9(0x1a9)](_0x13fe65)}),_0x324f48=await _0xa4fdb[_0x2438e9(0x175)]();console[_0x2438e9(0x1b2)](_0x2438e9(0x1d1),_0x324f48);if(!_0xa4fdb['ok'])throw new Error(_0x2438e9(0x182)+_0xa4fdb[_0x2438e9(0x180)]+_0x2438e9(0x189)+_0x324f48);let _0x5a8bfe;try{_0x5a8bfe=JSON[_0x2438e9(0x186)](_0x324f48);}catch(_0x30b381){throw new Error(_0x2438e9(0x199)+_0x324f48);}console[_0x2438e9(0x1b2)](_0x2438e9(0x1c3),JSON[_0x2438e9(0x1a9)](_0x5a8bfe,null,0x2));if(!_0x5a8bfe['redirect_url'])throw new Error('AmPay\x20payment\x20creation\x20failed:\x20'+(_0x5a8bfe[_0x2438e9(0x200)]||_0x5a8bfe[_0x2438e9(0x1a8)]||_0x2438e9(0x19e)));const _0x43c0cf=_0x5a8bfe[_0x2438e9(0x1dd)],_0x540cde=_0x5a8bfe[_0x2438e9(0x1e5)],_0x198b0c=_0x5a8bfe[_0x2438e9(0x1b0)];return console[_0x2438e9(0x1b2)](_0x2438e9(0x1e4)),console[_0x2438e9(0x1b2)]('Payment\x20URL:',_0x43c0cf),console[_0x2438e9(0x1b2)]('System\x20ID:',_0x540cde),console[_0x2438e9(0x1b2)]('Tracker\x20ID:',_0x198b0c),console['log'](_0x2438e9(0x184),_0x5a8bfe[_0x2438e9(0x180)]),console[_0x2438e9(0x1b2)](_0x2438e9(0x193)),{'gateway_payment_id':_0x540cde||_0x198b0c||_0x635d70,'payment_url':_0x43c0cf||'','transaction_id':_0x540cde};}catch(_0x2aed69){console[_0x2438e9(0x1b8)](_0x2438e9(0x1c4),_0x2aed69),console[_0x2438e9(0x1b2)]('📝\x20Logging\x20AmPay\x20payment\x20creation\x20failure...');throw _0x2aed69;}}async[a44_0x1ac0e6(0x1d4)](){const _0x27bddb=a44_0x1ac0e6;try{const _0x564692=await fetch(this[_0x27bddb(0x1c2)]+'health.php',{'method':_0x27bddb(0x1a6),'headers':{'Content-Type':_0x27bddb(0x1c7),'User-Agent':_0x27bddb(0x1b4)}});return _0x564692&&_0x564692['status']===0xc8?!![]:![];}catch(_0x1b1088){return console[_0x27bddb(0x1b8)]('❌\x20AmPay\x20health\x20check\x20failed:',_0x1b1088),![];}}async[a44_0x1ac0e6(0x1b3)](_0xb46c28){const _0x1d8eb3=a44_0x1ac0e6;console[_0x1d8eb3(0x1b2)]('===\x20Processing\x20AmPay\x20webhook\x20==='),console[_0x1d8eb3(0x1b2)](_0x1d8eb3(0x187)),console[_0x1d8eb3(0x1b2)](_0x1d8eb3(0x1f4),_0xb46c28),console[_0x1d8eb3(0x1b2)]('Webhook\x20data\x20type:',typeof _0xb46c28),console[_0x1d8eb3(0x1b2)](_0x1d8eb3(0x192));_0xb46c28&&typeof _0xb46c28==='object'&&Object[_0x1d8eb3(0x1e9)](_0xb46c28)[_0x1d8eb3(0x1aa)](_0x530a32=>{const _0x2837bb=_0x1d8eb3;console[_0x2837bb(0x1b2)]('\x20\x20'+_0x530a32+':\x20'+_0xb46c28[_0x530a32]+'\x20('+typeof _0xb46c28[_0x530a32]+')');});let _0x15706a='PENDING';const _0x13ee13=_0xb46c28[_0x1d8eb3(0x171)]||_0xb46c28[_0x1d8eb3(0x1e5)]||_0xb46c28[_0x1d8eb3(0x1b0)]||'';return console[_0x1d8eb3(0x1b2)](_0x1d8eb3(0x1ac)+_0x13ee13),console[_0x1d8eb3(0x1b2)](_0x1d8eb3(0x1d6)+_0x15706a),!_0x13ee13&&(console[_0x1d8eb3(0x1b8)]('No\x20payment\x20ID\x20found\x20in\x20webhook\x20data'),console['error'](_0x1d8eb3(0x18a))),{'paymentId':_0x13ee13,'status':_0x15706a,'amount':_0xb46c28[_0x1d8eb3(0x183)],'currency':_0xb46c28[_0x1d8eb3(0x1da)]};}}exports[a44_0x1ac0e6(0x204)]=AmPayService,exports['ampayService']=new AmPayService();