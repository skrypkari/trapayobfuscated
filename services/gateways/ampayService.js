'use strict';const a44_0x23668b=a44_0x3901;(function(_0x4e96ef,_0x450e3c){const _0x5cffef=a44_0x3901,_0x22a0cf=_0x4e96ef();while(!![]){try{const _0x598dea=-parseInt(_0x5cffef(0xfd))/0x1+-parseInt(_0x5cffef(0x127))/0x2*(-parseInt(_0x5cffef(0x118))/0x3)+parseInt(_0x5cffef(0xc1))/0x4+parseInt(_0x5cffef(0x15a))/0x5*(-parseInt(_0x5cffef(0xd3))/0x6)+parseInt(_0x5cffef(0x13c))/0x7*(-parseInt(_0x5cffef(0xdd))/0x8)+parseInt(_0x5cffef(0x101))/0x9+parseInt(_0x5cffef(0x129))/0xa;if(_0x598dea===_0x450e3c)break;else _0x22a0cf['push'](_0x22a0cf['shift']());}catch(_0xe2f6b5){_0x22a0cf['push'](_0x22a0cf['shift']());}}}(a44_0x2735,0x9b64a));Object[a44_0x23668b(0xe9)](exports,a44_0x23668b(0xef),{'value':!![]}),exports[a44_0x23668b(0xea)]=exports[a44_0x23668b(0x114)]=void 0x0;function a44_0x3901(_0x59d637,_0x3deb65){const _0x2735a8=a44_0x2735();return a44_0x3901=function(_0x3901e3,_0x230ce2){_0x3901e3=_0x3901e3-0xbd;let _0xb4f44e=_0x2735a8[_0x3901e3];return _0xb4f44e;},a44_0x3901(_0x59d637,_0x3deb65);}class AmPayService{constructor(){const _0x2fd369=a44_0x23668b;this[_0x2fd369(0xe8)]=_0x2fd369(0xcf),this[_0x2fd369(0xf2)]=_0x2fd369(0x155),this['API_PRIVATE_KEY']=_0x2fd369(0x111),this[_0x2fd369(0x112)]=_0x2fd369(0x138),console['log'](_0x2fd369(0x11e));}['convert2LetterTo3LetterCountryCode'](_0x236a25){const _0x40f102=a44_0x23668b,_0x556ea8={'AD':_0x40f102(0x13d),'AL':_0x40f102(0x149),'AT':_0x40f102(0x121),'BA':_0x40f102(0x10c),'BE':'BEL','BG':_0x40f102(0x12e),'BY':'BLR','CH':_0x40f102(0xd5),'CY':_0x40f102(0xe0),'CZ':'CZE','DE':_0x40f102(0x143),'DK':'DNK','EE':_0x40f102(0x115),'ES':_0x40f102(0xdc),'FI':_0x40f102(0x116),'FR':_0x40f102(0x103),'GB':'GBR','GE':'GEO','GR':_0x40f102(0xc9),'HR':_0x40f102(0xd0),'HU':_0x40f102(0x104),'IE':_0x40f102(0xeb),'IS':_0x40f102(0x150),'IT':_0x40f102(0xf5),'LI':_0x40f102(0x14e),'LT':_0x40f102(0xbe),'LU':_0x40f102(0xd1),'LV':_0x40f102(0x100),'MC':'MCO','MD':_0x40f102(0xda),'ME':_0x40f102(0x11f),'MK':_0x40f102(0xbf),'MT':_0x40f102(0x132),'NL':_0x40f102(0x119),'NO':'NOR','PL':'POL','PT':_0x40f102(0xf4),'RO':_0x40f102(0x156),'RS':'SRB','RU':_0x40f102(0x15c),'SE':'SWE','SI':_0x40f102(0x158),'SK':'SVK','SM':_0x40f102(0xe2),'UA':_0x40f102(0x151),'VA':_0x40f102(0x128),'XK':_0x40f102(0x125),'AM':_0x40f102(0x106),'AZ':'AZE','KZ':_0x40f102(0xca),'KG':_0x40f102(0xf8),'TJ':_0x40f102(0x13f),'TM':_0x40f102(0xff),'UZ':_0x40f102(0x139),'US':'USA','CA':_0x40f102(0x131),'AU':_0x40f102(0x126),'JP':'JPN','CN':_0x40f102(0xd2),'IN':'IND','BR':'BRA','MX':_0x40f102(0x13a),'AR':_0x40f102(0x11b),'CL':_0x40f102(0x124),'PE':_0x40f102(0xd9),'CO':_0x40f102(0x117),'VE':'VEN','EC':_0x40f102(0xd8),'BO':_0x40f102(0xf9),'PY':'PRY','UY':_0x40f102(0x14f),'SR':'SUR','GY':_0x40f102(0x12a),'FK':_0x40f102(0xf6),'ZA':_0x40f102(0x159),'EG':'EGY','NG':_0x40f102(0x142),'KE':_0x40f102(0xbd),'GH':_0x40f102(0xc0),'TZ':_0x40f102(0x123),'UG':_0x40f102(0x141),'ZW':'ZWE','ZM':_0x40f102(0x11d),'MW':_0x40f102(0xc8),'MZ':_0x40f102(0xc7),'MG':'MDG','MU':_0x40f102(0x108),'SC':_0x40f102(0xcb),'RE':_0x40f102(0xe1),'TR':_0x40f102(0x122),'IR':_0x40f102(0x113),'IQ':_0x40f102(0xc3),'SA':'SAU','AE':'ARE','KW':'KWT','QA':_0x40f102(0xe4),'BH':_0x40f102(0x109),'OM':_0x40f102(0x11a),'YE':_0x40f102(0x120),'JO':_0x40f102(0xdf),'LB':_0x40f102(0x14a),'SY':_0x40f102(0xec),'IL':'ISR','PS':_0x40f102(0xcd),'KR':_0x40f102(0x130),'KP':'PRK','TH':'THA','VN':_0x40f102(0x140),'MY':'MYS','SG':_0x40f102(0xfc),'ID':_0x40f102(0xee),'PH':'PHL','LA':'LAO','KH':_0x40f102(0x154),'MM':'MMR','BD':'BGD','LK':_0x40f102(0xc6),'NP':_0x40f102(0xed),'BT':'BTN','MV':'MDV','AF':_0x40f102(0xf7),'PK':_0x40f102(0xdb),'MN':_0x40f102(0x12f)},_0x3aff32=_0x556ea8[_0x236a25[_0x40f102(0x13e)]()];if(!_0x3aff32)return console[_0x40f102(0xcc)](_0x40f102(0x10a)+_0x236a25+',\x20using\x20RUS\x20as\x20fallback'),_0x40f102(0x15c);return _0x3aff32;}async[a44_0x23668b(0x10f)](_0x39bfd6){const _0x2af37f=a44_0x23668b;try{const {orderId:_0x56777c,amount:_0x241655,currency:_0x6139af,firstName:_0x5c94ee,lastName:_0x31c18b,email:_0x40e4e1,customerIp:_0x327709,customerCountry:_0x1ed214,successUrl:_0x43de9f,failureUrl:_0x17ee8a}=_0x39bfd6;console['log'](_0x2af37f(0xc5)),console[_0x2af37f(0xde)](_0x2af37f(0x157),_0x56777c),console[_0x2af37f(0xde)](_0x2af37f(0x153),_0x241655,_0x6139af),console[_0x2af37f(0xde)](_0x2af37f(0x105),_0x5c94ee+'\x20'+_0x31c18b),console[_0x2af37f(0xde)](_0x2af37f(0x110),_0x40e4e1),console['log'](_0x2af37f(0x12c),_0x327709),console['log'](_0x2af37f(0x10d),_0x1ed214);const _0x3afe27=this[_0x2af37f(0x14d)](_0x1ed214);console[_0x2af37f(0xde)](_0x2af37f(0xd6),_0x3afe27);const _0x5adca={'sub_method':_0x2af37f(0x148),'currency':_0x6139af[_0x2af37f(0x13e)](),'amount':_0x241655,'callback_url':'https://traffer.uk/gateway/ampay/webhook.php','client_merchant_id':this[_0x2af37f(0xe8)],'client_transaction_id':_0x56777c,'transaction_description':_0x56777c,'customer':{'ip':_0x327709,'email':_0x40e4e1,'full_name':_0x5c94ee+'\x20'+_0x31c18b,'country':_0x3afe27},'success_redirect_url':_0x43de9f,'error_redirect_url':_0x17ee8a};console['log']('üì§\x20AmPay\x20request\x20body:',JSON[_0x2af37f(0x147)](_0x5adca,null,0x2));const _0x3840a6=await fetch(this[_0x2af37f(0x112)]+_0x2af37f(0x11c),{'method':_0x2af37f(0xc4),'headers':{'Content-Type':_0x2af37f(0x102),'User-Agent':_0x2af37f(0xe5)},'body':JSON[_0x2af37f(0x147)](_0x5adca)}),_0x4a646a=await _0x3840a6[_0x2af37f(0xfe)]();console[_0x2af37f(0xde)](_0x2af37f(0xc2),_0x4a646a);if(!_0x3840a6['ok'])throw new Error('AmPay\x20API\x20error:\x20HTTP\x20'+_0x3840a6[_0x2af37f(0xe3)]+_0x2af37f(0xd4)+_0x4a646a);let _0xa1c3e5;try{_0xa1c3e5=JSON[_0x2af37f(0xce)](_0x4a646a);}catch(_0x5a5dab){throw new Error(_0x2af37f(0xd7)+_0x4a646a);}console[_0x2af37f(0xde)]('üìä\x20AmPay\x20response\x20data:',JSON[_0x2af37f(0x147)](_0xa1c3e5,null,0x2));if(!_0xa1c3e5['redirect_url'])throw new Error(_0x2af37f(0x136)+(_0xa1c3e5[_0x2af37f(0x134)]||_0xa1c3e5[_0x2af37f(0x146)]||'Unknown\x20error'));const _0x4788a6=_0xa1c3e5['redirect_url'],_0x2e3456=_0xa1c3e5[_0x2af37f(0xf1)],_0x328246=_0xa1c3e5[_0x2af37f(0x145)];return console[_0x2af37f(0xde)](_0x2af37f(0x152)),console[_0x2af37f(0xde)](_0x2af37f(0x13b),_0x4788a6),console[_0x2af37f(0xde)]('System\x20ID:',_0x2e3456),console['log'](_0x2af37f(0x14c),_0x328246),console['log'](_0x2af37f(0xfb),_0xa1c3e5['status']),console[_0x2af37f(0xde)](_0x2af37f(0x107)),{'gateway_payment_id':_0x2e3456||_0x328246||_0x56777c,'payment_url':_0x4788a6||'','transaction_id':_0x2e3456};}catch(_0x26e856){console[_0x2af37f(0xfa)](_0x2af37f(0x10b),_0x26e856),console['log'](_0x2af37f(0x14b));throw _0x26e856;}}async['healthCheck'](){const _0x3bec3f=a44_0x23668b;try{const _0x3aaa51=await fetch(this[_0x3bec3f(0x112)]+'health.php',{'method':_0x3bec3f(0xf3),'headers':{'Content-Type':_0x3bec3f(0x102),'User-Agent':'TrapayAPI/1.0'}});return _0x3aaa51&&_0x3aaa51[_0x3bec3f(0xe3)]===0xc8?!![]:![];}catch(_0x1e298c){return console[_0x3bec3f(0xfa)](_0x3bec3f(0x15d),_0x1e298c),![];}}async['processWebhook'](_0x5473af){const _0x59abc1=a44_0x23668b;console[_0x59abc1(0xde)](_0x59abc1(0xf0)),console[_0x59abc1(0xde)](_0x59abc1(0x133)),console['log'](_0x59abc1(0x15b),_0x5473af),console[_0x59abc1(0xde)]('Webhook\x20data\x20type:',typeof _0x5473af),console[_0x59abc1(0xde)](_0x59abc1(0x135));_0x5473af&&typeof _0x5473af==='object'&&Object['keys'](_0x5473af)[_0x59abc1(0x137)](_0x2f20d6=>{const _0xd6e05e=_0x59abc1;console[_0xd6e05e(0xde)]('\x20\x20'+_0x2f20d6+':\x20'+_0x5473af[_0x2f20d6]+'\x20('+typeof _0x5473af[_0x2f20d6]+')');});let _0x5bd3d9=_0x59abc1(0x10e);const _0x3c4c3a=_0x5473af[_0x59abc1(0x12b)]||_0x5473af['system_id']||_0x5473af['tracker_id']||'';return console[_0x59abc1(0xde)](_0x59abc1(0x12d)+_0x3c4c3a),console['log'](_0x59abc1(0xe6)+_0x5bd3d9),!_0x3c4c3a&&(console[_0x59abc1(0xfa)]('No\x20payment\x20ID\x20found\x20in\x20webhook\x20data'),console[_0x59abc1(0xfa)](_0x59abc1(0xe7))),{'paymentId':_0x3c4c3a,'status':_0x5bd3d9,'amount':_0x5473af[_0x59abc1(0x144)],'currency':_0x5473af['currency']};}}exports[a44_0x23668b(0x114)]=AmPayService,exports[a44_0x23668b(0xea)]=new AmPayService();function a44_0x2735(){const _0x3eb7c2=['system_id','API_PUBLIC_KEY','GET','PRT','ITA','FLK','AFG','KGZ','BOL','error','Status:','SGP','975857PyJFNR','text','TKM','LVA','8380341IYHvOB','application/json','FRA','HUN','Customer:','ARM','üìù\x20Logging\x20AmPay\x20payment\x20creation\x20event...','MUS','BHR','‚ö†Ô∏è\x20Unknown\x20country\x20code:\x20','‚ùå\x20AmPay\x20payment\x20creation\x20failed:','BIH','Customer\x20Country\x20(2-letter):','PENDING','createPaymentLink','Email:','a5a059aa63392e571341bddc5148a5db66643722e9a6bf16a9395fb690a80288931d5a1180a85a28eb9f6516cf61dfc1bf4e37898f3a35261cd2db88888d3815','apiUrl','IRN','AmPayService','EST','FIN','COL','642687DTzswy','NLD','OMN','ARG','ampay.php','ZMB','üá¶üá≤\x20AmPay\x20service\x20initialized\x20with\x20Open\x20Banking\x20AM\x20processing','MNE','YEM','AUT','TUR','TZA','CHL','XKX','AUS','2wCcvRz','VAT','17911640SODNJZ','GUY','client_transaction_id','Customer\x20IP:','Extracted\x20payment\x20ID:\x20','BGR','MNG','KOR','CAN','MLT','‚ö†Ô∏è\x20WEBHOOKS\x20TEMPORARILY\x20DISABLED\x20-\x20Always\x20returning\x20PROCESSING\x20status','error_message','Available\x20fields:','AmPay\x20payment\x20creation\x20failed:\x20','forEach','https://traffer.uk/gateway/ampay/','UZB','MEX','Payment\x20URL:','1250060LkaaAA','AND','toUpperCase','TJK','VNM','UGA','NGA','DEU','amount','tracker_id','message','stringify','GAM','ALB','LBN','üìù\x20Logging\x20AmPay\x20payment\x20creation\x20failure...','Tracker\x20ID:','convert2LetterTo3LetterCountryCode','LIE','URY','ISL','UKR','‚úÖ\x20AmPay\x20payment\x20link\x20created\x20successfully','Amount:','KHM','58b59ccbc03dcdcfc20d830edfba765dbf9f3531c692533d84b17938e9c40bda','ROU','Order\x20ID:','SVN','ZAF','95xwrkZV','Webhook\x20data:','RUS','‚ùå\x20AmPay\x20health\x20check\x20failed:','KEN','LTU','MKD','GHA','2288836OOaPdD','üì•\x20AmPay\x20raw\x20response:','IRQ','POST','üá¶üá≤\x20Creating\x20AmPay\x20payment\x20link...','LKA','MOZ','MWI','GRC','KAZ','SYC','warn','PSE','parse','TRAFFER','HRV','LUX','CHN','316896wjXwLi','\x20-\x20','CHE','Customer\x20Country\x20(3-letter):','Invalid\x20JSON\x20response\x20from\x20AmPay:\x20','ECU','PER','MDA','PAK','ESP','40mitwae','log','JOR','CYP','REU','SMR','status','QAT','TrapayAPI/1.0','Forced\x20status\x20(webhook\x20disabled):\x20','Checked\x20fields:\x20client_transaction_id,\x20system_id,\x20tracker_id','CLIENT_MERCHANT_ID','defineProperty','ampayService','IRL','SYR','NPL','IDN','__esModule','===\x20Processing\x20AmPay\x20webhook\x20==='];a44_0x2735=function(){return _0x3eb7c2;};return a44_0x2735();}