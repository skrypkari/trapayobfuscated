'use strict';function a44_0x5059(_0x415020,_0x1a944b){const _0x7cbd7d=a44_0x7cbd();return a44_0x5059=function(_0x505933,_0x6cd109){_0x505933=_0x505933-0xcb;let _0x26e777=_0x7cbd7d[_0x505933];return _0x26e777;},a44_0x5059(_0x415020,_0x1a944b);}function a44_0x7cbd(){const _0x13f1c6=['processWebhook','REU','89084pHyJFu','Webhook\x20data:','redirect_url','System\x20ID:','KOR','ZMB','MOZ','forEach','SRB','ARG','KGZ','RUS','No\x20payment\x20ID\x20found\x20in\x20webhook\x20data','TrapayAPI/1.0','HRV','10hnTXij','warn','KHM','KWT','58b59ccbc03dcdcfc20d830edfba765dbf9f3531c692533d84b17938e9c40bda','API_PRIVATE_KEY','CHN','toUpperCase','MNG','CLIENT_MERCHANT_ID','TUR','SGP','‚úÖ\x20AmPay\x20payment\x20link\x20created\x20successfully','PHL','AFG','NOR','Webhook\x20data\x20type:','apiUrl','GUY','NPL','application/json','parse','NGA','2943857Gzfafh','MDG','https://traffer.uk/gateway/ampay/webhook.php','IRN','LUX','95520Asouub','2167ZgUgBf','2343243UnPbxR','AmPay\x20payment\x20creation\x20failed:\x20','‚ö†Ô∏è\x20Unknown\x20country\x20code:\x20','Customer\x20Country\x20(2-letter):','ALB','IDN','ITA','BEL','IRQ','IRL','Invalid\x20JSON\x20response\x20from\x20AmPay:\x20','2436558tfDTdw','QAT','VEN','UZB','OMN','110vmuTDK','GHA','FLK','convert2LetterTo3LetterCountryCode','LBN','üìù\x20Logging\x20AmPay\x20payment\x20creation\x20failure...','MDV','GAM','LVA','YEM','653418KqpwxK','system_id','\x20-\x20','Customer\x20Country\x20(3-letter):','üìä\x20AmPay\x20response\x20data:','LIE','LAO','EST','PRK','TKM','ampay.php','8oaYTME','error','LKA','Forced\x20status\x20(webhook\x20disabled):\x20','THA','CHE','log','MCO','KEN','2PZiukr','Tracker\x20ID:','SVK','POST','ZWE','üì•\x20AmPay\x20raw\x20response:','MLT','Checked\x20fields:\x20client_transaction_id,\x20system_id,\x20tracker_id','ZAF','GET',',\x20using\x20RUS\x20as\x20fallback','BLR','tracker_id','keys','MWI','stringify','MEX','error_message','PENDING','BRA','TZA','POL','BGD','ARM','MUS','MMR','Order\x20ID:','status','GEO','FIN','JOR','SUR','ISL','object','TRAFFER','BOL','https://traffer.uk/gateway/ampay/','CZE','‚ö†Ô∏è\x20WEBHOOKS\x20TEMPORARILY\x20DISABLED\x20-\x20Always\x20returning\x20PROCESSING\x20status','CYP','AUT','Status:','ROU','PRY','text','SAU','IND','createPaymentLink','AmPayService','XKX','GBR','UGA','client_transaction_id','AmPay\x20API\x20error:\x20HTTP\x20','BGR','Customer:','AND','UKR','USA','message','SYR','‚ùå\x20AmPay\x20payment\x20creation\x20failed:','Extracted\x20payment\x20ID:\x20','TJK','Amount:','üìù\x20Logging\x20AmPay\x20payment\x20creation\x20event...','DEU','AUS','KAZ','PSE','774863bUvFnY'];a44_0x7cbd=function(){return _0x13f1c6;};return a44_0x7cbd();}const a44_0x297d8b=a44_0x5059;(function(_0x25063b,_0x153d6b){const _0x4aba99=a44_0x5059,_0x48a113=_0x25063b();while(!![]){try{const _0x5c9c60=parseInt(_0x4aba99(0x11a))/0x1+parseInt(_0x4aba99(0xd4))/0x2*(parseInt(_0x4aba99(0x14a))/0x3)+parseInt(_0x4aba99(0x11d))/0x4+parseInt(_0x4aba99(0x12c))/0x5*(-parseInt(_0x4aba99(0x155))/0x6)+parseInt(_0x4aba99(0x143))/0x7*(parseInt(_0x4aba99(0xcb))/0x8)+-parseInt(_0x4aba99(0x164))/0x9*(-parseInt(_0x4aba99(0x15a))/0xa)+parseInt(_0x4aba99(0x149))/0xb*(-parseInt(_0x4aba99(0x148))/0xc);if(_0x5c9c60===_0x153d6b)break;else _0x48a113['push'](_0x48a113['shift']());}catch(_0x3a587b){_0x48a113['push'](_0x48a113['shift']());}}}(a44_0x7cbd,0x65d3a));Object['defineProperty'](exports,'__esModule',{'value':!![]}),exports['ampayService']=exports[a44_0x297d8b(0x104)]=void 0x0;class AmPayService{constructor(){const _0x3e8bb4=a44_0x297d8b;this[_0x3e8bb4(0x135)]=_0x3e8bb4(0xf6),this['API_PUBLIC_KEY']=_0x3e8bb4(0x130),this[_0x3e8bb4(0x131)]='a5a059aa63392e571341bddc5148a5db66643722e9a6bf16a9395fb690a80288931d5a1180a85a28eb9f6516cf61dfc1bf4e37898f3a35261cd2db88888d3815',this['apiUrl']=_0x3e8bb4(0xf8),console[_0x3e8bb4(0xd1)]('üá¶üá≤\x20AmPay\x20service\x20initialized\x20with\x20Open\x20Banking\x20AM\x20processing');}[a44_0x297d8b(0x15d)](_0x2f57e3){const _0x3d7a50=a44_0x297d8b,_0xf21ae7={'AD':_0x3d7a50(0x10c),'AL':_0x3d7a50(0x14e),'AT':_0x3d7a50(0xfc),'BA':'BIH','BE':_0x3d7a50(0x151),'BG':_0x3d7a50(0x10a),'BY':_0x3d7a50(0xdf),'CH':_0x3d7a50(0xd0),'CY':_0x3d7a50(0xfb),'CZ':_0x3d7a50(0xf9),'DE':_0x3d7a50(0x116),'DK':'DNK','EE':_0x3d7a50(0x16b),'ES':'ESP','FI':_0x3d7a50(0xf1),'FR':'FRA','GB':_0x3d7a50(0x106),'GE':_0x3d7a50(0xf0),'GR':'GRC','HR':_0x3d7a50(0x12b),'HU':'HUN','IE':_0x3d7a50(0x153),'IS':_0x3d7a50(0xf4),'IT':_0x3d7a50(0x150),'LI':_0x3d7a50(0x169),'LT':'LTU','LU':_0x3d7a50(0x147),'LV':_0x3d7a50(0x162),'MC':_0x3d7a50(0xd2),'MD':'MDA','ME':'MNE','MK':'MKD','MT':_0x3d7a50(0xda),'NL':'NLD','NO':_0x3d7a50(0x13b),'PL':_0x3d7a50(0xe9),'PT':'PRT','RO':_0x3d7a50(0xfe),'RS':_0x3d7a50(0x125),'RU':_0x3d7a50(0x128),'SE':'SWE','SI':'SVN','SK':_0x3d7a50(0xd6),'SM':'SMR','UA':_0x3d7a50(0x10d),'VA':'VAT','XK':_0x3d7a50(0x105),'AM':_0x3d7a50(0xeb),'AZ':'AZE','KZ':_0x3d7a50(0x118),'KG':_0x3d7a50(0x127),'TJ':_0x3d7a50(0x113),'TM':_0x3d7a50(0x16d),'UZ':_0x3d7a50(0x158),'US':_0x3d7a50(0x10e),'CA':'CAN','AU':_0x3d7a50(0x117),'JP':'JPN','CN':_0x3d7a50(0x132),'IN':_0x3d7a50(0x102),'BR':_0x3d7a50(0xe7),'MX':_0x3d7a50(0xe4),'AR':_0x3d7a50(0x126),'CL':'CHL','PE':'PER','CO':'COL','VE':_0x3d7a50(0x157),'EC':'ECU','BO':_0x3d7a50(0xf7),'PY':_0x3d7a50(0xff),'UY':'URY','SR':_0x3d7a50(0xf3),'GY':_0x3d7a50(0x13e),'FK':_0x3d7a50(0x15c),'ZA':_0x3d7a50(0xdc),'EG':'EGY','NG':_0x3d7a50(0x142),'KE':_0x3d7a50(0xd3),'GH':_0x3d7a50(0x15b),'TZ':_0x3d7a50(0xe8),'UG':_0x3d7a50(0x107),'ZW':_0x3d7a50(0xd8),'ZM':_0x3d7a50(0x122),'MW':_0x3d7a50(0xe2),'MZ':_0x3d7a50(0x123),'MG':_0x3d7a50(0x144),'MU':_0x3d7a50(0xec),'SC':'SYC','RE':_0x3d7a50(0x11c),'TR':_0x3d7a50(0x136),'IR':_0x3d7a50(0x146),'IQ':_0x3d7a50(0x152),'SA':_0x3d7a50(0x101),'AE':'ARE','KW':_0x3d7a50(0x12f),'QA':_0x3d7a50(0x156),'BH':'BHR','OM':_0x3d7a50(0x159),'YE':_0x3d7a50(0x163),'JO':_0x3d7a50(0xf2),'LB':_0x3d7a50(0x15e),'SY':_0x3d7a50(0x110),'IL':'ISR','PS':_0x3d7a50(0x119),'KR':_0x3d7a50(0x121),'KP':_0x3d7a50(0x16c),'TH':_0x3d7a50(0xcf),'VN':'VNM','MY':'MYS','SG':_0x3d7a50(0x137),'ID':_0x3d7a50(0x14f),'PH':_0x3d7a50(0x139),'LA':_0x3d7a50(0x16a),'KH':_0x3d7a50(0x12e),'MM':_0x3d7a50(0xed),'BD':_0x3d7a50(0xea),'LK':_0x3d7a50(0xcd),'NP':_0x3d7a50(0x13f),'BT':'BTN','MV':_0x3d7a50(0x160),'AF':_0x3d7a50(0x13a),'PK':'PAK','MN':_0x3d7a50(0x134)},_0x2237d0=_0xf21ae7[_0x2f57e3[_0x3d7a50(0x133)]()];if(!_0x2237d0)return console[_0x3d7a50(0x12d)](_0x3d7a50(0x14c)+_0x2f57e3+_0x3d7a50(0xde)),_0x3d7a50(0x128);return _0x2237d0;}async[a44_0x297d8b(0x103)](_0x1d4677){const _0x15a71f=a44_0x297d8b;try{const {orderId:_0x1b586e,amount:_0x5e3b45,currency:_0x49f60a,firstName:_0x40e98c,lastName:_0x1d162a,email:_0x1cad62,customerIp:_0x120d58,customerCountry:_0x2f0e83,successUrl:_0xabcb03,failureUrl:_0x2e5e75}=_0x1d4677;console[_0x15a71f(0xd1)]('üá¶üá≤\x20Creating\x20AmPay\x20payment\x20link...'),console[_0x15a71f(0xd1)](_0x15a71f(0xee),_0x1b586e),console[_0x15a71f(0xd1)](_0x15a71f(0x114),_0x5e3b45,_0x49f60a),console[_0x15a71f(0xd1)](_0x15a71f(0x10b),_0x40e98c+'\x20'+_0x1d162a),console['log']('Email:',_0x1cad62),console[_0x15a71f(0xd1)]('Customer\x20IP:',_0x120d58),console[_0x15a71f(0xd1)](_0x15a71f(0x14d),_0x2f0e83);const _0x4c205c=this[_0x15a71f(0x15d)](_0x2f0e83);console[_0x15a71f(0xd1)](_0x15a71f(0x167),_0x4c205c);const _0x158c71={'sub_method':_0x15a71f(0x161),'currency':_0x49f60a[_0x15a71f(0x133)](),'amount':_0x5e3b45,'callback_url':_0x15a71f(0x145),'client_merchant_id':this[_0x15a71f(0x135)],'client_transaction_id':_0x1b586e,'transaction_description':_0x1b586e,'customer':{'ip':_0x120d58,'email':_0x1cad62,'full_name':_0x40e98c+'\x20'+_0x1d162a,'country':_0x4c205c},'success_redirect_url':_0xabcb03,'error_redirect_url':_0x2e5e75};console['log']('üì§\x20AmPay\x20request\x20body:',JSON[_0x15a71f(0xe3)](_0x158c71,null,0x2));const _0x2d5128=await fetch(this[_0x15a71f(0x13d)]+_0x15a71f(0x16e),{'method':_0x15a71f(0xd7),'headers':{'Content-Type':'application/json','User-Agent':_0x15a71f(0x12a)},'body':JSON[_0x15a71f(0xe3)](_0x158c71)}),_0xbffd9c=await _0x2d5128[_0x15a71f(0x100)]();console[_0x15a71f(0xd1)](_0x15a71f(0xd9),_0xbffd9c);if(!_0x2d5128['ok'])throw new Error(_0x15a71f(0x109)+_0x2d5128[_0x15a71f(0xef)]+_0x15a71f(0x166)+_0xbffd9c);let _0x3cc5b0;try{_0x3cc5b0=JSON[_0x15a71f(0x141)](_0xbffd9c);}catch(_0x55b613){throw new Error(_0x15a71f(0x154)+_0xbffd9c);}console[_0x15a71f(0xd1)](_0x15a71f(0x168),JSON[_0x15a71f(0xe3)](_0x3cc5b0,null,0x2));if(!_0x3cc5b0['redirect_url'])throw new Error(_0x15a71f(0x14b)+(_0x3cc5b0[_0x15a71f(0xe5)]||_0x3cc5b0[_0x15a71f(0x10f)]||'Unknown\x20error'));const _0x2fbd76=_0x3cc5b0[_0x15a71f(0x11f)],_0x18c614=_0x3cc5b0['system_id'],_0x3193d1=_0x3cc5b0[_0x15a71f(0xe0)];return console['log'](_0x15a71f(0x138)),console[_0x15a71f(0xd1)]('Payment\x20URL:',_0x2fbd76),console[_0x15a71f(0xd1)](_0x15a71f(0x120),_0x18c614),console[_0x15a71f(0xd1)](_0x15a71f(0xd5),_0x3193d1),console['log'](_0x15a71f(0xfd),_0x3cc5b0[_0x15a71f(0xef)]),console['log'](_0x15a71f(0x115)),{'gateway_payment_id':_0x18c614||_0x3193d1||_0x1b586e,'payment_url':_0x2fbd76||'','transaction_id':_0x18c614};}catch(_0x6a8931){console['error'](_0x15a71f(0x111),_0x6a8931),console[_0x15a71f(0xd1)](_0x15a71f(0x15f));throw _0x6a8931;}}async['healthCheck'](){const _0x45150a=a44_0x297d8b;try{const _0x4604af=await fetch(this[_0x45150a(0x13d)]+'health.php',{'method':_0x45150a(0xdd),'headers':{'Content-Type':_0x45150a(0x140),'User-Agent':_0x45150a(0x12a)}});return _0x4604af&&_0x4604af[_0x45150a(0xef)]===0xc8?!![]:![];}catch(_0x55df7f){return console[_0x45150a(0xcc)]('‚ùå\x20AmPay\x20health\x20check\x20failed:',_0x55df7f),![];}}async[a44_0x297d8b(0x11b)](_0x513e39){const _0x4a715a=a44_0x297d8b;console[_0x4a715a(0xd1)]('===\x20Processing\x20AmPay\x20webhook\x20==='),console[_0x4a715a(0xd1)](_0x4a715a(0xfa)),console[_0x4a715a(0xd1)](_0x4a715a(0x11e),_0x513e39),console['log'](_0x4a715a(0x13c),typeof _0x513e39),console['log']('Available\x20fields:');_0x513e39&&typeof _0x513e39===_0x4a715a(0xf5)&&Object[_0x4a715a(0xe1)](_0x513e39)[_0x4a715a(0x124)](_0x2e0aa3=>{const _0x5b67ee=_0x4a715a;console[_0x5b67ee(0xd1)]('\x20\x20'+_0x2e0aa3+':\x20'+_0x513e39[_0x2e0aa3]+'\x20('+typeof _0x513e39[_0x2e0aa3]+')');});let _0x242abc=_0x4a715a(0xe6);const _0x173e10=_0x513e39[_0x4a715a(0x108)]||_0x513e39[_0x4a715a(0x165)]||_0x513e39[_0x4a715a(0xe0)]||'';return console['log'](_0x4a715a(0x112)+_0x173e10),console[_0x4a715a(0xd1)](_0x4a715a(0xce)+_0x242abc),!_0x173e10&&(console[_0x4a715a(0xcc)](_0x4a715a(0x129)),console[_0x4a715a(0xcc)](_0x4a715a(0xdb))),{'paymentId':_0x173e10,'status':_0x242abc,'amount':_0x513e39['amount'],'currency':_0x513e39['currency']};}}exports[a44_0x297d8b(0x104)]=AmPayService,exports['ampayService']=new AmPayService();