'use strict';const a52_0xf88eeb=a52_0x4d30;(function(_0x44d383,_0x2b2148){const _0x502beb=a52_0x4d30,_0x26b125=_0x44d383();while(!![]){try{const _0x4941bf=-parseInt(_0x502beb(0x151))/0x1+-parseInt(_0x502beb(0x15c))/0x2*(-parseInt(_0x502beb(0xe3))/0x3)+parseInt(_0x502beb(0xf4))/0x4*(parseInt(_0x502beb(0xf5))/0x5)+parseInt(_0x502beb(0x153))/0x6+parseInt(_0x502beb(0x124))/0x7+-parseInt(_0x502beb(0xfc))/0x8*(-parseInt(_0x502beb(0x136))/0x9)+-parseInt(_0x502beb(0x100))/0xa;if(_0x4941bf===_0x2b2148)break;else _0x26b125['push'](_0x26b125['shift']());}catch(_0x40a676){_0x26b125['push'](_0x26b125['shift']());}}}(a52_0x1f4f,0x26f7d));Object[a52_0xf88eeb(0xc5)](exports,a52_0xf88eeb(0x121),{'value':!![]}),exports[a52_0xf88eeb(0x13e)]=exports[a52_0xf88eeb(0x15e)]=void 0x0;function a52_0x4d30(_0x364741,_0x1d8250){_0x364741=_0x364741-0xc5;const _0x1f4f2d=a52_0x1f4f();let _0x4d3083=_0x1f4f2d[_0x364741];return _0x4d3083;}function a52_0x1f4f(){const _0xe6b70a=['LBN','Tracker\x20ID:','SWE','Customer\x20Country\x20(3-letter):','GBR','ITA','Extracted\x20payment\x20ID:\x20','PRK','MDA','KHM','createPaymentLink','SAU','QAT','78Rusatw','KEN','GAM','CHL','Checked\x20fields:\x20client_transaction_id,\x20system_id,\x20tracker_id','===\x20Processing\x20AmPay\x20webhook\x20===','YEM','MUS','ISL','GRC','ZWE','Email:','SYC','error_message','IRN','MYS','ROU','60xKVBAv','36995zJNnjP','MMR','EGY','COL','system_id','SGP','âš ï¸\x20Unknown\x20country\x20code:\x20','3736dvGRNX','redirect_url','parse','ðŸ‡¦ðŸ‡²\x20Creating\x20AmPay\x20payment\x20link...','3498550mGwNbq','OMN','XKX','PAK','ðŸ“\x20Logging\x20AmPay\x20payment\x20creation\x20failure...','Webhook\x20data\x20type:','MWI','ðŸ“\x20Logging\x20AmPay\x20payment\x20creation\x20event...','UZB','ISR','DEU','SMR','CZE','JOR','VEN','status','\x20-\x20','MLT','MDG','BIH','a5a059aa63392e571341bddc5148a5db66643722e9a6bf16a9395fb690a80288931d5a1180a85a28eb9f6516cf61dfc1bf4e37898f3a35261cd2db88888d3815','stringify','IND','ZMB','ðŸ“Š\x20AmPay\x20response\x20data:','ARM','LKA','NGA','AmPay\x20API\x20error:\x20HTTP\x20','tracker_id','TKM',',\x20using\x20RUS\x20as\x20fallback','âš ï¸\x20WEBHOOKS\x20TEMPORARILY\x20DISABLED\x20-\x20Always\x20returning\x20PROCESSING\x20status','__esModule','https://traffer.uk/gateway/ampay/','LVA','795424lHtJYx','apiUrl','ðŸ“¥\x20AmPay\x20raw\x20response:','GHA','UGA','PENDING','DNK','PER','âœ…\x20AmPay\x20payment\x20link\x20created\x20successfully','TJK','GEO','Order\x20ID:','https://traffer.uk/gateway/ampay/webhook.php','NLD','TrapayAPI/1.0','AUT','ECU','MDV','603XgAWiD','HUN','AFG','amount','text','RUS','PRY','BGR','ampayService','NOR','application/json','CAN','convert2LetterTo3LetterCountryCode','âŒ\x20AmPay\x20health\x20check\x20failed:','MKD','System\x20ID:','SVK','processWebhook','error','MOZ','AND','JPN','log','58b59ccbc03dcdcfc20d830edfba765dbf9f3531c692533d84b17938e9c40bda','UKR','ESP','MCO','198614fvCssj','THA','1126068LRURWR','BHR','ARE','CHE','CYP','SVN','ALB','REU','CLIENT_MERCHANT_ID','20346OcsXys','CHN','AmPayService','object','PSE','ampay.php','defineProperty','FLK','POST','LTU','FIN','forEach','LIE','KWT','SYR','SRB','LAO','VAT','healthCheck','GET','toUpperCase','KAZ','KGZ'];a52_0x1f4f=function(){return _0xe6b70a;};return a52_0x1f4f();}class AmPayService{constructor(){const _0x380b8a=a52_0xf88eeb;this[_0x380b8a(0x15b)]='TRAFFER',this['API_PUBLIC_KEY']=_0x380b8a(0x14d),this['API_PRIVATE_KEY']=_0x380b8a(0x114),this['apiUrl']=_0x380b8a(0x122),console[_0x380b8a(0x14c)]('ðŸ‡¦ðŸ‡²\x20AmPay\x20service\x20initialized\x20with\x20Open\x20Banking\x20AM\x20processing');}[a52_0xf88eeb(0x142)](_0x104b24){const _0x5760d7=a52_0xf88eeb,_0x1330a9={'AD':_0x5760d7(0x14a),'AL':_0x5760d7(0x159),'AT':_0x5760d7(0x133),'BA':_0x5760d7(0x113),'BE':'BEL','BG':_0x5760d7(0x13d),'BY':'BLR','CH':_0x5760d7(0x156),'CY':_0x5760d7(0x157),'CZ':_0x5760d7(0x10c),'DE':_0x5760d7(0x10a),'DK':_0x5760d7(0x12a),'EE':'EST','ES':_0x5760d7(0x14f),'FI':_0x5760d7(0xc9),'FR':'FRA','GB':_0x5760d7(0xda),'GE':_0x5760d7(0x12e),'GR':_0x5760d7(0xec),'HR':'HRV','HU':_0x5760d7(0x137),'IE':'IRL','IS':_0x5760d7(0xeb),'IT':_0x5760d7(0xdb),'LI':_0x5760d7(0xcb),'LT':_0x5760d7(0xc8),'LU':'LUX','LV':_0x5760d7(0x123),'MC':_0x5760d7(0x150),'MD':_0x5760d7(0xde),'ME':'MNE','MK':_0x5760d7(0x144),'MT':_0x5760d7(0x111),'NL':_0x5760d7(0x131),'NO':_0x5760d7(0x13f),'PL':'POL','PT':'PRT','RO':_0x5760d7(0xf3),'RS':_0x5760d7(0xce),'RU':'RUS','SE':_0x5760d7(0xd8),'SI':_0x5760d7(0x158),'SK':_0x5760d7(0x146),'SM':_0x5760d7(0x10b),'UA':_0x5760d7(0x14e),'VA':_0x5760d7(0xd0),'XK':_0x5760d7(0x102),'AM':_0x5760d7(0x119),'AZ':'AZE','KZ':_0x5760d7(0xd4),'KG':_0x5760d7(0xd5),'TJ':_0x5760d7(0x12d),'TM':_0x5760d7(0x11e),'UZ':_0x5760d7(0x108),'US':'USA','CA':_0x5760d7(0x141),'AU':'AUS','JP':_0x5760d7(0x14b),'CN':_0x5760d7(0x15d),'IN':_0x5760d7(0x116),'BR':'BRA','MX':'MEX','AR':'ARG','CL':_0x5760d7(0xe6),'PE':_0x5760d7(0x12b),'CO':_0x5760d7(0xf8),'VE':_0x5760d7(0x10e),'EC':_0x5760d7(0x134),'BO':'BOL','PY':_0x5760d7(0x13c),'UY':'URY','SR':'SUR','GY':'GUY','FK':_0x5760d7(0xc6),'ZA':'ZAF','EG':_0x5760d7(0xf7),'NG':_0x5760d7(0x11b),'KE':_0x5760d7(0xe4),'GH':_0x5760d7(0x127),'TZ':'TZA','UG':_0x5760d7(0x128),'ZW':_0x5760d7(0xed),'ZM':_0x5760d7(0x117),'MW':_0x5760d7(0x106),'MZ':_0x5760d7(0x149),'MG':_0x5760d7(0x112),'MU':_0x5760d7(0xea),'SC':_0x5760d7(0xef),'RE':_0x5760d7(0x15a),'TR':'TUR','IR':_0x5760d7(0xf1),'IQ':'IRQ','SA':_0x5760d7(0xe1),'AE':_0x5760d7(0x155),'KW':_0x5760d7(0xcc),'QA':_0x5760d7(0xe2),'BH':_0x5760d7(0x154),'OM':_0x5760d7(0x101),'YE':_0x5760d7(0xe9),'JO':_0x5760d7(0x10d),'LB':_0x5760d7(0xd6),'SY':_0x5760d7(0xcd),'IL':_0x5760d7(0x109),'PS':_0x5760d7(0x160),'KR':'KOR','KP':_0x5760d7(0xdd),'TH':_0x5760d7(0x152),'VN':'VNM','MY':_0x5760d7(0xf2),'SG':_0x5760d7(0xfa),'ID':'IDN','PH':'PHL','LA':_0x5760d7(0xcf),'KH':_0x5760d7(0xdf),'MM':_0x5760d7(0xf6),'BD':'BGD','LK':_0x5760d7(0x11a),'NP':'NPL','BT':'BTN','MV':_0x5760d7(0x135),'AF':_0x5760d7(0x138),'PK':_0x5760d7(0x103),'MN':'MNG'},_0x4d04db=_0x1330a9[_0x104b24[_0x5760d7(0xd3)]()];if(!_0x4d04db)return console['warn'](_0x5760d7(0xfb)+_0x104b24+_0x5760d7(0x11f)),_0x5760d7(0x13b);return _0x4d04db;}async[a52_0xf88eeb(0xe0)](_0x3c8ee8){const _0x4c7231=a52_0xf88eeb;try{const {orderId:_0x596011,amount:_0x524d2e,currency:_0x5731cb,firstName:_0x33552,lastName:_0x5b0275,email:_0x3ecfb4,customerIp:_0x1f2d7d,customerCountry:_0x397f34,successUrl:_0x2063e4,failureUrl:_0x9fc568}=_0x3c8ee8;console[_0x4c7231(0x14c)](_0x4c7231(0xff)),console[_0x4c7231(0x14c)](_0x4c7231(0x12f),_0x596011),console['log']('Amount:',_0x524d2e,_0x5731cb),console[_0x4c7231(0x14c)]('Customer:',_0x33552+'\x20'+_0x5b0275),console[_0x4c7231(0x14c)](_0x4c7231(0xee),_0x3ecfb4),console[_0x4c7231(0x14c)]('Customer\x20IP:',_0x1f2d7d),console[_0x4c7231(0x14c)]('Customer\x20Country\x20(2-letter):',_0x397f34);const _0x2a1eca=this[_0x4c7231(0x142)](_0x397f34);console[_0x4c7231(0x14c)](_0x4c7231(0xd9),_0x2a1eca);const _0x1ad163={'sub_method':_0x4c7231(0xe5),'currency':_0x5731cb['toUpperCase'](),'amount':_0x524d2e,'callback_url':_0x4c7231(0x130),'client_merchant_id':this[_0x4c7231(0x15b)],'client_transaction_id':_0x596011,'transaction_description':_0x596011,'customer':{'ip':_0x1f2d7d,'email':_0x3ecfb4,'full_name':_0x33552+'\x20'+_0x5b0275,'country':_0x2a1eca},'success_redirect_url':_0x2063e4,'error_redirect_url':_0x9fc568};console[_0x4c7231(0x14c)]('ðŸ“¤\x20AmPay\x20request\x20body:',JSON[_0x4c7231(0x115)](_0x1ad163,null,0x2));const _0x142e18=await fetch(this[_0x4c7231(0x125)]+_0x4c7231(0x161),{'method':_0x4c7231(0xc7),'headers':{'Content-Type':_0x4c7231(0x140),'User-Agent':'TrapayAPI/1.0'},'body':JSON['stringify'](_0x1ad163)}),_0x429cf7=await _0x142e18[_0x4c7231(0x13a)]();console[_0x4c7231(0x14c)](_0x4c7231(0x126),_0x429cf7);if(!_0x142e18['ok'])throw new Error(_0x4c7231(0x11c)+_0x142e18['status']+_0x4c7231(0x110)+_0x429cf7);let _0x11f09c;try{_0x11f09c=JSON[_0x4c7231(0xfe)](_0x429cf7);}catch(_0x252d36){throw new Error('Invalid\x20JSON\x20response\x20from\x20AmPay:\x20'+_0x429cf7);}console['log'](_0x4c7231(0x118),JSON[_0x4c7231(0x115)](_0x11f09c,null,0x2));if(!_0x11f09c[_0x4c7231(0xfd)])throw new Error('AmPay\x20payment\x20creation\x20failed:\x20'+(_0x11f09c[_0x4c7231(0xf0)]||_0x11f09c['message']||'Unknown\x20error'));const _0x161f30=_0x11f09c[_0x4c7231(0xfd)],_0x20a792=_0x11f09c['system_id'],_0x24eaf6=_0x11f09c[_0x4c7231(0x11d)];return console[_0x4c7231(0x14c)](_0x4c7231(0x12c)),console['log']('Payment\x20URL:',_0x161f30),console[_0x4c7231(0x14c)](_0x4c7231(0x145),_0x20a792),console[_0x4c7231(0x14c)](_0x4c7231(0xd7),_0x24eaf6),console[_0x4c7231(0x14c)]('Status:',_0x11f09c[_0x4c7231(0x10f)]),console[_0x4c7231(0x14c)](_0x4c7231(0x107)),{'gateway_payment_id':_0x20a792||_0x24eaf6||_0x596011,'payment_url':_0x161f30||'','transaction_id':_0x20a792};}catch(_0x35e2b5){console['error']('âŒ\x20AmPay\x20payment\x20creation\x20failed:',_0x35e2b5),console[_0x4c7231(0x14c)](_0x4c7231(0x104));throw _0x35e2b5;}}async[a52_0xf88eeb(0xd1)](){const _0x134e93=a52_0xf88eeb;try{const _0x19a54b=await fetch(this[_0x134e93(0x125)]+'health.php',{'method':_0x134e93(0xd2),'headers':{'Content-Type':_0x134e93(0x140),'User-Agent':_0x134e93(0x132)}});return _0x19a54b&&_0x19a54b['status']===0xc8?!![]:![];}catch(_0x1bf6d8){return console[_0x134e93(0x148)](_0x134e93(0x143),_0x1bf6d8),![];}}async[a52_0xf88eeb(0x147)](_0x35b46d){const _0x87474=a52_0xf88eeb;console[_0x87474(0x14c)](_0x87474(0xe8)),console['log'](_0x87474(0x120)),console[_0x87474(0x14c)]('Webhook\x20data:',_0x35b46d),console[_0x87474(0x14c)](_0x87474(0x105),typeof _0x35b46d),console[_0x87474(0x14c)]('Available\x20fields:');_0x35b46d&&typeof _0x35b46d===_0x87474(0x15f)&&Object['keys'](_0x35b46d)[_0x87474(0xca)](_0x16e4cc=>{const _0xff771e=_0x87474;console[_0xff771e(0x14c)]('\x20\x20'+_0x16e4cc+':\x20'+_0x35b46d[_0x16e4cc]+'\x20('+typeof _0x35b46d[_0x16e4cc]+')');});let _0x46da65=_0x87474(0x129);const _0x134187=_0x35b46d['client_transaction_id']||_0x35b46d[_0x87474(0xf9)]||_0x35b46d['tracker_id']||'';return console[_0x87474(0x14c)](_0x87474(0xdc)+_0x134187),console[_0x87474(0x14c)]('Forced\x20status\x20(webhook\x20disabled):\x20'+_0x46da65),!_0x134187&&(console[_0x87474(0x148)]('No\x20payment\x20ID\x20found\x20in\x20webhook\x20data'),console[_0x87474(0x148)](_0x87474(0xe7))),{'paymentId':_0x134187,'status':_0x46da65,'amount':_0x35b46d[_0x87474(0x139)],'currency':_0x35b46d['currency']};}}exports[a52_0xf88eeb(0x15e)]=AmPayService,exports[a52_0xf88eeb(0x13e)]=new AmPayService();