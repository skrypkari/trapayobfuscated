'use strict';const a42_0x51d4a6=a42_0x16aa;function a42_0x16aa(_0x3f1086,_0x219ebd){const _0x5e8829=a42_0x5e88();return a42_0x16aa=function(_0x16aae4,_0x44bf7d){_0x16aae4=_0x16aae4-0x177;let _0x270225=_0x5e8829[_0x16aae4];return _0x270225;},a42_0x16aa(_0x3f1086,_0x219ebd);}(function(_0x3e0428,_0x28f87a){const _0x173503=a42_0x16aa,_0xdceae0=_0x3e0428();while(!![]){try{const _0x487ead=parseInt(_0x173503(0x1ef))/0x1*(parseInt(_0x173503(0x1f5))/0x2)+parseInt(_0x173503(0x178))/0x3+parseInt(_0x173503(0x191))/0x4*(-parseInt(_0x173503(0x1e9))/0x5)+parseInt(_0x173503(0x17f))/0x6+-parseInt(_0x173503(0x1bf))/0x7*(parseInt(_0x173503(0x1b9))/0x8)+-parseInt(_0x173503(0x19d))/0x9+parseInt(_0x173503(0x1f1))/0xa;if(_0x487ead===_0x28f87a)break;else _0xdceae0['push'](_0xdceae0['shift']());}catch(_0x303e59){_0xdceae0['push'](_0xdceae0['shift']());}}}(a42_0x5e88,0x56358));Object['defineProperty'](exports,a42_0x51d4a6(0x216),{'value':!![]}),exports['ampayService']=exports[a42_0x51d4a6(0x177)]=void 0x0;class AmPayService{constructor(){const _0x466ef3=a42_0x51d4a6;this[_0x466ef3(0x1ab)]=_0x466ef3(0x1f2),this['API_PUBLIC_KEY']=_0x466ef3(0x1a1),this[_0x466ef3(0x1de)]=_0x466ef3(0x21a),this[_0x466ef3(0x1e3)]='https://traffer.uk/gateway/ampay/',console[_0x466ef3(0x184)](_0x466ef3(0x217));}['convert2LetterTo3LetterCountryCode'](_0x32b1e6){const _0x7409b2=a42_0x51d4a6,_0x370323={'AD':_0x7409b2(0x208),'AL':_0x7409b2(0x183),'AT':'AUT','BA':_0x7409b2(0x1df),'BE':_0x7409b2(0x1e5),'BG':_0x7409b2(0x1b0),'BY':_0x7409b2(0x182),'CH':_0x7409b2(0x1e0),'CY':_0x7409b2(0x1fe),'CZ':_0x7409b2(0x187),'DE':'DEU','DK':_0x7409b2(0x18c),'EE':'EST','ES':_0x7409b2(0x1bb),'FI':'FIN','FR':_0x7409b2(0x20e),'GB':_0x7409b2(0x1b1),'GE':_0x7409b2(0x19b),'GR':_0x7409b2(0x1fd),'HR':_0x7409b2(0x201),'HU':_0x7409b2(0x1dc),'IE':'IRL','IS':'ISL','IT':_0x7409b2(0x1a0),'LI':_0x7409b2(0x20c),'LT':_0x7409b2(0x212),'LU':_0x7409b2(0x1dd),'LV':'LVA','MC':_0x7409b2(0x1cc),'MD':_0x7409b2(0x1c9),'ME':_0x7409b2(0x205),'MK':'MKD','MT':'MLT','NL':_0x7409b2(0x1b4),'NO':'NOR','PL':_0x7409b2(0x1f4),'PT':_0x7409b2(0x1ad),'RO':_0x7409b2(0x1b3),'RS':_0x7409b2(0x1a2),'RU':_0x7409b2(0x1aa),'SE':_0x7409b2(0x181),'SI':_0x7409b2(0x18b),'SK':'SVK','SM':'SMR','UA':_0x7409b2(0x186),'VA':_0x7409b2(0x1c4),'XK':_0x7409b2(0x188),'AM':'ARM','AZ':_0x7409b2(0x1d9),'KZ':_0x7409b2(0x1d5),'KG':'KGZ','TJ':'TJK','TM':_0x7409b2(0x200),'UZ':_0x7409b2(0x1ec),'US':_0x7409b2(0x1b6),'CA':_0x7409b2(0x1ed),'AU':_0x7409b2(0x1fc),'JP':_0x7409b2(0x1bc),'CN':_0x7409b2(0x1bd),'IN':_0x7409b2(0x21b),'BR':_0x7409b2(0x185),'MX':'MEX','AR':_0x7409b2(0x211),'CL':_0x7409b2(0x1d4),'PE':'PER','CO':'COL','VE':_0x7409b2(0x196),'EC':_0x7409b2(0x189),'BO':'BOL','PY':_0x7409b2(0x1e4),'UY':'URY','SR':_0x7409b2(0x194),'GY':_0x7409b2(0x1db),'FK':_0x7409b2(0x1a4),'ZA':_0x7409b2(0x1d2),'EG':_0x7409b2(0x20a),'NG':_0x7409b2(0x1d1),'KE':_0x7409b2(0x199),'GH':_0x7409b2(0x1da),'TZ':_0x7409b2(0x1ae),'UG':_0x7409b2(0x1a6),'ZW':'ZWE','ZM':'ZMB','MW':_0x7409b2(0x17b),'MZ':_0x7409b2(0x198),'MG':_0x7409b2(0x1af),'MU':_0x7409b2(0x1a3),'SC':_0x7409b2(0x1ce),'RE':_0x7409b2(0x1f6),'TR':_0x7409b2(0x1cb),'IR':_0x7409b2(0x202),'IQ':'IRQ','SA':_0x7409b2(0x1a8),'AE':_0x7409b2(0x195),'KW':'KWT','QA':_0x7409b2(0x1f0),'BH':_0x7409b2(0x180),'OM':_0x7409b2(0x1b2),'YE':_0x7409b2(0x1f7),'JO':_0x7409b2(0x18a),'LB':'LBN','SY':'SYR','IL':'ISR','PS':_0x7409b2(0x1d3),'KR':'KOR','KP':_0x7409b2(0x190),'TH':_0x7409b2(0x1e2),'VN':'VNM','MY':_0x7409b2(0x1d7),'SG':'SGP','ID':_0x7409b2(0x1cf),'PH':'PHL','LA':_0x7409b2(0x21d),'KH':_0x7409b2(0x1a5),'MM':_0x7409b2(0x1c1),'BD':_0x7409b2(0x210),'LK':'LKA','NP':_0x7409b2(0x18e),'BT':'BTN','MV':_0x7409b2(0x1ba),'AF':_0x7409b2(0x19e),'PK':_0x7409b2(0x1f8),'MN':_0x7409b2(0x179)},_0x50bdaa=_0x370323[_0x32b1e6[_0x7409b2(0x21c)]()];if(!_0x50bdaa)return console[_0x7409b2(0x19a)](_0x7409b2(0x209)+_0x32b1e6+_0x7409b2(0x1d8)),_0x7409b2(0x1aa);return _0x50bdaa;}async[a42_0x51d4a6(0x207)](_0x4b7e57){const _0x1d4727=a42_0x51d4a6;try{const {orderId:_0x46439a,amount:_0x2e5722,currency:_0x285ceb,firstName:_0x20050b,lastName:_0x33b58b,email:_0x557720,customerIp:_0x415945,customerCountry:_0x17388b,successUrl:_0x5c0f08,failureUrl:_0x3c5306}=_0x4b7e57;console['log'](_0x1d4727(0x218)),console['log'](_0x1d4727(0x20d),_0x46439a),console[_0x1d4727(0x184)](_0x1d4727(0x203),_0x2e5722,_0x285ceb),console['log'](_0x1d4727(0x1c6),_0x20050b+'\x20'+_0x33b58b),console['log'](_0x1d4727(0x1ee),_0x557720),console[_0x1d4727(0x184)](_0x1d4727(0x1a7),_0x415945),console[_0x1d4727(0x184)](_0x1d4727(0x1ff),_0x17388b);const _0x42aa4d=this['convert2LetterTo3LetterCountryCode'](_0x17388b);console[_0x1d4727(0x184)]('Customer\x20Country\x20(3-letter):',_0x42aa4d);const _0x10b052={'sub_method':_0x1d4727(0x1fb),'currency':_0x285ceb[_0x1d4727(0x21c)](),'amount':_0x2e5722,'callback_url':'https://api.trapay.uk/api/webhooks/gateway/ampay','client_merchant_id':this[_0x1d4727(0x1ab)],'client_transaction_id':_0x46439a,'transaction_description':_0x46439a,'customer':{'ip':_0x415945,'email':_0x557720,'full_name':_0x20050b+'\x20'+_0x33b58b,'country':_0x42aa4d},'success_redirect_url':_0x5c0f08,'error_redirect_url':_0x3c5306};console[_0x1d4727(0x184)](_0x1d4727(0x213),JSON['stringify'](_0x10b052,null,0x2));const _0x403df7=await fetch(this[_0x1d4727(0x1e3)]+_0x1d4727(0x1c5),{'method':_0x1d4727(0x20f),'headers':{'Content-Type':_0x1d4727(0x1e7),'User-Agent':'TrapayAPI/1.0'},'body':JSON[_0x1d4727(0x17d)](_0x10b052)}),_0x41f8a4=await _0x403df7[_0x1d4727(0x19c)]();console[_0x1d4727(0x184)](_0x1d4727(0x1c0),_0x41f8a4);if(!_0x403df7['ok'])throw new Error(_0x1d4727(0x1f9)+_0x403df7[_0x1d4727(0x17e)]+_0x1d4727(0x214)+_0x41f8a4);let _0x443227;try{_0x443227=JSON['parse'](_0x41f8a4);}catch(_0x1751eb){throw new Error('Invalid\x20JSON\x20response\x20from\x20AmPay:\x20'+_0x41f8a4);}console[_0x1d4727(0x184)](_0x1d4727(0x18f),JSON[_0x1d4727(0x17d)](_0x443227,null,0x2));if(!_0x443227[_0x1d4727(0x1d0)])throw new Error(_0x1d4727(0x1cd)+(_0x443227[_0x1d4727(0x1ac)]||_0x443227['message']||_0x1d4727(0x1c2)));const _0x2f7e88=_0x443227['redirect_url'],_0x47a62a=_0x443227[_0x1d4727(0x219)],_0xfbd540=_0x443227[_0x1d4727(0x1e1)];return console[_0x1d4727(0x184)](_0x1d4727(0x1e6)),console[_0x1d4727(0x184)](_0x1d4727(0x1a9),_0x2f7e88),console['log'](_0x1d4727(0x17a),_0x47a62a),console[_0x1d4727(0x184)](_0x1d4727(0x1e8),_0xfbd540),console['log'](_0x1d4727(0x1b7),_0x443227[_0x1d4727(0x17e)]),console[_0x1d4727(0x184)](_0x1d4727(0x17c)),{'gateway_payment_id':_0x47a62a||_0xfbd540||_0x46439a,'payment_url':_0x2f7e88||'','transaction_id':_0x47a62a};}catch(_0x4f5c23){console[_0x1d4727(0x1ca)](_0x1d4727(0x215),_0x4f5c23),console[_0x1d4727(0x184)](_0x1d4727(0x18d));throw _0x4f5c23;}}async[a42_0x51d4a6(0x1c7)](){const _0x3fc604=a42_0x51d4a6;try{const _0x55c6d2=await fetch(this[_0x3fc604(0x1e3)]+'health.php',{'method':'GET','headers':{'Content-Type':_0x3fc604(0x1e7),'User-Agent':'TrapayAPI/1.0'}});return _0x55c6d2&&_0x55c6d2[_0x3fc604(0x17e)]===0xc8?!![]:![];}catch(_0x363d27){return console[_0x3fc604(0x1ca)]('‚ùå\x20AmPay\x20health\x20check\x20failed:',_0x363d27),![];}}async[a42_0x51d4a6(0x1c3)](_0x11b5cd){const _0x4c5d21=a42_0x51d4a6;console[_0x4c5d21(0x184)](_0x4c5d21(0x1f3)),console[_0x4c5d21(0x184)](_0x4c5d21(0x1be)),console[_0x4c5d21(0x184)](_0x4c5d21(0x1d6),_0x11b5cd),console[_0x4c5d21(0x184)]('Webhook\x20data\x20type:',typeof _0x11b5cd),console[_0x4c5d21(0x184)](_0x4c5d21(0x1ea));_0x11b5cd&&typeof _0x11b5cd===_0x4c5d21(0x204)&&Object[_0x4c5d21(0x20b)](_0x11b5cd)[_0x4c5d21(0x206)](_0x6bd572=>{const _0x1d50ac=_0x4c5d21;console[_0x1d50ac(0x184)]('\x20\x20'+_0x6bd572+':\x20'+_0x11b5cd[_0x6bd572]+'\x20('+typeof _0x11b5cd[_0x6bd572]+')');});let _0x53ebfa=_0x4c5d21(0x197);const _0x2ec27d=_0x11b5cd[_0x4c5d21(0x1b5)]||_0x11b5cd[_0x4c5d21(0x219)]||_0x11b5cd[_0x4c5d21(0x1e1)]||'';return console[_0x4c5d21(0x184)](_0x4c5d21(0x1eb)+_0x2ec27d),console[_0x4c5d21(0x184)](_0x4c5d21(0x1fa)+_0x53ebfa),!_0x2ec27d&&(console[_0x4c5d21(0x1ca)](_0x4c5d21(0x1c8)),console[_0x4c5d21(0x1ca)](_0x4c5d21(0x193))),{'paymentId':_0x2ec27d,'status':_0x53ebfa,'amount':_0x11b5cd[_0x4c5d21(0x19f)],'currency':_0x11b5cd[_0x4c5d21(0x192)]};}}function a42_0x5e88(){const _0x1af809=['üìä\x20AmPay\x20response\x20data:','PRK','4yFRIAh','currency','Checked\x20fields:\x20client_transaction_id,\x20system_id,\x20tracker_id','SUR','ARE','VEN','PENDING','MOZ','KEN','warn','GEO','text','1606959UGIjKK','AFG','amount','ITA','58b59ccbc03dcdcfc20d830edfba765dbf9f3531c692533d84b17938e9c40bda','SRB','MUS','FLK','KHM','UGA','Customer\x20IP:','SAU','Payment\x20URL:','RUS','CLIENT_MERCHANT_ID','error_message','PRT','TZA','MDG','BGR','GBR','OMN','ROU','NLD','client_transaction_id','USA','Status:','ampayService','8JYbIZB','MDV','ESP','JPN','CHN','‚ö†Ô∏è\x20WEBHOOKS\x20TEMPORARILY\x20DISABLED\x20-\x20Always\x20returning\x20PROCESSING\x20status','3762374uzzYws','üì•\x20AmPay\x20raw\x20response:','MMR','Unknown\x20error','processWebhook','VAT','ampay.php','Customer:','healthCheck','No\x20payment\x20ID\x20found\x20in\x20webhook\x20data','MDA','error','TUR','MCO','AmPay\x20payment\x20creation\x20failed:\x20','SYC','IDN','redirect_url','NGA','ZAF','PSE','CHL','KAZ','Webhook\x20data:','MYS',',\x20using\x20RUS\x20as\x20fallback','AZE','GHA','GUY','HUN','LUX','API_PRIVATE_KEY','BIH','CHE','tracker_id','THA','apiUrl','PRY','BEL','‚úÖ\x20AmPay\x20payment\x20link\x20created\x20successfully','application/json','Tracker\x20ID:','851215eygOpV','Available\x20fields:','Extracted\x20payment\x20ID:\x20','UZB','CAN','Email:','316889waqmEH','QAT','7746360fCWPKm','TRAFFER','===\x20Processing\x20AmPay\x20webhook\x20===','POL','2SJMojc','REU','YEM','PAK','AmPay\x20API\x20error:\x20HTTP\x20','Forced\x20status\x20(webhook\x20disabled):\x20','GAM','AUS','GRC','CYP','Customer\x20Country\x20(2-letter):','TKM','HRV','IRN','Amount:','object','MNE','forEach','createPaymentLink','AND','‚ö†Ô∏è\x20Unknown\x20country\x20code:\x20','EGY','keys','LIE','Order\x20ID:','FRA','POST','BGD','ARG','LTU','üì§\x20AmPay\x20request\x20body:','\x20-\x20','‚ùå\x20AmPay\x20payment\x20creation\x20failed:','__esModule','üá¶üá≤\x20AmPay\x20service\x20initialized\x20with\x20Open\x20Banking\x20AM\x20processing','üá¶üá≤\x20Creating\x20AmPay\x20payment\x20link...','system_id','a5a059aa63392e571341bddc5148a5db66643722e9a6bf16a9395fb690a80288931d5a1180a85a28eb9f6516cf61dfc1bf4e37898f3a35261cd2db88888d3815','IND','toUpperCase','LAO','AmPayService','172446GTXcLt','MNG','System\x20ID:','MWI','üìù\x20Logging\x20AmPay\x20payment\x20creation\x20event...','stringify','status','542286hUGwJx','BHR','SWE','BLR','ALB','log','BRA','UKR','CZE','XKX','ECU','JOR','SVN','DNK','üìù\x20Logging\x20AmPay\x20payment\x20creation\x20failure...','NPL'];a42_0x5e88=function(){return _0x1af809;};return a42_0x5e88();}exports[a42_0x51d4a6(0x177)]=AmPayService,exports[a42_0x51d4a6(0x1b8)]=new AmPayService();