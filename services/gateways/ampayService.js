'use strict';const a44_0x4051e1=a44_0x2b2f;function a44_0x2b2f(_0x50c38d,_0x2149ae){const _0x4da0c9=a44_0x4da0();return a44_0x2b2f=function(_0x2b2fcc,_0x17e9fd){_0x2b2fcc=_0x2b2fcc-0x1bb;let _0x471b1f=_0x4da0c9[_0x2b2fcc];return _0x471b1f;},a44_0x2b2f(_0x50c38d,_0x2149ae);}(function(_0x355c85,_0x332eee){const _0x4cfcd8=a44_0x2b2f,_0x423732=_0x355c85();while(!![]){try{const _0x4e0358=parseInt(_0x4cfcd8(0x230))/0x1+parseInt(_0x4cfcd8(0x21f))/0x2*(parseInt(_0x4cfcd8(0x23c))/0x3)+-parseInt(_0x4cfcd8(0x1db))/0x4*(-parseInt(_0x4cfcd8(0x204))/0x5)+parseInt(_0x4cfcd8(0x205))/0x6*(-parseInt(_0x4cfcd8(0x1c6))/0x7)+parseInt(_0x4cfcd8(0x229))/0x8*(-parseInt(_0x4cfcd8(0x225))/0x9)+-parseInt(_0x4cfcd8(0x1c1))/0xa*(-parseInt(_0x4cfcd8(0x24b))/0xb)+-parseInt(_0x4cfcd8(0x21b))/0xc*(parseInt(_0x4cfcd8(0x20d))/0xd);if(_0x4e0358===_0x332eee)break;else _0x423732['push'](_0x423732['shift']());}catch(_0xb1ec1e){_0x423732['push'](_0x423732['shift']());}}}(a44_0x4da0,0xa4976));function a44_0x4da0(){const _0x1caca6=['10zKcptA','GET','IDN','TrapayAPI/1.0','CYP','6633305NSgkfm','ESP','IRQ','health.php','LUX','MWI','Customer\x20Country\x20(3-letter):','KOR','error','API_PUBLIC_KEY','NPL','üá¶üá≤\x20Creating\x20AmPay\x20payment\x20link...','ampay.php','POL','MCO','Invalid\x20JSON\x20response\x20from\x20AmPay:\x20','KWT','AUT','BGD',',\x20using\x20RUS\x20as\x20fallback','Webhook\x20data:','84lmSFky','Status:','‚ùå\x20AmPay\x20health\x20check\x20failed:','AmPayService','UZB','Webhook\x20data\x20type:','BTN','BLR','client_transaction_id','URY','No\x20payment\x20ID\x20found\x20in\x20webhook\x20data','JPN','BRA','üìù\x20Logging\x20AmPay\x20payment\x20creation\x20event...','ZWE','BIH','MMR','AFG','ARM','ISR','SMR','SRB','YEM','TUR','application/json','PHL','BEL','OMN','CHE','LBN','tracker_id','CHN','UGA','stringify','MOZ','PENDING','NLD','Email:','IRL','ALB','API_PRIVATE_KEY','92335VOPpMZ','6ZHIXCf','EGY','TKM','NOR','ECU','FRA','ROU','Extracted\x20payment\x20ID:\x20','199563AzStJQ','SYC','message','SYR','RUS','ISL','EST','AUS','convert2LetterTo3LetterCountryCode','AmPay\x20API\x20error:\x20HTTP\x20','VNM','Tracker\x20ID:','‚ö†Ô∏è\x20WEBHOOKS\x20TEMPORARILY\x20DISABLED\x20-\x20Always\x20returning\x20PROCESSING\x20status','GRC','228JknvGx','SUR','DEU','IND','2OODLoC','defineProperty','SVK','THA','amount','Checked\x20fields:\x20client_transaction_id,\x20system_id,\x20tracker_id','292257VIMlcJ','MDV','ARG','toUpperCase','80uowkaS','‚úÖ\x20AmPay\x20payment\x20link\x20created\x20successfully','NGA','JOR','KEN','MEX','a5a059aa63392e571341bddc5148a5db66643722e9a6bf16a9395fb690a80288931d5a1180a85a28eb9f6516cf61dfc1bf4e37898f3a35261cd2db88888d3815','333086FmdYJN','CLIENT_MERCHANT_ID','üìù\x20Logging\x20AmPay\x20payment\x20creation\x20failure...','AZE','HUN','BOL','MLT','Forced\x20status\x20(webhook\x20disabled):\x20','CAN','VAT','AmPay\x20payment\x20creation\x20failed:\x20','createPaymentLink','3216648sOOsRQ','VEN','ampayService','status','XKX','‚ùå\x20AmPay\x20payment\x20creation\x20failed:','TRAFFER','Order\x20ID:','GBR','keys','LVA','ZMB','Payment\x20URL:','TZA','\x20-\x20','4895781wPYlYj','Customer\x20Country\x20(2-letter):','FLK','PRK','MDA','__esModule','CZE','MNG','CHL','POST','TJK','PER','https://traffer.uk/gateway/ampay/','redirect_url','GAM','FIN','üì§\x20AmPay\x20request\x20body:','LAO','GUY','DNK','MYS','SGP','text','warn','Unknown\x20error','BHR','parse','log','GEO','system_id','apiUrl','error_message','ARE'];a44_0x4da0=function(){return _0x1caca6;};return a44_0x4da0();}Object[a44_0x4051e1(0x220)](exports,a44_0x4051e1(0x250),{'value':!![]}),exports[a44_0x4051e1(0x23e)]=exports[a44_0x4051e1(0x1de)]=void 0x0;class AmPayService{constructor(){const _0x5223a7=a44_0x4051e1;this['CLIENT_MERCHANT_ID']=_0x5223a7(0x242),this[_0x5223a7(0x1cf)]='58b59ccbc03dcdcfc20d830edfba765dbf9f3531c692533d84b17938e9c40bda',this[_0x5223a7(0x203)]=_0x5223a7(0x22f),this[_0x5223a7(0x1be)]=_0x5223a7(0x257),console['log']('üá¶üá≤\x20AmPay\x20service\x20initialized\x20with\x20Open\x20Banking\x20AM\x20processing');}[a44_0x4051e1(0x215)](_0x379fd2){const _0x1722cb=a44_0x4051e1,_0x30b4e5={'AD':'AND','AL':_0x1722cb(0x202),'AT':_0x1722cb(0x1d7),'BA':_0x1722cb(0x1ea),'BE':_0x1722cb(0x1f5),'BG':'BGR','BY':_0x1722cb(0x1e2),'CH':_0x1722cb(0x1f7),'CY':_0x1722cb(0x1c5),'CZ':_0x1722cb(0x251),'DE':_0x1722cb(0x21d),'DK':_0x1722cb(0x25e),'EE':_0x1722cb(0x213),'ES':_0x1722cb(0x1c7),'FI':_0x1722cb(0x25a),'FR':_0x1722cb(0x20a),'GB':_0x1722cb(0x244),'GE':_0x1722cb(0x1bc),'GR':_0x1722cb(0x21a),'HR':'HRV','HU':_0x1722cb(0x234),'IE':_0x1722cb(0x201),'IS':_0x1722cb(0x212),'IT':'ITA','LI':'LIE','LT':'LTU','LU':_0x1722cb(0x1ca),'LV':_0x1722cb(0x246),'MC':_0x1722cb(0x1d4),'MD':_0x1722cb(0x24f),'ME':'MNE','MK':'MKD','MT':_0x1722cb(0x236),'NL':_0x1722cb(0x1ff),'NO':_0x1722cb(0x208),'PL':_0x1722cb(0x1d3),'PT':'PRT','RO':_0x1722cb(0x20b),'RS':_0x1722cb(0x1f0),'RU':_0x1722cb(0x211),'SE':'SWE','SI':'SVN','SK':_0x1722cb(0x221),'SM':_0x1722cb(0x1ef),'UA':'UKR','VA':_0x1722cb(0x239),'XK':_0x1722cb(0x240),'AM':_0x1722cb(0x1ed),'AZ':_0x1722cb(0x233),'KZ':'KAZ','KG':'KGZ','TJ':_0x1722cb(0x255),'TM':_0x1722cb(0x207),'UZ':_0x1722cb(0x1df),'US':'USA','CA':_0x1722cb(0x238),'AU':_0x1722cb(0x214),'JP':_0x1722cb(0x1e6),'CN':_0x1722cb(0x1fa),'IN':_0x1722cb(0x21e),'BR':_0x1722cb(0x1e7),'MX':_0x1722cb(0x22e),'AR':_0x1722cb(0x227),'CL':_0x1722cb(0x253),'PE':_0x1722cb(0x256),'CO':'COL','VE':_0x1722cb(0x23d),'EC':_0x1722cb(0x209),'BO':_0x1722cb(0x235),'PY':'PRY','UY':_0x1722cb(0x1e4),'SR':_0x1722cb(0x21c),'GY':_0x1722cb(0x25d),'FK':_0x1722cb(0x24d),'ZA':'ZAF','EG':_0x1722cb(0x206),'NG':_0x1722cb(0x22b),'KE':_0x1722cb(0x22d),'GH':'GHA','TZ':_0x1722cb(0x249),'UG':_0x1722cb(0x1fb),'ZW':_0x1722cb(0x1e9),'ZM':_0x1722cb(0x247),'MW':_0x1722cb(0x1cb),'MZ':_0x1722cb(0x1fd),'MG':'MDG','MU':'MUS','SC':_0x1722cb(0x20e),'RE':'REU','TR':_0x1722cb(0x1f2),'IR':'IRN','IQ':_0x1722cb(0x1c8),'SA':'SAU','AE':_0x1722cb(0x1c0),'KW':_0x1722cb(0x1d6),'QA':'QAT','BH':_0x1722cb(0x264),'OM':_0x1722cb(0x1f6),'YE':_0x1722cb(0x1f1),'JO':_0x1722cb(0x22c),'LB':_0x1722cb(0x1f8),'SY':_0x1722cb(0x210),'IL':_0x1722cb(0x1ee),'PS':'PSE','KR':_0x1722cb(0x1cd),'KP':_0x1722cb(0x24e),'TH':_0x1722cb(0x222),'VN':_0x1722cb(0x217),'MY':_0x1722cb(0x25f),'SG':_0x1722cb(0x260),'ID':_0x1722cb(0x1c3),'PH':_0x1722cb(0x1f4),'LA':_0x1722cb(0x25c),'KH':'KHM','MM':_0x1722cb(0x1eb),'BD':_0x1722cb(0x1d8),'LK':'LKA','NP':_0x1722cb(0x1d0),'BT':_0x1722cb(0x1e1),'MV':_0x1722cb(0x226),'AF':_0x1722cb(0x1ec),'PK':'PAK','MN':_0x1722cb(0x252)},_0xc65874=_0x30b4e5[_0x379fd2[_0x1722cb(0x228)]()];if(!_0xc65874)return console[_0x1722cb(0x262)]('‚ö†Ô∏è\x20Unknown\x20country\x20code:\x20'+_0x379fd2+_0x1722cb(0x1d9)),_0x1722cb(0x211);return _0xc65874;}async[a44_0x4051e1(0x23b)](_0x5bd815){const _0x1681c4=a44_0x4051e1;try{const {orderId:_0x10a786,amount:_0x2d7989,currency:_0x10056f,firstName:_0x3d9291,lastName:_0x3d26ff,email:_0x38c675,customerIp:_0x48b831,customerCountry:_0x188df5,successUrl:_0xb5bebb,failureUrl:_0x236dc2}=_0x5bd815;console[_0x1681c4(0x1bb)](_0x1681c4(0x1d1)),console['log'](_0x1681c4(0x243),_0x10a786),console[_0x1681c4(0x1bb)]('Amount:',_0x2d7989,_0x10056f),console['log']('Customer:',_0x3d9291+'\x20'+_0x3d26ff),console[_0x1681c4(0x1bb)](_0x1681c4(0x200),_0x38c675),console['log']('Customer\x20IP:',_0x48b831),console[_0x1681c4(0x1bb)](_0x1681c4(0x24c),_0x188df5);const _0x3dcdf4=this[_0x1681c4(0x215)](_0x188df5);console[_0x1681c4(0x1bb)](_0x1681c4(0x1cc),_0x3dcdf4);const _0x506ecb={'sub_method':_0x1681c4(0x259),'currency':_0x10056f[_0x1681c4(0x228)](),'amount':_0x2d7989,'callback_url':'https://traffer.uk/gateway/ampay/webhook.php','client_merchant_id':this[_0x1681c4(0x231)],'client_transaction_id':_0x10a786,'transaction_description':_0x10a786,'customer':{'ip':_0x48b831,'email':_0x38c675,'full_name':_0x3d9291+'\x20'+_0x3d26ff,'country':_0x3dcdf4},'success_redirect_url':_0xb5bebb,'error_redirect_url':_0x236dc2};console[_0x1681c4(0x1bb)](_0x1681c4(0x25b),JSON[_0x1681c4(0x1fc)](_0x506ecb,null,0x2));const _0x33b0e9=await fetch(this[_0x1681c4(0x1be)]+_0x1681c4(0x1d2),{'method':_0x1681c4(0x254),'headers':{'Content-Type':_0x1681c4(0x1f3),'User-Agent':_0x1681c4(0x1c4)},'body':JSON[_0x1681c4(0x1fc)](_0x506ecb)}),_0x2bfd8a=await _0x33b0e9[_0x1681c4(0x261)]();console['log']('üì•\x20AmPay\x20raw\x20response:',_0x2bfd8a);if(!_0x33b0e9['ok'])throw new Error(_0x1681c4(0x216)+_0x33b0e9[_0x1681c4(0x23f)]+_0x1681c4(0x24a)+_0x2bfd8a);let _0x5a36e8;try{_0x5a36e8=JSON[_0x1681c4(0x265)](_0x2bfd8a);}catch(_0xf329a9){throw new Error(_0x1681c4(0x1d5)+_0x2bfd8a);}console[_0x1681c4(0x1bb)]('üìä\x20AmPay\x20response\x20data:',JSON[_0x1681c4(0x1fc)](_0x5a36e8,null,0x2));if(!_0x5a36e8[_0x1681c4(0x258)])throw new Error(_0x1681c4(0x23a)+(_0x5a36e8[_0x1681c4(0x1bf)]||_0x5a36e8[_0x1681c4(0x20f)]||_0x1681c4(0x263)));const _0x5c3d6d=_0x5a36e8[_0x1681c4(0x258)],_0x1c5408=_0x5a36e8['system_id'],_0xdcb3c0=_0x5a36e8[_0x1681c4(0x1f9)];return console[_0x1681c4(0x1bb)](_0x1681c4(0x22a)),console[_0x1681c4(0x1bb)](_0x1681c4(0x248),_0x5c3d6d),console[_0x1681c4(0x1bb)]('System\x20ID:',_0x1c5408),console[_0x1681c4(0x1bb)](_0x1681c4(0x218),_0xdcb3c0),console[_0x1681c4(0x1bb)](_0x1681c4(0x1dc),_0x5a36e8[_0x1681c4(0x23f)]),console[_0x1681c4(0x1bb)](_0x1681c4(0x1e8)),{'gateway_payment_id':_0x1c5408||_0xdcb3c0||_0x10a786,'payment_url':_0x5c3d6d||'','transaction_id':_0x1c5408};}catch(_0x50a510){console[_0x1681c4(0x1ce)](_0x1681c4(0x241),_0x50a510),console[_0x1681c4(0x1bb)](_0x1681c4(0x232));throw _0x50a510;}}async['healthCheck'](){const _0x3c34f0=a44_0x4051e1;try{const _0xb6a4ab=await fetch(this[_0x3c34f0(0x1be)]+_0x3c34f0(0x1c9),{'method':_0x3c34f0(0x1c2),'headers':{'Content-Type':'application/json','User-Agent':_0x3c34f0(0x1c4)}});return _0xb6a4ab&&_0xb6a4ab[_0x3c34f0(0x23f)]===0xc8?!![]:![];}catch(_0x399f64){return console['error'](_0x3c34f0(0x1dd),_0x399f64),![];}}async['processWebhook'](_0x102608){const _0xe01a68=a44_0x4051e1;console[_0xe01a68(0x1bb)]('===\x20Processing\x20AmPay\x20webhook\x20==='),console[_0xe01a68(0x1bb)](_0xe01a68(0x219)),console['log'](_0xe01a68(0x1da),_0x102608),console[_0xe01a68(0x1bb)](_0xe01a68(0x1e0),typeof _0x102608),console[_0xe01a68(0x1bb)]('Available\x20fields:');_0x102608&&typeof _0x102608==='object'&&Object[_0xe01a68(0x245)](_0x102608)['forEach'](_0x17b1ae=>{const _0x3d626c=_0xe01a68;console[_0x3d626c(0x1bb)]('\x20\x20'+_0x17b1ae+':\x20'+_0x102608[_0x17b1ae]+'\x20('+typeof _0x102608[_0x17b1ae]+')');});let _0x541c33=_0xe01a68(0x1fe);const _0x51c9cd=_0x102608[_0xe01a68(0x1e3)]||_0x102608[_0xe01a68(0x1bd)]||_0x102608['tracker_id']||'';return console[_0xe01a68(0x1bb)](_0xe01a68(0x20c)+_0x51c9cd),console['log'](_0xe01a68(0x237)+_0x541c33),!_0x51c9cd&&(console['error'](_0xe01a68(0x1e5)),console[_0xe01a68(0x1ce)](_0xe01a68(0x224))),{'paymentId':_0x51c9cd,'status':_0x541c33,'amount':_0x102608[_0xe01a68(0x223)],'currency':_0x102608['currency']};}}exports['AmPayService']=AmPayService,exports[a44_0x4051e1(0x23e)]=new AmPayService();