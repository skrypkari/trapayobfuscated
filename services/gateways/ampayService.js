'use strict';const a54_0x467355=a54_0x3a63;function a54_0x2194(){const _0x12944f=['KHM','Customer\x20Country\x20(2-letter):','NLD','âœ…\x20AmPay\x20payment\x20link\x20created\x20successfully','IDN','Customer:','POST','BHR','IND','SMR','2164285VJHzhd','log','BRA','686385OgpMjt','KAZ','LAO','ZAF','MLT','BIH','error','KWT','KEN','JPN','PSE','MOZ','ðŸ“Š\x20AmPay\x20response\x20data:','GUY','âš ï¸\x20WEBHOOKS\x20TEMPORARILY\x20DISABLED\x20-\x20Always\x20returning\x20PROCESSING\x20status','API_PUBLIC_KEY','âš ï¸\x20Unknown\x20country\x20code:\x20','YEM','MYS','forEach','NGA','BOL','stringify','LKA','Webhook\x20data:','ZMB','CHL','4kHCHUR','GET','system_id','ALB','8FzlWmm','BLR','currency','object','GHA','PENDING','LTU','https://traffer.uk/gateway/ampay/','health.php','CAN','LUX','AmPayService','ðŸ“¥\x20AmPay\x20raw\x20response:','SGP','LIE','EGY','MKD','ampay.php','MEX','PRT',',\x20using\x20RUS\x20as\x20fallback','DEU','Amount:','CYP','ðŸ“\x20Logging\x20AmPay\x20payment\x20creation\x20event...','âŒ\x20AmPay\x20health\x20check\x20failed:','Status:','Forced\x20status\x20(webhook\x20disabled):\x20','MWI','CHN','a5a059aa63392e571341bddc5148a5db66643722e9a6bf16a9395fb690a80288931d5a1180a85a28eb9f6516cf61dfc1bf4e37898f3a35261cd2db88888d3815','text','SYC','GAM','ARM','TKM','ROU','redirect_url','__esModule','\x20-\x20','AFG','SVK','MDA','3433260wCSxIt','Checked\x20fields:\x20client_transaction_id,\x20system_id,\x20tracker_id','EST','MCO','AmPay\x20payment\x20creation\x20failed:\x20','377506NkoeNT','application/json','SYR','SVN','ðŸ“¤\x20AmPay\x20request\x20body:','Webhook\x20data\x20type:','warn','931595kUYkwN','11mKwhUp','6aQSzrh','MDV','73926LBtTev','SAU','Tracker\x20ID:','SUR','Invalid\x20JSON\x20response\x20from\x20AmPay:\x20','IRQ','BTN','tracker_id','ESP','FRA','SRB','amount','UZB','Customer\x20Country\x20(3-letter):','ARE','ITA','VAT','VEN','MUS','IRL','ISR','ARG','healthCheck','AmPay\x20API\x20error:\x20HTTP\x20','convert2LetterTo3LetterCountryCode','AZE','API_PRIVATE_KEY','SWE','TZA','XKX','UKR','FIN','status','AUS','QAT','Email:','Available\x20fields:','defineProperty','JOR','ðŸ“\x20Logging\x20AmPay\x20payment\x20creation\x20failure...','CLIENT_MERCHANT_ID','HRV','COL','HUN','toUpperCase','Payment\x20URL:','No\x20payment\x20ID\x20found\x20in\x20webhook\x20data','USA','AND','parse','CZE','25986UlHHLl','ISL','PHL','error_message','58b59ccbc03dcdcfc20d830edfba765dbf9f3531c692533d84b17938e9c40bda','TrapayAPI/1.0','NOR','===\x20Processing\x20AmPay\x20webhook\x20===','ampayService','TUR','BGR','apiUrl','THA'];a54_0x2194=function(){return _0x12944f;};return a54_0x2194();}(function(_0x40917c,_0x26061c){const _0x1fb5a7=a54_0x3a63,_0xe70be3=_0x40917c();while(!![]){try{const _0x1d4d2a=parseInt(_0x1fb5a7(0xcf))/0x1+parseInt(_0x1fb5a7(0x138))/0x2+-parseInt(_0x1fb5a7(0xe9))/0x3+-parseInt(_0x1fb5a7(0x104))/0x4*(-parseInt(_0x1fb5a7(0xe6))/0x5)+parseInt(_0x1fb5a7(0x141))/0x6*(parseInt(_0x1fb5a7(0x13f))/0x7)+parseInt(_0x1fb5a7(0x108))/0x8*(parseInt(_0x1fb5a7(0x143))/0x9)+parseInt(_0x1fb5a7(0x133))/0xa*(-parseInt(_0x1fb5a7(0x140))/0xb);if(_0x1d4d2a===_0x26061c)break;else _0xe70be3['push'](_0xe70be3['shift']());}catch(_0x4be628){_0xe70be3['push'](_0xe70be3['shift']());}}}(a54_0x2194,0x34ec6));function a54_0x3a63(_0x15db3d,_0x4aa27f){_0x15db3d=_0x15db3d-0xa7;const _0x2194a6=a54_0x2194();let _0x3a6357=_0x2194a6[_0x15db3d];return _0x3a6357;}Object[a54_0x467355(0xc1)](exports,a54_0x467355(0x12e),{'value':!![]}),exports[a54_0x467355(0xd7)]=exports[a54_0x467355(0x113)]=void 0x0;class AmPayService{constructor(){const _0x5ab2bf=a54_0x467355;this[_0x5ab2bf(0xc4)]='TRAFFER',this[_0x5ab2bf(0xf8)]=_0x5ab2bf(0xd3),this[_0x5ab2bf(0xb6)]=_0x5ab2bf(0x126),this[_0x5ab2bf(0xda)]=_0x5ab2bf(0x10f),console[_0x5ab2bf(0xe7)]('ðŸ‡¦ðŸ‡²\x20AmPay\x20service\x20initialized\x20with\x20Open\x20Banking\x20AM\x20processing');}['convert2LetterTo3LetterCountryCode'](_0x3d3d26){const _0x4c4f2d=a54_0x467355,_0x57554d={'AD':_0x4c4f2d(0xcc),'AL':_0x4c4f2d(0x107),'AT':'AUT','BA':_0x4c4f2d(0xee),'BE':'BEL','BG':_0x4c4f2d(0xd9),'BY':_0x4c4f2d(0x109),'CH':'CHE','CY':_0x4c4f2d(0x11f),'CZ':_0x4c4f2d(0xce),'DE':_0x4c4f2d(0x11d),'DK':'DNK','EE':_0x4c4f2d(0x135),'ES':_0x4c4f2d(0x14b),'FI':_0x4c4f2d(0xbb),'FR':_0x4c4f2d(0x14c),'GB':'GBR','GE':'GEO','GR':'GRC','HR':_0x4c4f2d(0xc5),'HU':_0x4c4f2d(0xc7),'IE':_0x4c4f2d(0xaf),'IS':_0x4c4f2d(0xd0),'IT':_0x4c4f2d(0xab),'LI':_0x4c4f2d(0x116),'LT':_0x4c4f2d(0x10e),'LU':_0x4c4f2d(0x112),'LV':'LVA','MC':_0x4c4f2d(0x136),'MD':_0x4c4f2d(0x132),'ME':'MNE','MK':_0x4c4f2d(0x118),'MT':_0x4c4f2d(0xed),'NL':_0x4c4f2d(0xde),'NO':_0x4c4f2d(0xd5),'PL':'POL','PT':_0x4c4f2d(0x11b),'RO':_0x4c4f2d(0x12c),'RS':_0x4c4f2d(0x14d),'RU':'RUS','SE':_0x4c4f2d(0xb7),'SI':_0x4c4f2d(0x13b),'SK':_0x4c4f2d(0x131),'SM':_0x4c4f2d(0xe5),'UA':_0x4c4f2d(0xba),'VA':_0x4c4f2d(0xac),'XK':_0x4c4f2d(0xb9),'AM':_0x4c4f2d(0x12a),'AZ':_0x4c4f2d(0xb5),'KZ':_0x4c4f2d(0xea),'KG':'KGZ','TJ':'TJK','TM':_0x4c4f2d(0x12b),'UZ':_0x4c4f2d(0xa8),'US':_0x4c4f2d(0xcb),'CA':_0x4c4f2d(0x111),'AU':_0x4c4f2d(0xbd),'JP':_0x4c4f2d(0xf2),'CN':_0x4c4f2d(0x125),'IN':_0x4c4f2d(0xe4),'BR':_0x4c4f2d(0xe8),'MX':_0x4c4f2d(0x11a),'AR':_0x4c4f2d(0xb1),'CL':_0x4c4f2d(0x103),'PE':'PER','CO':_0x4c4f2d(0xc6),'VE':_0x4c4f2d(0xad),'EC':'ECU','BO':_0x4c4f2d(0xfe),'PY':'PRY','UY':'URY','SR':_0x4c4f2d(0x146),'GY':_0x4c4f2d(0xf6),'FK':'FLK','ZA':_0x4c4f2d(0xec),'EG':_0x4c4f2d(0x117),'NG':_0x4c4f2d(0xfd),'KE':_0x4c4f2d(0xf1),'GH':_0x4c4f2d(0x10c),'TZ':_0x4c4f2d(0xb8),'UG':'UGA','ZW':'ZWE','ZM':_0x4c4f2d(0x102),'MW':_0x4c4f2d(0x124),'MZ':_0x4c4f2d(0xf4),'MG':'MDG','MU':_0x4c4f2d(0xae),'SC':_0x4c4f2d(0x128),'RE':'REU','TR':_0x4c4f2d(0xd8),'IR':'IRN','IQ':_0x4c4f2d(0x148),'SA':_0x4c4f2d(0x144),'AE':_0x4c4f2d(0xaa),'KW':_0x4c4f2d(0xf0),'QA':_0x4c4f2d(0xbe),'BH':_0x4c4f2d(0xe3),'OM':'OMN','YE':_0x4c4f2d(0xfa),'JO':_0x4c4f2d(0xc2),'LB':'LBN','SY':_0x4c4f2d(0x13a),'IL':_0x4c4f2d(0xb0),'PS':_0x4c4f2d(0xf3),'KR':'KOR','KP':'PRK','TH':_0x4c4f2d(0xdb),'VN':'VNM','MY':_0x4c4f2d(0xfb),'SG':_0x4c4f2d(0x115),'ID':_0x4c4f2d(0xe0),'PH':_0x4c4f2d(0xd1),'LA':_0x4c4f2d(0xeb),'KH':_0x4c4f2d(0xdc),'MM':'MMR','BD':'BGD','LK':_0x4c4f2d(0x100),'NP':'NPL','BT':_0x4c4f2d(0x149),'MV':_0x4c4f2d(0x142),'AF':_0x4c4f2d(0x130),'PK':'PAK','MN':'MNG'},_0x3ac033=_0x57554d[_0x3d3d26[_0x4c4f2d(0xc8)]()];if(!_0x3ac033)return console[_0x4c4f2d(0x13e)](_0x4c4f2d(0xf9)+_0x3d3d26+_0x4c4f2d(0x11c)),'RUS';return _0x3ac033;}async['createPaymentLink'](_0x510f68){const _0x432114=a54_0x467355;try{const {orderId:_0xca3480,amount:_0x16d769,currency:_0x2f8ae0,firstName:_0x3c9698,lastName:_0x13167b,email:_0x1657f6,customerIp:_0x5ee71c,customerCountry:_0x4c91e0,successUrl:_0x24c307,failureUrl:_0x969106}=_0x510f68;console[_0x432114(0xe7)]('ðŸ‡¦ðŸ‡²\x20Creating\x20AmPay\x20payment\x20link...'),console['log']('Order\x20ID:',_0xca3480),console[_0x432114(0xe7)](_0x432114(0x11e),_0x16d769,_0x2f8ae0),console['log'](_0x432114(0xe1),_0x3c9698+'\x20'+_0x13167b),console[_0x432114(0xe7)](_0x432114(0xbf),_0x1657f6),console[_0x432114(0xe7)]('Customer\x20IP:',_0x5ee71c),console[_0x432114(0xe7)](_0x432114(0xdd),_0x4c91e0);const _0x457da3=this[_0x432114(0xb4)](_0x4c91e0);console[_0x432114(0xe7)](_0x432114(0xa9),_0x457da3);const _0x1aa22f={'sub_method':_0x432114(0x129),'currency':_0x2f8ae0[_0x432114(0xc8)](),'amount':_0x16d769,'callback_url':'https://traffer.uk/gateway/ampay/webhook.php','client_merchant_id':this['CLIENT_MERCHANT_ID'],'client_transaction_id':_0xca3480,'transaction_description':_0xca3480,'customer':{'ip':_0x5ee71c,'email':_0x1657f6,'full_name':_0x3c9698+'\x20'+_0x13167b,'country':_0x457da3},'success_redirect_url':_0x24c307,'error_redirect_url':_0x969106};console[_0x432114(0xe7)](_0x432114(0x13c),JSON['stringify'](_0x1aa22f,null,0x2));const _0x1c7739=await fetch(this['apiUrl']+_0x432114(0x119),{'method':_0x432114(0xe2),'headers':{'Content-Type':_0x432114(0x139),'User-Agent':_0x432114(0xd4)},'body':JSON[_0x432114(0xff)](_0x1aa22f)}),_0x2ec9d0=await _0x1c7739[_0x432114(0x127)]();console[_0x432114(0xe7)](_0x432114(0x114),_0x2ec9d0);if(!_0x1c7739['ok'])throw new Error(_0x432114(0xb3)+_0x1c7739[_0x432114(0xbc)]+_0x432114(0x12f)+_0x2ec9d0);let _0x565172;try{_0x565172=JSON[_0x432114(0xcd)](_0x2ec9d0);}catch(_0x143a48){throw new Error(_0x432114(0x147)+_0x2ec9d0);}console['log'](_0x432114(0xf5),JSON[_0x432114(0xff)](_0x565172,null,0x2));if(!_0x565172[_0x432114(0x12d)])throw new Error(_0x432114(0x137)+(_0x565172[_0x432114(0xd2)]||_0x565172['message']||'Unknown\x20error'));const _0x3a5714=_0x565172['redirect_url'],_0x555e6d=_0x565172[_0x432114(0x106)],_0x4f2157=_0x565172[_0x432114(0x14a)];return console[_0x432114(0xe7)](_0x432114(0xdf)),console[_0x432114(0xe7)](_0x432114(0xc9),_0x3a5714),console[_0x432114(0xe7)]('System\x20ID:',_0x555e6d),console[_0x432114(0xe7)](_0x432114(0x145),_0x4f2157),console['log'](_0x432114(0x122),_0x565172[_0x432114(0xbc)]),console[_0x432114(0xe7)](_0x432114(0x120)),{'gateway_payment_id':_0x555e6d||_0x4f2157||_0xca3480,'payment_url':_0x3a5714||'','transaction_id':_0x555e6d};}catch(_0x4926f6){console['error']('âŒ\x20AmPay\x20payment\x20creation\x20failed:',_0x4926f6),console[_0x432114(0xe7)](_0x432114(0xc3));throw _0x4926f6;}}async[a54_0x467355(0xb2)](){const _0x26034a=a54_0x467355;try{const _0x2662a0=await fetch(this[_0x26034a(0xda)]+_0x26034a(0x110),{'method':_0x26034a(0x105),'headers':{'Content-Type':_0x26034a(0x139),'User-Agent':_0x26034a(0xd4)}});return _0x2662a0&&_0x2662a0['status']===0xc8?!![]:![];}catch(_0x15c127){return console[_0x26034a(0xef)](_0x26034a(0x121),_0x15c127),![];}}async['processWebhook'](_0x10d0fb){const _0x3f7ec5=a54_0x467355;console[_0x3f7ec5(0xe7)](_0x3f7ec5(0xd6)),console[_0x3f7ec5(0xe7)](_0x3f7ec5(0xf7)),console['log'](_0x3f7ec5(0x101),_0x10d0fb),console['log'](_0x3f7ec5(0x13d),typeof _0x10d0fb),console[_0x3f7ec5(0xe7)](_0x3f7ec5(0xc0));_0x10d0fb&&typeof _0x10d0fb===_0x3f7ec5(0x10b)&&Object['keys'](_0x10d0fb)[_0x3f7ec5(0xfc)](_0x5e3ecd=>{console['log']('\x20\x20'+_0x5e3ecd+':\x20'+_0x10d0fb[_0x5e3ecd]+'\x20('+typeof _0x10d0fb[_0x5e3ecd]+')');});let _0x4d9dae=_0x3f7ec5(0x10d);const _0xac76e4=_0x10d0fb['client_transaction_id']||_0x10d0fb['system_id']||_0x10d0fb[_0x3f7ec5(0x14a)]||'';return console[_0x3f7ec5(0xe7)]('Extracted\x20payment\x20ID:\x20'+_0xac76e4),console[_0x3f7ec5(0xe7)](_0x3f7ec5(0x123)+_0x4d9dae),!_0xac76e4&&(console[_0x3f7ec5(0xef)](_0x3f7ec5(0xca)),console[_0x3f7ec5(0xef)](_0x3f7ec5(0x134))),{'paymentId':_0xac76e4,'status':_0x4d9dae,'amount':_0x10d0fb[_0x3f7ec5(0xa7)],'currency':_0x10d0fb[_0x3f7ec5(0x10a)]};}}exports[a54_0x467355(0x113)]=AmPayService,exports[a54_0x467355(0xd7)]=new AmPayService();