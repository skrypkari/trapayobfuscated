'use strict';const a63_0x232fd9=a63_0x525f;(function(_0x41361,_0x5ca826){const _0x4531e3=a63_0x525f,_0xbcd553=_0x41361();while(!![]){try{const _0x56a6a7=-parseInt(_0x4531e3(0x1e9))/0x1*(parseInt(_0x4531e3(0x1f4))/0x2)+parseInt(_0x4531e3(0x210))/0x3+-parseInt(_0x4531e3(0x204))/0x4+parseInt(_0x4531e3(0x1f7))/0x5+parseInt(_0x4531e3(0x251))/0x6*(parseInt(_0x4531e3(0x1eb))/0x7)+-parseInt(_0x4531e3(0x25a))/0x8*(-parseInt(_0x4531e3(0x238))/0x9)+-parseInt(_0x4531e3(0x1f1))/0xa;if(_0x56a6a7===_0x5ca826)break;else _0xbcd553['push'](_0xbcd553['shift']());}catch(_0x7cfed5){_0xbcd553['push'](_0xbcd553['shift']());}}}(a63_0x3d8b,0x66132));function a63_0x3d8b(){const _0x130531=['/v1/hosted/payment_links/','680VqTPoL','buy','payment_method_data','https://tesoft.uk/gateway/rapyd/','PAYMENT_CANCELED','cardholder_name','paid','floor','failure_code','JSON\x20Parse\x20Error:\x20','EUR','üá¨üáß\x20Using\x20GB\x20(Britain)\x20as\x20country\x20for\x20Rapyd\x20payment\x20link','===\x20PARSED\x20RAPYD\x20RESPONSE\x20===','Error\x20Code:','===\x20RAPYD\x20SERVICE\x20ERROR\x20===','\x20\x20\x20requested_currency:\x20EUR','logWhiteDomainRequest','üîÑ\x20Rapyd\x20webhook\x20processed:\x20status=','application/json','Error\x20message:','Rapyd\x20API\x20error:\x20','Raw\x20Response\x20Body:','NEW','2603FLThWg','none','676186GyzAmI','paymentMethod','custom_elements','PAYMENT_FAILED','status','amount','9374070ZWhTih','UNKNOWN','Full\x20Error\x20Data:','268tsGNgN','ERR','headers','2492870ilRfYn','Failed\x20to\x20verify\x20Rapyd\x20payment:\x20','now','gb_mastercard_card','name','üí•\x20Rapyd\x20failure\x20message:\x20','EXPIRED','üá¨üáß\x20Country:\x20','PAID',',\x20body:\x20','===\x20RAPYD\x20API\x20REQUEST\x20(White\x20Domain\x20-\x20Updated\x20Format)\x20===','rapyd','SUCCESS','340784yuyDQA','\x20->\x20EUR:','Unknown\x20error\x20from\x20Rapyd\x20API','createPaymentLink','Status\x20Text:','Response\x20Time:','logWhiteDomainError','email','failure_message','===\x20RAPYD\x20API\x20RESPONSE\x20(White\x20Domain)\x20===','error','../loggerService','580026EmSLSX','Payment\x20System/1.0','logWhiteDomainResponse','CLO','currency','gb_visa_card','statusText','last4','Error\x20Message:','EXP','Invalid\x20response\x20from\x20Rapyd\x20API:\x20missing\x20id\x20or\x20redirect_url','URL:','processWebhook','entries','data','phone_number','HTTP\x20error!\x20status:\x20','defineProperty','message','Parsed\x20Result:','Headers:','Business\x20Error\x20(','===\x20RAPYD\x20API\x20BUSINESS\x20ERROR\x20===','error_code','Request\x20Body\x20(Updated\x20Format):','\x20\x20\x20expiration:\x20','stack','Failed\x20to\x20create\x20Rapyd\x20payment\x20link:\x20','__esModule','Rapyd\x20payment\x20verification\x20error:','Payment\x20Link\x20ID:','POST','stringify','type','merchant_reference_id','HTTP\x20','GET','):\x20','Error\x20stack:','parse','75303TehIar','===\x20RAPYD\x20API\x20INCOMPLETE\x20RESPONSE\x20===','toISOString','toUpperCase','log','Failed\x20to\x20create\x20Rapyd\x20payment\x20link:\x20Unknown\x20error','FAILED','Processing\x20Rapyd\x20webhook:','apiUrl','CAN','ACT','Response\x20Body:','üá¨üáß\x20Country\x20used:\x20','verifyPayment','üí±\x20Adding\x20currency\x20conversion\x20fields\x20for\x20','json','redirect_url','Status:','PENDING','Response\x20data:','text','üí≥\x20Payment\x20Methods:\x20gb_visa_card,\x20gb_mastercard_card','expiration','errorCode','/v1/hosted/payment_links','24GhDILw','fromEntries','\x20\x20\x20fixed_side:\x20buy','PAYMENT_EXPIRED','loggerService','Unknown\x20error','address','RapydService'];a63_0x3d8b=function(){return _0x130531;};return a63_0x3d8b();}Object[a63_0x232fd9(0x221)](exports,a63_0x232fd9(0x22c),{'value':!![]}),exports[a63_0x232fd9(0x258)]=void 0x0;const loggerService_1=require(a63_0x232fd9(0x20f));class RapydService{constructor(){const _0x265c33=a63_0x232fd9;this[_0x265c33(0x240)]=_0x265c33(0x25d),console[_0x265c33(0x23c)]('üåê\x20Rapyd\x20service\x20initialized\x20with\x20white\x20domain\x20proxy');}async[a63_0x232fd9(0x207)](_0x6b7ded){const _0x52a23e=a63_0x232fd9,{orderId:_0x15028b,orderName:_0x1ca2f2,amount:_0x4b6e67,currency:_0x35cb92,usage:_0x30c7f1,maxPayments:_0x57ac03,successUrl:_0x4bcc5a,failUrl:_0x3346bf,customerName:_0x26ac27,customerEmail:_0x2a62b1}=_0x6b7ded,_0x36f4ed=_0x35cb92[_0x52a23e(0x23b)](),_0x4bea3b='GB';console[_0x52a23e(0x23c)](_0x52a23e(0x265));const _0x153458='https://tesoft.uk/gateway/success.php?id='+_0x15028b,_0x3c199e='https://tesoft.uk/gateway/fail.php?id='+_0x15028b,_0x2ab049={'amount':_0x4b6e67,'currency':_0x36f4ed,'payment_method_options':{'3d_required':![]},'cancel_checkout_url':_0x3c199e,'complete_checkout_url':_0x153458,'complete_payment_url':_0x153458,'merchant_reference_id':_0x15028b,'description':'ORDER:\x20'+_0x15028b,'country':'GB','payment_method_types_include':[_0x52a23e(0x215),_0x52a23e(0x1fa)],'custom_elements':{'display_description':!![],'billing_address_collect':!![],'required_customer_fields':[_0x52a23e(0x1fb),_0x52a23e(0x20b),_0x52a23e(0x21f),_0x52a23e(0x257)]}};_0x26ac27&&(_0x2ab049[_0x52a23e(0x1ed)][_0x52a23e(0x25f)]=_0x26ac27,console[_0x52a23e(0x23c)]('üí≥\x20Adding\x20cardholder\x20name:\x20'+_0x26ac27));if(_0x36f4ed!==_0x52a23e(0x264)){const _0x381070=Math[_0x52a23e(0x261)](Date[_0x52a23e(0x1f9)]()/0x3e8)+0x1e*0x3c;_0x2ab049['fixed_side']=_0x52a23e(0x25b),_0x2ab049['requested_currency']='EUR',_0x2ab049[_0x52a23e(0x24e)]=_0x381070,console['log'](_0x52a23e(0x246)+_0x36f4ed+_0x52a23e(0x205)),console[_0x52a23e(0x23c)](_0x52a23e(0x253)),console[_0x52a23e(0x23c)](_0x52a23e(0x269)),console[_0x52a23e(0x23c)](_0x52a23e(0x229)+_0x381070+'\x20('+new Date(_0x381070*0x3e8)[_0x52a23e(0x23a)]()+')');}const _0x4b5db7=Date[_0x52a23e(0x1f9)]();try{console[_0x52a23e(0x23c)](_0x52a23e(0x201)),console['log'](_0x52a23e(0x21b),this['apiUrl']),console[_0x52a23e(0x23c)](_0x52a23e(0x228),JSON[_0x52a23e(0x230)](_0x2ab049,null,0x2)),console['log'](_0x52a23e(0x1fe)+_0x4bea3b+'\x20(always\x20GB\x20for\x20Rapyd)'),console[_0x52a23e(0x23c)]('üí≥\x20Payment\x20Methods:\x20gb_visa_card,\x20gb_mastercard_card'),loggerService_1[_0x52a23e(0x255)][_0x52a23e(0x1e2)](_0x52a23e(0x202),'/v1/hosted/payment_links',_0x52a23e(0x22f),_0x2ab049);const _0x2f72c1=await fetch(this['apiUrl'],{'method':_0x52a23e(0x22f),'headers':{'Content-Type':_0x52a23e(0x1e4),'User-Agent':_0x52a23e(0x211)},'body':JSON[_0x52a23e(0x230)](_0x2ab049)}),_0x21b8c7=Date['now']()-_0x4b5db7;console['log'](_0x52a23e(0x20d)),console[_0x52a23e(0x23c)](_0x52a23e(0x249),_0x2f72c1['status']),console['log'](_0x52a23e(0x208),_0x2f72c1[_0x52a23e(0x216)]),console[_0x52a23e(0x23c)](_0x52a23e(0x224),Object[_0x52a23e(0x252)](_0x2f72c1[_0x52a23e(0x1f6)][_0x52a23e(0x21d)]())),console[_0x52a23e(0x23c)](_0x52a23e(0x209),_0x21b8c7+'ms');const _0x40dda7=await _0x2f72c1[_0x52a23e(0x24c)]();console[_0x52a23e(0x23c)](_0x52a23e(0x1e7),_0x40dda7);if(!_0x2f72c1['ok']){console[_0x52a23e(0x20e)]('===\x20RAPYD\x20API\x20ERROR\x20==='),console[_0x52a23e(0x20e)]('HTTP\x20Status:',_0x2f72c1[_0x52a23e(0x1ef)]),console[_0x52a23e(0x20e)](_0x52a23e(0x243),_0x40dda7),loggerService_1[_0x52a23e(0x255)][_0x52a23e(0x212)](_0x52a23e(0x202),_0x52a23e(0x250),_0x2f72c1[_0x52a23e(0x1ef)],_0x40dda7,_0x21b8c7),loggerService_1[_0x52a23e(0x255)][_0x52a23e(0x20a)](_0x52a23e(0x202),'/v1/hosted/payment_links',_0x52a23e(0x233)+_0x2f72c1[_0x52a23e(0x1ef)]+':\x20'+_0x40dda7);throw new Error(_0x52a23e(0x220)+_0x2f72c1[_0x52a23e(0x1ef)]+_0x52a23e(0x200)+_0x40dda7);}let _0xa3b90e;try{_0xa3b90e=JSON[_0x52a23e(0x237)](_0x40dda7);}catch(_0x4b0f73){console[_0x52a23e(0x20e)]('Failed\x20to\x20parse\x20JSON\x20response:',_0x4b0f73),loggerService_1[_0x52a23e(0x255)][_0x52a23e(0x20a)](_0x52a23e(0x202),_0x52a23e(0x250),_0x52a23e(0x263)+_0x4b0f73);throw new Error('Invalid\x20JSON\x20response\x20from\x20Rapyd\x20API:\x20'+_0x40dda7);}console['log'](_0x52a23e(0x266)),console[_0x52a23e(0x23c)](_0x52a23e(0x223),JSON[_0x52a23e(0x230)](_0xa3b90e,null,0x2)),loggerService_1[_0x52a23e(0x255)][_0x52a23e(0x212)](_0x52a23e(0x202),'/v1/hosted/payment_links',_0x2f72c1[_0x52a23e(0x1ef)],_0xa3b90e,_0x21b8c7);if(_0xa3b90e[_0x52a23e(0x1ef)]?.['status']!==_0x52a23e(0x203)){const _0x2b931f=_0xa3b90e[_0x52a23e(0x1ef)]?.[_0x52a23e(0x222)]||_0x52a23e(0x206),_0x5f3ac3=_0xa3b90e[_0x52a23e(0x1ef)]?.[_0x52a23e(0x227)]||_0x52a23e(0x1f2);console[_0x52a23e(0x20e)](_0x52a23e(0x226)),console[_0x52a23e(0x20e)](_0x52a23e(0x267),_0x5f3ac3),console[_0x52a23e(0x20e)](_0x52a23e(0x218),_0x2b931f),console[_0x52a23e(0x20e)](_0x52a23e(0x1f3),_0xa3b90e[_0x52a23e(0x1ef)]),loggerService_1[_0x52a23e(0x255)][_0x52a23e(0x20a)](_0x52a23e(0x202),_0x52a23e(0x250),_0x52a23e(0x225)+_0x5f3ac3+_0x52a23e(0x235)+_0x2b931f);throw new Error('Rapyd\x20API\x20error\x20('+_0x5f3ac3+'):\x20'+_0x2b931f);}if(!_0xa3b90e['data']?.['id']||!_0xa3b90e['data']?.['redirect_url']){console[_0x52a23e(0x20e)](_0x52a23e(0x239)),console[_0x52a23e(0x20e)]('Missing\x20id\x20or\x20redirect_url\x20in\x20response'),console[_0x52a23e(0x20e)](_0x52a23e(0x24b),_0xa3b90e[_0x52a23e(0x21e)]),loggerService_1[_0x52a23e(0x255)][_0x52a23e(0x20a)]('rapyd',_0x52a23e(0x250),'Incomplete\x20response:\x20missing\x20id\x20or\x20redirect_url');throw new Error(_0x52a23e(0x21a));}return console[_0x52a23e(0x23c)]('===\x20RAPYD\x20SUCCESS\x20==='),console[_0x52a23e(0x23c)](_0x52a23e(0x22e),_0xa3b90e['data']['id']),console[_0x52a23e(0x23c)]('Redirect\x20URL:',_0xa3b90e[_0x52a23e(0x21e)][_0x52a23e(0x248)]),console[_0x52a23e(0x23c)](_0x52a23e(0x244)+_0x4bea3b+'\x20(GB\x20-\x20Britain)'),console[_0x52a23e(0x23c)](_0x52a23e(0x24d)),{'gateway_payment_id':_0xa3b90e[_0x52a23e(0x21e)]['id'],'payment_url':_0xa3b90e[_0x52a23e(0x21e)]['redirect_url']};}catch(_0x4ff621){console[_0x52a23e(0x20e)](_0x52a23e(0x268)),console[_0x52a23e(0x20e)]('Error\x20details:',_0x4ff621),loggerService_1[_0x52a23e(0x255)]['logWhiteDomainError']('rapyd',_0x52a23e(0x250),_0x4ff621);if(_0x4ff621 instanceof Error){console[_0x52a23e(0x20e)](_0x52a23e(0x1e5),_0x4ff621[_0x52a23e(0x222)]),console[_0x52a23e(0x20e)](_0x52a23e(0x236),_0x4ff621[_0x52a23e(0x22a)]);throw new Error(_0x52a23e(0x22b)+_0x4ff621[_0x52a23e(0x222)]);}throw new Error(_0x52a23e(0x23d));}}async[a63_0x232fd9(0x245)](_0x575356){const _0x17ea66=a63_0x232fd9,_0x39de69=Date[_0x17ea66(0x1f9)]();try{loggerService_1['loggerService'][_0x17ea66(0x1e2)](_0x17ea66(0x202),_0x17ea66(0x259)+_0x575356,'GET',{});const _0x2f281e=await fetch(this['apiUrl']+'/'+_0x575356,{'method':_0x17ea66(0x234),'headers':{'Content-Type':'application/json','User-Agent':'Payment\x20System/1.0'}}),_0x57d4a1=Date['now']()-_0x39de69;if(!_0x2f281e['ok']){const _0x442a42=await _0x2f281e[_0x17ea66(0x24c)]();loggerService_1[_0x17ea66(0x255)][_0x17ea66(0x212)](_0x17ea66(0x202),'/v1/hosted/payment_links/'+_0x575356,_0x2f281e['status'],_0x442a42,_0x57d4a1);throw new Error(_0x17ea66(0x220)+_0x2f281e['status']);}const _0x1ce3a8=await _0x2f281e[_0x17ea66(0x247)]();loggerService_1['loggerService'][_0x17ea66(0x212)](_0x17ea66(0x202),_0x17ea66(0x259)+_0x575356,_0x2f281e['status'],_0x1ce3a8,_0x57d4a1);if(_0x1ce3a8['status']?.['status']!=='SUCCESS'){loggerService_1[_0x17ea66(0x255)][_0x17ea66(0x20a)]('rapyd','/v1/hosted/payment_links/'+_0x575356,_0x17ea66(0x1e6)+(_0x1ce3a8['status']?.[_0x17ea66(0x222)]||_0x17ea66(0x256)));throw new Error('Rapyd\x20API\x20error:\x20'+(_0x1ce3a8[_0x17ea66(0x1ef)]?.[_0x17ea66(0x222)]||_0x17ea66(0x256)));}let _0x328292=_0x17ea66(0x24a);if(_0x1ce3a8[_0x17ea66(0x21e)]?.[_0x17ea66(0x1ef)])switch(_0x1ce3a8[_0x17ea66(0x21e)][_0x17ea66(0x1ef)][_0x17ea66(0x23b)]()){case _0x17ea66(0x213):_0x328292='PAID';break;case'CAN':_0x328292=_0x17ea66(0x23e);break;case'EXP':_0x328292=_0x17ea66(0x1fd);break;case _0x17ea66(0x1f5):_0x328292=_0x17ea66(0x23e);break;case _0x17ea66(0x1e8):case _0x17ea66(0x242):default:_0x328292='PENDING';break;}return{'status':_0x328292,'amount':_0x1ce3a8['data']?.[_0x17ea66(0x1f0)],'currency':_0x1ce3a8[_0x17ea66(0x21e)]?.[_0x17ea66(0x214)]};}catch(_0x22bf7a){console['error'](_0x17ea66(0x22d),_0x22bf7a),loggerService_1['loggerService'][_0x17ea66(0x20a)](_0x17ea66(0x202),_0x17ea66(0x259)+_0x575356,_0x22bf7a);throw new Error(_0x17ea66(0x1f8)+(_0x22bf7a instanceof Error?_0x22bf7a[_0x17ea66(0x222)]:_0x17ea66(0x256)));}}async[a63_0x232fd9(0x21c)](_0x3c687c){const _0x111b2c=a63_0x232fd9;console[_0x111b2c(0x23c)](_0x111b2c(0x23f),_0x3c687c);let _0x129baa=_0x111b2c(0x24a),_0x49bbb1;_0x3c687c[_0x111b2c(0x21e)]?.['failure_message']&&(_0x49bbb1=_0x3c687c[_0x111b2c(0x21e)][_0x111b2c(0x20c)],console['log'](_0x111b2c(0x1fc)+_0x49bbb1));switch(_0x3c687c[_0x111b2c(0x231)]?.[_0x111b2c(0x23b)]()){case'PAYMENT_COMPLETED':_0x3c687c[_0x111b2c(0x21e)]?.['paid']===!![]&&_0x3c687c[_0x111b2c(0x21e)]?.[_0x111b2c(0x1ef)]===_0x111b2c(0x213)?_0x129baa='PAID':_0x129baa=_0x111b2c(0x24a);break;case _0x111b2c(0x25e):_0x129baa=_0x111b2c(0x23e);break;case _0x111b2c(0x254):_0x129baa='EXPIRED';break;case _0x111b2c(0x1ee):_0x129baa=_0x111b2c(0x23e);!_0x49bbb1&&_0x3c687c['data']?.[_0x111b2c(0x20c)]&&(_0x49bbb1=_0x3c687c['data'][_0x111b2c(0x20c)]);break;default:switch(_0x3c687c[_0x111b2c(0x21e)]?.[_0x111b2c(0x1ef)]?.[_0x111b2c(0x23b)]()){case _0x111b2c(0x213):_0x3c687c['data']?.[_0x111b2c(0x260)]===!![]?_0x129baa=_0x111b2c(0x1ff):_0x129baa=_0x111b2c(0x23e);break;case _0x111b2c(0x241):_0x129baa=_0x111b2c(0x23e);break;case _0x111b2c(0x219):_0x129baa=_0x111b2c(0x1fd);break;case _0x111b2c(0x1f5):_0x129baa='FAILED';!_0x49bbb1&&_0x3c687c[_0x111b2c(0x21e)]?.[_0x111b2c(0x20c)]&&(_0x49bbb1=_0x3c687c['data'][_0x111b2c(0x20c)]);break;case'NEW':case _0x111b2c(0x242):default:_0x129baa=_0x111b2c(0x24a);break;}break;}const _0x5210ab={};return _0x3c687c[_0x111b2c(0x21e)]?.[_0x111b2c(0x25c)]?.[_0x111b2c(0x217)]&&(_0x5210ab['cardLast4']=_0x3c687c['data'][_0x111b2c(0x25c)][_0x111b2c(0x217)]),_0x3c687c[_0x111b2c(0x21e)]?.['payment_method_type']&&(_0x5210ab[_0x111b2c(0x1ec)]=_0x3c687c['data']['payment_method_type']),_0x3c687c[_0x111b2c(0x21e)]?.[_0x111b2c(0x227)]&&(_0x5210ab[_0x111b2c(0x24f)]=_0x3c687c['data'][_0x111b2c(0x227)]),_0x3c687c[_0x111b2c(0x21e)]?.[_0x111b2c(0x262)]&&(_0x5210ab['failureCode']=_0x3c687c[_0x111b2c(0x21e)]['failure_code']),console[_0x111b2c(0x23c)](_0x111b2c(0x1e3)+_0x129baa+',\x20failureMessage='+(_0x49bbb1||_0x111b2c(0x1ea))),{'paymentId':_0x3c687c['data']?.[_0x111b2c(0x232)]||'','status':_0x129baa,'amount':_0x3c687c[_0x111b2c(0x21e)]?.['amount'],'currency':_0x3c687c[_0x111b2c(0x21e)]?.[_0x111b2c(0x214)],'failureMessage':_0x49bbb1,'additionalInfo':_0x5210ab};}}function a63_0x525f(_0x10dde3,_0x59dea5){_0x10dde3=_0x10dde3-0x1e2;const _0x3d8b9e=a63_0x3d8b();let _0x525fd8=_0x3d8b9e[_0x10dde3];return _0x525fd8;}exports[a63_0x232fd9(0x258)]=RapydService;