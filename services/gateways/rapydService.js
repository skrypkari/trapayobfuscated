'use strict';const a52_0x2b4f1b=a52_0x38bf;(function(_0x3539e3,_0x39f988){const _0x1e2faf=a52_0x38bf,_0x59208d=_0x3539e3();while(!![]){try{const _0x6b6a8e=parseInt(_0x1e2faf(0x162))/0x1+parseInt(_0x1e2faf(0x158))/0x2+parseInt(_0x1e2faf(0x17c))/0x3+-parseInt(_0x1e2faf(0x190))/0x4+parseInt(_0x1e2faf(0x1a4))/0x5+parseInt(_0x1e2faf(0x154))/0x6+-parseInt(_0x1e2faf(0x138))/0x7;if(_0x6b6a8e===_0x39f988)break;else _0x59208d['push'](_0x59208d['shift']());}catch(_0x165f78){_0x59208d['push'](_0x59208d['shift']());}}}(a52_0x2c7e,0x7e6ea));Object[a52_0x2b4f1b(0x17a)](exports,'__esModule',{'value':!![]}),exports['RapydService']=void 0x0;const loggerService_1=require(a52_0x2b4f1b(0x1ae));class RapydService{constructor(){const _0x5e23fa=a52_0x2b4f1b;this[_0x5e23fa(0x1a5)]=_0x5e23fa(0x199),console[_0x5e23fa(0x198)](_0x5e23fa(0x18a));}async['createPaymentLink'](_0xe8a54){const _0x554b94=a52_0x2b4f1b,{orderId:_0x4ec64f,orderName:_0x181505,amount:_0x4ef14b,currency:_0x28279a,usage:_0x347dde,maxPayments:_0xcb8d8f,successUrl:_0x150404,failUrl:_0x1906b2}=_0xe8a54,_0x87148e=_0x28279a[_0x554b94(0x1b1)](),_0x592387='GB';console[_0x554b94(0x198)](_0x554b94(0x176));const _0x35374d=_0x554b94(0x196)+_0x4ec64f,_0xe1c18=_0x554b94(0x1a6)+_0x4ec64f,_0x13ea71={'amount':_0x4ef14b,'currency':_0x87148e,'cancel_checkout_url':_0xe1c18,'complete_checkout_url':_0x35374d,'complete_payment_url':_0x35374d,'merchant_reference_id':_0x4ec64f,'description':_0x554b94(0x13c)+_0x4ec64f,'country':'GB','payment_method_types_include':[_0x554b94(0x191),'gb_mastercard_card'],'custom_elements':{'display_description':!![]}};if(_0x87148e!=='EUR'){const _0x340fd2=Math[_0x554b94(0x15a)](Date[_0x554b94(0x1a3)]()/0x3e8)+0x1e*0x3c;_0x13ea71[_0x554b94(0x14a)]='buy',_0x13ea71[_0x554b94(0x187)]=_0x554b94(0x15c),_0x13ea71[_0x554b94(0x182)]=_0x340fd2,console[_0x554b94(0x198)]('💱\x20Adding\x20currency\x20conversion\x20fields\x20for\x20'+_0x87148e+'\x20->\x20EUR:'),console[_0x554b94(0x198)](_0x554b94(0x184)),console['log'](_0x554b94(0x17f)),console['log'](_0x554b94(0x17e)+_0x340fd2+'\x20('+new Date(_0x340fd2*0x3e8)[_0x554b94(0x147)]()+')');}const _0xcdbdea=Date['now']();try{console[_0x554b94(0x198)](_0x554b94(0x146)),console[_0x554b94(0x198)](_0x554b94(0x16e),this[_0x554b94(0x1a5)]),console[_0x554b94(0x198)](_0x554b94(0x180),JSON['stringify'](_0x13ea71,null,0x2)),console[_0x554b94(0x198)](_0x554b94(0x1a7)+_0x592387+_0x554b94(0x145)),console['log']('💳\x20Payment\x20Methods:\x20gb_visa_card,\x20gb_mastercard_card'),loggerService_1[_0x554b94(0x152)][_0x554b94(0x192)](_0x554b94(0x186),_0x554b94(0x166),_0x554b94(0x1a2),_0x13ea71);const _0x493e9c=await fetch(this[_0x554b94(0x1a5)],{'method':'POST','headers':{'Content-Type':'application/json','User-Agent':_0x554b94(0x159)},'body':JSON[_0x554b94(0x19b)](_0x13ea71)}),_0x243307=Date['now']()-_0xcdbdea;console[_0x554b94(0x198)](_0x554b94(0x15b)),console[_0x554b94(0x198)](_0x554b94(0x16a),_0x493e9c[_0x554b94(0x194)]),console[_0x554b94(0x198)]('Status\x20Text:',_0x493e9c[_0x554b94(0x1a8)]),console[_0x554b94(0x198)]('Headers:',Object[_0x554b94(0x18b)](_0x493e9c[_0x554b94(0x14d)]['entries']())),console[_0x554b94(0x198)](_0x554b94(0x181),_0x243307+'ms');const _0x238c76=await _0x493e9c[_0x554b94(0x14f)]();console[_0x554b94(0x198)](_0x554b94(0x141),_0x238c76);if(!_0x493e9c['ok']){console[_0x554b94(0x149)](_0x554b94(0x14e)),console[_0x554b94(0x149)](_0x554b94(0x144),_0x493e9c[_0x554b94(0x194)]),console[_0x554b94(0x149)](_0x554b94(0x1ac),_0x238c76),loggerService_1[_0x554b94(0x152)][_0x554b94(0x163)](_0x554b94(0x186),_0x554b94(0x166),_0x493e9c[_0x554b94(0x194)],_0x238c76,_0x243307),loggerService_1[_0x554b94(0x152)][_0x554b94(0x18c)]('rapyd',_0x554b94(0x166),_0x554b94(0x183)+_0x493e9c[_0x554b94(0x194)]+':\x20'+_0x238c76);throw new Error(_0x554b94(0x17d)+_0x493e9c['status']+',\x20body:\x20'+_0x238c76);}let _0x47d775;try{_0x47d775=JSON['parse'](_0x238c76);}catch(_0x5004e2){console[_0x554b94(0x149)](_0x554b94(0x171),_0x5004e2),loggerService_1['loggerService'][_0x554b94(0x18c)](_0x554b94(0x186),_0x554b94(0x166),'JSON\x20Parse\x20Error:\x20'+_0x5004e2);throw new Error(_0x554b94(0x18f)+_0x238c76);}console['log']('===\x20PARSED\x20RAPYD\x20RESPONSE\x20==='),console['log'](_0x554b94(0x150),JSON['stringify'](_0x47d775,null,0x2)),loggerService_1['loggerService'][_0x554b94(0x163)](_0x554b94(0x186),_0x554b94(0x166),_0x493e9c[_0x554b94(0x194)],_0x47d775,_0x243307);if(_0x47d775[_0x554b94(0x194)]?.[_0x554b94(0x194)]!==_0x554b94(0x14c)){const _0x4366a6=_0x47d775[_0x554b94(0x194)]?.[_0x554b94(0x137)]||_0x554b94(0x148),_0x576568=_0x47d775[_0x554b94(0x194)]?.['error_code']||_0x554b94(0x19d);console['error']('===\x20RAPYD\x20API\x20BUSINESS\x20ERROR\x20==='),console[_0x554b94(0x149)](_0x554b94(0x15d),_0x576568),console[_0x554b94(0x149)](_0x554b94(0x157),_0x4366a6),console[_0x554b94(0x149)](_0x554b94(0x155),_0x47d775[_0x554b94(0x194)]),loggerService_1['loggerService'][_0x554b94(0x18c)](_0x554b94(0x186),_0x554b94(0x166),_0x554b94(0x197)+_0x576568+'):\x20'+_0x4366a6);throw new Error(_0x554b94(0x15f)+_0x576568+_0x554b94(0x1a0)+_0x4366a6);}if(!_0x47d775[_0x554b94(0x19c)]?.['id']||!_0x47d775[_0x554b94(0x19c)]?.[_0x554b94(0x153)]){console['error'](_0x554b94(0x172)),console[_0x554b94(0x149)](_0x554b94(0x15e)),console[_0x554b94(0x149)](_0x554b94(0x18e),_0x47d775[_0x554b94(0x19c)]),loggerService_1[_0x554b94(0x152)][_0x554b94(0x18c)](_0x554b94(0x186),_0x554b94(0x166),'Incomplete\x20response:\x20missing\x20id\x20or\x20redirect_url');throw new Error(_0x554b94(0x177));}return console[_0x554b94(0x198)]('===\x20RAPYD\x20SUCCESS\x20==='),console[_0x554b94(0x198)](_0x554b94(0x1af),_0x47d775[_0x554b94(0x19c)]['id']),console[_0x554b94(0x198)](_0x554b94(0x13f),_0x47d775[_0x554b94(0x19c)][_0x554b94(0x153)]),console['log'](_0x554b94(0x174)+_0x592387+'\x20(GB\x20-\x20Britain)'),console['log'](_0x554b94(0x16c)),{'gateway_payment_id':_0x47d775[_0x554b94(0x19c)]['id'],'payment_url':_0x47d775[_0x554b94(0x19c)][_0x554b94(0x153)]};}catch(_0x4bc823){console['error']('===\x20RAPYD\x20SERVICE\x20ERROR\x20==='),console[_0x554b94(0x149)](_0x554b94(0x13e),_0x4bc823),loggerService_1['loggerService'][_0x554b94(0x18c)]('rapyd','/v1/hosted/payment_links',_0x4bc823);if(_0x4bc823 instanceof Error){console['error']('Error\x20message:',_0x4bc823['message']),console[_0x554b94(0x149)]('Error\x20stack:',_0x4bc823[_0x554b94(0x1aa)]);throw new Error(_0x554b94(0x19a)+_0x4bc823['message']);}throw new Error('Failed\x20to\x20create\x20Rapyd\x20payment\x20link:\x20Unknown\x20error');}}async[a52_0x2b4f1b(0x167)](_0x326b6a){const _0xd491fd=a52_0x2b4f1b,_0x5c9a8b=Date[_0xd491fd(0x1a3)]();try{loggerService_1['loggerService'][_0xd491fd(0x192)](_0xd491fd(0x186),'/v1/hosted/payment_links/'+_0x326b6a,'GET',{});const _0x2b63a9=await fetch(this[_0xd491fd(0x1a5)]+'/'+_0x326b6a,{'method':_0xd491fd(0x169),'headers':{'Content-Type':_0xd491fd(0x1a1),'User-Agent':'TesSoft\x20Payment\x20System/1.0'}}),_0x46e917=Date['now']()-_0x5c9a8b;if(!_0x2b63a9['ok']){const _0x5a03af=await _0x2b63a9[_0xd491fd(0x14f)]();loggerService_1[_0xd491fd(0x152)][_0xd491fd(0x163)]('rapyd','/v1/hosted/payment_links/'+_0x326b6a,_0x2b63a9[_0xd491fd(0x194)],_0x5a03af,_0x46e917);throw new Error(_0xd491fd(0x17d)+_0x2b63a9[_0xd491fd(0x194)]);}const _0x715fec=await _0x2b63a9[_0xd491fd(0x140)]();loggerService_1[_0xd491fd(0x152)][_0xd491fd(0x163)](_0xd491fd(0x186),_0xd491fd(0x16d)+_0x326b6a,_0x2b63a9[_0xd491fd(0x194)],_0x715fec,_0x46e917);if(_0x715fec[_0xd491fd(0x194)]?.[_0xd491fd(0x194)]!==_0xd491fd(0x14c)){loggerService_1[_0xd491fd(0x152)][_0xd491fd(0x18c)]('rapyd',_0xd491fd(0x16d)+_0x326b6a,'Rapyd\x20API\x20error:\x20'+(_0x715fec[_0xd491fd(0x194)]?.[_0xd491fd(0x137)]||_0xd491fd(0x170)));throw new Error('Rapyd\x20API\x20error:\x20'+(_0x715fec[_0xd491fd(0x194)]?.[_0xd491fd(0x137)]||_0xd491fd(0x170)));}let _0x442c55=_0xd491fd(0x16f);if(_0x715fec[_0xd491fd(0x19c)]?.[_0xd491fd(0x194)])switch(_0x715fec[_0xd491fd(0x19c)][_0xd491fd(0x194)]['toUpperCase']()){case _0xd491fd(0x13a):_0x442c55=_0xd491fd(0x1b0);break;case _0xd491fd(0x164):_0x442c55=_0xd491fd(0x151);break;case _0xd491fd(0x1ad):_0x442c55=_0xd491fd(0x143);break;case _0xd491fd(0x1a9):_0x442c55=_0xd491fd(0x151);break;case _0xd491fd(0x178):case'ACT':default:_0x442c55=_0xd491fd(0x16f);break;}return{'status':_0x442c55,'amount':_0x715fec['data']?.[_0xd491fd(0x175)],'currency':_0x715fec[_0xd491fd(0x19c)]?.['currency']};}catch(_0x235488){console[_0xd491fd(0x149)](_0xd491fd(0x17b),_0x235488),loggerService_1[_0xd491fd(0x152)]['logWhiteDomainError'](_0xd491fd(0x186),_0xd491fd(0x16d)+_0x326b6a,_0x235488);throw new Error(_0xd491fd(0x19f)+(_0x235488 instanceof Error?_0x235488[_0xd491fd(0x137)]:_0xd491fd(0x170)));}}async[a52_0x2b4f1b(0x165)](_0x2ead3c){const _0x1da2e7=a52_0x2b4f1b;console[_0x1da2e7(0x198)](_0x1da2e7(0x19e),_0x2ead3c);let _0xca16cc='PENDING',_0xca31c2;_0x2ead3c[_0x1da2e7(0x19c)]?.[_0x1da2e7(0x193)]&&(_0xca31c2=_0x2ead3c['data'][_0x1da2e7(0x193)],console[_0x1da2e7(0x198)]('💥\x20Rapyd\x20failure\x20message:\x20'+_0xca31c2));switch(_0x2ead3c[_0x1da2e7(0x13b)]?.[_0x1da2e7(0x1b1)]()){case _0x1da2e7(0x189):_0x2ead3c[_0x1da2e7(0x19c)]?.[_0x1da2e7(0x16b)]===!![]&&_0x2ead3c['data']?.['status']===_0x1da2e7(0x13a)?_0xca16cc=_0x1da2e7(0x1b0):_0xca16cc=_0x1da2e7(0x16f);break;case'PAYMENT_CANCELED':_0xca16cc=_0x1da2e7(0x151);break;case _0x1da2e7(0x168):_0xca16cc='EXPIRED';break;case'PAYMENT_FAILED':_0xca16cc=_0x1da2e7(0x151);!_0xca31c2&&_0x2ead3c[_0x1da2e7(0x19c)]?.[_0x1da2e7(0x193)]&&(_0xca31c2=_0x2ead3c['data'][_0x1da2e7(0x193)]);break;default:switch(_0x2ead3c[_0x1da2e7(0x19c)]?.[_0x1da2e7(0x194)]?.[_0x1da2e7(0x1b1)]()){case _0x1da2e7(0x13a):_0x2ead3c[_0x1da2e7(0x19c)]?.['paid']===!![]?_0xca16cc='PAID':_0xca16cc=_0x1da2e7(0x151);break;case _0x1da2e7(0x164):_0xca16cc=_0x1da2e7(0x151);break;case _0x1da2e7(0x1ad):_0xca16cc='EXPIRED';break;case'ERR':_0xca16cc=_0x1da2e7(0x151);!_0xca31c2&&_0x2ead3c[_0x1da2e7(0x19c)]?.['failure_message']&&(_0xca31c2=_0x2ead3c[_0x1da2e7(0x19c)][_0x1da2e7(0x193)]);break;case'NEW':case'ACT':default:_0xca16cc='PENDING';break;}break;}const _0x17bb56={};return _0x2ead3c[_0x1da2e7(0x19c)]?.[_0x1da2e7(0x13d)]?.[_0x1da2e7(0x156)]&&(_0x17bb56[_0x1da2e7(0x18d)]=_0x2ead3c['data'][_0x1da2e7(0x13d)][_0x1da2e7(0x156)]),_0x2ead3c['data']?.[_0x1da2e7(0x185)]&&(_0x17bb56[_0x1da2e7(0x139)]=_0x2ead3c[_0x1da2e7(0x19c)][_0x1da2e7(0x185)]),_0x2ead3c['data']?.[_0x1da2e7(0x188)]&&(_0x17bb56['errorCode']=_0x2ead3c[_0x1da2e7(0x19c)][_0x1da2e7(0x188)]),_0x2ead3c[_0x1da2e7(0x19c)]?.[_0x1da2e7(0x1ab)]&&(_0x17bb56[_0x1da2e7(0x195)]=_0x2ead3c[_0x1da2e7(0x19c)][_0x1da2e7(0x1ab)]),console['log'](_0x1da2e7(0x179)+_0xca16cc+_0x1da2e7(0x14b)+(_0xca31c2||_0x1da2e7(0x160))),{'paymentId':_0x2ead3c[_0x1da2e7(0x19c)]?.[_0x1da2e7(0x173)]||'','status':_0xca16cc,'amount':_0x2ead3c[_0x1da2e7(0x19c)]?.['amount'],'currency':_0x2ead3c[_0x1da2e7(0x19c)]?.[_0x1da2e7(0x161)],'failureMessage':_0xca31c2,'additionalInfo':_0x17bb56};}}function a52_0x2c7e(){const _0xd72a1f=['application/json','POST','now','809600arYAya','apiUrl','https://tesoft.uk/gateway/fail.php?id=','🇬🇧\x20Country:\x20','statusText','ERR','stack','failure_code','Response\x20Body:','EXP','../loggerService','Payment\x20Link\x20ID:','PAID','toUpperCase','message','4439827eKIIYf','paymentMethod','CLO','type','ORDER:\x20','payment_method_data','Error\x20details:','Redirect\x20URL:','json','Raw\x20Response\x20Body:','RapydService','EXPIRED','HTTP\x20Status:','\x20(always\x20GB\x20for\x20Rapyd)','===\x20RAPYD\x20API\x20REQUEST\x20(White\x20Domain\x20-\x20Updated\x20Format)\x20===','toISOString','Unknown\x20error\x20from\x20Rapyd\x20API','error','fixed_side',',\x20failureMessage=','SUCCESS','headers','===\x20RAPYD\x20API\x20ERROR\x20===','text','Parsed\x20Result:','FAILED','loggerService','redirect_url','1627698HtkYYF','Full\x20Error\x20Data:','last4','Error\x20Message:','568756iWFqrb','TesSoft\x20Payment\x20System/1.0','floor','===\x20RAPYD\x20API\x20RESPONSE\x20(White\x20Domain)\x20===','EUR','Error\x20Code:','Missing\x20id\x20or\x20redirect_url\x20in\x20response','Rapyd\x20API\x20error\x20(','none','currency','242818uPAWqY','logWhiteDomainResponse','CAN','processWebhook','/v1/hosted/payment_links','verifyPayment','PAYMENT_EXPIRED','GET','Status:','paid','💳\x20Payment\x20Methods:\x20gb_visa_card,\x20gb_mastercard_card','/v1/hosted/payment_links/','URL:','PENDING','Unknown\x20error','Failed\x20to\x20parse\x20JSON\x20response:','===\x20RAPYD\x20API\x20INCOMPLETE\x20RESPONSE\x20===','merchant_reference_id','🇬🇧\x20Country\x20used:\x20','amount','🇬🇧\x20Using\x20GB\x20(Britain)\x20as\x20country\x20for\x20Rapyd\x20payment\x20link','Invalid\x20response\x20from\x20Rapyd\x20API:\x20missing\x20id\x20or\x20redirect_url','NEW','🔄\x20Rapyd\x20webhook\x20processed:\x20status=','defineProperty','Rapyd\x20payment\x20verification\x20error:','777822QznFeL','HTTP\x20error!\x20status:\x20','\x20\x20\x20expiration:\x20','\x20\x20\x20requested_currency:\x20EUR','Request\x20Body\x20(Updated\x20Format):','Response\x20Time:','expiration','HTTP\x20','\x20\x20\x20fixed_side:\x20buy','payment_method_type','rapyd','requested_currency','error_code','PAYMENT_COMPLETED','🌐\x20Rapyd\x20service\x20initialized\x20with\x20white\x20domain\x20proxy','fromEntries','logWhiteDomainError','cardLast4','Response\x20data:','Invalid\x20JSON\x20response\x20from\x20Rapyd\x20API:\x20','270184mDbQRy','gb_visa_card','logWhiteDomainRequest','failure_message','status','failureCode','https://tesoft.uk/gateway/success.php?id=','Business\x20Error\x20(','log','https://tesoft.uk/gateway/rapyd/','Failed\x20to\x20create\x20Rapyd\x20payment\x20link:\x20','stringify','data','UNKNOWN','Processing\x20Rapyd\x20webhook:','Failed\x20to\x20verify\x20Rapyd\x20payment:\x20','):\x20'];a52_0x2c7e=function(){return _0xd72a1f;};return a52_0x2c7e();}function a52_0x38bf(_0x5c2db6,_0x5df002){const _0x2c7ebd=a52_0x2c7e();return a52_0x38bf=function(_0x38bf5c,_0x58f091){_0x38bf5c=_0x38bf5c-0x137;let _0x245816=_0x2c7ebd[_0x38bf5c];return _0x245816;},a52_0x38bf(_0x5c2db6,_0x5df002);}exports[a52_0x2b4f1b(0x142)]=RapydService;