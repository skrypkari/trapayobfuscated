'use strict';const a45_0x12a916=a45_0x3e76;(function(_0x39cff6,_0x7dd4da){const _0x3ec845=a45_0x3e76,_0x5aa6b5=_0x39cff6();while(!![]){try{const _0x8993a0=parseInt(_0x3ec845(0x99))/0x1*(parseInt(_0x3ec845(0x94))/0x2)+-parseInt(_0x3ec845(0x88))/0x3+parseInt(_0x3ec845(0xe3))/0x4*(parseInt(_0x3ec845(0xf0))/0x5)+-parseInt(_0x3ec845(0x84))/0x6+-parseInt(_0x3ec845(0x8f))/0x7*(parseInt(_0x3ec845(0xa3))/0x8)+-parseInt(_0x3ec845(0xb2))/0x9+parseInt(_0x3ec845(0xd6))/0xa;if(_0x8993a0===_0x7dd4da)break;else _0x5aa6b5['push'](_0x5aa6b5['shift']());}catch(_0x4fc083){_0x5aa6b5['push'](_0x5aa6b5['shift']());}}}(a45_0x2506,0x4c247));function a45_0x2506(){const _0xda3655=['247912DLcFVi','apiUrl','payment_method_data','Unknown\x20error','TesSoft\x20Payment\x20System/1.0','2SWKujZ','SUCCESS','üí•\x20Rapyd\x20failure\x20message:\x20','/v1/hosted/payment_links/',',\x20failureMessage=','83107SEjuKc','HTTP\x20error!\x20status:\x20','now','üí≥\x20Payment\x20Methods:\x20gb_visa_card,\x20gb_mastercard_card','Payment\x20Link\x20ID:','FAILED','Rapyd\x20API\x20error:\x20','/v1/hosted/payment_links','none','logWhiteDomainResponse','40pHQqLI','rapyd','URL:','üîÑ\x20Rapyd\x20webhook\x20processed:\x20status=','log','Missing\x20id\x20or\x20redirect_url\x20in\x20response','HTTP\x20','logWhiteDomainError','data','Response\x20data:','Full\x20Error\x20Data:','failureCode','Redirect\x20URL:','Error\x20Code:','EXP','1369017rjcmhq','https://tesoft.uk/gateway/rapyd/','JSON\x20Parse\x20Error:\x20','ERR','Response\x20Time:','text','Failed\x20to\x20create\x20Rapyd\x20payment\x20link:\x20','error','toUpperCase','Unknown\x20error\x20from\x20Rapyd\x20API','Invalid\x20response\x20from\x20Rapyd\x20API:\x20missing\x20id\x20or\x20redirect_url','error_code','Error\x20details:','amount','stringify','../loggerService','headers','Failed\x20to\x20parse\x20JSON\x20response:','PAID','paymentMethod','Status:','Response\x20Body:','POST','last4','type','status','https://tesoft.uk/gateway/success.php?id=','CAN','__esModule','statusText','https://tesoft.uk/gateway/fail.php?id=','PAYMENT_CANCELED','redirect_url','HTTP\x20Status:','PAYMENT_FAILED','üá¨üáß\x20Using\x20GB\x20(Britain)\x20as\x20country\x20for\x20Rapyd\x20payment\x20link','9376100XHWrsD','===\x20RAPYD\x20API\x20RESPONSE\x20(White\x20Domain)\x20===','stack','payment_method_type','\x20(always\x20GB\x20for\x20Rapyd)','cardLast4','GET','Processing\x20Rapyd\x20webhook:','üá¨üáß\x20Country\x20used:\x20','PENDING','failure_code','parse','NEW','4HZLGWJ','application/json','currency','RapydService','Headers:','Error\x20Message:','message','Raw\x20Response\x20Body:','===\x20RAPYD\x20API\x20REQUEST\x20(White\x20Domain\x20-\x20Updated\x20Format)\x20===','gb_mastercard_card','createPaymentLink','CLO','Rapyd\x20API\x20error\x20(','2203570AlfSEr','Error\x20stack:','failure_message','processWebhook','EXPIRED','Incomplete\x20response:\x20missing\x20id\x20or\x20redirect_url','logWhiteDomainRequest','Parsed\x20Result:','gb_visa_card','loggerService','verifyPayment','2420766BrSXdt','Business\x20Error\x20(','):\x20','Rapyd\x20payment\x20verification\x20error:','1250694RrxgsJ','ACT','entries','üá¨üáß\x20Country:\x20','üåê\x20Rapyd\x20service\x20initialized\x20with\x20white\x20domain\x20proxy','paid','PAYMENT_EXPIRED'];a45_0x2506=function(){return _0xda3655;};return a45_0x2506();}Object['defineProperty'](exports,a45_0x12a916(0xce),{'value':!![]}),exports[a45_0x12a916(0xe6)]=void 0x0;const loggerService_1=require(a45_0x12a916(0xc1));class RapydService{constructor(){const _0x24edad=a45_0x12a916;this[_0x24edad(0x90)]=_0x24edad(0xb3),console[_0x24edad(0xa7)](_0x24edad(0x8c));}async[a45_0x12a916(0xed)](_0x5c544a){const _0x4b4f87=a45_0x12a916,{orderId:_0x19dbc4,orderName:_0x41c0f7,amount:_0xbc5c89,currency:_0x52b8e5,usage:_0x6a5714,maxPayments:_0x47c0eb,successUrl:_0x4756ba,failUrl:_0x4e6166}=_0x5c544a,_0x5d84e9=_0x52b8e5['toUpperCase'](),_0x3d803a='GB';console[_0x4b4f87(0xa7)](_0x4b4f87(0xd5));const _0x534969=_0x4b4f87(0xcc)+_0x19dbc4,_0x212dc3=_0x4b4f87(0xd0)+_0x19dbc4,_0x575f80={'amount':_0xbc5c89,'currency':_0x5d84e9,'cancel_checkout_url':_0x212dc3,'complete_checkout_url':_0x534969,'complete_payment_url':_0x534969,'merchant_reference_id':_0x19dbc4,'description':'ORDER:\x20'+_0x19dbc4,'country':'GB','payment_method_types_include':[_0x4b4f87(0x81),_0x4b4f87(0xec)],'custom_elements':{'display_description':!![]}},_0x9940a0=Date[_0x4b4f87(0x9b)]();try{console[_0x4b4f87(0xa7)](_0x4b4f87(0xeb)),console[_0x4b4f87(0xa7)](_0x4b4f87(0xa5),this['apiUrl']),console[_0x4b4f87(0xa7)]('Request\x20Body\x20(Updated\x20Format):',JSON[_0x4b4f87(0xc0)](_0x575f80,null,0x2)),console[_0x4b4f87(0xa7)](_0x4b4f87(0x8b)+_0x3d803a+_0x4b4f87(0xda)),console['log'](_0x4b4f87(0x9c)),loggerService_1[_0x4b4f87(0x82)][_0x4b4f87(0x7f)]('rapyd',_0x4b4f87(0xa0),_0x4b4f87(0xc8),_0x575f80);const _0x1010d9=await fetch(this['apiUrl'],{'method':_0x4b4f87(0xc8),'headers':{'Content-Type':_0x4b4f87(0xe4),'User-Agent':'TesSoft\x20Payment\x20System/1.0'},'body':JSON[_0x4b4f87(0xc0)](_0x575f80)}),_0x330f6c=Date[_0x4b4f87(0x9b)]()-_0x9940a0;console[_0x4b4f87(0xa7)](_0x4b4f87(0xd7)),console[_0x4b4f87(0xa7)](_0x4b4f87(0xc6),_0x1010d9[_0x4b4f87(0xcb)]),console[_0x4b4f87(0xa7)]('Status\x20Text:',_0x1010d9[_0x4b4f87(0xcf)]),console[_0x4b4f87(0xa7)](_0x4b4f87(0xe7),Object['fromEntries'](_0x1010d9[_0x4b4f87(0xc2)][_0x4b4f87(0x8a)]())),console[_0x4b4f87(0xa7)](_0x4b4f87(0xb6),_0x330f6c+'ms');const _0x1938d4=await _0x1010d9[_0x4b4f87(0xb7)]();console[_0x4b4f87(0xa7)](_0x4b4f87(0xea),_0x1938d4);if(!_0x1010d9['ok']){console[_0x4b4f87(0xb9)]('===\x20RAPYD\x20API\x20ERROR\x20==='),console[_0x4b4f87(0xb9)](_0x4b4f87(0xd3),_0x1010d9['status']),console[_0x4b4f87(0xb9)](_0x4b4f87(0xc7),_0x1938d4),loggerService_1['loggerService']['logWhiteDomainResponse'](_0x4b4f87(0xa4),_0x4b4f87(0xa0),_0x1010d9['status'],_0x1938d4,_0x330f6c),loggerService_1[_0x4b4f87(0x82)][_0x4b4f87(0xaa)]('rapyd','/v1/hosted/payment_links',_0x4b4f87(0xa9)+_0x1010d9[_0x4b4f87(0xcb)]+':\x20'+_0x1938d4);throw new Error('HTTP\x20error!\x20status:\x20'+_0x1010d9[_0x4b4f87(0xcb)]+',\x20body:\x20'+_0x1938d4);}let _0x2eafa8;try{_0x2eafa8=JSON[_0x4b4f87(0xe1)](_0x1938d4);}catch(_0xc2151b){console[_0x4b4f87(0xb9)](_0x4b4f87(0xc3),_0xc2151b),loggerService_1[_0x4b4f87(0x82)][_0x4b4f87(0xaa)](_0x4b4f87(0xa4),_0x4b4f87(0xa0),_0x4b4f87(0xb4)+_0xc2151b);throw new Error('Invalid\x20JSON\x20response\x20from\x20Rapyd\x20API:\x20'+_0x1938d4);}console['log']('===\x20PARSED\x20RAPYD\x20RESPONSE\x20==='),console[_0x4b4f87(0xa7)](_0x4b4f87(0x80),JSON[_0x4b4f87(0xc0)](_0x2eafa8,null,0x2)),loggerService_1[_0x4b4f87(0x82)]['logWhiteDomainResponse']('rapyd','/v1/hosted/payment_links',_0x1010d9['status'],_0x2eafa8,_0x330f6c);if(_0x2eafa8[_0x4b4f87(0xcb)]?.[_0x4b4f87(0xcb)]!=='SUCCESS'){const _0x126bf6=_0x2eafa8[_0x4b4f87(0xcb)]?.[_0x4b4f87(0xe9)]||_0x4b4f87(0xbb),_0x2324dc=_0x2eafa8['status']?.[_0x4b4f87(0xbd)]||'UNKNOWN';console[_0x4b4f87(0xb9)]('===\x20RAPYD\x20API\x20BUSINESS\x20ERROR\x20==='),console[_0x4b4f87(0xb9)](_0x4b4f87(0xb0),_0x2324dc),console['error'](_0x4b4f87(0xe8),_0x126bf6),console[_0x4b4f87(0xb9)](_0x4b4f87(0xad),_0x2eafa8['status']),loggerService_1[_0x4b4f87(0x82)][_0x4b4f87(0xaa)](_0x4b4f87(0xa4),_0x4b4f87(0xa0),_0x4b4f87(0x85)+_0x2324dc+_0x4b4f87(0x86)+_0x126bf6);throw new Error(_0x4b4f87(0xef)+_0x2324dc+_0x4b4f87(0x86)+_0x126bf6);}if(!_0x2eafa8['data']?.['id']||!_0x2eafa8[_0x4b4f87(0xab)]?.['redirect_url']){console['error']('===\x20RAPYD\x20API\x20INCOMPLETE\x20RESPONSE\x20==='),console['error'](_0x4b4f87(0xa8)),console[_0x4b4f87(0xb9)](_0x4b4f87(0xac),_0x2eafa8[_0x4b4f87(0xab)]),loggerService_1[_0x4b4f87(0x82)][_0x4b4f87(0xaa)](_0x4b4f87(0xa4),_0x4b4f87(0xa0),_0x4b4f87(0xf5));throw new Error(_0x4b4f87(0xbc));}return console['log']('===\x20RAPYD\x20SUCCESS\x20==='),console[_0x4b4f87(0xa7)](_0x4b4f87(0x9d),_0x2eafa8[_0x4b4f87(0xab)]['id']),console[_0x4b4f87(0xa7)](_0x4b4f87(0xaf),_0x2eafa8[_0x4b4f87(0xab)]['redirect_url']),console[_0x4b4f87(0xa7)](_0x4b4f87(0xde)+_0x3d803a+'\x20(GB\x20-\x20Britain)'),console['log'](_0x4b4f87(0x9c)),{'gateway_payment_id':_0x2eafa8['data']['id'],'payment_url':_0x2eafa8[_0x4b4f87(0xab)][_0x4b4f87(0xd2)]};}catch(_0x4ecc75){console[_0x4b4f87(0xb9)]('===\x20RAPYD\x20SERVICE\x20ERROR\x20==='),console['error'](_0x4b4f87(0xbe),_0x4ecc75),loggerService_1['loggerService'][_0x4b4f87(0xaa)](_0x4b4f87(0xa4),'/v1/hosted/payment_links',_0x4ecc75);if(_0x4ecc75 instanceof Error){console['error']('Error\x20message:',_0x4ecc75[_0x4b4f87(0xe9)]),console[_0x4b4f87(0xb9)](_0x4b4f87(0xf1),_0x4ecc75[_0x4b4f87(0xd8)]);throw new Error(_0x4b4f87(0xb8)+_0x4ecc75[_0x4b4f87(0xe9)]);}throw new Error('Failed\x20to\x20create\x20Rapyd\x20payment\x20link:\x20Unknown\x20error');}}async[a45_0x12a916(0x83)](_0x2546f2){const _0x69f9c0=a45_0x12a916,_0x54d1b9=Date[_0x69f9c0(0x9b)]();try{loggerService_1[_0x69f9c0(0x82)]['logWhiteDomainRequest'](_0x69f9c0(0xa4),'/v1/hosted/payment_links/'+_0x2546f2,_0x69f9c0(0xdc),{});const _0x205e02=await fetch(this[_0x69f9c0(0x90)]+'/'+_0x2546f2,{'method':_0x69f9c0(0xdc),'headers':{'Content-Type':_0x69f9c0(0xe4),'User-Agent':_0x69f9c0(0x93)}}),_0x404f7b=Date[_0x69f9c0(0x9b)]()-_0x54d1b9;if(!_0x205e02['ok']){const _0x3c2a87=await _0x205e02[_0x69f9c0(0xb7)]();loggerService_1[_0x69f9c0(0x82)][_0x69f9c0(0xa2)]('rapyd','/v1/hosted/payment_links/'+_0x2546f2,_0x205e02[_0x69f9c0(0xcb)],_0x3c2a87,_0x404f7b);throw new Error(_0x69f9c0(0x9a)+_0x205e02[_0x69f9c0(0xcb)]);}const _0x3207bd=await _0x205e02['json']();loggerService_1[_0x69f9c0(0x82)][_0x69f9c0(0xa2)]('rapyd','/v1/hosted/payment_links/'+_0x2546f2,_0x205e02[_0x69f9c0(0xcb)],_0x3207bd,_0x404f7b);if(_0x3207bd[_0x69f9c0(0xcb)]?.['status']!==_0x69f9c0(0x95)){loggerService_1[_0x69f9c0(0x82)]['logWhiteDomainError'](_0x69f9c0(0xa4),_0x69f9c0(0x97)+_0x2546f2,_0x69f9c0(0x9f)+(_0x3207bd[_0x69f9c0(0xcb)]?.['message']||_0x69f9c0(0x92)));throw new Error(_0x69f9c0(0x9f)+(_0x3207bd[_0x69f9c0(0xcb)]?.[_0x69f9c0(0xe9)]||_0x69f9c0(0x92)));}let _0x44268a=_0x69f9c0(0xdf);if(_0x3207bd[_0x69f9c0(0xab)]?.['status'])switch(_0x3207bd['data'][_0x69f9c0(0xcb)]['toUpperCase']()){case _0x69f9c0(0xee):_0x44268a=_0x69f9c0(0xc4);break;case _0x69f9c0(0xcd):_0x44268a=_0x69f9c0(0x9e);break;case _0x69f9c0(0xb1):_0x44268a=_0x69f9c0(0xf4);break;case _0x69f9c0(0xb5):_0x44268a=_0x69f9c0(0x9e);break;case'NEW':case _0x69f9c0(0x89):default:_0x44268a=_0x69f9c0(0xdf);break;}return{'status':_0x44268a,'amount':_0x3207bd['data']?.[_0x69f9c0(0xbf)],'currency':_0x3207bd['data']?.[_0x69f9c0(0xe5)]};}catch(_0x5cef38){console[_0x69f9c0(0xb9)](_0x69f9c0(0x87),_0x5cef38),loggerService_1[_0x69f9c0(0x82)][_0x69f9c0(0xaa)](_0x69f9c0(0xa4),_0x69f9c0(0x97)+_0x2546f2,_0x5cef38);throw new Error('Failed\x20to\x20verify\x20Rapyd\x20payment:\x20'+(_0x5cef38 instanceof Error?_0x5cef38[_0x69f9c0(0xe9)]:_0x69f9c0(0x92)));}}async[a45_0x12a916(0xf3)](_0x4fb731){const _0x2b4e95=a45_0x12a916;console[_0x2b4e95(0xa7)](_0x2b4e95(0xdd),_0x4fb731);let _0x4bd6b1=_0x2b4e95(0xdf),_0x3dce1e;_0x4fb731[_0x2b4e95(0xab)]?.[_0x2b4e95(0xf2)]&&(_0x3dce1e=_0x4fb731[_0x2b4e95(0xab)]['failure_message'],console[_0x2b4e95(0xa7)](_0x2b4e95(0x96)+_0x3dce1e));switch(_0x4fb731[_0x2b4e95(0xca)]?.[_0x2b4e95(0xba)]()){case'PAYMENT_COMPLETED':_0x4fb731[_0x2b4e95(0xab)]?.[_0x2b4e95(0x8d)]===!![]&&_0x4fb731['data']?.['status']===_0x2b4e95(0xee)?_0x4bd6b1='PAID':_0x4bd6b1='PENDING';break;case _0x2b4e95(0xd1):_0x4bd6b1=_0x2b4e95(0x9e);break;case _0x2b4e95(0x8e):_0x4bd6b1=_0x2b4e95(0xf4);break;case _0x2b4e95(0xd4):_0x4bd6b1=_0x2b4e95(0x9e);!_0x3dce1e&&_0x4fb731[_0x2b4e95(0xab)]?.[_0x2b4e95(0xf2)]&&(_0x3dce1e=_0x4fb731[_0x2b4e95(0xab)][_0x2b4e95(0xf2)]);break;default:switch(_0x4fb731['data']?.[_0x2b4e95(0xcb)]?.['toUpperCase']()){case'CLO':_0x4fb731[_0x2b4e95(0xab)]?.['paid']===!![]?_0x4bd6b1=_0x2b4e95(0xc4):_0x4bd6b1='FAILED';break;case'CAN':_0x4bd6b1=_0x2b4e95(0x9e);break;case _0x2b4e95(0xb1):_0x4bd6b1=_0x2b4e95(0xf4);break;case _0x2b4e95(0xb5):_0x4bd6b1=_0x2b4e95(0x9e);!_0x3dce1e&&_0x4fb731[_0x2b4e95(0xab)]?.[_0x2b4e95(0xf2)]&&(_0x3dce1e=_0x4fb731[_0x2b4e95(0xab)][_0x2b4e95(0xf2)]);break;case _0x2b4e95(0xe2):case'ACT':default:_0x4bd6b1='PENDING';break;}break;}const _0x1c3fd7={};return _0x4fb731[_0x2b4e95(0xab)]?.[_0x2b4e95(0x91)]?.['last4']&&(_0x1c3fd7[_0x2b4e95(0xdb)]=_0x4fb731[_0x2b4e95(0xab)][_0x2b4e95(0x91)][_0x2b4e95(0xc9)]),_0x4fb731['data']?.[_0x2b4e95(0xd9)]&&(_0x1c3fd7[_0x2b4e95(0xc5)]=_0x4fb731['data'][_0x2b4e95(0xd9)]),_0x4fb731[_0x2b4e95(0xab)]?.[_0x2b4e95(0xbd)]&&(_0x1c3fd7['errorCode']=_0x4fb731[_0x2b4e95(0xab)][_0x2b4e95(0xbd)]),_0x4fb731[_0x2b4e95(0xab)]?.[_0x2b4e95(0xe0)]&&(_0x1c3fd7[_0x2b4e95(0xae)]=_0x4fb731[_0x2b4e95(0xab)]['failure_code']),console[_0x2b4e95(0xa7)](_0x2b4e95(0xa6)+_0x4bd6b1+_0x2b4e95(0x98)+(_0x3dce1e||_0x2b4e95(0xa1))),{'paymentId':_0x4fb731[_0x2b4e95(0xab)]?.['merchant_reference_id']||'','status':_0x4bd6b1,'amount':_0x4fb731[_0x2b4e95(0xab)]?.['amount'],'currency':_0x4fb731[_0x2b4e95(0xab)]?.[_0x2b4e95(0xe5)],'failureMessage':_0x3dce1e,'additionalInfo':_0x1c3fd7};}}function a45_0x3e76(_0x5a629a,_0x59add1){const _0x250643=a45_0x2506();return a45_0x3e76=function(_0x3e76fa,_0x1aab9f){_0x3e76fa=_0x3e76fa-0x7f;let _0xa59cb=_0x250643[_0x3e76fa];return _0xa59cb;},a45_0x3e76(_0x5a629a,_0x59add1);}exports[a45_0x12a916(0xe6)]=RapydService;