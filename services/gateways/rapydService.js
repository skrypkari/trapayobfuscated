'use strict';const a48_0x377c35=a48_0x5905;(function(_0xf2d312,_0x3231a3){const _0xb5cbec=a48_0x5905,_0x1fc30b=_0xf2d312();while(!![]){try{const _0x494686=parseInt(_0xb5cbec(0x1ec))/0x1*(-parseInt(_0xb5cbec(0x1ad))/0x2)+-parseInt(_0xb5cbec(0x1e6))/0x3*(parseInt(_0xb5cbec(0x1e3))/0x4)+parseInt(_0xb5cbec(0x1c6))/0x5+parseInt(_0xb5cbec(0x1ac))/0x6*(parseInt(_0xb5cbec(0x217))/0x7)+-parseInt(_0xb5cbec(0x1ca))/0x8+parseInt(_0xb5cbec(0x1c4))/0x9*(-parseInt(_0xb5cbec(0x214))/0xa)+-parseInt(_0xb5cbec(0x1cb))/0xb*(-parseInt(_0xb5cbec(0x1af))/0xc);if(_0x494686===_0x3231a3)break;else _0x1fc30b['push'](_0x1fc30b['shift']());}catch(_0x1bf2db){_0x1fc30b['push'](_0x1fc30b['shift']());}}}(a48_0x141a,0x2806f));function a48_0x141a(){const _0x239715=['4GKPPJm','apiUrl','40428KFUUgt','verifyPayment','Headers:','Unknown\x20error\x20from\x20Rapyd\x20API','data','PAYMENT_CANCELED','toUpperCase','FAILED','===\x20RAPYD\x20SUCCESS\x20===','Processing\x20Rapyd\x20webhook:','loggerService','PENDING','HTTP\x20error!\x20status:\x20','Rapyd\x20API\x20error:\x20','currency','NEW','):\x20','paid','PAYMENT_COMPLETED','SUCCESS','ORDER:\x20','63QVCKLA','Invalid\x20JSON\x20response\x20from\x20Rapyd\x20API:\x20','285405AOxByQ','failure_code','EXP','/v1/hosted/payment_links/','2191344kVUUlb','2475EVsONi','TesSoft\x20Payment\x20System/1.0','Failed\x20to\x20parse\x20JSON\x20response:','EXPIRED','buy','\x20->\x20EUR:','entries','PAID','gb_visa_card','Business\x20Error\x20(','CAN','text','\x20\x20\x20fixed_side:\x20buy','logWhiteDomainRequest','requested_currency','failure_message','gb_mastercard_card','fromEntries','logWhiteDomainResponse','Invalid\x20response\x20from\x20Rapyd\x20API:\x20missing\x20id\x20or\x20redirect_url','URL:','\x20(always\x20GB\x20for\x20Rapyd)','Request\x20Body\x20(Updated\x20Format):','HTTP\x20Status:','1263112XkdMcg','\x20\x20\x20expiration:\x20','EUR','3ljWpKG','Error\x20Code:','Rapyd\x20API\x20error\x20(','===\x20RAPYD\x20API\x20INCOMPLETE\x20RESPONSE\x20===','fixed_side','error_code','97397SgcVKD','defineProperty','last4','status','CLO','===\x20PARSED\x20RAPYD\x20RESPONSE\x20===','rapyd','üåê\x20Rapyd\x20service\x20initialized\x20with\x20white\x20domain\x20proxy','/v1/hosted/payment_links','Error\x20stack:','failureCode','Error\x20details:','processWebhook','PAYMENT_FAILED','parse','statusText','Full\x20Error\x20Data:','üá¨üáß\x20Country:\x20','GET','ERR','none','Incomplete\x20response:\x20missing\x20id\x20or\x20redirect_url','https://tesoft.uk/gateway/fail.php?id=','Status:','üí±\x20Adding\x20currency\x20conversion\x20fields\x20for\x20','HTTP\x20',',\x20failureMessage=','errorCode',',\x20body:\x20','stack','Error\x20Message:','redirect_url','https://tesoft.uk/gateway/success.php?id=','üí•\x20Rapyd\x20failure\x20message:\x20','PAYMENT_EXPIRED','log','logWhiteDomainError','error','üí≥\x20Payment\x20Methods:\x20gb_visa_card,\x20gb_mastercard_card','now','17770QJdAns','ACT','stringify','161aYbHbN','Failed\x20to\x20create\x20Rapyd\x20payment\x20link:\x20Unknown\x20error','merchant_reference_id','createPaymentLink','message','https://tesoft.uk/gateway/rapyd/','cardLast4','Missing\x20id\x20or\x20redirect_url\x20in\x20response','../loggerService','application/json','Error\x20message:','amount','\x20(GB\x20-\x20Britain)','Response\x20data:','===\x20RAPYD\x20API\x20BUSINESS\x20ERROR\x20===','payment_method_type','Parsed\x20Result:','POST','Failed\x20to\x20verify\x20Rapyd\x20payment:\x20','38028WCUIyR'];a48_0x141a=function(){return _0x239715;};return a48_0x141a();}function a48_0x5905(_0x2329d1,_0x49e0e2){const _0x141a6d=a48_0x141a();return a48_0x5905=function(_0x590570,_0x1cdb34){_0x590570=_0x590570-0x1ac;let _0x4f5ed5=_0x141a6d[_0x590570];return _0x4f5ed5;},a48_0x5905(_0x2329d1,_0x49e0e2);}Object[a48_0x377c35(0x1ed)](exports,'__esModule',{'value':!![]}),exports['RapydService']=void 0x0;const loggerService_1=require(a48_0x377c35(0x21f));class RapydService{constructor(){const _0x30e8fe=a48_0x377c35;this[_0x30e8fe(0x1ae)]=_0x30e8fe(0x21c),console[_0x30e8fe(0x20f)](_0x30e8fe(0x1f3));}async[a48_0x377c35(0x21a)](_0x30e50b){const _0x5b412d=a48_0x377c35,{orderId:_0x19b4e9,orderName:_0x17901b,amount:_0x13f58d,currency:_0x6554d0,usage:_0x45911c,maxPayments:_0xb2b3b8,successUrl:_0x3dd637,failUrl:_0x14edba}=_0x30e50b,_0x4adc19=_0x6554d0[_0x5b412d(0x1b5)](),_0x49cbeb='GB';console['log']('üá¨üáß\x20Using\x20GB\x20(Britain)\x20as\x20country\x20for\x20Rapyd\x20payment\x20link');const _0x4cfc15=_0x5b412d(0x20c)+_0x19b4e9,_0x523019=_0x5b412d(0x202)+_0x19b4e9,_0x4a5741={'amount':_0x13f58d,'currency':_0x4adc19,'cancel_checkout_url':_0x523019,'complete_checkout_url':_0x4cfc15,'complete_payment_url':_0x4cfc15,'merchant_reference_id':_0x19b4e9,'description':_0x5b412d(0x1c3)+_0x19b4e9,'country':'GB','payment_method_types_include':[_0x5b412d(0x1d3),_0x5b412d(0x1db)],'custom_elements':{'display_description':!![]}};if(_0x4adc19!==_0x5b412d(0x1e5)){const _0x3f0ba1=Math['floor'](Date['now']()/0x3e8)+0x1e*0x3c;_0x4a5741[_0x5b412d(0x1ea)]=_0x5b412d(0x1cf),_0x4a5741[_0x5b412d(0x1d9)]='EUR',_0x4a5741['expiration']=_0x3f0ba1,console['log'](_0x5b412d(0x204)+_0x4adc19+_0x5b412d(0x1d0)),console[_0x5b412d(0x20f)](_0x5b412d(0x1d7)),console[_0x5b412d(0x20f)]('\x20\x20\x20requested_currency:\x20EUR'),console['log'](_0x5b412d(0x1e4)+_0x3f0ba1+'\x20('+new Date(_0x3f0ba1*0x3e8)['toISOString']()+')');}const _0x426a35=Date[_0x5b412d(0x213)]();try{console[_0x5b412d(0x20f)]('===\x20RAPYD\x20API\x20REQUEST\x20(White\x20Domain\x20-\x20Updated\x20Format)\x20==='),console[_0x5b412d(0x20f)](_0x5b412d(0x1df),this[_0x5b412d(0x1ae)]),console['log'](_0x5b412d(0x1e1),JSON['stringify'](_0x4a5741,null,0x2)),console[_0x5b412d(0x20f)](_0x5b412d(0x1fd)+_0x49cbeb+_0x5b412d(0x1e0)),console[_0x5b412d(0x20f)](_0x5b412d(0x212)),loggerService_1[_0x5b412d(0x1b9)][_0x5b412d(0x1d8)](_0x5b412d(0x1f2),'/v1/hosted/payment_links',_0x5b412d(0x228),_0x4a5741);const _0x1b1d1a=await fetch(this[_0x5b412d(0x1ae)],{'method':'POST','headers':{'Content-Type':_0x5b412d(0x220),'User-Agent':_0x5b412d(0x1cc)},'body':JSON[_0x5b412d(0x216)](_0x4a5741)}),_0x26f83f=Date[_0x5b412d(0x213)]()-_0x426a35;console[_0x5b412d(0x20f)]('===\x20RAPYD\x20API\x20RESPONSE\x20(White\x20Domain)\x20==='),console[_0x5b412d(0x20f)](_0x5b412d(0x203),_0x1b1d1a['status']),console[_0x5b412d(0x20f)]('Status\x20Text:',_0x1b1d1a[_0x5b412d(0x1fb)]),console['log'](_0x5b412d(0x1b1),Object[_0x5b412d(0x1dc)](_0x1b1d1a['headers'][_0x5b412d(0x1d1)]())),console[_0x5b412d(0x20f)]('Response\x20Time:',_0x26f83f+'ms');const _0x4868c1=await _0x1b1d1a[_0x5b412d(0x1d6)]();console[_0x5b412d(0x20f)]('Raw\x20Response\x20Body:',_0x4868c1);if(!_0x1b1d1a['ok']){console['error']('===\x20RAPYD\x20API\x20ERROR\x20==='),console[_0x5b412d(0x211)](_0x5b412d(0x1e2),_0x1b1d1a[_0x5b412d(0x1ef)]),console[_0x5b412d(0x211)]('Response\x20Body:',_0x4868c1),loggerService_1[_0x5b412d(0x1b9)]['logWhiteDomainResponse'](_0x5b412d(0x1f2),_0x5b412d(0x1f4),_0x1b1d1a[_0x5b412d(0x1ef)],_0x4868c1,_0x26f83f),loggerService_1[_0x5b412d(0x1b9)][_0x5b412d(0x210)]('rapyd',_0x5b412d(0x1f4),_0x5b412d(0x205)+_0x1b1d1a[_0x5b412d(0x1ef)]+':\x20'+_0x4868c1);throw new Error('HTTP\x20error!\x20status:\x20'+_0x1b1d1a[_0x5b412d(0x1ef)]+_0x5b412d(0x208)+_0x4868c1);}let _0x355d3a;try{_0x355d3a=JSON[_0x5b412d(0x1fa)](_0x4868c1);}catch(_0x55109a){console[_0x5b412d(0x211)](_0x5b412d(0x1cd),_0x55109a),loggerService_1[_0x5b412d(0x1b9)][_0x5b412d(0x210)](_0x5b412d(0x1f2),_0x5b412d(0x1f4),'JSON\x20Parse\x20Error:\x20'+_0x55109a);throw new Error(_0x5b412d(0x1c5)+_0x4868c1);}console['log'](_0x5b412d(0x1f1)),console[_0x5b412d(0x20f)](_0x5b412d(0x227),JSON[_0x5b412d(0x216)](_0x355d3a,null,0x2)),loggerService_1[_0x5b412d(0x1b9)]['logWhiteDomainResponse']('rapyd',_0x5b412d(0x1f4),_0x1b1d1a[_0x5b412d(0x1ef)],_0x355d3a,_0x26f83f);if(_0x355d3a['status']?.[_0x5b412d(0x1ef)]!=='SUCCESS'){const _0x21664a=_0x355d3a['status']?.[_0x5b412d(0x21b)]||_0x5b412d(0x1b2),_0x59e143=_0x355d3a[_0x5b412d(0x1ef)]?.['error_code']||'UNKNOWN';console['error'](_0x5b412d(0x225)),console['error'](_0x5b412d(0x1e7),_0x59e143),console['error'](_0x5b412d(0x20a),_0x21664a),console[_0x5b412d(0x211)](_0x5b412d(0x1fc),_0x355d3a[_0x5b412d(0x1ef)]),loggerService_1[_0x5b412d(0x1b9)]['logWhiteDomainError']('rapyd',_0x5b412d(0x1f4),_0x5b412d(0x1d4)+_0x59e143+'):\x20'+_0x21664a);throw new Error(_0x5b412d(0x1e8)+_0x59e143+_0x5b412d(0x1bf)+_0x21664a);}if(!_0x355d3a['data']?.['id']||!_0x355d3a[_0x5b412d(0x1b3)]?.[_0x5b412d(0x20b)]){console[_0x5b412d(0x211)](_0x5b412d(0x1e9)),console['error'](_0x5b412d(0x21e)),console['error'](_0x5b412d(0x224),_0x355d3a[_0x5b412d(0x1b3)]),loggerService_1['loggerService'][_0x5b412d(0x210)](_0x5b412d(0x1f2),'/v1/hosted/payment_links',_0x5b412d(0x201));throw new Error(_0x5b412d(0x1de));}return console[_0x5b412d(0x20f)](_0x5b412d(0x1b7)),console['log']('Payment\x20Link\x20ID:',_0x355d3a['data']['id']),console['log']('Redirect\x20URL:',_0x355d3a[_0x5b412d(0x1b3)][_0x5b412d(0x20b)]),console[_0x5b412d(0x20f)]('üá¨üáß\x20Country\x20used:\x20'+_0x49cbeb+_0x5b412d(0x223)),console[_0x5b412d(0x20f)]('üí≥\x20Payment\x20Methods:\x20gb_visa_card,\x20gb_mastercard_card'),{'gateway_payment_id':_0x355d3a['data']['id'],'payment_url':_0x355d3a[_0x5b412d(0x1b3)][_0x5b412d(0x20b)]};}catch(_0x1d3ea7){console[_0x5b412d(0x211)]('===\x20RAPYD\x20SERVICE\x20ERROR\x20==='),console[_0x5b412d(0x211)](_0x5b412d(0x1f7),_0x1d3ea7),loggerService_1[_0x5b412d(0x1b9)][_0x5b412d(0x210)](_0x5b412d(0x1f2),'/v1/hosted/payment_links',_0x1d3ea7);if(_0x1d3ea7 instanceof Error){console['error'](_0x5b412d(0x221),_0x1d3ea7[_0x5b412d(0x21b)]),console['error'](_0x5b412d(0x1f5),_0x1d3ea7[_0x5b412d(0x209)]);throw new Error('Failed\x20to\x20create\x20Rapyd\x20payment\x20link:\x20'+_0x1d3ea7[_0x5b412d(0x21b)]);}throw new Error(_0x5b412d(0x218));}}async[a48_0x377c35(0x1b0)](_0x3e688d){const _0x1f12ed=a48_0x377c35,_0x59b69a=Date[_0x1f12ed(0x213)]();try{loggerService_1[_0x1f12ed(0x1b9)][_0x1f12ed(0x1d8)](_0x1f12ed(0x1f2),_0x1f12ed(0x1c9)+_0x3e688d,'GET',{});const _0x143d62=await fetch(this[_0x1f12ed(0x1ae)]+'/'+_0x3e688d,{'method':_0x1f12ed(0x1fe),'headers':{'Content-Type':_0x1f12ed(0x220),'User-Agent':'TesSoft\x20Payment\x20System/1.0'}}),_0x36ad3f=Date[_0x1f12ed(0x213)]()-_0x59b69a;if(!_0x143d62['ok']){const _0xb35504=await _0x143d62[_0x1f12ed(0x1d6)]();loggerService_1[_0x1f12ed(0x1b9)]['logWhiteDomainResponse'](_0x1f12ed(0x1f2),_0x1f12ed(0x1c9)+_0x3e688d,_0x143d62[_0x1f12ed(0x1ef)],_0xb35504,_0x36ad3f);throw new Error(_0x1f12ed(0x1bb)+_0x143d62[_0x1f12ed(0x1ef)]);}const _0x1fc834=await _0x143d62['json']();loggerService_1[_0x1f12ed(0x1b9)][_0x1f12ed(0x1dd)](_0x1f12ed(0x1f2),_0x1f12ed(0x1c9)+_0x3e688d,_0x143d62[_0x1f12ed(0x1ef)],_0x1fc834,_0x36ad3f);if(_0x1fc834[_0x1f12ed(0x1ef)]?.['status']!==_0x1f12ed(0x1c2)){loggerService_1['loggerService'][_0x1f12ed(0x210)](_0x1f12ed(0x1f2),_0x1f12ed(0x1c9)+_0x3e688d,'Rapyd\x20API\x20error:\x20'+(_0x1fc834[_0x1f12ed(0x1ef)]?.[_0x1f12ed(0x21b)]||'Unknown\x20error'));throw new Error(_0x1f12ed(0x1bc)+(_0x1fc834[_0x1f12ed(0x1ef)]?.[_0x1f12ed(0x21b)]||'Unknown\x20error'));}let _0x5ea7c4=_0x1f12ed(0x1ba);if(_0x1fc834[_0x1f12ed(0x1b3)]?.['status'])switch(_0x1fc834[_0x1f12ed(0x1b3)]['status'][_0x1f12ed(0x1b5)]()){case _0x1f12ed(0x1f0):_0x5ea7c4=_0x1f12ed(0x1d2);break;case _0x1f12ed(0x1d5):_0x5ea7c4='FAILED';break;case _0x1f12ed(0x1c8):_0x5ea7c4=_0x1f12ed(0x1ce);break;case _0x1f12ed(0x1ff):_0x5ea7c4=_0x1f12ed(0x1b6);break;case _0x1f12ed(0x1be):case _0x1f12ed(0x215):default:_0x5ea7c4=_0x1f12ed(0x1ba);break;}return{'status':_0x5ea7c4,'amount':_0x1fc834[_0x1f12ed(0x1b3)]?.[_0x1f12ed(0x222)],'currency':_0x1fc834[_0x1f12ed(0x1b3)]?.[_0x1f12ed(0x1bd)]};}catch(_0xcd60f6){console[_0x1f12ed(0x211)]('Rapyd\x20payment\x20verification\x20error:',_0xcd60f6),loggerService_1[_0x1f12ed(0x1b9)]['logWhiteDomainError']('rapyd',_0x1f12ed(0x1c9)+_0x3e688d,_0xcd60f6);throw new Error(_0x1f12ed(0x229)+(_0xcd60f6 instanceof Error?_0xcd60f6[_0x1f12ed(0x21b)]:'Unknown\x20error'));}}async[a48_0x377c35(0x1f8)](_0x327d21){const _0xc1cf47=a48_0x377c35;console[_0xc1cf47(0x20f)](_0xc1cf47(0x1b8),_0x327d21);let _0x4f2dc8=_0xc1cf47(0x1ba),_0x11c84f;_0x327d21['data']?.['failure_message']&&(_0x11c84f=_0x327d21[_0xc1cf47(0x1b3)][_0xc1cf47(0x1da)],console[_0xc1cf47(0x20f)](_0xc1cf47(0x20d)+_0x11c84f));switch(_0x327d21['type']?.[_0xc1cf47(0x1b5)]()){case _0xc1cf47(0x1c1):_0x327d21[_0xc1cf47(0x1b3)]?.[_0xc1cf47(0x1c0)]===!![]&&_0x327d21['data']?.[_0xc1cf47(0x1ef)]===_0xc1cf47(0x1f0)?_0x4f2dc8='PAID':_0x4f2dc8=_0xc1cf47(0x1ba);break;case _0xc1cf47(0x1b4):_0x4f2dc8=_0xc1cf47(0x1b6);break;case _0xc1cf47(0x20e):_0x4f2dc8=_0xc1cf47(0x1ce);break;case _0xc1cf47(0x1f9):_0x4f2dc8=_0xc1cf47(0x1b6);!_0x11c84f&&_0x327d21['data']?.[_0xc1cf47(0x1da)]&&(_0x11c84f=_0x327d21[_0xc1cf47(0x1b3)][_0xc1cf47(0x1da)]);break;default:switch(_0x327d21[_0xc1cf47(0x1b3)]?.[_0xc1cf47(0x1ef)]?.[_0xc1cf47(0x1b5)]()){case _0xc1cf47(0x1f0):_0x327d21['data']?.[_0xc1cf47(0x1c0)]===!![]?_0x4f2dc8=_0xc1cf47(0x1d2):_0x4f2dc8=_0xc1cf47(0x1b6);break;case _0xc1cf47(0x1d5):_0x4f2dc8=_0xc1cf47(0x1b6);break;case'EXP':_0x4f2dc8='EXPIRED';break;case _0xc1cf47(0x1ff):_0x4f2dc8=_0xc1cf47(0x1b6);!_0x11c84f&&_0x327d21['data']?.[_0xc1cf47(0x1da)]&&(_0x11c84f=_0x327d21[_0xc1cf47(0x1b3)][_0xc1cf47(0x1da)]);break;case _0xc1cf47(0x1be):case _0xc1cf47(0x215):default:_0x4f2dc8=_0xc1cf47(0x1ba);break;}break;}const _0x40d444={};return _0x327d21[_0xc1cf47(0x1b3)]?.['payment_method_data']?.[_0xc1cf47(0x1ee)]&&(_0x40d444[_0xc1cf47(0x21d)]=_0x327d21[_0xc1cf47(0x1b3)]['payment_method_data'][_0xc1cf47(0x1ee)]),_0x327d21['data']?.[_0xc1cf47(0x226)]&&(_0x40d444['paymentMethod']=_0x327d21[_0xc1cf47(0x1b3)][_0xc1cf47(0x226)]),_0x327d21[_0xc1cf47(0x1b3)]?.['error_code']&&(_0x40d444[_0xc1cf47(0x207)]=_0x327d21[_0xc1cf47(0x1b3)][_0xc1cf47(0x1eb)]),_0x327d21['data']?.[_0xc1cf47(0x1c7)]&&(_0x40d444[_0xc1cf47(0x1f6)]=_0x327d21[_0xc1cf47(0x1b3)]['failure_code']),console[_0xc1cf47(0x20f)]('üîÑ\x20Rapyd\x20webhook\x20processed:\x20status='+_0x4f2dc8+_0xc1cf47(0x206)+(_0x11c84f||_0xc1cf47(0x200))),{'paymentId':_0x327d21[_0xc1cf47(0x1b3)]?.[_0xc1cf47(0x219)]||'','status':_0x4f2dc8,'amount':_0x327d21[_0xc1cf47(0x1b3)]?.[_0xc1cf47(0x222)],'currency':_0x327d21[_0xc1cf47(0x1b3)]?.[_0xc1cf47(0x1bd)],'failureMessage':_0x11c84f,'additionalInfo':_0x40d444};}}exports['RapydService']=RapydService;