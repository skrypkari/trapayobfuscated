'use strict';function a52_0x4d8b(_0x4aae24,_0x43dc0a){const _0x1eea90=a52_0x1eea();return a52_0x4d8b=function(_0x4d8bea,_0x1d9086){_0x4d8bea=_0x4d8bea-0x1e8;let _0xa46e6d=_0x1eea90[_0x4d8bea];return _0xa46e6d;},a52_0x4d8b(_0x4aae24,_0x43dc0a);}function a52_0x1eea(){const _0x3108f6=['payment_method_type','Error\x20details:','92392rqmiBG','Incomplete\x20response:\x20missing\x20id\x20or\x20redirect_url','merchant_reference_id','Status\x20Text:','PAYMENT_FAILED','üá¨üáß\x20Country:\x20','Business\x20Error\x20(','üí±\x20Adding\x20currency\x20conversion\x20fields\x20for\x20','üá¨üáß\x20Using\x20GB\x20(Britain)\x20as\x20country\x20for\x20Rapyd\x20payment\x20link','Error\x20stack:','loggerService','===\x20PARSED\x20RAPYD\x20RESPONSE\x20===','Request\x20Body\x20(Updated\x20Format):','PAYMENT_COMPLETED','\x20->\x20EUR:','\x20(GB\x20-\x20Britain)','Full\x20Error\x20Data:','Headers:','HTTP\x20','Error\x20message:','payment_method_data','ORDER:\x20','üí•\x20Rapyd\x20failure\x20message:\x20','3955788GzjxkL','CLO','FAILED','===\x20RAPYD\x20API\x20REQUEST\x20(White\x20Domain\x20-\x20Updated\x20Format)\x20===','RapydService','message','logWhiteDomainRequest','):\x20','Payment\x20Link\x20ID:','GET','statusText','error_code','Unknown\x20error','stack','type','PAYMENT_EXPIRED','Failed\x20to\x20verify\x20Rapyd\x20payment:\x20','expiration','Missing\x20id\x20or\x20redirect_url\x20in\x20response','HTTP\x20Status:','toISOString','processWebhook','Processing\x20Rapyd\x20webhook:','currency','apiUrl','entries','cardLast4','Failed\x20to\x20create\x20Rapyd\x20payment\x20link:\x20Unknown\x20error','üîÑ\x20Rapyd\x20webhook\x20processed:\x20status=','text','269888DydySN','rapyd','verifyPayment','\x20(always\x20GB\x20for\x20Rapyd)','fromEntries','Error\x20Message:','===\x20RAPYD\x20API\x20BUSINESS\x20ERROR\x20===','failureCode','logWhiteDomainResponse','HTTP\x20error!\x20status:\x20','failure_message','Response\x20Time:','paid','ERR','===\x20RAPYD\x20API\x20INCOMPLETE\x20RESPONSE\x20===','gb_mastercard_card','902420BMpOVG','üá¨üáß\x20Country\x20used:\x20','Error\x20Code:','https://tesoft.uk/gateway/rapyd/','URL:','../loggerService','Rapyd\x20payment\x20verification\x20error:','JSON\x20Parse\x20Error:\x20',',\x20body:\x20','https://tesoft.uk/gateway/success.php?id=','35IuoRRX','error','Response\x20Body:','now','log','failure_code','NEW','https://tesoft.uk/gateway/fail.php?id=','675852AOifPL','paymentMethod','POST','81rKYDNr','Parsed\x20Result:','üí≥\x20Payment\x20Methods:\x20gb_visa_card,\x20gb_mastercard_card','headers','32659875NaKLFB','EXP','data','Rapyd\x20API\x20error:\x20','Invalid\x20response\x20from\x20Rapyd\x20API:\x20missing\x20id\x20or\x20redirect_url','Failed\x20to\x20create\x20Rapyd\x20payment\x20link:\x20','logWhiteDomainError','none','PAYMENT_CANCELED','PAID','SUCCESS','Status:','EXPIRED','createPaymentLink','PENDING','===\x20RAPYD\x20API\x20RESPONSE\x20(White\x20Domain)\x20===','errorCode',',\x20failureMessage=','toUpperCase','Unknown\x20error\x20from\x20Rapyd\x20API','stringify','\x20\x20\x20requested_currency:\x20EUR','/v1/hosted/payment_links/','2425420ApqVNB','status','EUR','gb_visa_card','/v1/hosted/payment_links'];a52_0x1eea=function(){return _0x3108f6;};return a52_0x1eea();}const a52_0x59cd7e=a52_0x4d8b;(function(_0x4bd7ad,_0x1df100){const _0x332f13=a52_0x4d8b,_0x1b3600=_0x4bd7ad();while(!![]){try{const _0x35798f=-parseInt(_0x332f13(0x20d))/0x1+-parseInt(_0x332f13(0x21f))/0x2+parseInt(_0x332f13(0x222))/0x3*(-parseInt(_0x332f13(0x244))/0x4)+-parseInt(_0x332f13(0x23d))/0x5+-parseInt(_0x332f13(0x25b))/0x6+-parseInt(_0x332f13(0x217))/0x7*(parseInt(_0x332f13(0x1fd))/0x8)+parseInt(_0x332f13(0x226))/0x9;if(_0x35798f===_0x1df100)break;else _0x1b3600['push'](_0x1b3600['shift']());}catch(_0x4d9cb1){_0x1b3600['push'](_0x1b3600['shift']());}}}(a52_0x1eea,0x6e4ed));Object['defineProperty'](exports,'__esModule',{'value':!![]}),exports[a52_0x59cd7e(0x25f)]=void 0x0;const loggerService_1=require(a52_0x59cd7e(0x212));class RapydService{constructor(){const _0x34b43c=a52_0x59cd7e;this[_0x34b43c(0x1f7)]=_0x34b43c(0x210),console['log']('üåê\x20Rapyd\x20service\x20initialized\x20with\x20white\x20domain\x20proxy');}async[a52_0x59cd7e(0x233)](_0x5a33e9){const _0x3d5ad2=a52_0x59cd7e,{orderId:_0x171cf2,orderName:_0x2d6238,amount:_0x3cdcfd,currency:_0x12e7e6,usage:_0x13970e,maxPayments:_0xdd5890,successUrl:_0xa77681,failUrl:_0x354f11}=_0x5a33e9,_0x39f685=_0x12e7e6[_0x3d5ad2(0x238)](),_0x8dd747='GB';console['log'](_0x3d5ad2(0x24c));const _0x25cb5e=_0x3d5ad2(0x216)+_0x171cf2,_0x5b1989=_0x3d5ad2(0x21e)+_0x171cf2,_0x2167ea={'amount':_0x3cdcfd,'currency':_0x39f685,'cancel_checkout_url':_0x5b1989,'complete_checkout_url':_0x25cb5e,'complete_payment_url':_0x25cb5e,'merchant_reference_id':_0x171cf2,'description':_0x3d5ad2(0x259)+_0x171cf2,'country':'GB','payment_method_types_include':[_0x3d5ad2(0x240),_0x3d5ad2(0x20c)],'custom_elements':{'display_description':!![]}};if(_0x39f685!==_0x3d5ad2(0x23f)){const _0x18ad2e=Math['floor'](Date[_0x3d5ad2(0x21a)]()/0x3e8)+0x1e*0x3c;_0x2167ea['fixed_side']='buy',_0x2167ea['requested_currency']=_0x3d5ad2(0x23f),_0x2167ea[_0x3d5ad2(0x1f0)]=_0x18ad2e,console[_0x3d5ad2(0x21b)](_0x3d5ad2(0x24b)+_0x39f685+_0x3d5ad2(0x252)),console[_0x3d5ad2(0x21b)]('\x20\x20\x20fixed_side:\x20buy'),console[_0x3d5ad2(0x21b)](_0x3d5ad2(0x23b)),console[_0x3d5ad2(0x21b)]('\x20\x20\x20expiration:\x20'+_0x18ad2e+'\x20('+new Date(_0x18ad2e*0x3e8)[_0x3d5ad2(0x1f3)]()+')');}const _0x1e1fa8=Date[_0x3d5ad2(0x21a)]();try{console['log'](_0x3d5ad2(0x25e)),console[_0x3d5ad2(0x21b)](_0x3d5ad2(0x211),this[_0x3d5ad2(0x1f7)]),console[_0x3d5ad2(0x21b)](_0x3d5ad2(0x250),JSON['stringify'](_0x2167ea,null,0x2)),console['log'](_0x3d5ad2(0x249)+_0x8dd747+_0x3d5ad2(0x200)),console[_0x3d5ad2(0x21b)](_0x3d5ad2(0x224)),loggerService_1['loggerService'][_0x3d5ad2(0x261)](_0x3d5ad2(0x1fe),_0x3d5ad2(0x241),_0x3d5ad2(0x221),_0x2167ea);const _0xef55d4=await fetch(this[_0x3d5ad2(0x1f7)],{'method':_0x3d5ad2(0x221),'headers':{'Content-Type':'application/json','User-Agent':'Payment\x20System/1.0'},'body':JSON[_0x3d5ad2(0x23a)](_0x2167ea)}),_0x22b978=Date[_0x3d5ad2(0x21a)]()-_0x1e1fa8;console[_0x3d5ad2(0x21b)](_0x3d5ad2(0x235)),console[_0x3d5ad2(0x21b)](_0x3d5ad2(0x231),_0xef55d4['status']),console['log'](_0x3d5ad2(0x247),_0xef55d4[_0x3d5ad2(0x1e9)]),console[_0x3d5ad2(0x21b)](_0x3d5ad2(0x255),Object[_0x3d5ad2(0x201)](_0xef55d4[_0x3d5ad2(0x225)][_0x3d5ad2(0x1f8)]())),console[_0x3d5ad2(0x21b)](_0x3d5ad2(0x208),_0x22b978+'ms');const _0x34a244=await _0xef55d4[_0x3d5ad2(0x1fc)]();console['log']('Raw\x20Response\x20Body:',_0x34a244);if(!_0xef55d4['ok']){console[_0x3d5ad2(0x218)]('===\x20RAPYD\x20API\x20ERROR\x20==='),console[_0x3d5ad2(0x218)](_0x3d5ad2(0x1f2),_0xef55d4[_0x3d5ad2(0x23e)]),console[_0x3d5ad2(0x218)](_0x3d5ad2(0x219),_0x34a244),loggerService_1[_0x3d5ad2(0x24e)]['logWhiteDomainResponse']('rapyd',_0x3d5ad2(0x241),_0xef55d4[_0x3d5ad2(0x23e)],_0x34a244,_0x22b978),loggerService_1[_0x3d5ad2(0x24e)][_0x3d5ad2(0x22c)](_0x3d5ad2(0x1fe),_0x3d5ad2(0x241),_0x3d5ad2(0x256)+_0xef55d4[_0x3d5ad2(0x23e)]+':\x20'+_0x34a244);throw new Error(_0x3d5ad2(0x206)+_0xef55d4[_0x3d5ad2(0x23e)]+_0x3d5ad2(0x215)+_0x34a244);}let _0x35118a;try{_0x35118a=JSON['parse'](_0x34a244);}catch(_0x5d0dde){console['error']('Failed\x20to\x20parse\x20JSON\x20response:',_0x5d0dde),loggerService_1[_0x3d5ad2(0x24e)][_0x3d5ad2(0x22c)]('rapyd',_0x3d5ad2(0x241),_0x3d5ad2(0x214)+_0x5d0dde);throw new Error('Invalid\x20JSON\x20response\x20from\x20Rapyd\x20API:\x20'+_0x34a244);}console[_0x3d5ad2(0x21b)](_0x3d5ad2(0x24f)),console[_0x3d5ad2(0x21b)](_0x3d5ad2(0x223),JSON[_0x3d5ad2(0x23a)](_0x35118a,null,0x2)),loggerService_1['loggerService']['logWhiteDomainResponse'](_0x3d5ad2(0x1fe),_0x3d5ad2(0x241),_0xef55d4[_0x3d5ad2(0x23e)],_0x35118a,_0x22b978);if(_0x35118a[_0x3d5ad2(0x23e)]?.[_0x3d5ad2(0x23e)]!==_0x3d5ad2(0x230)){const _0x282b4b=_0x35118a[_0x3d5ad2(0x23e)]?.['message']||_0x3d5ad2(0x239),_0x52d1d5=_0x35118a[_0x3d5ad2(0x23e)]?.[_0x3d5ad2(0x1ea)]||'UNKNOWN';console[_0x3d5ad2(0x218)](_0x3d5ad2(0x203)),console[_0x3d5ad2(0x218)](_0x3d5ad2(0x20f),_0x52d1d5),console[_0x3d5ad2(0x218)](_0x3d5ad2(0x202),_0x282b4b),console[_0x3d5ad2(0x218)](_0x3d5ad2(0x254),_0x35118a['status']),loggerService_1[_0x3d5ad2(0x24e)][_0x3d5ad2(0x22c)](_0x3d5ad2(0x1fe),_0x3d5ad2(0x241),_0x3d5ad2(0x24a)+_0x52d1d5+'):\x20'+_0x282b4b);throw new Error('Rapyd\x20API\x20error\x20('+_0x52d1d5+_0x3d5ad2(0x262)+_0x282b4b);}if(!_0x35118a[_0x3d5ad2(0x228)]?.['id']||!_0x35118a[_0x3d5ad2(0x228)]?.['redirect_url']){console[_0x3d5ad2(0x218)](_0x3d5ad2(0x20b)),console[_0x3d5ad2(0x218)](_0x3d5ad2(0x1f1)),console[_0x3d5ad2(0x218)]('Response\x20data:',_0x35118a[_0x3d5ad2(0x228)]),loggerService_1[_0x3d5ad2(0x24e)][_0x3d5ad2(0x22c)]('rapyd','/v1/hosted/payment_links',_0x3d5ad2(0x245));throw new Error(_0x3d5ad2(0x22a));}return console['log']('===\x20RAPYD\x20SUCCESS\x20==='),console[_0x3d5ad2(0x21b)](_0x3d5ad2(0x263),_0x35118a['data']['id']),console[_0x3d5ad2(0x21b)]('Redirect\x20URL:',_0x35118a[_0x3d5ad2(0x228)]['redirect_url']),console[_0x3d5ad2(0x21b)](_0x3d5ad2(0x20e)+_0x8dd747+_0x3d5ad2(0x253)),console[_0x3d5ad2(0x21b)](_0x3d5ad2(0x224)),{'gateway_payment_id':_0x35118a[_0x3d5ad2(0x228)]['id'],'payment_url':_0x35118a[_0x3d5ad2(0x228)]['redirect_url']};}catch(_0x20a8b0){console['error']('===\x20RAPYD\x20SERVICE\x20ERROR\x20==='),console[_0x3d5ad2(0x218)](_0x3d5ad2(0x243),_0x20a8b0),loggerService_1[_0x3d5ad2(0x24e)][_0x3d5ad2(0x22c)](_0x3d5ad2(0x1fe),'/v1/hosted/payment_links',_0x20a8b0);if(_0x20a8b0 instanceof Error){console[_0x3d5ad2(0x218)](_0x3d5ad2(0x257),_0x20a8b0[_0x3d5ad2(0x260)]),console[_0x3d5ad2(0x218)](_0x3d5ad2(0x24d),_0x20a8b0[_0x3d5ad2(0x1ec)]);throw new Error(_0x3d5ad2(0x22b)+_0x20a8b0[_0x3d5ad2(0x260)]);}throw new Error(_0x3d5ad2(0x1fa));}}async[a52_0x59cd7e(0x1ff)](_0x4e3fb9){const _0xf44e72=a52_0x59cd7e,_0x3dd509=Date[_0xf44e72(0x21a)]();try{loggerService_1[_0xf44e72(0x24e)][_0xf44e72(0x261)](_0xf44e72(0x1fe),_0xf44e72(0x23c)+_0x4e3fb9,'GET',{});const _0x5e973a=await fetch(this[_0xf44e72(0x1f7)]+'/'+_0x4e3fb9,{'method':_0xf44e72(0x1e8),'headers':{'Content-Type':'application/json','User-Agent':'Payment\x20System/1.0'}}),_0x284342=Date[_0xf44e72(0x21a)]()-_0x3dd509;if(!_0x5e973a['ok']){const _0x60913=await _0x5e973a['text']();loggerService_1[_0xf44e72(0x24e)][_0xf44e72(0x205)]('rapyd',_0xf44e72(0x23c)+_0x4e3fb9,_0x5e973a['status'],_0x60913,_0x284342);throw new Error('HTTP\x20error!\x20status:\x20'+_0x5e973a[_0xf44e72(0x23e)]);}const _0x5c3f78=await _0x5e973a['json']();loggerService_1[_0xf44e72(0x24e)][_0xf44e72(0x205)](_0xf44e72(0x1fe),'/v1/hosted/payment_links/'+_0x4e3fb9,_0x5e973a[_0xf44e72(0x23e)],_0x5c3f78,_0x284342);if(_0x5c3f78[_0xf44e72(0x23e)]?.[_0xf44e72(0x23e)]!==_0xf44e72(0x230)){loggerService_1[_0xf44e72(0x24e)][_0xf44e72(0x22c)]('rapyd',_0xf44e72(0x23c)+_0x4e3fb9,_0xf44e72(0x229)+(_0x5c3f78['status']?.[_0xf44e72(0x260)]||_0xf44e72(0x1eb)));throw new Error(_0xf44e72(0x229)+(_0x5c3f78[_0xf44e72(0x23e)]?.['message']||'Unknown\x20error'));}let _0x34fe18=_0xf44e72(0x234);if(_0x5c3f78[_0xf44e72(0x228)]?.[_0xf44e72(0x23e)])switch(_0x5c3f78[_0xf44e72(0x228)][_0xf44e72(0x23e)][_0xf44e72(0x238)]()){case'CLO':_0x34fe18=_0xf44e72(0x22f);break;case'CAN':_0x34fe18=_0xf44e72(0x25d);break;case _0xf44e72(0x227):_0x34fe18='EXPIRED';break;case _0xf44e72(0x20a):_0x34fe18=_0xf44e72(0x25d);break;case _0xf44e72(0x21d):case'ACT':default:_0x34fe18=_0xf44e72(0x234);break;}return{'status':_0x34fe18,'amount':_0x5c3f78[_0xf44e72(0x228)]?.['amount'],'currency':_0x5c3f78[_0xf44e72(0x228)]?.[_0xf44e72(0x1f6)]};}catch(_0x5b54f8){console['error'](_0xf44e72(0x213),_0x5b54f8),loggerService_1['loggerService'][_0xf44e72(0x22c)](_0xf44e72(0x1fe),_0xf44e72(0x23c)+_0x4e3fb9,_0x5b54f8);throw new Error(_0xf44e72(0x1ef)+(_0x5b54f8 instanceof Error?_0x5b54f8['message']:'Unknown\x20error'));}}async[a52_0x59cd7e(0x1f4)](_0x14e10a){const _0x4760ea=a52_0x59cd7e;console[_0x4760ea(0x21b)](_0x4760ea(0x1f5),_0x14e10a);let _0x58d7af=_0x4760ea(0x234),_0x3e5044;_0x14e10a[_0x4760ea(0x228)]?.[_0x4760ea(0x207)]&&(_0x3e5044=_0x14e10a[_0x4760ea(0x228)]['failure_message'],console[_0x4760ea(0x21b)](_0x4760ea(0x25a)+_0x3e5044));switch(_0x14e10a[_0x4760ea(0x1ed)]?.[_0x4760ea(0x238)]()){case _0x4760ea(0x251):_0x14e10a['data']?.[_0x4760ea(0x209)]===!![]&&_0x14e10a[_0x4760ea(0x228)]?.['status']===_0x4760ea(0x25c)?_0x58d7af=_0x4760ea(0x22f):_0x58d7af=_0x4760ea(0x234);break;case _0x4760ea(0x22e):_0x58d7af=_0x4760ea(0x25d);break;case _0x4760ea(0x1ee):_0x58d7af=_0x4760ea(0x232);break;case _0x4760ea(0x248):_0x58d7af=_0x4760ea(0x25d);!_0x3e5044&&_0x14e10a[_0x4760ea(0x228)]?.[_0x4760ea(0x207)]&&(_0x3e5044=_0x14e10a[_0x4760ea(0x228)][_0x4760ea(0x207)]);break;default:switch(_0x14e10a['data']?.[_0x4760ea(0x23e)]?.['toUpperCase']()){case'CLO':_0x14e10a['data']?.[_0x4760ea(0x209)]===!![]?_0x58d7af='PAID':_0x58d7af=_0x4760ea(0x25d);break;case'CAN':_0x58d7af=_0x4760ea(0x25d);break;case _0x4760ea(0x227):_0x58d7af='EXPIRED';break;case _0x4760ea(0x20a):_0x58d7af=_0x4760ea(0x25d);!_0x3e5044&&_0x14e10a[_0x4760ea(0x228)]?.[_0x4760ea(0x207)]&&(_0x3e5044=_0x14e10a[_0x4760ea(0x228)]['failure_message']);break;case _0x4760ea(0x21d):case'ACT':default:_0x58d7af='PENDING';break;}break;}const _0x3de4c3={};return _0x14e10a['data']?.[_0x4760ea(0x258)]?.['last4']&&(_0x3de4c3[_0x4760ea(0x1f9)]=_0x14e10a[_0x4760ea(0x228)]['payment_method_data']['last4']),_0x14e10a[_0x4760ea(0x228)]?.[_0x4760ea(0x242)]&&(_0x3de4c3[_0x4760ea(0x220)]=_0x14e10a['data'][_0x4760ea(0x242)]),_0x14e10a[_0x4760ea(0x228)]?.['error_code']&&(_0x3de4c3[_0x4760ea(0x236)]=_0x14e10a[_0x4760ea(0x228)][_0x4760ea(0x1ea)]),_0x14e10a[_0x4760ea(0x228)]?.[_0x4760ea(0x21c)]&&(_0x3de4c3[_0x4760ea(0x204)]=_0x14e10a[_0x4760ea(0x228)][_0x4760ea(0x21c)]),console[_0x4760ea(0x21b)](_0x4760ea(0x1fb)+_0x58d7af+_0x4760ea(0x237)+(_0x3e5044||_0x4760ea(0x22d))),{'paymentId':_0x14e10a['data']?.[_0x4760ea(0x246)]||'','status':_0x58d7af,'amount':_0x14e10a['data']?.['amount'],'currency':_0x14e10a[_0x4760ea(0x228)]?.['currency'],'failureMessage':_0x3e5044,'additionalInfo':_0x3de4c3};}}exports[a52_0x59cd7e(0x25f)]=RapydService;