'use strict';const a45_0x34d3c7=a45_0xf03e;(function(_0x4911c0,_0x5a4370){const _0x562b08=a45_0xf03e,_0x4763cb=_0x4911c0();while(!![]){try{const _0x3943eb=-parseInt(_0x562b08(0x130))/0x1*(-parseInt(_0x562b08(0xe8))/0x2)+-parseInt(_0x562b08(0x123))/0x3*(parseInt(_0x562b08(0x15b))/0x4)+-parseInt(_0x562b08(0x150))/0x5*(parseInt(_0x562b08(0x15c))/0x6)+-parseInt(_0x562b08(0x12f))/0x7*(parseInt(_0x562b08(0x117))/0x8)+parseInt(_0x562b08(0xeb))/0x9*(-parseInt(_0x562b08(0x147))/0xa)+-parseInt(_0x562b08(0xfd))/0xb*(parseInt(_0x562b08(0x105))/0xc)+parseInt(_0x562b08(0xea))/0xd;if(_0x3943eb===_0x5a4370)break;else _0x4763cb['push'](_0x4763cb['shift']());}catch(_0x1035fe){_0x4763cb['push'](_0x4763cb['shift']());}}}(a45_0x244d,0x85d52));Object[a45_0x34d3c7(0xfb)](exports,a45_0x34d3c7(0x14c),{'value':!![]}),exports[a45_0x34d3c7(0x15d)]=void 0x0;function a45_0x244d(){const _0x39e3ea=['Error\x20Code:','loggerService','Invalid\x20JSON\x20response\x20from\x20Rapyd\x20API:\x20','payment_method_data','Redirect\x20URL:','GET','259400gsjLtp','gb_mastercard_card','Headers:',',\x20failureMessage=','PENDING','text','Rapyd\x20payment\x20verification\x20error:','ERR','POST','failureCode','statusText','paid','3ROuOJH','stringify','apiUrl','headers','type','merchant_reference_id','now','currency','fromEntries','Parsed\x20Result:','Missing\x20id\x20or\x20redirect_url\x20in\x20response','HTTP\x20error!\x20status:\x20','217DsiQzn','1mMbcuO','===\x20RAPYD\x20API\x20ERROR\x20===','Invalid\x20response\x20from\x20Rapyd\x20API:\x20missing\x20id\x20or\x20redirect_url','TesSoft\x20Payment\x20System/1.0','Raw\x20Response\x20Body:','https://tesoft.uk/gateway/rapyd/','JSON\x20Parse\x20Error:\x20','https://tesoft.uk/gateway/fail.php?id=','Unknown\x20error','===\x20PARSED\x20RAPYD\x20RESPONSE\x20===','üí•\x20Rapyd\x20failure\x20message:\x20','Full\x20Error\x20Data:','EXPIRED','logWhiteDomainRequest','Error\x20stack:','Processing\x20Rapyd\x20webhook:','PAYMENT_COMPLETED','===\x20RAPYD\x20API\x20REQUEST\x20(White\x20Domain\x20-\x20Updated\x20Format)\x20===','createPaymentLink','redirect_url','error','):\x20','processWebhook','2481770sgSmsD','json','data',',\x20body:\x20','logWhiteDomainResponse','__esModule','Unknown\x20error\x20from\x20Rapyd\x20API','EXP','Failed\x20to\x20parse\x20JSON\x20response:','5VMotcq','amount','/v1/hosted/payment_links/','application/json','toUpperCase','paymentMethod','errorCode','Failed\x20to\x20create\x20Rapyd\x20payment\x20link:\x20','\x20(always\x20GB\x20for\x20Rapyd)','Status\x20Text:','message','3047816afniHr','2873490Xehjtz','RapydService','Payment\x20Link\x20ID:','Error\x20Message:','verifyPayment','1758002WEcZSb','Response\x20Time:','46798713avkEiI','27gXoRZg','gb_visa_card','FAILED','Response\x20Body:','cardLast4','===\x20RAPYD\x20SUCCESS\x20===','Failed\x20to\x20verify\x20Rapyd\x20payment:\x20','failure_message','PAYMENT_EXPIRED','CAN','/v1/hosted/payment_links','===\x20RAPYD\x20API\x20RESPONSE\x20(White\x20Domain)\x20===','stack','ACT','failure_code','PAID','defineProperty','../loggerService','231LHvfxw','rapyd','CLO','payment_method_type','HTTP\x20','Failed\x20to\x20create\x20Rapyd\x20payment\x20link:\x20Unknown\x20error','NEW','Status:','537228ZmmVOc','===\x20RAPYD\x20SERVICE\x20ERROR\x20===','log','PAYMENT_FAILED','UNKNOWN','üí≥\x20Payment\x20Methods:\x20gb_visa_card,\x20gb_mastercard_card','error_code','logWhiteDomainError','status','SUCCESS','Rapyd\x20API\x20error:\x20','===\x20RAPYD\x20API\x20BUSINESS\x20ERROR\x20==='];a45_0x244d=function(){return _0x39e3ea;};return a45_0x244d();}function a45_0xf03e(_0x193e5d,_0x398fd6){const _0x244d8a=a45_0x244d();return a45_0xf03e=function(_0xf03e00,_0x4904f0){_0xf03e00=_0xf03e00-0xe6;let _0xf05c21=_0x244d8a[_0xf03e00];return _0xf05c21;},a45_0xf03e(_0x193e5d,_0x398fd6);}const loggerService_1=require(a45_0x34d3c7(0xfc));class RapydService{constructor(){const _0x474d70=a45_0x34d3c7;this[_0x474d70(0x125)]=_0x474d70(0x135),console[_0x474d70(0x107)]('üåê\x20Rapyd\x20service\x20initialized\x20with\x20white\x20domain\x20proxy');}async[a45_0x34d3c7(0x142)](_0x12e6a4){const _0x17ec9f=a45_0x34d3c7,{orderId:_0x36cb6b,orderName:_0x1901ce,amount:_0x5142ae,currency:_0x1890fd,usage:_0x5f3868,maxPayments:_0x5f4c81,successUrl:_0x118c3c,failUrl:_0x324b71}=_0x12e6a4,_0x85c7d0=_0x1890fd[_0x17ec9f(0x154)](),_0xa681c8='GB';console[_0x17ec9f(0x107)]('üá¨üáß\x20Using\x20GB\x20(Britain)\x20as\x20country\x20for\x20Rapyd\x20payment\x20link');const _0x9390e3='https://tesoft.uk/gateway/success.php?id='+_0x36cb6b,_0x5c1397=_0x17ec9f(0x137)+_0x36cb6b,_0xbc5b08={'amount':_0x5142ae,'currency':_0x85c7d0,'cancel_checkout_url':_0x5c1397,'complete_checkout_url':_0x9390e3,'complete_payment_url':_0x9390e3,'merchant_reference_id':_0x36cb6b,'description':'ORDER:\x20'+_0x36cb6b,'country':'GB','payment_method_types_include':[_0x17ec9f(0xec),_0x17ec9f(0x118)],'custom_elements':{'display_description':!![]}},_0x19064f=Date[_0x17ec9f(0x129)]();try{console[_0x17ec9f(0x107)](_0x17ec9f(0x141)),console[_0x17ec9f(0x107)]('URL:',this[_0x17ec9f(0x125)]),console[_0x17ec9f(0x107)]('Request\x20Body\x20(Updated\x20Format):',JSON['stringify'](_0xbc5b08,null,0x2)),console[_0x17ec9f(0x107)]('üá¨üáß\x20Country:\x20'+_0xa681c8+_0x17ec9f(0x158)),console[_0x17ec9f(0x107)](_0x17ec9f(0x10a)),loggerService_1['loggerService'][_0x17ec9f(0x13d)](_0x17ec9f(0xfe),'/v1/hosted/payment_links','POST',_0xbc5b08);const _0x194556=await fetch(this[_0x17ec9f(0x125)],{'method':_0x17ec9f(0x11f),'headers':{'Content-Type':_0x17ec9f(0x153),'User-Agent':_0x17ec9f(0x133)},'body':JSON[_0x17ec9f(0x124)](_0xbc5b08)}),_0x57165e=Date['now']()-_0x19064f;console[_0x17ec9f(0x107)](_0x17ec9f(0xf6)),console['log'](_0x17ec9f(0x104),_0x194556['status']),console['log'](_0x17ec9f(0x159),_0x194556[_0x17ec9f(0x121)]),console[_0x17ec9f(0x107)](_0x17ec9f(0x119),Object[_0x17ec9f(0x12b)](_0x194556[_0x17ec9f(0x126)]['entries']())),console['log'](_0x17ec9f(0xe9),_0x57165e+'ms');const _0x138198=await _0x194556[_0x17ec9f(0x11c)]();console[_0x17ec9f(0x107)](_0x17ec9f(0x134),_0x138198);if(!_0x194556['ok']){console[_0x17ec9f(0x144)](_0x17ec9f(0x131)),console[_0x17ec9f(0x144)]('HTTP\x20Status:',_0x194556['status']),console['error'](_0x17ec9f(0xee),_0x138198),loggerService_1[_0x17ec9f(0x112)][_0x17ec9f(0x14b)](_0x17ec9f(0xfe),'/v1/hosted/payment_links',_0x194556[_0x17ec9f(0x10d)],_0x138198,_0x57165e),loggerService_1[_0x17ec9f(0x112)]['logWhiteDomainError'](_0x17ec9f(0xfe),_0x17ec9f(0xf5),_0x17ec9f(0x101)+_0x194556[_0x17ec9f(0x10d)]+':\x20'+_0x138198);throw new Error('HTTP\x20error!\x20status:\x20'+_0x194556[_0x17ec9f(0x10d)]+_0x17ec9f(0x14a)+_0x138198);}let _0x595a51;try{_0x595a51=JSON['parse'](_0x138198);}catch(_0x44cc8c){console[_0x17ec9f(0x144)](_0x17ec9f(0x14f),_0x44cc8c),loggerService_1['loggerService']['logWhiteDomainError']('rapyd',_0x17ec9f(0xf5),_0x17ec9f(0x136)+_0x44cc8c);throw new Error(_0x17ec9f(0x113)+_0x138198);}console[_0x17ec9f(0x107)](_0x17ec9f(0x139)),console[_0x17ec9f(0x107)](_0x17ec9f(0x12c),JSON[_0x17ec9f(0x124)](_0x595a51,null,0x2)),loggerService_1[_0x17ec9f(0x112)][_0x17ec9f(0x14b)](_0x17ec9f(0xfe),'/v1/hosted/payment_links',_0x194556[_0x17ec9f(0x10d)],_0x595a51,_0x57165e);if(_0x595a51['status']?.[_0x17ec9f(0x10d)]!==_0x17ec9f(0x10e)){const _0x248764=_0x595a51[_0x17ec9f(0x10d)]?.[_0x17ec9f(0x15a)]||_0x17ec9f(0x14d),_0x1314a9=_0x595a51[_0x17ec9f(0x10d)]?.['error_code']||_0x17ec9f(0x109);console['error'](_0x17ec9f(0x110)),console['error'](_0x17ec9f(0x111),_0x1314a9),console[_0x17ec9f(0x144)](_0x17ec9f(0xe6),_0x248764),console[_0x17ec9f(0x144)](_0x17ec9f(0x13b),_0x595a51['status']),loggerService_1[_0x17ec9f(0x112)][_0x17ec9f(0x10c)](_0x17ec9f(0xfe),_0x17ec9f(0xf5),'Business\x20Error\x20('+_0x1314a9+_0x17ec9f(0x145)+_0x248764);throw new Error('Rapyd\x20API\x20error\x20('+_0x1314a9+_0x17ec9f(0x145)+_0x248764);}if(!_0x595a51[_0x17ec9f(0x149)]?.['id']||!_0x595a51[_0x17ec9f(0x149)]?.[_0x17ec9f(0x143)]){console['error']('===\x20RAPYD\x20API\x20INCOMPLETE\x20RESPONSE\x20==='),console['error'](_0x17ec9f(0x12d)),console['error']('Response\x20data:',_0x595a51[_0x17ec9f(0x149)]),loggerService_1['loggerService'][_0x17ec9f(0x10c)](_0x17ec9f(0xfe),_0x17ec9f(0xf5),'Incomplete\x20response:\x20missing\x20id\x20or\x20redirect_url');throw new Error(_0x17ec9f(0x132));}return console['log'](_0x17ec9f(0xf0)),console[_0x17ec9f(0x107)](_0x17ec9f(0x15e),_0x595a51['data']['id']),console[_0x17ec9f(0x107)](_0x17ec9f(0x115),_0x595a51[_0x17ec9f(0x149)][_0x17ec9f(0x143)]),console[_0x17ec9f(0x107)]('üá¨üáß\x20Country\x20used:\x20'+_0xa681c8+'\x20(GB\x20-\x20Britain)'),console['log'](_0x17ec9f(0x10a)),{'gateway_payment_id':_0x595a51[_0x17ec9f(0x149)]['id'],'payment_url':_0x595a51['data'][_0x17ec9f(0x143)]};}catch(_0x1ecccc){console['error'](_0x17ec9f(0x106)),console[_0x17ec9f(0x144)]('Error\x20details:',_0x1ecccc),loggerService_1[_0x17ec9f(0x112)][_0x17ec9f(0x10c)](_0x17ec9f(0xfe),_0x17ec9f(0xf5),_0x1ecccc);if(_0x1ecccc instanceof Error){console[_0x17ec9f(0x144)]('Error\x20message:',_0x1ecccc[_0x17ec9f(0x15a)]),console['error'](_0x17ec9f(0x13e),_0x1ecccc[_0x17ec9f(0xf7)]);throw new Error(_0x17ec9f(0x157)+_0x1ecccc[_0x17ec9f(0x15a)]);}throw new Error(_0x17ec9f(0x102));}}async[a45_0x34d3c7(0xe7)](_0xbca3a8){const _0x38efd5=a45_0x34d3c7,_0x4fccae=Date[_0x38efd5(0x129)]();try{loggerService_1[_0x38efd5(0x112)][_0x38efd5(0x13d)](_0x38efd5(0xfe),_0x38efd5(0x152)+_0xbca3a8,_0x38efd5(0x116),{});const _0x253deb=await fetch(this[_0x38efd5(0x125)]+'/'+_0xbca3a8,{'method':_0x38efd5(0x116),'headers':{'Content-Type':_0x38efd5(0x153),'User-Agent':_0x38efd5(0x133)}}),_0x4012eb=Date[_0x38efd5(0x129)]()-_0x4fccae;if(!_0x253deb['ok']){const _0x4f1b41=await _0x253deb[_0x38efd5(0x11c)]();loggerService_1['loggerService'][_0x38efd5(0x14b)](_0x38efd5(0xfe),_0x38efd5(0x152)+_0xbca3a8,_0x253deb[_0x38efd5(0x10d)],_0x4f1b41,_0x4012eb);throw new Error(_0x38efd5(0x12e)+_0x253deb[_0x38efd5(0x10d)]);}const _0x262ab=await _0x253deb[_0x38efd5(0x148)]();loggerService_1['loggerService'][_0x38efd5(0x14b)](_0x38efd5(0xfe),_0x38efd5(0x152)+_0xbca3a8,_0x253deb['status'],_0x262ab,_0x4012eb);if(_0x262ab[_0x38efd5(0x10d)]?.['status']!==_0x38efd5(0x10e)){loggerService_1['loggerService'][_0x38efd5(0x10c)](_0x38efd5(0xfe),_0x38efd5(0x152)+_0xbca3a8,'Rapyd\x20API\x20error:\x20'+(_0x262ab[_0x38efd5(0x10d)]?.[_0x38efd5(0x15a)]||_0x38efd5(0x138)));throw new Error(_0x38efd5(0x10f)+(_0x262ab[_0x38efd5(0x10d)]?.[_0x38efd5(0x15a)]||_0x38efd5(0x138)));}let _0x5b6ff8=_0x38efd5(0x11b);if(_0x262ab[_0x38efd5(0x149)]?.[_0x38efd5(0x10d)])switch(_0x262ab[_0x38efd5(0x149)][_0x38efd5(0x10d)]['toUpperCase']()){case'CLO':_0x5b6ff8=_0x38efd5(0xfa);break;case _0x38efd5(0xf4):_0x5b6ff8='FAILED';break;case _0x38efd5(0x14e):_0x5b6ff8=_0x38efd5(0x13c);break;case _0x38efd5(0x11e):_0x5b6ff8=_0x38efd5(0xed);break;case'NEW':case _0x38efd5(0xf8):default:_0x5b6ff8=_0x38efd5(0x11b);break;}return{'status':_0x5b6ff8,'amount':_0x262ab[_0x38efd5(0x149)]?.[_0x38efd5(0x151)],'currency':_0x262ab[_0x38efd5(0x149)]?.[_0x38efd5(0x12a)]};}catch(_0x383e1e){console['error'](_0x38efd5(0x11d),_0x383e1e),loggerService_1['loggerService'][_0x38efd5(0x10c)](_0x38efd5(0xfe),'/v1/hosted/payment_links/'+_0xbca3a8,_0x383e1e);throw new Error(_0x38efd5(0xf1)+(_0x383e1e instanceof Error?_0x383e1e[_0x38efd5(0x15a)]:_0x38efd5(0x138)));}}async[a45_0x34d3c7(0x146)](_0x3b34a2){const _0x3162d8=a45_0x34d3c7;console[_0x3162d8(0x107)](_0x3162d8(0x13f),_0x3b34a2);let _0x29f6a2='PENDING',_0x1f10cd;_0x3b34a2[_0x3162d8(0x149)]?.['failure_message']&&(_0x1f10cd=_0x3b34a2['data'][_0x3162d8(0xf2)],console['log'](_0x3162d8(0x13a)+_0x1f10cd));switch(_0x3b34a2[_0x3162d8(0x127)]?.[_0x3162d8(0x154)]()){case _0x3162d8(0x140):_0x3b34a2[_0x3162d8(0x149)]?.[_0x3162d8(0x122)]===!![]&&_0x3b34a2['data']?.[_0x3162d8(0x10d)]===_0x3162d8(0xff)?_0x29f6a2=_0x3162d8(0xfa):_0x29f6a2='PENDING';break;case'PAYMENT_CANCELED':_0x29f6a2=_0x3162d8(0xed);break;case _0x3162d8(0xf3):_0x29f6a2=_0x3162d8(0x13c);break;case _0x3162d8(0x108):_0x29f6a2=_0x3162d8(0xed);!_0x1f10cd&&_0x3b34a2[_0x3162d8(0x149)]?.['failure_message']&&(_0x1f10cd=_0x3b34a2['data'][_0x3162d8(0xf2)]);break;default:switch(_0x3b34a2[_0x3162d8(0x149)]?.[_0x3162d8(0x10d)]?.['toUpperCase']()){case _0x3162d8(0xff):_0x3b34a2[_0x3162d8(0x149)]?.[_0x3162d8(0x122)]===!![]?_0x29f6a2='PAID':_0x29f6a2=_0x3162d8(0xed);break;case _0x3162d8(0xf4):_0x29f6a2=_0x3162d8(0xed);break;case _0x3162d8(0x14e):_0x29f6a2=_0x3162d8(0x13c);break;case'ERR':_0x29f6a2=_0x3162d8(0xed);!_0x1f10cd&&_0x3b34a2[_0x3162d8(0x149)]?.[_0x3162d8(0xf2)]&&(_0x1f10cd=_0x3b34a2['data'][_0x3162d8(0xf2)]);break;case _0x3162d8(0x103):case'ACT':default:_0x29f6a2='PENDING';break;}break;}const _0x2b820e={};return _0x3b34a2[_0x3162d8(0x149)]?.[_0x3162d8(0x114)]?.['last4']&&(_0x2b820e[_0x3162d8(0xef)]=_0x3b34a2[_0x3162d8(0x149)][_0x3162d8(0x114)]['last4']),_0x3b34a2[_0x3162d8(0x149)]?.[_0x3162d8(0x100)]&&(_0x2b820e[_0x3162d8(0x155)]=_0x3b34a2[_0x3162d8(0x149)][_0x3162d8(0x100)]),_0x3b34a2[_0x3162d8(0x149)]?.[_0x3162d8(0x10b)]&&(_0x2b820e[_0x3162d8(0x156)]=_0x3b34a2[_0x3162d8(0x149)][_0x3162d8(0x10b)]),_0x3b34a2[_0x3162d8(0x149)]?.[_0x3162d8(0xf9)]&&(_0x2b820e[_0x3162d8(0x120)]=_0x3b34a2[_0x3162d8(0x149)][_0x3162d8(0xf9)]),console[_0x3162d8(0x107)]('üîÑ\x20Rapyd\x20webhook\x20processed:\x20status='+_0x29f6a2+_0x3162d8(0x11a)+(_0x1f10cd||'none')),{'paymentId':_0x3b34a2['data']?.[_0x3162d8(0x128)]||'','status':_0x29f6a2,'amount':_0x3b34a2['data']?.[_0x3162d8(0x151)],'currency':_0x3b34a2[_0x3162d8(0x149)]?.[_0x3162d8(0x12a)],'failureMessage':_0x1f10cd,'additionalInfo':_0x2b820e};}}exports['RapydService']=RapydService;