'use strict';const a48_0x521fa6=a48_0x486f;(function(_0x44cede,_0x565790){const _0x59189f=a48_0x486f,_0x1a7045=_0x44cede();while(!![]){try{const _0x33171c=-parseInt(_0x59189f(0x84))/0x1+-parseInt(_0x59189f(0xa3))/0x2+parseInt(_0x59189f(0xfb))/0x3*(-parseInt(_0x59189f(0xf0))/0x4)+-parseInt(_0x59189f(0x9b))/0x5*(parseInt(_0x59189f(0xf4))/0x6)+-parseInt(_0x59189f(0xbc))/0x7+parseInt(_0x59189f(0x85))/0x8+parseInt(_0x59189f(0xd3))/0x9;if(_0x33171c===_0x565790)break;else _0x1a7045['push'](_0x1a7045['shift']());}catch(_0x63c549){_0x1a7045['push'](_0x1a7045['shift']());}}}(a48_0x5243,0xb32a9));Object[a48_0x521fa6(0xc4)](exports,'__esModule',{'value':!![]}),exports[a48_0x521fa6(0x91)]=void 0x0;function a48_0x486f(_0x4d3380,_0x20f0fe){const _0x5243f7=a48_0x5243();return a48_0x486f=function(_0x486fe9,_0x5eeb98){_0x486fe9=_0x486fe9-0x81;let _0x490322=_0x5243f7[_0x486fe9];return _0x490322;},a48_0x486f(_0x4d3380,_0x20f0fe);}function a48_0x5243(){const _0x4555cb=['processWebhook','apiUrl','gb_visa_card','stack','ORDER:\x20','floor','gb_mastercard_card','ACT','668vYwkJm','data','text','===\x20RAPYD\x20API\x20RESPONSE\x20(White\x20Domain)\x20===','6qzPEkk','merchant_reference_id','Status:','URL:','===\x20RAPYD\x20SUCCESS\x20===','Request\x20Body\x20(Updated\x20Format):','JSON\x20Parse\x20Error:\x20','3783eiempn','cardLast4','toISOString','Headers:','GET','Raw\x20Response\x20Body:','NEW','💳\x20Payment\x20Methods:\x20gb_visa_card,\x20gb_mastercard_card','entries','HTTP\x20error!\x20status:\x20','801010YTeuga','8892832ukVIFP','error','../loggerService','Response\x20Time:','CAN','amount','PAID','createPaymentLink','failure_message','SUCCESS','loggerService','Processing\x20Rapyd\x20webhook:','RapydService','Missing\x20id\x20or\x20redirect_url\x20in\x20response','Response\x20Body:','Rapyd\x20API\x20error:\x20','stringify',',\x20body:\x20','payment_method_data','🔄\x20Rapyd\x20webhook\x20processed:\x20status=','Failed\x20to\x20create\x20Rapyd\x20payment\x20link:\x20','):\x20','1342385HNxJNx','buy','fromEntries','expiration','===\x20RAPYD\x20API\x20ERROR\x20===','\x20\x20\x20expiration:\x20','errorCode','TesSoft\x20Payment\x20System/1.0','1900800RUIgeN','===\x20RAPYD\x20API\x20BUSINESS\x20ERROR\x20===','\x20(always\x20GB\x20for\x20Rapyd)','none','message','https://tesoft.uk/gateway/rapyd/','toUpperCase','💥\x20Rapyd\x20failure\x20message:\x20','last4','Error\x20message:','payment_method_type','logWhiteDomainError','logWhiteDomainResponse','/v1/hosted/payment_links','Rapyd\x20API\x20error\x20(','Parsed\x20Result:','FAILED','application/json','rapyd','PAYMENT_FAILED','log','PAYMENT_EXPIRED','\x20\x20\x20fixed_side:\x20buy','🇬🇧\x20Using\x20GB\x20(Britain)\x20as\x20country\x20for\x20Rapyd\x20payment\x20link','json','6097441EynYGF','Failed\x20to\x20verify\x20Rapyd\x20payment:\x20','HTTP\x20Status:','CLO','ERR','Payment\x20Link\x20ID:','Failed\x20to\x20parse\x20JSON\x20response:','EUR','defineProperty','headers','Error\x20stack:','PAYMENT_CANCELED','Invalid\x20JSON\x20response\x20from\x20Rapyd\x20API:\x20','/v1/hosted/payment_links/','Rapyd\x20payment\x20verification\x20error:','paid','\x20\x20\x20requested_currency:\x20EUR','now','Business\x20Error\x20(','Response\x20data:','status','redirect_url','===\x20RAPYD\x20SERVICE\x20ERROR\x20===','24514182jwbajQ','===\x20PARSED\x20RAPYD\x20RESPONSE\x20===','POST','failureCode','failure_code','EXP','https://tesoft.uk/gateway/success.php?id=','Error\x20Message:','===\x20RAPYD\x20API\x20INCOMPLETE\x20RESPONSE\x20===','UNKNOWN','statusText','Unknown\x20error\x20from\x20Rapyd\x20API','HTTP\x20','verifyPayment','EXPIRED','parse','🇬🇧\x20Country:\x20','PENDING','Unknown\x20error','type','error_code'];a48_0x5243=function(){return _0x4555cb;};return a48_0x5243();}const loggerService_1=require(a48_0x521fa6(0x87));class RapydService{constructor(){const _0x3ce012=a48_0x521fa6;this['apiUrl']=_0x3ce012(0xa8),console[_0x3ce012(0xb7)]('🌐\x20Rapyd\x20service\x20initialized\x20with\x20white\x20domain\x20proxy');}async[a48_0x521fa6(0x8c)](_0x1c27b7){const _0x1be2b9=a48_0x521fa6,{orderId:_0x117c55,orderName:_0x59acd0,amount:_0x4b7d65,currency:_0x225b66,usage:_0x4bf30e,maxPayments:_0x2dafae,successUrl:_0x46f87c,failUrl:_0x18e907}=_0x1c27b7,_0x4f635f=_0x225b66['toUpperCase'](),_0x11eaf4='GB';console['log'](_0x1be2b9(0xba));const _0x48c85a=_0x1be2b9(0xd9)+_0x117c55,_0x4536b4='https://tesoft.uk/gateway/fail.php?id='+_0x117c55,_0x183887={'amount':_0x4b7d65,'currency':_0x4f635f,'cancel_checkout_url':_0x4536b4,'complete_checkout_url':_0x48c85a,'complete_payment_url':_0x48c85a,'merchant_reference_id':_0x117c55,'description':_0x1be2b9(0xec)+_0x117c55,'country':'GB','payment_method_types_include':[_0x1be2b9(0xea),_0x1be2b9(0xee)],'custom_elements':{'display_description':!![]}};if(_0x4f635f!==_0x1be2b9(0xc3)){const _0x5cfb5d=Math[_0x1be2b9(0xed)](Date[_0x1be2b9(0xcd)]()/0x3e8)+0x1e*0x3c;_0x183887['fixed_side']=_0x1be2b9(0x9c),_0x183887['requested_currency']=_0x1be2b9(0xc3),_0x183887[_0x1be2b9(0x9e)]=_0x5cfb5d,console['log']('💱\x20Adding\x20currency\x20conversion\x20fields\x20for\x20'+_0x4f635f+'\x20->\x20EUR:'),console['log'](_0x1be2b9(0xb9)),console[_0x1be2b9(0xb7)](_0x1be2b9(0xcc)),console['log'](_0x1be2b9(0xa0)+_0x5cfb5d+'\x20('+new Date(_0x5cfb5d*0x3e8)[_0x1be2b9(0xfd)]()+')');}const _0x1af41b=Date[_0x1be2b9(0xcd)]();try{console['log']('===\x20RAPYD\x20API\x20REQUEST\x20(White\x20Domain\x20-\x20Updated\x20Format)\x20==='),console[_0x1be2b9(0xb7)](_0x1be2b9(0xf7),this[_0x1be2b9(0xe9)]),console['log'](_0x1be2b9(0xf9),JSON[_0x1be2b9(0x95)](_0x183887,null,0x2)),console['log'](_0x1be2b9(0xe3)+_0x11eaf4+_0x1be2b9(0xa5)),console[_0x1be2b9(0xb7)]('💳\x20Payment\x20Methods:\x20gb_visa_card,\x20gb_mastercard_card'),loggerService_1[_0x1be2b9(0x8f)]['logWhiteDomainRequest']('rapyd',_0x1be2b9(0xb0),'POST',_0x183887);const _0x198c72=await fetch(this[_0x1be2b9(0xe9)],{'method':_0x1be2b9(0xd5),'headers':{'Content-Type':_0x1be2b9(0xb4),'User-Agent':'TesSoft\x20Payment\x20System/1.0'},'body':JSON[_0x1be2b9(0x95)](_0x183887)}),_0x476fb8=Date[_0x1be2b9(0xcd)]()-_0x1af41b;console[_0x1be2b9(0xb7)](_0x1be2b9(0xf3)),console['log'](_0x1be2b9(0xf6),_0x198c72[_0x1be2b9(0xd0)]),console[_0x1be2b9(0xb7)]('Status\x20Text:',_0x198c72[_0x1be2b9(0xdd)]),console[_0x1be2b9(0xb7)](_0x1be2b9(0xfe),Object[_0x1be2b9(0x9d)](_0x198c72[_0x1be2b9(0xc5)][_0x1be2b9(0x82)]())),console['log'](_0x1be2b9(0x88),_0x476fb8+'ms');const _0x547e4d=await _0x198c72['text']();console['log'](_0x1be2b9(0x100),_0x547e4d);if(!_0x198c72['ok']){console[_0x1be2b9(0x86)](_0x1be2b9(0x9f)),console[_0x1be2b9(0x86)](_0x1be2b9(0xbe),_0x198c72[_0x1be2b9(0xd0)]),console[_0x1be2b9(0x86)](_0x1be2b9(0x93),_0x547e4d),loggerService_1[_0x1be2b9(0x8f)][_0x1be2b9(0xaf)](_0x1be2b9(0xb5),_0x1be2b9(0xb0),_0x198c72[_0x1be2b9(0xd0)],_0x547e4d,_0x476fb8),loggerService_1[_0x1be2b9(0x8f)]['logWhiteDomainError']('rapyd',_0x1be2b9(0xb0),_0x1be2b9(0xdf)+_0x198c72['status']+':\x20'+_0x547e4d);throw new Error(_0x1be2b9(0x83)+_0x198c72[_0x1be2b9(0xd0)]+_0x1be2b9(0x96)+_0x547e4d);}let _0x3b04b4;try{_0x3b04b4=JSON[_0x1be2b9(0xe2)](_0x547e4d);}catch(_0x41acc6){console['error'](_0x1be2b9(0xc2),_0x41acc6),loggerService_1[_0x1be2b9(0x8f)][_0x1be2b9(0xae)]('rapyd',_0x1be2b9(0xb0),_0x1be2b9(0xfa)+_0x41acc6);throw new Error(_0x1be2b9(0xc8)+_0x547e4d);}console['log'](_0x1be2b9(0xd4)),console['log'](_0x1be2b9(0xb2),JSON[_0x1be2b9(0x95)](_0x3b04b4,null,0x2)),loggerService_1['loggerService']['logWhiteDomainResponse'](_0x1be2b9(0xb5),'/v1/hosted/payment_links',_0x198c72[_0x1be2b9(0xd0)],_0x3b04b4,_0x476fb8);if(_0x3b04b4[_0x1be2b9(0xd0)]?.[_0x1be2b9(0xd0)]!==_0x1be2b9(0x8e)){const _0x47da1e=_0x3b04b4['status']?.['message']||_0x1be2b9(0xde),_0xdbde87=_0x3b04b4[_0x1be2b9(0xd0)]?.[_0x1be2b9(0xe7)]||_0x1be2b9(0xdc);console[_0x1be2b9(0x86)](_0x1be2b9(0xa4)),console['error']('Error\x20Code:',_0xdbde87),console[_0x1be2b9(0x86)](_0x1be2b9(0xda),_0x47da1e),console['error']('Full\x20Error\x20Data:',_0x3b04b4[_0x1be2b9(0xd0)]),loggerService_1[_0x1be2b9(0x8f)][_0x1be2b9(0xae)](_0x1be2b9(0xb5),_0x1be2b9(0xb0),_0x1be2b9(0xce)+_0xdbde87+_0x1be2b9(0x9a)+_0x47da1e);throw new Error(_0x1be2b9(0xb1)+_0xdbde87+_0x1be2b9(0x9a)+_0x47da1e);}if(!_0x3b04b4[_0x1be2b9(0xf1)]?.['id']||!_0x3b04b4[_0x1be2b9(0xf1)]?.[_0x1be2b9(0xd1)]){console[_0x1be2b9(0x86)](_0x1be2b9(0xdb)),console['error'](_0x1be2b9(0x92)),console[_0x1be2b9(0x86)](_0x1be2b9(0xcf),_0x3b04b4[_0x1be2b9(0xf1)]),loggerService_1[_0x1be2b9(0x8f)]['logWhiteDomainError'](_0x1be2b9(0xb5),'/v1/hosted/payment_links','Incomplete\x20response:\x20missing\x20id\x20or\x20redirect_url');throw new Error('Invalid\x20response\x20from\x20Rapyd\x20API:\x20missing\x20id\x20or\x20redirect_url');}return console[_0x1be2b9(0xb7)](_0x1be2b9(0xf8)),console[_0x1be2b9(0xb7)](_0x1be2b9(0xc1),_0x3b04b4[_0x1be2b9(0xf1)]['id']),console[_0x1be2b9(0xb7)]('Redirect\x20URL:',_0x3b04b4[_0x1be2b9(0xf1)]['redirect_url']),console['log']('🇬🇧\x20Country\x20used:\x20'+_0x11eaf4+'\x20(GB\x20-\x20Britain)'),console[_0x1be2b9(0xb7)](_0x1be2b9(0x81)),{'gateway_payment_id':_0x3b04b4[_0x1be2b9(0xf1)]['id'],'payment_url':_0x3b04b4[_0x1be2b9(0xf1)][_0x1be2b9(0xd1)]};}catch(_0xb0f093){console[_0x1be2b9(0x86)](_0x1be2b9(0xd2)),console[_0x1be2b9(0x86)]('Error\x20details:',_0xb0f093),loggerService_1['loggerService'][_0x1be2b9(0xae)]('rapyd',_0x1be2b9(0xb0),_0xb0f093);if(_0xb0f093 instanceof Error){console[_0x1be2b9(0x86)](_0x1be2b9(0xac),_0xb0f093[_0x1be2b9(0xa7)]),console['error'](_0x1be2b9(0xc6),_0xb0f093[_0x1be2b9(0xeb)]);throw new Error(_0x1be2b9(0x99)+_0xb0f093[_0x1be2b9(0xa7)]);}throw new Error('Failed\x20to\x20create\x20Rapyd\x20payment\x20link:\x20Unknown\x20error');}}async[a48_0x521fa6(0xe0)](_0x2b638e){const _0x26e60d=a48_0x521fa6,_0x545600=Date['now']();try{loggerService_1[_0x26e60d(0x8f)]['logWhiteDomainRequest']('rapyd',_0x26e60d(0xc9)+_0x2b638e,_0x26e60d(0xff),{});const _0x174622=await fetch(this['apiUrl']+'/'+_0x2b638e,{'method':_0x26e60d(0xff),'headers':{'Content-Type':_0x26e60d(0xb4),'User-Agent':_0x26e60d(0xa2)}}),_0x8869ab=Date[_0x26e60d(0xcd)]()-_0x545600;if(!_0x174622['ok']){const _0x3c6b14=await _0x174622[_0x26e60d(0xf2)]();loggerService_1[_0x26e60d(0x8f)][_0x26e60d(0xaf)](_0x26e60d(0xb5),_0x26e60d(0xc9)+_0x2b638e,_0x174622['status'],_0x3c6b14,_0x8869ab);throw new Error('HTTP\x20error!\x20status:\x20'+_0x174622[_0x26e60d(0xd0)]);}const _0x56bfea=await _0x174622[_0x26e60d(0xbb)]();loggerService_1[_0x26e60d(0x8f)][_0x26e60d(0xaf)]('rapyd','/v1/hosted/payment_links/'+_0x2b638e,_0x174622[_0x26e60d(0xd0)],_0x56bfea,_0x8869ab);if(_0x56bfea[_0x26e60d(0xd0)]?.[_0x26e60d(0xd0)]!==_0x26e60d(0x8e)){loggerService_1[_0x26e60d(0x8f)][_0x26e60d(0xae)](_0x26e60d(0xb5),_0x26e60d(0xc9)+_0x2b638e,_0x26e60d(0x94)+(_0x56bfea[_0x26e60d(0xd0)]?.['message']||_0x26e60d(0xe5)));throw new Error(_0x26e60d(0x94)+(_0x56bfea[_0x26e60d(0xd0)]?.[_0x26e60d(0xa7)]||'Unknown\x20error'));}let _0x3414fc=_0x26e60d(0xe4);if(_0x56bfea[_0x26e60d(0xf1)]?.['status'])switch(_0x56bfea['data'][_0x26e60d(0xd0)][_0x26e60d(0xa9)]()){case _0x26e60d(0xbf):_0x3414fc=_0x26e60d(0x8b);break;case _0x26e60d(0x89):_0x3414fc=_0x26e60d(0xb3);break;case'EXP':_0x3414fc=_0x26e60d(0xe1);break;case _0x26e60d(0xc0):_0x3414fc='FAILED';break;case'NEW':case'ACT':default:_0x3414fc=_0x26e60d(0xe4);break;}return{'status':_0x3414fc,'amount':_0x56bfea[_0x26e60d(0xf1)]?.['amount'],'currency':_0x56bfea[_0x26e60d(0xf1)]?.['currency']};}catch(_0xcd7712){console[_0x26e60d(0x86)](_0x26e60d(0xca),_0xcd7712),loggerService_1[_0x26e60d(0x8f)]['logWhiteDomainError']('rapyd','/v1/hosted/payment_links/'+_0x2b638e,_0xcd7712);throw new Error(_0x26e60d(0xbd)+(_0xcd7712 instanceof Error?_0xcd7712[_0x26e60d(0xa7)]:_0x26e60d(0xe5)));}}async[a48_0x521fa6(0xe8)](_0x557c30){const _0x4ee3b1=a48_0x521fa6;console[_0x4ee3b1(0xb7)](_0x4ee3b1(0x90),_0x557c30);let _0x5b5acb=_0x4ee3b1(0xe4),_0x59d027;_0x557c30[_0x4ee3b1(0xf1)]?.[_0x4ee3b1(0x8d)]&&(_0x59d027=_0x557c30[_0x4ee3b1(0xf1)][_0x4ee3b1(0x8d)],console[_0x4ee3b1(0xb7)](_0x4ee3b1(0xaa)+_0x59d027));switch(_0x557c30[_0x4ee3b1(0xe6)]?.[_0x4ee3b1(0xa9)]()){case'PAYMENT_COMPLETED':_0x557c30[_0x4ee3b1(0xf1)]?.['paid']===!![]&&_0x557c30[_0x4ee3b1(0xf1)]?.[_0x4ee3b1(0xd0)]===_0x4ee3b1(0xbf)?_0x5b5acb=_0x4ee3b1(0x8b):_0x5b5acb=_0x4ee3b1(0xe4);break;case _0x4ee3b1(0xc7):_0x5b5acb=_0x4ee3b1(0xb3);break;case _0x4ee3b1(0xb8):_0x5b5acb='EXPIRED';break;case _0x4ee3b1(0xb6):_0x5b5acb='FAILED';!_0x59d027&&_0x557c30['data']?.[_0x4ee3b1(0x8d)]&&(_0x59d027=_0x557c30[_0x4ee3b1(0xf1)][_0x4ee3b1(0x8d)]);break;default:switch(_0x557c30[_0x4ee3b1(0xf1)]?.[_0x4ee3b1(0xd0)]?.['toUpperCase']()){case _0x4ee3b1(0xbf):_0x557c30[_0x4ee3b1(0xf1)]?.[_0x4ee3b1(0xcb)]===!![]?_0x5b5acb='PAID':_0x5b5acb=_0x4ee3b1(0xb3);break;case _0x4ee3b1(0x89):_0x5b5acb='FAILED';break;case _0x4ee3b1(0xd8):_0x5b5acb=_0x4ee3b1(0xe1);break;case _0x4ee3b1(0xc0):_0x5b5acb='FAILED';!_0x59d027&&_0x557c30[_0x4ee3b1(0xf1)]?.[_0x4ee3b1(0x8d)]&&(_0x59d027=_0x557c30[_0x4ee3b1(0xf1)][_0x4ee3b1(0x8d)]);break;case _0x4ee3b1(0x101):case _0x4ee3b1(0xef):default:_0x5b5acb='PENDING';break;}break;}const _0x577642={};return _0x557c30['data']?.[_0x4ee3b1(0x97)]?.[_0x4ee3b1(0xab)]&&(_0x577642[_0x4ee3b1(0xfc)]=_0x557c30[_0x4ee3b1(0xf1)][_0x4ee3b1(0x97)]['last4']),_0x557c30[_0x4ee3b1(0xf1)]?.[_0x4ee3b1(0xad)]&&(_0x577642['paymentMethod']=_0x557c30[_0x4ee3b1(0xf1)][_0x4ee3b1(0xad)]),_0x557c30[_0x4ee3b1(0xf1)]?.[_0x4ee3b1(0xe7)]&&(_0x577642[_0x4ee3b1(0xa1)]=_0x557c30[_0x4ee3b1(0xf1)][_0x4ee3b1(0xe7)]),_0x557c30[_0x4ee3b1(0xf1)]?.[_0x4ee3b1(0xd7)]&&(_0x577642[_0x4ee3b1(0xd6)]=_0x557c30[_0x4ee3b1(0xf1)][_0x4ee3b1(0xd7)]),console['log'](_0x4ee3b1(0x98)+_0x5b5acb+',\x20failureMessage='+(_0x59d027||_0x4ee3b1(0xa6))),{'paymentId':_0x557c30['data']?.[_0x4ee3b1(0xf5)]||'','status':_0x5b5acb,'amount':_0x557c30[_0x4ee3b1(0xf1)]?.[_0x4ee3b1(0x8a)],'currency':_0x557c30['data']?.['currency'],'failureMessage':_0x59d027,'additionalInfo':_0x577642};}}exports[a48_0x521fa6(0x91)]=RapydService;