'use strict';const a49_0x446491=a49_0x34d0;(function(_0x4a15d1,_0x197ed8){const _0x3cd709=a49_0x34d0,_0x2c7382=_0x4a15d1();while(!![]){try{const _0xb36020=-parseInt(_0x3cd709(0x8a))/0x1*(parseInt(_0x3cd709(0xc6))/0x2)+parseInt(_0x3cd709(0x8c))/0x3*(parseInt(_0x3cd709(0xf8))/0x4)+-parseInt(_0x3cd709(0xec))/0x5*(-parseInt(_0x3cd709(0xb7))/0x6)+parseInt(_0x3cd709(0xac))/0x7+-parseInt(_0x3cd709(0x105))/0x8*(parseInt(_0x3cd709(0x95))/0x9)+-parseInt(_0x3cd709(0xb4))/0xa+parseInt(_0x3cd709(0x90))/0xb;if(_0xb36020===_0x197ed8)break;else _0x2c7382['push'](_0x2c7382['shift']());}catch(_0x533d16){_0x2c7382['push'](_0x2c7382['shift']());}}}(a49_0x293b,0x9be7e));function a49_0x293b(){const _0x34a8ba=['Status:','NEW','🇬🇧\x20Country\x20used:\x20','💥\x20Rapyd\x20failure\x20message:\x20','createPaymentLink','Response\x20data:','entries','error_code','logWhiteDomainError','4424pRNKZq','EXP','message',',\x20failureMessage=','application/json','redirect_url','PAYMENT_EXPIRED','95bqBpoG','PAID','105gnFXEn','\x20\x20\x20fixed_side:\x20buy','UNKNOWN','PAYMENT_FAILED','3420428ObJexw','failure_message','stack','merchant_reference_id','EXPIRED','1341bvhAEc','loggerService','rapyd',',\x20body:\x20','FAILED','Raw\x20Response\x20Body:','URL:','status','none','):\x20','/v1/hosted/payment_links','===\x20RAPYD\x20API\x20REQUEST\x20(White\x20Domain\x20-\x20Updated\x20Format)\x20===','===\x20RAPYD\x20API\x20INCOMPLETE\x20RESPONSE\x20===','ERR','JSON\x20Parse\x20Error:\x20','failureCode','Payment\x20Link\x20ID:','GET','gb_visa_card','https://tesoft.uk/gateway/success.php?id=','HTTP\x20','RapydService','Unknown\x20error\x20from\x20Rapyd\x20API','1037869GqkbrD','\x20\x20\x20requested_currency:\x20EUR','failure_code','Missing\x20id\x20or\x20redirect_url\x20in\x20response','===\x20PARSED\x20RAPYD\x20RESPONSE\x20===','===\x20RAPYD\x20API\x20BUSINESS\x20ERROR\x20===','🌐\x20Rapyd\x20service\x20initialized\x20with\x20white\x20domain\x20proxy','\x20->\x20EUR:','1443990BAfLjH','https://tesoft.uk/gateway/rapyd/','EUR','1846266WCLqRI','error','text','gb_mastercard_card','Rapyd\x20API\x20error:\x20','CLO','💳\x20Payment\x20Methods:\x20gb_visa_card,\x20gb_mastercard_card','buy','Error\x20Code:','===\x20RAPYD\x20SUCCESS\x20===','SUCCESS','PENDING','requested_currency','Failed\x20to\x20create\x20Rapyd\x20payment\x20link:\x20Unknown\x20error','Error\x20stack:','3830htIsmE','Invalid\x20response\x20from\x20Rapyd\x20API:\x20missing\x20id\x20or\x20redirect_url','/v1/hosted/payment_links/','\x20\x20\x20expiration:\x20','Unknown\x20error','Processing\x20Rapyd\x20webhook:','ORDER:\x20','Failed\x20to\x20verify\x20Rapyd\x20payment:\x20','headers','HTTP\x20Status:','HTTP\x20error!\x20status:\x20','🇬🇧\x20Country:\x20','apiUrl','Failed\x20to\x20parse\x20JSON\x20response:','payment_method_type','last4','Request\x20Body\x20(Updated\x20Format):','ACT','fromEntries','===\x20RAPYD\x20SERVICE\x20ERROR\x20===','processWebhook','payment_method_data','amount','fixed_side','verifyPayment','Rapyd\x20API\x20error\x20(','CAN','Redirect\x20URL:','stringify','Headers:','Business\x20Error\x20(','POST','\x20(always\x20GB\x20for\x20Rapyd)','Incomplete\x20response:\x20missing\x20id\x20or\x20redirect_url','toUpperCase','🔄\x20Rapyd\x20webhook\x20processed:\x20status=','floor','Response\x20Time:','5oSbYnv','defineProperty','log','logWhiteDomainResponse','../loggerService','PAYMENT_CANCELED','expiration','logWhiteDomainRequest','parse','now','toISOString','Error\x20message:','32044RPFdpf','Full\x20Error\x20Data:','TesSoft\x20Payment\x20System/1.0','data'];a49_0x293b=function(){return _0x34a8ba;};return a49_0x293b();}function a49_0x34d0(_0x1ea956,_0x27f2d6){const _0x293b52=a49_0x293b();return a49_0x34d0=function(_0x34d03a,_0x4a6a18){_0x34d03a=_0x34d03a-0x8a;let _0x3b43ae=_0x293b52[_0x34d03a];return _0x3b43ae;},a49_0x34d0(_0x1ea956,_0x27f2d6);}Object[a49_0x446491(0xed)](exports,'__esModule',{'value':!![]}),exports[a49_0x446491(0xaa)]=void 0x0;const loggerService_1=require(a49_0x446491(0xf0));class RapydService{constructor(){const _0x4a552e=a49_0x446491;this['apiUrl']=_0x4a552e(0xb5),console['log'](_0x4a552e(0xb2));}async[a49_0x446491(0x100)](_0x4c0da3){const _0x3879f6=a49_0x446491,{orderId:_0x4f64c7,orderName:_0x1aedca,amount:_0xd81d71,currency:_0x2c8805,usage:_0x421ce3,maxPayments:_0x57a292,successUrl:_0x3d93e6,failUrl:_0x598d8c}=_0x4c0da3,_0x4734f9=_0x2c8805[_0x3879f6(0xe8)](),_0x56afa2='GB';console[_0x3879f6(0xee)]('🇬🇧\x20Using\x20GB\x20(Britain)\x20as\x20country\x20for\x20Rapyd\x20payment\x20link');const _0x420383=_0x3879f6(0xa8)+_0x4f64c7,_0x660419='https://tesoft.uk/gateway/fail.php?id='+_0x4f64c7,_0x308561={'amount':_0xd81d71,'currency':_0x4734f9,'cancel_checkout_url':_0x660419,'complete_checkout_url':_0x420383,'complete_payment_url':_0x420383,'merchant_reference_id':_0x4f64c7,'description':_0x3879f6(0xcc)+_0x4f64c7,'country':'GB','payment_method_types_include':[_0x3879f6(0xa7),_0x3879f6(0xba)],'custom_elements':{'display_description':!![]}};if(_0x4734f9!==_0x3879f6(0xb6)){const _0x3fba2c=Math[_0x3879f6(0xea)](Date[_0x3879f6(0xf5)]()/0x3e8)+0x1e*0x3c;_0x308561[_0x3879f6(0xdd)]=_0x3879f6(0xbe),_0x308561[_0x3879f6(0xc3)]=_0x3879f6(0xb6),_0x308561[_0x3879f6(0xf2)]=_0x3fba2c,console['log']('💱\x20Adding\x20currency\x20conversion\x20fields\x20for\x20'+_0x4734f9+_0x3879f6(0xb3)),console['log'](_0x3879f6(0x8d)),console['log'](_0x3879f6(0xad)),console['log'](_0x3879f6(0xc9)+_0x3fba2c+'\x20('+new Date(_0x3fba2c*0x3e8)[_0x3879f6(0xf6)]()+')');}const _0x272989=Date['now']();try{console['log'](_0x3879f6(0xa0)),console[_0x3879f6(0xee)](_0x3879f6(0x9b),this[_0x3879f6(0xd2)]),console[_0x3879f6(0xee)](_0x3879f6(0xd6),JSON[_0x3879f6(0xe2)](_0x308561,null,0x2)),console[_0x3879f6(0xee)](_0x3879f6(0xd1)+_0x56afa2+_0x3879f6(0xe6)),console['log'](_0x3879f6(0xbd)),loggerService_1[_0x3879f6(0x96)][_0x3879f6(0xf3)](_0x3879f6(0x97),_0x3879f6(0x9f),_0x3879f6(0xe5),_0x308561);const _0x49cfd8=await fetch(this[_0x3879f6(0xd2)],{'method':_0x3879f6(0xe5),'headers':{'Content-Type':_0x3879f6(0x109),'User-Agent':_0x3879f6(0xfa)},'body':JSON['stringify'](_0x308561)}),_0x36d928=Date[_0x3879f6(0xf5)]()-_0x272989;console[_0x3879f6(0xee)]('===\x20RAPYD\x20API\x20RESPONSE\x20(White\x20Domain)\x20==='),console[_0x3879f6(0xee)](_0x3879f6(0xfc),_0x49cfd8['status']),console['log']('Status\x20Text:',_0x49cfd8['statusText']),console[_0x3879f6(0xee)](_0x3879f6(0xe3),Object[_0x3879f6(0xd8)](_0x49cfd8[_0x3879f6(0xce)][_0x3879f6(0x102)]())),console[_0x3879f6(0xee)](_0x3879f6(0xeb),_0x36d928+'ms');const _0x85854f=await _0x49cfd8[_0x3879f6(0xb9)]();console[_0x3879f6(0xee)](_0x3879f6(0x9a),_0x85854f);if(!_0x49cfd8['ok']){console['error']('===\x20RAPYD\x20API\x20ERROR\x20==='),console['error'](_0x3879f6(0xcf),_0x49cfd8[_0x3879f6(0x9c)]),console[_0x3879f6(0xb8)]('Response\x20Body:',_0x85854f),loggerService_1['loggerService'][_0x3879f6(0xef)]('rapyd','/v1/hosted/payment_links',_0x49cfd8['status'],_0x85854f,_0x36d928),loggerService_1[_0x3879f6(0x96)]['logWhiteDomainError'](_0x3879f6(0x97),_0x3879f6(0x9f),_0x3879f6(0xa9)+_0x49cfd8[_0x3879f6(0x9c)]+':\x20'+_0x85854f);throw new Error(_0x3879f6(0xd0)+_0x49cfd8['status']+_0x3879f6(0x98)+_0x85854f);}let _0x164d54;try{_0x164d54=JSON[_0x3879f6(0xf4)](_0x85854f);}catch(_0x3480de){console[_0x3879f6(0xb8)](_0x3879f6(0xd3),_0x3480de),loggerService_1[_0x3879f6(0x96)][_0x3879f6(0x104)](_0x3879f6(0x97),_0x3879f6(0x9f),_0x3879f6(0xa3)+_0x3480de);throw new Error('Invalid\x20JSON\x20response\x20from\x20Rapyd\x20API:\x20'+_0x85854f);}console[_0x3879f6(0xee)](_0x3879f6(0xb0)),console['log']('Parsed\x20Result:',JSON['stringify'](_0x164d54,null,0x2)),loggerService_1[_0x3879f6(0x96)][_0x3879f6(0xef)](_0x3879f6(0x97),_0x3879f6(0x9f),_0x49cfd8[_0x3879f6(0x9c)],_0x164d54,_0x36d928);if(_0x164d54[_0x3879f6(0x9c)]?.[_0x3879f6(0x9c)]!==_0x3879f6(0xc1)){const _0x5a37f3=_0x164d54['status']?.['message']||_0x3879f6(0xab),_0x3a1037=_0x164d54['status']?.[_0x3879f6(0x103)]||_0x3879f6(0x8e);console[_0x3879f6(0xb8)](_0x3879f6(0xb1)),console[_0x3879f6(0xb8)](_0x3879f6(0xbf),_0x3a1037),console['error']('Error\x20Message:',_0x5a37f3),console[_0x3879f6(0xb8)](_0x3879f6(0xf9),_0x164d54[_0x3879f6(0x9c)]),loggerService_1[_0x3879f6(0x96)]['logWhiteDomainError'](_0x3879f6(0x97),_0x3879f6(0x9f),_0x3879f6(0xe4)+_0x3a1037+_0x3879f6(0x9e)+_0x5a37f3);throw new Error(_0x3879f6(0xdf)+_0x3a1037+_0x3879f6(0x9e)+_0x5a37f3);}if(!_0x164d54[_0x3879f6(0xfb)]?.['id']||!_0x164d54[_0x3879f6(0xfb)]?.['redirect_url']){console[_0x3879f6(0xb8)](_0x3879f6(0xa1)),console[_0x3879f6(0xb8)](_0x3879f6(0xaf)),console[_0x3879f6(0xb8)](_0x3879f6(0x101),_0x164d54['data']),loggerService_1[_0x3879f6(0x96)][_0x3879f6(0x104)]('rapyd',_0x3879f6(0x9f),_0x3879f6(0xe7));throw new Error(_0x3879f6(0xc7));}return console[_0x3879f6(0xee)](_0x3879f6(0xc0)),console[_0x3879f6(0xee)](_0x3879f6(0xa5),_0x164d54['data']['id']),console['log'](_0x3879f6(0xe1),_0x164d54[_0x3879f6(0xfb)][_0x3879f6(0x10a)]),console['log'](_0x3879f6(0xfe)+_0x56afa2+'\x20(GB\x20-\x20Britain)'),console[_0x3879f6(0xee)](_0x3879f6(0xbd)),{'gateway_payment_id':_0x164d54['data']['id'],'payment_url':_0x164d54[_0x3879f6(0xfb)][_0x3879f6(0x10a)]};}catch(_0x52bacc){console[_0x3879f6(0xb8)](_0x3879f6(0xd9)),console['error']('Error\x20details:',_0x52bacc),loggerService_1[_0x3879f6(0x96)][_0x3879f6(0x104)](_0x3879f6(0x97),_0x3879f6(0x9f),_0x52bacc);if(_0x52bacc instanceof Error){console['error'](_0x3879f6(0xf7),_0x52bacc['message']),console['error'](_0x3879f6(0xc5),_0x52bacc[_0x3879f6(0x92)]);throw new Error('Failed\x20to\x20create\x20Rapyd\x20payment\x20link:\x20'+_0x52bacc[_0x3879f6(0x107)]);}throw new Error(_0x3879f6(0xc4));}}async[a49_0x446491(0xde)](_0x9e5b6d){const _0xacd0da=a49_0x446491,_0x6c4b23=Date['now']();try{loggerService_1[_0xacd0da(0x96)][_0xacd0da(0xf3)](_0xacd0da(0x97),'/v1/hosted/payment_links/'+_0x9e5b6d,_0xacd0da(0xa6),{});const _0x308fc2=await fetch(this[_0xacd0da(0xd2)]+'/'+_0x9e5b6d,{'method':_0xacd0da(0xa6),'headers':{'Content-Type':'application/json','User-Agent':_0xacd0da(0xfa)}}),_0x5c7622=Date[_0xacd0da(0xf5)]()-_0x6c4b23;if(!_0x308fc2['ok']){const _0x138a91=await _0x308fc2['text']();loggerService_1[_0xacd0da(0x96)][_0xacd0da(0xef)]('rapyd',_0xacd0da(0xc8)+_0x9e5b6d,_0x308fc2[_0xacd0da(0x9c)],_0x138a91,_0x5c7622);throw new Error(_0xacd0da(0xd0)+_0x308fc2['status']);}const _0x4245c2=await _0x308fc2['json']();loggerService_1['loggerService']['logWhiteDomainResponse'](_0xacd0da(0x97),_0xacd0da(0xc8)+_0x9e5b6d,_0x308fc2['status'],_0x4245c2,_0x5c7622);if(_0x4245c2[_0xacd0da(0x9c)]?.[_0xacd0da(0x9c)]!=='SUCCESS'){loggerService_1[_0xacd0da(0x96)][_0xacd0da(0x104)]('rapyd','/v1/hosted/payment_links/'+_0x9e5b6d,_0xacd0da(0xbb)+(_0x4245c2[_0xacd0da(0x9c)]?.[_0xacd0da(0x107)]||_0xacd0da(0xca)));throw new Error(_0xacd0da(0xbb)+(_0x4245c2['status']?.['message']||_0xacd0da(0xca)));}let _0x50f009=_0xacd0da(0xc2);if(_0x4245c2[_0xacd0da(0xfb)]?.[_0xacd0da(0x9c)])switch(_0x4245c2[_0xacd0da(0xfb)][_0xacd0da(0x9c)][_0xacd0da(0xe8)]()){case'CLO':_0x50f009=_0xacd0da(0x8b);break;case _0xacd0da(0xe0):_0x50f009=_0xacd0da(0x99);break;case _0xacd0da(0x106):_0x50f009=_0xacd0da(0x94);break;case _0xacd0da(0xa2):_0x50f009=_0xacd0da(0x99);break;case _0xacd0da(0xfd):case _0xacd0da(0xd7):default:_0x50f009=_0xacd0da(0xc2);break;}return{'status':_0x50f009,'amount':_0x4245c2[_0xacd0da(0xfb)]?.[_0xacd0da(0xdc)],'currency':_0x4245c2[_0xacd0da(0xfb)]?.['currency']};}catch(_0x20bafc){console[_0xacd0da(0xb8)]('Rapyd\x20payment\x20verification\x20error:',_0x20bafc),loggerService_1[_0xacd0da(0x96)][_0xacd0da(0x104)](_0xacd0da(0x97),_0xacd0da(0xc8)+_0x9e5b6d,_0x20bafc);throw new Error(_0xacd0da(0xcd)+(_0x20bafc instanceof Error?_0x20bafc[_0xacd0da(0x107)]:_0xacd0da(0xca)));}}async[a49_0x446491(0xda)](_0x3f9de9){const _0x380dfa=a49_0x446491;console[_0x380dfa(0xee)](_0x380dfa(0xcb),_0x3f9de9);let _0x1e47e8=_0x380dfa(0xc2),_0x4e3ab8;_0x3f9de9[_0x380dfa(0xfb)]?.[_0x380dfa(0x91)]&&(_0x4e3ab8=_0x3f9de9[_0x380dfa(0xfb)][_0x380dfa(0x91)],console[_0x380dfa(0xee)](_0x380dfa(0xff)+_0x4e3ab8));switch(_0x3f9de9['type']?.[_0x380dfa(0xe8)]()){case'PAYMENT_COMPLETED':_0x3f9de9[_0x380dfa(0xfb)]?.['paid']===!![]&&_0x3f9de9[_0x380dfa(0xfb)]?.[_0x380dfa(0x9c)]==='CLO'?_0x1e47e8='PAID':_0x1e47e8=_0x380dfa(0xc2);break;case _0x380dfa(0xf1):_0x1e47e8='FAILED';break;case _0x380dfa(0x10b):_0x1e47e8='EXPIRED';break;case _0x380dfa(0x8f):_0x1e47e8=_0x380dfa(0x99);!_0x4e3ab8&&_0x3f9de9[_0x380dfa(0xfb)]?.[_0x380dfa(0x91)]&&(_0x4e3ab8=_0x3f9de9[_0x380dfa(0xfb)][_0x380dfa(0x91)]);break;default:switch(_0x3f9de9[_0x380dfa(0xfb)]?.[_0x380dfa(0x9c)]?.['toUpperCase']()){case _0x380dfa(0xbc):_0x3f9de9[_0x380dfa(0xfb)]?.['paid']===!![]?_0x1e47e8=_0x380dfa(0x8b):_0x1e47e8='FAILED';break;case _0x380dfa(0xe0):_0x1e47e8=_0x380dfa(0x99);break;case'EXP':_0x1e47e8=_0x380dfa(0x94);break;case _0x380dfa(0xa2):_0x1e47e8=_0x380dfa(0x99);!_0x4e3ab8&&_0x3f9de9[_0x380dfa(0xfb)]?.[_0x380dfa(0x91)]&&(_0x4e3ab8=_0x3f9de9['data'][_0x380dfa(0x91)]);break;case _0x380dfa(0xfd):case'ACT':default:_0x1e47e8=_0x380dfa(0xc2);break;}break;}const _0x8c0895={};return _0x3f9de9[_0x380dfa(0xfb)]?.[_0x380dfa(0xdb)]?.['last4']&&(_0x8c0895['cardLast4']=_0x3f9de9[_0x380dfa(0xfb)][_0x380dfa(0xdb)][_0x380dfa(0xd5)]),_0x3f9de9['data']?.[_0x380dfa(0xd4)]&&(_0x8c0895['paymentMethod']=_0x3f9de9[_0x380dfa(0xfb)][_0x380dfa(0xd4)]),_0x3f9de9['data']?.[_0x380dfa(0x103)]&&(_0x8c0895['errorCode']=_0x3f9de9['data'][_0x380dfa(0x103)]),_0x3f9de9[_0x380dfa(0xfb)]?.[_0x380dfa(0xae)]&&(_0x8c0895[_0x380dfa(0xa4)]=_0x3f9de9[_0x380dfa(0xfb)]['failure_code']),console['log'](_0x380dfa(0xe9)+_0x1e47e8+_0x380dfa(0x108)+(_0x4e3ab8||_0x380dfa(0x9d))),{'paymentId':_0x3f9de9[_0x380dfa(0xfb)]?.[_0x380dfa(0x93)]||'','status':_0x1e47e8,'amount':_0x3f9de9['data']?.['amount'],'currency':_0x3f9de9[_0x380dfa(0xfb)]?.['currency'],'failureMessage':_0x4e3ab8,'additionalInfo':_0x8c0895};}}exports[a49_0x446491(0xaa)]=RapydService;