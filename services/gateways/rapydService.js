'use strict';function a42_0x2b12(){const _0x4f7863=['stringify','currency','errorCode','logWhiteDomainResponse','ORDER:\x20','üá¨üáß\x20Country\x20used:\x20','__esModule','Status:','Failed\x20to\x20verify\x20Rapyd\x20payment:\x20','defineProperty','status','toUpperCase','===\x20RAPYD\x20API\x20ERROR\x20===','headers','paymentMethod','rapyd','data','üá¨üáß\x20Country:\x20','SUCCESS','2143nVLeVH','payment_method_type','ACT','loggerService','paid','Invalid\x20response\x20from\x20Rapyd\x20API:\x20missing\x20id\x20or\x20redirect_url','üåê\x20Rapyd\x20service\x20initialized\x20with\x20white\x20domain\x20proxy','RapydService','log','error_code','3717885UGhuOS','fromEntries','üí•\x20Rapyd\x20failure\x20message:\x20','ERR','Error\x20stack:','Rapyd\x20API\x20error\x20(','cardLast4','failure_message','Error\x20Code:','/v1/hosted/payment_links','HTTP\x20error!\x20status:\x20','Payment\x20Link\x20ID:','FAILED','Rapyd\x20API\x20error:\x20','Full\x20Error\x20Data:','\x20(GB\x20-\x20Britain)','Unknown\x20error','statusText','https://tesoft.uk/gateway/success.php?id=','üîÑ\x20Rapyd\x20webhook\x20processed:\x20status=','https://tesoft.uk/gateway/fail.php?id=','Failed\x20to\x20create\x20Rapyd\x20payment\x20link:\x20Unknown\x20error','stack','GET','gb_mastercard_card','CAN','Request\x20Body\x20(Updated\x20Format):','8006658CpPhKk','https://tesoft.uk/gateway/rapyd/','PAYMENT_EXPIRED','/v1/hosted/payment_links/','1116DjPffm','CLO','type','6970152qXnuBX','apiUrl','Unknown\x20error\x20from\x20Rapyd\x20API','PAID','Failed\x20to\x20parse\x20JSON\x20response:','none','===\x20RAPYD\x20API\x20BUSINESS\x20ERROR\x20===','Response\x20Time:','8186199EaHPgH','merchant_reference_id','../loggerService','Processing\x20Rapyd\x20webhook:','Status\x20Text:','4913092uRcIPY','Error\x20message:','text','UNKNOWN','JSON\x20Parse\x20Error:\x20','üí≥\x20Payment\x20Methods:\x20gb_visa_card,\x20gb_mastercard_card','now','json','logWhiteDomainRequest','POST','NEW','PAYMENT_COMPLETED','gb_visa_card','message','amount','verifyPayment','63CVSrqH','failureCode','===\x20PARSED\x20RAPYD\x20RESPONSE\x20===','Invalid\x20JSON\x20response\x20from\x20Rapyd\x20API:\x20','error','entries','application/json','===\x20RAPYD\x20SUCCESS\x20===','PENDING','Incomplete\x20response:\x20missing\x20id\x20or\x20redirect_url','EXPIRED','Raw\x20Response\x20Body:','):\x20','1062978CGbCTN','payment_method_data','===\x20RAPYD\x20API\x20RESPONSE\x20(White\x20Domain)\x20===','Parsed\x20Result:','Failed\x20to\x20create\x20Rapyd\x20payment\x20link:\x20','TesSoft\x20Payment\x20System/1.0','Response\x20Body:','processWebhook','parse','Response\x20data:',',\x20body:\x20','PAYMENT_FAILED','last4','failure_code','PAYMENT_CANCELED','===\x20RAPYD\x20SERVICE\x20ERROR\x20===','EXP','logWhiteDomainError'];a42_0x2b12=function(){return _0x4f7863;};return a42_0x2b12();}const a42_0x31ed6a=a42_0x5b56;(function(_0x3c1d30,_0x3e1105){const _0x35558c=a42_0x5b56,_0x449d7f=_0x3c1d30();while(!![]){try{const _0x5cc2e5=parseInt(_0x35558c(0x123))/0x1*(-parseInt(_0x35558c(0xd1))/0x2)+parseInt(_0x35558c(0xfe))/0x3+-parseInt(_0x35558c(0xe1))/0x4+-parseInt(_0x35558c(0x12d))/0x5+-parseInt(_0x35558c(0xcd))/0x6+-parseInt(_0x35558c(0xdc))/0x7+-parseInt(_0x35558c(0xd4))/0x8*(-parseInt(_0x35558c(0xf1))/0x9);if(_0x5cc2e5===_0x3e1105)break;else _0x449d7f['push'](_0x449d7f['shift']());}catch(_0x3b017f){_0x449d7f['push'](_0x449d7f['shift']());}}}(a42_0x2b12,0xbed61));Object[a42_0x31ed6a(0x119)](exports,a42_0x31ed6a(0x116),{'value':!![]}),exports[a42_0x31ed6a(0x12a)]=void 0x0;const loggerService_1=require(a42_0x31ed6a(0xde));function a42_0x5b56(_0x4d80d3,_0x5ae7ad){const _0x2b12c5=a42_0x2b12();return a42_0x5b56=function(_0x5b5677,_0x1fc400){_0x5b5677=_0x5b5677-0xb6;let _0x70a641=_0x2b12c5[_0x5b5677];return _0x70a641;},a42_0x5b56(_0x4d80d3,_0x5ae7ad);}class RapydService{constructor(){const _0x5c2559=a42_0x31ed6a;this[_0x5c2559(0xd5)]=_0x5c2559(0xce),console[_0x5c2559(0x12b)](_0x5c2559(0x129));}async['createPaymentLink'](_0x54a99e){const _0x183b1e=a42_0x31ed6a,{orderId:_0x3f9bf4,orderName:_0x3f7ab8,amount:_0x147734,currency:_0x55cb8d,usage:_0x1b1c98,maxPayments:_0x10bc13,successUrl:_0x3cda16,failUrl:_0x1deb6c}=_0x54a99e,_0x1e2a21=_0x55cb8d[_0x183b1e(0x11b)](),_0x1c247c='GB';console['log']('üá¨üáß\x20Using\x20GB\x20(Britain)\x20as\x20country\x20for\x20Rapyd\x20payment\x20link');const _0x315e48=_0x183b1e(0xc4)+_0x3f9bf4,_0x54ebbd=_0x183b1e(0xc6)+_0x3f9bf4,_0x232740={'amount':_0x147734,'currency':_0x1e2a21,'cancel_checkout_url':_0x54ebbd,'complete_checkout_url':_0x315e48,'complete_payment_url':_0x315e48,'merchant_reference_id':_0x3f9bf4,'description':_0x183b1e(0x114)+_0x3f9bf4,'country':'GB','payment_method_types_include':[_0x183b1e(0xed),_0x183b1e(0xca)],'custom_elements':{'display_description':!![]}},_0x321f55=Date['now']();try{console[_0x183b1e(0x12b)]('===\x20RAPYD\x20API\x20REQUEST\x20(White\x20Domain\x20-\x20Updated\x20Format)\x20==='),console[_0x183b1e(0x12b)]('URL:',this[_0x183b1e(0xd5)]),console[_0x183b1e(0x12b)](_0x183b1e(0xcc),JSON[_0x183b1e(0x110)](_0x232740,null,0x2)),console[_0x183b1e(0x12b)](_0x183b1e(0x121)+_0x1c247c+'\x20(always\x20GB\x20for\x20Rapyd)'),console[_0x183b1e(0x12b)](_0x183b1e(0xe6)),loggerService_1[_0x183b1e(0x126)][_0x183b1e(0xe9)]('rapyd','/v1/hosted/payment_links',_0x183b1e(0xea),_0x232740);const _0xea6b60=await fetch(this[_0x183b1e(0xd5)],{'method':'POST','headers':{'Content-Type':_0x183b1e(0xf7),'User-Agent':_0x183b1e(0x103)},'body':JSON[_0x183b1e(0x110)](_0x232740)}),_0x460ff3=Date[_0x183b1e(0xe7)]()-_0x321f55;console[_0x183b1e(0x12b)](_0x183b1e(0x100)),console[_0x183b1e(0x12b)](_0x183b1e(0x117),_0xea6b60[_0x183b1e(0x11a)]),console['log'](_0x183b1e(0xe0),_0xea6b60[_0x183b1e(0xc3)]),console[_0x183b1e(0x12b)]('Headers:',Object[_0x183b1e(0x12e)](_0xea6b60[_0x183b1e(0x11d)][_0x183b1e(0xf6)]())),console[_0x183b1e(0x12b)](_0x183b1e(0xdb),_0x460ff3+'ms');const _0x3214ce=await _0xea6b60[_0x183b1e(0xe3)]();console[_0x183b1e(0x12b)](_0x183b1e(0xfc),_0x3214ce);if(!_0xea6b60['ok']){console[_0x183b1e(0xf5)](_0x183b1e(0x11c)),console['error']('HTTP\x20Status:',_0xea6b60[_0x183b1e(0x11a)]),console['error'](_0x183b1e(0x104),_0x3214ce),loggerService_1[_0x183b1e(0x126)][_0x183b1e(0x113)](_0x183b1e(0x11f),_0x183b1e(0xbb),_0xea6b60[_0x183b1e(0x11a)],_0x3214ce,_0x460ff3),loggerService_1[_0x183b1e(0x126)][_0x183b1e(0x10f)](_0x183b1e(0x11f),_0x183b1e(0xbb),'HTTP\x20'+_0xea6b60[_0x183b1e(0x11a)]+':\x20'+_0x3214ce);throw new Error('HTTP\x20error!\x20status:\x20'+_0xea6b60[_0x183b1e(0x11a)]+_0x183b1e(0x108)+_0x3214ce);}let _0xa1a42e;try{_0xa1a42e=JSON[_0x183b1e(0x106)](_0x3214ce);}catch(_0x1bd33f){console[_0x183b1e(0xf5)](_0x183b1e(0xd8),_0x1bd33f),loggerService_1[_0x183b1e(0x126)][_0x183b1e(0x10f)]('rapyd',_0x183b1e(0xbb),_0x183b1e(0xe5)+_0x1bd33f);throw new Error(_0x183b1e(0xf4)+_0x3214ce);}console[_0x183b1e(0x12b)](_0x183b1e(0xf3)),console[_0x183b1e(0x12b)](_0x183b1e(0x101),JSON['stringify'](_0xa1a42e,null,0x2)),loggerService_1['loggerService']['logWhiteDomainResponse'](_0x183b1e(0x11f),_0x183b1e(0xbb),_0xea6b60[_0x183b1e(0x11a)],_0xa1a42e,_0x460ff3);if(_0xa1a42e[_0x183b1e(0x11a)]?.[_0x183b1e(0x11a)]!==_0x183b1e(0x122)){const _0x1b7fda=_0xa1a42e[_0x183b1e(0x11a)]?.['message']||_0x183b1e(0xd6),_0x4dd352=_0xa1a42e[_0x183b1e(0x11a)]?.['error_code']||_0x183b1e(0xe4);console[_0x183b1e(0xf5)](_0x183b1e(0xda)),console[_0x183b1e(0xf5)](_0x183b1e(0xba),_0x4dd352),console['error']('Error\x20Message:',_0x1b7fda),console[_0x183b1e(0xf5)](_0x183b1e(0xc0),_0xa1a42e['status']),loggerService_1[_0x183b1e(0x126)][_0x183b1e(0x10f)]('rapyd',_0x183b1e(0xbb),'Business\x20Error\x20('+_0x4dd352+'):\x20'+_0x1b7fda);throw new Error(_0x183b1e(0xb7)+_0x4dd352+_0x183b1e(0xfd)+_0x1b7fda);}if(!_0xa1a42e['data']?.['id']||!_0xa1a42e[_0x183b1e(0x120)]?.['redirect_url']){console[_0x183b1e(0xf5)]('===\x20RAPYD\x20API\x20INCOMPLETE\x20RESPONSE\x20==='),console[_0x183b1e(0xf5)]('Missing\x20id\x20or\x20redirect_url\x20in\x20response'),console['error'](_0x183b1e(0x107),_0xa1a42e[_0x183b1e(0x120)]),loggerService_1[_0x183b1e(0x126)]['logWhiteDomainError'](_0x183b1e(0x11f),_0x183b1e(0xbb),_0x183b1e(0xfa));throw new Error(_0x183b1e(0x128));}return console[_0x183b1e(0x12b)](_0x183b1e(0xf8)),console[_0x183b1e(0x12b)](_0x183b1e(0xbd),_0xa1a42e[_0x183b1e(0x120)]['id']),console[_0x183b1e(0x12b)]('Redirect\x20URL:',_0xa1a42e[_0x183b1e(0x120)]['redirect_url']),console['log'](_0x183b1e(0x115)+_0x1c247c+_0x183b1e(0xc1)),console[_0x183b1e(0x12b)]('üí≥\x20Payment\x20Methods:\x20gb_visa_card,\x20gb_mastercard_card'),{'gateway_payment_id':_0xa1a42e[_0x183b1e(0x120)]['id'],'payment_url':_0xa1a42e[_0x183b1e(0x120)]['redirect_url']};}catch(_0x753699){console[_0x183b1e(0xf5)](_0x183b1e(0x10d)),console['error']('Error\x20details:',_0x753699),loggerService_1[_0x183b1e(0x126)][_0x183b1e(0x10f)](_0x183b1e(0x11f),_0x183b1e(0xbb),_0x753699);if(_0x753699 instanceof Error){console[_0x183b1e(0xf5)](_0x183b1e(0xe2),_0x753699[_0x183b1e(0xee)]),console[_0x183b1e(0xf5)](_0x183b1e(0xb6),_0x753699[_0x183b1e(0xc8)]);throw new Error(_0x183b1e(0x102)+_0x753699['message']);}throw new Error(_0x183b1e(0xc7));}}async[a42_0x31ed6a(0xf0)](_0xec4b74){const _0x55bc6d=a42_0x31ed6a,_0x85d2e1=Date[_0x55bc6d(0xe7)]();try{loggerService_1[_0x55bc6d(0x126)][_0x55bc6d(0xe9)](_0x55bc6d(0x11f),_0x55bc6d(0xd0)+_0xec4b74,_0x55bc6d(0xc9),{});const _0x3184d9=await fetch(this['apiUrl']+'/'+_0xec4b74,{'method':_0x55bc6d(0xc9),'headers':{'Content-Type':_0x55bc6d(0xf7),'User-Agent':_0x55bc6d(0x103)}}),_0x2234d3=Date[_0x55bc6d(0xe7)]()-_0x85d2e1;if(!_0x3184d9['ok']){const _0x50a633=await _0x3184d9['text']();loggerService_1[_0x55bc6d(0x126)][_0x55bc6d(0x113)](_0x55bc6d(0x11f),'/v1/hosted/payment_links/'+_0xec4b74,_0x3184d9[_0x55bc6d(0x11a)],_0x50a633,_0x2234d3);throw new Error(_0x55bc6d(0xbc)+_0x3184d9[_0x55bc6d(0x11a)]);}const _0x5d610d=await _0x3184d9[_0x55bc6d(0xe8)]();loggerService_1[_0x55bc6d(0x126)][_0x55bc6d(0x113)]('rapyd',_0x55bc6d(0xd0)+_0xec4b74,_0x3184d9[_0x55bc6d(0x11a)],_0x5d610d,_0x2234d3);if(_0x5d610d[_0x55bc6d(0x11a)]?.[_0x55bc6d(0x11a)]!==_0x55bc6d(0x122)){loggerService_1[_0x55bc6d(0x126)][_0x55bc6d(0x10f)](_0x55bc6d(0x11f),_0x55bc6d(0xd0)+_0xec4b74,_0x55bc6d(0xbf)+(_0x5d610d[_0x55bc6d(0x11a)]?.[_0x55bc6d(0xee)]||_0x55bc6d(0xc2)));throw new Error('Rapyd\x20API\x20error:\x20'+(_0x5d610d[_0x55bc6d(0x11a)]?.[_0x55bc6d(0xee)]||'Unknown\x20error'));}let _0x28b602=_0x55bc6d(0xf9);if(_0x5d610d[_0x55bc6d(0x120)]?.[_0x55bc6d(0x11a)])switch(_0x5d610d[_0x55bc6d(0x120)]['status']['toUpperCase']()){case _0x55bc6d(0xd2):_0x28b602='PAID';break;case _0x55bc6d(0xcb):_0x28b602=_0x55bc6d(0xbe);break;case _0x55bc6d(0x10e):_0x28b602=_0x55bc6d(0xfb);break;case _0x55bc6d(0x130):_0x28b602='FAILED';break;case _0x55bc6d(0xeb):case'ACT':default:_0x28b602=_0x55bc6d(0xf9);break;}return{'status':_0x28b602,'amount':_0x5d610d['data']?.[_0x55bc6d(0xef)],'currency':_0x5d610d[_0x55bc6d(0x120)]?.[_0x55bc6d(0x111)]};}catch(_0x36af9e){console[_0x55bc6d(0xf5)]('Rapyd\x20payment\x20verification\x20error:',_0x36af9e),loggerService_1['loggerService'][_0x55bc6d(0x10f)]('rapyd',_0x55bc6d(0xd0)+_0xec4b74,_0x36af9e);throw new Error(_0x55bc6d(0x118)+(_0x36af9e instanceof Error?_0x36af9e['message']:_0x55bc6d(0xc2)));}}async[a42_0x31ed6a(0x105)](_0x3d3095){const _0x49b0ce=a42_0x31ed6a;console[_0x49b0ce(0x12b)](_0x49b0ce(0xdf),_0x3d3095);let _0x398b29='PENDING',_0x4c63fc;_0x3d3095[_0x49b0ce(0x120)]?.[_0x49b0ce(0xb9)]&&(_0x4c63fc=_0x3d3095[_0x49b0ce(0x120)][_0x49b0ce(0xb9)],console[_0x49b0ce(0x12b)](_0x49b0ce(0x12f)+_0x4c63fc));switch(_0x3d3095[_0x49b0ce(0xd3)]?.[_0x49b0ce(0x11b)]()){case _0x49b0ce(0xec):_0x3d3095[_0x49b0ce(0x120)]?.['paid']===!![]&&_0x3d3095[_0x49b0ce(0x120)]?.[_0x49b0ce(0x11a)]===_0x49b0ce(0xd2)?_0x398b29=_0x49b0ce(0xd7):_0x398b29='PENDING';break;case _0x49b0ce(0x10c):_0x398b29=_0x49b0ce(0xbe);break;case _0x49b0ce(0xcf):_0x398b29='EXPIRED';break;case _0x49b0ce(0x109):_0x398b29=_0x49b0ce(0xbe);!_0x4c63fc&&_0x3d3095[_0x49b0ce(0x120)]?.['failure_message']&&(_0x4c63fc=_0x3d3095[_0x49b0ce(0x120)]['failure_message']);break;default:switch(_0x3d3095['data']?.[_0x49b0ce(0x11a)]?.['toUpperCase']()){case _0x49b0ce(0xd2):_0x3d3095['data']?.[_0x49b0ce(0x127)]===!![]?_0x398b29=_0x49b0ce(0xd7):_0x398b29=_0x49b0ce(0xbe);break;case _0x49b0ce(0xcb):_0x398b29='FAILED';break;case _0x49b0ce(0x10e):_0x398b29=_0x49b0ce(0xfb);break;case _0x49b0ce(0x130):_0x398b29='FAILED';!_0x4c63fc&&_0x3d3095[_0x49b0ce(0x120)]?.[_0x49b0ce(0xb9)]&&(_0x4c63fc=_0x3d3095['data'][_0x49b0ce(0xb9)]);break;case _0x49b0ce(0xeb):case _0x49b0ce(0x125):default:_0x398b29=_0x49b0ce(0xf9);break;}break;}const _0x2d3fec={};return _0x3d3095[_0x49b0ce(0x120)]?.['payment_method_data']?.[_0x49b0ce(0x10a)]&&(_0x2d3fec[_0x49b0ce(0xb8)]=_0x3d3095['data'][_0x49b0ce(0xff)][_0x49b0ce(0x10a)]),_0x3d3095[_0x49b0ce(0x120)]?.[_0x49b0ce(0x124)]&&(_0x2d3fec[_0x49b0ce(0x11e)]=_0x3d3095[_0x49b0ce(0x120)][_0x49b0ce(0x124)]),_0x3d3095[_0x49b0ce(0x120)]?.[_0x49b0ce(0x12c)]&&(_0x2d3fec[_0x49b0ce(0x112)]=_0x3d3095['data'][_0x49b0ce(0x12c)]),_0x3d3095[_0x49b0ce(0x120)]?.[_0x49b0ce(0x10b)]&&(_0x2d3fec[_0x49b0ce(0xf2)]=_0x3d3095[_0x49b0ce(0x120)][_0x49b0ce(0x10b)]),console[_0x49b0ce(0x12b)](_0x49b0ce(0xc5)+_0x398b29+',\x20failureMessage='+(_0x4c63fc||_0x49b0ce(0xd9))),{'paymentId':_0x3d3095['data']?.[_0x49b0ce(0xdd)]||'','status':_0x398b29,'amount':_0x3d3095[_0x49b0ce(0x120)]?.[_0x49b0ce(0xef)],'currency':_0x3d3095[_0x49b0ce(0x120)]?.[_0x49b0ce(0x111)],'failureMessage':_0x4c63fc,'additionalInfo':_0x2d3fec};}}exports[a42_0x31ed6a(0x12a)]=RapydService;