'use strict';function a48_0x1fa6(){const _0x42d01d=['JSON\x20Parse\x20Error:\x20','PENDING','cardLast4','message','paymentMethod','===\x20RAPYD\x20API\x20BUSINESS\x20ERROR\x20===','statusText','Parsed\x20Result:','25223ztpNaN','Error\x20message:','Response\x20data:','CLO','RapydService','Missing\x20id\x20or\x20redirect_url\x20in\x20response','redirect_url','last4','rapyd','22136idbuPD','614151iqUeBZ','HTTP\x20Status:','EXPIRED','Failed\x20to\x20create\x20Rapyd\x20payment\x20link:\x20Unknown\x20error','===\x20RAPYD\x20SERVICE\x20ERROR\x20===','failure_message','===\x20RAPYD\x20API\x20RESPONSE\x20(White\x20Domain)\x20===','/v1/hosted/payment_links/','gb_mastercard_card','26ZMvdVh','===\x20RAPYD\x20API\x20INCOMPLETE\x20RESPONSE\x20===','logWhiteDomainError','Status\x20Text:','status','toISOString','logWhiteDomainResponse','804YLmord','createPaymentLink','Business\x20Error\x20(','processWebhook','text','EUR','EXP','SUCCESS','floor','105PlVJQo','\x20\x20\x20expiration:\x20','application/json','merchant_reference_id','parse','Response\x20Body:','log','currency','error_code','\x20\x20\x20fixed_side:\x20buy','PAYMENT_COMPLETED','💱\x20Adding\x20currency\x20conversion\x20fields\x20for\x20','2397186YXEazO','🇬🇧\x20Using\x20GB\x20(Britain)\x20as\x20country\x20for\x20Rapyd\x20payment\x20link','PAID','Processing\x20Rapyd\x20webhook:','ORDER:\x20','Failed\x20to\x20parse\x20JSON\x20response:','PAYMENT_CANCELED','https://tesoft.uk/gateway/fail.php?id=','Unknown\x20error','CAN','amount','paid','stack','POST','headers','💳\x20Payment\x20Methods:\x20gb_visa_card,\x20gb_mastercard_card','gb_visa_card','\x20\x20\x20requested_currency:\x20EUR','32ZnzLxX','failure_code','83447YAkdnU','Error\x20stack:','HTTP\x20error!\x20status:\x20','Unknown\x20error\x20from\x20Rapyd\x20API','logWhiteDomainRequest','Raw\x20Response\x20Body:','20JAxiXU','TesSoft\x20Payment\x20System/1.0',',\x20failureMessage=','PAYMENT_EXPIRED','Error\x20details:','fixed_side','now','Status:','toUpperCase','):\x20','PAYMENT_FAILED','payment_method_type','ACT','URL:','data','💥\x20Rapyd\x20failure\x20message:\x20','../loggerService','fromEntries',',\x20body:\x20','NEW','apiUrl','🇬🇧\x20Country:\x20','Failed\x20to\x20create\x20Rapyd\x20payment\x20link:\x20','66zbsvtN','97315UbKkyf','\x20(GB\x20-\x20Britain)','failureCode','/v1/hosted/payment_links','Redirect\x20URL:','GET','FAILED','loggerService','stringify','error','448987ChpYAV','Rapyd\x20API\x20error:\x20','Rapyd\x20API\x20error\x20(','Full\x20Error\x20Data:'];a48_0x1fa6=function(){return _0x42d01d;};return a48_0x1fa6();}const a48_0x105e21=a48_0x3b9e;function a48_0x3b9e(_0x3b699f,_0x448d41){const _0x1fa6e0=a48_0x1fa6();return a48_0x3b9e=function(_0x3b9e93,_0x571bed){_0x3b9e93=_0x3b9e93-0x13b;let _0x4df573=_0x1fa6e0[_0x3b9e93];return _0x4df573;},a48_0x3b9e(_0x3b699f,_0x448d41);}(function(_0x216cbf,_0x2852b7){const _0x58588b=a48_0x3b9e,_0x71c1d1=_0x216cbf();while(!![]){try{const _0x45986d=-parseInt(_0x58588b(0x18c))/0x1*(parseInt(_0x58588b(0x19f))/0x2)+parseInt(_0x58588b(0x1af))/0x3*(-parseInt(_0x58588b(0x195))/0x4)+-parseInt(_0x58588b(0x176))/0x5*(-parseInt(_0x58588b(0x175))/0x6)+-parseInt(_0x58588b(0x180))/0x7+parseInt(_0x58588b(0x156))/0x8*(-parseInt(_0x58588b(0x196))/0x9)+parseInt(_0x58588b(0x15e))/0xa*(parseInt(_0x58588b(0x144))/0xb)+-parseInt(_0x58588b(0x1a6))/0xc*(-parseInt(_0x58588b(0x158))/0xd);if(_0x45986d===_0x2852b7)break;else _0x71c1d1['push'](_0x71c1d1['shift']());}catch(_0x5c6588){_0x71c1d1['push'](_0x71c1d1['shift']());}}}(a48_0x1fa6,0x36094));Object['defineProperty'](exports,'__esModule',{'value':!![]}),exports[a48_0x105e21(0x190)]=void 0x0;const loggerService_1=require(a48_0x105e21(0x16e));class RapydService{constructor(){const _0x1a1039=a48_0x105e21;this[_0x1a1039(0x172)]='https://tesoft.uk/gateway/rapyd/',console[_0x1a1039(0x13e)]('🌐\x20Rapyd\x20service\x20initialized\x20with\x20white\x20domain\x20proxy');}async[a48_0x105e21(0x1a7)](_0x18c8e8){const _0x3afb5a=a48_0x105e21,{orderId:_0x5ce20a,orderName:_0x32863d,amount:_0x343e93,currency:_0x5ec010,usage:_0x4dfa5d,maxPayments:_0x95aa17,successUrl:_0x4aaa9d,failUrl:_0x82793a}=_0x18c8e8,_0x9c1eb6=_0x5ec010[_0x3afb5a(0x166)](),_0x4a8b05='GB';console[_0x3afb5a(0x13e)](_0x3afb5a(0x145));const _0x140893='https://tesoft.uk/gateway/success.php?id='+_0x5ce20a,_0x459fbb=_0x3afb5a(0x14b)+_0x5ce20a,_0x2badea={'amount':_0x343e93,'currency':_0x9c1eb6,'cancel_checkout_url':_0x459fbb,'complete_checkout_url':_0x140893,'complete_payment_url':_0x140893,'merchant_reference_id':_0x5ce20a,'description':_0x3afb5a(0x148)+_0x5ce20a,'country':'GB','payment_method_types_include':[_0x3afb5a(0x154),_0x3afb5a(0x19e)],'custom_elements':{'display_description':!![]}};if(_0x9c1eb6!==_0x3afb5a(0x1ab)){const _0x104bae=Math[_0x3afb5a(0x1ae)](Date[_0x3afb5a(0x164)]()/0x3e8)+0x1e*0x3c;_0x2badea[_0x3afb5a(0x163)]='buy',_0x2badea['requested_currency']=_0x3afb5a(0x1ab),_0x2badea['expiration']=_0x104bae,console['log'](_0x3afb5a(0x143)+_0x9c1eb6+'\x20->\x20EUR:'),console[_0x3afb5a(0x13e)](_0x3afb5a(0x141)),console[_0x3afb5a(0x13e)](_0x3afb5a(0x155)),console[_0x3afb5a(0x13e)](_0x3afb5a(0x1b0)+_0x104bae+'\x20('+new Date(_0x104bae*0x3e8)[_0x3afb5a(0x1a4)]()+')');}const _0x1bf153=Date[_0x3afb5a(0x164)]();try{console['log']('===\x20RAPYD\x20API\x20REQUEST\x20(White\x20Domain\x20-\x20Updated\x20Format)\x20==='),console['log'](_0x3afb5a(0x16b),this[_0x3afb5a(0x172)]),console['log']('Request\x20Body\x20(Updated\x20Format):',JSON[_0x3afb5a(0x17e)](_0x2badea,null,0x2)),console[_0x3afb5a(0x13e)](_0x3afb5a(0x173)+_0x4a8b05+'\x20(always\x20GB\x20for\x20Rapyd)'),console[_0x3afb5a(0x13e)](_0x3afb5a(0x153)),loggerService_1['loggerService'][_0x3afb5a(0x15c)]('rapyd',_0x3afb5a(0x179),_0x3afb5a(0x151),_0x2badea);const _0x5a44fa=await fetch(this[_0x3afb5a(0x172)],{'method':'POST','headers':{'Content-Type':_0x3afb5a(0x1b1),'User-Agent':_0x3afb5a(0x15f)},'body':JSON[_0x3afb5a(0x17e)](_0x2badea)}),_0x1ae947=Date[_0x3afb5a(0x164)]()-_0x1bf153;console[_0x3afb5a(0x13e)](_0x3afb5a(0x19c)),console['log'](_0x3afb5a(0x165),_0x5a44fa[_0x3afb5a(0x1a3)]),console[_0x3afb5a(0x13e)](_0x3afb5a(0x1a2),_0x5a44fa[_0x3afb5a(0x18a)]),console[_0x3afb5a(0x13e)]('Headers:',Object[_0x3afb5a(0x16f)](_0x5a44fa[_0x3afb5a(0x152)]['entries']())),console[_0x3afb5a(0x13e)]('Response\x20Time:',_0x1ae947+'ms');const _0x1dc789=await _0x5a44fa[_0x3afb5a(0x1aa)]();console[_0x3afb5a(0x13e)](_0x3afb5a(0x15d),_0x1dc789);if(!_0x5a44fa['ok']){console[_0x3afb5a(0x17f)]('===\x20RAPYD\x20API\x20ERROR\x20==='),console['error'](_0x3afb5a(0x197),_0x5a44fa[_0x3afb5a(0x1a3)]),console[_0x3afb5a(0x17f)](_0x3afb5a(0x13d),_0x1dc789),loggerService_1[_0x3afb5a(0x17d)]['logWhiteDomainResponse']('rapyd',_0x3afb5a(0x179),_0x5a44fa[_0x3afb5a(0x1a3)],_0x1dc789,_0x1ae947),loggerService_1[_0x3afb5a(0x17d)][_0x3afb5a(0x1a1)]('rapyd','/v1/hosted/payment_links','HTTP\x20'+_0x5a44fa[_0x3afb5a(0x1a3)]+':\x20'+_0x1dc789);throw new Error(_0x3afb5a(0x15a)+_0x5a44fa[_0x3afb5a(0x1a3)]+_0x3afb5a(0x170)+_0x1dc789);}let _0x462b93;try{_0x462b93=JSON[_0x3afb5a(0x13c)](_0x1dc789);}catch(_0x4dcc63){console[_0x3afb5a(0x17f)](_0x3afb5a(0x149),_0x4dcc63),loggerService_1['loggerService'][_0x3afb5a(0x1a1)](_0x3afb5a(0x194),_0x3afb5a(0x179),_0x3afb5a(0x184)+_0x4dcc63);throw new Error('Invalid\x20JSON\x20response\x20from\x20Rapyd\x20API:\x20'+_0x1dc789);}console['log']('===\x20PARSED\x20RAPYD\x20RESPONSE\x20==='),console[_0x3afb5a(0x13e)](_0x3afb5a(0x18b),JSON[_0x3afb5a(0x17e)](_0x462b93,null,0x2)),loggerService_1[_0x3afb5a(0x17d)][_0x3afb5a(0x1a5)](_0x3afb5a(0x194),'/v1/hosted/payment_links',_0x5a44fa['status'],_0x462b93,_0x1ae947);if(_0x462b93[_0x3afb5a(0x1a3)]?.[_0x3afb5a(0x1a3)]!==_0x3afb5a(0x1ad)){const _0x376bc3=_0x462b93[_0x3afb5a(0x1a3)]?.[_0x3afb5a(0x187)]||_0x3afb5a(0x15b),_0x54edf6=_0x462b93[_0x3afb5a(0x1a3)]?.[_0x3afb5a(0x140)]||'UNKNOWN';console['error'](_0x3afb5a(0x189)),console['error']('Error\x20Code:',_0x54edf6),console[_0x3afb5a(0x17f)]('Error\x20Message:',_0x376bc3),console[_0x3afb5a(0x17f)](_0x3afb5a(0x183),_0x462b93[_0x3afb5a(0x1a3)]),loggerService_1[_0x3afb5a(0x17d)][_0x3afb5a(0x1a1)]('rapyd','/v1/hosted/payment_links',_0x3afb5a(0x1a8)+_0x54edf6+_0x3afb5a(0x167)+_0x376bc3);throw new Error(_0x3afb5a(0x182)+_0x54edf6+'):\x20'+_0x376bc3);}if(!_0x462b93[_0x3afb5a(0x16c)]?.['id']||!_0x462b93[_0x3afb5a(0x16c)]?.[_0x3afb5a(0x192)]){console['error'](_0x3afb5a(0x1a0)),console[_0x3afb5a(0x17f)](_0x3afb5a(0x191)),console[_0x3afb5a(0x17f)](_0x3afb5a(0x18e),_0x462b93[_0x3afb5a(0x16c)]),loggerService_1[_0x3afb5a(0x17d)][_0x3afb5a(0x1a1)](_0x3afb5a(0x194),_0x3afb5a(0x179),'Incomplete\x20response:\x20missing\x20id\x20or\x20redirect_url');throw new Error('Invalid\x20response\x20from\x20Rapyd\x20API:\x20missing\x20id\x20or\x20redirect_url');}return console[_0x3afb5a(0x13e)]('===\x20RAPYD\x20SUCCESS\x20==='),console[_0x3afb5a(0x13e)]('Payment\x20Link\x20ID:',_0x462b93[_0x3afb5a(0x16c)]['id']),console[_0x3afb5a(0x13e)](_0x3afb5a(0x17a),_0x462b93[_0x3afb5a(0x16c)][_0x3afb5a(0x192)]),console['log']('🇬🇧\x20Country\x20used:\x20'+_0x4a8b05+_0x3afb5a(0x177)),console[_0x3afb5a(0x13e)](_0x3afb5a(0x153)),{'gateway_payment_id':_0x462b93[_0x3afb5a(0x16c)]['id'],'payment_url':_0x462b93['data'][_0x3afb5a(0x192)]};}catch(_0x205c05){console[_0x3afb5a(0x17f)](_0x3afb5a(0x19a)),console[_0x3afb5a(0x17f)](_0x3afb5a(0x162),_0x205c05),loggerService_1[_0x3afb5a(0x17d)][_0x3afb5a(0x1a1)](_0x3afb5a(0x194),_0x3afb5a(0x179),_0x205c05);if(_0x205c05 instanceof Error){console[_0x3afb5a(0x17f)](_0x3afb5a(0x18d),_0x205c05[_0x3afb5a(0x187)]),console[_0x3afb5a(0x17f)](_0x3afb5a(0x159),_0x205c05[_0x3afb5a(0x150)]);throw new Error(_0x3afb5a(0x174)+_0x205c05[_0x3afb5a(0x187)]);}throw new Error(_0x3afb5a(0x199));}}async['verifyPayment'](_0x535140){const _0x32aca0=a48_0x105e21,_0x3f875c=Date[_0x32aca0(0x164)]();try{loggerService_1[_0x32aca0(0x17d)]['logWhiteDomainRequest'](_0x32aca0(0x194),_0x32aca0(0x19d)+_0x535140,_0x32aca0(0x17b),{});const _0x3fe2c5=await fetch(this[_0x32aca0(0x172)]+'/'+_0x535140,{'method':_0x32aca0(0x17b),'headers':{'Content-Type':_0x32aca0(0x1b1),'User-Agent':_0x32aca0(0x15f)}}),_0x5cecb2=Date[_0x32aca0(0x164)]()-_0x3f875c;if(!_0x3fe2c5['ok']){const _0x228538=await _0x3fe2c5[_0x32aca0(0x1aa)]();loggerService_1[_0x32aca0(0x17d)]['logWhiteDomainResponse'](_0x32aca0(0x194),_0x32aca0(0x19d)+_0x535140,_0x3fe2c5[_0x32aca0(0x1a3)],_0x228538,_0x5cecb2);throw new Error(_0x32aca0(0x15a)+_0x3fe2c5['status']);}const _0x5e826f=await _0x3fe2c5['json']();loggerService_1[_0x32aca0(0x17d)][_0x32aca0(0x1a5)](_0x32aca0(0x194),'/v1/hosted/payment_links/'+_0x535140,_0x3fe2c5[_0x32aca0(0x1a3)],_0x5e826f,_0x5cecb2);if(_0x5e826f[_0x32aca0(0x1a3)]?.[_0x32aca0(0x1a3)]!=='SUCCESS'){loggerService_1['loggerService'][_0x32aca0(0x1a1)](_0x32aca0(0x194),_0x32aca0(0x19d)+_0x535140,_0x32aca0(0x181)+(_0x5e826f[_0x32aca0(0x1a3)]?.[_0x32aca0(0x187)]||'Unknown\x20error'));throw new Error(_0x32aca0(0x181)+(_0x5e826f[_0x32aca0(0x1a3)]?.['message']||_0x32aca0(0x14c)));}let _0x1adec2=_0x32aca0(0x185);if(_0x5e826f[_0x32aca0(0x16c)]?.[_0x32aca0(0x1a3)])switch(_0x5e826f[_0x32aca0(0x16c)][_0x32aca0(0x1a3)][_0x32aca0(0x166)]()){case _0x32aca0(0x18f):_0x1adec2=_0x32aca0(0x146);break;case _0x32aca0(0x14d):_0x1adec2=_0x32aca0(0x17c);break;case _0x32aca0(0x1ac):_0x1adec2='EXPIRED';break;case'ERR':_0x1adec2=_0x32aca0(0x17c);break;case _0x32aca0(0x171):case _0x32aca0(0x16a):default:_0x1adec2=_0x32aca0(0x185);break;}return{'status':_0x1adec2,'amount':_0x5e826f[_0x32aca0(0x16c)]?.[_0x32aca0(0x14e)],'currency':_0x5e826f[_0x32aca0(0x16c)]?.[_0x32aca0(0x13f)]};}catch(_0x51d527){console[_0x32aca0(0x17f)]('Rapyd\x20payment\x20verification\x20error:',_0x51d527),loggerService_1['loggerService'][_0x32aca0(0x1a1)](_0x32aca0(0x194),_0x32aca0(0x19d)+_0x535140,_0x51d527);throw new Error('Failed\x20to\x20verify\x20Rapyd\x20payment:\x20'+(_0x51d527 instanceof Error?_0x51d527['message']:'Unknown\x20error'));}}async[a48_0x105e21(0x1a9)](_0x53cae0){const _0x47cdb4=a48_0x105e21;console[_0x47cdb4(0x13e)](_0x47cdb4(0x147),_0x53cae0);let _0x433f80=_0x47cdb4(0x185),_0xef372;_0x53cae0['data']?.[_0x47cdb4(0x19b)]&&(_0xef372=_0x53cae0[_0x47cdb4(0x16c)][_0x47cdb4(0x19b)],console['log'](_0x47cdb4(0x16d)+_0xef372));switch(_0x53cae0['type']?.[_0x47cdb4(0x166)]()){case _0x47cdb4(0x142):_0x53cae0[_0x47cdb4(0x16c)]?.['paid']===!![]&&_0x53cae0[_0x47cdb4(0x16c)]?.['status']===_0x47cdb4(0x18f)?_0x433f80=_0x47cdb4(0x146):_0x433f80=_0x47cdb4(0x185);break;case _0x47cdb4(0x14a):_0x433f80=_0x47cdb4(0x17c);break;case _0x47cdb4(0x161):_0x433f80=_0x47cdb4(0x198);break;case _0x47cdb4(0x168):_0x433f80=_0x47cdb4(0x17c);!_0xef372&&_0x53cae0[_0x47cdb4(0x16c)]?.[_0x47cdb4(0x19b)]&&(_0xef372=_0x53cae0['data'][_0x47cdb4(0x19b)]);break;default:switch(_0x53cae0[_0x47cdb4(0x16c)]?.[_0x47cdb4(0x1a3)]?.[_0x47cdb4(0x166)]()){case'CLO':_0x53cae0[_0x47cdb4(0x16c)]?.[_0x47cdb4(0x14f)]===!![]?_0x433f80=_0x47cdb4(0x146):_0x433f80='FAILED';break;case _0x47cdb4(0x14d):_0x433f80=_0x47cdb4(0x17c);break;case _0x47cdb4(0x1ac):_0x433f80=_0x47cdb4(0x198);break;case'ERR':_0x433f80='FAILED';!_0xef372&&_0x53cae0[_0x47cdb4(0x16c)]?.[_0x47cdb4(0x19b)]&&(_0xef372=_0x53cae0[_0x47cdb4(0x16c)]['failure_message']);break;case'NEW':case _0x47cdb4(0x16a):default:_0x433f80='PENDING';break;}break;}const _0x8d63dc={};return _0x53cae0[_0x47cdb4(0x16c)]?.['payment_method_data']?.[_0x47cdb4(0x193)]&&(_0x8d63dc[_0x47cdb4(0x186)]=_0x53cae0['data']['payment_method_data'][_0x47cdb4(0x193)]),_0x53cae0[_0x47cdb4(0x16c)]?.[_0x47cdb4(0x169)]&&(_0x8d63dc[_0x47cdb4(0x188)]=_0x53cae0['data']['payment_method_type']),_0x53cae0[_0x47cdb4(0x16c)]?.[_0x47cdb4(0x140)]&&(_0x8d63dc['errorCode']=_0x53cae0[_0x47cdb4(0x16c)]['error_code']),_0x53cae0[_0x47cdb4(0x16c)]?.[_0x47cdb4(0x157)]&&(_0x8d63dc[_0x47cdb4(0x178)]=_0x53cae0[_0x47cdb4(0x16c)][_0x47cdb4(0x157)]),console['log']('🔄\x20Rapyd\x20webhook\x20processed:\x20status='+_0x433f80+_0x47cdb4(0x160)+(_0xef372||'none')),{'paymentId':_0x53cae0[_0x47cdb4(0x16c)]?.[_0x47cdb4(0x13b)]||'','status':_0x433f80,'amount':_0x53cae0['data']?.[_0x47cdb4(0x14e)],'currency':_0x53cae0[_0x47cdb4(0x16c)]?.[_0x47cdb4(0x13f)],'failureMessage':_0xef372,'additionalInfo':_0x8d63dc};}}exports['RapydService']=RapydService;