'use strict';const a56_0x3931a1=a56_0x4a32;(function(_0x1b473e,_0x374fd5){const _0x5ae436=a56_0x4a32,_0x1f4824=_0x1b473e();while(!![]){try{const _0x167393=-parseInt(_0x5ae436(0x1c8))/0x1*(parseInt(_0x5ae436(0x1fd))/0x2)+parseInt(_0x5ae436(0x1dc))/0x3*(parseInt(_0x5ae436(0x22b))/0x4)+-parseInt(_0x5ae436(0x1c2))/0x5*(parseInt(_0x5ae436(0x220))/0x6)+-parseInt(_0x5ae436(0x1fa))/0x7*(-parseInt(_0x5ae436(0x21b))/0x8)+-parseInt(_0x5ae436(0x207))/0x9*(-parseInt(_0x5ae436(0x20c))/0xa)+parseInt(_0x5ae436(0x1e9))/0xb*(parseInt(_0x5ae436(0x1cf))/0xc)+parseInt(_0x5ae436(0x22f))/0xd*(parseInt(_0x5ae436(0x1bc))/0xe);if(_0x167393===_0x374fd5)break;else _0x1f4824['push'](_0x1f4824['shift']());}catch(_0x580363){_0x1f4824['push'](_0x1f4824['shift']());}}}(a56_0x505a,0x9e884));Object[a56_0x3931a1(0x1e4)](exports,'__esModule',{'value':!![]}),exports[a56_0x3931a1(0x1cc)]=void 0x0;const loggerService_1=require(a56_0x3931a1(0x219));class RapydService{constructor(){const _0x54fb64=a56_0x3931a1;this[_0x54fb64(0x21a)]=_0x54fb64(0x1cd),console[_0x54fb64(0x22d)](_0x54fb64(0x229));}async[a56_0x3931a1(0x1f2)](_0x21d591){const _0x1f9300=a56_0x3931a1,{orderId:_0x4ab25d,orderName:_0x4df683,amount:_0x439807,currency:_0x32461d,usage:_0x4f0495,maxPayments:_0x9385c5,successUrl:_0x136c27,failUrl:_0x1da631}=_0x21d591,_0x26fe8b=_0x32461d[_0x1f9300(0x236)](),_0x3feb05='GB';console['log'](_0x1f9300(0x1c0));const _0x5d9819=_0x1f9300(0x1e5)+_0x4ab25d,_0xac67be=_0x1f9300(0x1f9)+_0x4ab25d,_0x3a3988={'amount':_0x439807,'currency':_0x26fe8b,'cancel_checkout_url':_0xac67be,'complete_checkout_url':_0x5d9819,'complete_payment_url':_0x5d9819,'merchant_reference_id':_0x4ab25d,'description':_0x1f9300(0x212)+_0x4ab25d,'country':'GB','payment_method_types_include':['gb_visa_card','gb_mastercard_card'],'custom_elements':{'display_description':!![]}};if(_0x26fe8b!==_0x1f9300(0x204)){const _0x2dccdb=Math[_0x1f9300(0x1d7)](Date['now']()/0x3e8)+0x1e*0x3c;_0x3a3988[_0x1f9300(0x202)]=_0x1f9300(0x228),_0x3a3988[_0x1f9300(0x1c3)]='EUR',_0x3a3988[_0x1f9300(0x1ff)]=_0x2dccdb,console[_0x1f9300(0x22d)]('💱\x20Adding\x20currency\x20conversion\x20fields\x20for\x20'+_0x26fe8b+_0x1f9300(0x209)),console[_0x1f9300(0x22d)](_0x1f9300(0x1de)),console[_0x1f9300(0x22d)](_0x1f9300(0x203)),console[_0x1f9300(0x22d)](_0x1f9300(0x1f3)+_0x2dccdb+'\x20('+new Date(_0x2dccdb*0x3e8)[_0x1f9300(0x1b3)]()+')');}const _0xd8e61c=Date[_0x1f9300(0x232)]();try{console[_0x1f9300(0x22d)](_0x1f9300(0x1fc)),console[_0x1f9300(0x22d)](_0x1f9300(0x205),this[_0x1f9300(0x21a)]),console[_0x1f9300(0x22d)](_0x1f9300(0x20f),JSON['stringify'](_0x3a3988,null,0x2)),console[_0x1f9300(0x22d)]('🇬🇧\x20Country:\x20'+_0x3feb05+'\x20(always\x20GB\x20for\x20Rapyd)'),console[_0x1f9300(0x22d)](_0x1f9300(0x1ba)),loggerService_1[_0x1f9300(0x1fe)]['logWhiteDomainRequest'](_0x1f9300(0x1ea),'/v1/hosted/payment_links',_0x1f9300(0x1b4),_0x3a3988);const _0xbc7b12=await fetch(this[_0x1f9300(0x21a)],{'method':_0x1f9300(0x1b4),'headers':{'Content-Type':_0x1f9300(0x1eb),'User-Agent':'Payment\x20System/1.0'},'body':JSON[_0x1f9300(0x231)](_0x3a3988)}),_0x36e002=Date[_0x1f9300(0x232)]()-_0xd8e61c;console[_0x1f9300(0x22d)](_0x1f9300(0x208)),console[_0x1f9300(0x22d)]('Status:',_0xbc7b12[_0x1f9300(0x1f1)]),console[_0x1f9300(0x22d)](_0x1f9300(0x1bf),_0xbc7b12[_0x1f9300(0x227)]),console['log'](_0x1f9300(0x200),Object[_0x1f9300(0x1d9)](_0xbc7b12[_0x1f9300(0x214)]['entries']())),console['log'](_0x1f9300(0x1c5),_0x36e002+'ms');const _0x237fb2=await _0xbc7b12[_0x1f9300(0x224)]();console[_0x1f9300(0x22d)](_0x1f9300(0x20a),_0x237fb2);if(!_0xbc7b12['ok']){console['error']('===\x20RAPYD\x20API\x20ERROR\x20==='),console['error'](_0x1f9300(0x216),_0xbc7b12[_0x1f9300(0x1f1)]),console[_0x1f9300(0x234)]('Response\x20Body:',_0x237fb2),loggerService_1[_0x1f9300(0x1fe)][_0x1f9300(0x1da)](_0x1f9300(0x1ea),_0x1f9300(0x1b9),_0xbc7b12[_0x1f9300(0x1f1)],_0x237fb2,_0x36e002),loggerService_1[_0x1f9300(0x1fe)][_0x1f9300(0x222)](_0x1f9300(0x1ea),'/v1/hosted/payment_links',_0x1f9300(0x1db)+_0xbc7b12['status']+':\x20'+_0x237fb2);throw new Error(_0x1f9300(0x238)+_0xbc7b12[_0x1f9300(0x1f1)]+_0x1f9300(0x1e7)+_0x237fb2);}let _0xaba26;try{_0xaba26=JSON['parse'](_0x237fb2);}catch(_0x102715){console[_0x1f9300(0x234)](_0x1f9300(0x239),_0x102715),loggerService_1[_0x1f9300(0x1fe)][_0x1f9300(0x222)](_0x1f9300(0x1ea),_0x1f9300(0x1b9),_0x1f9300(0x210)+_0x102715);throw new Error(_0x1f9300(0x1e8)+_0x237fb2);}console[_0x1f9300(0x22d)]('===\x20PARSED\x20RAPYD\x20RESPONSE\x20==='),console[_0x1f9300(0x22d)](_0x1f9300(0x1ca),JSON['stringify'](_0xaba26,null,0x2)),loggerService_1[_0x1f9300(0x1fe)][_0x1f9300(0x1da)](_0x1f9300(0x1ea),_0x1f9300(0x1b9),_0xbc7b12[_0x1f9300(0x1f1)],_0xaba26,_0x36e002);if(_0xaba26[_0x1f9300(0x1f1)]?.[_0x1f9300(0x1f1)]!=='SUCCESS'){const _0x3e0eb8=_0xaba26['status']?.[_0x1f9300(0x217)]||_0x1f9300(0x1e6),_0x39cf2a=_0xaba26['status']?.['error_code']||_0x1f9300(0x1f0);console[_0x1f9300(0x234)]('===\x20RAPYD\x20API\x20BUSINESS\x20ERROR\x20==='),console[_0x1f9300(0x234)](_0x1f9300(0x1b2),_0x39cf2a),console[_0x1f9300(0x234)](_0x1f9300(0x23a),_0x3e0eb8),console['error'](_0x1f9300(0x1d3),_0xaba26[_0x1f9300(0x1f1)]),loggerService_1[_0x1f9300(0x1fe)][_0x1f9300(0x222)]('rapyd',_0x1f9300(0x1b9),_0x1f9300(0x237)+_0x39cf2a+_0x1f9300(0x1d2)+_0x3e0eb8);throw new Error(_0x1f9300(0x1bb)+_0x39cf2a+_0x1f9300(0x1d2)+_0x3e0eb8);}if(!_0xaba26[_0x1f9300(0x21c)]?.['id']||!_0xaba26[_0x1f9300(0x21c)]?.[_0x1f9300(0x1ec)]){console[_0x1f9300(0x234)](_0x1f9300(0x21e)),console['error'](_0x1f9300(0x1c7)),console[_0x1f9300(0x234)](_0x1f9300(0x1d5),_0xaba26[_0x1f9300(0x21c)]),loggerService_1[_0x1f9300(0x1fe)][_0x1f9300(0x222)](_0x1f9300(0x1ea),_0x1f9300(0x1b9),_0x1f9300(0x1d8));throw new Error(_0x1f9300(0x1d1));}return console[_0x1f9300(0x22d)](_0x1f9300(0x21f)),console[_0x1f9300(0x22d)](_0x1f9300(0x20d),_0xaba26[_0x1f9300(0x21c)]['id']),console[_0x1f9300(0x22d)](_0x1f9300(0x213),_0xaba26[_0x1f9300(0x21c)][_0x1f9300(0x1ec)]),console[_0x1f9300(0x22d)](_0x1f9300(0x235)+_0x3feb05+_0x1f9300(0x1c1)),console[_0x1f9300(0x22d)](_0x1f9300(0x1ba)),{'gateway_payment_id':_0xaba26[_0x1f9300(0x21c)]['id'],'payment_url':_0xaba26[_0x1f9300(0x21c)][_0x1f9300(0x1ec)]};}catch(_0x4b97ea){console[_0x1f9300(0x234)]('===\x20RAPYD\x20SERVICE\x20ERROR\x20==='),console[_0x1f9300(0x234)]('Error\x20details:',_0x4b97ea),loggerService_1['loggerService'][_0x1f9300(0x222)](_0x1f9300(0x1ea),_0x1f9300(0x1b9),_0x4b97ea);if(_0x4b97ea instanceof Error){console['error'](_0x1f9300(0x230),_0x4b97ea['message']),console[_0x1f9300(0x234)](_0x1f9300(0x1bd),_0x4b97ea[_0x1f9300(0x1b7)]);throw new Error(_0x1f9300(0x1ed)+_0x4b97ea['message']);}throw new Error('Failed\x20to\x20create\x20Rapyd\x20payment\x20link:\x20Unknown\x20error');}}async['verifyPayment'](_0x88cefe){const _0x4a991f=a56_0x3931a1,_0x4c5a05=Date[_0x4a991f(0x232)]();try{loggerService_1['loggerService'][_0x4a991f(0x215)](_0x4a991f(0x1ea),'/v1/hosted/payment_links/'+_0x88cefe,_0x4a991f(0x22c),{});const _0x281ab9=await fetch(this[_0x4a991f(0x21a)]+'/'+_0x88cefe,{'method':_0x4a991f(0x22c),'headers':{'Content-Type':'application/json','User-Agent':_0x4a991f(0x1cb)}}),_0x554fa7=Date[_0x4a991f(0x232)]()-_0x4c5a05;if(!_0x281ab9['ok']){const _0x22dec4=await _0x281ab9[_0x4a991f(0x224)]();loggerService_1[_0x4a991f(0x1fe)]['logWhiteDomainResponse'](_0x4a991f(0x1ea),'/v1/hosted/payment_links/'+_0x88cefe,_0x281ab9[_0x4a991f(0x1f1)],_0x22dec4,_0x554fa7);throw new Error(_0x4a991f(0x238)+_0x281ab9[_0x4a991f(0x1f1)]);}const _0x46d0ab=await _0x281ab9[_0x4a991f(0x1b5)]();loggerService_1[_0x4a991f(0x1fe)][_0x4a991f(0x1da)](_0x4a991f(0x1ea),_0x4a991f(0x225)+_0x88cefe,_0x281ab9['status'],_0x46d0ab,_0x554fa7);if(_0x46d0ab[_0x4a991f(0x1f1)]?.[_0x4a991f(0x1f1)]!==_0x4a991f(0x1c9)){loggerService_1['loggerService'][_0x4a991f(0x222)](_0x4a991f(0x1ea),_0x4a991f(0x225)+_0x88cefe,'Rapyd\x20API\x20error:\x20'+(_0x46d0ab[_0x4a991f(0x1f1)]?.[_0x4a991f(0x217)]||_0x4a991f(0x22a)));throw new Error(_0x4a991f(0x1d4)+(_0x46d0ab['status']?.[_0x4a991f(0x217)]||'Unknown\x20error'));}let _0x17569c='PENDING';if(_0x46d0ab[_0x4a991f(0x21c)]?.['status'])switch(_0x46d0ab[_0x4a991f(0x21c)][_0x4a991f(0x1f1)]['toUpperCase']()){case _0x4a991f(0x233):_0x17569c=_0x4a991f(0x1be);break;case _0x4a991f(0x1dd):_0x17569c=_0x4a991f(0x201);break;case _0x4a991f(0x1e0):_0x17569c=_0x4a991f(0x1d0);break;case _0x4a991f(0x206):_0x17569c=_0x4a991f(0x201);break;case _0x4a991f(0x1b1):case _0x4a991f(0x211):default:_0x17569c=_0x4a991f(0x1e1);break;}return{'status':_0x17569c,'amount':_0x46d0ab[_0x4a991f(0x21c)]?.['amount'],'currency':_0x46d0ab[_0x4a991f(0x21c)]?.[_0x4a991f(0x1f8)]};}catch(_0x4214f9){console[_0x4a991f(0x234)](_0x4a991f(0x1e2),_0x4214f9),loggerService_1[_0x4a991f(0x1fe)][_0x4a991f(0x222)]('rapyd','/v1/hosted/payment_links/'+_0x88cefe,_0x4214f9);throw new Error(_0x4a991f(0x1f7)+(_0x4214f9 instanceof Error?_0x4214f9[_0x4a991f(0x217)]:_0x4a991f(0x22a)));}}async[a56_0x3931a1(0x1b8)](_0xa7c4df){const _0x583649=a56_0x3931a1;console[_0x583649(0x22d)]('Processing\x20Rapyd\x20webhook:',_0xa7c4df);let _0x17527e=_0x583649(0x1e1),_0x3bd405;_0xa7c4df[_0x583649(0x21c)]?.['failure_message']&&(_0x3bd405=_0xa7c4df[_0x583649(0x21c)][_0x583649(0x20e)],console['log'](_0x583649(0x1b6)+_0x3bd405));switch(_0xa7c4df[_0x583649(0x22e)]?.[_0x583649(0x236)]()){case _0x583649(0x1e3):_0xa7c4df[_0x583649(0x21c)]?.[_0x583649(0x20b)]===!![]&&_0xa7c4df[_0x583649(0x21c)]?.[_0x583649(0x1f1)]===_0x583649(0x233)?_0x17527e=_0x583649(0x1be):_0x17527e=_0x583649(0x1e1);break;case _0x583649(0x1fb):_0x17527e=_0x583649(0x201);break;case _0x583649(0x223):_0x17527e='EXPIRED';break;case _0x583649(0x1df):_0x17527e=_0x583649(0x201);!_0x3bd405&&_0xa7c4df['data']?.['failure_message']&&(_0x3bd405=_0xa7c4df['data'][_0x583649(0x20e)]);break;default:switch(_0xa7c4df[_0x583649(0x21c)]?.[_0x583649(0x1f1)]?.[_0x583649(0x236)]()){case _0x583649(0x233):_0xa7c4df[_0x583649(0x21c)]?.[_0x583649(0x20b)]===!![]?_0x17527e=_0x583649(0x1be):_0x17527e='FAILED';break;case _0x583649(0x1dd):_0x17527e=_0x583649(0x201);break;case'EXP':_0x17527e='EXPIRED';break;case _0x583649(0x206):_0x17527e=_0x583649(0x201);!_0x3bd405&&_0xa7c4df['data']?.['failure_message']&&(_0x3bd405=_0xa7c4df['data'][_0x583649(0x20e)]);break;case _0x583649(0x1b1):case _0x583649(0x211):default:_0x17527e=_0x583649(0x1e1);break;}break;}const _0x5484b2={};return _0xa7c4df[_0x583649(0x21c)]?.[_0x583649(0x226)]?.[_0x583649(0x1ee)]&&(_0x5484b2[_0x583649(0x1b0)]=_0xa7c4df[_0x583649(0x21c)][_0x583649(0x226)]['last4']),_0xa7c4df[_0x583649(0x21c)]?.[_0x583649(0x1c6)]&&(_0x5484b2[_0x583649(0x1ce)]=_0xa7c4df[_0x583649(0x21c)]['payment_method_type']),_0xa7c4df['data']?.[_0x583649(0x21d)]&&(_0x5484b2[_0x583649(0x1f5)]=_0xa7c4df[_0x583649(0x21c)][_0x583649(0x21d)]),_0xa7c4df[_0x583649(0x21c)]?.[_0x583649(0x218)]&&(_0x5484b2[_0x583649(0x1ef)]=_0xa7c4df[_0x583649(0x21c)][_0x583649(0x218)]),console['log'](_0x583649(0x1d6)+_0x17527e+_0x583649(0x1f4)+(_0x3bd405||_0x583649(0x1f6))),{'paymentId':_0xa7c4df[_0x583649(0x21c)]?.[_0x583649(0x1c4)]||'','status':_0x17527e,'amount':_0xa7c4df['data']?.[_0x583649(0x221)],'currency':_0xa7c4df[_0x583649(0x21c)]?.[_0x583649(0x1f8)],'failureMessage':_0x3bd405,'additionalInfo':_0x5484b2};}}function a56_0x4a32(_0x49cff4,_0x247de6){const _0x505abc=a56_0x505a();return a56_0x4a32=function(_0x4a3285,_0x142464){_0x4a3285=_0x4a3285-0x1b0;let _0x232ed5=_0x505abc[_0x4a3285];return _0x232ed5;},a56_0x4a32(_0x49cff4,_0x247de6);}exports[a56_0x3931a1(0x1cc)]=RapydService;function a56_0x505a(){const _0x311e3e=['fixed_side','\x20\x20\x20requested_currency:\x20EUR','EUR','URL:','ERR','176742JmVJOW','===\x20RAPYD\x20API\x20RESPONSE\x20(White\x20Domain)\x20===','\x20->\x20EUR:','Raw\x20Response\x20Body:','paid','10AoPfIH','Payment\x20Link\x20ID:','failure_message','Request\x20Body\x20(Updated\x20Format):','JSON\x20Parse\x20Error:\x20','ACT','ORDER:\x20','Redirect\x20URL:','headers','logWhiteDomainRequest','HTTP\x20Status:','message','failure_code','../loggerService','apiUrl','24VYauFW','data','error_code','===\x20RAPYD\x20API\x20INCOMPLETE\x20RESPONSE\x20===','===\x20RAPYD\x20SUCCESS\x20===','342vEEsAp','amount','logWhiteDomainError','PAYMENT_EXPIRED','text','/v1/hosted/payment_links/','payment_method_data','statusText','buy','🌐\x20Rapyd\x20service\x20initialized\x20with\x20white\x20domain\x20proxy','Unknown\x20error','3764iyrEVa','GET','log','type','776672TqzPIN','Error\x20message:','stringify','now','CLO','error','🇬🇧\x20Country\x20used:\x20','toUpperCase','Business\x20Error\x20(','HTTP\x20error!\x20status:\x20','Failed\x20to\x20parse\x20JSON\x20response:','Error\x20Message:','cardLast4','NEW','Error\x20Code:','toISOString','POST','json','💥\x20Rapyd\x20failure\x20message:\x20','stack','processWebhook','/v1/hosted/payment_links','💳\x20Payment\x20Methods:\x20gb_visa_card,\x20gb_mastercard_card','Rapyd\x20API\x20error\x20(','28nIjTsX','Error\x20stack:','PAID','Status\x20Text:','🇬🇧\x20Using\x20GB\x20(Britain)\x20as\x20country\x20for\x20Rapyd\x20payment\x20link','\x20(GB\x20-\x20Britain)','1945WvSTEB','requested_currency','merchant_reference_id','Response\x20Time:','payment_method_type','Missing\x20id\x20or\x20redirect_url\x20in\x20response','36724LvAXGm','SUCCESS','Parsed\x20Result:','Payment\x20System/1.0','RapydService','https://tesoft.uk/gateway/rapyd/','paymentMethod','10596WKniWB','EXPIRED','Invalid\x20response\x20from\x20Rapyd\x20API:\x20missing\x20id\x20or\x20redirect_url','):\x20','Full\x20Error\x20Data:','Rapyd\x20API\x20error:\x20','Response\x20data:','🔄\x20Rapyd\x20webhook\x20processed:\x20status=','floor','Incomplete\x20response:\x20missing\x20id\x20or\x20redirect_url','fromEntries','logWhiteDomainResponse','HTTP\x20','3126EgPfjR','CAN','\x20\x20\x20fixed_side:\x20buy','PAYMENT_FAILED','EXP','PENDING','Rapyd\x20payment\x20verification\x20error:','PAYMENT_COMPLETED','defineProperty','https://tesoft.uk/gateway/success.php?id=','Unknown\x20error\x20from\x20Rapyd\x20API',',\x20body:\x20','Invalid\x20JSON\x20response\x20from\x20Rapyd\x20API:\x20','2552CMZUkR','rapyd','application/json','redirect_url','Failed\x20to\x20create\x20Rapyd\x20payment\x20link:\x20','last4','failureCode','UNKNOWN','status','createPaymentLink','\x20\x20\x20expiration:\x20',',\x20failureMessage=','errorCode','none','Failed\x20to\x20verify\x20Rapyd\x20payment:\x20','currency','https://tesoft.uk/gateway/fail.php?id=','18781ofyPWy','PAYMENT_CANCELED','===\x20RAPYD\x20API\x20REQUEST\x20(White\x20Domain\x20-\x20Updated\x20Format)\x20===','36nigWFw','loggerService','expiration','Headers:','FAILED'];a56_0x505a=function(){return _0x311e3e;};return a56_0x505a();}