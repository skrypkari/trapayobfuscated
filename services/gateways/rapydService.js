'use strict';const a48_0x523900=a48_0x1cc3;function a48_0x1cc3(_0x41e223,_0x5c94ec){const _0x5726bb=a48_0x5726();return a48_0x1cc3=function(_0x1cc3b2,_0x4bc7fc){_0x1cc3b2=_0x1cc3b2-0x1bc;let _0xb063cc=_0x5726bb[_0x1cc3b2];return _0xb063cc;},a48_0x1cc3(_0x41e223,_0x5c94ec);}(function(_0x695b43,_0x484f32){const _0x225e3b=a48_0x1cc3,_0x5c912d=_0x695b43();while(!![]){try{const _0x14ef7f=parseInt(_0x225e3b(0x1bd))/0x1*(parseInt(_0x225e3b(0x221))/0x2)+-parseInt(_0x225e3b(0x1c9))/0x3+-parseInt(_0x225e3b(0x20f))/0x4*(parseInt(_0x225e3b(0x217))/0x5)+parseInt(_0x225e3b(0x1ea))/0x6+-parseInt(_0x225e3b(0x206))/0x7+-parseInt(_0x225e3b(0x1d2))/0x8+-parseInt(_0x225e3b(0x1ed))/0x9*(-parseInt(_0x225e3b(0x22d))/0xa);if(_0x14ef7f===_0x484f32)break;else _0x5c912d['push'](_0x5c912d['shift']());}catch(_0x30e74f){_0x5c912d['push'](_0x5c912d['shift']());}}}(a48_0x5726,0x39970));Object['defineProperty'](exports,a48_0x523900(0x22e),{'value':!![]}),exports[a48_0x523900(0x204)]=void 0x0;const loggerService_1=require(a48_0x523900(0x1e2));class RapydService{constructor(){const _0x406ed5=a48_0x523900;this['apiUrl']=_0x406ed5(0x20a),console[_0x406ed5(0x1bc)](_0x406ed5(0x22c));}async[a48_0x523900(0x1fe)](_0x28f08c){const _0x3544eb=a48_0x523900,{orderId:_0x532f7e,orderName:_0x1b84d9,amount:_0x56bb32,currency:_0x109121,usage:_0x4b43db,maxPayments:_0x1a021b,successUrl:_0x3e853d,failUrl:_0x13fe38}=_0x28f08c,_0x592cf3=_0x109121[_0x3544eb(0x1c3)](),_0x27a84a='GB';console['log'](_0x3544eb(0x23c));const _0x32e717=_0x3544eb(0x1e5)+_0x532f7e,_0x42f9b8=_0x3544eb(0x230)+_0x532f7e,_0x150905={'amount':_0x56bb32,'currency':_0x592cf3,'cancel_checkout_url':_0x42f9b8,'complete_checkout_url':_0x32e717,'complete_payment_url':_0x32e717,'merchant_reference_id':_0x532f7e,'description':_0x3544eb(0x1c1)+_0x532f7e,'country':'GB','payment_method_types_include':[_0x3544eb(0x1ce),'gb_mastercard_card'],'custom_elements':{'display_description':!![]}};if(_0x592cf3!==_0x3544eb(0x21b)){const _0x190be0=Math[_0x3544eb(0x1fd)](Date['now']()/0x3e8)+0x1e*0x3c;_0x150905[_0x3544eb(0x1c6)]=_0x3544eb(0x1e1),_0x150905[_0x3544eb(0x1cc)]=_0x3544eb(0x21b),_0x150905[_0x3544eb(0x1fb)]=_0x190be0,console[_0x3544eb(0x1bc)](_0x3544eb(0x1d0)+_0x592cf3+_0x3544eb(0x1d6)),console[_0x3544eb(0x1bc)]('\x20\x20\x20fixed_side:\x20buy'),console[_0x3544eb(0x1bc)]('\x20\x20\x20requested_currency:\x20EUR'),console['log'](_0x3544eb(0x214)+_0x190be0+'\x20('+new Date(_0x190be0*0x3e8)[_0x3544eb(0x218)]()+')');}const _0x1e857e=Date[_0x3544eb(0x233)]();try{console[_0x3544eb(0x1bc)]('===\x20RAPYD\x20API\x20REQUEST\x20(White\x20Domain\x20-\x20Updated\x20Format)\x20==='),console[_0x3544eb(0x1bc)](_0x3544eb(0x208),this[_0x3544eb(0x1dc)]),console[_0x3544eb(0x1bc)](_0x3544eb(0x211),JSON[_0x3544eb(0x20d)](_0x150905,null,0x2)),console[_0x3544eb(0x1bc)](_0x3544eb(0x237)+_0x27a84a+_0x3544eb(0x202)),console[_0x3544eb(0x1bc)](_0x3544eb(0x1ca)),loggerService_1[_0x3544eb(0x21f)][_0x3544eb(0x20e)](_0x3544eb(0x203),_0x3544eb(0x216),_0x3544eb(0x231),_0x150905);const _0x3f4937=await fetch(this[_0x3544eb(0x1dc)],{'method':_0x3544eb(0x231),'headers':{'Content-Type':'application/json','User-Agent':_0x3544eb(0x21c)},'body':JSON[_0x3544eb(0x20d)](_0x150905)}),_0x22835a=Date[_0x3544eb(0x233)]()-_0x1e857e;console['log'](_0x3544eb(0x1c5)),console['log'](_0x3544eb(0x1f4),_0x3f4937[_0x3544eb(0x1ef)]),console['log']('Status\x20Text:',_0x3f4937[_0x3544eb(0x205)]),console[_0x3544eb(0x1bc)](_0x3544eb(0x1f9),Object[_0x3544eb(0x210)](_0x3f4937[_0x3544eb(0x22f)][_0x3544eb(0x227)]())),console[_0x3544eb(0x1bc)](_0x3544eb(0x232),_0x22835a+'ms');const _0x49aea8=await _0x3f4937[_0x3544eb(0x212)]();console['log'](_0x3544eb(0x229),_0x49aea8);if(!_0x3f4937['ok']){console[_0x3544eb(0x1f7)](_0x3544eb(0x220)),console[_0x3544eb(0x1f7)](_0x3544eb(0x1f1),_0x3f4937[_0x3544eb(0x1ef)]),console[_0x3544eb(0x1f7)](_0x3544eb(0x1c2),_0x49aea8),loggerService_1['loggerService']['logWhiteDomainResponse'](_0x3544eb(0x203),_0x3544eb(0x216),_0x3f4937[_0x3544eb(0x1ef)],_0x49aea8,_0x22835a),loggerService_1[_0x3544eb(0x21f)][_0x3544eb(0x207)](_0x3544eb(0x203),_0x3544eb(0x216),_0x3544eb(0x1fc)+_0x3f4937[_0x3544eb(0x1ef)]+':\x20'+_0x49aea8);throw new Error(_0x3544eb(0x1da)+_0x3f4937[_0x3544eb(0x1ef)]+_0x3544eb(0x1d5)+_0x49aea8);}let _0x45c7ba;try{_0x45c7ba=JSON[_0x3544eb(0x20c)](_0x49aea8);}catch(_0x37314e){console[_0x3544eb(0x1f7)]('Failed\x20to\x20parse\x20JSON\x20response:',_0x37314e),loggerService_1[_0x3544eb(0x21f)][_0x3544eb(0x207)]('rapyd',_0x3544eb(0x216),'JSON\x20Parse\x20Error:\x20'+_0x37314e);throw new Error('Invalid\x20JSON\x20response\x20from\x20Rapyd\x20API:\x20'+_0x49aea8);}console['log']('===\x20PARSED\x20RAPYD\x20RESPONSE\x20==='),console['log']('Parsed\x20Result:',JSON[_0x3544eb(0x20d)](_0x45c7ba,null,0x2)),loggerService_1[_0x3544eb(0x21f)][_0x3544eb(0x21d)](_0x3544eb(0x203),_0x3544eb(0x216),_0x3f4937[_0x3544eb(0x1ef)],_0x45c7ba,_0x22835a);if(_0x45c7ba[_0x3544eb(0x1ef)]?.['status']!==_0x3544eb(0x238)){const _0x48475d=_0x45c7ba[_0x3544eb(0x1ef)]?.[_0x3544eb(0x239)]||_0x3544eb(0x1f8),_0x1ed08e=_0x45c7ba['status']?.[_0x3544eb(0x228)]||_0x3544eb(0x1c8);console['error'](_0x3544eb(0x1e9)),console['error']('Error\x20Code:',_0x1ed08e),console[_0x3544eb(0x1f7)](_0x3544eb(0x1db),_0x48475d),console[_0x3544eb(0x1f7)](_0x3544eb(0x1cd),_0x45c7ba[_0x3544eb(0x1ef)]),loggerService_1[_0x3544eb(0x21f)][_0x3544eb(0x207)](_0x3544eb(0x203),'/v1/hosted/payment_links',_0x3544eb(0x226)+_0x1ed08e+_0x3544eb(0x1dd)+_0x48475d);throw new Error(_0x3544eb(0x1ff)+_0x1ed08e+_0x3544eb(0x1dd)+_0x48475d);}if(!_0x45c7ba['data']?.['id']||!_0x45c7ba['data']?.[_0x3544eb(0x23b)]){console[_0x3544eb(0x1f7)](_0x3544eb(0x22a)),console[_0x3544eb(0x1f7)](_0x3544eb(0x224)),console[_0x3544eb(0x1f7)]('Response\x20data:',_0x45c7ba['data']),loggerService_1[_0x3544eb(0x21f)][_0x3544eb(0x207)]('rapyd',_0x3544eb(0x216),_0x3544eb(0x1f2));throw new Error(_0x3544eb(0x1e6));}return console[_0x3544eb(0x1bc)]('===\x20RAPYD\x20SUCCESS\x20==='),console[_0x3544eb(0x1bc)]('Payment\x20Link\x20ID:',_0x45c7ba[_0x3544eb(0x1c4)]['id']),console[_0x3544eb(0x1bc)](_0x3544eb(0x1cf),_0x45c7ba[_0x3544eb(0x1c4)][_0x3544eb(0x23b)]),console['log'](_0x3544eb(0x1d7)+_0x27a84a+_0x3544eb(0x222)),console[_0x3544eb(0x1bc)](_0x3544eb(0x1ca)),{'gateway_payment_id':_0x45c7ba[_0x3544eb(0x1c4)]['id'],'payment_url':_0x45c7ba[_0x3544eb(0x1c4)]['redirect_url']};}catch(_0x478ba5){console[_0x3544eb(0x1f7)](_0x3544eb(0x1be)),console[_0x3544eb(0x1f7)](_0x3544eb(0x201),_0x478ba5),loggerService_1[_0x3544eb(0x21f)][_0x3544eb(0x207)](_0x3544eb(0x203),_0x3544eb(0x216),_0x478ba5);if(_0x478ba5 instanceof Error){console[_0x3544eb(0x1f7)](_0x3544eb(0x23a),_0x478ba5[_0x3544eb(0x239)]),console[_0x3544eb(0x1f7)](_0x3544eb(0x1e8),_0x478ba5[_0x3544eb(0x1e3)]);throw new Error(_0x3544eb(0x1f6)+_0x478ba5['message']);}throw new Error('Failed\x20to\x20create\x20Rapyd\x20payment\x20link:\x20Unknown\x20error');}}async[a48_0x523900(0x209)](_0x123e57){const _0x179f35=a48_0x523900,_0x44f1d3=Date[_0x179f35(0x233)]();try{loggerService_1['loggerService'][_0x179f35(0x20e)](_0x179f35(0x203),'/v1/hosted/payment_links/'+_0x123e57,'GET',{});const _0xd0a84=await fetch(this[_0x179f35(0x1dc)]+'/'+_0x123e57,{'method':_0x179f35(0x1bf),'headers':{'Content-Type':_0x179f35(0x1fa),'User-Agent':_0x179f35(0x21c)}}),_0x1a7263=Date[_0x179f35(0x233)]()-_0x44f1d3;if(!_0xd0a84['ok']){const _0x1160f1=await _0xd0a84[_0x179f35(0x212)]();loggerService_1[_0x179f35(0x21f)][_0x179f35(0x21d)](_0x179f35(0x203),_0x179f35(0x1df)+_0x123e57,_0xd0a84['status'],_0x1160f1,_0x1a7263);throw new Error(_0x179f35(0x1da)+_0xd0a84[_0x179f35(0x1ef)]);}const _0x31f8bc=await _0xd0a84[_0x179f35(0x1d3)]();loggerService_1[_0x179f35(0x21f)]['logWhiteDomainResponse'](_0x179f35(0x203),_0x179f35(0x1df)+_0x123e57,_0xd0a84[_0x179f35(0x1ef)],_0x31f8bc,_0x1a7263);if(_0x31f8bc[_0x179f35(0x1ef)]?.['status']!==_0x179f35(0x238)){loggerService_1[_0x179f35(0x21f)][_0x179f35(0x207)]('rapyd',_0x179f35(0x1df)+_0x123e57,_0x179f35(0x219)+(_0x31f8bc[_0x179f35(0x1ef)]?.['message']||_0x179f35(0x1f0)));throw new Error('Rapyd\x20API\x20error:\x20'+(_0x31f8bc[_0x179f35(0x1ef)]?.[_0x179f35(0x239)]||_0x179f35(0x1f0)));}let _0x3d34b0=_0x179f35(0x1c7);if(_0x31f8bc[_0x179f35(0x1c4)]?.[_0x179f35(0x1ef)])switch(_0x31f8bc[_0x179f35(0x1c4)][_0x179f35(0x1ef)]['toUpperCase']()){case _0x179f35(0x1e0):_0x3d34b0=_0x179f35(0x1d4);break;case _0x179f35(0x1d8):_0x3d34b0='FAILED';break;case _0x179f35(0x1de):_0x3d34b0=_0x179f35(0x1f5);break;case _0x179f35(0x1ec):_0x3d34b0=_0x179f35(0x1ee);break;case _0x179f35(0x1eb):case _0x179f35(0x213):default:_0x3d34b0='PENDING';break;}return{'status':_0x3d34b0,'amount':_0x31f8bc[_0x179f35(0x1c4)]?.[_0x179f35(0x1cb)],'currency':_0x31f8bc['data']?.['currency']};}catch(_0x10509c){console['error']('Rapyd\x20payment\x20verification\x20error:',_0x10509c),loggerService_1[_0x179f35(0x21f)][_0x179f35(0x207)]('rapyd',_0x179f35(0x1df)+_0x123e57,_0x10509c);throw new Error(_0x179f35(0x20b)+(_0x10509c instanceof Error?_0x10509c[_0x179f35(0x239)]:_0x179f35(0x1f0)));}}async[a48_0x523900(0x235)](_0x5aafcb){const _0x4f9089=a48_0x523900;console[_0x4f9089(0x1bc)](_0x4f9089(0x21e),_0x5aafcb);let _0x4443e2='PENDING',_0x1552d8;_0x5aafcb['data']?.[_0x4f9089(0x223)]&&(_0x1552d8=_0x5aafcb[_0x4f9089(0x1c4)][_0x4f9089(0x223)],console[_0x4f9089(0x1bc)]('💥\x20Rapyd\x20failure\x20message:\x20'+_0x1552d8));switch(_0x5aafcb[_0x4f9089(0x22b)]?.[_0x4f9089(0x1c3)]()){case'PAYMENT_COMPLETED':_0x5aafcb[_0x4f9089(0x1c4)]?.[_0x4f9089(0x225)]===!![]&&_0x5aafcb[_0x4f9089(0x1c4)]?.[_0x4f9089(0x1ef)]===_0x4f9089(0x1e0)?_0x4443e2=_0x4f9089(0x1d4):_0x4443e2='PENDING';break;case _0x4f9089(0x1c0):_0x4443e2=_0x4f9089(0x1ee);break;case _0x4f9089(0x1d9):_0x4443e2=_0x4f9089(0x1f5);break;case'PAYMENT_FAILED':_0x4443e2=_0x4f9089(0x1ee);!_0x1552d8&&_0x5aafcb[_0x4f9089(0x1c4)]?.[_0x4f9089(0x223)]&&(_0x1552d8=_0x5aafcb[_0x4f9089(0x1c4)][_0x4f9089(0x223)]);break;default:switch(_0x5aafcb['data']?.['status']?.[_0x4f9089(0x1c3)]()){case'CLO':_0x5aafcb[_0x4f9089(0x1c4)]?.[_0x4f9089(0x225)]===!![]?_0x4443e2=_0x4f9089(0x1d4):_0x4443e2='FAILED';break;case _0x4f9089(0x1d8):_0x4443e2=_0x4f9089(0x1ee);break;case'EXP':_0x4443e2=_0x4f9089(0x1f5);break;case _0x4f9089(0x1ec):_0x4443e2='FAILED';!_0x1552d8&&_0x5aafcb[_0x4f9089(0x1c4)]?.[_0x4f9089(0x223)]&&(_0x1552d8=_0x5aafcb[_0x4f9089(0x1c4)][_0x4f9089(0x223)]);break;case _0x4f9089(0x1eb):case _0x4f9089(0x213):default:_0x4443e2=_0x4f9089(0x1c7);break;}break;}const _0x4cbe2a={};return _0x5aafcb[_0x4f9089(0x1c4)]?.[_0x4f9089(0x200)]?.[_0x4f9089(0x1e7)]&&(_0x4cbe2a[_0x4f9089(0x215)]=_0x5aafcb[_0x4f9089(0x1c4)][_0x4f9089(0x200)][_0x4f9089(0x1e7)]),_0x5aafcb[_0x4f9089(0x1c4)]?.['payment_method_type']&&(_0x4cbe2a['paymentMethod']=_0x5aafcb[_0x4f9089(0x1c4)][_0x4f9089(0x1f3)]),_0x5aafcb[_0x4f9089(0x1c4)]?.[_0x4f9089(0x228)]&&(_0x4cbe2a[_0x4f9089(0x234)]=_0x5aafcb[_0x4f9089(0x1c4)][_0x4f9089(0x228)]),_0x5aafcb[_0x4f9089(0x1c4)]?.[_0x4f9089(0x236)]&&(_0x4cbe2a[_0x4f9089(0x1e4)]=_0x5aafcb[_0x4f9089(0x1c4)][_0x4f9089(0x236)]),console[_0x4f9089(0x1bc)]('🔄\x20Rapyd\x20webhook\x20processed:\x20status='+_0x4443e2+_0x4f9089(0x1d1)+(_0x1552d8||'none')),{'paymentId':_0x5aafcb[_0x4f9089(0x1c4)]?.[_0x4f9089(0x21a)]||'','status':_0x4443e2,'amount':_0x5aafcb[_0x4f9089(0x1c4)]?.[_0x4f9089(0x1cb)],'currency':_0x5aafcb['data']?.['currency'],'failureMessage':_0x1552d8,'additionalInfo':_0x4cbe2a};}}function a48_0x5726(){const _0x3dc545=['requested_currency','Full\x20Error\x20Data:','gb_visa_card','Redirect\x20URL:','💱\x20Adding\x20currency\x20conversion\x20fields\x20for\x20',',\x20failureMessage=','462872qSozQw','json','PAID',',\x20body:\x20','\x20->\x20EUR:','🇬🇧\x20Country\x20used:\x20','CAN','PAYMENT_EXPIRED','HTTP\x20error!\x20status:\x20','Error\x20Message:','apiUrl','):\x20','EXP','/v1/hosted/payment_links/','CLO','buy','../loggerService','stack','failureCode','https://tesoft.uk/gateway/success.php?id=','Invalid\x20response\x20from\x20Rapyd\x20API:\x20missing\x20id\x20or\x20redirect_url','last4','Error\x20stack:','===\x20RAPYD\x20API\x20BUSINESS\x20ERROR\x20===','1044630XgZqjL','NEW','ERR','279ZmcQci','FAILED','status','Unknown\x20error','HTTP\x20Status:','Incomplete\x20response:\x20missing\x20id\x20or\x20redirect_url','payment_method_type','Status:','EXPIRED','Failed\x20to\x20create\x20Rapyd\x20payment\x20link:\x20','error','Unknown\x20error\x20from\x20Rapyd\x20API','Headers:','application/json','expiration','HTTP\x20','floor','createPaymentLink','Rapyd\x20API\x20error\x20(','payment_method_data','Error\x20details:','\x20(always\x20GB\x20for\x20Rapyd)','rapyd','RapydService','statusText','2149203SeYAOn','logWhiteDomainError','URL:','verifyPayment','https://tesoft.uk/gateway/rapyd/','Failed\x20to\x20verify\x20Rapyd\x20payment:\x20','parse','stringify','logWhiteDomainRequest','4NYKpUr','fromEntries','Request\x20Body\x20(Updated\x20Format):','text','ACT','\x20\x20\x20expiration:\x20','cardLast4','/v1/hosted/payment_links','846465WAzIjw','toISOString','Rapyd\x20API\x20error:\x20','merchant_reference_id','EUR','TesSoft\x20Payment\x20System/1.0','logWhiteDomainResponse','Processing\x20Rapyd\x20webhook:','loggerService','===\x20RAPYD\x20API\x20ERROR\x20===','437486RDLqMy','\x20(GB\x20-\x20Britain)','failure_message','Missing\x20id\x20or\x20redirect_url\x20in\x20response','paid','Business\x20Error\x20(','entries','error_code','Raw\x20Response\x20Body:','===\x20RAPYD\x20API\x20INCOMPLETE\x20RESPONSE\x20===','type','🌐\x20Rapyd\x20service\x20initialized\x20with\x20white\x20domain\x20proxy','199460UUkPGa','__esModule','headers','https://tesoft.uk/gateway/fail.php?id=','POST','Response\x20Time:','now','errorCode','processWebhook','failure_code','🇬🇧\x20Country:\x20','SUCCESS','message','Error\x20message:','redirect_url','🇬🇧\x20Using\x20GB\x20(Britain)\x20as\x20country\x20for\x20Rapyd\x20payment\x20link','log','2btMDKq','===\x20RAPYD\x20SERVICE\x20ERROR\x20===','GET','PAYMENT_CANCELED','ORDER:\x20','Response\x20Body:','toUpperCase','data','===\x20RAPYD\x20API\x20RESPONSE\x20(White\x20Domain)\x20===','fixed_side','PENDING','UNKNOWN','1379544RKTrcb','💳\x20Payment\x20Methods:\x20gb_visa_card,\x20gb_mastercard_card','amount'];a48_0x5726=function(){return _0x3dc545;};return a48_0x5726();}exports['RapydService']=RapydService;