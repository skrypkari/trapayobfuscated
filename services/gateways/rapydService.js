'use strict';const a67_0x423706=a67_0x1c64;(function(_0x1b62a3,_0x2388e4){const _0x2e45fb=a67_0x1c64,_0x519552=_0x1b62a3();while(!![]){try{const _0x2c75ef=-parseInt(_0x2e45fb(0x107))/0x1+parseInt(_0x2e45fb(0x12f))/0x2*(-parseInt(_0x2e45fb(0x126))/0x3)+parseInt(_0x2e45fb(0xcb))/0x4*(-parseInt(_0x2e45fb(0xc9))/0x5)+-parseInt(_0x2e45fb(0x141))/0x6*(parseInt(_0x2e45fb(0xf5))/0x7)+parseInt(_0x2e45fb(0xe0))/0x8+parseInt(_0x2e45fb(0xfd))/0x9*(parseInt(_0x2e45fb(0x149))/0xa)+parseInt(_0x2e45fb(0x118))/0xb*(parseInt(_0x2e45fb(0xf0))/0xc);if(_0x2c75ef===_0x2388e4)break;else _0x519552['push'](_0x519552['shift']());}catch(_0x5df3e2){_0x519552['push'](_0x519552['shift']());}}}(a67_0x2776,0xf1c75));function a67_0x1c64(_0x3842d6,_0x5c055c){_0x3842d6=_0x3842d6-0xc7;const _0x27760b=a67_0x2776();let _0x1c64c4=_0x27760b[_0x3842d6];return _0x1c64c4;}function a67_0x2776(){const _0x22bfcf=['Rapyd\x20API\x20error\x20(','PAYMENT_CANCELED','Processing\x20Rapyd\x20webhook:','logWhiteDomainResponse','redirect_url','loggerService','\x20->\x20EUR:','2105040nXmEQA','stack','toISOString','now','===\x20RAPYD\x20API\x20BUSINESS\x20ERROR\x20===','Incomplete\x20response:\x20missing\x20id\x20or\x20redirect_url','PENDING','amount','PAYMENT_COMPLETED','ERR','üîÑ\x20Rapyd\x20webhook\x20processed:\x20status=','paymentMethod','status','failure_code','\x20\x20\x20requested_currency:\x20EUR','Failed\x20to\x20create\x20Rapyd\x20payment\x20link:\x20','12ezNWnG','PAID','Headers:','rapyd','\x20\x20\x20expiration:\x20','334201pjHgyU','HTTP\x20error!\x20status:\x20','apiUrl','fromEntries','Status:','PAYMENT_FAILED','EXP','Response\x20Body:','8838jVruyC','failure_message','error_code','EUR','Unknown\x20error','üí≥\x20Payment\x20Methods:\x20gb_visa_card,\x20gb_mastercard_card','/v1/hosted/payment_links','Payment\x20Link\x20ID:','Error\x20details:','merchant_reference_id','861272SzVobX','payment_method_type','üí•\x20Rapyd\x20failure\x20message:\x20','Redirect\x20URL:','last4','üí≥\x20Card\x20brand\x20from\x20bin_details:\x20','Rapyd\x20API\x20error:\x20','verifyPayment','JSON\x20Parse\x20Error:\x20','FAILED','bin_details','log','üá¨üáß\x20Country\x20used:\x20','Rapyd\x20payment\x20verification\x20error:','Failed\x20to\x20parse\x20JSON\x20response:','custom_elements','logWhiteDomainError','41856463MYCikr','buy','phone_number','===\x20RAPYD\x20API\x20RESPONSE\x20(White\x20Domain)\x20===','üá¨üáß\x20Country:\x20','Error\x20Code:','Business\x20Error\x20(','data','Invalid\x20response\x20from\x20Rapyd\x20API:\x20missing\x20id\x20or\x20redirect_url','Invalid\x20JSON\x20response\x20from\x20Rapyd\x20API:\x20','ORDER:\x20','fixed_side','POST','payment_method_data','93BWyVig','üí≥\x20Adding\x20cardholder\x20name:\x20','TESOFT\x20','Response\x20data:','EXPIRED','üí±\x20Adding\x20currency\x20conversion\x20fields\x20for\x20','Request\x20Body\x20(Updated\x20Format):','parse','\x20\x20\x20fixed_side:\x20buy','33862HdnwPo','expiration','üá¨üáß\x20Using\x20GB\x20(Britain)\x20as\x20country\x20for\x20Rapyd\x20payment\x20link','logWhiteDomainRequest','cardholder_name','message','Full\x20Error\x20Data:','errorCode','address','brand','CLO','https://tesoft.uk/gateway/fail.php?id=','RapydService','paid','gb_mastercard_card','https://tesoft.uk/gateway/success.php?id=','error','ACT','192ImdKiq','currency','===\x20PARSED\x20RAPYD\x20RESPONSE\x20===','toUpperCase','===\x20RAPYD\x20API\x20ERROR\x20===','../loggerService','Error\x20message:','Parsed\x20Result:','670yXPhzp','===\x20RAPYD\x20SUCCESS\x20===','NEW','cardBrand','üåê\x20Rapyd\x20service\x20initialized\x20with\x20white\x20domain\x20proxy','requested_currency','email','===\x20RAPYD\x20API\x20INCOMPLETE\x20RESPONSE\x20===','createPaymentLink','stringify','SUCCESS','/v1/hosted/payment_links/','Failed\x20to\x20create\x20Rapyd\x20payment\x20link:\x20Unknown\x20error','55ZymzOz','PAYMENT_EXPIRED','83572ObXhya','):\x20','Response\x20Time:','application/json','HTTP\x20','gb_visa_card','json','cardLast4','Payment\x20System/1.0','CAN','===\x20RAPYD\x20API\x20REQUEST\x20(White\x20Domain\x20-\x20Updated\x20Format)\x20===','entries','GET','__esModule'];a67_0x2776=function(){return _0x22bfcf;};return a67_0x2776();}Object['defineProperty'](exports,a67_0x423706(0xd8),{'value':!![]}),exports[a67_0x423706(0x13b)]=void 0x0;const loggerService_1=require(a67_0x423706(0x146));class RapydService{constructor(){const _0x15a986=a67_0x423706;this['apiUrl']='https://tesoft.uk/gateway/rapyd/',console['log'](_0x15a986(0x14d));}async[a67_0x423706(0x151)](_0x8467cf){const _0x42a03a=a67_0x423706,{orderId:_0x3c26b2,orderName:_0x7db207,amount:_0x2a51f3,currency:_0x4ed15f,usage:_0x20f4c0,maxPayments:_0x171f7e,successUrl:_0x163f60,failUrl:_0x3a1801,customerName:_0x439c21,customerEmail:_0x552510}=_0x8467cf,_0x512d25=_0x4ed15f[_0x42a03a(0x144)](),_0x5f8c86='GB';console[_0x42a03a(0x112)](_0x42a03a(0x131));const _0x26afd4=_0x42a03a(0x13e)+_0x3c26b2,_0x124c4c=_0x42a03a(0x13a)+_0x3c26b2,_0x18a810={'amount':_0x2a51f3,'currency':_0x512d25,'payment_method_options':{'3d_required':![]},'cancel_checkout_url':_0x124c4c,'complete_checkout_url':_0x26afd4,'complete_payment_url':_0x26afd4,'merchant_reference_id':_0x3c26b2,'description':_0x42a03a(0x122)+_0x3c26b2,'statement_descriptor':_0x42a03a(0x128)+(_0x3c26b2['split']('-')[0x1]||_0x3c26b2),'country':'GB','payment_method_types_include':[_0x42a03a(0xd0),_0x42a03a(0x13d)],'custom_elements':{'display_description':!![],'billing_address_collect':!![],'required_customer_fields':['name',_0x42a03a(0x14f),_0x42a03a(0x11a),_0x42a03a(0x137)]}};_0x439c21&&(_0x18a810[_0x42a03a(0x116)][_0x42a03a(0x133)]=_0x439c21,console[_0x42a03a(0x112)](_0x42a03a(0x127)+_0x439c21));if(_0x512d25!==_0x42a03a(0x100)){const _0x366820=Math['floor'](Date['now']()/0x3e8)+0x1e*0x3c;_0x18a810[_0x42a03a(0x123)]=_0x42a03a(0x119),_0x18a810[_0x42a03a(0x14e)]=_0x42a03a(0x100),_0x18a810[_0x42a03a(0x130)]=_0x366820,console[_0x42a03a(0x112)](_0x42a03a(0x12b)+_0x512d25+_0x42a03a(0xdf)),console[_0x42a03a(0x112)](_0x42a03a(0x12e)),console[_0x42a03a(0x112)](_0x42a03a(0xee)),console[_0x42a03a(0x112)](_0x42a03a(0xf4)+_0x366820+'\x20('+new Date(_0x366820*0x3e8)[_0x42a03a(0xe2)]()+')');}const _0x2dea1b=Date[_0x42a03a(0xe3)]();try{console[_0x42a03a(0x112)](_0x42a03a(0xd5)),console['log']('URL:',this[_0x42a03a(0xf7)]),console['log'](_0x42a03a(0x12c),JSON['stringify'](_0x18a810,null,0x2)),console[_0x42a03a(0x112)](_0x42a03a(0x11c)+_0x5f8c86+'\x20(always\x20GB\x20for\x20Rapyd)'),console[_0x42a03a(0x112)](_0x42a03a(0x102)),loggerService_1[_0x42a03a(0xde)][_0x42a03a(0x132)](_0x42a03a(0xf3),_0x42a03a(0x103),_0x42a03a(0x124),_0x18a810);const _0x2d2b2b=await fetch(this[_0x42a03a(0xf7)],{'method':_0x42a03a(0x124),'headers':{'Content-Type':'application/json','User-Agent':'Payment\x20System/1.0'},'body':JSON[_0x42a03a(0x152)](_0x18a810)}),_0x33e7a0=Date[_0x42a03a(0xe3)]()-_0x2dea1b;console[_0x42a03a(0x112)](_0x42a03a(0x11b)),console[_0x42a03a(0x112)](_0x42a03a(0xf9),_0x2d2b2b[_0x42a03a(0xec)]),console['log']('Status\x20Text:',_0x2d2b2b['statusText']),console['log'](_0x42a03a(0xf2),Object[_0x42a03a(0xf8)](_0x2d2b2b['headers'][_0x42a03a(0xd6)]())),console[_0x42a03a(0x112)](_0x42a03a(0xcd),_0x33e7a0+'ms');const _0x4b9e89=await _0x2d2b2b['text']();console[_0x42a03a(0x112)]('Raw\x20Response\x20Body:',_0x4b9e89);if(!_0x2d2b2b['ok']){console['error'](_0x42a03a(0x145)),console['error']('HTTP\x20Status:',_0x2d2b2b['status']),console[_0x42a03a(0x13f)](_0x42a03a(0xfc),_0x4b9e89),loggerService_1['loggerService'][_0x42a03a(0xdc)](_0x42a03a(0xf3),_0x42a03a(0x103),_0x2d2b2b[_0x42a03a(0xec)],_0x4b9e89,_0x33e7a0),loggerService_1[_0x42a03a(0xde)][_0x42a03a(0x117)]('rapyd',_0x42a03a(0x103),_0x42a03a(0xcf)+_0x2d2b2b[_0x42a03a(0xec)]+':\x20'+_0x4b9e89);throw new Error(_0x42a03a(0xf6)+_0x2d2b2b[_0x42a03a(0xec)]+',\x20body:\x20'+_0x4b9e89);}let _0x287262;try{_0x287262=JSON[_0x42a03a(0x12d)](_0x4b9e89);}catch(_0x24991b){console[_0x42a03a(0x13f)](_0x42a03a(0x115),_0x24991b),loggerService_1[_0x42a03a(0xde)]['logWhiteDomainError'](_0x42a03a(0xf3),'/v1/hosted/payment_links',_0x42a03a(0x10f)+_0x24991b);throw new Error(_0x42a03a(0x121)+_0x4b9e89);}console[_0x42a03a(0x112)](_0x42a03a(0x143)),console[_0x42a03a(0x112)](_0x42a03a(0x148),JSON[_0x42a03a(0x152)](_0x287262,null,0x2)),loggerService_1['loggerService']['logWhiteDomainResponse'](_0x42a03a(0xf3),'/v1/hosted/payment_links',_0x2d2b2b[_0x42a03a(0xec)],_0x287262,_0x33e7a0);if(_0x287262[_0x42a03a(0xec)]?.[_0x42a03a(0xec)]!==_0x42a03a(0x153)){const _0x50dc62=_0x287262['status']?.[_0x42a03a(0x134)]||'Unknown\x20error\x20from\x20Rapyd\x20API',_0x7ed39d=_0x287262[_0x42a03a(0xec)]?.[_0x42a03a(0xff)]||'UNKNOWN';console[_0x42a03a(0x13f)](_0x42a03a(0xe4)),console[_0x42a03a(0x13f)](_0x42a03a(0x11d),_0x7ed39d),console[_0x42a03a(0x13f)]('Error\x20Message:',_0x50dc62),console['error'](_0x42a03a(0x135),_0x287262[_0x42a03a(0xec)]),loggerService_1['loggerService'][_0x42a03a(0x117)](_0x42a03a(0xf3),_0x42a03a(0x103),_0x42a03a(0x11e)+_0x7ed39d+_0x42a03a(0xcc)+_0x50dc62);throw new Error(_0x42a03a(0xd9)+_0x7ed39d+_0x42a03a(0xcc)+_0x50dc62);}if(!_0x287262[_0x42a03a(0x11f)]?.['id']||!_0x287262[_0x42a03a(0x11f)]?.[_0x42a03a(0xdd)]){console[_0x42a03a(0x13f)](_0x42a03a(0x150)),console[_0x42a03a(0x13f)]('Missing\x20id\x20or\x20redirect_url\x20in\x20response'),console[_0x42a03a(0x13f)](_0x42a03a(0x129),_0x287262[_0x42a03a(0x11f)]),loggerService_1[_0x42a03a(0xde)][_0x42a03a(0x117)](_0x42a03a(0xf3),_0x42a03a(0x103),_0x42a03a(0xe5));throw new Error(_0x42a03a(0x120));}return console[_0x42a03a(0x112)](_0x42a03a(0x14a)),console[_0x42a03a(0x112)](_0x42a03a(0x104),_0x287262[_0x42a03a(0x11f)]['id']),console[_0x42a03a(0x112)](_0x42a03a(0x10a),_0x287262[_0x42a03a(0x11f)][_0x42a03a(0xdd)]),console[_0x42a03a(0x112)](_0x42a03a(0x113)+_0x5f8c86+'\x20(GB\x20-\x20Britain)'),console['log'](_0x42a03a(0x102)),{'gateway_payment_id':_0x287262['data']['id'],'payment_url':_0x287262[_0x42a03a(0x11f)]['redirect_url']};}catch(_0x111959){console[_0x42a03a(0x13f)]('===\x20RAPYD\x20SERVICE\x20ERROR\x20==='),console['error'](_0x42a03a(0x105),_0x111959),loggerService_1[_0x42a03a(0xde)][_0x42a03a(0x117)](_0x42a03a(0xf3),'/v1/hosted/payment_links',_0x111959);if(_0x111959 instanceof Error){console['error'](_0x42a03a(0x147),_0x111959['message']),console[_0x42a03a(0x13f)]('Error\x20stack:',_0x111959[_0x42a03a(0xe1)]);throw new Error(_0x42a03a(0xef)+_0x111959[_0x42a03a(0x134)]);}throw new Error(_0x42a03a(0xc8));}}async[a67_0x423706(0x10e)](_0x21fa0b){const _0x1e7495=a67_0x423706,_0x10f3e9=Date[_0x1e7495(0xe3)]();try{loggerService_1[_0x1e7495(0xde)][_0x1e7495(0x132)](_0x1e7495(0xf3),_0x1e7495(0xc7)+_0x21fa0b,'GET',{});const _0x195953=await fetch(this['apiUrl']+'/'+_0x21fa0b,{'method':_0x1e7495(0xd7),'headers':{'Content-Type':_0x1e7495(0xce),'User-Agent':_0x1e7495(0xd3)}}),_0x57ee89=Date[_0x1e7495(0xe3)]()-_0x10f3e9;if(!_0x195953['ok']){const _0x32c846=await _0x195953['text']();loggerService_1[_0x1e7495(0xde)]['logWhiteDomainResponse'](_0x1e7495(0xf3),'/v1/hosted/payment_links/'+_0x21fa0b,_0x195953[_0x1e7495(0xec)],_0x32c846,_0x57ee89);throw new Error('HTTP\x20error!\x20status:\x20'+_0x195953[_0x1e7495(0xec)]);}const _0x249978=await _0x195953[_0x1e7495(0xd1)]();loggerService_1[_0x1e7495(0xde)][_0x1e7495(0xdc)](_0x1e7495(0xf3),'/v1/hosted/payment_links/'+_0x21fa0b,_0x195953[_0x1e7495(0xec)],_0x249978,_0x57ee89);if(_0x249978[_0x1e7495(0xec)]?.[_0x1e7495(0xec)]!==_0x1e7495(0x153)){loggerService_1[_0x1e7495(0xde)]['logWhiteDomainError']('rapyd',_0x1e7495(0xc7)+_0x21fa0b,_0x1e7495(0x10d)+(_0x249978[_0x1e7495(0xec)]?.[_0x1e7495(0x134)]||'Unknown\x20error'));throw new Error('Rapyd\x20API\x20error:\x20'+(_0x249978[_0x1e7495(0xec)]?.['message']||'Unknown\x20error'));}let _0x76e6ed=_0x1e7495(0xe6);if(_0x249978[_0x1e7495(0x11f)]?.['status'])switch(_0x249978['data']['status'][_0x1e7495(0x144)]()){case _0x1e7495(0x139):_0x76e6ed=_0x1e7495(0xf1);break;case _0x1e7495(0xd4):_0x76e6ed=_0x1e7495(0x110);break;case _0x1e7495(0xfb):_0x76e6ed=_0x1e7495(0x12a);break;case _0x1e7495(0xe9):_0x76e6ed=_0x1e7495(0x110);break;case _0x1e7495(0x14b):case _0x1e7495(0x140):default:_0x76e6ed='PENDING';break;}return{'status':_0x76e6ed,'amount':_0x249978[_0x1e7495(0x11f)]?.[_0x1e7495(0xe7)],'currency':_0x249978[_0x1e7495(0x11f)]?.[_0x1e7495(0x142)]};}catch(_0x568076){console['error'](_0x1e7495(0x114),_0x568076),loggerService_1['loggerService']['logWhiteDomainError'](_0x1e7495(0xf3),_0x1e7495(0xc7)+_0x21fa0b,_0x568076);throw new Error('Failed\x20to\x20verify\x20Rapyd\x20payment:\x20'+(_0x568076 instanceof Error?_0x568076[_0x1e7495(0x134)]:_0x1e7495(0x101)));}}async['processWebhook'](_0x1a6487){const _0x3def3f=a67_0x423706;console[_0x3def3f(0x112)](_0x3def3f(0xdb),_0x1a6487);let _0x556276=_0x3def3f(0xe6),_0x48bd80;_0x1a6487[_0x3def3f(0x11f)]?.[_0x3def3f(0xfe)]&&(_0x48bd80=_0x1a6487[_0x3def3f(0x11f)][_0x3def3f(0xfe)],console[_0x3def3f(0x112)](_0x3def3f(0x109)+_0x48bd80));switch(_0x1a6487['type']?.[_0x3def3f(0x144)]()){case _0x3def3f(0xe8):_0x1a6487[_0x3def3f(0x11f)]?.[_0x3def3f(0x13c)]===!![]&&_0x1a6487[_0x3def3f(0x11f)]?.[_0x3def3f(0xec)]===_0x3def3f(0x139)?_0x556276='PAID':_0x556276=_0x3def3f(0xe6);break;case _0x3def3f(0xda):_0x556276='FAILED';break;case _0x3def3f(0xca):_0x556276=_0x3def3f(0x12a);break;case _0x3def3f(0xfa):_0x556276=_0x3def3f(0x110);!_0x48bd80&&_0x1a6487[_0x3def3f(0x11f)]?.['failure_message']&&(_0x48bd80=_0x1a6487['data'][_0x3def3f(0xfe)]);break;default:switch(_0x1a6487[_0x3def3f(0x11f)]?.[_0x3def3f(0xec)]?.[_0x3def3f(0x144)]()){case _0x3def3f(0x139):_0x1a6487['data']?.[_0x3def3f(0x13c)]===!![]?_0x556276=_0x3def3f(0xf1):_0x556276='FAILED';break;case _0x3def3f(0xd4):_0x556276='FAILED';break;case'EXP':_0x556276=_0x3def3f(0x12a);break;case _0x3def3f(0xe9):_0x556276=_0x3def3f(0x110);!_0x48bd80&&_0x1a6487[_0x3def3f(0x11f)]?.['failure_message']&&(_0x48bd80=_0x1a6487[_0x3def3f(0x11f)]['failure_message']);break;case _0x3def3f(0x14b):case _0x3def3f(0x140):default:_0x556276=_0x3def3f(0xe6);break;}break;}const _0x19218c={};return _0x1a6487[_0x3def3f(0x11f)]?.[_0x3def3f(0x125)]?.[_0x3def3f(0x10b)]&&(_0x19218c[_0x3def3f(0xd2)]=_0x1a6487[_0x3def3f(0x11f)]['payment_method_data'][_0x3def3f(0x10b)]),_0x1a6487['data']?.[_0x3def3f(0x125)]?.[_0x3def3f(0x111)]?.['brand']&&(_0x19218c[_0x3def3f(0x14c)]=_0x1a6487[_0x3def3f(0x11f)][_0x3def3f(0x125)][_0x3def3f(0x111)][_0x3def3f(0x138)],console[_0x3def3f(0x112)](_0x3def3f(0x10c)+_0x19218c['cardBrand'])),_0x1a6487[_0x3def3f(0x11f)]?.[_0x3def3f(0x108)]&&(_0x19218c[_0x3def3f(0xeb)]=_0x1a6487[_0x3def3f(0x11f)]['payment_method_type']),_0x1a6487[_0x3def3f(0x11f)]?.[_0x3def3f(0xff)]&&(_0x19218c[_0x3def3f(0x136)]=_0x1a6487['data'][_0x3def3f(0xff)]),_0x1a6487[_0x3def3f(0x11f)]?.[_0x3def3f(0xed)]&&(_0x19218c['failureCode']=_0x1a6487['data'][_0x3def3f(0xed)]),console['log'](_0x3def3f(0xea)+_0x556276+',\x20failureMessage='+(_0x48bd80||'none')),{'paymentId':_0x1a6487['data']?.[_0x3def3f(0x106)]||'','status':_0x556276,'amount':_0x1a6487[_0x3def3f(0x11f)]?.[_0x3def3f(0xe7)],'currency':_0x1a6487['data']?.[_0x3def3f(0x142)],'failureMessage':_0x48bd80,'additionalInfo':_0x19218c};}}exports[a67_0x423706(0x13b)]=RapydService;