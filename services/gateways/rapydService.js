'use strict';const a44_0x19ec6e=a44_0x6792;(function(_0x149607,_0x927306){const _0x113ac7=a44_0x6792,_0x5ef490=_0x149607();while(!![]){try{const _0x2a2722=parseInt(_0x113ac7(0x1e3))/0x1+parseInt(_0x113ac7(0x1e0))/0x2+parseInt(_0x113ac7(0x183))/0x3+-parseInt(_0x113ac7(0x1d4))/0x4*(-parseInt(_0x113ac7(0x1df))/0x5)+-parseInt(_0x113ac7(0x1a7))/0x6*(-parseInt(_0x113ac7(0x1cb))/0x7)+-parseInt(_0x113ac7(0x1ed))/0x8+-parseInt(_0x113ac7(0x1c2))/0x9;if(_0x2a2722===_0x927306)break;else _0x5ef490['push'](_0x5ef490['shift']());}catch(_0x489766){_0x5ef490['push'](_0x5ef490['shift']());}}}(a44_0x20db,0x1c4a6));Object[a44_0x19ec6e(0x182)](exports,a44_0x19ec6e(0x1e4),{'value':!![]}),exports[a44_0x19ec6e(0x193)]=void 0x0;function a44_0x20db(){const _0x333f58=['===\x20RAPYD\x20SUCCESS\x20===','gb_visa_card','Redirect\x20URL:','üí≥\x20Payment\x20Methods:\x20gb_visa_card,\x20gb_mastercard_card','processWebhook','Response\x20Time:',',\x20body:\x20','Failed\x20to\x20create\x20Rapyd\x20payment\x20link:\x20Unknown\x20error','error_code','HTTP\x20','5nVQYnZ','54866KQqFSl','üá¨üáß\x20Country\x20used:\x20','https://tesoft.uk/gateway/rapyd/','2771NBfXAd','__esModule','Request\x20Body\x20(Updated\x20Format):','/v1/hosted/payment_links','payment_method_type','../loggerService','CAN','https://tesoft.uk/gateway/success.php?id=','apiUrl','===\x20RAPYD\x20API\x20INCOMPLETE\x20RESPONSE\x20===','803360sNFUwA','type','last4','Rapyd\x20payment\x20verification\x20error:','headers','PAYMENT_COMPLETED','üá¨üáß\x20Country:\x20','Payment\x20Link\x20ID:','data','errorCode','===\x20RAPYD\x20API\x20ERROR\x20===','https://tesoft.uk/gateway/fail.php?id=','defineProperty','279276lXvsMG','Error\x20message:','now','stringify','Error\x20Code:','paid','===\x20RAPYD\x20API\x20BUSINESS\x20ERROR\x20===','Response\x20Body:','logWhiteDomainRequest','===\x20RAPYD\x20API\x20REQUEST\x20(White\x20Domain\x20-\x20Updated\x20Format)\x20===','üá¨üáß\x20Using\x20GB\x20(Britain)\x20as\x20country\x20for\x20Rapyd\x20payment\x20link','json','paymentMethod','Status:','PAID','redirect_url','RapydService','logWhiteDomainError','payment_method_data','JSON\x20Parse\x20Error:\x20','text','Response\x20data:','status','failure_message','PAYMENT_CANCELED','Full\x20Error\x20Data:','/v1/hosted/payment_links/','log','cardLast4','URL:','Rapyd\x20API\x20error:\x20','PENDING','TesSoft\x20Payment\x20System/1.0','Headers:','EXP','Missing\x20id\x20or\x20redirect_url\x20in\x20response','840vIuGSc','Business\x20Error\x20(','amount','CLO','Parsed\x20Result:','GET','EXPIRED','Failed\x20to\x20create\x20Rapyd\x20payment\x20link:\x20','HTTP\x20Status:','):\x20','HTTP\x20error!\x20status:\x20','UNKNOWN','toUpperCase','error','Unknown\x20error','Error\x20stack:','loggerService','Raw\x20Response\x20Body:','currency','gb_mastercard_card','NEW','ACT','ERR','PAYMENT_EXPIRED','===\x20RAPYD\x20SERVICE\x20ERROR\x20===','POST','PAYMENT_FAILED','1458684CzhTRI','===\x20PARSED\x20RAPYD\x20RESPONSE\x20===','üåê\x20Rapyd\x20service\x20initialized\x20with\x20white\x20domain\x20proxy','verifyPayment','statusText','Failed\x20to\x20parse\x20JSON\x20response:','none','SUCCESS','\x20(always\x20GB\x20for\x20Rapyd)','10129WuyvDa','message','rapyd','FAILED','stack','Invalid\x20JSON\x20response\x20from\x20Rapyd\x20API:\x20','fromEntries','failure_code','logWhiteDomainResponse','209992HlCBHT'];a44_0x20db=function(){return _0x333f58;};return a44_0x20db();}const loggerService_1=require(a44_0x19ec6e(0x1e8));function a44_0x6792(_0x299902,_0x2b2f36){const _0x20dbca=a44_0x20db();return a44_0x6792=function(_0x679250,_0x47e95f){_0x679250=_0x679250-0x17b;let _0x38328e=_0x20dbca[_0x679250];return _0x38328e;},a44_0x6792(_0x299902,_0x2b2f36);}class RapydService{constructor(){const _0x5c91a6=a44_0x19ec6e;this[_0x5c91a6(0x1eb)]=_0x5c91a6(0x1e2),console[_0x5c91a6(0x19e)](_0x5c91a6(0x1c4));}async['createPaymentLink'](_0xa52e2c){const _0x31f75c=a44_0x19ec6e,{orderId:_0x3d2517,orderName:_0x135905,amount:_0x25c26e,currency:_0x96d446,usage:_0x431a93,maxPayments:_0x4348a9,successUrl:_0x5429ab,failUrl:_0x44e9dc}=_0xa52e2c,_0x19edb9=_0x96d446[_0x31f75c(0x1b3)](),_0x32f661='GB';console['log'](_0x31f75c(0x18d));const _0x1d1b28=_0x31f75c(0x1ea)+_0x3d2517,_0x40ca7b=_0x31f75c(0x181)+_0x3d2517,_0x36d5a8={'amount':_0x25c26e,'currency':_0x19edb9,'cancel_checkout_url':_0x40ca7b,'complete_checkout_url':_0x1d1b28,'complete_payment_url':_0x1d1b28,'merchant_reference_id':_0x3d2517,'description':'ORDER:\x20'+_0x3d2517,'country':'GB','payment_method_types_include':[_0x31f75c(0x1d6),_0x31f75c(0x1ba)],'custom_elements':{'display_description':!![]}},_0x38bbbc=Date[_0x31f75c(0x185)]();try{console[_0x31f75c(0x19e)](_0x31f75c(0x18c)),console[_0x31f75c(0x19e)](_0x31f75c(0x1a0),this[_0x31f75c(0x1eb)]),console[_0x31f75c(0x19e)](_0x31f75c(0x1e5),JSON[_0x31f75c(0x186)](_0x36d5a8,null,0x2)),console['log'](_0x31f75c(0x17c)+_0x32f661+_0x31f75c(0x1ca)),console['log'](_0x31f75c(0x1d8)),loggerService_1['loggerService'][_0x31f75c(0x18b)](_0x31f75c(0x1cd),_0x31f75c(0x1e6),_0x31f75c(0x1c0),_0x36d5a8);const _0x44cec6=await fetch(this[_0x31f75c(0x1eb)],{'method':'POST','headers':{'Content-Type':'application/json','User-Agent':'TesSoft\x20Payment\x20System/1.0'},'body':JSON[_0x31f75c(0x186)](_0x36d5a8)}),_0x46c889=Date[_0x31f75c(0x185)]()-_0x38bbbc;console[_0x31f75c(0x19e)]('===\x20RAPYD\x20API\x20RESPONSE\x20(White\x20Domain)\x20==='),console[_0x31f75c(0x19e)](_0x31f75c(0x190),_0x44cec6[_0x31f75c(0x199)]),console[_0x31f75c(0x19e)]('Status\x20Text:',_0x44cec6[_0x31f75c(0x1c6)]),console[_0x31f75c(0x19e)](_0x31f75c(0x1a4),Object[_0x31f75c(0x1d1)](_0x44cec6[_0x31f75c(0x1f1)]['entries']())),console[_0x31f75c(0x19e)](_0x31f75c(0x1da),_0x46c889+'ms');const _0x37b2e7=await _0x44cec6[_0x31f75c(0x197)]();console[_0x31f75c(0x19e)](_0x31f75c(0x1b8),_0x37b2e7);if(!_0x44cec6['ok']){console[_0x31f75c(0x1b4)](_0x31f75c(0x180)),console['error'](_0x31f75c(0x1af),_0x44cec6[_0x31f75c(0x199)]),console[_0x31f75c(0x1b4)](_0x31f75c(0x18a),_0x37b2e7),loggerService_1[_0x31f75c(0x1b7)][_0x31f75c(0x1d3)]('rapyd',_0x31f75c(0x1e6),_0x44cec6[_0x31f75c(0x199)],_0x37b2e7,_0x46c889),loggerService_1['loggerService'][_0x31f75c(0x194)](_0x31f75c(0x1cd),'/v1/hosted/payment_links',_0x31f75c(0x1de)+_0x44cec6[_0x31f75c(0x199)]+':\x20'+_0x37b2e7);throw new Error('HTTP\x20error!\x20status:\x20'+_0x44cec6[_0x31f75c(0x199)]+_0x31f75c(0x1db)+_0x37b2e7);}let _0x168dbc;try{_0x168dbc=JSON['parse'](_0x37b2e7);}catch(_0x3a242e){console[_0x31f75c(0x1b4)](_0x31f75c(0x1c7),_0x3a242e),loggerService_1[_0x31f75c(0x1b7)][_0x31f75c(0x194)](_0x31f75c(0x1cd),'/v1/hosted/payment_links',_0x31f75c(0x196)+_0x3a242e);throw new Error(_0x31f75c(0x1d0)+_0x37b2e7);}console[_0x31f75c(0x19e)](_0x31f75c(0x1c3)),console[_0x31f75c(0x19e)](_0x31f75c(0x1ab),JSON['stringify'](_0x168dbc,null,0x2)),loggerService_1[_0x31f75c(0x1b7)][_0x31f75c(0x1d3)](_0x31f75c(0x1cd),_0x31f75c(0x1e6),_0x44cec6['status'],_0x168dbc,_0x46c889);if(_0x168dbc[_0x31f75c(0x199)]?.['status']!==_0x31f75c(0x1c9)){const _0x1203d1=_0x168dbc[_0x31f75c(0x199)]?.[_0x31f75c(0x1cc)]||'Unknown\x20error\x20from\x20Rapyd\x20API',_0x4fa126=_0x168dbc[_0x31f75c(0x199)]?.[_0x31f75c(0x1dd)]||_0x31f75c(0x1b2);console[_0x31f75c(0x1b4)](_0x31f75c(0x189)),console[_0x31f75c(0x1b4)](_0x31f75c(0x187),_0x4fa126),console[_0x31f75c(0x1b4)]('Error\x20Message:',_0x1203d1),console[_0x31f75c(0x1b4)](_0x31f75c(0x19c),_0x168dbc['status']),loggerService_1['loggerService'][_0x31f75c(0x194)](_0x31f75c(0x1cd),_0x31f75c(0x1e6),_0x31f75c(0x1a8)+_0x4fa126+'):\x20'+_0x1203d1);throw new Error('Rapyd\x20API\x20error\x20('+_0x4fa126+_0x31f75c(0x1b0)+_0x1203d1);}if(!_0x168dbc[_0x31f75c(0x17e)]?.['id']||!_0x168dbc[_0x31f75c(0x17e)]?.[_0x31f75c(0x192)]){console[_0x31f75c(0x1b4)](_0x31f75c(0x1ec)),console[_0x31f75c(0x1b4)](_0x31f75c(0x1a6)),console[_0x31f75c(0x1b4)](_0x31f75c(0x198),_0x168dbc[_0x31f75c(0x17e)]),loggerService_1[_0x31f75c(0x1b7)][_0x31f75c(0x194)]('rapyd',_0x31f75c(0x1e6),'Incomplete\x20response:\x20missing\x20id\x20or\x20redirect_url');throw new Error('Invalid\x20response\x20from\x20Rapyd\x20API:\x20missing\x20id\x20or\x20redirect_url');}return console[_0x31f75c(0x19e)](_0x31f75c(0x1d5)),console['log'](_0x31f75c(0x17d),_0x168dbc[_0x31f75c(0x17e)]['id']),console[_0x31f75c(0x19e)](_0x31f75c(0x1d7),_0x168dbc[_0x31f75c(0x17e)][_0x31f75c(0x192)]),console['log'](_0x31f75c(0x1e1)+_0x32f661+'\x20(GB\x20-\x20Britain)'),console[_0x31f75c(0x19e)](_0x31f75c(0x1d8)),{'gateway_payment_id':_0x168dbc[_0x31f75c(0x17e)]['id'],'payment_url':_0x168dbc['data']['redirect_url']};}catch(_0x3cf951){console[_0x31f75c(0x1b4)](_0x31f75c(0x1bf)),console[_0x31f75c(0x1b4)]('Error\x20details:',_0x3cf951),loggerService_1[_0x31f75c(0x1b7)][_0x31f75c(0x194)](_0x31f75c(0x1cd),_0x31f75c(0x1e6),_0x3cf951);if(_0x3cf951 instanceof Error){console[_0x31f75c(0x1b4)](_0x31f75c(0x184),_0x3cf951[_0x31f75c(0x1cc)]),console[_0x31f75c(0x1b4)](_0x31f75c(0x1b6),_0x3cf951[_0x31f75c(0x1cf)]);throw new Error(_0x31f75c(0x1ae)+_0x3cf951[_0x31f75c(0x1cc)]);}throw new Error(_0x31f75c(0x1dc));}}async[a44_0x19ec6e(0x1c5)](_0x13e8a2){const _0x500f07=a44_0x19ec6e,_0x2285bf=Date[_0x500f07(0x185)]();try{loggerService_1[_0x500f07(0x1b7)][_0x500f07(0x18b)]('rapyd','/v1/hosted/payment_links/'+_0x13e8a2,_0x500f07(0x1ac),{});const _0x2ff920=await fetch(this[_0x500f07(0x1eb)]+'/'+_0x13e8a2,{'method':'GET','headers':{'Content-Type':'application/json','User-Agent':_0x500f07(0x1a3)}}),_0x8c8c04=Date[_0x500f07(0x185)]()-_0x2285bf;if(!_0x2ff920['ok']){const _0x3b88f4=await _0x2ff920[_0x500f07(0x197)]();loggerService_1[_0x500f07(0x1b7)][_0x500f07(0x1d3)](_0x500f07(0x1cd),_0x500f07(0x19d)+_0x13e8a2,_0x2ff920[_0x500f07(0x199)],_0x3b88f4,_0x8c8c04);throw new Error(_0x500f07(0x1b1)+_0x2ff920['status']);}const _0x14c548=await _0x2ff920[_0x500f07(0x18e)]();loggerService_1['loggerService'][_0x500f07(0x1d3)](_0x500f07(0x1cd),_0x500f07(0x19d)+_0x13e8a2,_0x2ff920['status'],_0x14c548,_0x8c8c04);if(_0x14c548[_0x500f07(0x199)]?.['status']!==_0x500f07(0x1c9)){loggerService_1[_0x500f07(0x1b7)][_0x500f07(0x194)](_0x500f07(0x1cd),_0x500f07(0x19d)+_0x13e8a2,_0x500f07(0x1a1)+(_0x14c548['status']?.[_0x500f07(0x1cc)]||'Unknown\x20error'));throw new Error('Rapyd\x20API\x20error:\x20'+(_0x14c548[_0x500f07(0x199)]?.[_0x500f07(0x1cc)]||_0x500f07(0x1b5)));}let _0x22ddc2=_0x500f07(0x1a2);if(_0x14c548[_0x500f07(0x17e)]?.[_0x500f07(0x199)])switch(_0x14c548[_0x500f07(0x17e)][_0x500f07(0x199)]['toUpperCase']()){case _0x500f07(0x1aa):_0x22ddc2=_0x500f07(0x191);break;case _0x500f07(0x1e9):_0x22ddc2='FAILED';break;case _0x500f07(0x1a5):_0x22ddc2=_0x500f07(0x1ad);break;case _0x500f07(0x1bd):_0x22ddc2=_0x500f07(0x1ce);break;case _0x500f07(0x1bb):case _0x500f07(0x1bc):default:_0x22ddc2='PENDING';break;}return{'status':_0x22ddc2,'amount':_0x14c548[_0x500f07(0x17e)]?.[_0x500f07(0x1a9)],'currency':_0x14c548['data']?.['currency']};}catch(_0x1bbbe3){console['error'](_0x500f07(0x1f0),_0x1bbbe3),loggerService_1[_0x500f07(0x1b7)][_0x500f07(0x194)](_0x500f07(0x1cd),'/v1/hosted/payment_links/'+_0x13e8a2,_0x1bbbe3);throw new Error('Failed\x20to\x20verify\x20Rapyd\x20payment:\x20'+(_0x1bbbe3 instanceof Error?_0x1bbbe3[_0x500f07(0x1cc)]:'Unknown\x20error'));}}async[a44_0x19ec6e(0x1d9)](_0x9ae761){const _0x2c1345=a44_0x19ec6e;console['log']('Processing\x20Rapyd\x20webhook:',_0x9ae761);let _0x55b61b=_0x2c1345(0x1a2),_0x599aae;_0x9ae761[_0x2c1345(0x17e)]?.[_0x2c1345(0x19a)]&&(_0x599aae=_0x9ae761['data'][_0x2c1345(0x19a)],console[_0x2c1345(0x19e)]('üí•\x20Rapyd\x20failure\x20message:\x20'+_0x599aae));switch(_0x9ae761[_0x2c1345(0x1ee)]?.[_0x2c1345(0x1b3)]()){case _0x2c1345(0x17b):_0x9ae761[_0x2c1345(0x17e)]?.[_0x2c1345(0x188)]===!![]&&_0x9ae761[_0x2c1345(0x17e)]?.[_0x2c1345(0x199)]===_0x2c1345(0x1aa)?_0x55b61b=_0x2c1345(0x191):_0x55b61b='PENDING';break;case _0x2c1345(0x19b):_0x55b61b=_0x2c1345(0x1ce);break;case _0x2c1345(0x1be):_0x55b61b='EXPIRED';break;case _0x2c1345(0x1c1):_0x55b61b=_0x2c1345(0x1ce);!_0x599aae&&_0x9ae761[_0x2c1345(0x17e)]?.['failure_message']&&(_0x599aae=_0x9ae761[_0x2c1345(0x17e)][_0x2c1345(0x19a)]);break;default:switch(_0x9ae761['data']?.[_0x2c1345(0x199)]?.[_0x2c1345(0x1b3)]()){case'CLO':_0x9ae761[_0x2c1345(0x17e)]?.['paid']===!![]?_0x55b61b='PAID':_0x55b61b=_0x2c1345(0x1ce);break;case _0x2c1345(0x1e9):_0x55b61b=_0x2c1345(0x1ce);break;case _0x2c1345(0x1a5):_0x55b61b=_0x2c1345(0x1ad);break;case _0x2c1345(0x1bd):_0x55b61b=_0x2c1345(0x1ce);!_0x599aae&&_0x9ae761[_0x2c1345(0x17e)]?.[_0x2c1345(0x19a)]&&(_0x599aae=_0x9ae761[_0x2c1345(0x17e)][_0x2c1345(0x19a)]);break;case'NEW':case'ACT':default:_0x55b61b=_0x2c1345(0x1a2);break;}break;}const _0x396cbe={};return _0x9ae761['data']?.['payment_method_data']?.['last4']&&(_0x396cbe[_0x2c1345(0x19f)]=_0x9ae761[_0x2c1345(0x17e)][_0x2c1345(0x195)][_0x2c1345(0x1ef)]),_0x9ae761['data']?.[_0x2c1345(0x1e7)]&&(_0x396cbe[_0x2c1345(0x18f)]=_0x9ae761[_0x2c1345(0x17e)][_0x2c1345(0x1e7)]),_0x9ae761[_0x2c1345(0x17e)]?.[_0x2c1345(0x1dd)]&&(_0x396cbe[_0x2c1345(0x17f)]=_0x9ae761[_0x2c1345(0x17e)][_0x2c1345(0x1dd)]),_0x9ae761['data']?.[_0x2c1345(0x1d2)]&&(_0x396cbe['failureCode']=_0x9ae761[_0x2c1345(0x17e)][_0x2c1345(0x1d2)]),console[_0x2c1345(0x19e)]('üîÑ\x20Rapyd\x20webhook\x20processed:\x20status='+_0x55b61b+',\x20failureMessage='+(_0x599aae||_0x2c1345(0x1c8))),{'paymentId':_0x9ae761[_0x2c1345(0x17e)]?.['merchant_reference_id']||'','status':_0x55b61b,'amount':_0x9ae761[_0x2c1345(0x17e)]?.[_0x2c1345(0x1a9)],'currency':_0x9ae761[_0x2c1345(0x17e)]?.[_0x2c1345(0x1b9)],'failureMessage':_0x599aae,'additionalInfo':_0x396cbe};}}exports[a44_0x19ec6e(0x193)]=RapydService;