'use strict';const a42_0x39936b=a42_0x4288;(function(_0x4a6347,_0x57751d){const _0x307360=a42_0x4288,_0x46235a=_0x4a6347();while(!![]){try{const _0x53826a=-parseInt(_0x307360(0x1f8))/0x1*(parseInt(_0x307360(0x237))/0x2)+parseInt(_0x307360(0x242))/0x3+-parseInt(_0x307360(0x245))/0x4+-parseInt(_0x307360(0x1f7))/0x5*(-parseInt(_0x307360(0x233))/0x6)+-parseInt(_0x307360(0x23f))/0x7+-parseInt(_0x307360(0x218))/0x8+-parseInt(_0x307360(0x211))/0x9*(-parseInt(_0x307360(0x1f5))/0xa);if(_0x53826a===_0x57751d)break;else _0x46235a['push'](_0x46235a['shift']());}catch(_0x25cc2b){_0x46235a['push'](_0x46235a['shift']());}}}(a42_0x4fc8,0x8dfe1));function a42_0x4288(_0x1a41bc,_0x4dfff0){const _0x4fc82f=a42_0x4fc8();return a42_0x4288=function(_0x428889,_0x1e7ba5){_0x428889=_0x428889-0x1e1;let _0x12c6bd=_0x4fc82f[_0x428889];return _0x12c6bd;},a42_0x4288(_0x1a41bc,_0x4dfff0);}Object[a42_0x39936b(0x1e7)](exports,'__esModule',{'value':!![]}),exports[a42_0x39936b(0x23d)]=void 0x0;const loggerService_1=require(a42_0x39936b(0x21b));class RapydService{constructor(){const _0x6b52f5=a42_0x39936b;this[_0x6b52f5(0x226)]=_0x6b52f5(0x230),console[_0x6b52f5(0x236)](_0x6b52f5(0x22f));}async[a42_0x39936b(0x20f)](_0x2ef5e3){const _0x47c3d2=a42_0x39936b,{orderId:_0x10e9ad,orderName:_0x1df8e6,amount:_0x512c72,currency:_0x38ac1c,usage:_0x386530,maxPayments:_0x15ebb5,successUrl:_0x21036b,failUrl:_0x446e01}=_0x2ef5e3,_0xda3ad6=_0x38ac1c[_0x47c3d2(0x20a)](),_0x15c0ca='GB';console[_0x47c3d2(0x236)](_0x47c3d2(0x1fd));const _0x59ced4=_0x47c3d2(0x1e8)+_0x10e9ad,_0x1899df=_0x47c3d2(0x23b)+_0x10e9ad,_0x275186={'amount':_0x512c72,'currency':_0xda3ad6,'cancel_checkout_url':_0x1899df,'complete_checkout_url':_0x59ced4,'complete_payment_url':_0x59ced4,'merchant_reference_id':_0x10e9ad,'description':_0x47c3d2(0x22d)+_0x10e9ad,'country':'GB','payment_method_types_include':[_0x47c3d2(0x1fc),_0x47c3d2(0x210)],'custom_elements':{'display_description':!![]}},_0x2c59b4=Date[_0x47c3d2(0x225)]();try{console['log'](_0x47c3d2(0x209)),console[_0x47c3d2(0x236)](_0x47c3d2(0x21c),this[_0x47c3d2(0x226)]),console[_0x47c3d2(0x236)]('Request\x20Body\x20(Updated\x20Format):',JSON[_0x47c3d2(0x229)](_0x275186,null,0x2)),console[_0x47c3d2(0x236)](_0x47c3d2(0x23e)+_0x15c0ca+_0x47c3d2(0x1ef)),console['log'](_0x47c3d2(0x22b)),loggerService_1['loggerService'][_0x47c3d2(0x222)](_0x47c3d2(0x1f4),_0x47c3d2(0x243),_0x47c3d2(0x217),_0x275186);const _0x369d2c=await fetch(this[_0x47c3d2(0x226)],{'method':_0x47c3d2(0x217),'headers':{'Content-Type':_0x47c3d2(0x235),'User-Agent':'TesSoft\x20Payment\x20System/1.0'},'body':JSON[_0x47c3d2(0x229)](_0x275186)}),_0x20ab92=Date['now']()-_0x2c59b4;console[_0x47c3d2(0x236)]('===\x20RAPYD\x20API\x20RESPONSE\x20(White\x20Domain)\x20==='),console[_0x47c3d2(0x236)]('Status:',_0x369d2c[_0x47c3d2(0x202)]),console['log'](_0x47c3d2(0x1f3),_0x369d2c[_0x47c3d2(0x206)]),console[_0x47c3d2(0x236)](_0x47c3d2(0x246),Object[_0x47c3d2(0x232)](_0x369d2c['headers']['entries']())),console[_0x47c3d2(0x236)]('Response\x20Time:',_0x20ab92+'ms');const _0x257d93=await _0x369d2c[_0x47c3d2(0x1ec)]();console[_0x47c3d2(0x236)](_0x47c3d2(0x1e9),_0x257d93);if(!_0x369d2c['ok']){console[_0x47c3d2(0x223)](_0x47c3d2(0x1f0)),console[_0x47c3d2(0x223)](_0x47c3d2(0x219),_0x369d2c[_0x47c3d2(0x202)]),console[_0x47c3d2(0x223)](_0x47c3d2(0x213),_0x257d93),loggerService_1[_0x47c3d2(0x1ff)][_0x47c3d2(0x21a)]('rapyd',_0x47c3d2(0x243),_0x369d2c[_0x47c3d2(0x202)],_0x257d93,_0x20ab92),loggerService_1[_0x47c3d2(0x1ff)][_0x47c3d2(0x22e)](_0x47c3d2(0x1f4),'/v1/hosted/payment_links','HTTP\x20'+_0x369d2c[_0x47c3d2(0x202)]+':\x20'+_0x257d93);throw new Error(_0x47c3d2(0x239)+_0x369d2c[_0x47c3d2(0x202)]+_0x47c3d2(0x238)+_0x257d93);}let _0x105e07;try{_0x105e07=JSON[_0x47c3d2(0x23c)](_0x257d93);}catch(_0x37a248){console[_0x47c3d2(0x223)](_0x47c3d2(0x244),_0x37a248),loggerService_1[_0x47c3d2(0x1ff)][_0x47c3d2(0x22e)]('rapyd',_0x47c3d2(0x243),_0x47c3d2(0x208)+_0x37a248);throw new Error('Invalid\x20JSON\x20response\x20from\x20Rapyd\x20API:\x20'+_0x257d93);}console[_0x47c3d2(0x236)]('===\x20PARSED\x20RAPYD\x20RESPONSE\x20==='),console['log'](_0x47c3d2(0x21d),JSON[_0x47c3d2(0x229)](_0x105e07,null,0x2)),loggerService_1['loggerService']['logWhiteDomainResponse'](_0x47c3d2(0x1f4),_0x47c3d2(0x243),_0x369d2c[_0x47c3d2(0x202)],_0x105e07,_0x20ab92);if(_0x105e07[_0x47c3d2(0x202)]?.['status']!==_0x47c3d2(0x205)){const _0x1882da=_0x105e07[_0x47c3d2(0x202)]?.[_0x47c3d2(0x228)]||_0x47c3d2(0x215),_0x15e759=_0x105e07[_0x47c3d2(0x202)]?.[_0x47c3d2(0x240)]||_0x47c3d2(0x1e3);console[_0x47c3d2(0x223)](_0x47c3d2(0x231)),console['error'](_0x47c3d2(0x1ed),_0x15e759),console[_0x47c3d2(0x223)](_0x47c3d2(0x248),_0x1882da),console['error'](_0x47c3d2(0x247),_0x105e07[_0x47c3d2(0x202)]),loggerService_1['loggerService']['logWhiteDomainError'](_0x47c3d2(0x1f4),'/v1/hosted/payment_links',_0x47c3d2(0x1ee)+_0x15e759+'):\x20'+_0x1882da);throw new Error(_0x47c3d2(0x21f)+_0x15e759+_0x47c3d2(0x224)+_0x1882da);}if(!_0x105e07['data']?.['id']||!_0x105e07[_0x47c3d2(0x1f1)]?.[_0x47c3d2(0x1e5)]){console[_0x47c3d2(0x223)](_0x47c3d2(0x20e)),console['error'](_0x47c3d2(0x200)),console['error'](_0x47c3d2(0x207),_0x105e07[_0x47c3d2(0x1f1)]),loggerService_1[_0x47c3d2(0x1ff)][_0x47c3d2(0x22e)](_0x47c3d2(0x1f4),_0x47c3d2(0x243),'Incomplete\x20response:\x20missing\x20id\x20or\x20redirect_url');throw new Error('Invalid\x20response\x20from\x20Rapyd\x20API:\x20missing\x20id\x20or\x20redirect_url');}return console[_0x47c3d2(0x236)]('===\x20RAPYD\x20SUCCESS\x20==='),console[_0x47c3d2(0x236)](_0x47c3d2(0x1fa),_0x105e07[_0x47c3d2(0x1f1)]['id']),console['log'](_0x47c3d2(0x214),_0x105e07[_0x47c3d2(0x1f1)][_0x47c3d2(0x1e5)]),console[_0x47c3d2(0x236)]('üá¨üáß\x20Country\x20used:\x20'+_0x15c0ca+_0x47c3d2(0x23a)),console[_0x47c3d2(0x236)](_0x47c3d2(0x22b)),{'gateway_payment_id':_0x105e07[_0x47c3d2(0x1f1)]['id'],'payment_url':_0x105e07[_0x47c3d2(0x1f1)][_0x47c3d2(0x1e5)]};}catch(_0xcf2f93){console[_0x47c3d2(0x223)](_0x47c3d2(0x21e)),console[_0x47c3d2(0x223)]('Error\x20details:',_0xcf2f93),loggerService_1[_0x47c3d2(0x1ff)][_0x47c3d2(0x22e)](_0x47c3d2(0x1f4),_0x47c3d2(0x243),_0xcf2f93);if(_0xcf2f93 instanceof Error){console[_0x47c3d2(0x223)](_0x47c3d2(0x1f2),_0xcf2f93['message']),console[_0x47c3d2(0x223)]('Error\x20stack:',_0xcf2f93[_0x47c3d2(0x20c)]);throw new Error('Failed\x20to\x20create\x20Rapyd\x20payment\x20link:\x20'+_0xcf2f93[_0x47c3d2(0x228)]);}throw new Error('Failed\x20to\x20create\x20Rapyd\x20payment\x20link:\x20Unknown\x20error');}}async[a42_0x39936b(0x22a)](_0x28a7af){const _0x4127e2=a42_0x39936b,_0x347b01=Date[_0x4127e2(0x225)]();try{loggerService_1['loggerService'][_0x4127e2(0x222)](_0x4127e2(0x1f4),_0x4127e2(0x1fe)+_0x28a7af,'GET',{});const _0x3198fb=await fetch(this[_0x4127e2(0x226)]+'/'+_0x28a7af,{'method':_0x4127e2(0x204),'headers':{'Content-Type':'application/json','User-Agent':'TesSoft\x20Payment\x20System/1.0'}}),_0xccc195=Date[_0x4127e2(0x225)]()-_0x347b01;if(!_0x3198fb['ok']){const _0x58dada=await _0x3198fb[_0x4127e2(0x1ec)]();loggerService_1[_0x4127e2(0x1ff)][_0x4127e2(0x21a)]('rapyd',_0x4127e2(0x1fe)+_0x28a7af,_0x3198fb[_0x4127e2(0x202)],_0x58dada,_0xccc195);throw new Error(_0x4127e2(0x239)+_0x3198fb['status']);}const _0x248183=await _0x3198fb['json']();loggerService_1['loggerService'][_0x4127e2(0x21a)](_0x4127e2(0x1f4),'/v1/hosted/payment_links/'+_0x28a7af,_0x3198fb[_0x4127e2(0x202)],_0x248183,_0xccc195);if(_0x248183[_0x4127e2(0x202)]?.[_0x4127e2(0x202)]!==_0x4127e2(0x205)){loggerService_1[_0x4127e2(0x1ff)][_0x4127e2(0x22e)]('rapyd','/v1/hosted/payment_links/'+_0x28a7af,'Rapyd\x20API\x20error:\x20'+(_0x248183[_0x4127e2(0x202)]?.[_0x4127e2(0x228)]||_0x4127e2(0x20b)));throw new Error(_0x4127e2(0x201)+(_0x248183[_0x4127e2(0x202)]?.[_0x4127e2(0x228)]||_0x4127e2(0x20b)));}let _0x405a3d=_0x4127e2(0x212);if(_0x248183[_0x4127e2(0x1f1)]?.[_0x4127e2(0x202)])switch(_0x248183[_0x4127e2(0x1f1)]['status'][_0x4127e2(0x20a)]()){case _0x4127e2(0x20d):_0x405a3d=_0x4127e2(0x234);break;case'CAN':_0x405a3d=_0x4127e2(0x249);break;case _0x4127e2(0x241):_0x405a3d=_0x4127e2(0x1f9);break;case _0x4127e2(0x221):_0x405a3d=_0x4127e2(0x249);break;case'NEW':case'ACT':default:_0x405a3d=_0x4127e2(0x212);break;}return{'status':_0x405a3d,'amount':_0x248183[_0x4127e2(0x1f1)]?.[_0x4127e2(0x1e6)],'currency':_0x248183['data']?.['currency']};}catch(_0x32e0fd){console[_0x4127e2(0x223)](_0x4127e2(0x1e1),_0x32e0fd),loggerService_1['loggerService'][_0x4127e2(0x22e)](_0x4127e2(0x1f4),_0x4127e2(0x1fe)+_0x28a7af,_0x32e0fd);throw new Error(_0x4127e2(0x220)+(_0x32e0fd instanceof Error?_0x32e0fd[_0x4127e2(0x228)]:_0x4127e2(0x20b)));}}async[a42_0x39936b(0x1e4)](_0x163b4e){const _0x411650=a42_0x39936b;console[_0x411650(0x236)]('Processing\x20Rapyd\x20webhook:',_0x163b4e);let _0x9b7665=_0x411650(0x212);switch(_0x163b4e[_0x411650(0x22c)]?.[_0x411650(0x20a)]()){case _0x411650(0x203):_0x163b4e['data']?.[_0x411650(0x216)]===!![]&&_0x163b4e['data']?.['status']===_0x411650(0x20d)?_0x9b7665=_0x411650(0x234):_0x9b7665=_0x411650(0x212);break;case _0x411650(0x1e2):_0x9b7665=_0x411650(0x249);break;case'PAYMENT_EXPIRED':_0x9b7665=_0x411650(0x1f9);break;case _0x411650(0x1fb):_0x9b7665='FAILED';break;default:switch(_0x163b4e[_0x411650(0x1f1)]?.[_0x411650(0x202)]?.[_0x411650(0x20a)]()){case'CLO':_0x163b4e[_0x411650(0x1f1)]?.[_0x411650(0x216)]===!![]?_0x9b7665=_0x411650(0x234):_0x9b7665=_0x411650(0x249);break;case _0x411650(0x227):_0x9b7665=_0x411650(0x249);break;case _0x411650(0x241):_0x9b7665=_0x411650(0x1f9);break;case _0x411650(0x221):_0x9b7665=_0x411650(0x249);break;case _0x411650(0x1f6):case _0x411650(0x1ea):default:_0x9b7665=_0x411650(0x212);break;}break;}return{'paymentId':_0x163b4e[_0x411650(0x1f1)]?.[_0x411650(0x1eb)]||'','status':_0x9b7665,'amount':_0x163b4e[_0x411650(0x1f1)]?.['amount'],'currency':_0x163b4e[_0x411650(0x1f1)]?.['currency']};}}exports[a42_0x39936b(0x23d)]=RapydService;function a42_0x4fc8(){const _0x401715=['PAYMENT_FAILED','gb_visa_card','üá¨üáß\x20Using\x20GB\x20(Britain)\x20as\x20country\x20for\x20Rapyd\x20payment\x20link','/v1/hosted/payment_links/','loggerService','Missing\x20id\x20or\x20redirect_url\x20in\x20response','Rapyd\x20API\x20error:\x20','status','PAYMENT_COMPLETED','GET','SUCCESS','statusText','Response\x20data:','JSON\x20Parse\x20Error:\x20','===\x20RAPYD\x20API\x20REQUEST\x20(White\x20Domain\x20-\x20Updated\x20Format)\x20===','toUpperCase','Unknown\x20error','stack','CLO','===\x20RAPYD\x20API\x20INCOMPLETE\x20RESPONSE\x20===','createPaymentLink','gb_mastercard_card','39159oeomtu','PENDING','Response\x20Body:','Redirect\x20URL:','Unknown\x20error\x20from\x20Rapyd\x20API','paid','POST','419936mmbFoB','HTTP\x20Status:','logWhiteDomainResponse','../loggerService','URL:','Parsed\x20Result:','===\x20RAPYD\x20SERVICE\x20ERROR\x20===','Rapyd\x20API\x20error\x20(','Failed\x20to\x20verify\x20Rapyd\x20payment:\x20','ERR','logWhiteDomainRequest','error','):\x20','now','apiUrl','CAN','message','stringify','verifyPayment','üí≥\x20Payment\x20Methods:\x20gb_visa_card,\x20gb_mastercard_card','type','ORDER:\x20','logWhiteDomainError','üåê\x20Rapyd\x20service\x20initialized\x20with\x20white\x20domain\x20proxy','https://tesoft.uk/gateway/rapyd/','===\x20RAPYD\x20API\x20BUSINESS\x20ERROR\x20===','fromEntries','3465672DSspLk','PAID','application/json','log','76CGCfWE',',\x20body:\x20','HTTP\x20error!\x20status:\x20','\x20(GB\x20-\x20Britain)','https://tesoft.uk/gateway/fail.php?id=','parse','RapydService','üá¨üáß\x20Country:\x20','6036436ccsFfi','error_code','EXP','608112zGaUCh','/v1/hosted/payment_links','Failed\x20to\x20parse\x20JSON\x20response:','864032QrFuUm','Headers:','Full\x20Error\x20Data:','Error\x20Message:','FAILED','Rapyd\x20payment\x20verification\x20error:','PAYMENT_CANCELED','UNKNOWN','processWebhook','redirect_url','amount','defineProperty','https://tesoft.uk/gateway/success.php?id=','Raw\x20Response\x20Body:','ACT','merchant_reference_id','text','Error\x20Code:','Business\x20Error\x20(','\x20(always\x20GB\x20for\x20Rapyd)','===\x20RAPYD\x20API\x20ERROR\x20===','data','Error\x20message:','Status\x20Text:','rapyd','2970hDuCEK','NEW','10sgYJil','24677BfTDHE','EXPIRED','Payment\x20Link\x20ID:'];a42_0x4fc8=function(){return _0x401715;};return a42_0x4fc8();}