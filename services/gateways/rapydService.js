'use strict';function a63_0x37f2(_0x246fb2,_0x4e2d2e){_0x246fb2=_0x246fb2-0x132;const _0x30a6a8=a63_0x30a6();let _0x37f2fc=_0x30a6a8[_0x246fb2];return _0x37f2fc;}const a63_0x29ce81=a63_0x37f2;(function(_0x2b4e90,_0xea3898){const _0x54a8a6=a63_0x37f2,_0x46276d=_0x2b4e90();while(!![]){try{const _0x293c99=parseInt(_0x54a8a6(0x184))/0x1*(-parseInt(_0x54a8a6(0x1b9))/0x2)+-parseInt(_0x54a8a6(0x171))/0x3+parseInt(_0x54a8a6(0x134))/0x4+-parseInt(_0x54a8a6(0x17f))/0x5+parseInt(_0x54a8a6(0x13b))/0x6*(parseInt(_0x54a8a6(0x19a))/0x7)+-parseInt(_0x54a8a6(0x156))/0x8*(parseInt(_0x54a8a6(0x1b2))/0x9)+parseInt(_0x54a8a6(0x165))/0xa;if(_0x293c99===_0xea3898)break;else _0x46276d['push'](_0x46276d['shift']());}catch(_0x325449){_0x46276d['push'](_0x46276d['shift']());}}}(a63_0x30a6,0xabcbc));Object[a63_0x29ce81(0x152)](exports,a63_0x29ce81(0x1ac),{'value':!![]}),exports['RapydService']=void 0x0;const loggerService_1=require(a63_0x29ce81(0x168));class RapydService{constructor(){const _0x15502f=a63_0x29ce81;this['apiUrl']=_0x15502f(0x192),console[_0x15502f(0x161)](_0x15502f(0x154));}async[a63_0x29ce81(0x166)](_0x336b07){const _0x1c3329=a63_0x29ce81,{orderId:_0x1307ea,orderName:_0x588c96,amount:_0x574aeb,currency:_0x369674,usage:_0x45eae5,maxPayments:_0x46dce9,successUrl:_0x1bb529,failUrl:_0x4edc5d,customerName:_0x270f68,customerEmail:_0x276151}=_0x336b07,_0x5c24e2=_0x369674[_0x1c3329(0x191)](),_0x287492='GB';console[_0x1c3329(0x161)](_0x1c3329(0x1a1));const _0x352dfc=_0x1c3329(0x16b)+_0x1307ea,_0x20fd71=_0x1c3329(0x143)+_0x1307ea,_0x226c7e={'amount':_0x574aeb,'currency':_0x5c24e2,'payment_method_options':{'3d_required':![]},'cancel_checkout_url':_0x20fd71,'complete_checkout_url':_0x352dfc,'complete_payment_url':_0x352dfc,'merchant_reference_id':_0x1307ea,'description':_0x1c3329(0x164)+_0x1307ea,'statement_descriptor':_0x1c3329(0x183)+(_0x1307ea['split']('-')[0x1]||_0x1307ea),'country':'GB','payment_method_types_include':[_0x1c3329(0x195),_0x1c3329(0x187)],'custom_elements':{'display_description':!![],'billing_address_collect':!![],'required_customer_fields':[_0x1c3329(0x19b),_0x1c3329(0x13c),_0x1c3329(0x178),'address']}};_0x270f68&&(_0x226c7e[_0x1c3329(0x1a0)][_0x1c3329(0x141)]=_0x270f68,console['log'](_0x1c3329(0x15f)+_0x270f68));if(_0x5c24e2!==_0x1c3329(0x16f)){const _0x9591e7=Math[_0x1c3329(0x162)](Date[_0x1c3329(0x137)]()/0x3e8)+0x1e*0x3c;_0x226c7e[_0x1c3329(0x17b)]='buy',_0x226c7e[_0x1c3329(0x160)]=_0x1c3329(0x16f),_0x226c7e[_0x1c3329(0x193)]=_0x9591e7,console[_0x1c3329(0x161)](_0x1c3329(0x189)+_0x5c24e2+_0x1c3329(0x1ab)),console[_0x1c3329(0x161)]('\x20\x20\x20fixed_side:\x20buy'),console['log'](_0x1c3329(0x169)),console[_0x1c3329(0x161)](_0x1c3329(0x15b)+_0x9591e7+'\x20('+new Date(_0x9591e7*0x3e8)[_0x1c3329(0x157)]()+')');}const _0x2c67bf=Date[_0x1c3329(0x137)]();try{console[_0x1c3329(0x161)]('===\x20RAPYD\x20API\x20REQUEST\x20(White\x20Domain\x20-\x20Updated\x20Format)\x20==='),console['log'](_0x1c3329(0x180),this[_0x1c3329(0x158)]),console[_0x1c3329(0x161)]('Request\x20Body\x20(Updated\x20Format):',JSON[_0x1c3329(0x1ae)](_0x226c7e,null,0x2)),console[_0x1c3329(0x161)](_0x1c3329(0x1a2)+_0x287492+_0x1c3329(0x198)),console[_0x1c3329(0x161)]('ðŸ’³\x20Payment\x20Methods:\x20gb_visa_card,\x20gb_mastercard_card'),loggerService_1[_0x1c3329(0x1aa)][_0x1c3329(0x194)](_0x1c3329(0x1a9),_0x1c3329(0x1be),_0x1c3329(0x170),_0x226c7e);const _0x47cd43=await fetch(this[_0x1c3329(0x158)],{'method':_0x1c3329(0x170),'headers':{'Content-Type':_0x1c3329(0x147),'User-Agent':'Payment\x20System/1.0'},'body':JSON[_0x1c3329(0x1ae)](_0x226c7e)}),_0x41c14a=Date[_0x1c3329(0x137)]()-_0x2c67bf;console[_0x1c3329(0x161)](_0x1c3329(0x155)),console[_0x1c3329(0x161)](_0x1c3329(0x17c),_0x47cd43[_0x1c3329(0x172)]),console[_0x1c3329(0x161)](_0x1c3329(0x1ad),_0x47cd43[_0x1c3329(0x163)]),console[_0x1c3329(0x161)]('Headers:',Object[_0x1c3329(0x135)](_0x47cd43[_0x1c3329(0x15c)][_0x1c3329(0x197)]())),console[_0x1c3329(0x161)](_0x1c3329(0x186),_0x41c14a+'ms');const _0x34bc4b=await _0x47cd43[_0x1c3329(0x13f)]();console[_0x1c3329(0x161)](_0x1c3329(0x146),_0x34bc4b);if(!_0x47cd43['ok']){console[_0x1c3329(0x132)](_0x1c3329(0x167)),console[_0x1c3329(0x132)](_0x1c3329(0x176),_0x47cd43[_0x1c3329(0x172)]),console[_0x1c3329(0x132)]('Response\x20Body:',_0x34bc4b),loggerService_1['loggerService']['logWhiteDomainResponse'](_0x1c3329(0x1a9),_0x1c3329(0x1be),_0x47cd43[_0x1c3329(0x172)],_0x34bc4b,_0x41c14a),loggerService_1[_0x1c3329(0x1aa)][_0x1c3329(0x190)](_0x1c3329(0x1a9),_0x1c3329(0x1be),_0x1c3329(0x16e)+_0x47cd43[_0x1c3329(0x172)]+':\x20'+_0x34bc4b);throw new Error(_0x1c3329(0x1bc)+_0x47cd43[_0x1c3329(0x172)]+_0x1c3329(0x14b)+_0x34bc4b);}let _0x16608e;try{_0x16608e=JSON[_0x1c3329(0x19d)](_0x34bc4b);}catch(_0x66bdee){console[_0x1c3329(0x132)](_0x1c3329(0x179),_0x66bdee),loggerService_1[_0x1c3329(0x1aa)][_0x1c3329(0x190)]('rapyd',_0x1c3329(0x1be),'JSON\x20Parse\x20Error:\x20'+_0x66bdee);throw new Error(_0x1c3329(0x18c)+_0x34bc4b);}console[_0x1c3329(0x161)](_0x1c3329(0x1a8)),console[_0x1c3329(0x161)](_0x1c3329(0x15e),JSON[_0x1c3329(0x1ae)](_0x16608e,null,0x2)),loggerService_1[_0x1c3329(0x1aa)]['logWhiteDomainResponse'](_0x1c3329(0x1a9),_0x1c3329(0x1be),_0x47cd43[_0x1c3329(0x172)],_0x16608e,_0x41c14a);if(_0x16608e[_0x1c3329(0x172)]?.['status']!==_0x1c3329(0x159)){const _0x151ca7=_0x16608e[_0x1c3329(0x172)]?.['message']||_0x1c3329(0x1b7),_0xf32e94=_0x16608e['status']?.[_0x1c3329(0x14a)]||_0x1c3329(0x1bd);console[_0x1c3329(0x132)](_0x1c3329(0x145)),console[_0x1c3329(0x132)](_0x1c3329(0x1b4),_0xf32e94),console['error'](_0x1c3329(0x1a7),_0x151ca7),console[_0x1c3329(0x132)](_0x1c3329(0x140),_0x16608e[_0x1c3329(0x172)]),loggerService_1[_0x1c3329(0x1aa)]['logWhiteDomainError'](_0x1c3329(0x1a9),_0x1c3329(0x1be),_0x1c3329(0x1b1)+_0xf32e94+_0x1c3329(0x199)+_0x151ca7);throw new Error(_0x1c3329(0x138)+_0xf32e94+_0x1c3329(0x199)+_0x151ca7);}if(!_0x16608e[_0x1c3329(0x139)]?.['id']||!_0x16608e[_0x1c3329(0x139)]?.[_0x1c3329(0x150)]){console[_0x1c3329(0x132)]('===\x20RAPYD\x20API\x20INCOMPLETE\x20RESPONSE\x20==='),console[_0x1c3329(0x132)](_0x1c3329(0x18b)),console['error']('Response\x20data:',_0x16608e['data']),loggerService_1[_0x1c3329(0x1aa)][_0x1c3329(0x190)](_0x1c3329(0x1a9),_0x1c3329(0x1be),'Incomplete\x20response:\x20missing\x20id\x20or\x20redirect_url');throw new Error(_0x1c3329(0x1b5));}return console[_0x1c3329(0x161)]('===\x20RAPYD\x20SUCCESS\x20==='),console[_0x1c3329(0x161)](_0x1c3329(0x14c),_0x16608e['data']['id']),console[_0x1c3329(0x161)]('Redirect\x20URL:',_0x16608e[_0x1c3329(0x139)][_0x1c3329(0x150)]),console['log'](_0x1c3329(0x1a6)+_0x287492+_0x1c3329(0x19f)),console[_0x1c3329(0x161)](_0x1c3329(0x17a)),{'gateway_payment_id':_0x16608e[_0x1c3329(0x139)]['id'],'payment_url':_0x16608e['data'][_0x1c3329(0x150)]};}catch(_0x5cb302){console['error']('===\x20RAPYD\x20SERVICE\x20ERROR\x20==='),console[_0x1c3329(0x132)](_0x1c3329(0x1b6),_0x5cb302),loggerService_1[_0x1c3329(0x1aa)]['logWhiteDomainError'](_0x1c3329(0x1a9),_0x1c3329(0x1be),_0x5cb302);if(_0x5cb302 instanceof Error){console['error'](_0x1c3329(0x174),_0x5cb302['message']),console[_0x1c3329(0x132)](_0x1c3329(0x1b3),_0x5cb302['stack']);throw new Error(_0x1c3329(0x18f)+_0x5cb302[_0x1c3329(0x1b8)]);}throw new Error(_0x1c3329(0x17e));}}async[a63_0x29ce81(0x133)](_0x2d13e2){const _0x12299a=a63_0x29ce81,_0x38a43d=Date['now']();try{loggerService_1[_0x12299a(0x1aa)][_0x12299a(0x194)](_0x12299a(0x1a9),'/v1/hosted/payment_links/'+_0x2d13e2,_0x12299a(0x18e),{});const _0x1dd37b=await fetch(this[_0x12299a(0x158)]+'/'+_0x2d13e2,{'method':_0x12299a(0x18e),'headers':{'Content-Type':_0x12299a(0x147),'User-Agent':_0x12299a(0x14f)}}),_0x5f91ec=Date[_0x12299a(0x137)]()-_0x38a43d;if(!_0x1dd37b['ok']){const _0xbf98cd=await _0x1dd37b[_0x12299a(0x13f)]();loggerService_1[_0x12299a(0x1aa)][_0x12299a(0x13a)](_0x12299a(0x1a9),'/v1/hosted/payment_links/'+_0x2d13e2,_0x1dd37b[_0x12299a(0x172)],_0xbf98cd,_0x5f91ec);throw new Error('HTTP\x20error!\x20status:\x20'+_0x1dd37b[_0x12299a(0x172)]);}const _0x400358=await _0x1dd37b[_0x12299a(0x177)]();loggerService_1[_0x12299a(0x1aa)][_0x12299a(0x13a)](_0x12299a(0x1a9),_0x12299a(0x182)+_0x2d13e2,_0x1dd37b[_0x12299a(0x172)],_0x400358,_0x5f91ec);if(_0x400358[_0x12299a(0x172)]?.[_0x12299a(0x172)]!==_0x12299a(0x159)){loggerService_1['loggerService']['logWhiteDomainError'](_0x12299a(0x1a9),_0x12299a(0x182)+_0x2d13e2,'Rapyd\x20API\x20error:\x20'+(_0x400358['status']?.[_0x12299a(0x1b8)]||_0x12299a(0x185)));throw new Error(_0x12299a(0x151)+(_0x400358[_0x12299a(0x172)]?.[_0x12299a(0x1b8)]||_0x12299a(0x185)));}let _0x297af9=_0x12299a(0x18d);if(_0x400358[_0x12299a(0x139)]?.['status'])switch(_0x400358[_0x12299a(0x139)][_0x12299a(0x172)]['toUpperCase']()){case _0x12299a(0x15a):_0x297af9='PAID';break;case _0x12299a(0x18a):_0x297af9='FAILED';break;case _0x12299a(0x153):_0x297af9=_0x12299a(0x1af);break;case _0x12299a(0x16d):_0x297af9=_0x12299a(0x148);break;case _0x12299a(0x144):case _0x12299a(0x14d):default:_0x297af9=_0x12299a(0x18d);break;}return{'status':_0x297af9,'amount':_0x400358[_0x12299a(0x139)]?.[_0x12299a(0x149)],'currency':_0x400358[_0x12299a(0x139)]?.[_0x12299a(0x1a5)]};}catch(_0x4d824f){console[_0x12299a(0x132)](_0x12299a(0x181),_0x4d824f),loggerService_1['loggerService'][_0x12299a(0x190)](_0x12299a(0x1a9),_0x12299a(0x182)+_0x2d13e2,_0x4d824f);throw new Error(_0x12299a(0x17d)+(_0x4d824f instanceof Error?_0x4d824f[_0x12299a(0x1b8)]:_0x12299a(0x185)));}}async['processWebhook'](_0x4a4608){const _0x1f57f2=a63_0x29ce81;console['log'](_0x1f57f2(0x14e),_0x4a4608);let _0x1b8fec=_0x1f57f2(0x18d),_0x39fde7;_0x4a4608[_0x1f57f2(0x139)]?.[_0x1f57f2(0x16a)]&&(_0x39fde7=_0x4a4608[_0x1f57f2(0x139)]['failure_message'],console[_0x1f57f2(0x161)](_0x1f57f2(0x13e)+_0x39fde7));switch(_0x4a4608['type']?.[_0x1f57f2(0x191)]()){case _0x1f57f2(0x1b0):_0x4a4608['data']?.['paid']===!![]&&_0x4a4608['data']?.['status']===_0x1f57f2(0x15a)?_0x1b8fec=_0x1f57f2(0x1ba):_0x1b8fec=_0x1f57f2(0x18d);break;case _0x1f57f2(0x1a3):_0x1b8fec='FAILED';break;case _0x1f57f2(0x136):_0x1b8fec='EXPIRED';break;case _0x1f57f2(0x15d):_0x1b8fec=_0x1f57f2(0x148);!_0x39fde7&&_0x4a4608[_0x1f57f2(0x139)]?.[_0x1f57f2(0x16a)]&&(_0x39fde7=_0x4a4608[_0x1f57f2(0x139)][_0x1f57f2(0x16a)]);break;default:switch(_0x4a4608[_0x1f57f2(0x139)]?.[_0x1f57f2(0x172)]?.[_0x1f57f2(0x191)]()){case _0x1f57f2(0x15a):_0x4a4608[_0x1f57f2(0x139)]?.[_0x1f57f2(0x19e)]===!![]?_0x1b8fec=_0x1f57f2(0x1ba):_0x1b8fec=_0x1f57f2(0x148);break;case _0x1f57f2(0x18a):_0x1b8fec=_0x1f57f2(0x148);break;case _0x1f57f2(0x153):_0x1b8fec=_0x1f57f2(0x1af);break;case'ERR':_0x1b8fec=_0x1f57f2(0x148);!_0x39fde7&&_0x4a4608[_0x1f57f2(0x139)]?.['failure_message']&&(_0x39fde7=_0x4a4608[_0x1f57f2(0x139)]['failure_message']);break;case'NEW':case'ACT':default:_0x1b8fec='PENDING';break;}break;}const _0x7d58a5={};return _0x4a4608[_0x1f57f2(0x139)]?.[_0x1f57f2(0x13d)]?.['last4']&&(_0x7d58a5['cardLast4']=_0x4a4608['data'][_0x1f57f2(0x13d)][_0x1f57f2(0x19c)]),_0x4a4608[_0x1f57f2(0x139)]?.[_0x1f57f2(0x1a4)]&&(_0x7d58a5[_0x1f57f2(0x16c)]=_0x4a4608['data'][_0x1f57f2(0x1a4)]),_0x4a4608['data']?.[_0x1f57f2(0x14a)]&&(_0x7d58a5['errorCode']=_0x4a4608[_0x1f57f2(0x139)][_0x1f57f2(0x14a)]),_0x4a4608[_0x1f57f2(0x139)]?.['failure_code']&&(_0x7d58a5[_0x1f57f2(0x175)]=_0x4a4608[_0x1f57f2(0x139)][_0x1f57f2(0x188)]),console[_0x1f57f2(0x161)](_0x1f57f2(0x196)+_0x1b8fec+',\x20failureMessage='+(_0x39fde7||_0x1f57f2(0x1bb))),{'paymentId':_0x4a4608[_0x1f57f2(0x139)]?.[_0x1f57f2(0x173)]||'','status':_0x1b8fec,'amount':_0x4a4608['data']?.[_0x1f57f2(0x149)],'currency':_0x4a4608['data']?.[_0x1f57f2(0x1a5)],'failureMessage':_0x39fde7,'additionalInfo':_0x7d58a5};}}function a63_0x30a6(){const _0x231dfb=['data','logWhiteDomainResponse','6qRywxE','email','payment_method_data','ðŸ’¥\x20Rapyd\x20failure\x20message:\x20','text','Full\x20Error\x20Data:','cardholder_name','RapydService','https://tesoft.uk/gateway/fail.php?id=','NEW','===\x20RAPYD\x20API\x20BUSINESS\x20ERROR\x20===','Raw\x20Response\x20Body:','application/json','FAILED','amount','error_code',',\x20body:\x20','Payment\x20Link\x20ID:','ACT','Processing\x20Rapyd\x20webhook:','Payment\x20System/1.0','redirect_url','Rapyd\x20API\x20error:\x20','defineProperty','EXP','ðŸŒ\x20Rapyd\x20service\x20initialized\x20with\x20white\x20domain\x20proxy','===\x20RAPYD\x20API\x20RESPONSE\x20(White\x20Domain)\x20===','11624uLocYJ','toISOString','apiUrl','SUCCESS','CLO','\x20\x20\x20expiration:\x20','headers','PAYMENT_FAILED','Parsed\x20Result:','ðŸ’³\x20Adding\x20cardholder\x20name:\x20','requested_currency','log','floor','statusText','ORDER:\x20','15176810InSdHF','createPaymentLink','===\x20RAPYD\x20API\x20ERROR\x20===','../loggerService','\x20\x20\x20requested_currency:\x20EUR','failure_message','https://tesoft.uk/gateway/success.php?id=','paymentMethod','ERR','HTTP\x20','EUR','POST','81162VXOUSY','status','merchant_reference_id','Error\x20message:','failureCode','HTTP\x20Status:','json','phone_number','Failed\x20to\x20parse\x20JSON\x20response:','ðŸ’³\x20Payment\x20Methods:\x20gb_visa_card,\x20gb_mastercard_card','fixed_side','Status:','Failed\x20to\x20verify\x20Rapyd\x20payment:\x20','Failed\x20to\x20create\x20Rapyd\x20payment\x20link:\x20Unknown\x20error','1424740KQkuCq','URL:','Rapyd\x20payment\x20verification\x20error:','/v1/hosted/payment_links/','TESOFT\x20','646981tUekZb','Unknown\x20error','Response\x20Time:','gb_mastercard_card','failure_code','ðŸ’±\x20Adding\x20currency\x20conversion\x20fields\x20for\x20','CAN','Missing\x20id\x20or\x20redirect_url\x20in\x20response','Invalid\x20JSON\x20response\x20from\x20Rapyd\x20API:\x20','PENDING','GET','Failed\x20to\x20create\x20Rapyd\x20payment\x20link:\x20','logWhiteDomainError','toUpperCase','https://tesoft.uk/gateway/rapyd/','expiration','logWhiteDomainRequest','gb_visa_card','ðŸ”„\x20Rapyd\x20webhook\x20processed:\x20status=','entries','\x20(always\x20GB\x20for\x20Rapyd)','):\x20','7817649xorthp','name','last4','parse','paid','\x20(GB\x20-\x20Britain)','custom_elements','ðŸ‡¬ðŸ‡§\x20Using\x20GB\x20(Britain)\x20as\x20country\x20for\x20Rapyd\x20payment\x20link','ðŸ‡¬ðŸ‡§\x20Country:\x20','PAYMENT_CANCELED','payment_method_type','currency','ðŸ‡¬ðŸ‡§\x20Country\x20used:\x20','Error\x20Message:','===\x20PARSED\x20RAPYD\x20RESPONSE\x20===','rapyd','loggerService','\x20->\x20EUR:','__esModule','Status\x20Text:','stringify','EXPIRED','PAYMENT_COMPLETED','Business\x20Error\x20(','7407AlYLAF','Error\x20stack:','Error\x20Code:','Invalid\x20response\x20from\x20Rapyd\x20API:\x20missing\x20id\x20or\x20redirect_url','Error\x20details:','Unknown\x20error\x20from\x20Rapyd\x20API','message','2GNMZpx','PAID','none','HTTP\x20error!\x20status:\x20','UNKNOWN','/v1/hosted/payment_links','error','verifyPayment','895960tMJZdz','fromEntries','PAYMENT_EXPIRED','now','Rapyd\x20API\x20error\x20('];a63_0x30a6=function(){return _0x231dfb;};return a63_0x30a6();}exports[a63_0x29ce81(0x142)]=RapydService;