'use strict';const a46_0x1598c6=a46_0x2de2;(function(_0x54c21a,_0x3a196c){const _0x28929e=a46_0x2de2,_0x318464=_0x54c21a();while(!![]){try{const _0x3ef78d=parseInt(_0x28929e(0x1ab))/0x1+parseInt(_0x28929e(0x197))/0x2*(parseInt(_0x28929e(0x1cd))/0x3)+-parseInt(_0x28929e(0x1ea))/0x4+parseInt(_0x28929e(0x1e3))/0x5*(parseInt(_0x28929e(0x1bb))/0x6)+parseInt(_0x28929e(0x1a5))/0x7*(parseInt(_0x28929e(0x1a4))/0x8)+-parseInt(_0x28929e(0x1a0))/0x9*(-parseInt(_0x28929e(0x1ca))/0xa)+-parseInt(_0x28929e(0x199))/0xb*(parseInt(_0x28929e(0x1aa))/0xc);if(_0x3ef78d===_0x3a196c)break;else _0x318464['push'](_0x318464['shift']());}catch(_0x5423a8){_0x318464['push'](_0x318464['shift']());}}}(a46_0x5152,0xe43f4));function a46_0x5152(){const _0x1987fc=['payment_method_type','/v1/hosted/payment_links/','Raw\x20Response\x20Body:','redirect_url','Rapyd\x20API\x20error\x20(','logWhiteDomainRequest','===\x20RAPYD\x20SERVICE\x20ERROR\x20===','GET','entries','HTTP\x20error!\x20status:\x20','payment_method_data','RapydService','Business\x20Error\x20(','11034610Wuzajn','ORDER:\x20','Failed\x20to\x20create\x20Rapyd\x20payment\x20link:\x20Unknown\x20error','1295982Zhxxwv','https://tesoft.uk/gateway/success.php?id=','EXP','URL:','Rapyd\x20API\x20error:\x20','UNKNOWN','PAID','message','Request\x20Body\x20(Updated\x20Format):','Parsed\x20Result:',',\x20body:\x20','https://tesoft.uk/gateway/fail.php?id=','üá¨üáß\x20Country\x20used:\x20','Redirect\x20URL:','Headers:','\x20(GB\x20-\x20Britain)','toUpperCase','PAYMENT_COMPLETED','Processing\x20Rapyd\x20webhook:','/v1/hosted/payment_links','paymentMethod','Error\x20details:','190870ecRZZo','PAYMENT_EXPIRED','https://tesoft.uk/gateway/rapyd/','defineProperty','===\x20RAPYD\x20API\x20ERROR\x20===','rapyd','PAYMENT_FAILED','7320292mupdvD','loggerService','statusText','type','application/json','apiUrl','\x20(always\x20GB\x20for\x20Rapyd)','fromEntries','headers','__esModule','cardLast4','logWhiteDomainError','error','Incomplete\x20response:\x20missing\x20id\x20or\x20redirect_url','paid','parse','CLO','===\x20RAPYD\x20API\x20INCOMPLETE\x20RESPONSE\x20===','merchant_reference_id','amount','gb_mastercard_card','ACT','üá¨üáß\x20Using\x20GB\x20(Britain)\x20as\x20country\x20for\x20Rapyd\x20payment\x20link','logWhiteDomainResponse','TesSoft\x20Payment\x20System/1.0','currency','NEW','errorCode','üí•\x20Rapyd\x20failure\x20message:\x20','Unknown\x20error\x20from\x20Rapyd\x20API','EXPIRED','json','PAYMENT_CANCELED','):\x20','log','Error\x20Message:','status','data','failureCode','===\x20RAPYD\x20SUCCESS\x20===','Status\x20Text:','2ZPizFY','Rapyd\x20payment\x20verification\x20error:','11gwtLZQ','failure_code','failure_message','Payment\x20Link\x20ID:','error_code','FAILED','üåê\x20Rapyd\x20service\x20initialized\x20with\x20white\x20domain\x20proxy','9QSzGPe','now','üîÑ\x20Rapyd\x20webhook\x20processed:\x20status=','processWebhook','3448kKoYDo','413dFeeaW','Failed\x20to\x20verify\x20Rapyd\x20payment:\x20','Response\x20data:',',\x20failureMessage=','Full\x20Error\x20Data:','7502916YXKUIk','645938EgVckH','text','===\x20RAPYD\x20API\x20RESPONSE\x20(White\x20Domain)\x20===','üí≥\x20Payment\x20Methods:\x20gb_visa_card,\x20gb_mastercard_card','Unknown\x20error','ERR','SUCCESS','CAN','none','Invalid\x20response\x20from\x20Rapyd\x20API:\x20missing\x20id\x20or\x20redirect_url','JSON\x20Parse\x20Error:\x20','stringify','../loggerService','Error\x20stack:','Error\x20message:','PENDING','186EdiXLs','Failed\x20to\x20create\x20Rapyd\x20payment\x20link:\x20'];a46_0x5152=function(){return _0x1987fc;};return a46_0x5152();}function a46_0x2de2(_0x25015e,_0x36b65e){const _0x5152a5=a46_0x5152();return a46_0x2de2=function(_0x2de24b,_0x33b610){_0x2de24b=_0x2de24b-0x180;let _0x429011=_0x5152a5[_0x2de24b];return _0x429011;},a46_0x2de2(_0x25015e,_0x36b65e);}Object[a46_0x1598c6(0x1e6)](exports,a46_0x1598c6(0x1f3),{'value':!![]}),exports[a46_0x1598c6(0x1c8)]=void 0x0;const loggerService_1=require(a46_0x1598c6(0x1b7));class RapydService{constructor(){const _0x2a313d=a46_0x1598c6;this[_0x2a313d(0x1ef)]=_0x2a313d(0x1e5),console['log'](_0x2a313d(0x19f));}async['createPaymentLink'](_0x421a7e){const _0x412a23=a46_0x1598c6,{orderId:_0x566ea6,orderName:_0x2f7e51,amount:_0x3f98c7,currency:_0x5a4e58,usage:_0x3dded0,maxPayments:_0x103f31,successUrl:_0x58fd76,failUrl:_0x2620e6}=_0x421a7e,_0x22ddfd=_0x5a4e58['toUpperCase'](),_0xb21a50='GB';console[_0x412a23(0x190)](_0x412a23(0x184));const _0x3f6511=_0x412a23(0x1ce)+_0x566ea6,_0x345d10=_0x412a23(0x1d8)+_0x566ea6,_0x35bb30={'amount':_0x3f98c7,'currency':_0x22ddfd,'cancel_checkout_url':_0x345d10,'complete_checkout_url':_0x3f6511,'complete_payment_url':_0x3f6511,'merchant_reference_id':_0x566ea6,'description':_0x412a23(0x1cb)+_0x566ea6,'country':'GB','payment_method_types_include':['gb_visa_card',_0x412a23(0x182)],'custom_elements':{'display_description':!![]}},_0x21d9cb=Date[_0x412a23(0x1a1)]();try{console['log']('===\x20RAPYD\x20API\x20REQUEST\x20(White\x20Domain\x20-\x20Updated\x20Format)\x20==='),console[_0x412a23(0x190)](_0x412a23(0x1d0),this[_0x412a23(0x1ef)]),console[_0x412a23(0x190)](_0x412a23(0x1d5),JSON['stringify'](_0x35bb30,null,0x2)),console[_0x412a23(0x190)]('üá¨üáß\x20Country:\x20'+_0xb21a50+_0x412a23(0x1f0)),console[_0x412a23(0x190)](_0x412a23(0x1ae)),loggerService_1[_0x412a23(0x1eb)]['logWhiteDomainRequest'](_0x412a23(0x1e8),_0x412a23(0x1e0),'POST',_0x35bb30);const _0x2ab049=await fetch(this['apiUrl'],{'method':'POST','headers':{'Content-Type':'application/json','User-Agent':_0x412a23(0x186)},'body':JSON[_0x412a23(0x1b6)](_0x35bb30)}),_0xd1311a=Date[_0x412a23(0x1a1)]()-_0x21d9cb;console[_0x412a23(0x190)](_0x412a23(0x1ad)),console[_0x412a23(0x190)]('Status:',_0x2ab049['status']),console[_0x412a23(0x190)](_0x412a23(0x196),_0x2ab049[_0x412a23(0x1ec)]),console[_0x412a23(0x190)](_0x412a23(0x1db),Object[_0x412a23(0x1f1)](_0x2ab049[_0x412a23(0x1f2)][_0x412a23(0x1c5)]())),console['log']('Response\x20Time:',_0xd1311a+'ms');const _0xca1893=await _0x2ab049['text']();console['log'](_0x412a23(0x1bf),_0xca1893);if(!_0x2ab049['ok']){console[_0x412a23(0x1f6)](_0x412a23(0x1e7)),console['error']('HTTP\x20Status:',_0x2ab049[_0x412a23(0x192)]),console['error']('Response\x20Body:',_0xca1893),loggerService_1[_0x412a23(0x1eb)][_0x412a23(0x185)]('rapyd','/v1/hosted/payment_links',_0x2ab049[_0x412a23(0x192)],_0xca1893,_0xd1311a),loggerService_1[_0x412a23(0x1eb)][_0x412a23(0x1f5)](_0x412a23(0x1e8),_0x412a23(0x1e0),'HTTP\x20'+_0x2ab049['status']+':\x20'+_0xca1893);throw new Error(_0x412a23(0x1c6)+_0x2ab049['status']+_0x412a23(0x1d7)+_0xca1893);}let _0x66e4d6;try{_0x66e4d6=JSON[_0x412a23(0x1f9)](_0xca1893);}catch(_0x59116f){console['error']('Failed\x20to\x20parse\x20JSON\x20response:',_0x59116f),loggerService_1[_0x412a23(0x1eb)]['logWhiteDomainError'](_0x412a23(0x1e8),'/v1/hosted/payment_links',_0x412a23(0x1b5)+_0x59116f);throw new Error('Invalid\x20JSON\x20response\x20from\x20Rapyd\x20API:\x20'+_0xca1893);}console['log']('===\x20PARSED\x20RAPYD\x20RESPONSE\x20==='),console['log'](_0x412a23(0x1d6),JSON[_0x412a23(0x1b6)](_0x66e4d6,null,0x2)),loggerService_1[_0x412a23(0x1eb)]['logWhiteDomainResponse'](_0x412a23(0x1e8),_0x412a23(0x1e0),_0x2ab049['status'],_0x66e4d6,_0xd1311a);if(_0x66e4d6[_0x412a23(0x192)]?.['status']!==_0x412a23(0x1b1)){const _0x3feab4=_0x66e4d6[_0x412a23(0x192)]?.[_0x412a23(0x1d4)]||_0x412a23(0x18b),_0x1925b1=_0x66e4d6[_0x412a23(0x192)]?.[_0x412a23(0x19d)]||_0x412a23(0x1d2);console[_0x412a23(0x1f6)]('===\x20RAPYD\x20API\x20BUSINESS\x20ERROR\x20==='),console[_0x412a23(0x1f6)]('Error\x20Code:',_0x1925b1),console[_0x412a23(0x1f6)](_0x412a23(0x191),_0x3feab4),console['error'](_0x412a23(0x1a9),_0x66e4d6[_0x412a23(0x192)]),loggerService_1['loggerService'][_0x412a23(0x1f5)](_0x412a23(0x1e8),_0x412a23(0x1e0),_0x412a23(0x1c9)+_0x1925b1+_0x412a23(0x18f)+_0x3feab4);throw new Error(_0x412a23(0x1c1)+_0x1925b1+_0x412a23(0x18f)+_0x3feab4);}if(!_0x66e4d6[_0x412a23(0x193)]?.['id']||!_0x66e4d6[_0x412a23(0x193)]?.[_0x412a23(0x1c0)]){console[_0x412a23(0x1f6)](_0x412a23(0x1fb)),console['error']('Missing\x20id\x20or\x20redirect_url\x20in\x20response'),console[_0x412a23(0x1f6)](_0x412a23(0x1a7),_0x66e4d6[_0x412a23(0x193)]),loggerService_1[_0x412a23(0x1eb)][_0x412a23(0x1f5)]('rapyd','/v1/hosted/payment_links',_0x412a23(0x1f7));throw new Error(_0x412a23(0x1b4));}return console[_0x412a23(0x190)](_0x412a23(0x195)),console[_0x412a23(0x190)](_0x412a23(0x19c),_0x66e4d6['data']['id']),console['log'](_0x412a23(0x1da),_0x66e4d6['data']['redirect_url']),console[_0x412a23(0x190)](_0x412a23(0x1d9)+_0xb21a50+_0x412a23(0x1dc)),console[_0x412a23(0x190)](_0x412a23(0x1ae)),{'gateway_payment_id':_0x66e4d6[_0x412a23(0x193)]['id'],'payment_url':_0x66e4d6[_0x412a23(0x193)][_0x412a23(0x1c0)]};}catch(_0xe74227){console[_0x412a23(0x1f6)](_0x412a23(0x1c3)),console[_0x412a23(0x1f6)](_0x412a23(0x1e2),_0xe74227),loggerService_1[_0x412a23(0x1eb)][_0x412a23(0x1f5)]('rapyd',_0x412a23(0x1e0),_0xe74227);if(_0xe74227 instanceof Error){console['error'](_0x412a23(0x1b9),_0xe74227['message']),console['error'](_0x412a23(0x1b8),_0xe74227['stack']);throw new Error(_0x412a23(0x1bc)+_0xe74227[_0x412a23(0x1d4)]);}throw new Error(_0x412a23(0x1cc));}}async['verifyPayment'](_0x3ce87c){const _0x1ea800=a46_0x1598c6,_0x172214=Date[_0x1ea800(0x1a1)]();try{loggerService_1[_0x1ea800(0x1eb)][_0x1ea800(0x1c2)](_0x1ea800(0x1e8),_0x1ea800(0x1be)+_0x3ce87c,_0x1ea800(0x1c4),{});const _0x4ee65d=await fetch(this[_0x1ea800(0x1ef)]+'/'+_0x3ce87c,{'method':_0x1ea800(0x1c4),'headers':{'Content-Type':_0x1ea800(0x1ee),'User-Agent':'TesSoft\x20Payment\x20System/1.0'}}),_0xeb9dda=Date[_0x1ea800(0x1a1)]()-_0x172214;if(!_0x4ee65d['ok']){const _0x404668=await _0x4ee65d[_0x1ea800(0x1ac)]();loggerService_1[_0x1ea800(0x1eb)]['logWhiteDomainResponse'](_0x1ea800(0x1e8),'/v1/hosted/payment_links/'+_0x3ce87c,_0x4ee65d[_0x1ea800(0x192)],_0x404668,_0xeb9dda);throw new Error('HTTP\x20error!\x20status:\x20'+_0x4ee65d['status']);}const _0x17c567=await _0x4ee65d[_0x1ea800(0x18d)]();loggerService_1[_0x1ea800(0x1eb)][_0x1ea800(0x185)](_0x1ea800(0x1e8),_0x1ea800(0x1be)+_0x3ce87c,_0x4ee65d[_0x1ea800(0x192)],_0x17c567,_0xeb9dda);if(_0x17c567[_0x1ea800(0x192)]?.[_0x1ea800(0x192)]!==_0x1ea800(0x1b1)){loggerService_1[_0x1ea800(0x1eb)][_0x1ea800(0x1f5)]('rapyd',_0x1ea800(0x1be)+_0x3ce87c,_0x1ea800(0x1d1)+(_0x17c567[_0x1ea800(0x192)]?.[_0x1ea800(0x1d4)]||_0x1ea800(0x1af)));throw new Error(_0x1ea800(0x1d1)+(_0x17c567[_0x1ea800(0x192)]?.[_0x1ea800(0x1d4)]||_0x1ea800(0x1af)));}let _0x23690f=_0x1ea800(0x1ba);if(_0x17c567[_0x1ea800(0x193)]?.['status'])switch(_0x17c567[_0x1ea800(0x193)]['status']['toUpperCase']()){case'CLO':_0x23690f='PAID';break;case _0x1ea800(0x1b2):_0x23690f='FAILED';break;case _0x1ea800(0x1cf):_0x23690f=_0x1ea800(0x18c);break;case _0x1ea800(0x1b0):_0x23690f=_0x1ea800(0x19e);break;case _0x1ea800(0x188):case _0x1ea800(0x183):default:_0x23690f='PENDING';break;}return{'status':_0x23690f,'amount':_0x17c567[_0x1ea800(0x193)]?.[_0x1ea800(0x181)],'currency':_0x17c567[_0x1ea800(0x193)]?.[_0x1ea800(0x187)]};}catch(_0xe5e5f5){console[_0x1ea800(0x1f6)](_0x1ea800(0x198),_0xe5e5f5),loggerService_1[_0x1ea800(0x1eb)][_0x1ea800(0x1f5)](_0x1ea800(0x1e8),_0x1ea800(0x1be)+_0x3ce87c,_0xe5e5f5);throw new Error(_0x1ea800(0x1a6)+(_0xe5e5f5 instanceof Error?_0xe5e5f5[_0x1ea800(0x1d4)]:_0x1ea800(0x1af)));}}async[a46_0x1598c6(0x1a3)](_0x3b7052){const _0x41e254=a46_0x1598c6;console[_0x41e254(0x190)](_0x41e254(0x1df),_0x3b7052);let _0x55ee11=_0x41e254(0x1ba),_0x58abc9;_0x3b7052[_0x41e254(0x193)]?.['failure_message']&&(_0x58abc9=_0x3b7052[_0x41e254(0x193)][_0x41e254(0x19b)],console[_0x41e254(0x190)](_0x41e254(0x18a)+_0x58abc9));switch(_0x3b7052[_0x41e254(0x1ed)]?.['toUpperCase']()){case _0x41e254(0x1de):_0x3b7052[_0x41e254(0x193)]?.[_0x41e254(0x1f8)]===!![]&&_0x3b7052[_0x41e254(0x193)]?.[_0x41e254(0x192)]===_0x41e254(0x1fa)?_0x55ee11='PAID':_0x55ee11=_0x41e254(0x1ba);break;case _0x41e254(0x18e):_0x55ee11=_0x41e254(0x19e);break;case _0x41e254(0x1e4):_0x55ee11='EXPIRED';break;case _0x41e254(0x1e9):_0x55ee11='FAILED';!_0x58abc9&&_0x3b7052[_0x41e254(0x193)]?.['failure_message']&&(_0x58abc9=_0x3b7052[_0x41e254(0x193)][_0x41e254(0x19b)]);break;default:switch(_0x3b7052[_0x41e254(0x193)]?.[_0x41e254(0x192)]?.[_0x41e254(0x1dd)]()){case _0x41e254(0x1fa):_0x3b7052[_0x41e254(0x193)]?.[_0x41e254(0x1f8)]===!![]?_0x55ee11=_0x41e254(0x1d3):_0x55ee11=_0x41e254(0x19e);break;case _0x41e254(0x1b2):_0x55ee11='FAILED';break;case _0x41e254(0x1cf):_0x55ee11='EXPIRED';break;case _0x41e254(0x1b0):_0x55ee11=_0x41e254(0x19e);!_0x58abc9&&_0x3b7052[_0x41e254(0x193)]?.[_0x41e254(0x19b)]&&(_0x58abc9=_0x3b7052[_0x41e254(0x193)][_0x41e254(0x19b)]);break;case _0x41e254(0x188):case _0x41e254(0x183):default:_0x55ee11=_0x41e254(0x1ba);break;}break;}const _0x123edc={};return _0x3b7052['data']?.['payment_method_data']?.['last4']&&(_0x123edc[_0x41e254(0x1f4)]=_0x3b7052['data'][_0x41e254(0x1c7)]['last4']),_0x3b7052[_0x41e254(0x193)]?.[_0x41e254(0x1bd)]&&(_0x123edc[_0x41e254(0x1e1)]=_0x3b7052[_0x41e254(0x193)][_0x41e254(0x1bd)]),_0x3b7052[_0x41e254(0x193)]?.[_0x41e254(0x19d)]&&(_0x123edc[_0x41e254(0x189)]=_0x3b7052[_0x41e254(0x193)][_0x41e254(0x19d)]),_0x3b7052[_0x41e254(0x193)]?.[_0x41e254(0x19a)]&&(_0x123edc[_0x41e254(0x194)]=_0x3b7052[_0x41e254(0x193)]['failure_code']),console[_0x41e254(0x190)](_0x41e254(0x1a2)+_0x55ee11+_0x41e254(0x1a8)+(_0x58abc9||_0x41e254(0x1b3))),{'paymentId':_0x3b7052[_0x41e254(0x193)]?.[_0x41e254(0x180)]||'','status':_0x55ee11,'amount':_0x3b7052['data']?.['amount'],'currency':_0x3b7052['data']?.[_0x41e254(0x187)],'failureMessage':_0x58abc9,'additionalInfo':_0x123edc};}}exports[a46_0x1598c6(0x1c8)]=RapydService;