'use strict';function a63_0x376c(){const _0x36a215=['Unknown\x20error\x20from\x20Rapyd\x20API','HTTP\x20error!\x20status:\x20','merchant_reference_id','PAYMENT_EXPIRED','Error\x20stack:','Rapyd\x20API\x20error\x20(','paid','apiUrl','GET','Full\x20Error\x20Data:','Parsed\x20Result:','\x20(always\x20GB\x20for\x20Rapyd)','application/json','256482KUbVSD','ðŸ’³\x20Payment\x20Methods:\x20gb_visa_card,\x20gb_mastercard_card','logWhiteDomainResponse','Request\x20Body\x20(Updated\x20Format):','Business\x20Error\x20(','Status:','amount','errorCode','requested_currency','__esModule','\x20\x20\x20expiration:\x20','RapydService','767963KBvUfa','toUpperCase','CAN','ðŸ‡¬ðŸ‡§\x20Using\x20GB\x20(Britain)\x20as\x20country\x20for\x20Rapyd\x20payment\x20link','Headers:','Response\x20data:','SUCCESS','log','FAILED','stringify','floor','===\x20PARSED\x20RAPYD\x20RESPONSE\x20===','error_code','Missing\x20id\x20or\x20redirect_url\x20in\x20response','60HKbXWD','NEW','logWhiteDomainError','HTTP\x20Status:','JSON\x20Parse\x20Error:\x20','currency','CLO','8724204uXkKAc','processWebhook','loggerService','===\x20RAPYD\x20API\x20INCOMPLETE\x20RESPONSE\x20===','Failed\x20to\x20create\x20Rapyd\x20payment\x20link:\x20Unknown\x20error','):\x20','===\x20RAPYD\x20API\x20REQUEST\x20(White\x20Domain\x20-\x20Updated\x20Format)\x20===','Error\x20message:','ORDER:\x20','gb_mastercard_card','ðŸ’³\x20Adding\x20cardholder\x20name:\x20','paymentMethod','Payment\x20Link\x20ID:','Status\x20Text:','https://tesoft.uk/gateway/fail.php?id=','Redirect\x20URL:','/v1/hosted/payment_links/','EXPIRED','Incomplete\x20response:\x20missing\x20id\x20or\x20redirect_url','/v1/hosted/payment_links','last4','ðŸ‡¬ðŸ‡§\x20Country\x20used:\x20','381210YCliMW','Response\x20Time:','type','rapyd','https://tesoft.uk/gateway/success.php?id=','ACT','status','split','defineProperty','json','ERR','cardLast4','Payment\x20System/1.0','phone_number','email','name','address','PENDING','payment_method_type','custom_elements','PAYMENT_COMPLETED','redirect_url','1113279iEAVmJ','cardholder_name','===\x20RAPYD\x20API\x20ERROR\x20===','===\x20RAPYD\x20SERVICE\x20ERROR\x20===','entries','PAYMENT_CANCELED','Error\x20Message:','data','\x20\x20\x20fixed_side:\x20buy','fixed_side','===\x20RAPYD\x20API\x20BUSINESS\x20ERROR\x20===','POST','headers','ðŸ’¥\x20Rapyd\x20failure\x20message:\x20','Rapyd\x20payment\x20verification\x20error:','ðŸ”„\x20Rapyd\x20webhook\x20processed:\x20status=','PAYMENT_FAILED','now','3354230qqsqyz','\x20\x20\x20requested_currency:\x20EUR','===\x20RAPYD\x20SUCCESS\x20===','message','3JibkQu','text','EUR','payment_method_data','failure_message','Invalid\x20JSON\x20response\x20from\x20Rapyd\x20API:\x20','8ELfbwK','Raw\x20Response\x20Body:','===\x20RAPYD\x20API\x20RESPONSE\x20(White\x20Domain)\x20===','fromEntries','createPaymentLink','HTTP\x20','ðŸŒ\x20Rapyd\x20service\x20initialized\x20with\x20white\x20domain\x20proxy','failureCode','EXP','Processing\x20Rapyd\x20webhook:','338748yOovbs','Unknown\x20error','Error\x20details:','expiration','stack','PAID','error'];a63_0x376c=function(){return _0x36a215;};return a63_0x376c();}const a63_0x48fe09=a63_0x1487;(function(_0x319f6e,_0x27239a){const _0x4bb145=a63_0x1487,_0x5bef72=_0x319f6e();while(!![]){try{const _0x55947a=-parseInt(_0x4bb145(0x1c6))/0x1+parseInt(_0x4bb145(0x1b0))/0x2*(-parseInt(_0x4bb145(0x155))/0x3)+-parseInt(_0x4bb145(0x165))/0x4*(-parseInt(_0x4bb145(0x193))/0x5)+parseInt(_0x4bb145(0x19a))/0x6+-parseInt(_0x4bb145(0x185))/0x7+parseInt(_0x4bb145(0x15b))/0x8*(parseInt(_0x4bb145(0x179))/0x9)+-parseInt(_0x4bb145(0x1d8))/0xa;if(_0x55947a===_0x27239a)break;else _0x5bef72['push'](_0x5bef72['shift']());}catch(_0x39c39c){_0x5bef72['push'](_0x5bef72['shift']());}}}(a63_0x376c,0xb70c0));function a63_0x1487(_0xb99c3a,_0xe527ad){_0xb99c3a=_0xb99c3a-0x155;const _0x376c39=a63_0x376c();let _0x148768=_0x376c39[_0xb99c3a];return _0x148768;}Object[a63_0x48fe09(0x1b8)](exports,a63_0x48fe09(0x182),{'value':!![]}),exports[a63_0x48fe09(0x184)]=void 0x0;const loggerService_1=require('../loggerService');class RapydService{constructor(){const _0x2fd291=a63_0x48fe09;this['apiUrl']='https://tesoft.uk/gateway/rapyd/',console['log'](_0x2fd291(0x161));}async[a63_0x48fe09(0x15f)](_0x116eec){const _0x536730=a63_0x48fe09,{orderId:_0x1a385c,orderName:_0x45c279,amount:_0x4d4aea,currency:_0x50a3be,usage:_0x3cd5d0,maxPayments:_0x4d1706,successUrl:_0x15afff,failUrl:_0x5bd30a,customerName:_0xa8967b,customerEmail:_0xf595e5}=_0x116eec,_0x159d2c=_0x50a3be[_0x536730(0x186)](),_0x43448b='GB';console[_0x536730(0x18c)](_0x536730(0x188));const _0x10aa52=_0x536730(0x1b4)+_0x1a385c,_0x41319e=_0x536730(0x1a8)+_0x1a385c,_0x20c862={'amount':_0x4d4aea,'currency':_0x159d2c,'payment_method_options':{'3d_required':![]},'cancel_checkout_url':_0x41319e,'complete_checkout_url':_0x10aa52,'complete_payment_url':_0x10aa52,'merchant_reference_id':_0x1a385c,'description':_0x536730(0x1a2)+_0x1a385c,'statement_descriptor':'TESOFT\x20'+(_0x1a385c[_0x536730(0x1b7)]('-')[0x1]||_0x1a385c),'country':'GB','payment_method_types_include':['gb_visa_card',_0x536730(0x1a3)],'custom_elements':{'display_description':!![],'billing_address_collect':!![],'required_customer_fields':[_0x536730(0x1bf),_0x536730(0x1be),_0x536730(0x1bd),_0x536730(0x1c0)]}};_0xa8967b&&(_0x20c862[_0x536730(0x1c3)][_0x536730(0x1c7)]=_0xa8967b,console[_0x536730(0x18c)](_0x536730(0x1a4)+_0xa8967b));if(_0x159d2c!==_0x536730(0x157)){const _0x4a5f00=Math[_0x536730(0x18f)](Date['now']()/0x3e8)+0x1e*0x3c;_0x20c862[_0x536730(0x1cf)]='buy',_0x20c862[_0x536730(0x181)]=_0x536730(0x157),_0x20c862[_0x536730(0x168)]=_0x4a5f00,console[_0x536730(0x18c)]('ðŸ’±\x20Adding\x20currency\x20conversion\x20fields\x20for\x20'+_0x159d2c+'\x20->\x20EUR:'),console[_0x536730(0x18c)](_0x536730(0x1ce)),console['log'](_0x536730(0x1d9)),console['log'](_0x536730(0x183)+_0x4a5f00+'\x20('+new Date(_0x4a5f00*0x3e8)['toISOString']()+')');}const _0x32c809=Date['now']();try{console[_0x536730(0x18c)](_0x536730(0x1a0)),console[_0x536730(0x18c)]('URL:',this['apiUrl']),console[_0x536730(0x18c)](_0x536730(0x17c),JSON[_0x536730(0x18e)](_0x20c862,null,0x2)),console[_0x536730(0x18c)]('ðŸ‡¬ðŸ‡§\x20Country:\x20'+_0x43448b+_0x536730(0x177)),console[_0x536730(0x18c)](_0x536730(0x17a)),loggerService_1[_0x536730(0x19c)]['logWhiteDomainRequest'](_0x536730(0x1b3),'/v1/hosted/payment_links',_0x536730(0x1d1),_0x20c862);const _0x327859=await fetch(this['apiUrl'],{'method':_0x536730(0x1d1),'headers':{'Content-Type':_0x536730(0x178),'User-Agent':_0x536730(0x1bc)},'body':JSON['stringify'](_0x20c862)}),_0x1c3bfd=Date['now']()-_0x32c809;console[_0x536730(0x18c)](_0x536730(0x15d)),console[_0x536730(0x18c)](_0x536730(0x17e),_0x327859[_0x536730(0x1b6)]),console[_0x536730(0x18c)](_0x536730(0x1a7),_0x327859['statusText']),console[_0x536730(0x18c)](_0x536730(0x189),Object[_0x536730(0x15e)](_0x327859[_0x536730(0x1d2)][_0x536730(0x1ca)]())),console[_0x536730(0x18c)](_0x536730(0x1b1),_0x1c3bfd+'ms');const _0x49ae81=await _0x327859[_0x536730(0x156)]();console['log'](_0x536730(0x15c),_0x49ae81);if(!_0x327859['ok']){console['error'](_0x536730(0x1c8)),console['error'](_0x536730(0x196),_0x327859[_0x536730(0x1b6)]),console[_0x536730(0x16b)]('Response\x20Body:',_0x49ae81),loggerService_1['loggerService'][_0x536730(0x17b)](_0x536730(0x1b3),'/v1/hosted/payment_links',_0x327859['status'],_0x49ae81,_0x1c3bfd),loggerService_1[_0x536730(0x19c)]['logWhiteDomainError']('rapyd','/v1/hosted/payment_links',_0x536730(0x160)+_0x327859[_0x536730(0x1b6)]+':\x20'+_0x49ae81);throw new Error(_0x536730(0x16d)+_0x327859[_0x536730(0x1b6)]+',\x20body:\x20'+_0x49ae81);}let _0x4ffc7f;try{_0x4ffc7f=JSON['parse'](_0x49ae81);}catch(_0x249580){console[_0x536730(0x16b)]('Failed\x20to\x20parse\x20JSON\x20response:',_0x249580),loggerService_1[_0x536730(0x19c)][_0x536730(0x195)]('rapyd',_0x536730(0x1ad),_0x536730(0x197)+_0x249580);throw new Error(_0x536730(0x15a)+_0x49ae81);}console[_0x536730(0x18c)](_0x536730(0x190)),console[_0x536730(0x18c)](_0x536730(0x176),JSON[_0x536730(0x18e)](_0x4ffc7f,null,0x2)),loggerService_1['loggerService'][_0x536730(0x17b)](_0x536730(0x1b3),_0x536730(0x1ad),_0x327859['status'],_0x4ffc7f,_0x1c3bfd);if(_0x4ffc7f[_0x536730(0x1b6)]?.[_0x536730(0x1b6)]!==_0x536730(0x18b)){const _0x2754f8=_0x4ffc7f[_0x536730(0x1b6)]?.['message']||_0x536730(0x16c),_0x45f5f8=_0x4ffc7f[_0x536730(0x1b6)]?.[_0x536730(0x191)]||'UNKNOWN';console[_0x536730(0x16b)](_0x536730(0x1d0)),console['error']('Error\x20Code:',_0x45f5f8),console[_0x536730(0x16b)](_0x536730(0x1cc),_0x2754f8),console[_0x536730(0x16b)](_0x536730(0x175),_0x4ffc7f[_0x536730(0x1b6)]),loggerService_1[_0x536730(0x19c)]['logWhiteDomainError']('rapyd','/v1/hosted/payment_links',_0x536730(0x17d)+_0x45f5f8+_0x536730(0x19f)+_0x2754f8);throw new Error(_0x536730(0x171)+_0x45f5f8+'):\x20'+_0x2754f8);}if(!_0x4ffc7f[_0x536730(0x1cd)]?.['id']||!_0x4ffc7f[_0x536730(0x1cd)]?.['redirect_url']){console['error'](_0x536730(0x19d)),console[_0x536730(0x16b)](_0x536730(0x192)),console[_0x536730(0x16b)](_0x536730(0x18a),_0x4ffc7f[_0x536730(0x1cd)]),loggerService_1[_0x536730(0x19c)][_0x536730(0x195)](_0x536730(0x1b3),_0x536730(0x1ad),_0x536730(0x1ac));throw new Error('Invalid\x20response\x20from\x20Rapyd\x20API:\x20missing\x20id\x20or\x20redirect_url');}return console['log'](_0x536730(0x1da)),console[_0x536730(0x18c)](_0x536730(0x1a6),_0x4ffc7f['data']['id']),console[_0x536730(0x18c)](_0x536730(0x1a9),_0x4ffc7f['data'][_0x536730(0x1c5)]),console[_0x536730(0x18c)](_0x536730(0x1af)+_0x43448b+'\x20(GB\x20-\x20Britain)'),console['log'](_0x536730(0x17a)),{'gateway_payment_id':_0x4ffc7f['data']['id'],'payment_url':_0x4ffc7f[_0x536730(0x1cd)]['redirect_url']};}catch(_0x30cef2){console[_0x536730(0x16b)](_0x536730(0x1c9)),console[_0x536730(0x16b)](_0x536730(0x167),_0x30cef2),loggerService_1['loggerService'][_0x536730(0x195)](_0x536730(0x1b3),_0x536730(0x1ad),_0x30cef2);if(_0x30cef2 instanceof Error){console[_0x536730(0x16b)](_0x536730(0x1a1),_0x30cef2[_0x536730(0x1db)]),console['error'](_0x536730(0x170),_0x30cef2[_0x536730(0x169)]);throw new Error('Failed\x20to\x20create\x20Rapyd\x20payment\x20link:\x20'+_0x30cef2[_0x536730(0x1db)]);}throw new Error(_0x536730(0x19e));}}async['verifyPayment'](_0x12cc02){const _0x2e4e0d=a63_0x48fe09,_0xc4a074=Date[_0x2e4e0d(0x1d7)]();try{loggerService_1[_0x2e4e0d(0x19c)]['logWhiteDomainRequest'](_0x2e4e0d(0x1b3),_0x2e4e0d(0x1aa)+_0x12cc02,'GET',{});const _0x18d2bf=await fetch(this[_0x2e4e0d(0x173)]+'/'+_0x12cc02,{'method':_0x2e4e0d(0x174),'headers':{'Content-Type':_0x2e4e0d(0x178),'User-Agent':_0x2e4e0d(0x1bc)}}),_0x1d0243=Date['now']()-_0xc4a074;if(!_0x18d2bf['ok']){const _0x47b72a=await _0x18d2bf['text']();loggerService_1[_0x2e4e0d(0x19c)][_0x2e4e0d(0x17b)]('rapyd',_0x2e4e0d(0x1aa)+_0x12cc02,_0x18d2bf[_0x2e4e0d(0x1b6)],_0x47b72a,_0x1d0243);throw new Error(_0x2e4e0d(0x16d)+_0x18d2bf['status']);}const _0x225abe=await _0x18d2bf[_0x2e4e0d(0x1b9)]();loggerService_1[_0x2e4e0d(0x19c)]['logWhiteDomainResponse'](_0x2e4e0d(0x1b3),_0x2e4e0d(0x1aa)+_0x12cc02,_0x18d2bf[_0x2e4e0d(0x1b6)],_0x225abe,_0x1d0243);if(_0x225abe['status']?.['status']!==_0x2e4e0d(0x18b)){loggerService_1['loggerService'][_0x2e4e0d(0x195)]('rapyd',_0x2e4e0d(0x1aa)+_0x12cc02,'Rapyd\x20API\x20error:\x20'+(_0x225abe[_0x2e4e0d(0x1b6)]?.[_0x2e4e0d(0x1db)]||_0x2e4e0d(0x166)));throw new Error('Rapyd\x20API\x20error:\x20'+(_0x225abe['status']?.[_0x2e4e0d(0x1db)]||_0x2e4e0d(0x166)));}let _0x31332e=_0x2e4e0d(0x1c1);if(_0x225abe[_0x2e4e0d(0x1cd)]?.[_0x2e4e0d(0x1b6)])switch(_0x225abe[_0x2e4e0d(0x1cd)]['status']['toUpperCase']()){case'CLO':_0x31332e=_0x2e4e0d(0x16a);break;case _0x2e4e0d(0x187):_0x31332e=_0x2e4e0d(0x18d);break;case'EXP':_0x31332e=_0x2e4e0d(0x1ab);break;case _0x2e4e0d(0x1ba):_0x31332e=_0x2e4e0d(0x18d);break;case _0x2e4e0d(0x194):case _0x2e4e0d(0x1b5):default:_0x31332e='PENDING';break;}return{'status':_0x31332e,'amount':_0x225abe[_0x2e4e0d(0x1cd)]?.[_0x2e4e0d(0x17f)],'currency':_0x225abe['data']?.[_0x2e4e0d(0x198)]};}catch(_0x4cb739){console['error'](_0x2e4e0d(0x1d4),_0x4cb739),loggerService_1[_0x2e4e0d(0x19c)][_0x2e4e0d(0x195)](_0x2e4e0d(0x1b3),_0x2e4e0d(0x1aa)+_0x12cc02,_0x4cb739);throw new Error('Failed\x20to\x20verify\x20Rapyd\x20payment:\x20'+(_0x4cb739 instanceof Error?_0x4cb739['message']:'Unknown\x20error'));}}async[a63_0x48fe09(0x19b)](_0x190776){const _0x2e7186=a63_0x48fe09;console['log'](_0x2e7186(0x164),_0x190776);let _0x19ee7a=_0x2e7186(0x1c1),_0x5ab8c0;_0x190776['data']?.['failure_message']&&(_0x5ab8c0=_0x190776[_0x2e7186(0x1cd)][_0x2e7186(0x159)],console[_0x2e7186(0x18c)](_0x2e7186(0x1d3)+_0x5ab8c0));switch(_0x190776[_0x2e7186(0x1b2)]?.['toUpperCase']()){case _0x2e7186(0x1c4):_0x190776[_0x2e7186(0x1cd)]?.[_0x2e7186(0x172)]===!![]&&_0x190776[_0x2e7186(0x1cd)]?.[_0x2e7186(0x1b6)]===_0x2e7186(0x199)?_0x19ee7a=_0x2e7186(0x16a):_0x19ee7a=_0x2e7186(0x1c1);break;case _0x2e7186(0x1cb):_0x19ee7a=_0x2e7186(0x18d);break;case _0x2e7186(0x16f):_0x19ee7a=_0x2e7186(0x1ab);break;case _0x2e7186(0x1d6):_0x19ee7a=_0x2e7186(0x18d);!_0x5ab8c0&&_0x190776[_0x2e7186(0x1cd)]?.[_0x2e7186(0x159)]&&(_0x5ab8c0=_0x190776['data'][_0x2e7186(0x159)]);break;default:switch(_0x190776['data']?.['status']?.[_0x2e7186(0x186)]()){case _0x2e7186(0x199):_0x190776[_0x2e7186(0x1cd)]?.[_0x2e7186(0x172)]===!![]?_0x19ee7a=_0x2e7186(0x16a):_0x19ee7a=_0x2e7186(0x18d);break;case _0x2e7186(0x187):_0x19ee7a=_0x2e7186(0x18d);break;case _0x2e7186(0x163):_0x19ee7a=_0x2e7186(0x1ab);break;case _0x2e7186(0x1ba):_0x19ee7a=_0x2e7186(0x18d);!_0x5ab8c0&&_0x190776[_0x2e7186(0x1cd)]?.['failure_message']&&(_0x5ab8c0=_0x190776[_0x2e7186(0x1cd)]['failure_message']);break;case _0x2e7186(0x194):case _0x2e7186(0x1b5):default:_0x19ee7a='PENDING';break;}break;}const _0x45bf49={};return _0x190776[_0x2e7186(0x1cd)]?.[_0x2e7186(0x158)]?.[_0x2e7186(0x1ae)]&&(_0x45bf49[_0x2e7186(0x1bb)]=_0x190776[_0x2e7186(0x1cd)][_0x2e7186(0x158)][_0x2e7186(0x1ae)]),_0x190776[_0x2e7186(0x1cd)]?.[_0x2e7186(0x1c2)]&&(_0x45bf49[_0x2e7186(0x1a5)]=_0x190776[_0x2e7186(0x1cd)][_0x2e7186(0x1c2)]),_0x190776[_0x2e7186(0x1cd)]?.[_0x2e7186(0x191)]&&(_0x45bf49[_0x2e7186(0x180)]=_0x190776[_0x2e7186(0x1cd)][_0x2e7186(0x191)]),_0x190776[_0x2e7186(0x1cd)]?.['failure_code']&&(_0x45bf49[_0x2e7186(0x162)]=_0x190776[_0x2e7186(0x1cd)]['failure_code']),console[_0x2e7186(0x18c)](_0x2e7186(0x1d5)+_0x19ee7a+',\x20failureMessage='+(_0x5ab8c0||'none')),{'paymentId':_0x190776['data']?.[_0x2e7186(0x16e)]||'','status':_0x19ee7a,'amount':_0x190776[_0x2e7186(0x1cd)]?.['amount'],'currency':_0x190776[_0x2e7186(0x1cd)]?.[_0x2e7186(0x198)],'failureMessage':_0x5ab8c0,'additionalInfo':_0x45bf49};}}exports['RapydService']=RapydService;