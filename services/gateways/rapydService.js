'use strict';const a56_0x3aa0f0=a56_0x5e7a;(function(_0x2b1731,_0x1d6e3b){const _0x5b79ed=a56_0x5e7a,_0xd06cf2=_0x2b1731();while(!![]){try{const _0x475501=-parseInt(_0x5b79ed(0x8e))/0x1+parseInt(_0x5b79ed(0xf0))/0x2+-parseInt(_0x5b79ed(0xe5))/0x3+-parseInt(_0x5b79ed(0xbd))/0x4*(-parseInt(_0x5b79ed(0xdc))/0x5)+-parseInt(_0x5b79ed(0xd4))/0x6+parseInt(_0x5b79ed(0xe8))/0x7*(-parseInt(_0x5b79ed(0x8d))/0x8)+parseInt(_0x5b79ed(0xdd))/0x9;if(_0x475501===_0x1d6e3b)break;else _0xd06cf2['push'](_0xd06cf2['shift']());}catch(_0x58f49e){_0xd06cf2['push'](_0xd06cf2['shift']());}}}(a56_0x3f94,0x6f0c1));function a56_0x5e7a(_0x32dde5,_0x4c08b7){const _0x3f9433=a56_0x3f94();return a56_0x5e7a=function(_0x5e7ac6,_0x442d9a){_0x5e7ac6=_0x5e7ac6-0x82;let _0xdaf89b=_0x3f9433[_0x5e7ac6];return _0xdaf89b;},a56_0x5e7a(_0x32dde5,_0x4c08b7);}Object[a56_0x3aa0f0(0xb6)](exports,a56_0x3aa0f0(0xa2),{'value':!![]}),exports[a56_0x3aa0f0(0xd2)]=void 0x0;function a56_0x3f94(){const _0x53d2a7=['Redirect\x20URL:','===\x20RAPYD\x20SERVICE\x20ERROR\x20===','last4','5719528DFKFuO','364299YGrrHW','Invalid\x20JSON\x20response\x20from\x20Rapyd\x20API:\x20','fromEntries','PAYMENT_CANCELED','apiUrl','===\x20RAPYD\x20SUCCESS\x20===','amount','Incomplete\x20response:\x20missing\x20id\x20or\x20redirect_url','https://tesoft.uk/gateway/rapyd/','verifyPayment','json','===\x20RAPYD\x20API\x20ERROR\x20===','EUR','POST',',\x20failureMessage=','SUCCESS','PAID','🔄\x20Rapyd\x20webhook\x20processed:\x20status=','/v1/hosted/payment_links','\x20\x20\x20fixed_side:\x20buy','__esModule','🌐\x20Rapyd\x20service\x20initialized\x20with\x20white\x20domain\x20proxy','gb_visa_card','log','Status:','Failed\x20to\x20create\x20Rapyd\x20payment\x20link:\x20','Missing\x20id\x20or\x20redirect_url\x20in\x20response','headers','failure_message','entries','logWhiteDomainRequest','../loggerService','Unknown\x20error\x20from\x20Rapyd\x20API','URL:','Raw\x20Response\x20Body:','toISOString','PAYMENT_COMPLETED','PENDING','errorCode','type','defineProperty','toUpperCase','EXPIRED','Full\x20Error\x20Data:','Payment\x20System/1.0','https://tesoft.uk/gateway/success.php?id=','===\x20RAPYD\x20API\x20BUSINESS\x20ERROR\x20===','329180AOaprv','Payment\x20Link\x20ID:','Rapyd\x20payment\x20verification\x20error:','/v1/hosted/payment_links/','):\x20','Rapyd\x20API\x20error:\x20','===\x20RAPYD\x20API\x20RESPONSE\x20(White\x20Domain)\x20===','failureCode','Failed\x20to\x20verify\x20Rapyd\x20payment:\x20','Unknown\x20error','paid','ERR','HTTP\x20Status:','payment_method_type','CAN','logWhiteDomainResponse','now','error','GET','ACT','🇬🇧\x20Using\x20GB\x20(Britain)\x20as\x20country\x20for\x20Rapyd\x20payment\x20link','RapydService','payment_method_data','3847416welwTl','ORDER:\x20','message','===\x20PARSED\x20RAPYD\x20RESPONSE\x20===','\x20(always\x20GB\x20for\x20Rapyd)','stringify','\x20\x20\x20requested_currency:\x20EUR','===\x20RAPYD\x20API\x20INCOMPLETE\x20RESPONSE\x20===','50cJHwTJ','9735291GWyjRp','cardLast4','NEW','EXP','🇬🇧\x20Country\x20used:\x20','logWhiteDomainError','Response\x20Body:','Response\x20data:','1494510PgDPLD','\x20->\x20EUR:','parse','7kgeSQm','data','HTTP\x20','paymentMethod','Error\x20Message:','loggerService','createPaymentLink','🇬🇧\x20Country:\x20','1537692qzElhi','expiration','application/json','Request\x20Body\x20(Updated\x20Format):','Business\x20Error\x20(','processWebhook','error_code','https://tesoft.uk/gateway/fail.php?id=','none','Error\x20message:','\x20\x20\x20expiration:\x20','redirect_url','rapyd','merchant_reference_id','text','💳\x20Payment\x20Methods:\x20gb_visa_card,\x20gb_mastercard_card','\x20(GB\x20-\x20Britain)','CLO','status','currency','Invalid\x20response\x20from\x20Rapyd\x20API:\x20missing\x20id\x20or\x20redirect_url','floor','FAILED'];a56_0x3f94=function(){return _0x53d2a7;};return a56_0x3f94();}const loggerService_1=require(a56_0x3aa0f0(0xad));class RapydService{constructor(){const _0x38d0e0=a56_0x3aa0f0;this[_0x38d0e0(0x92)]=_0x38d0e0(0x96),console['log'](_0x38d0e0(0xa3));}async[a56_0x3aa0f0(0xee)](_0x2c2b5e){const _0x3692b0=a56_0x3aa0f0,{orderId:_0x4b0bac,orderName:_0x4c9677,amount:_0x2efc8a,currency:_0x2926b8,usage:_0x40c3ef,maxPayments:_0x8bd4f6,successUrl:_0x41fa94,failUrl:_0x50ed4d}=_0x2c2b5e,_0x5a6e28=_0x2926b8[_0x3692b0(0xb7)](),_0x4508c5='GB';console[_0x3692b0(0xa5)](_0x3692b0(0xd1));const _0x3fc2f1=_0x3692b0(0xbb)+_0x4b0bac,_0x9de2f7=_0x3692b0(0xf7)+_0x4b0bac,_0x4391aa={'amount':_0x2efc8a,'currency':_0x5a6e28,'cancel_checkout_url':_0x9de2f7,'complete_checkout_url':_0x3fc2f1,'complete_payment_url':_0x3fc2f1,'merchant_reference_id':_0x4b0bac,'description':_0x3692b0(0xd5)+_0x4b0bac,'country':'GB','payment_method_types_include':[_0x3692b0(0xa4),'gb_mastercard_card'],'custom_elements':{'display_description':!![]}};if(_0x5a6e28!==_0x3692b0(0x9a)){const _0x1954af=Math[_0x3692b0(0x88)](Date['now']()/0x3e8)+0x1e*0x3c;_0x4391aa['fixed_side']='buy',_0x4391aa['requested_currency']=_0x3692b0(0x9a),_0x4391aa[_0x3692b0(0xf1)]=_0x1954af,console[_0x3692b0(0xa5)]('💱\x20Adding\x20currency\x20conversion\x20fields\x20for\x20'+_0x5a6e28+_0x3692b0(0xe6)),console[_0x3692b0(0xa5)](_0x3692b0(0xa1)),console[_0x3692b0(0xa5)](_0x3692b0(0xda)),console[_0x3692b0(0xa5)](_0x3692b0(0xfa)+_0x1954af+'\x20('+new Date(_0x1954af*0x3e8)[_0x3692b0(0xb1)]()+')');}const _0x2056a1=Date[_0x3692b0(0xcd)]();try{console['log']('===\x20RAPYD\x20API\x20REQUEST\x20(White\x20Domain\x20-\x20Updated\x20Format)\x20==='),console[_0x3692b0(0xa5)](_0x3692b0(0xaf),this[_0x3692b0(0x92)]),console[_0x3692b0(0xa5)](_0x3692b0(0xf3),JSON[_0x3692b0(0xd9)](_0x4391aa,null,0x2)),console[_0x3692b0(0xa5)](_0x3692b0(0xef)+_0x4508c5+_0x3692b0(0xd8)),console['log'](_0x3692b0(0x82)),loggerService_1[_0x3692b0(0xed)][_0x3692b0(0xac)](_0x3692b0(0xfc),_0x3692b0(0xa0),_0x3692b0(0x9b),_0x4391aa);const _0x4d68cd=await fetch(this[_0x3692b0(0x92)],{'method':'POST','headers':{'Content-Type':'application/json','User-Agent':_0x3692b0(0xba)},'body':JSON[_0x3692b0(0xd9)](_0x4391aa)}),_0x38833f=Date['now']()-_0x2056a1;console[_0x3692b0(0xa5)](_0x3692b0(0xc3)),console[_0x3692b0(0xa5)](_0x3692b0(0xa6),_0x4d68cd[_0x3692b0(0x85)]),console[_0x3692b0(0xa5)]('Status\x20Text:',_0x4d68cd['statusText']),console[_0x3692b0(0xa5)]('Headers:',Object[_0x3692b0(0x90)](_0x4d68cd[_0x3692b0(0xa9)][_0x3692b0(0xab)]())),console[_0x3692b0(0xa5)]('Response\x20Time:',_0x38833f+'ms');const _0x1969c7=await _0x4d68cd[_0x3692b0(0xfe)]();console[_0x3692b0(0xa5)](_0x3692b0(0xb0),_0x1969c7);if(!_0x4d68cd['ok']){console['error'](_0x3692b0(0x99)),console[_0x3692b0(0xce)](_0x3692b0(0xc9),_0x4d68cd['status']),console[_0x3692b0(0xce)](_0x3692b0(0xe3),_0x1969c7),loggerService_1[_0x3692b0(0xed)][_0x3692b0(0xcc)](_0x3692b0(0xfc),_0x3692b0(0xa0),_0x4d68cd['status'],_0x1969c7,_0x38833f),loggerService_1[_0x3692b0(0xed)][_0x3692b0(0xe2)](_0x3692b0(0xfc),_0x3692b0(0xa0),_0x3692b0(0xea)+_0x4d68cd['status']+':\x20'+_0x1969c7);throw new Error('HTTP\x20error!\x20status:\x20'+_0x4d68cd[_0x3692b0(0x85)]+',\x20body:\x20'+_0x1969c7);}let _0x18102a;try{_0x18102a=JSON[_0x3692b0(0xe7)](_0x1969c7);}catch(_0x4f3982){console[_0x3692b0(0xce)]('Failed\x20to\x20parse\x20JSON\x20response:',_0x4f3982),loggerService_1[_0x3692b0(0xed)][_0x3692b0(0xe2)](_0x3692b0(0xfc),_0x3692b0(0xa0),'JSON\x20Parse\x20Error:\x20'+_0x4f3982);throw new Error(_0x3692b0(0x8f)+_0x1969c7);}console[_0x3692b0(0xa5)](_0x3692b0(0xd7)),console['log']('Parsed\x20Result:',JSON[_0x3692b0(0xd9)](_0x18102a,null,0x2)),loggerService_1[_0x3692b0(0xed)][_0x3692b0(0xcc)](_0x3692b0(0xfc),_0x3692b0(0xa0),_0x4d68cd[_0x3692b0(0x85)],_0x18102a,_0x38833f);if(_0x18102a[_0x3692b0(0x85)]?.[_0x3692b0(0x85)]!==_0x3692b0(0x9d)){const _0x32265c=_0x18102a[_0x3692b0(0x85)]?.['message']||_0x3692b0(0xae),_0x1c864f=_0x18102a[_0x3692b0(0x85)]?.[_0x3692b0(0xf6)]||'UNKNOWN';console['error'](_0x3692b0(0xbc)),console[_0x3692b0(0xce)]('Error\x20Code:',_0x1c864f),console[_0x3692b0(0xce)](_0x3692b0(0xec),_0x32265c),console['error'](_0x3692b0(0xb9),_0x18102a[_0x3692b0(0x85)]),loggerService_1['loggerService'][_0x3692b0(0xe2)]('rapyd',_0x3692b0(0xa0),_0x3692b0(0xf4)+_0x1c864f+_0x3692b0(0xc1)+_0x32265c);throw new Error('Rapyd\x20API\x20error\x20('+_0x1c864f+'):\x20'+_0x32265c);}if(!_0x18102a[_0x3692b0(0xe9)]?.['id']||!_0x18102a[_0x3692b0(0xe9)]?.[_0x3692b0(0xfb)]){console[_0x3692b0(0xce)](_0x3692b0(0xdb)),console['error'](_0x3692b0(0xa8)),console[_0x3692b0(0xce)](_0x3692b0(0xe4),_0x18102a[_0x3692b0(0xe9)]),loggerService_1[_0x3692b0(0xed)][_0x3692b0(0xe2)](_0x3692b0(0xfc),_0x3692b0(0xa0),_0x3692b0(0x95));throw new Error(_0x3692b0(0x87));}return console[_0x3692b0(0xa5)](_0x3692b0(0x93)),console[_0x3692b0(0xa5)](_0x3692b0(0xbe),_0x18102a[_0x3692b0(0xe9)]['id']),console[_0x3692b0(0xa5)](_0x3692b0(0x8a),_0x18102a['data'][_0x3692b0(0xfb)]),console[_0x3692b0(0xa5)](_0x3692b0(0xe1)+_0x4508c5+_0x3692b0(0x83)),console[_0x3692b0(0xa5)](_0x3692b0(0x82)),{'gateway_payment_id':_0x18102a[_0x3692b0(0xe9)]['id'],'payment_url':_0x18102a['data'][_0x3692b0(0xfb)]};}catch(_0x125fe6){console[_0x3692b0(0xce)](_0x3692b0(0x8b)),console[_0x3692b0(0xce)]('Error\x20details:',_0x125fe6),loggerService_1[_0x3692b0(0xed)][_0x3692b0(0xe2)](_0x3692b0(0xfc),_0x3692b0(0xa0),_0x125fe6);if(_0x125fe6 instanceof Error){console[_0x3692b0(0xce)](_0x3692b0(0xf9),_0x125fe6[_0x3692b0(0xd6)]),console['error']('Error\x20stack:',_0x125fe6['stack']);throw new Error(_0x3692b0(0xa7)+_0x125fe6[_0x3692b0(0xd6)]);}throw new Error('Failed\x20to\x20create\x20Rapyd\x20payment\x20link:\x20Unknown\x20error');}}async[a56_0x3aa0f0(0x97)](_0x5ce001){const _0x14d109=a56_0x3aa0f0,_0x5d1b7e=Date[_0x14d109(0xcd)]();try{loggerService_1['loggerService'][_0x14d109(0xac)](_0x14d109(0xfc),'/v1/hosted/payment_links/'+_0x5ce001,_0x14d109(0xcf),{});const _0x3c955b=await fetch(this['apiUrl']+'/'+_0x5ce001,{'method':'GET','headers':{'Content-Type':_0x14d109(0xf2),'User-Agent':_0x14d109(0xba)}}),_0x5d9ce2=Date['now']()-_0x5d1b7e;if(!_0x3c955b['ok']){const _0x21c497=await _0x3c955b['text']();loggerService_1[_0x14d109(0xed)][_0x14d109(0xcc)]('rapyd',_0x14d109(0xc0)+_0x5ce001,_0x3c955b[_0x14d109(0x85)],_0x21c497,_0x5d9ce2);throw new Error('HTTP\x20error!\x20status:\x20'+_0x3c955b[_0x14d109(0x85)]);}const _0x411fbd=await _0x3c955b[_0x14d109(0x98)]();loggerService_1[_0x14d109(0xed)][_0x14d109(0xcc)](_0x14d109(0xfc),_0x14d109(0xc0)+_0x5ce001,_0x3c955b[_0x14d109(0x85)],_0x411fbd,_0x5d9ce2);if(_0x411fbd[_0x14d109(0x85)]?.[_0x14d109(0x85)]!==_0x14d109(0x9d)){loggerService_1[_0x14d109(0xed)][_0x14d109(0xe2)](_0x14d109(0xfc),_0x14d109(0xc0)+_0x5ce001,_0x14d109(0xc2)+(_0x411fbd[_0x14d109(0x85)]?.[_0x14d109(0xd6)]||_0x14d109(0xc6)));throw new Error(_0x14d109(0xc2)+(_0x411fbd['status']?.[_0x14d109(0xd6)]||_0x14d109(0xc6)));}let _0x6f7f02=_0x14d109(0xb3);if(_0x411fbd['data']?.[_0x14d109(0x85)])switch(_0x411fbd[_0x14d109(0xe9)][_0x14d109(0x85)][_0x14d109(0xb7)]()){case _0x14d109(0x84):_0x6f7f02=_0x14d109(0x9e);break;case _0x14d109(0xcb):_0x6f7f02=_0x14d109(0x89);break;case _0x14d109(0xe0):_0x6f7f02=_0x14d109(0xb8);break;case _0x14d109(0xc8):_0x6f7f02=_0x14d109(0x89);break;case _0x14d109(0xdf):case _0x14d109(0xd0):default:_0x6f7f02=_0x14d109(0xb3);break;}return{'status':_0x6f7f02,'amount':_0x411fbd[_0x14d109(0xe9)]?.[_0x14d109(0x94)],'currency':_0x411fbd['data']?.[_0x14d109(0x86)]};}catch(_0x2ad0e8){console[_0x14d109(0xce)](_0x14d109(0xbf),_0x2ad0e8),loggerService_1[_0x14d109(0xed)][_0x14d109(0xe2)](_0x14d109(0xfc),'/v1/hosted/payment_links/'+_0x5ce001,_0x2ad0e8);throw new Error(_0x14d109(0xc5)+(_0x2ad0e8 instanceof Error?_0x2ad0e8[_0x14d109(0xd6)]:'Unknown\x20error'));}}async[a56_0x3aa0f0(0xf5)](_0x3aeb63){const _0x11f2a6=a56_0x3aa0f0;console[_0x11f2a6(0xa5)]('Processing\x20Rapyd\x20webhook:',_0x3aeb63);let _0x81c0eb='PENDING',_0x3a27bc;_0x3aeb63['data']?.[_0x11f2a6(0xaa)]&&(_0x3a27bc=_0x3aeb63['data']['failure_message'],console['log']('💥\x20Rapyd\x20failure\x20message:\x20'+_0x3a27bc));switch(_0x3aeb63[_0x11f2a6(0xb5)]?.[_0x11f2a6(0xb7)]()){case _0x11f2a6(0xb2):_0x3aeb63[_0x11f2a6(0xe9)]?.[_0x11f2a6(0xc7)]===!![]&&_0x3aeb63[_0x11f2a6(0xe9)]?.['status']===_0x11f2a6(0x84)?_0x81c0eb=_0x11f2a6(0x9e):_0x81c0eb=_0x11f2a6(0xb3);break;case _0x11f2a6(0x91):_0x81c0eb=_0x11f2a6(0x89);break;case'PAYMENT_EXPIRED':_0x81c0eb=_0x11f2a6(0xb8);break;case'PAYMENT_FAILED':_0x81c0eb=_0x11f2a6(0x89);!_0x3a27bc&&_0x3aeb63['data']?.[_0x11f2a6(0xaa)]&&(_0x3a27bc=_0x3aeb63[_0x11f2a6(0xe9)][_0x11f2a6(0xaa)]);break;default:switch(_0x3aeb63['data']?.[_0x11f2a6(0x85)]?.['toUpperCase']()){case _0x11f2a6(0x84):_0x3aeb63['data']?.[_0x11f2a6(0xc7)]===!![]?_0x81c0eb=_0x11f2a6(0x9e):_0x81c0eb=_0x11f2a6(0x89);break;case _0x11f2a6(0xcb):_0x81c0eb=_0x11f2a6(0x89);break;case _0x11f2a6(0xe0):_0x81c0eb=_0x11f2a6(0xb8);break;case _0x11f2a6(0xc8):_0x81c0eb='FAILED';!_0x3a27bc&&_0x3aeb63[_0x11f2a6(0xe9)]?.[_0x11f2a6(0xaa)]&&(_0x3a27bc=_0x3aeb63['data']['failure_message']);break;case _0x11f2a6(0xdf):case _0x11f2a6(0xd0):default:_0x81c0eb=_0x11f2a6(0xb3);break;}break;}const _0x58bf63={};return _0x3aeb63[_0x11f2a6(0xe9)]?.[_0x11f2a6(0xd3)]?.['last4']&&(_0x58bf63[_0x11f2a6(0xde)]=_0x3aeb63['data'][_0x11f2a6(0xd3)][_0x11f2a6(0x8c)]),_0x3aeb63[_0x11f2a6(0xe9)]?.[_0x11f2a6(0xca)]&&(_0x58bf63[_0x11f2a6(0xeb)]=_0x3aeb63['data'][_0x11f2a6(0xca)]),_0x3aeb63[_0x11f2a6(0xe9)]?.['error_code']&&(_0x58bf63[_0x11f2a6(0xb4)]=_0x3aeb63[_0x11f2a6(0xe9)][_0x11f2a6(0xf6)]),_0x3aeb63[_0x11f2a6(0xe9)]?.['failure_code']&&(_0x58bf63[_0x11f2a6(0xc4)]=_0x3aeb63[_0x11f2a6(0xe9)]['failure_code']),console[_0x11f2a6(0xa5)](_0x11f2a6(0x9f)+_0x81c0eb+_0x11f2a6(0x9c)+(_0x3a27bc||_0x11f2a6(0xf8))),{'paymentId':_0x3aeb63[_0x11f2a6(0xe9)]?.[_0x11f2a6(0xfd)]||'','status':_0x81c0eb,'amount':_0x3aeb63[_0x11f2a6(0xe9)]?.[_0x11f2a6(0x94)],'currency':_0x3aeb63[_0x11f2a6(0xe9)]?.[_0x11f2a6(0x86)],'failureMessage':_0x3a27bc,'additionalInfo':_0x58bf63};}}exports[a56_0x3aa0f0(0xd2)]=RapydService;