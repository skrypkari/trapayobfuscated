'use strict';function a56_0x4735(){const _0x47c311=['HTTP\x20error!\x20status:\x20','Rapyd\x20payment\x20verification\x20error:','Status\x20Text:','):\x20','paymentMethod','Response\x20Body:','error','https://tesoft.uk/gateway/success.php?id=','failure_code','CLO','EXP','PAYMENT_FAILED','../loggerService','/v1/hosted/payment_links/','toUpperCase','failureCode','failure_message','HTTP\x20','RapydService','\x20\x20\x20requested_currency:\x20EUR','buy','UNKNOWN','\x20(GB\x20-\x20Britain)','rapyd','type','Error\x20details:','https://tesoft.uk/gateway/rapyd/','status','Error\x20Message:','Unknown\x20error\x20from\x20Rapyd\x20API','error_code','NEW','6146605VtDwUQ','redirect_url','===\x20RAPYD\x20API\x20REQUEST\x20(White\x20Domain\x20-\x20Updated\x20Format)\x20===','Rapyd\x20API\x20error:\x20','processWebhook','Request\x20Body\x20(Updated\x20Format):','payment_method_type','\x20(always\x20GB\x20for\x20Rapyd)','log','\x20\x20\x20expiration:\x20','ERR','===\x20RAPYD\x20SERVICE\x20ERROR\x20===','Failed\x20to\x20parse\x20JSON\x20response:','SUCCESS','22561AqdoYW','Status:','Error\x20message:','Full\x20Error\x20Data:','Incomplete\x20response:\x20missing\x20id\x20or\x20redirect_url','fixed_side','50590FGGUXZ','__esModule','Payment\x20System/1.0','Headers:','3688CuHpDp','PAYMENT_EXPIRED','json','🇬🇧\x20Country:\x20','Failed\x20to\x20verify\x20Rapyd\x20payment:\x20','text','/v1/hosted/payment_links','===\x20RAPYD\x20API\x20BUSINESS\x20ERROR\x20===','errorCode','floor','Processing\x20Rapyd\x20webhook:','POST','EXPIRED','GET','FAILED','stack','statusText','Unknown\x20error','data','gb_visa_card','3198552BLjEHC','logWhiteDomainRequest','🌐\x20Rapyd\x20service\x20initialized\x20with\x20white\x20domain\x20proxy','💳\x20Payment\x20Methods:\x20gb_visa_card,\x20gb_mastercard_card','🔄\x20Rapyd\x20webhook\x20processed:\x20status=','loggerService','message','PAYMENT_COMPLETED','Rapyd\x20API\x20error\x20(','requested_currency','===\x20PARSED\x20RAPYD\x20RESPONSE\x20===','https://tesoft.uk/gateway/fail.php?id=',',\x20body:\x20','PENDING','Invalid\x20JSON\x20response\x20from\x20Rapyd\x20API:\x20','apiUrl','Error\x20Code:','paid','payment_method_data','🇬🇧\x20Using\x20GB\x20(Britain)\x20as\x20country\x20for\x20Rapyd\x20payment\x20link','toISOString','EUR','Invalid\x20response\x20from\x20Rapyd\x20API:\x20missing\x20id\x20or\x20redirect_url','Response\x20Time:','69pordna','ORDER:\x20','application/json','CAN','💱\x20Adding\x20currency\x20conversion\x20fields\x20for\x20','💥\x20Rapyd\x20failure\x20message:\x20','last4','PAID','27876744vOncmN','516156bIakHJ','Response\x20data:','===\x20RAPYD\x20API\x20RESPONSE\x20(White\x20Domain)\x20===','===\x20RAPYD\x20API\x20INCOMPLETE\x20RESPONSE\x20===','none','Missing\x20id\x20or\x20redirect_url\x20in\x20response','===\x20RAPYD\x20SUCCESS\x20===','now','logWhiteDomainResponse','amount','Failed\x20to\x20create\x20Rapyd\x20payment\x20link:\x20','logWhiteDomainError','\x20\x20\x20fixed_side:\x20buy','1722282IFVDIV','headers','stringify'];a56_0x4735=function(){return _0x47c311;};return a56_0x4735();}const a56_0x51bcbb=a56_0x1136;(function(_0x3a8b5e,_0x2058f9){const _0x26e67a=a56_0x1136,_0x43df2a=_0x3a8b5e();while(!![]){try{const _0x3a3316=-parseInt(_0x26e67a(0x1eb))/0x1+parseInt(_0x26e67a(0x1a5))/0x2*(-parseInt(_0x26e67a(0x1d5))/0x3)+-parseInt(_0x26e67a(0x1de))/0x4+parseInt(_0x26e67a(0x191))/0x5+parseInt(_0x26e67a(0x1bd))/0x6+parseInt(_0x26e67a(0x19f))/0x7*(-parseInt(_0x26e67a(0x1a9))/0x8)+parseInt(_0x26e67a(0x1dd))/0x9;if(_0x3a3316===_0x2058f9)break;else _0x43df2a['push'](_0x43df2a['shift']());}catch(_0x5cb1cd){_0x43df2a['push'](_0x43df2a['shift']());}}}(a56_0x4735,0xe5b78));Object['defineProperty'](exports,a56_0x51bcbb(0x1a6),{'value':!![]}),exports[a56_0x51bcbb(0x183)]=void 0x0;const loggerService_1=require(a56_0x51bcbb(0x17d));class RapydService{constructor(){const _0x4833a9=a56_0x51bcbb;this[_0x4833a9(0x1cc)]=_0x4833a9(0x18b),console[_0x4833a9(0x199)](_0x4833a9(0x1bf));}async['createPaymentLink'](_0x4e46ee){const _0x384ce8=a56_0x51bcbb,{orderId:_0xaddf4a,orderName:_0x5d92bb,amount:_0x2374e4,currency:_0x4ecd84,usage:_0xaacb83,maxPayments:_0x335ae3,successUrl:_0x4afb5b,failUrl:_0xc3b195}=_0x4e46ee,_0x3649a6=_0x4ecd84[_0x384ce8(0x17f)](),_0x5c85bc='GB';console[_0x384ce8(0x199)](_0x384ce8(0x1d0));const _0x252940=_0x384ce8(0x178)+_0xaddf4a,_0x462ae8=_0x384ce8(0x1c8)+_0xaddf4a,_0x4b823f={'amount':_0x2374e4,'currency':_0x3649a6,'cancel_checkout_url':_0x462ae8,'complete_checkout_url':_0x252940,'complete_payment_url':_0x252940,'merchant_reference_id':_0xaddf4a,'description':_0x384ce8(0x1d6)+_0xaddf4a,'country':'GB','payment_method_types_include':[_0x384ce8(0x1bc),'gb_mastercard_card'],'custom_elements':{'display_description':!![]}};if(_0x3649a6!==_0x384ce8(0x1d2)){const _0x41aed3=Math[_0x384ce8(0x1b2)](Date[_0x384ce8(0x1e5)]()/0x3e8)+0x1e*0x3c;_0x4b823f[_0x384ce8(0x1a4)]=_0x384ce8(0x185),_0x4b823f[_0x384ce8(0x1c6)]='EUR',_0x4b823f['expiration']=_0x41aed3,console['log'](_0x384ce8(0x1d9)+_0x3649a6+'\x20->\x20EUR:'),console[_0x384ce8(0x199)](_0x384ce8(0x1ea)),console['log'](_0x384ce8(0x184)),console['log'](_0x384ce8(0x19a)+_0x41aed3+'\x20('+new Date(_0x41aed3*0x3e8)[_0x384ce8(0x1d1)]()+')');}const _0x2685c8=Date[_0x384ce8(0x1e5)]();try{console[_0x384ce8(0x199)](_0x384ce8(0x193)),console[_0x384ce8(0x199)]('URL:',this['apiUrl']),console['log'](_0x384ce8(0x196),JSON[_0x384ce8(0x1ed)](_0x4b823f,null,0x2)),console[_0x384ce8(0x199)](_0x384ce8(0x1ac)+_0x5c85bc+_0x384ce8(0x198)),console[_0x384ce8(0x199)](_0x384ce8(0x1c0)),loggerService_1[_0x384ce8(0x1c2)][_0x384ce8(0x1be)](_0x384ce8(0x188),_0x384ce8(0x1af),_0x384ce8(0x1b4),_0x4b823f);const _0x29603d=await fetch(this[_0x384ce8(0x1cc)],{'method':_0x384ce8(0x1b4),'headers':{'Content-Type':'application/json','User-Agent':_0x384ce8(0x1a7)},'body':JSON[_0x384ce8(0x1ed)](_0x4b823f)}),_0x55f6da=Date[_0x384ce8(0x1e5)]()-_0x2685c8;console[_0x384ce8(0x199)](_0x384ce8(0x1e0)),console[_0x384ce8(0x199)](_0x384ce8(0x1a0),_0x29603d['status']),console[_0x384ce8(0x199)](_0x384ce8(0x1f0),_0x29603d[_0x384ce8(0x1b9)]),console[_0x384ce8(0x199)](_0x384ce8(0x1a8),Object['fromEntries'](_0x29603d[_0x384ce8(0x1ec)]['entries']())),console[_0x384ce8(0x199)](_0x384ce8(0x1d4),_0x55f6da+'ms');const _0x1e3052=await _0x29603d[_0x384ce8(0x1ae)]();console[_0x384ce8(0x199)]('Raw\x20Response\x20Body:',_0x1e3052);if(!_0x29603d['ok']){console[_0x384ce8(0x177)]('===\x20RAPYD\x20API\x20ERROR\x20==='),console[_0x384ce8(0x177)]('HTTP\x20Status:',_0x29603d[_0x384ce8(0x18c)]),console[_0x384ce8(0x177)](_0x384ce8(0x1f3),_0x1e3052),loggerService_1[_0x384ce8(0x1c2)][_0x384ce8(0x1e6)]('rapyd',_0x384ce8(0x1af),_0x29603d[_0x384ce8(0x18c)],_0x1e3052,_0x55f6da),loggerService_1[_0x384ce8(0x1c2)][_0x384ce8(0x1e9)](_0x384ce8(0x188),_0x384ce8(0x1af),_0x384ce8(0x182)+_0x29603d[_0x384ce8(0x18c)]+':\x20'+_0x1e3052);throw new Error(_0x384ce8(0x1ee)+_0x29603d[_0x384ce8(0x18c)]+_0x384ce8(0x1c9)+_0x1e3052);}let _0x35ca56;try{_0x35ca56=JSON['parse'](_0x1e3052);}catch(_0x5db3c2){console[_0x384ce8(0x177)](_0x384ce8(0x19d),_0x5db3c2),loggerService_1[_0x384ce8(0x1c2)][_0x384ce8(0x1e9)](_0x384ce8(0x188),'/v1/hosted/payment_links','JSON\x20Parse\x20Error:\x20'+_0x5db3c2);throw new Error(_0x384ce8(0x1cb)+_0x1e3052);}console[_0x384ce8(0x199)](_0x384ce8(0x1c7)),console['log']('Parsed\x20Result:',JSON['stringify'](_0x35ca56,null,0x2)),loggerService_1[_0x384ce8(0x1c2)][_0x384ce8(0x1e6)](_0x384ce8(0x188),_0x384ce8(0x1af),_0x29603d[_0x384ce8(0x18c)],_0x35ca56,_0x55f6da);if(_0x35ca56[_0x384ce8(0x18c)]?.[_0x384ce8(0x18c)]!==_0x384ce8(0x19e)){const _0x1de1a0=_0x35ca56[_0x384ce8(0x18c)]?.[_0x384ce8(0x1c3)]||_0x384ce8(0x18e),_0x35381a=_0x35ca56[_0x384ce8(0x18c)]?.[_0x384ce8(0x18f)]||_0x384ce8(0x186);console[_0x384ce8(0x177)](_0x384ce8(0x1b0)),console[_0x384ce8(0x177)](_0x384ce8(0x1cd),_0x35381a),console['error'](_0x384ce8(0x18d),_0x1de1a0),console[_0x384ce8(0x177)](_0x384ce8(0x1a2),_0x35ca56['status']),loggerService_1[_0x384ce8(0x1c2)][_0x384ce8(0x1e9)](_0x384ce8(0x188),_0x384ce8(0x1af),'Business\x20Error\x20('+_0x35381a+_0x384ce8(0x1f1)+_0x1de1a0);throw new Error(_0x384ce8(0x1c5)+_0x35381a+_0x384ce8(0x1f1)+_0x1de1a0);}if(!_0x35ca56[_0x384ce8(0x1bb)]?.['id']||!_0x35ca56[_0x384ce8(0x1bb)]?.['redirect_url']){console[_0x384ce8(0x177)](_0x384ce8(0x1e1)),console[_0x384ce8(0x177)](_0x384ce8(0x1e3)),console[_0x384ce8(0x177)](_0x384ce8(0x1df),_0x35ca56[_0x384ce8(0x1bb)]),loggerService_1[_0x384ce8(0x1c2)][_0x384ce8(0x1e9)](_0x384ce8(0x188),_0x384ce8(0x1af),_0x384ce8(0x1a3));throw new Error(_0x384ce8(0x1d3));}return console['log'](_0x384ce8(0x1e4)),console[_0x384ce8(0x199)]('Payment\x20Link\x20ID:',_0x35ca56[_0x384ce8(0x1bb)]['id']),console[_0x384ce8(0x199)]('Redirect\x20URL:',_0x35ca56[_0x384ce8(0x1bb)]['redirect_url']),console['log']('🇬🇧\x20Country\x20used:\x20'+_0x5c85bc+_0x384ce8(0x187)),console[_0x384ce8(0x199)](_0x384ce8(0x1c0)),{'gateway_payment_id':_0x35ca56[_0x384ce8(0x1bb)]['id'],'payment_url':_0x35ca56[_0x384ce8(0x1bb)][_0x384ce8(0x192)]};}catch(_0x4eedc3){console[_0x384ce8(0x177)](_0x384ce8(0x19c)),console[_0x384ce8(0x177)](_0x384ce8(0x18a),_0x4eedc3),loggerService_1[_0x384ce8(0x1c2)]['logWhiteDomainError'](_0x384ce8(0x188),_0x384ce8(0x1af),_0x4eedc3);if(_0x4eedc3 instanceof Error){console[_0x384ce8(0x177)](_0x384ce8(0x1a1),_0x4eedc3[_0x384ce8(0x1c3)]),console[_0x384ce8(0x177)]('Error\x20stack:',_0x4eedc3[_0x384ce8(0x1b8)]);throw new Error(_0x384ce8(0x1e8)+_0x4eedc3[_0x384ce8(0x1c3)]);}throw new Error('Failed\x20to\x20create\x20Rapyd\x20payment\x20link:\x20Unknown\x20error');}}async['verifyPayment'](_0x741541){const _0xa04360=a56_0x51bcbb,_0x5f105b=Date[_0xa04360(0x1e5)]();try{loggerService_1[_0xa04360(0x1c2)][_0xa04360(0x1be)]('rapyd',_0xa04360(0x17e)+_0x741541,_0xa04360(0x1b6),{});const _0x19c7b5=await fetch(this[_0xa04360(0x1cc)]+'/'+_0x741541,{'method':'GET','headers':{'Content-Type':_0xa04360(0x1d7),'User-Agent':_0xa04360(0x1a7)}}),_0x2faf24=Date[_0xa04360(0x1e5)]()-_0x5f105b;if(!_0x19c7b5['ok']){const _0x2c7b76=await _0x19c7b5['text']();loggerService_1[_0xa04360(0x1c2)][_0xa04360(0x1e6)](_0xa04360(0x188),'/v1/hosted/payment_links/'+_0x741541,_0x19c7b5['status'],_0x2c7b76,_0x2faf24);throw new Error(_0xa04360(0x1ee)+_0x19c7b5[_0xa04360(0x18c)]);}const _0x241fe8=await _0x19c7b5[_0xa04360(0x1ab)]();loggerService_1[_0xa04360(0x1c2)]['logWhiteDomainResponse'](_0xa04360(0x188),_0xa04360(0x17e)+_0x741541,_0x19c7b5[_0xa04360(0x18c)],_0x241fe8,_0x2faf24);if(_0x241fe8[_0xa04360(0x18c)]?.['status']!==_0xa04360(0x19e)){loggerService_1[_0xa04360(0x1c2)][_0xa04360(0x1e9)](_0xa04360(0x188),_0xa04360(0x17e)+_0x741541,_0xa04360(0x194)+(_0x241fe8[_0xa04360(0x18c)]?.[_0xa04360(0x1c3)]||'Unknown\x20error'));throw new Error(_0xa04360(0x194)+(_0x241fe8[_0xa04360(0x18c)]?.[_0xa04360(0x1c3)]||_0xa04360(0x1ba)));}let _0x5439ff='PENDING';if(_0x241fe8[_0xa04360(0x1bb)]?.[_0xa04360(0x18c)])switch(_0x241fe8[_0xa04360(0x1bb)][_0xa04360(0x18c)]['toUpperCase']()){case _0xa04360(0x17a):_0x5439ff=_0xa04360(0x1dc);break;case'CAN':_0x5439ff=_0xa04360(0x1b7);break;case _0xa04360(0x17b):_0x5439ff=_0xa04360(0x1b5);break;case _0xa04360(0x19b):_0x5439ff='FAILED';break;case'NEW':case'ACT':default:_0x5439ff=_0xa04360(0x1ca);break;}return{'status':_0x5439ff,'amount':_0x241fe8['data']?.[_0xa04360(0x1e7)],'currency':_0x241fe8[_0xa04360(0x1bb)]?.['currency']};}catch(_0x5df4a7){console[_0xa04360(0x177)](_0xa04360(0x1ef),_0x5df4a7),loggerService_1[_0xa04360(0x1c2)]['logWhiteDomainError']('rapyd','/v1/hosted/payment_links/'+_0x741541,_0x5df4a7);throw new Error(_0xa04360(0x1ad)+(_0x5df4a7 instanceof Error?_0x5df4a7[_0xa04360(0x1c3)]:_0xa04360(0x1ba)));}}async[a56_0x51bcbb(0x195)](_0x1f402c){const _0x3cc459=a56_0x51bcbb;console['log'](_0x3cc459(0x1b3),_0x1f402c);let _0x564bc3='PENDING',_0x12ae93;_0x1f402c[_0x3cc459(0x1bb)]?.[_0x3cc459(0x181)]&&(_0x12ae93=_0x1f402c[_0x3cc459(0x1bb)]['failure_message'],console[_0x3cc459(0x199)](_0x3cc459(0x1da)+_0x12ae93));switch(_0x1f402c[_0x3cc459(0x189)]?.['toUpperCase']()){case _0x3cc459(0x1c4):_0x1f402c[_0x3cc459(0x1bb)]?.[_0x3cc459(0x1ce)]===!![]&&_0x1f402c[_0x3cc459(0x1bb)]?.[_0x3cc459(0x18c)]==='CLO'?_0x564bc3=_0x3cc459(0x1dc):_0x564bc3=_0x3cc459(0x1ca);break;case'PAYMENT_CANCELED':_0x564bc3='FAILED';break;case _0x3cc459(0x1aa):_0x564bc3=_0x3cc459(0x1b5);break;case _0x3cc459(0x17c):_0x564bc3='FAILED';!_0x12ae93&&_0x1f402c[_0x3cc459(0x1bb)]?.[_0x3cc459(0x181)]&&(_0x12ae93=_0x1f402c[_0x3cc459(0x1bb)][_0x3cc459(0x181)]);break;default:switch(_0x1f402c[_0x3cc459(0x1bb)]?.[_0x3cc459(0x18c)]?.['toUpperCase']()){case'CLO':_0x1f402c[_0x3cc459(0x1bb)]?.[_0x3cc459(0x1ce)]===!![]?_0x564bc3=_0x3cc459(0x1dc):_0x564bc3=_0x3cc459(0x1b7);break;case _0x3cc459(0x1d8):_0x564bc3='FAILED';break;case'EXP':_0x564bc3=_0x3cc459(0x1b5);break;case _0x3cc459(0x19b):_0x564bc3=_0x3cc459(0x1b7);!_0x12ae93&&_0x1f402c[_0x3cc459(0x1bb)]?.['failure_message']&&(_0x12ae93=_0x1f402c[_0x3cc459(0x1bb)][_0x3cc459(0x181)]);break;case _0x3cc459(0x190):case'ACT':default:_0x564bc3='PENDING';break;}break;}const _0x4c0545={};return _0x1f402c[_0x3cc459(0x1bb)]?.['payment_method_data']?.['last4']&&(_0x4c0545['cardLast4']=_0x1f402c['data'][_0x3cc459(0x1cf)][_0x3cc459(0x1db)]),_0x1f402c[_0x3cc459(0x1bb)]?.['payment_method_type']&&(_0x4c0545[_0x3cc459(0x1f2)]=_0x1f402c['data'][_0x3cc459(0x197)]),_0x1f402c['data']?.[_0x3cc459(0x18f)]&&(_0x4c0545[_0x3cc459(0x1b1)]=_0x1f402c[_0x3cc459(0x1bb)][_0x3cc459(0x18f)]),_0x1f402c['data']?.['failure_code']&&(_0x4c0545[_0x3cc459(0x180)]=_0x1f402c['data'][_0x3cc459(0x179)]),console[_0x3cc459(0x199)](_0x3cc459(0x1c1)+_0x564bc3+',\x20failureMessage='+(_0x12ae93||_0x3cc459(0x1e2))),{'paymentId':_0x1f402c[_0x3cc459(0x1bb)]?.['merchant_reference_id']||'','status':_0x564bc3,'amount':_0x1f402c[_0x3cc459(0x1bb)]?.[_0x3cc459(0x1e7)],'currency':_0x1f402c[_0x3cc459(0x1bb)]?.['currency'],'failureMessage':_0x12ae93,'additionalInfo':_0x4c0545};}}function a56_0x1136(_0x4cfbff,_0x15d9f4){const _0x4735a8=a56_0x4735();return a56_0x1136=function(_0x11363f,_0x26f1ef){_0x11363f=_0x11363f-0x177;let _0x5547cf=_0x4735a8[_0x11363f];return _0x5547cf;},a56_0x1136(_0x4cfbff,_0x15d9f4);}exports['RapydService']=RapydService;