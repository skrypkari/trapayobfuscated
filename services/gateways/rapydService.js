'use strict';const a52_0x5f25b9=a52_0x5c68;(function(_0x571cc8,_0xd96e69){const _0x3d71b3=a52_0x5c68,_0x267cd5=_0x571cc8();while(!![]){try{const _0x42ac54=-parseInt(_0x3d71b3(0x1b9))/0x1+parseInt(_0x3d71b3(0x1f2))/0x2+-parseInt(_0x3d71b3(0x1ae))/0x3+-parseInt(_0x3d71b3(0x1c4))/0x4*(-parseInt(_0x3d71b3(0x1be))/0x5)+-parseInt(_0x3d71b3(0x1b5))/0x6*(-parseInt(_0x3d71b3(0x1b7))/0x7)+parseInt(_0x3d71b3(0x21b))/0x8*(parseInt(_0x3d71b3(0x1ac))/0x9)+parseInt(_0x3d71b3(0x1e7))/0xa*(parseInt(_0x3d71b3(0x1d5))/0xb);if(_0x42ac54===_0xd96e69)break;else _0x267cd5['push'](_0x267cd5['shift']());}catch(_0x55ee0d){_0x267cd5['push'](_0x267cd5['shift']());}}}(a52_0x4843,0x92edb));function a52_0x5c68(_0x5c5932,_0x4d4371){const _0x484376=a52_0x4843();return a52_0x5c68=function(_0x5c685c,_0x4a9629){_0x5c685c=_0x5c685c-0x1a5;let _0x30235e=_0x484376[_0x5c685c];return _0x30235e;},a52_0x5c68(_0x5c5932,_0x4d4371);}Object[a52_0x5f25b9(0x1bc)](exports,a52_0x5f25b9(0x202),{'value':!![]}),exports['RapydService']=void 0x0;function a52_0x4843(){const _0x5f387c=['\x20\x20\x20requested_currency:\x20EUR','paid','failureCode','amount','🇬🇧\x20Country\x20used:\x20','error_code','text','Headers:','💳\x20Payment\x20Methods:\x20gb_visa_card,\x20gb_mastercard_card','431387LERavn','GET','logWhiteDomainRequest','POST','🇬🇧\x20Country:\x20','Rapyd\x20API\x20error:\x20','processWebhook','log','Failed\x20to\x20parse\x20JSON\x20response:','ACT','SUCCESS','payment_method_type','HTTP\x20Status:','payment_method_data','Invalid\x20response\x20from\x20Rapyd\x20API:\x20missing\x20id\x20or\x20redirect_url','Business\x20Error\x20(','Invalid\x20JSON\x20response\x20from\x20Rapyd\x20API:\x20','===\x20PARSED\x20RAPYD\x20RESPONSE\x20===','90GTAbHl','===\x20RAPYD\x20API\x20REQUEST\x20(White\x20Domain\x20-\x20Updated\x20Format)\x20===','application/json','Missing\x20id\x20or\x20redirect_url\x20in\x20response','toISOString','Failed\x20to\x20create\x20Rapyd\x20payment\x20link:\x20Unknown\x20error','entries','\x20(GB\x20-\x20Britain)','===\x20RAPYD\x20SUCCESS\x20===','PAYMENT_CANCELED','PAYMENT_EXPIRED','1299800tRFDGk','Error\x20Code:','createPaymentLink','ERR','buy','apiUrl','Status\x20Text:','failure_code','===\x20RAPYD\x20API\x20INCOMPLETE\x20RESPONSE\x20===','fixed_side','Payment\x20Link\x20ID:','Error\x20Message:','../loggerService','Error\x20stack:','Status:','🇬🇧\x20Using\x20GB\x20(Britain)\x20as\x20country\x20for\x20Rapyd\x20payment\x20link','__esModule','CAN','Error\x20details:','https://tesoft.uk/gateway/fail.php?id=','Unknown\x20error','/v1/hosted/payment_links/','Failed\x20to\x20verify\x20Rapyd\x20payment:\x20','currency','floor','stringify','PAYMENT_COMPLETED','EXPIRED','error','===\x20RAPYD\x20API\x20ERROR\x20===','===\x20RAPYD\x20API\x20RESPONSE\x20(White\x20Domain)\x20===','):\x20','💥\x20Rapyd\x20failure\x20message:\x20','expiration','type','🌐\x20Rapyd\x20service\x20initialized\x20with\x20white\x20domain\x20proxy','failure_message','message','💱\x20Adding\x20currency\x20conversion\x20fields\x20for\x20','ORDER:\x20','rapyd','56312UoWNta','toUpperCase','now','\x20->\x20EUR:','Processing\x20Rapyd\x20webhook:','Redirect\x20URL:','last4','redirect_url','JSON\x20Parse\x20Error:\x20','Incomplete\x20response:\x20missing\x20id\x20or\x20redirect_url','Rapyd\x20API\x20error\x20(','\x20\x20\x20expiration:\x20','statusText','TesSoft\x20Payment\x20System/1.0','Response\x20Body:','cardLast4','HTTP\x20','===\x20RAPYD\x20API\x20BUSINESS\x20ERROR\x20===',',\x20failureMessage=','Raw\x20Response\x20Body:','logWhiteDomainError','gb_visa_card','data','requested_currency','PAID','logWhiteDomainResponse','paymentMethod','1314yCfwpD','\x20\x20\x20fixed_side:\x20buy','1949214ulqOsa','status','Parsed\x20Result:','HTTP\x20error!\x20status:\x20','none',',\x20body:\x20','gb_mastercard_card','4812XXvPWW','Response\x20data:','343ATJNLd','===\x20RAPYD\x20SERVICE\x20ERROR\x20===','974998saaxvP','EUR','FAILED','defineProperty','/v1/hosted/payment_links','5letXqI','headers','errorCode','Failed\x20to\x20create\x20Rapyd\x20payment\x20link:\x20','merchant_reference_id','PENDING','626840SfLsPR','loggerService','URL:','CLO','Full\x20Error\x20Data:','NEW','Request\x20Body\x20(Updated\x20Format):','json'];a52_0x4843=function(){return _0x5f387c;};return a52_0x4843();}const loggerService_1=require(a52_0x5f25b9(0x1fe));class RapydService{constructor(){const _0x3a42a9=a52_0x5f25b9;this[_0x3a42a9(0x1f7)]='https://tesoft.uk/gateway/rapyd/',console[_0x3a42a9(0x1dc)](_0x3a42a9(0x215));}async[a52_0x5f25b9(0x1f4)](_0x2780ea){const _0x2930b9=a52_0x5f25b9,{orderId:_0x35cd53,orderName:_0x1f30ab,amount:_0x21941d,currency:_0x1c0912,usage:_0x256647,maxPayments:_0x3b979f,successUrl:_0x3664d7,failUrl:_0x1de23c}=_0x2780ea,_0x2daf9d=_0x1c0912['toUpperCase'](),_0x11b0dd='GB';console['log'](_0x2930b9(0x201));const _0x1815a2='https://tesoft.uk/gateway/success.php?id='+_0x35cd53,_0x1c6f85=_0x2930b9(0x205)+_0x35cd53,_0x515688={'amount':_0x21941d,'currency':_0x2daf9d,'cancel_checkout_url':_0x1c6f85,'complete_checkout_url':_0x1815a2,'complete_payment_url':_0x1815a2,'merchant_reference_id':_0x35cd53,'description':_0x2930b9(0x219)+_0x35cd53,'country':'GB','payment_method_types_include':[_0x2930b9(0x1a6),_0x2930b9(0x1b4)],'custom_elements':{'display_description':!![]}};if(_0x2daf9d!==_0x2930b9(0x1ba)){const _0xd7a400=Math[_0x2930b9(0x20a)](Date[_0x2930b9(0x21d)]()/0x3e8)+0x1e*0x3c;_0x515688[_0x2930b9(0x1fb)]=_0x2930b9(0x1f6),_0x515688[_0x2930b9(0x1a8)]='EUR',_0x515688[_0x2930b9(0x213)]=_0xd7a400,console[_0x2930b9(0x1dc)](_0x2930b9(0x218)+_0x2daf9d+_0x2930b9(0x21e)),console[_0x2930b9(0x1dc)](_0x2930b9(0x1ad)),console[_0x2930b9(0x1dc)](_0x2930b9(0x1cc)),console[_0x2930b9(0x1dc)](_0x2930b9(0x226)+_0xd7a400+'\x20('+new Date(_0xd7a400*0x3e8)[_0x2930b9(0x1eb)]()+')');}const _0x267025=Date[_0x2930b9(0x21d)]();try{console[_0x2930b9(0x1dc)](_0x2930b9(0x1e8)),console['log'](_0x2930b9(0x1c6),this[_0x2930b9(0x1f7)]),console[_0x2930b9(0x1dc)](_0x2930b9(0x1ca),JSON[_0x2930b9(0x20b)](_0x515688,null,0x2)),console['log'](_0x2930b9(0x1d9)+_0x11b0dd+'\x20(always\x20GB\x20for\x20Rapyd)'),console[_0x2930b9(0x1dc)]('💳\x20Payment\x20Methods:\x20gb_visa_card,\x20gb_mastercard_card'),loggerService_1['loggerService'][_0x2930b9(0x1d7)]('rapyd',_0x2930b9(0x1bd),_0x2930b9(0x1d8),_0x515688);const _0x5e07a5=await fetch(this[_0x2930b9(0x1f7)],{'method':_0x2930b9(0x1d8),'headers':{'Content-Type':_0x2930b9(0x1e9),'User-Agent':_0x2930b9(0x228)},'body':JSON[_0x2930b9(0x20b)](_0x515688)}),_0x468a3f=Date[_0x2930b9(0x21d)]()-_0x267025;console[_0x2930b9(0x1dc)](_0x2930b9(0x210)),console[_0x2930b9(0x1dc)](_0x2930b9(0x200),_0x5e07a5['status']),console[_0x2930b9(0x1dc)](_0x2930b9(0x1f8),_0x5e07a5[_0x2930b9(0x227)]),console[_0x2930b9(0x1dc)](_0x2930b9(0x1d3),Object['fromEntries'](_0x5e07a5[_0x2930b9(0x1bf)][_0x2930b9(0x1ed)]())),console['log']('Response\x20Time:',_0x468a3f+'ms');const _0x4dc9cb=await _0x5e07a5[_0x2930b9(0x1d2)]();console[_0x2930b9(0x1dc)](_0x2930b9(0x22e),_0x4dc9cb);if(!_0x5e07a5['ok']){console['error'](_0x2930b9(0x20f)),console[_0x2930b9(0x20e)](_0x2930b9(0x1e1),_0x5e07a5[_0x2930b9(0x1af)]),console['error'](_0x2930b9(0x229),_0x4dc9cb),loggerService_1[_0x2930b9(0x1c5)][_0x2930b9(0x1aa)](_0x2930b9(0x21a),'/v1/hosted/payment_links',_0x5e07a5[_0x2930b9(0x1af)],_0x4dc9cb,_0x468a3f),loggerService_1[_0x2930b9(0x1c5)][_0x2930b9(0x1a5)]('rapyd',_0x2930b9(0x1bd),_0x2930b9(0x22b)+_0x5e07a5[_0x2930b9(0x1af)]+':\x20'+_0x4dc9cb);throw new Error(_0x2930b9(0x1b1)+_0x5e07a5[_0x2930b9(0x1af)]+_0x2930b9(0x1b3)+_0x4dc9cb);}let _0xe23933;try{_0xe23933=JSON['parse'](_0x4dc9cb);}catch(_0x4a0df9){console[_0x2930b9(0x20e)](_0x2930b9(0x1dd),_0x4a0df9),loggerService_1[_0x2930b9(0x1c5)]['logWhiteDomainError']('rapyd','/v1/hosted/payment_links',_0x2930b9(0x223)+_0x4a0df9);throw new Error(_0x2930b9(0x1e5)+_0x4dc9cb);}console[_0x2930b9(0x1dc)](_0x2930b9(0x1e6)),console[_0x2930b9(0x1dc)](_0x2930b9(0x1b0),JSON[_0x2930b9(0x20b)](_0xe23933,null,0x2)),loggerService_1['loggerService'][_0x2930b9(0x1aa)](_0x2930b9(0x21a),_0x2930b9(0x1bd),_0x5e07a5[_0x2930b9(0x1af)],_0xe23933,_0x468a3f);if(_0xe23933['status']?.[_0x2930b9(0x1af)]!==_0x2930b9(0x1df)){const _0x20bdfd=_0xe23933['status']?.['message']||'Unknown\x20error\x20from\x20Rapyd\x20API',_0x1e361d=_0xe23933[_0x2930b9(0x1af)]?.[_0x2930b9(0x1d1)]||'UNKNOWN';console[_0x2930b9(0x20e)](_0x2930b9(0x22c)),console[_0x2930b9(0x20e)](_0x2930b9(0x1f3),_0x1e361d),console[_0x2930b9(0x20e)](_0x2930b9(0x1fd),_0x20bdfd),console[_0x2930b9(0x20e)](_0x2930b9(0x1c8),_0xe23933['status']),loggerService_1[_0x2930b9(0x1c5)][_0x2930b9(0x1a5)]('rapyd',_0x2930b9(0x1bd),_0x2930b9(0x1e4)+_0x1e361d+'):\x20'+_0x20bdfd);throw new Error(_0x2930b9(0x225)+_0x1e361d+_0x2930b9(0x211)+_0x20bdfd);}if(!_0xe23933[_0x2930b9(0x1a7)]?.['id']||!_0xe23933[_0x2930b9(0x1a7)]?.[_0x2930b9(0x222)]){console[_0x2930b9(0x20e)](_0x2930b9(0x1fa)),console['error'](_0x2930b9(0x1ea)),console[_0x2930b9(0x20e)](_0x2930b9(0x1b6),_0xe23933['data']),loggerService_1[_0x2930b9(0x1c5)][_0x2930b9(0x1a5)](_0x2930b9(0x21a),_0x2930b9(0x1bd),_0x2930b9(0x224));throw new Error(_0x2930b9(0x1e3));}return console[_0x2930b9(0x1dc)](_0x2930b9(0x1ef)),console['log'](_0x2930b9(0x1fc),_0xe23933[_0x2930b9(0x1a7)]['id']),console[_0x2930b9(0x1dc)](_0x2930b9(0x220),_0xe23933[_0x2930b9(0x1a7)]['redirect_url']),console[_0x2930b9(0x1dc)](_0x2930b9(0x1d0)+_0x11b0dd+_0x2930b9(0x1ee)),console[_0x2930b9(0x1dc)](_0x2930b9(0x1d4)),{'gateway_payment_id':_0xe23933['data']['id'],'payment_url':_0xe23933['data'][_0x2930b9(0x222)]};}catch(_0x4e3420){console[_0x2930b9(0x20e)](_0x2930b9(0x1b8)),console['error'](_0x2930b9(0x204),_0x4e3420),loggerService_1[_0x2930b9(0x1c5)][_0x2930b9(0x1a5)](_0x2930b9(0x21a),_0x2930b9(0x1bd),_0x4e3420);if(_0x4e3420 instanceof Error){console[_0x2930b9(0x20e)]('Error\x20message:',_0x4e3420[_0x2930b9(0x217)]),console[_0x2930b9(0x20e)](_0x2930b9(0x1ff),_0x4e3420['stack']);throw new Error(_0x2930b9(0x1c1)+_0x4e3420[_0x2930b9(0x217)]);}throw new Error(_0x2930b9(0x1ec));}}async['verifyPayment'](_0x452e47){const _0x8b5f50=a52_0x5f25b9,_0x103a8c=Date['now']();try{loggerService_1[_0x8b5f50(0x1c5)][_0x8b5f50(0x1d7)](_0x8b5f50(0x21a),_0x8b5f50(0x207)+_0x452e47,_0x8b5f50(0x1d6),{});const _0x2e70a5=await fetch(this[_0x8b5f50(0x1f7)]+'/'+_0x452e47,{'method':'GET','headers':{'Content-Type':_0x8b5f50(0x1e9),'User-Agent':_0x8b5f50(0x228)}}),_0x4cf263=Date[_0x8b5f50(0x21d)]()-_0x103a8c;if(!_0x2e70a5['ok']){const _0x2d4918=await _0x2e70a5[_0x8b5f50(0x1d2)]();loggerService_1['loggerService'][_0x8b5f50(0x1aa)](_0x8b5f50(0x21a),_0x8b5f50(0x207)+_0x452e47,_0x2e70a5[_0x8b5f50(0x1af)],_0x2d4918,_0x4cf263);throw new Error('HTTP\x20error!\x20status:\x20'+_0x2e70a5[_0x8b5f50(0x1af)]);}const _0x15ac8c=await _0x2e70a5[_0x8b5f50(0x1cb)]();loggerService_1[_0x8b5f50(0x1c5)][_0x8b5f50(0x1aa)](_0x8b5f50(0x21a),_0x8b5f50(0x207)+_0x452e47,_0x2e70a5['status'],_0x15ac8c,_0x4cf263);if(_0x15ac8c['status']?.[_0x8b5f50(0x1af)]!==_0x8b5f50(0x1df)){loggerService_1[_0x8b5f50(0x1c5)][_0x8b5f50(0x1a5)](_0x8b5f50(0x21a),_0x8b5f50(0x207)+_0x452e47,_0x8b5f50(0x1da)+(_0x15ac8c[_0x8b5f50(0x1af)]?.['message']||'Unknown\x20error'));throw new Error(_0x8b5f50(0x1da)+(_0x15ac8c[_0x8b5f50(0x1af)]?.[_0x8b5f50(0x217)]||_0x8b5f50(0x206)));}let _0x314cd2=_0x8b5f50(0x1c3);if(_0x15ac8c[_0x8b5f50(0x1a7)]?.[_0x8b5f50(0x1af)])switch(_0x15ac8c[_0x8b5f50(0x1a7)][_0x8b5f50(0x1af)][_0x8b5f50(0x21c)]()){case _0x8b5f50(0x1c7):_0x314cd2=_0x8b5f50(0x1a9);break;case _0x8b5f50(0x203):_0x314cd2='FAILED';break;case'EXP':_0x314cd2='EXPIRED';break;case _0x8b5f50(0x1f5):_0x314cd2=_0x8b5f50(0x1bb);break;case _0x8b5f50(0x1c9):case _0x8b5f50(0x1de):default:_0x314cd2=_0x8b5f50(0x1c3);break;}return{'status':_0x314cd2,'amount':_0x15ac8c[_0x8b5f50(0x1a7)]?.[_0x8b5f50(0x1cf)],'currency':_0x15ac8c[_0x8b5f50(0x1a7)]?.['currency']};}catch(_0x3ba70e){console[_0x8b5f50(0x20e)]('Rapyd\x20payment\x20verification\x20error:',_0x3ba70e),loggerService_1[_0x8b5f50(0x1c5)]['logWhiteDomainError']('rapyd',_0x8b5f50(0x207)+_0x452e47,_0x3ba70e);throw new Error(_0x8b5f50(0x208)+(_0x3ba70e instanceof Error?_0x3ba70e['message']:_0x8b5f50(0x206)));}}async[a52_0x5f25b9(0x1db)](_0x4cdb5f){const _0x13bf22=a52_0x5f25b9;console[_0x13bf22(0x1dc)](_0x13bf22(0x21f),_0x4cdb5f);let _0x17bba4=_0x13bf22(0x1c3),_0x4fe6dd;_0x4cdb5f[_0x13bf22(0x1a7)]?.[_0x13bf22(0x216)]&&(_0x4fe6dd=_0x4cdb5f[_0x13bf22(0x1a7)][_0x13bf22(0x216)],console[_0x13bf22(0x1dc)](_0x13bf22(0x212)+_0x4fe6dd));switch(_0x4cdb5f[_0x13bf22(0x214)]?.[_0x13bf22(0x21c)]()){case _0x13bf22(0x20c):_0x4cdb5f[_0x13bf22(0x1a7)]?.['paid']===!![]&&_0x4cdb5f['data']?.[_0x13bf22(0x1af)]===_0x13bf22(0x1c7)?_0x17bba4=_0x13bf22(0x1a9):_0x17bba4=_0x13bf22(0x1c3);break;case _0x13bf22(0x1f0):_0x17bba4='FAILED';break;case _0x13bf22(0x1f1):_0x17bba4='EXPIRED';break;case'PAYMENT_FAILED':_0x17bba4=_0x13bf22(0x1bb);!_0x4fe6dd&&_0x4cdb5f[_0x13bf22(0x1a7)]?.[_0x13bf22(0x216)]&&(_0x4fe6dd=_0x4cdb5f['data'][_0x13bf22(0x216)]);break;default:switch(_0x4cdb5f[_0x13bf22(0x1a7)]?.[_0x13bf22(0x1af)]?.[_0x13bf22(0x21c)]()){case _0x13bf22(0x1c7):_0x4cdb5f[_0x13bf22(0x1a7)]?.[_0x13bf22(0x1cd)]===!![]?_0x17bba4='PAID':_0x17bba4=_0x13bf22(0x1bb);break;case _0x13bf22(0x203):_0x17bba4='FAILED';break;case'EXP':_0x17bba4=_0x13bf22(0x20d);break;case'ERR':_0x17bba4=_0x13bf22(0x1bb);!_0x4fe6dd&&_0x4cdb5f['data']?.[_0x13bf22(0x216)]&&(_0x4fe6dd=_0x4cdb5f[_0x13bf22(0x1a7)][_0x13bf22(0x216)]);break;case _0x13bf22(0x1c9):case'ACT':default:_0x17bba4=_0x13bf22(0x1c3);break;}break;}const _0x373be3={};return _0x4cdb5f[_0x13bf22(0x1a7)]?.[_0x13bf22(0x1e2)]?.[_0x13bf22(0x221)]&&(_0x373be3[_0x13bf22(0x22a)]=_0x4cdb5f['data'][_0x13bf22(0x1e2)][_0x13bf22(0x221)]),_0x4cdb5f[_0x13bf22(0x1a7)]?.[_0x13bf22(0x1e0)]&&(_0x373be3[_0x13bf22(0x1ab)]=_0x4cdb5f[_0x13bf22(0x1a7)][_0x13bf22(0x1e0)]),_0x4cdb5f[_0x13bf22(0x1a7)]?.[_0x13bf22(0x1d1)]&&(_0x373be3[_0x13bf22(0x1c0)]=_0x4cdb5f[_0x13bf22(0x1a7)]['error_code']),_0x4cdb5f['data']?.[_0x13bf22(0x1f9)]&&(_0x373be3[_0x13bf22(0x1ce)]=_0x4cdb5f['data'][_0x13bf22(0x1f9)]),console[_0x13bf22(0x1dc)]('🔄\x20Rapyd\x20webhook\x20processed:\x20status='+_0x17bba4+_0x13bf22(0x22d)+(_0x4fe6dd||_0x13bf22(0x1b2))),{'paymentId':_0x4cdb5f[_0x13bf22(0x1a7)]?.[_0x13bf22(0x1c2)]||'','status':_0x17bba4,'amount':_0x4cdb5f[_0x13bf22(0x1a7)]?.[_0x13bf22(0x1cf)],'currency':_0x4cdb5f[_0x13bf22(0x1a7)]?.[_0x13bf22(0x209)],'failureMessage':_0x4fe6dd,'additionalInfo':_0x373be3};}}exports['RapydService']=RapydService;