'use strict';const a66_0x2e18d3=a66_0x227b;(function(_0x180247,_0x5bd72b){const _0x3844c9=a66_0x227b,_0x46d2f9=_0x180247();while(!![]){try{const _0x5b3dad=-parseInt(_0x3844c9(0x149))/0x1*(parseInt(_0x3844c9(0xd9))/0x2)+parseInt(_0x3844c9(0x128))/0x3+-parseInt(_0x3844c9(0x114))/0x4+-parseInt(_0x3844c9(0x110))/0x5*(-parseInt(_0x3844c9(0x153))/0x6)+-parseInt(_0x3844c9(0x102))/0x7+-parseInt(_0x3844c9(0x10b))/0x8+parseInt(_0x3844c9(0x129))/0x9*(parseInt(_0x3844c9(0xf8))/0xa);if(_0x5b3dad===_0x5bd72b)break;else _0x46d2f9['push'](_0x46d2f9['shift']());}catch(_0x490806){_0x46d2f9['push'](_0x46d2f9['shift']());}}}(a66_0x361f,0x3be92));Object[a66_0x2e18d3(0xef)](exports,a66_0x2e18d3(0x115),{'value':!![]}),exports[a66_0x2e18d3(0x134)]=void 0x0;function a66_0x227b(_0x49488d,_0x18c697){_0x49488d=_0x49488d-0xd8;const _0x361ffd=a66_0x361f();let _0x227b93=_0x361ffd[_0x49488d];return _0x227b93;}const loggerService_1=require(a66_0x2e18d3(0x122));function a66_0x361f(){const _0x2291a4=['cardLast4','apiUrl','Headers:','custom_elements','ORDER:\x20','Status:','Parsed\x20Result:','Error\x20Message:','cardholder_name','Invalid\x20response\x20from\x20Rapyd\x20API:\x20missing\x20id\x20or\x20redirect_url','Business\x20Error\x20(','rapyd','===\x20RAPYD\x20API\x20RESPONSE\x20(White\x20Domain)\x20===','Processing\x20Rapyd\x20webhook:','failure_code','failure_message','defineProperty','floor','Unknown\x20error','createPaymentLink','PAID','toISOString','logWhiteDomainResponse','===\x20RAPYD\x20SUCCESS\x20===','data','11859550ZkMueF','Payment\x20System/1.0','stack','entries','Failed\x20to\x20create\x20Rapyd\x20payment\x20link:\x20Unknown\x20error','PAYMENT_CANCELED','paid','\x20\x20\x20fixed_side:\x20buy','split','none','2445345JouHrc','Raw\x20Response\x20Body:','last4','Status\x20Text:','HTTP\x20error!\x20status:\x20','/v1/hosted/payment_links/','log','failureCode','headers','610656FXuTTV','error_code','ðŸŒ\x20Rapyd\x20service\x20initialized\x20with\x20white\x20domain\x20proxy','===\x20RAPYD\x20API\x20REQUEST\x20(White\x20Domain\x20-\x20Updated\x20Format)\x20===',',\x20body:\x20','85SsMjpF','Failed\x20to\x20verify\x20Rapyd\x20payment:\x20','https://tesoft.uk/gateway/success.php?id=','name','1786648xeLQpi','__esModule','ðŸ’±\x20Adding\x20currency\x20conversion\x20fields\x20for\x20','amount','Request\x20Body\x20(Updated\x20Format):','EUR','processWebhook','HTTP\x20','ðŸ’¥\x20Rapyd\x20failure\x20message:\x20','GET','ðŸ‡¬ðŸ‡§\x20Using\x20GB\x20(Britain)\x20as\x20country\x20for\x20Rapyd\x20payment\x20link','SUCCESS','error','EXPIRED','../loggerService','ðŸ‡¬ðŸ‡§\x20Country\x20used:\x20','CAN','\x20(always\x20GB\x20for\x20Rapyd)','parse','fixed_side','446310BGFnXM','9VaQSii','message','PENDING','Incomplete\x20response:\x20missing\x20id\x20or\x20redirect_url','https://tesoft.uk/gateway/rapyd/','Response\x20Body:','status','application/json','payment_method_type','phone_number','Unknown\x20error\x20from\x20Rapyd\x20API','RapydService','\x20\x20\x20expiration:\x20','text','ðŸ‡¬ðŸ‡§\x20Country:\x20','UNKNOWN','toUpperCase','/v1/hosted/payment_links','errorCode','now','merchant_reference_id','Rapyd\x20payment\x20verification\x20error:','Invalid\x20JSON\x20response\x20from\x20Rapyd\x20API:\x20','):\x20','logWhiteDomainRequest','Failed\x20to\x20parse\x20JSON\x20response:','===\x20RAPYD\x20API\x20BUSINESS\x20ERROR\x20===','NEW','CLO','Redirect\x20URL:','stringify','type','2WpRvjO','POST','email','PAYMENT_COMPLETED','\x20\x20\x20requested_currency:\x20EUR','currency','payment_method_data','ERR','Response\x20Time:','JSON\x20Parse\x20Error:\x20','69660UWRNvv','redirect_url','requested_currency','loggerService','FAILED','ACT','TESOFT\x20','ðŸ’³\x20Payment\x20Methods:\x20gb_visa_card,\x20gb_mastercard_card','===\x20RAPYD\x20API\x20ERROR\x20===','HTTP\x20Status:','===\x20RAPYD\x20API\x20INCOMPLETE\x20RESPONSE\x20===','logWhiteDomainError','Payment\x20Link\x20ID:','Rapyd\x20API\x20error:\x20','414372bSiOSL','===\x20PARSED\x20RAPYD\x20RESPONSE\x20===','json','PAYMENT_FAILED',',\x20failureMessage=','\x20(GB\x20-\x20Britain)'];a66_0x361f=function(){return _0x2291a4;};return a66_0x361f();}class RapydService{constructor(){const _0x42a4ec=a66_0x2e18d3;this['apiUrl']=_0x42a4ec(0x12d),console[_0x42a4ec(0x108)](_0x42a4ec(0x10d));}async[a66_0x2e18d3(0xf2)](_0x2db6aa){const _0x466411=a66_0x2e18d3,{orderId:_0x34ea20,orderName:_0x58c410,amount:_0x557d06,currency:_0x7d33a8,usage:_0xba9513,maxPayments:_0x4dc5d4,successUrl:_0x47c7f6,failUrl:_0x1eda0b,customerName:_0x43aab5,customerEmail:_0x121f6f}=_0x2db6aa,_0x4e87ce=_0x7d33a8['toUpperCase'](),_0x5b0eb4='GB';console[_0x466411(0x108)](_0x466411(0x11e));const _0x5ce9ab=_0x466411(0x112)+_0x34ea20,_0x1a7026='https://tesoft.uk/gateway/fail.php?id='+_0x34ea20,_0x18f096={'amount':_0x557d06,'currency':_0x4e87ce,'payment_method_options':{'3d_required':![]},'cancel_checkout_url':_0x1a7026,'complete_checkout_url':_0x5ce9ab,'complete_payment_url':_0x5ce9ab,'merchant_reference_id':_0x34ea20,'description':_0x466411(0xe3)+_0x34ea20,'statement_descriptor':_0x466411(0x159)+(_0x34ea20[_0x466411(0x100)]('-')[0x1]||_0x34ea20),'country':'GB','payment_method_types_include':['gb_visa_card','gb_mastercard_card'],'custom_elements':{'display_description':!![],'billing_address_collect':!![],'required_customer_fields':[_0x466411(0x113),_0x466411(0x14b),_0x466411(0x132),'address']}};_0x43aab5&&(_0x18f096[_0x466411(0xe2)][_0x466411(0xe7)]=_0x43aab5,console['log']('ðŸ’³\x20Adding\x20cardholder\x20name:\x20'+_0x43aab5));if(_0x4e87ce!==_0x466411(0x119)){const _0x3e3ca5=Math[_0x466411(0xf0)](Date[_0x466411(0x13c)]()/0x3e8)+0x1e*0x3c;_0x18f096[_0x466411(0x127)]='buy',_0x18f096[_0x466411(0x155)]=_0x466411(0x119),_0x18f096['expiration']=_0x3e3ca5,console[_0x466411(0x108)](_0x466411(0x116)+_0x4e87ce+'\x20->\x20EUR:'),console[_0x466411(0x108)](_0x466411(0xff)),console['log'](_0x466411(0x14d)),console['log'](_0x466411(0x135)+_0x3e3ca5+'\x20('+new Date(_0x3e3ca5*0x3e8)[_0x466411(0xf4)]()+')');}const _0x172db5=Date[_0x466411(0x13c)]();try{console[_0x466411(0x108)](_0x466411(0x10e)),console[_0x466411(0x108)]('URL:',this[_0x466411(0xe0)]),console[_0x466411(0x108)](_0x466411(0x118),JSON['stringify'](_0x18f096,null,0x2)),console[_0x466411(0x108)](_0x466411(0x137)+_0x5b0eb4+_0x466411(0x125)),console[_0x466411(0x108)](_0x466411(0x15a)),loggerService_1['loggerService']['logWhiteDomainRequest']('rapyd','/v1/hosted/payment_links','POST',_0x18f096);const _0x53499f=await fetch(this[_0x466411(0xe0)],{'method':_0x466411(0x14a),'headers':{'Content-Type':'application/json','User-Agent':_0x466411(0xf9)},'body':JSON[_0x466411(0x147)](_0x18f096)}),_0x4c1138=Date['now']()-_0x172db5;console[_0x466411(0x108)](_0x466411(0xeb)),console[_0x466411(0x108)](_0x466411(0xe4),_0x53499f[_0x466411(0x12f)]),console[_0x466411(0x108)](_0x466411(0x105),_0x53499f['statusText']),console[_0x466411(0x108)](_0x466411(0xe1),Object['fromEntries'](_0x53499f[_0x466411(0x10a)][_0x466411(0xfb)]())),console[_0x466411(0x108)](_0x466411(0x151),_0x4c1138+'ms');const _0x54d1a5=await _0x53499f[_0x466411(0x136)]();console[_0x466411(0x108)](_0x466411(0x103),_0x54d1a5);if(!_0x53499f['ok']){console['error'](_0x466411(0x15b)),console[_0x466411(0x120)](_0x466411(0x15c),_0x53499f[_0x466411(0x12f)]),console['error'](_0x466411(0x12e),_0x54d1a5),loggerService_1[_0x466411(0x156)][_0x466411(0xf5)](_0x466411(0xea),_0x466411(0x13a),_0x53499f[_0x466411(0x12f)],_0x54d1a5,_0x4c1138),loggerService_1['loggerService'][_0x466411(0x15e)]('rapyd',_0x466411(0x13a),_0x466411(0x11b)+_0x53499f[_0x466411(0x12f)]+':\x20'+_0x54d1a5);throw new Error(_0x466411(0x106)+_0x53499f[_0x466411(0x12f)]+_0x466411(0x10f)+_0x54d1a5);}let _0x8abcd9;try{_0x8abcd9=JSON[_0x466411(0x126)](_0x54d1a5);}catch(_0x132c77){console[_0x466411(0x120)](_0x466411(0x142),_0x132c77),loggerService_1[_0x466411(0x156)]['logWhiteDomainError'](_0x466411(0xea),'/v1/hosted/payment_links',_0x466411(0x152)+_0x132c77);throw new Error(_0x466411(0x13f)+_0x54d1a5);}console['log'](_0x466411(0xda)),console[_0x466411(0x108)](_0x466411(0xe5),JSON[_0x466411(0x147)](_0x8abcd9,null,0x2)),loggerService_1[_0x466411(0x156)][_0x466411(0xf5)]('rapyd',_0x466411(0x13a),_0x53499f['status'],_0x8abcd9,_0x4c1138);if(_0x8abcd9[_0x466411(0x12f)]?.[_0x466411(0x12f)]!==_0x466411(0x11f)){const _0xf32590=_0x8abcd9['status']?.[_0x466411(0x12a)]||_0x466411(0x133),_0x2a5215=_0x8abcd9[_0x466411(0x12f)]?.['error_code']||_0x466411(0x138);console[_0x466411(0x120)](_0x466411(0x143)),console[_0x466411(0x120)]('Error\x20Code:',_0x2a5215),console[_0x466411(0x120)](_0x466411(0xe6),_0xf32590),console['error']('Full\x20Error\x20Data:',_0x8abcd9[_0x466411(0x12f)]),loggerService_1[_0x466411(0x156)][_0x466411(0x15e)](_0x466411(0xea),_0x466411(0x13a),_0x466411(0xe9)+_0x2a5215+_0x466411(0x140)+_0xf32590);throw new Error('Rapyd\x20API\x20error\x20('+_0x2a5215+_0x466411(0x140)+_0xf32590);}if(!_0x8abcd9[_0x466411(0xf7)]?.['id']||!_0x8abcd9[_0x466411(0xf7)]?.['redirect_url']){console[_0x466411(0x120)](_0x466411(0x15d)),console[_0x466411(0x120)]('Missing\x20id\x20or\x20redirect_url\x20in\x20response'),console['error']('Response\x20data:',_0x8abcd9[_0x466411(0xf7)]),loggerService_1[_0x466411(0x156)][_0x466411(0x15e)](_0x466411(0xea),_0x466411(0x13a),_0x466411(0x12c));throw new Error(_0x466411(0xe8));}return console[_0x466411(0x108)](_0x466411(0xf6)),console[_0x466411(0x108)](_0x466411(0x15f),_0x8abcd9[_0x466411(0xf7)]['id']),console[_0x466411(0x108)](_0x466411(0x146),_0x8abcd9[_0x466411(0xf7)][_0x466411(0x154)]),console[_0x466411(0x108)](_0x466411(0x123)+_0x5b0eb4+_0x466411(0xde)),console[_0x466411(0x108)]('ðŸ’³\x20Payment\x20Methods:\x20gb_visa_card,\x20gb_mastercard_card'),{'gateway_payment_id':_0x8abcd9[_0x466411(0xf7)]['id'],'payment_url':_0x8abcd9[_0x466411(0xf7)]['redirect_url']};}catch(_0x17ed07){console[_0x466411(0x120)]('===\x20RAPYD\x20SERVICE\x20ERROR\x20==='),console[_0x466411(0x120)]('Error\x20details:',_0x17ed07),loggerService_1[_0x466411(0x156)][_0x466411(0x15e)]('rapyd',_0x466411(0x13a),_0x17ed07);if(_0x17ed07 instanceof Error){console[_0x466411(0x120)]('Error\x20message:',_0x17ed07[_0x466411(0x12a)]),console[_0x466411(0x120)]('Error\x20stack:',_0x17ed07[_0x466411(0xfa)]);throw new Error('Failed\x20to\x20create\x20Rapyd\x20payment\x20link:\x20'+_0x17ed07[_0x466411(0x12a)]);}throw new Error(_0x466411(0xfc));}}async['verifyPayment'](_0x4e2f2a){const _0xc24fc7=a66_0x2e18d3,_0x53c38b=Date[_0xc24fc7(0x13c)]();try{loggerService_1[_0xc24fc7(0x156)][_0xc24fc7(0x141)](_0xc24fc7(0xea),_0xc24fc7(0x107)+_0x4e2f2a,'GET',{});const _0x4c4782=await fetch(this[_0xc24fc7(0xe0)]+'/'+_0x4e2f2a,{'method':_0xc24fc7(0x11d),'headers':{'Content-Type':_0xc24fc7(0x130),'User-Agent':_0xc24fc7(0xf9)}}),_0x492d92=Date['now']()-_0x53c38b;if(!_0x4c4782['ok']){const _0x36c1e9=await _0x4c4782['text']();loggerService_1[_0xc24fc7(0x156)][_0xc24fc7(0xf5)]('rapyd',_0xc24fc7(0x107)+_0x4e2f2a,_0x4c4782[_0xc24fc7(0x12f)],_0x36c1e9,_0x492d92);throw new Error(_0xc24fc7(0x106)+_0x4c4782['status']);}const _0x2cc83f=await _0x4c4782[_0xc24fc7(0xdb)]();loggerService_1[_0xc24fc7(0x156)][_0xc24fc7(0xf5)](_0xc24fc7(0xea),_0xc24fc7(0x107)+_0x4e2f2a,_0x4c4782[_0xc24fc7(0x12f)],_0x2cc83f,_0x492d92);if(_0x2cc83f[_0xc24fc7(0x12f)]?.['status']!==_0xc24fc7(0x11f)){loggerService_1['loggerService'][_0xc24fc7(0x15e)](_0xc24fc7(0xea),_0xc24fc7(0x107)+_0x4e2f2a,'Rapyd\x20API\x20error:\x20'+(_0x2cc83f[_0xc24fc7(0x12f)]?.[_0xc24fc7(0x12a)]||'Unknown\x20error'));throw new Error(_0xc24fc7(0xd8)+(_0x2cc83f[_0xc24fc7(0x12f)]?.[_0xc24fc7(0x12a)]||_0xc24fc7(0xf1)));}let _0x4cf163=_0xc24fc7(0x12b);if(_0x2cc83f[_0xc24fc7(0xf7)]?.[_0xc24fc7(0x12f)])switch(_0x2cc83f['data'][_0xc24fc7(0x12f)][_0xc24fc7(0x139)]()){case'CLO':_0x4cf163=_0xc24fc7(0xf3);break;case'CAN':_0x4cf163=_0xc24fc7(0x157);break;case'EXP':_0x4cf163='EXPIRED';break;case _0xc24fc7(0x150):_0x4cf163='FAILED';break;case _0xc24fc7(0x144):case _0xc24fc7(0x158):default:_0x4cf163=_0xc24fc7(0x12b);break;}return{'status':_0x4cf163,'amount':_0x2cc83f[_0xc24fc7(0xf7)]?.[_0xc24fc7(0x117)],'currency':_0x2cc83f[_0xc24fc7(0xf7)]?.[_0xc24fc7(0x14e)]};}catch(_0x23d3d8){console[_0xc24fc7(0x120)](_0xc24fc7(0x13e),_0x23d3d8),loggerService_1['loggerService'][_0xc24fc7(0x15e)](_0xc24fc7(0xea),'/v1/hosted/payment_links/'+_0x4e2f2a,_0x23d3d8);throw new Error(_0xc24fc7(0x111)+(_0x23d3d8 instanceof Error?_0x23d3d8[_0xc24fc7(0x12a)]:'Unknown\x20error'));}}async[a66_0x2e18d3(0x11a)](_0x2efeda){const _0x433f49=a66_0x2e18d3;console[_0x433f49(0x108)](_0x433f49(0xec),_0x2efeda);let _0x57c51f=_0x433f49(0x12b),_0x4a8928;_0x2efeda[_0x433f49(0xf7)]?.[_0x433f49(0xee)]&&(_0x4a8928=_0x2efeda['data'][_0x433f49(0xee)],console[_0x433f49(0x108)](_0x433f49(0x11c)+_0x4a8928));switch(_0x2efeda[_0x433f49(0x148)]?.[_0x433f49(0x139)]()){case _0x433f49(0x14c):_0x2efeda[_0x433f49(0xf7)]?.[_0x433f49(0xfe)]===!![]&&_0x2efeda[_0x433f49(0xf7)]?.[_0x433f49(0x12f)]===_0x433f49(0x145)?_0x57c51f='PAID':_0x57c51f='PENDING';break;case _0x433f49(0xfd):_0x57c51f=_0x433f49(0x157);break;case'PAYMENT_EXPIRED':_0x57c51f=_0x433f49(0x121);break;case _0x433f49(0xdc):_0x57c51f='FAILED';!_0x4a8928&&_0x2efeda[_0x433f49(0xf7)]?.[_0x433f49(0xee)]&&(_0x4a8928=_0x2efeda[_0x433f49(0xf7)][_0x433f49(0xee)]);break;default:switch(_0x2efeda[_0x433f49(0xf7)]?.[_0x433f49(0x12f)]?.[_0x433f49(0x139)]()){case _0x433f49(0x145):_0x2efeda['data']?.['paid']===!![]?_0x57c51f=_0x433f49(0xf3):_0x57c51f=_0x433f49(0x157);break;case _0x433f49(0x124):_0x57c51f=_0x433f49(0x157);break;case'EXP':_0x57c51f=_0x433f49(0x121);break;case _0x433f49(0x150):_0x57c51f=_0x433f49(0x157);!_0x4a8928&&_0x2efeda[_0x433f49(0xf7)]?.[_0x433f49(0xee)]&&(_0x4a8928=_0x2efeda[_0x433f49(0xf7)][_0x433f49(0xee)]);break;case'NEW':case _0x433f49(0x158):default:_0x57c51f=_0x433f49(0x12b);break;}break;}const _0x5d0e53={};return _0x2efeda[_0x433f49(0xf7)]?.[_0x433f49(0x14f)]?.['last4']&&(_0x5d0e53[_0x433f49(0xdf)]=_0x2efeda['data']['payment_method_data'][_0x433f49(0x104)]),_0x2efeda[_0x433f49(0xf7)]?.[_0x433f49(0x131)]&&(_0x5d0e53['paymentMethod']=_0x2efeda[_0x433f49(0xf7)]['payment_method_type']),_0x2efeda[_0x433f49(0xf7)]?.['error_code']&&(_0x5d0e53[_0x433f49(0x13b)]=_0x2efeda['data'][_0x433f49(0x10c)]),_0x2efeda[_0x433f49(0xf7)]?.[_0x433f49(0xed)]&&(_0x5d0e53[_0x433f49(0x109)]=_0x2efeda[_0x433f49(0xf7)]['failure_code']),console['log']('ðŸ”„\x20Rapyd\x20webhook\x20processed:\x20status='+_0x57c51f+_0x433f49(0xdd)+(_0x4a8928||_0x433f49(0x101))),{'paymentId':_0x2efeda[_0x433f49(0xf7)]?.[_0x433f49(0x13d)]||'','status':_0x57c51f,'amount':_0x2efeda['data']?.[_0x433f49(0x117)],'currency':_0x2efeda[_0x433f49(0xf7)]?.[_0x433f49(0x14e)],'failureMessage':_0x4a8928,'additionalInfo':_0x5d0e53};}}exports[a66_0x2e18d3(0x134)]=RapydService;