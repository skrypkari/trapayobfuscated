'use strict';const a45_0x4aa341=a45_0x54f2;(function(_0x28e388,_0x4f3127){const _0x2eede4=a45_0x54f2,_0x48a63f=_0x28e388();while(!![]){try{const _0x229e60=parseInt(_0x2eede4(0x17f))/0x1+parseInt(_0x2eede4(0x18a))/0x2+parseInt(_0x2eede4(0x152))/0x3*(-parseInt(_0x2eede4(0x188))/0x4)+parseInt(_0x2eede4(0x191))/0x5*(-parseInt(_0x2eede4(0x16c))/0x6)+parseInt(_0x2eede4(0x13b))/0x7*(-parseInt(_0x2eede4(0x166))/0x8)+parseInt(_0x2eede4(0x13f))/0x9+parseInt(_0x2eede4(0x198))/0xa;if(_0x229e60===_0x4f3127)break;else _0x48a63f['push'](_0x48a63f['shift']());}catch(_0x195180){_0x48a63f['push'](_0x48a63f['shift']());}}}(a45_0x2a56,0x89371));function a45_0x2a56(){const _0x5a9a60=['EXP','1919700XxrlOy','Failed\x20to\x20verify\x20Rapyd\x20payment:\x20','PAYMENT_CANCELED','apiUrl','gb_visa_card','Invalid\x20JSON\x20response\x20from\x20Rapyd\x20API:\x20','redirect_url','merchant_reference_id','JSON\x20Parse\x20Error:\x20','paymentMethod','failure_code','parse','Status\x20Text:','Parsed\x20Result:','logWhiteDomainResponse','CLO','Failed\x20to\x20create\x20Rapyd\x20payment\x20link:\x20Unknown\x20error','payment_method_data','\x20(always\x20GB\x20for\x20Rapyd)','62805kuaclk','Status:','üá¨üáß\x20Country\x20used:\x20','loggerService','Business\x20Error\x20(','ACT','Rapyd\x20payment\x20verification\x20error:','amount','Payment\x20Link\x20ID:','statusText','Failed\x20to\x20create\x20Rapyd\x20payment\x20link:\x20','currency','Redirect\x20URL:','json','createPaymentLink','PAYMENT_FAILED','toUpperCase','Error\x20Code:','logWhiteDomainRequest','Response\x20Time:','72AICZJd',',\x20body:\x20','Error\x20stack:','===\x20RAPYD\x20API\x20ERROR\x20===','rapyd','paid','54xnwZPO','ERR','===\x20RAPYD\x20API\x20REQUEST\x20(White\x20Domain\x20-\x20Updated\x20Format)\x20===','log','errorCode','FAILED','type','Unknown\x20error','HTTP\x20Status:','text','===\x20RAPYD\x20API\x20RESPONSE\x20(White\x20Domain)\x20===','cardLast4','none','https://tesoft.uk/gateway/rapyd/','error_code','CAN','stack','Invalid\x20response\x20from\x20Rapyd\x20API:\x20missing\x20id\x20or\x20redirect_url','failureCode','431913FEBHUy','Headers:','UNKNOWN','status','EXPIRED','PAID','URL:','PAYMENT_COMPLETED','Missing\x20id\x20or\x20redirect_url\x20in\x20response','24XeXoUO','verifyPayment','643380XlxPfD','NEW','Rapyd\x20API\x20error\x20(','now','Raw\x20Response\x20Body:','Full\x20Error\x20Data:','ORDER:\x20','599575qyDPgy','stringify','/v1/hosted/payment_links/','===\x20RAPYD\x20API\x20INCOMPLETE\x20RESPONSE\x20===','üá¨üáß\x20Using\x20GB\x20(Britain)\x20as\x20country\x20for\x20Rapyd\x20payment\x20link','===\x20RAPYD\x20SERVICE\x20ERROR\x20===','Request\x20Body\x20(Updated\x20Format):','13935340rilquO','application/json','logWhiteDomainError','data','https://tesoft.uk/gateway/fail.php?id=','):\x20','headers','failure_message','/v1/hosted/payment_links','Error\x20details:','last4','üí≥\x20Payment\x20Methods:\x20gb_visa_card,\x20gb_mastercard_card','GET','üí•\x20Rapyd\x20failure\x20message:\x20','processWebhook','Error\x20message:','Processing\x20Rapyd\x20webhook:','Rapyd\x20API\x20error:\x20','PAYMENT_EXPIRED','POST','TesSoft\x20Payment\x20System/1.0','Incomplete\x20response:\x20missing\x20id\x20or\x20redirect_url','===\x20PARSED\x20RAPYD\x20RESPONSE\x20===','error','payment_method_type','SUCCESS','PENDING','defineProperty','461657hxRCKf','HTTP\x20error!\x20status:\x20','message'];a45_0x2a56=function(){return _0x5a9a60;};return a45_0x2a56();}Object[a45_0x4aa341(0x13a)](exports,'__esModule',{'value':!![]}),exports['RapydService']=void 0x0;const loggerService_1=require('../loggerService');class RapydService{constructor(){const _0x34d798=a45_0x4aa341;this[_0x34d798(0x142)]=_0x34d798(0x179),console[_0x34d798(0x16f)]('üåê\x20Rapyd\x20service\x20initialized\x20with\x20white\x20domain\x20proxy');}async[a45_0x4aa341(0x160)](_0x5b3cb1){const _0x21adc6=a45_0x4aa341,{orderId:_0x16399f,orderName:_0x5e9d89,amount:_0x145717,currency:_0x48647a,usage:_0x2ccae1,maxPayments:_0x259390,successUrl:_0x39a5f6,failUrl:_0x4be9e8}=_0x5b3cb1,_0x30f2f3=_0x48647a[_0x21adc6(0x162)](),_0x2f5d40='GB';console[_0x21adc6(0x16f)](_0x21adc6(0x195));const _0x3de39d='https://tesoft.uk/gateway/success.php?id='+_0x16399f,_0x357c44=_0x21adc6(0x19c)+_0x16399f,_0x3d7ca9={'amount':_0x145717,'currency':_0x30f2f3,'cancel_checkout_url':_0x357c44,'complete_checkout_url':_0x3de39d,'complete_payment_url':_0x3de39d,'merchant_reference_id':_0x16399f,'description':_0x21adc6(0x190)+_0x16399f,'country':'GB','payment_method_types_include':[_0x21adc6(0x143),'gb_mastercard_card'],'custom_elements':{'display_description':!![]}},_0x2d4ba6=Date[_0x21adc6(0x18d)]();try{console[_0x21adc6(0x16f)](_0x21adc6(0x16e)),console['log'](_0x21adc6(0x185),this[_0x21adc6(0x142)]),console['log'](_0x21adc6(0x197),JSON['stringify'](_0x3d7ca9,null,0x2)),console[_0x21adc6(0x16f)]('üá¨üáß\x20Country:\x20'+_0x2f5d40+_0x21adc6(0x151)),console['log'](_0x21adc6(0x12a)),loggerService_1[_0x21adc6(0x155)][_0x21adc6(0x164)]('rapyd','/v1/hosted/payment_links',_0x21adc6(0x132),_0x3d7ca9);const _0xacc8c7=await fetch(this[_0x21adc6(0x142)],{'method':_0x21adc6(0x132),'headers':{'Content-Type':_0x21adc6(0x199),'User-Agent':_0x21adc6(0x133)},'body':JSON[_0x21adc6(0x192)](_0x3d7ca9)}),_0x160d63=Date[_0x21adc6(0x18d)]()-_0x2d4ba6;console[_0x21adc6(0x16f)](_0x21adc6(0x176)),console['log'](_0x21adc6(0x153),_0xacc8c7['status']),console[_0x21adc6(0x16f)](_0x21adc6(0x14b),_0xacc8c7[_0x21adc6(0x15b)]),console[_0x21adc6(0x16f)](_0x21adc6(0x180),Object['fromEntries'](_0xacc8c7[_0x21adc6(0x125)]['entries']())),console['log'](_0x21adc6(0x165),_0x160d63+'ms');const _0x31f225=await _0xacc8c7[_0x21adc6(0x175)]();console['log'](_0x21adc6(0x18e),_0x31f225);if(!_0xacc8c7['ok']){console[_0x21adc6(0x136)](_0x21adc6(0x169)),console['error'](_0x21adc6(0x174),_0xacc8c7[_0x21adc6(0x182)]),console[_0x21adc6(0x136)]('Response\x20Body:',_0x31f225),loggerService_1[_0x21adc6(0x155)][_0x21adc6(0x14d)]('rapyd',_0x21adc6(0x127),_0xacc8c7['status'],_0x31f225,_0x160d63),loggerService_1[_0x21adc6(0x155)]['logWhiteDomainError'](_0x21adc6(0x16a),_0x21adc6(0x127),'HTTP\x20'+_0xacc8c7[_0x21adc6(0x182)]+':\x20'+_0x31f225);throw new Error(_0x21adc6(0x13c)+_0xacc8c7[_0x21adc6(0x182)]+_0x21adc6(0x167)+_0x31f225);}let _0x355151;try{_0x355151=JSON[_0x21adc6(0x14a)](_0x31f225);}catch(_0x6dc950){console['error']('Failed\x20to\x20parse\x20JSON\x20response:',_0x6dc950),loggerService_1[_0x21adc6(0x155)][_0x21adc6(0x19a)](_0x21adc6(0x16a),_0x21adc6(0x127),_0x21adc6(0x147)+_0x6dc950);throw new Error(_0x21adc6(0x144)+_0x31f225);}console[_0x21adc6(0x16f)](_0x21adc6(0x135)),console['log'](_0x21adc6(0x14c),JSON[_0x21adc6(0x192)](_0x355151,null,0x2)),loggerService_1[_0x21adc6(0x155)][_0x21adc6(0x14d)](_0x21adc6(0x16a),_0x21adc6(0x127),_0xacc8c7['status'],_0x355151,_0x160d63);if(_0x355151['status']?.[_0x21adc6(0x182)]!==_0x21adc6(0x138)){const _0x301310=_0x355151['status']?.['message']||'Unknown\x20error\x20from\x20Rapyd\x20API',_0x38aa7a=_0x355151[_0x21adc6(0x182)]?.[_0x21adc6(0x17a)]||_0x21adc6(0x181);console[_0x21adc6(0x136)]('===\x20RAPYD\x20API\x20BUSINESS\x20ERROR\x20==='),console[_0x21adc6(0x136)](_0x21adc6(0x163),_0x38aa7a),console['error']('Error\x20Message:',_0x301310),console[_0x21adc6(0x136)](_0x21adc6(0x18f),_0x355151['status']),loggerService_1['loggerService'][_0x21adc6(0x19a)](_0x21adc6(0x16a),_0x21adc6(0x127),_0x21adc6(0x156)+_0x38aa7a+_0x21adc6(0x19d)+_0x301310);throw new Error(_0x21adc6(0x18c)+_0x38aa7a+_0x21adc6(0x19d)+_0x301310);}if(!_0x355151['data']?.['id']||!_0x355151[_0x21adc6(0x19b)]?.[_0x21adc6(0x145)]){console['error'](_0x21adc6(0x194)),console[_0x21adc6(0x136)](_0x21adc6(0x187)),console[_0x21adc6(0x136)]('Response\x20data:',_0x355151['data']),loggerService_1['loggerService'][_0x21adc6(0x19a)](_0x21adc6(0x16a),_0x21adc6(0x127),_0x21adc6(0x134));throw new Error(_0x21adc6(0x17d));}return console['log']('===\x20RAPYD\x20SUCCESS\x20==='),console[_0x21adc6(0x16f)](_0x21adc6(0x15a),_0x355151[_0x21adc6(0x19b)]['id']),console[_0x21adc6(0x16f)](_0x21adc6(0x15e),_0x355151[_0x21adc6(0x19b)][_0x21adc6(0x145)]),console[_0x21adc6(0x16f)](_0x21adc6(0x154)+_0x2f5d40+'\x20(GB\x20-\x20Britain)'),console[_0x21adc6(0x16f)](_0x21adc6(0x12a)),{'gateway_payment_id':_0x355151[_0x21adc6(0x19b)]['id'],'payment_url':_0x355151[_0x21adc6(0x19b)][_0x21adc6(0x145)]};}catch(_0x1fdc32){console[_0x21adc6(0x136)](_0x21adc6(0x196)),console[_0x21adc6(0x136)](_0x21adc6(0x128),_0x1fdc32),loggerService_1[_0x21adc6(0x155)][_0x21adc6(0x19a)]('rapyd',_0x21adc6(0x127),_0x1fdc32);if(_0x1fdc32 instanceof Error){console['error'](_0x21adc6(0x12e),_0x1fdc32['message']),console[_0x21adc6(0x136)](_0x21adc6(0x168),_0x1fdc32[_0x21adc6(0x17c)]);throw new Error(_0x21adc6(0x15c)+_0x1fdc32[_0x21adc6(0x13d)]);}throw new Error(_0x21adc6(0x14f));}}async[a45_0x4aa341(0x189)](_0x3cefa2){const _0x491ae8=a45_0x4aa341,_0x37a8c4=Date[_0x491ae8(0x18d)]();try{loggerService_1[_0x491ae8(0x155)][_0x491ae8(0x164)](_0x491ae8(0x16a),_0x491ae8(0x193)+_0x3cefa2,_0x491ae8(0x12b),{});const _0x2168aa=await fetch(this[_0x491ae8(0x142)]+'/'+_0x3cefa2,{'method':_0x491ae8(0x12b),'headers':{'Content-Type':'application/json','User-Agent':_0x491ae8(0x133)}}),_0x1866a3=Date[_0x491ae8(0x18d)]()-_0x37a8c4;if(!_0x2168aa['ok']){const _0x39da1d=await _0x2168aa[_0x491ae8(0x175)]();loggerService_1['loggerService']['logWhiteDomainResponse']('rapyd',_0x491ae8(0x193)+_0x3cefa2,_0x2168aa[_0x491ae8(0x182)],_0x39da1d,_0x1866a3);throw new Error(_0x491ae8(0x13c)+_0x2168aa['status']);}const _0x2d7774=await _0x2168aa[_0x491ae8(0x15f)]();loggerService_1[_0x491ae8(0x155)][_0x491ae8(0x14d)](_0x491ae8(0x16a),_0x491ae8(0x193)+_0x3cefa2,_0x2168aa[_0x491ae8(0x182)],_0x2d7774,_0x1866a3);if(_0x2d7774[_0x491ae8(0x182)]?.[_0x491ae8(0x182)]!==_0x491ae8(0x138)){loggerService_1[_0x491ae8(0x155)][_0x491ae8(0x19a)](_0x491ae8(0x16a),_0x491ae8(0x193)+_0x3cefa2,_0x491ae8(0x130)+(_0x2d7774[_0x491ae8(0x182)]?.['message']||_0x491ae8(0x173)));throw new Error(_0x491ae8(0x130)+(_0x2d7774[_0x491ae8(0x182)]?.[_0x491ae8(0x13d)]||_0x491ae8(0x173)));}let _0x27ecc6=_0x491ae8(0x139);if(_0x2d7774[_0x491ae8(0x19b)]?.[_0x491ae8(0x182)])switch(_0x2d7774['data'][_0x491ae8(0x182)][_0x491ae8(0x162)]()){case _0x491ae8(0x14e):_0x27ecc6='PAID';break;case _0x491ae8(0x17b):_0x27ecc6=_0x491ae8(0x171);break;case'EXP':_0x27ecc6='EXPIRED';break;case'ERR':_0x27ecc6='FAILED';break;case'NEW':case _0x491ae8(0x157):default:_0x27ecc6=_0x491ae8(0x139);break;}return{'status':_0x27ecc6,'amount':_0x2d7774[_0x491ae8(0x19b)]?.[_0x491ae8(0x159)],'currency':_0x2d7774['data']?.[_0x491ae8(0x15d)]};}catch(_0xf0a5e4){console['error'](_0x491ae8(0x158),_0xf0a5e4),loggerService_1[_0x491ae8(0x155)][_0x491ae8(0x19a)](_0x491ae8(0x16a),_0x491ae8(0x193)+_0x3cefa2,_0xf0a5e4);throw new Error(_0x491ae8(0x140)+(_0xf0a5e4 instanceof Error?_0xf0a5e4[_0x491ae8(0x13d)]:_0x491ae8(0x173)));}}async[a45_0x4aa341(0x12d)](_0x479c9e){const _0x174ec1=a45_0x4aa341;console['log'](_0x174ec1(0x12f),_0x479c9e);let _0x17d547=_0x174ec1(0x139),_0x35793a;_0x479c9e[_0x174ec1(0x19b)]?.[_0x174ec1(0x126)]&&(_0x35793a=_0x479c9e[_0x174ec1(0x19b)][_0x174ec1(0x126)],console['log'](_0x174ec1(0x12c)+_0x35793a));switch(_0x479c9e[_0x174ec1(0x172)]?.['toUpperCase']()){case _0x174ec1(0x186):_0x479c9e[_0x174ec1(0x19b)]?.[_0x174ec1(0x16b)]===!![]&&_0x479c9e[_0x174ec1(0x19b)]?.[_0x174ec1(0x182)]==='CLO'?_0x17d547=_0x174ec1(0x184):_0x17d547=_0x174ec1(0x139);break;case _0x174ec1(0x141):_0x17d547=_0x174ec1(0x171);break;case _0x174ec1(0x131):_0x17d547=_0x174ec1(0x183);break;case _0x174ec1(0x161):_0x17d547=_0x174ec1(0x171);!_0x35793a&&_0x479c9e[_0x174ec1(0x19b)]?.[_0x174ec1(0x126)]&&(_0x35793a=_0x479c9e[_0x174ec1(0x19b)][_0x174ec1(0x126)]);break;default:switch(_0x479c9e[_0x174ec1(0x19b)]?.['status']?.[_0x174ec1(0x162)]()){case _0x174ec1(0x14e):_0x479c9e[_0x174ec1(0x19b)]?.['paid']===!![]?_0x17d547=_0x174ec1(0x184):_0x17d547=_0x174ec1(0x171);break;case _0x174ec1(0x17b):_0x17d547=_0x174ec1(0x171);break;case _0x174ec1(0x13e):_0x17d547='EXPIRED';break;case _0x174ec1(0x16d):_0x17d547=_0x174ec1(0x171);!_0x35793a&&_0x479c9e[_0x174ec1(0x19b)]?.['failure_message']&&(_0x35793a=_0x479c9e[_0x174ec1(0x19b)]['failure_message']);break;case _0x174ec1(0x18b):case _0x174ec1(0x157):default:_0x17d547=_0x174ec1(0x139);break;}break;}const _0x3cc819={};return _0x479c9e[_0x174ec1(0x19b)]?.[_0x174ec1(0x150)]?.[_0x174ec1(0x129)]&&(_0x3cc819[_0x174ec1(0x177)]=_0x479c9e[_0x174ec1(0x19b)][_0x174ec1(0x150)]['last4']),_0x479c9e[_0x174ec1(0x19b)]?.[_0x174ec1(0x137)]&&(_0x3cc819[_0x174ec1(0x148)]=_0x479c9e['data'][_0x174ec1(0x137)]),_0x479c9e[_0x174ec1(0x19b)]?.['error_code']&&(_0x3cc819[_0x174ec1(0x170)]=_0x479c9e['data'][_0x174ec1(0x17a)]),_0x479c9e[_0x174ec1(0x19b)]?.[_0x174ec1(0x149)]&&(_0x3cc819[_0x174ec1(0x17e)]=_0x479c9e[_0x174ec1(0x19b)][_0x174ec1(0x149)]),console[_0x174ec1(0x16f)]('üîÑ\x20Rapyd\x20webhook\x20processed:\x20status='+_0x17d547+',\x20failureMessage='+(_0x35793a||_0x174ec1(0x178))),{'paymentId':_0x479c9e[_0x174ec1(0x19b)]?.[_0x174ec1(0x146)]||'','status':_0x17d547,'amount':_0x479c9e[_0x174ec1(0x19b)]?.['amount'],'currency':_0x479c9e[_0x174ec1(0x19b)]?.['currency'],'failureMessage':_0x35793a,'additionalInfo':_0x3cc819};}}function a45_0x54f2(_0x2f0e0e,_0x26e877){const _0x2a5631=a45_0x2a56();return a45_0x54f2=function(_0x54f205,_0x70dec){_0x54f205=_0x54f205-0x125;let _0x2940d9=_0x2a5631[_0x54f205];return _0x2940d9;},a45_0x54f2(_0x2f0e0e,_0x26e877);}exports['RapydService']=RapydService;