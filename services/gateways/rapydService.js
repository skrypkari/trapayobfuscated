'use strict';const a53_0x34951b=a53_0x4ea1;(function(_0x38430a,_0x5d2a18){const _0x31d2ad=a53_0x4ea1,_0x12b350=_0x38430a();while(!![]){try{const _0x7b9e08=-parseInt(_0x31d2ad(0x1ab))/0x1*(-parseInt(_0x31d2ad(0x165))/0x2)+parseInt(_0x31d2ad(0x194))/0x3+-parseInt(_0x31d2ad(0x1ca))/0x4+parseInt(_0x31d2ad(0x1d5))/0x5+-parseInt(_0x31d2ad(0x1c4))/0x6*(-parseInt(_0x31d2ad(0x16f))/0x7)+parseInt(_0x31d2ad(0x1c6))/0x8*(parseInt(_0x31d2ad(0x169))/0x9)+parseInt(_0x31d2ad(0x1a6))/0xa*(-parseInt(_0x31d2ad(0x18f))/0xb);if(_0x7b9e08===_0x5d2a18)break;else _0x12b350['push'](_0x12b350['shift']());}catch(_0x23228b){_0x12b350['push'](_0x12b350['shift']());}}}(a53_0x1162,0x4909c));function a53_0x4ea1(_0x3f988c,_0x5e8043){const _0x1162c8=a53_0x1162();return a53_0x4ea1=function(_0x4ea1c1,_0x4b56fc){_0x4ea1c1=_0x4ea1c1-0x15a;let _0x5e963c=_0x1162c8[_0x4ea1c1];return _0x5e963c;},a53_0x4ea1(_0x3f988c,_0x5e8043);}Object['defineProperty'](exports,a53_0x34951b(0x164),{'value':!![]}),exports[a53_0x34951b(0x1a0)]=void 0x0;function a53_0x1162(){const _0x515b6e=['üá¨üáß\x20Country\x20used:\x20','toISOString','9050eiYvsk','/v1/hosted/payment_links/','currency','error_code','application/json','19816aWfIvj','rapyd','verifyPayment','stringify','PAYMENT_COMPLETED','Raw\x20Response\x20Body:','logWhiteDomainRequest','===\x20RAPYD\x20API\x20BUSINESS\x20ERROR\x20===','EXP','üá¨üáß\x20Country:\x20','parse','failure_code','NEW','PAYMENT_FAILED','GET','https://tesoft.uk/gateway/fail.php?id=','stack','Rapyd\x20API\x20error:\x20','\x20\x20\x20requested_currency:\x20EUR','logWhiteDomainError','UNKNOWN','type','Error\x20Code:','Status:','CAN','2860644OfjzXR','PAYMENT_CANCELED','4089144qvePGt','failure_message','headers','EUR','1039492HCUtAf','merchant_reference_id','===\x20RAPYD\x20API\x20RESPONSE\x20(White\x20Domain)\x20===','===\x20RAPYD\x20API\x20ERROR\x20===','now','log','Unknown\x20error','Invalid\x20JSON\x20response\x20from\x20Rapyd\x20API:\x20',',\x20body:\x20','HTTP\x20error!\x20status:\x20','Response\x20Body:','2611670cqgbMU','Request\x20Body\x20(Updated\x20Format):','Failed\x20to\x20create\x20Rapyd\x20payment\x20link:\x20Unknown\x20error','../loggerService','Invalid\x20response\x20from\x20Rapyd\x20API:\x20missing\x20id\x20or\x20redirect_url','Full\x20Error\x20Data:','loggerService','last4','redirect_url','\x20(always\x20GB\x20for\x20Rapyd)','\x20->\x20EUR:','__esModule','54zngdER','Rapyd\x20API\x20error\x20(','Failed\x20to\x20parse\x20JSON\x20response:','\x20\x20\x20expiration:\x20','9wjezPa','üí≥\x20Payment\x20Methods:\x20gb_visa_card,\x20gb_mastercard_card','ERR','PENDING','errorCode','Unknown\x20error\x20from\x20Rapyd\x20API','7fahQAh','EXPIRED','===\x20RAPYD\x20API\x20INCOMPLETE\x20RESPONSE\x20===','Missing\x20id\x20or\x20redirect_url\x20in\x20response','https://tesoft.uk/gateway/rapyd/','toUpperCase','üá¨üáß\x20Using\x20GB\x20(Britain)\x20as\x20country\x20for\x20Rapyd\x20payment\x20link','PAID','gb_mastercard_card','Headers:','):\x20','cardLast4','text','üîÑ\x20Rapyd\x20webhook\x20processed:\x20status=','Failed\x20to\x20create\x20Rapyd\x20payment\x20link:\x20','paid','entries','üí±\x20Adding\x20currency\x20conversion\x20fields\x20for\x20','FAILED','Rapyd\x20payment\x20verification\x20error:','status','statusText','HTTP\x20Status:',',\x20failureMessage=','Failed\x20to\x20verify\x20Rapyd\x20payment:\x20','Parsed\x20Result:','fixed_side','\x20(GB\x20-\x20Britain)','Payment\x20System/1.0','Error\x20message:','error','apiUrl','22341iQrgkt','amount','ORDER:\x20','===\x20RAPYD\x20SUCCESS\x20===','Error\x20details:','1055427dXivzV','ACT','===\x20RAPYD\x20API\x20REQUEST\x20(White\x20Domain\x20-\x20Updated\x20Format)\x20===','üåê\x20Rapyd\x20service\x20initialized\x20with\x20white\x20domain\x20proxy','/v1/hosted/payment_links','requested_currency','data','logWhiteDomainResponse','floor','message','CLO','Status\x20Text:','RapydService','Response\x20data:','Payment\x20Link\x20ID:','Incomplete\x20response:\x20missing\x20id\x20or\x20redirect_url'];a53_0x1162=function(){return _0x515b6e;};return a53_0x1162();}const loggerService_1=require(a53_0x34951b(0x15c));class RapydService{constructor(){const _0x2c68f2=a53_0x34951b;this[_0x2c68f2(0x18e)]=_0x2c68f2(0x173),console[_0x2c68f2(0x1cf)](_0x2c68f2(0x197));}async['createPaymentLink'](_0x2f55c4){const _0x2858e7=a53_0x34951b,{orderId:_0x14a627,orderName:_0x5281de,amount:_0x13bbc8,currency:_0x43ad1c,usage:_0x2d3806,maxPayments:_0x13a541,successUrl:_0x386673,failUrl:_0x26c7c4}=_0x2f55c4,_0x2ccbe8=_0x43ad1c[_0x2858e7(0x174)](),_0x4d48ce='GB';console['log'](_0x2858e7(0x175));const _0x87520c='https://tesoft.uk/gateway/success.php?id='+_0x14a627,_0x1982f0=_0x2858e7(0x1ba)+_0x14a627,_0x4d862a={'amount':_0x13bbc8,'currency':_0x2ccbe8,'cancel_checkout_url':_0x1982f0,'complete_checkout_url':_0x87520c,'complete_payment_url':_0x87520c,'merchant_reference_id':_0x14a627,'description':_0x2858e7(0x191)+_0x14a627,'country':'GB','payment_method_types_include':['gb_visa_card',_0x2858e7(0x177)],'custom_elements':{'display_description':!![]}};if(_0x2ccbe8!==_0x2858e7(0x1c9)){const _0x6a172a=Math[_0x2858e7(0x19c)](Date['now']()/0x3e8)+0x1e*0x3c;_0x4d862a[_0x2858e7(0x189)]='buy',_0x4d862a[_0x2858e7(0x199)]='EUR',_0x4d862a['expiration']=_0x6a172a,console[_0x2858e7(0x1cf)](_0x2858e7(0x180)+_0x2ccbe8+_0x2858e7(0x163)),console[_0x2858e7(0x1cf)]('\x20\x20\x20fixed_side:\x20buy'),console[_0x2858e7(0x1cf)](_0x2858e7(0x1bd)),console[_0x2858e7(0x1cf)](_0x2858e7(0x168)+_0x6a172a+'\x20('+new Date(_0x6a172a*0x3e8)[_0x2858e7(0x1a5)]()+')');}const _0x2d48c9=Date['now']();try{console[_0x2858e7(0x1cf)](_0x2858e7(0x196)),console[_0x2858e7(0x1cf)]('URL:',this[_0x2858e7(0x18e)]),console[_0x2858e7(0x1cf)](_0x2858e7(0x15a),JSON['stringify'](_0x4d862a,null,0x2)),console[_0x2858e7(0x1cf)](_0x2858e7(0x1b4)+_0x4d48ce+_0x2858e7(0x162)),console[_0x2858e7(0x1cf)](_0x2858e7(0x16a)),loggerService_1[_0x2858e7(0x15f)][_0x2858e7(0x1b1)]('rapyd',_0x2858e7(0x198),'POST',_0x4d862a);const _0x1469c4=await fetch(this['apiUrl'],{'method':'POST','headers':{'Content-Type':_0x2858e7(0x1aa),'User-Agent':_0x2858e7(0x18b)},'body':JSON[_0x2858e7(0x1ae)](_0x4d862a)}),_0x59c070=Date[_0x2858e7(0x1ce)]()-_0x2d48c9;console[_0x2858e7(0x1cf)](_0x2858e7(0x1cc)),console['log'](_0x2858e7(0x1c2),_0x1469c4[_0x2858e7(0x183)]),console['log'](_0x2858e7(0x19f),_0x1469c4[_0x2858e7(0x184)]),console[_0x2858e7(0x1cf)](_0x2858e7(0x178),Object['fromEntries'](_0x1469c4[_0x2858e7(0x1c8)][_0x2858e7(0x17f)]())),console[_0x2858e7(0x1cf)]('Response\x20Time:',_0x59c070+'ms');const _0x237808=await _0x1469c4['text']();console[_0x2858e7(0x1cf)](_0x2858e7(0x1b0),_0x237808);if(!_0x1469c4['ok']){console['error'](_0x2858e7(0x1cd)),console[_0x2858e7(0x18d)](_0x2858e7(0x185),_0x1469c4['status']),console[_0x2858e7(0x18d)](_0x2858e7(0x1d4),_0x237808),loggerService_1[_0x2858e7(0x15f)][_0x2858e7(0x19b)]('rapyd',_0x2858e7(0x198),_0x1469c4[_0x2858e7(0x183)],_0x237808,_0x59c070),loggerService_1[_0x2858e7(0x15f)][_0x2858e7(0x1be)]('rapyd','/v1/hosted/payment_links','HTTP\x20'+_0x1469c4[_0x2858e7(0x183)]+':\x20'+_0x237808);throw new Error(_0x2858e7(0x1d3)+_0x1469c4['status']+_0x2858e7(0x1d2)+_0x237808);}let _0x20495c;try{_0x20495c=JSON[_0x2858e7(0x1b5)](_0x237808);}catch(_0x2d475b){console[_0x2858e7(0x18d)](_0x2858e7(0x167),_0x2d475b),loggerService_1[_0x2858e7(0x15f)][_0x2858e7(0x1be)](_0x2858e7(0x1ac),_0x2858e7(0x198),'JSON\x20Parse\x20Error:\x20'+_0x2d475b);throw new Error(_0x2858e7(0x1d1)+_0x237808);}console[_0x2858e7(0x1cf)]('===\x20PARSED\x20RAPYD\x20RESPONSE\x20==='),console['log'](_0x2858e7(0x188),JSON[_0x2858e7(0x1ae)](_0x20495c,null,0x2)),loggerService_1['loggerService']['logWhiteDomainResponse'](_0x2858e7(0x1ac),'/v1/hosted/payment_links',_0x1469c4['status'],_0x20495c,_0x59c070);if(_0x20495c[_0x2858e7(0x183)]?.[_0x2858e7(0x183)]!=='SUCCESS'){const _0x5e37c7=_0x20495c[_0x2858e7(0x183)]?.[_0x2858e7(0x19d)]||_0x2858e7(0x16e),_0x461a84=_0x20495c[_0x2858e7(0x183)]?.[_0x2858e7(0x1a9)]||_0x2858e7(0x1bf);console[_0x2858e7(0x18d)](_0x2858e7(0x1b2)),console[_0x2858e7(0x18d)](_0x2858e7(0x1c1),_0x461a84),console[_0x2858e7(0x18d)]('Error\x20Message:',_0x5e37c7),console[_0x2858e7(0x18d)](_0x2858e7(0x15e),_0x20495c[_0x2858e7(0x183)]),loggerService_1[_0x2858e7(0x15f)][_0x2858e7(0x1be)]('rapyd','/v1/hosted/payment_links','Business\x20Error\x20('+_0x461a84+_0x2858e7(0x179)+_0x5e37c7);throw new Error(_0x2858e7(0x166)+_0x461a84+_0x2858e7(0x179)+_0x5e37c7);}if(!_0x20495c['data']?.['id']||!_0x20495c[_0x2858e7(0x19a)]?.[_0x2858e7(0x161)]){console[_0x2858e7(0x18d)](_0x2858e7(0x171)),console['error'](_0x2858e7(0x172)),console[_0x2858e7(0x18d)](_0x2858e7(0x1a1),_0x20495c['data']),loggerService_1[_0x2858e7(0x15f)][_0x2858e7(0x1be)](_0x2858e7(0x1ac),'/v1/hosted/payment_links',_0x2858e7(0x1a3));throw new Error(_0x2858e7(0x15d));}return console[_0x2858e7(0x1cf)](_0x2858e7(0x192)),console[_0x2858e7(0x1cf)](_0x2858e7(0x1a2),_0x20495c[_0x2858e7(0x19a)]['id']),console[_0x2858e7(0x1cf)]('Redirect\x20URL:',_0x20495c[_0x2858e7(0x19a)][_0x2858e7(0x161)]),console[_0x2858e7(0x1cf)](_0x2858e7(0x1a4)+_0x4d48ce+_0x2858e7(0x18a)),console[_0x2858e7(0x1cf)](_0x2858e7(0x16a)),{'gateway_payment_id':_0x20495c['data']['id'],'payment_url':_0x20495c['data']['redirect_url']};}catch(_0x196b9f){console[_0x2858e7(0x18d)]('===\x20RAPYD\x20SERVICE\x20ERROR\x20==='),console[_0x2858e7(0x18d)](_0x2858e7(0x193),_0x196b9f),loggerService_1[_0x2858e7(0x15f)][_0x2858e7(0x1be)](_0x2858e7(0x1ac),'/v1/hosted/payment_links',_0x196b9f);if(_0x196b9f instanceof Error){console[_0x2858e7(0x18d)](_0x2858e7(0x18c),_0x196b9f[_0x2858e7(0x19d)]),console[_0x2858e7(0x18d)]('Error\x20stack:',_0x196b9f[_0x2858e7(0x1bb)]);throw new Error(_0x2858e7(0x17d)+_0x196b9f[_0x2858e7(0x19d)]);}throw new Error(_0x2858e7(0x15b));}}async[a53_0x34951b(0x1ad)](_0x4b2751){const _0x4ee4f9=a53_0x34951b,_0x40ebe9=Date[_0x4ee4f9(0x1ce)]();try{loggerService_1['loggerService'][_0x4ee4f9(0x1b1)](_0x4ee4f9(0x1ac),_0x4ee4f9(0x1a7)+_0x4b2751,'GET',{});const _0x3ffa2e=await fetch(this[_0x4ee4f9(0x18e)]+'/'+_0x4b2751,{'method':_0x4ee4f9(0x1b9),'headers':{'Content-Type':_0x4ee4f9(0x1aa),'User-Agent':'Payment\x20System/1.0'}}),_0xebaea=Date[_0x4ee4f9(0x1ce)]()-_0x40ebe9;if(!_0x3ffa2e['ok']){const _0x16b46c=await _0x3ffa2e[_0x4ee4f9(0x17b)]();loggerService_1[_0x4ee4f9(0x15f)][_0x4ee4f9(0x19b)](_0x4ee4f9(0x1ac),_0x4ee4f9(0x1a7)+_0x4b2751,_0x3ffa2e[_0x4ee4f9(0x183)],_0x16b46c,_0xebaea);throw new Error(_0x4ee4f9(0x1d3)+_0x3ffa2e[_0x4ee4f9(0x183)]);}const _0x496b95=await _0x3ffa2e['json']();loggerService_1[_0x4ee4f9(0x15f)]['logWhiteDomainResponse'](_0x4ee4f9(0x1ac),'/v1/hosted/payment_links/'+_0x4b2751,_0x3ffa2e[_0x4ee4f9(0x183)],_0x496b95,_0xebaea);if(_0x496b95[_0x4ee4f9(0x183)]?.[_0x4ee4f9(0x183)]!=='SUCCESS'){loggerService_1['loggerService'][_0x4ee4f9(0x1be)](_0x4ee4f9(0x1ac),_0x4ee4f9(0x1a7)+_0x4b2751,_0x4ee4f9(0x1bc)+(_0x496b95['status']?.[_0x4ee4f9(0x19d)]||'Unknown\x20error'));throw new Error(_0x4ee4f9(0x1bc)+(_0x496b95[_0x4ee4f9(0x183)]?.['message']||_0x4ee4f9(0x1d0)));}let _0x49feea=_0x4ee4f9(0x16c);if(_0x496b95[_0x4ee4f9(0x19a)]?.[_0x4ee4f9(0x183)])switch(_0x496b95[_0x4ee4f9(0x19a)]['status'][_0x4ee4f9(0x174)]()){case _0x4ee4f9(0x19e):_0x49feea=_0x4ee4f9(0x176);break;case _0x4ee4f9(0x1c3):_0x49feea=_0x4ee4f9(0x181);break;case'EXP':_0x49feea=_0x4ee4f9(0x170);break;case _0x4ee4f9(0x16b):_0x49feea=_0x4ee4f9(0x181);break;case'NEW':case _0x4ee4f9(0x195):default:_0x49feea=_0x4ee4f9(0x16c);break;}return{'status':_0x49feea,'amount':_0x496b95[_0x4ee4f9(0x19a)]?.[_0x4ee4f9(0x190)],'currency':_0x496b95[_0x4ee4f9(0x19a)]?.[_0x4ee4f9(0x1a8)]};}catch(_0x310944){console[_0x4ee4f9(0x18d)](_0x4ee4f9(0x182),_0x310944),loggerService_1[_0x4ee4f9(0x15f)][_0x4ee4f9(0x1be)](_0x4ee4f9(0x1ac),'/v1/hosted/payment_links/'+_0x4b2751,_0x310944);throw new Error(_0x4ee4f9(0x187)+(_0x310944 instanceof Error?_0x310944[_0x4ee4f9(0x19d)]:_0x4ee4f9(0x1d0)));}}async['processWebhook'](_0x13e386){const _0x5a749f=a53_0x34951b;console[_0x5a749f(0x1cf)]('Processing\x20Rapyd\x20webhook:',_0x13e386);let _0x2c9732=_0x5a749f(0x16c),_0x55f6e3;_0x13e386[_0x5a749f(0x19a)]?.['failure_message']&&(_0x55f6e3=_0x13e386['data']['failure_message'],console[_0x5a749f(0x1cf)]('üí•\x20Rapyd\x20failure\x20message:\x20'+_0x55f6e3));switch(_0x13e386[_0x5a749f(0x1c0)]?.[_0x5a749f(0x174)]()){case _0x5a749f(0x1af):_0x13e386['data']?.[_0x5a749f(0x17e)]===!![]&&_0x13e386[_0x5a749f(0x19a)]?.[_0x5a749f(0x183)]==='CLO'?_0x2c9732=_0x5a749f(0x176):_0x2c9732='PENDING';break;case _0x5a749f(0x1c5):_0x2c9732=_0x5a749f(0x181);break;case'PAYMENT_EXPIRED':_0x2c9732=_0x5a749f(0x170);break;case _0x5a749f(0x1b8):_0x2c9732=_0x5a749f(0x181);!_0x55f6e3&&_0x13e386[_0x5a749f(0x19a)]?.[_0x5a749f(0x1c7)]&&(_0x55f6e3=_0x13e386['data'][_0x5a749f(0x1c7)]);break;default:switch(_0x13e386[_0x5a749f(0x19a)]?.[_0x5a749f(0x183)]?.[_0x5a749f(0x174)]()){case _0x5a749f(0x19e):_0x13e386[_0x5a749f(0x19a)]?.[_0x5a749f(0x17e)]===!![]?_0x2c9732='PAID':_0x2c9732=_0x5a749f(0x181);break;case _0x5a749f(0x1c3):_0x2c9732=_0x5a749f(0x181);break;case _0x5a749f(0x1b3):_0x2c9732=_0x5a749f(0x170);break;case'ERR':_0x2c9732=_0x5a749f(0x181);!_0x55f6e3&&_0x13e386[_0x5a749f(0x19a)]?.['failure_message']&&(_0x55f6e3=_0x13e386[_0x5a749f(0x19a)][_0x5a749f(0x1c7)]);break;case _0x5a749f(0x1b7):case _0x5a749f(0x195):default:_0x2c9732=_0x5a749f(0x16c);break;}break;}const _0x3a7f2f={};return _0x13e386[_0x5a749f(0x19a)]?.['payment_method_data']?.[_0x5a749f(0x160)]&&(_0x3a7f2f[_0x5a749f(0x17a)]=_0x13e386[_0x5a749f(0x19a)]['payment_method_data'][_0x5a749f(0x160)]),_0x13e386[_0x5a749f(0x19a)]?.['payment_method_type']&&(_0x3a7f2f['paymentMethod']=_0x13e386[_0x5a749f(0x19a)]['payment_method_type']),_0x13e386[_0x5a749f(0x19a)]?.[_0x5a749f(0x1a9)]&&(_0x3a7f2f[_0x5a749f(0x16d)]=_0x13e386[_0x5a749f(0x19a)]['error_code']),_0x13e386[_0x5a749f(0x19a)]?.[_0x5a749f(0x1b6)]&&(_0x3a7f2f['failureCode']=_0x13e386[_0x5a749f(0x19a)][_0x5a749f(0x1b6)]),console[_0x5a749f(0x1cf)](_0x5a749f(0x17c)+_0x2c9732+_0x5a749f(0x186)+(_0x55f6e3||'none')),{'paymentId':_0x13e386[_0x5a749f(0x19a)]?.[_0x5a749f(0x1cb)]||'','status':_0x2c9732,'amount':_0x13e386[_0x5a749f(0x19a)]?.[_0x5a749f(0x190)],'currency':_0x13e386[_0x5a749f(0x19a)]?.['currency'],'failureMessage':_0x55f6e3,'additionalInfo':_0x3a7f2f};}}exports[a53_0x34951b(0x1a0)]=RapydService;