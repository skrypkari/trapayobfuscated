'use strict';const a44_0x3909fb=a44_0x44bc;(function(_0x8d7c2,_0x23c0dd){const _0x44eee7=a44_0x44bc,_0x137209=_0x8d7c2();while(!![]){try{const _0x43acb8=-parseInt(_0x44eee7(0x128))/0x1*(-parseInt(_0x44eee7(0x112))/0x2)+-parseInt(_0x44eee7(0x154))/0x3+parseInt(_0x44eee7(0x142))/0x4*(-parseInt(_0x44eee7(0x131))/0x5)+-parseInt(_0x44eee7(0x161))/0x6*(parseInt(_0x44eee7(0x170))/0x7)+-parseInt(_0x44eee7(0x111))/0x8*(-parseInt(_0x44eee7(0x118))/0x9)+-parseInt(_0x44eee7(0x12f))/0xa+-parseInt(_0x44eee7(0x120))/0xb*(-parseInt(_0x44eee7(0x156))/0xc);if(_0x43acb8===_0x23c0dd)break;else _0x137209['push'](_0x137209['shift']());}catch(_0x5c7534){_0x137209['push'](_0x137209['shift']());}}}(a44_0x3506,0x92f37));Object['defineProperty'](exports,'__esModule',{'value':!![]}),exports['RapydService']=void 0x0;const loggerService_1=require(a44_0x3909fb(0x179));function a44_0x44bc(_0x3272db,_0x2207cf){const _0x350626=a44_0x3506();return a44_0x44bc=function(_0x44bcdd,_0x112acb){_0x44bcdd=_0x44bcdd-0x10f;let _0x22c1e8=_0x350626[_0x44bcdd];return _0x22c1e8;},a44_0x44bc(_0x3272db,_0x2207cf);}class RapydService{constructor(){const _0x4cc54a=a44_0x3909fb;this['apiUrl']=_0x4cc54a(0x11c),console[_0x4cc54a(0x110)](_0x4cc54a(0x155));}async['createPaymentLink'](_0x57dc01){const _0x196e19=a44_0x3909fb,{orderId:_0x202544,orderName:_0x137831,amount:_0x360a03,currency:_0x2a365e,usage:_0x2b11d4,maxPayments:_0x16dd88,successUrl:_0x3485f3,failUrl:_0x2ffb89}=_0x57dc01,_0xb6d208=_0x2a365e[_0x196e19(0x14c)](),_0x131fa2='GB';console[_0x196e19(0x110)](_0x196e19(0x16a));const _0x5656a6=_0x196e19(0x164)+_0x202544,_0x2ca272=_0x196e19(0x15b)+_0x202544,_0x314d2b={'amount':_0x360a03,'currency':_0xb6d208,'cancel_checkout_url':_0x2ca272,'complete_checkout_url':_0x5656a6,'complete_payment_url':_0x5656a6,'merchant_reference_id':_0x202544,'description':_0x196e19(0x15e)+_0x202544,'country':'GB','payment_method_types_include':['gb_visa_card',_0x196e19(0x10f)],'custom_elements':{'display_description':!![]}},_0x379631=Date[_0x196e19(0x17a)]();try{console['log']('===\x20RAPYD\x20API\x20REQUEST\x20(White\x20Domain\x20-\x20Updated\x20Format)\x20==='),console[_0x196e19(0x110)]('URL:',this['apiUrl']),console[_0x196e19(0x110)](_0x196e19(0x12e),JSON['stringify'](_0x314d2b,null,0x2)),console[_0x196e19(0x110)](_0x196e19(0x169)+_0x131fa2+'\x20(always\x20GB\x20for\x20Rapyd)'),console[_0x196e19(0x110)](_0x196e19(0x139)),loggerService_1['loggerService']['logWhiteDomainRequest'](_0x196e19(0x17d),_0x196e19(0x149),_0x196e19(0x143),_0x314d2b);const _0x1c0194=await fetch(this[_0x196e19(0x159)],{'method':_0x196e19(0x143),'headers':{'Content-Type':_0x196e19(0x173),'User-Agent':_0x196e19(0x165)},'body':JSON[_0x196e19(0x14d)](_0x314d2b)}),_0xbb9e52=Date[_0x196e19(0x17a)]()-_0x379631;console['log']('===\x20RAPYD\x20API\x20RESPONSE\x20(White\x20Domain)\x20==='),console[_0x196e19(0x110)](_0x196e19(0x171),_0x1c0194[_0x196e19(0x119)]),console['log'](_0x196e19(0x153),_0x1c0194['statusText']),console[_0x196e19(0x110)](_0x196e19(0x16b),Object['fromEntries'](_0x1c0194[_0x196e19(0x15a)][_0x196e19(0x133)]())),console[_0x196e19(0x110)](_0x196e19(0x150),_0xbb9e52+'ms');const _0x21284d=await _0x1c0194['text']();console[_0x196e19(0x110)](_0x196e19(0x17c),_0x21284d);if(!_0x1c0194['ok']){console[_0x196e19(0x157)](_0x196e19(0x168)),console[_0x196e19(0x157)](_0x196e19(0x13e),_0x1c0194[_0x196e19(0x119)]),console[_0x196e19(0x157)](_0x196e19(0x12a),_0x21284d),loggerService_1[_0x196e19(0x177)][_0x196e19(0x16d)](_0x196e19(0x17d),_0x196e19(0x149),_0x1c0194['status'],_0x21284d,_0xbb9e52),loggerService_1[_0x196e19(0x177)][_0x196e19(0x174)](_0x196e19(0x17d),_0x196e19(0x149),_0x196e19(0x126)+_0x1c0194[_0x196e19(0x119)]+':\x20'+_0x21284d);throw new Error('HTTP\x20error!\x20status:\x20'+_0x1c0194[_0x196e19(0x119)]+',\x20body:\x20'+_0x21284d);}let _0x499004;try{_0x499004=JSON[_0x196e19(0x13a)](_0x21284d);}catch(_0x4476ee){console['error'](_0x196e19(0x130),_0x4476ee),loggerService_1[_0x196e19(0x177)][_0x196e19(0x174)]('rapyd',_0x196e19(0x149),_0x196e19(0x148)+_0x4476ee);throw new Error(_0x196e19(0x13d)+_0x21284d);}console[_0x196e19(0x110)](_0x196e19(0x178)),console[_0x196e19(0x110)](_0x196e19(0x127),JSON[_0x196e19(0x14d)](_0x499004,null,0x2)),loggerService_1[_0x196e19(0x177)][_0x196e19(0x16d)]('rapyd',_0x196e19(0x149),_0x1c0194[_0x196e19(0x119)],_0x499004,_0xbb9e52);if(_0x499004[_0x196e19(0x119)]?.['status']!=='SUCCESS'){const _0x1186d2=_0x499004[_0x196e19(0x119)]?.[_0x196e19(0x147)]||'Unknown\x20error\x20from\x20Rapyd\x20API',_0x1f5134=_0x499004[_0x196e19(0x119)]?.[_0x196e19(0x11a)]||_0x196e19(0x137);console[_0x196e19(0x157)]('===\x20RAPYD\x20API\x20BUSINESS\x20ERROR\x20==='),console[_0x196e19(0x157)](_0x196e19(0x15f),_0x1f5134),console['error'](_0x196e19(0x151),_0x1186d2),console[_0x196e19(0x157)](_0x196e19(0x113),_0x499004['status']),loggerService_1[_0x196e19(0x177)][_0x196e19(0x174)](_0x196e19(0x17d),'/v1/hosted/payment_links',_0x196e19(0x16f)+_0x1f5134+_0x196e19(0x175)+_0x1186d2);throw new Error(_0x196e19(0x125)+_0x1f5134+_0x196e19(0x175)+_0x1186d2);}if(!_0x499004[_0x196e19(0x145)]?.['id']||!_0x499004['data']?.['redirect_url']){console[_0x196e19(0x157)](_0x196e19(0x124)),console[_0x196e19(0x157)]('Missing\x20id\x20or\x20redirect_url\x20in\x20response'),console['error'](_0x196e19(0x138),_0x499004[_0x196e19(0x145)]),loggerService_1[_0x196e19(0x177)][_0x196e19(0x174)](_0x196e19(0x17d),_0x196e19(0x149),_0x196e19(0x141));throw new Error(_0x196e19(0x114));}return console['log'](_0x196e19(0x123)),console[_0x196e19(0x110)](_0x196e19(0x17e),_0x499004['data']['id']),console[_0x196e19(0x110)](_0x196e19(0x12c),_0x499004[_0x196e19(0x145)][_0x196e19(0x167)]),console[_0x196e19(0x110)]('🇬🇧\x20Country\x20used:\x20'+_0x131fa2+_0x196e19(0x121)),console[_0x196e19(0x110)](_0x196e19(0x139)),{'gateway_payment_id':_0x499004['data']['id'],'payment_url':_0x499004[_0x196e19(0x145)][_0x196e19(0x167)]};}catch(_0x40dff1){console[_0x196e19(0x157)](_0x196e19(0x140)),console['error']('Error\x20details:',_0x40dff1),loggerService_1[_0x196e19(0x177)][_0x196e19(0x174)](_0x196e19(0x17d),_0x196e19(0x149),_0x40dff1);if(_0x40dff1 instanceof Error){console['error'](_0x196e19(0x134),_0x40dff1[_0x196e19(0x147)]),console[_0x196e19(0x157)]('Error\x20stack:',_0x40dff1['stack']);throw new Error(_0x196e19(0x16c)+_0x40dff1[_0x196e19(0x147)]);}throw new Error('Failed\x20to\x20create\x20Rapyd\x20payment\x20link:\x20Unknown\x20error');}}async[a44_0x3909fb(0x11e)](_0x3fc0bd){const _0x5860bb=a44_0x3909fb,_0x1d95de=Date[_0x5860bb(0x17a)]();try{loggerService_1[_0x5860bb(0x177)]['logWhiteDomainRequest'](_0x5860bb(0x17d),'/v1/hosted/payment_links/'+_0x3fc0bd,_0x5860bb(0x158),{});const _0x21c8ed=await fetch(this['apiUrl']+'/'+_0x3fc0bd,{'method':_0x5860bb(0x158),'headers':{'Content-Type':'application/json','User-Agent':_0x5860bb(0x165)}}),_0x376fb=Date[_0x5860bb(0x17a)]()-_0x1d95de;if(!_0x21c8ed['ok']){const _0x411d17=await _0x21c8ed['text']();loggerService_1['loggerService'][_0x5860bb(0x16d)](_0x5860bb(0x17d),_0x5860bb(0x122)+_0x3fc0bd,_0x21c8ed[_0x5860bb(0x119)],_0x411d17,_0x376fb);throw new Error(_0x5860bb(0x13b)+_0x21c8ed['status']);}const _0x5eacd8=await _0x21c8ed['json']();loggerService_1[_0x5860bb(0x177)][_0x5860bb(0x16d)](_0x5860bb(0x17d),_0x5860bb(0x122)+_0x3fc0bd,_0x21c8ed[_0x5860bb(0x119)],_0x5eacd8,_0x376fb);if(_0x5eacd8['status']?.[_0x5860bb(0x119)]!=='SUCCESS'){loggerService_1['loggerService'][_0x5860bb(0x174)](_0x5860bb(0x17d),'/v1/hosted/payment_links/'+_0x3fc0bd,_0x5860bb(0x115)+(_0x5eacd8[_0x5860bb(0x119)]?.[_0x5860bb(0x147)]||_0x5860bb(0x172)));throw new Error(_0x5860bb(0x115)+(_0x5eacd8['status']?.['message']||'Unknown\x20error'));}let _0x56285e='PENDING';if(_0x5eacd8[_0x5860bb(0x145)]?.[_0x5860bb(0x119)])switch(_0x5eacd8[_0x5860bb(0x145)][_0x5860bb(0x119)]['toUpperCase']()){case _0x5860bb(0x160):_0x56285e='PAID';break;case _0x5860bb(0x144):_0x56285e='FAILED';break;case _0x5860bb(0x16e):_0x56285e=_0x5860bb(0x17b);break;case _0x5860bb(0x14f):_0x56285e='FAILED';break;case _0x5860bb(0x11d):case _0x5860bb(0x162):default:_0x56285e=_0x5860bb(0x12b);break;}return{'status':_0x56285e,'amount':_0x5eacd8[_0x5860bb(0x145)]?.[_0x5860bb(0x129)],'currency':_0x5eacd8['data']?.[_0x5860bb(0x11b)]};}catch(_0x54983a){console['error'](_0x5860bb(0x135),_0x54983a),loggerService_1[_0x5860bb(0x177)][_0x5860bb(0x174)](_0x5860bb(0x17d),_0x5860bb(0x122)+_0x3fc0bd,_0x54983a);throw new Error(_0x5860bb(0x152)+(_0x54983a instanceof Error?_0x54983a[_0x5860bb(0x147)]:'Unknown\x20error'));}}async[a44_0x3909fb(0x13f)](_0xd74606){const _0x3f4930=a44_0x3909fb;console[_0x3f4930(0x110)]('Processing\x20Rapyd\x20webhook:',_0xd74606);let _0x362fd7=_0x3f4930(0x12b),_0x1ee1e7;_0xd74606[_0x3f4930(0x145)]?.[_0x3f4930(0x146)]&&(_0x1ee1e7=_0xd74606[_0x3f4930(0x145)][_0x3f4930(0x146)],console[_0x3f4930(0x110)]('💥\x20Rapyd\x20failure\x20message:\x20'+_0x1ee1e7));switch(_0xd74606[_0x3f4930(0x14e)]?.[_0x3f4930(0x14c)]()){case'PAYMENT_COMPLETED':_0xd74606[_0x3f4930(0x145)]?.[_0x3f4930(0x166)]===!![]&&_0xd74606[_0x3f4930(0x145)]?.['status']===_0x3f4930(0x160)?_0x362fd7=_0x3f4930(0x176):_0x362fd7='PENDING';break;case _0x3f4930(0x14b):_0x362fd7=_0x3f4930(0x17f);break;case'PAYMENT_EXPIRED':_0x362fd7='EXPIRED';break;case _0x3f4930(0x12d):_0x362fd7=_0x3f4930(0x17f);!_0x1ee1e7&&_0xd74606['data']?.[_0x3f4930(0x146)]&&(_0x1ee1e7=_0xd74606[_0x3f4930(0x145)]['failure_message']);break;default:switch(_0xd74606['data']?.['status']?.[_0x3f4930(0x14c)]()){case _0x3f4930(0x160):_0xd74606['data']?.[_0x3f4930(0x166)]===!![]?_0x362fd7=_0x3f4930(0x176):_0x362fd7=_0x3f4930(0x17f);break;case _0x3f4930(0x144):_0x362fd7=_0x3f4930(0x17f);break;case _0x3f4930(0x16e):_0x362fd7=_0x3f4930(0x17b);break;case _0x3f4930(0x14f):_0x362fd7=_0x3f4930(0x17f);!_0x1ee1e7&&_0xd74606[_0x3f4930(0x145)]?.[_0x3f4930(0x146)]&&(_0x1ee1e7=_0xd74606[_0x3f4930(0x145)][_0x3f4930(0x146)]);break;case'NEW':case _0x3f4930(0x162):default:_0x362fd7='PENDING';break;}break;}const _0x3fe0e0={};return _0xd74606[_0x3f4930(0x145)]?.[_0x3f4930(0x136)]?.['last4']&&(_0x3fe0e0[_0x3f4930(0x15c)]=_0xd74606[_0x3f4930(0x145)][_0x3f4930(0x136)][_0x3f4930(0x11f)]),_0xd74606['data']?.[_0x3f4930(0x132)]&&(_0x3fe0e0['paymentMethod']=_0xd74606[_0x3f4930(0x145)]['payment_method_type']),_0xd74606[_0x3f4930(0x145)]?.[_0x3f4930(0x11a)]&&(_0x3fe0e0[_0x3f4930(0x117)]=_0xd74606[_0x3f4930(0x145)]['error_code']),_0xd74606[_0x3f4930(0x145)]?.[_0x3f4930(0x15d)]&&(_0x3fe0e0['failureCode']=_0xd74606['data'][_0x3f4930(0x15d)]),console[_0x3f4930(0x110)](_0x3f4930(0x116)+_0x362fd7+_0x3f4930(0x13c)+(_0x1ee1e7||_0x3f4930(0x163))),{'paymentId':_0xd74606['data']?.['merchant_reference_id']||'','status':_0x362fd7,'amount':_0xd74606[_0x3f4930(0x145)]?.[_0x3f4930(0x129)],'currency':_0xd74606[_0x3f4930(0x145)]?.['currency'],'failureMessage':_0x1ee1e7,'additionalInfo':_0x3fe0e0};}}function a44_0x3506(){const _0xcceb17=['errorCode','5688594TFURER','status','error_code','currency','https://tesoft.uk/gateway/rapyd/','NEW','verifyPayment','last4','110Fzrjcg','\x20(GB\x20-\x20Britain)','/v1/hosted/payment_links/','===\x20RAPYD\x20SUCCESS\x20===','===\x20RAPYD\x20API\x20INCOMPLETE\x20RESPONSE\x20===','Rapyd\x20API\x20error\x20(','HTTP\x20','Parsed\x20Result:','130259jedOIm','amount','Response\x20Body:','PENDING','Redirect\x20URL:','PAYMENT_FAILED','Request\x20Body\x20(Updated\x20Format):','7599550YqGCJd','Failed\x20to\x20parse\x20JSON\x20response:','35hXDiAR','payment_method_type','entries','Error\x20message:','Rapyd\x20payment\x20verification\x20error:','payment_method_data','UNKNOWN','Response\x20data:','💳\x20Payment\x20Methods:\x20gb_visa_card,\x20gb_mastercard_card','parse','HTTP\x20error!\x20status:\x20',',\x20failureMessage=','Invalid\x20JSON\x20response\x20from\x20Rapyd\x20API:\x20','HTTP\x20Status:','processWebhook','===\x20RAPYD\x20SERVICE\x20ERROR\x20===','Incomplete\x20response:\x20missing\x20id\x20or\x20redirect_url','287304BMvrEi','POST','CAN','data','failure_message','message','JSON\x20Parse\x20Error:\x20','/v1/hosted/payment_links','RapydService','PAYMENT_CANCELED','toUpperCase','stringify','type','ERR','Response\x20Time:','Error\x20Message:','Failed\x20to\x20verify\x20Rapyd\x20payment:\x20','Status\x20Text:','1047489KJwapB','🌐\x20Rapyd\x20service\x20initialized\x20with\x20white\x20domain\x20proxy','1517400lDLeDQ','error','GET','apiUrl','headers','https://tesoft.uk/gateway/fail.php?id=','cardLast4','failure_code','ORDER:\x20','Error\x20Code:','CLO','372chVHwf','ACT','none','https://tesoft.uk/gateway/success.php?id=','TesSoft\x20Payment\x20System/1.0','paid','redirect_url','===\x20RAPYD\x20API\x20ERROR\x20===','🇬🇧\x20Country:\x20','🇬🇧\x20Using\x20GB\x20(Britain)\x20as\x20country\x20for\x20Rapyd\x20payment\x20link','Headers:','Failed\x20to\x20create\x20Rapyd\x20payment\x20link:\x20','logWhiteDomainResponse','EXP','Business\x20Error\x20(','8302qXzsGN','Status:','Unknown\x20error','application/json','logWhiteDomainError','):\x20','PAID','loggerService','===\x20PARSED\x20RAPYD\x20RESPONSE\x20===','../loggerService','now','EXPIRED','Raw\x20Response\x20Body:','rapyd','Payment\x20Link\x20ID:','FAILED','gb_mastercard_card','log','8rofGhr','6SPNnHq','Full\x20Error\x20Data:','Invalid\x20response\x20from\x20Rapyd\x20API:\x20missing\x20id\x20or\x20redirect_url','Rapyd\x20API\x20error:\x20','🔄\x20Rapyd\x20webhook\x20processed:\x20status='];a44_0x3506=function(){return _0xcceb17;};return a44_0x3506();}exports[a44_0x3909fb(0x14a)]=RapydService;