'use strict';const a56_0x5833c5=a56_0x2528;function a56_0x2528(_0x457eb7,_0x4a1b9b){const _0xb9b8df=a56_0xb9b8();return a56_0x2528=function(_0x2528b1,_0x2cd513){_0x2528b1=_0x2528b1-0x16b;let _0x576e3d=_0xb9b8df[_0x2528b1];return _0x576e3d;},a56_0x2528(_0x457eb7,_0x4a1b9b);}(function(_0x484c75,_0x2f2e59){const _0x2047a5=a56_0x2528,_0x541bc1=_0x484c75();while(!![]){try{const _0x34dd09=parseInt(_0x2047a5(0x18d))/0x1*(-parseInt(_0x2047a5(0x1a5))/0x2)+-parseInt(_0x2047a5(0x1c7))/0x3*(-parseInt(_0x2047a5(0x1de))/0x4)+parseInt(_0x2047a5(0x1bb))/0x5*(-parseInt(_0x2047a5(0x1a0))/0x6)+parseInt(_0x2047a5(0x1b4))/0x7+-parseInt(_0x2047a5(0x174))/0x8*(parseInt(_0x2047a5(0x1bc))/0x9)+-parseInt(_0x2047a5(0x1a6))/0xa*(-parseInt(_0x2047a5(0x17e))/0xb)+parseInt(_0x2047a5(0x196))/0xc;if(_0x34dd09===_0x2f2e59)break;else _0x541bc1['push'](_0x541bc1['shift']());}catch(_0x37a641){_0x541bc1['push'](_0x541bc1['shift']());}}}(a56_0xb9b8,0xd13da));function a56_0xb9b8(){const _0x4987b1=['message','data','Headers:','\x20(always\x20GB\x20for\x20Rapyd)','defineProperty','766414mXueza','Raw\x20Response\x20Body:','üá¨üáß\x20Country\x20used:\x20','\x20\x20\x20expiration:\x20',',\x20failureMessage=','gb_visa_card','Status\x20Text:','Error\x20message:','ERR','Failed\x20to\x20parse\x20JSON\x20response:','https://tesoft.uk/gateway/rapyd/','PAID','RapydService','fromEntries','gb_mastercard_card','1043zJNUlN','json','===\x20PARSED\x20RAPYD\x20RESPONSE\x20===','Error\x20Code:','Status:','CLO','===\x20RAPYD\x20API\x20REQUEST\x20(White\x20Domain\x20-\x20Updated\x20Format)\x20===','error_code','HTTP\x20error!\x20status:\x20','5801244UIulfa','Redirect\x20URL:','Payment\x20System/1.0','Response\x20Body:','PENDING','PAYMENT_COMPLETED','/v1/hosted/payment_links','Unknown\x20error','üá¨üáß\x20Country:\x20','rapyd','651432cIPZth','Parsed\x20Result:','Business\x20Error\x20(','\x20->\x20EUR:','===\x20RAPYD\x20API\x20INCOMPLETE\x20RESPONSE\x20===','3076yCsQjE','50ZLSvdZ','toUpperCase','EUR','Incomplete\x20response:\x20missing\x20id\x20or\x20redirect_url','\x20\x20\x20requested_currency:\x20EUR','currency','last4','üí≥\x20Payment\x20Methods:\x20gb_visa_card,\x20gb_mastercard_card','verifyPayment','errorCode','https://tesoft.uk/gateway/fail.php?id=','failure_code','Rapyd\x20API\x20error:\x20','type','11655434KTcFJr','loggerService','paid','HTTP\x20','===\x20RAPYD\x20API\x20RESPONSE\x20(White\x20Domain)\x20===','PAYMENT_CANCELED','SUCCESS','10KKkKQP','54niasLw','===\x20RAPYD\x20API\x20ERROR\x20===','stack','none','logWhiteDomainResponse','Unknown\x20error\x20from\x20Rapyd\x20API','amount','EXP','expiration','\x20\x20\x20fixed_side:\x20buy','log','237sQexnK','FAILED','logWhiteDomainRequest','redirect_url','failure_message','===\x20RAPYD\x20SERVICE\x20ERROR\x20===','buy','Response\x20data:','):\x20','PAYMENT_EXPIRED','EXPIRED','createPaymentLink','apiUrl','floor','GET','toISOString','UNKNOWN','processWebhook','POST','Full\x20Error\x20Data:','status','logWhiteDomainError','fixed_side','67972euGHhI','Rapyd\x20API\x20error\x20(','error','text','Failed\x20to\x20verify\x20Rapyd\x20payment:\x20','/v1/hosted/payment_links/','URL:','cardLast4','headers','payment_method_data','application/json','Failed\x20to\x20create\x20Rapyd\x20payment\x20link:\x20Unknown\x20error','ORDER:\x20','stringify','../loggerService','HTTP\x20Status:','1547984TpfkFF','CAN','PAYMENT_FAILED','===\x20RAPYD\x20API\x20BUSINESS\x20ERROR\x20===','now'];a56_0xb9b8=function(){return _0x4987b1;};return a56_0xb9b8();}Object[a56_0x5833c5(0x17d)](exports,'__esModule',{'value':!![]}),exports[a56_0x5833c5(0x18a)]=void 0x0;const loggerService_1=require(a56_0x5833c5(0x172));class RapydService{constructor(){const _0x3a6b6c=a56_0x5833c5;this['apiUrl']=_0x3a6b6c(0x188),console[_0x3a6b6c(0x1c6)]('üåê\x20Rapyd\x20service\x20initialized\x20with\x20white\x20domain\x20proxy');}async[a56_0x5833c5(0x1d2)](_0x182c68){const _0xfcb3ec=a56_0x5833c5,{orderId:_0x26a457,orderName:_0x2c9bb3,amount:_0x14c8c4,currency:_0x4c89e8,usage:_0x51a470,maxPayments:_0x402c4c,successUrl:_0x133138,failUrl:_0x46c5a9}=_0x182c68,_0x31a221=_0x4c89e8['toUpperCase'](),_0x3f5509='GB';console[_0xfcb3ec(0x1c6)]('üá¨üáß\x20Using\x20GB\x20(Britain)\x20as\x20country\x20for\x20Rapyd\x20payment\x20link');const _0xd1dce0='https://tesoft.uk/gateway/success.php?id='+_0x26a457,_0x11ff6e=_0xfcb3ec(0x1b0)+_0x26a457,_0x3f83cb={'amount':_0x14c8c4,'currency':_0x31a221,'cancel_checkout_url':_0x11ff6e,'complete_checkout_url':_0xd1dce0,'complete_payment_url':_0xd1dce0,'merchant_reference_id':_0x26a457,'description':_0xfcb3ec(0x170)+_0x26a457,'country':'GB','payment_method_types_include':[_0xfcb3ec(0x183),_0xfcb3ec(0x18c)],'custom_elements':{'display_description':!![]}};if(_0x31a221!==_0xfcb3ec(0x1a8)){const _0x547360=Math[_0xfcb3ec(0x1d4)](Date[_0xfcb3ec(0x178)]()/0x3e8)+0x1e*0x3c;_0x3f83cb[_0xfcb3ec(0x1dd)]=_0xfcb3ec(0x1cd),_0x3f83cb['requested_currency']=_0xfcb3ec(0x1a8),_0x3f83cb[_0xfcb3ec(0x1c4)]=_0x547360,console[_0xfcb3ec(0x1c6)]('üí±\x20Adding\x20currency\x20conversion\x20fields\x20for\x20'+_0x31a221+_0xfcb3ec(0x1a3)),console['log'](_0xfcb3ec(0x1c5)),console['log'](_0xfcb3ec(0x1aa)),console[_0xfcb3ec(0x1c6)](_0xfcb3ec(0x181)+_0x547360+'\x20('+new Date(_0x547360*0x3e8)[_0xfcb3ec(0x1d6)]()+')');}const _0x8c541=Date[_0xfcb3ec(0x178)]();try{console[_0xfcb3ec(0x1c6)](_0xfcb3ec(0x193)),console[_0xfcb3ec(0x1c6)](_0xfcb3ec(0x1e4),this[_0xfcb3ec(0x1d3)]),console[_0xfcb3ec(0x1c6)]('Request\x20Body\x20(Updated\x20Format):',JSON['stringify'](_0x3f83cb,null,0x2)),console[_0xfcb3ec(0x1c6)](_0xfcb3ec(0x19e)+_0x3f5509+_0xfcb3ec(0x17c)),console[_0xfcb3ec(0x1c6)](_0xfcb3ec(0x1ad)),loggerService_1[_0xfcb3ec(0x1b5)][_0xfcb3ec(0x1c9)](_0xfcb3ec(0x19f),_0xfcb3ec(0x19c),_0xfcb3ec(0x1d9),_0x3f83cb);const _0x4e814e=await fetch(this[_0xfcb3ec(0x1d3)],{'method':'POST','headers':{'Content-Type':_0xfcb3ec(0x16e),'User-Agent':_0xfcb3ec(0x198)},'body':JSON[_0xfcb3ec(0x171)](_0x3f83cb)}),_0x3fe65c=Date['now']()-_0x8c541;console[_0xfcb3ec(0x1c6)](_0xfcb3ec(0x1b8)),console[_0xfcb3ec(0x1c6)](_0xfcb3ec(0x191),_0x4e814e[_0xfcb3ec(0x1db)]),console[_0xfcb3ec(0x1c6)](_0xfcb3ec(0x184),_0x4e814e['statusText']),console['log'](_0xfcb3ec(0x17b),Object[_0xfcb3ec(0x18b)](_0x4e814e[_0xfcb3ec(0x16c)]['entries']())),console[_0xfcb3ec(0x1c6)]('Response\x20Time:',_0x3fe65c+'ms');const _0x3f6ce5=await _0x4e814e[_0xfcb3ec(0x1e1)]();console['log'](_0xfcb3ec(0x17f),_0x3f6ce5);if(!_0x4e814e['ok']){console[_0xfcb3ec(0x1e0)](_0xfcb3ec(0x1bd)),console[_0xfcb3ec(0x1e0)](_0xfcb3ec(0x173),_0x4e814e[_0xfcb3ec(0x1db)]),console[_0xfcb3ec(0x1e0)](_0xfcb3ec(0x199),_0x3f6ce5),loggerService_1[_0xfcb3ec(0x1b5)]['logWhiteDomainResponse'](_0xfcb3ec(0x19f),_0xfcb3ec(0x19c),_0x4e814e[_0xfcb3ec(0x1db)],_0x3f6ce5,_0x3fe65c),loggerService_1[_0xfcb3ec(0x1b5)]['logWhiteDomainError'](_0xfcb3ec(0x19f),_0xfcb3ec(0x19c),_0xfcb3ec(0x1b7)+_0x4e814e[_0xfcb3ec(0x1db)]+':\x20'+_0x3f6ce5);throw new Error(_0xfcb3ec(0x195)+_0x4e814e[_0xfcb3ec(0x1db)]+',\x20body:\x20'+_0x3f6ce5);}let _0x41b977;try{_0x41b977=JSON['parse'](_0x3f6ce5);}catch(_0x3faafb){console[_0xfcb3ec(0x1e0)](_0xfcb3ec(0x187),_0x3faafb),loggerService_1['loggerService']['logWhiteDomainError'](_0xfcb3ec(0x19f),_0xfcb3ec(0x19c),'JSON\x20Parse\x20Error:\x20'+_0x3faafb);throw new Error('Invalid\x20JSON\x20response\x20from\x20Rapyd\x20API:\x20'+_0x3f6ce5);}console[_0xfcb3ec(0x1c6)](_0xfcb3ec(0x18f)),console[_0xfcb3ec(0x1c6)](_0xfcb3ec(0x1a1),JSON[_0xfcb3ec(0x171)](_0x41b977,null,0x2)),loggerService_1[_0xfcb3ec(0x1b5)]['logWhiteDomainResponse'](_0xfcb3ec(0x19f),_0xfcb3ec(0x19c),_0x4e814e[_0xfcb3ec(0x1db)],_0x41b977,_0x3fe65c);if(_0x41b977['status']?.['status']!=='SUCCESS'){const _0x5173b2=_0x41b977[_0xfcb3ec(0x1db)]?.[_0xfcb3ec(0x179)]||_0xfcb3ec(0x1c1),_0x11ebef=_0x41b977[_0xfcb3ec(0x1db)]?.['error_code']||_0xfcb3ec(0x1d7);console[_0xfcb3ec(0x1e0)](_0xfcb3ec(0x177)),console['error'](_0xfcb3ec(0x190),_0x11ebef),console[_0xfcb3ec(0x1e0)]('Error\x20Message:',_0x5173b2),console[_0xfcb3ec(0x1e0)](_0xfcb3ec(0x1da),_0x41b977[_0xfcb3ec(0x1db)]),loggerService_1[_0xfcb3ec(0x1b5)]['logWhiteDomainError']('rapyd','/v1/hosted/payment_links',_0xfcb3ec(0x1a2)+_0x11ebef+'):\x20'+_0x5173b2);throw new Error(_0xfcb3ec(0x1df)+_0x11ebef+_0xfcb3ec(0x1cf)+_0x5173b2);}if(!_0x41b977[_0xfcb3ec(0x17a)]?.['id']||!_0x41b977[_0xfcb3ec(0x17a)]?.[_0xfcb3ec(0x1ca)]){console['error'](_0xfcb3ec(0x1a4)),console[_0xfcb3ec(0x1e0)]('Missing\x20id\x20or\x20redirect_url\x20in\x20response'),console['error'](_0xfcb3ec(0x1ce),_0x41b977[_0xfcb3ec(0x17a)]),loggerService_1[_0xfcb3ec(0x1b5)][_0xfcb3ec(0x1dc)](_0xfcb3ec(0x19f),_0xfcb3ec(0x19c),_0xfcb3ec(0x1a9));throw new Error('Invalid\x20response\x20from\x20Rapyd\x20API:\x20missing\x20id\x20or\x20redirect_url');}return console[_0xfcb3ec(0x1c6)]('===\x20RAPYD\x20SUCCESS\x20==='),console[_0xfcb3ec(0x1c6)]('Payment\x20Link\x20ID:',_0x41b977[_0xfcb3ec(0x17a)]['id']),console['log'](_0xfcb3ec(0x197),_0x41b977['data']['redirect_url']),console[_0xfcb3ec(0x1c6)](_0xfcb3ec(0x180)+_0x3f5509+'\x20(GB\x20-\x20Britain)'),console[_0xfcb3ec(0x1c6)](_0xfcb3ec(0x1ad)),{'gateway_payment_id':_0x41b977[_0xfcb3ec(0x17a)]['id'],'payment_url':_0x41b977[_0xfcb3ec(0x17a)][_0xfcb3ec(0x1ca)]};}catch(_0x7e891c){console[_0xfcb3ec(0x1e0)](_0xfcb3ec(0x1cc)),console['error']('Error\x20details:',_0x7e891c),loggerService_1[_0xfcb3ec(0x1b5)]['logWhiteDomainError']('rapyd',_0xfcb3ec(0x19c),_0x7e891c);if(_0x7e891c instanceof Error){console[_0xfcb3ec(0x1e0)](_0xfcb3ec(0x185),_0x7e891c[_0xfcb3ec(0x179)]),console['error']('Error\x20stack:',_0x7e891c[_0xfcb3ec(0x1be)]);throw new Error('Failed\x20to\x20create\x20Rapyd\x20payment\x20link:\x20'+_0x7e891c['message']);}throw new Error(_0xfcb3ec(0x16f));}}async[a56_0x5833c5(0x1ae)](_0x2bab0a){const _0x4f7fff=a56_0x5833c5,_0x4f14e3=Date[_0x4f7fff(0x178)]();try{loggerService_1[_0x4f7fff(0x1b5)][_0x4f7fff(0x1c9)]('rapyd','/v1/hosted/payment_links/'+_0x2bab0a,_0x4f7fff(0x1d5),{});const _0x4b3ee0=await fetch(this[_0x4f7fff(0x1d3)]+'/'+_0x2bab0a,{'method':_0x4f7fff(0x1d5),'headers':{'Content-Type':_0x4f7fff(0x16e),'User-Agent':_0x4f7fff(0x198)}}),_0x415faa=Date[_0x4f7fff(0x178)]()-_0x4f14e3;if(!_0x4b3ee0['ok']){const _0x248788=await _0x4b3ee0[_0x4f7fff(0x1e1)]();loggerService_1[_0x4f7fff(0x1b5)]['logWhiteDomainResponse'](_0x4f7fff(0x19f),_0x4f7fff(0x1e3)+_0x2bab0a,_0x4b3ee0[_0x4f7fff(0x1db)],_0x248788,_0x415faa);throw new Error('HTTP\x20error!\x20status:\x20'+_0x4b3ee0[_0x4f7fff(0x1db)]);}const _0x3c0e76=await _0x4b3ee0[_0x4f7fff(0x18e)]();loggerService_1[_0x4f7fff(0x1b5)][_0x4f7fff(0x1c0)](_0x4f7fff(0x19f),'/v1/hosted/payment_links/'+_0x2bab0a,_0x4b3ee0[_0x4f7fff(0x1db)],_0x3c0e76,_0x415faa);if(_0x3c0e76[_0x4f7fff(0x1db)]?.['status']!==_0x4f7fff(0x1ba)){loggerService_1[_0x4f7fff(0x1b5)]['logWhiteDomainError']('rapyd',_0x4f7fff(0x1e3)+_0x2bab0a,_0x4f7fff(0x1b2)+(_0x3c0e76[_0x4f7fff(0x1db)]?.[_0x4f7fff(0x179)]||'Unknown\x20error'));throw new Error(_0x4f7fff(0x1b2)+(_0x3c0e76[_0x4f7fff(0x1db)]?.[_0x4f7fff(0x179)]||_0x4f7fff(0x19d)));}let _0x96b761=_0x4f7fff(0x19a);if(_0x3c0e76[_0x4f7fff(0x17a)]?.[_0x4f7fff(0x1db)])switch(_0x3c0e76['data'][_0x4f7fff(0x1db)][_0x4f7fff(0x1a7)]()){case _0x4f7fff(0x192):_0x96b761=_0x4f7fff(0x189);break;case _0x4f7fff(0x175):_0x96b761=_0x4f7fff(0x1c8);break;case _0x4f7fff(0x1c3):_0x96b761=_0x4f7fff(0x1d1);break;case _0x4f7fff(0x186):_0x96b761=_0x4f7fff(0x1c8);break;case'NEW':case'ACT':default:_0x96b761='PENDING';break;}return{'status':_0x96b761,'amount':_0x3c0e76[_0x4f7fff(0x17a)]?.[_0x4f7fff(0x1c2)],'currency':_0x3c0e76['data']?.[_0x4f7fff(0x1ab)]};}catch(_0x1c17fd){console[_0x4f7fff(0x1e0)]('Rapyd\x20payment\x20verification\x20error:',_0x1c17fd),loggerService_1[_0x4f7fff(0x1b5)][_0x4f7fff(0x1dc)](_0x4f7fff(0x19f),_0x4f7fff(0x1e3)+_0x2bab0a,_0x1c17fd);throw new Error(_0x4f7fff(0x1e2)+(_0x1c17fd instanceof Error?_0x1c17fd[_0x4f7fff(0x179)]:'Unknown\x20error'));}}async[a56_0x5833c5(0x1d8)](_0x463b9c){const _0x430663=a56_0x5833c5;console[_0x430663(0x1c6)]('Processing\x20Rapyd\x20webhook:',_0x463b9c);let _0x197c71='PENDING',_0x33c21c;_0x463b9c['data']?.[_0x430663(0x1cb)]&&(_0x33c21c=_0x463b9c[_0x430663(0x17a)][_0x430663(0x1cb)],console[_0x430663(0x1c6)]('üí•\x20Rapyd\x20failure\x20message:\x20'+_0x33c21c));switch(_0x463b9c[_0x430663(0x1b3)]?.[_0x430663(0x1a7)]()){case _0x430663(0x19b):_0x463b9c[_0x430663(0x17a)]?.[_0x430663(0x1b6)]===!![]&&_0x463b9c[_0x430663(0x17a)]?.[_0x430663(0x1db)]===_0x430663(0x192)?_0x197c71=_0x430663(0x189):_0x197c71='PENDING';break;case _0x430663(0x1b9):_0x197c71=_0x430663(0x1c8);break;case _0x430663(0x1d0):_0x197c71=_0x430663(0x1d1);break;case _0x430663(0x176):_0x197c71=_0x430663(0x1c8);!_0x33c21c&&_0x463b9c['data']?.[_0x430663(0x1cb)]&&(_0x33c21c=_0x463b9c[_0x430663(0x17a)][_0x430663(0x1cb)]);break;default:switch(_0x463b9c['data']?.['status']?.[_0x430663(0x1a7)]()){case _0x430663(0x192):_0x463b9c['data']?.[_0x430663(0x1b6)]===!![]?_0x197c71=_0x430663(0x189):_0x197c71=_0x430663(0x1c8);break;case _0x430663(0x175):_0x197c71=_0x430663(0x1c8);break;case _0x430663(0x1c3):_0x197c71='EXPIRED';break;case _0x430663(0x186):_0x197c71=_0x430663(0x1c8);!_0x33c21c&&_0x463b9c['data']?.[_0x430663(0x1cb)]&&(_0x33c21c=_0x463b9c[_0x430663(0x17a)][_0x430663(0x1cb)]);break;case'NEW':case'ACT':default:_0x197c71=_0x430663(0x19a);break;}break;}const _0x376478={};return _0x463b9c['data']?.[_0x430663(0x16d)]?.[_0x430663(0x1ac)]&&(_0x376478[_0x430663(0x16b)]=_0x463b9c[_0x430663(0x17a)]['payment_method_data'][_0x430663(0x1ac)]),_0x463b9c[_0x430663(0x17a)]?.['payment_method_type']&&(_0x376478['paymentMethod']=_0x463b9c[_0x430663(0x17a)]['payment_method_type']),_0x463b9c[_0x430663(0x17a)]?.[_0x430663(0x194)]&&(_0x376478[_0x430663(0x1af)]=_0x463b9c[_0x430663(0x17a)]['error_code']),_0x463b9c[_0x430663(0x17a)]?.[_0x430663(0x1b1)]&&(_0x376478['failureCode']=_0x463b9c[_0x430663(0x17a)]['failure_code']),console[_0x430663(0x1c6)]('üîÑ\x20Rapyd\x20webhook\x20processed:\x20status='+_0x197c71+_0x430663(0x182)+(_0x33c21c||_0x430663(0x1bf))),{'paymentId':_0x463b9c['data']?.['merchant_reference_id']||'','status':_0x197c71,'amount':_0x463b9c[_0x430663(0x17a)]?.[_0x430663(0x1c2)],'currency':_0x463b9c['data']?.[_0x430663(0x1ab)],'failureMessage':_0x33c21c,'additionalInfo':_0x376478};}}exports[a56_0x5833c5(0x18a)]=RapydService;