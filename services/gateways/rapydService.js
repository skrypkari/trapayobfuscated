'use strict';const a45_0x2a9c2c=a45_0x1d17;(function(_0xbf82c3,_0x31004c){const _0x286871=a45_0x1d17,_0x51d27f=_0xbf82c3();while(!![]){try{const _0x4efec5=-parseInt(_0x286871(0xe8))/0x1*(parseInt(_0x286871(0xf6))/0x2)+parseInt(_0x286871(0xc6))/0x3+parseInt(_0x286871(0xec))/0x4+parseInt(_0x286871(0x120))/0x5+parseInt(_0x286871(0xe1))/0x6*(-parseInt(_0x286871(0x121))/0x7)+parseInt(_0x286871(0xc4))/0x8*(parseInt(_0x286871(0xeb))/0x9)+-parseInt(_0x286871(0xe3))/0xa;if(_0x4efec5===_0x31004c)break;else _0x51d27f['push'](_0x51d27f['shift']());}catch(_0x5d12a7){_0x51d27f['push'](_0x51d27f['shift']());}}}(a45_0x37a1,0x7efba));function a45_0x37a1(){const _0xe63165=['Redirect\x20URL:','logWhiteDomainResponse','Rapyd\x20payment\x20verification\x20error:','processWebhook','===\x20RAPYD\x20API\x20INCOMPLETE\x20RESPONSE\x20===','defineProperty','none','merchant_reference_id','Error\x20Message:','apiUrl','üí•\x20Rapyd\x20failure\x20message:\x20','CAN','Raw\x20Response\x20Body:','HTTP\x20Status:','status','gb_visa_card','üá¨üáß\x20Country:\x20','2276728oeGTdW','NEW','2165685tWHDsS','payment_method_data','PENDING','error_code','verifyPayment','Error\x20details:',',\x20failureMessage=','../loggerService','Error\x20message:','EXP','SUCCESS','UNKNOWN','üá¨üáß\x20Using\x20GB\x20(Britain)\x20as\x20country\x20for\x20Rapyd\x20payment\x20link','https://tesoft.uk/gateway/fail.php?id=','redirect_url','log','paid','Headers:',',\x20body:\x20','/v1/hosted/payment_links','CLO','===\x20RAPYD\x20API\x20RESPONSE\x20(White\x20Domain)\x20===','last4','JSON\x20Parse\x20Error:\x20','\x20(always\x20GB\x20for\x20Rapyd)','toUpperCase','ACT','4988748FeBZdd','HTTP\x20error!\x20status:\x20','10710900zYkpLw','loggerService','errorCode','Rapyd\x20API\x20error:\x20','):\x20','6145LvhZno','json','Failed\x20to\x20verify\x20Rapyd\x20payment:\x20','27YEZSUE','3157160RjDIWL','Failed\x20to\x20create\x20Rapyd\x20payment\x20link:\x20Unknown\x20error','Response\x20data:','üá¨üáß\x20Country\x20used:\x20','Error\x20Code:','Request\x20Body\x20(Updated\x20Format):','amount','Rapyd\x20API\x20error\x20(','__esModule','TesSoft\x20Payment\x20System/1.0','258YPVvNU','Failed\x20to\x20parse\x20JSON\x20response:','Status\x20Text:','EXPIRED','ERR','PAID','Full\x20Error\x20Data:','FAILED','currency','stringify','Failed\x20to\x20create\x20Rapyd\x20payment\x20link:\x20','üí≥\x20Payment\x20Methods:\x20gb_visa_card,\x20gb_mastercard_card','failure_message','failureCode','PAYMENT_CANCELED','headers','message','Missing\x20id\x20or\x20redirect_url\x20in\x20response','Unknown\x20error\x20from\x20Rapyd\x20API','===\x20RAPYD\x20API\x20REQUEST\x20(White\x20Domain\x20-\x20Updated\x20Format)\x20===','type','HTTP\x20','RapydService','PAYMENT_COMPLETED','stack','Invalid\x20response\x20from\x20Rapyd\x20API:\x20missing\x20id\x20or\x20redirect_url','logWhiteDomainRequest','Unknown\x20error','parse','POST','===\x20RAPYD\x20SUCCESS\x20===','/v1/hosted/payment_links/','now','Invalid\x20JSON\x20response\x20from\x20Rapyd\x20API:\x20','GET','rapyd','https://tesoft.uk/gateway/success.php?id=','===\x20RAPYD\x20SERVICE\x20ERROR\x20===','payment_method_type','statusText','error','text','4252085lJeAwH','7mptcjW','application/json','data','cardLast4','logWhiteDomainError'];a45_0x37a1=function(){return _0xe63165;};return a45_0x37a1();}function a45_0x1d17(_0xda6eaf,_0x592515){const _0x37a102=a45_0x37a1();return a45_0x1d17=function(_0x1d1716,_0x596b8c){_0x1d1716=_0x1d1716-0xc4;let _0x40ce34=_0x37a102[_0x1d1716];return _0x40ce34;},a45_0x1d17(_0xda6eaf,_0x592515);}Object[a45_0x2a9c2c(0x12b)](exports,a45_0x2a9c2c(0xf4),{'value':!![]}),exports[a45_0x2a9c2c(0x10c)]=void 0x0;const loggerService_1=require(a45_0x2a9c2c(0xcd));class RapydService{constructor(){const _0x88928a=a45_0x2a9c2c;this[_0x88928a(0x12f)]='https://tesoft.uk/gateway/rapyd/',console[_0x88928a(0xd5)]('üåê\x20Rapyd\x20service\x20initialized\x20with\x20white\x20domain\x20proxy');}async['createPaymentLink'](_0x4b353){const _0x4c8875=a45_0x2a9c2c,{orderId:_0x116ba3,orderName:_0x1fa5b6,amount:_0x3cb218,currency:_0xd3351,usage:_0x337438,maxPayments:_0x1622e2,successUrl:_0x16e318,failUrl:_0x764714}=_0x4b353,_0x14730d=_0xd3351[_0x4c8875(0xdf)](),_0x148ad3='GB';console[_0x4c8875(0xd5)](_0x4c8875(0xd2));const _0xffd500=_0x4c8875(0x11a)+_0x116ba3,_0x31edac=_0x4c8875(0xd3)+_0x116ba3,_0x484a37={'amount':_0x3cb218,'currency':_0x14730d,'cancel_checkout_url':_0x31edac,'complete_checkout_url':_0xffd500,'complete_payment_url':_0xffd500,'merchant_reference_id':_0x116ba3,'description':'ORDER:\x20'+_0x116ba3,'country':'GB','payment_method_types_include':[_0x4c8875(0x135),'gb_mastercard_card'],'custom_elements':{'display_description':!![]}},_0x1ddaed=Date[_0x4c8875(0x116)]();try{console[_0x4c8875(0xd5)](_0x4c8875(0x109)),console['log']('URL:',this[_0x4c8875(0x12f)]),console[_0x4c8875(0xd5)](_0x4c8875(0xf1),JSON[_0x4c8875(0xff)](_0x484a37,null,0x2)),console[_0x4c8875(0xd5)](_0x4c8875(0x136)+_0x148ad3+_0x4c8875(0xde)),console[_0x4c8875(0xd5)]('üí≥\x20Payment\x20Methods:\x20gb_visa_card,\x20gb_mastercard_card'),loggerService_1['loggerService'][_0x4c8875(0x110)](_0x4c8875(0x119),'/v1/hosted/payment_links','POST',_0x484a37);const _0x46c061=await fetch(this[_0x4c8875(0x12f)],{'method':_0x4c8875(0x113),'headers':{'Content-Type':_0x4c8875(0x122),'User-Agent':'TesSoft\x20Payment\x20System/1.0'},'body':JSON[_0x4c8875(0xff)](_0x484a37)}),_0x3c37a1=Date[_0x4c8875(0x116)]()-_0x1ddaed;console['log'](_0x4c8875(0xdb)),console[_0x4c8875(0xd5)]('Status:',_0x46c061['status']),console[_0x4c8875(0xd5)](_0x4c8875(0xf8),_0x46c061[_0x4c8875(0x11d)]),console['log'](_0x4c8875(0xd7),Object['fromEntries'](_0x46c061[_0x4c8875(0x105)]['entries']())),console['log']('Response\x20Time:',_0x3c37a1+'ms');const _0x49636f=await _0x46c061[_0x4c8875(0x11f)]();console['log'](_0x4c8875(0x132),_0x49636f);if(!_0x46c061['ok']){console[_0x4c8875(0x11e)]('===\x20RAPYD\x20API\x20ERROR\x20==='),console['error'](_0x4c8875(0x133),_0x46c061[_0x4c8875(0x134)]),console[_0x4c8875(0x11e)]('Response\x20Body:',_0x49636f),loggerService_1[_0x4c8875(0xe4)][_0x4c8875(0x127)](_0x4c8875(0x119),_0x4c8875(0xd9),_0x46c061[_0x4c8875(0x134)],_0x49636f,_0x3c37a1),loggerService_1[_0x4c8875(0xe4)][_0x4c8875(0x125)](_0x4c8875(0x119),'/v1/hosted/payment_links',_0x4c8875(0x10b)+_0x46c061[_0x4c8875(0x134)]+':\x20'+_0x49636f);throw new Error(_0x4c8875(0xe2)+_0x46c061[_0x4c8875(0x134)]+_0x4c8875(0xd8)+_0x49636f);}let _0x2b00a3;try{_0x2b00a3=JSON[_0x4c8875(0x112)](_0x49636f);}catch(_0x510f31){console[_0x4c8875(0x11e)](_0x4c8875(0xf7),_0x510f31),loggerService_1[_0x4c8875(0xe4)]['logWhiteDomainError'](_0x4c8875(0x119),'/v1/hosted/payment_links',_0x4c8875(0xdd)+_0x510f31);throw new Error(_0x4c8875(0x117)+_0x49636f);}console[_0x4c8875(0xd5)]('===\x20PARSED\x20RAPYD\x20RESPONSE\x20==='),console[_0x4c8875(0xd5)]('Parsed\x20Result:',JSON[_0x4c8875(0xff)](_0x2b00a3,null,0x2)),loggerService_1[_0x4c8875(0xe4)][_0x4c8875(0x127)](_0x4c8875(0x119),_0x4c8875(0xd9),_0x46c061[_0x4c8875(0x134)],_0x2b00a3,_0x3c37a1);if(_0x2b00a3[_0x4c8875(0x134)]?.[_0x4c8875(0x134)]!==_0x4c8875(0xd0)){const _0x1b5395=_0x2b00a3[_0x4c8875(0x134)]?.[_0x4c8875(0x106)]||_0x4c8875(0x108),_0x2f59ae=_0x2b00a3[_0x4c8875(0x134)]?.[_0x4c8875(0xc9)]||_0x4c8875(0xd1);console[_0x4c8875(0x11e)]('===\x20RAPYD\x20API\x20BUSINESS\x20ERROR\x20==='),console[_0x4c8875(0x11e)](_0x4c8875(0xf0),_0x2f59ae),console[_0x4c8875(0x11e)](_0x4c8875(0x12e),_0x1b5395),console[_0x4c8875(0x11e)](_0x4c8875(0xfc),_0x2b00a3[_0x4c8875(0x134)]),loggerService_1[_0x4c8875(0xe4)][_0x4c8875(0x125)](_0x4c8875(0x119),'/v1/hosted/payment_links','Business\x20Error\x20('+_0x2f59ae+_0x4c8875(0xe7)+_0x1b5395);throw new Error(_0x4c8875(0xf3)+_0x2f59ae+'):\x20'+_0x1b5395);}if(!_0x2b00a3[_0x4c8875(0x123)]?.['id']||!_0x2b00a3[_0x4c8875(0x123)]?.[_0x4c8875(0xd4)]){console[_0x4c8875(0x11e)](_0x4c8875(0x12a)),console['error'](_0x4c8875(0x107)),console[_0x4c8875(0x11e)](_0x4c8875(0xee),_0x2b00a3[_0x4c8875(0x123)]),loggerService_1['loggerService'][_0x4c8875(0x125)](_0x4c8875(0x119),'/v1/hosted/payment_links','Incomplete\x20response:\x20missing\x20id\x20or\x20redirect_url');throw new Error(_0x4c8875(0x10f));}return console[_0x4c8875(0xd5)](_0x4c8875(0x114)),console[_0x4c8875(0xd5)]('Payment\x20Link\x20ID:',_0x2b00a3['data']['id']),console[_0x4c8875(0xd5)](_0x4c8875(0x126),_0x2b00a3[_0x4c8875(0x123)][_0x4c8875(0xd4)]),console['log'](_0x4c8875(0xef)+_0x148ad3+'\x20(GB\x20-\x20Britain)'),console[_0x4c8875(0xd5)](_0x4c8875(0x101)),{'gateway_payment_id':_0x2b00a3['data']['id'],'payment_url':_0x2b00a3[_0x4c8875(0x123)][_0x4c8875(0xd4)]};}catch(_0x374c01){console[_0x4c8875(0x11e)](_0x4c8875(0x11b)),console['error'](_0x4c8875(0xcb),_0x374c01),loggerService_1[_0x4c8875(0xe4)]['logWhiteDomainError'](_0x4c8875(0x119),_0x4c8875(0xd9),_0x374c01);if(_0x374c01 instanceof Error){console[_0x4c8875(0x11e)](_0x4c8875(0xce),_0x374c01[_0x4c8875(0x106)]),console[_0x4c8875(0x11e)]('Error\x20stack:',_0x374c01[_0x4c8875(0x10e)]);throw new Error(_0x4c8875(0x100)+_0x374c01['message']);}throw new Error(_0x4c8875(0xed));}}async[a45_0x2a9c2c(0xca)](_0x36fdb3){const _0x55aa13=a45_0x2a9c2c,_0x2fcb53=Date[_0x55aa13(0x116)]();try{loggerService_1[_0x55aa13(0xe4)][_0x55aa13(0x110)](_0x55aa13(0x119),_0x55aa13(0x115)+_0x36fdb3,'GET',{});const _0x5cd98d=await fetch(this[_0x55aa13(0x12f)]+'/'+_0x36fdb3,{'method':_0x55aa13(0x118),'headers':{'Content-Type':'application/json','User-Agent':_0x55aa13(0xf5)}}),_0x45badb=Date['now']()-_0x2fcb53;if(!_0x5cd98d['ok']){const _0x29cad3=await _0x5cd98d[_0x55aa13(0x11f)]();loggerService_1[_0x55aa13(0xe4)]['logWhiteDomainResponse']('rapyd','/v1/hosted/payment_links/'+_0x36fdb3,_0x5cd98d['status'],_0x29cad3,_0x45badb);throw new Error(_0x55aa13(0xe2)+_0x5cd98d['status']);}const _0x2a6589=await _0x5cd98d[_0x55aa13(0xe9)]();loggerService_1[_0x55aa13(0xe4)]['logWhiteDomainResponse'](_0x55aa13(0x119),_0x55aa13(0x115)+_0x36fdb3,_0x5cd98d[_0x55aa13(0x134)],_0x2a6589,_0x45badb);if(_0x2a6589[_0x55aa13(0x134)]?.[_0x55aa13(0x134)]!=='SUCCESS'){loggerService_1[_0x55aa13(0xe4)][_0x55aa13(0x125)]('rapyd','/v1/hosted/payment_links/'+_0x36fdb3,'Rapyd\x20API\x20error:\x20'+(_0x2a6589['status']?.[_0x55aa13(0x106)]||_0x55aa13(0x111)));throw new Error(_0x55aa13(0xe6)+(_0x2a6589[_0x55aa13(0x134)]?.[_0x55aa13(0x106)]||'Unknown\x20error'));}let _0xdd969e=_0x55aa13(0xc8);if(_0x2a6589[_0x55aa13(0x123)]?.[_0x55aa13(0x134)])switch(_0x2a6589[_0x55aa13(0x123)][_0x55aa13(0x134)][_0x55aa13(0xdf)]()){case _0x55aa13(0xda):_0xdd969e=_0x55aa13(0xfb);break;case _0x55aa13(0x131):_0xdd969e=_0x55aa13(0xfd);break;case _0x55aa13(0xcf):_0xdd969e=_0x55aa13(0xf9);break;case _0x55aa13(0xfa):_0xdd969e='FAILED';break;case _0x55aa13(0xc5):case _0x55aa13(0xe0):default:_0xdd969e=_0x55aa13(0xc8);break;}return{'status':_0xdd969e,'amount':_0x2a6589[_0x55aa13(0x123)]?.[_0x55aa13(0xf2)],'currency':_0x2a6589['data']?.['currency']};}catch(_0x809528){console['error'](_0x55aa13(0x128),_0x809528),loggerService_1['loggerService']['logWhiteDomainError'](_0x55aa13(0x119),_0x55aa13(0x115)+_0x36fdb3,_0x809528);throw new Error(_0x55aa13(0xea)+(_0x809528 instanceof Error?_0x809528[_0x55aa13(0x106)]:_0x55aa13(0x111)));}}async[a45_0x2a9c2c(0x129)](_0x512545){const _0x5f5799=a45_0x2a9c2c;console[_0x5f5799(0xd5)]('Processing\x20Rapyd\x20webhook:',_0x512545);let _0x328e21=_0x5f5799(0xc8),_0x382e32;_0x512545[_0x5f5799(0x123)]?.[_0x5f5799(0x102)]&&(_0x382e32=_0x512545['data'][_0x5f5799(0x102)],console[_0x5f5799(0xd5)](_0x5f5799(0x130)+_0x382e32));switch(_0x512545[_0x5f5799(0x10a)]?.[_0x5f5799(0xdf)]()){case _0x5f5799(0x10d):_0x512545[_0x5f5799(0x123)]?.[_0x5f5799(0xd6)]===!![]&&_0x512545[_0x5f5799(0x123)]?.['status']==='CLO'?_0x328e21=_0x5f5799(0xfb):_0x328e21=_0x5f5799(0xc8);break;case _0x5f5799(0x104):_0x328e21=_0x5f5799(0xfd);break;case'PAYMENT_EXPIRED':_0x328e21=_0x5f5799(0xf9);break;case'PAYMENT_FAILED':_0x328e21='FAILED';!_0x382e32&&_0x512545['data']?.[_0x5f5799(0x102)]&&(_0x382e32=_0x512545[_0x5f5799(0x123)]['failure_message']);break;default:switch(_0x512545['data']?.[_0x5f5799(0x134)]?.['toUpperCase']()){case _0x5f5799(0xda):_0x512545[_0x5f5799(0x123)]?.[_0x5f5799(0xd6)]===!![]?_0x328e21=_0x5f5799(0xfb):_0x328e21=_0x5f5799(0xfd);break;case _0x5f5799(0x131):_0x328e21=_0x5f5799(0xfd);break;case'EXP':_0x328e21=_0x5f5799(0xf9);break;case _0x5f5799(0xfa):_0x328e21=_0x5f5799(0xfd);!_0x382e32&&_0x512545[_0x5f5799(0x123)]?.[_0x5f5799(0x102)]&&(_0x382e32=_0x512545[_0x5f5799(0x123)][_0x5f5799(0x102)]);break;case _0x5f5799(0xc5):case _0x5f5799(0xe0):default:_0x328e21=_0x5f5799(0xc8);break;}break;}const _0x578dae={};return _0x512545[_0x5f5799(0x123)]?.['payment_method_data']?.[_0x5f5799(0xdc)]&&(_0x578dae[_0x5f5799(0x124)]=_0x512545[_0x5f5799(0x123)][_0x5f5799(0xc7)][_0x5f5799(0xdc)]),_0x512545[_0x5f5799(0x123)]?.[_0x5f5799(0x11c)]&&(_0x578dae['paymentMethod']=_0x512545[_0x5f5799(0x123)][_0x5f5799(0x11c)]),_0x512545['data']?.['error_code']&&(_0x578dae[_0x5f5799(0xe5)]=_0x512545['data']['error_code']),_0x512545[_0x5f5799(0x123)]?.['failure_code']&&(_0x578dae[_0x5f5799(0x103)]=_0x512545[_0x5f5799(0x123)]['failure_code']),console[_0x5f5799(0xd5)]('üîÑ\x20Rapyd\x20webhook\x20processed:\x20status='+_0x328e21+_0x5f5799(0xcc)+(_0x382e32||_0x5f5799(0x12c))),{'paymentId':_0x512545[_0x5f5799(0x123)]?.[_0x5f5799(0x12d)]||'','status':_0x328e21,'amount':_0x512545[_0x5f5799(0x123)]?.[_0x5f5799(0xf2)],'currency':_0x512545['data']?.[_0x5f5799(0xfe)],'failureMessage':_0x382e32,'additionalInfo':_0x578dae};}}exports['RapydService']=RapydService;