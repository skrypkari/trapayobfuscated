'use strict';const a69_0x4eaa43=a69_0x4434;function a69_0x4434(_0x3bc514,_0x3f03ea){_0x3bc514=_0x3bc514-0xf6;const _0x11334b=a69_0x1133();let _0x4434d7=_0x11334b[_0x3bc514];return _0x4434d7;}(function(_0xd4f1c5,_0x49d418){const _0x542947=a69_0x4434,_0x287296=_0xd4f1c5();while(!![]){try{const _0x2f9d71=-parseInt(_0x542947(0x107))/0x1+parseInt(_0x542947(0x119))/0x2+-parseInt(_0x542947(0x100))/0x3+parseInt(_0x542947(0x112))/0x4+-parseInt(_0x542947(0x163))/0x5+-parseInt(_0x542947(0x12d))/0x6*(-parseInt(_0x542947(0x16e))/0x7)+-parseInt(_0x542947(0x103))/0x8*(-parseInt(_0x542947(0x15f))/0x9);if(_0x2f9d71===_0x49d418)break;else _0x287296['push'](_0x287296['shift']());}catch(_0x7e8ad4){_0x287296['push'](_0x287296['shift']());}}}(a69_0x1133,0x2d8de));Object[a69_0x4eaa43(0x11b)](exports,a69_0x4eaa43(0x166),{'value':!![]}),exports[a69_0x4eaa43(0x173)]=void 0x0;function a69_0x1133(){const _0x34e646=['PENDING','error','last4',',\x20body:\x20','bin_details','Error\x20stack:','now','UNKNOWN','createPaymentLink','ðŸ‡¬ðŸ‡§\x20Country\x20used:\x20','EUR','Invalid\x20response\x20from\x20Rapyd\x20API:\x20missing\x20id\x20or\x20redirect_url','ðŸ‡¬ðŸ‡§\x20Using\x20GB\x20(Britain)\x20as\x20country\x20for\x20Rapyd\x20payment\x20link','data','fixed_side','Failed\x20to\x20create\x20Rapyd\x20payment\x20link:\x20Unknown\x20error','application/json','POST','ðŸ’¥\x20Rapyd\x20failure\x20message:\x20','payment_method_type','ORDER:\x20','\x20(always\x20GB\x20for\x20Rapyd)','390444efaekj','buy','loggerService','146800tIaIvG','message','HTTP\x20Status:','logWhiteDomainError','224159nekRwJ','apiUrl','GET','ERR','address','phone_number','expiration','Rapyd\x20API\x20error\x20(','https://tesoft.uk/gateway/fail.php?id=','ACT','PAYMENT_CANCELED','94708wOLcLl','NEW','none','json','EXP','HTTP\x20','ðŸ’³\x20Adding\x20cardholder\x20name:\x20','561638naDbcn','Error\x20details:','defineProperty','Unknown\x20error','PAYMENT_COMPLETED','\x20\x20\x20expiration:\x20','TESOFT\x20','failureCode','cardBrand','stringify','\x20\x20\x20requested_currency:\x20EUR','Invalid\x20JSON\x20response\x20from\x20Rapyd\x20API:\x20','Error\x20Message:','JSON\x20Parse\x20Error:\x20','gb_mastercard_card','EXPIRED','PAID','FAILED','===\x20RAPYD\x20API\x20BUSINESS\x20ERROR\x20===','CLO','138UlMJyB','amount','https://tesoft.uk/gateway/success.php?id=','paid','Failed\x20to\x20create\x20Rapyd\x20payment\x20link:\x20','headers','===\x20RAPYD\x20API\x20RESPONSE\x20(White\x20Domain)\x20===','ðŸ’³\x20Payment\x20Methods:\x20gb_visa_card,\x20gb_mastercard_card','error_code','entries','floor','Status:','ðŸ’³\x20Card\x20brand\x20from\x20bin_details:\x20','Parsed\x20Result:','CAN','statusText','Error\x20Code:','ðŸŒ\x20Rapyd\x20service\x20initialized\x20with\x20white\x20domain\x20proxy','\x20\x20\x20fixed_side:\x20buy','/v1/hosted/payment_links/','Payment\x20System/1.0','\x20->\x20EUR:','===\x20PARSED\x20RAPYD\x20RESPONSE\x20===','Response\x20Time:','Unknown\x20error\x20from\x20Rapyd\x20API','type','split','text','URL:','gb_visa_card','rapyd','PAYMENT_EXPIRED','failure_message','Incomplete\x20response:\x20missing\x20id\x20or\x20redirect_url','Business\x20Error\x20(','logWhiteDomainResponse','../loggerService','redirect_url','log','SUCCESS','Redirect\x20URL:','):\x20','currency','/v1/hosted/payment_links','status','logWhiteDomainRequest','===\x20RAPYD\x20SERVICE\x20ERROR\x20===','Response\x20Body:','ðŸ’±\x20Adding\x20currency\x20conversion\x20fields\x20for\x20','failure_code','45frApXc','toUpperCase','Raw\x20Response\x20Body:','PAYMENT_FAILED','17000PQPklD','brand','Rapyd\x20API\x20error:\x20','__esModule','fromEntries','Response\x20data:','stack','cardLast4','Error\x20message:','Request\x20Body\x20(Updated\x20Format):','custom_elements','45059dxliWI','errorCode','payment_method_data','Status\x20Text:','ðŸ”„\x20Rapyd\x20webhook\x20processed:\x20status=','RapydService'];a69_0x1133=function(){return _0x34e646;};return a69_0x1133();}const loggerService_1=require(a69_0x4eaa43(0x151));class RapydService{constructor(){const _0x28a8b8=a69_0x4eaa43;this[_0x28a8b8(0x108)]='https://tesoft.uk/gateway/rapyd/',console[_0x28a8b8(0x153)](_0x28a8b8(0x13e));}async[a69_0x4eaa43(0x17c)](_0x23a2d8){const _0x3ce10b=a69_0x4eaa43,{orderId:_0x438e23,orderName:_0x2a2061,amount:_0x64052,currency:_0x44bf42,usage:_0x4742a2,maxPayments:_0x18245d,successUrl:_0x48f1ad,failUrl:_0x37ca74,customerName:_0x410070,customerEmail:_0x9cdddd}=_0x23a2d8,_0x35faf6=_0x44bf42['toUpperCase'](),_0x5a0324='GB';console['log'](_0x3ce10b(0xf6));const _0x4edbe4=_0x3ce10b(0x12f)+_0x438e23,_0x157854=_0x3ce10b(0x10f)+_0x438e23,_0x117efc={'amount':_0x64052,'currency':_0x35faf6,'payment_method_options':{'3d_required':![]},'cancel_checkout_url':_0x157854,'complete_checkout_url':_0x4edbe4,'complete_payment_url':_0x4edbe4,'merchant_reference_id':_0x438e23,'description':_0x3ce10b(0xfe)+_0x438e23,'statement_descriptor':_0x3ce10b(0x11f)+(_0x438e23[_0x3ce10b(0x147)]('-')[0x1]||_0x438e23),'country':'GB','payment_method_types_include':[_0x3ce10b(0x14a),_0x3ce10b(0x127)],'custom_elements':{'display_description':!![],'billing_address_collect':!![],'required_customer_fields':['name','email',_0x3ce10b(0x10c),_0x3ce10b(0x10b)]}};_0x410070&&(_0x117efc[_0x3ce10b(0x16d)]['cardholder_name']=_0x410070,console['log'](_0x3ce10b(0x118)+_0x410070));if(_0x35faf6!==_0x3ce10b(0x17e)){const _0x273a29=Math[_0x3ce10b(0x137)](Date[_0x3ce10b(0x17a)]()/0x3e8)+0x1e*0x3c;_0x117efc[_0x3ce10b(0xf8)]=_0x3ce10b(0x101),_0x117efc['requested_currency']='EUR',_0x117efc[_0x3ce10b(0x10d)]=_0x273a29,console['log'](_0x3ce10b(0x15d)+_0x35faf6+_0x3ce10b(0x142)),console[_0x3ce10b(0x153)](_0x3ce10b(0x13f)),console[_0x3ce10b(0x153)](_0x3ce10b(0x123)),console[_0x3ce10b(0x153)](_0x3ce10b(0x11e)+_0x273a29+'\x20('+new Date(_0x273a29*0x3e8)['toISOString']()+')');}const _0x247cef=Date[_0x3ce10b(0x17a)]();try{console['log']('===\x20RAPYD\x20API\x20REQUEST\x20(White\x20Domain\x20-\x20Updated\x20Format)\x20==='),console[_0x3ce10b(0x153)](_0x3ce10b(0x149),this['apiUrl']),console[_0x3ce10b(0x153)](_0x3ce10b(0x16c),JSON[_0x3ce10b(0x122)](_0x117efc,null,0x2)),console[_0x3ce10b(0x153)]('ðŸ‡¬ðŸ‡§\x20Country:\x20'+_0x5a0324+_0x3ce10b(0xff)),console[_0x3ce10b(0x153)](_0x3ce10b(0x134)),loggerService_1[_0x3ce10b(0x102)]['logWhiteDomainRequest'](_0x3ce10b(0x14b),_0x3ce10b(0x158),_0x3ce10b(0xfb),_0x117efc);const _0x3afd58=await fetch(this[_0x3ce10b(0x108)],{'method':_0x3ce10b(0xfb),'headers':{'Content-Type':_0x3ce10b(0xfa),'User-Agent':_0x3ce10b(0x141)},'body':JSON[_0x3ce10b(0x122)](_0x117efc)}),_0x37b356=Date['now']()-_0x247cef;console[_0x3ce10b(0x153)](_0x3ce10b(0x133)),console[_0x3ce10b(0x153)](_0x3ce10b(0x138),_0x3afd58['status']),console[_0x3ce10b(0x153)](_0x3ce10b(0x171),_0x3afd58[_0x3ce10b(0x13c)]),console[_0x3ce10b(0x153)]('Headers:',Object[_0x3ce10b(0x167)](_0x3afd58[_0x3ce10b(0x132)][_0x3ce10b(0x136)]())),console[_0x3ce10b(0x153)](_0x3ce10b(0x144),_0x37b356+'ms');const _0x335807=await _0x3afd58['text']();console['log'](_0x3ce10b(0x161),_0x335807);if(!_0x3afd58['ok']){console[_0x3ce10b(0x175)]('===\x20RAPYD\x20API\x20ERROR\x20==='),console[_0x3ce10b(0x175)](_0x3ce10b(0x105),_0x3afd58['status']),console['error'](_0x3ce10b(0x15c),_0x335807),loggerService_1[_0x3ce10b(0x102)][_0x3ce10b(0x150)](_0x3ce10b(0x14b),_0x3ce10b(0x158),_0x3afd58[_0x3ce10b(0x159)],_0x335807,_0x37b356),loggerService_1['loggerService'][_0x3ce10b(0x106)](_0x3ce10b(0x14b),_0x3ce10b(0x158),_0x3ce10b(0x117)+_0x3afd58['status']+':\x20'+_0x335807);throw new Error('HTTP\x20error!\x20status:\x20'+_0x3afd58[_0x3ce10b(0x159)]+_0x3ce10b(0x177)+_0x335807);}let _0x2d51e0;try{_0x2d51e0=JSON['parse'](_0x335807);}catch(_0x24dd6e){console['error']('Failed\x20to\x20parse\x20JSON\x20response:',_0x24dd6e),loggerService_1[_0x3ce10b(0x102)][_0x3ce10b(0x106)](_0x3ce10b(0x14b),_0x3ce10b(0x158),_0x3ce10b(0x126)+_0x24dd6e);throw new Error(_0x3ce10b(0x124)+_0x335807);}console['log'](_0x3ce10b(0x143)),console[_0x3ce10b(0x153)](_0x3ce10b(0x13a),JSON[_0x3ce10b(0x122)](_0x2d51e0,null,0x2)),loggerService_1['loggerService'][_0x3ce10b(0x150)](_0x3ce10b(0x14b),_0x3ce10b(0x158),_0x3afd58['status'],_0x2d51e0,_0x37b356);if(_0x2d51e0['status']?.[_0x3ce10b(0x159)]!=='SUCCESS'){const _0x54cd3b=_0x2d51e0['status']?.['message']||_0x3ce10b(0x145),_0x370074=_0x2d51e0[_0x3ce10b(0x159)]?.['error_code']||_0x3ce10b(0x17b);console[_0x3ce10b(0x175)](_0x3ce10b(0x12b)),console[_0x3ce10b(0x175)](_0x3ce10b(0x13d),_0x370074),console[_0x3ce10b(0x175)](_0x3ce10b(0x125),_0x54cd3b),console[_0x3ce10b(0x175)]('Full\x20Error\x20Data:',_0x2d51e0['status']),loggerService_1['loggerService'][_0x3ce10b(0x106)]('rapyd',_0x3ce10b(0x158),_0x3ce10b(0x14f)+_0x370074+'):\x20'+_0x54cd3b);throw new Error(_0x3ce10b(0x10e)+_0x370074+_0x3ce10b(0x156)+_0x54cd3b);}if(!_0x2d51e0[_0x3ce10b(0xf7)]?.['id']||!_0x2d51e0['data']?.[_0x3ce10b(0x152)]){console[_0x3ce10b(0x175)]('===\x20RAPYD\x20API\x20INCOMPLETE\x20RESPONSE\x20==='),console[_0x3ce10b(0x175)]('Missing\x20id\x20or\x20redirect_url\x20in\x20response'),console['error'](_0x3ce10b(0x168),_0x2d51e0['data']),loggerService_1[_0x3ce10b(0x102)][_0x3ce10b(0x106)](_0x3ce10b(0x14b),_0x3ce10b(0x158),_0x3ce10b(0x14e));throw new Error(_0x3ce10b(0x17f));}return console[_0x3ce10b(0x153)]('===\x20RAPYD\x20SUCCESS\x20==='),console[_0x3ce10b(0x153)]('Payment\x20Link\x20ID:',_0x2d51e0['data']['id']),console[_0x3ce10b(0x153)](_0x3ce10b(0x155),_0x2d51e0[_0x3ce10b(0xf7)][_0x3ce10b(0x152)]),console[_0x3ce10b(0x153)](_0x3ce10b(0x17d)+_0x5a0324+'\x20(GB\x20-\x20Britain)'),console['log'](_0x3ce10b(0x134)),{'gateway_payment_id':_0x2d51e0[_0x3ce10b(0xf7)]['id'],'payment_url':_0x2d51e0['data']['redirect_url']};}catch(_0x35f2d3){console[_0x3ce10b(0x175)](_0x3ce10b(0x15b)),console[_0x3ce10b(0x175)](_0x3ce10b(0x11a),_0x35f2d3),loggerService_1[_0x3ce10b(0x102)][_0x3ce10b(0x106)]('rapyd','/v1/hosted/payment_links',_0x35f2d3);if(_0x35f2d3 instanceof Error){console['error'](_0x3ce10b(0x16b),_0x35f2d3[_0x3ce10b(0x104)]),console[_0x3ce10b(0x175)](_0x3ce10b(0x179),_0x35f2d3[_0x3ce10b(0x169)]);throw new Error(_0x3ce10b(0x131)+_0x35f2d3[_0x3ce10b(0x104)]);}throw new Error(_0x3ce10b(0xf9));}}async['verifyPayment'](_0x354606){const _0x33ba47=a69_0x4eaa43,_0x97908b=Date[_0x33ba47(0x17a)]();try{loggerService_1['loggerService'][_0x33ba47(0x15a)](_0x33ba47(0x14b),'/v1/hosted/payment_links/'+_0x354606,_0x33ba47(0x109),{});const _0x20c6bc=await fetch(this[_0x33ba47(0x108)]+'/'+_0x354606,{'method':_0x33ba47(0x109),'headers':{'Content-Type':'application/json','User-Agent':_0x33ba47(0x141)}}),_0x20b7f3=Date[_0x33ba47(0x17a)]()-_0x97908b;if(!_0x20c6bc['ok']){const _0x2ebfd8=await _0x20c6bc[_0x33ba47(0x148)]();loggerService_1[_0x33ba47(0x102)]['logWhiteDomainResponse'](_0x33ba47(0x14b),_0x33ba47(0x140)+_0x354606,_0x20c6bc[_0x33ba47(0x159)],_0x2ebfd8,_0x20b7f3);throw new Error('HTTP\x20error!\x20status:\x20'+_0x20c6bc[_0x33ba47(0x159)]);}const _0x37b065=await _0x20c6bc[_0x33ba47(0x115)]();loggerService_1[_0x33ba47(0x102)][_0x33ba47(0x150)](_0x33ba47(0x14b),_0x33ba47(0x140)+_0x354606,_0x20c6bc[_0x33ba47(0x159)],_0x37b065,_0x20b7f3);if(_0x37b065[_0x33ba47(0x159)]?.[_0x33ba47(0x159)]!==_0x33ba47(0x154)){loggerService_1[_0x33ba47(0x102)][_0x33ba47(0x106)](_0x33ba47(0x14b),'/v1/hosted/payment_links/'+_0x354606,'Rapyd\x20API\x20error:\x20'+(_0x37b065[_0x33ba47(0x159)]?.[_0x33ba47(0x104)]||'Unknown\x20error'));throw new Error(_0x33ba47(0x165)+(_0x37b065[_0x33ba47(0x159)]?.[_0x33ba47(0x104)]||_0x33ba47(0x11c)));}let _0x387c44=_0x33ba47(0x174);if(_0x37b065['data']?.[_0x33ba47(0x159)])switch(_0x37b065[_0x33ba47(0xf7)][_0x33ba47(0x159)]['toUpperCase']()){case _0x33ba47(0x12c):_0x387c44=_0x33ba47(0x129);break;case _0x33ba47(0x13b):_0x387c44=_0x33ba47(0x12a);break;case _0x33ba47(0x116):_0x387c44=_0x33ba47(0x128);break;case _0x33ba47(0x10a):_0x387c44=_0x33ba47(0x12a);break;case _0x33ba47(0x113):case'ACT':default:_0x387c44=_0x33ba47(0x174);break;}return{'status':_0x387c44,'amount':_0x37b065[_0x33ba47(0xf7)]?.[_0x33ba47(0x12e)],'currency':_0x37b065[_0x33ba47(0xf7)]?.[_0x33ba47(0x157)]};}catch(_0x425bbb){console[_0x33ba47(0x175)]('Rapyd\x20payment\x20verification\x20error:',_0x425bbb),loggerService_1[_0x33ba47(0x102)][_0x33ba47(0x106)](_0x33ba47(0x14b),'/v1/hosted/payment_links/'+_0x354606,_0x425bbb);throw new Error('Failed\x20to\x20verify\x20Rapyd\x20payment:\x20'+(_0x425bbb instanceof Error?_0x425bbb[_0x33ba47(0x104)]:_0x33ba47(0x11c)));}}async['processWebhook'](_0x562fe7){const _0x27b437=a69_0x4eaa43;console[_0x27b437(0x153)]('Processing\x20Rapyd\x20webhook:',_0x562fe7);let _0x1ac13e=_0x27b437(0x174),_0x24fd1a;_0x562fe7['data']?.['failure_message']&&(_0x24fd1a=_0x562fe7[_0x27b437(0xf7)][_0x27b437(0x14d)],console['log'](_0x27b437(0xfc)+_0x24fd1a));switch(_0x562fe7[_0x27b437(0x146)]?.[_0x27b437(0x160)]()){case _0x27b437(0x11d):_0x562fe7[_0x27b437(0xf7)]?.[_0x27b437(0x130)]===!![]&&_0x562fe7[_0x27b437(0xf7)]?.['status']===_0x27b437(0x12c)?_0x1ac13e=_0x27b437(0x129):_0x1ac13e=_0x27b437(0x174);break;case _0x27b437(0x111):_0x1ac13e=_0x27b437(0x12a);break;case _0x27b437(0x14c):_0x1ac13e=_0x27b437(0x128);break;case _0x27b437(0x162):_0x1ac13e=_0x27b437(0x12a);!_0x24fd1a&&_0x562fe7['data']?.['failure_message']&&(_0x24fd1a=_0x562fe7[_0x27b437(0xf7)]['failure_message']);break;default:switch(_0x562fe7[_0x27b437(0xf7)]?.['status']?.[_0x27b437(0x160)]()){case _0x27b437(0x12c):_0x562fe7[_0x27b437(0xf7)]?.['paid']===!![]?_0x1ac13e=_0x27b437(0x129):_0x1ac13e=_0x27b437(0x12a);break;case'CAN':_0x1ac13e=_0x27b437(0x12a);break;case _0x27b437(0x116):_0x1ac13e=_0x27b437(0x128);break;case _0x27b437(0x10a):_0x1ac13e='FAILED';!_0x24fd1a&&_0x562fe7[_0x27b437(0xf7)]?.[_0x27b437(0x14d)]&&(_0x24fd1a=_0x562fe7[_0x27b437(0xf7)][_0x27b437(0x14d)]);break;case _0x27b437(0x113):case _0x27b437(0x110):default:_0x1ac13e=_0x27b437(0x174);break;}break;}const _0x1c2044={};return _0x562fe7['data']?.[_0x27b437(0x170)]?.[_0x27b437(0x176)]&&(_0x1c2044[_0x27b437(0x16a)]=_0x562fe7[_0x27b437(0xf7)][_0x27b437(0x170)][_0x27b437(0x176)]),_0x562fe7['data']?.[_0x27b437(0x170)]?.[_0x27b437(0x178)]?.[_0x27b437(0x164)]&&(_0x1c2044[_0x27b437(0x121)]=_0x562fe7[_0x27b437(0xf7)][_0x27b437(0x170)][_0x27b437(0x178)]['brand'],console[_0x27b437(0x153)](_0x27b437(0x139)+_0x1c2044[_0x27b437(0x121)])),_0x562fe7[_0x27b437(0xf7)]?.[_0x27b437(0xfd)]&&(_0x1c2044['paymentMethod']=_0x562fe7[_0x27b437(0xf7)][_0x27b437(0xfd)]),_0x562fe7[_0x27b437(0xf7)]?.['error_code']&&(_0x1c2044[_0x27b437(0x16f)]=_0x562fe7[_0x27b437(0xf7)][_0x27b437(0x135)]),_0x562fe7[_0x27b437(0xf7)]?.[_0x27b437(0x15e)]&&(_0x1c2044[_0x27b437(0x120)]=_0x562fe7['data'][_0x27b437(0x15e)]),console[_0x27b437(0x153)](_0x27b437(0x172)+_0x1ac13e+',\x20failureMessage='+(_0x24fd1a||_0x27b437(0x114))),{'paymentId':_0x562fe7[_0x27b437(0xf7)]?.['merchant_reference_id']||'','status':_0x1ac13e,'amount':_0x562fe7[_0x27b437(0xf7)]?.[_0x27b437(0x12e)],'currency':_0x562fe7[_0x27b437(0xf7)]?.[_0x27b437(0x157)],'failureMessage':_0x24fd1a,'additionalInfo':_0x1c2044};}}exports['RapydService']=RapydService;