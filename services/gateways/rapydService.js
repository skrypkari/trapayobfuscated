'use strict';const a42_0x12e01f=a42_0x30c7;(function(_0x5b8bac,_0x27ede7){const _0x481036=a42_0x30c7,_0x5f578d=_0x5b8bac();while(!![]){try{const _0x765b4e=parseInt(_0x481036(0x16b))/0x1+-parseInt(_0x481036(0x18a))/0x2+parseInt(_0x481036(0x155))/0x3*(parseInt(_0x481036(0x120))/0x4)+parseInt(_0x481036(0x188))/0x5*(parseInt(_0x481036(0x17e))/0x6)+-parseInt(_0x481036(0x18f))/0x7*(-parseInt(_0x481036(0x169))/0x8)+-parseInt(_0x481036(0x187))/0x9*(-parseInt(_0x481036(0x15b))/0xa)+-parseInt(_0x481036(0x13e))/0xb*(parseInt(_0x481036(0x143))/0xc);if(_0x765b4e===_0x27ede7)break;else _0x5f578d['push'](_0x5f578d['shift']());}catch(_0x5b7531){_0x5f578d['push'](_0x5f578d['shift']());}}}(a42_0x492f,0xe9d47));function a42_0x30c7(_0x103f9c,_0x30a45f){const _0x492f73=a42_0x492f();return a42_0x30c7=function(_0x30c719,_0x211b17){_0x30c719=_0x30c719-0x11f;let _0x3d4991=_0x492f73[_0x30c719];return _0x3d4991;},a42_0x30c7(_0x103f9c,_0x30a45f);}Object[a42_0x12e01f(0x12c)](exports,a42_0x12e01f(0x179),{'value':!![]}),exports['RapydService']=void 0x0;const loggerService_1=require(a42_0x12e01f(0x145));function a42_0x492f(){const _0x396f84=['Missing\x20id\x20or\x20redirect_url\x20in\x20response','üåê\x20Rapyd\x20service\x20initialized\x20with\x20white\x20domain\x20proxy','üí≥\x20Payment\x20Methods:\x20gb_visa_card,\x20gb_mastercard_card','===\x20RAPYD\x20SUCCESS\x20===','===\x20RAPYD\x20API\x20BUSINESS\x20ERROR\x20===','Headers:','PAYMENT_COMPLETED','logWhiteDomainError','CLO','JSON\x20Parse\x20Error:\x20','logWhiteDomainResponse','Rapyd\x20API\x20error:\x20','121RcKvwW','POST','===\x20RAPYD\x20API\x20ERROR\x20===','Failed\x20to\x20create\x20Rapyd\x20payment\x20link:\x20Unknown\x20error','Response\x20Time:','2206644UtqRBm','Status:','../loggerService','gb_mastercard_card',',\x20body:\x20','application/json','status','===\x20PARSED\x20RAPYD\x20RESPONSE\x20===','Rapyd\x20API\x20error\x20(','text','HTTP\x20error!\x20status:\x20','paid','now','üá¨üáß\x20Country:\x20','Processing\x20Rapyd\x20webhook:','stringify','SUCCESS','Error\x20Code:','3dilsxi','stack','currency','===\x20RAPYD\x20API\x20REQUEST\x20(White\x20Domain\x20-\x20Updated\x20Format)\x20===','error','Unknown\x20error\x20from\x20Rapyd\x20API','786770lKEclp','Unknown\x20error','headers','json','Status\x20Text:','ACT','message','log','/v1/hosted/payment_links/','Error\x20stack:','\x20(GB\x20-\x20Britain)','HTTP\x20Status:','Parsed\x20Result:','üá¨üáß\x20Using\x20GB\x20(Britain)\x20as\x20country\x20for\x20Rapyd\x20payment\x20link','8QsyPUX','amount','1434947lqZZGI','Error\x20message:','Full\x20Error\x20Data:','Error\x20details:','verifyPayment','merchant_reference_id','===\x20RAPYD\x20API\x20INCOMPLETE\x20RESPONSE\x20===','https://tesoft.uk/gateway/rapyd/','NEW','Request\x20Body\x20(Updated\x20Format):','Payment\x20Link\x20ID:','https://tesoft.uk/gateway/success.php?id=','/v1/hosted/payment_links','ORDER:\x20','__esModule','CAN','rapyd','toUpperCase','Invalid\x20JSON\x20response\x20from\x20Rapyd\x20API:\x20','442794WZTIWD','RapydService','EXPIRED','Response\x20Body:','loggerService','PAYMENT_EXPIRED','entries','Rapyd\x20payment\x20verification\x20error:','TesSoft\x20Payment\x20System/1.0','36gkHJhf','25NZmKfG','===\x20RAPYD\x20SERVICE\x20ERROR\x20===','829128AvQpYs','Business\x20Error\x20(','HTTP\x20','data','Redirect\x20URL:','2079007omKCnv','üá¨üáß\x20Country\x20used:\x20','\x20(always\x20GB\x20for\x20Rapyd)','3917748MMkhIp','URL:','https://tesoft.uk/gateway/fail.php?id=','GET','PENDING','gb_visa_card','statusText','PAID','FAILED','Failed\x20to\x20parse\x20JSON\x20response:','Incomplete\x20response:\x20missing\x20id\x20or\x20redirect_url','fromEntries','defineProperty','processWebhook','EXP','parse','apiUrl','redirect_url'];a42_0x492f=function(){return _0x396f84;};return a42_0x492f();}class RapydService{constructor(){const _0x8d4572=a42_0x12e01f;this['apiUrl']=_0x8d4572(0x172),console['log'](_0x8d4572(0x133));}async['createPaymentLink'](_0x516f3e){const _0x531cc0=a42_0x12e01f,{orderId:_0x134709,orderName:_0x4d0751,amount:_0x1c6827,currency:_0x11be27,usage:_0x316c1e,maxPayments:_0xb537f0,successUrl:_0x237ab5,failUrl:_0x46cadd}=_0x516f3e,_0x187c61=_0x11be27[_0x531cc0(0x17c)](),_0x3e6d4d='GB';console[_0x531cc0(0x162)](_0x531cc0(0x168));const _0x4df64e=_0x531cc0(0x176)+_0x134709,_0xdadda3=_0x531cc0(0x122)+_0x134709,_0x4a8efa={'amount':_0x1c6827,'currency':_0x187c61,'cancel_checkout_url':_0xdadda3,'complete_checkout_url':_0x4df64e,'complete_payment_url':_0x4df64e,'merchant_reference_id':_0x134709,'description':_0x531cc0(0x178)+_0x134709,'country':'GB','payment_method_types_include':[_0x531cc0(0x125),_0x531cc0(0x146)],'custom_elements':{'display_description':!![]}},_0x181029=Date[_0x531cc0(0x14f)]();try{console[_0x531cc0(0x162)](_0x531cc0(0x158)),console[_0x531cc0(0x162)](_0x531cc0(0x121),this[_0x531cc0(0x130)]),console[_0x531cc0(0x162)](_0x531cc0(0x174),JSON[_0x531cc0(0x152)](_0x4a8efa,null,0x2)),console[_0x531cc0(0x162)](_0x531cc0(0x150)+_0x3e6d4d+_0x531cc0(0x11f)),console['log'](_0x531cc0(0x134)),loggerService_1[_0x531cc0(0x182)]['logWhiteDomainRequest'](_0x531cc0(0x17b),_0x531cc0(0x177),'POST',_0x4a8efa);const _0x59b8f0=await fetch(this[_0x531cc0(0x130)],{'method':_0x531cc0(0x13f),'headers':{'Content-Type':_0x531cc0(0x148),'User-Agent':_0x531cc0(0x186)},'body':JSON[_0x531cc0(0x152)](_0x4a8efa)}),_0x886bfa=Date[_0x531cc0(0x14f)]()-_0x181029;console[_0x531cc0(0x162)]('===\x20RAPYD\x20API\x20RESPONSE\x20(White\x20Domain)\x20==='),console[_0x531cc0(0x162)](_0x531cc0(0x144),_0x59b8f0[_0x531cc0(0x149)]),console[_0x531cc0(0x162)](_0x531cc0(0x15f),_0x59b8f0[_0x531cc0(0x126)]),console['log'](_0x531cc0(0x137),Object[_0x531cc0(0x12b)](_0x59b8f0[_0x531cc0(0x15d)][_0x531cc0(0x184)]())),console[_0x531cc0(0x162)](_0x531cc0(0x142),_0x886bfa+'ms');const _0x28a702=await _0x59b8f0[_0x531cc0(0x14c)]();console[_0x531cc0(0x162)]('Raw\x20Response\x20Body:',_0x28a702);if(!_0x59b8f0['ok']){console[_0x531cc0(0x159)](_0x531cc0(0x140)),console[_0x531cc0(0x159)](_0x531cc0(0x166),_0x59b8f0['status']),console['error'](_0x531cc0(0x181),_0x28a702),loggerService_1[_0x531cc0(0x182)][_0x531cc0(0x13c)](_0x531cc0(0x17b),'/v1/hosted/payment_links',_0x59b8f0[_0x531cc0(0x149)],_0x28a702,_0x886bfa),loggerService_1[_0x531cc0(0x182)][_0x531cc0(0x139)](_0x531cc0(0x17b),'/v1/hosted/payment_links',_0x531cc0(0x18c)+_0x59b8f0[_0x531cc0(0x149)]+':\x20'+_0x28a702);throw new Error(_0x531cc0(0x14d)+_0x59b8f0[_0x531cc0(0x149)]+_0x531cc0(0x147)+_0x28a702);}let _0x35a949;try{_0x35a949=JSON[_0x531cc0(0x12f)](_0x28a702);}catch(_0x25f5e4){console[_0x531cc0(0x159)](_0x531cc0(0x129),_0x25f5e4),loggerService_1[_0x531cc0(0x182)][_0x531cc0(0x139)](_0x531cc0(0x17b),_0x531cc0(0x177),_0x531cc0(0x13b)+_0x25f5e4);throw new Error(_0x531cc0(0x17d)+_0x28a702);}console[_0x531cc0(0x162)](_0x531cc0(0x14a)),console[_0x531cc0(0x162)](_0x531cc0(0x167),JSON['stringify'](_0x35a949,null,0x2)),loggerService_1[_0x531cc0(0x182)][_0x531cc0(0x13c)](_0x531cc0(0x17b),_0x531cc0(0x177),_0x59b8f0['status'],_0x35a949,_0x886bfa);if(_0x35a949[_0x531cc0(0x149)]?.['status']!==_0x531cc0(0x153)){const _0x525773=_0x35a949[_0x531cc0(0x149)]?.['message']||_0x531cc0(0x15a),_0x4d2c7f=_0x35a949['status']?.['error_code']||'UNKNOWN';console[_0x531cc0(0x159)](_0x531cc0(0x136)),console[_0x531cc0(0x159)](_0x531cc0(0x154),_0x4d2c7f),console[_0x531cc0(0x159)]('Error\x20Message:',_0x525773),console[_0x531cc0(0x159)](_0x531cc0(0x16d),_0x35a949[_0x531cc0(0x149)]),loggerService_1[_0x531cc0(0x182)]['logWhiteDomainError']('rapyd',_0x531cc0(0x177),_0x531cc0(0x18b)+_0x4d2c7f+'):\x20'+_0x525773);throw new Error(_0x531cc0(0x14b)+_0x4d2c7f+'):\x20'+_0x525773);}if(!_0x35a949['data']?.['id']||!_0x35a949[_0x531cc0(0x18d)]?.[_0x531cc0(0x131)]){console['error'](_0x531cc0(0x171)),console[_0x531cc0(0x159)](_0x531cc0(0x132)),console[_0x531cc0(0x159)]('Response\x20data:',_0x35a949[_0x531cc0(0x18d)]),loggerService_1[_0x531cc0(0x182)][_0x531cc0(0x139)](_0x531cc0(0x17b),_0x531cc0(0x177),_0x531cc0(0x12a));throw new Error('Invalid\x20response\x20from\x20Rapyd\x20API:\x20missing\x20id\x20or\x20redirect_url');}return console[_0x531cc0(0x162)](_0x531cc0(0x135)),console['log'](_0x531cc0(0x175),_0x35a949['data']['id']),console[_0x531cc0(0x162)](_0x531cc0(0x18e),_0x35a949[_0x531cc0(0x18d)]['redirect_url']),console[_0x531cc0(0x162)](_0x531cc0(0x190)+_0x3e6d4d+_0x531cc0(0x165)),console[_0x531cc0(0x162)](_0x531cc0(0x134)),{'gateway_payment_id':_0x35a949[_0x531cc0(0x18d)]['id'],'payment_url':_0x35a949['data']['redirect_url']};}catch(_0x54bf1a){console[_0x531cc0(0x159)](_0x531cc0(0x189)),console[_0x531cc0(0x159)](_0x531cc0(0x16e),_0x54bf1a),loggerService_1['loggerService'][_0x531cc0(0x139)]('rapyd',_0x531cc0(0x177),_0x54bf1a);if(_0x54bf1a instanceof Error){console[_0x531cc0(0x159)](_0x531cc0(0x16c),_0x54bf1a['message']),console['error'](_0x531cc0(0x164),_0x54bf1a[_0x531cc0(0x156)]);throw new Error('Failed\x20to\x20create\x20Rapyd\x20payment\x20link:\x20'+_0x54bf1a[_0x531cc0(0x161)]);}throw new Error(_0x531cc0(0x141));}}async[a42_0x12e01f(0x16f)](_0x9fd35f){const _0x6a32bf=a42_0x12e01f,_0x2fd442=Date[_0x6a32bf(0x14f)]();try{loggerService_1[_0x6a32bf(0x182)]['logWhiteDomainRequest'](_0x6a32bf(0x17b),_0x6a32bf(0x163)+_0x9fd35f,_0x6a32bf(0x123),{});const _0x3f5961=await fetch(this[_0x6a32bf(0x130)]+'/'+_0x9fd35f,{'method':_0x6a32bf(0x123),'headers':{'Content-Type':_0x6a32bf(0x148),'User-Agent':'TesSoft\x20Payment\x20System/1.0'}}),_0x4744f1=Date[_0x6a32bf(0x14f)]()-_0x2fd442;if(!_0x3f5961['ok']){const _0x4c4e3c=await _0x3f5961[_0x6a32bf(0x14c)]();loggerService_1[_0x6a32bf(0x182)][_0x6a32bf(0x13c)](_0x6a32bf(0x17b),_0x6a32bf(0x163)+_0x9fd35f,_0x3f5961[_0x6a32bf(0x149)],_0x4c4e3c,_0x4744f1);throw new Error(_0x6a32bf(0x14d)+_0x3f5961[_0x6a32bf(0x149)]);}const _0x291e51=await _0x3f5961[_0x6a32bf(0x15e)]();loggerService_1[_0x6a32bf(0x182)]['logWhiteDomainResponse']('rapyd',_0x6a32bf(0x163)+_0x9fd35f,_0x3f5961[_0x6a32bf(0x149)],_0x291e51,_0x4744f1);if(_0x291e51['status']?.[_0x6a32bf(0x149)]!==_0x6a32bf(0x153)){loggerService_1[_0x6a32bf(0x182)]['logWhiteDomainError']('rapyd',_0x6a32bf(0x163)+_0x9fd35f,_0x6a32bf(0x13d)+(_0x291e51[_0x6a32bf(0x149)]?.['message']||'Unknown\x20error'));throw new Error('Rapyd\x20API\x20error:\x20'+(_0x291e51['status']?.[_0x6a32bf(0x161)]||_0x6a32bf(0x15c)));}let _0xb89681='PENDING';if(_0x291e51['data']?.[_0x6a32bf(0x149)])switch(_0x291e51[_0x6a32bf(0x18d)][_0x6a32bf(0x149)][_0x6a32bf(0x17c)]()){case'CLO':_0xb89681=_0x6a32bf(0x127);break;case _0x6a32bf(0x17a):_0xb89681=_0x6a32bf(0x128);break;case _0x6a32bf(0x12e):_0xb89681=_0x6a32bf(0x180);break;case'ERR':_0xb89681=_0x6a32bf(0x128);break;case _0x6a32bf(0x173):case _0x6a32bf(0x160):default:_0xb89681=_0x6a32bf(0x124);break;}return{'status':_0xb89681,'amount':_0x291e51['data']?.[_0x6a32bf(0x16a)],'currency':_0x291e51[_0x6a32bf(0x18d)]?.[_0x6a32bf(0x157)]};}catch(_0x298ebc){console[_0x6a32bf(0x159)](_0x6a32bf(0x185),_0x298ebc),loggerService_1[_0x6a32bf(0x182)][_0x6a32bf(0x139)](_0x6a32bf(0x17b),_0x6a32bf(0x163)+_0x9fd35f,_0x298ebc);throw new Error('Failed\x20to\x20verify\x20Rapyd\x20payment:\x20'+(_0x298ebc instanceof Error?_0x298ebc[_0x6a32bf(0x161)]:_0x6a32bf(0x15c)));}}async[a42_0x12e01f(0x12d)](_0x189ed9){const _0x4855ca=a42_0x12e01f;console['log'](_0x4855ca(0x151),_0x189ed9);let _0x94137e=_0x4855ca(0x124);switch(_0x189ed9['type']?.[_0x4855ca(0x17c)]()){case _0x4855ca(0x138):_0x189ed9[_0x4855ca(0x18d)]?.[_0x4855ca(0x14e)]===!![]&&_0x189ed9[_0x4855ca(0x18d)]?.[_0x4855ca(0x149)]===_0x4855ca(0x13a)?_0x94137e=_0x4855ca(0x127):_0x94137e=_0x4855ca(0x124);break;case'PAYMENT_CANCELED':_0x94137e='FAILED';break;case _0x4855ca(0x183):_0x94137e=_0x4855ca(0x180);break;case'PAYMENT_FAILED':_0x94137e='FAILED';break;default:switch(_0x189ed9[_0x4855ca(0x18d)]?.[_0x4855ca(0x149)]?.[_0x4855ca(0x17c)]()){case _0x4855ca(0x13a):_0x189ed9['data']?.[_0x4855ca(0x14e)]===!![]?_0x94137e='PAID':_0x94137e=_0x4855ca(0x128);break;case _0x4855ca(0x17a):_0x94137e=_0x4855ca(0x128);break;case _0x4855ca(0x12e):_0x94137e=_0x4855ca(0x180);break;case'ERR':_0x94137e=_0x4855ca(0x128);break;case'NEW':case _0x4855ca(0x160):default:_0x94137e=_0x4855ca(0x124);break;}break;}return{'paymentId':_0x189ed9[_0x4855ca(0x18d)]?.[_0x4855ca(0x170)]||'','status':_0x94137e,'amount':_0x189ed9[_0x4855ca(0x18d)]?.[_0x4855ca(0x16a)],'currency':_0x189ed9[_0x4855ca(0x18d)]?.[_0x4855ca(0x157)]};}}exports[a42_0x12e01f(0x17f)]=RapydService;