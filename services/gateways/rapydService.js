'use strict';const a46_0xcf9ec2=a46_0x4ff0;(function(_0x150b07,_0x3d5595){const _0x3f5227=a46_0x4ff0,_0x1ffd53=_0x150b07();while(!![]){try{const _0x8cb507=parseInt(_0x3f5227(0xf7))/0x1*(parseInt(_0x3f5227(0x12d))/0x2)+parseInt(_0x3f5227(0xf2))/0x3+-parseInt(_0x3f5227(0x152))/0x4+-parseInt(_0x3f5227(0x139))/0x5+parseInt(_0x3f5227(0x163))/0x6*(-parseInt(_0x3f5227(0x12a))/0x7)+parseInt(_0x3f5227(0x13b))/0x8*(-parseInt(_0x3f5227(0x121))/0x9)+parseInt(_0x3f5227(0x13a))/0xa*(parseInt(_0x3f5227(0x111))/0xb);if(_0x8cb507===_0x3d5595)break;else _0x1ffd53['push'](_0x1ffd53['shift']());}catch(_0x2e62f9){_0x1ffd53['push'](_0x1ffd53['shift']());}}}(a46_0x5353,0xf324f));Object['defineProperty'](exports,a46_0xcf9ec2(0x100),{'value':!![]}),exports[a46_0xcf9ec2(0x10b)]=void 0x0;function a46_0x5353(){const _0x5500f6=['PAYMENT_CANCELED','Status:','failureCode','Error\x20message:','Invalid\x20JSON\x20response\x20from\x20Rapyd\x20API:\x20','gb_mastercard_card','createPaymentLink','1248926oGqlWS','apiUrl','verifyPayment','1402txbvgc','Request\x20Body\x20(Updated\x20Format):','SUCCESS','Response\x20Time:','../loggerService','/v1/hosted/payment_links/','\x20(always\x20GB\x20for\x20Rapyd)','Response\x20Body:','POST','Unknown\x20error','EXP','Processing\x20Rapyd\x20webhook:','2368330PktOSN','216710vMdqPa','1080vOYTCd','ORDER:\x20','parse','üí≥\x20Payment\x20Methods:\x20gb_visa_card,\x20gb_mastercard_card','https://tesoft.uk/gateway/success.php?id=','Error\x20stack:','Error\x20Message:','ACT','Payment\x20Link\x20ID:','PAID','payment_method_type','stringify','PENDING','cardLast4','currency','===\x20RAPYD\x20API\x20REQUEST\x20(White\x20Domain\x20-\x20Updated\x20Format)\x20===','logWhiteDomainRequest','paid','entries','Error\x20details:','log','merchant_reference_id','PAYMENT_COMPLETED','6956220shXTdi','üá¨üáß\x20Country\x20used:\x20','toUpperCase','\x20(GB\x20-\x20Britain)','https://tesoft.uk/gateway/rapyd/','failure_message','logWhiteDomainError','HTTP\x20','errorCode','processWebhook','fromEntries','Raw\x20Response\x20Body:','data','Failed\x20to\x20parse\x20JSON\x20response:','üåê\x20Rapyd\x20service\x20initialized\x20with\x20white\x20domain\x20proxy','Failed\x20to\x20create\x20Rapyd\x20payment\x20link:\x20Unknown\x20error','GET','24yBTZnf','Rapyd\x20API\x20error:\x20','CLO','Headers:','URL:','text','PAYMENT_FAILED','Status\x20Text:','amount','HTTP\x20error!\x20status:\x20','2403951EcoTCe','now','===\x20RAPYD\x20SERVICE\x20ERROR\x20===','error','rapyd','557FGbNey','ERR','type','===\x20RAPYD\x20API\x20RESPONSE\x20(White\x20Domain)\x20===','/v1/hosted/payment_links','json','last4','Rapyd\x20payment\x20verification\x20error:','üîÑ\x20Rapyd\x20webhook\x20processed:\x20status=','__esModule','CAN','loggerService','paymentMethod','UNKNOWN','payment_method_data','üá¨üáß\x20Country:\x20','error_code','Rapyd\x20API\x20error\x20(','===\x20PARSED\x20RAPYD\x20RESPONSE\x20===','TesSoft\x20Payment\x20System/1.0','RapydService','Error\x20Code:','message',',\x20body:\x20','application/json','redirect_url','1573KZoIUl','Failed\x20to\x20verify\x20Rapyd\x20payment:\x20','stack','failure_code','EXPIRED','headers','none','logWhiteDomainResponse','JSON\x20Parse\x20Error:\x20','statusText','status','üí•\x20Rapyd\x20failure\x20message:\x20','Invalid\x20response\x20from\x20Rapyd\x20API:\x20missing\x20id\x20or\x20redirect_url',',\x20failureMessage=','FAILED','üá¨üáß\x20Using\x20GB\x20(Britain)\x20as\x20country\x20for\x20Rapyd\x20payment\x20link','24561JaBODb','Redirect\x20URL:'];a46_0x5353=function(){return _0x5500f6;};return a46_0x5353();}function a46_0x4ff0(_0x30eb1d,_0x1f3b29){const _0x5353c7=a46_0x5353();return a46_0x4ff0=function(_0x4ff02f,_0x39786f){_0x4ff02f=_0x4ff02f-0xeb;let _0x10d3dd=_0x5353c7[_0x4ff02f];return _0x10d3dd;},a46_0x4ff0(_0x30eb1d,_0x1f3b29);}const loggerService_1=require(a46_0xcf9ec2(0x131));class RapydService{constructor(){const _0x37bad8=a46_0xcf9ec2;this[_0x37bad8(0x12b)]=_0x37bad8(0x156),console['log'](_0x37bad8(0x160));}async[a46_0xcf9ec2(0x129)](_0x14c100){const _0x13026e=a46_0xcf9ec2,{orderId:_0x1efdc5,orderName:_0x1178b7,amount:_0x5e7d23,currency:_0x31d7a9,usage:_0x5f29cd,maxPayments:_0x11b271,successUrl:_0x4d85e9,failUrl:_0x15d7f}=_0x14c100,_0x168d18=_0x31d7a9[_0x13026e(0x154)](),_0x3cb01d='GB';console[_0x13026e(0x14f)](_0x13026e(0x120));const _0x5601ee=_0x13026e(0x13f)+_0x1efdc5,_0x34991f='https://tesoft.uk/gateway/fail.php?id='+_0x1efdc5,_0x46fb39={'amount':_0x5e7d23,'currency':_0x168d18,'cancel_checkout_url':_0x34991f,'complete_checkout_url':_0x5601ee,'complete_payment_url':_0x5601ee,'merchant_reference_id':_0x1efdc5,'description':_0x13026e(0x13c)+_0x1efdc5,'country':'GB','payment_method_types_include':['gb_visa_card',_0x13026e(0x128)],'custom_elements':{'display_description':!![]}},_0x56cf30=Date[_0x13026e(0xf3)]();try{console[_0x13026e(0x14f)](_0x13026e(0x14a)),console['log'](_0x13026e(0xec),this['apiUrl']),console[_0x13026e(0x14f)](_0x13026e(0x12e),JSON[_0x13026e(0x146)](_0x46fb39,null,0x2)),console[_0x13026e(0x14f)](_0x13026e(0x106)+_0x3cb01d+_0x13026e(0x133)),console['log'](_0x13026e(0x13e)),loggerService_1['loggerService'][_0x13026e(0x14b)](_0x13026e(0xf6),_0x13026e(0xfb),'POST',_0x46fb39);const _0x2a2712=await fetch(this[_0x13026e(0x12b)],{'method':_0x13026e(0x135),'headers':{'Content-Type':_0x13026e(0x10f),'User-Agent':_0x13026e(0x10a)},'body':JSON[_0x13026e(0x146)](_0x46fb39)}),_0x378f8d=Date['now']()-_0x56cf30;console['log'](_0x13026e(0xfa)),console[_0x13026e(0x14f)](_0x13026e(0x124),_0x2a2712[_0x13026e(0x11b)]),console[_0x13026e(0x14f)](_0x13026e(0xef),_0x2a2712[_0x13026e(0x11a)]),console[_0x13026e(0x14f)](_0x13026e(0xeb),Object[_0x13026e(0x15c)](_0x2a2712[_0x13026e(0x116)][_0x13026e(0x14d)]())),console[_0x13026e(0x14f)](_0x13026e(0x130),_0x378f8d+'ms');const _0x22f12f=await _0x2a2712[_0x13026e(0xed)]();console[_0x13026e(0x14f)](_0x13026e(0x15d),_0x22f12f);if(!_0x2a2712['ok']){console['error']('===\x20RAPYD\x20API\x20ERROR\x20==='),console[_0x13026e(0xf5)]('HTTP\x20Status:',_0x2a2712[_0x13026e(0x11b)]),console[_0x13026e(0xf5)](_0x13026e(0x134),_0x22f12f),loggerService_1[_0x13026e(0x102)]['logWhiteDomainResponse']('rapyd',_0x13026e(0xfb),_0x2a2712['status'],_0x22f12f,_0x378f8d),loggerService_1['loggerService'][_0x13026e(0x158)](_0x13026e(0xf6),_0x13026e(0xfb),_0x13026e(0x159)+_0x2a2712['status']+':\x20'+_0x22f12f);throw new Error(_0x13026e(0xf1)+_0x2a2712['status']+_0x13026e(0x10e)+_0x22f12f);}let _0x45b882;try{_0x45b882=JSON[_0x13026e(0x13d)](_0x22f12f);}catch(_0x393262){console['error'](_0x13026e(0x15f),_0x393262),loggerService_1[_0x13026e(0x102)][_0x13026e(0x158)](_0x13026e(0xf6),'/v1/hosted/payment_links',_0x13026e(0x119)+_0x393262);throw new Error(_0x13026e(0x127)+_0x22f12f);}console[_0x13026e(0x14f)](_0x13026e(0x109)),console[_0x13026e(0x14f)]('Parsed\x20Result:',JSON[_0x13026e(0x146)](_0x45b882,null,0x2)),loggerService_1[_0x13026e(0x102)][_0x13026e(0x118)]('rapyd',_0x13026e(0xfb),_0x2a2712[_0x13026e(0x11b)],_0x45b882,_0x378f8d);if(_0x45b882[_0x13026e(0x11b)]?.[_0x13026e(0x11b)]!==_0x13026e(0x12f)){const _0x553357=_0x45b882[_0x13026e(0x11b)]?.['message']||'Unknown\x20error\x20from\x20Rapyd\x20API',_0x4464cb=_0x45b882[_0x13026e(0x11b)]?.[_0x13026e(0x107)]||_0x13026e(0x104);console['error']('===\x20RAPYD\x20API\x20BUSINESS\x20ERROR\x20==='),console[_0x13026e(0xf5)](_0x13026e(0x10c),_0x4464cb),console['error'](_0x13026e(0x141),_0x553357),console[_0x13026e(0xf5)]('Full\x20Error\x20Data:',_0x45b882[_0x13026e(0x11b)]),loggerService_1[_0x13026e(0x102)][_0x13026e(0x158)]('rapyd','/v1/hosted/payment_links','Business\x20Error\x20('+_0x4464cb+'):\x20'+_0x553357);throw new Error(_0x13026e(0x108)+_0x4464cb+'):\x20'+_0x553357);}if(!_0x45b882['data']?.['id']||!_0x45b882[_0x13026e(0x15e)]?.[_0x13026e(0x110)]){console[_0x13026e(0xf5)]('===\x20RAPYD\x20API\x20INCOMPLETE\x20RESPONSE\x20==='),console[_0x13026e(0xf5)]('Missing\x20id\x20or\x20redirect_url\x20in\x20response'),console['error']('Response\x20data:',_0x45b882[_0x13026e(0x15e)]),loggerService_1[_0x13026e(0x102)]['logWhiteDomainError']('rapyd',_0x13026e(0xfb),'Incomplete\x20response:\x20missing\x20id\x20or\x20redirect_url');throw new Error(_0x13026e(0x11d));}return console[_0x13026e(0x14f)]('===\x20RAPYD\x20SUCCESS\x20==='),console['log'](_0x13026e(0x143),_0x45b882['data']['id']),console[_0x13026e(0x14f)](_0x13026e(0x122),_0x45b882[_0x13026e(0x15e)][_0x13026e(0x110)]),console[_0x13026e(0x14f)](_0x13026e(0x153)+_0x3cb01d+_0x13026e(0x155)),console['log'](_0x13026e(0x13e)),{'gateway_payment_id':_0x45b882['data']['id'],'payment_url':_0x45b882[_0x13026e(0x15e)][_0x13026e(0x110)]};}catch(_0x30c235){console[_0x13026e(0xf5)](_0x13026e(0xf4)),console[_0x13026e(0xf5)](_0x13026e(0x14e),_0x30c235),loggerService_1[_0x13026e(0x102)][_0x13026e(0x158)](_0x13026e(0xf6),'/v1/hosted/payment_links',_0x30c235);if(_0x30c235 instanceof Error){console[_0x13026e(0xf5)](_0x13026e(0x126),_0x30c235['message']),console[_0x13026e(0xf5)](_0x13026e(0x140),_0x30c235[_0x13026e(0x113)]);throw new Error('Failed\x20to\x20create\x20Rapyd\x20payment\x20link:\x20'+_0x30c235[_0x13026e(0x10d)]);}throw new Error(_0x13026e(0x161));}}async[a46_0xcf9ec2(0x12c)](_0x518047){const _0x3f07f9=a46_0xcf9ec2,_0x32f2a9=Date[_0x3f07f9(0xf3)]();try{loggerService_1[_0x3f07f9(0x102)][_0x3f07f9(0x14b)]('rapyd',_0x3f07f9(0x132)+_0x518047,'GET',{});const _0x5b79c0=await fetch(this[_0x3f07f9(0x12b)]+'/'+_0x518047,{'method':_0x3f07f9(0x162),'headers':{'Content-Type':_0x3f07f9(0x10f),'User-Agent':_0x3f07f9(0x10a)}}),_0x20c370=Date[_0x3f07f9(0xf3)]()-_0x32f2a9;if(!_0x5b79c0['ok']){const _0x5913d1=await _0x5b79c0[_0x3f07f9(0xed)]();loggerService_1['loggerService'][_0x3f07f9(0x118)](_0x3f07f9(0xf6),'/v1/hosted/payment_links/'+_0x518047,_0x5b79c0[_0x3f07f9(0x11b)],_0x5913d1,_0x20c370);throw new Error(_0x3f07f9(0xf1)+_0x5b79c0[_0x3f07f9(0x11b)]);}const _0x292270=await _0x5b79c0[_0x3f07f9(0xfc)]();loggerService_1['loggerService']['logWhiteDomainResponse'](_0x3f07f9(0xf6),_0x3f07f9(0x132)+_0x518047,_0x5b79c0[_0x3f07f9(0x11b)],_0x292270,_0x20c370);if(_0x292270[_0x3f07f9(0x11b)]?.[_0x3f07f9(0x11b)]!=='SUCCESS'){loggerService_1['loggerService'][_0x3f07f9(0x158)](_0x3f07f9(0xf6),'/v1/hosted/payment_links/'+_0x518047,'Rapyd\x20API\x20error:\x20'+(_0x292270['status']?.['message']||_0x3f07f9(0x136)));throw new Error(_0x3f07f9(0x164)+(_0x292270[_0x3f07f9(0x11b)]?.[_0x3f07f9(0x10d)]||_0x3f07f9(0x136)));}let _0x4dcf5f=_0x3f07f9(0x147);if(_0x292270[_0x3f07f9(0x15e)]?.['status'])switch(_0x292270['data'][_0x3f07f9(0x11b)][_0x3f07f9(0x154)]()){case _0x3f07f9(0x165):_0x4dcf5f=_0x3f07f9(0x144);break;case _0x3f07f9(0x101):_0x4dcf5f=_0x3f07f9(0x11f);break;case _0x3f07f9(0x137):_0x4dcf5f='EXPIRED';break;case'ERR':_0x4dcf5f=_0x3f07f9(0x11f);break;case'NEW':case'ACT':default:_0x4dcf5f=_0x3f07f9(0x147);break;}return{'status':_0x4dcf5f,'amount':_0x292270['data']?.['amount'],'currency':_0x292270['data']?.[_0x3f07f9(0x149)]};}catch(_0x169171){console[_0x3f07f9(0xf5)](_0x3f07f9(0xfe),_0x169171),loggerService_1[_0x3f07f9(0x102)]['logWhiteDomainError'](_0x3f07f9(0xf6),_0x3f07f9(0x132)+_0x518047,_0x169171);throw new Error(_0x3f07f9(0x112)+(_0x169171 instanceof Error?_0x169171[_0x3f07f9(0x10d)]:'Unknown\x20error'));}}async[a46_0xcf9ec2(0x15b)](_0x170177){const _0x5dbcbb=a46_0xcf9ec2;console['log'](_0x5dbcbb(0x138),_0x170177);let _0x27a6c9=_0x5dbcbb(0x147),_0x24ccd5;_0x170177[_0x5dbcbb(0x15e)]?.[_0x5dbcbb(0x157)]&&(_0x24ccd5=_0x170177[_0x5dbcbb(0x15e)][_0x5dbcbb(0x157)],console[_0x5dbcbb(0x14f)](_0x5dbcbb(0x11c)+_0x24ccd5));switch(_0x170177[_0x5dbcbb(0xf9)]?.['toUpperCase']()){case _0x5dbcbb(0x151):_0x170177[_0x5dbcbb(0x15e)]?.['paid']===!![]&&_0x170177['data']?.['status']===_0x5dbcbb(0x165)?_0x27a6c9=_0x5dbcbb(0x144):_0x27a6c9=_0x5dbcbb(0x147);break;case _0x5dbcbb(0x123):_0x27a6c9=_0x5dbcbb(0x11f);break;case'PAYMENT_EXPIRED':_0x27a6c9=_0x5dbcbb(0x115);break;case _0x5dbcbb(0xee):_0x27a6c9=_0x5dbcbb(0x11f);!_0x24ccd5&&_0x170177[_0x5dbcbb(0x15e)]?.['failure_message']&&(_0x24ccd5=_0x170177[_0x5dbcbb(0x15e)][_0x5dbcbb(0x157)]);break;default:switch(_0x170177[_0x5dbcbb(0x15e)]?.[_0x5dbcbb(0x11b)]?.[_0x5dbcbb(0x154)]()){case'CLO':_0x170177[_0x5dbcbb(0x15e)]?.[_0x5dbcbb(0x14c)]===!![]?_0x27a6c9=_0x5dbcbb(0x144):_0x27a6c9=_0x5dbcbb(0x11f);break;case _0x5dbcbb(0x101):_0x27a6c9='FAILED';break;case'EXP':_0x27a6c9='EXPIRED';break;case _0x5dbcbb(0xf8):_0x27a6c9=_0x5dbcbb(0x11f);!_0x24ccd5&&_0x170177[_0x5dbcbb(0x15e)]?.[_0x5dbcbb(0x157)]&&(_0x24ccd5=_0x170177[_0x5dbcbb(0x15e)][_0x5dbcbb(0x157)]);break;case'NEW':case _0x5dbcbb(0x142):default:_0x27a6c9='PENDING';break;}break;}const _0x54a6d4={};return _0x170177[_0x5dbcbb(0x15e)]?.['payment_method_data']?.['last4']&&(_0x54a6d4[_0x5dbcbb(0x148)]=_0x170177[_0x5dbcbb(0x15e)][_0x5dbcbb(0x105)][_0x5dbcbb(0xfd)]),_0x170177[_0x5dbcbb(0x15e)]?.['payment_method_type']&&(_0x54a6d4[_0x5dbcbb(0x103)]=_0x170177[_0x5dbcbb(0x15e)][_0x5dbcbb(0x145)]),_0x170177[_0x5dbcbb(0x15e)]?.[_0x5dbcbb(0x107)]&&(_0x54a6d4[_0x5dbcbb(0x15a)]=_0x170177[_0x5dbcbb(0x15e)][_0x5dbcbb(0x107)]),_0x170177[_0x5dbcbb(0x15e)]?.['failure_code']&&(_0x54a6d4[_0x5dbcbb(0x125)]=_0x170177[_0x5dbcbb(0x15e)][_0x5dbcbb(0x114)]),console[_0x5dbcbb(0x14f)](_0x5dbcbb(0xff)+_0x27a6c9+_0x5dbcbb(0x11e)+(_0x24ccd5||_0x5dbcbb(0x117))),{'paymentId':_0x170177[_0x5dbcbb(0x15e)]?.[_0x5dbcbb(0x150)]||'','status':_0x27a6c9,'amount':_0x170177[_0x5dbcbb(0x15e)]?.[_0x5dbcbb(0xf0)],'currency':_0x170177[_0x5dbcbb(0x15e)]?.[_0x5dbcbb(0x149)],'failureMessage':_0x24ccd5,'additionalInfo':_0x54a6d4};}}exports[a46_0xcf9ec2(0x10b)]=RapydService;