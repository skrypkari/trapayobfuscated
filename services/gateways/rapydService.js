'use strict';const a67_0x128a58=a67_0x1243;(function(_0x2df1c0,_0x306102){const _0x4f186b=a67_0x1243,_0x2fdef1=_0x2df1c0();while(!![]){try{const _0x5b75eb=-parseInt(_0x4f186b(0x1d9))/0x1*(parseInt(_0x4f186b(0x1ec))/0x2)+-parseInt(_0x4f186b(0x1ed))/0x3+-parseInt(_0x4f186b(0x225))/0x4*(parseInt(_0x4f186b(0x1ee))/0x5)+-parseInt(_0x4f186b(0x202))/0x6*(parseInt(_0x4f186b(0x23c))/0x7)+-parseInt(_0x4f186b(0x1d4))/0x8*(parseInt(_0x4f186b(0x1fb))/0x9)+-parseInt(_0x4f186b(0x1cb))/0xa+parseInt(_0x4f186b(0x22c))/0xb*(parseInt(_0x4f186b(0x1ff))/0xc);if(_0x5b75eb===_0x306102)break;else _0x2fdef1['push'](_0x2fdef1['shift']());}catch(_0x25bcdb){_0x2fdef1['push'](_0x2fdef1['shift']());}}}(a67_0x30df,0xe37b3));Object['defineProperty'](exports,a67_0x128a58(0x21a),{'value':!![]}),exports['RapydService']=void 0x0;const loggerService_1=require(a67_0x128a58(0x207));function a67_0x1243(_0x2ee06b,_0x1590d0){_0x2ee06b=_0x2ee06b-0x1c9;const _0x30df26=a67_0x30df();let _0x12432=_0x30df26[_0x2ee06b];return _0x12432;}function a67_0x30df(){const _0x544ac9=['entries','buy','Headers:','address','https://tesoft.uk/gateway/success.php?id=','413wqjVvY','PAID','/v1/hosted/payment_links/','Failed\x20to\x20parse\x20JSON\x20response:','ðŸ’³\x20Adding\x20cardholder\x20name:\x20','apiUrl','failure_code','PAYMENT_CANCELED','PAYMENT_EXPIRED','loggerService','===\x20RAPYD\x20API\x20ERROR\x20===','status','PENDING','gb_visa_card','POST',',\x20failureMessage=','last4','):\x20','CLO','HTTP\x20error!\x20status:\x20','Full\x20Error\x20Data:','Response\x20Time:','rapyd','payment_method_data','\x20(always\x20GB\x20for\x20Rapyd)','ERR','name','HTTP\x20Status:','PAYMENT_FAILED','failureCode','6273240bYQpwA','ðŸ’³\x20Payment\x20Methods:\x20gb_visa_card,\x20gb_mastercard_card','createPaymentLink','json','Unknown\x20error','EUR','===\x20RAPYD\x20API\x20REQUEST\x20(White\x20Domain\x20-\x20Updated\x20Format)\x20===','redirect_url','===\x20RAPYD\x20SERVICE\x20ERROR\x20===','3344iampWz','failure_message','UNKNOWN','CAN','Error\x20stack:','240980wfMZcU','GET','fixed_side','Raw\x20Response\x20Body:','Status:','paymentMethod','stringify','none','headers','error_code','NEW','https://tesoft.uk/gateway/rapyd/','paid','application/json','Missing\x20id\x20or\x20redirect_url\x20in\x20response','Error\x20Message:','cardBrand','ðŸ‡¬ðŸ‡§\x20Using\x20GB\x20(Britain)\x20as\x20country\x20for\x20Rapyd\x20payment\x20link','EXPIRED','2oAyenD','4818633pRvobH','215voapsm','===\x20PARSED\x20RAPYD\x20RESPONSE\x20===','ðŸ’¥\x20Rapyd\x20failure\x20message:\x20','split','payment_method_type','Rapyd\x20API\x20error:\x20','logWhiteDomainResponse','requested_currency','Invalid\x20response\x20from\x20Rapyd\x20API:\x20missing\x20id\x20or\x20redirect_url','now','ðŸ’³\x20Card\x20brand\x20from\x20bin_details:\x20','type','Rapyd\x20payment\x20verification\x20error:','11079vTKTli','Failed\x20to\x20create\x20Rapyd\x20payment\x20link:\x20','Error\x20Code:','ORDER:\x20','12SNmOLk','bin_details','\x20\x20\x20expiration:\x20','96816yOlrUg','SUCCESS','logWhiteDomainRequest','verifyPayment',',\x20body:\x20','../loggerService','ACT','log','data','merchant_reference_id','Error\x20details:','floor','EXP','Incomplete\x20response:\x20missing\x20id\x20or\x20redirect_url','===\x20RAPYD\x20API\x20RESPONSE\x20(White\x20Domain)\x20===','logWhiteDomainError','\x20\x20\x20fixed_side:\x20buy','gb_mastercard_card','cardholder_name','TESOFT\x20','URL:','text','\x20(GB\x20-\x20Britain)','custom_elements','__esModule','Error\x20message:','toISOString','Redirect\x20URL:','https://tesoft.uk/gateway/fail.php?id=','FAILED','ðŸ’±\x20Adding\x20currency\x20conversion\x20fields\x20for\x20','===\x20RAPYD\x20SUCCESS\x20===','brand','amount','statusText','57896aNCOPk','cardLast4','email','error','Failed\x20to\x20create\x20Rapyd\x20payment\x20link:\x20Unknown\x20error','Payment\x20System/1.0','Response\x20data:','60447662CCbMOQ','expiration','ðŸ”„\x20Rapyd\x20webhook\x20processed:\x20status=','/v1/hosted/payment_links','toUpperCase','currency','Status\x20Text:','Failed\x20to\x20verify\x20Rapyd\x20payment:\x20','ðŸŒ\x20Rapyd\x20service\x20initialized\x20with\x20white\x20domain\x20proxy','message','PAYMENT_COMPLETED'];a67_0x30df=function(){return _0x544ac9;};return a67_0x30df();}class RapydService{constructor(){const _0x299d1c=a67_0x128a58;this[_0x299d1c(0x241)]=_0x299d1c(0x1e4),console[_0x299d1c(0x209)](_0x299d1c(0x234));}async[a67_0x128a58(0x1cd)](_0x1aa633){const _0x46a541=a67_0x128a58,{orderId:_0x5d7811,orderName:_0x170a56,amount:_0x1da061,currency:_0x231a44,usage:_0x155c0f,maxPayments:_0x550dd3,successUrl:_0x24e157,failUrl:_0x2599ef,customerName:_0x445447,customerEmail:_0x36b543}=_0x1aa633,_0x31bce7=_0x231a44[_0x46a541(0x230)](),_0x360e94='GB';console[_0x46a541(0x209)](_0x46a541(0x1ea));const _0x73bd18=_0x46a541(0x23b)+_0x5d7811,_0x21ac7b=_0x46a541(0x21e)+_0x5d7811,_0x18992e={'amount':_0x1da061,'currency':_0x31bce7,'payment_method_options':{'3d_required':![]},'cancel_checkout_url':_0x21ac7b,'complete_checkout_url':_0x73bd18,'complete_payment_url':_0x73bd18,'merchant_reference_id':_0x5d7811,'description':_0x46a541(0x1fe)+_0x5d7811,'statement_descriptor':_0x46a541(0x215)+(_0x5d7811[_0x46a541(0x1f1)]('-')[0x1]||_0x5d7811),'country':'GB','payment_method_types_include':[_0x46a541(0x249),_0x46a541(0x213)],'custom_elements':{'display_description':!![],'billing_address_collect':!![],'required_customer_fields':[_0x46a541(0x256),_0x46a541(0x227),'phone_number',_0x46a541(0x23a)]}};_0x445447&&(_0x18992e[_0x46a541(0x219)][_0x46a541(0x214)]=_0x445447,console[_0x46a541(0x209)](_0x46a541(0x240)+_0x445447));if(_0x31bce7!==_0x46a541(0x1d0)){const _0x489185=Math[_0x46a541(0x20d)](Date['now']()/0x3e8)+0x1e*0x3c;_0x18992e[_0x46a541(0x1db)]=_0x46a541(0x238),_0x18992e[_0x46a541(0x1f5)]='EUR',_0x18992e[_0x46a541(0x22d)]=_0x489185,console['log'](_0x46a541(0x220)+_0x31bce7+'\x20->\x20EUR:'),console[_0x46a541(0x209)](_0x46a541(0x212)),console['log']('\x20\x20\x20requested_currency:\x20EUR'),console[_0x46a541(0x209)](_0x46a541(0x201)+_0x489185+'\x20('+new Date(_0x489185*0x3e8)[_0x46a541(0x21c)]()+')');}const _0x1ae13e=Date[_0x46a541(0x1f7)]();try{console[_0x46a541(0x209)](_0x46a541(0x1d1)),console['log'](_0x46a541(0x216),this['apiUrl']),console['log']('Request\x20Body\x20(Updated\x20Format):',JSON[_0x46a541(0x1df)](_0x18992e,null,0x2)),console['log']('ðŸ‡¬ðŸ‡§\x20Country:\x20'+_0x360e94+_0x46a541(0x254)),console['log']('ðŸ’³\x20Payment\x20Methods:\x20gb_visa_card,\x20gb_mastercard_card'),loggerService_1[_0x46a541(0x245)][_0x46a541(0x204)](_0x46a541(0x252),_0x46a541(0x22f),_0x46a541(0x24a),_0x18992e);const _0x1d8bf1=await fetch(this[_0x46a541(0x241)],{'method':_0x46a541(0x24a),'headers':{'Content-Type':_0x46a541(0x1e6),'User-Agent':_0x46a541(0x22a)},'body':JSON['stringify'](_0x18992e)}),_0x36d7fd=Date[_0x46a541(0x1f7)]()-_0x1ae13e;console[_0x46a541(0x209)](_0x46a541(0x210)),console[_0x46a541(0x209)](_0x46a541(0x1dd),_0x1d8bf1[_0x46a541(0x247)]),console['log'](_0x46a541(0x232),_0x1d8bf1[_0x46a541(0x224)]),console[_0x46a541(0x209)](_0x46a541(0x239),Object['fromEntries'](_0x1d8bf1[_0x46a541(0x1e1)][_0x46a541(0x237)]())),console['log'](_0x46a541(0x251),_0x36d7fd+'ms');const _0x38edc6=await _0x1d8bf1[_0x46a541(0x217)]();console[_0x46a541(0x209)](_0x46a541(0x1dc),_0x38edc6);if(!_0x1d8bf1['ok']){console[_0x46a541(0x228)](_0x46a541(0x246)),console[_0x46a541(0x228)](_0x46a541(0x257),_0x1d8bf1[_0x46a541(0x247)]),console[_0x46a541(0x228)]('Response\x20Body:',_0x38edc6),loggerService_1[_0x46a541(0x245)]['logWhiteDomainResponse']('rapyd','/v1/hosted/payment_links',_0x1d8bf1[_0x46a541(0x247)],_0x38edc6,_0x36d7fd),loggerService_1[_0x46a541(0x245)][_0x46a541(0x211)](_0x46a541(0x252),_0x46a541(0x22f),'HTTP\x20'+_0x1d8bf1[_0x46a541(0x247)]+':\x20'+_0x38edc6);throw new Error('HTTP\x20error!\x20status:\x20'+_0x1d8bf1[_0x46a541(0x247)]+_0x46a541(0x206)+_0x38edc6);}let _0x4c7c0d;try{_0x4c7c0d=JSON['parse'](_0x38edc6);}catch(_0x477a9e){console[_0x46a541(0x228)](_0x46a541(0x23f),_0x477a9e),loggerService_1[_0x46a541(0x245)]['logWhiteDomainError'](_0x46a541(0x252),_0x46a541(0x22f),'JSON\x20Parse\x20Error:\x20'+_0x477a9e);throw new Error('Invalid\x20JSON\x20response\x20from\x20Rapyd\x20API:\x20'+_0x38edc6);}console[_0x46a541(0x209)](_0x46a541(0x1ef)),console[_0x46a541(0x209)]('Parsed\x20Result:',JSON['stringify'](_0x4c7c0d,null,0x2)),loggerService_1['loggerService']['logWhiteDomainResponse'](_0x46a541(0x252),_0x46a541(0x22f),_0x1d8bf1[_0x46a541(0x247)],_0x4c7c0d,_0x36d7fd);if(_0x4c7c0d['status']?.[_0x46a541(0x247)]!==_0x46a541(0x203)){const _0x46fe81=_0x4c7c0d[_0x46a541(0x247)]?.[_0x46a541(0x235)]||'Unknown\x20error\x20from\x20Rapyd\x20API',_0x986549=_0x4c7c0d[_0x46a541(0x247)]?.[_0x46a541(0x1e2)]||_0x46a541(0x1d6);console[_0x46a541(0x228)]('===\x20RAPYD\x20API\x20BUSINESS\x20ERROR\x20==='),console[_0x46a541(0x228)](_0x46a541(0x1fd),_0x986549),console['error'](_0x46a541(0x1e8),_0x46fe81),console[_0x46a541(0x228)](_0x46a541(0x250),_0x4c7c0d[_0x46a541(0x247)]),loggerService_1[_0x46a541(0x245)][_0x46a541(0x211)](_0x46a541(0x252),_0x46a541(0x22f),'Business\x20Error\x20('+_0x986549+_0x46a541(0x24d)+_0x46fe81);throw new Error('Rapyd\x20API\x20error\x20('+_0x986549+'):\x20'+_0x46fe81);}if(!_0x4c7c0d[_0x46a541(0x20a)]?.['id']||!_0x4c7c0d[_0x46a541(0x20a)]?.[_0x46a541(0x1d2)]){console['error']('===\x20RAPYD\x20API\x20INCOMPLETE\x20RESPONSE\x20==='),console[_0x46a541(0x228)](_0x46a541(0x1e7)),console[_0x46a541(0x228)](_0x46a541(0x22b),_0x4c7c0d['data']),loggerService_1['loggerService'][_0x46a541(0x211)]('rapyd',_0x46a541(0x22f),_0x46a541(0x20f));throw new Error(_0x46a541(0x1f6));}return console[_0x46a541(0x209)](_0x46a541(0x221)),console[_0x46a541(0x209)]('Payment\x20Link\x20ID:',_0x4c7c0d['data']['id']),console['log'](_0x46a541(0x21d),_0x4c7c0d[_0x46a541(0x20a)][_0x46a541(0x1d2)]),console['log']('ðŸ‡¬ðŸ‡§\x20Country\x20used:\x20'+_0x360e94+_0x46a541(0x218)),console[_0x46a541(0x209)](_0x46a541(0x1cc)),{'gateway_payment_id':_0x4c7c0d[_0x46a541(0x20a)]['id'],'payment_url':_0x4c7c0d[_0x46a541(0x20a)][_0x46a541(0x1d2)]};}catch(_0x141daf){console['error'](_0x46a541(0x1d3)),console[_0x46a541(0x228)](_0x46a541(0x20c),_0x141daf),loggerService_1[_0x46a541(0x245)][_0x46a541(0x211)]('rapyd',_0x46a541(0x22f),_0x141daf);if(_0x141daf instanceof Error){console[_0x46a541(0x228)](_0x46a541(0x21b),_0x141daf[_0x46a541(0x235)]),console[_0x46a541(0x228)](_0x46a541(0x1d8),_0x141daf['stack']);throw new Error(_0x46a541(0x1fc)+_0x141daf['message']);}throw new Error(_0x46a541(0x229));}}async[a67_0x128a58(0x205)](_0x37ff85){const _0x52eb79=a67_0x128a58,_0x35c446=Date[_0x52eb79(0x1f7)]();try{loggerService_1[_0x52eb79(0x245)]['logWhiteDomainRequest'](_0x52eb79(0x252),_0x52eb79(0x23e)+_0x37ff85,_0x52eb79(0x1da),{});const _0xe5ed7d=await fetch(this[_0x52eb79(0x241)]+'/'+_0x37ff85,{'method':_0x52eb79(0x1da),'headers':{'Content-Type':'application/json','User-Agent':_0x52eb79(0x22a)}}),_0x3905db=Date[_0x52eb79(0x1f7)]()-_0x35c446;if(!_0xe5ed7d['ok']){const _0x13d1f3=await _0xe5ed7d[_0x52eb79(0x217)]();loggerService_1[_0x52eb79(0x245)][_0x52eb79(0x1f4)](_0x52eb79(0x252),_0x52eb79(0x23e)+_0x37ff85,_0xe5ed7d[_0x52eb79(0x247)],_0x13d1f3,_0x3905db);throw new Error(_0x52eb79(0x24f)+_0xe5ed7d[_0x52eb79(0x247)]);}const _0xd02e40=await _0xe5ed7d[_0x52eb79(0x1ce)]();loggerService_1['loggerService'][_0x52eb79(0x1f4)](_0x52eb79(0x252),'/v1/hosted/payment_links/'+_0x37ff85,_0xe5ed7d[_0x52eb79(0x247)],_0xd02e40,_0x3905db);if(_0xd02e40[_0x52eb79(0x247)]?.[_0x52eb79(0x247)]!==_0x52eb79(0x203)){loggerService_1[_0x52eb79(0x245)][_0x52eb79(0x211)](_0x52eb79(0x252),'/v1/hosted/payment_links/'+_0x37ff85,_0x52eb79(0x1f3)+(_0xd02e40[_0x52eb79(0x247)]?.['message']||_0x52eb79(0x1cf)));throw new Error(_0x52eb79(0x1f3)+(_0xd02e40[_0x52eb79(0x247)]?.[_0x52eb79(0x235)]||_0x52eb79(0x1cf)));}let _0x5efb76=_0x52eb79(0x248);if(_0xd02e40['data']?.[_0x52eb79(0x247)])switch(_0xd02e40['data'][_0x52eb79(0x247)][_0x52eb79(0x230)]()){case _0x52eb79(0x24e):_0x5efb76=_0x52eb79(0x23d);break;case _0x52eb79(0x1d7):_0x5efb76='FAILED';break;case _0x52eb79(0x20e):_0x5efb76=_0x52eb79(0x1eb);break;case'ERR':_0x5efb76=_0x52eb79(0x21f);break;case _0x52eb79(0x1e3):case _0x52eb79(0x208):default:_0x5efb76=_0x52eb79(0x248);break;}return{'status':_0x5efb76,'amount':_0xd02e40['data']?.[_0x52eb79(0x223)],'currency':_0xd02e40[_0x52eb79(0x20a)]?.['currency']};}catch(_0x121b94){console['error'](_0x52eb79(0x1fa),_0x121b94),loggerService_1[_0x52eb79(0x245)]['logWhiteDomainError'](_0x52eb79(0x252),_0x52eb79(0x23e)+_0x37ff85,_0x121b94);throw new Error(_0x52eb79(0x233)+(_0x121b94 instanceof Error?_0x121b94[_0x52eb79(0x235)]:_0x52eb79(0x1cf)));}}async['processWebhook'](_0x3867a0){const _0x1e999b=a67_0x128a58;console['log']('Processing\x20Rapyd\x20webhook:',_0x3867a0);let _0x1bf6b9=_0x1e999b(0x248),_0x3ad860;_0x3867a0['data']?.[_0x1e999b(0x1d5)]&&(_0x3ad860=_0x3867a0[_0x1e999b(0x20a)][_0x1e999b(0x1d5)],console[_0x1e999b(0x209)](_0x1e999b(0x1f0)+_0x3ad860));switch(_0x3867a0[_0x1e999b(0x1f9)]?.[_0x1e999b(0x230)]()){case _0x1e999b(0x236):_0x3867a0['data']?.[_0x1e999b(0x1e5)]===!![]&&_0x3867a0[_0x1e999b(0x20a)]?.[_0x1e999b(0x247)]===_0x1e999b(0x24e)?_0x1bf6b9=_0x1e999b(0x23d):_0x1bf6b9=_0x1e999b(0x248);break;case _0x1e999b(0x243):_0x1bf6b9='FAILED';break;case _0x1e999b(0x244):_0x1bf6b9=_0x1e999b(0x1eb);break;case _0x1e999b(0x1c9):_0x1bf6b9=_0x1e999b(0x21f);!_0x3ad860&&_0x3867a0[_0x1e999b(0x20a)]?.[_0x1e999b(0x1d5)]&&(_0x3ad860=_0x3867a0[_0x1e999b(0x20a)][_0x1e999b(0x1d5)]);break;default:switch(_0x3867a0[_0x1e999b(0x20a)]?.[_0x1e999b(0x247)]?.['toUpperCase']()){case _0x1e999b(0x24e):_0x3867a0[_0x1e999b(0x20a)]?.['paid']===!![]?_0x1bf6b9=_0x1e999b(0x23d):_0x1bf6b9=_0x1e999b(0x21f);break;case _0x1e999b(0x1d7):_0x1bf6b9=_0x1e999b(0x21f);break;case _0x1e999b(0x20e):_0x1bf6b9='EXPIRED';break;case _0x1e999b(0x255):_0x1bf6b9=_0x1e999b(0x21f);!_0x3ad860&&_0x3867a0[_0x1e999b(0x20a)]?.[_0x1e999b(0x1d5)]&&(_0x3ad860=_0x3867a0[_0x1e999b(0x20a)][_0x1e999b(0x1d5)]);break;case _0x1e999b(0x1e3):case _0x1e999b(0x208):default:_0x1bf6b9='PENDING';break;}break;}const _0x4d2f7d={};return _0x3867a0[_0x1e999b(0x20a)]?.[_0x1e999b(0x253)]?.['last4']&&(_0x4d2f7d[_0x1e999b(0x226)]=_0x3867a0[_0x1e999b(0x20a)][_0x1e999b(0x253)][_0x1e999b(0x24c)]),_0x3867a0[_0x1e999b(0x20a)]?.[_0x1e999b(0x253)]?.[_0x1e999b(0x200)]?.[_0x1e999b(0x222)]&&(_0x4d2f7d[_0x1e999b(0x1e9)]=_0x3867a0[_0x1e999b(0x20a)][_0x1e999b(0x253)]['bin_details'][_0x1e999b(0x222)],console[_0x1e999b(0x209)](_0x1e999b(0x1f8)+_0x4d2f7d[_0x1e999b(0x1e9)])),_0x3867a0[_0x1e999b(0x20a)]?.['payment_method_type']&&(_0x4d2f7d[_0x1e999b(0x1de)]=_0x3867a0['data'][_0x1e999b(0x1f2)]),_0x3867a0[_0x1e999b(0x20a)]?.[_0x1e999b(0x1e2)]&&(_0x4d2f7d['errorCode']=_0x3867a0[_0x1e999b(0x20a)][_0x1e999b(0x1e2)]),_0x3867a0[_0x1e999b(0x20a)]?.[_0x1e999b(0x242)]&&(_0x4d2f7d[_0x1e999b(0x1ca)]=_0x3867a0['data'][_0x1e999b(0x242)]),console['log'](_0x1e999b(0x22e)+_0x1bf6b9+_0x1e999b(0x24b)+(_0x3ad860||_0x1e999b(0x1e0))),{'paymentId':_0x3867a0[_0x1e999b(0x20a)]?.[_0x1e999b(0x20b)]||'','status':_0x1bf6b9,'amount':_0x3867a0[_0x1e999b(0x20a)]?.['amount'],'currency':_0x3867a0[_0x1e999b(0x20a)]?.[_0x1e999b(0x231)],'failureMessage':_0x3ad860,'additionalInfo':_0x4d2f7d};}}exports['RapydService']=RapydService;