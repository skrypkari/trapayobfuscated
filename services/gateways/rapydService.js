'use strict';const a56_0x2268cf=a56_0x24c6;(function(_0x3a4a44,_0x343a6f){const _0x5dcddb=a56_0x24c6,_0x1804fa=_0x3a4a44();while(!![]){try{const _0x535baa=parseInt(_0x5dcddb(0xf1))/0x1+-parseInt(_0x5dcddb(0xf5))/0x2*(parseInt(_0x5dcddb(0xdc))/0x3)+parseInt(_0x5dcddb(0x115))/0x4*(parseInt(_0x5dcddb(0xc2))/0x5)+parseInt(_0x5dcddb(0xac))/0x6*(parseInt(_0x5dcddb(0x97))/0x7)+-parseInt(_0x5dcddb(0xe1))/0x8*(parseInt(_0x5dcddb(0xb8))/0x9)+-parseInt(_0x5dcddb(0xfb))/0xa+-parseInt(_0x5dcddb(0xc7))/0xb;if(_0x535baa===_0x343a6f)break;else _0x1804fa['push'](_0x1804fa['shift']());}catch(_0xa9676a){_0x1804fa['push'](_0x1804fa['shift']());}}}(a56_0xa656,0xaa50e));function a56_0xa656(){const _0x308b85=['98523QzYIaY','HTTP\x20error!\x20status:\x20','errorCode','logWhiteDomainResponse',',\x20failureMessage=','🇬🇧\x20Using\x20GB\x20(Britain)\x20as\x20country\x20for\x20Rapyd\x20payment\x20link','requested_currency','application/json','Raw\x20Response\x20Body:','PAYMENT_COMPLETED','20adXVzu','Missing\x20id\x20or\x20redirect_url\x20in\x20response','now','Failed\x20to\x20create\x20Rapyd\x20payment\x20link:\x20','entries','14586935MAzQlO','ACT','Response\x20Body:','PAYMENT_CANCELED','data','rapyd','🇬🇧\x20Country\x20used:\x20','Rapyd\x20API\x20error\x20(','json','paymentMethod','PAYMENT_FAILED','Redirect\x20URL:','CLO','EUR',',\x20body:\x20','URL:','failure_code','payment_method_data','JSON\x20Parse\x20Error:\x20','Unknown\x20error','Invalid\x20response\x20from\x20Rapyd\x20API:\x20missing\x20id\x20or\x20redirect_url','603426SyFfsp','headers','FAILED','Business\x20Error\x20(','Headers:','248AHxliW','fixed_side','error_code','Invalid\x20JSON\x20response\x20from\x20Rapyd\x20API:\x20','Unknown\x20error\x20from\x20Rapyd\x20API','paid','statusText','\x20\x20\x20fixed_side:\x20buy','text','gb_mastercard_card','Request\x20Body\x20(Updated\x20Format):','../loggerService','Incomplete\x20response:\x20missing\x20id\x20or\x20redirect_url','floor','\x20\x20\x20requested_currency:\x20EUR','amount','709893dAUdJc','Status\x20Text:','):\x20','createPaymentLink','2gkrVaf','Payment\x20Link\x20ID:','PENDING','===\x20RAPYD\x20API\x20RESPONSE\x20(White\x20Domain)\x20===','EXPIRED','stack','4818210YPPdVJ','PAID','toUpperCase','apiUrl','RapydService','buy','ERR','Processing\x20Rapyd\x20webhook:','🌐\x20Rapyd\x20service\x20initialized\x20with\x20white\x20domain\x20proxy','fromEntries','message','NEW','UNKNOWN','\x20\x20\x20expiration:\x20','GET','last4','===\x20RAPYD\x20SERVICE\x20ERROR\x20===','EXP','Failed\x20to\x20verify\x20Rapyd\x20payment:\x20','https://tesoft.uk/gateway/rapyd/','HTTP\x20','\x20(always\x20GB\x20for\x20Rapyd)','logWhiteDomainRequest','/v1/hosted/payment_links','loggerService','stringify','1090988hAjwAj','payment_method_type','Payment\x20System/1.0','defineProperty','2905322MpjSAg','expiration','===\x20RAPYD\x20API\x20INCOMPLETE\x20RESPONSE\x20===','error','🔄\x20Rapyd\x20webhook\x20processed:\x20status=','===\x20RAPYD\x20API\x20BUSINESS\x20ERROR\x20===','Rapyd\x20API\x20error:\x20','failureCode','Response\x20Time:','CAN','__esModule','PAYMENT_EXPIRED','POST','/v1/hosted/payment_links/','type','===\x20RAPYD\x20SUCCESS\x20===','SUCCESS','\x20->\x20EUR:','currency','status','logWhiteDomainError','18iXWTUn','Status:','💱\x20Adding\x20currency\x20conversion\x20fields\x20for\x20','Error\x20stack:','verifyPayment','https://tesoft.uk/gateway/fail.php?id=','redirect_url','https://tesoft.uk/gateway/success.php?id=','HTTP\x20Status:','failure_message','log','parse'];a56_0xa656=function(){return _0x308b85;};return a56_0xa656();}Object[a56_0x2268cf(0x96)](exports,a56_0x2268cf(0xa1),{'value':!![]}),exports[a56_0x2268cf(0xff)]=void 0x0;const loggerService_1=require(a56_0x2268cf(0xec));function a56_0x24c6(_0x55e7b6,_0x1a96a0){const _0xa65630=a56_0xa656();return a56_0x24c6=function(_0x24c645,_0x563386){_0x24c645=_0x24c645-0x94;let _0x118bc1=_0xa65630[_0x24c645];return _0x118bc1;},a56_0x24c6(_0x55e7b6,_0x1a96a0);}class RapydService{constructor(){const _0x389ad9=a56_0x2268cf;this['apiUrl']=_0x389ad9(0x10e),console[_0x389ad9(0xb6)](_0x389ad9(0x103));}async[a56_0x2268cf(0xf4)](_0x51164b){const _0x40ae14=a56_0x2268cf,{orderId:_0x18d0c0,orderName:_0x5b4da2,amount:_0x47c97d,currency:_0x4d1c7b,usage:_0x131667,maxPayments:_0x352840,successUrl:_0x8b28b8,failUrl:_0x3c0297}=_0x51164b,_0x1b2e0f=_0x4d1c7b['toUpperCase'](),_0x2d1d5f='GB';console[_0x40ae14(0xb6)](_0x40ae14(0xbd));const _0x59eaf5=_0x40ae14(0xb3)+_0x18d0c0,_0x38941a=_0x40ae14(0xb1)+_0x18d0c0,_0x167066={'amount':_0x47c97d,'currency':_0x1b2e0f,'cancel_checkout_url':_0x38941a,'complete_checkout_url':_0x59eaf5,'complete_payment_url':_0x59eaf5,'merchant_reference_id':_0x18d0c0,'description':'ORDER:\x20'+_0x18d0c0,'country':'GB','payment_method_types_include':['gb_visa_card',_0x40ae14(0xea)],'custom_elements':{'display_description':!![]}};if(_0x1b2e0f!==_0x40ae14(0xd4)){const _0x4bbf11=Math[_0x40ae14(0xee)](Date[_0x40ae14(0xc4)]()/0x3e8)+0x1e*0x3c;_0x167066[_0x40ae14(0xe2)]=_0x40ae14(0x100),_0x167066[_0x40ae14(0xbe)]='EUR',_0x167066[_0x40ae14(0x98)]=_0x4bbf11,console[_0x40ae14(0xb6)](_0x40ae14(0xae)+_0x1b2e0f+_0x40ae14(0xa8)),console[_0x40ae14(0xb6)](_0x40ae14(0xe8)),console[_0x40ae14(0xb6)](_0x40ae14(0xef)),console['log'](_0x40ae14(0x108)+_0x4bbf11+'\x20('+new Date(_0x4bbf11*0x3e8)['toISOString']()+')');}const _0x47959b=Date['now']();try{console['log']('===\x20RAPYD\x20API\x20REQUEST\x20(White\x20Domain\x20-\x20Updated\x20Format)\x20==='),console[_0x40ae14(0xb6)](_0x40ae14(0xd6),this[_0x40ae14(0xfe)]),console[_0x40ae14(0xb6)](_0x40ae14(0xeb),JSON[_0x40ae14(0x114)](_0x167066,null,0x2)),console[_0x40ae14(0xb6)]('🇬🇧\x20Country:\x20'+_0x2d1d5f+_0x40ae14(0x110)),console['log']('💳\x20Payment\x20Methods:\x20gb_visa_card,\x20gb_mastercard_card'),loggerService_1[_0x40ae14(0x113)][_0x40ae14(0x111)](_0x40ae14(0xcc),_0x40ae14(0x112),_0x40ae14(0xa3),_0x167066);const _0x3fbb84=await fetch(this[_0x40ae14(0xfe)],{'method':_0x40ae14(0xa3),'headers':{'Content-Type':_0x40ae14(0xbf),'User-Agent':_0x40ae14(0x95)},'body':JSON[_0x40ae14(0x114)](_0x167066)}),_0x59926a=Date[_0x40ae14(0xc4)]()-_0x47959b;console[_0x40ae14(0xb6)](_0x40ae14(0xf8)),console[_0x40ae14(0xb6)](_0x40ae14(0xad),_0x3fbb84[_0x40ae14(0xaa)]),console[_0x40ae14(0xb6)](_0x40ae14(0xf2),_0x3fbb84[_0x40ae14(0xe7)]),console[_0x40ae14(0xb6)](_0x40ae14(0xe0),Object[_0x40ae14(0x104)](_0x3fbb84[_0x40ae14(0xdd)][_0x40ae14(0xc6)]())),console['log'](_0x40ae14(0x9f),_0x59926a+'ms');const _0x4519d6=await _0x3fbb84[_0x40ae14(0xe9)]();console[_0x40ae14(0xb6)](_0x40ae14(0xc0),_0x4519d6);if(!_0x3fbb84['ok']){console[_0x40ae14(0x9a)]('===\x20RAPYD\x20API\x20ERROR\x20==='),console[_0x40ae14(0x9a)](_0x40ae14(0xb4),_0x3fbb84['status']),console[_0x40ae14(0x9a)](_0x40ae14(0xc9),_0x4519d6),loggerService_1['loggerService'][_0x40ae14(0xbb)](_0x40ae14(0xcc),_0x40ae14(0x112),_0x3fbb84[_0x40ae14(0xaa)],_0x4519d6,_0x59926a),loggerService_1['loggerService'][_0x40ae14(0xab)](_0x40ae14(0xcc),_0x40ae14(0x112),_0x40ae14(0x10f)+_0x3fbb84['status']+':\x20'+_0x4519d6);throw new Error(_0x40ae14(0xb9)+_0x3fbb84[_0x40ae14(0xaa)]+_0x40ae14(0xd5)+_0x4519d6);}let _0x246996;try{_0x246996=JSON[_0x40ae14(0xb7)](_0x4519d6);}catch(_0x3c70c2){console[_0x40ae14(0x9a)]('Failed\x20to\x20parse\x20JSON\x20response:',_0x3c70c2),loggerService_1['loggerService'][_0x40ae14(0xab)](_0x40ae14(0xcc),_0x40ae14(0x112),_0x40ae14(0xd9)+_0x3c70c2);throw new Error(_0x40ae14(0xe4)+_0x4519d6);}console[_0x40ae14(0xb6)]('===\x20PARSED\x20RAPYD\x20RESPONSE\x20==='),console[_0x40ae14(0xb6)]('Parsed\x20Result:',JSON[_0x40ae14(0x114)](_0x246996,null,0x2)),loggerService_1['loggerService']['logWhiteDomainResponse'](_0x40ae14(0xcc),_0x40ae14(0x112),_0x3fbb84[_0x40ae14(0xaa)],_0x246996,_0x59926a);if(_0x246996[_0x40ae14(0xaa)]?.[_0x40ae14(0xaa)]!==_0x40ae14(0xa7)){const _0x4d765f=_0x246996[_0x40ae14(0xaa)]?.[_0x40ae14(0x105)]||_0x40ae14(0xe5),_0x28cf7c=_0x246996[_0x40ae14(0xaa)]?.[_0x40ae14(0xe3)]||_0x40ae14(0x107);console[_0x40ae14(0x9a)](_0x40ae14(0x9c)),console[_0x40ae14(0x9a)]('Error\x20Code:',_0x28cf7c),console[_0x40ae14(0x9a)]('Error\x20Message:',_0x4d765f),console[_0x40ae14(0x9a)]('Full\x20Error\x20Data:',_0x246996[_0x40ae14(0xaa)]),loggerService_1[_0x40ae14(0x113)][_0x40ae14(0xab)](_0x40ae14(0xcc),'/v1/hosted/payment_links',_0x40ae14(0xdf)+_0x28cf7c+_0x40ae14(0xf3)+_0x4d765f);throw new Error(_0x40ae14(0xce)+_0x28cf7c+_0x40ae14(0xf3)+_0x4d765f);}if(!_0x246996['data']?.['id']||!_0x246996[_0x40ae14(0xcb)]?.[_0x40ae14(0xb2)]){console[_0x40ae14(0x9a)](_0x40ae14(0x99)),console['error'](_0x40ae14(0xc3)),console[_0x40ae14(0x9a)]('Response\x20data:',_0x246996[_0x40ae14(0xcb)]),loggerService_1[_0x40ae14(0x113)][_0x40ae14(0xab)](_0x40ae14(0xcc),_0x40ae14(0x112),_0x40ae14(0xed));throw new Error(_0x40ae14(0xdb));}return console[_0x40ae14(0xb6)](_0x40ae14(0xa6)),console[_0x40ae14(0xb6)](_0x40ae14(0xf6),_0x246996[_0x40ae14(0xcb)]['id']),console['log'](_0x40ae14(0xd2),_0x246996[_0x40ae14(0xcb)][_0x40ae14(0xb2)]),console[_0x40ae14(0xb6)](_0x40ae14(0xcd)+_0x2d1d5f+'\x20(GB\x20-\x20Britain)'),console[_0x40ae14(0xb6)]('💳\x20Payment\x20Methods:\x20gb_visa_card,\x20gb_mastercard_card'),{'gateway_payment_id':_0x246996['data']['id'],'payment_url':_0x246996[_0x40ae14(0xcb)]['redirect_url']};}catch(_0x44812e){console[_0x40ae14(0x9a)](_0x40ae14(0x10b)),console[_0x40ae14(0x9a)]('Error\x20details:',_0x44812e),loggerService_1['loggerService']['logWhiteDomainError']('rapyd',_0x40ae14(0x112),_0x44812e);if(_0x44812e instanceof Error){console[_0x40ae14(0x9a)]('Error\x20message:',_0x44812e[_0x40ae14(0x105)]),console[_0x40ae14(0x9a)](_0x40ae14(0xaf),_0x44812e[_0x40ae14(0xfa)]);throw new Error(_0x40ae14(0xc5)+_0x44812e[_0x40ae14(0x105)]);}throw new Error('Failed\x20to\x20create\x20Rapyd\x20payment\x20link:\x20Unknown\x20error');}}async[a56_0x2268cf(0xb0)](_0x1ed495){const _0x23961f=a56_0x2268cf,_0x36fdd4=Date[_0x23961f(0xc4)]();try{loggerService_1['loggerService'][_0x23961f(0x111)]('rapyd','/v1/hosted/payment_links/'+_0x1ed495,_0x23961f(0x109),{});const _0x17c3b9=await fetch(this['apiUrl']+'/'+_0x1ed495,{'method':_0x23961f(0x109),'headers':{'Content-Type':_0x23961f(0xbf),'User-Agent':_0x23961f(0x95)}}),_0x506148=Date[_0x23961f(0xc4)]()-_0x36fdd4;if(!_0x17c3b9['ok']){const _0x338084=await _0x17c3b9[_0x23961f(0xe9)]();loggerService_1['loggerService']['logWhiteDomainResponse'](_0x23961f(0xcc),_0x23961f(0xa4)+_0x1ed495,_0x17c3b9[_0x23961f(0xaa)],_0x338084,_0x506148);throw new Error(_0x23961f(0xb9)+_0x17c3b9[_0x23961f(0xaa)]);}const _0x48d61c=await _0x17c3b9[_0x23961f(0xcf)]();loggerService_1[_0x23961f(0x113)][_0x23961f(0xbb)](_0x23961f(0xcc),_0x23961f(0xa4)+_0x1ed495,_0x17c3b9[_0x23961f(0xaa)],_0x48d61c,_0x506148);if(_0x48d61c[_0x23961f(0xaa)]?.[_0x23961f(0xaa)]!==_0x23961f(0xa7)){loggerService_1[_0x23961f(0x113)][_0x23961f(0xab)](_0x23961f(0xcc),_0x23961f(0xa4)+_0x1ed495,_0x23961f(0x9d)+(_0x48d61c[_0x23961f(0xaa)]?.[_0x23961f(0x105)]||_0x23961f(0xda)));throw new Error(_0x23961f(0x9d)+(_0x48d61c[_0x23961f(0xaa)]?.['message']||'Unknown\x20error'));}let _0x33f0e0=_0x23961f(0xf7);if(_0x48d61c['data']?.['status'])switch(_0x48d61c[_0x23961f(0xcb)][_0x23961f(0xaa)][_0x23961f(0xfd)]()){case'CLO':_0x33f0e0='PAID';break;case'CAN':_0x33f0e0=_0x23961f(0xde);break;case'EXP':_0x33f0e0=_0x23961f(0xf9);break;case _0x23961f(0x101):_0x33f0e0=_0x23961f(0xde);break;case _0x23961f(0x106):case _0x23961f(0xc8):default:_0x33f0e0='PENDING';break;}return{'status':_0x33f0e0,'amount':_0x48d61c[_0x23961f(0xcb)]?.[_0x23961f(0xf0)],'currency':_0x48d61c[_0x23961f(0xcb)]?.[_0x23961f(0xa9)]};}catch(_0x2c6942){console[_0x23961f(0x9a)]('Rapyd\x20payment\x20verification\x20error:',_0x2c6942),loggerService_1['loggerService'][_0x23961f(0xab)](_0x23961f(0xcc),_0x23961f(0xa4)+_0x1ed495,_0x2c6942);throw new Error(_0x23961f(0x10d)+(_0x2c6942 instanceof Error?_0x2c6942[_0x23961f(0x105)]:_0x23961f(0xda)));}}async['processWebhook'](_0x4b0c09){const _0x12259c=a56_0x2268cf;console[_0x12259c(0xb6)](_0x12259c(0x102),_0x4b0c09);let _0x2b155f=_0x12259c(0xf7),_0x2a8013;_0x4b0c09[_0x12259c(0xcb)]?.['failure_message']&&(_0x2a8013=_0x4b0c09[_0x12259c(0xcb)][_0x12259c(0xb5)],console[_0x12259c(0xb6)]('💥\x20Rapyd\x20failure\x20message:\x20'+_0x2a8013));switch(_0x4b0c09[_0x12259c(0xa5)]?.[_0x12259c(0xfd)]()){case _0x12259c(0xc1):_0x4b0c09[_0x12259c(0xcb)]?.[_0x12259c(0xe6)]===!![]&&_0x4b0c09[_0x12259c(0xcb)]?.[_0x12259c(0xaa)]===_0x12259c(0xd3)?_0x2b155f=_0x12259c(0xfc):_0x2b155f=_0x12259c(0xf7);break;case _0x12259c(0xca):_0x2b155f=_0x12259c(0xde);break;case _0x12259c(0xa2):_0x2b155f=_0x12259c(0xf9);break;case _0x12259c(0xd1):_0x2b155f='FAILED';!_0x2a8013&&_0x4b0c09['data']?.[_0x12259c(0xb5)]&&(_0x2a8013=_0x4b0c09[_0x12259c(0xcb)][_0x12259c(0xb5)]);break;default:switch(_0x4b0c09[_0x12259c(0xcb)]?.['status']?.['toUpperCase']()){case _0x12259c(0xd3):_0x4b0c09['data']?.['paid']===!![]?_0x2b155f=_0x12259c(0xfc):_0x2b155f=_0x12259c(0xde);break;case _0x12259c(0xa0):_0x2b155f=_0x12259c(0xde);break;case _0x12259c(0x10c):_0x2b155f=_0x12259c(0xf9);break;case'ERR':_0x2b155f=_0x12259c(0xde);!_0x2a8013&&_0x4b0c09[_0x12259c(0xcb)]?.[_0x12259c(0xb5)]&&(_0x2a8013=_0x4b0c09['data']['failure_message']);break;case'NEW':case _0x12259c(0xc8):default:_0x2b155f='PENDING';break;}break;}const _0x5b45ec={};return _0x4b0c09[_0x12259c(0xcb)]?.[_0x12259c(0xd8)]?.['last4']&&(_0x5b45ec['cardLast4']=_0x4b0c09[_0x12259c(0xcb)][_0x12259c(0xd8)][_0x12259c(0x10a)]),_0x4b0c09[_0x12259c(0xcb)]?.[_0x12259c(0x94)]&&(_0x5b45ec[_0x12259c(0xd0)]=_0x4b0c09[_0x12259c(0xcb)]['payment_method_type']),_0x4b0c09[_0x12259c(0xcb)]?.[_0x12259c(0xe3)]&&(_0x5b45ec[_0x12259c(0xba)]=_0x4b0c09[_0x12259c(0xcb)][_0x12259c(0xe3)]),_0x4b0c09['data']?.[_0x12259c(0xd7)]&&(_0x5b45ec[_0x12259c(0x9e)]=_0x4b0c09['data'][_0x12259c(0xd7)]),console[_0x12259c(0xb6)](_0x12259c(0x9b)+_0x2b155f+_0x12259c(0xbc)+(_0x2a8013||'none')),{'paymentId':_0x4b0c09[_0x12259c(0xcb)]?.['merchant_reference_id']||'','status':_0x2b155f,'amount':_0x4b0c09['data']?.[_0x12259c(0xf0)],'currency':_0x4b0c09['data']?.[_0x12259c(0xa9)],'failureMessage':_0x2a8013,'additionalInfo':_0x5b45ec};}}exports[a56_0x2268cf(0xff)]=RapydService;