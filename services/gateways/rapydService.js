'use strict';function a63_0x5e24(){const _0x553662=['Rapyd\x20API\x20error:\x20','HTTP\x20error!\x20status:\x20','rapyd','Response\x20data:','ðŸŒ\x20Rapyd\x20service\x20initialized\x20with\x20white\x20domain\x20proxy','__esModule','application/json','SUCCESS','===\x20RAPYD\x20API\x20INCOMPLETE\x20RESPONSE\x20===','EXPIRED','===\x20RAPYD\x20SERVICE\x20ERROR\x20===','error','headers','message','Rapyd\x20payment\x20verification\x20error:','ðŸ’±\x20Adding\x20currency\x20conversion\x20fields\x20for\x20','ðŸ’¥\x20Rapyd\x20failure\x20message:\x20','RapydService','27245SPoAPh','GET','log','ðŸ’³\x20Adding\x20cardholder\x20name:\x20','Failed\x20to\x20create\x20Rapyd\x20payment\x20link:\x20Unknown\x20error','Incomplete\x20response:\x20missing\x20id\x20or\x20redirect_url','entries','PAID','email','NEW','ERR','Failed\x20to\x20parse\x20JSON\x20response:','json','amount','POST','CLO','Error\x20message:','toUpperCase','\x20\x20\x20fixed_side:\x20buy','expiration','now','floor','https://tesoft.uk/gateway/fail.php?id=','phone_number','type','281897rLfKqj','700742mkBANO','Error\x20details:','logWhiteDomainResponse','Response\x20Time:','EXP','ACT','processWebhook','toISOString','Error\x20stack:','createPaymentLink','URL:','payment_method_data','../loggerService','https://tesoft.uk/gateway/rapyd/','154lPXdHB','===\x20RAPYD\x20API\x20ERROR\x20===','Error\x20Message:','fromEntries','stringify','https://tesoft.uk/gateway/success.php?id=',',\x20failureMessage=','HTTP\x20Status:','/v1/hosted/payment_links','Business\x20Error\x20(','/v1/hosted/payment_links/','Invalid\x20response\x20from\x20Rapyd\x20API:\x20missing\x20id\x20or\x20redirect_url','\x20->\x20EUR:','failure_message','657530tzWyOR','apiUrl','1007740CaxxhL','Invalid\x20JSON\x20response\x20from\x20Rapyd\x20API:\x20','HTTP\x20','FAILED','UNKNOWN','ðŸ‡¬ðŸ‡§\x20Using\x20GB\x20(Britain)\x20as\x20country\x20for\x20Rapyd\x20payment\x20link','Headers:','CAN','logWhiteDomainRequest','6QNmCDJ','\x20(GB\x20-\x20Britain)','Status:','PAYMENT_EXPIRED','failure_code','Redirect\x20URL:','merchant_reference_id','stack','Rapyd\x20API\x20error\x20(','Failed\x20to\x20verify\x20Rapyd\x20payment:\x20','split','\x20(always\x20GB\x20for\x20Rapyd)','requested_currency','Unknown\x20error',',\x20body:\x20','Processing\x20Rapyd\x20webhook:','ðŸ’³\x20Payment\x20Methods:\x20gb_visa_card,\x20gb_mastercard_card','PAYMENT_FAILED','Failed\x20to\x20create\x20Rapyd\x20payment\x20link:\x20','Unknown\x20error\x20from\x20Rapyd\x20API','):\x20','text','PENDING','logWhiteDomainError','Status\x20Text:','redirect_url','last4','paid','JSON\x20Parse\x20Error:\x20','defineProperty','TESOFT\x20','EUR','5661252Iubpvx','Payment\x20Link\x20ID:','status','Payment\x20System/1.0','618vhjIFw','cardLast4','===\x20RAPYD\x20SUCCESS\x20===','\x20\x20\x20expiration:\x20','paymentMethod','gb_mastercard_card','loggerService','===\x20RAPYD\x20API\x20BUSINESS\x20ERROR\x20===','68349VDlwgU','Request\x20Body\x20(Updated\x20Format):','failureCode','error_code','ðŸ‡¬ðŸ‡§\x20Country:\x20','64LUHKqI','fixed_side','Response\x20Body:','parse','data'];a63_0x5e24=function(){return _0x553662;};return a63_0x5e24();}const a63_0x409ee2=a63_0x2266;(function(_0x20aa2e,_0x579c24){const _0x4c0379=a63_0x2266,_0x42f9ea=_0x20aa2e();while(!![]){try{const _0x1ee091=parseInt(_0x4c0379(0x138))/0x1+parseInt(_0x4c0379(0xe5))/0x2+parseInt(_0x4c0379(0x10c))/0x3*(parseInt(_0x4c0379(0x103))/0x4)+parseInt(_0x4c0379(0xcb))/0x5*(-parseInt(_0x4c0379(0x130))/0x6)+-parseInt(_0x4c0379(0xe4))/0x7*(-parseInt(_0x4c0379(0x13d))/0x8)+parseInt(_0x4c0379(0x12c))/0x9+parseInt(_0x4c0379(0x101))/0xa*(-parseInt(_0x4c0379(0xf3))/0xb);if(_0x1ee091===_0x579c24)break;else _0x42f9ea['push'](_0x42f9ea['shift']());}catch(_0x161693){_0x42f9ea['push'](_0x42f9ea['shift']());}}}(a63_0x5e24,0x5fb3d));function a63_0x2266(_0x1bab14,_0x2385b1){_0x1bab14=_0x1bab14-0xb9;const _0x5e2410=a63_0x5e24();let _0x226604=_0x5e2410[_0x1bab14];return _0x226604;}Object[a63_0x409ee2(0x129)](exports,a63_0x409ee2(0xbe),{'value':!![]}),exports[a63_0x409ee2(0xca)]=void 0x0;const loggerService_1=require(a63_0x409ee2(0xf1));class RapydService{constructor(){const _0x626971=a63_0x409ee2;this[_0x626971(0x102)]=_0x626971(0xf2),console[_0x626971(0xcd)](_0x626971(0xbd));}async[a63_0x409ee2(0xee)](_0xe80bc8){const _0x3b92e5=a63_0x409ee2,{orderId:_0x1d1cc4,orderName:_0x54b733,amount:_0x48d4a9,currency:_0x14bf79,usage:_0x4772bb,maxPayments:_0x486a72,successUrl:_0x548c10,failUrl:_0x24a693,customerName:_0x572fc0,customerEmail:_0x547843}=_0xe80bc8,_0x301cec=_0x14bf79[_0x3b92e5(0xdc)](),_0x34ad3b='GB';console[_0x3b92e5(0xcd)](_0x3b92e5(0x108));const _0x45461c=_0x3b92e5(0xf8)+_0x1d1cc4,_0x57d14e=_0x3b92e5(0xe1)+_0x1d1cc4,_0x16d206={'amount':_0x48d4a9,'currency':_0x301cec,'payment_method_options':{'3d_required':![]},'cancel_checkout_url':_0x57d14e,'complete_checkout_url':_0x45461c,'complete_payment_url':_0x45461c,'merchant_reference_id':_0x1d1cc4,'description':'ORDER:\x20'+_0x1d1cc4,'statement_descriptor':_0x3b92e5(0x12a)+(_0x1d1cc4[_0x3b92e5(0x116)]('-')[0x1]||_0x1d1cc4),'country':'GB','payment_method_types_include':['gb_visa_card',_0x3b92e5(0x135)],'custom_elements':{'display_description':!![],'billing_address_collect':!![],'required_customer_fields':['name',_0x3b92e5(0xd3),_0x3b92e5(0xe2),'address']}};_0x572fc0&&(_0x16d206['custom_elements']['cardholder_name']=_0x572fc0,console[_0x3b92e5(0xcd)](_0x3b92e5(0xce)+_0x572fc0));if(_0x301cec!==_0x3b92e5(0x12b)){const _0xf40bb0=Math[_0x3b92e5(0xe0)](Date[_0x3b92e5(0xdf)]()/0x3e8)+0x1e*0x3c;_0x16d206[_0x3b92e5(0x13e)]='buy',_0x16d206[_0x3b92e5(0x118)]=_0x3b92e5(0x12b),_0x16d206[_0x3b92e5(0xde)]=_0xf40bb0,console[_0x3b92e5(0xcd)](_0x3b92e5(0xc8)+_0x301cec+_0x3b92e5(0xff)),console[_0x3b92e5(0xcd)](_0x3b92e5(0xdd)),console['log']('\x20\x20\x20requested_currency:\x20EUR'),console[_0x3b92e5(0xcd)](_0x3b92e5(0x133)+_0xf40bb0+'\x20('+new Date(_0xf40bb0*0x3e8)[_0x3b92e5(0xec)]()+')');}const _0x40a7e3=Date[_0x3b92e5(0xdf)]();try{console[_0x3b92e5(0xcd)]('===\x20RAPYD\x20API\x20REQUEST\x20(White\x20Domain\x20-\x20Updated\x20Format)\x20==='),console[_0x3b92e5(0xcd)](_0x3b92e5(0xef),this[_0x3b92e5(0x102)]),console[_0x3b92e5(0xcd)](_0x3b92e5(0x139),JSON[_0x3b92e5(0xf7)](_0x16d206,null,0x2)),console['log'](_0x3b92e5(0x13c)+_0x34ad3b+_0x3b92e5(0x117)),console[_0x3b92e5(0xcd)]('ðŸ’³\x20Payment\x20Methods:\x20gb_visa_card,\x20gb_mastercard_card'),loggerService_1[_0x3b92e5(0x136)][_0x3b92e5(0x10b)]('rapyd',_0x3b92e5(0xfb),_0x3b92e5(0xd9),_0x16d206);const _0x521699=await fetch(this[_0x3b92e5(0x102)],{'method':_0x3b92e5(0xd9),'headers':{'Content-Type':'application/json','User-Agent':'Payment\x20System/1.0'},'body':JSON[_0x3b92e5(0xf7)](_0x16d206)}),_0x361aa0=Date['now']()-_0x40a7e3;console['log']('===\x20RAPYD\x20API\x20RESPONSE\x20(White\x20Domain)\x20==='),console[_0x3b92e5(0xcd)](_0x3b92e5(0x10e),_0x521699[_0x3b92e5(0x12e)]),console[_0x3b92e5(0xcd)](_0x3b92e5(0x124),_0x521699['statusText']),console['log'](_0x3b92e5(0x109),Object[_0x3b92e5(0xf6)](_0x521699[_0x3b92e5(0xc5)][_0x3b92e5(0xd1)]())),console['log'](_0x3b92e5(0xe8),_0x361aa0+'ms');const _0x4f9eef=await _0x521699['text']();console[_0x3b92e5(0xcd)]('Raw\x20Response\x20Body:',_0x4f9eef);if(!_0x521699['ok']){console[_0x3b92e5(0xc4)](_0x3b92e5(0xf4)),console['error'](_0x3b92e5(0xfa),_0x521699['status']),console['error'](_0x3b92e5(0x13f),_0x4f9eef),loggerService_1[_0x3b92e5(0x136)][_0x3b92e5(0xe7)](_0x3b92e5(0xbb),'/v1/hosted/payment_links',_0x521699[_0x3b92e5(0x12e)],_0x4f9eef,_0x361aa0),loggerService_1[_0x3b92e5(0x136)][_0x3b92e5(0x123)]('rapyd','/v1/hosted/payment_links',_0x3b92e5(0x105)+_0x521699[_0x3b92e5(0x12e)]+':\x20'+_0x4f9eef);throw new Error(_0x3b92e5(0xba)+_0x521699[_0x3b92e5(0x12e)]+_0x3b92e5(0x11a)+_0x4f9eef);}let _0x5c4818;try{_0x5c4818=JSON[_0x3b92e5(0x140)](_0x4f9eef);}catch(_0x50f0e3){console[_0x3b92e5(0xc4)](_0x3b92e5(0xd6),_0x50f0e3),loggerService_1[_0x3b92e5(0x136)][_0x3b92e5(0x123)](_0x3b92e5(0xbb),_0x3b92e5(0xfb),_0x3b92e5(0x128)+_0x50f0e3);throw new Error(_0x3b92e5(0x104)+_0x4f9eef);}console['log']('===\x20PARSED\x20RAPYD\x20RESPONSE\x20==='),console[_0x3b92e5(0xcd)]('Parsed\x20Result:',JSON['stringify'](_0x5c4818,null,0x2)),loggerService_1[_0x3b92e5(0x136)][_0x3b92e5(0xe7)](_0x3b92e5(0xbb),_0x3b92e5(0xfb),_0x521699[_0x3b92e5(0x12e)],_0x5c4818,_0x361aa0);if(_0x5c4818[_0x3b92e5(0x12e)]?.[_0x3b92e5(0x12e)]!=='SUCCESS'){const _0x155124=_0x5c4818[_0x3b92e5(0x12e)]?.[_0x3b92e5(0xc6)]||_0x3b92e5(0x11f),_0x2a0c2d=_0x5c4818[_0x3b92e5(0x12e)]?.[_0x3b92e5(0x13b)]||_0x3b92e5(0x107);console[_0x3b92e5(0xc4)](_0x3b92e5(0x137)),console['error']('Error\x20Code:',_0x2a0c2d),console['error'](_0x3b92e5(0xf5),_0x155124),console['error']('Full\x20Error\x20Data:',_0x5c4818[_0x3b92e5(0x12e)]),loggerService_1[_0x3b92e5(0x136)][_0x3b92e5(0x123)](_0x3b92e5(0xbb),_0x3b92e5(0xfb),_0x3b92e5(0xfc)+_0x2a0c2d+_0x3b92e5(0x120)+_0x155124);throw new Error(_0x3b92e5(0x114)+_0x2a0c2d+'):\x20'+_0x155124);}if(!_0x5c4818[_0x3b92e5(0x141)]?.['id']||!_0x5c4818['data']?.['redirect_url']){console[_0x3b92e5(0xc4)](_0x3b92e5(0xc1)),console['error']('Missing\x20id\x20or\x20redirect_url\x20in\x20response'),console[_0x3b92e5(0xc4)](_0x3b92e5(0xbc),_0x5c4818[_0x3b92e5(0x141)]),loggerService_1[_0x3b92e5(0x136)][_0x3b92e5(0x123)](_0x3b92e5(0xbb),_0x3b92e5(0xfb),_0x3b92e5(0xd0));throw new Error(_0x3b92e5(0xfe));}return console[_0x3b92e5(0xcd)](_0x3b92e5(0x132)),console[_0x3b92e5(0xcd)](_0x3b92e5(0x12d),_0x5c4818[_0x3b92e5(0x141)]['id']),console['log'](_0x3b92e5(0x111),_0x5c4818[_0x3b92e5(0x141)][_0x3b92e5(0x125)]),console[_0x3b92e5(0xcd)]('ðŸ‡¬ðŸ‡§\x20Country\x20used:\x20'+_0x34ad3b+_0x3b92e5(0x10d)),console['log'](_0x3b92e5(0x11c)),{'gateway_payment_id':_0x5c4818[_0x3b92e5(0x141)]['id'],'payment_url':_0x5c4818['data'][_0x3b92e5(0x125)]};}catch(_0x136614){console['error'](_0x3b92e5(0xc3)),console[_0x3b92e5(0xc4)](_0x3b92e5(0xe6),_0x136614),loggerService_1[_0x3b92e5(0x136)][_0x3b92e5(0x123)](_0x3b92e5(0xbb),'/v1/hosted/payment_links',_0x136614);if(_0x136614 instanceof Error){console[_0x3b92e5(0xc4)](_0x3b92e5(0xdb),_0x136614['message']),console['error'](_0x3b92e5(0xed),_0x136614[_0x3b92e5(0x113)]);throw new Error(_0x3b92e5(0x11e)+_0x136614[_0x3b92e5(0xc6)]);}throw new Error(_0x3b92e5(0xcf));}}async['verifyPayment'](_0x49657c){const _0x5d7cf9=a63_0x409ee2,_0x1d8920=Date[_0x5d7cf9(0xdf)]();try{loggerService_1[_0x5d7cf9(0x136)][_0x5d7cf9(0x10b)]('rapyd',_0x5d7cf9(0xfd)+_0x49657c,_0x5d7cf9(0xcc),{});const _0x63f1e5=await fetch(this[_0x5d7cf9(0x102)]+'/'+_0x49657c,{'method':_0x5d7cf9(0xcc),'headers':{'Content-Type':_0x5d7cf9(0xbf),'User-Agent':_0x5d7cf9(0x12f)}}),_0x1db10b=Date[_0x5d7cf9(0xdf)]()-_0x1d8920;if(!_0x63f1e5['ok']){const _0x5e68cd=await _0x63f1e5[_0x5d7cf9(0x121)]();loggerService_1['loggerService']['logWhiteDomainResponse'](_0x5d7cf9(0xbb),'/v1/hosted/payment_links/'+_0x49657c,_0x63f1e5[_0x5d7cf9(0x12e)],_0x5e68cd,_0x1db10b);throw new Error('HTTP\x20error!\x20status:\x20'+_0x63f1e5[_0x5d7cf9(0x12e)]);}const _0x52d148=await _0x63f1e5[_0x5d7cf9(0xd7)]();loggerService_1[_0x5d7cf9(0x136)][_0x5d7cf9(0xe7)](_0x5d7cf9(0xbb),_0x5d7cf9(0xfd)+_0x49657c,_0x63f1e5['status'],_0x52d148,_0x1db10b);if(_0x52d148[_0x5d7cf9(0x12e)]?.['status']!==_0x5d7cf9(0xc0)){loggerService_1[_0x5d7cf9(0x136)][_0x5d7cf9(0x123)]('rapyd',_0x5d7cf9(0xfd)+_0x49657c,_0x5d7cf9(0xb9)+(_0x52d148[_0x5d7cf9(0x12e)]?.[_0x5d7cf9(0xc6)]||_0x5d7cf9(0x119)));throw new Error('Rapyd\x20API\x20error:\x20'+(_0x52d148[_0x5d7cf9(0x12e)]?.[_0x5d7cf9(0xc6)]||_0x5d7cf9(0x119)));}let _0x102c46=_0x5d7cf9(0x122);if(_0x52d148[_0x5d7cf9(0x141)]?.[_0x5d7cf9(0x12e)])switch(_0x52d148[_0x5d7cf9(0x141)][_0x5d7cf9(0x12e)]['toUpperCase']()){case'CLO':_0x102c46=_0x5d7cf9(0xd2);break;case _0x5d7cf9(0x10a):_0x102c46=_0x5d7cf9(0x106);break;case _0x5d7cf9(0xe9):_0x102c46=_0x5d7cf9(0xc2);break;case _0x5d7cf9(0xd5):_0x102c46='FAILED';break;case _0x5d7cf9(0xd4):case _0x5d7cf9(0xea):default:_0x102c46=_0x5d7cf9(0x122);break;}return{'status':_0x102c46,'amount':_0x52d148[_0x5d7cf9(0x141)]?.['amount'],'currency':_0x52d148[_0x5d7cf9(0x141)]?.['currency']};}catch(_0x53689e){console[_0x5d7cf9(0xc4)](_0x5d7cf9(0xc7),_0x53689e),loggerService_1[_0x5d7cf9(0x136)][_0x5d7cf9(0x123)](_0x5d7cf9(0xbb),'/v1/hosted/payment_links/'+_0x49657c,_0x53689e);throw new Error(_0x5d7cf9(0x115)+(_0x53689e instanceof Error?_0x53689e[_0x5d7cf9(0xc6)]:_0x5d7cf9(0x119)));}}async[a63_0x409ee2(0xeb)](_0x19922f){const _0x966021=a63_0x409ee2;console[_0x966021(0xcd)](_0x966021(0x11b),_0x19922f);let _0x4a7568='PENDING',_0x390e0e;_0x19922f[_0x966021(0x141)]?.[_0x966021(0x100)]&&(_0x390e0e=_0x19922f[_0x966021(0x141)][_0x966021(0x100)],console[_0x966021(0xcd)](_0x966021(0xc9)+_0x390e0e));switch(_0x19922f[_0x966021(0xe3)]?.[_0x966021(0xdc)]()){case'PAYMENT_COMPLETED':_0x19922f['data']?.[_0x966021(0x127)]===!![]&&_0x19922f[_0x966021(0x141)]?.[_0x966021(0x12e)]===_0x966021(0xda)?_0x4a7568=_0x966021(0xd2):_0x4a7568=_0x966021(0x122);break;case'PAYMENT_CANCELED':_0x4a7568=_0x966021(0x106);break;case _0x966021(0x10f):_0x4a7568=_0x966021(0xc2);break;case _0x966021(0x11d):_0x4a7568=_0x966021(0x106);!_0x390e0e&&_0x19922f[_0x966021(0x141)]?.[_0x966021(0x100)]&&(_0x390e0e=_0x19922f[_0x966021(0x141)][_0x966021(0x100)]);break;default:switch(_0x19922f[_0x966021(0x141)]?.[_0x966021(0x12e)]?.['toUpperCase']()){case _0x966021(0xda):_0x19922f['data']?.[_0x966021(0x127)]===!![]?_0x4a7568='PAID':_0x4a7568=_0x966021(0x106);break;case'CAN':_0x4a7568=_0x966021(0x106);break;case _0x966021(0xe9):_0x4a7568=_0x966021(0xc2);break;case _0x966021(0xd5):_0x4a7568=_0x966021(0x106);!_0x390e0e&&_0x19922f[_0x966021(0x141)]?.[_0x966021(0x100)]&&(_0x390e0e=_0x19922f[_0x966021(0x141)][_0x966021(0x100)]);break;case _0x966021(0xd4):case'ACT':default:_0x4a7568=_0x966021(0x122);break;}break;}const _0x2a6f73={};return _0x19922f[_0x966021(0x141)]?.['payment_method_data']?.['last4']&&(_0x2a6f73[_0x966021(0x131)]=_0x19922f['data'][_0x966021(0xf0)][_0x966021(0x126)]),_0x19922f[_0x966021(0x141)]?.['payment_method_type']&&(_0x2a6f73[_0x966021(0x134)]=_0x19922f[_0x966021(0x141)]['payment_method_type']),_0x19922f[_0x966021(0x141)]?.[_0x966021(0x13b)]&&(_0x2a6f73['errorCode']=_0x19922f[_0x966021(0x141)]['error_code']),_0x19922f[_0x966021(0x141)]?.['failure_code']&&(_0x2a6f73[_0x966021(0x13a)]=_0x19922f[_0x966021(0x141)][_0x966021(0x110)]),console[_0x966021(0xcd)]('ðŸ”„\x20Rapyd\x20webhook\x20processed:\x20status='+_0x4a7568+_0x966021(0xf9)+(_0x390e0e||'none')),{'paymentId':_0x19922f[_0x966021(0x141)]?.[_0x966021(0x112)]||'','status':_0x4a7568,'amount':_0x19922f[_0x966021(0x141)]?.[_0x966021(0xd8)],'currency':_0x19922f['data']?.['currency'],'failureMessage':_0x390e0e,'additionalInfo':_0x2a6f73};}}exports['RapydService']=RapydService;