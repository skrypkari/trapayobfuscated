'use strict';const a46_0x13ab6e=a46_0x6492;(function(_0xb50bcb,_0x9ad885){const _0x5f14fe=a46_0x6492,_0x5fce02=_0xb50bcb();while(!![]){try{const _0x85964e=parseInt(_0x5f14fe(0x1b0))/0x1+-parseInt(_0x5f14fe(0x175))/0x2*(-parseInt(_0x5f14fe(0x1a4))/0x3)+-parseInt(_0x5f14fe(0x196))/0x4*(-parseInt(_0x5f14fe(0x194))/0x5)+-parseInt(_0x5f14fe(0x168))/0x6*(-parseInt(_0x5f14fe(0x177))/0x7)+-parseInt(_0x5f14fe(0x1b5))/0x8+-parseInt(_0x5f14fe(0x1b6))/0x9+parseInt(_0x5f14fe(0x14e))/0xa*(-parseInt(_0x5f14fe(0x1ab))/0xb);if(_0x85964e===_0x9ad885)break;else _0x5fce02['push'](_0x5fce02['shift']());}catch(_0x536753){_0x5fce02['push'](_0x5fce02['shift']());}}}(a46_0x3e5b,0xadcba));function a46_0x6492(_0x47e2de,_0xc4bbdb){const _0x3e5bfd=a46_0x3e5b();return a46_0x6492=function(_0x64926d,_0x1a4a99){_0x64926d=_0x64926d-0x148;let _0x57b174=_0x3e5bfd[_0x64926d];return _0x57b174;},a46_0x6492(_0x47e2de,_0xc4bbdb);}Object['defineProperty'](exports,a46_0x13ab6e(0x159),{'value':!![]}),exports[a46_0x13ab6e(0x15d)]=void 0x0;const loggerService_1=require('../loggerService');function a46_0x3e5b(){const _0x4601a1=['Response\x20data:','Parsed\x20Result:','payment_method_type','errorCode','GET','failure_message','ACT','Incomplete\x20response:\x20missing\x20id\x20or\x20redirect_url','1266605fhTOwf','stringify','20vtrwuL','Rapyd\x20API\x20error\x20(','FAILED','type','Response\x20Time:','loggerService','SUCCESS','\x20(always\x20GB\x20for\x20Rapyd)','last4','apiUrl','verifyPayment','Error\x20details:','Failed\x20to\x20verify\x20Rapyd\x20payment:\x20','paid','3540297hLZPVT','HTTP\x20','redirect_url','logWhiteDomainError','EXPIRED','message','EXP','30082811AHYXvt','data','rapyd','Rapyd\x20API\x20error:\x20','PAYMENT_CANCELED','915791CVFFih','fromEntries','Payment\x20Link\x20ID:','/v1/hosted/payment_links/','Business\x20Error\x20(','2571656zzioqj','701208TZFrJb','text','logWhiteDomainRequest','log','Status:','entries','Error\x20message:','Failed\x20to\x20parse\x20JSON\x20response:','PAID','Unknown\x20error\x20from\x20Rapyd\x20API','https://tesoft.uk/gateway/success.php?id=','NEW','headers','processWebhook',',\x20failureMessage=','\x20(GB\x20-\x20Britain)','PAYMENT_EXPIRED','now','Request\x20Body\x20(Updated\x20Format):','statusText','Missing\x20id\x20or\x20redirect_url\x20in\x20response','10MwuEWM','Processing\x20Rapyd\x20webhook:','üí≥\x20Payment\x20Methods:\x20gb_visa_card,\x20gb_mastercard_card','status','PAYMENT_FAILED','/v1/hosted/payment_links','PENDING','):\x20','JSON\x20Parse\x20Error:\x20','currency','üá¨üáß\x20Country\x20used:\x20','__esModule','gb_mastercard_card','Unknown\x20error','Error\x20Message:','RapydService','===\x20RAPYD\x20SUCCESS\x20===','failure_code','application/json','Redirect\x20URL:','üí•\x20Rapyd\x20failure\x20message:\x20','Error\x20stack:','POST','gb_visa_card','===\x20RAPYD\x20API\x20INCOMPLETE\x20RESPONSE\x20===','error','2901246WILarG','ERR','URL:','HTTP\x20Status:','createPaymentLink','toUpperCase','üá¨üáß\x20Country:\x20','===\x20RAPYD\x20API\x20REQUEST\x20(White\x20Domain\x20-\x20Updated\x20Format)\x20===','merchant_reference_id','===\x20RAPYD\x20API\x20ERROR\x20===','TesSoft\x20Payment\x20System/1.0','paymentMethod','failureCode','2NgJGiv','CAN','7FGQRyL','cardLast4','Failed\x20to\x20create\x20Rapyd\x20payment\x20link:\x20Unknown\x20error','error_code','none','HTTP\x20error!\x20status:\x20','json','===\x20RAPYD\x20API\x20RESPONSE\x20(White\x20Domain)\x20===','CLO','Response\x20Body:','Invalid\x20response\x20from\x20Rapyd\x20API:\x20missing\x20id\x20or\x20redirect_url','===\x20RAPYD\x20SERVICE\x20ERROR\x20===','Rapyd\x20payment\x20verification\x20error:','ORDER:\x20','Raw\x20Response\x20Body:','Headers:','logWhiteDomainResponse','amount','üîÑ\x20Rapyd\x20webhook\x20processed:\x20status=','Invalid\x20JSON\x20response\x20from\x20Rapyd\x20API:\x20','Failed\x20to\x20create\x20Rapyd\x20payment\x20link:\x20'];a46_0x3e5b=function(){return _0x4601a1;};return a46_0x3e5b();}class RapydService{constructor(){const _0x48a086=a46_0x13ab6e;this[_0x48a086(0x19f)]='https://tesoft.uk/gateway/rapyd/',console['log']('üåê\x20Rapyd\x20service\x20initialized\x20with\x20white\x20domain\x20proxy');}async[a46_0x13ab6e(0x16c)](_0x497709){const _0x540dc5=a46_0x13ab6e,{orderId:_0x1dafbb,orderName:_0x2a747c,amount:_0x4ba54c,currency:_0x3a64af,usage:_0x31a889,maxPayments:_0x59985c,successUrl:_0x1194d3,failUrl:_0x54c163}=_0x497709,_0x39d031=_0x3a64af['toUpperCase'](),_0x136886='GB';console[_0x540dc5(0x1b9)]('üá¨üáß\x20Using\x20GB\x20(Britain)\x20as\x20country\x20for\x20Rapyd\x20payment\x20link');const _0x595180=_0x540dc5(0x1c0)+_0x1dafbb,_0x38aea8='https://tesoft.uk/gateway/fail.php?id='+_0x1dafbb,_0x44c4a9={'amount':_0x4ba54c,'currency':_0x39d031,'cancel_checkout_url':_0x38aea8,'complete_checkout_url':_0x595180,'complete_payment_url':_0x595180,'merchant_reference_id':_0x1dafbb,'description':_0x540dc5(0x184)+_0x1dafbb,'country':'GB','payment_method_types_include':[_0x540dc5(0x165),_0x540dc5(0x15a)],'custom_elements':{'display_description':!![]}},_0x247462=Date[_0x540dc5(0x14a)]();try{console[_0x540dc5(0x1b9)](_0x540dc5(0x16f)),console[_0x540dc5(0x1b9)](_0x540dc5(0x16a),this[_0x540dc5(0x19f)]),console['log'](_0x540dc5(0x14b),JSON[_0x540dc5(0x195)](_0x44c4a9,null,0x2)),console['log'](_0x540dc5(0x16e)+_0x136886+_0x540dc5(0x19d)),console[_0x540dc5(0x1b9)](_0x540dc5(0x150)),loggerService_1['loggerService'][_0x540dc5(0x1b8)](_0x540dc5(0x1ad),_0x540dc5(0x153),_0x540dc5(0x164),_0x44c4a9);const _0x26422e=await fetch(this['apiUrl'],{'method':_0x540dc5(0x164),'headers':{'Content-Type':_0x540dc5(0x160),'User-Agent':_0x540dc5(0x172)},'body':JSON[_0x540dc5(0x195)](_0x44c4a9)}),_0x150ebf=Date['now']()-_0x247462;console[_0x540dc5(0x1b9)](_0x540dc5(0x17e)),console['log'](_0x540dc5(0x1ba),_0x26422e['status']),console[_0x540dc5(0x1b9)]('Status\x20Text:',_0x26422e[_0x540dc5(0x14c)]),console[_0x540dc5(0x1b9)](_0x540dc5(0x186),Object[_0x540dc5(0x1b1)](_0x26422e[_0x540dc5(0x1c2)][_0x540dc5(0x1bb)]())),console['log'](_0x540dc5(0x19a),_0x150ebf+'ms');const _0x3916bf=await _0x26422e[_0x540dc5(0x1b7)]();console[_0x540dc5(0x1b9)](_0x540dc5(0x185),_0x3916bf);if(!_0x26422e['ok']){console[_0x540dc5(0x167)](_0x540dc5(0x171)),console[_0x540dc5(0x167)](_0x540dc5(0x16b),_0x26422e[_0x540dc5(0x151)]),console[_0x540dc5(0x167)](_0x540dc5(0x180),_0x3916bf),loggerService_1[_0x540dc5(0x19b)][_0x540dc5(0x187)]('rapyd',_0x540dc5(0x153),_0x26422e[_0x540dc5(0x151)],_0x3916bf,_0x150ebf),loggerService_1[_0x540dc5(0x19b)][_0x540dc5(0x1a7)](_0x540dc5(0x1ad),'/v1/hosted/payment_links',_0x540dc5(0x1a5)+_0x26422e[_0x540dc5(0x151)]+':\x20'+_0x3916bf);throw new Error(_0x540dc5(0x17c)+_0x26422e[_0x540dc5(0x151)]+',\x20body:\x20'+_0x3916bf);}let _0xc8683e;try{_0xc8683e=JSON['parse'](_0x3916bf);}catch(_0x13be94){console['error'](_0x540dc5(0x1bd),_0x13be94),loggerService_1[_0x540dc5(0x19b)][_0x540dc5(0x1a7)](_0x540dc5(0x1ad),_0x540dc5(0x153),_0x540dc5(0x156)+_0x13be94);throw new Error(_0x540dc5(0x18a)+_0x3916bf);}console[_0x540dc5(0x1b9)]('===\x20PARSED\x20RAPYD\x20RESPONSE\x20==='),console[_0x540dc5(0x1b9)](_0x540dc5(0x18d),JSON[_0x540dc5(0x195)](_0xc8683e,null,0x2)),loggerService_1['loggerService'][_0x540dc5(0x187)]('rapyd',_0x540dc5(0x153),_0x26422e['status'],_0xc8683e,_0x150ebf);if(_0xc8683e['status']?.['status']!==_0x540dc5(0x19c)){const _0x420ff9=_0xc8683e[_0x540dc5(0x151)]?.[_0x540dc5(0x1a9)]||_0x540dc5(0x1bf),_0x5cd973=_0xc8683e[_0x540dc5(0x151)]?.[_0x540dc5(0x17a)]||'UNKNOWN';console[_0x540dc5(0x167)]('===\x20RAPYD\x20API\x20BUSINESS\x20ERROR\x20==='),console['error']('Error\x20Code:',_0x5cd973),console[_0x540dc5(0x167)](_0x540dc5(0x15c),_0x420ff9),console['error']('Full\x20Error\x20Data:',_0xc8683e[_0x540dc5(0x151)]),loggerService_1[_0x540dc5(0x19b)][_0x540dc5(0x1a7)](_0x540dc5(0x1ad),'/v1/hosted/payment_links',_0x540dc5(0x1b4)+_0x5cd973+'):\x20'+_0x420ff9);throw new Error(_0x540dc5(0x197)+_0x5cd973+_0x540dc5(0x155)+_0x420ff9);}if(!_0xc8683e['data']?.['id']||!_0xc8683e[_0x540dc5(0x1ac)]?.['redirect_url']){console['error'](_0x540dc5(0x166)),console['error'](_0x540dc5(0x14d)),console['error'](_0x540dc5(0x18c),_0xc8683e[_0x540dc5(0x1ac)]),loggerService_1[_0x540dc5(0x19b)]['logWhiteDomainError'](_0x540dc5(0x1ad),'/v1/hosted/payment_links',_0x540dc5(0x193));throw new Error(_0x540dc5(0x181));}return console['log'](_0x540dc5(0x15e)),console[_0x540dc5(0x1b9)](_0x540dc5(0x1b2),_0xc8683e[_0x540dc5(0x1ac)]['id']),console[_0x540dc5(0x1b9)](_0x540dc5(0x161),_0xc8683e[_0x540dc5(0x1ac)][_0x540dc5(0x1a6)]),console[_0x540dc5(0x1b9)](_0x540dc5(0x158)+_0x136886+_0x540dc5(0x148)),console[_0x540dc5(0x1b9)](_0x540dc5(0x150)),{'gateway_payment_id':_0xc8683e['data']['id'],'payment_url':_0xc8683e[_0x540dc5(0x1ac)][_0x540dc5(0x1a6)]};}catch(_0x5cacd2){console[_0x540dc5(0x167)](_0x540dc5(0x182)),console[_0x540dc5(0x167)](_0x540dc5(0x1a1),_0x5cacd2),loggerService_1[_0x540dc5(0x19b)][_0x540dc5(0x1a7)](_0x540dc5(0x1ad),_0x540dc5(0x153),_0x5cacd2);if(_0x5cacd2 instanceof Error){console['error'](_0x540dc5(0x1bc),_0x5cacd2[_0x540dc5(0x1a9)]),console[_0x540dc5(0x167)](_0x540dc5(0x163),_0x5cacd2['stack']);throw new Error(_0x540dc5(0x18b)+_0x5cacd2['message']);}throw new Error(_0x540dc5(0x179));}}async[a46_0x13ab6e(0x1a0)](_0x9dbd31){const _0x599c3b=a46_0x13ab6e,_0x4522c2=Date[_0x599c3b(0x14a)]();try{loggerService_1[_0x599c3b(0x19b)][_0x599c3b(0x1b8)](_0x599c3b(0x1ad),'/v1/hosted/payment_links/'+_0x9dbd31,_0x599c3b(0x190),{});const _0x40a98c=await fetch(this['apiUrl']+'/'+_0x9dbd31,{'method':_0x599c3b(0x190),'headers':{'Content-Type':_0x599c3b(0x160),'User-Agent':_0x599c3b(0x172)}}),_0x3180ac=Date['now']()-_0x4522c2;if(!_0x40a98c['ok']){const _0xaed70b=await _0x40a98c[_0x599c3b(0x1b7)]();loggerService_1[_0x599c3b(0x19b)][_0x599c3b(0x187)](_0x599c3b(0x1ad),_0x599c3b(0x1b3)+_0x9dbd31,_0x40a98c['status'],_0xaed70b,_0x3180ac);throw new Error(_0x599c3b(0x17c)+_0x40a98c[_0x599c3b(0x151)]);}const _0x56b47b=await _0x40a98c[_0x599c3b(0x17d)]();loggerService_1[_0x599c3b(0x19b)][_0x599c3b(0x187)](_0x599c3b(0x1ad),'/v1/hosted/payment_links/'+_0x9dbd31,_0x40a98c[_0x599c3b(0x151)],_0x56b47b,_0x3180ac);if(_0x56b47b[_0x599c3b(0x151)]?.[_0x599c3b(0x151)]!==_0x599c3b(0x19c)){loggerService_1['loggerService']['logWhiteDomainError'](_0x599c3b(0x1ad),_0x599c3b(0x1b3)+_0x9dbd31,_0x599c3b(0x1ae)+(_0x56b47b[_0x599c3b(0x151)]?.[_0x599c3b(0x1a9)]||_0x599c3b(0x15b)));throw new Error('Rapyd\x20API\x20error:\x20'+(_0x56b47b[_0x599c3b(0x151)]?.[_0x599c3b(0x1a9)]||'Unknown\x20error'));}let _0x121b3c=_0x599c3b(0x154);if(_0x56b47b['data']?.[_0x599c3b(0x151)])switch(_0x56b47b[_0x599c3b(0x1ac)][_0x599c3b(0x151)][_0x599c3b(0x16d)]()){case _0x599c3b(0x17f):_0x121b3c=_0x599c3b(0x1be);break;case _0x599c3b(0x176):_0x121b3c='FAILED';break;case _0x599c3b(0x1aa):_0x121b3c=_0x599c3b(0x1a8);break;case'ERR':_0x121b3c=_0x599c3b(0x198);break;case'NEW':case _0x599c3b(0x192):default:_0x121b3c=_0x599c3b(0x154);break;}return{'status':_0x121b3c,'amount':_0x56b47b[_0x599c3b(0x1ac)]?.['amount'],'currency':_0x56b47b[_0x599c3b(0x1ac)]?.[_0x599c3b(0x157)]};}catch(_0xe7fc3f){console['error'](_0x599c3b(0x183),_0xe7fc3f),loggerService_1[_0x599c3b(0x19b)]['logWhiteDomainError'](_0x599c3b(0x1ad),_0x599c3b(0x1b3)+_0x9dbd31,_0xe7fc3f);throw new Error(_0x599c3b(0x1a2)+(_0xe7fc3f instanceof Error?_0xe7fc3f[_0x599c3b(0x1a9)]:_0x599c3b(0x15b)));}}async[a46_0x13ab6e(0x1c3)](_0xda5806){const _0x7d4c48=a46_0x13ab6e;console[_0x7d4c48(0x1b9)](_0x7d4c48(0x14f),_0xda5806);let _0x5ba496='PENDING',_0x424325;_0xda5806[_0x7d4c48(0x1ac)]?.[_0x7d4c48(0x191)]&&(_0x424325=_0xda5806['data']['failure_message'],console[_0x7d4c48(0x1b9)](_0x7d4c48(0x162)+_0x424325));switch(_0xda5806[_0x7d4c48(0x199)]?.['toUpperCase']()){case'PAYMENT_COMPLETED':_0xda5806[_0x7d4c48(0x1ac)]?.[_0x7d4c48(0x1a3)]===!![]&&_0xda5806[_0x7d4c48(0x1ac)]?.[_0x7d4c48(0x151)]===_0x7d4c48(0x17f)?_0x5ba496='PAID':_0x5ba496=_0x7d4c48(0x154);break;case _0x7d4c48(0x1af):_0x5ba496=_0x7d4c48(0x198);break;case _0x7d4c48(0x149):_0x5ba496=_0x7d4c48(0x1a8);break;case _0x7d4c48(0x152):_0x5ba496=_0x7d4c48(0x198);!_0x424325&&_0xda5806[_0x7d4c48(0x1ac)]?.[_0x7d4c48(0x191)]&&(_0x424325=_0xda5806[_0x7d4c48(0x1ac)][_0x7d4c48(0x191)]);break;default:switch(_0xda5806[_0x7d4c48(0x1ac)]?.['status']?.['toUpperCase']()){case _0x7d4c48(0x17f):_0xda5806['data']?.[_0x7d4c48(0x1a3)]===!![]?_0x5ba496='PAID':_0x5ba496=_0x7d4c48(0x198);break;case _0x7d4c48(0x176):_0x5ba496=_0x7d4c48(0x198);break;case _0x7d4c48(0x1aa):_0x5ba496=_0x7d4c48(0x1a8);break;case _0x7d4c48(0x169):_0x5ba496=_0x7d4c48(0x198);!_0x424325&&_0xda5806[_0x7d4c48(0x1ac)]?.['failure_message']&&(_0x424325=_0xda5806[_0x7d4c48(0x1ac)][_0x7d4c48(0x191)]);break;case _0x7d4c48(0x1c1):case _0x7d4c48(0x192):default:_0x5ba496=_0x7d4c48(0x154);break;}break;}const _0x39f613={};return _0xda5806['data']?.['payment_method_data']?.[_0x7d4c48(0x19e)]&&(_0x39f613[_0x7d4c48(0x178)]=_0xda5806[_0x7d4c48(0x1ac)]['payment_method_data'][_0x7d4c48(0x19e)]),_0xda5806['data']?.[_0x7d4c48(0x18e)]&&(_0x39f613[_0x7d4c48(0x173)]=_0xda5806[_0x7d4c48(0x1ac)][_0x7d4c48(0x18e)]),_0xda5806['data']?.['error_code']&&(_0x39f613[_0x7d4c48(0x18f)]=_0xda5806[_0x7d4c48(0x1ac)][_0x7d4c48(0x17a)]),_0xda5806[_0x7d4c48(0x1ac)]?.[_0x7d4c48(0x15f)]&&(_0x39f613[_0x7d4c48(0x174)]=_0xda5806[_0x7d4c48(0x1ac)]['failure_code']),console['log'](_0x7d4c48(0x189)+_0x5ba496+_0x7d4c48(0x1c4)+(_0x424325||_0x7d4c48(0x17b))),{'paymentId':_0xda5806[_0x7d4c48(0x1ac)]?.[_0x7d4c48(0x170)]||'','status':_0x5ba496,'amount':_0xda5806[_0x7d4c48(0x1ac)]?.[_0x7d4c48(0x188)],'currency':_0xda5806[_0x7d4c48(0x1ac)]?.[_0x7d4c48(0x157)],'failureMessage':_0x424325,'additionalInfo':_0x39f613};}}exports[a46_0x13ab6e(0x15d)]=RapydService;