'use strict';function a42_0x30cc(_0x15378c,_0x3c2604){const _0x5b1c02=a42_0x5b1c();return a42_0x30cc=function(_0x30cc70,_0x242a9d){_0x30cc70=_0x30cc70-0x178;let _0x96235d=_0x5b1c02[_0x30cc70];return _0x96235d;},a42_0x30cc(_0x15378c,_0x3c2604);}function a42_0x5b1c(){const _0x374a7a=['2506630mrzYon','EXP','Status\x20Text:','Unknown\x20error','üá¨üáß\x20Country\x20used:\x20','merchant_reference_id','HTTP\x20','6mwxJCt','logWhiteDomainResponse','Error\x20message:','logWhiteDomainRequest','1066710sNAkPK','üá¨üáß\x20Using\x20GB\x20(Britain)\x20as\x20country\x20for\x20Rapyd\x20payment\x20link','üí≥\x20Payment\x20Methods:\x20gb_visa_card,\x20gb_mastercard_card','2436756IVkimj','application/json','PENDING','Rapyd\x20API\x20error\x20(','defineProperty','entries','Failed\x20to\x20verify\x20Rapyd\x20payment:\x20','PAID','URL:','3gubwrU','PAYMENT_COMPLETED','Invalid\x20response\x20from\x20Rapyd\x20API:\x20missing\x20id\x20or\x20redirect_url','HTTP\x20error!\x20status:\x20','amount','Rapyd\x20API\x20error:\x20','createPaymentLink','POST','===\x20PARSED\x20RAPYD\x20RESPONSE\x20===','rapyd','Missing\x20id\x20or\x20redirect_url\x20in\x20response','SUCCESS','EXPIRED','toUpperCase','currency','Error\x20details:','fromEntries','CLO','JSON\x20Parse\x20Error:\x20','Business\x20Error\x20(','Unknown\x20error\x20from\x20Rapyd\x20API',',\x20body:\x20','gb_visa_card','processWebhook','/v1/hosted/payment_links','\x20(always\x20GB\x20for\x20Rapyd)','apiUrl','stringify','9CvRjEs','Status:','Payment\x20Link\x20ID:','):\x20','322336lhjDbK','/v1/hosted/payment_links/','statusText','164229GwcnCI','ORDER:\x20','Failed\x20to\x20create\x20Rapyd\x20payment\x20link:\x20','verifyPayment','now','===\x20RAPYD\x20API\x20BUSINESS\x20ERROR\x20===','üåê\x20Rapyd\x20service\x20initialized\x20with\x20white\x20domain\x20proxy','data','status','https://tesoft.uk/gateway/rapyd/','message','loggerService','Error\x20Message:','NEW','PAYMENT_CANCELED','PAYMENT_FAILED','text','ACT','log','logWhiteDomainError','error','stack','12509178wvEpeu','paid','https://tesoft.uk/gateway/success.php?id=','CAN','3994844DEYyro','ERR','redirect_url','===\x20RAPYD\x20API\x20INCOMPLETE\x20RESPONSE\x20===','Failed\x20to\x20create\x20Rapyd\x20payment\x20link:\x20Unknown\x20error','TesSoft\x20Payment\x20System/1.0','Invalid\x20JSON\x20response\x20from\x20Rapyd\x20API:\x20','5kuulal','===\x20RAPYD\x20SERVICE\x20ERROR\x20===','HTTP\x20Status:','===\x20RAPYD\x20SUCCESS\x20===','error_code','UNKNOWN','gb_mastercard_card','Response\x20Body:','\x20(GB\x20-\x20Britain)','GET','PAYMENT_EXPIRED','FAILED','RapydService','Headers:'];a42_0x5b1c=function(){return _0x374a7a;};return a42_0x5b1c();}const a42_0x29423a=a42_0x30cc;(function(_0x30ef84,_0x142785){const _0x58ac76=a42_0x30cc,_0x1c48a5=_0x30ef84();while(!![]){try{const _0x133be6=-parseInt(_0x58ac76(0x1cf))/0x1+parseInt(_0x58ac76(0x1a0))/0x2*(parseInt(_0x58ac76(0x1ac))/0x3)+parseInt(_0x58ac76(0x1a3))/0x4*(-parseInt(_0x58ac76(0x187))/0x5)+parseInt(_0x58ac76(0x19c))/0x6*(-parseInt(_0x58ac76(0x180))/0x7)+-parseInt(_0x58ac76(0x1cc))/0x8+parseInt(_0x58ac76(0x1c8))/0x9*(parseInt(_0x58ac76(0x195))/0xa)+parseInt(_0x58ac76(0x17c))/0xb;if(_0x133be6===_0x142785)break;else _0x1c48a5['push'](_0x1c48a5['shift']());}catch(_0x23f729){_0x1c48a5['push'](_0x1c48a5['shift']());}}}(a42_0x5b1c,0x830ee));Object[a42_0x29423a(0x1a7)](exports,'__esModule',{'value':!![]}),exports[a42_0x29423a(0x193)]=void 0x0;const loggerService_1=require('../loggerService');class RapydService{constructor(){const _0x27bb4f=a42_0x29423a;this[_0x27bb4f(0x1c6)]=_0x27bb4f(0x1d8),console[_0x27bb4f(0x178)](_0x27bb4f(0x1d5));}async[a42_0x29423a(0x1b2)](_0x28deeb){const _0x5b3650=a42_0x29423a,{orderId:_0x5460a5,orderName:_0x3cb722,amount:_0x1918c3,currency:_0x41e7b7,usage:_0x5bb992,maxPayments:_0x588704,successUrl:_0x198318,failUrl:_0x19c21e}=_0x28deeb,_0x73784a=_0x41e7b7[_0x5b3650(0x1b9)](),_0x2d10a3='GB';console[_0x5b3650(0x178)](_0x5b3650(0x1a1));const _0x45ef8a=_0x5b3650(0x17e)+_0x5460a5,_0x26f657='https://tesoft.uk/gateway/fail.php?id='+_0x5460a5,_0x1efe2a={'amount':_0x1918c3,'currency':_0x73784a,'cancel_checkout_url':_0x26f657,'complete_checkout_url':_0x45ef8a,'complete_payment_url':_0x45ef8a,'merchant_reference_id':_0x5460a5,'description':_0x5b3650(0x1d0)+_0x5460a5,'country':'GB','payment_method_types_include':[_0x5b3650(0x1c2),_0x5b3650(0x18d)],'custom_elements':{'display_description':!![]}},_0x4262f9=Date[_0x5b3650(0x1d3)]();try{console[_0x5b3650(0x178)]('===\x20RAPYD\x20API\x20REQUEST\x20(White\x20Domain\x20-\x20Updated\x20Format)\x20==='),console[_0x5b3650(0x178)](_0x5b3650(0x1ab),this[_0x5b3650(0x1c6)]),console[_0x5b3650(0x178)]('Request\x20Body\x20(Updated\x20Format):',JSON[_0x5b3650(0x1c7)](_0x1efe2a,null,0x2)),console[_0x5b3650(0x178)]('üá¨üáß\x20Country:\x20'+_0x2d10a3+_0x5b3650(0x1c5)),console['log'](_0x5b3650(0x1a2)),loggerService_1[_0x5b3650(0x1da)][_0x5b3650(0x19f)](_0x5b3650(0x1b5),_0x5b3650(0x1c4),_0x5b3650(0x1b3),_0x1efe2a);const _0x175c60=await fetch(this['apiUrl'],{'method':_0x5b3650(0x1b3),'headers':{'Content-Type':_0x5b3650(0x1a4),'User-Agent':_0x5b3650(0x185)},'body':JSON['stringify'](_0x1efe2a)}),_0x3dd23f=Date[_0x5b3650(0x1d3)]()-_0x4262f9;console['log']('===\x20RAPYD\x20API\x20RESPONSE\x20(White\x20Domain)\x20==='),console[_0x5b3650(0x178)](_0x5b3650(0x1c9),_0x175c60['status']),console[_0x5b3650(0x178)](_0x5b3650(0x197),_0x175c60[_0x5b3650(0x1ce)]),console['log'](_0x5b3650(0x194),Object[_0x5b3650(0x1bc)](_0x175c60['headers'][_0x5b3650(0x1a8)]())),console[_0x5b3650(0x178)]('Response\x20Time:',_0x3dd23f+'ms');const _0x90abe3=await _0x175c60['text']();console['log']('Raw\x20Response\x20Body:',_0x90abe3);if(!_0x175c60['ok']){console[_0x5b3650(0x17a)]('===\x20RAPYD\x20API\x20ERROR\x20==='),console[_0x5b3650(0x17a)](_0x5b3650(0x189),_0x175c60[_0x5b3650(0x1d7)]),console['error'](_0x5b3650(0x18e),_0x90abe3),loggerService_1[_0x5b3650(0x1da)][_0x5b3650(0x19d)](_0x5b3650(0x1b5),_0x5b3650(0x1c4),_0x175c60['status'],_0x90abe3,_0x3dd23f),loggerService_1[_0x5b3650(0x1da)]['logWhiteDomainError']('rapyd',_0x5b3650(0x1c4),_0x5b3650(0x19b)+_0x175c60[_0x5b3650(0x1d7)]+':\x20'+_0x90abe3);throw new Error('HTTP\x20error!\x20status:\x20'+_0x175c60[_0x5b3650(0x1d7)]+_0x5b3650(0x1c1)+_0x90abe3);}let _0x3dd1bf;try{_0x3dd1bf=JSON['parse'](_0x90abe3);}catch(_0x571b1a){console['error']('Failed\x20to\x20parse\x20JSON\x20response:',_0x571b1a),loggerService_1['loggerService'][_0x5b3650(0x179)](_0x5b3650(0x1b5),'/v1/hosted/payment_links',_0x5b3650(0x1be)+_0x571b1a);throw new Error(_0x5b3650(0x186)+_0x90abe3);}console[_0x5b3650(0x178)](_0x5b3650(0x1b4)),console[_0x5b3650(0x178)]('Parsed\x20Result:',JSON[_0x5b3650(0x1c7)](_0x3dd1bf,null,0x2)),loggerService_1[_0x5b3650(0x1da)][_0x5b3650(0x19d)]('rapyd',_0x5b3650(0x1c4),_0x175c60[_0x5b3650(0x1d7)],_0x3dd1bf,_0x3dd23f);if(_0x3dd1bf[_0x5b3650(0x1d7)]?.['status']!==_0x5b3650(0x1b7)){const _0x34fa09=_0x3dd1bf[_0x5b3650(0x1d7)]?.[_0x5b3650(0x1d9)]||_0x5b3650(0x1c0),_0x1ea35d=_0x3dd1bf[_0x5b3650(0x1d7)]?.[_0x5b3650(0x18b)]||_0x5b3650(0x18c);console[_0x5b3650(0x17a)](_0x5b3650(0x1d4)),console['error']('Error\x20Code:',_0x1ea35d),console[_0x5b3650(0x17a)](_0x5b3650(0x1db),_0x34fa09),console['error']('Full\x20Error\x20Data:',_0x3dd1bf[_0x5b3650(0x1d7)]),loggerService_1['loggerService'][_0x5b3650(0x179)](_0x5b3650(0x1b5),'/v1/hosted/payment_links',_0x5b3650(0x1bf)+_0x1ea35d+_0x5b3650(0x1cb)+_0x34fa09);throw new Error(_0x5b3650(0x1a6)+_0x1ea35d+_0x5b3650(0x1cb)+_0x34fa09);}if(!_0x3dd1bf['data']?.['id']||!_0x3dd1bf[_0x5b3650(0x1d6)]?.[_0x5b3650(0x182)]){console[_0x5b3650(0x17a)](_0x5b3650(0x183)),console[_0x5b3650(0x17a)](_0x5b3650(0x1b6)),console[_0x5b3650(0x17a)]('Response\x20data:',_0x3dd1bf[_0x5b3650(0x1d6)]),loggerService_1[_0x5b3650(0x1da)][_0x5b3650(0x179)](_0x5b3650(0x1b5),_0x5b3650(0x1c4),'Incomplete\x20response:\x20missing\x20id\x20or\x20redirect_url');throw new Error(_0x5b3650(0x1ae));}return console['log'](_0x5b3650(0x18a)),console['log'](_0x5b3650(0x1ca),_0x3dd1bf[_0x5b3650(0x1d6)]['id']),console[_0x5b3650(0x178)]('Redirect\x20URL:',_0x3dd1bf['data'][_0x5b3650(0x182)]),console[_0x5b3650(0x178)](_0x5b3650(0x199)+_0x2d10a3+_0x5b3650(0x18f)),console[_0x5b3650(0x178)](_0x5b3650(0x1a2)),{'gateway_payment_id':_0x3dd1bf['data']['id'],'payment_url':_0x3dd1bf[_0x5b3650(0x1d6)][_0x5b3650(0x182)]};}catch(_0x31a6b0){console[_0x5b3650(0x17a)](_0x5b3650(0x188)),console['error'](_0x5b3650(0x1bb),_0x31a6b0),loggerService_1[_0x5b3650(0x1da)]['logWhiteDomainError']('rapyd','/v1/hosted/payment_links',_0x31a6b0);if(_0x31a6b0 instanceof Error){console['error'](_0x5b3650(0x19e),_0x31a6b0[_0x5b3650(0x1d9)]),console[_0x5b3650(0x17a)]('Error\x20stack:',_0x31a6b0[_0x5b3650(0x17b)]);throw new Error(_0x5b3650(0x1d1)+_0x31a6b0[_0x5b3650(0x1d9)]);}throw new Error(_0x5b3650(0x184));}}async[a42_0x29423a(0x1d2)](_0x2a58a7){const _0x4006a6=a42_0x29423a,_0x45da68=Date['now']();try{loggerService_1['loggerService'][_0x4006a6(0x19f)](_0x4006a6(0x1b5),'/v1/hosted/payment_links/'+_0x2a58a7,_0x4006a6(0x190),{});const _0x14a73d=await fetch(this['apiUrl']+'/'+_0x2a58a7,{'method':_0x4006a6(0x190),'headers':{'Content-Type':'application/json','User-Agent':_0x4006a6(0x185)}}),_0x433f2a=Date['now']()-_0x45da68;if(!_0x14a73d['ok']){const _0x25db93=await _0x14a73d[_0x4006a6(0x1df)]();loggerService_1[_0x4006a6(0x1da)][_0x4006a6(0x19d)]('rapyd',_0x4006a6(0x1cd)+_0x2a58a7,_0x14a73d[_0x4006a6(0x1d7)],_0x25db93,_0x433f2a);throw new Error(_0x4006a6(0x1af)+_0x14a73d[_0x4006a6(0x1d7)]);}const _0x4aa663=await _0x14a73d['json']();loggerService_1[_0x4006a6(0x1da)]['logWhiteDomainResponse'](_0x4006a6(0x1b5),_0x4006a6(0x1cd)+_0x2a58a7,_0x14a73d[_0x4006a6(0x1d7)],_0x4aa663,_0x433f2a);if(_0x4aa663[_0x4006a6(0x1d7)]?.[_0x4006a6(0x1d7)]!==_0x4006a6(0x1b7)){loggerService_1[_0x4006a6(0x1da)][_0x4006a6(0x179)]('rapyd',_0x4006a6(0x1cd)+_0x2a58a7,_0x4006a6(0x1b1)+(_0x4aa663[_0x4006a6(0x1d7)]?.[_0x4006a6(0x1d9)]||'Unknown\x20error'));throw new Error(_0x4006a6(0x1b1)+(_0x4aa663[_0x4006a6(0x1d7)]?.['message']||_0x4006a6(0x198)));}let _0x1281a5=_0x4006a6(0x1a5);if(_0x4aa663[_0x4006a6(0x1d6)]?.[_0x4006a6(0x1d7)])switch(_0x4aa663[_0x4006a6(0x1d6)][_0x4006a6(0x1d7)][_0x4006a6(0x1b9)]()){case _0x4006a6(0x1bd):_0x1281a5='PAID';break;case _0x4006a6(0x17f):_0x1281a5=_0x4006a6(0x192);break;case _0x4006a6(0x196):_0x1281a5=_0x4006a6(0x1b8);break;case _0x4006a6(0x181):_0x1281a5=_0x4006a6(0x192);break;case'NEW':case _0x4006a6(0x1e0):default:_0x1281a5=_0x4006a6(0x1a5);break;}return{'status':_0x1281a5,'amount':_0x4aa663[_0x4006a6(0x1d6)]?.[_0x4006a6(0x1b0)],'currency':_0x4aa663[_0x4006a6(0x1d6)]?.['currency']};}catch(_0x1997fc){console['error']('Rapyd\x20payment\x20verification\x20error:',_0x1997fc),loggerService_1[_0x4006a6(0x1da)][_0x4006a6(0x179)]('rapyd','/v1/hosted/payment_links/'+_0x2a58a7,_0x1997fc);throw new Error(_0x4006a6(0x1a9)+(_0x1997fc instanceof Error?_0x1997fc[_0x4006a6(0x1d9)]:_0x4006a6(0x198)));}}async[a42_0x29423a(0x1c3)](_0x525aa5){const _0x59c82f=a42_0x29423a;console[_0x59c82f(0x178)]('Processing\x20Rapyd\x20webhook:',_0x525aa5);let _0x5e72eb=_0x59c82f(0x1a5);switch(_0x525aa5['type']?.[_0x59c82f(0x1b9)]()){case _0x59c82f(0x1ad):_0x525aa5[_0x59c82f(0x1d6)]?.[_0x59c82f(0x17d)]===!![]&&_0x525aa5[_0x59c82f(0x1d6)]?.[_0x59c82f(0x1d7)]===_0x59c82f(0x1bd)?_0x5e72eb=_0x59c82f(0x1aa):_0x5e72eb=_0x59c82f(0x1a5);break;case _0x59c82f(0x1dd):_0x5e72eb=_0x59c82f(0x192);break;case _0x59c82f(0x191):_0x5e72eb=_0x59c82f(0x1b8);break;case _0x59c82f(0x1de):_0x5e72eb='FAILED';break;default:switch(_0x525aa5['data']?.['status']?.[_0x59c82f(0x1b9)]()){case'CLO':_0x525aa5[_0x59c82f(0x1d6)]?.[_0x59c82f(0x17d)]===!![]?_0x5e72eb=_0x59c82f(0x1aa):_0x5e72eb='FAILED';break;case _0x59c82f(0x17f):_0x5e72eb=_0x59c82f(0x192);break;case'EXP':_0x5e72eb=_0x59c82f(0x1b8);break;case _0x59c82f(0x181):_0x5e72eb=_0x59c82f(0x192);break;case _0x59c82f(0x1dc):case'ACT':default:_0x5e72eb=_0x59c82f(0x1a5);break;}break;}return{'paymentId':_0x525aa5[_0x59c82f(0x1d6)]?.[_0x59c82f(0x19a)]||'','status':_0x5e72eb,'amount':_0x525aa5[_0x59c82f(0x1d6)]?.[_0x59c82f(0x1b0)],'currency':_0x525aa5['data']?.[_0x59c82f(0x1ba)]};}}exports[a42_0x29423a(0x193)]=RapydService;