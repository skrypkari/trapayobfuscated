'use strict';function a45_0x58c4(){const _0x23ecc1=['Processing\x20Rapyd\x20webhook:','logWhiteDomainError','\x20(always\x20GB\x20for\x20Rapyd)','\x20(GB\x20-\x20Britain)','Redirect\x20URL:','processWebhook','265657QIsuwp','amount','JSON\x20Parse\x20Error:\x20','Rapyd\x20API\x20error\x20(','CLO','none','Failed\x20to\x20create\x20Rapyd\x20payment\x20link:\x20Unknown\x20error','51484oSzAvk','1755438Cikgum','__esModule','Rapyd\x20API\x20error:\x20','Failed\x20to\x20create\x20Rapyd\x20payment\x20link:\x20','4TqhylW','fromEntries','EXP','üá¨üáß\x20Country:\x20',',\x20failureMessage=','/v1/hosted/payment_links','Failed\x20to\x20parse\x20JSON\x20response:','Business\x20Error\x20(','application/json','Unknown\x20error\x20from\x20Rapyd\x20API','Error\x20details:','loggerService','350zDxcWl','gb_mastercard_card',',\x20body:\x20','SUCCESS','error','logWhiteDomainRequest','stringify','PAID','paymentMethod','error_code','ERR','last4','createPaymentLink','===\x20PARSED\x20RAPYD\x20RESPONSE\x20===','===\x20RAPYD\x20SUCCESS\x20===','Response\x20Time:','UNKNOWN','../loggerService','üí≥\x20Payment\x20Methods:\x20gb_visa_card,\x20gb_mastercard_card','Error\x20Code:','URL:','üá¨üáß\x20Using\x20GB\x20(Britain)\x20as\x20country\x20for\x20Rapyd\x20payment\x20link','Error\x20Message:','ORDER:\x20','currency','rapyd','5935440dSyMdK','status','GET','POST','===\x20RAPYD\x20SERVICE\x20ERROR\x20===','Headers:','paid','Request\x20Body\x20(Updated\x20Format):','Incomplete\x20response:\x20missing\x20id\x20or\x20redirect_url','TesSoft\x20Payment\x20System/1.0','logWhiteDomainResponse','merchant_reference_id','üá¨üáß\x20Country\x20used:\x20','200HduuSm','EXPIRED','):\x20','17375160YeDAmr','Missing\x20id\x20or\x20redirect_url\x20in\x20response','statusText','message','Failed\x20to\x20verify\x20Rapyd\x20payment:\x20','174465CEtHVP','parse','gb_visa_card','HTTP\x20Status:','Response\x20data:','PAYMENT_FAILED','PAYMENT_EXPIRED','NEW','failureCode','stack','===\x20RAPYD\x20API\x20RESPONSE\x20(White\x20Domain)\x20===','text','ACT','HTTP\x20','PENDING','redirect_url','Full\x20Error\x20Data:','apiUrl','FAILED','Error\x20message:','defineProperty','cardLast4','===\x20RAPYD\x20API\x20REQUEST\x20(White\x20Domain\x20-\x20Updated\x20Format)\x20===','failure_message','Payment\x20Link\x20ID:','toUpperCase','CAN','https://tesoft.uk/gateway/fail.php?id=','/v1/hosted/payment_links/','RapydService','payment_method_data','Error\x20stack:','Unknown\x20error','Status:','log','now','failure_code','7619970VnxDLQ','headers','üåê\x20Rapyd\x20service\x20initialized\x20with\x20white\x20domain\x20proxy','Response\x20Body:','verifyPayment','json','Parsed\x20Result:','5kXXQHv','payment_method_type','data','HTTP\x20error!\x20status:\x20','Rapyd\x20payment\x20verification\x20error:'];a45_0x58c4=function(){return _0x23ecc1;};return a45_0x58c4();}function a45_0x4d14(_0x5763b2,_0x41bbaf){const _0x58c499=a45_0x58c4();return a45_0x4d14=function(_0x4d14e3,_0x2dcd26){_0x4d14e3=_0x4d14e3-0xac;let _0x102135=_0x58c499[_0x4d14e3];return _0x102135;},a45_0x4d14(_0x5763b2,_0x41bbaf);}const a45_0x2bfb6a=a45_0x4d14;(function(_0x3808ff,_0x3d46f1){const _0x34dcb9=a45_0x4d14,_0x50e3e4=_0x3808ff();while(!![]){try{const _0x5b242f=parseInt(_0x34dcb9(0x127))/0x1+-parseInt(_0x34dcb9(0xae))/0x2*(-parseInt(_0x34dcb9(0x128))/0x3)+parseInt(_0x34dcb9(0xd4))/0x4+-parseInt(_0x34dcb9(0x115))/0x5*(-parseInt(_0x34dcb9(0x10e))/0x6)+parseInt(_0x34dcb9(0x120))/0x7*(-parseInt(_0x34dcb9(0xe1))/0x8)+parseInt(_0x34dcb9(0xe9))/0x9*(-parseInt(_0x34dcb9(0xba))/0xa)+-parseInt(_0x34dcb9(0xe4))/0xb;if(_0x5b242f===_0x3d46f1)break;else _0x50e3e4['push'](_0x50e3e4['shift']());}catch(_0xbe28a9){_0x50e3e4['push'](_0x50e3e4['shift']());}}}(a45_0x58c4,0xbbb35));Object[a45_0x2bfb6a(0xfd)](exports,a45_0x2bfb6a(0x129),{'value':!![]}),exports[a45_0x2bfb6a(0x106)]=void 0x0;const loggerService_1=require(a45_0x2bfb6a(0xcb));class RapydService{constructor(){const _0x49eb92=a45_0x2bfb6a;this['apiUrl']='https://tesoft.uk/gateway/rapyd/',console[_0x49eb92(0x10b)](_0x49eb92(0x110));}async[a45_0x2bfb6a(0xc6)](_0x4307bc){const _0x2e7c72=a45_0x2bfb6a,{orderId:_0x4f054e,orderName:_0x2adf85,amount:_0x4ee292,currency:_0x175833,usage:_0x4e699a,maxPayments:_0x33feef,successUrl:_0x1e7116,failUrl:_0x591d7d}=_0x4307bc,_0x21df6a=_0x175833[_0x2e7c72(0x102)](),_0x1185f2='GB';console[_0x2e7c72(0x10b)](_0x2e7c72(0xcf));const _0x3d812a='https://tesoft.uk/gateway/success.php?id='+_0x4f054e,_0x2cee40=_0x2e7c72(0x104)+_0x4f054e,_0x1f91fb={'amount':_0x4ee292,'currency':_0x21df6a,'cancel_checkout_url':_0x2cee40,'complete_checkout_url':_0x3d812a,'complete_payment_url':_0x3d812a,'merchant_reference_id':_0x4f054e,'description':_0x2e7c72(0xd1)+_0x4f054e,'country':'GB','payment_method_types_include':[_0x2e7c72(0xeb),_0x2e7c72(0xbb)],'custom_elements':{'display_description':!![]}},_0x12742e=Date[_0x2e7c72(0x10c)]();try{console['log'](_0x2e7c72(0xff)),console[_0x2e7c72(0x10b)](_0x2e7c72(0xce),this[_0x2e7c72(0xfa)]),console[_0x2e7c72(0x10b)](_0x2e7c72(0xdb),JSON[_0x2e7c72(0xc0)](_0x1f91fb,null,0x2)),console[_0x2e7c72(0x10b)](_0x2e7c72(0xb1)+_0x1185f2+_0x2e7c72(0x11c)),console['log'](_0x2e7c72(0xcc)),loggerService_1[_0x2e7c72(0xb9)][_0x2e7c72(0xbf)]('rapyd','/v1/hosted/payment_links','POST',_0x1f91fb);const _0xe537f=await fetch(this[_0x2e7c72(0xfa)],{'method':_0x2e7c72(0xd7),'headers':{'Content-Type':_0x2e7c72(0xb6),'User-Agent':_0x2e7c72(0xdd)},'body':JSON[_0x2e7c72(0xc0)](_0x1f91fb)}),_0x400e43=Date[_0x2e7c72(0x10c)]()-_0x12742e;console['log'](_0x2e7c72(0xf3)),console['log'](_0x2e7c72(0x10a),_0xe537f[_0x2e7c72(0xd5)]),console[_0x2e7c72(0x10b)]('Status\x20Text:',_0xe537f[_0x2e7c72(0xe6)]),console[_0x2e7c72(0x10b)](_0x2e7c72(0xd9),Object[_0x2e7c72(0xaf)](_0xe537f[_0x2e7c72(0x10f)]['entries']())),console[_0x2e7c72(0x10b)](_0x2e7c72(0xc9),_0x400e43+'ms');const _0xe1a61f=await _0xe537f[_0x2e7c72(0xf4)]();console[_0x2e7c72(0x10b)]('Raw\x20Response\x20Body:',_0xe1a61f);if(!_0xe537f['ok']){console['error']('===\x20RAPYD\x20API\x20ERROR\x20==='),console['error'](_0x2e7c72(0xec),_0xe537f['status']),console[_0x2e7c72(0xbe)](_0x2e7c72(0x111),_0xe1a61f),loggerService_1[_0x2e7c72(0xb9)][_0x2e7c72(0xde)]('rapyd',_0x2e7c72(0xb3),_0xe537f[_0x2e7c72(0xd5)],_0xe1a61f,_0x400e43),loggerService_1['loggerService'][_0x2e7c72(0x11b)](_0x2e7c72(0xd3),'/v1/hosted/payment_links',_0x2e7c72(0xf6)+_0xe537f[_0x2e7c72(0xd5)]+':\x20'+_0xe1a61f);throw new Error('HTTP\x20error!\x20status:\x20'+_0xe537f['status']+_0x2e7c72(0xbc)+_0xe1a61f);}let _0x3a0ddc;try{_0x3a0ddc=JSON[_0x2e7c72(0xea)](_0xe1a61f);}catch(_0x50426f){console[_0x2e7c72(0xbe)](_0x2e7c72(0xb4),_0x50426f),loggerService_1[_0x2e7c72(0xb9)][_0x2e7c72(0x11b)]('rapyd','/v1/hosted/payment_links',_0x2e7c72(0x122)+_0x50426f);throw new Error('Invalid\x20JSON\x20response\x20from\x20Rapyd\x20API:\x20'+_0xe1a61f);}console[_0x2e7c72(0x10b)](_0x2e7c72(0xc7)),console[_0x2e7c72(0x10b)](_0x2e7c72(0x114),JSON[_0x2e7c72(0xc0)](_0x3a0ddc,null,0x2)),loggerService_1[_0x2e7c72(0xb9)][_0x2e7c72(0xde)](_0x2e7c72(0xd3),_0x2e7c72(0xb3),_0xe537f[_0x2e7c72(0xd5)],_0x3a0ddc,_0x400e43);if(_0x3a0ddc[_0x2e7c72(0xd5)]?.[_0x2e7c72(0xd5)]!==_0x2e7c72(0xbd)){const _0x317e1b=_0x3a0ddc['status']?.[_0x2e7c72(0xe7)]||_0x2e7c72(0xb7),_0x3c82f2=_0x3a0ddc['status']?.['error_code']||_0x2e7c72(0xca);console[_0x2e7c72(0xbe)]('===\x20RAPYD\x20API\x20BUSINESS\x20ERROR\x20==='),console[_0x2e7c72(0xbe)](_0x2e7c72(0xcd),_0x3c82f2),console[_0x2e7c72(0xbe)](_0x2e7c72(0xd0),_0x317e1b),console[_0x2e7c72(0xbe)](_0x2e7c72(0xf9),_0x3a0ddc[_0x2e7c72(0xd5)]),loggerService_1[_0x2e7c72(0xb9)][_0x2e7c72(0x11b)](_0x2e7c72(0xd3),_0x2e7c72(0xb3),_0x2e7c72(0xb5)+_0x3c82f2+_0x2e7c72(0xe3)+_0x317e1b);throw new Error(_0x2e7c72(0x123)+_0x3c82f2+_0x2e7c72(0xe3)+_0x317e1b);}if(!_0x3a0ddc[_0x2e7c72(0x117)]?.['id']||!_0x3a0ddc[_0x2e7c72(0x117)]?.[_0x2e7c72(0xf8)]){console[_0x2e7c72(0xbe)]('===\x20RAPYD\x20API\x20INCOMPLETE\x20RESPONSE\x20==='),console[_0x2e7c72(0xbe)](_0x2e7c72(0xe5)),console[_0x2e7c72(0xbe)](_0x2e7c72(0xed),_0x3a0ddc[_0x2e7c72(0x117)]),loggerService_1[_0x2e7c72(0xb9)][_0x2e7c72(0x11b)](_0x2e7c72(0xd3),'/v1/hosted/payment_links',_0x2e7c72(0xdc));throw new Error('Invalid\x20response\x20from\x20Rapyd\x20API:\x20missing\x20id\x20or\x20redirect_url');}return console[_0x2e7c72(0x10b)](_0x2e7c72(0xc8)),console['log'](_0x2e7c72(0x101),_0x3a0ddc[_0x2e7c72(0x117)]['id']),console[_0x2e7c72(0x10b)](_0x2e7c72(0x11e),_0x3a0ddc['data'][_0x2e7c72(0xf8)]),console[_0x2e7c72(0x10b)](_0x2e7c72(0xe0)+_0x1185f2+_0x2e7c72(0x11d)),console[_0x2e7c72(0x10b)](_0x2e7c72(0xcc)),{'gateway_payment_id':_0x3a0ddc['data']['id'],'payment_url':_0x3a0ddc[_0x2e7c72(0x117)][_0x2e7c72(0xf8)]};}catch(_0x3bfdee){console['error'](_0x2e7c72(0xd8)),console[_0x2e7c72(0xbe)](_0x2e7c72(0xb8),_0x3bfdee),loggerService_1[_0x2e7c72(0xb9)][_0x2e7c72(0x11b)](_0x2e7c72(0xd3),_0x2e7c72(0xb3),_0x3bfdee);if(_0x3bfdee instanceof Error){console[_0x2e7c72(0xbe)](_0x2e7c72(0xfc),_0x3bfdee[_0x2e7c72(0xe7)]),console['error'](_0x2e7c72(0x108),_0x3bfdee[_0x2e7c72(0xf2)]);throw new Error(_0x2e7c72(0xad)+_0x3bfdee[_0x2e7c72(0xe7)]);}throw new Error(_0x2e7c72(0x126));}}async[a45_0x2bfb6a(0x112)](_0x1e52a2){const _0x31b34f=a45_0x2bfb6a,_0x70853f=Date['now']();try{loggerService_1[_0x31b34f(0xb9)][_0x31b34f(0xbf)](_0x31b34f(0xd3),'/v1/hosted/payment_links/'+_0x1e52a2,_0x31b34f(0xd6),{});const _0x245e40=await fetch(this[_0x31b34f(0xfa)]+'/'+_0x1e52a2,{'method':_0x31b34f(0xd6),'headers':{'Content-Type':_0x31b34f(0xb6),'User-Agent':_0x31b34f(0xdd)}}),_0xafaf0e=Date['now']()-_0x70853f;if(!_0x245e40['ok']){const _0x20adf6=await _0x245e40['text']();loggerService_1['loggerService'][_0x31b34f(0xde)]('rapyd',_0x31b34f(0x105)+_0x1e52a2,_0x245e40[_0x31b34f(0xd5)],_0x20adf6,_0xafaf0e);throw new Error(_0x31b34f(0x118)+_0x245e40[_0x31b34f(0xd5)]);}const _0x3bfec8=await _0x245e40[_0x31b34f(0x113)]();loggerService_1['loggerService'][_0x31b34f(0xde)](_0x31b34f(0xd3),_0x31b34f(0x105)+_0x1e52a2,_0x245e40['status'],_0x3bfec8,_0xafaf0e);if(_0x3bfec8[_0x31b34f(0xd5)]?.[_0x31b34f(0xd5)]!==_0x31b34f(0xbd)){loggerService_1['loggerService'][_0x31b34f(0x11b)](_0x31b34f(0xd3),_0x31b34f(0x105)+_0x1e52a2,'Rapyd\x20API\x20error:\x20'+(_0x3bfec8['status']?.[_0x31b34f(0xe7)]||_0x31b34f(0x109)));throw new Error(_0x31b34f(0xac)+(_0x3bfec8[_0x31b34f(0xd5)]?.[_0x31b34f(0xe7)]||'Unknown\x20error'));}let _0x3fa92a='PENDING';if(_0x3bfec8[_0x31b34f(0x117)]?.[_0x31b34f(0xd5)])switch(_0x3bfec8[_0x31b34f(0x117)][_0x31b34f(0xd5)][_0x31b34f(0x102)]()){case _0x31b34f(0x124):_0x3fa92a=_0x31b34f(0xc1);break;case _0x31b34f(0x103):_0x3fa92a=_0x31b34f(0xfb);break;case _0x31b34f(0xb0):_0x3fa92a=_0x31b34f(0xe2);break;case _0x31b34f(0xc4):_0x3fa92a=_0x31b34f(0xfb);break;case _0x31b34f(0xf0):case _0x31b34f(0xf5):default:_0x3fa92a=_0x31b34f(0xf7);break;}return{'status':_0x3fa92a,'amount':_0x3bfec8[_0x31b34f(0x117)]?.[_0x31b34f(0x121)],'currency':_0x3bfec8[_0x31b34f(0x117)]?.[_0x31b34f(0xd2)]};}catch(_0x595da7){console[_0x31b34f(0xbe)](_0x31b34f(0x119),_0x595da7),loggerService_1['loggerService'][_0x31b34f(0x11b)](_0x31b34f(0xd3),_0x31b34f(0x105)+_0x1e52a2,_0x595da7);throw new Error(_0x31b34f(0xe8)+(_0x595da7 instanceof Error?_0x595da7['message']:_0x31b34f(0x109)));}}async[a45_0x2bfb6a(0x11f)](_0x16b33c){const _0x223c3d=a45_0x2bfb6a;console[_0x223c3d(0x10b)](_0x223c3d(0x11a),_0x16b33c);let _0x5c1042=_0x223c3d(0xf7),_0xbcc6b1;_0x16b33c[_0x223c3d(0x117)]?.[_0x223c3d(0x100)]&&(_0xbcc6b1=_0x16b33c[_0x223c3d(0x117)][_0x223c3d(0x100)],console[_0x223c3d(0x10b)]('üí•\x20Rapyd\x20failure\x20message:\x20'+_0xbcc6b1));switch(_0x16b33c['type']?.[_0x223c3d(0x102)]()){case'PAYMENT_COMPLETED':_0x16b33c[_0x223c3d(0x117)]?.[_0x223c3d(0xda)]===!![]&&_0x16b33c[_0x223c3d(0x117)]?.['status']==='CLO'?_0x5c1042=_0x223c3d(0xc1):_0x5c1042=_0x223c3d(0xf7);break;case'PAYMENT_CANCELED':_0x5c1042=_0x223c3d(0xfb);break;case _0x223c3d(0xef):_0x5c1042=_0x223c3d(0xe2);break;case _0x223c3d(0xee):_0x5c1042=_0x223c3d(0xfb);!_0xbcc6b1&&_0x16b33c[_0x223c3d(0x117)]?.['failure_message']&&(_0xbcc6b1=_0x16b33c[_0x223c3d(0x117)][_0x223c3d(0x100)]);break;default:switch(_0x16b33c[_0x223c3d(0x117)]?.[_0x223c3d(0xd5)]?.[_0x223c3d(0x102)]()){case'CLO':_0x16b33c[_0x223c3d(0x117)]?.[_0x223c3d(0xda)]===!![]?_0x5c1042='PAID':_0x5c1042='FAILED';break;case'CAN':_0x5c1042=_0x223c3d(0xfb);break;case'EXP':_0x5c1042=_0x223c3d(0xe2);break;case _0x223c3d(0xc4):_0x5c1042=_0x223c3d(0xfb);!_0xbcc6b1&&_0x16b33c[_0x223c3d(0x117)]?.['failure_message']&&(_0xbcc6b1=_0x16b33c['data'][_0x223c3d(0x100)]);break;case _0x223c3d(0xf0):case _0x223c3d(0xf5):default:_0x5c1042=_0x223c3d(0xf7);break;}break;}const _0x1ce021={};return _0x16b33c['data']?.['payment_method_data']?.[_0x223c3d(0xc5)]&&(_0x1ce021[_0x223c3d(0xfe)]=_0x16b33c[_0x223c3d(0x117)][_0x223c3d(0x107)][_0x223c3d(0xc5)]),_0x16b33c[_0x223c3d(0x117)]?.['payment_method_type']&&(_0x1ce021[_0x223c3d(0xc2)]=_0x16b33c[_0x223c3d(0x117)][_0x223c3d(0x116)]),_0x16b33c[_0x223c3d(0x117)]?.[_0x223c3d(0xc3)]&&(_0x1ce021['errorCode']=_0x16b33c[_0x223c3d(0x117)][_0x223c3d(0xc3)]),_0x16b33c[_0x223c3d(0x117)]?.[_0x223c3d(0x10d)]&&(_0x1ce021[_0x223c3d(0xf1)]=_0x16b33c[_0x223c3d(0x117)][_0x223c3d(0x10d)]),console['log']('üîÑ\x20Rapyd\x20webhook\x20processed:\x20status='+_0x5c1042+_0x223c3d(0xb2)+(_0xbcc6b1||_0x223c3d(0x125))),{'paymentId':_0x16b33c[_0x223c3d(0x117)]?.[_0x223c3d(0xdf)]||'','status':_0x5c1042,'amount':_0x16b33c[_0x223c3d(0x117)]?.['amount'],'currency':_0x16b33c[_0x223c3d(0x117)]?.[_0x223c3d(0xd2)],'failureMessage':_0xbcc6b1,'additionalInfo':_0x1ce021};}}exports[a45_0x2bfb6a(0x106)]=RapydService;