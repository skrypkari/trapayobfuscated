'use strict';function a63_0x3cb4(_0x40fee0,_0x13d7df){_0x40fee0=_0x40fee0-0x79;const _0x3a1856=a63_0x3a18();let _0x3cb4fb=_0x3a1856[_0x40fee0];return _0x3cb4fb;}const a63_0x6bf21c=a63_0x3cb4;(function(_0x5109f5,_0x50ac09){const _0x5cd061=a63_0x3cb4,_0x8c19dd=_0x5109f5();while(!![]){try{const _0xca8971=parseInt(_0x5cd061(0xe4))/0x1+-parseInt(_0x5cd061(0xcb))/0x2+parseInt(_0x5cd061(0xb6))/0x3+-parseInt(_0x5cd061(0xa5))/0x4+parseInt(_0x5cd061(0xfb))/0x5+-parseInt(_0x5cd061(0x95))/0x6+parseInt(_0x5cd061(0xa1))/0x7;if(_0xca8971===_0x50ac09)break;else _0x8c19dd['push'](_0x8c19dd['shift']());}catch(_0x2d77ce){_0x8c19dd['push'](_0x8c19dd['shift']());}}}(a63_0x3a18,0x9d0aa));Object['defineProperty'](exports,a63_0x6bf21c(0xb2),{'value':!![]}),exports['RapydService']=void 0x0;const loggerService_1=require('../loggerService');class RapydService{constructor(){const _0x3fd07e=a63_0x6bf21c;this['apiUrl']=_0x3fd07e(0xa6),console[_0x3fd07e(0xc6)](_0x3fd07e(0xea));}async[a63_0x6bf21c(0x9e)](_0x5e91f7){const _0x5b228a=a63_0x6bf21c,{orderId:_0x146f39,orderName:_0x4e6a2d,amount:_0x4d0230,currency:_0x51daad,usage:_0x3296a0,maxPayments:_0x5a75ae,successUrl:_0x5afa9f,failUrl:_0x3b51ea,customerName:_0x3a9fcb,customerEmail:_0x2a3ab9}=_0x5e91f7,_0x46d54e=_0x51daad[_0x5b228a(0x88)](),_0x2d1c02='GB';console[_0x5b228a(0xc6)](_0x5b228a(0x92));const _0x5ad4eb=_0x5b228a(0xda)+_0x146f39,_0x40f842=_0x5b228a(0xce)+_0x146f39,_0x4b9c2a={'amount':_0x4d0230,'currency':_0x46d54e,'payment_method_options':{'3d_required':![]},'cancel_checkout_url':_0x40f842,'complete_checkout_url':_0x5ad4eb,'complete_payment_url':_0x5ad4eb,'merchant_reference_id':_0x146f39,'description':'ORDER:\x20'+_0x146f39,'country':'GB','payment_method_types_include':[_0x5b228a(0x87),_0x5b228a(0xa8)],'custom_elements':{'display_description':!![],'billing_address_collect':!![],'required_customer_fields':['name',_0x5b228a(0xd8),'phone_number',_0x5b228a(0xe3)]}};_0x3a9fcb&&(_0x4b9c2a[_0x5b228a(0xf3)][_0x5b228a(0x85)]=_0x3a9fcb,console[_0x5b228a(0xc6)](_0x5b228a(0xde)+_0x3a9fcb));if(_0x46d54e!==_0x5b228a(0xed)){const _0x20fc8a=Math['floor'](Date['now']()/0x3e8)+0x1e*0x3c;_0x4b9c2a[_0x5b228a(0x8c)]=_0x5b228a(0xee),_0x4b9c2a[_0x5b228a(0xe8)]=_0x5b228a(0xed),_0x4b9c2a['expiration']=_0x20fc8a,console['log'](_0x5b228a(0xbf)+_0x46d54e+'\x20->\x20EUR:'),console['log'](_0x5b228a(0xab)),console[_0x5b228a(0xc6)](_0x5b228a(0xc5)),console[_0x5b228a(0xc6)](_0x5b228a(0xf0)+_0x20fc8a+'\x20('+new Date(_0x20fc8a*0x3e8)[_0x5b228a(0xcc)]()+')');}const _0x33f5fe=Date['now']();try{console[_0x5b228a(0xc6)](_0x5b228a(0xc0)),console['log'](_0x5b228a(0xc4),this['apiUrl']),console[_0x5b228a(0xc6)](_0x5b228a(0xf1),JSON[_0x5b228a(0x8b)](_0x4b9c2a,null,0x2)),console[_0x5b228a(0xc6)](_0x5b228a(0xd1)+_0x2d1c02+_0x5b228a(0xcf)),console[_0x5b228a(0xc6)]('üí≥\x20Payment\x20Methods:\x20gb_visa_card,\x20gb_mastercard_card'),loggerService_1[_0x5b228a(0x81)][_0x5b228a(0xba)](_0x5b228a(0x9d),_0x5b228a(0xdf),_0x5b228a(0x7a),_0x4b9c2a);const _0xaa5161=await fetch(this[_0x5b228a(0x7b)],{'method':_0x5b228a(0x7a),'headers':{'Content-Type':'application/json','User-Agent':_0x5b228a(0xef)},'body':JSON[_0x5b228a(0x8b)](_0x4b9c2a)}),_0x571bc8=Date[_0x5b228a(0xb0)]()-_0x33f5fe;console[_0x5b228a(0xc6)]('===\x20RAPYD\x20API\x20RESPONSE\x20(White\x20Domain)\x20==='),console[_0x5b228a(0xc6)](_0x5b228a(0x9c),_0xaa5161[_0x5b228a(0xd0)]),console[_0x5b228a(0xc6)](_0x5b228a(0xf7),_0xaa5161[_0x5b228a(0xb3)]),console[_0x5b228a(0xc6)](_0x5b228a(0x8a),Object[_0x5b228a(0xb8)](_0xaa5161[_0x5b228a(0x93)][_0x5b228a(0x97)]())),console[_0x5b228a(0xc6)]('Response\x20Time:',_0x571bc8+'ms');const _0x20fa6c=await _0xaa5161[_0x5b228a(0x7e)]();console[_0x5b228a(0xc6)]('Raw\x20Response\x20Body:',_0x20fa6c);if(!_0xaa5161['ok']){console[_0x5b228a(0xdd)](_0x5b228a(0xdb)),console[_0x5b228a(0xdd)](_0x5b228a(0xc1),_0xaa5161[_0x5b228a(0xd0)]),console[_0x5b228a(0xdd)](_0x5b228a(0xac),_0x20fa6c),loggerService_1[_0x5b228a(0x81)][_0x5b228a(0xf5)](_0x5b228a(0x9d),_0x5b228a(0xdf),_0xaa5161[_0x5b228a(0xd0)],_0x20fa6c,_0x571bc8),loggerService_1['loggerService'][_0x5b228a(0x82)]('rapyd','/v1/hosted/payment_links',_0x5b228a(0xbc)+_0xaa5161[_0x5b228a(0xd0)]+':\x20'+_0x20fa6c);throw new Error('HTTP\x20error!\x20status:\x20'+_0xaa5161['status']+_0x5b228a(0xe7)+_0x20fa6c);}let _0x4ed4f3;try{_0x4ed4f3=JSON['parse'](_0x20fa6c);}catch(_0x5b61b6){console[_0x5b228a(0xdd)](_0x5b228a(0xbe),_0x5b61b6),loggerService_1[_0x5b228a(0x81)][_0x5b228a(0x82)]('rapyd',_0x5b228a(0xdf),_0x5b228a(0xad)+_0x5b61b6);throw new Error(_0x5b228a(0x89)+_0x20fa6c);}console[_0x5b228a(0xc6)](_0x5b228a(0xb7)),console[_0x5b228a(0xc6)](_0x5b228a(0x9f),JSON[_0x5b228a(0x8b)](_0x4ed4f3,null,0x2)),loggerService_1[_0x5b228a(0x81)][_0x5b228a(0xf5)](_0x5b228a(0x9d),_0x5b228a(0xdf),_0xaa5161[_0x5b228a(0xd0)],_0x4ed4f3,_0x571bc8);if(_0x4ed4f3[_0x5b228a(0xd0)]?.[_0x5b228a(0xd0)]!==_0x5b228a(0x90)){const _0x2b859a=_0x4ed4f3[_0x5b228a(0xd0)]?.[_0x5b228a(0xb4)]||'Unknown\x20error\x20from\x20Rapyd\x20API',_0xa8c424=_0x4ed4f3[_0x5b228a(0xd0)]?.[_0x5b228a(0xd6)]||'UNKNOWN';console[_0x5b228a(0xdd)](_0x5b228a(0xbd)),console[_0x5b228a(0xdd)](_0x5b228a(0xb1),_0xa8c424),console[_0x5b228a(0xdd)]('Error\x20Message:',_0x2b859a),console[_0x5b228a(0xdd)](_0x5b228a(0x80),_0x4ed4f3[_0x5b228a(0xd0)]),loggerService_1[_0x5b228a(0x81)][_0x5b228a(0x82)]('rapyd',_0x5b228a(0xdf),_0x5b228a(0xbb)+_0xa8c424+'):\x20'+_0x2b859a);throw new Error(_0x5b228a(0x94)+_0xa8c424+_0x5b228a(0xc2)+_0x2b859a);}if(!_0x4ed4f3['data']?.['id']||!_0x4ed4f3[_0x5b228a(0x7c)]?.[_0x5b228a(0xec)]){console[_0x5b228a(0xdd)]('===\x20RAPYD\x20API\x20INCOMPLETE\x20RESPONSE\x20==='),console[_0x5b228a(0xdd)](_0x5b228a(0xe2)),console[_0x5b228a(0xdd)]('Response\x20data:',_0x4ed4f3['data']),loggerService_1[_0x5b228a(0x81)][_0x5b228a(0x82)]('rapyd',_0x5b228a(0xdf),_0x5b228a(0xd5));throw new Error('Invalid\x20response\x20from\x20Rapyd\x20API:\x20missing\x20id\x20or\x20redirect_url');}return console['log'](_0x5b228a(0xa9)),console[_0x5b228a(0xc6)](_0x5b228a(0xfa),_0x4ed4f3[_0x5b228a(0x7c)]['id']),console[_0x5b228a(0xc6)](_0x5b228a(0xf9),_0x4ed4f3[_0x5b228a(0x7c)][_0x5b228a(0xec)]),console['log']('üá¨üáß\x20Country\x20used:\x20'+_0x2d1c02+_0x5b228a(0xca)),console[_0x5b228a(0xc6)](_0x5b228a(0xf4)),{'gateway_payment_id':_0x4ed4f3[_0x5b228a(0x7c)]['id'],'payment_url':_0x4ed4f3[_0x5b228a(0x7c)]['redirect_url']};}catch(_0x2f6e31){console['error'](_0x5b228a(0xd9)),console[_0x5b228a(0xdd)](_0x5b228a(0xf6),_0x2f6e31),loggerService_1[_0x5b228a(0x81)]['logWhiteDomainError'](_0x5b228a(0x9d),_0x5b228a(0xdf),_0x2f6e31);if(_0x2f6e31 instanceof Error){console[_0x5b228a(0xdd)](_0x5b228a(0x9b),_0x2f6e31[_0x5b228a(0xb4)]),console[_0x5b228a(0xdd)](_0x5b228a(0x91),_0x2f6e31['stack']);throw new Error(_0x5b228a(0xaa)+_0x2f6e31[_0x5b228a(0xb4)]);}throw new Error(_0x5b228a(0xa0));}}async['verifyPayment'](_0x2c2d74){const _0x5328c=a63_0x6bf21c,_0x3fe4e2=Date['now']();try{loggerService_1[_0x5328c(0x81)][_0x5328c(0xba)](_0x5328c(0x9d),_0x5328c(0x7f)+_0x2c2d74,_0x5328c(0xdc),{});const _0xb36979=await fetch(this['apiUrl']+'/'+_0x2c2d74,{'method':_0x5328c(0xdc),'headers':{'Content-Type':_0x5328c(0xf8),'User-Agent':'Payment\x20System/1.0'}}),_0xec7474=Date[_0x5328c(0xb0)]()-_0x3fe4e2;if(!_0xb36979['ok']){const _0x10635d=await _0xb36979['text']();loggerService_1[_0x5328c(0x81)][_0x5328c(0xf5)]('rapyd',_0x5328c(0x7f)+_0x2c2d74,_0xb36979[_0x5328c(0xd0)],_0x10635d,_0xec7474);throw new Error(_0x5328c(0xc9)+_0xb36979['status']);}const _0xbe8aee=await _0xb36979[_0x5328c(0xeb)]();loggerService_1['loggerService']['logWhiteDomainResponse'](_0x5328c(0x9d),_0x5328c(0x7f)+_0x2c2d74,_0xb36979[_0x5328c(0xd0)],_0xbe8aee,_0xec7474);if(_0xbe8aee[_0x5328c(0xd0)]?.['status']!=='SUCCESS'){loggerService_1[_0x5328c(0x81)]['logWhiteDomainError'](_0x5328c(0x9d),_0x5328c(0x7f)+_0x2c2d74,_0x5328c(0xb9)+(_0xbe8aee[_0x5328c(0xd0)]?.['message']||_0x5328c(0xcd)));throw new Error(_0x5328c(0xb9)+(_0xbe8aee[_0x5328c(0xd0)]?.[_0x5328c(0xb4)]||_0x5328c(0xcd)));}let _0x53dc51=_0x5328c(0x86);if(_0xbe8aee['data']?.[_0x5328c(0xd0)])switch(_0xbe8aee[_0x5328c(0x7c)][_0x5328c(0xd0)][_0x5328c(0x88)]()){case _0x5328c(0xe9):_0x53dc51=_0x5328c(0xe6);break;case _0x5328c(0x79):_0x53dc51=_0x5328c(0x99);break;case _0x5328c(0xa7):_0x53dc51=_0x5328c(0x9a);break;case _0x5328c(0xa4):_0x53dc51=_0x5328c(0x99);break;case _0x5328c(0x8e):case'ACT':default:_0x53dc51='PENDING';break;}return{'status':_0x53dc51,'amount':_0xbe8aee['data']?.[_0x5328c(0xaf)],'currency':_0xbe8aee[_0x5328c(0x7c)]?.[_0x5328c(0xd2)]};}catch(_0x166648){console[_0x5328c(0xdd)]('Rapyd\x20payment\x20verification\x20error:',_0x166648),loggerService_1[_0x5328c(0x81)][_0x5328c(0x82)]('rapyd',_0x5328c(0x7f)+_0x2c2d74,_0x166648);throw new Error(_0x5328c(0x8f)+(_0x166648 instanceof Error?_0x166648[_0x5328c(0xb4)]:_0x5328c(0xcd)));}}async[a63_0x6bf21c(0xd4)](_0x4c248a){const _0x485437=a63_0x6bf21c;console[_0x485437(0xc6)](_0x485437(0xae),_0x4c248a);let _0x3e48ff=_0x485437(0x86),_0x3aa7f6;_0x4c248a[_0x485437(0x7c)]?.[_0x485437(0xb5)]&&(_0x3aa7f6=_0x4c248a['data'][_0x485437(0xb5)],console[_0x485437(0xc6)]('üí•\x20Rapyd\x20failure\x20message:\x20'+_0x3aa7f6));switch(_0x4c248a[_0x485437(0xe1)]?.['toUpperCase']()){case _0x485437(0xa2):_0x4c248a[_0x485437(0x7c)]?.[_0x485437(0x7d)]===!![]&&_0x4c248a[_0x485437(0x7c)]?.[_0x485437(0xd0)]===_0x485437(0xe9)?_0x3e48ff=_0x485437(0xe6):_0x3e48ff=_0x485437(0x86);break;case _0x485437(0x8d):_0x3e48ff=_0x485437(0x99);break;case'PAYMENT_EXPIRED':_0x3e48ff=_0x485437(0x9a);break;case _0x485437(0x98):_0x3e48ff=_0x485437(0x99);!_0x3aa7f6&&_0x4c248a[_0x485437(0x7c)]?.[_0x485437(0xb5)]&&(_0x3aa7f6=_0x4c248a[_0x485437(0x7c)][_0x485437(0xb5)]);break;default:switch(_0x4c248a[_0x485437(0x7c)]?.[_0x485437(0xd0)]?.[_0x485437(0x88)]()){case _0x485437(0xe9):_0x4c248a[_0x485437(0x7c)]?.['paid']===!![]?_0x3e48ff=_0x485437(0xe6):_0x3e48ff='FAILED';break;case'CAN':_0x3e48ff=_0x485437(0x99);break;case _0x485437(0xa7):_0x3e48ff=_0x485437(0x9a);break;case _0x485437(0xa4):_0x3e48ff='FAILED';!_0x3aa7f6&&_0x4c248a['data']?.[_0x485437(0xb5)]&&(_0x3aa7f6=_0x4c248a[_0x485437(0x7c)][_0x485437(0xb5)]);break;case _0x485437(0x8e):case _0x485437(0x84):default:_0x3e48ff='PENDING';break;}break;}const _0x58711d={};return _0x4c248a[_0x485437(0x7c)]?.[_0x485437(0xc7)]?.[_0x485437(0xe5)]&&(_0x58711d['cardLast4']=_0x4c248a[_0x485437(0x7c)]['payment_method_data']['last4']),_0x4c248a[_0x485437(0x7c)]?.['payment_method_type']&&(_0x58711d[_0x485437(0xc8)]=_0x4c248a[_0x485437(0x7c)][_0x485437(0x96)]),_0x4c248a['data']?.[_0x485437(0xd6)]&&(_0x58711d[_0x485437(0x83)]=_0x4c248a[_0x485437(0x7c)][_0x485437(0xd6)]),_0x4c248a['data']?.[_0x485437(0xd3)]&&(_0x58711d['failureCode']=_0x4c248a[_0x485437(0x7c)][_0x485437(0xd3)]),console[_0x485437(0xc6)](_0x485437(0xc3)+_0x3e48ff+_0x485437(0xe0)+(_0x3aa7f6||_0x485437(0xa3))),{'paymentId':_0x4c248a[_0x485437(0x7c)]?.[_0x485437(0xf2)]||'','status':_0x3e48ff,'amount':_0x4c248a[_0x485437(0x7c)]?.[_0x485437(0xaf)],'currency':_0x4c248a[_0x485437(0x7c)]?.['currency'],'failureMessage':_0x3aa7f6,'additionalInfo':_0x58711d};}}exports[a63_0x6bf21c(0xd7)]=RapydService;function a63_0x3a18(){const _0xe37c47=['HTTP\x20Status:','):\x20','üîÑ\x20Rapyd\x20webhook\x20processed:\x20status=','URL:','\x20\x20\x20requested_currency:\x20EUR','log','payment_method_data','paymentMethod','HTTP\x20error!\x20status:\x20','\x20(GB\x20-\x20Britain)','2228172peulHj','toISOString','Unknown\x20error','https://tesoft.uk/gateway/fail.php?id=','\x20(always\x20GB\x20for\x20Rapyd)','status','üá¨üáß\x20Country:\x20','currency','failure_code','processWebhook','Incomplete\x20response:\x20missing\x20id\x20or\x20redirect_url','error_code','RapydService','email','===\x20RAPYD\x20SERVICE\x20ERROR\x20===','https://tesoft.uk/gateway/success.php?id=','===\x20RAPYD\x20API\x20ERROR\x20===','GET','error','üí≥\x20Adding\x20cardholder\x20name:\x20','/v1/hosted/payment_links',',\x20failureMessage=','type','Missing\x20id\x20or\x20redirect_url\x20in\x20response','address','705143shnahn','last4','PAID',',\x20body:\x20','requested_currency','CLO','üåê\x20Rapyd\x20service\x20initialized\x20with\x20white\x20domain\x20proxy','json','redirect_url','EUR','buy','Payment\x20System/1.0','\x20\x20\x20expiration:\x20','Request\x20Body\x20(Updated\x20Format):','merchant_reference_id','custom_elements','üí≥\x20Payment\x20Methods:\x20gb_visa_card,\x20gb_mastercard_card','logWhiteDomainResponse','Error\x20details:','Status\x20Text:','application/json','Redirect\x20URL:','Payment\x20Link\x20ID:','734345tzXyBz','CAN','POST','apiUrl','data','paid','text','/v1/hosted/payment_links/','Full\x20Error\x20Data:','loggerService','logWhiteDomainError','errorCode','ACT','cardholder_name','PENDING','gb_visa_card','toUpperCase','Invalid\x20JSON\x20response\x20from\x20Rapyd\x20API:\x20','Headers:','stringify','fixed_side','PAYMENT_CANCELED','NEW','Failed\x20to\x20verify\x20Rapyd\x20payment:\x20','SUCCESS','Error\x20stack:','üá¨üáß\x20Using\x20GB\x20(Britain)\x20as\x20country\x20for\x20Rapyd\x20payment\x20link','headers','Rapyd\x20API\x20error\x20(','3572130AzsnWB','payment_method_type','entries','PAYMENT_FAILED','FAILED','EXPIRED','Error\x20message:','Status:','rapyd','createPaymentLink','Parsed\x20Result:','Failed\x20to\x20create\x20Rapyd\x20payment\x20link:\x20Unknown\x20error','5991209vygSUE','PAYMENT_COMPLETED','none','ERR','2505496vEVvzx','https://tesoft.uk/gateway/rapyd/','EXP','gb_mastercard_card','===\x20RAPYD\x20SUCCESS\x20===','Failed\x20to\x20create\x20Rapyd\x20payment\x20link:\x20','\x20\x20\x20fixed_side:\x20buy','Response\x20Body:','JSON\x20Parse\x20Error:\x20','Processing\x20Rapyd\x20webhook:','amount','now','Error\x20Code:','__esModule','statusText','message','failure_message','3813474rWxXBi','===\x20PARSED\x20RAPYD\x20RESPONSE\x20===','fromEntries','Rapyd\x20API\x20error:\x20','logWhiteDomainRequest','Business\x20Error\x20(','HTTP\x20','===\x20RAPYD\x20API\x20BUSINESS\x20ERROR\x20===','Failed\x20to\x20parse\x20JSON\x20response:','üí±\x20Adding\x20currency\x20conversion\x20fields\x20for\x20','===\x20RAPYD\x20API\x20REQUEST\x20(White\x20Domain\x20-\x20Updated\x20Format)\x20==='];a63_0x3a18=function(){return _0xe37c47;};return a63_0x3a18();}