'use strict';const a45_0x548a0f=a45_0xd069;(function(_0x43d155,_0x522317){const _0x16e043=a45_0xd069,_0xd89eb3=_0x43d155();while(!![]){try{const _0x23a0c6=-parseInt(_0x16e043(0x141))/0x1*(parseInt(_0x16e043(0x109))/0x2)+-parseInt(_0x16e043(0x136))/0x3+-parseInt(_0x16e043(0x131))/0x4*(parseInt(_0x16e043(0xfe))/0x5)+-parseInt(_0x16e043(0xf4))/0x6*(parseInt(_0x16e043(0x10f))/0x7)+parseInt(_0x16e043(0x111))/0x8*(parseInt(_0x16e043(0x13e))/0x9)+-parseInt(_0x16e043(0x13d))/0xa+parseInt(_0x16e043(0x12e))/0xb;if(_0x23a0c6===_0x522317)break;else _0xd89eb3['push'](_0xd89eb3['shift']());}catch(_0x3a3471){_0xd89eb3['push'](_0xd89eb3['shift']());}}}(a45_0x4794,0x78e0b));function a45_0xd069(_0x102f14,_0x40bed5){const _0x4794aa=a45_0x4794();return a45_0xd069=function(_0xd06960,_0x5a57cd){_0xd06960=_0xd06960-0xc5;let _0x4c8ddb=_0x4794aa[_0xd06960];return _0x4c8ddb;},a45_0xd069(_0x102f14,_0x40bed5);}function a45_0x4794(){const _0x29af46=['/v1/hosted/payment_links/','text','currency','===\x20RAPYD\x20API\x20ERROR\x20===','Failed\x20to\x20verify\x20Rapyd\x20payment:\x20','Status:','):\x20','json','üîÑ\x20Rapyd\x20webhook\x20processed:\x20status=','ERR','9634gxrJAA','FAILED','EXP','gb_mastercard_card','last4','===\x20RAPYD\x20SUCCESS\x20===','7bPuFFe','ACT','29576gcTllD','Processing\x20Rapyd\x20webhook:','failure_message','Response\x20Body:','Failed\x20to\x20create\x20Rapyd\x20payment\x20link:\x20','===\x20RAPYD\x20API\x20BUSINESS\x20ERROR\x20===','createPaymentLink','PENDING','===\x20RAPYD\x20SERVICE\x20ERROR\x20===','paymentMethod','SUCCESS',',\x20failureMessage=','\x20(GB\x20-\x20Britain)','amount','Status\x20Text:','URL:','Payment\x20Link\x20ID:','Invalid\x20JSON\x20response\x20from\x20Rapyd\x20API:\x20','https://tesoft.uk/gateway/fail.php?id=','\x20(always\x20GB\x20for\x20Rapyd)','payment_method_data','üí≥\x20Payment\x20Methods:\x20gb_visa_card,\x20gb_mastercard_card','rapyd',',\x20body:\x20','üåê\x20Rapyd\x20service\x20initialized\x20with\x20white\x20domain\x20proxy','apiUrl','HTTP\x20','application/json','none','29007583IFniaU','===\x20PARSED\x20RAPYD\x20RESPONSE\x20===','RapydService','4trMWtz','failureCode','Response\x20data:','logWhiteDomainRequest','Rapyd\x20API\x20error:\x20','1786506XjyFVR','üá¨üáß\x20Using\x20GB\x20(Britain)\x20as\x20country\x20for\x20Rapyd\x20payment\x20link','https://tesoft.uk/gateway/rapyd/','Unknown\x20error','üá¨üáß\x20Country:\x20','loggerService','PAYMENT_EXPIRED','3907920JzggsF','45UrLChb','CAN','===\x20RAPYD\x20API\x20REQUEST\x20(White\x20Domain\x20-\x20Updated\x20Format)\x20===','104ghLhnY','cardLast4','headers','stringify','toUpperCase','PAYMENT_COMPLETED','fromEntries','../loggerService','Error\x20Code:','Missing\x20id\x20or\x20redirect_url\x20in\x20response','POST','processWebhook','Failed\x20to\x20create\x20Rapyd\x20payment\x20link:\x20Unknown\x20error','errorCode','parse','HTTP\x20Status:','EXPIRED','logWhiteDomainError','/v1/hosted/payment_links','Rapyd\x20payment\x20verification\x20error:','statusText','Error\x20message:','Business\x20Error\x20(','Response\x20Time:','UNKNOWN','status','data','PAYMENT_CANCELED','stack','paid','PAID','gb_visa_card','===\x20RAPYD\x20API\x20INCOMPLETE\x20RESPONSE\x20===','Raw\x20Response\x20Body:','Request\x20Body\x20(Updated\x20Format):','merchant_reference_id','üá¨üáß\x20Country\x20used:\x20','message','Error\x20details:','now','Error\x20Message:','redirect_url','log','failure_code','TesSoft\x20Payment\x20System/1.0','NEW','error','payment_method_type','HTTP\x20error!\x20status:\x20','3115230pKrzyQ','üí•\x20Rapyd\x20failure\x20message:\x20','verifyPayment','Redirect\x20URL:','Error\x20stack:','error_code','CLO','Incomplete\x20response:\x20missing\x20id\x20or\x20redirect_url','===\x20RAPYD\x20API\x20RESPONSE\x20(White\x20Domain)\x20===','logWhiteDomainResponse','769780IkVFLi'];a45_0x4794=function(){return _0x29af46;};return a45_0x4794();}Object['defineProperty'](exports,'__esModule',{'value':!![]}),exports[a45_0x548a0f(0x130)]=void 0x0;const loggerService_1=require(a45_0x548a0f(0xca));class RapydService{constructor(){const _0x3e85ed=a45_0x548a0f;this[_0x3e85ed(0x12a)]=_0x3e85ed(0x138),console[_0x3e85ed(0xed)](_0x3e85ed(0x129));}async[a45_0x548a0f(0x117)](_0x32c3ac){const _0x43c4c9=a45_0x548a0f,{orderId:_0x437227,orderName:_0x1377b8,amount:_0x233137,currency:_0x3e4fdb,usage:_0x10942e,maxPayments:_0x19c89f,successUrl:_0xefc663,failUrl:_0x5cccba}=_0x32c3ac,_0x4efb1a=_0x3e4fdb[_0x43c4c9(0xc7)](),_0x37481b='GB';console[_0x43c4c9(0xed)](_0x43c4c9(0x137));const _0x319c02='https://tesoft.uk/gateway/success.php?id='+_0x437227,_0x39d7a4=_0x43c4c9(0x123)+_0x437227,_0x42656f={'amount':_0x233137,'currency':_0x4efb1a,'cancel_checkout_url':_0x39d7a4,'complete_checkout_url':_0x319c02,'complete_payment_url':_0x319c02,'merchant_reference_id':_0x437227,'description':'ORDER:\x20'+_0x437227,'country':'GB','payment_method_types_include':[_0x43c4c9(0xe2),_0x43c4c9(0x10c)],'custom_elements':{'display_description':!![]}},_0x3058d9=Date[_0x43c4c9(0xea)]();try{console[_0x43c4c9(0xed)](_0x43c4c9(0x140)),console[_0x43c4c9(0xed)](_0x43c4c9(0x120),this['apiUrl']),console[_0x43c4c9(0xed)](_0x43c4c9(0xe5),JSON['stringify'](_0x42656f,null,0x2)),console[_0x43c4c9(0xed)](_0x43c4c9(0x13a)+_0x37481b+_0x43c4c9(0x124)),console['log'](_0x43c4c9(0x126)),loggerService_1[_0x43c4c9(0x13b)]['logWhiteDomainRequest'](_0x43c4c9(0x127),_0x43c4c9(0xd5),_0x43c4c9(0xcd),_0x42656f);const _0x452160=await fetch(this[_0x43c4c9(0x12a)],{'method':_0x43c4c9(0xcd),'headers':{'Content-Type':_0x43c4c9(0x12c),'User-Agent':'TesSoft\x20Payment\x20System/1.0'},'body':JSON[_0x43c4c9(0xc6)](_0x42656f)}),_0x441dfc=Date['now']()-_0x3058d9;console[_0x43c4c9(0xed)](_0x43c4c9(0xfc)),console[_0x43c4c9(0xed)](_0x43c4c9(0x104),_0x452160[_0x43c4c9(0xdc)]),console[_0x43c4c9(0xed)](_0x43c4c9(0x11f),_0x452160[_0x43c4c9(0xd7)]),console[_0x43c4c9(0xed)]('Headers:',Object[_0x43c4c9(0xc9)](_0x452160[_0x43c4c9(0xc5)]['entries']())),console['log'](_0x43c4c9(0xda),_0x441dfc+'ms');const _0xf954f4=await _0x452160[_0x43c4c9(0x100)]();console[_0x43c4c9(0xed)](_0x43c4c9(0xe4),_0xf954f4);if(!_0x452160['ok']){console[_0x43c4c9(0xf1)](_0x43c4c9(0x102)),console['error'](_0x43c4c9(0xd2),_0x452160[_0x43c4c9(0xdc)]),console[_0x43c4c9(0xf1)](_0x43c4c9(0x114),_0xf954f4),loggerService_1['loggerService'][_0x43c4c9(0xfd)](_0x43c4c9(0x127),_0x43c4c9(0xd5),_0x452160['status'],_0xf954f4,_0x441dfc),loggerService_1[_0x43c4c9(0x13b)][_0x43c4c9(0xd4)](_0x43c4c9(0x127),_0x43c4c9(0xd5),_0x43c4c9(0x12b)+_0x452160[_0x43c4c9(0xdc)]+':\x20'+_0xf954f4);throw new Error(_0x43c4c9(0xf3)+_0x452160[_0x43c4c9(0xdc)]+_0x43c4c9(0x128)+_0xf954f4);}let _0x20e18c;try{_0x20e18c=JSON[_0x43c4c9(0xd1)](_0xf954f4);}catch(_0xa2722d){console['error']('Failed\x20to\x20parse\x20JSON\x20response:',_0xa2722d),loggerService_1[_0x43c4c9(0x13b)][_0x43c4c9(0xd4)]('rapyd',_0x43c4c9(0xd5),'JSON\x20Parse\x20Error:\x20'+_0xa2722d);throw new Error(_0x43c4c9(0x122)+_0xf954f4);}console[_0x43c4c9(0xed)](_0x43c4c9(0x12f)),console[_0x43c4c9(0xed)]('Parsed\x20Result:',JSON['stringify'](_0x20e18c,null,0x2)),loggerService_1[_0x43c4c9(0x13b)]['logWhiteDomainResponse'](_0x43c4c9(0x127),_0x43c4c9(0xd5),_0x452160['status'],_0x20e18c,_0x441dfc);if(_0x20e18c[_0x43c4c9(0xdc)]?.['status']!=='SUCCESS'){const _0xefc38=_0x20e18c['status']?.['message']||'Unknown\x20error\x20from\x20Rapyd\x20API',_0x448df2=_0x20e18c[_0x43c4c9(0xdc)]?.[_0x43c4c9(0xf9)]||_0x43c4c9(0xdb);console[_0x43c4c9(0xf1)](_0x43c4c9(0x116)),console[_0x43c4c9(0xf1)](_0x43c4c9(0xcb),_0x448df2),console[_0x43c4c9(0xf1)](_0x43c4c9(0xeb),_0xefc38),console[_0x43c4c9(0xf1)]('Full\x20Error\x20Data:',_0x20e18c['status']),loggerService_1[_0x43c4c9(0x13b)]['logWhiteDomainError'](_0x43c4c9(0x127),'/v1/hosted/payment_links',_0x43c4c9(0xd9)+_0x448df2+_0x43c4c9(0x105)+_0xefc38);throw new Error('Rapyd\x20API\x20error\x20('+_0x448df2+_0x43c4c9(0x105)+_0xefc38);}if(!_0x20e18c['data']?.['id']||!_0x20e18c[_0x43c4c9(0xdd)]?.[_0x43c4c9(0xec)]){console[_0x43c4c9(0xf1)](_0x43c4c9(0xe3)),console[_0x43c4c9(0xf1)](_0x43c4c9(0xcc)),console[_0x43c4c9(0xf1)](_0x43c4c9(0x133),_0x20e18c[_0x43c4c9(0xdd)]),loggerService_1['loggerService'][_0x43c4c9(0xd4)](_0x43c4c9(0x127),_0x43c4c9(0xd5),_0x43c4c9(0xfb));throw new Error('Invalid\x20response\x20from\x20Rapyd\x20API:\x20missing\x20id\x20or\x20redirect_url');}return console[_0x43c4c9(0xed)](_0x43c4c9(0x10e)),console[_0x43c4c9(0xed)](_0x43c4c9(0x121),_0x20e18c[_0x43c4c9(0xdd)]['id']),console[_0x43c4c9(0xed)](_0x43c4c9(0xf7),_0x20e18c[_0x43c4c9(0xdd)][_0x43c4c9(0xec)]),console[_0x43c4c9(0xed)](_0x43c4c9(0xe7)+_0x37481b+_0x43c4c9(0x11d)),console[_0x43c4c9(0xed)]('üí≥\x20Payment\x20Methods:\x20gb_visa_card,\x20gb_mastercard_card'),{'gateway_payment_id':_0x20e18c[_0x43c4c9(0xdd)]['id'],'payment_url':_0x20e18c['data'][_0x43c4c9(0xec)]};}catch(_0xe56c08){console[_0x43c4c9(0xf1)](_0x43c4c9(0x119)),console[_0x43c4c9(0xf1)](_0x43c4c9(0xe9),_0xe56c08),loggerService_1['loggerService']['logWhiteDomainError'](_0x43c4c9(0x127),_0x43c4c9(0xd5),_0xe56c08);if(_0xe56c08 instanceof Error){console['error'](_0x43c4c9(0xd8),_0xe56c08[_0x43c4c9(0xe8)]),console['error'](_0x43c4c9(0xf8),_0xe56c08[_0x43c4c9(0xdf)]);throw new Error(_0x43c4c9(0x115)+_0xe56c08[_0x43c4c9(0xe8)]);}throw new Error(_0x43c4c9(0xcf));}}async[a45_0x548a0f(0xf6)](_0x13586e){const _0x7d7699=a45_0x548a0f,_0x399689=Date['now']();try{loggerService_1[_0x7d7699(0x13b)][_0x7d7699(0x134)]('rapyd',_0x7d7699(0xff)+_0x13586e,'GET',{});const _0x1f6586=await fetch(this[_0x7d7699(0x12a)]+'/'+_0x13586e,{'method':'GET','headers':{'Content-Type':_0x7d7699(0x12c),'User-Agent':_0x7d7699(0xef)}}),_0x5dce1e=Date[_0x7d7699(0xea)]()-_0x399689;if(!_0x1f6586['ok']){const _0x183e14=await _0x1f6586['text']();loggerService_1[_0x7d7699(0x13b)][_0x7d7699(0xfd)](_0x7d7699(0x127),_0x7d7699(0xff)+_0x13586e,_0x1f6586[_0x7d7699(0xdc)],_0x183e14,_0x5dce1e);throw new Error('HTTP\x20error!\x20status:\x20'+_0x1f6586[_0x7d7699(0xdc)]);}const _0x56c574=await _0x1f6586[_0x7d7699(0x106)]();loggerService_1[_0x7d7699(0x13b)][_0x7d7699(0xfd)](_0x7d7699(0x127),_0x7d7699(0xff)+_0x13586e,_0x1f6586[_0x7d7699(0xdc)],_0x56c574,_0x5dce1e);if(_0x56c574[_0x7d7699(0xdc)]?.[_0x7d7699(0xdc)]!==_0x7d7699(0x11b)){loggerService_1[_0x7d7699(0x13b)][_0x7d7699(0xd4)](_0x7d7699(0x127),_0x7d7699(0xff)+_0x13586e,_0x7d7699(0x135)+(_0x56c574['status']?.[_0x7d7699(0xe8)]||_0x7d7699(0x139)));throw new Error(_0x7d7699(0x135)+(_0x56c574[_0x7d7699(0xdc)]?.[_0x7d7699(0xe8)]||_0x7d7699(0x139)));}let _0x3dbf08=_0x7d7699(0x118);if(_0x56c574[_0x7d7699(0xdd)]?.[_0x7d7699(0xdc)])switch(_0x56c574[_0x7d7699(0xdd)][_0x7d7699(0xdc)][_0x7d7699(0xc7)]()){case _0x7d7699(0xfa):_0x3dbf08=_0x7d7699(0xe1);break;case _0x7d7699(0x13f):_0x3dbf08=_0x7d7699(0x10a);break;case _0x7d7699(0x10b):_0x3dbf08='EXPIRED';break;case _0x7d7699(0x108):_0x3dbf08=_0x7d7699(0x10a);break;case _0x7d7699(0xf0):case _0x7d7699(0x110):default:_0x3dbf08=_0x7d7699(0x118);break;}return{'status':_0x3dbf08,'amount':_0x56c574[_0x7d7699(0xdd)]?.['amount'],'currency':_0x56c574[_0x7d7699(0xdd)]?.[_0x7d7699(0x101)]};}catch(_0x3b4637){console[_0x7d7699(0xf1)](_0x7d7699(0xd6),_0x3b4637),loggerService_1[_0x7d7699(0x13b)][_0x7d7699(0xd4)](_0x7d7699(0x127),_0x7d7699(0xff)+_0x13586e,_0x3b4637);throw new Error(_0x7d7699(0x103)+(_0x3b4637 instanceof Error?_0x3b4637['message']:_0x7d7699(0x139)));}}async[a45_0x548a0f(0xce)](_0x4d42bd){const _0x2a9878=a45_0x548a0f;console['log'](_0x2a9878(0x112),_0x4d42bd);let _0xf27f80=_0x2a9878(0x118),_0x66a8f0;_0x4d42bd[_0x2a9878(0xdd)]?.['failure_message']&&(_0x66a8f0=_0x4d42bd[_0x2a9878(0xdd)][_0x2a9878(0x113)],console[_0x2a9878(0xed)](_0x2a9878(0xf5)+_0x66a8f0));switch(_0x4d42bd['type']?.[_0x2a9878(0xc7)]()){case _0x2a9878(0xc8):_0x4d42bd[_0x2a9878(0xdd)]?.[_0x2a9878(0xe0)]===!![]&&_0x4d42bd[_0x2a9878(0xdd)]?.[_0x2a9878(0xdc)]===_0x2a9878(0xfa)?_0xf27f80=_0x2a9878(0xe1):_0xf27f80=_0x2a9878(0x118);break;case _0x2a9878(0xde):_0xf27f80=_0x2a9878(0x10a);break;case _0x2a9878(0x13c):_0xf27f80=_0x2a9878(0xd3);break;case'PAYMENT_FAILED':_0xf27f80=_0x2a9878(0x10a);!_0x66a8f0&&_0x4d42bd[_0x2a9878(0xdd)]?.['failure_message']&&(_0x66a8f0=_0x4d42bd[_0x2a9878(0xdd)][_0x2a9878(0x113)]);break;default:switch(_0x4d42bd[_0x2a9878(0xdd)]?.[_0x2a9878(0xdc)]?.[_0x2a9878(0xc7)]()){case _0x2a9878(0xfa):_0x4d42bd[_0x2a9878(0xdd)]?.['paid']===!![]?_0xf27f80=_0x2a9878(0xe1):_0xf27f80=_0x2a9878(0x10a);break;case _0x2a9878(0x13f):_0xf27f80=_0x2a9878(0x10a);break;case _0x2a9878(0x10b):_0xf27f80=_0x2a9878(0xd3);break;case _0x2a9878(0x108):_0xf27f80=_0x2a9878(0x10a);!_0x66a8f0&&_0x4d42bd['data']?.[_0x2a9878(0x113)]&&(_0x66a8f0=_0x4d42bd['data'][_0x2a9878(0x113)]);break;case _0x2a9878(0xf0):case _0x2a9878(0x110):default:_0xf27f80=_0x2a9878(0x118);break;}break;}const _0x2f00fe={};return _0x4d42bd[_0x2a9878(0xdd)]?.[_0x2a9878(0x125)]?.[_0x2a9878(0x10d)]&&(_0x2f00fe[_0x2a9878(0x142)]=_0x4d42bd[_0x2a9878(0xdd)][_0x2a9878(0x125)][_0x2a9878(0x10d)]),_0x4d42bd['data']?.[_0x2a9878(0xf2)]&&(_0x2f00fe[_0x2a9878(0x11a)]=_0x4d42bd[_0x2a9878(0xdd)][_0x2a9878(0xf2)]),_0x4d42bd[_0x2a9878(0xdd)]?.[_0x2a9878(0xf9)]&&(_0x2f00fe[_0x2a9878(0xd0)]=_0x4d42bd[_0x2a9878(0xdd)][_0x2a9878(0xf9)]),_0x4d42bd[_0x2a9878(0xdd)]?.[_0x2a9878(0xee)]&&(_0x2f00fe[_0x2a9878(0x132)]=_0x4d42bd[_0x2a9878(0xdd)][_0x2a9878(0xee)]),console[_0x2a9878(0xed)](_0x2a9878(0x107)+_0xf27f80+_0x2a9878(0x11c)+(_0x66a8f0||_0x2a9878(0x12d))),{'paymentId':_0x4d42bd[_0x2a9878(0xdd)]?.[_0x2a9878(0xe6)]||'','status':_0xf27f80,'amount':_0x4d42bd[_0x2a9878(0xdd)]?.[_0x2a9878(0x11e)],'currency':_0x4d42bd[_0x2a9878(0xdd)]?.[_0x2a9878(0x101)],'failureMessage':_0x66a8f0,'additionalInfo':_0x2f00fe};}}exports['RapydService']=RapydService;