'use strict';function a48_0x4119(){const _0x49cf83=['Error\x20message:','redirect_url','Response\x20data:','RapydService','\x20(always\x20GB\x20for\x20Rapyd)','===\x20RAPYD\x20API\x20REQUEST\x20(White\x20Domain\x20-\x20Updated\x20Format)\x20===','logWhiteDomainError','35847oGNgsv','https://tesoft.uk/gateway/fail.php?id=','Error\x20Code:','failure_code','\x20\x20\x20requested_currency:\x20EUR','💥\x20Rapyd\x20failure\x20message:\x20','Unknown\x20error','gb_mastercard_card','🌐\x20Rapyd\x20service\x20initialized\x20with\x20white\x20domain\x20proxy','\x20->\x20EUR:','stack','===\x20RAPYD\x20SERVICE\x20ERROR\x20===','parse','Invalid\x20JSON\x20response\x20from\x20Rapyd\x20API:\x20','EXP','Missing\x20id\x20or\x20redirect_url\x20in\x20response','../loggerService','data','UNKNOWN','loggerService','🔄\x20Rapyd\x20webhook\x20processed:\x20status=','floor','Redirect\x20URL:','Failed\x20to\x20parse\x20JSON\x20response:','stringify','expiration','/v1/hosted/payment_links','payment_method_type','PAYMENT_EXPIRED','URL:','paymentMethod','toUpperCase','Rapyd\x20API\x20error\x20(','Parsed\x20Result:','Raw\x20Response\x20Body:','PAYMENT_COMPLETED','logWhiteDomainResponse','808AAWUzP','Failed\x20to\x20create\x20Rapyd\x20payment\x20link:\x20','💱\x20Adding\x20currency\x20conversion\x20fields\x20for\x20','Error\x20stack:','fixed_side','https://tesoft.uk/gateway/rapyd/','EXPIRED','log','803142piIrzT','buy','Payment\x20Link\x20ID:','payment_method_data','ERR','failureCode','6434071zUegbe','cardLast4','6VbxRbZ','FAILED','2362435BTUuXV','Full\x20Error\x20Data:','merchant_reference_id','https://tesoft.uk/gateway/success.php?id=','CLO','💳\x20Payment\x20Methods:\x20gb_visa_card,\x20gb_mastercard_card','2498820rAbAsX','ACT','gb_visa_card','Unknown\x20error\x20from\x20Rapyd\x20API','Request\x20Body\x20(Updated\x20Format):','HTTP\x20Status:','last4',',\x20body:\x20','Incomplete\x20response:\x20missing\x20id\x20or\x20redirect_url','PAYMENT_CANCELED','Status\x20Text:','POST','ORDER:\x20','GET','Rapyd\x20API\x20error:\x20','defineProperty','paid','JSON\x20Parse\x20Error:\x20','failure_message','===\x20RAPYD\x20API\x20ERROR\x20===','2610FVFizE','PENDING','\x20(GB\x20-\x20Britain)','rapyd','Status:','15021402rlNlAo','PAYMENT_FAILED','message','===\x20RAPYD\x20API\x20BUSINESS\x20ERROR\x20===','Failed\x20to\x20verify\x20Rapyd\x20payment:\x20','now','===\x20RAPYD\x20API\x20RESPONSE\x20(White\x20Domain)\x20===','NEW','fromEntries','logWhiteDomainRequest','\x20\x20\x20expiration:\x20','Response\x20Body:','json','SUCCESS','Error\x20Message:','error_code','text','Rapyd\x20payment\x20verification\x20error:','):\x20','HTTP\x20error!\x20status:\x20','application/json','error','apiUrl','1144RwkDvF','EUR','CAN','4wzyTnL','TesSoft\x20Payment\x20System/1.0','/v1/hosted/payment_links/','status','Business\x20Error\x20(','PAID','===\x20RAPYD\x20API\x20INCOMPLETE\x20RESPONSE\x20===','requested_currency','Headers:','__esModule','amount'];a48_0x4119=function(){return _0x49cf83;};return a48_0x4119();}const a48_0x113b5c=a48_0x4893;(function(_0x861ba4,_0x717f8d){const _0x4c6ef0=a48_0x4893,_0x5beed2=_0x861ba4();while(!![]){try{const _0x3cff53=parseInt(_0x4c6ef0(0x218))/0x1+parseInt(_0x4c6ef0(0x1d6))/0x2*(parseInt(_0x4c6ef0(0x23c))/0x3)+parseInt(_0x4c6ef0(0x1d9))/0x4*(parseInt(_0x4c6ef0(0x222))/0x5)+-parseInt(_0x4c6ef0(0x220))/0x6*(-parseInt(_0x4c6ef0(0x21e))/0x7)+parseInt(_0x4c6ef0(0x210))/0x8*(-parseInt(_0x4c6ef0(0x1eb))/0x9)+-parseInt(_0x4c6ef0(0x228))/0xa+-parseInt(_0x4c6ef0(0x241))/0xb;if(_0x3cff53===_0x717f8d)break;else _0x5beed2['push'](_0x5beed2['shift']());}catch(_0x572cc6){_0x5beed2['push'](_0x5beed2['shift']());}}}(a48_0x4119,0xa4b73));function a48_0x4893(_0x1a5e93,_0x5c43b9){const _0x411902=a48_0x4119();return a48_0x4893=function(_0x4893ff,_0x27088c){_0x4893ff=_0x4893ff-0x1c7;let _0x211ea2=_0x411902[_0x4893ff];return _0x211ea2;},a48_0x4893(_0x1a5e93,_0x5c43b9);}Object[a48_0x113b5c(0x237)](exports,a48_0x113b5c(0x1e2),{'value':!![]}),exports[a48_0x113b5c(0x1e7)]=void 0x0;const loggerService_1=require(a48_0x113b5c(0x1fb));class RapydService{constructor(){const _0x357cde=a48_0x113b5c;this['apiUrl']=_0x357cde(0x215),console[_0x357cde(0x217)](_0x357cde(0x1f3));}async['createPaymentLink'](_0x2652f3){const _0x4bd6e3=a48_0x113b5c,{orderId:_0x1bcb11,orderName:_0x3366ec,amount:_0x2940f2,currency:_0x464e32,usage:_0x5dffe5,maxPayments:_0x1d9ba4,successUrl:_0x2bbf1d,failUrl:_0x2de188}=_0x2652f3,_0x2d2790=_0x464e32['toUpperCase'](),_0x20842f='GB';console[_0x4bd6e3(0x217)]('🇬🇧\x20Using\x20GB\x20(Britain)\x20as\x20country\x20for\x20Rapyd\x20payment\x20link');const _0x32b756=_0x4bd6e3(0x225)+_0x1bcb11,_0x5c127f=_0x4bd6e3(0x1ec)+_0x1bcb11,_0x1be2fc={'amount':_0x2940f2,'currency':_0x2d2790,'cancel_checkout_url':_0x5c127f,'complete_checkout_url':_0x32b756,'complete_payment_url':_0x32b756,'merchant_reference_id':_0x1bcb11,'description':_0x4bd6e3(0x234)+_0x1bcb11,'country':'GB','payment_method_types_include':[_0x4bd6e3(0x22a),_0x4bd6e3(0x1f2)],'custom_elements':{'display_description':!![]}};if(_0x2d2790!==_0x4bd6e3(0x1d7)){const _0x4cb65c=Math[_0x4bd6e3(0x200)](Date[_0x4bd6e3(0x246)]()/0x3e8)+0x1e*0x3c;_0x1be2fc[_0x4bd6e3(0x214)]=_0x4bd6e3(0x219),_0x1be2fc[_0x4bd6e3(0x1e0)]='EUR',_0x1be2fc[_0x4bd6e3(0x204)]=_0x4cb65c,console[_0x4bd6e3(0x217)](_0x4bd6e3(0x212)+_0x2d2790+_0x4bd6e3(0x1f4)),console['log']('\x20\x20\x20fixed_side:\x20buy'),console[_0x4bd6e3(0x217)](_0x4bd6e3(0x1ef)),console[_0x4bd6e3(0x217)](_0x4bd6e3(0x1c9)+_0x4cb65c+'\x20('+new Date(_0x4cb65c*0x3e8)['toISOString']()+')');}const _0x300134=Date[_0x4bd6e3(0x246)]();try{console[_0x4bd6e3(0x217)](_0x4bd6e3(0x1e9)),console[_0x4bd6e3(0x217)](_0x4bd6e3(0x208),this[_0x4bd6e3(0x1d5)]),console[_0x4bd6e3(0x217)](_0x4bd6e3(0x22c),JSON[_0x4bd6e3(0x203)](_0x1be2fc,null,0x2)),console['log']('🇬🇧\x20Country:\x20'+_0x20842f+_0x4bd6e3(0x1e8)),console[_0x4bd6e3(0x217)](_0x4bd6e3(0x227)),loggerService_1[_0x4bd6e3(0x1fe)][_0x4bd6e3(0x1c8)](_0x4bd6e3(0x23f),_0x4bd6e3(0x205),_0x4bd6e3(0x233),_0x1be2fc);const _0x2370aa=await fetch(this['apiUrl'],{'method':_0x4bd6e3(0x233),'headers':{'Content-Type':_0x4bd6e3(0x1d3),'User-Agent':'TesSoft\x20Payment\x20System/1.0'},'body':JSON[_0x4bd6e3(0x203)](_0x1be2fc)}),_0x793e8e=Date[_0x4bd6e3(0x246)]()-_0x300134;console['log'](_0x4bd6e3(0x247)),console['log'](_0x4bd6e3(0x240),_0x2370aa[_0x4bd6e3(0x1dc)]),console[_0x4bd6e3(0x217)](_0x4bd6e3(0x232),_0x2370aa['statusText']),console[_0x4bd6e3(0x217)](_0x4bd6e3(0x1e1),Object[_0x4bd6e3(0x1c7)](_0x2370aa['headers']['entries']())),console['log']('Response\x20Time:',_0x793e8e+'ms');const _0x5e76a6=await _0x2370aa[_0x4bd6e3(0x1cf)]();console[_0x4bd6e3(0x217)](_0x4bd6e3(0x20d),_0x5e76a6);if(!_0x2370aa['ok']){console[_0x4bd6e3(0x1d4)](_0x4bd6e3(0x23b)),console[_0x4bd6e3(0x1d4)](_0x4bd6e3(0x22d),_0x2370aa[_0x4bd6e3(0x1dc)]),console[_0x4bd6e3(0x1d4)](_0x4bd6e3(0x1ca),_0x5e76a6),loggerService_1['loggerService'][_0x4bd6e3(0x20f)](_0x4bd6e3(0x23f),_0x4bd6e3(0x205),_0x2370aa['status'],_0x5e76a6,_0x793e8e),loggerService_1[_0x4bd6e3(0x1fe)]['logWhiteDomainError'](_0x4bd6e3(0x23f),_0x4bd6e3(0x205),'HTTP\x20'+_0x2370aa['status']+':\x20'+_0x5e76a6);throw new Error(_0x4bd6e3(0x1d2)+_0x2370aa[_0x4bd6e3(0x1dc)]+_0x4bd6e3(0x22f)+_0x5e76a6);}let _0x2b7e28;try{_0x2b7e28=JSON[_0x4bd6e3(0x1f7)](_0x5e76a6);}catch(_0x21104d){console['error'](_0x4bd6e3(0x202),_0x21104d),loggerService_1['loggerService'][_0x4bd6e3(0x1ea)](_0x4bd6e3(0x23f),_0x4bd6e3(0x205),_0x4bd6e3(0x239)+_0x21104d);throw new Error(_0x4bd6e3(0x1f8)+_0x5e76a6);}console[_0x4bd6e3(0x217)]('===\x20PARSED\x20RAPYD\x20RESPONSE\x20==='),console[_0x4bd6e3(0x217)](_0x4bd6e3(0x20c),JSON['stringify'](_0x2b7e28,null,0x2)),loggerService_1[_0x4bd6e3(0x1fe)][_0x4bd6e3(0x20f)](_0x4bd6e3(0x23f),'/v1/hosted/payment_links',_0x2370aa[_0x4bd6e3(0x1dc)],_0x2b7e28,_0x793e8e);if(_0x2b7e28[_0x4bd6e3(0x1dc)]?.[_0x4bd6e3(0x1dc)]!==_0x4bd6e3(0x1cc)){const _0x2401d0=_0x2b7e28[_0x4bd6e3(0x1dc)]?.[_0x4bd6e3(0x243)]||_0x4bd6e3(0x22b),_0x79b24c=_0x2b7e28['status']?.[_0x4bd6e3(0x1ce)]||_0x4bd6e3(0x1fd);console[_0x4bd6e3(0x1d4)](_0x4bd6e3(0x244)),console['error'](_0x4bd6e3(0x1ed),_0x79b24c),console[_0x4bd6e3(0x1d4)](_0x4bd6e3(0x1cd),_0x2401d0),console['error'](_0x4bd6e3(0x223),_0x2b7e28['status']),loggerService_1['loggerService'][_0x4bd6e3(0x1ea)](_0x4bd6e3(0x23f),'/v1/hosted/payment_links',_0x4bd6e3(0x1dd)+_0x79b24c+_0x4bd6e3(0x1d1)+_0x2401d0);throw new Error(_0x4bd6e3(0x20b)+_0x79b24c+_0x4bd6e3(0x1d1)+_0x2401d0);}if(!_0x2b7e28[_0x4bd6e3(0x1fc)]?.['id']||!_0x2b7e28[_0x4bd6e3(0x1fc)]?.['redirect_url']){console[_0x4bd6e3(0x1d4)](_0x4bd6e3(0x1df)),console[_0x4bd6e3(0x1d4)](_0x4bd6e3(0x1fa)),console[_0x4bd6e3(0x1d4)](_0x4bd6e3(0x1e6),_0x2b7e28[_0x4bd6e3(0x1fc)]),loggerService_1[_0x4bd6e3(0x1fe)][_0x4bd6e3(0x1ea)](_0x4bd6e3(0x23f),_0x4bd6e3(0x205),_0x4bd6e3(0x230));throw new Error('Invalid\x20response\x20from\x20Rapyd\x20API:\x20missing\x20id\x20or\x20redirect_url');}return console[_0x4bd6e3(0x217)]('===\x20RAPYD\x20SUCCESS\x20==='),console[_0x4bd6e3(0x217)](_0x4bd6e3(0x21a),_0x2b7e28[_0x4bd6e3(0x1fc)]['id']),console[_0x4bd6e3(0x217)](_0x4bd6e3(0x201),_0x2b7e28[_0x4bd6e3(0x1fc)][_0x4bd6e3(0x1e5)]),console[_0x4bd6e3(0x217)]('🇬🇧\x20Country\x20used:\x20'+_0x20842f+_0x4bd6e3(0x23e)),console[_0x4bd6e3(0x217)]('💳\x20Payment\x20Methods:\x20gb_visa_card,\x20gb_mastercard_card'),{'gateway_payment_id':_0x2b7e28[_0x4bd6e3(0x1fc)]['id'],'payment_url':_0x2b7e28[_0x4bd6e3(0x1fc)][_0x4bd6e3(0x1e5)]};}catch(_0x1c8d1e){console[_0x4bd6e3(0x1d4)](_0x4bd6e3(0x1f6)),console[_0x4bd6e3(0x1d4)]('Error\x20details:',_0x1c8d1e),loggerService_1[_0x4bd6e3(0x1fe)][_0x4bd6e3(0x1ea)](_0x4bd6e3(0x23f),_0x4bd6e3(0x205),_0x1c8d1e);if(_0x1c8d1e instanceof Error){console[_0x4bd6e3(0x1d4)](_0x4bd6e3(0x1e4),_0x1c8d1e[_0x4bd6e3(0x243)]),console[_0x4bd6e3(0x1d4)](_0x4bd6e3(0x213),_0x1c8d1e[_0x4bd6e3(0x1f5)]);throw new Error(_0x4bd6e3(0x211)+_0x1c8d1e[_0x4bd6e3(0x243)]);}throw new Error('Failed\x20to\x20create\x20Rapyd\x20payment\x20link:\x20Unknown\x20error');}}async['verifyPayment'](_0x3114c4){const _0x387d07=a48_0x113b5c,_0x2b6909=Date[_0x387d07(0x246)]();try{loggerService_1['loggerService'][_0x387d07(0x1c8)]('rapyd',_0x387d07(0x1db)+_0x3114c4,'GET',{});const _0x48d536=await fetch(this[_0x387d07(0x1d5)]+'/'+_0x3114c4,{'method':_0x387d07(0x235),'headers':{'Content-Type':_0x387d07(0x1d3),'User-Agent':_0x387d07(0x1da)}}),_0xf5069=Date[_0x387d07(0x246)]()-_0x2b6909;if(!_0x48d536['ok']){const _0x5d9aa6=await _0x48d536[_0x387d07(0x1cf)]();loggerService_1['loggerService'][_0x387d07(0x20f)](_0x387d07(0x23f),_0x387d07(0x1db)+_0x3114c4,_0x48d536[_0x387d07(0x1dc)],_0x5d9aa6,_0xf5069);throw new Error(_0x387d07(0x1d2)+_0x48d536[_0x387d07(0x1dc)]);}const _0x3e4098=await _0x48d536[_0x387d07(0x1cb)]();loggerService_1['loggerService'][_0x387d07(0x20f)](_0x387d07(0x23f),'/v1/hosted/payment_links/'+_0x3114c4,_0x48d536[_0x387d07(0x1dc)],_0x3e4098,_0xf5069);if(_0x3e4098[_0x387d07(0x1dc)]?.[_0x387d07(0x1dc)]!==_0x387d07(0x1cc)){loggerService_1[_0x387d07(0x1fe)]['logWhiteDomainError']('rapyd',_0x387d07(0x1db)+_0x3114c4,_0x387d07(0x236)+(_0x3e4098[_0x387d07(0x1dc)]?.[_0x387d07(0x243)]||_0x387d07(0x1f1)));throw new Error('Rapyd\x20API\x20error:\x20'+(_0x3e4098[_0x387d07(0x1dc)]?.['message']||'Unknown\x20error'));}let _0x32030e=_0x387d07(0x23d);if(_0x3e4098[_0x387d07(0x1fc)]?.[_0x387d07(0x1dc)])switch(_0x3e4098[_0x387d07(0x1fc)][_0x387d07(0x1dc)][_0x387d07(0x20a)]()){case _0x387d07(0x226):_0x32030e='PAID';break;case _0x387d07(0x1d8):_0x32030e=_0x387d07(0x221);break;case _0x387d07(0x1f9):_0x32030e=_0x387d07(0x216);break;case'ERR':_0x32030e=_0x387d07(0x221);break;case _0x387d07(0x248):case'ACT':default:_0x32030e=_0x387d07(0x23d);break;}return{'status':_0x32030e,'amount':_0x3e4098[_0x387d07(0x1fc)]?.[_0x387d07(0x1e3)],'currency':_0x3e4098['data']?.['currency']};}catch(_0x5788fd){console[_0x387d07(0x1d4)](_0x387d07(0x1d0),_0x5788fd),loggerService_1[_0x387d07(0x1fe)][_0x387d07(0x1ea)](_0x387d07(0x23f),_0x387d07(0x1db)+_0x3114c4,_0x5788fd);throw new Error(_0x387d07(0x245)+(_0x5788fd instanceof Error?_0x5788fd[_0x387d07(0x243)]:_0x387d07(0x1f1)));}}async['processWebhook'](_0x25c846){const _0x25c3c5=a48_0x113b5c;console['log']('Processing\x20Rapyd\x20webhook:',_0x25c846);let _0x198026=_0x25c3c5(0x23d),_0x1322df;_0x25c846[_0x25c3c5(0x1fc)]?.['failure_message']&&(_0x1322df=_0x25c846[_0x25c3c5(0x1fc)][_0x25c3c5(0x23a)],console[_0x25c3c5(0x217)](_0x25c3c5(0x1f0)+_0x1322df));switch(_0x25c846['type']?.['toUpperCase']()){case _0x25c3c5(0x20e):_0x25c846[_0x25c3c5(0x1fc)]?.[_0x25c3c5(0x238)]===!![]&&_0x25c846[_0x25c3c5(0x1fc)]?.['status']==='CLO'?_0x198026=_0x25c3c5(0x1de):_0x198026=_0x25c3c5(0x23d);break;case _0x25c3c5(0x231):_0x198026=_0x25c3c5(0x221);break;case _0x25c3c5(0x207):_0x198026=_0x25c3c5(0x216);break;case _0x25c3c5(0x242):_0x198026=_0x25c3c5(0x221);!_0x1322df&&_0x25c846[_0x25c3c5(0x1fc)]?.[_0x25c3c5(0x23a)]&&(_0x1322df=_0x25c846['data']['failure_message']);break;default:switch(_0x25c846[_0x25c3c5(0x1fc)]?.[_0x25c3c5(0x1dc)]?.[_0x25c3c5(0x20a)]()){case'CLO':_0x25c846[_0x25c3c5(0x1fc)]?.[_0x25c3c5(0x238)]===!![]?_0x198026=_0x25c3c5(0x1de):_0x198026=_0x25c3c5(0x221);break;case _0x25c3c5(0x1d8):_0x198026=_0x25c3c5(0x221);break;case _0x25c3c5(0x1f9):_0x198026=_0x25c3c5(0x216);break;case _0x25c3c5(0x21c):_0x198026=_0x25c3c5(0x221);!_0x1322df&&_0x25c846[_0x25c3c5(0x1fc)]?.[_0x25c3c5(0x23a)]&&(_0x1322df=_0x25c846[_0x25c3c5(0x1fc)][_0x25c3c5(0x23a)]);break;case'NEW':case _0x25c3c5(0x229):default:_0x198026='PENDING';break;}break;}const _0x53f741={};return _0x25c846[_0x25c3c5(0x1fc)]?.[_0x25c3c5(0x21b)]?.[_0x25c3c5(0x22e)]&&(_0x53f741[_0x25c3c5(0x21f)]=_0x25c846['data'][_0x25c3c5(0x21b)][_0x25c3c5(0x22e)]),_0x25c846['data']?.[_0x25c3c5(0x206)]&&(_0x53f741[_0x25c3c5(0x209)]=_0x25c846[_0x25c3c5(0x1fc)][_0x25c3c5(0x206)]),_0x25c846['data']?.[_0x25c3c5(0x1ce)]&&(_0x53f741['errorCode']=_0x25c846[_0x25c3c5(0x1fc)][_0x25c3c5(0x1ce)]),_0x25c846[_0x25c3c5(0x1fc)]?.[_0x25c3c5(0x1ee)]&&(_0x53f741[_0x25c3c5(0x21d)]=_0x25c846['data'][_0x25c3c5(0x1ee)]),console[_0x25c3c5(0x217)](_0x25c3c5(0x1ff)+_0x198026+',\x20failureMessage='+(_0x1322df||'none')),{'paymentId':_0x25c846[_0x25c3c5(0x1fc)]?.[_0x25c3c5(0x224)]||'','status':_0x198026,'amount':_0x25c846[_0x25c3c5(0x1fc)]?.[_0x25c3c5(0x1e3)],'currency':_0x25c846['data']?.['currency'],'failureMessage':_0x1322df,'additionalInfo':_0x53f741};}}exports[a48_0x113b5c(0x1e7)]=RapydService;