'use strict';const a42_0x41e8d7=a42_0x188a;(function(_0x4c7a1f,_0x3b599e){const _0x1ffbdc=a42_0x188a,_0x2e5c45=_0x4c7a1f();while(!![]){try{const _0x588d2e=parseInt(_0x1ffbdc(0x123))/0x1*(parseInt(_0x1ffbdc(0x121))/0x2)+-parseInt(_0x1ffbdc(0x161))/0x3+parseInt(_0x1ffbdc(0x152))/0x4*(parseInt(_0x1ffbdc(0x16d))/0x5)+parseInt(_0x1ffbdc(0x17d))/0x6*(-parseInt(_0x1ffbdc(0x13d))/0x7)+parseInt(_0x1ffbdc(0x14b))/0x8+parseInt(_0x1ffbdc(0x122))/0x9+-parseInt(_0x1ffbdc(0x17c))/0xa*(-parseInt(_0x1ffbdc(0x15e))/0xb);if(_0x588d2e===_0x3b599e)break;else _0x2e5c45['push'](_0x2e5c45['shift']());}catch(_0x22f53e){_0x2e5c45['push'](_0x2e5c45['shift']());}}}(a42_0x5840,0x5fd47));function a42_0x5840(){const _0x45cabd=['Processing\x20Rapyd\x20webhook:','headers','logWhiteDomainResponse','message','fixed_side','):\x20','PAYMENT_EXPIRED','üåê\x20Rapyd\x20service\x20initialized\x20with\x20white\x20domain\x20proxy','https://tesoft.uk/gateway/rapyd/','Unknown\x20error\x20from\x20Rapyd\x20API','Status\x20Text:','904760XNUjAl','510zxKoGo','GET','currency','error_code','apiUrl','EXP','Request\x20Body\x20(Updated\x20Format):','ACT','CAN','CLO','HTTP\x20','PAYMENT_CANCELED','verifyPayment','FAILED','===\x20RAPYD\x20API\x20RESPONSE\x20(White\x20Domain)\x20===','Invalid\x20JSON\x20response\x20from\x20Rapyd\x20API:\x20','Missing\x20id\x20or\x20redirect_url\x20in\x20response','Response\x20Body:','Rapyd\x20API\x20error:\x20','Redirect\x20URL:','Error\x20stack:','RapydService','UNKNOWN','stringify','now','18402VkcsQA','2932650jXxeBy','10MlrDOF','POST','Failed\x20to\x20create\x20Rapyd\x20payment\x20link:\x20','Error\x20Code:','loggerService','logWhiteDomainRequest','Response\x20Time:','===\x20PARSED\x20RAPYD\x20RESPONSE\x20===','https://tesoft.uk/gateway/success.php?id=','stack','Full\x20Error\x20Data:','redirect_url','merchant_reference_id','error','data','Error\x20details:','parse','Response\x20data:','HTTP\x20error!\x20status:\x20','Failed\x20to\x20verify\x20Rapyd\x20payment:\x20','\x20(GB\x20-\x20Britain)','status','sell','EUR','/v1/hosted/payment_links','statusText','40082VUmoOj','amount','/v1/hosted/payment_links/','Failed\x20to\x20parse\x20JSON\x20response:','EXPIRED','Business\x20Error\x20(','logWhiteDomainError','SUCCESS','===\x20RAPYD\x20API\x20REQUEST\x20(White\x20Domain\x20-\x20Updated\x20Format)\x20===','\x20(always\x20GB\x20for\x20Rapyd)','requested_currency','Payment\x20Link\x20ID:','Invalid\x20response\x20from\x20Rapyd\x20API:\x20missing\x20id\x20or\x20redirect_url','entries','124944VTdckM','NEW','rapyd','ORDER:\x20','paid','gb_mastercard_card','===\x20RAPYD\x20SERVICE\x20ERROR\x20===','448oztJJA','log','===\x20RAPYD\x20API\x20INCOMPLETE\x20RESPONSE\x20===','PENDING','https://tesoft.uk/gateway/fail.php?id=','Rapyd\x20API\x20error\x20(','PAYMENT_FAILED','üí≥\x20Payment\x20Methods:\x20gb_visa_card,\x20gb_mastercard_card','üá¨üáß\x20Country:\x20','application/json','PAYMENT_COMPLETED','__esModule','121miMgVw','===\x20RAPYD\x20API\x20BUSINESS\x20ERROR\x20===','Incomplete\x20response:\x20missing\x20id\x20or\x20redirect_url','1993863mKGlFl','Failed\x20to\x20create\x20Rapyd\x20payment\x20link:\x20Unknown\x20error','text','PAID','TesSoft\x20Payment\x20System/1.0','Error\x20message:','===\x20RAPYD\x20API\x20ERROR\x20===','gb_visa_card','json','toUpperCase',',\x20body:\x20','Unknown\x20error','5140XWVALt','../loggerService','ERR','type'];a42_0x5840=function(){return _0x45cabd;};return a42_0x5840();}Object['defineProperty'](exports,a42_0x41e8d7(0x15d),{'value':!![]}),exports[a42_0x41e8d7(0x11d)]=void 0x0;function a42_0x188a(_0x33304f,_0x4ad72a){const _0x5840cb=a42_0x5840();return a42_0x188a=function(_0x188a58,_0xac539e){_0x188a58=_0x188a58-0x11c;let _0x731628=_0x5840cb[_0x188a58];return _0x731628;},a42_0x188a(_0x33304f,_0x4ad72a);}const loggerService_1=require(a42_0x41e8d7(0x16e));class RapydService{constructor(){const _0x269715=a42_0x41e8d7;this[_0x269715(0x181)]=_0x269715(0x179),console['log'](_0x269715(0x178));}async['createPaymentLink'](_0x2d398f){const _0x2192d1=a42_0x41e8d7,{orderId:_0x281e0f,orderName:_0x2baad0,amount:_0x3e07b1,currency:_0x3d837b,usage:_0x578cff,maxPayments:_0x298b91,successUrl:_0x454919,failUrl:_0x431b69}=_0x2d398f,_0x53f70e=_0x3d837b[_0x2192d1(0x16a)](),_0x3d7483='GB';console['log']('üá¨üáß\x20Using\x20GB\x20(Britain)\x20as\x20country\x20for\x20Rapyd\x20payment\x20link');const _0x35aeed=_0x2192d1(0x12b)+_0x281e0f,_0x113f1a=_0x2192d1(0x156)+_0x281e0f,_0xf8d385={'amount':_0x3e07b1,'currency':_0x53f70e,'cancel_checkout_url':_0x113f1a,'complete_checkout_url':_0x35aeed,'complete_payment_url':_0x35aeed,'merchant_reference_id':_0x281e0f,'description':_0x2192d1(0x14e)+_0x281e0f,'country':'GB','payment_method_types_include':[_0x2192d1(0x168),_0x2192d1(0x150)],'custom_elements':{'display_description':!![]}};_0x53f70e!==_0x2192d1(0x13a)&&(_0xf8d385[_0x2192d1(0x147)]=_0x53f70e,_0xf8d385[_0x2192d1(0x175)]=_0x2192d1(0x139));const _0x303ac2=Date[_0x2192d1(0x120)]();try{console[_0x2192d1(0x153)](_0x2192d1(0x145)),console[_0x2192d1(0x153)]('URL:',this[_0x2192d1(0x181)]),console[_0x2192d1(0x153)](_0x2192d1(0x183),JSON['stringify'](_0xf8d385,null,0x2)),console[_0x2192d1(0x153)](_0x2192d1(0x15a)+_0x3d7483+_0x2192d1(0x146)),console[_0x2192d1(0x153)](_0x2192d1(0x159)),loggerService_1['loggerService'][_0x2192d1(0x128)](_0x2192d1(0x14d),'/v1/hosted/payment_links',_0x2192d1(0x124),_0xf8d385);const _0x11473a=await fetch(this['apiUrl'],{'method':'POST','headers':{'Content-Type':_0x2192d1(0x15b),'User-Agent':_0x2192d1(0x165)},'body':JSON[_0x2192d1(0x11f)](_0xf8d385)}),_0x2012c2=Date[_0x2192d1(0x120)]()-_0x303ac2;console['log'](_0x2192d1(0x18b)),console[_0x2192d1(0x153)]('Status:',_0x11473a[_0x2192d1(0x138)]),console[_0x2192d1(0x153)](_0x2192d1(0x17b),_0x11473a[_0x2192d1(0x13c)]),console['log']('Headers:',Object['fromEntries'](_0x11473a[_0x2192d1(0x172)][_0x2192d1(0x14a)]())),console[_0x2192d1(0x153)](_0x2192d1(0x129),_0x2012c2+'ms');const _0x19c58a=await _0x11473a[_0x2192d1(0x163)]();console['log']('Raw\x20Response\x20Body:',_0x19c58a);if(!_0x11473a['ok']){console['error'](_0x2192d1(0x167)),console[_0x2192d1(0x130)]('HTTP\x20Status:',_0x11473a[_0x2192d1(0x138)]),console[_0x2192d1(0x130)](_0x2192d1(0x18e),_0x19c58a),loggerService_1[_0x2192d1(0x127)][_0x2192d1(0x173)](_0x2192d1(0x14d),_0x2192d1(0x13b),_0x11473a[_0x2192d1(0x138)],_0x19c58a,_0x2012c2),loggerService_1['loggerService'][_0x2192d1(0x143)](_0x2192d1(0x14d),_0x2192d1(0x13b),_0x2192d1(0x187)+_0x11473a[_0x2192d1(0x138)]+':\x20'+_0x19c58a);throw new Error(_0x2192d1(0x135)+_0x11473a[_0x2192d1(0x138)]+_0x2192d1(0x16b)+_0x19c58a);}let _0x530c1a;try{_0x530c1a=JSON[_0x2192d1(0x133)](_0x19c58a);}catch(_0xb136c3){console[_0x2192d1(0x130)](_0x2192d1(0x140),_0xb136c3),loggerService_1[_0x2192d1(0x127)][_0x2192d1(0x143)]('rapyd','/v1/hosted/payment_links','JSON\x20Parse\x20Error:\x20'+_0xb136c3);throw new Error(_0x2192d1(0x18c)+_0x19c58a);}console[_0x2192d1(0x153)](_0x2192d1(0x12a)),console[_0x2192d1(0x153)]('Parsed\x20Result:',JSON[_0x2192d1(0x11f)](_0x530c1a,null,0x2)),loggerService_1[_0x2192d1(0x127)]['logWhiteDomainResponse'](_0x2192d1(0x14d),_0x2192d1(0x13b),_0x11473a[_0x2192d1(0x138)],_0x530c1a,_0x2012c2);if(_0x530c1a[_0x2192d1(0x138)]?.[_0x2192d1(0x138)]!==_0x2192d1(0x144)){const _0x30838d=_0x530c1a[_0x2192d1(0x138)]?.[_0x2192d1(0x174)]||_0x2192d1(0x17a),_0x2339e1=_0x530c1a[_0x2192d1(0x138)]?.[_0x2192d1(0x180)]||_0x2192d1(0x11e);console[_0x2192d1(0x130)](_0x2192d1(0x15f)),console[_0x2192d1(0x130)](_0x2192d1(0x126),_0x2339e1),console[_0x2192d1(0x130)]('Error\x20Message:',_0x30838d),console[_0x2192d1(0x130)](_0x2192d1(0x12d),_0x530c1a[_0x2192d1(0x138)]),loggerService_1[_0x2192d1(0x127)][_0x2192d1(0x143)](_0x2192d1(0x14d),_0x2192d1(0x13b),_0x2192d1(0x142)+_0x2339e1+'):\x20'+_0x30838d);throw new Error(_0x2192d1(0x157)+_0x2339e1+_0x2192d1(0x176)+_0x30838d);}if(!_0x530c1a[_0x2192d1(0x131)]?.['id']||!_0x530c1a[_0x2192d1(0x131)]?.['redirect_url']){console[_0x2192d1(0x130)](_0x2192d1(0x154)),console['error'](_0x2192d1(0x18d)),console[_0x2192d1(0x130)](_0x2192d1(0x134),_0x530c1a[_0x2192d1(0x131)]),loggerService_1[_0x2192d1(0x127)][_0x2192d1(0x143)](_0x2192d1(0x14d),_0x2192d1(0x13b),_0x2192d1(0x160));throw new Error(_0x2192d1(0x149));}return console['log']('===\x20RAPYD\x20SUCCESS\x20==='),console['log'](_0x2192d1(0x148),_0x530c1a[_0x2192d1(0x131)]['id']),console[_0x2192d1(0x153)](_0x2192d1(0x190),_0x530c1a['data'][_0x2192d1(0x12e)]),console[_0x2192d1(0x153)]('üá¨üáß\x20Country\x20used:\x20'+_0x3d7483+_0x2192d1(0x137)),console[_0x2192d1(0x153)]('üí≥\x20Payment\x20Methods:\x20gb_visa_card,\x20gb_mastercard_card'),{'gateway_payment_id':_0x530c1a[_0x2192d1(0x131)]['id'],'payment_url':_0x530c1a['data'][_0x2192d1(0x12e)]};}catch(_0x2e3209){console[_0x2192d1(0x130)](_0x2192d1(0x151)),console[_0x2192d1(0x130)](_0x2192d1(0x132),_0x2e3209),loggerService_1[_0x2192d1(0x127)][_0x2192d1(0x143)](_0x2192d1(0x14d),'/v1/hosted/payment_links',_0x2e3209);if(_0x2e3209 instanceof Error){console[_0x2192d1(0x130)](_0x2192d1(0x166),_0x2e3209[_0x2192d1(0x174)]),console[_0x2192d1(0x130)](_0x2192d1(0x11c),_0x2e3209[_0x2192d1(0x12c)]);throw new Error(_0x2192d1(0x125)+_0x2e3209[_0x2192d1(0x174)]);}throw new Error(_0x2192d1(0x162));}}async[a42_0x41e8d7(0x189)](_0x888f45){const _0x39bdc1=a42_0x41e8d7,_0x59cb89=Date[_0x39bdc1(0x120)]();try{loggerService_1[_0x39bdc1(0x127)]['logWhiteDomainRequest'](_0x39bdc1(0x14d),'/v1/hosted/payment_links/'+_0x888f45,_0x39bdc1(0x17e),{});const _0x5439c2=await fetch(this[_0x39bdc1(0x181)]+'/'+_0x888f45,{'method':_0x39bdc1(0x17e),'headers':{'Content-Type':_0x39bdc1(0x15b),'User-Agent':'TesSoft\x20Payment\x20System/1.0'}}),_0x241b0e=Date[_0x39bdc1(0x120)]()-_0x59cb89;if(!_0x5439c2['ok']){const _0x20ff46=await _0x5439c2[_0x39bdc1(0x163)]();loggerService_1[_0x39bdc1(0x127)]['logWhiteDomainResponse'](_0x39bdc1(0x14d),_0x39bdc1(0x13f)+_0x888f45,_0x5439c2[_0x39bdc1(0x138)],_0x20ff46,_0x241b0e);throw new Error(_0x39bdc1(0x135)+_0x5439c2['status']);}const _0x309f7f=await _0x5439c2[_0x39bdc1(0x169)]();loggerService_1[_0x39bdc1(0x127)][_0x39bdc1(0x173)](_0x39bdc1(0x14d),'/v1/hosted/payment_links/'+_0x888f45,_0x5439c2[_0x39bdc1(0x138)],_0x309f7f,_0x241b0e);if(_0x309f7f['status']?.[_0x39bdc1(0x138)]!==_0x39bdc1(0x144)){loggerService_1[_0x39bdc1(0x127)][_0x39bdc1(0x143)](_0x39bdc1(0x14d),_0x39bdc1(0x13f)+_0x888f45,_0x39bdc1(0x18f)+(_0x309f7f['status']?.[_0x39bdc1(0x174)]||_0x39bdc1(0x16c)));throw new Error(_0x39bdc1(0x18f)+(_0x309f7f['status']?.[_0x39bdc1(0x174)]||'Unknown\x20error'));}let _0x4694d4='PENDING';if(_0x309f7f[_0x39bdc1(0x131)]?.[_0x39bdc1(0x138)])switch(_0x309f7f[_0x39bdc1(0x131)][_0x39bdc1(0x138)]['toUpperCase']()){case _0x39bdc1(0x186):_0x4694d4=_0x39bdc1(0x164);break;case'CAN':_0x4694d4=_0x39bdc1(0x18a);break;case _0x39bdc1(0x182):_0x4694d4=_0x39bdc1(0x141);break;case'ERR':_0x4694d4=_0x39bdc1(0x18a);break;case _0x39bdc1(0x14c):case _0x39bdc1(0x184):default:_0x4694d4=_0x39bdc1(0x155);break;}return{'status':_0x4694d4,'amount':_0x309f7f[_0x39bdc1(0x131)]?.[_0x39bdc1(0x13e)],'currency':_0x309f7f[_0x39bdc1(0x131)]?.[_0x39bdc1(0x17f)]};}catch(_0x3c3e06){console['error']('Rapyd\x20payment\x20verification\x20error:',_0x3c3e06),loggerService_1['loggerService'][_0x39bdc1(0x143)]('rapyd',_0x39bdc1(0x13f)+_0x888f45,_0x3c3e06);throw new Error(_0x39bdc1(0x136)+(_0x3c3e06 instanceof Error?_0x3c3e06['message']:_0x39bdc1(0x16c)));}}async['processWebhook'](_0x4e7e5f){const _0x273a47=a42_0x41e8d7;console['log'](_0x273a47(0x171),_0x4e7e5f);let _0x47752e=_0x273a47(0x155);switch(_0x4e7e5f[_0x273a47(0x170)]?.[_0x273a47(0x16a)]()){case _0x273a47(0x15c):_0x4e7e5f[_0x273a47(0x131)]?.['paid']===!![]&&_0x4e7e5f['data']?.[_0x273a47(0x138)]===_0x273a47(0x186)?_0x47752e=_0x273a47(0x164):_0x47752e=_0x273a47(0x155);break;case _0x273a47(0x188):_0x47752e='FAILED';break;case _0x273a47(0x177):_0x47752e=_0x273a47(0x141);break;case _0x273a47(0x158):_0x47752e=_0x273a47(0x18a);break;default:switch(_0x4e7e5f[_0x273a47(0x131)]?.[_0x273a47(0x138)]?.[_0x273a47(0x16a)]()){case _0x273a47(0x186):_0x4e7e5f[_0x273a47(0x131)]?.[_0x273a47(0x14f)]===!![]?_0x47752e=_0x273a47(0x164):_0x47752e=_0x273a47(0x18a);break;case _0x273a47(0x185):_0x47752e=_0x273a47(0x18a);break;case _0x273a47(0x182):_0x47752e=_0x273a47(0x141);break;case _0x273a47(0x16f):_0x47752e=_0x273a47(0x18a);break;case _0x273a47(0x14c):case _0x273a47(0x184):default:_0x47752e=_0x273a47(0x155);break;}break;}return{'paymentId':_0x4e7e5f[_0x273a47(0x131)]?.[_0x273a47(0x12f)]||'','status':_0x47752e,'amount':_0x4e7e5f[_0x273a47(0x131)]?.[_0x273a47(0x13e)],'currency':_0x4e7e5f[_0x273a47(0x131)]?.[_0x273a47(0x17f)]};}}exports[a42_0x41e8d7(0x11d)]=RapydService;