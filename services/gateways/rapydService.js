'use strict';const a56_0x19e993=a56_0x4092;function a56_0x5829(){const _0x35d282=['CLO','requested_currency','Error\x20message:','logWhiteDomainResponse','payment_method_data','now','\x20\x20\x20expiration:\x20','apiUrl','../loggerService','logWhiteDomainError','error_code','===\x20RAPYD\x20API\x20ERROR\x20===','\x20(GB\x20-\x20Britain)','failureCode','GET','Raw\x20Response\x20Body:','Failed\x20to\x20verify\x20Rapyd\x20payment:\x20','currency','EXPIRED','2447648AGAIUx','paid','CAN','error','PAYMENT_EXPIRED','HTTP\x20Status:','===\x20RAPYD\x20SERVICE\x20ERROR\x20===','Failed\x20to\x20parse\x20JSON\x20response:','UNKNOWN','EUR','Status\x20Text:','payment_method_type','PAYMENT_FAILED','RapydService','Error\x20Message:','fromEntries','ERR','ORDER:\x20','text','URL:','application/json','https://tesoft.uk/gateway/success.php?id=','message','/v1/hosted/payment_links','merchant_reference_id','Response\x20data:','2548950ZMaVGE','8228700ArNYRq','Full\x20Error\x20Data:','parse','headers','status','Unknown\x20error','Error\x20details:','🇬🇧\x20Using\x20GB\x20(Britain)\x20as\x20country\x20for\x20Rapyd\x20payment\x20link','Failed\x20to\x20create\x20Rapyd\x20payment\x20link:\x20Unknown\x20error','POST','processWebhook','redirect_url','Payment\x20Link\x20ID:','\x20\x20\x20requested_currency:\x20EUR','EXP','rapyd','Parsed\x20Result:','HTTP\x20','verifyPayment','Invalid\x20JSON\x20response\x20from\x20Rapyd\x20API:\x20','errorCode','failure_code','log','JSON\x20Parse\x20Error:\x20','PAID','buy','Invalid\x20response\x20from\x20Rapyd\x20API:\x20missing\x20id\x20or\x20redirect_url','138mpXrzQ','https://tesoft.uk/gateway/fail.php?id=','1CEDLHp','gb_mastercard_card','🌐\x20Rapyd\x20service\x20initialized\x20with\x20white\x20domain\x20proxy','loggerService','1177TwzcoX','gb_visa_card','===\x20RAPYD\x20API\x20BUSINESS\x20ERROR\x20===','https://tesoft.uk/gateway/rapyd/','Failed\x20to\x20create\x20Rapyd\x20payment\x20link:\x20','NEW','275177bHVvZi','stringify','Payment\x20System/1.0','PAYMENT_COMPLETED','last4','Missing\x20id\x20or\x20redirect_url\x20in\x20response','floor','💳\x20Payment\x20Methods:\x20gb_visa_card,\x20gb_mastercard_card','stack','119350FeDwnW','Business\x20Error\x20(','\x20\x20\x20fixed_side:\x20buy','SUCCESS','===\x20PARSED\x20RAPYD\x20RESPONSE\x20===','PAYMENT_CANCELED','===\x20RAPYD\x20API\x20RESPONSE\x20(White\x20Domain)\x20===','/v1/hosted/payment_links/','Headers:','1901150QlIVLG','===\x20RAPYD\x20API\x20INCOMPLETE\x20RESPONSE\x20===','Response\x20Body:','data','statusText','Rapyd\x20API\x20error\x20(','none','Rapyd\x20API\x20error:\x20','Response\x20Time:','paymentMethod','Error\x20stack:','Redirect\x20URL:','Unknown\x20error\x20from\x20Rapyd\x20API','toUpperCase','Incomplete\x20response:\x20missing\x20id\x20or\x20redirect_url','failure_message','4loXZyJ','2386045Qqhvpd','FAILED','===\x20RAPYD\x20SUCCESS\x20===','PENDING','cardLast4','amount','Request\x20Body\x20(Updated\x20Format):','\x20->\x20EUR:','type','):\x20',',\x20failureMessage='];a56_0x5829=function(){return _0x35d282;};return a56_0x5829();}(function(_0x1bc759,_0x19c97f){const _0x517bb1=a56_0x4092,_0x42ddab=_0x1bc759();while(!![]){try{const _0x23275c=-parseInt(_0x517bb1(0xdb))/0x1*(-parseInt(_0x517bb1(0xf7))/0x2)+parseInt(_0x517bb1(0xbd))/0x3+parseInt(_0x517bb1(0x107))/0x4*(-parseInt(_0x517bb1(0x108))/0x5)+parseInt(_0x517bb1(0xd9))/0x6*(-parseInt(_0x517bb1(0xe5))/0x7)+-parseInt(_0x517bb1(0xa3))/0x8+-parseInt(_0x517bb1(0xbe))/0x9+-parseInt(_0x517bb1(0xee))/0xa*(-parseInt(_0x517bb1(0xdf))/0xb);if(_0x23275c===_0x19c97f)break;else _0x42ddab['push'](_0x42ddab['shift']());}catch(_0x550d77){_0x42ddab['push'](_0x42ddab['shift']());}}}(a56_0x5829,0x74204));Object['defineProperty'](exports,'__esModule',{'value':!![]}),exports['RapydService']=void 0x0;const loggerService_1=require(a56_0x19e993(0x98));class RapydService{constructor(){const _0x336a15=a56_0x19e993;this[_0x336a15(0x11a)]=_0x336a15(0xe2),console[_0x336a15(0xd4)](_0x336a15(0xdd));}async['createPaymentLink'](_0x3aea50){const _0x1bdd39=a56_0x19e993,{orderId:_0x2a8325,orderName:_0x268fde,amount:_0x152872,currency:_0x521d02,usage:_0x495ad7,maxPayments:_0x1a0547,successUrl:_0x125cfb,failUrl:_0x57e89b}=_0x3aea50,_0x173771=_0x521d02['toUpperCase'](),_0x54632a='GB';console[_0x1bdd39(0xd4)](_0x1bdd39(0xc5));const _0x142dd0=_0x1bdd39(0xb8)+_0x2a8325,_0x1a84fd=_0x1bdd39(0xda)+_0x2a8325,_0x32e454={'amount':_0x152872,'currency':_0x173771,'cancel_checkout_url':_0x1a84fd,'complete_checkout_url':_0x142dd0,'complete_payment_url':_0x142dd0,'merchant_reference_id':_0x2a8325,'description':_0x1bdd39(0xb4)+_0x2a8325,'country':'GB','payment_method_types_include':[_0x1bdd39(0xe0),_0x1bdd39(0xdc)],'custom_elements':{'display_description':!![]}};if(_0x173771!==_0x1bdd39(0xac)){const _0xaa44f9=Math[_0x1bdd39(0xeb)](Date[_0x1bdd39(0x118)]()/0x3e8)+0x1e*0x3c;_0x32e454['fixed_side']=_0x1bdd39(0xd7),_0x32e454[_0x1bdd39(0x114)]=_0x1bdd39(0xac),_0x32e454['expiration']=_0xaa44f9,console[_0x1bdd39(0xd4)]('💱\x20Adding\x20currency\x20conversion\x20fields\x20for\x20'+_0x173771+_0x1bdd39(0x10f)),console[_0x1bdd39(0xd4)](_0x1bdd39(0xf0)),console[_0x1bdd39(0xd4)](_0x1bdd39(0xcb)),console['log'](_0x1bdd39(0x119)+_0xaa44f9+'\x20('+new Date(_0xaa44f9*0x3e8)['toISOString']()+')');}const _0x1a3873=Date[_0x1bdd39(0x118)]();try{console[_0x1bdd39(0xd4)]('===\x20RAPYD\x20API\x20REQUEST\x20(White\x20Domain\x20-\x20Updated\x20Format)\x20==='),console[_0x1bdd39(0xd4)](_0x1bdd39(0xb6),this[_0x1bdd39(0x11a)]),console[_0x1bdd39(0xd4)](_0x1bdd39(0x10e),JSON[_0x1bdd39(0xe6)](_0x32e454,null,0x2)),console['log']('🇬🇧\x20Country:\x20'+_0x54632a+'\x20(always\x20GB\x20for\x20Rapyd)'),console[_0x1bdd39(0xd4)]('💳\x20Payment\x20Methods:\x20gb_visa_card,\x20gb_mastercard_card'),loggerService_1[_0x1bdd39(0xde)]['logWhiteDomainRequest'](_0x1bdd39(0xcd),_0x1bdd39(0xba),_0x1bdd39(0xc7),_0x32e454);const _0x2c2f3c=await fetch(this['apiUrl'],{'method':'POST','headers':{'Content-Type':_0x1bdd39(0xb7),'User-Agent':_0x1bdd39(0xe7)},'body':JSON[_0x1bdd39(0xe6)](_0x32e454)}),_0x3ba075=Date[_0x1bdd39(0x118)]()-_0x1a3873;console['log'](_0x1bdd39(0xf4)),console[_0x1bdd39(0xd4)]('Status:',_0x2c2f3c[_0x1bdd39(0xc2)]),console['log'](_0x1bdd39(0xad),_0x2c2f3c[_0x1bdd39(0xfb)]),console[_0x1bdd39(0xd4)](_0x1bdd39(0xf6),Object[_0x1bdd39(0xb2)](_0x2c2f3c[_0x1bdd39(0xc1)]['entries']())),console[_0x1bdd39(0xd4)](_0x1bdd39(0xff),_0x3ba075+'ms');const _0x1596ec=await _0x2c2f3c[_0x1bdd39(0xb5)]();console[_0x1bdd39(0xd4)](_0x1bdd39(0x9f),_0x1596ec);if(!_0x2c2f3c['ok']){console[_0x1bdd39(0xa6)](_0x1bdd39(0x9b)),console[_0x1bdd39(0xa6)](_0x1bdd39(0xa8),_0x2c2f3c[_0x1bdd39(0xc2)]),console['error'](_0x1bdd39(0xf9),_0x1596ec),loggerService_1['loggerService'][_0x1bdd39(0x116)](_0x1bdd39(0xcd),_0x1bdd39(0xba),_0x2c2f3c[_0x1bdd39(0xc2)],_0x1596ec,_0x3ba075),loggerService_1['loggerService'][_0x1bdd39(0x99)]('rapyd','/v1/hosted/payment_links',_0x1bdd39(0xcf)+_0x2c2f3c[_0x1bdd39(0xc2)]+':\x20'+_0x1596ec);throw new Error('HTTP\x20error!\x20status:\x20'+_0x2c2f3c[_0x1bdd39(0xc2)]+',\x20body:\x20'+_0x1596ec);}let _0x573ea0;try{_0x573ea0=JSON[_0x1bdd39(0xc0)](_0x1596ec);}catch(_0x2ca0b1){console[_0x1bdd39(0xa6)](_0x1bdd39(0xaa),_0x2ca0b1),loggerService_1['loggerService']['logWhiteDomainError']('rapyd',_0x1bdd39(0xba),_0x1bdd39(0xd5)+_0x2ca0b1);throw new Error(_0x1bdd39(0xd1)+_0x1596ec);}console[_0x1bdd39(0xd4)](_0x1bdd39(0xf2)),console[_0x1bdd39(0xd4)](_0x1bdd39(0xce),JSON['stringify'](_0x573ea0,null,0x2)),loggerService_1[_0x1bdd39(0xde)][_0x1bdd39(0x116)](_0x1bdd39(0xcd),'/v1/hosted/payment_links',_0x2c2f3c[_0x1bdd39(0xc2)],_0x573ea0,_0x3ba075);if(_0x573ea0[_0x1bdd39(0xc2)]?.[_0x1bdd39(0xc2)]!==_0x1bdd39(0xf1)){const _0x56814c=_0x573ea0[_0x1bdd39(0xc2)]?.['message']||_0x1bdd39(0x103),_0xa25a8c=_0x573ea0[_0x1bdd39(0xc2)]?.[_0x1bdd39(0x9a)]||_0x1bdd39(0xab);console[_0x1bdd39(0xa6)](_0x1bdd39(0xe1)),console['error']('Error\x20Code:',_0xa25a8c),console['error'](_0x1bdd39(0xb1),_0x56814c),console[_0x1bdd39(0xa6)](_0x1bdd39(0xbf),_0x573ea0[_0x1bdd39(0xc2)]),loggerService_1[_0x1bdd39(0xde)]['logWhiteDomainError'](_0x1bdd39(0xcd),'/v1/hosted/payment_links',_0x1bdd39(0xef)+_0xa25a8c+_0x1bdd39(0x111)+_0x56814c);throw new Error(_0x1bdd39(0xfc)+_0xa25a8c+_0x1bdd39(0x111)+_0x56814c);}if(!_0x573ea0['data']?.['id']||!_0x573ea0[_0x1bdd39(0xfa)]?.[_0x1bdd39(0xc9)]){console[_0x1bdd39(0xa6)](_0x1bdd39(0xf8)),console[_0x1bdd39(0xa6)](_0x1bdd39(0xea)),console['error'](_0x1bdd39(0xbc),_0x573ea0['data']),loggerService_1[_0x1bdd39(0xde)][_0x1bdd39(0x99)]('rapyd',_0x1bdd39(0xba),_0x1bdd39(0x105));throw new Error(_0x1bdd39(0xd8));}return console[_0x1bdd39(0xd4)](_0x1bdd39(0x10a)),console[_0x1bdd39(0xd4)](_0x1bdd39(0xca),_0x573ea0[_0x1bdd39(0xfa)]['id']),console[_0x1bdd39(0xd4)](_0x1bdd39(0x102),_0x573ea0[_0x1bdd39(0xfa)][_0x1bdd39(0xc9)]),console['log']('🇬🇧\x20Country\x20used:\x20'+_0x54632a+_0x1bdd39(0x9c)),console['log'](_0x1bdd39(0xec)),{'gateway_payment_id':_0x573ea0[_0x1bdd39(0xfa)]['id'],'payment_url':_0x573ea0[_0x1bdd39(0xfa)][_0x1bdd39(0xc9)]};}catch(_0xfcba3f){console[_0x1bdd39(0xa6)](_0x1bdd39(0xa9)),console[_0x1bdd39(0xa6)](_0x1bdd39(0xc4),_0xfcba3f),loggerService_1['loggerService'][_0x1bdd39(0x99)](_0x1bdd39(0xcd),_0x1bdd39(0xba),_0xfcba3f);if(_0xfcba3f instanceof Error){console[_0x1bdd39(0xa6)](_0x1bdd39(0x115),_0xfcba3f['message']),console[_0x1bdd39(0xa6)](_0x1bdd39(0x101),_0xfcba3f[_0x1bdd39(0xed)]);throw new Error(_0x1bdd39(0xe3)+_0xfcba3f[_0x1bdd39(0xb9)]);}throw new Error(_0x1bdd39(0xc6));}}async[a56_0x19e993(0xd0)](_0x4defe3){const _0x19d281=a56_0x19e993,_0x121ba3=Date[_0x19d281(0x118)]();try{loggerService_1[_0x19d281(0xde)]['logWhiteDomainRequest'](_0x19d281(0xcd),_0x19d281(0xf5)+_0x4defe3,_0x19d281(0x9e),{});const _0x37482e=await fetch(this['apiUrl']+'/'+_0x4defe3,{'method':_0x19d281(0x9e),'headers':{'Content-Type':_0x19d281(0xb7),'User-Agent':_0x19d281(0xe7)}}),_0x5e251c=Date[_0x19d281(0x118)]()-_0x121ba3;if(!_0x37482e['ok']){const _0x538d25=await _0x37482e[_0x19d281(0xb5)]();loggerService_1[_0x19d281(0xde)][_0x19d281(0x116)](_0x19d281(0xcd),_0x19d281(0xf5)+_0x4defe3,_0x37482e[_0x19d281(0xc2)],_0x538d25,_0x5e251c);throw new Error('HTTP\x20error!\x20status:\x20'+_0x37482e[_0x19d281(0xc2)]);}const _0x185536=await _0x37482e['json']();loggerService_1[_0x19d281(0xde)][_0x19d281(0x116)]('rapyd',_0x19d281(0xf5)+_0x4defe3,_0x37482e[_0x19d281(0xc2)],_0x185536,_0x5e251c);if(_0x185536['status']?.[_0x19d281(0xc2)]!=='SUCCESS'){loggerService_1['loggerService']['logWhiteDomainError'](_0x19d281(0xcd),_0x19d281(0xf5)+_0x4defe3,_0x19d281(0xfe)+(_0x185536[_0x19d281(0xc2)]?.[_0x19d281(0xb9)]||_0x19d281(0xc3)));throw new Error(_0x19d281(0xfe)+(_0x185536['status']?.[_0x19d281(0xb9)]||_0x19d281(0xc3)));}let _0x347a06=_0x19d281(0x10b);if(_0x185536['data']?.[_0x19d281(0xc2)])switch(_0x185536[_0x19d281(0xfa)]['status'][_0x19d281(0x104)]()){case'CLO':_0x347a06='PAID';break;case _0x19d281(0xa5):_0x347a06='FAILED';break;case _0x19d281(0xcc):_0x347a06=_0x19d281(0xa2);break;case'ERR':_0x347a06='FAILED';break;case'NEW':case'ACT':default:_0x347a06=_0x19d281(0x10b);break;}return{'status':_0x347a06,'amount':_0x185536[_0x19d281(0xfa)]?.[_0x19d281(0x10d)],'currency':_0x185536['data']?.[_0x19d281(0xa1)]};}catch(_0x3d9004){console[_0x19d281(0xa6)]('Rapyd\x20payment\x20verification\x20error:',_0x3d9004),loggerService_1[_0x19d281(0xde)][_0x19d281(0x99)](_0x19d281(0xcd),_0x19d281(0xf5)+_0x4defe3,_0x3d9004);throw new Error(_0x19d281(0xa0)+(_0x3d9004 instanceof Error?_0x3d9004[_0x19d281(0xb9)]:_0x19d281(0xc3)));}}async[a56_0x19e993(0xc8)](_0x5369e2){const _0x3c1b45=a56_0x19e993;console[_0x3c1b45(0xd4)]('Processing\x20Rapyd\x20webhook:',_0x5369e2);let _0x4f17b9='PENDING',_0xaacef9;_0x5369e2[_0x3c1b45(0xfa)]?.['failure_message']&&(_0xaacef9=_0x5369e2['data'][_0x3c1b45(0x106)],console[_0x3c1b45(0xd4)]('💥\x20Rapyd\x20failure\x20message:\x20'+_0xaacef9));switch(_0x5369e2[_0x3c1b45(0x110)]?.[_0x3c1b45(0x104)]()){case _0x3c1b45(0xe8):_0x5369e2[_0x3c1b45(0xfa)]?.['paid']===!![]&&_0x5369e2[_0x3c1b45(0xfa)]?.['status']===_0x3c1b45(0x113)?_0x4f17b9=_0x3c1b45(0xd6):_0x4f17b9='PENDING';break;case _0x3c1b45(0xf3):_0x4f17b9=_0x3c1b45(0x109);break;case _0x3c1b45(0xa7):_0x4f17b9=_0x3c1b45(0xa2);break;case _0x3c1b45(0xaf):_0x4f17b9=_0x3c1b45(0x109);!_0xaacef9&&_0x5369e2[_0x3c1b45(0xfa)]?.[_0x3c1b45(0x106)]&&(_0xaacef9=_0x5369e2[_0x3c1b45(0xfa)][_0x3c1b45(0x106)]);break;default:switch(_0x5369e2[_0x3c1b45(0xfa)]?.[_0x3c1b45(0xc2)]?.[_0x3c1b45(0x104)]()){case _0x3c1b45(0x113):_0x5369e2[_0x3c1b45(0xfa)]?.[_0x3c1b45(0xa4)]===!![]?_0x4f17b9=_0x3c1b45(0xd6):_0x4f17b9='FAILED';break;case _0x3c1b45(0xa5):_0x4f17b9=_0x3c1b45(0x109);break;case'EXP':_0x4f17b9=_0x3c1b45(0xa2);break;case _0x3c1b45(0xb3):_0x4f17b9=_0x3c1b45(0x109);!_0xaacef9&&_0x5369e2[_0x3c1b45(0xfa)]?.[_0x3c1b45(0x106)]&&(_0xaacef9=_0x5369e2[_0x3c1b45(0xfa)][_0x3c1b45(0x106)]);break;case _0x3c1b45(0xe4):case'ACT':default:_0x4f17b9=_0x3c1b45(0x10b);break;}break;}const _0x4c24ea={};return _0x5369e2[_0x3c1b45(0xfa)]?.[_0x3c1b45(0x117)]?.['last4']&&(_0x4c24ea[_0x3c1b45(0x10c)]=_0x5369e2['data'][_0x3c1b45(0x117)][_0x3c1b45(0xe9)]),_0x5369e2['data']?.[_0x3c1b45(0xae)]&&(_0x4c24ea[_0x3c1b45(0x100)]=_0x5369e2['data'][_0x3c1b45(0xae)]),_0x5369e2[_0x3c1b45(0xfa)]?.['error_code']&&(_0x4c24ea[_0x3c1b45(0xd2)]=_0x5369e2[_0x3c1b45(0xfa)]['error_code']),_0x5369e2[_0x3c1b45(0xfa)]?.['failure_code']&&(_0x4c24ea[_0x3c1b45(0x9d)]=_0x5369e2[_0x3c1b45(0xfa)][_0x3c1b45(0xd3)]),console['log']('🔄\x20Rapyd\x20webhook\x20processed:\x20status='+_0x4f17b9+_0x3c1b45(0x112)+(_0xaacef9||_0x3c1b45(0xfd))),{'paymentId':_0x5369e2['data']?.[_0x3c1b45(0xbb)]||'','status':_0x4f17b9,'amount':_0x5369e2[_0x3c1b45(0xfa)]?.['amount'],'currency':_0x5369e2[_0x3c1b45(0xfa)]?.[_0x3c1b45(0xa1)],'failureMessage':_0xaacef9,'additionalInfo':_0x4c24ea};}}function a56_0x4092(_0x2d50dc,_0x3ecb32){const _0x582956=a56_0x5829();return a56_0x4092=function(_0x4092d4,_0x32490b){_0x4092d4=_0x4092d4-0x98;let _0x2079f6=_0x582956[_0x4092d4];return _0x2079f6;},a56_0x4092(_0x2d50dc,_0x3ecb32);}exports[a56_0x19e993(0xb0)]=RapydService;