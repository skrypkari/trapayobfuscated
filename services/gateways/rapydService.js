'use strict';const a42_0x34be5b=a42_0x53b6;function a42_0x53b6(_0x1fa322,_0x393cbb){const _0x1ac708=a42_0x1ac7();return a42_0x53b6=function(_0x53b65a,_0x1d8721){_0x53b65a=_0x53b65a-0xad;let _0x243632=_0x1ac708[_0x53b65a];return _0x243632;},a42_0x53b6(_0x1fa322,_0x393cbb);}(function(_0x30f17d,_0x130d4f){const _0x563f4b=a42_0x53b6,_0x55eadf=_0x30f17d();while(!![]){try{const _0x73a1d7=-parseInt(_0x563f4b(0xec))/0x1*(-parseInt(_0x563f4b(0xeb))/0x2)+-parseInt(_0x563f4b(0xc2))/0x3*(-parseInt(_0x563f4b(0xba))/0x4)+parseInt(_0x563f4b(0xd8))/0x5*(-parseInt(_0x563f4b(0xb6))/0x6)+-parseInt(_0x563f4b(0xb3))/0x7*(-parseInt(_0x563f4b(0xc9))/0x8)+parseInt(_0x563f4b(0xca))/0x9+parseInt(_0x563f4b(0xcf))/0xa*(parseInt(_0x563f4b(0xf6))/0xb)+parseInt(_0x563f4b(0xc3))/0xc;if(_0x73a1d7===_0x130d4f)break;else _0x55eadf['push'](_0x55eadf['shift']());}catch(_0x1a336b){_0x55eadf['push'](_0x55eadf['shift']());}}}(a42_0x1ac7,0xace67));Object[a42_0x34be5b(0x118)](exports,'__esModule',{'value':!![]}),exports[a42_0x34be5b(0xf7)]=void 0x0;function a42_0x1ac7(){const _0x3e79ac=['POST','error','388jSnwIt','Error\x20details:','message',',\x20body:\x20','ERR','Rapyd\x20payment\x20verification\x20error:','now','===\x20PARSED\x20RAPYD\x20RESPONSE\x20===','153DpdBSF','1786236KQApUt','PAYMENT_CANCELED','PAYMENT_COMPLETED','===\x20RAPYD\x20API\x20ERROR\x20===','text','status','128tgnJMo','8559351YjFMFy','redirect_url','parse','Headers:','Error\x20message:','1487470EFbzoj','processWebhook','log','JSON\x20Parse\x20Error:\x20','Unknown\x20error\x20from\x20Rapyd\x20API','TesSoft\x20Payment\x20System/1.0','Failed\x20to\x20create\x20Rapyd\x20payment\x20link:\x20','rapyd','entries','445zLuTjZ','Rapyd\x20API\x20error\x20(','Unknown\x20error','Status:','stringify','PENDING','\x20(GB\x20-\x20Britain)','/v1/hosted/payment_links/','ORDER:\x20','currency','Failed\x20to\x20verify\x20Rapyd\x20payment:\x20','paid','):\x20','Response\x20Time:','gb_visa_card','PAID','https://tesoft.uk/gateway/fail.php?id=','üá¨üáß\x20Using\x20GB\x20(Britain)\x20as\x20country\x20for\x20Rapyd\x20payment\x20link','SUCCESS','707840LbTqWw','2OzncBd','logWhiteDomainError','Processing\x20Rapyd\x20webhook:','CLO','fromEntries','../loggerService','apiUrl','amount','NEW','Invalid\x20response\x20from\x20Rapyd\x20API:\x20missing\x20id\x20or\x20redirect_url','11IygxzQ','RapydService','logWhiteDomainRequest','logWhiteDomainResponse','Full\x20Error\x20Data:','PAYMENT_EXPIRED','Incomplete\x20response:\x20missing\x20id\x20or\x20redirect_url','Request\x20Body\x20(Updated\x20Format):','createPaymentLink','statusText','CAN','loggerService','error_code','PAYMENT_FAILED','https://tesoft.uk/gateway/success.php?id=','Error\x20stack:','Response\x20Body:','Parsed\x20Result:','type','Rapyd\x20API\x20error:\x20','data','HTTP\x20Status:','Payment\x20Link\x20ID:','Error\x20Code:','ACT','HTTP\x20error!\x20status:\x20','Business\x20Error\x20(','FAILED','application/json','===\x20RAPYD\x20API\x20REQUEST\x20(White\x20Domain\x20-\x20Updated\x20Format)\x20===','EXP','URL:','EXPIRED','Raw\x20Response\x20Body:','defineProperty','verifyPayment','headers','Redirect\x20URL:','/v1/hosted/payment_links','üá¨üáß\x20Country\x20used:\x20','Failed\x20to\x20parse\x20JSON\x20response:','Missing\x20id\x20or\x20redirect_url\x20in\x20response','HTTP\x20','===\x20RAPYD\x20API\x20BUSINESS\x20ERROR\x20===','üí≥\x20Payment\x20Methods:\x20gb_visa_card,\x20gb_mastercard_card','41188gHWYxO','merchant_reference_id','toUpperCase','90834zWbFkl','json'];a42_0x1ac7=function(){return _0x3e79ac;};return a42_0x1ac7();}const loggerService_1=require(a42_0x34be5b(0xf1));class RapydService{constructor(){const _0xa78d9c=a42_0x34be5b;this[_0xa78d9c(0xf2)]='https://tesoft.uk/gateway/rapyd/',console[_0xa78d9c(0xd1)]('üåê\x20Rapyd\x20service\x20initialized\x20with\x20white\x20domain\x20proxy');}async[a42_0x34be5b(0xfe)](_0x3fa106){const _0x4e7aa9=a42_0x34be5b,{orderId:_0x1a75a7,orderName:_0x420d04,amount:_0x49be8d,currency:_0x2a4bc5,usage:_0x29bc04,maxPayments:_0x186b24,successUrl:_0x4dc90f,failUrl:_0x888524}=_0x3fa106,_0xbdd5f3=_0x2a4bc5[_0x4e7aa9(0xb5)](),_0x3f5189='GB';console[_0x4e7aa9(0xd1)](_0x4e7aa9(0xe9));const _0x1f7d43=_0x4e7aa9(0x104)+_0x1a75a7,_0x3b942c=_0x4e7aa9(0xe8)+_0x1a75a7,_0x32033e={'amount':_0x49be8d,'currency':_0xbdd5f3,'cancel_checkout_url':_0x3b942c,'complete_checkout_url':_0x1f7d43,'complete_payment_url':_0x1f7d43,'merchant_reference_id':_0x1a75a7,'description':_0x4e7aa9(0xe0)+_0x1a75a7,'country':'GB','payment_method_types_include':[_0x4e7aa9(0xe6),'gb_mastercard_card'],'custom_elements':{'display_description':!![]}},_0x37985c=Date['now']();try{console[_0x4e7aa9(0xd1)](_0x4e7aa9(0x113)),console['log'](_0x4e7aa9(0x115),this['apiUrl']),console[_0x4e7aa9(0xd1)](_0x4e7aa9(0xfd),JSON[_0x4e7aa9(0xdc)](_0x32033e,null,0x2)),console['log']('üá¨üáß\x20Country:\x20'+_0x3f5189+'\x20(always\x20GB\x20for\x20Rapyd)'),console[_0x4e7aa9(0xd1)](_0x4e7aa9(0xb2)),loggerService_1[_0x4e7aa9(0x101)][_0x4e7aa9(0xf8)]('rapyd',_0x4e7aa9(0x11c),_0x4e7aa9(0xb8),_0x32033e);const _0x2edade=await fetch(this['apiUrl'],{'method':_0x4e7aa9(0xb8),'headers':{'Content-Type':_0x4e7aa9(0x112),'User-Agent':_0x4e7aa9(0xd4)},'body':JSON['stringify'](_0x32033e)}),_0x3b78f0=Date[_0x4e7aa9(0xc0)]()-_0x37985c;console['log']('===\x20RAPYD\x20API\x20RESPONSE\x20(White\x20Domain)\x20==='),console[_0x4e7aa9(0xd1)](_0x4e7aa9(0xdb),_0x2edade[_0x4e7aa9(0xc8)]),console[_0x4e7aa9(0xd1)]('Status\x20Text:',_0x2edade[_0x4e7aa9(0xff)]),console[_0x4e7aa9(0xd1)](_0x4e7aa9(0xcd),Object[_0x4e7aa9(0xf0)](_0x2edade[_0x4e7aa9(0x11a)][_0x4e7aa9(0xd7)]())),console[_0x4e7aa9(0xd1)](_0x4e7aa9(0xe5),_0x3b78f0+'ms');const _0x2f997a=await _0x2edade[_0x4e7aa9(0xc7)]();console[_0x4e7aa9(0xd1)](_0x4e7aa9(0x117),_0x2f997a);if(!_0x2edade['ok']){console['error'](_0x4e7aa9(0xc6)),console[_0x4e7aa9(0xb9)](_0x4e7aa9(0x10b),_0x2edade['status']),console[_0x4e7aa9(0xb9)](_0x4e7aa9(0x106),_0x2f997a),loggerService_1['loggerService'][_0x4e7aa9(0xf9)](_0x4e7aa9(0xd6),_0x4e7aa9(0x11c),_0x2edade[_0x4e7aa9(0xc8)],_0x2f997a,_0x3b78f0),loggerService_1['loggerService']['logWhiteDomainError']('rapyd',_0x4e7aa9(0x11c),_0x4e7aa9(0xb0)+_0x2edade['status']+':\x20'+_0x2f997a);throw new Error('HTTP\x20error!\x20status:\x20'+_0x2edade[_0x4e7aa9(0xc8)]+_0x4e7aa9(0xbd)+_0x2f997a);}let _0x5d1126;try{_0x5d1126=JSON[_0x4e7aa9(0xcc)](_0x2f997a);}catch(_0x4da784){console[_0x4e7aa9(0xb9)](_0x4e7aa9(0xae),_0x4da784),loggerService_1[_0x4e7aa9(0x101)][_0x4e7aa9(0xed)](_0x4e7aa9(0xd6),_0x4e7aa9(0x11c),_0x4e7aa9(0xd2)+_0x4da784);throw new Error('Invalid\x20JSON\x20response\x20from\x20Rapyd\x20API:\x20'+_0x2f997a);}console[_0x4e7aa9(0xd1)](_0x4e7aa9(0xc1)),console['log'](_0x4e7aa9(0x107),JSON[_0x4e7aa9(0xdc)](_0x5d1126,null,0x2)),loggerService_1[_0x4e7aa9(0x101)][_0x4e7aa9(0xf9)](_0x4e7aa9(0xd6),_0x4e7aa9(0x11c),_0x2edade[_0x4e7aa9(0xc8)],_0x5d1126,_0x3b78f0);if(_0x5d1126[_0x4e7aa9(0xc8)]?.[_0x4e7aa9(0xc8)]!==_0x4e7aa9(0xea)){const _0x3e660a=_0x5d1126[_0x4e7aa9(0xc8)]?.[_0x4e7aa9(0xbc)]||_0x4e7aa9(0xd3),_0x37510e=_0x5d1126['status']?.[_0x4e7aa9(0x102)]||'UNKNOWN';console[_0x4e7aa9(0xb9)](_0x4e7aa9(0xb1)),console[_0x4e7aa9(0xb9)](_0x4e7aa9(0x10d),_0x37510e),console[_0x4e7aa9(0xb9)]('Error\x20Message:',_0x3e660a),console[_0x4e7aa9(0xb9)](_0x4e7aa9(0xfa),_0x5d1126[_0x4e7aa9(0xc8)]),loggerService_1['loggerService'][_0x4e7aa9(0xed)](_0x4e7aa9(0xd6),'/v1/hosted/payment_links',_0x4e7aa9(0x110)+_0x37510e+_0x4e7aa9(0xe4)+_0x3e660a);throw new Error(_0x4e7aa9(0xd9)+_0x37510e+'):\x20'+_0x3e660a);}if(!_0x5d1126['data']?.['id']||!_0x5d1126[_0x4e7aa9(0x10a)]?.[_0x4e7aa9(0xcb)]){console[_0x4e7aa9(0xb9)]('===\x20RAPYD\x20API\x20INCOMPLETE\x20RESPONSE\x20==='),console[_0x4e7aa9(0xb9)](_0x4e7aa9(0xaf)),console[_0x4e7aa9(0xb9)]('Response\x20data:',_0x5d1126[_0x4e7aa9(0x10a)]),loggerService_1[_0x4e7aa9(0x101)][_0x4e7aa9(0xed)](_0x4e7aa9(0xd6),_0x4e7aa9(0x11c),_0x4e7aa9(0xfc));throw new Error(_0x4e7aa9(0xf5));}return console[_0x4e7aa9(0xd1)]('===\x20RAPYD\x20SUCCESS\x20==='),console[_0x4e7aa9(0xd1)](_0x4e7aa9(0x10c),_0x5d1126['data']['id']),console[_0x4e7aa9(0xd1)](_0x4e7aa9(0x11b),_0x5d1126['data']['redirect_url']),console[_0x4e7aa9(0xd1)](_0x4e7aa9(0xad)+_0x3f5189+_0x4e7aa9(0xde)),console[_0x4e7aa9(0xd1)](_0x4e7aa9(0xb2)),{'gateway_payment_id':_0x5d1126[_0x4e7aa9(0x10a)]['id'],'payment_url':_0x5d1126[_0x4e7aa9(0x10a)][_0x4e7aa9(0xcb)]};}catch(_0x971cc6){console['error']('===\x20RAPYD\x20SERVICE\x20ERROR\x20==='),console[_0x4e7aa9(0xb9)](_0x4e7aa9(0xbb),_0x971cc6),loggerService_1[_0x4e7aa9(0x101)][_0x4e7aa9(0xed)](_0x4e7aa9(0xd6),_0x4e7aa9(0x11c),_0x971cc6);if(_0x971cc6 instanceof Error){console[_0x4e7aa9(0xb9)](_0x4e7aa9(0xce),_0x971cc6['message']),console[_0x4e7aa9(0xb9)](_0x4e7aa9(0x105),_0x971cc6['stack']);throw new Error(_0x4e7aa9(0xd5)+_0x971cc6[_0x4e7aa9(0xbc)]);}throw new Error('Failed\x20to\x20create\x20Rapyd\x20payment\x20link:\x20Unknown\x20error');}}async[a42_0x34be5b(0x119)](_0xcf8ef6){const _0x1615a9=a42_0x34be5b,_0xe50742=Date[_0x1615a9(0xc0)]();try{loggerService_1[_0x1615a9(0x101)][_0x1615a9(0xf8)]('rapyd','/v1/hosted/payment_links/'+_0xcf8ef6,'GET',{});const _0x5752eb=await fetch(this[_0x1615a9(0xf2)]+'/'+_0xcf8ef6,{'method':'GET','headers':{'Content-Type':_0x1615a9(0x112),'User-Agent':_0x1615a9(0xd4)}}),_0x4b1ce7=Date[_0x1615a9(0xc0)]()-_0xe50742;if(!_0x5752eb['ok']){const _0x5e1efd=await _0x5752eb[_0x1615a9(0xc7)]();loggerService_1['loggerService'][_0x1615a9(0xf9)]('rapyd','/v1/hosted/payment_links/'+_0xcf8ef6,_0x5752eb[_0x1615a9(0xc8)],_0x5e1efd,_0x4b1ce7);throw new Error(_0x1615a9(0x10f)+_0x5752eb[_0x1615a9(0xc8)]);}const _0x1afb69=await _0x5752eb[_0x1615a9(0xb7)]();loggerService_1['loggerService'][_0x1615a9(0xf9)](_0x1615a9(0xd6),_0x1615a9(0xdf)+_0xcf8ef6,_0x5752eb[_0x1615a9(0xc8)],_0x1afb69,_0x4b1ce7);if(_0x1afb69['status']?.[_0x1615a9(0xc8)]!==_0x1615a9(0xea)){loggerService_1['loggerService'][_0x1615a9(0xed)]('rapyd',_0x1615a9(0xdf)+_0xcf8ef6,_0x1615a9(0x109)+(_0x1afb69[_0x1615a9(0xc8)]?.[_0x1615a9(0xbc)]||_0x1615a9(0xda)));throw new Error('Rapyd\x20API\x20error:\x20'+(_0x1afb69[_0x1615a9(0xc8)]?.[_0x1615a9(0xbc)]||_0x1615a9(0xda)));}let _0x2efdba='PENDING';if(_0x1afb69['data']?.['status'])switch(_0x1afb69[_0x1615a9(0x10a)][_0x1615a9(0xc8)]['toUpperCase']()){case _0x1615a9(0xef):_0x2efdba='PAID';break;case _0x1615a9(0x100):_0x2efdba=_0x1615a9(0x111);break;case _0x1615a9(0x114):_0x2efdba=_0x1615a9(0x116);break;case _0x1615a9(0xbe):_0x2efdba=_0x1615a9(0x111);break;case _0x1615a9(0xf4):case _0x1615a9(0x10e):default:_0x2efdba='PENDING';break;}return{'status':_0x2efdba,'amount':_0x1afb69[_0x1615a9(0x10a)]?.[_0x1615a9(0xf3)],'currency':_0x1afb69[_0x1615a9(0x10a)]?.['currency']};}catch(_0x3bb4ec){console['error'](_0x1615a9(0xbf),_0x3bb4ec),loggerService_1[_0x1615a9(0x101)][_0x1615a9(0xed)](_0x1615a9(0xd6),_0x1615a9(0xdf)+_0xcf8ef6,_0x3bb4ec);throw new Error(_0x1615a9(0xe2)+(_0x3bb4ec instanceof Error?_0x3bb4ec[_0x1615a9(0xbc)]:'Unknown\x20error'));}}async[a42_0x34be5b(0xd0)](_0x1ca7c0){const _0x4b1031=a42_0x34be5b;console[_0x4b1031(0xd1)](_0x4b1031(0xee),_0x1ca7c0);let _0x19a831=_0x4b1031(0xdd);switch(_0x1ca7c0[_0x4b1031(0x108)]?.[_0x4b1031(0xb5)]()){case _0x4b1031(0xc5):_0x1ca7c0['data']?.[_0x4b1031(0xe3)]===!![]&&_0x1ca7c0['data']?.[_0x4b1031(0xc8)]===_0x4b1031(0xef)?_0x19a831=_0x4b1031(0xe7):_0x19a831='PENDING';break;case _0x4b1031(0xc4):_0x19a831='FAILED';break;case _0x4b1031(0xfb):_0x19a831='EXPIRED';break;case _0x4b1031(0x103):_0x19a831='FAILED';break;default:switch(_0x1ca7c0[_0x4b1031(0x10a)]?.[_0x4b1031(0xc8)]?.[_0x4b1031(0xb5)]()){case'CLO':_0x1ca7c0[_0x4b1031(0x10a)]?.[_0x4b1031(0xe3)]===!![]?_0x19a831='PAID':_0x19a831=_0x4b1031(0x111);break;case _0x4b1031(0x100):_0x19a831=_0x4b1031(0x111);break;case _0x4b1031(0x114):_0x19a831=_0x4b1031(0x116);break;case _0x4b1031(0xbe):_0x19a831=_0x4b1031(0x111);break;case'NEW':case _0x4b1031(0x10e):default:_0x19a831=_0x4b1031(0xdd);break;}break;}return{'paymentId':_0x1ca7c0[_0x4b1031(0x10a)]?.[_0x4b1031(0xb4)]||'','status':_0x19a831,'amount':_0x1ca7c0['data']?.[_0x4b1031(0xf3)],'currency':_0x1ca7c0['data']?.[_0x4b1031(0xe1)]};}}exports['RapydService']=RapydService;