'use strict';const a45_0x309d70=a45_0x1b31;(function(_0x387b4b,_0x4f72a9){const _0x3cbea0=a45_0x1b31,_0x500686=_0x387b4b();while(!![]){try{const _0x10cad8=parseInt(_0x3cbea0(0x244))/0x1+-parseInt(_0x3cbea0(0x236))/0x2+-parseInt(_0x3cbea0(0x1f1))/0x3+parseInt(_0x3cbea0(0x203))/0x4+-parseInt(_0x3cbea0(0x258))/0x5*(parseInt(_0x3cbea0(0x249))/0x6)+parseInt(_0x3cbea0(0x216))/0x7*(parseInt(_0x3cbea0(0x21d))/0x8)+-parseInt(_0x3cbea0(0x24e))/0x9*(-parseInt(_0x3cbea0(0x211))/0xa);if(_0x10cad8===_0x4f72a9)break;else _0x500686['push'](_0x500686['shift']());}catch(_0x41edb1){_0x500686['push'](_0x500686['shift']());}}}(a45_0x102f,0xe5e32));function a45_0x102f(){const _0x1829e7=['Response\x20Body:','toUpperCase','Processing\x20Rapyd\x20webhook:','RapydService','verifyPayment','processWebhook','POST','Invalid\x20JSON\x20response\x20from\x20Rapyd\x20API:\x20','fromEntries','EXPIRED','headers','Status\x20Text:','gb_visa_card','logWhiteDomainError','5579268qJZqRK','stack','logWhiteDomainResponse','Request\x20Body\x20(Updated\x20Format):','üá¨üáß\x20Using\x20GB\x20(Britain)\x20as\x20country\x20for\x20Rapyd\x20payment\x20link','Missing\x20id\x20or\x20redirect_url\x20in\x20response','UNKNOWN','ERR','EXP','log','https://tesoft.uk/gateway/fail.php?id=','error','type','===\x20RAPYD\x20API\x20INCOMPLETE\x20RESPONSE\x20===','NEW','logWhiteDomainRequest','apiUrl','status','5803392LvlGRD','HTTP\x20error!\x20status:\x20','Rapyd\x20API\x20error:\x20','PAID','message','Status:','failure_message','error_code','\x20(always\x20GB\x20for\x20Rapyd)','üá¨üáß\x20Country:\x20','Failed\x20to\x20parse\x20JSON\x20response:','defineProperty','/v1/hosted/payment_links/','CLO','1870mOZLoi','FAILED','rapyd',',\x20body:\x20','TesSoft\x20Payment\x20System/1.0','315217gHtGXM','last4','ORDER:\x20','Error\x20stack:','PAYMENT_EXPIRED','../loggerService','failureCode','72wApFVL','Error\x20details:','stringify','===\x20RAPYD\x20API\x20RESPONSE\x20(White\x20Domain)\x20===','PENDING','SUCCESS','redirect_url','Business\x20Error\x20(','gb_mastercard_card','):\x20','===\x20RAPYD\x20SERVICE\x20ERROR\x20===','JSON\x20Parse\x20Error:\x20','Invalid\x20response\x20from\x20Rapyd\x20API:\x20missing\x20id\x20or\x20redirect_url','===\x20RAPYD\x20API\x20ERROR\x20===','cardLast4','===\x20RAPYD\x20API\x20BUSINESS\x20ERROR\x20===',',\x20failureMessage=','Failed\x20to\x20create\x20Rapyd\x20payment\x20link:\x20Unknown\x20error','PAYMENT_COMPLETED','CAN','Parsed\x20Result:','PAYMENT_FAILED','entries','Rapyd\x20API\x20error\x20(','URL:','1916246QmmFlj','parse','Rapyd\x20payment\x20verification\x20error:','loggerService','https://tesoft.uk/gateway/success.php?id=','Response\x20Time:','/v1/hosted/payment_links','Headers:','HTTP\x20Status:','===\x20RAPYD\x20SUCCESS\x20===','now','HTTP\x20','paid','paymentMethod','1337039ApCpOt','__esModule','errorCode','üí•\x20Rapyd\x20failure\x20message:\x20','currency','2028pnrBVe','Error\x20Message:','===\x20RAPYD\x20API\x20REQUEST\x20(White\x20Domain\x20-\x20Updated\x20Format)\x20===','Failed\x20to\x20verify\x20Rapyd\x20payment:\x20','https://tesoft.uk/gateway/rapyd/','103941LFoOkG','failure_code','üåê\x20Rapyd\x20service\x20initialized\x20with\x20white\x20domain\x20proxy','amount','Error\x20message:','Error\x20Code:','data','\x20(GB\x20-\x20Britain)','üí≥\x20Payment\x20Methods:\x20gb_visa_card,\x20gb_mastercard_card','statusText','23570HodKtg','ACT','Raw\x20Response\x20Body:','PAYMENT_CANCELED','text','Unknown\x20error'];a45_0x102f=function(){return _0x1829e7;};return a45_0x102f();}Object[a45_0x309d70(0x20e)](exports,a45_0x309d70(0x245),{'value':!![]}),exports[a45_0x309d70(0x261)]=void 0x0;function a45_0x1b31(_0x1bc84e,_0x5bab4e){const _0x102f29=a45_0x102f();return a45_0x1b31=function(_0x1b31db,_0x39ea8e){_0x1b31db=_0x1b31db-0x1ee;let _0x1ebbb3=_0x102f29[_0x1b31db];return _0x1ebbb3;},a45_0x1b31(_0x1bc84e,_0x5bab4e);}const loggerService_1=require(a45_0x309d70(0x21b));class RapydService{constructor(){const _0x41f562=a45_0x309d70;this[_0x41f562(0x201)]=_0x41f562(0x24d),console['log'](_0x41f562(0x250));}async['createPaymentLink'](_0x2b2ffe){const _0x4a42b9=a45_0x309d70,{orderId:_0x4a9ae9,orderName:_0x24179e,amount:_0x1b928e,currency:_0x306de7,usage:_0x6493d0,maxPayments:_0x2f2553,successUrl:_0x367d15,failUrl:_0x3b8796}=_0x2b2ffe,_0x55bb2d=_0x306de7['toUpperCase'](),_0x5eca0e='GB';console['log'](_0x4a42b9(0x1f5));const _0x2c2682=_0x4a42b9(0x23a)+_0x4a9ae9,_0x356af2=_0x4a42b9(0x1fb)+_0x4a9ae9,_0x2b19b7={'amount':_0x1b928e,'currency':_0x55bb2d,'cancel_checkout_url':_0x356af2,'complete_checkout_url':_0x2c2682,'complete_payment_url':_0x2c2682,'merchant_reference_id':_0x4a9ae9,'description':_0x4a42b9(0x218)+_0x4a9ae9,'country':'GB','payment_method_types_include':[_0x4a42b9(0x1ef),_0x4a42b9(0x225)],'custom_elements':{'display_description':!![]}},_0x180521=Date['now']();try{console[_0x4a42b9(0x1fa)](_0x4a42b9(0x24b)),console[_0x4a42b9(0x1fa)](_0x4a42b9(0x235),this[_0x4a42b9(0x201)]),console[_0x4a42b9(0x1fa)](_0x4a42b9(0x1f4),JSON[_0x4a42b9(0x21f)](_0x2b19b7,null,0x2)),console[_0x4a42b9(0x1fa)](_0x4a42b9(0x20c)+_0x5eca0e+_0x4a42b9(0x20b)),console[_0x4a42b9(0x1fa)](_0x4a42b9(0x256)),loggerService_1[_0x4a42b9(0x239)][_0x4a42b9(0x200)](_0x4a42b9(0x213),_0x4a42b9(0x23c),'POST',_0x2b19b7);const _0x5a0421=await fetch(this['apiUrl'],{'method':_0x4a42b9(0x264),'headers':{'Content-Type':'application/json','User-Agent':_0x4a42b9(0x215)},'body':JSON[_0x4a42b9(0x21f)](_0x2b19b7)}),_0x444bc7=Date['now']()-_0x180521;console[_0x4a42b9(0x1fa)](_0x4a42b9(0x220)),console[_0x4a42b9(0x1fa)](_0x4a42b9(0x208),_0x5a0421[_0x4a42b9(0x202)]),console[_0x4a42b9(0x1fa)](_0x4a42b9(0x1ee),_0x5a0421[_0x4a42b9(0x257)]),console['log'](_0x4a42b9(0x23d),Object[_0x4a42b9(0x266)](_0x5a0421[_0x4a42b9(0x268)][_0x4a42b9(0x233)]())),console['log'](_0x4a42b9(0x23b),_0x444bc7+'ms');const _0x51289a=await _0x5a0421[_0x4a42b9(0x25c)]();console[_0x4a42b9(0x1fa)](_0x4a42b9(0x25a),_0x51289a);if(!_0x5a0421['ok']){console[_0x4a42b9(0x1fc)](_0x4a42b9(0x22a)),console[_0x4a42b9(0x1fc)](_0x4a42b9(0x23e),_0x5a0421[_0x4a42b9(0x202)]),console[_0x4a42b9(0x1fc)](_0x4a42b9(0x25e),_0x51289a),loggerService_1['loggerService'][_0x4a42b9(0x1f3)]('rapyd',_0x4a42b9(0x23c),_0x5a0421[_0x4a42b9(0x202)],_0x51289a,_0x444bc7),loggerService_1['loggerService'][_0x4a42b9(0x1f0)](_0x4a42b9(0x213),_0x4a42b9(0x23c),_0x4a42b9(0x241)+_0x5a0421[_0x4a42b9(0x202)]+':\x20'+_0x51289a);throw new Error(_0x4a42b9(0x204)+_0x5a0421[_0x4a42b9(0x202)]+_0x4a42b9(0x214)+_0x51289a);}let _0x9c55e8;try{_0x9c55e8=JSON[_0x4a42b9(0x237)](_0x51289a);}catch(_0x5d13c1){console[_0x4a42b9(0x1fc)](_0x4a42b9(0x20d),_0x5d13c1),loggerService_1['loggerService']['logWhiteDomainError'](_0x4a42b9(0x213),'/v1/hosted/payment_links',_0x4a42b9(0x228)+_0x5d13c1);throw new Error(_0x4a42b9(0x265)+_0x51289a);}console[_0x4a42b9(0x1fa)]('===\x20PARSED\x20RAPYD\x20RESPONSE\x20==='),console[_0x4a42b9(0x1fa)](_0x4a42b9(0x231),JSON[_0x4a42b9(0x21f)](_0x9c55e8,null,0x2)),loggerService_1['loggerService'][_0x4a42b9(0x1f3)](_0x4a42b9(0x213),_0x4a42b9(0x23c),_0x5a0421[_0x4a42b9(0x202)],_0x9c55e8,_0x444bc7);if(_0x9c55e8[_0x4a42b9(0x202)]?.[_0x4a42b9(0x202)]!==_0x4a42b9(0x222)){const _0x442b49=_0x9c55e8[_0x4a42b9(0x202)]?.['message']||'Unknown\x20error\x20from\x20Rapyd\x20API',_0x332a95=_0x9c55e8[_0x4a42b9(0x202)]?.[_0x4a42b9(0x20a)]||_0x4a42b9(0x1f7);console[_0x4a42b9(0x1fc)](_0x4a42b9(0x22c)),console[_0x4a42b9(0x1fc)](_0x4a42b9(0x253),_0x332a95),console['error'](_0x4a42b9(0x24a),_0x442b49),console[_0x4a42b9(0x1fc)]('Full\x20Error\x20Data:',_0x9c55e8[_0x4a42b9(0x202)]),loggerService_1[_0x4a42b9(0x239)][_0x4a42b9(0x1f0)](_0x4a42b9(0x213),_0x4a42b9(0x23c),_0x4a42b9(0x224)+_0x332a95+_0x4a42b9(0x226)+_0x442b49);throw new Error(_0x4a42b9(0x234)+_0x332a95+'):\x20'+_0x442b49);}if(!_0x9c55e8[_0x4a42b9(0x254)]?.['id']||!_0x9c55e8[_0x4a42b9(0x254)]?.[_0x4a42b9(0x223)]){console[_0x4a42b9(0x1fc)](_0x4a42b9(0x1fe)),console[_0x4a42b9(0x1fc)](_0x4a42b9(0x1f6)),console[_0x4a42b9(0x1fc)]('Response\x20data:',_0x9c55e8[_0x4a42b9(0x254)]),loggerService_1['loggerService']['logWhiteDomainError']('rapyd',_0x4a42b9(0x23c),'Incomplete\x20response:\x20missing\x20id\x20or\x20redirect_url');throw new Error(_0x4a42b9(0x229));}return console['log'](_0x4a42b9(0x23f)),console[_0x4a42b9(0x1fa)]('Payment\x20Link\x20ID:',_0x9c55e8[_0x4a42b9(0x254)]['id']),console['log']('Redirect\x20URL:',_0x9c55e8[_0x4a42b9(0x254)][_0x4a42b9(0x223)]),console[_0x4a42b9(0x1fa)]('üá¨üáß\x20Country\x20used:\x20'+_0x5eca0e+_0x4a42b9(0x255)),console[_0x4a42b9(0x1fa)](_0x4a42b9(0x256)),{'gateway_payment_id':_0x9c55e8[_0x4a42b9(0x254)]['id'],'payment_url':_0x9c55e8[_0x4a42b9(0x254)]['redirect_url']};}catch(_0x5050d1){console[_0x4a42b9(0x1fc)](_0x4a42b9(0x227)),console[_0x4a42b9(0x1fc)](_0x4a42b9(0x21e),_0x5050d1),loggerService_1[_0x4a42b9(0x239)][_0x4a42b9(0x1f0)]('rapyd',_0x4a42b9(0x23c),_0x5050d1);if(_0x5050d1 instanceof Error){console['error'](_0x4a42b9(0x252),_0x5050d1[_0x4a42b9(0x207)]),console[_0x4a42b9(0x1fc)](_0x4a42b9(0x219),_0x5050d1[_0x4a42b9(0x1f2)]);throw new Error('Failed\x20to\x20create\x20Rapyd\x20payment\x20link:\x20'+_0x5050d1[_0x4a42b9(0x207)]);}throw new Error(_0x4a42b9(0x22e));}}async[a45_0x309d70(0x262)](_0x483fec){const _0x4735d7=a45_0x309d70,_0x59355a=Date[_0x4735d7(0x240)]();try{loggerService_1[_0x4735d7(0x239)][_0x4735d7(0x200)](_0x4735d7(0x213),_0x4735d7(0x20f)+_0x483fec,'GET',{});const _0x43ff48=await fetch(this[_0x4735d7(0x201)]+'/'+_0x483fec,{'method':'GET','headers':{'Content-Type':'application/json','User-Agent':_0x4735d7(0x215)}}),_0x8ba22c=Date[_0x4735d7(0x240)]()-_0x59355a;if(!_0x43ff48['ok']){const _0x452a17=await _0x43ff48[_0x4735d7(0x25c)]();loggerService_1[_0x4735d7(0x239)]['logWhiteDomainResponse'](_0x4735d7(0x213),_0x4735d7(0x20f)+_0x483fec,_0x43ff48[_0x4735d7(0x202)],_0x452a17,_0x8ba22c);throw new Error('HTTP\x20error!\x20status:\x20'+_0x43ff48['status']);}const _0x4299ab=await _0x43ff48['json']();loggerService_1['loggerService'][_0x4735d7(0x1f3)](_0x4735d7(0x213),'/v1/hosted/payment_links/'+_0x483fec,_0x43ff48[_0x4735d7(0x202)],_0x4299ab,_0x8ba22c);if(_0x4299ab[_0x4735d7(0x202)]?.[_0x4735d7(0x202)]!==_0x4735d7(0x222)){loggerService_1[_0x4735d7(0x239)][_0x4735d7(0x1f0)](_0x4735d7(0x213),_0x4735d7(0x20f)+_0x483fec,_0x4735d7(0x205)+(_0x4299ab[_0x4735d7(0x202)]?.['message']||_0x4735d7(0x25d)));throw new Error(_0x4735d7(0x205)+(_0x4299ab[_0x4735d7(0x202)]?.[_0x4735d7(0x207)]||'Unknown\x20error'));}let _0x19be0e=_0x4735d7(0x221);if(_0x4299ab['data']?.[_0x4735d7(0x202)])switch(_0x4299ab[_0x4735d7(0x254)][_0x4735d7(0x202)][_0x4735d7(0x25f)]()){case _0x4735d7(0x210):_0x19be0e=_0x4735d7(0x206);break;case _0x4735d7(0x230):_0x19be0e=_0x4735d7(0x212);break;case _0x4735d7(0x1f9):_0x19be0e=_0x4735d7(0x267);break;case _0x4735d7(0x1f8):_0x19be0e=_0x4735d7(0x212);break;case _0x4735d7(0x1ff):case'ACT':default:_0x19be0e=_0x4735d7(0x221);break;}return{'status':_0x19be0e,'amount':_0x4299ab[_0x4735d7(0x254)]?.['amount'],'currency':_0x4299ab['data']?.[_0x4735d7(0x248)]};}catch(_0x13643c){console[_0x4735d7(0x1fc)](_0x4735d7(0x238),_0x13643c),loggerService_1[_0x4735d7(0x239)][_0x4735d7(0x1f0)](_0x4735d7(0x213),'/v1/hosted/payment_links/'+_0x483fec,_0x13643c);throw new Error(_0x4735d7(0x24c)+(_0x13643c instanceof Error?_0x13643c['message']:_0x4735d7(0x25d)));}}async[a45_0x309d70(0x263)](_0x538512){const _0x34e240=a45_0x309d70;console[_0x34e240(0x1fa)](_0x34e240(0x260),_0x538512);let _0x4ff9ea=_0x34e240(0x221),_0x124913;_0x538512[_0x34e240(0x254)]?.[_0x34e240(0x209)]&&(_0x124913=_0x538512[_0x34e240(0x254)][_0x34e240(0x209)],console[_0x34e240(0x1fa)](_0x34e240(0x247)+_0x124913));switch(_0x538512[_0x34e240(0x1fd)]?.[_0x34e240(0x25f)]()){case _0x34e240(0x22f):_0x538512[_0x34e240(0x254)]?.[_0x34e240(0x242)]===!![]&&_0x538512[_0x34e240(0x254)]?.[_0x34e240(0x202)]===_0x34e240(0x210)?_0x4ff9ea=_0x34e240(0x206):_0x4ff9ea=_0x34e240(0x221);break;case _0x34e240(0x25b):_0x4ff9ea='FAILED';break;case _0x34e240(0x21a):_0x4ff9ea='EXPIRED';break;case _0x34e240(0x232):_0x4ff9ea=_0x34e240(0x212);!_0x124913&&_0x538512['data']?.[_0x34e240(0x209)]&&(_0x124913=_0x538512['data'][_0x34e240(0x209)]);break;default:switch(_0x538512[_0x34e240(0x254)]?.[_0x34e240(0x202)]?.['toUpperCase']()){case _0x34e240(0x210):_0x538512['data']?.[_0x34e240(0x242)]===!![]?_0x4ff9ea=_0x34e240(0x206):_0x4ff9ea=_0x34e240(0x212);break;case _0x34e240(0x230):_0x4ff9ea='FAILED';break;case _0x34e240(0x1f9):_0x4ff9ea='EXPIRED';break;case _0x34e240(0x1f8):_0x4ff9ea=_0x34e240(0x212);!_0x124913&&_0x538512['data']?.[_0x34e240(0x209)]&&(_0x124913=_0x538512[_0x34e240(0x254)][_0x34e240(0x209)]);break;case'NEW':case _0x34e240(0x259):default:_0x4ff9ea=_0x34e240(0x221);break;}break;}const _0x3b969b={};return _0x538512[_0x34e240(0x254)]?.['payment_method_data']?.[_0x34e240(0x217)]&&(_0x3b969b[_0x34e240(0x22b)]=_0x538512[_0x34e240(0x254)]['payment_method_data'][_0x34e240(0x217)]),_0x538512[_0x34e240(0x254)]?.['payment_method_type']&&(_0x3b969b[_0x34e240(0x243)]=_0x538512[_0x34e240(0x254)]['payment_method_type']),_0x538512[_0x34e240(0x254)]?.[_0x34e240(0x20a)]&&(_0x3b969b[_0x34e240(0x246)]=_0x538512[_0x34e240(0x254)][_0x34e240(0x20a)]),_0x538512[_0x34e240(0x254)]?.[_0x34e240(0x24f)]&&(_0x3b969b[_0x34e240(0x21c)]=_0x538512[_0x34e240(0x254)][_0x34e240(0x24f)]),console[_0x34e240(0x1fa)]('üîÑ\x20Rapyd\x20webhook\x20processed:\x20status='+_0x4ff9ea+_0x34e240(0x22d)+(_0x124913||'none')),{'paymentId':_0x538512[_0x34e240(0x254)]?.['merchant_reference_id']||'','status':_0x4ff9ea,'amount':_0x538512[_0x34e240(0x254)]?.[_0x34e240(0x251)],'currency':_0x538512['data']?.[_0x34e240(0x248)],'failureMessage':_0x124913,'additionalInfo':_0x3b969b};}}exports['RapydService']=RapydService;