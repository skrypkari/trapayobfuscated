'use strict';const a69_0x323932=a69_0x3c17;(function(_0x10632c,_0x29d00d){const _0x181e9a=a69_0x3c17,_0x13daaa=_0x10632c();while(!![]){try{const _0x5f40e3=parseInt(_0x181e9a(0xb3))/0x1*(-parseInt(_0x181e9a(0x7a))/0x2)+parseInt(_0x181e9a(0x89))/0x3+parseInt(_0x181e9a(0x9b))/0x4*(parseInt(_0x181e9a(0x81))/0x5)+parseInt(_0x181e9a(0xea))/0x6*(parseInt(_0x181e9a(0xb4))/0x7)+parseInt(_0x181e9a(0xbe))/0x8+-parseInt(_0x181e9a(0xd2))/0x9*(-parseInt(_0x181e9a(0x75))/0xa)+-parseInt(_0x181e9a(0xcf))/0xb*(parseInt(_0x181e9a(0xe9))/0xc);if(_0x5f40e3===_0x29d00d)break;else _0x13daaa['push'](_0x13daaa['shift']());}catch(_0x4e7706){_0x13daaa['push'](_0x13daaa['shift']());}}}(a69_0x815c,0x32f90));function a69_0x3c17(_0x49371e,_0x50c156){_0x49371e=_0x49371e-0x74;const _0x815cf3=a69_0x815c();let _0x3c1736=_0x815cf3[_0x49371e];return _0x3c1736;}Object['defineProperty'](exports,'__esModule',{'value':!![]}),exports[a69_0x323932(0x85)]=void 0x0;const loggerService_1=require(a69_0x323932(0x80));function a69_0x815c(){const _0x1347ab=['https://tesoft.uk/gateway/fail.php?id=','Payment\x20System/1.0','message','failure_code','PENDING','Rapyd\x20API\x20error\x20(','PAYMENT_CANCELED','brand','üá¨üáß\x20Using\x20GB\x20(Britain)\x20as\x20country\x20for\x20Rapyd\x20payment\x20link','HTTP\x20Status:','12CbSsgd','24fcbztC','\x20(GB\x20-\x20Britain)','merchant_reference_id','Headers:','Invalid\x20JSON\x20response\x20from\x20Rapyd\x20API:\x20','Failed\x20to\x20create\x20Rapyd\x20payment\x20link:\x20Unknown\x20error','HTTP\x20','email','ERR','CLO','logWhiteDomainResponse','bin_details','UNKNOWN','custom_elements','üí±\x20Adding\x20currency\x20conversion\x20fields\x20for\x20','amount','paymentMethod','Error\x20Message:','Status:','6410eqnkQM','EXPIRED','Error\x20message:','üîÑ\x20Rapyd\x20webhook\x20processed:\x20status=','floor','4438zeytQX','CAN','Status\x20Text:','Redirect\x20URL:','===\x20PARSED\x20RAPYD\x20RESPONSE\x20===','PAYMENT_FAILED','../loggerService','2100ACzTAT','\x20(always\x20GB\x20for\x20Rapyd)','/v1/hosted/payment_links/','===\x20RAPYD\x20API\x20ERROR\x20===','RapydService','errorCode','https://tesoft.uk/gateway/success.php?id=','payment_method_type','703326hvogjL','ORDER:\x20','verifyPayment','Invalid\x20response\x20from\x20Rapyd\x20API:\x20missing\x20id\x20or\x20redirect_url','cardLast4','===\x20RAPYD\x20API\x20RESPONSE\x20(White\x20Domain)\x20===','currency','requested_currency','last4','error_code','failureCode','now','GET','Error\x20details:','Response\x20data:','logWhiteDomainRequest','name','/v1/hosted/payment_links','1320ZKnIIh','\x20\x20\x20requested_currency:\x20EUR','error','none','Failed\x20to\x20parse\x20JSON\x20response:','üá¨üáß\x20Country:\x20','apiUrl','processWebhook','Error\x20stack:','status','FAILED','payment_method_data','ACT','Parsed\x20Result:','===\x20RAPYD\x20SERVICE\x20ERROR\x20===','Raw\x20Response\x20Body:','toUpperCase','failure_message','===\x20RAPYD\x20API\x20REQUEST\x20(White\x20Domain\x20-\x20Updated\x20Format)\x20===','Response\x20Time:','rapyd','logWhiteDomainError','===\x20RAPYD\x20API\x20BUSINESS\x20ERROR\x20===','üí≥\x20Adding\x20cardholder\x20name:\x20','1GZFFJF','559909sQhZgL','POST','HTTP\x20error!\x20status:\x20','loggerService','data','application/json','\x20->\x20EUR:','Unknown\x20error','Missing\x20id\x20or\x20redirect_url\x20in\x20response','cardBrand','324360RhDtQu','expiration','https://tesoft.uk/gateway/rapyd/','SUCCESS','log','split','buy','üí≥\x20Payment\x20Methods:\x20gb_visa_card,\x20gb_mastercard_card','PAID','stringify','createPaymentLink','json','EUR','text','stack','Incomplete\x20response:\x20missing\x20id\x20or\x20redirect_url','PAYMENT_COMPLETED','7940713PXuBko','phone_number','Full\x20Error\x20Data:','2799RnicRt','type','redirect_url','üí•\x20Rapyd\x20failure\x20message:\x20','\x20\x20\x20fixed_side:\x20buy','JSON\x20Parse\x20Error:\x20','NEW','Request\x20Body\x20(Updated\x20Format):','address','parse',',\x20body:\x20','fixed_side','paid'];a69_0x815c=function(){return _0x1347ab;};return a69_0x815c();}class RapydService{constructor(){const _0xd62ce9=a69_0x323932;this[_0xd62ce9(0xa1)]=_0xd62ce9(0xc0),console[_0xd62ce9(0xc2)]('üåê\x20Rapyd\x20service\x20initialized\x20with\x20white\x20domain\x20proxy');}async[a69_0x323932(0xc8)](_0x22f53d){const _0x46b88e=a69_0x323932,{orderId:_0x5a8c0b,orderName:_0x34328c,amount:_0x52a0a8,currency:_0x39417c,usage:_0x4ee220,maxPayments:_0xd57d9a,successUrl:_0x4b4186,failUrl:_0x39fbb9,customerName:_0x31a060,customerEmail:_0x5c53b2}=_0x22f53d,_0x20b252=_0x39417c[_0x46b88e(0xab)](),_0x302ec4='GB';console[_0x46b88e(0xc2)](_0x46b88e(0xe7));const _0x597d47=_0x46b88e(0x87)+_0x5a8c0b,_0x2c6ee6=_0x46b88e(0xdf)+_0x5a8c0b,_0x36e869={'amount':_0x52a0a8,'currency':_0x20b252,'payment_method_options':{'3d_required':![]},'cancel_checkout_url':_0x2c6ee6,'complete_checkout_url':_0x597d47,'complete_payment_url':_0x597d47,'merchant_reference_id':_0x5a8c0b,'description':_0x46b88e(0x8a)+_0x5a8c0b,'statement_descriptor':'TESOFT\x20'+(_0x5a8c0b[_0x46b88e(0xc3)]('-')[0x1]||_0x5a8c0b),'country':'GB','payment_method_types_include':['gb_visa_card','gb_mastercard_card'],'custom_elements':{'display_description':!![],'billing_address_collect':!![],'required_customer_fields':[_0x46b88e(0x99),_0x46b88e(0xf1),_0x46b88e(0xd0),_0x46b88e(0xda)]}};_0x31a060&&(_0x36e869[_0x46b88e(0xf7)]['cardholder_name']=_0x31a060,console['log'](_0x46b88e(0xb2)+_0x31a060));if(_0x20b252!==_0x46b88e(0xca)){const _0x319989=Math[_0x46b88e(0x79)](Date['now']()/0x3e8)+0x1e*0x3c;_0x36e869[_0x46b88e(0xdd)]=_0x46b88e(0xc4),_0x36e869[_0x46b88e(0x90)]=_0x46b88e(0xca),_0x36e869[_0x46b88e(0xbf)]=_0x319989,console[_0x46b88e(0xc2)](_0x46b88e(0xf8)+_0x20b252+_0x46b88e(0xba)),console['log'](_0x46b88e(0xd6)),console['log'](_0x46b88e(0x9c)),console[_0x46b88e(0xc2)]('\x20\x20\x20expiration:\x20'+_0x319989+'\x20('+new Date(_0x319989*0x3e8)['toISOString']()+')');}const _0x236ab3=Date[_0x46b88e(0x94)]();try{console[_0x46b88e(0xc2)](_0x46b88e(0xad)),console['log']('URL:',this['apiUrl']),console['log'](_0x46b88e(0xd9),JSON[_0x46b88e(0xc7)](_0x36e869,null,0x2)),console['log'](_0x46b88e(0xa0)+_0x302ec4+_0x46b88e(0x82)),console['log'](_0x46b88e(0xc5)),loggerService_1[_0x46b88e(0xb7)][_0x46b88e(0x98)](_0x46b88e(0xaf),_0x46b88e(0x9a),_0x46b88e(0xb5),_0x36e869);const _0x1d83e1=await fetch(this[_0x46b88e(0xa1)],{'method':_0x46b88e(0xb5),'headers':{'Content-Type':_0x46b88e(0xb9),'User-Agent':_0x46b88e(0xe0)},'body':JSON[_0x46b88e(0xc7)](_0x36e869)}),_0x5dbd45=Date[_0x46b88e(0x94)]()-_0x236ab3;console['log'](_0x46b88e(0x8e)),console[_0x46b88e(0xc2)](_0x46b88e(0x74),_0x1d83e1['status']),console[_0x46b88e(0xc2)](_0x46b88e(0x7c),_0x1d83e1['statusText']),console[_0x46b88e(0xc2)](_0x46b88e(0xed),Object['fromEntries'](_0x1d83e1['headers']['entries']())),console[_0x46b88e(0xc2)](_0x46b88e(0xae),_0x5dbd45+'ms');const _0x1c2aaa=await _0x1d83e1[_0x46b88e(0xcb)]();console[_0x46b88e(0xc2)](_0x46b88e(0xaa),_0x1c2aaa);if(!_0x1d83e1['ok']){console[_0x46b88e(0x9d)](_0x46b88e(0x84)),console[_0x46b88e(0x9d)](_0x46b88e(0xe8),_0x1d83e1[_0x46b88e(0xa4)]),console[_0x46b88e(0x9d)]('Response\x20Body:',_0x1c2aaa),loggerService_1['loggerService'][_0x46b88e(0xf4)](_0x46b88e(0xaf),'/v1/hosted/payment_links',_0x1d83e1['status'],_0x1c2aaa,_0x5dbd45),loggerService_1[_0x46b88e(0xb7)][_0x46b88e(0xb0)]('rapyd','/v1/hosted/payment_links',_0x46b88e(0xf0)+_0x1d83e1['status']+':\x20'+_0x1c2aaa);throw new Error(_0x46b88e(0xb6)+_0x1d83e1['status']+_0x46b88e(0xdc)+_0x1c2aaa);}let _0x153be8;try{_0x153be8=JSON[_0x46b88e(0xdb)](_0x1c2aaa);}catch(_0x3a1d3b){console[_0x46b88e(0x9d)](_0x46b88e(0x9f),_0x3a1d3b),loggerService_1[_0x46b88e(0xb7)][_0x46b88e(0xb0)](_0x46b88e(0xaf),_0x46b88e(0x9a),_0x46b88e(0xd7)+_0x3a1d3b);throw new Error(_0x46b88e(0xee)+_0x1c2aaa);}console[_0x46b88e(0xc2)](_0x46b88e(0x7e)),console[_0x46b88e(0xc2)](_0x46b88e(0xa8),JSON[_0x46b88e(0xc7)](_0x153be8,null,0x2)),loggerService_1[_0x46b88e(0xb7)][_0x46b88e(0xf4)]('rapyd',_0x46b88e(0x9a),_0x1d83e1[_0x46b88e(0xa4)],_0x153be8,_0x5dbd45);if(_0x153be8[_0x46b88e(0xa4)]?.[_0x46b88e(0xa4)]!==_0x46b88e(0xc1)){const _0x3c1b93=_0x153be8['status']?.[_0x46b88e(0xe1)]||'Unknown\x20error\x20from\x20Rapyd\x20API',_0x5a5a9b=_0x153be8[_0x46b88e(0xa4)]?.[_0x46b88e(0x92)]||_0x46b88e(0xf6);console[_0x46b88e(0x9d)](_0x46b88e(0xb1)),console[_0x46b88e(0x9d)]('Error\x20Code:',_0x5a5a9b),console[_0x46b88e(0x9d)](_0x46b88e(0xfb),_0x3c1b93),console[_0x46b88e(0x9d)](_0x46b88e(0xd1),_0x153be8[_0x46b88e(0xa4)]),loggerService_1[_0x46b88e(0xb7)]['logWhiteDomainError'](_0x46b88e(0xaf),_0x46b88e(0x9a),'Business\x20Error\x20('+_0x5a5a9b+'):\x20'+_0x3c1b93);throw new Error(_0x46b88e(0xe4)+_0x5a5a9b+'):\x20'+_0x3c1b93);}if(!_0x153be8[_0x46b88e(0xb8)]?.['id']||!_0x153be8[_0x46b88e(0xb8)]?.[_0x46b88e(0xd4)]){console[_0x46b88e(0x9d)]('===\x20RAPYD\x20API\x20INCOMPLETE\x20RESPONSE\x20==='),console['error'](_0x46b88e(0xbc)),console[_0x46b88e(0x9d)](_0x46b88e(0x97),_0x153be8[_0x46b88e(0xb8)]),loggerService_1[_0x46b88e(0xb7)][_0x46b88e(0xb0)](_0x46b88e(0xaf),'/v1/hosted/payment_links',_0x46b88e(0xcd));throw new Error(_0x46b88e(0x8c));}return console[_0x46b88e(0xc2)]('===\x20RAPYD\x20SUCCESS\x20==='),console[_0x46b88e(0xc2)]('Payment\x20Link\x20ID:',_0x153be8[_0x46b88e(0xb8)]['id']),console[_0x46b88e(0xc2)](_0x46b88e(0x7d),_0x153be8[_0x46b88e(0xb8)][_0x46b88e(0xd4)]),console['log']('üá¨üáß\x20Country\x20used:\x20'+_0x302ec4+_0x46b88e(0xeb)),console[_0x46b88e(0xc2)](_0x46b88e(0xc5)),{'gateway_payment_id':_0x153be8[_0x46b88e(0xb8)]['id'],'payment_url':_0x153be8[_0x46b88e(0xb8)][_0x46b88e(0xd4)]};}catch(_0x5a64d7){console[_0x46b88e(0x9d)](_0x46b88e(0xa9)),console['error'](_0x46b88e(0x96),_0x5a64d7),loggerService_1[_0x46b88e(0xb7)][_0x46b88e(0xb0)]('rapyd',_0x46b88e(0x9a),_0x5a64d7);if(_0x5a64d7 instanceof Error){console[_0x46b88e(0x9d)](_0x46b88e(0x77),_0x5a64d7['message']),console['error'](_0x46b88e(0xa3),_0x5a64d7[_0x46b88e(0xcc)]);throw new Error('Failed\x20to\x20create\x20Rapyd\x20payment\x20link:\x20'+_0x5a64d7[_0x46b88e(0xe1)]);}throw new Error(_0x46b88e(0xef));}}async[a69_0x323932(0x8b)](_0xd2c8cc){const _0x28e8e2=a69_0x323932,_0x47ef9b=Date[_0x28e8e2(0x94)]();try{loggerService_1[_0x28e8e2(0xb7)]['logWhiteDomainRequest']('rapyd',_0x28e8e2(0x83)+_0xd2c8cc,_0x28e8e2(0x95),{});const _0x1bb01d=await fetch(this[_0x28e8e2(0xa1)]+'/'+_0xd2c8cc,{'method':_0x28e8e2(0x95),'headers':{'Content-Type':_0x28e8e2(0xb9),'User-Agent':_0x28e8e2(0xe0)}}),_0x2eae57=Date['now']()-_0x47ef9b;if(!_0x1bb01d['ok']){const _0x517b87=await _0x1bb01d[_0x28e8e2(0xcb)]();loggerService_1[_0x28e8e2(0xb7)][_0x28e8e2(0xf4)]('rapyd','/v1/hosted/payment_links/'+_0xd2c8cc,_0x1bb01d[_0x28e8e2(0xa4)],_0x517b87,_0x2eae57);throw new Error(_0x28e8e2(0xb6)+_0x1bb01d['status']);}const _0x29179c=await _0x1bb01d[_0x28e8e2(0xc9)]();loggerService_1['loggerService'][_0x28e8e2(0xf4)]('rapyd',_0x28e8e2(0x83)+_0xd2c8cc,_0x1bb01d['status'],_0x29179c,_0x2eae57);if(_0x29179c[_0x28e8e2(0xa4)]?.[_0x28e8e2(0xa4)]!=='SUCCESS'){loggerService_1[_0x28e8e2(0xb7)]['logWhiteDomainError'](_0x28e8e2(0xaf),_0x28e8e2(0x83)+_0xd2c8cc,'Rapyd\x20API\x20error:\x20'+(_0x29179c[_0x28e8e2(0xa4)]?.['message']||_0x28e8e2(0xbb)));throw new Error('Rapyd\x20API\x20error:\x20'+(_0x29179c[_0x28e8e2(0xa4)]?.[_0x28e8e2(0xe1)]||_0x28e8e2(0xbb)));}let _0x193b55=_0x28e8e2(0xe3);if(_0x29179c['data']?.[_0x28e8e2(0xa4)])switch(_0x29179c['data'][_0x28e8e2(0xa4)][_0x28e8e2(0xab)]()){case _0x28e8e2(0xf3):_0x193b55=_0x28e8e2(0xc6);break;case _0x28e8e2(0x7b):_0x193b55='FAILED';break;case'EXP':_0x193b55=_0x28e8e2(0x76);break;case'ERR':_0x193b55='FAILED';break;case _0x28e8e2(0xd8):case _0x28e8e2(0xa7):default:_0x193b55=_0x28e8e2(0xe3);break;}return{'status':_0x193b55,'amount':_0x29179c[_0x28e8e2(0xb8)]?.[_0x28e8e2(0xf9)],'currency':_0x29179c[_0x28e8e2(0xb8)]?.[_0x28e8e2(0x8f)]};}catch(_0x58081e){console[_0x28e8e2(0x9d)]('Rapyd\x20payment\x20verification\x20error:',_0x58081e),loggerService_1[_0x28e8e2(0xb7)]['logWhiteDomainError']('rapyd','/v1/hosted/payment_links/'+_0xd2c8cc,_0x58081e);throw new Error('Failed\x20to\x20verify\x20Rapyd\x20payment:\x20'+(_0x58081e instanceof Error?_0x58081e[_0x28e8e2(0xe1)]:_0x28e8e2(0xbb)));}}async[a69_0x323932(0xa2)](_0x3b2c49){const _0x556b15=a69_0x323932;console[_0x556b15(0xc2)]('Processing\x20Rapyd\x20webhook:',_0x3b2c49);let _0x405a87=_0x556b15(0xe3),_0x5393b6;_0x3b2c49[_0x556b15(0xb8)]?.[_0x556b15(0xac)]&&(_0x5393b6=_0x3b2c49[_0x556b15(0xb8)][_0x556b15(0xac)],console['log'](_0x556b15(0xd5)+_0x5393b6));switch(_0x3b2c49[_0x556b15(0xd3)]?.[_0x556b15(0xab)]()){case _0x556b15(0xce):_0x3b2c49['data']?.['paid']===!![]&&_0x3b2c49[_0x556b15(0xb8)]?.[_0x556b15(0xa4)]===_0x556b15(0xf3)?_0x405a87=_0x556b15(0xc6):_0x405a87=_0x556b15(0xe3);break;case _0x556b15(0xe5):_0x405a87=_0x556b15(0xa5);break;case'PAYMENT_EXPIRED':_0x405a87=_0x556b15(0x76);break;case _0x556b15(0x7f):_0x405a87=_0x556b15(0xa5);!_0x5393b6&&_0x3b2c49[_0x556b15(0xb8)]?.['failure_message']&&(_0x5393b6=_0x3b2c49[_0x556b15(0xb8)][_0x556b15(0xac)]);break;default:switch(_0x3b2c49[_0x556b15(0xb8)]?.[_0x556b15(0xa4)]?.['toUpperCase']()){case _0x556b15(0xf3):_0x3b2c49[_0x556b15(0xb8)]?.[_0x556b15(0xde)]===!![]?_0x405a87=_0x556b15(0xc6):_0x405a87=_0x556b15(0xa5);break;case _0x556b15(0x7b):_0x405a87=_0x556b15(0xa5);break;case'EXP':_0x405a87=_0x556b15(0x76);break;case _0x556b15(0xf2):_0x405a87='FAILED';!_0x5393b6&&_0x3b2c49[_0x556b15(0xb8)]?.[_0x556b15(0xac)]&&(_0x5393b6=_0x3b2c49['data'][_0x556b15(0xac)]);break;case _0x556b15(0xd8):case _0x556b15(0xa7):default:_0x405a87=_0x556b15(0xe3);break;}break;}const _0x566967={};return _0x3b2c49[_0x556b15(0xb8)]?.[_0x556b15(0xa6)]?.['last4']&&(_0x566967[_0x556b15(0x8d)]=_0x3b2c49['data'][_0x556b15(0xa6)][_0x556b15(0x91)]),_0x3b2c49[_0x556b15(0xb8)]?.[_0x556b15(0xa6)]?.[_0x556b15(0xf5)]?.[_0x556b15(0xe6)]&&(_0x566967[_0x556b15(0xbd)]=_0x3b2c49['data']['payment_method_data'][_0x556b15(0xf5)][_0x556b15(0xe6)],console[_0x556b15(0xc2)]('üí≥\x20Card\x20brand\x20from\x20bin_details:\x20'+_0x566967[_0x556b15(0xbd)])),_0x3b2c49[_0x556b15(0xb8)]?.[_0x556b15(0x88)]&&(_0x566967[_0x556b15(0xfa)]=_0x3b2c49['data'][_0x556b15(0x88)]),_0x3b2c49[_0x556b15(0xb8)]?.[_0x556b15(0x92)]&&(_0x566967[_0x556b15(0x86)]=_0x3b2c49[_0x556b15(0xb8)][_0x556b15(0x92)]),_0x3b2c49[_0x556b15(0xb8)]?.['failure_code']&&(_0x566967[_0x556b15(0x93)]=_0x3b2c49[_0x556b15(0xb8)][_0x556b15(0xe2)]),console[_0x556b15(0xc2)](_0x556b15(0x78)+_0x405a87+',\x20failureMessage='+(_0x5393b6||_0x556b15(0x9e))),{'paymentId':_0x3b2c49[_0x556b15(0xb8)]?.[_0x556b15(0xec)]||'','status':_0x405a87,'amount':_0x3b2c49[_0x556b15(0xb8)]?.[_0x556b15(0xf9)],'currency':_0x3b2c49[_0x556b15(0xb8)]?.[_0x556b15(0x8f)],'failureMessage':_0x5393b6,'additionalInfo':_0x566967};}}exports[a69_0x323932(0x85)]=RapydService;