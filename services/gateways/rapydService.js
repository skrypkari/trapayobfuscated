'use strict';const a42_0x376781=a42_0x4ad9;(function(_0x123f59,_0x5f5d47){const _0x458949=a42_0x4ad9,_0xe7e768=_0x123f59();while(!![]){try{const _0x58496c=-parseInt(_0x458949(0x1bb))/0x1*(parseInt(_0x458949(0x196))/0x2)+parseInt(_0x458949(0x18a))/0x3*(parseInt(_0x458949(0x1c1))/0x4)+parseInt(_0x458949(0x184))/0x5*(-parseInt(_0x458949(0x1bc))/0x6)+parseInt(_0x458949(0x1c3))/0x7+parseInt(_0x458949(0x18e))/0x8*(-parseInt(_0x458949(0x1d0))/0x9)+-parseInt(_0x458949(0x19b))/0xa*(parseInt(_0x458949(0x1b4))/0xb)+parseInt(_0x458949(0x1bd))/0xc;if(_0x58496c===_0x5f5d47)break;else _0xe7e768['push'](_0xe7e768['shift']());}catch(_0x298b74){_0xe7e768['push'](_0xe7e768['shift']());}}}(a42_0x40ce,0x3c6fa));Object[a42_0x376781(0x194)](exports,a42_0x376781(0x17e),{'value':!![]}),exports['RapydService']=void 0x0;function a42_0x4ad9(_0x5c27b5,_0x27fdea){const _0x40cee2=a42_0x40ce();return a42_0x4ad9=function(_0x4ad965,_0x9099db){_0x4ad965=_0x4ad965-0x17b;let _0x515aaa=_0x40cee2[_0x4ad965];return _0x515aaa;},a42_0x4ad9(_0x5c27b5,_0x27fdea);}const loggerService_1=require('../loggerService');class RapydService{constructor(){const _0x2b5a37=a42_0x376781;this[_0x2b5a37(0x1c8)]=_0x2b5a37(0x1ab),console['log'](_0x2b5a37(0x185));}async['createPaymentLink'](_0x439ae2){const _0x3fe875=a42_0x376781,{orderId:_0x17a309,orderName:_0x4be045,amount:_0x1aca4a,currency:_0x2e05f2,usage:_0xe57048,maxPayments:_0xbee3d3,successUrl:_0x2de719,failUrl:_0xc9e041}=_0x439ae2,_0x15330d=_0x2e05f2['toUpperCase'](),_0x2b4017='GB';console[_0x3fe875(0x1d5)](_0x3fe875(0x1a2));const _0xc05080=_0x3fe875(0x19e)+_0x17a309,_0x38f02e=_0x3fe875(0x1d3)+_0x17a309,_0x371ffc={'amount':_0x1aca4a,'currency':_0x15330d,'cancel_checkout_url':_0x38f02e,'complete_checkout_url':_0xc05080,'complete_payment_url':_0xc05080,'merchant_reference_id':_0x17a309,'description':_0x3fe875(0x183)+_0x17a309,'country':'GB','payment_method_types_include':[_0x3fe875(0x182),_0x3fe875(0x1db)],'custom_elements':{'display_description':!![]}},_0x116282=Date['now']();try{console[_0x3fe875(0x1d5)]('===\x20RAPYD\x20API\x20REQUEST\x20(White\x20Domain\x20-\x20Updated\x20Format)\x20==='),console[_0x3fe875(0x1d5)]('URL:',this['apiUrl']),console[_0x3fe875(0x1d5)](_0x3fe875(0x1d1),JSON[_0x3fe875(0x1e5)](_0x371ffc,null,0x2)),console[_0x3fe875(0x1d5)](_0x3fe875(0x1aa)+_0x2b4017+_0x3fe875(0x1b2)),console[_0x3fe875(0x1d5)](_0x3fe875(0x1b7)),loggerService_1[_0x3fe875(0x1b9)][_0x3fe875(0x1ae)](_0x3fe875(0x198),'/v1/hosted/payment_links','POST',_0x371ffc);const _0x2a97ce=await fetch(this[_0x3fe875(0x1c8)],{'method':_0x3fe875(0x19f),'headers':{'Content-Type':_0x3fe875(0x1a5),'User-Agent':'TesSoft\x20Payment\x20System/1.0'},'body':JSON[_0x3fe875(0x1e5)](_0x371ffc)}),_0x3fa8ba=Date[_0x3fe875(0x1cb)]()-_0x116282;console[_0x3fe875(0x1d5)](_0x3fe875(0x1e4)),console[_0x3fe875(0x1d5)](_0x3fe875(0x1be),_0x2a97ce[_0x3fe875(0x18f)]),console[_0x3fe875(0x1d5)](_0x3fe875(0x1dd),_0x2a97ce[_0x3fe875(0x1ca)]),console[_0x3fe875(0x1d5)](_0x3fe875(0x191),Object[_0x3fe875(0x199)](_0x2a97ce['headers'][_0x3fe875(0x195)]())),console['log'](_0x3fe875(0x1a1),_0x3fa8ba+'ms');const _0x48ed4c=await _0x2a97ce[_0x3fe875(0x1ac)]();console[_0x3fe875(0x1d5)](_0x3fe875(0x18d),_0x48ed4c);if(!_0x2a97ce['ok']){console['error'](_0x3fe875(0x1c7)),console[_0x3fe875(0x1e2)](_0x3fe875(0x1c4),_0x2a97ce['status']),console['error'](_0x3fe875(0x1da),_0x48ed4c),loggerService_1[_0x3fe875(0x1b9)][_0x3fe875(0x1c0)](_0x3fe875(0x198),_0x3fe875(0x1b0),_0x2a97ce['status'],_0x48ed4c,_0x3fa8ba),loggerService_1['loggerService'][_0x3fe875(0x181)](_0x3fe875(0x198),_0x3fe875(0x1b0),'HTTP\x20'+_0x2a97ce['status']+':\x20'+_0x48ed4c);throw new Error(_0x3fe875(0x1cd)+_0x2a97ce[_0x3fe875(0x18f)]+_0x3fe875(0x1bf)+_0x48ed4c);}let _0x289cff;try{_0x289cff=JSON[_0x3fe875(0x1df)](_0x48ed4c);}catch(_0x45a553){console[_0x3fe875(0x1e2)](_0x3fe875(0x19c),_0x45a553),loggerService_1['loggerService']['logWhiteDomainError'](_0x3fe875(0x198),'/v1/hosted/payment_links',_0x3fe875(0x1cc)+_0x45a553);throw new Error('Invalid\x20JSON\x20response\x20from\x20Rapyd\x20API:\x20'+_0x48ed4c);}console['log'](_0x3fe875(0x1a0)),console[_0x3fe875(0x1d5)](_0x3fe875(0x1de),JSON[_0x3fe875(0x1e5)](_0x289cff,null,0x2)),loggerService_1['loggerService'][_0x3fe875(0x1c0)](_0x3fe875(0x198),'/v1/hosted/payment_links',_0x2a97ce[_0x3fe875(0x18f)],_0x289cff,_0x3fa8ba);if(_0x289cff[_0x3fe875(0x18f)]?.['status']!==_0x3fe875(0x19d)){const _0x336013=_0x289cff['status']?.[_0x3fe875(0x1d4)]||_0x3fe875(0x1a9),_0xc39552=_0x289cff[_0x3fe875(0x18f)]?.[_0x3fe875(0x190)]||_0x3fe875(0x1c2);console[_0x3fe875(0x1e2)]('===\x20RAPYD\x20API\x20BUSINESS\x20ERROR\x20==='),console['error'](_0x3fe875(0x1a7),_0xc39552),console[_0x3fe875(0x1e2)](_0x3fe875(0x192),_0x336013),console['error'](_0x3fe875(0x188),_0x289cff[_0x3fe875(0x18f)]),loggerService_1[_0x3fe875(0x1b9)][_0x3fe875(0x181)](_0x3fe875(0x198),_0x3fe875(0x1b0),'Business\x20Error\x20('+_0xc39552+_0x3fe875(0x1c5)+_0x336013);throw new Error('Rapyd\x20API\x20error\x20('+_0xc39552+_0x3fe875(0x1c5)+_0x336013);}if(!_0x289cff[_0x3fe875(0x1cf)]?.['id']||!_0x289cff['data']?.['redirect_url']){console[_0x3fe875(0x1e2)]('===\x20RAPYD\x20API\x20INCOMPLETE\x20RESPONSE\x20==='),console['error'](_0x3fe875(0x180)),console[_0x3fe875(0x1e2)](_0x3fe875(0x197),_0x289cff[_0x3fe875(0x1cf)]),loggerService_1[_0x3fe875(0x1b9)][_0x3fe875(0x181)](_0x3fe875(0x198),_0x3fe875(0x1b0),_0x3fe875(0x1af));throw new Error('Invalid\x20response\x20from\x20Rapyd\x20API:\x20missing\x20id\x20or\x20redirect_url');}return console['log'](_0x3fe875(0x186)),console[_0x3fe875(0x1d5)](_0x3fe875(0x1e3),_0x289cff['data']['id']),console['log'](_0x3fe875(0x1ce),_0x289cff[_0x3fe875(0x1cf)][_0x3fe875(0x1b6)]),console[_0x3fe875(0x1d5)]('üá¨üáß\x20Country\x20used:\x20'+_0x2b4017+'\x20(GB\x20-\x20Britain)'),console['log'](_0x3fe875(0x1b7)),{'gateway_payment_id':_0x289cff[_0x3fe875(0x1cf)]['id'],'payment_url':_0x289cff[_0x3fe875(0x1cf)][_0x3fe875(0x1b6)]};}catch(_0x3dd490){console[_0x3fe875(0x1e2)](_0x3fe875(0x1b5)),console['error'](_0x3fe875(0x1ad),_0x3dd490),loggerService_1[_0x3fe875(0x1b9)][_0x3fe875(0x181)](_0x3fe875(0x198),'/v1/hosted/payment_links',_0x3dd490);if(_0x3dd490 instanceof Error){console['error']('Error\x20message:',_0x3dd490[_0x3fe875(0x1d4)]),console['error'](_0x3fe875(0x1d9),_0x3dd490[_0x3fe875(0x1d6)]);throw new Error('Failed\x20to\x20create\x20Rapyd\x20payment\x20link:\x20'+_0x3dd490[_0x3fe875(0x1d4)]);}throw new Error(_0x3fe875(0x18b));}}async[a42_0x376781(0x1b8)](_0x14d0ab){const _0x5d3278=a42_0x376781,_0x24eb82=Date[_0x5d3278(0x1cb)]();try{loggerService_1[_0x5d3278(0x1b9)]['logWhiteDomainRequest'](_0x5d3278(0x198),_0x5d3278(0x1a4)+_0x14d0ab,_0x5d3278(0x18c),{});const _0xbded5e=await fetch(this['apiUrl']+'/'+_0x14d0ab,{'method':'GET','headers':{'Content-Type':_0x5d3278(0x1a5),'User-Agent':_0x5d3278(0x1b1)}}),_0x546cfc=Date['now']()-_0x24eb82;if(!_0xbded5e['ok']){const _0x487fba=await _0xbded5e['text']();loggerService_1[_0x5d3278(0x1b9)][_0x5d3278(0x1c0)](_0x5d3278(0x198),_0x5d3278(0x1a4)+_0x14d0ab,_0xbded5e['status'],_0x487fba,_0x546cfc);throw new Error(_0x5d3278(0x1cd)+_0xbded5e[_0x5d3278(0x18f)]);}const _0x30c05b=await _0xbded5e['json']();loggerService_1[_0x5d3278(0x1b9)][_0x5d3278(0x1c0)]('rapyd','/v1/hosted/payment_links/'+_0x14d0ab,_0xbded5e[_0x5d3278(0x18f)],_0x30c05b,_0x546cfc);if(_0x30c05b[_0x5d3278(0x18f)]?.[_0x5d3278(0x18f)]!==_0x5d3278(0x19d)){loggerService_1[_0x5d3278(0x1b9)][_0x5d3278(0x181)](_0x5d3278(0x198),_0x5d3278(0x1a4)+_0x14d0ab,_0x5d3278(0x1ba)+(_0x30c05b[_0x5d3278(0x18f)]?.[_0x5d3278(0x1d4)]||_0x5d3278(0x1d7)));throw new Error(_0x5d3278(0x1ba)+(_0x30c05b[_0x5d3278(0x18f)]?.[_0x5d3278(0x1d4)]||_0x5d3278(0x1d7)));}let _0x24ddb4=_0x5d3278(0x1dc);if(_0x30c05b[_0x5d3278(0x1cf)]?.[_0x5d3278(0x18f)])switch(_0x30c05b[_0x5d3278(0x1cf)][_0x5d3278(0x18f)][_0x5d3278(0x1e0)]()){case _0x5d3278(0x17b):_0x24ddb4=_0x5d3278(0x17d);break;case _0x5d3278(0x1b3):_0x24ddb4='FAILED';break;case'EXP':_0x24ddb4=_0x5d3278(0x17f);break;case _0x5d3278(0x1c9):_0x24ddb4=_0x5d3278(0x187);break;case _0x5d3278(0x1a8):case _0x5d3278(0x1a6):default:_0x24ddb4=_0x5d3278(0x1dc);break;}return{'status':_0x24ddb4,'amount':_0x30c05b[_0x5d3278(0x1cf)]?.[_0x5d3278(0x1c6)],'currency':_0x30c05b[_0x5d3278(0x1cf)]?.[_0x5d3278(0x189)]};}catch(_0x6683cf){console['error'](_0x5d3278(0x193),_0x6683cf),loggerService_1[_0x5d3278(0x1b9)][_0x5d3278(0x181)](_0x5d3278(0x198),_0x5d3278(0x1a4)+_0x14d0ab,_0x6683cf);throw new Error('Failed\x20to\x20verify\x20Rapyd\x20payment:\x20'+(_0x6683cf instanceof Error?_0x6683cf[_0x5d3278(0x1d4)]:_0x5d3278(0x1d7)));}}async[a42_0x376781(0x19a)](_0x50ddfe){const _0x41ef8c=a42_0x376781;console['log']('Processing\x20Rapyd\x20webhook:',_0x50ddfe);let _0x57027f='PENDING';switch(_0x50ddfe[_0x41ef8c(0x1d2)]?.[_0x41ef8c(0x1e0)]()){case'PAYMENT_COMPLETED':_0x50ddfe[_0x41ef8c(0x1cf)]?.[_0x41ef8c(0x1e1)]===!![]&&_0x50ddfe['data']?.['status']===_0x41ef8c(0x17b)?_0x57027f=_0x41ef8c(0x17d):_0x57027f='PENDING';break;case _0x41ef8c(0x17c):_0x57027f='FAILED';break;case _0x41ef8c(0x1a3):_0x57027f='EXPIRED';break;case'PAYMENT_FAILED':_0x57027f=_0x41ef8c(0x187);break;default:switch(_0x50ddfe['data']?.[_0x41ef8c(0x18f)]?.[_0x41ef8c(0x1e0)]()){case _0x41ef8c(0x17b):_0x50ddfe['data']?.[_0x41ef8c(0x1e1)]===!![]?_0x57027f=_0x41ef8c(0x17d):_0x57027f=_0x41ef8c(0x187);break;case _0x41ef8c(0x1b3):_0x57027f='FAILED';break;case'EXP':_0x57027f=_0x41ef8c(0x17f);break;case _0x41ef8c(0x1c9):_0x57027f=_0x41ef8c(0x187);break;case _0x41ef8c(0x1a8):case _0x41ef8c(0x1a6):default:_0x57027f=_0x41ef8c(0x1dc);break;}break;}return{'paymentId':_0x50ddfe[_0x41ef8c(0x1cf)]?.['merchant_reference_id']||'','status':_0x57027f,'amount':_0x50ddfe[_0x41ef8c(0x1cf)]?.[_0x41ef8c(0x1c6)],'currency':_0x50ddfe['data']?.['currency']};}}function a42_0x40ce(){const _0x237854=['üí≥\x20Payment\x20Methods:\x20gb_visa_card,\x20gb_mastercard_card','verifyPayment','loggerService','Rapyd\x20API\x20error:\x20','34FhUOgn','324uuapiE','11929452IrdJfZ','Status:',',\x20body:\x20','logWhiteDomainResponse','326408WtCdwn','UNKNOWN','824705yFeMqT','HTTP\x20Status:','):\x20','amount','===\x20RAPYD\x20API\x20ERROR\x20===','apiUrl','ERR','statusText','now','JSON\x20Parse\x20Error:\x20','HTTP\x20error!\x20status:\x20','Redirect\x20URL:','data','27eJErQR','Request\x20Body\x20(Updated\x20Format):','type','https://tesoft.uk/gateway/fail.php?id=','message','log','stack','Unknown\x20error','RapydService','Error\x20stack:','Response\x20Body:','gb_mastercard_card','PENDING','Status\x20Text:','Parsed\x20Result:','parse','toUpperCase','paid','error','Payment\x20Link\x20ID:','===\x20RAPYD\x20API\x20RESPONSE\x20(White\x20Domain)\x20===','stringify','CLO','PAYMENT_CANCELED','PAID','__esModule','EXPIRED','Missing\x20id\x20or\x20redirect_url\x20in\x20response','logWhiteDomainError','gb_visa_card','ORDER:\x20','41630BFsBJc','üåê\x20Rapyd\x20service\x20initialized\x20with\x20white\x20domain\x20proxy','===\x20RAPYD\x20SUCCESS\x20===','FAILED','Full\x20Error\x20Data:','currency','12BUOjIj','Failed\x20to\x20create\x20Rapyd\x20payment\x20link:\x20Unknown\x20error','GET','Raw\x20Response\x20Body:','331544AIRHca','status','error_code','Headers:','Error\x20Message:','Rapyd\x20payment\x20verification\x20error:','defineProperty','entries','7870DRXAvm','Response\x20data:','rapyd','fromEntries','processWebhook','250xcqFaS','Failed\x20to\x20parse\x20JSON\x20response:','SUCCESS','https://tesoft.uk/gateway/success.php?id=','POST','===\x20PARSED\x20RAPYD\x20RESPONSE\x20===','Response\x20Time:','üá¨üáß\x20Using\x20GB\x20(Britain)\x20as\x20country\x20for\x20Rapyd\x20payment\x20link','PAYMENT_EXPIRED','/v1/hosted/payment_links/','application/json','ACT','Error\x20Code:','NEW','Unknown\x20error\x20from\x20Rapyd\x20API','üá¨üáß\x20Country:\x20','https://tesoft.uk/gateway/rapyd/','text','Error\x20details:','logWhiteDomainRequest','Incomplete\x20response:\x20missing\x20id\x20or\x20redirect_url','/v1/hosted/payment_links','TesSoft\x20Payment\x20System/1.0','\x20(always\x20GB\x20for\x20Rapyd)','CAN','212553dYdYgQ','===\x20RAPYD\x20SERVICE\x20ERROR\x20===','redirect_url'];a42_0x40ce=function(){return _0x237854;};return a42_0x40ce();}exports[a42_0x376781(0x1d8)]=RapydService;