'use strict';const a45_0x285463=a45_0x3698;function a45_0x3363(){const _0x2344f0=['2737604snNjYa','PENDING','Rapyd\x20payment\x20verification\x20error:','6mZusyk','type','EXP','168194bkefjf','https://tesoft.uk/gateway/success.php?id=','Response\x20data:',',\x20body:\x20','üá¨üáß\x20Country:\x20','üåê\x20Rapyd\x20service\x20initialized\x20with\x20white\x20domain\x20proxy','Failed\x20to\x20create\x20Rapyd\x20payment\x20link:\x20Unknown\x20error','last4','1148xeNfhm','35NtDPNu','URL:','===\x20RAPYD\x20API\x20INCOMPLETE\x20RESPONSE\x20===','Invalid\x20JSON\x20response\x20from\x20Rapyd\x20API:\x20','===\x20RAPYD\x20API\x20BUSINESS\x20ERROR\x20===','Error\x20stack:','stack','Rapyd\x20API\x20error\x20(','Processing\x20Rapyd\x20webhook:','entries','Response\x20Body:','Headers:','statusText','status','Raw\x20Response\x20Body:','gb_visa_card','json','../loggerService','headers','TesSoft\x20Payment\x20System/1.0','Response\x20Time:','rapyd','20FjQGwp','Error\x20Code:','SUCCESS','Parsed\x20Result:','===\x20PARSED\x20RAPYD\x20RESPONSE\x20===','15NMMEoh','Rapyd\x20API\x20error:\x20','Failed\x20to\x20create\x20Rapyd\x20payment\x20link:\x20','424KItRjM','GET','error','Failed\x20to\x20parse\x20JSON\x20response:','failure_code','===\x20RAPYD\x20SUCCESS\x20===','EXPIRED','Failed\x20to\x20verify\x20Rapyd\x20payment:\x20','/v1/hosted/payment_links','Redirect\x20URL:','logWhiteDomainError','text','logWhiteDomainRequest','üá¨üáß\x20Country\x20used:\x20','82852ZWaOyJ','apiUrl','none','FAILED','errorCode','toUpperCase','log','stringify','amount','Error\x20message:','POST','üá¨üáß\x20Using\x20GB\x20(Britain)\x20as\x20country\x20for\x20Rapyd\x20payment\x20link','loggerService','now','Invalid\x20response\x20from\x20Rapyd\x20API:\x20missing\x20id\x20or\x20redirect_url','\x20(GB\x20-\x20Britain)','payment_method_type','87326uNoTmD','CAN','redirect_url','ACT','data','https://tesoft.uk/gateway/fail.php?id=','Full\x20Error\x20Data:','CLO','fromEntries','943002iKOgbB','1529cjubfM','HTTP\x20error!\x20status:\x20','createPaymentLink','/v1/hosted/payment_links/','error_code','failure_message','payment_method_data','Incomplete\x20response:\x20missing\x20id\x20or\x20redirect_url','HTTP\x20Status:','RapydService','107472rOilZO','PAID','merchant_reference_id','Unknown\x20error','logWhiteDomainResponse','failureCode','Business\x20Error\x20(','HTTP\x20','PAYMENT_EXPIRED','Missing\x20id\x20or\x20redirect_url\x20in\x20response','üîÑ\x20Rapyd\x20webhook\x20processed:\x20status=','gb_mastercard_card','PAYMENT_COMPLETED','parse','ERR','application/json','===\x20RAPYD\x20API\x20REQUEST\x20(White\x20Domain\x20-\x20Updated\x20Format)\x20===','Status:','===\x20RAPYD\x20API\x20ERROR\x20===','message','paymentMethod','__esModule','3778182laiNof','):\x20','paid','cardLast4','verifyPayment','===\x20RAPYD\x20API\x20RESPONSE\x20(White\x20Domain)\x20===','Unknown\x20error\x20from\x20Rapyd\x20API'];a45_0x3363=function(){return _0x2344f0;};return a45_0x3363();}(function(_0x449e53,_0x3504cd){const _0x1a55b7=a45_0x3698,_0x5d4408=_0x449e53();while(!![]){try{const _0x48a556=parseInt(_0x1a55b7(0x109))/0x1*(-parseInt(_0x1a55b7(0x12b))/0x2)+-parseInt(_0x1a55b7(0xe2))/0x3*(-parseInt(_0x1a55b7(0xdf))/0x4)+parseInt(_0x1a55b7(0xee))/0x5*(parseInt(_0x1a55b7(0xb7))/0x6)+-parseInt(_0x1a55b7(0x11a))/0x7*(-parseInt(_0x1a55b7(0x10c))/0x8)+parseInt(_0x1a55b7(0xd8))/0x9*(parseInt(_0x1a55b7(0x104))/0xa)+-parseInt(_0x1a55b7(0xb8))/0xb*(parseInt(_0x1a55b7(0xc2))/0xc)+-parseInt(_0x1a55b7(0xe5))/0xd*(parseInt(_0x1a55b7(0xed))/0xe);if(_0x48a556===_0x3504cd)break;else _0x5d4408['push'](_0x5d4408['shift']());}catch(_0x27633b){_0x5d4408['push'](_0x5d4408['shift']());}}}(a45_0x3363,0xee11a));Object['defineProperty'](exports,a45_0x285463(0xd7),{'value':!![]}),exports['RapydService']=void 0x0;function a45_0x3698(_0x680391,_0x474b8f){const _0x3363d1=a45_0x3363();return a45_0x3698=function(_0x3698d1,_0x1eb2ea){_0x3698d1=_0x3698d1-0xb1;let _0x4fab67=_0x3363d1[_0x3698d1];return _0x4fab67;},a45_0x3698(_0x680391,_0x474b8f);}const loggerService_1=require(a45_0x285463(0xff));class RapydService{constructor(){const _0x23afef=a45_0x285463;this[_0x23afef(0x11b)]='https://tesoft.uk/gateway/rapyd/',console[_0x23afef(0x120)](_0x23afef(0xea));}async[a45_0x285463(0xba)](_0x4fccca){const _0x165b43=a45_0x285463,{orderId:_0x47cbf9,orderName:_0x4ca8eb,amount:_0x414c0e,currency:_0x1553f7,usage:_0x1ca315,maxPayments:_0x4ca13d,successUrl:_0x52538c,failUrl:_0x6129f3}=_0x4fccca,_0x91daf9=_0x1553f7[_0x165b43(0x11f)](),_0x31d398='GB';console[_0x165b43(0x120)](_0x165b43(0x125));const _0x26dc42=_0x165b43(0xe6)+_0x47cbf9,_0x5f4ffd=_0x165b43(0xb3)+_0x47cbf9,_0x49b96a={'amount':_0x414c0e,'currency':_0x91daf9,'cancel_checkout_url':_0x5f4ffd,'complete_checkout_url':_0x26dc42,'complete_payment_url':_0x26dc42,'merchant_reference_id':_0x47cbf9,'description':'ORDER:\x20'+_0x47cbf9,'country':'GB','payment_method_types_include':[_0x165b43(0xfd),_0x165b43(0xcd)],'custom_elements':{'display_description':!![]}},_0x194daf=Date[_0x165b43(0x127)]();try{console[_0x165b43(0x120)](_0x165b43(0xd2)),console[_0x165b43(0x120)](_0x165b43(0xef),this[_0x165b43(0x11b)]),console[_0x165b43(0x120)]('Request\x20Body\x20(Updated\x20Format):',JSON[_0x165b43(0x121)](_0x49b96a,null,0x2)),console[_0x165b43(0x120)](_0x165b43(0xe9)+_0x31d398+'\x20(always\x20GB\x20for\x20Rapyd)'),console[_0x165b43(0x120)]('üí≥\x20Payment\x20Methods:\x20gb_visa_card,\x20gb_mastercard_card'),loggerService_1['loggerService'][_0x165b43(0x118)](_0x165b43(0x103),_0x165b43(0x114),_0x165b43(0x124),_0x49b96a);const _0x4b88f8=await fetch(this[_0x165b43(0x11b)],{'method':_0x165b43(0x124),'headers':{'Content-Type':_0x165b43(0xd1),'User-Agent':_0x165b43(0x101)},'body':JSON['stringify'](_0x49b96a)}),_0x3ac4f8=Date[_0x165b43(0x127)]()-_0x194daf;console[_0x165b43(0x120)](_0x165b43(0xdd)),console[_0x165b43(0x120)](_0x165b43(0xd3),_0x4b88f8[_0x165b43(0xfb)]),console[_0x165b43(0x120)]('Status\x20Text:',_0x4b88f8[_0x165b43(0xfa)]),console[_0x165b43(0x120)](_0x165b43(0xf9),Object[_0x165b43(0xb6)](_0x4b88f8[_0x165b43(0x100)][_0x165b43(0xf7)]())),console[_0x165b43(0x120)](_0x165b43(0x102),_0x3ac4f8+'ms');const _0x59e3e4=await _0x4b88f8[_0x165b43(0x117)]();console['log'](_0x165b43(0xfc),_0x59e3e4);if(!_0x4b88f8['ok']){console['error'](_0x165b43(0xd4)),console[_0x165b43(0x10e)](_0x165b43(0xc0),_0x4b88f8[_0x165b43(0xfb)]),console[_0x165b43(0x10e)](_0x165b43(0xf8),_0x59e3e4),loggerService_1[_0x165b43(0x126)][_0x165b43(0xc6)](_0x165b43(0x103),_0x165b43(0x114),_0x4b88f8['status'],_0x59e3e4,_0x3ac4f8),loggerService_1['loggerService']['logWhiteDomainError']('rapyd',_0x165b43(0x114),_0x165b43(0xc9)+_0x4b88f8[_0x165b43(0xfb)]+':\x20'+_0x59e3e4);throw new Error(_0x165b43(0xb9)+_0x4b88f8['status']+_0x165b43(0xe8)+_0x59e3e4);}let _0x4b2c37;try{_0x4b2c37=JSON[_0x165b43(0xcf)](_0x59e3e4);}catch(_0x593e1e){console['error'](_0x165b43(0x10f),_0x593e1e),loggerService_1[_0x165b43(0x126)]['logWhiteDomainError']('rapyd',_0x165b43(0x114),'JSON\x20Parse\x20Error:\x20'+_0x593e1e);throw new Error(_0x165b43(0xf1)+_0x59e3e4);}console[_0x165b43(0x120)](_0x165b43(0x108)),console['log'](_0x165b43(0x107),JSON[_0x165b43(0x121)](_0x4b2c37,null,0x2)),loggerService_1[_0x165b43(0x126)]['logWhiteDomainResponse']('rapyd',_0x165b43(0x114),_0x4b88f8[_0x165b43(0xfb)],_0x4b2c37,_0x3ac4f8);if(_0x4b2c37['status']?.[_0x165b43(0xfb)]!==_0x165b43(0x106)){const _0x730190=_0x4b2c37[_0x165b43(0xfb)]?.[_0x165b43(0xd5)]||_0x165b43(0xde),_0x5db1fc=_0x4b2c37[_0x165b43(0xfb)]?.[_0x165b43(0xbc)]||'UNKNOWN';console['error'](_0x165b43(0xf2)),console['error'](_0x165b43(0x105),_0x5db1fc),console['error']('Error\x20Message:',_0x730190),console[_0x165b43(0x10e)](_0x165b43(0xb4),_0x4b2c37['status']),loggerService_1[_0x165b43(0x126)][_0x165b43(0x116)](_0x165b43(0x103),_0x165b43(0x114),_0x165b43(0xc8)+_0x5db1fc+_0x165b43(0xd9)+_0x730190);throw new Error(_0x165b43(0xf5)+_0x5db1fc+'):\x20'+_0x730190);}if(!_0x4b2c37[_0x165b43(0xb2)]?.['id']||!_0x4b2c37[_0x165b43(0xb2)]?.[_0x165b43(0x12d)]){console[_0x165b43(0x10e)](_0x165b43(0xf0)),console[_0x165b43(0x10e)](_0x165b43(0xcb)),console[_0x165b43(0x10e)](_0x165b43(0xe7),_0x4b2c37[_0x165b43(0xb2)]),loggerService_1[_0x165b43(0x126)]['logWhiteDomainError'](_0x165b43(0x103),_0x165b43(0x114),_0x165b43(0xbf));throw new Error(_0x165b43(0x128));}return console['log'](_0x165b43(0x111)),console[_0x165b43(0x120)]('Payment\x20Link\x20ID:',_0x4b2c37[_0x165b43(0xb2)]['id']),console[_0x165b43(0x120)](_0x165b43(0x115),_0x4b2c37[_0x165b43(0xb2)][_0x165b43(0x12d)]),console['log'](_0x165b43(0x119)+_0x31d398+_0x165b43(0x129)),console[_0x165b43(0x120)]('üí≥\x20Payment\x20Methods:\x20gb_visa_card,\x20gb_mastercard_card'),{'gateway_payment_id':_0x4b2c37[_0x165b43(0xb2)]['id'],'payment_url':_0x4b2c37[_0x165b43(0xb2)][_0x165b43(0x12d)]};}catch(_0x2c570c){console[_0x165b43(0x10e)]('===\x20RAPYD\x20SERVICE\x20ERROR\x20==='),console[_0x165b43(0x10e)]('Error\x20details:',_0x2c570c),loggerService_1[_0x165b43(0x126)][_0x165b43(0x116)](_0x165b43(0x103),_0x165b43(0x114),_0x2c570c);if(_0x2c570c instanceof Error){console['error'](_0x165b43(0x123),_0x2c570c[_0x165b43(0xd5)]),console[_0x165b43(0x10e)](_0x165b43(0xf3),_0x2c570c[_0x165b43(0xf4)]);throw new Error(_0x165b43(0x10b)+_0x2c570c['message']);}throw new Error(_0x165b43(0xeb));}}async[a45_0x285463(0xdc)](_0x206b59){const _0x5b269d=a45_0x285463,_0x44a14d=Date[_0x5b269d(0x127)]();try{loggerService_1[_0x5b269d(0x126)]['logWhiteDomainRequest'](_0x5b269d(0x103),_0x5b269d(0xbb)+_0x206b59,_0x5b269d(0x10d),{});const _0x395137=await fetch(this[_0x5b269d(0x11b)]+'/'+_0x206b59,{'method':_0x5b269d(0x10d),'headers':{'Content-Type':_0x5b269d(0xd1),'User-Agent':_0x5b269d(0x101)}}),_0x208f34=Date[_0x5b269d(0x127)]()-_0x44a14d;if(!_0x395137['ok']){const _0x267019=await _0x395137[_0x5b269d(0x117)]();loggerService_1[_0x5b269d(0x126)][_0x5b269d(0xc6)](_0x5b269d(0x103),_0x5b269d(0xbb)+_0x206b59,_0x395137[_0x5b269d(0xfb)],_0x267019,_0x208f34);throw new Error(_0x5b269d(0xb9)+_0x395137['status']);}const _0xb2b6f8=await _0x395137[_0x5b269d(0xfe)]();loggerService_1[_0x5b269d(0x126)][_0x5b269d(0xc6)](_0x5b269d(0x103),'/v1/hosted/payment_links/'+_0x206b59,_0x395137[_0x5b269d(0xfb)],_0xb2b6f8,_0x208f34);if(_0xb2b6f8[_0x5b269d(0xfb)]?.[_0x5b269d(0xfb)]!==_0x5b269d(0x106)){loggerService_1[_0x5b269d(0x126)][_0x5b269d(0x116)](_0x5b269d(0x103),_0x5b269d(0xbb)+_0x206b59,_0x5b269d(0x10a)+(_0xb2b6f8[_0x5b269d(0xfb)]?.[_0x5b269d(0xd5)]||_0x5b269d(0xc5)));throw new Error(_0x5b269d(0x10a)+(_0xb2b6f8[_0x5b269d(0xfb)]?.[_0x5b269d(0xd5)]||_0x5b269d(0xc5)));}let _0x4b277b=_0x5b269d(0xe0);if(_0xb2b6f8['data']?.[_0x5b269d(0xfb)])switch(_0xb2b6f8[_0x5b269d(0xb2)][_0x5b269d(0xfb)][_0x5b269d(0x11f)]()){case _0x5b269d(0xb5):_0x4b277b='PAID';break;case _0x5b269d(0x12c):_0x4b277b='FAILED';break;case _0x5b269d(0xe4):_0x4b277b=_0x5b269d(0x112);break;case'ERR':_0x4b277b=_0x5b269d(0x11d);break;case'NEW':case _0x5b269d(0xb1):default:_0x4b277b='PENDING';break;}return{'status':_0x4b277b,'amount':_0xb2b6f8['data']?.[_0x5b269d(0x122)],'currency':_0xb2b6f8[_0x5b269d(0xb2)]?.['currency']};}catch(_0x273307){console[_0x5b269d(0x10e)](_0x5b269d(0xe1),_0x273307),loggerService_1['loggerService'][_0x5b269d(0x116)](_0x5b269d(0x103),_0x5b269d(0xbb)+_0x206b59,_0x273307);throw new Error(_0x5b269d(0x113)+(_0x273307 instanceof Error?_0x273307[_0x5b269d(0xd5)]:_0x5b269d(0xc5)));}}async['processWebhook'](_0x4560fd){const _0x1e45b9=a45_0x285463;console['log'](_0x1e45b9(0xf6),_0x4560fd);let _0x86ffe8='PENDING',_0x3a2976;_0x4560fd[_0x1e45b9(0xb2)]?.[_0x1e45b9(0xbd)]&&(_0x3a2976=_0x4560fd[_0x1e45b9(0xb2)][_0x1e45b9(0xbd)],console[_0x1e45b9(0x120)]('üí•\x20Rapyd\x20failure\x20message:\x20'+_0x3a2976));switch(_0x4560fd[_0x1e45b9(0xe3)]?.[_0x1e45b9(0x11f)]()){case _0x1e45b9(0xce):_0x4560fd[_0x1e45b9(0xb2)]?.[_0x1e45b9(0xda)]===!![]&&_0x4560fd[_0x1e45b9(0xb2)]?.[_0x1e45b9(0xfb)]===_0x1e45b9(0xb5)?_0x86ffe8=_0x1e45b9(0xc3):_0x86ffe8=_0x1e45b9(0xe0);break;case'PAYMENT_CANCELED':_0x86ffe8='FAILED';break;case _0x1e45b9(0xca):_0x86ffe8='EXPIRED';break;case'PAYMENT_FAILED':_0x86ffe8=_0x1e45b9(0x11d);!_0x3a2976&&_0x4560fd[_0x1e45b9(0xb2)]?.[_0x1e45b9(0xbd)]&&(_0x3a2976=_0x4560fd[_0x1e45b9(0xb2)][_0x1e45b9(0xbd)]);break;default:switch(_0x4560fd[_0x1e45b9(0xb2)]?.[_0x1e45b9(0xfb)]?.[_0x1e45b9(0x11f)]()){case _0x1e45b9(0xb5):_0x4560fd[_0x1e45b9(0xb2)]?.[_0x1e45b9(0xda)]===!![]?_0x86ffe8='PAID':_0x86ffe8=_0x1e45b9(0x11d);break;case'CAN':_0x86ffe8=_0x1e45b9(0x11d);break;case _0x1e45b9(0xe4):_0x86ffe8=_0x1e45b9(0x112);break;case _0x1e45b9(0xd0):_0x86ffe8=_0x1e45b9(0x11d);!_0x3a2976&&_0x4560fd['data']?.[_0x1e45b9(0xbd)]&&(_0x3a2976=_0x4560fd[_0x1e45b9(0xb2)][_0x1e45b9(0xbd)]);break;case'NEW':case _0x1e45b9(0xb1):default:_0x86ffe8='PENDING';break;}break;}const _0x2b5f75={};return _0x4560fd[_0x1e45b9(0xb2)]?.[_0x1e45b9(0xbe)]?.[_0x1e45b9(0xec)]&&(_0x2b5f75[_0x1e45b9(0xdb)]=_0x4560fd[_0x1e45b9(0xb2)][_0x1e45b9(0xbe)][_0x1e45b9(0xec)]),_0x4560fd[_0x1e45b9(0xb2)]?.[_0x1e45b9(0x12a)]&&(_0x2b5f75[_0x1e45b9(0xd6)]=_0x4560fd[_0x1e45b9(0xb2)][_0x1e45b9(0x12a)]),_0x4560fd['data']?.['error_code']&&(_0x2b5f75[_0x1e45b9(0x11e)]=_0x4560fd[_0x1e45b9(0xb2)][_0x1e45b9(0xbc)]),_0x4560fd[_0x1e45b9(0xb2)]?.[_0x1e45b9(0x110)]&&(_0x2b5f75[_0x1e45b9(0xc7)]=_0x4560fd['data'][_0x1e45b9(0x110)]),console[_0x1e45b9(0x120)](_0x1e45b9(0xcc)+_0x86ffe8+',\x20failureMessage='+(_0x3a2976||_0x1e45b9(0x11c))),{'paymentId':_0x4560fd[_0x1e45b9(0xb2)]?.[_0x1e45b9(0xc4)]||'','status':_0x86ffe8,'amount':_0x4560fd['data']?.[_0x1e45b9(0x122)],'currency':_0x4560fd[_0x1e45b9(0xb2)]?.['currency'],'failureMessage':_0x3a2976,'additionalInfo':_0x2b5f75};}}exports[a45_0x285463(0xc1)]=RapydService;