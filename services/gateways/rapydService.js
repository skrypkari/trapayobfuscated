'use strict';const a48_0x4948b0=a48_0x3107;function a48_0x3107(_0x5b1ece,_0x41ceae){const _0x403e27=a48_0x403e();return a48_0x3107=function(_0x31075e,_0x4f3d81){_0x31075e=_0x31075e-0xe9;let _0x4b36e2=_0x403e27[_0x31075e];return _0x4b36e2;},a48_0x3107(_0x5b1ece,_0x41ceae);}function a48_0x403e(){const _0x593a32=['EXPIRED','/v1/hosted/payment_links','4291371xAaohx','payment_method_type','💳\x20Payment\x20Methods:\x20gb_visa_card,\x20gb_mastercard_card','PAYMENT_FAILED','Incomplete\x20response:\x20missing\x20id\x20or\x20redirect_url','stringify','\x20\x20\x20expiration:\x20','message','gb_mastercard_card','🇬🇧\x20Country\x20used:\x20','json','Raw\x20Response\x20Body:','requested_currency','Failed\x20to\x20verify\x20Rapyd\x20payment:\x20','\x20\x20\x20fixed_side:\x20buy','error','===\x20RAPYD\x20API\x20ERROR\x20===','defineProperty','296212tHbOTf','parse','HTTP\x20','318cSWuZN','RapydService','Payment\x20Link\x20ID:','🇬🇧\x20Using\x20GB\x20(Britain)\x20as\x20country\x20for\x20Rapyd\x20payment\x20link','Redirect\x20URL:','NEW','PAYMENT_CANCELED','toUpperCase',',\x20failureMessage=','loggerService','error_code','EUR','Rapyd\x20payment\x20verification\x20error:','===\x20RAPYD\x20SERVICE\x20ERROR\x20===','Error\x20stack:','processWebhook','logWhiteDomainError','headers','):\x20','Status\x20Text:','ORDER:\x20',',\x20body:\x20','Response\x20Body:','707ejdIOz','ACT','Invalid\x20JSON\x20response\x20from\x20Rapyd\x20API:\x20','💥\x20Rapyd\x20failure\x20message:\x20','SUCCESS','fromEntries','UNKNOWN','type','\x20\x20\x20requested_currency:\x20EUR','PAID','Missing\x20id\x20or\x20redirect_url\x20in\x20response','amount','last4','\x20(always\x20GB\x20for\x20Rapyd)','6705jvxpzS','Headers:','JSON\x20Parse\x20Error:\x20','payment_method_data','failure_code','log','===\x20RAPYD\x20API\x20INCOMPLETE\x20RESPONSE\x20===','Rapyd\x20API\x20error:\x20','Error\x20details:','===\x20RAPYD\x20API\x20BUSINESS\x20ERROR\x20===','===\x20RAPYD\x20API\x20RESPONSE\x20(White\x20Domain)\x20===','PENDING','Unknown\x20error\x20from\x20Rapyd\x20API','Error\x20Message:','CAN','Failed\x20to\x20parse\x20JSON\x20response:','HTTP\x20error!\x20status:\x20','🔄\x20Rapyd\x20webhook\x20processed:\x20status=','===\x20PARSED\x20RAPYD\x20RESPONSE\x20===','verifyPayment','3124ppzvpp','failure_message','currency','paymentMethod','FAILED','647578MIMwFq','GET','logWhiteDomainRequest','===\x20RAPYD\x20API\x20REQUEST\x20(White\x20Domain\x20-\x20Updated\x20Format)\x20===','text','redirect_url','failureCode','Failed\x20to\x20create\x20Rapyd\x20payment\x20link:\x20','Failed\x20to\x20create\x20Rapyd\x20payment\x20link:\x20Unknown\x20error','Business\x20Error\x20(','paid','8214016pzmBjN','6hjefIe','EXP','status','TesSoft\x20Payment\x20System/1.0','HTTP\x20Status:','https://tesoft.uk/gateway/success.php?id=','11988830rOatTK','Error\x20Code:','rapyd','https://tesoft.uk/gateway/fail.php?id=','cardLast4','apiUrl','Processing\x20Rapyd\x20webhook:','Unknown\x20error','createPaymentLink','/v1/hosted/payment_links/','data','entries','PAYMENT_COMPLETED','gb_visa_card','Request\x20Body\x20(Updated\x20Format):','logWhiteDomainResponse','\x20(GB\x20-\x20Britain)','floor','CLO','POST','__esModule','none','now','Full\x20Error\x20Data:','application/json'];a48_0x403e=function(){return _0x593a32;};return a48_0x403e();}(function(_0x3b08b9,_0x1c22ea){const _0x26336c=a48_0x3107,_0x48d546=_0x3b08b9();while(!![]){try{const _0x276de1=parseInt(_0x26336c(0x13c))/0x1+-parseInt(_0x26336c(0xfb))/0x2*(-parseInt(_0x26336c(0x148))/0x3)+parseInt(_0x26336c(0x137))/0x4*(-parseInt(_0x26336c(0x123))/0x5)+parseInt(_0x26336c(0xfe))/0x6*(parseInt(_0x26336c(0x115))/0x7)+-parseInt(_0x26336c(0x147))/0x8+parseInt(_0x26336c(0xe9))/0x9+parseInt(_0x26336c(0x14e))/0xa;if(_0x276de1===_0x1c22ea)break;else _0x48d546['push'](_0x48d546['shift']());}catch(_0x2f552d){_0x48d546['push'](_0x48d546['shift']());}}}(a48_0x403e,0x86774));Object[a48_0x4948b0(0xfa)](exports,a48_0x4948b0(0x162),{'value':!![]}),exports[a48_0x4948b0(0xff)]=void 0x0;const loggerService_1=require('../loggerService');class RapydService{constructor(){const _0x5edcac=a48_0x4948b0;this[_0x5edcac(0x153)]='https://tesoft.uk/gateway/rapyd/',console[_0x5edcac(0x128)]('🌐\x20Rapyd\x20service\x20initialized\x20with\x20white\x20domain\x20proxy');}async[a48_0x4948b0(0x156)](_0x9ab773){const _0x535bf3=a48_0x4948b0,{orderId:_0xc42ed9,orderName:_0x3734dc,amount:_0x255d0a,currency:_0x53af29,usage:_0x10e6c4,maxPayments:_0x4b0d4c,successUrl:_0x140daa,failUrl:_0x403583}=_0x9ab773,_0x3a6928=_0x53af29[_0x535bf3(0x105)](),_0x5b9811='GB';console[_0x535bf3(0x128)](_0x535bf3(0x101));const _0x31dc30=_0x535bf3(0x14d)+_0xc42ed9,_0x46cb56=_0x535bf3(0x151)+_0xc42ed9,_0x10c606={'amount':_0x255d0a,'currency':_0x3a6928,'cancel_checkout_url':_0x46cb56,'complete_checkout_url':_0x31dc30,'complete_payment_url':_0x31dc30,'merchant_reference_id':_0xc42ed9,'description':_0x535bf3(0x112)+_0xc42ed9,'country':'GB','payment_method_types_include':[_0x535bf3(0x15b),_0x535bf3(0xf1)],'custom_elements':{'display_description':!![]}};if(_0x3a6928!==_0x535bf3(0x109)){const _0x4c9fab=Math[_0x535bf3(0x15f)](Date[_0x535bf3(0x164)]()/0x3e8)+0x1e*0x3c;_0x10c606['fixed_side']='buy',_0x10c606[_0x535bf3(0xf5)]=_0x535bf3(0x109),_0x10c606['expiration']=_0x4c9fab,console[_0x535bf3(0x128)]('💱\x20Adding\x20currency\x20conversion\x20fields\x20for\x20'+_0x3a6928+'\x20->\x20EUR:'),console[_0x535bf3(0x128)](_0x535bf3(0xf7)),console['log'](_0x535bf3(0x11d)),console[_0x535bf3(0x128)](_0x535bf3(0xef)+_0x4c9fab+'\x20('+new Date(_0x4c9fab*0x3e8)['toISOString']()+')');}const _0x397ced=Date[_0x535bf3(0x164)]();try{console[_0x535bf3(0x128)](_0x535bf3(0x13f)),console['log']('URL:',this['apiUrl']),console[_0x535bf3(0x128)](_0x535bf3(0x15c),JSON[_0x535bf3(0xee)](_0x10c606,null,0x2)),console[_0x535bf3(0x128)]('🇬🇧\x20Country:\x20'+_0x5b9811+_0x535bf3(0x122)),console[_0x535bf3(0x128)](_0x535bf3(0xeb)),loggerService_1[_0x535bf3(0x107)][_0x535bf3(0x13e)](_0x535bf3(0x150),'/v1/hosted/payment_links',_0x535bf3(0x161),_0x10c606);const _0x49e8b5=await fetch(this[_0x535bf3(0x153)],{'method':'POST','headers':{'Content-Type':_0x535bf3(0x166),'User-Agent':_0x535bf3(0x14b)},'body':JSON[_0x535bf3(0xee)](_0x10c606)}),_0x5e6782=Date[_0x535bf3(0x164)]()-_0x397ced;console[_0x535bf3(0x128)](_0x535bf3(0x12d)),console[_0x535bf3(0x128)]('Status:',_0x49e8b5[_0x535bf3(0x14a)]),console[_0x535bf3(0x128)](_0x535bf3(0x111),_0x49e8b5['statusText']),console['log'](_0x535bf3(0x124),Object[_0x535bf3(0x11a)](_0x49e8b5[_0x535bf3(0x10f)][_0x535bf3(0x159)]())),console['log']('Response\x20Time:',_0x5e6782+'ms');const _0x36c31c=await _0x49e8b5[_0x535bf3(0x140)]();console['log'](_0x535bf3(0xf4),_0x36c31c);if(!_0x49e8b5['ok']){console[_0x535bf3(0xf8)](_0x535bf3(0xf9)),console[_0x535bf3(0xf8)](_0x535bf3(0x14c),_0x49e8b5['status']),console[_0x535bf3(0xf8)](_0x535bf3(0x114),_0x36c31c),loggerService_1['loggerService'][_0x535bf3(0x15d)](_0x535bf3(0x150),_0x535bf3(0x168),_0x49e8b5[_0x535bf3(0x14a)],_0x36c31c,_0x5e6782),loggerService_1[_0x535bf3(0x107)]['logWhiteDomainError'](_0x535bf3(0x150),'/v1/hosted/payment_links',_0x535bf3(0xfd)+_0x49e8b5['status']+':\x20'+_0x36c31c);throw new Error(_0x535bf3(0x133)+_0x49e8b5['status']+_0x535bf3(0x113)+_0x36c31c);}let _0x3ef403;try{_0x3ef403=JSON[_0x535bf3(0xfc)](_0x36c31c);}catch(_0x3965ce){console[_0x535bf3(0xf8)](_0x535bf3(0x132),_0x3965ce),loggerService_1[_0x535bf3(0x107)][_0x535bf3(0x10e)]('rapyd','/v1/hosted/payment_links',_0x535bf3(0x125)+_0x3965ce);throw new Error(_0x535bf3(0x117)+_0x36c31c);}console[_0x535bf3(0x128)](_0x535bf3(0x135)),console[_0x535bf3(0x128)]('Parsed\x20Result:',JSON[_0x535bf3(0xee)](_0x3ef403,null,0x2)),loggerService_1['loggerService'][_0x535bf3(0x15d)](_0x535bf3(0x150),'/v1/hosted/payment_links',_0x49e8b5[_0x535bf3(0x14a)],_0x3ef403,_0x5e6782);if(_0x3ef403['status']?.[_0x535bf3(0x14a)]!==_0x535bf3(0x119)){const _0x54fb4f=_0x3ef403['status']?.[_0x535bf3(0xf0)]||_0x535bf3(0x12f),_0xd07f25=_0x3ef403['status']?.[_0x535bf3(0x108)]||_0x535bf3(0x11b);console[_0x535bf3(0xf8)](_0x535bf3(0x12c)),console[_0x535bf3(0xf8)](_0x535bf3(0x14f),_0xd07f25),console[_0x535bf3(0xf8)](_0x535bf3(0x130),_0x54fb4f),console[_0x535bf3(0xf8)](_0x535bf3(0x165),_0x3ef403[_0x535bf3(0x14a)]),loggerService_1[_0x535bf3(0x107)][_0x535bf3(0x10e)](_0x535bf3(0x150),_0x535bf3(0x168),_0x535bf3(0x145)+_0xd07f25+_0x535bf3(0x110)+_0x54fb4f);throw new Error('Rapyd\x20API\x20error\x20('+_0xd07f25+_0x535bf3(0x110)+_0x54fb4f);}if(!_0x3ef403[_0x535bf3(0x158)]?.['id']||!_0x3ef403[_0x535bf3(0x158)]?.[_0x535bf3(0x141)]){console[_0x535bf3(0xf8)](_0x535bf3(0x129)),console[_0x535bf3(0xf8)](_0x535bf3(0x11f)),console[_0x535bf3(0xf8)]('Response\x20data:',_0x3ef403[_0x535bf3(0x158)]),loggerService_1[_0x535bf3(0x107)]['logWhiteDomainError']('rapyd',_0x535bf3(0x168),_0x535bf3(0xed));throw new Error('Invalid\x20response\x20from\x20Rapyd\x20API:\x20missing\x20id\x20or\x20redirect_url');}return console[_0x535bf3(0x128)]('===\x20RAPYD\x20SUCCESS\x20==='),console[_0x535bf3(0x128)](_0x535bf3(0x100),_0x3ef403[_0x535bf3(0x158)]['id']),console['log'](_0x535bf3(0x102),_0x3ef403['data'][_0x535bf3(0x141)]),console[_0x535bf3(0x128)](_0x535bf3(0xf2)+_0x5b9811+_0x535bf3(0x15e)),console[_0x535bf3(0x128)](_0x535bf3(0xeb)),{'gateway_payment_id':_0x3ef403[_0x535bf3(0x158)]['id'],'payment_url':_0x3ef403[_0x535bf3(0x158)][_0x535bf3(0x141)]};}catch(_0x2c1760){console[_0x535bf3(0xf8)](_0x535bf3(0x10b)),console['error'](_0x535bf3(0x12b),_0x2c1760),loggerService_1[_0x535bf3(0x107)]['logWhiteDomainError']('rapyd','/v1/hosted/payment_links',_0x2c1760);if(_0x2c1760 instanceof Error){console[_0x535bf3(0xf8)]('Error\x20message:',_0x2c1760['message']),console[_0x535bf3(0xf8)](_0x535bf3(0x10c),_0x2c1760['stack']);throw new Error(_0x535bf3(0x143)+_0x2c1760[_0x535bf3(0xf0)]);}throw new Error(_0x535bf3(0x144));}}async[a48_0x4948b0(0x136)](_0x1b9b46){const _0x57a5ac=a48_0x4948b0,_0x3256d5=Date['now']();try{loggerService_1[_0x57a5ac(0x107)][_0x57a5ac(0x13e)]('rapyd','/v1/hosted/payment_links/'+_0x1b9b46,'GET',{});const _0x1a70d3=await fetch(this[_0x57a5ac(0x153)]+'/'+_0x1b9b46,{'method':_0x57a5ac(0x13d),'headers':{'Content-Type':'application/json','User-Agent':_0x57a5ac(0x14b)}}),_0x1153b9=Date[_0x57a5ac(0x164)]()-_0x3256d5;if(!_0x1a70d3['ok']){const _0x348bee=await _0x1a70d3[_0x57a5ac(0x140)]();loggerService_1[_0x57a5ac(0x107)][_0x57a5ac(0x15d)]('rapyd',_0x57a5ac(0x157)+_0x1b9b46,_0x1a70d3[_0x57a5ac(0x14a)],_0x348bee,_0x1153b9);throw new Error(_0x57a5ac(0x133)+_0x1a70d3[_0x57a5ac(0x14a)]);}const _0x1d25f5=await _0x1a70d3[_0x57a5ac(0xf3)]();loggerService_1[_0x57a5ac(0x107)][_0x57a5ac(0x15d)](_0x57a5ac(0x150),_0x57a5ac(0x157)+_0x1b9b46,_0x1a70d3[_0x57a5ac(0x14a)],_0x1d25f5,_0x1153b9);if(_0x1d25f5['status']?.[_0x57a5ac(0x14a)]!==_0x57a5ac(0x119)){loggerService_1[_0x57a5ac(0x107)][_0x57a5ac(0x10e)](_0x57a5ac(0x150),_0x57a5ac(0x157)+_0x1b9b46,_0x57a5ac(0x12a)+(_0x1d25f5[_0x57a5ac(0x14a)]?.[_0x57a5ac(0xf0)]||_0x57a5ac(0x155)));throw new Error(_0x57a5ac(0x12a)+(_0x1d25f5[_0x57a5ac(0x14a)]?.[_0x57a5ac(0xf0)]||_0x57a5ac(0x155)));}let _0x404de4=_0x57a5ac(0x12e);if(_0x1d25f5[_0x57a5ac(0x158)]?.['status'])switch(_0x1d25f5['data'][_0x57a5ac(0x14a)][_0x57a5ac(0x105)]()){case _0x57a5ac(0x160):_0x404de4=_0x57a5ac(0x11e);break;case _0x57a5ac(0x131):_0x404de4=_0x57a5ac(0x13b);break;case _0x57a5ac(0x149):_0x404de4=_0x57a5ac(0x167);break;case'ERR':_0x404de4=_0x57a5ac(0x13b);break;case _0x57a5ac(0x103):case _0x57a5ac(0x116):default:_0x404de4=_0x57a5ac(0x12e);break;}return{'status':_0x404de4,'amount':_0x1d25f5[_0x57a5ac(0x158)]?.[_0x57a5ac(0x120)],'currency':_0x1d25f5[_0x57a5ac(0x158)]?.[_0x57a5ac(0x139)]};}catch(_0x47458a){console['error'](_0x57a5ac(0x10a),_0x47458a),loggerService_1['loggerService'][_0x57a5ac(0x10e)](_0x57a5ac(0x150),_0x57a5ac(0x157)+_0x1b9b46,_0x47458a);throw new Error(_0x57a5ac(0xf6)+(_0x47458a instanceof Error?_0x47458a[_0x57a5ac(0xf0)]:_0x57a5ac(0x155)));}}async[a48_0x4948b0(0x10d)](_0x10a3f5){const _0x2f7b09=a48_0x4948b0;console[_0x2f7b09(0x128)](_0x2f7b09(0x154),_0x10a3f5);let _0x59633d='PENDING',_0x1a3932;_0x10a3f5[_0x2f7b09(0x158)]?.[_0x2f7b09(0x138)]&&(_0x1a3932=_0x10a3f5[_0x2f7b09(0x158)][_0x2f7b09(0x138)],console[_0x2f7b09(0x128)](_0x2f7b09(0x118)+_0x1a3932));switch(_0x10a3f5[_0x2f7b09(0x11c)]?.[_0x2f7b09(0x105)]()){case _0x2f7b09(0x15a):_0x10a3f5[_0x2f7b09(0x158)]?.[_0x2f7b09(0x146)]===!![]&&_0x10a3f5[_0x2f7b09(0x158)]?.[_0x2f7b09(0x14a)]===_0x2f7b09(0x160)?_0x59633d=_0x2f7b09(0x11e):_0x59633d=_0x2f7b09(0x12e);break;case _0x2f7b09(0x104):_0x59633d=_0x2f7b09(0x13b);break;case'PAYMENT_EXPIRED':_0x59633d='EXPIRED';break;case _0x2f7b09(0xec):_0x59633d=_0x2f7b09(0x13b);!_0x1a3932&&_0x10a3f5[_0x2f7b09(0x158)]?.[_0x2f7b09(0x138)]&&(_0x1a3932=_0x10a3f5[_0x2f7b09(0x158)][_0x2f7b09(0x138)]);break;default:switch(_0x10a3f5[_0x2f7b09(0x158)]?.[_0x2f7b09(0x14a)]?.[_0x2f7b09(0x105)]()){case _0x2f7b09(0x160):_0x10a3f5[_0x2f7b09(0x158)]?.[_0x2f7b09(0x146)]===!![]?_0x59633d=_0x2f7b09(0x11e):_0x59633d='FAILED';break;case _0x2f7b09(0x131):_0x59633d='FAILED';break;case _0x2f7b09(0x149):_0x59633d='EXPIRED';break;case'ERR':_0x59633d='FAILED';!_0x1a3932&&_0x10a3f5['data']?.[_0x2f7b09(0x138)]&&(_0x1a3932=_0x10a3f5['data']['failure_message']);break;case _0x2f7b09(0x103):case'ACT':default:_0x59633d=_0x2f7b09(0x12e);break;}break;}const _0x44dc82={};return _0x10a3f5['data']?.[_0x2f7b09(0x126)]?.[_0x2f7b09(0x121)]&&(_0x44dc82[_0x2f7b09(0x152)]=_0x10a3f5['data']['payment_method_data'][_0x2f7b09(0x121)]),_0x10a3f5[_0x2f7b09(0x158)]?.[_0x2f7b09(0xea)]&&(_0x44dc82[_0x2f7b09(0x13a)]=_0x10a3f5[_0x2f7b09(0x158)]['payment_method_type']),_0x10a3f5[_0x2f7b09(0x158)]?.['error_code']&&(_0x44dc82['errorCode']=_0x10a3f5[_0x2f7b09(0x158)][_0x2f7b09(0x108)]),_0x10a3f5[_0x2f7b09(0x158)]?.['failure_code']&&(_0x44dc82[_0x2f7b09(0x142)]=_0x10a3f5[_0x2f7b09(0x158)][_0x2f7b09(0x127)]),console[_0x2f7b09(0x128)](_0x2f7b09(0x134)+_0x59633d+_0x2f7b09(0x106)+(_0x1a3932||_0x2f7b09(0x163))),{'paymentId':_0x10a3f5[_0x2f7b09(0x158)]?.['merchant_reference_id']||'','status':_0x59633d,'amount':_0x10a3f5[_0x2f7b09(0x158)]?.[_0x2f7b09(0x120)],'currency':_0x10a3f5[_0x2f7b09(0x158)]?.['currency'],'failureMessage':_0x1a3932,'additionalInfo':_0x44dc82};}}exports[a48_0x4948b0(0xff)]=RapydService;