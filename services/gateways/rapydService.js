'use strict';const a42_0x3e3f4a=a42_0x15e5;(function(_0x5d16d2,_0x51535b){const _0x194396=a42_0x15e5,_0x13bad7=_0x5d16d2();while(!![]){try{const _0x5619f4=-parseInt(_0x194396(0x206))/0x1*(parseInt(_0x194396(0x1e0))/0x2)+-parseInt(_0x194396(0x201))/0x3+-parseInt(_0x194396(0x225))/0x4+-parseInt(_0x194396(0x1cf))/0x5*(-parseInt(_0x194396(0x1d9))/0x6)+parseInt(_0x194396(0x1d2))/0x7+-parseInt(_0x194396(0x1da))/0x8+parseInt(_0x194396(0x1ef))/0x9;if(_0x5619f4===_0x51535b)break;else _0x13bad7['push'](_0x13bad7['shift']());}catch(_0x1e02dd){_0x13bad7['push'](_0x13bad7['shift']());}}}(a42_0x5766,0xde804));function a42_0x5766(){const _0x102074=['text','11976986KWJUPW','createPaymentLink','EXP','\x20(always\x20GB\x20for\x20Rapyd)','===\x20RAPYD\x20API\x20ERROR\x20===','CLO','message','1172202RncwNP','4278264phPymH','currency','Error\x20details:','verifyPayment','PAYMENT_COMPLETED','üá¨üáß\x20Country:\x20','1696614QfnqtR','Redirect\x20URL:','toUpperCase','logWhiteDomainRequest','gb_visa_card','Full\x20Error\x20Data:','logWhiteDomainError','FAILED','Failed\x20to\x20parse\x20JSON\x20response:','EXPIRED','Rapyd\x20API\x20error\x20(','Failed\x20to\x20create\x20Rapyd\x20payment\x20link:\x20Unknown\x20error','Error\x20message:','statusText','üá¨üáß\x20Country\x20used:\x20','20892645KUpobF','error','PAYMENT_EXPIRED','GET','gb_mastercard_card','PAID','Status:','NEW','Status\x20Text:','HTTP\x20error!\x20status:\x20','PAYMENT_FAILED','Error\x20Code:','Error\x20stack:','/v1/hosted/payment_links','data','merchant_reference_id','redirect_url','Incomplete\x20response:\x20missing\x20id\x20or\x20redirect_url','174420NncNFR','paid','Rapyd\x20payment\x20verification\x20error:','https://tesoft.uk/gateway/rapyd/','amount','2MxvgUW','Business\x20Error\x20(','SUCCESS','log','stringify','üí≥\x20Payment\x20Methods:\x20gb_visa_card,\x20gb_mastercard_card','JSON\x20Parse\x20Error:\x20','entries','now',',\x20body:\x20','Payment\x20Link\x20ID:','status','ACT','defineProperty','Response\x20data:','Request\x20Body\x20(Updated\x20Format):','HTTP\x20','ORDER:\x20','Failed\x20to\x20verify\x20Rapyd\x20payment:\x20','/v1/hosted/payment_links/','Failed\x20to\x20create\x20Rapyd\x20payment\x20link:\x20','stack','Invalid\x20response\x20from\x20Rapyd\x20API:\x20missing\x20id\x20or\x20redirect_url','===\x20RAPYD\x20SUCCESS\x20===','Rapyd\x20API\x20error:\x20','CAN','HTTP\x20Status:','Unknown\x20error\x20from\x20Rapyd\x20API','processWebhook','Response\x20Time:','rapyd','4107476ArHgLt','https://tesoft.uk/gateway/success.php?id=','apiUrl','\x20(GB\x20-\x20Britain)','logWhiteDomainResponse','https://tesoft.uk/gateway/fail.php?id=','Headers:','URL:','===\x20PARSED\x20RAPYD\x20RESPONSE\x20===','error_code','Unknown\x20error','loggerService','headers','===\x20RAPYD\x20API\x20BUSINESS\x20ERROR\x20===','TesSoft\x20Payment\x20System/1.0','type','Raw\x20Response\x20Body:','POST','5QAdCdE','PENDING'];a42_0x5766=function(){return _0x102074;};return a42_0x5766();}function a42_0x15e5(_0x169b8b,_0x208c0a){const _0x5766a5=a42_0x5766();return a42_0x15e5=function(_0x15e5e0,_0x3bf12b){_0x15e5e0=_0x15e5e0-0x1c4;let _0x1311b2=_0x5766a5[_0x15e5e0];return _0x1311b2;},a42_0x15e5(_0x169b8b,_0x208c0a);}Object[a42_0x3e3f4a(0x213)](exports,'__esModule',{'value':!![]}),exports['RapydService']=void 0x0;const loggerService_1=require('../loggerService');class RapydService{constructor(){const _0x16b6fb=a42_0x3e3f4a;this[_0x16b6fb(0x227)]=_0x16b6fb(0x204),console[_0x16b6fb(0x209)]('üåê\x20Rapyd\x20service\x20initialized\x20with\x20white\x20domain\x20proxy');}async[a42_0x3e3f4a(0x1d3)](_0x4f7bfe){const _0x221042=a42_0x3e3f4a,{orderId:_0x115257,orderName:_0x3c6e8a,amount:_0x1e756b,currency:_0x1f2ffa,usage:_0x361388,maxPayments:_0x5498be,successUrl:_0x153baa,failUrl:_0x3025e6}=_0x4f7bfe,_0x387e04=_0x1f2ffa['toUpperCase'](),_0x305f25='GB';console[_0x221042(0x209)]('üá¨üáß\x20Using\x20GB\x20(Britain)\x20as\x20country\x20for\x20Rapyd\x20payment\x20link');const _0x8b23b=_0x221042(0x226)+_0x115257,_0x586491=_0x221042(0x22a)+_0x115257,_0x4c4ef8={'amount':_0x1e756b,'currency':_0x387e04,'cancel_checkout_url':_0x586491,'complete_checkout_url':_0x8b23b,'complete_payment_url':_0x8b23b,'merchant_reference_id':_0x115257,'description':_0x221042(0x217)+_0x115257,'country':'GB','payment_method_types_include':[_0x221042(0x1e4),_0x221042(0x1f3)],'custom_elements':{'display_description':!![]}},_0x33895f=Date[_0x221042(0x20e)]();try{console['log']('===\x20RAPYD\x20API\x20REQUEST\x20(White\x20Domain\x20-\x20Updated\x20Format)\x20==='),console[_0x221042(0x209)](_0x221042(0x1c4),this['apiUrl']),console['log'](_0x221042(0x215),JSON[_0x221042(0x20a)](_0x4c4ef8,null,0x2)),console['log'](_0x221042(0x1df)+_0x305f25+_0x221042(0x1d5)),console['log'](_0x221042(0x20b)),loggerService_1[_0x221042(0x1c8)][_0x221042(0x1e3)]('rapyd',_0x221042(0x1fc),_0x221042(0x1ce),_0x4c4ef8);const _0x130e97=await fetch(this[_0x221042(0x227)],{'method':'POST','headers':{'Content-Type':'application/json','User-Agent':_0x221042(0x1cb)},'body':JSON[_0x221042(0x20a)](_0x4c4ef8)}),_0x3d1fab=Date[_0x221042(0x20e)]()-_0x33895f;console[_0x221042(0x209)]('===\x20RAPYD\x20API\x20RESPONSE\x20(White\x20Domain)\x20==='),console[_0x221042(0x209)](_0x221042(0x1f5),_0x130e97['status']),console[_0x221042(0x209)](_0x221042(0x1f7),_0x130e97[_0x221042(0x1ed)]),console[_0x221042(0x209)](_0x221042(0x22b),Object['fromEntries'](_0x130e97[_0x221042(0x1c9)][_0x221042(0x20d)]())),console[_0x221042(0x209)](_0x221042(0x223),_0x3d1fab+'ms');const _0x185b9f=await _0x130e97[_0x221042(0x1d1)]();console[_0x221042(0x209)](_0x221042(0x1cd),_0x185b9f);if(!_0x130e97['ok']){console['error'](_0x221042(0x1d6)),console['error'](_0x221042(0x220),_0x130e97['status']),console['error']('Response\x20Body:',_0x185b9f),loggerService_1['loggerService'][_0x221042(0x229)](_0x221042(0x224),'/v1/hosted/payment_links',_0x130e97[_0x221042(0x211)],_0x185b9f,_0x3d1fab),loggerService_1['loggerService'][_0x221042(0x1e6)](_0x221042(0x224),_0x221042(0x1fc),_0x221042(0x216)+_0x130e97[_0x221042(0x211)]+':\x20'+_0x185b9f);throw new Error('HTTP\x20error!\x20status:\x20'+_0x130e97[_0x221042(0x211)]+_0x221042(0x20f)+_0x185b9f);}let _0x430e92;try{_0x430e92=JSON['parse'](_0x185b9f);}catch(_0x478d99){console['error'](_0x221042(0x1e8),_0x478d99),loggerService_1[_0x221042(0x1c8)][_0x221042(0x1e6)](_0x221042(0x224),_0x221042(0x1fc),_0x221042(0x20c)+_0x478d99);throw new Error('Invalid\x20JSON\x20response\x20from\x20Rapyd\x20API:\x20'+_0x185b9f);}console[_0x221042(0x209)](_0x221042(0x1c5)),console[_0x221042(0x209)]('Parsed\x20Result:',JSON[_0x221042(0x20a)](_0x430e92,null,0x2)),loggerService_1[_0x221042(0x1c8)]['logWhiteDomainResponse']('rapyd',_0x221042(0x1fc),_0x130e97[_0x221042(0x211)],_0x430e92,_0x3d1fab);if(_0x430e92['status']?.[_0x221042(0x211)]!==_0x221042(0x208)){const _0x9b4b2=_0x430e92[_0x221042(0x211)]?.[_0x221042(0x1d8)]||_0x221042(0x221),_0x105997=_0x430e92['status']?.[_0x221042(0x1c6)]||'UNKNOWN';console[_0x221042(0x1f0)](_0x221042(0x1ca)),console[_0x221042(0x1f0)](_0x221042(0x1fa),_0x105997),console[_0x221042(0x1f0)]('Error\x20Message:',_0x9b4b2),console[_0x221042(0x1f0)](_0x221042(0x1e5),_0x430e92['status']),loggerService_1[_0x221042(0x1c8)]['logWhiteDomainError'](_0x221042(0x224),_0x221042(0x1fc),_0x221042(0x207)+_0x105997+'):\x20'+_0x9b4b2);throw new Error(_0x221042(0x1ea)+_0x105997+'):\x20'+_0x9b4b2);}if(!_0x430e92[_0x221042(0x1fd)]?.['id']||!_0x430e92['data']?.['redirect_url']){console[_0x221042(0x1f0)]('===\x20RAPYD\x20API\x20INCOMPLETE\x20RESPONSE\x20==='),console[_0x221042(0x1f0)]('Missing\x20id\x20or\x20redirect_url\x20in\x20response'),console[_0x221042(0x1f0)](_0x221042(0x214),_0x430e92[_0x221042(0x1fd)]),loggerService_1[_0x221042(0x1c8)][_0x221042(0x1e6)]('rapyd','/v1/hosted/payment_links',_0x221042(0x200));throw new Error(_0x221042(0x21c));}return console[_0x221042(0x209)](_0x221042(0x21d)),console[_0x221042(0x209)](_0x221042(0x210),_0x430e92[_0x221042(0x1fd)]['id']),console[_0x221042(0x209)](_0x221042(0x1e1),_0x430e92[_0x221042(0x1fd)][_0x221042(0x1ff)]),console[_0x221042(0x209)](_0x221042(0x1ee)+_0x305f25+_0x221042(0x228)),console[_0x221042(0x209)]('üí≥\x20Payment\x20Methods:\x20gb_visa_card,\x20gb_mastercard_card'),{'gateway_payment_id':_0x430e92[_0x221042(0x1fd)]['id'],'payment_url':_0x430e92[_0x221042(0x1fd)][_0x221042(0x1ff)]};}catch(_0x57dc10){console[_0x221042(0x1f0)]('===\x20RAPYD\x20SERVICE\x20ERROR\x20==='),console[_0x221042(0x1f0)](_0x221042(0x1dc),_0x57dc10),loggerService_1[_0x221042(0x1c8)][_0x221042(0x1e6)](_0x221042(0x224),_0x221042(0x1fc),_0x57dc10);if(_0x57dc10 instanceof Error){console[_0x221042(0x1f0)](_0x221042(0x1ec),_0x57dc10[_0x221042(0x1d8)]),console[_0x221042(0x1f0)](_0x221042(0x1fb),_0x57dc10[_0x221042(0x21b)]);throw new Error(_0x221042(0x21a)+_0x57dc10[_0x221042(0x1d8)]);}throw new Error(_0x221042(0x1eb));}}async[a42_0x3e3f4a(0x1dd)](_0x5c0bc4){const _0xc2c3b=a42_0x3e3f4a,_0x416a11=Date[_0xc2c3b(0x20e)]();try{loggerService_1[_0xc2c3b(0x1c8)][_0xc2c3b(0x1e3)](_0xc2c3b(0x224),_0xc2c3b(0x219)+_0x5c0bc4,_0xc2c3b(0x1f2),{});const _0x80783f=await fetch(this[_0xc2c3b(0x227)]+'/'+_0x5c0bc4,{'method':'GET','headers':{'Content-Type':'application/json','User-Agent':_0xc2c3b(0x1cb)}}),_0x8d1e87=Date[_0xc2c3b(0x20e)]()-_0x416a11;if(!_0x80783f['ok']){const _0x19f213=await _0x80783f['text']();loggerService_1[_0xc2c3b(0x1c8)][_0xc2c3b(0x229)]('rapyd',_0xc2c3b(0x219)+_0x5c0bc4,_0x80783f[_0xc2c3b(0x211)],_0x19f213,_0x8d1e87);throw new Error(_0xc2c3b(0x1f8)+_0x80783f[_0xc2c3b(0x211)]);}const _0x5af9f0=await _0x80783f['json']();loggerService_1[_0xc2c3b(0x1c8)][_0xc2c3b(0x229)](_0xc2c3b(0x224),'/v1/hosted/payment_links/'+_0x5c0bc4,_0x80783f['status'],_0x5af9f0,_0x8d1e87);if(_0x5af9f0['status']?.[_0xc2c3b(0x211)]!==_0xc2c3b(0x208)){loggerService_1['loggerService']['logWhiteDomainError'](_0xc2c3b(0x224),_0xc2c3b(0x219)+_0x5c0bc4,_0xc2c3b(0x21e)+(_0x5af9f0[_0xc2c3b(0x211)]?.['message']||_0xc2c3b(0x1c7)));throw new Error(_0xc2c3b(0x21e)+(_0x5af9f0['status']?.[_0xc2c3b(0x1d8)]||_0xc2c3b(0x1c7)));}let _0x1d88a5=_0xc2c3b(0x1d0);if(_0x5af9f0[_0xc2c3b(0x1fd)]?.['status'])switch(_0x5af9f0[_0xc2c3b(0x1fd)]['status'][_0xc2c3b(0x1e2)]()){case _0xc2c3b(0x1d7):_0x1d88a5=_0xc2c3b(0x1f4);break;case _0xc2c3b(0x21f):_0x1d88a5=_0xc2c3b(0x1e7);break;case _0xc2c3b(0x1d4):_0x1d88a5=_0xc2c3b(0x1e9);break;case'ERR':_0x1d88a5='FAILED';break;case _0xc2c3b(0x1f6):case'ACT':default:_0x1d88a5=_0xc2c3b(0x1d0);break;}return{'status':_0x1d88a5,'amount':_0x5af9f0[_0xc2c3b(0x1fd)]?.[_0xc2c3b(0x205)],'currency':_0x5af9f0['data']?.['currency']};}catch(_0x13792c){console[_0xc2c3b(0x1f0)](_0xc2c3b(0x203),_0x13792c),loggerService_1[_0xc2c3b(0x1c8)][_0xc2c3b(0x1e6)](_0xc2c3b(0x224),_0xc2c3b(0x219)+_0x5c0bc4,_0x13792c);throw new Error(_0xc2c3b(0x218)+(_0x13792c instanceof Error?_0x13792c[_0xc2c3b(0x1d8)]:_0xc2c3b(0x1c7)));}}async[a42_0x3e3f4a(0x222)](_0x534bc7){const _0x215d36=a42_0x3e3f4a;console[_0x215d36(0x209)]('Processing\x20Rapyd\x20webhook:',_0x534bc7);let _0x200a6f=_0x215d36(0x1d0);switch(_0x534bc7[_0x215d36(0x1cc)]?.[_0x215d36(0x1e2)]()){case _0x215d36(0x1de):_0x534bc7[_0x215d36(0x1fd)]?.[_0x215d36(0x202)]===!![]&&_0x534bc7[_0x215d36(0x1fd)]?.[_0x215d36(0x211)]===_0x215d36(0x1d7)?_0x200a6f='PAID':_0x200a6f=_0x215d36(0x1d0);break;case'PAYMENT_CANCELED':_0x200a6f='FAILED';break;case _0x215d36(0x1f1):_0x200a6f=_0x215d36(0x1e9);break;case _0x215d36(0x1f9):_0x200a6f=_0x215d36(0x1e7);break;default:switch(_0x534bc7[_0x215d36(0x1fd)]?.[_0x215d36(0x211)]?.[_0x215d36(0x1e2)]()){case'CLO':_0x534bc7[_0x215d36(0x1fd)]?.[_0x215d36(0x202)]===!![]?_0x200a6f=_0x215d36(0x1f4):_0x200a6f=_0x215d36(0x1e7);break;case'CAN':_0x200a6f='FAILED';break;case'EXP':_0x200a6f='EXPIRED';break;case'ERR':_0x200a6f=_0x215d36(0x1e7);break;case _0x215d36(0x1f6):case _0x215d36(0x212):default:_0x200a6f=_0x215d36(0x1d0);break;}break;}return{'paymentId':_0x534bc7[_0x215d36(0x1fd)]?.[_0x215d36(0x1fe)]||'','status':_0x200a6f,'amount':_0x534bc7[_0x215d36(0x1fd)]?.['amount'],'currency':_0x534bc7[_0x215d36(0x1fd)]?.[_0x215d36(0x1db)]};}}exports['RapydService']=RapydService;