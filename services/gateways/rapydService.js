'use strict';const a50_0x5bb8df=a50_0x3a22;(function(_0x2c072b,_0x554b73){const _0x29cdef=a50_0x3a22,_0x31603e=_0x2c072b();while(!![]){try{const _0x4856ee=-parseInt(_0x29cdef(0x1eb))/0x1*(-parseInt(_0x29cdef(0x20e))/0x2)+-parseInt(_0x29cdef(0x1de))/0x3*(-parseInt(_0x29cdef(0x1e8))/0x4)+parseInt(_0x29cdef(0x1fe))/0x5+parseInt(_0x29cdef(0x1ef))/0x6+-parseInt(_0x29cdef(0x218))/0x7*(parseInt(_0x29cdef(0x1f3))/0x8)+-parseInt(_0x29cdef(0x23e))/0x9*(parseInt(_0x29cdef(0x255))/0xa)+parseInt(_0x29cdef(0x234))/0xb*(-parseInt(_0x29cdef(0x244))/0xc);if(_0x4856ee===_0x554b73)break;else _0x31603e['push'](_0x31603e['shift']());}catch(_0xd1e76d){_0x31603e['push'](_0x31603e['shift']());}}}(a50_0x2d27,0xd3c9a));Object[a50_0x5bb8df(0x201)](exports,a50_0x5bb8df(0x224),{'value':!![]}),exports[a50_0x5bb8df(0x22c)]=void 0x0;const loggerService_1=require(a50_0x5bb8df(0x202));function a50_0x3a22(_0x5845aa,_0x407fb8){const _0x2d2727=a50_0x2d27();return a50_0x3a22=function(_0x3a228a,_0x2f340e){_0x3a228a=_0x3a228a-0x1dc;let _0x5698d0=_0x2d2727[_0x3a228a];return _0x5698d0;},a50_0x3a22(_0x5845aa,_0x407fb8);}function a50_0x2d27(){const _0x3793ff=['Failed\x20to\x20verify\x20Rapyd\x20payment:\x20','rapyd','errorCode','ERR','Missing\x20id\x20or\x20redirect_url\x20in\x20response','8540631CDXZHt','\x20\x20\x20requested_currency:\x20EUR','ACT','PAYMENT_COMPLETED','CLO','üí≥\x20Payment\x20Methods:\x20gb_visa_card,\x20gb_mastercard_card','logWhiteDomainRequest','PAYMENT_EXPIRED','===\x20PARSED\x20RAPYD\x20RESPONSE\x20===','logWhiteDomainError','233352BLDMxf','amount','JSON\x20Parse\x20Error:\x20','text','error','toISOString','24FBiINM','Status:','===\x20RAPYD\x20API\x20REQUEST\x20(White\x20Domain\x20-\x20Updated\x20Format)\x20===','Processing\x20Rapyd\x20webhook:','now','UNKNOWN','failure_code','buy','json','https://tesoft.uk/gateway/fail.php?id=','ORDER:\x20','stringify','Business\x20Error\x20(','type','Status\x20Text:','EXP','Failed\x20to\x20create\x20Rapyd\x20payment\x20link:\x20','300zEqdPQ','floor','Redirect\x20URL:','parse','PAYMENT_FAILED',',\x20body:\x20','2267445SNFSsF','===\x20RAPYD\x20API\x20BUSINESS\x20ERROR\x20===','\x20->\x20EUR:','FAILED','entries','fromEntries','redirect_url','Unknown\x20error\x20from\x20Rapyd\x20API','last4','PAID','4iMJFcN','GET','EUR','4gUBzcm','toUpperCase','statusText','üá¨üáß\x20Country:\x20','6647736ekRqBs','üá¨üáß\x20Country\x20used:\x20','):\x20','loggerService','216vzmmWP','/v1/hosted/payment_links/','Failed\x20to\x20parse\x20JSON\x20response:','===\x20RAPYD\x20SERVICE\x20ERROR\x20===','Failed\x20to\x20create\x20Rapyd\x20payment\x20link:\x20Unknown\x20error','paid','Rapyd\x20payment\x20verification\x20error:','Error\x20details:',',\x20failureMessage=','processWebhook','Error\x20stack:','4476640RYtIkS','apiUrl','HTTP\x20error!\x20status:\x20','defineProperty','../loggerService','headers','payment_method_type','Incomplete\x20response:\x20missing\x20id\x20or\x20redirect_url','===\x20RAPYD\x20API\x20RESPONSE\x20(White\x20Domain)\x20===','paymentMethod','payment_method_data','Parsed\x20Result:','\x20\x20\x20expiration:\x20','data','failureCode','URL:','547380MZsByG','log','===\x20RAPYD\x20SUCCESS\x20===','/v1/hosted/payment_links','PENDING','HTTP\x20','logWhiteDomainResponse','Invalid\x20response\x20from\x20Rapyd\x20API:\x20missing\x20id\x20or\x20redirect_url','EXPIRED','Unknown\x20error','169995YCPyoQ','currency','application/json','status','error_code','Rapyd\x20API\x20error:\x20','Response\x20Time:','TesSoft\x20Payment\x20System/1.0','message','createPaymentLink','CAN','stack','__esModule','Full\x20Error\x20Data:','expiration','merchant_reference_id','https://tesoft.uk/gateway/rapyd/','POST','failure_message','Request\x20Body\x20(Updated\x20Format):','RapydService','fixed_side','üí•\x20Rapyd\x20failure\x20message:\x20'];a50_0x2d27=function(){return _0x3793ff;};return a50_0x2d27();}class RapydService{constructor(){const _0x368b82=a50_0x5bb8df;this[_0x368b82(0x1ff)]=_0x368b82(0x228),console[_0x368b82(0x20f)]('üåê\x20Rapyd\x20service\x20initialized\x20with\x20white\x20domain\x20proxy');}async[a50_0x5bb8df(0x221)](_0x56d934){const _0x1e5516=a50_0x5bb8df,{orderId:_0x47a304,orderName:_0x2d13eb,amount:_0x5a12ed,currency:_0x39cf91,usage:_0x53f507,maxPayments:_0x2bd9b1,successUrl:_0x2d7663,failUrl:_0x23d205}=_0x56d934,_0x36eaf1=_0x39cf91[_0x1e5516(0x1ec)](),_0x5c0df='GB';console[_0x1e5516(0x20f)]('üá¨üáß\x20Using\x20GB\x20(Britain)\x20as\x20country\x20for\x20Rapyd\x20payment\x20link');const _0x23a8c4='https://tesoft.uk/gateway/success.php?id='+_0x47a304,_0x1dc66a=_0x1e5516(0x24d)+_0x47a304,_0x5e107d={'amount':_0x5a12ed,'currency':_0x36eaf1,'cancel_checkout_url':_0x1dc66a,'complete_checkout_url':_0x23a8c4,'complete_payment_url':_0x23a8c4,'merchant_reference_id':_0x47a304,'description':_0x1e5516(0x24e)+_0x47a304,'country':'GB','payment_method_types_include':['gb_visa_card','gb_mastercard_card'],'custom_elements':{'display_description':!![]}};if(_0x36eaf1!==_0x1e5516(0x1ea)){const _0x2ced76=Math[_0x1e5516(0x256)](Date['now']()/0x3e8)+0x1e*0x3c;_0x5e107d[_0x1e5516(0x22d)]=_0x1e5516(0x24b),_0x5e107d['requested_currency']=_0x1e5516(0x1ea),_0x5e107d[_0x1e5516(0x226)]=_0x2ced76,console[_0x1e5516(0x20f)]('üí±\x20Adding\x20currency\x20conversion\x20fields\x20for\x20'+_0x36eaf1+_0x1e5516(0x1e0)),console[_0x1e5516(0x20f)]('\x20\x20\x20fixed_side:\x20buy'),console[_0x1e5516(0x20f)](_0x1e5516(0x235)),console['log'](_0x1e5516(0x20a)+_0x2ced76+'\x20('+new Date(_0x2ced76*0x3e8)[_0x1e5516(0x243)]()+')');}const _0x555aec=Date['now']();try{console[_0x1e5516(0x20f)](_0x1e5516(0x246)),console[_0x1e5516(0x20f)](_0x1e5516(0x20d),this[_0x1e5516(0x1ff)]),console[_0x1e5516(0x20f)](_0x1e5516(0x22b),JSON[_0x1e5516(0x24f)](_0x5e107d,null,0x2)),console[_0x1e5516(0x20f)](_0x1e5516(0x1ee)+_0x5c0df+'\x20(always\x20GB\x20for\x20Rapyd)'),console[_0x1e5516(0x20f)](_0x1e5516(0x239)),loggerService_1[_0x1e5516(0x1f2)][_0x1e5516(0x23a)](_0x1e5516(0x230),_0x1e5516(0x211),_0x1e5516(0x229),_0x5e107d);const _0x30da55=await fetch(this[_0x1e5516(0x1ff)],{'method':'POST','headers':{'Content-Type':_0x1e5516(0x21a),'User-Agent':_0x1e5516(0x21f)},'body':JSON['stringify'](_0x5e107d)}),_0xcf52e1=Date[_0x1e5516(0x248)]()-_0x555aec;console[_0x1e5516(0x20f)](_0x1e5516(0x206)),console[_0x1e5516(0x20f)](_0x1e5516(0x245),_0x30da55[_0x1e5516(0x21b)]),console[_0x1e5516(0x20f)](_0x1e5516(0x252),_0x30da55[_0x1e5516(0x1ed)]),console[_0x1e5516(0x20f)]('Headers:',Object[_0x1e5516(0x1e3)](_0x30da55[_0x1e5516(0x203)][_0x1e5516(0x1e2)]())),console[_0x1e5516(0x20f)](_0x1e5516(0x21e),_0xcf52e1+'ms');const _0x280df9=await _0x30da55[_0x1e5516(0x241)]();console['log']('Raw\x20Response\x20Body:',_0x280df9);if(!_0x30da55['ok']){console[_0x1e5516(0x242)]('===\x20RAPYD\x20API\x20ERROR\x20==='),console[_0x1e5516(0x242)]('HTTP\x20Status:',_0x30da55[_0x1e5516(0x21b)]),console['error']('Response\x20Body:',_0x280df9),loggerService_1[_0x1e5516(0x1f2)]['logWhiteDomainResponse'](_0x1e5516(0x230),_0x1e5516(0x211),_0x30da55[_0x1e5516(0x21b)],_0x280df9,_0xcf52e1),loggerService_1[_0x1e5516(0x1f2)][_0x1e5516(0x23d)](_0x1e5516(0x230),_0x1e5516(0x211),_0x1e5516(0x213)+_0x30da55[_0x1e5516(0x21b)]+':\x20'+_0x280df9);throw new Error(_0x1e5516(0x200)+_0x30da55[_0x1e5516(0x21b)]+_0x1e5516(0x1dd)+_0x280df9);}let _0x5745a0;try{_0x5745a0=JSON[_0x1e5516(0x258)](_0x280df9);}catch(_0x1908ed){console[_0x1e5516(0x242)](_0x1e5516(0x1f5),_0x1908ed),loggerService_1[_0x1e5516(0x1f2)]['logWhiteDomainError'](_0x1e5516(0x230),_0x1e5516(0x211),_0x1e5516(0x240)+_0x1908ed);throw new Error('Invalid\x20JSON\x20response\x20from\x20Rapyd\x20API:\x20'+_0x280df9);}console['log'](_0x1e5516(0x23c)),console['log'](_0x1e5516(0x209),JSON['stringify'](_0x5745a0,null,0x2)),loggerService_1[_0x1e5516(0x1f2)]['logWhiteDomainResponse']('rapyd',_0x1e5516(0x211),_0x30da55['status'],_0x5745a0,_0xcf52e1);if(_0x5745a0[_0x1e5516(0x21b)]?.[_0x1e5516(0x21b)]!=='SUCCESS'){const _0x1df38b=_0x5745a0['status']?.[_0x1e5516(0x220)]||_0x1e5516(0x1e5),_0x2e1242=_0x5745a0[_0x1e5516(0x21b)]?.[_0x1e5516(0x21c)]||_0x1e5516(0x249);console[_0x1e5516(0x242)](_0x1e5516(0x1df)),console[_0x1e5516(0x242)]('Error\x20Code:',_0x2e1242),console[_0x1e5516(0x242)]('Error\x20Message:',_0x1df38b),console[_0x1e5516(0x242)](_0x1e5516(0x225),_0x5745a0[_0x1e5516(0x21b)]),loggerService_1[_0x1e5516(0x1f2)][_0x1e5516(0x23d)](_0x1e5516(0x230),_0x1e5516(0x211),_0x1e5516(0x250)+_0x2e1242+_0x1e5516(0x1f1)+_0x1df38b);throw new Error('Rapyd\x20API\x20error\x20('+_0x2e1242+'):\x20'+_0x1df38b);}if(!_0x5745a0[_0x1e5516(0x20b)]?.['id']||!_0x5745a0[_0x1e5516(0x20b)]?.[_0x1e5516(0x1e4)]){console[_0x1e5516(0x242)]('===\x20RAPYD\x20API\x20INCOMPLETE\x20RESPONSE\x20==='),console[_0x1e5516(0x242)](_0x1e5516(0x233)),console[_0x1e5516(0x242)]('Response\x20data:',_0x5745a0[_0x1e5516(0x20b)]),loggerService_1[_0x1e5516(0x1f2)][_0x1e5516(0x23d)]('rapyd','/v1/hosted/payment_links',_0x1e5516(0x205));throw new Error(_0x1e5516(0x215));}return console['log'](_0x1e5516(0x210)),console[_0x1e5516(0x20f)]('Payment\x20Link\x20ID:',_0x5745a0[_0x1e5516(0x20b)]['id']),console['log'](_0x1e5516(0x257),_0x5745a0[_0x1e5516(0x20b)][_0x1e5516(0x1e4)]),console[_0x1e5516(0x20f)](_0x1e5516(0x1f0)+_0x5c0df+'\x20(GB\x20-\x20Britain)'),console[_0x1e5516(0x20f)]('üí≥\x20Payment\x20Methods:\x20gb_visa_card,\x20gb_mastercard_card'),{'gateway_payment_id':_0x5745a0[_0x1e5516(0x20b)]['id'],'payment_url':_0x5745a0[_0x1e5516(0x20b)][_0x1e5516(0x1e4)]};}catch(_0x22f2a4){console[_0x1e5516(0x242)](_0x1e5516(0x1f6)),console['error'](_0x1e5516(0x1fa),_0x22f2a4),loggerService_1[_0x1e5516(0x1f2)][_0x1e5516(0x23d)](_0x1e5516(0x230),_0x1e5516(0x211),_0x22f2a4);if(_0x22f2a4 instanceof Error){console[_0x1e5516(0x242)]('Error\x20message:',_0x22f2a4['message']),console['error'](_0x1e5516(0x1fd),_0x22f2a4[_0x1e5516(0x223)]);throw new Error(_0x1e5516(0x254)+_0x22f2a4['message']);}throw new Error(_0x1e5516(0x1f7));}}async['verifyPayment'](_0x1a7f4a){const _0x4e7cd8=a50_0x5bb8df,_0x4d67f8=Date[_0x4e7cd8(0x248)]();try{loggerService_1[_0x4e7cd8(0x1f2)][_0x4e7cd8(0x23a)]('rapyd',_0x4e7cd8(0x1f4)+_0x1a7f4a,'GET',{});const _0x3ef818=await fetch(this['apiUrl']+'/'+_0x1a7f4a,{'method':_0x4e7cd8(0x1e9),'headers':{'Content-Type':_0x4e7cd8(0x21a),'User-Agent':_0x4e7cd8(0x21f)}}),_0x3f281b=Date['now']()-_0x4d67f8;if(!_0x3ef818['ok']){const _0x40a7bc=await _0x3ef818[_0x4e7cd8(0x241)]();loggerService_1[_0x4e7cd8(0x1f2)]['logWhiteDomainResponse'](_0x4e7cd8(0x230),'/v1/hosted/payment_links/'+_0x1a7f4a,_0x3ef818[_0x4e7cd8(0x21b)],_0x40a7bc,_0x3f281b);throw new Error(_0x4e7cd8(0x200)+_0x3ef818[_0x4e7cd8(0x21b)]);}const _0x46336a=await _0x3ef818[_0x4e7cd8(0x24c)]();loggerService_1[_0x4e7cd8(0x1f2)][_0x4e7cd8(0x214)](_0x4e7cd8(0x230),_0x4e7cd8(0x1f4)+_0x1a7f4a,_0x3ef818['status'],_0x46336a,_0x3f281b);if(_0x46336a[_0x4e7cd8(0x21b)]?.[_0x4e7cd8(0x21b)]!=='SUCCESS'){loggerService_1[_0x4e7cd8(0x1f2)][_0x4e7cd8(0x23d)](_0x4e7cd8(0x230),'/v1/hosted/payment_links/'+_0x1a7f4a,'Rapyd\x20API\x20error:\x20'+(_0x46336a[_0x4e7cd8(0x21b)]?.['message']||'Unknown\x20error'));throw new Error(_0x4e7cd8(0x21d)+(_0x46336a['status']?.['message']||_0x4e7cd8(0x217)));}let _0x120ca0='PENDING';if(_0x46336a['data']?.[_0x4e7cd8(0x21b)])switch(_0x46336a[_0x4e7cd8(0x20b)][_0x4e7cd8(0x21b)][_0x4e7cd8(0x1ec)]()){case'CLO':_0x120ca0='PAID';break;case'CAN':_0x120ca0='FAILED';break;case _0x4e7cd8(0x253):_0x120ca0=_0x4e7cd8(0x216);break;case _0x4e7cd8(0x232):_0x120ca0=_0x4e7cd8(0x1e1);break;case'NEW':case _0x4e7cd8(0x236):default:_0x120ca0=_0x4e7cd8(0x212);break;}return{'status':_0x120ca0,'amount':_0x46336a['data']?.[_0x4e7cd8(0x23f)],'currency':_0x46336a[_0x4e7cd8(0x20b)]?.['currency']};}catch(_0x3fb287){console[_0x4e7cd8(0x242)](_0x4e7cd8(0x1f9),_0x3fb287),loggerService_1[_0x4e7cd8(0x1f2)][_0x4e7cd8(0x23d)](_0x4e7cd8(0x230),_0x4e7cd8(0x1f4)+_0x1a7f4a,_0x3fb287);throw new Error(_0x4e7cd8(0x22f)+(_0x3fb287 instanceof Error?_0x3fb287[_0x4e7cd8(0x220)]:_0x4e7cd8(0x217)));}}async[a50_0x5bb8df(0x1fc)](_0xb06590){const _0x1b867a=a50_0x5bb8df;console['log'](_0x1b867a(0x247),_0xb06590);let _0x42c907=_0x1b867a(0x212),_0x49264e;_0xb06590[_0x1b867a(0x20b)]?.['failure_message']&&(_0x49264e=_0xb06590[_0x1b867a(0x20b)]['failure_message'],console[_0x1b867a(0x20f)](_0x1b867a(0x22e)+_0x49264e));switch(_0xb06590[_0x1b867a(0x251)]?.[_0x1b867a(0x1ec)]()){case _0x1b867a(0x237):_0xb06590[_0x1b867a(0x20b)]?.[_0x1b867a(0x1f8)]===!![]&&_0xb06590[_0x1b867a(0x20b)]?.[_0x1b867a(0x21b)]===_0x1b867a(0x238)?_0x42c907='PAID':_0x42c907=_0x1b867a(0x212);break;case'PAYMENT_CANCELED':_0x42c907='FAILED';break;case _0x1b867a(0x23b):_0x42c907='EXPIRED';break;case _0x1b867a(0x1dc):_0x42c907=_0x1b867a(0x1e1);!_0x49264e&&_0xb06590[_0x1b867a(0x20b)]?.[_0x1b867a(0x22a)]&&(_0x49264e=_0xb06590[_0x1b867a(0x20b)][_0x1b867a(0x22a)]);break;default:switch(_0xb06590[_0x1b867a(0x20b)]?.[_0x1b867a(0x21b)]?.[_0x1b867a(0x1ec)]()){case _0x1b867a(0x238):_0xb06590[_0x1b867a(0x20b)]?.[_0x1b867a(0x1f8)]===!![]?_0x42c907=_0x1b867a(0x1e7):_0x42c907=_0x1b867a(0x1e1);break;case _0x1b867a(0x222):_0x42c907=_0x1b867a(0x1e1);break;case _0x1b867a(0x253):_0x42c907=_0x1b867a(0x216);break;case _0x1b867a(0x232):_0x42c907=_0x1b867a(0x1e1);!_0x49264e&&_0xb06590['data']?.[_0x1b867a(0x22a)]&&(_0x49264e=_0xb06590[_0x1b867a(0x20b)][_0x1b867a(0x22a)]);break;case'NEW':case'ACT':default:_0x42c907=_0x1b867a(0x212);break;}break;}const _0x429dbb={};return _0xb06590['data']?.[_0x1b867a(0x208)]?.[_0x1b867a(0x1e6)]&&(_0x429dbb['cardLast4']=_0xb06590['data'][_0x1b867a(0x208)][_0x1b867a(0x1e6)]),_0xb06590[_0x1b867a(0x20b)]?.[_0x1b867a(0x204)]&&(_0x429dbb[_0x1b867a(0x207)]=_0xb06590[_0x1b867a(0x20b)]['payment_method_type']),_0xb06590[_0x1b867a(0x20b)]?.[_0x1b867a(0x21c)]&&(_0x429dbb[_0x1b867a(0x231)]=_0xb06590[_0x1b867a(0x20b)]['error_code']),_0xb06590[_0x1b867a(0x20b)]?.[_0x1b867a(0x24a)]&&(_0x429dbb[_0x1b867a(0x20c)]=_0xb06590[_0x1b867a(0x20b)]['failure_code']),console['log']('üîÑ\x20Rapyd\x20webhook\x20processed:\x20status='+_0x42c907+_0x1b867a(0x1fb)+(_0x49264e||'none')),{'paymentId':_0xb06590['data']?.[_0x1b867a(0x227)]||'','status':_0x42c907,'amount':_0xb06590[_0x1b867a(0x20b)]?.[_0x1b867a(0x23f)],'currency':_0xb06590[_0x1b867a(0x20b)]?.[_0x1b867a(0x219)],'failureMessage':_0x49264e,'additionalInfo':_0x429dbb};}}exports[a50_0x5bb8df(0x22c)]=RapydService;