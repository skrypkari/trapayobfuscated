'use strict';function a46_0x4b86(){const _0x177455=['Rapyd\x20API\x20error:\x20','160wFOjHm',',\x20failureMessage=','PAYMENT_EXPIRED','Invalid\x20response\x20from\x20Rapyd\x20API:\x20missing\x20id\x20or\x20redirect_url','FAILED','üîÑ\x20Rapyd\x20webhook\x20processed:\x20status=','rapyd','üí•\x20Rapyd\x20failure\x20message:\x20','gb_mastercard_card','ACT','application/json','9315978NywcFn','Redirect\x20URL:','redirect_url','loggerService','paymentMethod','failureCode','\x20(always\x20GB\x20for\x20Rapyd)','7716548KQreXO','77795nToTOy','headers','text','SUCCESS','__esModule',',\x20body:\x20','PENDING','logWhiteDomainResponse','===\x20RAPYD\x20API\x20RESPONSE\x20(White\x20Domain)\x20===','errorCode','stringify','createPaymentLink','PAYMENT_CANCELED','===\x20PARSED\x20RAPYD\x20RESPONSE\x20===','EXP','HTTP\x20','Raw\x20Response\x20Body:','Failed\x20to\x20create\x20Rapyd\x20payment\x20link:\x20Unknown\x20error','EXPIRED','TesSoft\x20Payment\x20System/1.0','https://tesoft.uk/gateway/rapyd/','failure_message','Error\x20Message:','===\x20RAPYD\x20API\x20BUSINESS\x20ERROR\x20===','fromEntries','log','currency','failure_code','Full\x20Error\x20Data:','HTTP\x20error!\x20status:\x20','error','Status:','toUpperCase','Processing\x20Rapyd\x20webhook:','CAN','../loggerService','verifyPayment','===\x20RAPYD\x20API\x20ERROR\x20===','now','defineProperty','paid','logWhiteDomainRequest','Payment\x20Link\x20ID:','\x20(GB\x20-\x20Britain)','Rapyd\x20payment\x20verification\x20error:','https://tesoft.uk/gateway/success.php?id=','RapydService','===\x20RAPYD\x20SUCCESS\x20===','Failed\x20to\x20create\x20Rapyd\x20payment\x20link:\x20','Unknown\x20error','none','Parsed\x20Result:','GET','Rapyd\x20API\x20error\x20(','json','Response\x20data:','UNKNOWN','status','URL:','Error\x20stack:','Request\x20Body\x20(Updated\x20Format):','processWebhook','data','Failed\x20to\x20parse\x20JSON\x20response:','/v1/hosted/payment_links','ERR','CLO','2321442XJpnvf','Error\x20message:','cardLast4','Incomplete\x20response:\x20missing\x20id\x20or\x20redirect_url','JSON\x20Parse\x20Error:\x20','/v1/hosted/payment_links/','Headers:','logWhiteDomainError','parse','Response\x20Time:','üá¨üáß\x20Country:\x20','üí≥\x20Payment\x20Methods:\x20gb_visa_card,\x20gb_mastercard_card','üá¨üáß\x20Country\x20used:\x20','apiUrl','Response\x20Body:','error_code','1373327ftxgCg','2265052IyPiXp','payment_method_data','Missing\x20id\x20or\x20redirect_url\x20in\x20response','Error\x20Code:','8kRUXGF','POST','6994764uTTAcg','===\x20RAPYD\x20API\x20REQUEST\x20(White\x20Domain\x20-\x20Updated\x20Format)\x20===','message','):\x20','===\x20RAPYD\x20SERVICE\x20ERROR\x20===','Business\x20Error\x20(','type','payment_method_type','PAID'];a46_0x4b86=function(){return _0x177455;};return a46_0x4b86();}const a46_0x55e46c=a46_0x29fb;(function(_0x495e34,_0x2ede21){const _0x784cfb=a46_0x29fb,_0xa14a77=_0x495e34();while(!![]){try{const _0x2c49c4=parseInt(_0x784cfb(0x22d))/0x1+parseInt(_0x784cfb(0x22e))/0x2+parseInt(_0x784cfb(0x21d))/0x3+parseInt(_0x784cfb(0x23e))/0x4*(-parseInt(_0x784cfb(0x251))/0x5)+-parseInt(_0x784cfb(0x249))/0x6+-parseInt(_0x784cfb(0x250))/0x7*(parseInt(_0x784cfb(0x232))/0x8)+parseInt(_0x784cfb(0x234))/0x9;if(_0x2c49c4===_0x2ede21)break;else _0xa14a77['push'](_0xa14a77['shift']());}catch(_0x1ce295){_0xa14a77['push'](_0xa14a77['shift']());}}}(a46_0x4b86,0xbe4d4));Object[a46_0x55e46c(0x201)](exports,a46_0x55e46c(0x1de),{'value':!![]}),exports[a46_0x55e46c(0x208)]=void 0x0;const loggerService_1=require(a46_0x55e46c(0x1fd));function a46_0x29fb(_0x1e9d0d,_0x164086){const _0x4b863c=a46_0x4b86();return a46_0x29fb=function(_0x29fb61,_0x204719){_0x29fb61=_0x29fb61-0x1dd;let _0x36fc5a=_0x4b863c[_0x29fb61];return _0x36fc5a;},a46_0x29fb(_0x1e9d0d,_0x164086);}class RapydService{constructor(){const _0x410659=a46_0x55e46c;this['apiUrl']=_0x410659(0x1ee),console[_0x410659(0x1f3)]('üåê\x20Rapyd\x20service\x20initialized\x20with\x20white\x20domain\x20proxy');}async[a46_0x55e46c(0x1e5)](_0x252212){const _0x9b22db=a46_0x55e46c,{orderId:_0x24476d,orderName:_0x3c6407,amount:_0x22eb9d,currency:_0x40442d,usage:_0x443b1d,maxPayments:_0x1d1693,successUrl:_0x99a932,failUrl:_0x1482ca}=_0x252212,_0xc18ded=_0x40442d[_0x9b22db(0x1fa)](),_0x5dd990='GB';console[_0x9b22db(0x1f3)]('üá¨üáß\x20Using\x20GB\x20(Britain)\x20as\x20country\x20for\x20Rapyd\x20payment\x20link');const _0x22a64b=_0x9b22db(0x207)+_0x24476d,_0x243ddf='https://tesoft.uk/gateway/fail.php?id='+_0x24476d,_0x3396ad={'amount':_0x22eb9d,'currency':_0xc18ded,'cancel_checkout_url':_0x243ddf,'complete_checkout_url':_0x22a64b,'complete_payment_url':_0x22a64b,'merchant_reference_id':_0x24476d,'description':'ORDER:\x20'+_0x24476d,'country':'GB','payment_method_types_include':['gb_visa_card',_0x9b22db(0x246)],'custom_elements':{'display_description':!![]}},_0x45dd86=Date[_0x9b22db(0x200)]();try{console[_0x9b22db(0x1f3)](_0x9b22db(0x235)),console[_0x9b22db(0x1f3)](_0x9b22db(0x214),this[_0x9b22db(0x22a)]),console[_0x9b22db(0x1f3)](_0x9b22db(0x216),JSON[_0x9b22db(0x1e4)](_0x3396ad,null,0x2)),console[_0x9b22db(0x1f3)](_0x9b22db(0x227)+_0x5dd990+_0x9b22db(0x24f)),console['log'](_0x9b22db(0x228)),loggerService_1[_0x9b22db(0x24c)]['logWhiteDomainRequest'](_0x9b22db(0x244),_0x9b22db(0x21a),_0x9b22db(0x233),_0x3396ad);const _0x4d7ffc=await fetch(this['apiUrl'],{'method':_0x9b22db(0x233),'headers':{'Content-Type':_0x9b22db(0x248),'User-Agent':_0x9b22db(0x1ed)},'body':JSON[_0x9b22db(0x1e4)](_0x3396ad)}),_0x55c19b=Date['now']()-_0x45dd86;console['log'](_0x9b22db(0x1e2)),console[_0x9b22db(0x1f3)](_0x9b22db(0x1f9),_0x4d7ffc['status']),console[_0x9b22db(0x1f3)]('Status\x20Text:',_0x4d7ffc['statusText']),console[_0x9b22db(0x1f3)](_0x9b22db(0x223),Object[_0x9b22db(0x1f2)](_0x4d7ffc[_0x9b22db(0x252)]['entries']())),console['log'](_0x9b22db(0x226),_0x55c19b+'ms');const _0x384bac=await _0x4d7ffc[_0x9b22db(0x253)]();console[_0x9b22db(0x1f3)](_0x9b22db(0x1ea),_0x384bac);if(!_0x4d7ffc['ok']){console[_0x9b22db(0x1f8)](_0x9b22db(0x1ff)),console['error']('HTTP\x20Status:',_0x4d7ffc[_0x9b22db(0x213)]),console[_0x9b22db(0x1f8)](_0x9b22db(0x22b),_0x384bac),loggerService_1[_0x9b22db(0x24c)][_0x9b22db(0x1e1)](_0x9b22db(0x244),_0x9b22db(0x21a),_0x4d7ffc[_0x9b22db(0x213)],_0x384bac,_0x55c19b),loggerService_1[_0x9b22db(0x24c)][_0x9b22db(0x224)](_0x9b22db(0x244),_0x9b22db(0x21a),_0x9b22db(0x1e9)+_0x4d7ffc['status']+':\x20'+_0x384bac);throw new Error(_0x9b22db(0x1f7)+_0x4d7ffc[_0x9b22db(0x213)]+_0x9b22db(0x1df)+_0x384bac);}let _0x2e9ba4;try{_0x2e9ba4=JSON[_0x9b22db(0x225)](_0x384bac);}catch(_0x384cd0){console[_0x9b22db(0x1f8)](_0x9b22db(0x219),_0x384cd0),loggerService_1['loggerService'][_0x9b22db(0x224)]('rapyd',_0x9b22db(0x21a),_0x9b22db(0x221)+_0x384cd0);throw new Error('Invalid\x20JSON\x20response\x20from\x20Rapyd\x20API:\x20'+_0x384bac);}console['log'](_0x9b22db(0x1e7)),console[_0x9b22db(0x1f3)](_0x9b22db(0x20d),JSON[_0x9b22db(0x1e4)](_0x2e9ba4,null,0x2)),loggerService_1['loggerService'][_0x9b22db(0x1e1)](_0x9b22db(0x244),_0x9b22db(0x21a),_0x4d7ffc['status'],_0x2e9ba4,_0x55c19b);if(_0x2e9ba4[_0x9b22db(0x213)]?.['status']!==_0x9b22db(0x1dd)){const _0x539313=_0x2e9ba4[_0x9b22db(0x213)]?.[_0x9b22db(0x236)]||'Unknown\x20error\x20from\x20Rapyd\x20API',_0x36700f=_0x2e9ba4[_0x9b22db(0x213)]?.[_0x9b22db(0x22c)]||_0x9b22db(0x212);console['error'](_0x9b22db(0x1f1)),console[_0x9b22db(0x1f8)](_0x9b22db(0x231),_0x36700f),console[_0x9b22db(0x1f8)](_0x9b22db(0x1f0),_0x539313),console[_0x9b22db(0x1f8)](_0x9b22db(0x1f6),_0x2e9ba4[_0x9b22db(0x213)]),loggerService_1['loggerService']['logWhiteDomainError'](_0x9b22db(0x244),'/v1/hosted/payment_links',_0x9b22db(0x239)+_0x36700f+_0x9b22db(0x237)+_0x539313);throw new Error(_0x9b22db(0x20f)+_0x36700f+_0x9b22db(0x237)+_0x539313);}if(!_0x2e9ba4[_0x9b22db(0x218)]?.['id']||!_0x2e9ba4[_0x9b22db(0x218)]?.[_0x9b22db(0x24b)]){console[_0x9b22db(0x1f8)]('===\x20RAPYD\x20API\x20INCOMPLETE\x20RESPONSE\x20==='),console[_0x9b22db(0x1f8)](_0x9b22db(0x230)),console[_0x9b22db(0x1f8)](_0x9b22db(0x211),_0x2e9ba4['data']),loggerService_1[_0x9b22db(0x24c)][_0x9b22db(0x224)](_0x9b22db(0x244),_0x9b22db(0x21a),_0x9b22db(0x220));throw new Error(_0x9b22db(0x241));}return console['log'](_0x9b22db(0x209)),console['log'](_0x9b22db(0x204),_0x2e9ba4[_0x9b22db(0x218)]['id']),console[_0x9b22db(0x1f3)](_0x9b22db(0x24a),_0x2e9ba4['data']['redirect_url']),console[_0x9b22db(0x1f3)](_0x9b22db(0x229)+_0x5dd990+_0x9b22db(0x205)),console['log'](_0x9b22db(0x228)),{'gateway_payment_id':_0x2e9ba4[_0x9b22db(0x218)]['id'],'payment_url':_0x2e9ba4['data'][_0x9b22db(0x24b)]};}catch(_0x12c86c){console[_0x9b22db(0x1f8)](_0x9b22db(0x238)),console[_0x9b22db(0x1f8)]('Error\x20details:',_0x12c86c),loggerService_1['loggerService'][_0x9b22db(0x224)](_0x9b22db(0x244),_0x9b22db(0x21a),_0x12c86c);if(_0x12c86c instanceof Error){console[_0x9b22db(0x1f8)](_0x9b22db(0x21e),_0x12c86c[_0x9b22db(0x236)]),console[_0x9b22db(0x1f8)](_0x9b22db(0x215),_0x12c86c['stack']);throw new Error(_0x9b22db(0x20a)+_0x12c86c['message']);}throw new Error(_0x9b22db(0x1eb));}}async[a46_0x55e46c(0x1fe)](_0x3f5ee7){const _0x5931f4=a46_0x55e46c,_0x880f64=Date[_0x5931f4(0x200)]();try{loggerService_1[_0x5931f4(0x24c)][_0x5931f4(0x203)](_0x5931f4(0x244),_0x5931f4(0x222)+_0x3f5ee7,'GET',{});const _0xccbee3=await fetch(this[_0x5931f4(0x22a)]+'/'+_0x3f5ee7,{'method':_0x5931f4(0x20e),'headers':{'Content-Type':_0x5931f4(0x248),'User-Agent':'TesSoft\x20Payment\x20System/1.0'}}),_0x25deda=Date[_0x5931f4(0x200)]()-_0x880f64;if(!_0xccbee3['ok']){const _0x378b8a=await _0xccbee3[_0x5931f4(0x253)]();loggerService_1[_0x5931f4(0x24c)][_0x5931f4(0x1e1)](_0x5931f4(0x244),_0x5931f4(0x222)+_0x3f5ee7,_0xccbee3['status'],_0x378b8a,_0x25deda);throw new Error(_0x5931f4(0x1f7)+_0xccbee3[_0x5931f4(0x213)]);}const _0x495907=await _0xccbee3[_0x5931f4(0x210)]();loggerService_1[_0x5931f4(0x24c)][_0x5931f4(0x1e1)]('rapyd','/v1/hosted/payment_links/'+_0x3f5ee7,_0xccbee3[_0x5931f4(0x213)],_0x495907,_0x25deda);if(_0x495907[_0x5931f4(0x213)]?.[_0x5931f4(0x213)]!==_0x5931f4(0x1dd)){loggerService_1['loggerService'][_0x5931f4(0x224)](_0x5931f4(0x244),'/v1/hosted/payment_links/'+_0x3f5ee7,_0x5931f4(0x23d)+(_0x495907['status']?.[_0x5931f4(0x236)]||_0x5931f4(0x20b)));throw new Error('Rapyd\x20API\x20error:\x20'+(_0x495907[_0x5931f4(0x213)]?.[_0x5931f4(0x236)]||_0x5931f4(0x20b)));}let _0x1c3c61='PENDING';if(_0x495907['data']?.[_0x5931f4(0x213)])switch(_0x495907[_0x5931f4(0x218)][_0x5931f4(0x213)][_0x5931f4(0x1fa)]()){case _0x5931f4(0x21c):_0x1c3c61=_0x5931f4(0x23c);break;case _0x5931f4(0x1fc):_0x1c3c61=_0x5931f4(0x242);break;case _0x5931f4(0x1e8):_0x1c3c61=_0x5931f4(0x1ec);break;case _0x5931f4(0x21b):_0x1c3c61=_0x5931f4(0x242);break;case'NEW':case _0x5931f4(0x247):default:_0x1c3c61=_0x5931f4(0x1e0);break;}return{'status':_0x1c3c61,'amount':_0x495907[_0x5931f4(0x218)]?.['amount'],'currency':_0x495907['data']?.[_0x5931f4(0x1f4)]};}catch(_0x2f4766){console[_0x5931f4(0x1f8)](_0x5931f4(0x206),_0x2f4766),loggerService_1[_0x5931f4(0x24c)][_0x5931f4(0x224)](_0x5931f4(0x244),_0x5931f4(0x222)+_0x3f5ee7,_0x2f4766);throw new Error('Failed\x20to\x20verify\x20Rapyd\x20payment:\x20'+(_0x2f4766 instanceof Error?_0x2f4766[_0x5931f4(0x236)]:'Unknown\x20error'));}}async[a46_0x55e46c(0x217)](_0x31f428){const _0x196783=a46_0x55e46c;console['log'](_0x196783(0x1fb),_0x31f428);let _0x119669=_0x196783(0x1e0),_0x33e048;_0x31f428[_0x196783(0x218)]?.[_0x196783(0x1ef)]&&(_0x33e048=_0x31f428[_0x196783(0x218)][_0x196783(0x1ef)],console[_0x196783(0x1f3)](_0x196783(0x245)+_0x33e048));switch(_0x31f428[_0x196783(0x23a)]?.[_0x196783(0x1fa)]()){case'PAYMENT_COMPLETED':_0x31f428[_0x196783(0x218)]?.[_0x196783(0x202)]===!![]&&_0x31f428[_0x196783(0x218)]?.[_0x196783(0x213)]===_0x196783(0x21c)?_0x119669=_0x196783(0x23c):_0x119669='PENDING';break;case _0x196783(0x1e6):_0x119669=_0x196783(0x242);break;case _0x196783(0x240):_0x119669='EXPIRED';break;case'PAYMENT_FAILED':_0x119669=_0x196783(0x242);!_0x33e048&&_0x31f428[_0x196783(0x218)]?.[_0x196783(0x1ef)]&&(_0x33e048=_0x31f428[_0x196783(0x218)][_0x196783(0x1ef)]);break;default:switch(_0x31f428[_0x196783(0x218)]?.[_0x196783(0x213)]?.[_0x196783(0x1fa)]()){case _0x196783(0x21c):_0x31f428[_0x196783(0x218)]?.[_0x196783(0x202)]===!![]?_0x119669=_0x196783(0x23c):_0x119669=_0x196783(0x242);break;case _0x196783(0x1fc):_0x119669=_0x196783(0x242);break;case'EXP':_0x119669='EXPIRED';break;case _0x196783(0x21b):_0x119669='FAILED';!_0x33e048&&_0x31f428[_0x196783(0x218)]?.[_0x196783(0x1ef)]&&(_0x33e048=_0x31f428['data'][_0x196783(0x1ef)]);break;case'NEW':case _0x196783(0x247):default:_0x119669=_0x196783(0x1e0);break;}break;}const _0x131da8={};return _0x31f428[_0x196783(0x218)]?.[_0x196783(0x22f)]?.['last4']&&(_0x131da8[_0x196783(0x21f)]=_0x31f428[_0x196783(0x218)]['payment_method_data']['last4']),_0x31f428[_0x196783(0x218)]?.[_0x196783(0x23b)]&&(_0x131da8[_0x196783(0x24d)]=_0x31f428[_0x196783(0x218)][_0x196783(0x23b)]),_0x31f428[_0x196783(0x218)]?.[_0x196783(0x22c)]&&(_0x131da8[_0x196783(0x1e3)]=_0x31f428[_0x196783(0x218)][_0x196783(0x22c)]),_0x31f428[_0x196783(0x218)]?.[_0x196783(0x1f5)]&&(_0x131da8[_0x196783(0x24e)]=_0x31f428[_0x196783(0x218)]['failure_code']),console['log'](_0x196783(0x243)+_0x119669+_0x196783(0x23f)+(_0x33e048||_0x196783(0x20c))),{'paymentId':_0x31f428['data']?.['merchant_reference_id']||'','status':_0x119669,'amount':_0x31f428[_0x196783(0x218)]?.['amount'],'currency':_0x31f428[_0x196783(0x218)]?.[_0x196783(0x1f4)],'failureMessage':_0x33e048,'additionalInfo':_0x131da8};}}exports[a46_0x55e46c(0x208)]=RapydService;