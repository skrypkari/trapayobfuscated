'use strict';const a63_0x4ac7b2=a63_0x5585;(function(_0xc17557,_0x2eeb20){const _0x44c34d=a63_0x5585,_0x69eec6=_0xc17557();while(!![]){try{const _0x1aea7e=parseInt(_0x44c34d(0x18b))/0x1+-parseInt(_0x44c34d(0x184))/0x2+parseInt(_0x44c34d(0x189))/0x3*(parseInt(_0x44c34d(0x1be))/0x4)+parseInt(_0x44c34d(0x1b5))/0x5+parseInt(_0x44c34d(0x172))/0x6*(-parseInt(_0x44c34d(0x19a))/0x7)+-parseInt(_0x44c34d(0x181))/0x8*(parseInt(_0x44c34d(0x14a))/0x9)+parseInt(_0x44c34d(0x1bd))/0xa;if(_0x1aea7e===_0x2eeb20)break;else _0x69eec6['push'](_0x69eec6['shift']());}catch(_0x33b11a){_0x69eec6['push'](_0x69eec6['shift']());}}}(a63_0x34e3,0x613a7));function a63_0x34e3(){const _0x281151=['paymentMethod','Business\x20Error\x20(','rapyd','data','apiUrl','PENDING','2062840cgUXFX','fromEntries','https://tesoft.uk/gateway/fail.php?id=','currency','PAYMENT_CANCELED','===\x20PARSED\x20RAPYD\x20RESPONSE\x20===','NEW','POST','736980mcPDHh','2544340TRXdwa','CAN','UNKNOWN','defineProperty','floor','\x20\x20\x20fixed_side:\x20buy','failure_code','===\x20RAPYD\x20SERVICE\x20ERROR\x20===','ACT','Error\x20Code:','name','processWebhook','paid','EXPIRED','requested_currency','===\x20RAPYD\x20API\x20RESPONSE\x20(White\x20Domain)\x20===',',\x20body:\x20','CLO','GET','18mkDNwE','Full\x20Error\x20Data:','Rapyd\x20API\x20error\x20(','createPaymentLink','cardholder_name','expiration','status','ðŸ’±\x20Adding\x20currency\x20conversion\x20fields\x20for\x20','RapydService','Response\x20Body:',',\x20failureMessage=','log','Rapyd\x20payment\x20verification\x20error:','ðŸ’³\x20Payment\x20Methods:\x20gb_visa_card,\x20gb_mastercard_card','ðŸŒ\x20Rapyd\x20service\x20initialized\x20with\x20white\x20domain\x20proxy','type','last4','HTTP\x20error!\x20status:\x20','toUpperCase','phone_number','message','/v1/hosted/payment_links/','cardLast4','ðŸ’¥\x20Rapyd\x20failure\x20message:\x20','fixed_side','===\x20RAPYD\x20API\x20REQUEST\x20(White\x20Domain\x20-\x20Updated\x20Format)\x20===','URL:','logWhiteDomainResponse','custom_elements','Missing\x20id\x20or\x20redirect_url\x20in\x20response','ðŸ’³\x20Adding\x20cardholder\x20name:\x20','Error\x20details:','__esModule','../loggerService','redirect_url','\x20(always\x20GB\x20for\x20Rapyd)','===\x20RAPYD\x20API\x20BUSINESS\x20ERROR\x20===','):\x20','PAYMENT_COMPLETED','Unknown\x20error','6QrNPIA','Failed\x20to\x20verify\x20Rapyd\x20payment:\x20','stringify','Redirect\x20URL:','EUR','payment_method_type','\x20(GB\x20-\x20Britain)','Invalid\x20JSON\x20response\x20from\x20Rapyd\x20API:\x20','Incomplete\x20response:\x20missing\x20id\x20or\x20redirect_url','/v1/hosted/payment_links','Payment\x20System/1.0','Status\x20Text:','Failed\x20to\x20create\x20Rapyd\x20payment\x20link:\x20','SUCCESS','Invalid\x20response\x20from\x20Rapyd\x20API:\x20missing\x20id\x20or\x20redirect_url','1428568FcINOE','merchant_reference_id','amount','616532dsOEId','toISOString','Unknown\x20error\x20from\x20Rapyd\x20API','buy','JSON\x20Parse\x20Error:\x20','3mvQInZ','none','244367kWszim','PAID','gb_visa_card','Error\x20stack:','statusText','logWhiteDomainRequest','payment_method_data','address','\x20->\x20EUR:','ORDER:\x20','entries','error_code','logWhiteDomainError','\x20\x20\x20requested_currency:\x20EUR','loggerService','2121441rsizMI','ERR','application/json','FAILED','Failed\x20to\x20parse\x20JSON\x20response:','Response\x20data:','\x20\x20\x20expiration:\x20','Parsed\x20Result:','Payment\x20Link\x20ID:','error','failure_message','Headers:','parse','headers','HTTP\x20Status:','PAYMENT_EXPIRED','https://tesoft.uk/gateway/rapyd/','Rapyd\x20API\x20error:\x20','json','now','failureCode'];a63_0x34e3=function(){return _0x281151;};return a63_0x34e3();}Object[a63_0x4ac7b2(0x13a)](exports,a63_0x4ac7b2(0x16a),{'value':!![]}),exports[a63_0x4ac7b2(0x152)]=void 0x0;const loggerService_1=require(a63_0x4ac7b2(0x16b));function a63_0x5585(_0x5aeab0,_0x5df71e){_0x5aeab0=_0x5aeab0-0x139;const _0x34e349=a63_0x34e3();let _0x5585ed=_0x34e349[_0x5aeab0];return _0x5585ed;}class RapydService{constructor(){const _0x78afbe=a63_0x4ac7b2;this[_0x78afbe(0x1b3)]=_0x78afbe(0x1aa),console[_0x78afbe(0x155)](_0x78afbe(0x158));}async[a63_0x4ac7b2(0x14d)](_0x23a30c){const _0xeabf4c=a63_0x4ac7b2,{orderId:_0x23110f,orderName:_0x31c1ab,amount:_0x17b88c,currency:_0x3e280c,usage:_0xd71023,maxPayments:_0x1eff4a,successUrl:_0xd00582,failUrl:_0x58b117,customerName:_0x56f7c2,customerEmail:_0x3feb3a}=_0x23a30c,_0x24ed13=_0x3e280c[_0xeabf4c(0x15c)](),_0x48887a='GB';console['log']('ðŸ‡¬ðŸ‡§\x20Using\x20GB\x20(Britain)\x20as\x20country\x20for\x20Rapyd\x20payment\x20link');const _0x3da787='https://tesoft.uk/gateway/success.php?id='+_0x23110f,_0xe0797a=_0xeabf4c(0x1b7)+_0x23110f,_0x47e430={'amount':_0x17b88c,'currency':_0x24ed13,'payment_method_options':{'3d_required':![]},'cancel_checkout_url':_0xe0797a,'complete_checkout_url':_0x3da787,'complete_payment_url':_0x3da787,'merchant_reference_id':_0x23110f,'description':_0xeabf4c(0x194)+_0x23110f,'country':'GB','payment_method_types_include':[_0xeabf4c(0x18d),'gb_mastercard_card'],'custom_elements':{'display_description':!![],'billing_address_collect':!![],'required_customer_fields':[_0xeabf4c(0x141),'email',_0xeabf4c(0x15d),_0xeabf4c(0x192)]}};_0x56f7c2&&(_0x47e430[_0xeabf4c(0x166)][_0xeabf4c(0x14e)]=_0x56f7c2,console[_0xeabf4c(0x155)](_0xeabf4c(0x168)+_0x56f7c2));if(_0x24ed13!==_0xeabf4c(0x176)){const _0x237dda=Math[_0xeabf4c(0x13b)](Date['now']()/0x3e8)+0x1e*0x3c;_0x47e430[_0xeabf4c(0x162)]=_0xeabf4c(0x187),_0x47e430[_0xeabf4c(0x145)]=_0xeabf4c(0x176),_0x47e430[_0xeabf4c(0x14f)]=_0x237dda,console['log'](_0xeabf4c(0x151)+_0x24ed13+_0xeabf4c(0x193)),console['log'](_0xeabf4c(0x13c)),console[_0xeabf4c(0x155)](_0xeabf4c(0x198)),console['log'](_0xeabf4c(0x1a0)+_0x237dda+'\x20('+new Date(_0x237dda*0x3e8)[_0xeabf4c(0x185)]()+')');}const _0x474776=Date[_0xeabf4c(0x1ad)]();try{console[_0xeabf4c(0x155)](_0xeabf4c(0x163)),console[_0xeabf4c(0x155)](_0xeabf4c(0x164),this['apiUrl']),console[_0xeabf4c(0x155)]('Request\x20Body\x20(Updated\x20Format):',JSON[_0xeabf4c(0x174)](_0x47e430,null,0x2)),console['log']('ðŸ‡¬ðŸ‡§\x20Country:\x20'+_0x48887a+_0xeabf4c(0x16d)),console[_0xeabf4c(0x155)](_0xeabf4c(0x157)),loggerService_1[_0xeabf4c(0x199)][_0xeabf4c(0x190)](_0xeabf4c(0x1b1),_0xeabf4c(0x17b),'POST',_0x47e430);const _0xee6f6a=await fetch(this[_0xeabf4c(0x1b3)],{'method':_0xeabf4c(0x1bc),'headers':{'Content-Type':'application/json','User-Agent':'Payment\x20System/1.0'},'body':JSON[_0xeabf4c(0x174)](_0x47e430)}),_0x2476ed=Date[_0xeabf4c(0x1ad)]()-_0x474776;console[_0xeabf4c(0x155)](_0xeabf4c(0x146)),console[_0xeabf4c(0x155)]('Status:',_0xee6f6a[_0xeabf4c(0x150)]),console['log'](_0xeabf4c(0x17d),_0xee6f6a[_0xeabf4c(0x18f)]),console[_0xeabf4c(0x155)](_0xeabf4c(0x1a5),Object[_0xeabf4c(0x1b6)](_0xee6f6a[_0xeabf4c(0x1a7)][_0xeabf4c(0x195)]())),console[_0xeabf4c(0x155)]('Response\x20Time:',_0x2476ed+'ms');const _0x31d830=await _0xee6f6a['text']();console[_0xeabf4c(0x155)]('Raw\x20Response\x20Body:',_0x31d830);if(!_0xee6f6a['ok']){console[_0xeabf4c(0x1a3)]('===\x20RAPYD\x20API\x20ERROR\x20==='),console[_0xeabf4c(0x1a3)](_0xeabf4c(0x1a8),_0xee6f6a['status']),console['error'](_0xeabf4c(0x153),_0x31d830),loggerService_1[_0xeabf4c(0x199)][_0xeabf4c(0x165)]('rapyd',_0xeabf4c(0x17b),_0xee6f6a['status'],_0x31d830,_0x2476ed),loggerService_1[_0xeabf4c(0x199)][_0xeabf4c(0x197)]('rapyd',_0xeabf4c(0x17b),'HTTP\x20'+_0xee6f6a[_0xeabf4c(0x150)]+':\x20'+_0x31d830);throw new Error(_0xeabf4c(0x15b)+_0xee6f6a[_0xeabf4c(0x150)]+_0xeabf4c(0x147)+_0x31d830);}let _0x19b963;try{_0x19b963=JSON[_0xeabf4c(0x1a6)](_0x31d830);}catch(_0x4f0c7c){console[_0xeabf4c(0x1a3)](_0xeabf4c(0x19e),_0x4f0c7c),loggerService_1[_0xeabf4c(0x199)][_0xeabf4c(0x197)]('rapyd',_0xeabf4c(0x17b),_0xeabf4c(0x188)+_0x4f0c7c);throw new Error(_0xeabf4c(0x179)+_0x31d830);}console['log'](_0xeabf4c(0x1ba)),console[_0xeabf4c(0x155)](_0xeabf4c(0x1a1),JSON['stringify'](_0x19b963,null,0x2)),loggerService_1[_0xeabf4c(0x199)][_0xeabf4c(0x165)](_0xeabf4c(0x1b1),_0xeabf4c(0x17b),_0xee6f6a['status'],_0x19b963,_0x2476ed);if(_0x19b963[_0xeabf4c(0x150)]?.[_0xeabf4c(0x150)]!==_0xeabf4c(0x17f)){const _0x5586b4=_0x19b963['status']?.['message']||_0xeabf4c(0x186),_0x5e2ca6=_0x19b963[_0xeabf4c(0x150)]?.[_0xeabf4c(0x196)]||_0xeabf4c(0x139);console[_0xeabf4c(0x1a3)](_0xeabf4c(0x16e)),console[_0xeabf4c(0x1a3)](_0xeabf4c(0x140),_0x5e2ca6),console['error']('Error\x20Message:',_0x5586b4),console['error'](_0xeabf4c(0x14b),_0x19b963[_0xeabf4c(0x150)]),loggerService_1['loggerService'][_0xeabf4c(0x197)](_0xeabf4c(0x1b1),_0xeabf4c(0x17b),_0xeabf4c(0x1b0)+_0x5e2ca6+_0xeabf4c(0x16f)+_0x5586b4);throw new Error(_0xeabf4c(0x14c)+_0x5e2ca6+_0xeabf4c(0x16f)+_0x5586b4);}if(!_0x19b963['data']?.['id']||!_0x19b963[_0xeabf4c(0x1b2)]?.[_0xeabf4c(0x16c)]){console[_0xeabf4c(0x1a3)]('===\x20RAPYD\x20API\x20INCOMPLETE\x20RESPONSE\x20==='),console[_0xeabf4c(0x1a3)](_0xeabf4c(0x167)),console['error'](_0xeabf4c(0x19f),_0x19b963[_0xeabf4c(0x1b2)]),loggerService_1[_0xeabf4c(0x199)][_0xeabf4c(0x197)](_0xeabf4c(0x1b1),_0xeabf4c(0x17b),_0xeabf4c(0x17a));throw new Error(_0xeabf4c(0x180));}return console[_0xeabf4c(0x155)]('===\x20RAPYD\x20SUCCESS\x20==='),console['log'](_0xeabf4c(0x1a2),_0x19b963[_0xeabf4c(0x1b2)]['id']),console[_0xeabf4c(0x155)](_0xeabf4c(0x175),_0x19b963[_0xeabf4c(0x1b2)]['redirect_url']),console[_0xeabf4c(0x155)]('ðŸ‡¬ðŸ‡§\x20Country\x20used:\x20'+_0x48887a+_0xeabf4c(0x178)),console[_0xeabf4c(0x155)](_0xeabf4c(0x157)),{'gateway_payment_id':_0x19b963[_0xeabf4c(0x1b2)]['id'],'payment_url':_0x19b963[_0xeabf4c(0x1b2)][_0xeabf4c(0x16c)]};}catch(_0x14f6b3){console[_0xeabf4c(0x1a3)](_0xeabf4c(0x13e)),console[_0xeabf4c(0x1a3)](_0xeabf4c(0x169),_0x14f6b3),loggerService_1[_0xeabf4c(0x199)][_0xeabf4c(0x197)](_0xeabf4c(0x1b1),_0xeabf4c(0x17b),_0x14f6b3);if(_0x14f6b3 instanceof Error){console['error']('Error\x20message:',_0x14f6b3[_0xeabf4c(0x15e)]),console[_0xeabf4c(0x1a3)](_0xeabf4c(0x18e),_0x14f6b3['stack']);throw new Error(_0xeabf4c(0x17e)+_0x14f6b3['message']);}throw new Error('Failed\x20to\x20create\x20Rapyd\x20payment\x20link:\x20Unknown\x20error');}}async['verifyPayment'](_0x30cab2){const _0x5176a2=a63_0x4ac7b2,_0x390ab9=Date[_0x5176a2(0x1ad)]();try{loggerService_1[_0x5176a2(0x199)][_0x5176a2(0x190)]('rapyd','/v1/hosted/payment_links/'+_0x30cab2,_0x5176a2(0x149),{});const _0xd442d3=await fetch(this[_0x5176a2(0x1b3)]+'/'+_0x30cab2,{'method':'GET','headers':{'Content-Type':_0x5176a2(0x19c),'User-Agent':_0x5176a2(0x17c)}}),_0x527d55=Date[_0x5176a2(0x1ad)]()-_0x390ab9;if(!_0xd442d3['ok']){const _0x1c7c0c=await _0xd442d3['text']();loggerService_1['loggerService'][_0x5176a2(0x165)](_0x5176a2(0x1b1),_0x5176a2(0x15f)+_0x30cab2,_0xd442d3[_0x5176a2(0x150)],_0x1c7c0c,_0x527d55);throw new Error(_0x5176a2(0x15b)+_0xd442d3[_0x5176a2(0x150)]);}const _0x106eda=await _0xd442d3[_0x5176a2(0x1ac)]();loggerService_1[_0x5176a2(0x199)][_0x5176a2(0x165)](_0x5176a2(0x1b1),_0x5176a2(0x15f)+_0x30cab2,_0xd442d3['status'],_0x106eda,_0x527d55);if(_0x106eda[_0x5176a2(0x150)]?.['status']!==_0x5176a2(0x17f)){loggerService_1[_0x5176a2(0x199)][_0x5176a2(0x197)](_0x5176a2(0x1b1),'/v1/hosted/payment_links/'+_0x30cab2,_0x5176a2(0x1ab)+(_0x106eda[_0x5176a2(0x150)]?.['message']||_0x5176a2(0x171)));throw new Error(_0x5176a2(0x1ab)+(_0x106eda['status']?.[_0x5176a2(0x15e)]||'Unknown\x20error'));}let _0x35be64=_0x5176a2(0x1b4);if(_0x106eda[_0x5176a2(0x1b2)]?.[_0x5176a2(0x150)])switch(_0x106eda[_0x5176a2(0x1b2)]['status']['toUpperCase']()){case _0x5176a2(0x148):_0x35be64=_0x5176a2(0x18c);break;case _0x5176a2(0x1bf):_0x35be64='FAILED';break;case'EXP':_0x35be64='EXPIRED';break;case'ERR':_0x35be64=_0x5176a2(0x19d);break;case _0x5176a2(0x1bb):case _0x5176a2(0x13f):default:_0x35be64=_0x5176a2(0x1b4);break;}return{'status':_0x35be64,'amount':_0x106eda['data']?.[_0x5176a2(0x183)],'currency':_0x106eda[_0x5176a2(0x1b2)]?.['currency']};}catch(_0x40a8e4){console[_0x5176a2(0x1a3)](_0x5176a2(0x156),_0x40a8e4),loggerService_1[_0x5176a2(0x199)][_0x5176a2(0x197)](_0x5176a2(0x1b1),_0x5176a2(0x15f)+_0x30cab2,_0x40a8e4);throw new Error(_0x5176a2(0x173)+(_0x40a8e4 instanceof Error?_0x40a8e4[_0x5176a2(0x15e)]:'Unknown\x20error'));}}async[a63_0x4ac7b2(0x142)](_0x4cb629){const _0x28998b=a63_0x4ac7b2;console['log']('Processing\x20Rapyd\x20webhook:',_0x4cb629);let _0x2f3666='PENDING',_0xe51c44;_0x4cb629[_0x28998b(0x1b2)]?.[_0x28998b(0x1a4)]&&(_0xe51c44=_0x4cb629[_0x28998b(0x1b2)]['failure_message'],console[_0x28998b(0x155)](_0x28998b(0x161)+_0xe51c44));switch(_0x4cb629[_0x28998b(0x159)]?.[_0x28998b(0x15c)]()){case _0x28998b(0x170):_0x4cb629[_0x28998b(0x1b2)]?.[_0x28998b(0x143)]===!![]&&_0x4cb629['data']?.[_0x28998b(0x150)]===_0x28998b(0x148)?_0x2f3666=_0x28998b(0x18c):_0x2f3666='PENDING';break;case _0x28998b(0x1b9):_0x2f3666=_0x28998b(0x19d);break;case _0x28998b(0x1a9):_0x2f3666=_0x28998b(0x144);break;case'PAYMENT_FAILED':_0x2f3666=_0x28998b(0x19d);!_0xe51c44&&_0x4cb629[_0x28998b(0x1b2)]?.['failure_message']&&(_0xe51c44=_0x4cb629[_0x28998b(0x1b2)][_0x28998b(0x1a4)]);break;default:switch(_0x4cb629[_0x28998b(0x1b2)]?.[_0x28998b(0x150)]?.[_0x28998b(0x15c)]()){case _0x28998b(0x148):_0x4cb629[_0x28998b(0x1b2)]?.['paid']===!![]?_0x2f3666=_0x28998b(0x18c):_0x2f3666=_0x28998b(0x19d);break;case'CAN':_0x2f3666=_0x28998b(0x19d);break;case'EXP':_0x2f3666=_0x28998b(0x144);break;case _0x28998b(0x19b):_0x2f3666='FAILED';!_0xe51c44&&_0x4cb629[_0x28998b(0x1b2)]?.[_0x28998b(0x1a4)]&&(_0xe51c44=_0x4cb629[_0x28998b(0x1b2)]['failure_message']);break;case _0x28998b(0x1bb):case _0x28998b(0x13f):default:_0x2f3666=_0x28998b(0x1b4);break;}break;}const _0x84df50={};return _0x4cb629[_0x28998b(0x1b2)]?.[_0x28998b(0x191)]?.[_0x28998b(0x15a)]&&(_0x84df50[_0x28998b(0x160)]=_0x4cb629['data'][_0x28998b(0x191)][_0x28998b(0x15a)]),_0x4cb629[_0x28998b(0x1b2)]?.[_0x28998b(0x177)]&&(_0x84df50[_0x28998b(0x1af)]=_0x4cb629[_0x28998b(0x1b2)][_0x28998b(0x177)]),_0x4cb629[_0x28998b(0x1b2)]?.[_0x28998b(0x196)]&&(_0x84df50['errorCode']=_0x4cb629[_0x28998b(0x1b2)]['error_code']),_0x4cb629['data']?.[_0x28998b(0x13d)]&&(_0x84df50[_0x28998b(0x1ae)]=_0x4cb629[_0x28998b(0x1b2)][_0x28998b(0x13d)]),console[_0x28998b(0x155)]('ðŸ”„\x20Rapyd\x20webhook\x20processed:\x20status='+_0x2f3666+_0x28998b(0x154)+(_0xe51c44||_0x28998b(0x18a))),{'paymentId':_0x4cb629['data']?.[_0x28998b(0x182)]||'','status':_0x2f3666,'amount':_0x4cb629[_0x28998b(0x1b2)]?.[_0x28998b(0x183)],'currency':_0x4cb629[_0x28998b(0x1b2)]?.[_0x28998b(0x1b8)],'failureMessage':_0xe51c44,'additionalInfo':_0x84df50};}}exports[a63_0x4ac7b2(0x152)]=RapydService;