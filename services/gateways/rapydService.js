'use strict';const a45_0x5e96e2=a45_0x1708;function a45_0x1708(_0x13ca4d,_0x26aa6d){const _0x258a09=a45_0x258a();return a45_0x1708=function(_0x170867,_0x3c3edf){_0x170867=_0x170867-0x178;let _0x229f43=_0x258a09[_0x170867];return _0x229f43;},a45_0x1708(_0x13ca4d,_0x26aa6d);}function a45_0x258a(){const _0x509704=['Error\x20details:','NEW','Business\x20Error\x20(',',\x20body:\x20','Invalid\x20JSON\x20response\x20from\x20Rapyd\x20API:\x20','failureCode','Failed\x20to\x20parse\x20JSON\x20response:','toUpperCase','HTTP\x20Status:','statusText','Headers:',',\x20failureMessage=','Failed\x20to\x20create\x20Rapyd\x20payment\x20link:\x20Unknown\x20error','Error\x20Message:','verifyPayment','createPaymentLink','error','üåê\x20Rapyd\x20service\x20initialized\x20with\x20white\x20domain\x20proxy','Raw\x20Response\x20Body:','31842QojdNp','5637280hSHVRR','===\x20RAPYD\x20API\x20INCOMPLETE\x20RESPONSE\x20===','üá¨üáß\x20Country\x20used:\x20','üí•\x20Rapyd\x20failure\x20message:\x20','json','PAYMENT_COMPLETED','paid','===\x20RAPYD\x20API\x20BUSINESS\x20ERROR\x20===','message','failure_code','CAN','25962280uphqoC','https://tesoft.uk/gateway/fail.php?id=','Processing\x20Rapyd\x20webhook:','217fDSYNt','Status\x20Text:','GET','text','log','https://tesoft.uk/gateway/rapyd/','logWhiteDomainRequest','application/json','Redirect\x20URL:','stack','/v1/hosted/payment_links','Failed\x20to\x20verify\x20Rapyd\x20payment:\x20','cardLast4','URL:','482714KlmxAR','PAYMENT_CANCELED','Payment\x20Link\x20ID:','currency','Error\x20Code:','POST','üá¨üáß\x20Country:\x20','status','SUCCESS','failure_message','ORDER:\x20','parse','error_code','CLO','4728162aiBMAm','fromEntries','/v1/hosted/payment_links/','Unknown\x20error\x20from\x20Rapyd\x20API','Failed\x20to\x20create\x20Rapyd\x20payment\x20link:\x20','527898IyyPSR','none','Missing\x20id\x20or\x20redirect_url\x20in\x20response','rapyd','PAYMENT_FAILED','stringify','payment_method_data','logWhiteDomainError','Response\x20Time:','PAID','logWhiteDomainResponse','Rapyd\x20API\x20error\x20(','EXP','Error\x20message:','RapydService','):\x20','PENDING','headers','loggerService','amount','\x20(always\x20GB\x20for\x20Rapyd)','../loggerService','Rapyd\x20API\x20error:\x20','FAILED','3849000SXowgp','defineProperty','===\x20RAPYD\x20SUCCESS\x20===','payment_method_type','apiUrl','last4','===\x20RAPYD\x20API\x20ERROR\x20===','errorCode','Error\x20stack:','now','===\x20RAPYD\x20API\x20RESPONSE\x20(White\x20Domain)\x20===','HTTP\x20error!\x20status:\x20','\x20(GB\x20-\x20Britain)','EXPIRED','TesSoft\x20Payment\x20System/1.0','üîÑ\x20Rapyd\x20webhook\x20processed:\x20status=','Request\x20Body\x20(Updated\x20Format):','Unknown\x20error','Incomplete\x20response:\x20missing\x20id\x20or\x20redirect_url','data','__esModule','===\x20RAPYD\x20SERVICE\x20ERROR\x20===','paymentMethod','Full\x20Error\x20Data:','gb_mastercard_card','entries','ERR'];a45_0x258a=function(){return _0x509704;};return a45_0x258a();}(function(_0xe36c00,_0x1a42d4){const _0x3bbbbd=a45_0x1708,_0x4f84bd=_0xe36c00();while(!![]){try{const _0x216631=-parseInt(_0x3bbbbd(0x1dd))/0x1+-parseInt(_0x3bbbbd(0x17a))/0x2+-parseInt(_0x3bbbbd(0x1eb))/0x3+parseInt(_0x3bbbbd(0x192))/0x4+-parseInt(_0x3bbbbd(0x1c1))/0x5+-parseInt(_0x3bbbbd(0x1c0))/0x6*(-parseInt(_0x3bbbbd(0x1cf))/0x7)+parseInt(_0x3bbbbd(0x1cc))/0x8;if(_0x216631===_0x1a42d4)break;else _0x4f84bd['push'](_0x4f84bd['shift']());}catch(_0xf40220){_0x4f84bd['push'](_0x4f84bd['shift']());}}}(a45_0x258a,0xe1117));Object[a45_0x5e96e2(0x193)](exports,a45_0x5e96e2(0x1a6),{'value':!![]}),exports[a45_0x5e96e2(0x188)]=void 0x0;const loggerService_1=require(a45_0x5e96e2(0x18f));class RapydService{constructor(){const _0x31db7a=a45_0x5e96e2;this[_0x31db7a(0x196)]=_0x31db7a(0x1d4),console['log'](_0x31db7a(0x1be));}async[a45_0x5e96e2(0x1bc)](_0x1fcb06){const _0x5dc9dc=a45_0x5e96e2,{orderId:_0x101667,orderName:_0x27fc13,amount:_0x57b59d,currency:_0x4a7a40,usage:_0x5464cf,maxPayments:_0x127d9f,successUrl:_0x4a8964,failUrl:_0x26d0e7}=_0x1fcb06,_0x15ee6c=_0x4a7a40[_0x5dc9dc(0x1b4)](),_0x42a366='GB';console['log']('üá¨üáß\x20Using\x20GB\x20(Britain)\x20as\x20country\x20for\x20Rapyd\x20payment\x20link');const _0x9de00='https://tesoft.uk/gateway/success.php?id='+_0x101667,_0x324d0e=_0x5dc9dc(0x1cd)+_0x101667,_0x42c4f0={'amount':_0x57b59d,'currency':_0x15ee6c,'cancel_checkout_url':_0x324d0e,'complete_checkout_url':_0x9de00,'complete_payment_url':_0x9de00,'merchant_reference_id':_0x101667,'description':_0x5dc9dc(0x1e7)+_0x101667,'country':'GB','payment_method_types_include':['gb_visa_card',_0x5dc9dc(0x1aa)],'custom_elements':{'display_description':!![]}},_0x43717f=Date[_0x5dc9dc(0x19b)]();try{console['log']('===\x20RAPYD\x20API\x20REQUEST\x20(White\x20Domain\x20-\x20Updated\x20Format)\x20==='),console[_0x5dc9dc(0x1d3)](_0x5dc9dc(0x1dc),this[_0x5dc9dc(0x196)]),console[_0x5dc9dc(0x1d3)](_0x5dc9dc(0x1a2),JSON['stringify'](_0x42c4f0,null,0x2)),console[_0x5dc9dc(0x1d3)](_0x5dc9dc(0x1e3)+_0x42a366+_0x5dc9dc(0x18e)),console[_0x5dc9dc(0x1d3)]('üí≥\x20Payment\x20Methods:\x20gb_visa_card,\x20gb_mastercard_card'),loggerService_1[_0x5dc9dc(0x18c)][_0x5dc9dc(0x1d5)](_0x5dc9dc(0x17d),_0x5dc9dc(0x1d9),_0x5dc9dc(0x1e2),_0x42c4f0);const _0x28ced1=await fetch(this[_0x5dc9dc(0x196)],{'method':_0x5dc9dc(0x1e2),'headers':{'Content-Type':'application/json','User-Agent':_0x5dc9dc(0x1a0)},'body':JSON[_0x5dc9dc(0x17f)](_0x42c4f0)}),_0xc87337=Date[_0x5dc9dc(0x19b)]()-_0x43717f;console[_0x5dc9dc(0x1d3)](_0x5dc9dc(0x19c)),console['log']('Status:',_0x28ced1[_0x5dc9dc(0x1e4)]),console[_0x5dc9dc(0x1d3)](_0x5dc9dc(0x1d0),_0x28ced1[_0x5dc9dc(0x1b6)]),console[_0x5dc9dc(0x1d3)](_0x5dc9dc(0x1b7),Object[_0x5dc9dc(0x1ec)](_0x28ced1[_0x5dc9dc(0x18b)][_0x5dc9dc(0x1ab)]())),console[_0x5dc9dc(0x1d3)](_0x5dc9dc(0x182),_0xc87337+'ms');const _0x59a1ad=await _0x28ced1[_0x5dc9dc(0x1d2)]();console['log'](_0x5dc9dc(0x1bf),_0x59a1ad);if(!_0x28ced1['ok']){console[_0x5dc9dc(0x1bd)](_0x5dc9dc(0x198)),console['error'](_0x5dc9dc(0x1b5),_0x28ced1['status']),console['error']('Response\x20Body:',_0x59a1ad),loggerService_1[_0x5dc9dc(0x18c)][_0x5dc9dc(0x184)](_0x5dc9dc(0x17d),_0x5dc9dc(0x1d9),_0x28ced1[_0x5dc9dc(0x1e4)],_0x59a1ad,_0xc87337),loggerService_1[_0x5dc9dc(0x18c)]['logWhiteDomainError'](_0x5dc9dc(0x17d),_0x5dc9dc(0x1d9),'HTTP\x20'+_0x28ced1['status']+':\x20'+_0x59a1ad);throw new Error(_0x5dc9dc(0x19d)+_0x28ced1[_0x5dc9dc(0x1e4)]+_0x5dc9dc(0x1b0)+_0x59a1ad);}let _0x44179a;try{_0x44179a=JSON[_0x5dc9dc(0x1e8)](_0x59a1ad);}catch(_0x4ae63e){console['error'](_0x5dc9dc(0x1b3),_0x4ae63e),loggerService_1[_0x5dc9dc(0x18c)]['logWhiteDomainError'](_0x5dc9dc(0x17d),_0x5dc9dc(0x1d9),'JSON\x20Parse\x20Error:\x20'+_0x4ae63e);throw new Error(_0x5dc9dc(0x1b1)+_0x59a1ad);}console[_0x5dc9dc(0x1d3)]('===\x20PARSED\x20RAPYD\x20RESPONSE\x20==='),console['log']('Parsed\x20Result:',JSON[_0x5dc9dc(0x17f)](_0x44179a,null,0x2)),loggerService_1[_0x5dc9dc(0x18c)][_0x5dc9dc(0x184)](_0x5dc9dc(0x17d),_0x5dc9dc(0x1d9),_0x28ced1['status'],_0x44179a,_0xc87337);if(_0x44179a['status']?.[_0x5dc9dc(0x1e4)]!==_0x5dc9dc(0x1e5)){const _0x43aab3=_0x44179a[_0x5dc9dc(0x1e4)]?.[_0x5dc9dc(0x1c9)]||_0x5dc9dc(0x178),_0x69f552=_0x44179a['status']?.[_0x5dc9dc(0x1e9)]||'UNKNOWN';console[_0x5dc9dc(0x1bd)](_0x5dc9dc(0x1c8)),console[_0x5dc9dc(0x1bd)](_0x5dc9dc(0x1e1),_0x69f552),console[_0x5dc9dc(0x1bd)](_0x5dc9dc(0x1ba),_0x43aab3),console[_0x5dc9dc(0x1bd)](_0x5dc9dc(0x1a9),_0x44179a[_0x5dc9dc(0x1e4)]),loggerService_1[_0x5dc9dc(0x18c)]['logWhiteDomainError'](_0x5dc9dc(0x17d),_0x5dc9dc(0x1d9),_0x5dc9dc(0x1af)+_0x69f552+_0x5dc9dc(0x189)+_0x43aab3);throw new Error(_0x5dc9dc(0x185)+_0x69f552+_0x5dc9dc(0x189)+_0x43aab3);}if(!_0x44179a[_0x5dc9dc(0x1a5)]?.['id']||!_0x44179a[_0x5dc9dc(0x1a5)]?.['redirect_url']){console[_0x5dc9dc(0x1bd)](_0x5dc9dc(0x1c2)),console[_0x5dc9dc(0x1bd)](_0x5dc9dc(0x17c)),console[_0x5dc9dc(0x1bd)]('Response\x20data:',_0x44179a[_0x5dc9dc(0x1a5)]),loggerService_1[_0x5dc9dc(0x18c)]['logWhiteDomainError'](_0x5dc9dc(0x17d),'/v1/hosted/payment_links',_0x5dc9dc(0x1a4));throw new Error('Invalid\x20response\x20from\x20Rapyd\x20API:\x20missing\x20id\x20or\x20redirect_url');}return console[_0x5dc9dc(0x1d3)](_0x5dc9dc(0x194)),console[_0x5dc9dc(0x1d3)](_0x5dc9dc(0x1df),_0x44179a['data']['id']),console['log'](_0x5dc9dc(0x1d7),_0x44179a[_0x5dc9dc(0x1a5)]['redirect_url']),console[_0x5dc9dc(0x1d3)](_0x5dc9dc(0x1c3)+_0x42a366+_0x5dc9dc(0x19e)),console[_0x5dc9dc(0x1d3)]('üí≥\x20Payment\x20Methods:\x20gb_visa_card,\x20gb_mastercard_card'),{'gateway_payment_id':_0x44179a[_0x5dc9dc(0x1a5)]['id'],'payment_url':_0x44179a[_0x5dc9dc(0x1a5)]['redirect_url']};}catch(_0x27dad8){console[_0x5dc9dc(0x1bd)](_0x5dc9dc(0x1a7)),console['error'](_0x5dc9dc(0x1ad),_0x27dad8),loggerService_1[_0x5dc9dc(0x18c)]['logWhiteDomainError']('rapyd',_0x5dc9dc(0x1d9),_0x27dad8);if(_0x27dad8 instanceof Error){console[_0x5dc9dc(0x1bd)](_0x5dc9dc(0x187),_0x27dad8[_0x5dc9dc(0x1c9)]),console['error'](_0x5dc9dc(0x19a),_0x27dad8[_0x5dc9dc(0x1d8)]);throw new Error(_0x5dc9dc(0x179)+_0x27dad8[_0x5dc9dc(0x1c9)]);}throw new Error(_0x5dc9dc(0x1b9));}}async[a45_0x5e96e2(0x1bb)](_0x564d46){const _0x37bbc9=a45_0x5e96e2,_0x4775cd=Date[_0x37bbc9(0x19b)]();try{loggerService_1[_0x37bbc9(0x18c)][_0x37bbc9(0x1d5)]('rapyd',_0x37bbc9(0x1ed)+_0x564d46,_0x37bbc9(0x1d1),{});const _0x44860d=await fetch(this[_0x37bbc9(0x196)]+'/'+_0x564d46,{'method':_0x37bbc9(0x1d1),'headers':{'Content-Type':_0x37bbc9(0x1d6),'User-Agent':_0x37bbc9(0x1a0)}}),_0x4d7ad7=Date[_0x37bbc9(0x19b)]()-_0x4775cd;if(!_0x44860d['ok']){const _0xaebdd0=await _0x44860d[_0x37bbc9(0x1d2)]();loggerService_1[_0x37bbc9(0x18c)][_0x37bbc9(0x184)]('rapyd',_0x37bbc9(0x1ed)+_0x564d46,_0x44860d[_0x37bbc9(0x1e4)],_0xaebdd0,_0x4d7ad7);throw new Error(_0x37bbc9(0x19d)+_0x44860d[_0x37bbc9(0x1e4)]);}const _0x1bd2b3=await _0x44860d[_0x37bbc9(0x1c5)]();loggerService_1['loggerService'][_0x37bbc9(0x184)]('rapyd',_0x37bbc9(0x1ed)+_0x564d46,_0x44860d[_0x37bbc9(0x1e4)],_0x1bd2b3,_0x4d7ad7);if(_0x1bd2b3[_0x37bbc9(0x1e4)]?.[_0x37bbc9(0x1e4)]!==_0x37bbc9(0x1e5)){loggerService_1[_0x37bbc9(0x18c)][_0x37bbc9(0x181)](_0x37bbc9(0x17d),_0x37bbc9(0x1ed)+_0x564d46,'Rapyd\x20API\x20error:\x20'+(_0x1bd2b3['status']?.['message']||'Unknown\x20error'));throw new Error(_0x37bbc9(0x190)+(_0x1bd2b3['status']?.[_0x37bbc9(0x1c9)]||_0x37bbc9(0x1a3)));}let _0x5dac93=_0x37bbc9(0x18a);if(_0x1bd2b3[_0x37bbc9(0x1a5)]?.[_0x37bbc9(0x1e4)])switch(_0x1bd2b3[_0x37bbc9(0x1a5)][_0x37bbc9(0x1e4)][_0x37bbc9(0x1b4)]()){case _0x37bbc9(0x1ea):_0x5dac93=_0x37bbc9(0x183);break;case'CAN':_0x5dac93='FAILED';break;case _0x37bbc9(0x186):_0x5dac93='EXPIRED';break;case _0x37bbc9(0x1ac):_0x5dac93=_0x37bbc9(0x191);break;case _0x37bbc9(0x1ae):case'ACT':default:_0x5dac93='PENDING';break;}return{'status':_0x5dac93,'amount':_0x1bd2b3[_0x37bbc9(0x1a5)]?.[_0x37bbc9(0x18d)],'currency':_0x1bd2b3[_0x37bbc9(0x1a5)]?.[_0x37bbc9(0x1e0)]};}catch(_0x540644){console['error']('Rapyd\x20payment\x20verification\x20error:',_0x540644),loggerService_1[_0x37bbc9(0x18c)][_0x37bbc9(0x181)](_0x37bbc9(0x17d),_0x37bbc9(0x1ed)+_0x564d46,_0x540644);throw new Error(_0x37bbc9(0x1da)+(_0x540644 instanceof Error?_0x540644[_0x37bbc9(0x1c9)]:'Unknown\x20error'));}}async['processWebhook'](_0x3925a8){const _0x26bcda=a45_0x5e96e2;console[_0x26bcda(0x1d3)](_0x26bcda(0x1ce),_0x3925a8);let _0x3f538c='PENDING',_0x56be3b;_0x3925a8[_0x26bcda(0x1a5)]?.[_0x26bcda(0x1e6)]&&(_0x56be3b=_0x3925a8[_0x26bcda(0x1a5)][_0x26bcda(0x1e6)],console[_0x26bcda(0x1d3)](_0x26bcda(0x1c4)+_0x56be3b));switch(_0x3925a8['type']?.[_0x26bcda(0x1b4)]()){case _0x26bcda(0x1c6):_0x3925a8[_0x26bcda(0x1a5)]?.[_0x26bcda(0x1c7)]===!![]&&_0x3925a8['data']?.['status']==='CLO'?_0x3f538c=_0x26bcda(0x183):_0x3f538c=_0x26bcda(0x18a);break;case _0x26bcda(0x1de):_0x3f538c=_0x26bcda(0x191);break;case'PAYMENT_EXPIRED':_0x3f538c=_0x26bcda(0x19f);break;case _0x26bcda(0x17e):_0x3f538c=_0x26bcda(0x191);!_0x56be3b&&_0x3925a8[_0x26bcda(0x1a5)]?.[_0x26bcda(0x1e6)]&&(_0x56be3b=_0x3925a8[_0x26bcda(0x1a5)][_0x26bcda(0x1e6)]);break;default:switch(_0x3925a8[_0x26bcda(0x1a5)]?.[_0x26bcda(0x1e4)]?.[_0x26bcda(0x1b4)]()){case'CLO':_0x3925a8[_0x26bcda(0x1a5)]?.[_0x26bcda(0x1c7)]===!![]?_0x3f538c=_0x26bcda(0x183):_0x3f538c=_0x26bcda(0x191);break;case _0x26bcda(0x1cb):_0x3f538c=_0x26bcda(0x191);break;case _0x26bcda(0x186):_0x3f538c=_0x26bcda(0x19f);break;case _0x26bcda(0x1ac):_0x3f538c=_0x26bcda(0x191);!_0x56be3b&&_0x3925a8['data']?.[_0x26bcda(0x1e6)]&&(_0x56be3b=_0x3925a8[_0x26bcda(0x1a5)][_0x26bcda(0x1e6)]);break;case _0x26bcda(0x1ae):case'ACT':default:_0x3f538c=_0x26bcda(0x18a);break;}break;}const _0x2eab42={};return _0x3925a8[_0x26bcda(0x1a5)]?.[_0x26bcda(0x180)]?.[_0x26bcda(0x197)]&&(_0x2eab42[_0x26bcda(0x1db)]=_0x3925a8['data'][_0x26bcda(0x180)]['last4']),_0x3925a8['data']?.[_0x26bcda(0x195)]&&(_0x2eab42[_0x26bcda(0x1a8)]=_0x3925a8[_0x26bcda(0x1a5)][_0x26bcda(0x195)]),_0x3925a8[_0x26bcda(0x1a5)]?.[_0x26bcda(0x1e9)]&&(_0x2eab42[_0x26bcda(0x199)]=_0x3925a8[_0x26bcda(0x1a5)][_0x26bcda(0x1e9)]),_0x3925a8[_0x26bcda(0x1a5)]?.[_0x26bcda(0x1ca)]&&(_0x2eab42[_0x26bcda(0x1b2)]=_0x3925a8['data'][_0x26bcda(0x1ca)]),console[_0x26bcda(0x1d3)](_0x26bcda(0x1a1)+_0x3f538c+_0x26bcda(0x1b8)+(_0x56be3b||_0x26bcda(0x17b))),{'paymentId':_0x3925a8[_0x26bcda(0x1a5)]?.['merchant_reference_id']||'','status':_0x3f538c,'amount':_0x3925a8[_0x26bcda(0x1a5)]?.[_0x26bcda(0x18d)],'currency':_0x3925a8['data']?.['currency'],'failureMessage':_0x56be3b,'additionalInfo':_0x2eab42};}}exports[a45_0x5e96e2(0x188)]=RapydService;