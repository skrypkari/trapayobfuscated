'use strict';const a63_0x533bf2=a63_0x4b9e;function a63_0x2565(){const _0x1a7167=['gb_mastercard_card','log','Raw\x20Response\x20Body:','49pMNzPu','30hYuqXU','Error\x20Message:','PENDING','phone_number','Redirect\x20URL:','URL:','PAYMENT_FAILED','üí≥\x20Adding\x20cardholder\x20name:\x20','paid','560945nqvoSF','Payment\x20Link\x20ID:','1513656VzFZxd','status','CLO','payment_method_type','toUpperCase','Invalid\x20response\x20from\x20Rapyd\x20API:\x20missing\x20id\x20or\x20redirect_url','defineProperty','loggerService','===\x20RAPYD\x20API\x20BUSINESS\x20ERROR\x20===','Request\x20Body\x20(Updated\x20Format):','message','error_code',',\x20failureMessage=','SUCCESS','ERR','logWhiteDomainError','FAILED',',\x20body:\x20','PAID','apiUrl','logWhiteDomainResponse','===\x20RAPYD\x20SERVICE\x20ERROR\x20===','https://tesoft.uk/gateway/fail.php?id=','\x20(always\x20GB\x20for\x20Rapyd)','Invalid\x20JSON\x20response\x20from\x20Rapyd\x20API:\x20','Business\x20Error\x20(','json','NEW','===\x20RAPYD\x20API\x20RESPONSE\x20(White\x20Domain)\x20===','Full\x20Error\x20Data:','HTTP\x20Status:','paymentMethod','/v1/hosted/payment_links','stringify','currency','merchant_reference_id','\x20(GB\x20-\x20Britain)','Headers:','):\x20','31451147FvKHNv','../loggerService','/v1/hosted/payment_links/','10lJKimD','EXPIRED','payment_method_data','ORDER:\x20','PAYMENT_EXPIRED','entries','HTTP\x20','Status\x20Text:','11376243YSOOEb','logWhiteDomainRequest','PAYMENT_COMPLETED','üí±\x20Adding\x20currency\x20conversion\x20fields\x20for\x20','last4','65060HThMTx','rapyd','===\x20RAPYD\x20API\x20REQUEST\x20(White\x20Domain\x20-\x20Updated\x20Format)\x20===','Error\x20stack:','JSON\x20Parse\x20Error:\x20','===\x20RAPYD\x20API\x20ERROR\x20===','üá¨üáß\x20Country:\x20','üá¨üáß\x20Using\x20GB\x20(Britain)\x20as\x20country\x20for\x20Rapyd\x20payment\x20link','error','===\x20RAPYD\x20API\x20INCOMPLETE\x20RESPONSE\x20===','buy','RapydService','__esModule','Failed\x20to\x20verify\x20Rapyd\x20payment:\x20','üí≥\x20Payment\x20Methods:\x20gb_visa_card,\x20gb_mastercard_card','Incomplete\x20response:\x20missing\x20id\x20or\x20redirect_url','EXP','Unknown\x20error','expiration','461805NljDfh','data','HTTP\x20error!\x20status:\x20','437XBMFkE','\x20->\x20EUR:','toISOString','Response\x20Time:','requested_currency','\x20\x20\x20expiration:\x20','failure_code','text','6662nptcjT','300maWrSj','email','Status:','Response\x20data:','Unknown\x20error\x20from\x20Rapyd\x20API','Processing\x20Rapyd\x20webhook:','üá¨üáß\x20Country\x20used:\x20','now','floor','amount','===\x20PARSED\x20RAPYD\x20RESPONSE\x20===','errorCode','ACT','EUR','GET','split','üåê\x20Rapyd\x20service\x20initialized\x20with\x20white\x20domain\x20proxy','application/json','Failed\x20to\x20parse\x20JSON\x20response:','name','processWebhook','üí•\x20Rapyd\x20failure\x20message:\x20','https://tesoft.uk/gateway/rapyd/','12cWuVUX','Rapyd\x20API\x20error\x20(','failureCode','Response\x20Body:','Error\x20Code:','üîÑ\x20Rapyd\x20webhook\x20processed:\x20status=','Error\x20details:','\x20\x20\x20requested_currency:\x20EUR','headers','redirect_url','CAN','parse','failure_message','cardLast4','POST','Payment\x20System/1.0','statusText','custom_elements'];a63_0x2565=function(){return _0x1a7167;};return a63_0x2565();}(function(_0x507cc4,_0x4ff964){const _0x548d43=a63_0x4b9e,_0x2f2ec6=_0x507cc4();while(!![]){try{const _0x3416bb=parseInt(_0x548d43(0xe9))/0x1*(parseInt(_0x548d43(0xf1))/0x2)+parseInt(_0x548d43(0xe6))/0x3*(parseInt(_0x548d43(0x109))/0x4)+-parseInt(_0x548d43(0xd3))/0x5*(-parseInt(_0x548d43(0x91))/0x6)+-parseInt(_0x548d43(0x90))/0x7*(-parseInt(_0x548d43(0x9c))/0x8)+parseInt(_0x548d43(0xce))/0x9*(parseInt(_0x548d43(0xc6))/0xa)+parseInt(_0x548d43(0x9a))/0xb*(-parseInt(_0x548d43(0xf2))/0xc)+-parseInt(_0x548d43(0xc3))/0xd;if(_0x3416bb===_0x4ff964)break;else _0x2f2ec6['push'](_0x2f2ec6['shift']());}catch(_0x3c8f53){_0x2f2ec6['push'](_0x2f2ec6['shift']());}}}(a63_0x2565,0xd60fa));Object[a63_0x533bf2(0xa2)](exports,a63_0x533bf2(0xdf),{'value':!![]}),exports[a63_0x533bf2(0xde)]=void 0x0;const loggerService_1=require(a63_0x533bf2(0xc4));class RapydService{constructor(){const _0x516448=a63_0x533bf2;this[_0x516448(0xaf)]=_0x516448(0x108),console[_0x516448(0x8e)](_0x516448(0x102));}async['createPaymentLink'](_0x31f377){const _0x3aa23e=a63_0x533bf2,{orderId:_0x3bf50c,orderName:_0x4218f1,amount:_0x53ede3,currency:_0x2306f0,usage:_0x2be84a,maxPayments:_0x2e2346,successUrl:_0xd86233,failUrl:_0x282f5e,customerName:_0xc26ed0,customerEmail:_0xf67577}=_0x31f377,_0x4b951b=_0x2306f0[_0x3aa23e(0xa0)](),_0x312792='GB';console[_0x3aa23e(0x8e)](_0x3aa23e(0xda));const _0x265128='https://tesoft.uk/gateway/success.php?id='+_0x3bf50c,_0x525cf3=_0x3aa23e(0xb2)+_0x3bf50c,_0x5ba55e={'amount':_0x53ede3,'currency':_0x4b951b,'payment_method_options':{'3d_required':![]},'cancel_checkout_url':_0x525cf3,'complete_checkout_url':_0x265128,'complete_payment_url':_0x265128,'merchant_reference_id':_0x3bf50c,'description':_0x3aa23e(0xc9)+_0x3bf50c,'statement_descriptor':'TESOFT\x20'+(_0x3bf50c[_0x3aa23e(0x101)]('-')[0x1]||_0x3bf50c),'country':'GB','payment_method_types_include':['gb_visa_card',_0x3aa23e(0x8d)],'custom_elements':{'display_description':!![],'billing_address_collect':!![],'required_customer_fields':[_0x3aa23e(0x105),_0x3aa23e(0xf3),_0x3aa23e(0x94),'address']}};_0xc26ed0&&(_0x5ba55e[_0x3aa23e(0x8c)]['cardholder_name']=_0xc26ed0,console[_0x3aa23e(0x8e)](_0x3aa23e(0x98)+_0xc26ed0));if(_0x4b951b!==_0x3aa23e(0xff)){const _0x2b9216=Math[_0x3aa23e(0xfa)](Date[_0x3aa23e(0xf9)]()/0x3e8)+0x1e*0x3c;_0x5ba55e['fixed_side']=_0x3aa23e(0xdd),_0x5ba55e[_0x3aa23e(0xed)]=_0x3aa23e(0xff),_0x5ba55e[_0x3aa23e(0xe5)]=_0x2b9216,console[_0x3aa23e(0x8e)](_0x3aa23e(0xd1)+_0x4b951b+_0x3aa23e(0xea)),console[_0x3aa23e(0x8e)]('\x20\x20\x20fixed_side:\x20buy'),console[_0x3aa23e(0x8e)](_0x3aa23e(0x82)),console['log'](_0x3aa23e(0xee)+_0x2b9216+'\x20('+new Date(_0x2b9216*0x3e8)[_0x3aa23e(0xeb)]()+')');}const _0x4d73b0=Date[_0x3aa23e(0xf9)]();try{console[_0x3aa23e(0x8e)](_0x3aa23e(0xd5)),console['log'](_0x3aa23e(0x96),this['apiUrl']),console[_0x3aa23e(0x8e)](_0x3aa23e(0xa5),JSON['stringify'](_0x5ba55e,null,0x2)),console[_0x3aa23e(0x8e)](_0x3aa23e(0xd9)+_0x312792+_0x3aa23e(0xb3)),console[_0x3aa23e(0x8e)](_0x3aa23e(0xe1)),loggerService_1[_0x3aa23e(0xa3)][_0x3aa23e(0xcf)](_0x3aa23e(0xd4),_0x3aa23e(0xbc),_0x3aa23e(0x89),_0x5ba55e);const _0x186b49=await fetch(this[_0x3aa23e(0xaf)],{'method':_0x3aa23e(0x89),'headers':{'Content-Type':_0x3aa23e(0x103),'User-Agent':_0x3aa23e(0x8a)},'body':JSON[_0x3aa23e(0xbd)](_0x5ba55e)}),_0x297c2e=Date[_0x3aa23e(0xf9)]()-_0x4d73b0;console[_0x3aa23e(0x8e)](_0x3aa23e(0xb8)),console[_0x3aa23e(0x8e)](_0x3aa23e(0xf4),_0x186b49[_0x3aa23e(0x9d)]),console[_0x3aa23e(0x8e)](_0x3aa23e(0xcd),_0x186b49[_0x3aa23e(0x8b)]),console[_0x3aa23e(0x8e)](_0x3aa23e(0xc1),Object['fromEntries'](_0x186b49[_0x3aa23e(0x83)][_0x3aa23e(0xcb)]())),console[_0x3aa23e(0x8e)](_0x3aa23e(0xec),_0x297c2e+'ms');const _0x383af6=await _0x186b49[_0x3aa23e(0xf0)]();console[_0x3aa23e(0x8e)](_0x3aa23e(0x8f),_0x383af6);if(!_0x186b49['ok']){console[_0x3aa23e(0xdb)](_0x3aa23e(0xd8)),console[_0x3aa23e(0xdb)](_0x3aa23e(0xba),_0x186b49[_0x3aa23e(0x9d)]),console[_0x3aa23e(0xdb)](_0x3aa23e(0x10c),_0x383af6),loggerService_1[_0x3aa23e(0xa3)][_0x3aa23e(0xb0)](_0x3aa23e(0xd4),'/v1/hosted/payment_links',_0x186b49['status'],_0x383af6,_0x297c2e),loggerService_1['loggerService']['logWhiteDomainError'](_0x3aa23e(0xd4),_0x3aa23e(0xbc),_0x3aa23e(0xcc)+_0x186b49[_0x3aa23e(0x9d)]+':\x20'+_0x383af6);throw new Error(_0x3aa23e(0xe8)+_0x186b49[_0x3aa23e(0x9d)]+_0x3aa23e(0xad)+_0x383af6);}let _0x1f42bf;try{_0x1f42bf=JSON[_0x3aa23e(0x86)](_0x383af6);}catch(_0x3ff0e2){console[_0x3aa23e(0xdb)](_0x3aa23e(0x104),_0x3ff0e2),loggerService_1[_0x3aa23e(0xa3)][_0x3aa23e(0xab)](_0x3aa23e(0xd4),'/v1/hosted/payment_links',_0x3aa23e(0xd7)+_0x3ff0e2);throw new Error(_0x3aa23e(0xb4)+_0x383af6);}console[_0x3aa23e(0x8e)](_0x3aa23e(0xfc)),console[_0x3aa23e(0x8e)]('Parsed\x20Result:',JSON[_0x3aa23e(0xbd)](_0x1f42bf,null,0x2)),loggerService_1[_0x3aa23e(0xa3)]['logWhiteDomainResponse'](_0x3aa23e(0xd4),_0x3aa23e(0xbc),_0x186b49[_0x3aa23e(0x9d)],_0x1f42bf,_0x297c2e);if(_0x1f42bf[_0x3aa23e(0x9d)]?.[_0x3aa23e(0x9d)]!=='SUCCESS'){const _0x98f31c=_0x1f42bf['status']?.[_0x3aa23e(0xa6)]||_0x3aa23e(0xf6),_0x26616f=_0x1f42bf['status']?.[_0x3aa23e(0xa7)]||'UNKNOWN';console[_0x3aa23e(0xdb)](_0x3aa23e(0xa4)),console[_0x3aa23e(0xdb)](_0x3aa23e(0x7f),_0x26616f),console[_0x3aa23e(0xdb)](_0x3aa23e(0x92),_0x98f31c),console[_0x3aa23e(0xdb)](_0x3aa23e(0xb9),_0x1f42bf[_0x3aa23e(0x9d)]),loggerService_1[_0x3aa23e(0xa3)][_0x3aa23e(0xab)](_0x3aa23e(0xd4),'/v1/hosted/payment_links',_0x3aa23e(0xb5)+_0x26616f+'):\x20'+_0x98f31c);throw new Error(_0x3aa23e(0x10a)+_0x26616f+_0x3aa23e(0xc2)+_0x98f31c);}if(!_0x1f42bf[_0x3aa23e(0xe7)]?.['id']||!_0x1f42bf[_0x3aa23e(0xe7)]?.[_0x3aa23e(0x84)]){console[_0x3aa23e(0xdb)](_0x3aa23e(0xdc)),console['error']('Missing\x20id\x20or\x20redirect_url\x20in\x20response'),console[_0x3aa23e(0xdb)](_0x3aa23e(0xf5),_0x1f42bf[_0x3aa23e(0xe7)]),loggerService_1[_0x3aa23e(0xa3)][_0x3aa23e(0xab)]('rapyd',_0x3aa23e(0xbc),_0x3aa23e(0xe2));throw new Error(_0x3aa23e(0xa1));}return console[_0x3aa23e(0x8e)]('===\x20RAPYD\x20SUCCESS\x20==='),console[_0x3aa23e(0x8e)](_0x3aa23e(0x9b),_0x1f42bf[_0x3aa23e(0xe7)]['id']),console[_0x3aa23e(0x8e)](_0x3aa23e(0x95),_0x1f42bf[_0x3aa23e(0xe7)][_0x3aa23e(0x84)]),console[_0x3aa23e(0x8e)](_0x3aa23e(0xf8)+_0x312792+_0x3aa23e(0xc0)),console['log'](_0x3aa23e(0xe1)),{'gateway_payment_id':_0x1f42bf[_0x3aa23e(0xe7)]['id'],'payment_url':_0x1f42bf[_0x3aa23e(0xe7)][_0x3aa23e(0x84)]};}catch(_0x1cecac){console[_0x3aa23e(0xdb)](_0x3aa23e(0xb1)),console[_0x3aa23e(0xdb)](_0x3aa23e(0x81),_0x1cecac),loggerService_1[_0x3aa23e(0xa3)][_0x3aa23e(0xab)](_0x3aa23e(0xd4),'/v1/hosted/payment_links',_0x1cecac);if(_0x1cecac instanceof Error){console[_0x3aa23e(0xdb)]('Error\x20message:',_0x1cecac[_0x3aa23e(0xa6)]),console[_0x3aa23e(0xdb)](_0x3aa23e(0xd6),_0x1cecac['stack']);throw new Error('Failed\x20to\x20create\x20Rapyd\x20payment\x20link:\x20'+_0x1cecac['message']);}throw new Error('Failed\x20to\x20create\x20Rapyd\x20payment\x20link:\x20Unknown\x20error');}}async['verifyPayment'](_0x4c59ac){const _0x32b48e=a63_0x533bf2,_0x4c805f=Date[_0x32b48e(0xf9)]();try{loggerService_1['loggerService'][_0x32b48e(0xcf)](_0x32b48e(0xd4),'/v1/hosted/payment_links/'+_0x4c59ac,_0x32b48e(0x100),{});const _0x3e18f8=await fetch(this['apiUrl']+'/'+_0x4c59ac,{'method':_0x32b48e(0x100),'headers':{'Content-Type':'application/json','User-Agent':_0x32b48e(0x8a)}}),_0x555ed4=Date['now']()-_0x4c805f;if(!_0x3e18f8['ok']){const _0x47f53d=await _0x3e18f8[_0x32b48e(0xf0)]();loggerService_1[_0x32b48e(0xa3)][_0x32b48e(0xb0)](_0x32b48e(0xd4),_0x32b48e(0xc5)+_0x4c59ac,_0x3e18f8[_0x32b48e(0x9d)],_0x47f53d,_0x555ed4);throw new Error(_0x32b48e(0xe8)+_0x3e18f8[_0x32b48e(0x9d)]);}const _0x510dde=await _0x3e18f8[_0x32b48e(0xb6)]();loggerService_1[_0x32b48e(0xa3)][_0x32b48e(0xb0)]('rapyd','/v1/hosted/payment_links/'+_0x4c59ac,_0x3e18f8[_0x32b48e(0x9d)],_0x510dde,_0x555ed4);if(_0x510dde[_0x32b48e(0x9d)]?.['status']!==_0x32b48e(0xa9)){loggerService_1[_0x32b48e(0xa3)][_0x32b48e(0xab)]('rapyd','/v1/hosted/payment_links/'+_0x4c59ac,'Rapyd\x20API\x20error:\x20'+(_0x510dde[_0x32b48e(0x9d)]?.[_0x32b48e(0xa6)]||_0x32b48e(0xe4)));throw new Error('Rapyd\x20API\x20error:\x20'+(_0x510dde[_0x32b48e(0x9d)]?.[_0x32b48e(0xa6)]||_0x32b48e(0xe4)));}let _0x5da821=_0x32b48e(0x93);if(_0x510dde['data']?.[_0x32b48e(0x9d)])switch(_0x510dde[_0x32b48e(0xe7)]['status'][_0x32b48e(0xa0)]()){case _0x32b48e(0x9e):_0x5da821=_0x32b48e(0xae);break;case'CAN':_0x5da821=_0x32b48e(0xac);break;case'EXP':_0x5da821=_0x32b48e(0xc7);break;case _0x32b48e(0xaa):_0x5da821=_0x32b48e(0xac);break;case _0x32b48e(0xb7):case'ACT':default:_0x5da821='PENDING';break;}return{'status':_0x5da821,'amount':_0x510dde['data']?.[_0x32b48e(0xfb)],'currency':_0x510dde['data']?.[_0x32b48e(0xbe)]};}catch(_0x1af7d8){console[_0x32b48e(0xdb)]('Rapyd\x20payment\x20verification\x20error:',_0x1af7d8),loggerService_1[_0x32b48e(0xa3)][_0x32b48e(0xab)]('rapyd',_0x32b48e(0xc5)+_0x4c59ac,_0x1af7d8);throw new Error(_0x32b48e(0xe0)+(_0x1af7d8 instanceof Error?_0x1af7d8[_0x32b48e(0xa6)]:_0x32b48e(0xe4)));}}async[a63_0x533bf2(0x106)](_0x73f1ae){const _0x85014c=a63_0x533bf2;console['log'](_0x85014c(0xf7),_0x73f1ae);let _0x1e970d=_0x85014c(0x93),_0x15eb8d;_0x73f1ae[_0x85014c(0xe7)]?.[_0x85014c(0x87)]&&(_0x15eb8d=_0x73f1ae[_0x85014c(0xe7)]['failure_message'],console[_0x85014c(0x8e)](_0x85014c(0x107)+_0x15eb8d));switch(_0x73f1ae['type']?.[_0x85014c(0xa0)]()){case _0x85014c(0xd0):_0x73f1ae[_0x85014c(0xe7)]?.[_0x85014c(0x99)]===!![]&&_0x73f1ae[_0x85014c(0xe7)]?.[_0x85014c(0x9d)]===_0x85014c(0x9e)?_0x1e970d=_0x85014c(0xae):_0x1e970d=_0x85014c(0x93);break;case'PAYMENT_CANCELED':_0x1e970d=_0x85014c(0xac);break;case _0x85014c(0xca):_0x1e970d='EXPIRED';break;case _0x85014c(0x97):_0x1e970d=_0x85014c(0xac);!_0x15eb8d&&_0x73f1ae[_0x85014c(0xe7)]?.[_0x85014c(0x87)]&&(_0x15eb8d=_0x73f1ae[_0x85014c(0xe7)][_0x85014c(0x87)]);break;default:switch(_0x73f1ae[_0x85014c(0xe7)]?.[_0x85014c(0x9d)]?.['toUpperCase']()){case'CLO':_0x73f1ae['data']?.['paid']===!![]?_0x1e970d=_0x85014c(0xae):_0x1e970d=_0x85014c(0xac);break;case _0x85014c(0x85):_0x1e970d=_0x85014c(0xac);break;case _0x85014c(0xe3):_0x1e970d=_0x85014c(0xc7);break;case _0x85014c(0xaa):_0x1e970d=_0x85014c(0xac);!_0x15eb8d&&_0x73f1ae['data']?.[_0x85014c(0x87)]&&(_0x15eb8d=_0x73f1ae['data']['failure_message']);break;case _0x85014c(0xb7):case _0x85014c(0xfe):default:_0x1e970d=_0x85014c(0x93);break;}break;}const _0x1d9363={};return _0x73f1ae['data']?.[_0x85014c(0xc8)]?.[_0x85014c(0xd2)]&&(_0x1d9363[_0x85014c(0x88)]=_0x73f1ae[_0x85014c(0xe7)][_0x85014c(0xc8)][_0x85014c(0xd2)]),_0x73f1ae[_0x85014c(0xe7)]?.[_0x85014c(0x9f)]&&(_0x1d9363[_0x85014c(0xbb)]=_0x73f1ae[_0x85014c(0xe7)][_0x85014c(0x9f)]),_0x73f1ae[_0x85014c(0xe7)]?.['error_code']&&(_0x1d9363[_0x85014c(0xfd)]=_0x73f1ae['data'][_0x85014c(0xa7)]),_0x73f1ae[_0x85014c(0xe7)]?.[_0x85014c(0xef)]&&(_0x1d9363[_0x85014c(0x10b)]=_0x73f1ae[_0x85014c(0xe7)][_0x85014c(0xef)]),console[_0x85014c(0x8e)](_0x85014c(0x80)+_0x1e970d+_0x85014c(0xa8)+(_0x15eb8d||'none')),{'paymentId':_0x73f1ae[_0x85014c(0xe7)]?.[_0x85014c(0xbf)]||'','status':_0x1e970d,'amount':_0x73f1ae['data']?.['amount'],'currency':_0x73f1ae[_0x85014c(0xe7)]?.[_0x85014c(0xbe)],'failureMessage':_0x15eb8d,'additionalInfo':_0x1d9363};}}function a63_0x4b9e(_0x42dd37,_0x5ee4c7){_0x42dd37=_0x42dd37-0x7f;const _0x256568=a63_0x2565();let _0x4b9ef9=_0x256568[_0x42dd37];return _0x4b9ef9;}exports[a63_0x533bf2(0xde)]=RapydService;