'use strict';const a56_0x3814a3=a56_0xb333;(function(_0xf522ba,_0x8254dd){const _0x108723=a56_0xb333,_0x5b548b=_0xf522ba();while(!![]){try{const _0x58476b=parseInt(_0x108723(0x158))/0x1+parseInt(_0x108723(0xfa))/0x2+-parseInt(_0x108723(0x106))/0x3+-parseInt(_0x108723(0x153))/0x4*(parseInt(_0x108723(0x13d))/0x5)+parseInt(_0x108723(0x15d))/0x6*(-parseInt(_0x108723(0x16a))/0x7)+parseInt(_0x108723(0x11a))/0x8+parseInt(_0x108723(0x146))/0x9*(parseInt(_0x108723(0x143))/0xa);if(_0x58476b===_0x8254dd)break;else _0x5b548b['push'](_0x5b548b['shift']());}catch(_0x3202db){_0x5b548b['push'](_0x5b548b['shift']());}}}(a56_0x57b1,0x85af7));function a56_0x57b1(){const _0x375328=['Redirect\x20URL:','EUR','Failed\x20to\x20create\x20Rapyd\x20payment\x20link:\x20','PAID','🇬🇧\x20Country\x20used:\x20','verifyPayment','EXPIRED','🔄\x20Rapyd\x20webhook\x20processed:\x20status=','Unknown\x20error\x20from\x20Rapyd\x20API','rapyd','cardLast4','Payment\x20Link\x20ID:','🇬🇧\x20Country:\x20','🇬🇧\x20Using\x20GB\x20(Britain)\x20as\x20country\x20for\x20Rapyd\x20payment\x20link','Response\x20Time:','requested_currency','loggerService','Error\x20message:','statusText','headers','FAILED','floor','/v1/hosted/payment_links/','UNKNOWN','GET','===\x20RAPYD\x20API\x20ERROR\x20===','stack','545GKThQQ','error','redirect_url','Incomplete\x20response:\x20missing\x20id\x20or\x20redirect_url','===\x20RAPYD\x20SUCCESS\x20===','Full\x20Error\x20Data:','10fZXWlg','none','💳\x20Payment\x20Methods:\x20gb_visa_card,\x20gb_mastercard_card','8397612RNRCpV','Response\x20Body:','message','===\x20PARSED\x20RAPYD\x20RESPONSE\x20===','type','💱\x20Adding\x20currency\x20conversion\x20fields\x20for\x20','status','log','🌐\x20Rapyd\x20service\x20initialized\x20with\x20white\x20domain\x20proxy','logWhiteDomainRequest','===\x20RAPYD\x20API\x20INCOMPLETE\x20RESPONSE\x20===','POST','fixed_side','22612wtJJDN','Missing\x20id\x20or\x20redirect_url\x20in\x20response','entries','failure_code','Processing\x20Rapyd\x20webhook:','128915iRocbf','Response\x20data:','gb_mastercard_card','error_code','ORDER:\x20','30aZqMet','RapydService','defineProperty','HTTP\x20','CAN','HTTP\x20error!\x20status:\x20','\x20->\x20EUR:',',\x20failureMessage=','paid','PENDING','):\x20','ERR','failure_message','784483VZzvtY','Status\x20Text:','PAYMENT_CANCELED','gb_visa_card','===\x20RAPYD\x20SERVICE\x20ERROR\x20===','toISOString','Payment\x20System/1.0','last4','NEW','===\x20RAPYD\x20API\x20BUSINESS\x20ERROR\x20===','JSON\x20Parse\x20Error:\x20','CLO','currency','===\x20RAPYD\x20API\x20REQUEST\x20(White\x20Domain\x20-\x20Updated\x20Format)\x20===','logWhiteDomainResponse','now','payment_method_type','1534708zihGuY','ACT','Request\x20Body\x20(Updated\x20Format):','text','Rapyd\x20API\x20error:\x20','SUCCESS','/v1/hosted/payment_links','EXP','\x20(GB\x20-\x20Britain)','Error\x20Message:','https://tesoft.uk/gateway/success.php?id=','payment_method_data','834921RktRLI','Status:','stringify','\x20\x20\x20requested_currency:\x20EUR','data','processWebhook','💥\x20Rapyd\x20failure\x20message:\x20','json','Error\x20stack:','application/json','Invalid\x20JSON\x20response\x20from\x20Rapyd\x20API:\x20','Rapyd\x20payment\x20verification\x20error:','merchant_reference_id','Unknown\x20error','parse','Invalid\x20response\x20from\x20Rapyd\x20API:\x20missing\x20id\x20or\x20redirect_url','===\x20RAPYD\x20API\x20RESPONSE\x20(White\x20Domain)\x20===','fromEntries','toUpperCase','Failed\x20to\x20verify\x20Rapyd\x20payment:\x20','1384536oBaEQf','logWhiteDomainError','HTTP\x20Status:','PAYMENT_FAILED','Error\x20Code:','apiUrl','PAYMENT_EXPIRED','failureCode'];a56_0x57b1=function(){return _0x375328;};return a56_0x57b1();}Object[a56_0x3814a3(0x15f)](exports,'__esModule',{'value':!![]}),exports[a56_0x3814a3(0x15e)]=void 0x0;const loggerService_1=require('../loggerService');function a56_0xb333(_0xcf9264,_0x5cf5d2){const _0x57b11e=a56_0x57b1();return a56_0xb333=function(_0xb3330,_0x34fd96){_0xb3330=_0xb3330-0xf3;let _0x1df133=_0x57b11e[_0xb3330];return _0x1df133;},a56_0xb333(_0xcf9264,_0x5cf5d2);}class RapydService{constructor(){const _0xca9650=a56_0x3814a3;this[_0xca9650(0x11f)]='https://tesoft.uk/gateway/rapyd/',console[_0xca9650(0x14d)](_0xca9650(0x14e));}async['createPaymentLink'](_0x1b36c4){const _0xa84eb7=a56_0x3814a3,{orderId:_0x57fad7,orderName:_0x103732,amount:_0x5e8351,currency:_0x485ca5,usage:_0x19608d,maxPayments:_0x52acc2,successUrl:_0x2e26a2,failUrl:_0x399a64}=_0x1b36c4,_0x195254=_0x485ca5[_0xa84eb7(0x118)](),_0x193d70='GB';console['log'](_0xa84eb7(0x12f));const _0x46ff69=_0xa84eb7(0x104)+_0x57fad7,_0x35943a='https://tesoft.uk/gateway/fail.php?id='+_0x57fad7,_0x1222e4={'amount':_0x5e8351,'currency':_0x195254,'cancel_checkout_url':_0x35943a,'complete_checkout_url':_0x46ff69,'complete_payment_url':_0x46ff69,'merchant_reference_id':_0x57fad7,'description':_0xa84eb7(0x15c)+_0x57fad7,'country':'GB','payment_method_types_include':[_0xa84eb7(0x16d),_0xa84eb7(0x15a)],'custom_elements':{'display_description':!![]}};if(_0x195254!=='EUR'){const _0x30625b=Math[_0xa84eb7(0x137)](Date[_0xa84eb7(0xf8)]()/0x3e8)+0x1e*0x3c;_0x1222e4[_0xa84eb7(0x152)]='buy',_0x1222e4[_0xa84eb7(0x131)]=_0xa84eb7(0x123),_0x1222e4['expiration']=_0x30625b,console['log'](_0xa84eb7(0x14b)+_0x195254+_0xa84eb7(0x163)),console[_0xa84eb7(0x14d)]('\x20\x20\x20fixed_side:\x20buy'),console[_0xa84eb7(0x14d)](_0xa84eb7(0x109)),console[_0xa84eb7(0x14d)]('\x20\x20\x20expiration:\x20'+_0x30625b+'\x20('+new Date(_0x30625b*0x3e8)[_0xa84eb7(0x16f)]()+')');}const _0x46985e=Date[_0xa84eb7(0xf8)]();try{console['log'](_0xa84eb7(0xf6)),console[_0xa84eb7(0x14d)]('URL:',this[_0xa84eb7(0x11f)]),console[_0xa84eb7(0x14d)](_0xa84eb7(0xfc),JSON[_0xa84eb7(0x108)](_0x1222e4,null,0x2)),console[_0xa84eb7(0x14d)](_0xa84eb7(0x12e)+_0x193d70+'\x20(always\x20GB\x20for\x20Rapyd)'),console['log'](_0xa84eb7(0x145)),loggerService_1[_0xa84eb7(0x132)]['logWhiteDomainRequest']('rapyd',_0xa84eb7(0x100),_0xa84eb7(0x151),_0x1222e4);const _0x1f2fd3=await fetch(this[_0xa84eb7(0x11f)],{'method':_0xa84eb7(0x151),'headers':{'Content-Type':_0xa84eb7(0x10f),'User-Agent':'Payment\x20System/1.0'},'body':JSON[_0xa84eb7(0x108)](_0x1222e4)}),_0xbe981=Date[_0xa84eb7(0xf8)]()-_0x46985e;console[_0xa84eb7(0x14d)](_0xa84eb7(0x116)),console[_0xa84eb7(0x14d)](_0xa84eb7(0x107),_0x1f2fd3['status']),console['log'](_0xa84eb7(0x16b),_0x1f2fd3[_0xa84eb7(0x134)]),console[_0xa84eb7(0x14d)]('Headers:',Object[_0xa84eb7(0x117)](_0x1f2fd3[_0xa84eb7(0x135)][_0xa84eb7(0x155)]())),console['log'](_0xa84eb7(0x130),_0xbe981+'ms');const _0x49283d=await _0x1f2fd3[_0xa84eb7(0xfd)]();console[_0xa84eb7(0x14d)]('Raw\x20Response\x20Body:',_0x49283d);if(!_0x1f2fd3['ok']){console[_0xa84eb7(0x13e)](_0xa84eb7(0x13b)),console[_0xa84eb7(0x13e)](_0xa84eb7(0x11c),_0x1f2fd3[_0xa84eb7(0x14c)]),console[_0xa84eb7(0x13e)](_0xa84eb7(0x147),_0x49283d),loggerService_1['loggerService'][_0xa84eb7(0xf7)](_0xa84eb7(0x12b),'/v1/hosted/payment_links',_0x1f2fd3[_0xa84eb7(0x14c)],_0x49283d,_0xbe981),loggerService_1[_0xa84eb7(0x132)][_0xa84eb7(0x11b)](_0xa84eb7(0x12b),_0xa84eb7(0x100),_0xa84eb7(0x160)+_0x1f2fd3[_0xa84eb7(0x14c)]+':\x20'+_0x49283d);throw new Error(_0xa84eb7(0x162)+_0x1f2fd3[_0xa84eb7(0x14c)]+',\x20body:\x20'+_0x49283d);}let _0x2a1794;try{_0x2a1794=JSON[_0xa84eb7(0x114)](_0x49283d);}catch(_0x58f2a0){console[_0xa84eb7(0x13e)]('Failed\x20to\x20parse\x20JSON\x20response:',_0x58f2a0),loggerService_1['loggerService'][_0xa84eb7(0x11b)](_0xa84eb7(0x12b),'/v1/hosted/payment_links',_0xa84eb7(0xf3)+_0x58f2a0);throw new Error(_0xa84eb7(0x110)+_0x49283d);}console['log'](_0xa84eb7(0x149)),console['log']('Parsed\x20Result:',JSON[_0xa84eb7(0x108)](_0x2a1794,null,0x2)),loggerService_1[_0xa84eb7(0x132)][_0xa84eb7(0xf7)](_0xa84eb7(0x12b),_0xa84eb7(0x100),_0x1f2fd3['status'],_0x2a1794,_0xbe981);if(_0x2a1794[_0xa84eb7(0x14c)]?.['status']!==_0xa84eb7(0xff)){const _0x223dea=_0x2a1794[_0xa84eb7(0x14c)]?.['message']||_0xa84eb7(0x12a),_0x167626=_0x2a1794[_0xa84eb7(0x14c)]?.[_0xa84eb7(0x15b)]||_0xa84eb7(0x139);console['error'](_0xa84eb7(0x173)),console[_0xa84eb7(0x13e)](_0xa84eb7(0x11e),_0x167626),console['error'](_0xa84eb7(0x103),_0x223dea),console['error'](_0xa84eb7(0x142),_0x2a1794[_0xa84eb7(0x14c)]),loggerService_1[_0xa84eb7(0x132)]['logWhiteDomainError']('rapyd',_0xa84eb7(0x100),'Business\x20Error\x20('+_0x167626+_0xa84eb7(0x167)+_0x223dea);throw new Error('Rapyd\x20API\x20error\x20('+_0x167626+_0xa84eb7(0x167)+_0x223dea);}if(!_0x2a1794[_0xa84eb7(0x10a)]?.['id']||!_0x2a1794[_0xa84eb7(0x10a)]?.['redirect_url']){console[_0xa84eb7(0x13e)](_0xa84eb7(0x150)),console[_0xa84eb7(0x13e)](_0xa84eb7(0x154)),console[_0xa84eb7(0x13e)](_0xa84eb7(0x159),_0x2a1794[_0xa84eb7(0x10a)]),loggerService_1['loggerService']['logWhiteDomainError'](_0xa84eb7(0x12b),_0xa84eb7(0x100),_0xa84eb7(0x140));throw new Error(_0xa84eb7(0x115));}return console['log'](_0xa84eb7(0x141)),console['log'](_0xa84eb7(0x12d),_0x2a1794['data']['id']),console['log'](_0xa84eb7(0x122),_0x2a1794['data']['redirect_url']),console[_0xa84eb7(0x14d)](_0xa84eb7(0x126)+_0x193d70+_0xa84eb7(0x102)),console[_0xa84eb7(0x14d)]('💳\x20Payment\x20Methods:\x20gb_visa_card,\x20gb_mastercard_card'),{'gateway_payment_id':_0x2a1794['data']['id'],'payment_url':_0x2a1794[_0xa84eb7(0x10a)][_0xa84eb7(0x13f)]};}catch(_0x5423a4){console[_0xa84eb7(0x13e)](_0xa84eb7(0x16e)),console['error']('Error\x20details:',_0x5423a4),loggerService_1[_0xa84eb7(0x132)][_0xa84eb7(0x11b)](_0xa84eb7(0x12b),'/v1/hosted/payment_links',_0x5423a4);if(_0x5423a4 instanceof Error){console[_0xa84eb7(0x13e)](_0xa84eb7(0x133),_0x5423a4[_0xa84eb7(0x148)]),console['error'](_0xa84eb7(0x10e),_0x5423a4[_0xa84eb7(0x13c)]);throw new Error(_0xa84eb7(0x124)+_0x5423a4[_0xa84eb7(0x148)]);}throw new Error('Failed\x20to\x20create\x20Rapyd\x20payment\x20link:\x20Unknown\x20error');}}async[a56_0x3814a3(0x127)](_0x22c8bc){const _0x36157d=a56_0x3814a3,_0x47a532=Date[_0x36157d(0xf8)]();try{loggerService_1[_0x36157d(0x132)][_0x36157d(0x14f)](_0x36157d(0x12b),_0x36157d(0x138)+_0x22c8bc,_0x36157d(0x13a),{});const _0xb986d6=await fetch(this[_0x36157d(0x11f)]+'/'+_0x22c8bc,{'method':_0x36157d(0x13a),'headers':{'Content-Type':_0x36157d(0x10f),'User-Agent':_0x36157d(0x170)}}),_0x90b2ba=Date['now']()-_0x47a532;if(!_0xb986d6['ok']){const _0x2ad460=await _0xb986d6[_0x36157d(0xfd)]();loggerService_1[_0x36157d(0x132)][_0x36157d(0xf7)]('rapyd','/v1/hosted/payment_links/'+_0x22c8bc,_0xb986d6['status'],_0x2ad460,_0x90b2ba);throw new Error(_0x36157d(0x162)+_0xb986d6[_0x36157d(0x14c)]);}const _0x348d59=await _0xb986d6[_0x36157d(0x10d)]();loggerService_1[_0x36157d(0x132)][_0x36157d(0xf7)](_0x36157d(0x12b),'/v1/hosted/payment_links/'+_0x22c8bc,_0xb986d6[_0x36157d(0x14c)],_0x348d59,_0x90b2ba);if(_0x348d59['status']?.[_0x36157d(0x14c)]!=='SUCCESS'){loggerService_1['loggerService']['logWhiteDomainError'](_0x36157d(0x12b),'/v1/hosted/payment_links/'+_0x22c8bc,'Rapyd\x20API\x20error:\x20'+(_0x348d59[_0x36157d(0x14c)]?.[_0x36157d(0x148)]||'Unknown\x20error'));throw new Error(_0x36157d(0xfe)+(_0x348d59['status']?.[_0x36157d(0x148)]||_0x36157d(0x113)));}let _0x111a4d='PENDING';if(_0x348d59[_0x36157d(0x10a)]?.[_0x36157d(0x14c)])switch(_0x348d59[_0x36157d(0x10a)]['status'][_0x36157d(0x118)]()){case _0x36157d(0xf4):_0x111a4d=_0x36157d(0x125);break;case _0x36157d(0x161):_0x111a4d=_0x36157d(0x136);break;case'EXP':_0x111a4d=_0x36157d(0x128);break;case'ERR':_0x111a4d=_0x36157d(0x136);break;case _0x36157d(0x172):case _0x36157d(0xfb):default:_0x111a4d=_0x36157d(0x166);break;}return{'status':_0x111a4d,'amount':_0x348d59[_0x36157d(0x10a)]?.['amount'],'currency':_0x348d59['data']?.[_0x36157d(0xf5)]};}catch(_0x4e8f04){console[_0x36157d(0x13e)](_0x36157d(0x111),_0x4e8f04),loggerService_1[_0x36157d(0x132)][_0x36157d(0x11b)]('rapyd',_0x36157d(0x138)+_0x22c8bc,_0x4e8f04);throw new Error(_0x36157d(0x119)+(_0x4e8f04 instanceof Error?_0x4e8f04[_0x36157d(0x148)]:_0x36157d(0x113)));}}async[a56_0x3814a3(0x10b)](_0x325092){const _0x1b19d5=a56_0x3814a3;console[_0x1b19d5(0x14d)](_0x1b19d5(0x157),_0x325092);let _0x52f085=_0x1b19d5(0x166),_0x1d46fa;_0x325092['data']?.[_0x1b19d5(0x169)]&&(_0x1d46fa=_0x325092[_0x1b19d5(0x10a)][_0x1b19d5(0x169)],console['log'](_0x1b19d5(0x10c)+_0x1d46fa));switch(_0x325092[_0x1b19d5(0x14a)]?.[_0x1b19d5(0x118)]()){case'PAYMENT_COMPLETED':_0x325092[_0x1b19d5(0x10a)]?.[_0x1b19d5(0x165)]===!![]&&_0x325092['data']?.[_0x1b19d5(0x14c)]==='CLO'?_0x52f085=_0x1b19d5(0x125):_0x52f085=_0x1b19d5(0x166);break;case _0x1b19d5(0x16c):_0x52f085=_0x1b19d5(0x136);break;case _0x1b19d5(0x120):_0x52f085='EXPIRED';break;case _0x1b19d5(0x11d):_0x52f085=_0x1b19d5(0x136);!_0x1d46fa&&_0x325092[_0x1b19d5(0x10a)]?.[_0x1b19d5(0x169)]&&(_0x1d46fa=_0x325092[_0x1b19d5(0x10a)][_0x1b19d5(0x169)]);break;default:switch(_0x325092[_0x1b19d5(0x10a)]?.[_0x1b19d5(0x14c)]?.[_0x1b19d5(0x118)]()){case _0x1b19d5(0xf4):_0x325092[_0x1b19d5(0x10a)]?.[_0x1b19d5(0x165)]===!![]?_0x52f085=_0x1b19d5(0x125):_0x52f085=_0x1b19d5(0x136);break;case'CAN':_0x52f085=_0x1b19d5(0x136);break;case _0x1b19d5(0x101):_0x52f085=_0x1b19d5(0x128);break;case _0x1b19d5(0x168):_0x52f085=_0x1b19d5(0x136);!_0x1d46fa&&_0x325092[_0x1b19d5(0x10a)]?.[_0x1b19d5(0x169)]&&(_0x1d46fa=_0x325092['data'][_0x1b19d5(0x169)]);break;case _0x1b19d5(0x172):case _0x1b19d5(0xfb):default:_0x52f085=_0x1b19d5(0x166);break;}break;}const _0x419e64={};return _0x325092['data']?.[_0x1b19d5(0x105)]?.[_0x1b19d5(0x171)]&&(_0x419e64[_0x1b19d5(0x12c)]=_0x325092[_0x1b19d5(0x10a)]['payment_method_data'][_0x1b19d5(0x171)]),_0x325092[_0x1b19d5(0x10a)]?.[_0x1b19d5(0xf9)]&&(_0x419e64['paymentMethod']=_0x325092[_0x1b19d5(0x10a)][_0x1b19d5(0xf9)]),_0x325092[_0x1b19d5(0x10a)]?.[_0x1b19d5(0x15b)]&&(_0x419e64['errorCode']=_0x325092['data'][_0x1b19d5(0x15b)]),_0x325092[_0x1b19d5(0x10a)]?.[_0x1b19d5(0x156)]&&(_0x419e64[_0x1b19d5(0x121)]=_0x325092[_0x1b19d5(0x10a)][_0x1b19d5(0x156)]),console[_0x1b19d5(0x14d)](_0x1b19d5(0x129)+_0x52f085+_0x1b19d5(0x164)+(_0x1d46fa||_0x1b19d5(0x144))),{'paymentId':_0x325092[_0x1b19d5(0x10a)]?.[_0x1b19d5(0x112)]||'','status':_0x52f085,'amount':_0x325092[_0x1b19d5(0x10a)]?.['amount'],'currency':_0x325092[_0x1b19d5(0x10a)]?.[_0x1b19d5(0xf5)],'failureMessage':_0x1d46fa,'additionalInfo':_0x419e64};}}exports['RapydService']=RapydService;