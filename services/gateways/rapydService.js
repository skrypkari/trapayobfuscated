'use strict';const a45_0x1f5d5d=a45_0x392f;(function(_0xea1101,_0x5aba74){const _0x50c61d=a45_0x392f,_0x556f49=_0xea1101();while(!![]){try{const _0x23f9d3=parseInt(_0x50c61d(0xb4))/0x1+-parseInt(_0x50c61d(0xd1))/0x2+-parseInt(_0x50c61d(0xd9))/0x3*(-parseInt(_0x50c61d(0xa2))/0x4)+-parseInt(_0x50c61d(0xdd))/0x5*(parseInt(_0x50c61d(0x112))/0x6)+-parseInt(_0x50c61d(0xd3))/0x7*(parseInt(_0x50c61d(0xcb))/0x8)+parseInt(_0x50c61d(0xf3))/0x9*(parseInt(_0x50c61d(0xa6))/0xa)+parseInt(_0x50c61d(0x101))/0xb;if(_0x23f9d3===_0x5aba74)break;else _0x556f49['push'](_0x556f49['shift']());}catch(_0xc05bea){_0x556f49['push'](_0x556f49['shift']());}}}(a45_0xa847,0x61074));function a45_0xa847(){const _0x562a2f=['fromEntries','Unknown\x20error\x20from\x20Rapyd\x20API','message','Invalid\x20JSON\x20response\x20from\x20Rapyd\x20API:\x20','30yZcXUo','parse','payment_method_type','headers','üá¨üáß\x20Country:\x20','Error\x20Code:','Raw\x20Response\x20Body:','Error\x20Message:','Response\x20Body:','160148jCMhvP','Processing\x20Rapyd\x20webhook:','):\x20',',\x20failureMessage=','644330Gdyehq','/v1/hosted/payment_links','failure_code','EXP','https://tesoft.uk/gateway/success.php?id=','RapydService','HTTP\x20','now','text','Incomplete\x20response:\x20missing\x20id\x20or\x20redirect_url','__esModule','statusText','URL:','üí≥\x20Payment\x20Methods:\x20gb_visa_card,\x20gb_mastercard_card','450261sPQCLz','entries','currency','createPaymentLink','JSON\x20Parse\x20Error:\x20','Status:','logWhiteDomainRequest','Error\x20message:','gb_visa_card','CLO','stack','application/json','Rapyd\x20API\x20error:\x20','===\x20RAPYD\x20API\x20INCOMPLETE\x20RESPONSE\x20===','logWhiteDomainError','Response\x20Time:','üí•\x20Rapyd\x20failure\x20message:\x20','gb_mastercard_card','TesSoft\x20Payment\x20System/1.0','FAILED','toUpperCase','PAYMENT_COMPLETED',',\x20body:\x20','2600SHrIeK','Status\x20Text:','HTTP\x20error!\x20status:\x20','Response\x20data:','HTTP\x20Status:','failure_message','1263684AtvbBF','Rapyd\x20payment\x20verification\x20error:','9667LbrjAX','Payment\x20Link\x20ID:','Rapyd\x20API\x20error\x20(','Redirect\x20URL:','paid','https://tesoft.uk/gateway/fail.php?id=','9hXhAfB','PAYMENT_EXPIRED','Request\x20Body\x20(Updated\x20Format):','UNKNOWN','232250dOIcdh','Missing\x20id\x20or\x20redirect_url\x20in\x20response','amount','Headers:','defineProperty','data','error','redirect_url','ACT','stringify','log','\x20(GB\x20-\x20Britain)','none','merchant_reference_id','CAN','PAID','ERR','payment_method_data','logWhiteDomainResponse','../loggerService','NEW','Failed\x20to\x20create\x20Rapyd\x20payment\x20link:\x20','108szgpxw','POST','/v1/hosted/payment_links/','json','apiUrl','Invalid\x20response\x20from\x20Rapyd\x20API:\x20missing\x20id\x20or\x20redirect_url','===\x20RAPYD\x20API\x20RESPONSE\x20(White\x20Domain)\x20===','Error\x20stack:','Failed\x20to\x20parse\x20JSON\x20response:','\x20(always\x20GB\x20for\x20Rapyd)','loggerService','GET','errorCode','error_code','4034547pZLEAE','üá¨üáß\x20Using\x20GB\x20(Britain)\x20as\x20country\x20for\x20Rapyd\x20payment\x20link','Failed\x20to\x20verify\x20Rapyd\x20payment:\x20','PAYMENT_CANCELED','status','Error\x20details:','Failed\x20to\x20create\x20Rapyd\x20payment\x20link:\x20Unknown\x20error','verifyPayment','===\x20RAPYD\x20SUCCESS\x20===','rapyd','PENDING','üá¨üáß\x20Country\x20used:\x20','Unknown\x20error'];a45_0xa847=function(){return _0x562a2f;};return a45_0xa847();}Object[a45_0x1f5d5d(0xe1)](exports,a45_0x1f5d5d(0xb0),{'value':!![]}),exports[a45_0x1f5d5d(0xab)]=void 0x0;const loggerService_1=require(a45_0x1f5d5d(0xf0));function a45_0x392f(_0x455e59,_0x333f78){const _0xa84718=a45_0xa847();return a45_0x392f=function(_0x392f32,_0x445a0e){_0x392f32=_0x392f32-0x9c;let _0x5e9094=_0xa84718[_0x392f32];return _0x5e9094;},a45_0x392f(_0x455e59,_0x333f78);}class RapydService{constructor(){const _0x4885ed=a45_0x1f5d5d;this[_0x4885ed(0xf7)]='https://tesoft.uk/gateway/rapyd/',console[_0x4885ed(0xe7)]('üåê\x20Rapyd\x20service\x20initialized\x20with\x20white\x20domain\x20proxy');}async[a45_0x1f5d5d(0xb7)](_0x21f0b9){const _0x3e3aa9=a45_0x1f5d5d,{orderId:_0x19a220,orderName:_0x46982c,amount:_0x242384,currency:_0x478036,usage:_0x1004bb,maxPayments:_0x4828e0,successUrl:_0x3d5195,failUrl:_0x572824}=_0x21f0b9,_0x32fbef=_0x478036['toUpperCase'](),_0x3ce264='GB';console['log'](_0x3e3aa9(0x102));const _0x5cb252=_0x3e3aa9(0xaa)+_0x19a220,_0x5454d9=_0x3e3aa9(0xd8)+_0x19a220,_0x307621={'amount':_0x242384,'currency':_0x32fbef,'cancel_checkout_url':_0x5454d9,'complete_checkout_url':_0x5cb252,'complete_payment_url':_0x5cb252,'merchant_reference_id':_0x19a220,'description':'ORDER:\x20'+_0x19a220,'country':'GB','payment_method_types_include':[_0x3e3aa9(0xbc),_0x3e3aa9(0xc5)],'custom_elements':{'display_description':!![]}},_0x3334da=Date[_0x3e3aa9(0xad)]();try{console[_0x3e3aa9(0xe7)]('===\x20RAPYD\x20API\x20REQUEST\x20(White\x20Domain\x20-\x20Updated\x20Format)\x20==='),console[_0x3e3aa9(0xe7)](_0x3e3aa9(0xb2),this[_0x3e3aa9(0xf7)]),console[_0x3e3aa9(0xe7)](_0x3e3aa9(0xdb),JSON[_0x3e3aa9(0xe6)](_0x307621,null,0x2)),console[_0x3e3aa9(0xe7)](_0x3e3aa9(0x9d)+_0x3ce264+_0x3e3aa9(0xfc)),console['log'](_0x3e3aa9(0xb3)),loggerService_1[_0x3e3aa9(0xfd)]['logWhiteDomainRequest']('rapyd',_0x3e3aa9(0xa7),_0x3e3aa9(0xf4),_0x307621);const _0xa64319=await fetch(this[_0x3e3aa9(0xf7)],{'method':_0x3e3aa9(0xf4),'headers':{'Content-Type':'application/json','User-Agent':_0x3e3aa9(0xc6)},'body':JSON[_0x3e3aa9(0xe6)](_0x307621)}),_0x4ebaa7=Date[_0x3e3aa9(0xad)]()-_0x3334da;console[_0x3e3aa9(0xe7)](_0x3e3aa9(0xf9)),console[_0x3e3aa9(0xe7)](_0x3e3aa9(0xb9),_0xa64319[_0x3e3aa9(0x105)]),console[_0x3e3aa9(0xe7)](_0x3e3aa9(0xcc),_0xa64319[_0x3e3aa9(0xb1)]),console[_0x3e3aa9(0xe7)](_0x3e3aa9(0xe0),Object[_0x3e3aa9(0x10e)](_0xa64319[_0x3e3aa9(0x9c)][_0x3e3aa9(0xb5)]())),console[_0x3e3aa9(0xe7)](_0x3e3aa9(0xc3),_0x4ebaa7+'ms');const _0x10d97f=await _0xa64319['text']();console[_0x3e3aa9(0xe7)](_0x3e3aa9(0x9f),_0x10d97f);if(!_0xa64319['ok']){console[_0x3e3aa9(0xe3)]('===\x20RAPYD\x20API\x20ERROR\x20==='),console['error'](_0x3e3aa9(0xcf),_0xa64319[_0x3e3aa9(0x105)]),console[_0x3e3aa9(0xe3)](_0x3e3aa9(0xa1),_0x10d97f),loggerService_1['loggerService'][_0x3e3aa9(0xef)](_0x3e3aa9(0x10a),_0x3e3aa9(0xa7),_0xa64319[_0x3e3aa9(0x105)],_0x10d97f,_0x4ebaa7),loggerService_1[_0x3e3aa9(0xfd)][_0x3e3aa9(0xc2)](_0x3e3aa9(0x10a),_0x3e3aa9(0xa7),_0x3e3aa9(0xac)+_0xa64319[_0x3e3aa9(0x105)]+':\x20'+_0x10d97f);throw new Error(_0x3e3aa9(0xcd)+_0xa64319[_0x3e3aa9(0x105)]+_0x3e3aa9(0xca)+_0x10d97f);}let _0x2c7df9;try{_0x2c7df9=JSON[_0x3e3aa9(0x113)](_0x10d97f);}catch(_0x47e354){console[_0x3e3aa9(0xe3)](_0x3e3aa9(0xfb),_0x47e354),loggerService_1['loggerService'][_0x3e3aa9(0xc2)]('rapyd',_0x3e3aa9(0xa7),_0x3e3aa9(0xb8)+_0x47e354);throw new Error(_0x3e3aa9(0x111)+_0x10d97f);}console[_0x3e3aa9(0xe7)]('===\x20PARSED\x20RAPYD\x20RESPONSE\x20==='),console[_0x3e3aa9(0xe7)]('Parsed\x20Result:',JSON[_0x3e3aa9(0xe6)](_0x2c7df9,null,0x2)),loggerService_1[_0x3e3aa9(0xfd)][_0x3e3aa9(0xef)]('rapyd',_0x3e3aa9(0xa7),_0xa64319[_0x3e3aa9(0x105)],_0x2c7df9,_0x4ebaa7);if(_0x2c7df9[_0x3e3aa9(0x105)]?.[_0x3e3aa9(0x105)]!=='SUCCESS'){const _0x70d1d8=_0x2c7df9[_0x3e3aa9(0x105)]?.['message']||_0x3e3aa9(0x10f),_0x4dae2a=_0x2c7df9['status']?.[_0x3e3aa9(0x100)]||_0x3e3aa9(0xdc);console[_0x3e3aa9(0xe3)]('===\x20RAPYD\x20API\x20BUSINESS\x20ERROR\x20==='),console[_0x3e3aa9(0xe3)](_0x3e3aa9(0x9e),_0x4dae2a),console[_0x3e3aa9(0xe3)](_0x3e3aa9(0xa0),_0x70d1d8),console[_0x3e3aa9(0xe3)]('Full\x20Error\x20Data:',_0x2c7df9[_0x3e3aa9(0x105)]),loggerService_1['loggerService'][_0x3e3aa9(0xc2)](_0x3e3aa9(0x10a),_0x3e3aa9(0xa7),'Business\x20Error\x20('+_0x4dae2a+_0x3e3aa9(0xa4)+_0x70d1d8);throw new Error(_0x3e3aa9(0xd5)+_0x4dae2a+_0x3e3aa9(0xa4)+_0x70d1d8);}if(!_0x2c7df9[_0x3e3aa9(0xe2)]?.['id']||!_0x2c7df9[_0x3e3aa9(0xe2)]?.[_0x3e3aa9(0xe4)]){console[_0x3e3aa9(0xe3)](_0x3e3aa9(0xc1)),console['error'](_0x3e3aa9(0xde)),console['error'](_0x3e3aa9(0xce),_0x2c7df9[_0x3e3aa9(0xe2)]),loggerService_1['loggerService'][_0x3e3aa9(0xc2)](_0x3e3aa9(0x10a),_0x3e3aa9(0xa7),_0x3e3aa9(0xaf));throw new Error(_0x3e3aa9(0xf8));}return console['log'](_0x3e3aa9(0x109)),console[_0x3e3aa9(0xe7)](_0x3e3aa9(0xd4),_0x2c7df9[_0x3e3aa9(0xe2)]['id']),console[_0x3e3aa9(0xe7)](_0x3e3aa9(0xd6),_0x2c7df9[_0x3e3aa9(0xe2)][_0x3e3aa9(0xe4)]),console[_0x3e3aa9(0xe7)](_0x3e3aa9(0x10c)+_0x3ce264+_0x3e3aa9(0xe8)),console[_0x3e3aa9(0xe7)](_0x3e3aa9(0xb3)),{'gateway_payment_id':_0x2c7df9['data']['id'],'payment_url':_0x2c7df9[_0x3e3aa9(0xe2)][_0x3e3aa9(0xe4)]};}catch(_0x2f2ddd){console['error']('===\x20RAPYD\x20SERVICE\x20ERROR\x20==='),console[_0x3e3aa9(0xe3)](_0x3e3aa9(0x106),_0x2f2ddd),loggerService_1[_0x3e3aa9(0xfd)]['logWhiteDomainError'](_0x3e3aa9(0x10a),'/v1/hosted/payment_links',_0x2f2ddd);if(_0x2f2ddd instanceof Error){console[_0x3e3aa9(0xe3)](_0x3e3aa9(0xbb),_0x2f2ddd['message']),console[_0x3e3aa9(0xe3)](_0x3e3aa9(0xfa),_0x2f2ddd[_0x3e3aa9(0xbe)]);throw new Error(_0x3e3aa9(0xf2)+_0x2f2ddd[_0x3e3aa9(0x110)]);}throw new Error(_0x3e3aa9(0x107));}}async[a45_0x1f5d5d(0x108)](_0x423a9c){const _0x462d5b=a45_0x1f5d5d,_0x3f7ea2=Date[_0x462d5b(0xad)]();try{loggerService_1[_0x462d5b(0xfd)][_0x462d5b(0xba)](_0x462d5b(0x10a),_0x462d5b(0xf5)+_0x423a9c,_0x462d5b(0xfe),{});const _0x389ded=await fetch(this[_0x462d5b(0xf7)]+'/'+_0x423a9c,{'method':'GET','headers':{'Content-Type':_0x462d5b(0xbf),'User-Agent':_0x462d5b(0xc6)}}),_0x29696c=Date[_0x462d5b(0xad)]()-_0x3f7ea2;if(!_0x389ded['ok']){const _0x2e9ac1=await _0x389ded[_0x462d5b(0xae)]();loggerService_1['loggerService'][_0x462d5b(0xef)]('rapyd','/v1/hosted/payment_links/'+_0x423a9c,_0x389ded[_0x462d5b(0x105)],_0x2e9ac1,_0x29696c);throw new Error(_0x462d5b(0xcd)+_0x389ded[_0x462d5b(0x105)]);}const _0x549d19=await _0x389ded[_0x462d5b(0xf6)]();loggerService_1[_0x462d5b(0xfd)][_0x462d5b(0xef)](_0x462d5b(0x10a),'/v1/hosted/payment_links/'+_0x423a9c,_0x389ded[_0x462d5b(0x105)],_0x549d19,_0x29696c);if(_0x549d19['status']?.[_0x462d5b(0x105)]!=='SUCCESS'){loggerService_1[_0x462d5b(0xfd)]['logWhiteDomainError'](_0x462d5b(0x10a),_0x462d5b(0xf5)+_0x423a9c,_0x462d5b(0xc0)+(_0x549d19[_0x462d5b(0x105)]?.['message']||_0x462d5b(0x10d)));throw new Error(_0x462d5b(0xc0)+(_0x549d19['status']?.[_0x462d5b(0x110)]||_0x462d5b(0x10d)));}let _0x2d7a88=_0x462d5b(0x10b);if(_0x549d19[_0x462d5b(0xe2)]?.[_0x462d5b(0x105)])switch(_0x549d19[_0x462d5b(0xe2)][_0x462d5b(0x105)][_0x462d5b(0xc8)]()){case _0x462d5b(0xbd):_0x2d7a88=_0x462d5b(0xec);break;case _0x462d5b(0xeb):_0x2d7a88=_0x462d5b(0xc7);break;case _0x462d5b(0xa9):_0x2d7a88='EXPIRED';break;case _0x462d5b(0xed):_0x2d7a88=_0x462d5b(0xc7);break;case'NEW':case'ACT':default:_0x2d7a88='PENDING';break;}return{'status':_0x2d7a88,'amount':_0x549d19['data']?.[_0x462d5b(0xdf)],'currency':_0x549d19['data']?.[_0x462d5b(0xb6)]};}catch(_0x44a93b){console[_0x462d5b(0xe3)](_0x462d5b(0xd2),_0x44a93b),loggerService_1['loggerService']['logWhiteDomainError']('rapyd',_0x462d5b(0xf5)+_0x423a9c,_0x44a93b);throw new Error(_0x462d5b(0x103)+(_0x44a93b instanceof Error?_0x44a93b[_0x462d5b(0x110)]:'Unknown\x20error'));}}async['processWebhook'](_0x1377db){const _0x5b93d9=a45_0x1f5d5d;console['log'](_0x5b93d9(0xa3),_0x1377db);let _0x5ec724='PENDING',_0x3862cd;_0x1377db['data']?.[_0x5b93d9(0xd0)]&&(_0x3862cd=_0x1377db[_0x5b93d9(0xe2)][_0x5b93d9(0xd0)],console[_0x5b93d9(0xe7)](_0x5b93d9(0xc4)+_0x3862cd));switch(_0x1377db['type']?.[_0x5b93d9(0xc8)]()){case _0x5b93d9(0xc9):_0x1377db[_0x5b93d9(0xe2)]?.[_0x5b93d9(0xd7)]===!![]&&_0x1377db[_0x5b93d9(0xe2)]?.[_0x5b93d9(0x105)]==='CLO'?_0x5ec724=_0x5b93d9(0xec):_0x5ec724=_0x5b93d9(0x10b);break;case _0x5b93d9(0x104):_0x5ec724='FAILED';break;case _0x5b93d9(0xda):_0x5ec724='EXPIRED';break;case'PAYMENT_FAILED':_0x5ec724=_0x5b93d9(0xc7);!_0x3862cd&&_0x1377db[_0x5b93d9(0xe2)]?.['failure_message']&&(_0x3862cd=_0x1377db[_0x5b93d9(0xe2)][_0x5b93d9(0xd0)]);break;default:switch(_0x1377db[_0x5b93d9(0xe2)]?.[_0x5b93d9(0x105)]?.['toUpperCase']()){case'CLO':_0x1377db[_0x5b93d9(0xe2)]?.[_0x5b93d9(0xd7)]===!![]?_0x5ec724='PAID':_0x5ec724=_0x5b93d9(0xc7);break;case'CAN':_0x5ec724=_0x5b93d9(0xc7);break;case _0x5b93d9(0xa9):_0x5ec724='EXPIRED';break;case'ERR':_0x5ec724=_0x5b93d9(0xc7);!_0x3862cd&&_0x1377db[_0x5b93d9(0xe2)]?.[_0x5b93d9(0xd0)]&&(_0x3862cd=_0x1377db[_0x5b93d9(0xe2)][_0x5b93d9(0xd0)]);break;case _0x5b93d9(0xf1):case _0x5b93d9(0xe5):default:_0x5ec724=_0x5b93d9(0x10b);break;}break;}const _0x1fa6e7={};return _0x1377db['data']?.[_0x5b93d9(0xee)]?.['last4']&&(_0x1fa6e7['cardLast4']=_0x1377db['data'][_0x5b93d9(0xee)]['last4']),_0x1377db[_0x5b93d9(0xe2)]?.[_0x5b93d9(0x114)]&&(_0x1fa6e7['paymentMethod']=_0x1377db[_0x5b93d9(0xe2)]['payment_method_type']),_0x1377db['data']?.[_0x5b93d9(0x100)]&&(_0x1fa6e7[_0x5b93d9(0xff)]=_0x1377db[_0x5b93d9(0xe2)][_0x5b93d9(0x100)]),_0x1377db[_0x5b93d9(0xe2)]?.[_0x5b93d9(0xa8)]&&(_0x1fa6e7['failureCode']=_0x1377db[_0x5b93d9(0xe2)][_0x5b93d9(0xa8)]),console[_0x5b93d9(0xe7)]('üîÑ\x20Rapyd\x20webhook\x20processed:\x20status='+_0x5ec724+_0x5b93d9(0xa5)+(_0x3862cd||_0x5b93d9(0xe9))),{'paymentId':_0x1377db[_0x5b93d9(0xe2)]?.[_0x5b93d9(0xea)]||'','status':_0x5ec724,'amount':_0x1377db[_0x5b93d9(0xe2)]?.[_0x5b93d9(0xdf)],'currency':_0x1377db[_0x5b93d9(0xe2)]?.[_0x5b93d9(0xb6)],'failureMessage':_0x3862cd,'additionalInfo':_0x1fa6e7};}}exports[a45_0x1f5d5d(0xab)]=RapydService;