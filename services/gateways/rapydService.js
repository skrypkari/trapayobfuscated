'use strict';const a46_0x5d95e1=a46_0x3ca4;(function(_0x3fa101,_0x30ed22){const _0x370195=a46_0x3ca4,_0x116789=_0x3fa101();while(!![]){try{const _0x4ec72c=parseInt(_0x370195(0xec))/0x1+parseInt(_0x370195(0x124))/0x2*(parseInt(_0x370195(0xd1))/0x3)+parseInt(_0x370195(0xe9))/0x4+-parseInt(_0x370195(0xc9))/0x5+parseInt(_0x370195(0xf1))/0x6*(-parseInt(_0x370195(0x10b))/0x7)+parseInt(_0x370195(0x127))/0x8+parseInt(_0x370195(0xe1))/0x9*(-parseInt(_0x370195(0x100))/0xa);if(_0x4ec72c===_0x30ed22)break;else _0x116789['push'](_0x116789['shift']());}catch(_0x5f4d11){_0x116789['push'](_0x116789['shift']());}}}(a46_0x59c6,0x96785));Object[a46_0x5d95e1(0xb8)](exports,a46_0x5d95e1(0xdd),{'value':!![]}),exports[a46_0x5d95e1(0xf8)]=void 0x0;function a46_0x59c6(){const _0x264531=['CLO',',\x20body:\x20','ACT','üí•\x20Rapyd\x20failure\x20message:\x20','Failed\x20to\x20parse\x20JSON\x20response:','statusText','stack','Rapyd\x20API\x20error:\x20','PAID','Incomplete\x20response:\x20missing\x20id\x20or\x20redirect_url','data','amount','failureCode','text','Error\x20message:','===\x20RAPYD\x20API\x20INCOMPLETE\x20RESPONSE\x20===','stringify','apiUrl','errorCode','gb_mastercard_card','781474pxGkqQ','HTTP\x20error!\x20status:\x20','https://tesoft.uk/gateway/success.php?id=','8241448JIyZjI','üá¨üáß\x20Country:\x20','application/json','paymentMethod','/v1/hosted/payment_links/','URL:','Response\x20Body:','PENDING','===\x20RAPYD\x20API\x20BUSINESS\x20ERROR\x20===','UNKNOWN','logWhiteDomainResponse',',\x20failureMessage=','===\x20RAPYD\x20API\x20REQUEST\x20(White\x20Domain\x20-\x20Updated\x20Format)\x20===','defineProperty','Parsed\x20Result:','EXPIRED','merchant_reference_id','ERR','üîÑ\x20Rapyd\x20webhook\x20processed:\x20status=','payment_method_data','FAILED','Failed\x20to\x20create\x20Rapyd\x20payment\x20link:\x20Unknown\x20error','POST','now','failure_message','error','failure_code','paid','../loggerService','===\x20RAPYD\x20API\x20RESPONSE\x20(White\x20Domain)\x20===','3520290tpTqjd','Request\x20Body\x20(Updated\x20Format):','cardLast4','Unknown\x20error\x20from\x20Rapyd\x20API','CAN','Unknown\x20error','Processing\x20Rapyd\x20webhook:','logWhiteDomainError','6MIVgLA','ORDER:\x20','Invalid\x20JSON\x20response\x20from\x20Rapyd\x20API:\x20','Headers:','error_code','üåê\x20Rapyd\x20service\x20initialized\x20with\x20white\x20domain\x20proxy','Full\x20Error\x20Data:','Raw\x20Response\x20Body:','Response\x20Time:','HTTP\x20','processWebhook','/v1/hosted/payment_links','__esModule','Error\x20Message:','SUCCESS','Failed\x20to\x20create\x20Rapyd\x20payment\x20link:\x20','9ytoLOY','status','===\x20RAPYD\x20SUCCESS\x20===','Business\x20Error\x20(','Status\x20Text:','logWhiteDomainRequest','Response\x20data:','PAYMENT_FAILED','375852hksTiO','gb_visa_card','GET','900085RZnCTy','https://tesoft.uk/gateway/rapyd/','PAYMENT_CANCELED','payment_method_type','Payment\x20Link\x20ID:','6SWpyPA','message','===\x20PARSED\x20RAPYD\x20RESPONSE\x20===','NEW','none','üá¨üáß\x20Country\x20used:\x20','üá¨üáß\x20Using\x20GB\x20(Britain)\x20as\x20country\x20for\x20Rapyd\x20payment\x20link','RapydService','\x20(always\x20GB\x20for\x20Rapyd)','Failed\x20to\x20verify\x20Rapyd\x20payment:\x20','log','loggerService','redirect_url','headers','HTTP\x20Status:','3482590UvYAQK','parse','Rapyd\x20API\x20error\x20(','===\x20RAPYD\x20SERVICE\x20ERROR\x20===','EXP','Error\x20Code:','rapyd','Invalid\x20response\x20from\x20Rapyd\x20API:\x20missing\x20id\x20or\x20redirect_url','PAYMENT_COMPLETED','TesSoft\x20Payment\x20System/1.0','üí≥\x20Payment\x20Methods:\x20gb_visa_card,\x20gb_mastercard_card','7959427dZPTAE','toUpperCase','):\x20','Error\x20stack:','Redirect\x20URL:'];a46_0x59c6=function(){return _0x264531;};return a46_0x59c6();}function a46_0x3ca4(_0x3c6a3b,_0x169f43){const _0x59c68a=a46_0x59c6();return a46_0x3ca4=function(_0x3ca41f,_0x5800b4){_0x3ca41f=_0x3ca41f-0xb0;let _0x28f715=_0x59c68a[_0x3ca41f];return _0x28f715;},a46_0x3ca4(_0x3c6a3b,_0x169f43);}const loggerService_1=require(a46_0x5d95e1(0xc7));class RapydService{constructor(){const _0x42d9fa=a46_0x5d95e1;this[_0x42d9fa(0x121)]=_0x42d9fa(0xed),console['log'](_0x42d9fa(0xd6));}async['createPaymentLink'](_0x5ece8d){const _0x5b4aad=a46_0x5d95e1,{orderId:_0x2818a1,orderName:_0x542ba9,amount:_0x356714,currency:_0x3111ca,usage:_0x543c28,maxPayments:_0x15a384,successUrl:_0x4223d4,failUrl:_0x2ed401}=_0x5ece8d,_0x128053=_0x3111ca['toUpperCase'](),_0x484b26='GB';console[_0x5b4aad(0xfb)](_0x5b4aad(0xf7));const _0x44c7f3=_0x5b4aad(0x126)+_0x2818a1,_0x54b8b4='https://tesoft.uk/gateway/fail.php?id='+_0x2818a1,_0x1c0a8e={'amount':_0x356714,'currency':_0x128053,'cancel_checkout_url':_0x54b8b4,'complete_checkout_url':_0x44c7f3,'complete_payment_url':_0x44c7f3,'merchant_reference_id':_0x2818a1,'description':_0x5b4aad(0xd2)+_0x2818a1,'country':'GB','payment_method_types_include':[_0x5b4aad(0xea),_0x5b4aad(0x123)],'custom_elements':{'display_description':!![]}},_0x152ea0=Date[_0x5b4aad(0xc2)]();try{console[_0x5b4aad(0xfb)](_0x5b4aad(0xb7)),console[_0x5b4aad(0xfb)](_0x5b4aad(0xb0),this[_0x5b4aad(0x121)]),console[_0x5b4aad(0xfb)](_0x5b4aad(0xca),JSON[_0x5b4aad(0x120)](_0x1c0a8e,null,0x2)),console[_0x5b4aad(0xfb)](_0x5b4aad(0x128)+_0x484b26+_0x5b4aad(0xf9)),console[_0x5b4aad(0xfb)]('üí≥\x20Payment\x20Methods:\x20gb_visa_card,\x20gb_mastercard_card'),loggerService_1[_0x5b4aad(0xfc)][_0x5b4aad(0xe6)](_0x5b4aad(0x106),_0x5b4aad(0xdc),_0x5b4aad(0xc1),_0x1c0a8e);const _0x3f3291=await fetch(this[_0x5b4aad(0x121)],{'method':'POST','headers':{'Content-Type':'application/json','User-Agent':_0x5b4aad(0x109)},'body':JSON[_0x5b4aad(0x120)](_0x1c0a8e)}),_0x3a35be=Date[_0x5b4aad(0xc2)]()-_0x152ea0;console[_0x5b4aad(0xfb)](_0x5b4aad(0xc8)),console[_0x5b4aad(0xfb)]('Status:',_0x3f3291['status']),console[_0x5b4aad(0xfb)](_0x5b4aad(0xe5),_0x3f3291[_0x5b4aad(0x115)]),console[_0x5b4aad(0xfb)](_0x5b4aad(0xd4),Object['fromEntries'](_0x3f3291[_0x5b4aad(0xfe)]['entries']())),console['log'](_0x5b4aad(0xd9),_0x3a35be+'ms');const _0xd62e6e=await _0x3f3291[_0x5b4aad(0x11d)]();console[_0x5b4aad(0xfb)](_0x5b4aad(0xd8),_0xd62e6e);if(!_0x3f3291['ok']){console[_0x5b4aad(0xc4)]('===\x20RAPYD\x20API\x20ERROR\x20==='),console['error'](_0x5b4aad(0xff),_0x3f3291[_0x5b4aad(0xe2)]),console[_0x5b4aad(0xc4)](_0x5b4aad(0xb1),_0xd62e6e),loggerService_1[_0x5b4aad(0xfc)][_0x5b4aad(0xb5)](_0x5b4aad(0x106),_0x5b4aad(0xdc),_0x3f3291[_0x5b4aad(0xe2)],_0xd62e6e,_0x3a35be),loggerService_1[_0x5b4aad(0xfc)][_0x5b4aad(0xd0)]('rapyd',_0x5b4aad(0xdc),_0x5b4aad(0xda)+_0x3f3291[_0x5b4aad(0xe2)]+':\x20'+_0xd62e6e);throw new Error('HTTP\x20error!\x20status:\x20'+_0x3f3291[_0x5b4aad(0xe2)]+_0x5b4aad(0x111)+_0xd62e6e);}let _0x6d79e3;try{_0x6d79e3=JSON[_0x5b4aad(0x101)](_0xd62e6e);}catch(_0x269ca3){console['error'](_0x5b4aad(0x114),_0x269ca3),loggerService_1[_0x5b4aad(0xfc)][_0x5b4aad(0xd0)]('rapyd',_0x5b4aad(0xdc),'JSON\x20Parse\x20Error:\x20'+_0x269ca3);throw new Error(_0x5b4aad(0xd3)+_0xd62e6e);}console['log'](_0x5b4aad(0xf3)),console['log'](_0x5b4aad(0xb9),JSON[_0x5b4aad(0x120)](_0x6d79e3,null,0x2)),loggerService_1['loggerService']['logWhiteDomainResponse']('rapyd',_0x5b4aad(0xdc),_0x3f3291[_0x5b4aad(0xe2)],_0x6d79e3,_0x3a35be);if(_0x6d79e3[_0x5b4aad(0xe2)]?.[_0x5b4aad(0xe2)]!==_0x5b4aad(0xdf)){const _0x162a9a=_0x6d79e3[_0x5b4aad(0xe2)]?.[_0x5b4aad(0xf2)]||_0x5b4aad(0xcc),_0x4202f0=_0x6d79e3[_0x5b4aad(0xe2)]?.[_0x5b4aad(0xd5)]||_0x5b4aad(0xb4);console['error'](_0x5b4aad(0xb3)),console['error'](_0x5b4aad(0x105),_0x4202f0),console[_0x5b4aad(0xc4)](_0x5b4aad(0xde),_0x162a9a),console[_0x5b4aad(0xc4)](_0x5b4aad(0xd7),_0x6d79e3[_0x5b4aad(0xe2)]),loggerService_1['loggerService'][_0x5b4aad(0xd0)](_0x5b4aad(0x106),_0x5b4aad(0xdc),_0x5b4aad(0xe4)+_0x4202f0+_0x5b4aad(0x10d)+_0x162a9a);throw new Error(_0x5b4aad(0x102)+_0x4202f0+_0x5b4aad(0x10d)+_0x162a9a);}if(!_0x6d79e3[_0x5b4aad(0x11a)]?.['id']||!_0x6d79e3[_0x5b4aad(0x11a)]?.[_0x5b4aad(0xfd)]){console['error'](_0x5b4aad(0x11f)),console[_0x5b4aad(0xc4)]('Missing\x20id\x20or\x20redirect_url\x20in\x20response'),console['error'](_0x5b4aad(0xe7),_0x6d79e3[_0x5b4aad(0x11a)]),loggerService_1[_0x5b4aad(0xfc)]['logWhiteDomainError'](_0x5b4aad(0x106),_0x5b4aad(0xdc),_0x5b4aad(0x119));throw new Error(_0x5b4aad(0x107));}return console['log'](_0x5b4aad(0xe3)),console[_0x5b4aad(0xfb)](_0x5b4aad(0xf0),_0x6d79e3[_0x5b4aad(0x11a)]['id']),console[_0x5b4aad(0xfb)](_0x5b4aad(0x10f),_0x6d79e3[_0x5b4aad(0x11a)][_0x5b4aad(0xfd)]),console[_0x5b4aad(0xfb)](_0x5b4aad(0xf6)+_0x484b26+'\x20(GB\x20-\x20Britain)'),console[_0x5b4aad(0xfb)](_0x5b4aad(0x10a)),{'gateway_payment_id':_0x6d79e3['data']['id'],'payment_url':_0x6d79e3[_0x5b4aad(0x11a)][_0x5b4aad(0xfd)]};}catch(_0x25cdb8){console[_0x5b4aad(0xc4)](_0x5b4aad(0x103)),console[_0x5b4aad(0xc4)]('Error\x20details:',_0x25cdb8),loggerService_1[_0x5b4aad(0xfc)]['logWhiteDomainError'](_0x5b4aad(0x106),'/v1/hosted/payment_links',_0x25cdb8);if(_0x25cdb8 instanceof Error){console[_0x5b4aad(0xc4)](_0x5b4aad(0x11e),_0x25cdb8[_0x5b4aad(0xf2)]),console[_0x5b4aad(0xc4)](_0x5b4aad(0x10e),_0x25cdb8[_0x5b4aad(0x116)]);throw new Error(_0x5b4aad(0xe0)+_0x25cdb8[_0x5b4aad(0xf2)]);}throw new Error(_0x5b4aad(0xc0));}}async['verifyPayment'](_0x1b987c){const _0x2c25d8=a46_0x5d95e1,_0x52764b=Date['now']();try{loggerService_1[_0x2c25d8(0xfc)][_0x2c25d8(0xe6)](_0x2c25d8(0x106),_0x2c25d8(0x12b)+_0x1b987c,_0x2c25d8(0xeb),{});const _0xca3514=await fetch(this[_0x2c25d8(0x121)]+'/'+_0x1b987c,{'method':_0x2c25d8(0xeb),'headers':{'Content-Type':_0x2c25d8(0x129),'User-Agent':_0x2c25d8(0x109)}}),_0x19dd9e=Date['now']()-_0x52764b;if(!_0xca3514['ok']){const _0x5ba2a0=await _0xca3514[_0x2c25d8(0x11d)]();loggerService_1[_0x2c25d8(0xfc)][_0x2c25d8(0xb5)]('rapyd','/v1/hosted/payment_links/'+_0x1b987c,_0xca3514['status'],_0x5ba2a0,_0x19dd9e);throw new Error(_0x2c25d8(0x125)+_0xca3514[_0x2c25d8(0xe2)]);}const _0x158a07=await _0xca3514['json']();loggerService_1[_0x2c25d8(0xfc)]['logWhiteDomainResponse'](_0x2c25d8(0x106),_0x2c25d8(0x12b)+_0x1b987c,_0xca3514[_0x2c25d8(0xe2)],_0x158a07,_0x19dd9e);if(_0x158a07[_0x2c25d8(0xe2)]?.[_0x2c25d8(0xe2)]!=='SUCCESS'){loggerService_1[_0x2c25d8(0xfc)][_0x2c25d8(0xd0)]('rapyd',_0x2c25d8(0x12b)+_0x1b987c,_0x2c25d8(0x117)+(_0x158a07['status']?.[_0x2c25d8(0xf2)]||_0x2c25d8(0xce)));throw new Error(_0x2c25d8(0x117)+(_0x158a07[_0x2c25d8(0xe2)]?.[_0x2c25d8(0xf2)]||_0x2c25d8(0xce)));}let _0x4d6f76='PENDING';if(_0x158a07['data']?.[_0x2c25d8(0xe2)])switch(_0x158a07[_0x2c25d8(0x11a)][_0x2c25d8(0xe2)][_0x2c25d8(0x10c)]()){case'CLO':_0x4d6f76=_0x2c25d8(0x118);break;case _0x2c25d8(0xcd):_0x4d6f76=_0x2c25d8(0xbf);break;case'EXP':_0x4d6f76=_0x2c25d8(0xba);break;case _0x2c25d8(0xbc):_0x4d6f76=_0x2c25d8(0xbf);break;case'NEW':case _0x2c25d8(0x112):default:_0x4d6f76=_0x2c25d8(0xb2);break;}return{'status':_0x4d6f76,'amount':_0x158a07['data']?.[_0x2c25d8(0x11b)],'currency':_0x158a07[_0x2c25d8(0x11a)]?.['currency']};}catch(_0xac23d5){console[_0x2c25d8(0xc4)]('Rapyd\x20payment\x20verification\x20error:',_0xac23d5),loggerService_1['loggerService'][_0x2c25d8(0xd0)]('rapyd','/v1/hosted/payment_links/'+_0x1b987c,_0xac23d5);throw new Error(_0x2c25d8(0xfa)+(_0xac23d5 instanceof Error?_0xac23d5[_0x2c25d8(0xf2)]:_0x2c25d8(0xce)));}}async[a46_0x5d95e1(0xdb)](_0x29c326){const _0x2aef49=a46_0x5d95e1;console[_0x2aef49(0xfb)](_0x2aef49(0xcf),_0x29c326);let _0x4ca59b=_0x2aef49(0xb2),_0x5c469e;_0x29c326['data']?.[_0x2aef49(0xc3)]&&(_0x5c469e=_0x29c326[_0x2aef49(0x11a)][_0x2aef49(0xc3)],console[_0x2aef49(0xfb)](_0x2aef49(0x113)+_0x5c469e));switch(_0x29c326['type']?.['toUpperCase']()){case _0x2aef49(0x108):_0x29c326[_0x2aef49(0x11a)]?.[_0x2aef49(0xc6)]===!![]&&_0x29c326['data']?.[_0x2aef49(0xe2)]===_0x2aef49(0x110)?_0x4ca59b=_0x2aef49(0x118):_0x4ca59b='PENDING';break;case _0x2aef49(0xee):_0x4ca59b='FAILED';break;case'PAYMENT_EXPIRED':_0x4ca59b=_0x2aef49(0xba);break;case _0x2aef49(0xe8):_0x4ca59b=_0x2aef49(0xbf);!_0x5c469e&&_0x29c326['data']?.['failure_message']&&(_0x5c469e=_0x29c326[_0x2aef49(0x11a)][_0x2aef49(0xc3)]);break;default:switch(_0x29c326[_0x2aef49(0x11a)]?.[_0x2aef49(0xe2)]?.[_0x2aef49(0x10c)]()){case'CLO':_0x29c326[_0x2aef49(0x11a)]?.[_0x2aef49(0xc6)]===!![]?_0x4ca59b='PAID':_0x4ca59b='FAILED';break;case _0x2aef49(0xcd):_0x4ca59b=_0x2aef49(0xbf);break;case _0x2aef49(0x104):_0x4ca59b='EXPIRED';break;case _0x2aef49(0xbc):_0x4ca59b='FAILED';!_0x5c469e&&_0x29c326[_0x2aef49(0x11a)]?.[_0x2aef49(0xc3)]&&(_0x5c469e=_0x29c326['data'][_0x2aef49(0xc3)]);break;case _0x2aef49(0xf4):case _0x2aef49(0x112):default:_0x4ca59b=_0x2aef49(0xb2);break;}break;}const _0x237aa2={};return _0x29c326['data']?.[_0x2aef49(0xbe)]?.['last4']&&(_0x237aa2[_0x2aef49(0xcb)]=_0x29c326[_0x2aef49(0x11a)]['payment_method_data']['last4']),_0x29c326['data']?.[_0x2aef49(0xef)]&&(_0x237aa2[_0x2aef49(0x12a)]=_0x29c326[_0x2aef49(0x11a)]['payment_method_type']),_0x29c326['data']?.[_0x2aef49(0xd5)]&&(_0x237aa2[_0x2aef49(0x122)]=_0x29c326[_0x2aef49(0x11a)]['error_code']),_0x29c326[_0x2aef49(0x11a)]?.[_0x2aef49(0xc5)]&&(_0x237aa2[_0x2aef49(0x11c)]=_0x29c326['data'][_0x2aef49(0xc5)]),console['log'](_0x2aef49(0xbd)+_0x4ca59b+_0x2aef49(0xb6)+(_0x5c469e||_0x2aef49(0xf5))),{'paymentId':_0x29c326['data']?.[_0x2aef49(0xbb)]||'','status':_0x4ca59b,'amount':_0x29c326[_0x2aef49(0x11a)]?.[_0x2aef49(0x11b)],'currency':_0x29c326[_0x2aef49(0x11a)]?.['currency'],'failureMessage':_0x5c469e,'additionalInfo':_0x237aa2};}}exports[a46_0x5d95e1(0xf8)]=RapydService;