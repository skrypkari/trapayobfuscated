'use strict';const a48_0x3dc0d6=a48_0x1825;function a48_0x4c35(){const _0x2f695b=['loggerService','Error\x20Message:','PAYMENT_FAILED','createPaymentLink','Rapyd\x20API\x20error\x20(','paid','Failed\x20to\x20verify\x20Rapyd\x20payment:\x20','HTTP\x20error!\x20status:\x20','fixed_side','expiration','💳\x20Payment\x20Methods:\x20gb_visa_card,\x20gb_mastercard_card','Processing\x20Rapyd\x20webhook:','Error\x20stack:','last4','CAN','Business\x20Error\x20(','apiUrl','payment_method_data','/v1/hosted/payment_links','data','message','===\x20PARSED\x20RAPYD\x20RESPONSE\x20===','merchant_reference_id','Rapyd\x20API\x20error:\x20','text','defineProperty','paymentMethod',',\x20body:\x20','SUCCESS','errorCode','PENDING','buy','https://tesoft.uk/gateway/fail.php?id=','headers','Incomplete\x20response:\x20missing\x20id\x20or\x20redirect_url','Status:','status','18PxmviM','Raw\x20Response\x20Body:','cardLast4','/v1/hosted/payment_links/','../loggerService','2712262ppuNPJ','__esModule','Failed\x20to\x20create\x20Rapyd\x20payment\x20link:\x20Unknown\x20error','gb_mastercard_card','https://tesoft.uk/gateway/success.php?id=','1202296riNiOS','GET','21TIuOzo','💱\x20Adding\x20currency\x20conversion\x20fields\x20for\x20','Unknown\x20error\x20from\x20Rapyd\x20API','161968guhZSH','===\x20RAPYD\x20API\x20BUSINESS\x20ERROR\x20===','JSON\x20Parse\x20Error:\x20','requested_currency','rapyd','Error\x20message:','🔄\x20Rapyd\x20webhook\x20processed:\x20status=','🇬🇧\x20Using\x20GB\x20(Britain)\x20as\x20country\x20for\x20Rapyd\x20payment\x20link','ORDER:\x20','\x20\x20\x20requested_currency:\x20EUR','amount','TesSoft\x20Payment\x20System/1.0','stringify','Failed\x20to\x20parse\x20JSON\x20response:','logWhiteDomainError','PAID','===\x20RAPYD\x20SUCCESS\x20===','Response\x20data:','\x20(GB\x20-\x20Britain)','logWhiteDomainResponse','redirect_url','\x20\x20\x20fixed_side:\x20buy','ACT','processWebhook','EUR','floor','Full\x20Error\x20Data:','UNKNOWN','===\x20RAPYD\x20API\x20ERROR\x20===','Redirect\x20URL:','gb_visa_card','🇬🇧\x20Country:\x20','log','9852260HiOqHd','failure_code','Unknown\x20error','Error\x20details:','logWhiteDomainRequest','CLO','Status\x20Text:','now','PAYMENT_COMPLETED','Response\x20Body:','2185rPgbIV','EXPIRED','4584LmEzhx',',\x20failureMessage=','statusText','error','\x20(always\x20GB\x20for\x20Rapyd)','23819WKOJhk','FAILED','currency','type','failureCode','failure_message','):\x20','Parsed\x20Result:','===\x20RAPYD\x20API\x20RESPONSE\x20(White\x20Domain)\x20===','toUpperCase','POST','json','Missing\x20id\x20or\x20redirect_url\x20in\x20response','RapydService','URL:','stack','Headers:','error_code','67772eKpAXi','entries','toISOString','Request\x20Body\x20(Updated\x20Format):','🌐\x20Rapyd\x20service\x20initialized\x20with\x20white\x20domain\x20proxy','Failed\x20to\x20create\x20Rapyd\x20payment\x20link:\x20','application/json','NEW'];a48_0x4c35=function(){return _0x2f695b;};return a48_0x4c35();}(function(_0x1ff5ad,_0x3d2b8d){const _0x47d830=a48_0x1825,_0x51f347=_0x1ff5ad();while(!![]){try{const _0x39d3f8=-parseInt(_0x47d830(0x1d7))/0x1+-parseInt(_0x47d830(0x1e9))/0x2+parseInt(_0x47d830(0x1a2))/0x3*(-parseInt(_0x47d830(0x1a5))/0x4)+-parseInt(_0x47d830(0x1d0))/0x5*(parseInt(_0x47d830(0x1d2))/0x6)+-parseInt(_0x47d830(0x19b))/0x7+-parseInt(_0x47d830(0x1a0))/0x8*(-parseInt(_0x47d830(0x216))/0x9)+parseInt(_0x47d830(0x1c6))/0xa;if(_0x39d3f8===_0x3d2b8d)break;else _0x51f347['push'](_0x51f347['shift']());}catch(_0x4663f3){_0x51f347['push'](_0x51f347['shift']());}}}(a48_0x4c35,0x36855));function a48_0x1825(_0x2b82da,_0x317afa){const _0x4c35bc=a48_0x4c35();return a48_0x1825=function(_0x18253c,_0x5c80cd){_0x18253c=_0x18253c-0x198;let _0x147317=_0x4c35bc[_0x18253c];return _0x147317;},a48_0x1825(_0x2b82da,_0x317afa);}Object[a48_0x3dc0d6(0x20a)](exports,a48_0x3dc0d6(0x19c),{'value':!![]}),exports['RapydService']=void 0x0;const loggerService_1=require(a48_0x3dc0d6(0x19a));class RapydService{constructor(){const _0x4b79e3=a48_0x3dc0d6;this[_0x4b79e3(0x201)]='https://tesoft.uk/gateway/rapyd/',console[_0x4b79e3(0x1c5)](_0x4b79e3(0x1ed));}async[a48_0x3dc0d6(0x1f4)](_0x5a0b9c){const _0xb9c4d1=a48_0x3dc0d6,{orderId:_0x280d79,orderName:_0x3d890d,amount:_0x30d4b3,currency:_0x5c6520,usage:_0xd4815f,maxPayments:_0x5530c0,successUrl:_0x45409f,failUrl:_0x1fe66b}=_0x5a0b9c,_0x48ac66=_0x5c6520[_0xb9c4d1(0x1e0)](),_0x392ca9='GB';console[_0xb9c4d1(0x1c5)](_0xb9c4d1(0x1ac));const _0x4743a5=_0xb9c4d1(0x19f)+_0x280d79,_0x42872a=_0xb9c4d1(0x211)+_0x280d79,_0x4d867f={'amount':_0x30d4b3,'currency':_0x48ac66,'cancel_checkout_url':_0x42872a,'complete_checkout_url':_0x4743a5,'complete_payment_url':_0x4743a5,'merchant_reference_id':_0x280d79,'description':_0xb9c4d1(0x1ad)+_0x280d79,'country':'GB','payment_method_types_include':[_0xb9c4d1(0x1c3),_0xb9c4d1(0x19e)],'custom_elements':{'display_description':!![]}};if(_0x48ac66!==_0xb9c4d1(0x1bd)){const _0x55d9ec=Math[_0xb9c4d1(0x1be)](Date[_0xb9c4d1(0x1cd)]()/0x3e8)+0x1e*0x3c;_0x4d867f[_0xb9c4d1(0x1f9)]=_0xb9c4d1(0x210),_0x4d867f[_0xb9c4d1(0x1a8)]=_0xb9c4d1(0x1bd),_0x4d867f[_0xb9c4d1(0x1fa)]=_0x55d9ec,console['log'](_0xb9c4d1(0x1a3)+_0x48ac66+'\x20->\x20EUR:'),console[_0xb9c4d1(0x1c5)](_0xb9c4d1(0x1ba)),console['log'](_0xb9c4d1(0x1ae)),console[_0xb9c4d1(0x1c5)]('\x20\x20\x20expiration:\x20'+_0x55d9ec+'\x20('+new Date(_0x55d9ec*0x3e8)[_0xb9c4d1(0x1eb)]()+')');}const _0xf47707=Date[_0xb9c4d1(0x1cd)]();try{console[_0xb9c4d1(0x1c5)]('===\x20RAPYD\x20API\x20REQUEST\x20(White\x20Domain\x20-\x20Updated\x20Format)\x20==='),console[_0xb9c4d1(0x1c5)](_0xb9c4d1(0x1e5),this[_0xb9c4d1(0x201)]),console['log'](_0xb9c4d1(0x1ec),JSON[_0xb9c4d1(0x1b1)](_0x4d867f,null,0x2)),console[_0xb9c4d1(0x1c5)](_0xb9c4d1(0x1c4)+_0x392ca9+_0xb9c4d1(0x1d6)),console[_0xb9c4d1(0x1c5)](_0xb9c4d1(0x1fb)),loggerService_1[_0xb9c4d1(0x1f1)][_0xb9c4d1(0x1ca)](_0xb9c4d1(0x1a9),'/v1/hosted/payment_links',_0xb9c4d1(0x1e1),_0x4d867f);const _0x3f00e8=await fetch(this[_0xb9c4d1(0x201)],{'method':'POST','headers':{'Content-Type':_0xb9c4d1(0x1ef),'User-Agent':'TesSoft\x20Payment\x20System/1.0'},'body':JSON[_0xb9c4d1(0x1b1)](_0x4d867f)}),_0x10265b=Date[_0xb9c4d1(0x1cd)]()-_0xf47707;console[_0xb9c4d1(0x1c5)](_0xb9c4d1(0x1df)),console[_0xb9c4d1(0x1c5)](_0xb9c4d1(0x214),_0x3f00e8[_0xb9c4d1(0x215)]),console[_0xb9c4d1(0x1c5)](_0xb9c4d1(0x1cc),_0x3f00e8[_0xb9c4d1(0x1d4)]),console['log'](_0xb9c4d1(0x1e7),Object['fromEntries'](_0x3f00e8[_0xb9c4d1(0x212)][_0xb9c4d1(0x1ea)]())),console[_0xb9c4d1(0x1c5)]('Response\x20Time:',_0x10265b+'ms');const _0x19cb7c=await _0x3f00e8[_0xb9c4d1(0x209)]();console[_0xb9c4d1(0x1c5)](_0xb9c4d1(0x217),_0x19cb7c);if(!_0x3f00e8['ok']){console[_0xb9c4d1(0x1d5)](_0xb9c4d1(0x1c1)),console[_0xb9c4d1(0x1d5)]('HTTP\x20Status:',_0x3f00e8['status']),console['error'](_0xb9c4d1(0x1cf),_0x19cb7c),loggerService_1[_0xb9c4d1(0x1f1)][_0xb9c4d1(0x1b8)](_0xb9c4d1(0x1a9),_0xb9c4d1(0x203),_0x3f00e8[_0xb9c4d1(0x215)],_0x19cb7c,_0x10265b),loggerService_1[_0xb9c4d1(0x1f1)]['logWhiteDomainError'](_0xb9c4d1(0x1a9),_0xb9c4d1(0x203),'HTTP\x20'+_0x3f00e8['status']+':\x20'+_0x19cb7c);throw new Error(_0xb9c4d1(0x1f8)+_0x3f00e8['status']+_0xb9c4d1(0x20c)+_0x19cb7c);}let _0x492f44;try{_0x492f44=JSON['parse'](_0x19cb7c);}catch(_0x16ab68){console[_0xb9c4d1(0x1d5)](_0xb9c4d1(0x1b2),_0x16ab68),loggerService_1[_0xb9c4d1(0x1f1)][_0xb9c4d1(0x1b3)]('rapyd','/v1/hosted/payment_links',_0xb9c4d1(0x1a7)+_0x16ab68);throw new Error('Invalid\x20JSON\x20response\x20from\x20Rapyd\x20API:\x20'+_0x19cb7c);}console[_0xb9c4d1(0x1c5)](_0xb9c4d1(0x206)),console[_0xb9c4d1(0x1c5)](_0xb9c4d1(0x1de),JSON['stringify'](_0x492f44,null,0x2)),loggerService_1[_0xb9c4d1(0x1f1)][_0xb9c4d1(0x1b8)](_0xb9c4d1(0x1a9),_0xb9c4d1(0x203),_0x3f00e8['status'],_0x492f44,_0x10265b);if(_0x492f44[_0xb9c4d1(0x215)]?.[_0xb9c4d1(0x215)]!==_0xb9c4d1(0x20d)){const _0x33e5cc=_0x492f44['status']?.['message']||_0xb9c4d1(0x1a4),_0x17ab58=_0x492f44[_0xb9c4d1(0x215)]?.[_0xb9c4d1(0x1e8)]||_0xb9c4d1(0x1c0);console[_0xb9c4d1(0x1d5)](_0xb9c4d1(0x1a6)),console['error']('Error\x20Code:',_0x17ab58),console[_0xb9c4d1(0x1d5)](_0xb9c4d1(0x1f2),_0x33e5cc),console[_0xb9c4d1(0x1d5)](_0xb9c4d1(0x1bf),_0x492f44['status']),loggerService_1['loggerService'][_0xb9c4d1(0x1b3)]('rapyd',_0xb9c4d1(0x203),_0xb9c4d1(0x200)+_0x17ab58+_0xb9c4d1(0x1dd)+_0x33e5cc);throw new Error(_0xb9c4d1(0x1f5)+_0x17ab58+'):\x20'+_0x33e5cc);}if(!_0x492f44['data']?.['id']||!_0x492f44['data']?.['redirect_url']){console[_0xb9c4d1(0x1d5)]('===\x20RAPYD\x20API\x20INCOMPLETE\x20RESPONSE\x20==='),console[_0xb9c4d1(0x1d5)](_0xb9c4d1(0x1e3)),console[_0xb9c4d1(0x1d5)](_0xb9c4d1(0x1b6),_0x492f44[_0xb9c4d1(0x204)]),loggerService_1[_0xb9c4d1(0x1f1)][_0xb9c4d1(0x1b3)](_0xb9c4d1(0x1a9),'/v1/hosted/payment_links',_0xb9c4d1(0x213));throw new Error('Invalid\x20response\x20from\x20Rapyd\x20API:\x20missing\x20id\x20or\x20redirect_url');}return console[_0xb9c4d1(0x1c5)](_0xb9c4d1(0x1b5)),console['log']('Payment\x20Link\x20ID:',_0x492f44[_0xb9c4d1(0x204)]['id']),console[_0xb9c4d1(0x1c5)](_0xb9c4d1(0x1c2),_0x492f44['data'][_0xb9c4d1(0x1b9)]),console[_0xb9c4d1(0x1c5)]('🇬🇧\x20Country\x20used:\x20'+_0x392ca9+_0xb9c4d1(0x1b7)),console[_0xb9c4d1(0x1c5)](_0xb9c4d1(0x1fb)),{'gateway_payment_id':_0x492f44[_0xb9c4d1(0x204)]['id'],'payment_url':_0x492f44[_0xb9c4d1(0x204)][_0xb9c4d1(0x1b9)]};}catch(_0x43a820){console[_0xb9c4d1(0x1d5)]('===\x20RAPYD\x20SERVICE\x20ERROR\x20==='),console[_0xb9c4d1(0x1d5)](_0xb9c4d1(0x1c9),_0x43a820),loggerService_1[_0xb9c4d1(0x1f1)]['logWhiteDomainError'](_0xb9c4d1(0x1a9),_0xb9c4d1(0x203),_0x43a820);if(_0x43a820 instanceof Error){console[_0xb9c4d1(0x1d5)](_0xb9c4d1(0x1aa),_0x43a820[_0xb9c4d1(0x205)]),console[_0xb9c4d1(0x1d5)](_0xb9c4d1(0x1fd),_0x43a820[_0xb9c4d1(0x1e6)]);throw new Error(_0xb9c4d1(0x1ee)+_0x43a820[_0xb9c4d1(0x205)]);}throw new Error(_0xb9c4d1(0x19d));}}async['verifyPayment'](_0x588464){const _0x2e4b5f=a48_0x3dc0d6,_0x5a8237=Date[_0x2e4b5f(0x1cd)]();try{loggerService_1[_0x2e4b5f(0x1f1)][_0x2e4b5f(0x1ca)](_0x2e4b5f(0x1a9),_0x2e4b5f(0x199)+_0x588464,_0x2e4b5f(0x1a1),{});const _0x2e9d37=await fetch(this[_0x2e4b5f(0x201)]+'/'+_0x588464,{'method':_0x2e4b5f(0x1a1),'headers':{'Content-Type':_0x2e4b5f(0x1ef),'User-Agent':_0x2e4b5f(0x1b0)}}),_0x1989d4=Date['now']()-_0x5a8237;if(!_0x2e9d37['ok']){const _0xb2bc66=await _0x2e9d37['text']();loggerService_1[_0x2e4b5f(0x1f1)][_0x2e4b5f(0x1b8)](_0x2e4b5f(0x1a9),'/v1/hosted/payment_links/'+_0x588464,_0x2e9d37['status'],_0xb2bc66,_0x1989d4);throw new Error('HTTP\x20error!\x20status:\x20'+_0x2e9d37[_0x2e4b5f(0x215)]);}const _0x164e61=await _0x2e9d37[_0x2e4b5f(0x1e2)]();loggerService_1['loggerService'][_0x2e4b5f(0x1b8)](_0x2e4b5f(0x1a9),'/v1/hosted/payment_links/'+_0x588464,_0x2e9d37[_0x2e4b5f(0x215)],_0x164e61,_0x1989d4);if(_0x164e61['status']?.['status']!=='SUCCESS'){loggerService_1[_0x2e4b5f(0x1f1)]['logWhiteDomainError'](_0x2e4b5f(0x1a9),_0x2e4b5f(0x199)+_0x588464,_0x2e4b5f(0x208)+(_0x164e61['status']?.[_0x2e4b5f(0x205)]||_0x2e4b5f(0x1c8)));throw new Error('Rapyd\x20API\x20error:\x20'+(_0x164e61[_0x2e4b5f(0x215)]?.[_0x2e4b5f(0x205)]||_0x2e4b5f(0x1c8)));}let _0x4b3159='PENDING';if(_0x164e61[_0x2e4b5f(0x204)]?.[_0x2e4b5f(0x215)])switch(_0x164e61[_0x2e4b5f(0x204)][_0x2e4b5f(0x215)][_0x2e4b5f(0x1e0)]()){case'CLO':_0x4b3159=_0x2e4b5f(0x1b4);break;case'CAN':_0x4b3159=_0x2e4b5f(0x1d8);break;case'EXP':_0x4b3159='EXPIRED';break;case'ERR':_0x4b3159=_0x2e4b5f(0x1d8);break;case _0x2e4b5f(0x1f0):case'ACT':default:_0x4b3159=_0x2e4b5f(0x20f);break;}return{'status':_0x4b3159,'amount':_0x164e61['data']?.['amount'],'currency':_0x164e61['data']?.[_0x2e4b5f(0x1d9)]};}catch(_0x7585e){console[_0x2e4b5f(0x1d5)]('Rapyd\x20payment\x20verification\x20error:',_0x7585e),loggerService_1[_0x2e4b5f(0x1f1)][_0x2e4b5f(0x1b3)](_0x2e4b5f(0x1a9),_0x2e4b5f(0x199)+_0x588464,_0x7585e);throw new Error(_0x2e4b5f(0x1f7)+(_0x7585e instanceof Error?_0x7585e[_0x2e4b5f(0x205)]:_0x2e4b5f(0x1c8)));}}async[a48_0x3dc0d6(0x1bc)](_0x22ebc6){const _0x436d29=a48_0x3dc0d6;console[_0x436d29(0x1c5)](_0x436d29(0x1fc),_0x22ebc6);let _0x5371ed=_0x436d29(0x20f),_0x1963da;_0x22ebc6['data']?.[_0x436d29(0x1dc)]&&(_0x1963da=_0x22ebc6['data']['failure_message'],console[_0x436d29(0x1c5)]('💥\x20Rapyd\x20failure\x20message:\x20'+_0x1963da));switch(_0x22ebc6[_0x436d29(0x1da)]?.[_0x436d29(0x1e0)]()){case _0x436d29(0x1ce):_0x22ebc6[_0x436d29(0x204)]?.[_0x436d29(0x1f6)]===!![]&&_0x22ebc6[_0x436d29(0x204)]?.[_0x436d29(0x215)]===_0x436d29(0x1cb)?_0x5371ed=_0x436d29(0x1b4):_0x5371ed=_0x436d29(0x20f);break;case'PAYMENT_CANCELED':_0x5371ed=_0x436d29(0x1d8);break;case'PAYMENT_EXPIRED':_0x5371ed='EXPIRED';break;case _0x436d29(0x1f3):_0x5371ed=_0x436d29(0x1d8);!_0x1963da&&_0x22ebc6[_0x436d29(0x204)]?.[_0x436d29(0x1dc)]&&(_0x1963da=_0x22ebc6[_0x436d29(0x204)]['failure_message']);break;default:switch(_0x22ebc6[_0x436d29(0x204)]?.[_0x436d29(0x215)]?.[_0x436d29(0x1e0)]()){case _0x436d29(0x1cb):_0x22ebc6[_0x436d29(0x204)]?.[_0x436d29(0x1f6)]===!![]?_0x5371ed=_0x436d29(0x1b4):_0x5371ed='FAILED';break;case _0x436d29(0x1ff):_0x5371ed=_0x436d29(0x1d8);break;case'EXP':_0x5371ed=_0x436d29(0x1d1);break;case'ERR':_0x5371ed=_0x436d29(0x1d8);!_0x1963da&&_0x22ebc6[_0x436d29(0x204)]?.['failure_message']&&(_0x1963da=_0x22ebc6['data'][_0x436d29(0x1dc)]);break;case _0x436d29(0x1f0):case _0x436d29(0x1bb):default:_0x5371ed='PENDING';break;}break;}const _0x2e395b={};return _0x22ebc6[_0x436d29(0x204)]?.[_0x436d29(0x202)]?.['last4']&&(_0x2e395b[_0x436d29(0x198)]=_0x22ebc6[_0x436d29(0x204)][_0x436d29(0x202)][_0x436d29(0x1fe)]),_0x22ebc6['data']?.['payment_method_type']&&(_0x2e395b[_0x436d29(0x20b)]=_0x22ebc6['data']['payment_method_type']),_0x22ebc6[_0x436d29(0x204)]?.[_0x436d29(0x1e8)]&&(_0x2e395b[_0x436d29(0x20e)]=_0x22ebc6[_0x436d29(0x204)][_0x436d29(0x1e8)]),_0x22ebc6[_0x436d29(0x204)]?.[_0x436d29(0x1c7)]&&(_0x2e395b[_0x436d29(0x1db)]=_0x22ebc6['data'][_0x436d29(0x1c7)]),console[_0x436d29(0x1c5)](_0x436d29(0x1ab)+_0x5371ed+_0x436d29(0x1d3)+(_0x1963da||'none')),{'paymentId':_0x22ebc6[_0x436d29(0x204)]?.[_0x436d29(0x207)]||'','status':_0x5371ed,'amount':_0x22ebc6[_0x436d29(0x204)]?.[_0x436d29(0x1af)],'currency':_0x22ebc6[_0x436d29(0x204)]?.[_0x436d29(0x1d9)],'failureMessage':_0x1963da,'additionalInfo':_0x2e395b};}}exports[a48_0x3dc0d6(0x1e4)]=RapydService;