'use strict';const a45_0x1e81e5=a45_0x53ed;(function(_0x211145,_0x1197ca){const _0x310f28=a45_0x53ed,_0x5f391b=_0x211145();while(!![]){try{const _0x300793=parseInt(_0x310f28(0x118))/0x1+-parseInt(_0x310f28(0x104))/0x2+parseInt(_0x310f28(0x10a))/0x3*(parseInt(_0x310f28(0xd6))/0x4)+parseInt(_0x310f28(0xf8))/0x5*(parseInt(_0x310f28(0xe3))/0x6)+-parseInt(_0x310f28(0x121))/0x7*(parseInt(_0x310f28(0x128))/0x8)+-parseInt(_0x310f28(0x108))/0x9+parseInt(_0x310f28(0xfb))/0xa;if(_0x300793===_0x1197ca)break;else _0x5f391b['push'](_0x5f391b['shift']());}catch(_0x44f242){_0x5f391b['push'](_0x5f391b['shift']());}}}(a45_0x408f,0xe87fb));Object[a45_0x1e81e5(0xd7)](exports,a45_0x1e81e5(0xfd),{'value':!![]}),exports[a45_0x1e81e5(0xbf)]=void 0x0;const loggerService_1=require(a45_0x1e81e5(0xd3));function a45_0x408f(){const _0x5d73e3=['UNKNOWN','522492kZQxAF','stack','===\x20RAPYD\x20API\x20RESPONSE\x20(White\x20Domain)\x20===','üá¨üáß\x20Country\x20used:\x20','Error\x20details:','Rapyd\x20API\x20error:\x20','CAN','currency','ORDER:\x20','üí≥\x20Payment\x20Methods:\x20gb_visa_card,\x20gb_mastercard_card','parse','Redirect\x20URL:','HTTP\x20error!\x20status:\x20',',\x20failureMessage=','Failed\x20to\x20verify\x20Rapyd\x20payment:\x20','/v1/hosted/payment_links','logWhiteDomainResponse','FAILED','CLO','PAID','üåê\x20Rapyd\x20service\x20initialized\x20with\x20white\x20domain\x20proxy','15uiFQEK','statusText','===\x20RAPYD\x20API\x20ERROR\x20===','18082540ZKxHuY','failure_code','__esModule','stringify','error_code','merchant_reference_id','fromEntries','HTTP\x20Status:','https://tesoft.uk/gateway/fail.php?id=','923116sJxfvO','status',',\x20body:\x20','EXPIRED','15975756WWLexc','failureCode','361941siVFvs','PAYMENT_FAILED','log','Incomplete\x20response:\x20missing\x20id\x20or\x20redirect_url','rapyd','apiUrl','Rapyd\x20payment\x20verification\x20error:','Parsed\x20Result:','loggerService','Payment\x20Link\x20ID:','URL:','POST','/v1/hosted/payment_links/','message','949154TNxlqv','amount','Invalid\x20response\x20from\x20Rapyd\x20API:\x20missing\x20id\x20or\x20redirect_url','text','toUpperCase','processWebhook','Invalid\x20JSON\x20response\x20from\x20Rapyd\x20API:\x20','Unknown\x20error\x20from\x20Rapyd\x20API','data','7LGOZMU','payment_method_data','Error\x20Message:','===\x20RAPYD\x20API\x20REQUEST\x20(White\x20Domain\x20-\x20Updated\x20Format)\x20===','TesSoft\x20Payment\x20System/1.0','redirect_url','NEW','567928eEvxPp','paid','logWhiteDomainRequest','entries','Business\x20Error\x20(','Error\x20stack:','Status\x20Text:','paymentMethod','Unknown\x20error','now','Processing\x20Rapyd\x20webhook:','error','verifyPayment','===\x20RAPYD\x20SERVICE\x20ERROR\x20===','RapydService','Error\x20message:','SUCCESS','\x20(GB\x20-\x20Britain)','ACT','Failed\x20to\x20parse\x20JSON\x20response:','none','PENDING','HTTP\x20','Failed\x20to\x20create\x20Rapyd\x20payment\x20link:\x20','logWhiteDomainError','ERR','JSON\x20Parse\x20Error:\x20','failure_message','PAYMENT_EXPIRED','Missing\x20id\x20or\x20redirect_url\x20in\x20response','Rapyd\x20API\x20error\x20(','payment_method_type','type','last4','../loggerService','errorCode','):\x20','8crXhJV','defineProperty','headers','PAYMENT_CANCELED','EXP','PAYMENT_COMPLETED','\x20(always\x20GB\x20for\x20Rapyd)','json','üîÑ\x20Rapyd\x20webhook\x20processed:\x20status=','application/json','===\x20RAPYD\x20API\x20INCOMPLETE\x20RESPONSE\x20===','===\x20RAPYD\x20SUCCESS\x20==='];a45_0x408f=function(){return _0x5d73e3;};return a45_0x408f();}class RapydService{constructor(){const _0x3f2609=a45_0x1e81e5;this[_0x3f2609(0x10f)]='https://tesoft.uk/gateway/rapyd/',console['log'](_0x3f2609(0xf7));}async['createPaymentLink'](_0x5f13f9){const _0x25c8cf=a45_0x1e81e5,{orderId:_0x581a6c,orderName:_0x18cf9f,amount:_0x10650d,currency:_0x42f79a,usage:_0x423dea,maxPayments:_0x16b124,successUrl:_0x37e770,failUrl:_0x2b172d}=_0x5f13f9,_0xf03c36=_0x42f79a[_0x25c8cf(0x11c)](),_0x30831c='GB';console['log']('üá¨üáß\x20Using\x20GB\x20(Britain)\x20as\x20country\x20for\x20Rapyd\x20payment\x20link');const _0x26ec49='https://tesoft.uk/gateway/success.php?id='+_0x581a6c,_0x4f3864=_0x25c8cf(0x103)+_0x581a6c,_0x2fb498={'amount':_0x10650d,'currency':_0xf03c36,'cancel_checkout_url':_0x4f3864,'complete_checkout_url':_0x26ec49,'complete_payment_url':_0x26ec49,'merchant_reference_id':_0x581a6c,'description':_0x25c8cf(0xeb)+_0x581a6c,'country':'GB','payment_method_types_include':['gb_visa_card','gb_mastercard_card'],'custom_elements':{'display_description':!![]}},_0x3c9519=Date[_0x25c8cf(0xba)]();try{console[_0x25c8cf(0x10c)](_0x25c8cf(0x124)),console[_0x25c8cf(0x10c)](_0x25c8cf(0x114),this[_0x25c8cf(0x10f)]),console[_0x25c8cf(0x10c)]('Request\x20Body\x20(Updated\x20Format):',JSON['stringify'](_0x2fb498,null,0x2)),console['log']('üá¨üáß\x20Country:\x20'+_0x30831c+_0x25c8cf(0xdc)),console['log'](_0x25c8cf(0xec)),loggerService_1['loggerService'][_0x25c8cf(0x12a)](_0x25c8cf(0x10e),_0x25c8cf(0xf2),_0x25c8cf(0x115),_0x2fb498);const _0x4e6b16=await fetch(this['apiUrl'],{'method':_0x25c8cf(0x115),'headers':{'Content-Type':_0x25c8cf(0xdf),'User-Agent':_0x25c8cf(0x125)},'body':JSON[_0x25c8cf(0xfe)](_0x2fb498)}),_0x436746=Date[_0x25c8cf(0xba)]()-_0x3c9519;console[_0x25c8cf(0x10c)](_0x25c8cf(0xe5)),console[_0x25c8cf(0x10c)]('Status:',_0x4e6b16[_0x25c8cf(0x105)]),console['log'](_0x25c8cf(0xb7),_0x4e6b16[_0x25c8cf(0xf9)]),console[_0x25c8cf(0x10c)]('Headers:',Object[_0x25c8cf(0x101)](_0x4e6b16[_0x25c8cf(0xd8)][_0x25c8cf(0x12b)]())),console['log']('Response\x20Time:',_0x436746+'ms');const _0x4b472a=await _0x4e6b16[_0x25c8cf(0x11b)]();console[_0x25c8cf(0x10c)]('Raw\x20Response\x20Body:',_0x4b472a);if(!_0x4e6b16['ok']){console['error'](_0x25c8cf(0xfa)),console[_0x25c8cf(0xbc)](_0x25c8cf(0x102),_0x4e6b16[_0x25c8cf(0x105)]),console[_0x25c8cf(0xbc)]('Response\x20Body:',_0x4b472a),loggerService_1[_0x25c8cf(0x112)][_0x25c8cf(0xf3)](_0x25c8cf(0x10e),_0x25c8cf(0xf2),_0x4e6b16['status'],_0x4b472a,_0x436746),loggerService_1[_0x25c8cf(0x112)][_0x25c8cf(0xc9)]('rapyd',_0x25c8cf(0xf2),_0x25c8cf(0xc7)+_0x4e6b16['status']+':\x20'+_0x4b472a);throw new Error(_0x25c8cf(0xef)+_0x4e6b16[_0x25c8cf(0x105)]+_0x25c8cf(0x106)+_0x4b472a);}let _0xb138c8;try{_0xb138c8=JSON[_0x25c8cf(0xed)](_0x4b472a);}catch(_0x38f268){console[_0x25c8cf(0xbc)](_0x25c8cf(0xc4),_0x38f268),loggerService_1['loggerService']['logWhiteDomainError'](_0x25c8cf(0x10e),_0x25c8cf(0xf2),_0x25c8cf(0xcb)+_0x38f268);throw new Error(_0x25c8cf(0x11e)+_0x4b472a);}console[_0x25c8cf(0x10c)]('===\x20PARSED\x20RAPYD\x20RESPONSE\x20==='),console[_0x25c8cf(0x10c)](_0x25c8cf(0x111),JSON[_0x25c8cf(0xfe)](_0xb138c8,null,0x2)),loggerService_1['loggerService'][_0x25c8cf(0xf3)]('rapyd','/v1/hosted/payment_links',_0x4e6b16[_0x25c8cf(0x105)],_0xb138c8,_0x436746);if(_0xb138c8[_0x25c8cf(0x105)]?.['status']!==_0x25c8cf(0xc1)){const _0x1204d6=_0xb138c8[_0x25c8cf(0x105)]?.[_0x25c8cf(0x117)]||_0x25c8cf(0x11f),_0x56a082=_0xb138c8[_0x25c8cf(0x105)]?.[_0x25c8cf(0xff)]||_0x25c8cf(0xe2);console[_0x25c8cf(0xbc)]('===\x20RAPYD\x20API\x20BUSINESS\x20ERROR\x20==='),console[_0x25c8cf(0xbc)]('Error\x20Code:',_0x56a082),console['error'](_0x25c8cf(0x123),_0x1204d6),console[_0x25c8cf(0xbc)]('Full\x20Error\x20Data:',_0xb138c8[_0x25c8cf(0x105)]),loggerService_1[_0x25c8cf(0x112)][_0x25c8cf(0xc9)]('rapyd',_0x25c8cf(0xf2),_0x25c8cf(0x12c)+_0x56a082+_0x25c8cf(0xd5)+_0x1204d6);throw new Error(_0x25c8cf(0xcf)+_0x56a082+_0x25c8cf(0xd5)+_0x1204d6);}if(!_0xb138c8[_0x25c8cf(0x120)]?.['id']||!_0xb138c8[_0x25c8cf(0x120)]?.[_0x25c8cf(0x126)]){console['error'](_0x25c8cf(0xe0)),console['error'](_0x25c8cf(0xce)),console[_0x25c8cf(0xbc)]('Response\x20data:',_0xb138c8[_0x25c8cf(0x120)]),loggerService_1[_0x25c8cf(0x112)][_0x25c8cf(0xc9)](_0x25c8cf(0x10e),'/v1/hosted/payment_links',_0x25c8cf(0x10d));throw new Error(_0x25c8cf(0x11a));}return console[_0x25c8cf(0x10c)](_0x25c8cf(0xe1)),console[_0x25c8cf(0x10c)](_0x25c8cf(0x113),_0xb138c8[_0x25c8cf(0x120)]['id']),console['log'](_0x25c8cf(0xee),_0xb138c8[_0x25c8cf(0x120)]['redirect_url']),console[_0x25c8cf(0x10c)](_0x25c8cf(0xe6)+_0x30831c+_0x25c8cf(0xc2)),console['log'](_0x25c8cf(0xec)),{'gateway_payment_id':_0xb138c8[_0x25c8cf(0x120)]['id'],'payment_url':_0xb138c8[_0x25c8cf(0x120)][_0x25c8cf(0x126)]};}catch(_0x5f476c){console['error'](_0x25c8cf(0xbe)),console[_0x25c8cf(0xbc)](_0x25c8cf(0xe7),_0x5f476c),loggerService_1[_0x25c8cf(0x112)][_0x25c8cf(0xc9)](_0x25c8cf(0x10e),_0x25c8cf(0xf2),_0x5f476c);if(_0x5f476c instanceof Error){console['error'](_0x25c8cf(0xc0),_0x5f476c[_0x25c8cf(0x117)]),console[_0x25c8cf(0xbc)](_0x25c8cf(0xb6),_0x5f476c[_0x25c8cf(0xe4)]);throw new Error(_0x25c8cf(0xc8)+_0x5f476c[_0x25c8cf(0x117)]);}throw new Error('Failed\x20to\x20create\x20Rapyd\x20payment\x20link:\x20Unknown\x20error');}}async[a45_0x1e81e5(0xbd)](_0x20a86e){const _0x4231a7=a45_0x1e81e5,_0x541fd5=Date[_0x4231a7(0xba)]();try{loggerService_1[_0x4231a7(0x112)]['logWhiteDomainRequest'](_0x4231a7(0x10e),'/v1/hosted/payment_links/'+_0x20a86e,'GET',{});const _0x3683fe=await fetch(this[_0x4231a7(0x10f)]+'/'+_0x20a86e,{'method':'GET','headers':{'Content-Type':_0x4231a7(0xdf),'User-Agent':_0x4231a7(0x125)}}),_0x3b8106=Date[_0x4231a7(0xba)]()-_0x541fd5;if(!_0x3683fe['ok']){const _0x1d31b4=await _0x3683fe['text']();loggerService_1['loggerService'][_0x4231a7(0xf3)]('rapyd',_0x4231a7(0x116)+_0x20a86e,_0x3683fe[_0x4231a7(0x105)],_0x1d31b4,_0x3b8106);throw new Error(_0x4231a7(0xef)+_0x3683fe[_0x4231a7(0x105)]);}const _0x1c4626=await _0x3683fe[_0x4231a7(0xdd)]();loggerService_1[_0x4231a7(0x112)][_0x4231a7(0xf3)](_0x4231a7(0x10e),_0x4231a7(0x116)+_0x20a86e,_0x3683fe[_0x4231a7(0x105)],_0x1c4626,_0x3b8106);if(_0x1c4626[_0x4231a7(0x105)]?.[_0x4231a7(0x105)]!==_0x4231a7(0xc1)){loggerService_1['loggerService'][_0x4231a7(0xc9)]('rapyd',_0x4231a7(0x116)+_0x20a86e,_0x4231a7(0xe8)+(_0x1c4626[_0x4231a7(0x105)]?.[_0x4231a7(0x117)]||'Unknown\x20error'));throw new Error(_0x4231a7(0xe8)+(_0x1c4626[_0x4231a7(0x105)]?.[_0x4231a7(0x117)]||_0x4231a7(0xb9)));}let _0x27f0b4='PENDING';if(_0x1c4626[_0x4231a7(0x120)]?.[_0x4231a7(0x105)])switch(_0x1c4626['data'][_0x4231a7(0x105)]['toUpperCase']()){case _0x4231a7(0xf5):_0x27f0b4='PAID';break;case _0x4231a7(0xe9):_0x27f0b4=_0x4231a7(0xf4);break;case'EXP':_0x27f0b4=_0x4231a7(0x107);break;case _0x4231a7(0xca):_0x27f0b4='FAILED';break;case'NEW':case _0x4231a7(0xc3):default:_0x27f0b4=_0x4231a7(0xc6);break;}return{'status':_0x27f0b4,'amount':_0x1c4626[_0x4231a7(0x120)]?.[_0x4231a7(0x119)],'currency':_0x1c4626[_0x4231a7(0x120)]?.[_0x4231a7(0xea)]};}catch(_0x4d4941){console[_0x4231a7(0xbc)](_0x4231a7(0x110),_0x4d4941),loggerService_1[_0x4231a7(0x112)][_0x4231a7(0xc9)](_0x4231a7(0x10e),_0x4231a7(0x116)+_0x20a86e,_0x4d4941);throw new Error(_0x4231a7(0xf1)+(_0x4d4941 instanceof Error?_0x4d4941[_0x4231a7(0x117)]:'Unknown\x20error'));}}async[a45_0x1e81e5(0x11d)](_0x47e03e){const _0x571aaa=a45_0x1e81e5;console[_0x571aaa(0x10c)](_0x571aaa(0xbb),_0x47e03e);let _0x189bf3=_0x571aaa(0xc6),_0x1c9bec;_0x47e03e['data']?.[_0x571aaa(0xcc)]&&(_0x1c9bec=_0x47e03e[_0x571aaa(0x120)][_0x571aaa(0xcc)],console[_0x571aaa(0x10c)]('üí•\x20Rapyd\x20failure\x20message:\x20'+_0x1c9bec));switch(_0x47e03e[_0x571aaa(0xd1)]?.[_0x571aaa(0x11c)]()){case _0x571aaa(0xdb):_0x47e03e['data']?.[_0x571aaa(0x129)]===!![]&&_0x47e03e['data']?.[_0x571aaa(0x105)]==='CLO'?_0x189bf3=_0x571aaa(0xf6):_0x189bf3='PENDING';break;case _0x571aaa(0xd9):_0x189bf3='FAILED';break;case _0x571aaa(0xcd):_0x189bf3='EXPIRED';break;case _0x571aaa(0x10b):_0x189bf3='FAILED';!_0x1c9bec&&_0x47e03e[_0x571aaa(0x120)]?.[_0x571aaa(0xcc)]&&(_0x1c9bec=_0x47e03e[_0x571aaa(0x120)][_0x571aaa(0xcc)]);break;default:switch(_0x47e03e[_0x571aaa(0x120)]?.['status']?.['toUpperCase']()){case _0x571aaa(0xf5):_0x47e03e['data']?.['paid']===!![]?_0x189bf3=_0x571aaa(0xf6):_0x189bf3='FAILED';break;case _0x571aaa(0xe9):_0x189bf3=_0x571aaa(0xf4);break;case _0x571aaa(0xda):_0x189bf3=_0x571aaa(0x107);break;case'ERR':_0x189bf3=_0x571aaa(0xf4);!_0x1c9bec&&_0x47e03e['data']?.[_0x571aaa(0xcc)]&&(_0x1c9bec=_0x47e03e['data']['failure_message']);break;case _0x571aaa(0x127):case _0x571aaa(0xc3):default:_0x189bf3='PENDING';break;}break;}const _0x39bc37={};return _0x47e03e[_0x571aaa(0x120)]?.[_0x571aaa(0x122)]?.[_0x571aaa(0xd2)]&&(_0x39bc37['cardLast4']=_0x47e03e[_0x571aaa(0x120)][_0x571aaa(0x122)][_0x571aaa(0xd2)]),_0x47e03e[_0x571aaa(0x120)]?.[_0x571aaa(0xd0)]&&(_0x39bc37[_0x571aaa(0xb8)]=_0x47e03e[_0x571aaa(0x120)][_0x571aaa(0xd0)]),_0x47e03e[_0x571aaa(0x120)]?.[_0x571aaa(0xff)]&&(_0x39bc37[_0x571aaa(0xd4)]=_0x47e03e[_0x571aaa(0x120)][_0x571aaa(0xff)]),_0x47e03e[_0x571aaa(0x120)]?.[_0x571aaa(0xfc)]&&(_0x39bc37[_0x571aaa(0x109)]=_0x47e03e['data'][_0x571aaa(0xfc)]),console[_0x571aaa(0x10c)](_0x571aaa(0xde)+_0x189bf3+_0x571aaa(0xf0)+(_0x1c9bec||_0x571aaa(0xc5))),{'paymentId':_0x47e03e[_0x571aaa(0x120)]?.[_0x571aaa(0x100)]||'','status':_0x189bf3,'amount':_0x47e03e[_0x571aaa(0x120)]?.[_0x571aaa(0x119)],'currency':_0x47e03e[_0x571aaa(0x120)]?.['currency'],'failureMessage':_0x1c9bec,'additionalInfo':_0x39bc37};}}function a45_0x53ed(_0x285b9f,_0x177431){const _0x408f6f=a45_0x408f();return a45_0x53ed=function(_0x53ed93,_0x1e8254){_0x53ed93=_0x53ed93-0xb6;let _0x44f2bd=_0x408f6f[_0x53ed93];return _0x44f2bd;},a45_0x53ed(_0x285b9f,_0x177431);}exports[a45_0x1e81e5(0xbf)]=RapydService;