'use strict';const a46_0x2dfffd=a46_0x248a;(function(_0x44b6e2,_0x20b287){const _0x1e8394=a46_0x248a,_0x31dff5=_0x44b6e2();while(!![]){try{const _0x53c43e=-parseInt(_0x1e8394(0x16b))/0x1+-parseInt(_0x1e8394(0x191))/0x2*(parseInt(_0x1e8394(0x16a))/0x3)+parseInt(_0x1e8394(0x15d))/0x4*(-parseInt(_0x1e8394(0x18a))/0x5)+parseInt(_0x1e8394(0x176))/0x6*(-parseInt(_0x1e8394(0x138))/0x7)+parseInt(_0x1e8394(0x18d))/0x8*(-parseInt(_0x1e8394(0x142))/0x9)+parseInt(_0x1e8394(0x14e))/0xa*(parseInt(_0x1e8394(0x13e))/0xb)+-parseInt(_0x1e8394(0x14a))/0xc*(-parseInt(_0x1e8394(0x147))/0xd);if(_0x53c43e===_0x20b287)break;else _0x31dff5['push'](_0x31dff5['shift']());}catch(_0x56beed){_0x31dff5['push'](_0x31dff5['shift']());}}}(a46_0x3afe,0xc1553));function a46_0x248a(_0x3294fc,_0xc7c7ee){const _0x3afee4=a46_0x3afe();return a46_0x248a=function(_0x248a01,_0x842cb8){_0x248a01=_0x248a01-0x124;let _0x5b059c=_0x3afee4[_0x248a01];return _0x5b059c;},a46_0x248a(_0x3294fc,_0xc7c7ee);}Object[a46_0x2dfffd(0x165)](exports,a46_0x2dfffd(0x16f),{'value':!![]}),exports['RapydService']=void 0x0;const loggerService_1=require(a46_0x2dfffd(0x17f));class RapydService{constructor(){const _0x1a8ce7=a46_0x2dfffd;this[_0x1a8ce7(0x136)]=_0x1a8ce7(0x159),console[_0x1a8ce7(0x129)](_0x1a8ce7(0x146));}async['createPaymentLink'](_0x170194){const _0x12dfc1=a46_0x2dfffd,{orderId:_0x3b76a1,orderName:_0xa8c778,amount:_0x563610,currency:_0x394350,usage:_0x2d0124,maxPayments:_0xd0d776,successUrl:_0x1e3f24,failUrl:_0xb6d16a}=_0x170194,_0x2ffd6b=_0x394350[_0x12dfc1(0x190)](),_0x245605='GB';console[_0x12dfc1(0x129)]('🇬🇧\x20Using\x20GB\x20(Britain)\x20as\x20country\x20for\x20Rapyd\x20payment\x20link');const _0x554469='https://tesoft.uk/gateway/success.php?id='+_0x3b76a1,_0x5b4812=_0x12dfc1(0x15c)+_0x3b76a1,_0x3df059={'amount':_0x563610,'currency':_0x2ffd6b,'cancel_checkout_url':_0x5b4812,'complete_checkout_url':_0x554469,'complete_payment_url':_0x554469,'merchant_reference_id':_0x3b76a1,'description':'ORDER:\x20'+_0x3b76a1,'country':'GB','payment_method_types_include':['gb_visa_card',_0x12dfc1(0x156)],'custom_elements':{'display_description':!![]}},_0x157efd=Date['now']();try{console[_0x12dfc1(0x129)]('===\x20RAPYD\x20API\x20REQUEST\x20(White\x20Domain\x20-\x20Updated\x20Format)\x20==='),console[_0x12dfc1(0x129)](_0x12dfc1(0x175),this[_0x12dfc1(0x136)]),console[_0x12dfc1(0x129)](_0x12dfc1(0x167),JSON[_0x12dfc1(0x197)](_0x3df059,null,0x2)),console[_0x12dfc1(0x129)](_0x12dfc1(0x171)+_0x245605+_0x12dfc1(0x163)),console['log'](_0x12dfc1(0x141)),loggerService_1['loggerService'][_0x12dfc1(0x12c)](_0x12dfc1(0x150),_0x12dfc1(0x154),_0x12dfc1(0x13b),_0x3df059);const _0x2460f3=await fetch(this['apiUrl'],{'method':_0x12dfc1(0x13b),'headers':{'Content-Type':_0x12dfc1(0x152),'User-Agent':_0x12dfc1(0x12e)},'body':JSON[_0x12dfc1(0x197)](_0x3df059)}),_0x44d273=Date['now']()-_0x157efd;console[_0x12dfc1(0x129)]('===\x20RAPYD\x20API\x20RESPONSE\x20(White\x20Domain)\x20==='),console[_0x12dfc1(0x129)]('Status:',_0x2460f3[_0x12dfc1(0x12d)]),console[_0x12dfc1(0x129)](_0x12dfc1(0x183),_0x2460f3[_0x12dfc1(0x13d)]),console['log']('Headers:',Object[_0x12dfc1(0x182)](_0x2460f3[_0x12dfc1(0x196)][_0x12dfc1(0x169)]())),console[_0x12dfc1(0x129)](_0x12dfc1(0x153),_0x44d273+'ms');const _0x2c26e9=await _0x2460f3[_0x12dfc1(0x15e)]();console[_0x12dfc1(0x129)]('Raw\x20Response\x20Body:',_0x2c26e9);if(!_0x2460f3['ok']){console[_0x12dfc1(0x185)](_0x12dfc1(0x149)),console['error']('HTTP\x20Status:',_0x2460f3[_0x12dfc1(0x12d)]),console[_0x12dfc1(0x185)]('Response\x20Body:',_0x2c26e9),loggerService_1['loggerService']['logWhiteDomainResponse'](_0x12dfc1(0x150),_0x12dfc1(0x154),_0x2460f3[_0x12dfc1(0x12d)],_0x2c26e9,_0x44d273),loggerService_1[_0x12dfc1(0x193)]['logWhiteDomainError']('rapyd',_0x12dfc1(0x154),_0x12dfc1(0x18c)+_0x2460f3[_0x12dfc1(0x12d)]+':\x20'+_0x2c26e9);throw new Error('HTTP\x20error!\x20status:\x20'+_0x2460f3[_0x12dfc1(0x12d)]+',\x20body:\x20'+_0x2c26e9);}let _0x749c7c;try{_0x749c7c=JSON[_0x12dfc1(0x192)](_0x2c26e9);}catch(_0x35a944){console[_0x12dfc1(0x185)]('Failed\x20to\x20parse\x20JSON\x20response:',_0x35a944),loggerService_1[_0x12dfc1(0x193)][_0x12dfc1(0x125)]('rapyd','/v1/hosted/payment_links','JSON\x20Parse\x20Error:\x20'+_0x35a944);throw new Error(_0x12dfc1(0x166)+_0x2c26e9);}console[_0x12dfc1(0x129)](_0x12dfc1(0x14c)),console[_0x12dfc1(0x129)]('Parsed\x20Result:',JSON[_0x12dfc1(0x197)](_0x749c7c,null,0x2)),loggerService_1['loggerService'][_0x12dfc1(0x131)](_0x12dfc1(0x150),'/v1/hosted/payment_links',_0x2460f3[_0x12dfc1(0x12d)],_0x749c7c,_0x44d273);if(_0x749c7c[_0x12dfc1(0x12d)]?.[_0x12dfc1(0x12d)]!==_0x12dfc1(0x132)){const _0x3511dc=_0x749c7c['status']?.[_0x12dfc1(0x12a)]||_0x12dfc1(0x126),_0x59b248=_0x749c7c[_0x12dfc1(0x12d)]?.['error_code']||'UNKNOWN';console[_0x12dfc1(0x185)]('===\x20RAPYD\x20API\x20BUSINESS\x20ERROR\x20==='),console[_0x12dfc1(0x185)](_0x12dfc1(0x16e),_0x59b248),console[_0x12dfc1(0x185)](_0x12dfc1(0x17b),_0x3511dc),console[_0x12dfc1(0x185)](_0x12dfc1(0x13a),_0x749c7c[_0x12dfc1(0x12d)]),loggerService_1[_0x12dfc1(0x193)][_0x12dfc1(0x125)](_0x12dfc1(0x150),_0x12dfc1(0x154),_0x12dfc1(0x14f)+_0x59b248+_0x12dfc1(0x134)+_0x3511dc);throw new Error(_0x12dfc1(0x164)+_0x59b248+_0x12dfc1(0x134)+_0x3511dc);}if(!_0x749c7c['data']?.['id']||!_0x749c7c[_0x12dfc1(0x17a)]?.['redirect_url']){console[_0x12dfc1(0x185)](_0x12dfc1(0x14d)),console['error'](_0x12dfc1(0x189)),console[_0x12dfc1(0x185)](_0x12dfc1(0x12f),_0x749c7c[_0x12dfc1(0x17a)]),loggerService_1[_0x12dfc1(0x193)][_0x12dfc1(0x125)](_0x12dfc1(0x150),_0x12dfc1(0x154),'Incomplete\x20response:\x20missing\x20id\x20or\x20redirect_url');throw new Error(_0x12dfc1(0x127));}return console['log'](_0x12dfc1(0x148)),console[_0x12dfc1(0x129)]('Payment\x20Link\x20ID:',_0x749c7c['data']['id']),console[_0x12dfc1(0x129)]('Redirect\x20URL:',_0x749c7c[_0x12dfc1(0x17a)][_0x12dfc1(0x151)]),console[_0x12dfc1(0x129)](_0x12dfc1(0x12b)+_0x245605+_0x12dfc1(0x17c)),console[_0x12dfc1(0x129)](_0x12dfc1(0x141)),{'gateway_payment_id':_0x749c7c['data']['id'],'payment_url':_0x749c7c['data'][_0x12dfc1(0x151)]};}catch(_0x45012d){console[_0x12dfc1(0x185)](_0x12dfc1(0x180)),console[_0x12dfc1(0x185)](_0x12dfc1(0x187),_0x45012d),loggerService_1[_0x12dfc1(0x193)][_0x12dfc1(0x125)](_0x12dfc1(0x150),_0x12dfc1(0x154),_0x45012d);if(_0x45012d instanceof Error){console[_0x12dfc1(0x185)](_0x12dfc1(0x170),_0x45012d['message']),console[_0x12dfc1(0x185)](_0x12dfc1(0x16d),_0x45012d[_0x12dfc1(0x133)]);throw new Error(_0x12dfc1(0x157)+_0x45012d[_0x12dfc1(0x12a)]);}throw new Error(_0x12dfc1(0x128));}}async[a46_0x2dfffd(0x179)](_0x50a853){const _0x5ed4eb=a46_0x2dfffd,_0x2cf704=Date[_0x5ed4eb(0x161)]();try{loggerService_1[_0x5ed4eb(0x193)]['logWhiteDomainRequest'](_0x5ed4eb(0x150),_0x5ed4eb(0x16c)+_0x50a853,_0x5ed4eb(0x198),{});const _0x2561a8=await fetch(this[_0x5ed4eb(0x136)]+'/'+_0x50a853,{'method':_0x5ed4eb(0x198),'headers':{'Content-Type':_0x5ed4eb(0x152),'User-Agent':_0x5ed4eb(0x12e)}}),_0x2059dd=Date[_0x5ed4eb(0x161)]()-_0x2cf704;if(!_0x2561a8['ok']){const _0x1cf373=await _0x2561a8[_0x5ed4eb(0x15e)]();loggerService_1[_0x5ed4eb(0x193)][_0x5ed4eb(0x131)]('rapyd',_0x5ed4eb(0x16c)+_0x50a853,_0x2561a8[_0x5ed4eb(0x12d)],_0x1cf373,_0x2059dd);throw new Error(_0x5ed4eb(0x18e)+_0x2561a8[_0x5ed4eb(0x12d)]);}const _0x32cb6c=await _0x2561a8['json']();loggerService_1[_0x5ed4eb(0x193)][_0x5ed4eb(0x131)]('rapyd','/v1/hosted/payment_links/'+_0x50a853,_0x2561a8[_0x5ed4eb(0x12d)],_0x32cb6c,_0x2059dd);if(_0x32cb6c[_0x5ed4eb(0x12d)]?.[_0x5ed4eb(0x12d)]!==_0x5ed4eb(0x132)){loggerService_1['loggerService'][_0x5ed4eb(0x125)](_0x5ed4eb(0x150),_0x5ed4eb(0x16c)+_0x50a853,_0x5ed4eb(0x137)+(_0x32cb6c[_0x5ed4eb(0x12d)]?.['message']||'Unknown\x20error'));throw new Error('Rapyd\x20API\x20error:\x20'+(_0x32cb6c[_0x5ed4eb(0x12d)]?.[_0x5ed4eb(0x12a)]||_0x5ed4eb(0x15f)));}let _0x1ce22b=_0x5ed4eb(0x143);if(_0x32cb6c[_0x5ed4eb(0x17a)]?.[_0x5ed4eb(0x12d)])switch(_0x32cb6c['data'][_0x5ed4eb(0x12d)]['toUpperCase']()){case _0x5ed4eb(0x145):_0x1ce22b=_0x5ed4eb(0x155);break;case _0x5ed4eb(0x195):_0x1ce22b=_0x5ed4eb(0x17e);break;case _0x5ed4eb(0x168):_0x1ce22b=_0x5ed4eb(0x173);break;case _0x5ed4eb(0x160):_0x1ce22b=_0x5ed4eb(0x17e);break;case _0x5ed4eb(0x15b):case'ACT':default:_0x1ce22b=_0x5ed4eb(0x143);break;}return{'status':_0x1ce22b,'amount':_0x32cb6c[_0x5ed4eb(0x17a)]?.[_0x5ed4eb(0x144)],'currency':_0x32cb6c[_0x5ed4eb(0x17a)]?.[_0x5ed4eb(0x15a)]};}catch(_0x4ceefa){console[_0x5ed4eb(0x185)](_0x5ed4eb(0x158),_0x4ceefa),loggerService_1[_0x5ed4eb(0x193)][_0x5ed4eb(0x125)](_0x5ed4eb(0x150),_0x5ed4eb(0x16c)+_0x50a853,_0x4ceefa);throw new Error(_0x5ed4eb(0x177)+(_0x4ceefa instanceof Error?_0x4ceefa[_0x5ed4eb(0x12a)]:'Unknown\x20error'));}}async[a46_0x2dfffd(0x17d)](_0x5dc2d8){const _0x4dcc48=a46_0x2dfffd;console[_0x4dcc48(0x129)]('Processing\x20Rapyd\x20webhook:',_0x5dc2d8);let _0x5e6160='PENDING',_0x670465;_0x5dc2d8[_0x4dcc48(0x17a)]?.[_0x4dcc48(0x172)]&&(_0x670465=_0x5dc2d8[_0x4dcc48(0x17a)][_0x4dcc48(0x172)],console[_0x4dcc48(0x129)]('💥\x20Rapyd\x20failure\x20message:\x20'+_0x670465));switch(_0x5dc2d8[_0x4dcc48(0x178)]?.[_0x4dcc48(0x190)]()){case _0x4dcc48(0x162):_0x5dc2d8[_0x4dcc48(0x17a)]?.[_0x4dcc48(0x18f)]===!![]&&_0x5dc2d8[_0x4dcc48(0x17a)]?.[_0x4dcc48(0x12d)]===_0x4dcc48(0x145)?_0x5e6160='PAID':_0x5e6160=_0x4dcc48(0x143);break;case _0x4dcc48(0x18b):_0x5e6160='FAILED';break;case'PAYMENT_EXPIRED':_0x5e6160=_0x4dcc48(0x173);break;case _0x4dcc48(0x186):_0x5e6160=_0x4dcc48(0x17e);!_0x670465&&_0x5dc2d8['data']?.[_0x4dcc48(0x172)]&&(_0x670465=_0x5dc2d8['data'][_0x4dcc48(0x172)]);break;default:switch(_0x5dc2d8['data']?.[_0x4dcc48(0x12d)]?.['toUpperCase']()){case _0x4dcc48(0x145):_0x5dc2d8[_0x4dcc48(0x17a)]?.[_0x4dcc48(0x18f)]===!![]?_0x5e6160='PAID':_0x5e6160=_0x4dcc48(0x17e);break;case'CAN':_0x5e6160='FAILED';break;case _0x4dcc48(0x168):_0x5e6160=_0x4dcc48(0x173);break;case'ERR':_0x5e6160=_0x4dcc48(0x17e);!_0x670465&&_0x5dc2d8['data']?.[_0x4dcc48(0x172)]&&(_0x670465=_0x5dc2d8[_0x4dcc48(0x17a)]['failure_message']);break;case _0x4dcc48(0x15b):case'ACT':default:_0x5e6160=_0x4dcc48(0x143);break;}break;}const _0x4a7e41={};return _0x5dc2d8[_0x4dcc48(0x17a)]?.[_0x4dcc48(0x135)]?.[_0x4dcc48(0x140)]&&(_0x4a7e41[_0x4dcc48(0x14b)]=_0x5dc2d8[_0x4dcc48(0x17a)][_0x4dcc48(0x135)]['last4']),_0x5dc2d8[_0x4dcc48(0x17a)]?.['payment_method_type']&&(_0x4a7e41[_0x4dcc48(0x184)]=_0x5dc2d8[_0x4dcc48(0x17a)][_0x4dcc48(0x188)]),_0x5dc2d8['data']?.['error_code']&&(_0x4a7e41[_0x4dcc48(0x130)]=_0x5dc2d8[_0x4dcc48(0x17a)][_0x4dcc48(0x174)]),_0x5dc2d8[_0x4dcc48(0x17a)]?.[_0x4dcc48(0x139)]&&(_0x4a7e41[_0x4dcc48(0x194)]=_0x5dc2d8[_0x4dcc48(0x17a)]['failure_code']),console[_0x4dcc48(0x129)](_0x4dcc48(0x13c)+_0x5e6160+_0x4dcc48(0x124)+(_0x670465||'none')),{'paymentId':_0x5dc2d8['data']?.[_0x4dcc48(0x13f)]||'','status':_0x5e6160,'amount':_0x5dc2d8[_0x4dcc48(0x17a)]?.['amount'],'currency':_0x5dc2d8[_0x4dcc48(0x17a)]?.['currency'],'failureMessage':_0x670465,'additionalInfo':_0x4a7e41};}}exports[a46_0x2dfffd(0x181)]=RapydService;function a46_0x3afe(){const _0x55208c=['):\x20','payment_method_data','apiUrl','Rapyd\x20API\x20error:\x20','2264773fSkrZN','failure_code','Full\x20Error\x20Data:','POST','🔄\x20Rapyd\x20webhook\x20processed:\x20status=','statusText','66DxgPYS','merchant_reference_id','last4','💳\x20Payment\x20Methods:\x20gb_visa_card,\x20gb_mastercard_card','130374OGoaGU','PENDING','amount','CLO','🌐\x20Rapyd\x20service\x20initialized\x20with\x20white\x20domain\x20proxy','2857803UCsOBb','===\x20RAPYD\x20SUCCESS\x20===','===\x20RAPYD\x20API\x20ERROR\x20===','204wiSCpK','cardLast4','===\x20PARSED\x20RAPYD\x20RESPONSE\x20===','===\x20RAPYD\x20API\x20INCOMPLETE\x20RESPONSE\x20===','1963960ZpLzla','Business\x20Error\x20(','rapyd','redirect_url','application/json','Response\x20Time:','/v1/hosted/payment_links','PAID','gb_mastercard_card','Failed\x20to\x20create\x20Rapyd\x20payment\x20link:\x20','Rapyd\x20payment\x20verification\x20error:','https://tesoft.uk/gateway/rapyd/','currency','NEW','https://tesoft.uk/gateway/fail.php?id=','756FPbyAK','text','Unknown\x20error','ERR','now','PAYMENT_COMPLETED','\x20(always\x20GB\x20for\x20Rapyd)','Rapyd\x20API\x20error\x20(','defineProperty','Invalid\x20JSON\x20response\x20from\x20Rapyd\x20API:\x20','Request\x20Body\x20(Updated\x20Format):','EXP','entries','681JnTsKV','683756tFEvjV','/v1/hosted/payment_links/','Error\x20stack:','Error\x20Code:','__esModule','Error\x20message:','🇬🇧\x20Country:\x20','failure_message','EXPIRED','error_code','URL:','6NrqRqb','Failed\x20to\x20verify\x20Rapyd\x20payment:\x20','type','verifyPayment','data','Error\x20Message:','\x20(GB\x20-\x20Britain)','processWebhook','FAILED','../loggerService','===\x20RAPYD\x20SERVICE\x20ERROR\x20===','RapydService','fromEntries','Status\x20Text:','paymentMethod','error','PAYMENT_FAILED','Error\x20details:','payment_method_type','Missing\x20id\x20or\x20redirect_url\x20in\x20response','10245zcvULS','PAYMENT_CANCELED','HTTP\x20','680sQJVpN','HTTP\x20error!\x20status:\x20','paid','toUpperCase','13196dLzBRr','parse','loggerService','failureCode','CAN','headers','stringify','GET',',\x20failureMessage=','logWhiteDomainError','Unknown\x20error\x20from\x20Rapyd\x20API','Invalid\x20response\x20from\x20Rapyd\x20API:\x20missing\x20id\x20or\x20redirect_url','Failed\x20to\x20create\x20Rapyd\x20payment\x20link:\x20Unknown\x20error','log','message','🇬🇧\x20Country\x20used:\x20','logWhiteDomainRequest','status','TesSoft\x20Payment\x20System/1.0','Response\x20data:','errorCode','logWhiteDomainResponse','SUCCESS','stack'];a46_0x3afe=function(){return _0x55208c;};return a46_0x3afe();}