'use strict';const a63_0x1b5c16=a63_0x2ad4;(function(_0x47c926,_0x351f8d){const _0x1d3d59=a63_0x2ad4,_0x23e66d=_0x47c926();while(!![]){try{const _0x2b51a5=parseInt(_0x1d3d59(0x16a))/0x1*(-parseInt(_0x1d3d59(0x173))/0x2)+-parseInt(_0x1d3d59(0x17f))/0x3+parseInt(_0x1d3d59(0x150))/0x4+parseInt(_0x1d3d59(0x1b1))/0x5*(parseInt(_0x1d3d59(0x14c))/0x6)+-parseInt(_0x1d3d59(0x19e))/0x7*(-parseInt(_0x1d3d59(0x1af))/0x8)+-parseInt(_0x1d3d59(0x179))/0x9*(-parseInt(_0x1d3d59(0x18d))/0xa)+parseInt(_0x1d3d59(0x1a6))/0xb*(-parseInt(_0x1d3d59(0x1a7))/0xc);if(_0x2b51a5===_0x351f8d)break;else _0x23e66d['push'](_0x23e66d['shift']());}catch(_0x5971f2){_0x23e66d['push'](_0x23e66d['shift']());}}}(a63_0xe318,0x4acf0));function a63_0xe318(){const _0x4f9ab3=['NEW','üí≥\x20Adding\x20cardholder\x20name:\x20','2075770eohHQk','Error\x20stack:','verifyPayment','HTTP\x20Status:','Payment\x20Link\x20ID:','toISOString','failure_code','application/json','Status\x20Text:','error_code','üí±\x20Adding\x20currency\x20conversion\x20fields\x20for\x20','PAYMENT_EXPIRED','stack','Response\x20data:','SUCCESS','HTTP\x20','/v1/hosted/payment_links','7KbjbGk','payment_method_type','Request\x20Body\x20(Updated\x20Format):','\x20(GB\x20-\x20Britain)','payment_method_data','text','Rapyd\x20API\x20error:\x20','stringify','532466JZaMYg','84aXDVis','data','Response\x20Time:','Invalid\x20response\x20from\x20Rapyd\x20API:\x20missing\x20id\x20or\x20redirect_url','type','logWhiteDomainResponse','fixed_side','now','4456168uMTrfg','EXP','415yhIEaw','Business\x20Error\x20(','JSON\x20Parse\x20Error:\x20','\x20->\x20EUR:','json','ERR','log','PAYMENT_FAILED','URL:','Payment\x20System/1.0','rapyd','üá¨üáß\x20Country\x20used:\x20','Failed\x20to\x20verify\x20Rapyd\x20payment:\x20','cardholder_name','===\x20RAPYD\x20API\x20RESPONSE\x20(White\x20Domain)\x20===',',\x20body:\x20','paid','email','address','phone_number','===\x20RAPYD\x20SUCCESS\x20===','toUpperCase','__esModule','\x20\x20\x20expiration:\x20','===\x20RAPYD\x20API\x20BUSINESS\x20ERROR\x20===','):\x20','logWhiteDomainError','ACT','CAN','createPaymentLink','32946LFWnCV','üí≥\x20Payment\x20Methods:\x20gb_visa_card,\x20gb_mastercard_card','/v1/hosted/payment_links/','Response\x20Body:','390612tlQfBF','HTTP\x20error!\x20status:\x20','none','fromEntries','üîÑ\x20Rapyd\x20webhook\x20processed:\x20status=','CLO','Missing\x20id\x20or\x20redirect_url\x20in\x20response','EXPIRED','Failed\x20to\x20parse\x20JSON\x20response:','EUR','üá¨üáß\x20Using\x20GB\x20(Britain)\x20as\x20country\x20for\x20Rapyd\x20payment\x20link','PAID','headers','POST','failureCode','RapydService','error','https://tesoft.uk/gateway/success.php?id=','Parsed\x20Result:','Full\x20Error\x20Data:','\x20\x20\x20fixed_side:\x20buy','üí•\x20Rapyd\x20failure\x20message:\x20','Incomplete\x20response:\x20missing\x20id\x20or\x20redirect_url','Error\x20Message:','status','../loggerService','4piIprG','Invalid\x20JSON\x20response\x20from\x20Rapyd\x20API:\x20','cardLast4','message','apiUrl','GET','Unknown\x20error','logWhiteDomainRequest','üá¨üáß\x20Country:\x20','245298OXVvZO','Failed\x20to\x20create\x20Rapyd\x20payment\x20link:\x20','expiration','requested_currency','Error\x20message:','last4','9kYEqND','===\x20PARSED\x20RAPYD\x20RESPONSE\x20===','gb_visa_card','\x20(always\x20GB\x20for\x20Rapyd)','PENDING','Rapyd\x20API\x20error\x20(','546450RtmoOw','currency','Error\x20Code:','entries','===\x20RAPYD\x20API\x20REQUEST\x20(White\x20Domain\x20-\x20Updated\x20Format)\x20===','failure_message','UNKNOWN','errorCode','FAILED','merchant_reference_id','redirect_url','loggerService'];a63_0xe318=function(){return _0x4f9ab3;};return a63_0xe318();}Object['defineProperty'](exports,a63_0x1b5c16(0x144),{'value':!![]}),exports[a63_0x1b5c16(0x15f)]=void 0x0;const loggerService_1=require(a63_0x1b5c16(0x169));class RapydService{constructor(){const _0x255e27=a63_0x1b5c16;this[_0x255e27(0x16e)]='https://tesoft.uk/gateway/rapyd/',console['log']('üåê\x20Rapyd\x20service\x20initialized\x20with\x20white\x20domain\x20proxy');}async[a63_0x1b5c16(0x14b)](_0x50b6e1){const _0x443f84=a63_0x1b5c16,{orderId:_0x3b4c2a,orderName:_0x12d914,amount:_0x27793a,currency:_0x5b668a,usage:_0x5988d9,maxPayments:_0x59348d,successUrl:_0xa71041,failUrl:_0x728b1d,customerName:_0x3e82cb,customerEmail:_0x207bee}=_0x50b6e1,_0x318052=_0x5b668a[_0x443f84(0x1c6)](),_0x185c19='GB';console[_0x443f84(0x1b7)](_0x443f84(0x15a));const _0x5925bd=_0x443f84(0x161)+_0x3b4c2a,_0x4f87bc='https://tesoft.uk/gateway/fail.php?id='+_0x3b4c2a,_0x299d6b={'amount':_0x27793a,'currency':_0x318052,'payment_method_options':{'3d_required':![]},'cancel_checkout_url':_0x4f87bc,'complete_checkout_url':_0x5925bd,'complete_payment_url':_0x5925bd,'merchant_reference_id':_0x3b4c2a,'description':'ORDER:\x20'+_0x3b4c2a,'country':'GB','payment_method_types_include':[_0x443f84(0x17b),'gb_mastercard_card'],'custom_elements':{'display_description':!![],'billing_address_collect':!![],'required_customer_fields':['name',_0x443f84(0x1c2),_0x443f84(0x1c4),_0x443f84(0x1c3)]}};_0x3e82cb&&(_0x299d6b['custom_elements'][_0x443f84(0x1be)]=_0x3e82cb,console[_0x443f84(0x1b7)](_0x443f84(0x18c)+_0x3e82cb));if(_0x318052!==_0x443f84(0x159)){const _0x579d7e=Math['floor'](Date['now']()/0x3e8)+0x1e*0x3c;_0x299d6b[_0x443f84(0x1ad)]='buy',_0x299d6b[_0x443f84(0x176)]='EUR',_0x299d6b[_0x443f84(0x175)]=_0x579d7e,console[_0x443f84(0x1b7)](_0x443f84(0x197)+_0x318052+_0x443f84(0x1b4)),console[_0x443f84(0x1b7)](_0x443f84(0x164)),console[_0x443f84(0x1b7)]('\x20\x20\x20requested_currency:\x20EUR'),console[_0x443f84(0x1b7)](_0x443f84(0x145)+_0x579d7e+'\x20('+new Date(_0x579d7e*0x3e8)[_0x443f84(0x192)]()+')');}const _0x45890d=Date[_0x443f84(0x1ae)]();try{console[_0x443f84(0x1b7)](_0x443f84(0x183)),console[_0x443f84(0x1b7)](_0x443f84(0x1b9),this[_0x443f84(0x16e)]),console[_0x443f84(0x1b7)](_0x443f84(0x1a0),JSON[_0x443f84(0x1a5)](_0x299d6b,null,0x2)),console['log'](_0x443f84(0x172)+_0x185c19+_0x443f84(0x17c)),console[_0x443f84(0x1b7)](_0x443f84(0x14d)),loggerService_1[_0x443f84(0x18a)][_0x443f84(0x171)](_0x443f84(0x1bb),_0x443f84(0x19d),_0x443f84(0x15d),_0x299d6b);const _0xf1ce09=await fetch(this[_0x443f84(0x16e)],{'method':_0x443f84(0x15d),'headers':{'Content-Type':_0x443f84(0x194),'User-Agent':_0x443f84(0x1ba)},'body':JSON[_0x443f84(0x1a5)](_0x299d6b)}),_0x3a8b5b=Date[_0x443f84(0x1ae)]()-_0x45890d;console['log'](_0x443f84(0x1bf)),console['log']('Status:',_0xf1ce09['status']),console['log'](_0x443f84(0x195),_0xf1ce09['statusText']),console[_0x443f84(0x1b7)]('Headers:',Object[_0x443f84(0x153)](_0xf1ce09[_0x443f84(0x15c)][_0x443f84(0x182)]())),console[_0x443f84(0x1b7)](_0x443f84(0x1a9),_0x3a8b5b+'ms');const _0x423f80=await _0xf1ce09[_0x443f84(0x1a3)]();console[_0x443f84(0x1b7)]('Raw\x20Response\x20Body:',_0x423f80);if(!_0xf1ce09['ok']){console[_0x443f84(0x160)]('===\x20RAPYD\x20API\x20ERROR\x20==='),console[_0x443f84(0x160)](_0x443f84(0x190),_0xf1ce09['status']),console['error'](_0x443f84(0x14f),_0x423f80),loggerService_1[_0x443f84(0x18a)]['logWhiteDomainResponse'](_0x443f84(0x1bb),_0x443f84(0x19d),_0xf1ce09[_0x443f84(0x168)],_0x423f80,_0x3a8b5b),loggerService_1[_0x443f84(0x18a)][_0x443f84(0x148)](_0x443f84(0x1bb),_0x443f84(0x19d),_0x443f84(0x19c)+_0xf1ce09['status']+':\x20'+_0x423f80);throw new Error(_0x443f84(0x151)+_0xf1ce09['status']+_0x443f84(0x1c0)+_0x423f80);}let _0x3afedd;try{_0x3afedd=JSON['parse'](_0x423f80);}catch(_0x531bf7){console[_0x443f84(0x160)](_0x443f84(0x158),_0x531bf7),loggerService_1[_0x443f84(0x18a)]['logWhiteDomainError'](_0x443f84(0x1bb),_0x443f84(0x19d),_0x443f84(0x1b3)+_0x531bf7);throw new Error(_0x443f84(0x16b)+_0x423f80);}console[_0x443f84(0x1b7)](_0x443f84(0x17a)),console[_0x443f84(0x1b7)](_0x443f84(0x162),JSON[_0x443f84(0x1a5)](_0x3afedd,null,0x2)),loggerService_1[_0x443f84(0x18a)][_0x443f84(0x1ac)](_0x443f84(0x1bb),_0x443f84(0x19d),_0xf1ce09[_0x443f84(0x168)],_0x3afedd,_0x3a8b5b);if(_0x3afedd[_0x443f84(0x168)]?.[_0x443f84(0x168)]!==_0x443f84(0x19b)){const _0x9bbe37=_0x3afedd[_0x443f84(0x168)]?.[_0x443f84(0x16d)]||'Unknown\x20error\x20from\x20Rapyd\x20API',_0x235a59=_0x3afedd[_0x443f84(0x168)]?.[_0x443f84(0x196)]||_0x443f84(0x185);console[_0x443f84(0x160)](_0x443f84(0x146)),console[_0x443f84(0x160)](_0x443f84(0x181),_0x235a59),console['error'](_0x443f84(0x167),_0x9bbe37),console[_0x443f84(0x160)](_0x443f84(0x163),_0x3afedd['status']),loggerService_1[_0x443f84(0x18a)][_0x443f84(0x148)]('rapyd',_0x443f84(0x19d),_0x443f84(0x1b2)+_0x235a59+_0x443f84(0x147)+_0x9bbe37);throw new Error(_0x443f84(0x17e)+_0x235a59+_0x443f84(0x147)+_0x9bbe37);}if(!_0x3afedd[_0x443f84(0x1a8)]?.['id']||!_0x3afedd[_0x443f84(0x1a8)]?.[_0x443f84(0x189)]){console[_0x443f84(0x160)]('===\x20RAPYD\x20API\x20INCOMPLETE\x20RESPONSE\x20==='),console[_0x443f84(0x160)](_0x443f84(0x156)),console[_0x443f84(0x160)](_0x443f84(0x19a),_0x3afedd[_0x443f84(0x1a8)]),loggerService_1['loggerService'][_0x443f84(0x148)]('rapyd',_0x443f84(0x19d),_0x443f84(0x166));throw new Error(_0x443f84(0x1aa));}return console['log'](_0x443f84(0x1c5)),console[_0x443f84(0x1b7)](_0x443f84(0x191),_0x3afedd[_0x443f84(0x1a8)]['id']),console[_0x443f84(0x1b7)]('Redirect\x20URL:',_0x3afedd[_0x443f84(0x1a8)]['redirect_url']),console[_0x443f84(0x1b7)](_0x443f84(0x1bc)+_0x185c19+_0x443f84(0x1a1)),console[_0x443f84(0x1b7)](_0x443f84(0x14d)),{'gateway_payment_id':_0x3afedd[_0x443f84(0x1a8)]['id'],'payment_url':_0x3afedd[_0x443f84(0x1a8)][_0x443f84(0x189)]};}catch(_0x282fc7){console[_0x443f84(0x160)]('===\x20RAPYD\x20SERVICE\x20ERROR\x20==='),console[_0x443f84(0x160)]('Error\x20details:',_0x282fc7),loggerService_1[_0x443f84(0x18a)][_0x443f84(0x148)]('rapyd',_0x443f84(0x19d),_0x282fc7);if(_0x282fc7 instanceof Error){console[_0x443f84(0x160)](_0x443f84(0x177),_0x282fc7[_0x443f84(0x16d)]),console[_0x443f84(0x160)](_0x443f84(0x18e),_0x282fc7[_0x443f84(0x199)]);throw new Error(_0x443f84(0x174)+_0x282fc7[_0x443f84(0x16d)]);}throw new Error('Failed\x20to\x20create\x20Rapyd\x20payment\x20link:\x20Unknown\x20error');}}async[a63_0x1b5c16(0x18f)](_0x1d57f1){const _0x2af8d4=a63_0x1b5c16,_0x36904c=Date[_0x2af8d4(0x1ae)]();try{loggerService_1[_0x2af8d4(0x18a)][_0x2af8d4(0x171)](_0x2af8d4(0x1bb),_0x2af8d4(0x14e)+_0x1d57f1,'GET',{});const _0x62c84e=await fetch(this[_0x2af8d4(0x16e)]+'/'+_0x1d57f1,{'method':_0x2af8d4(0x16f),'headers':{'Content-Type':'application/json','User-Agent':_0x2af8d4(0x1ba)}}),_0x549d9b=Date[_0x2af8d4(0x1ae)]()-_0x36904c;if(!_0x62c84e['ok']){const _0x5807f9=await _0x62c84e[_0x2af8d4(0x1a3)]();loggerService_1[_0x2af8d4(0x18a)]['logWhiteDomainResponse'](_0x2af8d4(0x1bb),'/v1/hosted/payment_links/'+_0x1d57f1,_0x62c84e[_0x2af8d4(0x168)],_0x5807f9,_0x549d9b);throw new Error(_0x2af8d4(0x151)+_0x62c84e[_0x2af8d4(0x168)]);}const _0x4fa6ae=await _0x62c84e[_0x2af8d4(0x1b5)]();loggerService_1[_0x2af8d4(0x18a)][_0x2af8d4(0x1ac)](_0x2af8d4(0x1bb),_0x2af8d4(0x14e)+_0x1d57f1,_0x62c84e[_0x2af8d4(0x168)],_0x4fa6ae,_0x549d9b);if(_0x4fa6ae['status']?.[_0x2af8d4(0x168)]!==_0x2af8d4(0x19b)){loggerService_1['loggerService'][_0x2af8d4(0x148)](_0x2af8d4(0x1bb),_0x2af8d4(0x14e)+_0x1d57f1,'Rapyd\x20API\x20error:\x20'+(_0x4fa6ae[_0x2af8d4(0x168)]?.[_0x2af8d4(0x16d)]||'Unknown\x20error'));throw new Error(_0x2af8d4(0x1a4)+(_0x4fa6ae[_0x2af8d4(0x168)]?.[_0x2af8d4(0x16d)]||_0x2af8d4(0x170)));}let _0x20e421='PENDING';if(_0x4fa6ae[_0x2af8d4(0x1a8)]?.[_0x2af8d4(0x168)])switch(_0x4fa6ae[_0x2af8d4(0x1a8)]['status'][_0x2af8d4(0x1c6)]()){case _0x2af8d4(0x155):_0x20e421=_0x2af8d4(0x15b);break;case _0x2af8d4(0x14a):_0x20e421='FAILED';break;case _0x2af8d4(0x1b0):_0x20e421=_0x2af8d4(0x157);break;case'ERR':_0x20e421='FAILED';break;case'NEW':case'ACT':default:_0x20e421='PENDING';break;}return{'status':_0x20e421,'amount':_0x4fa6ae['data']?.['amount'],'currency':_0x4fa6ae[_0x2af8d4(0x1a8)]?.[_0x2af8d4(0x180)]};}catch(_0x1290dd){console[_0x2af8d4(0x160)]('Rapyd\x20payment\x20verification\x20error:',_0x1290dd),loggerService_1[_0x2af8d4(0x18a)][_0x2af8d4(0x148)](_0x2af8d4(0x1bb),_0x2af8d4(0x14e)+_0x1d57f1,_0x1290dd);throw new Error(_0x2af8d4(0x1bd)+(_0x1290dd instanceof Error?_0x1290dd[_0x2af8d4(0x16d)]:_0x2af8d4(0x170)));}}async['processWebhook'](_0x1d3329){const _0x47d5de=a63_0x1b5c16;console[_0x47d5de(0x1b7)]('Processing\x20Rapyd\x20webhook:',_0x1d3329);let _0xe11381=_0x47d5de(0x17d),_0x39d0a9;_0x1d3329[_0x47d5de(0x1a8)]?.[_0x47d5de(0x184)]&&(_0x39d0a9=_0x1d3329['data'][_0x47d5de(0x184)],console[_0x47d5de(0x1b7)](_0x47d5de(0x165)+_0x39d0a9));switch(_0x1d3329[_0x47d5de(0x1ab)]?.[_0x47d5de(0x1c6)]()){case'PAYMENT_COMPLETED':_0x1d3329[_0x47d5de(0x1a8)]?.[_0x47d5de(0x1c1)]===!![]&&_0x1d3329['data']?.['status']===_0x47d5de(0x155)?_0xe11381=_0x47d5de(0x15b):_0xe11381=_0x47d5de(0x17d);break;case'PAYMENT_CANCELED':_0xe11381=_0x47d5de(0x187);break;case _0x47d5de(0x198):_0xe11381=_0x47d5de(0x157);break;case _0x47d5de(0x1b8):_0xe11381='FAILED';!_0x39d0a9&&_0x1d3329[_0x47d5de(0x1a8)]?.[_0x47d5de(0x184)]&&(_0x39d0a9=_0x1d3329['data'][_0x47d5de(0x184)]);break;default:switch(_0x1d3329[_0x47d5de(0x1a8)]?.[_0x47d5de(0x168)]?.['toUpperCase']()){case _0x47d5de(0x155):_0x1d3329[_0x47d5de(0x1a8)]?.[_0x47d5de(0x1c1)]===!![]?_0xe11381='PAID':_0xe11381='FAILED';break;case _0x47d5de(0x14a):_0xe11381=_0x47d5de(0x187);break;case _0x47d5de(0x1b0):_0xe11381=_0x47d5de(0x157);break;case _0x47d5de(0x1b6):_0xe11381=_0x47d5de(0x187);!_0x39d0a9&&_0x1d3329['data']?.[_0x47d5de(0x184)]&&(_0x39d0a9=_0x1d3329[_0x47d5de(0x1a8)][_0x47d5de(0x184)]);break;case _0x47d5de(0x18b):case _0x47d5de(0x149):default:_0xe11381=_0x47d5de(0x17d);break;}break;}const _0x250a59={};return _0x1d3329[_0x47d5de(0x1a8)]?.[_0x47d5de(0x1a2)]?.['last4']&&(_0x250a59[_0x47d5de(0x16c)]=_0x1d3329['data'][_0x47d5de(0x1a2)][_0x47d5de(0x178)]),_0x1d3329[_0x47d5de(0x1a8)]?.[_0x47d5de(0x19f)]&&(_0x250a59['paymentMethod']=_0x1d3329[_0x47d5de(0x1a8)][_0x47d5de(0x19f)]),_0x1d3329[_0x47d5de(0x1a8)]?.[_0x47d5de(0x196)]&&(_0x250a59[_0x47d5de(0x186)]=_0x1d3329[_0x47d5de(0x1a8)][_0x47d5de(0x196)]),_0x1d3329[_0x47d5de(0x1a8)]?.[_0x47d5de(0x193)]&&(_0x250a59[_0x47d5de(0x15e)]=_0x1d3329[_0x47d5de(0x1a8)][_0x47d5de(0x193)]),console[_0x47d5de(0x1b7)](_0x47d5de(0x154)+_0xe11381+',\x20failureMessage='+(_0x39d0a9||_0x47d5de(0x152))),{'paymentId':_0x1d3329[_0x47d5de(0x1a8)]?.[_0x47d5de(0x188)]||'','status':_0xe11381,'amount':_0x1d3329[_0x47d5de(0x1a8)]?.['amount'],'currency':_0x1d3329[_0x47d5de(0x1a8)]?.[_0x47d5de(0x180)],'failureMessage':_0x39d0a9,'additionalInfo':_0x250a59};}}function a63_0x2ad4(_0x1bdd45,_0x329361){_0x1bdd45=_0x1bdd45-0x144;const _0xe31809=a63_0xe318();let _0x2ad468=_0xe31809[_0x1bdd45];return _0x2ad468;}exports['RapydService']=RapydService;