'use strict';const a46_0x27378a=a46_0x5660;function a46_0x5660(_0x250887,_0x568087){const _0x5f2cb5=a46_0x5f2c();return a46_0x5660=function(_0x566050,_0x2d7986){_0x566050=_0x566050-0x198;let _0x4cfec4=_0x5f2cb5[_0x566050];return _0x4cfec4;},a46_0x5660(_0x250887,_0x568087);}function a46_0x5f2c(){const _0x3c8d9b=['Response\x20Body:','2912lbapiy','toUpperCase','Payment\x20Link\x20ID:','stack','FAILED','üí≥\x20Payment\x20Methods:\x20gb_visa_card,\x20gb_mastercard_card','Failed\x20to\x20verify\x20Rapyd\x20payment:\x20','142QkcaEE','json','===\x20RAPYD\x20SUCCESS\x20===','payment_method_type','gb_mastercard_card','===\x20RAPYD\x20API\x20BUSINESS\x20ERROR\x20===','Request\x20Body\x20(Updated\x20Format):','now','üá¨üáß\x20Country\x20used:\x20','logWhiteDomainResponse','rapyd','https://tesoft.uk/gateway/success.php?id=','Failed\x20to\x20parse\x20JSON\x20response:','Unknown\x20error','statusText','NEW','Error\x20Message:','defineProperty','CAN','Rapyd\x20API\x20error:\x20','headers','none','11DQnqCH','payment_method_data',',\x20body:\x20','===\x20RAPYD\x20API\x20ERROR\x20===','verifyPayment','EXPIRED','entries','üí•\x20Rapyd\x20failure\x20message:\x20','Headers:','parse','531YpgAmL','UNKNOWN','\x20(GB\x20-\x20Britain)','ACT','Unknown\x20error\x20from\x20Rapyd\x20API','1878005jAdwuy','logWhiteDomainError','CLO','123390aECPwv','416406OMvxOx','text','Processing\x20Rapyd\x20webhook:','HTTP\x20Status:','failureCode','Business\x20Error\x20(','2010552aYjqGH','message','createPaymentLink','data','EXP','status','PAYMENT_CANCELED','stringify','log','failure_code','apiUrl','===\x20RAPYD\x20API\x20REQUEST\x20(White\x20Domain\x20-\x20Updated\x20Format)\x20===','===\x20RAPYD\x20API\x20INCOMPLETE\x20RESPONSE\x20===','90BNkgwN','Full\x20Error\x20Data:','loggerService','SUCCESS','merchant_reference_id','Error\x20stack:','type','Error\x20Code:','fromEntries','URL:','https://tesoft.uk/gateway/fail.php?id=','üîÑ\x20Rapyd\x20webhook\x20processed:\x20status=','error','paid','===\x20PARSED\x20RAPYD\x20RESPONSE\x20===','amount','redirect_url','Status:','/v1/hosted/payment_links','RapydService','processWebhook','PAYMENT_COMPLETED','Invalid\x20response\x20from\x20Rapyd\x20API:\x20missing\x20id\x20or\x20redirect_url','üá¨üáß\x20Country:\x20','Failed\x20to\x20create\x20Rapyd\x20payment\x20link:\x20','204712LYbxuP','603FBVWHg','Invalid\x20JSON\x20response\x20from\x20Rapyd\x20API:\x20','HTTP\x20error!\x20status:\x20','Response\x20Time:','===\x20RAPYD\x20SERVICE\x20ERROR\x20===','PENDING','üåê\x20Rapyd\x20service\x20initialized\x20with\x20white\x20domain\x20proxy','Rapyd\x20API\x20error\x20(','HTTP\x20','logWhiteDomainRequest','PAYMENT_FAILED','TesSoft\x20Payment\x20System/1.0','last4','error_code','paymentMethod','../loggerService','ORDER:\x20','üá¨üáß\x20Using\x20GB\x20(Britain)\x20as\x20country\x20for\x20Rapyd\x20payment\x20link',',\x20failureMessage=','POST','__esModule','/v1/hosted/payment_links/','GET','currency','Status\x20Text:','Rapyd\x20payment\x20verification\x20error:','failure_message','28AAlpYi','):\x20','errorCode','\x20(always\x20GB\x20for\x20Rapyd)'];a46_0x5f2c=function(){return _0x3c8d9b;};return a46_0x5f2c();}(function(_0x5a561d,_0x2202d4){const _0x4132b2=a46_0x5660,_0x1d7db9=_0x5a561d();while(!![]){try{const _0x4f5362=-parseInt(_0x4132b2(0x1f2))/0x1*(-parseInt(_0x4132b2(0x19c))/0x2)+-parseInt(_0x4132b2(0x1bc))/0x3*(-parseInt(_0x4132b2(0x212))/0x4)+parseInt(_0x4132b2(0x1c1))/0x5+parseInt(_0x4132b2(0x1c5))/0x6+-parseInt(_0x4132b2(0x20d))/0x7*(parseInt(_0x4132b2(0x1f1))/0x8)+-parseInt(_0x4132b2(0x1c4))/0x9*(parseInt(_0x4132b2(0x1d8))/0xa)+parseInt(_0x4132b2(0x1b2))/0xb*(-parseInt(_0x4132b2(0x1cb))/0xc);if(_0x4f5362===_0x2202d4)break;else _0x1d7db9['push'](_0x1d7db9['shift']());}catch(_0x3a0a70){_0x1d7db9['push'](_0x1d7db9['shift']());}}}(a46_0x5f2c,0x36893));Object[a46_0x27378a(0x1ad)](exports,a46_0x27378a(0x206),{'value':!![]}),exports[a46_0x27378a(0x1eb)]=void 0x0;const loggerService_1=require(a46_0x27378a(0x201));class RapydService{constructor(){const _0x243caf=a46_0x27378a;this[_0x243caf(0x1d5)]='https://tesoft.uk/gateway/rapyd/',console[_0x243caf(0x1d3)](_0x243caf(0x1f8));}async[a46_0x27378a(0x1cd)](_0x3f4235){const _0x53a0a4=a46_0x27378a,{orderId:_0x58e882,orderName:_0x27a04c,amount:_0x4ca8e8,currency:_0x56efa3,usage:_0xe4b1c5,maxPayments:_0x4f5d10,successUrl:_0x491a80,failUrl:_0x3bc12f}=_0x3f4235,_0xf671de=_0x56efa3[_0x53a0a4(0x213)](),_0x70c37c='GB';console[_0x53a0a4(0x1d3)](_0x53a0a4(0x203));const _0xf26b1e=_0x53a0a4(0x1a7)+_0x58e882,_0x12dc40=_0x53a0a4(0x1e2)+_0x58e882,_0x110ab6={'amount':_0x4ca8e8,'currency':_0xf671de,'cancel_checkout_url':_0x12dc40,'complete_checkout_url':_0xf26b1e,'complete_payment_url':_0xf26b1e,'merchant_reference_id':_0x58e882,'description':_0x53a0a4(0x202)+_0x58e882,'country':'GB','payment_method_types_include':['gb_visa_card',_0x53a0a4(0x1a0)],'custom_elements':{'display_description':!![]}},_0x31d2b6=Date[_0x53a0a4(0x1a3)]();try{console[_0x53a0a4(0x1d3)](_0x53a0a4(0x1d6)),console[_0x53a0a4(0x1d3)](_0x53a0a4(0x1e1),this[_0x53a0a4(0x1d5)]),console[_0x53a0a4(0x1d3)](_0x53a0a4(0x1a2),JSON[_0x53a0a4(0x1d2)](_0x110ab6,null,0x2)),console[_0x53a0a4(0x1d3)](_0x53a0a4(0x1ef)+_0x70c37c+_0x53a0a4(0x210)),console['log']('üí≥\x20Payment\x20Methods:\x20gb_visa_card,\x20gb_mastercard_card'),loggerService_1['loggerService']['logWhiteDomainRequest'](_0x53a0a4(0x1a6),_0x53a0a4(0x1ea),_0x53a0a4(0x205),_0x110ab6);const _0x4360de=await fetch(this[_0x53a0a4(0x1d5)],{'method':'POST','headers':{'Content-Type':'application/json','User-Agent':_0x53a0a4(0x1fd)},'body':JSON[_0x53a0a4(0x1d2)](_0x110ab6)}),_0x3f93cb=Date[_0x53a0a4(0x1a3)]()-_0x31d2b6;console['log']('===\x20RAPYD\x20API\x20RESPONSE\x20(White\x20Domain)\x20==='),console['log'](_0x53a0a4(0x1e9),_0x4360de[_0x53a0a4(0x1d0)]),console['log'](_0x53a0a4(0x20a),_0x4360de[_0x53a0a4(0x1aa)]),console[_0x53a0a4(0x1d3)](_0x53a0a4(0x1ba),Object[_0x53a0a4(0x1e0)](_0x4360de[_0x53a0a4(0x1b0)][_0x53a0a4(0x1b8)]())),console[_0x53a0a4(0x1d3)](_0x53a0a4(0x1f5),_0x3f93cb+'ms');const _0xfaeea9=await _0x4360de[_0x53a0a4(0x1c6)]();console[_0x53a0a4(0x1d3)]('Raw\x20Response\x20Body:',_0xfaeea9);if(!_0x4360de['ok']){console[_0x53a0a4(0x1e4)](_0x53a0a4(0x1b5)),console[_0x53a0a4(0x1e4)](_0x53a0a4(0x1c8),_0x4360de['status']),console['error'](_0x53a0a4(0x211),_0xfaeea9),loggerService_1[_0x53a0a4(0x1da)]['logWhiteDomainResponse'](_0x53a0a4(0x1a6),'/v1/hosted/payment_links',_0x4360de[_0x53a0a4(0x1d0)],_0xfaeea9,_0x3f93cb),loggerService_1[_0x53a0a4(0x1da)][_0x53a0a4(0x1c2)]('rapyd',_0x53a0a4(0x1ea),_0x53a0a4(0x1fa)+_0x4360de['status']+':\x20'+_0xfaeea9);throw new Error(_0x53a0a4(0x1f4)+_0x4360de['status']+_0x53a0a4(0x1b4)+_0xfaeea9);}let _0x4505f4;try{_0x4505f4=JSON[_0x53a0a4(0x1bb)](_0xfaeea9);}catch(_0x50c415){console['error'](_0x53a0a4(0x1a8),_0x50c415),loggerService_1['loggerService'][_0x53a0a4(0x1c2)](_0x53a0a4(0x1a6),_0x53a0a4(0x1ea),'JSON\x20Parse\x20Error:\x20'+_0x50c415);throw new Error(_0x53a0a4(0x1f3)+_0xfaeea9);}console[_0x53a0a4(0x1d3)](_0x53a0a4(0x1e6)),console['log']('Parsed\x20Result:',JSON[_0x53a0a4(0x1d2)](_0x4505f4,null,0x2)),loggerService_1['loggerService'][_0x53a0a4(0x1a5)](_0x53a0a4(0x1a6),_0x53a0a4(0x1ea),_0x4360de[_0x53a0a4(0x1d0)],_0x4505f4,_0x3f93cb);if(_0x4505f4[_0x53a0a4(0x1d0)]?.['status']!==_0x53a0a4(0x1db)){const _0x3e4c93=_0x4505f4['status']?.[_0x53a0a4(0x1cc)]||_0x53a0a4(0x1c0),_0x2e857e=_0x4505f4[_0x53a0a4(0x1d0)]?.[_0x53a0a4(0x1ff)]||_0x53a0a4(0x1bd);console[_0x53a0a4(0x1e4)](_0x53a0a4(0x1a1)),console[_0x53a0a4(0x1e4)](_0x53a0a4(0x1df),_0x2e857e),console[_0x53a0a4(0x1e4)](_0x53a0a4(0x1ac),_0x3e4c93),console[_0x53a0a4(0x1e4)](_0x53a0a4(0x1d9),_0x4505f4['status']),loggerService_1['loggerService']['logWhiteDomainError']('rapyd','/v1/hosted/payment_links',_0x53a0a4(0x1ca)+_0x2e857e+_0x53a0a4(0x20e)+_0x3e4c93);throw new Error(_0x53a0a4(0x1f9)+_0x2e857e+_0x53a0a4(0x20e)+_0x3e4c93);}if(!_0x4505f4['data']?.['id']||!_0x4505f4[_0x53a0a4(0x1ce)]?.['redirect_url']){console[_0x53a0a4(0x1e4)](_0x53a0a4(0x1d7)),console[_0x53a0a4(0x1e4)]('Missing\x20id\x20or\x20redirect_url\x20in\x20response'),console[_0x53a0a4(0x1e4)]('Response\x20data:',_0x4505f4[_0x53a0a4(0x1ce)]),loggerService_1[_0x53a0a4(0x1da)][_0x53a0a4(0x1c2)](_0x53a0a4(0x1a6),'/v1/hosted/payment_links','Incomplete\x20response:\x20missing\x20id\x20or\x20redirect_url');throw new Error(_0x53a0a4(0x1ee));}return console['log'](_0x53a0a4(0x19e)),console[_0x53a0a4(0x1d3)](_0x53a0a4(0x214),_0x4505f4['data']['id']),console['log']('Redirect\x20URL:',_0x4505f4[_0x53a0a4(0x1ce)][_0x53a0a4(0x1e8)]),console['log'](_0x53a0a4(0x1a4)+_0x70c37c+_0x53a0a4(0x1be)),console[_0x53a0a4(0x1d3)](_0x53a0a4(0x19a)),{'gateway_payment_id':_0x4505f4[_0x53a0a4(0x1ce)]['id'],'payment_url':_0x4505f4['data'][_0x53a0a4(0x1e8)]};}catch(_0x32ad5d){console[_0x53a0a4(0x1e4)](_0x53a0a4(0x1f6)),console[_0x53a0a4(0x1e4)]('Error\x20details:',_0x32ad5d),loggerService_1[_0x53a0a4(0x1da)][_0x53a0a4(0x1c2)](_0x53a0a4(0x1a6),_0x53a0a4(0x1ea),_0x32ad5d);if(_0x32ad5d instanceof Error){console['error']('Error\x20message:',_0x32ad5d[_0x53a0a4(0x1cc)]),console['error'](_0x53a0a4(0x1dd),_0x32ad5d[_0x53a0a4(0x198)]);throw new Error(_0x53a0a4(0x1f0)+_0x32ad5d[_0x53a0a4(0x1cc)]);}throw new Error('Failed\x20to\x20create\x20Rapyd\x20payment\x20link:\x20Unknown\x20error');}}async[a46_0x27378a(0x1b6)](_0x169d72){const _0x2a02bd=a46_0x27378a,_0xedd8b0=Date[_0x2a02bd(0x1a3)]();try{loggerService_1[_0x2a02bd(0x1da)][_0x2a02bd(0x1fb)]('rapyd',_0x2a02bd(0x207)+_0x169d72,_0x2a02bd(0x208),{});const _0x26399b=await fetch(this[_0x2a02bd(0x1d5)]+'/'+_0x169d72,{'method':_0x2a02bd(0x208),'headers':{'Content-Type':'application/json','User-Agent':_0x2a02bd(0x1fd)}}),_0x280cff=Date[_0x2a02bd(0x1a3)]()-_0xedd8b0;if(!_0x26399b['ok']){const _0x15c5e7=await _0x26399b[_0x2a02bd(0x1c6)]();loggerService_1['loggerService'][_0x2a02bd(0x1a5)]('rapyd','/v1/hosted/payment_links/'+_0x169d72,_0x26399b[_0x2a02bd(0x1d0)],_0x15c5e7,_0x280cff);throw new Error('HTTP\x20error!\x20status:\x20'+_0x26399b[_0x2a02bd(0x1d0)]);}const _0x2a41c7=await _0x26399b[_0x2a02bd(0x19d)]();loggerService_1[_0x2a02bd(0x1da)][_0x2a02bd(0x1a5)](_0x2a02bd(0x1a6),_0x2a02bd(0x207)+_0x169d72,_0x26399b['status'],_0x2a41c7,_0x280cff);if(_0x2a41c7['status']?.[_0x2a02bd(0x1d0)]!==_0x2a02bd(0x1db)){loggerService_1['loggerService'][_0x2a02bd(0x1c2)](_0x2a02bd(0x1a6),_0x2a02bd(0x207)+_0x169d72,_0x2a02bd(0x1af)+(_0x2a41c7['status']?.[_0x2a02bd(0x1cc)]||_0x2a02bd(0x1a9)));throw new Error('Rapyd\x20API\x20error:\x20'+(_0x2a41c7['status']?.['message']||_0x2a02bd(0x1a9)));}let _0x18e902=_0x2a02bd(0x1f7);if(_0x2a41c7['data']?.[_0x2a02bd(0x1d0)])switch(_0x2a41c7[_0x2a02bd(0x1ce)][_0x2a02bd(0x1d0)]['toUpperCase']()){case _0x2a02bd(0x1c3):_0x18e902='PAID';break;case _0x2a02bd(0x1ae):_0x18e902='FAILED';break;case _0x2a02bd(0x1cf):_0x18e902=_0x2a02bd(0x1b7);break;case'ERR':_0x18e902=_0x2a02bd(0x199);break;case _0x2a02bd(0x1ab):case _0x2a02bd(0x1bf):default:_0x18e902=_0x2a02bd(0x1f7);break;}return{'status':_0x18e902,'amount':_0x2a41c7[_0x2a02bd(0x1ce)]?.['amount'],'currency':_0x2a41c7['data']?.[_0x2a02bd(0x209)]};}catch(_0x28d523){console[_0x2a02bd(0x1e4)](_0x2a02bd(0x20b),_0x28d523),loggerService_1[_0x2a02bd(0x1da)][_0x2a02bd(0x1c2)](_0x2a02bd(0x1a6),_0x2a02bd(0x207)+_0x169d72,_0x28d523);throw new Error(_0x2a02bd(0x19b)+(_0x28d523 instanceof Error?_0x28d523['message']:_0x2a02bd(0x1a9)));}}async[a46_0x27378a(0x1ec)](_0xcf2658){const _0x3de022=a46_0x27378a;console[_0x3de022(0x1d3)](_0x3de022(0x1c7),_0xcf2658);let _0xea94e9=_0x3de022(0x1f7),_0xece1d6;_0xcf2658['data']?.['failure_message']&&(_0xece1d6=_0xcf2658['data'][_0x3de022(0x20c)],console[_0x3de022(0x1d3)](_0x3de022(0x1b9)+_0xece1d6));switch(_0xcf2658[_0x3de022(0x1de)]?.[_0x3de022(0x213)]()){case _0x3de022(0x1ed):_0xcf2658['data']?.[_0x3de022(0x1e5)]===!![]&&_0xcf2658[_0x3de022(0x1ce)]?.[_0x3de022(0x1d0)]==='CLO'?_0xea94e9='PAID':_0xea94e9=_0x3de022(0x1f7);break;case _0x3de022(0x1d1):_0xea94e9=_0x3de022(0x199);break;case'PAYMENT_EXPIRED':_0xea94e9=_0x3de022(0x1b7);break;case _0x3de022(0x1fc):_0xea94e9=_0x3de022(0x199);!_0xece1d6&&_0xcf2658[_0x3de022(0x1ce)]?.['failure_message']&&(_0xece1d6=_0xcf2658[_0x3de022(0x1ce)][_0x3de022(0x20c)]);break;default:switch(_0xcf2658[_0x3de022(0x1ce)]?.['status']?.['toUpperCase']()){case _0x3de022(0x1c3):_0xcf2658[_0x3de022(0x1ce)]?.['paid']===!![]?_0xea94e9='PAID':_0xea94e9=_0x3de022(0x199);break;case _0x3de022(0x1ae):_0xea94e9=_0x3de022(0x199);break;case'EXP':_0xea94e9=_0x3de022(0x1b7);break;case'ERR':_0xea94e9=_0x3de022(0x199);!_0xece1d6&&_0xcf2658[_0x3de022(0x1ce)]?.['failure_message']&&(_0xece1d6=_0xcf2658[_0x3de022(0x1ce)]['failure_message']);break;case _0x3de022(0x1ab):case _0x3de022(0x1bf):default:_0xea94e9=_0x3de022(0x1f7);break;}break;}const _0x53684e={};return _0xcf2658[_0x3de022(0x1ce)]?.['payment_method_data']?.['last4']&&(_0x53684e['cardLast4']=_0xcf2658[_0x3de022(0x1ce)][_0x3de022(0x1b3)][_0x3de022(0x1fe)]),_0xcf2658[_0x3de022(0x1ce)]?.[_0x3de022(0x19f)]&&(_0x53684e[_0x3de022(0x200)]=_0xcf2658[_0x3de022(0x1ce)][_0x3de022(0x19f)]),_0xcf2658[_0x3de022(0x1ce)]?.['error_code']&&(_0x53684e[_0x3de022(0x20f)]=_0xcf2658[_0x3de022(0x1ce)]['error_code']),_0xcf2658[_0x3de022(0x1ce)]?.['failure_code']&&(_0x53684e[_0x3de022(0x1c9)]=_0xcf2658[_0x3de022(0x1ce)][_0x3de022(0x1d4)]),console[_0x3de022(0x1d3)](_0x3de022(0x1e3)+_0xea94e9+_0x3de022(0x204)+(_0xece1d6||_0x3de022(0x1b1))),{'paymentId':_0xcf2658[_0x3de022(0x1ce)]?.[_0x3de022(0x1dc)]||'','status':_0xea94e9,'amount':_0xcf2658[_0x3de022(0x1ce)]?.[_0x3de022(0x1e7)],'currency':_0xcf2658[_0x3de022(0x1ce)]?.[_0x3de022(0x209)],'failureMessage':_0xece1d6,'additionalInfo':_0x53684e};}}exports[a46_0x27378a(0x1eb)]=RapydService;