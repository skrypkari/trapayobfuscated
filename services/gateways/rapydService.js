'use strict';const a45_0xf9c70b=a45_0x57e3;(function(_0x53b241,_0x18fa2c){const _0x512630=a45_0x57e3,_0x1b3738=_0x53b241();while(!![]){try{const _0x25018e=-parseInt(_0x512630(0x1ad))/0x1+-parseInt(_0x512630(0x1a5))/0x2*(parseInt(_0x512630(0x1c5))/0x3)+-parseInt(_0x512630(0x169))/0x4*(-parseInt(_0x512630(0x17f))/0x5)+-parseInt(_0x512630(0x1ae))/0x6*(parseInt(_0x512630(0x171))/0x7)+parseInt(_0x512630(0x170))/0x8*(parseInt(_0x512630(0x1b6))/0x9)+-parseInt(_0x512630(0x17e))/0xa+parseInt(_0x512630(0x1d4))/0xb*(parseInt(_0x512630(0x160))/0xc);if(_0x25018e===_0x18fa2c)break;else _0x1b3738['push'](_0x1b3738['shift']());}catch(_0x105551){_0x1b3738['push'](_0x1b3738['shift']());}}}(a45_0x3371,0xd1909));function a45_0x57e3(_0x4c349c,_0x559630){const _0x337121=a45_0x3371();return a45_0x57e3=function(_0x57e3c2,_0x4f1dfd){_0x57e3c2=_0x57e3c2-0x15b;let _0x592f60=_0x337121[_0x57e3c2];return _0x592f60;},a45_0x57e3(_0x4c349c,_0x559630);}function a45_0x3371(){const _0x4dd2ed=['ORDER:\x20','UNKNOWN','üåê\x20Rapyd\x20service\x20initialized\x20with\x20white\x20domain\x20proxy','Error\x20Code:','EXPIRED','fromEntries','Failed\x20to\x20create\x20Rapyd\x20payment\x20link:\x20Unknown\x20error','üí•\x20Rapyd\x20failure\x20message:\x20','failure_code','102DubcCo','Request\x20Body\x20(Updated\x20Format):','https://tesoft.uk/gateway/success.php?id=','entries','HTTP\x20error!\x20status:\x20','now','Error\x20stack:','Response\x20Body:','1531823xVSuSd','5624886jysPVn','Payment\x20Link\x20ID:','===\x20RAPYD\x20API\x20REQUEST\x20(White\x20Domain\x20-\x20Updated\x20Format)\x20===','Full\x20Error\x20Data:','Parsed\x20Result:','ERR','logWhiteDomainResponse','Missing\x20id\x20or\x20redirect_url\x20in\x20response','18ZpxEbm',',\x20failureMessage=','Incomplete\x20response:\x20missing\x20id\x20or\x20redirect_url','payment_method_type','stringify','TesSoft\x20Payment\x20System/1.0','CLO','log','SUCCESS','Rapyd\x20API\x20error\x20(','PAYMENT_CANCELED','PAID','status','===\x20RAPYD\x20SUCCESS\x20===','RapydService','68205uITvqg','PENDING','loggerService','ACT','Status:','Error\x20details:','last4','===\x20RAPYD\x20SERVICE\x20ERROR\x20===','NEW',',\x20body:\x20','EXP','üîÑ\x20Rapyd\x20webhook\x20processed:\x20status=','data','errorCode','/v1/hosted/payment_links/','11WbWIVm','message','apiUrl','payment_method_data','../loggerService','Error\x20Message:','PAYMENT_COMPLETED','===\x20RAPYD\x20API\x20BUSINESS\x20ERROR\x20===','38475204XAmsHf','Redirect\x20URL:','none','__esModule','amount','HTTP\x20','logWhiteDomainError','üí≥\x20Payment\x20Methods:\x20gb_visa_card,\x20gb_mastercard_card','defineProperty','748812ElGqnO','gb_mastercard_card','GET','paid','https://tesoft.uk/gateway/rapyd/','JSON\x20Parse\x20Error:\x20','POST','4132120jPWzfR','7rMTNyp','Error\x20message:','Invalid\x20response\x20from\x20Rapyd\x20API:\x20missing\x20id\x20or\x20redirect_url','):\x20','Response\x20data:','Processing\x20Rapyd\x20webhook:','Invalid\x20JSON\x20response\x20from\x20Rapyd\x20API:\x20','application/json','paymentMethod','type','Unknown\x20error','text','\x20(always\x20GB\x20for\x20Rapyd)','8753490ceszzq','30IhYjwB','rapyd','redirect_url','Headers:','Failed\x20to\x20verify\x20Rapyd\x20payment:\x20','Unknown\x20error\x20from\x20Rapyd\x20API','üá¨üáß\x20Using\x20GB\x20(Britain)\x20as\x20country\x20for\x20Rapyd\x20payment\x20link','Status\x20Text:','headers','error_code','===\x20RAPYD\x20API\x20RESPONSE\x20(White\x20Domain)\x20===','/v1/hosted/payment_links','json','currency','toUpperCase','logWhiteDomainRequest','FAILED','CAN','Rapyd\x20API\x20error:\x20','error','\x20(GB\x20-\x20Britain)','Response\x20Time:','Failed\x20to\x20create\x20Rapyd\x20payment\x20link:\x20','PAYMENT_FAILED','failure_message','statusText','verifyPayment','PAYMENT_EXPIRED','===\x20RAPYD\x20API\x20ERROR\x20==='];a45_0x3371=function(){return _0x4dd2ed;};return a45_0x3371();}Object[a45_0xf9c70b(0x168)](exports,a45_0xf9c70b(0x163),{'value':!![]}),exports[a45_0xf9c70b(0x1c4)]=void 0x0;const loggerService_1=require(a45_0xf9c70b(0x15c));class RapydService{constructor(){const _0x59489b=a45_0xf9c70b;this['apiUrl']=_0x59489b(0x16d),console[_0x59489b(0x1bd)](_0x59489b(0x19e));}async['createPaymentLink'](_0x2a7a46){const _0x4b3518=a45_0xf9c70b,{orderId:_0x5b399c,orderName:_0x56caf4,amount:_0x1b79cc,currency:_0x524917,usage:_0x1feeb7,maxPayments:_0x4de199,successUrl:_0x3fe38f,failUrl:_0x8a18e}=_0x2a7a46,_0x318c04=_0x524917[_0x4b3518(0x18d)](),_0x45b1af='GB';console['log'](_0x4b3518(0x185));const _0x3ef390=_0x4b3518(0x1a7)+_0x5b399c,_0x4acd5b='https://tesoft.uk/gateway/fail.php?id='+_0x5b399c,_0x27f10b={'amount':_0x1b79cc,'currency':_0x318c04,'cancel_checkout_url':_0x4acd5b,'complete_checkout_url':_0x3ef390,'complete_payment_url':_0x3ef390,'merchant_reference_id':_0x5b399c,'description':_0x4b3518(0x19c)+_0x5b399c,'country':'GB','payment_method_types_include':['gb_visa_card',_0x4b3518(0x16a)],'custom_elements':{'display_description':!![]}},_0x6c4f22=Date[_0x4b3518(0x1aa)]();try{console[_0x4b3518(0x1bd)](_0x4b3518(0x1b0)),console['log']('URL:',this[_0x4b3518(0x1d6)]),console[_0x4b3518(0x1bd)](_0x4b3518(0x1a6),JSON[_0x4b3518(0x1ba)](_0x27f10b,null,0x2)),console[_0x4b3518(0x1bd)]('üá¨üáß\x20Country:\x20'+_0x45b1af+_0x4b3518(0x17d)),console[_0x4b3518(0x1bd)](_0x4b3518(0x167)),loggerService_1[_0x4b3518(0x1c7)][_0x4b3518(0x18e)]('rapyd',_0x4b3518(0x18a),_0x4b3518(0x16f),_0x27f10b);const _0x5a783a=await fetch(this[_0x4b3518(0x1d6)],{'method':_0x4b3518(0x16f),'headers':{'Content-Type':'application/json','User-Agent':_0x4b3518(0x1bb)},'body':JSON[_0x4b3518(0x1ba)](_0x27f10b)}),_0x223e7d=Date[_0x4b3518(0x1aa)]()-_0x6c4f22;console[_0x4b3518(0x1bd)](_0x4b3518(0x189)),console[_0x4b3518(0x1bd)](_0x4b3518(0x1c9),_0x5a783a[_0x4b3518(0x1c2)]),console[_0x4b3518(0x1bd)](_0x4b3518(0x186),_0x5a783a[_0x4b3518(0x198)]),console[_0x4b3518(0x1bd)](_0x4b3518(0x182),Object[_0x4b3518(0x1a1)](_0x5a783a[_0x4b3518(0x187)][_0x4b3518(0x1a8)]())),console[_0x4b3518(0x1bd)](_0x4b3518(0x194),_0x223e7d+'ms');const _0x4de479=await _0x5a783a[_0x4b3518(0x17c)]();console['log']('Raw\x20Response\x20Body:',_0x4de479);if(!_0x5a783a['ok']){console[_0x4b3518(0x192)](_0x4b3518(0x19b)),console[_0x4b3518(0x192)]('HTTP\x20Status:',_0x5a783a['status']),console[_0x4b3518(0x192)](_0x4b3518(0x1ac),_0x4de479),loggerService_1['loggerService'][_0x4b3518(0x1b4)](_0x4b3518(0x180),_0x4b3518(0x18a),_0x5a783a['status'],_0x4de479,_0x223e7d),loggerService_1['loggerService'][_0x4b3518(0x166)]('rapyd',_0x4b3518(0x18a),_0x4b3518(0x165)+_0x5a783a[_0x4b3518(0x1c2)]+':\x20'+_0x4de479);throw new Error(_0x4b3518(0x1a9)+_0x5a783a[_0x4b3518(0x1c2)]+_0x4b3518(0x1ce)+_0x4de479);}let _0x8f433c;try{_0x8f433c=JSON['parse'](_0x4de479);}catch(_0x56846d){console['error']('Failed\x20to\x20parse\x20JSON\x20response:',_0x56846d),loggerService_1[_0x4b3518(0x1c7)][_0x4b3518(0x166)](_0x4b3518(0x180),_0x4b3518(0x18a),_0x4b3518(0x16e)+_0x56846d);throw new Error(_0x4b3518(0x177)+_0x4de479);}console[_0x4b3518(0x1bd)]('===\x20PARSED\x20RAPYD\x20RESPONSE\x20==='),console[_0x4b3518(0x1bd)](_0x4b3518(0x1b2),JSON[_0x4b3518(0x1ba)](_0x8f433c,null,0x2)),loggerService_1[_0x4b3518(0x1c7)][_0x4b3518(0x1b4)]('rapyd',_0x4b3518(0x18a),_0x5a783a['status'],_0x8f433c,_0x223e7d);if(_0x8f433c['status']?.[_0x4b3518(0x1c2)]!==_0x4b3518(0x1be)){const _0x40c70b=_0x8f433c['status']?.[_0x4b3518(0x1d5)]||_0x4b3518(0x184),_0x118585=_0x8f433c['status']?.[_0x4b3518(0x188)]||_0x4b3518(0x19d);console[_0x4b3518(0x192)](_0x4b3518(0x15f)),console[_0x4b3518(0x192)](_0x4b3518(0x19f),_0x118585),console['error'](_0x4b3518(0x15d),_0x40c70b),console[_0x4b3518(0x192)](_0x4b3518(0x1b1),_0x8f433c['status']),loggerService_1[_0x4b3518(0x1c7)][_0x4b3518(0x166)](_0x4b3518(0x180),_0x4b3518(0x18a),'Business\x20Error\x20('+_0x118585+_0x4b3518(0x174)+_0x40c70b);throw new Error(_0x4b3518(0x1bf)+_0x118585+_0x4b3518(0x174)+_0x40c70b);}if(!_0x8f433c[_0x4b3518(0x1d1)]?.['id']||!_0x8f433c[_0x4b3518(0x1d1)]?.[_0x4b3518(0x181)]){console['error']('===\x20RAPYD\x20API\x20INCOMPLETE\x20RESPONSE\x20==='),console[_0x4b3518(0x192)](_0x4b3518(0x1b5)),console[_0x4b3518(0x192)](_0x4b3518(0x175),_0x8f433c[_0x4b3518(0x1d1)]),loggerService_1['loggerService'][_0x4b3518(0x166)](_0x4b3518(0x180),_0x4b3518(0x18a),_0x4b3518(0x1b8));throw new Error(_0x4b3518(0x173));}return console[_0x4b3518(0x1bd)](_0x4b3518(0x1c3)),console[_0x4b3518(0x1bd)](_0x4b3518(0x1af),_0x8f433c['data']['id']),console[_0x4b3518(0x1bd)](_0x4b3518(0x161),_0x8f433c[_0x4b3518(0x1d1)][_0x4b3518(0x181)]),console['log']('üá¨üáß\x20Country\x20used:\x20'+_0x45b1af+_0x4b3518(0x193)),console[_0x4b3518(0x1bd)](_0x4b3518(0x167)),{'gateway_payment_id':_0x8f433c[_0x4b3518(0x1d1)]['id'],'payment_url':_0x8f433c['data'][_0x4b3518(0x181)]};}catch(_0x38b0c4){console[_0x4b3518(0x192)](_0x4b3518(0x1cc)),console[_0x4b3518(0x192)](_0x4b3518(0x1ca),_0x38b0c4),loggerService_1[_0x4b3518(0x1c7)]['logWhiteDomainError'](_0x4b3518(0x180),_0x4b3518(0x18a),_0x38b0c4);if(_0x38b0c4 instanceof Error){console[_0x4b3518(0x192)](_0x4b3518(0x172),_0x38b0c4['message']),console[_0x4b3518(0x192)](_0x4b3518(0x1ab),_0x38b0c4['stack']);throw new Error(_0x4b3518(0x195)+_0x38b0c4[_0x4b3518(0x1d5)]);}throw new Error(_0x4b3518(0x1a2));}}async[a45_0xf9c70b(0x199)](_0x2162b5){const _0x316ffe=a45_0xf9c70b,_0x25fa26=Date[_0x316ffe(0x1aa)]();try{loggerService_1[_0x316ffe(0x1c7)][_0x316ffe(0x18e)](_0x316ffe(0x180),'/v1/hosted/payment_links/'+_0x2162b5,_0x316ffe(0x16b),{});const _0x2f7b21=await fetch(this[_0x316ffe(0x1d6)]+'/'+_0x2162b5,{'method':'GET','headers':{'Content-Type':_0x316ffe(0x178),'User-Agent':'TesSoft\x20Payment\x20System/1.0'}}),_0xa1dc32=Date[_0x316ffe(0x1aa)]()-_0x25fa26;if(!_0x2f7b21['ok']){const _0x4c46d9=await _0x2f7b21[_0x316ffe(0x17c)]();loggerService_1[_0x316ffe(0x1c7)][_0x316ffe(0x1b4)]('rapyd',_0x316ffe(0x1d3)+_0x2162b5,_0x2f7b21[_0x316ffe(0x1c2)],_0x4c46d9,_0xa1dc32);throw new Error('HTTP\x20error!\x20status:\x20'+_0x2f7b21[_0x316ffe(0x1c2)]);}const _0x388dcf=await _0x2f7b21[_0x316ffe(0x18b)]();loggerService_1['loggerService']['logWhiteDomainResponse']('rapyd',_0x316ffe(0x1d3)+_0x2162b5,_0x2f7b21[_0x316ffe(0x1c2)],_0x388dcf,_0xa1dc32);if(_0x388dcf[_0x316ffe(0x1c2)]?.[_0x316ffe(0x1c2)]!==_0x316ffe(0x1be)){loggerService_1[_0x316ffe(0x1c7)][_0x316ffe(0x166)](_0x316ffe(0x180),'/v1/hosted/payment_links/'+_0x2162b5,_0x316ffe(0x191)+(_0x388dcf[_0x316ffe(0x1c2)]?.[_0x316ffe(0x1d5)]||_0x316ffe(0x17b)));throw new Error(_0x316ffe(0x191)+(_0x388dcf[_0x316ffe(0x1c2)]?.[_0x316ffe(0x1d5)]||_0x316ffe(0x17b)));}let _0x42e201=_0x316ffe(0x1c6);if(_0x388dcf[_0x316ffe(0x1d1)]?.['status'])switch(_0x388dcf[_0x316ffe(0x1d1)][_0x316ffe(0x1c2)][_0x316ffe(0x18d)]()){case'CLO':_0x42e201=_0x316ffe(0x1c1);break;case _0x316ffe(0x190):_0x42e201=_0x316ffe(0x18f);break;case _0x316ffe(0x1cf):_0x42e201='EXPIRED';break;case'ERR':_0x42e201=_0x316ffe(0x18f);break;case _0x316ffe(0x1cd):case _0x316ffe(0x1c8):default:_0x42e201=_0x316ffe(0x1c6);break;}return{'status':_0x42e201,'amount':_0x388dcf[_0x316ffe(0x1d1)]?.['amount'],'currency':_0x388dcf['data']?.[_0x316ffe(0x18c)]};}catch(_0x3cb495){console[_0x316ffe(0x192)]('Rapyd\x20payment\x20verification\x20error:',_0x3cb495),loggerService_1[_0x316ffe(0x1c7)][_0x316ffe(0x166)]('rapyd',_0x316ffe(0x1d3)+_0x2162b5,_0x3cb495);throw new Error(_0x316ffe(0x183)+(_0x3cb495 instanceof Error?_0x3cb495['message']:_0x316ffe(0x17b)));}}async['processWebhook'](_0x488685){const _0x16e08f=a45_0xf9c70b;console[_0x16e08f(0x1bd)](_0x16e08f(0x176),_0x488685);let _0x307dce=_0x16e08f(0x1c6),_0x4b272d;_0x488685[_0x16e08f(0x1d1)]?.[_0x16e08f(0x197)]&&(_0x4b272d=_0x488685[_0x16e08f(0x1d1)][_0x16e08f(0x197)],console[_0x16e08f(0x1bd)](_0x16e08f(0x1a3)+_0x4b272d));switch(_0x488685[_0x16e08f(0x17a)]?.[_0x16e08f(0x18d)]()){case _0x16e08f(0x15e):_0x488685[_0x16e08f(0x1d1)]?.[_0x16e08f(0x16c)]===!![]&&_0x488685[_0x16e08f(0x1d1)]?.['status']===_0x16e08f(0x1bc)?_0x307dce=_0x16e08f(0x1c1):_0x307dce=_0x16e08f(0x1c6);break;case _0x16e08f(0x1c0):_0x307dce=_0x16e08f(0x18f);break;case _0x16e08f(0x19a):_0x307dce='EXPIRED';break;case _0x16e08f(0x196):_0x307dce=_0x16e08f(0x18f);!_0x4b272d&&_0x488685['data']?.[_0x16e08f(0x197)]&&(_0x4b272d=_0x488685['data']['failure_message']);break;default:switch(_0x488685[_0x16e08f(0x1d1)]?.[_0x16e08f(0x1c2)]?.[_0x16e08f(0x18d)]()){case _0x16e08f(0x1bc):_0x488685[_0x16e08f(0x1d1)]?.['paid']===!![]?_0x307dce='PAID':_0x307dce=_0x16e08f(0x18f);break;case'CAN':_0x307dce='FAILED';break;case _0x16e08f(0x1cf):_0x307dce=_0x16e08f(0x1a0);break;case _0x16e08f(0x1b3):_0x307dce=_0x16e08f(0x18f);!_0x4b272d&&_0x488685['data']?.['failure_message']&&(_0x4b272d=_0x488685[_0x16e08f(0x1d1)][_0x16e08f(0x197)]);break;case _0x16e08f(0x1cd):case _0x16e08f(0x1c8):default:_0x307dce='PENDING';break;}break;}const _0x561a68={};return _0x488685[_0x16e08f(0x1d1)]?.['payment_method_data']?.['last4']&&(_0x561a68['cardLast4']=_0x488685[_0x16e08f(0x1d1)][_0x16e08f(0x15b)][_0x16e08f(0x1cb)]),_0x488685[_0x16e08f(0x1d1)]?.[_0x16e08f(0x1b9)]&&(_0x561a68[_0x16e08f(0x179)]=_0x488685[_0x16e08f(0x1d1)][_0x16e08f(0x1b9)]),_0x488685['data']?.[_0x16e08f(0x188)]&&(_0x561a68[_0x16e08f(0x1d2)]=_0x488685[_0x16e08f(0x1d1)][_0x16e08f(0x188)]),_0x488685[_0x16e08f(0x1d1)]?.[_0x16e08f(0x1a4)]&&(_0x561a68['failureCode']=_0x488685[_0x16e08f(0x1d1)][_0x16e08f(0x1a4)]),console[_0x16e08f(0x1bd)](_0x16e08f(0x1d0)+_0x307dce+_0x16e08f(0x1b7)+(_0x4b272d||_0x16e08f(0x162))),{'paymentId':_0x488685['data']?.['merchant_reference_id']||'','status':_0x307dce,'amount':_0x488685[_0x16e08f(0x1d1)]?.[_0x16e08f(0x164)],'currency':_0x488685[_0x16e08f(0x1d1)]?.[_0x16e08f(0x18c)],'failureMessage':_0x4b272d,'additionalInfo':_0x561a68};}}exports['RapydService']=RapydService;