'use strict';function a52_0x61e7(_0x526eda,_0x5ac3c8){const _0x4a8036=a52_0x4a80();return a52_0x61e7=function(_0x61e7ee,_0x1efeb3){_0x61e7ee=_0x61e7ee-0x1b3;let _0x47ddd3=_0x4a8036[_0x61e7ee];return _0x47ddd3;},a52_0x61e7(_0x526eda,_0x5ac3c8);}const a52_0x55fa81=a52_0x61e7;(function(_0x21feb3,_0x813a1c){const _0x3173cd=a52_0x61e7,_0x24f52e=_0x21feb3();while(!![]){try{const _0x2fb975=parseInt(_0x3173cd(0x1f8))/0x1*(-parseInt(_0x3173cd(0x1fb))/0x2)+parseInt(_0x3173cd(0x1ef))/0x3+parseInt(_0x3173cd(0x1e9))/0x4*(-parseInt(_0x3173cd(0x1c5))/0x5)+-parseInt(_0x3173cd(0x1e4))/0x6+-parseInt(_0x3173cd(0x1fc))/0x7*(-parseInt(_0x3173cd(0x224))/0x8)+-parseInt(_0x3173cd(0x20d))/0x9*(-parseInt(_0x3173cd(0x20f))/0xa)+-parseInt(_0x3173cd(0x1d7))/0xb;if(_0x2fb975===_0x813a1c)break;else _0x24f52e['push'](_0x24f52e['shift']());}catch(_0x220007){_0x24f52e['push'](_0x24f52e['shift']());}}}(a52_0x4a80,0xf2618));Object[a52_0x55fa81(0x215)](exports,a52_0x55fa81(0x1bf),{'value':!![]}),exports[a52_0x55fa81(0x1d0)]=void 0x0;const loggerService_1=require(a52_0x55fa81(0x21e));class RapydService{constructor(){const _0x327ee7=a52_0x55fa81;this[_0x327ee7(0x226)]=_0x327ee7(0x22b),console[_0x327ee7(0x1da)]('üåê\x20Rapyd\x20service\x20initialized\x20with\x20white\x20domain\x20proxy');}async[a52_0x55fa81(0x1b5)](_0x34a1b6){const _0x8c2cb3=a52_0x55fa81,{orderId:_0x5d22a0,orderName:_0x275b27,amount:_0xf665f1,currency:_0x13f760,usage:_0x20576c,maxPayments:_0x290190,successUrl:_0x4e78bc,failUrl:_0x2715a6}=_0x34a1b6,_0x3cfd93=_0x13f760['toUpperCase'](),_0x4f4d4c='GB';console[_0x8c2cb3(0x1da)](_0x8c2cb3(0x217));const _0x1ca268=_0x8c2cb3(0x201)+_0x5d22a0,_0x39b5e6=_0x8c2cb3(0x1f4)+_0x5d22a0,_0xda6df4={'amount':_0xf665f1,'currency':_0x3cfd93,'cancel_checkout_url':_0x39b5e6,'complete_checkout_url':_0x1ca268,'complete_payment_url':_0x1ca268,'merchant_reference_id':_0x5d22a0,'description':'ORDER:\x20'+_0x5d22a0,'country':'GB','payment_method_types_include':['gb_visa_card',_0x8c2cb3(0x1b3)],'custom_elements':{'display_description':!![]}};if(_0x3cfd93!==_0x8c2cb3(0x205)){const _0x2ede1d=Math[_0x8c2cb3(0x218)](Date[_0x8c2cb3(0x21c)]()/0x3e8)+0x1e*0x3c;_0xda6df4[_0x8c2cb3(0x1c6)]=_0x8c2cb3(0x1db),_0xda6df4[_0x8c2cb3(0x1cb)]=_0x8c2cb3(0x205),_0xda6df4[_0x8c2cb3(0x230)]=_0x2ede1d,console[_0x8c2cb3(0x1da)](_0x8c2cb3(0x22d)+_0x3cfd93+_0x8c2cb3(0x1c8)),console[_0x8c2cb3(0x1da)](_0x8c2cb3(0x1cd)),console[_0x8c2cb3(0x1da)]('\x20\x20\x20requested_currency:\x20EUR'),console[_0x8c2cb3(0x1da)]('\x20\x20\x20expiration:\x20'+_0x2ede1d+'\x20('+new Date(_0x2ede1d*0x3e8)['toISOString']()+')');}const _0x346ddf=Date[_0x8c2cb3(0x21c)]();try{console[_0x8c2cb3(0x1da)]('===\x20RAPYD\x20API\x20REQUEST\x20(White\x20Domain\x20-\x20Updated\x20Format)\x20==='),console[_0x8c2cb3(0x1da)]('URL:',this['apiUrl']),console['log'](_0x8c2cb3(0x223),JSON[_0x8c2cb3(0x1bd)](_0xda6df4,null,0x2)),console[_0x8c2cb3(0x1da)](_0x8c2cb3(0x227)+_0x4f4d4c+_0x8c2cb3(0x1c4)),console[_0x8c2cb3(0x1da)]('üí≥\x20Payment\x20Methods:\x20gb_visa_card,\x20gb_mastercard_card'),loggerService_1['loggerService'][_0x8c2cb3(0x1ce)](_0x8c2cb3(0x221),_0x8c2cb3(0x21a),_0x8c2cb3(0x1f2),_0xda6df4);const _0x197d95=await fetch(this[_0x8c2cb3(0x226)],{'method':_0x8c2cb3(0x1f2),'headers':{'Content-Type':_0x8c2cb3(0x1d3),'User-Agent':_0x8c2cb3(0x22f)},'body':JSON[_0x8c2cb3(0x1bd)](_0xda6df4)}),_0x3f169e=Date[_0x8c2cb3(0x21c)]()-_0x346ddf;console[_0x8c2cb3(0x1da)]('===\x20RAPYD\x20API\x20RESPONSE\x20(White\x20Domain)\x20==='),console[_0x8c2cb3(0x1da)](_0x8c2cb3(0x211),_0x197d95[_0x8c2cb3(0x1e1)]),console[_0x8c2cb3(0x1da)](_0x8c2cb3(0x1ee),_0x197d95[_0x8c2cb3(0x21f)]),console['log'](_0x8c2cb3(0x1f6),Object['fromEntries'](_0x197d95[_0x8c2cb3(0x206)]['entries']())),console[_0x8c2cb3(0x1da)](_0x8c2cb3(0x1ed),_0x3f169e+'ms');const _0x50bb55=await _0x197d95['text']();console[_0x8c2cb3(0x1da)](_0x8c2cb3(0x1fd),_0x50bb55);if(!_0x197d95['ok']){console[_0x8c2cb3(0x1eb)](_0x8c2cb3(0x1d1)),console[_0x8c2cb3(0x1eb)](_0x8c2cb3(0x1c0),_0x197d95['status']),console[_0x8c2cb3(0x1eb)](_0x8c2cb3(0x214),_0x50bb55),loggerService_1[_0x8c2cb3(0x1d2)]['logWhiteDomainResponse'](_0x8c2cb3(0x221),_0x8c2cb3(0x21a),_0x197d95[_0x8c2cb3(0x1e1)],_0x50bb55,_0x3f169e),loggerService_1[_0x8c2cb3(0x1d2)]['logWhiteDomainError']('rapyd',_0x8c2cb3(0x21a),_0x8c2cb3(0x1c1)+_0x197d95[_0x8c2cb3(0x1e1)]+':\x20'+_0x50bb55);throw new Error(_0x8c2cb3(0x1c2)+_0x197d95[_0x8c2cb3(0x1e1)]+_0x8c2cb3(0x1cc)+_0x50bb55);}let _0x3845e5;try{_0x3845e5=JSON[_0x8c2cb3(0x20a)](_0x50bb55);}catch(_0x386b30){console[_0x8c2cb3(0x1eb)](_0x8c2cb3(0x22e),_0x386b30),loggerService_1[_0x8c2cb3(0x1d2)]['logWhiteDomainError'](_0x8c2cb3(0x221),_0x8c2cb3(0x21a),_0x8c2cb3(0x1de)+_0x386b30);throw new Error(_0x8c2cb3(0x1fa)+_0x50bb55);}console[_0x8c2cb3(0x1da)](_0x8c2cb3(0x1f1)),console['log'](_0x8c2cb3(0x1cf),JSON[_0x8c2cb3(0x1bd)](_0x3845e5,null,0x2)),loggerService_1[_0x8c2cb3(0x1d2)][_0x8c2cb3(0x210)]('rapyd',_0x8c2cb3(0x21a),_0x197d95[_0x8c2cb3(0x1e1)],_0x3845e5,_0x3f169e);if(_0x3845e5[_0x8c2cb3(0x1e1)]?.[_0x8c2cb3(0x1e1)]!==_0x8c2cb3(0x1bb)){const _0x5b926c=_0x3845e5[_0x8c2cb3(0x1e1)]?.[_0x8c2cb3(0x200)]||'Unknown\x20error\x20from\x20Rapyd\x20API',_0x37d203=_0x3845e5[_0x8c2cb3(0x1e1)]?.[_0x8c2cb3(0x220)]||_0x8c2cb3(0x1d6);console['error']('===\x20RAPYD\x20API\x20BUSINESS\x20ERROR\x20==='),console[_0x8c2cb3(0x1eb)]('Error\x20Code:',_0x37d203),console[_0x8c2cb3(0x1eb)](_0x8c2cb3(0x229),_0x5b926c),console['error'](_0x8c2cb3(0x22c),_0x3845e5['status']),loggerService_1['loggerService'][_0x8c2cb3(0x219)]('rapyd',_0x8c2cb3(0x21a),_0x8c2cb3(0x1d4)+_0x37d203+_0x8c2cb3(0x225)+_0x5b926c);throw new Error(_0x8c2cb3(0x1e5)+_0x37d203+_0x8c2cb3(0x225)+_0x5b926c);}if(!_0x3845e5[_0x8c2cb3(0x20e)]?.['id']||!_0x3845e5[_0x8c2cb3(0x20e)]?.['redirect_url']){console[_0x8c2cb3(0x1eb)](_0x8c2cb3(0x1b4)),console[_0x8c2cb3(0x1eb)](_0x8c2cb3(0x207)),console[_0x8c2cb3(0x1eb)]('Response\x20data:',_0x3845e5[_0x8c2cb3(0x20e)]),loggerService_1['loggerService']['logWhiteDomainError'](_0x8c2cb3(0x221),'/v1/hosted/payment_links',_0x8c2cb3(0x1c7));throw new Error(_0x8c2cb3(0x1d8));}return console[_0x8c2cb3(0x1da)]('===\x20RAPYD\x20SUCCESS\x20==='),console[_0x8c2cb3(0x1da)](_0x8c2cb3(0x1ba),_0x3845e5[_0x8c2cb3(0x20e)]['id']),console[_0x8c2cb3(0x1da)]('Redirect\x20URL:',_0x3845e5[_0x8c2cb3(0x20e)]['redirect_url']),console['log'](_0x8c2cb3(0x228)+_0x4f4d4c+_0x8c2cb3(0x1b7)),console['log']('üí≥\x20Payment\x20Methods:\x20gb_visa_card,\x20gb_mastercard_card'),{'gateway_payment_id':_0x3845e5[_0x8c2cb3(0x20e)]['id'],'payment_url':_0x3845e5[_0x8c2cb3(0x20e)][_0x8c2cb3(0x1e6)]};}catch(_0x279f3b){console[_0x8c2cb3(0x1eb)]('===\x20RAPYD\x20SERVICE\x20ERROR\x20==='),console[_0x8c2cb3(0x1eb)](_0x8c2cb3(0x20c),_0x279f3b),loggerService_1[_0x8c2cb3(0x1d2)][_0x8c2cb3(0x219)](_0x8c2cb3(0x221),_0x8c2cb3(0x21a),_0x279f3b);if(_0x279f3b instanceof Error){console[_0x8c2cb3(0x1eb)](_0x8c2cb3(0x1e2),_0x279f3b[_0x8c2cb3(0x200)]),console[_0x8c2cb3(0x1eb)](_0x8c2cb3(0x209),_0x279f3b[_0x8c2cb3(0x232)]);throw new Error(_0x8c2cb3(0x1bc)+_0x279f3b[_0x8c2cb3(0x200)]);}throw new Error(_0x8c2cb3(0x1fe));}}async[a52_0x55fa81(0x22a)](_0x1b2bb3){const _0x4eb170=a52_0x55fa81,_0x27a622=Date[_0x4eb170(0x21c)]();try{loggerService_1[_0x4eb170(0x1d2)][_0x4eb170(0x1ce)](_0x4eb170(0x221),'/v1/hosted/payment_links/'+_0x1b2bb3,_0x4eb170(0x204),{});const _0x305feb=await fetch(this[_0x4eb170(0x226)]+'/'+_0x1b2bb3,{'method':_0x4eb170(0x204),'headers':{'Content-Type':_0x4eb170(0x1d3),'User-Agent':'TesSoft\x20Payment\x20System/1.0'}}),_0x3f9561=Date[_0x4eb170(0x21c)]()-_0x27a622;if(!_0x305feb['ok']){const _0x2af26c=await _0x305feb[_0x4eb170(0x1dc)]();loggerService_1[_0x4eb170(0x1d2)][_0x4eb170(0x210)](_0x4eb170(0x221),'/v1/hosted/payment_links/'+_0x1b2bb3,_0x305feb[_0x4eb170(0x1e1)],_0x2af26c,_0x3f9561);throw new Error(_0x4eb170(0x1c2)+_0x305feb[_0x4eb170(0x1e1)]);}const _0x31bc98=await _0x305feb[_0x4eb170(0x203)]();loggerService_1[_0x4eb170(0x1d2)]['logWhiteDomainResponse'](_0x4eb170(0x221),_0x4eb170(0x1ea)+_0x1b2bb3,_0x305feb['status'],_0x31bc98,_0x3f9561);if(_0x31bc98['status']?.['status']!==_0x4eb170(0x1bb)){loggerService_1[_0x4eb170(0x1d2)]['logWhiteDomainError']('rapyd','/v1/hosted/payment_links/'+_0x1b2bb3,'Rapyd\x20API\x20error:\x20'+(_0x31bc98[_0x4eb170(0x1e1)]?.[_0x4eb170(0x200)]||_0x4eb170(0x20b)));throw new Error(_0x4eb170(0x202)+(_0x31bc98[_0x4eb170(0x1e1)]?.[_0x4eb170(0x200)]||_0x4eb170(0x20b)));}let _0x11b946=_0x4eb170(0x21d);if(_0x31bc98[_0x4eb170(0x20e)]?.[_0x4eb170(0x1e1)])switch(_0x31bc98[_0x4eb170(0x20e)][_0x4eb170(0x1e1)][_0x4eb170(0x1e7)]()){case _0x4eb170(0x222):_0x11b946=_0x4eb170(0x1d9);break;case'CAN':_0x11b946=_0x4eb170(0x1f7);break;case _0x4eb170(0x216):_0x11b946='EXPIRED';break;case _0x4eb170(0x1e8):_0x11b946='FAILED';break;case _0x4eb170(0x231):case'ACT':default:_0x11b946=_0x4eb170(0x21d);break;}return{'status':_0x11b946,'amount':_0x31bc98[_0x4eb170(0x20e)]?.[_0x4eb170(0x1d5)],'currency':_0x31bc98[_0x4eb170(0x20e)]?.[_0x4eb170(0x1b6)]};}catch(_0x2cfd58){console['error'](_0x4eb170(0x1f5),_0x2cfd58),loggerService_1[_0x4eb170(0x1d2)]['logWhiteDomainError'](_0x4eb170(0x221),_0x4eb170(0x1ea)+_0x1b2bb3,_0x2cfd58);throw new Error(_0x4eb170(0x1ca)+(_0x2cfd58 instanceof Error?_0x2cfd58[_0x4eb170(0x200)]:_0x4eb170(0x20b)));}}async[a52_0x55fa81(0x1ff)](_0x48ecaf){const _0x5f0322=a52_0x55fa81;console[_0x5f0322(0x1da)](_0x5f0322(0x213),_0x48ecaf);let _0x4d692a='PENDING',_0x27dc40;_0x48ecaf[_0x5f0322(0x20e)]?.[_0x5f0322(0x1df)]&&(_0x27dc40=_0x48ecaf[_0x5f0322(0x20e)]['failure_message'],console[_0x5f0322(0x1da)](_0x5f0322(0x1be)+_0x27dc40));switch(_0x48ecaf[_0x5f0322(0x1b8)]?.['toUpperCase']()){case _0x5f0322(0x1b9):_0x48ecaf[_0x5f0322(0x20e)]?.[_0x5f0322(0x1f3)]===!![]&&_0x48ecaf[_0x5f0322(0x20e)]?.[_0x5f0322(0x1e1)]===_0x5f0322(0x222)?_0x4d692a=_0x5f0322(0x1d9):_0x4d692a=_0x5f0322(0x21d);break;case'PAYMENT_CANCELED':_0x4d692a=_0x5f0322(0x1f7);break;case _0x5f0322(0x208):_0x4d692a='EXPIRED';break;case _0x5f0322(0x1f0):_0x4d692a='FAILED';!_0x27dc40&&_0x48ecaf[_0x5f0322(0x20e)]?.['failure_message']&&(_0x27dc40=_0x48ecaf[_0x5f0322(0x20e)][_0x5f0322(0x1df)]);break;default:switch(_0x48ecaf['data']?.[_0x5f0322(0x1e1)]?.['toUpperCase']()){case _0x5f0322(0x222):_0x48ecaf['data']?.[_0x5f0322(0x1f3)]===!![]?_0x4d692a=_0x5f0322(0x1d9):_0x4d692a=_0x5f0322(0x1f7);break;case _0x5f0322(0x1c9):_0x4d692a=_0x5f0322(0x1f7);break;case _0x5f0322(0x216):_0x4d692a='EXPIRED';break;case'ERR':_0x4d692a=_0x5f0322(0x1f7);!_0x27dc40&&_0x48ecaf[_0x5f0322(0x20e)]?.['failure_message']&&(_0x27dc40=_0x48ecaf[_0x5f0322(0x20e)]['failure_message']);break;case _0x5f0322(0x231):case'ACT':default:_0x4d692a=_0x5f0322(0x21d);break;}break;}const _0x363580={};return _0x48ecaf[_0x5f0322(0x20e)]?.[_0x5f0322(0x1f9)]?.[_0x5f0322(0x212)]&&(_0x363580[_0x5f0322(0x1c3)]=_0x48ecaf[_0x5f0322(0x20e)][_0x5f0322(0x1f9)][_0x5f0322(0x212)]),_0x48ecaf[_0x5f0322(0x20e)]?.['payment_method_type']&&(_0x363580[_0x5f0322(0x1ec)]=_0x48ecaf[_0x5f0322(0x20e)]['payment_method_type']),_0x48ecaf[_0x5f0322(0x20e)]?.[_0x5f0322(0x220)]&&(_0x363580[_0x5f0322(0x21b)]=_0x48ecaf[_0x5f0322(0x20e)][_0x5f0322(0x220)]),_0x48ecaf[_0x5f0322(0x20e)]?.[_0x5f0322(0x1e0)]&&(_0x363580[_0x5f0322(0x1dd)]=_0x48ecaf[_0x5f0322(0x20e)][_0x5f0322(0x1e0)]),console[_0x5f0322(0x1da)]('üîÑ\x20Rapyd\x20webhook\x20processed:\x20status='+_0x4d692a+',\x20failureMessage='+(_0x27dc40||'none')),{'paymentId':_0x48ecaf[_0x5f0322(0x20e)]?.[_0x5f0322(0x1e3)]||'','status':_0x4d692a,'amount':_0x48ecaf[_0x5f0322(0x20e)]?.[_0x5f0322(0x1d5)],'currency':_0x48ecaf['data']?.['currency'],'failureMessage':_0x27dc40,'additionalInfo':_0x363580};}}function a52_0x4a80(){const _0x29e376=['üí•\x20Rapyd\x20failure\x20message:\x20','__esModule','HTTP\x20Status:','HTTP\x20','HTTP\x20error!\x20status:\x20','cardLast4','\x20(always\x20GB\x20for\x20Rapyd)','3730GQsSZx','fixed_side','Incomplete\x20response:\x20missing\x20id\x20or\x20redirect_url','\x20->\x20EUR:','CAN','Failed\x20to\x20verify\x20Rapyd\x20payment:\x20','requested_currency',',\x20body:\x20','\x20\x20\x20fixed_side:\x20buy','logWhiteDomainRequest','Parsed\x20Result:','RapydService','===\x20RAPYD\x20API\x20ERROR\x20===','loggerService','application/json','Business\x20Error\x20(','amount','UNKNOWN','4578233ERAZQz','Invalid\x20response\x20from\x20Rapyd\x20API:\x20missing\x20id\x20or\x20redirect_url','PAID','log','buy','text','failureCode','JSON\x20Parse\x20Error:\x20','failure_message','failure_code','status','Error\x20message:','merchant_reference_id','11402142xvumiv','Rapyd\x20API\x20error\x20(','redirect_url','toUpperCase','ERR','3028XnNGIF','/v1/hosted/payment_links/','error','paymentMethod','Response\x20Time:','Status\x20Text:','5729160SlLYEc','PAYMENT_FAILED','===\x20PARSED\x20RAPYD\x20RESPONSE\x20===','POST','paid','https://tesoft.uk/gateway/fail.php?id=','Rapyd\x20payment\x20verification\x20error:','Headers:','FAILED','101akCiZs','payment_method_data','Invalid\x20JSON\x20response\x20from\x20Rapyd\x20API:\x20','13684RFdFDw','6041qhwipO','Raw\x20Response\x20Body:','Failed\x20to\x20create\x20Rapyd\x20payment\x20link:\x20Unknown\x20error','processWebhook','message','https://tesoft.uk/gateway/success.php?id=','Rapyd\x20API\x20error:\x20','json','GET','EUR','headers','Missing\x20id\x20or\x20redirect_url\x20in\x20response','PAYMENT_EXPIRED','Error\x20stack:','parse','Unknown\x20error','Error\x20details:','29061sAFcEl','data','5730YupmSj','logWhiteDomainResponse','Status:','last4','Processing\x20Rapyd\x20webhook:','Response\x20Body:','defineProperty','EXP','üá¨üáß\x20Using\x20GB\x20(Britain)\x20as\x20country\x20for\x20Rapyd\x20payment\x20link','floor','logWhiteDomainError','/v1/hosted/payment_links','errorCode','now','PENDING','../loggerService','statusText','error_code','rapyd','CLO','Request\x20Body\x20(Updated\x20Format):','7464ScQEZo','):\x20','apiUrl','üá¨üáß\x20Country:\x20','üá¨üáß\x20Country\x20used:\x20','Error\x20Message:','verifyPayment','https://tesoft.uk/gateway/rapyd/','Full\x20Error\x20Data:','üí±\x20Adding\x20currency\x20conversion\x20fields\x20for\x20','Failed\x20to\x20parse\x20JSON\x20response:','TesSoft\x20Payment\x20System/1.0','expiration','NEW','stack','gb_mastercard_card','===\x20RAPYD\x20API\x20INCOMPLETE\x20RESPONSE\x20===','createPaymentLink','currency','\x20(GB\x20-\x20Britain)','type','PAYMENT_COMPLETED','Payment\x20Link\x20ID:','SUCCESS','Failed\x20to\x20create\x20Rapyd\x20payment\x20link:\x20','stringify'];a52_0x4a80=function(){return _0x29e376;};return a52_0x4a80();}exports[a52_0x55fa81(0x1d0)]=RapydService;