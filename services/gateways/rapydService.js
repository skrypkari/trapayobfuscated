'use strict';const a48_0x562804=a48_0x5d99;(function(_0x3b94ca,_0x324c0c){const _0x1b92ec=a48_0x5d99,_0x173f81=_0x3b94ca();while(!![]){try{const _0x50737d=parseInt(_0x1b92ec(0x238))/0x1+-parseInt(_0x1b92ec(0x22d))/0x2*(-parseInt(_0x1b92ec(0x1f3))/0x3)+parseInt(_0x1b92ec(0x1e0))/0x4*(parseInt(_0x1b92ec(0x1f6))/0x5)+-parseInt(_0x1b92ec(0x1dd))/0x6+parseInt(_0x1b92ec(0x227))/0x7+-parseInt(_0x1b92ec(0x206))/0x8+-parseInt(_0x1b92ec(0x23d))/0x9;if(_0x50737d===_0x324c0c)break;else _0x173f81['push'](_0x173f81['shift']());}catch(_0x19e498){_0x173f81['push'](_0x173f81['shift']());}}}(a48_0x5b14,0xdaa48));Object[a48_0x562804(0x22f)](exports,a48_0x562804(0x1ff),{'value':!![]}),exports[a48_0x562804(0x219)]=void 0x0;const loggerService_1=require('../loggerService');function a48_0x5d99(_0x5718b0,_0x15552d){const _0x5b14c1=a48_0x5b14();return a48_0x5d99=function(_0x5d99ce,_0x1442ee){_0x5d99ce=_0x5d99ce-0x1db;let _0x13df6f=_0x5b14c1[_0x5d99ce];return _0x13df6f;},a48_0x5d99(_0x5718b0,_0x15552d);}class RapydService{constructor(){const _0x27e8d8=a48_0x562804;this[_0x27e8d8(0x223)]='https://tesoft.uk/gateway/rapyd/',console[_0x27e8d8(0x221)]('üåê\x20Rapyd\x20service\x20initialized\x20with\x20white\x20domain\x20proxy');}async['createPaymentLink'](_0x8940b5){const _0x5501db=a48_0x562804,{orderId:_0x44246d,orderName:_0x1671d2,amount:_0x2e738d,currency:_0x457719,usage:_0x2273d1,maxPayments:_0xe672de,successUrl:_0x5f1e8a,failUrl:_0x811f46}=_0x8940b5,_0x3b38ea=_0x457719['toUpperCase'](),_0x2697d5='GB';console[_0x5501db(0x221)](_0x5501db(0x252));const _0x25f269=_0x5501db(0x228)+_0x44246d,_0x181cb6=_0x5501db(0x202)+_0x44246d,_0x3ce4e0={'amount':_0x2e738d,'currency':_0x3b38ea,'cancel_checkout_url':_0x181cb6,'complete_checkout_url':_0x25f269,'complete_payment_url':_0x25f269,'merchant_reference_id':_0x44246d,'description':'ORDER:\x20'+_0x44246d,'country':'GB','payment_method_types_include':[_0x5501db(0x250),'gb_mastercard_card'],'custom_elements':{'display_description':!![]}};if(_0x3b38ea!=='EUR'){const _0x2cfd4a=Math[_0x5501db(0x1e1)](Date[_0x5501db(0x237)]()/0x3e8)+0x1e*0x3c;_0x3ce4e0[_0x5501db(0x201)]=_0x5501db(0x24f),_0x3ce4e0['requested_currency']=_0x5501db(0x1e6),_0x3ce4e0[_0x5501db(0x1ee)]=_0x2cfd4a,console['log'](_0x5501db(0x259)+_0x3b38ea+_0x5501db(0x1e5)),console[_0x5501db(0x221)](_0x5501db(0x24a)),console[_0x5501db(0x221)]('\x20\x20\x20requested_currency:\x20EUR'),console[_0x5501db(0x221)](_0x5501db(0x20e)+_0x2cfd4a+'\x20('+new Date(_0x2cfd4a*0x3e8)['toISOString']()+')');}const _0x5ee6f8=Date[_0x5501db(0x237)]();try{console['log'](_0x5501db(0x222)),console['log'](_0x5501db(0x24e),this['apiUrl']),console['log'](_0x5501db(0x253),JSON[_0x5501db(0x209)](_0x3ce4e0,null,0x2)),console[_0x5501db(0x221)](_0x5501db(0x1ed)+_0x2697d5+_0x5501db(0x24d)),console[_0x5501db(0x221)]('üí≥\x20Payment\x20Methods:\x20gb_visa_card,\x20gb_mastercard_card'),loggerService_1['loggerService'][_0x5501db(0x236)]('rapyd',_0x5501db(0x23f),_0x5501db(0x21f),_0x3ce4e0);const _0x33bbd2=await fetch(this[_0x5501db(0x223)],{'method':'POST','headers':{'Content-Type':_0x5501db(0x248),'User-Agent':_0x5501db(0x25a)},'body':JSON[_0x5501db(0x209)](_0x3ce4e0)}),_0x2f3a4d=Date[_0x5501db(0x237)]()-_0x5ee6f8;console['log'](_0x5501db(0x20b)),console[_0x5501db(0x221)](_0x5501db(0x218),_0x33bbd2[_0x5501db(0x241)]),console[_0x5501db(0x221)](_0x5501db(0x23a),_0x33bbd2['statusText']),console[_0x5501db(0x221)](_0x5501db(0x1e9),Object[_0x5501db(0x1f9)](_0x33bbd2[_0x5501db(0x1e7)][_0x5501db(0x21b)]())),console[_0x5501db(0x221)]('Response\x20Time:',_0x2f3a4d+'ms');const _0x3b20a1=await _0x33bbd2[_0x5501db(0x215)]();console[_0x5501db(0x221)](_0x5501db(0x257),_0x3b20a1);if(!_0x33bbd2['ok']){console[_0x5501db(0x210)](_0x5501db(0x1fa)),console[_0x5501db(0x210)](_0x5501db(0x1fc),_0x33bbd2[_0x5501db(0x241)]),console['error'](_0x5501db(0x243),_0x3b20a1),loggerService_1[_0x5501db(0x208)][_0x5501db(0x256)]('rapyd',_0x5501db(0x23f),_0x33bbd2[_0x5501db(0x241)],_0x3b20a1,_0x2f3a4d),loggerService_1['loggerService'][_0x5501db(0x233)](_0x5501db(0x220),_0x5501db(0x23f),_0x5501db(0x1f8)+_0x33bbd2[_0x5501db(0x241)]+':\x20'+_0x3b20a1);throw new Error('HTTP\x20error!\x20status:\x20'+_0x33bbd2[_0x5501db(0x241)]+',\x20body:\x20'+_0x3b20a1);}let _0x2c5f24;try{_0x2c5f24=JSON['parse'](_0x3b20a1);}catch(_0x546610){console['error'](_0x5501db(0x230),_0x546610),loggerService_1[_0x5501db(0x208)][_0x5501db(0x233)](_0x5501db(0x220),_0x5501db(0x23f),_0x5501db(0x213)+_0x546610);throw new Error(_0x5501db(0x1fe)+_0x3b20a1);}console[_0x5501db(0x221)](_0x5501db(0x200)),console[_0x5501db(0x221)](_0x5501db(0x20d),JSON[_0x5501db(0x209)](_0x2c5f24,null,0x2)),loggerService_1[_0x5501db(0x208)][_0x5501db(0x256)](_0x5501db(0x220),_0x5501db(0x23f),_0x33bbd2[_0x5501db(0x241)],_0x2c5f24,_0x2f3a4d);if(_0x2c5f24['status']?.['status']!=='SUCCESS'){const _0x39912a=_0x2c5f24[_0x5501db(0x241)]?.['message']||_0x5501db(0x25c),_0x9ec829=_0x2c5f24[_0x5501db(0x241)]?.[_0x5501db(0x207)]||_0x5501db(0x229);console[_0x5501db(0x210)](_0x5501db(0x24c)),console[_0x5501db(0x210)](_0x5501db(0x25b),_0x9ec829),console['error'](_0x5501db(0x214),_0x39912a),console['error'](_0x5501db(0x20f),_0x2c5f24[_0x5501db(0x241)]),loggerService_1[_0x5501db(0x208)][_0x5501db(0x233)]('rapyd',_0x5501db(0x23f),_0x5501db(0x247)+_0x9ec829+'):\x20'+_0x39912a);throw new Error(_0x5501db(0x1de)+_0x9ec829+_0x5501db(0x21c)+_0x39912a);}if(!_0x2c5f24[_0x5501db(0x22a)]?.['id']||!_0x2c5f24['data']?.['redirect_url']){console[_0x5501db(0x210)](_0x5501db(0x22e)),console[_0x5501db(0x210)](_0x5501db(0x1f7)),console['error'](_0x5501db(0x21a),_0x2c5f24[_0x5501db(0x22a)]),loggerService_1[_0x5501db(0x208)]['logWhiteDomainError'](_0x5501db(0x220),_0x5501db(0x23f),'Incomplete\x20response:\x20missing\x20id\x20or\x20redirect_url');throw new Error(_0x5501db(0x1df));}return console[_0x5501db(0x221)](_0x5501db(0x1f4)),console[_0x5501db(0x221)]('Payment\x20Link\x20ID:',_0x2c5f24[_0x5501db(0x22a)]['id']),console[_0x5501db(0x221)](_0x5501db(0x1e2),_0x2c5f24['data']['redirect_url']),console[_0x5501db(0x221)](_0x5501db(0x22c)+_0x2697d5+_0x5501db(0x23e)),console[_0x5501db(0x221)](_0x5501db(0x24b)),{'gateway_payment_id':_0x2c5f24['data']['id'],'payment_url':_0x2c5f24[_0x5501db(0x22a)]['redirect_url']};}catch(_0x2174bf){console[_0x5501db(0x210)](_0x5501db(0x231)),console[_0x5501db(0x210)]('Error\x20details:',_0x2174bf),loggerService_1[_0x5501db(0x208)]['logWhiteDomainError'](_0x5501db(0x220),_0x5501db(0x23f),_0x2174bf);if(_0x2174bf instanceof Error){console[_0x5501db(0x210)](_0x5501db(0x1eb),_0x2174bf[_0x5501db(0x212)]),console[_0x5501db(0x210)](_0x5501db(0x240),_0x2174bf[_0x5501db(0x21d)]);throw new Error(_0x5501db(0x20a)+_0x2174bf[_0x5501db(0x212)]);}throw new Error(_0x5501db(0x249));}}async[a48_0x562804(0x211)](_0x5565e3){const _0x17cde1=a48_0x562804,_0x46ef4d=Date['now']();try{loggerService_1[_0x17cde1(0x208)][_0x17cde1(0x236)](_0x17cde1(0x220),_0x17cde1(0x246)+_0x5565e3,_0x17cde1(0x1e4),{});const _0x3bdc4e=await fetch(this[_0x17cde1(0x223)]+'/'+_0x5565e3,{'method':_0x17cde1(0x1e4),'headers':{'Content-Type':'application/json','User-Agent':_0x17cde1(0x25a)}}),_0x101529=Date[_0x17cde1(0x237)]()-_0x46ef4d;if(!_0x3bdc4e['ok']){const _0x52a6b3=await _0x3bdc4e['text']();loggerService_1[_0x17cde1(0x208)]['logWhiteDomainResponse']('rapyd',_0x17cde1(0x246)+_0x5565e3,_0x3bdc4e['status'],_0x52a6b3,_0x101529);throw new Error(_0x17cde1(0x1ea)+_0x3bdc4e[_0x17cde1(0x241)]);}const _0x424d80=await _0x3bdc4e[_0x17cde1(0x224)]();loggerService_1[_0x17cde1(0x208)][_0x17cde1(0x256)](_0x17cde1(0x220),_0x17cde1(0x246)+_0x5565e3,_0x3bdc4e[_0x17cde1(0x241)],_0x424d80,_0x101529);if(_0x424d80['status']?.['status']!==_0x17cde1(0x239)){loggerService_1[_0x17cde1(0x208)][_0x17cde1(0x233)](_0x17cde1(0x220),'/v1/hosted/payment_links/'+_0x5565e3,'Rapyd\x20API\x20error:\x20'+(_0x424d80['status']?.[_0x17cde1(0x212)]||_0x17cde1(0x245)));throw new Error(_0x17cde1(0x1ec)+(_0x424d80[_0x17cde1(0x241)]?.[_0x17cde1(0x212)]||_0x17cde1(0x245)));}let _0x562d52=_0x17cde1(0x1f5);if(_0x424d80[_0x17cde1(0x22a)]?.[_0x17cde1(0x241)])switch(_0x424d80['data'][_0x17cde1(0x241)][_0x17cde1(0x1f0)]()){case _0x17cde1(0x235):_0x562d52=_0x17cde1(0x226);break;case _0x17cde1(0x1fd):_0x562d52=_0x17cde1(0x251);break;case'EXP':_0x562d52='EXPIRED';break;case _0x17cde1(0x20c):_0x562d52=_0x17cde1(0x251);break;case _0x17cde1(0x234):case _0x17cde1(0x1ef):default:_0x562d52='PENDING';break;}return{'status':_0x562d52,'amount':_0x424d80[_0x17cde1(0x22a)]?.[_0x17cde1(0x258)],'currency':_0x424d80[_0x17cde1(0x22a)]?.[_0x17cde1(0x205)]};}catch(_0x51b91b){console[_0x17cde1(0x210)]('Rapyd\x20payment\x20verification\x20error:',_0x51b91b),loggerService_1['loggerService'][_0x17cde1(0x233)](_0x17cde1(0x220),_0x17cde1(0x246)+_0x5565e3,_0x51b91b);throw new Error(_0x17cde1(0x254)+(_0x51b91b instanceof Error?_0x51b91b[_0x17cde1(0x212)]:'Unknown\x20error'));}}async[a48_0x562804(0x217)](_0x352c5d){const _0x4512cb=a48_0x562804;console[_0x4512cb(0x221)](_0x4512cb(0x1dc),_0x352c5d);let _0x3a17cf=_0x4512cb(0x1f5),_0x2d4e99;_0x352c5d[_0x4512cb(0x22a)]?.[_0x4512cb(0x1e8)]&&(_0x2d4e99=_0x352c5d[_0x4512cb(0x22a)]['failure_message'],console[_0x4512cb(0x221)](_0x4512cb(0x1fb)+_0x2d4e99));switch(_0x352c5d[_0x4512cb(0x244)]?.[_0x4512cb(0x1f0)]()){case _0x4512cb(0x21e):_0x352c5d[_0x4512cb(0x22a)]?.[_0x4512cb(0x216)]===!![]&&_0x352c5d[_0x4512cb(0x22a)]?.[_0x4512cb(0x241)]==='CLO'?_0x3a17cf=_0x4512cb(0x226):_0x3a17cf=_0x4512cb(0x1f5);break;case _0x4512cb(0x225):_0x3a17cf='FAILED';break;case _0x4512cb(0x242):_0x3a17cf=_0x4512cb(0x255);break;case _0x4512cb(0x1f1):_0x3a17cf='FAILED';!_0x2d4e99&&_0x352c5d[_0x4512cb(0x22a)]?.['failure_message']&&(_0x2d4e99=_0x352c5d[_0x4512cb(0x22a)][_0x4512cb(0x1e8)]);break;default:switch(_0x352c5d['data']?.[_0x4512cb(0x241)]?.[_0x4512cb(0x1f0)]()){case _0x4512cb(0x235):_0x352c5d['data']?.[_0x4512cb(0x216)]===!![]?_0x3a17cf='PAID':_0x3a17cf=_0x4512cb(0x251);break;case _0x4512cb(0x1fd):_0x3a17cf=_0x4512cb(0x251);break;case _0x4512cb(0x1e3):_0x3a17cf=_0x4512cb(0x255);break;case _0x4512cb(0x20c):_0x3a17cf=_0x4512cb(0x251);!_0x2d4e99&&_0x352c5d[_0x4512cb(0x22a)]?.[_0x4512cb(0x1e8)]&&(_0x2d4e99=_0x352c5d[_0x4512cb(0x22a)][_0x4512cb(0x1e8)]);break;case _0x4512cb(0x234):case'ACT':default:_0x3a17cf='PENDING';break;}break;}const _0x1ebf8a={};return _0x352c5d[_0x4512cb(0x22a)]?.[_0x4512cb(0x23b)]?.['last4']&&(_0x1ebf8a[_0x4512cb(0x1f2)]=_0x352c5d[_0x4512cb(0x22a)][_0x4512cb(0x23b)][_0x4512cb(0x25d)]),_0x352c5d['data']?.['payment_method_type']&&(_0x1ebf8a[_0x4512cb(0x232)]=_0x352c5d[_0x4512cb(0x22a)][_0x4512cb(0x204)]),_0x352c5d[_0x4512cb(0x22a)]?.[_0x4512cb(0x207)]&&(_0x1ebf8a[_0x4512cb(0x25e)]=_0x352c5d['data'][_0x4512cb(0x207)]),_0x352c5d['data']?.[_0x4512cb(0x22b)]&&(_0x1ebf8a[_0x4512cb(0x23c)]=_0x352c5d[_0x4512cb(0x22a)][_0x4512cb(0x22b)]),console[_0x4512cb(0x221)]('üîÑ\x20Rapyd\x20webhook\x20processed:\x20status='+_0x3a17cf+_0x4512cb(0x1db)+(_0x2d4e99||_0x4512cb(0x203))),{'paymentId':_0x352c5d[_0x4512cb(0x22a)]?.['merchant_reference_id']||'','status':_0x3a17cf,'amount':_0x352c5d['data']?.[_0x4512cb(0x258)],'currency':_0x352c5d[_0x4512cb(0x22a)]?.[_0x4512cb(0x205)],'failureMessage':_0x2d4e99,'additionalInfo':_0x1ebf8a};}}function a48_0x5b14(){const _0x168533=['JSON\x20Parse\x20Error:\x20','Error\x20Message:','text','paid','processWebhook','Status:','RapydService','Response\x20data:','entries','):\x20','stack','PAYMENT_COMPLETED','POST','rapyd','log','===\x20RAPYD\x20API\x20REQUEST\x20(White\x20Domain\x20-\x20Updated\x20Format)\x20===','apiUrl','json','PAYMENT_CANCELED','PAID','5102398nOSpzm','https://tesoft.uk/gateway/success.php?id=','UNKNOWN','data','failure_code','üá¨üáß\x20Country\x20used:\x20','3440046QhfCzt','===\x20RAPYD\x20API\x20INCOMPLETE\x20RESPONSE\x20===','defineProperty','Failed\x20to\x20parse\x20JSON\x20response:','===\x20RAPYD\x20SERVICE\x20ERROR\x20===','paymentMethod','logWhiteDomainError','NEW','CLO','logWhiteDomainRequest','now','1149212ggshSE','SUCCESS','Status\x20Text:','payment_method_data','failureCode','4160088fyNEhz','\x20(GB\x20-\x20Britain)','/v1/hosted/payment_links','Error\x20stack:','status','PAYMENT_EXPIRED','Response\x20Body:','type','Unknown\x20error','/v1/hosted/payment_links/','Business\x20Error\x20(','application/json','Failed\x20to\x20create\x20Rapyd\x20payment\x20link:\x20Unknown\x20error','\x20\x20\x20fixed_side:\x20buy','üí≥\x20Payment\x20Methods:\x20gb_visa_card,\x20gb_mastercard_card','===\x20RAPYD\x20API\x20BUSINESS\x20ERROR\x20===','\x20(always\x20GB\x20for\x20Rapyd)','URL:','buy','gb_visa_card','FAILED','üá¨üáß\x20Using\x20GB\x20(Britain)\x20as\x20country\x20for\x20Rapyd\x20payment\x20link','Request\x20Body\x20(Updated\x20Format):','Failed\x20to\x20verify\x20Rapyd\x20payment:\x20','EXPIRED','logWhiteDomainResponse','Raw\x20Response\x20Body:','amount','üí±\x20Adding\x20currency\x20conversion\x20fields\x20for\x20','TesSoft\x20Payment\x20System/1.0','Error\x20Code:','Unknown\x20error\x20from\x20Rapyd\x20API','last4','errorCode',',\x20failureMessage=','Processing\x20Rapyd\x20webhook:','7848384bClfGy','Rapyd\x20API\x20error\x20(','Invalid\x20response\x20from\x20Rapyd\x20API:\x20missing\x20id\x20or\x20redirect_url','64ToJssM','floor','Redirect\x20URL:','EXP','GET','\x20->\x20EUR:','EUR','headers','failure_message','Headers:','HTTP\x20error!\x20status:\x20','Error\x20message:','Rapyd\x20API\x20error:\x20','üá¨üáß\x20Country:\x20','expiration','ACT','toUpperCase','PAYMENT_FAILED','cardLast4','3JhRupS','===\x20RAPYD\x20SUCCESS\x20===','PENDING','123490qfgKvo','Missing\x20id\x20or\x20redirect_url\x20in\x20response','HTTP\x20','fromEntries','===\x20RAPYD\x20API\x20ERROR\x20===','üí•\x20Rapyd\x20failure\x20message:\x20','HTTP\x20Status:','CAN','Invalid\x20JSON\x20response\x20from\x20Rapyd\x20API:\x20','__esModule','===\x20PARSED\x20RAPYD\x20RESPONSE\x20===','fixed_side','https://tesoft.uk/gateway/fail.php?id=','none','payment_method_type','currency','10619688QPfVkt','error_code','loggerService','stringify','Failed\x20to\x20create\x20Rapyd\x20payment\x20link:\x20','===\x20RAPYD\x20API\x20RESPONSE\x20(White\x20Domain)\x20===','ERR','Parsed\x20Result:','\x20\x20\x20expiration:\x20','Full\x20Error\x20Data:','error','verifyPayment','message'];a48_0x5b14=function(){return _0x168533;};return a48_0x5b14();}exports[a48_0x562804(0x219)]=RapydService;