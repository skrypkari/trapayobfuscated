'use strict';const a50_0x27ea80=a50_0x5514;(function(_0x3c8c36,_0x24e487){const _0x126fdd=a50_0x5514,_0xa3d4dd=_0x3c8c36();while(!![]){try{const _0x55a10c=-parseInt(_0x126fdd(0xcd))/0x1+parseInt(_0x126fdd(0x89))/0x2*(parseInt(_0x126fdd(0xbf))/0x3)+-parseInt(_0x126fdd(0x9f))/0x4*(-parseInt(_0x126fdd(0xc3))/0x5)+parseInt(_0x126fdd(0xdc))/0x6*(parseInt(_0x126fdd(0x70))/0x7)+-parseInt(_0x126fdd(0xa7))/0x8*(parseInt(_0x126fdd(0x7f))/0x9)+-parseInt(_0x126fdd(0x85))/0xa*(-parseInt(_0x126fdd(0x6f))/0xb)+-parseInt(_0x126fdd(0x87))/0xc;if(_0x55a10c===_0x24e487)break;else _0xa3d4dd['push'](_0xa3d4dd['shift']());}catch(_0x1d9f2c){_0xa3d4dd['push'](_0xa3d4dd['shift']());}}}(a50_0x1f1c,0xf02a8));Object[a50_0x27ea80(0x77)](exports,'__esModule',{'value':!![]}),exports[a50_0x27ea80(0xdd)]=void 0x0;function a50_0x5514(_0x1257ec,_0xd58c1){const _0x1f1cb2=a50_0x1f1c();return a50_0x5514=function(_0x5514de,_0x269648){_0x5514de=_0x5514de-0x64;let _0x4582f0=_0x1f1cb2[_0x5514de];return _0x4582f0;},a50_0x5514(_0x1257ec,_0xd58c1);}const loggerService_1=require(a50_0x27ea80(0x7d));class RapydService{constructor(){const _0x2f7868=a50_0x27ea80;this['apiUrl']=_0x2f7868(0xd4),console[_0x2f7868(0x7a)](_0x2f7868(0x95));}async[a50_0x27ea80(0x7b)](_0x1ca835){const _0x3f4c9f=a50_0x27ea80,{orderId:_0x5a3173,orderName:_0x468f04,amount:_0x59b9db,currency:_0x4388aa,usage:_0x2ec220,maxPayments:_0x118c87,successUrl:_0x2d9f26,failUrl:_0x299ed7}=_0x1ca835,_0x49ae36=_0x4388aa[_0x3f4c9f(0x76)](),_0x2213e9='GB';console[_0x3f4c9f(0x7a)](_0x3f4c9f(0x8f));const _0x1f93c9='https://tesoft.uk/gateway/success.php?id='+_0x5a3173,_0x32a701='https://tesoft.uk/gateway/fail.php?id='+_0x5a3173,_0x486828={'amount':_0x59b9db,'currency':_0x49ae36,'cancel_checkout_url':_0x32a701,'complete_checkout_url':_0x1f93c9,'complete_payment_url':_0x1f93c9,'merchant_reference_id':_0x5a3173,'description':'ORDER:\x20'+_0x5a3173,'country':'GB','payment_method_types_include':[_0x3f4c9f(0xc4),'gb_mastercard_card'],'custom_elements':{'display_description':!![]}};if(_0x49ae36!==_0x3f4c9f(0xab)){const _0x5826ca=Math[_0x3f4c9f(0x66)](Date[_0x3f4c9f(0xcf)]()/0x3e8)+0x1e*0x3c;_0x486828[_0x3f4c9f(0xae)]=_0x3f4c9f(0x78),_0x486828['requested_currency']=_0x3f4c9f(0xab),_0x486828[_0x3f4c9f(0x79)]=_0x5826ca,console['log'](_0x3f4c9f(0x94)+_0x49ae36+'\x20->\x20EUR:'),console[_0x3f4c9f(0x7a)](_0x3f4c9f(0xcb)),console['log'](_0x3f4c9f(0x8b)),console['log'](_0x3f4c9f(0x7c)+_0x5826ca+'\x20('+new Date(_0x5826ca*0x3e8)[_0x3f4c9f(0xbc)]()+')');}const _0x4228ed=Date['now']();try{console[_0x3f4c9f(0x7a)](_0x3f4c9f(0x8d)),console[_0x3f4c9f(0x7a)](_0x3f4c9f(0xd0),this[_0x3f4c9f(0x73)]),console[_0x3f4c9f(0x7a)](_0x3f4c9f(0xa3),JSON[_0x3f4c9f(0xd7)](_0x486828,null,0x2)),console[_0x3f4c9f(0x7a)]('🇬🇧\x20Country:\x20'+_0x2213e9+_0x3f4c9f(0xaf)),console[_0x3f4c9f(0x7a)](_0x3f4c9f(0x69)),loggerService_1[_0x3f4c9f(0x98)][_0x3f4c9f(0xb0)](_0x3f4c9f(0x8a),_0x3f4c9f(0xc1),'POST',_0x486828);const _0x52acac=await fetch(this['apiUrl'],{'method':_0x3f4c9f(0xce),'headers':{'Content-Type':_0x3f4c9f(0x67),'User-Agent':'TesSoft\x20Payment\x20System/1.0'},'body':JSON[_0x3f4c9f(0xd7)](_0x486828)}),_0x366f86=Date[_0x3f4c9f(0xcf)]()-_0x4228ed;console[_0x3f4c9f(0x7a)](_0x3f4c9f(0xc2)),console[_0x3f4c9f(0x7a)](_0x3f4c9f(0x90),_0x52acac[_0x3f4c9f(0x9b)]),console[_0x3f4c9f(0x7a)]('Status\x20Text:',_0x52acac['statusText']),console[_0x3f4c9f(0x7a)](_0x3f4c9f(0x6e),Object[_0x3f4c9f(0xb6)](_0x52acac[_0x3f4c9f(0xc7)][_0x3f4c9f(0x68)]())),console['log'](_0x3f4c9f(0x74),_0x366f86+'ms');const _0x307579=await _0x52acac[_0x3f4c9f(0x6c)]();console[_0x3f4c9f(0x7a)](_0x3f4c9f(0xa6),_0x307579);if(!_0x52acac['ok']){console[_0x3f4c9f(0xbd)](_0x3f4c9f(0x75)),console[_0x3f4c9f(0xbd)]('HTTP\x20Status:',_0x52acac[_0x3f4c9f(0x9b)]),console['error'](_0x3f4c9f(0xba),_0x307579),loggerService_1['loggerService']['logWhiteDomainResponse'](_0x3f4c9f(0x8a),_0x3f4c9f(0xc1),_0x52acac[_0x3f4c9f(0x9b)],_0x307579,_0x366f86),loggerService_1[_0x3f4c9f(0x98)][_0x3f4c9f(0xa0)]('rapyd',_0x3f4c9f(0xc1),'HTTP\x20'+_0x52acac[_0x3f4c9f(0x9b)]+':\x20'+_0x307579);throw new Error('HTTP\x20error!\x20status:\x20'+_0x52acac[_0x3f4c9f(0x9b)]+',\x20body:\x20'+_0x307579);}let _0x159eb8;try{_0x159eb8=JSON[_0x3f4c9f(0xda)](_0x307579);}catch(_0x177bb5){console[_0x3f4c9f(0xbd)]('Failed\x20to\x20parse\x20JSON\x20response:',_0x177bb5),loggerService_1[_0x3f4c9f(0x98)][_0x3f4c9f(0xa0)](_0x3f4c9f(0x8a),'/v1/hosted/payment_links',_0x3f4c9f(0x99)+_0x177bb5);throw new Error('Invalid\x20JSON\x20response\x20from\x20Rapyd\x20API:\x20'+_0x307579);}console[_0x3f4c9f(0x7a)](_0x3f4c9f(0xaa)),console['log'](_0x3f4c9f(0x8e),JSON[_0x3f4c9f(0xd7)](_0x159eb8,null,0x2)),loggerService_1[_0x3f4c9f(0x98)]['logWhiteDomainResponse'](_0x3f4c9f(0x8a),_0x3f4c9f(0xc1),_0x52acac[_0x3f4c9f(0x9b)],_0x159eb8,_0x366f86);if(_0x159eb8['status']?.[_0x3f4c9f(0x9b)]!=='SUCCESS'){const _0x217d38=_0x159eb8[_0x3f4c9f(0x9b)]?.[_0x3f4c9f(0xcc)]||_0x3f4c9f(0xbe),_0xc94881=_0x159eb8[_0x3f4c9f(0x9b)]?.[_0x3f4c9f(0x6b)]||'UNKNOWN';console[_0x3f4c9f(0xbd)]('===\x20RAPYD\x20API\x20BUSINESS\x20ERROR\x20==='),console['error'](_0x3f4c9f(0xb3),_0xc94881),console[_0x3f4c9f(0xbd)]('Error\x20Message:',_0x217d38),console[_0x3f4c9f(0xbd)](_0x3f4c9f(0x65),_0x159eb8[_0x3f4c9f(0x9b)]),loggerService_1[_0x3f4c9f(0x98)][_0x3f4c9f(0xa0)](_0x3f4c9f(0x8a),_0x3f4c9f(0xc1),_0x3f4c9f(0xa8)+_0xc94881+_0x3f4c9f(0x6a)+_0x217d38);throw new Error(_0x3f4c9f(0x83)+_0xc94881+'):\x20'+_0x217d38);}if(!_0x159eb8[_0x3f4c9f(0xc0)]?.['id']||!_0x159eb8[_0x3f4c9f(0xc0)]?.[_0x3f4c9f(0xc5)]){console[_0x3f4c9f(0xbd)](_0x3f4c9f(0xd8)),console[_0x3f4c9f(0xbd)]('Missing\x20id\x20or\x20redirect_url\x20in\x20response'),console[_0x3f4c9f(0xbd)](_0x3f4c9f(0xca),_0x159eb8[_0x3f4c9f(0xc0)]),loggerService_1['loggerService'][_0x3f4c9f(0xa0)](_0x3f4c9f(0x8a),'/v1/hosted/payment_links','Incomplete\x20response:\x20missing\x20id\x20or\x20redirect_url');throw new Error(_0x3f4c9f(0x86));}return console['log'](_0x3f4c9f(0xd6)),console[_0x3f4c9f(0x7a)](_0x3f4c9f(0x8c),_0x159eb8[_0x3f4c9f(0xc0)]['id']),console[_0x3f4c9f(0x7a)](_0x3f4c9f(0x84),_0x159eb8[_0x3f4c9f(0xc0)][_0x3f4c9f(0xc5)]),console[_0x3f4c9f(0x7a)](_0x3f4c9f(0xc6)+_0x2213e9+'\x20(GB\x20-\x20Britain)'),console[_0x3f4c9f(0x7a)]('💳\x20Payment\x20Methods:\x20gb_visa_card,\x20gb_mastercard_card'),{'gateway_payment_id':_0x159eb8['data']['id'],'payment_url':_0x159eb8['data'][_0x3f4c9f(0xc5)]};}catch(_0x1438fc){console[_0x3f4c9f(0xbd)](_0x3f4c9f(0xad)),console['error'](_0x3f4c9f(0xa2),_0x1438fc),loggerService_1['loggerService'][_0x3f4c9f(0xa0)](_0x3f4c9f(0x8a),'/v1/hosted/payment_links',_0x1438fc);if(_0x1438fc instanceof Error){console['error'](_0x3f4c9f(0x97),_0x1438fc[_0x3f4c9f(0xcc)]),console['error'](_0x3f4c9f(0xac),_0x1438fc[_0x3f4c9f(0x9d)]);throw new Error(_0x3f4c9f(0xd1)+_0x1438fc['message']);}throw new Error('Failed\x20to\x20create\x20Rapyd\x20payment\x20link:\x20Unknown\x20error');}}async[a50_0x27ea80(0x9e)](_0x424979){const _0x21ff49=a50_0x27ea80,_0x548b4e=Date[_0x21ff49(0xcf)]();try{loggerService_1[_0x21ff49(0x98)][_0x21ff49(0xb0)](_0x21ff49(0x8a),_0x21ff49(0x80)+_0x424979,_0x21ff49(0xb1),{});const _0x4bbcf5=await fetch(this['apiUrl']+'/'+_0x424979,{'method':'GET','headers':{'Content-Type':'application/json','User-Agent':'TesSoft\x20Payment\x20System/1.0'}}),_0x164b1b=Date[_0x21ff49(0xcf)]()-_0x548b4e;if(!_0x4bbcf5['ok']){const _0x44469d=await _0x4bbcf5[_0x21ff49(0x6c)]();loggerService_1['loggerService']['logWhiteDomainResponse'](_0x21ff49(0x8a),_0x21ff49(0x80)+_0x424979,_0x4bbcf5[_0x21ff49(0x9b)],_0x44469d,_0x164b1b);throw new Error(_0x21ff49(0x7e)+_0x4bbcf5[_0x21ff49(0x9b)]);}const _0x5a8f29=await _0x4bbcf5['json']();loggerService_1[_0x21ff49(0x98)]['logWhiteDomainResponse'](_0x21ff49(0x8a),_0x21ff49(0x80)+_0x424979,_0x4bbcf5['status'],_0x5a8f29,_0x164b1b);if(_0x5a8f29['status']?.[_0x21ff49(0x9b)]!==_0x21ff49(0x92)){loggerService_1[_0x21ff49(0x98)]['logWhiteDomainError']('rapyd',_0x21ff49(0x80)+_0x424979,_0x21ff49(0xa5)+(_0x5a8f29['status']?.[_0x21ff49(0xcc)]||_0x21ff49(0x64)));throw new Error(_0x21ff49(0xa5)+(_0x5a8f29['status']?.[_0x21ff49(0xcc)]||_0x21ff49(0x64)));}let _0x18098c=_0x21ff49(0xb2);if(_0x5a8f29[_0x21ff49(0xc0)]?.['status'])switch(_0x5a8f29['data'][_0x21ff49(0x9b)][_0x21ff49(0x76)]()){case _0x21ff49(0xd2):_0x18098c=_0x21ff49(0x9a);break;case'CAN':_0x18098c=_0x21ff49(0xd3);break;case'EXP':_0x18098c=_0x21ff49(0xd9);break;case'ERR':_0x18098c=_0x21ff49(0xd3);break;case _0x21ff49(0x93):case'ACT':default:_0x18098c=_0x21ff49(0xb2);break;}return{'status':_0x18098c,'amount':_0x5a8f29[_0x21ff49(0xc0)]?.[_0x21ff49(0x6d)],'currency':_0x5a8f29[_0x21ff49(0xc0)]?.[_0x21ff49(0xb9)]};}catch(_0x3a8c03){console['error']('Rapyd\x20payment\x20verification\x20error:',_0x3a8c03),loggerService_1[_0x21ff49(0x98)][_0x21ff49(0xa0)](_0x21ff49(0x8a),_0x21ff49(0x80)+_0x424979,_0x3a8c03);throw new Error('Failed\x20to\x20verify\x20Rapyd\x20payment:\x20'+(_0x3a8c03 instanceof Error?_0x3a8c03[_0x21ff49(0xcc)]:_0x21ff49(0x64)));}}async[a50_0x27ea80(0xc9)](_0x227343){const _0x2e506b=a50_0x27ea80;console[_0x2e506b(0x7a)](_0x2e506b(0x88),_0x227343);let _0x18fa23=_0x2e506b(0xb2),_0x1f8958;_0x227343[_0x2e506b(0xc0)]?.[_0x2e506b(0xd5)]&&(_0x1f8958=_0x227343['data']['failure_message'],console['log'](_0x2e506b(0xa1)+_0x1f8958));switch(_0x227343['type']?.[_0x2e506b(0x76)]()){case _0x2e506b(0xb5):_0x227343[_0x2e506b(0xc0)]?.[_0x2e506b(0xb7)]===!![]&&_0x227343[_0x2e506b(0xc0)]?.['status']===_0x2e506b(0xd2)?_0x18fa23=_0x2e506b(0x9a):_0x18fa23=_0x2e506b(0xb2);break;case _0x2e506b(0x91):_0x18fa23=_0x2e506b(0xd3);break;case'PAYMENT_EXPIRED':_0x18fa23='EXPIRED';break;case _0x2e506b(0x9c):_0x18fa23=_0x2e506b(0xd3);!_0x1f8958&&_0x227343[_0x2e506b(0xc0)]?.[_0x2e506b(0xd5)]&&(_0x1f8958=_0x227343['data']['failure_message']);break;default:switch(_0x227343[_0x2e506b(0xc0)]?.['status']?.[_0x2e506b(0x76)]()){case'CLO':_0x227343['data']?.[_0x2e506b(0xb7)]===!![]?_0x18fa23=_0x2e506b(0x9a):_0x18fa23=_0x2e506b(0xd3);break;case _0x2e506b(0x81):_0x18fa23=_0x2e506b(0xd3);break;case _0x2e506b(0xa9):_0x18fa23=_0x2e506b(0xd9);break;case'ERR':_0x18fa23=_0x2e506b(0xd3);!_0x1f8958&&_0x227343['data']?.[_0x2e506b(0xd5)]&&(_0x1f8958=_0x227343['data'][_0x2e506b(0xd5)]);break;case _0x2e506b(0x93):case _0x2e506b(0xb8):default:_0x18fa23=_0x2e506b(0xb2);break;}break;}const _0xe36fbc={};return _0x227343[_0x2e506b(0xc0)]?.['payment_method_data']?.[_0x2e506b(0x71)]&&(_0xe36fbc['cardLast4']=_0x227343[_0x2e506b(0xc0)][_0x2e506b(0xbb)][_0x2e506b(0x71)]),_0x227343[_0x2e506b(0xc0)]?.['payment_method_type']&&(_0xe36fbc[_0x2e506b(0xc8)]=_0x227343['data'][_0x2e506b(0xdb)]),_0x227343['data']?.['error_code']&&(_0xe36fbc[_0x2e506b(0xb4)]=_0x227343['data'][_0x2e506b(0x6b)]),_0x227343[_0x2e506b(0xc0)]?.[_0x2e506b(0x96)]&&(_0xe36fbc[_0x2e506b(0x82)]=_0x227343[_0x2e506b(0xc0)]['failure_code']),console[_0x2e506b(0x7a)](_0x2e506b(0x72)+_0x18fa23+',\x20failureMessage='+(_0x1f8958||'none')),{'paymentId':_0x227343[_0x2e506b(0xc0)]?.[_0x2e506b(0xa4)]||'','status':_0x18fa23,'amount':_0x227343[_0x2e506b(0xc0)]?.['amount'],'currency':_0x227343[_0x2e506b(0xc0)]?.[_0x2e506b(0xb9)],'failureMessage':_0x1f8958,'additionalInfo':_0xe36fbc};}}exports[a50_0x27ea80(0xdd)]=RapydService;function a50_0x1f1c(){const _0x4d851a=['errorCode','PAYMENT_COMPLETED','fromEntries','paid','ACT','currency','Response\x20Body:','payment_method_data','toISOString','error','Unknown\x20error\x20from\x20Rapyd\x20API','6JsmxHj','data','/v1/hosted/payment_links','===\x20RAPYD\x20API\x20RESPONSE\x20(White\x20Domain)\x20===','38345mkPtqm','gb_visa_card','redirect_url','🇬🇧\x20Country\x20used:\x20','headers','paymentMethod','processWebhook','Response\x20data:','\x20\x20\x20fixed_side:\x20buy','message','1048403KtFCnD','POST','now','URL:','Failed\x20to\x20create\x20Rapyd\x20payment\x20link:\x20','CLO','FAILED','https://tesoft.uk/gateway/rapyd/','failure_message','===\x20RAPYD\x20SUCCESS\x20===','stringify','===\x20RAPYD\x20API\x20INCOMPLETE\x20RESPONSE\x20===','EXPIRED','parse','payment_method_type','192UdWHwZ','RapydService','Unknown\x20error','Full\x20Error\x20Data:','floor','application/json','entries','💳\x20Payment\x20Methods:\x20gb_visa_card,\x20gb_mastercard_card','):\x20','error_code','text','amount','Headers:','352bIJnSq','367052FwMADz','last4','🔄\x20Rapyd\x20webhook\x20processed:\x20status=','apiUrl','Response\x20Time:','===\x20RAPYD\x20API\x20ERROR\x20===','toUpperCase','defineProperty','buy','expiration','log','createPaymentLink','\x20\x20\x20expiration:\x20','../loggerService','HTTP\x20error!\x20status:\x20','36wwpGav','/v1/hosted/payment_links/','CAN','failureCode','Rapyd\x20API\x20error\x20(','Redirect\x20URL:','179810sVnaiX','Invalid\x20response\x20from\x20Rapyd\x20API:\x20missing\x20id\x20or\x20redirect_url','26999496OYuyoh','Processing\x20Rapyd\x20webhook:','1948904FRodGn','rapyd','\x20\x20\x20requested_currency:\x20EUR','Payment\x20Link\x20ID:','===\x20RAPYD\x20API\x20REQUEST\x20(White\x20Domain\x20-\x20Updated\x20Format)\x20===','Parsed\x20Result:','🇬🇧\x20Using\x20GB\x20(Britain)\x20as\x20country\x20for\x20Rapyd\x20payment\x20link','Status:','PAYMENT_CANCELED','SUCCESS','NEW','💱\x20Adding\x20currency\x20conversion\x20fields\x20for\x20','🌐\x20Rapyd\x20service\x20initialized\x20with\x20white\x20domain\x20proxy','failure_code','Error\x20message:','loggerService','JSON\x20Parse\x20Error:\x20','PAID','status','PAYMENT_FAILED','stack','verifyPayment','564mNQmtr','logWhiteDomainError','💥\x20Rapyd\x20failure\x20message:\x20','Error\x20details:','Request\x20Body\x20(Updated\x20Format):','merchant_reference_id','Rapyd\x20API\x20error:\x20','Raw\x20Response\x20Body:','2002992gIKIyZ','Business\x20Error\x20(','EXP','===\x20PARSED\x20RAPYD\x20RESPONSE\x20===','EUR','Error\x20stack:','===\x20RAPYD\x20SERVICE\x20ERROR\x20===','fixed_side','\x20(always\x20GB\x20for\x20Rapyd)','logWhiteDomainRequest','GET','PENDING','Error\x20Code:'];a50_0x1f1c=function(){return _0x4d851a;};return a50_0x1f1c();}