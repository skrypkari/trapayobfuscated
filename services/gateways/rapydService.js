'use strict';const a45_0x39937d=a45_0x14b0;(function(_0x2efdeb,_0x289b95){const _0x35df64=a45_0x14b0,_0x5673c8=_0x2efdeb();while(!![]){try{const _0x42b26f=-parseInt(_0x35df64(0x1dd))/0x1*(-parseInt(_0x35df64(0x19d))/0x2)+parseInt(_0x35df64(0x1d2))/0x3+parseInt(_0x35df64(0x18b))/0x4*(parseInt(_0x35df64(0x185))/0x5)+parseInt(_0x35df64(0x1cf))/0x6*(parseInt(_0x35df64(0x1de))/0x7)+parseInt(_0x35df64(0x1a1))/0x8+-parseInt(_0x35df64(0x192))/0x9*(-parseInt(_0x35df64(0x1d3))/0xa)+-parseInt(_0x35df64(0x193))/0xb;if(_0x42b26f===_0x289b95)break;else _0x5673c8['push'](_0x5673c8['shift']());}catch(_0x28a7a8){_0x5673c8['push'](_0x5673c8['shift']());}}}(a45_0x44c7,0x1bdfc));function a45_0x14b0(_0x5ed7b8,_0x174144){const _0x44c703=a45_0x44c7();return a45_0x14b0=function(_0x14b050,_0x3fdfd4){_0x14b050=_0x14b050-0x181;let _0x1a839a=_0x44c703[_0x14b050];return _0x1a839a;},a45_0x14b0(_0x5ed7b8,_0x174144);}function a45_0x44c7(){const _0x1c2f76=['currency','Failed\x20to\x20create\x20Rapyd\x20payment\x20link:\x20Unknown\x20error','Headers:','now','application/json','===\x20RAPYD\x20API\x20RESPONSE\x20(White\x20Domain)\x20===','PENDING','GET','HTTP\x20','ORDER:\x20','SUCCESS','payment_method_type','amount','FAILED','12bfKbiM','===\x20RAPYD\x20API\x20INCOMPLETE\x20RESPONSE\x20===','Invalid\x20response\x20from\x20Rapyd\x20API:\x20missing\x20id\x20or\x20redirect_url','656517lUorqp','20ChdmTj','Error\x20details:','logWhiteDomainError','stack','defineProperty',',\x20body:\x20','verifyPayment','Missing\x20id\x20or\x20redirect_url\x20in\x20response','status','/v1/hosted/payment_links/','1EVIIWN','41335XkjAzw','failure_code','URL:','Status:','Response\x20Time:','PAYMENT_CANCELED','text','/v1/hosted/payment_links','TesSoft\x20Payment\x20System/1.0','https://tesoft.uk/gateway/rapyd/','Invalid\x20JSON\x20response\x20from\x20Rapyd\x20API:\x20','Status\x20Text:','===\x20RAPYD\x20API\x20ERROR\x20===','apiUrl','createPaymentLink','Response\x20data:','../loggerService','Error\x20Code:','Error\x20message:','üá¨üáß\x20Country:\x20','type','CAN','Failed\x20to\x20verify\x20Rapyd\x20payment:\x20','===\x20RAPYD\x20API\x20REQUEST\x20(White\x20Domain\x20-\x20Updated\x20Format)\x20===','logWhiteDomainRequest','===\x20PARSED\x20RAPYD\x20RESPONSE\x20===','statusText','Request\x20Body\x20(Updated\x20Format):','===\x20RAPYD\x20SUCCESS\x20===','error_code','Rapyd\x20payment\x20verification\x20error:','):\x20','https://tesoft.uk/gateway/fail.php?id=','headers','82955IQhEeY','Error\x20stack:','\x20(GB\x20-\x20Britain)','ACT','loggerService','gb_visa_card','40FoKbJc','toUpperCase','cardLast4','ERR','EXPIRED','HTTP\x20error!\x20status:\x20','JSON\x20Parse\x20Error:\x20','183285iTbhrZ','7170328dElmxY','PAID','parse','Full\x20Error\x20Data:','Failed\x20to\x20create\x20Rapyd\x20payment\x20link:\x20','EXP','error','Unknown\x20error','Processing\x20Rapyd\x20webhook:','Redirect\x20URL:','265504GPOwHW','PAYMENT_COMPLETED','entries','logWhiteDomainResponse','1567832YLyuVp','rapyd','Business\x20Error\x20(','last4','failureCode','POST','Rapyd\x20API\x20error:\x20','Parsed\x20Result:','Incomplete\x20response:\x20missing\x20id\x20or\x20redirect_url','data','HTTP\x20Status:','paid','RapydService','message','payment_method_data','log','NEW','Rapyd\x20API\x20error\x20(','\x20(always\x20GB\x20for\x20Rapyd)','Response\x20Body:','üí•\x20Rapyd\x20failure\x20message:\x20','UNKNOWN','Payment\x20Link\x20ID:','CLO','failure_message','üá¨üáß\x20Country\x20used:\x20','redirect_url','Error\x20Message:','PAYMENT_FAILED','stringify','fromEntries','üåê\x20Rapyd\x20service\x20initialized\x20with\x20white\x20domain\x20proxy'];a45_0x44c7=function(){return _0x1c2f76;};return a45_0x44c7();}Object[a45_0x39937d(0x1d7)](exports,'__esModule',{'value':!![]}),exports['RapydService']=void 0x0;const loggerService_1=require(a45_0x39937d(0x1ee));class RapydService{constructor(){const _0x117ff6=a45_0x39937d;this['apiUrl']=_0x117ff6(0x1e7),console['log'](_0x117ff6(0x1c0));}async[a45_0x39937d(0x1ec)](_0x34d224){const _0x54f386=a45_0x39937d,{orderId:_0x1fbc0e,orderName:_0x6b61fd,amount:_0x5e115b,currency:_0x4d0105,usage:_0x53ec4b,maxPayments:_0x4fba64,successUrl:_0x5a2d73,failUrl:_0x2209bf}=_0x34d224,_0x229211=_0x4d0105[_0x54f386(0x18c)](),_0x2610c3='GB';console[_0x54f386(0x1b0)]('üá¨üáß\x20Using\x20GB\x20(Britain)\x20as\x20country\x20for\x20Rapyd\x20payment\x20link');const _0x3b4936='https://tesoft.uk/gateway/success.php?id='+_0x1fbc0e,_0x300dab=_0x54f386(0x183)+_0x1fbc0e,_0x2b7f1a={'amount':_0x5e115b,'currency':_0x229211,'cancel_checkout_url':_0x300dab,'complete_checkout_url':_0x3b4936,'complete_payment_url':_0x3b4936,'merchant_reference_id':_0x1fbc0e,'description':_0x54f386(0x1ca)+_0x1fbc0e,'country':'GB','payment_method_types_include':[_0x54f386(0x18a),'gb_mastercard_card'],'custom_elements':{'display_description':!![]}},_0x2420d3=Date[_0x54f386(0x1c4)]();try{console[_0x54f386(0x1b0)](_0x54f386(0x1f5)),console[_0x54f386(0x1b0)](_0x54f386(0x1e0),this['apiUrl']),console['log'](_0x54f386(0x1f9),JSON[_0x54f386(0x1be)](_0x2b7f1a,null,0x2)),console['log'](_0x54f386(0x1f1)+_0x2610c3+_0x54f386(0x1b3)),console[_0x54f386(0x1b0)]('üí≥\x20Payment\x20Methods:\x20gb_visa_card,\x20gb_mastercard_card'),loggerService_1[_0x54f386(0x189)]['logWhiteDomainRequest'](_0x54f386(0x1a2),'/v1/hosted/payment_links','POST',_0x2b7f1a);const _0x116db3=await fetch(this[_0x54f386(0x1eb)],{'method':_0x54f386(0x1a6),'headers':{'Content-Type':_0x54f386(0x1c5),'User-Agent':_0x54f386(0x1e6)},'body':JSON[_0x54f386(0x1be)](_0x2b7f1a)}),_0x4a69ef=Date[_0x54f386(0x1c4)]()-_0x2420d3;console[_0x54f386(0x1b0)](_0x54f386(0x1c6)),console['log'](_0x54f386(0x1e1),_0x116db3[_0x54f386(0x1db)]),console['log'](_0x54f386(0x1e9),_0x116db3[_0x54f386(0x1f8)]),console[_0x54f386(0x1b0)](_0x54f386(0x1c3),Object[_0x54f386(0x1bf)](_0x116db3[_0x54f386(0x184)][_0x54f386(0x19f)]())),console['log'](_0x54f386(0x1e2),_0x4a69ef+'ms');const _0x5f4fc2=await _0x116db3[_0x54f386(0x1e4)]();console[_0x54f386(0x1b0)]('Raw\x20Response\x20Body:',_0x5f4fc2);if(!_0x116db3['ok']){console[_0x54f386(0x199)](_0x54f386(0x1ea)),console[_0x54f386(0x199)](_0x54f386(0x1ab),_0x116db3[_0x54f386(0x1db)]),console[_0x54f386(0x199)](_0x54f386(0x1b4),_0x5f4fc2),loggerService_1[_0x54f386(0x189)][_0x54f386(0x1a0)]('rapyd',_0x54f386(0x1e5),_0x116db3['status'],_0x5f4fc2,_0x4a69ef),loggerService_1[_0x54f386(0x189)][_0x54f386(0x1d5)]('rapyd',_0x54f386(0x1e5),_0x54f386(0x1c9)+_0x116db3['status']+':\x20'+_0x5f4fc2);throw new Error(_0x54f386(0x190)+_0x116db3['status']+_0x54f386(0x1d8)+_0x5f4fc2);}let _0x3ce9b4;try{_0x3ce9b4=JSON[_0x54f386(0x195)](_0x5f4fc2);}catch(_0x4df194){console['error']('Failed\x20to\x20parse\x20JSON\x20response:',_0x4df194),loggerService_1[_0x54f386(0x189)][_0x54f386(0x1d5)](_0x54f386(0x1a2),_0x54f386(0x1e5),_0x54f386(0x191)+_0x4df194);throw new Error(_0x54f386(0x1e8)+_0x5f4fc2);}console[_0x54f386(0x1b0)](_0x54f386(0x1f7)),console[_0x54f386(0x1b0)](_0x54f386(0x1a8),JSON[_0x54f386(0x1be)](_0x3ce9b4,null,0x2)),loggerService_1[_0x54f386(0x189)][_0x54f386(0x1a0)](_0x54f386(0x1a2),_0x54f386(0x1e5),_0x116db3[_0x54f386(0x1db)],_0x3ce9b4,_0x4a69ef);if(_0x3ce9b4[_0x54f386(0x1db)]?.[_0x54f386(0x1db)]!==_0x54f386(0x1cb)){const _0xc08387=_0x3ce9b4[_0x54f386(0x1db)]?.['message']||'Unknown\x20error\x20from\x20Rapyd\x20API',_0x5f37e2=_0x3ce9b4[_0x54f386(0x1db)]?.[_0x54f386(0x1fb)]||_0x54f386(0x1b6);console['error']('===\x20RAPYD\x20API\x20BUSINESS\x20ERROR\x20==='),console[_0x54f386(0x199)](_0x54f386(0x1ef),_0x5f37e2),console[_0x54f386(0x199)](_0x54f386(0x1bc),_0xc08387),console[_0x54f386(0x199)](_0x54f386(0x196),_0x3ce9b4[_0x54f386(0x1db)]),loggerService_1[_0x54f386(0x189)]['logWhiteDomainError'](_0x54f386(0x1a2),_0x54f386(0x1e5),_0x54f386(0x1a3)+_0x5f37e2+_0x54f386(0x182)+_0xc08387);throw new Error(_0x54f386(0x1b2)+_0x5f37e2+'):\x20'+_0xc08387);}if(!_0x3ce9b4[_0x54f386(0x1aa)]?.['id']||!_0x3ce9b4['data']?.[_0x54f386(0x1bb)]){console[_0x54f386(0x199)](_0x54f386(0x1d0)),console['error'](_0x54f386(0x1da)),console[_0x54f386(0x199)](_0x54f386(0x1ed),_0x3ce9b4['data']),loggerService_1[_0x54f386(0x189)][_0x54f386(0x1d5)](_0x54f386(0x1a2),_0x54f386(0x1e5),_0x54f386(0x1a9));throw new Error(_0x54f386(0x1d1));}return console[_0x54f386(0x1b0)](_0x54f386(0x1fa)),console[_0x54f386(0x1b0)](_0x54f386(0x1b7),_0x3ce9b4['data']['id']),console[_0x54f386(0x1b0)](_0x54f386(0x19c),_0x3ce9b4[_0x54f386(0x1aa)][_0x54f386(0x1bb)]),console[_0x54f386(0x1b0)](_0x54f386(0x1ba)+_0x2610c3+_0x54f386(0x187)),console[_0x54f386(0x1b0)]('üí≥\x20Payment\x20Methods:\x20gb_visa_card,\x20gb_mastercard_card'),{'gateway_payment_id':_0x3ce9b4[_0x54f386(0x1aa)]['id'],'payment_url':_0x3ce9b4['data'][_0x54f386(0x1bb)]};}catch(_0x474f96){console[_0x54f386(0x199)]('===\x20RAPYD\x20SERVICE\x20ERROR\x20==='),console[_0x54f386(0x199)](_0x54f386(0x1d4),_0x474f96),loggerService_1[_0x54f386(0x189)][_0x54f386(0x1d5)]('rapyd','/v1/hosted/payment_links',_0x474f96);if(_0x474f96 instanceof Error){console[_0x54f386(0x199)](_0x54f386(0x1f0),_0x474f96[_0x54f386(0x1ae)]),console[_0x54f386(0x199)](_0x54f386(0x186),_0x474f96[_0x54f386(0x1d6)]);throw new Error(_0x54f386(0x197)+_0x474f96['message']);}throw new Error(_0x54f386(0x1c2));}}async[a45_0x39937d(0x1d9)](_0x32b0c1){const _0x31e3d4=a45_0x39937d,_0x7477ef=Date[_0x31e3d4(0x1c4)]();try{loggerService_1[_0x31e3d4(0x189)][_0x31e3d4(0x1f6)](_0x31e3d4(0x1a2),_0x31e3d4(0x1dc)+_0x32b0c1,_0x31e3d4(0x1c8),{});const _0x3fc250=await fetch(this[_0x31e3d4(0x1eb)]+'/'+_0x32b0c1,{'method':_0x31e3d4(0x1c8),'headers':{'Content-Type':_0x31e3d4(0x1c5),'User-Agent':_0x31e3d4(0x1e6)}}),_0x27b7e9=Date['now']()-_0x7477ef;if(!_0x3fc250['ok']){const _0x319c05=await _0x3fc250[_0x31e3d4(0x1e4)]();loggerService_1[_0x31e3d4(0x189)][_0x31e3d4(0x1a0)](_0x31e3d4(0x1a2),_0x31e3d4(0x1dc)+_0x32b0c1,_0x3fc250[_0x31e3d4(0x1db)],_0x319c05,_0x27b7e9);throw new Error(_0x31e3d4(0x190)+_0x3fc250[_0x31e3d4(0x1db)]);}const _0x1eac92=await _0x3fc250['json']();loggerService_1[_0x31e3d4(0x189)]['logWhiteDomainResponse'](_0x31e3d4(0x1a2),_0x31e3d4(0x1dc)+_0x32b0c1,_0x3fc250['status'],_0x1eac92,_0x27b7e9);if(_0x1eac92['status']?.[_0x31e3d4(0x1db)]!==_0x31e3d4(0x1cb)){loggerService_1['loggerService'][_0x31e3d4(0x1d5)](_0x31e3d4(0x1a2),_0x31e3d4(0x1dc)+_0x32b0c1,_0x31e3d4(0x1a7)+(_0x1eac92[_0x31e3d4(0x1db)]?.[_0x31e3d4(0x1ae)]||_0x31e3d4(0x19a)));throw new Error(_0x31e3d4(0x1a7)+(_0x1eac92[_0x31e3d4(0x1db)]?.[_0x31e3d4(0x1ae)]||'Unknown\x20error'));}let _0x3c09cb=_0x31e3d4(0x1c7);if(_0x1eac92[_0x31e3d4(0x1aa)]?.[_0x31e3d4(0x1db)])switch(_0x1eac92['data'][_0x31e3d4(0x1db)][_0x31e3d4(0x18c)]()){case'CLO':_0x3c09cb=_0x31e3d4(0x194);break;case _0x31e3d4(0x1f3):_0x3c09cb=_0x31e3d4(0x1ce);break;case'EXP':_0x3c09cb=_0x31e3d4(0x18f);break;case _0x31e3d4(0x18e):_0x3c09cb=_0x31e3d4(0x1ce);break;case _0x31e3d4(0x1b1):case _0x31e3d4(0x188):default:_0x3c09cb=_0x31e3d4(0x1c7);break;}return{'status':_0x3c09cb,'amount':_0x1eac92['data']?.[_0x31e3d4(0x1cd)],'currency':_0x1eac92[_0x31e3d4(0x1aa)]?.[_0x31e3d4(0x1c1)]};}catch(_0x35c4a6){console['error'](_0x31e3d4(0x181),_0x35c4a6),loggerService_1['loggerService'][_0x31e3d4(0x1d5)](_0x31e3d4(0x1a2),_0x31e3d4(0x1dc)+_0x32b0c1,_0x35c4a6);throw new Error(_0x31e3d4(0x1f4)+(_0x35c4a6 instanceof Error?_0x35c4a6[_0x31e3d4(0x1ae)]:_0x31e3d4(0x19a)));}}async['processWebhook'](_0x4e00c4){const _0x157a13=a45_0x39937d;console['log'](_0x157a13(0x19b),_0x4e00c4);let _0x1d0f31='PENDING',_0x12e18c;_0x4e00c4[_0x157a13(0x1aa)]?.[_0x157a13(0x1b9)]&&(_0x12e18c=_0x4e00c4[_0x157a13(0x1aa)][_0x157a13(0x1b9)],console['log'](_0x157a13(0x1b5)+_0x12e18c));switch(_0x4e00c4[_0x157a13(0x1f2)]?.[_0x157a13(0x18c)]()){case _0x157a13(0x19e):_0x4e00c4[_0x157a13(0x1aa)]?.[_0x157a13(0x1ac)]===!![]&&_0x4e00c4[_0x157a13(0x1aa)]?.[_0x157a13(0x1db)]===_0x157a13(0x1b8)?_0x1d0f31=_0x157a13(0x194):_0x1d0f31=_0x157a13(0x1c7);break;case _0x157a13(0x1e3):_0x1d0f31=_0x157a13(0x1ce);break;case'PAYMENT_EXPIRED':_0x1d0f31=_0x157a13(0x18f);break;case _0x157a13(0x1bd):_0x1d0f31=_0x157a13(0x1ce);!_0x12e18c&&_0x4e00c4['data']?.['failure_message']&&(_0x12e18c=_0x4e00c4[_0x157a13(0x1aa)][_0x157a13(0x1b9)]);break;default:switch(_0x4e00c4[_0x157a13(0x1aa)]?.[_0x157a13(0x1db)]?.[_0x157a13(0x18c)]()){case _0x157a13(0x1b8):_0x4e00c4[_0x157a13(0x1aa)]?.[_0x157a13(0x1ac)]===!![]?_0x1d0f31=_0x157a13(0x194):_0x1d0f31=_0x157a13(0x1ce);break;case _0x157a13(0x1f3):_0x1d0f31=_0x157a13(0x1ce);break;case _0x157a13(0x198):_0x1d0f31='EXPIRED';break;case _0x157a13(0x18e):_0x1d0f31=_0x157a13(0x1ce);!_0x12e18c&&_0x4e00c4[_0x157a13(0x1aa)]?.['failure_message']&&(_0x12e18c=_0x4e00c4[_0x157a13(0x1aa)]['failure_message']);break;case _0x157a13(0x1b1):case _0x157a13(0x188):default:_0x1d0f31=_0x157a13(0x1c7);break;}break;}const _0x1a4c5a={};return _0x4e00c4['data']?.[_0x157a13(0x1af)]?.[_0x157a13(0x1a4)]&&(_0x1a4c5a[_0x157a13(0x18d)]=_0x4e00c4[_0x157a13(0x1aa)][_0x157a13(0x1af)][_0x157a13(0x1a4)]),_0x4e00c4[_0x157a13(0x1aa)]?.[_0x157a13(0x1cc)]&&(_0x1a4c5a['paymentMethod']=_0x4e00c4[_0x157a13(0x1aa)][_0x157a13(0x1cc)]),_0x4e00c4['data']?.['error_code']&&(_0x1a4c5a['errorCode']=_0x4e00c4['data'][_0x157a13(0x1fb)]),_0x4e00c4[_0x157a13(0x1aa)]?.['failure_code']&&(_0x1a4c5a[_0x157a13(0x1a5)]=_0x4e00c4[_0x157a13(0x1aa)][_0x157a13(0x1df)]),console[_0x157a13(0x1b0)]('üîÑ\x20Rapyd\x20webhook\x20processed:\x20status='+_0x1d0f31+',\x20failureMessage='+(_0x12e18c||'none')),{'paymentId':_0x4e00c4['data']?.['merchant_reference_id']||'','status':_0x1d0f31,'amount':_0x4e00c4[_0x157a13(0x1aa)]?.[_0x157a13(0x1cd)],'currency':_0x4e00c4[_0x157a13(0x1aa)]?.['currency'],'failureMessage':_0x12e18c,'additionalInfo':_0x1a4c5a};}}exports[a45_0x39937d(0x1ad)]=RapydService;