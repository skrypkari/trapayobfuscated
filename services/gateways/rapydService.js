'use strict';const a46_0x2c3bac=a46_0x2568;(function(_0x5e7800,_0x497b4a){const _0xdba31c=a46_0x2568,_0x447240=_0x5e7800();while(!![]){try{const _0x3c7ae6=-parseInt(_0xdba31c(0x1a8))/0x1*(parseInt(_0xdba31c(0x12d))/0x2)+parseInt(_0xdba31c(0x188))/0x3*(parseInt(_0xdba31c(0x1a5))/0x4)+-parseInt(_0xdba31c(0x171))/0x5+parseInt(_0xdba31c(0x192))/0x6+parseInt(_0xdba31c(0x189))/0x7*(parseInt(_0xdba31c(0x159))/0x8)+-parseInt(_0xdba31c(0x172))/0x9*(-parseInt(_0xdba31c(0x1a7))/0xa)+-parseInt(_0xdba31c(0x199))/0xb;if(_0x3c7ae6===_0x497b4a)break;else _0x447240['push'](_0x447240['shift']());}catch(_0x4a0bc0){_0x447240['push'](_0x447240['shift']());}}}(a46_0x5411,0x6b9bd));Object[a46_0x2c3bac(0x15c)](exports,a46_0x2c3bac(0x136),{'value':!![]}),exports[a46_0x2c3bac(0x17c)]=void 0x0;const loggerService_1=require(a46_0x2c3bac(0x148));class RapydService{constructor(){const _0x5dd56b=a46_0x2c3bac;this['apiUrl']=_0x5dd56b(0x18f),console[_0x5dd56b(0x173)](_0x5dd56b(0x18b));}async['createPaymentLink'](_0x391388){const _0x310d95=a46_0x2c3bac,{orderId:_0x59c61b,orderName:_0x12c6a1,amount:_0xd38e3,currency:_0x37dc32,usage:_0x5e0f5b,maxPayments:_0x1f6d0a,successUrl:_0x2f6e9b,failUrl:_0x3b68b3}=_0x391388,_0x295b9c=_0x37dc32[_0x310d95(0x197)](),_0x30b1b1='GB';console['log']('🇬🇧\x20Using\x20GB\x20(Britain)\x20as\x20country\x20for\x20Rapyd\x20payment\x20link');const _0x18feee=_0x310d95(0x149)+_0x59c61b,_0x5e2a7c='https://tesoft.uk/gateway/fail.php?id='+_0x59c61b,_0x2b85e4={'amount':_0xd38e3,'currency':_0x295b9c,'cancel_checkout_url':_0x5e2a7c,'complete_checkout_url':_0x18feee,'complete_payment_url':_0x18feee,'merchant_reference_id':_0x59c61b,'description':_0x310d95(0x153)+_0x59c61b,'country':'GB','payment_method_types_include':[_0x310d95(0x178),_0x310d95(0x12b)],'custom_elements':{'display_description':!![]}},_0x3cf6f8=Date[_0x310d95(0x17f)]();try{console['log'](_0x310d95(0x134)),console[_0x310d95(0x173)]('URL:',this[_0x310d95(0x163)]),console[_0x310d95(0x173)](_0x310d95(0x1a0),JSON[_0x310d95(0x160)](_0x2b85e4,null,0x2)),console[_0x310d95(0x173)](_0x310d95(0x158)+_0x30b1b1+_0x310d95(0x15a)),console[_0x310d95(0x173)](_0x310d95(0x145)),loggerService_1[_0x310d95(0x184)][_0x310d95(0x137)](_0x310d95(0x19b),_0x310d95(0x13f),_0x310d95(0x18e),_0x2b85e4);const _0x4ae562=await fetch(this[_0x310d95(0x163)],{'method':_0x310d95(0x18e),'headers':{'Content-Type':_0x310d95(0x179),'User-Agent':'TesSoft\x20Payment\x20System/1.0'},'body':JSON[_0x310d95(0x160)](_0x2b85e4)}),_0x579c76=Date[_0x310d95(0x17f)]()-_0x3cf6f8;console[_0x310d95(0x173)](_0x310d95(0x14f)),console[_0x310d95(0x173)](_0x310d95(0x18d),_0x4ae562[_0x310d95(0x196)]),console[_0x310d95(0x173)](_0x310d95(0x154),_0x4ae562[_0x310d95(0x12c)]),console[_0x310d95(0x173)](_0x310d95(0x15b),Object[_0x310d95(0x14e)](_0x4ae562[_0x310d95(0x133)][_0x310d95(0x13d)]())),console[_0x310d95(0x173)]('Response\x20Time:',_0x579c76+'ms');const _0x40e26b=await _0x4ae562[_0x310d95(0x13e)]();console[_0x310d95(0x173)](_0x310d95(0x139),_0x40e26b);if(!_0x4ae562['ok']){console['error'](_0x310d95(0x143)),console[_0x310d95(0x14a)](_0x310d95(0x144),_0x4ae562[_0x310d95(0x196)]),console[_0x310d95(0x14a)](_0x310d95(0x132),_0x40e26b),loggerService_1['loggerService'][_0x310d95(0x16f)](_0x310d95(0x19b),_0x310d95(0x13f),_0x4ae562[_0x310d95(0x196)],_0x40e26b,_0x579c76),loggerService_1['loggerService'][_0x310d95(0x19c)](_0x310d95(0x19b),'/v1/hosted/payment_links','HTTP\x20'+_0x4ae562[_0x310d95(0x196)]+':\x20'+_0x40e26b);throw new Error(_0x310d95(0x1a1)+_0x4ae562[_0x310d95(0x196)]+_0x310d95(0x155)+_0x40e26b);}let _0x47b3c3;try{_0x47b3c3=JSON[_0x310d95(0x168)](_0x40e26b);}catch(_0x3f3468){console[_0x310d95(0x14a)]('Failed\x20to\x20parse\x20JSON\x20response:',_0x3f3468),loggerService_1[_0x310d95(0x184)][_0x310d95(0x19c)](_0x310d95(0x19b),_0x310d95(0x13f),_0x310d95(0x13a)+_0x3f3468);throw new Error(_0x310d95(0x131)+_0x40e26b);}console[_0x310d95(0x173)](_0x310d95(0x170)),console['log'](_0x310d95(0x183),JSON[_0x310d95(0x160)](_0x47b3c3,null,0x2)),loggerService_1[_0x310d95(0x184)][_0x310d95(0x16f)](_0x310d95(0x19b),_0x310d95(0x13f),_0x4ae562['status'],_0x47b3c3,_0x579c76);if(_0x47b3c3[_0x310d95(0x196)]?.[_0x310d95(0x196)]!==_0x310d95(0x19e)){const _0x1bf3b1=_0x47b3c3[_0x310d95(0x196)]?.['message']||_0x310d95(0x165),_0x339f3e=_0x47b3c3[_0x310d95(0x196)]?.['error_code']||_0x310d95(0x17e);console[_0x310d95(0x14a)](_0x310d95(0x142)),console[_0x310d95(0x14a)](_0x310d95(0x167),_0x339f3e),console[_0x310d95(0x14a)](_0x310d95(0x138),_0x1bf3b1),console[_0x310d95(0x14a)](_0x310d95(0x17b),_0x47b3c3[_0x310d95(0x196)]),loggerService_1['loggerService']['logWhiteDomainError'](_0x310d95(0x19b),'/v1/hosted/payment_links',_0x310d95(0x194)+_0x339f3e+_0x310d95(0x1a3)+_0x1bf3b1);throw new Error(_0x310d95(0x12e)+_0x339f3e+_0x310d95(0x1a3)+_0x1bf3b1);}if(!_0x47b3c3[_0x310d95(0x16d)]?.['id']||!_0x47b3c3[_0x310d95(0x16d)]?.[_0x310d95(0x17d)]){console[_0x310d95(0x14a)](_0x310d95(0x164)),console[_0x310d95(0x14a)](_0x310d95(0x193)),console[_0x310d95(0x14a)]('Response\x20data:',_0x47b3c3['data']),loggerService_1[_0x310d95(0x184)][_0x310d95(0x19c)](_0x310d95(0x19b),'/v1/hosted/payment_links',_0x310d95(0x13c));throw new Error(_0x310d95(0x15e));}return console[_0x310d95(0x173)](_0x310d95(0x14d)),console[_0x310d95(0x173)](_0x310d95(0x146),_0x47b3c3[_0x310d95(0x16d)]['id']),console[_0x310d95(0x173)](_0x310d95(0x151),_0x47b3c3[_0x310d95(0x16d)][_0x310d95(0x17d)]),console[_0x310d95(0x173)](_0x310d95(0x15f)+_0x30b1b1+_0x310d95(0x15d)),console['log'](_0x310d95(0x145)),{'gateway_payment_id':_0x47b3c3['data']['id'],'payment_url':_0x47b3c3[_0x310d95(0x16d)][_0x310d95(0x17d)]};}catch(_0x398e60){console[_0x310d95(0x14a)](_0x310d95(0x1a6)),console[_0x310d95(0x14a)](_0x310d95(0x190),_0x398e60),loggerService_1[_0x310d95(0x184)][_0x310d95(0x19c)]('rapyd','/v1/hosted/payment_links',_0x398e60);if(_0x398e60 instanceof Error){console['error'](_0x310d95(0x14c),_0x398e60[_0x310d95(0x187)]),console[_0x310d95(0x14a)](_0x310d95(0x17a),_0x398e60[_0x310d95(0x16e)]);throw new Error('Failed\x20to\x20create\x20Rapyd\x20payment\x20link:\x20'+_0x398e60[_0x310d95(0x187)]);}throw new Error(_0x310d95(0x161));}}async[a46_0x2c3bac(0x198)](_0x5ddd07){const _0x2aaf9c=a46_0x2c3bac,_0x41933a=Date[_0x2aaf9c(0x17f)]();try{loggerService_1[_0x2aaf9c(0x184)]['logWhiteDomainRequest']('rapyd','/v1/hosted/payment_links/'+_0x5ddd07,_0x2aaf9c(0x18c),{});const _0x412357=await fetch(this[_0x2aaf9c(0x163)]+'/'+_0x5ddd07,{'method':_0x2aaf9c(0x18c),'headers':{'Content-Type':'application/json','User-Agent':_0x2aaf9c(0x175)}}),_0x313610=Date['now']()-_0x41933a;if(!_0x412357['ok']){const _0xd70411=await _0x412357[_0x2aaf9c(0x13e)]();loggerService_1[_0x2aaf9c(0x184)][_0x2aaf9c(0x16f)](_0x2aaf9c(0x19b),'/v1/hosted/payment_links/'+_0x5ddd07,_0x412357[_0x2aaf9c(0x196)],_0xd70411,_0x313610);throw new Error('HTTP\x20error!\x20status:\x20'+_0x412357[_0x2aaf9c(0x196)]);}const _0x1a879b=await _0x412357[_0x2aaf9c(0x135)]();loggerService_1['loggerService'][_0x2aaf9c(0x16f)](_0x2aaf9c(0x19b),_0x2aaf9c(0x19d)+_0x5ddd07,_0x412357[_0x2aaf9c(0x196)],_0x1a879b,_0x313610);if(_0x1a879b[_0x2aaf9c(0x196)]?.[_0x2aaf9c(0x196)]!==_0x2aaf9c(0x19e)){loggerService_1['loggerService'][_0x2aaf9c(0x19c)]('rapyd',_0x2aaf9c(0x19d)+_0x5ddd07,_0x2aaf9c(0x182)+(_0x1a879b[_0x2aaf9c(0x196)]?.[_0x2aaf9c(0x187)]||_0x2aaf9c(0x18a)));throw new Error(_0x2aaf9c(0x182)+(_0x1a879b[_0x2aaf9c(0x196)]?.['message']||_0x2aaf9c(0x18a)));}let _0x39910f='PENDING';if(_0x1a879b[_0x2aaf9c(0x16d)]?.[_0x2aaf9c(0x196)])switch(_0x1a879b[_0x2aaf9c(0x16d)]['status'][_0x2aaf9c(0x197)]()){case'CLO':_0x39910f=_0x2aaf9c(0x16a);break;case'CAN':_0x39910f=_0x2aaf9c(0x174);break;case'EXP':_0x39910f='EXPIRED';break;case _0x2aaf9c(0x166):_0x39910f=_0x2aaf9c(0x174);break;case'NEW':case'ACT':default:_0x39910f=_0x2aaf9c(0x186);break;}return{'status':_0x39910f,'amount':_0x1a879b['data']?.[_0x2aaf9c(0x12f)],'currency':_0x1a879b['data']?.[_0x2aaf9c(0x130)]};}catch(_0x39c39c){console[_0x2aaf9c(0x14a)]('Rapyd\x20payment\x20verification\x20error:',_0x39c39c),loggerService_1[_0x2aaf9c(0x184)]['logWhiteDomainError'](_0x2aaf9c(0x19b),_0x2aaf9c(0x19d)+_0x5ddd07,_0x39c39c);throw new Error('Failed\x20to\x20verify\x20Rapyd\x20payment:\x20'+(_0x39c39c instanceof Error?_0x39c39c[_0x2aaf9c(0x187)]:_0x2aaf9c(0x18a)));}}async[a46_0x2c3bac(0x13b)](_0x6db5ce){const _0x76dcb5=a46_0x2c3bac;console['log'](_0x76dcb5(0x150),_0x6db5ce);let _0x5945d3='PENDING',_0x2dab3a;_0x6db5ce['data']?.[_0x76dcb5(0x19a)]&&(_0x2dab3a=_0x6db5ce[_0x76dcb5(0x16d)][_0x76dcb5(0x19a)],console[_0x76dcb5(0x173)](_0x76dcb5(0x176)+_0x2dab3a));switch(_0x6db5ce['type']?.['toUpperCase']()){case _0x76dcb5(0x162):_0x6db5ce[_0x76dcb5(0x16d)]?.[_0x76dcb5(0x185)]===!![]&&_0x6db5ce[_0x76dcb5(0x16d)]?.['status']===_0x76dcb5(0x16c)?_0x5945d3=_0x76dcb5(0x16a):_0x5945d3='PENDING';break;case'PAYMENT_CANCELED':_0x5945d3=_0x76dcb5(0x174);break;case _0x76dcb5(0x16b):_0x5945d3=_0x76dcb5(0x14b);break;case _0x76dcb5(0x177):_0x5945d3=_0x76dcb5(0x174);!_0x2dab3a&&_0x6db5ce['data']?.[_0x76dcb5(0x19a)]&&(_0x2dab3a=_0x6db5ce[_0x76dcb5(0x16d)][_0x76dcb5(0x19a)]);break;default:switch(_0x6db5ce['data']?.[_0x76dcb5(0x196)]?.[_0x76dcb5(0x197)]()){case _0x76dcb5(0x16c):_0x6db5ce[_0x76dcb5(0x16d)]?.[_0x76dcb5(0x185)]===!![]?_0x5945d3=_0x76dcb5(0x16a):_0x5945d3=_0x76dcb5(0x174);break;case _0x76dcb5(0x180):_0x5945d3=_0x76dcb5(0x174);break;case _0x76dcb5(0x140):_0x5945d3=_0x76dcb5(0x14b);break;case'ERR':_0x5945d3=_0x76dcb5(0x174);!_0x2dab3a&&_0x6db5ce[_0x76dcb5(0x16d)]?.['failure_message']&&(_0x2dab3a=_0x6db5ce['data'][_0x76dcb5(0x19a)]);break;case _0x76dcb5(0x1a4):case'ACT':default:_0x5945d3='PENDING';break;}break;}const _0x3b1a06={};return _0x6db5ce[_0x76dcb5(0x16d)]?.[_0x76dcb5(0x156)]?.[_0x76dcb5(0x191)]&&(_0x3b1a06[_0x76dcb5(0x19f)]=_0x6db5ce['data'][_0x76dcb5(0x156)][_0x76dcb5(0x191)]),_0x6db5ce[_0x76dcb5(0x16d)]?.['payment_method_type']&&(_0x3b1a06[_0x76dcb5(0x181)]=_0x6db5ce[_0x76dcb5(0x16d)][_0x76dcb5(0x1a2)]),_0x6db5ce[_0x76dcb5(0x16d)]?.['error_code']&&(_0x3b1a06[_0x76dcb5(0x141)]=_0x6db5ce['data'][_0x76dcb5(0x157)]),_0x6db5ce['data']?.['failure_code']&&(_0x3b1a06[_0x76dcb5(0x147)]=_0x6db5ce[_0x76dcb5(0x16d)][_0x76dcb5(0x152)]),console[_0x76dcb5(0x173)](_0x76dcb5(0x195)+_0x5945d3+',\x20failureMessage='+(_0x2dab3a||_0x76dcb5(0x169))),{'paymentId':_0x6db5ce[_0x76dcb5(0x16d)]?.['merchant_reference_id']||'','status':_0x5945d3,'amount':_0x6db5ce[_0x76dcb5(0x16d)]?.[_0x76dcb5(0x12f)],'currency':_0x6db5ce[_0x76dcb5(0x16d)]?.['currency'],'failureMessage':_0x2dab3a,'additionalInfo':_0x3b1a06};}}function a46_0x2568(_0x3115bc,_0xd321b4){const _0x54115a=a46_0x5411();return a46_0x2568=function(_0x256849,_0x57310d){_0x256849=_0x256849-0x12b;let _0x13156a=_0x54115a[_0x256849];return _0x13156a;},a46_0x2568(_0x3115bc,_0xd321b4);}exports[a46_0x2c3bac(0x17c)]=RapydService;function a46_0x5411(){const _0x5214dc=['headers','===\x20RAPYD\x20API\x20REQUEST\x20(White\x20Domain\x20-\x20Updated\x20Format)\x20===','json','__esModule','logWhiteDomainRequest','Error\x20Message:','Raw\x20Response\x20Body:','JSON\x20Parse\x20Error:\x20','processWebhook','Incomplete\x20response:\x20missing\x20id\x20or\x20redirect_url','entries','text','/v1/hosted/payment_links','EXP','errorCode','===\x20RAPYD\x20API\x20BUSINESS\x20ERROR\x20===','===\x20RAPYD\x20API\x20ERROR\x20===','HTTP\x20Status:','💳\x20Payment\x20Methods:\x20gb_visa_card,\x20gb_mastercard_card','Payment\x20Link\x20ID:','failureCode','../loggerService','https://tesoft.uk/gateway/success.php?id=','error','EXPIRED','Error\x20message:','===\x20RAPYD\x20SUCCESS\x20===','fromEntries','===\x20RAPYD\x20API\x20RESPONSE\x20(White\x20Domain)\x20===','Processing\x20Rapyd\x20webhook:','Redirect\x20URL:','failure_code','ORDER:\x20','Status\x20Text:',',\x20body:\x20','payment_method_data','error_code','🇬🇧\x20Country:\x20','32888dqodgN','\x20(always\x20GB\x20for\x20Rapyd)','Headers:','defineProperty','\x20(GB\x20-\x20Britain)','Invalid\x20response\x20from\x20Rapyd\x20API:\x20missing\x20id\x20or\x20redirect_url','🇬🇧\x20Country\x20used:\x20','stringify','Failed\x20to\x20create\x20Rapyd\x20payment\x20link:\x20Unknown\x20error','PAYMENT_COMPLETED','apiUrl','===\x20RAPYD\x20API\x20INCOMPLETE\x20RESPONSE\x20===','Unknown\x20error\x20from\x20Rapyd\x20API','ERR','Error\x20Code:','parse','none','PAID','PAYMENT_EXPIRED','CLO','data','stack','logWhiteDomainResponse','===\x20PARSED\x20RAPYD\x20RESPONSE\x20===','3310055OOfreE','1845wEJbFv','log','FAILED','TesSoft\x20Payment\x20System/1.0','💥\x20Rapyd\x20failure\x20message:\x20','PAYMENT_FAILED','gb_visa_card','application/json','Error\x20stack:','Full\x20Error\x20Data:','RapydService','redirect_url','UNKNOWN','now','CAN','paymentMethod','Rapyd\x20API\x20error:\x20','Parsed\x20Result:','loggerService','paid','PENDING','message','95169qFHfyK','161ysfyRT','Unknown\x20error','🌐\x20Rapyd\x20service\x20initialized\x20with\x20white\x20domain\x20proxy','GET','Status:','POST','https://tesoft.uk/gateway/rapyd/','Error\x20details:','last4','4964574AaEEZj','Missing\x20id\x20or\x20redirect_url\x20in\x20response','Business\x20Error\x20(','🔄\x20Rapyd\x20webhook\x20processed:\x20status=','status','toUpperCase','verifyPayment','118184GfDegS','failure_message','rapyd','logWhiteDomainError','/v1/hosted/payment_links/','SUCCESS','cardLast4','Request\x20Body\x20(Updated\x20Format):','HTTP\x20error!\x20status:\x20','payment_method_type','):\x20','NEW','44MVxaki','===\x20RAPYD\x20SERVICE\x20ERROR\x20===','8500QqpiPn','1nuRcDL','gb_mastercard_card','statusText','663330srmdyd','Rapyd\x20API\x20error\x20(','amount','currency','Invalid\x20JSON\x20response\x20from\x20Rapyd\x20API:\x20','Response\x20Body:'];a46_0x5411=function(){return _0x5214dc;};return a46_0x5411();}