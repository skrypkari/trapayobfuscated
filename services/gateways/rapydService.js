'use strict';const a52_0x382e6d=a52_0x2bb5;(function(_0xa20420,_0x51703d){const _0x2c03fd=a52_0x2bb5,_0x224959=_0xa20420();while(!![]){try{const _0x147935=-parseInt(_0x2c03fd(0x129))/0x1+-parseInt(_0x2c03fd(0x134))/0x2*(parseInt(_0x2c03fd(0xfa))/0x3)+-parseInt(_0x2c03fd(0x146))/0x4+-parseInt(_0x2c03fd(0xe4))/0x5+parseInt(_0x2c03fd(0x153))/0x6+parseInt(_0x2c03fd(0x124))/0x7*(-parseInt(_0x2c03fd(0x111))/0x8)+parseInt(_0x2c03fd(0x130))/0x9;if(_0x147935===_0x51703d)break;else _0x224959['push'](_0x224959['shift']());}catch(_0x37bd79){_0x224959['push'](_0x224959['shift']());}}}(a52_0x509d,0x65a6c));function a52_0x2bb5(_0x4ef862,_0x218240){const _0x509ddf=a52_0x509d();return a52_0x2bb5=function(_0x2bb555,_0x2a29cc){_0x2bb555=_0x2bb555-0xdc;let _0x5c3bd8=_0x509ddf[_0x2bb555];return _0x5c3bd8;},a52_0x2bb5(_0x4ef862,_0x218240);}function a52_0x509d(){const _0x3debf9=['Full\x20Error\x20Data:','https://tesoft.uk/gateway/success.php?id=','🌐\x20Rapyd\x20service\x20initialized\x20with\x20white\x20domain\x20proxy','failure_code','amount','requested_currency','message','now','48905OTQpNc','https://tesoft.uk/gateway/rapyd/','payment_method_type','apiUrl','Unknown\x20error\x20from\x20Rapyd\x20API','ERR','===\x20RAPYD\x20API\x20RESPONSE\x20(White\x20Domain)\x20===','RapydService','error_code','../loggerService',',\x20failureMessage=','application/json','💥\x20Rapyd\x20failure\x20message:\x20','none','entries','🔄\x20Rapyd\x20webhook\x20processed:\x20status=','\x20(GB\x20-\x20Britain)','merchant_reference_id','PAYMENT_COMPLETED','paid','log','===\x20RAPYD\x20API\x20ERROR\x20===','21ultbSb','logWhiteDomainResponse','/v1/hosted/payment_links/','URL:','\x20(always\x20GB\x20for\x20Rapyd)','Failed\x20to\x20verify\x20Rapyd\x20payment:\x20','===\x20RAPYD\x20SUCCESS\x20===','Parsed\x20Result:','Error\x20Code:','HTTP\x20','Invalid\x20response\x20from\x20Rapyd\x20API:\x20missing\x20id\x20or\x20redirect_url','Processing\x20Rapyd\x20webhook:','POST','===\x20RAPYD\x20API\x20BUSINESS\x20ERROR\x20===','/v1/hosted/payment_links','Missing\x20id\x20or\x20redirect_url\x20in\x20response','data','Invalid\x20JSON\x20response\x20from\x20Rapyd\x20API:\x20','paymentMethod','PAID','currency','Failed\x20to\x20parse\x20JSON\x20response:','PAYMENT_CANCELED','755344sCRUue','===\x20RAPYD\x20API\x20REQUEST\x20(White\x20Domain\x20-\x20Updated\x20Format)\x20===','):\x20','createPaymentLink','ACT','GET','gb_visa_card','failure_message','Rapyd\x20API\x20error:\x20','status','text','HTTP\x20error!\x20status:\x20','JSON\x20Parse\x20Error:\x20','\x20\x20\x20expiration:\x20','===\x20RAPYD\x20SERVICE\x20ERROR\x20===','json','toISOString','defineProperty','Response\x20data:','42ObEczX','failureCode','EUR','logWhiteDomainRequest','EXPIRED','502692Dtlnmy','rapyd','headers','🇬🇧\x20Country\x20used:\x20','Status:','processWebhook','type','19291455PXhRLD','parse','Error\x20Message:','toUpperCase','172684hbbJzX','logWhiteDomainError','stringify','Redirect\x20URL:','fixed_side','FAILED','last4',',\x20body:\x20','redirect_url','CAN','Headers:','verifyPayment','payment_method_data','Unknown\x20error','💳\x20Payment\x20Methods:\x20gb_visa_card,\x20gb_mastercard_card','loggerService','PENDING','Failed\x20to\x20create\x20Rapyd\x20payment\x20link:\x20Unknown\x20error','740100RrgyhP','PAYMENT_EXPIRED','\x20->\x20EUR:','buy','PAYMENT_FAILED','EXP','Response\x20Time:','Business\x20Error\x20(','Error\x20stack:','CLO','===\x20PARSED\x20RAPYD\x20RESPONSE\x20===','ORDER:\x20','cardLast4','847614rPUfWi','TesSoft\x20Payment\x20System/1.0','error','fromEntries','Response\x20Body:'];a52_0x509d=function(){return _0x3debf9;};return a52_0x509d();}Object[a52_0x382e6d(0x122)](exports,'__esModule',{'value':!![]}),exports[a52_0x382e6d(0xeb)]=void 0x0;const loggerService_1=require(a52_0x382e6d(0xed));class RapydService{constructor(){const _0x4b6023=a52_0x382e6d;this[_0x4b6023(0xe7)]=_0x4b6023(0xe5),console[_0x4b6023(0xf8)](_0x4b6023(0xde));}async[a52_0x382e6d(0x114)](_0x55f3b0){const _0x4735b9=a52_0x382e6d,{orderId:_0x8af43a,orderName:_0x29e72b,amount:_0x42b97c,currency:_0x3ec519,usage:_0x4e3f97,maxPayments:_0x4faaee,successUrl:_0x400e97,failUrl:_0x3431e1}=_0x55f3b0,_0x26837f=_0x3ec519[_0x4735b9(0x133)](),_0x3916aa='GB';console['log']('🇬🇧\x20Using\x20GB\x20(Britain)\x20as\x20country\x20for\x20Rapyd\x20payment\x20link');const _0x32ec2a=_0x4735b9(0xdd)+_0x8af43a,_0x13fd56='https://tesoft.uk/gateway/fail.php?id='+_0x8af43a,_0x21c535={'amount':_0x42b97c,'currency':_0x26837f,'cancel_checkout_url':_0x13fd56,'complete_checkout_url':_0x32ec2a,'complete_payment_url':_0x32ec2a,'merchant_reference_id':_0x8af43a,'description':_0x4735b9(0x151)+_0x8af43a,'country':'GB','payment_method_types_include':[_0x4735b9(0x117),'gb_mastercard_card'],'custom_elements':{'display_description':!![]}};if(_0x26837f!==_0x4735b9(0x126)){const _0x3ae129=Math['floor'](Date['now']()/0x3e8)+0x1e*0x3c;_0x21c535[_0x4735b9(0x138)]=_0x4735b9(0x149),_0x21c535[_0x4735b9(0xe1)]=_0x4735b9(0x126),_0x21c535['expiration']=_0x3ae129,console[_0x4735b9(0xf8)]('💱\x20Adding\x20currency\x20conversion\x20fields\x20for\x20'+_0x26837f+_0x4735b9(0x148)),console[_0x4735b9(0xf8)]('\x20\x20\x20fixed_side:\x20buy'),console[_0x4735b9(0xf8)]('\x20\x20\x20requested_currency:\x20EUR'),console[_0x4735b9(0xf8)](_0x4735b9(0x11e)+_0x3ae129+'\x20('+new Date(_0x3ae129*0x3e8)[_0x4735b9(0x121)]()+')');}const _0x426937=Date[_0x4735b9(0xe3)]();try{console['log'](_0x4735b9(0x112)),console[_0x4735b9(0xf8)](_0x4735b9(0xfd),this['apiUrl']),console['log']('Request\x20Body\x20(Updated\x20Format):',JSON[_0x4735b9(0x136)](_0x21c535,null,0x2)),console[_0x4735b9(0xf8)]('🇬🇧\x20Country:\x20'+_0x3916aa+_0x4735b9(0xfe)),console[_0x4735b9(0xf8)]('💳\x20Payment\x20Methods:\x20gb_visa_card,\x20gb_mastercard_card'),loggerService_1[_0x4735b9(0x143)][_0x4735b9(0x127)](_0x4735b9(0x12a),'/v1/hosted/payment_links',_0x4735b9(0x106),_0x21c535);const _0x367bde=await fetch(this[_0x4735b9(0xe7)],{'method':_0x4735b9(0x106),'headers':{'Content-Type':_0x4735b9(0xef),'User-Agent':'TesSoft\x20Payment\x20System/1.0'},'body':JSON['stringify'](_0x21c535)}),_0x56c8ab=Date[_0x4735b9(0xe3)]()-_0x426937;console['log'](_0x4735b9(0xea)),console[_0x4735b9(0xf8)](_0x4735b9(0x12d),_0x367bde[_0x4735b9(0x11a)]),console['log']('Status\x20Text:',_0x367bde['statusText']),console['log'](_0x4735b9(0x13e),Object[_0x4735b9(0x156)](_0x367bde[_0x4735b9(0x12b)][_0x4735b9(0xf2)]())),console[_0x4735b9(0xf8)](_0x4735b9(0x14c),_0x56c8ab+'ms');const _0x2d4ab6=await _0x367bde[_0x4735b9(0x11b)]();console[_0x4735b9(0xf8)]('Raw\x20Response\x20Body:',_0x2d4ab6);if(!_0x367bde['ok']){console[_0x4735b9(0x155)](_0x4735b9(0xf9)),console['error']('HTTP\x20Status:',_0x367bde[_0x4735b9(0x11a)]),console[_0x4735b9(0x155)](_0x4735b9(0x157),_0x2d4ab6),loggerService_1[_0x4735b9(0x143)][_0x4735b9(0xfb)](_0x4735b9(0x12a),'/v1/hosted/payment_links',_0x367bde[_0x4735b9(0x11a)],_0x2d4ab6,_0x56c8ab),loggerService_1[_0x4735b9(0x143)]['logWhiteDomainError'](_0x4735b9(0x12a),_0x4735b9(0x108),_0x4735b9(0x103)+_0x367bde[_0x4735b9(0x11a)]+':\x20'+_0x2d4ab6);throw new Error(_0x4735b9(0x11c)+_0x367bde[_0x4735b9(0x11a)]+_0x4735b9(0x13b)+_0x2d4ab6);}let _0x248808;try{_0x248808=JSON[_0x4735b9(0x131)](_0x2d4ab6);}catch(_0xe100ab){console[_0x4735b9(0x155)](_0x4735b9(0x10f),_0xe100ab),loggerService_1[_0x4735b9(0x143)][_0x4735b9(0x135)](_0x4735b9(0x12a),_0x4735b9(0x108),_0x4735b9(0x11d)+_0xe100ab);throw new Error(_0x4735b9(0x10b)+_0x2d4ab6);}console['log'](_0x4735b9(0x150)),console[_0x4735b9(0xf8)](_0x4735b9(0x101),JSON['stringify'](_0x248808,null,0x2)),loggerService_1[_0x4735b9(0x143)][_0x4735b9(0xfb)](_0x4735b9(0x12a),_0x4735b9(0x108),_0x367bde[_0x4735b9(0x11a)],_0x248808,_0x56c8ab);if(_0x248808[_0x4735b9(0x11a)]?.['status']!=='SUCCESS'){const _0x4bcdb5=_0x248808[_0x4735b9(0x11a)]?.[_0x4735b9(0xe2)]||_0x4735b9(0xe8),_0x15217a=_0x248808[_0x4735b9(0x11a)]?.[_0x4735b9(0xec)]||'UNKNOWN';console['error'](_0x4735b9(0x107)),console[_0x4735b9(0x155)](_0x4735b9(0x102),_0x15217a),console[_0x4735b9(0x155)](_0x4735b9(0x132),_0x4bcdb5),console['error'](_0x4735b9(0xdc),_0x248808[_0x4735b9(0x11a)]),loggerService_1[_0x4735b9(0x143)][_0x4735b9(0x135)](_0x4735b9(0x12a),_0x4735b9(0x108),_0x4735b9(0x14d)+_0x15217a+_0x4735b9(0x113)+_0x4bcdb5);throw new Error('Rapyd\x20API\x20error\x20('+_0x15217a+_0x4735b9(0x113)+_0x4bcdb5);}if(!_0x248808[_0x4735b9(0x10a)]?.['id']||!_0x248808[_0x4735b9(0x10a)]?.[_0x4735b9(0x13c)]){console[_0x4735b9(0x155)]('===\x20RAPYD\x20API\x20INCOMPLETE\x20RESPONSE\x20==='),console[_0x4735b9(0x155)](_0x4735b9(0x109)),console['error'](_0x4735b9(0x123),_0x248808[_0x4735b9(0x10a)]),loggerService_1[_0x4735b9(0x143)]['logWhiteDomainError'](_0x4735b9(0x12a),'/v1/hosted/payment_links','Incomplete\x20response:\x20missing\x20id\x20or\x20redirect_url');throw new Error(_0x4735b9(0x104));}return console['log'](_0x4735b9(0x100)),console[_0x4735b9(0xf8)]('Payment\x20Link\x20ID:',_0x248808[_0x4735b9(0x10a)]['id']),console[_0x4735b9(0xf8)](_0x4735b9(0x137),_0x248808['data'][_0x4735b9(0x13c)]),console['log'](_0x4735b9(0x12c)+_0x3916aa+_0x4735b9(0xf4)),console[_0x4735b9(0xf8)](_0x4735b9(0x142)),{'gateway_payment_id':_0x248808[_0x4735b9(0x10a)]['id'],'payment_url':_0x248808[_0x4735b9(0x10a)][_0x4735b9(0x13c)]};}catch(_0x423ae4){console[_0x4735b9(0x155)](_0x4735b9(0x11f)),console['error']('Error\x20details:',_0x423ae4),loggerService_1['loggerService'][_0x4735b9(0x135)](_0x4735b9(0x12a),_0x4735b9(0x108),_0x423ae4);if(_0x423ae4 instanceof Error){console['error']('Error\x20message:',_0x423ae4[_0x4735b9(0xe2)]),console[_0x4735b9(0x155)](_0x4735b9(0x14e),_0x423ae4['stack']);throw new Error('Failed\x20to\x20create\x20Rapyd\x20payment\x20link:\x20'+_0x423ae4['message']);}throw new Error(_0x4735b9(0x145));}}async[a52_0x382e6d(0x13f)](_0x6d27d9){const _0x1bd0a3=a52_0x382e6d,_0x444991=Date['now']();try{loggerService_1[_0x1bd0a3(0x143)][_0x1bd0a3(0x127)](_0x1bd0a3(0x12a),_0x1bd0a3(0xfc)+_0x6d27d9,_0x1bd0a3(0x116),{});const _0x16ef60=await fetch(this['apiUrl']+'/'+_0x6d27d9,{'method':'GET','headers':{'Content-Type':'application/json','User-Agent':_0x1bd0a3(0x154)}}),_0x284c04=Date[_0x1bd0a3(0xe3)]()-_0x444991;if(!_0x16ef60['ok']){const _0xb76105=await _0x16ef60[_0x1bd0a3(0x11b)]();loggerService_1[_0x1bd0a3(0x143)][_0x1bd0a3(0xfb)](_0x1bd0a3(0x12a),'/v1/hosted/payment_links/'+_0x6d27d9,_0x16ef60[_0x1bd0a3(0x11a)],_0xb76105,_0x284c04);throw new Error('HTTP\x20error!\x20status:\x20'+_0x16ef60['status']);}const _0x374a24=await _0x16ef60[_0x1bd0a3(0x120)]();loggerService_1[_0x1bd0a3(0x143)][_0x1bd0a3(0xfb)](_0x1bd0a3(0x12a),_0x1bd0a3(0xfc)+_0x6d27d9,_0x16ef60[_0x1bd0a3(0x11a)],_0x374a24,_0x284c04);if(_0x374a24[_0x1bd0a3(0x11a)]?.[_0x1bd0a3(0x11a)]!=='SUCCESS'){loggerService_1[_0x1bd0a3(0x143)][_0x1bd0a3(0x135)]('rapyd',_0x1bd0a3(0xfc)+_0x6d27d9,_0x1bd0a3(0x119)+(_0x374a24['status']?.[_0x1bd0a3(0xe2)]||'Unknown\x20error'));throw new Error(_0x1bd0a3(0x119)+(_0x374a24[_0x1bd0a3(0x11a)]?.['message']||'Unknown\x20error'));}let _0x5a123b=_0x1bd0a3(0x144);if(_0x374a24[_0x1bd0a3(0x10a)]?.[_0x1bd0a3(0x11a)])switch(_0x374a24[_0x1bd0a3(0x10a)]['status']['toUpperCase']()){case _0x1bd0a3(0x14f):_0x5a123b=_0x1bd0a3(0x10d);break;case _0x1bd0a3(0x13d):_0x5a123b=_0x1bd0a3(0x139);break;case _0x1bd0a3(0x14b):_0x5a123b=_0x1bd0a3(0x128);break;case'ERR':_0x5a123b=_0x1bd0a3(0x139);break;case'NEW':case _0x1bd0a3(0x115):default:_0x5a123b=_0x1bd0a3(0x144);break;}return{'status':_0x5a123b,'amount':_0x374a24['data']?.[_0x1bd0a3(0xe0)],'currency':_0x374a24[_0x1bd0a3(0x10a)]?.[_0x1bd0a3(0x10e)]};}catch(_0x1b8b04){console[_0x1bd0a3(0x155)]('Rapyd\x20payment\x20verification\x20error:',_0x1b8b04),loggerService_1[_0x1bd0a3(0x143)][_0x1bd0a3(0x135)]('rapyd','/v1/hosted/payment_links/'+_0x6d27d9,_0x1b8b04);throw new Error(_0x1bd0a3(0xff)+(_0x1b8b04 instanceof Error?_0x1b8b04['message']:_0x1bd0a3(0x141)));}}async[a52_0x382e6d(0x12e)](_0x58f849){const _0x8f4175=a52_0x382e6d;console[_0x8f4175(0xf8)](_0x8f4175(0x105),_0x58f849);let _0x24403e=_0x8f4175(0x144),_0x4333e1;_0x58f849[_0x8f4175(0x10a)]?.[_0x8f4175(0x118)]&&(_0x4333e1=_0x58f849[_0x8f4175(0x10a)][_0x8f4175(0x118)],console[_0x8f4175(0xf8)](_0x8f4175(0xf0)+_0x4333e1));switch(_0x58f849[_0x8f4175(0x12f)]?.[_0x8f4175(0x133)]()){case _0x8f4175(0xf6):_0x58f849['data']?.[_0x8f4175(0xf7)]===!![]&&_0x58f849['data']?.[_0x8f4175(0x11a)]===_0x8f4175(0x14f)?_0x24403e=_0x8f4175(0x10d):_0x24403e='PENDING';break;case _0x8f4175(0x110):_0x24403e=_0x8f4175(0x139);break;case _0x8f4175(0x147):_0x24403e=_0x8f4175(0x128);break;case _0x8f4175(0x14a):_0x24403e=_0x8f4175(0x139);!_0x4333e1&&_0x58f849[_0x8f4175(0x10a)]?.[_0x8f4175(0x118)]&&(_0x4333e1=_0x58f849[_0x8f4175(0x10a)]['failure_message']);break;default:switch(_0x58f849['data']?.[_0x8f4175(0x11a)]?.[_0x8f4175(0x133)]()){case'CLO':_0x58f849[_0x8f4175(0x10a)]?.[_0x8f4175(0xf7)]===!![]?_0x24403e=_0x8f4175(0x10d):_0x24403e=_0x8f4175(0x139);break;case _0x8f4175(0x13d):_0x24403e='FAILED';break;case'EXP':_0x24403e=_0x8f4175(0x128);break;case _0x8f4175(0xe9):_0x24403e=_0x8f4175(0x139);!_0x4333e1&&_0x58f849[_0x8f4175(0x10a)]?.[_0x8f4175(0x118)]&&(_0x4333e1=_0x58f849['data']['failure_message']);break;case'NEW':case _0x8f4175(0x115):default:_0x24403e=_0x8f4175(0x144);break;}break;}const _0x3624d3={};return _0x58f849['data']?.['payment_method_data']?.['last4']&&(_0x3624d3[_0x8f4175(0x152)]=_0x58f849[_0x8f4175(0x10a)][_0x8f4175(0x140)][_0x8f4175(0x13a)]),_0x58f849['data']?.[_0x8f4175(0xe6)]&&(_0x3624d3[_0x8f4175(0x10c)]=_0x58f849[_0x8f4175(0x10a)]['payment_method_type']),_0x58f849[_0x8f4175(0x10a)]?.['error_code']&&(_0x3624d3['errorCode']=_0x58f849['data']['error_code']),_0x58f849[_0x8f4175(0x10a)]?.[_0x8f4175(0xdf)]&&(_0x3624d3[_0x8f4175(0x125)]=_0x58f849['data']['failure_code']),console['log'](_0x8f4175(0xf3)+_0x24403e+_0x8f4175(0xee)+(_0x4333e1||_0x8f4175(0xf1))),{'paymentId':_0x58f849['data']?.[_0x8f4175(0xf5)]||'','status':_0x24403e,'amount':_0x58f849[_0x8f4175(0x10a)]?.[_0x8f4175(0xe0)],'currency':_0x58f849['data']?.[_0x8f4175(0x10e)],'failureMessage':_0x4333e1,'additionalInfo':_0x3624d3};}}exports[a52_0x382e6d(0xeb)]=RapydService;