'use strict';function a44_0x355e(){const _0x3b7166=['Error\x20details:','apiUrl','createPaymentLink','GET','logWhiteDomainResponse','loggerService','üá¨üáß\x20Using\x20GB\x20(Britain)\x20as\x20country\x20for\x20Rapyd\x20payment\x20link','CAN','none','Unknown\x20error','payment_method_data','json','PENDING','redirect_url','FAILED','\x20(always\x20GB\x20for\x20Rapyd)','===\x20RAPYD\x20API\x20INCOMPLETE\x20RESPONSE\x20===','3151110UDiBBm','üîÑ\x20Rapyd\x20webhook\x20processed:\x20status=','RapydService','stack','Business\x20Error\x20(','üí≥\x20Payment\x20Methods:\x20gb_visa_card,\x20gb_mastercard_card','4102420kXqwyz','Rapyd\x20API\x20error\x20(','statusText','):\x20','HTTP\x20error!\x20status:\x20','3311770moLWnu','NEW','Error\x20Code:','Failed\x20to\x20parse\x20JSON\x20response:','7IRIPXq','/v1/hosted/payment_links/','299922NSinMF','Invalid\x20response\x20from\x20Rapyd\x20API:\x20missing\x20id\x20or\x20redirect_url','47552xBNamR','Response\x20Body:','parse','UNKNOWN','===\x20RAPYD\x20API\x20REQUEST\x20(White\x20Domain\x20-\x20Updated\x20Format)\x20===','amount','Request\x20Body\x20(Updated\x20Format):','5413216cppdMM','PAID','Incomplete\x20response:\x20missing\x20id\x20or\x20redirect_url','payment_method_type','../loggerService','error_code','===\x20RAPYD\x20SERVICE\x20ERROR\x20===','EXPIRED','error','type','TesSoft\x20Payment\x20System/1.0','Response\x20data:','last4','ACT','27dMbGsV','2062974aStLJz','EXP','status','ORDER:\x20','processWebhook','28hEmIHh','Failed\x20to\x20create\x20Rapyd\x20payment\x20link:\x20Unknown\x20error','Error\x20Message:','Unknown\x20error\x20from\x20Rapyd\x20API','HTTP\x20Status:','PAYMENT_COMPLETED','Failed\x20to\x20create\x20Rapyd\x20payment\x20link:\x20','log','Rapyd\x20payment\x20verification\x20error:','Redirect\x20URL:','entries','Invalid\x20JSON\x20response\x20from\x20Rapyd\x20API:\x20','failure_message','CLO','===\x20RAPYD\x20API\x20BUSINESS\x20ERROR\x20===','logWhiteDomainRequest','now','Failed\x20to\x20verify\x20Rapyd\x20payment:\x20','===\x20PARSED\x20RAPYD\x20RESPONSE\x20===','üá¨üáß\x20Country\x20used:\x20','Status\x20Text:','Rapyd\x20API\x20error:\x20','stringify','application/json','text','Missing\x20id\x20or\x20redirect_url\x20in\x20response','SUCCESS','https://tesoft.uk/gateway/success.php?id=','Response\x20Time:','Error\x20message:','Full\x20Error\x20Data:','message','failure_code','data','PAYMENT_FAILED','__esModule','/v1/hosted/payment_links','currency','toUpperCase','PAYMENT_EXPIRED','POST',',\x20body:\x20','verifyPayment','rapyd','PAYMENT_CANCELED','===\x20RAPYD\x20API\x20RESPONSE\x20(White\x20Domain)\x20===',',\x20failureMessage=','paid','URL:','logWhiteDomainError','paymentMethod','üåê\x20Rapyd\x20service\x20initialized\x20with\x20white\x20domain\x20proxy'];a44_0x355e=function(){return _0x3b7166;};return a44_0x355e();}const a44_0x4bdbd4=a44_0x47a5;(function(_0x9bafbb,_0xbf8b85){const _0x4b12de=a44_0x47a5,_0x623cac=_0x9bafbb();while(!![]){try{const _0x34b558=parseInt(_0x4b12de(0x197))/0x1*(parseInt(_0x4b12de(0x1b2))/0x2)+-parseInt(_0x4b12de(0x1ad))/0x3+parseInt(_0x4b12de(0x18a))/0x4+-parseInt(_0x4b12de(0x18f))/0x5+-parseInt(_0x4b12de(0x195))/0x6*(parseInt(_0x4b12de(0x193))/0x7)+-parseInt(_0x4b12de(0x19e))/0x8+-parseInt(_0x4b12de(0x1ac))/0x9*(-parseInt(_0x4b12de(0x184))/0xa);if(_0x34b558===_0xbf8b85)break;else _0x623cac['push'](_0x623cac['shift']());}catch(_0x314692){_0x623cac['push'](_0x623cac['shift']());}}}(a44_0x355e,0x88b8f));function a44_0x47a5(_0x134057,_0x267af9){const _0x355ebb=a44_0x355e();return a44_0x47a5=function(_0x47a510,_0xba2880){_0x47a510=_0x47a510-0x14c;let _0x541cb4=_0x355ebb[_0x47a510];return _0x541cb4;},a44_0x47a5(_0x134057,_0x267af9);}Object['defineProperty'](exports,a44_0x4bdbd4(0x162),{'value':!![]}),exports[a44_0x4bdbd4(0x186)]=void 0x0;const loggerService_1=require(a44_0x4bdbd4(0x1a2));class RapydService{constructor(){const _0xe20ea3=a44_0x4bdbd4;this[_0xe20ea3(0x174)]='https://tesoft.uk/gateway/rapyd/',console[_0xe20ea3(0x1b9)](_0xe20ea3(0x172));}async[a44_0x4bdbd4(0x175)](_0x3a184a){const _0x3ce395=a44_0x4bdbd4,{orderId:_0x1db002,orderName:_0x2e76b3,amount:_0xe66e19,currency:_0x389a0d,usage:_0x37fadf,maxPayments:_0x17401e,successUrl:_0x4d4503,failUrl:_0x1da11a}=_0x3a184a,_0x21cd15=_0x389a0d[_0x3ce395(0x165)](),_0x16263c='GB';console[_0x3ce395(0x1b9)](_0x3ce395(0x179));const _0x139b8a=_0x3ce395(0x15a)+_0x1db002,_0x2b1b0a='https://tesoft.uk/gateway/fail.php?id='+_0x1db002,_0x20cb4c={'amount':_0xe66e19,'currency':_0x21cd15,'cancel_checkout_url':_0x2b1b0a,'complete_checkout_url':_0x139b8a,'complete_payment_url':_0x139b8a,'merchant_reference_id':_0x1db002,'description':_0x3ce395(0x1b0)+_0x1db002,'country':'GB','payment_method_types_include':['gb_visa_card','gb_mastercard_card'],'custom_elements':{'display_description':!![]}},_0x435f6c=Date[_0x3ce395(0x14f)]();try{console[_0x3ce395(0x1b9)](_0x3ce395(0x19b)),console[_0x3ce395(0x1b9)](_0x3ce395(0x16f),this[_0x3ce395(0x174)]),console[_0x3ce395(0x1b9)](_0x3ce395(0x19d),JSON[_0x3ce395(0x155)](_0x20cb4c,null,0x2)),console[_0x3ce395(0x1b9)]('üá¨üáß\x20Country:\x20'+_0x16263c+_0x3ce395(0x182)),console[_0x3ce395(0x1b9)](_0x3ce395(0x189)),loggerService_1[_0x3ce395(0x178)][_0x3ce395(0x14e)](_0x3ce395(0x16a),_0x3ce395(0x163),'POST',_0x20cb4c);const _0x5375be=await fetch(this[_0x3ce395(0x174)],{'method':_0x3ce395(0x167),'headers':{'Content-Type':'application/json','User-Agent':_0x3ce395(0x1a8)},'body':JSON[_0x3ce395(0x155)](_0x20cb4c)}),_0x2b2916=Date[_0x3ce395(0x14f)]()-_0x435f6c;console[_0x3ce395(0x1b9)](_0x3ce395(0x16c)),console[_0x3ce395(0x1b9)]('Status:',_0x5375be[_0x3ce395(0x1af)]),console['log'](_0x3ce395(0x153),_0x5375be[_0x3ce395(0x18c)]),console['log']('Headers:',Object['fromEntries'](_0x5375be['headers'][_0x3ce395(0x1bc)]())),console[_0x3ce395(0x1b9)](_0x3ce395(0x15b),_0x2b2916+'ms');const _0x22984a=await _0x5375be[_0x3ce395(0x157)]();console[_0x3ce395(0x1b9)]('Raw\x20Response\x20Body:',_0x22984a);if(!_0x5375be['ok']){console[_0x3ce395(0x1a6)]('===\x20RAPYD\x20API\x20ERROR\x20==='),console[_0x3ce395(0x1a6)](_0x3ce395(0x1b6),_0x5375be['status']),console[_0x3ce395(0x1a6)](_0x3ce395(0x198),_0x22984a),loggerService_1[_0x3ce395(0x178)][_0x3ce395(0x177)](_0x3ce395(0x16a),_0x3ce395(0x163),_0x5375be[_0x3ce395(0x1af)],_0x22984a,_0x2b2916),loggerService_1[_0x3ce395(0x178)]['logWhiteDomainError']('rapyd','/v1/hosted/payment_links','HTTP\x20'+_0x5375be[_0x3ce395(0x1af)]+':\x20'+_0x22984a);throw new Error(_0x3ce395(0x18e)+_0x5375be['status']+_0x3ce395(0x168)+_0x22984a);}let _0x5b1efd;try{_0x5b1efd=JSON[_0x3ce395(0x199)](_0x22984a);}catch(_0x4727ec){console[_0x3ce395(0x1a6)](_0x3ce395(0x192),_0x4727ec),loggerService_1[_0x3ce395(0x178)]['logWhiteDomainError']('rapyd',_0x3ce395(0x163),'JSON\x20Parse\x20Error:\x20'+_0x4727ec);throw new Error(_0x3ce395(0x1bd)+_0x22984a);}console['log'](_0x3ce395(0x151)),console[_0x3ce395(0x1b9)]('Parsed\x20Result:',JSON[_0x3ce395(0x155)](_0x5b1efd,null,0x2)),loggerService_1['loggerService'][_0x3ce395(0x177)]('rapyd',_0x3ce395(0x163),_0x5375be[_0x3ce395(0x1af)],_0x5b1efd,_0x2b2916);if(_0x5b1efd[_0x3ce395(0x1af)]?.['status']!==_0x3ce395(0x159)){const _0x4805d9=_0x5b1efd[_0x3ce395(0x1af)]?.['message']||_0x3ce395(0x1b5),_0x1337cb=_0x5b1efd[_0x3ce395(0x1af)]?.[_0x3ce395(0x1a3)]||_0x3ce395(0x19a);console[_0x3ce395(0x1a6)](_0x3ce395(0x14d)),console[_0x3ce395(0x1a6)](_0x3ce395(0x191),_0x1337cb),console[_0x3ce395(0x1a6)](_0x3ce395(0x1b4),_0x4805d9),console[_0x3ce395(0x1a6)](_0x3ce395(0x15d),_0x5b1efd['status']),loggerService_1[_0x3ce395(0x178)]['logWhiteDomainError'](_0x3ce395(0x16a),_0x3ce395(0x163),_0x3ce395(0x188)+_0x1337cb+_0x3ce395(0x18d)+_0x4805d9);throw new Error(_0x3ce395(0x18b)+_0x1337cb+_0x3ce395(0x18d)+_0x4805d9);}if(!_0x5b1efd[_0x3ce395(0x160)]?.['id']||!_0x5b1efd[_0x3ce395(0x160)]?.[_0x3ce395(0x180)]){console[_0x3ce395(0x1a6)](_0x3ce395(0x183)),console[_0x3ce395(0x1a6)](_0x3ce395(0x158)),console[_0x3ce395(0x1a6)](_0x3ce395(0x1a9),_0x5b1efd[_0x3ce395(0x160)]),loggerService_1['loggerService'][_0x3ce395(0x170)](_0x3ce395(0x16a),_0x3ce395(0x163),_0x3ce395(0x1a0));throw new Error(_0x3ce395(0x196));}return console[_0x3ce395(0x1b9)]('===\x20RAPYD\x20SUCCESS\x20==='),console[_0x3ce395(0x1b9)]('Payment\x20Link\x20ID:',_0x5b1efd[_0x3ce395(0x160)]['id']),console[_0x3ce395(0x1b9)](_0x3ce395(0x1bb),_0x5b1efd[_0x3ce395(0x160)][_0x3ce395(0x180)]),console[_0x3ce395(0x1b9)](_0x3ce395(0x152)+_0x16263c+'\x20(GB\x20-\x20Britain)'),console[_0x3ce395(0x1b9)](_0x3ce395(0x189)),{'gateway_payment_id':_0x5b1efd[_0x3ce395(0x160)]['id'],'payment_url':_0x5b1efd[_0x3ce395(0x160)][_0x3ce395(0x180)]};}catch(_0x2cf1c3){console[_0x3ce395(0x1a6)](_0x3ce395(0x1a4)),console[_0x3ce395(0x1a6)](_0x3ce395(0x173),_0x2cf1c3),loggerService_1[_0x3ce395(0x178)]['logWhiteDomainError'](_0x3ce395(0x16a),_0x3ce395(0x163),_0x2cf1c3);if(_0x2cf1c3 instanceof Error){console[_0x3ce395(0x1a6)](_0x3ce395(0x15c),_0x2cf1c3[_0x3ce395(0x15e)]),console[_0x3ce395(0x1a6)]('Error\x20stack:',_0x2cf1c3[_0x3ce395(0x187)]);throw new Error(_0x3ce395(0x1b8)+_0x2cf1c3['message']);}throw new Error(_0x3ce395(0x1b3));}}async[a44_0x4bdbd4(0x169)](_0x1aa405){const _0x232b12=a44_0x4bdbd4,_0x3e0413=Date['now']();try{loggerService_1[_0x232b12(0x178)][_0x232b12(0x14e)](_0x232b12(0x16a),_0x232b12(0x194)+_0x1aa405,'GET',{});const _0x5c174c=await fetch(this[_0x232b12(0x174)]+'/'+_0x1aa405,{'method':_0x232b12(0x176),'headers':{'Content-Type':_0x232b12(0x156),'User-Agent':_0x232b12(0x1a8)}}),_0xefaca1=Date['now']()-_0x3e0413;if(!_0x5c174c['ok']){const _0x4c0ec8=await _0x5c174c[_0x232b12(0x157)]();loggerService_1[_0x232b12(0x178)][_0x232b12(0x177)](_0x232b12(0x16a),_0x232b12(0x194)+_0x1aa405,_0x5c174c[_0x232b12(0x1af)],_0x4c0ec8,_0xefaca1);throw new Error(_0x232b12(0x18e)+_0x5c174c[_0x232b12(0x1af)]);}const _0x2a5a6d=await _0x5c174c[_0x232b12(0x17e)]();loggerService_1[_0x232b12(0x178)]['logWhiteDomainResponse']('rapyd',_0x232b12(0x194)+_0x1aa405,_0x5c174c[_0x232b12(0x1af)],_0x2a5a6d,_0xefaca1);if(_0x2a5a6d[_0x232b12(0x1af)]?.[_0x232b12(0x1af)]!==_0x232b12(0x159)){loggerService_1[_0x232b12(0x178)][_0x232b12(0x170)](_0x232b12(0x16a),'/v1/hosted/payment_links/'+_0x1aa405,_0x232b12(0x154)+(_0x2a5a6d[_0x232b12(0x1af)]?.['message']||'Unknown\x20error'));throw new Error(_0x232b12(0x154)+(_0x2a5a6d['status']?.[_0x232b12(0x15e)]||_0x232b12(0x17c)));}let _0x30596c=_0x232b12(0x17f);if(_0x2a5a6d[_0x232b12(0x160)]?.[_0x232b12(0x1af)])switch(_0x2a5a6d[_0x232b12(0x160)]['status'][_0x232b12(0x165)]()){case _0x232b12(0x14c):_0x30596c='PAID';break;case _0x232b12(0x17a):_0x30596c=_0x232b12(0x181);break;case _0x232b12(0x1ae):_0x30596c='EXPIRED';break;case'ERR':_0x30596c=_0x232b12(0x181);break;case'NEW':case _0x232b12(0x1ab):default:_0x30596c=_0x232b12(0x17f);break;}return{'status':_0x30596c,'amount':_0x2a5a6d[_0x232b12(0x160)]?.[_0x232b12(0x19c)],'currency':_0x2a5a6d[_0x232b12(0x160)]?.[_0x232b12(0x164)]};}catch(_0x10e87b){console[_0x232b12(0x1a6)](_0x232b12(0x1ba),_0x10e87b),loggerService_1[_0x232b12(0x178)][_0x232b12(0x170)](_0x232b12(0x16a),_0x232b12(0x194)+_0x1aa405,_0x10e87b);throw new Error(_0x232b12(0x150)+(_0x10e87b instanceof Error?_0x10e87b[_0x232b12(0x15e)]:_0x232b12(0x17c)));}}async[a44_0x4bdbd4(0x1b1)](_0x2b4a2d){const _0x50c3c7=a44_0x4bdbd4;console[_0x50c3c7(0x1b9)]('Processing\x20Rapyd\x20webhook:',_0x2b4a2d);let _0x4ae4ab=_0x50c3c7(0x17f),_0x4c1803;_0x2b4a2d['data']?.[_0x50c3c7(0x1be)]&&(_0x4c1803=_0x2b4a2d[_0x50c3c7(0x160)][_0x50c3c7(0x1be)],console['log']('üí•\x20Rapyd\x20failure\x20message:\x20'+_0x4c1803));switch(_0x2b4a2d[_0x50c3c7(0x1a7)]?.[_0x50c3c7(0x165)]()){case _0x50c3c7(0x1b7):_0x2b4a2d['data']?.[_0x50c3c7(0x16e)]===!![]&&_0x2b4a2d['data']?.[_0x50c3c7(0x1af)]===_0x50c3c7(0x14c)?_0x4ae4ab=_0x50c3c7(0x19f):_0x4ae4ab='PENDING';break;case _0x50c3c7(0x16b):_0x4ae4ab=_0x50c3c7(0x181);break;case _0x50c3c7(0x166):_0x4ae4ab='EXPIRED';break;case _0x50c3c7(0x161):_0x4ae4ab='FAILED';!_0x4c1803&&_0x2b4a2d[_0x50c3c7(0x160)]?.['failure_message']&&(_0x4c1803=_0x2b4a2d['data'][_0x50c3c7(0x1be)]);break;default:switch(_0x2b4a2d[_0x50c3c7(0x160)]?.[_0x50c3c7(0x1af)]?.[_0x50c3c7(0x165)]()){case'CLO':_0x2b4a2d[_0x50c3c7(0x160)]?.['paid']===!![]?_0x4ae4ab=_0x50c3c7(0x19f):_0x4ae4ab='FAILED';break;case _0x50c3c7(0x17a):_0x4ae4ab='FAILED';break;case _0x50c3c7(0x1ae):_0x4ae4ab=_0x50c3c7(0x1a5);break;case'ERR':_0x4ae4ab=_0x50c3c7(0x181);!_0x4c1803&&_0x2b4a2d['data']?.[_0x50c3c7(0x1be)]&&(_0x4c1803=_0x2b4a2d[_0x50c3c7(0x160)][_0x50c3c7(0x1be)]);break;case _0x50c3c7(0x190):case'ACT':default:_0x4ae4ab=_0x50c3c7(0x17f);break;}break;}const _0x2b9ed6={};return _0x2b4a2d[_0x50c3c7(0x160)]?.[_0x50c3c7(0x17d)]?.[_0x50c3c7(0x1aa)]&&(_0x2b9ed6['cardLast4']=_0x2b4a2d[_0x50c3c7(0x160)][_0x50c3c7(0x17d)][_0x50c3c7(0x1aa)]),_0x2b4a2d['data']?.[_0x50c3c7(0x1a1)]&&(_0x2b9ed6[_0x50c3c7(0x171)]=_0x2b4a2d['data'][_0x50c3c7(0x1a1)]),_0x2b4a2d[_0x50c3c7(0x160)]?.[_0x50c3c7(0x1a3)]&&(_0x2b9ed6['errorCode']=_0x2b4a2d[_0x50c3c7(0x160)][_0x50c3c7(0x1a3)]),_0x2b4a2d['data']?.['failure_code']&&(_0x2b9ed6['failureCode']=_0x2b4a2d[_0x50c3c7(0x160)][_0x50c3c7(0x15f)]),console[_0x50c3c7(0x1b9)](_0x50c3c7(0x185)+_0x4ae4ab+_0x50c3c7(0x16d)+(_0x4c1803||_0x50c3c7(0x17b))),{'paymentId':_0x2b4a2d[_0x50c3c7(0x160)]?.['merchant_reference_id']||'','status':_0x4ae4ab,'amount':_0x2b4a2d['data']?.['amount'],'currency':_0x2b4a2d[_0x50c3c7(0x160)]?.[_0x50c3c7(0x164)],'failureMessage':_0x4c1803,'additionalInfo':_0x2b9ed6};}}exports[a44_0x4bdbd4(0x186)]=RapydService;