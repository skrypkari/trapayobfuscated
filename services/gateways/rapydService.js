'use strict';const a45_0x410d2d=a45_0x396e;(function(_0x3b0cb9,_0x62bc8e){const _0x2d422c=a45_0x396e,_0x45b6c3=_0x3b0cb9();while(!![]){try{const _0x2db390=-parseInt(_0x2d422c(0x17f))/0x1+-parseInt(_0x2d422c(0x1b5))/0x2+-parseInt(_0x2d422c(0x188))/0x3+parseInt(_0x2d422c(0x196))/0x4+parseInt(_0x2d422c(0x165))/0x5+-parseInt(_0x2d422c(0x16c))/0x6*(parseInt(_0x2d422c(0x18b))/0x7)+parseInt(_0x2d422c(0x19e))/0x8;if(_0x2db390===_0x62bc8e)break;else _0x45b6c3['push'](_0x45b6c3['shift']());}catch(_0x38144b){_0x45b6c3['push'](_0x45b6c3['shift']());}}}(a45_0x55f1,0x84b02));function a45_0x55f1(){const _0x4d4586=['Unknown\x20error','Status:','error_code','PENDING','Error\x20Message:','application/json','===\x20RAPYD\x20API\x20REQUEST\x20(White\x20Domain\x20-\x20Updated\x20Format)\x20===','Invalid\x20response\x20from\x20Rapyd\x20API:\x20missing\x20id\x20or\x20redirect_url','__esModule','fromEntries','merchant_reference_id','Response\x20Time:','TesSoft\x20Payment\x20System/1.0','Invalid\x20JSON\x20response\x20from\x20Rapyd\x20API:\x20','json','apiUrl','logWhiteDomainResponse','EXP','746817pOiqRQ','FAILED','Failed\x20to\x20parse\x20JSON\x20response:','/v1/hosted/payment_links/','\x20(always\x20GB\x20for\x20Rapyd)','log','===\x20RAPYD\x20API\x20ERROR\x20===','PAYMENT_COMPLETED','Business\x20Error\x20(','2136855UDYMHf','RapydService','https://tesoft.uk/gateway/success.php?id=','9520bdVtoH','URL:','ERR','Error\x20Code:','gb_visa_card','logWhiteDomainRequest',',\x20failureMessage=','paid','Response\x20data:','ORDER:\x20','HTTP\x20','1730316iwokKW','payment_method_data','https://tesoft.uk/gateway/fail.php?id=','message','Processing\x20Rapyd\x20webhook:','loggerService','ACT','\x20(GB\x20-\x20Britain)','22208552ArEUYD','Rapyd\x20payment\x20verification\x20error:','stringify','Request\x20Body\x20(Updated\x20Format):','Payment\x20Link\x20ID:','JSON\x20Parse\x20Error:\x20','Raw\x20Response\x20Body:','https://tesoft.uk/gateway/rapyd/','cardLast4','üîÑ\x20Rapyd\x20webhook\x20processed:\x20status=','createPaymentLink','Status\x20Text:','üí≥\x20Payment\x20Methods:\x20gb_visa_card,\x20gb_mastercard_card','toUpperCase','currency','Redirect\x20URL:','statusText','redirect_url','../loggerService','Headers:','Incomplete\x20response:\x20missing\x20id\x20or\x20redirect_url','text','üá¨üáß\x20Using\x20GB\x20(Britain)\x20as\x20country\x20for\x20Rapyd\x20payment\x20link','776260MteFao','/v1/hosted/payment_links','Full\x20Error\x20Data:','PAYMENT_EXPIRED','PAID','failure_code','status','Missing\x20id\x20or\x20redirect_url\x20in\x20response','data','processWebhook','POST','error','Response\x20Body:','Parsed\x20Result:','NEW','===\x20RAPYD\x20SUCCESS\x20===','defineProperty','===\x20PARSED\x20RAPYD\x20RESPONSE\x20===','HTTP\x20Status:','HTTP\x20error!\x20status:\x20','===\x20RAPYD\x20API\x20BUSINESS\x20ERROR\x20===','===\x20RAPYD\x20API\x20RESPONSE\x20(White\x20Domain)\x20===','paymentMethod','amount','Unknown\x20error\x20from\x20Rapyd\x20API','failure_message','SUCCESS','Rapyd\x20API\x20error:\x20','now','PAYMENT_CANCELED','Error\x20stack:','PAYMENT_FAILED','):\x20','üåê\x20Rapyd\x20service\x20initialized\x20with\x20white\x20domain\x20proxy','EXPIRED','Failed\x20to\x20verify\x20Rapyd\x20payment:\x20','UNKNOWN','CAN','CLO','GET','235170uCqfLD','logWhiteDomainError',',\x20body:\x20','üá¨üáß\x20Country\x20used:\x20','payment_method_type','rapyd','verifyPayment','3816axvmCk'];a45_0x55f1=function(){return _0x4d4586;};return a45_0x55f1();}Object[a45_0x410d2d(0x1c5)](exports,a45_0x410d2d(0x175),{'value':!![]}),exports[a45_0x410d2d(0x189)]=void 0x0;function a45_0x396e(_0x4324e,_0x45f1a0){const _0x55f19b=a45_0x55f1();return a45_0x396e=function(_0x396ee0,_0x4260cf){_0x396ee0=_0x396ee0-0x151;let _0x41a3cf=_0x55f19b[_0x396ee0];return _0x41a3cf;},a45_0x396e(_0x4324e,_0x45f1a0);}const loggerService_1=require(a45_0x410d2d(0x1b0));class RapydService{constructor(){const _0x1b7471=a45_0x410d2d;this[_0x1b7471(0x17c)]=_0x1b7471(0x1a5),console[_0x1b7471(0x184)](_0x1b7471(0x15e));}async[a45_0x410d2d(0x1a8)](_0x38712e){const _0x54b692=a45_0x410d2d,{orderId:_0x227de5,orderName:_0x2f8c34,amount:_0x1c4f26,currency:_0x1bb5df,usage:_0x513c6e,maxPayments:_0x5caf34,successUrl:_0x585dea,failUrl:_0x31ca48}=_0x38712e,_0x1101ac=_0x1bb5df[_0x54b692(0x1ab)](),_0xd6077d='GB';console[_0x54b692(0x184)](_0x54b692(0x1b4));const _0x4a6b34=_0x54b692(0x18a)+_0x227de5,_0x51966a=_0x54b692(0x198)+_0x227de5,_0x432ac8={'amount':_0x1c4f26,'currency':_0x1101ac,'cancel_checkout_url':_0x51966a,'complete_checkout_url':_0x4a6b34,'complete_payment_url':_0x4a6b34,'merchant_reference_id':_0x227de5,'description':_0x54b692(0x194)+_0x227de5,'country':'GB','payment_method_types_include':[_0x54b692(0x18f),'gb_mastercard_card'],'custom_elements':{'display_description':!![]}},_0x29f267=Date[_0x54b692(0x159)]();try{console[_0x54b692(0x184)](_0x54b692(0x173)),console[_0x54b692(0x184)](_0x54b692(0x18c),this[_0x54b692(0x17c)]),console[_0x54b692(0x184)](_0x54b692(0x1a1),JSON[_0x54b692(0x1a0)](_0x432ac8,null,0x2)),console[_0x54b692(0x184)]('üá¨üáß\x20Country:\x20'+_0xd6077d+_0x54b692(0x183)),console[_0x54b692(0x184)](_0x54b692(0x1aa)),loggerService_1['loggerService'][_0x54b692(0x190)](_0x54b692(0x16a),'/v1/hosted/payment_links',_0x54b692(0x1bf),_0x432ac8);const _0x122e1b=await fetch(this['apiUrl'],{'method':_0x54b692(0x1bf),'headers':{'Content-Type':'application/json','User-Agent':'TesSoft\x20Payment\x20System/1.0'},'body':JSON['stringify'](_0x432ac8)}),_0x46a4aa=Date['now']()-_0x29f267;console[_0x54b692(0x184)](_0x54b692(0x152)),console[_0x54b692(0x184)](_0x54b692(0x16e),_0x122e1b[_0x54b692(0x1bb)]),console['log'](_0x54b692(0x1a9),_0x122e1b[_0x54b692(0x1ae)]),console[_0x54b692(0x184)](_0x54b692(0x1b1),Object[_0x54b692(0x176)](_0x122e1b['headers']['entries']())),console[_0x54b692(0x184)](_0x54b692(0x178),_0x46a4aa+'ms');const _0x327fe9=await _0x122e1b['text']();console['log'](_0x54b692(0x1a4),_0x327fe9);if(!_0x122e1b['ok']){console[_0x54b692(0x1c0)](_0x54b692(0x185)),console[_0x54b692(0x1c0)](_0x54b692(0x1c7),_0x122e1b[_0x54b692(0x1bb)]),console[_0x54b692(0x1c0)](_0x54b692(0x1c1),_0x327fe9),loggerService_1[_0x54b692(0x19b)][_0x54b692(0x17d)](_0x54b692(0x16a),'/v1/hosted/payment_links',_0x122e1b[_0x54b692(0x1bb)],_0x327fe9,_0x46a4aa),loggerService_1[_0x54b692(0x19b)]['logWhiteDomainError'](_0x54b692(0x16a),'/v1/hosted/payment_links',_0x54b692(0x195)+_0x122e1b[_0x54b692(0x1bb)]+':\x20'+_0x327fe9);throw new Error(_0x54b692(0x1c8)+_0x122e1b[_0x54b692(0x1bb)]+_0x54b692(0x167)+_0x327fe9);}let _0x1aaa43;try{_0x1aaa43=JSON['parse'](_0x327fe9);}catch(_0x4ff4f4){console[_0x54b692(0x1c0)](_0x54b692(0x181),_0x4ff4f4),loggerService_1['loggerService'][_0x54b692(0x166)](_0x54b692(0x16a),_0x54b692(0x1b6),_0x54b692(0x1a3)+_0x4ff4f4);throw new Error(_0x54b692(0x17a)+_0x327fe9);}console[_0x54b692(0x184)](_0x54b692(0x1c6)),console[_0x54b692(0x184)](_0x54b692(0x1c2),JSON[_0x54b692(0x1a0)](_0x1aaa43,null,0x2)),loggerService_1[_0x54b692(0x19b)][_0x54b692(0x17d)]('rapyd','/v1/hosted/payment_links',_0x122e1b[_0x54b692(0x1bb)],_0x1aaa43,_0x46a4aa);if(_0x1aaa43[_0x54b692(0x1bb)]?.['status']!==_0x54b692(0x157)){const _0x33ff8f=_0x1aaa43[_0x54b692(0x1bb)]?.['message']||_0x54b692(0x155),_0x241cc2=_0x1aaa43[_0x54b692(0x1bb)]?.[_0x54b692(0x16f)]||_0x54b692(0x161);console[_0x54b692(0x1c0)](_0x54b692(0x151)),console[_0x54b692(0x1c0)](_0x54b692(0x18e),_0x241cc2),console[_0x54b692(0x1c0)](_0x54b692(0x171),_0x33ff8f),console[_0x54b692(0x1c0)](_0x54b692(0x1b7),_0x1aaa43[_0x54b692(0x1bb)]),loggerService_1[_0x54b692(0x19b)]['logWhiteDomainError']('rapyd','/v1/hosted/payment_links',_0x54b692(0x187)+_0x241cc2+'):\x20'+_0x33ff8f);throw new Error('Rapyd\x20API\x20error\x20('+_0x241cc2+_0x54b692(0x15d)+_0x33ff8f);}if(!_0x1aaa43[_0x54b692(0x1bd)]?.['id']||!_0x1aaa43[_0x54b692(0x1bd)]?.[_0x54b692(0x1af)]){console[_0x54b692(0x1c0)]('===\x20RAPYD\x20API\x20INCOMPLETE\x20RESPONSE\x20==='),console[_0x54b692(0x1c0)](_0x54b692(0x1bc)),console[_0x54b692(0x1c0)](_0x54b692(0x193),_0x1aaa43[_0x54b692(0x1bd)]),loggerService_1[_0x54b692(0x19b)][_0x54b692(0x166)](_0x54b692(0x16a),'/v1/hosted/payment_links',_0x54b692(0x1b2));throw new Error(_0x54b692(0x174));}return console[_0x54b692(0x184)](_0x54b692(0x1c4)),console[_0x54b692(0x184)](_0x54b692(0x1a2),_0x1aaa43[_0x54b692(0x1bd)]['id']),console[_0x54b692(0x184)](_0x54b692(0x1ad),_0x1aaa43[_0x54b692(0x1bd)]['redirect_url']),console['log'](_0x54b692(0x168)+_0xd6077d+_0x54b692(0x19d)),console[_0x54b692(0x184)](_0x54b692(0x1aa)),{'gateway_payment_id':_0x1aaa43[_0x54b692(0x1bd)]['id'],'payment_url':_0x1aaa43[_0x54b692(0x1bd)][_0x54b692(0x1af)]};}catch(_0x4f80de){console[_0x54b692(0x1c0)]('===\x20RAPYD\x20SERVICE\x20ERROR\x20==='),console[_0x54b692(0x1c0)]('Error\x20details:',_0x4f80de),loggerService_1['loggerService'][_0x54b692(0x166)](_0x54b692(0x16a),_0x54b692(0x1b6),_0x4f80de);if(_0x4f80de instanceof Error){console[_0x54b692(0x1c0)]('Error\x20message:',_0x4f80de['message']),console[_0x54b692(0x1c0)](_0x54b692(0x15b),_0x4f80de['stack']);throw new Error('Failed\x20to\x20create\x20Rapyd\x20payment\x20link:\x20'+_0x4f80de['message']);}throw new Error('Failed\x20to\x20create\x20Rapyd\x20payment\x20link:\x20Unknown\x20error');}}async[a45_0x410d2d(0x16b)](_0xfd4c44){const _0x44b35b=a45_0x410d2d,_0x57033d=Date[_0x44b35b(0x159)]();try{loggerService_1[_0x44b35b(0x19b)][_0x44b35b(0x190)]('rapyd',_0x44b35b(0x182)+_0xfd4c44,_0x44b35b(0x164),{});const _0xf8ce7d=await fetch(this[_0x44b35b(0x17c)]+'/'+_0xfd4c44,{'method':_0x44b35b(0x164),'headers':{'Content-Type':_0x44b35b(0x172),'User-Agent':_0x44b35b(0x179)}}),_0x14f7e7=Date[_0x44b35b(0x159)]()-_0x57033d;if(!_0xf8ce7d['ok']){const _0x1390f7=await _0xf8ce7d[_0x44b35b(0x1b3)]();loggerService_1[_0x44b35b(0x19b)]['logWhiteDomainResponse'](_0x44b35b(0x16a),'/v1/hosted/payment_links/'+_0xfd4c44,_0xf8ce7d[_0x44b35b(0x1bb)],_0x1390f7,_0x14f7e7);throw new Error(_0x44b35b(0x1c8)+_0xf8ce7d['status']);}const _0x196770=await _0xf8ce7d[_0x44b35b(0x17b)]();loggerService_1[_0x44b35b(0x19b)][_0x44b35b(0x17d)]('rapyd',_0x44b35b(0x182)+_0xfd4c44,_0xf8ce7d[_0x44b35b(0x1bb)],_0x196770,_0x14f7e7);if(_0x196770['status']?.[_0x44b35b(0x1bb)]!==_0x44b35b(0x157)){loggerService_1[_0x44b35b(0x19b)][_0x44b35b(0x166)](_0x44b35b(0x16a),_0x44b35b(0x182)+_0xfd4c44,_0x44b35b(0x158)+(_0x196770[_0x44b35b(0x1bb)]?.[_0x44b35b(0x199)]||_0x44b35b(0x16d)));throw new Error(_0x44b35b(0x158)+(_0x196770[_0x44b35b(0x1bb)]?.[_0x44b35b(0x199)]||_0x44b35b(0x16d)));}let _0x219b51='PENDING';if(_0x196770[_0x44b35b(0x1bd)]?.[_0x44b35b(0x1bb)])switch(_0x196770[_0x44b35b(0x1bd)]['status']['toUpperCase']()){case _0x44b35b(0x163):_0x219b51=_0x44b35b(0x1b9);break;case _0x44b35b(0x162):_0x219b51=_0x44b35b(0x180);break;case _0x44b35b(0x17e):_0x219b51=_0x44b35b(0x15f);break;case _0x44b35b(0x18d):_0x219b51=_0x44b35b(0x180);break;case _0x44b35b(0x1c3):case'ACT':default:_0x219b51=_0x44b35b(0x170);break;}return{'status':_0x219b51,'amount':_0x196770[_0x44b35b(0x1bd)]?.[_0x44b35b(0x154)],'currency':_0x196770[_0x44b35b(0x1bd)]?.[_0x44b35b(0x1ac)]};}catch(_0x32b5e7){console[_0x44b35b(0x1c0)](_0x44b35b(0x19f),_0x32b5e7),loggerService_1[_0x44b35b(0x19b)]['logWhiteDomainError'](_0x44b35b(0x16a),'/v1/hosted/payment_links/'+_0xfd4c44,_0x32b5e7);throw new Error(_0x44b35b(0x160)+(_0x32b5e7 instanceof Error?_0x32b5e7[_0x44b35b(0x199)]:'Unknown\x20error'));}}async[a45_0x410d2d(0x1be)](_0x1ec7b1){const _0xda199e=a45_0x410d2d;console['log'](_0xda199e(0x19a),_0x1ec7b1);let _0x38c382=_0xda199e(0x170),_0x1d8b32;_0x1ec7b1[_0xda199e(0x1bd)]?.[_0xda199e(0x156)]&&(_0x1d8b32=_0x1ec7b1['data'][_0xda199e(0x156)],console['log']('üí•\x20Rapyd\x20failure\x20message:\x20'+_0x1d8b32));switch(_0x1ec7b1['type']?.[_0xda199e(0x1ab)]()){case _0xda199e(0x186):_0x1ec7b1[_0xda199e(0x1bd)]?.[_0xda199e(0x192)]===!![]&&_0x1ec7b1['data']?.[_0xda199e(0x1bb)]===_0xda199e(0x163)?_0x38c382=_0xda199e(0x1b9):_0x38c382=_0xda199e(0x170);break;case _0xda199e(0x15a):_0x38c382=_0xda199e(0x180);break;case _0xda199e(0x1b8):_0x38c382=_0xda199e(0x15f);break;case _0xda199e(0x15c):_0x38c382=_0xda199e(0x180);!_0x1d8b32&&_0x1ec7b1[_0xda199e(0x1bd)]?.['failure_message']&&(_0x1d8b32=_0x1ec7b1[_0xda199e(0x1bd)][_0xda199e(0x156)]);break;default:switch(_0x1ec7b1[_0xda199e(0x1bd)]?.['status']?.['toUpperCase']()){case _0xda199e(0x163):_0x1ec7b1[_0xda199e(0x1bd)]?.[_0xda199e(0x192)]===!![]?_0x38c382=_0xda199e(0x1b9):_0x38c382='FAILED';break;case'CAN':_0x38c382=_0xda199e(0x180);break;case'EXP':_0x38c382=_0xda199e(0x15f);break;case'ERR':_0x38c382=_0xda199e(0x180);!_0x1d8b32&&_0x1ec7b1[_0xda199e(0x1bd)]?.[_0xda199e(0x156)]&&(_0x1d8b32=_0x1ec7b1['data'][_0xda199e(0x156)]);break;case _0xda199e(0x1c3):case _0xda199e(0x19c):default:_0x38c382=_0xda199e(0x170);break;}break;}const _0x7f6cfe={};return _0x1ec7b1[_0xda199e(0x1bd)]?.[_0xda199e(0x197)]?.['last4']&&(_0x7f6cfe[_0xda199e(0x1a6)]=_0x1ec7b1['data']['payment_method_data']['last4']),_0x1ec7b1[_0xda199e(0x1bd)]?.['payment_method_type']&&(_0x7f6cfe[_0xda199e(0x153)]=_0x1ec7b1[_0xda199e(0x1bd)][_0xda199e(0x169)]),_0x1ec7b1[_0xda199e(0x1bd)]?.[_0xda199e(0x16f)]&&(_0x7f6cfe['errorCode']=_0x1ec7b1[_0xda199e(0x1bd)][_0xda199e(0x16f)]),_0x1ec7b1[_0xda199e(0x1bd)]?.[_0xda199e(0x1ba)]&&(_0x7f6cfe['failureCode']=_0x1ec7b1[_0xda199e(0x1bd)][_0xda199e(0x1ba)]),console[_0xda199e(0x184)](_0xda199e(0x1a7)+_0x38c382+_0xda199e(0x191)+(_0x1d8b32||'none')),{'paymentId':_0x1ec7b1[_0xda199e(0x1bd)]?.[_0xda199e(0x177)]||'','status':_0x38c382,'amount':_0x1ec7b1[_0xda199e(0x1bd)]?.[_0xda199e(0x154)],'currency':_0x1ec7b1['data']?.[_0xda199e(0x1ac)],'failureMessage':_0x1d8b32,'additionalInfo':_0x7f6cfe};}}exports['RapydService']=RapydService;