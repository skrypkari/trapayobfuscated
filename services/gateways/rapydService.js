'use strict';const a50_0x13f828=a50_0x5076;function a50_0x13cf(){const _0xe2fe14=['PENDING','Failed\x20to\x20create\x20Rapyd\x20payment\x20link:\x20','üá¨üáß\x20Country:\x20','\x20(GB\x20-\x20Britain)','paymentMethod','URL:','üá¨üáß\x20Country\x20used:\x20','ACT','Response\x20Time:','Status\x20Text:','Raw\x20Response\x20Body:','cardLast4','__esModule','===\x20RAPYD\x20API\x20RESPONSE\x20(White\x20Domain)\x20===','67420jDHifU','gb_mastercard_card','===\x20RAPYD\x20SERVICE\x20ERROR\x20===','payment_method_data','message','failureCode','HTTP\x20','EUR','PAYMENT_CANCELED','../loggerService','Request\x20Body\x20(Updated\x20Format):','5395624VwCdJA','üîÑ\x20Rapyd\x20webhook\x20processed:\x20status=','entries','application/json','failure_code','\x20\x20\x20fixed_side:\x20buy','42voveoH','stack','merchant_reference_id','===\x20RAPYD\x20SUCCESS\x20===','redirect_url','headers','type','===\x20RAPYD\x20API\x20REQUEST\x20(White\x20Domain\x20-\x20Updated\x20Format)\x20===','Business\x20Error\x20(','Response\x20data:','1599008ruIWiz','===\x20PARSED\x20RAPYD\x20RESPONSE\x20===','verifyPayment','Incomplete\x20response:\x20missing\x20id\x20or\x20redirect_url','Rapyd\x20payment\x20verification\x20error:','Full\x20Error\x20Data:','Invalid\x20response\x20from\x20Rapyd\x20API:\x20missing\x20id\x20or\x20redirect_url','UNKNOWN','Unknown\x20error\x20from\x20Rapyd\x20API','POST','apiUrl','rapyd','log','failure_message','floor','1296MkPbkR','logWhiteDomainError','NEW','/v1/hosted/payment_links/','toUpperCase','/v1/hosted/payment_links','EXPIRED','logWhiteDomainResponse','20ejgQso','HTTP\x20error!\x20status:\x20','Parsed\x20Result:','last4','gb_visa_card','TesSoft\x20Payment\x20System/1.0','ERR','üá¨üáß\x20Using\x20GB\x20(Britain)\x20as\x20country\x20for\x20Rapyd\x20payment\x20link','toISOString',',\x20failureMessage=','statusText','136491eGLZPT','PAID','processWebhook','paid','EXP','error','Error\x20stack:','Failed\x20to\x20parse\x20JSON\x20response:','8859675Wnvsjq','PAYMENT_FAILED','HTTP\x20Status:','\x20->\x20EUR:','PAYMENT_EXPIRED','json','PAYMENT_COMPLETED','stringify','Failed\x20to\x20create\x20Rapyd\x20payment\x20link:\x20Unknown\x20error','FAILED','Error\x20details:','7gIQOpa','fixed_side','error_code',',\x20body:\x20','https://tesoft.uk/gateway/fail.php?id=','\x20(always\x20GB\x20for\x20Rapyd)','currency','):\x20','\x20\x20\x20requested_currency:\x20EUR','1012627cGWFzR','createPaymentLink','logWhiteDomainRequest','text','Failed\x20to\x20verify\x20Rapyd\x20payment:\x20','now','Missing\x20id\x20or\x20redirect_url\x20in\x20response','SUCCESS','data','https://tesoft.uk/gateway/rapyd/','status','loggerService','CAN','Processing\x20Rapyd\x20webhook:','Unknown\x20error','üí≥\x20Payment\x20Methods:\x20gb_visa_card,\x20gb_mastercard_card','CLO','Rapyd\x20API\x20error:\x20','none','üí•\x20Rapyd\x20failure\x20message:\x20','Response\x20Body:','Error\x20Code:','687640etdRVQ','errorCode','amount','payment_method_type','===\x20RAPYD\x20API\x20INCOMPLETE\x20RESPONSE\x20===','JSON\x20Parse\x20Error:\x20'];a50_0x13cf=function(){return _0xe2fe14;};return a50_0x13cf();}function a50_0x5076(_0x20f001,_0x292133){const _0x13cf1e=a50_0x13cf();return a50_0x5076=function(_0x5076ac,_0xdd94e8){_0x5076ac=_0x5076ac-0x1d6;let _0xa92705=_0x13cf1e[_0x5076ac];return _0xa92705;},a50_0x5076(_0x20f001,_0x292133);}(function(_0x181c7a,_0x145518){const _0x599b6a=a50_0x5076,_0x146e94=_0x181c7a();while(!![]){try{const _0x28a237=parseInt(_0x599b6a(0x244))/0x1+-parseInt(_0x599b6a(0x206))/0x2+-parseInt(_0x599b6a(0x228))/0x3*(-parseInt(_0x599b6a(0x21d))/0x4)+parseInt(_0x599b6a(0x1d7))/0x5*(-parseInt(_0x599b6a(0x1fc))/0x6)+-parseInt(_0x599b6a(0x23b))/0x7*(parseInt(_0x599b6a(0x1f6))/0x8)+parseInt(_0x599b6a(0x215))/0x9*(parseInt(_0x599b6a(0x1eb))/0xa)+parseInt(_0x599b6a(0x230))/0xb;if(_0x28a237===_0x145518)break;else _0x146e94['push'](_0x146e94['shift']());}catch(_0x1698fc){_0x146e94['push'](_0x146e94['shift']());}}}(a50_0x13cf,0x8d894));Object['defineProperty'](exports,a50_0x13f828(0x1e9),{'value':!![]}),exports['RapydService']=void 0x0;const loggerService_1=require(a50_0x13f828(0x1f4));class RapydService{constructor(){const _0xb958e1=a50_0x13f828;this[_0xb958e1(0x210)]=_0xb958e1(0x24d),console[_0xb958e1(0x212)]('üåê\x20Rapyd\x20service\x20initialized\x20with\x20white\x20domain\x20proxy');}async[a50_0x13f828(0x245)](_0x87b252){const _0x533381=a50_0x13f828,{orderId:_0x27d3b8,orderName:_0x2ccbd1,amount:_0x332099,currency:_0x59c596,usage:_0x2d6252,maxPayments:_0x1b6c87,successUrl:_0x53e872,failUrl:_0x2fe27d}=_0x87b252,_0x14e9c3=_0x59c596[_0x533381(0x219)](),_0x53cdfd='GB';console[_0x533381(0x212)](_0x533381(0x224));const _0x3f42fd='https://tesoft.uk/gateway/success.php?id='+_0x27d3b8,_0x16ad1c=_0x533381(0x23f)+_0x27d3b8,_0x4cc97b={'amount':_0x332099,'currency':_0x14e9c3,'cancel_checkout_url':_0x16ad1c,'complete_checkout_url':_0x3f42fd,'complete_payment_url':_0x3f42fd,'merchant_reference_id':_0x27d3b8,'description':'ORDER:\x20'+_0x27d3b8,'country':'GB','payment_method_types_include':[_0x533381(0x221),_0x533381(0x1ec)],'custom_elements':{'display_description':!![]}};if(_0x14e9c3!==_0x533381(0x1f2)){const _0x54458b=Math[_0x533381(0x214)](Date['now']()/0x3e8)+0x1e*0x3c;_0x4cc97b[_0x533381(0x23c)]='buy',_0x4cc97b['requested_currency']=_0x533381(0x1f2),_0x4cc97b['expiration']=_0x54458b,console['log']('üí±\x20Adding\x20currency\x20conversion\x20fields\x20for\x20'+_0x14e9c3+_0x533381(0x233)),console[_0x533381(0x212)](_0x533381(0x1fb)),console[_0x533381(0x212)](_0x533381(0x243)),console[_0x533381(0x212)]('\x20\x20\x20expiration:\x20'+_0x54458b+'\x20('+new Date(_0x54458b*0x3e8)[_0x533381(0x225)]()+')');}const _0x166baf=Date[_0x533381(0x249)]();try{console[_0x533381(0x212)](_0x533381(0x203)),console[_0x533381(0x212)](_0x533381(0x1e2),this[_0x533381(0x210)]),console[_0x533381(0x212)](_0x533381(0x1f5),JSON[_0x533381(0x237)](_0x4cc97b,null,0x2)),console['log'](_0x533381(0x1df)+_0x53cdfd+_0x533381(0x240)),console[_0x533381(0x212)](_0x533381(0x253)),loggerService_1[_0x533381(0x24f)]['logWhiteDomainRequest']('rapyd',_0x533381(0x21a),_0x533381(0x20f),_0x4cc97b);const _0x484769=await fetch(this[_0x533381(0x210)],{'method':_0x533381(0x20f),'headers':{'Content-Type':'application/json','User-Agent':_0x533381(0x222)},'body':JSON[_0x533381(0x237)](_0x4cc97b)}),_0x5df227=Date['now']()-_0x166baf;console[_0x533381(0x212)](_0x533381(0x1ea)),console[_0x533381(0x212)]('Status:',_0x484769[_0x533381(0x24e)]),console['log'](_0x533381(0x1e6),_0x484769[_0x533381(0x227)]),console['log']('Headers:',Object['fromEntries'](_0x484769[_0x533381(0x201)][_0x533381(0x1f8)]())),console[_0x533381(0x212)](_0x533381(0x1e5),_0x5df227+'ms');const _0xa3d135=await _0x484769[_0x533381(0x247)]();console[_0x533381(0x212)](_0x533381(0x1e7),_0xa3d135);if(!_0x484769['ok']){console['error']('===\x20RAPYD\x20API\x20ERROR\x20==='),console[_0x533381(0x22d)](_0x533381(0x232),_0x484769[_0x533381(0x24e)]),console[_0x533381(0x22d)](_0x533381(0x258),_0xa3d135),loggerService_1[_0x533381(0x24f)][_0x533381(0x21c)](_0x533381(0x211),_0x533381(0x21a),_0x484769[_0x533381(0x24e)],_0xa3d135,_0x5df227),loggerService_1[_0x533381(0x24f)][_0x533381(0x216)](_0x533381(0x211),_0x533381(0x21a),_0x533381(0x1f1)+_0x484769[_0x533381(0x24e)]+':\x20'+_0xa3d135);throw new Error(_0x533381(0x21e)+_0x484769[_0x533381(0x24e)]+_0x533381(0x23e)+_0xa3d135);}let _0x402e83;try{_0x402e83=JSON['parse'](_0xa3d135);}catch(_0xef77c5){console[_0x533381(0x22d)](_0x533381(0x22f),_0xef77c5),loggerService_1['loggerService']['logWhiteDomainError'](_0x533381(0x211),'/v1/hosted/payment_links',_0x533381(0x1dc)+_0xef77c5);throw new Error('Invalid\x20JSON\x20response\x20from\x20Rapyd\x20API:\x20'+_0xa3d135);}console[_0x533381(0x212)](_0x533381(0x207)),console[_0x533381(0x212)](_0x533381(0x21f),JSON[_0x533381(0x237)](_0x402e83,null,0x2)),loggerService_1[_0x533381(0x24f)][_0x533381(0x21c)](_0x533381(0x211),_0x533381(0x21a),_0x484769[_0x533381(0x24e)],_0x402e83,_0x5df227);if(_0x402e83[_0x533381(0x24e)]?.[_0x533381(0x24e)]!==_0x533381(0x24b)){const _0x29c614=_0x402e83[_0x533381(0x24e)]?.['message']||_0x533381(0x20e),_0x3702de=_0x402e83['status']?.[_0x533381(0x23d)]||_0x533381(0x20d);console[_0x533381(0x22d)]('===\x20RAPYD\x20API\x20BUSINESS\x20ERROR\x20==='),console['error'](_0x533381(0x1d6),_0x3702de),console[_0x533381(0x22d)]('Error\x20Message:',_0x29c614),console[_0x533381(0x22d)](_0x533381(0x20b),_0x402e83[_0x533381(0x24e)]),loggerService_1['loggerService'][_0x533381(0x216)](_0x533381(0x211),_0x533381(0x21a),_0x533381(0x204)+_0x3702de+_0x533381(0x242)+_0x29c614);throw new Error('Rapyd\x20API\x20error\x20('+_0x3702de+'):\x20'+_0x29c614);}if(!_0x402e83['data']?.['id']||!_0x402e83[_0x533381(0x24c)]?.[_0x533381(0x200)]){console['error'](_0x533381(0x1db)),console[_0x533381(0x22d)](_0x533381(0x24a)),console[_0x533381(0x22d)](_0x533381(0x205),_0x402e83[_0x533381(0x24c)]),loggerService_1[_0x533381(0x24f)][_0x533381(0x216)]('rapyd',_0x533381(0x21a),_0x533381(0x209));throw new Error(_0x533381(0x20c));}return console[_0x533381(0x212)](_0x533381(0x1ff)),console[_0x533381(0x212)]('Payment\x20Link\x20ID:',_0x402e83[_0x533381(0x24c)]['id']),console[_0x533381(0x212)]('Redirect\x20URL:',_0x402e83[_0x533381(0x24c)][_0x533381(0x200)]),console[_0x533381(0x212)](_0x533381(0x1e3)+_0x53cdfd+_0x533381(0x1e0)),console['log']('üí≥\x20Payment\x20Methods:\x20gb_visa_card,\x20gb_mastercard_card'),{'gateway_payment_id':_0x402e83[_0x533381(0x24c)]['id'],'payment_url':_0x402e83[_0x533381(0x24c)]['redirect_url']};}catch(_0x5efd5c){console[_0x533381(0x22d)](_0x533381(0x1ed)),console[_0x533381(0x22d)](_0x533381(0x23a),_0x5efd5c),loggerService_1[_0x533381(0x24f)][_0x533381(0x216)](_0x533381(0x211),_0x533381(0x21a),_0x5efd5c);if(_0x5efd5c instanceof Error){console['error']('Error\x20message:',_0x5efd5c['message']),console[_0x533381(0x22d)](_0x533381(0x22e),_0x5efd5c[_0x533381(0x1fd)]);throw new Error(_0x533381(0x1de)+_0x5efd5c[_0x533381(0x1ef)]);}throw new Error(_0x533381(0x238));}}async[a50_0x13f828(0x208)](_0x2329fe){const _0x15e083=a50_0x13f828,_0x494059=Date[_0x15e083(0x249)]();try{loggerService_1[_0x15e083(0x24f)][_0x15e083(0x246)](_0x15e083(0x211),_0x15e083(0x218)+_0x2329fe,'GET',{});const _0x57a6dc=await fetch(this[_0x15e083(0x210)]+'/'+_0x2329fe,{'method':'GET','headers':{'Content-Type':_0x15e083(0x1f9),'User-Agent':_0x15e083(0x222)}}),_0x39e01c=Date[_0x15e083(0x249)]()-_0x494059;if(!_0x57a6dc['ok']){const _0xf8cee6=await _0x57a6dc[_0x15e083(0x247)]();loggerService_1[_0x15e083(0x24f)][_0x15e083(0x21c)](_0x15e083(0x211),'/v1/hosted/payment_links/'+_0x2329fe,_0x57a6dc['status'],_0xf8cee6,_0x39e01c);throw new Error(_0x15e083(0x21e)+_0x57a6dc[_0x15e083(0x24e)]);}const _0x5845c5=await _0x57a6dc[_0x15e083(0x235)]();loggerService_1[_0x15e083(0x24f)]['logWhiteDomainResponse'](_0x15e083(0x211),_0x15e083(0x218)+_0x2329fe,_0x57a6dc[_0x15e083(0x24e)],_0x5845c5,_0x39e01c);if(_0x5845c5[_0x15e083(0x24e)]?.[_0x15e083(0x24e)]!==_0x15e083(0x24b)){loggerService_1[_0x15e083(0x24f)][_0x15e083(0x216)](_0x15e083(0x211),_0x15e083(0x218)+_0x2329fe,'Rapyd\x20API\x20error:\x20'+(_0x5845c5['status']?.['message']||_0x15e083(0x252)));throw new Error(_0x15e083(0x255)+(_0x5845c5[_0x15e083(0x24e)]?.['message']||_0x15e083(0x252)));}let _0x163f2a=_0x15e083(0x1dd);if(_0x5845c5[_0x15e083(0x24c)]?.[_0x15e083(0x24e)])switch(_0x5845c5[_0x15e083(0x24c)][_0x15e083(0x24e)]['toUpperCase']()){case'CLO':_0x163f2a=_0x15e083(0x229);break;case _0x15e083(0x250):_0x163f2a=_0x15e083(0x239);break;case _0x15e083(0x22c):_0x163f2a=_0x15e083(0x21b);break;case _0x15e083(0x223):_0x163f2a='FAILED';break;case'NEW':case _0x15e083(0x1e4):default:_0x163f2a=_0x15e083(0x1dd);break;}return{'status':_0x163f2a,'amount':_0x5845c5['data']?.['amount'],'currency':_0x5845c5[_0x15e083(0x24c)]?.[_0x15e083(0x241)]};}catch(_0x2388c3){console[_0x15e083(0x22d)](_0x15e083(0x20a),_0x2388c3),loggerService_1[_0x15e083(0x24f)][_0x15e083(0x216)](_0x15e083(0x211),_0x15e083(0x218)+_0x2329fe,_0x2388c3);throw new Error(_0x15e083(0x248)+(_0x2388c3 instanceof Error?_0x2388c3['message']:_0x15e083(0x252)));}}async[a50_0x13f828(0x22a)](_0x42c895){const _0x315c2b=a50_0x13f828;console[_0x315c2b(0x212)](_0x315c2b(0x251),_0x42c895);let _0x548ccd='PENDING',_0x114fe4;_0x42c895['data']?.[_0x315c2b(0x213)]&&(_0x114fe4=_0x42c895['data'][_0x315c2b(0x213)],console[_0x315c2b(0x212)](_0x315c2b(0x257)+_0x114fe4));switch(_0x42c895[_0x315c2b(0x202)]?.['toUpperCase']()){case _0x315c2b(0x236):_0x42c895[_0x315c2b(0x24c)]?.['paid']===!![]&&_0x42c895[_0x315c2b(0x24c)]?.['status']===_0x315c2b(0x254)?_0x548ccd=_0x315c2b(0x229):_0x548ccd=_0x315c2b(0x1dd);break;case _0x315c2b(0x1f3):_0x548ccd=_0x315c2b(0x239);break;case _0x315c2b(0x234):_0x548ccd=_0x315c2b(0x21b);break;case _0x315c2b(0x231):_0x548ccd='FAILED';!_0x114fe4&&_0x42c895[_0x315c2b(0x24c)]?.[_0x315c2b(0x213)]&&(_0x114fe4=_0x42c895[_0x315c2b(0x24c)]['failure_message']);break;default:switch(_0x42c895[_0x315c2b(0x24c)]?.[_0x315c2b(0x24e)]?.[_0x315c2b(0x219)]()){case _0x315c2b(0x254):_0x42c895[_0x315c2b(0x24c)]?.[_0x315c2b(0x22b)]===!![]?_0x548ccd=_0x315c2b(0x229):_0x548ccd=_0x315c2b(0x239);break;case'CAN':_0x548ccd=_0x315c2b(0x239);break;case _0x315c2b(0x22c):_0x548ccd=_0x315c2b(0x21b);break;case'ERR':_0x548ccd='FAILED';!_0x114fe4&&_0x42c895[_0x315c2b(0x24c)]?.[_0x315c2b(0x213)]&&(_0x114fe4=_0x42c895[_0x315c2b(0x24c)]['failure_message']);break;case _0x315c2b(0x217):case _0x315c2b(0x1e4):default:_0x548ccd=_0x315c2b(0x1dd);break;}break;}const _0x4353a6={};return _0x42c895[_0x315c2b(0x24c)]?.[_0x315c2b(0x1ee)]?.[_0x315c2b(0x220)]&&(_0x4353a6[_0x315c2b(0x1e8)]=_0x42c895[_0x315c2b(0x24c)]['payment_method_data'][_0x315c2b(0x220)]),_0x42c895[_0x315c2b(0x24c)]?.[_0x315c2b(0x1da)]&&(_0x4353a6[_0x315c2b(0x1e1)]=_0x42c895[_0x315c2b(0x24c)]['payment_method_type']),_0x42c895['data']?.[_0x315c2b(0x23d)]&&(_0x4353a6[_0x315c2b(0x1d8)]=_0x42c895[_0x315c2b(0x24c)]['error_code']),_0x42c895[_0x315c2b(0x24c)]?.[_0x315c2b(0x1fa)]&&(_0x4353a6[_0x315c2b(0x1f0)]=_0x42c895[_0x315c2b(0x24c)][_0x315c2b(0x1fa)]),console['log'](_0x315c2b(0x1f7)+_0x548ccd+_0x315c2b(0x226)+(_0x114fe4||_0x315c2b(0x256))),{'paymentId':_0x42c895[_0x315c2b(0x24c)]?.[_0x315c2b(0x1fe)]||'','status':_0x548ccd,'amount':_0x42c895[_0x315c2b(0x24c)]?.[_0x315c2b(0x1d9)],'currency':_0x42c895[_0x315c2b(0x24c)]?.[_0x315c2b(0x241)],'failureMessage':_0x114fe4,'additionalInfo':_0x4353a6};}}exports['RapydService']=RapydService;