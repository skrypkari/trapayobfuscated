'use strict';function a45_0x1271(_0x59b827,_0x4ab6e4){const _0x2334d4=a45_0x2334();return a45_0x1271=function(_0x1271f1,_0x41529f){_0x1271f1=_0x1271f1-0x11c;let _0x120731=_0x2334d4[_0x1271f1];return _0x120731;},a45_0x1271(_0x59b827,_0x4ab6e4);}const a45_0x5e0962=a45_0x1271;function a45_0x2334(){const _0x4dd9e3=['Response\x20Time:','stack','452ZWvKRj','Unknown\x20error\x20from\x20Rapyd\x20API','message','===\x20RAPYD\x20API\x20BUSINESS\x20ERROR\x20===','Error\x20message:','none','https://tesoft.uk/gateway/success.php?id=','rapyd','Failed\x20to\x20create\x20Rapyd\x20payment\x20link:\x20Unknown\x20error','Business\x20Error\x20(','TesSoft\x20Payment\x20System/1.0','Error\x20Message:','errorCode','Headers:','Status:','amount','https://tesoft.uk/gateway/fail.php?id=','2766Ltbbii','Failed\x20to\x20create\x20Rapyd\x20payment\x20link:\x20','loggerService','../loggerService','status','üá¨üáß\x20Using\x20GB\x20(Britain)\x20as\x20country\x20for\x20Rapyd\x20payment\x20link','Invalid\x20response\x20from\x20Rapyd\x20API:\x20missing\x20id\x20or\x20redirect_url','HTTP\x20Status:','Redirect\x20URL:','paid','cardLast4','üí≥\x20Payment\x20Methods:\x20gb_visa_card,\x20gb_mastercard_card','text','now','Rapyd\x20API\x20error:\x20','error','/v1/hosted/payment_links/','369341Ulqvgt','Unknown\x20error','SUCCESS','data','logWhiteDomainRequest','301520wARMtc','logWhiteDomainError','PAYMENT_CANCELED','Failed\x20to\x20parse\x20JSON\x20response:','Missing\x20id\x20or\x20redirect_url\x20in\x20response','===\x20RAPYD\x20API\x20RESPONSE\x20(White\x20Domain)\x20===','Error\x20Code:','53320yapJdi','__esModule','132ApvjeZ','error_code','3292500WsVEZi','HTTP\x20error!\x20status:\x20','Error\x20details:','Parsed\x20Result:','===\x20RAPYD\x20API\x20INCOMPLETE\x20RESPONSE\x20===',',\x20body:\x20','headers','entries','5UHBbWD','verifyPayment','FAILED','NEW','===\x20RAPYD\x20SERVICE\x20ERROR\x20===','CAN','\x20(always\x20GB\x20for\x20Rapyd)','RapydService','/v1/hosted/payment_links','PAYMENT_FAILED','):\x20','Incomplete\x20response:\x20missing\x20id\x20or\x20redirect_url','HTTP\x20','log','Response\x20data:','158923HqoYUq','2CDAMsN','üá¨üáß\x20Country\x20used:\x20','apiUrl','Raw\x20Response\x20Body:','paymentMethod','Full\x20Error\x20Data:','===\x20RAPYD\x20API\x20ERROR\x20===','gb_visa_card','213222NAViEr','CLO','last4','Status\x20Text:','payment_method_type','Payment\x20Link\x20ID:','===\x20RAPYD\x20SUCCESS\x20===','PAYMENT_EXPIRED','ERR','ACT','statusText','failureCode','failure_message','stringify','EXP','merchant_reference_id','currency','logWhiteDomainResponse','toUpperCase','POST','Processing\x20Rapyd\x20webhook:','PAID','failure_code','üåê\x20Rapyd\x20service\x20initialized\x20with\x20white\x20domain\x20proxy','PENDING','json','createPaymentLink','type','\x20(GB\x20-\x20Britain)','Failed\x20to\x20verify\x20Rapyd\x20payment:\x20','redirect_url','application/json','processWebhook','===\x20RAPYD\x20API\x20REQUEST\x20(White\x20Domain\x20-\x20Updated\x20Format)\x20===','EXPIRED','81WZQZbO'];a45_0x2334=function(){return _0x4dd9e3;};return a45_0x2334();}(function(_0x564d99,_0x36534b){const _0x39f1b5=a45_0x1271,_0x264bc7=_0x564d99();while(!![]){try{const _0x2b49fb=-parseInt(_0x39f1b5(0x155))/0x1*(-parseInt(_0x39f1b5(0x156))/0x2)+-parseInt(_0x39f1b5(0x11d))/0x3*(-parseInt(_0x39f1b5(0x184))/0x4)+-parseInt(_0x39f1b5(0x146))/0x5*(-parseInt(_0x39f1b5(0x15e))/0x6)+parseInt(_0x39f1b5(0x12e))/0x7+-parseInt(_0x39f1b5(0x133))/0x8*(parseInt(_0x39f1b5(0x181))/0x9)+-parseInt(_0x39f1b5(0x13a))/0xa*(parseInt(_0x39f1b5(0x13c))/0xb)+parseInt(_0x39f1b5(0x13e))/0xc;if(_0x2b49fb===_0x36534b)break;else _0x264bc7['push'](_0x264bc7['shift']());}catch(_0x5df07b){_0x264bc7['push'](_0x264bc7['shift']());}}}(a45_0x2334,0x3657e));Object['defineProperty'](exports,a45_0x5e0962(0x13b),{'value':!![]}),exports['RapydService']=void 0x0;const loggerService_1=require(a45_0x5e0962(0x120));class RapydService{constructor(){const _0x1dcf55=a45_0x5e0962;this['apiUrl']='https://tesoft.uk/gateway/rapyd/',console[_0x1dcf55(0x153)](_0x1dcf55(0x175));}async[a45_0x5e0962(0x178)](_0x88bd36){const _0x2fe5a9=a45_0x5e0962,{orderId:_0x38959d,orderName:_0xa6b2e9,amount:_0x9551ec,currency:_0x2ff728,usage:_0xcaad25,maxPayments:_0x5e1029,successUrl:_0x37e1ca,failUrl:_0x3e0938}=_0x88bd36,_0x556a5a=_0x2ff728['toUpperCase'](),_0x2240c0='GB';console['log'](_0x2fe5a9(0x122));const _0x384f74=_0x2fe5a9(0x18a)+_0x38959d,_0x3426a4=_0x2fe5a9(0x11c)+_0x38959d,_0x36ddaf={'amount':_0x9551ec,'currency':_0x556a5a,'cancel_checkout_url':_0x3426a4,'complete_checkout_url':_0x384f74,'complete_payment_url':_0x384f74,'merchant_reference_id':_0x38959d,'description':'ORDER:\x20'+_0x38959d,'country':'GB','payment_method_types_include':[_0x2fe5a9(0x15d),'gb_mastercard_card'],'custom_elements':{'display_description':!![]}},_0x95fab4=Date[_0x2fe5a9(0x12a)]();try{console[_0x2fe5a9(0x153)](_0x2fe5a9(0x17f)),console['log']('URL:',this[_0x2fe5a9(0x158)]),console[_0x2fe5a9(0x153)]('Request\x20Body\x20(Updated\x20Format):',JSON[_0x2fe5a9(0x16b)](_0x36ddaf,null,0x2)),console['log']('üá¨üáß\x20Country:\x20'+_0x2240c0+_0x2fe5a9(0x14c)),console[_0x2fe5a9(0x153)](_0x2fe5a9(0x128)),loggerService_1[_0x2fe5a9(0x11f)][_0x2fe5a9(0x132)](_0x2fe5a9(0x18b),_0x2fe5a9(0x14e),_0x2fe5a9(0x171),_0x36ddaf);const _0x321474=await fetch(this['apiUrl'],{'method':_0x2fe5a9(0x171),'headers':{'Content-Type':_0x2fe5a9(0x17d),'User-Agent':_0x2fe5a9(0x18e)},'body':JSON['stringify'](_0x36ddaf)}),_0x50085d=Date[_0x2fe5a9(0x12a)]()-_0x95fab4;console[_0x2fe5a9(0x153)](_0x2fe5a9(0x138)),console['log'](_0x2fe5a9(0x192),_0x321474[_0x2fe5a9(0x121)]),console[_0x2fe5a9(0x153)](_0x2fe5a9(0x161),_0x321474[_0x2fe5a9(0x168)]),console[_0x2fe5a9(0x153)](_0x2fe5a9(0x191),Object['fromEntries'](_0x321474[_0x2fe5a9(0x144)][_0x2fe5a9(0x145)]())),console[_0x2fe5a9(0x153)](_0x2fe5a9(0x182),_0x50085d+'ms');const _0x5bac55=await _0x321474[_0x2fe5a9(0x129)]();console[_0x2fe5a9(0x153)](_0x2fe5a9(0x159),_0x5bac55);if(!_0x321474['ok']){console['error'](_0x2fe5a9(0x15c)),console[_0x2fe5a9(0x12c)](_0x2fe5a9(0x124),_0x321474[_0x2fe5a9(0x121)]),console[_0x2fe5a9(0x12c)]('Response\x20Body:',_0x5bac55),loggerService_1[_0x2fe5a9(0x11f)][_0x2fe5a9(0x16f)]('rapyd','/v1/hosted/payment_links',_0x321474[_0x2fe5a9(0x121)],_0x5bac55,_0x50085d),loggerService_1[_0x2fe5a9(0x11f)][_0x2fe5a9(0x134)](_0x2fe5a9(0x18b),_0x2fe5a9(0x14e),_0x2fe5a9(0x152)+_0x321474[_0x2fe5a9(0x121)]+':\x20'+_0x5bac55);throw new Error(_0x2fe5a9(0x13f)+_0x321474[_0x2fe5a9(0x121)]+_0x2fe5a9(0x143)+_0x5bac55);}let _0x33b8e2;try{_0x33b8e2=JSON['parse'](_0x5bac55);}catch(_0x487fa6){console[_0x2fe5a9(0x12c)](_0x2fe5a9(0x136),_0x487fa6),loggerService_1[_0x2fe5a9(0x11f)][_0x2fe5a9(0x134)]('rapyd',_0x2fe5a9(0x14e),'JSON\x20Parse\x20Error:\x20'+_0x487fa6);throw new Error('Invalid\x20JSON\x20response\x20from\x20Rapyd\x20API:\x20'+_0x5bac55);}console[_0x2fe5a9(0x153)]('===\x20PARSED\x20RAPYD\x20RESPONSE\x20==='),console['log'](_0x2fe5a9(0x141),JSON[_0x2fe5a9(0x16b)](_0x33b8e2,null,0x2)),loggerService_1[_0x2fe5a9(0x11f)]['logWhiteDomainResponse']('rapyd','/v1/hosted/payment_links',_0x321474[_0x2fe5a9(0x121)],_0x33b8e2,_0x50085d);if(_0x33b8e2[_0x2fe5a9(0x121)]?.['status']!==_0x2fe5a9(0x130)){const _0x2b5814=_0x33b8e2[_0x2fe5a9(0x121)]?.[_0x2fe5a9(0x186)]||_0x2fe5a9(0x185),_0x4d9f28=_0x33b8e2['status']?.[_0x2fe5a9(0x13d)]||'UNKNOWN';console['error'](_0x2fe5a9(0x187)),console[_0x2fe5a9(0x12c)](_0x2fe5a9(0x139),_0x4d9f28),console[_0x2fe5a9(0x12c)](_0x2fe5a9(0x18f),_0x2b5814),console[_0x2fe5a9(0x12c)](_0x2fe5a9(0x15b),_0x33b8e2[_0x2fe5a9(0x121)]),loggerService_1['loggerService'][_0x2fe5a9(0x134)](_0x2fe5a9(0x18b),_0x2fe5a9(0x14e),_0x2fe5a9(0x18d)+_0x4d9f28+_0x2fe5a9(0x150)+_0x2b5814);throw new Error('Rapyd\x20API\x20error\x20('+_0x4d9f28+_0x2fe5a9(0x150)+_0x2b5814);}if(!_0x33b8e2[_0x2fe5a9(0x131)]?.['id']||!_0x33b8e2[_0x2fe5a9(0x131)]?.[_0x2fe5a9(0x17c)]){console[_0x2fe5a9(0x12c)](_0x2fe5a9(0x142)),console[_0x2fe5a9(0x12c)](_0x2fe5a9(0x137)),console[_0x2fe5a9(0x12c)](_0x2fe5a9(0x154),_0x33b8e2[_0x2fe5a9(0x131)]),loggerService_1[_0x2fe5a9(0x11f)][_0x2fe5a9(0x134)](_0x2fe5a9(0x18b),'/v1/hosted/payment_links',_0x2fe5a9(0x151));throw new Error(_0x2fe5a9(0x123));}return console[_0x2fe5a9(0x153)](_0x2fe5a9(0x164)),console[_0x2fe5a9(0x153)](_0x2fe5a9(0x163),_0x33b8e2[_0x2fe5a9(0x131)]['id']),console[_0x2fe5a9(0x153)](_0x2fe5a9(0x125),_0x33b8e2[_0x2fe5a9(0x131)]['redirect_url']),console['log'](_0x2fe5a9(0x157)+_0x2240c0+_0x2fe5a9(0x17a)),console['log'](_0x2fe5a9(0x128)),{'gateway_payment_id':_0x33b8e2[_0x2fe5a9(0x131)]['id'],'payment_url':_0x33b8e2['data'][_0x2fe5a9(0x17c)]};}catch(_0x4d7afa){console['error'](_0x2fe5a9(0x14a)),console[_0x2fe5a9(0x12c)](_0x2fe5a9(0x140),_0x4d7afa),loggerService_1[_0x2fe5a9(0x11f)][_0x2fe5a9(0x134)]('rapyd',_0x2fe5a9(0x14e),_0x4d7afa);if(_0x4d7afa instanceof Error){console[_0x2fe5a9(0x12c)](_0x2fe5a9(0x188),_0x4d7afa['message']),console['error']('Error\x20stack:',_0x4d7afa[_0x2fe5a9(0x183)]);throw new Error(_0x2fe5a9(0x11e)+_0x4d7afa[_0x2fe5a9(0x186)]);}throw new Error(_0x2fe5a9(0x18c));}}async[a45_0x5e0962(0x147)](_0x4a7924){const _0x2756a2=a45_0x5e0962,_0x45a559=Date[_0x2756a2(0x12a)]();try{loggerService_1[_0x2756a2(0x11f)]['logWhiteDomainRequest'](_0x2756a2(0x18b),_0x2756a2(0x12d)+_0x4a7924,'GET',{});const _0x22fa45=await fetch(this[_0x2756a2(0x158)]+'/'+_0x4a7924,{'method':'GET','headers':{'Content-Type':_0x2756a2(0x17d),'User-Agent':_0x2756a2(0x18e)}}),_0x4fc89c=Date[_0x2756a2(0x12a)]()-_0x45a559;if(!_0x22fa45['ok']){const _0x950467=await _0x22fa45['text']();loggerService_1[_0x2756a2(0x11f)]['logWhiteDomainResponse'](_0x2756a2(0x18b),_0x2756a2(0x12d)+_0x4a7924,_0x22fa45['status'],_0x950467,_0x4fc89c);throw new Error(_0x2756a2(0x13f)+_0x22fa45[_0x2756a2(0x121)]);}const _0x3dcf3b=await _0x22fa45[_0x2756a2(0x177)]();loggerService_1[_0x2756a2(0x11f)]['logWhiteDomainResponse'](_0x2756a2(0x18b),_0x2756a2(0x12d)+_0x4a7924,_0x22fa45[_0x2756a2(0x121)],_0x3dcf3b,_0x4fc89c);if(_0x3dcf3b[_0x2756a2(0x121)]?.[_0x2756a2(0x121)]!==_0x2756a2(0x130)){loggerService_1[_0x2756a2(0x11f)][_0x2756a2(0x134)](_0x2756a2(0x18b),'/v1/hosted/payment_links/'+_0x4a7924,_0x2756a2(0x12b)+(_0x3dcf3b[_0x2756a2(0x121)]?.[_0x2756a2(0x186)]||'Unknown\x20error'));throw new Error(_0x2756a2(0x12b)+(_0x3dcf3b[_0x2756a2(0x121)]?.['message']||_0x2756a2(0x12f)));}let _0x58fea5=_0x2756a2(0x176);if(_0x3dcf3b[_0x2756a2(0x131)]?.[_0x2756a2(0x121)])switch(_0x3dcf3b[_0x2756a2(0x131)][_0x2756a2(0x121)][_0x2756a2(0x170)]()){case _0x2756a2(0x15f):_0x58fea5=_0x2756a2(0x173);break;case'CAN':_0x58fea5='FAILED';break;case _0x2756a2(0x16c):_0x58fea5=_0x2756a2(0x180);break;case'ERR':_0x58fea5='FAILED';break;case _0x2756a2(0x149):case'ACT':default:_0x58fea5='PENDING';break;}return{'status':_0x58fea5,'amount':_0x3dcf3b[_0x2756a2(0x131)]?.['amount'],'currency':_0x3dcf3b[_0x2756a2(0x131)]?.[_0x2756a2(0x16e)]};}catch(_0x19947f){console[_0x2756a2(0x12c)]('Rapyd\x20payment\x20verification\x20error:',_0x19947f),loggerService_1['loggerService'][_0x2756a2(0x134)](_0x2756a2(0x18b),_0x2756a2(0x12d)+_0x4a7924,_0x19947f);throw new Error(_0x2756a2(0x17b)+(_0x19947f instanceof Error?_0x19947f['message']:_0x2756a2(0x12f)));}}async[a45_0x5e0962(0x17e)](_0x3e8aed){const _0x4040e2=a45_0x5e0962;console[_0x4040e2(0x153)](_0x4040e2(0x172),_0x3e8aed);let _0x595191=_0x4040e2(0x176),_0x209da9;_0x3e8aed[_0x4040e2(0x131)]?.[_0x4040e2(0x16a)]&&(_0x209da9=_0x3e8aed[_0x4040e2(0x131)][_0x4040e2(0x16a)],console[_0x4040e2(0x153)]('üí•\x20Rapyd\x20failure\x20message:\x20'+_0x209da9));switch(_0x3e8aed[_0x4040e2(0x179)]?.[_0x4040e2(0x170)]()){case'PAYMENT_COMPLETED':_0x3e8aed[_0x4040e2(0x131)]?.[_0x4040e2(0x126)]===!![]&&_0x3e8aed[_0x4040e2(0x131)]?.[_0x4040e2(0x121)]===_0x4040e2(0x15f)?_0x595191='PAID':_0x595191=_0x4040e2(0x176);break;case _0x4040e2(0x135):_0x595191='FAILED';break;case _0x4040e2(0x165):_0x595191='EXPIRED';break;case _0x4040e2(0x14f):_0x595191=_0x4040e2(0x148);!_0x209da9&&_0x3e8aed[_0x4040e2(0x131)]?.[_0x4040e2(0x16a)]&&(_0x209da9=_0x3e8aed[_0x4040e2(0x131)][_0x4040e2(0x16a)]);break;default:switch(_0x3e8aed['data']?.[_0x4040e2(0x121)]?.[_0x4040e2(0x170)]()){case _0x4040e2(0x15f):_0x3e8aed['data']?.[_0x4040e2(0x126)]===!![]?_0x595191='PAID':_0x595191=_0x4040e2(0x148);break;case _0x4040e2(0x14b):_0x595191=_0x4040e2(0x148);break;case _0x4040e2(0x16c):_0x595191=_0x4040e2(0x180);break;case _0x4040e2(0x166):_0x595191=_0x4040e2(0x148);!_0x209da9&&_0x3e8aed[_0x4040e2(0x131)]?.[_0x4040e2(0x16a)]&&(_0x209da9=_0x3e8aed[_0x4040e2(0x131)][_0x4040e2(0x16a)]);break;case _0x4040e2(0x149):case _0x4040e2(0x167):default:_0x595191='PENDING';break;}break;}const _0x5b1877={};return _0x3e8aed[_0x4040e2(0x131)]?.['payment_method_data']?.[_0x4040e2(0x160)]&&(_0x5b1877[_0x4040e2(0x127)]=_0x3e8aed[_0x4040e2(0x131)]['payment_method_data'][_0x4040e2(0x160)]),_0x3e8aed[_0x4040e2(0x131)]?.[_0x4040e2(0x162)]&&(_0x5b1877[_0x4040e2(0x15a)]=_0x3e8aed['data'][_0x4040e2(0x162)]),_0x3e8aed[_0x4040e2(0x131)]?.[_0x4040e2(0x13d)]&&(_0x5b1877[_0x4040e2(0x190)]=_0x3e8aed['data'][_0x4040e2(0x13d)]),_0x3e8aed['data']?.['failure_code']&&(_0x5b1877[_0x4040e2(0x169)]=_0x3e8aed[_0x4040e2(0x131)][_0x4040e2(0x174)]),console['log']('üîÑ\x20Rapyd\x20webhook\x20processed:\x20status='+_0x595191+',\x20failureMessage='+(_0x209da9||_0x4040e2(0x189))),{'paymentId':_0x3e8aed[_0x4040e2(0x131)]?.[_0x4040e2(0x16d)]||'','status':_0x595191,'amount':_0x3e8aed[_0x4040e2(0x131)]?.[_0x4040e2(0x193)],'currency':_0x3e8aed[_0x4040e2(0x131)]?.[_0x4040e2(0x16e)],'failureMessage':_0x209da9,'additionalInfo':_0x5b1877};}}exports[a45_0x5e0962(0x14d)]=RapydService;