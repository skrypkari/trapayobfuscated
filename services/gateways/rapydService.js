'use strict';const a42_0xaf532d=a42_0xbb56;function a42_0xca33(){const _0x56ab8a=['Missing\x20id\x20or\x20redirect_url\x20in\x20response','Business\x20Error\x20(','\x20(always\x20GB\x20for\x20Rapyd)','===\x20RAPYD\x20API\x20INCOMPLETE\x20RESPONSE\x20===','SUCCESS','Invalid\x20JSON\x20response\x20from\x20Rapyd\x20API:\x20','Processing\x20Rapyd\x20webhook:','===\x20RAPYD\x20API\x20BUSINESS\x20ERROR\x20===','entries','\x20(GB\x20-\x20Britain)','URL:','EXPIRED','data','Response\x20Time:','logWhiteDomainRequest','logWhiteDomainError','https://tesoft.uk/gateway/success.php?id=','logWhiteDomainResponse','Error\x20details:','üá¨üáß\x20Country\x20used:\x20','redirect_url','CLO','NEW','error_code','PAID','ACT','Response\x20data:','Incomplete\x20response:\x20missing\x20id\x20or\x20redirect_url','üá¨üáß\x20Using\x20GB\x20(Britain)\x20as\x20country\x20for\x20Rapyd\x20payment\x20link','JSON\x20Parse\x20Error:\x20','rapyd','HTTP\x20error!\x20status:\x20','219960FCEEIg','status',',\x20body:\x20','parse','FAILED','paid','Unknown\x20error','):\x20','Status\x20Text:','statusText','RapydService','üá¨üáß\x20Country:\x20','5031522NDRigT','POST','Rapyd\x20payment\x20verification\x20error:','GET','now','apiUrl','stack','Status:','text','/v1/hosted/payment_links','Error\x20message:','message','fromEntries','Error\x20stack:','===\x20RAPYD\x20API\x20RESPONSE\x20(White\x20Domain)\x20===','stringify','Failed\x20to\x20verify\x20Rapyd\x20payment:\x20','PENDING','https://tesoft.uk/gateway/fail.php?id=','üí≥\x20Payment\x20Methods:\x20gb_visa_card,\x20gb_mastercard_card','CAN','error','__esModule','Rapyd\x20API\x20error\x20(','/v1/hosted/payment_links/','Request\x20Body\x20(Updated\x20Format):','loggerService','Invalid\x20response\x20from\x20Rapyd\x20API:\x20missing\x20id\x20or\x20redirect_url','ORDER:\x20','Raw\x20Response\x20Body:','Rapyd\x20API\x20error:\x20','Payment\x20Link\x20ID:','TesSoft\x20Payment\x20System/1.0','117567AuXYWy','Failed\x20to\x20create\x20Rapyd\x20payment\x20link:\x20','defineProperty','===\x20RAPYD\x20SUCCESS\x20===','currency','Redirect\x20URL:','36rNmELb','verifyPayment','PAYMENT_CANCELED','PAYMENT_COMPLETED','Error\x20Code:','merchant_reference_id','Parsed\x20Result:','log','EXP','8KQurcv','https://tesoft.uk/gateway/rapyd/','===\x20RAPYD\x20API\x20ERROR\x20===','type','application/json','Unknown\x20error\x20from\x20Rapyd\x20API','createPaymentLink','381316nSruJb','json','2151317pezLtD','1218072TvgqtV','Failed\x20to\x20parse\x20JSON\x20response:','toUpperCase','Response\x20Body:','228482MWvPdJ','ERR'];a42_0xca33=function(){return _0x56ab8a;};return a42_0xca33();}(function(_0x1b6fc9,_0x486b52){const _0x38ade2=a42_0xbb56,_0x2082fd=_0x1b6fc9();while(!![]){try{const _0x5834ae=-parseInt(_0x38ade2(0x9d))/0x1+-parseInt(_0x38ade2(0x8f))/0x2*(-parseInt(_0x38ade2(0x80))/0x3)+parseInt(_0x38ade2(0x96))/0x4+parseInt(_0x38ade2(0xbf))/0x5*(-parseInt(_0x38ade2(0x86))/0x6)+-parseInt(_0x38ade2(0x98))/0x7+parseInt(_0x38ade2(0x99))/0x8+parseInt(_0x38ade2(0xcb))/0x9;if(_0x5834ae===_0x486b52)break;else _0x2082fd['push'](_0x2082fd['shift']());}catch(_0x5f4276){_0x2082fd['push'](_0x2082fd['shift']());}}}(a42_0xca33,0x27f35));Object[a42_0xaf532d(0x82)](exports,a42_0xaf532d(0xe1),{'value':!![]}),exports[a42_0xaf532d(0xc9)]=void 0x0;const loggerService_1=require('../loggerService');class RapydService{constructor(){const _0x4c43b3=a42_0xaf532d;this['apiUrl']=_0x4c43b3(0x90),console[_0x4c43b3(0x8d)]('üåê\x20Rapyd\x20service\x20initialized\x20with\x20white\x20domain\x20proxy');}async[a42_0xaf532d(0x95)](_0xf7871){const _0x31c41f=a42_0xaf532d,{orderId:_0x351ed2,orderName:_0x1e1d89,amount:_0x3c4413,currency:_0x294d7b,usage:_0x3dfadb,maxPayments:_0x2771a1,successUrl:_0x52714f,failUrl:_0x8ba840}=_0xf7871,_0x14c890=_0x294d7b['toUpperCase'](),_0x42d4b3='GB';console[_0x31c41f(0x8d)](_0x31c41f(0xbb));const _0x33a805=_0x31c41f(0xaf)+_0x351ed2,_0x81e969=_0x31c41f(0xdd)+_0x351ed2,_0x17c997={'amount':_0x3c4413,'cancel_checkout_url':_0x81e969,'complete_checkout_url':_0x33a805,'complete_payment_url':_0x33a805,'merchant_reference_id':_0x351ed2,'description':_0x31c41f(0x7b)+_0x351ed2,'payment_method_types_include':['gb_visa_card','gb_mastercard_card'],'custom_elements':{'display_description':!![]}},_0x5cb06e=Date[_0x31c41f(0xcf)]();try{console[_0x31c41f(0x8d)]('===\x20RAPYD\x20API\x20REQUEST\x20(White\x20Domain\x20-\x20Updated\x20Format)\x20==='),console['log'](_0x31c41f(0xa9),this[_0x31c41f(0xd0)]),console['log'](_0x31c41f(0x78),JSON[_0x31c41f(0xda)](_0x17c997,null,0x2)),console['log'](_0x31c41f(0xca)+_0x42d4b3+_0x31c41f(0xa1)),console[_0x31c41f(0x8d)](_0x31c41f(0xde)),loggerService_1['loggerService'][_0x31c41f(0xad)]('rapyd',_0x31c41f(0xd4),_0x31c41f(0xcc),_0x17c997);const _0x5dc2dc=await fetch(this['apiUrl'],{'method':_0x31c41f(0xcc),'headers':{'Content-Type':'application/json','User-Agent':_0x31c41f(0x7f)},'body':JSON[_0x31c41f(0xda)](_0x17c997)}),_0x5cf9d3=Date[_0x31c41f(0xcf)]()-_0x5cb06e;console[_0x31c41f(0x8d)](_0x31c41f(0xd9)),console['log'](_0x31c41f(0xd2),_0x5dc2dc[_0x31c41f(0xc0)]),console[_0x31c41f(0x8d)](_0x31c41f(0xc7),_0x5dc2dc[_0x31c41f(0xc8)]),console[_0x31c41f(0x8d)]('Headers:',Object[_0x31c41f(0xd7)](_0x5dc2dc['headers'][_0x31c41f(0xa7)]())),console['log'](_0x31c41f(0xac),_0x5cf9d3+'ms');const _0x4b12cb=await _0x5dc2dc[_0x31c41f(0xd3)]();console[_0x31c41f(0x8d)](_0x31c41f(0x7c),_0x4b12cb);if(!_0x5dc2dc['ok']){console['error'](_0x31c41f(0x91)),console[_0x31c41f(0xe0)]('HTTP\x20Status:',_0x5dc2dc[_0x31c41f(0xc0)]),console[_0x31c41f(0xe0)](_0x31c41f(0x9c),_0x4b12cb),loggerService_1[_0x31c41f(0x79)][_0x31c41f(0xb0)](_0x31c41f(0xbd),_0x31c41f(0xd4),_0x5dc2dc['status'],_0x4b12cb,_0x5cf9d3),loggerService_1[_0x31c41f(0x79)][_0x31c41f(0xae)](_0x31c41f(0xbd),_0x31c41f(0xd4),'HTTP\x20'+_0x5dc2dc[_0x31c41f(0xc0)]+':\x20'+_0x4b12cb);throw new Error(_0x31c41f(0xbe)+_0x5dc2dc['status']+_0x31c41f(0xc1)+_0x4b12cb);}let _0xd0ccea;try{_0xd0ccea=JSON[_0x31c41f(0xc2)](_0x4b12cb);}catch(_0x4f1d2e){console['error'](_0x31c41f(0x9a),_0x4f1d2e),loggerService_1['loggerService'][_0x31c41f(0xae)](_0x31c41f(0xbd),_0x31c41f(0xd4),_0x31c41f(0xbc)+_0x4f1d2e);throw new Error(_0x31c41f(0xa4)+_0x4b12cb);}console[_0x31c41f(0x8d)]('===\x20PARSED\x20RAPYD\x20RESPONSE\x20==='),console[_0x31c41f(0x8d)](_0x31c41f(0x8c),JSON[_0x31c41f(0xda)](_0xd0ccea,null,0x2)),loggerService_1[_0x31c41f(0x79)][_0x31c41f(0xb0)](_0x31c41f(0xbd),'/v1/hosted/payment_links',_0x5dc2dc[_0x31c41f(0xc0)],_0xd0ccea,_0x5cf9d3);if(_0xd0ccea['status']?.[_0x31c41f(0xc0)]!=='SUCCESS'){const _0xccc45a=_0xd0ccea[_0x31c41f(0xc0)]?.[_0x31c41f(0xd6)]||_0x31c41f(0x94),_0x1e416a=_0xd0ccea['status']?.[_0x31c41f(0xb6)]||'UNKNOWN';console['error'](_0x31c41f(0xa6)),console[_0x31c41f(0xe0)](_0x31c41f(0x8a),_0x1e416a),console[_0x31c41f(0xe0)]('Error\x20Message:',_0xccc45a),console[_0x31c41f(0xe0)]('Full\x20Error\x20Data:',_0xd0ccea[_0x31c41f(0xc0)]),loggerService_1[_0x31c41f(0x79)][_0x31c41f(0xae)](_0x31c41f(0xbd),_0x31c41f(0xd4),_0x31c41f(0xa0)+_0x1e416a+_0x31c41f(0xc6)+_0xccc45a);throw new Error(_0x31c41f(0x76)+_0x1e416a+_0x31c41f(0xc6)+_0xccc45a);}if(!_0xd0ccea[_0x31c41f(0xab)]?.['id']||!_0xd0ccea['data']?.[_0x31c41f(0xb3)]){console[_0x31c41f(0xe0)](_0x31c41f(0xa2)),console[_0x31c41f(0xe0)](_0x31c41f(0x9f)),console[_0x31c41f(0xe0)](_0x31c41f(0xb9),_0xd0ccea[_0x31c41f(0xab)]),loggerService_1[_0x31c41f(0x79)][_0x31c41f(0xae)](_0x31c41f(0xbd),'/v1/hosted/payment_links',_0x31c41f(0xba));throw new Error(_0x31c41f(0x7a));}return console['log'](_0x31c41f(0x83)),console[_0x31c41f(0x8d)](_0x31c41f(0x7e),_0xd0ccea['data']['id']),console[_0x31c41f(0x8d)](_0x31c41f(0x85),_0xd0ccea[_0x31c41f(0xab)][_0x31c41f(0xb3)]),console[_0x31c41f(0x8d)](_0x31c41f(0xb2)+_0x42d4b3+_0x31c41f(0xa8)),console[_0x31c41f(0x8d)]('üí≥\x20Payment\x20Methods:\x20gb_visa_card,\x20gb_mastercard_card'),{'gateway_payment_id':_0xd0ccea[_0x31c41f(0xab)]['id'],'payment_url':_0xd0ccea['data']['redirect_url']};}catch(_0x1d2d75){console['error']('===\x20RAPYD\x20SERVICE\x20ERROR\x20==='),console[_0x31c41f(0xe0)](_0x31c41f(0xb1),_0x1d2d75),loggerService_1[_0x31c41f(0x79)][_0x31c41f(0xae)](_0x31c41f(0xbd),_0x31c41f(0xd4),_0x1d2d75);if(_0x1d2d75 instanceof Error){console[_0x31c41f(0xe0)](_0x31c41f(0xd5),_0x1d2d75['message']),console[_0x31c41f(0xe0)](_0x31c41f(0xd8),_0x1d2d75[_0x31c41f(0xd1)]);throw new Error(_0x31c41f(0x81)+_0x1d2d75[_0x31c41f(0xd6)]);}throw new Error('Failed\x20to\x20create\x20Rapyd\x20payment\x20link:\x20Unknown\x20error');}}async[a42_0xaf532d(0x87)](_0x6c601c){const _0x4b4c1b=a42_0xaf532d,_0x3abef2=Date['now']();try{loggerService_1[_0x4b4c1b(0x79)][_0x4b4c1b(0xad)](_0x4b4c1b(0xbd),_0x4b4c1b(0x77)+_0x6c601c,'GET',{});const _0x58224b=await fetch(this[_0x4b4c1b(0xd0)]+'/'+_0x6c601c,{'method':_0x4b4c1b(0xce),'headers':{'Content-Type':_0x4b4c1b(0x93),'User-Agent':_0x4b4c1b(0x7f)}}),_0x4350b9=Date[_0x4b4c1b(0xcf)]()-_0x3abef2;if(!_0x58224b['ok']){const _0x55e576=await _0x58224b[_0x4b4c1b(0xd3)]();loggerService_1[_0x4b4c1b(0x79)][_0x4b4c1b(0xb0)](_0x4b4c1b(0xbd),_0x4b4c1b(0x77)+_0x6c601c,_0x58224b['status'],_0x55e576,_0x4350b9);throw new Error(_0x4b4c1b(0xbe)+_0x58224b[_0x4b4c1b(0xc0)]);}const _0x83cb57=await _0x58224b[_0x4b4c1b(0x97)]();loggerService_1[_0x4b4c1b(0x79)][_0x4b4c1b(0xb0)](_0x4b4c1b(0xbd),'/v1/hosted/payment_links/'+_0x6c601c,_0x58224b[_0x4b4c1b(0xc0)],_0x83cb57,_0x4350b9);if(_0x83cb57[_0x4b4c1b(0xc0)]?.[_0x4b4c1b(0xc0)]!==_0x4b4c1b(0xa3)){loggerService_1[_0x4b4c1b(0x79)][_0x4b4c1b(0xae)](_0x4b4c1b(0xbd),_0x4b4c1b(0x77)+_0x6c601c,_0x4b4c1b(0x7d)+(_0x83cb57['status']?.[_0x4b4c1b(0xd6)]||_0x4b4c1b(0xc5)));throw new Error(_0x4b4c1b(0x7d)+(_0x83cb57[_0x4b4c1b(0xc0)]?.['message']||_0x4b4c1b(0xc5)));}let _0xf0dd80=_0x4b4c1b(0xdc);if(_0x83cb57[_0x4b4c1b(0xab)]?.[_0x4b4c1b(0xc0)])switch(_0x83cb57['data'][_0x4b4c1b(0xc0)][_0x4b4c1b(0x9b)]()){case _0x4b4c1b(0xb4):_0xf0dd80=_0x4b4c1b(0xb7);break;case _0x4b4c1b(0xdf):_0xf0dd80=_0x4b4c1b(0xc3);break;case _0x4b4c1b(0x8e):_0xf0dd80=_0x4b4c1b(0xaa);break;case _0x4b4c1b(0x9e):_0xf0dd80=_0x4b4c1b(0xc3);break;case _0x4b4c1b(0xb5):case _0x4b4c1b(0xb8):default:_0xf0dd80='PENDING';break;}return{'status':_0xf0dd80,'amount':_0x83cb57['data']?.['amount'],'currency':_0x83cb57['data']?.[_0x4b4c1b(0x84)]};}catch(_0x383264){console[_0x4b4c1b(0xe0)](_0x4b4c1b(0xcd),_0x383264),loggerService_1[_0x4b4c1b(0x79)][_0x4b4c1b(0xae)](_0x4b4c1b(0xbd),'/v1/hosted/payment_links/'+_0x6c601c,_0x383264);throw new Error(_0x4b4c1b(0xdb)+(_0x383264 instanceof Error?_0x383264['message']:_0x4b4c1b(0xc5)));}}async['processWebhook'](_0x4cc8e5){const _0x17bdeb=a42_0xaf532d;console['log'](_0x17bdeb(0xa5),_0x4cc8e5);let _0x293c62=_0x17bdeb(0xdc);switch(_0x4cc8e5[_0x17bdeb(0x92)]?.['toUpperCase']()){case _0x17bdeb(0x89):_0x4cc8e5['data']?.[_0x17bdeb(0xc4)]===!![]&&_0x4cc8e5[_0x17bdeb(0xab)]?.[_0x17bdeb(0xc0)]===_0x17bdeb(0xb4)?_0x293c62=_0x17bdeb(0xb7):_0x293c62=_0x17bdeb(0xdc);break;case _0x17bdeb(0x88):_0x293c62=_0x17bdeb(0xc3);break;case'PAYMENT_EXPIRED':_0x293c62='EXPIRED';break;case'PAYMENT_FAILED':_0x293c62=_0x17bdeb(0xc3);break;default:switch(_0x4cc8e5[_0x17bdeb(0xab)]?.['status']?.[_0x17bdeb(0x9b)]()){case _0x17bdeb(0xb4):_0x4cc8e5[_0x17bdeb(0xab)]?.['paid']===!![]?_0x293c62=_0x17bdeb(0xb7):_0x293c62=_0x17bdeb(0xc3);break;case _0x17bdeb(0xdf):_0x293c62=_0x17bdeb(0xc3);break;case'EXP':_0x293c62=_0x17bdeb(0xaa);break;case _0x17bdeb(0x9e):_0x293c62=_0x17bdeb(0xc3);break;case _0x17bdeb(0xb5):case _0x17bdeb(0xb8):default:_0x293c62='PENDING';break;}break;}return{'paymentId':_0x4cc8e5[_0x17bdeb(0xab)]?.[_0x17bdeb(0x8b)]||'','status':_0x293c62,'amount':_0x4cc8e5[_0x17bdeb(0xab)]?.['amount'],'currency':_0x4cc8e5[_0x17bdeb(0xab)]?.[_0x17bdeb(0x84)]};}}function a42_0xbb56(_0x12691f,_0x2bd352){const _0xca3362=a42_0xca33();return a42_0xbb56=function(_0xbb561d,_0x3eae3b){_0xbb561d=_0xbb561d-0x76;let _0x5d00fe=_0xca3362[_0xbb561d];return _0x5d00fe;},a42_0xbb56(_0x12691f,_0x2bd352);}exports[a42_0xaf532d(0xc9)]=RapydService;