'use strict';function a67_0x9fbc(_0x5b87c6,_0xc7eb36){_0x5b87c6=_0x5b87c6-0x1dc;const _0x166464=a67_0x1664();let _0x9fbcf9=_0x166464[_0x5b87c6];return _0x9fbcf9;}const a67_0x4c9bd2=a67_0x9fbc;function a67_0x1664(){const _0x19c101=['Redirect\x20URL:','logWhiteDomainError','54fOjVBF','Full\x20Error\x20Data:','Failed\x20to\x20create\x20Rapyd\x20payment\x20link:\x20','PAYMENT_FAILED','message','Incomplete\x20response:\x20missing\x20id\x20or\x20redirect_url',',\x20failureMessage=','verifyPayment','\x20\x20\x20expiration:\x20','174iYmuoh','HTTP\x20','RapydService','Status\x20Text:','Error\x20message:','fromEntries','statusText','===\x20RAPYD\x20API\x20ERROR\x20===','redirect_url','Response\x20Time:','failureCode','PENDING','now','5557nWUBYV','stringify','text','HTTP\x20error!\x20status:\x20','currency','error','entries','FAILED','Error\x20Code:','1413915rQzgqz','/v1/hosted/payment_links','Unknown\x20error','logWhiteDomainResponse','Missing\x20id\x20or\x20redirect_url\x20in\x20response','Error\x20Message:','phone_number','1481070RWKEFC','Status:','EXP','defineProperty','loggerService','3852192TRAUHc','cardBrand','39082180FclNUb','Payment\x20System/1.0','toISOString','ðŸŒ\x20Rapyd\x20service\x20initialized\x20with\x20white\x20domain\x20proxy','EXPIRED','ðŸ’³\x20Card\x20brand\x20from\x20bin_details:\x20','Failed\x20to\x20parse\x20JSON\x20response:','address','/v1/hosted/payment_links/','ðŸ’³\x20Adding\x20cardholder\x20name:\x20','type','):\x20','TESOFT\x20','CLO','application/json','URL:','===\x20RAPYD\x20API\x20REQUEST\x20(White\x20Domain\x20-\x20Updated\x20Format)\x20===','Headers:','HTTP\x20Status:','logWhiteDomainRequest','none','toUpperCase','ERR','Rapyd\x20API\x20error\x20(','PAID','Parsed\x20Result:','NEW','Invalid\x20JSON\x20response\x20from\x20Rapyd\x20API:\x20','expiration','parse','processWebhook','__esModule','failure_message','error_code','../loggerService','ðŸ”„\x20Rapyd\x20webhook\x20processed:\x20status=','apiUrl','paid','Business\x20Error\x20(','391056qarPgo','===\x20PARSED\x20RAPYD\x20RESPONSE\x20===','requested_currency','\x20\x20\x20fixed_side:\x20buy','Processing\x20Rapyd\x20webhook:','===\x20RAPYD\x20SUCCESS\x20===','email','PAYMENT_COMPLETED','last4','https://tesoft.uk/gateway/success.php?id=','EUR','Response\x20Body:','fixed_side','stack','Unknown\x20error\x20from\x20Rapyd\x20API','ðŸ’¥\x20Rapyd\x20failure\x20message:\x20','Error\x20stack:','payment_method_type','JSON\x20Parse\x20Error:\x20','data','paymentMethod','headers','SUCCESS','errorCode','payment_method_data','691320kLaxlr','POST','CAN','UNKNOWN','log','floor','\x20->\x20EUR:','https://tesoft.uk/gateway/fail.php?id=','ðŸ‡¬ðŸ‡§\x20Country:\x20','119cVQeyJ','failure_code','ACT','status','Failed\x20to\x20verify\x20Rapyd\x20payment:\x20','rapyd','===\x20RAPYD\x20API\x20RESPONSE\x20(White\x20Domain)\x20===','Failed\x20to\x20create\x20Rapyd\x20payment\x20link:\x20Unknown\x20error','bin_details','GET'];a67_0x1664=function(){return _0x19c101;};return a67_0x1664();}(function(_0x5c04f8,_0x544e55){const _0x5a79b3=a67_0x9fbc,_0x23a679=_0x5c04f8();while(!![]){try{const _0x193ca0=-parseInt(_0x5a79b3(0x1fb))/0x1*(parseInt(_0x5a79b3(0x1ee))/0x2)+-parseInt(_0x5a79b3(0x204))/0x3+-parseInt(_0x5a79b3(0x210))/0x4+parseInt(_0x5a79b3(0x20b))/0x5+-parseInt(_0x5a79b3(0x239))/0x6*(parseInt(_0x5a79b3(0x25b))/0x7)+parseInt(_0x5a79b3(0x252))/0x8*(-parseInt(_0x5a79b3(0x1e5))/0x9)+parseInt(_0x5a79b3(0x212))/0xa;if(_0x193ca0===_0x544e55)break;else _0x23a679['push'](_0x23a679['shift']());}catch(_0x41cbb0){_0x23a679['push'](_0x23a679['shift']());}}}(a67_0x1664,0xa12aa));Object[a67_0x4c9bd2(0x20e)](exports,a67_0x4c9bd2(0x231),{'value':!![]}),exports[a67_0x4c9bd2(0x1f0)]=void 0x0;const loggerService_1=require(a67_0x4c9bd2(0x234));class RapydService{constructor(){const _0x43ce99=a67_0x4c9bd2;this[_0x43ce99(0x236)]='https://tesoft.uk/gateway/rapyd/',console['log'](_0x43ce99(0x215));}async['createPaymentLink'](_0x4beaed){const _0x390c9f=a67_0x4c9bd2,{orderId:_0x50060b,orderName:_0x32642c,amount:_0x5e64e6,currency:_0x134f8f,usage:_0x3a57a4,maxPayments:_0x567b1a,successUrl:_0x4f4d94,failUrl:_0xaeedb1,customerName:_0xb2b5eb,customerEmail:_0x5177bb}=_0x4beaed,_0x295310=_0x134f8f[_0x390c9f(0x227)](),_0x9ed86b='GB';console['log']('ðŸ‡¬ðŸ‡§\x20Using\x20GB\x20(Britain)\x20as\x20country\x20for\x20Rapyd\x20payment\x20link');const _0x526f69=_0x390c9f(0x242)+_0x50060b,_0x577dc2=_0x390c9f(0x259)+_0x50060b,_0x268bfa={'amount':_0x5e64e6,'currency':_0x295310,'payment_method_options':{'3d_required':![]},'cancel_checkout_url':_0x577dc2,'complete_checkout_url':_0x526f69,'complete_payment_url':_0x526f69,'merchant_reference_id':_0x50060b,'description':'ORDER:\x20'+_0x50060b,'statement_descriptor':_0x390c9f(0x21e)+(_0x50060b['split']('-')[0x1]||_0x50060b),'country':'GB','payment_method_types_include':['gb_visa_card','gb_mastercard_card'],'custom_elements':{'display_description':!![],'billing_address_collect':!![],'required_customer_fields':['name',_0x390c9f(0x23f),_0x390c9f(0x20a),_0x390c9f(0x219)]}};_0xb2b5eb&&(_0x268bfa['custom_elements']['cardholder_name']=_0xb2b5eb,console['log'](_0x390c9f(0x21b)+_0xb2b5eb));if(_0x295310!==_0x390c9f(0x243)){const _0xa8e717=Math[_0x390c9f(0x257)](Date['now']()/0x3e8)+0x1e*0x3c;_0x268bfa[_0x390c9f(0x245)]='buy',_0x268bfa[_0x390c9f(0x23b)]=_0x390c9f(0x243),_0x268bfa[_0x390c9f(0x22e)]=_0xa8e717,console[_0x390c9f(0x256)]('ðŸ’±\x20Adding\x20currency\x20conversion\x20fields\x20for\x20'+_0x295310+_0x390c9f(0x258)),console['log'](_0x390c9f(0x23c)),console['log']('\x20\x20\x20requested_currency:\x20EUR'),console[_0x390c9f(0x256)](_0x390c9f(0x1ed)+_0xa8e717+'\x20('+new Date(_0xa8e717*0x3e8)[_0x390c9f(0x214)]()+')');}const _0x1e6c53=Date['now']();try{console[_0x390c9f(0x256)](_0x390c9f(0x222)),console[_0x390c9f(0x256)](_0x390c9f(0x221),this[_0x390c9f(0x236)]),console[_0x390c9f(0x256)]('Request\x20Body\x20(Updated\x20Format):',JSON[_0x390c9f(0x1fc)](_0x268bfa,null,0x2)),console[_0x390c9f(0x256)](_0x390c9f(0x25a)+_0x9ed86b+'\x20(always\x20GB\x20for\x20Rapyd)'),console['log']('ðŸ’³\x20Payment\x20Methods:\x20gb_visa_card,\x20gb_mastercard_card'),loggerService_1[_0x390c9f(0x20f)][_0x390c9f(0x225)](_0x390c9f(0x1de),_0x390c9f(0x205),'POST',_0x268bfa);const _0x20b478=await fetch(this['apiUrl'],{'method':_0x390c9f(0x253),'headers':{'Content-Type':'application/json','User-Agent':_0x390c9f(0x213)},'body':JSON[_0x390c9f(0x1fc)](_0x268bfa)}),_0x58acb4=Date[_0x390c9f(0x1fa)]()-_0x1e6c53;console['log'](_0x390c9f(0x1df)),console[_0x390c9f(0x256)](_0x390c9f(0x20c),_0x20b478[_0x390c9f(0x1dc)]),console[_0x390c9f(0x256)](_0x390c9f(0x1f1),_0x20b478[_0x390c9f(0x1f4)]),console[_0x390c9f(0x256)](_0x390c9f(0x223),Object[_0x390c9f(0x1f3)](_0x20b478[_0x390c9f(0x24e)][_0x390c9f(0x201)]())),console[_0x390c9f(0x256)](_0x390c9f(0x1f7),_0x58acb4+'ms');const _0x23b013=await _0x20b478[_0x390c9f(0x1fd)]();console[_0x390c9f(0x256)]('Raw\x20Response\x20Body:',_0x23b013);if(!_0x20b478['ok']){console[_0x390c9f(0x200)](_0x390c9f(0x1f5)),console[_0x390c9f(0x200)](_0x390c9f(0x224),_0x20b478[_0x390c9f(0x1dc)]),console['error'](_0x390c9f(0x244),_0x23b013),loggerService_1[_0x390c9f(0x20f)][_0x390c9f(0x207)](_0x390c9f(0x1de),_0x390c9f(0x205),_0x20b478['status'],_0x23b013,_0x58acb4),loggerService_1['loggerService'][_0x390c9f(0x1e4)](_0x390c9f(0x1de),_0x390c9f(0x205),_0x390c9f(0x1ef)+_0x20b478[_0x390c9f(0x1dc)]+':\x20'+_0x23b013);throw new Error(_0x390c9f(0x1fe)+_0x20b478[_0x390c9f(0x1dc)]+',\x20body:\x20'+_0x23b013);}let _0xf73150;try{_0xf73150=JSON[_0x390c9f(0x22f)](_0x23b013);}catch(_0x1db696){console['error'](_0x390c9f(0x218),_0x1db696),loggerService_1[_0x390c9f(0x20f)][_0x390c9f(0x1e4)](_0x390c9f(0x1de),_0x390c9f(0x205),_0x390c9f(0x24b)+_0x1db696);throw new Error(_0x390c9f(0x22d)+_0x23b013);}console[_0x390c9f(0x256)](_0x390c9f(0x23a)),console[_0x390c9f(0x256)](_0x390c9f(0x22b),JSON['stringify'](_0xf73150,null,0x2)),loggerService_1[_0x390c9f(0x20f)]['logWhiteDomainResponse']('rapyd',_0x390c9f(0x205),_0x20b478[_0x390c9f(0x1dc)],_0xf73150,_0x58acb4);if(_0xf73150[_0x390c9f(0x1dc)]?.[_0x390c9f(0x1dc)]!=='SUCCESS'){const _0x598ffe=_0xf73150['status']?.[_0x390c9f(0x1e9)]||_0x390c9f(0x247),_0x46d33c=_0xf73150[_0x390c9f(0x1dc)]?.[_0x390c9f(0x233)]||_0x390c9f(0x255);console[_0x390c9f(0x200)]('===\x20RAPYD\x20API\x20BUSINESS\x20ERROR\x20==='),console[_0x390c9f(0x200)](_0x390c9f(0x203),_0x46d33c),console[_0x390c9f(0x200)](_0x390c9f(0x209),_0x598ffe),console[_0x390c9f(0x200)](_0x390c9f(0x1e6),_0xf73150[_0x390c9f(0x1dc)]),loggerService_1['loggerService'][_0x390c9f(0x1e4)](_0x390c9f(0x1de),_0x390c9f(0x205),_0x390c9f(0x238)+_0x46d33c+_0x390c9f(0x21d)+_0x598ffe);throw new Error(_0x390c9f(0x229)+_0x46d33c+_0x390c9f(0x21d)+_0x598ffe);}if(!_0xf73150[_0x390c9f(0x24c)]?.['id']||!_0xf73150[_0x390c9f(0x24c)]?.[_0x390c9f(0x1f6)]){console[_0x390c9f(0x200)]('===\x20RAPYD\x20API\x20INCOMPLETE\x20RESPONSE\x20==='),console[_0x390c9f(0x200)](_0x390c9f(0x208)),console[_0x390c9f(0x200)]('Response\x20data:',_0xf73150[_0x390c9f(0x24c)]),loggerService_1['loggerService']['logWhiteDomainError']('rapyd',_0x390c9f(0x205),_0x390c9f(0x1ea));throw new Error('Invalid\x20response\x20from\x20Rapyd\x20API:\x20missing\x20id\x20or\x20redirect_url');}return console[_0x390c9f(0x256)](_0x390c9f(0x23e)),console['log']('Payment\x20Link\x20ID:',_0xf73150['data']['id']),console[_0x390c9f(0x256)](_0x390c9f(0x1e3),_0xf73150[_0x390c9f(0x24c)]['redirect_url']),console[_0x390c9f(0x256)]('ðŸ‡¬ðŸ‡§\x20Country\x20used:\x20'+_0x9ed86b+'\x20(GB\x20-\x20Britain)'),console['log']('ðŸ’³\x20Payment\x20Methods:\x20gb_visa_card,\x20gb_mastercard_card'),{'gateway_payment_id':_0xf73150[_0x390c9f(0x24c)]['id'],'payment_url':_0xf73150[_0x390c9f(0x24c)]['redirect_url']};}catch(_0x49316c){console[_0x390c9f(0x200)]('===\x20RAPYD\x20SERVICE\x20ERROR\x20==='),console[_0x390c9f(0x200)]('Error\x20details:',_0x49316c),loggerService_1['loggerService'][_0x390c9f(0x1e4)](_0x390c9f(0x1de),_0x390c9f(0x205),_0x49316c);if(_0x49316c instanceof Error){console[_0x390c9f(0x200)](_0x390c9f(0x1f2),_0x49316c[_0x390c9f(0x1e9)]),console[_0x390c9f(0x200)](_0x390c9f(0x249),_0x49316c[_0x390c9f(0x246)]);throw new Error(_0x390c9f(0x1e7)+_0x49316c['message']);}throw new Error(_0x390c9f(0x1e0));}}async[a67_0x4c9bd2(0x1ec)](_0x274f7f){const _0x21c19e=a67_0x4c9bd2,_0x212df5=Date[_0x21c19e(0x1fa)]();try{loggerService_1[_0x21c19e(0x20f)][_0x21c19e(0x225)](_0x21c19e(0x1de),'/v1/hosted/payment_links/'+_0x274f7f,_0x21c19e(0x1e2),{});const _0x4d8e73=await fetch(this[_0x21c19e(0x236)]+'/'+_0x274f7f,{'method':_0x21c19e(0x1e2),'headers':{'Content-Type':_0x21c19e(0x220),'User-Agent':_0x21c19e(0x213)}}),_0x408fc9=Date[_0x21c19e(0x1fa)]()-_0x212df5;if(!_0x4d8e73['ok']){const _0x4d368a=await _0x4d8e73['text']();loggerService_1[_0x21c19e(0x20f)][_0x21c19e(0x207)](_0x21c19e(0x1de),_0x21c19e(0x21a)+_0x274f7f,_0x4d8e73[_0x21c19e(0x1dc)],_0x4d368a,_0x408fc9);throw new Error('HTTP\x20error!\x20status:\x20'+_0x4d8e73['status']);}const _0x449472=await _0x4d8e73['json']();loggerService_1[_0x21c19e(0x20f)][_0x21c19e(0x207)](_0x21c19e(0x1de),'/v1/hosted/payment_links/'+_0x274f7f,_0x4d8e73[_0x21c19e(0x1dc)],_0x449472,_0x408fc9);if(_0x449472[_0x21c19e(0x1dc)]?.[_0x21c19e(0x1dc)]!==_0x21c19e(0x24f)){loggerService_1[_0x21c19e(0x20f)][_0x21c19e(0x1e4)](_0x21c19e(0x1de),_0x21c19e(0x21a)+_0x274f7f,'Rapyd\x20API\x20error:\x20'+(_0x449472[_0x21c19e(0x1dc)]?.[_0x21c19e(0x1e9)]||'Unknown\x20error'));throw new Error('Rapyd\x20API\x20error:\x20'+(_0x449472[_0x21c19e(0x1dc)]?.[_0x21c19e(0x1e9)]||_0x21c19e(0x206)));}let _0xf3e68c=_0x21c19e(0x1f9);if(_0x449472[_0x21c19e(0x24c)]?.['status'])switch(_0x449472[_0x21c19e(0x24c)][_0x21c19e(0x1dc)][_0x21c19e(0x227)]()){case _0x21c19e(0x21f):_0xf3e68c=_0x21c19e(0x22a);break;case _0x21c19e(0x254):_0xf3e68c='FAILED';break;case _0x21c19e(0x20d):_0xf3e68c='EXPIRED';break;case _0x21c19e(0x228):_0xf3e68c=_0x21c19e(0x202);break;case _0x21c19e(0x22c):case _0x21c19e(0x25d):default:_0xf3e68c='PENDING';break;}return{'status':_0xf3e68c,'amount':_0x449472['data']?.['amount'],'currency':_0x449472[_0x21c19e(0x24c)]?.[_0x21c19e(0x1ff)]};}catch(_0x4f8bfd){console[_0x21c19e(0x200)]('Rapyd\x20payment\x20verification\x20error:',_0x4f8bfd),loggerService_1[_0x21c19e(0x20f)][_0x21c19e(0x1e4)]('rapyd',_0x21c19e(0x21a)+_0x274f7f,_0x4f8bfd);throw new Error(_0x21c19e(0x1dd)+(_0x4f8bfd instanceof Error?_0x4f8bfd[_0x21c19e(0x1e9)]:_0x21c19e(0x206)));}}async[a67_0x4c9bd2(0x230)](_0x557145){const _0x5b85cf=a67_0x4c9bd2;console['log'](_0x5b85cf(0x23d),_0x557145);let _0x59a4ca=_0x5b85cf(0x1f9),_0x24b974;_0x557145['data']?.[_0x5b85cf(0x232)]&&(_0x24b974=_0x557145[_0x5b85cf(0x24c)]['failure_message'],console['log'](_0x5b85cf(0x248)+_0x24b974));switch(_0x557145[_0x5b85cf(0x21c)]?.[_0x5b85cf(0x227)]()){case _0x5b85cf(0x240):_0x557145[_0x5b85cf(0x24c)]?.[_0x5b85cf(0x237)]===!![]&&_0x557145['data']?.[_0x5b85cf(0x1dc)]===_0x5b85cf(0x21f)?_0x59a4ca=_0x5b85cf(0x22a):_0x59a4ca='PENDING';break;case'PAYMENT_CANCELED':_0x59a4ca='FAILED';break;case'PAYMENT_EXPIRED':_0x59a4ca=_0x5b85cf(0x216);break;case _0x5b85cf(0x1e8):_0x59a4ca=_0x5b85cf(0x202);!_0x24b974&&_0x557145[_0x5b85cf(0x24c)]?.[_0x5b85cf(0x232)]&&(_0x24b974=_0x557145['data'][_0x5b85cf(0x232)]);break;default:switch(_0x557145[_0x5b85cf(0x24c)]?.['status']?.[_0x5b85cf(0x227)]()){case _0x5b85cf(0x21f):_0x557145[_0x5b85cf(0x24c)]?.[_0x5b85cf(0x237)]===!![]?_0x59a4ca='PAID':_0x59a4ca='FAILED';break;case'CAN':_0x59a4ca=_0x5b85cf(0x202);break;case _0x5b85cf(0x20d):_0x59a4ca='EXPIRED';break;case'ERR':_0x59a4ca='FAILED';!_0x24b974&&_0x557145[_0x5b85cf(0x24c)]?.[_0x5b85cf(0x232)]&&(_0x24b974=_0x557145['data'][_0x5b85cf(0x232)]);break;case _0x5b85cf(0x22c):case _0x5b85cf(0x25d):default:_0x59a4ca=_0x5b85cf(0x1f9);break;}break;}const _0x4563bb={};return _0x557145[_0x5b85cf(0x24c)]?.['payment_method_data']?.[_0x5b85cf(0x241)]&&(_0x4563bb['cardLast4']=_0x557145[_0x5b85cf(0x24c)]['payment_method_data'][_0x5b85cf(0x241)]),_0x557145['data']?.[_0x5b85cf(0x251)]?.[_0x5b85cf(0x1e1)]?.['brand']&&(_0x4563bb[_0x5b85cf(0x211)]=_0x557145[_0x5b85cf(0x24c)][_0x5b85cf(0x251)]['bin_details']['brand'],console[_0x5b85cf(0x256)](_0x5b85cf(0x217)+_0x4563bb[_0x5b85cf(0x211)])),_0x557145[_0x5b85cf(0x24c)]?.[_0x5b85cf(0x24a)]&&(_0x4563bb[_0x5b85cf(0x24d)]=_0x557145[_0x5b85cf(0x24c)]['payment_method_type']),_0x557145['data']?.[_0x5b85cf(0x233)]&&(_0x4563bb[_0x5b85cf(0x250)]=_0x557145[_0x5b85cf(0x24c)][_0x5b85cf(0x233)]),_0x557145['data']?.['failure_code']&&(_0x4563bb[_0x5b85cf(0x1f8)]=_0x557145[_0x5b85cf(0x24c)][_0x5b85cf(0x25c)]),console[_0x5b85cf(0x256)](_0x5b85cf(0x235)+_0x59a4ca+_0x5b85cf(0x1eb)+(_0x24b974||_0x5b85cf(0x226))),{'paymentId':_0x557145[_0x5b85cf(0x24c)]?.['merchant_reference_id']||'','status':_0x59a4ca,'amount':_0x557145['data']?.['amount'],'currency':_0x557145[_0x5b85cf(0x24c)]?.['currency'],'failureMessage':_0x24b974,'additionalInfo':_0x4563bb};}}exports['RapydService']=RapydService;