'use strict';function a56_0x36e6(){const _0x46e04b=['FAILED','CLO','PENDING','expiration','none','\x20->\x20EUR:','PAYMENT_FAILED','requested_currency','===\x20RAPYD\x20API\x20REQUEST\x20(White\x20Domain\x20-\x20Updated\x20Format)\x20===','CAN','===\x20RAPYD\x20API\x20BUSINESS\x20ERROR\x20===','GET','PAYMENT_EXPIRED','processWebhook','PAYMENT_COMPLETED','https://tesoft.uk/gateway/success.php?id=','entries','===\x20RAPYD\x20SERVICE\x20ERROR\x20===','createPaymentLink',',\x20failureMessage=','===\x20RAPYD\x20API\x20INCOMPLETE\x20RESPONSE\x20===','1544ENEFez','Rapyd\x20payment\x20verification\x20error:','===\x20RAPYD\x20SUCCESS\x20===','logWhiteDomainRequest','redirect_url','payment_method_data','Error\x20message:','amount','Incomplete\x20response:\x20missing\x20id\x20or\x20redirect_url','currency','failure_code','Error\x20Message:','Payment\x20System/1.0','parse','5037354oKEHHf','buy','Unknown\x20error\x20from\x20Rapyd\x20API','EXP','PAYMENT_CANCELED','log','Request\x20Body\x20(Updated\x20Format):','Response\x20data:','Business\x20Error\x20(','Raw\x20Response\x20Body:','application/json','Failed\x20to\x20create\x20Rapyd\x20payment\x20link:\x20','failure_message','217174MVAjkd','\x20(GB\x20-\x20Britain)','gb_visa_card','RapydService','NEW','Headers:','Failed\x20to\x20parse\x20JSON\x20response:','error_code','EUR','Redirect\x20URL:','verifyPayment','Payment\x20Link\x20ID:','logWhiteDomainResponse','fromEntries','status','HTTP\x20error!\x20status:\x20','Failed\x20to\x20verify\x20Rapyd\x20payment:\x20','Missing\x20id\x20or\x20redirect_url\x20in\x20response','Parsed\x20Result:','payment_method_type','EXPIRED','https://tesoft.uk/gateway/rapyd/','üá¨üáß\x20Country\x20used:\x20','üá¨üáß\x20Using\x20GB\x20(Britain)\x20as\x20country\x20for\x20Rapyd\x20payment\x20link','üí≥\x20Payment\x20Methods:\x20gb_visa_card,\x20gb_mastercard_card','SUCCESS','Rapyd\x20API\x20error:\x20','now','HTTP\x20','Rapyd\x20API\x20error\x20(','315635LElVKT','logWhiteDomainError','2124504mJapxu','defineProperty','URL:','7675ApOSMu','\x20\x20\x20requested_currency:\x20EUR','PAID','Error\x20details:','Failed\x20to\x20create\x20Rapyd\x20payment\x20link:\x20Unknown\x20error','rapyd','text','error','üåê\x20Rapyd\x20service\x20initialized\x20with\x20white\x20domain\x20proxy',',\x20body:\x20','===\x20RAPYD\x20API\x20RESPONSE\x20(White\x20Domain)\x20===','loggerService','toISOString','üí±\x20Adding\x20currency\x20conversion\x20fields\x20for\x20','ACT','data','):\x20','apiUrl','/v1/hosted/payment_links/','Response\x20Body:','\x20\x20\x20fixed_side:\x20buy','JSON\x20Parse\x20Error:\x20','Unknown\x20error','üá¨üáß\x20Country:\x20','paid','paymentMethod','===\x20RAPYD\x20API\x20ERROR\x20===','merchant_reference_id','Status:','512400ezOTcT','Error\x20Code:','toUpperCase','\x20\x20\x20expiration:\x20','message','\x20(always\x20GB\x20for\x20Rapyd)','/v1/hosted/payment_links','POST','stringify','type','Invalid\x20JSON\x20response\x20from\x20Rapyd\x20API:\x20','last4','Processing\x20Rapyd\x20webhook:','2758536vocQmv'];a56_0x36e6=function(){return _0x46e04b;};return a56_0x36e6();}function a56_0x1292(_0xbd43bb,_0x27dc27){const _0x36e619=a56_0x36e6();return a56_0x1292=function(_0x129256,_0x149bf6){_0x129256=_0x129256-0xce;let _0x1ad855=_0x36e619[_0x129256];return _0x1ad855;},a56_0x1292(_0xbd43bb,_0x27dc27);}const a56_0x35a445=a56_0x1292;(function(_0x360e53,_0x1f1479){const _0x48a3a6=a56_0x1292,_0x1a1415=_0x360e53();while(!![]){try{const _0x3f97b4=parseInt(_0x48a3a6(0xdb))/0x1+parseInt(_0x48a3a6(0x13b))/0x2+parseInt(_0x48a3a6(0xfd))/0x3+parseInt(_0x48a3a6(0x120))/0x4*(-parseInt(_0x48a3a6(0xe0))/0x5)+-parseInt(_0x48a3a6(0x10a))/0x6+parseInt(_0x48a3a6(0x12e))/0x7+parseInt(_0x48a3a6(0xdd))/0x8;if(_0x3f97b4===_0x1f1479)break;else _0x1a1415['push'](_0x1a1415['shift']());}catch(_0x2ed66b){_0x1a1415['push'](_0x1a1415['shift']());}}}(a56_0x36e6,0x80e45));Object[a56_0x35a445(0xde)](exports,'__esModule',{'value':!![]}),exports[a56_0x35a445(0x13e)]=void 0x0;const loggerService_1=require('../loggerService');class RapydService{constructor(){const _0x3036f9=a56_0x35a445;this[_0x3036f9(0xf1)]=_0x3036f9(0xd2),console['log'](_0x3036f9(0xe8));}async[a56_0x35a445(0x11d)](_0x2efe8d){const _0x7bd3e5=a56_0x35a445,{orderId:_0x1cadd9,orderName:_0x16ff18,amount:_0x2e8aab,currency:_0x274bdd,usage:_0x3ea395,maxPayments:_0x46a86c,successUrl:_0x6a6f3d,failUrl:_0x53bbcc}=_0x2efe8d,_0x291856=_0x274bdd[_0x7bd3e5(0xff)](),_0x19e036='GB';console[_0x7bd3e5(0x133)](_0x7bd3e5(0xd4));const _0x5ac5c9=_0x7bd3e5(0x11a)+_0x1cadd9,_0x1dd105='https://tesoft.uk/gateway/fail.php?id='+_0x1cadd9,_0x367958={'amount':_0x2e8aab,'currency':_0x291856,'cancel_checkout_url':_0x1dd105,'complete_checkout_url':_0x5ac5c9,'complete_payment_url':_0x5ac5c9,'merchant_reference_id':_0x1cadd9,'description':'ORDER:\x20'+_0x1cadd9,'country':'GB','payment_method_types_include':[_0x7bd3e5(0x13d),'gb_mastercard_card'],'custom_elements':{'display_description':!![]}};if(_0x291856!==_0x7bd3e5(0x143)){const _0x6e4a81=Math['floor'](Date[_0x7bd3e5(0xd8)]()/0x3e8)+0x1e*0x3c;_0x367958['fixed_side']=_0x7bd3e5(0x12f),_0x367958[_0x7bd3e5(0x112)]=_0x7bd3e5(0x143),_0x367958[_0x7bd3e5(0x10e)]=_0x6e4a81,console[_0x7bd3e5(0x133)](_0x7bd3e5(0xed)+_0x291856+_0x7bd3e5(0x110)),console[_0x7bd3e5(0x133)](_0x7bd3e5(0xf4)),console['log'](_0x7bd3e5(0xe1)),console[_0x7bd3e5(0x133)](_0x7bd3e5(0x100)+_0x6e4a81+'\x20('+new Date(_0x6e4a81*0x3e8)[_0x7bd3e5(0xec)]()+')');}const _0x540ee1=Date['now']();try{console[_0x7bd3e5(0x133)](_0x7bd3e5(0x113)),console[_0x7bd3e5(0x133)](_0x7bd3e5(0xdf),this['apiUrl']),console[_0x7bd3e5(0x133)](_0x7bd3e5(0x134),JSON[_0x7bd3e5(0x105)](_0x367958,null,0x2)),console[_0x7bd3e5(0x133)](_0x7bd3e5(0xf7)+_0x19e036+_0x7bd3e5(0x102)),console[_0x7bd3e5(0x133)]('üí≥\x20Payment\x20Methods:\x20gb_visa_card,\x20gb_mastercard_card'),loggerService_1[_0x7bd3e5(0xeb)][_0x7bd3e5(0x123)](_0x7bd3e5(0xe5),_0x7bd3e5(0x103),_0x7bd3e5(0x104),_0x367958);const _0x52ded3=await fetch(this[_0x7bd3e5(0xf1)],{'method':'POST','headers':{'Content-Type':_0x7bd3e5(0x138),'User-Agent':_0x7bd3e5(0x12c)},'body':JSON[_0x7bd3e5(0x105)](_0x367958)}),_0x2700e1=Date[_0x7bd3e5(0xd8)]()-_0x540ee1;console['log'](_0x7bd3e5(0xea)),console['log'](_0x7bd3e5(0xfc),_0x52ded3[_0x7bd3e5(0x149)]),console[_0x7bd3e5(0x133)]('Status\x20Text:',_0x52ded3['statusText']),console['log'](_0x7bd3e5(0x140),Object[_0x7bd3e5(0x148)](_0x52ded3['headers'][_0x7bd3e5(0x11b)]())),console[_0x7bd3e5(0x133)]('Response\x20Time:',_0x2700e1+'ms');const _0x49a7e4=await _0x52ded3[_0x7bd3e5(0xe6)]();console[_0x7bd3e5(0x133)](_0x7bd3e5(0x137),_0x49a7e4);if(!_0x52ded3['ok']){console[_0x7bd3e5(0xe7)](_0x7bd3e5(0xfa)),console[_0x7bd3e5(0xe7)]('HTTP\x20Status:',_0x52ded3[_0x7bd3e5(0x149)]),console[_0x7bd3e5(0xe7)](_0x7bd3e5(0xf3),_0x49a7e4),loggerService_1[_0x7bd3e5(0xeb)][_0x7bd3e5(0x147)]('rapyd',_0x7bd3e5(0x103),_0x52ded3[_0x7bd3e5(0x149)],_0x49a7e4,_0x2700e1),loggerService_1[_0x7bd3e5(0xeb)][_0x7bd3e5(0xdc)](_0x7bd3e5(0xe5),'/v1/hosted/payment_links',_0x7bd3e5(0xd9)+_0x52ded3[_0x7bd3e5(0x149)]+':\x20'+_0x49a7e4);throw new Error(_0x7bd3e5(0x14a)+_0x52ded3[_0x7bd3e5(0x149)]+_0x7bd3e5(0xe9)+_0x49a7e4);}let _0x360a80;try{_0x360a80=JSON[_0x7bd3e5(0x12d)](_0x49a7e4);}catch(_0x27eb04){console[_0x7bd3e5(0xe7)](_0x7bd3e5(0x141),_0x27eb04),loggerService_1[_0x7bd3e5(0xeb)][_0x7bd3e5(0xdc)](_0x7bd3e5(0xe5),_0x7bd3e5(0x103),_0x7bd3e5(0xf5)+_0x27eb04);throw new Error(_0x7bd3e5(0x107)+_0x49a7e4);}console['log']('===\x20PARSED\x20RAPYD\x20RESPONSE\x20==='),console[_0x7bd3e5(0x133)](_0x7bd3e5(0xcf),JSON[_0x7bd3e5(0x105)](_0x360a80,null,0x2)),loggerService_1['loggerService']['logWhiteDomainResponse'](_0x7bd3e5(0xe5),'/v1/hosted/payment_links',_0x52ded3[_0x7bd3e5(0x149)],_0x360a80,_0x2700e1);if(_0x360a80[_0x7bd3e5(0x149)]?.[_0x7bd3e5(0x149)]!=='SUCCESS'){const _0x3a4960=_0x360a80[_0x7bd3e5(0x149)]?.[_0x7bd3e5(0x101)]||_0x7bd3e5(0x130),_0x368913=_0x360a80['status']?.['error_code']||'UNKNOWN';console[_0x7bd3e5(0xe7)](_0x7bd3e5(0x115)),console[_0x7bd3e5(0xe7)](_0x7bd3e5(0xfe),_0x368913),console[_0x7bd3e5(0xe7)](_0x7bd3e5(0x12b),_0x3a4960),console['error']('Full\x20Error\x20Data:',_0x360a80[_0x7bd3e5(0x149)]),loggerService_1[_0x7bd3e5(0xeb)][_0x7bd3e5(0xdc)](_0x7bd3e5(0xe5),_0x7bd3e5(0x103),_0x7bd3e5(0x136)+_0x368913+_0x7bd3e5(0xf0)+_0x3a4960);throw new Error(_0x7bd3e5(0xda)+_0x368913+_0x7bd3e5(0xf0)+_0x3a4960);}if(!_0x360a80[_0x7bd3e5(0xef)]?.['id']||!_0x360a80[_0x7bd3e5(0xef)]?.[_0x7bd3e5(0x124)]){console[_0x7bd3e5(0xe7)](_0x7bd3e5(0x11f)),console[_0x7bd3e5(0xe7)](_0x7bd3e5(0xce)),console[_0x7bd3e5(0xe7)](_0x7bd3e5(0x135),_0x360a80['data']),loggerService_1[_0x7bd3e5(0xeb)][_0x7bd3e5(0xdc)]('rapyd',_0x7bd3e5(0x103),_0x7bd3e5(0x128));throw new Error('Invalid\x20response\x20from\x20Rapyd\x20API:\x20missing\x20id\x20or\x20redirect_url');}return console['log'](_0x7bd3e5(0x122)),console[_0x7bd3e5(0x133)](_0x7bd3e5(0x146),_0x360a80[_0x7bd3e5(0xef)]['id']),console['log'](_0x7bd3e5(0x144),_0x360a80['data'][_0x7bd3e5(0x124)]),console[_0x7bd3e5(0x133)](_0x7bd3e5(0xd3)+_0x19e036+_0x7bd3e5(0x13c)),console[_0x7bd3e5(0x133)](_0x7bd3e5(0xd5)),{'gateway_payment_id':_0x360a80[_0x7bd3e5(0xef)]['id'],'payment_url':_0x360a80[_0x7bd3e5(0xef)][_0x7bd3e5(0x124)]};}catch(_0x69ed44){console[_0x7bd3e5(0xe7)](_0x7bd3e5(0x11c)),console['error'](_0x7bd3e5(0xe3),_0x69ed44),loggerService_1['loggerService'][_0x7bd3e5(0xdc)]('rapyd',_0x7bd3e5(0x103),_0x69ed44);if(_0x69ed44 instanceof Error){console[_0x7bd3e5(0xe7)](_0x7bd3e5(0x126),_0x69ed44['message']),console[_0x7bd3e5(0xe7)]('Error\x20stack:',_0x69ed44['stack']);throw new Error(_0x7bd3e5(0x139)+_0x69ed44['message']);}throw new Error(_0x7bd3e5(0xe4));}}async[a56_0x35a445(0x145)](_0x23d104){const _0x376490=a56_0x35a445,_0x2db8cc=Date['now']();try{loggerService_1[_0x376490(0xeb)][_0x376490(0x123)](_0x376490(0xe5),_0x376490(0xf2)+_0x23d104,_0x376490(0x116),{});const _0x33d99d=await fetch(this[_0x376490(0xf1)]+'/'+_0x23d104,{'method':_0x376490(0x116),'headers':{'Content-Type':_0x376490(0x138),'User-Agent':'Payment\x20System/1.0'}}),_0x1efb7a=Date['now']()-_0x2db8cc;if(!_0x33d99d['ok']){const _0x2fb068=await _0x33d99d[_0x376490(0xe6)]();loggerService_1[_0x376490(0xeb)][_0x376490(0x147)]('rapyd',_0x376490(0xf2)+_0x23d104,_0x33d99d[_0x376490(0x149)],_0x2fb068,_0x1efb7a);throw new Error(_0x376490(0x14a)+_0x33d99d[_0x376490(0x149)]);}const _0x4a1a84=await _0x33d99d['json']();loggerService_1[_0x376490(0xeb)]['logWhiteDomainResponse'](_0x376490(0xe5),_0x376490(0xf2)+_0x23d104,_0x33d99d[_0x376490(0x149)],_0x4a1a84,_0x1efb7a);if(_0x4a1a84[_0x376490(0x149)]?.[_0x376490(0x149)]!==_0x376490(0xd6)){loggerService_1[_0x376490(0xeb)][_0x376490(0xdc)](_0x376490(0xe5),_0x376490(0xf2)+_0x23d104,_0x376490(0xd7)+(_0x4a1a84[_0x376490(0x149)]?.[_0x376490(0x101)]||_0x376490(0xf6)));throw new Error('Rapyd\x20API\x20error:\x20'+(_0x4a1a84['status']?.[_0x376490(0x101)]||_0x376490(0xf6)));}let _0x3140ec='PENDING';if(_0x4a1a84[_0x376490(0xef)]?.['status'])switch(_0x4a1a84['data'][_0x376490(0x149)]['toUpperCase']()){case'CLO':_0x3140ec=_0x376490(0xe2);break;case'CAN':_0x3140ec=_0x376490(0x10b);break;case _0x376490(0x131):_0x3140ec='EXPIRED';break;case'ERR':_0x3140ec='FAILED';break;case'NEW':case _0x376490(0xee):default:_0x3140ec=_0x376490(0x10d);break;}return{'status':_0x3140ec,'amount':_0x4a1a84['data']?.[_0x376490(0x127)],'currency':_0x4a1a84[_0x376490(0xef)]?.[_0x376490(0x129)]};}catch(_0x37349e){console[_0x376490(0xe7)](_0x376490(0x121),_0x37349e),loggerService_1[_0x376490(0xeb)][_0x376490(0xdc)]('rapyd','/v1/hosted/payment_links/'+_0x23d104,_0x37349e);throw new Error(_0x376490(0x14b)+(_0x37349e instanceof Error?_0x37349e['message']:_0x376490(0xf6)));}}async[a56_0x35a445(0x118)](_0x4a67c8){const _0x4e29f8=a56_0x35a445;console[_0x4e29f8(0x133)](_0x4e29f8(0x109),_0x4a67c8);let _0x3bcadb=_0x4e29f8(0x10d),_0x3dbdd5;_0x4a67c8[_0x4e29f8(0xef)]?.[_0x4e29f8(0x13a)]&&(_0x3dbdd5=_0x4a67c8[_0x4e29f8(0xef)][_0x4e29f8(0x13a)],console['log']('üí•\x20Rapyd\x20failure\x20message:\x20'+_0x3dbdd5));switch(_0x4a67c8[_0x4e29f8(0x106)]?.['toUpperCase']()){case _0x4e29f8(0x119):_0x4a67c8[_0x4e29f8(0xef)]?.['paid']===!![]&&_0x4a67c8[_0x4e29f8(0xef)]?.['status']===_0x4e29f8(0x10c)?_0x3bcadb='PAID':_0x3bcadb='PENDING';break;case _0x4e29f8(0x132):_0x3bcadb='FAILED';break;case _0x4e29f8(0x117):_0x3bcadb='EXPIRED';break;case _0x4e29f8(0x111):_0x3bcadb='FAILED';!_0x3dbdd5&&_0x4a67c8['data']?.['failure_message']&&(_0x3dbdd5=_0x4a67c8['data'][_0x4e29f8(0x13a)]);break;default:switch(_0x4a67c8[_0x4e29f8(0xef)]?.[_0x4e29f8(0x149)]?.[_0x4e29f8(0xff)]()){case'CLO':_0x4a67c8[_0x4e29f8(0xef)]?.[_0x4e29f8(0xf8)]===!![]?_0x3bcadb=_0x4e29f8(0xe2):_0x3bcadb=_0x4e29f8(0x10b);break;case _0x4e29f8(0x114):_0x3bcadb=_0x4e29f8(0x10b);break;case _0x4e29f8(0x131):_0x3bcadb=_0x4e29f8(0xd1);break;case'ERR':_0x3bcadb=_0x4e29f8(0x10b);!_0x3dbdd5&&_0x4a67c8['data']?.[_0x4e29f8(0x13a)]&&(_0x3dbdd5=_0x4a67c8[_0x4e29f8(0xef)]['failure_message']);break;case _0x4e29f8(0x13f):case _0x4e29f8(0xee):default:_0x3bcadb=_0x4e29f8(0x10d);break;}break;}const _0x57c2d7={};return _0x4a67c8[_0x4e29f8(0xef)]?.[_0x4e29f8(0x125)]?.[_0x4e29f8(0x108)]&&(_0x57c2d7['cardLast4']=_0x4a67c8[_0x4e29f8(0xef)][_0x4e29f8(0x125)][_0x4e29f8(0x108)]),_0x4a67c8['data']?.['payment_method_type']&&(_0x57c2d7[_0x4e29f8(0xf9)]=_0x4a67c8[_0x4e29f8(0xef)][_0x4e29f8(0xd0)]),_0x4a67c8[_0x4e29f8(0xef)]?.[_0x4e29f8(0x142)]&&(_0x57c2d7['errorCode']=_0x4a67c8[_0x4e29f8(0xef)][_0x4e29f8(0x142)]),_0x4a67c8['data']?.[_0x4e29f8(0x12a)]&&(_0x57c2d7['failureCode']=_0x4a67c8[_0x4e29f8(0xef)][_0x4e29f8(0x12a)]),console[_0x4e29f8(0x133)]('üîÑ\x20Rapyd\x20webhook\x20processed:\x20status='+_0x3bcadb+_0x4e29f8(0x11e)+(_0x3dbdd5||_0x4e29f8(0x10f))),{'paymentId':_0x4a67c8['data']?.[_0x4e29f8(0xfb)]||'','status':_0x3bcadb,'amount':_0x4a67c8[_0x4e29f8(0xef)]?.[_0x4e29f8(0x127)],'currency':_0x4a67c8[_0x4e29f8(0xef)]?.['currency'],'failureMessage':_0x3dbdd5,'additionalInfo':_0x57c2d7};}}exports['RapydService']=RapydService;