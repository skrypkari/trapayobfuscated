'use strict';const a48_0x5687bd=a48_0x5ccc;(function(_0x4d29d7,_0x4a84dd){const _0x4e77fa=a48_0x5ccc,_0x5cdcd6=_0x4d29d7();while(!![]){try{const _0x26d243=-parseInt(_0x4e77fa(0x1a0))/0x1*(-parseInt(_0x4e77fa(0x155))/0x2)+parseInt(_0x4e77fa(0x19f))/0x3*(-parseInt(_0x4e77fa(0x192))/0x4)+-parseInt(_0x4e77fa(0x16e))/0x5+parseInt(_0x4e77fa(0x15c))/0x6*(parseInt(_0x4e77fa(0x12c))/0x7)+parseInt(_0x4e77fa(0x16a))/0x8*(parseInt(_0x4e77fa(0x14f))/0x9)+-parseInt(_0x4e77fa(0x128))/0xa+parseInt(_0x4e77fa(0x158))/0xb*(parseInt(_0x4e77fa(0x191))/0xc);if(_0x26d243===_0x4a84dd)break;else _0x5cdcd6['push'](_0x5cdcd6['shift']());}catch(_0xab0a30){_0x5cdcd6['push'](_0x5cdcd6['shift']());}}}(a48_0x4370,0x72105));function a48_0x4370(){const _0x19645c=['):\x20','application/json','Failed\x20to\x20verify\x20Rapyd\x20payment:\x20','json','543nSyhMn','92823CuybYk','RapydService','parse','===\x20RAPYD\x20API\x20REQUEST\x20(White\x20Domain\x20-\x20Updated\x20Format)\x20===','error','now','HTTP\x20error!\x20status:\x20','redirect_url','https://tesoft.uk/gateway/fail.php?id=','\x20\x20\x20expiration:\x20','PAID','5999210isIMqh','Invalid\x20response\x20from\x20Rapyd\x20API:\x20missing\x20id\x20or\x20redirect_url','Error\x20message:','ORDER:\x20','21259ScmtRq','===\x20RAPYD\x20API\x20INCOMPLETE\x20RESPONSE\x20===','\x20\x20\x20fixed_side:\x20buy','entries','gb_visa_card','Headers:','PAYMENT_EXPIRED','error_code','failure_message','JSON\x20Parse\x20Error:\x20','errorCode','Rapyd\x20API\x20error\x20(','===\x20RAPYD\x20API\x20BUSINESS\x20ERROR\x20===','loggerService','SUCCESS','Unknown\x20error','\x20(always\x20GB\x20for\x20Rapyd)','===\x20RAPYD\x20API\x20RESPONSE\x20(White\x20Domain)\x20===','logWhiteDomainResponse','/v1/hosted/payment_links/','Unknown\x20error\x20from\x20Rapyd\x20API','rapyd','UNKNOWN','paid','PAYMENT_COMPLETED','message','gb_mastercard_card','Error\x20details:','text','buy','===\x20RAPYD\x20API\x20ERROR\x20===','Response\x20data:','TesSoft\x20Payment\x20System/1.0','floor','../loggerService','917199hVkWoz','GET','apiUrl','üí≥\x20Payment\x20Methods:\x20gb_visa_card,\x20gb_mastercard_card','Request\x20Body\x20(Updated\x20Format):','Response\x20Time:','12ovxXWm','payment_method_data','ERR','8331521unirIh','status','FAILED','PENDING','1098ELvdtb','toUpperCase','üí•\x20Rapyd\x20failure\x20message:\x20','Invalid\x20JSON\x20response\x20from\x20Rapyd\x20API:\x20','stringify','type','log','===\x20PARSED\x20RAPYD\x20RESPONSE\x20===','CLO','data','Failed\x20to\x20create\x20Rapyd\x20payment\x20link:\x20','/v1/hosted/payment_links','===\x20RAPYD\x20SERVICE\x20ERROR\x20===','merchant_reference_id','40sGcxRV','üîÑ\x20Rapyd\x20webhook\x20processed:\x20status=','Incomplete\x20response:\x20missing\x20id\x20or\x20redirect_url','failure_code','2398840OxjxCH','amount','Failed\x20to\x20parse\x20JSON\x20response:','stack','Rapyd\x20API\x20error:\x20','Error\x20stack:','Response\x20Body:','Business\x20Error\x20(','expiration','\x20(GB\x20-\x20Britain)','cardLast4','\x20->\x20EUR:','statusText','Status:','requested_currency','last4','processWebhook','__esModule','PAYMENT_CANCELED','ACT',',\x20failureMessage=','createPaymentLink','üá¨üáß\x20Country:\x20','POST','üá¨üáß\x20Using\x20GB\x20(Britain)\x20as\x20country\x20for\x20Rapyd\x20payment\x20link','\x20\x20\x20requested_currency:\x20EUR',',\x20body:\x20','logWhiteDomainRequest','defineProperty','PAYMENT_FAILED','headers','üåê\x20Rapyd\x20service\x20initialized\x20with\x20white\x20domain\x20proxy','Status\x20Text:','Error\x20Code:','NEW','12pHxxrG','18404DeNmkW','CAN','Parsed\x20Result:','toISOString','payment_method_type','paymentMethod','none','EXP','logWhiteDomainError'];a48_0x4370=function(){return _0x19645c;};return a48_0x4370();}function a48_0x5ccc(_0xc3bcc6,_0x3fb0e0){const _0x437055=a48_0x4370();return a48_0x5ccc=function(_0x5cccc0,_0x535e94){_0x5cccc0=_0x5cccc0-0x121;let _0x50efa4=_0x437055[_0x5cccc0];return _0x50efa4;},a48_0x5ccc(_0xc3bcc6,_0x3fb0e0);}Object[a48_0x5687bd(0x18a)](exports,a48_0x5687bd(0x17f),{'value':!![]}),exports[a48_0x5687bd(0x1a1)]=void 0x0;const loggerService_1=require(a48_0x5687bd(0x14e));class RapydService{constructor(){const _0xea98b6=a48_0x5687bd;this[_0xea98b6(0x151)]='https://tesoft.uk/gateway/rapyd/',console[_0xea98b6(0x162)](_0xea98b6(0x18d));}async[a48_0x5687bd(0x183)](_0x5667d3){const _0x4b8393=a48_0x5687bd,{orderId:_0xf1f2e8,orderName:_0x1b66df,amount:_0x2bb7a8,currency:_0x2ac717,usage:_0x2036f2,maxPayments:_0xfeb084,successUrl:_0xa7e832,failUrl:_0x3c925b}=_0x5667d3,_0x46822e=_0x2ac717[_0x4b8393(0x15d)](),_0x33db7c='GB';console[_0x4b8393(0x162)](_0x4b8393(0x186));const _0xdc2a0f='https://tesoft.uk/gateway/success.php?id='+_0xf1f2e8,_0x4b0692=_0x4b8393(0x125)+_0xf1f2e8,_0xd1845e={'amount':_0x2bb7a8,'currency':_0x46822e,'cancel_checkout_url':_0x4b0692,'complete_checkout_url':_0xdc2a0f,'complete_payment_url':_0xdc2a0f,'merchant_reference_id':_0xf1f2e8,'description':_0x4b8393(0x12b)+_0xf1f2e8,'country':'GB','payment_method_types_include':[_0x4b8393(0x130),_0x4b8393(0x146)],'custom_elements':{'display_description':!![]}};if(_0x46822e!=='EUR'){const _0x36db17=Math[_0x4b8393(0x14d)](Date[_0x4b8393(0x122)]()/0x3e8)+0x1e*0x3c;_0xd1845e['fixed_side']=_0x4b8393(0x149),_0xd1845e[_0x4b8393(0x17c)]='EUR',_0xd1845e[_0x4b8393(0x176)]=_0x36db17,console[_0x4b8393(0x162)]('üí±\x20Adding\x20currency\x20conversion\x20fields\x20for\x20'+_0x46822e+_0x4b8393(0x179)),console['log'](_0x4b8393(0x12e)),console[_0x4b8393(0x162)](_0x4b8393(0x187)),console['log'](_0x4b8393(0x126)+_0x36db17+'\x20('+new Date(_0x36db17*0x3e8)[_0x4b8393(0x195)]()+')');}const _0x1b80bb=Date['now']();try{console[_0x4b8393(0x162)](_0x4b8393(0x1a3)),console['log']('URL:',this[_0x4b8393(0x151)]),console[_0x4b8393(0x162)](_0x4b8393(0x153),JSON[_0x4b8393(0x160)](_0xd1845e,null,0x2)),console[_0x4b8393(0x162)](_0x4b8393(0x184)+_0x33db7c+_0x4b8393(0x13c)),console[_0x4b8393(0x162)](_0x4b8393(0x152)),loggerService_1[_0x4b8393(0x139)]['logWhiteDomainRequest']('rapyd',_0x4b8393(0x167),_0x4b8393(0x185),_0xd1845e);const _0x5d8180=await fetch(this[_0x4b8393(0x151)],{'method':'POST','headers':{'Content-Type':_0x4b8393(0x19c),'User-Agent':'TesSoft\x20Payment\x20System/1.0'},'body':JSON[_0x4b8393(0x160)](_0xd1845e)}),_0x2a0dc7=Date['now']()-_0x1b80bb;console[_0x4b8393(0x162)](_0x4b8393(0x13d)),console[_0x4b8393(0x162)](_0x4b8393(0x17b),_0x5d8180[_0x4b8393(0x159)]),console[_0x4b8393(0x162)](_0x4b8393(0x18e),_0x5d8180[_0x4b8393(0x17a)]),console[_0x4b8393(0x162)](_0x4b8393(0x131),Object['fromEntries'](_0x5d8180[_0x4b8393(0x18c)][_0x4b8393(0x12f)]())),console[_0x4b8393(0x162)](_0x4b8393(0x154),_0x2a0dc7+'ms');const _0x4e75f1=await _0x5d8180[_0x4b8393(0x148)]();console[_0x4b8393(0x162)]('Raw\x20Response\x20Body:',_0x4e75f1);if(!_0x5d8180['ok']){console[_0x4b8393(0x121)](_0x4b8393(0x14a)),console[_0x4b8393(0x121)]('HTTP\x20Status:',_0x5d8180[_0x4b8393(0x159)]),console[_0x4b8393(0x121)](_0x4b8393(0x174),_0x4e75f1),loggerService_1[_0x4b8393(0x139)]['logWhiteDomainResponse'](_0x4b8393(0x141),'/v1/hosted/payment_links',_0x5d8180[_0x4b8393(0x159)],_0x4e75f1,_0x2a0dc7),loggerService_1['loggerService']['logWhiteDomainError'](_0x4b8393(0x141),_0x4b8393(0x167),'HTTP\x20'+_0x5d8180[_0x4b8393(0x159)]+':\x20'+_0x4e75f1);throw new Error(_0x4b8393(0x123)+_0x5d8180[_0x4b8393(0x159)]+_0x4b8393(0x188)+_0x4e75f1);}let _0x148692;try{_0x148692=JSON[_0x4b8393(0x1a2)](_0x4e75f1);}catch(_0xaf568b){console['error'](_0x4b8393(0x170),_0xaf568b),loggerService_1['loggerService'][_0x4b8393(0x19a)](_0x4b8393(0x141),_0x4b8393(0x167),_0x4b8393(0x135)+_0xaf568b);throw new Error(_0x4b8393(0x15f)+_0x4e75f1);}console[_0x4b8393(0x162)](_0x4b8393(0x163)),console['log'](_0x4b8393(0x194),JSON[_0x4b8393(0x160)](_0x148692,null,0x2)),loggerService_1[_0x4b8393(0x139)][_0x4b8393(0x13e)](_0x4b8393(0x141),'/v1/hosted/payment_links',_0x5d8180['status'],_0x148692,_0x2a0dc7);if(_0x148692[_0x4b8393(0x159)]?.['status']!==_0x4b8393(0x13a)){const _0xb54b16=_0x148692[_0x4b8393(0x159)]?.['message']||_0x4b8393(0x140),_0x3ca0eb=_0x148692[_0x4b8393(0x159)]?.[_0x4b8393(0x133)]||_0x4b8393(0x142);console[_0x4b8393(0x121)](_0x4b8393(0x138)),console[_0x4b8393(0x121)](_0x4b8393(0x18f),_0x3ca0eb),console[_0x4b8393(0x121)]('Error\x20Message:',_0xb54b16),console[_0x4b8393(0x121)]('Full\x20Error\x20Data:',_0x148692[_0x4b8393(0x159)]),loggerService_1[_0x4b8393(0x139)][_0x4b8393(0x19a)]('rapyd',_0x4b8393(0x167),_0x4b8393(0x175)+_0x3ca0eb+_0x4b8393(0x19b)+_0xb54b16);throw new Error(_0x4b8393(0x137)+_0x3ca0eb+_0x4b8393(0x19b)+_0xb54b16);}if(!_0x148692['data']?.['id']||!_0x148692['data']?.[_0x4b8393(0x124)]){console[_0x4b8393(0x121)](_0x4b8393(0x12d)),console[_0x4b8393(0x121)]('Missing\x20id\x20or\x20redirect_url\x20in\x20response'),console['error'](_0x4b8393(0x14b),_0x148692[_0x4b8393(0x165)]),loggerService_1[_0x4b8393(0x139)][_0x4b8393(0x19a)](_0x4b8393(0x141),_0x4b8393(0x167),_0x4b8393(0x16c));throw new Error(_0x4b8393(0x129));}return console[_0x4b8393(0x162)]('===\x20RAPYD\x20SUCCESS\x20==='),console[_0x4b8393(0x162)]('Payment\x20Link\x20ID:',_0x148692[_0x4b8393(0x165)]['id']),console[_0x4b8393(0x162)]('Redirect\x20URL:',_0x148692[_0x4b8393(0x165)]['redirect_url']),console['log']('üá¨üáß\x20Country\x20used:\x20'+_0x33db7c+_0x4b8393(0x177)),console[_0x4b8393(0x162)]('üí≥\x20Payment\x20Methods:\x20gb_visa_card,\x20gb_mastercard_card'),{'gateway_payment_id':_0x148692['data']['id'],'payment_url':_0x148692[_0x4b8393(0x165)]['redirect_url']};}catch(_0x1e2f2b){console[_0x4b8393(0x121)](_0x4b8393(0x168)),console['error'](_0x4b8393(0x147),_0x1e2f2b),loggerService_1[_0x4b8393(0x139)]['logWhiteDomainError'](_0x4b8393(0x141),_0x4b8393(0x167),_0x1e2f2b);if(_0x1e2f2b instanceof Error){console[_0x4b8393(0x121)](_0x4b8393(0x12a),_0x1e2f2b[_0x4b8393(0x145)]),console['error'](_0x4b8393(0x173),_0x1e2f2b[_0x4b8393(0x171)]);throw new Error(_0x4b8393(0x166)+_0x1e2f2b[_0x4b8393(0x145)]);}throw new Error('Failed\x20to\x20create\x20Rapyd\x20payment\x20link:\x20Unknown\x20error');}}async['verifyPayment'](_0x40038c){const _0x2a9c26=a48_0x5687bd,_0x33a42e=Date['now']();try{loggerService_1['loggerService'][_0x2a9c26(0x189)](_0x2a9c26(0x141),_0x2a9c26(0x13f)+_0x40038c,_0x2a9c26(0x150),{});const _0x30452f=await fetch(this[_0x2a9c26(0x151)]+'/'+_0x40038c,{'method':_0x2a9c26(0x150),'headers':{'Content-Type':_0x2a9c26(0x19c),'User-Agent':_0x2a9c26(0x14c)}}),_0x4a259a=Date[_0x2a9c26(0x122)]()-_0x33a42e;if(!_0x30452f['ok']){const _0x4fe9a0=await _0x30452f['text']();loggerService_1['loggerService'][_0x2a9c26(0x13e)]('rapyd',_0x2a9c26(0x13f)+_0x40038c,_0x30452f[_0x2a9c26(0x159)],_0x4fe9a0,_0x4a259a);throw new Error(_0x2a9c26(0x123)+_0x30452f[_0x2a9c26(0x159)]);}const _0x9eb07f=await _0x30452f[_0x2a9c26(0x19e)]();loggerService_1[_0x2a9c26(0x139)][_0x2a9c26(0x13e)](_0x2a9c26(0x141),'/v1/hosted/payment_links/'+_0x40038c,_0x30452f[_0x2a9c26(0x159)],_0x9eb07f,_0x4a259a);if(_0x9eb07f[_0x2a9c26(0x159)]?.[_0x2a9c26(0x159)]!=='SUCCESS'){loggerService_1[_0x2a9c26(0x139)][_0x2a9c26(0x19a)](_0x2a9c26(0x141),_0x2a9c26(0x13f)+_0x40038c,'Rapyd\x20API\x20error:\x20'+(_0x9eb07f['status']?.[_0x2a9c26(0x145)]||_0x2a9c26(0x13b)));throw new Error(_0x2a9c26(0x172)+(_0x9eb07f[_0x2a9c26(0x159)]?.[_0x2a9c26(0x145)]||'Unknown\x20error'));}let _0x2a6758=_0x2a9c26(0x15b);if(_0x9eb07f['data']?.[_0x2a9c26(0x159)])switch(_0x9eb07f[_0x2a9c26(0x165)]['status'][_0x2a9c26(0x15d)]()){case _0x2a9c26(0x164):_0x2a6758=_0x2a9c26(0x127);break;case _0x2a9c26(0x193):_0x2a6758='FAILED';break;case _0x2a9c26(0x199):_0x2a6758='EXPIRED';break;case'ERR':_0x2a6758=_0x2a9c26(0x15a);break;case _0x2a9c26(0x190):case'ACT':default:_0x2a6758=_0x2a9c26(0x15b);break;}return{'status':_0x2a6758,'amount':_0x9eb07f[_0x2a9c26(0x165)]?.[_0x2a9c26(0x16f)],'currency':_0x9eb07f['data']?.['currency']};}catch(_0x214fde){console['error']('Rapyd\x20payment\x20verification\x20error:',_0x214fde),loggerService_1[_0x2a9c26(0x139)]['logWhiteDomainError'](_0x2a9c26(0x141),_0x2a9c26(0x13f)+_0x40038c,_0x214fde);throw new Error(_0x2a9c26(0x19d)+(_0x214fde instanceof Error?_0x214fde[_0x2a9c26(0x145)]:_0x2a9c26(0x13b)));}}async[a48_0x5687bd(0x17e)](_0x338561){const _0x401060=a48_0x5687bd;console[_0x401060(0x162)]('Processing\x20Rapyd\x20webhook:',_0x338561);let _0x3b7edc='PENDING',_0x3a8227;_0x338561[_0x401060(0x165)]?.[_0x401060(0x134)]&&(_0x3a8227=_0x338561[_0x401060(0x165)]['failure_message'],console[_0x401060(0x162)](_0x401060(0x15e)+_0x3a8227));switch(_0x338561[_0x401060(0x161)]?.[_0x401060(0x15d)]()){case _0x401060(0x144):_0x338561['data']?.[_0x401060(0x143)]===!![]&&_0x338561[_0x401060(0x165)]?.[_0x401060(0x159)]===_0x401060(0x164)?_0x3b7edc=_0x401060(0x127):_0x3b7edc=_0x401060(0x15b);break;case _0x401060(0x180):_0x3b7edc=_0x401060(0x15a);break;case _0x401060(0x132):_0x3b7edc='EXPIRED';break;case _0x401060(0x18b):_0x3b7edc=_0x401060(0x15a);!_0x3a8227&&_0x338561[_0x401060(0x165)]?.[_0x401060(0x134)]&&(_0x3a8227=_0x338561[_0x401060(0x165)][_0x401060(0x134)]);break;default:switch(_0x338561['data']?.['status']?.[_0x401060(0x15d)]()){case _0x401060(0x164):_0x338561[_0x401060(0x165)]?.[_0x401060(0x143)]===!![]?_0x3b7edc=_0x401060(0x127):_0x3b7edc=_0x401060(0x15a);break;case'CAN':_0x3b7edc='FAILED';break;case _0x401060(0x199):_0x3b7edc='EXPIRED';break;case _0x401060(0x157):_0x3b7edc=_0x401060(0x15a);!_0x3a8227&&_0x338561[_0x401060(0x165)]?.[_0x401060(0x134)]&&(_0x3a8227=_0x338561[_0x401060(0x165)]['failure_message']);break;case'NEW':case _0x401060(0x181):default:_0x3b7edc=_0x401060(0x15b);break;}break;}const _0x233f22={};return _0x338561[_0x401060(0x165)]?.[_0x401060(0x156)]?.[_0x401060(0x17d)]&&(_0x233f22[_0x401060(0x178)]=_0x338561[_0x401060(0x165)]['payment_method_data'][_0x401060(0x17d)]),_0x338561[_0x401060(0x165)]?.[_0x401060(0x196)]&&(_0x233f22[_0x401060(0x197)]=_0x338561[_0x401060(0x165)][_0x401060(0x196)]),_0x338561['data']?.[_0x401060(0x133)]&&(_0x233f22[_0x401060(0x136)]=_0x338561[_0x401060(0x165)][_0x401060(0x133)]),_0x338561['data']?.[_0x401060(0x16d)]&&(_0x233f22['failureCode']=_0x338561[_0x401060(0x165)]['failure_code']),console[_0x401060(0x162)](_0x401060(0x16b)+_0x3b7edc+_0x401060(0x182)+(_0x3a8227||_0x401060(0x198))),{'paymentId':_0x338561[_0x401060(0x165)]?.[_0x401060(0x169)]||'','status':_0x3b7edc,'amount':_0x338561[_0x401060(0x165)]?.[_0x401060(0x16f)],'currency':_0x338561[_0x401060(0x165)]?.['currency'],'failureMessage':_0x3a8227,'additionalInfo':_0x233f22};}}exports['RapydService']=RapydService;