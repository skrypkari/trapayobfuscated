'use strict';const a56_0x105284=a56_0x51c6;function a56_0x51c6(_0x27b696,_0x260ed5){const _0x57bd42=a56_0x57bd();return a56_0x51c6=function(_0x51c62,_0x40943d){_0x51c62=_0x51c62-0xe6;let _0x2ed601=_0x57bd42[_0x51c62];return _0x2ed601;},a56_0x51c6(_0x27b696,_0x260ed5);}(function(_0x21004f,_0x217d73){const _0x5f037c=a56_0x51c6,_0x44577e=_0x21004f();while(!![]){try{const _0x3aefb1=parseInt(_0x5f037c(0xfd))/0x1*(-parseInt(_0x5f037c(0x166))/0x2)+-parseInt(_0x5f037c(0x11b))/0x3*(parseInt(_0x5f037c(0xf6))/0x4)+parseInt(_0x5f037c(0x112))/0x5+-parseInt(_0x5f037c(0x128))/0x6*(-parseInt(_0x5f037c(0xff))/0x7)+-parseInt(_0x5f037c(0xf2))/0x8*(-parseInt(_0x5f037c(0xf5))/0x9)+-parseInt(_0x5f037c(0xec))/0xa*(parseInt(_0x5f037c(0x147))/0xb)+parseInt(_0x5f037c(0x15e))/0xc;if(_0x3aefb1===_0x217d73)break;else _0x44577e['push'](_0x44577e['shift']());}catch(_0x4739e7){_0x44577e['push'](_0x44577e['shift']());}}}(a56_0x57bd,0x1e1c0));Object[a56_0x105284(0xf1)](exports,a56_0x105284(0x10a),{'value':!![]}),exports[a56_0x105284(0x13d)]=void 0x0;function a56_0x57bd(){const _0x2f6159=['expiration','none','currency','GET','Incomplete\x20response:\x20missing\x20id\x20or\x20redirect_url','9999ppYEqY','EXP','fixed_side','\x20->\x20EUR:','requested_currency','Error\x20Message:','PAID','SUCCESS','https://tesoft.uk/gateway/success.php?id=','https://tesoft.uk/gateway/rapyd/','Failed\x20to\x20verify\x20Rapyd\x20payment:\x20','/v1/hosted/payment_links','NEW','/v1/hosted/payment_links/','HTTP\x20error!\x20status:\x20','HTTP\x20','error','Response\x20Body:','Invalid\x20JSON\x20response\x20from\x20Rapyd\x20API:\x20','ORDER:\x20','parse','toISOString','gb_mastercard_card','2885100IQfeHz','payment_method_data','FAILED','Missing\x20id\x20or\x20redirect_url\x20in\x20response','data','Failed\x20to\x20parse\x20JSON\x20response:','apiUrl','ACT','78734TFAwkY','toUpperCase','floor','üá¨üáß\x20Using\x20GB\x20(Britain)\x20as\x20country\x20for\x20Rapyd\x20payment\x20link','Headers:','payment_method_type','Rapyd\x20API\x20error\x20(','1810kyzUyn','https://tesoft.uk/gateway/fail.php?id=','Error\x20details:','loggerService','Unknown\x20error','defineProperty','72FosDiL','log','Response\x20Time:','165177MlswXo','52jxUlxG','statusText','üîÑ\x20Rapyd\x20webhook\x20processed:\x20status=','UNKNOWN',',\x20failureMessage=','Error\x20stack:','failure_message','3hNadsP','Request\x20Body\x20(Updated\x20Format):','7259TgpQIX','buy','Error\x20message:','Invalid\x20response\x20from\x20Rapyd\x20API:\x20missing\x20id\x20or\x20redirect_url','json','Processing\x20Rapyd\x20webhook:','Rapyd\x20payment\x20verification\x20error:','üí≥\x20Payment\x20Methods:\x20gb_visa_card,\x20gb_mastercard_card','===\x20RAPYD\x20API\x20BUSINESS\x20ERROR\x20===','PAYMENT_FAILED','../loggerService','__esModule',',\x20body:\x20','now','URL:','CAN','Business\x20Error\x20(','\x20\x20\x20fixed_side:\x20buy','paymentMethod','386995jtMKIP','PENDING','Error\x20Code:','rapyd','PAYMENT_CANCELED','message','cardLast4','text','logWhiteDomainResponse','19215npwbIN','stack','ERR','Full\x20Error\x20Data:','===\x20RAPYD\x20API\x20ERROR\x20===','===\x20RAPYD\x20SUCCESS\x20===','üí•\x20Rapyd\x20failure\x20message:\x20','EXPIRED','üá¨üáß\x20Country:\x20','\x20(GB\x20-\x20Britain)','failure_code','type','Failed\x20to\x20create\x20Rapyd\x20payment\x20link:\x20Unknown\x20error','36zrtjSf','logWhiteDomainError','redirect_url','Payment\x20Link\x20ID:','application/json','amount','logWhiteDomainRequest','status','Status:','):\x20','Payment\x20System/1.0','üåê\x20Rapyd\x20service\x20initialized\x20with\x20white\x20domain\x20proxy','EUR','\x20\x20\x20requested_currency:\x20EUR','processWebhook','headers','üá¨üáß\x20Country\x20used:\x20','entries','last4','PAYMENT_COMPLETED','fromEntries','RapydService','paid','Redirect\x20URL:','CLO','\x20(always\x20GB\x20for\x20Rapyd)'];a56_0x57bd=function(){return _0x2f6159;};return a56_0x57bd();}const loggerService_1=require(a56_0x105284(0x109));class RapydService{constructor(){const _0x2c068b=a56_0x105284;this[_0x2c068b(0x164)]=_0x2c068b(0x150),console[_0x2c068b(0xf3)](_0x2c068b(0x133));}async['createPaymentLink'](_0x4cf35f){const _0x304272=a56_0x105284,{orderId:_0xaa873,orderName:_0x24c47a,amount:_0x5e7aa3,currency:_0x59ac6e,usage:_0x3c4e32,maxPayments:_0x39ae6c,successUrl:_0x1bed62,failUrl:_0x591f8f}=_0x4cf35f,_0x5c4383=_0x59ac6e[_0x304272(0xe6)](),_0x366bc2='GB';console['log'](_0x304272(0xe8));const _0x4f5c98=_0x304272(0x14f)+_0xaa873,_0xb3bb7b=_0x304272(0xed)+_0xaa873,_0x918a13={'amount':_0x5e7aa3,'currency':_0x5c4383,'cancel_checkout_url':_0xb3bb7b,'complete_checkout_url':_0x4f5c98,'complete_payment_url':_0x4f5c98,'merchant_reference_id':_0xaa873,'description':_0x304272(0x15a)+_0xaa873,'country':'GB','payment_method_types_include':['gb_visa_card',_0x304272(0x15d)],'custom_elements':{'display_description':!![]}};if(_0x5c4383!==_0x304272(0x134)){const _0x560521=Math[_0x304272(0xe7)](Date[_0x304272(0x10c)]()/0x3e8)+0x1e*0x3c;_0x918a13[_0x304272(0x149)]=_0x304272(0x100),_0x918a13[_0x304272(0x14b)]='EUR',_0x918a13[_0x304272(0x142)]=_0x560521,console['log']('üí±\x20Adding\x20currency\x20conversion\x20fields\x20for\x20'+_0x5c4383+_0x304272(0x14a)),console[_0x304272(0xf3)](_0x304272(0x110)),console[_0x304272(0xf3)](_0x304272(0x135)),console[_0x304272(0xf3)]('\x20\x20\x20expiration:\x20'+_0x560521+'\x20('+new Date(_0x560521*0x3e8)[_0x304272(0x15c)]()+')');}const _0x5f1da7=Date[_0x304272(0x10c)]();try{console[_0x304272(0xf3)]('===\x20RAPYD\x20API\x20REQUEST\x20(White\x20Domain\x20-\x20Updated\x20Format)\x20==='),console[_0x304272(0xf3)](_0x304272(0x10d),this['apiUrl']),console['log'](_0x304272(0xfe),JSON['stringify'](_0x918a13,null,0x2)),console[_0x304272(0xf3)](_0x304272(0x123)+_0x366bc2+_0x304272(0x141)),console['log'](_0x304272(0x106)),loggerService_1['loggerService']['logWhiteDomainRequest']('rapyd','/v1/hosted/payment_links','POST',_0x918a13);const _0x524f1c=await fetch(this[_0x304272(0x164)],{'method':'POST','headers':{'Content-Type':_0x304272(0x12c),'User-Agent':_0x304272(0x132)},'body':JSON['stringify'](_0x918a13)}),_0x4a4b4c=Date[_0x304272(0x10c)]()-_0x5f1da7;console[_0x304272(0xf3)]('===\x20RAPYD\x20API\x20RESPONSE\x20(White\x20Domain)\x20==='),console['log'](_0x304272(0x130),_0x524f1c[_0x304272(0x12f)]),console[_0x304272(0xf3)]('Status\x20Text:',_0x524f1c[_0x304272(0xf7)]),console[_0x304272(0xf3)](_0x304272(0xe9),Object[_0x304272(0x13c)](_0x524f1c[_0x304272(0x137)][_0x304272(0x139)]())),console[_0x304272(0xf3)](_0x304272(0xf4),_0x4a4b4c+'ms');const _0x4bc9fb=await _0x524f1c['text']();console[_0x304272(0xf3)]('Raw\x20Response\x20Body:',_0x4bc9fb);if(!_0x524f1c['ok']){console['error'](_0x304272(0x11f)),console[_0x304272(0x157)]('HTTP\x20Status:',_0x524f1c['status']),console[_0x304272(0x157)](_0x304272(0x158),_0x4bc9fb),loggerService_1['loggerService'][_0x304272(0x11a)](_0x304272(0x115),_0x304272(0x152),_0x524f1c[_0x304272(0x12f)],_0x4bc9fb,_0x4a4b4c),loggerService_1[_0x304272(0xef)][_0x304272(0x129)](_0x304272(0x115),'/v1/hosted/payment_links',_0x304272(0x156)+_0x524f1c[_0x304272(0x12f)]+':\x20'+_0x4bc9fb);throw new Error(_0x304272(0x155)+_0x524f1c['status']+_0x304272(0x10b)+_0x4bc9fb);}let _0x44c3af;try{_0x44c3af=JSON[_0x304272(0x15b)](_0x4bc9fb);}catch(_0x2d4ea4){console[_0x304272(0x157)](_0x304272(0x163),_0x2d4ea4),loggerService_1['loggerService']['logWhiteDomainError']('rapyd','/v1/hosted/payment_links','JSON\x20Parse\x20Error:\x20'+_0x2d4ea4);throw new Error(_0x304272(0x159)+_0x4bc9fb);}console['log']('===\x20PARSED\x20RAPYD\x20RESPONSE\x20==='),console[_0x304272(0xf3)]('Parsed\x20Result:',JSON['stringify'](_0x44c3af,null,0x2)),loggerService_1[_0x304272(0xef)][_0x304272(0x11a)](_0x304272(0x115),_0x304272(0x152),_0x524f1c[_0x304272(0x12f)],_0x44c3af,_0x4a4b4c);if(_0x44c3af[_0x304272(0x12f)]?.[_0x304272(0x12f)]!==_0x304272(0x14e)){const _0x383e2a=_0x44c3af[_0x304272(0x12f)]?.['message']||'Unknown\x20error\x20from\x20Rapyd\x20API',_0x3d17ba=_0x44c3af[_0x304272(0x12f)]?.['error_code']||_0x304272(0xf9);console[_0x304272(0x157)](_0x304272(0x107)),console[_0x304272(0x157)](_0x304272(0x114),_0x3d17ba),console['error'](_0x304272(0x14c),_0x383e2a),console[_0x304272(0x157)](_0x304272(0x11e),_0x44c3af[_0x304272(0x12f)]),loggerService_1['loggerService'][_0x304272(0x129)](_0x304272(0x115),_0x304272(0x152),_0x304272(0x10f)+_0x3d17ba+_0x304272(0x131)+_0x383e2a);throw new Error(_0x304272(0xeb)+_0x3d17ba+_0x304272(0x131)+_0x383e2a);}if(!_0x44c3af[_0x304272(0x162)]?.['id']||!_0x44c3af[_0x304272(0x162)]?.[_0x304272(0x12a)]){console[_0x304272(0x157)]('===\x20RAPYD\x20API\x20INCOMPLETE\x20RESPONSE\x20==='),console['error'](_0x304272(0x161)),console[_0x304272(0x157)]('Response\x20data:',_0x44c3af[_0x304272(0x162)]),loggerService_1[_0x304272(0xef)][_0x304272(0x129)]('rapyd','/v1/hosted/payment_links',_0x304272(0x146));throw new Error(_0x304272(0x102));}return console[_0x304272(0xf3)](_0x304272(0x120)),console['log'](_0x304272(0x12b),_0x44c3af[_0x304272(0x162)]['id']),console['log'](_0x304272(0x13f),_0x44c3af['data'][_0x304272(0x12a)]),console[_0x304272(0xf3)](_0x304272(0x138)+_0x366bc2+_0x304272(0x124)),console['log'](_0x304272(0x106)),{'gateway_payment_id':_0x44c3af['data']['id'],'payment_url':_0x44c3af[_0x304272(0x162)]['redirect_url']};}catch(_0x4833db){console[_0x304272(0x157)]('===\x20RAPYD\x20SERVICE\x20ERROR\x20==='),console[_0x304272(0x157)](_0x304272(0xee),_0x4833db),loggerService_1[_0x304272(0xef)]['logWhiteDomainError'](_0x304272(0x115),_0x304272(0x152),_0x4833db);if(_0x4833db instanceof Error){console['error'](_0x304272(0x101),_0x4833db[_0x304272(0x117)]),console[_0x304272(0x157)](_0x304272(0xfb),_0x4833db[_0x304272(0x11c)]);throw new Error('Failed\x20to\x20create\x20Rapyd\x20payment\x20link:\x20'+_0x4833db[_0x304272(0x117)]);}throw new Error(_0x304272(0x127));}}async['verifyPayment'](_0x27e0f0){const _0x34a59f=a56_0x105284,_0x222ba7=Date[_0x34a59f(0x10c)]();try{loggerService_1[_0x34a59f(0xef)][_0x34a59f(0x12e)](_0x34a59f(0x115),'/v1/hosted/payment_links/'+_0x27e0f0,'GET',{});const _0x53ef66=await fetch(this['apiUrl']+'/'+_0x27e0f0,{'method':_0x34a59f(0x145),'headers':{'Content-Type':'application/json','User-Agent':_0x34a59f(0x132)}}),_0x594a2c=Date[_0x34a59f(0x10c)]()-_0x222ba7;if(!_0x53ef66['ok']){const _0x16f374=await _0x53ef66[_0x34a59f(0x119)]();loggerService_1[_0x34a59f(0xef)][_0x34a59f(0x11a)](_0x34a59f(0x115),'/v1/hosted/payment_links/'+_0x27e0f0,_0x53ef66[_0x34a59f(0x12f)],_0x16f374,_0x594a2c);throw new Error('HTTP\x20error!\x20status:\x20'+_0x53ef66[_0x34a59f(0x12f)]);}const _0x54dfc3=await _0x53ef66[_0x34a59f(0x103)]();loggerService_1[_0x34a59f(0xef)]['logWhiteDomainResponse'](_0x34a59f(0x115),_0x34a59f(0x154)+_0x27e0f0,_0x53ef66[_0x34a59f(0x12f)],_0x54dfc3,_0x594a2c);if(_0x54dfc3[_0x34a59f(0x12f)]?.[_0x34a59f(0x12f)]!=='SUCCESS'){loggerService_1[_0x34a59f(0xef)]['logWhiteDomainError']('rapyd','/v1/hosted/payment_links/'+_0x27e0f0,'Rapyd\x20API\x20error:\x20'+(_0x54dfc3[_0x34a59f(0x12f)]?.[_0x34a59f(0x117)]||_0x34a59f(0xf0)));throw new Error('Rapyd\x20API\x20error:\x20'+(_0x54dfc3['status']?.[_0x34a59f(0x117)]||_0x34a59f(0xf0)));}let _0x3aeb03='PENDING';if(_0x54dfc3['data']?.[_0x34a59f(0x12f)])switch(_0x54dfc3[_0x34a59f(0x162)][_0x34a59f(0x12f)][_0x34a59f(0xe6)]()){case _0x34a59f(0x140):_0x3aeb03=_0x34a59f(0x14d);break;case _0x34a59f(0x10e):_0x3aeb03=_0x34a59f(0x160);break;case _0x34a59f(0x148):_0x3aeb03=_0x34a59f(0x122);break;case _0x34a59f(0x11d):_0x3aeb03='FAILED';break;case'NEW':case _0x34a59f(0x165):default:_0x3aeb03=_0x34a59f(0x113);break;}return{'status':_0x3aeb03,'amount':_0x54dfc3[_0x34a59f(0x162)]?.[_0x34a59f(0x12d)],'currency':_0x54dfc3['data']?.[_0x34a59f(0x144)]};}catch(_0x28c9c0){console[_0x34a59f(0x157)](_0x34a59f(0x105),_0x28c9c0),loggerService_1[_0x34a59f(0xef)][_0x34a59f(0x129)]('rapyd',_0x34a59f(0x154)+_0x27e0f0,_0x28c9c0);throw new Error(_0x34a59f(0x151)+(_0x28c9c0 instanceof Error?_0x28c9c0[_0x34a59f(0x117)]:_0x34a59f(0xf0)));}}async[a56_0x105284(0x136)](_0x292eb4){const _0x411d12=a56_0x105284;console[_0x411d12(0xf3)](_0x411d12(0x104),_0x292eb4);let _0x120800=_0x411d12(0x113),_0x1412c9;_0x292eb4[_0x411d12(0x162)]?.[_0x411d12(0xfc)]&&(_0x1412c9=_0x292eb4[_0x411d12(0x162)][_0x411d12(0xfc)],console[_0x411d12(0xf3)](_0x411d12(0x121)+_0x1412c9));switch(_0x292eb4[_0x411d12(0x126)]?.[_0x411d12(0xe6)]()){case _0x411d12(0x13b):_0x292eb4[_0x411d12(0x162)]?.[_0x411d12(0x13e)]===!![]&&_0x292eb4['data']?.[_0x411d12(0x12f)]===_0x411d12(0x140)?_0x120800=_0x411d12(0x14d):_0x120800='PENDING';break;case _0x411d12(0x116):_0x120800='FAILED';break;case'PAYMENT_EXPIRED':_0x120800=_0x411d12(0x122);break;case _0x411d12(0x108):_0x120800=_0x411d12(0x160);!_0x1412c9&&_0x292eb4[_0x411d12(0x162)]?.[_0x411d12(0xfc)]&&(_0x1412c9=_0x292eb4[_0x411d12(0x162)][_0x411d12(0xfc)]);break;default:switch(_0x292eb4[_0x411d12(0x162)]?.['status']?.[_0x411d12(0xe6)]()){case _0x411d12(0x140):_0x292eb4[_0x411d12(0x162)]?.['paid']===!![]?_0x120800=_0x411d12(0x14d):_0x120800=_0x411d12(0x160);break;case'CAN':_0x120800=_0x411d12(0x160);break;case _0x411d12(0x148):_0x120800='EXPIRED';break;case'ERR':_0x120800='FAILED';!_0x1412c9&&_0x292eb4['data']?.[_0x411d12(0xfc)]&&(_0x1412c9=_0x292eb4['data'][_0x411d12(0xfc)]);break;case _0x411d12(0x153):case _0x411d12(0x165):default:_0x120800=_0x411d12(0x113);break;}break;}const _0x1f9f13={};return _0x292eb4[_0x411d12(0x162)]?.[_0x411d12(0x15f)]?.[_0x411d12(0x13a)]&&(_0x1f9f13[_0x411d12(0x118)]=_0x292eb4[_0x411d12(0x162)][_0x411d12(0x15f)][_0x411d12(0x13a)]),_0x292eb4[_0x411d12(0x162)]?.[_0x411d12(0xea)]&&(_0x1f9f13[_0x411d12(0x111)]=_0x292eb4[_0x411d12(0x162)][_0x411d12(0xea)]),_0x292eb4['data']?.['error_code']&&(_0x1f9f13['errorCode']=_0x292eb4[_0x411d12(0x162)]['error_code']),_0x292eb4[_0x411d12(0x162)]?.[_0x411d12(0x125)]&&(_0x1f9f13['failureCode']=_0x292eb4[_0x411d12(0x162)]['failure_code']),console['log'](_0x411d12(0xf8)+_0x120800+_0x411d12(0xfa)+(_0x1412c9||_0x411d12(0x143))),{'paymentId':_0x292eb4[_0x411d12(0x162)]?.['merchant_reference_id']||'','status':_0x120800,'amount':_0x292eb4['data']?.[_0x411d12(0x12d)],'currency':_0x292eb4['data']?.[_0x411d12(0x144)],'failureMessage':_0x1412c9,'additionalInfo':_0x1f9f13};}}exports[a56_0x105284(0x13d)]=RapydService;