'use strict';const a46_0x5a3819=a46_0x5db8;(function(_0x27d725,_0x404e00){const _0x30fd38=a46_0x5db8,_0xabb602=_0x27d725();while(!![]){try{const _0x58fc20=parseInt(_0x30fd38(0x21f))/0x1+-parseInt(_0x30fd38(0x1c2))/0x2+-parseInt(_0x30fd38(0x1d6))/0x3+parseInt(_0x30fd38(0x1b7))/0x4+parseInt(_0x30fd38(0x1bc))/0x5*(-parseInt(_0x30fd38(0x1ec))/0x6)+parseInt(_0x30fd38(0x20b))/0x7+-parseInt(_0x30fd38(0x1c1))/0x8*(-parseInt(_0x30fd38(0x1b1))/0x9);if(_0x58fc20===_0x404e00)break;else _0xabb602['push'](_0xabb602['shift']());}catch(_0x499403){_0xabb602['push'](_0xabb602['shift']());}}}(a46_0x11f9,0x4a17d));function a46_0x11f9(){const _0x1cdb0c=['processWebhook','gb_mastercard_card','ERR','649537TpWDsz','Unknown\x20error\x20from\x20Rapyd\x20API','===\x20RAPYD\x20API\x20RESPONSE\x20(White\x20Domain)\x20===','FAILED','data','application/json','currency','text','===\x20RAPYD\x20API\x20BUSINESS\x20ERROR\x20===','fromEntries','Missing\x20id\x20or\x20redirect_url\x20in\x20response','Status:','apiUrl','__esModule','Rapyd\x20API\x20error\x20(','NEW','===\x20RAPYD\x20SERVICE\x20ERROR\x20===','message','entries','\x20(GB\x20-\x20Britain)','280128PXKlvY','paid','Response\x20Body:','failureCode','Error\x20Code:','üåê\x20Rapyd\x20service\x20initialized\x20with\x20white\x20domain\x20proxy','Parsed\x20Result:','stringify','status','407601rPRerA','merchant_reference_id','failure_message','Request\x20Body\x20(Updated\x20Format):','===\x20RAPYD\x20API\x20REQUEST\x20(White\x20Domain\x20-\x20Updated\x20Format)\x20===','Raw\x20Response\x20Body:','1537396luAMRD','ACT','TesSoft\x20Payment\x20System/1.0','HTTP\x20','):\x20','15XlkZvp','Error\x20message:','/v1/hosted/payment_links/','Error\x20details:','Payment\x20Link\x20ID:','32DbFsnT','986852cTfoLf','now','HTTP\x20error!\x20status:\x20','PENDING','EXP','createPaymentLink','failure_code','toUpperCase','gb_visa_card','PAID','stack','CAN','CLO','EXPIRED','Response\x20Time:','PAYMENT_FAILED','===\x20RAPYD\x20SUCCESS\x20===','Full\x20Error\x20Data:','json','none','344277wFXxJv','defineProperty','redirect_url','loggerService','UNKNOWN','logWhiteDomainError','last4','/v1/hosted/payment_links','===\x20RAPYD\x20API\x20ERROR\x20===','Unknown\x20error','Processing\x20Rapyd\x20webhook:','statusText','ORDER:\x20','log','SUCCESS','payment_method_data','POST','Error\x20stack:','Failed\x20to\x20create\x20Rapyd\x20payment\x20link:\x20Unknown\x20error','amount','logWhiteDomainResponse','GET','53508XtKIBK','Rapyd\x20API\x20error:\x20','===\x20RAPYD\x20API\x20INCOMPLETE\x20RESPONSE\x20===','Failed\x20to\x20create\x20Rapyd\x20payment\x20link:\x20','RapydService','===\x20PARSED\x20RAPYD\x20RESPONSE\x20===','PAYMENT_CANCELED','üá¨üáß\x20Country:\x20','cardLast4','Response\x20data:','Headers:','payment_method_type',',\x20failureMessage=','headers','JSON\x20Parse\x20Error:\x20','paymentMethod','Invalid\x20response\x20from\x20Rapyd\x20API:\x20missing\x20id\x20or\x20redirect_url','üí≥\x20Payment\x20Methods:\x20gb_visa_card,\x20gb_mastercard_card','rapyd','URL:','error_code','PAYMENT_COMPLETED','type','https://tesoft.uk/gateway/fail.php?id=','../loggerService','Rapyd\x20payment\x20verification\x20error:','logWhiteDomainRequest','error'];a46_0x11f9=function(){return _0x1cdb0c;};return a46_0x11f9();}Object[a46_0x5a3819(0x1d7)](exports,a46_0x5a3819(0x218),{'value':!![]}),exports['RapydService']=void 0x0;const loggerService_1=require(a46_0x5a3819(0x204));function a46_0x5db8(_0x3fa132,_0x1002ed){const _0x11f9fe=a46_0x11f9();return a46_0x5db8=function(_0x5db856,_0x3624a5){_0x5db856=_0x5db856-0x1ae;let _0x3625e6=_0x11f9fe[_0x5db856];return _0x3625e6;},a46_0x5db8(_0x3fa132,_0x1002ed);}class RapydService{constructor(){const _0x38bc54=a46_0x5a3819;this[_0x38bc54(0x217)]='https://tesoft.uk/gateway/rapyd/',console['log'](_0x38bc54(0x224));}async[a46_0x5a3819(0x1c7)](_0x5c47d4){const _0x15de70=a46_0x5a3819,{orderId:_0x2d646f,orderName:_0x3378c6,amount:_0x168cb6,currency:_0x56be76,usage:_0x5dce84,maxPayments:_0x5b4dd2,successUrl:_0x558e8a,failUrl:_0x30cfca}=_0x5c47d4,_0xe3dc65=_0x56be76[_0x15de70(0x1c9)](),_0x1bef5a='GB';console[_0x15de70(0x1e3)]('üá¨üáß\x20Using\x20GB\x20(Britain)\x20as\x20country\x20for\x20Rapyd\x20payment\x20link');const _0x4566c3='https://tesoft.uk/gateway/success.php?id='+_0x2d646f,_0x26841a=_0x15de70(0x203)+_0x2d646f,_0x5a9f44={'amount':_0x168cb6,'currency':_0xe3dc65,'cancel_checkout_url':_0x26841a,'complete_checkout_url':_0x4566c3,'complete_payment_url':_0x4566c3,'merchant_reference_id':_0x2d646f,'description':_0x15de70(0x1e2)+_0x2d646f,'country':'GB','payment_method_types_include':[_0x15de70(0x1ca),_0x15de70(0x209)],'custom_elements':{'display_description':!![]}},_0x5ad80d=Date[_0x15de70(0x1c3)]();try{console[_0x15de70(0x1e3)](_0x15de70(0x1b5)),console[_0x15de70(0x1e3)](_0x15de70(0x1ff),this['apiUrl']),console[_0x15de70(0x1e3)](_0x15de70(0x1b4),JSON[_0x15de70(0x1af)](_0x5a9f44,null,0x2)),console[_0x15de70(0x1e3)](_0x15de70(0x1f3)+_0x1bef5a+'\x20(always\x20GB\x20for\x20Rapyd)'),console[_0x15de70(0x1e3)]('üí≥\x20Payment\x20Methods:\x20gb_visa_card,\x20gb_mastercard_card'),loggerService_1[_0x15de70(0x1d9)][_0x15de70(0x206)](_0x15de70(0x1fe),'/v1/hosted/payment_links',_0x15de70(0x1e6),_0x5a9f44);const _0x51e8a9=await fetch(this[_0x15de70(0x217)],{'method':_0x15de70(0x1e6),'headers':{'Content-Type':_0x15de70(0x210),'User-Agent':_0x15de70(0x1b9)},'body':JSON[_0x15de70(0x1af)](_0x5a9f44)}),_0xf73933=Date[_0x15de70(0x1c3)]()-_0x5ad80d;console[_0x15de70(0x1e3)](_0x15de70(0x20d)),console[_0x15de70(0x1e3)](_0x15de70(0x216),_0x51e8a9[_0x15de70(0x1b0)]),console[_0x15de70(0x1e3)]('Status\x20Text:',_0x51e8a9[_0x15de70(0x1e1)]),console['log'](_0x15de70(0x1f6),Object[_0x15de70(0x214)](_0x51e8a9[_0x15de70(0x1f9)][_0x15de70(0x21d)]())),console[_0x15de70(0x1e3)](_0x15de70(0x1d0),_0xf73933+'ms');const _0x7abde9=await _0x51e8a9[_0x15de70(0x212)]();console['log'](_0x15de70(0x1b6),_0x7abde9);if(!_0x51e8a9['ok']){console[_0x15de70(0x207)](_0x15de70(0x1de)),console[_0x15de70(0x207)]('HTTP\x20Status:',_0x51e8a9[_0x15de70(0x1b0)]),console['error'](_0x15de70(0x221),_0x7abde9),loggerService_1[_0x15de70(0x1d9)][_0x15de70(0x1ea)]('rapyd',_0x15de70(0x1dd),_0x51e8a9[_0x15de70(0x1b0)],_0x7abde9,_0xf73933),loggerService_1['loggerService'][_0x15de70(0x1db)](_0x15de70(0x1fe),'/v1/hosted/payment_links',_0x15de70(0x1ba)+_0x51e8a9[_0x15de70(0x1b0)]+':\x20'+_0x7abde9);throw new Error(_0x15de70(0x1c4)+_0x51e8a9['status']+',\x20body:\x20'+_0x7abde9);}let _0x45029a;try{_0x45029a=JSON['parse'](_0x7abde9);}catch(_0x43c2c9){console['error']('Failed\x20to\x20parse\x20JSON\x20response:',_0x43c2c9),loggerService_1[_0x15de70(0x1d9)][_0x15de70(0x1db)](_0x15de70(0x1fe),_0x15de70(0x1dd),_0x15de70(0x1fa)+_0x43c2c9);throw new Error('Invalid\x20JSON\x20response\x20from\x20Rapyd\x20API:\x20'+_0x7abde9);}console[_0x15de70(0x1e3)](_0x15de70(0x1f1)),console[_0x15de70(0x1e3)](_0x15de70(0x1ae),JSON[_0x15de70(0x1af)](_0x45029a,null,0x2)),loggerService_1[_0x15de70(0x1d9)][_0x15de70(0x1ea)](_0x15de70(0x1fe),_0x15de70(0x1dd),_0x51e8a9[_0x15de70(0x1b0)],_0x45029a,_0xf73933);if(_0x45029a['status']?.[_0x15de70(0x1b0)]!=='SUCCESS'){const _0x5b3f93=_0x45029a[_0x15de70(0x1b0)]?.[_0x15de70(0x21c)]||_0x15de70(0x20c),_0x5cb19a=_0x45029a[_0x15de70(0x1b0)]?.[_0x15de70(0x200)]||_0x15de70(0x1da);console[_0x15de70(0x207)](_0x15de70(0x213)),console['error'](_0x15de70(0x223),_0x5cb19a),console[_0x15de70(0x207)]('Error\x20Message:',_0x5b3f93),console[_0x15de70(0x207)](_0x15de70(0x1d3),_0x45029a[_0x15de70(0x1b0)]),loggerService_1['loggerService'][_0x15de70(0x1db)](_0x15de70(0x1fe),_0x15de70(0x1dd),'Business\x20Error\x20('+_0x5cb19a+_0x15de70(0x1bb)+_0x5b3f93);throw new Error(_0x15de70(0x219)+_0x5cb19a+_0x15de70(0x1bb)+_0x5b3f93);}if(!_0x45029a['data']?.['id']||!_0x45029a['data']?.[_0x15de70(0x1d8)]){console[_0x15de70(0x207)](_0x15de70(0x1ee)),console[_0x15de70(0x207)](_0x15de70(0x215)),console[_0x15de70(0x207)](_0x15de70(0x1f5),_0x45029a[_0x15de70(0x20f)]),loggerService_1['loggerService']['logWhiteDomainError'](_0x15de70(0x1fe),_0x15de70(0x1dd),'Incomplete\x20response:\x20missing\x20id\x20or\x20redirect_url');throw new Error(_0x15de70(0x1fc));}return console[_0x15de70(0x1e3)](_0x15de70(0x1d2)),console[_0x15de70(0x1e3)](_0x15de70(0x1c0),_0x45029a[_0x15de70(0x20f)]['id']),console['log']('Redirect\x20URL:',_0x45029a[_0x15de70(0x20f)][_0x15de70(0x1d8)]),console[_0x15de70(0x1e3)]('üá¨üáß\x20Country\x20used:\x20'+_0x1bef5a+_0x15de70(0x21e)),console['log'](_0x15de70(0x1fd)),{'gateway_payment_id':_0x45029a['data']['id'],'payment_url':_0x45029a[_0x15de70(0x20f)][_0x15de70(0x1d8)]};}catch(_0xe68b9e){console[_0x15de70(0x207)](_0x15de70(0x21b)),console[_0x15de70(0x207)](_0x15de70(0x1bf),_0xe68b9e),loggerService_1[_0x15de70(0x1d9)][_0x15de70(0x1db)](_0x15de70(0x1fe),_0x15de70(0x1dd),_0xe68b9e);if(_0xe68b9e instanceof Error){console[_0x15de70(0x207)](_0x15de70(0x1bd),_0xe68b9e[_0x15de70(0x21c)]),console[_0x15de70(0x207)](_0x15de70(0x1e7),_0xe68b9e[_0x15de70(0x1cc)]);throw new Error(_0x15de70(0x1ef)+_0xe68b9e['message']);}throw new Error(_0x15de70(0x1e8));}}async['verifyPayment'](_0x4efff8){const _0x549ad5=a46_0x5a3819,_0x2b560d=Date[_0x549ad5(0x1c3)]();try{loggerService_1[_0x549ad5(0x1d9)][_0x549ad5(0x206)](_0x549ad5(0x1fe),'/v1/hosted/payment_links/'+_0x4efff8,_0x549ad5(0x1eb),{});const _0x3d83a4=await fetch(this[_0x549ad5(0x217)]+'/'+_0x4efff8,{'method':_0x549ad5(0x1eb),'headers':{'Content-Type':_0x549ad5(0x210),'User-Agent':_0x549ad5(0x1b9)}}),_0x170fe7=Date[_0x549ad5(0x1c3)]()-_0x2b560d;if(!_0x3d83a4['ok']){const _0x584266=await _0x3d83a4[_0x549ad5(0x212)]();loggerService_1[_0x549ad5(0x1d9)][_0x549ad5(0x1ea)](_0x549ad5(0x1fe),_0x549ad5(0x1be)+_0x4efff8,_0x3d83a4['status'],_0x584266,_0x170fe7);throw new Error(_0x549ad5(0x1c4)+_0x3d83a4[_0x549ad5(0x1b0)]);}const _0x3d125c=await _0x3d83a4[_0x549ad5(0x1d4)]();loggerService_1['loggerService'][_0x549ad5(0x1ea)]('rapyd',_0x549ad5(0x1be)+_0x4efff8,_0x3d83a4['status'],_0x3d125c,_0x170fe7);if(_0x3d125c[_0x549ad5(0x1b0)]?.[_0x549ad5(0x1b0)]!==_0x549ad5(0x1e4)){loggerService_1[_0x549ad5(0x1d9)][_0x549ad5(0x1db)](_0x549ad5(0x1fe),'/v1/hosted/payment_links/'+_0x4efff8,_0x549ad5(0x1ed)+(_0x3d125c[_0x549ad5(0x1b0)]?.[_0x549ad5(0x21c)]||_0x549ad5(0x1df)));throw new Error(_0x549ad5(0x1ed)+(_0x3d125c[_0x549ad5(0x1b0)]?.[_0x549ad5(0x21c)]||_0x549ad5(0x1df)));}let _0x4a1231='PENDING';if(_0x3d125c[_0x549ad5(0x20f)]?.[_0x549ad5(0x1b0)])switch(_0x3d125c['data'][_0x549ad5(0x1b0)]['toUpperCase']()){case'CLO':_0x4a1231=_0x549ad5(0x1cb);break;case _0x549ad5(0x1cd):_0x4a1231='FAILED';break;case _0x549ad5(0x1c6):_0x4a1231=_0x549ad5(0x1cf);break;case _0x549ad5(0x20a):_0x4a1231=_0x549ad5(0x20e);break;case _0x549ad5(0x21a):case'ACT':default:_0x4a1231=_0x549ad5(0x1c5);break;}return{'status':_0x4a1231,'amount':_0x3d125c[_0x549ad5(0x20f)]?.[_0x549ad5(0x1e9)],'currency':_0x3d125c[_0x549ad5(0x20f)]?.['currency']};}catch(_0x47a47b){console[_0x549ad5(0x207)](_0x549ad5(0x205),_0x47a47b),loggerService_1[_0x549ad5(0x1d9)][_0x549ad5(0x1db)](_0x549ad5(0x1fe),_0x549ad5(0x1be)+_0x4efff8,_0x47a47b);throw new Error('Failed\x20to\x20verify\x20Rapyd\x20payment:\x20'+(_0x47a47b instanceof Error?_0x47a47b[_0x549ad5(0x21c)]:'Unknown\x20error'));}}async[a46_0x5a3819(0x208)](_0x31b6e7){const _0xc33be9=a46_0x5a3819;console[_0xc33be9(0x1e3)](_0xc33be9(0x1e0),_0x31b6e7);let _0x449acb='PENDING',_0x46d181;_0x31b6e7[_0xc33be9(0x20f)]?.[_0xc33be9(0x1b3)]&&(_0x46d181=_0x31b6e7[_0xc33be9(0x20f)][_0xc33be9(0x1b3)],console[_0xc33be9(0x1e3)]('üí•\x20Rapyd\x20failure\x20message:\x20'+_0x46d181));switch(_0x31b6e7[_0xc33be9(0x202)]?.['toUpperCase']()){case _0xc33be9(0x201):_0x31b6e7[_0xc33be9(0x20f)]?.['paid']===!![]&&_0x31b6e7[_0xc33be9(0x20f)]?.[_0xc33be9(0x1b0)]===_0xc33be9(0x1ce)?_0x449acb=_0xc33be9(0x1cb):_0x449acb='PENDING';break;case _0xc33be9(0x1f2):_0x449acb='FAILED';break;case'PAYMENT_EXPIRED':_0x449acb=_0xc33be9(0x1cf);break;case _0xc33be9(0x1d1):_0x449acb='FAILED';!_0x46d181&&_0x31b6e7[_0xc33be9(0x20f)]?.['failure_message']&&(_0x46d181=_0x31b6e7[_0xc33be9(0x20f)][_0xc33be9(0x1b3)]);break;default:switch(_0x31b6e7[_0xc33be9(0x20f)]?.[_0xc33be9(0x1b0)]?.['toUpperCase']()){case _0xc33be9(0x1ce):_0x31b6e7[_0xc33be9(0x20f)]?.[_0xc33be9(0x220)]===!![]?_0x449acb='PAID':_0x449acb=_0xc33be9(0x20e);break;case _0xc33be9(0x1cd):_0x449acb=_0xc33be9(0x20e);break;case _0xc33be9(0x1c6):_0x449acb=_0xc33be9(0x1cf);break;case _0xc33be9(0x20a):_0x449acb='FAILED';!_0x46d181&&_0x31b6e7[_0xc33be9(0x20f)]?.[_0xc33be9(0x1b3)]&&(_0x46d181=_0x31b6e7[_0xc33be9(0x20f)][_0xc33be9(0x1b3)]);break;case _0xc33be9(0x21a):case _0xc33be9(0x1b8):default:_0x449acb=_0xc33be9(0x1c5);break;}break;}const _0x531564={};return _0x31b6e7[_0xc33be9(0x20f)]?.[_0xc33be9(0x1e5)]?.[_0xc33be9(0x1dc)]&&(_0x531564[_0xc33be9(0x1f4)]=_0x31b6e7[_0xc33be9(0x20f)][_0xc33be9(0x1e5)]['last4']),_0x31b6e7[_0xc33be9(0x20f)]?.[_0xc33be9(0x1f7)]&&(_0x531564[_0xc33be9(0x1fb)]=_0x31b6e7['data'][_0xc33be9(0x1f7)]),_0x31b6e7[_0xc33be9(0x20f)]?.[_0xc33be9(0x200)]&&(_0x531564['errorCode']=_0x31b6e7[_0xc33be9(0x20f)][_0xc33be9(0x200)]),_0x31b6e7[_0xc33be9(0x20f)]?.[_0xc33be9(0x1c8)]&&(_0x531564[_0xc33be9(0x222)]=_0x31b6e7[_0xc33be9(0x20f)][_0xc33be9(0x1c8)]),console['log']('üîÑ\x20Rapyd\x20webhook\x20processed:\x20status='+_0x449acb+_0xc33be9(0x1f8)+(_0x46d181||_0xc33be9(0x1d5))),{'paymentId':_0x31b6e7['data']?.[_0xc33be9(0x1b2)]||'','status':_0x449acb,'amount':_0x31b6e7[_0xc33be9(0x20f)]?.[_0xc33be9(0x1e9)],'currency':_0x31b6e7[_0xc33be9(0x20f)]?.[_0xc33be9(0x211)],'failureMessage':_0x46d181,'additionalInfo':_0x531564};}}exports[a46_0x5a3819(0x1f0)]=RapydService;