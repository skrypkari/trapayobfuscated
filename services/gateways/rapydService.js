'use strict';const a44_0x1e9f2e=a44_0x873e;(function(_0x3559d7,_0x1eec65){const _0x4526a9=a44_0x873e,_0x55513f=_0x3559d7();while(!![]){try{const _0x5e9380=-parseInt(_0x4526a9(0xbb))/0x1*(parseInt(_0x4526a9(0xea))/0x2)+parseInt(_0x4526a9(0xff))/0x3+-parseInt(_0x4526a9(0xa0))/0x4*(parseInt(_0x4526a9(0xc4))/0x5)+parseInt(_0x4526a9(0x9a))/0x6+parseInt(_0x4526a9(0xcd))/0x7+parseInt(_0x4526a9(0x9f))/0x8*(parseInt(_0x4526a9(0xb2))/0x9)+parseInt(_0x4526a9(0xca))/0xa*(parseInt(_0x4526a9(0xae))/0xb);if(_0x5e9380===_0x1eec65)break;else _0x55513f['push'](_0x55513f['shift']());}catch(_0x3781c5){_0x55513f['push'](_0x55513f['shift']());}}}(a44_0x3d23,0x55672));function a44_0x3d23(){const _0x3a2c08=['Full\x20Error\x20Data:','error_code','üåê\x20Rapyd\x20service\x20initialized\x20with\x20white\x20domain\x20proxy','redirect_url','failure_code','ERR','===\x20RAPYD\x20API\x20REQUEST\x20(White\x20Domain\x20-\x20Updated\x20Format)\x20===','toUpperCase','Failed\x20to\x20verify\x20Rapyd\x20payment:\x20','JSON\x20Parse\x20Error:\x20','/v1/hosted/payment_links/','gb_visa_card','1490097gcvYdp','logWhiteDomainResponse','SUCCESS','Unknown\x20error\x20from\x20Rapyd\x20API','===\x20RAPYD\x20API\x20INCOMPLETE\x20RESPONSE\x20===','CAN','TesSoft\x20Payment\x20System/1.0','type','currency','üá¨üáß\x20Country\x20used:\x20','Rapyd\x20payment\x20verification\x20error:','Headers:','===\x20RAPYD\x20API\x20RESPONSE\x20(White\x20Domain)\x20===','üá¨üáß\x20Country:\x20','stringify','processWebhook','Error\x20Code:','statusText','Business\x20Error\x20(','28170TZJIkP','amount','createPaymentLink','===\x20RAPYD\x20SERVICE\x20ERROR\x20===','Response\x20data:','16xJvvjk','300XbCfNg','Error\x20Message:','Unknown\x20error','https://tesoft.uk/gateway/rapyd/','Error\x20details:','===\x20PARSED\x20RAPYD\x20RESPONSE\x20===','HTTP\x20Status:','rapyd','EXPIRED','Failed\x20to\x20create\x20Rapyd\x20payment\x20link:\x20','):\x20','\x20(GB\x20-\x20Britain)','text','Status\x20Text:','5050837vYeKhr','EXP','PENDING','errorCode','2565054lBKMty','Rapyd\x20API\x20error:\x20','data','PAYMENT_CANCELED','ORDER:\x20','Rapyd\x20API\x20error\x20(','UNKNOWN','gb_mastercard_card','../loggerService','34159nvQWXY','üá¨üáß\x20Using\x20GB\x20(Britain)\x20as\x20country\x20for\x20Rapyd\x20payment\x20link','failure_message','POST','Processing\x20Rapyd\x20webhook:','payment_method_type','üí≥\x20Payment\x20Methods:\x20gb_visa_card,\x20gb_mastercard_card','Missing\x20id\x20or\x20redirect_url\x20in\x20response','HTTP\x20error!\x20status:\x20','39815VDEndU','/v1/hosted/payment_links','loggerService','logWhiteDomainError','FAILED','Raw\x20Response\x20Body:','10KYoWAW','message','failureCode','697494BQXlIC','Redirect\x20URL:','defineProperty','status','paymentMethod','RapydService','===\x20RAPYD\x20API\x20ERROR\x20===','ACT','apiUrl','now','parse','===\x20RAPYD\x20API\x20BUSINESS\x20ERROR\x20===','last4','===\x20RAPYD\x20SUCCESS\x20===','PAYMENT_COMPLETED','Incomplete\x20response:\x20missing\x20id\x20or\x20redirect_url','Failed\x20to\x20create\x20Rapyd\x20payment\x20link:\x20Unknown\x20error','Parsed\x20Result:','verifyPayment','PAID','logWhiteDomainRequest','NEW','none','Response\x20Time:','error','Failed\x20to\x20parse\x20JSON\x20response:','GET','cardLast4','paid','40NtnCuV','PAYMENT_EXPIRED','Invalid\x20JSON\x20response\x20from\x20Rapyd\x20API:\x20','CLO','PAYMENT_FAILED','log','HTTP\x20','üí•\x20Rapyd\x20failure\x20message:\x20','üîÑ\x20Rapyd\x20webhook\x20processed:\x20status='];a44_0x3d23=function(){return _0x3a2c08;};return a44_0x3d23();}Object[a44_0x1e9f2e(0xcf)](exports,'__esModule',{'value':!![]}),exports[a44_0x1e9f2e(0xd2)]=void 0x0;const loggerService_1=require(a44_0x1e9f2e(0xba));function a44_0x873e(_0x1d86d4,_0x32b963){const _0x3d23d1=a44_0x3d23();return a44_0x873e=function(_0x873e82,_0xae0e8a){_0x873e82=_0x873e82-0x8e;let _0x30d55b=_0x3d23d1[_0x873e82];return _0x30d55b;},a44_0x873e(_0x1d86d4,_0x32b963);}class RapydService{constructor(){const _0x4947ae=a44_0x1e9f2e;this[_0x4947ae(0xd5)]=_0x4947ae(0xa3),console[_0x4947ae(0xef)](_0x4947ae(0xf5));}async[a44_0x1e9f2e(0x9c)](_0x1836e4){const _0x4edd15=a44_0x1e9f2e,{orderId:_0x447e00,orderName:_0x3b8531,amount:_0x1e10a7,currency:_0x45036a,usage:_0x3a5ab2,maxPayments:_0x3ab396,successUrl:_0x434f05,failUrl:_0x49b71f}=_0x1836e4,_0x5b2e14=_0x45036a[_0x4edd15(0xfa)](),_0x324dce='GB';console[_0x4edd15(0xef)](_0x4edd15(0xbc));const _0x1b9a30='https://tesoft.uk/gateway/success.php?id='+_0x447e00,_0x83b0a9='https://tesoft.uk/gateway/fail.php?id='+_0x447e00,_0x3bdb0c={'amount':_0x1e10a7,'currency':_0x5b2e14,'cancel_checkout_url':_0x83b0a9,'complete_checkout_url':_0x1b9a30,'complete_payment_url':_0x1b9a30,'merchant_reference_id':_0x447e00,'description':_0x4edd15(0xb6)+_0x447e00,'country':'GB','payment_method_types_include':[_0x4edd15(0xfe),_0x4edd15(0xb9)],'custom_elements':{'display_description':!![]}},_0x4a0f4f=Date[_0x4edd15(0xd6)]();try{console[_0x4edd15(0xef)](_0x4edd15(0xf9)),console['log']('URL:',this[_0x4edd15(0xd5)]),console[_0x4edd15(0xef)]('Request\x20Body\x20(Updated\x20Format):',JSON[_0x4edd15(0x95)](_0x3bdb0c,null,0x2)),console[_0x4edd15(0xef)](_0x4edd15(0x94)+_0x324dce+'\x20(always\x20GB\x20for\x20Rapyd)'),console[_0x4edd15(0xef)](_0x4edd15(0xc1)),loggerService_1[_0x4edd15(0xc6)][_0x4edd15(0xe1)](_0x4edd15(0xa7),'/v1/hosted/payment_links','POST',_0x3bdb0c);const _0x3edf85=await fetch(this[_0x4edd15(0xd5)],{'method':_0x4edd15(0xbe),'headers':{'Content-Type':'application/json','User-Agent':_0x4edd15(0x105)},'body':JSON[_0x4edd15(0x95)](_0x3bdb0c)}),_0x335772=Date[_0x4edd15(0xd6)]()-_0x4a0f4f;console[_0x4edd15(0xef)](_0x4edd15(0x93)),console['log']('Status:',_0x3edf85['status']),console['log'](_0x4edd15(0xad),_0x3edf85[_0x4edd15(0x98)]),console[_0x4edd15(0xef)](_0x4edd15(0x92),Object['fromEntries'](_0x3edf85['headers']['entries']())),console[_0x4edd15(0xef)](_0x4edd15(0xe4),_0x335772+'ms');const _0x3244c3=await _0x3edf85['text']();console[_0x4edd15(0xef)](_0x4edd15(0xc9),_0x3244c3);if(!_0x3edf85['ok']){console[_0x4edd15(0xe5)](_0x4edd15(0xd3)),console[_0x4edd15(0xe5)](_0x4edd15(0xa6),_0x3edf85[_0x4edd15(0xd0)]),console[_0x4edd15(0xe5)]('Response\x20Body:',_0x3244c3),loggerService_1['loggerService'][_0x4edd15(0x100)](_0x4edd15(0xa7),_0x4edd15(0xc5),_0x3edf85[_0x4edd15(0xd0)],_0x3244c3,_0x335772),loggerService_1[_0x4edd15(0xc6)][_0x4edd15(0xc7)](_0x4edd15(0xa7),'/v1/hosted/payment_links',_0x4edd15(0xf0)+_0x3edf85[_0x4edd15(0xd0)]+':\x20'+_0x3244c3);throw new Error(_0x4edd15(0xc3)+_0x3edf85['status']+',\x20body:\x20'+_0x3244c3);}let _0x573fcb;try{_0x573fcb=JSON[_0x4edd15(0xd7)](_0x3244c3);}catch(_0x3955fa){console['error'](_0x4edd15(0xe6),_0x3955fa),loggerService_1[_0x4edd15(0xc6)][_0x4edd15(0xc7)]('rapyd',_0x4edd15(0xc5),_0x4edd15(0xfc)+_0x3955fa);throw new Error(_0x4edd15(0xec)+_0x3244c3);}console[_0x4edd15(0xef)](_0x4edd15(0xa5)),console[_0x4edd15(0xef)](_0x4edd15(0xde),JSON[_0x4edd15(0x95)](_0x573fcb,null,0x2)),loggerService_1['loggerService'][_0x4edd15(0x100)]('rapyd',_0x4edd15(0xc5),_0x3edf85[_0x4edd15(0xd0)],_0x573fcb,_0x335772);if(_0x573fcb['status']?.[_0x4edd15(0xd0)]!==_0x4edd15(0x101)){const _0x562d56=_0x573fcb[_0x4edd15(0xd0)]?.[_0x4edd15(0xcb)]||_0x4edd15(0x102),_0x5cbc1e=_0x573fcb['status']?.[_0x4edd15(0xf4)]||_0x4edd15(0xb8);console['error'](_0x4edd15(0xd8)),console[_0x4edd15(0xe5)](_0x4edd15(0x97),_0x5cbc1e),console['error'](_0x4edd15(0xa1),_0x562d56),console[_0x4edd15(0xe5)](_0x4edd15(0xf3),_0x573fcb[_0x4edd15(0xd0)]),loggerService_1[_0x4edd15(0xc6)][_0x4edd15(0xc7)](_0x4edd15(0xa7),_0x4edd15(0xc5),_0x4edd15(0x99)+_0x5cbc1e+_0x4edd15(0xaa)+_0x562d56);throw new Error(_0x4edd15(0xb7)+_0x5cbc1e+_0x4edd15(0xaa)+_0x562d56);}if(!_0x573fcb[_0x4edd15(0xb4)]?.['id']||!_0x573fcb[_0x4edd15(0xb4)]?.[_0x4edd15(0xf6)]){console[_0x4edd15(0xe5)](_0x4edd15(0x103)),console[_0x4edd15(0xe5)](_0x4edd15(0xc2)),console[_0x4edd15(0xe5)](_0x4edd15(0x9e),_0x573fcb['data']),loggerService_1[_0x4edd15(0xc6)]['logWhiteDomainError']('rapyd','/v1/hosted/payment_links',_0x4edd15(0xdc));throw new Error('Invalid\x20response\x20from\x20Rapyd\x20API:\x20missing\x20id\x20or\x20redirect_url');}return console[_0x4edd15(0xef)](_0x4edd15(0xda)),console[_0x4edd15(0xef)]('Payment\x20Link\x20ID:',_0x573fcb[_0x4edd15(0xb4)]['id']),console[_0x4edd15(0xef)](_0x4edd15(0xce),_0x573fcb[_0x4edd15(0xb4)][_0x4edd15(0xf6)]),console[_0x4edd15(0xef)](_0x4edd15(0x90)+_0x324dce+_0x4edd15(0xab)),console[_0x4edd15(0xef)](_0x4edd15(0xc1)),{'gateway_payment_id':_0x573fcb['data']['id'],'payment_url':_0x573fcb[_0x4edd15(0xb4)][_0x4edd15(0xf6)]};}catch(_0x35c7b2){console[_0x4edd15(0xe5)](_0x4edd15(0x9d)),console[_0x4edd15(0xe5)](_0x4edd15(0xa4),_0x35c7b2),loggerService_1['loggerService'][_0x4edd15(0xc7)](_0x4edd15(0xa7),_0x4edd15(0xc5),_0x35c7b2);if(_0x35c7b2 instanceof Error){console[_0x4edd15(0xe5)]('Error\x20message:',_0x35c7b2['message']),console[_0x4edd15(0xe5)]('Error\x20stack:',_0x35c7b2['stack']);throw new Error(_0x4edd15(0xa9)+_0x35c7b2[_0x4edd15(0xcb)]);}throw new Error(_0x4edd15(0xdd));}}async[a44_0x1e9f2e(0xdf)](_0x125dce){const _0x380520=a44_0x1e9f2e,_0x413407=Date[_0x380520(0xd6)]();try{loggerService_1[_0x380520(0xc6)][_0x380520(0xe1)](_0x380520(0xa7),_0x380520(0xfd)+_0x125dce,_0x380520(0xe7),{});const _0x14f430=await fetch(this[_0x380520(0xd5)]+'/'+_0x125dce,{'method':_0x380520(0xe7),'headers':{'Content-Type':'application/json','User-Agent':_0x380520(0x105)}}),_0x1908e4=Date[_0x380520(0xd6)]()-_0x413407;if(!_0x14f430['ok']){const _0x2448fb=await _0x14f430[_0x380520(0xac)]();loggerService_1[_0x380520(0xc6)]['logWhiteDomainResponse'](_0x380520(0xa7),'/v1/hosted/payment_links/'+_0x125dce,_0x14f430[_0x380520(0xd0)],_0x2448fb,_0x1908e4);throw new Error(_0x380520(0xc3)+_0x14f430[_0x380520(0xd0)]);}const _0x25b79f=await _0x14f430['json']();loggerService_1[_0x380520(0xc6)]['logWhiteDomainResponse'](_0x380520(0xa7),_0x380520(0xfd)+_0x125dce,_0x14f430[_0x380520(0xd0)],_0x25b79f,_0x1908e4);if(_0x25b79f[_0x380520(0xd0)]?.[_0x380520(0xd0)]!==_0x380520(0x101)){loggerService_1[_0x380520(0xc6)][_0x380520(0xc7)](_0x380520(0xa7),_0x380520(0xfd)+_0x125dce,_0x380520(0xb3)+(_0x25b79f['status']?.['message']||_0x380520(0xa2)));throw new Error(_0x380520(0xb3)+(_0x25b79f[_0x380520(0xd0)]?.[_0x380520(0xcb)]||'Unknown\x20error'));}let _0x43bb86=_0x380520(0xb0);if(_0x25b79f[_0x380520(0xb4)]?.[_0x380520(0xd0)])switch(_0x25b79f['data'][_0x380520(0xd0)][_0x380520(0xfa)]()){case _0x380520(0xed):_0x43bb86='PAID';break;case _0x380520(0x104):_0x43bb86=_0x380520(0xc8);break;case'EXP':_0x43bb86=_0x380520(0xa8);break;case _0x380520(0xf8):_0x43bb86=_0x380520(0xc8);break;case _0x380520(0xe2):case _0x380520(0xd4):default:_0x43bb86=_0x380520(0xb0);break;}return{'status':_0x43bb86,'amount':_0x25b79f['data']?.[_0x380520(0x9b)],'currency':_0x25b79f[_0x380520(0xb4)]?.[_0x380520(0x8f)]};}catch(_0x11fbe5){console['error'](_0x380520(0x91),_0x11fbe5),loggerService_1[_0x380520(0xc6)][_0x380520(0xc7)]('rapyd','/v1/hosted/payment_links/'+_0x125dce,_0x11fbe5);throw new Error(_0x380520(0xfb)+(_0x11fbe5 instanceof Error?_0x11fbe5['message']:_0x380520(0xa2)));}}async[a44_0x1e9f2e(0x96)](_0x3142c3){const _0x49c7ce=a44_0x1e9f2e;console['log'](_0x49c7ce(0xbf),_0x3142c3);let _0x484d3d='PENDING',_0x2ea44c;_0x3142c3[_0x49c7ce(0xb4)]?.[_0x49c7ce(0xbd)]&&(_0x2ea44c=_0x3142c3[_0x49c7ce(0xb4)]['failure_message'],console['log'](_0x49c7ce(0xf1)+_0x2ea44c));switch(_0x3142c3[_0x49c7ce(0x8e)]?.['toUpperCase']()){case _0x49c7ce(0xdb):_0x3142c3[_0x49c7ce(0xb4)]?.[_0x49c7ce(0xe9)]===!![]&&_0x3142c3[_0x49c7ce(0xb4)]?.[_0x49c7ce(0xd0)]===_0x49c7ce(0xed)?_0x484d3d=_0x49c7ce(0xe0):_0x484d3d='PENDING';break;case _0x49c7ce(0xb5):_0x484d3d=_0x49c7ce(0xc8);break;case _0x49c7ce(0xeb):_0x484d3d='EXPIRED';break;case _0x49c7ce(0xee):_0x484d3d=_0x49c7ce(0xc8);!_0x2ea44c&&_0x3142c3[_0x49c7ce(0xb4)]?.[_0x49c7ce(0xbd)]&&(_0x2ea44c=_0x3142c3[_0x49c7ce(0xb4)][_0x49c7ce(0xbd)]);break;default:switch(_0x3142c3[_0x49c7ce(0xb4)]?.[_0x49c7ce(0xd0)]?.[_0x49c7ce(0xfa)]()){case _0x49c7ce(0xed):_0x3142c3['data']?.[_0x49c7ce(0xe9)]===!![]?_0x484d3d=_0x49c7ce(0xe0):_0x484d3d=_0x49c7ce(0xc8);break;case _0x49c7ce(0x104):_0x484d3d=_0x49c7ce(0xc8);break;case _0x49c7ce(0xaf):_0x484d3d=_0x49c7ce(0xa8);break;case'ERR':_0x484d3d=_0x49c7ce(0xc8);!_0x2ea44c&&_0x3142c3[_0x49c7ce(0xb4)]?.[_0x49c7ce(0xbd)]&&(_0x2ea44c=_0x3142c3[_0x49c7ce(0xb4)][_0x49c7ce(0xbd)]);break;case _0x49c7ce(0xe2):case'ACT':default:_0x484d3d=_0x49c7ce(0xb0);break;}break;}const _0x27cfea={};return _0x3142c3[_0x49c7ce(0xb4)]?.['payment_method_data']?.[_0x49c7ce(0xd9)]&&(_0x27cfea[_0x49c7ce(0xe8)]=_0x3142c3[_0x49c7ce(0xb4)]['payment_method_data'][_0x49c7ce(0xd9)]),_0x3142c3['data']?.['payment_method_type']&&(_0x27cfea[_0x49c7ce(0xd1)]=_0x3142c3['data'][_0x49c7ce(0xc0)]),_0x3142c3[_0x49c7ce(0xb4)]?.[_0x49c7ce(0xf4)]&&(_0x27cfea[_0x49c7ce(0xb1)]=_0x3142c3[_0x49c7ce(0xb4)][_0x49c7ce(0xf4)]),_0x3142c3[_0x49c7ce(0xb4)]?.[_0x49c7ce(0xf7)]&&(_0x27cfea[_0x49c7ce(0xcc)]=_0x3142c3['data'][_0x49c7ce(0xf7)]),console[_0x49c7ce(0xef)](_0x49c7ce(0xf2)+_0x484d3d+',\x20failureMessage='+(_0x2ea44c||_0x49c7ce(0xe3))),{'paymentId':_0x3142c3['data']?.['merchant_reference_id']||'','status':_0x484d3d,'amount':_0x3142c3['data']?.['amount'],'currency':_0x3142c3[_0x49c7ce(0xb4)]?.[_0x49c7ce(0x8f)],'failureMessage':_0x2ea44c,'additionalInfo':_0x27cfea};}}exports[a44_0x1e9f2e(0xd2)]=RapydService;