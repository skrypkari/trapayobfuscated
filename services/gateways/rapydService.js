'use strict';const a50_0x5b5509=a50_0x1153;function a50_0x1153(_0x25e54a,_0x57933a){const _0x4edca8=a50_0x4edc();return a50_0x1153=function(_0x115313,_0x2ec5fb){_0x115313=_0x115313-0x19e;let _0x406db8=_0x4edca8[_0x115313];return _0x406db8;},a50_0x1153(_0x25e54a,_0x57933a);}(function(_0x15e8fe,_0x2b917c){const _0x4c1099=a50_0x1153,_0x5c35f8=_0x15e8fe();while(!![]){try{const _0x4e2fb7=parseInt(_0x4c1099(0x20e))/0x1+parseInt(_0x4c1099(0x1bd))/0x2+parseInt(_0x4c1099(0x1af))/0x3+parseInt(_0x4c1099(0x1a1))/0x4*(-parseInt(_0x4c1099(0x1e3))/0x5)+parseInt(_0x4c1099(0x1b0))/0x6*(parseInt(_0x4c1099(0x1f0))/0x7)+parseInt(_0x4c1099(0x201))/0x8*(-parseInt(_0x4c1099(0x1f3))/0x9)+parseInt(_0x4c1099(0x1e1))/0xa*(-parseInt(_0x4c1099(0x215))/0xb);if(_0x4e2fb7===_0x2b917c)break;else _0x5c35f8['push'](_0x5c35f8['shift']());}catch(_0x316f44){_0x5c35f8['push'](_0x5c35f8['shift']());}}}(a50_0x4edc,0x4efb3));Object[a50_0x5b5509(0x1b7)](exports,'__esModule',{'value':!![]}),exports[a50_0x5b5509(0x1eb)]=void 0x0;const loggerService_1=require(a50_0x5b5509(0x1e7));class RapydService{constructor(){const _0x32bc88=a50_0x5b5509;this['apiUrl']=_0x32bc88(0x1b8),console['log']('üåê\x20Rapyd\x20service\x20initialized\x20with\x20white\x20domain\x20proxy');}async[a50_0x5b5509(0x1aa)](_0x303868){const _0x17f497=a50_0x5b5509,{orderId:_0x598be7,orderName:_0x42bf89,amount:_0x1e6a8f,currency:_0x7b2f4e,usage:_0x29f888,maxPayments:_0x2a4def,successUrl:_0x2ab589,failUrl:_0x5ef034}=_0x303868,_0x151514=_0x7b2f4e[_0x17f497(0x1da)](),_0x5e4f22='GB';console['log'](_0x17f497(0x1fa));const _0x1fcf05=_0x17f497(0x204)+_0x598be7,_0x344c09=_0x17f497(0x200)+_0x598be7,_0x12f9b1={'amount':_0x1e6a8f,'currency':_0x151514,'cancel_checkout_url':_0x344c09,'complete_checkout_url':_0x1fcf05,'complete_payment_url':_0x1fcf05,'merchant_reference_id':_0x598be7,'description':_0x17f497(0x19f)+_0x598be7,'country':'GB','payment_method_types_include':[_0x17f497(0x1fe),_0x17f497(0x1b3)],'custom_elements':{'display_description':!![]}};if(_0x151514!==_0x17f497(0x207)){const _0x55d294=Math['floor'](Date[_0x17f497(0x1de)]()/0x3e8)+0x1e*0x3c;_0x12f9b1[_0x17f497(0x1f4)]=_0x17f497(0x1f9),_0x12f9b1[_0x17f497(0x209)]=_0x17f497(0x207),_0x12f9b1['expiration']=_0x55d294,console['log']('üí±\x20Adding\x20currency\x20conversion\x20fields\x20for\x20'+_0x151514+_0x17f497(0x1ba)),console['log'](_0x17f497(0x1d3)),console[_0x17f497(0x1cf)](_0x17f497(0x20c)),console['log']('\x20\x20\x20expiration:\x20'+_0x55d294+'\x20('+new Date(_0x55d294*0x3e8)[_0x17f497(0x1f8)]()+')');}const _0x378558=Date[_0x17f497(0x1de)]();try{console[_0x17f497(0x1cf)](_0x17f497(0x1e0)),console[_0x17f497(0x1cf)](_0x17f497(0x20b),this['apiUrl']),console['log'](_0x17f497(0x21e),JSON[_0x17f497(0x1ce)](_0x12f9b1,null,0x2)),console[_0x17f497(0x1cf)]('üá¨üáß\x20Country:\x20'+_0x5e4f22+_0x17f497(0x203)),console[_0x17f497(0x1cf)](_0x17f497(0x1b9)),loggerService_1[_0x17f497(0x1e5)][_0x17f497(0x1b2)](_0x17f497(0x1be),'/v1/hosted/payment_links','POST',_0x12f9b1);const _0x5ac285=await fetch(this[_0x17f497(0x1bb)],{'method':_0x17f497(0x1b4),'headers':{'Content-Type':_0x17f497(0x1ff),'User-Agent':_0x17f497(0x1c8)},'body':JSON[_0x17f497(0x1ce)](_0x12f9b1)}),_0x5a966f=Date[_0x17f497(0x1de)]()-_0x378558;console['log'](_0x17f497(0x1d2)),console['log'](_0x17f497(0x210),_0x5ac285['status']),console[_0x17f497(0x1cf)](_0x17f497(0x20a),_0x5ac285['statusText']),console['log'](_0x17f497(0x1f6),Object[_0x17f497(0x1ee)](_0x5ac285[_0x17f497(0x208)]['entries']())),console[_0x17f497(0x1cf)](_0x17f497(0x1e6),_0x5a966f+'ms');const _0xa695=await _0x5ac285[_0x17f497(0x19e)]();console[_0x17f497(0x1cf)](_0x17f497(0x1a4),_0xa695);if(!_0x5ac285['ok']){console[_0x17f497(0x214)](_0x17f497(0x1cb)),console[_0x17f497(0x214)](_0x17f497(0x1a5),_0x5ac285[_0x17f497(0x1e9)]),console[_0x17f497(0x214)](_0x17f497(0x1a6),_0xa695),loggerService_1[_0x17f497(0x1e5)]['logWhiteDomainResponse']('rapyd',_0x17f497(0x1a3),_0x5ac285[_0x17f497(0x1e9)],_0xa695,_0x5a966f),loggerService_1[_0x17f497(0x1e5)][_0x17f497(0x1df)](_0x17f497(0x1be),_0x17f497(0x1a3),'HTTP\x20'+_0x5ac285[_0x17f497(0x1e9)]+':\x20'+_0xa695);throw new Error('HTTP\x20error!\x20status:\x20'+_0x5ac285[_0x17f497(0x1e9)]+',\x20body:\x20'+_0xa695);}let _0x2ba90f;try{_0x2ba90f=JSON[_0x17f497(0x1bf)](_0xa695);}catch(_0x4c71c0){console['error']('Failed\x20to\x20parse\x20JSON\x20response:',_0x4c71c0),loggerService_1['loggerService'][_0x17f497(0x1df)](_0x17f497(0x1be),_0x17f497(0x1a3),_0x17f497(0x1ec)+_0x4c71c0);throw new Error(_0x17f497(0x216)+_0xa695);}console[_0x17f497(0x1cf)]('===\x20PARSED\x20RAPYD\x20RESPONSE\x20==='),console[_0x17f497(0x1cf)](_0x17f497(0x1c6),JSON[_0x17f497(0x1ce)](_0x2ba90f,null,0x2)),loggerService_1[_0x17f497(0x1e5)]['logWhiteDomainResponse']('rapyd',_0x17f497(0x1a3),_0x5ac285[_0x17f497(0x1e9)],_0x2ba90f,_0x5a966f);if(_0x2ba90f['status']?.[_0x17f497(0x1e9)]!=='SUCCESS'){const _0x2a977a=_0x2ba90f['status']?.[_0x17f497(0x1d7)]||_0x17f497(0x202),_0x70417d=_0x2ba90f[_0x17f497(0x1e9)]?.[_0x17f497(0x21c)]||_0x17f497(0x206);console[_0x17f497(0x214)](_0x17f497(0x1db)),console['error']('Error\x20Code:',_0x70417d),console[_0x17f497(0x214)](_0x17f497(0x21b),_0x2a977a),console['error'](_0x17f497(0x1d0),_0x2ba90f[_0x17f497(0x1e9)]),loggerService_1[_0x17f497(0x1e5)][_0x17f497(0x1df)]('rapyd',_0x17f497(0x1a3),_0x17f497(0x1b5)+_0x70417d+_0x17f497(0x1d4)+_0x2a977a);throw new Error(_0x17f497(0x213)+_0x70417d+_0x17f497(0x1d4)+_0x2a977a);}if(!_0x2ba90f['data']?.['id']||!_0x2ba90f[_0x17f497(0x218)]?.[_0x17f497(0x1ef)]){console['error'](_0x17f497(0x1a9)),console[_0x17f497(0x214)](_0x17f497(0x205)),console[_0x17f497(0x214)](_0x17f497(0x211),_0x2ba90f[_0x17f497(0x218)]),loggerService_1[_0x17f497(0x1e5)][_0x17f497(0x1df)](_0x17f497(0x1be),_0x17f497(0x1a3),_0x17f497(0x1cc));throw new Error('Invalid\x20response\x20from\x20Rapyd\x20API:\x20missing\x20id\x20or\x20redirect_url');}return console[_0x17f497(0x1cf)](_0x17f497(0x1ad)),console[_0x17f497(0x1cf)](_0x17f497(0x1c5),_0x2ba90f[_0x17f497(0x218)]['id']),console[_0x17f497(0x1cf)](_0x17f497(0x219),_0x2ba90f['data'][_0x17f497(0x1ef)]),console[_0x17f497(0x1cf)](_0x17f497(0x1f1)+_0x5e4f22+_0x17f497(0x1c7)),console[_0x17f497(0x1cf)](_0x17f497(0x1b9)),{'gateway_payment_id':_0x2ba90f[_0x17f497(0x218)]['id'],'payment_url':_0x2ba90f[_0x17f497(0x218)][_0x17f497(0x1ef)]};}catch(_0x18c69d){console['error']('===\x20RAPYD\x20SERVICE\x20ERROR\x20==='),console['error'](_0x17f497(0x1f2),_0x18c69d),loggerService_1['loggerService'][_0x17f497(0x1df)]('rapyd',_0x17f497(0x1a3),_0x18c69d);if(_0x18c69d instanceof Error){console[_0x17f497(0x214)](_0x17f497(0x1dc),_0x18c69d[_0x17f497(0x1d7)]),console['error']('Error\x20stack:',_0x18c69d[_0x17f497(0x1d5)]);throw new Error(_0x17f497(0x1c1)+_0x18c69d[_0x17f497(0x1d7)]);}throw new Error(_0x17f497(0x1dd));}}async['verifyPayment'](_0x4bdfdc){const _0x39e241=a50_0x5b5509,_0x373bf2=Date['now']();try{loggerService_1[_0x39e241(0x1e5)][_0x39e241(0x1b2)](_0x39e241(0x1be),_0x39e241(0x1b1)+_0x4bdfdc,_0x39e241(0x20f),{});const _0x379852=await fetch(this[_0x39e241(0x1bb)]+'/'+_0x4bdfdc,{'method':_0x39e241(0x20f),'headers':{'Content-Type':'application/json','User-Agent':_0x39e241(0x1c8)}}),_0x5ae88f=Date[_0x39e241(0x1de)]()-_0x373bf2;if(!_0x379852['ok']){const _0x10869c=await _0x379852[_0x39e241(0x19e)]();loggerService_1[_0x39e241(0x1e5)]['logWhiteDomainResponse'](_0x39e241(0x1be),_0x39e241(0x1b1)+_0x4bdfdc,_0x379852[_0x39e241(0x1e9)],_0x10869c,_0x5ae88f);throw new Error(_0x39e241(0x1c0)+_0x379852[_0x39e241(0x1e9)]);}const _0x47a849=await _0x379852[_0x39e241(0x1d6)]();loggerService_1[_0x39e241(0x1e5)][_0x39e241(0x1a8)](_0x39e241(0x1be),_0x39e241(0x1b1)+_0x4bdfdc,_0x379852[_0x39e241(0x1e9)],_0x47a849,_0x5ae88f);if(_0x47a849[_0x39e241(0x1e9)]?.[_0x39e241(0x1e9)]!==_0x39e241(0x1ac)){loggerService_1['loggerService'][_0x39e241(0x1df)](_0x39e241(0x1be),_0x39e241(0x1b1)+_0x4bdfdc,_0x39e241(0x1a7)+(_0x47a849[_0x39e241(0x1e9)]?.[_0x39e241(0x1d7)]||_0x39e241(0x1ab)));throw new Error(_0x39e241(0x1a7)+(_0x47a849[_0x39e241(0x1e9)]?.[_0x39e241(0x1d7)]||_0x39e241(0x1ab)));}let _0x5420a1=_0x39e241(0x1c3);if(_0x47a849[_0x39e241(0x218)]?.[_0x39e241(0x1e9)])switch(_0x47a849[_0x39e241(0x218)][_0x39e241(0x1e9)][_0x39e241(0x1da)]()){case _0x39e241(0x1c9):_0x5420a1=_0x39e241(0x1ae);break;case _0x39e241(0x1c4):_0x5420a1='FAILED';break;case _0x39e241(0x1ea):_0x5420a1=_0x39e241(0x217);break;case _0x39e241(0x1bc):_0x5420a1=_0x39e241(0x1ca);break;case'NEW':case _0x39e241(0x1fb):default:_0x5420a1=_0x39e241(0x1c3);break;}return{'status':_0x5420a1,'amount':_0x47a849[_0x39e241(0x218)]?.['amount'],'currency':_0x47a849['data']?.[_0x39e241(0x1e8)]};}catch(_0x32f6ed){console[_0x39e241(0x214)]('Rapyd\x20payment\x20verification\x20error:',_0x32f6ed),loggerService_1[_0x39e241(0x1e5)][_0x39e241(0x1df)](_0x39e241(0x1be),_0x39e241(0x1b1)+_0x4bdfdc,_0x32f6ed);throw new Error(_0x39e241(0x1f5)+(_0x32f6ed instanceof Error?_0x32f6ed[_0x39e241(0x1d7)]:'Unknown\x20error'));}}async['processWebhook'](_0x48b54d){const _0x1674d9=a50_0x5b5509;console[_0x1674d9(0x1cf)](_0x1674d9(0x1d9),_0x48b54d);let _0x244990=_0x1674d9(0x1c3),_0x2cc8ed;_0x48b54d[_0x1674d9(0x218)]?.['failure_message']&&(_0x2cc8ed=_0x48b54d[_0x1674d9(0x218)]['failure_message'],console[_0x1674d9(0x1cf)](_0x1674d9(0x1e2)+_0x2cc8ed));switch(_0x48b54d[_0x1674d9(0x1b6)]?.[_0x1674d9(0x1da)]()){case _0x1674d9(0x1fc):_0x48b54d[_0x1674d9(0x218)]?.[_0x1674d9(0x21f)]===!![]&&_0x48b54d[_0x1674d9(0x218)]?.['status']==='CLO'?_0x244990=_0x1674d9(0x1ae):_0x244990=_0x1674d9(0x1c3);break;case _0x1674d9(0x1c2):_0x244990=_0x1674d9(0x1ca);break;case'PAYMENT_EXPIRED':_0x244990='EXPIRED';break;case _0x1674d9(0x1ed):_0x244990=_0x1674d9(0x1ca);!_0x2cc8ed&&_0x48b54d['data']?.[_0x1674d9(0x212)]&&(_0x2cc8ed=_0x48b54d[_0x1674d9(0x218)][_0x1674d9(0x212)]);break;default:switch(_0x48b54d['data']?.[_0x1674d9(0x1e9)]?.[_0x1674d9(0x1da)]()){case'CLO':_0x48b54d['data']?.[_0x1674d9(0x21f)]===!![]?_0x244990=_0x1674d9(0x1ae):_0x244990=_0x1674d9(0x1ca);break;case _0x1674d9(0x1c4):_0x244990=_0x1674d9(0x1ca);break;case _0x1674d9(0x1ea):_0x244990=_0x1674d9(0x217);break;case _0x1674d9(0x1bc):_0x244990=_0x1674d9(0x1ca);!_0x2cc8ed&&_0x48b54d[_0x1674d9(0x218)]?.[_0x1674d9(0x212)]&&(_0x2cc8ed=_0x48b54d[_0x1674d9(0x218)]['failure_message']);break;case _0x1674d9(0x21d):case'ACT':default:_0x244990=_0x1674d9(0x1c3);break;}break;}const _0x1a0219={};return _0x48b54d[_0x1674d9(0x218)]?.[_0x1674d9(0x1cd)]?.['last4']&&(_0x1a0219['cardLast4']=_0x48b54d[_0x1674d9(0x218)][_0x1674d9(0x1cd)][_0x1674d9(0x1a0)]),_0x48b54d[_0x1674d9(0x218)]?.[_0x1674d9(0x1d1)]&&(_0x1a0219[_0x1674d9(0x1fd)]=_0x48b54d['data'][_0x1674d9(0x1d1)]),_0x48b54d[_0x1674d9(0x218)]?.[_0x1674d9(0x21c)]&&(_0x1a0219['errorCode']=_0x48b54d['data'][_0x1674d9(0x21c)]),_0x48b54d[_0x1674d9(0x218)]?.[_0x1674d9(0x20d)]&&(_0x1a0219[_0x1674d9(0x21a)]=_0x48b54d[_0x1674d9(0x218)][_0x1674d9(0x20d)]),console['log']('üîÑ\x20Rapyd\x20webhook\x20processed:\x20status='+_0x244990+_0x1674d9(0x1e4)+(_0x2cc8ed||_0x1674d9(0x1a2))),{'paymentId':_0x48b54d[_0x1674d9(0x218)]?.[_0x1674d9(0x1d8)]||'','status':_0x244990,'amount':_0x48b54d[_0x1674d9(0x218)]?.[_0x1674d9(0x1f7)],'currency':_0x48b54d[_0x1674d9(0x218)]?.[_0x1674d9(0x1e8)],'failureMessage':_0x2cc8ed,'additionalInfo':_0x1a0219};}}function a50_0x4edc(){const _0x3d273f=['Response\x20Time:','../loggerService','currency','status','EXP','RapydService','JSON\x20Parse\x20Error:\x20','PAYMENT_FAILED','fromEntries','redirect_url','924JKXneE','üá¨üáß\x20Country\x20used:\x20','Error\x20details:','219654JxSwID','fixed_side','Failed\x20to\x20verify\x20Rapyd\x20payment:\x20','Headers:','amount','toISOString','buy','üá¨üáß\x20Using\x20GB\x20(Britain)\x20as\x20country\x20for\x20Rapyd\x20payment\x20link','ACT','PAYMENT_COMPLETED','paymentMethod','gb_visa_card','application/json','https://tesoft.uk/gateway/fail.php?id=','104FcLDpB','Unknown\x20error\x20from\x20Rapyd\x20API','\x20(always\x20GB\x20for\x20Rapyd)','https://tesoft.uk/gateway/success.php?id=','Missing\x20id\x20or\x20redirect_url\x20in\x20response','UNKNOWN','EUR','headers','requested_currency','Status\x20Text:','URL:','\x20\x20\x20requested_currency:\x20EUR','failure_code','70139DBqCWe','GET','Status:','Response\x20data:','failure_message','Rapyd\x20API\x20error\x20(','error','11zKrJvm','Invalid\x20JSON\x20response\x20from\x20Rapyd\x20API:\x20','EXPIRED','data','Redirect\x20URL:','failureCode','Error\x20Message:','error_code','NEW','Request\x20Body\x20(Updated\x20Format):','paid','text','ORDER:\x20','last4','45176xxXKIN','none','/v1/hosted/payment_links','Raw\x20Response\x20Body:','HTTP\x20Status:','Response\x20Body:','Rapyd\x20API\x20error:\x20','logWhiteDomainResponse','===\x20RAPYD\x20API\x20INCOMPLETE\x20RESPONSE\x20===','createPaymentLink','Unknown\x20error','SUCCESS','===\x20RAPYD\x20SUCCESS\x20===','PAID','1115133GcQXti','13218erdnDj','/v1/hosted/payment_links/','logWhiteDomainRequest','gb_mastercard_card','POST','Business\x20Error\x20(','type','defineProperty','https://tesoft.uk/gateway/rapyd/','üí≥\x20Payment\x20Methods:\x20gb_visa_card,\x20gb_mastercard_card','\x20->\x20EUR:','apiUrl','ERR','1165540KobDfs','rapyd','parse','HTTP\x20error!\x20status:\x20','Failed\x20to\x20create\x20Rapyd\x20payment\x20link:\x20','PAYMENT_CANCELED','PENDING','CAN','Payment\x20Link\x20ID:','Parsed\x20Result:','\x20(GB\x20-\x20Britain)','TesSoft\x20Payment\x20System/1.0','CLO','FAILED','===\x20RAPYD\x20API\x20ERROR\x20===','Incomplete\x20response:\x20missing\x20id\x20or\x20redirect_url','payment_method_data','stringify','log','Full\x20Error\x20Data:','payment_method_type','===\x20RAPYD\x20API\x20RESPONSE\x20(White\x20Domain)\x20===','\x20\x20\x20fixed_side:\x20buy','):\x20','stack','json','message','merchant_reference_id','Processing\x20Rapyd\x20webhook:','toUpperCase','===\x20RAPYD\x20API\x20BUSINESS\x20ERROR\x20===','Error\x20message:','Failed\x20to\x20create\x20Rapyd\x20payment\x20link:\x20Unknown\x20error','now','logWhiteDomainError','===\x20RAPYD\x20API\x20REQUEST\x20(White\x20Domain\x20-\x20Updated\x20Format)\x20===','2115770aGPohH','üí•\x20Rapyd\x20failure\x20message:\x20','205PYmFLB',',\x20failureMessage=','loggerService'];a50_0x4edc=function(){return _0x3d273f;};return a50_0x4edc();}exports[a50_0x5b5509(0x1eb)]=RapydService;