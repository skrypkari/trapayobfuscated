'use strict';const a42_0x4ddcb4=a42_0x1606;(function(_0x4b54d2,_0x1bd5a3){const _0x129973=a42_0x1606,_0x487366=_0x4b54d2();while(!![]){try{const _0x2cc7d0=parseInt(_0x129973(0x7e))/0x1+-parseInt(_0x129973(0x9e))/0x2*(parseInt(_0x129973(0xb9))/0x3)+parseInt(_0x129973(0x7a))/0x4+parseInt(_0x129973(0xa1))/0x5+parseInt(_0x129973(0x9a))/0x6+parseInt(_0x129973(0xa0))/0x7*(-parseInt(_0x129973(0xca))/0x8)+-parseInt(_0x129973(0xae))/0x9*(parseInt(_0x129973(0xa5))/0xa);if(_0x2cc7d0===_0x1bd5a3)break;else _0x487366['push'](_0x487366['shift']());}catch(_0x4b39e2){_0x487366['push'](_0x487366['shift']());}}}(a42_0x547a,0xaba37));Object['defineProperty'](exports,a42_0x4ddcb4(0xc1),{'value':!![]}),exports[a42_0x4ddcb4(0xd5)]=void 0x0;function a42_0x1606(_0x2b400d,_0x58ab99){const _0x547a2e=a42_0x547a();return a42_0x1606=function(_0x16060a,_0x3cc1ae){_0x16060a=_0x16060a-0x6c;let _0x4546a9=_0x547a2e[_0x16060a];return _0x4546a9;},a42_0x1606(_0x2b400d,_0x58ab99);}const loggerService_1=require('../loggerService');class RapydService{constructor(){const _0x2c6602=a42_0x4ddcb4;this[_0x2c6602(0x7d)]=_0x2c6602(0x79),console[_0x2c6602(0x85)]('üåê\x20Rapyd\x20service\x20initialized\x20with\x20white\x20domain\x20proxy');}async[a42_0x4ddcb4(0xa8)](_0x4dcea7){const _0x534d0b=a42_0x4ddcb4,{orderId:_0x38c73a,orderName:_0x8f46bf,amount:_0x5d2a2e,currency:_0x163f9e,usage:_0x50cce6,maxPayments:_0x1550b1,successUrl:_0x56fc57,failUrl:_0x354399}=_0x4dcea7,_0x76f148=_0x163f9e['toUpperCase'](),_0xac35d9='GB';console[_0x534d0b(0x85)]('üá¨üáß\x20Using\x20GB\x20(Britain)\x20as\x20country\x20for\x20Rapyd\x20payment\x20link');const _0x5312c3=_0x534d0b(0x84)+_0x38c73a,_0x15860b=_0x534d0b(0x7b)+_0x38c73a,_0xd00d43={'amount':_0x5d2a2e,'currency':_0x76f148,'cancel_checkout_url':_0x15860b,'complete_checkout_url':_0x5312c3,'complete_payment_url':_0x5312c3,'merchant_reference_id':_0x38c73a,'description':'ORDER:\x20'+_0x38c73a,'country':'GB','payment_method_types_include':[_0x534d0b(0x98),_0x534d0b(0x70)],'custom_elements':{'display_description':!![]}},_0x4e75fd=Date[_0x534d0b(0x7f)]();try{console[_0x534d0b(0x85)](_0x534d0b(0x7c)),console['log'](_0x534d0b(0xab),this['apiUrl']),console[_0x534d0b(0x85)](_0x534d0b(0x6c),JSON[_0x534d0b(0x82)](_0xd00d43,null,0x2)),console[_0x534d0b(0x85)](_0x534d0b(0xd7)+_0xac35d9+_0x534d0b(0x6d)),console[_0x534d0b(0x85)](_0x534d0b(0xbf)),loggerService_1[_0x534d0b(0xaa)][_0x534d0b(0x6e)]('rapyd',_0x534d0b(0xc3),_0x534d0b(0xb1),_0xd00d43);const _0x33a1bb=await fetch(this[_0x534d0b(0x7d)],{'method':_0x534d0b(0xb1),'headers':{'Content-Type':'application/json','User-Agent':_0x534d0b(0xaf)},'body':JSON[_0x534d0b(0x82)](_0xd00d43)}),_0x469b6e=Date[_0x534d0b(0x7f)]()-_0x4e75fd;console[_0x534d0b(0x85)](_0x534d0b(0xcb)),console[_0x534d0b(0x85)](_0x534d0b(0x81),_0x33a1bb[_0x534d0b(0x77)]),console['log'](_0x534d0b(0xa2),_0x33a1bb['statusText']),console[_0x534d0b(0x85)]('Headers:',Object[_0x534d0b(0x71)](_0x33a1bb[_0x534d0b(0xc7)][_0x534d0b(0x72)]())),console[_0x534d0b(0x85)](_0x534d0b(0xcd),_0x469b6e+'ms');const _0x24fbb9=await _0x33a1bb[_0x534d0b(0xa7)]();console['log']('Raw\x20Response\x20Body:',_0x24fbb9);if(!_0x33a1bb['ok']){console[_0x534d0b(0x91)](_0x534d0b(0xd6)),console['error'](_0x534d0b(0x92),_0x33a1bb[_0x534d0b(0x77)]),console[_0x534d0b(0x91)]('Response\x20Body:',_0x24fbb9),loggerService_1[_0x534d0b(0xaa)][_0x534d0b(0xcf)](_0x534d0b(0xbd),_0x534d0b(0xc3),_0x33a1bb[_0x534d0b(0x77)],_0x24fbb9,_0x469b6e),loggerService_1[_0x534d0b(0xaa)][_0x534d0b(0xc5)](_0x534d0b(0xbd),_0x534d0b(0xc3),_0x534d0b(0x8f)+_0x33a1bb[_0x534d0b(0x77)]+':\x20'+_0x24fbb9);throw new Error(_0x534d0b(0x86)+_0x33a1bb[_0x534d0b(0x77)]+_0x534d0b(0x89)+_0x24fbb9);}let _0x439ba6;try{_0x439ba6=JSON[_0x534d0b(0x76)](_0x24fbb9);}catch(_0x4f7774){console['error'](_0x534d0b(0xbc),_0x4f7774),loggerService_1['loggerService'][_0x534d0b(0xc5)](_0x534d0b(0xbd),_0x534d0b(0xc3),'JSON\x20Parse\x20Error:\x20'+_0x4f7774);throw new Error(_0x534d0b(0xd1)+_0x24fbb9);}console[_0x534d0b(0x85)](_0x534d0b(0xd9)),console[_0x534d0b(0x85)](_0x534d0b(0xa9),JSON[_0x534d0b(0x82)](_0x439ba6,null,0x2)),loggerService_1[_0x534d0b(0xaa)]['logWhiteDomainResponse'](_0x534d0b(0xbd),_0x534d0b(0xc3),_0x33a1bb['status'],_0x439ba6,_0x469b6e);if(_0x439ba6[_0x534d0b(0x77)]?.[_0x534d0b(0x77)]!==_0x534d0b(0xc9)){const _0x1e270b=_0x439ba6[_0x534d0b(0x77)]?.[_0x534d0b(0xb6)]||_0x534d0b(0x6f),_0x2f6479=_0x439ba6[_0x534d0b(0x77)]?.[_0x534d0b(0x9c)]||_0x534d0b(0x8e);console['error'](_0x534d0b(0xb0)),console[_0x534d0b(0x91)](_0x534d0b(0xd8),_0x2f6479),console[_0x534d0b(0x91)]('Error\x20Message:',_0x1e270b),console[_0x534d0b(0x91)](_0x534d0b(0xd2),_0x439ba6[_0x534d0b(0x77)]),loggerService_1[_0x534d0b(0xaa)][_0x534d0b(0xc5)](_0x534d0b(0xbd),_0x534d0b(0xc3),_0x534d0b(0x87)+_0x2f6479+'):\x20'+_0x1e270b);throw new Error('Rapyd\x20API\x20error\x20('+_0x2f6479+'):\x20'+_0x1e270b);}if(!_0x439ba6[_0x534d0b(0xb4)]?.['id']||!_0x439ba6[_0x534d0b(0xb4)]?.['redirect_url']){console[_0x534d0b(0x91)]('===\x20RAPYD\x20API\x20INCOMPLETE\x20RESPONSE\x20==='),console[_0x534d0b(0x91)]('Missing\x20id\x20or\x20redirect_url\x20in\x20response'),console['error'](_0x534d0b(0x75),_0x439ba6['data']),loggerService_1[_0x534d0b(0xaa)][_0x534d0b(0xc5)](_0x534d0b(0xbd),'/v1/hosted/payment_links',_0x534d0b(0xd4));throw new Error(_0x534d0b(0xc4));}return console[_0x534d0b(0x85)](_0x534d0b(0x78)),console[_0x534d0b(0x85)](_0x534d0b(0x8a),_0x439ba6['data']['id']),console[_0x534d0b(0x85)](_0x534d0b(0x96),_0x439ba6['data']['redirect_url']),console['log'](_0x534d0b(0xa3)+_0xac35d9+_0x534d0b(0xc2)),console['log'](_0x534d0b(0xbf)),{'gateway_payment_id':_0x439ba6[_0x534d0b(0xb4)]['id'],'payment_url':_0x439ba6[_0x534d0b(0xb4)][_0x534d0b(0xac)]};}catch(_0x29497d){console['error']('===\x20RAPYD\x20SERVICE\x20ERROR\x20==='),console[_0x534d0b(0x91)]('Error\x20details:',_0x29497d),loggerService_1[_0x534d0b(0xaa)][_0x534d0b(0xc5)](_0x534d0b(0xbd),_0x534d0b(0xc3),_0x29497d);if(_0x29497d instanceof Error){console['error'](_0x534d0b(0x9b),_0x29497d[_0x534d0b(0xb6)]),console['error'](_0x534d0b(0xc8),_0x29497d[_0x534d0b(0x97)]);throw new Error(_0x534d0b(0x9d)+_0x29497d['message']);}throw new Error(_0x534d0b(0x80));}}async[a42_0x4ddcb4(0x9f)](_0x15f85c){const _0x335f65=a42_0x4ddcb4,_0x488b3e=Date[_0x335f65(0x7f)]();try{loggerService_1['loggerService'][_0x335f65(0x6e)](_0x335f65(0xbd),_0x335f65(0xbb)+_0x15f85c,_0x335f65(0xbe),{});const _0x39a2f4=await fetch(this['apiUrl']+'/'+_0x15f85c,{'method':_0x335f65(0xbe),'headers':{'Content-Type':_0x335f65(0x99),'User-Agent':_0x335f65(0xaf)}}),_0x1940c1=Date[_0x335f65(0x7f)]()-_0x488b3e;if(!_0x39a2f4['ok']){const _0x21e984=await _0x39a2f4[_0x335f65(0xa7)]();loggerService_1[_0x335f65(0xaa)][_0x335f65(0xcf)](_0x335f65(0xbd),_0x335f65(0xbb)+_0x15f85c,_0x39a2f4[_0x335f65(0x77)],_0x21e984,_0x1940c1);throw new Error('HTTP\x20error!\x20status:\x20'+_0x39a2f4['status']);}const _0x58595a=await _0x39a2f4[_0x335f65(0x8d)]();loggerService_1[_0x335f65(0xaa)]['logWhiteDomainResponse'](_0x335f65(0xbd),'/v1/hosted/payment_links/'+_0x15f85c,_0x39a2f4[_0x335f65(0x77)],_0x58595a,_0x1940c1);if(_0x58595a[_0x335f65(0x77)]?.[_0x335f65(0x77)]!==_0x335f65(0xc9)){loggerService_1[_0x335f65(0xaa)][_0x335f65(0xc5)](_0x335f65(0xbd),_0x335f65(0xbb)+_0x15f85c,_0x335f65(0xc6)+(_0x58595a[_0x335f65(0x77)]?.[_0x335f65(0xb6)]||_0x335f65(0xb2)));throw new Error(_0x335f65(0xc6)+(_0x58595a[_0x335f65(0x77)]?.['message']||_0x335f65(0xb2)));}let _0x4d5734=_0x335f65(0x93);if(_0x58595a[_0x335f65(0xb4)]?.[_0x335f65(0x77)])switch(_0x58595a[_0x335f65(0xb4)][_0x335f65(0x77)]['toUpperCase']()){case _0x335f65(0xa6):_0x4d5734=_0x335f65(0xb5);break;case _0x335f65(0x88):_0x4d5734=_0x335f65(0x95);break;case _0x335f65(0x73):_0x4d5734=_0x335f65(0xa4);break;case _0x335f65(0x94):_0x4d5734=_0x335f65(0x95);break;case _0x335f65(0xb8):case _0x335f65(0xb3):default:_0x4d5734=_0x335f65(0x93);break;}return{'status':_0x4d5734,'amount':_0x58595a[_0x335f65(0xb4)]?.['amount'],'currency':_0x58595a[_0x335f65(0xb4)]?.[_0x335f65(0xc0)]};}catch(_0x344d66){console[_0x335f65(0x91)](_0x335f65(0x8c),_0x344d66),loggerService_1[_0x335f65(0xaa)][_0x335f65(0xc5)](_0x335f65(0xbd),_0x335f65(0xbb)+_0x15f85c,_0x344d66);throw new Error(_0x335f65(0x90)+(_0x344d66 instanceof Error?_0x344d66['message']:_0x335f65(0xb2)));}}async[a42_0x4ddcb4(0x8b)](_0x1c0d8f){const _0x5a1e77=a42_0x4ddcb4;console[_0x5a1e77(0x85)](_0x5a1e77(0xb7),_0x1c0d8f);let _0x284c9f='PENDING';switch(_0x1c0d8f[_0x5a1e77(0x83)]?.['toUpperCase']()){case _0x5a1e77(0xcc):_0x1c0d8f[_0x5a1e77(0xb4)]?.['paid']===!![]&&_0x1c0d8f[_0x5a1e77(0xb4)]?.[_0x5a1e77(0x77)]===_0x5a1e77(0xa6)?_0x284c9f=_0x5a1e77(0xb5):_0x284c9f=_0x5a1e77(0x93);break;case _0x5a1e77(0xd3):_0x284c9f=_0x5a1e77(0x95);break;case _0x5a1e77(0xba):_0x284c9f='EXPIRED';break;case _0x5a1e77(0xd0):_0x284c9f=_0x5a1e77(0x95);break;default:switch(_0x1c0d8f[_0x5a1e77(0xb4)]?.[_0x5a1e77(0x77)]?.[_0x5a1e77(0xad)]()){case'CLO':_0x1c0d8f[_0x5a1e77(0xb4)]?.['paid']===!![]?_0x284c9f=_0x5a1e77(0xb5):_0x284c9f='FAILED';break;case'CAN':_0x284c9f=_0x5a1e77(0x95);break;case _0x5a1e77(0x73):_0x284c9f=_0x5a1e77(0xa4);break;case'ERR':_0x284c9f='FAILED';break;case _0x5a1e77(0xb8):case _0x5a1e77(0xb3):default:_0x284c9f='PENDING';break;}break;}return{'paymentId':_0x1c0d8f[_0x5a1e77(0xb4)]?.[_0x5a1e77(0x74)]||'','status':_0x284c9f,'amount':_0x1c0d8f[_0x5a1e77(0xb4)]?.[_0x5a1e77(0xce)],'currency':_0x1c0d8f['data']?.[_0x5a1e77(0xc0)]};}}exports[a42_0x4ddcb4(0xd5)]=RapydService;function a42_0x547a(){const _0x20f3c2=['130OxMxTq','CLO','text','createPaymentLink','Parsed\x20Result:','loggerService','URL:','redirect_url','toUpperCase','834804GstRsG','TesSoft\x20Payment\x20System/1.0','===\x20RAPYD\x20API\x20BUSINESS\x20ERROR\x20===','POST','Unknown\x20error','ACT','data','PAID','message','Processing\x20Rapyd\x20webhook:','NEW','908862MOTsXh','PAYMENT_EXPIRED','/v1/hosted/payment_links/','Failed\x20to\x20parse\x20JSON\x20response:','rapyd','GET','üí≥\x20Payment\x20Methods:\x20gb_visa_card,\x20gb_mastercard_card','currency','__esModule','\x20(GB\x20-\x20Britain)','/v1/hosted/payment_links','Invalid\x20response\x20from\x20Rapyd\x20API:\x20missing\x20id\x20or\x20redirect_url','logWhiteDomainError','Rapyd\x20API\x20error:\x20','headers','Error\x20stack:','SUCCESS','1859888veNAlp','===\x20RAPYD\x20API\x20RESPONSE\x20(White\x20Domain)\x20===','PAYMENT_COMPLETED','Response\x20Time:','amount','logWhiteDomainResponse','PAYMENT_FAILED','Invalid\x20JSON\x20response\x20from\x20Rapyd\x20API:\x20','Full\x20Error\x20Data:','PAYMENT_CANCELED','Incomplete\x20response:\x20missing\x20id\x20or\x20redirect_url','RapydService','===\x20RAPYD\x20API\x20ERROR\x20===','üá¨üáß\x20Country:\x20','Error\x20Code:','===\x20PARSED\x20RAPYD\x20RESPONSE\x20===','Request\x20Body\x20(Updated\x20Format):','\x20(always\x20GB\x20for\x20Rapyd)','logWhiteDomainRequest','Unknown\x20error\x20from\x20Rapyd\x20API','gb_mastercard_card','fromEntries','entries','EXP','merchant_reference_id','Response\x20data:','parse','status','===\x20RAPYD\x20SUCCESS\x20===','https://tesoft.uk/gateway/rapyd/','1281156AIffcL','https://tesoft.uk/gateway/fail.php?id=','===\x20RAPYD\x20API\x20REQUEST\x20(White\x20Domain\x20-\x20Updated\x20Format)\x20===','apiUrl','1271004uzGQto','now','Failed\x20to\x20create\x20Rapyd\x20payment\x20link:\x20Unknown\x20error','Status:','stringify','type','https://tesoft.uk/gateway/success.php?id=','log','HTTP\x20error!\x20status:\x20','Business\x20Error\x20(','CAN',',\x20body:\x20','Payment\x20Link\x20ID:','processWebhook','Rapyd\x20payment\x20verification\x20error:','json','UNKNOWN','HTTP\x20','Failed\x20to\x20verify\x20Rapyd\x20payment:\x20','error','HTTP\x20Status:','PENDING','ERR','FAILED','Redirect\x20URL:','stack','gb_visa_card','application/json','6394668pAihLv','Error\x20message:','error_code','Failed\x20to\x20create\x20Rapyd\x20payment\x20link:\x20','2fANZLN','verifyPayment','21dkfZrN','1261000yPpyGn','Status\x20Text:','üá¨üáß\x20Country\x20used:\x20','EXPIRED'];a42_0x547a=function(){return _0x20f3c2;};return a42_0x547a();}