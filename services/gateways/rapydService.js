'use strict';const a42_0x1509f3=a42_0x540b;function a42_0x44f6(){const _0x53b240=['Error\x20details:','toUpperCase','Redirect\x20URL:','createPaymentLink','Error\x20stack:','type','logWhiteDomainError','failure_message','Payment\x20Link\x20ID:','Status\x20Text:','NEW','stringify','10288TwXLDT','status','Error\x20message:','amount','logWhiteDomainResponse','text','ERR','errorCode','failureCode','Error\x20Code:','Raw\x20Response\x20Body:','5188836EMXxMD','loggerService','Headers:','6325sjABrF','PAID','):\x20','1834EfEhNj','ORDER:\x20','redirect_url','/v1/hosted/payment_links','cardLast4','===\x20RAPYD\x20API\x20ERROR\x20===','payment_method_data','===\x20RAPYD\x20API\x20REQUEST\x20(White\x20Domain\x20-\x20Updated\x20Format)\x20===','Missing\x20id\x20or\x20redirect_url\x20in\x20response','application/json','828705YwbGHU','failure_code','4435155kzkjHW','Error\x20Message:',',\x20failureMessage=','log','HTTP\x20error!\x20status:\x20','RapydService','Failed\x20to\x20verify\x20Rapyd\x20payment:\x20','POST','URL:','processWebhook','none','üá¨üáß\x20Using\x20GB\x20(Britain)\x20as\x20country\x20for\x20Rapyd\x20payment\x20link','error','../loggerService','7870QqhuwG','Rapyd\x20API\x20error:\x20','EXP','gb_visa_card','EXPIRED','2ukZBzJ','===\x20RAPYD\x20API\x20INCOMPLETE\x20RESPONSE\x20===','GET','now','üí≥\x20Payment\x20Methods:\x20gb_visa_card,\x20gb_mastercard_card','üá¨üáß\x20Country:\x20','last4','2494980njPKDU','paid','verifyPayment','\x20(always\x20GB\x20for\x20Rapyd)','Rapyd\x20API\x20error\x20(','payment_method_type','https://tesoft.uk/gateway/fail.php?id=','HTTP\x20','gb_mastercard_card','15cRnyrm','fromEntries','error_code','CAN','stack','logWhiteDomainRequest','===\x20RAPYD\x20SERVICE\x20ERROR\x20===','FAILED','currency','data','apiUrl','===\x20PARSED\x20RAPYD\x20RESPONSE\x20===','Failed\x20to\x20create\x20Rapyd\x20payment\x20link:\x20Unknown\x20error','entries','Incomplete\x20response:\x20missing\x20id\x20or\x20redirect_url','statusText','CLO','Response\x20Time:','PAYMENT_EXPIRED','üí•\x20Rapyd\x20failure\x20message:\x20','Failed\x20to\x20create\x20Rapyd\x20payment\x20link:\x20','281852uzyIiG','/v1/hosted/payment_links/','PAYMENT_COMPLETED','üîÑ\x20Rapyd\x20webhook\x20processed:\x20status=','parse','https://tesoft.uk/gateway/success.php?id=','PENDING','TesSoft\x20Payment\x20System/1.0','Business\x20Error\x20(','Unknown\x20error','Processing\x20Rapyd\x20webhook:','\x20(GB\x20-\x20Britain)','rapyd','Status:','message'];a42_0x44f6=function(){return _0x53b240;};return a42_0x44f6();}(function(_0x2d0467,_0xc55568){const _0x504a0e=a42_0x540b,_0x5d1fd3=_0x2d0467();while(!![]){try{const _0x293b7c=parseInt(_0x504a0e(0x205))/0x1+-parseInt(_0x504a0e(0x21a))/0x2*(parseInt(_0x504a0e(0x221))/0x3)+-parseInt(_0x504a0e(0x1cf))/0x4*(-parseInt(_0x504a0e(0x1ba))/0x5)+parseInt(_0x504a0e(0x1f5))/0x6+-parseInt(_0x504a0e(0x1fb))/0x7*(-parseInt(_0x504a0e(0x1ea))/0x8)+-parseInt(_0x504a0e(0x207))/0x9+-parseInt(_0x504a0e(0x215))/0xa*(parseInt(_0x504a0e(0x1f8))/0xb);if(_0x293b7c===_0xc55568)break;else _0x5d1fd3['push'](_0x5d1fd3['shift']());}catch(_0x24ee1a){_0x5d1fd3['push'](_0x5d1fd3['shift']());}}}(a42_0x44f6,0x717d4));Object['defineProperty'](exports,'__esModule',{'value':!![]}),exports[a42_0x1509f3(0x20c)]=void 0x0;const loggerService_1=require(a42_0x1509f3(0x214));class RapydService{constructor(){const _0x1f7fda=a42_0x1509f3;this[_0x1f7fda(0x1c4)]='https://tesoft.uk/gateway/rapyd/',console[_0x1f7fda(0x20a)]('üåê\x20Rapyd\x20service\x20initialized\x20with\x20white\x20domain\x20proxy');}async[a42_0x1509f3(0x1e1)](_0x5748cc){const _0x237120=a42_0x1509f3,{orderId:_0x21c6dd,orderName:_0x2d4baa,amount:_0x5c017e,currency:_0x54bffc,usage:_0x1747fc,maxPayments:_0x1179f0,successUrl:_0x5a97db,failUrl:_0x4bb4d6}=_0x5748cc,_0x4f3261=_0x54bffc[_0x237120(0x1df)](),_0x4d600a='GB';console[_0x237120(0x20a)](_0x237120(0x212));const _0x21de0e=_0x237120(0x1d4)+_0x21c6dd,_0x2ada87=_0x237120(0x1b7)+_0x21c6dd,_0x1ae715={'amount':_0x5c017e,'currency':_0x4f3261,'cancel_checkout_url':_0x2ada87,'complete_checkout_url':_0x21de0e,'complete_payment_url':_0x21de0e,'merchant_reference_id':_0x21c6dd,'description':_0x237120(0x1fc)+_0x21c6dd,'country':'GB','payment_method_types_include':[_0x237120(0x218),_0x237120(0x1b9)],'custom_elements':{'display_description':!![]}},_0x1e6f59=Date[_0x237120(0x21d)]();try{console[_0x237120(0x20a)](_0x237120(0x202)),console[_0x237120(0x20a)](_0x237120(0x20f),this[_0x237120(0x1c4)]),console['log']('Request\x20Body\x20(Updated\x20Format):',JSON['stringify'](_0x1ae715,null,0x2)),console[_0x237120(0x20a)](_0x237120(0x21f)+_0x4d600a+_0x237120(0x224)),console[_0x237120(0x20a)](_0x237120(0x21e)),loggerService_1[_0x237120(0x1f6)][_0x237120(0x1bf)](_0x237120(0x1db),_0x237120(0x1fe),_0x237120(0x20e),_0x1ae715);const _0x177a87=await fetch(this[_0x237120(0x1c4)],{'method':_0x237120(0x20e),'headers':{'Content-Type':_0x237120(0x204),'User-Agent':'TesSoft\x20Payment\x20System/1.0'},'body':JSON[_0x237120(0x1e9)](_0x1ae715)}),_0x21289b=Date['now']()-_0x1e6f59;console[_0x237120(0x20a)]('===\x20RAPYD\x20API\x20RESPONSE\x20(White\x20Domain)\x20==='),console['log'](_0x237120(0x1dc),_0x177a87[_0x237120(0x1eb)]),console[_0x237120(0x20a)](_0x237120(0x1e7),_0x177a87[_0x237120(0x1c9)]),console[_0x237120(0x20a)](_0x237120(0x1f7),Object[_0x237120(0x1bb)](_0x177a87['headers'][_0x237120(0x1c7)]())),console[_0x237120(0x20a)](_0x237120(0x1cb),_0x21289b+'ms');const _0x402481=await _0x177a87[_0x237120(0x1ef)]();console[_0x237120(0x20a)](_0x237120(0x1f4),_0x402481);if(!_0x177a87['ok']){console[_0x237120(0x213)](_0x237120(0x200)),console[_0x237120(0x213)]('HTTP\x20Status:',_0x177a87[_0x237120(0x1eb)]),console[_0x237120(0x213)]('Response\x20Body:',_0x402481),loggerService_1['loggerService'][_0x237120(0x1ee)](_0x237120(0x1db),_0x237120(0x1fe),_0x177a87[_0x237120(0x1eb)],_0x402481,_0x21289b),loggerService_1[_0x237120(0x1f6)][_0x237120(0x1e4)](_0x237120(0x1db),'/v1/hosted/payment_links',_0x237120(0x1b8)+_0x177a87[_0x237120(0x1eb)]+':\x20'+_0x402481);throw new Error(_0x237120(0x20b)+_0x177a87['status']+',\x20body:\x20'+_0x402481);}let _0x2bf491;try{_0x2bf491=JSON[_0x237120(0x1d3)](_0x402481);}catch(_0x2c90af){console[_0x237120(0x213)]('Failed\x20to\x20parse\x20JSON\x20response:',_0x2c90af),loggerService_1[_0x237120(0x1f6)][_0x237120(0x1e4)](_0x237120(0x1db),_0x237120(0x1fe),'JSON\x20Parse\x20Error:\x20'+_0x2c90af);throw new Error('Invalid\x20JSON\x20response\x20from\x20Rapyd\x20API:\x20'+_0x402481);}console[_0x237120(0x20a)](_0x237120(0x1c5)),console[_0x237120(0x20a)]('Parsed\x20Result:',JSON[_0x237120(0x1e9)](_0x2bf491,null,0x2)),loggerService_1[_0x237120(0x1f6)][_0x237120(0x1ee)]('rapyd',_0x237120(0x1fe),_0x177a87[_0x237120(0x1eb)],_0x2bf491,_0x21289b);if(_0x2bf491[_0x237120(0x1eb)]?.[_0x237120(0x1eb)]!=='SUCCESS'){const _0x54e6e5=_0x2bf491[_0x237120(0x1eb)]?.[_0x237120(0x1dd)]||'Unknown\x20error\x20from\x20Rapyd\x20API',_0x589141=_0x2bf491['status']?.[_0x237120(0x1bc)]||'UNKNOWN';console['error']('===\x20RAPYD\x20API\x20BUSINESS\x20ERROR\x20==='),console[_0x237120(0x213)](_0x237120(0x1f3),_0x589141),console['error'](_0x237120(0x208),_0x54e6e5),console[_0x237120(0x213)]('Full\x20Error\x20Data:',_0x2bf491[_0x237120(0x1eb)]),loggerService_1[_0x237120(0x1f6)][_0x237120(0x1e4)](_0x237120(0x1db),_0x237120(0x1fe),_0x237120(0x1d7)+_0x589141+_0x237120(0x1fa)+_0x54e6e5);throw new Error(_0x237120(0x225)+_0x589141+_0x237120(0x1fa)+_0x54e6e5);}if(!_0x2bf491[_0x237120(0x1c3)]?.['id']||!_0x2bf491['data']?.['redirect_url']){console[_0x237120(0x213)](_0x237120(0x21b)),console[_0x237120(0x213)](_0x237120(0x203)),console[_0x237120(0x213)]('Response\x20data:',_0x2bf491[_0x237120(0x1c3)]),loggerService_1[_0x237120(0x1f6)][_0x237120(0x1e4)](_0x237120(0x1db),_0x237120(0x1fe),_0x237120(0x1c8));throw new Error('Invalid\x20response\x20from\x20Rapyd\x20API:\x20missing\x20id\x20or\x20redirect_url');}return console['log']('===\x20RAPYD\x20SUCCESS\x20==='),console[_0x237120(0x20a)](_0x237120(0x1e6),_0x2bf491[_0x237120(0x1c3)]['id']),console[_0x237120(0x20a)](_0x237120(0x1e0),_0x2bf491['data'][_0x237120(0x1fd)]),console['log']('üá¨üáß\x20Country\x20used:\x20'+_0x4d600a+_0x237120(0x1da)),console[_0x237120(0x20a)](_0x237120(0x21e)),{'gateway_payment_id':_0x2bf491['data']['id'],'payment_url':_0x2bf491[_0x237120(0x1c3)][_0x237120(0x1fd)]};}catch(_0x4ae870){console[_0x237120(0x213)](_0x237120(0x1c0)),console['error'](_0x237120(0x1de),_0x4ae870),loggerService_1[_0x237120(0x1f6)][_0x237120(0x1e4)](_0x237120(0x1db),_0x237120(0x1fe),_0x4ae870);if(_0x4ae870 instanceof Error){console[_0x237120(0x213)](_0x237120(0x1ec),_0x4ae870[_0x237120(0x1dd)]),console[_0x237120(0x213)](_0x237120(0x1e2),_0x4ae870[_0x237120(0x1be)]);throw new Error(_0x237120(0x1ce)+_0x4ae870['message']);}throw new Error(_0x237120(0x1c6));}}async[a42_0x1509f3(0x223)](_0xd05c6c){const _0x1e2a92=a42_0x1509f3,_0x42627b=Date[_0x1e2a92(0x21d)]();try{loggerService_1[_0x1e2a92(0x1f6)][_0x1e2a92(0x1bf)](_0x1e2a92(0x1db),_0x1e2a92(0x1d0)+_0xd05c6c,_0x1e2a92(0x21c),{});const _0x2d8722=await fetch(this[_0x1e2a92(0x1c4)]+'/'+_0xd05c6c,{'method':_0x1e2a92(0x21c),'headers':{'Content-Type':_0x1e2a92(0x204),'User-Agent':_0x1e2a92(0x1d6)}}),_0xe1ef79=Date[_0x1e2a92(0x21d)]()-_0x42627b;if(!_0x2d8722['ok']){const _0x5b70d1=await _0x2d8722['text']();loggerService_1[_0x1e2a92(0x1f6)][_0x1e2a92(0x1ee)]('rapyd',_0x1e2a92(0x1d0)+_0xd05c6c,_0x2d8722[_0x1e2a92(0x1eb)],_0x5b70d1,_0xe1ef79);throw new Error(_0x1e2a92(0x20b)+_0x2d8722[_0x1e2a92(0x1eb)]);}const _0x4c9d0e=await _0x2d8722['json']();loggerService_1['loggerService'][_0x1e2a92(0x1ee)](_0x1e2a92(0x1db),_0x1e2a92(0x1d0)+_0xd05c6c,_0x2d8722[_0x1e2a92(0x1eb)],_0x4c9d0e,_0xe1ef79);if(_0x4c9d0e[_0x1e2a92(0x1eb)]?.[_0x1e2a92(0x1eb)]!=='SUCCESS'){loggerService_1[_0x1e2a92(0x1f6)]['logWhiteDomainError'](_0x1e2a92(0x1db),_0x1e2a92(0x1d0)+_0xd05c6c,_0x1e2a92(0x216)+(_0x4c9d0e[_0x1e2a92(0x1eb)]?.[_0x1e2a92(0x1dd)]||_0x1e2a92(0x1d8)));throw new Error(_0x1e2a92(0x216)+(_0x4c9d0e[_0x1e2a92(0x1eb)]?.['message']||_0x1e2a92(0x1d8)));}let _0xcf7982=_0x1e2a92(0x1d5);if(_0x4c9d0e[_0x1e2a92(0x1c3)]?.[_0x1e2a92(0x1eb)])switch(_0x4c9d0e[_0x1e2a92(0x1c3)][_0x1e2a92(0x1eb)][_0x1e2a92(0x1df)]()){case _0x1e2a92(0x1ca):_0xcf7982=_0x1e2a92(0x1f9);break;case _0x1e2a92(0x1bd):_0xcf7982=_0x1e2a92(0x1c1);break;case _0x1e2a92(0x217):_0xcf7982=_0x1e2a92(0x219);break;case _0x1e2a92(0x1f0):_0xcf7982=_0x1e2a92(0x1c1);break;case _0x1e2a92(0x1e8):case'ACT':default:_0xcf7982=_0x1e2a92(0x1d5);break;}return{'status':_0xcf7982,'amount':_0x4c9d0e[_0x1e2a92(0x1c3)]?.['amount'],'currency':_0x4c9d0e[_0x1e2a92(0x1c3)]?.[_0x1e2a92(0x1c2)]};}catch(_0x2525f8){console[_0x1e2a92(0x213)]('Rapyd\x20payment\x20verification\x20error:',_0x2525f8),loggerService_1[_0x1e2a92(0x1f6)]['logWhiteDomainError'](_0x1e2a92(0x1db),_0x1e2a92(0x1d0)+_0xd05c6c,_0x2525f8);throw new Error(_0x1e2a92(0x20d)+(_0x2525f8 instanceof Error?_0x2525f8['message']:'Unknown\x20error'));}}async[a42_0x1509f3(0x210)](_0x4a6c7d){const _0xe44536=a42_0x1509f3;console['log'](_0xe44536(0x1d9),_0x4a6c7d);let _0x3d6d0a=_0xe44536(0x1d5),_0x30699a;_0x4a6c7d[_0xe44536(0x1c3)]?.[_0xe44536(0x1e5)]&&(_0x30699a=_0x4a6c7d[_0xe44536(0x1c3)][_0xe44536(0x1e5)],console[_0xe44536(0x20a)](_0xe44536(0x1cd)+_0x30699a));switch(_0x4a6c7d[_0xe44536(0x1e3)]?.[_0xe44536(0x1df)]()){case _0xe44536(0x1d1):_0x4a6c7d[_0xe44536(0x1c3)]?.['paid']===!![]&&_0x4a6c7d['data']?.[_0xe44536(0x1eb)]===_0xe44536(0x1ca)?_0x3d6d0a=_0xe44536(0x1f9):_0x3d6d0a=_0xe44536(0x1d5);break;case'PAYMENT_CANCELED':_0x3d6d0a=_0xe44536(0x1c1);break;case _0xe44536(0x1cc):_0x3d6d0a=_0xe44536(0x219);break;case'PAYMENT_FAILED':_0x3d6d0a=_0xe44536(0x1c1);!_0x30699a&&_0x4a6c7d[_0xe44536(0x1c3)]?.[_0xe44536(0x1e5)]&&(_0x30699a=_0x4a6c7d[_0xe44536(0x1c3)][_0xe44536(0x1e5)]);break;default:switch(_0x4a6c7d[_0xe44536(0x1c3)]?.[_0xe44536(0x1eb)]?.[_0xe44536(0x1df)]()){case _0xe44536(0x1ca):_0x4a6c7d[_0xe44536(0x1c3)]?.[_0xe44536(0x222)]===!![]?_0x3d6d0a=_0xe44536(0x1f9):_0x3d6d0a='FAILED';break;case _0xe44536(0x1bd):_0x3d6d0a=_0xe44536(0x1c1);break;case'EXP':_0x3d6d0a=_0xe44536(0x219);break;case _0xe44536(0x1f0):_0x3d6d0a=_0xe44536(0x1c1);!_0x30699a&&_0x4a6c7d['data']?.[_0xe44536(0x1e5)]&&(_0x30699a=_0x4a6c7d[_0xe44536(0x1c3)][_0xe44536(0x1e5)]);break;case _0xe44536(0x1e8):case'ACT':default:_0x3d6d0a=_0xe44536(0x1d5);break;}break;}const _0x1c3f2b={};return _0x4a6c7d[_0xe44536(0x1c3)]?.[_0xe44536(0x201)]?.[_0xe44536(0x220)]&&(_0x1c3f2b[_0xe44536(0x1ff)]=_0x4a6c7d['data'][_0xe44536(0x201)][_0xe44536(0x220)]),_0x4a6c7d[_0xe44536(0x1c3)]?.[_0xe44536(0x1b6)]&&(_0x1c3f2b['paymentMethod']=_0x4a6c7d['data'][_0xe44536(0x1b6)]),_0x4a6c7d[_0xe44536(0x1c3)]?.[_0xe44536(0x1bc)]&&(_0x1c3f2b[_0xe44536(0x1f1)]=_0x4a6c7d[_0xe44536(0x1c3)]['error_code']),_0x4a6c7d[_0xe44536(0x1c3)]?.[_0xe44536(0x206)]&&(_0x1c3f2b[_0xe44536(0x1f2)]=_0x4a6c7d['data'][_0xe44536(0x206)]),console[_0xe44536(0x20a)](_0xe44536(0x1d2)+_0x3d6d0a+_0xe44536(0x209)+(_0x30699a||_0xe44536(0x211))),{'paymentId':_0x4a6c7d[_0xe44536(0x1c3)]?.['merchant_reference_id']||'','status':_0x3d6d0a,'amount':_0x4a6c7d['data']?.[_0xe44536(0x1ed)],'currency':_0x4a6c7d[_0xe44536(0x1c3)]?.[_0xe44536(0x1c2)],'failureMessage':_0x30699a,'additionalInfo':_0x1c3f2b};}}function a42_0x540b(_0x1e609f,_0x598738){const _0x44f648=a42_0x44f6();return a42_0x540b=function(_0x540bde,_0x37178b){_0x540bde=_0x540bde-0x1b6;let _0x40245d=_0x44f648[_0x540bde];return _0x40245d;},a42_0x540b(_0x1e609f,_0x598738);}exports[a42_0x1509f3(0x20c)]=RapydService;