'use strict';const a42_0x53fd0c=a42_0x15cc;(function(_0x5c1347,_0x5df6cb){const _0x46c848=a42_0x15cc,_0x252528=_0x5c1347();while(!![]){try{const _0xd73028=parseInt(_0x46c848(0x1ba))/0x1*(parseInt(_0x46c848(0x1da))/0x2)+-parseInt(_0x46c848(0x19c))/0x3*(parseInt(_0x46c848(0x193))/0x4)+parseInt(_0x46c848(0x17f))/0x5+-parseInt(_0x46c848(0x18a))/0x6*(parseInt(_0x46c848(0x1c9))/0x7)+parseInt(_0x46c848(0x1a1))/0x8*(parseInt(_0x46c848(0x1a8))/0x9)+-parseInt(_0x46c848(0x1c6))/0xa*(-parseInt(_0x46c848(0x1df))/0xb)+-parseInt(_0x46c848(0x190))/0xc;if(_0xd73028===_0x5df6cb)break;else _0x252528['push'](_0x252528['shift']());}catch(_0x1c1a14){_0x252528['push'](_0x252528['shift']());}}}(a42_0xbf71,0x233ff));function a42_0x15cc(_0x43616e,_0x274731){const _0xbf7111=a42_0xbf71();return a42_0x15cc=function(_0x15cc2b,_0x5eacdc){_0x15cc2b=_0x15cc2b-0x169;let _0x2f2423=_0xbf7111[_0x15cc2b];return _0x2f2423;},a42_0x15cc(_0x43616e,_0x274731);}Object[a42_0x53fd0c(0x1a2)](exports,a42_0x53fd0c(0x1bd),{'value':!![]}),exports[a42_0x53fd0c(0x1d5)]=void 0x0;const loggerService_1=require(a42_0x53fd0c(0x1c5));function a42_0xbf71(){const _0x2fc7a0=['===\x20RAPYD\x20API\x20INCOMPLETE\x20RESPONSE\x20===','parse','POST','../loggerService','10MSuQQH','Status:','failure_message','22183Yneqin','Incomplete\x20response:\x20missing\x20id\x20or\x20redirect_url','stringify','\x20(GB\x20-\x20Britain)','TesSoft\x20Payment\x20System/1.0','üåê\x20Rapyd\x20service\x20initialized\x20with\x20white\x20domain\x20proxy','Parsed\x20Result:','stack','/v1/hosted/payment_links','Missing\x20id\x20or\x20redirect_url\x20in\x20response','redirect_url','===\x20RAPYD\x20API\x20REQUEST\x20(White\x20Domain\x20-\x20Updated\x20Format)\x20===','RapydService','logWhiteDomainRequest','Processing\x20Rapyd\x20webhook:','PAYMENT_CANCELED',',\x20failureMessage=','734lfAWOr','Rapyd\x20payment\x20verification\x20error:','currency','UNKNOWN','EXP','3111185QRDZkS','/v1/hosted/payment_links/','Error\x20stack:','application/json','error_code','statusText','cardLast4','HTTP\x20','PENDING','paymentMethod','createPaymentLink','===\x20RAPYD\x20API\x20BUSINESS\x20ERROR\x20===','üí•\x20Rapyd\x20failure\x20message:\x20','processWebhook','Rapyd\x20API\x20error:\x20','PAID','data','errorCode','HTTP\x20Status:','CLO',',\x20body:\x20','logWhiteDomainResponse','amount','PAYMENT_EXPIRED','Payment\x20Link\x20ID:','status','PAYMENT_COMPLETED','721580NVupQd','payment_method_data','type','Request\x20Body\x20(Updated\x20Format):','ORDER:\x20','paid','https://tesoft.uk/gateway/rapyd/','SUCCESS','Error\x20Message:','Invalid\x20JSON\x20response\x20from\x20Rapyd\x20API:\x20','none','366xmHbmg','Error\x20message:','HTTP\x20error!\x20status:\x20','headers','===\x20RAPYD\x20API\x20RESPONSE\x20(White\x20Domain)\x20===','text','5418828ItpUOt','gb_visa_card','Failed\x20to\x20create\x20Rapyd\x20payment\x20link:\x20','4TOAAtu','Status\x20Text:','URL:','Unknown\x20error\x20from\x20Rapyd\x20API','json','toUpperCase','CAN','===\x20RAPYD\x20API\x20ERROR\x20===','ERR','156843QgLtVY','Response\x20data:','now','Unknown\x20error','Failed\x20to\x20verify\x20Rapyd\x20payment:\x20','1136424Pnwtrl','defineProperty','PAYMENT_FAILED','===\x20RAPYD\x20SUCCESS\x20===','payment_method_type','apiUrl','last4','18MOWIUF','Response\x20Body:','FAILED','Rapyd\x20API\x20error\x20(','rapyd','message','logWhiteDomainError','Headers:','Error\x20Code:','Redirect\x20URL:','):\x20','loggerService','gb_mastercard_card','EXPIRED','GET','https://tesoft.uk/gateway/success.php?id=','üí≥\x20Payment\x20Methods:\x20gb_visa_card,\x20gb_mastercard_card','Full\x20Error\x20Data:','355RkODyg','error','merchant_reference_id','__esModule','failure_code','NEW','log','fromEntries'];a42_0xbf71=function(){return _0x2fc7a0;};return a42_0xbf71();}class RapydService{constructor(){const _0xd4b0f5=a42_0x53fd0c;this['apiUrl']=_0xd4b0f5(0x185),console['log'](_0xd4b0f5(0x1ce));}async[a42_0x53fd0c(0x16e)](_0x35b08c){const _0x135428=a42_0x53fd0c,{orderId:_0x1a4773,orderName:_0x4198b2,amount:_0x457179,currency:_0x4d7b2c,usage:_0x5bde3d,maxPayments:_0x2856de,successUrl:_0x1cd045,failUrl:_0x3b1efe}=_0x35b08c,_0x5d1333=_0x4d7b2c['toUpperCase'](),_0x5e731c='GB';console[_0x135428(0x1c0)]('üá¨üáß\x20Using\x20GB\x20(Britain)\x20as\x20country\x20for\x20Rapyd\x20payment\x20link');const _0x3f61ca=_0x135428(0x1b7)+_0x1a4773,_0x53387b='https://tesoft.uk/gateway/fail.php?id='+_0x1a4773,_0x1faad5={'amount':_0x457179,'currency':_0x5d1333,'cancel_checkout_url':_0x53387b,'complete_checkout_url':_0x3f61ca,'complete_payment_url':_0x3f61ca,'merchant_reference_id':_0x1a4773,'description':_0x135428(0x183)+_0x1a4773,'country':'GB','payment_method_types_include':[_0x135428(0x191),_0x135428(0x1b4)],'custom_elements':{'display_description':!![]}},_0x254045=Date[_0x135428(0x19e)]();try{console[_0x135428(0x1c0)](_0x135428(0x1d4)),console['log'](_0x135428(0x195),this[_0x135428(0x1a6)]),console[_0x135428(0x1c0)](_0x135428(0x182),JSON['stringify'](_0x1faad5,null,0x2)),console[_0x135428(0x1c0)]('üá¨üáß\x20Country:\x20'+_0x5e731c+'\x20(always\x20GB\x20for\x20Rapyd)'),console['log'](_0x135428(0x1b8)),loggerService_1[_0x135428(0x1b3)][_0x135428(0x1d6)](_0x135428(0x1ac),_0x135428(0x1d1),'POST',_0x1faad5);const _0x5047d3=await fetch(this[_0x135428(0x1a6)],{'method':_0x135428(0x1c4),'headers':{'Content-Type':_0x135428(0x1e2),'User-Agent':_0x135428(0x1cd)},'body':JSON['stringify'](_0x1faad5)}),_0x1584b6=Date[_0x135428(0x19e)]()-_0x254045;console['log'](_0x135428(0x18e)),console['log'](_0x135428(0x1c7),_0x5047d3[_0x135428(0x17d)]),console['log'](_0x135428(0x194),_0x5047d3[_0x135428(0x169)]),console[_0x135428(0x1c0)](_0x135428(0x1af),Object[_0x135428(0x1c1)](_0x5047d3[_0x135428(0x18d)]['entries']())),console[_0x135428(0x1c0)]('Response\x20Time:',_0x1584b6+'ms');const _0x3de0a4=await _0x5047d3['text']();console[_0x135428(0x1c0)]('Raw\x20Response\x20Body:',_0x3de0a4);if(!_0x5047d3['ok']){console[_0x135428(0x1bb)](_0x135428(0x19a)),console[_0x135428(0x1bb)](_0x135428(0x176),_0x5047d3['status']),console[_0x135428(0x1bb)](_0x135428(0x1a9),_0x3de0a4),loggerService_1[_0x135428(0x1b3)][_0x135428(0x179)]('rapyd','/v1/hosted/payment_links',_0x5047d3[_0x135428(0x17d)],_0x3de0a4,_0x1584b6),loggerService_1[_0x135428(0x1b3)][_0x135428(0x1ae)](_0x135428(0x1ac),'/v1/hosted/payment_links',_0x135428(0x16b)+_0x5047d3[_0x135428(0x17d)]+':\x20'+_0x3de0a4);throw new Error('HTTP\x20error!\x20status:\x20'+_0x5047d3[_0x135428(0x17d)]+_0x135428(0x178)+_0x3de0a4);}let _0xc6d4c;try{_0xc6d4c=JSON[_0x135428(0x1c3)](_0x3de0a4);}catch(_0x520862){console[_0x135428(0x1bb)]('Failed\x20to\x20parse\x20JSON\x20response:',_0x520862),loggerService_1[_0x135428(0x1b3)][_0x135428(0x1ae)](_0x135428(0x1ac),_0x135428(0x1d1),'JSON\x20Parse\x20Error:\x20'+_0x520862);throw new Error(_0x135428(0x188)+_0x3de0a4);}console[_0x135428(0x1c0)]('===\x20PARSED\x20RAPYD\x20RESPONSE\x20==='),console['log'](_0x135428(0x1cf),JSON[_0x135428(0x1cb)](_0xc6d4c,null,0x2)),loggerService_1[_0x135428(0x1b3)][_0x135428(0x179)]('rapyd',_0x135428(0x1d1),_0x5047d3[_0x135428(0x17d)],_0xc6d4c,_0x1584b6);if(_0xc6d4c[_0x135428(0x17d)]?.[_0x135428(0x17d)]!==_0x135428(0x186)){const _0x26a748=_0xc6d4c[_0x135428(0x17d)]?.['message']||_0x135428(0x196),_0xdeed99=_0xc6d4c[_0x135428(0x17d)]?.[_0x135428(0x1e3)]||_0x135428(0x1dd);console[_0x135428(0x1bb)](_0x135428(0x16f)),console[_0x135428(0x1bb)](_0x135428(0x1b0),_0xdeed99),console[_0x135428(0x1bb)](_0x135428(0x187),_0x26a748),console[_0x135428(0x1bb)](_0x135428(0x1b9),_0xc6d4c[_0x135428(0x17d)]),loggerService_1[_0x135428(0x1b3)]['logWhiteDomainError']('rapyd',_0x135428(0x1d1),'Business\x20Error\x20('+_0xdeed99+_0x135428(0x1b2)+_0x26a748);throw new Error(_0x135428(0x1ab)+_0xdeed99+_0x135428(0x1b2)+_0x26a748);}if(!_0xc6d4c[_0x135428(0x174)]?.['id']||!_0xc6d4c[_0x135428(0x174)]?.[_0x135428(0x1d3)]){console['error'](_0x135428(0x1c2)),console[_0x135428(0x1bb)](_0x135428(0x1d2)),console['error'](_0x135428(0x19d),_0xc6d4c['data']),loggerService_1[_0x135428(0x1b3)]['logWhiteDomainError'](_0x135428(0x1ac),_0x135428(0x1d1),_0x135428(0x1ca));throw new Error('Invalid\x20response\x20from\x20Rapyd\x20API:\x20missing\x20id\x20or\x20redirect_url');}return console['log'](_0x135428(0x1a4)),console[_0x135428(0x1c0)](_0x135428(0x17c),_0xc6d4c['data']['id']),console['log'](_0x135428(0x1b1),_0xc6d4c[_0x135428(0x174)][_0x135428(0x1d3)]),console[_0x135428(0x1c0)]('üá¨üáß\x20Country\x20used:\x20'+_0x5e731c+_0x135428(0x1cc)),console[_0x135428(0x1c0)](_0x135428(0x1b8)),{'gateway_payment_id':_0xc6d4c[_0x135428(0x174)]['id'],'payment_url':_0xc6d4c[_0x135428(0x174)][_0x135428(0x1d3)]};}catch(_0x4a3acb){console[_0x135428(0x1bb)]('===\x20RAPYD\x20SERVICE\x20ERROR\x20==='),console[_0x135428(0x1bb)]('Error\x20details:',_0x4a3acb),loggerService_1[_0x135428(0x1b3)][_0x135428(0x1ae)](_0x135428(0x1ac),_0x135428(0x1d1),_0x4a3acb);if(_0x4a3acb instanceof Error){console[_0x135428(0x1bb)](_0x135428(0x18b),_0x4a3acb[_0x135428(0x1ad)]),console[_0x135428(0x1bb)](_0x135428(0x1e1),_0x4a3acb[_0x135428(0x1d0)]);throw new Error(_0x135428(0x192)+_0x4a3acb[_0x135428(0x1ad)]);}throw new Error('Failed\x20to\x20create\x20Rapyd\x20payment\x20link:\x20Unknown\x20error');}}async['verifyPayment'](_0x30e692){const _0x551b8d=a42_0x53fd0c,_0x55ab60=Date[_0x551b8d(0x19e)]();try{loggerService_1[_0x551b8d(0x1b3)][_0x551b8d(0x1d6)](_0x551b8d(0x1ac),_0x551b8d(0x1e0)+_0x30e692,'GET',{});const _0x40ce5e=await fetch(this[_0x551b8d(0x1a6)]+'/'+_0x30e692,{'method':_0x551b8d(0x1b6),'headers':{'Content-Type':_0x551b8d(0x1e2),'User-Agent':_0x551b8d(0x1cd)}}),_0x16599f=Date[_0x551b8d(0x19e)]()-_0x55ab60;if(!_0x40ce5e['ok']){const _0x2fac8e=await _0x40ce5e[_0x551b8d(0x18f)]();loggerService_1[_0x551b8d(0x1b3)]['logWhiteDomainResponse'](_0x551b8d(0x1ac),_0x551b8d(0x1e0)+_0x30e692,_0x40ce5e[_0x551b8d(0x17d)],_0x2fac8e,_0x16599f);throw new Error(_0x551b8d(0x18c)+_0x40ce5e[_0x551b8d(0x17d)]);}const _0x68e058=await _0x40ce5e[_0x551b8d(0x197)]();loggerService_1[_0x551b8d(0x1b3)]['logWhiteDomainResponse'](_0x551b8d(0x1ac),_0x551b8d(0x1e0)+_0x30e692,_0x40ce5e['status'],_0x68e058,_0x16599f);if(_0x68e058[_0x551b8d(0x17d)]?.[_0x551b8d(0x17d)]!==_0x551b8d(0x186)){loggerService_1[_0x551b8d(0x1b3)][_0x551b8d(0x1ae)]('rapyd',_0x551b8d(0x1e0)+_0x30e692,_0x551b8d(0x172)+(_0x68e058['status']?.[_0x551b8d(0x1ad)]||'Unknown\x20error'));throw new Error(_0x551b8d(0x172)+(_0x68e058['status']?.[_0x551b8d(0x1ad)]||_0x551b8d(0x19f)));}let _0x256787='PENDING';if(_0x68e058[_0x551b8d(0x174)]?.[_0x551b8d(0x17d)])switch(_0x68e058[_0x551b8d(0x174)][_0x551b8d(0x17d)][_0x551b8d(0x198)]()){case _0x551b8d(0x177):_0x256787=_0x551b8d(0x173);break;case'CAN':_0x256787='FAILED';break;case _0x551b8d(0x1de):_0x256787='EXPIRED';break;case _0x551b8d(0x19b):_0x256787=_0x551b8d(0x1aa);break;case _0x551b8d(0x1bf):case'ACT':default:_0x256787=_0x551b8d(0x16c);break;}return{'status':_0x256787,'amount':_0x68e058[_0x551b8d(0x174)]?.['amount'],'currency':_0x68e058[_0x551b8d(0x174)]?.[_0x551b8d(0x1dc)]};}catch(_0x29c99e){console['error'](_0x551b8d(0x1db),_0x29c99e),loggerService_1[_0x551b8d(0x1b3)]['logWhiteDomainError'](_0x551b8d(0x1ac),'/v1/hosted/payment_links/'+_0x30e692,_0x29c99e);throw new Error(_0x551b8d(0x1a0)+(_0x29c99e instanceof Error?_0x29c99e[_0x551b8d(0x1ad)]:_0x551b8d(0x19f)));}}async[a42_0x53fd0c(0x171)](_0x309ff3){const _0x291749=a42_0x53fd0c;console[_0x291749(0x1c0)](_0x291749(0x1d7),_0x309ff3);let _0x42d8d2=_0x291749(0x16c),_0x344fad;_0x309ff3[_0x291749(0x174)]?.['failure_message']&&(_0x344fad=_0x309ff3['data'][_0x291749(0x1c8)],console[_0x291749(0x1c0)](_0x291749(0x170)+_0x344fad));switch(_0x309ff3[_0x291749(0x181)]?.['toUpperCase']()){case _0x291749(0x17e):_0x309ff3[_0x291749(0x174)]?.[_0x291749(0x184)]===!![]&&_0x309ff3[_0x291749(0x174)]?.[_0x291749(0x17d)]==='CLO'?_0x42d8d2=_0x291749(0x173):_0x42d8d2=_0x291749(0x16c);break;case _0x291749(0x1d8):_0x42d8d2='FAILED';break;case _0x291749(0x17b):_0x42d8d2=_0x291749(0x1b5);break;case _0x291749(0x1a3):_0x42d8d2=_0x291749(0x1aa);!_0x344fad&&_0x309ff3[_0x291749(0x174)]?.['failure_message']&&(_0x344fad=_0x309ff3['data'][_0x291749(0x1c8)]);break;default:switch(_0x309ff3[_0x291749(0x174)]?.[_0x291749(0x17d)]?.[_0x291749(0x198)]()){case _0x291749(0x177):_0x309ff3[_0x291749(0x174)]?.[_0x291749(0x184)]===!![]?_0x42d8d2=_0x291749(0x173):_0x42d8d2=_0x291749(0x1aa);break;case _0x291749(0x199):_0x42d8d2=_0x291749(0x1aa);break;case _0x291749(0x1de):_0x42d8d2=_0x291749(0x1b5);break;case _0x291749(0x19b):_0x42d8d2='FAILED';!_0x344fad&&_0x309ff3['data']?.['failure_message']&&(_0x344fad=_0x309ff3[_0x291749(0x174)][_0x291749(0x1c8)]);break;case'NEW':case'ACT':default:_0x42d8d2=_0x291749(0x16c);break;}break;}const _0x551c9c={};return _0x309ff3[_0x291749(0x174)]?.[_0x291749(0x180)]?.['last4']&&(_0x551c9c[_0x291749(0x16a)]=_0x309ff3[_0x291749(0x174)][_0x291749(0x180)][_0x291749(0x1a7)]),_0x309ff3['data']?.['payment_method_type']&&(_0x551c9c[_0x291749(0x16d)]=_0x309ff3[_0x291749(0x174)][_0x291749(0x1a5)]),_0x309ff3[_0x291749(0x174)]?.['error_code']&&(_0x551c9c[_0x291749(0x175)]=_0x309ff3['data']['error_code']),_0x309ff3['data']?.[_0x291749(0x1be)]&&(_0x551c9c['failureCode']=_0x309ff3[_0x291749(0x174)][_0x291749(0x1be)]),console[_0x291749(0x1c0)]('üîÑ\x20Rapyd\x20webhook\x20processed:\x20status='+_0x42d8d2+_0x291749(0x1d9)+(_0x344fad||_0x291749(0x189))),{'paymentId':_0x309ff3['data']?.[_0x291749(0x1bc)]||'','status':_0x42d8d2,'amount':_0x309ff3['data']?.[_0x291749(0x17a)],'currency':_0x309ff3[_0x291749(0x174)]?.[_0x291749(0x1dc)],'failureMessage':_0x344fad,'additionalInfo':_0x551c9c};}}exports[a42_0x53fd0c(0x1d5)]=RapydService;