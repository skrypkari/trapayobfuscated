'use strict';const a46_0x4e7c36=a46_0x4dab;function a46_0x5f2a(){const _0x1fddbf=['PAYMENT_FAILED','HTTP\x20error!\x20status:\x20','stack','ERR','23PxiKzc','ACT','POST','===\x20RAPYD\x20API\x20RESPONSE\x20(White\x20Domain)\x20===','last4','failure_code','üá¨üáß\x20Using\x20GB\x20(Britain)\x20as\x20country\x20for\x20Rapyd\x20payment\x20link','===\x20RAPYD\x20API\x20ERROR\x20===','data','Failed\x20to\x20verify\x20Rapyd\x20payment:\x20','gb_mastercard_card','TesSoft\x20Payment\x20System/1.0','):\x20','Full\x20Error\x20Data:','===\x20RAPYD\x20SERVICE\x20ERROR\x20===','Headers:','ORDER:\x20','Failed\x20to\x20create\x20Rapyd\x20payment\x20link:\x20Unknown\x20error','Response\x20Time:','createPaymentLink','Response\x20Body:','fromEntries','now','cardLast4','EXP','8PuYAUv','payment_method_data','CLO','Rapyd\x20API\x20error:\x20','status','Unknown\x20error\x20from\x20Rapyd\x20API','application/json','../loggerService','rapyd','11930256XouRlN','309489OBCUEc','Payment\x20Link\x20ID:','SUCCESS','HTTP\x20Status:','Error\x20stack:','13WyDzNC','https://tesoft.uk/gateway/success.php?id=','Failed\x20to\x20create\x20Rapyd\x20payment\x20link:\x20','verifyPayment','üí•\x20Rapyd\x20failure\x20message:\x20','5964277VvtvSM','redirect_url','Parsed\x20Result:','Status:','stringify',',\x20body:\x20','__esModule','/v1/hosted/payment_links','16CZkTPi','Rapyd\x20API\x20error\x20(','https://tesoft.uk/gateway/rapyd/','GET','65xdnwSw','740526FiVNRI','https://tesoft.uk/gateway/fail.php?id=','JSON\x20Parse\x20Error:\x20','===\x20RAPYD\x20API\x20REQUEST\x20(White\x20Domain\x20-\x20Updated\x20Format)\x20===','Response\x20data:','/v1/hosted/payment_links/','payment_method_type','loggerService','Processing\x20Rapyd\x20webhook:','failureCode','log','EXPIRED','toUpperCase','logWhiteDomainResponse','üîÑ\x20Rapyd\x20webhook\x20processed:\x20status=','paymentMethod','üí≥\x20Payment\x20Methods:\x20gb_visa_card,\x20gb_mastercard_card','parse','PAID','===\x20RAPYD\x20API\x20INCOMPLETE\x20RESPONSE\x20===','6960762wsuiUF','statusText','PENDING','Incomplete\x20response:\x20missing\x20id\x20or\x20redirect_url','paid','error','Invalid\x20response\x20from\x20Rapyd\x20API:\x20missing\x20id\x20or\x20redirect_url','Unknown\x20error','NEW','Status\x20Text:','8421357vVeDEf','apiUrl','amount','logWhiteDomainError','text','10lVxmfV','FAILED','failure_message','RapydService','===\x20RAPYD\x20API\x20BUSINESS\x20ERROR\x20===','HTTP\x20','entries','merchant_reference_id','error_code','===\x20RAPYD\x20SUCCESS\x20===','Invalid\x20JSON\x20response\x20from\x20Rapyd\x20API:\x20','none','currency','message','üá¨üáß\x20Country:\x20','CAN','72256JWtxns'];a46_0x5f2a=function(){return _0x1fddbf;};return a46_0x5f2a();}(function(_0x4c6aeb,_0x45e5d8){const _0x47fcaf=a46_0x4dab,_0x81905a=_0x4c6aeb();while(!![]){try{const _0x5374f9=parseInt(_0x47fcaf(0x204))/0x1*(parseInt(_0x47fcaf(0x1ff))/0x2)+-parseInt(_0x47fcaf(0x227))/0x3*(parseInt(_0x47fcaf(0x239))/0x4)+parseInt(_0x47fcaf(0x23d))/0x5*(parseInt(_0x47fcaf(0x23e))/0x6)+parseInt(_0x47fcaf(0x1ea))/0x7*(parseInt(_0x47fcaf(0x21d))/0x8)+-parseInt(_0x47fcaf(0x1e0))/0x9+-parseInt(_0x47fcaf(0x1ef))/0xa*(parseInt(_0x47fcaf(0x231))/0xb)+-parseInt(_0x47fcaf(0x226))/0xc*(parseInt(_0x47fcaf(0x22c))/0xd);if(_0x5374f9===_0x45e5d8)break;else _0x81905a['push'](_0x81905a['shift']());}catch(_0xbee8d1){_0x81905a['push'](_0x81905a['shift']());}}}(a46_0x5f2a,0xdfa23));Object['defineProperty'](exports,a46_0x4e7c36(0x237),{'value':!![]}),exports[a46_0x4e7c36(0x1f2)]=void 0x0;const loggerService_1=require(a46_0x4e7c36(0x224));class RapydService{constructor(){const _0x448c43=a46_0x4e7c36;this['apiUrl']=_0x448c43(0x23b),console['log']('üåê\x20Rapyd\x20service\x20initialized\x20with\x20white\x20domain\x20proxy');}async[a46_0x4e7c36(0x217)](_0x2cf5fc){const _0x50d4ff=a46_0x4e7c36,{orderId:_0x305751,orderName:_0x18d10f,amount:_0x151961,currency:_0x40140a,usage:_0x2a40f0,maxPayments:_0x5c97a4,successUrl:_0x5c9277,failUrl:_0x5302f3}=_0x2cf5fc,_0x3223dd=_0x40140a[_0x50d4ff(0x1d8)](),_0x3b9b2c='GB';console[_0x50d4ff(0x1d6)](_0x50d4ff(0x20a));const _0x4dbb2a=_0x50d4ff(0x22d)+_0x305751,_0xf43efd=_0x50d4ff(0x23f)+_0x305751,_0x1ab283={'amount':_0x151961,'currency':_0x3223dd,'cancel_checkout_url':_0xf43efd,'complete_checkout_url':_0x4dbb2a,'complete_payment_url':_0x4dbb2a,'merchant_reference_id':_0x305751,'description':_0x50d4ff(0x214)+_0x305751,'country':'GB','payment_method_types_include':['gb_visa_card',_0x50d4ff(0x20e)],'custom_elements':{'display_description':!![]}},_0x3d7cab=Date[_0x50d4ff(0x21a)]();try{console['log'](_0x50d4ff(0x241)),console[_0x50d4ff(0x1d6)]('URL:',this[_0x50d4ff(0x1eb)]),console[_0x50d4ff(0x1d6)]('Request\x20Body\x20(Updated\x20Format):',JSON[_0x50d4ff(0x235)](_0x1ab283,null,0x2)),console[_0x50d4ff(0x1d6)](_0x50d4ff(0x1fd)+_0x3b9b2c+'\x20(always\x20GB\x20for\x20Rapyd)'),console[_0x50d4ff(0x1d6)](_0x50d4ff(0x1dc)),loggerService_1['loggerService']['logWhiteDomainRequest']('rapyd','/v1/hosted/payment_links',_0x50d4ff(0x206),_0x1ab283);const _0xd85aa5=await fetch(this['apiUrl'],{'method':_0x50d4ff(0x206),'headers':{'Content-Type':_0x50d4ff(0x223),'User-Agent':_0x50d4ff(0x20f)},'body':JSON['stringify'](_0x1ab283)}),_0x47507a=Date[_0x50d4ff(0x21a)]()-_0x3d7cab;console[_0x50d4ff(0x1d6)](_0x50d4ff(0x207)),console[_0x50d4ff(0x1d6)](_0x50d4ff(0x234),_0xd85aa5[_0x50d4ff(0x221)]),console[_0x50d4ff(0x1d6)](_0x50d4ff(0x1e9),_0xd85aa5[_0x50d4ff(0x1e1)]),console['log'](_0x50d4ff(0x213),Object[_0x50d4ff(0x219)](_0xd85aa5['headers'][_0x50d4ff(0x1f5)]())),console['log'](_0x50d4ff(0x216),_0x47507a+'ms');const _0x27b02b=await _0xd85aa5['text']();console['log']('Raw\x20Response\x20Body:',_0x27b02b);if(!_0xd85aa5['ok']){console[_0x50d4ff(0x1e5)](_0x50d4ff(0x20b)),console[_0x50d4ff(0x1e5)](_0x50d4ff(0x22a),_0xd85aa5['status']),console[_0x50d4ff(0x1e5)](_0x50d4ff(0x218),_0x27b02b),loggerService_1[_0x50d4ff(0x1d3)][_0x50d4ff(0x1d9)](_0x50d4ff(0x225),'/v1/hosted/payment_links',_0xd85aa5[_0x50d4ff(0x221)],_0x27b02b,_0x47507a),loggerService_1[_0x50d4ff(0x1d3)][_0x50d4ff(0x1ed)]('rapyd',_0x50d4ff(0x238),_0x50d4ff(0x1f4)+_0xd85aa5[_0x50d4ff(0x221)]+':\x20'+_0x27b02b);throw new Error(_0x50d4ff(0x201)+_0xd85aa5[_0x50d4ff(0x221)]+_0x50d4ff(0x236)+_0x27b02b);}let _0x409710;try{_0x409710=JSON[_0x50d4ff(0x1dd)](_0x27b02b);}catch(_0xad740f){console[_0x50d4ff(0x1e5)]('Failed\x20to\x20parse\x20JSON\x20response:',_0xad740f),loggerService_1[_0x50d4ff(0x1d3)][_0x50d4ff(0x1ed)](_0x50d4ff(0x225),_0x50d4ff(0x238),_0x50d4ff(0x240)+_0xad740f);throw new Error(_0x50d4ff(0x1f9)+_0x27b02b);}console[_0x50d4ff(0x1d6)]('===\x20PARSED\x20RAPYD\x20RESPONSE\x20==='),console[_0x50d4ff(0x1d6)](_0x50d4ff(0x233),JSON[_0x50d4ff(0x235)](_0x409710,null,0x2)),loggerService_1[_0x50d4ff(0x1d3)][_0x50d4ff(0x1d9)](_0x50d4ff(0x225),_0x50d4ff(0x238),_0xd85aa5[_0x50d4ff(0x221)],_0x409710,_0x47507a);if(_0x409710[_0x50d4ff(0x221)]?.[_0x50d4ff(0x221)]!=='SUCCESS'){const _0x56050f=_0x409710['status']?.[_0x50d4ff(0x1fc)]||_0x50d4ff(0x222),_0x2459a0=_0x409710[_0x50d4ff(0x221)]?.['error_code']||'UNKNOWN';console[_0x50d4ff(0x1e5)](_0x50d4ff(0x1f3)),console[_0x50d4ff(0x1e5)]('Error\x20Code:',_0x2459a0),console[_0x50d4ff(0x1e5)]('Error\x20Message:',_0x56050f),console[_0x50d4ff(0x1e5)](_0x50d4ff(0x211),_0x409710[_0x50d4ff(0x221)]),loggerService_1['loggerService']['logWhiteDomainError'](_0x50d4ff(0x225),_0x50d4ff(0x238),'Business\x20Error\x20('+_0x2459a0+'):\x20'+_0x56050f);throw new Error(_0x50d4ff(0x23a)+_0x2459a0+_0x50d4ff(0x210)+_0x56050f);}if(!_0x409710[_0x50d4ff(0x20c)]?.['id']||!_0x409710[_0x50d4ff(0x20c)]?.[_0x50d4ff(0x232)]){console['error'](_0x50d4ff(0x1df)),console['error']('Missing\x20id\x20or\x20redirect_url\x20in\x20response'),console[_0x50d4ff(0x1e5)](_0x50d4ff(0x1d0),_0x409710[_0x50d4ff(0x20c)]),loggerService_1[_0x50d4ff(0x1d3)][_0x50d4ff(0x1ed)]('rapyd',_0x50d4ff(0x238),_0x50d4ff(0x1e3));throw new Error(_0x50d4ff(0x1e6));}return console[_0x50d4ff(0x1d6)](_0x50d4ff(0x1f8)),console[_0x50d4ff(0x1d6)](_0x50d4ff(0x228),_0x409710['data']['id']),console['log']('Redirect\x20URL:',_0x409710[_0x50d4ff(0x20c)][_0x50d4ff(0x232)]),console[_0x50d4ff(0x1d6)]('üá¨üáß\x20Country\x20used:\x20'+_0x3b9b2c+'\x20(GB\x20-\x20Britain)'),console[_0x50d4ff(0x1d6)](_0x50d4ff(0x1dc)),{'gateway_payment_id':_0x409710[_0x50d4ff(0x20c)]['id'],'payment_url':_0x409710['data']['redirect_url']};}catch(_0x3cc5db){console[_0x50d4ff(0x1e5)](_0x50d4ff(0x212)),console[_0x50d4ff(0x1e5)]('Error\x20details:',_0x3cc5db),loggerService_1[_0x50d4ff(0x1d3)][_0x50d4ff(0x1ed)](_0x50d4ff(0x225),_0x50d4ff(0x238),_0x3cc5db);if(_0x3cc5db instanceof Error){console['error']('Error\x20message:',_0x3cc5db[_0x50d4ff(0x1fc)]),console['error'](_0x50d4ff(0x22b),_0x3cc5db[_0x50d4ff(0x202)]);throw new Error(_0x50d4ff(0x22e)+_0x3cc5db['message']);}throw new Error(_0x50d4ff(0x215));}}async[a46_0x4e7c36(0x22f)](_0x56a5b1){const _0xbc7fc1=a46_0x4e7c36,_0x5b7bd0=Date[_0xbc7fc1(0x21a)]();try{loggerService_1['loggerService']['logWhiteDomainRequest']('rapyd',_0xbc7fc1(0x1d1)+_0x56a5b1,_0xbc7fc1(0x23c),{});const _0x117c32=await fetch(this[_0xbc7fc1(0x1eb)]+'/'+_0x56a5b1,{'method':_0xbc7fc1(0x23c),'headers':{'Content-Type':_0xbc7fc1(0x223),'User-Agent':_0xbc7fc1(0x20f)}}),_0x4646e0=Date[_0xbc7fc1(0x21a)]()-_0x5b7bd0;if(!_0x117c32['ok']){const _0x24ce3b=await _0x117c32[_0xbc7fc1(0x1ee)]();loggerService_1[_0xbc7fc1(0x1d3)][_0xbc7fc1(0x1d9)](_0xbc7fc1(0x225),_0xbc7fc1(0x1d1)+_0x56a5b1,_0x117c32['status'],_0x24ce3b,_0x4646e0);throw new Error(_0xbc7fc1(0x201)+_0x117c32[_0xbc7fc1(0x221)]);}const _0x2362d4=await _0x117c32['json']();loggerService_1[_0xbc7fc1(0x1d3)][_0xbc7fc1(0x1d9)](_0xbc7fc1(0x225),'/v1/hosted/payment_links/'+_0x56a5b1,_0x117c32[_0xbc7fc1(0x221)],_0x2362d4,_0x4646e0);if(_0x2362d4[_0xbc7fc1(0x221)]?.[_0xbc7fc1(0x221)]!==_0xbc7fc1(0x229)){loggerService_1[_0xbc7fc1(0x1d3)]['logWhiteDomainError'](_0xbc7fc1(0x225),'/v1/hosted/payment_links/'+_0x56a5b1,_0xbc7fc1(0x220)+(_0x2362d4[_0xbc7fc1(0x221)]?.[_0xbc7fc1(0x1fc)]||_0xbc7fc1(0x1e7)));throw new Error(_0xbc7fc1(0x220)+(_0x2362d4['status']?.[_0xbc7fc1(0x1fc)]||_0xbc7fc1(0x1e7)));}let _0x55f02a=_0xbc7fc1(0x1e2);if(_0x2362d4[_0xbc7fc1(0x20c)]?.[_0xbc7fc1(0x221)])switch(_0x2362d4['data']['status'][_0xbc7fc1(0x1d8)]()){case'CLO':_0x55f02a=_0xbc7fc1(0x1de);break;case _0xbc7fc1(0x1fe):_0x55f02a='FAILED';break;case _0xbc7fc1(0x21c):_0x55f02a=_0xbc7fc1(0x1d7);break;case _0xbc7fc1(0x203):_0x55f02a=_0xbc7fc1(0x1f0);break;case _0xbc7fc1(0x1e8):case _0xbc7fc1(0x205):default:_0x55f02a=_0xbc7fc1(0x1e2);break;}return{'status':_0x55f02a,'amount':_0x2362d4[_0xbc7fc1(0x20c)]?.[_0xbc7fc1(0x1ec)],'currency':_0x2362d4[_0xbc7fc1(0x20c)]?.['currency']};}catch(_0xc614d3){console['error']('Rapyd\x20payment\x20verification\x20error:',_0xc614d3),loggerService_1[_0xbc7fc1(0x1d3)][_0xbc7fc1(0x1ed)]('rapyd','/v1/hosted/payment_links/'+_0x56a5b1,_0xc614d3);throw new Error(_0xbc7fc1(0x20d)+(_0xc614d3 instanceof Error?_0xc614d3[_0xbc7fc1(0x1fc)]:'Unknown\x20error'));}}async['processWebhook'](_0x4c83dd){const _0x1fc858=a46_0x4e7c36;console[_0x1fc858(0x1d6)](_0x1fc858(0x1d4),_0x4c83dd);let _0x32ec36=_0x1fc858(0x1e2),_0x592107;_0x4c83dd[_0x1fc858(0x20c)]?.[_0x1fc858(0x1f1)]&&(_0x592107=_0x4c83dd[_0x1fc858(0x20c)][_0x1fc858(0x1f1)],console[_0x1fc858(0x1d6)](_0x1fc858(0x230)+_0x592107));switch(_0x4c83dd['type']?.['toUpperCase']()){case'PAYMENT_COMPLETED':_0x4c83dd[_0x1fc858(0x20c)]?.[_0x1fc858(0x1e4)]===!![]&&_0x4c83dd[_0x1fc858(0x20c)]?.[_0x1fc858(0x221)]===_0x1fc858(0x21f)?_0x32ec36=_0x1fc858(0x1de):_0x32ec36=_0x1fc858(0x1e2);break;case'PAYMENT_CANCELED':_0x32ec36=_0x1fc858(0x1f0);break;case'PAYMENT_EXPIRED':_0x32ec36=_0x1fc858(0x1d7);break;case _0x1fc858(0x200):_0x32ec36=_0x1fc858(0x1f0);!_0x592107&&_0x4c83dd[_0x1fc858(0x20c)]?.[_0x1fc858(0x1f1)]&&(_0x592107=_0x4c83dd[_0x1fc858(0x20c)]['failure_message']);break;default:switch(_0x4c83dd[_0x1fc858(0x20c)]?.['status']?.['toUpperCase']()){case _0x1fc858(0x21f):_0x4c83dd[_0x1fc858(0x20c)]?.[_0x1fc858(0x1e4)]===!![]?_0x32ec36=_0x1fc858(0x1de):_0x32ec36=_0x1fc858(0x1f0);break;case _0x1fc858(0x1fe):_0x32ec36='FAILED';break;case'EXP':_0x32ec36=_0x1fc858(0x1d7);break;case _0x1fc858(0x203):_0x32ec36=_0x1fc858(0x1f0);!_0x592107&&_0x4c83dd[_0x1fc858(0x20c)]?.[_0x1fc858(0x1f1)]&&(_0x592107=_0x4c83dd[_0x1fc858(0x20c)]['failure_message']);break;case _0x1fc858(0x1e8):case'ACT':default:_0x32ec36=_0x1fc858(0x1e2);break;}break;}const _0x45106d={};return _0x4c83dd[_0x1fc858(0x20c)]?.[_0x1fc858(0x21e)]?.[_0x1fc858(0x208)]&&(_0x45106d[_0x1fc858(0x21b)]=_0x4c83dd['data'][_0x1fc858(0x21e)][_0x1fc858(0x208)]),_0x4c83dd[_0x1fc858(0x20c)]?.[_0x1fc858(0x1d2)]&&(_0x45106d[_0x1fc858(0x1db)]=_0x4c83dd[_0x1fc858(0x20c)][_0x1fc858(0x1d2)]),_0x4c83dd[_0x1fc858(0x20c)]?.[_0x1fc858(0x1f7)]&&(_0x45106d['errorCode']=_0x4c83dd[_0x1fc858(0x20c)][_0x1fc858(0x1f7)]),_0x4c83dd[_0x1fc858(0x20c)]?.[_0x1fc858(0x209)]&&(_0x45106d[_0x1fc858(0x1d5)]=_0x4c83dd['data']['failure_code']),console[_0x1fc858(0x1d6)](_0x1fc858(0x1da)+_0x32ec36+',\x20failureMessage='+(_0x592107||_0x1fc858(0x1fa))),{'paymentId':_0x4c83dd[_0x1fc858(0x20c)]?.[_0x1fc858(0x1f6)]||'','status':_0x32ec36,'amount':_0x4c83dd[_0x1fc858(0x20c)]?.[_0x1fc858(0x1ec)],'currency':_0x4c83dd['data']?.[_0x1fc858(0x1fb)],'failureMessage':_0x592107,'additionalInfo':_0x45106d};}}function a46_0x4dab(_0x410750,_0x557b15){const _0x5f2adf=a46_0x5f2a();return a46_0x4dab=function(_0x4dab0b,_0x1522fd){_0x4dab0b=_0x4dab0b-0x1d0;let _0x1eb2cf=_0x5f2adf[_0x4dab0b];return _0x1eb2cf;},a46_0x4dab(_0x410750,_0x557b15);}exports[a46_0x4e7c36(0x1f2)]=RapydService;