'use strict';const a42_0x69e49=a42_0x11ba;(function(_0x3a0a7f,_0x30f0a3){const _0x7362c3=a42_0x11ba,_0x2b6e1a=_0x3a0a7f();while(!![]){try{const _0x475beb=-parseInt(_0x7362c3(0x166))/0x1+parseInt(_0x7362c3(0x16e))/0x2+-parseInt(_0x7362c3(0x153))/0x3+parseInt(_0x7362c3(0x1a0))/0x4*(-parseInt(_0x7362c3(0x15b))/0x5)+-parseInt(_0x7362c3(0x199))/0x6*(parseInt(_0x7362c3(0x141))/0x7)+-parseInt(_0x7362c3(0x16b))/0x8*(-parseInt(_0x7362c3(0x179))/0x9)+parseInt(_0x7362c3(0x19b))/0xa;if(_0x475beb===_0x30f0a3)break;else _0x2b6e1a['push'](_0x2b6e1a['shift']());}catch(_0x218ac5){_0x2b6e1a['push'](_0x2b6e1a['shift']());}}}(a42_0x1f5d,0x73705));function a42_0x1f5d(){const _0x3d3c7b=['\x20(GB\x20-\x20Britain)','rapyd','entries','Error\x20Message:','\x20(always\x20GB\x20for\x20Rapyd)','apiUrl','currency','49oNWUwr','Error\x20message:','amount','application/json',',\x20body:\x20','üá¨üáß\x20Country:\x20','Rapyd\x20API\x20error\x20(','FAILED','Unknown\x20error\x20from\x20Rapyd\x20API','Headers:','/v1/hosted/payment_links/','):\x20','__esModule','merchant_reference_id','===\x20RAPYD\x20API\x20REQUEST\x20(White\x20Domain\x20-\x20Updated\x20Format)\x20===','verifyPayment','üí≥\x20Payment\x20Methods:\x20gb_visa_card,\x20gb_mastercard_card','PAYMENT_COMPLETED','33831HahLPi','data','RapydService','status','ERR','gb_mastercard_card','loggerService','text','145toIbsQ','../loggerService','POST','paid','redirect_url','stack','Payment\x20Link\x20ID:','PENDING','üá¨üáß\x20Country\x20used:\x20','URL:','Invalid\x20JSON\x20response\x20from\x20Rapyd\x20API:\x20','96377dOcpsV','headers','gb_visa_card','PAYMENT_CANCELED','Business\x20Error\x20(','8ivinAr','stringify','logWhiteDomainError','610338JvfOyQ','TesSoft\x20Payment\x20System/1.0','HTTP\x20error!\x20status:\x20','https://tesoft.uk/gateway/fail.php?id=','Missing\x20id\x20or\x20redirect_url\x20in\x20response','===\x20RAPYD\x20API\x20RESPONSE\x20(White\x20Domain)\x20===','CAN','error_code','Error\x20details:','Incomplete\x20response:\x20missing\x20id\x20or\x20redirect_url','GET','1576404URAova','logWhiteDomainRequest','PAYMENT_FAILED','===\x20PARSED\x20RAPYD\x20RESPONSE\x20===','defineProperty','===\x20RAPYD\x20API\x20ERROR\x20===','error','json','Failed\x20to\x20parse\x20JSON\x20response:','Response\x20Body:','CLO','statusText','===\x20RAPYD\x20SUCCESS\x20===','SUCCESS','HTTP\x20','===\x20RAPYD\x20API\x20BUSINESS\x20ERROR\x20===','parse','Request\x20Body\x20(Updated\x20Format):','Unknown\x20error','Status:','NEW','type','EXPIRED','Error\x20stack:','processWebhook','ACT','PAYMENT_EXPIRED','log','Error\x20Code:','üá¨üáß\x20Using\x20GB\x20(Britain)\x20as\x20country\x20for\x20Rapyd\x20payment\x20link','HTTP\x20Status:','toUpperCase','582990Fmlxim','JSON\x20Parse\x20Error:\x20','15620160Aikuzk','now','message','Response\x20data:','Invalid\x20response\x20from\x20Rapyd\x20API:\x20missing\x20id\x20or\x20redirect_url','107820oHSjpd','logWhiteDomainResponse','Rapyd\x20API\x20error:\x20','Failed\x20to\x20verify\x20Rapyd\x20payment:\x20','/v1/hosted/payment_links','PAID'];a42_0x1f5d=function(){return _0x3d3c7b;};return a42_0x1f5d();}Object[a42_0x69e49(0x17d)](exports,a42_0x69e49(0x14d),{'value':!![]}),exports[a42_0x69e49(0x155)]=void 0x0;function a42_0x11ba(_0x316122,_0x673ab4){const _0x1f5d11=a42_0x1f5d();return a42_0x11ba=function(_0x11ba60,_0x44c81c){_0x11ba60=_0x11ba60-0x13f;let _0x3dfb61=_0x1f5d11[_0x11ba60];return _0x3dfb61;},a42_0x11ba(_0x316122,_0x673ab4);}const loggerService_1=require(a42_0x69e49(0x15c));class RapydService{constructor(){const _0x40b253=a42_0x69e49;this[_0x40b253(0x13f)]='https://tesoft.uk/gateway/rapyd/',console[_0x40b253(0x194)]('üåê\x20Rapyd\x20service\x20initialized\x20with\x20white\x20domain\x20proxy');}async['createPaymentLink'](_0x34a832){const _0x590b97=a42_0x69e49,{orderId:_0x1da8c1,orderName:_0x1b5ae9,amount:_0x4a9753,currency:_0x37afef,usage:_0x1a1869,maxPayments:_0x58b1b1,successUrl:_0x5eb74d,failUrl:_0x346556}=_0x34a832,_0x31d30a=_0x37afef['toUpperCase'](),_0x1ef90d='GB';console[_0x590b97(0x194)](_0x590b97(0x196));const _0x136098='https://tesoft.uk/gateway/success.php?id='+_0x1da8c1,_0x473ea9=_0x590b97(0x171)+_0x1da8c1,_0x29dfaf={'amount':_0x4a9753,'currency':_0x31d30a,'cancel_checkout_url':_0x473ea9,'complete_checkout_url':_0x136098,'complete_payment_url':_0x136098,'merchant_reference_id':_0x1da8c1,'description':'ORDER:\x20'+_0x1da8c1,'country':'GB','payment_method_types_include':[_0x590b97(0x168),_0x590b97(0x158)],'custom_elements':{'display_description':!![]}},_0x4f78e3=Date['now']();try{console[_0x590b97(0x194)](_0x590b97(0x14f)),console[_0x590b97(0x194)](_0x590b97(0x164),this[_0x590b97(0x13f)]),console[_0x590b97(0x194)](_0x590b97(0x18a),JSON[_0x590b97(0x16c)](_0x29dfaf,null,0x2)),console['log'](_0x590b97(0x146)+_0x1ef90d+_0x590b97(0x1aa)),console['log'](_0x590b97(0x151)),loggerService_1[_0x590b97(0x159)]['logWhiteDomainRequest'](_0x590b97(0x1a7),_0x590b97(0x1a4),_0x590b97(0x15d),_0x29dfaf);const _0xd51518=await fetch(this[_0x590b97(0x13f)],{'method':'POST','headers':{'Content-Type':_0x590b97(0x144),'User-Agent':'TesSoft\x20Payment\x20System/1.0'},'body':JSON['stringify'](_0x29dfaf)}),_0x3d6e0b=Date[_0x590b97(0x19c)]()-_0x4f78e3;console[_0x590b97(0x194)](_0x590b97(0x173)),console[_0x590b97(0x194)](_0x590b97(0x18c),_0xd51518[_0x590b97(0x156)]),console[_0x590b97(0x194)]('Status\x20Text:',_0xd51518[_0x590b97(0x184)]),console[_0x590b97(0x194)](_0x590b97(0x14a),Object['fromEntries'](_0xd51518[_0x590b97(0x167)][_0x590b97(0x1a8)]())),console[_0x590b97(0x194)]('Response\x20Time:',_0x3d6e0b+'ms');const _0x128dd7=await _0xd51518[_0x590b97(0x15a)]();console[_0x590b97(0x194)]('Raw\x20Response\x20Body:',_0x128dd7);if(!_0xd51518['ok']){console[_0x590b97(0x17f)](_0x590b97(0x17e)),console[_0x590b97(0x17f)](_0x590b97(0x197),_0xd51518[_0x590b97(0x156)]),console['error'](_0x590b97(0x182),_0x128dd7),loggerService_1[_0x590b97(0x159)][_0x590b97(0x1a1)]('rapyd',_0x590b97(0x1a4),_0xd51518[_0x590b97(0x156)],_0x128dd7,_0x3d6e0b),loggerService_1[_0x590b97(0x159)][_0x590b97(0x16d)](_0x590b97(0x1a7),'/v1/hosted/payment_links',_0x590b97(0x187)+_0xd51518[_0x590b97(0x156)]+':\x20'+_0x128dd7);throw new Error('HTTP\x20error!\x20status:\x20'+_0xd51518[_0x590b97(0x156)]+_0x590b97(0x145)+_0x128dd7);}let _0x11a1c7;try{_0x11a1c7=JSON[_0x590b97(0x189)](_0x128dd7);}catch(_0x35d247){console[_0x590b97(0x17f)](_0x590b97(0x181),_0x35d247),loggerService_1[_0x590b97(0x159)][_0x590b97(0x16d)]('rapyd',_0x590b97(0x1a4),_0x590b97(0x19a)+_0x35d247);throw new Error(_0x590b97(0x165)+_0x128dd7);}console['log'](_0x590b97(0x17c)),console[_0x590b97(0x194)]('Parsed\x20Result:',JSON[_0x590b97(0x16c)](_0x11a1c7,null,0x2)),loggerService_1[_0x590b97(0x159)]['logWhiteDomainResponse']('rapyd',_0x590b97(0x1a4),_0xd51518[_0x590b97(0x156)],_0x11a1c7,_0x3d6e0b);if(_0x11a1c7[_0x590b97(0x156)]?.[_0x590b97(0x156)]!==_0x590b97(0x186)){const _0x1b2253=_0x11a1c7[_0x590b97(0x156)]?.[_0x590b97(0x19d)]||_0x590b97(0x149),_0x39fd84=_0x11a1c7[_0x590b97(0x156)]?.[_0x590b97(0x175)]||'UNKNOWN';console['error'](_0x590b97(0x188)),console[_0x590b97(0x17f)](_0x590b97(0x195),_0x39fd84),console['error'](_0x590b97(0x1a9),_0x1b2253),console['error']('Full\x20Error\x20Data:',_0x11a1c7['status']),loggerService_1['loggerService'][_0x590b97(0x16d)](_0x590b97(0x1a7),_0x590b97(0x1a4),_0x590b97(0x16a)+_0x39fd84+_0x590b97(0x14c)+_0x1b2253);throw new Error(_0x590b97(0x147)+_0x39fd84+_0x590b97(0x14c)+_0x1b2253);}if(!_0x11a1c7[_0x590b97(0x154)]?.['id']||!_0x11a1c7[_0x590b97(0x154)]?.[_0x590b97(0x15f)]){console[_0x590b97(0x17f)]('===\x20RAPYD\x20API\x20INCOMPLETE\x20RESPONSE\x20==='),console['error'](_0x590b97(0x172)),console[_0x590b97(0x17f)](_0x590b97(0x19e),_0x11a1c7[_0x590b97(0x154)]),loggerService_1[_0x590b97(0x159)][_0x590b97(0x16d)]('rapyd',_0x590b97(0x1a4),_0x590b97(0x177));throw new Error(_0x590b97(0x19f));}return console[_0x590b97(0x194)](_0x590b97(0x185)),console[_0x590b97(0x194)](_0x590b97(0x161),_0x11a1c7['data']['id']),console[_0x590b97(0x194)]('Redirect\x20URL:',_0x11a1c7[_0x590b97(0x154)][_0x590b97(0x15f)]),console[_0x590b97(0x194)](_0x590b97(0x163)+_0x1ef90d+_0x590b97(0x1a6)),console[_0x590b97(0x194)](_0x590b97(0x151)),{'gateway_payment_id':_0x11a1c7[_0x590b97(0x154)]['id'],'payment_url':_0x11a1c7[_0x590b97(0x154)][_0x590b97(0x15f)]};}catch(_0xf2b5ca){console[_0x590b97(0x17f)]('===\x20RAPYD\x20SERVICE\x20ERROR\x20==='),console[_0x590b97(0x17f)](_0x590b97(0x176),_0xf2b5ca),loggerService_1['loggerService']['logWhiteDomainError']('rapyd','/v1/hosted/payment_links',_0xf2b5ca);if(_0xf2b5ca instanceof Error){console[_0x590b97(0x17f)](_0x590b97(0x142),_0xf2b5ca[_0x590b97(0x19d)]),console['error'](_0x590b97(0x190),_0xf2b5ca[_0x590b97(0x160)]);throw new Error('Failed\x20to\x20create\x20Rapyd\x20payment\x20link:\x20'+_0xf2b5ca['message']);}throw new Error('Failed\x20to\x20create\x20Rapyd\x20payment\x20link:\x20Unknown\x20error');}}async[a42_0x69e49(0x150)](_0x5a5550){const _0x43f643=a42_0x69e49,_0x56fdd1=Date[_0x43f643(0x19c)]();try{loggerService_1['loggerService'][_0x43f643(0x17a)](_0x43f643(0x1a7),_0x43f643(0x14b)+_0x5a5550,_0x43f643(0x178),{});const _0x1ebc7e=await fetch(this[_0x43f643(0x13f)]+'/'+_0x5a5550,{'method':_0x43f643(0x178),'headers':{'Content-Type':_0x43f643(0x144),'User-Agent':_0x43f643(0x16f)}}),_0x27bcea=Date[_0x43f643(0x19c)]()-_0x56fdd1;if(!_0x1ebc7e['ok']){const _0x25baef=await _0x1ebc7e[_0x43f643(0x15a)]();loggerService_1[_0x43f643(0x159)][_0x43f643(0x1a1)](_0x43f643(0x1a7),_0x43f643(0x14b)+_0x5a5550,_0x1ebc7e['status'],_0x25baef,_0x27bcea);throw new Error(_0x43f643(0x170)+_0x1ebc7e[_0x43f643(0x156)]);}const _0x4e97d3=await _0x1ebc7e[_0x43f643(0x180)]();loggerService_1[_0x43f643(0x159)][_0x43f643(0x1a1)](_0x43f643(0x1a7),'/v1/hosted/payment_links/'+_0x5a5550,_0x1ebc7e[_0x43f643(0x156)],_0x4e97d3,_0x27bcea);if(_0x4e97d3[_0x43f643(0x156)]?.[_0x43f643(0x156)]!=='SUCCESS'){loggerService_1[_0x43f643(0x159)][_0x43f643(0x16d)](_0x43f643(0x1a7),_0x43f643(0x14b)+_0x5a5550,_0x43f643(0x1a2)+(_0x4e97d3[_0x43f643(0x156)]?.[_0x43f643(0x19d)]||_0x43f643(0x18b)));throw new Error('Rapyd\x20API\x20error:\x20'+(_0x4e97d3[_0x43f643(0x156)]?.[_0x43f643(0x19d)]||_0x43f643(0x18b)));}let _0x2986b3=_0x43f643(0x162);if(_0x4e97d3[_0x43f643(0x154)]?.[_0x43f643(0x156)])switch(_0x4e97d3['data'][_0x43f643(0x156)][_0x43f643(0x198)]()){case _0x43f643(0x183):_0x2986b3=_0x43f643(0x1a5);break;case _0x43f643(0x174):_0x2986b3=_0x43f643(0x148);break;case'EXP':_0x2986b3=_0x43f643(0x18f);break;case'ERR':_0x2986b3=_0x43f643(0x148);break;case _0x43f643(0x18d):case _0x43f643(0x192):default:_0x2986b3=_0x43f643(0x162);break;}return{'status':_0x2986b3,'amount':_0x4e97d3['data']?.[_0x43f643(0x143)],'currency':_0x4e97d3['data']?.[_0x43f643(0x140)]};}catch(_0x99f99b){console['error']('Rapyd\x20payment\x20verification\x20error:',_0x99f99b),loggerService_1['loggerService'][_0x43f643(0x16d)](_0x43f643(0x1a7),'/v1/hosted/payment_links/'+_0x5a5550,_0x99f99b);throw new Error(_0x43f643(0x1a3)+(_0x99f99b instanceof Error?_0x99f99b[_0x43f643(0x19d)]:_0x43f643(0x18b)));}}async[a42_0x69e49(0x191)](_0x3a9991){const _0x1daff4=a42_0x69e49;console[_0x1daff4(0x194)]('Processing\x20Rapyd\x20webhook:',_0x3a9991);let _0x3dbbf0=_0x1daff4(0x162);switch(_0x3a9991[_0x1daff4(0x18e)]?.[_0x1daff4(0x198)]()){case _0x1daff4(0x152):_0x3a9991[_0x1daff4(0x154)]?.[_0x1daff4(0x15e)]===!![]&&_0x3a9991[_0x1daff4(0x154)]?.['status']===_0x1daff4(0x183)?_0x3dbbf0=_0x1daff4(0x1a5):_0x3dbbf0=_0x1daff4(0x162);break;case _0x1daff4(0x169):_0x3dbbf0=_0x1daff4(0x148);break;case _0x1daff4(0x193):_0x3dbbf0=_0x1daff4(0x18f);break;case _0x1daff4(0x17b):_0x3dbbf0=_0x1daff4(0x148);break;default:switch(_0x3a9991[_0x1daff4(0x154)]?.['status']?.['toUpperCase']()){case _0x1daff4(0x183):_0x3a9991[_0x1daff4(0x154)]?.[_0x1daff4(0x15e)]===!![]?_0x3dbbf0=_0x1daff4(0x1a5):_0x3dbbf0=_0x1daff4(0x148);break;case _0x1daff4(0x174):_0x3dbbf0=_0x1daff4(0x148);break;case'EXP':_0x3dbbf0=_0x1daff4(0x18f);break;case _0x1daff4(0x157):_0x3dbbf0=_0x1daff4(0x148);break;case _0x1daff4(0x18d):case'ACT':default:_0x3dbbf0=_0x1daff4(0x162);break;}break;}return{'paymentId':_0x3a9991[_0x1daff4(0x154)]?.[_0x1daff4(0x14e)]||'','status':_0x3dbbf0,'amount':_0x3a9991[_0x1daff4(0x154)]?.[_0x1daff4(0x143)],'currency':_0x3a9991[_0x1daff4(0x154)]?.[_0x1daff4(0x140)]};}}exports[a42_0x69e49(0x155)]=RapydService;