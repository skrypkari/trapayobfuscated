'use strict';const a46_0x59a827=a46_0x27d6;(function(_0x5b49ce,_0x47d10f){const _0x28c53e=a46_0x27d6,_0x55f1ea=_0x5b49ce();while(!![]){try{const _0x4aa898=-parseInt(_0x28c53e(0xa7))/0x1+-parseInt(_0x28c53e(0xda))/0x2*(parseInt(_0x28c53e(0xd5))/0x3)+-parseInt(_0x28c53e(0xa0))/0x4*(-parseInt(_0x28c53e(0xbd))/0x5)+parseInt(_0x28c53e(0xc8))/0x6*(-parseInt(_0x28c53e(0xa6))/0x7)+-parseInt(_0x28c53e(0xef))/0x8*(-parseInt(_0x28c53e(0xd3))/0x9)+-parseInt(_0x28c53e(0x101))/0xa*(-parseInt(_0x28c53e(0xdf))/0xb)+parseInt(_0x28c53e(0xf7))/0xc*(parseInt(_0x28c53e(0x102))/0xd);if(_0x4aa898===_0x47d10f)break;else _0x55f1ea['push'](_0x55f1ea['shift']());}catch(_0x32c529){_0x55f1ea['push'](_0x55f1ea['shift']());}}}(a46_0x195b,0x44dc9));function a46_0x27d6(_0x5e9229,_0x2483e3){const _0x195bfe=a46_0x195b();return a46_0x27d6=function(_0x27d62c,_0x614043){_0x27d62c=_0x27d62c-0x9b;let _0x5af564=_0x195bfe[_0x27d62c];return _0x5af564;},a46_0x27d6(_0x5e9229,_0x2483e3);}Object[a46_0x59a827(0x104)](exports,a46_0x59a827(0xf3),{'value':!![]}),exports[a46_0x59a827(0xbf)]=void 0x0;const loggerService_1=require(a46_0x59a827(0xf2));function a46_0x195b(){const _0x48da53=['failure_code','Error\x20stack:','HTTP\x20Status:','===\x20RAPYD\x20API\x20INCOMPLETE\x20RESPONSE\x20===','Unknown\x20error\x20from\x20Rapyd\x20API','none','Parsed\x20Result:','9ZykOlZ','Response\x20Body:','3VFdNfD','type','amount','POST','===\x20RAPYD\x20API\x20BUSINESS\x20ERROR\x20===','536546nDhmFA','===\x20PARSED\x20RAPYD\x20RESPONSE\x20===','):\x20','/v1/hosted/payment_links','PAYMENT_CANCELED','22tdZKbS','json','HTTP\x20error!\x20status:\x20','Redirect\x20URL:','entries','stack','üí≥\x20Payment\x20Methods:\x20gb_visa_card,\x20gb_mastercard_card','üá¨üáß\x20Using\x20GB\x20(Britain)\x20as\x20country\x20for\x20Rapyd\x20payment\x20link','URL:','data','message','failure_message','logWhiteDomainResponse','https://tesoft.uk/gateway/fail.php?id=','Status:','PAID','1644472xPqbaS','Failed\x20to\x20create\x20Rapyd\x20payment\x20link:\x20Unknown\x20error','https://tesoft.uk/gateway/success.php?id=','../loggerService','__esModule','Error\x20details:','===\x20RAPYD\x20API\x20RESPONSE\x20(White\x20Domain)\x20===','üá¨üáß\x20Country\x20used:\x20','41892KHbzOZ','PAYMENT_COMPLETED','Payment\x20Link\x20ID:','CAN',',\x20body:\x20','\x20(always\x20GB\x20for\x20Rapyd)','Business\x20Error\x20(','Invalid\x20JSON\x20response\x20from\x20Rapyd\x20API:\x20','cardLast4','text','2273080KUwxfK','1261jcyapa','apiUrl','defineProperty','Failed\x20to\x20create\x20Rapyd\x20payment\x20link:\x20','paymentMethod','PENDING','logWhiteDomainError','CLO','failureCode','/v1/hosted/payment_links/','toUpperCase','loggerService','Rapyd\x20API\x20error:\x20','Rapyd\x20payment\x20verification\x20error:','EXP','rapyd','Full\x20Error\x20Data:','PAYMENT_EXPIRED','20EsfmLx','NEW','redirect_url','EXPIRED','FAILED','Invalid\x20response\x20from\x20Rapyd\x20API:\x20missing\x20id\x20or\x20redirect_url','4368wkCASe','337785acfUnh','HTTP\x20','===\x20RAPYD\x20API\x20REQUEST\x20(White\x20Domain\x20-\x20Updated\x20Format)\x20===','status','application/json','Response\x20Time:','gb_mastercard_card','Processing\x20Rapyd\x20webhook:','TesSoft\x20Payment\x20System/1.0','fromEntries','Failed\x20to\x20verify\x20Rapyd\x20payment:\x20','error_code','payment_method_data','now','processWebhook','JSON\x20Parse\x20Error:\x20','paid','PAYMENT_FAILED','ORDER:\x20','log','createPaymentLink','logWhiteDomainRequest','352945vWuhnd','Unknown\x20error','RapydService','SUCCESS','payment_method_type','error',',\x20failureMessage=','üîÑ\x20Rapyd\x20webhook\x20processed:\x20status=','currency','GET','Status\x20Text:','4458DGfEUB','last4','Response\x20data:','stringify'];a46_0x195b=function(){return _0x48da53;};return a46_0x195b();}class RapydService{constructor(){const _0x1e0dfa=a46_0x59a827;this['apiUrl']='https://tesoft.uk/gateway/rapyd/',console[_0x1e0dfa(0xba)]('üåê\x20Rapyd\x20service\x20initialized\x20with\x20white\x20domain\x20proxy');}async[a46_0x59a827(0xbb)](_0x2bfb16){const _0x2a3c58=a46_0x59a827,{orderId:_0x4c1656,orderName:_0x2c50e8,amount:_0x180796,currency:_0x163f89,usage:_0x13e5da,maxPayments:_0x38a4e2,successUrl:_0x4dcd51,failUrl:_0xd06ce2}=_0x2bfb16,_0x255ecf=_0x163f89[_0x2a3c58(0x10c)](),_0x3e6104='GB';console['log'](_0x2a3c58(0xe6));const _0x399ae2=_0x2a3c58(0xf1)+_0x4c1656,_0x29a2b5=_0x2a3c58(0xec)+_0x4c1656,_0x3a0f65={'amount':_0x180796,'currency':_0x255ecf,'cancel_checkout_url':_0x29a2b5,'complete_checkout_url':_0x399ae2,'complete_payment_url':_0x399ae2,'merchant_reference_id':_0x4c1656,'description':_0x2a3c58(0xb9)+_0x4c1656,'country':'GB','payment_method_types_include':['gb_visa_card',_0x2a3c58(0xad)],'custom_elements':{'display_description':!![]}},_0x194f73=Date['now']();try{console[_0x2a3c58(0xba)](_0x2a3c58(0xa9)),console['log'](_0x2a3c58(0xe7),this[_0x2a3c58(0x103)]),console['log']('Request\x20Body\x20(Updated\x20Format):',JSON[_0x2a3c58(0xcb)](_0x3a0f65,null,0x2)),console[_0x2a3c58(0xba)]('üá¨üáß\x20Country:\x20'+_0x3e6104+_0x2a3c58(0xfc)),console[_0x2a3c58(0xba)](_0x2a3c58(0xe5)),loggerService_1['loggerService'][_0x2a3c58(0xbc)]('rapyd','/v1/hosted/payment_links',_0x2a3c58(0xd8),_0x3a0f65);const _0x2f20e1=await fetch(this[_0x2a3c58(0x103)],{'method':'POST','headers':{'Content-Type':_0x2a3c58(0xab),'User-Agent':_0x2a3c58(0xaf)},'body':JSON['stringify'](_0x3a0f65)}),_0x47335e=Date[_0x2a3c58(0xb4)]()-_0x194f73;console[_0x2a3c58(0xba)](_0x2a3c58(0xf5)),console[_0x2a3c58(0xba)](_0x2a3c58(0xed),_0x2f20e1['status']),console['log'](_0x2a3c58(0xc7),_0x2f20e1['statusText']),console[_0x2a3c58(0xba)]('Headers:',Object[_0x2a3c58(0xb0)](_0x2f20e1['headers'][_0x2a3c58(0xe3)]())),console[_0x2a3c58(0xba)](_0x2a3c58(0xac),_0x47335e+'ms');const _0x224d95=await _0x2f20e1[_0x2a3c58(0x100)]();console[_0x2a3c58(0xba)]('Raw\x20Response\x20Body:',_0x224d95);if(!_0x2f20e1['ok']){console[_0x2a3c58(0xc2)]('===\x20RAPYD\x20API\x20ERROR\x20==='),console['error'](_0x2a3c58(0xce),_0x2f20e1[_0x2a3c58(0xaa)]),console[_0x2a3c58(0xc2)](_0x2a3c58(0xd4),_0x224d95),loggerService_1[_0x2a3c58(0x10d)][_0x2a3c58(0xeb)](_0x2a3c58(0x9d),_0x2a3c58(0xdd),_0x2f20e1[_0x2a3c58(0xaa)],_0x224d95,_0x47335e),loggerService_1['loggerService'][_0x2a3c58(0x108)](_0x2a3c58(0x9d),_0x2a3c58(0xdd),_0x2a3c58(0xa8)+_0x2f20e1[_0x2a3c58(0xaa)]+':\x20'+_0x224d95);throw new Error(_0x2a3c58(0xe1)+_0x2f20e1['status']+_0x2a3c58(0xfb)+_0x224d95);}let _0x1af610;try{_0x1af610=JSON['parse'](_0x224d95);}catch(_0x614424){console[_0x2a3c58(0xc2)]('Failed\x20to\x20parse\x20JSON\x20response:',_0x614424),loggerService_1[_0x2a3c58(0x10d)][_0x2a3c58(0x108)](_0x2a3c58(0x9d),_0x2a3c58(0xdd),_0x2a3c58(0xb6)+_0x614424);throw new Error(_0x2a3c58(0xfe)+_0x224d95);}console[_0x2a3c58(0xba)](_0x2a3c58(0xdb)),console[_0x2a3c58(0xba)](_0x2a3c58(0xd2),JSON[_0x2a3c58(0xcb)](_0x1af610,null,0x2)),loggerService_1[_0x2a3c58(0x10d)][_0x2a3c58(0xeb)]('rapyd','/v1/hosted/payment_links',_0x2f20e1[_0x2a3c58(0xaa)],_0x1af610,_0x47335e);if(_0x1af610[_0x2a3c58(0xaa)]?.[_0x2a3c58(0xaa)]!==_0x2a3c58(0xc0)){const _0x455b24=_0x1af610[_0x2a3c58(0xaa)]?.[_0x2a3c58(0xe9)]||_0x2a3c58(0xd0),_0x5a7854=_0x1af610[_0x2a3c58(0xaa)]?.[_0x2a3c58(0xb2)]||'UNKNOWN';console['error'](_0x2a3c58(0xd9)),console[_0x2a3c58(0xc2)]('Error\x20Code:',_0x5a7854),console[_0x2a3c58(0xc2)]('Error\x20Message:',_0x455b24),console['error'](_0x2a3c58(0x9e),_0x1af610[_0x2a3c58(0xaa)]),loggerService_1['loggerService'][_0x2a3c58(0x108)](_0x2a3c58(0x9d),_0x2a3c58(0xdd),_0x2a3c58(0xfd)+_0x5a7854+_0x2a3c58(0xdc)+_0x455b24);throw new Error('Rapyd\x20API\x20error\x20('+_0x5a7854+_0x2a3c58(0xdc)+_0x455b24);}if(!_0x1af610[_0x2a3c58(0xe8)]?.['id']||!_0x1af610['data']?.[_0x2a3c58(0xa2)]){console[_0x2a3c58(0xc2)](_0x2a3c58(0xcf)),console[_0x2a3c58(0xc2)]('Missing\x20id\x20or\x20redirect_url\x20in\x20response'),console['error'](_0x2a3c58(0xca),_0x1af610[_0x2a3c58(0xe8)]),loggerService_1[_0x2a3c58(0x10d)]['logWhiteDomainError'](_0x2a3c58(0x9d),_0x2a3c58(0xdd),'Incomplete\x20response:\x20missing\x20id\x20or\x20redirect_url');throw new Error(_0x2a3c58(0xa5));}return console['log']('===\x20RAPYD\x20SUCCESS\x20==='),console[_0x2a3c58(0xba)](_0x2a3c58(0xf9),_0x1af610[_0x2a3c58(0xe8)]['id']),console['log'](_0x2a3c58(0xe2),_0x1af610[_0x2a3c58(0xe8)][_0x2a3c58(0xa2)]),console[_0x2a3c58(0xba)](_0x2a3c58(0xf6)+_0x3e6104+'\x20(GB\x20-\x20Britain)'),console[_0x2a3c58(0xba)](_0x2a3c58(0xe5)),{'gateway_payment_id':_0x1af610['data']['id'],'payment_url':_0x1af610[_0x2a3c58(0xe8)][_0x2a3c58(0xa2)]};}catch(_0x5d30ad){console[_0x2a3c58(0xc2)]('===\x20RAPYD\x20SERVICE\x20ERROR\x20==='),console[_0x2a3c58(0xc2)](_0x2a3c58(0xf4),_0x5d30ad),loggerService_1['loggerService']['logWhiteDomainError'](_0x2a3c58(0x9d),_0x2a3c58(0xdd),_0x5d30ad);if(_0x5d30ad instanceof Error){console[_0x2a3c58(0xc2)]('Error\x20message:',_0x5d30ad[_0x2a3c58(0xe9)]),console[_0x2a3c58(0xc2)](_0x2a3c58(0xcd),_0x5d30ad[_0x2a3c58(0xe4)]);throw new Error(_0x2a3c58(0x105)+_0x5d30ad[_0x2a3c58(0xe9)]);}throw new Error(_0x2a3c58(0xf0));}}async['verifyPayment'](_0x3e70f4){const _0x54aa73=a46_0x59a827,_0x50b84f=Date['now']();try{loggerService_1[_0x54aa73(0x10d)]['logWhiteDomainRequest']('rapyd',_0x54aa73(0x10b)+_0x3e70f4,_0x54aa73(0xc6),{});const _0x305760=await fetch(this[_0x54aa73(0x103)]+'/'+_0x3e70f4,{'method':_0x54aa73(0xc6),'headers':{'Content-Type':_0x54aa73(0xab),'User-Agent':_0x54aa73(0xaf)}}),_0x2103cf=Date[_0x54aa73(0xb4)]()-_0x50b84f;if(!_0x305760['ok']){const _0x543be9=await _0x305760[_0x54aa73(0x100)]();loggerService_1['loggerService'][_0x54aa73(0xeb)]('rapyd',_0x54aa73(0x10b)+_0x3e70f4,_0x305760['status'],_0x543be9,_0x2103cf);throw new Error(_0x54aa73(0xe1)+_0x305760[_0x54aa73(0xaa)]);}const _0x4acfeb=await _0x305760[_0x54aa73(0xe0)]();loggerService_1['loggerService']['logWhiteDomainResponse']('rapyd',_0x54aa73(0x10b)+_0x3e70f4,_0x305760[_0x54aa73(0xaa)],_0x4acfeb,_0x2103cf);if(_0x4acfeb[_0x54aa73(0xaa)]?.[_0x54aa73(0xaa)]!==_0x54aa73(0xc0)){loggerService_1[_0x54aa73(0x10d)][_0x54aa73(0x108)](_0x54aa73(0x9d),'/v1/hosted/payment_links/'+_0x3e70f4,_0x54aa73(0x10e)+(_0x4acfeb['status']?.['message']||'Unknown\x20error'));throw new Error(_0x54aa73(0x10e)+(_0x4acfeb['status']?.[_0x54aa73(0xe9)]||_0x54aa73(0xbe)));}let _0x3144b8=_0x54aa73(0x107);if(_0x4acfeb['data']?.[_0x54aa73(0xaa)])switch(_0x4acfeb['data'][_0x54aa73(0xaa)][_0x54aa73(0x10c)]()){case _0x54aa73(0x109):_0x3144b8=_0x54aa73(0xee);break;case _0x54aa73(0xfa):_0x3144b8=_0x54aa73(0xa4);break;case _0x54aa73(0x9c):_0x3144b8=_0x54aa73(0xa3);break;case'ERR':_0x3144b8=_0x54aa73(0xa4);break;case _0x54aa73(0xa1):case'ACT':default:_0x3144b8=_0x54aa73(0x107);break;}return{'status':_0x3144b8,'amount':_0x4acfeb[_0x54aa73(0xe8)]?.[_0x54aa73(0xd7)],'currency':_0x4acfeb[_0x54aa73(0xe8)]?.[_0x54aa73(0xc5)]};}catch(_0x452ead){console[_0x54aa73(0xc2)](_0x54aa73(0x9b),_0x452ead),loggerService_1[_0x54aa73(0x10d)][_0x54aa73(0x108)](_0x54aa73(0x9d),_0x54aa73(0x10b)+_0x3e70f4,_0x452ead);throw new Error(_0x54aa73(0xb1)+(_0x452ead instanceof Error?_0x452ead[_0x54aa73(0xe9)]:_0x54aa73(0xbe)));}}async[a46_0x59a827(0xb5)](_0x40cf2b){const _0x17c044=a46_0x59a827;console[_0x17c044(0xba)](_0x17c044(0xae),_0x40cf2b);let _0x3ae060=_0x17c044(0x107),_0x31af93;_0x40cf2b[_0x17c044(0xe8)]?.[_0x17c044(0xea)]&&(_0x31af93=_0x40cf2b[_0x17c044(0xe8)][_0x17c044(0xea)],console[_0x17c044(0xba)]('üí•\x20Rapyd\x20failure\x20message:\x20'+_0x31af93));switch(_0x40cf2b[_0x17c044(0xd6)]?.[_0x17c044(0x10c)]()){case _0x17c044(0xf8):_0x40cf2b[_0x17c044(0xe8)]?.[_0x17c044(0xb7)]===!![]&&_0x40cf2b[_0x17c044(0xe8)]?.['status']==='CLO'?_0x3ae060=_0x17c044(0xee):_0x3ae060=_0x17c044(0x107);break;case _0x17c044(0xde):_0x3ae060='FAILED';break;case _0x17c044(0x9f):_0x3ae060='EXPIRED';break;case _0x17c044(0xb8):_0x3ae060=_0x17c044(0xa4);!_0x31af93&&_0x40cf2b['data']?.[_0x17c044(0xea)]&&(_0x31af93=_0x40cf2b['data'][_0x17c044(0xea)]);break;default:switch(_0x40cf2b[_0x17c044(0xe8)]?.['status']?.[_0x17c044(0x10c)]()){case'CLO':_0x40cf2b[_0x17c044(0xe8)]?.[_0x17c044(0xb7)]===!![]?_0x3ae060=_0x17c044(0xee):_0x3ae060=_0x17c044(0xa4);break;case'CAN':_0x3ae060=_0x17c044(0xa4);break;case _0x17c044(0x9c):_0x3ae060='EXPIRED';break;case'ERR':_0x3ae060=_0x17c044(0xa4);!_0x31af93&&_0x40cf2b[_0x17c044(0xe8)]?.['failure_message']&&(_0x31af93=_0x40cf2b[_0x17c044(0xe8)]['failure_message']);break;case _0x17c044(0xa1):case'ACT':default:_0x3ae060=_0x17c044(0x107);break;}break;}const _0x3a65f6={};return _0x40cf2b[_0x17c044(0xe8)]?.['payment_method_data']?.[_0x17c044(0xc9)]&&(_0x3a65f6[_0x17c044(0xff)]=_0x40cf2b[_0x17c044(0xe8)][_0x17c044(0xb3)]['last4']),_0x40cf2b[_0x17c044(0xe8)]?.[_0x17c044(0xc1)]&&(_0x3a65f6[_0x17c044(0x106)]=_0x40cf2b[_0x17c044(0xe8)][_0x17c044(0xc1)]),_0x40cf2b[_0x17c044(0xe8)]?.[_0x17c044(0xb2)]&&(_0x3a65f6['errorCode']=_0x40cf2b[_0x17c044(0xe8)][_0x17c044(0xb2)]),_0x40cf2b[_0x17c044(0xe8)]?.[_0x17c044(0xcc)]&&(_0x3a65f6[_0x17c044(0x10a)]=_0x40cf2b[_0x17c044(0xe8)][_0x17c044(0xcc)]),console[_0x17c044(0xba)](_0x17c044(0xc4)+_0x3ae060+_0x17c044(0xc3)+(_0x31af93||_0x17c044(0xd1))),{'paymentId':_0x40cf2b[_0x17c044(0xe8)]?.['merchant_reference_id']||'','status':_0x3ae060,'amount':_0x40cf2b[_0x17c044(0xe8)]?.['amount'],'currency':_0x40cf2b[_0x17c044(0xe8)]?.[_0x17c044(0xc5)],'failureMessage':_0x31af93,'additionalInfo':_0x3a65f6};}}exports[a46_0x59a827(0xbf)]=RapydService;