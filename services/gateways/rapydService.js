'use strict';const a63_0x36630a=a63_0x4d82;(function(_0x13ddcd,_0x26ee62){const _0x3a67e8=a63_0x4d82,_0x3c3321=_0x13ddcd();while(!![]){try{const _0x9f2efa=parseInt(_0x3a67e8(0x1b6))/0x1+parseInt(_0x3a67e8(0x1b5))/0x2*(-parseInt(_0x3a67e8(0x1b7))/0x3)+-parseInt(_0x3a67e8(0x18f))/0x4+-parseInt(_0x3a67e8(0x191))/0x5*(parseInt(_0x3a67e8(0x183))/0x6)+-parseInt(_0x3a67e8(0x1da))/0x7*(parseInt(_0x3a67e8(0x18b))/0x8)+parseInt(_0x3a67e8(0x1a3))/0x9*(-parseInt(_0x3a67e8(0x1ef))/0xa)+-parseInt(_0x3a67e8(0x1c0))/0xb*(-parseInt(_0x3a67e8(0x1b1))/0xc);if(_0x9f2efa===_0x26ee62)break;else _0x3c3321['push'](_0x3c3321['shift']());}catch(_0x5b8a2f){_0x3c3321['push'](_0x3c3321['shift']());}}}(a63_0xad8f,0xc0c15));function a63_0x4d82(_0x4b4d9b,_0x19ac52){_0x4b4d9b=_0x4b4d9b-0x17d;const _0xad8f7d=a63_0xad8f();let _0x4d82e9=_0xad8f7d[_0x4b4d9b];return _0x4d82e9;}function a63_0xad8f(){const _0x106394=['===\x20RAPYD\x20API\x20REQUEST\x20(White\x20Domain\x20-\x20Updated\x20Format)\x20===','Processing\x20Rapyd\x20webhook:','Rapyd\x20API\x20error\x20(','last4','RapydService','288510fLbKgs','HTTP\x20','ðŸ‡¬ðŸ‡§\x20Using\x20GB\x20(Britain)\x20as\x20country\x20for\x20Rapyd\x20payment\x20link','defineProperty','Error\x20stack:','Business\x20Error\x20(',',\x20body:\x20','toISOString','464488FLgsMw','POST','toUpperCase','Status\x20Text:','2066244CWqVFX','now','155zvWwnA','ERR','text','redirect_url','PAYMENT_COMPLETED','PAYMENT_CANCELED','error','Error\x20Code:','rapyd','CAN','Error\x20message:','split','Failed\x20to\x20create\x20Rapyd\x20payment\x20link:\x20Unknown\x20error','apiUrl','ACT','Payment\x20System/1.0','):\x20','/v1/hosted/payment_links','2043yzKRuC','errorCode','payment_method_type','Rapyd\x20API\x20error:\x20','address','TESOFT\x20','floor','none','Response\x20Time:','processWebhook','failure_message','EXPIRED','https://tesoft.uk/gateway/success.php?id=','Full\x20Error\x20Data:','12dkytHb','Invalid\x20JSON\x20response\x20from\x20Rapyd\x20API:\x20','paid','===\x20RAPYD\x20SERVICE\x20ERROR\x20===','4CfRBxB','48170muxtHy','1378854ouxZzy','Payment\x20Link\x20ID:','stringify','NEW','Error\x20details:','entries','expiration','HTTP\x20error!\x20status:\x20','application/json','48286931fgaCBX','Redirect\x20URL:','PAYMENT_FAILED','https://tesoft.uk/gateway/fail.php?id=','Raw\x20Response\x20Body:','requested_currency','===\x20RAPYD\x20API\x20RESPONSE\x20(White\x20Domain)\x20===','log','stack','https://tesoft.uk/gateway/rapyd/','logWhiteDomainRequest','failure_code','FAILED','Request\x20Body\x20(Updated\x20Format):','failureCode','PENDING','loggerService','Response\x20data:','parse','Incomplete\x20response:\x20missing\x20id\x20or\x20redirect_url','currency','ðŸ‡¬ðŸ‡§\x20Country:\x20','CLO','data','Headers:','ðŸ’¥\x20Rapyd\x20failure\x20message:\x20','21ayeRlN','===\x20RAPYD\x20API\x20BUSINESS\x20ERROR\x20===','ðŸ’³\x20Payment\x20Methods:\x20gb_visa_card,\x20gb_mastercard_card','createPaymentLink',',\x20failureMessage=','GET','name','cardholder_name','status','Failed\x20to\x20create\x20Rapyd\x20payment\x20link:\x20','logWhiteDomainResponse','__esModule','SUCCESS','logWhiteDomainError','\x20(always\x20GB\x20for\x20Rapyd)','Response\x20Body:','Rapyd\x20payment\x20verification\x20error:','buy','===\x20RAPYD\x20API\x20INCOMPLETE\x20RESPONSE\x20===','Unknown\x20error\x20from\x20Rapyd\x20API','amount','24130BCNYuw','ðŸ‡¬ðŸ‡§\x20Country\x20used:\x20','ðŸ”„\x20Rapyd\x20webhook\x20processed:\x20status=','Error\x20Message:','../loggerService','ðŸŒ\x20Rapyd\x20service\x20initialized\x20with\x20white\x20domain\x20proxy','===\x20PARSED\x20RAPYD\x20RESPONSE\x20===','HTTP\x20Status:','PAID','Unknown\x20error','payment_method_data','merchant_reference_id','error_code','Invalid\x20response\x20from\x20Rapyd\x20API:\x20missing\x20id\x20or\x20redirect_url','message','phone_number','json','PAYMENT_EXPIRED','ðŸ’±\x20Adding\x20currency\x20conversion\x20fields\x20for\x20','gb_visa_card','statusText','headers','/v1/hosted/payment_links/'];a63_0xad8f=function(){return _0x106394;};return a63_0xad8f();}Object[a63_0x36630a(0x186)](exports,a63_0x36630a(0x1e5),{'value':!![]}),exports[a63_0x36630a(0x182)]=void 0x0;const loggerService_1=require(a63_0x36630a(0x1f3));class RapydService{constructor(){const _0x46e4ea=a63_0x36630a;this['apiUrl']=_0x46e4ea(0x1c9),console[_0x46e4ea(0x1c7)](_0x46e4ea(0x1f4));}async[a63_0x36630a(0x1dd)](_0x40fde3){const _0x243785=a63_0x36630a,{orderId:_0xa6b220,orderName:_0x473bc6,amount:_0x1876e7,currency:_0x4c14bb,usage:_0x28f975,maxPayments:_0x348755,successUrl:_0x267eb4,failUrl:_0x3ae3d2,customerName:_0x2d94dc,customerEmail:_0x45a767}=_0x40fde3,_0x4b8edf=_0x4c14bb['toUpperCase'](),_0x119146='GB';console[_0x243785(0x1c7)](_0x243785(0x185));const _0x7808a8=_0x243785(0x1af)+_0xa6b220,_0x1ab55a=_0x243785(0x1c3)+_0xa6b220,_0x283a69={'amount':_0x1876e7,'currency':_0x4b8edf,'payment_method_options':{'3d_required':![]},'cancel_checkout_url':_0x1ab55a,'complete_checkout_url':_0x7808a8,'complete_payment_url':_0x7808a8,'merchant_reference_id':_0xa6b220,'description':'ORDER:\x20'+_0xa6b220,'statement_descriptor':_0x243785(0x1a8)+(_0xa6b220[_0x243785(0x19c)]('-')[0x1]||_0xa6b220),'country':'GB','payment_method_types_include':[_0x243785(0x202),'gb_mastercard_card'],'custom_elements':{'display_description':!![],'billing_address_collect':!![],'required_customer_fields':[_0x243785(0x1e0),'email',_0x243785(0x1fe),_0x243785(0x1a7)]}};_0x2d94dc&&(_0x283a69['custom_elements'][_0x243785(0x1e1)]=_0x2d94dc,console[_0x243785(0x1c7)]('ðŸ’³\x20Adding\x20cardholder\x20name:\x20'+_0x2d94dc));if(_0x4b8edf!=='EUR'){const _0x1c971d=Math[_0x243785(0x1a9)](Date[_0x243785(0x190)]()/0x3e8)+0x1e*0x3c;_0x283a69['fixed_side']=_0x243785(0x1eb),_0x283a69[_0x243785(0x1c5)]='EUR',_0x283a69[_0x243785(0x1bd)]=_0x1c971d,console['log'](_0x243785(0x201)+_0x4b8edf+'\x20->\x20EUR:'),console[_0x243785(0x1c7)]('\x20\x20\x20fixed_side:\x20buy'),console['log']('\x20\x20\x20requested_currency:\x20EUR'),console[_0x243785(0x1c7)]('\x20\x20\x20expiration:\x20'+_0x1c971d+'\x20('+new Date(_0x1c971d*0x3e8)[_0x243785(0x18a)]()+')');}const _0x5581d7=Date[_0x243785(0x190)]();try{console[_0x243785(0x1c7)](_0x243785(0x17e)),console['log']('URL:',this[_0x243785(0x19e)]),console[_0x243785(0x1c7)](_0x243785(0x1cd),JSON[_0x243785(0x1b9)](_0x283a69,null,0x2)),console[_0x243785(0x1c7)](_0x243785(0x1d5)+_0x119146+_0x243785(0x1e8)),console['log'](_0x243785(0x1dc)),loggerService_1[_0x243785(0x1d0)][_0x243785(0x1ca)](_0x243785(0x199),_0x243785(0x1a2),_0x243785(0x18c),_0x283a69);const _0x2354fb=await fetch(this[_0x243785(0x19e)],{'method':'POST','headers':{'Content-Type':_0x243785(0x1bf),'User-Agent':_0x243785(0x1a0)},'body':JSON['stringify'](_0x283a69)}),_0x9bddd=Date[_0x243785(0x190)]()-_0x5581d7;console[_0x243785(0x1c7)](_0x243785(0x1c6)),console[_0x243785(0x1c7)]('Status:',_0x2354fb[_0x243785(0x1e2)]),console[_0x243785(0x1c7)](_0x243785(0x18e),_0x2354fb[_0x243785(0x203)]),console[_0x243785(0x1c7)](_0x243785(0x1d8),Object['fromEntries'](_0x2354fb[_0x243785(0x204)][_0x243785(0x1bc)]())),console[_0x243785(0x1c7)](_0x243785(0x1ab),_0x9bddd+'ms');const _0x2cf5b8=await _0x2354fb[_0x243785(0x193)]();console[_0x243785(0x1c7)](_0x243785(0x1c4),_0x2cf5b8);if(!_0x2354fb['ok']){console[_0x243785(0x197)]('===\x20RAPYD\x20API\x20ERROR\x20==='),console[_0x243785(0x197)](_0x243785(0x1f6),_0x2354fb[_0x243785(0x1e2)]),console['error'](_0x243785(0x1e9),_0x2cf5b8),loggerService_1[_0x243785(0x1d0)][_0x243785(0x1e4)](_0x243785(0x199),_0x243785(0x1a2),_0x2354fb[_0x243785(0x1e2)],_0x2cf5b8,_0x9bddd),loggerService_1[_0x243785(0x1d0)][_0x243785(0x1e7)](_0x243785(0x199),_0x243785(0x1a2),_0x243785(0x184)+_0x2354fb[_0x243785(0x1e2)]+':\x20'+_0x2cf5b8);throw new Error(_0x243785(0x1be)+_0x2354fb[_0x243785(0x1e2)]+_0x243785(0x189)+_0x2cf5b8);}let _0x11025a;try{_0x11025a=JSON[_0x243785(0x1d2)](_0x2cf5b8);}catch(_0x750430){console[_0x243785(0x197)]('Failed\x20to\x20parse\x20JSON\x20response:',_0x750430),loggerService_1['loggerService'][_0x243785(0x1e7)](_0x243785(0x199),_0x243785(0x1a2),'JSON\x20Parse\x20Error:\x20'+_0x750430);throw new Error(_0x243785(0x1b2)+_0x2cf5b8);}console[_0x243785(0x1c7)](_0x243785(0x1f5)),console[_0x243785(0x1c7)]('Parsed\x20Result:',JSON[_0x243785(0x1b9)](_0x11025a,null,0x2)),loggerService_1[_0x243785(0x1d0)]['logWhiteDomainResponse']('rapyd','/v1/hosted/payment_links',_0x2354fb['status'],_0x11025a,_0x9bddd);if(_0x11025a[_0x243785(0x1e2)]?.[_0x243785(0x1e2)]!==_0x243785(0x1e6)){const _0x2ddc5f=_0x11025a['status']?.[_0x243785(0x1fd)]||_0x243785(0x1ed),_0x196658=_0x11025a['status']?.[_0x243785(0x1fb)]||'UNKNOWN';console['error'](_0x243785(0x1db)),console['error'](_0x243785(0x198),_0x196658),console['error'](_0x243785(0x1f2),_0x2ddc5f),console['error'](_0x243785(0x1b0),_0x11025a[_0x243785(0x1e2)]),loggerService_1[_0x243785(0x1d0)][_0x243785(0x1e7)]('rapyd',_0x243785(0x1a2),_0x243785(0x188)+_0x196658+_0x243785(0x1a1)+_0x2ddc5f);throw new Error(_0x243785(0x180)+_0x196658+_0x243785(0x1a1)+_0x2ddc5f);}if(!_0x11025a[_0x243785(0x1d7)]?.['id']||!_0x11025a[_0x243785(0x1d7)]?.[_0x243785(0x194)]){console[_0x243785(0x197)](_0x243785(0x1ec)),console[_0x243785(0x197)]('Missing\x20id\x20or\x20redirect_url\x20in\x20response'),console[_0x243785(0x197)](_0x243785(0x1d1),_0x11025a[_0x243785(0x1d7)]),loggerService_1['loggerService'][_0x243785(0x1e7)](_0x243785(0x199),_0x243785(0x1a2),_0x243785(0x1d3));throw new Error(_0x243785(0x1fc));}return console[_0x243785(0x1c7)]('===\x20RAPYD\x20SUCCESS\x20==='),console['log'](_0x243785(0x1b8),_0x11025a[_0x243785(0x1d7)]['id']),console[_0x243785(0x1c7)](_0x243785(0x1c1),_0x11025a['data'][_0x243785(0x194)]),console[_0x243785(0x1c7)](_0x243785(0x1f0)+_0x119146+'\x20(GB\x20-\x20Britain)'),console[_0x243785(0x1c7)](_0x243785(0x1dc)),{'gateway_payment_id':_0x11025a['data']['id'],'payment_url':_0x11025a[_0x243785(0x1d7)][_0x243785(0x194)]};}catch(_0x445787){console[_0x243785(0x197)](_0x243785(0x1b4)),console[_0x243785(0x197)](_0x243785(0x1bb),_0x445787),loggerService_1['loggerService']['logWhiteDomainError'](_0x243785(0x199),_0x243785(0x1a2),_0x445787);if(_0x445787 instanceof Error){console[_0x243785(0x197)](_0x243785(0x19b),_0x445787[_0x243785(0x1fd)]),console[_0x243785(0x197)](_0x243785(0x187),_0x445787[_0x243785(0x1c8)]);throw new Error(_0x243785(0x1e3)+_0x445787[_0x243785(0x1fd)]);}throw new Error(_0x243785(0x19d));}}async['verifyPayment'](_0x252b9b){const _0x1ece18=a63_0x36630a,_0x52818c=Date[_0x1ece18(0x190)]();try{loggerService_1[_0x1ece18(0x1d0)]['logWhiteDomainRequest'](_0x1ece18(0x199),'/v1/hosted/payment_links/'+_0x252b9b,_0x1ece18(0x1df),{});const _0x45a0e4=await fetch(this[_0x1ece18(0x19e)]+'/'+_0x252b9b,{'method':_0x1ece18(0x1df),'headers':{'Content-Type':_0x1ece18(0x1bf),'User-Agent':'Payment\x20System/1.0'}}),_0x1c2a60=Date[_0x1ece18(0x190)]()-_0x52818c;if(!_0x45a0e4['ok']){const _0x44cab8=await _0x45a0e4[_0x1ece18(0x193)]();loggerService_1[_0x1ece18(0x1d0)][_0x1ece18(0x1e4)](_0x1ece18(0x199),_0x1ece18(0x17d)+_0x252b9b,_0x45a0e4[_0x1ece18(0x1e2)],_0x44cab8,_0x1c2a60);throw new Error(_0x1ece18(0x1be)+_0x45a0e4[_0x1ece18(0x1e2)]);}const _0x2217f4=await _0x45a0e4[_0x1ece18(0x1ff)]();loggerService_1[_0x1ece18(0x1d0)][_0x1ece18(0x1e4)](_0x1ece18(0x199),_0x1ece18(0x17d)+_0x252b9b,_0x45a0e4[_0x1ece18(0x1e2)],_0x2217f4,_0x1c2a60);if(_0x2217f4[_0x1ece18(0x1e2)]?.[_0x1ece18(0x1e2)]!==_0x1ece18(0x1e6)){loggerService_1['loggerService'][_0x1ece18(0x1e7)](_0x1ece18(0x199),_0x1ece18(0x17d)+_0x252b9b,_0x1ece18(0x1a6)+(_0x2217f4[_0x1ece18(0x1e2)]?.[_0x1ece18(0x1fd)]||_0x1ece18(0x1f8)));throw new Error(_0x1ece18(0x1a6)+(_0x2217f4[_0x1ece18(0x1e2)]?.[_0x1ece18(0x1fd)]||_0x1ece18(0x1f8)));}let _0x4c19f2=_0x1ece18(0x1cf);if(_0x2217f4[_0x1ece18(0x1d7)]?.['status'])switch(_0x2217f4['data']['status'][_0x1ece18(0x18d)]()){case _0x1ece18(0x1d6):_0x4c19f2=_0x1ece18(0x1f7);break;case _0x1ece18(0x19a):_0x4c19f2=_0x1ece18(0x1cc);break;case'EXP':_0x4c19f2=_0x1ece18(0x1ae);break;case _0x1ece18(0x192):_0x4c19f2=_0x1ece18(0x1cc);break;case _0x1ece18(0x1ba):case'ACT':default:_0x4c19f2='PENDING';break;}return{'status':_0x4c19f2,'amount':_0x2217f4[_0x1ece18(0x1d7)]?.[_0x1ece18(0x1ee)],'currency':_0x2217f4[_0x1ece18(0x1d7)]?.[_0x1ece18(0x1d4)]};}catch(_0x2297b){console[_0x1ece18(0x197)](_0x1ece18(0x1ea),_0x2297b),loggerService_1[_0x1ece18(0x1d0)][_0x1ece18(0x1e7)](_0x1ece18(0x199),'/v1/hosted/payment_links/'+_0x252b9b,_0x2297b);throw new Error('Failed\x20to\x20verify\x20Rapyd\x20payment:\x20'+(_0x2297b instanceof Error?_0x2297b[_0x1ece18(0x1fd)]:'Unknown\x20error'));}}async[a63_0x36630a(0x1ac)](_0xb63a3d){const _0x46bbdd=a63_0x36630a;console[_0x46bbdd(0x1c7)](_0x46bbdd(0x17f),_0xb63a3d);let _0x72334=_0x46bbdd(0x1cf),_0x4d2392;_0xb63a3d['data']?.['failure_message']&&(_0x4d2392=_0xb63a3d[_0x46bbdd(0x1d7)][_0x46bbdd(0x1ad)],console[_0x46bbdd(0x1c7)](_0x46bbdd(0x1d9)+_0x4d2392));switch(_0xb63a3d['type']?.['toUpperCase']()){case _0x46bbdd(0x195):_0xb63a3d[_0x46bbdd(0x1d7)]?.[_0x46bbdd(0x1b3)]===!![]&&_0xb63a3d[_0x46bbdd(0x1d7)]?.[_0x46bbdd(0x1e2)]==='CLO'?_0x72334=_0x46bbdd(0x1f7):_0x72334=_0x46bbdd(0x1cf);break;case _0x46bbdd(0x196):_0x72334=_0x46bbdd(0x1cc);break;case _0x46bbdd(0x200):_0x72334=_0x46bbdd(0x1ae);break;case _0x46bbdd(0x1c2):_0x72334=_0x46bbdd(0x1cc);!_0x4d2392&&_0xb63a3d[_0x46bbdd(0x1d7)]?.[_0x46bbdd(0x1ad)]&&(_0x4d2392=_0xb63a3d[_0x46bbdd(0x1d7)][_0x46bbdd(0x1ad)]);break;default:switch(_0xb63a3d['data']?.[_0x46bbdd(0x1e2)]?.[_0x46bbdd(0x18d)]()){case'CLO':_0xb63a3d[_0x46bbdd(0x1d7)]?.[_0x46bbdd(0x1b3)]===!![]?_0x72334=_0x46bbdd(0x1f7):_0x72334=_0x46bbdd(0x1cc);break;case _0x46bbdd(0x19a):_0x72334=_0x46bbdd(0x1cc);break;case'EXP':_0x72334=_0x46bbdd(0x1ae);break;case _0x46bbdd(0x192):_0x72334=_0x46bbdd(0x1cc);!_0x4d2392&&_0xb63a3d[_0x46bbdd(0x1d7)]?.['failure_message']&&(_0x4d2392=_0xb63a3d['data'][_0x46bbdd(0x1ad)]);break;case _0x46bbdd(0x1ba):case _0x46bbdd(0x19f):default:_0x72334=_0x46bbdd(0x1cf);break;}break;}const _0x794c5b={};return _0xb63a3d[_0x46bbdd(0x1d7)]?.[_0x46bbdd(0x1f9)]?.[_0x46bbdd(0x181)]&&(_0x794c5b['cardLast4']=_0xb63a3d[_0x46bbdd(0x1d7)][_0x46bbdd(0x1f9)][_0x46bbdd(0x181)]),_0xb63a3d[_0x46bbdd(0x1d7)]?.[_0x46bbdd(0x1a5)]&&(_0x794c5b['paymentMethod']=_0xb63a3d['data'][_0x46bbdd(0x1a5)]),_0xb63a3d[_0x46bbdd(0x1d7)]?.[_0x46bbdd(0x1fb)]&&(_0x794c5b[_0x46bbdd(0x1a4)]=_0xb63a3d[_0x46bbdd(0x1d7)][_0x46bbdd(0x1fb)]),_0xb63a3d[_0x46bbdd(0x1d7)]?.['failure_code']&&(_0x794c5b[_0x46bbdd(0x1ce)]=_0xb63a3d[_0x46bbdd(0x1d7)][_0x46bbdd(0x1cb)]),console[_0x46bbdd(0x1c7)](_0x46bbdd(0x1f1)+_0x72334+_0x46bbdd(0x1de)+(_0x4d2392||_0x46bbdd(0x1aa))),{'paymentId':_0xb63a3d[_0x46bbdd(0x1d7)]?.[_0x46bbdd(0x1fa)]||'','status':_0x72334,'amount':_0xb63a3d['data']?.['amount'],'currency':_0xb63a3d[_0x46bbdd(0x1d7)]?.[_0x46bbdd(0x1d4)],'failureMessage':_0x4d2392,'additionalInfo':_0x794c5b};}}exports[a63_0x36630a(0x182)]=RapydService;