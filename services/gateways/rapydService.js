'use strict';function a42_0x2363(_0x4115db,_0x3350a0){const _0x5bbe5d=a42_0x5bbe();return a42_0x2363=function(_0x23631f,_0x6d0b5){_0x23631f=_0x23631f-0x188;let _0x1b865c=_0x5bbe5d[_0x23631f];return _0x1b865c;},a42_0x2363(_0x4115db,_0x3350a0);}const a42_0x5c5386=a42_0x2363;(function(_0x5c12e6,_0x4cc41d){const _0x18ae93=a42_0x2363,_0x3e5fcb=_0x5c12e6();while(!![]){try{const _0x4210be=-parseInt(_0x18ae93(0x1d4))/0x1*(parseInt(_0x18ae93(0x1a9))/0x2)+parseInt(_0x18ae93(0x18c))/0x3*(parseInt(_0x18ae93(0x1b9))/0x4)+parseInt(_0x18ae93(0x1ed))/0x5+parseInt(_0x18ae93(0x18f))/0x6+parseInt(_0x18ae93(0x1e4))/0x7*(parseInt(_0x18ae93(0x1c2))/0x8)+parseInt(_0x18ae93(0x1e0))/0x9+parseInt(_0x18ae93(0x1e5))/0xa*(-parseInt(_0x18ae93(0x190))/0xb);if(_0x4210be===_0x4cc41d)break;else _0x3e5fcb['push'](_0x3e5fcb['shift']());}catch(_0x527c08){_0x3e5fcb['push'](_0x3e5fcb['shift']());}}}(a42_0x5bbe,0x9353c));Object[a42_0x5c5386(0x1c7)](exports,'__esModule',{'value':!![]}),exports['RapydService']=void 0x0;const loggerService_1=require(a42_0x5c5386(0x192));class RapydService{constructor(){const _0x56ff97=a42_0x5c5386;this[_0x56ff97(0x1ea)]=_0x56ff97(0x1ec),console[_0x56ff97(0x194)](_0x56ff97(0x1c9));}async[a42_0x5c5386(0x18a)](_0x41fa33){const _0x2a5be2=a42_0x5c5386,{orderId:_0x33974c,orderName:_0x382bfd,amount:_0x52eedb,currency:_0x23bec7,usage:_0x30abb1,maxPayments:_0x4c6b60,successUrl:_0xc6742a,failUrl:_0x5bced3}=_0x41fa33,_0x285c91=_0x23bec7['toUpperCase'](),_0x105c0d='GB';console['log']('üá¨üáß\x20Using\x20GB\x20(Britain)\x20as\x20country\x20for\x20Rapyd\x20payment\x20link');const _0x1c8fc8=_0x2a5be2(0x1ef)+_0x33974c,_0x2ef9f6=_0x2a5be2(0x1c8)+_0x33974c,_0x4a1e83={'amount':_0x52eedb,'currency':_0x285c91,'cancel_checkout_url':_0x2ef9f6,'complete_checkout_url':_0x1c8fc8,'complete_payment_url':_0x1c8fc8,'merchant_reference_id':_0x33974c,'description':'ORDER:\x20'+_0x33974c,'country':'GB','payment_method_types_include':[_0x2a5be2(0x1d8),_0x2a5be2(0x1b6)],'custom_elements':{'display_description':!![]}},_0x6b858c=Date[_0x2a5be2(0x1a5)]();try{console[_0x2a5be2(0x194)]('===\x20RAPYD\x20API\x20REQUEST\x20(White\x20Domain\x20-\x20Updated\x20Format)\x20==='),console['log']('URL:',this[_0x2a5be2(0x1ea)]),console[_0x2a5be2(0x194)]('Request\x20Body\x20(Updated\x20Format):',JSON['stringify'](_0x4a1e83,null,0x2)),console[_0x2a5be2(0x194)](_0x2a5be2(0x1e2)+_0x105c0d+_0x2a5be2(0x1cb)),console[_0x2a5be2(0x194)](_0x2a5be2(0x1a6)),loggerService_1[_0x2a5be2(0x191)][_0x2a5be2(0x1d3)](_0x2a5be2(0x199),'/v1/hosted/payment_links','POST',_0x4a1e83);const _0xfefa8f=await fetch(this[_0x2a5be2(0x1ea)],{'method':_0x2a5be2(0x1af),'headers':{'Content-Type':_0x2a5be2(0x1ac),'User-Agent':'TesSoft\x20Payment\x20System/1.0'},'body':JSON[_0x2a5be2(0x1db)](_0x4a1e83)}),_0x5a5aa3=Date[_0x2a5be2(0x1a5)]()-_0x6b858c;console['log'](_0x2a5be2(0x1d0)),console[_0x2a5be2(0x194)](_0x2a5be2(0x1dc),_0xfefa8f[_0x2a5be2(0x196)]),console['log']('Status\x20Text:',_0xfefa8f[_0x2a5be2(0x1dd)]),console[_0x2a5be2(0x194)](_0x2a5be2(0x1da),Object[_0x2a5be2(0x1be)](_0xfefa8f[_0x2a5be2(0x1ad)][_0x2a5be2(0x1f0)]())),console[_0x2a5be2(0x194)]('Response\x20Time:',_0x5a5aa3+'ms');const _0x1627cf=await _0xfefa8f[_0x2a5be2(0x1a0)]();console[_0x2a5be2(0x194)]('Raw\x20Response\x20Body:',_0x1627cf);if(!_0xfefa8f['ok']){console[_0x2a5be2(0x1c3)]('===\x20RAPYD\x20API\x20ERROR\x20==='),console[_0x2a5be2(0x1c3)](_0x2a5be2(0x1bf),_0xfefa8f[_0x2a5be2(0x196)]),console[_0x2a5be2(0x1c3)]('Response\x20Body:',_0x1627cf),loggerService_1[_0x2a5be2(0x191)][_0x2a5be2(0x1f3)](_0x2a5be2(0x199),_0x2a5be2(0x1c1),_0xfefa8f[_0x2a5be2(0x196)],_0x1627cf,_0x5a5aa3),loggerService_1[_0x2a5be2(0x191)]['logWhiteDomainError'](_0x2a5be2(0x199),'/v1/hosted/payment_links',_0x2a5be2(0x1b1)+_0xfefa8f[_0x2a5be2(0x196)]+':\x20'+_0x1627cf);throw new Error(_0x2a5be2(0x198)+_0xfefa8f[_0x2a5be2(0x196)]+_0x2a5be2(0x19f)+_0x1627cf);}let _0x50bf0d;try{_0x50bf0d=JSON[_0x2a5be2(0x18e)](_0x1627cf);}catch(_0x379b83){console[_0x2a5be2(0x1c3)](_0x2a5be2(0x1e7),_0x379b83),loggerService_1['loggerService'][_0x2a5be2(0x19a)](_0x2a5be2(0x199),'/v1/hosted/payment_links',_0x2a5be2(0x1c0)+_0x379b83);throw new Error(_0x2a5be2(0x1a4)+_0x1627cf);}console[_0x2a5be2(0x194)](_0x2a5be2(0x1cd)),console[_0x2a5be2(0x194)](_0x2a5be2(0x1b7),JSON[_0x2a5be2(0x1db)](_0x50bf0d,null,0x2)),loggerService_1[_0x2a5be2(0x191)][_0x2a5be2(0x1f3)]('rapyd',_0x2a5be2(0x1c1),_0xfefa8f[_0x2a5be2(0x196)],_0x50bf0d,_0x5a5aa3);if(_0x50bf0d[_0x2a5be2(0x196)]?.[_0x2a5be2(0x196)]!==_0x2a5be2(0x1aa)){const _0x529ee8=_0x50bf0d[_0x2a5be2(0x196)]?.['message']||_0x2a5be2(0x19d),_0x300f74=_0x50bf0d[_0x2a5be2(0x196)]?.[_0x2a5be2(0x1ae)]||_0x2a5be2(0x1cf);console[_0x2a5be2(0x1c3)](_0x2a5be2(0x1ba)),console[_0x2a5be2(0x1c3)]('Error\x20Code:',_0x300f74),console[_0x2a5be2(0x1c3)](_0x2a5be2(0x1ca),_0x529ee8),console[_0x2a5be2(0x1c3)](_0x2a5be2(0x195),_0x50bf0d[_0x2a5be2(0x196)]),loggerService_1[_0x2a5be2(0x191)][_0x2a5be2(0x19a)]('rapyd',_0x2a5be2(0x1c1),'Business\x20Error\x20('+_0x300f74+_0x2a5be2(0x1b5)+_0x529ee8);throw new Error(_0x2a5be2(0x1c4)+_0x300f74+_0x2a5be2(0x1b5)+_0x529ee8);}if(!_0x50bf0d[_0x2a5be2(0x1ab)]?.['id']||!_0x50bf0d[_0x2a5be2(0x1ab)]?.[_0x2a5be2(0x1df)]){console[_0x2a5be2(0x1c3)](_0x2a5be2(0x188)),console[_0x2a5be2(0x1c3)](_0x2a5be2(0x19b)),console[_0x2a5be2(0x1c3)](_0x2a5be2(0x1d7),_0x50bf0d[_0x2a5be2(0x1ab)]),loggerService_1['loggerService'][_0x2a5be2(0x19a)](_0x2a5be2(0x199),_0x2a5be2(0x1c1),_0x2a5be2(0x1b2));throw new Error('Invalid\x20response\x20from\x20Rapyd\x20API:\x20missing\x20id\x20or\x20redirect_url');}return console['log'](_0x2a5be2(0x19c)),console[_0x2a5be2(0x194)](_0x2a5be2(0x1ce),_0x50bf0d[_0x2a5be2(0x1ab)]['id']),console['log'](_0x2a5be2(0x18d),_0x50bf0d[_0x2a5be2(0x1ab)]['redirect_url']),console['log'](_0x2a5be2(0x1ee)+_0x105c0d+_0x2a5be2(0x1e6)),console['log'](_0x2a5be2(0x1a6)),{'gateway_payment_id':_0x50bf0d['data']['id'],'payment_url':_0x50bf0d[_0x2a5be2(0x1ab)][_0x2a5be2(0x1df)]};}catch(_0x2e6361){console[_0x2a5be2(0x1c3)](_0x2a5be2(0x1a2)),console[_0x2a5be2(0x1c3)]('Error\x20details:',_0x2e6361),loggerService_1[_0x2a5be2(0x191)][_0x2a5be2(0x19a)](_0x2a5be2(0x199),_0x2a5be2(0x1c1),_0x2e6361);if(_0x2e6361 instanceof Error){console['error'](_0x2a5be2(0x1f2),_0x2e6361['message']),console[_0x2a5be2(0x1c3)](_0x2a5be2(0x1c5),_0x2e6361[_0x2a5be2(0x18b)]);throw new Error(_0x2a5be2(0x1cc)+_0x2e6361[_0x2a5be2(0x19e)]);}throw new Error(_0x2a5be2(0x1a1));}}async[a42_0x5c5386(0x193)](_0x1eb459){const _0x2bb391=a42_0x5c5386,_0x322be8=Date[_0x2bb391(0x1a5)]();try{loggerService_1[_0x2bb391(0x191)][_0x2bb391(0x1d3)](_0x2bb391(0x199),_0x2bb391(0x1b8)+_0x1eb459,_0x2bb391(0x1b0),{});const _0x23fc68=await fetch(this[_0x2bb391(0x1ea)]+'/'+_0x1eb459,{'method':'GET','headers':{'Content-Type':'application/json','User-Agent':_0x2bb391(0x1f5)}}),_0x2d1552=Date[_0x2bb391(0x1a5)]()-_0x322be8;if(!_0x23fc68['ok']){const _0x2e13da=await _0x23fc68['text']();loggerService_1[_0x2bb391(0x191)][_0x2bb391(0x1f3)](_0x2bb391(0x199),_0x2bb391(0x1b8)+_0x1eb459,_0x23fc68[_0x2bb391(0x196)],_0x2e13da,_0x2d1552);throw new Error(_0x2bb391(0x198)+_0x23fc68[_0x2bb391(0x196)]);}const _0x13ffc3=await _0x23fc68[_0x2bb391(0x1d2)]();loggerService_1[_0x2bb391(0x191)][_0x2bb391(0x1f3)](_0x2bb391(0x199),_0x2bb391(0x1b8)+_0x1eb459,_0x23fc68['status'],_0x13ffc3,_0x2d1552);if(_0x13ffc3[_0x2bb391(0x196)]?.[_0x2bb391(0x196)]!=='SUCCESS'){loggerService_1[_0x2bb391(0x191)]['logWhiteDomainError']('rapyd','/v1/hosted/payment_links/'+_0x1eb459,_0x2bb391(0x1e8)+(_0x13ffc3[_0x2bb391(0x196)]?.['message']||_0x2bb391(0x1f4)));throw new Error(_0x2bb391(0x1e8)+(_0x13ffc3[_0x2bb391(0x196)]?.[_0x2bb391(0x19e)]||_0x2bb391(0x1f4)));}let _0x35def1=_0x2bb391(0x1a7);if(_0x13ffc3[_0x2bb391(0x1ab)]?.[_0x2bb391(0x196)])switch(_0x13ffc3[_0x2bb391(0x1ab)][_0x2bb391(0x196)][_0x2bb391(0x1a3)]()){case _0x2bb391(0x1b4):_0x35def1=_0x2bb391(0x189);break;case'CAN':_0x35def1=_0x2bb391(0x1d1);break;case'EXP':_0x35def1=_0x2bb391(0x1a8);break;case _0x2bb391(0x1d5):_0x35def1=_0x2bb391(0x1d1);break;case _0x2bb391(0x1de):case'ACT':default:_0x35def1=_0x2bb391(0x1a7);break;}return{'status':_0x35def1,'amount':_0x13ffc3[_0x2bb391(0x1ab)]?.['amount'],'currency':_0x13ffc3[_0x2bb391(0x1ab)]?.[_0x2bb391(0x1e3)]};}catch(_0x179cca){console[_0x2bb391(0x1c3)]('Rapyd\x20payment\x20verification\x20error:',_0x179cca),loggerService_1['loggerService']['logWhiteDomainError']('rapyd',_0x2bb391(0x1b8)+_0x1eb459,_0x179cca);throw new Error(_0x2bb391(0x1bb)+(_0x179cca instanceof Error?_0x179cca[_0x2bb391(0x19e)]:'Unknown\x20error'));}}async[a42_0x5c5386(0x1e9)](_0x3a403f){const _0x2bd1bf=a42_0x5c5386;console[_0x2bd1bf(0x194)](_0x2bd1bf(0x197),_0x3a403f);let _0x45e780='PENDING';switch(_0x3a403f[_0x2bd1bf(0x1d9)]?.[_0x2bd1bf(0x1a3)]()){case _0x2bd1bf(0x1f1):_0x3a403f['data']?.[_0x2bd1bf(0x1b3)]===!![]&&_0x3a403f[_0x2bd1bf(0x1ab)]?.[_0x2bd1bf(0x196)]===_0x2bd1bf(0x1b4)?_0x45e780=_0x2bd1bf(0x189):_0x45e780=_0x2bd1bf(0x1a7);break;case _0x2bd1bf(0x1bd):_0x45e780=_0x2bd1bf(0x1d1);break;case _0x2bd1bf(0x1d6):_0x45e780='EXPIRED';break;case'PAYMENT_FAILED':_0x45e780=_0x2bd1bf(0x1d1);break;default:switch(_0x3a403f[_0x2bd1bf(0x1ab)]?.['status']?.[_0x2bd1bf(0x1a3)]()){case _0x2bd1bf(0x1b4):_0x3a403f[_0x2bd1bf(0x1ab)]?.[_0x2bd1bf(0x1b3)]===!![]?_0x45e780='PAID':_0x45e780=_0x2bd1bf(0x1d1);break;case _0x2bd1bf(0x1c6):_0x45e780=_0x2bd1bf(0x1d1);break;case'EXP':_0x45e780=_0x2bd1bf(0x1a8);break;case _0x2bd1bf(0x1d5):_0x45e780='FAILED';break;case _0x2bd1bf(0x1de):case _0x2bd1bf(0x1e1):default:_0x45e780=_0x2bd1bf(0x1a7);break;}break;}return{'paymentId':_0x3a403f[_0x2bd1bf(0x1ab)]?.[_0x2bd1bf(0x1eb)]||'','status':_0x45e780,'amount':_0x3a403f[_0x2bd1bf(0x1ab)]?.['amount'],'currency':_0x3a403f[_0x2bd1bf(0x1ab)]?.[_0x2bd1bf(0x1e3)]};}}function a42_0x5bbe(){const _0x2c6e57=['Failed\x20to\x20create\x20Rapyd\x20payment\x20link:\x20','===\x20PARSED\x20RAPYD\x20RESPONSE\x20===','Payment\x20Link\x20ID:','UNKNOWN','===\x20RAPYD\x20API\x20RESPONSE\x20(White\x20Domain)\x20===','FAILED','json','logWhiteDomainRequest','7561RiHzsS','ERR','PAYMENT_EXPIRED','Response\x20data:','gb_visa_card','type','Headers:','stringify','Status:','statusText','NEW','redirect_url','4928760tCCbGG','ACT','üá¨üáß\x20Country:\x20','currency','3962987sdYkVp','621870EVvUJD','\x20(GB\x20-\x20Britain)','Failed\x20to\x20parse\x20JSON\x20response:','Rapyd\x20API\x20error:\x20','processWebhook','apiUrl','merchant_reference_id','https://tesoft.uk/gateway/rapyd/','120930aYVzXx','üá¨üáß\x20Country\x20used:\x20','https://tesoft.uk/gateway/success.php?id=','entries','PAYMENT_COMPLETED','Error\x20message:','logWhiteDomainResponse','Unknown\x20error','TesSoft\x20Payment\x20System/1.0','===\x20RAPYD\x20API\x20INCOMPLETE\x20RESPONSE\x20===','PAID','createPaymentLink','stack','19653CENRsR','Redirect\x20URL:','parse','5888562DbHKoq','264ESMoXV','loggerService','../loggerService','verifyPayment','log','Full\x20Error\x20Data:','status','Processing\x20Rapyd\x20webhook:','HTTP\x20error!\x20status:\x20','rapyd','logWhiteDomainError','Missing\x20id\x20or\x20redirect_url\x20in\x20response','===\x20RAPYD\x20SUCCESS\x20===','Unknown\x20error\x20from\x20Rapyd\x20API','message',',\x20body:\x20','text','Failed\x20to\x20create\x20Rapyd\x20payment\x20link:\x20Unknown\x20error','===\x20RAPYD\x20SERVICE\x20ERROR\x20===','toUpperCase','Invalid\x20JSON\x20response\x20from\x20Rapyd\x20API:\x20','now','üí≥\x20Payment\x20Methods:\x20gb_visa_card,\x20gb_mastercard_card','PENDING','EXPIRED','254UdCjbX','SUCCESS','data','application/json','headers','error_code','POST','GET','HTTP\x20','Incomplete\x20response:\x20missing\x20id\x20or\x20redirect_url','paid','CLO','):\x20','gb_mastercard_card','Parsed\x20Result:','/v1/hosted/payment_links/','572LWBEbe','===\x20RAPYD\x20API\x20BUSINESS\x20ERROR\x20===','Failed\x20to\x20verify\x20Rapyd\x20payment:\x20','RapydService','PAYMENT_CANCELED','fromEntries','HTTP\x20Status:','JSON\x20Parse\x20Error:\x20','/v1/hosted/payment_links','8exgehg','error','Rapyd\x20API\x20error\x20(','Error\x20stack:','CAN','defineProperty','https://tesoft.uk/gateway/fail.php?id=','üåê\x20Rapyd\x20service\x20initialized\x20with\x20white\x20domain\x20proxy','Error\x20Message:','\x20(always\x20GB\x20for\x20Rapyd)'];a42_0x5bbe=function(){return _0x2c6e57;};return a42_0x5bbe();}exports[a42_0x5c5386(0x1bc)]=RapydService;