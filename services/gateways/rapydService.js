'use strict';const a45_0x1d780a=a45_0x4bfd;function a45_0x4bfd(_0x11360c,_0x49bc62){const _0x10f002=a45_0x10f0();return a45_0x4bfd=function(_0x4bfdd2,_0x5c75c2){_0x4bfdd2=_0x4bfdd2-0x85;let _0x16d67f=_0x10f002[_0x4bfdd2];return _0x16d67f;},a45_0x4bfd(_0x11360c,_0x49bc62);}(function(_0xe65539,_0x21cd5f){const _0x41392f=a45_0x4bfd,_0x3decab=_0xe65539();while(!![]){try{const _0x1ac714=-parseInt(_0x41392f(0x8a))/0x1+-parseInt(_0x41392f(0xf0))/0x2+parseInt(_0x41392f(0xba))/0x3*(-parseInt(_0x41392f(0xa4))/0x4)+-parseInt(_0x41392f(0xdb))/0x5*(parseInt(_0x41392f(0xcb))/0x6)+-parseInt(_0x41392f(0xa2))/0x7*(parseInt(_0x41392f(0x9a))/0x8)+parseInt(_0x41392f(0xaf))/0x9+parseInt(_0x41392f(0xc4))/0xa;if(_0x1ac714===_0x21cd5f)break;else _0x3decab['push'](_0x3decab['shift']());}catch(_0x426987){_0x3decab['push'](_0x3decab['shift']());}}}(a45_0x10f0,0x4bbcd));Object['defineProperty'](exports,a45_0x1d780a(0x87),{'value':!![]}),exports['RapydService']=void 0x0;const loggerService_1=require(a45_0x1d780a(0xf2));class RapydService{constructor(){const _0x4381f9=a45_0x1d780a;this['apiUrl']=_0x4381f9(0xe2),console[_0x4381f9(0x93)](_0x4381f9(0xb7));}async[a45_0x1d780a(0xe5)](_0x4ac86b){const _0x2982cc=a45_0x1d780a,{orderId:_0x379f5e,orderName:_0x226506,amount:_0x82498e,currency:_0x370641,usage:_0x35cc66,maxPayments:_0xd395e9,successUrl:_0x21a141,failUrl:_0x1a3a8d}=_0x4ac86b,_0x1fed75=_0x370641[_0x2982cc(0xe8)](),_0x142b8e='GB';console[_0x2982cc(0x93)]('🇬🇧\x20Using\x20GB\x20(Britain)\x20as\x20country\x20for\x20Rapyd\x20payment\x20link');const _0x4b48a0=_0x2982cc(0xa9)+_0x379f5e,_0x502159=_0x2982cc(0xa5)+_0x379f5e,_0x3523c={'amount':_0x82498e,'currency':_0x1fed75,'cancel_checkout_url':_0x502159,'complete_checkout_url':_0x4b48a0,'complete_payment_url':_0x4b48a0,'merchant_reference_id':_0x379f5e,'description':_0x2982cc(0x99)+_0x379f5e,'country':'GB','payment_method_types_include':[_0x2982cc(0xc6),'gb_mastercard_card'],'custom_elements':{'display_description':!![]}},_0x4579ae=Date[_0x2982cc(0x91)]();try{console[_0x2982cc(0x93)](_0x2982cc(0x86)),console[_0x2982cc(0x93)](_0x2982cc(0xd8),this[_0x2982cc(0xef)]),console['log'](_0x2982cc(0xd5),JSON[_0x2982cc(0xd1)](_0x3523c,null,0x2)),console[_0x2982cc(0x93)](_0x2982cc(0xda)+_0x142b8e+'\x20(always\x20GB\x20for\x20Rapyd)'),console[_0x2982cc(0x93)]('💳\x20Payment\x20Methods:\x20gb_visa_card,\x20gb_mastercard_card'),loggerService_1[_0x2982cc(0xc0)][_0x2982cc(0xa7)]('rapyd',_0x2982cc(0xd9),_0x2982cc(0xcc),_0x3523c);const _0x2208ea=await fetch(this['apiUrl'],{'method':_0x2982cc(0xcc),'headers':{'Content-Type':_0x2982cc(0xec),'User-Agent':_0x2982cc(0xfc)},'body':JSON[_0x2982cc(0xd1)](_0x3523c)}),_0xc9e1ca=Date[_0x2982cc(0x91)]()-_0x4579ae;console['log']('===\x20RAPYD\x20API\x20RESPONSE\x20(White\x20Domain)\x20==='),console[_0x2982cc(0x93)](_0x2982cc(0xb8),_0x2208ea[_0x2982cc(0xa6)]),console[_0x2982cc(0x93)](_0x2982cc(0x85),_0x2208ea[_0x2982cc(0xb2)]),console['log']('Headers:',Object[_0x2982cc(0xcf)](_0x2208ea[_0x2982cc(0xc3)]['entries']())),console['log'](_0x2982cc(0xdc),_0xc9e1ca+'ms');const _0x4576ad=await _0x2208ea[_0x2982cc(0xb9)]();console[_0x2982cc(0x93)](_0x2982cc(0xfa),_0x4576ad);if(!_0x2208ea['ok']){console['error']('===\x20RAPYD\x20API\x20ERROR\x20==='),console['error'](_0x2982cc(0xf5),_0x2208ea['status']),console[_0x2982cc(0xc2)](_0x2982cc(0xfd),_0x4576ad),loggerService_1[_0x2982cc(0xc0)][_0x2982cc(0xb6)](_0x2982cc(0xae),_0x2982cc(0xd9),_0x2208ea[_0x2982cc(0xa6)],_0x4576ad,_0xc9e1ca),loggerService_1[_0x2982cc(0xc0)][_0x2982cc(0xb1)](_0x2982cc(0xae),'/v1/hosted/payment_links',_0x2982cc(0xb3)+_0x2208ea['status']+':\x20'+_0x4576ad);throw new Error(_0x2982cc(0xc5)+_0x2208ea[_0x2982cc(0xa6)]+_0x2982cc(0xe3)+_0x4576ad);}let _0x13a6a2;try{_0x13a6a2=JSON[_0x2982cc(0x90)](_0x4576ad);}catch(_0x58e9e7){console[_0x2982cc(0xc2)](_0x2982cc(0x8c),_0x58e9e7),loggerService_1['loggerService'][_0x2982cc(0xb1)]('rapyd',_0x2982cc(0xd9),_0x2982cc(0xac)+_0x58e9e7);throw new Error(_0x2982cc(0xbe)+_0x4576ad);}console['log'](_0x2982cc(0xbd)),console[_0x2982cc(0x93)]('Parsed\x20Result:',JSON[_0x2982cc(0xd1)](_0x13a6a2,null,0x2)),loggerService_1['loggerService']['logWhiteDomainResponse'](_0x2982cc(0xae),_0x2982cc(0xd9),_0x2208ea['status'],_0x13a6a2,_0xc9e1ca);if(_0x13a6a2[_0x2982cc(0xa6)]?.[_0x2982cc(0xa6)]!==_0x2982cc(0xaa)){const _0x4f797d=_0x13a6a2['status']?.[_0x2982cc(0xed)]||_0x2982cc(0xbc),_0x3f4c49=_0x13a6a2[_0x2982cc(0xa6)]?.['error_code']||_0x2982cc(0xd6);console['error'](_0x2982cc(0xa8)),console[_0x2982cc(0xc2)](_0x2982cc(0xd7),_0x3f4c49),console['error']('Error\x20Message:',_0x4f797d),console[_0x2982cc(0xc2)](_0x2982cc(0x8d),_0x13a6a2[_0x2982cc(0xa6)]),loggerService_1[_0x2982cc(0xc0)][_0x2982cc(0xb1)](_0x2982cc(0xae),_0x2982cc(0xd9),'Business\x20Error\x20('+_0x3f4c49+'):\x20'+_0x4f797d);throw new Error('Rapyd\x20API\x20error\x20('+_0x3f4c49+_0x2982cc(0xd3)+_0x4f797d);}if(!_0x13a6a2[_0x2982cc(0xee)]?.['id']||!_0x13a6a2['data']?.[_0x2982cc(0xd4)]){console['error'](_0x2982cc(0x95)),console[_0x2982cc(0xc2)](_0x2982cc(0xb5)),console[_0x2982cc(0xc2)]('Response\x20data:',_0x13a6a2[_0x2982cc(0xee)]),loggerService_1['loggerService']['logWhiteDomainError']('rapyd','/v1/hosted/payment_links','Incomplete\x20response:\x20missing\x20id\x20or\x20redirect_url');throw new Error(_0x2982cc(0x97));}return console[_0x2982cc(0x93)](_0x2982cc(0xe4)),console['log']('Payment\x20Link\x20ID:',_0x13a6a2['data']['id']),console[_0x2982cc(0x93)](_0x2982cc(0xa1),_0x13a6a2['data'][_0x2982cc(0xd4)]),console[_0x2982cc(0x93)](_0x2982cc(0x88)+_0x142b8e+_0x2982cc(0xff)),console[_0x2982cc(0x93)](_0x2982cc(0x94)),{'gateway_payment_id':_0x13a6a2[_0x2982cc(0xee)]['id'],'payment_url':_0x13a6a2[_0x2982cc(0xee)][_0x2982cc(0xd4)]};}catch(_0x13dd3c){console['error'](_0x2982cc(0xde)),console[_0x2982cc(0xc2)](_0x2982cc(0x92),_0x13dd3c),loggerService_1['loggerService'][_0x2982cc(0xb1)]('rapyd',_0x2982cc(0xd9),_0x13dd3c);if(_0x13dd3c instanceof Error){console['error'](_0x2982cc(0xc9),_0x13dd3c[_0x2982cc(0xed)]),console[_0x2982cc(0xc2)]('Error\x20stack:',_0x13dd3c[_0x2982cc(0xa3)]);throw new Error(_0x2982cc(0xe1)+_0x13dd3c[_0x2982cc(0xed)]);}throw new Error(_0x2982cc(0xa0));}}async['verifyPayment'](_0x55aaac){const _0x45be77=a45_0x1d780a,_0x440283=Date[_0x45be77(0x91)]();try{loggerService_1['loggerService'][_0x45be77(0xa7)](_0x45be77(0xae),_0x45be77(0xc7)+_0x55aaac,'GET',{});const _0x1460a3=await fetch(this[_0x45be77(0xef)]+'/'+_0x55aaac,{'method':_0x45be77(0x8b),'headers':{'Content-Type':_0x45be77(0xec),'User-Agent':_0x45be77(0xfc)}}),_0x3885c9=Date[_0x45be77(0x91)]()-_0x440283;if(!_0x1460a3['ok']){const _0x510ab4=await _0x1460a3[_0x45be77(0xb9)]();loggerService_1[_0x45be77(0xc0)]['logWhiteDomainResponse'](_0x45be77(0xae),_0x45be77(0xc7)+_0x55aaac,_0x1460a3['status'],_0x510ab4,_0x3885c9);throw new Error(_0x45be77(0xc5)+_0x1460a3['status']);}const _0x802093=await _0x1460a3[_0x45be77(0xe7)]();loggerService_1[_0x45be77(0xc0)][_0x45be77(0xb6)]('rapyd',_0x45be77(0xc7)+_0x55aaac,_0x1460a3[_0x45be77(0xa6)],_0x802093,_0x3885c9);if(_0x802093[_0x45be77(0xa6)]?.[_0x45be77(0xa6)]!=='SUCCESS'){loggerService_1[_0x45be77(0xc0)][_0x45be77(0xb1)]('rapyd',_0x45be77(0xc7)+_0x55aaac,_0x45be77(0x96)+(_0x802093[_0x45be77(0xa6)]?.[_0x45be77(0xed)]||'Unknown\x20error'));throw new Error(_0x45be77(0x96)+(_0x802093['status']?.[_0x45be77(0xed)]||_0x45be77(0xeb)));}let _0x2bfb1a='PENDING';if(_0x802093[_0x45be77(0xee)]?.[_0x45be77(0xa6)])switch(_0x802093[_0x45be77(0xee)][_0x45be77(0xa6)][_0x45be77(0xe8)]()){case _0x45be77(0xb0):_0x2bfb1a=_0x45be77(0xf9);break;case'CAN':_0x2bfb1a=_0x45be77(0xc1);break;case _0x45be77(0xf7):_0x2bfb1a=_0x45be77(0xe9);break;case _0x45be77(0xfe):_0x2bfb1a=_0x45be77(0xc1);break;case _0x45be77(0xf8):case _0x45be77(0x89):default:_0x2bfb1a='PENDING';break;}return{'status':_0x2bfb1a,'amount':_0x802093['data']?.[_0x45be77(0x9d)],'currency':_0x802093['data']?.[_0x45be77(0xdd)]};}catch(_0x811432){console[_0x45be77(0xc2)](_0x45be77(0xcd),_0x811432),loggerService_1[_0x45be77(0xc0)]['logWhiteDomainError'](_0x45be77(0xae),_0x45be77(0xc7)+_0x55aaac,_0x811432);throw new Error(_0x45be77(0x9b)+(_0x811432 instanceof Error?_0x811432[_0x45be77(0xed)]:_0x45be77(0xeb)));}}async[a45_0x1d780a(0xbf)](_0x191e30){const _0x3b731a=a45_0x1d780a;console[_0x3b731a(0x93)](_0x3b731a(0xf1),_0x191e30);let _0x2dc202=_0x3b731a(0xe0),_0x32bab1;_0x191e30[_0x3b731a(0xee)]?.[_0x3b731a(0xf4)]&&(_0x32bab1=_0x191e30[_0x3b731a(0xee)]['failure_message'],console[_0x3b731a(0x93)]('💥\x20Rapyd\x20failure\x20message:\x20'+_0x32bab1));switch(_0x191e30[_0x3b731a(0xe6)]?.['toUpperCase']()){case _0x3b731a(0xea):_0x191e30[_0x3b731a(0xee)]?.[_0x3b731a(0xbb)]===!![]&&_0x191e30[_0x3b731a(0xee)]?.[_0x3b731a(0xa6)]===_0x3b731a(0xb0)?_0x2dc202='PAID':_0x2dc202=_0x3b731a(0xe0);break;case _0x3b731a(0xab):_0x2dc202='FAILED';break;case _0x3b731a(0x9c):_0x2dc202=_0x3b731a(0xe9);break;case _0x3b731a(0x98):_0x2dc202='FAILED';!_0x32bab1&&_0x191e30['data']?.[_0x3b731a(0xf4)]&&(_0x32bab1=_0x191e30['data'][_0x3b731a(0xf4)]);break;default:switch(_0x191e30[_0x3b731a(0xee)]?.[_0x3b731a(0xa6)]?.[_0x3b731a(0xe8)]()){case _0x3b731a(0xb0):_0x191e30[_0x3b731a(0xee)]?.['paid']===!![]?_0x2dc202='PAID':_0x2dc202=_0x3b731a(0xc1);break;case _0x3b731a(0xca):_0x2dc202=_0x3b731a(0xc1);break;case _0x3b731a(0xf7):_0x2dc202=_0x3b731a(0xe9);break;case'ERR':_0x2dc202=_0x3b731a(0xc1);!_0x32bab1&&_0x191e30['data']?.[_0x3b731a(0xf4)]&&(_0x32bab1=_0x191e30['data']['failure_message']);break;case _0x3b731a(0xf8):case _0x3b731a(0x89):default:_0x2dc202='PENDING';break;}break;}const _0x107bf0={};return _0x191e30['data']?.[_0x3b731a(0xc8)]?.[_0x3b731a(0xfb)]&&(_0x107bf0[_0x3b731a(0xf6)]=_0x191e30[_0x3b731a(0xee)][_0x3b731a(0xc8)]['last4']),_0x191e30['data']?.[_0x3b731a(0xb4)]&&(_0x107bf0[_0x3b731a(0x9f)]=_0x191e30[_0x3b731a(0xee)]['payment_method_type']),_0x191e30[_0x3b731a(0xee)]?.['error_code']&&(_0x107bf0[_0x3b731a(0xad)]=_0x191e30[_0x3b731a(0xee)][_0x3b731a(0xdf)]),_0x191e30['data']?.['failure_code']&&(_0x107bf0[_0x3b731a(0x8f)]=_0x191e30[_0x3b731a(0xee)][_0x3b731a(0xd2)]),console[_0x3b731a(0x93)](_0x3b731a(0x8e)+_0x2dc202+_0x3b731a(0xce)+(_0x32bab1||_0x3b731a(0xd0))),{'paymentId':_0x191e30[_0x3b731a(0xee)]?.[_0x3b731a(0xf3)]||'','status':_0x2dc202,'amount':_0x191e30['data']?.[_0x3b731a(0x9d)],'currency':_0x191e30['data']?.[_0x3b731a(0xdd)],'failureMessage':_0x32bab1,'additionalInfo':_0x107bf0};}}function a45_0x10f0(){const _0x288aec=['324lLhEMf','POST','Rapyd\x20payment\x20verification\x20error:',',\x20failureMessage=','fromEntries','none','stringify','failure_code','):\x20','redirect_url','Request\x20Body\x20(Updated\x20Format):','UNKNOWN','Error\x20Code:','URL:','/v1/hosted/payment_links','🇬🇧\x20Country:\x20','6280TfEpoB','Response\x20Time:','currency','===\x20RAPYD\x20SERVICE\x20ERROR\x20===','error_code','PENDING','Failed\x20to\x20create\x20Rapyd\x20payment\x20link:\x20','https://tesoft.uk/gateway/rapyd/',',\x20body:\x20','===\x20RAPYD\x20SUCCESS\x20===','createPaymentLink','type','json','toUpperCase','EXPIRED','PAYMENT_COMPLETED','Unknown\x20error','application/json','message','data','apiUrl','995992gDnvmC','Processing\x20Rapyd\x20webhook:','../loggerService','merchant_reference_id','failure_message','HTTP\x20Status:','cardLast4','EXP','NEW','PAID','Raw\x20Response\x20Body:','last4','TesSoft\x20Payment\x20System/1.0','Response\x20Body:','ERR','\x20(GB\x20-\x20Britain)','Status\x20Text:','===\x20RAPYD\x20API\x20REQUEST\x20(White\x20Domain\x20-\x20Updated\x20Format)\x20===','__esModule','🇬🇧\x20Country\x20used:\x20','ACT','385690swCsiw','GET','Failed\x20to\x20parse\x20JSON\x20response:','Full\x20Error\x20Data:','🔄\x20Rapyd\x20webhook\x20processed:\x20status=','failureCode','parse','now','Error\x20details:','log','💳\x20Payment\x20Methods:\x20gb_visa_card,\x20gb_mastercard_card','===\x20RAPYD\x20API\x20INCOMPLETE\x20RESPONSE\x20===','Rapyd\x20API\x20error:\x20','Invalid\x20response\x20from\x20Rapyd\x20API:\x20missing\x20id\x20or\x20redirect_url','PAYMENT_FAILED','ORDER:\x20','624856woAnXX','Failed\x20to\x20verify\x20Rapyd\x20payment:\x20','PAYMENT_EXPIRED','amount','RapydService','paymentMethod','Failed\x20to\x20create\x20Rapyd\x20payment\x20link:\x20Unknown\x20error','Redirect\x20URL:','35Yrbwnx','stack','20vqKAeW','https://tesoft.uk/gateway/fail.php?id=','status','logWhiteDomainRequest','===\x20RAPYD\x20API\x20BUSINESS\x20ERROR\x20===','https://tesoft.uk/gateway/success.php?id=','SUCCESS','PAYMENT_CANCELED','JSON\x20Parse\x20Error:\x20','errorCode','rapyd','1652049HIOZcS','CLO','logWhiteDomainError','statusText','HTTP\x20','payment_method_type','Missing\x20id\x20or\x20redirect_url\x20in\x20response','logWhiteDomainResponse','🌐\x20Rapyd\x20service\x20initialized\x20with\x20white\x20domain\x20proxy','Status:','text','126897erRZlr','paid','Unknown\x20error\x20from\x20Rapyd\x20API','===\x20PARSED\x20RAPYD\x20RESPONSE\x20===','Invalid\x20JSON\x20response\x20from\x20Rapyd\x20API:\x20','processWebhook','loggerService','FAILED','error','headers','16802000iBtidg','HTTP\x20error!\x20status:\x20','gb_visa_card','/v1/hosted/payment_links/','payment_method_data','Error\x20message:','CAN'];a45_0x10f0=function(){return _0x288aec;};return a45_0x10f0();}exports[a45_0x1d780a(0x9e)]=RapydService;