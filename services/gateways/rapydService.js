'use strict';const a45_0x22578d=a45_0x29ff;(function(_0x1576e1,_0x5108b3){const _0x4f6dba=a45_0x29ff,_0xcec593=_0x1576e1();while(!![]){try{const _0x36ae2b=-parseInt(_0x4f6dba(0xa8))/0x1*(parseInt(_0x4f6dba(0x84))/0x2)+parseInt(_0x4f6dba(0xc2))/0x3*(-parseInt(_0x4f6dba(0xac))/0x4)+-parseInt(_0x4f6dba(0x95))/0x5*(-parseInt(_0x4f6dba(0x73))/0x6)+-parseInt(_0x4f6dba(0xc8))/0x7+-parseInt(_0x4f6dba(0xc0))/0x8+parseInt(_0x4f6dba(0x93))/0x9+-parseInt(_0x4f6dba(0x88))/0xa*(-parseInt(_0x4f6dba(0xc4))/0xb);if(_0x36ae2b===_0x5108b3)break;else _0xcec593['push'](_0xcec593['shift']());}catch(_0x12ebdc){_0xcec593['push'](_0xcec593['shift']());}}}(a45_0x172c,0x824d9));Object[a45_0x22578d(0x78)](exports,'__esModule',{'value':!![]}),exports[a45_0x22578d(0x76)]=void 0x0;const loggerService_1=require(a45_0x22578d(0xa4));class RapydService{constructor(){const _0x1ea8e9=a45_0x22578d;this[_0x1ea8e9(0xb0)]=_0x1ea8e9(0xdf),console[_0x1ea8e9(0x7c)](_0x1ea8e9(0x9f));}async[a45_0x22578d(0xb9)](_0x56e33c){const _0x1601a0=a45_0x22578d,{orderId:_0x54cb02,orderName:_0x2e0162,amount:_0x1b4226,currency:_0x1ff93c,usage:_0x1e5721,maxPayments:_0x1bd0a8,successUrl:_0x199dec,failUrl:_0x56b660}=_0x56e33c,_0x2ce43d=_0x1ff93c['toUpperCase'](),_0x3040e7='GB';console[_0x1601a0(0x7c)](_0x1601a0(0xd5));const _0x57671f=_0x1601a0(0xd3)+_0x54cb02,_0x51955c=_0x1601a0(0xcd)+_0x54cb02,_0x6e3695={'amount':_0x1b4226,'currency':_0x2ce43d,'cancel_checkout_url':_0x51955c,'complete_checkout_url':_0x57671f,'complete_payment_url':_0x57671f,'merchant_reference_id':_0x54cb02,'description':_0x1601a0(0x7a)+_0x54cb02,'country':'GB','payment_method_types_include':[_0x1601a0(0x7b),_0x1601a0(0x8a)],'custom_elements':{'display_description':!![]}},_0x6ba7f6=Date[_0x1601a0(0xba)]();try{console[_0x1601a0(0x7c)]('===\x20RAPYD\x20API\x20REQUEST\x20(White\x20Domain\x20-\x20Updated\x20Format)\x20==='),console['log'](_0x1601a0(0xb1),this['apiUrl']),console['log'](_0x1601a0(0x6c),JSON[_0x1601a0(0x81)](_0x6e3695,null,0x2)),console[_0x1601a0(0x7c)](_0x1601a0(0xda)+_0x3040e7+_0x1601a0(0x94)),console[_0x1601a0(0x7c)](_0x1601a0(0xdd)),loggerService_1['loggerService'][_0x1601a0(0x9a)]('rapyd',_0x1601a0(0xc1),'POST',_0x6e3695);const _0x516649=await fetch(this[_0x1601a0(0xb0)],{'method':_0x1601a0(0x8d),'headers':{'Content-Type':_0x1601a0(0xc6),'User-Agent':_0x1601a0(0xca)},'body':JSON['stringify'](_0x6e3695)}),_0x269ab2=Date[_0x1601a0(0xba)]()-_0x6ba7f6;console['log'](_0x1601a0(0x8c)),console[_0x1601a0(0x7c)]('Status:',_0x516649[_0x1601a0(0xcc)]),console[_0x1601a0(0x7c)](_0x1601a0(0xae),_0x516649['statusText']),console[_0x1601a0(0x7c)]('Headers:',Object['fromEntries'](_0x516649['headers'][_0x1601a0(0xc9)]())),console['log']('Response\x20Time:',_0x269ab2+'ms');const _0x13bf27=await _0x516649[_0x1601a0(0x82)]();console['log']('Raw\x20Response\x20Body:',_0x13bf27);if(!_0x516649['ok']){console['error']('===\x20RAPYD\x20API\x20ERROR\x20==='),console[_0x1601a0(0x89)]('HTTP\x20Status:',_0x516649[_0x1601a0(0xcc)]),console['error'](_0x1601a0(0x9c),_0x13bf27),loggerService_1[_0x1601a0(0xd9)][_0x1601a0(0xa9)]('rapyd',_0x1601a0(0xc1),_0x516649[_0x1601a0(0xcc)],_0x13bf27,_0x269ab2),loggerService_1['loggerService'][_0x1601a0(0xd4)](_0x1601a0(0x97),_0x1601a0(0xc1),_0x1601a0(0xd6)+_0x516649[_0x1601a0(0xcc)]+':\x20'+_0x13bf27);throw new Error(_0x1601a0(0x7f)+_0x516649[_0x1601a0(0xcc)]+_0x1601a0(0x7e)+_0x13bf27);}let _0x3238fe;try{_0x3238fe=JSON[_0x1601a0(0x7d)](_0x13bf27);}catch(_0x1e615a){console['error'](_0x1601a0(0x9e),_0x1e615a),loggerService_1[_0x1601a0(0xd9)][_0x1601a0(0xd4)](_0x1601a0(0x97),_0x1601a0(0xc1),_0x1601a0(0xa7)+_0x1e615a);throw new Error(_0x1601a0(0xb4)+_0x13bf27);}console[_0x1601a0(0x7c)]('===\x20PARSED\x20RAPYD\x20RESPONSE\x20==='),console[_0x1601a0(0x7c)](_0x1601a0(0x6e),JSON[_0x1601a0(0x81)](_0x3238fe,null,0x2)),loggerService_1[_0x1601a0(0xd9)][_0x1601a0(0xa9)]('rapyd',_0x1601a0(0xc1),_0x516649['status'],_0x3238fe,_0x269ab2);if(_0x3238fe[_0x1601a0(0xcc)]?.['status']!==_0x1601a0(0xb2)){const _0x14d833=_0x3238fe[_0x1601a0(0xcc)]?.[_0x1601a0(0xc3)]||'Unknown\x20error\x20from\x20Rapyd\x20API',_0x5bf22d=_0x3238fe[_0x1601a0(0xcc)]?.[_0x1601a0(0xa3)]||'UNKNOWN';console[_0x1601a0(0x89)](_0x1601a0(0xb8)),console['error']('Error\x20Code:',_0x5bf22d),console[_0x1601a0(0x89)](_0x1601a0(0xad),_0x14d833),console[_0x1601a0(0x89)]('Full\x20Error\x20Data:',_0x3238fe[_0x1601a0(0xcc)]),loggerService_1[_0x1601a0(0xd9)][_0x1601a0(0xd4)](_0x1601a0(0x97),'/v1/hosted/payment_links',_0x1601a0(0xd8)+_0x5bf22d+'):\x20'+_0x14d833);throw new Error(_0x1601a0(0xc7)+_0x5bf22d+_0x1601a0(0xbd)+_0x14d833);}if(!_0x3238fe['data']?.['id']||!_0x3238fe['data']?.[_0x1601a0(0x8e)]){console[_0x1601a0(0x89)](_0x1601a0(0x9d)),console['error'](_0x1601a0(0xa1)),console[_0x1601a0(0x89)](_0x1601a0(0x96),_0x3238fe['data']),loggerService_1[_0x1601a0(0xd9)][_0x1601a0(0xd4)](_0x1601a0(0x97),_0x1601a0(0xc1),_0x1601a0(0xdc));throw new Error(_0x1601a0(0xb5));}return console[_0x1601a0(0x7c)](_0x1601a0(0x98)),console[_0x1601a0(0x7c)]('Payment\x20Link\x20ID:',_0x3238fe[_0x1601a0(0xbb)]['id']),console[_0x1601a0(0x7c)](_0x1601a0(0xbc),_0x3238fe[_0x1601a0(0xbb)][_0x1601a0(0x8e)]),console[_0x1601a0(0x7c)](_0x1601a0(0xaa)+_0x3040e7+_0x1601a0(0xbf)),console[_0x1601a0(0x7c)](_0x1601a0(0xdd)),{'gateway_payment_id':_0x3238fe['data']['id'],'payment_url':_0x3238fe[_0x1601a0(0xbb)]['redirect_url']};}catch(_0x27dc5f){console[_0x1601a0(0x89)](_0x1601a0(0x6b)),console[_0x1601a0(0x89)](_0x1601a0(0xd2),_0x27dc5f),loggerService_1[_0x1601a0(0xd9)]['logWhiteDomainError'](_0x1601a0(0x97),_0x1601a0(0xc1),_0x27dc5f);if(_0x27dc5f instanceof Error){console['error'](_0x1601a0(0xbe),_0x27dc5f['message']),console[_0x1601a0(0x89)](_0x1601a0(0x90),_0x27dc5f[_0x1601a0(0xa2)]);throw new Error(_0x1601a0(0x8b)+_0x27dc5f['message']);}throw new Error('Failed\x20to\x20create\x20Rapyd\x20payment\x20link:\x20Unknown\x20error');}}async[a45_0x22578d(0xcb)](_0x367959){const _0x1fc60c=a45_0x22578d,_0x33cc4c=Date['now']();try{loggerService_1[_0x1fc60c(0xd9)][_0x1fc60c(0x9a)]('rapyd',_0x1fc60c(0x6a)+_0x367959,_0x1fc60c(0xcf),{});const _0x31103c=await fetch(this[_0x1fc60c(0xb0)]+'/'+_0x367959,{'method':_0x1fc60c(0xcf),'headers':{'Content-Type':_0x1fc60c(0xc6),'User-Agent':'TesSoft\x20Payment\x20System/1.0'}}),_0x209c06=Date[_0x1fc60c(0xba)]()-_0x33cc4c;if(!_0x31103c['ok']){const _0x59d938=await _0x31103c[_0x1fc60c(0x82)]();loggerService_1[_0x1fc60c(0xd9)][_0x1fc60c(0xa9)](_0x1fc60c(0x97),'/v1/hosted/payment_links/'+_0x367959,_0x31103c[_0x1fc60c(0xcc)],_0x59d938,_0x209c06);throw new Error(_0x1fc60c(0x7f)+_0x31103c[_0x1fc60c(0xcc)]);}const _0x9fa3b7=await _0x31103c[_0x1fc60c(0x72)]();loggerService_1[_0x1fc60c(0xd9)][_0x1fc60c(0xa9)]('rapyd',_0x1fc60c(0x6a)+_0x367959,_0x31103c[_0x1fc60c(0xcc)],_0x9fa3b7,_0x209c06);if(_0x9fa3b7[_0x1fc60c(0xcc)]?.[_0x1fc60c(0xcc)]!==_0x1fc60c(0xb2)){loggerService_1[_0x1fc60c(0xd9)]['logWhiteDomainError'](_0x1fc60c(0x97),_0x1fc60c(0x6a)+_0x367959,_0x1fc60c(0x83)+(_0x9fa3b7[_0x1fc60c(0xcc)]?.['message']||_0x1fc60c(0x91)));throw new Error(_0x1fc60c(0x83)+(_0x9fa3b7[_0x1fc60c(0xcc)]?.[_0x1fc60c(0xc3)]||'Unknown\x20error'));}let _0x2ccfd8=_0x1fc60c(0xd7);if(_0x9fa3b7[_0x1fc60c(0xbb)]?.[_0x1fc60c(0xcc)])switch(_0x9fa3b7[_0x1fc60c(0xbb)][_0x1fc60c(0xcc)][_0x1fc60c(0xde)]()){case _0x1fc60c(0xd0):_0x2ccfd8=_0x1fc60c(0xa5);break;case'CAN':_0x2ccfd8=_0x1fc60c(0xb7);break;case _0x1fc60c(0xaf):_0x2ccfd8='EXPIRED';break;case _0x1fc60c(0xce):_0x2ccfd8=_0x1fc60c(0xb7);break;case _0x1fc60c(0xdb):case'ACT':default:_0x2ccfd8=_0x1fc60c(0xd7);break;}return{'status':_0x2ccfd8,'amount':_0x9fa3b7['data']?.['amount'],'currency':_0x9fa3b7[_0x1fc60c(0xbb)]?.[_0x1fc60c(0x92)]};}catch(_0x29937e){console[_0x1fc60c(0x89)](_0x1fc60c(0x70),_0x29937e),loggerService_1[_0x1fc60c(0xd9)][_0x1fc60c(0xd4)]('rapyd',_0x1fc60c(0x6a)+_0x367959,_0x29937e);throw new Error(_0x1fc60c(0xb3)+(_0x29937e instanceof Error?_0x29937e['message']:_0x1fc60c(0x91)));}}async['processWebhook'](_0x36b4b4){const _0x1508f0=a45_0x22578d;console[_0x1508f0(0x7c)](_0x1508f0(0x79),_0x36b4b4);let _0x28d330='PENDING',_0x272d28;_0x36b4b4[_0x1508f0(0xbb)]?.['failure_message']&&(_0x272d28=_0x36b4b4[_0x1508f0(0xbb)]['failure_message'],console['log'](_0x1508f0(0x71)+_0x272d28));switch(_0x36b4b4['type']?.[_0x1508f0(0xde)]()){case'PAYMENT_COMPLETED':_0x36b4b4['data']?.[_0x1508f0(0xa6)]===!![]&&_0x36b4b4[_0x1508f0(0xbb)]?.[_0x1508f0(0xcc)]===_0x1508f0(0xd0)?_0x28d330=_0x1508f0(0xa5):_0x28d330=_0x1508f0(0xd7);break;case _0x1508f0(0x80):_0x28d330='FAILED';break;case _0x1508f0(0xe0):_0x28d330=_0x1508f0(0x8f);break;case _0x1508f0(0xc5):_0x28d330=_0x1508f0(0xb7);!_0x272d28&&_0x36b4b4[_0x1508f0(0xbb)]?.[_0x1508f0(0x99)]&&(_0x272d28=_0x36b4b4[_0x1508f0(0xbb)][_0x1508f0(0x99)]);break;default:switch(_0x36b4b4[_0x1508f0(0xbb)]?.[_0x1508f0(0xcc)]?.[_0x1508f0(0xde)]()){case _0x1508f0(0xd0):_0x36b4b4[_0x1508f0(0xbb)]?.[_0x1508f0(0xa6)]===!![]?_0x28d330=_0x1508f0(0xa5):_0x28d330=_0x1508f0(0xb7);break;case _0x1508f0(0x86):_0x28d330=_0x1508f0(0xb7);break;case _0x1508f0(0xaf):_0x28d330=_0x1508f0(0x8f);break;case'ERR':_0x28d330=_0x1508f0(0xb7);!_0x272d28&&_0x36b4b4['data']?.[_0x1508f0(0x99)]&&(_0x272d28=_0x36b4b4[_0x1508f0(0xbb)][_0x1508f0(0x99)]);break;case _0x1508f0(0xdb):case _0x1508f0(0x6f):default:_0x28d330=_0x1508f0(0xd7);break;}break;}const _0x3a26e2={};return _0x36b4b4[_0x1508f0(0xbb)]?.[_0x1508f0(0x77)]?.[_0x1508f0(0xa0)]&&(_0x3a26e2['cardLast4']=_0x36b4b4['data'][_0x1508f0(0x77)][_0x1508f0(0xa0)]),_0x36b4b4['data']?.[_0x1508f0(0x87)]&&(_0x3a26e2[_0x1508f0(0x6d)]=_0x36b4b4[_0x1508f0(0xbb)][_0x1508f0(0x87)]),_0x36b4b4[_0x1508f0(0xbb)]?.[_0x1508f0(0xa3)]&&(_0x3a26e2[_0x1508f0(0x75)]=_0x36b4b4[_0x1508f0(0xbb)]['error_code']),_0x36b4b4['data']?.[_0x1508f0(0x85)]&&(_0x3a26e2[_0x1508f0(0xab)]=_0x36b4b4[_0x1508f0(0xbb)][_0x1508f0(0x85)]),console[_0x1508f0(0x7c)](_0x1508f0(0xd1)+_0x28d330+_0x1508f0(0xb6)+(_0x272d28||_0x1508f0(0x9b))),{'paymentId':_0x36b4b4[_0x1508f0(0xbb)]?.['merchant_reference_id']||'','status':_0x28d330,'amount':_0x36b4b4['data']?.[_0x1508f0(0x74)],'currency':_0x36b4b4[_0x1508f0(0xbb)]?.[_0x1508f0(0x92)],'failureMessage':_0x272d28,'additionalInfo':_0x3a26e2};}}function a45_0x29ff(_0x4fde03,_0x18c34c){const _0x172c34=a45_0x172c();return a45_0x29ff=function(_0x29ff8d,_0x141914){_0x29ff8d=_0x29ff8d-0x6a;let _0x207d82=_0x172c34[_0x29ff8d];return _0x207d82;},a45_0x29ff(_0x4fde03,_0x18c34c);}exports['RapydService']=RapydService;function a45_0x172c(){const _0x579a22=['Incomplete\x20response:\x20missing\x20id\x20or\x20redirect_url','💳\x20Payment\x20Methods:\x20gb_visa_card,\x20gb_mastercard_card','toUpperCase','https://tesoft.uk/gateway/rapyd/','PAYMENT_EXPIRED','/v1/hosted/payment_links/','===\x20RAPYD\x20SERVICE\x20ERROR\x20===','Request\x20Body\x20(Updated\x20Format):','paymentMethod','Parsed\x20Result:','ACT','Rapyd\x20payment\x20verification\x20error:','💥\x20Rapyd\x20failure\x20message:\x20','json','723894RBJOFT','amount','errorCode','RapydService','payment_method_data','defineProperty','Processing\x20Rapyd\x20webhook:','ORDER:\x20','gb_visa_card','log','parse',',\x20body:\x20','HTTP\x20error!\x20status:\x20','PAYMENT_CANCELED','stringify','text','Rapyd\x20API\x20error:\x20','119212GJnhOX','failure_code','CAN','payment_method_type','40YMZzxu','error','gb_mastercard_card','Failed\x20to\x20create\x20Rapyd\x20payment\x20link:\x20','===\x20RAPYD\x20API\x20RESPONSE\x20(White\x20Domain)\x20===','POST','redirect_url','EXPIRED','Error\x20stack:','Unknown\x20error','currency','3256047mLDjrd','\x20(always\x20GB\x20for\x20Rapyd)','25xaRemj','Response\x20data:','rapyd','===\x20RAPYD\x20SUCCESS\x20===','failure_message','logWhiteDomainRequest','none','Response\x20Body:','===\x20RAPYD\x20API\x20INCOMPLETE\x20RESPONSE\x20===','Failed\x20to\x20parse\x20JSON\x20response:','🌐\x20Rapyd\x20service\x20initialized\x20with\x20white\x20domain\x20proxy','last4','Missing\x20id\x20or\x20redirect_url\x20in\x20response','stack','error_code','../loggerService','PAID','paid','JSON\x20Parse\x20Error:\x20','1EBTtRp','logWhiteDomainResponse','🇬🇧\x20Country\x20used:\x20','failureCode','112qBdAny','Error\x20Message:','Status\x20Text:','EXP','apiUrl','URL:','SUCCESS','Failed\x20to\x20verify\x20Rapyd\x20payment:\x20','Invalid\x20JSON\x20response\x20from\x20Rapyd\x20API:\x20','Invalid\x20response\x20from\x20Rapyd\x20API:\x20missing\x20id\x20or\x20redirect_url',',\x20failureMessage=','FAILED','===\x20RAPYD\x20API\x20BUSINESS\x20ERROR\x20===','createPaymentLink','now','data','Redirect\x20URL:','):\x20','Error\x20message:','\x20(GB\x20-\x20Britain)','2904744gnOyOx','/v1/hosted/payment_links','67827ruFAQU','message','3882274EduIYv','PAYMENT_FAILED','application/json','Rapyd\x20API\x20error\x20(','5511044npIieD','entries','TesSoft\x20Payment\x20System/1.0','verifyPayment','status','https://tesoft.uk/gateway/fail.php?id=','ERR','GET','CLO','🔄\x20Rapyd\x20webhook\x20processed:\x20status=','Error\x20details:','https://tesoft.uk/gateway/success.php?id=','logWhiteDomainError','🇬🇧\x20Using\x20GB\x20(Britain)\x20as\x20country\x20for\x20Rapyd\x20payment\x20link','HTTP\x20','PENDING','Business\x20Error\x20(','loggerService','🇬🇧\x20Country:\x20','NEW'];a45_0x172c=function(){return _0x579a22;};return a45_0x172c();}