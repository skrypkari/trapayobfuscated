'use strict';function a67_0xafef(){const _0xa487a=['parse','message','email','Error\x20message:','PAYMENT_EXPIRED','requested_currency','Failed\x20to\x20create\x20Rapyd\x20payment\x20link:\x20Unknown\x20error','9cJSnpJ','redirect_url','cardholder_name','Payment\x20Link\x20ID:','payment_method_type','data','===\x20RAPYD\x20SERVICE\x20ERROR\x20===','\x20(GB\x20-\x20Britain)','log','errorCode','RapydService','now','https://tesoft.uk/gateway/fail.php?id=',',\x20body:\x20','error_code','CAN','merchant_reference_id','3YGAfYD','Headers:','\x20->\x20EUR:','===\x20RAPYD\x20API\x20INCOMPLETE\x20RESPONSE\x20===','103584CCUMOR','HTTP\x20Status:','\x20(always\x20GB\x20for\x20Rapyd)','/v1/hosted/payment_links/','Failed\x20to\x20create\x20Rapyd\x20payment\x20link:\x20','Unknown\x20error\x20from\x20Rapyd\x20API','cardLast4','Parsed\x20Result:','last4','üí≥\x20Adding\x20cardholder\x20name:\x20','===\x20RAPYD\x20API\x20REQUEST\x20(White\x20Domain\x20-\x20Updated\x20Format)\x20===','===\x20PARSED\x20RAPYD\x20RESPONSE\x20===','\x20\x20\x20fixed_side:\x20buy',',\x20failureMessage=','headers','toUpperCase','loggerService','üá¨üáß\x20Country\x20used:\x20','Incomplete\x20response:\x20missing\x20id\x20or\x20redirect_url','Error\x20details:','UNKNOWN','statusText','EXP','===\x20RAPYD\x20API\x20BUSINESS\x20ERROR\x20===','split','status','defineProperty','1889886GnKTpG','SUCCESS','phone_number','Response\x20Time:','21ZkPlHU','Failed\x20to\x20verify\x20Rapyd\x20payment:\x20','Status:','Rapyd\x20API\x20error:\x20','verifyPayment','https://tesoft.uk/gateway/rapyd/','address','rapyd','URL:','type','üí±\x20Adding\x20currency\x20conversion\x20fields\x20for\x20','stringify','custom_elements','===\x20RAPYD\x20API\x20RESPONSE\x20(White\x20Domain)\x20===','436144ipVxlU','Processing\x20Rapyd\x20webhook:','Rapyd\x20payment\x20verification\x20error:','1166034WpJtHK','logWhiteDomainResponse','EUR','PENDING','\x20\x20\x20requested_currency:\x20EUR','ORDER:\x20','Response\x20data:','HTTP\x20error!\x20status:\x20','failureCode','failure_code','\x20\x20\x20expiration:\x20','Unknown\x20error','https://tesoft.uk/gateway/success.php?id=','POST','Missing\x20id\x20or\x20redirect_url\x20in\x20response','entries','üîÑ\x20Rapyd\x20webhook\x20processed:\x20status=','floor','/v1/hosted/payment_links','Response\x20Body:','CLO','PAID','ERR','Error\x20Message:','Full\x20Error\x20Data:','text','147564ZomOft','ACT','===\x20RAPYD\x20API\x20ERROR\x20===','Business\x20Error\x20(','PAYMENT_FAILED','json','application/json','2211oAsezX','Rapyd\x20API\x20error\x20(','../loggerService','HTTP\x20','15HRnWGz','fromEntries','paid','1698260nWByvz','amount','error','Payment\x20System/1.0','FAILED','TESOFT\x20','Redirect\x20URL:','failure_message','Error\x20stack:','Raw\x20Response\x20Body:','EXPIRED','logWhiteDomainRequest','gb_visa_card','GET','üá¨üáß\x20Country:\x20','logWhiteDomainError','__esModule','PAYMENT_CANCELED','buy','currency','payment_method_data','Error\x20Code:','3841756hgaJgb','name','apiUrl'];a67_0xafef=function(){return _0xa487a;};return a67_0xafef();}function a67_0x1ace(_0x5cf1a7,_0x357c5e){_0x5cf1a7=_0x5cf1a7-0x18e;const _0xafefbb=a67_0xafef();let _0x1ace57=_0xafefbb[_0x5cf1a7];return _0x1ace57;}const a67_0x41323c=a67_0x1ace;(function(_0x3b47f1,_0x4c9fb3){const _0x548fa5=a67_0x1ace,_0x5d2c54=_0x3b47f1();while(!![]){try{const _0x237ef0=-parseInt(_0x548fa5(0x1c8))/0x1+parseInt(_0x548fa5(0x199))/0x2+-parseInt(_0x548fa5(0x207))/0x3*(-parseInt(_0x548fa5(0x1ec))/0x4)+-parseInt(_0x548fa5(0x1d3))/0x5*(-parseInt(_0x548fa5(0x1ae))/0x6)+parseInt(_0x548fa5(0x19d))/0x7*(parseInt(_0x548fa5(0x1ab))/0x8)+-parseInt(_0x548fa5(0x1f6))/0x9*(parseInt(_0x548fa5(0x1d6))/0xa)+-parseInt(_0x548fa5(0x1cf))/0xb*(parseInt(_0x548fa5(0x20b))/0xc);if(_0x237ef0===_0x4c9fb3)break;else _0x5d2c54['push'](_0x5d2c54['shift']());}catch(_0xf550a8){_0x5d2c54['push'](_0x5d2c54['shift']());}}}(a67_0xafef,0x925eb));Object[a67_0x41323c(0x198)](exports,a67_0x41323c(0x1e6),{'value':!![]}),exports[a67_0x41323c(0x200)]=void 0x0;const loggerService_1=require(a67_0x41323c(0x1d1));class RapydService{constructor(){const _0x22514a=a67_0x41323c;this['apiUrl']=_0x22514a(0x1a2),console[_0x22514a(0x1fe)]('üåê\x20Rapyd\x20service\x20initialized\x20with\x20white\x20domain\x20proxy');}async['createPaymentLink'](_0x418545){const _0x4afe4e=a67_0x41323c,{orderId:_0x5a6a20,orderName:_0x22fbbc,amount:_0x4231bf,currency:_0x3d19f6,usage:_0x438124,maxPayments:_0x4b9e15,successUrl:_0x1498e9,failUrl:_0x3c9d74,customerName:_0x1beb53,customerEmail:_0x57cac5}=_0x418545,_0x532877=_0x3d19f6[_0x4afe4e(0x21a)](),_0x314170='GB';console[_0x4afe4e(0x1fe)]('üá¨üáß\x20Using\x20GB\x20(Britain)\x20as\x20country\x20for\x20Rapyd\x20payment\x20link');const _0x560e8b=_0x4afe4e(0x1ba)+_0x5a6a20,_0x1ffa73=_0x4afe4e(0x202)+_0x5a6a20,_0x385f8d={'amount':_0x4231bf,'currency':_0x532877,'payment_method_options':{'3d_required':![]},'cancel_checkout_url':_0x1ffa73,'complete_checkout_url':_0x560e8b,'complete_payment_url':_0x560e8b,'merchant_reference_id':_0x5a6a20,'description':_0x4afe4e(0x1b3)+_0x5a6a20,'statement_descriptor':_0x4afe4e(0x1db)+(_0x5a6a20[_0x4afe4e(0x196)]('-')[0x1]||_0x5a6a20),'country':'GB','payment_method_types_include':[_0x4afe4e(0x1e2),'gb_mastercard_card'],'custom_elements':{'display_description':!![],'billing_address_collect':!![],'required_customer_fields':[_0x4afe4e(0x1ed),_0x4afe4e(0x1f1),_0x4afe4e(0x19b),_0x4afe4e(0x1a3)]}};_0x1beb53&&(_0x385f8d[_0x4afe4e(0x1a9)][_0x4afe4e(0x1f8)]=_0x1beb53,console[_0x4afe4e(0x1fe)](_0x4afe4e(0x214)+_0x1beb53));if(_0x532877!==_0x4afe4e(0x1b0)){const _0x4097cd=Math[_0x4afe4e(0x1bf)](Date[_0x4afe4e(0x201)]()/0x3e8)+0x1e*0x3c;_0x385f8d['fixed_side']=_0x4afe4e(0x1e8),_0x385f8d[_0x4afe4e(0x1f4)]=_0x4afe4e(0x1b0),_0x385f8d['expiration']=_0x4097cd,console['log'](_0x4afe4e(0x1a7)+_0x532877+_0x4afe4e(0x209)),console['log'](_0x4afe4e(0x217)),console[_0x4afe4e(0x1fe)](_0x4afe4e(0x1b2)),console[_0x4afe4e(0x1fe)](_0x4afe4e(0x1b8)+_0x4097cd+'\x20('+new Date(_0x4097cd*0x3e8)['toISOString']()+')');}const _0x51f589=Date['now']();try{console['log'](_0x4afe4e(0x215)),console[_0x4afe4e(0x1fe)](_0x4afe4e(0x1a5),this[_0x4afe4e(0x1ee)]),console[_0x4afe4e(0x1fe)]('Request\x20Body\x20(Updated\x20Format):',JSON['stringify'](_0x385f8d,null,0x2)),console[_0x4afe4e(0x1fe)](_0x4afe4e(0x1e4)+_0x314170+_0x4afe4e(0x20d)),console[_0x4afe4e(0x1fe)]('üí≥\x20Payment\x20Methods:\x20gb_visa_card,\x20gb_mastercard_card'),loggerService_1[_0x4afe4e(0x18e)][_0x4afe4e(0x1e1)](_0x4afe4e(0x1a4),'/v1/hosted/payment_links','POST',_0x385f8d);const _0x529986=await fetch(this['apiUrl'],{'method':_0x4afe4e(0x1bb),'headers':{'Content-Type':'application/json','User-Agent':_0x4afe4e(0x1d9)},'body':JSON[_0x4afe4e(0x1a8)](_0x385f8d)}),_0x548643=Date[_0x4afe4e(0x201)]()-_0x51f589;console[_0x4afe4e(0x1fe)](_0x4afe4e(0x1aa)),console[_0x4afe4e(0x1fe)](_0x4afe4e(0x19f),_0x529986[_0x4afe4e(0x197)]),console[_0x4afe4e(0x1fe)]('Status\x20Text:',_0x529986[_0x4afe4e(0x193)]),console[_0x4afe4e(0x1fe)](_0x4afe4e(0x208),Object[_0x4afe4e(0x1d4)](_0x529986[_0x4afe4e(0x219)][_0x4afe4e(0x1bd)]())),console[_0x4afe4e(0x1fe)](_0x4afe4e(0x19c),_0x548643+'ms');const _0xe24d75=await _0x529986[_0x4afe4e(0x1c7)]();console[_0x4afe4e(0x1fe)](_0x4afe4e(0x1df),_0xe24d75);if(!_0x529986['ok']){console[_0x4afe4e(0x1d8)](_0x4afe4e(0x1ca)),console[_0x4afe4e(0x1d8)](_0x4afe4e(0x20c),_0x529986['status']),console['error'](_0x4afe4e(0x1c1),_0xe24d75),loggerService_1[_0x4afe4e(0x18e)][_0x4afe4e(0x1af)](_0x4afe4e(0x1a4),_0x4afe4e(0x1c0),_0x529986[_0x4afe4e(0x197)],_0xe24d75,_0x548643),loggerService_1[_0x4afe4e(0x18e)][_0x4afe4e(0x1e5)]('rapyd',_0x4afe4e(0x1c0),_0x4afe4e(0x1d2)+_0x529986[_0x4afe4e(0x197)]+':\x20'+_0xe24d75);throw new Error(_0x4afe4e(0x1b5)+_0x529986[_0x4afe4e(0x197)]+_0x4afe4e(0x203)+_0xe24d75);}let _0x5cdd4b;try{_0x5cdd4b=JSON[_0x4afe4e(0x1ef)](_0xe24d75);}catch(_0x4e045c){console[_0x4afe4e(0x1d8)]('Failed\x20to\x20parse\x20JSON\x20response:',_0x4e045c),loggerService_1['loggerService'][_0x4afe4e(0x1e5)](_0x4afe4e(0x1a4),_0x4afe4e(0x1c0),'JSON\x20Parse\x20Error:\x20'+_0x4e045c);throw new Error('Invalid\x20JSON\x20response\x20from\x20Rapyd\x20API:\x20'+_0xe24d75);}console[_0x4afe4e(0x1fe)](_0x4afe4e(0x216)),console['log'](_0x4afe4e(0x212),JSON[_0x4afe4e(0x1a8)](_0x5cdd4b,null,0x2)),loggerService_1[_0x4afe4e(0x18e)]['logWhiteDomainResponse']('rapyd',_0x4afe4e(0x1c0),_0x529986[_0x4afe4e(0x197)],_0x5cdd4b,_0x548643);if(_0x5cdd4b[_0x4afe4e(0x197)]?.[_0x4afe4e(0x197)]!==_0x4afe4e(0x19a)){const _0x222175=_0x5cdd4b['status']?.[_0x4afe4e(0x1f0)]||_0x4afe4e(0x210),_0x19221a=_0x5cdd4b[_0x4afe4e(0x197)]?.[_0x4afe4e(0x204)]||_0x4afe4e(0x192);console[_0x4afe4e(0x1d8)](_0x4afe4e(0x195)),console[_0x4afe4e(0x1d8)](_0x4afe4e(0x1eb),_0x19221a),console[_0x4afe4e(0x1d8)](_0x4afe4e(0x1c5),_0x222175),console[_0x4afe4e(0x1d8)](_0x4afe4e(0x1c6),_0x5cdd4b['status']),loggerService_1[_0x4afe4e(0x18e)][_0x4afe4e(0x1e5)](_0x4afe4e(0x1a4),_0x4afe4e(0x1c0),_0x4afe4e(0x1cb)+_0x19221a+'):\x20'+_0x222175);throw new Error(_0x4afe4e(0x1d0)+_0x19221a+'):\x20'+_0x222175);}if(!_0x5cdd4b[_0x4afe4e(0x1fb)]?.['id']||!_0x5cdd4b[_0x4afe4e(0x1fb)]?.[_0x4afe4e(0x1f7)]){console[_0x4afe4e(0x1d8)](_0x4afe4e(0x20a)),console[_0x4afe4e(0x1d8)](_0x4afe4e(0x1bc)),console[_0x4afe4e(0x1d8)](_0x4afe4e(0x1b4),_0x5cdd4b[_0x4afe4e(0x1fb)]),loggerService_1[_0x4afe4e(0x18e)][_0x4afe4e(0x1e5)]('rapyd','/v1/hosted/payment_links',_0x4afe4e(0x190));throw new Error('Invalid\x20response\x20from\x20Rapyd\x20API:\x20missing\x20id\x20or\x20redirect_url');}return console[_0x4afe4e(0x1fe)]('===\x20RAPYD\x20SUCCESS\x20==='),console[_0x4afe4e(0x1fe)](_0x4afe4e(0x1f9),_0x5cdd4b[_0x4afe4e(0x1fb)]['id']),console[_0x4afe4e(0x1fe)](_0x4afe4e(0x1dc),_0x5cdd4b[_0x4afe4e(0x1fb)][_0x4afe4e(0x1f7)]),console[_0x4afe4e(0x1fe)](_0x4afe4e(0x18f)+_0x314170+_0x4afe4e(0x1fd)),console[_0x4afe4e(0x1fe)]('üí≥\x20Payment\x20Methods:\x20gb_visa_card,\x20gb_mastercard_card'),{'gateway_payment_id':_0x5cdd4b['data']['id'],'payment_url':_0x5cdd4b[_0x4afe4e(0x1fb)]['redirect_url']};}catch(_0x3c5fa7){console[_0x4afe4e(0x1d8)](_0x4afe4e(0x1fc)),console[_0x4afe4e(0x1d8)](_0x4afe4e(0x191),_0x3c5fa7),loggerService_1[_0x4afe4e(0x18e)][_0x4afe4e(0x1e5)](_0x4afe4e(0x1a4),_0x4afe4e(0x1c0),_0x3c5fa7);if(_0x3c5fa7 instanceof Error){console['error'](_0x4afe4e(0x1f2),_0x3c5fa7['message']),console['error'](_0x4afe4e(0x1de),_0x3c5fa7['stack']);throw new Error(_0x4afe4e(0x20f)+_0x3c5fa7[_0x4afe4e(0x1f0)]);}throw new Error(_0x4afe4e(0x1f5));}}async[a67_0x41323c(0x1a1)](_0x21a89c){const _0x20bf6a=a67_0x41323c,_0x108b08=Date[_0x20bf6a(0x201)]();try{loggerService_1[_0x20bf6a(0x18e)][_0x20bf6a(0x1e1)](_0x20bf6a(0x1a4),_0x20bf6a(0x20e)+_0x21a89c,_0x20bf6a(0x1e3),{});const _0x114183=await fetch(this['apiUrl']+'/'+_0x21a89c,{'method':'GET','headers':{'Content-Type':_0x20bf6a(0x1ce),'User-Agent':_0x20bf6a(0x1d9)}}),_0x3bcfe7=Date[_0x20bf6a(0x201)]()-_0x108b08;if(!_0x114183['ok']){const _0x50a0a8=await _0x114183[_0x20bf6a(0x1c7)]();loggerService_1[_0x20bf6a(0x18e)]['logWhiteDomainResponse']('rapyd',_0x20bf6a(0x20e)+_0x21a89c,_0x114183[_0x20bf6a(0x197)],_0x50a0a8,_0x3bcfe7);throw new Error('HTTP\x20error!\x20status:\x20'+_0x114183[_0x20bf6a(0x197)]);}const _0x2c8996=await _0x114183[_0x20bf6a(0x1cd)]();loggerService_1[_0x20bf6a(0x18e)][_0x20bf6a(0x1af)](_0x20bf6a(0x1a4),_0x20bf6a(0x20e)+_0x21a89c,_0x114183[_0x20bf6a(0x197)],_0x2c8996,_0x3bcfe7);if(_0x2c8996['status']?.['status']!==_0x20bf6a(0x19a)){loggerService_1['loggerService'][_0x20bf6a(0x1e5)](_0x20bf6a(0x1a4),_0x20bf6a(0x20e)+_0x21a89c,'Rapyd\x20API\x20error:\x20'+(_0x2c8996[_0x20bf6a(0x197)]?.[_0x20bf6a(0x1f0)]||'Unknown\x20error'));throw new Error(_0x20bf6a(0x1a0)+(_0x2c8996[_0x20bf6a(0x197)]?.['message']||_0x20bf6a(0x1b9)));}let _0x217b04=_0x20bf6a(0x1b1);if(_0x2c8996['data']?.[_0x20bf6a(0x197)])switch(_0x2c8996[_0x20bf6a(0x1fb)]['status'][_0x20bf6a(0x21a)]()){case _0x20bf6a(0x1c2):_0x217b04=_0x20bf6a(0x1c3);break;case'CAN':_0x217b04=_0x20bf6a(0x1da);break;case'EXP':_0x217b04=_0x20bf6a(0x1e0);break;case _0x20bf6a(0x1c4):_0x217b04=_0x20bf6a(0x1da);break;case'NEW':case _0x20bf6a(0x1c9):default:_0x217b04=_0x20bf6a(0x1b1);break;}return{'status':_0x217b04,'amount':_0x2c8996['data']?.[_0x20bf6a(0x1d7)],'currency':_0x2c8996[_0x20bf6a(0x1fb)]?.[_0x20bf6a(0x1e9)]};}catch(_0x161a3c){console[_0x20bf6a(0x1d8)](_0x20bf6a(0x1ad),_0x161a3c),loggerService_1['loggerService'][_0x20bf6a(0x1e5)]('rapyd',_0x20bf6a(0x20e)+_0x21a89c,_0x161a3c);throw new Error(_0x20bf6a(0x19e)+(_0x161a3c instanceof Error?_0x161a3c[_0x20bf6a(0x1f0)]:'Unknown\x20error'));}}async['processWebhook'](_0x4aef2b){const _0x416b96=a67_0x41323c;console[_0x416b96(0x1fe)](_0x416b96(0x1ac),_0x4aef2b);let _0x5eb1ed=_0x416b96(0x1b1),_0x91662;_0x4aef2b[_0x416b96(0x1fb)]?.[_0x416b96(0x1dd)]&&(_0x91662=_0x4aef2b[_0x416b96(0x1fb)][_0x416b96(0x1dd)],console[_0x416b96(0x1fe)]('üí•\x20Rapyd\x20failure\x20message:\x20'+_0x91662));switch(_0x4aef2b[_0x416b96(0x1a6)]?.[_0x416b96(0x21a)]()){case'PAYMENT_COMPLETED':_0x4aef2b['data']?.[_0x416b96(0x1d5)]===!![]&&_0x4aef2b[_0x416b96(0x1fb)]?.[_0x416b96(0x197)]===_0x416b96(0x1c2)?_0x5eb1ed=_0x416b96(0x1c3):_0x5eb1ed=_0x416b96(0x1b1);break;case _0x416b96(0x1e7):_0x5eb1ed=_0x416b96(0x1da);break;case _0x416b96(0x1f3):_0x5eb1ed='EXPIRED';break;case _0x416b96(0x1cc):_0x5eb1ed='FAILED';!_0x91662&&_0x4aef2b[_0x416b96(0x1fb)]?.[_0x416b96(0x1dd)]&&(_0x91662=_0x4aef2b['data'][_0x416b96(0x1dd)]);break;default:switch(_0x4aef2b[_0x416b96(0x1fb)]?.[_0x416b96(0x197)]?.[_0x416b96(0x21a)]()){case _0x416b96(0x1c2):_0x4aef2b['data']?.[_0x416b96(0x1d5)]===!![]?_0x5eb1ed=_0x416b96(0x1c3):_0x5eb1ed=_0x416b96(0x1da);break;case _0x416b96(0x205):_0x5eb1ed='FAILED';break;case _0x416b96(0x194):_0x5eb1ed='EXPIRED';break;case _0x416b96(0x1c4):_0x5eb1ed=_0x416b96(0x1da);!_0x91662&&_0x4aef2b[_0x416b96(0x1fb)]?.[_0x416b96(0x1dd)]&&(_0x91662=_0x4aef2b[_0x416b96(0x1fb)]['failure_message']);break;case'NEW':case _0x416b96(0x1c9):default:_0x5eb1ed='PENDING';break;}break;}const _0x4fada3={};return _0x4aef2b[_0x416b96(0x1fb)]?.[_0x416b96(0x1ea)]?.[_0x416b96(0x213)]&&(_0x4fada3[_0x416b96(0x211)]=_0x4aef2b[_0x416b96(0x1fb)][_0x416b96(0x1ea)][_0x416b96(0x213)]),_0x4aef2b[_0x416b96(0x1fb)]?.[_0x416b96(0x1fa)]&&(_0x4fada3['paymentMethod']=_0x4aef2b[_0x416b96(0x1fb)][_0x416b96(0x1fa)]),_0x4aef2b['data']?.[_0x416b96(0x204)]&&(_0x4fada3[_0x416b96(0x1ff)]=_0x4aef2b['data'][_0x416b96(0x204)]),_0x4aef2b['data']?.[_0x416b96(0x1b7)]&&(_0x4fada3[_0x416b96(0x1b6)]=_0x4aef2b[_0x416b96(0x1fb)][_0x416b96(0x1b7)]),console[_0x416b96(0x1fe)](_0x416b96(0x1be)+_0x5eb1ed+_0x416b96(0x218)+(_0x91662||'none')),{'paymentId':_0x4aef2b['data']?.[_0x416b96(0x206)]||'','status':_0x5eb1ed,'amount':_0x4aef2b[_0x416b96(0x1fb)]?.['amount'],'currency':_0x4aef2b[_0x416b96(0x1fb)]?.[_0x416b96(0x1e9)],'failureMessage':_0x91662,'additionalInfo':_0x4fada3};}}exports[a67_0x41323c(0x200)]=RapydService;