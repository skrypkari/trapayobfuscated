'use strict';const a52_0x1e7a0b=a52_0x5349;(function(_0x5274d7,_0x1c209e){const _0x591514=a52_0x5349,_0x180172=_0x5274d7();while(!![]){try{const _0x1ab2a7=-parseInt(_0x591514(0x193))/0x1*(-parseInt(_0x591514(0x185))/0x2)+-parseInt(_0x591514(0x165))/0x3*(-parseInt(_0x591514(0x128))/0x4)+parseInt(_0x591514(0x15d))/0x5*(parseInt(_0x591514(0x120))/0x6)+parseInt(_0x591514(0x154))/0x7+-parseInt(_0x591514(0x180))/0x8*(parseInt(_0x591514(0x137))/0x9)+parseInt(_0x591514(0x169))/0xa+-parseInt(_0x591514(0x14c))/0xb;if(_0x1ab2a7===_0x1c209e)break;else _0x180172['push'](_0x180172['shift']());}catch(_0xcadd18){_0x180172['push'](_0x180172['shift']());}}}(a52_0x3246,0xa9c11));Object[a52_0x1e7a0b(0x163)](exports,a52_0x1e7a0b(0x16f),{'value':!![]}),exports[a52_0x1e7a0b(0x148)]=void 0x0;const loggerService_1=require(a52_0x1e7a0b(0x15a));function a52_0x5349(_0x585c41,_0x289999){const _0x3246cb=a52_0x3246();return a52_0x5349=function(_0x5349b8,_0xd78178){_0x5349b8=_0x5349b8-0x114;let _0x3ff046=_0x3246cb[_0x5349b8];return _0x3ff046;},a52_0x5349(_0x585c41,_0x289999);}class RapydService{constructor(){const _0xddb905=a52_0x1e7a0b;this[_0xddb905(0x171)]=_0xddb905(0x183),console[_0xddb905(0x17d)](_0xddb905(0x174));}async[a52_0x1e7a0b(0x12c)](_0x26cf75){const _0x25f37b=a52_0x1e7a0b,{orderId:_0x5a45ca,orderName:_0x369ad8,amount:_0x1554a6,currency:_0x24dc81,usage:_0x4e1378,maxPayments:_0x3085e6,successUrl:_0xaf88e8,failUrl:_0x56b067}=_0x26cf75,_0x43bb30=_0x24dc81[_0x25f37b(0x12b)](),_0x38568b='GB';console[_0x25f37b(0x17d)](_0x25f37b(0x15c));const _0x523097=_0x25f37b(0x118)+_0x5a45ca,_0x290355=_0x25f37b(0x190)+_0x5a45ca,_0x5cde88={'amount':_0x1554a6,'currency':_0x43bb30,'cancel_checkout_url':_0x290355,'complete_checkout_url':_0x523097,'complete_payment_url':_0x523097,'merchant_reference_id':_0x5a45ca,'description':'ORDER:\x20'+_0x5a45ca,'country':'GB','payment_method_types_include':[_0x25f37b(0x176),_0x25f37b(0x141)],'custom_elements':{'display_description':!![]}};if(_0x43bb30!==_0x25f37b(0x115)){const _0x33ec35=Math[_0x25f37b(0x139)](Date['now']()/0x3e8)+0x1e*0x3c;_0x5cde88[_0x25f37b(0x13a)]=_0x25f37b(0x17b),_0x5cde88[_0x25f37b(0x117)]='EUR',_0x5cde88['expiration']=_0x33ec35,console['log'](_0x25f37b(0x131)+_0x43bb30+_0x25f37b(0x12f)),console[_0x25f37b(0x17d)](_0x25f37b(0x15b)),console[_0x25f37b(0x17d)]('\x20\x20\x20requested_currency:\x20EUR'),console['log'](_0x25f37b(0x186)+_0x33ec35+'\x20('+new Date(_0x33ec35*0x3e8)[_0x25f37b(0x13f)]()+')');}const _0x5e3082=Date[_0x25f37b(0x12d)]();try{console[_0x25f37b(0x17d)](_0x25f37b(0x14f)),console[_0x25f37b(0x17d)](_0x25f37b(0x140),this['apiUrl']),console['log'](_0x25f37b(0x189),JSON[_0x25f37b(0x11c)](_0x5cde88,null,0x2)),console[_0x25f37b(0x17d)]('🇬🇧\x20Country:\x20'+_0x38568b+_0x25f37b(0x192)),console[_0x25f37b(0x17d)](_0x25f37b(0x14a)),loggerService_1[_0x25f37b(0x155)]['logWhiteDomainRequest'](_0x25f37b(0x17f),_0x25f37b(0x134),'POST',_0x5cde88);const _0x14a452=await fetch(this['apiUrl'],{'method':_0x25f37b(0x149),'headers':{'Content-Type':_0x25f37b(0x159),'User-Agent':_0x25f37b(0x179)},'body':JSON[_0x25f37b(0x11c)](_0x5cde88)}),_0x133a0d=Date['now']()-_0x5e3082;console['log'](_0x25f37b(0x146)),console['log']('Status:',_0x14a452[_0x25f37b(0x18b)]),console['log'](_0x25f37b(0x14e),_0x14a452[_0x25f37b(0x132)]),console[_0x25f37b(0x17d)](_0x25f37b(0x147),Object['fromEntries'](_0x14a452['headers']['entries']())),console[_0x25f37b(0x17d)](_0x25f37b(0x16e),_0x133a0d+'ms');const _0xefa6a0=await _0x14a452['text']();console[_0x25f37b(0x17d)]('Raw\x20Response\x20Body:',_0xefa6a0);if(!_0x14a452['ok']){console['error'](_0x25f37b(0x142)),console[_0x25f37b(0x194)](_0x25f37b(0x124),_0x14a452[_0x25f37b(0x18b)]),console[_0x25f37b(0x194)](_0x25f37b(0x17a),_0xefa6a0),loggerService_1[_0x25f37b(0x155)][_0x25f37b(0x13c)](_0x25f37b(0x17f),_0x25f37b(0x134),_0x14a452['status'],_0xefa6a0,_0x133a0d),loggerService_1['loggerService'][_0x25f37b(0x187)](_0x25f37b(0x17f),_0x25f37b(0x134),'HTTP\x20'+_0x14a452[_0x25f37b(0x18b)]+':\x20'+_0xefa6a0);throw new Error(_0x25f37b(0x168)+_0x14a452[_0x25f37b(0x18b)]+_0x25f37b(0x151)+_0xefa6a0);}let _0x3e49aa;try{_0x3e49aa=JSON['parse'](_0xefa6a0);}catch(_0xaa9ad0){console[_0x25f37b(0x194)](_0x25f37b(0x17c),_0xaa9ad0),loggerService_1[_0x25f37b(0x155)]['logWhiteDomainError'](_0x25f37b(0x17f),_0x25f37b(0x134),'JSON\x20Parse\x20Error:\x20'+_0xaa9ad0);throw new Error(_0x25f37b(0x18f)+_0xefa6a0);}console[_0x25f37b(0x17d)](_0x25f37b(0x18c)),console[_0x25f37b(0x17d)]('Parsed\x20Result:',JSON['stringify'](_0x3e49aa,null,0x2)),loggerService_1[_0x25f37b(0x155)][_0x25f37b(0x13c)]('rapyd',_0x25f37b(0x134),_0x14a452[_0x25f37b(0x18b)],_0x3e49aa,_0x133a0d);if(_0x3e49aa[_0x25f37b(0x18b)]?.[_0x25f37b(0x18b)]!==_0x25f37b(0x14d)){const _0x5c00bf=_0x3e49aa[_0x25f37b(0x18b)]?.[_0x25f37b(0x126)]||_0x25f37b(0x14b),_0x308d8b=_0x3e49aa[_0x25f37b(0x18b)]?.[_0x25f37b(0x11f)]||_0x25f37b(0x170);console[_0x25f37b(0x194)](_0x25f37b(0x18d)),console[_0x25f37b(0x194)]('Error\x20Code:',_0x308d8b),console[_0x25f37b(0x194)](_0x25f37b(0x177),_0x5c00bf),console[_0x25f37b(0x194)](_0x25f37b(0x166),_0x3e49aa[_0x25f37b(0x18b)]),loggerService_1['loggerService'][_0x25f37b(0x187)]('rapyd',_0x25f37b(0x134),_0x25f37b(0x121)+_0x308d8b+_0x25f37b(0x144)+_0x5c00bf);throw new Error(_0x25f37b(0x181)+_0x308d8b+'):\x20'+_0x5c00bf);}if(!_0x3e49aa[_0x25f37b(0x16a)]?.['id']||!_0x3e49aa[_0x25f37b(0x16a)]?.[_0x25f37b(0x191)]){console[_0x25f37b(0x194)](_0x25f37b(0x17e)),console[_0x25f37b(0x194)](_0x25f37b(0x156)),console['error'](_0x25f37b(0x138),_0x3e49aa[_0x25f37b(0x16a)]),loggerService_1[_0x25f37b(0x155)]['logWhiteDomainError']('rapyd',_0x25f37b(0x134),_0x25f37b(0x125));throw new Error(_0x25f37b(0x114));}return console[_0x25f37b(0x17d)]('===\x20RAPYD\x20SUCCESS\x20==='),console[_0x25f37b(0x17d)]('Payment\x20Link\x20ID:',_0x3e49aa[_0x25f37b(0x16a)]['id']),console[_0x25f37b(0x17d)](_0x25f37b(0x11e),_0x3e49aa['data'][_0x25f37b(0x191)]),console[_0x25f37b(0x17d)]('🇬🇧\x20Country\x20used:\x20'+_0x38568b+_0x25f37b(0x15f)),console['log']('💳\x20Payment\x20Methods:\x20gb_visa_card,\x20gb_mastercard_card'),{'gateway_payment_id':_0x3e49aa['data']['id'],'payment_url':_0x3e49aa[_0x25f37b(0x16a)][_0x25f37b(0x191)]};}catch(_0xdddbfb){console['error'](_0x25f37b(0x129)),console[_0x25f37b(0x194)](_0x25f37b(0x150),_0xdddbfb),loggerService_1[_0x25f37b(0x155)][_0x25f37b(0x187)](_0x25f37b(0x17f),'/v1/hosted/payment_links',_0xdddbfb);if(_0xdddbfb instanceof Error){console[_0x25f37b(0x194)](_0x25f37b(0x13e),_0xdddbfb['message']),console['error']('Error\x20stack:',_0xdddbfb['stack']);throw new Error('Failed\x20to\x20create\x20Rapyd\x20payment\x20link:\x20'+_0xdddbfb[_0x25f37b(0x126)]);}throw new Error(_0x25f37b(0x153));}}async['verifyPayment'](_0x3e3173){const _0x2954cb=a52_0x1e7a0b,_0xaf36db=Date[_0x2954cb(0x12d)]();try{loggerService_1[_0x2954cb(0x155)][_0x2954cb(0x123)](_0x2954cb(0x17f),_0x2954cb(0x13b)+_0x3e3173,_0x2954cb(0x11a),{});const _0x3ae638=await fetch(this[_0x2954cb(0x171)]+'/'+_0x3e3173,{'method':'GET','headers':{'Content-Type':'application/json','User-Agent':'TesSoft\x20Payment\x20System/1.0'}}),_0x1e6bb2=Date[_0x2954cb(0x12d)]()-_0xaf36db;if(!_0x3ae638['ok']){const _0x301c44=await _0x3ae638[_0x2954cb(0x162)]();loggerService_1[_0x2954cb(0x155)][_0x2954cb(0x13c)](_0x2954cb(0x17f),_0x2954cb(0x13b)+_0x3e3173,_0x3ae638[_0x2954cb(0x18b)],_0x301c44,_0x1e6bb2);throw new Error(_0x2954cb(0x168)+_0x3ae638[_0x2954cb(0x18b)]);}const _0x227169=await _0x3ae638[_0x2954cb(0x175)]();loggerService_1[_0x2954cb(0x155)][_0x2954cb(0x13c)](_0x2954cb(0x17f),_0x2954cb(0x13b)+_0x3e3173,_0x3ae638['status'],_0x227169,_0x1e6bb2);if(_0x227169['status']?.[_0x2954cb(0x18b)]!=='SUCCESS'){loggerService_1[_0x2954cb(0x155)][_0x2954cb(0x187)](_0x2954cb(0x17f),_0x2954cb(0x13b)+_0x3e3173,_0x2954cb(0x133)+(_0x227169[_0x2954cb(0x18b)]?.['message']||'Unknown\x20error'));throw new Error(_0x2954cb(0x133)+(_0x227169[_0x2954cb(0x18b)]?.[_0x2954cb(0x126)]||_0x2954cb(0x145)));}let _0x5d4df1='PENDING';if(_0x227169[_0x2954cb(0x16a)]?.['status'])switch(_0x227169[_0x2954cb(0x16a)]['status'][_0x2954cb(0x12b)]()){case'CLO':_0x5d4df1=_0x2954cb(0x130);break;case'CAN':_0x5d4df1=_0x2954cb(0x12e);break;case'EXP':_0x5d4df1=_0x2954cb(0x184);break;case'ERR':_0x5d4df1=_0x2954cb(0x12e);break;case _0x2954cb(0x178):case _0x2954cb(0x172):default:_0x5d4df1=_0x2954cb(0x18e);break;}return{'status':_0x5d4df1,'amount':_0x227169[_0x2954cb(0x16a)]?.['amount'],'currency':_0x227169[_0x2954cb(0x16a)]?.[_0x2954cb(0x12a)]};}catch(_0x572ce9){console['error'](_0x2954cb(0x157),_0x572ce9),loggerService_1[_0x2954cb(0x155)][_0x2954cb(0x187)]('rapyd','/v1/hosted/payment_links/'+_0x3e3173,_0x572ce9);throw new Error('Failed\x20to\x20verify\x20Rapyd\x20payment:\x20'+(_0x572ce9 instanceof Error?_0x572ce9[_0x2954cb(0x126)]:'Unknown\x20error'));}}async['processWebhook'](_0x29ebd7){const _0x5ac32a=a52_0x1e7a0b;console[_0x5ac32a(0x17d)](_0x5ac32a(0x161),_0x29ebd7);let _0x106002=_0x5ac32a(0x18e),_0x455967;_0x29ebd7[_0x5ac32a(0x16a)]?.['failure_message']&&(_0x455967=_0x29ebd7[_0x5ac32a(0x16a)]['failure_message'],console['log'](_0x5ac32a(0x143)+_0x455967));switch(_0x29ebd7[_0x5ac32a(0x122)]?.[_0x5ac32a(0x12b)]()){case'PAYMENT_COMPLETED':_0x29ebd7[_0x5ac32a(0x16a)]?.[_0x5ac32a(0x136)]===!![]&&_0x29ebd7[_0x5ac32a(0x16a)]?.[_0x5ac32a(0x18b)]===_0x5ac32a(0x152)?_0x106002=_0x5ac32a(0x130):_0x106002=_0x5ac32a(0x18e);break;case _0x5ac32a(0x164):_0x106002=_0x5ac32a(0x12e);break;case _0x5ac32a(0x127):_0x106002=_0x5ac32a(0x184);break;case _0x5ac32a(0x167):_0x106002=_0x5ac32a(0x12e);!_0x455967&&_0x29ebd7[_0x5ac32a(0x16a)]?.['failure_message']&&(_0x455967=_0x29ebd7['data'][_0x5ac32a(0x116)]);break;default:switch(_0x29ebd7[_0x5ac32a(0x16a)]?.[_0x5ac32a(0x18b)]?.[_0x5ac32a(0x12b)]()){case _0x5ac32a(0x152):_0x29ebd7[_0x5ac32a(0x16a)]?.[_0x5ac32a(0x136)]===!![]?_0x106002=_0x5ac32a(0x130):_0x106002=_0x5ac32a(0x12e);break;case'CAN':_0x106002='FAILED';break;case _0x5ac32a(0x16b):_0x106002=_0x5ac32a(0x184);break;case _0x5ac32a(0x188):_0x106002=_0x5ac32a(0x12e);!_0x455967&&_0x29ebd7['data']?.[_0x5ac32a(0x116)]&&(_0x455967=_0x29ebd7['data']['failure_message']);break;case'NEW':case _0x5ac32a(0x172):default:_0x106002=_0x5ac32a(0x18e);break;}break;}const _0x13b4e9={};return _0x29ebd7['data']?.[_0x5ac32a(0x16d)]?.['last4']&&(_0x13b4e9[_0x5ac32a(0x119)]=_0x29ebd7[_0x5ac32a(0x16a)]['payment_method_data'][_0x5ac32a(0x11b)]),_0x29ebd7[_0x5ac32a(0x16a)]?.['payment_method_type']&&(_0x13b4e9[_0x5ac32a(0x182)]=_0x29ebd7[_0x5ac32a(0x16a)][_0x5ac32a(0x11d)]),_0x29ebd7[_0x5ac32a(0x16a)]?.['error_code']&&(_0x13b4e9[_0x5ac32a(0x158)]=_0x29ebd7[_0x5ac32a(0x16a)][_0x5ac32a(0x11f)]),_0x29ebd7[_0x5ac32a(0x16a)]?.[_0x5ac32a(0x160)]&&(_0x13b4e9[_0x5ac32a(0x16c)]=_0x29ebd7[_0x5ac32a(0x16a)]['failure_code']),console[_0x5ac32a(0x17d)](_0x5ac32a(0x135)+_0x106002+_0x5ac32a(0x18a)+(_0x455967||_0x5ac32a(0x173))),{'paymentId':_0x29ebd7[_0x5ac32a(0x16a)]?.[_0x5ac32a(0x15e)]||'','status':_0x106002,'amount':_0x29ebd7[_0x5ac32a(0x16a)]?.[_0x5ac32a(0x13d)],'currency':_0x29ebd7[_0x5ac32a(0x16a)]?.['currency'],'failureMessage':_0x455967,'additionalInfo':_0x13b4e9};}}function a52_0x3246(){const _0x5a15ed=['💳\x20Payment\x20Methods:\x20gb_visa_card,\x20gb_mastercard_card','Unknown\x20error\x20from\x20Rapyd\x20API','32038402MHwaAz','SUCCESS','Status\x20Text:','===\x20RAPYD\x20API\x20REQUEST\x20(White\x20Domain\x20-\x20Updated\x20Format)\x20===','Error\x20details:',',\x20body:\x20','CLO','Failed\x20to\x20create\x20Rapyd\x20payment\x20link:\x20Unknown\x20error','8920835AyUWjs','loggerService','Missing\x20id\x20or\x20redirect_url\x20in\x20response','Rapyd\x20payment\x20verification\x20error:','errorCode','application/json','../loggerService','\x20\x20\x20fixed_side:\x20buy','🇬🇧\x20Using\x20GB\x20(Britain)\x20as\x20country\x20for\x20Rapyd\x20payment\x20link','412040KRQnic','merchant_reference_id','\x20(GB\x20-\x20Britain)','failure_code','Processing\x20Rapyd\x20webhook:','text','defineProperty','PAYMENT_CANCELED','2867199MJSduZ','Full\x20Error\x20Data:','PAYMENT_FAILED','HTTP\x20error!\x20status:\x20','4519030XNJEby','data','EXP','failureCode','payment_method_data','Response\x20Time:','__esModule','UNKNOWN','apiUrl','ACT','none','🌐\x20Rapyd\x20service\x20initialized\x20with\x20white\x20domain\x20proxy','json','gb_visa_card','Error\x20Message:','NEW','TesSoft\x20Payment\x20System/1.0','Response\x20Body:','buy','Failed\x20to\x20parse\x20JSON\x20response:','log','===\x20RAPYD\x20API\x20INCOMPLETE\x20RESPONSE\x20===','rapyd','40JZONiq','Rapyd\x20API\x20error\x20(','paymentMethod','https://tesoft.uk/gateway/rapyd/','EXPIRED','439286OXcnSZ','\x20\x20\x20expiration:\x20','logWhiteDomainError','ERR','Request\x20Body\x20(Updated\x20Format):',',\x20failureMessage=','status','===\x20PARSED\x20RAPYD\x20RESPONSE\x20===','===\x20RAPYD\x20API\x20BUSINESS\x20ERROR\x20===','PENDING','Invalid\x20JSON\x20response\x20from\x20Rapyd\x20API:\x20','https://tesoft.uk/gateway/fail.php?id=','redirect_url','\x20(always\x20GB\x20for\x20Rapyd)','4pqlGqq','error','Invalid\x20response\x20from\x20Rapyd\x20API:\x20missing\x20id\x20or\x20redirect_url','EUR','failure_message','requested_currency','https://tesoft.uk/gateway/success.php?id=','cardLast4','GET','last4','stringify','payment_method_type','Redirect\x20URL:','error_code','24HzPsWQ','Business\x20Error\x20(','type','logWhiteDomainRequest','HTTP\x20Status:','Incomplete\x20response:\x20missing\x20id\x20or\x20redirect_url','message','PAYMENT_EXPIRED','4RoKHWx','===\x20RAPYD\x20SERVICE\x20ERROR\x20===','currency','toUpperCase','createPaymentLink','now','FAILED','\x20->\x20EUR:','PAID','💱\x20Adding\x20currency\x20conversion\x20fields\x20for\x20','statusText','Rapyd\x20API\x20error:\x20','/v1/hosted/payment_links','🔄\x20Rapyd\x20webhook\x20processed:\x20status=','paid','508230wEOFQz','Response\x20data:','floor','fixed_side','/v1/hosted/payment_links/','logWhiteDomainResponse','amount','Error\x20message:','toISOString','URL:','gb_mastercard_card','===\x20RAPYD\x20API\x20ERROR\x20===','💥\x20Rapyd\x20failure\x20message:\x20','):\x20','Unknown\x20error','===\x20RAPYD\x20API\x20RESPONSE\x20(White\x20Domain)\x20===','Headers:','RapydService','POST'];a52_0x3246=function(){return _0x5a15ed;};return a52_0x3246();}exports[a52_0x1e7a0b(0x148)]=RapydService;