'use strict';const a50_0x4b17ac=a50_0x34e1;(function(_0xf53416,_0xd2443e){const _0x24fbe4=a50_0x34e1,_0x11a2e2=_0xf53416();while(!![]){try{const _0x5b0982=-parseInt(_0x24fbe4(0x184))/0x1*(-parseInt(_0x24fbe4(0x189))/0x2)+-parseInt(_0x24fbe4(0x14a))/0x3+-parseInt(_0x24fbe4(0x168))/0x4*(parseInt(_0x24fbe4(0x177))/0x5)+parseInt(_0x24fbe4(0x174))/0x6+parseInt(_0x24fbe4(0x169))/0x7*(-parseInt(_0x24fbe4(0x154))/0x8)+parseInt(_0x24fbe4(0x1be))/0x9+parseInt(_0x24fbe4(0x1b6))/0xa*(-parseInt(_0x24fbe4(0x179))/0xb);if(_0x5b0982===_0xd2443e)break;else _0x11a2e2['push'](_0x11a2e2['shift']());}catch(_0x3c9281){_0x11a2e2['push'](_0x11a2e2['shift']());}}}(a50_0x5279,0x5507a));function a50_0x5279(){const _0x47d104=['verifyPayment','Business\x20Error\x20(','last4','parse','PAYMENT_COMPLETED','SUCCESS','text','cardLast4','):\x20','Response\x20Body:','Processing\x20Rapyd\x20webhook:','paymentMethod','data','https://tesoft.uk/gateway/success.php?id=','application/json','Error\x20Message:','Rapyd\x20API\x20error:\x20','Status:','EXPIRED','stack','message','üí±\x20Adding\x20currency\x20conversion\x20fields\x20for\x20','Raw\x20Response\x20Body:','Status\x20Text:','logWhiteDomainRequest','üá¨üáß\x20Country\x20used:\x20','currency','Invalid\x20JSON\x20response\x20from\x20Rapyd\x20API:\x20','Rapyd\x20payment\x20verification\x20error:','https://tesoft.uk/gateway/fail.php?id=','defineProperty','Parsed\x20Result:','redirect_url','json','../loggerService','===\x20RAPYD\x20API\x20REQUEST\x20(White\x20Domain\x20-\x20Updated\x20Format)\x20===','430HZtCUW','===\x20RAPYD\x20API\x20ERROR\x20===','Incomplete\x20response:\x20missing\x20id\x20or\x20redirect_url','PENDING','Invalid\x20response\x20from\x20Rapyd\x20API:\x20missing\x20id\x20or\x20redirect_url','FAILED','failureCode','fromEntries','689454jWFmNT','stringify','fixed_side','rapyd','floor','TesSoft\x20Payment\x20System/1.0','\x20\x20\x20expiration:\x20','===\x20RAPYD\x20SUCCESS\x20===','__esModule','HTTP\x20Status:','UNKNOWN','payment_method_type','NEW','Failed\x20to\x20verify\x20Rapyd\x20payment:\x20','Response\x20Time:','\x20(always\x20GB\x20for\x20Rapyd)','statusText','failure_message','EXP','buy','/v1/hosted/payment_links','1663761voLtgU','EUR','\x20->\x20EUR:','CLO','===\x20RAPYD\x20API\x20BUSINESS\x20ERROR\x20===','error_code','now','logWhiteDomainResponse','payment_method_data','Error\x20stack:','2776dONUOP','\x20(GB\x20-\x20Britain)','type','GET','paid','===\x20RAPYD\x20SERVICE\x20ERROR\x20===','HTTP\x20error!\x20status:\x20','gb_visa_card','PAYMENT_CANCELED','PAID','CAN','ACT','toUpperCase','Error\x20Code:','Headers:','POST','Error\x20message:','headers','Failed\x20to\x20create\x20Rapyd\x20payment\x20link:\x20Unknown\x20error','loggerService','100NaxtMg','1463oIhwQp','\x20\x20\x20fixed_side:\x20buy','logWhiteDomainError','üí≥\x20Payment\x20Methods:\x20gb_visa_card,\x20gb_mastercard_card','Unknown\x20error\x20from\x20Rapyd\x20API','HTTP\x20','Rapyd\x20API\x20error\x20(','Failed\x20to\x20create\x20Rapyd\x20payment\x20link:\x20','log','status','processWebhook','3872658hXHjZo','apiUrl',',\x20failureMessage=','9980PlLgNm','ORDER:\x20','83765GgDefy','Unknown\x20error','/v1/hosted/payment_links/','\x20\x20\x20requested_currency:\x20EUR','JSON\x20Parse\x20Error:\x20','amount','Payment\x20Link\x20ID:','failure_code','https://tesoft.uk/gateway/rapyd/','Full\x20Error\x20Data:','createPaymentLink','4XZHEGh','toISOString','URL:',',\x20body:\x20','üí•\x20Rapyd\x20failure\x20message:\x20','315344yLQDds','errorCode','expiration','Redirect\x20URL:','PAYMENT_FAILED','error','üåê\x20Rapyd\x20service\x20initialized\x20with\x20white\x20domain\x20proxy','requested_currency','Request\x20Body\x20(Updated\x20Format):'];a50_0x5279=function(){return _0x47d104;};return a50_0x5279();}function a50_0x34e1(_0x4a5cb2,_0x207156){const _0x52793f=a50_0x5279();return a50_0x34e1=function(_0x34e102,_0x375873){_0x34e102=_0x34e102-0x149;let _0x2f6344=_0x52793f[_0x34e102];return _0x2f6344;},a50_0x34e1(_0x4a5cb2,_0x207156);}Object[a50_0x4b17ac(0x1b0)](exports,a50_0x4b17ac(0x1c6),{'value':!![]}),exports['RapydService']=void 0x0;const loggerService_1=require(a50_0x4b17ac(0x1b4));class RapydService{constructor(){const _0x490a06=a50_0x4b17ac;this['apiUrl']=_0x490a06(0x181),console['log'](_0x490a06(0x18f));}async[a50_0x4b17ac(0x183)](_0x16b004){const _0x49ab4e=a50_0x4b17ac,{orderId:_0x1d4103,orderName:_0x2a949e,amount:_0x5cb683,currency:_0x3c63d3,usage:_0x279de9,maxPayments:_0x299bc6,successUrl:_0x117d2e,failUrl:_0x3db202}=_0x16b004,_0x5a115c=_0x3c63d3[_0x49ab4e(0x160)](),_0x89777='GB';console[_0x49ab4e(0x171)]('üá¨üáß\x20Using\x20GB\x20(Britain)\x20as\x20country\x20for\x20Rapyd\x20payment\x20link');const _0x39008e=_0x49ab4e(0x19f)+_0x1d4103,_0x37d6e1=_0x49ab4e(0x1af)+_0x1d4103,_0x5d35ac={'amount':_0x5cb683,'currency':_0x5a115c,'cancel_checkout_url':_0x37d6e1,'complete_checkout_url':_0x39008e,'complete_payment_url':_0x39008e,'merchant_reference_id':_0x1d4103,'description':_0x49ab4e(0x178)+_0x1d4103,'country':'GB','payment_method_types_include':[_0x49ab4e(0x15b),'gb_mastercard_card'],'custom_elements':{'display_description':!![]}};if(_0x5a115c!=='EUR'){const _0x4ceee8=Math[_0x49ab4e(0x1c2)](Date[_0x49ab4e(0x150)]()/0x3e8)+0x1e*0x3c;_0x5d35ac[_0x49ab4e(0x1c0)]=_0x49ab4e(0x1d1),_0x5d35ac[_0x49ab4e(0x190)]=_0x49ab4e(0x14b),_0x5d35ac[_0x49ab4e(0x18b)]=_0x4ceee8,console[_0x49ab4e(0x171)](_0x49ab4e(0x1a7)+_0x5a115c+_0x49ab4e(0x14c)),console[_0x49ab4e(0x171)](_0x49ab4e(0x16a)),console[_0x49ab4e(0x171)](_0x49ab4e(0x17c)),console['log'](_0x49ab4e(0x1c4)+_0x4ceee8+'\x20('+new Date(_0x4ceee8*0x3e8)[_0x49ab4e(0x185)]()+')');}const _0x68b461=Date[_0x49ab4e(0x150)]();try{console['log'](_0x49ab4e(0x1b5)),console[_0x49ab4e(0x171)](_0x49ab4e(0x186),this[_0x49ab4e(0x175)]),console[_0x49ab4e(0x171)](_0x49ab4e(0x191),JSON['stringify'](_0x5d35ac,null,0x2)),console[_0x49ab4e(0x171)]('üá¨üáß\x20Country:\x20'+_0x89777+_0x49ab4e(0x1cd)),console[_0x49ab4e(0x171)](_0x49ab4e(0x16c)),loggerService_1['loggerService'][_0x49ab4e(0x1aa)](_0x49ab4e(0x1c1),_0x49ab4e(0x149),_0x49ab4e(0x163),_0x5d35ac);const _0x2842ec=await fetch(this['apiUrl'],{'method':_0x49ab4e(0x163),'headers':{'Content-Type':_0x49ab4e(0x1a0),'User-Agent':_0x49ab4e(0x1c3)},'body':JSON['stringify'](_0x5d35ac)}),_0x3020e6=Date[_0x49ab4e(0x150)]()-_0x68b461;console[_0x49ab4e(0x171)]('===\x20RAPYD\x20API\x20RESPONSE\x20(White\x20Domain)\x20==='),console[_0x49ab4e(0x171)](_0x49ab4e(0x1a3),_0x2842ec['status']),console[_0x49ab4e(0x171)](_0x49ab4e(0x1a9),_0x2842ec[_0x49ab4e(0x1ce)]),console[_0x49ab4e(0x171)](_0x49ab4e(0x162),Object[_0x49ab4e(0x1bd)](_0x2842ec[_0x49ab4e(0x165)]['entries']())),console['log'](_0x49ab4e(0x1cc),_0x3020e6+'ms');const _0x102030=await _0x2842ec[_0x49ab4e(0x198)]();console['log'](_0x49ab4e(0x1a8),_0x102030);if(!_0x2842ec['ok']){console[_0x49ab4e(0x18e)](_0x49ab4e(0x1b7)),console[_0x49ab4e(0x18e)](_0x49ab4e(0x1c7),_0x2842ec[_0x49ab4e(0x172)]),console[_0x49ab4e(0x18e)](_0x49ab4e(0x19b),_0x102030),loggerService_1[_0x49ab4e(0x167)][_0x49ab4e(0x151)](_0x49ab4e(0x1c1),_0x49ab4e(0x149),_0x2842ec[_0x49ab4e(0x172)],_0x102030,_0x3020e6),loggerService_1['loggerService']['logWhiteDomainError']('rapyd','/v1/hosted/payment_links',_0x49ab4e(0x16e)+_0x2842ec[_0x49ab4e(0x172)]+':\x20'+_0x102030);throw new Error(_0x49ab4e(0x15a)+_0x2842ec[_0x49ab4e(0x172)]+_0x49ab4e(0x187)+_0x102030);}let _0x3c7edf;try{_0x3c7edf=JSON[_0x49ab4e(0x195)](_0x102030);}catch(_0x271d75){console[_0x49ab4e(0x18e)]('Failed\x20to\x20parse\x20JSON\x20response:',_0x271d75),loggerService_1[_0x49ab4e(0x167)][_0x49ab4e(0x16b)](_0x49ab4e(0x1c1),'/v1/hosted/payment_links',_0x49ab4e(0x17d)+_0x271d75);throw new Error(_0x49ab4e(0x1ad)+_0x102030);}console[_0x49ab4e(0x171)]('===\x20PARSED\x20RAPYD\x20RESPONSE\x20==='),console[_0x49ab4e(0x171)](_0x49ab4e(0x1b1),JSON[_0x49ab4e(0x1bf)](_0x3c7edf,null,0x2)),loggerService_1[_0x49ab4e(0x167)]['logWhiteDomainResponse'](_0x49ab4e(0x1c1),'/v1/hosted/payment_links',_0x2842ec[_0x49ab4e(0x172)],_0x3c7edf,_0x3020e6);if(_0x3c7edf[_0x49ab4e(0x172)]?.['status']!==_0x49ab4e(0x197)){const _0x425c69=_0x3c7edf[_0x49ab4e(0x172)]?.[_0x49ab4e(0x1a6)]||_0x49ab4e(0x16d),_0x1e08ae=_0x3c7edf[_0x49ab4e(0x172)]?.[_0x49ab4e(0x14f)]||_0x49ab4e(0x1c8);console[_0x49ab4e(0x18e)](_0x49ab4e(0x14e)),console[_0x49ab4e(0x18e)](_0x49ab4e(0x161),_0x1e08ae),console[_0x49ab4e(0x18e)](_0x49ab4e(0x1a1),_0x425c69),console['error'](_0x49ab4e(0x182),_0x3c7edf[_0x49ab4e(0x172)]),loggerService_1[_0x49ab4e(0x167)][_0x49ab4e(0x16b)](_0x49ab4e(0x1c1),_0x49ab4e(0x149),_0x49ab4e(0x193)+_0x1e08ae+_0x49ab4e(0x19a)+_0x425c69);throw new Error(_0x49ab4e(0x16f)+_0x1e08ae+_0x49ab4e(0x19a)+_0x425c69);}if(!_0x3c7edf[_0x49ab4e(0x19e)]?.['id']||!_0x3c7edf[_0x49ab4e(0x19e)]?.[_0x49ab4e(0x1b2)]){console[_0x49ab4e(0x18e)]('===\x20RAPYD\x20API\x20INCOMPLETE\x20RESPONSE\x20==='),console[_0x49ab4e(0x18e)]('Missing\x20id\x20or\x20redirect_url\x20in\x20response'),console[_0x49ab4e(0x18e)]('Response\x20data:',_0x3c7edf['data']),loggerService_1['loggerService'][_0x49ab4e(0x16b)]('rapyd',_0x49ab4e(0x149),_0x49ab4e(0x1b8));throw new Error(_0x49ab4e(0x1ba));}return console[_0x49ab4e(0x171)](_0x49ab4e(0x1c5)),console[_0x49ab4e(0x171)](_0x49ab4e(0x17f),_0x3c7edf[_0x49ab4e(0x19e)]['id']),console[_0x49ab4e(0x171)](_0x49ab4e(0x18c),_0x3c7edf[_0x49ab4e(0x19e)][_0x49ab4e(0x1b2)]),console[_0x49ab4e(0x171)](_0x49ab4e(0x1ab)+_0x89777+_0x49ab4e(0x155)),console[_0x49ab4e(0x171)]('üí≥\x20Payment\x20Methods:\x20gb_visa_card,\x20gb_mastercard_card'),{'gateway_payment_id':_0x3c7edf[_0x49ab4e(0x19e)]['id'],'payment_url':_0x3c7edf[_0x49ab4e(0x19e)][_0x49ab4e(0x1b2)]};}catch(_0x4d9bb7){console[_0x49ab4e(0x18e)](_0x49ab4e(0x159)),console[_0x49ab4e(0x18e)]('Error\x20details:',_0x4d9bb7),loggerService_1[_0x49ab4e(0x167)][_0x49ab4e(0x16b)](_0x49ab4e(0x1c1),_0x49ab4e(0x149),_0x4d9bb7);if(_0x4d9bb7 instanceof Error){console[_0x49ab4e(0x18e)](_0x49ab4e(0x164),_0x4d9bb7['message']),console['error'](_0x49ab4e(0x153),_0x4d9bb7[_0x49ab4e(0x1a5)]);throw new Error(_0x49ab4e(0x170)+_0x4d9bb7[_0x49ab4e(0x1a6)]);}throw new Error(_0x49ab4e(0x166));}}async[a50_0x4b17ac(0x192)](_0x44454a){const _0x5adbdd=a50_0x4b17ac,_0x574861=Date['now']();try{loggerService_1[_0x5adbdd(0x167)][_0x5adbdd(0x1aa)](_0x5adbdd(0x1c1),_0x5adbdd(0x17b)+_0x44454a,_0x5adbdd(0x157),{});const _0x2864b2=await fetch(this[_0x5adbdd(0x175)]+'/'+_0x44454a,{'method':'GET','headers':{'Content-Type':_0x5adbdd(0x1a0),'User-Agent':_0x5adbdd(0x1c3)}}),_0x52a778=Date[_0x5adbdd(0x150)]()-_0x574861;if(!_0x2864b2['ok']){const _0x416710=await _0x2864b2[_0x5adbdd(0x198)]();loggerService_1[_0x5adbdd(0x167)][_0x5adbdd(0x151)](_0x5adbdd(0x1c1),_0x5adbdd(0x17b)+_0x44454a,_0x2864b2[_0x5adbdd(0x172)],_0x416710,_0x52a778);throw new Error(_0x5adbdd(0x15a)+_0x2864b2[_0x5adbdd(0x172)]);}const _0x25b1ec=await _0x2864b2[_0x5adbdd(0x1b3)]();loggerService_1[_0x5adbdd(0x167)][_0x5adbdd(0x151)](_0x5adbdd(0x1c1),_0x5adbdd(0x17b)+_0x44454a,_0x2864b2[_0x5adbdd(0x172)],_0x25b1ec,_0x52a778);if(_0x25b1ec['status']?.['status']!==_0x5adbdd(0x197)){loggerService_1[_0x5adbdd(0x167)][_0x5adbdd(0x16b)](_0x5adbdd(0x1c1),_0x5adbdd(0x17b)+_0x44454a,_0x5adbdd(0x1a2)+(_0x25b1ec['status']?.[_0x5adbdd(0x1a6)]||_0x5adbdd(0x17a)));throw new Error(_0x5adbdd(0x1a2)+(_0x25b1ec[_0x5adbdd(0x172)]?.[_0x5adbdd(0x1a6)]||'Unknown\x20error'));}let _0x184278='PENDING';if(_0x25b1ec['data']?.['status'])switch(_0x25b1ec[_0x5adbdd(0x19e)][_0x5adbdd(0x172)][_0x5adbdd(0x160)]()){case _0x5adbdd(0x14d):_0x184278=_0x5adbdd(0x15d);break;case'CAN':_0x184278=_0x5adbdd(0x1bb);break;case _0x5adbdd(0x1d0):_0x184278=_0x5adbdd(0x1a4);break;case'ERR':_0x184278=_0x5adbdd(0x1bb);break;case _0x5adbdd(0x1ca):case _0x5adbdd(0x15f):default:_0x184278='PENDING';break;}return{'status':_0x184278,'amount':_0x25b1ec[_0x5adbdd(0x19e)]?.[_0x5adbdd(0x17e)],'currency':_0x25b1ec[_0x5adbdd(0x19e)]?.['currency']};}catch(_0x222b8a){console[_0x5adbdd(0x18e)](_0x5adbdd(0x1ae),_0x222b8a),loggerService_1[_0x5adbdd(0x167)][_0x5adbdd(0x16b)](_0x5adbdd(0x1c1),_0x5adbdd(0x17b)+_0x44454a,_0x222b8a);throw new Error(_0x5adbdd(0x1cb)+(_0x222b8a instanceof Error?_0x222b8a['message']:_0x5adbdd(0x17a)));}}async[a50_0x4b17ac(0x173)](_0x2b55a6){const _0x17468b=a50_0x4b17ac;console[_0x17468b(0x171)](_0x17468b(0x19c),_0x2b55a6);let _0x3e7fee=_0x17468b(0x1b9),_0x3c351e;_0x2b55a6[_0x17468b(0x19e)]?.[_0x17468b(0x1cf)]&&(_0x3c351e=_0x2b55a6[_0x17468b(0x19e)][_0x17468b(0x1cf)],console[_0x17468b(0x171)](_0x17468b(0x188)+_0x3c351e));switch(_0x2b55a6[_0x17468b(0x156)]?.[_0x17468b(0x160)]()){case _0x17468b(0x196):_0x2b55a6['data']?.[_0x17468b(0x158)]===!![]&&_0x2b55a6[_0x17468b(0x19e)]?.['status']===_0x17468b(0x14d)?_0x3e7fee=_0x17468b(0x15d):_0x3e7fee='PENDING';break;case _0x17468b(0x15c):_0x3e7fee=_0x17468b(0x1bb);break;case'PAYMENT_EXPIRED':_0x3e7fee='EXPIRED';break;case _0x17468b(0x18d):_0x3e7fee='FAILED';!_0x3c351e&&_0x2b55a6[_0x17468b(0x19e)]?.[_0x17468b(0x1cf)]&&(_0x3c351e=_0x2b55a6[_0x17468b(0x19e)][_0x17468b(0x1cf)]);break;default:switch(_0x2b55a6['data']?.['status']?.[_0x17468b(0x160)]()){case _0x17468b(0x14d):_0x2b55a6[_0x17468b(0x19e)]?.[_0x17468b(0x158)]===!![]?_0x3e7fee=_0x17468b(0x15d):_0x3e7fee=_0x17468b(0x1bb);break;case _0x17468b(0x15e):_0x3e7fee=_0x17468b(0x1bb);break;case'EXP':_0x3e7fee=_0x17468b(0x1a4);break;case'ERR':_0x3e7fee=_0x17468b(0x1bb);!_0x3c351e&&_0x2b55a6[_0x17468b(0x19e)]?.['failure_message']&&(_0x3c351e=_0x2b55a6[_0x17468b(0x19e)][_0x17468b(0x1cf)]);break;case _0x17468b(0x1ca):case _0x17468b(0x15f):default:_0x3e7fee=_0x17468b(0x1b9);break;}break;}const _0x2f02e7={};return _0x2b55a6[_0x17468b(0x19e)]?.['payment_method_data']?.[_0x17468b(0x194)]&&(_0x2f02e7[_0x17468b(0x199)]=_0x2b55a6[_0x17468b(0x19e)][_0x17468b(0x152)]['last4']),_0x2b55a6[_0x17468b(0x19e)]?.[_0x17468b(0x1c9)]&&(_0x2f02e7[_0x17468b(0x19d)]=_0x2b55a6[_0x17468b(0x19e)][_0x17468b(0x1c9)]),_0x2b55a6[_0x17468b(0x19e)]?.[_0x17468b(0x14f)]&&(_0x2f02e7[_0x17468b(0x18a)]=_0x2b55a6['data']['error_code']),_0x2b55a6[_0x17468b(0x19e)]?.['failure_code']&&(_0x2f02e7[_0x17468b(0x1bc)]=_0x2b55a6[_0x17468b(0x19e)][_0x17468b(0x180)]),console[_0x17468b(0x171)]('üîÑ\x20Rapyd\x20webhook\x20processed:\x20status='+_0x3e7fee+_0x17468b(0x176)+(_0x3c351e||'none')),{'paymentId':_0x2b55a6[_0x17468b(0x19e)]?.['merchant_reference_id']||'','status':_0x3e7fee,'amount':_0x2b55a6['data']?.[_0x17468b(0x17e)],'currency':_0x2b55a6[_0x17468b(0x19e)]?.[_0x17468b(0x1ac)],'failureMessage':_0x3c351e,'additionalInfo':_0x2f02e7};}}exports['RapydService']=RapydService;