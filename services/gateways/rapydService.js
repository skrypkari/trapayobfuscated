'use strict';function a53_0x3592(){const _0x141017=['logWhiteDomainResponse','🇬🇧\x20Country:\x20','💱\x20Adding\x20currency\x20conversion\x20fields\x20for\x20','Raw\x20Response\x20Body:','Unknown\x20error','4628272sehgPL','===\x20RAPYD\x20SERVICE\x20ERROR\x20===','Redirect\x20URL:','ACT','EXPIRED','none','1351hBDcfW','EXP','verifyPayment','logWhiteDomainError','Error\x20stack:','PAID','https://tesoft.uk/gateway/fail.php?id=','Failed\x20to\x20parse\x20JSON\x20response:','Error\x20details:','last4','💥\x20Rapyd\x20failure\x20message:\x20','log','91EJzoha','HTTP\x20error!\x20status:\x20','Business\x20Error\x20(','redirect_url','now','processWebhook','Error\x20Code:','gb_mastercard_card','Processing\x20Rapyd\x20webhook:','Missing\x20id\x20or\x20redirect_url\x20in\x20response','Invalid\x20response\x20from\x20Rapyd\x20API:\x20missing\x20id\x20or\x20redirect_url',',\x20body:\x20','toUpperCase','===\x20RAPYD\x20API\x20RESPONSE\x20(White\x20Domain)\x20===','../loggerService','data','failure_message','369UvLIzo','16210hBnraA','\x20(always\x20GB\x20for\x20Rapyd)','Payment\x20Link\x20ID:','application/json','Full\x20Error\x20Data:','\x20\x20\x20expiration:\x20','paymentMethod','Incomplete\x20response:\x20missing\x20id\x20or\x20redirect_url','🌐\x20Rapyd\x20service\x20initialized\x20with\x20white\x20domain\x20proxy','ORDER:\x20','createPaymentLink','===\x20RAPYD\x20API\x20INCOMPLETE\x20RESPONSE\x20===','Parsed\x20Result:','FAILED','===\x20RAPYD\x20API\x20ERROR\x20===','rapyd','):\x20','stack',',\x20failureMessage=','Rapyd\x20API\x20error\x20(','json','currency','floor','errorCode','requested_currency','https://tesoft.uk/gateway/success.php?id=','fixed_side','Unknown\x20error\x20from\x20Rapyd\x20API','Failed\x20to\x20verify\x20Rapyd\x20payment:\x20','UNKNOWN','Error\x20message:','loggerService','CAN','EUR','Rapyd\x20API\x20error:\x20','error_code','Status:','PAYMENT_EXPIRED','15nOcqfO','5056MyDtoG','cardLast4','GET','\x20\x20\x20requested_currency:\x20EUR','8fnWgdc','Response\x20Body:','NEW','payment_method_data','RapydService','text','JSON\x20Parse\x20Error:\x20','expiration','💳\x20Payment\x20Methods:\x20gb_visa_card,\x20gb_mastercard_card','SUCCESS','🇬🇧\x20Using\x20GB\x20(Britain)\x20as\x20country\x20for\x20Rapyd\x20payment\x20link','Failed\x20to\x20create\x20Rapyd\x20payment\x20link:\x20','fromEntries','===\x20RAPYD\x20SUCCESS\x20===','1453884qPLnnD','status','26534JnJoHB','apiUrl','message','statusText','error','Invalid\x20JSON\x20response\x20from\x20Rapyd\x20API:\x20','failure_code','POST','PENDING','buy','Payment\x20System/1.0','\x20->\x20EUR:','CLO','===\x20PARSED\x20RAPYD\x20RESPONSE\x20===','payment_method_type','headers','merchant_reference_id','ERR','parse','661581lJofpt','===\x20RAPYD\x20API\x20BUSINESS\x20ERROR\x20===','\x20\x20\x20fixed_side:\x20buy','URL:','12BTqWAw','stringify','type','defineProperty','failureCode','1198476VTwHby','/v1/hosted/payment_links/','/v1/hosted/payment_links','Error\x20Message:','PAYMENT_COMPLETED','HTTP\x20Status:','entries'];a53_0x3592=function(){return _0x141017;};return a53_0x3592();}const a53_0x1efd08=a53_0x1b19;(function(_0x3407b4,_0x3eb71c){const _0x3c717c=a53_0x1b19,_0x11c101=_0x3407b4();while(!![]){try{const _0xf3d5f9=-parseInt(_0x3c717c(0x1d2))/0x1*(-parseInt(_0x3c717c(0x15b))/0x2)+-parseInt(_0x3c717c(0x16e))/0x3*(parseInt(_0x3c717c(0x172))/0x4)+-parseInt(_0x3c717c(0x1cd))/0x5*(-parseInt(_0x3c717c(0x177))/0x6)+parseInt(_0x3c717c(0x189))/0x7*(-parseInt(_0x3c717c(0x1ce))/0x8)+parseInt(_0x3c717c(0x1a6))/0x9*(parseInt(_0x3c717c(0x1a7))/0xa)+-parseInt(_0x3c717c(0x183))/0xb+parseInt(_0x3c717c(0x159))/0xc*(parseInt(_0x3c717c(0x195))/0xd);if(_0xf3d5f9===_0x3eb71c)break;else _0x11c101['push'](_0x11c101['shift']());}catch(_0x5d4571){_0x11c101['push'](_0x11c101['shift']());}}}(a53_0x3592,0x65789));function a53_0x1b19(_0x93e7c0,_0x5bfb0d){const _0x35925e=a53_0x3592();return a53_0x1b19=function(_0x1b19de,_0x396966){_0x1b19de=_0x1b19de-0x159;let _0x1ed7dc=_0x35925e[_0x1b19de];return _0x1ed7dc;},a53_0x1b19(_0x93e7c0,_0x5bfb0d);}Object[a53_0x1efd08(0x175)](exports,'__esModule',{'value':!![]}),exports[a53_0x1efd08(0x1d6)]=void 0x0;const loggerService_1=require(a53_0x1efd08(0x1a3));class RapydService{constructor(){const _0x3717e4=a53_0x1efd08;this[_0x3717e4(0x15c)]='https://tesoft.uk/gateway/rapyd/',console[_0x3717e4(0x194)](_0x3717e4(0x1af));}async[a53_0x1efd08(0x1b1)](_0x30aaa7){const _0x382ab8=a53_0x1efd08,{orderId:_0x4c98d3,orderName:_0x42d0d9,amount:_0x4d11ee,currency:_0x47bb6d,usage:_0x6a5330,maxPayments:_0x2cf7cb,successUrl:_0x10fb29,failUrl:_0x41bd07}=_0x30aaa7,_0x2b08cb=_0x47bb6d[_0x382ab8(0x1a1)](),_0x12d2da='GB';console[_0x382ab8(0x194)](_0x382ab8(0x1dc));const _0x32e1be=_0x382ab8(0x1c0)+_0x4c98d3,_0x23740a=_0x382ab8(0x18f)+_0x4c98d3,_0xca07aa={'amount':_0x4d11ee,'currency':_0x2b08cb,'cancel_checkout_url':_0x23740a,'complete_checkout_url':_0x32e1be,'complete_payment_url':_0x32e1be,'merchant_reference_id':_0x4c98d3,'description':_0x382ab8(0x1b0)+_0x4c98d3,'country':'GB','payment_method_types_include':['gb_visa_card',_0x382ab8(0x19c)],'custom_elements':{'display_description':!![]}};if(_0x2b08cb!==_0x382ab8(0x1c8)){const _0x3b6508=Math[_0x382ab8(0x1bd)](Date[_0x382ab8(0x199)]()/0x3e8)+0x1e*0x3c;_0xca07aa[_0x382ab8(0x1c1)]=_0x382ab8(0x164),_0xca07aa[_0x382ab8(0x1bf)]='EUR',_0xca07aa[_0x382ab8(0x1d9)]=_0x3b6508,console[_0x382ab8(0x194)](_0x382ab8(0x180)+_0x2b08cb+_0x382ab8(0x166)),console['log'](_0x382ab8(0x170)),console[_0x382ab8(0x194)](_0x382ab8(0x1d1)),console[_0x382ab8(0x194)](_0x382ab8(0x1ac)+_0x3b6508+'\x20('+new Date(_0x3b6508*0x3e8)['toISOString']()+')');}const _0x32fde8=Date['now']();try{console[_0x382ab8(0x194)]('===\x20RAPYD\x20API\x20REQUEST\x20(White\x20Domain\x20-\x20Updated\x20Format)\x20==='),console[_0x382ab8(0x194)](_0x382ab8(0x171),this[_0x382ab8(0x15c)]),console[_0x382ab8(0x194)]('Request\x20Body\x20(Updated\x20Format):',JSON[_0x382ab8(0x173)](_0xca07aa,null,0x2)),console[_0x382ab8(0x194)](_0x382ab8(0x17f)+_0x12d2da+_0x382ab8(0x1a8)),console['log'](_0x382ab8(0x1da)),loggerService_1[_0x382ab8(0x1c6)]['logWhiteDomainRequest'](_0x382ab8(0x1b6),'/v1/hosted/payment_links',_0x382ab8(0x162),_0xca07aa);const _0x8259d5=await fetch(this['apiUrl'],{'method':_0x382ab8(0x162),'headers':{'Content-Type':_0x382ab8(0x1aa),'User-Agent':_0x382ab8(0x165)},'body':JSON[_0x382ab8(0x173)](_0xca07aa)}),_0x70c7c5=Date[_0x382ab8(0x199)]()-_0x32fde8;console[_0x382ab8(0x194)](_0x382ab8(0x1a2)),console[_0x382ab8(0x194)](_0x382ab8(0x1cb),_0x8259d5[_0x382ab8(0x15a)]),console[_0x382ab8(0x194)]('Status\x20Text:',_0x8259d5[_0x382ab8(0x15e)]),console[_0x382ab8(0x194)]('Headers:',Object[_0x382ab8(0x1de)](_0x8259d5[_0x382ab8(0x16a)][_0x382ab8(0x17d)]())),console['log']('Response\x20Time:',_0x70c7c5+'ms');const _0x39f9f7=await _0x8259d5[_0x382ab8(0x1d7)]();console[_0x382ab8(0x194)](_0x382ab8(0x181),_0x39f9f7);if(!_0x8259d5['ok']){console[_0x382ab8(0x15f)](_0x382ab8(0x1b5)),console[_0x382ab8(0x15f)](_0x382ab8(0x17c),_0x8259d5[_0x382ab8(0x15a)]),console[_0x382ab8(0x15f)](_0x382ab8(0x1d3),_0x39f9f7),loggerService_1[_0x382ab8(0x1c6)][_0x382ab8(0x17e)](_0x382ab8(0x1b6),'/v1/hosted/payment_links',_0x8259d5[_0x382ab8(0x15a)],_0x39f9f7,_0x70c7c5),loggerService_1[_0x382ab8(0x1c6)][_0x382ab8(0x18c)](_0x382ab8(0x1b6),_0x382ab8(0x179),'HTTP\x20'+_0x8259d5[_0x382ab8(0x15a)]+':\x20'+_0x39f9f7);throw new Error(_0x382ab8(0x196)+_0x8259d5['status']+_0x382ab8(0x1a0)+_0x39f9f7);}let _0x569ee5;try{_0x569ee5=JSON[_0x382ab8(0x16d)](_0x39f9f7);}catch(_0x5d035c){console[_0x382ab8(0x15f)](_0x382ab8(0x190),_0x5d035c),loggerService_1[_0x382ab8(0x1c6)]['logWhiteDomainError']('rapyd',_0x382ab8(0x179),_0x382ab8(0x1d8)+_0x5d035c);throw new Error(_0x382ab8(0x160)+_0x39f9f7);}console[_0x382ab8(0x194)](_0x382ab8(0x168)),console[_0x382ab8(0x194)](_0x382ab8(0x1b3),JSON['stringify'](_0x569ee5,null,0x2)),loggerService_1[_0x382ab8(0x1c6)]['logWhiteDomainResponse'](_0x382ab8(0x1b6),_0x382ab8(0x179),_0x8259d5[_0x382ab8(0x15a)],_0x569ee5,_0x70c7c5);if(_0x569ee5['status']?.[_0x382ab8(0x15a)]!=='SUCCESS'){const _0x1c4008=_0x569ee5[_0x382ab8(0x15a)]?.['message']||_0x382ab8(0x1c2),_0xbc8801=_0x569ee5[_0x382ab8(0x15a)]?.[_0x382ab8(0x1ca)]||_0x382ab8(0x1c4);console['error'](_0x382ab8(0x16f)),console[_0x382ab8(0x15f)](_0x382ab8(0x19b),_0xbc8801),console['error'](_0x382ab8(0x17a),_0x1c4008),console[_0x382ab8(0x15f)](_0x382ab8(0x1ab),_0x569ee5[_0x382ab8(0x15a)]),loggerService_1['loggerService'][_0x382ab8(0x18c)](_0x382ab8(0x1b6),_0x382ab8(0x179),_0x382ab8(0x197)+_0xbc8801+_0x382ab8(0x1b7)+_0x1c4008);throw new Error(_0x382ab8(0x1ba)+_0xbc8801+_0x382ab8(0x1b7)+_0x1c4008);}if(!_0x569ee5[_0x382ab8(0x1a4)]?.['id']||!_0x569ee5[_0x382ab8(0x1a4)]?.[_0x382ab8(0x198)]){console[_0x382ab8(0x15f)](_0x382ab8(0x1b2)),console[_0x382ab8(0x15f)](_0x382ab8(0x19e)),console[_0x382ab8(0x15f)]('Response\x20data:',_0x569ee5[_0x382ab8(0x1a4)]),loggerService_1['loggerService'][_0x382ab8(0x18c)](_0x382ab8(0x1b6),_0x382ab8(0x179),_0x382ab8(0x1ae));throw new Error(_0x382ab8(0x19f));}return console[_0x382ab8(0x194)](_0x382ab8(0x1df)),console[_0x382ab8(0x194)](_0x382ab8(0x1a9),_0x569ee5[_0x382ab8(0x1a4)]['id']),console['log'](_0x382ab8(0x185),_0x569ee5[_0x382ab8(0x1a4)][_0x382ab8(0x198)]),console['log']('🇬🇧\x20Country\x20used:\x20'+_0x12d2da+'\x20(GB\x20-\x20Britain)'),console[_0x382ab8(0x194)]('💳\x20Payment\x20Methods:\x20gb_visa_card,\x20gb_mastercard_card'),{'gateway_payment_id':_0x569ee5[_0x382ab8(0x1a4)]['id'],'payment_url':_0x569ee5[_0x382ab8(0x1a4)][_0x382ab8(0x198)]};}catch(_0x4de61c){console[_0x382ab8(0x15f)](_0x382ab8(0x184)),console[_0x382ab8(0x15f)](_0x382ab8(0x191),_0x4de61c),loggerService_1[_0x382ab8(0x1c6)][_0x382ab8(0x18c)](_0x382ab8(0x1b6),'/v1/hosted/payment_links',_0x4de61c);if(_0x4de61c instanceof Error){console[_0x382ab8(0x15f)](_0x382ab8(0x1c5),_0x4de61c['message']),console[_0x382ab8(0x15f)](_0x382ab8(0x18d),_0x4de61c[_0x382ab8(0x1b8)]);throw new Error(_0x382ab8(0x1dd)+_0x4de61c[_0x382ab8(0x15d)]);}throw new Error('Failed\x20to\x20create\x20Rapyd\x20payment\x20link:\x20Unknown\x20error');}}async[a53_0x1efd08(0x18b)](_0x3fc7ca){const _0xfaa6eb=a53_0x1efd08,_0x3d8eb0=Date['now']();try{loggerService_1[_0xfaa6eb(0x1c6)]['logWhiteDomainRequest'](_0xfaa6eb(0x1b6),_0xfaa6eb(0x178)+_0x3fc7ca,_0xfaa6eb(0x1d0),{});const _0x29b1a9=await fetch(this[_0xfaa6eb(0x15c)]+'/'+_0x3fc7ca,{'method':_0xfaa6eb(0x1d0),'headers':{'Content-Type':'application/json','User-Agent':'Payment\x20System/1.0'}}),_0x1f842f=Date[_0xfaa6eb(0x199)]()-_0x3d8eb0;if(!_0x29b1a9['ok']){const _0x5dfbfa=await _0x29b1a9['text']();loggerService_1[_0xfaa6eb(0x1c6)][_0xfaa6eb(0x17e)](_0xfaa6eb(0x1b6),_0xfaa6eb(0x178)+_0x3fc7ca,_0x29b1a9[_0xfaa6eb(0x15a)],_0x5dfbfa,_0x1f842f);throw new Error('HTTP\x20error!\x20status:\x20'+_0x29b1a9[_0xfaa6eb(0x15a)]);}const _0xaca0b9=await _0x29b1a9[_0xfaa6eb(0x1bb)]();loggerService_1[_0xfaa6eb(0x1c6)]['logWhiteDomainResponse']('rapyd',_0xfaa6eb(0x178)+_0x3fc7ca,_0x29b1a9[_0xfaa6eb(0x15a)],_0xaca0b9,_0x1f842f);if(_0xaca0b9[_0xfaa6eb(0x15a)]?.[_0xfaa6eb(0x15a)]!==_0xfaa6eb(0x1db)){loggerService_1[_0xfaa6eb(0x1c6)][_0xfaa6eb(0x18c)](_0xfaa6eb(0x1b6),_0xfaa6eb(0x178)+_0x3fc7ca,_0xfaa6eb(0x1c9)+(_0xaca0b9[_0xfaa6eb(0x15a)]?.[_0xfaa6eb(0x15d)]||_0xfaa6eb(0x182)));throw new Error(_0xfaa6eb(0x1c9)+(_0xaca0b9['status']?.[_0xfaa6eb(0x15d)]||_0xfaa6eb(0x182)));}let _0x20043d='PENDING';if(_0xaca0b9[_0xfaa6eb(0x1a4)]?.['status'])switch(_0xaca0b9[_0xfaa6eb(0x1a4)]['status'][_0xfaa6eb(0x1a1)]()){case _0xfaa6eb(0x167):_0x20043d='PAID';break;case _0xfaa6eb(0x1c7):_0x20043d=_0xfaa6eb(0x1b4);break;case _0xfaa6eb(0x18a):_0x20043d=_0xfaa6eb(0x187);break;case _0xfaa6eb(0x16c):_0x20043d=_0xfaa6eb(0x1b4);break;case _0xfaa6eb(0x1d4):case _0xfaa6eb(0x186):default:_0x20043d=_0xfaa6eb(0x163);break;}return{'status':_0x20043d,'amount':_0xaca0b9['data']?.['amount'],'currency':_0xaca0b9[_0xfaa6eb(0x1a4)]?.[_0xfaa6eb(0x1bc)]};}catch(_0x3cc273){console[_0xfaa6eb(0x15f)]('Rapyd\x20payment\x20verification\x20error:',_0x3cc273),loggerService_1[_0xfaa6eb(0x1c6)][_0xfaa6eb(0x18c)](_0xfaa6eb(0x1b6),'/v1/hosted/payment_links/'+_0x3fc7ca,_0x3cc273);throw new Error(_0xfaa6eb(0x1c3)+(_0x3cc273 instanceof Error?_0x3cc273[_0xfaa6eb(0x15d)]:_0xfaa6eb(0x182)));}}async[a53_0x1efd08(0x19a)](_0x23006c){const _0x391dba=a53_0x1efd08;console[_0x391dba(0x194)](_0x391dba(0x19d),_0x23006c);let _0x317fc9=_0x391dba(0x163),_0x159c0a;_0x23006c['data']?.[_0x391dba(0x1a5)]&&(_0x159c0a=_0x23006c[_0x391dba(0x1a4)][_0x391dba(0x1a5)],console[_0x391dba(0x194)](_0x391dba(0x193)+_0x159c0a));switch(_0x23006c[_0x391dba(0x174)]?.[_0x391dba(0x1a1)]()){case _0x391dba(0x17b):_0x23006c[_0x391dba(0x1a4)]?.['paid']===!![]&&_0x23006c[_0x391dba(0x1a4)]?.[_0x391dba(0x15a)]===_0x391dba(0x167)?_0x317fc9=_0x391dba(0x18e):_0x317fc9=_0x391dba(0x163);break;case'PAYMENT_CANCELED':_0x317fc9=_0x391dba(0x1b4);break;case _0x391dba(0x1cc):_0x317fc9='EXPIRED';break;case'PAYMENT_FAILED':_0x317fc9='FAILED';!_0x159c0a&&_0x23006c['data']?.[_0x391dba(0x1a5)]&&(_0x159c0a=_0x23006c[_0x391dba(0x1a4)]['failure_message']);break;default:switch(_0x23006c[_0x391dba(0x1a4)]?.['status']?.[_0x391dba(0x1a1)]()){case'CLO':_0x23006c[_0x391dba(0x1a4)]?.['paid']===!![]?_0x317fc9=_0x391dba(0x18e):_0x317fc9=_0x391dba(0x1b4);break;case'CAN':_0x317fc9=_0x391dba(0x1b4);break;case _0x391dba(0x18a):_0x317fc9=_0x391dba(0x187);break;case _0x391dba(0x16c):_0x317fc9=_0x391dba(0x1b4);!_0x159c0a&&_0x23006c[_0x391dba(0x1a4)]?.[_0x391dba(0x1a5)]&&(_0x159c0a=_0x23006c[_0x391dba(0x1a4)][_0x391dba(0x1a5)]);break;case _0x391dba(0x1d4):case'ACT':default:_0x317fc9=_0x391dba(0x163);break;}break;}const _0xa9b4c1={};return _0x23006c[_0x391dba(0x1a4)]?.[_0x391dba(0x1d5)]?.[_0x391dba(0x192)]&&(_0xa9b4c1[_0x391dba(0x1cf)]=_0x23006c[_0x391dba(0x1a4)][_0x391dba(0x1d5)][_0x391dba(0x192)]),_0x23006c[_0x391dba(0x1a4)]?.['payment_method_type']&&(_0xa9b4c1[_0x391dba(0x1ad)]=_0x23006c['data'][_0x391dba(0x169)]),_0x23006c['data']?.[_0x391dba(0x1ca)]&&(_0xa9b4c1[_0x391dba(0x1be)]=_0x23006c[_0x391dba(0x1a4)][_0x391dba(0x1ca)]),_0x23006c[_0x391dba(0x1a4)]?.[_0x391dba(0x161)]&&(_0xa9b4c1[_0x391dba(0x176)]=_0x23006c[_0x391dba(0x1a4)][_0x391dba(0x161)]),console[_0x391dba(0x194)]('🔄\x20Rapyd\x20webhook\x20processed:\x20status='+_0x317fc9+_0x391dba(0x1b9)+(_0x159c0a||_0x391dba(0x188))),{'paymentId':_0x23006c[_0x391dba(0x1a4)]?.[_0x391dba(0x16b)]||'','status':_0x317fc9,'amount':_0x23006c['data']?.['amount'],'currency':_0x23006c[_0x391dba(0x1a4)]?.[_0x391dba(0x1bc)],'failureMessage':_0x159c0a,'additionalInfo':_0xa9b4c1};}}exports[a53_0x1efd08(0x1d6)]=RapydService;