'use strict';const a50_0x4a1c23=a50_0x255d;(function(_0x18a22d,_0x4d96ad){const _0x37a159=a50_0x255d,_0x4e2f3b=_0x18a22d();while(!![]){try{const _0x8d6a5d=parseInt(_0x37a159(0x1db))/0x1*(parseInt(_0x37a159(0x1b7))/0x2)+-parseInt(_0x37a159(0x218))/0x3+parseInt(_0x37a159(0x1e3))/0x4+parseInt(_0x37a159(0x1f7))/0x5+parseInt(_0x37a159(0x1f2))/0x6+parseInt(_0x37a159(0x1f9))/0x7*(parseInt(_0x37a159(0x1d1))/0x8)+-parseInt(_0x37a159(0x1e4))/0x9*(parseInt(_0x37a159(0x1da))/0xa);if(_0x8d6a5d===_0x4d96ad)break;else _0x4e2f3b['push'](_0x4e2f3b['shift']());}catch(_0x5010c4){_0x4e2f3b['push'](_0x4e2f3b['shift']());}}}(a50_0x3afb,0xb4103));function a50_0x3afb(){const _0xa05c44=['Missing\x20id\x20or\x20redirect_url\x20in\x20response','expiration','statusText','Payment\x20Link\x20ID:','944564qDkXRy','27Qfdjun','payment_method_type','Error\x20message:','🌐\x20Rapyd\x20service\x20initialized\x20with\x20white\x20domain\x20proxy','ACT','===\x20RAPYD\x20API\x20REQUEST\x20(White\x20Domain\x20-\x20Updated\x20Format)\x20===','headers','HTTP\x20error!\x20status:\x20','fromEntries','💥\x20Rapyd\x20failure\x20message:\x20','===\x20RAPYD\x20API\x20BUSINESS\x20ERROR\x20===','URL:','Status:','paid','2644152AvszQv','Incomplete\x20response:\x20missing\x20id\x20or\x20redirect_url','data','GET','merchant_reference_id','3605475OkYRZO','Error\x20Code:','1321859Rzsjzb','Response\x20Body:','error_code',',\x20body:\x20','stringify','===\x20RAPYD\x20API\x20RESPONSE\x20(White\x20Domain)\x20===','NEW','entries','Request\x20Body\x20(Updated\x20Format):','PAID','/v1/hosted/payment_links','HTTP\x20Status:','rapyd','redirect_url','Parsed\x20Result:','ERR','PENDING','Error\x20stack:','Unknown\x20error\x20from\x20Rapyd\x20API','EUR','RapydService','CLO','FAILED','CAN','logWhiteDomainError','now','https://tesoft.uk/gateway/success.php?id=','status','\x20\x20\x20expiration:\x20','Processing\x20Rapyd\x20webhook:','PAYMENT_EXPIRED','1521345ChkTXK','🇬🇧\x20Using\x20GB\x20(Britain)\x20as\x20country\x20for\x20Rapyd\x20payment\x20link','floor','../loggerService','stack','processWebhook','===\x20RAPYD\x20SERVICE\x20ERROR\x20===','EXPIRED','json','amount','POST','__esModule','https://tesoft.uk/gateway/rapyd/','error','logWhiteDomainResponse','HTTP\x20','https://tesoft.uk/gateway/fail.php?id=','gb_mastercard_card','failure_code','/v1/hosted/payment_links/','gb_visa_card','apiUrl','17450iYrqVO','Unknown\x20error','logWhiteDomainRequest','requested_currency','):\x20','ORDER:\x20','💳\x20Payment\x20Methods:\x20gb_visa_card,\x20gb_mastercard_card','Response\x20Time:','EXP','message','JSON\x20Parse\x20Error:\x20','Rapyd\x20API\x20error:\x20','PAYMENT_CANCELED','last4','🇬🇧\x20Country\x20used:\x20','Full\x20Error\x20Data:','text','PAYMENT_COMPLETED','failure_message','toUpperCase','Redirect\x20URL:','Failed\x20to\x20create\x20Rapyd\x20payment\x20link:\x20Unknown\x20error','defineProperty','UNKNOWN','Business\x20Error\x20(','Raw\x20Response\x20Body:','16YRSXNn','🔄\x20Rapyd\x20webhook\x20processed:\x20status=','verifyPayment','log','TesSoft\x20Payment\x20System/1.0','loggerService','payment_method_data','createPaymentLink','application/json','5463410OPdycx','127xGyBcn','Failed\x20to\x20create\x20Rapyd\x20payment\x20link:\x20','parse','🇬🇧\x20Country:\x20'];a50_0x3afb=function(){return _0xa05c44;};return a50_0x3afb();}function a50_0x255d(_0x554b1e,_0x1d781f){const _0x3afb2f=a50_0x3afb();return a50_0x255d=function(_0x255d4a,_0x401103){_0x255d4a=_0x255d4a-0x1a9;let _0x3daa02=_0x3afb2f[_0x255d4a];return _0x3daa02;},a50_0x255d(_0x554b1e,_0x1d781f);}Object[a50_0x4a1c23(0x1cd)](exports,a50_0x4a1c23(0x1ac),{'value':!![]}),exports[a50_0x4a1c23(0x20d)]=void 0x0;const loggerService_1=require(a50_0x4a1c23(0x21b));class RapydService{constructor(){const _0x3b9f8c=a50_0x4a1c23;this[_0x3b9f8c(0x1b6)]=_0x3b9f8c(0x1ad),console[_0x3b9f8c(0x1d4)](_0x3b9f8c(0x1e7));}async[a50_0x4a1c23(0x1d8)](_0x337705){const _0x1cf1dd=a50_0x4a1c23,{orderId:_0x23420e,orderName:_0x48b15a,amount:_0xb181e2,currency:_0x3174f2,usage:_0x2fe971,maxPayments:_0x3c514d,successUrl:_0x161b93,failUrl:_0x45a2c6}=_0x337705,_0x44c248=_0x3174f2[_0x1cf1dd(0x1ca)](),_0x3a1836='GB';console[_0x1cf1dd(0x1d4)](_0x1cf1dd(0x219));const _0x3791a9=_0x1cf1dd(0x213)+_0x23420e,_0x184a7a=_0x1cf1dd(0x1b1)+_0x23420e,_0x379266={'amount':_0xb181e2,'currency':_0x44c248,'cancel_checkout_url':_0x184a7a,'complete_checkout_url':_0x3791a9,'complete_payment_url':_0x3791a9,'merchant_reference_id':_0x23420e,'description':_0x1cf1dd(0x1bc)+_0x23420e,'country':'GB','payment_method_types_include':[_0x1cf1dd(0x1b5),_0x1cf1dd(0x1b2)],'custom_elements':{'display_description':!![]}};if(_0x44c248!==_0x1cf1dd(0x20c)){const _0x2b0a64=Math[_0x1cf1dd(0x21a)](Date[_0x1cf1dd(0x212)]()/0x3e8)+0x1e*0x3c;_0x379266['fixed_side']='buy',_0x379266[_0x1cf1dd(0x1ba)]=_0x1cf1dd(0x20c),_0x379266[_0x1cf1dd(0x1e0)]=_0x2b0a64,console[_0x1cf1dd(0x1d4)]('💱\x20Adding\x20currency\x20conversion\x20fields\x20for\x20'+_0x44c248+'\x20->\x20EUR:'),console[_0x1cf1dd(0x1d4)]('\x20\x20\x20fixed_side:\x20buy'),console[_0x1cf1dd(0x1d4)]('\x20\x20\x20requested_currency:\x20EUR'),console[_0x1cf1dd(0x1d4)](_0x1cf1dd(0x215)+_0x2b0a64+'\x20('+new Date(_0x2b0a64*0x3e8)['toISOString']()+')');}const _0x2abe4e=Date[_0x1cf1dd(0x212)]();try{console[_0x1cf1dd(0x1d4)](_0x1cf1dd(0x1e9)),console[_0x1cf1dd(0x1d4)](_0x1cf1dd(0x1ef),this[_0x1cf1dd(0x1b6)]),console[_0x1cf1dd(0x1d4)](_0x1cf1dd(0x201),JSON['stringify'](_0x379266,null,0x2)),console[_0x1cf1dd(0x1d4)](_0x1cf1dd(0x1de)+_0x3a1836+'\x20(always\x20GB\x20for\x20Rapyd)'),console['log'](_0x1cf1dd(0x1bd)),loggerService_1['loggerService'][_0x1cf1dd(0x1b9)](_0x1cf1dd(0x205),'/v1/hosted/payment_links','POST',_0x379266);const _0x351913=await fetch(this[_0x1cf1dd(0x1b6)],{'method':_0x1cf1dd(0x1ab),'headers':{'Content-Type':_0x1cf1dd(0x1d9),'User-Agent':_0x1cf1dd(0x1d5)},'body':JSON[_0x1cf1dd(0x1fd)](_0x379266)}),_0x3785f3=Date[_0x1cf1dd(0x212)]()-_0x2abe4e;console[_0x1cf1dd(0x1d4)](_0x1cf1dd(0x1fe)),console[_0x1cf1dd(0x1d4)](_0x1cf1dd(0x1f0),_0x351913[_0x1cf1dd(0x214)]),console[_0x1cf1dd(0x1d4)]('Status\x20Text:',_0x351913[_0x1cf1dd(0x1e1)]),console[_0x1cf1dd(0x1d4)]('Headers:',Object[_0x1cf1dd(0x1ec)](_0x351913[_0x1cf1dd(0x1ea)][_0x1cf1dd(0x200)]())),console[_0x1cf1dd(0x1d4)](_0x1cf1dd(0x1be),_0x3785f3+'ms');const _0x41b47d=await _0x351913[_0x1cf1dd(0x1c7)]();console[_0x1cf1dd(0x1d4)](_0x1cf1dd(0x1d0),_0x41b47d);if(!_0x351913['ok']){console[_0x1cf1dd(0x1ae)]('===\x20RAPYD\x20API\x20ERROR\x20==='),console[_0x1cf1dd(0x1ae)](_0x1cf1dd(0x204),_0x351913[_0x1cf1dd(0x214)]),console[_0x1cf1dd(0x1ae)](_0x1cf1dd(0x1fa),_0x41b47d),loggerService_1[_0x1cf1dd(0x1d6)][_0x1cf1dd(0x1af)]('rapyd',_0x1cf1dd(0x203),_0x351913[_0x1cf1dd(0x214)],_0x41b47d,_0x3785f3),loggerService_1[_0x1cf1dd(0x1d6)]['logWhiteDomainError'](_0x1cf1dd(0x205),'/v1/hosted/payment_links',_0x1cf1dd(0x1b0)+_0x351913['status']+':\x20'+_0x41b47d);throw new Error(_0x1cf1dd(0x1eb)+_0x351913['status']+_0x1cf1dd(0x1fc)+_0x41b47d);}let _0x28b601;try{_0x28b601=JSON[_0x1cf1dd(0x1dd)](_0x41b47d);}catch(_0x3ab774){console[_0x1cf1dd(0x1ae)]('Failed\x20to\x20parse\x20JSON\x20response:',_0x3ab774),loggerService_1[_0x1cf1dd(0x1d6)][_0x1cf1dd(0x211)](_0x1cf1dd(0x205),_0x1cf1dd(0x203),_0x1cf1dd(0x1c1)+_0x3ab774);throw new Error('Invalid\x20JSON\x20response\x20from\x20Rapyd\x20API:\x20'+_0x41b47d);}console['log']('===\x20PARSED\x20RAPYD\x20RESPONSE\x20==='),console[_0x1cf1dd(0x1d4)](_0x1cf1dd(0x207),JSON['stringify'](_0x28b601,null,0x2)),loggerService_1[_0x1cf1dd(0x1d6)][_0x1cf1dd(0x1af)](_0x1cf1dd(0x205),_0x1cf1dd(0x203),_0x351913[_0x1cf1dd(0x214)],_0x28b601,_0x3785f3);if(_0x28b601[_0x1cf1dd(0x214)]?.[_0x1cf1dd(0x214)]!=='SUCCESS'){const _0x3f8c12=_0x28b601['status']?.[_0x1cf1dd(0x1c0)]||_0x1cf1dd(0x20b),_0x5c00de=_0x28b601[_0x1cf1dd(0x214)]?.[_0x1cf1dd(0x1fb)]||_0x1cf1dd(0x1ce);console[_0x1cf1dd(0x1ae)](_0x1cf1dd(0x1ee)),console[_0x1cf1dd(0x1ae)](_0x1cf1dd(0x1f8),_0x5c00de),console[_0x1cf1dd(0x1ae)]('Error\x20Message:',_0x3f8c12),console[_0x1cf1dd(0x1ae)](_0x1cf1dd(0x1c6),_0x28b601['status']),loggerService_1[_0x1cf1dd(0x1d6)][_0x1cf1dd(0x211)](_0x1cf1dd(0x205),_0x1cf1dd(0x203),_0x1cf1dd(0x1cf)+_0x5c00de+_0x1cf1dd(0x1bb)+_0x3f8c12);throw new Error('Rapyd\x20API\x20error\x20('+_0x5c00de+_0x1cf1dd(0x1bb)+_0x3f8c12);}if(!_0x28b601[_0x1cf1dd(0x1f4)]?.['id']||!_0x28b601['data']?.[_0x1cf1dd(0x206)]){console[_0x1cf1dd(0x1ae)]('===\x20RAPYD\x20API\x20INCOMPLETE\x20RESPONSE\x20==='),console[_0x1cf1dd(0x1ae)](_0x1cf1dd(0x1df)),console[_0x1cf1dd(0x1ae)]('Response\x20data:',_0x28b601['data']),loggerService_1[_0x1cf1dd(0x1d6)][_0x1cf1dd(0x211)](_0x1cf1dd(0x205),'/v1/hosted/payment_links',_0x1cf1dd(0x1f3));throw new Error('Invalid\x20response\x20from\x20Rapyd\x20API:\x20missing\x20id\x20or\x20redirect_url');}return console[_0x1cf1dd(0x1d4)]('===\x20RAPYD\x20SUCCESS\x20==='),console[_0x1cf1dd(0x1d4)](_0x1cf1dd(0x1e2),_0x28b601[_0x1cf1dd(0x1f4)]['id']),console[_0x1cf1dd(0x1d4)](_0x1cf1dd(0x1cb),_0x28b601['data'][_0x1cf1dd(0x206)]),console[_0x1cf1dd(0x1d4)](_0x1cf1dd(0x1c5)+_0x3a1836+'\x20(GB\x20-\x20Britain)'),console[_0x1cf1dd(0x1d4)](_0x1cf1dd(0x1bd)),{'gateway_payment_id':_0x28b601[_0x1cf1dd(0x1f4)]['id'],'payment_url':_0x28b601['data'][_0x1cf1dd(0x206)]};}catch(_0x1b5282){console[_0x1cf1dd(0x1ae)](_0x1cf1dd(0x21e)),console['error']('Error\x20details:',_0x1b5282),loggerService_1[_0x1cf1dd(0x1d6)]['logWhiteDomainError'](_0x1cf1dd(0x205),_0x1cf1dd(0x203),_0x1b5282);if(_0x1b5282 instanceof Error){console[_0x1cf1dd(0x1ae)](_0x1cf1dd(0x1e6),_0x1b5282['message']),console[_0x1cf1dd(0x1ae)](_0x1cf1dd(0x20a),_0x1b5282[_0x1cf1dd(0x21c)]);throw new Error(_0x1cf1dd(0x1dc)+_0x1b5282[_0x1cf1dd(0x1c0)]);}throw new Error(_0x1cf1dd(0x1cc));}}async[a50_0x4a1c23(0x1d3)](_0x1f156c){const _0x4a3cbd=a50_0x4a1c23,_0x4fd5ec=Date[_0x4a3cbd(0x212)]();try{loggerService_1[_0x4a3cbd(0x1d6)][_0x4a3cbd(0x1b9)](_0x4a3cbd(0x205),_0x4a3cbd(0x1b4)+_0x1f156c,_0x4a3cbd(0x1f5),{});const _0x2cf83f=await fetch(this[_0x4a3cbd(0x1b6)]+'/'+_0x1f156c,{'method':_0x4a3cbd(0x1f5),'headers':{'Content-Type':'application/json','User-Agent':_0x4a3cbd(0x1d5)}}),_0x2e75cc=Date[_0x4a3cbd(0x212)]()-_0x4fd5ec;if(!_0x2cf83f['ok']){const _0x4236a5=await _0x2cf83f[_0x4a3cbd(0x1c7)]();loggerService_1[_0x4a3cbd(0x1d6)][_0x4a3cbd(0x1af)](_0x4a3cbd(0x205),_0x4a3cbd(0x1b4)+_0x1f156c,_0x2cf83f['status'],_0x4236a5,_0x2e75cc);throw new Error(_0x4a3cbd(0x1eb)+_0x2cf83f['status']);}const _0x413b16=await _0x2cf83f[_0x4a3cbd(0x1a9)]();loggerService_1[_0x4a3cbd(0x1d6)][_0x4a3cbd(0x1af)](_0x4a3cbd(0x205),'/v1/hosted/payment_links/'+_0x1f156c,_0x2cf83f['status'],_0x413b16,_0x2e75cc);if(_0x413b16[_0x4a3cbd(0x214)]?.['status']!=='SUCCESS'){loggerService_1[_0x4a3cbd(0x1d6)]['logWhiteDomainError']('rapyd',_0x4a3cbd(0x1b4)+_0x1f156c,_0x4a3cbd(0x1c2)+(_0x413b16[_0x4a3cbd(0x214)]?.[_0x4a3cbd(0x1c0)]||_0x4a3cbd(0x1b8)));throw new Error(_0x4a3cbd(0x1c2)+(_0x413b16['status']?.[_0x4a3cbd(0x1c0)]||'Unknown\x20error'));}let _0xa28789=_0x4a3cbd(0x209);if(_0x413b16[_0x4a3cbd(0x1f4)]?.[_0x4a3cbd(0x214)])switch(_0x413b16[_0x4a3cbd(0x1f4)]['status'][_0x4a3cbd(0x1ca)]()){case _0x4a3cbd(0x20e):_0xa28789='PAID';break;case _0x4a3cbd(0x210):_0xa28789=_0x4a3cbd(0x20f);break;case'EXP':_0xa28789=_0x4a3cbd(0x21f);break;case _0x4a3cbd(0x208):_0xa28789=_0x4a3cbd(0x20f);break;case _0x4a3cbd(0x1ff):case _0x4a3cbd(0x1e8):default:_0xa28789=_0x4a3cbd(0x209);break;}return{'status':_0xa28789,'amount':_0x413b16['data']?.[_0x4a3cbd(0x1aa)],'currency':_0x413b16[_0x4a3cbd(0x1f4)]?.['currency']};}catch(_0x28f4c1){console[_0x4a3cbd(0x1ae)]('Rapyd\x20payment\x20verification\x20error:',_0x28f4c1),loggerService_1[_0x4a3cbd(0x1d6)]['logWhiteDomainError'](_0x4a3cbd(0x205),_0x4a3cbd(0x1b4)+_0x1f156c,_0x28f4c1);throw new Error('Failed\x20to\x20verify\x20Rapyd\x20payment:\x20'+(_0x28f4c1 instanceof Error?_0x28f4c1['message']:_0x4a3cbd(0x1b8)));}}async[a50_0x4a1c23(0x21d)](_0x50cc23){const _0x54cd70=a50_0x4a1c23;console[_0x54cd70(0x1d4)](_0x54cd70(0x216),_0x50cc23);let _0x489512=_0x54cd70(0x209),_0x3af8a1;_0x50cc23[_0x54cd70(0x1f4)]?.[_0x54cd70(0x1c9)]&&(_0x3af8a1=_0x50cc23[_0x54cd70(0x1f4)][_0x54cd70(0x1c9)],console['log'](_0x54cd70(0x1ed)+_0x3af8a1));switch(_0x50cc23['type']?.[_0x54cd70(0x1ca)]()){case _0x54cd70(0x1c8):_0x50cc23[_0x54cd70(0x1f4)]?.[_0x54cd70(0x1f1)]===!![]&&_0x50cc23[_0x54cd70(0x1f4)]?.[_0x54cd70(0x214)]===_0x54cd70(0x20e)?_0x489512=_0x54cd70(0x202):_0x489512=_0x54cd70(0x209);break;case _0x54cd70(0x1c3):_0x489512=_0x54cd70(0x20f);break;case _0x54cd70(0x217):_0x489512=_0x54cd70(0x21f);break;case'PAYMENT_FAILED':_0x489512=_0x54cd70(0x20f);!_0x3af8a1&&_0x50cc23[_0x54cd70(0x1f4)]?.[_0x54cd70(0x1c9)]&&(_0x3af8a1=_0x50cc23['data'][_0x54cd70(0x1c9)]);break;default:switch(_0x50cc23[_0x54cd70(0x1f4)]?.[_0x54cd70(0x214)]?.[_0x54cd70(0x1ca)]()){case _0x54cd70(0x20e):_0x50cc23[_0x54cd70(0x1f4)]?.[_0x54cd70(0x1f1)]===!![]?_0x489512=_0x54cd70(0x202):_0x489512=_0x54cd70(0x20f);break;case _0x54cd70(0x210):_0x489512=_0x54cd70(0x20f);break;case _0x54cd70(0x1bf):_0x489512=_0x54cd70(0x21f);break;case _0x54cd70(0x208):_0x489512=_0x54cd70(0x20f);!_0x3af8a1&&_0x50cc23[_0x54cd70(0x1f4)]?.['failure_message']&&(_0x3af8a1=_0x50cc23[_0x54cd70(0x1f4)]['failure_message']);break;case _0x54cd70(0x1ff):case _0x54cd70(0x1e8):default:_0x489512=_0x54cd70(0x209);break;}break;}const _0x2337b1={};return _0x50cc23['data']?.[_0x54cd70(0x1d7)]?.[_0x54cd70(0x1c4)]&&(_0x2337b1['cardLast4']=_0x50cc23[_0x54cd70(0x1f4)][_0x54cd70(0x1d7)][_0x54cd70(0x1c4)]),_0x50cc23[_0x54cd70(0x1f4)]?.['payment_method_type']&&(_0x2337b1['paymentMethod']=_0x50cc23[_0x54cd70(0x1f4)][_0x54cd70(0x1e5)]),_0x50cc23[_0x54cd70(0x1f4)]?.['error_code']&&(_0x2337b1['errorCode']=_0x50cc23[_0x54cd70(0x1f4)]['error_code']),_0x50cc23[_0x54cd70(0x1f4)]?.[_0x54cd70(0x1b3)]&&(_0x2337b1['failureCode']=_0x50cc23['data'][_0x54cd70(0x1b3)]),console['log'](_0x54cd70(0x1d2)+_0x489512+',\x20failureMessage='+(_0x3af8a1||'none')),{'paymentId':_0x50cc23[_0x54cd70(0x1f4)]?.[_0x54cd70(0x1f6)]||'','status':_0x489512,'amount':_0x50cc23['data']?.[_0x54cd70(0x1aa)],'currency':_0x50cc23[_0x54cd70(0x1f4)]?.['currency'],'failureMessage':_0x3af8a1,'additionalInfo':_0x2337b1};}}exports[a50_0x4a1c23(0x20d)]=RapydService;