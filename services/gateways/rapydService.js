'use strict';function a42_0x4270(){const _0xcfe9fd=['stringify','error_code','\x20(GB\x20-\x20Britain)','923956iMdixs','payment_method_data','74794FnTOKL','data','failure_code','Failed\x20to\x20create\x20Rapyd\x20payment\x20link:\x20Unknown\x20error','toUpperCase','Status:','CLO','üåê\x20Rapyd\x20service\x20initialized\x20with\x20white\x20domain\x20proxy','===\x20RAPYD\x20API\x20ERROR\x20===','üîÑ\x20Rapyd\x20webhook\x20processed:\x20status=','paid','ERR','üí≥\x20Payment\x20Methods:\x20gb_visa_card,\x20gb_mastercard_card',',\x20body:\x20','Error\x20details:','HTTP\x20error!\x20status:\x20','loggerService','31eXKyKJ','URL:','ACT','Processing\x20Rapyd\x20webhook:','8335JNOCFs','Incomplete\x20response:\x20missing\x20id\x20or\x20redirect_url','https://tesoft.uk/gateway/rapyd/','PAID','defineProperty','redirect_url','currency','application/json',',\x20failureMessage=','Error\x20Message:','fromEntries','Unknown\x20error','===\x20PARSED\x20RAPYD\x20RESPONSE\x20===','Response\x20Body:','5558904BmtFnE','entries','merchant_reference_id','https://tesoft.uk/gateway/fail.php?id=','ORDER:\x20','logWhiteDomainRequest','/v1/hosted/payment_links','===\x20RAPYD\x20SERVICE\x20ERROR\x20===','UNKNOWN','logWhiteDomainError','Invalid\x20response\x20from\x20Rapyd\x20API:\x20missing\x20id\x20or\x20redirect_url','Failed\x20to\x20create\x20Rapyd\x20payment\x20link:\x20','last4','log','Rapyd\x20payment\x20verification\x20error:','../loggerService','===\x20RAPYD\x20SUCCESS\x20===','Rapyd\x20API\x20error\x20(','Error\x20stack:','Response\x20Time:','text','===\x20RAPYD\x20API\x20RESPONSE\x20(White\x20Domain)\x20===','createPaymentLink','apiUrl','===\x20RAPYD\x20API\x20INCOMPLETE\x20RESPONSE\x20===','===\x20RAPYD\x20API\x20REQUEST\x20(White\x20Domain\x20-\x20Updated\x20Format)\x20===','TesSoft\x20Payment\x20System/1.0','errorCode','Missing\x20id\x20or\x20redirect_url\x20in\x20response','üá¨üáß\x20Using\x20GB\x20(Britain)\x20as\x20country\x20for\x20Rapyd\x20payment\x20link','üí•\x20Rapyd\x20failure\x20message:\x20','logWhiteDomainResponse','failure_message','5099853eyutbB','NEW','924MICvNX','937405KRmfvE','Invalid\x20JSON\x20response\x20from\x20Rapyd\x20API:\x20','SUCCESS','===\x20RAPYD\x20API\x20BUSINESS\x20ERROR\x20===','failureCode','RapydService','gb_visa_card','JSON\x20Parse\x20Error:\x20','EXP','8oiZEjW','amount','Business\x20Error\x20(','paymentMethod','EXPIRED','parse','HTTP\x20','verifyPayment','cardLast4','error','__esModule','headers','Response\x20data:','12OxDvNh','Failed\x20to\x20verify\x20Rapyd\x20payment:\x20','\x20(always\x20GB\x20for\x20Rapyd)','Redirect\x20URL:','status','PENDING','/v1/hosted/payment_links/','rapyd','CAN','FAILED','):\x20','now','Rapyd\x20API\x20error:\x20','processWebhook','payment_method_type','2914390ZWaTaS','Error\x20message:','12IbiBcx','message'];a42_0x4270=function(){return _0xcfe9fd;};return a42_0x4270();}const a42_0x71aa68=a42_0x5d64;function a42_0x5d64(_0x4f3298,_0x344023){const _0x4270ec=a42_0x4270();return a42_0x5d64=function(_0x5d64da,_0x3a4f1c){_0x5d64da=_0x5d64da-0xb7;let _0x5d8210=_0x4270ec[_0x5d64da];return _0x5d8210;},a42_0x5d64(_0x4f3298,_0x344023);}(function(_0x26aac6,_0xb298){const _0x41aae7=a42_0x5d64,_0x25e6d1=_0x26aac6();while(!![]){try{const _0x33b994=-parseInt(_0x41aae7(0x105))/0x1*(parseInt(_0x41aae7(0xf4))/0x2)+parseInt(_0x41aae7(0xdc))/0x3*(parseInt(_0x41aae7(0xf2))/0x4)+-parseInt(_0x41aae7(0x109))/0x5*(-parseInt(_0x41aae7(0xc5))/0x6)+parseInt(_0x41aae7(0xc6))/0x7*(-parseInt(_0x41aae7(0xcf))/0x8)+parseInt(_0x41aae7(0x117))/0x9+-parseInt(_0x41aae7(0xeb))/0xa+parseInt(_0x41aae7(0xc3))/0xb*(parseInt(_0x41aae7(0xed))/0xc);if(_0x33b994===_0xb298)break;else _0x25e6d1['push'](_0x25e6d1['shift']());}catch(_0x3e9118){_0x25e6d1['push'](_0x25e6d1['shift']());}}}(a42_0x4270,0xa55ac));Object[a42_0x71aa68(0x10d)](exports,a42_0x71aa68(0xd9),{'value':!![]}),exports[a42_0x71aa68(0xcb)]=void 0x0;const loggerService_1=require(a42_0x71aa68(0x126));class RapydService{constructor(){const _0x3b0444=a42_0x71aa68;this['apiUrl']=_0x3b0444(0x10b),console['log'](_0x3b0444(0xfb));}async[a42_0x71aa68(0xb8)](_0x415309){const _0x46a817=a42_0x71aa68,{orderId:_0x5efc2a,orderName:_0x13d1ba,amount:_0x2a362b,currency:_0x49e5d,usage:_0x704a25,maxPayments:_0x13fe13,successUrl:_0x18ce00,failUrl:_0x1d4859}=_0x415309,_0x56f2f0=_0x49e5d[_0x46a817(0xf8)](),_0x23d28c='GB';console[_0x46a817(0x124)](_0x46a817(0xbf));const _0x594673='https://tesoft.uk/gateway/success.php?id='+_0x5efc2a,_0x46c502=_0x46a817(0x11a)+_0x5efc2a,_0x430692={'amount':_0x2a362b,'currency':_0x56f2f0,'cancel_checkout_url':_0x46c502,'complete_checkout_url':_0x594673,'complete_payment_url':_0x594673,'merchant_reference_id':_0x5efc2a,'description':_0x46a817(0x11b)+_0x5efc2a,'country':'GB','payment_method_types_include':[_0x46a817(0xcc),'gb_mastercard_card'],'custom_elements':{'display_description':!![]}},_0x303f46=Date['now']();try{console['log'](_0x46a817(0xbb)),console['log'](_0x46a817(0x106),this['apiUrl']),console[_0x46a817(0x124)]('Request\x20Body\x20(Updated\x20Format):',JSON[_0x46a817(0xef)](_0x430692,null,0x2)),console[_0x46a817(0x124)]('üá¨üáß\x20Country:\x20'+_0x23d28c+_0x46a817(0xde)),console[_0x46a817(0x124)](_0x46a817(0x100)),loggerService_1[_0x46a817(0x104)]['logWhiteDomainRequest'](_0x46a817(0xe3),_0x46a817(0x11d),'POST',_0x430692);const _0x11d29b=await fetch(this[_0x46a817(0xb9)],{'method':'POST','headers':{'Content-Type':_0x46a817(0x110),'User-Agent':_0x46a817(0xbc)},'body':JSON[_0x46a817(0xef)](_0x430692)}),_0x1148f3=Date['now']()-_0x303f46;console[_0x46a817(0x124)](_0x46a817(0xb7)),console[_0x46a817(0x124)](_0x46a817(0xf9),_0x11d29b[_0x46a817(0xe0)]),console[_0x46a817(0x124)]('Status\x20Text:',_0x11d29b['statusText']),console[_0x46a817(0x124)]('Headers:',Object[_0x46a817(0x113)](_0x11d29b[_0x46a817(0xda)][_0x46a817(0x118)]())),console['log'](_0x46a817(0x12a),_0x1148f3+'ms');const _0x4589a2=await _0x11d29b['text']();console[_0x46a817(0x124)]('Raw\x20Response\x20Body:',_0x4589a2);if(!_0x11d29b['ok']){console[_0x46a817(0xd8)](_0x46a817(0xfc)),console['error']('HTTP\x20Status:',_0x11d29b[_0x46a817(0xe0)]),console[_0x46a817(0xd8)](_0x46a817(0x116),_0x4589a2),loggerService_1['loggerService'][_0x46a817(0xc1)](_0x46a817(0xe3),'/v1/hosted/payment_links',_0x11d29b[_0x46a817(0xe0)],_0x4589a2,_0x1148f3),loggerService_1[_0x46a817(0x104)][_0x46a817(0x120)](_0x46a817(0xe3),_0x46a817(0x11d),_0x46a817(0xd5)+_0x11d29b[_0x46a817(0xe0)]+':\x20'+_0x4589a2);throw new Error(_0x46a817(0x103)+_0x11d29b[_0x46a817(0xe0)]+_0x46a817(0x101)+_0x4589a2);}let _0x53542c;try{_0x53542c=JSON[_0x46a817(0xd4)](_0x4589a2);}catch(_0x37dcb6){console[_0x46a817(0xd8)]('Failed\x20to\x20parse\x20JSON\x20response:',_0x37dcb6),loggerService_1['loggerService'][_0x46a817(0x120)](_0x46a817(0xe3),_0x46a817(0x11d),_0x46a817(0xcd)+_0x37dcb6);throw new Error(_0x46a817(0xc7)+_0x4589a2);}console[_0x46a817(0x124)](_0x46a817(0x115)),console['log']('Parsed\x20Result:',JSON['stringify'](_0x53542c,null,0x2)),loggerService_1[_0x46a817(0x104)][_0x46a817(0xc1)](_0x46a817(0xe3),_0x46a817(0x11d),_0x11d29b['status'],_0x53542c,_0x1148f3);if(_0x53542c[_0x46a817(0xe0)]?.['status']!==_0x46a817(0xc8)){const _0x562e89=_0x53542c[_0x46a817(0xe0)]?.[_0x46a817(0xee)]||'Unknown\x20error\x20from\x20Rapyd\x20API',_0x2238b9=_0x53542c[_0x46a817(0xe0)]?.[_0x46a817(0xf0)]||_0x46a817(0x11f);console[_0x46a817(0xd8)](_0x46a817(0xc9)),console[_0x46a817(0xd8)]('Error\x20Code:',_0x2238b9),console[_0x46a817(0xd8)](_0x46a817(0x112),_0x562e89),console[_0x46a817(0xd8)]('Full\x20Error\x20Data:',_0x53542c[_0x46a817(0xe0)]),loggerService_1[_0x46a817(0x104)][_0x46a817(0x120)]('rapyd','/v1/hosted/payment_links',_0x46a817(0xd1)+_0x2238b9+_0x46a817(0xe6)+_0x562e89);throw new Error(_0x46a817(0x128)+_0x2238b9+'):\x20'+_0x562e89);}if(!_0x53542c[_0x46a817(0xf5)]?.['id']||!_0x53542c[_0x46a817(0xf5)]?.['redirect_url']){console['error'](_0x46a817(0xba)),console[_0x46a817(0xd8)](_0x46a817(0xbe)),console['error'](_0x46a817(0xdb),_0x53542c[_0x46a817(0xf5)]),loggerService_1[_0x46a817(0x104)][_0x46a817(0x120)](_0x46a817(0xe3),_0x46a817(0x11d),_0x46a817(0x10a));throw new Error(_0x46a817(0x121));}return console['log'](_0x46a817(0x127)),console[_0x46a817(0x124)]('Payment\x20Link\x20ID:',_0x53542c[_0x46a817(0xf5)]['id']),console[_0x46a817(0x124)](_0x46a817(0xdf),_0x53542c[_0x46a817(0xf5)][_0x46a817(0x10e)]),console[_0x46a817(0x124)]('üá¨üáß\x20Country\x20used:\x20'+_0x23d28c+_0x46a817(0xf1)),console[_0x46a817(0x124)](_0x46a817(0x100)),{'gateway_payment_id':_0x53542c[_0x46a817(0xf5)]['id'],'payment_url':_0x53542c[_0x46a817(0xf5)][_0x46a817(0x10e)]};}catch(_0x175440){console['error'](_0x46a817(0x11e)),console[_0x46a817(0xd8)](_0x46a817(0x102),_0x175440),loggerService_1[_0x46a817(0x104)][_0x46a817(0x120)](_0x46a817(0xe3),_0x46a817(0x11d),_0x175440);if(_0x175440 instanceof Error){console[_0x46a817(0xd8)](_0x46a817(0xec),_0x175440[_0x46a817(0xee)]),console['error'](_0x46a817(0x129),_0x175440['stack']);throw new Error(_0x46a817(0x122)+_0x175440[_0x46a817(0xee)]);}throw new Error(_0x46a817(0xf7));}}async[a42_0x71aa68(0xd6)](_0x1fec9f){const _0x4b53d9=a42_0x71aa68,_0x33290c=Date[_0x4b53d9(0xe7)]();try{loggerService_1[_0x4b53d9(0x104)][_0x4b53d9(0x11c)]('rapyd',_0x4b53d9(0xe2)+_0x1fec9f,'GET',{});const _0x2d6e87=await fetch(this['apiUrl']+'/'+_0x1fec9f,{'method':'GET','headers':{'Content-Type':_0x4b53d9(0x110),'User-Agent':_0x4b53d9(0xbc)}}),_0x46c03a=Date[_0x4b53d9(0xe7)]()-_0x33290c;if(!_0x2d6e87['ok']){const _0xe2e4aa=await _0x2d6e87[_0x4b53d9(0x12b)]();loggerService_1['loggerService'][_0x4b53d9(0xc1)](_0x4b53d9(0xe3),_0x4b53d9(0xe2)+_0x1fec9f,_0x2d6e87[_0x4b53d9(0xe0)],_0xe2e4aa,_0x46c03a);throw new Error(_0x4b53d9(0x103)+_0x2d6e87[_0x4b53d9(0xe0)]);}const _0x8dd2be=await _0x2d6e87['json']();loggerService_1['loggerService'][_0x4b53d9(0xc1)](_0x4b53d9(0xe3),_0x4b53d9(0xe2)+_0x1fec9f,_0x2d6e87[_0x4b53d9(0xe0)],_0x8dd2be,_0x46c03a);if(_0x8dd2be[_0x4b53d9(0xe0)]?.[_0x4b53d9(0xe0)]!==_0x4b53d9(0xc8)){loggerService_1[_0x4b53d9(0x104)]['logWhiteDomainError'](_0x4b53d9(0xe3),_0x4b53d9(0xe2)+_0x1fec9f,_0x4b53d9(0xe8)+(_0x8dd2be[_0x4b53d9(0xe0)]?.[_0x4b53d9(0xee)]||'Unknown\x20error'));throw new Error('Rapyd\x20API\x20error:\x20'+(_0x8dd2be[_0x4b53d9(0xe0)]?.[_0x4b53d9(0xee)]||_0x4b53d9(0x114)));}let _0x266335='PENDING';if(_0x8dd2be['data']?.[_0x4b53d9(0xe0)])switch(_0x8dd2be['data'][_0x4b53d9(0xe0)][_0x4b53d9(0xf8)]()){case _0x4b53d9(0xfa):_0x266335='PAID';break;case _0x4b53d9(0xe4):_0x266335=_0x4b53d9(0xe5);break;case'EXP':_0x266335=_0x4b53d9(0xd3);break;case _0x4b53d9(0xff):_0x266335='FAILED';break;case _0x4b53d9(0xc4):case _0x4b53d9(0x107):default:_0x266335=_0x4b53d9(0xe1);break;}return{'status':_0x266335,'amount':_0x8dd2be[_0x4b53d9(0xf5)]?.[_0x4b53d9(0xd0)],'currency':_0x8dd2be[_0x4b53d9(0xf5)]?.[_0x4b53d9(0x10f)]};}catch(_0xea2172){console[_0x4b53d9(0xd8)](_0x4b53d9(0x125),_0xea2172),loggerService_1[_0x4b53d9(0x104)]['logWhiteDomainError'](_0x4b53d9(0xe3),_0x4b53d9(0xe2)+_0x1fec9f,_0xea2172);throw new Error(_0x4b53d9(0xdd)+(_0xea2172 instanceof Error?_0xea2172['message']:_0x4b53d9(0x114)));}}async[a42_0x71aa68(0xe9)](_0x203618){const _0x1d33db=a42_0x71aa68;console[_0x1d33db(0x124)](_0x1d33db(0x108),_0x203618);let _0x53a4f1=_0x1d33db(0xe1),_0x159e02;_0x203618[_0x1d33db(0xf5)]?.[_0x1d33db(0xc2)]&&(_0x159e02=_0x203618[_0x1d33db(0xf5)][_0x1d33db(0xc2)],console[_0x1d33db(0x124)](_0x1d33db(0xc0)+_0x159e02));switch(_0x203618['type']?.['toUpperCase']()){case'PAYMENT_COMPLETED':_0x203618[_0x1d33db(0xf5)]?.[_0x1d33db(0xfe)]===!![]&&_0x203618[_0x1d33db(0xf5)]?.[_0x1d33db(0xe0)]===_0x1d33db(0xfa)?_0x53a4f1=_0x1d33db(0x10c):_0x53a4f1='PENDING';break;case'PAYMENT_CANCELED':_0x53a4f1=_0x1d33db(0xe5);break;case'PAYMENT_EXPIRED':_0x53a4f1='EXPIRED';break;case'PAYMENT_FAILED':_0x53a4f1=_0x1d33db(0xe5);!_0x159e02&&_0x203618[_0x1d33db(0xf5)]?.[_0x1d33db(0xc2)]&&(_0x159e02=_0x203618[_0x1d33db(0xf5)]['failure_message']);break;default:switch(_0x203618[_0x1d33db(0xf5)]?.[_0x1d33db(0xe0)]?.['toUpperCase']()){case _0x1d33db(0xfa):_0x203618['data']?.[_0x1d33db(0xfe)]===!![]?_0x53a4f1='PAID':_0x53a4f1=_0x1d33db(0xe5);break;case _0x1d33db(0xe4):_0x53a4f1=_0x1d33db(0xe5);break;case _0x1d33db(0xce):_0x53a4f1=_0x1d33db(0xd3);break;case _0x1d33db(0xff):_0x53a4f1='FAILED';!_0x159e02&&_0x203618['data']?.[_0x1d33db(0xc2)]&&(_0x159e02=_0x203618['data'][_0x1d33db(0xc2)]);break;case _0x1d33db(0xc4):case'ACT':default:_0x53a4f1=_0x1d33db(0xe1);break;}break;}const _0x2832f5={};return _0x203618[_0x1d33db(0xf5)]?.[_0x1d33db(0xf3)]?.[_0x1d33db(0x123)]&&(_0x2832f5[_0x1d33db(0xd7)]=_0x203618['data'][_0x1d33db(0xf3)]['last4']),_0x203618[_0x1d33db(0xf5)]?.[_0x1d33db(0xea)]&&(_0x2832f5[_0x1d33db(0xd2)]=_0x203618[_0x1d33db(0xf5)]['payment_method_type']),_0x203618[_0x1d33db(0xf5)]?.[_0x1d33db(0xf0)]&&(_0x2832f5[_0x1d33db(0xbd)]=_0x203618[_0x1d33db(0xf5)]['error_code']),_0x203618[_0x1d33db(0xf5)]?.[_0x1d33db(0xf6)]&&(_0x2832f5[_0x1d33db(0xca)]=_0x203618[_0x1d33db(0xf5)][_0x1d33db(0xf6)]),console['log'](_0x1d33db(0xfd)+_0x53a4f1+_0x1d33db(0x111)+(_0x159e02||'none')),{'paymentId':_0x203618[_0x1d33db(0xf5)]?.[_0x1d33db(0x119)]||'','status':_0x53a4f1,'amount':_0x203618[_0x1d33db(0xf5)]?.[_0x1d33db(0xd0)],'currency':_0x203618[_0x1d33db(0xf5)]?.[_0x1d33db(0x10f)],'failureMessage':_0x159e02,'additionalInfo':_0x2832f5};}}exports['RapydService']=RapydService;