'use strict';const a48_0x44a6ae=a48_0x5a3a;function a48_0x5a3a(_0x2355cf,_0x58af85){const _0x45f865=a48_0x45f8();return a48_0x5a3a=function(_0x5a3a9f,_0x162416){_0x5a3a9f=_0x5a3a9f-0x108;let _0x172832=_0x45f865[_0x5a3a9f];return _0x172832;},a48_0x5a3a(_0x2355cf,_0x58af85);}(function(_0x31a9f2,_0x22667a){const _0x593597=a48_0x5a3a,_0x568267=_0x31a9f2();while(!![]){try{const _0x5c91f8=parseInt(_0x593597(0x108))/0x1+parseInt(_0x593597(0x164))/0x2*(-parseInt(_0x593597(0x151))/0x3)+-parseInt(_0x593597(0x170))/0x4*(-parseInt(_0x593597(0x185))/0x5)+parseInt(_0x593597(0x124))/0x6+parseInt(_0x593597(0x111))/0x7+-parseInt(_0x593597(0x141))/0x8*(-parseInt(_0x593597(0x15f))/0x9)+-parseInt(_0x593597(0x127))/0xa*(parseInt(_0x593597(0x137))/0xb);if(_0x5c91f8===_0x22667a)break;else _0x568267['push'](_0x568267['shift']());}catch(_0x1af9d4){_0x568267['push'](_0x568267['shift']());}}}(a48_0x45f8,0x848aa));Object[a48_0x44a6ae(0x11a)](exports,a48_0x44a6ae(0x175),{'value':!![]}),exports['RapydService']=void 0x0;const loggerService_1=require(a48_0x44a6ae(0x11f));class RapydService{constructor(){const _0x1f2a07=a48_0x44a6ae;this[_0x1f2a07(0x11e)]=_0x1f2a07(0x180),console[_0x1f2a07(0x13c)](_0x1f2a07(0x178));}async[a48_0x44a6ae(0x176)](_0x246d29){const _0x5331ec=a48_0x44a6ae,{orderId:_0x137b9f,orderName:_0x2bf746,amount:_0x3ef6c3,currency:_0x30f477,usage:_0x4ff0b4,maxPayments:_0x327644,successUrl:_0x2b61fd,failUrl:_0x12ec7f}=_0x246d29,_0x3b70ae=_0x30f477[_0x5331ec(0x116)](),_0x321547='GB';console[_0x5331ec(0x13c)](_0x5331ec(0x16e));const _0x10e728='https://tesoft.uk/gateway/success.php?id='+_0x137b9f,_0x499e23=_0x5331ec(0x183)+_0x137b9f,_0x1bafbe={'amount':_0x3ef6c3,'currency':_0x3b70ae,'cancel_checkout_url':_0x499e23,'complete_checkout_url':_0x10e728,'complete_payment_url':_0x10e728,'merchant_reference_id':_0x137b9f,'description':_0x5331ec(0x14b)+_0x137b9f,'country':'GB','payment_method_types_include':['gb_visa_card',_0x5331ec(0x174)],'custom_elements':{'display_description':!![]}};if(_0x3b70ae!==_0x5331ec(0x17e)){const _0x15a971=Math['floor'](Date[_0x5331ec(0x15d)]()/0x3e8)+0x1e*0x3c;_0x1bafbe[_0x5331ec(0x16c)]=_0x5331ec(0x128),_0x1bafbe['requested_currency']='EUR',_0x1bafbe['expiration']=_0x15a971,console[_0x5331ec(0x13c)](_0x5331ec(0x159)+_0x3b70ae+_0x5331ec(0x10d)),console[_0x5331ec(0x13c)]('\x20\x20\x20fixed_side:\x20buy'),console[_0x5331ec(0x13c)](_0x5331ec(0x16f)),console[_0x5331ec(0x13c)]('\x20\x20\x20expiration:\x20'+_0x15a971+'\x20('+new Date(_0x15a971*0x3e8)[_0x5331ec(0x125)]()+')');}const _0x588a0a=Date[_0x5331ec(0x15d)]();try{console['log'](_0x5331ec(0x118)),console[_0x5331ec(0x13c)]('URL:',this[_0x5331ec(0x11e)]),console[_0x5331ec(0x13c)]('Request\x20Body\x20(Updated\x20Format):',JSON['stringify'](_0x1bafbe,null,0x2)),console[_0x5331ec(0x13c)]('🇬🇧\x20Country:\x20'+_0x321547+_0x5331ec(0x184)),console[_0x5331ec(0x13c)]('💳\x20Payment\x20Methods:\x20gb_visa_card,\x20gb_mastercard_card'),loggerService_1[_0x5331ec(0x12d)][_0x5331ec(0x136)](_0x5331ec(0x12e),'/v1/hosted/payment_links',_0x5331ec(0x12a),_0x1bafbe);const _0x17c285=await fetch(this[_0x5331ec(0x11e)],{'method':_0x5331ec(0x12a),'headers':{'Content-Type':_0x5331ec(0x110),'User-Agent':_0x5331ec(0x181)},'body':JSON[_0x5331ec(0x113)](_0x1bafbe)}),_0x2ade26=Date['now']()-_0x588a0a;console[_0x5331ec(0x13c)]('===\x20RAPYD\x20API\x20RESPONSE\x20(White\x20Domain)\x20==='),console[_0x5331ec(0x13c)]('Status:',_0x17c285['status']),console[_0x5331ec(0x13c)]('Status\x20Text:',_0x17c285[_0x5331ec(0x16d)]),console[_0x5331ec(0x13c)](_0x5331ec(0x187),Object[_0x5331ec(0x112)](_0x17c285[_0x5331ec(0x173)][_0x5331ec(0x155)]())),console[_0x5331ec(0x13c)](_0x5331ec(0x17b),_0x2ade26+'ms');const _0x3012be=await _0x17c285[_0x5331ec(0x10f)]();console[_0x5331ec(0x13c)](_0x5331ec(0x13b),_0x3012be);if(!_0x17c285['ok']){console[_0x5331ec(0x114)]('===\x20RAPYD\x20API\x20ERROR\x20==='),console['error']('HTTP\x20Status:',_0x17c285['status']),console[_0x5331ec(0x114)](_0x5331ec(0x10b),_0x3012be),loggerService_1[_0x5331ec(0x12d)]['logWhiteDomainResponse']('rapyd',_0x5331ec(0x10e),_0x17c285['status'],_0x3012be,_0x2ade26),loggerService_1['loggerService']['logWhiteDomainError'](_0x5331ec(0x12e),_0x5331ec(0x10e),_0x5331ec(0x146)+_0x17c285[_0x5331ec(0x17c)]+':\x20'+_0x3012be);throw new Error(_0x5331ec(0x119)+_0x17c285[_0x5331ec(0x17c)]+_0x5331ec(0x134)+_0x3012be);}let _0x501e44;try{_0x501e44=JSON[_0x5331ec(0x126)](_0x3012be);}catch(_0x49d74e){console['error'](_0x5331ec(0x144),_0x49d74e),loggerService_1[_0x5331ec(0x12d)][_0x5331ec(0x12c)](_0x5331ec(0x12e),_0x5331ec(0x10e),_0x5331ec(0x13a)+_0x49d74e);throw new Error('Invalid\x20JSON\x20response\x20from\x20Rapyd\x20API:\x20'+_0x3012be);}console['log']('===\x20PARSED\x20RAPYD\x20RESPONSE\x20==='),console[_0x5331ec(0x13c)](_0x5331ec(0x11b),JSON['stringify'](_0x501e44,null,0x2)),loggerService_1[_0x5331ec(0x12d)][_0x5331ec(0x171)](_0x5331ec(0x12e),'/v1/hosted/payment_links',_0x17c285[_0x5331ec(0x17c)],_0x501e44,_0x2ade26);if(_0x501e44[_0x5331ec(0x17c)]?.['status']!==_0x5331ec(0x182)){const _0x59e5f2=_0x501e44[_0x5331ec(0x17c)]?.[_0x5331ec(0x18c)]||_0x5331ec(0x13d),_0x12165f=_0x501e44[_0x5331ec(0x17c)]?.[_0x5331ec(0x172)]||_0x5331ec(0x152);console['error'](_0x5331ec(0x16b)),console['error'](_0x5331ec(0x109),_0x12165f),console[_0x5331ec(0x114)]('Error\x20Message:',_0x59e5f2),console['error'](_0x5331ec(0x150),_0x501e44[_0x5331ec(0x17c)]),loggerService_1[_0x5331ec(0x12d)][_0x5331ec(0x12c)]('rapyd',_0x5331ec(0x10e),_0x5331ec(0x120)+_0x12165f+_0x5331ec(0x12f)+_0x59e5f2);throw new Error(_0x5331ec(0x15c)+_0x12165f+_0x5331ec(0x12f)+_0x59e5f2);}if(!_0x501e44['data']?.['id']||!_0x501e44['data']?.['redirect_url']){console['error'](_0x5331ec(0x122)),console[_0x5331ec(0x114)](_0x5331ec(0x14c)),console[_0x5331ec(0x114)](_0x5331ec(0x165),_0x501e44['data']),loggerService_1[_0x5331ec(0x12d)][_0x5331ec(0x12c)](_0x5331ec(0x12e),'/v1/hosted/payment_links',_0x5331ec(0x145));throw new Error(_0x5331ec(0x130));}return console['log'](_0x5331ec(0x129)),console[_0x5331ec(0x13c)]('Payment\x20Link\x20ID:',_0x501e44[_0x5331ec(0x15e)]['id']),console['log'](_0x5331ec(0x189),_0x501e44[_0x5331ec(0x15e)]['redirect_url']),console['log'](_0x5331ec(0x149)+_0x321547+_0x5331ec(0x131)),console[_0x5331ec(0x13c)](_0x5331ec(0x14f)),{'gateway_payment_id':_0x501e44['data']['id'],'payment_url':_0x501e44[_0x5331ec(0x15e)][_0x5331ec(0x17f)]};}catch(_0x1348a5){console[_0x5331ec(0x114)](_0x5331ec(0x10a)),console[_0x5331ec(0x114)](_0x5331ec(0x188),_0x1348a5),loggerService_1[_0x5331ec(0x12d)]['logWhiteDomainError']('rapyd',_0x5331ec(0x10e),_0x1348a5);if(_0x1348a5 instanceof Error){console[_0x5331ec(0x114)](_0x5331ec(0x18a),_0x1348a5[_0x5331ec(0x18c)]),console[_0x5331ec(0x114)](_0x5331ec(0x15a),_0x1348a5['stack']);throw new Error(_0x5331ec(0x161)+_0x1348a5[_0x5331ec(0x18c)]);}throw new Error(_0x5331ec(0x123));}}async[a48_0x44a6ae(0x13e)](_0x5ea5be){const _0xe19f8f=a48_0x44a6ae,_0xde077d=Date[_0xe19f8f(0x15d)]();try{loggerService_1[_0xe19f8f(0x12d)][_0xe19f8f(0x136)](_0xe19f8f(0x12e),_0xe19f8f(0x139)+_0x5ea5be,_0xe19f8f(0x166),{});const _0x3550cd=await fetch(this[_0xe19f8f(0x11e)]+'/'+_0x5ea5be,{'method':_0xe19f8f(0x166),'headers':{'Content-Type':_0xe19f8f(0x110),'User-Agent':'TesSoft\x20Payment\x20System/1.0'}}),_0x1ef842=Date[_0xe19f8f(0x15d)]()-_0xde077d;if(!_0x3550cd['ok']){const _0x4e8b30=await _0x3550cd[_0xe19f8f(0x10f)]();loggerService_1[_0xe19f8f(0x12d)][_0xe19f8f(0x171)]('rapyd',_0xe19f8f(0x139)+_0x5ea5be,_0x3550cd[_0xe19f8f(0x17c)],_0x4e8b30,_0x1ef842);throw new Error(_0xe19f8f(0x119)+_0x3550cd['status']);}const _0x332829=await _0x3550cd[_0xe19f8f(0x153)]();loggerService_1[_0xe19f8f(0x12d)]['logWhiteDomainResponse'](_0xe19f8f(0x12e),'/v1/hosted/payment_links/'+_0x5ea5be,_0x3550cd[_0xe19f8f(0x17c)],_0x332829,_0x1ef842);if(_0x332829['status']?.['status']!==_0xe19f8f(0x182)){loggerService_1[_0xe19f8f(0x12d)][_0xe19f8f(0x12c)](_0xe19f8f(0x12e),_0xe19f8f(0x139)+_0x5ea5be,_0xe19f8f(0x133)+(_0x332829['status']?.[_0xe19f8f(0x18c)]||_0xe19f8f(0x148)));throw new Error(_0xe19f8f(0x133)+(_0x332829['status']?.[_0xe19f8f(0x18c)]||_0xe19f8f(0x148)));}let _0x1f1bd0='PENDING';if(_0x332829['data']?.['status'])switch(_0x332829[_0xe19f8f(0x15e)][_0xe19f8f(0x17c)]['toUpperCase']()){case _0xe19f8f(0x117):_0x1f1bd0=_0xe19f8f(0x14e);break;case _0xe19f8f(0x11d):_0x1f1bd0=_0xe19f8f(0x138);break;case'EXP':_0x1f1bd0=_0xe19f8f(0x18b);break;case _0xe19f8f(0x135):_0x1f1bd0=_0xe19f8f(0x138);break;case _0xe19f8f(0x10c):case _0xe19f8f(0x143):default:_0x1f1bd0=_0xe19f8f(0x14a);break;}return{'status':_0x1f1bd0,'amount':_0x332829[_0xe19f8f(0x15e)]?.[_0xe19f8f(0x11c)],'currency':_0x332829[_0xe19f8f(0x15e)]?.[_0xe19f8f(0x162)]};}catch(_0x488d23){console[_0xe19f8f(0x114)](_0xe19f8f(0x154),_0x488d23),loggerService_1[_0xe19f8f(0x12d)]['logWhiteDomainError'](_0xe19f8f(0x12e),_0xe19f8f(0x139)+_0x5ea5be,_0x488d23);throw new Error('Failed\x20to\x20verify\x20Rapyd\x20payment:\x20'+(_0x488d23 instanceof Error?_0x488d23[_0xe19f8f(0x18c)]:'Unknown\x20error'));}}async[a48_0x44a6ae(0x186)](_0xb634d2){const _0x101522=a48_0x44a6ae;console[_0x101522(0x13c)](_0x101522(0x169),_0xb634d2);let _0x148700=_0x101522(0x14a),_0x1a0e95;_0xb634d2['data']?.[_0x101522(0x158)]&&(_0x1a0e95=_0xb634d2[_0x101522(0x15e)][_0x101522(0x158)],console[_0x101522(0x13c)](_0x101522(0x14d)+_0x1a0e95));switch(_0xb634d2[_0x101522(0x179)]?.[_0x101522(0x116)]()){case _0x101522(0x140):_0xb634d2[_0x101522(0x15e)]?.['paid']===!![]&&_0xb634d2[_0x101522(0x15e)]?.[_0x101522(0x17c)]===_0x101522(0x117)?_0x148700=_0x101522(0x14e):_0x148700=_0x101522(0x14a);break;case _0x101522(0x163):_0x148700=_0x101522(0x138);break;case _0x101522(0x132):_0x148700=_0x101522(0x18b);break;case _0x101522(0x16a):_0x148700=_0x101522(0x138);!_0x1a0e95&&_0xb634d2[_0x101522(0x15e)]?.['failure_message']&&(_0x1a0e95=_0xb634d2['data'][_0x101522(0x158)]);break;default:switch(_0xb634d2['data']?.['status']?.[_0x101522(0x116)]()){case _0x101522(0x117):_0xb634d2[_0x101522(0x15e)]?.[_0x101522(0x167)]===!![]?_0x148700=_0x101522(0x14e):_0x148700=_0x101522(0x138);break;case _0x101522(0x11d):_0x148700=_0x101522(0x138);break;case _0x101522(0x17d):_0x148700=_0x101522(0x18b);break;case _0x101522(0x135):_0x148700=_0x101522(0x138);!_0x1a0e95&&_0xb634d2[_0x101522(0x15e)]?.[_0x101522(0x158)]&&(_0x1a0e95=_0xb634d2[_0x101522(0x15e)]['failure_message']);break;case _0x101522(0x10c):case _0x101522(0x143):default:_0x148700=_0x101522(0x14a);break;}break;}const _0x1b6b7d={};return _0xb634d2['data']?.['payment_method_data']?.[_0x101522(0x156)]&&(_0x1b6b7d[_0x101522(0x13f)]=_0xb634d2[_0x101522(0x15e)][_0x101522(0x121)][_0x101522(0x156)]),_0xb634d2['data']?.['payment_method_type']&&(_0x1b6b7d[_0x101522(0x177)]=_0xb634d2[_0x101522(0x15e)][_0x101522(0x147)]),_0xb634d2[_0x101522(0x15e)]?.['error_code']&&(_0x1b6b7d[_0x101522(0x160)]=_0xb634d2[_0x101522(0x15e)][_0x101522(0x172)]),_0xb634d2[_0x101522(0x15e)]?.['failure_code']&&(_0x1b6b7d[_0x101522(0x168)]=_0xb634d2[_0x101522(0x15e)][_0x101522(0x17a)]),console[_0x101522(0x13c)](_0x101522(0x12b)+_0x148700+_0x101522(0x115)+(_0x1a0e95||_0x101522(0x157))),{'paymentId':_0xb634d2[_0x101522(0x15e)]?.[_0x101522(0x15b)]||'','status':_0x148700,'amount':_0xb634d2['data']?.[_0x101522(0x11c)],'currency':_0xb634d2[_0x101522(0x15e)]?.['currency'],'failureMessage':_0x1a0e95,'additionalInfo':_0x1b6b7d};}}function a48_0x45f8(){const _0x1ff4c6=['application/json','1239308wqSxed','fromEntries','stringify','error',',\x20failureMessage=','toUpperCase','CLO','===\x20RAPYD\x20API\x20REQUEST\x20(White\x20Domain\x20-\x20Updated\x20Format)\x20===','HTTP\x20error!\x20status:\x20','defineProperty','Parsed\x20Result:','amount','CAN','apiUrl','../loggerService','Business\x20Error\x20(','payment_method_data','===\x20RAPYD\x20API\x20INCOMPLETE\x20RESPONSE\x20===','Failed\x20to\x20create\x20Rapyd\x20payment\x20link:\x20Unknown\x20error','2505864AaLDex','toISOString','parse','230mbRfIy','buy','===\x20RAPYD\x20SUCCESS\x20===','POST','🔄\x20Rapyd\x20webhook\x20processed:\x20status=','logWhiteDomainError','loggerService','rapyd','):\x20','Invalid\x20response\x20from\x20Rapyd\x20API:\x20missing\x20id\x20or\x20redirect_url','\x20(GB\x20-\x20Britain)','PAYMENT_EXPIRED','Rapyd\x20API\x20error:\x20',',\x20body:\x20','ERR','logWhiteDomainRequest','624151cKtGYg','FAILED','/v1/hosted/payment_links/','JSON\x20Parse\x20Error:\x20','Raw\x20Response\x20Body:','log','Unknown\x20error\x20from\x20Rapyd\x20API','verifyPayment','cardLast4','PAYMENT_COMPLETED','4198872fVnnYJ','RapydService','ACT','Failed\x20to\x20parse\x20JSON\x20response:','Incomplete\x20response:\x20missing\x20id\x20or\x20redirect_url','HTTP\x20','payment_method_type','Unknown\x20error','🇬🇧\x20Country\x20used:\x20','PENDING','ORDER:\x20','Missing\x20id\x20or\x20redirect_url\x20in\x20response','💥\x20Rapyd\x20failure\x20message:\x20','PAID','💳\x20Payment\x20Methods:\x20gb_visa_card,\x20gb_mastercard_card','Full\x20Error\x20Data:','813489eflhNo','UNKNOWN','json','Rapyd\x20payment\x20verification\x20error:','entries','last4','none','failure_message','💱\x20Adding\x20currency\x20conversion\x20fields\x20for\x20','Error\x20stack:','merchant_reference_id','Rapyd\x20API\x20error\x20(','now','data','18nGgxIA','errorCode','Failed\x20to\x20create\x20Rapyd\x20payment\x20link:\x20','currency','PAYMENT_CANCELED','6gsFeCX','Response\x20data:','GET','paid','failureCode','Processing\x20Rapyd\x20webhook:','PAYMENT_FAILED','===\x20RAPYD\x20API\x20BUSINESS\x20ERROR\x20===','fixed_side','statusText','🇬🇧\x20Using\x20GB\x20(Britain)\x20as\x20country\x20for\x20Rapyd\x20payment\x20link','\x20\x20\x20requested_currency:\x20EUR','1723744LGIbib','logWhiteDomainResponse','error_code','headers','gb_mastercard_card','__esModule','createPaymentLink','paymentMethod','🌐\x20Rapyd\x20service\x20initialized\x20with\x20white\x20domain\x20proxy','type','failure_code','Response\x20Time:','status','EXP','EUR','redirect_url','https://tesoft.uk/gateway/rapyd/','TesSoft\x20Payment\x20System/1.0','SUCCESS','https://tesoft.uk/gateway/fail.php?id=','\x20(always\x20GB\x20for\x20Rapyd)','5zIVVrr','processWebhook','Headers:','Error\x20details:','Redirect\x20URL:','Error\x20message:','EXPIRED','message','586080oJgsvo','Error\x20Code:','===\x20RAPYD\x20SERVICE\x20ERROR\x20===','Response\x20Body:','NEW','\x20->\x20EUR:','/v1/hosted/payment_links','text'];a48_0x45f8=function(){return _0x1ff4c6;};return a48_0x45f8();}exports[a48_0x44a6ae(0x142)]=RapydService;