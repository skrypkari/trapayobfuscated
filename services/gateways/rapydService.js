'use strict';const a46_0x30a5bd=a46_0x521d;(function(_0x471ecf,_0x3cd371){const _0x1e27ef=a46_0x521d,_0x2d5bea=_0x471ecf();while(!![]){try{const _0x381982=parseInt(_0x1e27ef(0x119))/0x1+parseInt(_0x1e27ef(0xb4))/0x2+-parseInt(_0x1e27ef(0xb7))/0x3*(parseInt(_0x1e27ef(0xce))/0x4)+parseInt(_0x1e27ef(0x105))/0x5*(parseInt(_0x1e27ef(0xc6))/0x6)+parseInt(_0x1e27ef(0x11c))/0x7*(parseInt(_0x1e27ef(0x11d))/0x8)+-parseInt(_0x1e27ef(0xd1))/0x9+parseInt(_0x1e27ef(0xfe))/0xa*(-parseInt(_0x1e27ef(0x10d))/0xb);if(_0x381982===_0x3cd371)break;else _0x2d5bea['push'](_0x2d5bea['shift']());}catch(_0xf6b16b){_0x2d5bea['push'](_0x2d5bea['shift']());}}}(a46_0x497e,0xf38bb));Object['defineProperty'](exports,a46_0x30a5bd(0xb2),{'value':!![]}),exports['RapydService']=void 0x0;function a46_0x521d(_0x4aaffb,_0x31bc92){const _0x497ea8=a46_0x497e();return a46_0x521d=function(_0x521de0,_0x214d03){_0x521de0=_0x521de0-0xab;let _0x26825a=_0x497ea8[_0x521de0];return _0x26825a;},a46_0x521d(_0x4aaffb,_0x31bc92);}const loggerService_1=require(a46_0x30a5bd(0xe1));class RapydService{constructor(){const _0x51d567=a46_0x30a5bd;this[_0x51d567(0xde)]=_0x51d567(0xf2),console['log'](_0x51d567(0x10b));}async[a46_0x30a5bd(0xc4)](_0xc42282){const _0x23b8f2=a46_0x30a5bd,{orderId:_0xd33c69,orderName:_0x18589b,amount:_0x30fa7c,currency:_0x293fdf,usage:_0x5a0ef0,maxPayments:_0x22b02b,successUrl:_0x11bc48,failUrl:_0x3e72e6}=_0xc42282,_0x36fd0b=_0x293fdf['toUpperCase'](),_0x5d1e39='GB';console[_0x23b8f2(0xf3)](_0x23b8f2(0xb5));const _0x585bea=_0x23b8f2(0xc7)+_0xd33c69,_0x3006d8='https://tesoft.uk/gateway/fail.php?id='+_0xd33c69,_0x1e1d2e={'amount':_0x30fa7c,'currency':_0x36fd0b,'cancel_checkout_url':_0x3006d8,'complete_checkout_url':_0x585bea,'complete_payment_url':_0x585bea,'merchant_reference_id':_0xd33c69,'description':'ORDER:\x20'+_0xd33c69,'country':'GB','payment_method_types_include':[_0x23b8f2(0xd5),_0x23b8f2(0xe2)],'custom_elements':{'display_description':!![]}};if(_0x36fd0b!=='EUR'){const _0x24393a=Math[_0x23b8f2(0x102)](Date[_0x23b8f2(0x107)]()/0x3e8)+0x1e*0x3c;_0x1e1d2e['fixed_side']='buy',_0x1e1d2e[_0x23b8f2(0xe0)]=_0x23b8f2(0xec),_0x1e1d2e[_0x23b8f2(0xc0)]=_0x24393a,console[_0x23b8f2(0xf3)]('💱\x20Adding\x20currency\x20conversion\x20fields\x20for\x20'+_0x36fd0b+'\x20->\x20EUR:'),console['log']('\x20\x20\x20fixed_side:\x20buy'),console[_0x23b8f2(0xf3)]('\x20\x20\x20requested_currency:\x20EUR'),console[_0x23b8f2(0xf3)]('\x20\x20\x20expiration:\x20'+_0x24393a+'\x20('+new Date(_0x24393a*0x3e8)[_0x23b8f2(0x103)]()+')');}const _0x21eabc=Date[_0x23b8f2(0x107)]();try{console['log'](_0x23b8f2(0xb6)),console['log'](_0x23b8f2(0xe5),this['apiUrl']),console[_0x23b8f2(0xf3)](_0x23b8f2(0xe3),JSON[_0x23b8f2(0xef)](_0x1e1d2e,null,0x2)),console[_0x23b8f2(0xf3)]('🇬🇧\x20Country:\x20'+_0x5d1e39+_0x23b8f2(0xbd)),console[_0x23b8f2(0xf3)](_0x23b8f2(0x11f)),loggerService_1['loggerService'][_0x23b8f2(0x116)]('rapyd',_0x23b8f2(0xe7),_0x23b8f2(0x122),_0x1e1d2e);const _0x24f1b7=await fetch(this[_0x23b8f2(0xde)],{'method':_0x23b8f2(0x122),'headers':{'Content-Type':'application/json','User-Agent':_0x23b8f2(0xdb)},'body':JSON[_0x23b8f2(0xef)](_0x1e1d2e)}),_0x132e31=Date[_0x23b8f2(0x107)]()-_0x21eabc;console[_0x23b8f2(0xf3)]('===\x20RAPYD\x20API\x20RESPONSE\x20(White\x20Domain)\x20==='),console[_0x23b8f2(0xf3)]('Status:',_0x24f1b7['status']),console['log'](_0x23b8f2(0xf8),_0x24f1b7['statusText']),console[_0x23b8f2(0xf3)](_0x23b8f2(0xdf),Object['fromEntries'](_0x24f1b7[_0x23b8f2(0x100)][_0x23b8f2(0xdc)]())),console['log'](_0x23b8f2(0x117),_0x132e31+'ms');const _0x25f62a=await _0x24f1b7['text']();console[_0x23b8f2(0xf3)](_0x23b8f2(0x11e),_0x25f62a);if(!_0x24f1b7['ok']){console[_0x23b8f2(0xac)](_0x23b8f2(0x10c)),console[_0x23b8f2(0xac)](_0x23b8f2(0xd8),_0x24f1b7[_0x23b8f2(0xae)]),console[_0x23b8f2(0xac)](_0x23b8f2(0x123),_0x25f62a),loggerService_1[_0x23b8f2(0xc5)][_0x23b8f2(0xfa)]('rapyd','/v1/hosted/payment_links',_0x24f1b7[_0x23b8f2(0xae)],_0x25f62a,_0x132e31),loggerService_1['loggerService'][_0x23b8f2(0xba)](_0x23b8f2(0x113),_0x23b8f2(0xe7),_0x23b8f2(0xb0)+_0x24f1b7[_0x23b8f2(0xae)]+':\x20'+_0x25f62a);throw new Error(_0x23b8f2(0xeb)+_0x24f1b7[_0x23b8f2(0xae)]+_0x23b8f2(0xed)+_0x25f62a);}let _0x297664;try{_0x297664=JSON['parse'](_0x25f62a);}catch(_0x462a00){console['error'](_0x23b8f2(0xcc),_0x462a00),loggerService_1[_0x23b8f2(0xc5)][_0x23b8f2(0xba)]('rapyd','/v1/hosted/payment_links',_0x23b8f2(0xff)+_0x462a00);throw new Error(_0x23b8f2(0xea)+_0x25f62a);}console[_0x23b8f2(0xf3)]('===\x20PARSED\x20RAPYD\x20RESPONSE\x20==='),console[_0x23b8f2(0xf3)](_0x23b8f2(0x114),JSON['stringify'](_0x297664,null,0x2)),loggerService_1[_0x23b8f2(0xc5)][_0x23b8f2(0xfa)](_0x23b8f2(0x113),_0x23b8f2(0xe7),_0x24f1b7['status'],_0x297664,_0x132e31);if(_0x297664['status']?.[_0x23b8f2(0xae)]!=='SUCCESS'){const _0x26f4fc=_0x297664[_0x23b8f2(0xae)]?.[_0x23b8f2(0xb1)]||_0x23b8f2(0x111),_0x55d430=_0x297664[_0x23b8f2(0xae)]?.[_0x23b8f2(0xbb)]||_0x23b8f2(0xab);console['error'](_0x23b8f2(0xe6)),console[_0x23b8f2(0xac)](_0x23b8f2(0x124),_0x55d430),console[_0x23b8f2(0xac)](_0x23b8f2(0xc9),_0x26f4fc),console[_0x23b8f2(0xac)](_0x23b8f2(0x10a),_0x297664[_0x23b8f2(0xae)]),loggerService_1[_0x23b8f2(0xc5)][_0x23b8f2(0xba)](_0x23b8f2(0x113),_0x23b8f2(0xe7),'Business\x20Error\x20('+_0x55d430+'):\x20'+_0x26f4fc);throw new Error(_0x23b8f2(0xfd)+_0x55d430+'):\x20'+_0x26f4fc);}if(!_0x297664[_0x23b8f2(0xfb)]?.['id']||!_0x297664['data']?.[_0x23b8f2(0xd4)]){console[_0x23b8f2(0xac)](_0x23b8f2(0xd6)),console[_0x23b8f2(0xac)]('Missing\x20id\x20or\x20redirect_url\x20in\x20response'),console['error'](_0x23b8f2(0x101),_0x297664[_0x23b8f2(0xfb)]),loggerService_1['loggerService']['logWhiteDomainError'](_0x23b8f2(0x113),_0x23b8f2(0xe7),'Incomplete\x20response:\x20missing\x20id\x20or\x20redirect_url');throw new Error(_0x23b8f2(0xc1));}return console[_0x23b8f2(0xf3)](_0x23b8f2(0xd3)),console[_0x23b8f2(0xf3)](_0x23b8f2(0xf1),_0x297664[_0x23b8f2(0xfb)]['id']),console[_0x23b8f2(0xf3)](_0x23b8f2(0xd0),_0x297664[_0x23b8f2(0xfb)][_0x23b8f2(0xd4)]),console['log']('🇬🇧\x20Country\x20used:\x20'+_0x5d1e39+'\x20(GB\x20-\x20Britain)'),console[_0x23b8f2(0xf3)](_0x23b8f2(0x11f)),{'gateway_payment_id':_0x297664[_0x23b8f2(0xfb)]['id'],'payment_url':_0x297664['data'][_0x23b8f2(0xd4)]};}catch(_0x5aa051){console['error'](_0x23b8f2(0xcf)),console[_0x23b8f2(0xac)](_0x23b8f2(0xe8),_0x5aa051),loggerService_1[_0x23b8f2(0xc5)][_0x23b8f2(0xba)](_0x23b8f2(0x113),_0x23b8f2(0xe7),_0x5aa051);if(_0x5aa051 instanceof Error){console[_0x23b8f2(0xac)](_0x23b8f2(0xbc),_0x5aa051[_0x23b8f2(0xb1)]),console['error'](_0x23b8f2(0xee),_0x5aa051[_0x23b8f2(0xc2)]);throw new Error(_0x23b8f2(0xd9)+_0x5aa051[_0x23b8f2(0xb1)]);}throw new Error('Failed\x20to\x20create\x20Rapyd\x20payment\x20link:\x20Unknown\x20error');}}async[a46_0x30a5bd(0x110)](_0xc08d7e){const _0x15312f=a46_0x30a5bd,_0x3aae2a=Date[_0x15312f(0x107)]();try{loggerService_1[_0x15312f(0xc5)]['logWhiteDomainRequest'](_0x15312f(0x113),_0x15312f(0xf5)+_0xc08d7e,_0x15312f(0xb3),{});const _0x49514d=await fetch(this['apiUrl']+'/'+_0xc08d7e,{'method':'GET','headers':{'Content-Type':'application/json','User-Agent':_0x15312f(0xdb)}}),_0x4303f9=Date[_0x15312f(0x107)]()-_0x3aae2a;if(!_0x49514d['ok']){const _0x1595cb=await _0x49514d[_0x15312f(0xf9)]();loggerService_1[_0x15312f(0xc5)][_0x15312f(0xfa)](_0x15312f(0x113),_0x15312f(0xf5)+_0xc08d7e,_0x49514d[_0x15312f(0xae)],_0x1595cb,_0x4303f9);throw new Error(_0x15312f(0xeb)+_0x49514d[_0x15312f(0xae)]);}const _0x56cd0e=await _0x49514d[_0x15312f(0x104)]();loggerService_1['loggerService']['logWhiteDomainResponse'](_0x15312f(0x113),_0x15312f(0xf5)+_0xc08d7e,_0x49514d['status'],_0x56cd0e,_0x4303f9);if(_0x56cd0e[_0x15312f(0xae)]?.['status']!==_0x15312f(0x106)){loggerService_1[_0x15312f(0xc5)][_0x15312f(0xba)]('rapyd',_0x15312f(0xf5)+_0xc08d7e,_0x15312f(0xdd)+(_0x56cd0e[_0x15312f(0xae)]?.[_0x15312f(0xb1)]||_0x15312f(0xe9)));throw new Error(_0x15312f(0xdd)+(_0x56cd0e['status']?.['message']||_0x15312f(0xe9)));}let _0x91b0a8=_0x15312f(0x121);if(_0x56cd0e['data']?.[_0x15312f(0xae)])switch(_0x56cd0e[_0x15312f(0xfb)][_0x15312f(0xae)][_0x15312f(0x108)]()){case _0x15312f(0xc8):_0x91b0a8=_0x15312f(0xc3);break;case'CAN':_0x91b0a8='FAILED';break;case _0x15312f(0x11b):_0x91b0a8=_0x15312f(0x115);break;case _0x15312f(0xd7):_0x91b0a8=_0x15312f(0xaf);break;case _0x15312f(0xad):case _0x15312f(0xca):default:_0x91b0a8='PENDING';break;}return{'status':_0x91b0a8,'amount':_0x56cd0e[_0x15312f(0xfb)]?.[_0x15312f(0xf6)],'currency':_0x56cd0e[_0x15312f(0xfb)]?.[_0x15312f(0xf4)]};}catch(_0x5c9999){console['error'](_0x15312f(0xf0),_0x5c9999),loggerService_1[_0x15312f(0xc5)][_0x15312f(0xba)](_0x15312f(0x113),_0x15312f(0xf5)+_0xc08d7e,_0x5c9999);throw new Error(_0x15312f(0xd2)+(_0x5c9999 instanceof Error?_0x5c9999[_0x15312f(0xb1)]:_0x15312f(0xe9)));}}async['processWebhook'](_0x1a00fc){const _0x33384a=a46_0x30a5bd;console[_0x33384a(0xf3)](_0x33384a(0xcb),_0x1a00fc);let _0x1095c2=_0x33384a(0x121),_0x120e96;_0x1a00fc['data']?.['failure_message']&&(_0x120e96=_0x1a00fc[_0x33384a(0xfb)][_0x33384a(0x120)],console[_0x33384a(0xf3)](_0x33384a(0xda)+_0x120e96));switch(_0x1a00fc[_0x33384a(0xe4)]?.['toUpperCase']()){case _0x33384a(0xcd):_0x1a00fc['data']?.[_0x33384a(0x10f)]===!![]&&_0x1a00fc[_0x33384a(0xfb)]?.[_0x33384a(0xae)]===_0x33384a(0xc8)?_0x1095c2=_0x33384a(0xc3):_0x1095c2=_0x33384a(0x121);break;case'PAYMENT_CANCELED':_0x1095c2=_0x33384a(0xaf);break;case _0x33384a(0x109):_0x1095c2='EXPIRED';break;case _0x33384a(0x11a):_0x1095c2=_0x33384a(0xaf);!_0x120e96&&_0x1a00fc[_0x33384a(0xfb)]?.[_0x33384a(0x120)]&&(_0x120e96=_0x1a00fc[_0x33384a(0xfb)][_0x33384a(0x120)]);break;default:switch(_0x1a00fc['data']?.['status']?.['toUpperCase']()){case _0x33384a(0xc8):_0x1a00fc[_0x33384a(0xfb)]?.[_0x33384a(0x10f)]===!![]?_0x1095c2='PAID':_0x1095c2=_0x33384a(0xaf);break;case _0x33384a(0xfc):_0x1095c2=_0x33384a(0xaf);break;case'EXP':_0x1095c2=_0x33384a(0x115);break;case _0x33384a(0xd7):_0x1095c2=_0x33384a(0xaf);!_0x120e96&&_0x1a00fc[_0x33384a(0xfb)]?.[_0x33384a(0x120)]&&(_0x120e96=_0x1a00fc['data'][_0x33384a(0x120)]);break;case _0x33384a(0xad):case _0x33384a(0xca):default:_0x1095c2='PENDING';break;}break;}const _0x34ed99={};return _0x1a00fc['data']?.['payment_method_data']?.[_0x33384a(0xbf)]&&(_0x34ed99['cardLast4']=_0x1a00fc[_0x33384a(0xfb)][_0x33384a(0x118)][_0x33384a(0xbf)]),_0x1a00fc[_0x33384a(0xfb)]?.['payment_method_type']&&(_0x34ed99[_0x33384a(0xf7)]=_0x1a00fc['data']['payment_method_type']),_0x1a00fc[_0x33384a(0xfb)]?.[_0x33384a(0xbb)]&&(_0x34ed99[_0x33384a(0xb9)]=_0x1a00fc[_0x33384a(0xfb)][_0x33384a(0xbb)]),_0x1a00fc[_0x33384a(0xfb)]?.[_0x33384a(0xbe)]&&(_0x34ed99['failureCode']=_0x1a00fc[_0x33384a(0xfb)][_0x33384a(0xbe)]),console['log'](_0x33384a(0x112)+_0x1095c2+',\x20failureMessage='+(_0x120e96||_0x33384a(0xb8))),{'paymentId':_0x1a00fc['data']?.[_0x33384a(0x10e)]||'','status':_0x1095c2,'amount':_0x1a00fc['data']?.[_0x33384a(0xf6)],'currency':_0x1a00fc[_0x33384a(0xfb)]?.[_0x33384a(0xf4)],'failureMessage':_0x120e96,'additionalInfo':_0x34ed99};}}exports['RapydService']=RapydService;function a46_0x497e(){const _0x349f7b=['Unknown\x20error','Invalid\x20JSON\x20response\x20from\x20Rapyd\x20API:\x20','HTTP\x20error!\x20status:\x20','EUR',',\x20body:\x20','Error\x20stack:','stringify','Rapyd\x20payment\x20verification\x20error:','Payment\x20Link\x20ID:','https://tesoft.uk/gateway/rapyd/','log','currency','/v1/hosted/payment_links/','amount','paymentMethod','Status\x20Text:','text','logWhiteDomainResponse','data','CAN','Rapyd\x20API\x20error\x20(','107230GWdrzB','JSON\x20Parse\x20Error:\x20','headers','Response\x20data:','floor','toISOString','json','730xaPtsz','SUCCESS','now','toUpperCase','PAYMENT_EXPIRED','Full\x20Error\x20Data:','🌐\x20Rapyd\x20service\x20initialized\x20with\x20white\x20domain\x20proxy','===\x20RAPYD\x20API\x20ERROR\x20===','1606kgHsAz','merchant_reference_id','paid','verifyPayment','Unknown\x20error\x20from\x20Rapyd\x20API','🔄\x20Rapyd\x20webhook\x20processed:\x20status=','rapyd','Parsed\x20Result:','EXPIRED','logWhiteDomainRequest','Response\x20Time:','payment_method_data','1244605EVkdyc','PAYMENT_FAILED','EXP','160937fitvUp','592zzyskG','Raw\x20Response\x20Body:','💳\x20Payment\x20Methods:\x20gb_visa_card,\x20gb_mastercard_card','failure_message','PENDING','POST','Response\x20Body:','Error\x20Code:','UNKNOWN','error','NEW','status','FAILED','HTTP\x20','message','__esModule','GET','1343360SvBMDE','🇬🇧\x20Using\x20GB\x20(Britain)\x20as\x20country\x20for\x20Rapyd\x20payment\x20link','===\x20RAPYD\x20API\x20REQUEST\x20(White\x20Domain\x20-\x20Updated\x20Format)\x20===','12bfPudI','none','errorCode','logWhiteDomainError','error_code','Error\x20message:','\x20(always\x20GB\x20for\x20Rapyd)','failure_code','last4','expiration','Invalid\x20response\x20from\x20Rapyd\x20API:\x20missing\x20id\x20or\x20redirect_url','stack','PAID','createPaymentLink','loggerService','49338ISgPOa','https://tesoft.uk/gateway/success.php?id=','CLO','Error\x20Message:','ACT','Processing\x20Rapyd\x20webhook:','Failed\x20to\x20parse\x20JSON\x20response:','PAYMENT_COMPLETED','620212ZiOZsc','===\x20RAPYD\x20SERVICE\x20ERROR\x20===','Redirect\x20URL:','14713596fVDTMB','Failed\x20to\x20verify\x20Rapyd\x20payment:\x20','===\x20RAPYD\x20SUCCESS\x20===','redirect_url','gb_visa_card','===\x20RAPYD\x20API\x20INCOMPLETE\x20RESPONSE\x20===','ERR','HTTP\x20Status:','Failed\x20to\x20create\x20Rapyd\x20payment\x20link:\x20','💥\x20Rapyd\x20failure\x20message:\x20','TesSoft\x20Payment\x20System/1.0','entries','Rapyd\x20API\x20error:\x20','apiUrl','Headers:','requested_currency','../loggerService','gb_mastercard_card','Request\x20Body\x20(Updated\x20Format):','type','URL:','===\x20RAPYD\x20API\x20BUSINESS\x20ERROR\x20===','/v1/hosted/payment_links','Error\x20details:'];a46_0x497e=function(){return _0x349f7b;};return a46_0x497e();}