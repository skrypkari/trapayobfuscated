'use strict';const a45_0x23b69d=a45_0x4223;(function(_0x5c9f99,_0x4de3bc){const _0x8839dc=a45_0x4223,_0x20dba2=_0x5c9f99();while(!![]){try{const _0x4f62b1=-parseInt(_0x8839dc(0x238))/0x1*(parseInt(_0x8839dc(0x1ee))/0x2)+-parseInt(_0x8839dc(0x21a))/0x3*(parseInt(_0x8839dc(0x213))/0x4)+-parseInt(_0x8839dc(0x1f0))/0x5*(-parseInt(_0x8839dc(0x24f))/0x6)+parseInt(_0x8839dc(0x215))/0x7+-parseInt(_0x8839dc(0x219))/0x8*(parseInt(_0x8839dc(0x21c))/0x9)+-parseInt(_0x8839dc(0x252))/0xa+-parseInt(_0x8839dc(0x1fc))/0xb*(-parseInt(_0x8839dc(0x201))/0xc);if(_0x4f62b1===_0x4de3bc)break;else _0x20dba2['push'](_0x20dba2['shift']());}catch(_0xce2612){_0x20dba2['push'](_0x20dba2['shift']());}}}(a45_0x2f40,0x3779c));Object['defineProperty'](exports,'__esModule',{'value':!![]}),exports['RapydService']=void 0x0;const loggerService_1=require(a45_0x23b69d(0x20a));class RapydService{constructor(){const _0x30333c=a45_0x23b69d;this[_0x30333c(0x24e)]=_0x30333c(0x1e7),console[_0x30333c(0x241)](_0x30333c(0x240));}async[a45_0x23b69d(0x220)](_0x22db65){const _0x3ba0f9=a45_0x23b69d,{orderId:_0x36cceb,orderName:_0x4b2dfe,amount:_0x19d0c5,currency:_0x2e3e95,usage:_0x1d22f7,maxPayments:_0x5e804b,successUrl:_0x35c5cf,failUrl:_0x3022ef}=_0x22db65,_0x5106d6=_0x2e3e95['toUpperCase'](),_0x29e0e='GB';console[_0x3ba0f9(0x241)](_0x3ba0f9(0x1ff));const _0x560578=_0x3ba0f9(0x1f2)+_0x36cceb,_0xd19b54=_0x3ba0f9(0x246)+_0x36cceb,_0x24ef5c={'amount':_0x19d0c5,'currency':_0x5106d6,'cancel_checkout_url':_0xd19b54,'complete_checkout_url':_0x560578,'complete_payment_url':_0x560578,'merchant_reference_id':_0x36cceb,'description':_0x3ba0f9(0x1f1)+_0x36cceb,'country':'GB','payment_method_types_include':[_0x3ba0f9(0x21d),'gb_mastercard_card'],'custom_elements':{'display_description':!![]}},_0xd55264=Date[_0x3ba0f9(0x23c)]();try{console[_0x3ba0f9(0x241)](_0x3ba0f9(0x1fe)),console['log'](_0x3ba0f9(0x242),this[_0x3ba0f9(0x24e)]),console['log']('Request\x20Body\x20(Updated\x20Format):',JSON[_0x3ba0f9(0x245)](_0x24ef5c,null,0x2)),console['log'](_0x3ba0f9(0x1f3)+_0x29e0e+_0x3ba0f9(0x224)),console['log'](_0x3ba0f9(0x218)),loggerService_1[_0x3ba0f9(0x1eb)]['logWhiteDomainRequest'](_0x3ba0f9(0x228),_0x3ba0f9(0x223),_0x3ba0f9(0x202),_0x24ef5c);const _0x47be3b=await fetch(this[_0x3ba0f9(0x24e)],{'method':_0x3ba0f9(0x202),'headers':{'Content-Type':'application/json','User-Agent':_0x3ba0f9(0x23d)},'body':JSON['stringify'](_0x24ef5c)}),_0x1d0b24=Date[_0x3ba0f9(0x23c)]()-_0xd55264;console[_0x3ba0f9(0x241)](_0x3ba0f9(0x211)),console['log'](_0x3ba0f9(0x22c),_0x47be3b['status']),console[_0x3ba0f9(0x241)]('Status\x20Text:',_0x47be3b[_0x3ba0f9(0x221)]),console['log'](_0x3ba0f9(0x24b),Object[_0x3ba0f9(0x209)](_0x47be3b[_0x3ba0f9(0x249)][_0x3ba0f9(0x1ed)]())),console[_0x3ba0f9(0x241)]('Response\x20Time:',_0x1d0b24+'ms');const _0x41c1c9=await _0x47be3b[_0x3ba0f9(0x24d)]();console[_0x3ba0f9(0x241)](_0x3ba0f9(0x217),_0x41c1c9);if(!_0x47be3b['ok']){console[_0x3ba0f9(0x1fa)](_0x3ba0f9(0x20e)),console[_0x3ba0f9(0x1fa)](_0x3ba0f9(0x1fb),_0x47be3b[_0x3ba0f9(0x250)]),console[_0x3ba0f9(0x1fa)](_0x3ba0f9(0x22a),_0x41c1c9),loggerService_1['loggerService'][_0x3ba0f9(0x210)](_0x3ba0f9(0x228),'/v1/hosted/payment_links',_0x47be3b[_0x3ba0f9(0x250)],_0x41c1c9,_0x1d0b24),loggerService_1[_0x3ba0f9(0x1eb)]['logWhiteDomainError'](_0x3ba0f9(0x228),_0x3ba0f9(0x223),_0x3ba0f9(0x225)+_0x47be3b[_0x3ba0f9(0x250)]+':\x20'+_0x41c1c9);throw new Error('HTTP\x20error!\x20status:\x20'+_0x47be3b[_0x3ba0f9(0x250)]+',\x20body:\x20'+_0x41c1c9);}let _0x44c739;try{_0x44c739=JSON['parse'](_0x41c1c9);}catch(_0x5cf972){console[_0x3ba0f9(0x1fa)]('Failed\x20to\x20parse\x20JSON\x20response:',_0x5cf972),loggerService_1[_0x3ba0f9(0x1eb)][_0x3ba0f9(0x22e)](_0x3ba0f9(0x228),_0x3ba0f9(0x223),_0x3ba0f9(0x207)+_0x5cf972);throw new Error(_0x3ba0f9(0x214)+_0x41c1c9);}console[_0x3ba0f9(0x241)](_0x3ba0f9(0x22f)),console[_0x3ba0f9(0x241)](_0x3ba0f9(0x206),JSON['stringify'](_0x44c739,null,0x2)),loggerService_1[_0x3ba0f9(0x1eb)][_0x3ba0f9(0x210)]('rapyd',_0x3ba0f9(0x223),_0x47be3b[_0x3ba0f9(0x250)],_0x44c739,_0x1d0b24);if(_0x44c739[_0x3ba0f9(0x250)]?.[_0x3ba0f9(0x250)]!==_0x3ba0f9(0x233)){const _0x381084=_0x44c739[_0x3ba0f9(0x250)]?.['message']||_0x3ba0f9(0x1f8),_0x4f6f05=_0x44c739[_0x3ba0f9(0x250)]?.[_0x3ba0f9(0x243)]||'UNKNOWN';console[_0x3ba0f9(0x1fa)](_0x3ba0f9(0x227)),console[_0x3ba0f9(0x1fa)]('Error\x20Code:',_0x4f6f05),console['error'](_0x3ba0f9(0x247),_0x381084),console[_0x3ba0f9(0x1fa)]('Full\x20Error\x20Data:',_0x44c739[_0x3ba0f9(0x250)]),loggerService_1['loggerService'][_0x3ba0f9(0x22e)](_0x3ba0f9(0x228),_0x3ba0f9(0x223),_0x3ba0f9(0x222)+_0x4f6f05+_0x3ba0f9(0x1f5)+_0x381084);throw new Error(_0x3ba0f9(0x244)+_0x4f6f05+'):\x20'+_0x381084);}if(!_0x44c739['data']?.['id']||!_0x44c739['data']?.[_0x3ba0f9(0x1f7)]){console['error'](_0x3ba0f9(0x22d)),console[_0x3ba0f9(0x1fa)](_0x3ba0f9(0x258)),console[_0x3ba0f9(0x1fa)](_0x3ba0f9(0x200),_0x44c739[_0x3ba0f9(0x212)]),loggerService_1[_0x3ba0f9(0x1eb)]['logWhiteDomainError'](_0x3ba0f9(0x228),_0x3ba0f9(0x223),_0x3ba0f9(0x236));throw new Error(_0x3ba0f9(0x25a));}return console[_0x3ba0f9(0x241)]('===\x20RAPYD\x20SUCCESS\x20==='),console[_0x3ba0f9(0x241)](_0x3ba0f9(0x1ef),_0x44c739[_0x3ba0f9(0x212)]['id']),console[_0x3ba0f9(0x241)](_0x3ba0f9(0x1f4),_0x44c739['data'][_0x3ba0f9(0x1f7)]),console[_0x3ba0f9(0x241)](_0x3ba0f9(0x1ec)+_0x29e0e+'\x20(GB\x20-\x20Britain)'),console[_0x3ba0f9(0x241)](_0x3ba0f9(0x218)),{'gateway_payment_id':_0x44c739[_0x3ba0f9(0x212)]['id'],'payment_url':_0x44c739[_0x3ba0f9(0x212)][_0x3ba0f9(0x1f7)]};}catch(_0x4748b2){console[_0x3ba0f9(0x1fa)](_0x3ba0f9(0x229)),console[_0x3ba0f9(0x1fa)]('Error\x20details:',_0x4748b2),loggerService_1['loggerService'][_0x3ba0f9(0x22e)](_0x3ba0f9(0x228),'/v1/hosted/payment_links',_0x4748b2);if(_0x4748b2 instanceof Error){console[_0x3ba0f9(0x1fa)](_0x3ba0f9(0x239),_0x4748b2['message']),console['error'](_0x3ba0f9(0x257),_0x4748b2[_0x3ba0f9(0x208)]);throw new Error(_0x3ba0f9(0x21f)+_0x4748b2[_0x3ba0f9(0x23e)]);}throw new Error(_0x3ba0f9(0x226));}}async['verifyPayment'](_0x1529e7){const _0x30796d=a45_0x23b69d,_0x3ea4e4=Date[_0x30796d(0x23c)]();try{loggerService_1['loggerService'][_0x30796d(0x23b)](_0x30796d(0x228),_0x30796d(0x21b)+_0x1529e7,'GET',{});const _0x8323da=await fetch(this[_0x30796d(0x24e)]+'/'+_0x1529e7,{'method':_0x30796d(0x256),'headers':{'Content-Type':_0x30796d(0x20c),'User-Agent':_0x30796d(0x23d)}}),_0x5d04b6=Date[_0x30796d(0x23c)]()-_0x3ea4e4;if(!_0x8323da['ok']){const _0x105854=await _0x8323da['text']();loggerService_1[_0x30796d(0x1eb)][_0x30796d(0x210)](_0x30796d(0x228),_0x30796d(0x21b)+_0x1529e7,_0x8323da['status'],_0x105854,_0x5d04b6);throw new Error(_0x30796d(0x21e)+_0x8323da[_0x30796d(0x250)]);}const _0x3e4ee3=await _0x8323da[_0x30796d(0x216)]();loggerService_1['loggerService']['logWhiteDomainResponse'](_0x30796d(0x228),_0x30796d(0x21b)+_0x1529e7,_0x8323da[_0x30796d(0x250)],_0x3e4ee3,_0x5d04b6);if(_0x3e4ee3[_0x30796d(0x250)]?.[_0x30796d(0x250)]!=='SUCCESS'){loggerService_1['loggerService'][_0x30796d(0x22e)](_0x30796d(0x228),_0x30796d(0x21b)+_0x1529e7,_0x30796d(0x253)+(_0x3e4ee3['status']?.[_0x30796d(0x23e)]||_0x30796d(0x230)));throw new Error('Rapyd\x20API\x20error:\x20'+(_0x3e4ee3[_0x30796d(0x250)]?.[_0x30796d(0x23e)]||_0x30796d(0x230)));}let _0x2fea50=_0x30796d(0x205);if(_0x3e4ee3[_0x30796d(0x212)]?.[_0x30796d(0x250)])switch(_0x3e4ee3['data']['status']['toUpperCase']()){case'CLO':_0x2fea50='PAID';break;case _0x30796d(0x255):_0x2fea50='FAILED';break;case _0x30796d(0x20f):_0x2fea50=_0x30796d(0x232);break;case _0x30796d(0x24a):_0x2fea50=_0x30796d(0x24c);break;case _0x30796d(0x1f9):case _0x30796d(0x231):default:_0x2fea50=_0x30796d(0x205);break;}return{'status':_0x2fea50,'amount':_0x3e4ee3['data']?.['amount'],'currency':_0x3e4ee3[_0x30796d(0x212)]?.[_0x30796d(0x20d)]};}catch(_0x49416d){console['error'](_0x30796d(0x235),_0x49416d),loggerService_1[_0x30796d(0x1eb)][_0x30796d(0x22e)]('rapyd',_0x30796d(0x21b)+_0x1529e7,_0x49416d);throw new Error('Failed\x20to\x20verify\x20Rapyd\x20payment:\x20'+(_0x49416d instanceof Error?_0x49416d[_0x30796d(0x23e)]:_0x30796d(0x230)));}}async[a45_0x23b69d(0x259)](_0x15c2df){const _0x2e0c21=a45_0x23b69d;console[_0x2e0c21(0x241)]('Processing\x20Rapyd\x20webhook:',_0x15c2df);let _0x3acffc='PENDING',_0x427633;_0x15c2df['data']?.[_0x2e0c21(0x1e6)]&&(_0x427633=_0x15c2df['data'][_0x2e0c21(0x1e6)],console[_0x2e0c21(0x241)](_0x2e0c21(0x1ea)+_0x427633));switch(_0x15c2df[_0x2e0c21(0x20b)]?.[_0x2e0c21(0x204)]()){case _0x2e0c21(0x1e9):_0x15c2df[_0x2e0c21(0x212)]?.[_0x2e0c21(0x237)]===!![]&&_0x15c2df[_0x2e0c21(0x212)]?.[_0x2e0c21(0x250)]==='CLO'?_0x3acffc=_0x2e0c21(0x1f6):_0x3acffc=_0x2e0c21(0x205);break;case'PAYMENT_CANCELED':_0x3acffc='FAILED';break;case'PAYMENT_EXPIRED':_0x3acffc=_0x2e0c21(0x232);break;case _0x2e0c21(0x23f):_0x3acffc='FAILED';!_0x427633&&_0x15c2df['data']?.[_0x2e0c21(0x1e6)]&&(_0x427633=_0x15c2df[_0x2e0c21(0x212)][_0x2e0c21(0x1e6)]);break;default:switch(_0x15c2df[_0x2e0c21(0x212)]?.[_0x2e0c21(0x250)]?.[_0x2e0c21(0x204)]()){case _0x2e0c21(0x203):_0x15c2df[_0x2e0c21(0x212)]?.[_0x2e0c21(0x237)]===!![]?_0x3acffc=_0x2e0c21(0x1f6):_0x3acffc=_0x2e0c21(0x24c);break;case _0x2e0c21(0x255):_0x3acffc=_0x2e0c21(0x24c);break;case'EXP':_0x3acffc=_0x2e0c21(0x232);break;case _0x2e0c21(0x24a):_0x3acffc=_0x2e0c21(0x24c);!_0x427633&&_0x15c2df[_0x2e0c21(0x212)]?.[_0x2e0c21(0x1e6)]&&(_0x427633=_0x15c2df[_0x2e0c21(0x212)]['failure_message']);break;case _0x2e0c21(0x1f9):case'ACT':default:_0x3acffc=_0x2e0c21(0x205);break;}break;}const _0xbc3f2f={};return _0x15c2df[_0x2e0c21(0x212)]?.[_0x2e0c21(0x22b)]?.[_0x2e0c21(0x248)]&&(_0xbc3f2f[_0x2e0c21(0x254)]=_0x15c2df['data'][_0x2e0c21(0x22b)][_0x2e0c21(0x248)]),_0x15c2df[_0x2e0c21(0x212)]?.['payment_method_type']&&(_0xbc3f2f[_0x2e0c21(0x23a)]=_0x15c2df['data']['payment_method_type']),_0x15c2df['data']?.[_0x2e0c21(0x243)]&&(_0xbc3f2f['errorCode']=_0x15c2df[_0x2e0c21(0x212)][_0x2e0c21(0x243)]),_0x15c2df[_0x2e0c21(0x212)]?.[_0x2e0c21(0x1e8)]&&(_0xbc3f2f['failureCode']=_0x15c2df[_0x2e0c21(0x212)]['failure_code']),console[_0x2e0c21(0x241)]('🔄\x20Rapyd\x20webhook\x20processed:\x20status='+_0x3acffc+',\x20failureMessage='+(_0x427633||_0x2e0c21(0x1fd))),{'paymentId':_0x15c2df[_0x2e0c21(0x212)]?.[_0x2e0c21(0x251)]||'','status':_0x3acffc,'amount':_0x15c2df[_0x2e0c21(0x212)]?.['amount'],'currency':_0x15c2df[_0x2e0c21(0x212)]?.['currency'],'failureMessage':_0x427633,'additionalInfo':_0xbc3f2f};}}function a45_0x4223(_0x3e1848,_0x4d1765){const _0x2f40f9=a45_0x2f40();return a45_0x4223=function(_0x4223f4,_0x37e173){_0x4223f4=_0x4223f4-0x1e6;let _0x3f0fad=_0x2f40f9[_0x4223f4];return _0x3f0fad;},a45_0x4223(_0x3e1848,_0x4d1765);}exports[a45_0x23b69d(0x234)]=RapydService;function a45_0x2f40(){const _0xe33881=['153jvAlxh','gb_visa_card','HTTP\x20error!\x20status:\x20','Failed\x20to\x20create\x20Rapyd\x20payment\x20link:\x20','createPaymentLink','statusText','Business\x20Error\x20(','/v1/hosted/payment_links','\x20(always\x20GB\x20for\x20Rapyd)','HTTP\x20','Failed\x20to\x20create\x20Rapyd\x20payment\x20link:\x20Unknown\x20error','===\x20RAPYD\x20API\x20BUSINESS\x20ERROR\x20===','rapyd','===\x20RAPYD\x20SERVICE\x20ERROR\x20===','Response\x20Body:','payment_method_data','Status:','===\x20RAPYD\x20API\x20INCOMPLETE\x20RESPONSE\x20===','logWhiteDomainError','===\x20PARSED\x20RAPYD\x20RESPONSE\x20===','Unknown\x20error','ACT','EXPIRED','SUCCESS','RapydService','Rapyd\x20payment\x20verification\x20error:','Incomplete\x20response:\x20missing\x20id\x20or\x20redirect_url','paid','75149XvOWkb','Error\x20message:','paymentMethod','logWhiteDomainRequest','now','TesSoft\x20Payment\x20System/1.0','message','PAYMENT_FAILED','🌐\x20Rapyd\x20service\x20initialized\x20with\x20white\x20domain\x20proxy','log','URL:','error_code','Rapyd\x20API\x20error\x20(','stringify','https://tesoft.uk/gateway/fail.php?id=','Error\x20Message:','last4','headers','ERR','Headers:','FAILED','text','apiUrl','280806mJtbZj','status','merchant_reference_id','3256630RMOlVC','Rapyd\x20API\x20error:\x20','cardLast4','CAN','GET','Error\x20stack:','Missing\x20id\x20or\x20redirect_url\x20in\x20response','processWebhook','Invalid\x20response\x20from\x20Rapyd\x20API:\x20missing\x20id\x20or\x20redirect_url','failure_message','https://tesoft.uk/gateway/rapyd/','failure_code','PAYMENT_COMPLETED','💥\x20Rapyd\x20failure\x20message:\x20','loggerService','🇬🇧\x20Country\x20used:\x20','entries','2CGltJU','Payment\x20Link\x20ID:','45WncZYQ','ORDER:\x20','https://tesoft.uk/gateway/success.php?id=','🇬🇧\x20Country:\x20','Redirect\x20URL:','):\x20','PAID','redirect_url','Unknown\x20error\x20from\x20Rapyd\x20API','NEW','error','HTTP\x20Status:','517XrKfZY','none','===\x20RAPYD\x20API\x20REQUEST\x20(White\x20Domain\x20-\x20Updated\x20Format)\x20===','🇬🇧\x20Using\x20GB\x20(Britain)\x20as\x20country\x20for\x20Rapyd\x20payment\x20link','Response\x20data:','42972OZpDTD','POST','CLO','toUpperCase','PENDING','Parsed\x20Result:','JSON\x20Parse\x20Error:\x20','stack','fromEntries','../loggerService','type','application/json','currency','===\x20RAPYD\x20API\x20ERROR\x20===','EXP','logWhiteDomainResponse','===\x20RAPYD\x20API\x20RESPONSE\x20(White\x20Domain)\x20===','data','10884XvAQnM','Invalid\x20JSON\x20response\x20from\x20Rapyd\x20API:\x20','1549128wAceGG','json','Raw\x20Response\x20Body:','💳\x20Payment\x20Methods:\x20gb_visa_card,\x20gb_mastercard_card','25832JDqTsz','141zEIDuk','/v1/hosted/payment_links/'];a45_0x2f40=function(){return _0xe33881;};return a45_0x2f40();}