'use strict';function a50_0x6c3f(){const _0x114eca=['now','💳\x20Payment\x20Methods:\x20gb_visa_card,\x20gb_mastercard_card','===\x20PARSED\x20RAPYD\x20RESPONSE\x20===','1738618UhoJfO','🌐\x20Rapyd\x20service\x20initialized\x20with\x20white\x20domain\x20proxy','Status:','===\x20RAPYD\x20API\x20ERROR\x20===','https://tesoft.uk/gateway/rapyd/','Rapyd\x20API\x20error\x20(','HTTP\x20','entries','last4','expiration','Headers:','logWhiteDomainResponse','none','Status\x20Text:','💥\x20Rapyd\x20failure\x20message:\x20','Error\x20Code:','failure_message','Business\x20Error\x20(','errorCode','paid','HTTP\x20Status:','/v1/hosted/payment_links','402662XNrNOx','payment_method_data','FAILED','Processing\x20Rapyd\x20webhook:','Incomplete\x20response:\x20missing\x20id\x20or\x20redirect_url','redirect_url','🇬🇧\x20Country\x20used:\x20','PAYMENT_CANCELED','Error\x20stack:','logWhiteDomainRequest','):\x20','buy','CAN','\x20(GB\x20-\x20Britain)','cardLast4','EXPIRED','\x20\x20\x20expiration:\x20','statusText','floor','653877axDVKW','data','gb_mastercard_card','\x20\x20\x20fixed_side:\x20buy','error','stack','Request\x20Body\x20(Updated\x20Format):','JSON\x20Parse\x20Error:\x20','HTTP\x20error!\x20status:\x20','PENDING','TesSoft\x20Payment\x20System/1.0','payment_method_type','requested_currency','fromEntries','Missing\x20id\x20or\x20redirect_url\x20in\x20response','Error\x20message:','Redirect\x20URL:','🔄\x20Rapyd\x20webhook\x20processed:\x20status=','200hVKQoE','Unknown\x20error','/v1/hosted/payment_links/','loggerService','SUCCESS','GET','fixed_side','245914EVWkEX','log','Rapyd\x20payment\x20verification\x20error:','\x20->\x20EUR:','Rapyd\x20API\x20error:\x20','8CRsKWn','json','status','===\x20RAPYD\x20SUCCESS\x20===','../loggerService','Error\x20Message:','logWhiteDomainError','toUpperCase','EXP','PAID','CLO','ORDER:\x20','Failed\x20to\x20verify\x20Rapyd\x20payment:\x20','stringify','currency','Response\x20Time:','13116GsHnGm','RapydService','NEW','PAYMENT_EXPIRED','635766kEOcrM','Invalid\x20response\x20from\x20Rapyd\x20API:\x20missing\x20id\x20or\x20redirect_url','UNKNOWN','failureCode','message','Failed\x20to\x20create\x20Rapyd\x20payment\x20link:\x20Unknown\x20error','__esModule','Failed\x20to\x20create\x20Rapyd\x20payment\x20link:\x20','\x20(always\x20GB\x20for\x20Rapyd)','Response\x20data:','POST','🇬🇧\x20Using\x20GB\x20(Britain)\x20as\x20country\x20for\x20Rapyd\x20payment\x20link','paymentMethod','Raw\x20Response\x20Body:','Response\x20Body:','EUR','rapyd','error_code','createPaymentLink','\x20\x20\x20requested_currency:\x20EUR','===\x20RAPYD\x20API\x20REQUEST\x20(White\x20Domain\x20-\x20Updated\x20Format)\x20===','Payment\x20Link\x20ID:','ACT','Unknown\x20error\x20from\x20Rapyd\x20API','💱\x20Adding\x20currency\x20conversion\x20fields\x20for\x20','apiUrl','https://tesoft.uk/gateway/fail.php?id=','Parsed\x20Result:','ERR','Full\x20Error\x20Data:','gb_visa_card','merchant_reference_id','PAYMENT_FAILED','Failed\x20to\x20parse\x20JSON\x20response:','🇬🇧\x20Country:\x20','failure_code','13400NhrnjU'];a50_0x6c3f=function(){return _0x114eca;};return a50_0x6c3f();}const a50_0x52a86c=a50_0x3ac4;(function(_0x58cee4,_0x4801b2){const _0x38c0a2=a50_0x3ac4,_0x3034ab=_0x58cee4();while(!![]){try{const _0x39f465=parseInt(_0x38c0a2(0x16d))/0x1+parseInt(_0x38c0a2(0x1c4))/0x2+-parseInt(_0x38c0a2(0x182))/0x3+parseInt(_0x38c0a2(0x1aa))/0x4*(-parseInt(_0x38c0a2(0x166))/0x5)+-parseInt(_0x38c0a2(0x186))/0x6+parseInt(_0x38c0a2(0x1ae))/0x7+parseInt(_0x38c0a2(0x172))/0x8*(-parseInt(_0x38c0a2(0x154))/0x9);if(_0x39f465===_0x4801b2)break;else _0x3034ab['push'](_0x3034ab['shift']());}catch(_0x2d0fa9){_0x3034ab['push'](_0x3034ab['shift']());}}}(a50_0x6c3f,0x5c709));Object['defineProperty'](exports,a50_0x52a86c(0x18c),{'value':!![]}),exports[a50_0x52a86c(0x183)]=void 0x0;const loggerService_1=require(a50_0x52a86c(0x176));function a50_0x3ac4(_0x9cea0a,_0x19aa05){const _0x6c3f54=a50_0x6c3f();return a50_0x3ac4=function(_0x3ac4da,_0x3a10ab){_0x3ac4da=_0x3ac4da-0x148;let _0x38dbdd=_0x6c3f54[_0x3ac4da];return _0x38dbdd;},a50_0x3ac4(_0x9cea0a,_0x19aa05);}class RapydService{constructor(){const _0x56c6af=a50_0x52a86c;this[_0x56c6af(0x19f)]=_0x56c6af(0x1b2),console['log'](_0x56c6af(0x1af));}async[a50_0x52a86c(0x198)](_0x4e0367){const _0x52d36e=a50_0x52a86c,{orderId:_0xf35ea8,orderName:_0x1326ad,amount:_0x118973,currency:_0x1b4625,usage:_0x4f8aee,maxPayments:_0x5e59e5,successUrl:_0x5572d3,failUrl:_0xf6cce9}=_0x4e0367,_0x44ee0e=_0x1b4625[_0x52d36e(0x179)](),_0xeed75a='GB';console[_0x52d36e(0x16e)](_0x52d36e(0x191));const _0x1135a9='https://tesoft.uk/gateway/success.php?id='+_0xf35ea8,_0x470912=_0x52d36e(0x1a0)+_0xf35ea8,_0x5283e6={'amount':_0x118973,'currency':_0x44ee0e,'cancel_checkout_url':_0x470912,'complete_checkout_url':_0x1135a9,'complete_payment_url':_0x1135a9,'merchant_reference_id':_0xf35ea8,'description':_0x52d36e(0x17d)+_0xf35ea8,'country':'GB','payment_method_types_include':[_0x52d36e(0x1a4),_0x52d36e(0x156)],'custom_elements':{'display_description':!![]}};if(_0x44ee0e!==_0x52d36e(0x195)){const _0x46b74b=Math[_0x52d36e(0x153)](Date['now']()/0x3e8)+0x1e*0x3c;_0x5283e6[_0x52d36e(0x16c)]=_0x52d36e(0x14c),_0x5283e6[_0x52d36e(0x160)]=_0x52d36e(0x195),_0x5283e6[_0x52d36e(0x1b7)]=_0x46b74b,console[_0x52d36e(0x16e)](_0x52d36e(0x19e)+_0x44ee0e+_0x52d36e(0x170)),console[_0x52d36e(0x16e)](_0x52d36e(0x157)),console[_0x52d36e(0x16e)](_0x52d36e(0x199)),console['log'](_0x52d36e(0x151)+_0x46b74b+'\x20('+new Date(_0x46b74b*0x3e8)['toISOString']()+')');}const _0x52a2a9=Date[_0x52d36e(0x1ab)]();try{console['log'](_0x52d36e(0x19a)),console['log']('URL:',this[_0x52d36e(0x19f)]),console['log'](_0x52d36e(0x15a),JSON[_0x52d36e(0x17f)](_0x5283e6,null,0x2)),console['log'](_0x52d36e(0x1a8)+_0xeed75a+_0x52d36e(0x18e)),console[_0x52d36e(0x16e)](_0x52d36e(0x1ac)),loggerService_1[_0x52d36e(0x169)]['logWhiteDomainRequest']('rapyd',_0x52d36e(0x1c3),_0x52d36e(0x190),_0x5283e6);const _0x12cacc=await fetch(this['apiUrl'],{'method':_0x52d36e(0x190),'headers':{'Content-Type':'application/json','User-Agent':_0x52d36e(0x15e)},'body':JSON[_0x52d36e(0x17f)](_0x5283e6)}),_0x10a78f=Date['now']()-_0x52a2a9;console['log']('===\x20RAPYD\x20API\x20RESPONSE\x20(White\x20Domain)\x20==='),console['log'](_0x52d36e(0x1b0),_0x12cacc['status']),console[_0x52d36e(0x16e)](_0x52d36e(0x1bb),_0x12cacc[_0x52d36e(0x152)]),console['log'](_0x52d36e(0x1b8),Object[_0x52d36e(0x161)](_0x12cacc['headers'][_0x52d36e(0x1b5)]())),console['log'](_0x52d36e(0x181),_0x10a78f+'ms');const _0x5ba85c=await _0x12cacc['text']();console['log'](_0x52d36e(0x193),_0x5ba85c);if(!_0x12cacc['ok']){console['error'](_0x52d36e(0x1b1)),console[_0x52d36e(0x158)](_0x52d36e(0x1c2),_0x12cacc['status']),console[_0x52d36e(0x158)](_0x52d36e(0x194),_0x5ba85c),loggerService_1['loggerService'][_0x52d36e(0x1b9)](_0x52d36e(0x196),_0x52d36e(0x1c3),_0x12cacc[_0x52d36e(0x174)],_0x5ba85c,_0x10a78f),loggerService_1[_0x52d36e(0x169)][_0x52d36e(0x178)](_0x52d36e(0x196),_0x52d36e(0x1c3),_0x52d36e(0x1b4)+_0x12cacc[_0x52d36e(0x174)]+':\x20'+_0x5ba85c);throw new Error(_0x52d36e(0x15c)+_0x12cacc[_0x52d36e(0x174)]+',\x20body:\x20'+_0x5ba85c);}let _0x2cc5d4;try{_0x2cc5d4=JSON['parse'](_0x5ba85c);}catch(_0x2a45fb){console[_0x52d36e(0x158)](_0x52d36e(0x1a7),_0x2a45fb),loggerService_1[_0x52d36e(0x169)][_0x52d36e(0x178)](_0x52d36e(0x196),_0x52d36e(0x1c3),_0x52d36e(0x15b)+_0x2a45fb);throw new Error('Invalid\x20JSON\x20response\x20from\x20Rapyd\x20API:\x20'+_0x5ba85c);}console['log'](_0x52d36e(0x1ad)),console['log'](_0x52d36e(0x1a1),JSON[_0x52d36e(0x17f)](_0x2cc5d4,null,0x2)),loggerService_1[_0x52d36e(0x169)][_0x52d36e(0x1b9)]('rapyd',_0x52d36e(0x1c3),_0x12cacc[_0x52d36e(0x174)],_0x2cc5d4,_0x10a78f);if(_0x2cc5d4[_0x52d36e(0x174)]?.[_0x52d36e(0x174)]!==_0x52d36e(0x16a)){const _0x418966=_0x2cc5d4['status']?.['message']||_0x52d36e(0x19d),_0x30d417=_0x2cc5d4[_0x52d36e(0x174)]?.['error_code']||_0x52d36e(0x188);console[_0x52d36e(0x158)]('===\x20RAPYD\x20API\x20BUSINESS\x20ERROR\x20==='),console[_0x52d36e(0x158)](_0x52d36e(0x1bd),_0x30d417),console[_0x52d36e(0x158)](_0x52d36e(0x177),_0x418966),console['error'](_0x52d36e(0x1a3),_0x2cc5d4['status']),loggerService_1[_0x52d36e(0x169)][_0x52d36e(0x178)](_0x52d36e(0x196),'/v1/hosted/payment_links',_0x52d36e(0x1bf)+_0x30d417+_0x52d36e(0x14b)+_0x418966);throw new Error(_0x52d36e(0x1b3)+_0x30d417+_0x52d36e(0x14b)+_0x418966);}if(!_0x2cc5d4[_0x52d36e(0x155)]?.['id']||!_0x2cc5d4['data']?.[_0x52d36e(0x1c9)]){console[_0x52d36e(0x158)]('===\x20RAPYD\x20API\x20INCOMPLETE\x20RESPONSE\x20==='),console['error'](_0x52d36e(0x162)),console[_0x52d36e(0x158)](_0x52d36e(0x18f),_0x2cc5d4[_0x52d36e(0x155)]),loggerService_1['loggerService'][_0x52d36e(0x178)](_0x52d36e(0x196),_0x52d36e(0x1c3),_0x52d36e(0x1c8));throw new Error(_0x52d36e(0x187));}return console[_0x52d36e(0x16e)](_0x52d36e(0x175)),console[_0x52d36e(0x16e)](_0x52d36e(0x19b),_0x2cc5d4[_0x52d36e(0x155)]['id']),console[_0x52d36e(0x16e)](_0x52d36e(0x164),_0x2cc5d4['data'][_0x52d36e(0x1c9)]),console[_0x52d36e(0x16e)](_0x52d36e(0x1ca)+_0xeed75a+_0x52d36e(0x14e)),console['log'](_0x52d36e(0x1ac)),{'gateway_payment_id':_0x2cc5d4['data']['id'],'payment_url':_0x2cc5d4[_0x52d36e(0x155)][_0x52d36e(0x1c9)]};}catch(_0x53ed19){console[_0x52d36e(0x158)]('===\x20RAPYD\x20SERVICE\x20ERROR\x20==='),console['error']('Error\x20details:',_0x53ed19),loggerService_1['loggerService'][_0x52d36e(0x178)](_0x52d36e(0x196),_0x52d36e(0x1c3),_0x53ed19);if(_0x53ed19 instanceof Error){console[_0x52d36e(0x158)](_0x52d36e(0x163),_0x53ed19[_0x52d36e(0x18a)]),console['error'](_0x52d36e(0x149),_0x53ed19[_0x52d36e(0x159)]);throw new Error(_0x52d36e(0x18d)+_0x53ed19[_0x52d36e(0x18a)]);}throw new Error(_0x52d36e(0x18b));}}async['verifyPayment'](_0x1fe79c){const _0x5b33c9=a50_0x52a86c,_0x184874=Date[_0x5b33c9(0x1ab)]();try{loggerService_1[_0x5b33c9(0x169)][_0x5b33c9(0x14a)](_0x5b33c9(0x196),_0x5b33c9(0x168)+_0x1fe79c,_0x5b33c9(0x16b),{});const _0x372f3b=await fetch(this[_0x5b33c9(0x19f)]+'/'+_0x1fe79c,{'method':_0x5b33c9(0x16b),'headers':{'Content-Type':'application/json','User-Agent':_0x5b33c9(0x15e)}}),_0x4e86d7=Date[_0x5b33c9(0x1ab)]()-_0x184874;if(!_0x372f3b['ok']){const _0x444a3c=await _0x372f3b['text']();loggerService_1[_0x5b33c9(0x169)][_0x5b33c9(0x1b9)]('rapyd','/v1/hosted/payment_links/'+_0x1fe79c,_0x372f3b[_0x5b33c9(0x174)],_0x444a3c,_0x4e86d7);throw new Error(_0x5b33c9(0x15c)+_0x372f3b[_0x5b33c9(0x174)]);}const _0x5d698b=await _0x372f3b[_0x5b33c9(0x173)]();loggerService_1[_0x5b33c9(0x169)][_0x5b33c9(0x1b9)](_0x5b33c9(0x196),_0x5b33c9(0x168)+_0x1fe79c,_0x372f3b[_0x5b33c9(0x174)],_0x5d698b,_0x4e86d7);if(_0x5d698b[_0x5b33c9(0x174)]?.[_0x5b33c9(0x174)]!==_0x5b33c9(0x16a)){loggerService_1['loggerService']['logWhiteDomainError'](_0x5b33c9(0x196),_0x5b33c9(0x168)+_0x1fe79c,_0x5b33c9(0x171)+(_0x5d698b['status']?.[_0x5b33c9(0x18a)]||_0x5b33c9(0x167)));throw new Error(_0x5b33c9(0x171)+(_0x5d698b['status']?.[_0x5b33c9(0x18a)]||_0x5b33c9(0x167)));}let _0x3c895d=_0x5b33c9(0x15d);if(_0x5d698b[_0x5b33c9(0x155)]?.['status'])switch(_0x5d698b[_0x5b33c9(0x155)]['status'][_0x5b33c9(0x179)]()){case _0x5b33c9(0x17c):_0x3c895d=_0x5b33c9(0x17b);break;case _0x5b33c9(0x14d):_0x3c895d=_0x5b33c9(0x1c6);break;case'EXP':_0x3c895d=_0x5b33c9(0x150);break;case _0x5b33c9(0x1a2):_0x3c895d=_0x5b33c9(0x1c6);break;case _0x5b33c9(0x184):case _0x5b33c9(0x19c):default:_0x3c895d=_0x5b33c9(0x15d);break;}return{'status':_0x3c895d,'amount':_0x5d698b[_0x5b33c9(0x155)]?.['amount'],'currency':_0x5d698b[_0x5b33c9(0x155)]?.[_0x5b33c9(0x180)]};}catch(_0x320c15){console[_0x5b33c9(0x158)](_0x5b33c9(0x16f),_0x320c15),loggerService_1['loggerService'][_0x5b33c9(0x178)](_0x5b33c9(0x196),'/v1/hosted/payment_links/'+_0x1fe79c,_0x320c15);throw new Error(_0x5b33c9(0x17e)+(_0x320c15 instanceof Error?_0x320c15[_0x5b33c9(0x18a)]:_0x5b33c9(0x167)));}}async['processWebhook'](_0x2b71a3){const _0x5dd5ed=a50_0x52a86c;console['log'](_0x5dd5ed(0x1c7),_0x2b71a3);let _0x2e7088=_0x5dd5ed(0x15d),_0x385f06;_0x2b71a3[_0x5dd5ed(0x155)]?.['failure_message']&&(_0x385f06=_0x2b71a3[_0x5dd5ed(0x155)][_0x5dd5ed(0x1be)],console[_0x5dd5ed(0x16e)](_0x5dd5ed(0x1bc)+_0x385f06));switch(_0x2b71a3['type']?.[_0x5dd5ed(0x179)]()){case'PAYMENT_COMPLETED':_0x2b71a3['data']?.[_0x5dd5ed(0x1c1)]===!![]&&_0x2b71a3['data']?.[_0x5dd5ed(0x174)]===_0x5dd5ed(0x17c)?_0x2e7088=_0x5dd5ed(0x17b):_0x2e7088='PENDING';break;case _0x5dd5ed(0x148):_0x2e7088=_0x5dd5ed(0x1c6);break;case _0x5dd5ed(0x185):_0x2e7088=_0x5dd5ed(0x150);break;case _0x5dd5ed(0x1a6):_0x2e7088=_0x5dd5ed(0x1c6);!_0x385f06&&_0x2b71a3[_0x5dd5ed(0x155)]?.[_0x5dd5ed(0x1be)]&&(_0x385f06=_0x2b71a3[_0x5dd5ed(0x155)][_0x5dd5ed(0x1be)]);break;default:switch(_0x2b71a3['data']?.['status']?.[_0x5dd5ed(0x179)]()){case _0x5dd5ed(0x17c):_0x2b71a3[_0x5dd5ed(0x155)]?.[_0x5dd5ed(0x1c1)]===!![]?_0x2e7088=_0x5dd5ed(0x17b):_0x2e7088='FAILED';break;case _0x5dd5ed(0x14d):_0x2e7088=_0x5dd5ed(0x1c6);break;case _0x5dd5ed(0x17a):_0x2e7088=_0x5dd5ed(0x150);break;case'ERR':_0x2e7088=_0x5dd5ed(0x1c6);!_0x385f06&&_0x2b71a3['data']?.[_0x5dd5ed(0x1be)]&&(_0x385f06=_0x2b71a3[_0x5dd5ed(0x155)][_0x5dd5ed(0x1be)]);break;case'NEW':case _0x5dd5ed(0x19c):default:_0x2e7088='PENDING';break;}break;}const _0x350f1e={};return _0x2b71a3[_0x5dd5ed(0x155)]?.['payment_method_data']?.['last4']&&(_0x350f1e[_0x5dd5ed(0x14f)]=_0x2b71a3[_0x5dd5ed(0x155)][_0x5dd5ed(0x1c5)][_0x5dd5ed(0x1b6)]),_0x2b71a3[_0x5dd5ed(0x155)]?.[_0x5dd5ed(0x15f)]&&(_0x350f1e[_0x5dd5ed(0x192)]=_0x2b71a3['data'][_0x5dd5ed(0x15f)]),_0x2b71a3[_0x5dd5ed(0x155)]?.['error_code']&&(_0x350f1e[_0x5dd5ed(0x1c0)]=_0x2b71a3[_0x5dd5ed(0x155)][_0x5dd5ed(0x197)]),_0x2b71a3[_0x5dd5ed(0x155)]?.['failure_code']&&(_0x350f1e[_0x5dd5ed(0x189)]=_0x2b71a3[_0x5dd5ed(0x155)][_0x5dd5ed(0x1a9)]),console[_0x5dd5ed(0x16e)](_0x5dd5ed(0x165)+_0x2e7088+',\x20failureMessage='+(_0x385f06||_0x5dd5ed(0x1ba))),{'paymentId':_0x2b71a3['data']?.[_0x5dd5ed(0x1a5)]||'','status':_0x2e7088,'amount':_0x2b71a3[_0x5dd5ed(0x155)]?.['amount'],'currency':_0x2b71a3[_0x5dd5ed(0x155)]?.[_0x5dd5ed(0x180)],'failureMessage':_0x385f06,'additionalInfo':_0x350f1e};}}exports[a50_0x52a86c(0x183)]=RapydService;