'use strict';const a42_0x47a53e=a42_0x2bad;function a42_0x56f4(){const _0x49cef8=['üá¨üáß\x20Using\x20GB\x20(Britain)\x20as\x20country\x20for\x20Rapyd\x20payment\x20link','===\x20PARSED\x20RAPYD\x20RESPONSE\x20===','../loggerService',',\x20failureMessage=','entries','\x20(GB\x20-\x20Britain)','headers','merchant_reference_id','currency','Rapyd\x20API\x20error\x20(','fromEntries','logWhiteDomainRequest','RapydService','===\x20RAPYD\x20SUCCESS\x20===','):\x20','verifyPayment','3134760CzpSDk','gb_mastercard_card','error_code','PAYMENT_FAILED','Error\x20message:','ACT','logWhiteDomainError','error','Unknown\x20error','toUpperCase','POST','Error\x20Message:','14aTjcsD','6082695RIAJTH','üá¨üáß\x20Country\x20used:\x20','PAID','Error\x20details:','EXPIRED','Invalid\x20JSON\x20response\x20from\x20Rapyd\x20API:\x20','HTTP\x20error!\x20status:\x20','ERR','12nUwfzW','Headers:','failure_message','/v1/hosted/payment_links/','===\x20RAPYD\x20API\x20RESPONSE\x20(White\x20Domain)\x20===','132Wfjjvd','failureCode','SUCCESS','268850MJUeHi','payment_method_data','JSON\x20Parse\x20Error:\x20','URL:','now','286227xBSYEe','data','ORDER:\x20','Full\x20Error\x20Data:','paymentMethod','üí≥\x20Payment\x20Methods:\x20gb_visa_card,\x20gb_mastercard_card','failure_code','8ycDedD','Raw\x20Response\x20Body:','loggerService','962720ChcvhB','type','Processing\x20Rapyd\x20webhook:','statusText','message','Unknown\x20error\x20from\x20Rapyd\x20API','üí•\x20Rapyd\x20failure\x20message:\x20','Error\x20stack:','Parsed\x20Result:','Request\x20Body\x20(Updated\x20Format):','text','https://tesoft.uk/gateway/fail.php?id=','FAILED','NEW','parse','https://tesoft.uk/gateway/rapyd/','Invalid\x20response\x20from\x20Rapyd\x20API:\x20missing\x20id\x20or\x20redirect_url','CLO',',\x20body:\x20','last4','status','Status:','702135QGqxRU','stringify','GET','defineProperty','log','Failed\x20to\x20parse\x20JSON\x20response:','stack','application/json','logWhiteDomainResponse','UNKNOWN','PENDING','amount','processWebhook','/v1/hosted/payment_links','json','PAYMENT_EXPIRED','Rapyd\x20API\x20error:\x20','Payment\x20Link\x20ID:','Response\x20data:','apiUrl','CAN','paid','EXP','redirect_url','Incomplete\x20response:\x20missing\x20id\x20or\x20redirect_url','Failed\x20to\x20create\x20Rapyd\x20payment\x20link:\x20Unknown\x20error','rapyd','Missing\x20id\x20or\x20redirect_url\x20in\x20response','PAYMENT_CANCELED','createPaymentLink','TesSoft\x20Payment\x20System/1.0','HTTP\x20Status:','gb_visa_card','Error\x20Code:','errorCode','üåê\x20Rapyd\x20service\x20initialized\x20with\x20white\x20domain\x20proxy','Status\x20Text:','===\x20RAPYD\x20API\x20BUSINESS\x20ERROR\x20===','Failed\x20to\x20verify\x20Rapyd\x20payment:\x20','payment_method_type','HTTP\x20','2192496cOCNXx','https://tesoft.uk/gateway/success.php?id=','Response\x20Time:'];a42_0x56f4=function(){return _0x49cef8;};return a42_0x56f4();}(function(_0x124f97,_0x129b64){const _0x2c7501=a42_0x2bad,_0x53f3d6=_0x124f97();while(!![]){try{const _0x26ac3d=-parseInt(_0x2c7501(0xde))/0x1+parseInt(_0x2c7501(0xb2))/0x2+parseInt(_0x2c7501(0xd4))/0x3*(parseInt(_0x2c7501(0xc7))/0x4)+-parseInt(_0x2c7501(0xbf))/0x5+-parseInt(_0x2c7501(0x11d))/0x6*(-parseInt(_0x2c7501(0xbe))/0x7)+parseInt(_0x2c7501(0xdb))/0x8*(parseInt(_0x2c7501(0xf4))/0x9)+-parseInt(_0x2c7501(0xcf))/0xa*(-parseInt(_0x2c7501(0xcc))/0xb);if(_0x26ac3d===_0x129b64)break;else _0x53f3d6['push'](_0x53f3d6['shift']());}catch(_0x584916){_0x53f3d6['push'](_0x53f3d6['shift']());}}}(a42_0x56f4,0xc4bb7));Object[a42_0x47a53e(0xf7)](exports,'__esModule',{'value':!![]}),exports[a42_0x47a53e(0xae)]=void 0x0;const loggerService_1=require(a42_0x47a53e(0x122));class RapydService{constructor(){const _0x2fa4cb=a42_0x47a53e;this[_0x2fa4cb(0x107)]=_0x2fa4cb(0xed),console['log'](_0x2fa4cb(0x117));}async[a42_0x47a53e(0x111)](_0x47b32a){const _0x2d8299=a42_0x47a53e,{orderId:_0x1c29a8,orderName:_0x4d0000,amount:_0x3ef2cb,currency:_0x277dd3,usage:_0x1b0479,maxPayments:_0x2921dd,successUrl:_0x3fc225,failUrl:_0x385225}=_0x47b32a,_0x3d1e4d=_0x277dd3[_0x2d8299(0xbb)](),_0x14da60='GB';console[_0x2d8299(0xf8)](_0x2d8299(0x120));const _0xf8c1ba=_0x2d8299(0x11e)+_0x1c29a8,_0xb07ca6=_0x2d8299(0xe9)+_0x1c29a8,_0x2d85d1={'amount':_0x3ef2cb,'currency':_0x3d1e4d,'cancel_checkout_url':_0xb07ca6,'complete_checkout_url':_0xf8c1ba,'complete_payment_url':_0xf8c1ba,'merchant_reference_id':_0x1c29a8,'description':_0x2d8299(0xd6)+_0x1c29a8,'country':'GB','payment_method_types_include':[_0x2d8299(0x114),_0x2d8299(0xb3)],'custom_elements':{'display_description':!![]}},_0x3267b6=Date[_0x2d8299(0xd3)]();try{console[_0x2d8299(0xf8)]('===\x20RAPYD\x20API\x20REQUEST\x20(White\x20Domain\x20-\x20Updated\x20Format)\x20==='),console[_0x2d8299(0xf8)](_0x2d8299(0xd2),this[_0x2d8299(0x107)]),console[_0x2d8299(0xf8)](_0x2d8299(0xe7),JSON[_0x2d8299(0xf5)](_0x2d85d1,null,0x2)),console['log']('üá¨üáß\x20Country:\x20'+_0x14da60+'\x20(always\x20GB\x20for\x20Rapyd)'),console[_0x2d8299(0xf8)](_0x2d8299(0xd9)),loggerService_1[_0x2d8299(0xdd)]['logWhiteDomainRequest'](_0x2d8299(0x10e),'/v1/hosted/payment_links',_0x2d8299(0xbc),_0x2d85d1);const _0x455374=await fetch(this['apiUrl'],{'method':'POST','headers':{'Content-Type':_0x2d8299(0xfb),'User-Agent':_0x2d8299(0x112)},'body':JSON[_0x2d8299(0xf5)](_0x2d85d1)}),_0x4b74bd=Date[_0x2d8299(0xd3)]()-_0x3267b6;console['log'](_0x2d8299(0xcb)),console[_0x2d8299(0xf8)](_0x2d8299(0xf3),_0x455374['status']),console[_0x2d8299(0xf8)](_0x2d8299(0x118),_0x455374[_0x2d8299(0xe1)]),console['log'](_0x2d8299(0xc8),Object[_0x2d8299(0xac)](_0x455374[_0x2d8299(0xa8)][_0x2d8299(0xa6)]())),console['log'](_0x2d8299(0x11f),_0x4b74bd+'ms');const _0x4adca2=await _0x455374['text']();console[_0x2d8299(0xf8)](_0x2d8299(0xdc),_0x4adca2);if(!_0x455374['ok']){console[_0x2d8299(0xb9)]('===\x20RAPYD\x20API\x20ERROR\x20==='),console['error'](_0x2d8299(0x113),_0x455374['status']),console[_0x2d8299(0xb9)]('Response\x20Body:',_0x4adca2),loggerService_1['loggerService']['logWhiteDomainResponse'](_0x2d8299(0x10e),_0x2d8299(0x101),_0x455374[_0x2d8299(0xf2)],_0x4adca2,_0x4b74bd),loggerService_1[_0x2d8299(0xdd)][_0x2d8299(0xb8)](_0x2d8299(0x10e),_0x2d8299(0x101),_0x2d8299(0x11c)+_0x455374[_0x2d8299(0xf2)]+':\x20'+_0x4adca2);throw new Error(_0x2d8299(0xc5)+_0x455374[_0x2d8299(0xf2)]+_0x2d8299(0xf0)+_0x4adca2);}let _0xec1cad;try{_0xec1cad=JSON[_0x2d8299(0xec)](_0x4adca2);}catch(_0x371c66){console[_0x2d8299(0xb9)](_0x2d8299(0xf9),_0x371c66),loggerService_1[_0x2d8299(0xdd)][_0x2d8299(0xb8)](_0x2d8299(0x10e),_0x2d8299(0x101),_0x2d8299(0xd1)+_0x371c66);throw new Error(_0x2d8299(0xc4)+_0x4adca2);}console[_0x2d8299(0xf8)](_0x2d8299(0x121)),console[_0x2d8299(0xf8)](_0x2d8299(0xe6),JSON['stringify'](_0xec1cad,null,0x2)),loggerService_1[_0x2d8299(0xdd)][_0x2d8299(0xfc)](_0x2d8299(0x10e),_0x2d8299(0x101),_0x455374['status'],_0xec1cad,_0x4b74bd);if(_0xec1cad[_0x2d8299(0xf2)]?.[_0x2d8299(0xf2)]!==_0x2d8299(0xce)){const _0xe5c027=_0xec1cad['status']?.[_0x2d8299(0xe2)]||_0x2d8299(0xe3),_0x39ca06=_0xec1cad[_0x2d8299(0xf2)]?.[_0x2d8299(0xb4)]||_0x2d8299(0xfd);console[_0x2d8299(0xb9)](_0x2d8299(0x119)),console['error'](_0x2d8299(0x115),_0x39ca06),console[_0x2d8299(0xb9)](_0x2d8299(0xbd),_0xe5c027),console[_0x2d8299(0xb9)](_0x2d8299(0xd7),_0xec1cad[_0x2d8299(0xf2)]),loggerService_1[_0x2d8299(0xdd)][_0x2d8299(0xb8)]('rapyd','/v1/hosted/payment_links','Business\x20Error\x20('+_0x39ca06+_0x2d8299(0xb0)+_0xe5c027);throw new Error(_0x2d8299(0xab)+_0x39ca06+'):\x20'+_0xe5c027);}if(!_0xec1cad['data']?.['id']||!_0xec1cad['data']?.[_0x2d8299(0x10b)]){console[_0x2d8299(0xb9)]('===\x20RAPYD\x20API\x20INCOMPLETE\x20RESPONSE\x20==='),console['error'](_0x2d8299(0x10f)),console[_0x2d8299(0xb9)](_0x2d8299(0x106),_0xec1cad[_0x2d8299(0xd5)]),loggerService_1[_0x2d8299(0xdd)][_0x2d8299(0xb8)]('rapyd',_0x2d8299(0x101),_0x2d8299(0x10c));throw new Error(_0x2d8299(0xee));}return console[_0x2d8299(0xf8)](_0x2d8299(0xaf)),console['log'](_0x2d8299(0x105),_0xec1cad['data']['id']),console[_0x2d8299(0xf8)]('Redirect\x20URL:',_0xec1cad['data'][_0x2d8299(0x10b)]),console[_0x2d8299(0xf8)](_0x2d8299(0xc0)+_0x14da60+_0x2d8299(0xa7)),console[_0x2d8299(0xf8)](_0x2d8299(0xd9)),{'gateway_payment_id':_0xec1cad['data']['id'],'payment_url':_0xec1cad[_0x2d8299(0xd5)][_0x2d8299(0x10b)]};}catch(_0x1a9805){console[_0x2d8299(0xb9)]('===\x20RAPYD\x20SERVICE\x20ERROR\x20==='),console[_0x2d8299(0xb9)](_0x2d8299(0xc2),_0x1a9805),loggerService_1[_0x2d8299(0xdd)][_0x2d8299(0xb8)](_0x2d8299(0x10e),'/v1/hosted/payment_links',_0x1a9805);if(_0x1a9805 instanceof Error){console['error'](_0x2d8299(0xb6),_0x1a9805[_0x2d8299(0xe2)]),console[_0x2d8299(0xb9)](_0x2d8299(0xe5),_0x1a9805[_0x2d8299(0xfa)]);throw new Error('Failed\x20to\x20create\x20Rapyd\x20payment\x20link:\x20'+_0x1a9805[_0x2d8299(0xe2)]);}throw new Error(_0x2d8299(0x10d));}}async[a42_0x47a53e(0xb1)](_0x4398fa){const _0x347415=a42_0x47a53e,_0x1a2c7c=Date['now']();try{loggerService_1['loggerService'][_0x347415(0xad)](_0x347415(0x10e),_0x347415(0xca)+_0x4398fa,_0x347415(0xf6),{});const _0x5bd12e=await fetch(this['apiUrl']+'/'+_0x4398fa,{'method':_0x347415(0xf6),'headers':{'Content-Type':_0x347415(0xfb),'User-Agent':_0x347415(0x112)}}),_0x494beb=Date[_0x347415(0xd3)]()-_0x1a2c7c;if(!_0x5bd12e['ok']){const _0xb4d86=await _0x5bd12e[_0x347415(0xe8)]();loggerService_1['loggerService'][_0x347415(0xfc)](_0x347415(0x10e),_0x347415(0xca)+_0x4398fa,_0x5bd12e[_0x347415(0xf2)],_0xb4d86,_0x494beb);throw new Error(_0x347415(0xc5)+_0x5bd12e[_0x347415(0xf2)]);}const _0x2aa700=await _0x5bd12e[_0x347415(0x102)]();loggerService_1[_0x347415(0xdd)][_0x347415(0xfc)](_0x347415(0x10e),_0x347415(0xca)+_0x4398fa,_0x5bd12e[_0x347415(0xf2)],_0x2aa700,_0x494beb);if(_0x2aa700[_0x347415(0xf2)]?.[_0x347415(0xf2)]!==_0x347415(0xce)){loggerService_1[_0x347415(0xdd)][_0x347415(0xb8)](_0x347415(0x10e),_0x347415(0xca)+_0x4398fa,_0x347415(0x104)+(_0x2aa700[_0x347415(0xf2)]?.['message']||_0x347415(0xba)));throw new Error(_0x347415(0x104)+(_0x2aa700[_0x347415(0xf2)]?.[_0x347415(0xe2)]||_0x347415(0xba)));}let _0x1b3549=_0x347415(0xfe);if(_0x2aa700['data']?.['status'])switch(_0x2aa700[_0x347415(0xd5)][_0x347415(0xf2)][_0x347415(0xbb)]()){case _0x347415(0xef):_0x1b3549='PAID';break;case _0x347415(0x108):_0x1b3549=_0x347415(0xea);break;case _0x347415(0x10a):_0x1b3549=_0x347415(0xc3);break;case _0x347415(0xc6):_0x1b3549=_0x347415(0xea);break;case _0x347415(0xeb):case _0x347415(0xb7):default:_0x1b3549=_0x347415(0xfe);break;}return{'status':_0x1b3549,'amount':_0x2aa700[_0x347415(0xd5)]?.['amount'],'currency':_0x2aa700[_0x347415(0xd5)]?.['currency']};}catch(_0x2a80c4){console['error']('Rapyd\x20payment\x20verification\x20error:',_0x2a80c4),loggerService_1[_0x347415(0xdd)][_0x347415(0xb8)](_0x347415(0x10e),_0x347415(0xca)+_0x4398fa,_0x2a80c4);throw new Error(_0x347415(0x11a)+(_0x2a80c4 instanceof Error?_0x2a80c4[_0x347415(0xe2)]:_0x347415(0xba)));}}async[a42_0x47a53e(0x100)](_0x1ea09e){const _0x263682=a42_0x47a53e;console[_0x263682(0xf8)](_0x263682(0xe0),_0x1ea09e);let _0x5be5cc=_0x263682(0xfe),_0x5a2767;_0x1ea09e[_0x263682(0xd5)]?.[_0x263682(0xc9)]&&(_0x5a2767=_0x1ea09e[_0x263682(0xd5)][_0x263682(0xc9)],console[_0x263682(0xf8)](_0x263682(0xe4)+_0x5a2767));switch(_0x1ea09e[_0x263682(0xdf)]?.[_0x263682(0xbb)]()){case'PAYMENT_COMPLETED':_0x1ea09e[_0x263682(0xd5)]?.[_0x263682(0x109)]===!![]&&_0x1ea09e[_0x263682(0xd5)]?.['status']==='CLO'?_0x5be5cc=_0x263682(0xc1):_0x5be5cc=_0x263682(0xfe);break;case _0x263682(0x110):_0x5be5cc=_0x263682(0xea);break;case _0x263682(0x103):_0x5be5cc='EXPIRED';break;case _0x263682(0xb5):_0x5be5cc=_0x263682(0xea);!_0x5a2767&&_0x1ea09e[_0x263682(0xd5)]?.['failure_message']&&(_0x5a2767=_0x1ea09e['data'][_0x263682(0xc9)]);break;default:switch(_0x1ea09e[_0x263682(0xd5)]?.[_0x263682(0xf2)]?.[_0x263682(0xbb)]()){case _0x263682(0xef):_0x1ea09e[_0x263682(0xd5)]?.[_0x263682(0x109)]===!![]?_0x5be5cc=_0x263682(0xc1):_0x5be5cc=_0x263682(0xea);break;case _0x263682(0x108):_0x5be5cc=_0x263682(0xea);break;case _0x263682(0x10a):_0x5be5cc=_0x263682(0xc3);break;case _0x263682(0xc6):_0x5be5cc=_0x263682(0xea);!_0x5a2767&&_0x1ea09e[_0x263682(0xd5)]?.['failure_message']&&(_0x5a2767=_0x1ea09e['data'][_0x263682(0xc9)]);break;case _0x263682(0xeb):case _0x263682(0xb7):default:_0x5be5cc='PENDING';break;}break;}const _0x352e49={};return _0x1ea09e[_0x263682(0xd5)]?.[_0x263682(0xd0)]?.[_0x263682(0xf1)]&&(_0x352e49['cardLast4']=_0x1ea09e['data'][_0x263682(0xd0)][_0x263682(0xf1)]),_0x1ea09e[_0x263682(0xd5)]?.[_0x263682(0x11b)]&&(_0x352e49[_0x263682(0xd8)]=_0x1ea09e[_0x263682(0xd5)][_0x263682(0x11b)]),_0x1ea09e[_0x263682(0xd5)]?.[_0x263682(0xb4)]&&(_0x352e49[_0x263682(0x116)]=_0x1ea09e[_0x263682(0xd5)][_0x263682(0xb4)]),_0x1ea09e[_0x263682(0xd5)]?.[_0x263682(0xda)]&&(_0x352e49[_0x263682(0xcd)]=_0x1ea09e[_0x263682(0xd5)][_0x263682(0xda)]),console[_0x263682(0xf8)]('üîÑ\x20Rapyd\x20webhook\x20processed:\x20status='+_0x5be5cc+_0x263682(0x123)+(_0x5a2767||'none')),{'paymentId':_0x1ea09e['data']?.[_0x263682(0xa9)]||'','status':_0x5be5cc,'amount':_0x1ea09e[_0x263682(0xd5)]?.[_0x263682(0xff)],'currency':_0x1ea09e['data']?.[_0x263682(0xaa)],'failureMessage':_0x5a2767,'additionalInfo':_0x352e49};}}function a42_0x2bad(_0x4c4e3a,_0x20abfb){const _0x56f4f5=a42_0x56f4();return a42_0x2bad=function(_0x2bad4b,_0x112344){_0x2bad4b=_0x2bad4b-0xa6;let _0x5de5cd=_0x56f4f5[_0x2bad4b];return _0x5de5cd;},a42_0x2bad(_0x4c4e3a,_0x20abfb);}exports[a42_0x47a53e(0xae)]=RapydService;