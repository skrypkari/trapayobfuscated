'use strict';function a46_0x1237(_0xeb1a5c,_0x3d4ebd){const _0x13df69=a46_0x13df();return a46_0x1237=function(_0x1237e5,_0x3fe42d){_0x1237e5=_0x1237e5-0xfc;let _0x49a7c2=_0x13df69[_0x1237e5];return _0x49a7c2;},a46_0x1237(_0xeb1a5c,_0x3d4ebd);}const a46_0xcee0b7=a46_0x1237;(function(_0x59080e,_0x367875){const _0x530ef8=a46_0x1237,_0x216795=_0x59080e();while(!![]){try{const _0x432f40=parseInt(_0x530ef8(0x146))/0x1+-parseInt(_0x530ef8(0x177))/0x2+parseInt(_0x530ef8(0x16c))/0x3+parseInt(_0x530ef8(0x171))/0x4*(parseInt(_0x530ef8(0x10b))/0x5)+-parseInt(_0x530ef8(0x13d))/0x6+-parseInt(_0x530ef8(0x12c))/0x7*(parseInt(_0x530ef8(0x11a))/0x8)+parseInt(_0x530ef8(0x16a))/0x9*(parseInt(_0x530ef8(0x10c))/0xa);if(_0x432f40===_0x367875)break;else _0x216795['push'](_0x216795['shift']());}catch(_0x2ed7b7){_0x216795['push'](_0x216795['shift']());}}}(a46_0x13df,0x38277));function a46_0x13df(){const _0x299b4a=['7736PgfORD','Redirect\x20URL:','json','HTTP\x20Status:','PENDING','üá¨üáß\x20Country:\x20','500148ISiZTc','Business\x20Error\x20(',',\x20body:\x20','Raw\x20Response\x20Body:','POST','Unknown\x20error','üîÑ\x20Rapyd\x20webhook\x20processed:\x20status=','ACT','createPaymentLink','Response\x20Time:','toUpperCase','üá¨üáß\x20Using\x20GB\x20(Britain)\x20as\x20country\x20for\x20Rapyd\x20payment\x20link','loggerService','Error\x20message:','../loggerService','https://tesoft.uk/gateway/rapyd/','1080jEtFqS','50410vjDtRA','Invalid\x20response\x20from\x20Rapyd\x20API:\x20missing\x20id\x20or\x20redirect_url','errorCode','Rapyd\x20API\x20error\x20(','Failed\x20to\x20create\x20Rapyd\x20payment\x20link:\x20','Error\x20Message:','Invalid\x20JSON\x20response\x20from\x20Rapyd\x20API:\x20','PAID','logWhiteDomainRequest','payment_method_type','Payment\x20Link\x20ID:','/v1/hosted/payment_links','logWhiteDomainError','status','16SlJpUz','PAYMENT_EXPIRED','NEW','EXP','Status:','Full\x20Error\x20Data:','ORDER:\x20','apiUrl','Incomplete\x20response:\x20missing\x20id\x20or\x20redirect_url','payment_method_data','Missing\x20id\x20or\x20redirect_url\x20in\x20response','fromEntries','CLO','logWhiteDomainResponse','error_code','redirect_url','Failed\x20to\x20verify\x20Rapyd\x20payment:\x20','processWebhook','543914BeYuvl','Error\x20stack:','Headers:','parse','cardLast4','failure_code','message','/v1/hosted/payment_links/','Error\x20Code:','Status\x20Text:','Response\x20data:','failure_message','https://tesoft.uk/gateway/fail.php?id=','\x20(always\x20GB\x20for\x20Rapyd)','Rapyd\x20payment\x20verification\x20error:','===\x20RAPYD\x20API\x20INCOMPLETE\x20RESPONSE\x20===','GET','2566260LKXOBk','last4','===\x20RAPYD\x20SERVICE\x20ERROR\x20===','rapyd','üá¨üáß\x20Country\x20used:\x20','üí≥\x20Payment\x20Methods:\x20gb_visa_card,\x20gb_mastercard_card','error','paid','stringify','299147XjRbCr','Parsed\x20Result:','===\x20RAPYD\x20SUCCESS\x20===','PAYMENT_CANCELED','none','CAN','FAILED','===\x20RAPYD\x20API\x20RESPONSE\x20(White\x20Domain)\x20===','===\x20RAPYD\x20API\x20ERROR\x20===','defineProperty','type','text','TesSoft\x20Payment\x20System/1.0','PAYMENT_COMPLETED','Unknown\x20error\x20from\x20Rapyd\x20API','application/json','Failed\x20to\x20parse\x20JSON\x20response:','now','gb_visa_card','===\x20RAPYD\x20API\x20REQUEST\x20(White\x20Domain\x20-\x20Updated\x20Format)\x20===','gb_mastercard_card','Rapyd\x20API\x20error:\x20','paymentMethod','UNKNOWN','__esModule','RapydService','log','currency','ERR','amount','):\x20','EXPIRED','===\x20PARSED\x20RAPYD\x20RESPONSE\x20===','data','Processing\x20Rapyd\x20webhook:','SUCCESS','333pGraVR','üí•\x20Rapyd\x20failure\x20message:\x20','479361SZiSgo',',\x20failureMessage=','statusText','Response\x20Body:','\x20(GB\x20-\x20Britain)'];a46_0x13df=function(){return _0x299b4a;};return a46_0x13df();}Object[a46_0xcee0b7(0x14f)](exports,a46_0xcee0b7(0x15e),{'value':!![]}),exports[a46_0xcee0b7(0x15f)]=void 0x0;const loggerService_1=require(a46_0xcee0b7(0x109));class RapydService{constructor(){const _0x48d4cc=a46_0xcee0b7;this[_0x48d4cc(0x121)]=_0x48d4cc(0x10a),console[_0x48d4cc(0x160)]('üåê\x20Rapyd\x20service\x20initialized\x20with\x20white\x20domain\x20proxy');}async[a46_0xcee0b7(0x103)](_0x3a2b1d){const _0x375ccf=a46_0xcee0b7,{orderId:_0x245067,orderName:_0x264370,amount:_0x40d5e7,currency:_0x117f18,usage:_0x6bd9e6,maxPayments:_0x1937cc,successUrl:_0x79adaa,failUrl:_0x14ffa4}=_0x3a2b1d,_0x275e08=_0x117f18[_0x375ccf(0x105)](),_0x52ef6d='GB';console['log'](_0x375ccf(0x106));const _0x333a24='https://tesoft.uk/gateway/success.php?id='+_0x245067,_0x3cdab4=_0x375ccf(0x138)+_0x245067,_0x3f2645={'amount':_0x40d5e7,'currency':_0x275e08,'cancel_checkout_url':_0x3cdab4,'complete_checkout_url':_0x333a24,'complete_payment_url':_0x333a24,'merchant_reference_id':_0x245067,'description':_0x375ccf(0x120)+_0x245067,'country':'GB','payment_method_types_include':[_0x375ccf(0x158),_0x375ccf(0x15a)],'custom_elements':{'display_description':!![]}},_0x17254c=Date['now']();try{console[_0x375ccf(0x160)](_0x375ccf(0x159)),console[_0x375ccf(0x160)]('URL:',this['apiUrl']),console[_0x375ccf(0x160)]('Request\x20Body\x20(Updated\x20Format):',JSON[_0x375ccf(0x145)](_0x3f2645,null,0x2)),console['log'](_0x375ccf(0x176)+_0x52ef6d+_0x375ccf(0x139)),console[_0x375ccf(0x160)]('üí≥\x20Payment\x20Methods:\x20gb_visa_card,\x20gb_mastercard_card'),loggerService_1[_0x375ccf(0x107)][_0x375ccf(0x114)]('rapyd','/v1/hosted/payment_links',_0x375ccf(0xff),_0x3f2645);const _0x1ce275=await fetch(this[_0x375ccf(0x121)],{'method':_0x375ccf(0xff),'headers':{'Content-Type':_0x375ccf(0x155),'User-Agent':_0x375ccf(0x152)},'body':JSON['stringify'](_0x3f2645)}),_0x4d539c=Date[_0x375ccf(0x157)]()-_0x17254c;console[_0x375ccf(0x160)](_0x375ccf(0x14d)),console[_0x375ccf(0x160)](_0x375ccf(0x11e),_0x1ce275[_0x375ccf(0x119)]),console[_0x375ccf(0x160)](_0x375ccf(0x135),_0x1ce275[_0x375ccf(0x16e)]),console[_0x375ccf(0x160)](_0x375ccf(0x12e),Object[_0x375ccf(0x125)](_0x1ce275['headers']['entries']())),console[_0x375ccf(0x160)](_0x375ccf(0x104),_0x4d539c+'ms');const _0xfb9e2f=await _0x1ce275[_0x375ccf(0x151)]();console[_0x375ccf(0x160)](_0x375ccf(0xfe),_0xfb9e2f);if(!_0x1ce275['ok']){console[_0x375ccf(0x143)](_0x375ccf(0x14e)),console[_0x375ccf(0x143)](_0x375ccf(0x174),_0x1ce275[_0x375ccf(0x119)]),console['error'](_0x375ccf(0x16f),_0xfb9e2f),loggerService_1[_0x375ccf(0x107)]['logWhiteDomainResponse'](_0x375ccf(0x140),_0x375ccf(0x117),_0x1ce275[_0x375ccf(0x119)],_0xfb9e2f,_0x4d539c),loggerService_1[_0x375ccf(0x107)][_0x375ccf(0x118)](_0x375ccf(0x140),_0x375ccf(0x117),'HTTP\x20'+_0x1ce275[_0x375ccf(0x119)]+':\x20'+_0xfb9e2f);throw new Error('HTTP\x20error!\x20status:\x20'+_0x1ce275[_0x375ccf(0x119)]+_0x375ccf(0xfd)+_0xfb9e2f);}let _0x6e25f3;try{_0x6e25f3=JSON[_0x375ccf(0x12f)](_0xfb9e2f);}catch(_0x439b46){console[_0x375ccf(0x143)](_0x375ccf(0x156),_0x439b46),loggerService_1[_0x375ccf(0x107)]['logWhiteDomainError'](_0x375ccf(0x140),_0x375ccf(0x117),'JSON\x20Parse\x20Error:\x20'+_0x439b46);throw new Error(_0x375ccf(0x112)+_0xfb9e2f);}console['log'](_0x375ccf(0x166)),console[_0x375ccf(0x160)](_0x375ccf(0x147),JSON[_0x375ccf(0x145)](_0x6e25f3,null,0x2)),loggerService_1[_0x375ccf(0x107)][_0x375ccf(0x127)](_0x375ccf(0x140),_0x375ccf(0x117),_0x1ce275[_0x375ccf(0x119)],_0x6e25f3,_0x4d539c);if(_0x6e25f3[_0x375ccf(0x119)]?.[_0x375ccf(0x119)]!==_0x375ccf(0x169)){const _0x2170b9=_0x6e25f3[_0x375ccf(0x119)]?.[_0x375ccf(0x132)]||_0x375ccf(0x154),_0x54e5f5=_0x6e25f3['status']?.[_0x375ccf(0x128)]||_0x375ccf(0x15d);console[_0x375ccf(0x143)]('===\x20RAPYD\x20API\x20BUSINESS\x20ERROR\x20==='),console[_0x375ccf(0x143)](_0x375ccf(0x134),_0x54e5f5),console[_0x375ccf(0x143)](_0x375ccf(0x111),_0x2170b9),console[_0x375ccf(0x143)](_0x375ccf(0x11f),_0x6e25f3['status']),loggerService_1[_0x375ccf(0x107)][_0x375ccf(0x118)]('rapyd',_0x375ccf(0x117),_0x375ccf(0xfc)+_0x54e5f5+_0x375ccf(0x164)+_0x2170b9);throw new Error(_0x375ccf(0x10f)+_0x54e5f5+_0x375ccf(0x164)+_0x2170b9);}if(!_0x6e25f3[_0x375ccf(0x167)]?.['id']||!_0x6e25f3[_0x375ccf(0x167)]?.[_0x375ccf(0x129)]){console[_0x375ccf(0x143)](_0x375ccf(0x13b)),console[_0x375ccf(0x143)](_0x375ccf(0x124)),console[_0x375ccf(0x143)](_0x375ccf(0x136),_0x6e25f3[_0x375ccf(0x167)]),loggerService_1[_0x375ccf(0x107)][_0x375ccf(0x118)]('rapyd',_0x375ccf(0x117),_0x375ccf(0x122));throw new Error(_0x375ccf(0x10d));}return console['log'](_0x375ccf(0x148)),console[_0x375ccf(0x160)](_0x375ccf(0x116),_0x6e25f3[_0x375ccf(0x167)]['id']),console[_0x375ccf(0x160)](_0x375ccf(0x172),_0x6e25f3[_0x375ccf(0x167)][_0x375ccf(0x129)]),console[_0x375ccf(0x160)](_0x375ccf(0x141)+_0x52ef6d+_0x375ccf(0x170)),console[_0x375ccf(0x160)](_0x375ccf(0x142)),{'gateway_payment_id':_0x6e25f3[_0x375ccf(0x167)]['id'],'payment_url':_0x6e25f3[_0x375ccf(0x167)]['redirect_url']};}catch(_0x36b703){console[_0x375ccf(0x143)](_0x375ccf(0x13f)),console[_0x375ccf(0x143)]('Error\x20details:',_0x36b703),loggerService_1[_0x375ccf(0x107)][_0x375ccf(0x118)]('rapyd','/v1/hosted/payment_links',_0x36b703);if(_0x36b703 instanceof Error){console[_0x375ccf(0x143)](_0x375ccf(0x108),_0x36b703[_0x375ccf(0x132)]),console[_0x375ccf(0x143)](_0x375ccf(0x12d),_0x36b703['stack']);throw new Error(_0x375ccf(0x110)+_0x36b703[_0x375ccf(0x132)]);}throw new Error('Failed\x20to\x20create\x20Rapyd\x20payment\x20link:\x20Unknown\x20error');}}async['verifyPayment'](_0x1709f3){const _0xcf17b3=a46_0xcee0b7,_0x2b4c2d=Date[_0xcf17b3(0x157)]();try{loggerService_1[_0xcf17b3(0x107)][_0xcf17b3(0x114)](_0xcf17b3(0x140),'/v1/hosted/payment_links/'+_0x1709f3,_0xcf17b3(0x13c),{});const _0x2f0d86=await fetch(this[_0xcf17b3(0x121)]+'/'+_0x1709f3,{'method':_0xcf17b3(0x13c),'headers':{'Content-Type':_0xcf17b3(0x155),'User-Agent':_0xcf17b3(0x152)}}),_0x530d06=Date[_0xcf17b3(0x157)]()-_0x2b4c2d;if(!_0x2f0d86['ok']){const _0x229eb5=await _0x2f0d86[_0xcf17b3(0x151)]();loggerService_1[_0xcf17b3(0x107)][_0xcf17b3(0x127)](_0xcf17b3(0x140),_0xcf17b3(0x133)+_0x1709f3,_0x2f0d86['status'],_0x229eb5,_0x530d06);throw new Error('HTTP\x20error!\x20status:\x20'+_0x2f0d86[_0xcf17b3(0x119)]);}const _0x697f47=await _0x2f0d86[_0xcf17b3(0x173)]();loggerService_1[_0xcf17b3(0x107)][_0xcf17b3(0x127)](_0xcf17b3(0x140),_0xcf17b3(0x133)+_0x1709f3,_0x2f0d86[_0xcf17b3(0x119)],_0x697f47,_0x530d06);if(_0x697f47['status']?.[_0xcf17b3(0x119)]!==_0xcf17b3(0x169)){loggerService_1[_0xcf17b3(0x107)][_0xcf17b3(0x118)](_0xcf17b3(0x140),'/v1/hosted/payment_links/'+_0x1709f3,_0xcf17b3(0x15b)+(_0x697f47['status']?.['message']||_0xcf17b3(0x100)));throw new Error(_0xcf17b3(0x15b)+(_0x697f47[_0xcf17b3(0x119)]?.[_0xcf17b3(0x132)]||_0xcf17b3(0x100)));}let _0x1a252b=_0xcf17b3(0x175);if(_0x697f47[_0xcf17b3(0x167)]?.['status'])switch(_0x697f47[_0xcf17b3(0x167)][_0xcf17b3(0x119)]['toUpperCase']()){case'CLO':_0x1a252b=_0xcf17b3(0x113);break;case _0xcf17b3(0x14b):_0x1a252b=_0xcf17b3(0x14c);break;case _0xcf17b3(0x11d):_0x1a252b=_0xcf17b3(0x165);break;case _0xcf17b3(0x162):_0x1a252b=_0xcf17b3(0x14c);break;case'NEW':case _0xcf17b3(0x102):default:_0x1a252b='PENDING';break;}return{'status':_0x1a252b,'amount':_0x697f47[_0xcf17b3(0x167)]?.[_0xcf17b3(0x163)],'currency':_0x697f47[_0xcf17b3(0x167)]?.[_0xcf17b3(0x161)]};}catch(_0x2a0ec2){console[_0xcf17b3(0x143)](_0xcf17b3(0x13a),_0x2a0ec2),loggerService_1['loggerService']['logWhiteDomainError'](_0xcf17b3(0x140),'/v1/hosted/payment_links/'+_0x1709f3,_0x2a0ec2);throw new Error(_0xcf17b3(0x12a)+(_0x2a0ec2 instanceof Error?_0x2a0ec2[_0xcf17b3(0x132)]:'Unknown\x20error'));}}async[a46_0xcee0b7(0x12b)](_0x148812){const _0x434fec=a46_0xcee0b7;console[_0x434fec(0x160)](_0x434fec(0x168),_0x148812);let _0x1085de=_0x434fec(0x175),_0x3ca216;_0x148812['data']?.['failure_message']&&(_0x3ca216=_0x148812['data'][_0x434fec(0x137)],console[_0x434fec(0x160)](_0x434fec(0x16b)+_0x3ca216));switch(_0x148812[_0x434fec(0x150)]?.[_0x434fec(0x105)]()){case _0x434fec(0x153):_0x148812[_0x434fec(0x167)]?.['paid']===!![]&&_0x148812[_0x434fec(0x167)]?.[_0x434fec(0x119)]===_0x434fec(0x126)?_0x1085de='PAID':_0x1085de='PENDING';break;case _0x434fec(0x149):_0x1085de=_0x434fec(0x14c);break;case _0x434fec(0x11b):_0x1085de=_0x434fec(0x165);break;case'PAYMENT_FAILED':_0x1085de='FAILED';!_0x3ca216&&_0x148812[_0x434fec(0x167)]?.[_0x434fec(0x137)]&&(_0x3ca216=_0x148812[_0x434fec(0x167)][_0x434fec(0x137)]);break;default:switch(_0x148812[_0x434fec(0x167)]?.['status']?.['toUpperCase']()){case _0x434fec(0x126):_0x148812[_0x434fec(0x167)]?.[_0x434fec(0x144)]===!![]?_0x1085de=_0x434fec(0x113):_0x1085de='FAILED';break;case _0x434fec(0x14b):_0x1085de=_0x434fec(0x14c);break;case _0x434fec(0x11d):_0x1085de='EXPIRED';break;case _0x434fec(0x162):_0x1085de=_0x434fec(0x14c);!_0x3ca216&&_0x148812['data']?.['failure_message']&&(_0x3ca216=_0x148812['data'][_0x434fec(0x137)]);break;case _0x434fec(0x11c):case'ACT':default:_0x1085de='PENDING';break;}break;}const _0x1dce8f={};return _0x148812[_0x434fec(0x167)]?.['payment_method_data']?.[_0x434fec(0x13e)]&&(_0x1dce8f[_0x434fec(0x130)]=_0x148812[_0x434fec(0x167)][_0x434fec(0x123)][_0x434fec(0x13e)]),_0x148812[_0x434fec(0x167)]?.[_0x434fec(0x115)]&&(_0x1dce8f[_0x434fec(0x15c)]=_0x148812[_0x434fec(0x167)][_0x434fec(0x115)]),_0x148812['data']?.['error_code']&&(_0x1dce8f[_0x434fec(0x10e)]=_0x148812[_0x434fec(0x167)][_0x434fec(0x128)]),_0x148812[_0x434fec(0x167)]?.[_0x434fec(0x131)]&&(_0x1dce8f['failureCode']=_0x148812['data'][_0x434fec(0x131)]),console[_0x434fec(0x160)](_0x434fec(0x101)+_0x1085de+_0x434fec(0x16d)+(_0x3ca216||_0x434fec(0x14a))),{'paymentId':_0x148812[_0x434fec(0x167)]?.['merchant_reference_id']||'','status':_0x1085de,'amount':_0x148812[_0x434fec(0x167)]?.[_0x434fec(0x163)],'currency':_0x148812[_0x434fec(0x167)]?.['currency'],'failureMessage':_0x3ca216,'additionalInfo':_0x1dce8f};}}exports[a46_0xcee0b7(0x15f)]=RapydService;