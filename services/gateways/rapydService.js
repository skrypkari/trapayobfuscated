'use strict';const a42_0x4bf00d=a42_0x30ab;(function(_0x56a69a,_0x3e5a0a){const _0x1f94e2=a42_0x30ab,_0x5de6dd=_0x56a69a();while(!![]){try{const _0x40a8a3=parseInt(_0x1f94e2(0xdb))/0x1+parseInt(_0x1f94e2(0xc3))/0x2*(parseInt(_0x1f94e2(0xe1))/0x3)+parseInt(_0x1f94e2(0xfe))/0x4*(parseInt(_0x1f94e2(0xb9))/0x5)+parseInt(_0x1f94e2(0x119))/0x6+-parseInt(_0x1f94e2(0x107))/0x7*(parseInt(_0x1f94e2(0x108))/0x8)+-parseInt(_0x1f94e2(0x104))/0x9+-parseInt(_0x1f94e2(0x118))/0xa*(parseInt(_0x1f94e2(0xc8))/0xb);if(_0x40a8a3===_0x3e5a0a)break;else _0x5de6dd['push'](_0x5de6dd['shift']());}catch(_0x345178){_0x5de6dd['push'](_0x5de6dd['shift']());}}}(a42_0x4462,0xb19fe));function a42_0x30ab(_0x41b71c,_0xedbf22){const _0x446241=a42_0x4462();return a42_0x30ab=function(_0x30abc3,_0x357021){_0x30abc3=_0x30abc3-0xb3;let _0x18a83c=_0x446241[_0x30abc3];return _0x18a83c;},a42_0x30ab(_0x41b71c,_0xedbf22);}Object[a42_0x4bf00d(0xe3)](exports,a42_0x4bf00d(0xd1),{'value':!![]}),exports[a42_0x4bf00d(0xf1)]=void 0x0;const loggerService_1=require(a42_0x4bf00d(0xb5));class RapydService{constructor(){const _0x4d8d40=a42_0x4bf00d;this[_0x4d8d40(0xb3)]=_0x4d8d40(0xef),console[_0x4d8d40(0x103)](_0x4d8d40(0xfd));}async[a42_0x4bf00d(0x10f)](_0x5b0ab4){const _0x4491ff=a42_0x4bf00d,{orderId:_0xebf6f9,orderName:_0x4f8942,amount:_0x29ecf0,currency:_0x5bc751,usage:_0x9405df,maxPayments:_0x359ef0,successUrl:_0x1eec04,failUrl:_0x27c84e}=_0x5b0ab4,_0x212385=_0x5bc751[_0x4491ff(0xe2)](),_0x2b572e='GB';console['log'](_0x4491ff(0xfc));const _0x46a038=_0x4491ff(0x126)+_0xebf6f9,_0x5b2cf5='https://tesoft.uk/gateway/fail.php?id='+_0xebf6f9,_0x4f9a75={'amount':_0x29ecf0,'currency':_0x212385,'cancel_checkout_url':_0x5b2cf5,'complete_checkout_url':_0x46a038,'complete_payment_url':_0x46a038,'merchant_reference_id':_0xebf6f9,'description':'ORDER:\x20'+_0xebf6f9,'country':'GB','payment_method_types_include':[_0x4491ff(0xf6),'gb_mastercard_card'],'custom_elements':{'display_description':!![]}},_0x1fe07b=Date[_0x4491ff(0xf2)]();try{console[_0x4491ff(0x103)](_0x4491ff(0xd5)),console['log']('URL:',this[_0x4491ff(0xb3)]),console[_0x4491ff(0x103)](_0x4491ff(0xf9),JSON[_0x4491ff(0xf8)](_0x4f9a75,null,0x2)),console[_0x4491ff(0x103)](_0x4491ff(0xe6)+_0x2b572e+'\x20(always\x20GB\x20for\x20Rapyd)'),console[_0x4491ff(0x103)](_0x4491ff(0xc2)),loggerService_1[_0x4491ff(0xe5)]['logWhiteDomainRequest'](_0x4491ff(0x102),'/v1/hosted/payment_links','POST',_0x4f9a75);const _0xfd957e=await fetch(this[_0x4491ff(0xb3)],{'method':_0x4491ff(0xc6),'headers':{'Content-Type':'application/json','User-Agent':_0x4491ff(0xc1)},'body':JSON[_0x4491ff(0xf8)](_0x4f9a75)}),_0x1bde7b=Date['now']()-_0x1fe07b;console[_0x4491ff(0x103)]('===\x20RAPYD\x20API\x20RESPONSE\x20(White\x20Domain)\x20==='),console[_0x4491ff(0x103)]('Status:',_0xfd957e[_0x4491ff(0x11e)]),console[_0x4491ff(0x103)](_0x4491ff(0xb8),_0xfd957e[_0x4491ff(0x121)]),console[_0x4491ff(0x103)](_0x4491ff(0xda),Object[_0x4491ff(0xdd)](_0xfd957e[_0x4491ff(0x110)][_0x4491ff(0x105)]())),console[_0x4491ff(0x103)]('Response\x20Time:',_0x1bde7b+'ms');const _0x2d0490=await _0xfd957e[_0x4491ff(0xcd)]();console[_0x4491ff(0x103)]('Raw\x20Response\x20Body:',_0x2d0490);if(!_0xfd957e['ok']){console[_0x4491ff(0x10a)](_0x4491ff(0x114)),console[_0x4491ff(0x10a)](_0x4491ff(0x10e),_0xfd957e[_0x4491ff(0x11e)]),console[_0x4491ff(0x10a)](_0x4491ff(0x115),_0x2d0490),loggerService_1['loggerService'][_0x4491ff(0xba)](_0x4491ff(0x102),'/v1/hosted/payment_links',_0xfd957e['status'],_0x2d0490,_0x1bde7b),loggerService_1[_0x4491ff(0xe5)][_0x4491ff(0xc0)]('rapyd',_0x4491ff(0x124),_0x4491ff(0xbe)+_0xfd957e['status']+':\x20'+_0x2d0490);throw new Error('HTTP\x20error!\x20status:\x20'+_0xfd957e[_0x4491ff(0x11e)]+',\x20body:\x20'+_0x2d0490);}let _0x457ffb;try{_0x457ffb=JSON[_0x4491ff(0x123)](_0x2d0490);}catch(_0x3171d4){console['error']('Failed\x20to\x20parse\x20JSON\x20response:',_0x3171d4),loggerService_1[_0x4491ff(0xe5)]['logWhiteDomainError'](_0x4491ff(0x102),_0x4491ff(0x124),'JSON\x20Parse\x20Error:\x20'+_0x3171d4);throw new Error(_0x4491ff(0xde)+_0x2d0490);}console['log'](_0x4491ff(0x116)),console[_0x4491ff(0x103)](_0x4491ff(0xbb),JSON[_0x4491ff(0xf8)](_0x457ffb,null,0x2)),loggerService_1[_0x4491ff(0xe5)][_0x4491ff(0xba)]('rapyd',_0x4491ff(0x124),_0xfd957e[_0x4491ff(0x11e)],_0x457ffb,_0x1bde7b);if(_0x457ffb[_0x4491ff(0x11e)]?.[_0x4491ff(0x11e)]!==_0x4491ff(0xe8)){const _0x495171=_0x457ffb[_0x4491ff(0x11e)]?.[_0x4491ff(0xe0)]||_0x4491ff(0xcb),_0x1e563e=_0x457ffb[_0x4491ff(0x11e)]?.[_0x4491ff(0xb4)]||_0x4491ff(0xed);console[_0x4491ff(0x10a)](_0x4491ff(0xf3)),console['error'](_0x4491ff(0xf0),_0x1e563e),console['error']('Error\x20Message:',_0x495171),console[_0x4491ff(0x10a)]('Full\x20Error\x20Data:',_0x457ffb['status']),loggerService_1[_0x4491ff(0xe5)][_0x4491ff(0xc0)]('rapyd',_0x4491ff(0x124),_0x4491ff(0xc7)+_0x1e563e+_0x4491ff(0xff)+_0x495171);throw new Error(_0x4491ff(0x101)+_0x1e563e+_0x4491ff(0xff)+_0x495171);}if(!_0x457ffb[_0x4491ff(0x111)]?.['id']||!_0x457ffb['data']?.['redirect_url']){console[_0x4491ff(0x10a)]('===\x20RAPYD\x20API\x20INCOMPLETE\x20RESPONSE\x20==='),console[_0x4491ff(0x10a)](_0x4491ff(0xe4)),console['error'](_0x4491ff(0xd7),_0x457ffb['data']),loggerService_1[_0x4491ff(0xe5)][_0x4491ff(0xc0)](_0x4491ff(0x102),_0x4491ff(0x124),'Incomplete\x20response:\x20missing\x20id\x20or\x20redirect_url');throw new Error(_0x4491ff(0xee));}return console[_0x4491ff(0x103)](_0x4491ff(0xbc)),console['log'](_0x4491ff(0xec),_0x457ffb[_0x4491ff(0x111)]['id']),console[_0x4491ff(0x103)](_0x4491ff(0xd8),_0x457ffb[_0x4491ff(0x111)][_0x4491ff(0x11d)]),console['log'](_0x4491ff(0xd3)+_0x2b572e+_0x4491ff(0xd9)),console['log'](_0x4491ff(0xc2)),{'gateway_payment_id':_0x457ffb[_0x4491ff(0x111)]['id'],'payment_url':_0x457ffb['data']['redirect_url']};}catch(_0x1e2b56){console['error']('===\x20RAPYD\x20SERVICE\x20ERROR\x20==='),console[_0x4491ff(0x10a)](_0x4491ff(0xf5),_0x1e2b56),loggerService_1[_0x4491ff(0xe5)][_0x4491ff(0xc0)](_0x4491ff(0x102),_0x4491ff(0x124),_0x1e2b56);if(_0x1e2b56 instanceof Error){console[_0x4491ff(0x10a)](_0x4491ff(0xdf),_0x1e2b56[_0x4491ff(0xe0)]),console[_0x4491ff(0x10a)]('Error\x20stack:',_0x1e2b56['stack']);throw new Error(_0x4491ff(0x117)+_0x1e2b56[_0x4491ff(0xe0)]);}throw new Error('Failed\x20to\x20create\x20Rapyd\x20payment\x20link:\x20Unknown\x20error');}}async[a42_0x4bf00d(0x11c)](_0x37dc7e){const _0xc60158=a42_0x4bf00d,_0x5f389e=Date['now']();try{loggerService_1[_0xc60158(0xe5)]['logWhiteDomainRequest'](_0xc60158(0x102),'/v1/hosted/payment_links/'+_0x37dc7e,_0xc60158(0xc9),{});const _0x2bc4cd=await fetch(this[_0xc60158(0xb3)]+'/'+_0x37dc7e,{'method':'GET','headers':{'Content-Type':_0xc60158(0x120),'User-Agent':_0xc60158(0xc1)}}),_0x11589e=Date['now']()-_0x5f389e;if(!_0x2bc4cd['ok']){const _0x29b205=await _0x2bc4cd['text']();loggerService_1[_0xc60158(0xe5)][_0xc60158(0xba)](_0xc60158(0x102),'/v1/hosted/payment_links/'+_0x37dc7e,_0x2bc4cd['status'],_0x29b205,_0x11589e);throw new Error(_0xc60158(0xbd)+_0x2bc4cd[_0xc60158(0x11e)]);}const _0x2e597f=await _0x2bc4cd[_0xc60158(0x10b)]();loggerService_1['loggerService'][_0xc60158(0xba)](_0xc60158(0x102),'/v1/hosted/payment_links/'+_0x37dc7e,_0x2bc4cd['status'],_0x2e597f,_0x11589e);if(_0x2e597f[_0xc60158(0x11e)]?.[_0xc60158(0x11e)]!==_0xc60158(0xe8)){loggerService_1['loggerService'][_0xc60158(0xc0)](_0xc60158(0x102),_0xc60158(0x11b)+_0x37dc7e,'Rapyd\x20API\x20error:\x20'+(_0x2e597f['status']?.[_0xc60158(0xe0)]||_0xc60158(0x11f)));throw new Error(_0xc60158(0xcc)+(_0x2e597f[_0xc60158(0x11e)]?.['message']||_0xc60158(0x11f)));}let _0x31e5b7=_0xc60158(0x10c);if(_0x2e597f[_0xc60158(0x111)]?.[_0xc60158(0x11e)])switch(_0x2e597f[_0xc60158(0x111)][_0xc60158(0x11e)][_0xc60158(0xe2)]()){case _0xc60158(0xb7):_0x31e5b7=_0xc60158(0x11a);break;case _0xc60158(0x112):_0x31e5b7=_0xc60158(0xe7);break;case'EXP':_0x31e5b7=_0xc60158(0xfa);break;case _0xc60158(0x125):_0x31e5b7='FAILED';break;case'NEW':case'ACT':default:_0x31e5b7=_0xc60158(0x10c);break;}return{'status':_0x31e5b7,'amount':_0x2e597f[_0xc60158(0x111)]?.[_0xc60158(0xb6)],'currency':_0x2e597f[_0xc60158(0x111)]?.[_0xc60158(0xf7)]};}catch(_0x3dbbac){console[_0xc60158(0x10a)](_0xc60158(0xdc),_0x3dbbac),loggerService_1['loggerService']['logWhiteDomainError']('rapyd',_0xc60158(0x11b)+_0x37dc7e,_0x3dbbac);throw new Error(_0xc60158(0xbf)+(_0x3dbbac instanceof Error?_0x3dbbac[_0xc60158(0xe0)]:'Unknown\x20error'));}}async[a42_0x4bf00d(0x113)](_0x2ddb56){const _0x3dec72=a42_0x4bf00d;console[_0x3dec72(0x103)]('Processing\x20Rapyd\x20webhook:',_0x2ddb56);let _0x5a3448=_0x3dec72(0x10c),_0x261ae3;_0x2ddb56[_0x3dec72(0x111)]?.[_0x3dec72(0xe9)]&&(_0x261ae3=_0x2ddb56[_0x3dec72(0x111)][_0x3dec72(0xe9)],console['log']('💥\x20Rapyd\x20failure\x20message:\x20'+_0x261ae3));switch(_0x2ddb56[_0x3dec72(0xf4)]?.[_0x3dec72(0xe2)]()){case'PAYMENT_COMPLETED':_0x2ddb56[_0x3dec72(0x111)]?.[_0x3dec72(0x109)]===!![]&&_0x2ddb56[_0x3dec72(0x111)]?.[_0x3dec72(0x11e)]===_0x3dec72(0xb7)?_0x5a3448=_0x3dec72(0x11a):_0x5a3448='PENDING';break;case _0x3dec72(0xd6):_0x5a3448=_0x3dec72(0xe7);break;case _0x3dec72(0x122):_0x5a3448=_0x3dec72(0xfa);break;case _0x3dec72(0xd4):_0x5a3448=_0x3dec72(0xe7);!_0x261ae3&&_0x2ddb56[_0x3dec72(0x111)]?.[_0x3dec72(0xe9)]&&(_0x261ae3=_0x2ddb56[_0x3dec72(0x111)]['failure_message']);break;default:switch(_0x2ddb56[_0x3dec72(0x111)]?.['status']?.[_0x3dec72(0xe2)]()){case _0x3dec72(0xb7):_0x2ddb56[_0x3dec72(0x111)]?.[_0x3dec72(0x109)]===!![]?_0x5a3448=_0x3dec72(0x11a):_0x5a3448=_0x3dec72(0xe7);break;case _0x3dec72(0x112):_0x5a3448='FAILED';break;case _0x3dec72(0xce):_0x5a3448=_0x3dec72(0xfa);break;case _0x3dec72(0x125):_0x5a3448=_0x3dec72(0xe7);!_0x261ae3&&_0x2ddb56[_0x3dec72(0x111)]?.[_0x3dec72(0xe9)]&&(_0x261ae3=_0x2ddb56[_0x3dec72(0x111)][_0x3dec72(0xe9)]);break;case _0x3dec72(0x10d):case _0x3dec72(0xfb):default:_0x5a3448=_0x3dec72(0x10c);break;}break;}const _0x50fa59={};return _0x2ddb56['data']?.[_0x3dec72(0xc4)]?.[_0x3dec72(0xcf)]&&(_0x50fa59[_0x3dec72(0xeb)]=_0x2ddb56[_0x3dec72(0x111)][_0x3dec72(0xc4)][_0x3dec72(0xcf)]),_0x2ddb56[_0x3dec72(0x111)]?.[_0x3dec72(0x106)]&&(_0x50fa59[_0x3dec72(0xca)]=_0x2ddb56[_0x3dec72(0x111)][_0x3dec72(0x106)]),_0x2ddb56[_0x3dec72(0x111)]?.['error_code']&&(_0x50fa59[_0x3dec72(0xd2)]=_0x2ddb56[_0x3dec72(0x111)]['error_code']),_0x2ddb56[_0x3dec72(0x111)]?.['failure_code']&&(_0x50fa59[_0x3dec72(0xea)]=_0x2ddb56['data']['failure_code']),console[_0x3dec72(0x103)]('🔄\x20Rapyd\x20webhook\x20processed:\x20status='+_0x5a3448+_0x3dec72(0xd0)+(_0x261ae3||_0x3dec72(0x100))),{'paymentId':_0x2ddb56['data']?.[_0x3dec72(0xc5)]||'','status':_0x5a3448,'amount':_0x2ddb56[_0x3dec72(0x111)]?.[_0x3dec72(0xb6)],'currency':_0x2ddb56[_0x3dec72(0x111)]?.[_0x3dec72(0xf7)],'failureMessage':_0x261ae3,'additionalInfo':_0x50fa59};}}exports[a42_0x4bf00d(0xf1)]=RapydService;function a42_0x4462(){const _0x282109=['PENDING','NEW','HTTP\x20Status:','createPaymentLink','headers','data','CAN','processWebhook','===\x20RAPYD\x20API\x20ERROR\x20===','Response\x20Body:','===\x20PARSED\x20RAPYD\x20RESPONSE\x20===','Failed\x20to\x20create\x20Rapyd\x20payment\x20link:\x20','3020nYitQO','5350104DIaEkF','PAID','/v1/hosted/payment_links/','verifyPayment','redirect_url','status','Unknown\x20error','application/json','statusText','PAYMENT_EXPIRED','parse','/v1/hosted/payment_links','ERR','https://tesoft.uk/gateway/success.php?id=','apiUrl','error_code','../loggerService','amount','CLO','Status\x20Text:','59105hvrJhj','logWhiteDomainResponse','Parsed\x20Result:','===\x20RAPYD\x20SUCCESS\x20===','HTTP\x20error!\x20status:\x20','HTTP\x20','Failed\x20to\x20verify\x20Rapyd\x20payment:\x20','logWhiteDomainError','TesSoft\x20Payment\x20System/1.0','💳\x20Payment\x20Methods:\x20gb_visa_card,\x20gb_mastercard_card','2TRExXs','payment_method_data','merchant_reference_id','POST','Business\x20Error\x20(','41063oeYVPg','GET','paymentMethod','Unknown\x20error\x20from\x20Rapyd\x20API','Rapyd\x20API\x20error:\x20','text','EXP','last4',',\x20failureMessage=','__esModule','errorCode','🇬🇧\x20Country\x20used:\x20','PAYMENT_FAILED','===\x20RAPYD\x20API\x20REQUEST\x20(White\x20Domain\x20-\x20Updated\x20Format)\x20===','PAYMENT_CANCELED','Response\x20data:','Redirect\x20URL:','\x20(GB\x20-\x20Britain)','Headers:','26282yGJJTs','Rapyd\x20payment\x20verification\x20error:','fromEntries','Invalid\x20JSON\x20response\x20from\x20Rapyd\x20API:\x20','Error\x20message:','message','3280155uoGOTV','toUpperCase','defineProperty','Missing\x20id\x20or\x20redirect_url\x20in\x20response','loggerService','🇬🇧\x20Country:\x20','FAILED','SUCCESS','failure_message','failureCode','cardLast4','Payment\x20Link\x20ID:','UNKNOWN','Invalid\x20response\x20from\x20Rapyd\x20API:\x20missing\x20id\x20or\x20redirect_url','https://tesoft.uk/gateway/rapyd/','Error\x20Code:','RapydService','now','===\x20RAPYD\x20API\x20BUSINESS\x20ERROR\x20===','type','Error\x20details:','gb_visa_card','currency','stringify','Request\x20Body\x20(Updated\x20Format):','EXPIRED','ACT','🇬🇧\x20Using\x20GB\x20(Britain)\x20as\x20country\x20for\x20Rapyd\x20payment\x20link','🌐\x20Rapyd\x20service\x20initialized\x20with\x20white\x20domain\x20proxy','304qPJBTV','):\x20','none','Rapyd\x20API\x20error\x20(','rapyd','log','4156425JHSRpw','entries','payment_method_type','2075521caXcSo','16unuCYk','paid','error','json'];a42_0x4462=function(){return _0x282109;};return a42_0x4462();}