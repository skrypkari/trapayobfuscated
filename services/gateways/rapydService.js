'use strict';const a46_0x1125d2=a46_0x3046;function a46_0x3046(_0x414aca,_0x1c0292){const _0x53d3c1=a46_0x53d3();return a46_0x3046=function(_0x3046d8,_0x461a94){_0x3046d8=_0x3046d8-0xbc;let _0x35bff7=_0x53d3c1[_0x3046d8];return _0x35bff7;},a46_0x3046(_0x414aca,_0x1c0292);}(function(_0xd86986,_0x40bc4d){const _0x406b1e=a46_0x3046,_0x483242=_0xd86986();while(!![]){try{const _0x27cc06=-parseInt(_0x406b1e(0xbd))/0x1*(parseInt(_0x406b1e(0x122))/0x2)+parseInt(_0x406b1e(0x12c))/0x3*(parseInt(_0x406b1e(0x10f))/0x4)+parseInt(_0x406b1e(0xd8))/0x5*(-parseInt(_0x406b1e(0x127))/0x6)+-parseInt(_0x406b1e(0x101))/0x7*(parseInt(_0x406b1e(0x111))/0x8)+-parseInt(_0x406b1e(0xe5))/0x9*(parseInt(_0x406b1e(0x10e))/0xa)+parseInt(_0x406b1e(0xf5))/0xb*(-parseInt(_0x406b1e(0xea))/0xc)+-parseInt(_0x406b1e(0x11c))/0xd*(-parseInt(_0x406b1e(0xe3))/0xe);if(_0x27cc06===_0x40bc4d)break;else _0x483242['push'](_0x483242['shift']());}catch(_0x457fa7){_0x483242['push'](_0x483242['shift']());}}}(a46_0x53d3,0x46e44));Object['defineProperty'](exports,a46_0x1125d2(0xda),{'value':!![]}),exports['RapydService']=void 0x0;const loggerService_1=require(a46_0x1125d2(0x116));function a46_0x53d3(){const _0x363e45=['Failed\x20to\x20create\x20Rapyd\x20payment\x20link:\x20Unknown\x20error','99yXhGCQ','===\x20RAPYD\x20SERVICE\x20ERROR\x20===','üîÑ\x20Rapyd\x20webhook\x20processed:\x20status=','Failed\x20to\x20verify\x20Rapyd\x20payment:\x20','error','/v1/hosted/payment_links/','apiUrl','logWhiteDomainRequest','EXPIRED','PAID','none','https://tesoft.uk/gateway/fail.php?id=','7119VufBuR','CAN','üí≥\x20Payment\x20Methods:\x20gb_visa_card,\x20gb_mastercard_card','NEW','message','Status:','createPaymentLink','data','type','Error\x20details:','ERR','TesSoft\x20Payment\x20System/1.0','Unknown\x20error','574540WfHMMH','67064CpZspI','toUpperCase','4328TXdjEU','):\x20','Processing\x20Rapyd\x20webhook:','status','===\x20RAPYD\x20API\x20BUSINESS\x20ERROR\x20===','../loggerService','üá¨üáß\x20Country\x20used:\x20','Raw\x20Response\x20Body:','Business\x20Error\x20(','Error\x20message:','failure_code','29067688ythGHG','URL:','===\x20RAPYD\x20SUCCESS\x20===','statusText','currency','PAYMENT_CANCELED','2AfTNxy','stack','EXP','Payment\x20Link\x20ID:','payment_method_data','58956JYBDot','amount','Error\x20stack:','loggerService','merchant_reference_id','18zRAQjO','payment_method_type','===\x20RAPYD\x20API\x20INCOMPLETE\x20RESPONSE\x20===','Incomplete\x20response:\x20missing\x20id\x20or\x20redirect_url','headers','errorCode','CLO','POST','PAYMENT_COMPLETED','68727vOFehq','PAYMENT_FAILED',',\x20body:\x20','\x20(GB\x20-\x20Britain)','failureCode','Parsed\x20Result:','GET','\x20(always\x20GB\x20for\x20Rapyd)','HTTP\x20Status:','Status\x20Text:','ORDER:\x20','paymentMethod','Failed\x20to\x20create\x20Rapyd\x20payment\x20link:\x20','redirect_url','/v1/hosted/payment_links',',\x20failureMessage=','https://tesoft.uk/gateway/rapyd/','Rapyd\x20API\x20error:\x20','Invalid\x20response\x20from\x20Rapyd\x20API:\x20missing\x20id\x20or\x20redirect_url','FAILED','===\x20RAPYD\x20API\x20REQUEST\x20(White\x20Domain\x20-\x20Updated\x20Format)\x20===','===\x20PARSED\x20RAPYD\x20RESPONSE\x20===','Missing\x20id\x20or\x20redirect_url\x20in\x20response','Invalid\x20JSON\x20response\x20from\x20Rapyd\x20API:\x20','rapyd','logWhiteDomainResponse','json','170ZCqxbf','cardLast4','__esModule','stringify','paid','Error\x20Code:','now','Failed\x20to\x20parse\x20JSON\x20response:','error_code','HTTP\x20error!\x20status:\x20','SUCCESS','14KYBMDv','PENDING','90uZUtlx','parse','failure_message','logWhiteDomainError','Response\x20data:','691536xgzFmZ','text','application/json','log','Full\x20Error\x20Data:','Headers:','Rapyd\x20API\x20error\x20(','ACT','entries','JSON\x20Parse\x20Error:\x20'];a46_0x53d3=function(){return _0x363e45;};return a46_0x53d3();}class RapydService{constructor(){const _0x6389b2=a46_0x1125d2;this[_0x6389b2(0xfb)]=_0x6389b2(0xcd),console[_0x6389b2(0xed)]('üåê\x20Rapyd\x20service\x20initialized\x20with\x20white\x20domain\x20proxy');}async[a46_0x1125d2(0x107)](_0xa22960){const _0x344876=a46_0x1125d2,{orderId:_0x3c7c30,orderName:_0x58dfff,amount:_0x34a4a9,currency:_0x22eb65,usage:_0x2e2f2d,maxPayments:_0x3c7f65,successUrl:_0xaddaaa,failUrl:_0x5c9e9c}=_0xa22960,_0x4d5295=_0x22eb65[_0x344876(0x110)](),_0x1bfe50='GB';console[_0x344876(0xed)]('üá¨üáß\x20Using\x20GB\x20(Britain)\x20as\x20country\x20for\x20Rapyd\x20payment\x20link');const _0xd945f4='https://tesoft.uk/gateway/success.php?id='+_0x3c7c30,_0x4fc5d0=_0x344876(0x100)+_0x3c7c30,_0x3d4e90={'amount':_0x34a4a9,'currency':_0x4d5295,'cancel_checkout_url':_0x4fc5d0,'complete_checkout_url':_0xd945f4,'complete_payment_url':_0xd945f4,'merchant_reference_id':_0x3c7c30,'description':_0x344876(0xc7)+_0x3c7c30,'country':'GB','payment_method_types_include':['gb_visa_card','gb_mastercard_card'],'custom_elements':{'display_description':!![]}},_0x1b9121=Date[_0x344876(0xde)]();try{console['log'](_0x344876(0xd1)),console[_0x344876(0xed)](_0x344876(0x11d),this['apiUrl']),console['log']('Request\x20Body\x20(Updated\x20Format):',JSON[_0x344876(0xdb)](_0x3d4e90,null,0x2)),console[_0x344876(0xed)]('üá¨üáß\x20Country:\x20'+_0x1bfe50+_0x344876(0xc4)),console['log'](_0x344876(0x103)),loggerService_1['loggerService']['logWhiteDomainRequest'](_0x344876(0xd5),_0x344876(0xcb),_0x344876(0x133),_0x3d4e90);const _0x16365e=await fetch(this[_0x344876(0xfb)],{'method':_0x344876(0x133),'headers':{'Content-Type':_0x344876(0xec),'User-Agent':_0x344876(0x10c)},'body':JSON[_0x344876(0xdb)](_0x3d4e90)}),_0x52a976=Date[_0x344876(0xde)]()-_0x1b9121;console[_0x344876(0xed)]('===\x20RAPYD\x20API\x20RESPONSE\x20(White\x20Domain)\x20==='),console[_0x344876(0xed)](_0x344876(0x106),_0x16365e[_0x344876(0x114)]),console[_0x344876(0xed)](_0x344876(0xc6),_0x16365e[_0x344876(0x11f)]),console[_0x344876(0xed)](_0x344876(0xef),Object['fromEntries'](_0x16365e[_0x344876(0x130)][_0x344876(0xf2)]())),console[_0x344876(0xed)]('Response\x20Time:',_0x52a976+'ms');const _0x487fd1=await _0x16365e['text']();console[_0x344876(0xed)](_0x344876(0x118),_0x487fd1);if(!_0x16365e['ok']){console['error']('===\x20RAPYD\x20API\x20ERROR\x20==='),console[_0x344876(0xf9)](_0x344876(0xc5),_0x16365e[_0x344876(0x114)]),console[_0x344876(0xf9)]('Response\x20Body:',_0x487fd1),loggerService_1[_0x344876(0x12a)][_0x344876(0xd6)](_0x344876(0xd5),'/v1/hosted/payment_links',_0x16365e[_0x344876(0x114)],_0x487fd1,_0x52a976),loggerService_1[_0x344876(0x12a)][_0x344876(0xe8)](_0x344876(0xd5),_0x344876(0xcb),'HTTP\x20'+_0x16365e[_0x344876(0x114)]+':\x20'+_0x487fd1);throw new Error('HTTP\x20error!\x20status:\x20'+_0x16365e[_0x344876(0x114)]+_0x344876(0xbf)+_0x487fd1);}let _0x218f47;try{_0x218f47=JSON[_0x344876(0xe6)](_0x487fd1);}catch(_0x3c0a8d){console['error'](_0x344876(0xdf),_0x3c0a8d),loggerService_1[_0x344876(0x12a)][_0x344876(0xe8)]('rapyd',_0x344876(0xcb),_0x344876(0xf3)+_0x3c0a8d);throw new Error(_0x344876(0xd4)+_0x487fd1);}console[_0x344876(0xed)](_0x344876(0xd2)),console[_0x344876(0xed)](_0x344876(0xc2),JSON[_0x344876(0xdb)](_0x218f47,null,0x2)),loggerService_1[_0x344876(0x12a)][_0x344876(0xd6)]('rapyd','/v1/hosted/payment_links',_0x16365e[_0x344876(0x114)],_0x218f47,_0x52a976);if(_0x218f47['status']?.[_0x344876(0x114)]!==_0x344876(0xe2)){const _0x36ca66=_0x218f47['status']?.[_0x344876(0x105)]||'Unknown\x20error\x20from\x20Rapyd\x20API',_0x4e6004=_0x218f47[_0x344876(0x114)]?.[_0x344876(0xe0)]||'UNKNOWN';console[_0x344876(0xf9)](_0x344876(0x115)),console[_0x344876(0xf9)](_0x344876(0xdd),_0x4e6004),console[_0x344876(0xf9)]('Error\x20Message:',_0x36ca66),console[_0x344876(0xf9)](_0x344876(0xee),_0x218f47[_0x344876(0x114)]),loggerService_1['loggerService'][_0x344876(0xe8)]('rapyd','/v1/hosted/payment_links',_0x344876(0x119)+_0x4e6004+'):\x20'+_0x36ca66);throw new Error(_0x344876(0xf0)+_0x4e6004+_0x344876(0x112)+_0x36ca66);}if(!_0x218f47[_0x344876(0x108)]?.['id']||!_0x218f47['data']?.[_0x344876(0xca)]){console[_0x344876(0xf9)](_0x344876(0x12e)),console[_0x344876(0xf9)](_0x344876(0xd3)),console['error'](_0x344876(0xe9),_0x218f47[_0x344876(0x108)]),loggerService_1[_0x344876(0x12a)][_0x344876(0xe8)]('rapyd','/v1/hosted/payment_links',_0x344876(0x12f));throw new Error(_0x344876(0xcf));}return console[_0x344876(0xed)](_0x344876(0x11e)),console[_0x344876(0xed)](_0x344876(0x125),_0x218f47['data']['id']),console[_0x344876(0xed)]('Redirect\x20URL:',_0x218f47[_0x344876(0x108)][_0x344876(0xca)]),console[_0x344876(0xed)](_0x344876(0x117)+_0x1bfe50+_0x344876(0xc0)),console[_0x344876(0xed)]('üí≥\x20Payment\x20Methods:\x20gb_visa_card,\x20gb_mastercard_card'),{'gateway_payment_id':_0x218f47[_0x344876(0x108)]['id'],'payment_url':_0x218f47[_0x344876(0x108)]['redirect_url']};}catch(_0x3b8391){console[_0x344876(0xf9)](_0x344876(0xf6)),console[_0x344876(0xf9)](_0x344876(0x10a),_0x3b8391),loggerService_1[_0x344876(0x12a)]['logWhiteDomainError'](_0x344876(0xd5),_0x344876(0xcb),_0x3b8391);if(_0x3b8391 instanceof Error){console['error'](_0x344876(0x11a),_0x3b8391[_0x344876(0x105)]),console[_0x344876(0xf9)](_0x344876(0x129),_0x3b8391[_0x344876(0x123)]);throw new Error(_0x344876(0xc9)+_0x3b8391[_0x344876(0x105)]);}throw new Error(_0x344876(0xf4));}}async['verifyPayment'](_0x35b89c){const _0x5deb8a=a46_0x1125d2,_0xc070f0=Date[_0x5deb8a(0xde)]();try{loggerService_1[_0x5deb8a(0x12a)][_0x5deb8a(0xfc)](_0x5deb8a(0xd5),_0x5deb8a(0xfa)+_0x35b89c,'GET',{});const _0x3bd8dc=await fetch(this[_0x5deb8a(0xfb)]+'/'+_0x35b89c,{'method':_0x5deb8a(0xc3),'headers':{'Content-Type':_0x5deb8a(0xec),'User-Agent':_0x5deb8a(0x10c)}}),_0x162a09=Date[_0x5deb8a(0xde)]()-_0xc070f0;if(!_0x3bd8dc['ok']){const _0x1cc1dc=await _0x3bd8dc[_0x5deb8a(0xeb)]();loggerService_1[_0x5deb8a(0x12a)][_0x5deb8a(0xd6)](_0x5deb8a(0xd5),_0x5deb8a(0xfa)+_0x35b89c,_0x3bd8dc[_0x5deb8a(0x114)],_0x1cc1dc,_0x162a09);throw new Error(_0x5deb8a(0xe1)+_0x3bd8dc['status']);}const _0x269041=await _0x3bd8dc[_0x5deb8a(0xd7)]();loggerService_1[_0x5deb8a(0x12a)][_0x5deb8a(0xd6)](_0x5deb8a(0xd5),'/v1/hosted/payment_links/'+_0x35b89c,_0x3bd8dc['status'],_0x269041,_0x162a09);if(_0x269041[_0x5deb8a(0x114)]?.['status']!==_0x5deb8a(0xe2)){loggerService_1[_0x5deb8a(0x12a)]['logWhiteDomainError'](_0x5deb8a(0xd5),_0x5deb8a(0xfa)+_0x35b89c,'Rapyd\x20API\x20error:\x20'+(_0x269041[_0x5deb8a(0x114)]?.['message']||_0x5deb8a(0x10d)));throw new Error(_0x5deb8a(0xce)+(_0x269041['status']?.[_0x5deb8a(0x105)]||_0x5deb8a(0x10d)));}let _0xb3a3b6=_0x5deb8a(0xe4);if(_0x269041[_0x5deb8a(0x108)]?.[_0x5deb8a(0x114)])switch(_0x269041[_0x5deb8a(0x108)]['status'][_0x5deb8a(0x110)]()){case _0x5deb8a(0x132):_0xb3a3b6=_0x5deb8a(0xfe);break;case _0x5deb8a(0x102):_0xb3a3b6=_0x5deb8a(0xd0);break;case _0x5deb8a(0x124):_0xb3a3b6=_0x5deb8a(0xfd);break;case'ERR':_0xb3a3b6=_0x5deb8a(0xd0);break;case _0x5deb8a(0x104):case _0x5deb8a(0xf1):default:_0xb3a3b6=_0x5deb8a(0xe4);break;}return{'status':_0xb3a3b6,'amount':_0x269041[_0x5deb8a(0x108)]?.[_0x5deb8a(0x128)],'currency':_0x269041[_0x5deb8a(0x108)]?.[_0x5deb8a(0x120)]};}catch(_0x147260){console['error']('Rapyd\x20payment\x20verification\x20error:',_0x147260),loggerService_1['loggerService']['logWhiteDomainError'](_0x5deb8a(0xd5),_0x5deb8a(0xfa)+_0x35b89c,_0x147260);throw new Error(_0x5deb8a(0xf8)+(_0x147260 instanceof Error?_0x147260['message']:_0x5deb8a(0x10d)));}}async['processWebhook'](_0x319b6e){const _0x24ecfa=a46_0x1125d2;console['log'](_0x24ecfa(0x113),_0x319b6e);let _0xef6bcf=_0x24ecfa(0xe4),_0x3da21e;_0x319b6e['data']?.[_0x24ecfa(0xe7)]&&(_0x3da21e=_0x319b6e[_0x24ecfa(0x108)][_0x24ecfa(0xe7)],console['log']('üí•\x20Rapyd\x20failure\x20message:\x20'+_0x3da21e));switch(_0x319b6e[_0x24ecfa(0x109)]?.['toUpperCase']()){case _0x24ecfa(0xbc):_0x319b6e[_0x24ecfa(0x108)]?.[_0x24ecfa(0xdc)]===!![]&&_0x319b6e['data']?.[_0x24ecfa(0x114)]===_0x24ecfa(0x132)?_0xef6bcf=_0x24ecfa(0xfe):_0xef6bcf=_0x24ecfa(0xe4);break;case _0x24ecfa(0x121):_0xef6bcf=_0x24ecfa(0xd0);break;case'PAYMENT_EXPIRED':_0xef6bcf=_0x24ecfa(0xfd);break;case _0x24ecfa(0xbe):_0xef6bcf='FAILED';!_0x3da21e&&_0x319b6e[_0x24ecfa(0x108)]?.[_0x24ecfa(0xe7)]&&(_0x3da21e=_0x319b6e[_0x24ecfa(0x108)]['failure_message']);break;default:switch(_0x319b6e[_0x24ecfa(0x108)]?.[_0x24ecfa(0x114)]?.['toUpperCase']()){case _0x24ecfa(0x132):_0x319b6e[_0x24ecfa(0x108)]?.['paid']===!![]?_0xef6bcf='PAID':_0xef6bcf='FAILED';break;case _0x24ecfa(0x102):_0xef6bcf=_0x24ecfa(0xd0);break;case'EXP':_0xef6bcf=_0x24ecfa(0xfd);break;case _0x24ecfa(0x10b):_0xef6bcf='FAILED';!_0x3da21e&&_0x319b6e[_0x24ecfa(0x108)]?.[_0x24ecfa(0xe7)]&&(_0x3da21e=_0x319b6e[_0x24ecfa(0x108)][_0x24ecfa(0xe7)]);break;case _0x24ecfa(0x104):case _0x24ecfa(0xf1):default:_0xef6bcf='PENDING';break;}break;}const _0xf47640={};return _0x319b6e[_0x24ecfa(0x108)]?.['payment_method_data']?.['last4']&&(_0xf47640[_0x24ecfa(0xd9)]=_0x319b6e[_0x24ecfa(0x108)][_0x24ecfa(0x126)]['last4']),_0x319b6e[_0x24ecfa(0x108)]?.['payment_method_type']&&(_0xf47640[_0x24ecfa(0xc8)]=_0x319b6e['data'][_0x24ecfa(0x12d)]),_0x319b6e[_0x24ecfa(0x108)]?.[_0x24ecfa(0xe0)]&&(_0xf47640[_0x24ecfa(0x131)]=_0x319b6e[_0x24ecfa(0x108)]['error_code']),_0x319b6e[_0x24ecfa(0x108)]?.[_0x24ecfa(0x11b)]&&(_0xf47640[_0x24ecfa(0xc1)]=_0x319b6e['data'][_0x24ecfa(0x11b)]),console[_0x24ecfa(0xed)](_0x24ecfa(0xf7)+_0xef6bcf+_0x24ecfa(0xcc)+(_0x3da21e||_0x24ecfa(0xff))),{'paymentId':_0x319b6e[_0x24ecfa(0x108)]?.[_0x24ecfa(0x12b)]||'','status':_0xef6bcf,'amount':_0x319b6e['data']?.[_0x24ecfa(0x128)],'currency':_0x319b6e[_0x24ecfa(0x108)]?.['currency'],'failureMessage':_0x3da21e,'additionalInfo':_0xf47640};}}exports['RapydService']=RapydService;