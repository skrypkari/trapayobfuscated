'use strict';const a56_0x49c3f1=a56_0x5711;function a56_0x3fc1(){const _0x1e16da=['currency','\x20(GB\x20-\x20Britain)','Redirect\x20URL:','logWhiteDomainError','Payment\x20System/1.0','24dOVTQp','Incomplete\x20response:\x20missing\x20id\x20or\x20redirect_url','toISOString','HTTP\x20Status:','URL:','/v1/hosted/payment_links/','cardLast4','9270neNqHB','Error\x20message:','JSON\x20Parse\x20Error:\x20','PAYMENT_FAILED','ERR','json','===\x20RAPYD\x20API\x20RESPONSE\x20(White\x20Domain)\x20===','===\x20RAPYD\x20API\x20INCOMPLETE\x20RESPONSE\x20===','🇬🇧\x20Using\x20GB\x20(Britain)\x20as\x20country\x20for\x20Rapyd\x20payment\x20link','verifyPayment','CLO','Processing\x20Rapyd\x20webhook:','buy','loggerService','Status\x20Text:','Error\x20Message:','logWhiteDomainRequest','__esModule','Failed\x20to\x20create\x20Rapyd\x20payment\x20link:\x20','failure_message','fromEntries','logWhiteDomainResponse','stringify','log','💱\x20Adding\x20currency\x20conversion\x20fields\x20for\x20','EXPIRED','parse','30PYbnjx','/v1/hosted/payment_links','🔄\x20Rapyd\x20webhook\x20processed:\x20status=','18210ruZyjt','2242555wfcjpF','===\x20RAPYD\x20API\x20REQUEST\x20(White\x20Domain\x20-\x20Updated\x20Format)\x20===','Unknown\x20error','HTTP\x20','type','===\x20RAPYD\x20API\x20BUSINESS\x20ERROR\x20===','🇬🇧\x20Country:\x20','apiUrl','🇬🇧\x20Country\x20used:\x20','GET','UNKNOWN','Full\x20Error\x20Data:','../loggerService','8129OXbwfR','Error\x20details:','EXP','https://tesoft.uk/gateway/success.php?id=','failureCode','CAN','===\x20PARSED\x20RAPYD\x20RESPONSE\x20===','paid','paymentMethod','PAYMENT_CANCELED','expiration','last4','Invalid\x20JSON\x20response\x20from\x20Rapyd\x20API:\x20','message','Failed\x20to\x20create\x20Rapyd\x20payment\x20link:\x20Unknown\x20error','):\x20','failure_code','Status:','===\x20RAPYD\x20SUCCESS\x20===','🌐\x20Rapyd\x20service\x20initialized\x20with\x20white\x20domain\x20proxy','Payment\x20Link\x20ID:','760536lUotaz','now','ORDER:\x20','18263EvHyse','error_code','SUCCESS','\x20\x20\x20requested_currency:\x20EUR',',\x20failureMessage=','Raw\x20Response\x20Body:','errorCode','1590zobnoa','RapydService','5886448OSCywS','Error\x20stack:','\x20\x20\x20fixed_side:\x20buy','status','application/json','PAYMENT_EXPIRED','Response\x20Body:','PENDING','Missing\x20id\x20or\x20redirect_url\x20in\x20response','processWebhook','data','Headers:','Rapyd\x20payment\x20verification\x20error:','floor','Failed\x20to\x20parse\x20JSON\x20response:','gb_visa_card','Unknown\x20error\x20from\x20Rapyd\x20API','error','none','Response\x20data:','PAYMENT_COMPLETED','payment_method_data','FAILED','entries','POST','merchant_reference_id','Error\x20Code:','redirect_url','\x20\x20\x20expiration:\x20','===\x20RAPYD\x20API\x20ERROR\x20===','toUpperCase','https://tesoft.uk/gateway/rapyd/','rapyd','headers','Rapyd\x20API\x20error:\x20','Business\x20Error\x20(','EUR','amount','PAID','Response\x20Time:','payment_method_type','NEW','6075UbEuww'];a56_0x3fc1=function(){return _0x1e16da;};return a56_0x3fc1();}function a56_0x5711(_0x11308e,_0x5cc5c8){const _0x3fc131=a56_0x3fc1();return a56_0x5711=function(_0x571182,_0x344ba1){_0x571182=_0x571182-0x93;let _0x5815d6=_0x3fc131[_0x571182];return _0x5815d6;},a56_0x5711(_0x11308e,_0x5cc5c8);}(function(_0x30995a,_0x23a5dc){const _0xad14f9=a56_0x5711,_0x1bb67e=_0x30995a();while(!![]){try{const _0x4f3bda=parseInt(_0xad14f9(0xab))/0x1*(parseInt(_0xad14f9(0x106))/0x2)+parseInt(_0xad14f9(0xde))/0x3+parseInt(_0xad14f9(0xb4))/0x4+-parseInt(_0xad14f9(0xb2))/0x5*(parseInt(_0xad14f9(0x109))/0x6)+parseInt(_0xad14f9(0x10a))/0x7*(parseInt(_0xad14f9(0xe4))/0x8)+-parseInt(_0xad14f9(0xa8))/0x9+-parseInt(_0xad14f9(0xeb))/0xa*(parseInt(_0xad14f9(0x93))/0xb);if(_0x4f3bda===_0x23a5dc)break;else _0x1bb67e['push'](_0x1bb67e['shift']());}catch(_0x19718a){_0x1bb67e['push'](_0x1bb67e['shift']());}}}(a56_0x3fc1,0xedca6));Object['defineProperty'](exports,a56_0x49c3f1(0xfc),{'value':!![]}),exports[a56_0x49c3f1(0xb3)]=void 0x0;const loggerService_1=require(a56_0x49c3f1(0x116));class RapydService{constructor(){const _0x5e9ad4=a56_0x49c3f1;this[_0x5e9ad4(0x111)]=_0x5e9ad4(0xd3),console[_0x5e9ad4(0x102)](_0x5e9ad4(0xa6));}async['createPaymentLink'](_0x5c1425){const _0x39f2a7=a56_0x49c3f1,{orderId:_0x4196da,orderName:_0x35fcc0,amount:_0x227458,currency:_0x54deef,usage:_0x479785,maxPayments:_0x30b14e,successUrl:_0x328b5d,failUrl:_0xf882a4}=_0x5c1425,_0x3b8bda=_0x54deef['toUpperCase'](),_0x1401ce='GB';console[_0x39f2a7(0x102)](_0x39f2a7(0xf3));const _0x294064=_0x39f2a7(0x96)+_0x4196da,_0x3dc787='https://tesoft.uk/gateway/fail.php?id='+_0x4196da,_0x52108a={'amount':_0x227458,'currency':_0x3b8bda,'cancel_checkout_url':_0x3dc787,'complete_checkout_url':_0x294064,'complete_payment_url':_0x294064,'merchant_reference_id':_0x4196da,'description':_0x39f2a7(0xaa)+_0x4196da,'country':'GB','payment_method_types_include':[_0x39f2a7(0xc3),'gb_mastercard_card'],'custom_elements':{'display_description':!![]}};if(_0x3b8bda!==_0x39f2a7(0xd8)){const _0x3ed6a1=Math[_0x39f2a7(0xc1)](Date[_0x39f2a7(0xa9)]()/0x3e8)+0x1e*0x3c;_0x52108a['fixed_side']=_0x39f2a7(0xf7),_0x52108a['requested_currency']=_0x39f2a7(0xd8),_0x52108a[_0x39f2a7(0x9d)]=_0x3ed6a1,console[_0x39f2a7(0x102)](_0x39f2a7(0x103)+_0x3b8bda+'\x20->\x20EUR:'),console[_0x39f2a7(0x102)](_0x39f2a7(0xb6)),console[_0x39f2a7(0x102)](_0x39f2a7(0xae)),console[_0x39f2a7(0x102)](_0x39f2a7(0xd0)+_0x3ed6a1+'\x20('+new Date(_0x3ed6a1*0x3e8)[_0x39f2a7(0xe6)]()+')');}const _0x49650b=Date[_0x39f2a7(0xa9)]();try{console[_0x39f2a7(0x102)](_0x39f2a7(0x10b)),console['log'](_0x39f2a7(0xe8),this[_0x39f2a7(0x111)]),console[_0x39f2a7(0x102)]('Request\x20Body\x20(Updated\x20Format):',JSON[_0x39f2a7(0x101)](_0x52108a,null,0x2)),console[_0x39f2a7(0x102)](_0x39f2a7(0x110)+_0x1401ce+'\x20(always\x20GB\x20for\x20Rapyd)'),console[_0x39f2a7(0x102)]('💳\x20Payment\x20Methods:\x20gb_visa_card,\x20gb_mastercard_card'),loggerService_1[_0x39f2a7(0xf8)]['logWhiteDomainRequest']('rapyd',_0x39f2a7(0x107),'POST',_0x52108a);const _0x3c457c=await fetch(this[_0x39f2a7(0x111)],{'method':_0x39f2a7(0xcc),'headers':{'Content-Type':_0x39f2a7(0xb8),'User-Agent':_0x39f2a7(0xe3)},'body':JSON['stringify'](_0x52108a)}),_0x2501eb=Date['now']()-_0x49650b;console[_0x39f2a7(0x102)](_0x39f2a7(0xf1)),console[_0x39f2a7(0x102)](_0x39f2a7(0xa4),_0x3c457c[_0x39f2a7(0xb7)]),console[_0x39f2a7(0x102)](_0x39f2a7(0xf9),_0x3c457c['statusText']),console[_0x39f2a7(0x102)](_0x39f2a7(0xbf),Object[_0x39f2a7(0xff)](_0x3c457c[_0x39f2a7(0xd5)][_0x39f2a7(0xcb)]())),console[_0x39f2a7(0x102)](_0x39f2a7(0xdb),_0x2501eb+'ms');const _0x466ede=await _0x3c457c['text']();console[_0x39f2a7(0x102)](_0x39f2a7(0xb0),_0x466ede);if(!_0x3c457c['ok']){console[_0x39f2a7(0xc5)](_0x39f2a7(0xd1)),console[_0x39f2a7(0xc5)](_0x39f2a7(0xe7),_0x3c457c[_0x39f2a7(0xb7)]),console[_0x39f2a7(0xc5)](_0x39f2a7(0xba),_0x466ede),loggerService_1['loggerService'][_0x39f2a7(0x100)](_0x39f2a7(0xd4),_0x39f2a7(0x107),_0x3c457c[_0x39f2a7(0xb7)],_0x466ede,_0x2501eb),loggerService_1[_0x39f2a7(0xf8)][_0x39f2a7(0xe2)](_0x39f2a7(0xd4),_0x39f2a7(0x107),_0x39f2a7(0x10d)+_0x3c457c[_0x39f2a7(0xb7)]+':\x20'+_0x466ede);throw new Error('HTTP\x20error!\x20status:\x20'+_0x3c457c[_0x39f2a7(0xb7)]+',\x20body:\x20'+_0x466ede);}let _0x51f182;try{_0x51f182=JSON[_0x39f2a7(0x105)](_0x466ede);}catch(_0x4eab39){console['error'](_0x39f2a7(0xc2),_0x4eab39),loggerService_1[_0x39f2a7(0xf8)][_0x39f2a7(0xe2)](_0x39f2a7(0xd4),_0x39f2a7(0x107),_0x39f2a7(0xed)+_0x4eab39);throw new Error(_0x39f2a7(0x9f)+_0x466ede);}console[_0x39f2a7(0x102)](_0x39f2a7(0x99)),console['log']('Parsed\x20Result:',JSON[_0x39f2a7(0x101)](_0x51f182,null,0x2)),loggerService_1[_0x39f2a7(0xf8)]['logWhiteDomainResponse'](_0x39f2a7(0xd4),'/v1/hosted/payment_links',_0x3c457c['status'],_0x51f182,_0x2501eb);if(_0x51f182[_0x39f2a7(0xb7)]?.[_0x39f2a7(0xb7)]!==_0x39f2a7(0xad)){const _0x2ae5ec=_0x51f182[_0x39f2a7(0xb7)]?.[_0x39f2a7(0xa0)]||_0x39f2a7(0xc4),_0x54d303=_0x51f182[_0x39f2a7(0xb7)]?.[_0x39f2a7(0xac)]||_0x39f2a7(0x114);console[_0x39f2a7(0xc5)](_0x39f2a7(0x10f)),console[_0x39f2a7(0xc5)](_0x39f2a7(0xce),_0x54d303),console[_0x39f2a7(0xc5)](_0x39f2a7(0xfa),_0x2ae5ec),console[_0x39f2a7(0xc5)](_0x39f2a7(0x115),_0x51f182['status']),loggerService_1[_0x39f2a7(0xf8)]['logWhiteDomainError'](_0x39f2a7(0xd4),_0x39f2a7(0x107),_0x39f2a7(0xd7)+_0x54d303+_0x39f2a7(0xa2)+_0x2ae5ec);throw new Error('Rapyd\x20API\x20error\x20('+_0x54d303+_0x39f2a7(0xa2)+_0x2ae5ec);}if(!_0x51f182[_0x39f2a7(0xbe)]?.['id']||!_0x51f182[_0x39f2a7(0xbe)]?.[_0x39f2a7(0xcf)]){console[_0x39f2a7(0xc5)](_0x39f2a7(0xf2)),console[_0x39f2a7(0xc5)](_0x39f2a7(0xbc)),console['error'](_0x39f2a7(0xc7),_0x51f182['data']),loggerService_1[_0x39f2a7(0xf8)][_0x39f2a7(0xe2)](_0x39f2a7(0xd4),_0x39f2a7(0x107),_0x39f2a7(0xe5));throw new Error('Invalid\x20response\x20from\x20Rapyd\x20API:\x20missing\x20id\x20or\x20redirect_url');}return console[_0x39f2a7(0x102)](_0x39f2a7(0xa5)),console['log'](_0x39f2a7(0xa7),_0x51f182[_0x39f2a7(0xbe)]['id']),console['log'](_0x39f2a7(0xe1),_0x51f182['data'][_0x39f2a7(0xcf)]),console[_0x39f2a7(0x102)](_0x39f2a7(0x112)+_0x1401ce+_0x39f2a7(0xe0)),console[_0x39f2a7(0x102)]('💳\x20Payment\x20Methods:\x20gb_visa_card,\x20gb_mastercard_card'),{'gateway_payment_id':_0x51f182[_0x39f2a7(0xbe)]['id'],'payment_url':_0x51f182[_0x39f2a7(0xbe)][_0x39f2a7(0xcf)]};}catch(_0x36abd2){console[_0x39f2a7(0xc5)]('===\x20RAPYD\x20SERVICE\x20ERROR\x20==='),console[_0x39f2a7(0xc5)](_0x39f2a7(0x94),_0x36abd2),loggerService_1[_0x39f2a7(0xf8)][_0x39f2a7(0xe2)]('rapyd','/v1/hosted/payment_links',_0x36abd2);if(_0x36abd2 instanceof Error){console[_0x39f2a7(0xc5)](_0x39f2a7(0xec),_0x36abd2[_0x39f2a7(0xa0)]),console['error'](_0x39f2a7(0xb5),_0x36abd2['stack']);throw new Error(_0x39f2a7(0xfd)+_0x36abd2[_0x39f2a7(0xa0)]);}throw new Error(_0x39f2a7(0xa1));}}async[a56_0x49c3f1(0xf4)](_0xae0847){const _0x179758=a56_0x49c3f1,_0x258245=Date[_0x179758(0xa9)]();try{loggerService_1['loggerService'][_0x179758(0xfb)](_0x179758(0xd4),_0x179758(0xe9)+_0xae0847,_0x179758(0x113),{});const _0x53094c=await fetch(this[_0x179758(0x111)]+'/'+_0xae0847,{'method':'GET','headers':{'Content-Type':'application/json','User-Agent':'Payment\x20System/1.0'}}),_0x160f66=Date[_0x179758(0xa9)]()-_0x258245;if(!_0x53094c['ok']){const _0x3e360a=await _0x53094c['text']();loggerService_1['loggerService'][_0x179758(0x100)](_0x179758(0xd4),_0x179758(0xe9)+_0xae0847,_0x53094c['status'],_0x3e360a,_0x160f66);throw new Error('HTTP\x20error!\x20status:\x20'+_0x53094c[_0x179758(0xb7)]);}const _0x311a43=await _0x53094c[_0x179758(0xf0)]();loggerService_1[_0x179758(0xf8)][_0x179758(0x100)]('rapyd',_0x179758(0xe9)+_0xae0847,_0x53094c[_0x179758(0xb7)],_0x311a43,_0x160f66);if(_0x311a43[_0x179758(0xb7)]?.['status']!==_0x179758(0xad)){loggerService_1[_0x179758(0xf8)]['logWhiteDomainError']('rapyd',_0x179758(0xe9)+_0xae0847,_0x179758(0xd6)+(_0x311a43[_0x179758(0xb7)]?.[_0x179758(0xa0)]||'Unknown\x20error'));throw new Error(_0x179758(0xd6)+(_0x311a43[_0x179758(0xb7)]?.[_0x179758(0xa0)]||_0x179758(0x10c)));}let _0x5a643a=_0x179758(0xbb);if(_0x311a43['data']?.[_0x179758(0xb7)])switch(_0x311a43['data']['status'][_0x179758(0xd2)]()){case _0x179758(0xf5):_0x5a643a='PAID';break;case _0x179758(0x98):_0x5a643a='FAILED';break;case _0x179758(0x95):_0x5a643a=_0x179758(0x104);break;case _0x179758(0xef):_0x5a643a=_0x179758(0xca);break;case _0x179758(0xdd):case'ACT':default:_0x5a643a=_0x179758(0xbb);break;}return{'status':_0x5a643a,'amount':_0x311a43['data']?.['amount'],'currency':_0x311a43[_0x179758(0xbe)]?.[_0x179758(0xdf)]};}catch(_0x43c18d){console[_0x179758(0xc5)](_0x179758(0xc0),_0x43c18d),loggerService_1[_0x179758(0xf8)][_0x179758(0xe2)](_0x179758(0xd4),'/v1/hosted/payment_links/'+_0xae0847,_0x43c18d);throw new Error('Failed\x20to\x20verify\x20Rapyd\x20payment:\x20'+(_0x43c18d instanceof Error?_0x43c18d[_0x179758(0xa0)]:_0x179758(0x10c)));}}async[a56_0x49c3f1(0xbd)](_0x5e96d2){const _0x2940ec=a56_0x49c3f1;console[_0x2940ec(0x102)](_0x2940ec(0xf6),_0x5e96d2);let _0x242094='PENDING',_0x4cf23a;_0x5e96d2[_0x2940ec(0xbe)]?.[_0x2940ec(0xfe)]&&(_0x4cf23a=_0x5e96d2[_0x2940ec(0xbe)][_0x2940ec(0xfe)],console[_0x2940ec(0x102)]('💥\x20Rapyd\x20failure\x20message:\x20'+_0x4cf23a));switch(_0x5e96d2[_0x2940ec(0x10e)]?.[_0x2940ec(0xd2)]()){case _0x2940ec(0xc8):_0x5e96d2[_0x2940ec(0xbe)]?.[_0x2940ec(0x9a)]===!![]&&_0x5e96d2[_0x2940ec(0xbe)]?.[_0x2940ec(0xb7)]==='CLO'?_0x242094=_0x2940ec(0xda):_0x242094=_0x2940ec(0xbb);break;case _0x2940ec(0x9c):_0x242094=_0x2940ec(0xca);break;case _0x2940ec(0xb9):_0x242094='EXPIRED';break;case _0x2940ec(0xee):_0x242094=_0x2940ec(0xca);!_0x4cf23a&&_0x5e96d2['data']?.[_0x2940ec(0xfe)]&&(_0x4cf23a=_0x5e96d2[_0x2940ec(0xbe)][_0x2940ec(0xfe)]);break;default:switch(_0x5e96d2[_0x2940ec(0xbe)]?.[_0x2940ec(0xb7)]?.[_0x2940ec(0xd2)]()){case _0x2940ec(0xf5):_0x5e96d2[_0x2940ec(0xbe)]?.['paid']===!![]?_0x242094='PAID':_0x242094='FAILED';break;case _0x2940ec(0x98):_0x242094='FAILED';break;case _0x2940ec(0x95):_0x242094=_0x2940ec(0x104);break;case _0x2940ec(0xef):_0x242094=_0x2940ec(0xca);!_0x4cf23a&&_0x5e96d2[_0x2940ec(0xbe)]?.[_0x2940ec(0xfe)]&&(_0x4cf23a=_0x5e96d2[_0x2940ec(0xbe)][_0x2940ec(0xfe)]);break;case _0x2940ec(0xdd):case'ACT':default:_0x242094=_0x2940ec(0xbb);break;}break;}const _0x1d261b={};return _0x5e96d2['data']?.[_0x2940ec(0xc9)]?.[_0x2940ec(0x9e)]&&(_0x1d261b[_0x2940ec(0xea)]=_0x5e96d2[_0x2940ec(0xbe)]['payment_method_data'][_0x2940ec(0x9e)]),_0x5e96d2[_0x2940ec(0xbe)]?.['payment_method_type']&&(_0x1d261b[_0x2940ec(0x9b)]=_0x5e96d2['data'][_0x2940ec(0xdc)]),_0x5e96d2[_0x2940ec(0xbe)]?.[_0x2940ec(0xac)]&&(_0x1d261b[_0x2940ec(0xb1)]=_0x5e96d2[_0x2940ec(0xbe)][_0x2940ec(0xac)]),_0x5e96d2[_0x2940ec(0xbe)]?.[_0x2940ec(0xa3)]&&(_0x1d261b[_0x2940ec(0x97)]=_0x5e96d2['data'][_0x2940ec(0xa3)]),console[_0x2940ec(0x102)](_0x2940ec(0x108)+_0x242094+_0x2940ec(0xaf)+(_0x4cf23a||_0x2940ec(0xc6))),{'paymentId':_0x5e96d2[_0x2940ec(0xbe)]?.[_0x2940ec(0xcd)]||'','status':_0x242094,'amount':_0x5e96d2[_0x2940ec(0xbe)]?.[_0x2940ec(0xd9)],'currency':_0x5e96d2[_0x2940ec(0xbe)]?.[_0x2940ec(0xdf)],'failureMessage':_0x4cf23a,'additionalInfo':_0x1d261b};}}exports['RapydService']=RapydService;