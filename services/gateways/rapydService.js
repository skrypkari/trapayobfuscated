'use strict';const a44_0x32886a=a44_0x4df4;(function(_0x3acc59,_0x2cad21){const _0x4d4b7b=a44_0x4df4,_0x367f02=_0x3acc59();while(!![]){try{const _0x593167=-parseInt(_0x4d4b7b(0x91))/0x1*(-parseInt(_0x4d4b7b(0x7c))/0x2)+-parseInt(_0x4d4b7b(0x6e))/0x3+parseInt(_0x4d4b7b(0x7b))/0x4+-parseInt(_0x4d4b7b(0x76))/0x5*(-parseInt(_0x4d4b7b(0xd8))/0x6)+-parseInt(_0x4d4b7b(0xaa))/0x7*(-parseInt(_0x4d4b7b(0xba))/0x8)+-parseInt(_0x4d4b7b(0x77))/0x9+parseInt(_0x4d4b7b(0x93))/0xa*(parseInt(_0x4d4b7b(0x88))/0xb);if(_0x593167===_0x2cad21)break;else _0x367f02['push'](_0x367f02['shift']());}catch(_0x165fc4){_0x367f02['push'](_0x367f02['shift']());}}}(a44_0x25c9,0x55d1b));function a44_0x25c9(){const _0xe1cdf0=['cardLast4','last4','logWhiteDomainResponse','currency','12192LSAjcj','Parsed\x20Result:','verifyPayment','PAYMENT_CANCELED','POST','defineProperty','Headers:','gb_visa_card','üí≥\x20Payment\x20Methods:\x20gb_visa_card,\x20gb_mastercard_card','message','PAID','/v1/hosted/payment_links','Missing\x20id\x20or\x20redirect_url\x20in\x20response',',\x20body:\x20','fromEntries','===\x20RAPYD\x20API\x20RESPONSE\x20(White\x20Domain)\x20===','1693014Nooaon','stack','===\x20PARSED\x20RAPYD\x20RESPONSE\x20===','error','CLO','\x20(GB\x20-\x20Britain)','RapydService','===\x20RAPYD\x20API\x20INCOMPLETE\x20RESPONSE\x20===','115CMDhNN','4684689gcKiUF','rapyd','paymentMethod','parse','2280664UbjMvI','13042MaMjzC','Error\x20message:','ORDER:\x20','log','Rapyd\x20payment\x20verification\x20error:','logWhiteDomainRequest','apiUrl','redirect_url','PAYMENT_COMPLETED','amount','toUpperCase','Processing\x20Rapyd\x20webhook:','8371ARZBfI','EXPIRED','üá¨üáß\x20Country:\x20','\x20(always\x20GB\x20for\x20Rapyd)','Raw\x20Response\x20Body:','json','PAYMENT_EXPIRED','paid','Payment\x20Link\x20ID:','63kwpIzO',',\x20failureMessage=','490tgVTHj','TesSoft\x20Payment\x20System/1.0','Response\x20Body:','URL:','Error\x20Code:','FAILED','HTTP\x20','===\x20RAPYD\x20SERVICE\x20ERROR\x20===','PENDING','üîÑ\x20Rapyd\x20webhook\x20processed:\x20status=','Unknown\x20error','Error\x20Message:','errorCode','loggerService','status','logWhiteDomainError','SUCCESS','HTTP\x20Status:','HTTP\x20error!\x20status:\x20','gb_mastercard_card','none','Error\x20details:','now','12320hbPbcV','application/json','payment_method_type','===\x20RAPYD\x20API\x20REQUEST\x20(White\x20Domain\x20-\x20Updated\x20Format)\x20===','Failed\x20to\x20verify\x20Rapyd\x20payment:\x20','/v1/hosted/payment_links/','NEW','Error\x20stack:','merchant_reference_id','EXP','===\x20RAPYD\x20SUCCESS\x20===','Failed\x20to\x20create\x20Rapyd\x20payment\x20link:\x20','entries','CAN','Full\x20Error\x20Data:','Invalid\x20JSON\x20response\x20from\x20Rapyd\x20API:\x20','1688ZupBJV','headers','Redirect\x20URL:','Request\x20Body\x20(Updated\x20Format):','Business\x20Error\x20(','stringify','Unknown\x20error\x20from\x20Rapyd\x20API','Failed\x20to\x20create\x20Rapyd\x20payment\x20link:\x20Unknown\x20error','https://tesoft.uk/gateway/fail.php?id=','Rapyd\x20API\x20error:\x20','PAYMENT_FAILED','):\x20','Rapyd\x20API\x20error\x20(','type','üá¨üáß\x20Using\x20GB\x20(Britain)\x20as\x20country\x20for\x20Rapyd\x20payment\x20link','createPaymentLink','failure_code','error_code','Invalid\x20response\x20from\x20Rapyd\x20API:\x20missing\x20id\x20or\x20redirect_url','ERR','processWebhook','data','payment_method_data','Status\x20Text:','üåê\x20Rapyd\x20service\x20initialized\x20with\x20white\x20domain\x20proxy','failure_message'];a44_0x25c9=function(){return _0xe1cdf0;};return a44_0x25c9();}Object[a44_0x32886a(0xdd)](exports,'__esModule',{'value':!![]}),exports[a44_0x32886a(0x74)]=void 0x0;const loggerService_1=require('../loggerService');class RapydService{constructor(){const _0x6d932=a44_0x32886a;this[_0x6d932(0x82)]='https://tesoft.uk/gateway/rapyd/',console[_0x6d932(0x7f)](_0x6d932(0xd2));}async[a44_0x32886a(0xc9)](_0x58f996){const _0xaab5d5=a44_0x32886a,{orderId:_0x3f72fe,orderName:_0x330cb8,amount:_0x212ee4,currency:_0x4dc108,usage:_0x5c93f9,maxPayments:_0x56ceba,successUrl:_0x488f39,failUrl:_0xe57a5e}=_0x58f996,_0x28214e=_0x4dc108[_0xaab5d5(0x86)](),_0x20efb2='GB';console['log'](_0xaab5d5(0xc8));const _0x477548='https://tesoft.uk/gateway/success.php?id='+_0x3f72fe,_0xea88df=_0xaab5d5(0xc2)+_0x3f72fe,_0x2e8251={'amount':_0x212ee4,'currency':_0x28214e,'cancel_checkout_url':_0xea88df,'complete_checkout_url':_0x477548,'complete_payment_url':_0x477548,'merchant_reference_id':_0x3f72fe,'description':_0xaab5d5(0x7e)+_0x3f72fe,'country':'GB','payment_method_types_include':[_0xaab5d5(0x65),_0xaab5d5(0xa6)],'custom_elements':{'display_description':!![]}},_0x488065=Date['now']();try{console[_0xaab5d5(0x7f)](_0xaab5d5(0xad)),console[_0xaab5d5(0x7f)](_0xaab5d5(0x96),this[_0xaab5d5(0x82)]),console[_0xaab5d5(0x7f)](_0xaab5d5(0xbd),JSON['stringify'](_0x2e8251,null,0x2)),console[_0xaab5d5(0x7f)](_0xaab5d5(0x8a)+_0x20efb2+_0xaab5d5(0x8b)),console[_0xaab5d5(0x7f)](_0xaab5d5(0x66)),loggerService_1[_0xaab5d5(0xa0)][_0xaab5d5(0x81)]('rapyd',_0xaab5d5(0x69),_0xaab5d5(0xdc),_0x2e8251);const _0x2918ef=await fetch(this[_0xaab5d5(0x82)],{'method':'POST','headers':{'Content-Type':_0xaab5d5(0xab),'User-Agent':_0xaab5d5(0x94)},'body':JSON[_0xaab5d5(0xbf)](_0x2e8251)}),_0x59380b=Date[_0xaab5d5(0xa9)]()-_0x488065;console[_0xaab5d5(0x7f)](_0xaab5d5(0x6d)),console['log']('Status:',_0x2918ef[_0xaab5d5(0xa1)]),console[_0xaab5d5(0x7f)](_0xaab5d5(0xd1),_0x2918ef['statusText']),console['log'](_0xaab5d5(0x64),Object[_0xaab5d5(0x6c)](_0x2918ef[_0xaab5d5(0xbb)][_0xaab5d5(0xb6)]())),console[_0xaab5d5(0x7f)]('Response\x20Time:',_0x59380b+'ms');const _0x57dc57=await _0x2918ef['text']();console[_0xaab5d5(0x7f)](_0xaab5d5(0x8c),_0x57dc57);if(!_0x2918ef['ok']){console['error']('===\x20RAPYD\x20API\x20ERROR\x20==='),console[_0xaab5d5(0x71)](_0xaab5d5(0xa4),_0x2918ef['status']),console[_0xaab5d5(0x71)](_0xaab5d5(0x95),_0x57dc57),loggerService_1[_0xaab5d5(0xa0)][_0xaab5d5(0xd6)](_0xaab5d5(0x78),_0xaab5d5(0x69),_0x2918ef[_0xaab5d5(0xa1)],_0x57dc57,_0x59380b),loggerService_1[_0xaab5d5(0xa0)][_0xaab5d5(0xa2)](_0xaab5d5(0x78),'/v1/hosted/payment_links',_0xaab5d5(0x99)+_0x2918ef[_0xaab5d5(0xa1)]+':\x20'+_0x57dc57);throw new Error(_0xaab5d5(0xa5)+_0x2918ef[_0xaab5d5(0xa1)]+_0xaab5d5(0x6b)+_0x57dc57);}let _0x4ed603;try{_0x4ed603=JSON[_0xaab5d5(0x7a)](_0x57dc57);}catch(_0x373ab9){console[_0xaab5d5(0x71)]('Failed\x20to\x20parse\x20JSON\x20response:',_0x373ab9),loggerService_1[_0xaab5d5(0xa0)][_0xaab5d5(0xa2)](_0xaab5d5(0x78),'/v1/hosted/payment_links','JSON\x20Parse\x20Error:\x20'+_0x373ab9);throw new Error(_0xaab5d5(0xb9)+_0x57dc57);}console['log'](_0xaab5d5(0x70)),console[_0xaab5d5(0x7f)](_0xaab5d5(0xd9),JSON[_0xaab5d5(0xbf)](_0x4ed603,null,0x2)),loggerService_1['loggerService'][_0xaab5d5(0xd6)]('rapyd',_0xaab5d5(0x69),_0x2918ef[_0xaab5d5(0xa1)],_0x4ed603,_0x59380b);if(_0x4ed603['status']?.[_0xaab5d5(0xa1)]!==_0xaab5d5(0xa3)){const _0x26ca6b=_0x4ed603[_0xaab5d5(0xa1)]?.['message']||_0xaab5d5(0xc0),_0x20d19b=_0x4ed603[_0xaab5d5(0xa1)]?.[_0xaab5d5(0xcb)]||'UNKNOWN';console[_0xaab5d5(0x71)]('===\x20RAPYD\x20API\x20BUSINESS\x20ERROR\x20==='),console[_0xaab5d5(0x71)](_0xaab5d5(0x97),_0x20d19b),console[_0xaab5d5(0x71)](_0xaab5d5(0x9e),_0x26ca6b),console[_0xaab5d5(0x71)](_0xaab5d5(0xb8),_0x4ed603[_0xaab5d5(0xa1)]),loggerService_1[_0xaab5d5(0xa0)][_0xaab5d5(0xa2)](_0xaab5d5(0x78),_0xaab5d5(0x69),_0xaab5d5(0xbe)+_0x20d19b+_0xaab5d5(0xc5)+_0x26ca6b);throw new Error(_0xaab5d5(0xc6)+_0x20d19b+'):\x20'+_0x26ca6b);}if(!_0x4ed603[_0xaab5d5(0xcf)]?.['id']||!_0x4ed603[_0xaab5d5(0xcf)]?.['redirect_url']){console[_0xaab5d5(0x71)](_0xaab5d5(0x75)),console[_0xaab5d5(0x71)](_0xaab5d5(0x6a)),console[_0xaab5d5(0x71)]('Response\x20data:',_0x4ed603['data']),loggerService_1['loggerService'][_0xaab5d5(0xa2)](_0xaab5d5(0x78),'/v1/hosted/payment_links','Incomplete\x20response:\x20missing\x20id\x20or\x20redirect_url');throw new Error(_0xaab5d5(0xcc));}return console['log'](_0xaab5d5(0xb4)),console['log'](_0xaab5d5(0x90),_0x4ed603[_0xaab5d5(0xcf)]['id']),console[_0xaab5d5(0x7f)](_0xaab5d5(0xbc),_0x4ed603['data'][_0xaab5d5(0x83)]),console[_0xaab5d5(0x7f)]('üá¨üáß\x20Country\x20used:\x20'+_0x20efb2+_0xaab5d5(0x73)),console[_0xaab5d5(0x7f)]('üí≥\x20Payment\x20Methods:\x20gb_visa_card,\x20gb_mastercard_card'),{'gateway_payment_id':_0x4ed603[_0xaab5d5(0xcf)]['id'],'payment_url':_0x4ed603[_0xaab5d5(0xcf)][_0xaab5d5(0x83)]};}catch(_0x411011){console[_0xaab5d5(0x71)](_0xaab5d5(0x9a)),console[_0xaab5d5(0x71)](_0xaab5d5(0xa8),_0x411011),loggerService_1[_0xaab5d5(0xa0)][_0xaab5d5(0xa2)]('rapyd',_0xaab5d5(0x69),_0x411011);if(_0x411011 instanceof Error){console[_0xaab5d5(0x71)](_0xaab5d5(0x7d),_0x411011[_0xaab5d5(0x67)]),console[_0xaab5d5(0x71)](_0xaab5d5(0xb1),_0x411011[_0xaab5d5(0x6f)]);throw new Error(_0xaab5d5(0xb5)+_0x411011[_0xaab5d5(0x67)]);}throw new Error(_0xaab5d5(0xc1));}}async[a44_0x32886a(0xda)](_0x24ea34){const _0x29e205=a44_0x32886a,_0x10a11d=Date['now']();try{loggerService_1[_0x29e205(0xa0)][_0x29e205(0x81)]('rapyd',_0x29e205(0xaf)+_0x24ea34,'GET',{});const _0x57de51=await fetch(this['apiUrl']+'/'+_0x24ea34,{'method':'GET','headers':{'Content-Type':_0x29e205(0xab),'User-Agent':_0x29e205(0x94)}}),_0x2752fc=Date[_0x29e205(0xa9)]()-_0x10a11d;if(!_0x57de51['ok']){const _0x5d23be=await _0x57de51['text']();loggerService_1[_0x29e205(0xa0)][_0x29e205(0xd6)](_0x29e205(0x78),'/v1/hosted/payment_links/'+_0x24ea34,_0x57de51[_0x29e205(0xa1)],_0x5d23be,_0x2752fc);throw new Error(_0x29e205(0xa5)+_0x57de51[_0x29e205(0xa1)]);}const _0x18c1b7=await _0x57de51[_0x29e205(0x8d)]();loggerService_1[_0x29e205(0xa0)][_0x29e205(0xd6)]('rapyd',_0x29e205(0xaf)+_0x24ea34,_0x57de51[_0x29e205(0xa1)],_0x18c1b7,_0x2752fc);if(_0x18c1b7[_0x29e205(0xa1)]?.[_0x29e205(0xa1)]!==_0x29e205(0xa3)){loggerService_1[_0x29e205(0xa0)]['logWhiteDomainError'](_0x29e205(0x78),'/v1/hosted/payment_links/'+_0x24ea34,'Rapyd\x20API\x20error:\x20'+(_0x18c1b7[_0x29e205(0xa1)]?.['message']||_0x29e205(0x9d)));throw new Error(_0x29e205(0xc3)+(_0x18c1b7['status']?.[_0x29e205(0x67)]||_0x29e205(0x9d)));}let _0x4d05dc=_0x29e205(0x9b);if(_0x18c1b7[_0x29e205(0xcf)]?.[_0x29e205(0xa1)])switch(_0x18c1b7[_0x29e205(0xcf)]['status']['toUpperCase']()){case'CLO':_0x4d05dc='PAID';break;case'CAN':_0x4d05dc='FAILED';break;case _0x29e205(0xb3):_0x4d05dc=_0x29e205(0x89);break;case _0x29e205(0xcd):_0x4d05dc=_0x29e205(0x98);break;case _0x29e205(0xb0):case'ACT':default:_0x4d05dc='PENDING';break;}return{'status':_0x4d05dc,'amount':_0x18c1b7[_0x29e205(0xcf)]?.[_0x29e205(0x85)],'currency':_0x18c1b7[_0x29e205(0xcf)]?.[_0x29e205(0xd7)]};}catch(_0x4799ee){console['error'](_0x29e205(0x80),_0x4799ee),loggerService_1['loggerService'][_0x29e205(0xa2)](_0x29e205(0x78),_0x29e205(0xaf)+_0x24ea34,_0x4799ee);throw new Error(_0x29e205(0xae)+(_0x4799ee instanceof Error?_0x4799ee[_0x29e205(0x67)]:'Unknown\x20error'));}}async[a44_0x32886a(0xce)](_0x501593){const _0x471eff=a44_0x32886a;console[_0x471eff(0x7f)](_0x471eff(0x87),_0x501593);let _0x1ac9c6=_0x471eff(0x9b),_0x1141dd;_0x501593['data']?.['failure_message']&&(_0x1141dd=_0x501593[_0x471eff(0xcf)][_0x471eff(0xd3)],console['log']('üí•\x20Rapyd\x20failure\x20message:\x20'+_0x1141dd));switch(_0x501593[_0x471eff(0xc7)]?.[_0x471eff(0x86)]()){case _0x471eff(0x84):_0x501593[_0x471eff(0xcf)]?.[_0x471eff(0x8f)]===!![]&&_0x501593['data']?.[_0x471eff(0xa1)]===_0x471eff(0x72)?_0x1ac9c6=_0x471eff(0x68):_0x1ac9c6=_0x471eff(0x9b);break;case _0x471eff(0xdb):_0x1ac9c6=_0x471eff(0x98);break;case _0x471eff(0x8e):_0x1ac9c6=_0x471eff(0x89);break;case _0x471eff(0xc4):_0x1ac9c6=_0x471eff(0x98);!_0x1141dd&&_0x501593[_0x471eff(0xcf)]?.[_0x471eff(0xd3)]&&(_0x1141dd=_0x501593[_0x471eff(0xcf)]['failure_message']);break;default:switch(_0x501593['data']?.[_0x471eff(0xa1)]?.[_0x471eff(0x86)]()){case _0x471eff(0x72):_0x501593['data']?.[_0x471eff(0x8f)]===!![]?_0x1ac9c6='PAID':_0x1ac9c6=_0x471eff(0x98);break;case _0x471eff(0xb7):_0x1ac9c6=_0x471eff(0x98);break;case _0x471eff(0xb3):_0x1ac9c6=_0x471eff(0x89);break;case _0x471eff(0xcd):_0x1ac9c6=_0x471eff(0x98);!_0x1141dd&&_0x501593[_0x471eff(0xcf)]?.['failure_message']&&(_0x1141dd=_0x501593['data'][_0x471eff(0xd3)]);break;case'NEW':case'ACT':default:_0x1ac9c6=_0x471eff(0x9b);break;}break;}const _0x1d31cd={};return _0x501593[_0x471eff(0xcf)]?.[_0x471eff(0xd0)]?.[_0x471eff(0xd5)]&&(_0x1d31cd[_0x471eff(0xd4)]=_0x501593['data'][_0x471eff(0xd0)][_0x471eff(0xd5)]),_0x501593[_0x471eff(0xcf)]?.[_0x471eff(0xac)]&&(_0x1d31cd[_0x471eff(0x79)]=_0x501593['data'][_0x471eff(0xac)]),_0x501593[_0x471eff(0xcf)]?.[_0x471eff(0xcb)]&&(_0x1d31cd[_0x471eff(0x9f)]=_0x501593['data'][_0x471eff(0xcb)]),_0x501593[_0x471eff(0xcf)]?.[_0x471eff(0xca)]&&(_0x1d31cd['failureCode']=_0x501593[_0x471eff(0xcf)][_0x471eff(0xca)]),console[_0x471eff(0x7f)](_0x471eff(0x9c)+_0x1ac9c6+_0x471eff(0x92)+(_0x1141dd||_0x471eff(0xa7))),{'paymentId':_0x501593[_0x471eff(0xcf)]?.[_0x471eff(0xb2)]||'','status':_0x1ac9c6,'amount':_0x501593['data']?.[_0x471eff(0x85)],'currency':_0x501593[_0x471eff(0xcf)]?.[_0x471eff(0xd7)],'failureMessage':_0x1141dd,'additionalInfo':_0x1d31cd};}}function a44_0x4df4(_0x51db66,_0x63e36c){const _0x25c9f4=a44_0x25c9();return a44_0x4df4=function(_0x4df41d,_0x40ead8){_0x4df41d=_0x4df41d-0x64;let _0x3c88ff=_0x25c9f4[_0x4df41d];return _0x3c88ff;},a44_0x4df4(_0x51db66,_0x63e36c);}exports['RapydService']=RapydService;