'use strict';const a63_0x1cc330=a63_0x2363;(function(_0x3ed220,_0x5c7a8d){const _0x2ee182=a63_0x2363,_0x13298c=_0x3ed220();while(!![]){try{const _0x56fb96=-parseInt(_0x2ee182(0x117))/0x1+parseInt(_0x2ee182(0x10f))/0x2*(parseInt(_0x2ee182(0xcf))/0x3)+parseInt(_0x2ee182(0xea))/0x4+parseInt(_0x2ee182(0xda))/0x5*(parseInt(_0x2ee182(0xce))/0x6)+parseInt(_0x2ee182(0xcd))/0x7+-parseInt(_0x2ee182(0xd2))/0x8*(-parseInt(_0x2ee182(0xf4))/0x9)+-parseInt(_0x2ee182(0xe0))/0xa*(parseInt(_0x2ee182(0xa3))/0xb);if(_0x56fb96===_0x5c7a8d)break;else _0x13298c['push'](_0x13298c['shift']());}catch(_0x1f8c6c){_0x13298c['push'](_0x13298c['shift']());}}}(a63_0x581a,0x44b48));Object[a63_0x1cc330(0xcb)](exports,a63_0x1cc330(0xae),{'value':!![]}),exports['RapydService']=void 0x0;const loggerService_1=require('../loggerService');function a63_0x581a(){const _0x44381a=['toUpperCase','payment_method_type','RapydService','failure_message','33hSTUPq','application/json','failureCode','paid','Invalid\x20JSON\x20response\x20from\x20Rapyd\x20API:\x20','Unknown\x20error\x20from\x20Rapyd\x20API','PAYMENT_EXPIRED','UNKNOWN','ðŸ‡¬ðŸ‡§\x20Country:\x20','Processing\x20Rapyd\x20webhook:','https://tesoft.uk/gateway/success.php?id=','__esModule','ðŸ’±\x20Adding\x20currency\x20conversion\x20fields\x20for\x20','Parsed\x20Result:','Response\x20data:','https://tesoft.uk/gateway/rapyd/','ðŸŒ\x20Rapyd\x20service\x20initialized\x20with\x20white\x20domain\x20proxy','none','PENDING','payment_method_data','SUCCESS','Error\x20Code:','URL:','HTTP\x20','status','stringify','PAYMENT_COMPLETED','===\x20PARSED\x20RAPYD\x20RESPONSE\x20===','Status\x20Text:','logWhiteDomainError','===\x20RAPYD\x20API\x20INCOMPLETE\x20RESPONSE\x20===','currency','===\x20RAPYD\x20SUCCESS\x20===','json','Unknown\x20error','statusText','EXP','redirect_url','email','Missing\x20id\x20or\x20redirect_url\x20in\x20response','defineProperty','Rapyd\x20API\x20error\x20(','2336159yYSWEJ','102tBjHmD','252789UAeDoZ','verifyPayment','error_code','2792992IjRYBC','Response\x20Time:','log','fromEntries','PAID','\x20(GB\x20-\x20Britain)','cardLast4','https://tesoft.uk/gateway/fail.php?id=','69555OSLsEd','last4','apiUrl','EUR','Rapyd\x20payment\x20verification\x20error:','ðŸ’³\x20Payment\x20Methods:\x20gb_visa_card,\x20gb_mastercard_card','1468610NyzqFt','\x20->\x20EUR:','logWhiteDomainResponse','===\x20RAPYD\x20API\x20RESPONSE\x20(White\x20Domain)\x20===','gb_visa_card','JSON\x20Parse\x20Error:\x20','FAILED','Error\x20details:','NEW','error','803060xxDWzn','merchant_reference_id','loggerService','Failed\x20to\x20verify\x20Rapyd\x20payment:\x20','failure_code','CAN','HTTP\x20Status:','/v1/hosted/payment_links/','Business\x20Error\x20(','address','9pkEfHk','rapyd','message','\x20\x20\x20requested_currency:\x20EUR','HTTP\x20error!\x20status:\x20','ðŸ”„\x20Rapyd\x20webhook\x20processed:\x20status=','\x20(always\x20GB\x20for\x20Rapyd)','Failed\x20to\x20parse\x20JSON\x20response:','data','POST','Error\x20stack:','toISOString','Rapyd\x20API\x20error:\x20','ðŸ‡¬ðŸ‡§\x20Country\x20used:\x20','expiration','Error\x20Message:','paymentMethod','Payment\x20System/1.0','GET','amount','ðŸ’¥\x20Rapyd\x20failure\x20message:\x20','EXPIRED','entries','Redirect\x20URL:','/v1/hosted/payment_links','type','logWhiteDomainRequest','2hdDsnf','ACT','CLO','buy','text','requested_currency','Payment\x20Link\x20ID:','ðŸ’³\x20Adding\x20cardholder\x20name:\x20','482377LjnLMv',',\x20failureMessage=','now','===\x20RAPYD\x20API\x20REQUEST\x20(White\x20Domain\x20-\x20Updated\x20Format)\x20===','Failed\x20to\x20create\x20Rapyd\x20payment\x20link:\x20Unknown\x20error'];a63_0x581a=function(){return _0x44381a;};return a63_0x581a();}class RapydService{constructor(){const _0x54d24d=a63_0x1cc330;this['apiUrl']=_0x54d24d(0xb2),console[_0x54d24d(0xd4)](_0x54d24d(0xb3));}async['createPaymentLink'](_0x150783){const _0xd2d418=a63_0x1cc330,{orderId:_0x904af9,orderName:_0x14cf2b,amount:_0x49836b,currency:_0xa1e025,usage:_0x27cd35,maxPayments:_0x921c00,successUrl:_0x27e56f,failUrl:_0x3369e1,customerName:_0x5315ad,customerEmail:_0x16fe50}=_0x150783,_0x59180b=_0xa1e025['toUpperCase'](),_0x2387cd='GB';console['log']('ðŸ‡¬ðŸ‡§\x20Using\x20GB\x20(Britain)\x20as\x20country\x20for\x20Rapyd\x20payment\x20link');const _0x5acfa7=_0xd2d418(0xad)+_0x904af9,_0x515fb8=_0xd2d418(0xd9)+_0x904af9,_0x586b19={'amount':_0x49836b,'currency':_0x59180b,'payment_method_options':{'3d_required':![]},'cancel_checkout_url':_0x515fb8,'complete_checkout_url':_0x5acfa7,'complete_payment_url':_0x5acfa7,'merchant_reference_id':_0x904af9,'description':'ORDER:\x20'+_0x904af9,'country':'GB','payment_method_types_include':[_0xd2d418(0xe4),'gb_mastercard_card'],'custom_elements':{'display_description':!![],'billing_address_collect':!![],'required_customer_fields':['name',_0xd2d418(0xc9),'phone_number',_0xd2d418(0xf3)]}};_0x5315ad&&(_0x586b19['custom_elements']['cardholder_name']=_0x5315ad,console[_0xd2d418(0xd4)](_0xd2d418(0x116)+_0x5315ad));if(_0x59180b!==_0xd2d418(0xdd)){const _0x3b81bc=Math['floor'](Date[_0xd2d418(0x119)]()/0x3e8)+0x1e*0x3c;_0x586b19['fixed_side']=_0xd2d418(0x112),_0x586b19[_0xd2d418(0x114)]=_0xd2d418(0xdd),_0x586b19[_0xd2d418(0x102)]=_0x3b81bc,console[_0xd2d418(0xd4)](_0xd2d418(0xaf)+_0x59180b+_0xd2d418(0xe1)),console['log']('\x20\x20\x20fixed_side:\x20buy'),console[_0xd2d418(0xd4)](_0xd2d418(0xf7)),console[_0xd2d418(0xd4)]('\x20\x20\x20expiration:\x20'+_0x3b81bc+'\x20('+new Date(_0x3b81bc*0x3e8)[_0xd2d418(0xff)]()+')');}const _0x216782=Date['now']();try{console['log'](_0xd2d418(0x9d)),console[_0xd2d418(0xd4)](_0xd2d418(0xb9),this[_0xd2d418(0xdc)]),console[_0xd2d418(0xd4)]('Request\x20Body\x20(Updated\x20Format):',JSON[_0xd2d418(0xbc)](_0x586b19,null,0x2)),console['log'](_0xd2d418(0xab)+_0x2387cd+_0xd2d418(0xfa)),console['log'](_0xd2d418(0xdf)),loggerService_1['loggerService'][_0xd2d418(0x10e)](_0xd2d418(0xf5),'/v1/hosted/payment_links','POST',_0x586b19);const _0xf397f3=await fetch(this[_0xd2d418(0xdc)],{'method':_0xd2d418(0xfd),'headers':{'Content-Type':_0xd2d418(0xa4),'User-Agent':_0xd2d418(0x105)},'body':JSON[_0xd2d418(0xbc)](_0x586b19)}),_0x4eae29=Date[_0xd2d418(0x119)]()-_0x216782;console[_0xd2d418(0xd4)](_0xd2d418(0xe3)),console[_0xd2d418(0xd4)]('Status:',_0xf397f3[_0xd2d418(0xbb)]),console[_0xd2d418(0xd4)](_0xd2d418(0xbf),_0xf397f3[_0xd2d418(0xc6)]),console[_0xd2d418(0xd4)]('Headers:',Object[_0xd2d418(0xd5)](_0xf397f3['headers'][_0xd2d418(0x10a)]())),console[_0xd2d418(0xd4)](_0xd2d418(0xd3),_0x4eae29+'ms');const _0xc1550e=await _0xf397f3[_0xd2d418(0x113)]();console[_0xd2d418(0xd4)]('Raw\x20Response\x20Body:',_0xc1550e);if(!_0xf397f3['ok']){console['error']('===\x20RAPYD\x20API\x20ERROR\x20==='),console[_0xd2d418(0xe9)](_0xd2d418(0xf0),_0xf397f3[_0xd2d418(0xbb)]),console[_0xd2d418(0xe9)]('Response\x20Body:',_0xc1550e),loggerService_1[_0xd2d418(0xec)]['logWhiteDomainResponse']('rapyd','/v1/hosted/payment_links',_0xf397f3[_0xd2d418(0xbb)],_0xc1550e,_0x4eae29),loggerService_1['loggerService'][_0xd2d418(0xc0)]('rapyd',_0xd2d418(0x10c),_0xd2d418(0xba)+_0xf397f3[_0xd2d418(0xbb)]+':\x20'+_0xc1550e);throw new Error('HTTP\x20error!\x20status:\x20'+_0xf397f3[_0xd2d418(0xbb)]+',\x20body:\x20'+_0xc1550e);}let _0x615e4b;try{_0x615e4b=JSON['parse'](_0xc1550e);}catch(_0x31ee8d){console[_0xd2d418(0xe9)](_0xd2d418(0xfb),_0x31ee8d),loggerService_1[_0xd2d418(0xec)][_0xd2d418(0xc0)](_0xd2d418(0xf5),_0xd2d418(0x10c),_0xd2d418(0xe5)+_0x31ee8d);throw new Error(_0xd2d418(0xa7)+_0xc1550e);}console[_0xd2d418(0xd4)](_0xd2d418(0xbe)),console[_0xd2d418(0xd4)](_0xd2d418(0xb0),JSON[_0xd2d418(0xbc)](_0x615e4b,null,0x2)),loggerService_1['loggerService']['logWhiteDomainResponse'](_0xd2d418(0xf5),'/v1/hosted/payment_links',_0xf397f3[_0xd2d418(0xbb)],_0x615e4b,_0x4eae29);if(_0x615e4b[_0xd2d418(0xbb)]?.[_0xd2d418(0xbb)]!==_0xd2d418(0xb7)){const _0x40ea70=_0x615e4b[_0xd2d418(0xbb)]?.['message']||_0xd2d418(0xa8),_0x55d0c5=_0x615e4b[_0xd2d418(0xbb)]?.[_0xd2d418(0xd1)]||_0xd2d418(0xaa);console[_0xd2d418(0xe9)]('===\x20RAPYD\x20API\x20BUSINESS\x20ERROR\x20==='),console['error'](_0xd2d418(0xb8),_0x55d0c5),console['error'](_0xd2d418(0x103),_0x40ea70),console[_0xd2d418(0xe9)]('Full\x20Error\x20Data:',_0x615e4b[_0xd2d418(0xbb)]),loggerService_1[_0xd2d418(0xec)][_0xd2d418(0xc0)](_0xd2d418(0xf5),'/v1/hosted/payment_links',_0xd2d418(0xf2)+_0x55d0c5+'):\x20'+_0x40ea70);throw new Error(_0xd2d418(0xcc)+_0x55d0c5+'):\x20'+_0x40ea70);}if(!_0x615e4b[_0xd2d418(0xfc)]?.['id']||!_0x615e4b[_0xd2d418(0xfc)]?.[_0xd2d418(0xc8)]){console[_0xd2d418(0xe9)](_0xd2d418(0xc1)),console[_0xd2d418(0xe9)](_0xd2d418(0xca)),console[_0xd2d418(0xe9)](_0xd2d418(0xb1),_0x615e4b['data']),loggerService_1[_0xd2d418(0xec)][_0xd2d418(0xc0)](_0xd2d418(0xf5),'/v1/hosted/payment_links','Incomplete\x20response:\x20missing\x20id\x20or\x20redirect_url');throw new Error('Invalid\x20response\x20from\x20Rapyd\x20API:\x20missing\x20id\x20or\x20redirect_url');}return console[_0xd2d418(0xd4)](_0xd2d418(0xc3)),console[_0xd2d418(0xd4)](_0xd2d418(0x115),_0x615e4b[_0xd2d418(0xfc)]['id']),console[_0xd2d418(0xd4)](_0xd2d418(0x10b),_0x615e4b['data'][_0xd2d418(0xc8)]),console[_0xd2d418(0xd4)](_0xd2d418(0x101)+_0x2387cd+_0xd2d418(0xd7)),console[_0xd2d418(0xd4)](_0xd2d418(0xdf)),{'gateway_payment_id':_0x615e4b[_0xd2d418(0xfc)]['id'],'payment_url':_0x615e4b[_0xd2d418(0xfc)][_0xd2d418(0xc8)]};}catch(_0x5c6000){console['error']('===\x20RAPYD\x20SERVICE\x20ERROR\x20==='),console[_0xd2d418(0xe9)](_0xd2d418(0xe7),_0x5c6000),loggerService_1[_0xd2d418(0xec)][_0xd2d418(0xc0)]('rapyd','/v1/hosted/payment_links',_0x5c6000);if(_0x5c6000 instanceof Error){console[_0xd2d418(0xe9)]('Error\x20message:',_0x5c6000[_0xd2d418(0xf6)]),console[_0xd2d418(0xe9)](_0xd2d418(0xfe),_0x5c6000['stack']);throw new Error('Failed\x20to\x20create\x20Rapyd\x20payment\x20link:\x20'+_0x5c6000['message']);}throw new Error(_0xd2d418(0x9e));}}async[a63_0x1cc330(0xd0)](_0x1db3d3){const _0x473510=a63_0x1cc330,_0x38602b=Date['now']();try{loggerService_1[_0x473510(0xec)][_0x473510(0x10e)](_0x473510(0xf5),_0x473510(0xf1)+_0x1db3d3,_0x473510(0x106),{});const _0x52083c=await fetch(this[_0x473510(0xdc)]+'/'+_0x1db3d3,{'method':_0x473510(0x106),'headers':{'Content-Type':_0x473510(0xa4),'User-Agent':'Payment\x20System/1.0'}}),_0x1bc9d3=Date[_0x473510(0x119)]()-_0x38602b;if(!_0x52083c['ok']){const _0x448c29=await _0x52083c[_0x473510(0x113)]();loggerService_1[_0x473510(0xec)]['logWhiteDomainResponse'](_0x473510(0xf5),_0x473510(0xf1)+_0x1db3d3,_0x52083c['status'],_0x448c29,_0x1bc9d3);throw new Error(_0x473510(0xf8)+_0x52083c[_0x473510(0xbb)]);}const _0x42a066=await _0x52083c[_0x473510(0xc4)]();loggerService_1['loggerService'][_0x473510(0xe2)](_0x473510(0xf5),_0x473510(0xf1)+_0x1db3d3,_0x52083c[_0x473510(0xbb)],_0x42a066,_0x1bc9d3);if(_0x42a066[_0x473510(0xbb)]?.['status']!==_0x473510(0xb7)){loggerService_1[_0x473510(0xec)][_0x473510(0xc0)]('rapyd',_0x473510(0xf1)+_0x1db3d3,_0x473510(0x100)+(_0x42a066[_0x473510(0xbb)]?.[_0x473510(0xf6)]||_0x473510(0xc5)));throw new Error(_0x473510(0x100)+(_0x42a066['status']?.[_0x473510(0xf6)]||_0x473510(0xc5)));}let _0x9574aa=_0x473510(0xb5);if(_0x42a066[_0x473510(0xfc)]?.['status'])switch(_0x42a066['data'][_0x473510(0xbb)]['toUpperCase']()){case _0x473510(0x111):_0x9574aa=_0x473510(0xd6);break;case _0x473510(0xef):_0x9574aa=_0x473510(0xe6);break;case _0x473510(0xc7):_0x9574aa=_0x473510(0x109);break;case'ERR':_0x9574aa='FAILED';break;case _0x473510(0xe8):case _0x473510(0x110):default:_0x9574aa=_0x473510(0xb5);break;}return{'status':_0x9574aa,'amount':_0x42a066[_0x473510(0xfc)]?.[_0x473510(0x107)],'currency':_0x42a066[_0x473510(0xfc)]?.[_0x473510(0xc2)]};}catch(_0x366a95){console[_0x473510(0xe9)](_0x473510(0xde),_0x366a95),loggerService_1[_0x473510(0xec)][_0x473510(0xc0)](_0x473510(0xf5),_0x473510(0xf1)+_0x1db3d3,_0x366a95);throw new Error(_0x473510(0xed)+(_0x366a95 instanceof Error?_0x366a95[_0x473510(0xf6)]:_0x473510(0xc5)));}}async['processWebhook'](_0x4a2215){const _0xde372d=a63_0x1cc330;console['log'](_0xde372d(0xac),_0x4a2215);let _0x2138ca=_0xde372d(0xb5),_0x7fe460;_0x4a2215[_0xde372d(0xfc)]?.['failure_message']&&(_0x7fe460=_0x4a2215[_0xde372d(0xfc)][_0xde372d(0xa2)],console[_0xde372d(0xd4)](_0xde372d(0x108)+_0x7fe460));switch(_0x4a2215[_0xde372d(0x10d)]?.[_0xde372d(0x9f)]()){case _0xde372d(0xbd):_0x4a2215[_0xde372d(0xfc)]?.[_0xde372d(0xa6)]===!![]&&_0x4a2215[_0xde372d(0xfc)]?.[_0xde372d(0xbb)]==='CLO'?_0x2138ca=_0xde372d(0xd6):_0x2138ca=_0xde372d(0xb5);break;case'PAYMENT_CANCELED':_0x2138ca='FAILED';break;case _0xde372d(0xa9):_0x2138ca=_0xde372d(0x109);break;case'PAYMENT_FAILED':_0x2138ca=_0xde372d(0xe6);!_0x7fe460&&_0x4a2215[_0xde372d(0xfc)]?.[_0xde372d(0xa2)]&&(_0x7fe460=_0x4a2215['data'][_0xde372d(0xa2)]);break;default:switch(_0x4a2215[_0xde372d(0xfc)]?.['status']?.[_0xde372d(0x9f)]()){case'CLO':_0x4a2215['data']?.[_0xde372d(0xa6)]===!![]?_0x2138ca=_0xde372d(0xd6):_0x2138ca='FAILED';break;case'CAN':_0x2138ca='FAILED';break;case _0xde372d(0xc7):_0x2138ca=_0xde372d(0x109);break;case'ERR':_0x2138ca=_0xde372d(0xe6);!_0x7fe460&&_0x4a2215['data']?.['failure_message']&&(_0x7fe460=_0x4a2215[_0xde372d(0xfc)]['failure_message']);break;case _0xde372d(0xe8):case _0xde372d(0x110):default:_0x2138ca=_0xde372d(0xb5);break;}break;}const _0xf5bf4e={};return _0x4a2215[_0xde372d(0xfc)]?.[_0xde372d(0xb6)]?.['last4']&&(_0xf5bf4e[_0xde372d(0xd8)]=_0x4a2215[_0xde372d(0xfc)]['payment_method_data'][_0xde372d(0xdb)]),_0x4a2215[_0xde372d(0xfc)]?.['payment_method_type']&&(_0xf5bf4e[_0xde372d(0x104)]=_0x4a2215['data'][_0xde372d(0xa0)]),_0x4a2215[_0xde372d(0xfc)]?.[_0xde372d(0xd1)]&&(_0xf5bf4e['errorCode']=_0x4a2215[_0xde372d(0xfc)][_0xde372d(0xd1)]),_0x4a2215[_0xde372d(0xfc)]?.[_0xde372d(0xee)]&&(_0xf5bf4e[_0xde372d(0xa5)]=_0x4a2215[_0xde372d(0xfc)][_0xde372d(0xee)]),console['log'](_0xde372d(0xf9)+_0x2138ca+_0xde372d(0x118)+(_0x7fe460||_0xde372d(0xb4))),{'paymentId':_0x4a2215[_0xde372d(0xfc)]?.[_0xde372d(0xeb)]||'','status':_0x2138ca,'amount':_0x4a2215[_0xde372d(0xfc)]?.['amount'],'currency':_0x4a2215['data']?.[_0xde372d(0xc2)],'failureMessage':_0x7fe460,'additionalInfo':_0xf5bf4e};}}function a63_0x2363(_0x36577c,_0x25bc9a){_0x36577c=_0x36577c-0x9d;const _0x581a8a=a63_0x581a();let _0x236306=_0x581a8a[_0x36577c];return _0x236306;}exports[a63_0x1cc330(0xa1)]=RapydService;