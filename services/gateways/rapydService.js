'use strict';const a46_0x4ad737=a46_0x1117;(function(_0x315135,_0x406270){const _0x4ae182=a46_0x1117,_0x79b387=_0x315135();while(!![]){try{const _0x41f934=parseInt(_0x4ae182(0x17a))/0x1+parseInt(_0x4ae182(0x19b))/0x2+-parseInt(_0x4ae182(0x1a6))/0x3+parseInt(_0x4ae182(0x1dc))/0x4+parseInt(_0x4ae182(0x1ae))/0x5+parseInt(_0x4ae182(0x1c0))/0x6+-parseInt(_0x4ae182(0x1bc))/0x7;if(_0x41f934===_0x406270)break;else _0x79b387['push'](_0x79b387['shift']());}catch(_0x4f7e50){_0x79b387['push'](_0x79b387['shift']());}}}(a46_0x2fca,0xc4595));Object[a46_0x4ad737(0x1d6)](exports,a46_0x4ad737(0x1b3),{'value':!![]}),exports[a46_0x4ad737(0x180)]=void 0x0;const loggerService_1=require(a46_0x4ad737(0x18d));class RapydService{constructor(){const _0x2a435a=a46_0x4ad737;this['apiUrl']='https://tesoft.uk/gateway/rapyd/',console[_0x2a435a(0x1d3)](_0x2a435a(0x189));}async[a46_0x4ad737(0x1c7)](_0x5bd9ba){const _0x45d54d=a46_0x4ad737,{orderId:_0x37c4c8,orderName:_0x4a4dbb,amount:_0x569dc0,currency:_0xfe0a5d,usage:_0x4a208e,maxPayments:_0x1edd86,successUrl:_0x170f70,failUrl:_0x463c26}=_0x5bd9ba,_0x2e968d=_0xfe0a5d[_0x45d54d(0x1de)](),_0x128451='GB';console[_0x45d54d(0x1d3)](_0x45d54d(0x17e));const _0x1bc55f='https://tesoft.uk/gateway/success.php?id='+_0x37c4c8,_0x3f1421='https://tesoft.uk/gateway/fail.php?id='+_0x37c4c8,_0x5cafeb={'amount':_0x569dc0,'currency':_0x2e968d,'cancel_checkout_url':_0x3f1421,'complete_checkout_url':_0x1bc55f,'complete_payment_url':_0x1bc55f,'merchant_reference_id':_0x37c4c8,'description':_0x45d54d(0x188)+_0x37c4c8,'country':'GB','payment_method_types_include':[_0x45d54d(0x16e),'gb_mastercard_card'],'custom_elements':{'display_description':!![]}},_0x3c7b57=Date[_0x45d54d(0x192)]();try{console[_0x45d54d(0x1d3)](_0x45d54d(0x1d0)),console[_0x45d54d(0x1d3)](_0x45d54d(0x19d),this[_0x45d54d(0x1a3)]),console['log']('Request\x20Body\x20(Updated\x20Format):',JSON[_0x45d54d(0x196)](_0x5cafeb,null,0x2)),console[_0x45d54d(0x1d3)](_0x45d54d(0x1e3)+_0x128451+'\x20(always\x20GB\x20for\x20Rapyd)'),console[_0x45d54d(0x1d3)]('💳\x20Payment\x20Methods:\x20gb_visa_card,\x20gb_mastercard_card'),loggerService_1[_0x45d54d(0x17c)][_0x45d54d(0x1ab)]('rapyd','/v1/hosted/payment_links',_0x45d54d(0x1c8),_0x5cafeb);const _0x5ef1ea=await fetch(this[_0x45d54d(0x1a3)],{'method':'POST','headers':{'Content-Type':'application/json','User-Agent':_0x45d54d(0x191)},'body':JSON[_0x45d54d(0x196)](_0x5cafeb)}),_0x1c319d=Date['now']()-_0x3c7b57;console[_0x45d54d(0x1d3)](_0x45d54d(0x1be)),console['log'](_0x45d54d(0x185),_0x5ef1ea[_0x45d54d(0x17f)]),console['log'](_0x45d54d(0x1b5),_0x5ef1ea[_0x45d54d(0x199)]),console[_0x45d54d(0x1d3)](_0x45d54d(0x1b8),Object[_0x45d54d(0x18f)](_0x5ef1ea[_0x45d54d(0x183)][_0x45d54d(0x194)]())),console[_0x45d54d(0x1d3)](_0x45d54d(0x1e2),_0x1c319d+'ms');const _0x3efe6d=await _0x5ef1ea['text']();console[_0x45d54d(0x1d3)](_0x45d54d(0x1ad),_0x3efe6d);if(!_0x5ef1ea['ok']){console[_0x45d54d(0x1b4)](_0x45d54d(0x1cc)),console[_0x45d54d(0x1b4)](_0x45d54d(0x198),_0x5ef1ea[_0x45d54d(0x17f)]),console[_0x45d54d(0x1b4)](_0x45d54d(0x1c3),_0x3efe6d),loggerService_1[_0x45d54d(0x17c)][_0x45d54d(0x18e)](_0x45d54d(0x186),'/v1/hosted/payment_links',_0x5ef1ea['status'],_0x3efe6d,_0x1c319d),loggerService_1[_0x45d54d(0x17c)][_0x45d54d(0x182)](_0x45d54d(0x186),'/v1/hosted/payment_links','HTTP\x20'+_0x5ef1ea[_0x45d54d(0x17f)]+':\x20'+_0x3efe6d);throw new Error(_0x45d54d(0x1d4)+_0x5ef1ea[_0x45d54d(0x17f)]+_0x45d54d(0x1aa)+_0x3efe6d);}let _0x13d97;try{_0x13d97=JSON[_0x45d54d(0x16c)](_0x3efe6d);}catch(_0x390c38){console[_0x45d54d(0x1b4)](_0x45d54d(0x1dd),_0x390c38),loggerService_1[_0x45d54d(0x17c)][_0x45d54d(0x182)](_0x45d54d(0x186),_0x45d54d(0x172),_0x45d54d(0x1a9)+_0x390c38);throw new Error(_0x45d54d(0x173)+_0x3efe6d);}console[_0x45d54d(0x1d3)](_0x45d54d(0x179)),console['log'](_0x45d54d(0x1d5),JSON[_0x45d54d(0x196)](_0x13d97,null,0x2)),loggerService_1['loggerService'][_0x45d54d(0x18e)](_0x45d54d(0x186),_0x45d54d(0x172),_0x5ef1ea['status'],_0x13d97,_0x1c319d);if(_0x13d97['status']?.[_0x45d54d(0x17f)]!==_0x45d54d(0x1c1)){const _0x2c5011=_0x13d97['status']?.[_0x45d54d(0x187)]||'Unknown\x20error\x20from\x20Rapyd\x20API',_0x10a891=_0x13d97[_0x45d54d(0x17f)]?.[_0x45d54d(0x1e1)]||_0x45d54d(0x1c4);console[_0x45d54d(0x1b4)]('===\x20RAPYD\x20API\x20BUSINESS\x20ERROR\x20==='),console['error'](_0x45d54d(0x1ce),_0x10a891),console[_0x45d54d(0x1b4)](_0x45d54d(0x1c6),_0x2c5011),console[_0x45d54d(0x1b4)](_0x45d54d(0x177),_0x13d97[_0x45d54d(0x17f)]),loggerService_1[_0x45d54d(0x17c)][_0x45d54d(0x182)]('rapyd',_0x45d54d(0x172),_0x45d54d(0x1a2)+_0x10a891+_0x45d54d(0x1b1)+_0x2c5011);throw new Error(_0x45d54d(0x16f)+_0x10a891+_0x45d54d(0x1b1)+_0x2c5011);}if(!_0x13d97[_0x45d54d(0x1bd)]?.['id']||!_0x13d97[_0x45d54d(0x1bd)]?.[_0x45d54d(0x1ac)]){console[_0x45d54d(0x1b4)]('===\x20RAPYD\x20API\x20INCOMPLETE\x20RESPONSE\x20==='),console[_0x45d54d(0x1b4)](_0x45d54d(0x1bb)),console[_0x45d54d(0x1b4)](_0x45d54d(0x16d),_0x13d97['data']),loggerService_1[_0x45d54d(0x17c)][_0x45d54d(0x182)](_0x45d54d(0x186),_0x45d54d(0x172),_0x45d54d(0x17b));throw new Error(_0x45d54d(0x19f));}return console['log'](_0x45d54d(0x1d2)),console[_0x45d54d(0x1d3)]('Payment\x20Link\x20ID:',_0x13d97[_0x45d54d(0x1bd)]['id']),console[_0x45d54d(0x1d3)](_0x45d54d(0x19a),_0x13d97['data']['redirect_url']),console[_0x45d54d(0x1d3)]('🇬🇧\x20Country\x20used:\x20'+_0x128451+_0x45d54d(0x1d8)),console[_0x45d54d(0x1d3)](_0x45d54d(0x1c2)),{'gateway_payment_id':_0x13d97[_0x45d54d(0x1bd)]['id'],'payment_url':_0x13d97['data'][_0x45d54d(0x1ac)]};}catch(_0x1d127e){console[_0x45d54d(0x1b4)](_0x45d54d(0x1b7)),console[_0x45d54d(0x1b4)](_0x45d54d(0x1a4),_0x1d127e),loggerService_1['loggerService']['logWhiteDomainError'](_0x45d54d(0x186),_0x45d54d(0x172),_0x1d127e);if(_0x1d127e instanceof Error){console['error'](_0x45d54d(0x1a0),_0x1d127e[_0x45d54d(0x187)]),console[_0x45d54d(0x1b4)](_0x45d54d(0x1df),_0x1d127e[_0x45d54d(0x176)]);throw new Error(_0x45d54d(0x19e)+_0x1d127e[_0x45d54d(0x187)]);}throw new Error('Failed\x20to\x20create\x20Rapyd\x20payment\x20link:\x20Unknown\x20error');}}async[a46_0x4ad737(0x18c)](_0x27dfc9){const _0x322c2b=a46_0x4ad737,_0x13fb9c=Date['now']();try{loggerService_1[_0x322c2b(0x17c)][_0x322c2b(0x1ab)](_0x322c2b(0x186),_0x322c2b(0x1af)+_0x27dfc9,_0x322c2b(0x184),{});const _0x55d967=await fetch(this[_0x322c2b(0x1a3)]+'/'+_0x27dfc9,{'method':_0x322c2b(0x184),'headers':{'Content-Type':'application/json','User-Agent':'TesSoft\x20Payment\x20System/1.0'}}),_0x4ffc4b=Date['now']()-_0x13fb9c;if(!_0x55d967['ok']){const _0x1a868b=await _0x55d967[_0x322c2b(0x1b0)]();loggerService_1[_0x322c2b(0x17c)][_0x322c2b(0x18e)](_0x322c2b(0x186),_0x322c2b(0x1af)+_0x27dfc9,_0x55d967[_0x322c2b(0x17f)],_0x1a868b,_0x4ffc4b);throw new Error('HTTP\x20error!\x20status:\x20'+_0x55d967[_0x322c2b(0x17f)]);}const _0x47926f=await _0x55d967[_0x322c2b(0x1ca)]();loggerService_1[_0x322c2b(0x17c)][_0x322c2b(0x18e)](_0x322c2b(0x186),'/v1/hosted/payment_links/'+_0x27dfc9,_0x55d967['status'],_0x47926f,_0x4ffc4b);if(_0x47926f[_0x322c2b(0x17f)]?.['status']!=='SUCCESS'){loggerService_1[_0x322c2b(0x17c)]['logWhiteDomainError'](_0x322c2b(0x186),'/v1/hosted/payment_links/'+_0x27dfc9,_0x322c2b(0x193)+(_0x47926f['status']?.[_0x322c2b(0x187)]||'Unknown\x20error'));throw new Error(_0x322c2b(0x193)+(_0x47926f[_0x322c2b(0x17f)]?.[_0x322c2b(0x187)]||_0x322c2b(0x181)));}let _0x321711='PENDING';if(_0x47926f['data']?.[_0x322c2b(0x17f)])switch(_0x47926f[_0x322c2b(0x1bd)][_0x322c2b(0x17f)]['toUpperCase']()){case _0x322c2b(0x190):_0x321711=_0x322c2b(0x17d);break;case _0x322c2b(0x1a1):_0x321711='FAILED';break;case'EXP':_0x321711=_0x322c2b(0x1d1);break;case _0x322c2b(0x1b6):_0x321711=_0x322c2b(0x1a8);break;case _0x322c2b(0x170):case _0x322c2b(0x1ba):default:_0x321711=_0x322c2b(0x1db);break;}return{'status':_0x321711,'amount':_0x47926f[_0x322c2b(0x1bd)]?.[_0x322c2b(0x1b2)],'currency':_0x47926f[_0x322c2b(0x1bd)]?.['currency']};}catch(_0x3d392b){console[_0x322c2b(0x1b4)]('Rapyd\x20payment\x20verification\x20error:',_0x3d392b),loggerService_1[_0x322c2b(0x17c)][_0x322c2b(0x182)](_0x322c2b(0x186),_0x322c2b(0x1af)+_0x27dfc9,_0x3d392b);throw new Error('Failed\x20to\x20verify\x20Rapyd\x20payment:\x20'+(_0x3d392b instanceof Error?_0x3d392b['message']:_0x322c2b(0x181)));}}async[a46_0x4ad737(0x1d9)](_0x39f726){const _0x5a2cea=a46_0x4ad737;console[_0x5a2cea(0x1d3)](_0x5a2cea(0x174),_0x39f726);let _0x3fef84=_0x5a2cea(0x1db),_0x13102f;_0x39f726[_0x5a2cea(0x1bd)]?.[_0x5a2cea(0x1cd)]&&(_0x13102f=_0x39f726['data'][_0x5a2cea(0x1cd)],console[_0x5a2cea(0x1d3)](_0x5a2cea(0x1cf)+_0x13102f));switch(_0x39f726[_0x5a2cea(0x178)]?.[_0x5a2cea(0x1de)]()){case _0x5a2cea(0x1a7):_0x39f726['data']?.[_0x5a2cea(0x1da)]===!![]&&_0x39f726['data']?.[_0x5a2cea(0x17f)]===_0x5a2cea(0x190)?_0x3fef84=_0x5a2cea(0x17d):_0x3fef84='PENDING';break;case _0x5a2cea(0x197):_0x3fef84=_0x5a2cea(0x1a8);break;case _0x5a2cea(0x18a):_0x3fef84=_0x5a2cea(0x1d1);break;case _0x5a2cea(0x1c9):_0x3fef84=_0x5a2cea(0x1a8);!_0x13102f&&_0x39f726[_0x5a2cea(0x1bd)]?.[_0x5a2cea(0x1cd)]&&(_0x13102f=_0x39f726['data'][_0x5a2cea(0x1cd)]);break;default:switch(_0x39f726['data']?.['status']?.[_0x5a2cea(0x1de)]()){case _0x5a2cea(0x190):_0x39f726[_0x5a2cea(0x1bd)]?.['paid']===!![]?_0x3fef84=_0x5a2cea(0x17d):_0x3fef84=_0x5a2cea(0x1a8);break;case _0x5a2cea(0x1a1):_0x3fef84=_0x5a2cea(0x1a8);break;case _0x5a2cea(0x1e0):_0x3fef84=_0x5a2cea(0x1d1);break;case _0x5a2cea(0x1b6):_0x3fef84=_0x5a2cea(0x1a8);!_0x13102f&&_0x39f726[_0x5a2cea(0x1bd)]?.[_0x5a2cea(0x1cd)]&&(_0x13102f=_0x39f726[_0x5a2cea(0x1bd)][_0x5a2cea(0x1cd)]);break;case _0x5a2cea(0x170):case _0x5a2cea(0x1ba):default:_0x3fef84=_0x5a2cea(0x1db);break;}break;}const _0x301436={};return _0x39f726[_0x5a2cea(0x1bd)]?.[_0x5a2cea(0x1a5)]?.[_0x5a2cea(0x171)]&&(_0x301436['cardLast4']=_0x39f726[_0x5a2cea(0x1bd)]['payment_method_data']['last4']),_0x39f726['data']?.[_0x5a2cea(0x1c5)]&&(_0x301436[_0x5a2cea(0x175)]=_0x39f726[_0x5a2cea(0x1bd)][_0x5a2cea(0x1c5)]),_0x39f726['data']?.[_0x5a2cea(0x1e1)]&&(_0x301436['errorCode']=_0x39f726['data'][_0x5a2cea(0x1e1)]),_0x39f726[_0x5a2cea(0x1bd)]?.[_0x5a2cea(0x195)]&&(_0x301436[_0x5a2cea(0x1d7)]=_0x39f726[_0x5a2cea(0x1bd)]['failure_code']),console['log'](_0x5a2cea(0x19c)+_0x3fef84+_0x5a2cea(0x1b9)+(_0x13102f||_0x5a2cea(0x1bf))),{'paymentId':_0x39f726[_0x5a2cea(0x1bd)]?.[_0x5a2cea(0x1cb)]||'','status':_0x3fef84,'amount':_0x39f726[_0x5a2cea(0x1bd)]?.['amount'],'currency':_0x39f726['data']?.[_0x5a2cea(0x18b)],'failureMessage':_0x13102f,'additionalInfo':_0x301436};}}function a46_0x2fca(){const _0x5e7a8f=['PAYMENT_CANCELED','HTTP\x20Status:','statusText','Redirect\x20URL:','496698RevDxN','🔄\x20Rapyd\x20webhook\x20processed:\x20status=','URL:','Failed\x20to\x20create\x20Rapyd\x20payment\x20link:\x20','Invalid\x20response\x20from\x20Rapyd\x20API:\x20missing\x20id\x20or\x20redirect_url','Error\x20message:','CAN','Business\x20Error\x20(','apiUrl','Error\x20details:','payment_method_data','3393594rPjuHC','PAYMENT_COMPLETED','FAILED','JSON\x20Parse\x20Error:\x20',',\x20body:\x20','logWhiteDomainRequest','redirect_url','Raw\x20Response\x20Body:','5079485qIzyuJ','/v1/hosted/payment_links/','text','):\x20','amount','__esModule','error','Status\x20Text:','ERR','===\x20RAPYD\x20SERVICE\x20ERROR\x20===','Headers:',',\x20failureMessage=','ACT','Missing\x20id\x20or\x20redirect_url\x20in\x20response','3106334bdqlvF','data','===\x20RAPYD\x20API\x20RESPONSE\x20(White\x20Domain)\x20===','none','428148KbUEBk','SUCCESS','💳\x20Payment\x20Methods:\x20gb_visa_card,\x20gb_mastercard_card','Response\x20Body:','UNKNOWN','payment_method_type','Error\x20Message:','createPaymentLink','POST','PAYMENT_FAILED','json','merchant_reference_id','===\x20RAPYD\x20API\x20ERROR\x20===','failure_message','Error\x20Code:','💥\x20Rapyd\x20failure\x20message:\x20','===\x20RAPYD\x20API\x20REQUEST\x20(White\x20Domain\x20-\x20Updated\x20Format)\x20===','EXPIRED','===\x20RAPYD\x20SUCCESS\x20===','log','HTTP\x20error!\x20status:\x20','Parsed\x20Result:','defineProperty','failureCode','\x20(GB\x20-\x20Britain)','processWebhook','paid','PENDING','1564408vgSGER','Failed\x20to\x20parse\x20JSON\x20response:','toUpperCase','Error\x20stack:','EXP','error_code','Response\x20Time:','🇬🇧\x20Country:\x20','parse','Response\x20data:','gb_visa_card','Rapyd\x20API\x20error\x20(','NEW','last4','/v1/hosted/payment_links','Invalid\x20JSON\x20response\x20from\x20Rapyd\x20API:\x20','Processing\x20Rapyd\x20webhook:','paymentMethod','stack','Full\x20Error\x20Data:','type','===\x20PARSED\x20RAPYD\x20RESPONSE\x20===','652499ifOaAU','Incomplete\x20response:\x20missing\x20id\x20or\x20redirect_url','loggerService','PAID','🇬🇧\x20Using\x20GB\x20(Britain)\x20as\x20country\x20for\x20Rapyd\x20payment\x20link','status','RapydService','Unknown\x20error','logWhiteDomainError','headers','GET','Status:','rapyd','message','ORDER:\x20','🌐\x20Rapyd\x20service\x20initialized\x20with\x20white\x20domain\x20proxy','PAYMENT_EXPIRED','currency','verifyPayment','../loggerService','logWhiteDomainResponse','fromEntries','CLO','TesSoft\x20Payment\x20System/1.0','now','Rapyd\x20API\x20error:\x20','entries','failure_code','stringify'];a46_0x2fca=function(){return _0x5e7a8f;};return a46_0x2fca();}function a46_0x1117(_0x556c4a,_0x545d7e){const _0x2fca3c=a46_0x2fca();return a46_0x1117=function(_0x11179d,_0x22246f){_0x11179d=_0x11179d-0x16c;let _0x1c2fb7=_0x2fca3c[_0x11179d];return _0x1c2fb7;},a46_0x1117(_0x556c4a,_0x545d7e);}exports[a46_0x4ad737(0x180)]=RapydService;