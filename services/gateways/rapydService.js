'use strict';const a45_0x1e77ca=a45_0xee5f;(function(_0x4ec455,_0x11c56e){const _0x59e1a3=a45_0xee5f,_0x2a05dd=_0x4ec455();while(!![]){try{const _0x3433e4=-parseInt(_0x59e1a3(0x172))/0x1*(-parseInt(_0x59e1a3(0x12c))/0x2)+parseInt(_0x59e1a3(0x134))/0x3*(parseInt(_0x59e1a3(0x180))/0x4)+parseInt(_0x59e1a3(0x13d))/0x5+parseInt(_0x59e1a3(0x189))/0x6*(-parseInt(_0x59e1a3(0x14e))/0x7)+-parseInt(_0x59e1a3(0x146))/0x8*(parseInt(_0x59e1a3(0x171))/0x9)+-parseInt(_0x59e1a3(0x18c))/0xa+-parseInt(_0x59e1a3(0x18e))/0xb;if(_0x3433e4===_0x11c56e)break;else _0x2a05dd['push'](_0x2a05dd['shift']());}catch(_0x29fc07){_0x2a05dd['push'](_0x2a05dd['shift']());}}}(a45_0x1470,0x6442e));function a45_0xee5f(_0x1d6695,_0x1b1751){const _0x14700f=a45_0x1470();return a45_0xee5f=function(_0xee5f9a,_0x4dc7dc){_0xee5f9a=_0xee5f9a-0x124;let _0x3bcb06=_0x14700f[_0xee5f9a];return _0x3bcb06;},a45_0xee5f(_0x1d6695,_0x1b1751);}Object[a45_0x1e77ca(0x151)](exports,a45_0x1e77ca(0x152),{'value':!![]}),exports[a45_0x1e77ca(0x147)]=void 0x0;const loggerService_1=require(a45_0x1e77ca(0x155));function a45_0x1470(){const _0x4d16f7=['271218GghdMZ','payment_method_type','PAYMENT_CANCELED','497150TlAUHY','amount','7544427eghtoj','Failed\x20to\x20verify\x20Rapyd\x20payment:\x20',',\x20failureMessage=','createPaymentLink','Headers:','parse','payment_method_data','PAYMENT_EXPIRED','failure_message',',\x20body:\x20','üîÑ\x20Rapyd\x20webhook\x20processed:\x20status=','Error\x20message:','error_code','Incomplete\x20response:\x20missing\x20id\x20or\x20redirect_url','cardLast4','SUCCESS','loggerService','\x20(always\x20GB\x20for\x20Rapyd)','type','===\x20RAPYD\x20API\x20INCOMPLETE\x20RESPONSE\x20===','üá¨üáß\x20Country\x20used:\x20','statusText','failure_code','Error\x20Code:','üá¨üáß\x20Using\x20GB\x20(Britain)\x20as\x20country\x20for\x20Rapyd\x20payment\x20link','Rapyd\x20payment\x20verification\x20error:','===\x20RAPYD\x20API\x20BUSINESS\x20ERROR\x20===','üá¨üáß\x20Country:\x20','654106hmuCwP','now','===\x20RAPYD\x20API\x20ERROR\x20===','Response\x20Time:','currency','error','https://tesoft.uk/gateway/success.php?id=','merchant_reference_id','3xfsVfd','PENDING','Processing\x20Rapyd\x20webhook:','===\x20RAPYD\x20SERVICE\x20ERROR\x20===','logWhiteDomainResponse','headers','redirect_url','HTTP\x20Status:','Response\x20data:','4040015FsNvMX','Status:','üí≥\x20Payment\x20Methods:\x20gb_visa_card,\x20gb_mastercard_card','TesSoft\x20Payment\x20System/1.0','POST','Rapyd\x20API\x20error\x20(','json','ACT','application/json','112JbnWDJ','RapydService','verifyPayment','none','log','entries','apiUrl','https://tesoft.uk/gateway/fail.php?id=','77yKjRBK','FAILED','gb_visa_card','defineProperty','__esModule','UNKNOWN','gb_mastercard_card','../loggerService','Full\x20Error\x20Data:','stringify','Response\x20Body:','processWebhook','Failed\x20to\x20create\x20Rapyd\x20payment\x20link:\x20Unknown\x20error','Status\x20Text:','HTTP\x20error!\x20status:\x20','rapyd','Missing\x20id\x20or\x20redirect_url\x20in\x20response','Raw\x20Response\x20Body:','/v1/hosted/payment_links','logWhiteDomainError','Rapyd\x20API\x20error:\x20','message','Failed\x20to\x20parse\x20JSON\x20response:','GET','URL:','Parsed\x20Result:','fromEntries','failureCode','logWhiteDomainRequest','status','/v1/hosted/payment_links/','data','paymentMethod','https://tesoft.uk/gateway/rapyd/','HTTP\x20','59868SzbvPp','1oiRoCu','ERR','NEW','paid','Failed\x20to\x20create\x20Rapyd\x20payment\x20link:\x20','toUpperCase','Error\x20Message:','Error\x20stack:','errorCode','CLO','üåê\x20Rapyd\x20service\x20initialized\x20with\x20white\x20domain\x20proxy','Payment\x20Link\x20ID:','PAID','Error\x20details:','2406188fpltPX','PAYMENT_FAILED','Unknown\x20error','CAN','===\x20RAPYD\x20API\x20REQUEST\x20(White\x20Domain\x20-\x20Updated\x20Format)\x20===','text','EXP','last4','EXPIRED'];a45_0x1470=function(){return _0x4d16f7;};return a45_0x1470();}class RapydService{constructor(){const _0x409817=a45_0x1e77ca;this[_0x409817(0x14c)]=_0x409817(0x16f),console[_0x409817(0x14a)](_0x409817(0x17c));}async[a45_0x1e77ca(0x191)](_0x4b0026){const _0x2cf80b=a45_0x1e77ca,{orderId:_0x3485b3,orderName:_0x1e7e06,amount:_0x516487,currency:_0x35de2d,usage:_0x5442ab,maxPayments:_0x5b067e,successUrl:_0x1ae809,failUrl:_0x480edc}=_0x4b0026,_0x5ed139=_0x35de2d[_0x2cf80b(0x177)](),_0x365b7d='GB';console[_0x2cf80b(0x14a)](_0x2cf80b(0x128));const _0x3e3e23=_0x2cf80b(0x132)+_0x3485b3,_0x4a5300=_0x2cf80b(0x14d)+_0x3485b3,_0x3865f8={'amount':_0x516487,'currency':_0x5ed139,'cancel_checkout_url':_0x4a5300,'complete_checkout_url':_0x3e3e23,'complete_payment_url':_0x3e3e23,'merchant_reference_id':_0x3485b3,'description':'ORDER:\x20'+_0x3485b3,'country':'GB','payment_method_types_include':[_0x2cf80b(0x150),_0x2cf80b(0x154)],'custom_elements':{'display_description':!![]}},_0x53e505=Date[_0x2cf80b(0x12d)]();try{console['log'](_0x2cf80b(0x184)),console[_0x2cf80b(0x14a)](_0x2cf80b(0x166),this[_0x2cf80b(0x14c)]),console[_0x2cf80b(0x14a)]('Request\x20Body\x20(Updated\x20Format):',JSON['stringify'](_0x3865f8,null,0x2)),console[_0x2cf80b(0x14a)](_0x2cf80b(0x12b)+_0x365b7d+_0x2cf80b(0x19f)),console[_0x2cf80b(0x14a)](_0x2cf80b(0x13f)),loggerService_1[_0x2cf80b(0x19e)][_0x2cf80b(0x16a)](_0x2cf80b(0x15d),'/v1/hosted/payment_links',_0x2cf80b(0x141),_0x3865f8);const _0x1a81d9=await fetch(this[_0x2cf80b(0x14c)],{'method':_0x2cf80b(0x141),'headers':{'Content-Type':_0x2cf80b(0x145),'User-Agent':_0x2cf80b(0x140)},'body':JSON[_0x2cf80b(0x157)](_0x3865f8)}),_0x519174=Date[_0x2cf80b(0x12d)]()-_0x53e505;console[_0x2cf80b(0x14a)]('===\x20RAPYD\x20API\x20RESPONSE\x20(White\x20Domain)\x20==='),console[_0x2cf80b(0x14a)](_0x2cf80b(0x13e),_0x1a81d9[_0x2cf80b(0x16b)]),console[_0x2cf80b(0x14a)](_0x2cf80b(0x15b),_0x1a81d9[_0x2cf80b(0x125)]),console[_0x2cf80b(0x14a)](_0x2cf80b(0x192),Object[_0x2cf80b(0x168)](_0x1a81d9[_0x2cf80b(0x139)][_0x2cf80b(0x14b)]())),console[_0x2cf80b(0x14a)](_0x2cf80b(0x12f),_0x519174+'ms');const _0x1d84f1=await _0x1a81d9[_0x2cf80b(0x185)]();console[_0x2cf80b(0x14a)](_0x2cf80b(0x15f),_0x1d84f1);if(!_0x1a81d9['ok']){console[_0x2cf80b(0x131)](_0x2cf80b(0x12e)),console['error'](_0x2cf80b(0x13b),_0x1a81d9[_0x2cf80b(0x16b)]),console['error'](_0x2cf80b(0x158),_0x1d84f1),loggerService_1[_0x2cf80b(0x19e)][_0x2cf80b(0x138)]('rapyd','/v1/hosted/payment_links',_0x1a81d9[_0x2cf80b(0x16b)],_0x1d84f1,_0x519174),loggerService_1[_0x2cf80b(0x19e)][_0x2cf80b(0x161)](_0x2cf80b(0x15d),_0x2cf80b(0x160),_0x2cf80b(0x170)+_0x1a81d9[_0x2cf80b(0x16b)]+':\x20'+_0x1d84f1);throw new Error('HTTP\x20error!\x20status:\x20'+_0x1a81d9[_0x2cf80b(0x16b)]+_0x2cf80b(0x197)+_0x1d84f1);}let _0x4ff29e;try{_0x4ff29e=JSON[_0x2cf80b(0x193)](_0x1d84f1);}catch(_0x265b9b){console[_0x2cf80b(0x131)](_0x2cf80b(0x164),_0x265b9b),loggerService_1[_0x2cf80b(0x19e)][_0x2cf80b(0x161)]('rapyd',_0x2cf80b(0x160),'JSON\x20Parse\x20Error:\x20'+_0x265b9b);throw new Error('Invalid\x20JSON\x20response\x20from\x20Rapyd\x20API:\x20'+_0x1d84f1);}console[_0x2cf80b(0x14a)]('===\x20PARSED\x20RAPYD\x20RESPONSE\x20==='),console['log'](_0x2cf80b(0x167),JSON['stringify'](_0x4ff29e,null,0x2)),loggerService_1[_0x2cf80b(0x19e)][_0x2cf80b(0x138)](_0x2cf80b(0x15d),_0x2cf80b(0x160),_0x1a81d9[_0x2cf80b(0x16b)],_0x4ff29e,_0x519174);if(_0x4ff29e['status']?.['status']!==_0x2cf80b(0x19d)){const _0x29cd16=_0x4ff29e[_0x2cf80b(0x16b)]?.[_0x2cf80b(0x163)]||'Unknown\x20error\x20from\x20Rapyd\x20API',_0x32ed9d=_0x4ff29e[_0x2cf80b(0x16b)]?.[_0x2cf80b(0x19a)]||_0x2cf80b(0x153);console[_0x2cf80b(0x131)](_0x2cf80b(0x12a)),console[_0x2cf80b(0x131)](_0x2cf80b(0x127),_0x32ed9d),console[_0x2cf80b(0x131)](_0x2cf80b(0x178),_0x29cd16),console['error'](_0x2cf80b(0x156),_0x4ff29e['status']),loggerService_1[_0x2cf80b(0x19e)]['logWhiteDomainError']('rapyd',_0x2cf80b(0x160),'Business\x20Error\x20('+_0x32ed9d+'):\x20'+_0x29cd16);throw new Error(_0x2cf80b(0x142)+_0x32ed9d+'):\x20'+_0x29cd16);}if(!_0x4ff29e[_0x2cf80b(0x16d)]?.['id']||!_0x4ff29e[_0x2cf80b(0x16d)]?.[_0x2cf80b(0x13a)]){console[_0x2cf80b(0x131)](_0x2cf80b(0x1a1)),console[_0x2cf80b(0x131)](_0x2cf80b(0x15e)),console[_0x2cf80b(0x131)](_0x2cf80b(0x13c),_0x4ff29e[_0x2cf80b(0x16d)]),loggerService_1[_0x2cf80b(0x19e)][_0x2cf80b(0x161)](_0x2cf80b(0x15d),_0x2cf80b(0x160),_0x2cf80b(0x19b));throw new Error('Invalid\x20response\x20from\x20Rapyd\x20API:\x20missing\x20id\x20or\x20redirect_url');}return console[_0x2cf80b(0x14a)]('===\x20RAPYD\x20SUCCESS\x20==='),console[_0x2cf80b(0x14a)](_0x2cf80b(0x17d),_0x4ff29e[_0x2cf80b(0x16d)]['id']),console[_0x2cf80b(0x14a)]('Redirect\x20URL:',_0x4ff29e['data'][_0x2cf80b(0x13a)]),console['log'](_0x2cf80b(0x124)+_0x365b7d+'\x20(GB\x20-\x20Britain)'),console['log'](_0x2cf80b(0x13f)),{'gateway_payment_id':_0x4ff29e['data']['id'],'payment_url':_0x4ff29e['data'][_0x2cf80b(0x13a)]};}catch(_0x5e3af7){console[_0x2cf80b(0x131)](_0x2cf80b(0x137)),console[_0x2cf80b(0x131)](_0x2cf80b(0x17f),_0x5e3af7),loggerService_1['loggerService'][_0x2cf80b(0x161)](_0x2cf80b(0x15d),_0x2cf80b(0x160),_0x5e3af7);if(_0x5e3af7 instanceof Error){console[_0x2cf80b(0x131)](_0x2cf80b(0x199),_0x5e3af7['message']),console[_0x2cf80b(0x131)](_0x2cf80b(0x179),_0x5e3af7['stack']);throw new Error(_0x2cf80b(0x176)+_0x5e3af7['message']);}throw new Error(_0x2cf80b(0x15a));}}async[a45_0x1e77ca(0x148)](_0x90c798){const _0x12cae3=a45_0x1e77ca,_0x4f391c=Date[_0x12cae3(0x12d)]();try{loggerService_1[_0x12cae3(0x19e)][_0x12cae3(0x16a)](_0x12cae3(0x15d),_0x12cae3(0x16c)+_0x90c798,_0x12cae3(0x165),{});const _0x3c2a13=await fetch(this[_0x12cae3(0x14c)]+'/'+_0x90c798,{'method':_0x12cae3(0x165),'headers':{'Content-Type':'application/json','User-Agent':'TesSoft\x20Payment\x20System/1.0'}}),_0x32a5f6=Date[_0x12cae3(0x12d)]()-_0x4f391c;if(!_0x3c2a13['ok']){const _0x51f155=await _0x3c2a13['text']();loggerService_1[_0x12cae3(0x19e)]['logWhiteDomainResponse'](_0x12cae3(0x15d),_0x12cae3(0x16c)+_0x90c798,_0x3c2a13[_0x12cae3(0x16b)],_0x51f155,_0x32a5f6);throw new Error(_0x12cae3(0x15c)+_0x3c2a13['status']);}const _0x5a1d17=await _0x3c2a13[_0x12cae3(0x143)]();loggerService_1[_0x12cae3(0x19e)]['logWhiteDomainResponse'](_0x12cae3(0x15d),_0x12cae3(0x16c)+_0x90c798,_0x3c2a13[_0x12cae3(0x16b)],_0x5a1d17,_0x32a5f6);if(_0x5a1d17[_0x12cae3(0x16b)]?.[_0x12cae3(0x16b)]!==_0x12cae3(0x19d)){loggerService_1[_0x12cae3(0x19e)][_0x12cae3(0x161)]('rapyd','/v1/hosted/payment_links/'+_0x90c798,_0x12cae3(0x162)+(_0x5a1d17[_0x12cae3(0x16b)]?.[_0x12cae3(0x163)]||'Unknown\x20error'));throw new Error('Rapyd\x20API\x20error:\x20'+(_0x5a1d17['status']?.[_0x12cae3(0x163)]||_0x12cae3(0x182)));}let _0x1af82e=_0x12cae3(0x135);if(_0x5a1d17[_0x12cae3(0x16d)]?.[_0x12cae3(0x16b)])switch(_0x5a1d17['data']['status'][_0x12cae3(0x177)]()){case'CLO':_0x1af82e=_0x12cae3(0x17e);break;case'CAN':_0x1af82e=_0x12cae3(0x14f);break;case _0x12cae3(0x186):_0x1af82e=_0x12cae3(0x188);break;case _0x12cae3(0x173):_0x1af82e='FAILED';break;case _0x12cae3(0x174):case'ACT':default:_0x1af82e='PENDING';break;}return{'status':_0x1af82e,'amount':_0x5a1d17[_0x12cae3(0x16d)]?.['amount'],'currency':_0x5a1d17[_0x12cae3(0x16d)]?.[_0x12cae3(0x130)]};}catch(_0x124584){console[_0x12cae3(0x131)](_0x12cae3(0x129),_0x124584),loggerService_1[_0x12cae3(0x19e)][_0x12cae3(0x161)](_0x12cae3(0x15d),_0x12cae3(0x16c)+_0x90c798,_0x124584);throw new Error(_0x12cae3(0x18f)+(_0x124584 instanceof Error?_0x124584[_0x12cae3(0x163)]:_0x12cae3(0x182)));}}async[a45_0x1e77ca(0x159)](_0x286516){const _0x3df240=a45_0x1e77ca;console[_0x3df240(0x14a)](_0x3df240(0x136),_0x286516);let _0x5aae62=_0x3df240(0x135),_0x578b93;_0x286516['data']?.[_0x3df240(0x196)]&&(_0x578b93=_0x286516[_0x3df240(0x16d)]['failure_message'],console[_0x3df240(0x14a)]('üí•\x20Rapyd\x20failure\x20message:\x20'+_0x578b93));switch(_0x286516[_0x3df240(0x1a0)]?.[_0x3df240(0x177)]()){case'PAYMENT_COMPLETED':_0x286516[_0x3df240(0x16d)]?.['paid']===!![]&&_0x286516[_0x3df240(0x16d)]?.['status']===_0x3df240(0x17b)?_0x5aae62=_0x3df240(0x17e):_0x5aae62=_0x3df240(0x135);break;case _0x3df240(0x18b):_0x5aae62=_0x3df240(0x14f);break;case _0x3df240(0x195):_0x5aae62=_0x3df240(0x188);break;case _0x3df240(0x181):_0x5aae62='FAILED';!_0x578b93&&_0x286516[_0x3df240(0x16d)]?.[_0x3df240(0x196)]&&(_0x578b93=_0x286516[_0x3df240(0x16d)]['failure_message']);break;default:switch(_0x286516[_0x3df240(0x16d)]?.[_0x3df240(0x16b)]?.[_0x3df240(0x177)]()){case _0x3df240(0x17b):_0x286516[_0x3df240(0x16d)]?.[_0x3df240(0x175)]===!![]?_0x5aae62=_0x3df240(0x17e):_0x5aae62=_0x3df240(0x14f);break;case _0x3df240(0x183):_0x5aae62='FAILED';break;case _0x3df240(0x186):_0x5aae62=_0x3df240(0x188);break;case _0x3df240(0x173):_0x5aae62=_0x3df240(0x14f);!_0x578b93&&_0x286516[_0x3df240(0x16d)]?.[_0x3df240(0x196)]&&(_0x578b93=_0x286516[_0x3df240(0x16d)][_0x3df240(0x196)]);break;case _0x3df240(0x174):case _0x3df240(0x144):default:_0x5aae62=_0x3df240(0x135);break;}break;}const _0x5d0208={};return _0x286516[_0x3df240(0x16d)]?.[_0x3df240(0x194)]?.[_0x3df240(0x187)]&&(_0x5d0208[_0x3df240(0x19c)]=_0x286516[_0x3df240(0x16d)][_0x3df240(0x194)]['last4']),_0x286516[_0x3df240(0x16d)]?.[_0x3df240(0x18a)]&&(_0x5d0208[_0x3df240(0x16e)]=_0x286516[_0x3df240(0x16d)][_0x3df240(0x18a)]),_0x286516[_0x3df240(0x16d)]?.[_0x3df240(0x19a)]&&(_0x5d0208[_0x3df240(0x17a)]=_0x286516[_0x3df240(0x16d)]['error_code']),_0x286516[_0x3df240(0x16d)]?.[_0x3df240(0x126)]&&(_0x5d0208[_0x3df240(0x169)]=_0x286516[_0x3df240(0x16d)][_0x3df240(0x126)]),console[_0x3df240(0x14a)](_0x3df240(0x198)+_0x5aae62+_0x3df240(0x190)+(_0x578b93||_0x3df240(0x149))),{'paymentId':_0x286516[_0x3df240(0x16d)]?.[_0x3df240(0x133)]||'','status':_0x5aae62,'amount':_0x286516[_0x3df240(0x16d)]?.[_0x3df240(0x18d)],'currency':_0x286516[_0x3df240(0x16d)]?.[_0x3df240(0x130)],'failureMessage':_0x578b93,'additionalInfo':_0x5d0208};}}exports[a45_0x1e77ca(0x147)]=RapydService;