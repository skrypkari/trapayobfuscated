'use strict';const a56_0x584177=a56_0x1216;(function(_0x403426,_0x1adb2e){const _0x135584=a56_0x1216,_0x396d83=_0x403426();while(!![]){try{const _0x5e2208=-parseInt(_0x135584(0x113))/0x1*(-parseInt(_0x135584(0xaa))/0x2)+parseInt(_0x135584(0xe6))/0x3*(-parseInt(_0x135584(0xa9))/0x4)+parseInt(_0x135584(0x108))/0x5*(-parseInt(_0x135584(0xcd))/0x6)+parseInt(_0x135584(0x9c))/0x7+-parseInt(_0x135584(0x9d))/0x8+-parseInt(_0x135584(0xd8))/0x9+parseInt(_0x135584(0x100))/0xa*(parseInt(_0x135584(0xc7))/0xb);if(_0x5e2208===_0x1adb2e)break;else _0x396d83['push'](_0x396d83['shift']());}catch(_0x306b1b){_0x396d83['push'](_0x396d83['shift']());}}}(a56_0x1945,0xc4e6d));Object[a56_0x584177(0xe4)](exports,a56_0x584177(0x107),{'value':!![]}),exports[a56_0x584177(0xae)]=void 0x0;const loggerService_1=require(a56_0x584177(0xed));function a56_0x1945(){const _0x38c628=['requested_currency','error_code','defineProperty','Status:','282XvPtSV','🇬🇧\x20Country\x20used:\x20','Rapyd\x20API\x20error:\x20','Payment\x20Link\x20ID:','floor','Error\x20stack:','Unknown\x20error\x20from\x20Rapyd\x20API','../loggerService','log','statusText','payment_method_type','===\x20RAPYD\x20SERVICE\x20ERROR\x20===','https://tesoft.uk/gateway/success.php?id=','stack','amount','===\x20RAPYD\x20API\x20INCOMPLETE\x20RESPONSE\x20===','redirect_url','PENDING','PAYMENT_FAILED','fromEntries','/v1/hosted/payment_links/','gb_visa_card','\x20(GB\x20-\x20Britain)','===\x20RAPYD\x20SUCCESS\x20===','status','toISOString','10QPRDMf','HTTP\x20error!\x20status:\x20','JSON\x20Parse\x20Error:\x20','HTTP\x20','===\x20RAPYD\x20API\x20ERROR\x20===','PAYMENT_EXPIRED','Failed\x20to\x20verify\x20Rapyd\x20payment:\x20','__esModule','252690BYqMMX','🇬🇧\x20Country:\x20','failure_message','logWhiteDomainResponse','Business\x20Error\x20(','stringify','Failed\x20to\x20create\x20Rapyd\x20payment\x20link:\x20','GET','createPaymentLink','PAYMENT_CANCELED','loggerService','23148vzlVeB','NEW','CAN','ACT','entries','failure_code','FAILED','\x20\x20\x20requested_currency:\x20EUR','Rapyd\x20payment\x20verification\x20error:','logWhiteDomainRequest','none','message','5196331FSYkkk','5139696bDVRmN','\x20\x20\x20fixed_side:\x20buy','Full\x20Error\x20Data:','===\x20RAPYD\x20API\x20RESPONSE\x20(White\x20Domain)\x20===','Parsed\x20Result:','💱\x20Adding\x20currency\x20conversion\x20fields\x20for\x20','Missing\x20id\x20or\x20redirect_url\x20in\x20response','Incomplete\x20response:\x20missing\x20id\x20or\x20redirect_url','Invalid\x20response\x20from\x20Rapyd\x20API:\x20missing\x20id\x20or\x20redirect_url','currency','application/json','ERR','3884ZRVkyN','18mePFwz','🌐\x20Rapyd\x20service\x20initialized\x20with\x20white\x20domain\x20proxy','apiUrl','Payment\x20System/1.0','RapydService','🇬🇧\x20Using\x20GB\x20(Britain)\x20as\x20country\x20for\x20Rapyd\x20payment\x20link','Error\x20Code:','verifyPayment','💥\x20Rapyd\x20failure\x20message:\x20','===\x20RAPYD\x20API\x20BUSINESS\x20ERROR\x20===','EUR','URL:','logWhiteDomainError','failureCode','EXP','Rapyd\x20API\x20error\x20(','EXPIRED','buy','text','errorCode','headers','===\x20RAPYD\x20API\x20REQUEST\x20(White\x20Domain\x20-\x20Updated\x20Format)\x20===','Response\x20Time:','/v1/hosted/payment_links','):\x20','type','💳\x20Payment\x20Methods:\x20gb_visa_card,\x20gb_mastercard_card','Headers:','PAYMENT_COMPLETED','21186781stKXVF','POST','Error\x20message:','paid','processWebhook',',\x20failureMessage=','24VRvyIQ','HTTP\x20Status:','https://tesoft.uk/gateway/fail.php?id=','===\x20PARSED\x20RAPYD\x20RESPONSE\x20===','Unknown\x20error','Error\x20details:','payment_method_data','toUpperCase','error','paymentMethod','PAID','10209051pJZhqk','last4','Response\x20data:','Response\x20Body:','Failed\x20to\x20parse\x20JSON\x20response:','rapyd','SUCCESS','data','now','Raw\x20Response\x20Body:'];a56_0x1945=function(){return _0x38c628;};return a56_0x1945();}function a56_0x1216(_0x1b1cdc,_0x2a83a5){const _0x19454e=a56_0x1945();return a56_0x1216=function(_0x1216e8,_0x2e9f2e){_0x1216e8=_0x1216e8-0x96;let _0x20a839=_0x19454e[_0x1216e8];return _0x20a839;},a56_0x1216(_0x1b1cdc,_0x2a83a5);}class RapydService{constructor(){const _0x3f7258=a56_0x584177;this[_0x3f7258(0xac)]='https://tesoft.uk/gateway/rapyd/',console[_0x3f7258(0xee)](_0x3f7258(0xab));}async[a56_0x584177(0x110)](_0x4be434){const _0x262d21=a56_0x584177,{orderId:_0x131695,orderName:_0x1f161b,amount:_0x4ac4a7,currency:_0x353130,usage:_0x20b046,maxPayments:_0x11f627,successUrl:_0x13ec07,failUrl:_0x26d58e}=_0x4be434,_0x1895ff=_0x353130[_0x262d21(0xd4)](),_0x2516c0='GB';console[_0x262d21(0xee)](_0x262d21(0xaf));const _0x3d5938=_0x262d21(0xf2)+_0x131695,_0x3d242d=_0x262d21(0xcf)+_0x131695,_0x158421={'amount':_0x4ac4a7,'currency':_0x1895ff,'cancel_checkout_url':_0x3d242d,'complete_checkout_url':_0x3d5938,'complete_payment_url':_0x3d5938,'merchant_reference_id':_0x131695,'description':'ORDER:\x20'+_0x131695,'country':'GB','payment_method_types_include':[_0x262d21(0xfb),'gb_mastercard_card'],'custom_elements':{'display_description':!![]}};if(_0x1895ff!==_0x262d21(0xb4)){const _0x8d20ce=Math[_0x262d21(0xea)](Date['now']()/0x3e8)+0x1e*0x3c;_0x158421['fixed_side']=_0x262d21(0xbb),_0x158421[_0x262d21(0xe2)]='EUR',_0x158421['expiration']=_0x8d20ce,console[_0x262d21(0xee)](_0x262d21(0xa2)+_0x1895ff+'\x20->\x20EUR:'),console['log'](_0x262d21(0x9e)),console[_0x262d21(0xee)](_0x262d21(0x97)),console['log']('\x20\x20\x20expiration:\x20'+_0x8d20ce+'\x20('+new Date(_0x8d20ce*0x3e8)[_0x262d21(0xff)]()+')');}const _0xc270d2=Date[_0x262d21(0xe0)]();try{console[_0x262d21(0xee)](_0x262d21(0xbf)),console['log'](_0x262d21(0xb5),this[_0x262d21(0xac)]),console[_0x262d21(0xee)]('Request\x20Body\x20(Updated\x20Format):',JSON[_0x262d21(0x10d)](_0x158421,null,0x2)),console[_0x262d21(0xee)](_0x262d21(0x109)+_0x2516c0+'\x20(always\x20GB\x20for\x20Rapyd)'),console[_0x262d21(0xee)](_0x262d21(0xc4)),loggerService_1[_0x262d21(0x112)][_0x262d21(0x99)](_0x262d21(0xdd),_0x262d21(0xc1),_0x262d21(0xc8),_0x158421);const _0x1cb9e7=await fetch(this['apiUrl'],{'method':_0x262d21(0xc8),'headers':{'Content-Type':_0x262d21(0xa7),'User-Agent':_0x262d21(0xad)},'body':JSON[_0x262d21(0x10d)](_0x158421)}),_0x35766b=Date[_0x262d21(0xe0)]()-_0xc270d2;console['log'](_0x262d21(0xa0)),console[_0x262d21(0xee)](_0x262d21(0xe5),_0x1cb9e7[_0x262d21(0xfe)]),console[_0x262d21(0xee)]('Status\x20Text:',_0x1cb9e7[_0x262d21(0xef)]),console[_0x262d21(0xee)](_0x262d21(0xc5),Object[_0x262d21(0xf9)](_0x1cb9e7[_0x262d21(0xbe)][_0x262d21(0x117)]())),console[_0x262d21(0xee)](_0x262d21(0xc0),_0x35766b+'ms');const _0x4e1e4c=await _0x1cb9e7[_0x262d21(0xbc)]();console[_0x262d21(0xee)](_0x262d21(0xe1),_0x4e1e4c);if(!_0x1cb9e7['ok']){console[_0x262d21(0xd5)](_0x262d21(0x104)),console[_0x262d21(0xd5)](_0x262d21(0xce),_0x1cb9e7['status']),console['error'](_0x262d21(0xdb),_0x4e1e4c),loggerService_1[_0x262d21(0x112)][_0x262d21(0x10b)](_0x262d21(0xdd),'/v1/hosted/payment_links',_0x1cb9e7['status'],_0x4e1e4c,_0x35766b),loggerService_1['loggerService'][_0x262d21(0xb6)](_0x262d21(0xdd),_0x262d21(0xc1),_0x262d21(0x103)+_0x1cb9e7[_0x262d21(0xfe)]+':\x20'+_0x4e1e4c);throw new Error(_0x262d21(0x101)+_0x1cb9e7[_0x262d21(0xfe)]+',\x20body:\x20'+_0x4e1e4c);}let _0x4564ae;try{_0x4564ae=JSON['parse'](_0x4e1e4c);}catch(_0x2e0737){console[_0x262d21(0xd5)](_0x262d21(0xdc),_0x2e0737),loggerService_1[_0x262d21(0x112)][_0x262d21(0xb6)]('rapyd',_0x262d21(0xc1),_0x262d21(0x102)+_0x2e0737);throw new Error('Invalid\x20JSON\x20response\x20from\x20Rapyd\x20API:\x20'+_0x4e1e4c);}console[_0x262d21(0xee)](_0x262d21(0xd0)),console[_0x262d21(0xee)](_0x262d21(0xa1),JSON[_0x262d21(0x10d)](_0x4564ae,null,0x2)),loggerService_1['loggerService'][_0x262d21(0x10b)]('rapyd',_0x262d21(0xc1),_0x1cb9e7[_0x262d21(0xfe)],_0x4564ae,_0x35766b);if(_0x4564ae[_0x262d21(0xfe)]?.[_0x262d21(0xfe)]!==_0x262d21(0xde)){const _0x4faf0f=_0x4564ae[_0x262d21(0xfe)]?.[_0x262d21(0x9b)]||_0x262d21(0xec),_0x35fcb9=_0x4564ae[_0x262d21(0xfe)]?.[_0x262d21(0xe3)]||'UNKNOWN';console['error'](_0x262d21(0xb3)),console[_0x262d21(0xd5)](_0x262d21(0xb0),_0x35fcb9),console[_0x262d21(0xd5)]('Error\x20Message:',_0x4faf0f),console[_0x262d21(0xd5)](_0x262d21(0x9f),_0x4564ae['status']),loggerService_1[_0x262d21(0x112)]['logWhiteDomainError'](_0x262d21(0xdd),'/v1/hosted/payment_links',_0x262d21(0x10c)+_0x35fcb9+_0x262d21(0xc2)+_0x4faf0f);throw new Error(_0x262d21(0xb9)+_0x35fcb9+_0x262d21(0xc2)+_0x4faf0f);}if(!_0x4564ae['data']?.['id']||!_0x4564ae['data']?.[_0x262d21(0xf6)]){console['error'](_0x262d21(0xf5)),console[_0x262d21(0xd5)](_0x262d21(0xa3)),console['error'](_0x262d21(0xda),_0x4564ae['data']),loggerService_1['loggerService'][_0x262d21(0xb6)](_0x262d21(0xdd),'/v1/hosted/payment_links',_0x262d21(0xa4));throw new Error(_0x262d21(0xa5));}return console['log'](_0x262d21(0xfd)),console['log'](_0x262d21(0xe9),_0x4564ae[_0x262d21(0xdf)]['id']),console['log']('Redirect\x20URL:',_0x4564ae[_0x262d21(0xdf)][_0x262d21(0xf6)]),console[_0x262d21(0xee)](_0x262d21(0xe7)+_0x2516c0+_0x262d21(0xfc)),console[_0x262d21(0xee)](_0x262d21(0xc4)),{'gateway_payment_id':_0x4564ae[_0x262d21(0xdf)]['id'],'payment_url':_0x4564ae[_0x262d21(0xdf)][_0x262d21(0xf6)]};}catch(_0x34020f){console[_0x262d21(0xd5)](_0x262d21(0xf1)),console[_0x262d21(0xd5)](_0x262d21(0xd2),_0x34020f),loggerService_1[_0x262d21(0x112)][_0x262d21(0xb6)](_0x262d21(0xdd),'/v1/hosted/payment_links',_0x34020f);if(_0x34020f instanceof Error){console[_0x262d21(0xd5)](_0x262d21(0xc9),_0x34020f['message']),console[_0x262d21(0xd5)](_0x262d21(0xeb),_0x34020f[_0x262d21(0xf3)]);throw new Error(_0x262d21(0x10e)+_0x34020f['message']);}throw new Error('Failed\x20to\x20create\x20Rapyd\x20payment\x20link:\x20Unknown\x20error');}}async[a56_0x584177(0xb1)](_0x8051a5){const _0x441744=a56_0x584177,_0x247407=Date[_0x441744(0xe0)]();try{loggerService_1[_0x441744(0x112)]['logWhiteDomainRequest'](_0x441744(0xdd),_0x441744(0xfa)+_0x8051a5,_0x441744(0x10f),{});const _0x45b00b=await fetch(this[_0x441744(0xac)]+'/'+_0x8051a5,{'method':_0x441744(0x10f),'headers':{'Content-Type':_0x441744(0xa7),'User-Agent':_0x441744(0xad)}}),_0x123e3f=Date[_0x441744(0xe0)]()-_0x247407;if(!_0x45b00b['ok']){const _0x270c6a=await _0x45b00b['text']();loggerService_1['loggerService']['logWhiteDomainResponse'](_0x441744(0xdd),_0x441744(0xfa)+_0x8051a5,_0x45b00b[_0x441744(0xfe)],_0x270c6a,_0x123e3f);throw new Error('HTTP\x20error!\x20status:\x20'+_0x45b00b[_0x441744(0xfe)]);}const _0x167824=await _0x45b00b['json']();loggerService_1[_0x441744(0x112)][_0x441744(0x10b)]('rapyd',_0x441744(0xfa)+_0x8051a5,_0x45b00b['status'],_0x167824,_0x123e3f);if(_0x167824[_0x441744(0xfe)]?.[_0x441744(0xfe)]!=='SUCCESS'){loggerService_1[_0x441744(0x112)][_0x441744(0xb6)](_0x441744(0xdd),_0x441744(0xfa)+_0x8051a5,_0x441744(0xe8)+(_0x167824[_0x441744(0xfe)]?.[_0x441744(0x9b)]||_0x441744(0xd1)));throw new Error(_0x441744(0xe8)+(_0x167824[_0x441744(0xfe)]?.[_0x441744(0x9b)]||'Unknown\x20error'));}let _0x3e9038=_0x441744(0xf7);if(_0x167824[_0x441744(0xdf)]?.[_0x441744(0xfe)])switch(_0x167824[_0x441744(0xdf)][_0x441744(0xfe)][_0x441744(0xd4)]()){case'CLO':_0x3e9038='PAID';break;case _0x441744(0x115):_0x3e9038=_0x441744(0x96);break;case _0x441744(0xb8):_0x3e9038='EXPIRED';break;case _0x441744(0xa8):_0x3e9038=_0x441744(0x96);break;case _0x441744(0x114):case _0x441744(0x116):default:_0x3e9038=_0x441744(0xf7);break;}return{'status':_0x3e9038,'amount':_0x167824[_0x441744(0xdf)]?.[_0x441744(0xf4)],'currency':_0x167824[_0x441744(0xdf)]?.[_0x441744(0xa6)]};}catch(_0x1ef6f8){console[_0x441744(0xd5)](_0x441744(0x98),_0x1ef6f8),loggerService_1['loggerService'][_0x441744(0xb6)](_0x441744(0xdd),_0x441744(0xfa)+_0x8051a5,_0x1ef6f8);throw new Error(_0x441744(0x106)+(_0x1ef6f8 instanceof Error?_0x1ef6f8[_0x441744(0x9b)]:'Unknown\x20error'));}}async[a56_0x584177(0xcb)](_0x1c9f6c){const _0x42997a=a56_0x584177;console[_0x42997a(0xee)]('Processing\x20Rapyd\x20webhook:',_0x1c9f6c);let _0x5bffa8=_0x42997a(0xf7),_0x4c3191;_0x1c9f6c['data']?.[_0x42997a(0x10a)]&&(_0x4c3191=_0x1c9f6c[_0x42997a(0xdf)][_0x42997a(0x10a)],console['log'](_0x42997a(0xb2)+_0x4c3191));switch(_0x1c9f6c[_0x42997a(0xc3)]?.[_0x42997a(0xd4)]()){case _0x42997a(0xc6):_0x1c9f6c['data']?.['paid']===!![]&&_0x1c9f6c[_0x42997a(0xdf)]?.[_0x42997a(0xfe)]==='CLO'?_0x5bffa8='PAID':_0x5bffa8=_0x42997a(0xf7);break;case _0x42997a(0x111):_0x5bffa8='FAILED';break;case _0x42997a(0x105):_0x5bffa8=_0x42997a(0xba);break;case _0x42997a(0xf8):_0x5bffa8='FAILED';!_0x4c3191&&_0x1c9f6c['data']?.[_0x42997a(0x10a)]&&(_0x4c3191=_0x1c9f6c[_0x42997a(0xdf)][_0x42997a(0x10a)]);break;default:switch(_0x1c9f6c[_0x42997a(0xdf)]?.[_0x42997a(0xfe)]?.[_0x42997a(0xd4)]()){case'CLO':_0x1c9f6c[_0x42997a(0xdf)]?.[_0x42997a(0xca)]===!![]?_0x5bffa8=_0x42997a(0xd7):_0x5bffa8=_0x42997a(0x96);break;case _0x42997a(0x115):_0x5bffa8=_0x42997a(0x96);break;case _0x42997a(0xb8):_0x5bffa8=_0x42997a(0xba);break;case'ERR':_0x5bffa8=_0x42997a(0x96);!_0x4c3191&&_0x1c9f6c[_0x42997a(0xdf)]?.[_0x42997a(0x10a)]&&(_0x4c3191=_0x1c9f6c[_0x42997a(0xdf)][_0x42997a(0x10a)]);break;case'NEW':case _0x42997a(0x116):default:_0x5bffa8=_0x42997a(0xf7);break;}break;}const _0x1b6d84={};return _0x1c9f6c['data']?.[_0x42997a(0xd3)]?.[_0x42997a(0xd9)]&&(_0x1b6d84['cardLast4']=_0x1c9f6c[_0x42997a(0xdf)][_0x42997a(0xd3)]['last4']),_0x1c9f6c[_0x42997a(0xdf)]?.[_0x42997a(0xf0)]&&(_0x1b6d84[_0x42997a(0xd6)]=_0x1c9f6c['data'][_0x42997a(0xf0)]),_0x1c9f6c[_0x42997a(0xdf)]?.[_0x42997a(0xe3)]&&(_0x1b6d84[_0x42997a(0xbd)]=_0x1c9f6c[_0x42997a(0xdf)]['error_code']),_0x1c9f6c['data']?.[_0x42997a(0x118)]&&(_0x1b6d84[_0x42997a(0xb7)]=_0x1c9f6c[_0x42997a(0xdf)][_0x42997a(0x118)]),console[_0x42997a(0xee)]('🔄\x20Rapyd\x20webhook\x20processed:\x20status='+_0x5bffa8+_0x42997a(0xcc)+(_0x4c3191||_0x42997a(0x9a))),{'paymentId':_0x1c9f6c[_0x42997a(0xdf)]?.['merchant_reference_id']||'','status':_0x5bffa8,'amount':_0x1c9f6c[_0x42997a(0xdf)]?.[_0x42997a(0xf4)],'currency':_0x1c9f6c[_0x42997a(0xdf)]?.['currency'],'failureMessage':_0x4c3191,'additionalInfo':_0x1b6d84};}}exports[a56_0x584177(0xae)]=RapydService;