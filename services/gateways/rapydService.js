'use strict';const a42_0x475af8=a42_0x19f0;(function(_0x8081b1,_0x15e237){const _0x113726=a42_0x19f0,_0x1ef6b2=_0x8081b1();while(!![]){try{const _0x808c0=parseInt(_0x113726(0x22a))/0x1*(-parseInt(_0x113726(0x202))/0x2)+-parseInt(_0x113726(0x1f1))/0x3+parseInt(_0x113726(0x210))/0x4+parseInt(_0x113726(0x1e9))/0x5*(parseInt(_0x113726(0x208))/0x6)+-parseInt(_0x113726(0x218))/0x7*(-parseInt(_0x113726(0x222))/0x8)+parseInt(_0x113726(0x22d))/0x9+-parseInt(_0x113726(0x23a))/0xa*(parseInt(_0x113726(0x1f5))/0xb);if(_0x808c0===_0x15e237)break;else _0x1ef6b2['push'](_0x1ef6b2['shift']());}catch(_0x40ddfe){_0x1ef6b2['push'](_0x1ef6b2['shift']());}}}(a42_0x2115,0xd2c10));function a42_0x2115(){const _0x3bb1ad=['rapyd','Unknown\x20error','Rapyd\x20API\x20error:\x20','now','toUpperCase','8484875ZeUIye','entries','gb_mastercard_card','Response\x20Time:','redirect_url','stack','error','ACT','1629591mfiExQ','Error\x20stack:','stringify','defineProperty','11TSdgxs','json','üí≥\x20Payment\x20Methods:\x20gb_visa_card,\x20gb_mastercard_card','logWhiteDomainError','POST','Missing\x20id\x20or\x20redirect_url\x20in\x20response','Failed\x20to\x20create\x20Rapyd\x20payment\x20link:\x20','JSON\x20Parse\x20Error:\x20','data','application/json','https://tesoft.uk/gateway/fail.php?id=','logWhiteDomainResponse','Request\x20Body\x20(Updated\x20Format):','2976656SSBHWU','../loggerService','GET','logWhiteDomainRequest','===\x20RAPYD\x20SERVICE\x20ERROR\x20===','HTTP\x20error!\x20status:\x20','6vjysYu','Unknown\x20error\x20from\x20Rapyd\x20API','/v1/hosted/payment_links/','\x20(GB\x20-\x20Britain)','Invalid\x20response\x20from\x20Rapyd\x20API:\x20missing\x20id\x20or\x20redirect_url','Response\x20Body:','HTTP\x20Status:','PAYMENT_COMPLETED','6043232sjbInd','üåê\x20Rapyd\x20service\x20initialized\x20with\x20white\x20domain\x20proxy','EXPIRED','headers','PENDING','status','currency','Raw\x20Response\x20Body:','6008065cjLhwt','\x20(always\x20GB\x20for\x20Rapyd)','processWebhook','Business\x20Error\x20(','TesSoft\x20Payment\x20System/1.0','Parsed\x20Result:','https://tesoft.uk/gateway/rapyd/','parse','Headers:','Status\x20Text:','8sOdlHw','text','HTTP\x20','URL:','createPaymentLink','apiUrl','RapydService','Failed\x20to\x20verify\x20Rapyd\x20payment:\x20','1zqtPAH','Error\x20details:','Error\x20Message:','13841046TwgraP','===\x20RAPYD\x20API\x20REQUEST\x20(White\x20Domain\x20-\x20Updated\x20Format)\x20===','Response\x20data:','ERR','amount','loggerService','Incomplete\x20response:\x20missing\x20id\x20or\x20redirect_url','__esModule','ORDER:\x20','statusText','PAYMENT_EXPIRED','log','https://tesoft.uk/gateway/success.php?id=','27091990YcLjvz','/v1/hosted/payment_links','EXP','gb_visa_card','fromEntries','üá¨üáß\x20Using\x20GB\x20(Britain)\x20as\x20country\x20for\x20Rapyd\x20payment\x20link','CLO','FAILED','Rapyd\x20API\x20error\x20(','SUCCESS','PAID','Failed\x20to\x20create\x20Rapyd\x20payment\x20link:\x20Unknown\x20error','):\x20','NEW','===\x20RAPYD\x20SUCCESS\x20===','paid','message','Full\x20Error\x20Data:'];a42_0x2115=function(){return _0x3bb1ad;};return a42_0x2115();}function a42_0x19f0(_0x4a156f,_0x5ed282){const _0x211567=a42_0x2115();return a42_0x19f0=function(_0x19f04b,_0x568a2a){_0x19f04b=_0x19f04b-0x1e1;let _0x5f085b=_0x211567[_0x19f04b];return _0x5f085b;},a42_0x19f0(_0x4a156f,_0x5ed282);}Object[a42_0x475af8(0x1f4)](exports,a42_0x475af8(0x234),{'value':!![]}),exports['RapydService']=void 0x0;const loggerService_1=require(a42_0x475af8(0x203));class RapydService{constructor(){const _0x1a9d53=a42_0x475af8;this[_0x1a9d53(0x227)]=_0x1a9d53(0x21e),console[_0x1a9d53(0x238)](_0x1a9d53(0x211));}async[a42_0x475af8(0x226)](_0x41c85c){const _0x3c841a=a42_0x475af8,{orderId:_0xdc1a65,orderName:_0x294a59,amount:_0x591f30,currency:_0x2cc5ff,usage:_0x254694,maxPayments:_0x37f598,successUrl:_0x92bb72,failUrl:_0x217e81}=_0x41c85c,_0x293a58=_0x2cc5ff[_0x3c841a(0x1e8)](),_0x269085='GB';console['log'](_0x3c841a(0x23f));const _0x556058=_0x3c841a(0x239)+_0xdc1a65,_0x386628=_0x3c841a(0x1ff)+_0xdc1a65,_0x2c5706={'amount':_0x591f30,'cancel_checkout_url':_0x386628,'complete_checkout_url':_0x556058,'complete_payment_url':_0x556058,'merchant_reference_id':_0xdc1a65,'description':_0x3c841a(0x235)+_0xdc1a65,'payment_method_types_include':[_0x3c841a(0x23d),_0x3c841a(0x1eb)],'custom_elements':{'display_description':!![]}},_0x1ef9ea=Date[_0x3c841a(0x1e7)]();try{console[_0x3c841a(0x238)](_0x3c841a(0x22e)),console[_0x3c841a(0x238)](_0x3c841a(0x225),this[_0x3c841a(0x227)]),console[_0x3c841a(0x238)](_0x3c841a(0x201),JSON[_0x3c841a(0x1f3)](_0x2c5706,null,0x2)),console['log']('üá¨üáß\x20Country:\x20'+_0x269085+_0x3c841a(0x219)),console['log'](_0x3c841a(0x1f7)),loggerService_1[_0x3c841a(0x232)][_0x3c841a(0x205)]('rapyd',_0x3c841a(0x23b),_0x3c841a(0x1f9),_0x2c5706);const _0x3198bd=await fetch(this['apiUrl'],{'method':_0x3c841a(0x1f9),'headers':{'Content-Type':'application/json','User-Agent':_0x3c841a(0x21c)},'body':JSON[_0x3c841a(0x1f3)](_0x2c5706)}),_0x11cf6a=Date[_0x3c841a(0x1e7)]()-_0x1ef9ea;console['log']('===\x20RAPYD\x20API\x20RESPONSE\x20(White\x20Domain)\x20==='),console[_0x3c841a(0x238)]('Status:',_0x3198bd[_0x3c841a(0x215)]),console[_0x3c841a(0x238)](_0x3c841a(0x221),_0x3198bd[_0x3c841a(0x236)]),console[_0x3c841a(0x238)](_0x3c841a(0x220),Object[_0x3c841a(0x23e)](_0x3198bd[_0x3c841a(0x213)][_0x3c841a(0x1ea)]())),console[_0x3c841a(0x238)](_0x3c841a(0x1ec),_0x11cf6a+'ms');const _0x1fae97=await _0x3198bd['text']();console[_0x3c841a(0x238)](_0x3c841a(0x217),_0x1fae97);if(!_0x3198bd['ok']){console[_0x3c841a(0x1ef)]('===\x20RAPYD\x20API\x20ERROR\x20==='),console[_0x3c841a(0x1ef)](_0x3c841a(0x20e),_0x3198bd[_0x3c841a(0x215)]),console[_0x3c841a(0x1ef)](_0x3c841a(0x20d),_0x1fae97),loggerService_1[_0x3c841a(0x232)][_0x3c841a(0x200)](_0x3c841a(0x1e4),'/v1/hosted/payment_links',_0x3198bd['status'],_0x1fae97,_0x11cf6a),loggerService_1['loggerService'][_0x3c841a(0x1f8)](_0x3c841a(0x1e4),_0x3c841a(0x23b),_0x3c841a(0x224)+_0x3198bd[_0x3c841a(0x215)]+':\x20'+_0x1fae97);throw new Error(_0x3c841a(0x207)+_0x3198bd['status']+',\x20body:\x20'+_0x1fae97);}let _0x2b5385;try{_0x2b5385=JSON[_0x3c841a(0x21f)](_0x1fae97);}catch(_0x385cac){console[_0x3c841a(0x1ef)]('Failed\x20to\x20parse\x20JSON\x20response:',_0x385cac),loggerService_1[_0x3c841a(0x232)][_0x3c841a(0x1f8)](_0x3c841a(0x1e4),_0x3c841a(0x23b),_0x3c841a(0x1fc)+_0x385cac);throw new Error('Invalid\x20JSON\x20response\x20from\x20Rapyd\x20API:\x20'+_0x1fae97);}console[_0x3c841a(0x238)]('===\x20PARSED\x20RAPYD\x20RESPONSE\x20==='),console[_0x3c841a(0x238)](_0x3c841a(0x21d),JSON[_0x3c841a(0x1f3)](_0x2b5385,null,0x2)),loggerService_1[_0x3c841a(0x232)]['logWhiteDomainResponse']('rapyd',_0x3c841a(0x23b),_0x3198bd[_0x3c841a(0x215)],_0x2b5385,_0x11cf6a);if(_0x2b5385[_0x3c841a(0x215)]?.['status']!==_0x3c841a(0x243)){const _0x1f1398=_0x2b5385[_0x3c841a(0x215)]?.[_0x3c841a(0x1e2)]||_0x3c841a(0x209),_0x1ddde6=_0x2b5385[_0x3c841a(0x215)]?.['error_code']||'UNKNOWN';console[_0x3c841a(0x1ef)]('===\x20RAPYD\x20API\x20BUSINESS\x20ERROR\x20==='),console[_0x3c841a(0x1ef)]('Error\x20Code:',_0x1ddde6),console[_0x3c841a(0x1ef)](_0x3c841a(0x22c),_0x1f1398),console[_0x3c841a(0x1ef)](_0x3c841a(0x1e3),_0x2b5385['status']),loggerService_1[_0x3c841a(0x232)][_0x3c841a(0x1f8)](_0x3c841a(0x1e4),_0x3c841a(0x23b),_0x3c841a(0x21b)+_0x1ddde6+_0x3c841a(0x246)+_0x1f1398);throw new Error(_0x3c841a(0x242)+_0x1ddde6+_0x3c841a(0x246)+_0x1f1398);}if(!_0x2b5385[_0x3c841a(0x1fd)]?.['id']||!_0x2b5385[_0x3c841a(0x1fd)]?.[_0x3c841a(0x1ed)]){console[_0x3c841a(0x1ef)]('===\x20RAPYD\x20API\x20INCOMPLETE\x20RESPONSE\x20==='),console[_0x3c841a(0x1ef)](_0x3c841a(0x1fa)),console[_0x3c841a(0x1ef)](_0x3c841a(0x22f),_0x2b5385[_0x3c841a(0x1fd)]),loggerService_1[_0x3c841a(0x232)][_0x3c841a(0x1f8)](_0x3c841a(0x1e4),_0x3c841a(0x23b),_0x3c841a(0x233));throw new Error(_0x3c841a(0x20c));}return console[_0x3c841a(0x238)](_0x3c841a(0x248)),console[_0x3c841a(0x238)]('Payment\x20Link\x20ID:',_0x2b5385[_0x3c841a(0x1fd)]['id']),console[_0x3c841a(0x238)]('Redirect\x20URL:',_0x2b5385[_0x3c841a(0x1fd)]['redirect_url']),console[_0x3c841a(0x238)]('üá¨üáß\x20Country\x20used:\x20'+_0x269085+_0x3c841a(0x20b)),console['log'](_0x3c841a(0x1f7)),{'gateway_payment_id':_0x2b5385[_0x3c841a(0x1fd)]['id'],'payment_url':_0x2b5385[_0x3c841a(0x1fd)][_0x3c841a(0x1ed)]};}catch(_0xa12af0){console[_0x3c841a(0x1ef)](_0x3c841a(0x206)),console[_0x3c841a(0x1ef)](_0x3c841a(0x22b),_0xa12af0),loggerService_1[_0x3c841a(0x232)][_0x3c841a(0x1f8)](_0x3c841a(0x1e4),_0x3c841a(0x23b),_0xa12af0);if(_0xa12af0 instanceof Error){console[_0x3c841a(0x1ef)]('Error\x20message:',_0xa12af0[_0x3c841a(0x1e2)]),console[_0x3c841a(0x1ef)](_0x3c841a(0x1f2),_0xa12af0[_0x3c841a(0x1ee)]);throw new Error(_0x3c841a(0x1fb)+_0xa12af0[_0x3c841a(0x1e2)]);}throw new Error(_0x3c841a(0x245));}}async['verifyPayment'](_0x212035){const _0x32687b=a42_0x475af8,_0x4cf9a9=Date['now']();try{loggerService_1['loggerService'][_0x32687b(0x205)](_0x32687b(0x1e4),_0x32687b(0x20a)+_0x212035,_0x32687b(0x204),{});const _0x146207=await fetch(this['apiUrl']+'/'+_0x212035,{'method':_0x32687b(0x204),'headers':{'Content-Type':_0x32687b(0x1fe),'User-Agent':_0x32687b(0x21c)}}),_0x51052b=Date['now']()-_0x4cf9a9;if(!_0x146207['ok']){const _0x2c940e=await _0x146207[_0x32687b(0x223)]();loggerService_1['loggerService'][_0x32687b(0x200)](_0x32687b(0x1e4),_0x32687b(0x20a)+_0x212035,_0x146207['status'],_0x2c940e,_0x51052b);throw new Error(_0x32687b(0x207)+_0x146207['status']);}const _0x1a272d=await _0x146207[_0x32687b(0x1f6)]();loggerService_1[_0x32687b(0x232)][_0x32687b(0x200)](_0x32687b(0x1e4),_0x32687b(0x20a)+_0x212035,_0x146207[_0x32687b(0x215)],_0x1a272d,_0x51052b);if(_0x1a272d[_0x32687b(0x215)]?.['status']!==_0x32687b(0x243)){loggerService_1[_0x32687b(0x232)][_0x32687b(0x1f8)](_0x32687b(0x1e4),_0x32687b(0x20a)+_0x212035,_0x32687b(0x1e6)+(_0x1a272d[_0x32687b(0x215)]?.['message']||'Unknown\x20error'));throw new Error('Rapyd\x20API\x20error:\x20'+(_0x1a272d[_0x32687b(0x215)]?.['message']||'Unknown\x20error'));}let _0xa3a5e9='PENDING';if(_0x1a272d['data']?.[_0x32687b(0x215)])switch(_0x1a272d['data'][_0x32687b(0x215)][_0x32687b(0x1e8)]()){case _0x32687b(0x240):_0xa3a5e9=_0x32687b(0x244);break;case'CAN':_0xa3a5e9=_0x32687b(0x241);break;case _0x32687b(0x23c):_0xa3a5e9=_0x32687b(0x212);break;case _0x32687b(0x230):_0xa3a5e9=_0x32687b(0x241);break;case'NEW':case'ACT':default:_0xa3a5e9=_0x32687b(0x214);break;}return{'status':_0xa3a5e9,'amount':_0x1a272d[_0x32687b(0x1fd)]?.[_0x32687b(0x231)],'currency':_0x1a272d['data']?.[_0x32687b(0x216)]};}catch(_0x38c8dd){console[_0x32687b(0x1ef)]('Rapyd\x20payment\x20verification\x20error:',_0x38c8dd),loggerService_1[_0x32687b(0x232)]['logWhiteDomainError'](_0x32687b(0x1e4),_0x32687b(0x20a)+_0x212035,_0x38c8dd);throw new Error(_0x32687b(0x229)+(_0x38c8dd instanceof Error?_0x38c8dd[_0x32687b(0x1e2)]:_0x32687b(0x1e5)));}}async[a42_0x475af8(0x21a)](_0x21b90e){const _0x287c98=a42_0x475af8;console[_0x287c98(0x238)]('Processing\x20Rapyd\x20webhook:',_0x21b90e);let _0x2c15ff='PENDING';switch(_0x21b90e['type']?.['toUpperCase']()){case _0x287c98(0x20f):_0x21b90e[_0x287c98(0x1fd)]?.[_0x287c98(0x1e1)]===!![]&&_0x21b90e[_0x287c98(0x1fd)]?.[_0x287c98(0x215)]===_0x287c98(0x240)?_0x2c15ff=_0x287c98(0x244):_0x2c15ff=_0x287c98(0x214);break;case'PAYMENT_CANCELED':_0x2c15ff=_0x287c98(0x241);break;case _0x287c98(0x237):_0x2c15ff=_0x287c98(0x212);break;case'PAYMENT_FAILED':_0x2c15ff='FAILED';break;default:switch(_0x21b90e[_0x287c98(0x1fd)]?.['status']?.['toUpperCase']()){case _0x287c98(0x240):_0x21b90e[_0x287c98(0x1fd)]?.[_0x287c98(0x1e1)]===!![]?_0x2c15ff='PAID':_0x2c15ff='FAILED';break;case'CAN':_0x2c15ff=_0x287c98(0x241);break;case'EXP':_0x2c15ff=_0x287c98(0x212);break;case'ERR':_0x2c15ff=_0x287c98(0x241);break;case _0x287c98(0x247):case _0x287c98(0x1f0):default:_0x2c15ff=_0x287c98(0x214);break;}break;}return{'paymentId':_0x21b90e[_0x287c98(0x1fd)]?.['merchant_reference_id']||'','status':_0x2c15ff,'amount':_0x21b90e[_0x287c98(0x1fd)]?.[_0x287c98(0x231)],'currency':_0x21b90e[_0x287c98(0x1fd)]?.[_0x287c98(0x216)]};}}exports[a42_0x475af8(0x228)]=RapydService;