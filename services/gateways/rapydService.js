'use strict';const a45_0x5d2221=a45_0x42aa;(function(_0xf15d97,_0x3cdc71){const _0x348a46=a45_0x42aa,_0x3a455a=_0xf15d97();while(!![]){try{const _0x22f039=parseInt(_0x348a46(0x1a7))/0x1*(parseInt(_0x348a46(0x166))/0x2)+-parseInt(_0x348a46(0x172))/0x3+parseInt(_0x348a46(0x1a1))/0x4*(parseInt(_0x348a46(0x1a5))/0x5)+-parseInt(_0x348a46(0x174))/0x6+parseInt(_0x348a46(0x14f))/0x7*(parseInt(_0x348a46(0x1ad))/0x8)+parseInt(_0x348a46(0x1a8))/0x9+parseInt(_0x348a46(0x150))/0xa;if(_0x22f039===_0x3cdc71)break;else _0x3a455a['push'](_0x3a455a['shift']());}catch(_0xaef47e){_0x3a455a['push'](_0x3a455a['shift']());}}}(a45_0x5ce1,0x683bb));function a45_0x42aa(_0x400423,_0x5e011f){const _0x5ce1b2=a45_0x5ce1();return a45_0x42aa=function(_0x42aa3a,_0x5c387f){_0x42aa3a=_0x42aa3a-0x13b;let _0x1aa166=_0x5ce1b2[_0x42aa3a];return _0x1aa166;},a45_0x42aa(_0x400423,_0x5e011f);}function a45_0x5ce1(){const _0x305105=['553ynUMwA','6594670VquZlG','Request\x20Body\x20(Updated\x20Format):','Rapyd\x20API\x20error\x20(','URL:',',\x20body:\x20','Failed\x20to\x20verify\x20Rapyd\x20payment:\x20','ACT','Parsed\x20Result:','/v1/hosted/payment_links','üîÑ\x20Rapyd\x20webhook\x20processed:\x20status=','JSON\x20Parse\x20Error:\x20','Error\x20Message:','text','PAID','Payment\x20Link\x20ID:','üåê\x20Rapyd\x20service\x20initialized\x20with\x20white\x20domain\x20proxy','PAYMENT_COMPLETED','Processing\x20Rapyd\x20webhook:','failureCode','payment_method_type','Response\x20data:','statusText','13882yryWpf','FAILED','üí≥\x20Payment\x20Methods:\x20gb_visa_card,\x20gb_mastercard_card',',\x20failureMessage=','PAYMENT_CANCELED','ERR','RapydService','HTTP\x20error!\x20status:\x20','defineProperty','application/json','logWhiteDomainResponse','logWhiteDomainError','2025585CabPiS','Error\x20Code:','3892620FDLNwJ','../loggerService','type','status','Failed\x20to\x20parse\x20JSON\x20response:','CLO','/v1/hosted/payment_links/','===\x20RAPYD\x20SUCCESS\x20===','Rapyd\x20payment\x20verification\x20error:','üí•\x20Rapyd\x20failure\x20message:\x20','CAN','https://tesoft.uk/gateway/rapyd/','apiUrl','Unknown\x20error\x20from\x20Rapyd\x20API','Unknown\x20error','verifyPayment','stack','redirect_url','POST','Response\x20Body:','SUCCESS','logWhiteDomainRequest','ORDER:\x20','Status\x20Text:','PAYMENT_EXPIRED','payment_method_data','last4','Error\x20details:','Invalid\x20JSON\x20response\x20from\x20Rapyd\x20API:\x20','EXP','\x20(GB\x20-\x20Britain)','message','none','===\x20RAPYD\x20API\x20ERROR\x20===','error','paymentMethod','Missing\x20id\x20or\x20redirect_url\x20in\x20response','error_code','Rapyd\x20API\x20error:\x20','UNKNOWN','GET','Invalid\x20response\x20from\x20Rapyd\x20API:\x20missing\x20id\x20or\x20redirect_url','\x20(always\x20GB\x20for\x20Rapyd)','currency','HTTP\x20','1100908cMuVNs','PENDING','https://tesoft.uk/gateway/success.php?id=','gb_mastercard_card','5CnfqDT','üá¨üáß\x20Country\x20used:\x20','4ppRgDt','7086771rYlzUm','üá¨üáß\x20Country:\x20','===\x20RAPYD\x20API\x20INCOMPLETE\x20RESPONSE\x20===','Status:','Error\x20message:','104CCGjsS','rapyd','data','===\x20RAPYD\x20SERVICE\x20ERROR\x20===','EXPIRED','Failed\x20to\x20create\x20Rapyd\x20payment\x20link:\x20','===\x20RAPYD\x20API\x20RESPONSE\x20(White\x20Domain)\x20===','amount','failure_code','failure_message','createPaymentLink','toUpperCase','Redirect\x20URL:','Incomplete\x20response:\x20missing\x20id\x20or\x20redirect_url','Headers:','===\x20RAPYD\x20API\x20BUSINESS\x20ERROR\x20===','):\x20','Failed\x20to\x20create\x20Rapyd\x20payment\x20link:\x20Unknown\x20error','PAYMENT_FAILED','loggerService','===\x20PARSED\x20RAPYD\x20RESPONSE\x20===','log','processWebhook','Error\x20stack:','TesSoft\x20Payment\x20System/1.0','now','üá¨üáß\x20Using\x20GB\x20(Britain)\x20as\x20country\x20for\x20Rapyd\x20payment\x20link','parse','HTTP\x20Status:'];a45_0x5ce1=function(){return _0x305105;};return a45_0x5ce1();}Object[a45_0x5d2221(0x16e)](exports,'__esModule',{'value':!![]}),exports[a45_0x5d2221(0x16c)]=void 0x0;const loggerService_1=require(a45_0x5d2221(0x175));class RapydService{constructor(){const _0x4644b4=a45_0x5d2221;this[_0x4644b4(0x180)]=_0x4644b4(0x17f),console[_0x4644b4(0x147)](_0x4644b4(0x15f));}async[a45_0x5d2221(0x13c)](_0x3ee64a){const _0x3f04a5=a45_0x5d2221,{orderId:_0x71c33e,orderName:_0x4411de,amount:_0x4bb343,currency:_0x32f68f,usage:_0x131497,maxPayments:_0xca5056,successUrl:_0x438c7f,failUrl:_0x3c777}=_0x3ee64a,_0x5af031=_0x32f68f[_0x3f04a5(0x13d)](),_0xa69a3b='GB';console['log'](_0x3f04a5(0x14c));const _0x2036d3=_0x3f04a5(0x1a3)+_0x71c33e,_0x55d4b6='https://tesoft.uk/gateway/fail.php?id='+_0x71c33e,_0x2c7744={'amount':_0x4bb343,'currency':_0x5af031,'cancel_checkout_url':_0x55d4b6,'complete_checkout_url':_0x2036d3,'complete_payment_url':_0x2036d3,'merchant_reference_id':_0x71c33e,'description':_0x3f04a5(0x18a)+_0x71c33e,'country':'GB','payment_method_types_include':['gb_visa_card',_0x3f04a5(0x1a4)],'custom_elements':{'display_description':!![]}},_0x30a526=Date[_0x3f04a5(0x14b)]();try{console['log']('===\x20RAPYD\x20API\x20REQUEST\x20(White\x20Domain\x20-\x20Updated\x20Format)\x20==='),console[_0x3f04a5(0x147)](_0x3f04a5(0x153),this[_0x3f04a5(0x180)]),console['log'](_0x3f04a5(0x151),JSON['stringify'](_0x2c7744,null,0x2)),console[_0x3f04a5(0x147)](_0x3f04a5(0x1a9)+_0xa69a3b+_0x3f04a5(0x19e)),console[_0x3f04a5(0x147)](_0x3f04a5(0x168)),loggerService_1[_0x3f04a5(0x145)][_0x3f04a5(0x189)]('rapyd',_0x3f04a5(0x158),_0x3f04a5(0x186),_0x2c7744);const _0x5213c3=await fetch(this['apiUrl'],{'method':_0x3f04a5(0x186),'headers':{'Content-Type':'application/json','User-Agent':_0x3f04a5(0x14a)},'body':JSON['stringify'](_0x2c7744)}),_0x435b38=Date[_0x3f04a5(0x14b)]()-_0x30a526;console[_0x3f04a5(0x147)](_0x3f04a5(0x1b3)),console[_0x3f04a5(0x147)](_0x3f04a5(0x1ab),_0x5213c3[_0x3f04a5(0x177)]),console['log'](_0x3f04a5(0x18b),_0x5213c3[_0x3f04a5(0x165)]),console[_0x3f04a5(0x147)](_0x3f04a5(0x140),Object['fromEntries'](_0x5213c3['headers']['entries']())),console[_0x3f04a5(0x147)]('Response\x20Time:',_0x435b38+'ms');const _0x42bb1f=await _0x5213c3['text']();console['log']('Raw\x20Response\x20Body:',_0x42bb1f);if(!_0x5213c3['ok']){console['error'](_0x3f04a5(0x195)),console['error'](_0x3f04a5(0x14e),_0x5213c3['status']),console['error'](_0x3f04a5(0x187),_0x42bb1f),loggerService_1[_0x3f04a5(0x145)][_0x3f04a5(0x170)]('rapyd',_0x3f04a5(0x158),_0x5213c3[_0x3f04a5(0x177)],_0x42bb1f,_0x435b38),loggerService_1['loggerService'][_0x3f04a5(0x171)](_0x3f04a5(0x1ae),_0x3f04a5(0x158),_0x3f04a5(0x1a0)+_0x5213c3['status']+':\x20'+_0x42bb1f);throw new Error('HTTP\x20error!\x20status:\x20'+_0x5213c3[_0x3f04a5(0x177)]+_0x3f04a5(0x154)+_0x42bb1f);}let _0x5c46ca;try{_0x5c46ca=JSON[_0x3f04a5(0x14d)](_0x42bb1f);}catch(_0x20e700){console[_0x3f04a5(0x196)](_0x3f04a5(0x178),_0x20e700),loggerService_1[_0x3f04a5(0x145)][_0x3f04a5(0x171)](_0x3f04a5(0x1ae),_0x3f04a5(0x158),_0x3f04a5(0x15a)+_0x20e700);throw new Error(_0x3f04a5(0x190)+_0x42bb1f);}console['log'](_0x3f04a5(0x146)),console[_0x3f04a5(0x147)](_0x3f04a5(0x157),JSON['stringify'](_0x5c46ca,null,0x2)),loggerService_1[_0x3f04a5(0x145)][_0x3f04a5(0x170)](_0x3f04a5(0x1ae),_0x3f04a5(0x158),_0x5213c3[_0x3f04a5(0x177)],_0x5c46ca,_0x435b38);if(_0x5c46ca[_0x3f04a5(0x177)]?.['status']!==_0x3f04a5(0x188)){const _0x482bf1=_0x5c46ca['status']?.[_0x3f04a5(0x193)]||_0x3f04a5(0x181),_0x2f4e2f=_0x5c46ca[_0x3f04a5(0x177)]?.[_0x3f04a5(0x199)]||_0x3f04a5(0x19b);console[_0x3f04a5(0x196)](_0x3f04a5(0x141)),console[_0x3f04a5(0x196)](_0x3f04a5(0x173),_0x2f4e2f),console[_0x3f04a5(0x196)](_0x3f04a5(0x15b),_0x482bf1),console[_0x3f04a5(0x196)]('Full\x20Error\x20Data:',_0x5c46ca['status']),loggerService_1[_0x3f04a5(0x145)][_0x3f04a5(0x171)]('rapyd',_0x3f04a5(0x158),'Business\x20Error\x20('+_0x2f4e2f+_0x3f04a5(0x142)+_0x482bf1);throw new Error(_0x3f04a5(0x152)+_0x2f4e2f+'):\x20'+_0x482bf1);}if(!_0x5c46ca[_0x3f04a5(0x1af)]?.['id']||!_0x5c46ca[_0x3f04a5(0x1af)]?.[_0x3f04a5(0x185)]){console[_0x3f04a5(0x196)](_0x3f04a5(0x1aa)),console['error'](_0x3f04a5(0x198)),console[_0x3f04a5(0x196)](_0x3f04a5(0x164),_0x5c46ca[_0x3f04a5(0x1af)]),loggerService_1[_0x3f04a5(0x145)][_0x3f04a5(0x171)](_0x3f04a5(0x1ae),'/v1/hosted/payment_links',_0x3f04a5(0x13f));throw new Error(_0x3f04a5(0x19d));}return console[_0x3f04a5(0x147)](_0x3f04a5(0x17b)),console[_0x3f04a5(0x147)](_0x3f04a5(0x15e),_0x5c46ca['data']['id']),console[_0x3f04a5(0x147)](_0x3f04a5(0x13e),_0x5c46ca['data'][_0x3f04a5(0x185)]),console[_0x3f04a5(0x147)](_0x3f04a5(0x1a6)+_0xa69a3b+_0x3f04a5(0x192)),console[_0x3f04a5(0x147)](_0x3f04a5(0x168)),{'gateway_payment_id':_0x5c46ca['data']['id'],'payment_url':_0x5c46ca[_0x3f04a5(0x1af)][_0x3f04a5(0x185)]};}catch(_0x3a3b1c){console['error'](_0x3f04a5(0x1b0)),console['error'](_0x3f04a5(0x18f),_0x3a3b1c),loggerService_1[_0x3f04a5(0x145)][_0x3f04a5(0x171)](_0x3f04a5(0x1ae),'/v1/hosted/payment_links',_0x3a3b1c);if(_0x3a3b1c instanceof Error){console['error'](_0x3f04a5(0x1ac),_0x3a3b1c[_0x3f04a5(0x193)]),console[_0x3f04a5(0x196)](_0x3f04a5(0x149),_0x3a3b1c[_0x3f04a5(0x184)]);throw new Error(_0x3f04a5(0x1b2)+_0x3a3b1c[_0x3f04a5(0x193)]);}throw new Error(_0x3f04a5(0x143));}}async[a45_0x5d2221(0x183)](_0x7709fa){const _0x3190bb=a45_0x5d2221,_0xda4f9c=Date['now']();try{loggerService_1['loggerService']['logWhiteDomainRequest'](_0x3190bb(0x1ae),_0x3190bb(0x17a)+_0x7709fa,_0x3190bb(0x19c),{});const _0x18f532=await fetch(this[_0x3190bb(0x180)]+'/'+_0x7709fa,{'method':'GET','headers':{'Content-Type':_0x3190bb(0x16f),'User-Agent':_0x3190bb(0x14a)}}),_0x38f364=Date[_0x3190bb(0x14b)]()-_0xda4f9c;if(!_0x18f532['ok']){const _0x5346e8=await _0x18f532[_0x3190bb(0x15c)]();loggerService_1[_0x3190bb(0x145)][_0x3190bb(0x170)](_0x3190bb(0x1ae),_0x3190bb(0x17a)+_0x7709fa,_0x18f532[_0x3190bb(0x177)],_0x5346e8,_0x38f364);throw new Error(_0x3190bb(0x16d)+_0x18f532[_0x3190bb(0x177)]);}const _0x430227=await _0x18f532['json']();loggerService_1[_0x3190bb(0x145)]['logWhiteDomainResponse'](_0x3190bb(0x1ae),'/v1/hosted/payment_links/'+_0x7709fa,_0x18f532[_0x3190bb(0x177)],_0x430227,_0x38f364);if(_0x430227[_0x3190bb(0x177)]?.['status']!==_0x3190bb(0x188)){loggerService_1[_0x3190bb(0x145)][_0x3190bb(0x171)](_0x3190bb(0x1ae),_0x3190bb(0x17a)+_0x7709fa,'Rapyd\x20API\x20error:\x20'+(_0x430227['status']?.['message']||_0x3190bb(0x182)));throw new Error(_0x3190bb(0x19a)+(_0x430227['status']?.['message']||_0x3190bb(0x182)));}let _0x51e9a0=_0x3190bb(0x1a2);if(_0x430227['data']?.[_0x3190bb(0x177)])switch(_0x430227[_0x3190bb(0x1af)][_0x3190bb(0x177)][_0x3190bb(0x13d)]()){case'CLO':_0x51e9a0=_0x3190bb(0x15d);break;case _0x3190bb(0x17e):_0x51e9a0=_0x3190bb(0x167);break;case _0x3190bb(0x191):_0x51e9a0=_0x3190bb(0x1b1);break;case _0x3190bb(0x16b):_0x51e9a0='FAILED';break;case'NEW':case _0x3190bb(0x156):default:_0x51e9a0='PENDING';break;}return{'status':_0x51e9a0,'amount':_0x430227[_0x3190bb(0x1af)]?.[_0x3190bb(0x1b4)],'currency':_0x430227[_0x3190bb(0x1af)]?.['currency']};}catch(_0x533a34){console[_0x3190bb(0x196)](_0x3190bb(0x17c),_0x533a34),loggerService_1[_0x3190bb(0x145)][_0x3190bb(0x171)](_0x3190bb(0x1ae),_0x3190bb(0x17a)+_0x7709fa,_0x533a34);throw new Error(_0x3190bb(0x155)+(_0x533a34 instanceof Error?_0x533a34[_0x3190bb(0x193)]:_0x3190bb(0x182)));}}async[a45_0x5d2221(0x148)](_0x30561a){const _0x98d5b3=a45_0x5d2221;console[_0x98d5b3(0x147)](_0x98d5b3(0x161),_0x30561a);let _0x564c39=_0x98d5b3(0x1a2),_0x2d23a0;_0x30561a[_0x98d5b3(0x1af)]?.[_0x98d5b3(0x13b)]&&(_0x2d23a0=_0x30561a[_0x98d5b3(0x1af)][_0x98d5b3(0x13b)],console['log'](_0x98d5b3(0x17d)+_0x2d23a0));switch(_0x30561a[_0x98d5b3(0x176)]?.[_0x98d5b3(0x13d)]()){case _0x98d5b3(0x160):_0x30561a[_0x98d5b3(0x1af)]?.['paid']===!![]&&_0x30561a['data']?.[_0x98d5b3(0x177)]===_0x98d5b3(0x179)?_0x564c39=_0x98d5b3(0x15d):_0x564c39=_0x98d5b3(0x1a2);break;case _0x98d5b3(0x16a):_0x564c39=_0x98d5b3(0x167);break;case _0x98d5b3(0x18c):_0x564c39=_0x98d5b3(0x1b1);break;case _0x98d5b3(0x144):_0x564c39=_0x98d5b3(0x167);!_0x2d23a0&&_0x30561a['data']?.[_0x98d5b3(0x13b)]&&(_0x2d23a0=_0x30561a[_0x98d5b3(0x1af)][_0x98d5b3(0x13b)]);break;default:switch(_0x30561a['data']?.[_0x98d5b3(0x177)]?.['toUpperCase']()){case'CLO':_0x30561a[_0x98d5b3(0x1af)]?.['paid']===!![]?_0x564c39=_0x98d5b3(0x15d):_0x564c39=_0x98d5b3(0x167);break;case _0x98d5b3(0x17e):_0x564c39=_0x98d5b3(0x167);break;case _0x98d5b3(0x191):_0x564c39=_0x98d5b3(0x1b1);break;case _0x98d5b3(0x16b):_0x564c39=_0x98d5b3(0x167);!_0x2d23a0&&_0x30561a['data']?.[_0x98d5b3(0x13b)]&&(_0x2d23a0=_0x30561a[_0x98d5b3(0x1af)][_0x98d5b3(0x13b)]);break;case'NEW':case _0x98d5b3(0x156):default:_0x564c39='PENDING';break;}break;}const _0x128cc4={};return _0x30561a[_0x98d5b3(0x1af)]?.[_0x98d5b3(0x18d)]?.[_0x98d5b3(0x18e)]&&(_0x128cc4['cardLast4']=_0x30561a['data'][_0x98d5b3(0x18d)][_0x98d5b3(0x18e)]),_0x30561a['data']?.[_0x98d5b3(0x163)]&&(_0x128cc4[_0x98d5b3(0x197)]=_0x30561a[_0x98d5b3(0x1af)][_0x98d5b3(0x163)]),_0x30561a[_0x98d5b3(0x1af)]?.['error_code']&&(_0x128cc4['errorCode']=_0x30561a[_0x98d5b3(0x1af)]['error_code']),_0x30561a[_0x98d5b3(0x1af)]?.['failure_code']&&(_0x128cc4[_0x98d5b3(0x162)]=_0x30561a[_0x98d5b3(0x1af)][_0x98d5b3(0x1b5)]),console[_0x98d5b3(0x147)](_0x98d5b3(0x159)+_0x564c39+_0x98d5b3(0x169)+(_0x2d23a0||_0x98d5b3(0x194))),{'paymentId':_0x30561a[_0x98d5b3(0x1af)]?.['merchant_reference_id']||'','status':_0x564c39,'amount':_0x30561a[_0x98d5b3(0x1af)]?.[_0x98d5b3(0x1b4)],'currency':_0x30561a[_0x98d5b3(0x1af)]?.[_0x98d5b3(0x19f)],'failureMessage':_0x2d23a0,'additionalInfo':_0x128cc4};}}exports[a45_0x5d2221(0x16c)]=RapydService;