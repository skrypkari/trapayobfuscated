'use strict';const a44_0x3c5eab=a44_0x80be;(function(_0x47e5e1,_0x421df8){const _0x43187d=a44_0x80be,_0x20e8b9=_0x47e5e1();while(!![]){try{const _0x1cb00b=parseInt(_0x43187d(0x8a))/0x1+-parseInt(_0x43187d(0x93))/0x2+-parseInt(_0x43187d(0x82))/0x3*(-parseInt(_0x43187d(0x92))/0x4)+parseInt(_0x43187d(0xb9))/0x5+parseInt(_0x43187d(0x7e))/0x6+parseInt(_0x43187d(0xbf))/0x7*(-parseInt(_0x43187d(0x9e))/0x8)+parseInt(_0x43187d(0xa5))/0x9;if(_0x1cb00b===_0x421df8)break;else _0x20e8b9['push'](_0x20e8b9['shift']());}catch(_0x2497ff){_0x20e8b9['push'](_0x20e8b9['shift']());}}}(a44_0x2c62,0xcbf46));var __importDefault=this&&this[a44_0x3c5eab(0x91)]||function(_0x556ac3){return _0x556ac3&&_0x556ac3['__esModule']?_0x556ac3:{'default':_0x556ac3};};Object['defineProperty'](exports,a44_0x3c5eab(0xa7),{'value':!![]}),exports['loggerService']=exports['LoggerService']=void 0x0;const fs_1=__importDefault(require('fs')),path_1=__importDefault(require(a44_0x3c5eab(0x79)));class LoggerService{constructor(){const _0x12c664=a44_0x3c5eab;this[_0x12c664(0x7b)]=path_1[_0x12c664(0x84)]['join'](process['cwd'](),_0x12c664(0xb4)),this[_0x12c664(0xac)]();}['ensureLogsDirectory'](){const _0x2d1e02=a44_0x3c5eab;!fs_1[_0x2d1e02(0x84)][_0x2d1e02(0x98)](this[_0x2d1e02(0x7b)])&&(fs_1['default'][_0x2d1e02(0x90)](this[_0x2d1e02(0x7b)],{'recursive':!![]}),console[_0x2d1e02(0xc7)]('ðŸ“\x20Created\x20logs\x20directory:\x20'+this[_0x2d1e02(0x7b)]));}[a44_0x3c5eab(0x94)](_0x356227){const _0x50327c=a44_0x3c5eab,_0x46495e=new Date()['toISOString']()[_0x50327c(0x86)]('T')[0x0];return path_1['default'][_0x50327c(0xc4)](this['logsDir'],_0x356227+'_'+_0x46495e+_0x50327c(0xb6));}[a44_0x3c5eab(0x80)](_0x9dd640,_0x4da149){const _0x481356=a44_0x3c5eab;try{const _0x4ceea2=new Date()['toISOString'](),_0x1677ae={'timestamp':_0x4ceea2,..._0x4da149},_0x206347=JSON[_0x481356(0x83)](_0x1677ae)+'\x0a',_0x42f210=this['getLogFileName'](_0x9dd640);fs_1['default']['appendFileSync'](_0x42f210,_0x206347,_0x481356(0x8d));}catch(_0x1c91a5){console[_0x481356(0xaf)](_0x481356(0xb5)+_0x9dd640+_0x481356(0xa4),_0x1c91a5);}}[a44_0x3c5eab(0x9b)](_0x54470b,_0x39494c,_0x6474b1,_0x48b165){const _0x52dac9=a44_0x3c5eab;this[_0x52dac9(0x80)]('white_domain_requests',{'type':_0x52dac9(0xa1),'gateway':_0x54470b,'endpoint':_0x39494c,'method':_0x6474b1,'data':_0x48b165});}[a44_0x3c5eab(0xb7)](_0x4699bc,_0xdcdc21,_0x258eca,_0x3c8df9,_0x2b4a47){const _0x3e6efb=a44_0x3c5eab;this['writeLog'](_0x3e6efb(0x7d),{'type':_0x3e6efb(0x97),'gateway':_0x4699bc,'endpoint':_0xdcdc21,'status':_0x258eca,'responseTime':_0x2b4a47,'data':_0x3c8df9});}['logWhiteDomainError'](_0x481b84,_0x401009,_0x5916c1){const _0x1f46cf=a44_0x3c5eab;this[_0x1f46cf(0x80)]('white_domain_errors',{'type':_0x1f46cf(0x8b),'gateway':_0x481b84,'endpoint':_0x401009,'error':_0x5916c1 instanceof Error?{'message':_0x5916c1[_0x1f46cf(0x85)],'stack':_0x5916c1[_0x1f46cf(0xc2)]}:_0x5916c1});}[a44_0x3c5eab(0x9a)](_0x431499,_0x123474,_0xec4fa3){const _0x22a809=a44_0x3c5eab;this[_0x22a809(0x80)](_0x22a809(0xae),{'type':_0x22a809(0xa8),'gateway':_0x431499,'headers':_0xec4fa3,'data':_0x123474});}[a44_0x3c5eab(0xa0)](_0x3eeb8e,_0xca49e2,_0x3476f2,_0x4bb634,_0x4aeedd){const _0x2b1f58=a44_0x3c5eab;this[_0x2b1f58(0x80)]('webhooks_processed',{'type':'WEBHOOK_PROCESSED','gateway':_0x3eeb8e,'paymentId':_0xca49e2,'oldStatus':_0x3476f2,'newStatus':_0x4bb634,'originalData':_0x4aeedd});}[a44_0x3c5eab(0x8c)](_0x25368c,_0x4ca86f,_0x3e2609){const _0x456daf=a44_0x3c5eab;this[_0x456daf(0x80)]('webhooks_errors',{'type':_0x456daf(0xad),'gateway':_0x25368c,'error':_0x4ca86f instanceof Error?{'message':_0x4ca86f[_0x456daf(0x85)],'stack':_0x4ca86f[_0x456daf(0xc2)]}:_0x4ca86f,'originalData':_0x3e2609});}[a44_0x3c5eab(0xbe)](_0x430163){const _0x8a36f8=a44_0x3c5eab;this[_0x8a36f8(0x80)]('cointopay_status_changes',{'type':'COINTOPAY_STATUS_CHANGE',..._0x430163});}['logCoinToPayError'](_0x5849ee){const _0xf5ef57=a44_0x3c5eab;this['writeLog'](_0xf5ef57(0xbb),{'type':'COINTOPAY_ERROR',..._0x5849ee});}[a44_0x3c5eab(0x9f)](_0x441511,_0x1ed683,_0x40df60,_0x4cbbbe,_0xcd3542,_0x4b0d40){const _0x5f0a97=a44_0x3c5eab;this[_0x5f0a97(0x80)](_0x5f0a97(0xaa),{'type':_0x5f0a97(0xbc),'shopId':_0x441511,'webhookUrl':_0x1ed683,'event':_0x40df60,'status':_0x4cbbbe,'responseTime':_0xcd3542,'payload':_0x4b0d40});}[a44_0x3c5eab(0x7f)](_0x1f7e4e,_0x48f9a2,_0xa8ea9e,_0x31f17c,_0xf45d49){const _0x148bd6=a44_0x3c5eab;this[_0x148bd6(0x80)](_0x148bd6(0xb2),{'type':'SHOP_WEBHOOK_ERROR','shopId':_0x1f7e4e,'webhookUrl':_0x48f9a2,'event':_0xa8ea9e,'error':_0x31f17c instanceof Error?{'message':_0x31f17c[_0x148bd6(0x85)],'stack':_0x31f17c['stack']}:_0x31f17c,'payload':_0xf45d49});}[a44_0x3c5eab(0xc6)](_0x102935,_0x34ec5,_0x6e3e76,_0x2556cc,_0x476ebf){const _0x37567f=a44_0x3c5eab;this[_0x37567f(0x80)](_0x37567f(0x95),{'type':_0x37567f(0xa2),'gateway':_0x102935,'paymentId':_0x34ec5,'shopId':_0x6e3e76,'amount':_0x2556cc,'currency':_0x476ebf});}[a44_0x3c5eab(0xa9)](_0x1e6b03,_0x43dcb3,_0xcd5569,_0x442074,_0xad5f5d){const _0x4123dc=a44_0x3c5eab;this[_0x4123dc(0x80)](_0x4123dc(0xa3),{'type':_0x4123dc(0x7c),'endpoint':_0x1e6b03,'method':_0x43dcb3,'userId':_0xcd5569,'userRole':_0x442074,'requestData':_0xad5f5d});}[a44_0x3c5eab(0x9c)](){const _0x1f04a7=a44_0x3c5eab;try{const _0x53fefb=fs_1[_0x1f04a7(0x84)][_0x1f04a7(0xb3)](this[_0x1f04a7(0x7b)]),_0x7debd1=_0x53fefb[_0x1f04a7(0x8f)](_0x1a7736=>_0x1a7736['endsWith'](_0x1f04a7(0xb6))),_0x5e106c=[...new Set(_0x7debd1[_0x1f04a7(0xb8)](_0x42626d=>_0x42626d[_0x1f04a7(0x86)]('_')[0x0]))],_0x469395=_0x7debd1[_0x1f04a7(0xb8)](_0x5acc15=>{const _0x598ea2=_0x1f04a7,_0x38c9e5=path_1[_0x598ea2(0x84)][_0x598ea2(0xc4)](this[_0x598ea2(0x7b)],_0x5acc15),_0x3c7657=fs_1[_0x598ea2(0x84)][_0x598ea2(0xc3)](_0x38c9e5),[_0x234ccc,_0x2bd3f2]=_0x5acc15[_0x598ea2(0x99)](_0x598ea2(0xb6),'')[_0x598ea2(0x86)]('_');return{'type':_0x234ccc,'date':_0x2bd3f2,'size':_0x3c7657['size']};})[_0x1f04a7(0x7a)]((_0x145c71,_0x4ca733)=>_0x4ca733['date'][_0x1f04a7(0x96)](_0x145c71[_0x1f04a7(0xb1)]));return{'totalFiles':_0x7debd1[_0x1f04a7(0xc1)],'logTypes':_0x5e106c,'latestLogs':_0x469395[_0x1f04a7(0xb0)](0x0,0xa)};}catch(_0x18ee80){return console[_0x1f04a7(0xaf)](_0x1f04a7(0xc8),_0x18ee80),{'totalFiles':0x0,'logTypes':[],'latestLogs':[]};}}[a44_0x3c5eab(0xbd)](_0x2c3f52=0x1e){const _0x511645=a44_0x3c5eab;try{const _0x433990=fs_1[_0x511645(0x84)][_0x511645(0xb3)](this['logsDir']),_0x36f8a8=new Date();_0x36f8a8[_0x511645(0x87)](_0x36f8a8[_0x511645(0xab)]()-_0x2c3f52);let _0x436301=0x0;_0x433990[_0x511645(0x9d)](_0x5f2583=>{const _0x448671=_0x511645;if(!_0x5f2583[_0x448671(0xba)](_0x448671(0xb6)))return;const _0x2277f9=path_1[_0x448671(0x84)]['join'](this[_0x448671(0x7b)],_0x5f2583),_0x4c0b0d=fs_1[_0x448671(0x84)][_0x448671(0xc3)](_0x2277f9);_0x4c0b0d[_0x448671(0x8e)]<_0x36f8a8&&(fs_1[_0x448671(0x84)][_0x448671(0xc5)](_0x2277f9),_0x436301++,console[_0x448671(0xc7)](_0x448671(0x89)+_0x5f2583));}),console[_0x511645(0xc7)](_0x511645(0x81)+_0x436301+_0x511645(0xc0)+_0x2c3f52+'\x20days)');}catch(_0x517607){console['error'](_0x511645(0xa6),_0x517607);}}}exports['LoggerService']=LoggerService,exports[a44_0x3c5eab(0x88)]=new LoggerService();function a44_0x80be(_0x4d89f4,_0x9f36ab){const _0x2c62a6=a44_0x2c62();return a44_0x80be=function(_0x80be5b,_0x2faba4){_0x80be5b=_0x80be5b-0x79;let _0x5e5751=_0x2c62a6[_0x80be5b];return _0x5e5751;},a44_0x80be(_0x4d89f4,_0x9f36ab);}function a44_0x2c62(){const _0x3462b1=['27DqTHLK','stringify','default','message','split','setDate','loggerService','ðŸ—‘ï¸\x20Deleted\x20old\x20log\x20file:\x20','286501SmyNsB','ERROR','logWebhookError','utf8','mtime','filter','mkdirSync','__importDefault','1156DPXRAx','463036CJjomF','getLogFileName','payments_created','localeCompare','RESPONSE','existsSync','replace','logWebhookReceived','logWhiteDomainRequest','getLogStats','forEach','856ZOZqVL','logShopWebhookSent','logWebhookProcessed','REQUEST','PAYMENT_CREATED','api_calls','\x20log:','10461231hFZIiJ','Failed\x20to\x20clean\x20old\x20logs:','__esModule','WEBHOOK_RECEIVED','logApiCall','shop_webhooks_sent','getDate','ensureLogsDirectory','WEBHOOK_ERROR','webhooks_received','error','slice','date','shop_webhooks_errors','readdirSync','logs','Failed\x20to\x20write\x20','.log','logWhiteDomainResponse','map','2356035desevc','endsWith','cointopay_errors','SHOP_WEBHOOK_SENT','cleanOldLogs','logCoinToPayStatus','101514UMnOKH','\x20old\x20log\x20files\x20(older\x20than\x20','length','stack','statSync','join','unlinkSync','logPaymentCreated','log','Failed\x20to\x20get\x20log\x20stats:','path','sort','logsDir','API_CALL','white_domain_responses','4175772yPLlSK','logShopWebhookError','writeLog','ðŸ§¹\x20Cleaned\x20'];a44_0x2c62=function(){return _0x3462b1;};return a44_0x2c62();}