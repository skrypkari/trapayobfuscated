'use strict';const a49_0x19dc90=a49_0x2c4f;(function(_0x475e7a,_0x5b5777){const _0x5dcf70=a49_0x2c4f,_0x4a8bdf=_0x475e7a();while(!![]){try{const _0x1d4524=parseInt(_0x5dcf70(0x1c7))/0x1*(-parseInt(_0x5dcf70(0x1d0))/0x2)+-parseInt(_0x5dcf70(0x1b9))/0x3+-parseInt(_0x5dcf70(0x1e0))/0x4+parseInt(_0x5dcf70(0x1a0))/0x5*(-parseInt(_0x5dcf70(0x1db))/0x6)+parseInt(_0x5dcf70(0x1f1))/0x7*(-parseInt(_0x5dcf70(0x1cc))/0x8)+parseInt(_0x5dcf70(0x1ef))/0x9*(parseInt(_0x5dcf70(0x1ce))/0xa)+-parseInt(_0x5dcf70(0x1da))/0xb*(-parseInt(_0x5dcf70(0x1f2))/0xc);if(_0x1d4524===_0x5b5777)break;else _0x4a8bdf['push'](_0x4a8bdf['shift']());}catch(_0x3131df){_0x4a8bdf['push'](_0x4a8bdf['shift']());}}}(a49_0x1e2a,0x591e6));function a49_0x2c4f(_0x22d774,_0x2d4087){const _0x1e2a15=a49_0x1e2a();return a49_0x2c4f=function(_0x2c4f7e,_0xb13085){_0x2c4f7e=_0x2c4f7e-0x19c;let _0x21782b=_0x1e2a15[_0x2c4f7e];return _0x21782b;},a49_0x2c4f(_0x22d774,_0x2d4087);}function a49_0x1e2a(){const _0x4715a5=['logWebhookProcessed','stringify','Failed\x20to\x20clean\x20old\x20logs:','logWebhookError','appendFileSync','WEBHOOK_ERROR','mtime','898185iZoMrr','COINTOPAY_STATUS_CHANGE','logsDir','getDate','logWhiteDomainError','slice','filter','📁\x20Created\x20logs\x20directory:\x20','cleanOldLogs','payments_created','webhooks_processed','loggerService','__esModule','toISOString','1zSybmx','🧹\x20Cleaned\x20','api_calls','default','shop_webhooks_sent','5442128HyStUn','white_domain_requests','2605190DroLtw','statSync','439870kmkhsn','replace','🗑️\x20Deleted\x20old\x20log\x20file:\x20','split','size','logApiCall','\x20log:','join','utf8','sort','862543CxPPEB','6hhbwXB','\x20old\x20log\x20files\x20(older\x20than\x20','cointopay_errors','writeLog','ensureLogsDirectory','1698388xxwfBx','logCoinToPayError','localeCompare','stack','COINTOPAY_ERROR','REQUEST','mkdirSync','logWhiteDomainRequest','webhooks_errors','cointopay_status_changes','endsWith','getLogFileName','WEBHOOK_PROCESSED','SHOP_WEBHOOK_SENT','.log','9qiLDGO','length','7oIpQNT','324LyoHXj','shop_webhooks_errors','PAYMENT_CREATED','error','Failed\x20to\x20write\x20','__importDefault','forEach','ERROR','date','1942235wBoKjv','path','LoggerService','message','\x20days)','setDate','log','readdirSync','white_domain_errors','getLogStats','RESPONSE','existsSync','logPaymentCreated','cwd','logCoinToPayStatus','logWhiteDomainResponse','webhooks_received','logs'];a49_0x1e2a=function(){return _0x4715a5;};return a49_0x1e2a();}var __importDefault=this&&this[a49_0x19dc90(0x19c)]||function(_0xb347){const _0x24450e=a49_0x19dc90;return _0xb347&&_0xb347[_0x24450e(0x1c5)]?_0xb347:{'default':_0xb347};};Object['defineProperty'](exports,'__esModule',{'value':!![]}),exports[a49_0x19dc90(0x1c4)]=exports['LoggerService']=void 0x0;const fs_1=__importDefault(require('fs')),path_1=__importDefault(require(a49_0x19dc90(0x1a1)));class LoggerService{constructor(){const _0x78b217=a49_0x19dc90;this[_0x78b217(0x1bb)]=path_1['default'][_0x78b217(0x1d7)](process[_0x78b217(0x1ad)](),_0x78b217(0x1b1)),this[_0x78b217(0x1df)]();}['ensureLogsDirectory'](){const _0x981378=a49_0x19dc90;!fs_1[_0x981378(0x1ca)][_0x981378(0x1ab)](this[_0x981378(0x1bb)])&&(fs_1['default'][_0x981378(0x1e6)](this[_0x981378(0x1bb)],{'recursive':!![]}),console[_0x981378(0x1a6)](_0x981378(0x1c0)+this[_0x981378(0x1bb)]));}[a49_0x19dc90(0x1eb)](_0x3c85b3){const _0x504d7c=a49_0x19dc90,_0x568177=new Date()['toISOString']()[_0x504d7c(0x1d3)]('T')[0x0];return path_1[_0x504d7c(0x1ca)][_0x504d7c(0x1d7)](this['logsDir'],_0x3c85b3+'_'+_0x568177+_0x504d7c(0x1ee));}[a49_0x19dc90(0x1de)](_0x4d7d97,_0x43a51e){const _0x2094a3=a49_0x19dc90;try{const _0xd9fcc2=new Date()[_0x2094a3(0x1c6)](),_0x5a4dd4={'timestamp':_0xd9fcc2,..._0x43a51e},_0x426b6f=JSON[_0x2094a3(0x1b3)](_0x5a4dd4)+'\x0a',_0x3d82d4=this[_0x2094a3(0x1eb)](_0x4d7d97);fs_1['default'][_0x2094a3(0x1b6)](_0x3d82d4,_0x426b6f,_0x2094a3(0x1d8));}catch(_0x4648c0){console[_0x2094a3(0x1f5)](_0x2094a3(0x1f6)+_0x4d7d97+_0x2094a3(0x1d6),_0x4648c0);}}[a49_0x19dc90(0x1e7)](_0x3f21a7,_0x24bff5,_0x2fdfc5,_0x4a7c68){const _0x42dc90=a49_0x19dc90;this[_0x42dc90(0x1de)](_0x42dc90(0x1cd),{'type':_0x42dc90(0x1e5),'gateway':_0x3f21a7,'endpoint':_0x24bff5,'method':_0x2fdfc5,'data':_0x4a7c68});}[a49_0x19dc90(0x1af)](_0x6b0369,_0x424adf,_0x544829,_0x182e54,_0xc6c3a2){const _0x19dd3d=a49_0x19dc90;this[_0x19dd3d(0x1de)]('white_domain_responses',{'type':_0x19dd3d(0x1aa),'gateway':_0x6b0369,'endpoint':_0x424adf,'status':_0x544829,'responseTime':_0xc6c3a2,'data':_0x182e54});}[a49_0x19dc90(0x1bd)](_0x5f437f,_0x1693eb,_0x5b4877){const _0x5e5d7e=a49_0x19dc90;this[_0x5e5d7e(0x1de)](_0x5e5d7e(0x1a8),{'type':_0x5e5d7e(0x19e),'gateway':_0x5f437f,'endpoint':_0x1693eb,'error':_0x5b4877 instanceof Error?{'message':_0x5b4877[_0x5e5d7e(0x1a3)],'stack':_0x5b4877[_0x5e5d7e(0x1e3)]}:_0x5b4877});}['logWebhookReceived'](_0x46f3ab,_0x3e4f4c,_0x125553){const _0x89a15c=a49_0x19dc90;this[_0x89a15c(0x1de)](_0x89a15c(0x1b0),{'type':'WEBHOOK_RECEIVED','gateway':_0x46f3ab,'headers':_0x125553,'data':_0x3e4f4c});}[a49_0x19dc90(0x1b2)](_0x4db39e,_0x1539cf,_0x1ed603,_0x27961a,_0xac2c6a){const _0x29c33e=a49_0x19dc90;this['writeLog'](_0x29c33e(0x1c3),{'type':_0x29c33e(0x1ec),'gateway':_0x4db39e,'paymentId':_0x1539cf,'oldStatus':_0x1ed603,'newStatus':_0x27961a,'originalData':_0xac2c6a});}[a49_0x19dc90(0x1b5)](_0x49a46e,_0x3d3b43,_0xd917f1){const _0x562ef4=a49_0x19dc90;this['writeLog'](_0x562ef4(0x1e8),{'type':_0x562ef4(0x1b7),'gateway':_0x49a46e,'error':_0x3d3b43 instanceof Error?{'message':_0x3d3b43[_0x562ef4(0x1a3)],'stack':_0x3d3b43[_0x562ef4(0x1e3)]}:_0x3d3b43,'originalData':_0xd917f1});}[a49_0x19dc90(0x1ae)](_0x179534){const _0x13123f=a49_0x19dc90;this[_0x13123f(0x1de)](_0x13123f(0x1e9),{'type':_0x13123f(0x1ba),..._0x179534});}[a49_0x19dc90(0x1e1)](_0x55fba4){const _0x2ef190=a49_0x19dc90;this[_0x2ef190(0x1de)](_0x2ef190(0x1dd),{'type':_0x2ef190(0x1e4),..._0x55fba4});}['logShopWebhookSent'](_0x1cf1f5,_0x578413,_0x86ef0f,_0x1bb66a,_0x28b9d3,_0x3ad406){const _0x3833cf=a49_0x19dc90;this[_0x3833cf(0x1de)](_0x3833cf(0x1cb),{'type':_0x3833cf(0x1ed),'shopId':_0x1cf1f5,'webhookUrl':_0x578413,'event':_0x86ef0f,'status':_0x1bb66a,'responseTime':_0x28b9d3,'payload':_0x3ad406});}['logShopWebhookError'](_0x433cbb,_0x4bd5be,_0x59d88e,_0x54a591,_0x16bb14){const _0x272aa5=a49_0x19dc90;this[_0x272aa5(0x1de)](_0x272aa5(0x1f3),{'type':'SHOP_WEBHOOK_ERROR','shopId':_0x433cbb,'webhookUrl':_0x4bd5be,'event':_0x59d88e,'error':_0x54a591 instanceof Error?{'message':_0x54a591[_0x272aa5(0x1a3)],'stack':_0x54a591[_0x272aa5(0x1e3)]}:_0x54a591,'payload':_0x16bb14});}[a49_0x19dc90(0x1ac)](_0x445cf1,_0x3cd4c9,_0x51e298,_0x4d47b1,_0x3cfa76){const _0x50ffd7=a49_0x19dc90;this[_0x50ffd7(0x1de)](_0x50ffd7(0x1c2),{'type':_0x50ffd7(0x1f4),'gateway':_0x445cf1,'paymentId':_0x3cd4c9,'shopId':_0x51e298,'amount':_0x4d47b1,'currency':_0x3cfa76});}[a49_0x19dc90(0x1d5)](_0x3ccc9a,_0xa9facd,_0x51db3c,_0xc29747,_0x1241ca){const _0x24996a=a49_0x19dc90;this[_0x24996a(0x1de)](_0x24996a(0x1c9),{'type':'API_CALL','endpoint':_0x3ccc9a,'method':_0xa9facd,'userId':_0x51db3c,'userRole':_0xc29747,'requestData':_0x1241ca});}[a49_0x19dc90(0x1a9)](){const _0x390626=a49_0x19dc90;try{const _0x2b6a76=fs_1['default'][_0x390626(0x1a7)](this[_0x390626(0x1bb)]),_0x3c0453=_0x2b6a76[_0x390626(0x1bf)](_0x1d1896=>_0x1d1896[_0x390626(0x1ea)](_0x390626(0x1ee))),_0x3b4c72=[...new Set(_0x3c0453['map'](_0x53824e=>_0x53824e[_0x390626(0x1d3)]('_')[0x0]))],_0x2f6429=_0x3c0453['map'](_0x2e46b0=>{const _0x5b0f4f=_0x390626,_0x51d801=path_1[_0x5b0f4f(0x1ca)][_0x5b0f4f(0x1d7)](this[_0x5b0f4f(0x1bb)],_0x2e46b0),_0x47b4c4=fs_1[_0x5b0f4f(0x1ca)][_0x5b0f4f(0x1cf)](_0x51d801),[_0x2e3363,_0x1bf2a8]=_0x2e46b0[_0x5b0f4f(0x1d1)](_0x5b0f4f(0x1ee),'')['split']('_');return{'type':_0x2e3363,'date':_0x1bf2a8,'size':_0x47b4c4[_0x5b0f4f(0x1d4)]};})[_0x390626(0x1d9)]((_0x5e2ad1,_0x7f0274)=>_0x7f0274[_0x390626(0x19f)][_0x390626(0x1e2)](_0x5e2ad1['date']));return{'totalFiles':_0x3c0453[_0x390626(0x1f0)],'logTypes':_0x3b4c72,'latestLogs':_0x2f6429[_0x390626(0x1be)](0x0,0xa)};}catch(_0x10668f){return console['error']('Failed\x20to\x20get\x20log\x20stats:',_0x10668f),{'totalFiles':0x0,'logTypes':[],'latestLogs':[]};}}[a49_0x19dc90(0x1c1)](_0x155a88=0x1e){const _0x594978=a49_0x19dc90;try{const _0x5830f7=fs_1[_0x594978(0x1ca)][_0x594978(0x1a7)](this[_0x594978(0x1bb)]),_0x147e70=new Date();_0x147e70[_0x594978(0x1a5)](_0x147e70[_0x594978(0x1bc)]()-_0x155a88);let _0x4ca3a6=0x0;_0x5830f7[_0x594978(0x19d)](_0x569e66=>{const _0x2e548e=_0x594978;if(!_0x569e66[_0x2e548e(0x1ea)]('.log'))return;const _0x47e2b0=path_1[_0x2e548e(0x1ca)]['join'](this[_0x2e548e(0x1bb)],_0x569e66),_0x20807f=fs_1[_0x2e548e(0x1ca)][_0x2e548e(0x1cf)](_0x47e2b0);_0x20807f[_0x2e548e(0x1b8)]<_0x147e70&&(fs_1[_0x2e548e(0x1ca)]['unlinkSync'](_0x47e2b0),_0x4ca3a6++,console['log'](_0x2e548e(0x1d2)+_0x569e66));}),console[_0x594978(0x1a6)](_0x594978(0x1c8)+_0x4ca3a6+_0x594978(0x1dc)+_0x155a88+_0x594978(0x1a4));}catch(_0x5ec835){console[_0x594978(0x1f5)](_0x594978(0x1b4),_0x5ec835);}}}exports[a49_0x19dc90(0x1a2)]=LoggerService,exports[a49_0x19dc90(0x1c4)]=new LoggerService();