'use strict';const a44_0x515023=a44_0x2c5c;function a44_0x2c5c(_0x35b885,_0x46d53f){const _0x3a5e33=a44_0x3a5e();return a44_0x2c5c=function(_0x2c5c48,_0x488583){_0x2c5c48=_0x2c5c48-0x93;let _0x4ac0c8=_0x3a5e33[_0x2c5c48];return _0x4ac0c8;},a44_0x2c5c(_0x35b885,_0x46d53f);}(function(_0x20ac62,_0x4dd4f5){const _0x6a5a1f=a44_0x2c5c,_0x29e684=_0x20ac62();while(!![]){try{const _0x581e62=parseInt(_0x6a5a1f(0xd0))/0x1+parseInt(_0x6a5a1f(0xdf))/0x2*(-parseInt(_0x6a5a1f(0xbc))/0x3)+-parseInt(_0x6a5a1f(0xcf))/0x4*(-parseInt(_0x6a5a1f(0xd6))/0x5)+parseInt(_0x6a5a1f(0x95))/0x6*(parseInt(_0x6a5a1f(0x9d))/0x7)+-parseInt(_0x6a5a1f(0xb2))/0x8+-parseInt(_0x6a5a1f(0xa7))/0x9+parseInt(_0x6a5a1f(0xc2))/0xa;if(_0x581e62===_0x4dd4f5)break;else _0x29e684['push'](_0x29e684['shift']());}catch(_0x4168aa){_0x29e684['push'](_0x29e684['shift']());}}}(a44_0x3a5e,0xd15e6));var __importDefault=this&&this[a44_0x515023(0xb8)]||function(_0x4f61c9){const _0x49bfe7=a44_0x515023;return _0x4f61c9&&_0x4f61c9[_0x49bfe7(0xd8)]?_0x4f61c9:{'default':_0x4f61c9};};Object[a44_0x515023(0xaf)](exports,a44_0x515023(0xd8),{'value':!![]}),exports[a44_0x515023(0xde)]=exports['LoggerService']=void 0x0;function a44_0x3a5e(){const _0x47ea6e=['logWhiteDomainResponse','shop_webhooks_sent','WEBHOOK_RECEIVED','SHOP_WEBHOOK_ERROR','map','readdirSync','logShopWebhookSent','ERROR','1208HAofrZ','158463HDMzmQ','getLogFileName','join','endsWith','message','\x20log:','24545gihKXs','webhooks_received','__esModule','writeLog','logWebhookProcessed','\x20days)','statSync','getLogStats','loggerService','4xVfeex','.log','filter','WEBHOOK_PROCESSED','\x20old\x20log\x20files\x20(older\x20than\x20','ðŸ“\x20Created\x20logs\x20directory:\x20','logs','4038LKgocg','utf8','REQUEST','ðŸ§¹\x20Cleaned\x20','forEach','stringify','API_CALL','cleanOldLogs','5334ZTBNIc','date','getDate','mtime','existsSync','appendFileSync','default','webhooks_processed','logWhiteDomainRequest','white_domain_responses','11711214NVSDcW','webhooks_errors','RESPONSE','logApiCall','shop_webhooks_errors','log','toISOString','logPaymentCreated','defineProperty','Failed\x20to\x20get\x20log\x20stats:','logWebhookError','2071880aBazzA','sort','mkdirSync','stack','logWebhookReceived','error','__importDefault','payments_created','ensureLogsDirectory','Failed\x20to\x20write\x20','2115570HucZkI','split','white_domain_requests','api_calls','unlinkSync','logsDir','16743780hglooj','cwd','WEBHOOK_ERROR','replace','PAYMENT_CREATED'];a44_0x3a5e=function(){return _0x47ea6e;};return a44_0x3a5e();}const fs_1=__importDefault(require('fs')),path_1=__importDefault(require('path'));class LoggerService{constructor(){const _0x34cf47=a44_0x515023;this['logsDir']=path_1[_0x34cf47(0xa3)]['join'](process[_0x34cf47(0xc3)](),_0x34cf47(0x94)),this[_0x34cf47(0xba)]();}['ensureLogsDirectory'](){const _0x5685a5=a44_0x515023;!fs_1[_0x5685a5(0xa3)][_0x5685a5(0xa1)](this[_0x5685a5(0xc1)])&&(fs_1[_0x5685a5(0xa3)][_0x5685a5(0xb4)](this[_0x5685a5(0xc1)],{'recursive':!![]}),console[_0x5685a5(0xac)](_0x5685a5(0x93)+this[_0x5685a5(0xc1)]));}[a44_0x515023(0xd1)](_0x6794){const _0xa78cb6=a44_0x515023,_0x24f770=new Date()[_0xa78cb6(0xad)]()[_0xa78cb6(0xbd)]('T')[0x0];return path_1['default'][_0xa78cb6(0xd2)](this['logsDir'],_0x6794+'_'+_0x24f770+_0xa78cb6(0xe0));}['writeLog'](_0x3b0804,_0x5f8d79){const _0x386b8d=a44_0x515023;try{const _0x2784c2=new Date()['toISOString'](),_0x5f3ba5={'timestamp':_0x2784c2,..._0x5f8d79},_0x2f4135=JSON[_0x386b8d(0x9a)](_0x5f3ba5)+'\x0a',_0x54e384=this[_0x386b8d(0xd1)](_0x3b0804);fs_1['default'][_0x386b8d(0xa2)](_0x54e384,_0x2f4135,_0x386b8d(0x96));}catch(_0x2f3a72){console['error'](_0x386b8d(0xbb)+_0x3b0804+_0x386b8d(0xd5),_0x2f3a72);}}[a44_0x515023(0xa5)](_0x33a983,_0x321c63,_0x928274,_0x270fdb){const _0x56d33d=a44_0x515023;this[_0x56d33d(0xd9)](_0x56d33d(0xbe),{'type':_0x56d33d(0x97),'gateway':_0x33a983,'endpoint':_0x321c63,'method':_0x928274,'data':_0x270fdb});}[a44_0x515023(0xc7)](_0x5793af,_0x4ce854,_0x5a8989,_0xa4378a,_0x11fcd9){const _0x17a167=a44_0x515023;this[_0x17a167(0xd9)](_0x17a167(0xa6),{'type':_0x17a167(0xa9),'gateway':_0x5793af,'endpoint':_0x4ce854,'status':_0x5a8989,'responseTime':_0x11fcd9,'data':_0xa4378a});}['logWhiteDomainError'](_0x480dae,_0x24ef6f,_0x5aebe7){const _0x5293e1=a44_0x515023;this[_0x5293e1(0xd9)]('white_domain_errors',{'type':_0x5293e1(0xce),'gateway':_0x480dae,'endpoint':_0x24ef6f,'error':_0x5aebe7 instanceof Error?{'message':_0x5aebe7['message'],'stack':_0x5aebe7[_0x5293e1(0xb5)]}:_0x5aebe7});}[a44_0x515023(0xb6)](_0x249458,_0x320fbe,_0x1fddd8){const _0x3ee33a=a44_0x515023;this[_0x3ee33a(0xd9)](_0x3ee33a(0xd7),{'type':_0x3ee33a(0xc9),'gateway':_0x249458,'headers':_0x1fddd8,'data':_0x320fbe});}[a44_0x515023(0xda)](_0x3822c0,_0x274778,_0x29cbb1,_0x10cef3,_0x1a488d){const _0x1bc4fc=a44_0x515023;this[_0x1bc4fc(0xd9)](_0x1bc4fc(0xa4),{'type':_0x1bc4fc(0xe2),'gateway':_0x3822c0,'paymentId':_0x274778,'oldStatus':_0x29cbb1,'newStatus':_0x10cef3,'originalData':_0x1a488d});}[a44_0x515023(0xb1)](_0xad92e8,_0x1b5b83,_0x233f5f){const _0x131a86=a44_0x515023;this[_0x131a86(0xd9)](_0x131a86(0xa8),{'type':_0x131a86(0xc4),'gateway':_0xad92e8,'error':_0x1b5b83 instanceof Error?{'message':_0x1b5b83[_0x131a86(0xd4)],'stack':_0x1b5b83[_0x131a86(0xb5)]}:_0x1b5b83,'originalData':_0x233f5f});}[a44_0x515023(0xcd)](_0x149e58,_0x388240,_0x560d7d,_0x58b85a,_0x283c59,_0x418694){const _0x36e3e6=a44_0x515023;this[_0x36e3e6(0xd9)](_0x36e3e6(0xc8),{'type':'SHOP_WEBHOOK_SENT','shopId':_0x149e58,'webhookUrl':_0x388240,'event':_0x560d7d,'status':_0x58b85a,'responseTime':_0x283c59,'payload':_0x418694});}['logShopWebhookError'](_0x3b288a,_0x30f00a,_0x4f45bc,_0x2734fc,_0x5ad021){const _0x36a515=a44_0x515023;this[_0x36a515(0xd9)](_0x36a515(0xab),{'type':_0x36a515(0xca),'shopId':_0x3b288a,'webhookUrl':_0x30f00a,'event':_0x4f45bc,'error':_0x2734fc instanceof Error?{'message':_0x2734fc[_0x36a515(0xd4)],'stack':_0x2734fc['stack']}:_0x2734fc,'payload':_0x5ad021});}[a44_0x515023(0xae)](_0x224c6b,_0xcc13c7,_0x2c592e,_0x395297,_0x1bb206){const _0x42f908=a44_0x515023;this[_0x42f908(0xd9)](_0x42f908(0xb9),{'type':_0x42f908(0xc6),'gateway':_0x224c6b,'paymentId':_0xcc13c7,'shopId':_0x2c592e,'amount':_0x395297,'currency':_0x1bb206});}[a44_0x515023(0xaa)](_0x5af5fe,_0x3d86f0,_0x40ad7c,_0x222b6a,_0x36740f){const _0x107cf1=a44_0x515023;this['writeLog'](_0x107cf1(0xbf),{'type':_0x107cf1(0x9b),'endpoint':_0x5af5fe,'method':_0x3d86f0,'userId':_0x40ad7c,'userRole':_0x222b6a,'requestData':_0x36740f});}[a44_0x515023(0xdd)](){const _0x42dbe1=a44_0x515023;try{const _0xa283f0=fs_1[_0x42dbe1(0xa3)][_0x42dbe1(0xcc)](this['logsDir']),_0x6b4ed8=_0xa283f0[_0x42dbe1(0xe1)](_0x10c6df=>_0x10c6df[_0x42dbe1(0xd3)]('.log')),_0x9c70bb=[...new Set(_0x6b4ed8[_0x42dbe1(0xcb)](_0x498557=>_0x498557[_0x42dbe1(0xbd)]('_')[0x0]))],_0x266c86=_0x6b4ed8['map'](_0x324dca=>{const _0x400367=_0x42dbe1,_0x3f2f01=path_1['default'][_0x400367(0xd2)](this['logsDir'],_0x324dca),_0xc136f6=fs_1[_0x400367(0xa3)][_0x400367(0xdc)](_0x3f2f01),[_0x1dac5b,_0x247031]=_0x324dca[_0x400367(0xc5)](_0x400367(0xe0),'')[_0x400367(0xbd)]('_');return{'type':_0x1dac5b,'date':_0x247031,'size':_0xc136f6['size']};})[_0x42dbe1(0xb3)]((_0x22b111,_0x179960)=>_0x179960[_0x42dbe1(0x9e)]['localeCompare'](_0x22b111[_0x42dbe1(0x9e)]));return{'totalFiles':_0x6b4ed8['length'],'logTypes':_0x9c70bb,'latestLogs':_0x266c86['slice'](0x0,0xa)};}catch(_0xe22510){return console[_0x42dbe1(0xb7)](_0x42dbe1(0xb0),_0xe22510),{'totalFiles':0x0,'logTypes':[],'latestLogs':[]};}}[a44_0x515023(0x9c)](_0x140ac1=0x1e){const _0x584a6f=a44_0x515023;try{const _0x4b47e6=fs_1[_0x584a6f(0xa3)]['readdirSync'](this[_0x584a6f(0xc1)]),_0x13e360=new Date();_0x13e360['setDate'](_0x13e360[_0x584a6f(0x9f)]()-_0x140ac1);let _0x6c3e65=0x0;_0x4b47e6[_0x584a6f(0x99)](_0x2a253b=>{const _0xa0722e=_0x584a6f;if(!_0x2a253b[_0xa0722e(0xd3)](_0xa0722e(0xe0)))return;const _0x24584a=path_1[_0xa0722e(0xa3)][_0xa0722e(0xd2)](this[_0xa0722e(0xc1)],_0x2a253b),_0x36b702=fs_1[_0xa0722e(0xa3)][_0xa0722e(0xdc)](_0x24584a);_0x36b702[_0xa0722e(0xa0)]<_0x13e360&&(fs_1['default'][_0xa0722e(0xc0)](_0x24584a),_0x6c3e65++,console[_0xa0722e(0xac)]('ðŸ—‘ï¸\x20Deleted\x20old\x20log\x20file:\x20'+_0x2a253b));}),console['log'](_0x584a6f(0x98)+_0x6c3e65+_0x584a6f(0xe3)+_0x140ac1+_0x584a6f(0xdb));}catch(_0x2e03d0){console[_0x584a6f(0xb7)]('Failed\x20to\x20clean\x20old\x20logs:',_0x2e03d0);}}}exports['LoggerService']=LoggerService,exports['loggerService']=new LoggerService();