'use strict';const a48_0x891181=a48_0x4f5b;(function(_0x2da3c9,_0x40b2f7){const _0x3b4792=a48_0x4f5b,_0x34c285=_0x2da3c9();while(!![]){try{const _0x38f645=parseInt(_0x3b4792(0x15f))/0x1*(parseInt(_0x3b4792(0x194))/0x2)+-parseInt(_0x3b4792(0x1a4))/0x3+-parseInt(_0x3b4792(0x17b))/0x4*(parseInt(_0x3b4792(0x18e))/0x5)+-parseInt(_0x3b4792(0x165))/0x6*(-parseInt(_0x3b4792(0x1a0))/0x7)+parseInt(_0x3b4792(0x195))/0x8+-parseInt(_0x3b4792(0x1a7))/0x9*(parseInt(_0x3b4792(0x199))/0xa)+parseInt(_0x3b4792(0x18d))/0xb;if(_0x38f645===_0x40b2f7)break;else _0x34c285['push'](_0x34c285['shift']());}catch(_0x41e727){_0x34c285['push'](_0x34c285['shift']());}}}(a48_0x4da5,0xe6b52));function a48_0x4da5(){const _0x4750f1=['api_calls','replace','📁\x20Created\x20logs\x20directory:\x20','30NjuUGj','\x20old\x20log\x20files\x20(older\x20than\x20','date','__esModule','length','split','logPaymentCreated','7VdEjDk','logWhiteDomainError','__importDefault','mkdirSync','4972815nXRGqk','readdirSync','logWhiteDomainResponse','2642994XxnHZU','error','mtime','logCoinToPayStatus','toISOString','ERROR','SHOP_WEBHOOK_ERROR','loggerService','cointopay_status_changes','utf8','RESPONSE','3282RnHuyH','🧹\x20Cleaned\x20','Failed\x20to\x20get\x20log\x20stats:','white_domain_errors','default','logWebhookReceived','3608070ursaaP','writeLog','Failed\x20to\x20write\x20','logsDir','WEBHOOK_RECEIVED','statSync','size','appendFileSync','logShopWebhookError','existsSync','🗑️\x20Deleted\x20old\x20log\x20file:\x20','join','API_CALL','defineProperty','webhooks_processed','\x20days)','REQUEST','endsWith','logCoinToPayError','logApiCall','logShopWebhookSent','getLogFileName','3362140plkwnd','cleanOldLogs','localeCompare','logs','logWhiteDomainRequest','getLogStats','path','LoggerService','PAYMENT_CREATED','webhooks_received','white_domain_responses','.log','webhooks_errors','stack','COINTOPAY_STATUS_CHANGE','Failed\x20to\x20clean\x20old\x20logs:','log','shop_webhooks_sent','25566717KzHjMS','5kgkbsr','message','ensureLogsDirectory','WEBHOOK_ERROR','SHOP_WEBHOOK_SENT','payments_created','10zdggUa','11056912mUQkSs'];a48_0x4da5=function(){return _0x4750f1;};return a48_0x4da5();}var __importDefault=this&&this[a48_0x891181(0x1a2)]||function(_0x2ebaf8){const _0x2fc1a6=a48_0x891181;return _0x2ebaf8&&_0x2ebaf8[_0x2fc1a6(0x19c)]?_0x2ebaf8:{'default':_0x2ebaf8};};Object[a48_0x891181(0x172)](exports,a48_0x891181(0x19c),{'value':!![]}),exports[a48_0x891181(0x15b)]=exports[a48_0x891181(0x182)]=void 0x0;function a48_0x4f5b(_0x5976f0,_0x3988ed){const _0x4da56d=a48_0x4da5();return a48_0x4f5b=function(_0x4f5bf6,_0x258943){_0x4f5bf6=_0x4f5bf6-0x15a;let _0x29347b=_0x4da56d[_0x4f5bf6];return _0x29347b;},a48_0x4f5b(_0x5976f0,_0x3988ed);}const fs_1=__importDefault(require('fs')),path_1=__importDefault(require(a48_0x891181(0x181)));class LoggerService{constructor(){const _0x4fcc1a=a48_0x891181;this[_0x4fcc1a(0x168)]=path_1[_0x4fcc1a(0x163)]['join'](process['cwd'](),_0x4fcc1a(0x17e)),this[_0x4fcc1a(0x190)]();}['ensureLogsDirectory'](){const _0x1e0cab=a48_0x891181;!fs_1[_0x1e0cab(0x163)][_0x1e0cab(0x16e)](this['logsDir'])&&(fs_1['default'][_0x1e0cab(0x1a3)](this['logsDir'],{'recursive':!![]}),console[_0x1e0cab(0x18b)](_0x1e0cab(0x198)+this['logsDir']));}[a48_0x891181(0x17a)](_0x5a5ad5){const _0x2df0eb=a48_0x891181,_0x46c1d9=new Date()['toISOString']()[_0x2df0eb(0x19e)]('T')[0x0];return path_1['default'][_0x2df0eb(0x170)](this['logsDir'],_0x5a5ad5+'_'+_0x46c1d9+_0x2df0eb(0x186));}[a48_0x891181(0x166)](_0x2c62d9,_0x2770cc){const _0x47b680=a48_0x891181;try{const _0x3b60be=new Date()[_0x47b680(0x1ab)](),_0xcb4190={'timestamp':_0x3b60be,..._0x2770cc},_0x339fcb=JSON['stringify'](_0xcb4190)+'\x0a',_0x386344=this[_0x47b680(0x17a)](_0x2c62d9);fs_1[_0x47b680(0x163)][_0x47b680(0x16c)](_0x386344,_0x339fcb,_0x47b680(0x15d));}catch(_0x432d08){console[_0x47b680(0x1a8)](_0x47b680(0x167)+_0x2c62d9+'\x20log:',_0x432d08);}}[a48_0x891181(0x17f)](_0x7e37fa,_0x81a66f,_0x3dc7ef,_0xddde17){const _0x24d443=a48_0x891181;this['writeLog']('white_domain_requests',{'type':_0x24d443(0x175),'gateway':_0x7e37fa,'endpoint':_0x81a66f,'method':_0x3dc7ef,'data':_0xddde17});}[a48_0x891181(0x1a6)](_0x28d302,_0x449bbf,_0x19f121,_0x32c27,_0x3185cc){const _0x441b3f=a48_0x891181;this[_0x441b3f(0x166)](_0x441b3f(0x185),{'type':_0x441b3f(0x15e),'gateway':_0x28d302,'endpoint':_0x449bbf,'status':_0x19f121,'responseTime':_0x3185cc,'data':_0x32c27});}[a48_0x891181(0x1a1)](_0x13b0b2,_0x4b89f0,_0x4915ae){const _0x23f839=a48_0x891181;this[_0x23f839(0x166)](_0x23f839(0x162),{'type':_0x23f839(0x1ac),'gateway':_0x13b0b2,'endpoint':_0x4b89f0,'error':_0x4915ae instanceof Error?{'message':_0x4915ae[_0x23f839(0x18f)],'stack':_0x4915ae[_0x23f839(0x188)]}:_0x4915ae});}[a48_0x891181(0x164)](_0x56ac29,_0x589db9,_0x487934){const _0x3fb898=a48_0x891181;this[_0x3fb898(0x166)](_0x3fb898(0x184),{'type':_0x3fb898(0x169),'gateway':_0x56ac29,'headers':_0x487934,'data':_0x589db9});}['logWebhookProcessed'](_0x41e74d,_0xf2a46,_0x1cff11,_0x52ecf0,_0x3d32be){const _0x451d2f=a48_0x891181;this['writeLog'](_0x451d2f(0x173),{'type':'WEBHOOK_PROCESSED','gateway':_0x41e74d,'paymentId':_0xf2a46,'oldStatus':_0x1cff11,'newStatus':_0x52ecf0,'originalData':_0x3d32be});}['logWebhookError'](_0x5685b9,_0x2af3f2,_0x2a6aa0){const _0x10c618=a48_0x891181;this[_0x10c618(0x166)](_0x10c618(0x187),{'type':_0x10c618(0x191),'gateway':_0x5685b9,'error':_0x2af3f2 instanceof Error?{'message':_0x2af3f2[_0x10c618(0x18f)],'stack':_0x2af3f2[_0x10c618(0x188)]}:_0x2af3f2,'originalData':_0x2a6aa0});}[a48_0x891181(0x1aa)](_0x20b855){const _0x156bb7=a48_0x891181;this[_0x156bb7(0x166)](_0x156bb7(0x15c),{'type':_0x156bb7(0x189),..._0x20b855});}[a48_0x891181(0x177)](_0x31a997){this['writeLog']('cointopay_errors',{'type':'COINTOPAY_ERROR',..._0x31a997});}[a48_0x891181(0x179)](_0x2207e9,_0x582af2,_0x55d2ff,_0x66fc69,_0xa4a254,_0x2b7368){const _0x9e9b56=a48_0x891181;this[_0x9e9b56(0x166)](_0x9e9b56(0x18c),{'type':_0x9e9b56(0x192),'shopId':_0x2207e9,'webhookUrl':_0x582af2,'event':_0x55d2ff,'status':_0x66fc69,'responseTime':_0xa4a254,'payload':_0x2b7368});}[a48_0x891181(0x16d)](_0x4923e8,_0x2156e3,_0x336e6f,_0x5792b4,_0xcc3fda){const _0x5df434=a48_0x891181;this[_0x5df434(0x166)]('shop_webhooks_errors',{'type':_0x5df434(0x15a),'shopId':_0x4923e8,'webhookUrl':_0x2156e3,'event':_0x336e6f,'error':_0x5792b4 instanceof Error?{'message':_0x5792b4[_0x5df434(0x18f)],'stack':_0x5792b4[_0x5df434(0x188)]}:_0x5792b4,'payload':_0xcc3fda});}[a48_0x891181(0x19f)](_0x108549,_0x221b43,_0x43fa2e,_0x1741fc,_0x276785){const _0x44bbff=a48_0x891181;this[_0x44bbff(0x166)](_0x44bbff(0x193),{'type':_0x44bbff(0x183),'gateway':_0x108549,'paymentId':_0x221b43,'shopId':_0x43fa2e,'amount':_0x1741fc,'currency':_0x276785});}[a48_0x891181(0x178)](_0x4f52e7,_0x41f4bd,_0xf722b,_0x4f2b35,_0x37e6de){const _0x330c30=a48_0x891181;this[_0x330c30(0x166)](_0x330c30(0x196),{'type':_0x330c30(0x171),'endpoint':_0x4f52e7,'method':_0x41f4bd,'userId':_0xf722b,'userRole':_0x4f2b35,'requestData':_0x37e6de});}[a48_0x891181(0x180)](){const _0x14be5a=a48_0x891181;try{const _0x2a0e40=fs_1[_0x14be5a(0x163)][_0x14be5a(0x1a5)](this['logsDir']),_0x13f9f0=_0x2a0e40['filter'](_0x2c2c07=>_0x2c2c07[_0x14be5a(0x176)]('.log')),_0x3b8508=[...new Set(_0x13f9f0['map'](_0x4e922e=>_0x4e922e[_0x14be5a(0x19e)]('_')[0x0]))],_0x4d73de=_0x13f9f0['map'](_0x1bc051=>{const _0x1e1432=_0x14be5a,_0x5a9f5e=path_1[_0x1e1432(0x163)][_0x1e1432(0x170)](this[_0x1e1432(0x168)],_0x1bc051),_0x2141c4=fs_1[_0x1e1432(0x163)]['statSync'](_0x5a9f5e),[_0x174b90,_0x31070c]=_0x1bc051[_0x1e1432(0x197)](_0x1e1432(0x186),'')[_0x1e1432(0x19e)]('_');return{'type':_0x174b90,'date':_0x31070c,'size':_0x2141c4[_0x1e1432(0x16b)]};})['sort']((_0x425b3e,_0x4a0cba)=>_0x4a0cba[_0x14be5a(0x19b)][_0x14be5a(0x17d)](_0x425b3e[_0x14be5a(0x19b)]));return{'totalFiles':_0x13f9f0[_0x14be5a(0x19d)],'logTypes':_0x3b8508,'latestLogs':_0x4d73de['slice'](0x0,0xa)};}catch(_0x5ba275){return console[_0x14be5a(0x1a8)](_0x14be5a(0x161),_0x5ba275),{'totalFiles':0x0,'logTypes':[],'latestLogs':[]};}}[a48_0x891181(0x17c)](_0x565aac=0x1e){const _0x591551=a48_0x891181;try{const _0x35c7dd=fs_1[_0x591551(0x163)]['readdirSync'](this[_0x591551(0x168)]),_0x329e17=new Date();_0x329e17['setDate'](_0x329e17['getDate']()-_0x565aac);let _0xe70fa3=0x0;_0x35c7dd['forEach'](_0x539ca8=>{const _0x110c9d=_0x591551;if(!_0x539ca8['endsWith'](_0x110c9d(0x186)))return;const _0x224872=path_1[_0x110c9d(0x163)][_0x110c9d(0x170)](this[_0x110c9d(0x168)],_0x539ca8),_0x3f8251=fs_1[_0x110c9d(0x163)][_0x110c9d(0x16a)](_0x224872);_0x3f8251[_0x110c9d(0x1a9)]<_0x329e17&&(fs_1[_0x110c9d(0x163)]['unlinkSync'](_0x224872),_0xe70fa3++,console[_0x110c9d(0x18b)](_0x110c9d(0x16f)+_0x539ca8));}),console[_0x591551(0x18b)](_0x591551(0x160)+_0xe70fa3+_0x591551(0x19a)+_0x565aac+_0x591551(0x174));}catch(_0x114f8e){console[_0x591551(0x1a8)](_0x591551(0x18a),_0x114f8e);}}}exports['LoggerService']=LoggerService,exports[a48_0x891181(0x15b)]=new LoggerService();