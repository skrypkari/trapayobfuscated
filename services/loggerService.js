'use strict';const a55_0x4a3a89=a55_0x25dc;(function(_0x1c378b,_0x251e40){const _0x26f278=a55_0x25dc,_0x42e534=_0x1c378b();while(!![]){try{const _0x2a4f4d=-parseInt(_0x26f278(0x123))/0x1*(-parseInt(_0x26f278(0x143))/0x2)+parseInt(_0x26f278(0x100))/0x3*(parseInt(_0x26f278(0x10e))/0x4)+parseInt(_0x26f278(0x113))/0x5+parseInt(_0x26f278(0x13e))/0x6+-parseInt(_0x26f278(0x141))/0x7+-parseInt(_0x26f278(0xf6))/0x8+-parseInt(_0x26f278(0x140))/0x9;if(_0x2a4f4d===_0x251e40)break;else _0x42e534['push'](_0x42e534['shift']());}catch(_0x2e5181){_0x42e534['push'](_0x42e534['shift']());}}}(a55_0x123b,0xcf9de));var __importDefault=this&&this['__importDefault']||function(_0x16b9af){const _0x5b39e7=a55_0x25dc;return _0x16b9af&&_0x16b9af[_0x5b39e7(0x110)]?_0x16b9af:{'default':_0x16b9af};};Object['defineProperty'](exports,a55_0x4a3a89(0x110),{'value':!![]}),exports[a55_0x4a3a89(0xf7)]=exports['LoggerService']=void 0x0;const fs_1=__importDefault(require('fs')),path_1=__importDefault(require('path'));class LoggerService{constructor(){const _0x59f4a1=a55_0x4a3a89;this[_0x59f4a1(0x12a)]=path_1[_0x59f4a1(0x120)][_0x59f4a1(0x127)](process[_0x59f4a1(0x111)](),_0x59f4a1(0x116)),this[_0x59f4a1(0x112)]();}[a55_0x4a3a89(0x112)](){const _0x14f8d5=a55_0x4a3a89;!fs_1[_0x14f8d5(0x120)][_0x14f8d5(0x108)](this[_0x14f8d5(0x12a)])&&(fs_1[_0x14f8d5(0x120)][_0x14f8d5(0xf5)](this['logsDir'],{'recursive':!![]}),console[_0x14f8d5(0x12e)](_0x14f8d5(0x104)+this[_0x14f8d5(0x12a)]));}[a55_0x4a3a89(0x10d)](_0x168954){const _0x159ccb=a55_0x4a3a89,_0x472823=new Date()[_0x159ccb(0x139)]()[_0x159ccb(0x105)]('T')[0x0];return path_1['default'][_0x159ccb(0x127)](this[_0x159ccb(0x12a)],_0x168954+'_'+_0x472823+'.log');}['writeLog'](_0xcceba,_0x506be6){const _0x196d94=a55_0x4a3a89;try{const _0x117921=new Date()[_0x196d94(0x139)](),_0x173b4d={'timestamp':_0x117921,..._0x506be6},_0x1f8b33=JSON[_0x196d94(0x11a)](_0x173b4d)+'\x0a',_0x22e921=this[_0x196d94(0x10d)](_0xcceba);fs_1[_0x196d94(0x120)][_0x196d94(0x131)](_0x22e921,_0x1f8b33,_0x196d94(0x13d));}catch(_0xadac8e){console[_0x196d94(0x11d)]('Failed\x20to\x20write\x20'+_0xcceba+_0x196d94(0xfd),_0xadac8e);}}[a55_0x4a3a89(0xff)](_0xa30e55,_0x423fb8,_0x23820a,_0x21dfd2){const _0x40e70b=a55_0x4a3a89;this[_0x40e70b(0x11e)](_0x40e70b(0x12c),{'type':_0x40e70b(0x136),'gateway':_0xa30e55,'endpoint':_0x423fb8,'method':_0x23820a,'data':_0x21dfd2});}[a55_0x4a3a89(0x101)](_0x333c59,_0x352c05,_0x2cb007,_0x165865,_0x4067ae){const _0x1d3739=a55_0x4a3a89;this[_0x1d3739(0x11e)](_0x1d3739(0x128),{'type':_0x1d3739(0x135),'gateway':_0x333c59,'endpoint':_0x352c05,'status':_0x2cb007,'responseTime':_0x4067ae,'data':_0x165865});}[a55_0x4a3a89(0xf9)](_0x1474c9,_0x39e463,_0x32ccd3){const _0x19a636=a55_0x4a3a89;this[_0x19a636(0x11e)](_0x19a636(0x13c),{'type':_0x19a636(0x10c),'gateway':_0x1474c9,'endpoint':_0x39e463,'error':_0x32ccd3 instanceof Error?{'message':_0x32ccd3['message'],'stack':_0x32ccd3[_0x19a636(0x124)]}:_0x32ccd3});}[a55_0x4a3a89(0x13a)](_0x36a370,_0x28812e,_0x33f15c){const _0x9baadb=a55_0x4a3a89;this['writeLog'](_0x9baadb(0xfb),{'type':_0x9baadb(0x114),'gateway':_0x36a370,'headers':_0x33f15c,'data':_0x28812e});}[a55_0x4a3a89(0x130)](_0x1950cf,_0x1ac385,_0x28da5c,_0x248415,_0x13195c){const _0x2b14ca=a55_0x4a3a89;this[_0x2b14ca(0x11e)](_0x2b14ca(0xfe),{'type':_0x2b14ca(0x109),'gateway':_0x1950cf,'paymentId':_0x1ac385,'oldStatus':_0x28da5c,'newStatus':_0x248415,'originalData':_0x13195c});}[a55_0x4a3a89(0x129)](_0x592fa0,_0x272ae2,_0x35d61f){const _0x4499a9=a55_0x4a3a89;this[_0x4499a9(0x11e)]('webhooks_errors',{'type':_0x4499a9(0x137),'gateway':_0x592fa0,'error':_0x272ae2 instanceof Error?{'message':_0x272ae2[_0x4499a9(0x133)],'stack':_0x272ae2[_0x4499a9(0x124)]}:_0x272ae2,'originalData':_0x35d61f});}['logCoinToPayStatus'](_0x3c11d2){const _0x81fca0=a55_0x4a3a89;this['writeLog'](_0x81fca0(0x13b),{'type':'COINTOPAY_STATUS_CHANGE',..._0x3c11d2});}['logCoinToPayError'](_0x28c2cb){const _0x262946=a55_0x4a3a89;this[_0x262946(0x11e)](_0x262946(0x13f),{'type':_0x262946(0x142),..._0x28c2cb});}[a55_0x4a3a89(0x11b)](_0x87e88e,_0x271951,_0x4ae6dd,_0xd26f5e,_0x5c5d7c,_0x1dec34){const _0x395a11=a55_0x4a3a89;this['writeLog'](_0x395a11(0x107),{'type':_0x395a11(0x103),'shopId':_0x87e88e,'webhookUrl':_0x271951,'event':_0x4ae6dd,'status':_0xd26f5e,'responseTime':_0x5c5d7c,'payload':_0x1dec34});}['logShopWebhookError'](_0x429e9b,_0x5a6083,_0x17893e,_0x32ab5d,_0x38a942){const _0x1c256d=a55_0x4a3a89;this[_0x1c256d(0x11e)](_0x1c256d(0x119),{'type':_0x1c256d(0x106),'shopId':_0x429e9b,'webhookUrl':_0x5a6083,'event':_0x17893e,'error':_0x32ab5d instanceof Error?{'message':_0x32ab5d['message'],'stack':_0x32ab5d[_0x1c256d(0x124)]}:_0x32ab5d,'payload':_0x38a942});}[a55_0x4a3a89(0x12d)](_0x4dc421,_0x469fc0,_0x4bd2fe,_0x22bded,_0x375926){const _0x32a763=a55_0x4a3a89;this[_0x32a763(0x11e)]('payments_created',{'type':_0x32a763(0x132),'gateway':_0x4dc421,'paymentId':_0x469fc0,'shopId':_0x4bd2fe,'amount':_0x22bded,'currency':_0x375926});}[a55_0x4a3a89(0xf8)](_0x46fb1e,_0x76128d,_0x332328,_0xea6b3c,_0x9c255f){const _0x4ab763=a55_0x4a3a89;this[_0x4ab763(0x11e)](_0x4ab763(0x134),{'type':'API_CALL','endpoint':_0x46fb1e,'method':_0x76128d,'userId':_0x332328,'userRole':_0xea6b3c,'requestData':_0x9c255f});}[a55_0x4a3a89(0x12b)](){const _0x30729b=a55_0x4a3a89;try{const _0x35f3a1=fs_1[_0x30729b(0x120)][_0x30729b(0x117)](this[_0x30729b(0x12a)]),_0x420156=_0x35f3a1['filter'](_0x4b7c89=>_0x4b7c89[_0x30729b(0x144)](_0x30729b(0x125))),_0x4b242f=[...new Set(_0x420156[_0x30729b(0x11c)](_0x26f880=>_0x26f880[_0x30729b(0x105)]('_')[0x0]))],_0xa3ecea=_0x420156[_0x30729b(0x11c)](_0x3c213c=>{const _0x59c522=_0x30729b,_0x148ba6=path_1[_0x59c522(0x120)]['join'](this[_0x59c522(0x12a)],_0x3c213c),_0x59e4c5=fs_1[_0x59c522(0x120)][_0x59c522(0x115)](_0x148ba6),[_0x59a53d,_0x14c12e]=_0x3c213c[_0x59c522(0xfc)]('.log','')[_0x59c522(0x105)]('_');return{'type':_0x59a53d,'date':_0x14c12e,'size':_0x59e4c5['size']};})[_0x30729b(0x12f)]((_0x192583,_0x3c69ae)=>_0x3c69ae[_0x30729b(0x11f)]['localeCompare'](_0x192583['date']));return{'totalFiles':_0x420156[_0x30729b(0x10b)],'logTypes':_0x4b242f,'latestLogs':_0xa3ecea[_0x30729b(0x102)](0x0,0xa)};}catch(_0x39a7af){return console['error'](_0x30729b(0xfa),_0x39a7af),{'totalFiles':0x0,'logTypes':[],'latestLogs':[]};}}['cleanOldLogs'](_0x54dbe6=0x1e){const _0x18a743=a55_0x4a3a89;try{const _0x471388=fs_1[_0x18a743(0x120)][_0x18a743(0x117)](this[_0x18a743(0x12a)]),_0xffc2e=new Date();_0xffc2e[_0x18a743(0x145)](_0xffc2e[_0x18a743(0x138)]()-_0x54dbe6);let _0x475a21=0x0;_0x471388[_0x18a743(0x122)](_0x4647b5=>{const _0x9af13b=_0x18a743;if(!_0x4647b5['endsWith'](_0x9af13b(0x125)))return;const _0x592433=path_1[_0x9af13b(0x120)]['join'](this[_0x9af13b(0x12a)],_0x4647b5),_0x41be20=fs_1[_0x9af13b(0x120)]['statSync'](_0x592433);_0x41be20['mtime']<_0xffc2e&&(fs_1[_0x9af13b(0x120)]['unlinkSync'](_0x592433),_0x475a21++,console[_0x9af13b(0x12e)](_0x9af13b(0x10f)+_0x4647b5));}),console[_0x18a743(0x12e)](_0x18a743(0x121)+_0x475a21+_0x18a743(0x10a)+_0x54dbe6+'\x20days)');}catch(_0x15df7a){console[_0x18a743(0x11d)](_0x18a743(0x118),_0x15df7a);}}}exports[a55_0x4a3a89(0x126)]=LoggerService,exports[a55_0x4a3a89(0xf7)]=new LoggerService();function a55_0x25dc(_0x39b7d5,_0x5821bf){const _0x123b3b=a55_0x123b();return a55_0x25dc=function(_0x25dc82,_0x254fd5){_0x25dc82=_0x25dc82-0xf5;let _0x43f5aa=_0x123b3b[_0x25dc82];return _0x43f5aa;},a55_0x25dc(_0x39b7d5,_0x5821bf);}function a55_0x123b(){const _0x3fce2f=['cointopay_errors','15632559Efekvq','3831317HsfNDf','COINTOPAY_ERROR','702bcfFpJ','endsWith','setDate','mkdirSync','1382720goxygY','loggerService','logApiCall','logWhiteDomainError','Failed\x20to\x20get\x20log\x20stats:','webhooks_received','replace','\x20log:','webhooks_processed','logWhiteDomainRequest','3DHGtOB','logWhiteDomainResponse','slice','SHOP_WEBHOOK_SENT','📁\x20Created\x20logs\x20directory:\x20','split','SHOP_WEBHOOK_ERROR','shop_webhooks_sent','existsSync','WEBHOOK_PROCESSED','\x20old\x20log\x20files\x20(older\x20than\x20','length','ERROR','getLogFileName','3729732qLhNnv','🗑️\x20Deleted\x20old\x20log\x20file:\x20','__esModule','cwd','ensureLogsDirectory','5347060nvmlqE','WEBHOOK_RECEIVED','statSync','logs','readdirSync','Failed\x20to\x20clean\x20old\x20logs:','shop_webhooks_errors','stringify','logShopWebhookSent','map','error','writeLog','date','default','🧹\x20Cleaned\x20','forEach','786RVjmKu','stack','.log','LoggerService','join','white_domain_responses','logWebhookError','logsDir','getLogStats','white_domain_requests','logPaymentCreated','log','sort','logWebhookProcessed','appendFileSync','PAYMENT_CREATED','message','api_calls','RESPONSE','REQUEST','WEBHOOK_ERROR','getDate','toISOString','logWebhookReceived','cointopay_status_changes','white_domain_errors','utf8','6178734VKYQKP'];a55_0x123b=function(){return _0x3fce2f;};return a55_0x123b();}