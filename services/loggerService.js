'use strict';const a43_0xe8a035=a43_0x5ecd;(function(_0x329300,_0x207603){const _0x40283a=a43_0x5ecd,_0x5335c4=_0x329300();while(!![]){try{const _0x2ec128=parseInt(_0x40283a(0x183))/0x1*(parseInt(_0x40283a(0x157))/0x2)+parseInt(_0x40283a(0x164))/0x3*(parseInt(_0x40283a(0x155))/0x4)+parseInt(_0x40283a(0x17d))/0x5*(parseInt(_0x40283a(0x148))/0x6)+-parseInt(_0x40283a(0x165))/0x7+parseInt(_0x40283a(0x154))/0x8*(-parseInt(_0x40283a(0x13e))/0x9)+parseInt(_0x40283a(0x181))/0xa*(-parseInt(_0x40283a(0x14c))/0xb)+-parseInt(_0x40283a(0x15c))/0xc*(parseInt(_0x40283a(0x170))/0xd);if(_0x2ec128===_0x207603)break;else _0x5335c4['push'](_0x5335c4['shift']());}catch(_0xf08d48){_0x5335c4['push'](_0x5335c4['shift']());}}}(a43_0x5be2,0x4962c));function a43_0x5ecd(_0x479a9a,_0x241aa1){const _0x5be23f=a43_0x5be2();return a43_0x5ecd=function(_0x5ecd8a,_0x1f1e19){_0x5ecd8a=_0x5ecd8a-0x13b;let _0x40be48=_0x5be23f[_0x5ecd8a];return _0x40be48;},a43_0x5ecd(_0x479a9a,_0x241aa1);}var __importDefault=this&&this[a43_0xe8a035(0x182)]||function(_0x165a4e){const _0x5672bf=a43_0xe8a035;return _0x165a4e&&_0x165a4e[_0x5672bf(0x159)]?_0x165a4e:{'default':_0x165a4e};};Object[a43_0xe8a035(0x179)](exports,a43_0xe8a035(0x159),{'value':!![]}),exports[a43_0xe8a035(0x176)]=exports['LoggerService']=void 0x0;const fs_1=__importDefault(require('fs')),path_1=__importDefault(require('path'));class LoggerService{constructor(){const _0x31a859=a43_0xe8a035;this[_0x31a859(0x146)]=path_1[_0x31a859(0x145)][_0x31a859(0x17b)](process[_0x31a859(0x151)](),'logs'),this[_0x31a859(0x169)]();}[a43_0xe8a035(0x169)](){const _0x1af79d=a43_0xe8a035;!fs_1[_0x1af79d(0x145)][_0x1af79d(0x15e)](this[_0x1af79d(0x146)])&&(fs_1[_0x1af79d(0x145)]['mkdirSync'](this[_0x1af79d(0x146)],{'recursive':!![]}),console[_0x1af79d(0x15b)]('ğŸ“\x20Created\x20logs\x20directory:\x20'+this[_0x1af79d(0x146)]));}[a43_0xe8a035(0x141)](_0x3909dd){const _0x30bbfe=a43_0xe8a035,_0x5e250e=new Date()[_0x30bbfe(0x14b)]()['split']('T')[0x0];return path_1[_0x30bbfe(0x145)][_0x30bbfe(0x17b)](this[_0x30bbfe(0x146)],_0x3909dd+'_'+_0x5e250e+_0x30bbfe(0x13d));}[a43_0xe8a035(0x160)](_0x3f59b5,_0xdd4ce9){const _0x15a523=a43_0xe8a035;try{const _0x126713=new Date()['toISOString'](),_0x230eed={'timestamp':_0x126713,..._0xdd4ce9},_0x55933f=JSON[_0x15a523(0x177)](_0x230eed)+'\x0a',_0x19259d=this[_0x15a523(0x141)](_0x3f59b5);fs_1['default']['appendFileSync'](_0x19259d,_0x55933f,_0x15a523(0x13f));}catch(_0x295c17){console[_0x15a523(0x17f)]('Failed\x20to\x20write\x20'+_0x3f59b5+_0x15a523(0x15f),_0x295c17);}}['logWhiteDomainRequest'](_0x13ba8d,_0x11034a,_0x3f0271,_0x1056e2){const _0x3def11=a43_0xe8a035;this[_0x3def11(0x160)](_0x3def11(0x140),{'type':'REQUEST','gateway':_0x13ba8d,'endpoint':_0x11034a,'method':_0x3f0271,'data':_0x1056e2});}[a43_0xe8a035(0x175)](_0x5417c3,_0x4daca3,_0x2a4f91,_0x12bc05,_0x23a2ff){const _0x5460fa=a43_0xe8a035;this['writeLog'](_0x5460fa(0x143),{'type':_0x5460fa(0x149),'gateway':_0x5417c3,'endpoint':_0x4daca3,'status':_0x2a4f91,'responseTime':_0x23a2ff,'data':_0x12bc05});}[a43_0xe8a035(0x14e)](_0x57cc64,_0x2e95ab,_0x436e9e){const _0x521c18=a43_0xe8a035;this[_0x521c18(0x160)](_0x521c18(0x16d),{'type':_0x521c18(0x15d),'gateway':_0x57cc64,'endpoint':_0x2e95ab,'error':_0x436e9e instanceof Error?{'message':_0x436e9e[_0x521c18(0x174)],'stack':_0x436e9e[_0x521c18(0x14d)]}:_0x436e9e});}[a43_0xe8a035(0x156)](_0x412f3e,_0x13861e,_0x474097){const _0x151dde=a43_0xe8a035;this[_0x151dde(0x160)](_0x151dde(0x152),{'type':_0x151dde(0x14a),'gateway':_0x412f3e,'headers':_0x474097,'data':_0x13861e});}[a43_0xe8a035(0x173)](_0x52e8e7,_0x163779,_0x59acfb,_0x179f5e,_0x3c19f2){const _0x24eaa6=a43_0xe8a035;this[_0x24eaa6(0x160)]('webhooks_processed',{'type':'WEBHOOK_PROCESSED','gateway':_0x52e8e7,'paymentId':_0x163779,'oldStatus':_0x59acfb,'newStatus':_0x179f5e,'originalData':_0x3c19f2});}[a43_0xe8a035(0x166)](_0x5d0df5,_0x4f03d6,_0x49a0fe){const _0x173320=a43_0xe8a035;this[_0x173320(0x160)]('webhooks_errors',{'type':_0x173320(0x142),'gateway':_0x5d0df5,'error':_0x4f03d6 instanceof Error?{'message':_0x4f03d6['message'],'stack':_0x4f03d6[_0x173320(0x14d)]}:_0x4f03d6,'originalData':_0x49a0fe});}[a43_0xe8a035(0x13b)](_0x5d133c,_0x3527c1,_0x2a1263,_0x49e34e,_0x3aba33,_0x4e03ff){const _0x205326=a43_0xe8a035;this[_0x205326(0x160)](_0x205326(0x17e),{'type':_0x205326(0x17c),'shopId':_0x5d133c,'webhookUrl':_0x3527c1,'event':_0x2a1263,'status':_0x49e34e,'responseTime':_0x3aba33,'payload':_0x4e03ff});}[a43_0xe8a035(0x163)](_0x303a47,_0x44f90f,_0x3bdac8,_0x134b9d,_0x285c33){const _0x26494b=a43_0xe8a035;this[_0x26494b(0x160)]('shop_webhooks_errors',{'type':_0x26494b(0x144),'shopId':_0x303a47,'webhookUrl':_0x44f90f,'event':_0x3bdac8,'error':_0x134b9d instanceof Error?{'message':_0x134b9d[_0x26494b(0x174)],'stack':_0x134b9d['stack']}:_0x134b9d,'payload':_0x285c33});}['logPaymentCreated'](_0x2b4e3d,_0x2a39bf,_0x773185,_0x24aa56,_0xaa9a4d){const _0x1127ca=a43_0xe8a035;this[_0x1127ca(0x160)]('payments_created',{'type':_0x1127ca(0x17a),'gateway':_0x2b4e3d,'paymentId':_0x2a39bf,'shopId':_0x773185,'amount':_0x24aa56,'currency':_0xaa9a4d});}[a43_0xe8a035(0x13c)](_0x117faa,_0x4ad07d,_0x479bcf,_0x3a0dee,_0x4cca4b){const _0x1fe4ab=a43_0xe8a035;this['writeLog'](_0x1fe4ab(0x14f),{'type':'API_CALL','endpoint':_0x117faa,'method':_0x4ad07d,'userId':_0x479bcf,'userRole':_0x3a0dee,'requestData':_0x4cca4b});}[a43_0xe8a035(0x16e)](){const _0x577742=a43_0xe8a035;try{const _0x1c0bf3=fs_1['default']['readdirSync'](this[_0x577742(0x146)]),_0x184fb4=_0x1c0bf3['filter'](_0x3db1db=>_0x3db1db['endsWith'](_0x577742(0x13d))),_0x231149=[...new Set(_0x184fb4[_0x577742(0x16b)](_0x15488e=>_0x15488e[_0x577742(0x167)]('_')[0x0]))],_0x24f1af=_0x184fb4[_0x577742(0x16b)](_0x119988=>{const _0x294074=_0x577742,_0x4efe5c=path_1[_0x294074(0x145)][_0x294074(0x17b)](this[_0x294074(0x146)],_0x119988),_0x4fe6ee=fs_1[_0x294074(0x145)][_0x294074(0x161)](_0x4efe5c),[_0x2094ce,_0x8002ac]=_0x119988['replace']('.log','')[_0x294074(0x167)]('_');return{'type':_0x2094ce,'date':_0x8002ac,'size':_0x4fe6ee[_0x294074(0x16a)]};})[_0x577742(0x172)]((_0x162f32,_0x54d8a7)=>_0x54d8a7['date']['localeCompare'](_0x162f32['date']));return{'totalFiles':_0x184fb4['length'],'logTypes':_0x231149,'latestLogs':_0x24f1af[_0x577742(0x158)](0x0,0xa)};}catch(_0x5d392d){return console[_0x577742(0x17f)](_0x577742(0x168),_0x5d392d),{'totalFiles':0x0,'logTypes':[],'latestLogs':[]};}}['cleanOldLogs'](_0x3c7b21=0x1e){const _0x39e218=a43_0xe8a035;try{const _0x414557=fs_1[_0x39e218(0x145)]['readdirSync'](this[_0x39e218(0x146)]),_0x5e78f0=new Date();_0x5e78f0[_0x39e218(0x171)](_0x5e78f0[_0x39e218(0x16f)]()-_0x3c7b21);let _0x391348=0x0;_0x414557['forEach'](_0x543481=>{const _0x30a753=_0x39e218;if(!_0x543481[_0x30a753(0x16c)](_0x30a753(0x13d)))return;const _0x34d406=path_1[_0x30a753(0x145)][_0x30a753(0x17b)](this[_0x30a753(0x146)],_0x543481),_0x1a12d0=fs_1['default'][_0x30a753(0x161)](_0x34d406);_0x1a12d0[_0x30a753(0x150)]<_0x5e78f0&&(fs_1[_0x30a753(0x145)]['unlinkSync'](_0x34d406),_0x391348++,console[_0x30a753(0x15b)](_0x30a753(0x162)+_0x543481));}),console[_0x39e218(0x15b)](_0x39e218(0x178)+_0x391348+_0x39e218(0x15a)+_0x3c7b21+_0x39e218(0x180));}catch(_0x258836){console[_0x39e218(0x17f)](_0x39e218(0x153),_0x258836);}}}function a43_0x5be2(){const _0xf0c45=['logShopWebhookError','171DxMYxe','886725hpXTuq','logWebhookError','split','Failed\x20to\x20get\x20log\x20stats:','ensureLogsDirectory','size','map','endsWith','white_domain_errors','getLogStats','getDate','13SJXbDZ','setDate','sort','logWebhookProcessed','message','logWhiteDomainResponse','loggerService','stringify','ğŸ§¹\x20Cleaned\x20','defineProperty','PAYMENT_CREATED','join','SHOP_WEBHOOK_SENT','267155EdeABP','shop_webhooks_sent','error','\x20days)','30SFVoSl','__importDefault','55021FnvLHg','logShopWebhookSent','logApiCall','.log','136188Dpusty','utf8','white_domain_requests','getLogFileName','WEBHOOK_ERROR','white_domain_responses','SHOP_WEBHOOK_ERROR','default','logsDir','LoggerService','36HmMqmv','RESPONSE','WEBHOOK_RECEIVED','toISOString','1550791zzfdpI','stack','logWhiteDomainError','api_calls','mtime','cwd','webhooks_received','Failed\x20to\x20clean\x20old\x20logs:','32NMauXc','26876XDbWcm','logWebhookReceived','8LTQzUi','slice','__esModule','\x20old\x20log\x20files\x20(older\x20than\x20','log','155028fPrUcg','ERROR','existsSync','\x20log:','writeLog','statSync','ğŸ—‘ï¸\x20Deleted\x20old\x20log\x20file:\x20'];a43_0x5be2=function(){return _0xf0c45;};return a43_0x5be2();}exports[a43_0xe8a035(0x147)]=LoggerService,exports[a43_0xe8a035(0x176)]=new LoggerService();