'use strict';function a55_0x1959(){const _0x3f2044=['45440252NtxCer','logCoinToPayStatus','\x20old\x20log\x20files\x20(older\x20than\x20','3lIXrdS','split','white_domain_requests','ensureLogsDirectory','message','REQUEST','logCoinToPayError','COINTOPAY_STATUS_CHANGE','sort','API_CALL','logs','getLogFileName','WEBHOOK_RECEIVED','cointopay_status_changes','error','date','api_calls','statSync','WEBHOOK_PROCESSED','58xwvRQT','forEach','📁\x20Created\x20logs\x20directory:\x20','908352QXEnRJ','ERROR','SHOP_WEBHOOK_SENT','__esModule','SHOP_WEBHOOK_ERROR','PAYMENT_CREATED','RESPONSE','🧹\x20Cleaned\x20','white_domain_responses','shop_webhooks_errors','21355XSUJSS','cwd','mkdirSync','webhooks_errors','logWhiteDomainRequest','🗑️\x20Deleted\x20old\x20log\x20file:\x20','setDate','toISOString','slice','5654300zttUKQ','Failed\x20to\x20get\x20log\x20stats:','replace','defineProperty','44830xnccZg','loggerService','cleanOldLogs','990iGexnD','log','logWebhookError','webhooks_processed','__importDefault','map','6499283hFOuKs','logPaymentCreated','white_domain_errors','Failed\x20to\x20write\x20','COINTOPAY_ERROR','8338950OMEmKg','8jpCmVu','payments_created','localeCompare','logWebhookProcessed','size','.log','length','getDate','Failed\x20to\x20clean\x20old\x20logs:','path','default','join','writeLog','logsDir','logWhiteDomainError','cointopay_errors','existsSync','readdirSync','unlinkSync','endsWith','stringify','mtime','logApiCall','stack'];a55_0x1959=function(){return _0x3f2044;};return a55_0x1959();}const a55_0x39b4d7=a55_0x525e;(function(_0x4e2f72,_0x3d158c){const _0x28c8d0=a55_0x525e,_0x2fd13d=_0x4e2f72();while(!![]){try{const _0x462555=parseInt(_0x28c8d0(0x1a0))/0x1*(-parseInt(_0x28c8d0(0x186))/0x2)+-parseInt(_0x28c8d0(0x173))/0x3*(parseInt(_0x28c8d0(0x189))/0x4)+parseInt(_0x28c8d0(0x193))/0x5*(parseInt(_0x28c8d0(0x1a3))/0x6)+-parseInt(_0x28c8d0(0x1a9))/0x7*(parseInt(_0x28c8d0(0x1af))/0x8)+-parseInt(_0x28c8d0(0x1ae))/0x9+-parseInt(_0x28c8d0(0x19c))/0xa+parseInt(_0x28c8d0(0x170))/0xb;if(_0x462555===_0x3d158c)break;else _0x2fd13d['push'](_0x2fd13d['shift']());}catch(_0xa82c51){_0x2fd13d['push'](_0x2fd13d['shift']());}}}(a55_0x1959,0xd8ce8));var __importDefault=this&&this[a55_0x39b4d7(0x1a7)]||function(_0x4f4037){const _0x13d5b6=a55_0x39b4d7;return _0x4f4037&&_0x4f4037[_0x13d5b6(0x18c)]?_0x4f4037:{'default':_0x4f4037};};Object[a55_0x39b4d7(0x19f)](exports,a55_0x39b4d7(0x18c),{'value':!![]}),exports[a55_0x39b4d7(0x1a1)]=exports['LoggerService']=void 0x0;const fs_1=__importDefault(require('fs')),path_1=__importDefault(require(a55_0x39b4d7(0x161)));function a55_0x525e(_0x4ab301,_0x4652f1){const _0x19594d=a55_0x1959();return a55_0x525e=function(_0x525e0f,_0x30e1db){_0x525e0f=_0x525e0f-0x161;let _0x5db794=_0x19594d[_0x525e0f];return _0x5db794;},a55_0x525e(_0x4ab301,_0x4652f1);}class LoggerService{constructor(){const _0x3980c7=a55_0x39b4d7;this[_0x3980c7(0x165)]=path_1[_0x3980c7(0x162)][_0x3980c7(0x163)](process[_0x3980c7(0x194)](),_0x3980c7(0x17d)),this['ensureLogsDirectory']();}[a55_0x39b4d7(0x176)](){const _0x369915=a55_0x39b4d7;!fs_1[_0x369915(0x162)][_0x369915(0x168)](this[_0x369915(0x165)])&&(fs_1[_0x369915(0x162)][_0x369915(0x195)](this[_0x369915(0x165)],{'recursive':!![]}),console[_0x369915(0x1a4)](_0x369915(0x188)+this[_0x369915(0x165)]));}[a55_0x39b4d7(0x17e)](_0x2074f4){const _0x5bc273=a55_0x39b4d7,_0xdea521=new Date()[_0x5bc273(0x19a)]()['split']('T')[0x0];return path_1['default'][_0x5bc273(0x163)](this[_0x5bc273(0x165)],_0x2074f4+'_'+_0xdea521+_0x5bc273(0x1b4));}[a55_0x39b4d7(0x164)](_0x100e12,_0x37e55a){const _0x248e36=a55_0x39b4d7;try{const _0x23dd8a=new Date()[_0x248e36(0x19a)](),_0x456b54={'timestamp':_0x23dd8a,..._0x37e55a},_0x3108bf=JSON[_0x248e36(0x16c)](_0x456b54)+'\x0a',_0x254fca=this[_0x248e36(0x17e)](_0x100e12);fs_1['default']['appendFileSync'](_0x254fca,_0x3108bf,'utf8');}catch(_0x5e18d3){console[_0x248e36(0x181)](_0x248e36(0x1ac)+_0x100e12+'\x20log:',_0x5e18d3);}}[a55_0x39b4d7(0x197)](_0x490ce1,_0x4668ab,_0x4ace33,_0x32b020){const _0x1e77bb=a55_0x39b4d7;this['writeLog'](_0x1e77bb(0x175),{'type':_0x1e77bb(0x178),'gateway':_0x490ce1,'endpoint':_0x4668ab,'method':_0x4ace33,'data':_0x32b020});}['logWhiteDomainResponse'](_0x570f4d,_0x54fc09,_0x166291,_0x4a7f02,_0x7a122d){const _0x41b6fe=a55_0x39b4d7;this[_0x41b6fe(0x164)](_0x41b6fe(0x191),{'type':_0x41b6fe(0x18f),'gateway':_0x570f4d,'endpoint':_0x54fc09,'status':_0x166291,'responseTime':_0x7a122d,'data':_0x4a7f02});}[a55_0x39b4d7(0x166)](_0xb291b7,_0x4a6482,_0x11131a){const _0xeb86f1=a55_0x39b4d7;this[_0xeb86f1(0x164)](_0xeb86f1(0x1ab),{'type':_0xeb86f1(0x18a),'gateway':_0xb291b7,'endpoint':_0x4a6482,'error':_0x11131a instanceof Error?{'message':_0x11131a[_0xeb86f1(0x177)],'stack':_0x11131a[_0xeb86f1(0x16f)]}:_0x11131a});}['logWebhookReceived'](_0x409dab,_0x2ea3e7,_0x4335ae){const _0x2b9be8=a55_0x39b4d7;this['writeLog']('webhooks_received',{'type':_0x2b9be8(0x17f),'gateway':_0x409dab,'headers':_0x4335ae,'data':_0x2ea3e7});}[a55_0x39b4d7(0x1b2)](_0x472c25,_0xf088a1,_0x437072,_0x2e8842,_0x1e7ef0){const _0x48410c=a55_0x39b4d7;this['writeLog'](_0x48410c(0x1a6),{'type':_0x48410c(0x185),'gateway':_0x472c25,'paymentId':_0xf088a1,'oldStatus':_0x437072,'newStatus':_0x2e8842,'originalData':_0x1e7ef0});}[a55_0x39b4d7(0x1a5)](_0x1ea750,_0x580e1e,_0x210c1a){const _0x807458=a55_0x39b4d7;this[_0x807458(0x164)](_0x807458(0x196),{'type':'WEBHOOK_ERROR','gateway':_0x1ea750,'error':_0x580e1e instanceof Error?{'message':_0x580e1e['message'],'stack':_0x580e1e[_0x807458(0x16f)]}:_0x580e1e,'originalData':_0x210c1a});}[a55_0x39b4d7(0x171)](_0x1b167e){const _0x2f288f=a55_0x39b4d7;this[_0x2f288f(0x164)](_0x2f288f(0x180),{'type':_0x2f288f(0x17a),..._0x1b167e});}[a55_0x39b4d7(0x179)](_0x5add9a){const _0x8341b9=a55_0x39b4d7;this['writeLog'](_0x8341b9(0x167),{'type':_0x8341b9(0x1ad),..._0x5add9a});}['logShopWebhookSent'](_0x5ea3de,_0x3b6e42,_0x502a11,_0x4a2568,_0x344c84,_0x393d23){const _0x13dbc6=a55_0x39b4d7;this['writeLog']('shop_webhooks_sent',{'type':_0x13dbc6(0x18b),'shopId':_0x5ea3de,'webhookUrl':_0x3b6e42,'event':_0x502a11,'status':_0x4a2568,'responseTime':_0x344c84,'payload':_0x393d23});}['logShopWebhookError'](_0x549a15,_0x182908,_0x4a5ba6,_0x5121d9,_0x126c30){const _0x22e44f=a55_0x39b4d7;this[_0x22e44f(0x164)](_0x22e44f(0x192),{'type':_0x22e44f(0x18d),'shopId':_0x549a15,'webhookUrl':_0x182908,'event':_0x4a5ba6,'error':_0x5121d9 instanceof Error?{'message':_0x5121d9['message'],'stack':_0x5121d9[_0x22e44f(0x16f)]}:_0x5121d9,'payload':_0x126c30});}[a55_0x39b4d7(0x1aa)](_0x2476e6,_0x268b83,_0x105d36,_0x5a0b32,_0x597f7b){const _0x451596=a55_0x39b4d7;this[_0x451596(0x164)](_0x451596(0x1b0),{'type':_0x451596(0x18e),'gateway':_0x2476e6,'paymentId':_0x268b83,'shopId':_0x105d36,'amount':_0x5a0b32,'currency':_0x597f7b});}[a55_0x39b4d7(0x16e)](_0x29d07b,_0x5c356f,_0x16485f,_0x368d2b,_0x7317a2){const _0x5f34cf=a55_0x39b4d7;this[_0x5f34cf(0x164)](_0x5f34cf(0x183),{'type':_0x5f34cf(0x17c),'endpoint':_0x29d07b,'method':_0x5c356f,'userId':_0x16485f,'userRole':_0x368d2b,'requestData':_0x7317a2});}['getLogStats'](){const _0x45eab8=a55_0x39b4d7;try{const _0x57ab10=fs_1[_0x45eab8(0x162)]['readdirSync'](this[_0x45eab8(0x165)]),_0x30ba1a=_0x57ab10['filter'](_0x49e64d=>_0x49e64d[_0x45eab8(0x16b)](_0x45eab8(0x1b4))),_0x21e26f=[...new Set(_0x30ba1a[_0x45eab8(0x1a8)](_0x2bfa77=>_0x2bfa77[_0x45eab8(0x174)]('_')[0x0]))],_0x14c9ab=_0x30ba1a[_0x45eab8(0x1a8)](_0x14d4d2=>{const _0x32452d=_0x45eab8,_0x2e4a06=path_1['default'][_0x32452d(0x163)](this[_0x32452d(0x165)],_0x14d4d2),_0x30b913=fs_1[_0x32452d(0x162)]['statSync'](_0x2e4a06),[_0x160291,_0x355f78]=_0x14d4d2[_0x32452d(0x19e)](_0x32452d(0x1b4),'')[_0x32452d(0x174)]('_');return{'type':_0x160291,'date':_0x355f78,'size':_0x30b913[_0x32452d(0x1b3)]};})[_0x45eab8(0x17b)]((_0x5ec2f2,_0x40f25b)=>_0x40f25b[_0x45eab8(0x182)][_0x45eab8(0x1b1)](_0x5ec2f2[_0x45eab8(0x182)]));return{'totalFiles':_0x30ba1a[_0x45eab8(0x1b5)],'logTypes':_0x21e26f,'latestLogs':_0x14c9ab[_0x45eab8(0x19b)](0x0,0xa)};}catch(_0xfc8100){return console[_0x45eab8(0x181)](_0x45eab8(0x19d),_0xfc8100),{'totalFiles':0x0,'logTypes':[],'latestLogs':[]};}}[a55_0x39b4d7(0x1a2)](_0x26e541=0x1e){const _0x4e9316=a55_0x39b4d7;try{const _0x16abfb=fs_1['default'][_0x4e9316(0x169)](this[_0x4e9316(0x165)]),_0x121d29=new Date();_0x121d29[_0x4e9316(0x199)](_0x121d29[_0x4e9316(0x1b6)]()-_0x26e541);let _0x24b404=0x0;_0x16abfb[_0x4e9316(0x187)](_0x245c3d=>{const _0x60f220=_0x4e9316;if(!_0x245c3d[_0x60f220(0x16b)](_0x60f220(0x1b4)))return;const _0x3db99d=path_1['default'][_0x60f220(0x163)](this[_0x60f220(0x165)],_0x245c3d),_0x215e71=fs_1[_0x60f220(0x162)][_0x60f220(0x184)](_0x3db99d);_0x215e71[_0x60f220(0x16d)]<_0x121d29&&(fs_1[_0x60f220(0x162)][_0x60f220(0x16a)](_0x3db99d),_0x24b404++,console['log'](_0x60f220(0x198)+_0x245c3d));}),console[_0x4e9316(0x1a4)](_0x4e9316(0x190)+_0x24b404+_0x4e9316(0x172)+_0x26e541+'\x20days)');}catch(_0x3d615f){console[_0x4e9316(0x181)](_0x4e9316(0x1b7),_0x3d615f);}}}exports['LoggerService']=LoggerService,exports[a55_0x39b4d7(0x1a1)]=new LoggerService();