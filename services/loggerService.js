'use strict';const a44_0x3863f9=a44_0x2dd9;(function(_0x6a1e35,_0x354608){const _0x24a119=a44_0x2dd9,_0x453169=_0x6a1e35();while(!![]){try{const _0xe6d640=parseInt(_0x24a119(0xe7))/0x1*(-parseInt(_0x24a119(0xd7))/0x2)+parseInt(_0x24a119(0xe6))/0x3+-parseInt(_0x24a119(0xb0))/0x4+parseInt(_0x24a119(0xad))/0x5+parseInt(_0x24a119(0xce))/0x6+-parseInt(_0x24a119(0xcc))/0x7+parseInt(_0x24a119(0xa9))/0x8;if(_0xe6d640===_0x354608)break;else _0x453169['push'](_0x453169['shift']());}catch(_0x19f19d){_0x453169['push'](_0x453169['shift']());}}}(a44_0x577b,0x36c35));var __importDefault=this&&this[a44_0x3863f9(0xd1)]||function(_0x138ec6){const _0xb0a80f=a44_0x3863f9;return _0x138ec6&&_0x138ec6[_0xb0a80f(0xeb)]?_0x138ec6:{'default':_0x138ec6};};Object['defineProperty'](exports,a44_0x3863f9(0xeb),{'value':!![]}),exports[a44_0x3863f9(0xb1)]=exports[a44_0x3863f9(0xc2)]=void 0x0;function a44_0x577b(){const _0x27df1d=['stack','utf8','1203546OVyTer','1UHYUgJ','endsWith','cwd','ERROR','__esModule','slice','appendFileSync','shop_webhooks_errors','logWebhookProcessed','existsSync','setDate','ensureLogsDirectory','\x20days)','forEach','PAYMENT_CREATED','2034248dlTdbq','REQUEST','logs','path','344285WRXaYJ','getLogFileName','api_calls','297264dbaWek','loggerService','white_domain_errors','Failed\x20to\x20get\x20log\x20stats:','size','logsDir','logShopWebhookError','message','error','.log','map','Failed\x20to\x20clean\x20old\x20logs:','toISOString','length','logPaymentCreated','ðŸ“\x20Created\x20logs\x20directory:\x20','cleanOldLogs','\x20log:','LoggerService','shop_webhooks_sent','webhooks_received','readdirSync','filter','writeLog','getDate','default','join','WEBHOOK_ERROR','2708552PfNgAT','\x20old\x20log\x20files\x20(older\x20than\x20','1972260EIshho','white_domain_responses','RESPONSE','__importDefault','split','log','webhooks_processed','white_domain_requests','statSync','734938JGfcWy','SHOP_WEBHOOK_ERROR','logWhiteDomainRequest','WEBHOOK_RECEIVED','sort','mtime','getLogStats','date','logShopWebhookSent','webhooks_errors','unlinkSync','logWebhookError','WEBHOOK_PROCESSED'];a44_0x577b=function(){return _0x27df1d;};return a44_0x577b();}const fs_1=__importDefault(require('fs')),path_1=__importDefault(require(a44_0x3863f9(0xac)));function a44_0x2dd9(_0xc3430b,_0x44987b){const _0x577b9f=a44_0x577b();return a44_0x2dd9=function(_0x2dd9c9,_0x3bfd0d){_0x2dd9c9=_0x2dd9c9-0xa8;let _0x50cd62=_0x577b9f[_0x2dd9c9];return _0x50cd62;},a44_0x2dd9(_0xc3430b,_0x44987b);}class LoggerService{constructor(){const _0x3fd584=a44_0x3863f9;this['logsDir']=path_1[_0x3fd584(0xc9)][_0x3fd584(0xca)](process[_0x3fd584(0xe9)](),_0x3fd584(0xab)),this[_0x3fd584(0xf2)]();}[a44_0x3863f9(0xf2)](){const _0x23082f=a44_0x3863f9;!fs_1[_0x23082f(0xc9)][_0x23082f(0xf0)](this[_0x23082f(0xb5)])&&(fs_1[_0x23082f(0xc9)]['mkdirSync'](this[_0x23082f(0xb5)],{'recursive':!![]}),console[_0x23082f(0xd3)](_0x23082f(0xbf)+this['logsDir']));}[a44_0x3863f9(0xae)](_0x1c06d6){const _0x1912c7=a44_0x3863f9,_0x3902d0=new Date()[_0x1912c7(0xbc)]()['split']('T')[0x0];return path_1[_0x1912c7(0xc9)][_0x1912c7(0xca)](this['logsDir'],_0x1c06d6+'_'+_0x3902d0+_0x1912c7(0xb9));}[a44_0x3863f9(0xc7)](_0x5c3d6f,_0x457a29){const _0x311acc=a44_0x3863f9;try{const _0x316d46=new Date()[_0x311acc(0xbc)](),_0x223a66={'timestamp':_0x316d46,..._0x457a29},_0x3b1cec=JSON['stringify'](_0x223a66)+'\x0a',_0x515919=this[_0x311acc(0xae)](_0x5c3d6f);fs_1['default'][_0x311acc(0xed)](_0x515919,_0x3b1cec,_0x311acc(0xe5));}catch(_0x51fd91){console['error']('Failed\x20to\x20write\x20'+_0x5c3d6f+_0x311acc(0xc1),_0x51fd91);}}[a44_0x3863f9(0xd9)](_0x34b7f2,_0x2d7d23,_0x38023e,_0x5db1b0){const _0x2f1f1f=a44_0x3863f9;this['writeLog'](_0x2f1f1f(0xd5),{'type':_0x2f1f1f(0xaa),'gateway':_0x34b7f2,'endpoint':_0x2d7d23,'method':_0x38023e,'data':_0x5db1b0});}['logWhiteDomainResponse'](_0x5c1b28,_0x33464b,_0x5992a8,_0x63c003,_0x2342d0){const _0x4b7c6e=a44_0x3863f9;this[_0x4b7c6e(0xc7)](_0x4b7c6e(0xcf),{'type':_0x4b7c6e(0xd0),'gateway':_0x5c1b28,'endpoint':_0x33464b,'status':_0x5992a8,'responseTime':_0x2342d0,'data':_0x63c003});}['logWhiteDomainError'](_0x49cda9,_0x36bb49,_0x2e9d37){const _0x2a4c8b=a44_0x3863f9;this[_0x2a4c8b(0xc7)](_0x2a4c8b(0xb2),{'type':_0x2a4c8b(0xea),'gateway':_0x49cda9,'endpoint':_0x36bb49,'error':_0x2e9d37 instanceof Error?{'message':_0x2e9d37['message'],'stack':_0x2e9d37[_0x2a4c8b(0xe4)]}:_0x2e9d37});}['logWebhookReceived'](_0x207e12,_0x5026c6,_0x47e7c3){const _0x219bf4=a44_0x3863f9;this['writeLog'](_0x219bf4(0xc4),{'type':_0x219bf4(0xda),'gateway':_0x207e12,'headers':_0x47e7c3,'data':_0x5026c6});}[a44_0x3863f9(0xef)](_0x35ea48,_0x8cfa00,_0x5d6dc1,_0x3bdb28,_0x5b45ce){const _0x2fd1e7=a44_0x3863f9;this[_0x2fd1e7(0xc7)](_0x2fd1e7(0xd4),{'type':_0x2fd1e7(0xe3),'gateway':_0x35ea48,'paymentId':_0x8cfa00,'oldStatus':_0x5d6dc1,'newStatus':_0x3bdb28,'originalData':_0x5b45ce});}[a44_0x3863f9(0xe2)](_0xcf450e,_0xc66ad7,_0xcbfdfc){const _0x3e06e4=a44_0x3863f9;this[_0x3e06e4(0xc7)](_0x3e06e4(0xe0),{'type':_0x3e06e4(0xcb),'gateway':_0xcf450e,'error':_0xc66ad7 instanceof Error?{'message':_0xc66ad7[_0x3e06e4(0xb7)],'stack':_0xc66ad7[_0x3e06e4(0xe4)]}:_0xc66ad7,'originalData':_0xcbfdfc});}[a44_0x3863f9(0xdf)](_0x213e0e,_0x27767d,_0x3aadc6,_0x3e3038,_0x5e58c1,_0x4f6886){const _0x185d36=a44_0x3863f9;this[_0x185d36(0xc7)](_0x185d36(0xc3),{'type':'SHOP_WEBHOOK_SENT','shopId':_0x213e0e,'webhookUrl':_0x27767d,'event':_0x3aadc6,'status':_0x3e3038,'responseTime':_0x5e58c1,'payload':_0x4f6886});}[a44_0x3863f9(0xb6)](_0x28b511,_0x3b3c19,_0x57cf44,_0x48c2f3,_0x3414b3){const _0xede706=a44_0x3863f9;this[_0xede706(0xc7)](_0xede706(0xee),{'type':_0xede706(0xd8),'shopId':_0x28b511,'webhookUrl':_0x3b3c19,'event':_0x57cf44,'error':_0x48c2f3 instanceof Error?{'message':_0x48c2f3[_0xede706(0xb7)],'stack':_0x48c2f3[_0xede706(0xe4)]}:_0x48c2f3,'payload':_0x3414b3});}[a44_0x3863f9(0xbe)](_0x21e7f5,_0x23cdd4,_0x3253a0,_0x371357,_0x45a2f5){const _0x4d6255=a44_0x3863f9;this['writeLog']('payments_created',{'type':_0x4d6255(0xa8),'gateway':_0x21e7f5,'paymentId':_0x23cdd4,'shopId':_0x3253a0,'amount':_0x371357,'currency':_0x45a2f5});}['logApiCall'](_0x3cdeaa,_0x5ed22b,_0xe9c88a,_0x32ac49,_0x220c23){const _0x33e241=a44_0x3863f9;this[_0x33e241(0xc7)](_0x33e241(0xaf),{'type':'API_CALL','endpoint':_0x3cdeaa,'method':_0x5ed22b,'userId':_0xe9c88a,'userRole':_0x32ac49,'requestData':_0x220c23});}[a44_0x3863f9(0xdd)](){const _0x1ae3d2=a44_0x3863f9;try{const _0x4e0a88=fs_1['default'][_0x1ae3d2(0xc5)](this['logsDir']),_0x233fc8=_0x4e0a88[_0x1ae3d2(0xc6)](_0x1f13f1=>_0x1f13f1[_0x1ae3d2(0xe8)](_0x1ae3d2(0xb9))),_0xd77e5a=[...new Set(_0x233fc8[_0x1ae3d2(0xba)](_0x34bb4a=>_0x34bb4a['split']('_')[0x0]))],_0x4ef29a=_0x233fc8['map'](_0x336dd6=>{const _0x2f09f8=_0x1ae3d2,_0x39c43a=path_1[_0x2f09f8(0xc9)]['join'](this[_0x2f09f8(0xb5)],_0x336dd6),_0x4f57da=fs_1[_0x2f09f8(0xc9)]['statSync'](_0x39c43a),[_0x729b69,_0x5254cc]=_0x336dd6['replace'](_0x2f09f8(0xb9),'')[_0x2f09f8(0xd2)]('_');return{'type':_0x729b69,'date':_0x5254cc,'size':_0x4f57da[_0x2f09f8(0xb4)]};})[_0x1ae3d2(0xdb)]((_0x4ed1b7,_0x3f76d6)=>_0x3f76d6[_0x1ae3d2(0xde)]['localeCompare'](_0x4ed1b7[_0x1ae3d2(0xde)]));return{'totalFiles':_0x233fc8[_0x1ae3d2(0xbd)],'logTypes':_0xd77e5a,'latestLogs':_0x4ef29a[_0x1ae3d2(0xec)](0x0,0xa)};}catch(_0x27b5cc){return console[_0x1ae3d2(0xb8)](_0x1ae3d2(0xb3),_0x27b5cc),{'totalFiles':0x0,'logTypes':[],'latestLogs':[]};}}[a44_0x3863f9(0xc0)](_0x9244ff=0x1e){const _0x4dc28b=a44_0x3863f9;try{const _0x12f458=fs_1[_0x4dc28b(0xc9)]['readdirSync'](this['logsDir']),_0x5dbf0b=new Date();_0x5dbf0b[_0x4dc28b(0xf1)](_0x5dbf0b[_0x4dc28b(0xc8)]()-_0x9244ff);let _0x18e2e9=0x0;_0x12f458[_0x4dc28b(0xf4)](_0x566a1d=>{const _0x2846d1=_0x4dc28b;if(!_0x566a1d['endsWith'](_0x2846d1(0xb9)))return;const _0x5b021a=path_1[_0x2846d1(0xc9)][_0x2846d1(0xca)](this['logsDir'],_0x566a1d),_0x55f76b=fs_1[_0x2846d1(0xc9)][_0x2846d1(0xd6)](_0x5b021a);_0x55f76b[_0x2846d1(0xdc)]<_0x5dbf0b&&(fs_1[_0x2846d1(0xc9)][_0x2846d1(0xe1)](_0x5b021a),_0x18e2e9++,console['log']('ðŸ—‘ï¸\x20Deleted\x20old\x20log\x20file:\x20'+_0x566a1d));}),console['log']('ðŸ§¹\x20Cleaned\x20'+_0x18e2e9+_0x4dc28b(0xcd)+_0x9244ff+_0x4dc28b(0xf3));}catch(_0x13bfa0){console[_0x4dc28b(0xb8)](_0x4dc28b(0xbb),_0x13bfa0);}}}exports[a44_0x3863f9(0xc2)]=LoggerService,exports[a44_0x3863f9(0xb1)]=new LoggerService();