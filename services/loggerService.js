'use strict';function a44_0x5e5b(_0x59ea60,_0x5a36a4){const _0x432709=a44_0x4327();return a44_0x5e5b=function(_0x5e5be1,_0x4ae0bb){_0x5e5be1=_0x5e5be1-0x13c;let _0x407fd7=_0x432709[_0x5e5be1];return _0x407fd7;},a44_0x5e5b(_0x59ea60,_0x5a36a4);}const a44_0x2fb84e=a44_0x5e5b;(function(_0x3e6576,_0x387f3){const _0x54b0cd=a44_0x5e5b,_0x1fcc3c=_0x3e6576();while(!![]){try{const _0x5b7eb5=-parseInt(_0x54b0cd(0x171))/0x1*(parseInt(_0x54b0cd(0x187))/0x2)+-parseInt(_0x54b0cd(0x16d))/0x3*(parseInt(_0x54b0cd(0x146))/0x4)+-parseInt(_0x54b0cd(0x15e))/0x5*(parseInt(_0x54b0cd(0x174))/0x6)+parseInt(_0x54b0cd(0x17d))/0x7*(parseInt(_0x54b0cd(0x15a))/0x8)+-parseInt(_0x54b0cd(0x144))/0x9+parseInt(_0x54b0cd(0x181))/0xa+parseInt(_0x54b0cd(0x17c))/0xb*(parseInt(_0x54b0cd(0x154))/0xc);if(_0x5b7eb5===_0x387f3)break;else _0x1fcc3c['push'](_0x1fcc3c['shift']());}catch(_0x3bd696){_0x1fcc3c['push'](_0x1fcc3c['shift']());}}}(a44_0x4327,0x37cef));var __importDefault=this&&this[a44_0x2fb84e(0x152)]||function(_0x3c67f5){return _0x3c67f5&&_0x3c67f5['__esModule']?_0x3c67f5:{'default':_0x3c67f5};};Object[a44_0x2fb84e(0x189)](exports,a44_0x2fb84e(0x14a),{'value':!![]}),exports['loggerService']=exports[a44_0x2fb84e(0x160)]=void 0x0;const fs_1=__importDefault(require('fs')),path_1=__importDefault(require(a44_0x2fb84e(0x14f)));function a44_0x4327(){const _0x5ad5bb=['WEBHOOK_PROCESSED','SHOP_WEBHOOK_SENT','Failed\x20to\x20clean\x20old\x20logs:','logWebhookProcessed','2wakyoL','logPaymentCreated','defineProperty','split','Failed\x20to\x20write\x20','readdirSync','loggerService','length','map','COINTOPAY_ERROR','SHOP_WEBHOOK_ERROR','webhooks_received','getDate','Failed\x20to\x20get\x20log\x20stats:','ensureLogsDirectory','.log','shop_webhooks_sent','RESPONSE','3368430HFidTV','log','22048tyblXN','statSync','getLogFileName','white_domain_responses','__esModule','writeLog','replace','endsWith','utf8','path','cointopay_errors','size','__importDefault','stringify','96bFUfTH','COINTOPAY_STATUS_CHANGE','API_CALL','ðŸ—‘ï¸\x20Deleted\x20old\x20log\x20file:\x20','cointopay_status_changes','white_domain_errors','2759832JboMKC','logWebhookReceived','filter','logs','15nEohRe','white_domain_requests','LoggerService','toISOString','webhooks_errors','\x20old\x20log\x20files\x20(older\x20than\x20','\x20days)','forEach','join','logCoinToPayError','logWhiteDomainResponse','ðŸ“\x20Created\x20logs\x20directory:\x20','logApiCall','cwd','\x20log:','6niAcBU','logShopWebhookSent','ðŸ§¹\x20Cleaned\x20','cleanOldLogs','55759ZHKFGw','sort','shop_webhooks_errors','887766tCDLqY','message','logCoinToPayStatus','logsDir','error','getLogStats','stack','api_calls','857197esjrqf','7FdXMix','WEBHOOK_ERROR','default','existsSync','1451320pTVROx','logWhiteDomainRequest'];a44_0x4327=function(){return _0x5ad5bb;};return a44_0x4327();}class LoggerService{constructor(){const _0x2a794=a44_0x2fb84e;this[_0x2a794(0x177)]=path_1[_0x2a794(0x17f)][_0x2a794(0x166)](process[_0x2a794(0x16b)](),_0x2a794(0x15d)),this['ensureLogsDirectory']();}[a44_0x2fb84e(0x140)](){const _0xf0a487=a44_0x2fb84e;!fs_1[_0xf0a487(0x17f)][_0xf0a487(0x180)](this[_0xf0a487(0x177)])&&(fs_1['default']['mkdirSync'](this[_0xf0a487(0x177)],{'recursive':!![]}),console[_0xf0a487(0x145)](_0xf0a487(0x169)+this[_0xf0a487(0x177)]));}[a44_0x2fb84e(0x148)](_0x4943f3){const _0x1a3162=a44_0x2fb84e,_0x5dfac9=new Date()[_0x1a3162(0x161)]()[_0x1a3162(0x18a)]('T')[0x0];return path_1['default']['join'](this[_0x1a3162(0x177)],_0x4943f3+'_'+_0x5dfac9+'.log');}['writeLog'](_0xbd704,_0x3a7737){const _0x4fb5db=a44_0x2fb84e;try{const _0x4261bf=new Date()[_0x4fb5db(0x161)](),_0xb989e7={'timestamp':_0x4261bf,..._0x3a7737},_0x5472eb=JSON[_0x4fb5db(0x153)](_0xb989e7)+'\x0a',_0x186268=this[_0x4fb5db(0x148)](_0xbd704);fs_1[_0x4fb5db(0x17f)]['appendFileSync'](_0x186268,_0x5472eb,_0x4fb5db(0x14e));}catch(_0x154405){console[_0x4fb5db(0x178)](_0x4fb5db(0x18b)+_0xbd704+_0x4fb5db(0x16c),_0x154405);}}[a44_0x2fb84e(0x182)](_0x24ce13,_0x19b961,_0x23e537,_0x3ef2f3){const _0x2f5408=a44_0x2fb84e;this[_0x2f5408(0x14b)](_0x2f5408(0x15f),{'type':'REQUEST','gateway':_0x24ce13,'endpoint':_0x19b961,'method':_0x23e537,'data':_0x3ef2f3});}[a44_0x2fb84e(0x168)](_0x3844b5,_0xc91097,_0x48fc65,_0x2aa0bd,_0x1b2d2a){const _0x4f8a33=a44_0x2fb84e;this[_0x4f8a33(0x14b)](_0x4f8a33(0x149),{'type':_0x4f8a33(0x143),'gateway':_0x3844b5,'endpoint':_0xc91097,'status':_0x48fc65,'responseTime':_0x1b2d2a,'data':_0x2aa0bd});}['logWhiteDomainError'](_0x2805ad,_0x281fa3,_0x10df4c){const _0x439c7d=a44_0x2fb84e;this[_0x439c7d(0x14b)](_0x439c7d(0x159),{'type':'ERROR','gateway':_0x2805ad,'endpoint':_0x281fa3,'error':_0x10df4c instanceof Error?{'message':_0x10df4c[_0x439c7d(0x175)],'stack':_0x10df4c[_0x439c7d(0x17a)]}:_0x10df4c});}[a44_0x2fb84e(0x15b)](_0x1e483a,_0x5518b3,_0x2b6b32){const _0x26d7f6=a44_0x2fb84e;this['writeLog'](_0x26d7f6(0x13d),{'type':'WEBHOOK_RECEIVED','gateway':_0x1e483a,'headers':_0x2b6b32,'data':_0x5518b3});}[a44_0x2fb84e(0x186)](_0x28bcd9,_0x4b12bd,_0x4f1d49,_0x55726c,_0x4bf5a3){const _0x4e8c48=a44_0x2fb84e;this[_0x4e8c48(0x14b)]('webhooks_processed',{'type':_0x4e8c48(0x183),'gateway':_0x28bcd9,'paymentId':_0x4b12bd,'oldStatus':_0x4f1d49,'newStatus':_0x55726c,'originalData':_0x4bf5a3});}['logWebhookError'](_0x1d0896,_0x5d6016,_0x3358e9){const _0xeb9361=a44_0x2fb84e;this['writeLog'](_0xeb9361(0x162),{'type':_0xeb9361(0x17e),'gateway':_0x1d0896,'error':_0x5d6016 instanceof Error?{'message':_0x5d6016['message'],'stack':_0x5d6016[_0xeb9361(0x17a)]}:_0x5d6016,'originalData':_0x3358e9});}[a44_0x2fb84e(0x176)](_0x4531ae){const _0x46f864=a44_0x2fb84e;this[_0x46f864(0x14b)](_0x46f864(0x158),{'type':_0x46f864(0x155),..._0x4531ae});}[a44_0x2fb84e(0x167)](_0x123f49){const _0x5ccce2=a44_0x2fb84e;this['writeLog'](_0x5ccce2(0x150),{'type':_0x5ccce2(0x190),..._0x123f49});}[a44_0x2fb84e(0x16e)](_0x1bf0f6,_0x577c14,_0x546e91,_0x3d8f7a,_0x194c6c,_0x2a06e8){const _0x9c5c21=a44_0x2fb84e;this[_0x9c5c21(0x14b)](_0x9c5c21(0x142),{'type':_0x9c5c21(0x184),'shopId':_0x1bf0f6,'webhookUrl':_0x577c14,'event':_0x546e91,'status':_0x3d8f7a,'responseTime':_0x194c6c,'payload':_0x2a06e8});}['logShopWebhookError'](_0x35b2b0,_0x4773af,_0x25b781,_0x2a086a,_0x1de22d){const _0x189753=a44_0x2fb84e;this[_0x189753(0x14b)](_0x189753(0x173),{'type':_0x189753(0x13c),'shopId':_0x35b2b0,'webhookUrl':_0x4773af,'event':_0x25b781,'error':_0x2a086a instanceof Error?{'message':_0x2a086a['message'],'stack':_0x2a086a[_0x189753(0x17a)]}:_0x2a086a,'payload':_0x1de22d});}[a44_0x2fb84e(0x188)](_0x3c0a09,_0x21306f,_0x18b360,_0x3a2782,_0x42ed21){const _0x15cf04=a44_0x2fb84e;this[_0x15cf04(0x14b)]('payments_created',{'type':'PAYMENT_CREATED','gateway':_0x3c0a09,'paymentId':_0x21306f,'shopId':_0x18b360,'amount':_0x3a2782,'currency':_0x42ed21});}[a44_0x2fb84e(0x16a)](_0x5ef907,_0x5333d2,_0x34d4ad,_0x45890f,_0x4e8b53){const _0x254149=a44_0x2fb84e;this[_0x254149(0x14b)](_0x254149(0x17b),{'type':_0x254149(0x156),'endpoint':_0x5ef907,'method':_0x5333d2,'userId':_0x34d4ad,'userRole':_0x45890f,'requestData':_0x4e8b53});}[a44_0x2fb84e(0x179)](){const _0x1f511c=a44_0x2fb84e;try{const _0x25b5dd=fs_1[_0x1f511c(0x17f)][_0x1f511c(0x18c)](this[_0x1f511c(0x177)]),_0x15e94f=_0x25b5dd[_0x1f511c(0x15c)](_0x4cb8b0=>_0x4cb8b0[_0x1f511c(0x14d)](_0x1f511c(0x141))),_0x58b381=[...new Set(_0x15e94f[_0x1f511c(0x18f)](_0x404e17=>_0x404e17[_0x1f511c(0x18a)]('_')[0x0]))],_0x13917b=_0x15e94f[_0x1f511c(0x18f)](_0x58d002=>{const _0x245702=_0x1f511c,_0x30ba84=path_1[_0x245702(0x17f)][_0x245702(0x166)](this[_0x245702(0x177)],_0x58d002),_0x32e0f4=fs_1['default'][_0x245702(0x147)](_0x30ba84),[_0x3d86d9,_0x53c2dd]=_0x58d002[_0x245702(0x14c)]('.log','')[_0x245702(0x18a)]('_');return{'type':_0x3d86d9,'date':_0x53c2dd,'size':_0x32e0f4[_0x245702(0x151)]};})[_0x1f511c(0x172)]((_0x4e24e0,_0x529fcd)=>_0x529fcd['date']['localeCompare'](_0x4e24e0['date']));return{'totalFiles':_0x15e94f[_0x1f511c(0x18e)],'logTypes':_0x58b381,'latestLogs':_0x13917b['slice'](0x0,0xa)};}catch(_0x1563ab){return console[_0x1f511c(0x178)](_0x1f511c(0x13f),_0x1563ab),{'totalFiles':0x0,'logTypes':[],'latestLogs':[]};}}[a44_0x2fb84e(0x170)](_0x3a28d9=0x1e){const _0x5185a4=a44_0x2fb84e;try{const _0x58000d=fs_1[_0x5185a4(0x17f)][_0x5185a4(0x18c)](this[_0x5185a4(0x177)]),_0x3799e0=new Date();_0x3799e0['setDate'](_0x3799e0[_0x5185a4(0x13e)]()-_0x3a28d9);let _0x1a00c3=0x0;_0x58000d[_0x5185a4(0x165)](_0x49fd34=>{const _0xfe7ca3=_0x5185a4;if(!_0x49fd34[_0xfe7ca3(0x14d)](_0xfe7ca3(0x141)))return;const _0x55a24f=path_1[_0xfe7ca3(0x17f)][_0xfe7ca3(0x166)](this['logsDir'],_0x49fd34),_0x18753c=fs_1['default'][_0xfe7ca3(0x147)](_0x55a24f);_0x18753c['mtime']<_0x3799e0&&(fs_1[_0xfe7ca3(0x17f)]['unlinkSync'](_0x55a24f),_0x1a00c3++,console[_0xfe7ca3(0x145)](_0xfe7ca3(0x157)+_0x49fd34));}),console[_0x5185a4(0x145)](_0x5185a4(0x16f)+_0x1a00c3+_0x5185a4(0x163)+_0x3a28d9+_0x5185a4(0x164));}catch(_0xfd7abe){console[_0x5185a4(0x178)](_0x5185a4(0x185),_0xfd7abe);}}}exports['LoggerService']=LoggerService,exports[a44_0x2fb84e(0x18d)]=new LoggerService();