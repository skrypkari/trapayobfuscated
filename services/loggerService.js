'use strict';const a59_0x57a14f=a59_0x5bdf;(function(_0x4caf46,_0xf432ba){const _0x510b4b=a59_0x5bdf,_0x1341bd=_0x4caf46();while(!![]){try{const _0x202beb=-parseInt(_0x510b4b(0x139))/0x1*(-parseInt(_0x510b4b(0x121))/0x2)+-parseInt(_0x510b4b(0x13c))/0x3*(-parseInt(_0x510b4b(0x103))/0x4)+-parseInt(_0x510b4b(0x127))/0x5+parseInt(_0x510b4b(0x151))/0x6*(-parseInt(_0x510b4b(0x117))/0x7)+parseInt(_0x510b4b(0x130))/0x8*(parseInt(_0x510b4b(0x136))/0x9)+parseInt(_0x510b4b(0x129))/0xa+-parseInt(_0x510b4b(0x128))/0xb*(parseInt(_0x510b4b(0x114))/0xc);if(_0x202beb===_0xf432ba)break;else _0x1341bd['push'](_0x1341bd['shift']());}catch(_0x3bc1be){_0x1341bd['push'](_0x1341bd['shift']());}}}(a59_0x4c02,0x81908));var __importDefault=this&&this[a59_0x57a14f(0x118)]||function(_0x2a9763){return _0x2a9763&&_0x2a9763['__esModule']?_0x2a9763:{'default':_0x2a9763};};Object[a59_0x57a14f(0x105)](exports,a59_0x57a14f(0x132),{'value':!![]}),exports[a59_0x57a14f(0x11e)]=exports[a59_0x57a14f(0x125)]=void 0x0;const fs_1=__importDefault(require('fs')),path_1=__importDefault(require(a59_0x57a14f(0x13d)));class LoggerService{constructor(){const _0x1f493f=a59_0x57a14f;this[_0x1f493f(0x11f)]=path_1['default']['join'](process[_0x1f493f(0x12d)](),'logs'),this[_0x1f493f(0x10c)]();}['ensureLogsDirectory'](){const _0x28cd1e=a59_0x57a14f;!fs_1[_0x28cd1e(0x11a)]['existsSync'](this[_0x28cd1e(0x11f)])&&(fs_1[_0x28cd1e(0x11a)][_0x28cd1e(0x116)](this[_0x28cd1e(0x11f)],{'recursive':!![]}),console[_0x28cd1e(0x133)](_0x28cd1e(0x12c)+this[_0x28cd1e(0x11f)]));}[a59_0x57a14f(0x123)](_0x5103bc){const _0x5cfd43=a59_0x57a14f,_0x1a5019=new Date()[_0x5cfd43(0x153)]()['split']('T')[0x0];return path_1['default']['join'](this[_0x5cfd43(0x11f)],_0x5103bc+'_'+_0x1a5019+_0x5cfd43(0x104));}[a59_0x57a14f(0x10d)](_0x165a65,_0x15fe13){const _0x4304db=a59_0x57a14f;try{const _0x42eabf=new Date()[_0x4304db(0x153)](),_0x4a33a1={'timestamp':_0x42eabf,..._0x15fe13},_0xe9658c=JSON['stringify'](_0x4a33a1)+'\x0a',_0x2bc5bd=this['getLogFileName'](_0x165a65);fs_1['default'][_0x4304db(0x137)](_0x2bc5bd,_0xe9658c,'utf8');}catch(_0x441bd4){console['error'](_0x4304db(0x120)+_0x165a65+_0x4304db(0x115),_0x441bd4);}}[a59_0x57a14f(0x10a)](_0xdce2c3,_0x524c21,_0x453f8d,_0x4877f4){const _0xd3010b=a59_0x57a14f;this[_0xd3010b(0x10d)](_0xd3010b(0x12e),{'type':_0xd3010b(0x147),'gateway':_0xdce2c3,'endpoint':_0x524c21,'method':_0x453f8d,'data':_0x4877f4});}['logWhiteDomainResponse'](_0x4947dc,_0x482a7b,_0x3c6174,_0x2803b3,_0xb80126){const _0x19bf18=a59_0x57a14f;this[_0x19bf18(0x10d)]('white_domain_responses',{'type':_0x19bf18(0x111),'gateway':_0x4947dc,'endpoint':_0x482a7b,'status':_0x3c6174,'responseTime':_0xb80126,'data':_0x2803b3});}[a59_0x57a14f(0x143)](_0x43c8b9,_0xfd269,_0x1e2575){const _0x3e0e92=a59_0x57a14f;this[_0x3e0e92(0x10d)](_0x3e0e92(0x13a),{'type':'ERROR','gateway':_0x43c8b9,'endpoint':_0xfd269,'error':_0x1e2575 instanceof Error?{'message':_0x1e2575['message'],'stack':_0x1e2575[_0x3e0e92(0x12f)]}:_0x1e2575});}[a59_0x57a14f(0x119)](_0x2d1d45,_0x4a4667,_0x4e65e9){const _0x696b5d=a59_0x57a14f;this[_0x696b5d(0x10d)]('webhooks_received',{'type':_0x696b5d(0x10e),'gateway':_0x2d1d45,'headers':_0x4e65e9,'data':_0x4a4667});}[a59_0x57a14f(0x12a)](_0x215b3e,_0x510afe,_0x4ab71f,_0x367838,_0x4cb015){const _0xc1d040=a59_0x57a14f;this[_0xc1d040(0x10d)]('webhooks_processed',{'type':_0xc1d040(0x135),'gateway':_0x215b3e,'paymentId':_0x510afe,'oldStatus':_0x4ab71f,'newStatus':_0x367838,'originalData':_0x4cb015});}[a59_0x57a14f(0x11c)](_0x5f3494,_0x5d0075,_0x4c2292){const _0x1b58f9=a59_0x57a14f;this['writeLog'](_0x1b58f9(0x131),{'type':_0x1b58f9(0x14f),'gateway':_0x5f3494,'error':_0x5d0075 instanceof Error?{'message':_0x5d0075[_0x1b58f9(0x134)],'stack':_0x5d0075[_0x1b58f9(0x12f)]}:_0x5d0075,'originalData':_0x4c2292});}[a59_0x57a14f(0x10b)](_0x1ccfcb){const _0x2fb7f0=a59_0x57a14f;this['writeLog'](_0x2fb7f0(0x149),{'type':_0x2fb7f0(0x107),..._0x1ccfcb});}[a59_0x57a14f(0x140)](_0x30d641){const _0x5c9034=a59_0x57a14f;this[_0x5c9034(0x10d)](_0x5c9034(0x152),{'type':'COINTOPAY_ERROR',..._0x30d641});}[a59_0x57a14f(0x142)](_0x398021,_0x2e825d,_0x38cb0f,_0x18cd19,_0xb34c9b,_0x2afee3){const _0xeee430=a59_0x57a14f;this[_0xeee430(0x10d)](_0xeee430(0x146),{'type':'SHOP_WEBHOOK_SENT','shopId':_0x398021,'webhookUrl':_0x2e825d,'event':_0x38cb0f,'status':_0x18cd19,'responseTime':_0xb34c9b,'payload':_0x2afee3});}[a59_0x57a14f(0x14c)](_0x24daed,_0x1c5e96,_0x2d32d3,_0x51b023,_0x549d20){const _0x6d0da2=a59_0x57a14f;this[_0x6d0da2(0x10d)](_0x6d0da2(0x122),{'type':_0x6d0da2(0x148),'shopId':_0x24daed,'webhookUrl':_0x1c5e96,'event':_0x2d32d3,'error':_0x51b023 instanceof Error?{'message':_0x51b023[_0x6d0da2(0x134)],'stack':_0x51b023['stack']}:_0x51b023,'payload':_0x549d20});}[a59_0x57a14f(0x14e)](_0x2e3c40,_0x3f2e14,_0x2e0c74,_0x247b96,_0x258d73){const _0x4c7977=a59_0x57a14f;this[_0x4c7977(0x10d)](_0x4c7977(0x14b),{'type':_0x4c7977(0x11b),'gateway':_0x2e3c40,'paymentId':_0x3f2e14,'shopId':_0x2e0c74,'amount':_0x247b96,'currency':_0x258d73});}[a59_0x57a14f(0x10f)](_0x1d1cd8,_0x19e03f,_0x193bbd,_0xa6d9b2,_0x53723e){const _0x33312e=a59_0x57a14f;this[_0x33312e(0x10d)](_0x33312e(0x14d),{'type':_0x33312e(0x14a),'endpoint':_0x1d1cd8,'method':_0x19e03f,'userId':_0x193bbd,'userRole':_0xa6d9b2,'requestData':_0x53723e});}['getLogStats'](){const _0x46a448=a59_0x57a14f;try{const _0x3d95c7=fs_1[_0x46a448(0x11a)][_0x46a448(0x144)](this[_0x46a448(0x11f)]),_0x5b83ae=_0x3d95c7[_0x46a448(0x109)](_0x219ae8=>_0x219ae8['endsWith'](_0x46a448(0x104))),_0x4aa1c7=[...new Set(_0x5b83ae[_0x46a448(0x124)](_0x2a471a=>_0x2a471a[_0x46a448(0x102)]('_')[0x0]))],_0x15b228=_0x5b83ae[_0x46a448(0x124)](_0x142b9e=>{const _0x12af4f=_0x46a448,_0x3c09cd=path_1[_0x12af4f(0x11a)]['join'](this[_0x12af4f(0x11f)],_0x142b9e),_0x2e7272=fs_1[_0x12af4f(0x11a)][_0x12af4f(0x154)](_0x3c09cd),[_0x26e96a,_0x27a69d]=_0x142b9e[_0x12af4f(0x108)](_0x12af4f(0x104),'')[_0x12af4f(0x102)]('_');return{'type':_0x26e96a,'date':_0x27a69d,'size':_0x2e7272[_0x12af4f(0x110)]};})[_0x46a448(0x113)]((_0x7ab820,_0x1b882c)=>_0x1b882c['date'][_0x46a448(0x13e)](_0x7ab820[_0x46a448(0x150)]));return{'totalFiles':_0x5b83ae['length'],'logTypes':_0x4aa1c7,'latestLogs':_0x15b228['slice'](0x0,0xa)};}catch(_0xb5aac3){return console[_0x46a448(0x145)]('Failed\x20to\x20get\x20log\x20stats:',_0xb5aac3),{'totalFiles':0x0,'logTypes':[],'latestLogs':[]};}}[a59_0x57a14f(0x13f)](_0x4a7d1a=0x1e){const _0x5db124=a59_0x57a14f;try{const _0xb3d4a9=fs_1[_0x5db124(0x11a)]['readdirSync'](this[_0x5db124(0x11f)]),_0x7e028=new Date();_0x7e028[_0x5db124(0x112)](_0x7e028[_0x5db124(0x11d)]()-_0x4a7d1a);let _0x3fd417=0x0;_0xb3d4a9[_0x5db124(0x13b)](_0xf8594d=>{const _0x457df5=_0x5db124;if(!_0xf8594d[_0x457df5(0x12b)](_0x457df5(0x104)))return;const _0x108fce=path_1[_0x457df5(0x11a)]['join'](this[_0x457df5(0x11f)],_0xf8594d),_0x2ecc05=fs_1['default']['statSync'](_0x108fce);_0x2ecc05['mtime']<_0x7e028&&(fs_1[_0x457df5(0x11a)][_0x457df5(0x138)](_0x108fce),_0x3fd417++,console[_0x457df5(0x133)](_0x457df5(0x106)+_0xf8594d));}),console[_0x5db124(0x133)](_0x5db124(0x141)+_0x3fd417+'\x20old\x20log\x20files\x20(older\x20than\x20'+_0x4a7d1a+'\x20days)');}catch(_0x5a1858){console['error'](_0x5db124(0x126),_0x5a1858);}}}function a59_0x5bdf(_0x2fd563,_0x1ba2c1){const _0x4c02f0=a59_0x4c02();return a59_0x5bdf=function(_0x5bdf43,_0x53d8fa){_0x5bdf43=_0x5bdf43-0x102;let _0x370cf7=_0x4c02f0[_0x5bdf43];return _0x370cf7;},a59_0x5bdf(_0x2fd563,_0x1ba2c1);}exports['LoggerService']=LoggerService,exports['loggerService']=new LoggerService();function a59_0x4c02(){const _0x33ebc2=['logShopWebhookSent','logWhiteDomainError','readdirSync','error','shop_webhooks_sent','REQUEST','SHOP_WEBHOOK_ERROR','cointopay_status_changes','API_CALL','payments_created','logShopWebhookError','api_calls','logPaymentCreated','WEBHOOK_ERROR','date','163494kEJKBP','cointopay_errors','toISOString','statSync','split','32MamLXc','.log','defineProperty','🗑️\x20Deleted\x20old\x20log\x20file:\x20','COINTOPAY_STATUS_CHANGE','replace','filter','logWhiteDomainRequest','logCoinToPayStatus','ensureLogsDirectory','writeLog','WEBHOOK_RECEIVED','logApiCall','size','RESPONSE','setDate','sort','180nCpXgV','\x20log:','mkdirSync','49nOEFiC','__importDefault','logWebhookReceived','default','PAYMENT_CREATED','logWebhookError','getDate','loggerService','logsDir','Failed\x20to\x20write\x20','9754uemVqL','shop_webhooks_errors','getLogFileName','map','LoggerService','Failed\x20to\x20clean\x20old\x20logs:','2895230XMGcPQ','1334234OXDKGG','4272620rbDhhm','logWebhookProcessed','endsWith','📁\x20Created\x20logs\x20directory:\x20','cwd','white_domain_requests','stack','16RQMxpO','webhooks_errors','__esModule','log','message','WEBHOOK_PROCESSED','3106827lcjNUM','appendFileSync','unlinkSync','215fVAWmV','white_domain_errors','forEach','357627KKLoAh','path','localeCompare','cleanOldLogs','logCoinToPayError','🧹\x20Cleaned\x20'];a59_0x4c02=function(){return _0x33ebc2;};return a59_0x4c02();}