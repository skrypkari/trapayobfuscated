'use strict';const a48_0x18acc4=a48_0x1f2a;(function(_0x227260,_0x2c75d7){const _0x325953=a48_0x1f2a,_0x59f785=_0x227260();while(!![]){try{const _0xf0604b=parseInt(_0x325953(0x1f3))/0x1+-parseInt(_0x325953(0x1f4))/0x2+-parseInt(_0x325953(0x1dc))/0x3+-parseInt(_0x325953(0x1df))/0x4+-parseInt(_0x325953(0x1be))/0x5+-parseInt(_0x325953(0x1fa))/0x6+parseInt(_0x325953(0x1d9))/0x7*(parseInt(_0x325953(0x1e4))/0x8);if(_0xf0604b===_0x2c75d7)break;else _0x59f785['push'](_0x59f785['shift']());}catch(_0x1d4329){_0x59f785['push'](_0x59f785['shift']());}}}(a48_0x2aca,0x6aac9));function a48_0x1f2a(_0x273bfb,_0x26e3f4){const _0x2acab7=a48_0x2aca();return a48_0x1f2a=function(_0x1f2a73,_0x235c56){_0x1f2a73=_0x1f2a73-0x1b0;let _0x16fb8c=_0x2acab7[_0x1f2a73];return _0x16fb8c;},a48_0x1f2a(_0x273bfb,_0x26e3f4);}var __importDefault=this&&this[a48_0x18acc4(0x1c3)]||function(_0xa39974){const _0x10281c=a48_0x18acc4;return _0xa39974&&_0xa39974[_0x10281c(0x1d2)]?_0xa39974:{'default':_0xa39974};};Object[a48_0x18acc4(0x1c5)](exports,a48_0x18acc4(0x1d2),{'value':!![]}),exports[a48_0x18acc4(0x1fc)]=exports[a48_0x18acc4(0x1ce)]=void 0x0;const fs_1=__importDefault(require('fs')),path_1=__importDefault(require(a48_0x18acc4(0x1b1)));class LoggerService{constructor(){const _0x116065=a48_0x18acc4;this[_0x116065(0x1b5)]=path_1[_0x116065(0x1db)][_0x116065(0x1cf)](process[_0x116065(0x1f5)](),_0x116065(0x1cb)),this[_0x116065(0x1e9)]();}[a48_0x18acc4(0x1e9)](){const _0x16302e=a48_0x18acc4;!fs_1['default'][_0x16302e(0x1d1)](this[_0x16302e(0x1b5)])&&(fs_1[_0x16302e(0x1db)][_0x16302e(0x1e6)](this[_0x16302e(0x1b5)],{'recursive':!![]}),console[_0x16302e(0x1f7)]('📁\x20Created\x20logs\x20directory:\x20'+this['logsDir']));}[a48_0x18acc4(0x1e5)](_0x29b7a8){const _0x1a1c83=a48_0x18acc4,_0x131202=new Date()[_0x1a1c83(0x1b4)]()[_0x1a1c83(0x1c0)]('T')[0x0];return path_1[_0x1a1c83(0x1db)][_0x1a1c83(0x1cf)](this[_0x1a1c83(0x1b5)],_0x29b7a8+'_'+_0x131202+_0x1a1c83(0x1cd));}[a48_0x18acc4(0x1b0)](_0x5aa221,_0x5d44f8){const _0x4daf21=a48_0x18acc4;try{const _0x5651ed=new Date()[_0x4daf21(0x1b4)](),_0x5e6d50={'timestamp':_0x5651ed,..._0x5d44f8},_0x38e8fd=JSON[_0x4daf21(0x1b8)](_0x5e6d50)+'\x0a',_0x32d214=this[_0x4daf21(0x1e5)](_0x5aa221);fs_1['default'][_0x4daf21(0x1dd)](_0x32d214,_0x38e8fd,_0x4daf21(0x1bd));}catch(_0x57d0d7){console[_0x4daf21(0x1f6)](_0x4daf21(0x1da)+_0x5aa221+'\x20log:',_0x57d0d7);}}[a48_0x18acc4(0x1cc)](_0x3caf31,_0x16864b,_0x4df1d2,_0x2171ca){const _0x3530ef=a48_0x18acc4;this[_0x3530ef(0x1b0)]('white_domain_requests',{'type':_0x3530ef(0x1c1),'gateway':_0x3caf31,'endpoint':_0x16864b,'method':_0x4df1d2,'data':_0x2171ca});}['logWhiteDomainResponse'](_0x3f73d6,_0x2fe821,_0x8418db,_0xd5228d,_0xe41715){const _0x78ecad=a48_0x18acc4;this['writeLog'](_0x78ecad(0x1b6),{'type':_0x78ecad(0x1fb),'gateway':_0x3f73d6,'endpoint':_0x2fe821,'status':_0x8418db,'responseTime':_0xe41715,'data':_0xd5228d});}[a48_0x18acc4(0x1fe)](_0x45139e,_0xd3d183,_0x9164c5){const _0x50396e=a48_0x18acc4;this[_0x50396e(0x1b0)]('white_domain_errors',{'type':_0x50396e(0x1e1),'gateway':_0x45139e,'endpoint':_0xd3d183,'error':_0x9164c5 instanceof Error?{'message':_0x9164c5['message'],'stack':_0x9164c5[_0x50396e(0x1d7)]}:_0x9164c5});}['logWebhookReceived'](_0x292b20,_0x53a074,_0x31998e){const _0x36c18b=a48_0x18acc4;this[_0x36c18b(0x1b0)](_0x36c18b(0x1d0),{'type':_0x36c18b(0x1f2),'gateway':_0x292b20,'headers':_0x31998e,'data':_0x53a074});}[a48_0x18acc4(0x1e8)](_0xa3e6e8,_0x4d4a79,_0x3323cd,_0x3af2c8,_0x518555){const _0x23e5e1=a48_0x18acc4;this[_0x23e5e1(0x1b0)](_0x23e5e1(0x1c4),{'type':_0x23e5e1(0x1ee),'gateway':_0xa3e6e8,'paymentId':_0x4d4a79,'oldStatus':_0x3323cd,'newStatus':_0x3af2c8,'originalData':_0x518555});}[a48_0x18acc4(0x1b3)](_0x344522,_0x2d1344,_0x44fce2){const _0x58ad7c=a48_0x18acc4;this['writeLog'](_0x58ad7c(0x1b7),{'type':_0x58ad7c(0x1c6),'gateway':_0x344522,'error':_0x2d1344 instanceof Error?{'message':_0x2d1344[_0x58ad7c(0x1bf)],'stack':_0x2d1344[_0x58ad7c(0x1d7)]}:_0x2d1344,'originalData':_0x44fce2});}[a48_0x18acc4(0x1c8)](_0x45f7d3){const _0x30fa3b=a48_0x18acc4;this[_0x30fa3b(0x1b0)](_0x30fa3b(0x1e2),{'type':_0x30fa3b(0x1d5),..._0x45f7d3});}['logCoinToPayError'](_0x413cc2){const _0x412138=a48_0x18acc4;this[_0x412138(0x1b0)](_0x412138(0x1f9),{'type':'COINTOPAY_ERROR',..._0x413cc2});}['logShopWebhookSent'](_0x2e9ab0,_0x1fe4be,_0x5a9675,_0x4b68fd,_0x4b451f,_0x40b195){const _0x4edb3c=a48_0x18acc4;this[_0x4edb3c(0x1b0)](_0x4edb3c(0x1d6),{'type':_0x4edb3c(0x1c7),'shopId':_0x2e9ab0,'webhookUrl':_0x1fe4be,'event':_0x5a9675,'status':_0x4b68fd,'responseTime':_0x4b451f,'payload':_0x40b195});}['logShopWebhookError'](_0x286e3e,_0x467e4b,_0x266f67,_0x4a05fe,_0x1357c5){const _0x180cb7=a48_0x18acc4;this['writeLog']('shop_webhooks_errors',{'type':_0x180cb7(0x1ff),'shopId':_0x286e3e,'webhookUrl':_0x467e4b,'event':_0x266f67,'error':_0x4a05fe instanceof Error?{'message':_0x4a05fe[_0x180cb7(0x1bf)],'stack':_0x4a05fe[_0x180cb7(0x1d7)]}:_0x4a05fe,'payload':_0x1357c5});}[a48_0x18acc4(0x1de)](_0x204762,_0x3ebee6,_0x1a96c4,_0x4017ad,_0x525c3e){const _0x203187=a48_0x18acc4;this['writeLog'](_0x203187(0x1fd),{'type':'PAYMENT_CREATED','gateway':_0x204762,'paymentId':_0x3ebee6,'shopId':_0x1a96c4,'amount':_0x4017ad,'currency':_0x525c3e});}[a48_0x18acc4(0x1c9)](_0x13ad75,_0x2d64ff,_0x5a424c,_0x5478a0,_0x2b6cf9){const _0x43297a=a48_0x18acc4;this['writeLog'](_0x43297a(0x1ba),{'type':'API_CALL','endpoint':_0x13ad75,'method':_0x2d64ff,'userId':_0x5a424c,'userRole':_0x5478a0,'requestData':_0x2b6cf9});}[a48_0x18acc4(0x1c2)](){const _0x3a4ada=a48_0x18acc4;try{const _0x7ca834=fs_1[_0x3a4ada(0x1db)][_0x3a4ada(0x1eb)](this[_0x3a4ada(0x1b5)]),_0x1466b1=_0x7ca834['filter'](_0x57a7c3=>_0x57a7c3[_0x3a4ada(0x1f0)](_0x3a4ada(0x1cd))),_0x5971aa=[...new Set(_0x1466b1[_0x3a4ada(0x1e7)](_0x4c908d=>_0x4c908d['split']('_')[0x0]))],_0x3616f4=_0x1466b1[_0x3a4ada(0x1e7)](_0x290ade=>{const _0xf5ec5a=_0x3a4ada,_0x5a6f05=path_1[_0xf5ec5a(0x1db)][_0xf5ec5a(0x1cf)](this[_0xf5ec5a(0x1b5)],_0x290ade),_0x19587a=fs_1[_0xf5ec5a(0x1db)][_0xf5ec5a(0x1ed)](_0x5a6f05),[_0x59841c,_0x83956]=_0x290ade[_0xf5ec5a(0x1ca)]('.log','')[_0xf5ec5a(0x1c0)]('_');return{'type':_0x59841c,'date':_0x83956,'size':_0x19587a['size']};})[_0x3a4ada(0x1f1)]((_0x401f5f,_0x5a615a)=>_0x5a615a[_0x3a4ada(0x1bc)][_0x3a4ada(0x1ea)](_0x401f5f[_0x3a4ada(0x1bc)]));return{'totalFiles':_0x1466b1[_0x3a4ada(0x1ec)],'logTypes':_0x5971aa,'latestLogs':_0x3616f4[_0x3a4ada(0x1d3)](0x0,0xa)};}catch(_0x5a2052){return console[_0x3a4ada(0x1f6)](_0x3a4ada(0x1e3),_0x5a2052),{'totalFiles':0x0,'logTypes':[],'latestLogs':[]};}}['cleanOldLogs'](_0x4aa7f3=0x1e){const _0x1f5e9b=a48_0x18acc4;try{const _0x391b5e=fs_1['default']['readdirSync'](this[_0x1f5e9b(0x1b5)]),_0x45434a=new Date();_0x45434a[_0x1f5e9b(0x1d8)](_0x45434a[_0x1f5e9b(0x1f8)]()-_0x4aa7f3);let _0x3a1d42=0x0;_0x391b5e[_0x1f5e9b(0x1d4)](_0x49363d=>{const _0x236b21=_0x1f5e9b;if(!_0x49363d[_0x236b21(0x1f0)](_0x236b21(0x1cd)))return;const _0x35b868=path_1[_0x236b21(0x1db)][_0x236b21(0x1cf)](this['logsDir'],_0x49363d),_0x2ce2f9=fs_1[_0x236b21(0x1db)]['statSync'](_0x35b868);_0x2ce2f9['mtime']<_0x45434a&&(fs_1[_0x236b21(0x1db)][_0x236b21(0x1bb)](_0x35b868),_0x3a1d42++,console[_0x236b21(0x1f7)](_0x236b21(0x1ef)+_0x49363d));}),console[_0x1f5e9b(0x1f7)]('🧹\x20Cleaned\x20'+_0x3a1d42+_0x1f5e9b(0x1e0)+_0x4aa7f3+_0x1f5e9b(0x1b9));}catch(_0x328be7){console[_0x1f5e9b(0x1f6)](_0x1f5e9b(0x1b2),_0x328be7);}}}function a48_0x2aca(){const _0x355ee0=['message','split','REQUEST','getLogStats','__importDefault','webhooks_processed','defineProperty','WEBHOOK_ERROR','SHOP_WEBHOOK_SENT','logCoinToPayStatus','logApiCall','replace','logs','logWhiteDomainRequest','.log','LoggerService','join','webhooks_received','existsSync','__esModule','slice','forEach','COINTOPAY_STATUS_CHANGE','shop_webhooks_sent','stack','setDate','103894KlUfzE','Failed\x20to\x20write\x20','default','1293525kGdwUp','appendFileSync','logPaymentCreated','3360984whJWiT','\x20old\x20log\x20files\x20(older\x20than\x20','ERROR','cointopay_status_changes','Failed\x20to\x20get\x20log\x20stats:','1696pBHgpM','getLogFileName','mkdirSync','map','logWebhookProcessed','ensureLogsDirectory','localeCompare','readdirSync','length','statSync','WEBHOOK_PROCESSED','🗑️\x20Deleted\x20old\x20log\x20file:\x20','endsWith','sort','WEBHOOK_RECEIVED','323606xzGEFv','1468890QXTAFr','cwd','error','log','getDate','cointopay_errors','4807872AOkDTl','RESPONSE','loggerService','payments_created','logWhiteDomainError','SHOP_WEBHOOK_ERROR','writeLog','path','Failed\x20to\x20clean\x20old\x20logs:','logWebhookError','toISOString','logsDir','white_domain_responses','webhooks_errors','stringify','\x20days)','api_calls','unlinkSync','date','utf8','1129975ZfAYgd'];a48_0x2aca=function(){return _0x355ee0;};return a48_0x2aca();}exports['LoggerService']=LoggerService,exports['loggerService']=new LoggerService();