'use strict';const a43_0x4ea64e=a43_0x3a20;(function(_0x5097e7,_0x411152){const _0x436a5a=a43_0x3a20,_0x236ab2=_0x5097e7();while(!![]){try{const _0x3249f9=parseInt(_0x436a5a(0x6d))/0x1+parseInt(_0x436a5a(0x8d))/0x2+parseInt(_0x436a5a(0x6c))/0x3*(-parseInt(_0x436a5a(0xb2))/0x4)+-parseInt(_0x436a5a(0x9f))/0x5+parseInt(_0x436a5a(0x95))/0x6*(parseInt(_0x436a5a(0xa6))/0x7)+parseInt(_0x436a5a(0xb3))/0x8+-parseInt(_0x436a5a(0x77))/0x9*(parseInt(_0x436a5a(0xac))/0xa);if(_0x3249f9===_0x411152)break;else _0x236ab2['push'](_0x236ab2['shift']());}catch(_0xad56c4){_0x236ab2['push'](_0x236ab2['shift']());}}}(a43_0x2403,0x67b11));var __importDefault=this&&this[a43_0x4ea64e(0x7f)]||function(_0x1be679){return _0x1be679&&_0x1be679['__esModule']?_0x1be679:{'default':_0x1be679};};Object[a43_0x4ea64e(0x66)](exports,a43_0x4ea64e(0x96),{'value':!![]}),exports[a43_0x4ea64e(0x71)]=exports[a43_0x4ea64e(0xb1)]=void 0x0;const fs_1=__importDefault(require('fs')),path_1=__importDefault(require(a43_0x4ea64e(0x9a)));class LoggerService{constructor(){const _0x47e336=a43_0x4ea64e;this[_0x47e336(0xb8)]=path_1[_0x47e336(0x89)][_0x47e336(0x70)](process[_0x47e336(0x84)](),_0x47e336(0x6e)),this['ensureLogsDirectory']();}[a43_0x4ea64e(0x75)](){const _0x5d5f77=a43_0x4ea64e;!fs_1[_0x5d5f77(0x89)]['existsSync'](this[_0x5d5f77(0xb8)])&&(fs_1[_0x5d5f77(0x89)][_0x5d5f77(0x87)](this[_0x5d5f77(0xb8)],{'recursive':!![]}),console['log'](_0x5d5f77(0x8f)+this[_0x5d5f77(0xb8)]));}['getLogFileName'](_0x2d00c3){const _0x2e9a2b=a43_0x4ea64e,_0x37ba45=new Date()[_0x2e9a2b(0x7a)]()[_0x2e9a2b(0x83)]('T')[0x0];return path_1[_0x2e9a2b(0x89)][_0x2e9a2b(0x70)](this[_0x2e9a2b(0xb8)],_0x2d00c3+'_'+_0x37ba45+_0x2e9a2b(0x85));}[a43_0x4ea64e(0x91)](_0x42355e,_0x29b914){const _0x29d35c=a43_0x4ea64e;try{const _0x3f40a5=new Date()[_0x29d35c(0x7a)](),_0x5c9c45={'timestamp':_0x3f40a5,..._0x29b914},_0x172736=JSON[_0x29d35c(0xaa)](_0x5c9c45)+'\x0a',_0x37cdfa=this[_0x29d35c(0x68)](_0x42355e);fs_1[_0x29d35c(0x89)]['appendFileSync'](_0x37cdfa,_0x172736,'utf8');}catch(_0x3af3cd){console[_0x29d35c(0xb4)](_0x29d35c(0x74)+_0x42355e+_0x29d35c(0x8c),_0x3af3cd);}}[a43_0x4ea64e(0xa0)](_0x487b7f,_0x4ed109,_0x89680a,_0x307cf4){const _0x31be4b=a43_0x4ea64e;this['writeLog'](_0x31be4b(0xa4),{'type':_0x31be4b(0x99),'gateway':_0x487b7f,'endpoint':_0x4ed109,'method':_0x89680a,'data':_0x307cf4});}[a43_0x4ea64e(0x80)](_0xc56aa7,_0x14fdfa,_0x15fa9d,_0x52dc2c,_0x31a011){const _0xd1ba6b=a43_0x4ea64e;this[_0xd1ba6b(0x91)](_0xd1ba6b(0xa5),{'type':_0xd1ba6b(0x9e),'gateway':_0xc56aa7,'endpoint':_0x14fdfa,'status':_0x15fa9d,'responseTime':_0x31a011,'data':_0x52dc2c});}['logWhiteDomainError'](_0x221e62,_0x39195c,_0x4bdf1c){const _0x281ef5=a43_0x4ea64e;this[_0x281ef5(0x91)](_0x281ef5(0x86),{'type':'ERROR','gateway':_0x221e62,'endpoint':_0x39195c,'error':_0x4bdf1c instanceof Error?{'message':_0x4bdf1c[_0x281ef5(0x8b)],'stack':_0x4bdf1c[_0x281ef5(0xa9)]}:_0x4bdf1c});}[a43_0x4ea64e(0x67)](_0xde2658,_0x261ab2,_0x3404a1){const _0x3dfefb=a43_0x4ea64e;this[_0x3dfefb(0x91)](_0x3dfefb(0x92),{'type':_0x3dfefb(0x9b),'gateway':_0xde2658,'headers':_0x3404a1,'data':_0x261ab2});}[a43_0x4ea64e(0xa2)](_0xba5541,_0x516333,_0x3dc9e3,_0x77dcc0,_0x12c57b){const _0x3f5362=a43_0x4ea64e;this['writeLog'](_0x3f5362(0x7e),{'type':_0x3f5362(0x93),'gateway':_0xba5541,'paymentId':_0x516333,'oldStatus':_0x3dc9e3,'newStatus':_0x77dcc0,'originalData':_0x12c57b});}[a43_0x4ea64e(0x72)](_0x2d2e80,_0x4cf9dc,_0x42affb){const _0x3a45b3=a43_0x4ea64e;this[_0x3a45b3(0x91)](_0x3a45b3(0xa1),{'type':_0x3a45b3(0x7b),'gateway':_0x2d2e80,'error':_0x4cf9dc instanceof Error?{'message':_0x4cf9dc[_0x3a45b3(0x8b)],'stack':_0x4cf9dc[_0x3a45b3(0xa9)]}:_0x4cf9dc,'originalData':_0x42affb});}[a43_0x4ea64e(0xad)](_0x3b08da,_0x992dba,_0x2cb706,_0x3ce535,_0x2566ba,_0x3eed0b){const _0x372a96=a43_0x4ea64e;this[_0x372a96(0x91)]('shop_webhooks_sent',{'type':_0x372a96(0x73),'shopId':_0x3b08da,'webhookUrl':_0x992dba,'event':_0x2cb706,'status':_0x3ce535,'responseTime':_0x2566ba,'payload':_0x3eed0b});}[a43_0x4ea64e(0x9c)](_0x14ec5b,_0x4fd5bf,_0x145907,_0x4845c1,_0x594d8b){const _0x41e758=a43_0x4ea64e;this[_0x41e758(0x91)](_0x41e758(0x98),{'type':_0x41e758(0x94),'shopId':_0x14ec5b,'webhookUrl':_0x4fd5bf,'event':_0x145907,'error':_0x4845c1 instanceof Error?{'message':_0x4845c1[_0x41e758(0x8b)],'stack':_0x4845c1[_0x41e758(0xa9)]}:_0x4845c1,'payload':_0x594d8b});}[a43_0x4ea64e(0x90)](_0x55f4fa,_0x54faed,_0x298119,_0x3f5513,_0x47f104){const _0x3f7784=a43_0x4ea64e;this['writeLog']('payments_created',{'type':_0x3f7784(0xb5),'gateway':_0x55f4fa,'paymentId':_0x54faed,'shopId':_0x298119,'amount':_0x3f5513,'currency':_0x47f104});}[a43_0x4ea64e(0x76)](_0x207474,_0x2e779c,_0x10a4e3,_0x8126e7,_0x3d06bb){const _0x2beece=a43_0x4ea64e;this[_0x2beece(0x91)](_0x2beece(0x6f),{'type':_0x2beece(0x78),'endpoint':_0x207474,'method':_0x2e779c,'userId':_0x10a4e3,'userRole':_0x8126e7,'requestData':_0x3d06bb});}[a43_0x4ea64e(0xb0)](){const _0x3df8ab=a43_0x4ea64e;try{const _0x580735=fs_1[_0x3df8ab(0x89)]['readdirSync'](this[_0x3df8ab(0xb8)]),_0x53bc5c=_0x580735[_0x3df8ab(0xb6)](_0x449586=>_0x449586[_0x3df8ab(0xab)](_0x3df8ab(0x85))),_0x19bf60=[...new Set(_0x53bc5c[_0x3df8ab(0x9d)](_0x2098bb=>_0x2098bb['split']('_')[0x0]))],_0x51bdec=_0x53bc5c[_0x3df8ab(0x9d)](_0x2ca91e=>{const _0x551064=_0x3df8ab,_0x4beadc=path_1[_0x551064(0x89)]['join'](this[_0x551064(0xb8)],_0x2ca91e),_0x6df603=fs_1[_0x551064(0x89)][_0x551064(0x79)](_0x4beadc),[_0x5f01dd,_0x12b62a]=_0x2ca91e['replace'](_0x551064(0x85),'')[_0x551064(0x83)]('_');return{'type':_0x5f01dd,'date':_0x12b62a,'size':_0x6df603[_0x551064(0x97)]};})[_0x3df8ab(0x8a)]((_0x222071,_0x36f7a4)=>_0x36f7a4[_0x3df8ab(0x7d)][_0x3df8ab(0xb7)](_0x222071[_0x3df8ab(0x7d)]));return{'totalFiles':_0x53bc5c['length'],'logTypes':_0x19bf60,'latestLogs':_0x51bdec[_0x3df8ab(0x82)](0x0,0xa)};}catch(_0x408b6b){return console[_0x3df8ab(0xb4)](_0x3df8ab(0x7c),_0x408b6b),{'totalFiles':0x0,'logTypes':[],'latestLogs':[]};}}['cleanOldLogs'](_0x4e13ea=0x1e){const _0x32946b=a43_0x4ea64e;try{const _0x31b023=fs_1[_0x32946b(0x89)][_0x32946b(0x81)](this[_0x32946b(0xb8)]),_0xb15541=new Date();_0xb15541[_0x32946b(0xaf)](_0xb15541[_0x32946b(0x6a)]()-_0x4e13ea);let _0x189e6b=0x0;_0x31b023[_0x32946b(0x6b)](_0x1b3fd8=>{const _0x319626=_0x32946b;if(!_0x1b3fd8['endsWith'](_0x319626(0x85)))return;const _0x33b28f=path_1[_0x319626(0x89)][_0x319626(0x70)](this[_0x319626(0xb8)],_0x1b3fd8),_0x694d1a=fs_1[_0x319626(0x89)][_0x319626(0x79)](_0x33b28f);_0x694d1a[_0x319626(0x8e)]<_0xb15541&&(fs_1['default'][_0x319626(0x88)](_0x33b28f),_0x189e6b++,console[_0x319626(0xa3)](_0x319626(0x69)+_0x1b3fd8));}),console[_0x32946b(0xa3)]('ðŸ§¹\x20Cleaned\x20'+_0x189e6b+_0x32946b(0xa7)+_0x4e13ea+_0x32946b(0xae));}catch(_0x47a9b6){console[_0x32946b(0xb4)](_0x32946b(0xa8),_0x47a9b6);}}}function a43_0x3a20(_0xcd914c,_0x16467a){const _0x2403bd=a43_0x2403();return a43_0x3a20=function(_0x3a209f,_0xb30d36){_0x3a209f=_0x3a209f-0x66;let _0x4a0b9c=_0x2403bd[_0x3a209f];return _0x4a0b9c;},a43_0x3a20(_0xcd914c,_0x16467a);}exports[a43_0x4ea64e(0xb1)]=LoggerService,exports['loggerService']=new LoggerService();function a43_0x2403(){const _0x565fef=['Failed\x20to\x20get\x20log\x20stats:','date','webhooks_processed','__importDefault','logWhiteDomainResponse','readdirSync','slice','split','cwd','.log','white_domain_errors','mkdirSync','unlinkSync','default','sort','message','\x20log:','241874xKGiLb','mtime','ðŸ“\x20Created\x20logs\x20directory:\x20','logPaymentCreated','writeLog','webhooks_received','WEBHOOK_PROCESSED','SHOP_WEBHOOK_ERROR','27192CnfyoE','__esModule','size','shop_webhooks_errors','REQUEST','path','WEBHOOK_RECEIVED','logShopWebhookError','map','RESPONSE','4222675QvryyB','logWhiteDomainRequest','webhooks_errors','logWebhookProcessed','log','white_domain_requests','white_domain_responses','749LVvmKj','\x20old\x20log\x20files\x20(older\x20than\x20','Failed\x20to\x20clean\x20old\x20logs:','stack','stringify','endsWith','530IYtwvf','logShopWebhookSent','\x20days)','setDate','getLogStats','LoggerService','116HbtxZP','3763592EYJJCn','error','PAYMENT_CREATED','filter','localeCompare','logsDir','defineProperty','logWebhookReceived','getLogFileName','ðŸ—‘ï¸\x20Deleted\x20old\x20log\x20file:\x20','getDate','forEach','37866lHnZPQ','723973uIeTAW','logs','api_calls','join','loggerService','logWebhookError','SHOP_WEBHOOK_SENT','Failed\x20to\x20write\x20','ensureLogsDirectory','logApiCall','28017nEwfFU','API_CALL','statSync','toISOString','WEBHOOK_ERROR'];a43_0x2403=function(){return _0x565fef;};return a43_0x2403();}