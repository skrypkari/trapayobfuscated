'use strict';const a67_0x524aff=a67_0x1e08;(function(_0x21b0c1,_0x289abe){const _0x11ed01=a67_0x1e08,_0x1700e1=_0x21b0c1();while(!![]){try{const _0x5669a2=parseInt(_0x11ed01(0x1c1))/0x1*(-parseInt(_0x11ed01(0x1c4))/0x2)+parseInt(_0x11ed01(0x1eb))/0x3+-parseInt(_0x11ed01(0x1d3))/0x4+parseInt(_0x11ed01(0x1db))/0x5*(parseInt(_0x11ed01(0x1f4))/0x6)+parseInt(_0x11ed01(0x1f0))/0x7*(-parseInt(_0x11ed01(0x204))/0x8)+-parseInt(_0x11ed01(0x1b7))/0x9*(parseInt(_0x11ed01(0x1e3))/0xa)+parseInt(_0x11ed01(0x1ec))/0xb;if(_0x5669a2===_0x289abe)break;else _0x1700e1['push'](_0x1700e1['shift']());}catch(_0x4442f1){_0x1700e1['push'](_0x1700e1['shift']());}}}(a67_0x2ef2,0x21423));function a67_0x2ef2(){const _0x39606f=['split','40ciMsRP','ðŸ—‘ï¸\x20Deleted\x20old\x20log\x20file:\x20','cointopay_errors','message','logWhiteDomainError','logWebhookProcessed','slice','API_CALL','406356RfSoXl','4665485pDDKSK','ensureLogsDirectory','replace','path','315749esSHrW','\x20days)','logCoinToPayError','endsWith','6306hESXVZ','readdirSync','ðŸ“\x20Created\x20logs\x20directory:\x20','date','log','shop_webhooks_sent','logsDir','cwd','payments_created','logWhiteDomainResponse','logShopWebhookError','default','shop_webhooks_errors','LoggerService','white_domain_requests','.log','48KPvnQB','cleanOldLogs','logPaymentCreated','Failed\x20to\x20write\x20','__importDefault','__esModule','sort','error','webhooks_errors','46377rzDfID','logWebhookReceived','map','COINTOPAY_STATUS_CHANGE','toISOString','loggerService','api_calls','writeLog','existsSync','logShopWebhookSent','1LmKtTm','size','localeCompare','188276SUeBoO','WEBHOOK_ERROR','Failed\x20to\x20clean\x20old\x20logs:','logCoinToPayStatus','utf8','WEBHOOK_PROCESSED','defineProperty','Failed\x20to\x20get\x20log\x20stats:','logWhiteDomainRequest','SHOP_WEBHOOK_SENT','mtime','logs','join','cointopay_status_changes','RESPONSE','475580vRtoFR','forEach','\x20log:','setDate','logWebhookError','statSync','webhooks_received','getLogFileName','385dxBEQB','\x20old\x20log\x20files\x20(older\x20than\x20','ðŸ§¹\x20Cleaned\x20','webhooks_processed','stack','mkdirSync','REQUEST'];a67_0x2ef2=function(){return _0x39606f;};return a67_0x2ef2();}var __importDefault=this&&this[a67_0x524aff(0x208)]||function(_0x5c18eb){const _0x8fcc44=a67_0x524aff;return _0x5c18eb&&_0x5c18eb[_0x8fcc44(0x209)]?_0x5c18eb:{'default':_0x5c18eb};};function a67_0x1e08(_0x5245d1,_0x15b13b){_0x5245d1=_0x5245d1-0x1b6;const _0x2ef290=a67_0x2ef2();let _0x1e0822=_0x2ef290[_0x5245d1];return _0x1e0822;}Object[a67_0x524aff(0x1ca)](exports,'__esModule',{'value':!![]}),exports['loggerService']=exports[a67_0x524aff(0x201)]=void 0x0;const fs_1=__importDefault(require('fs')),path_1=__importDefault(require(a67_0x524aff(0x1ef)));class LoggerService{constructor(){const _0xb69608=a67_0x524aff;this[_0xb69608(0x1fa)]=path_1[_0xb69608(0x1ff)][_0xb69608(0x1d0)](process[_0xb69608(0x1fb)](),_0xb69608(0x1cf)),this[_0xb69608(0x1ed)]();}[a67_0x524aff(0x1ed)](){const _0x277949=a67_0x524aff;!fs_1[_0x277949(0x1ff)][_0x277949(0x1bf)](this[_0x277949(0x1fa)])&&(fs_1['default'][_0x277949(0x1e0)](this[_0x277949(0x1fa)],{'recursive':!![]}),console[_0x277949(0x1f8)](_0x277949(0x1f6)+this[_0x277949(0x1fa)]));}[a67_0x524aff(0x1da)](_0x4fd136){const _0x334f33=a67_0x524aff,_0x43af55=new Date()[_0x334f33(0x1bb)]()[_0x334f33(0x1e2)]('T')[0x0];return path_1['default'][_0x334f33(0x1d0)](this[_0x334f33(0x1fa)],_0x4fd136+'_'+_0x43af55+'.log');}[a67_0x524aff(0x1be)](_0x7cd519,_0x55369f){const _0x59b96f=a67_0x524aff;try{const _0x5a7327=new Date()[_0x59b96f(0x1bb)](),_0x5f229c={'timestamp':_0x5a7327,..._0x55369f},_0x4b710c=JSON['stringify'](_0x5f229c)+'\x0a',_0x2bdbf5=this[_0x59b96f(0x1da)](_0x7cd519);fs_1[_0x59b96f(0x1ff)]['appendFileSync'](_0x2bdbf5,_0x4b710c,_0x59b96f(0x1c8));}catch(_0x2b55aa){console[_0x59b96f(0x20b)](_0x59b96f(0x207)+_0x7cd519+_0x59b96f(0x1d5),_0x2b55aa);}}[a67_0x524aff(0x1cc)](_0x5a5611,_0x5c4fe7,_0x22163a,_0x3e18f4){const _0x178a87=a67_0x524aff;this[_0x178a87(0x1be)](_0x178a87(0x202),{'type':_0x178a87(0x1e1),'gateway':_0x5a5611,'endpoint':_0x5c4fe7,'method':_0x22163a,'data':_0x3e18f4});}[a67_0x524aff(0x1fd)](_0x3f7df2,_0x2a2912,_0x284d4a,_0x591734,_0x1c8cb3){const _0x45ee0e=a67_0x524aff;this[_0x45ee0e(0x1be)]('white_domain_responses',{'type':_0x45ee0e(0x1d2),'gateway':_0x3f7df2,'endpoint':_0x2a2912,'status':_0x284d4a,'responseTime':_0x1c8cb3,'data':_0x591734});}[a67_0x524aff(0x1e7)](_0x5a0022,_0x2860f0,_0x4a0a7b){const _0x3caba2=a67_0x524aff;this[_0x3caba2(0x1be)]('white_domain_errors',{'type':'ERROR','gateway':_0x5a0022,'endpoint':_0x2860f0,'error':_0x4a0a7b instanceof Error?{'message':_0x4a0a7b[_0x3caba2(0x1e6)],'stack':_0x4a0a7b[_0x3caba2(0x1df)]}:_0x4a0a7b});}[a67_0x524aff(0x1b8)](_0x253eef,_0xcefa6f,_0x3b3874){const _0x5c63a0=a67_0x524aff;this['writeLog'](_0x5c63a0(0x1d9),{'type':'WEBHOOK_RECEIVED','gateway':_0x253eef,'headers':_0x3b3874,'data':_0xcefa6f});}[a67_0x524aff(0x1e8)](_0xd94247,_0x46dd01,_0x3110ac,_0x13be98,_0x472a3c){const _0x552c4f=a67_0x524aff;this['writeLog'](_0x552c4f(0x1de),{'type':_0x552c4f(0x1c9),'gateway':_0xd94247,'paymentId':_0x46dd01,'oldStatus':_0x3110ac,'newStatus':_0x13be98,'originalData':_0x472a3c});}[a67_0x524aff(0x1d7)](_0x47db44,_0x5b6c99,_0x2f69fa){const _0x5a5f12=a67_0x524aff;this[_0x5a5f12(0x1be)](_0x5a5f12(0x1b6),{'type':_0x5a5f12(0x1c5),'gateway':_0x47db44,'error':_0x5b6c99 instanceof Error?{'message':_0x5b6c99[_0x5a5f12(0x1e6)],'stack':_0x5b6c99[_0x5a5f12(0x1df)]}:_0x5b6c99,'originalData':_0x2f69fa});}[a67_0x524aff(0x1c7)](_0x3f5cb9){const _0x26eeaa=a67_0x524aff;this['writeLog'](_0x26eeaa(0x1d1),{'type':_0x26eeaa(0x1ba),..._0x3f5cb9});}[a67_0x524aff(0x1f2)](_0x3a0b2d){const _0x241c7b=a67_0x524aff;this['writeLog'](_0x241c7b(0x1e5),{'type':'COINTOPAY_ERROR',..._0x3a0b2d});}[a67_0x524aff(0x1c0)](_0x3410ca,_0x136016,_0x471f5f,_0x3e1919,_0x49c36e,_0x297ca6){const _0x2b01ec=a67_0x524aff;this[_0x2b01ec(0x1be)](_0x2b01ec(0x1f9),{'type':_0x2b01ec(0x1cd),'shopId':_0x3410ca,'webhookUrl':_0x136016,'event':_0x471f5f,'status':_0x3e1919,'responseTime':_0x49c36e,'payload':_0x297ca6});}[a67_0x524aff(0x1fe)](_0x372540,_0x18e6d0,_0x5a495c,_0x3f68d4,_0x100944){const _0x487b9e=a67_0x524aff;this[_0x487b9e(0x1be)](_0x487b9e(0x200),{'type':'SHOP_WEBHOOK_ERROR','shopId':_0x372540,'webhookUrl':_0x18e6d0,'event':_0x5a495c,'error':_0x3f68d4 instanceof Error?{'message':_0x3f68d4['message'],'stack':_0x3f68d4[_0x487b9e(0x1df)]}:_0x3f68d4,'payload':_0x100944});}[a67_0x524aff(0x206)](_0x492324,_0x1dc525,_0x440b25,_0x4ea5f4,_0x45ebb7){const _0x3acb83=a67_0x524aff;this[_0x3acb83(0x1be)](_0x3acb83(0x1fc),{'type':'PAYMENT_CREATED','gateway':_0x492324,'paymentId':_0x1dc525,'shopId':_0x440b25,'amount':_0x4ea5f4,'currency':_0x45ebb7});}['logApiCall'](_0x39df18,_0x5dabe1,_0x14bfb1,_0x31bfea,_0x205627){const _0x240c1d=a67_0x524aff;this['writeLog'](_0x240c1d(0x1bd),{'type':_0x240c1d(0x1ea),'endpoint':_0x39df18,'method':_0x5dabe1,'userId':_0x14bfb1,'userRole':_0x31bfea,'requestData':_0x205627});}['getLogStats'](){const _0x3cf2a2=a67_0x524aff;try{const _0x306e07=fs_1['default'][_0x3cf2a2(0x1f5)](this[_0x3cf2a2(0x1fa)]),_0x4be545=_0x306e07['filter'](_0x5ba749=>_0x5ba749[_0x3cf2a2(0x1f3)](_0x3cf2a2(0x203))),_0x146ae6=[...new Set(_0x4be545[_0x3cf2a2(0x1b9)](_0x203722=>_0x203722[_0x3cf2a2(0x1e2)]('_')[0x0]))],_0x4dd404=_0x4be545['map'](_0x2a5812=>{const _0x28fd58=_0x3cf2a2,_0x25c2d9=path_1[_0x28fd58(0x1ff)]['join'](this[_0x28fd58(0x1fa)],_0x2a5812),_0x263d72=fs_1[_0x28fd58(0x1ff)][_0x28fd58(0x1d8)](_0x25c2d9),[_0x51b342,_0x2cd8e7]=_0x2a5812[_0x28fd58(0x1ee)](_0x28fd58(0x203),'')[_0x28fd58(0x1e2)]('_');return{'type':_0x51b342,'date':_0x2cd8e7,'size':_0x263d72[_0x28fd58(0x1c2)]};})[_0x3cf2a2(0x20a)]((_0x2e9370,_0xdcbd09)=>_0xdcbd09['date'][_0x3cf2a2(0x1c3)](_0x2e9370[_0x3cf2a2(0x1f7)]));return{'totalFiles':_0x4be545['length'],'logTypes':_0x146ae6,'latestLogs':_0x4dd404[_0x3cf2a2(0x1e9)](0x0,0xa)};}catch(_0x2d7d9f){return console[_0x3cf2a2(0x20b)](_0x3cf2a2(0x1cb),_0x2d7d9f),{'totalFiles':0x0,'logTypes':[],'latestLogs':[]};}}[a67_0x524aff(0x205)](_0x170b5f=0x1e){const _0x37bd7c=a67_0x524aff;try{const _0x2dc0da=fs_1[_0x37bd7c(0x1ff)][_0x37bd7c(0x1f5)](this[_0x37bd7c(0x1fa)]),_0x2fd59f=new Date();_0x2fd59f[_0x37bd7c(0x1d6)](_0x2fd59f['getDate']()-_0x170b5f);let _0x50f100=0x0;_0x2dc0da[_0x37bd7c(0x1d4)](_0x300aa3=>{const _0x5c9425=_0x37bd7c;if(!_0x300aa3[_0x5c9425(0x1f3)](_0x5c9425(0x203)))return;const _0x13ca06=path_1['default']['join'](this[_0x5c9425(0x1fa)],_0x300aa3),_0x3ebee6=fs_1[_0x5c9425(0x1ff)][_0x5c9425(0x1d8)](_0x13ca06);_0x3ebee6[_0x5c9425(0x1ce)]<_0x2fd59f&&(fs_1[_0x5c9425(0x1ff)]['unlinkSync'](_0x13ca06),_0x50f100++,console[_0x5c9425(0x1f8)](_0x5c9425(0x1e4)+_0x300aa3));}),console['log'](_0x37bd7c(0x1dd)+_0x50f100+_0x37bd7c(0x1dc)+_0x170b5f+_0x37bd7c(0x1f1));}catch(_0x511b61){console['error'](_0x37bd7c(0x1c6),_0x511b61);}}}exports[a67_0x524aff(0x201)]=LoggerService,exports[a67_0x524aff(0x1bc)]=new LoggerService();