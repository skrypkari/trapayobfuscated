'use strict';const a43_0x1441b2=a43_0x4b15;function a43_0x4b15(_0xddb80,_0x180e16){const _0xdee187=a43_0xdee1();return a43_0x4b15=function(_0x4b15b2,_0x1e10bd){_0x4b15b2=_0x4b15b2-0x111;let _0x144a4f=_0xdee187[_0x4b15b2];return _0x144a4f;},a43_0x4b15(_0xddb80,_0x180e16);}(function(_0x4425ee,_0x45df5b){const _0x2f6b04=a43_0x4b15,_0x2bf517=_0x4425ee();while(!![]){try{const _0x544f53=-parseInt(_0x2f6b04(0x142))/0x1*(-parseInt(_0x2f6b04(0x119))/0x2)+parseInt(_0x2f6b04(0x144))/0x3+-parseInt(_0x2f6b04(0x116))/0x4+parseInt(_0x2f6b04(0x125))/0x5+parseInt(_0x2f6b04(0x143))/0x6*(parseInt(_0x2f6b04(0x11b))/0x7)+parseInt(_0x2f6b04(0x148))/0x8+parseInt(_0x2f6b04(0x12b))/0x9*(-parseInt(_0x2f6b04(0x146))/0xa);if(_0x544f53===_0x45df5b)break;else _0x2bf517['push'](_0x2bf517['shift']());}catch(_0x3708db){_0x2bf517['push'](_0x2bf517['shift']());}}}(a43_0xdee1,0xc8d8f));function a43_0xdee1(){const _0x4359b6=['defineProperty','logWebhookError','white_domain_errors','cwd','endsWith','RESPONSE','Failed\x20to\x20clean\x20old\x20logs:','toISOString','PAYMENT_CREATED','ðŸ§¹\x20Cleaned\x20','white_domain_responses','926252XkYBtz','Failed\x20to\x20write\x20','logShopWebhookSent','12lXxWtr','__esModule','343TyCzHN','Failed\x20to\x20get\x20log\x20stats:','.log','shop_webhooks_errors','logShopWebhookError','webhooks_processed','size','logsDir','logWebhookProcessed','getLogStats','1206980dwsEhW','ðŸ“\x20Created\x20logs\x20directory:\x20','\x20days)','readdirSync','unlinkSync','map','11156427nYqdXR','\x20log:','webhooks_received','logWhiteDomainError','ðŸ—‘ï¸\x20Deleted\x20old\x20log\x20file:\x20','\x20old\x20log\x20files\x20(older\x20than\x20','stringify','api_calls','logs','shop_webhooks_sent','getLogFileName','cleanOldLogs','logApiCall','setDate','default','mtime','writeLog','appendFileSync','logWebhookReceived','path','ERROR','error','existsSync','64446tYdogl','105168rBOjeq','2334858LudqNb','message','10sxVHtY','stack','228856lZvYyu','statSync','utf8','logWhiteDomainResponse','WEBHOOK_ERROR','slice','__importDefault','ensureLogsDirectory','join','LoggerService','loggerService','split','date'];a43_0xdee1=function(){return _0x4359b6;};return a43_0xdee1();}var __importDefault=this&&this[a43_0x1441b2(0x14e)]||function(_0x24892b){return _0x24892b&&_0x24892b['__esModule']?_0x24892b:{'default':_0x24892b};};Object[a43_0x1441b2(0x155)](exports,a43_0x1441b2(0x11a),{'value':!![]}),exports[a43_0x1441b2(0x152)]=exports[a43_0x1441b2(0x151)]=void 0x0;const fs_1=__importDefault(require('fs')),path_1=__importDefault(require(a43_0x1441b2(0x13e)));class LoggerService{constructor(){const _0x3e452b=a43_0x1441b2;this['logsDir']=path_1['default']['join'](process[_0x3e452b(0x158)](),_0x3e452b(0x133)),this[_0x3e452b(0x14f)]();}[a43_0x1441b2(0x14f)](){const _0x10876e=a43_0x1441b2;!fs_1['default'][_0x10876e(0x141)](this[_0x10876e(0x122)])&&(fs_1[_0x10876e(0x139)]['mkdirSync'](this[_0x10876e(0x122)],{'recursive':!![]}),console['log'](_0x10876e(0x126)+this[_0x10876e(0x122)]));}[a43_0x1441b2(0x135)](_0x17fdf9){const _0x2d30d0=a43_0x1441b2,_0x1b75c3=new Date()[_0x2d30d0(0x112)]()[_0x2d30d0(0x153)]('T')[0x0];return path_1[_0x2d30d0(0x139)]['join'](this[_0x2d30d0(0x122)],_0x17fdf9+'_'+_0x1b75c3+_0x2d30d0(0x11d));}[a43_0x1441b2(0x13b)](_0x2cd5a7,_0x864e44){const _0xc1e6cd=a43_0x1441b2;try{const _0x32fb76=new Date()[_0xc1e6cd(0x112)](),_0x3a6774={'timestamp':_0x32fb76,..._0x864e44},_0x1aa790=JSON[_0xc1e6cd(0x131)](_0x3a6774)+'\x0a',_0x2bd1c6=this[_0xc1e6cd(0x135)](_0x2cd5a7);fs_1['default'][_0xc1e6cd(0x13c)](_0x2bd1c6,_0x1aa790,_0xc1e6cd(0x14a));}catch(_0x428673){console['error'](_0xc1e6cd(0x117)+_0x2cd5a7+_0xc1e6cd(0x12c),_0x428673);}}['logWhiteDomainRequest'](_0x5c2f44,_0x7d5c8a,_0x31b8c5,_0x310e5b){const _0x441bcb=a43_0x1441b2;this[_0x441bcb(0x13b)]('white_domain_requests',{'type':'REQUEST','gateway':_0x5c2f44,'endpoint':_0x7d5c8a,'method':_0x31b8c5,'data':_0x310e5b});}[a43_0x1441b2(0x14b)](_0x327263,_0x29fcf3,_0x9b95d7,_0x121bc3,_0x362a75){const _0x3720ef=a43_0x1441b2;this['writeLog'](_0x3720ef(0x115),{'type':_0x3720ef(0x15a),'gateway':_0x327263,'endpoint':_0x29fcf3,'status':_0x9b95d7,'responseTime':_0x362a75,'data':_0x121bc3});}[a43_0x1441b2(0x12e)](_0x67e2b1,_0x442133,_0x10923d){const _0x33c308=a43_0x1441b2;this[_0x33c308(0x13b)](_0x33c308(0x157),{'type':_0x33c308(0x13f),'gateway':_0x67e2b1,'endpoint':_0x442133,'error':_0x10923d instanceof Error?{'message':_0x10923d[_0x33c308(0x145)],'stack':_0x10923d['stack']}:_0x10923d});}[a43_0x1441b2(0x13d)](_0x5f24ff,_0x2633e3,_0x384c2f){const _0x482b8a=a43_0x1441b2;this[_0x482b8a(0x13b)](_0x482b8a(0x12d),{'type':'WEBHOOK_RECEIVED','gateway':_0x5f24ff,'headers':_0x384c2f,'data':_0x2633e3});}[a43_0x1441b2(0x123)](_0x1b7c4e,_0x42bb2f,_0x31df17,_0x1a96c2,_0x36073e){const _0x2cb9d0=a43_0x1441b2;this[_0x2cb9d0(0x13b)](_0x2cb9d0(0x120),{'type':'WEBHOOK_PROCESSED','gateway':_0x1b7c4e,'paymentId':_0x42bb2f,'oldStatus':_0x31df17,'newStatus':_0x1a96c2,'originalData':_0x36073e});}[a43_0x1441b2(0x156)](_0x64ffa3,_0x206a0f,_0x29ea86){const _0x4be38a=a43_0x1441b2;this[_0x4be38a(0x13b)]('webhooks_errors',{'type':_0x4be38a(0x14c),'gateway':_0x64ffa3,'error':_0x206a0f instanceof Error?{'message':_0x206a0f[_0x4be38a(0x145)],'stack':_0x206a0f[_0x4be38a(0x147)]}:_0x206a0f,'originalData':_0x29ea86});}[a43_0x1441b2(0x118)](_0x45041a,_0xd2f5ac,_0x450751,_0x4b3629,_0x2ce1e1,_0x414b07){const _0x5e68a0=a43_0x1441b2;this[_0x5e68a0(0x13b)](_0x5e68a0(0x134),{'type':'SHOP_WEBHOOK_SENT','shopId':_0x45041a,'webhookUrl':_0xd2f5ac,'event':_0x450751,'status':_0x4b3629,'responseTime':_0x2ce1e1,'payload':_0x414b07});}[a43_0x1441b2(0x11f)](_0x2832e0,_0x6cebc5,_0x57fdb6,_0x373635,_0x34a0f9){const _0x1f27ba=a43_0x1441b2;this[_0x1f27ba(0x13b)](_0x1f27ba(0x11e),{'type':'SHOP_WEBHOOK_ERROR','shopId':_0x2832e0,'webhookUrl':_0x6cebc5,'event':_0x57fdb6,'error':_0x373635 instanceof Error?{'message':_0x373635[_0x1f27ba(0x145)],'stack':_0x373635[_0x1f27ba(0x147)]}:_0x373635,'payload':_0x34a0f9});}['logPaymentCreated'](_0x164676,_0x18d602,_0x8e259f,_0x243199,_0x5434d9){const _0x42692a=a43_0x1441b2;this[_0x42692a(0x13b)]('payments_created',{'type':_0x42692a(0x113),'gateway':_0x164676,'paymentId':_0x18d602,'shopId':_0x8e259f,'amount':_0x243199,'currency':_0x5434d9});}[a43_0x1441b2(0x137)](_0x8ba781,_0x4419c0,_0x131a1f,_0x481a2e,_0x5be68f){const _0x31b855=a43_0x1441b2;this[_0x31b855(0x13b)](_0x31b855(0x132),{'type':'API_CALL','endpoint':_0x8ba781,'method':_0x4419c0,'userId':_0x131a1f,'userRole':_0x481a2e,'requestData':_0x5be68f});}[a43_0x1441b2(0x124)](){const _0x2f1c59=a43_0x1441b2;try{const _0xff5ed7=fs_1[_0x2f1c59(0x139)][_0x2f1c59(0x128)](this[_0x2f1c59(0x122)]),_0x273496=_0xff5ed7['filter'](_0x499314=>_0x499314[_0x2f1c59(0x159)](_0x2f1c59(0x11d))),_0x1437ec=[...new Set(_0x273496['map'](_0x174a2e=>_0x174a2e['split']('_')[0x0]))],_0xc2d235=_0x273496[_0x2f1c59(0x12a)](_0x5de501=>{const _0x5c0e78=_0x2f1c59,_0x1d3722=path_1[_0x5c0e78(0x139)][_0x5c0e78(0x150)](this[_0x5c0e78(0x122)],_0x5de501),_0x2c74f2=fs_1[_0x5c0e78(0x139)][_0x5c0e78(0x149)](_0x1d3722),[_0x2bf8d0,_0xc4d97b]=_0x5de501['replace'](_0x5c0e78(0x11d),'')[_0x5c0e78(0x153)]('_');return{'type':_0x2bf8d0,'date':_0xc4d97b,'size':_0x2c74f2[_0x5c0e78(0x121)]};})['sort']((_0x33e303,_0x420ce3)=>_0x420ce3[_0x2f1c59(0x154)]['localeCompare'](_0x33e303[_0x2f1c59(0x154)]));return{'totalFiles':_0x273496['length'],'logTypes':_0x1437ec,'latestLogs':_0xc2d235[_0x2f1c59(0x14d)](0x0,0xa)};}catch(_0x15cdb4){return console[_0x2f1c59(0x140)](_0x2f1c59(0x11c),_0x15cdb4),{'totalFiles':0x0,'logTypes':[],'latestLogs':[]};}}[a43_0x1441b2(0x136)](_0x517c99=0x1e){const _0x4de81e=a43_0x1441b2;try{const _0x2bcb20=fs_1[_0x4de81e(0x139)][_0x4de81e(0x128)](this[_0x4de81e(0x122)]),_0x12a7df=new Date();_0x12a7df[_0x4de81e(0x138)](_0x12a7df['getDate']()-_0x517c99);let _0x563fe9=0x0;_0x2bcb20['forEach'](_0x399ca6=>{const _0x366fa9=_0x4de81e;if(!_0x399ca6[_0x366fa9(0x159)](_0x366fa9(0x11d)))return;const _0x108822=path_1[_0x366fa9(0x139)][_0x366fa9(0x150)](this[_0x366fa9(0x122)],_0x399ca6),_0x598ec2=fs_1[_0x366fa9(0x139)]['statSync'](_0x108822);_0x598ec2[_0x366fa9(0x13a)]<_0x12a7df&&(fs_1[_0x366fa9(0x139)][_0x366fa9(0x129)](_0x108822),_0x563fe9++,console['log'](_0x366fa9(0x12f)+_0x399ca6));}),console['log'](_0x4de81e(0x114)+_0x563fe9+_0x4de81e(0x130)+_0x517c99+_0x4de81e(0x127));}catch(_0x1b3d60){console[_0x4de81e(0x140)](_0x4de81e(0x111),_0x1b3d60);}}}exports[a43_0x1441b2(0x151)]=LoggerService,exports[a43_0x1441b2(0x152)]=new LoggerService();