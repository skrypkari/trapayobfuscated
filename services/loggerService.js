'use strict';function a44_0x48e4(){const _0x45ec53=['path','🗑️\x20Deleted\x20old\x20log\x20file:\x20','logShopWebhookError','__importDefault','RESPONSE','white_domain_responses','logWhiteDomainError','utf8','default','SHOP_WEBHOOK_SENT','toISOString','payments_created','\x20days)','7DyUOdH','\x20old\x20log\x20files\x20(older\x20than\x20','1882991QgVOqD','ERROR','unlinkSync','306225gQXtKF','message','logPaymentCreated','cleanOldLogs','cwd','white_domain_errors','webhooks_processed','webhooks_received','getDate','__esModule','logsDir','size','map','664skZFbP','sort','getLogFileName','mkdirSync','stack','split','API_CALL','1371485QNVcyP','\x20log:','🧹\x20Cleaned\x20','log','1586304mBDPaO','6921xwMNrY','1091320NLWXNm','defineProperty','loggerService','webhooks_errors','LoggerService','logWebhookReceived','forEach','ensureLogsDirectory','existsSync','stringify','shop_webhooks_errors','logApiCall','716854jEnJXy','error','join','REQUEST','SHOP_WEBHOOK_ERROR','endsWith','logWebhookError','.log','writeLog','Failed\x20to\x20get\x20log\x20stats:','readdirSync','📁\x20Created\x20logs\x20directory:\x20','6jraWvy','shop_webhooks_sent','PAYMENT_CREATED','logWebhookProcessed','replace','logWhiteDomainResponse','slice','1vtsXNj','10ZNCneg','api_calls','Failed\x20to\x20write\x20'];a44_0x48e4=function(){return _0x45ec53;};return a44_0x48e4();}const a44_0x404733=a44_0x9308;(function(_0x15cf9e,_0x187c47){const _0x2906cc=a44_0x9308,_0x8f4ed3=_0x15cf9e();while(!![]){try{const _0x2131cc=-parseInt(_0x2906cc(0x173))/0x1*(parseInt(_0x2906cc(0x160))/0x2)+-parseInt(_0x2906cc(0x153))/0x3*(-parseInt(_0x2906cc(0x147))/0x4)+parseInt(_0x2906cc(0x14e))/0x5*(-parseInt(_0x2906cc(0x16c))/0x6)+-parseInt(_0x2906cc(0x135))/0x7*(-parseInt(_0x2906cc(0x154))/0x8)+parseInt(_0x2906cc(0x13a))/0x9+parseInt(_0x2906cc(0x174))/0xa*(parseInt(_0x2906cc(0x137))/0xb)+parseInt(_0x2906cc(0x152))/0xc;if(_0x2131cc===_0x187c47)break;else _0x8f4ed3['push'](_0x8f4ed3['shift']());}catch(_0x333642){_0x8f4ed3['push'](_0x8f4ed3['shift']());}}}(a44_0x48e4,0x36b33));var __importDefault=this&&this[a44_0x404733(0x17a)]||function(_0xe13a7f){const _0x45f636=a44_0x404733;return _0xe13a7f&&_0xe13a7f[_0x45f636(0x143)]?_0xe13a7f:{'default':_0xe13a7f};};function a44_0x9308(_0x306c41,_0x1cef61){const _0x48e4ce=a44_0x48e4();return a44_0x9308=function(_0x93088,_0x7d30b8){_0x93088=_0x93088-0x135;let _0x1d2c0e=_0x48e4ce[_0x93088];return _0x1d2c0e;},a44_0x9308(_0x306c41,_0x1cef61);}Object[a44_0x404733(0x155)](exports,'__esModule',{'value':!![]}),exports['loggerService']=exports[a44_0x404733(0x158)]=void 0x0;const fs_1=__importDefault(require('fs')),path_1=__importDefault(require(a44_0x404733(0x177)));class LoggerService{constructor(){const _0x34fc74=a44_0x404733;this[_0x34fc74(0x144)]=path_1['default'][_0x34fc74(0x162)](process[_0x34fc74(0x13e)](),'logs'),this['ensureLogsDirectory']();}[a44_0x404733(0x15b)](){const _0x271491=a44_0x404733;!fs_1['default'][_0x271491(0x15c)](this[_0x271491(0x144)])&&(fs_1[_0x271491(0x17f)][_0x271491(0x14a)](this[_0x271491(0x144)],{'recursive':!![]}),console[_0x271491(0x151)](_0x271491(0x16b)+this[_0x271491(0x144)]));}[a44_0x404733(0x149)](_0x3bc812){const _0x3d702c=a44_0x404733,_0x2ea01a=new Date()[_0x3d702c(0x181)]()[_0x3d702c(0x14c)]('T')[0x0];return path_1[_0x3d702c(0x17f)][_0x3d702c(0x162)](this[_0x3d702c(0x144)],_0x3bc812+'_'+_0x2ea01a+_0x3d702c(0x167));}['writeLog'](_0x5951ee,_0x492dd3){const _0x3ae40b=a44_0x404733;try{const _0x162875=new Date()['toISOString'](),_0x1f389f={'timestamp':_0x162875,..._0x492dd3},_0x4469de=JSON[_0x3ae40b(0x15d)](_0x1f389f)+'\x0a',_0x5ca2a1=this[_0x3ae40b(0x149)](_0x5951ee);fs_1[_0x3ae40b(0x17f)]['appendFileSync'](_0x5ca2a1,_0x4469de,_0x3ae40b(0x17e));}catch(_0x18ae75){console['error'](_0x3ae40b(0x176)+_0x5951ee+_0x3ae40b(0x14f),_0x18ae75);}}['logWhiteDomainRequest'](_0xb121d2,_0x646429,_0x13815a,_0x5bd3cd){const _0x1e715c=a44_0x404733;this[_0x1e715c(0x168)]('white_domain_requests',{'type':_0x1e715c(0x163),'gateway':_0xb121d2,'endpoint':_0x646429,'method':_0x13815a,'data':_0x5bd3cd});}[a44_0x404733(0x171)](_0x573c10,_0x358394,_0x698274,_0x53fb9f,_0x27e9b1){const _0x5d934a=a44_0x404733;this[_0x5d934a(0x168)](_0x5d934a(0x17c),{'type':_0x5d934a(0x17b),'gateway':_0x573c10,'endpoint':_0x358394,'status':_0x698274,'responseTime':_0x27e9b1,'data':_0x53fb9f});}[a44_0x404733(0x17d)](_0x19b7f5,_0x1c1cd8,_0x31aeb4){const _0x12d434=a44_0x404733;this[_0x12d434(0x168)](_0x12d434(0x13f),{'type':_0x12d434(0x138),'gateway':_0x19b7f5,'endpoint':_0x1c1cd8,'error':_0x31aeb4 instanceof Error?{'message':_0x31aeb4['message'],'stack':_0x31aeb4[_0x12d434(0x14b)]}:_0x31aeb4});}[a44_0x404733(0x159)](_0x2fba37,_0x3ec73e,_0x58d5c3){const _0xcc5942=a44_0x404733;this[_0xcc5942(0x168)](_0xcc5942(0x141),{'type':'WEBHOOK_RECEIVED','gateway':_0x2fba37,'headers':_0x58d5c3,'data':_0x3ec73e});}[a44_0x404733(0x16f)](_0x568b19,_0x78c035,_0x4d7eef,_0x21e291,_0x2fd89c){const _0x5749d5=a44_0x404733;this[_0x5749d5(0x168)](_0x5749d5(0x140),{'type':'WEBHOOK_PROCESSED','gateway':_0x568b19,'paymentId':_0x78c035,'oldStatus':_0x4d7eef,'newStatus':_0x21e291,'originalData':_0x2fd89c});}[a44_0x404733(0x166)](_0x21fa01,_0x531653,_0x3480ae){const _0x5abc91=a44_0x404733;this[_0x5abc91(0x168)](_0x5abc91(0x157),{'type':'WEBHOOK_ERROR','gateway':_0x21fa01,'error':_0x531653 instanceof Error?{'message':_0x531653[_0x5abc91(0x13b)],'stack':_0x531653[_0x5abc91(0x14b)]}:_0x531653,'originalData':_0x3480ae});}['logShopWebhookSent'](_0x202c81,_0x381306,_0xb5119d,_0x217036,_0x1c839a,_0x154320){const _0x3d1fbd=a44_0x404733;this[_0x3d1fbd(0x168)](_0x3d1fbd(0x16d),{'type':_0x3d1fbd(0x180),'shopId':_0x202c81,'webhookUrl':_0x381306,'event':_0xb5119d,'status':_0x217036,'responseTime':_0x1c839a,'payload':_0x154320});}[a44_0x404733(0x179)](_0x530b7c,_0x1e0369,_0x4c0b8a,_0x20fe75,_0x5a1b94){const _0x3bb88b=a44_0x404733;this['writeLog'](_0x3bb88b(0x15e),{'type':_0x3bb88b(0x164),'shopId':_0x530b7c,'webhookUrl':_0x1e0369,'event':_0x4c0b8a,'error':_0x20fe75 instanceof Error?{'message':_0x20fe75[_0x3bb88b(0x13b)],'stack':_0x20fe75[_0x3bb88b(0x14b)]}:_0x20fe75,'payload':_0x5a1b94});}[a44_0x404733(0x13c)](_0xe4b903,_0x500df2,_0x3a2ac1,_0x12c2c0,_0x1811b3){const _0x70a908=a44_0x404733;this[_0x70a908(0x168)](_0x70a908(0x182),{'type':_0x70a908(0x16e),'gateway':_0xe4b903,'paymentId':_0x500df2,'shopId':_0x3a2ac1,'amount':_0x12c2c0,'currency':_0x1811b3});}[a44_0x404733(0x15f)](_0x38a38b,_0x5eca85,_0x1d671c,_0x5e4352,_0x55484f){const _0x2f6c86=a44_0x404733;this[_0x2f6c86(0x168)](_0x2f6c86(0x175),{'type':_0x2f6c86(0x14d),'endpoint':_0x38a38b,'method':_0x5eca85,'userId':_0x1d671c,'userRole':_0x5e4352,'requestData':_0x55484f});}['getLogStats'](){const _0x2eb210=a44_0x404733;try{const _0x2b6387=fs_1[_0x2eb210(0x17f)][_0x2eb210(0x16a)](this[_0x2eb210(0x144)]),_0x47129e=_0x2b6387['filter'](_0x48f872=>_0x48f872[_0x2eb210(0x165)](_0x2eb210(0x167))),_0x4fed22=[...new Set(_0x47129e[_0x2eb210(0x146)](_0x167d97=>_0x167d97[_0x2eb210(0x14c)]('_')[0x0]))],_0x45aef0=_0x47129e['map'](_0x1d953d=>{const _0x4a8bd0=_0x2eb210,_0x120645=path_1[_0x4a8bd0(0x17f)][_0x4a8bd0(0x162)](this[_0x4a8bd0(0x144)],_0x1d953d),_0x51f475=fs_1[_0x4a8bd0(0x17f)]['statSync'](_0x120645),[_0x2f3923,_0x97ad9b]=_0x1d953d[_0x4a8bd0(0x170)](_0x4a8bd0(0x167),'')[_0x4a8bd0(0x14c)]('_');return{'type':_0x2f3923,'date':_0x97ad9b,'size':_0x51f475[_0x4a8bd0(0x145)]};})[_0x2eb210(0x148)]((_0x20d873,_0x242c2f)=>_0x242c2f['date']['localeCompare'](_0x20d873['date']));return{'totalFiles':_0x47129e['length'],'logTypes':_0x4fed22,'latestLogs':_0x45aef0[_0x2eb210(0x172)](0x0,0xa)};}catch(_0x25c0f2){return console['error'](_0x2eb210(0x169),_0x25c0f2),{'totalFiles':0x0,'logTypes':[],'latestLogs':[]};}}[a44_0x404733(0x13d)](_0x1c19aa=0x1e){const _0x122d0e=a44_0x404733;try{const _0x1cae5c=fs_1[_0x122d0e(0x17f)]['readdirSync'](this[_0x122d0e(0x144)]),_0x4911df=new Date();_0x4911df['setDate'](_0x4911df[_0x122d0e(0x142)]()-_0x1c19aa);let _0x2c3a49=0x0;_0x1cae5c[_0x122d0e(0x15a)](_0x726bdc=>{const _0x110c4e=_0x122d0e;if(!_0x726bdc[_0x110c4e(0x165)]('.log'))return;const _0x271434=path_1[_0x110c4e(0x17f)][_0x110c4e(0x162)](this[_0x110c4e(0x144)],_0x726bdc),_0x1ebef4=fs_1[_0x110c4e(0x17f)]['statSync'](_0x271434);_0x1ebef4['mtime']<_0x4911df&&(fs_1['default'][_0x110c4e(0x139)](_0x271434),_0x2c3a49++,console[_0x110c4e(0x151)](_0x110c4e(0x178)+_0x726bdc));}),console[_0x122d0e(0x151)](_0x122d0e(0x150)+_0x2c3a49+_0x122d0e(0x136)+_0x1c19aa+_0x122d0e(0x183));}catch(_0x11969a){console[_0x122d0e(0x161)]('Failed\x20to\x20clean\x20old\x20logs:',_0x11969a);}}}exports['LoggerService']=LoggerService,exports[a44_0x404733(0x156)]=new LoggerService();