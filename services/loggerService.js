'use strict';const a44_0x3d565c=a44_0x34bf;function a44_0x4bdb(){const _0x1d61b5=['1965872azkoeo','statSync','appendFileSync','650651EudKrV','logApiCall','toISOString','LoggerService','WEBHOOK_PROCESSED','payments_created','getLogFileName','__esModule','logShopWebhookSent','WEBHOOK_RECEIVED','join','__importDefault','ðŸ—‘ï¸\x20Deleted\x20old\x20log\x20file:\x20','\x20old\x20log\x20files\x20(older\x20than\x20','endsWith','WEBHOOK_ERROR','mkdirSync','7NvRVuF','log','Failed\x20to\x20clean\x20old\x20logs:','RESPONSE','utf8','message','ðŸ“\x20Created\x20logs\x20directory:\x20','388330OpkING','api_calls','webhooks_processed','cwd','unlinkSync','368TQrwtt','replace','API_CALL','logsDir','logWebhookError','error','webhooks_errors','split','localeCompare','filter','defineProperty','22758351rqQThS','stack','logWebhookProcessed','.log','loggerService','getLogStats','Failed\x20to\x20get\x20log\x20stats:','27435muzWTR','getDate','white_domain_errors','shop_webhooks_errors','logWhiteDomainResponse','PAYMENT_CREATED','\x20days)','logPaymentCreated','existsSync','sort','2CZPvgD','date','3457338XyoIyv','default','readdirSync','shop_webhooks_sent','mtime','4805830mjJIph','ensureLogsDirectory','189kQnxbc','setDate','path','writeLog','stringify'];a44_0x4bdb=function(){return _0x1d61b5;};return a44_0x4bdb();}(function(_0x1b416b,_0x2510d8){const _0x486586=a44_0x34bf,_0x3e444b=_0x1b416b();while(!![]){try{const _0xf3f11d=-parseInt(_0x486586(0xe1))/0x1*(parseInt(_0x486586(0xd0))/0x2)+-parseInt(_0x486586(0xc6))/0x3*(parseInt(_0x486586(0xfe))/0x4)+-parseInt(_0x486586(0xd7))/0x5+parseInt(_0x486586(0xd2))/0x6+parseInt(_0x486586(0xf2))/0x7*(-parseInt(_0x486586(0xde))/0x8)+parseInt(_0x486586(0xd9))/0x9*(parseInt(_0x486586(0xf9))/0xa)+parseInt(_0x486586(0xbf))/0xb;if(_0xf3f11d===_0x2510d8)break;else _0x3e444b['push'](_0x3e444b['shift']());}catch(_0x48d4c6){_0x3e444b['push'](_0x3e444b['shift']());}}}(a44_0x4bdb,0xb9fa6));var __importDefault=this&&this[a44_0x3d565c(0xec)]||function(_0x4d3613){const _0x56f222=a44_0x3d565c;return _0x4d3613&&_0x4d3613[_0x56f222(0xe8)]?_0x4d3613:{'default':_0x4d3613};};Object[a44_0x3d565c(0xbe)](exports,a44_0x3d565c(0xe8),{'value':!![]}),exports[a44_0x3d565c(0xc3)]=exports[a44_0x3d565c(0xe4)]=void 0x0;const fs_1=__importDefault(require('fs')),path_1=__importDefault(require(a44_0x3d565c(0xdb)));function a44_0x34bf(_0x502a06,_0x362f61){const _0x4bdb43=a44_0x4bdb();return a44_0x34bf=function(_0x34bfea,_0x19eb51){_0x34bfea=_0x34bfea-0xb5;let _0x14cb2e=_0x4bdb43[_0x34bfea];return _0x14cb2e;},a44_0x34bf(_0x502a06,_0x362f61);}class LoggerService{constructor(){const _0x18433c=a44_0x3d565c;this['logsDir']=path_1['default'][_0x18433c(0xeb)](process[_0x18433c(0xfc)](),'logs'),this[_0x18433c(0xd8)]();}[a44_0x3d565c(0xd8)](){const _0x200da8=a44_0x3d565c;!fs_1[_0x200da8(0xd3)][_0x200da8(0xce)](this['logsDir'])&&(fs_1[_0x200da8(0xd3)][_0x200da8(0xf1)](this[_0x200da8(0xb7)],{'recursive':!![]}),console[_0x200da8(0xf3)](_0x200da8(0xf8)+this[_0x200da8(0xb7)]));}[a44_0x3d565c(0xe7)](_0x4db51e){const _0x5e069b=a44_0x3d565c,_0x57de38=new Date()[_0x5e069b(0xe3)]()[_0x5e069b(0xbb)]('T')[0x0];return path_1[_0x5e069b(0xd3)][_0x5e069b(0xeb)](this[_0x5e069b(0xb7)],_0x4db51e+'_'+_0x57de38+'.log');}[a44_0x3d565c(0xdc)](_0x576d0a,_0x3cfd6f){const _0x31a073=a44_0x3d565c;try{const _0x1929e6=new Date()['toISOString'](),_0x4ba1e8={'timestamp':_0x1929e6,..._0x3cfd6f},_0x1f98b6=JSON[_0x31a073(0xdd)](_0x4ba1e8)+'\x0a',_0x778682=this['getLogFileName'](_0x576d0a);fs_1['default'][_0x31a073(0xe0)](_0x778682,_0x1f98b6,_0x31a073(0xf6));}catch(_0x464a5b){console[_0x31a073(0xb9)]('Failed\x20to\x20write\x20'+_0x576d0a+'\x20log:',_0x464a5b);}}['logWhiteDomainRequest'](_0xa1e271,_0x38e7d3,_0x552136,_0x551e6c){this['writeLog']('white_domain_requests',{'type':'REQUEST','gateway':_0xa1e271,'endpoint':_0x38e7d3,'method':_0x552136,'data':_0x551e6c});}[a44_0x3d565c(0xca)](_0xe30bc6,_0xb9c7db,_0x5b9f14,_0x292661,_0x369a3e){const _0x178f23=a44_0x3d565c;this['writeLog']('white_domain_responses',{'type':_0x178f23(0xf5),'gateway':_0xe30bc6,'endpoint':_0xb9c7db,'status':_0x5b9f14,'responseTime':_0x369a3e,'data':_0x292661});}['logWhiteDomainError'](_0x419acc,_0x5a3c0c,_0x1b4000){const _0xc5c5bf=a44_0x3d565c;this['writeLog'](_0xc5c5bf(0xc8),{'type':'ERROR','gateway':_0x419acc,'endpoint':_0x5a3c0c,'error':_0x1b4000 instanceof Error?{'message':_0x1b4000[_0xc5c5bf(0xf7)],'stack':_0x1b4000[_0xc5c5bf(0xc0)]}:_0x1b4000});}['logWebhookReceived'](_0x413869,_0x5bacad,_0x1150a9){const _0x23dd30=a44_0x3d565c;this[_0x23dd30(0xdc)]('webhooks_received',{'type':_0x23dd30(0xea),'gateway':_0x413869,'headers':_0x1150a9,'data':_0x5bacad});}[a44_0x3d565c(0xc1)](_0x274dbf,_0x1ed0d5,_0x316382,_0x472f50,_0x1290dd){const _0xc242c8=a44_0x3d565c;this[_0xc242c8(0xdc)](_0xc242c8(0xfb),{'type':_0xc242c8(0xe5),'gateway':_0x274dbf,'paymentId':_0x1ed0d5,'oldStatus':_0x316382,'newStatus':_0x472f50,'originalData':_0x1290dd});}[a44_0x3d565c(0xb8)](_0x36ece2,_0x36aff1,_0x19a795){const _0x45b37a=a44_0x3d565c;this[_0x45b37a(0xdc)](_0x45b37a(0xba),{'type':_0x45b37a(0xf0),'gateway':_0x36ece2,'error':_0x36aff1 instanceof Error?{'message':_0x36aff1[_0x45b37a(0xf7)],'stack':_0x36aff1[_0x45b37a(0xc0)]}:_0x36aff1,'originalData':_0x19a795});}[a44_0x3d565c(0xe9)](_0x3b2b95,_0x3a62f1,_0x11e317,_0x1553c7,_0x3ac8b3,_0x2ab70c){const _0x59326f=a44_0x3d565c;this[_0x59326f(0xdc)](_0x59326f(0xd5),{'type':'SHOP_WEBHOOK_SENT','shopId':_0x3b2b95,'webhookUrl':_0x3a62f1,'event':_0x11e317,'status':_0x1553c7,'responseTime':_0x3ac8b3,'payload':_0x2ab70c});}['logShopWebhookError'](_0xb21d1,_0x3d375b,_0x2ca267,_0x40b52f,_0x28b07e){const _0x141914=a44_0x3d565c;this[_0x141914(0xdc)](_0x141914(0xc9),{'type':'SHOP_WEBHOOK_ERROR','shopId':_0xb21d1,'webhookUrl':_0x3d375b,'event':_0x2ca267,'error':_0x40b52f instanceof Error?{'message':_0x40b52f[_0x141914(0xf7)],'stack':_0x40b52f[_0x141914(0xc0)]}:_0x40b52f,'payload':_0x28b07e});}[a44_0x3d565c(0xcd)](_0x28f12c,_0x1839b9,_0x52b88a,_0x22cd5c,_0x171462){const _0x5eeecb=a44_0x3d565c;this[_0x5eeecb(0xdc)](_0x5eeecb(0xe6),{'type':_0x5eeecb(0xcb),'gateway':_0x28f12c,'paymentId':_0x1839b9,'shopId':_0x52b88a,'amount':_0x22cd5c,'currency':_0x171462});}[a44_0x3d565c(0xe2)](_0x5a898d,_0x409f9e,_0x5c3a05,_0x54e838,_0x59bb6c){const _0x30bc6e=a44_0x3d565c;this['writeLog'](_0x30bc6e(0xfa),{'type':_0x30bc6e(0xb6),'endpoint':_0x5a898d,'method':_0x409f9e,'userId':_0x5c3a05,'userRole':_0x54e838,'requestData':_0x59bb6c});}[a44_0x3d565c(0xc4)](){const _0x49a51b=a44_0x3d565c;try{const _0x40d9d3=fs_1[_0x49a51b(0xd3)][_0x49a51b(0xd4)](this[_0x49a51b(0xb7)]),_0xed5dab=_0x40d9d3[_0x49a51b(0xbd)](_0x30b9f6=>_0x30b9f6['endsWith'](_0x49a51b(0xc2))),_0xa6499=[...new Set(_0xed5dab['map'](_0x1af387=>_0x1af387[_0x49a51b(0xbb)]('_')[0x0]))],_0x28f5d0=_0xed5dab['map'](_0x2fb978=>{const _0xb111a2=_0x49a51b,_0x8e6df=path_1[_0xb111a2(0xd3)][_0xb111a2(0xeb)](this[_0xb111a2(0xb7)],_0x2fb978),_0x590cc7=fs_1['default'][_0xb111a2(0xdf)](_0x8e6df),[_0x206bda,_0x4518a0]=_0x2fb978[_0xb111a2(0xb5)]('.log','')[_0xb111a2(0xbb)]('_');return{'type':_0x206bda,'date':_0x4518a0,'size':_0x590cc7['size']};})[_0x49a51b(0xcf)]((_0x453bfd,_0x3ef9d8)=>_0x3ef9d8[_0x49a51b(0xd1)][_0x49a51b(0xbc)](_0x453bfd['date']));return{'totalFiles':_0xed5dab['length'],'logTypes':_0xa6499,'latestLogs':_0x28f5d0['slice'](0x0,0xa)};}catch(_0x2cfacb){return console[_0x49a51b(0xb9)](_0x49a51b(0xc5),_0x2cfacb),{'totalFiles':0x0,'logTypes':[],'latestLogs':[]};}}['cleanOldLogs'](_0x7b4b55=0x1e){const _0x3dd8cc=a44_0x3d565c;try{const _0x400301=fs_1[_0x3dd8cc(0xd3)]['readdirSync'](this['logsDir']),_0x181d88=new Date();_0x181d88[_0x3dd8cc(0xda)](_0x181d88[_0x3dd8cc(0xc7)]()-_0x7b4b55);let _0x3cc2ac=0x0;_0x400301['forEach'](_0xeae5c3=>{const _0x1d6b69=_0x3dd8cc;if(!_0xeae5c3[_0x1d6b69(0xef)](_0x1d6b69(0xc2)))return;const _0x3882be=path_1['default']['join'](this[_0x1d6b69(0xb7)],_0xeae5c3),_0x8239a4=fs_1[_0x1d6b69(0xd3)][_0x1d6b69(0xdf)](_0x3882be);_0x8239a4[_0x1d6b69(0xd6)]<_0x181d88&&(fs_1[_0x1d6b69(0xd3)][_0x1d6b69(0xfd)](_0x3882be),_0x3cc2ac++,console[_0x1d6b69(0xf3)](_0x1d6b69(0xed)+_0xeae5c3));}),console[_0x3dd8cc(0xf3)]('ðŸ§¹\x20Cleaned\x20'+_0x3cc2ac+_0x3dd8cc(0xee)+_0x7b4b55+_0x3dd8cc(0xcc));}catch(_0x4b681b){console[_0x3dd8cc(0xb9)](_0x3dd8cc(0xf4),_0x4b681b);}}}exports['LoggerService']=LoggerService,exports[a44_0x3d565c(0xc3)]=new LoggerService();