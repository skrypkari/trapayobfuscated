'use strict';const a47_0x284517=a47_0xb49e;(function(_0x23c15d,_0x25f3f3){const _0x571ffd=a47_0xb49e,_0x2f636f=_0x23c15d();while(!![]){try{const _0x35c073=parseInt(_0x571ffd(0x1e6))/0x1+-parseInt(_0x571ffd(0x1cd))/0x2*(parseInt(_0x571ffd(0x1ef))/0x3)+-parseInt(_0x571ffd(0x1d2))/0x4*(parseInt(_0x571ffd(0x1f9))/0x5)+parseInt(_0x571ffd(0x1cc))/0x6*(parseInt(_0x571ffd(0x1e0))/0x7)+parseInt(_0x571ffd(0x1c7))/0x8+parseInt(_0x571ffd(0x207))/0x9*(-parseInt(_0x571ffd(0x1fa))/0xa)+parseInt(_0x571ffd(0x1ee))/0xb;if(_0x35c073===_0x25f3f3)break;else _0x2f636f['push'](_0x2f636f['shift']());}catch(_0x5f558d){_0x2f636f['push'](_0x2f636f['shift']());}}}(a47_0x3595,0x6a7ee));var __importDefault=this&&this[a47_0x284517(0x1db)]||function(_0xde167d){const _0x494540=a47_0x284517;return _0xde167d&&_0xde167d[_0x494540(0x216)]?_0xde167d:{'default':_0xde167d};};Object[a47_0x284517(0x1c5)](exports,a47_0x284517(0x216),{'value':!![]}),exports[a47_0x284517(0x1c6)]=exports[a47_0x284517(0x1cf)]=void 0x0;const fs_1=__importDefault(require('fs')),path_1=__importDefault(require(a47_0x284517(0x209)));function a47_0xb49e(_0x2b20b1,_0x7de470){const _0x3595a9=a47_0x3595();return a47_0xb49e=function(_0xb49ebd,_0x5941c3){_0xb49ebd=_0xb49ebd-0x1c5;let _0xadf4c6=_0x3595a9[_0xb49ebd];return _0xadf4c6;},a47_0xb49e(_0x2b20b1,_0x7de470);}class LoggerService{constructor(){const _0x37d4c4=a47_0x284517;this[_0x37d4c4(0x1f8)]=path_1[_0x37d4c4(0x20b)][_0x37d4c4(0x20f)](process['cwd'](),_0x37d4c4(0x1e5)),this[_0x37d4c4(0x203)]();}[a47_0x284517(0x203)](){const _0x5dc79f=a47_0x284517;!fs_1[_0x5dc79f(0x20b)][_0x5dc79f(0x1f6)](this['logsDir'])&&(fs_1[_0x5dc79f(0x20b)][_0x5dc79f(0x1fe)](this[_0x5dc79f(0x1f8)],{'recursive':!![]}),console[_0x5dc79f(0x1e1)](_0x5dc79f(0x215)+this['logsDir']));}['getLogFileName'](_0x54dc82){const _0x5bbc34=a47_0x284517,_0x222337=new Date()[_0x5bbc34(0x1ed)]()['split']('T')[0x0];return path_1[_0x5bbc34(0x20b)][_0x5bbc34(0x20f)](this['logsDir'],_0x54dc82+'_'+_0x222337+_0x5bbc34(0x211));}[a47_0x284517(0x1da)](_0x28c563,_0x3ec8e2){const _0x1c5748=a47_0x284517;try{const _0x37cc3d=new Date()[_0x1c5748(0x1ed)](),_0x1d4732={'timestamp':_0x37cc3d,..._0x3ec8e2},_0xa394bb=JSON[_0x1c5748(0x217)](_0x1d4732)+'\x0a',_0x3f03bb=this['getLogFileName'](_0x28c563);fs_1[_0x1c5748(0x20b)]['appendFileSync'](_0x3f03bb,_0xa394bb,_0x1c5748(0x1e9));}catch(_0x583789){console[_0x1c5748(0x1d6)](_0x1c5748(0x212)+_0x28c563+_0x1c5748(0x1fc),_0x583789);}}[a47_0x284517(0x1c9)](_0x2742bc,_0x1a5810,_0x5a0122,_0x2dba26){const _0x27dc4a=a47_0x284517;this[_0x27dc4a(0x1da)](_0x27dc4a(0x1ce),{'type':_0x27dc4a(0x206),'gateway':_0x2742bc,'endpoint':_0x1a5810,'method':_0x5a0122,'data':_0x2dba26});}[a47_0x284517(0x1ca)](_0x5c9303,_0x2dcf8f,_0x46a29c,_0x2c8359,_0x4bb9cd){const _0x23f8cf=a47_0x284517;this[_0x23f8cf(0x1da)](_0x23f8cf(0x1f7),{'type':_0x23f8cf(0x1eb),'gateway':_0x5c9303,'endpoint':_0x2dcf8f,'status':_0x46a29c,'responseTime':_0x4bb9cd,'data':_0x2c8359});}[a47_0x284517(0x1d4)](_0x2f1f2d,_0x1fd64b,_0x8e060b){const _0x3b2eb7=a47_0x284517;this[_0x3b2eb7(0x1da)](_0x3b2eb7(0x1d9),{'type':_0x3b2eb7(0x202),'gateway':_0x2f1f2d,'endpoint':_0x1fd64b,'error':_0x8e060b instanceof Error?{'message':_0x8e060b[_0x3b2eb7(0x1d8)],'stack':_0x8e060b['stack']}:_0x8e060b});}[a47_0x284517(0x1ec)](_0x2ef43a,_0x41c22e,_0x238603){const _0x103c55=a47_0x284517;this[_0x103c55(0x1da)](_0x103c55(0x20a),{'type':'WEBHOOK_RECEIVED','gateway':_0x2ef43a,'headers':_0x238603,'data':_0x41c22e});}[a47_0x284517(0x1e3)](_0x136d28,_0x162c08,_0x5e5ec8,_0x11c2a5,_0x4202c3){const _0x4d1d30=a47_0x284517;this[_0x4d1d30(0x1da)](_0x4d1d30(0x214),{'type':'WEBHOOK_PROCESSED','gateway':_0x136d28,'paymentId':_0x162c08,'oldStatus':_0x5e5ec8,'newStatus':_0x11c2a5,'originalData':_0x4202c3});}[a47_0x284517(0x1d7)](_0x2bd4a9,_0x38548b,_0x522fcd){const _0x5d738f=a47_0x284517;this[_0x5d738f(0x1da)](_0x5d738f(0x1dd),{'type':_0x5d738f(0x21a),'gateway':_0x2bd4a9,'error':_0x38548b instanceof Error?{'message':_0x38548b[_0x5d738f(0x1d8)],'stack':_0x38548b['stack']}:_0x38548b,'originalData':_0x522fcd});}[a47_0x284517(0x1d5)](_0x1913d0){const _0x35cb29=a47_0x284517;this[_0x35cb29(0x1da)](_0x35cb29(0x1cb),{'type':_0x35cb29(0x1e2),..._0x1913d0});}[a47_0x284517(0x1c8)](_0x338720){const _0x89dd5f=a47_0x284517;this['writeLog']('cointopay_errors',{'type':_0x89dd5f(0x1e4),..._0x338720});}[a47_0x284517(0x1f2)](_0x51aa26,_0x580d93,_0x76d272,_0x4bbba1,_0xe10717,_0x2e5e71){const _0x3e1a6d=a47_0x284517;this[_0x3e1a6d(0x1da)]('shop_webhooks_sent',{'type':_0x3e1a6d(0x1ff),'shopId':_0x51aa26,'webhookUrl':_0x580d93,'event':_0x76d272,'status':_0x4bbba1,'responseTime':_0xe10717,'payload':_0x2e5e71});}[a47_0x284517(0x1e7)](_0x19b687,_0x546ac2,_0xc1e4d,_0x5ec4f5,_0x14e8bb){const _0x497f41=a47_0x284517;this[_0x497f41(0x1da)](_0x497f41(0x210),{'type':'SHOP_WEBHOOK_ERROR','shopId':_0x19b687,'webhookUrl':_0x546ac2,'event':_0xc1e4d,'error':_0x5ec4f5 instanceof Error?{'message':_0x5ec4f5[_0x497f41(0x1d8)],'stack':_0x5ec4f5[_0x497f41(0x213)]}:_0x5ec4f5,'payload':_0x14e8bb});}[a47_0x284517(0x1d3)](_0x2550f8,_0x2e4456,_0x553095,_0x43103a,_0x25c66b){const _0x442e2d=a47_0x284517;this[_0x442e2d(0x1da)](_0x442e2d(0x219),{'type':'PAYMENT_CREATED','gateway':_0x2550f8,'paymentId':_0x2e4456,'shopId':_0x553095,'amount':_0x43103a,'currency':_0x25c66b});}[a47_0x284517(0x1f3)](_0x541de2,_0x3f4004,_0x491212,_0x12cd80,_0x4a12e6){const _0x322892=a47_0x284517;this['writeLog'](_0x322892(0x1f1),{'type':'API_CALL','endpoint':_0x541de2,'method':_0x3f4004,'userId':_0x491212,'userRole':_0x12cd80,'requestData':_0x4a12e6});}[a47_0x284517(0x1de)](){const _0x45d28f=a47_0x284517;try{const _0xe65647=fs_1[_0x45d28f(0x20b)]['readdirSync'](this[_0x45d28f(0x1f8)]),_0x587744=_0xe65647[_0x45d28f(0x218)](_0x5578f9=>_0x5578f9[_0x45d28f(0x208)](_0x45d28f(0x211))),_0x3f73ba=[...new Set(_0x587744[_0x45d28f(0x20d)](_0x4ba97e=>_0x4ba97e['split']('_')[0x0]))],_0xc5deb5=_0x587744[_0x45d28f(0x20d)](_0x1e4346=>{const _0x40b255=_0x45d28f,_0x5495ff=path_1['default'][_0x40b255(0x20f)](this[_0x40b255(0x1f8)],_0x1e4346),_0x4913e9=fs_1['default'][_0x40b255(0x1f0)](_0x5495ff),[_0x2caa35,_0xa58489]=_0x1e4346['replace'](_0x40b255(0x211),'')['split']('_');return{'type':_0x2caa35,'date':_0xa58489,'size':_0x4913e9['size']};})[_0x45d28f(0x1d1)]((_0x4ab6f4,_0x2992a1)=>_0x2992a1[_0x45d28f(0x1fd)][_0x45d28f(0x1d0)](_0x4ab6f4['date']));return{'totalFiles':_0x587744[_0x45d28f(0x204)],'logTypes':_0x3f73ba,'latestLogs':_0xc5deb5[_0x45d28f(0x1f5)](0x0,0xa)};}catch(_0xd88081){return console['error'](_0x45d28f(0x1f4),_0xd88081),{'totalFiles':0x0,'logTypes':[],'latestLogs':[]};}}[a47_0x284517(0x1ea)](_0x206e19=0x1e){const _0x42037c=a47_0x284517;try{const _0x3f9575=fs_1['default'][_0x42037c(0x200)](this[_0x42037c(0x1f8)]),_0x488fc8=new Date();_0x488fc8[_0x42037c(0x1e8)](_0x488fc8[_0x42037c(0x20e)]()-_0x206e19);let _0x3b8d67=0x0;_0x3f9575[_0x42037c(0x1dc)](_0x1b67e0=>{const _0x57a59c=_0x42037c;if(!_0x1b67e0['endsWith'](_0x57a59c(0x211)))return;const _0x288c=path_1[_0x57a59c(0x20b)][_0x57a59c(0x20f)](this[_0x57a59c(0x1f8)],_0x1b67e0),_0x5cb06f=fs_1[_0x57a59c(0x20b)][_0x57a59c(0x1f0)](_0x288c);_0x5cb06f[_0x57a59c(0x20c)]<_0x488fc8&&(fs_1[_0x57a59c(0x20b)]['unlinkSync'](_0x288c),_0x3b8d67++,console[_0x57a59c(0x1e1)](_0x57a59c(0x1df)+_0x1b67e0));}),console['log'](_0x42037c(0x201)+_0x3b8d67+_0x42037c(0x205)+_0x206e19+'\x20days)');}catch(_0x380507){console[_0x42037c(0x1d6)](_0x42037c(0x1fb),_0x380507);}}}exports['LoggerService']=LoggerService,exports['loggerService']=new LoggerService();function a47_0x3595(){const _0x277104=['logCoinToPayStatus','error','logWebhookError','message','white_domain_errors','writeLog','__importDefault','forEach','webhooks_errors','getLogStats','🗑️\x20Deleted\x20old\x20log\x20file:\x20','20363LDqnGO','log','COINTOPAY_STATUS_CHANGE','logWebhookProcessed','COINTOPAY_ERROR','logs','468810eaDbsa','logShopWebhookError','setDate','utf8','cleanOldLogs','RESPONSE','logWebhookReceived','toISOString','1012352mUxJIy','135rDKJEC','statSync','api_calls','logShopWebhookSent','logApiCall','Failed\x20to\x20get\x20log\x20stats:','slice','existsSync','white_domain_responses','logsDir','1328030rOImNd','10QPCNri','Failed\x20to\x20clean\x20old\x20logs:','\x20log:','date','mkdirSync','SHOP_WEBHOOK_SENT','readdirSync','🧹\x20Cleaned\x20','ERROR','ensureLogsDirectory','length','\x20old\x20log\x20files\x20(older\x20than\x20','REQUEST','1475937XMxzlY','endsWith','path','webhooks_received','default','mtime','map','getDate','join','shop_webhooks_errors','.log','Failed\x20to\x20write\x20','stack','webhooks_processed','📁\x20Created\x20logs\x20directory:\x20','__esModule','stringify','filter','payments_created','WEBHOOK_ERROR','defineProperty','loggerService','1523848sKlKiy','logCoinToPayError','logWhiteDomainRequest','logWhiteDomainResponse','cointopay_status_changes','1506UxnMzb','3754fWdHlo','white_domain_requests','LoggerService','localeCompare','sort','12YDpWqC','logPaymentCreated','logWhiteDomainError'];a47_0x3595=function(){return _0x277104;};return a47_0x3595();}