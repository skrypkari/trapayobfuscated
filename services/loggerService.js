'use strict';const a44_0x288410=a44_0x97c2;(function(_0x49a780,_0x11fef3){const _0xa9b8b2=a44_0x97c2,_0x315265=_0x49a780();while(!![]){try{const _0x1b45e0=-parseInt(_0xa9b8b2(0x1b5))/0x1*(-parseInt(_0xa9b8b2(0x182))/0x2)+-parseInt(_0xa9b8b2(0x17c))/0x3*(-parseInt(_0xa9b8b2(0x175))/0x4)+parseInt(_0xa9b8b2(0x1af))/0x5*(-parseInt(_0xa9b8b2(0x1a2))/0x6)+parseInt(_0xa9b8b2(0x172))/0x7+-parseInt(_0xa9b8b2(0x171))/0x8+parseInt(_0xa9b8b2(0x169))/0x9*(parseInt(_0xa9b8b2(0x192))/0xa)+-parseInt(_0xa9b8b2(0x1bb))/0xb;if(_0x1b45e0===_0x11fef3)break;else _0x315265['push'](_0x315265['shift']());}catch(_0x5a3e1a){_0x315265['push'](_0x315265['shift']());}}}(a44_0x35d5,0x8b3c5));function a44_0x97c2(_0x30e534,_0x8b4615){const _0x35d5ee=a44_0x35d5();return a44_0x97c2=function(_0x97c2c1,_0x54560b){_0x97c2c1=_0x97c2c1-0x168;let _0x4428a2=_0x35d5ee[_0x97c2c1];return _0x4428a2;},a44_0x97c2(_0x30e534,_0x8b4615);}var __importDefault=this&&this[a44_0x288410(0x181)]||function(_0x576702){return _0x576702&&_0x576702['__esModule']?_0x576702:{'default':_0x576702};};Object[a44_0x288410(0x19f)](exports,a44_0x288410(0x17a),{'value':!![]}),exports[a44_0x288410(0x19e)]=exports[a44_0x288410(0x1b9)]=void 0x0;const fs_1=__importDefault(require('fs')),path_1=__importDefault(require(a44_0x288410(0x177)));class LoggerService{constructor(){const _0x18219a=a44_0x288410;this[_0x18219a(0x1ac)]=path_1['default'][_0x18219a(0x18b)](process['cwd'](),_0x18219a(0x16a)),this['ensureLogsDirectory']();}[a44_0x288410(0x194)](){const _0x45b537=a44_0x288410;!fs_1[_0x45b537(0x1bc)]['existsSync'](this[_0x45b537(0x1ac)])&&(fs_1[_0x45b537(0x1bc)]['mkdirSync'](this[_0x45b537(0x1ac)],{'recursive':!![]}),console[_0x45b537(0x198)](_0x45b537(0x1b3)+this[_0x45b537(0x1ac)]));}[a44_0x288410(0x1b8)](_0xc3a9ca){const _0x5a16af=a44_0x288410,_0x1cc597=new Date()[_0x5a16af(0x1b1)]()[_0x5a16af(0x1ae)]('T')[0x0];return path_1['default']['join'](this['logsDir'],_0xc3a9ca+'_'+_0x1cc597+_0x5a16af(0x1a0));}[a44_0x288410(0x178)](_0x34f68c,_0x11ba9b){const _0x5895a3=a44_0x288410;try{const _0x555b7f=new Date()[_0x5895a3(0x1b1)](),_0x23a575={'timestamp':_0x555b7f,..._0x11ba9b},_0x27d3d5=JSON[_0x5895a3(0x17e)](_0x23a575)+'\x0a',_0x5e8a41=this[_0x5895a3(0x1b8)](_0x34f68c);fs_1[_0x5895a3(0x1bc)][_0x5895a3(0x1b4)](_0x5e8a41,_0x27d3d5,_0x5895a3(0x186));}catch(_0x3495bf){console[_0x5895a3(0x19d)](_0x5895a3(0x1b0)+_0x34f68c+_0x5895a3(0x16b),_0x3495bf);}}[a44_0x288410(0x1a1)](_0x28b89a,_0x324a8a,_0x263692,_0x17905b){const _0x46d182=a44_0x288410;this[_0x46d182(0x178)](_0x46d182(0x18e),{'type':_0x46d182(0x197),'gateway':_0x28b89a,'endpoint':_0x324a8a,'method':_0x263692,'data':_0x17905b});}[a44_0x288410(0x1a9)](_0x276d9d,_0x5af004,_0xc2e974,_0xa32b21,_0x4de2dd){const _0x1f632a=a44_0x288410;this[_0x1f632a(0x178)](_0x1f632a(0x199),{'type':'RESPONSE','gateway':_0x276d9d,'endpoint':_0x5af004,'status':_0xc2e974,'responseTime':_0x4de2dd,'data':_0xa32b21});}['logWhiteDomainError'](_0x539c95,_0x502eb7,_0x270f47){const _0x5e5f47=a44_0x288410;this[_0x5e5f47(0x178)]('white_domain_errors',{'type':_0x5e5f47(0x18c),'gateway':_0x539c95,'endpoint':_0x502eb7,'error':_0x270f47 instanceof Error?{'message':_0x270f47[_0x5e5f47(0x1a5)],'stack':_0x270f47[_0x5e5f47(0x174)]}:_0x270f47});}[a44_0x288410(0x173)](_0xcf942f,_0x2590d5,_0x33f69){const _0x3d24d9=a44_0x288410;this[_0x3d24d9(0x178)]('webhooks_received',{'type':_0x3d24d9(0x195),'gateway':_0xcf942f,'headers':_0x33f69,'data':_0x2590d5});}['logWebhookProcessed'](_0x2430d5,_0x3fbd42,_0x542c23,_0x11dc2a,_0x2a1155){const _0x2e6aef=a44_0x288410;this[_0x2e6aef(0x178)](_0x2e6aef(0x18f),{'type':'WEBHOOK_PROCESSED','gateway':_0x2430d5,'paymentId':_0x3fbd42,'oldStatus':_0x542c23,'newStatus':_0x11dc2a,'originalData':_0x2a1155});}[a44_0x288410(0x17b)](_0x497982,_0x2991b8,_0x5dba63){const _0x26bc17=a44_0x288410;this[_0x26bc17(0x178)](_0x26bc17(0x19b),{'type':_0x26bc17(0x1a3),'gateway':_0x497982,'error':_0x2991b8 instanceof Error?{'message':_0x2991b8[_0x26bc17(0x1a5)],'stack':_0x2991b8[_0x26bc17(0x174)]}:_0x2991b8,'originalData':_0x5dba63});}[a44_0x288410(0x193)](_0x3942d7){const _0x65d064=a44_0x288410;this['writeLog'](_0x65d064(0x1a4),{'type':_0x65d064(0x168),..._0x3942d7});}[a44_0x288410(0x1a6)](_0x56988d){const _0x42edf0=a44_0x288410;this[_0x42edf0(0x178)]('cointopay_errors',{'type':'COINTOPAY_ERROR',..._0x56988d});}[a44_0x288410(0x1aa)](_0x84f0c5,_0x9e6e86,_0x3dc9cc,_0x5c7ee7,_0x4c87cf,_0x4f53d4){const _0x57edb4=a44_0x288410;this[_0x57edb4(0x178)](_0x57edb4(0x179),{'type':_0x57edb4(0x1b2),'shopId':_0x84f0c5,'webhookUrl':_0x9e6e86,'event':_0x3dc9cc,'status':_0x5c7ee7,'responseTime':_0x4c87cf,'payload':_0x4f53d4});}[a44_0x288410(0x18d)](_0x210f16,_0x58ef0f,_0x558a91,_0x4f3af0,_0x44dc50){const _0xaac80b=a44_0x288410;this[_0xaac80b(0x178)](_0xaac80b(0x18a),{'type':_0xaac80b(0x190),'shopId':_0x210f16,'webhookUrl':_0x58ef0f,'event':_0x558a91,'error':_0x4f3af0 instanceof Error?{'message':_0x4f3af0[_0xaac80b(0x1a5)],'stack':_0x4f3af0[_0xaac80b(0x174)]}:_0x4f3af0,'payload':_0x44dc50});}[a44_0x288410(0x19a)](_0x315da1,_0x503e7d,_0x310226,_0x5ba679,_0x4dbe87){const _0x111470=a44_0x288410;this[_0x111470(0x178)](_0x111470(0x19c),{'type':_0x111470(0x191),'gateway':_0x315da1,'paymentId':_0x503e7d,'shopId':_0x310226,'amount':_0x5ba679,'currency':_0x4dbe87});}[a44_0x288410(0x1ba)](_0x17b3f6,_0x1e386b,_0x145124,_0x2b7185,_0x316d0a){const _0x562ef8=a44_0x288410;this[_0x562ef8(0x178)](_0x562ef8(0x170),{'type':_0x562ef8(0x189),'endpoint':_0x17b3f6,'method':_0x1e386b,'userId':_0x145124,'userRole':_0x2b7185,'requestData':_0x316d0a});}[a44_0x288410(0x1a8)](){const _0x2c6909=a44_0x288410;try{const _0x51d212=fs_1[_0x2c6909(0x1bc)]['readdirSync'](this['logsDir']),_0x3080fa=_0x51d212[_0x2c6909(0x176)](_0x525f40=>_0x525f40['endsWith'](_0x2c6909(0x1a0))),_0x2671e2=[...new Set(_0x3080fa[_0x2c6909(0x16c)](_0x141c83=>_0x141c83[_0x2c6909(0x1ae)]('_')[0x0]))],_0x4b96aa=_0x3080fa['map'](_0x396fe6=>{const _0x422d63=_0x2c6909,_0x248eff=path_1[_0x422d63(0x1bc)]['join'](this[_0x422d63(0x1ac)],_0x396fe6),_0x10acc9=fs_1[_0x422d63(0x1bc)][_0x422d63(0x1b7)](_0x248eff),[_0x3ff4ba,_0x454986]=_0x396fe6['replace'](_0x422d63(0x1a0),'')[_0x422d63(0x1ae)]('_');return{'type':_0x3ff4ba,'date':_0x454986,'size':_0x10acc9[_0x422d63(0x185)]};})[_0x2c6909(0x16d)]((_0x22c19c,_0x4dac05)=>_0x4dac05[_0x2c6909(0x17d)][_0x2c6909(0x1b6)](_0x22c19c[_0x2c6909(0x17d)]));return{'totalFiles':_0x3080fa[_0x2c6909(0x180)],'logTypes':_0x2671e2,'latestLogs':_0x4b96aa[_0x2c6909(0x184)](0x0,0xa)};}catch(_0x1128b0){return console[_0x2c6909(0x19d)](_0x2c6909(0x16e),_0x1128b0),{'totalFiles':0x0,'logTypes':[],'latestLogs':[]};}}['cleanOldLogs'](_0x59dbd0=0x1e){const _0x38cfe8=a44_0x288410;try{const _0x192b51=fs_1[_0x38cfe8(0x1bc)][_0x38cfe8(0x17f)](this['logsDir']),_0x4fef21=new Date();_0x4fef21[_0x38cfe8(0x188)](_0x4fef21[_0x38cfe8(0x1a7)]()-_0x59dbd0);let _0x58aec2=0x0;_0x192b51['forEach'](_0x3a885d=>{const _0x2aeb27=_0x38cfe8;if(!_0x3a885d[_0x2aeb27(0x1ab)]('.log'))return;const _0x14820c=path_1[_0x2aeb27(0x1bc)]['join'](this[_0x2aeb27(0x1ac)],_0x3a885d),_0x4f00a5=fs_1[_0x2aeb27(0x1bc)][_0x2aeb27(0x1b7)](_0x14820c);_0x4f00a5['mtime']<_0x4fef21&&(fs_1[_0x2aeb27(0x1bc)]['unlinkSync'](_0x14820c),_0x58aec2++,console['log'](_0x2aeb27(0x1ad)+_0x3a885d));}),console[_0x38cfe8(0x198)](_0x38cfe8(0x16f)+_0x58aec2+_0x38cfe8(0x187)+_0x59dbd0+_0x38cfe8(0x196));}catch(_0x4dc342){console['error'](_0x38cfe8(0x183),_0x4dc342);}}}function a44_0x35d5(){const _0x16917f=['map','sort','Failed\x20to\x20get\x20log\x20stats:','ðŸ§¹\x20Cleaned\x20','api_calls','2686568YmecuD','1786792LpoiWK','logWebhookReceived','stack','1004fyByMR','filter','path','writeLog','shop_webhooks_sent','__esModule','logWebhookError','13089wYmSXf','date','stringify','readdirSync','length','__importDefault','330286JqVtfN','Failed\x20to\x20clean\x20old\x20logs:','slice','size','utf8','\x20old\x20log\x20files\x20(older\x20than\x20','setDate','API_CALL','shop_webhooks_errors','join','ERROR','logShopWebhookError','white_domain_requests','webhooks_processed','SHOP_WEBHOOK_ERROR','PAYMENT_CREATED','293570JJwHFd','logCoinToPayStatus','ensureLogsDirectory','WEBHOOK_RECEIVED','\x20days)','REQUEST','log','white_domain_responses','logPaymentCreated','webhooks_errors','payments_created','error','loggerService','defineProperty','.log','logWhiteDomainRequest','72MIQvDC','WEBHOOK_ERROR','cointopay_status_changes','message','logCoinToPayError','getDate','getLogStats','logWhiteDomainResponse','logShopWebhookSent','endsWith','logsDir','ðŸ—‘ï¸\x20Deleted\x20old\x20log\x20file:\x20','split','464310NwOCUT','Failed\x20to\x20write\x20','toISOString','SHOP_WEBHOOK_SENT','ðŸ“\x20Created\x20logs\x20directory:\x20','appendFileSync','1sXwSaq','localeCompare','statSync','getLogFileName','LoggerService','logApiCall','1226885RJJGYB','default','COINTOPAY_STATUS_CHANGE','189xHViKS','logs','\x20log:'];a44_0x35d5=function(){return _0x16917f;};return a44_0x35d5();}exports[a44_0x288410(0x1b9)]=LoggerService,exports[a44_0x288410(0x19e)]=new LoggerService();