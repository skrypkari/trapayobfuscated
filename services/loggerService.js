'use strict';const a48_0x3d4498=a48_0x12f5;(function(_0x4f1728,_0x4ddcf9){const _0x1e56a3=a48_0x12f5,_0x4b16e6=_0x4f1728();while(!![]){try{const _0xcd0648=parseInt(_0x1e56a3(0x130))/0x1*(-parseInt(_0x1e56a3(0x135))/0x2)+parseInt(_0x1e56a3(0x13a))/0x3+parseInt(_0x1e56a3(0x10c))/0x4+-parseInt(_0x1e56a3(0x13f))/0x5+-parseInt(_0x1e56a3(0x109))/0x6*(parseInt(_0x1e56a3(0x142))/0x7)+-parseInt(_0x1e56a3(0x132))/0x8+parseInt(_0x1e56a3(0x10a))/0x9*(parseInt(_0x1e56a3(0x104))/0xa);if(_0xcd0648===_0x4ddcf9)break;else _0x4b16e6['push'](_0x4b16e6['shift']());}catch(_0x19d926){_0x4b16e6['push'](_0x4b16e6['shift']());}}}(a48_0x5d4e,0x4b641));var __importDefault=this&&this[a48_0x3d4498(0x129)]||function(_0x3739f4){const _0x51720c=a48_0x3d4498;return _0x3739f4&&_0x3739f4[_0x51720c(0x12f)]?_0x3739f4:{'default':_0x3739f4};};Object[a48_0x3d4498(0x105)](exports,a48_0x3d4498(0x12f),{'value':!![]}),exports[a48_0x3d4498(0x11f)]=exports[a48_0x3d4498(0x119)]=void 0x0;const fs_1=__importDefault(require('fs')),path_1=__importDefault(require(a48_0x3d4498(0x12a)));class LoggerService{constructor(){const _0x3f2150=a48_0x3d4498;this[_0x3f2150(0x118)]=path_1[_0x3f2150(0x139)][_0x3f2150(0x10f)](process[_0x3f2150(0x121)](),_0x3f2150(0x10e)),this[_0x3f2150(0x12c)]();}['ensureLogsDirectory'](){const _0x6eb2aa=a48_0x3d4498;!fs_1[_0x6eb2aa(0x139)]['existsSync'](this[_0x6eb2aa(0x118)])&&(fs_1[_0x6eb2aa(0x139)]['mkdirSync'](this[_0x6eb2aa(0x118)],{'recursive':!![]}),console[_0x6eb2aa(0x113)]('📁\x20Created\x20logs\x20directory:\x20'+this['logsDir']));}[a48_0x3d4498(0x11e)](_0x3b1a9b){const _0x30a019=a48_0x3d4498,_0x170b4c=new Date()[_0x30a019(0x14d)]()[_0x30a019(0x114)]('T')[0x0];return path_1['default'][_0x30a019(0x10f)](this[_0x30a019(0x118)],_0x3b1a9b+'_'+_0x170b4c+_0x30a019(0x10b));}[a48_0x3d4498(0x11b)](_0x22c0db,_0x3ef4db){const _0x244c8c=a48_0x3d4498;try{const _0x1b0d95=new Date()[_0x244c8c(0x14d)](),_0x25091d={'timestamp':_0x1b0d95,..._0x3ef4db},_0x17710c=JSON[_0x244c8c(0x115)](_0x25091d)+'\x0a',_0x4f9d9e=this[_0x244c8c(0x11e)](_0x22c0db);fs_1['default'][_0x244c8c(0x102)](_0x4f9d9e,_0x17710c,_0x244c8c(0x13b));}catch(_0x542aa1){console[_0x244c8c(0x14c)]('Failed\x20to\x20write\x20'+_0x22c0db+_0x244c8c(0x116),_0x542aa1);}}[a48_0x3d4498(0x140)](_0x903644,_0x548303,_0x3f88c3,_0x473a4b){const _0x58212b=a48_0x3d4498;this[_0x58212b(0x11b)]('white_domain_requests',{'type':_0x58212b(0x120),'gateway':_0x903644,'endpoint':_0x548303,'method':_0x3f88c3,'data':_0x473a4b});}[a48_0x3d4498(0x146)](_0x387d0d,_0x4c5089,_0x44492e,_0x1d91c2,_0x2954f3){const _0x20813a=a48_0x3d4498;this[_0x20813a(0x11b)](_0x20813a(0x111),{'type':_0x20813a(0x137),'gateway':_0x387d0d,'endpoint':_0x4c5089,'status':_0x44492e,'responseTime':_0x2954f3,'data':_0x1d91c2});}[a48_0x3d4498(0x134)](_0x53b7a9,_0x20c118,_0x1f2708){const _0x16570f=a48_0x3d4498;this[_0x16570f(0x11b)]('white_domain_errors',{'type':_0x16570f(0x14e),'gateway':_0x53b7a9,'endpoint':_0x20c118,'error':_0x1f2708 instanceof Error?{'message':_0x1f2708['message'],'stack':_0x1f2708['stack']}:_0x1f2708});}[a48_0x3d4498(0x106)](_0x1c1666,_0x3a4395,_0x1421e7){const _0x4aa1c9=a48_0x3d4498;this[_0x4aa1c9(0x11b)]('webhooks_received',{'type':'WEBHOOK_RECEIVED','gateway':_0x1c1666,'headers':_0x1421e7,'data':_0x3a4395});}[a48_0x3d4498(0x127)](_0x34a944,_0x5de266,_0x9d3b86,_0x4b86a9,_0x227bd7){const _0x5332ff=a48_0x3d4498;this[_0x5332ff(0x11b)](_0x5332ff(0x13c),{'type':_0x5332ff(0x13d),'gateway':_0x34a944,'paymentId':_0x5de266,'oldStatus':_0x9d3b86,'newStatus':_0x4b86a9,'originalData':_0x227bd7});}[a48_0x3d4498(0x117)](_0x26152c,_0x593eb4,_0x3b6a94){const _0x1947ef=a48_0x3d4498;this['writeLog'](_0x1947ef(0x143),{'type':_0x1947ef(0x149),'gateway':_0x26152c,'error':_0x593eb4 instanceof Error?{'message':_0x593eb4[_0x1947ef(0x12e)],'stack':_0x593eb4[_0x1947ef(0x126)]}:_0x593eb4,'originalData':_0x3b6a94});}[a48_0x3d4498(0x112)](_0x196045){const _0x518958=a48_0x3d4498;this['writeLog'](_0x518958(0x107),{'type':'COINTOPAY_STATUS_CHANGE',..._0x196045});}['logCoinToPayError'](_0x4faace){const _0x463064=a48_0x3d4498;this[_0x463064(0x11b)](_0x463064(0x11a),{'type':'COINTOPAY_ERROR',..._0x4faace});}[a48_0x3d4498(0x138)](_0x33abb4,_0x1a8372,_0x2dd36a,_0x1e810d,_0x40cdbf,_0x210042){const _0x5c3d5a=a48_0x3d4498;this[_0x5c3d5a(0x11b)]('shop_webhooks_sent',{'type':'SHOP_WEBHOOK_SENT','shopId':_0x33abb4,'webhookUrl':_0x1a8372,'event':_0x2dd36a,'status':_0x1e810d,'responseTime':_0x40cdbf,'payload':_0x210042});}[a48_0x3d4498(0x14a)](_0x258fb6,_0x5c2308,_0x4cdc6e,_0x29037e,_0x4e6362){const _0x1bc152=a48_0x3d4498;this[_0x1bc152(0x11b)](_0x1bc152(0x110),{'type':_0x1bc152(0x103),'shopId':_0x258fb6,'webhookUrl':_0x5c2308,'event':_0x4cdc6e,'error':_0x29037e instanceof Error?{'message':_0x29037e[_0x1bc152(0x12e)],'stack':_0x29037e[_0x1bc152(0x126)]}:_0x29037e,'payload':_0x4e6362});}['logPaymentCreated'](_0x5f5da9,_0x382ec9,_0x3219cd,_0x16022f,_0x2a3de5){const _0x4551fc=a48_0x3d4498;this[_0x4551fc(0x11b)](_0x4551fc(0x101),{'type':'PAYMENT_CREATED','gateway':_0x5f5da9,'paymentId':_0x382ec9,'shopId':_0x3219cd,'amount':_0x16022f,'currency':_0x2a3de5});}[a48_0x3d4498(0x145)](_0x5c7780,_0x325b34,_0x3ea18c,_0x1bcdc5,_0x585006){const _0x1c1cce=a48_0x3d4498;this[_0x1c1cce(0x11b)](_0x1c1cce(0x147),{'type':_0x1c1cce(0x100),'endpoint':_0x5c7780,'method':_0x325b34,'userId':_0x3ea18c,'userRole':_0x1bcdc5,'requestData':_0x585006});}[a48_0x3d4498(0x128)](){const _0x5e4a49=a48_0x3d4498;try{const _0x253b70=fs_1[_0x5e4a49(0x139)][_0x5e4a49(0x151)](this[_0x5e4a49(0x118)]),_0x29cb17=_0x253b70[_0x5e4a49(0x148)](_0x420a7b=>_0x420a7b[_0x5e4a49(0x122)](_0x5e4a49(0x10b))),_0x264496=[...new Set(_0x29cb17[_0x5e4a49(0x144)](_0x75c83c=>_0x75c83c[_0x5e4a49(0x114)]('_')[0x0]))],_0x54a302=_0x29cb17['map'](_0x59c4c8=>{const _0x34f69c=_0x5e4a49,_0x12fe53=path_1[_0x34f69c(0x139)]['join'](this['logsDir'],_0x59c4c8),_0x3d13fd=fs_1[_0x34f69c(0x139)][_0x34f69c(0x12b)](_0x12fe53),[_0x175354,_0x56bf25]=_0x59c4c8[_0x34f69c(0x124)](_0x34f69c(0x10b),'')['split']('_');return{'type':_0x175354,'date':_0x56bf25,'size':_0x3d13fd[_0x34f69c(0x141)]};})[_0x5e4a49(0x133)]((_0x98eb2d,_0x4cdff9)=>_0x4cdff9['date'][_0x5e4a49(0x123)](_0x98eb2d[_0x5e4a49(0x108)]));return{'totalFiles':_0x29cb17[_0x5e4a49(0x14b)],'logTypes':_0x264496,'latestLogs':_0x54a302[_0x5e4a49(0x150)](0x0,0xa)};}catch(_0x327977){return console['error'](_0x5e4a49(0x10d),_0x327977),{'totalFiles':0x0,'logTypes':[],'latestLogs':[]};}}['cleanOldLogs'](_0x5cdccc=0x1e){const _0x15bf96=a48_0x3d4498;try{const _0xc50d5d=fs_1[_0x15bf96(0x139)][_0x15bf96(0x151)](this['logsDir']),_0x24473c=new Date();_0x24473c['setDate'](_0x24473c[_0x15bf96(0x11c)]()-_0x5cdccc);let _0x65e965=0x0;_0xc50d5d[_0x15bf96(0x136)](_0x257523=>{const _0x19bf37=_0x15bf96;if(!_0x257523['endsWith'](_0x19bf37(0x10b)))return;const _0x35518f=path_1[_0x19bf37(0x139)][_0x19bf37(0x10f)](this['logsDir'],_0x257523),_0x37d0e9=fs_1[_0x19bf37(0x139)]['statSync'](_0x35518f);_0x37d0e9[_0x19bf37(0x125)]<_0x24473c&&(fs_1[_0x19bf37(0x139)][_0x19bf37(0x11d)](_0x35518f),_0x65e965++,console['log'](_0x19bf37(0x131)+_0x257523));}),console[_0x15bf96(0x113)](_0x15bf96(0x13e)+_0x65e965+_0x15bf96(0x12d)+_0x5cdccc+_0x15bf96(0x14f));}catch(_0x36d884){console[_0x15bf96(0x14c)]('Failed\x20to\x20clean\x20old\x20logs:',_0x36d884);}}}function a48_0x12f5(_0x2cb578,_0x5a45ed){const _0x5d4ec5=a48_0x5d4e();return a48_0x12f5=function(_0x12f558,_0x476b0e){_0x12f558=_0x12f558-0x100;let _0x386a0e=_0x5d4ec5[_0x12f558];return _0x386a0e;},a48_0x12f5(_0x2cb578,_0x5a45ed);}exports['LoggerService']=LoggerService,exports[a48_0x3d4498(0x11f)]=new LoggerService();function a48_0x5d4e(){const _0x4d4dbd=['cointopay_status_changes','date','6CVZSLd','1170513EvxgDI','.log','1065536kLrzPx','Failed\x20to\x20get\x20log\x20stats:','logs','join','shop_webhooks_errors','white_domain_responses','logCoinToPayStatus','log','split','stringify','\x20log:','logWebhookError','logsDir','LoggerService','cointopay_errors','writeLog','getDate','unlinkSync','getLogFileName','loggerService','REQUEST','cwd','endsWith','localeCompare','replace','mtime','stack','logWebhookProcessed','getLogStats','__importDefault','path','statSync','ensureLogsDirectory','\x20old\x20log\x20files\x20(older\x20than\x20','message','__esModule','10RFRuVr','🗑️\x20Deleted\x20old\x20log\x20file:\x20','1041608YYgXEE','sort','logWhiteDomainError','16846bauNuX','forEach','RESPONSE','logShopWebhookSent','default','552441MUUtis','utf8','webhooks_processed','WEBHOOK_PROCESSED','🧹\x20Cleaned\x20','2436445RXCyyi','logWhiteDomainRequest','size','2452863uUObYU','webhooks_errors','map','logApiCall','logWhiteDomainResponse','api_calls','filter','WEBHOOK_ERROR','logShopWebhookError','length','error','toISOString','ERROR','\x20days)','slice','readdirSync','API_CALL','payments_created','appendFileSync','SHOP_WEBHOOK_ERROR','70rWeLjM','defineProperty','logWebhookReceived'];a48_0x5d4e=function(){return _0x4d4dbd;};return a48_0x5d4e();}