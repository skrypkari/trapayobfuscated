'use strict';function a44_0xaa10(_0x56b564,_0x1f71be){const _0x1c199b=a44_0x1c19();return a44_0xaa10=function(_0xaa10d3,_0xd4e615){_0xaa10d3=_0xaa10d3-0x82;let _0x4c2728=_0x1c199b[_0xaa10d3];return _0x4c2728;},a44_0xaa10(_0x56b564,_0x1f71be);}const a44_0x35331d=a44_0xaa10;function a44_0x1c19(){const _0x2a8942=['cleanOldLogs','logsDir','white_domain_errors','RESPONSE','__importDefault','logWhiteDomainError','error','5715213RBukCs','9fbWZiS','forEach','statSync','message','getLogFileName','split','logWebhookProcessed','stack','logs','getDate','Failed\x20to\x20clean\x20old\x20logs:','WEBHOOK_PROCESSED','toISOString','api_calls','\x20days)','join','146283rBDcWI','.log','5004018UgybER','unlinkSync','WEBHOOK_ERROR','map','📁\x20Created\x20logs\x20directory:\x20','logWebhookReceived','1882496jyFRzT','211omVQaA','\x20log:','default','19464520aESAst','shop_webhooks_sent','72VaeQpP','white_domain_responses','logWhiteDomainResponse','localeCompare','writeLog','9990vkyoZv','setDate','__esModule','REQUEST','loggerService','cwd','\x20old\x20log\x20files\x20(older\x20than\x20','webhooks_received','LoggerService','replace','ERROR','webhooks_errors','getLogStats','appendFileSync','4156375bpVmdB','endsWith','sort','log','mtime','white_domain_requests','slice','ensureLogsDirectory','readdirSync','filter','defineProperty','PAYMENT_CREATED','logWebhookError','Failed\x20to\x20write\x20','stringify','shop_webhooks_errors','API_CALL','logShopWebhookError','WEBHOOK_RECEIVED','date','logWhiteDomainRequest'];a44_0x1c19=function(){return _0x2a8942;};return a44_0x1c19();}(function(_0x1fdecd,_0x3a5d0f){const _0x27beb5=a44_0xaa10,_0x57c0e8=_0x1fdecd();while(!![]){try{const _0x3cbf81=-parseInt(_0x27beb5(0x83))/0x1*(parseInt(_0x27beb5(0x8d))/0x2)+parseInt(_0x27beb5(0xc8))/0x3*(-parseInt(_0x27beb5(0x88))/0x4)+parseInt(_0x27beb5(0x9b))/0x5+-parseInt(_0x27beb5(0xca))/0x6+parseInt(_0x27beb5(0xb7))/0x7+-parseInt(_0x27beb5(0x82))/0x8*(parseInt(_0x27beb5(0xb8))/0x9)+parseInt(_0x27beb5(0x86))/0xa;if(_0x3cbf81===_0x3a5d0f)break;else _0x57c0e8['push'](_0x57c0e8['shift']());}catch(_0x4e6d68){_0x57c0e8['push'](_0x57c0e8['shift']());}}}(a44_0x1c19,0x90d4c));var __importDefault=this&&this[a44_0x35331d(0xb4)]||function(_0x51cd01){const _0x5ad5e7=a44_0x35331d;return _0x51cd01&&_0x51cd01[_0x5ad5e7(0x8f)]?_0x51cd01:{'default':_0x51cd01};};Object[a44_0x35331d(0xa5)](exports,a44_0x35331d(0x8f),{'value':!![]}),exports['loggerService']=exports[a44_0x35331d(0x95)]=void 0x0;const fs_1=__importDefault(require('fs')),path_1=__importDefault(require('path'));class LoggerService{constructor(){const _0x7f926=a44_0x35331d;this['logsDir']=path_1[_0x7f926(0x85)]['join'](process[_0x7f926(0x92)](),_0x7f926(0xc0)),this[_0x7f926(0xa2)]();}['ensureLogsDirectory'](){const _0x1c92e5=a44_0x35331d;!fs_1[_0x1c92e5(0x85)]['existsSync'](this['logsDir'])&&(fs_1[_0x1c92e5(0x85)]['mkdirSync'](this['logsDir'],{'recursive':!![]}),console['log'](_0x1c92e5(0xce)+this[_0x1c92e5(0xb1)]));}[a44_0x35331d(0xbc)](_0x5065d7){const _0x385741=a44_0x35331d,_0x73c349=new Date()[_0x385741(0xc4)]()['split']('T')[0x0];return path_1[_0x385741(0x85)]['join'](this[_0x385741(0xb1)],_0x5065d7+'_'+_0x73c349+_0x385741(0xc9));}['writeLog'](_0x37e2c6,_0x1a34ee){const _0x28ab2c=a44_0x35331d;try{const _0x39371b=new Date()[_0x28ab2c(0xc4)](),_0x475c02={'timestamp':_0x39371b,..._0x1a34ee},_0x568a09=JSON[_0x28ab2c(0xa9)](_0x475c02)+'\x0a',_0x4a42dc=this[_0x28ab2c(0xbc)](_0x37e2c6);fs_1[_0x28ab2c(0x85)][_0x28ab2c(0x9a)](_0x4a42dc,_0x568a09,'utf8');}catch(_0x24970a){console[_0x28ab2c(0xb6)](_0x28ab2c(0xa8)+_0x37e2c6+_0x28ab2c(0x84),_0x24970a);}}[a44_0x35331d(0xaf)](_0x179b78,_0x59678f,_0x1d7721,_0xd3e04c){const _0x43ec04=a44_0x35331d;this[_0x43ec04(0x8c)](_0x43ec04(0xa0),{'type':_0x43ec04(0x90),'gateway':_0x179b78,'endpoint':_0x59678f,'method':_0x1d7721,'data':_0xd3e04c});}[a44_0x35331d(0x8a)](_0x1f4f3e,_0x1da9d0,_0x359d32,_0x44d87f,_0x130ac0){const _0x3808fa=a44_0x35331d;this[_0x3808fa(0x8c)](_0x3808fa(0x89),{'type':_0x3808fa(0xb3),'gateway':_0x1f4f3e,'endpoint':_0x1da9d0,'status':_0x359d32,'responseTime':_0x130ac0,'data':_0x44d87f});}[a44_0x35331d(0xb5)](_0x481704,_0x2ae722,_0xfaa637){const _0x235b9b=a44_0x35331d;this[_0x235b9b(0x8c)](_0x235b9b(0xb2),{'type':_0x235b9b(0x97),'gateway':_0x481704,'endpoint':_0x2ae722,'error':_0xfaa637 instanceof Error?{'message':_0xfaa637['message'],'stack':_0xfaa637['stack']}:_0xfaa637});}[a44_0x35331d(0xcf)](_0x400435,_0x50b781,_0x3b7a15){const _0x5c637f=a44_0x35331d;this[_0x5c637f(0x8c)](_0x5c637f(0x94),{'type':_0x5c637f(0xad),'gateway':_0x400435,'headers':_0x3b7a15,'data':_0x50b781});}[a44_0x35331d(0xbe)](_0x40b897,_0x511d47,_0x414d69,_0x150462,_0x25d118){const _0x8b1185=a44_0x35331d;this['writeLog']('webhooks_processed',{'type':_0x8b1185(0xc3),'gateway':_0x40b897,'paymentId':_0x511d47,'oldStatus':_0x414d69,'newStatus':_0x150462,'originalData':_0x25d118});}[a44_0x35331d(0xa7)](_0x33020e,_0x2176cc,_0x5d9bfa){const _0x425dff=a44_0x35331d;this[_0x425dff(0x8c)](_0x425dff(0x98),{'type':_0x425dff(0xcc),'gateway':_0x33020e,'error':_0x2176cc instanceof Error?{'message':_0x2176cc[_0x425dff(0xbb)],'stack':_0x2176cc[_0x425dff(0xbf)]}:_0x2176cc,'originalData':_0x5d9bfa});}['logShopWebhookSent'](_0x480908,_0x23dadb,_0xb173ef,_0x922c59,_0x16a84a,_0x32f573){const _0x2d8245=a44_0x35331d;this[_0x2d8245(0x8c)](_0x2d8245(0x87),{'type':'SHOP_WEBHOOK_SENT','shopId':_0x480908,'webhookUrl':_0x23dadb,'event':_0xb173ef,'status':_0x922c59,'responseTime':_0x16a84a,'payload':_0x32f573});}[a44_0x35331d(0xac)](_0x56255b,_0x5666d1,_0x2d73b5,_0x24776d,_0x3462cb){const _0x2d7500=a44_0x35331d;this[_0x2d7500(0x8c)](_0x2d7500(0xaa),{'type':'SHOP_WEBHOOK_ERROR','shopId':_0x56255b,'webhookUrl':_0x5666d1,'event':_0x2d73b5,'error':_0x24776d instanceof Error?{'message':_0x24776d[_0x2d7500(0xbb)],'stack':_0x24776d['stack']}:_0x24776d,'payload':_0x3462cb});}['logPaymentCreated'](_0x475879,_0x44dec7,_0x13838e,_0xff7d89,_0x574fcc){const _0x596ac7=a44_0x35331d;this['writeLog']('payments_created',{'type':_0x596ac7(0xa6),'gateway':_0x475879,'paymentId':_0x44dec7,'shopId':_0x13838e,'amount':_0xff7d89,'currency':_0x574fcc});}['logApiCall'](_0x5ea3df,_0x7c027d,_0x3c25d3,_0x9c1b08,_0x18f9db){const _0x43afc5=a44_0x35331d;this[_0x43afc5(0x8c)](_0x43afc5(0xc5),{'type':_0x43afc5(0xab),'endpoint':_0x5ea3df,'method':_0x7c027d,'userId':_0x3c25d3,'userRole':_0x9c1b08,'requestData':_0x18f9db});}[a44_0x35331d(0x99)](){const _0xc91117=a44_0x35331d;try{const _0x54a26a=fs_1[_0xc91117(0x85)][_0xc91117(0xa3)](this[_0xc91117(0xb1)]),_0x16bfc7=_0x54a26a[_0xc91117(0xa4)](_0x4cf581=>_0x4cf581[_0xc91117(0x9c)](_0xc91117(0xc9))),_0x3db1bf=[...new Set(_0x16bfc7[_0xc91117(0xcd)](_0x458947=>_0x458947[_0xc91117(0xbd)]('_')[0x0]))],_0x355435=_0x16bfc7[_0xc91117(0xcd)](_0x431685=>{const _0x3e9ff4=_0xc91117,_0x4e1bcc=path_1[_0x3e9ff4(0x85)][_0x3e9ff4(0xc7)](this[_0x3e9ff4(0xb1)],_0x431685),_0x31e3a2=fs_1['default']['statSync'](_0x4e1bcc),[_0xce7d38,_0x5b9795]=_0x431685[_0x3e9ff4(0x96)](_0x3e9ff4(0xc9),'')[_0x3e9ff4(0xbd)]('_');return{'type':_0xce7d38,'date':_0x5b9795,'size':_0x31e3a2['size']};})[_0xc91117(0x9d)]((_0x5fe037,_0xd9b76b)=>_0xd9b76b[_0xc91117(0xae)][_0xc91117(0x8b)](_0x5fe037[_0xc91117(0xae)]));return{'totalFiles':_0x16bfc7['length'],'logTypes':_0x3db1bf,'latestLogs':_0x355435[_0xc91117(0xa1)](0x0,0xa)};}catch(_0x4ecbba){return console[_0xc91117(0xb6)]('Failed\x20to\x20get\x20log\x20stats:',_0x4ecbba),{'totalFiles':0x0,'logTypes':[],'latestLogs':[]};}}[a44_0x35331d(0xb0)](_0x1ea8d3=0x1e){const _0xee7911=a44_0x35331d;try{const _0x54da68=fs_1[_0xee7911(0x85)][_0xee7911(0xa3)](this[_0xee7911(0xb1)]),_0x2a6e51=new Date();_0x2a6e51[_0xee7911(0x8e)](_0x2a6e51[_0xee7911(0xc1)]()-_0x1ea8d3);let _0x582b5b=0x0;_0x54da68[_0xee7911(0xb9)](_0x101640=>{const _0x4801fb=_0xee7911;if(!_0x101640[_0x4801fb(0x9c)](_0x4801fb(0xc9)))return;const _0x33389d=path_1[_0x4801fb(0x85)][_0x4801fb(0xc7)](this[_0x4801fb(0xb1)],_0x101640),_0x2974fc=fs_1[_0x4801fb(0x85)][_0x4801fb(0xba)](_0x33389d);_0x2974fc[_0x4801fb(0x9f)]<_0x2a6e51&&(fs_1[_0x4801fb(0x85)][_0x4801fb(0xcb)](_0x33389d),_0x582b5b++,console[_0x4801fb(0x9e)]('🗑️\x20Deleted\x20old\x20log\x20file:\x20'+_0x101640));}),console['log']('🧹\x20Cleaned\x20'+_0x582b5b+_0xee7911(0x93)+_0x1ea8d3+_0xee7911(0xc6));}catch(_0xf2a084){console[_0xee7911(0xb6)](_0xee7911(0xc2),_0xf2a084);}}}exports['LoggerService']=LoggerService,exports[a44_0x35331d(0x91)]=new LoggerService();