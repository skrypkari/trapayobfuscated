'use strict';const a67_0x356def=a67_0x4566;(function(_0x2c2bff,_0x489b1){const _0x150b0e=a67_0x4566,_0x1e9c96=_0x2c2bff();while(!![]){try{const _0x267a1c=-parseInt(_0x150b0e(0x105))/0x1*(-parseInt(_0x150b0e(0xf1))/0x2)+parseInt(_0x150b0e(0x107))/0x3+-parseInt(_0x150b0e(0xfe))/0x4+parseInt(_0x150b0e(0xe8))/0x5+-parseInt(_0x150b0e(0xd3))/0x6*(parseInt(_0x150b0e(0xf4))/0x7)+parseInt(_0x150b0e(0xdd))/0x8*(parseInt(_0x150b0e(0x10f))/0x9)+-parseInt(_0x150b0e(0xde))/0xa;if(_0x267a1c===_0x489b1)break;else _0x1e9c96['push'](_0x1e9c96['shift']());}catch(_0x28518b){_0x1e9c96['push'](_0x1e9c96['shift']());}}}(a67_0x4b92,0x6c537));function a67_0x4566(_0x31ce1f,_0x130370){_0x31ce1f=_0x31ce1f-0xc9;const _0x4b9228=a67_0x4b92();let _0x4566c7=_0x4b9228[_0x31ce1f];return _0x4566c7;}function a67_0x4b92(){const _0x4d8754=['replace','date','split','log','12mDAleH','writeLog','webhooks_received','message','defineProperty','getLogStats','\x20log:','logWebhookError','cointopay_errors','.log','22744xhVlQK','4674270QeFnlc','readdirSync','API_CALL','size','getLogFileName','setDate','WEBHOOK_PROCESSED','logCoinToPayStatus','SHOP_WEBHOOK_SENT','logWebhookProcessed','1340960eZpiDO','sort','Failed\x20to\x20get\x20log\x20stats:','join','SHOP_WEBHOOK_ERROR','__esModule','loggerService','webhooks_processed','endsWith','6zgtxNJ','logWhiteDomainError','stringify','1221983iFbxVu','mtime','logPaymentCreated','Failed\x20to\x20write\x20','logsDir','ðŸ§¹\x20Cleaned\x20','existsSync','length','filter','REQUEST','782376YMgmXn','\x20old\x20log\x20files\x20(older\x20than\x20','appendFileSync','logWebhookReceived','Failed\x20to\x20clean\x20old\x20logs:','forEach','white_domain_responses','162104hDENoC','default','816195DAIKyT','error','map','stack','ensureLogsDirectory','logWhiteDomainResponse','RESPONSE','cleanOldLogs','1359MKdtuT','getDate','logCoinToPayError','PAYMENT_CREATED','shop_webhooks_sent','logShopWebhookSent','WEBHOOK_RECEIVED','utf8','ðŸ“\x20Created\x20logs\x20directory:\x20','__importDefault','logShopWebhookError','localeCompare','mkdirSync','LoggerService','white_domain_requests','COINTOPAY_ERROR','unlinkSync','toISOString','statSync'];a67_0x4b92=function(){return _0x4d8754;};return a67_0x4b92();}var __importDefault=this&&this[a67_0x356def(0x118)]||function(_0x1a4bf4){const _0x2c683a=a67_0x356def;return _0x1a4bf4&&_0x1a4bf4[_0x2c683a(0xed)]?_0x1a4bf4:{'default':_0x1a4bf4};};Object[a67_0x356def(0xd7)](exports,a67_0x356def(0xed),{'value':!![]}),exports[a67_0x356def(0xee)]=exports[a67_0x356def(0xc9)]=void 0x0;const fs_1=__importDefault(require('fs')),path_1=__importDefault(require('path'));class LoggerService{constructor(){const _0x249e8b=a67_0x356def;this[_0x249e8b(0xf8)]=path_1[_0x249e8b(0x106)][_0x249e8b(0xeb)](process['cwd'](),'logs'),this[_0x249e8b(0x10b)]();}['ensureLogsDirectory'](){const _0x3d5c10=a67_0x356def;!fs_1[_0x3d5c10(0x106)][_0x3d5c10(0xfa)](this[_0x3d5c10(0xf8)])&&(fs_1[_0x3d5c10(0x106)][_0x3d5c10(0x11b)](this['logsDir'],{'recursive':!![]}),console[_0x3d5c10(0xd2)](_0x3d5c10(0x117)+this[_0x3d5c10(0xf8)]));}[a67_0x356def(0xe2)](_0xa7b449){const _0x4c737d=a67_0x356def,_0x27b9fc=new Date()[_0x4c737d(0xcd)]()[_0x4c737d(0xd1)]('T')[0x0];return path_1['default'][_0x4c737d(0xeb)](this[_0x4c737d(0xf8)],_0xa7b449+'_'+_0x27b9fc+_0x4c737d(0xdc));}[a67_0x356def(0xd4)](_0x39f103,_0x28700c){const _0x907694=a67_0x356def;try{const _0x74ff9a=new Date()[_0x907694(0xcd)](),_0x155764={'timestamp':_0x74ff9a,..._0x28700c},_0x33b56a=JSON[_0x907694(0xf3)](_0x155764)+'\x0a',_0x5449b5=this[_0x907694(0xe2)](_0x39f103);fs_1['default'][_0x907694(0x100)](_0x5449b5,_0x33b56a,_0x907694(0x116));}catch(_0x48374e){console['error'](_0x907694(0xf7)+_0x39f103+_0x907694(0xd9),_0x48374e);}}['logWhiteDomainRequest'](_0x8f598e,_0x589600,_0x7938de,_0x49d864){const _0x559b74=a67_0x356def;this[_0x559b74(0xd4)](_0x559b74(0xca),{'type':_0x559b74(0xfd),'gateway':_0x8f598e,'endpoint':_0x589600,'method':_0x7938de,'data':_0x49d864});}[a67_0x356def(0x10c)](_0x5e11a3,_0x4bf8c1,_0x3970c2,_0x1bbaed,_0x22f5e0){const _0x103747=a67_0x356def;this[_0x103747(0xd4)](_0x103747(0x104),{'type':_0x103747(0x10d),'gateway':_0x5e11a3,'endpoint':_0x4bf8c1,'status':_0x3970c2,'responseTime':_0x22f5e0,'data':_0x1bbaed});}[a67_0x356def(0xf2)](_0x2f2114,_0x206a99,_0x185db5){const _0x53ca31=a67_0x356def;this['writeLog']('white_domain_errors',{'type':'ERROR','gateway':_0x2f2114,'endpoint':_0x206a99,'error':_0x185db5 instanceof Error?{'message':_0x185db5[_0x53ca31(0xd6)],'stack':_0x185db5[_0x53ca31(0x10a)]}:_0x185db5});}[a67_0x356def(0x101)](_0x8113c5,_0xbcc655,_0x2e3449){const _0x5706a4=a67_0x356def;this['writeLog'](_0x5706a4(0xd5),{'type':_0x5706a4(0x115),'gateway':_0x8113c5,'headers':_0x2e3449,'data':_0xbcc655});}[a67_0x356def(0xe7)](_0xe3d4e8,_0xd8ad78,_0x2bba23,_0x5cf532,_0x25ff39){const _0x2e36e6=a67_0x356def;this[_0x2e36e6(0xd4)](_0x2e36e6(0xef),{'type':_0x2e36e6(0xe4),'gateway':_0xe3d4e8,'paymentId':_0xd8ad78,'oldStatus':_0x2bba23,'newStatus':_0x5cf532,'originalData':_0x25ff39});}[a67_0x356def(0xda)](_0x512746,_0x2044f2,_0xd60068){const _0x446100=a67_0x356def;this[_0x446100(0xd4)]('webhooks_errors',{'type':'WEBHOOK_ERROR','gateway':_0x512746,'error':_0x2044f2 instanceof Error?{'message':_0x2044f2[_0x446100(0xd6)],'stack':_0x2044f2['stack']}:_0x2044f2,'originalData':_0xd60068});}[a67_0x356def(0xe5)](_0x473540){const _0x1ba8d8=a67_0x356def;this[_0x1ba8d8(0xd4)]('cointopay_status_changes',{'type':'COINTOPAY_STATUS_CHANGE',..._0x473540});}[a67_0x356def(0x111)](_0x1af7d7){const _0x57673b=a67_0x356def;this[_0x57673b(0xd4)](_0x57673b(0xdb),{'type':_0x57673b(0xcb),..._0x1af7d7});}[a67_0x356def(0x114)](_0xf3622f,_0x3b3b71,_0x39bd57,_0x18f516,_0x4a4c29,_0x693251){const _0x4dd161=a67_0x356def;this[_0x4dd161(0xd4)](_0x4dd161(0x113),{'type':_0x4dd161(0xe6),'shopId':_0xf3622f,'webhookUrl':_0x3b3b71,'event':_0x39bd57,'status':_0x18f516,'responseTime':_0x4a4c29,'payload':_0x693251});}[a67_0x356def(0x119)](_0x314f74,_0x61b891,_0x38395b,_0x58afb6,_0x17156){const _0x32fc34=a67_0x356def;this[_0x32fc34(0xd4)]('shop_webhooks_errors',{'type':_0x32fc34(0xec),'shopId':_0x314f74,'webhookUrl':_0x61b891,'event':_0x38395b,'error':_0x58afb6 instanceof Error?{'message':_0x58afb6[_0x32fc34(0xd6)],'stack':_0x58afb6[_0x32fc34(0x10a)]}:_0x58afb6,'payload':_0x17156});}[a67_0x356def(0xf6)](_0x3333c1,_0x3421f6,_0x477441,_0xa1cdf4,_0x59f47c){const _0x5ece02=a67_0x356def;this[_0x5ece02(0xd4)]('payments_created',{'type':_0x5ece02(0x112),'gateway':_0x3333c1,'paymentId':_0x3421f6,'shopId':_0x477441,'amount':_0xa1cdf4,'currency':_0x59f47c});}['logApiCall'](_0x33ddc7,_0x5388db,_0x5c1525,_0x4ece50,_0x1f9dd3){const _0x1cb237=a67_0x356def;this['writeLog']('api_calls',{'type':_0x1cb237(0xe0),'endpoint':_0x33ddc7,'method':_0x5388db,'userId':_0x5c1525,'userRole':_0x4ece50,'requestData':_0x1f9dd3});}[a67_0x356def(0xd8)](){const _0x3e8938=a67_0x356def;try{const _0x2dd126=fs_1[_0x3e8938(0x106)]['readdirSync'](this[_0x3e8938(0xf8)]),_0x181f44=_0x2dd126[_0x3e8938(0xfc)](_0x159ea3=>_0x159ea3['endsWith'](_0x3e8938(0xdc))),_0x450eeb=[...new Set(_0x181f44[_0x3e8938(0x109)](_0x5a33df=>_0x5a33df[_0x3e8938(0xd1)]('_')[0x0]))],_0x473e40=_0x181f44[_0x3e8938(0x109)](_0x34af30=>{const _0x1a50a9=_0x3e8938,_0x4cfea7=path_1[_0x1a50a9(0x106)][_0x1a50a9(0xeb)](this[_0x1a50a9(0xf8)],_0x34af30),_0x2e5013=fs_1['default'][_0x1a50a9(0xce)](_0x4cfea7),[_0x2c642b,_0x24a23c]=_0x34af30[_0x1a50a9(0xcf)](_0x1a50a9(0xdc),'')['split']('_');return{'type':_0x2c642b,'date':_0x24a23c,'size':_0x2e5013[_0x1a50a9(0xe1)]};})[_0x3e8938(0xe9)]((_0x22fa40,_0x2dea68)=>_0x2dea68[_0x3e8938(0xd0)][_0x3e8938(0x11a)](_0x22fa40[_0x3e8938(0xd0)]));return{'totalFiles':_0x181f44[_0x3e8938(0xfb)],'logTypes':_0x450eeb,'latestLogs':_0x473e40['slice'](0x0,0xa)};}catch(_0x3505d3){return console['error'](_0x3e8938(0xea),_0x3505d3),{'totalFiles':0x0,'logTypes':[],'latestLogs':[]};}}[a67_0x356def(0x10e)](_0x249f66=0x1e){const _0x53923e=a67_0x356def;try{const _0x13a97d=fs_1[_0x53923e(0x106)][_0x53923e(0xdf)](this[_0x53923e(0xf8)]),_0x1f80f2=new Date();_0x1f80f2[_0x53923e(0xe3)](_0x1f80f2[_0x53923e(0x110)]()-_0x249f66);let _0x4f8dfe=0x0;_0x13a97d[_0x53923e(0x103)](_0x53e4ae=>{const _0x563d02=_0x53923e;if(!_0x53e4ae[_0x563d02(0xf0)](_0x563d02(0xdc)))return;const _0x41a131=path_1[_0x563d02(0x106)][_0x563d02(0xeb)](this[_0x563d02(0xf8)],_0x53e4ae),_0x5cd546=fs_1[_0x563d02(0x106)][_0x563d02(0xce)](_0x41a131);_0x5cd546[_0x563d02(0xf5)]<_0x1f80f2&&(fs_1[_0x563d02(0x106)][_0x563d02(0xcc)](_0x41a131),_0x4f8dfe++,console[_0x563d02(0xd2)]('ðŸ—‘ï¸\x20Deleted\x20old\x20log\x20file:\x20'+_0x53e4ae));}),console['log'](_0x53923e(0xf9)+_0x4f8dfe+_0x53923e(0xff)+_0x249f66+'\x20days)');}catch(_0xa78cd1){console[_0x53923e(0x108)](_0x53923e(0x102),_0xa78cd1);}}}exports['LoggerService']=LoggerService,exports[a67_0x356def(0xee)]=new LoggerService();