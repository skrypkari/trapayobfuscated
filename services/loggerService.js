'use strict';const a59_0x334d80=a59_0x5245;(function(_0x529fe2,_0x49a89e){const _0x54b245=a59_0x5245,_0x17f9e7=_0x529fe2();while(!![]){try{const _0x48d627=-parseInt(_0x54b245(0x12d))/0x1*(-parseInt(_0x54b245(0x10d))/0x2)+parseInt(_0x54b245(0x116))/0x3+-parseInt(_0x54b245(0x10e))/0x4*(-parseInt(_0x54b245(0x11e))/0x5)+parseInt(_0x54b245(0x135))/0x6*(-parseInt(_0x54b245(0x143))/0x7)+parseInt(_0x54b245(0x152))/0x8+parseInt(_0x54b245(0x108))/0x9*(parseInt(_0x54b245(0x118))/0xa)+-parseInt(_0x54b245(0x130))/0xb;if(_0x48d627===_0x49a89e)break;else _0x17f9e7['push'](_0x17f9e7['shift']());}catch(_0x30887d){_0x17f9e7['push'](_0x17f9e7['shift']());}}}(a59_0x3fb2,0xb202f));var __importDefault=this&&this['__importDefault']||function(_0x32ae36){const _0x3ed923=a59_0x5245;return _0x32ae36&&_0x32ae36[_0x3ed923(0x142)]?_0x32ae36:{'default':_0x32ae36};};function a59_0x5245(_0x3d0b15,_0x2cb6d9){const _0x3fb27c=a59_0x3fb2();return a59_0x5245=function(_0x52455f,_0x34e437){_0x52455f=_0x52455f-0x105;let _0x400393=_0x3fb27c[_0x52455f];return _0x400393;},a59_0x5245(_0x3d0b15,_0x2cb6d9);}Object[a59_0x334d80(0x14e)](exports,a59_0x334d80(0x142),{'value':!![]}),exports[a59_0x334d80(0x131)]=exports['LoggerService']=void 0x0;const fs_1=__importDefault(require('fs')),path_1=__importDefault(require(a59_0x334d80(0x132)));class LoggerService{constructor(){const _0xf6ee2a=a59_0x334d80;this[_0xf6ee2a(0x12b)]=path_1[_0xf6ee2a(0x10b)][_0xf6ee2a(0x106)](process['cwd'](),_0xf6ee2a(0x13c)),this[_0xf6ee2a(0x150)]();}['ensureLogsDirectory'](){const _0x567780=a59_0x334d80;!fs_1['default'][_0x567780(0x109)](this[_0x567780(0x12b)])&&(fs_1[_0x567780(0x10b)]['mkdirSync'](this[_0x567780(0x12b)],{'recursive':!![]}),console[_0x567780(0x14b)]('📁\x20Created\x20logs\x20directory:\x20'+this[_0x567780(0x12b)]));}[a59_0x334d80(0x155)](_0x14ba31){const _0x404b35=a59_0x334d80,_0x1ff9f7=new Date()[_0x404b35(0x139)]()[_0x404b35(0x122)]('T')[0x0];return path_1[_0x404b35(0x10b)][_0x404b35(0x106)](this['logsDir'],_0x14ba31+'_'+_0x1ff9f7+_0x404b35(0x134));}[a59_0x334d80(0x13d)](_0x4f8c32,_0x65513b){const _0x393410=a59_0x334d80;try{const _0x1a0bae=new Date()[_0x393410(0x139)](),_0x4edfe1={'timestamp':_0x1a0bae,..._0x65513b},_0x25901f=JSON[_0x393410(0x159)](_0x4edfe1)+'\x0a',_0x144cbc=this['getLogFileName'](_0x4f8c32);fs_1[_0x393410(0x10b)][_0x393410(0x126)](_0x144cbc,_0x25901f,_0x393410(0x117));}catch(_0x5986a6){console[_0x393410(0x147)](_0x393410(0x14f)+_0x4f8c32+_0x393410(0x11a),_0x5986a6);}}[a59_0x334d80(0x10f)](_0x3b3bd7,_0x3f1682,_0x4a588d,_0x31af2b){const _0x29c405=a59_0x334d80;this[_0x29c405(0x13d)]('white_domain_requests',{'type':_0x29c405(0x13b),'gateway':_0x3b3bd7,'endpoint':_0x3f1682,'method':_0x4a588d,'data':_0x31af2b});}['logWhiteDomainResponse'](_0x3a525c,_0x515016,_0x2b7111,_0x590736,_0x242940){const _0x3184cd=a59_0x334d80;this[_0x3184cd(0x13d)](_0x3184cd(0x129),{'type':_0x3184cd(0x148),'gateway':_0x3a525c,'endpoint':_0x515016,'status':_0x2b7111,'responseTime':_0x242940,'data':_0x590736});}[a59_0x334d80(0x12a)](_0xb8bc7a,_0x5a2ef8,_0x38c7b5){const _0x1ab001=a59_0x334d80;this[_0x1ab001(0x13d)](_0x1ab001(0x140),{'type':_0x1ab001(0x146),'gateway':_0xb8bc7a,'endpoint':_0x5a2ef8,'error':_0x38c7b5 instanceof Error?{'message':_0x38c7b5[_0x1ab001(0x105)],'stack':_0x38c7b5[_0x1ab001(0x115)]}:_0x38c7b5});}['logWebhookReceived'](_0x43ce3f,_0x1d73f9,_0x407192){const _0x781801=a59_0x334d80;this[_0x781801(0x13d)](_0x781801(0x14d),{'type':_0x781801(0x13f),'gateway':_0x43ce3f,'headers':_0x407192,'data':_0x1d73f9});}[a59_0x334d80(0x125)](_0x3991d5,_0x525b55,_0x120bdb,_0x580baf,_0x4933dc){const _0x10d297=a59_0x334d80;this[_0x10d297(0x13d)](_0x10d297(0x13e),{'type':_0x10d297(0x128),'gateway':_0x3991d5,'paymentId':_0x525b55,'oldStatus':_0x120bdb,'newStatus':_0x580baf,'originalData':_0x4933dc});}['logWebhookError'](_0x2f6318,_0x56f394,_0x3e0fb7){const _0x1fe6e1=a59_0x334d80;this[_0x1fe6e1(0x13d)](_0x1fe6e1(0x110),{'type':'WEBHOOK_ERROR','gateway':_0x2f6318,'error':_0x56f394 instanceof Error?{'message':_0x56f394['message'],'stack':_0x56f394[_0x1fe6e1(0x115)]}:_0x56f394,'originalData':_0x3e0fb7});}[a59_0x334d80(0x10a)](_0xeeadf3){const _0x370790=a59_0x334d80;this['writeLog'](_0x370790(0x11c),{'type':_0x370790(0x156),..._0xeeadf3});}[a59_0x334d80(0x12c)](_0x1991ef){const _0xef82fe=a59_0x334d80;this[_0xef82fe(0x13d)](_0xef82fe(0x154),{'type':'COINTOPAY_ERROR',..._0x1991ef});}[a59_0x334d80(0x138)](_0x348a17,_0x32bfc9,_0x51280a,_0x5d54f7,_0x522e7a,_0x491057){const _0x198037=a59_0x334d80;this[_0x198037(0x13d)](_0x198037(0x11b),{'type':'SHOP_WEBHOOK_SENT','shopId':_0x348a17,'webhookUrl':_0x32bfc9,'event':_0x51280a,'status':_0x5d54f7,'responseTime':_0x522e7a,'payload':_0x491057});}[a59_0x334d80(0x145)](_0x5ad3b8,_0x174e87,_0x2142b2,_0x2f0493,_0x244c92){const _0x4acdaa=a59_0x334d80;this[_0x4acdaa(0x13d)]('shop_webhooks_errors',{'type':'SHOP_WEBHOOK_ERROR','shopId':_0x5ad3b8,'webhookUrl':_0x174e87,'event':_0x2142b2,'error':_0x2f0493 instanceof Error?{'message':_0x2f0493[_0x4acdaa(0x105)],'stack':_0x2f0493['stack']}:_0x2f0493,'payload':_0x244c92});}[a59_0x334d80(0x158)](_0x3eacf8,_0x468722,_0x4675cb,_0x1f9a93,_0x48be15){const _0x588c7d=a59_0x334d80;this[_0x588c7d(0x13d)]('payments_created',{'type':_0x588c7d(0x136),'gateway':_0x3eacf8,'paymentId':_0x468722,'shopId':_0x4675cb,'amount':_0x1f9a93,'currency':_0x48be15});}[a59_0x334d80(0x124)](_0x16fe0b,_0x3c973c,_0x3e246a,_0x562447,_0x527b80){const _0x25fa64=a59_0x334d80;this[_0x25fa64(0x13d)](_0x25fa64(0x10c),{'type':_0x25fa64(0x12f),'endpoint':_0x16fe0b,'method':_0x3c973c,'userId':_0x3e246a,'userRole':_0x562447,'requestData':_0x527b80});}[a59_0x334d80(0x107)](){const _0x582da0=a59_0x334d80;try{const _0x360ffe=fs_1[_0x582da0(0x10b)][_0x582da0(0x12e)](this['logsDir']),_0x83f0e1=_0x360ffe[_0x582da0(0x13a)](_0x40e263=>_0x40e263['endsWith'](_0x582da0(0x134))),_0x4c145c=[...new Set(_0x83f0e1[_0x582da0(0x114)](_0x3c54d1=>_0x3c54d1[_0x582da0(0x122)]('_')[0x0]))],_0x4b0056=_0x83f0e1[_0x582da0(0x114)](_0x3320eb=>{const _0x249125=_0x582da0,_0x31f294=path_1['default']['join'](this[_0x249125(0x12b)],_0x3320eb),_0x1143ed=fs_1['default'][_0x249125(0x144)](_0x31f294),[_0x53a9d7,_0x5c109f]=_0x3320eb[_0x249125(0x121)](_0x249125(0x134),'')['split']('_');return{'type':_0x53a9d7,'date':_0x5c109f,'size':_0x1143ed[_0x249125(0x120)]};})[_0x582da0(0x123)]((_0x3aade2,_0x23a699)=>_0x23a699[_0x582da0(0x133)][_0x582da0(0x149)](_0x3aade2[_0x582da0(0x133)]));return{'totalFiles':_0x83f0e1[_0x582da0(0x11f)],'logTypes':_0x4c145c,'latestLogs':_0x4b0056[_0x582da0(0x111)](0x0,0xa)};}catch(_0x30687b){return console[_0x582da0(0x147)](_0x582da0(0x141),_0x30687b),{'totalFiles':0x0,'logTypes':[],'latestLogs':[]};}}[a59_0x334d80(0x127)](_0x36d2fa=0x1e){const _0x2dc282=a59_0x334d80;try{const _0x3ffe7a=fs_1[_0x2dc282(0x10b)]['readdirSync'](this[_0x2dc282(0x12b)]),_0x7fdb39=new Date();_0x7fdb39[_0x2dc282(0x11d)](_0x7fdb39[_0x2dc282(0x151)]()-_0x36d2fa);let _0x41f236=0x0;_0x3ffe7a[_0x2dc282(0x119)](_0x5d16e8=>{const _0x5e2c13=_0x2dc282;if(!_0x5d16e8[_0x5e2c13(0x113)](_0x5e2c13(0x134)))return;const _0x584ed7=path_1[_0x5e2c13(0x10b)][_0x5e2c13(0x106)](this[_0x5e2c13(0x12b)],_0x5d16e8),_0x996ffd=fs_1['default'][_0x5e2c13(0x144)](_0x584ed7);_0x996ffd['mtime']<_0x7fdb39&&(fs_1[_0x5e2c13(0x10b)][_0x5e2c13(0x14c)](_0x584ed7),_0x41f236++,console[_0x5e2c13(0x14b)](_0x5e2c13(0x157)+_0x5d16e8));}),console['log']('🧹\x20Cleaned\x20'+_0x41f236+_0x2dc282(0x112)+_0x36d2fa+_0x2dc282(0x14a));}catch(_0x426051){console['error'](_0x2dc282(0x153),_0x426051);}}}exports[a59_0x334d80(0x137)]=LoggerService,exports[a59_0x334d80(0x131)]=new LoggerService();function a59_0x3fb2(){const _0x2e013c=['path','date','.log','6ETuKbD','PAYMENT_CREATED','LoggerService','logShopWebhookSent','toISOString','filter','REQUEST','logs','writeLog','webhooks_processed','WEBHOOK_RECEIVED','white_domain_errors','Failed\x20to\x20get\x20log\x20stats:','__esModule','6054377Zqxukt','statSync','logShopWebhookError','ERROR','error','RESPONSE','localeCompare','\x20days)','log','unlinkSync','webhooks_received','defineProperty','Failed\x20to\x20write\x20','ensureLogsDirectory','getDate','11542080HGwYTo','Failed\x20to\x20clean\x20old\x20logs:','cointopay_errors','getLogFileName','COINTOPAY_STATUS_CHANGE','🗑️\x20Deleted\x20old\x20log\x20file:\x20','logPaymentCreated','stringify','message','join','getLogStats','135nyxrqF','existsSync','logCoinToPayStatus','default','api_calls','99170PFFdTl','4kYklBg','logWhiteDomainRequest','webhooks_errors','slice','\x20old\x20log\x20files\x20(older\x20than\x20','endsWith','map','stack','2463063vwfSvD','utf8','611570xVFewC','forEach','\x20log:','shop_webhooks_sent','cointopay_status_changes','setDate','2767955sayGRm','length','size','replace','split','sort','logApiCall','logWebhookProcessed','appendFileSync','cleanOldLogs','WEBHOOK_PROCESSED','white_domain_responses','logWhiteDomainError','logsDir','logCoinToPayError','26Ggxwml','readdirSync','API_CALL','37728801UBeRUv','loggerService'];a59_0x3fb2=function(){return _0x2e013c;};return a59_0x3fb2();}