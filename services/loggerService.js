'use strict';const a44_0x1c58dc=a44_0x3cbe;(function(_0x3fa3b2,_0x2adb0e){const _0x24a872=a44_0x3cbe,_0x54f6e3=_0x3fa3b2();while(!![]){try{const _0x2d3661=parseInt(_0x24a872(0x7f))/0x1*(parseInt(_0x24a872(0x8c))/0x2)+-parseInt(_0x24a872(0x86))/0x3+parseInt(_0x24a872(0x98))/0x4+-parseInt(_0x24a872(0x8f))/0x5*(parseInt(_0x24a872(0xa2))/0x6)+parseInt(_0x24a872(0xa0))/0x7*(-parseInt(_0x24a872(0x78))/0x8)+parseInt(_0x24a872(0xb4))/0x9*(-parseInt(_0x24a872(0xbc))/0xa)+-parseInt(_0x24a872(0xb0))/0xb*(-parseInt(_0x24a872(0x75))/0xc);if(_0x2d3661===_0x2adb0e)break;else _0x54f6e3['push'](_0x54f6e3['shift']());}catch(_0x3ef9f8){_0x54f6e3['push'](_0x54f6e3['shift']());}}}(a44_0x44d0,0x92d98));function a44_0x44d0(){const _0xbefc24=['logWhiteDomainError','defineProperty','Failed\x20to\x20get\x20log\x20stats:','2638428dlONHq','getLogFileName','logWebhookProcessed','ensureLogsDirectory','shop_webhooks_errors','join','REQUEST','message','112nsOeGj','split','522yrcKfR','RESPONSE','mtime','Failed\x20to\x20write\x20','error','logsDir','log','webhooks_errors','default','replace','loggerService','\x20old\x20log\x20files\x20(older\x20than\x20','LoggerService','cleanOldLogs','19839853JzOGoF','ðŸ—‘ï¸\x20Deleted\x20old\x20log\x20file:\x20','Failed\x20to\x20clean\x20old\x20logs:','ðŸ“\x20Created\x20logs\x20directory:\x20','9vUWeDA','setDate','__esModule','endsWith','\x20log:','.log','slice','writeLog','10715410CQKkyw','existsSync','getLogStats','shop_webhooks_sent','__importDefault','payments_created','utf8','size','api_calls','ðŸ§¹\x20Cleaned\x20','WEBHOOK_PROCESSED','24rUKofJ','map','ERROR','461192KCBfiy','readdirSync','date','statSync','logs','getDate','API_CALL','1198mdWtUd','WEBHOOK_ERROR','cwd','stringify','sort','length','white_domain_errors','2813151eGzdLD','logApiCall','SHOP_WEBHOOK_ERROR','filter','path','toISOString','74RZguqM','white_domain_requests','logWebhookError','44715SmIXvR','logPaymentCreated','webhooks_processed','stack','logWebhookReceived','mkdirSync'];a44_0x44d0=function(){return _0xbefc24;};return a44_0x44d0();}var __importDefault=this&&this[a44_0x1c58dc(0xc0)]||function(_0x25f1fd){const _0x2b53ca=a44_0x1c58dc;return _0x25f1fd&&_0x25f1fd[_0x2b53ca(0xb6)]?_0x25f1fd:{'default':_0x25f1fd};};Object[a44_0x1c58dc(0x96)](exports,'__esModule',{'value':!![]}),exports[a44_0x1c58dc(0xac)]=exports[a44_0x1c58dc(0xae)]=void 0x0;const fs_1=__importDefault(require('fs')),path_1=__importDefault(require(a44_0x1c58dc(0x8a)));class LoggerService{constructor(){const _0x517a94=a44_0x1c58dc;this['logsDir']=path_1[_0x517a94(0xaa)]['join'](process[_0x517a94(0x81)](),_0x517a94(0x7c)),this['ensureLogsDirectory']();}[a44_0x1c58dc(0x9b)](){const _0x25247f=a44_0x1c58dc;!fs_1[_0x25247f(0xaa)][_0x25247f(0xbd)](this[_0x25247f(0xa7)])&&(fs_1[_0x25247f(0xaa)][_0x25247f(0x94)](this[_0x25247f(0xa7)],{'recursive':!![]}),console[_0x25247f(0xa8)](_0x25247f(0xb3)+this['logsDir']));}[a44_0x1c58dc(0x99)](_0x1deadd){const _0x5108ec=a44_0x1c58dc,_0x494942=new Date()['toISOString']()[_0x5108ec(0xa1)]('T')[0x0];return path_1[_0x5108ec(0xaa)][_0x5108ec(0x9d)](this[_0x5108ec(0xa7)],_0x1deadd+'_'+_0x494942+_0x5108ec(0xb9));}[a44_0x1c58dc(0xbb)](_0x5e4e80,_0x252c5c){const _0x2d7e1b=a44_0x1c58dc;try{const _0x1cc623=new Date()[_0x2d7e1b(0x8b)](),_0x2eac18={'timestamp':_0x1cc623,..._0x252c5c},_0x5a08b5=JSON[_0x2d7e1b(0x82)](_0x2eac18)+'\x0a',_0x43d4e0=this[_0x2d7e1b(0x99)](_0x5e4e80);fs_1[_0x2d7e1b(0xaa)]['appendFileSync'](_0x43d4e0,_0x5a08b5,_0x2d7e1b(0xc2));}catch(_0x461c8b){console[_0x2d7e1b(0xa6)](_0x2d7e1b(0xa5)+_0x5e4e80+_0x2d7e1b(0xb8),_0x461c8b);}}['logWhiteDomainRequest'](_0x57c5d0,_0x15cb38,_0x4d5b38,_0x40a13f){const _0x41be33=a44_0x1c58dc;this[_0x41be33(0xbb)](_0x41be33(0x8d),{'type':_0x41be33(0x9e),'gateway':_0x57c5d0,'endpoint':_0x15cb38,'method':_0x4d5b38,'data':_0x40a13f});}['logWhiteDomainResponse'](_0x23ce90,_0x2b81ce,_0x5bbe1a,_0x126b65,_0x259c11){const _0x33ac08=a44_0x1c58dc;this[_0x33ac08(0xbb)]('white_domain_responses',{'type':_0x33ac08(0xa3),'gateway':_0x23ce90,'endpoint':_0x2b81ce,'status':_0x5bbe1a,'responseTime':_0x259c11,'data':_0x126b65});}[a44_0x1c58dc(0x95)](_0x5ed5d6,_0x1dff83,_0x22ef38){const _0x1aab2b=a44_0x1c58dc;this[_0x1aab2b(0xbb)](_0x1aab2b(0x85),{'type':_0x1aab2b(0x77),'gateway':_0x5ed5d6,'endpoint':_0x1dff83,'error':_0x22ef38 instanceof Error?{'message':_0x22ef38[_0x1aab2b(0x9f)],'stack':_0x22ef38[_0x1aab2b(0x92)]}:_0x22ef38});}[a44_0x1c58dc(0x93)](_0x55b699,_0x5702a2,_0x353f01){const _0x3d1f50=a44_0x1c58dc;this[_0x3d1f50(0xbb)]('webhooks_received',{'type':'WEBHOOK_RECEIVED','gateway':_0x55b699,'headers':_0x353f01,'data':_0x5702a2});}[a44_0x1c58dc(0x9a)](_0x392006,_0x50ba66,_0x45a8f1,_0x59ed1d,_0x1df078){const _0x45d9b8=a44_0x1c58dc;this[_0x45d9b8(0xbb)](_0x45d9b8(0x91),{'type':_0x45d9b8(0x74),'gateway':_0x392006,'paymentId':_0x50ba66,'oldStatus':_0x45a8f1,'newStatus':_0x59ed1d,'originalData':_0x1df078});}[a44_0x1c58dc(0x8e)](_0x175263,_0x30c934,_0x242d1f){const _0x3e9f83=a44_0x1c58dc;this[_0x3e9f83(0xbb)](_0x3e9f83(0xa9),{'type':_0x3e9f83(0x80),'gateway':_0x175263,'error':_0x30c934 instanceof Error?{'message':_0x30c934[_0x3e9f83(0x9f)],'stack':_0x30c934[_0x3e9f83(0x92)]}:_0x30c934,'originalData':_0x242d1f});}['logShopWebhookSent'](_0x5918d2,_0xe07bb9,_0x4251c6,_0x459bf3,_0x5867df,_0x552d47){const _0x548d24=a44_0x1c58dc;this['writeLog'](_0x548d24(0xbf),{'type':'SHOP_WEBHOOK_SENT','shopId':_0x5918d2,'webhookUrl':_0xe07bb9,'event':_0x4251c6,'status':_0x459bf3,'responseTime':_0x5867df,'payload':_0x552d47});}['logShopWebhookError'](_0x55c46c,_0x547e76,_0x3d6143,_0x678e28,_0x44f3d7){const _0x5c1005=a44_0x1c58dc;this[_0x5c1005(0xbb)](_0x5c1005(0x9c),{'type':_0x5c1005(0x88),'shopId':_0x55c46c,'webhookUrl':_0x547e76,'event':_0x3d6143,'error':_0x678e28 instanceof Error?{'message':_0x678e28['message'],'stack':_0x678e28[_0x5c1005(0x92)]}:_0x678e28,'payload':_0x44f3d7});}[a44_0x1c58dc(0x90)](_0x257b32,_0x445cb1,_0x3520fa,_0x395f3c,_0x546977){const _0x34266b=a44_0x1c58dc;this[_0x34266b(0xbb)](_0x34266b(0xc1),{'type':'PAYMENT_CREATED','gateway':_0x257b32,'paymentId':_0x445cb1,'shopId':_0x3520fa,'amount':_0x395f3c,'currency':_0x546977});}[a44_0x1c58dc(0x87)](_0x2d1fc7,_0xa10338,_0x530c81,_0x4779ac,_0x200333){const _0x2c4be3=a44_0x1c58dc;this[_0x2c4be3(0xbb)](_0x2c4be3(0x72),{'type':_0x2c4be3(0x7e),'endpoint':_0x2d1fc7,'method':_0xa10338,'userId':_0x530c81,'userRole':_0x4779ac,'requestData':_0x200333});}[a44_0x1c58dc(0xbe)](){const _0x45ceac=a44_0x1c58dc;try{const _0x446e52=fs_1[_0x45ceac(0xaa)]['readdirSync'](this[_0x45ceac(0xa7)]),_0x2eb986=_0x446e52[_0x45ceac(0x89)](_0x1713c6=>_0x1713c6['endsWith']('.log')),_0x20fbd7=[...new Set(_0x2eb986[_0x45ceac(0x76)](_0x382401=>_0x382401[_0x45ceac(0xa1)]('_')[0x0]))],_0x1d3611=_0x2eb986[_0x45ceac(0x76)](_0x2954fb=>{const _0x5707fc=_0x45ceac,_0x39fe69=path_1[_0x5707fc(0xaa)][_0x5707fc(0x9d)](this[_0x5707fc(0xa7)],_0x2954fb),_0x3cc3ff=fs_1[_0x5707fc(0xaa)][_0x5707fc(0x7b)](_0x39fe69),[_0x5f7445,_0x4958be]=_0x2954fb[_0x5707fc(0xab)](_0x5707fc(0xb9),'')[_0x5707fc(0xa1)]('_');return{'type':_0x5f7445,'date':_0x4958be,'size':_0x3cc3ff[_0x5707fc(0xc3)]};})[_0x45ceac(0x83)]((_0xf4e11a,_0x13443a)=>_0x13443a[_0x45ceac(0x7a)]['localeCompare'](_0xf4e11a[_0x45ceac(0x7a)]));return{'totalFiles':_0x2eb986[_0x45ceac(0x84)],'logTypes':_0x20fbd7,'latestLogs':_0x1d3611[_0x45ceac(0xba)](0x0,0xa)};}catch(_0x1e1e2a){return console[_0x45ceac(0xa6)](_0x45ceac(0x97),_0x1e1e2a),{'totalFiles':0x0,'logTypes':[],'latestLogs':[]};}}[a44_0x1c58dc(0xaf)](_0x3a6f07=0x1e){const _0xa2e6bc=a44_0x1c58dc;try{const _0x4a9018=fs_1[_0xa2e6bc(0xaa)][_0xa2e6bc(0x79)](this[_0xa2e6bc(0xa7)]),_0x16faaf=new Date();_0x16faaf[_0xa2e6bc(0xb5)](_0x16faaf[_0xa2e6bc(0x7d)]()-_0x3a6f07);let _0x1a403c=0x0;_0x4a9018['forEach'](_0x5e21c5=>{const _0x23bf91=_0xa2e6bc;if(!_0x5e21c5[_0x23bf91(0xb7)](_0x23bf91(0xb9)))return;const _0x3415d7=path_1[_0x23bf91(0xaa)][_0x23bf91(0x9d)](this[_0x23bf91(0xa7)],_0x5e21c5),_0x305e2a=fs_1[_0x23bf91(0xaa)][_0x23bf91(0x7b)](_0x3415d7);_0x305e2a[_0x23bf91(0xa4)]<_0x16faaf&&(fs_1['default']['unlinkSync'](_0x3415d7),_0x1a403c++,console[_0x23bf91(0xa8)](_0x23bf91(0xb1)+_0x5e21c5));}),console[_0xa2e6bc(0xa8)](_0xa2e6bc(0x73)+_0x1a403c+_0xa2e6bc(0xad)+_0x3a6f07+'\x20days)');}catch(_0xd117f9){console[_0xa2e6bc(0xa6)](_0xa2e6bc(0xb2),_0xd117f9);}}}function a44_0x3cbe(_0x1fe2d3,_0x97f418){const _0x44d0f7=a44_0x44d0();return a44_0x3cbe=function(_0x3cbed1,_0x102d93){_0x3cbed1=_0x3cbed1-0x72;let _0x4513e3=_0x44d0f7[_0x3cbed1];return _0x4513e3;},a44_0x3cbe(_0x1fe2d3,_0x97f418);}exports['LoggerService']=LoggerService,exports[a44_0x1c58dc(0xac)]=new LoggerService();