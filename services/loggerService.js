'use strict';const a48_0x4dbbc0=a48_0x5ad6;(function(_0x39fadf,_0x533ecc){const _0x86914c=a48_0x5ad6,_0x18c2c5=_0x39fadf();while(!![]){try{const _0x2ea32f=parseInt(_0x86914c(0x19f))/0x1*(-parseInt(_0x86914c(0x1c4))/0x2)+parseInt(_0x86914c(0x1a5))/0x3+-parseInt(_0x86914c(0x190))/0x4+parseInt(_0x86914c(0x1b4))/0x5*(-parseInt(_0x86914c(0x195))/0x6)+parseInt(_0x86914c(0x1b1))/0x7*(parseInt(_0x86914c(0x1af))/0x8)+-parseInt(_0x86914c(0x19a))/0x9*(parseInt(_0x86914c(0x1e1))/0xa)+-parseInt(_0x86914c(0x1d1))/0xb*(-parseInt(_0x86914c(0x18b))/0xc);if(_0x2ea32f===_0x533ecc)break;else _0x18c2c5['push'](_0x18c2c5['shift']());}catch(_0x5b2294){_0x18c2c5['push'](_0x18c2c5['shift']());}}}(a48_0x3717,0x4b542));var __importDefault=this&&this[a48_0x4dbbc0(0x1dd)]||function(_0x3575bf){const _0x42c772=a48_0x4dbbc0;return _0x3575bf&&_0x3575bf[_0x42c772(0x1cf)]?_0x3575bf:{'default':_0x3575bf};};function a48_0x5ad6(_0x4c3c7a,_0x38be10){const _0x3717c8=a48_0x3717();return a48_0x5ad6=function(_0x5ad65a,_0xae2509){_0x5ad65a=_0x5ad65a-0x18b;let _0x200b47=_0x3717c8[_0x5ad65a];return _0x200b47;},a48_0x5ad6(_0x4c3c7a,_0x38be10);}Object[a48_0x4dbbc0(0x1d3)](exports,a48_0x4dbbc0(0x1cf),{'value':!![]}),exports[a48_0x4dbbc0(0x1b8)]=exports[a48_0x4dbbc0(0x1c6)]=void 0x0;const fs_1=__importDefault(require('fs')),path_1=__importDefault(require(a48_0x4dbbc0(0x1dc)));class LoggerService{constructor(){const _0x452643=a48_0x4dbbc0;this[_0x452643(0x1de)]=path_1[_0x452643(0x1a1)]['join'](process[_0x452643(0x1ca)](),'logs'),this[_0x452643(0x192)]();}[a48_0x4dbbc0(0x192)](){const _0x3546c3=a48_0x4dbbc0;!fs_1[_0x3546c3(0x1a1)][_0x3546c3(0x1e3)](this[_0x3546c3(0x1de)])&&(fs_1[_0x3546c3(0x1a1)][_0x3546c3(0x1cd)](this[_0x3546c3(0x1de)],{'recursive':!![]}),console[_0x3546c3(0x193)](_0x3546c3(0x1c5)+this[_0x3546c3(0x1de)]));}[a48_0x4dbbc0(0x1d5)](_0x5ec6f0){const _0x5a0a9b=a48_0x4dbbc0,_0x4f8a9f=new Date()[_0x5a0a9b(0x1bd)]()['split']('T')[0x0];return path_1[_0x5a0a9b(0x1a1)]['join'](this[_0x5a0a9b(0x1de)],_0x5ec6f0+'_'+_0x4f8a9f+_0x5a0a9b(0x197));}[a48_0x4dbbc0(0x1cb)](_0x2f036e,_0x41cec7){const _0x166b5c=a48_0x4dbbc0;try{const _0x5a6144=new Date()[_0x166b5c(0x1bd)](),_0x4c5ae3={'timestamp':_0x5a6144,..._0x41cec7},_0x35590c=JSON['stringify'](_0x4c5ae3)+'\x0a',_0x562e72=this[_0x166b5c(0x1d5)](_0x2f036e);fs_1['default'][_0x166b5c(0x18c)](_0x562e72,_0x35590c,_0x166b5c(0x1b2));}catch(_0x2ba4f9){console[_0x166b5c(0x1aa)](_0x166b5c(0x1c3)+_0x2f036e+_0x166b5c(0x1da),_0x2ba4f9);}}[a48_0x4dbbc0(0x1ad)](_0x3ac509,_0x11c812,_0x5884b2,_0x33d226){const _0x4923d5=a48_0x4dbbc0;this['writeLog'](_0x4923d5(0x1e2),{'type':_0x4923d5(0x1d9),'gateway':_0x3ac509,'endpoint':_0x11c812,'method':_0x5884b2,'data':_0x33d226});}[a48_0x4dbbc0(0x1a9)](_0x18fad2,_0x5e5a5c,_0x280f12,_0x1fb501,_0x3aa5d4){const _0x37c1a4=a48_0x4dbbc0;this[_0x37c1a4(0x1cb)](_0x37c1a4(0x194),{'type':_0x37c1a4(0x18f),'gateway':_0x18fad2,'endpoint':_0x5e5a5c,'status':_0x280f12,'responseTime':_0x3aa5d4,'data':_0x1fb501});}[a48_0x4dbbc0(0x1be)](_0xbc4c8c,_0x43a0b2,_0x510e9b){const _0x107361=a48_0x4dbbc0;this[_0x107361(0x1cb)](_0x107361(0x19e),{'type':_0x107361(0x1b5),'gateway':_0xbc4c8c,'endpoint':_0x43a0b2,'error':_0x510e9b instanceof Error?{'message':_0x510e9b[_0x107361(0x19b)],'stack':_0x510e9b[_0x107361(0x18e)]}:_0x510e9b});}[a48_0x4dbbc0(0x1bb)](_0x37c208,_0x5c85e2,_0x3de024){const _0x26ccd6=a48_0x4dbbc0;this[_0x26ccd6(0x1cb)](_0x26ccd6(0x1a7),{'type':_0x26ccd6(0x19c),'gateway':_0x37c208,'headers':_0x3de024,'data':_0x5c85e2});}[a48_0x4dbbc0(0x199)](_0x4e7ca6,_0x1155b7,_0x13559e,_0x5d0825,_0x217a46){const _0x418615=a48_0x4dbbc0;this[_0x418615(0x1cb)]('webhooks_processed',{'type':_0x418615(0x1b0),'gateway':_0x4e7ca6,'paymentId':_0x1155b7,'oldStatus':_0x13559e,'newStatus':_0x5d0825,'originalData':_0x217a46});}[a48_0x4dbbc0(0x1b6)](_0x31157c,_0x16c96b,_0x4b8814){const _0x4379b8=a48_0x4dbbc0;this[_0x4379b8(0x1cb)]('webhooks_errors',{'type':_0x4379b8(0x191),'gateway':_0x31157c,'error':_0x16c96b instanceof Error?{'message':_0x16c96b[_0x4379b8(0x19b)],'stack':_0x16c96b[_0x4379b8(0x18e)]}:_0x16c96b,'originalData':_0x4b8814});}[a48_0x4dbbc0(0x1a0)](_0x3266b8){this['writeLog']('cointopay_status_changes',{'type':'COINTOPAY_STATUS_CHANGE',..._0x3266b8});}['logCoinToPayError'](_0x109f99){const _0x5c097e=a48_0x4dbbc0;this['writeLog'](_0x5c097e(0x1bc),{'type':_0x5c097e(0x1d7),..._0x109f99});}[a48_0x4dbbc0(0x1ac)](_0x247b7d,_0x572771,_0x468d1f,_0xf2b623,_0x296766,_0x781ff2){const _0x2cc93b=a48_0x4dbbc0;this[_0x2cc93b(0x1cb)](_0x2cc93b(0x1c2),{'type':'SHOP_WEBHOOK_SENT','shopId':_0x247b7d,'webhookUrl':_0x572771,'event':_0x468d1f,'status':_0xf2b623,'responseTime':_0x296766,'payload':_0x781ff2});}[a48_0x4dbbc0(0x1a4)](_0x35cec7,_0x4682be,_0x3f60b1,_0x705009,_0x2dcd37){const _0x1a4891=a48_0x4dbbc0;this[_0x1a4891(0x1cb)](_0x1a4891(0x1d2),{'type':_0x1a4891(0x1ab),'shopId':_0x35cec7,'webhookUrl':_0x4682be,'event':_0x3f60b1,'error':_0x705009 instanceof Error?{'message':_0x705009[_0x1a4891(0x19b)],'stack':_0x705009[_0x1a4891(0x18e)]}:_0x705009,'payload':_0x2dcd37});}['logPaymentCreated'](_0x3a9dbe,_0x1c44fc,_0x46061a,_0x5974ca,_0x36f8bd){const _0x1ec691=a48_0x4dbbc0;this[_0x1ec691(0x1cb)]('payments_created',{'type':'PAYMENT_CREATED','gateway':_0x3a9dbe,'paymentId':_0x1c44fc,'shopId':_0x46061a,'amount':_0x5974ca,'currency':_0x36f8bd});}[a48_0x4dbbc0(0x1c9)](_0x29809b,_0x306578,_0x3bbfea,_0x3d4613,_0x58ac79){const _0x3bc6e7=a48_0x4dbbc0;this[_0x3bc6e7(0x1cb)](_0x3bc6e7(0x19d),{'type':_0x3bc6e7(0x1c0),'endpoint':_0x29809b,'method':_0x306578,'userId':_0x3bbfea,'userRole':_0x3d4613,'requestData':_0x58ac79});}[a48_0x4dbbc0(0x1d4)](){const _0x4b9548=a48_0x4dbbc0;try{const _0x46822f=fs_1[_0x4b9548(0x1a1)][_0x4b9548(0x1c8)](this[_0x4b9548(0x1de)]),_0x4b3b13=_0x46822f[_0x4b9548(0x1a2)](_0x4e32b7=>_0x4e32b7[_0x4b9548(0x1b3)](_0x4b9548(0x197))),_0x84da07=[...new Set(_0x4b3b13[_0x4b9548(0x1d0)](_0x13633b=>_0x13633b[_0x4b9548(0x1df)]('_')[0x0]))],_0xa26f8a=_0x4b3b13['map'](_0x1118d5=>{const _0xd369df=_0x4b9548,_0x11ae1f=path_1[_0xd369df(0x1a1)][_0xd369df(0x1a6)](this['logsDir'],_0x1118d5),_0xba517=fs_1['default'][_0xd369df(0x1e0)](_0x11ae1f),[_0x2875db,_0x23f368]=_0x1118d5[_0xd369df(0x1c1)](_0xd369df(0x197),'')[_0xd369df(0x1df)]('_');return{'type':_0x2875db,'date':_0x23f368,'size':_0xba517[_0xd369df(0x1bf)]};})[_0x4b9548(0x1a8)]((_0x15faa5,_0x5ede21)=>_0x5ede21[_0x4b9548(0x1ba)][_0x4b9548(0x1b7)](_0x15faa5[_0x4b9548(0x1ba)]));return{'totalFiles':_0x4b3b13[_0x4b9548(0x1cc)],'logTypes':_0x84da07,'latestLogs':_0xa26f8a[_0x4b9548(0x1ce)](0x0,0xa)};}catch(_0x233260){return console[_0x4b9548(0x1aa)](_0x4b9548(0x1c7),_0x233260),{'totalFiles':0x0,'logTypes':[],'latestLogs':[]};}}[a48_0x4dbbc0(0x1db)](_0x48ee28=0x1e){const _0x3c2a3a=a48_0x4dbbc0;try{const _0x5c9c62=fs_1[_0x3c2a3a(0x1a1)][_0x3c2a3a(0x1c8)](this['logsDir']),_0x4fdc82=new Date();_0x4fdc82['setDate'](_0x4fdc82[_0x3c2a3a(0x1d6)]()-_0x48ee28);let _0x433910=0x0;_0x5c9c62[_0x3c2a3a(0x1d8)](_0x4d04d7=>{const _0x159271=_0x3c2a3a;if(!_0x4d04d7['endsWith'](_0x159271(0x197)))return;const _0x57708d=path_1['default'][_0x159271(0x1a6)](this[_0x159271(0x1de)],_0x4d04d7),_0x1fbd09=fs_1['default'][_0x159271(0x1e0)](_0x57708d);_0x1fbd09[_0x159271(0x1a3)]<_0x4fdc82&&(fs_1[_0x159271(0x1a1)][_0x159271(0x1b9)](_0x57708d),_0x433910++,console[_0x159271(0x193)](_0x159271(0x1ae)+_0x4d04d7));}),console[_0x3c2a3a(0x193)](_0x3c2a3a(0x198)+_0x433910+_0x3c2a3a(0x196)+_0x48ee28+'\x20days)');}catch(_0x1ced75){console[_0x3c2a3a(0x1aa)](_0x3c2a3a(0x18d),_0x1ced75);}}}function a48_0x3717(){const _0x5bb0df=['size','API_CALL','replace','shop_webhooks_sent','Failed\x20to\x20write\x20','22XKTgYz','📁\x20Created\x20logs\x20directory:\x20','LoggerService','Failed\x20to\x20get\x20log\x20stats:','readdirSync','logApiCall','cwd','writeLog','length','mkdirSync','slice','__esModule','map','4104727URMnEo','shop_webhooks_errors','defineProperty','getLogStats','getLogFileName','getDate','COINTOPAY_ERROR','forEach','REQUEST','\x20log:','cleanOldLogs','path','__importDefault','logsDir','split','statSync','2170110gMrjGc','white_domain_requests','existsSync','36DRTeiU','appendFileSync','Failed\x20to\x20clean\x20old\x20logs:','stack','RESPONSE','1316508xTDIhE','WEBHOOK_ERROR','ensureLogsDirectory','log','white_domain_responses','6PqDgwr','\x20old\x20log\x20files\x20(older\x20than\x20','.log','🧹\x20Cleaned\x20','logWebhookProcessed','9PHgcas','message','WEBHOOK_RECEIVED','api_calls','white_domain_errors','48491gZyfHV','logCoinToPayStatus','default','filter','mtime','logShopWebhookError','1362138cmstsC','join','webhooks_received','sort','logWhiteDomainResponse','error','SHOP_WEBHOOK_ERROR','logShopWebhookSent','logWhiteDomainRequest','🗑️\x20Deleted\x20old\x20log\x20file:\x20','2120JoRAYY','WEBHOOK_PROCESSED','161FzYgjU','utf8','endsWith','957635VGpMnU','ERROR','logWebhookError','localeCompare','loggerService','unlinkSync','date','logWebhookReceived','cointopay_errors','toISOString','logWhiteDomainError'];a48_0x3717=function(){return _0x5bb0df;};return a48_0x3717();}exports[a48_0x4dbbc0(0x1c6)]=LoggerService,exports[a48_0x4dbbc0(0x1b8)]=new LoggerService();