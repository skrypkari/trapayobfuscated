'use strict';function a44_0x4366(_0x10730d,_0x326fcc){const _0x1568e8=a44_0x1568();return a44_0x4366=function(_0x43667e,_0xcf1a02){_0x43667e=_0x43667e-0x130;let _0x1db13f=_0x1568e8[_0x43667e];return _0x1db13f;},a44_0x4366(_0x10730d,_0x326fcc);}const a44_0x2374fe=a44_0x4366;(function(_0x5702ed,_0x637d44){const _0xaae5c=a44_0x4366,_0x402b01=_0x5702ed();while(!![]){try{const _0x47f965=parseInt(_0xaae5c(0x137))/0x1+parseInt(_0xaae5c(0x177))/0x2+parseInt(_0xaae5c(0x134))/0x3*(parseInt(_0xaae5c(0x14b))/0x4)+parseInt(_0xaae5c(0x135))/0x5+parseInt(_0xaae5c(0x158))/0x6*(parseInt(_0xaae5c(0x175))/0x7)+-parseInt(_0xaae5c(0x14a))/0x8+-parseInt(_0xaae5c(0x132))/0x9;if(_0x47f965===_0x637d44)break;else _0x402b01['push'](_0x402b01['shift']());}catch(_0x49039d){_0x402b01['push'](_0x402b01['shift']());}}}(a44_0x1568,0x76ab7));var __importDefault=this&&this[a44_0x2374fe(0x170)]||function(_0x5270c2){const _0x12256e=a44_0x2374fe;return _0x5270c2&&_0x5270c2[_0x12256e(0x16a)]?_0x5270c2:{'default':_0x5270c2};};function a44_0x1568(){const _0x11c3d3=['shop_webhooks_errors','writeLog','getLogStats','white_domain_responses','__importDefault','logWebhookError','utf8','webhooks_received','Failed\x20to\x20clean\x20old\x20logs:','7wCoApT','log','1526934AlVGRo','Failed\x20to\x20get\x20log\x20stats:','LoggerService','cleanOldLogs','23007753VLjtXJ','join','57LjHdTh','4443875UAxFXs','ðŸ§¹\x20Cleaned\x20','354003wIQydG','logWhiteDomainResponse','logsDir','ERROR','date','WEBHOOK_RECEIVED','ensureLogsDirectory','ðŸ“\x20Created\x20logs\x20directory:\x20','cwd','logShopWebhookSent','RESPONSE','toISOString','PAYMENT_CREATED','logWhiteDomainRequest','stringify','logs','white_domain_requests','forEach','getLogFileName','4464040vzIwDd','158636WpSuQD','statSync','loggerService','error','webhooks_errors','\x20old\x20log\x20files\x20(older\x20than\x20','payments_created','stack','endsWith','split','filter','length','defineProperty','5044362WvQmcT','size','ðŸ—‘ï¸\x20Deleted\x20old\x20log\x20file:\x20','path','logShopWebhookError','default','shop_webhooks_sent','.log','WEBHOOK_ERROR','logWebhookProcessed','readdirSync','unlinkSync','webhooks_processed','white_domain_errors','logPaymentCreated','logApiCall','message','map','__esModule','API_CALL'];a44_0x1568=function(){return _0x11c3d3;};return a44_0x1568();}Object[a44_0x2374fe(0x157)](exports,a44_0x2374fe(0x16a),{'value':!![]}),exports[a44_0x2374fe(0x14d)]=exports[a44_0x2374fe(0x130)]=void 0x0;const fs_1=__importDefault(require('fs')),path_1=__importDefault(require(a44_0x2374fe(0x15b)));class LoggerService{constructor(){const _0x3759eb=a44_0x2374fe;this[_0x3759eb(0x139)]=path_1[_0x3759eb(0x15d)][_0x3759eb(0x133)](process[_0x3759eb(0x13f)](),_0x3759eb(0x146)),this[_0x3759eb(0x13d)]();}['ensureLogsDirectory'](){const _0x13d847=a44_0x2374fe;!fs_1[_0x13d847(0x15d)]['existsSync'](this[_0x13d847(0x139)])&&(fs_1[_0x13d847(0x15d)]['mkdirSync'](this['logsDir'],{'recursive':!![]}),console[_0x13d847(0x176)](_0x13d847(0x13e)+this[_0x13d847(0x139)]));}[a44_0x2374fe(0x149)](_0x1bc140){const _0x43f1c6=a44_0x2374fe,_0x5a41c8=new Date()[_0x43f1c6(0x142)]()[_0x43f1c6(0x154)]('T')[0x0];return path_1[_0x43f1c6(0x15d)][_0x43f1c6(0x133)](this[_0x43f1c6(0x139)],_0x1bc140+'_'+_0x5a41c8+_0x43f1c6(0x15f));}[a44_0x2374fe(0x16d)](_0x469ca7,_0xcea58a){const _0x3c370c=a44_0x2374fe;try{const _0x4fcb32=new Date()[_0x3c370c(0x142)](),_0x5cc98e={'timestamp':_0x4fcb32,..._0xcea58a},_0x1eb21c=JSON[_0x3c370c(0x145)](_0x5cc98e)+'\x0a',_0x70f73f=this[_0x3c370c(0x149)](_0x469ca7);fs_1[_0x3c370c(0x15d)]['appendFileSync'](_0x70f73f,_0x1eb21c,_0x3c370c(0x172));}catch(_0x2e2421){console[_0x3c370c(0x14e)]('Failed\x20to\x20write\x20'+_0x469ca7+'\x20log:',_0x2e2421);}}[a44_0x2374fe(0x144)](_0x188a38,_0x4c9c31,_0x337f62,_0x251d72){const _0x378d69=a44_0x2374fe;this['writeLog'](_0x378d69(0x147),{'type':'REQUEST','gateway':_0x188a38,'endpoint':_0x4c9c31,'method':_0x337f62,'data':_0x251d72});}[a44_0x2374fe(0x138)](_0x2e3d4c,_0x1b3ff1,_0x1e115a,_0x2c6924,_0x5086ba){const _0x369697=a44_0x2374fe;this[_0x369697(0x16d)](_0x369697(0x16f),{'type':_0x369697(0x141),'gateway':_0x2e3d4c,'endpoint':_0x1b3ff1,'status':_0x1e115a,'responseTime':_0x5086ba,'data':_0x2c6924});}['logWhiteDomainError'](_0x4ca066,_0x2623e4,_0x11ae43){const _0x234ba6=a44_0x2374fe;this[_0x234ba6(0x16d)](_0x234ba6(0x165),{'type':_0x234ba6(0x13a),'gateway':_0x4ca066,'endpoint':_0x2623e4,'error':_0x11ae43 instanceof Error?{'message':_0x11ae43[_0x234ba6(0x168)],'stack':_0x11ae43['stack']}:_0x11ae43});}['logWebhookReceived'](_0x1ae867,_0x1da495,_0x23ef62){const _0x2eb86b=a44_0x2374fe;this['writeLog'](_0x2eb86b(0x173),{'type':_0x2eb86b(0x13c),'gateway':_0x1ae867,'headers':_0x23ef62,'data':_0x1da495});}[a44_0x2374fe(0x161)](_0x2511f3,_0x259e2b,_0x1c77e5,_0x1d11df,_0x10304d){const _0x3db549=a44_0x2374fe;this[_0x3db549(0x16d)](_0x3db549(0x164),{'type':'WEBHOOK_PROCESSED','gateway':_0x2511f3,'paymentId':_0x259e2b,'oldStatus':_0x1c77e5,'newStatus':_0x1d11df,'originalData':_0x10304d});}[a44_0x2374fe(0x171)](_0x4850a7,_0x5deacc,_0x1f4eaa){const _0x417362=a44_0x2374fe;this[_0x417362(0x16d)](_0x417362(0x14f),{'type':_0x417362(0x160),'gateway':_0x4850a7,'error':_0x5deacc instanceof Error?{'message':_0x5deacc['message'],'stack':_0x5deacc[_0x417362(0x152)]}:_0x5deacc,'originalData':_0x1f4eaa});}[a44_0x2374fe(0x140)](_0x23c8f5,_0x4d14aa,_0x59536b,_0x28f7e3,_0x4b8f6e,_0x4f3027){const _0x19524a=a44_0x2374fe;this[_0x19524a(0x16d)](_0x19524a(0x15e),{'type':'SHOP_WEBHOOK_SENT','shopId':_0x23c8f5,'webhookUrl':_0x4d14aa,'event':_0x59536b,'status':_0x28f7e3,'responseTime':_0x4b8f6e,'payload':_0x4f3027});}[a44_0x2374fe(0x15c)](_0x5b1bf7,_0x3b6877,_0x178172,_0x4a99e7,_0x22b8f6){const _0x5daeb1=a44_0x2374fe;this[_0x5daeb1(0x16d)](_0x5daeb1(0x16c),{'type':'SHOP_WEBHOOK_ERROR','shopId':_0x5b1bf7,'webhookUrl':_0x3b6877,'event':_0x178172,'error':_0x4a99e7 instanceof Error?{'message':_0x4a99e7[_0x5daeb1(0x168)],'stack':_0x4a99e7[_0x5daeb1(0x152)]}:_0x4a99e7,'payload':_0x22b8f6});}[a44_0x2374fe(0x166)](_0x5bf082,_0x113efe,_0x5e14c2,_0xc22fdb,_0x583281){const _0x1117f3=a44_0x2374fe;this[_0x1117f3(0x16d)](_0x1117f3(0x151),{'type':_0x1117f3(0x143),'gateway':_0x5bf082,'paymentId':_0x113efe,'shopId':_0x5e14c2,'amount':_0xc22fdb,'currency':_0x583281});}[a44_0x2374fe(0x167)](_0x43d855,_0x18ed91,_0x22d7c4,_0x2e7271,_0x20a9fc){const _0x55b5e5=a44_0x2374fe;this[_0x55b5e5(0x16d)]('api_calls',{'type':_0x55b5e5(0x16b),'endpoint':_0x43d855,'method':_0x18ed91,'userId':_0x22d7c4,'userRole':_0x2e7271,'requestData':_0x20a9fc});}[a44_0x2374fe(0x16e)](){const _0x2f145c=a44_0x2374fe;try{const _0x2dc147=fs_1[_0x2f145c(0x15d)]['readdirSync'](this[_0x2f145c(0x139)]),_0x4beb7f=_0x2dc147[_0x2f145c(0x155)](_0x3c9ab7=>_0x3c9ab7[_0x2f145c(0x153)](_0x2f145c(0x15f))),_0x2b8579=[...new Set(_0x4beb7f[_0x2f145c(0x169)](_0x3c5ce4=>_0x3c5ce4[_0x2f145c(0x154)]('_')[0x0]))],_0x771832=_0x4beb7f[_0x2f145c(0x169)](_0x36cc74=>{const _0x5ebbf1=_0x2f145c,_0x17bf8b=path_1['default'][_0x5ebbf1(0x133)](this[_0x5ebbf1(0x139)],_0x36cc74),_0x4bb1cb=fs_1['default'][_0x5ebbf1(0x14c)](_0x17bf8b),[_0x34b0bd,_0x6b44ae]=_0x36cc74['replace']('.log','')[_0x5ebbf1(0x154)]('_');return{'type':_0x34b0bd,'date':_0x6b44ae,'size':_0x4bb1cb[_0x5ebbf1(0x159)]};})['sort']((_0x10ef8b,_0x5264e0)=>_0x5264e0[_0x2f145c(0x13b)]['localeCompare'](_0x10ef8b[_0x2f145c(0x13b)]));return{'totalFiles':_0x4beb7f[_0x2f145c(0x156)],'logTypes':_0x2b8579,'latestLogs':_0x771832['slice'](0x0,0xa)};}catch(_0x3f43a3){return console[_0x2f145c(0x14e)](_0x2f145c(0x178),_0x3f43a3),{'totalFiles':0x0,'logTypes':[],'latestLogs':[]};}}[a44_0x2374fe(0x131)](_0x3151a0=0x1e){const _0x2bca5c=a44_0x2374fe;try{const _0x5af00b=fs_1[_0x2bca5c(0x15d)][_0x2bca5c(0x162)](this[_0x2bca5c(0x139)]),_0x1b5319=new Date();_0x1b5319['setDate'](_0x1b5319['getDate']()-_0x3151a0);let _0x22844b=0x0;_0x5af00b[_0x2bca5c(0x148)](_0x18a0db=>{const _0x360579=_0x2bca5c;if(!_0x18a0db['endsWith']('.log'))return;const _0x3a15b7=path_1[_0x360579(0x15d)]['join'](this[_0x360579(0x139)],_0x18a0db),_0x7e6688=fs_1[_0x360579(0x15d)][_0x360579(0x14c)](_0x3a15b7);_0x7e6688['mtime']<_0x1b5319&&(fs_1[_0x360579(0x15d)][_0x360579(0x163)](_0x3a15b7),_0x22844b++,console[_0x360579(0x176)](_0x360579(0x15a)+_0x18a0db));}),console[_0x2bca5c(0x176)](_0x2bca5c(0x136)+_0x22844b+_0x2bca5c(0x150)+_0x3151a0+'\x20days)');}catch(_0x455603){console['error'](_0x2bca5c(0x174),_0x455603);}}}exports['LoggerService']=LoggerService,exports['loggerService']=new LoggerService();