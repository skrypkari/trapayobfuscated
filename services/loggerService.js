'use strict';const a44_0x13577d=a44_0x56aa;(function(_0x412744,_0x5c3716){const _0x417c3e=a44_0x56aa,_0x37293e=_0x412744();while(!![]){try{const _0x16a992=-parseInt(_0x417c3e(0x122))/0x1+-parseInt(_0x417c3e(0xf4))/0x2+-parseInt(_0x417c3e(0x102))/0x3*(parseInt(_0x417c3e(0xf8))/0x4)+parseInt(_0x417c3e(0x110))/0x5+parseInt(_0x417c3e(0xf7))/0x6+-parseInt(_0x417c3e(0xf1))/0x7*(parseInt(_0x417c3e(0xfe))/0x8)+-parseInt(_0x417c3e(0x10d))/0x9*(-parseInt(_0x417c3e(0x126))/0xa);if(_0x16a992===_0x5c3716)break;else _0x37293e['push'](_0x37293e['shift']());}catch(_0x16f892){_0x37293e['push'](_0x37293e['shift']());}}}(a44_0x366c,0x7ca13));var __importDefault=this&&this[a44_0x13577d(0x131)]||function(_0xa9ff5b){const _0x584336=a44_0x13577d;return _0xa9ff5b&&_0xa9ff5b[_0x584336(0x106)]?_0xa9ff5b:{'default':_0xa9ff5b};};function a44_0x56aa(_0x5b9f46,_0x2e9e66){const _0x366ca7=a44_0x366c();return a44_0x56aa=function(_0x56aaf2,_0x1a1376){_0x56aaf2=_0x56aaf2-0xea;let _0x321b4e=_0x366ca7[_0x56aaf2];return _0x321b4e;},a44_0x56aa(_0x5b9f46,_0x2e9e66);}Object['defineProperty'](exports,a44_0x13577d(0x106),{'value':!![]}),exports[a44_0x13577d(0xeb)]=exports[a44_0x13577d(0x10f)]=void 0x0;const fs_1=__importDefault(require('fs')),path_1=__importDefault(require(a44_0x13577d(0x129)));function a44_0x366c(){const _0x2fc1a9=['toISOString','logs','RESPONSE','webhooks_errors','WEBHOOK_RECEIVED','white_domain_responses','existsSync','420405YgRcMR','message','ðŸ—‘ï¸\x20Deleted\x20old\x20log\x20file:\x20','slice','1020EJbUas','mtime','ERROR','path','payments_created','size','logShopWebhookSent','ðŸ“\x20Created\x20logs\x20directory:\x20','Failed\x20to\x20write\x20','REQUEST','.log','__importDefault','ensureLogsDirectory','logWhiteDomainError','logWebhookReceived','shop_webhooks_sent','stack','error','date','loggerService','replace','api_calls','log','logsDir','ðŸ§¹\x20Cleaned\x20','80150RRxBAL','getLogStats','setDate','488274iyEsrB','statSync','localeCompare','504114uZgxXY','266884sJgzVE','logWhiteDomainRequest','cwd','join','logWebhookError','sort','184dtStdD','readdirSync','\x20old\x20log\x20files\x20(older\x20than\x20','default','3thGfax','map','split','length','__esModule','writeLog','logShopWebhookError','endsWith','logApiCall','PAYMENT_CREATED','cleanOldLogs','80352WiZsMI','unlinkSync','LoggerService','2552105VqcnFx','logWebhookProcessed','SHOP_WEBHOOK_SENT','forEach','webhooks_processed','utf8','appendFileSync','webhooks_received','filter','white_domain_requests','getDate'];a44_0x366c=function(){return _0x2fc1a9;};return a44_0x366c();}class LoggerService{constructor(){const _0x19631c=a44_0x13577d;this[_0x19631c(0xef)]=path_1[_0x19631c(0x101)][_0x19631c(0xfb)](process[_0x19631c(0xfa)](),_0x19631c(0x11c)),this[_0x19631c(0x132)]();}[a44_0x13577d(0x132)](){const _0xe039d8=a44_0x13577d;!fs_1['default'][_0xe039d8(0x121)](this[_0xe039d8(0xef)])&&(fs_1[_0xe039d8(0x101)]['mkdirSync'](this[_0xe039d8(0xef)],{'recursive':!![]}),console[_0xe039d8(0xee)](_0xe039d8(0x12d)+this[_0xe039d8(0xef)]));}['getLogFileName'](_0x4e22de){const _0xbddd5b=a44_0x13577d,_0x28498e=new Date()[_0xbddd5b(0x11b)]()['split']('T')[0x0];return path_1['default'][_0xbddd5b(0xfb)](this[_0xbddd5b(0xef)],_0x4e22de+'_'+_0x28498e+_0xbddd5b(0x130));}['writeLog'](_0x383d45,_0x5e4f65){const _0x4ce61b=a44_0x13577d;try{const _0x23d65d=new Date()[_0x4ce61b(0x11b)](),_0x2fe40a={'timestamp':_0x23d65d,..._0x5e4f65},_0x823259=JSON['stringify'](_0x2fe40a)+'\x0a',_0x1a5adf=this['getLogFileName'](_0x383d45);fs_1['default'][_0x4ce61b(0x116)](_0x1a5adf,_0x823259,_0x4ce61b(0x115));}catch(_0x4d6389){console[_0x4ce61b(0x137)](_0x4ce61b(0x12e)+_0x383d45+'\x20log:',_0x4d6389);}}[a44_0x13577d(0xf9)](_0x515598,_0x3c2922,_0x26c13b,_0x323635){const _0x4a9b6d=a44_0x13577d;this['writeLog'](_0x4a9b6d(0x119),{'type':_0x4a9b6d(0x12f),'gateway':_0x515598,'endpoint':_0x3c2922,'method':_0x26c13b,'data':_0x323635});}['logWhiteDomainResponse'](_0x444f1d,_0x5b9763,_0x1d083b,_0x211878,_0x505234){const _0x513c2c=a44_0x13577d;this['writeLog'](_0x513c2c(0x120),{'type':_0x513c2c(0x11d),'gateway':_0x444f1d,'endpoint':_0x5b9763,'status':_0x1d083b,'responseTime':_0x505234,'data':_0x211878});}[a44_0x13577d(0x133)](_0x25808b,_0x252a96,_0x49bd01){const _0x64d1da=a44_0x13577d;this[_0x64d1da(0x107)]('white_domain_errors',{'type':_0x64d1da(0x128),'gateway':_0x25808b,'endpoint':_0x252a96,'error':_0x49bd01 instanceof Error?{'message':_0x49bd01['message'],'stack':_0x49bd01[_0x64d1da(0x136)]}:_0x49bd01});}[a44_0x13577d(0x134)](_0x37fbce,_0x178753,_0x42dfef){const _0x2cc789=a44_0x13577d;this['writeLog'](_0x2cc789(0x117),{'type':_0x2cc789(0x11f),'gateway':_0x37fbce,'headers':_0x42dfef,'data':_0x178753});}[a44_0x13577d(0x111)](_0x2f7a7a,_0x1285ea,_0x499705,_0x305025,_0x561686){const _0x5bad55=a44_0x13577d;this[_0x5bad55(0x107)](_0x5bad55(0x114),{'type':'WEBHOOK_PROCESSED','gateway':_0x2f7a7a,'paymentId':_0x1285ea,'oldStatus':_0x499705,'newStatus':_0x305025,'originalData':_0x561686});}[a44_0x13577d(0xfc)](_0x61563c,_0xa5e1b,_0x51dbc3){const _0x15b209=a44_0x13577d;this['writeLog'](_0x15b209(0x11e),{'type':'WEBHOOK_ERROR','gateway':_0x61563c,'error':_0xa5e1b instanceof Error?{'message':_0xa5e1b[_0x15b209(0x123)],'stack':_0xa5e1b['stack']}:_0xa5e1b,'originalData':_0x51dbc3});}[a44_0x13577d(0x12c)](_0x4f306,_0x3ebbd6,_0x3dc374,_0x3eaa51,_0x5c763d,_0x5db940){const _0x1e94b6=a44_0x13577d;this[_0x1e94b6(0x107)](_0x1e94b6(0x135),{'type':_0x1e94b6(0x112),'shopId':_0x4f306,'webhookUrl':_0x3ebbd6,'event':_0x3dc374,'status':_0x3eaa51,'responseTime':_0x5c763d,'payload':_0x5db940});}[a44_0x13577d(0x108)](_0x4a7946,_0x15b2d7,_0x140e09,_0x7e3d8c,_0x23e1aa){const _0x3b5a97=a44_0x13577d;this[_0x3b5a97(0x107)]('shop_webhooks_errors',{'type':'SHOP_WEBHOOK_ERROR','shopId':_0x4a7946,'webhookUrl':_0x15b2d7,'event':_0x140e09,'error':_0x7e3d8c instanceof Error?{'message':_0x7e3d8c[_0x3b5a97(0x123)],'stack':_0x7e3d8c[_0x3b5a97(0x136)]}:_0x7e3d8c,'payload':_0x23e1aa});}['logPaymentCreated'](_0x570fdb,_0x191dae,_0x3029af,_0x89bbc8,_0x4b2023){const _0x4a09b4=a44_0x13577d;this[_0x4a09b4(0x107)](_0x4a09b4(0x12a),{'type':_0x4a09b4(0x10b),'gateway':_0x570fdb,'paymentId':_0x191dae,'shopId':_0x3029af,'amount':_0x89bbc8,'currency':_0x4b2023});}[a44_0x13577d(0x10a)](_0x45853f,_0x3cfadb,_0x16ff47,_0x2017c,_0x150034){const _0x4a67b9=a44_0x13577d;this[_0x4a67b9(0x107)](_0x4a67b9(0xed),{'type':'API_CALL','endpoint':_0x45853f,'method':_0x3cfadb,'userId':_0x16ff47,'userRole':_0x2017c,'requestData':_0x150034});}[a44_0x13577d(0xf2)](){const _0x1751d0=a44_0x13577d;try{const _0x2638f1=fs_1[_0x1751d0(0x101)][_0x1751d0(0xff)](this[_0x1751d0(0xef)]),_0x2e0d45=_0x2638f1[_0x1751d0(0x118)](_0xa272b1=>_0xa272b1['endsWith'](_0x1751d0(0x130))),_0x56f134=[...new Set(_0x2e0d45[_0x1751d0(0x103)](_0x3c8e92=>_0x3c8e92['split']('_')[0x0]))],_0x2459a8=_0x2e0d45[_0x1751d0(0x103)](_0x176e7a=>{const _0x460dc8=_0x1751d0,_0x19f076=path_1[_0x460dc8(0x101)][_0x460dc8(0xfb)](this[_0x460dc8(0xef)],_0x176e7a),_0x35ad04=fs_1['default']['statSync'](_0x19f076),[_0x7a98f7,_0x24b392]=_0x176e7a[_0x460dc8(0xec)](_0x460dc8(0x130),'')[_0x460dc8(0x104)]('_');return{'type':_0x7a98f7,'date':_0x24b392,'size':_0x35ad04[_0x460dc8(0x12b)]};})[_0x1751d0(0xfd)]((_0x3b2a48,_0x15cbf4)=>_0x15cbf4['date'][_0x1751d0(0xf6)](_0x3b2a48[_0x1751d0(0xea)]));return{'totalFiles':_0x2e0d45[_0x1751d0(0x105)],'logTypes':_0x56f134,'latestLogs':_0x2459a8[_0x1751d0(0x125)](0x0,0xa)};}catch(_0x57d3d5){return console[_0x1751d0(0x137)]('Failed\x20to\x20get\x20log\x20stats:',_0x57d3d5),{'totalFiles':0x0,'logTypes':[],'latestLogs':[]};}}[a44_0x13577d(0x10c)](_0x36aa1d=0x1e){const _0x3e2887=a44_0x13577d;try{const _0x14f0a8=fs_1[_0x3e2887(0x101)][_0x3e2887(0xff)](this[_0x3e2887(0xef)]),_0x32806d=new Date();_0x32806d[_0x3e2887(0xf3)](_0x32806d[_0x3e2887(0x11a)]()-_0x36aa1d);let _0x564826=0x0;_0x14f0a8[_0x3e2887(0x113)](_0x5e33db=>{const _0x311136=_0x3e2887;if(!_0x5e33db[_0x311136(0x109)]('.log'))return;const _0x3eadf7=path_1['default']['join'](this[_0x311136(0xef)],_0x5e33db),_0x3503d5=fs_1[_0x311136(0x101)][_0x311136(0xf5)](_0x3eadf7);_0x3503d5[_0x311136(0x127)]<_0x32806d&&(fs_1['default'][_0x311136(0x10e)](_0x3eadf7),_0x564826++,console[_0x311136(0xee)](_0x311136(0x124)+_0x5e33db));}),console[_0x3e2887(0xee)](_0x3e2887(0xf0)+_0x564826+_0x3e2887(0x100)+_0x36aa1d+'\x20days)');}catch(_0x14e177){console[_0x3e2887(0x137)]('Failed\x20to\x20clean\x20old\x20logs:',_0x14e177);}}}exports[a44_0x13577d(0x10f)]=LoggerService,exports[a44_0x13577d(0xeb)]=new LoggerService();