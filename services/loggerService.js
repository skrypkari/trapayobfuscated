'use strict';const a49_0x1685ab=a49_0x2b0c;(function(_0x552f3d,_0x3f0b74){const _0x192312=a49_0x2b0c,_0x41153b=_0x552f3d();while(!![]){try{const _0x5247ac=parseInt(_0x192312(0x1c6))/0x1*(-parseInt(_0x192312(0x1a2))/0x2)+-parseInt(_0x192312(0x1b4))/0x3+-parseInt(_0x192312(0x19d))/0x4+parseInt(_0x192312(0x1cc))/0x5*(-parseInt(_0x192312(0x1c5))/0x6)+parseInt(_0x192312(0x1c0))/0x7*(-parseInt(_0x192312(0x1bf))/0x8)+parseInt(_0x192312(0x1d8))/0x9*(-parseInt(_0x192312(0x1a8))/0xa)+parseInt(_0x192312(0x19a))/0xb;if(_0x5247ac===_0x3f0b74)break;else _0x41153b['push'](_0x41153b['shift']());}catch(_0x44ff61){_0x41153b['push'](_0x41153b['shift']());}}}(a49_0x54f9,0x83f09));function a49_0x54f9(){const _0x24f401=['white_domain_responses','setDate','🗑️\x20Deleted\x20old\x20log\x20file:\x20','929238uqmbff','1ahXMCF','readdirSync','message','logWebhookError','cwd','webhooks_received','5Khfabr','📁\x20Created\x20logs\x20directory:\x20','logs','cleanOldLogs','loggerService','appendFileSync','__esModule','writeLog','path','logsDir','logPaymentCreated','split','1179909INgEyd','WEBHOOK_RECEIVED','slice','ERROR','webhooks_errors','logShopWebhookError','white_domain_requests','SHOP_WEBHOOK_ERROR','API_CALL','Failed\x20to\x20write\x20','error','\x20old\x20log\x20files\x20(older\x20than\x20','logCoinToPayStatus','stringify','statSync','localeCompare','join','mtime','__importDefault','logCoinToPayError','utf8','logWhiteDomainError','38437443MScJUW','log','PAYMENT_CREATED','3266524IzfjUw','REQUEST','logWhiteDomainResponse','api_calls','payments_created','504720wRvDzM','toISOString','forEach','map','stack','length','80JHZDBz','logWhiteDomainRequest','\x20log:','mkdirSync','white_domain_errors','🧹\x20Cleaned\x20','logWebhookReceived','size','COINTOPAY_ERROR','replace','logShopWebhookSent','Failed\x20to\x20clean\x20old\x20logs:','338769HbHpxK','cointopay_status_changes','logApiCall','getDate','RESPONSE','defineProperty','unlinkSync','getLogFileName','default','cointopay_errors','shop_webhooks_errors','24Asrriy','1326017eVYDZq','.log'];a49_0x54f9=function(){return _0x24f401;};return a49_0x54f9();}function a49_0x2b0c(_0x5807c4,_0x36641f){const _0x54f9c7=a49_0x54f9();return a49_0x2b0c=function(_0x2b0c93,_0x4bf645){_0x2b0c93=_0x2b0c93-0x18d;let _0x1336e4=_0x54f9c7[_0x2b0c93];return _0x1336e4;},a49_0x2b0c(_0x5807c4,_0x36641f);}var __importDefault=this&&this[a49_0x1685ab(0x196)]||function(_0x3efbba){const _0x4bd35a=a49_0x1685ab;return _0x3efbba&&_0x3efbba[_0x4bd35a(0x1d2)]?_0x3efbba:{'default':_0x3efbba};};Object[a49_0x1685ab(0x1b9)](exports,'__esModule',{'value':!![]}),exports['loggerService']=exports['LoggerService']=void 0x0;const fs_1=__importDefault(require('fs')),path_1=__importDefault(require(a49_0x1685ab(0x1d4)));class LoggerService{constructor(){const _0x553c2a=a49_0x1685ab;this[_0x553c2a(0x1d5)]=path_1['default'][_0x553c2a(0x194)](process[_0x553c2a(0x1ca)](),_0x553c2a(0x1ce)),this['ensureLogsDirectory']();}['ensureLogsDirectory'](){const _0x3f7423=a49_0x1685ab;!fs_1[_0x3f7423(0x1bc)]['existsSync'](this['logsDir'])&&(fs_1[_0x3f7423(0x1bc)][_0x3f7423(0x1ab)](this[_0x3f7423(0x1d5)],{'recursive':!![]}),console[_0x3f7423(0x19b)](_0x3f7423(0x1cd)+this[_0x3f7423(0x1d5)]));}['getLogFileName'](_0x17082e){const _0x484e51=a49_0x1685ab,_0x38c233=new Date()[_0x484e51(0x1a3)]()[_0x484e51(0x1d7)]('T')[0x0];return path_1['default']['join'](this[_0x484e51(0x1d5)],_0x17082e+'_'+_0x38c233+_0x484e51(0x1c1));}[a49_0x1685ab(0x1d3)](_0x5d70ed,_0x34595e){const _0x447bc1=a49_0x1685ab;try{const _0x2fbd9f=new Date()[_0x447bc1(0x1a3)](),_0x3abe54={'timestamp':_0x2fbd9f,..._0x34595e},_0xd2152e=JSON[_0x447bc1(0x191)](_0x3abe54)+'\x0a',_0x2f92ae=this[_0x447bc1(0x1bb)](_0x5d70ed);fs_1[_0x447bc1(0x1bc)][_0x447bc1(0x1d1)](_0x2f92ae,_0xd2152e,_0x447bc1(0x198));}catch(_0x2310e9){console[_0x447bc1(0x18e)](_0x447bc1(0x18d)+_0x5d70ed+_0x447bc1(0x1aa),_0x2310e9);}}[a49_0x1685ab(0x1a9)](_0x43a5c4,_0x1c8268,_0x1c2bf9,_0x262150){const _0xe19052=a49_0x1685ab;this[_0xe19052(0x1d3)](_0xe19052(0x1de),{'type':_0xe19052(0x19e),'gateway':_0x43a5c4,'endpoint':_0x1c8268,'method':_0x1c2bf9,'data':_0x262150});}[a49_0x1685ab(0x19f)](_0x367b6b,_0x1b2ce4,_0x761633,_0x2fbe82,_0x55709c){const _0x34ae1a=a49_0x1685ab;this[_0x34ae1a(0x1d3)](_0x34ae1a(0x1c2),{'type':_0x34ae1a(0x1b8),'gateway':_0x367b6b,'endpoint':_0x1b2ce4,'status':_0x761633,'responseTime':_0x55709c,'data':_0x2fbe82});}[a49_0x1685ab(0x199)](_0x4535b1,_0x7d5c4e,_0x27ec03){const _0xa182e4=a49_0x1685ab;this[_0xa182e4(0x1d3)](_0xa182e4(0x1ac),{'type':_0xa182e4(0x1db),'gateway':_0x4535b1,'endpoint':_0x7d5c4e,'error':_0x27ec03 instanceof Error?{'message':_0x27ec03['message'],'stack':_0x27ec03[_0xa182e4(0x1a6)]}:_0x27ec03});}[a49_0x1685ab(0x1ae)](_0x30a421,_0xf763bf,_0x15b68d){const _0x5d9464=a49_0x1685ab;this[_0x5d9464(0x1d3)](_0x5d9464(0x1cb),{'type':_0x5d9464(0x1d9),'gateway':_0x30a421,'headers':_0x15b68d,'data':_0xf763bf});}['logWebhookProcessed'](_0x2d9d51,_0x590a54,_0x4ab95b,_0x5e51e5,_0x5027d5){const _0x280763=a49_0x1685ab;this[_0x280763(0x1d3)]('webhooks_processed',{'type':'WEBHOOK_PROCESSED','gateway':_0x2d9d51,'paymentId':_0x590a54,'oldStatus':_0x4ab95b,'newStatus':_0x5e51e5,'originalData':_0x5027d5});}[a49_0x1685ab(0x1c9)](_0x414820,_0x3883c4,_0x2b42e6){const _0x30c6c6=a49_0x1685ab;this['writeLog'](_0x30c6c6(0x1dc),{'type':'WEBHOOK_ERROR','gateway':_0x414820,'error':_0x3883c4 instanceof Error?{'message':_0x3883c4[_0x30c6c6(0x1c8)],'stack':_0x3883c4['stack']}:_0x3883c4,'originalData':_0x2b42e6});}[a49_0x1685ab(0x190)](_0x2de56a){const _0x568295=a49_0x1685ab;this['writeLog'](_0x568295(0x1b5),{'type':'COINTOPAY_STATUS_CHANGE',..._0x2de56a});}[a49_0x1685ab(0x197)](_0xadbcf8){const _0x37813e=a49_0x1685ab;this['writeLog'](_0x37813e(0x1bd),{'type':_0x37813e(0x1b0),..._0xadbcf8});}[a49_0x1685ab(0x1b2)](_0x151a9f,_0xd1467,_0x52e5a8,_0x40f1a1,_0x3e3627,_0x3c630a){const _0x4379b3=a49_0x1685ab;this[_0x4379b3(0x1d3)]('shop_webhooks_sent',{'type':'SHOP_WEBHOOK_SENT','shopId':_0x151a9f,'webhookUrl':_0xd1467,'event':_0x52e5a8,'status':_0x40f1a1,'responseTime':_0x3e3627,'payload':_0x3c630a});}[a49_0x1685ab(0x1dd)](_0x5998b5,_0x3a4840,_0x55fe03,_0x4d87ac,_0x1f5e71){const _0x8438b2=a49_0x1685ab;this[_0x8438b2(0x1d3)](_0x8438b2(0x1be),{'type':_0x8438b2(0x1df),'shopId':_0x5998b5,'webhookUrl':_0x3a4840,'event':_0x55fe03,'error':_0x4d87ac instanceof Error?{'message':_0x4d87ac[_0x8438b2(0x1c8)],'stack':_0x4d87ac['stack']}:_0x4d87ac,'payload':_0x1f5e71});}[a49_0x1685ab(0x1d6)](_0x5444a8,_0x21cff6,_0x2ca093,_0x273b63,_0x2fb5aa){const _0x43cebc=a49_0x1685ab;this[_0x43cebc(0x1d3)](_0x43cebc(0x1a1),{'type':_0x43cebc(0x19c),'gateway':_0x5444a8,'paymentId':_0x21cff6,'shopId':_0x2ca093,'amount':_0x273b63,'currency':_0x2fb5aa});}[a49_0x1685ab(0x1b6)](_0x13341c,_0x280ef8,_0x17c2fa,_0x332145,_0x3147e0){const _0xeece7e=a49_0x1685ab;this[_0xeece7e(0x1d3)](_0xeece7e(0x1a0),{'type':_0xeece7e(0x1e0),'endpoint':_0x13341c,'method':_0x280ef8,'userId':_0x17c2fa,'userRole':_0x332145,'requestData':_0x3147e0});}['getLogStats'](){const _0x1d83c5=a49_0x1685ab;try{const _0xaf72d4=fs_1['default'][_0x1d83c5(0x1c7)](this[_0x1d83c5(0x1d5)]),_0x19e726=_0xaf72d4['filter'](_0x153713=>_0x153713['endsWith'](_0x1d83c5(0x1c1))),_0x7e1c0e=[...new Set(_0x19e726[_0x1d83c5(0x1a5)](_0x5770b9=>_0x5770b9[_0x1d83c5(0x1d7)]('_')[0x0]))],_0x31c653=_0x19e726[_0x1d83c5(0x1a5)](_0x51cd79=>{const _0x1dfa93=_0x1d83c5,_0x38fe61=path_1['default'][_0x1dfa93(0x194)](this[_0x1dfa93(0x1d5)],_0x51cd79),_0x59606c=fs_1[_0x1dfa93(0x1bc)][_0x1dfa93(0x192)](_0x38fe61),[_0x53bba4,_0x1d6574]=_0x51cd79[_0x1dfa93(0x1b1)](_0x1dfa93(0x1c1),'')[_0x1dfa93(0x1d7)]('_');return{'type':_0x53bba4,'date':_0x1d6574,'size':_0x59606c[_0x1dfa93(0x1af)]};})['sort']((_0x528566,_0x2a68ab)=>_0x2a68ab['date'][_0x1d83c5(0x193)](_0x528566['date']));return{'totalFiles':_0x19e726[_0x1d83c5(0x1a7)],'logTypes':_0x7e1c0e,'latestLogs':_0x31c653[_0x1d83c5(0x1da)](0x0,0xa)};}catch(_0x51f4e1){return console[_0x1d83c5(0x18e)]('Failed\x20to\x20get\x20log\x20stats:',_0x51f4e1),{'totalFiles':0x0,'logTypes':[],'latestLogs':[]};}}[a49_0x1685ab(0x1cf)](_0x1dfb57=0x1e){const _0x15d860=a49_0x1685ab;try{const _0x30fbe2=fs_1[_0x15d860(0x1bc)][_0x15d860(0x1c7)](this[_0x15d860(0x1d5)]),_0xdbaa5e=new Date();_0xdbaa5e[_0x15d860(0x1c3)](_0xdbaa5e[_0x15d860(0x1b7)]()-_0x1dfb57);let _0x34588a=0x0;_0x30fbe2[_0x15d860(0x1a4)](_0x38ae12=>{const _0x30ed48=_0x15d860;if(!_0x38ae12['endsWith']('.log'))return;const _0x2288bb=path_1[_0x30ed48(0x1bc)][_0x30ed48(0x194)](this[_0x30ed48(0x1d5)],_0x38ae12),_0x1ccc87=fs_1['default'][_0x30ed48(0x192)](_0x2288bb);_0x1ccc87[_0x30ed48(0x195)]<_0xdbaa5e&&(fs_1[_0x30ed48(0x1bc)][_0x30ed48(0x1ba)](_0x2288bb),_0x34588a++,console[_0x30ed48(0x19b)](_0x30ed48(0x1c4)+_0x38ae12));}),console[_0x15d860(0x19b)](_0x15d860(0x1ad)+_0x34588a+_0x15d860(0x18f)+_0x1dfb57+'\x20days)');}catch(_0x208fe7){console[_0x15d860(0x18e)](_0x15d860(0x1b3),_0x208fe7);}}}exports['LoggerService']=LoggerService,exports[a49_0x1685ab(0x1d0)]=new LoggerService();