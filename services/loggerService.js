'use strict';const a44_0x2a6aa8=a44_0xe37e;function a44_0xe37e(_0x2f143a,_0x3136d7){const _0x72a61=a44_0x72a6();return a44_0xe37e=function(_0xe37e31,_0x52e0ff){_0xe37e31=_0xe37e31-0x1db;let _0x4c2160=_0x72a61[_0xe37e31];return _0x4c2160;},a44_0xe37e(_0x2f143a,_0x3136d7);}(function(_0x1bc703,_0x5a74fb){const _0x470f13=a44_0xe37e,_0x5119f5=_0x1bc703();while(!![]){try{const _0x5ffe62=parseInt(_0x470f13(0x215))/0x1+-parseInt(_0x470f13(0x213))/0x2+parseInt(_0x470f13(0x21a))/0x3*(-parseInt(_0x470f13(0x1ff))/0x4)+-parseInt(_0x470f13(0x1f3))/0x5*(-parseInt(_0x470f13(0x21e))/0x6)+parseInt(_0x470f13(0x1dd))/0x7*(parseInt(_0x470f13(0x1f6))/0x8)+parseInt(_0x470f13(0x20b))/0x9+-parseInt(_0x470f13(0x200))/0xa;if(_0x5ffe62===_0x5a74fb)break;else _0x5119f5['push'](_0x5119f5['shift']());}catch(_0x32f3ea){_0x5119f5['push'](_0x5119f5['shift']());}}}(a44_0x72a6,0x9300c));var __importDefault=this&&this[a44_0x2a6aa8(0x1f0)]||function(_0x5a099a){return _0x5a099a&&_0x5a099a['__esModule']?_0x5a099a:{'default':_0x5a099a};};function a44_0x72a6(){const _0x5b7054=['\x20old\x20log\x20files\x20(older\x20than\x20','4912308ESNpvJ','defineProperty','SHOP_WEBHOOK_SENT','logPaymentCreated','REQUEST','writeLog','WEBHOOK_ERROR','date','615198ItaDNZ','cleanOldLogs','1095782bvPfUI','message','getDate','Failed\x20to\x20get\x20log\x20stats:','path','546zBAqMc','slice','white_domain_errors','white_domain_responses','6MWaAKF','🗑️\x20Deleted\x20old\x20log\x20file:\x20','endsWith','WEBHOOK_RECEIVED','LoggerService','payments_created','replace','logsDir','filter','getLogStats','readdirSync','logWebhookError','getLogFileName','1253rLihSt','shop_webhooks_sent','unlinkSync','cwd','logShopWebhookSent','stringify','ensureLogsDirectory','\x20days)','logWhiteDomainError','map','webhooks_received','join','mtime','logWebhookReceived','length','mkdirSync','Failed\x20to\x20write\x20','PAYMENT_CREATED','log','__importDefault','ERROR','forEach','253695wyXJmj','logWebhookProcessed','utf8','48176tRgiZu','logWhiteDomainResponse','API_CALL','loggerService','stack','webhooks_errors','default','shop_webhooks_errors','📁\x20Created\x20logs\x20directory:\x20','18036dBirNa','10399100IhlcqP','error','logWhiteDomainRequest','statSync','toISOString','RESPONSE','sort','setDate','__esModule','.log'];a44_0x72a6=function(){return _0x5b7054;};return a44_0x72a6();}Object[a44_0x2a6aa8(0x20c)](exports,a44_0x2a6aa8(0x208),{'value':!![]}),exports[a44_0x2a6aa8(0x1f9)]=exports[a44_0x2a6aa8(0x222)]=void 0x0;const fs_1=__importDefault(require('fs')),path_1=__importDefault(require(a44_0x2a6aa8(0x219)));class LoggerService{constructor(){const _0x498553=a44_0x2a6aa8;this[_0x498553(0x225)]=path_1[_0x498553(0x1fc)][_0x498553(0x1e8)](process[_0x498553(0x1e0)](),'logs'),this[_0x498553(0x1e3)]();}[a44_0x2a6aa8(0x1e3)](){const _0x1be849=a44_0x2a6aa8;!fs_1[_0x1be849(0x1fc)]['existsSync'](this[_0x1be849(0x225)])&&(fs_1[_0x1be849(0x1fc)][_0x1be849(0x1ec)](this[_0x1be849(0x225)],{'recursive':!![]}),console[_0x1be849(0x1ef)](_0x1be849(0x1fe)+this[_0x1be849(0x225)]));}[a44_0x2a6aa8(0x1dc)](_0x59ba96){const _0x18155e=a44_0x2a6aa8,_0x24c098=new Date()[_0x18155e(0x204)]()['split']('T')[0x0];return path_1[_0x18155e(0x1fc)][_0x18155e(0x1e8)](this[_0x18155e(0x225)],_0x59ba96+'_'+_0x24c098+_0x18155e(0x209));}[a44_0x2a6aa8(0x210)](_0x435564,_0x18edc7){const _0x27f7ee=a44_0x2a6aa8;try{const _0x298788=new Date()[_0x27f7ee(0x204)](),_0x23ae08={'timestamp':_0x298788,..._0x18edc7},_0x5cc855=JSON[_0x27f7ee(0x1e2)](_0x23ae08)+'\x0a',_0x45c103=this['getLogFileName'](_0x435564);fs_1[_0x27f7ee(0x1fc)]['appendFileSync'](_0x45c103,_0x5cc855,_0x27f7ee(0x1f5));}catch(_0x231bf9){console[_0x27f7ee(0x201)](_0x27f7ee(0x1ed)+_0x435564+'\x20log:',_0x231bf9);}}[a44_0x2a6aa8(0x202)](_0x5b5020,_0x5aa3cc,_0x4d6762,_0x2363e9){const _0xdd207=a44_0x2a6aa8;this[_0xdd207(0x210)]('white_domain_requests',{'type':_0xdd207(0x20f),'gateway':_0x5b5020,'endpoint':_0x5aa3cc,'method':_0x4d6762,'data':_0x2363e9});}[a44_0x2a6aa8(0x1f7)](_0xba202e,_0x53cab9,_0x3ac301,_0x4f03cb,_0x42ade0){const _0x1a9f49=a44_0x2a6aa8;this[_0x1a9f49(0x210)](_0x1a9f49(0x21d),{'type':_0x1a9f49(0x205),'gateway':_0xba202e,'endpoint':_0x53cab9,'status':_0x3ac301,'responseTime':_0x42ade0,'data':_0x4f03cb});}[a44_0x2a6aa8(0x1e5)](_0x43803f,_0xc9ae1b,_0x51825b){const _0x3bd9be=a44_0x2a6aa8;this[_0x3bd9be(0x210)](_0x3bd9be(0x21c),{'type':_0x3bd9be(0x1f1),'gateway':_0x43803f,'endpoint':_0xc9ae1b,'error':_0x51825b instanceof Error?{'message':_0x51825b[_0x3bd9be(0x216)],'stack':_0x51825b[_0x3bd9be(0x1fa)]}:_0x51825b});}[a44_0x2a6aa8(0x1ea)](_0x48bf19,_0x107d4a,_0x28175d){const _0x4f1d83=a44_0x2a6aa8;this[_0x4f1d83(0x210)](_0x4f1d83(0x1e7),{'type':_0x4f1d83(0x221),'gateway':_0x48bf19,'headers':_0x28175d,'data':_0x107d4a});}[a44_0x2a6aa8(0x1f4)](_0x4a4dd8,_0xb66dbb,_0x384392,_0x141010,_0x1d8623){this['writeLog']('webhooks_processed',{'type':'WEBHOOK_PROCESSED','gateway':_0x4a4dd8,'paymentId':_0xb66dbb,'oldStatus':_0x384392,'newStatus':_0x141010,'originalData':_0x1d8623});}[a44_0x2a6aa8(0x1db)](_0x2b731e,_0x3cfa56,_0x3f75e7){const _0x434c62=a44_0x2a6aa8;this[_0x434c62(0x210)](_0x434c62(0x1fb),{'type':_0x434c62(0x211),'gateway':_0x2b731e,'error':_0x3cfa56 instanceof Error?{'message':_0x3cfa56[_0x434c62(0x216)],'stack':_0x3cfa56[_0x434c62(0x1fa)]}:_0x3cfa56,'originalData':_0x3f75e7});}[a44_0x2a6aa8(0x1e1)](_0x926977,_0x4a9727,_0x777ccb,_0x1599eb,_0xe07ffd,_0x480fd9){const _0x282fc=a44_0x2a6aa8;this['writeLog'](_0x282fc(0x1de),{'type':_0x282fc(0x20d),'shopId':_0x926977,'webhookUrl':_0x4a9727,'event':_0x777ccb,'status':_0x1599eb,'responseTime':_0xe07ffd,'payload':_0x480fd9});}['logShopWebhookError'](_0x29fc9b,_0x208f19,_0x144fcd,_0x8a0df6,_0x1304fa){const _0x5e9c6d=a44_0x2a6aa8;this[_0x5e9c6d(0x210)](_0x5e9c6d(0x1fd),{'type':'SHOP_WEBHOOK_ERROR','shopId':_0x29fc9b,'webhookUrl':_0x208f19,'event':_0x144fcd,'error':_0x8a0df6 instanceof Error?{'message':_0x8a0df6[_0x5e9c6d(0x216)],'stack':_0x8a0df6[_0x5e9c6d(0x1fa)]}:_0x8a0df6,'payload':_0x1304fa});}[a44_0x2a6aa8(0x20e)](_0x3d6dd8,_0x59ff41,_0x1e801d,_0x5de017,_0x4587f5){const _0x39ef77=a44_0x2a6aa8;this[_0x39ef77(0x210)](_0x39ef77(0x223),{'type':_0x39ef77(0x1ee),'gateway':_0x3d6dd8,'paymentId':_0x59ff41,'shopId':_0x1e801d,'amount':_0x5de017,'currency':_0x4587f5});}['logApiCall'](_0x12a6e4,_0x166e60,_0x25dae9,_0x4764c1,_0x2bdd0e){const _0xaae6c1=a44_0x2a6aa8;this[_0xaae6c1(0x210)]('api_calls',{'type':_0xaae6c1(0x1f8),'endpoint':_0x12a6e4,'method':_0x166e60,'userId':_0x25dae9,'userRole':_0x4764c1,'requestData':_0x2bdd0e});}[a44_0x2a6aa8(0x227)](){const _0x3166df=a44_0x2a6aa8;try{const _0x48a6d9=fs_1['default'][_0x3166df(0x228)](this['logsDir']),_0x562a46=_0x48a6d9[_0x3166df(0x226)](_0x18ac24=>_0x18ac24[_0x3166df(0x220)]('.log')),_0x3825cc=[...new Set(_0x562a46[_0x3166df(0x1e6)](_0x137c6f=>_0x137c6f['split']('_')[0x0]))],_0x388aef=_0x562a46['map'](_0x367147=>{const _0x1a3139=_0x3166df,_0x4b30a8=path_1[_0x1a3139(0x1fc)]['join'](this[_0x1a3139(0x225)],_0x367147),_0x33a721=fs_1['default'][_0x1a3139(0x203)](_0x4b30a8),[_0x279210,_0x43690c]=_0x367147[_0x1a3139(0x224)]('.log','')['split']('_');return{'type':_0x279210,'date':_0x43690c,'size':_0x33a721['size']};})[_0x3166df(0x206)]((_0x179617,_0x27e83e)=>_0x27e83e['date']['localeCompare'](_0x179617[_0x3166df(0x212)]));return{'totalFiles':_0x562a46[_0x3166df(0x1eb)],'logTypes':_0x3825cc,'latestLogs':_0x388aef[_0x3166df(0x21b)](0x0,0xa)};}catch(_0x192b13){return console['error'](_0x3166df(0x218),_0x192b13),{'totalFiles':0x0,'logTypes':[],'latestLogs':[]};}}[a44_0x2a6aa8(0x214)](_0x51b955=0x1e){const _0x1f0372=a44_0x2a6aa8;try{const _0x1c3048=fs_1[_0x1f0372(0x1fc)][_0x1f0372(0x228)](this['logsDir']),_0x7b628d=new Date();_0x7b628d[_0x1f0372(0x207)](_0x7b628d[_0x1f0372(0x217)]()-_0x51b955);let _0x438f41=0x0;_0x1c3048[_0x1f0372(0x1f2)](_0x2008f7=>{const _0x180a22=_0x1f0372;if(!_0x2008f7['endsWith']('.log'))return;const _0x43a08f=path_1[_0x180a22(0x1fc)]['join'](this[_0x180a22(0x225)],_0x2008f7),_0x55b057=fs_1[_0x180a22(0x1fc)][_0x180a22(0x203)](_0x43a08f);_0x55b057[_0x180a22(0x1e9)]<_0x7b628d&&(fs_1[_0x180a22(0x1fc)][_0x180a22(0x1df)](_0x43a08f),_0x438f41++,console[_0x180a22(0x1ef)](_0x180a22(0x21f)+_0x2008f7));}),console['log']('🧹\x20Cleaned\x20'+_0x438f41+_0x1f0372(0x20a)+_0x51b955+_0x1f0372(0x1e4));}catch(_0x5a6965){console['error']('Failed\x20to\x20clean\x20old\x20logs:',_0x5a6965);}}}exports[a44_0x2a6aa8(0x222)]=LoggerService,exports[a44_0x2a6aa8(0x1f9)]=new LoggerService();