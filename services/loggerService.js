'use strict';const a44_0x5a4984=a44_0x174d;function a44_0x174d(_0x23cb18,_0xd8f3f0){const _0x1f4406=a44_0x1f44();return a44_0x174d=function(_0x174d6f,_0x2f4fda){_0x174d6f=_0x174d6f-0xdc;let _0x3bf1d7=_0x1f4406[_0x174d6f];return _0x3bf1d7;},a44_0x174d(_0x23cb18,_0xd8f3f0);}function a44_0x1f44(){const _0x38622b=['appendFileSync','message','mtime','readdirSync','map','shop_webhooks_errors','logsDir','Failed\x20to\x20write\x20','4180632gKKkrW','🗑️\x20Deleted\x20old\x20log\x20file:\x20','logPaymentCreated','.log','Failed\x20to\x20clean\x20old\x20logs:','1390778evVVKy','setDate','writeLog','607604WQaLcj','LoggerService','\x20log:','ensureLogsDirectory','utf8','defineProperty','loggerService','webhooks_processed','stringify','📁\x20Created\x20logs\x20directory:\x20','cleanOldLogs','Failed\x20to\x20get\x20log\x20stats:','white_domain_requests','mkdirSync','SHOP_WEBHOOK_ERROR','date','logApiCall','log','payments_created','WEBHOOK_ERROR','REQUEST','9mSVTQj','sort','unlinkSync','logShopWebhookError','SHOP_WEBHOOK_SENT','__importDefault','logWhiteDomainRequest','getLogFileName','2mWbGyz','localeCompare','api_calls','shop_webhooks_sent','474BoTmAf','logShopWebhookSent','2070324vWpPJt','webhooks_received','__esModule','ERROR','WEBHOOK_PROCESSED','logWebhookError','toISOString','40wAxXAl','default','API_CALL','length','\x20old\x20log\x20files\x20(older\x20than\x20','white_domain_responses','122143bpnvjV','split','getLogStats','9792304GScjzF','error','9203100PwxdoR','endsWith','stack','PAYMENT_CREATED','33NfTWlF','webhooks_errors','WEBHOOK_RECEIVED','statSync','forEach','logWhiteDomainError','join'];a44_0x1f44=function(){return _0x38622b;};return a44_0x1f44();}(function(_0x2ebce2,_0x1d5390){const _0xda9950=a44_0x174d,_0x303f8b=_0x2ebce2();while(!![]){try{const _0x2fbda8=parseInt(_0xda9950(0x11c))/0x1*(-parseInt(_0xda9950(0xfc))/0x2)+-parseInt(_0xda9950(0x122))/0x3+parseInt(_0xda9950(0xff))/0x4*(parseInt(_0xda9950(0x129))/0x5)+-parseInt(_0xda9950(0x120))/0x6*(parseInt(_0xda9950(0xdf))/0x7)+parseInt(_0xda9950(0xe2))/0x8+-parseInt(_0xda9950(0x114))/0x9*(-parseInt(_0xda9950(0xe4))/0xa)+-parseInt(_0xda9950(0xe8))/0xb*(-parseInt(_0xda9950(0xf7))/0xc);if(_0x2fbda8===_0x1d5390)break;else _0x303f8b['push'](_0x303f8b['shift']());}catch(_0x393b43){_0x303f8b['push'](_0x303f8b['shift']());}}}(a44_0x1f44,0xe6ccd));var __importDefault=this&&this[a44_0x5a4984(0x119)]||function(_0x1af2cb){const _0x1137de=a44_0x5a4984;return _0x1af2cb&&_0x1af2cb[_0x1137de(0x124)]?_0x1af2cb:{'default':_0x1af2cb};};Object[a44_0x5a4984(0x104)](exports,'__esModule',{'value':!![]}),exports[a44_0x5a4984(0x105)]=exports[a44_0x5a4984(0x100)]=void 0x0;const fs_1=__importDefault(require('fs')),path_1=__importDefault(require('path'));class LoggerService{constructor(){const _0x3ddebc=a44_0x5a4984;this[_0x3ddebc(0xf5)]=path_1[_0x3ddebc(0x12a)]['join'](process['cwd'](),'logs'),this[_0x3ddebc(0x102)]();}['ensureLogsDirectory'](){const _0x5cd9c8=a44_0x5a4984;!fs_1[_0x5cd9c8(0x12a)]['existsSync'](this['logsDir'])&&(fs_1[_0x5cd9c8(0x12a)][_0x5cd9c8(0x10c)](this[_0x5cd9c8(0xf5)],{'recursive':!![]}),console[_0x5cd9c8(0x110)](_0x5cd9c8(0x108)+this[_0x5cd9c8(0xf5)]));}[a44_0x5a4984(0x11b)](_0x4d711c){const _0x1a1138=a44_0x5a4984,_0x16e5c1=new Date()[_0x1a1138(0x128)]()[_0x1a1138(0xe0)]('T')[0x0];return path_1['default']['join'](this['logsDir'],_0x4d711c+'_'+_0x16e5c1+_0x1a1138(0xfa));}[a44_0x5a4984(0xfe)](_0x45e960,_0x3b962d){const _0x4d775b=a44_0x5a4984;try{const _0x43a235=new Date()[_0x4d775b(0x128)](),_0x3fab56={'timestamp':_0x43a235,..._0x3b962d},_0x57d9bc=JSON[_0x4d775b(0x107)](_0x3fab56)+'\x0a',_0x3ac147=this[_0x4d775b(0x11b)](_0x45e960);fs_1[_0x4d775b(0x12a)][_0x4d775b(0xef)](_0x3ac147,_0x57d9bc,_0x4d775b(0x103));}catch(_0x142a90){console[_0x4d775b(0xe3)](_0x4d775b(0xf6)+_0x45e960+_0x4d775b(0x101),_0x142a90);}}[a44_0x5a4984(0x11a)](_0x43ca97,_0x175b7e,_0x31d736,_0x4320ed){const _0x5be841=a44_0x5a4984;this[_0x5be841(0xfe)](_0x5be841(0x10b),{'type':_0x5be841(0x113),'gateway':_0x43ca97,'endpoint':_0x175b7e,'method':_0x31d736,'data':_0x4320ed});}['logWhiteDomainResponse'](_0x4d0b4f,_0x120708,_0x286477,_0x36765a,_0xf00e12){const _0x2d6f54=a44_0x5a4984;this[_0x2d6f54(0xfe)](_0x2d6f54(0xde),{'type':'RESPONSE','gateway':_0x4d0b4f,'endpoint':_0x120708,'status':_0x286477,'responseTime':_0xf00e12,'data':_0x36765a});}[a44_0x5a4984(0xed)](_0x398368,_0x45cfaf,_0x285a4b){const _0x20d4f5=a44_0x5a4984;this[_0x20d4f5(0xfe)]('white_domain_errors',{'type':_0x20d4f5(0x125),'gateway':_0x398368,'endpoint':_0x45cfaf,'error':_0x285a4b instanceof Error?{'message':_0x285a4b[_0x20d4f5(0xf0)],'stack':_0x285a4b[_0x20d4f5(0xe6)]}:_0x285a4b});}['logWebhookReceived'](_0x2c2d07,_0x12d67c,_0xd31c7a){const _0xeb219f=a44_0x5a4984;this[_0xeb219f(0xfe)](_0xeb219f(0x123),{'type':_0xeb219f(0xea),'gateway':_0x2c2d07,'headers':_0xd31c7a,'data':_0x12d67c});}['logWebhookProcessed'](_0x54494f,_0x45a1c8,_0x21b3f1,_0x28747d,_0x1c1591){const _0x5841fc=a44_0x5a4984;this[_0x5841fc(0xfe)](_0x5841fc(0x106),{'type':_0x5841fc(0x126),'gateway':_0x54494f,'paymentId':_0x45a1c8,'oldStatus':_0x21b3f1,'newStatus':_0x28747d,'originalData':_0x1c1591});}[a44_0x5a4984(0x127)](_0x4399c7,_0x14a2b2,_0x1d2c22){const _0x5003cb=a44_0x5a4984;this[_0x5003cb(0xfe)](_0x5003cb(0xe9),{'type':_0x5003cb(0x112),'gateway':_0x4399c7,'error':_0x14a2b2 instanceof Error?{'message':_0x14a2b2[_0x5003cb(0xf0)],'stack':_0x14a2b2['stack']}:_0x14a2b2,'originalData':_0x1d2c22});}[a44_0x5a4984(0x121)](_0x49165f,_0x522872,_0x19a496,_0x462789,_0x180333,_0x202ef7){const _0x298917=a44_0x5a4984;this[_0x298917(0xfe)](_0x298917(0x11f),{'type':_0x298917(0x118),'shopId':_0x49165f,'webhookUrl':_0x522872,'event':_0x19a496,'status':_0x462789,'responseTime':_0x180333,'payload':_0x202ef7});}[a44_0x5a4984(0x117)](_0x22e0bc,_0x3507fa,_0x10d8b0,_0x556309,_0x10ec4c){const _0x2e706c=a44_0x5a4984;this[_0x2e706c(0xfe)](_0x2e706c(0xf4),{'type':_0x2e706c(0x10d),'shopId':_0x22e0bc,'webhookUrl':_0x3507fa,'event':_0x10d8b0,'error':_0x556309 instanceof Error?{'message':_0x556309['message'],'stack':_0x556309[_0x2e706c(0xe6)]}:_0x556309,'payload':_0x10ec4c});}[a44_0x5a4984(0xf9)](_0x2d13f4,_0x7e3fe8,_0x84f206,_0x4dbf15,_0xe92176){const _0x32a305=a44_0x5a4984;this['writeLog'](_0x32a305(0x111),{'type':_0x32a305(0xe7),'gateway':_0x2d13f4,'paymentId':_0x7e3fe8,'shopId':_0x84f206,'amount':_0x4dbf15,'currency':_0xe92176});}[a44_0x5a4984(0x10f)](_0x530510,_0x2988f4,_0x504da2,_0x5d55d1,_0x2787d1){const _0xbd57e6=a44_0x5a4984;this['writeLog'](_0xbd57e6(0x11e),{'type':_0xbd57e6(0x12b),'endpoint':_0x530510,'method':_0x2988f4,'userId':_0x504da2,'userRole':_0x5d55d1,'requestData':_0x2787d1});}[a44_0x5a4984(0xe1)](){const _0x5444e0=a44_0x5a4984;try{const _0xc3086=fs_1[_0x5444e0(0x12a)][_0x5444e0(0xf2)](this['logsDir']),_0x554fb2=_0xc3086['filter'](_0x405ca8=>_0x405ca8[_0x5444e0(0xe5)](_0x5444e0(0xfa))),_0x3a9506=[...new Set(_0x554fb2[_0x5444e0(0xf3)](_0x5ba74e=>_0x5ba74e[_0x5444e0(0xe0)]('_')[0x0]))],_0x5ece33=_0x554fb2[_0x5444e0(0xf3)](_0x4689e8=>{const _0x463ff1=_0x5444e0,_0x408c63=path_1[_0x463ff1(0x12a)][_0x463ff1(0xee)](this['logsDir'],_0x4689e8),_0x511dd7=fs_1['default'][_0x463ff1(0xeb)](_0x408c63),[_0x44b2d6,_0x46e129]=_0x4689e8['replace']('.log','')[_0x463ff1(0xe0)]('_');return{'type':_0x44b2d6,'date':_0x46e129,'size':_0x511dd7['size']};})[_0x5444e0(0x115)]((_0x195753,_0x1ced53)=>_0x1ced53[_0x5444e0(0x10e)][_0x5444e0(0x11d)](_0x195753['date']));return{'totalFiles':_0x554fb2[_0x5444e0(0xdc)],'logTypes':_0x3a9506,'latestLogs':_0x5ece33['slice'](0x0,0xa)};}catch(_0x4ac53b){return console[_0x5444e0(0xe3)](_0x5444e0(0x10a),_0x4ac53b),{'totalFiles':0x0,'logTypes':[],'latestLogs':[]};}}[a44_0x5a4984(0x109)](_0x310784=0x1e){const _0x2f5dd4=a44_0x5a4984;try{const _0x30a34d=fs_1[_0x2f5dd4(0x12a)][_0x2f5dd4(0xf2)](this[_0x2f5dd4(0xf5)]),_0x385cb0=new Date();_0x385cb0[_0x2f5dd4(0xfd)](_0x385cb0['getDate']()-_0x310784);let _0x45a6e3=0x0;_0x30a34d[_0x2f5dd4(0xec)](_0x5d8138=>{const _0x2e4bd6=_0x2f5dd4;if(!_0x5d8138[_0x2e4bd6(0xe5)]('.log'))return;const _0x28f899=path_1[_0x2e4bd6(0x12a)][_0x2e4bd6(0xee)](this[_0x2e4bd6(0xf5)],_0x5d8138),_0x692d48=fs_1[_0x2e4bd6(0x12a)][_0x2e4bd6(0xeb)](_0x28f899);_0x692d48[_0x2e4bd6(0xf1)]<_0x385cb0&&(fs_1['default'][_0x2e4bd6(0x116)](_0x28f899),_0x45a6e3++,console['log'](_0x2e4bd6(0xf8)+_0x5d8138));}),console[_0x2f5dd4(0x110)]('🧹\x20Cleaned\x20'+_0x45a6e3+_0x2f5dd4(0xdd)+_0x310784+'\x20days)');}catch(_0x15dea0){console[_0x2f5dd4(0xe3)](_0x2f5dd4(0xfb),_0x15dea0);}}}exports[a44_0x5a4984(0x100)]=LoggerService,exports['loggerService']=new LoggerService();