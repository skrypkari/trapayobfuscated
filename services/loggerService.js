'use strict';const a49_0x420761=a49_0x1223;(function(_0x184f1b,_0x5c53d3){const _0x12ab26=a49_0x1223,_0x26cc76=_0x184f1b();while(!![]){try{const _0x468d28=parseInt(_0x12ab26(0x15d))/0x1*(-parseInt(_0x12ab26(0x15a))/0x2)+-parseInt(_0x12ab26(0x146))/0x3*(parseInt(_0x12ab26(0x12f))/0x4)+-parseInt(_0x12ab26(0x14b))/0x5*(parseInt(_0x12ab26(0x136))/0x6)+parseInt(_0x12ab26(0x12c))/0x7*(parseInt(_0x12ab26(0x141))/0x8)+parseInt(_0x12ab26(0x137))/0x9*(-parseInt(_0x12ab26(0x131))/0xa)+-parseInt(_0x12ab26(0x152))/0xb+-parseInt(_0x12ab26(0x13b))/0xc*(-parseInt(_0x12ab26(0x14f))/0xd);if(_0x468d28===_0x5c53d3)break;else _0x26cc76['push'](_0x26cc76['shift']());}catch(_0x213bf0){_0x26cc76['push'](_0x26cc76['shift']());}}}(a49_0x44fe,0x61920));function a49_0x44fe(){const _0x40936b=['white_domain_responses','stack','localeCompare','762jnVsbA','logs','size','1466xfmPmm','API_CALL','replace','🧹\x20Cleaned\x20','cointopay_status_changes','ERROR','split','logCoinToPayError','logWebhookProcessed','stringify','cwd','statSync','webhooks_processed','COINTOPAY_ERROR','default','logCoinToPayStatus','logShopWebhookSent','cointopay_errors','length','path','mtime','toISOString','existsSync','\x20old\x20log\x20files\x20(older\x20than\x20','sort','utf8','SHOP_WEBHOOK_SENT','logPaymentCreated','appendFileSync','log','unlinkSync','webhooks_received','\x20log:','Failed\x20to\x20write\x20','ensureLogsDirectory','map','setDate','readdirSync','WEBHOOK_PROCESSED','logWebhookError','slice','114968sIVfYy','error','message','77516VMQhLo','logWhiteDomainRequest','661410xuhNGk','join','\x20days)','logWebhookReceived','logsDir','581772GRydDJ','45gkIgNW','white_domain_errors','.log','cleanOldLogs','36GzmbtA','getDate','__importDefault','COINTOPAY_STATUS_CHANGE','white_domain_requests','date','160QZVQnD','WEBHOOK_RECEIVED','Failed\x20to\x20get\x20log\x20stats:','🗑️\x20Deleted\x20old\x20log\x20file:\x20','writeLog','39deSePc','PAYMENT_CREATED','__esModule','webhooks_errors','WEBHOOK_ERROR','40RdxHkQ','Failed\x20to\x20clean\x20old\x20logs:','logWhiteDomainResponse','filter','9589164UKCpii','REQUEST','api_calls','2473262jeDjHw','📁\x20Created\x20logs\x20directory:\x20','shop_webhooks_sent','getLogFileName','logShopWebhookError'];a49_0x44fe=function(){return _0x40936b;};return a49_0x44fe();}var __importDefault=this&&this[a49_0x420761(0x13d)]||function(_0x125848){const _0x1eab43=a49_0x420761;return _0x125848&&_0x125848[_0x1eab43(0x148)]?_0x125848:{'default':_0x125848};};Object['defineProperty'](exports,'__esModule',{'value':!![]}),exports['loggerService']=exports['LoggerService']=void 0x0;const fs_1=__importDefault(require('fs')),path_1=__importDefault(require(a49_0x420761(0x116)));class LoggerService{constructor(){const _0x4b69fe=a49_0x420761;this[_0x4b69fe(0x135)]=path_1[_0x4b69fe(0x16b)][_0x4b69fe(0x132)](process[_0x4b69fe(0x167)](),_0x4b69fe(0x15b)),this[_0x4b69fe(0x125)]();}['ensureLogsDirectory'](){const _0x57f452=a49_0x420761;!fs_1[_0x57f452(0x16b)][_0x57f452(0x119)](this['logsDir'])&&(fs_1[_0x57f452(0x16b)]['mkdirSync'](this[_0x57f452(0x135)],{'recursive':!![]}),console[_0x57f452(0x120)](_0x57f452(0x153)+this['logsDir']));}[a49_0x420761(0x155)](_0x4e1866){const _0x1d009d=a49_0x420761,_0x57ae19=new Date()[_0x1d009d(0x118)]()['split']('T')[0x0];return path_1[_0x1d009d(0x16b)][_0x1d009d(0x132)](this['logsDir'],_0x4e1866+'_'+_0x57ae19+_0x1d009d(0x139));}[a49_0x420761(0x145)](_0x5561dc,_0x41e751){const _0x10bee8=a49_0x420761;try{const _0x350108=new Date()[_0x10bee8(0x118)](),_0x55f7f9={'timestamp':_0x350108,..._0x41e751},_0x5eea53=JSON[_0x10bee8(0x166)](_0x55f7f9)+'\x0a',_0x578d59=this[_0x10bee8(0x155)](_0x5561dc);fs_1[_0x10bee8(0x16b)][_0x10bee8(0x11f)](_0x578d59,_0x5eea53,_0x10bee8(0x11c));}catch(_0x449324){console[_0x10bee8(0x12d)](_0x10bee8(0x124)+_0x5561dc+_0x10bee8(0x123),_0x449324);}}[a49_0x420761(0x130)](_0x1ce4a9,_0x4364d5,_0x3fbb2d,_0xa45eb3){const _0x3d06f6=a49_0x420761;this[_0x3d06f6(0x145)](_0x3d06f6(0x13f),{'type':_0x3d06f6(0x150),'gateway':_0x1ce4a9,'endpoint':_0x4364d5,'method':_0x3fbb2d,'data':_0xa45eb3});}[a49_0x420761(0x14d)](_0x5ec8eb,_0x413745,_0x2be555,_0x8ea99c,_0x501697){const _0x5767d8=a49_0x420761;this[_0x5767d8(0x145)](_0x5767d8(0x157),{'type':'RESPONSE','gateway':_0x5ec8eb,'endpoint':_0x413745,'status':_0x2be555,'responseTime':_0x501697,'data':_0x8ea99c});}['logWhiteDomainError'](_0x2d62bb,_0x2ff782,_0x2b1924){const _0x218e1d=a49_0x420761;this[_0x218e1d(0x145)](_0x218e1d(0x138),{'type':_0x218e1d(0x162),'gateway':_0x2d62bb,'endpoint':_0x2ff782,'error':_0x2b1924 instanceof Error?{'message':_0x2b1924[_0x218e1d(0x12e)],'stack':_0x2b1924['stack']}:_0x2b1924});}[a49_0x420761(0x134)](_0x5a9cb5,_0x5e218b,_0x26c021){const _0xc99ad9=a49_0x420761;this[_0xc99ad9(0x145)](_0xc99ad9(0x122),{'type':_0xc99ad9(0x142),'gateway':_0x5a9cb5,'headers':_0x26c021,'data':_0x5e218b});}[a49_0x420761(0x165)](_0x1ca66e,_0x4ddee5,_0x23a8ae,_0x471eda,_0x14b314){const _0x4283a5=a49_0x420761;this[_0x4283a5(0x145)](_0x4283a5(0x169),{'type':_0x4283a5(0x129),'gateway':_0x1ca66e,'paymentId':_0x4ddee5,'oldStatus':_0x23a8ae,'newStatus':_0x471eda,'originalData':_0x14b314});}[a49_0x420761(0x12a)](_0x1d5f4e,_0x26efd1,_0x465ea2){const _0x2ce36d=a49_0x420761;this[_0x2ce36d(0x145)](_0x2ce36d(0x149),{'type':_0x2ce36d(0x14a),'gateway':_0x1d5f4e,'error':_0x26efd1 instanceof Error?{'message':_0x26efd1[_0x2ce36d(0x12e)],'stack':_0x26efd1['stack']}:_0x26efd1,'originalData':_0x465ea2});}[a49_0x420761(0x16c)](_0x81589d){const _0x1d5678=a49_0x420761;this[_0x1d5678(0x145)](_0x1d5678(0x161),{'type':_0x1d5678(0x13e),..._0x81589d});}[a49_0x420761(0x164)](_0x3bc198){const _0x4bdbf8=a49_0x420761;this[_0x4bdbf8(0x145)](_0x4bdbf8(0x114),{'type':_0x4bdbf8(0x16a),..._0x3bc198});}[a49_0x420761(0x113)](_0x1e2315,_0x3769f3,_0xeed08b,_0x118c53,_0x2c51e0,_0x14513b){const _0x3ac027=a49_0x420761;this[_0x3ac027(0x145)](_0x3ac027(0x154),{'type':_0x3ac027(0x11d),'shopId':_0x1e2315,'webhookUrl':_0x3769f3,'event':_0xeed08b,'status':_0x118c53,'responseTime':_0x2c51e0,'payload':_0x14513b});}[a49_0x420761(0x156)](_0x39a21a,_0x440d35,_0x5d564b,_0x176a0a,_0x12d42c){const _0x133c0e=a49_0x420761;this[_0x133c0e(0x145)]('shop_webhooks_errors',{'type':'SHOP_WEBHOOK_ERROR','shopId':_0x39a21a,'webhookUrl':_0x440d35,'event':_0x5d564b,'error':_0x176a0a instanceof Error?{'message':_0x176a0a[_0x133c0e(0x12e)],'stack':_0x176a0a[_0x133c0e(0x158)]}:_0x176a0a,'payload':_0x12d42c});}[a49_0x420761(0x11e)](_0x354005,_0x593677,_0x2a2bab,_0x1f79c6,_0xab42b0){const _0x480b3a=a49_0x420761;this['writeLog']('payments_created',{'type':_0x480b3a(0x147),'gateway':_0x354005,'paymentId':_0x593677,'shopId':_0x2a2bab,'amount':_0x1f79c6,'currency':_0xab42b0});}['logApiCall'](_0x59b987,_0x396f94,_0x23a83f,_0x30873f,_0x23166e){const _0xdfb2ee=a49_0x420761;this[_0xdfb2ee(0x145)](_0xdfb2ee(0x151),{'type':_0xdfb2ee(0x15e),'endpoint':_0x59b987,'method':_0x396f94,'userId':_0x23a83f,'userRole':_0x30873f,'requestData':_0x23166e});}['getLogStats'](){const _0xaeec53=a49_0x420761;try{const _0x37e1c7=fs_1[_0xaeec53(0x16b)]['readdirSync'](this['logsDir']),_0x184c04=_0x37e1c7[_0xaeec53(0x14e)](_0x57f839=>_0x57f839['endsWith'](_0xaeec53(0x139))),_0xd843bb=[...new Set(_0x184c04[_0xaeec53(0x126)](_0x1889e1=>_0x1889e1[_0xaeec53(0x163)]('_')[0x0]))],_0x478166=_0x184c04['map'](_0x21f2ee=>{const _0x50c0ef=_0xaeec53,_0x2d6b31=path_1['default']['join'](this['logsDir'],_0x21f2ee),_0x263e2d=fs_1['default']['statSync'](_0x2d6b31),[_0x4d81c1,_0x3a402f]=_0x21f2ee[_0x50c0ef(0x15f)](_0x50c0ef(0x139),'')[_0x50c0ef(0x163)]('_');return{'type':_0x4d81c1,'date':_0x3a402f,'size':_0x263e2d[_0x50c0ef(0x15c)]};})[_0xaeec53(0x11b)]((_0x33204c,_0x39cc07)=>_0x39cc07[_0xaeec53(0x140)][_0xaeec53(0x159)](_0x33204c['date']));return{'totalFiles':_0x184c04[_0xaeec53(0x115)],'logTypes':_0xd843bb,'latestLogs':_0x478166[_0xaeec53(0x12b)](0x0,0xa)};}catch(_0x36ed5d){return console[_0xaeec53(0x12d)](_0xaeec53(0x143),_0x36ed5d),{'totalFiles':0x0,'logTypes':[],'latestLogs':[]};}}[a49_0x420761(0x13a)](_0xee7396=0x1e){const _0x34f02d=a49_0x420761;try{const _0x53fdee=fs_1[_0x34f02d(0x16b)][_0x34f02d(0x128)](this[_0x34f02d(0x135)]),_0x11383a=new Date();_0x11383a[_0x34f02d(0x127)](_0x11383a[_0x34f02d(0x13c)]()-_0xee7396);let _0x51ea14=0x0;_0x53fdee['forEach'](_0x134eaf=>{const _0x4fb0a3=_0x34f02d;if(!_0x134eaf['endsWith'](_0x4fb0a3(0x139)))return;const _0x13eecb=path_1[_0x4fb0a3(0x16b)]['join'](this[_0x4fb0a3(0x135)],_0x134eaf),_0x45a29c=fs_1[_0x4fb0a3(0x16b)][_0x4fb0a3(0x168)](_0x13eecb);_0x45a29c[_0x4fb0a3(0x117)]<_0x11383a&&(fs_1[_0x4fb0a3(0x16b)][_0x4fb0a3(0x121)](_0x13eecb),_0x51ea14++,console['log'](_0x4fb0a3(0x144)+_0x134eaf));}),console[_0x34f02d(0x120)](_0x34f02d(0x160)+_0x51ea14+_0x34f02d(0x11a)+_0xee7396+_0x34f02d(0x133));}catch(_0x42a13a){console[_0x34f02d(0x12d)](_0x34f02d(0x14c),_0x42a13a);}}}function a49_0x1223(_0x61fb9c,_0x4bc4c3){const _0x44fe74=a49_0x44fe();return a49_0x1223=function(_0x12236b,_0x4e34d0){_0x12236b=_0x12236b-0x113;let _0x470208=_0x44fe74[_0x12236b];return _0x470208;},a49_0x1223(_0x61fb9c,_0x4bc4c3);}exports['LoggerService']=LoggerService,exports['loggerService']=new LoggerService();