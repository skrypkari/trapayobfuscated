'use strict';const a55_0x1bb2c0=a55_0x5274;(function(_0x378cf3,_0x23514e){const _0x47e8a3=a55_0x5274,_0x1b6bcc=_0x378cf3();while(!![]){try{const _0xdf0d9c=-parseInt(_0x47e8a3(0x162))/0x1+parseInt(_0x47e8a3(0x17f))/0x2*(-parseInt(_0x47e8a3(0x18c))/0x3)+-parseInt(_0x47e8a3(0x166))/0x4+parseInt(_0x47e8a3(0x17c))/0x5*(parseInt(_0x47e8a3(0x170))/0x6)+parseInt(_0x47e8a3(0x18a))/0x7+-parseInt(_0x47e8a3(0x171))/0x8*(parseInt(_0x47e8a3(0x167))/0x9)+parseInt(_0x47e8a3(0x173))/0xa*(parseInt(_0x47e8a3(0x15b))/0xb);if(_0xdf0d9c===_0x23514e)break;else _0x1b6bcc['push'](_0x1b6bcc['shift']());}catch(_0x59796d){_0x1b6bcc['push'](_0x1b6bcc['shift']());}}}(a55_0x59b3,0xdf06c));var __importDefault=this&&this[a55_0x1bb2c0(0x160)]||function(_0x2a9ad3){const _0x5ee4f6=a55_0x1bb2c0;return _0x2a9ad3&&_0x2a9ad3[_0x5ee4f6(0x15f)]?_0x2a9ad3:{'default':_0x2a9ad3};};Object[a55_0x1bb2c0(0x175)](exports,'__esModule',{'value':!![]}),exports['loggerService']=exports['LoggerService']=void 0x0;const fs_1=__importDefault(require('fs')),path_1=__importDefault(require('path'));function a55_0x5274(_0xac55a1,_0x4c2fee){const _0x59b3a3=a55_0x59b3();return a55_0x5274=function(_0x527499,_0x8a1298){_0x527499=_0x527499-0x14c;let _0x2c86ba=_0x59b3a3[_0x527499];return _0x2c86ba;},a55_0x5274(_0xac55a1,_0x4c2fee);}class LoggerService{constructor(){const _0x4ef0ed=a55_0x1bb2c0;this['logsDir']=path_1['default']['join'](process['cwd'](),_0x4ef0ed(0x17d)),this[_0x4ef0ed(0x18e)]();}[a55_0x1bb2c0(0x18e)](){const _0x4379f0=a55_0x1bb2c0;!fs_1[_0x4379f0(0x14e)][_0x4379f0(0x14f)](this[_0x4379f0(0x161)])&&(fs_1[_0x4379f0(0x14e)]['mkdirSync'](this[_0x4379f0(0x161)],{'recursive':!![]}),console[_0x4379f0(0x151)](_0x4379f0(0x150)+this[_0x4379f0(0x161)]));}[a55_0x1bb2c0(0x193)](_0x514010){const _0x3b3a3b=a55_0x1bb2c0,_0x465c90=new Date()[_0x3b3a3b(0x180)]()[_0x3b3a3b(0x199)]('T')[0x0];return path_1[_0x3b3a3b(0x14e)][_0x3b3a3b(0x174)](this[_0x3b3a3b(0x161)],_0x514010+'_'+_0x465c90+'.log');}[a55_0x1bb2c0(0x15c)](_0x1d8163,_0x5f211d){const _0x314b8f=a55_0x1bb2c0;try{const _0x3d8127=new Date()['toISOString'](),_0x26500c={'timestamp':_0x3d8127,..._0x5f211d},_0x4cba39=JSON[_0x314b8f(0x155)](_0x26500c)+'\x0a',_0x729a80=this[_0x314b8f(0x193)](_0x1d8163);fs_1['default'][_0x314b8f(0x165)](_0x729a80,_0x4cba39,_0x314b8f(0x18d));}catch(_0x43e58d){console['error']('Failed\x20to\x20write\x20'+_0x1d8163+'\x20log:',_0x43e58d);}}['logWhiteDomainRequest'](_0x2b2593,_0x529186,_0x502cbd,_0x27b5c3){const _0x3e9224=a55_0x1bb2c0;this[_0x3e9224(0x15c)](_0x3e9224(0x181),{'type':_0x3e9224(0x179),'gateway':_0x2b2593,'endpoint':_0x529186,'method':_0x502cbd,'data':_0x27b5c3});}['logWhiteDomainResponse'](_0x3f4189,_0x422019,_0x54ae21,_0x5dd453,_0x4b4e99){const _0x50d4f0=a55_0x1bb2c0;this[_0x50d4f0(0x15c)]('white_domain_responses',{'type':'RESPONSE','gateway':_0x3f4189,'endpoint':_0x422019,'status':_0x54ae21,'responseTime':_0x4b4e99,'data':_0x5dd453});}[a55_0x1bb2c0(0x19e)](_0x26b483,_0x56ff65,_0x160e12){const _0x317185=a55_0x1bb2c0;this[_0x317185(0x15c)](_0x317185(0x14c),{'type':_0x317185(0x152),'gateway':_0x26b483,'endpoint':_0x56ff65,'error':_0x160e12 instanceof Error?{'message':_0x160e12[_0x317185(0x176)],'stack':_0x160e12['stack']}:_0x160e12});}[a55_0x1bb2c0(0x16c)](_0xaaf6ad,_0x306cd5,_0xf692aa){const _0x11471f=a55_0x1bb2c0;this[_0x11471f(0x15c)](_0x11471f(0x172),{'type':_0x11471f(0x168),'gateway':_0xaaf6ad,'headers':_0xf692aa,'data':_0x306cd5});}[a55_0x1bb2c0(0x18b)](_0x4f37af,_0x272470,_0x44956a,_0x5b3a5a,_0x214e93){const _0x93c7f5=a55_0x1bb2c0;this[_0x93c7f5(0x15c)](_0x93c7f5(0x19d),{'type':_0x93c7f5(0x16a),'gateway':_0x4f37af,'paymentId':_0x272470,'oldStatus':_0x44956a,'newStatus':_0x5b3a5a,'originalData':_0x214e93});}[a55_0x1bb2c0(0x159)](_0x3077bc,_0x50d351,_0x35e294){const _0x40d743=a55_0x1bb2c0;this[_0x40d743(0x15c)](_0x40d743(0x177),{'type':_0x40d743(0x198),'gateway':_0x3077bc,'error':_0x50d351 instanceof Error?{'message':_0x50d351[_0x40d743(0x176)],'stack':_0x50d351[_0x40d743(0x164)]}:_0x50d351,'originalData':_0x35e294});}[a55_0x1bb2c0(0x16d)](_0x51dc71){const _0x23e8d0=a55_0x1bb2c0;this[_0x23e8d0(0x15c)](_0x23e8d0(0x16e),{'type':'COINTOPAY_STATUS_CHANGE',..._0x51dc71});}[a55_0x1bb2c0(0x17a)](_0x5d1bf4){const _0x5228c4=a55_0x1bb2c0;this['writeLog'](_0x5228c4(0x17e),{'type':_0x5228c4(0x191),..._0x5d1bf4});}[a55_0x1bb2c0(0x182)](_0x536ca6,_0x409bf3,_0x9830c8,_0x37f7a1,_0x59ae15,_0x164011){const _0x1c14fb=a55_0x1bb2c0;this['writeLog'](_0x1c14fb(0x188),{'type':'SHOP_WEBHOOK_SENT','shopId':_0x536ca6,'webhookUrl':_0x409bf3,'event':_0x9830c8,'status':_0x37f7a1,'responseTime':_0x59ae15,'payload':_0x164011});}[a55_0x1bb2c0(0x196)](_0x3b2239,_0x53620c,_0x3a8249,_0x3b0e24,_0xf780a2){const _0x208ea4=a55_0x1bb2c0;this[_0x208ea4(0x15c)](_0x208ea4(0x197),{'type':_0x208ea4(0x190),'shopId':_0x3b2239,'webhookUrl':_0x53620c,'event':_0x3a8249,'error':_0x3b0e24 instanceof Error?{'message':_0x3b0e24['message'],'stack':_0x3b0e24[_0x208ea4(0x164)]}:_0x3b0e24,'payload':_0xf780a2});}['logPaymentCreated'](_0x3e8e94,_0x423d6,_0x53b7f7,_0x318359,_0x5161f){const _0x130f51=a55_0x1bb2c0;this[_0x130f51(0x15c)](_0x130f51(0x154),{'type':_0x130f51(0x186),'gateway':_0x3e8e94,'paymentId':_0x423d6,'shopId':_0x53b7f7,'amount':_0x318359,'currency':_0x5161f});}['logApiCall'](_0x17a1ab,_0x48a7a1,_0x30ab79,_0x193bd2,_0x1358a5){const _0x3081ac=a55_0x1bb2c0;this[_0x3081ac(0x15c)](_0x3081ac(0x15e),{'type':_0x3081ac(0x14d),'endpoint':_0x17a1ab,'method':_0x48a7a1,'userId':_0x30ab79,'userRole':_0x193bd2,'requestData':_0x1358a5});}['getLogStats'](){const _0x3d7b74=a55_0x1bb2c0;try{const _0x266ef7=fs_1['default'][_0x3d7b74(0x157)](this[_0x3d7b74(0x161)]),_0x42e4c0=_0x266ef7['filter'](_0x115f71=>_0x115f71[_0x3d7b74(0x18f)](_0x3d7b74(0x195))),_0x29c452=[...new Set(_0x42e4c0['map'](_0x24d43e=>_0x24d43e['split']('_')[0x0]))],_0x14bbd8=_0x42e4c0['map'](_0x2a8522=>{const _0x6b55c0=_0x3d7b74,_0x3c0392=path_1[_0x6b55c0(0x14e)][_0x6b55c0(0x174)](this[_0x6b55c0(0x161)],_0x2a8522),_0x24fbfc=fs_1['default'][_0x6b55c0(0x189)](_0x3c0392),[_0x53d322,_0x31f166]=_0x2a8522[_0x6b55c0(0x169)](_0x6b55c0(0x195),'')[_0x6b55c0(0x199)]('_');return{'type':_0x53d322,'date':_0x31f166,'size':_0x24fbfc[_0x6b55c0(0x192)]};})[_0x3d7b74(0x16b)]((_0x27591b,_0x406576)=>_0x406576[_0x3d7b74(0x19c)][_0x3d7b74(0x15a)](_0x27591b[_0x3d7b74(0x19c)]));return{'totalFiles':_0x42e4c0[_0x3d7b74(0x156)],'logTypes':_0x29c452,'latestLogs':_0x14bbd8[_0x3d7b74(0x178)](0x0,0xa)};}catch(_0x2d9db3){return console[_0x3d7b74(0x19a)](_0x3d7b74(0x17b),_0x2d9db3),{'totalFiles':0x0,'logTypes':[],'latestLogs':[]};}}[a55_0x1bb2c0(0x15d)](_0x59d878=0x1e){const _0x3d2384=a55_0x1bb2c0;try{const _0x1d5f93=fs_1[_0x3d2384(0x14e)][_0x3d2384(0x157)](this[_0x3d2384(0x161)]),_0x194963=new Date();_0x194963[_0x3d2384(0x158)](_0x194963[_0x3d2384(0x153)]()-_0x59d878);let _0x361e42=0x0;_0x1d5f93[_0x3d2384(0x183)](_0x1b79b2=>{const _0xc647c5=_0x3d2384;if(!_0x1b79b2[_0xc647c5(0x18f)](_0xc647c5(0x195)))return;const _0x1b1952=path_1['default'][_0xc647c5(0x174)](this[_0xc647c5(0x161)],_0x1b79b2),_0x1e801c=fs_1['default'][_0xc647c5(0x189)](_0x1b1952);_0x1e801c[_0xc647c5(0x163)]<_0x194963&&(fs_1[_0xc647c5(0x14e)][_0xc647c5(0x185)](_0x1b1952),_0x361e42++,console[_0xc647c5(0x151)]('🗑️\x20Deleted\x20old\x20log\x20file:\x20'+_0x1b79b2));}),console[_0x3d2384(0x151)](_0x3d2384(0x187)+_0x361e42+_0x3d2384(0x194)+_0x59d878+'\x20days)');}catch(_0x48534e){console['error'](_0x3d2384(0x184),_0x48534e);}}}exports[a55_0x1bb2c0(0x19b)]=LoggerService,exports[a55_0x1bb2c0(0x16f)]=new LoggerService();function a55_0x59b3(){const _0x397ca6=['logWebhookReceived','logCoinToPayStatus','cointopay_status_changes','loggerService','800904TElSXR','8vDxPEA','webhooks_received','88210cgYEnd','join','defineProperty','message','webhooks_errors','slice','REQUEST','logCoinToPayError','Failed\x20to\x20get\x20log\x20stats:','35SBghfX','logs','cointopay_errors','799666zShaCT','toISOString','white_domain_requests','logShopWebhookSent','forEach','Failed\x20to\x20clean\x20old\x20logs:','unlinkSync','PAYMENT_CREATED','🧹\x20Cleaned\x20','shop_webhooks_sent','statSync','11063206XrXHPz','logWebhookProcessed','6DCZylH','utf8','ensureLogsDirectory','endsWith','SHOP_WEBHOOK_ERROR','COINTOPAY_ERROR','size','getLogFileName','\x20old\x20log\x20files\x20(older\x20than\x20','.log','logShopWebhookError','shop_webhooks_errors','WEBHOOK_ERROR','split','error','LoggerService','date','webhooks_processed','logWhiteDomainError','white_domain_errors','API_CALL','default','existsSync','📁\x20Created\x20logs\x20directory:\x20','log','ERROR','getDate','payments_created','stringify','length','readdirSync','setDate','logWebhookError','localeCompare','3487xNTgwP','writeLog','cleanOldLogs','api_calls','__esModule','__importDefault','logsDir','175265UxtXmt','mtime','stack','appendFileSync','6384800fIZhaB','16438104RqHksf','WEBHOOK_RECEIVED','replace','WEBHOOK_PROCESSED','sort'];a55_0x59b3=function(){return _0x397ca6;};return a55_0x59b3();}