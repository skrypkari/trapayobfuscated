'use strict';const a79_0x2b84ed=a79_0x5362;(function(_0x3c1f27,_0x54840e){const _0x320a16=a79_0x5362,_0x4a31ee=_0x3c1f27();while(!![]){try{const _0x1a3513=parseInt(_0x320a16(0xc0))/0x1+-parseInt(_0x320a16(0x8e))/0x2*(-parseInt(_0x320a16(0x9c))/0x3)+parseInt(_0x320a16(0xae))/0x4+-parseInt(_0x320a16(0xa7))/0x5*(parseInt(_0x320a16(0xb1))/0x6)+-parseInt(_0x320a16(0xa8))/0x7+-parseInt(_0x320a16(0xc6))/0x8*(-parseInt(_0x320a16(0xc5))/0x9)+parseInt(_0x320a16(0xb5))/0xa*(-parseInt(_0x320a16(0xb9))/0xb);if(_0x1a3513===_0x54840e)break;else _0x4a31ee['push'](_0x4a31ee['shift']());}catch(_0x12ef4a){_0x4a31ee['push'](_0x4a31ee['shift']());}}}(a79_0x11b1,0x34b4c));var __importDefault=this&&this['__importDefault']||function(_0x12443f){const _0x2c758b=a79_0x5362;return _0x12443f&&_0x12443f[_0x2c758b(0x98)]?_0x12443f:{'default':_0x12443f};};function a79_0x5362(_0x53db8e,_0xb319f0){_0x53db8e=_0x53db8e-0x8a;const _0x11b114=a79_0x11b1();let _0x536253=_0x11b114[_0x53db8e];return _0x536253;}Object[a79_0x2b84ed(0xc2)](exports,'__esModule',{'value':!![]}),exports['loggerService']=exports[a79_0x2b84ed(0x8d)]=void 0x0;const fs_1=__importDefault(require('fs')),path_1=__importDefault(require(a79_0x2b84ed(0xb8)));class LoggerService{constructor(){const _0x2dadef=a79_0x2b84ed;this[_0x2dadef(0xd3)]=path_1[_0x2dadef(0xc8)][_0x2dadef(0xba)](process[_0x2dadef(0x95)](),_0x2dadef(0xbb)),this[_0x2dadef(0xdd)]();}[a79_0x2b84ed(0xdd)](){const _0x98d618=a79_0x2b84ed;!fs_1[_0x98d618(0xc8)]['existsSync'](this[_0x98d618(0xd3)])&&(fs_1[_0x98d618(0xc8)]['mkdirSync'](this[_0x98d618(0xd3)],{'recursive':!![]}),console[_0x98d618(0x8a)](_0x98d618(0x93)+this[_0x98d618(0xd3)]));}[a79_0x2b84ed(0xdb)](_0x584f6b){const _0x216075=a79_0x2b84ed,_0x1b6760=new Date()[_0x216075(0x97)]()[_0x216075(0xbe)]('T')[0x0];return path_1['default'][_0x216075(0xba)](this[_0x216075(0xd3)],_0x584f6b+'_'+_0x1b6760+'.log');}['writeLog'](_0x499770,_0x31e505){const _0x328339=a79_0x2b84ed;try{const _0x2b2401=new Date()[_0x328339(0x97)](),_0x5eb98e={'timestamp':_0x2b2401,..._0x31e505},_0x1cefd6=JSON['stringify'](_0x5eb98e)+'\x0a',_0x5567a6=this['getLogFileName'](_0x499770);fs_1[_0x328339(0xc8)][_0x328339(0xb3)](_0x5567a6,_0x1cefd6,_0x328339(0x99));}catch(_0x4df876){console[_0x328339(0xcb)](_0x328339(0xb2)+_0x499770+_0x328339(0xbd),_0x4df876);}}['logWhiteDomainRequest'](_0xe21eb8,_0x2bb0e5,_0x204755,_0x58cae3){const _0x2aad65=a79_0x2b84ed;this['writeLog'](_0x2aad65(0xd2),{'type':'REQUEST','gateway':_0xe21eb8,'endpoint':_0x2bb0e5,'method':_0x204755,'data':_0x58cae3});}['logWhiteDomainResponse'](_0x6d2ece,_0x322048,_0x13ca28,_0x3afa21,_0x25cab0){const _0x214573=a79_0x2b84ed;this[_0x214573(0xd8)](_0x214573(0xd9),{'type':_0x214573(0x8c),'gateway':_0x6d2ece,'endpoint':_0x322048,'status':_0x13ca28,'responseTime':_0x25cab0,'data':_0x3afa21});}[a79_0x2b84ed(0xcc)](_0x46407a,_0xd2632c,_0x5bb206){const _0x4ef85c=a79_0x2b84ed;this[_0x4ef85c(0xd8)](_0x4ef85c(0xaa),{'type':_0x4ef85c(0xa9),'gateway':_0x46407a,'endpoint':_0xd2632c,'error':_0x5bb206 instanceof Error?{'message':_0x5bb206['message'],'stack':_0x5bb206[_0x4ef85c(0xb6)]}:_0x5bb206});}[a79_0x2b84ed(0xd6)](_0x8157e9,_0x287cb6,_0x49ecdc){const _0x53a156=a79_0x2b84ed;this[_0x53a156(0xd8)]('webhooks_received',{'type':_0x53a156(0xa6),'gateway':_0x8157e9,'headers':_0x49ecdc,'data':_0x287cb6});}['logWebhookProcessed'](_0xe704df,_0x5c96db,_0xc9faa2,_0xab663a,_0x34a0ea){const _0x2342c8=a79_0x2b84ed;this['writeLog'](_0x2342c8(0xa2),{'type':_0x2342c8(0xc7),'gateway':_0xe704df,'paymentId':_0x5c96db,'oldStatus':_0xc9faa2,'newStatus':_0xab663a,'originalData':_0x34a0ea});}[a79_0x2b84ed(0xce)](_0x4c7fda,_0x3c19d1,_0x2ca15b){const _0x3eab5f=a79_0x2b84ed;this[_0x3eab5f(0xd8)](_0x3eab5f(0xcd),{'type':_0x3eab5f(0xc3),'gateway':_0x4c7fda,'error':_0x3c19d1 instanceof Error?{'message':_0x3c19d1['message'],'stack':_0x3c19d1[_0x3eab5f(0xb6)]}:_0x3c19d1,'originalData':_0x2ca15b});}['logCoinToPayStatus'](_0x58f3d6){const _0xa5e05c=a79_0x2b84ed;this[_0xa5e05c(0xd8)](_0xa5e05c(0xcf),{'type':_0xa5e05c(0x91),..._0x58f3d6});}[a79_0x2b84ed(0x8b)](_0x8f4caa){const _0x12f039=a79_0x2b84ed;this[_0x12f039(0xd8)]('cointopay_errors',{'type':'COINTOPAY_ERROR',..._0x8f4caa});}[a79_0x2b84ed(0xa5)](_0x1227a8,_0x5b214b,_0xb05049,_0x7bd4d3,_0x4605dd,_0x35c077){const _0x16635d=a79_0x2b84ed;this[_0x16635d(0xd8)](_0x16635d(0xd1),{'type':_0x16635d(0xad),'shopId':_0x1227a8,'webhookUrl':_0x5b214b,'event':_0xb05049,'status':_0x7bd4d3,'responseTime':_0x4605dd,'payload':_0x35c077});}[a79_0x2b84ed(0x9a)](_0x5ced00,_0x1406dd,_0x46ef2c,_0x58abeb,_0x4fe03f){const _0x1cfa08=a79_0x2b84ed;this[_0x1cfa08(0xd8)](_0x1cfa08(0xdc),{'type':_0x1cfa08(0xaf),'shopId':_0x5ced00,'webhookUrl':_0x1406dd,'event':_0x46ef2c,'error':_0x58abeb instanceof Error?{'message':_0x58abeb['message'],'stack':_0x58abeb[_0x1cfa08(0xb6)]}:_0x58abeb,'payload':_0x4fe03f});}['logPaymentCreated'](_0x3d906e,_0x36ca49,_0x1f9d81,_0x3130ad,_0x9d1b3){const _0x55c6f7=a79_0x2b84ed;this['writeLog'](_0x55c6f7(0xac),{'type':_0x55c6f7(0x96),'gateway':_0x3d906e,'paymentId':_0x36ca49,'shopId':_0x1f9d81,'amount':_0x3130ad,'currency':_0x9d1b3});}[a79_0x2b84ed(0xc1)](_0x4e8876,_0x2326da,_0x4c4c62,_0x1e8520,_0x58494a){const _0x2e193b=a79_0x2b84ed;this[_0x2e193b(0xd8)](_0x2e193b(0xca),{'type':'API_CALL','endpoint':_0x4e8876,'method':_0x2326da,'userId':_0x4c4c62,'userRole':_0x1e8520,'requestData':_0x58494a});}[a79_0x2b84ed(0xa4)](){const _0x2a2ad8=a79_0x2b84ed;try{const _0x244866=fs_1[_0x2a2ad8(0xc8)][_0x2a2ad8(0xc9)](this[_0x2a2ad8(0xd3)]),_0x33c39c=_0x244866[_0x2a2ad8(0x92)](_0xd60630=>_0xd60630[_0x2a2ad8(0xa1)](_0x2a2ad8(0xa3))),_0x4ee400=[...new Set(_0x33c39c[_0x2a2ad8(0xa0)](_0x25f015=>_0x25f015['split']('_')[0x0]))],_0x2a669e=_0x33c39c['map'](_0x19f2d1=>{const _0x2bdba4=_0x2a2ad8,_0x212c09=path_1['default']['join'](this[_0x2bdba4(0xd3)],_0x19f2d1),_0x59d242=fs_1[_0x2bdba4(0xc8)][_0x2bdba4(0x8f)](_0x212c09),[_0x56ecf2,_0x4b8109]=_0x19f2d1[_0x2bdba4(0xd5)](_0x2bdba4(0xa3),'')['split']('_');return{'type':_0x56ecf2,'date':_0x4b8109,'size':_0x59d242[_0x2bdba4(0xd0)]};})[_0x2a2ad8(0x9f)]((_0x5255db,_0x561967)=>_0x561967[_0x2a2ad8(0xc4)]['localeCompare'](_0x5255db[_0x2a2ad8(0xc4)]));return{'totalFiles':_0x33c39c[_0x2a2ad8(0xda)],'logTypes':_0x4ee400,'latestLogs':_0x2a669e[_0x2a2ad8(0x9b)](0x0,0xa)};}catch(_0x458acd){return console[_0x2a2ad8(0xcb)](_0x2a2ad8(0xb0),_0x458acd),{'totalFiles':0x0,'logTypes':[],'latestLogs':[]};}}[a79_0x2b84ed(0x9d)](_0x2113e7=0x1e){const _0x3caeeb=a79_0x2b84ed;try{const _0x559153=fs_1[_0x3caeeb(0xc8)]['readdirSync'](this[_0x3caeeb(0xd3)]),_0x11c3b4=new Date();_0x11c3b4[_0x3caeeb(0xb7)](_0x11c3b4[_0x3caeeb(0x9e)]()-_0x2113e7);let _0x225983=0x0;_0x559153[_0x3caeeb(0x90)](_0x5aa275=>{const _0x60388c=_0x3caeeb;if(!_0x5aa275[_0x60388c(0xa1)]('.log'))return;const _0x1e9593=path_1[_0x60388c(0xc8)][_0x60388c(0xba)](this[_0x60388c(0xd3)],_0x5aa275),_0x1da0f9=fs_1[_0x60388c(0xc8)][_0x60388c(0x8f)](_0x1e9593);_0x1da0f9[_0x60388c(0x94)]<_0x11c3b4&&(fs_1[_0x60388c(0xc8)][_0x60388c(0xbc)](_0x1e9593),_0x225983++,console['log'](_0x60388c(0xd7)+_0x5aa275));}),console[_0x3caeeb(0x8a)](_0x3caeeb(0xb4)+_0x225983+'\x20old\x20log\x20files\x20(older\x20than\x20'+_0x2113e7+_0x3caeeb(0xd4));}catch(_0x20b3c0){console[_0x3caeeb(0xcb)](_0x3caeeb(0xbf),_0x20b3c0);}}}exports[a79_0x2b84ed(0x8d)]=LoggerService,exports[a79_0x2b84ed(0xab)]=new LoggerService();function a79_0x11b1(){const _0x3a993c=['white_domain_requests','logsDir','\x20days)','replace','logWebhookReceived','ðŸ—‘ï¸\x20Deleted\x20old\x20log\x20file:\x20','writeLog','white_domain_responses','length','getLogFileName','shop_webhooks_errors','ensureLogsDirectory','log','logCoinToPayError','RESPONSE','LoggerService','10vUekIc','statSync','forEach','COINTOPAY_STATUS_CHANGE','filter','ðŸ“\x20Created\x20logs\x20directory:\x20','mtime','cwd','PAYMENT_CREATED','toISOString','__esModule','utf8','logShopWebhookError','slice','204747njgqHq','cleanOldLogs','getDate','sort','map','endsWith','webhooks_processed','.log','getLogStats','logShopWebhookSent','WEBHOOK_RECEIVED','5gxaObh','3016377IxXxnm','ERROR','white_domain_errors','loggerService','payments_created','SHOP_WEBHOOK_SENT','1473984szLYII','SHOP_WEBHOOK_ERROR','Failed\x20to\x20get\x20log\x20stats:','150186CEntOs','Failed\x20to\x20write\x20','appendFileSync','ðŸ§¹\x20Cleaned\x20','2110DeTfPW','stack','setDate','path','44473yQroPr','join','logs','unlinkSync','\x20log:','split','Failed\x20to\x20clean\x20old\x20logs:','423487IrzTUb','logApiCall','defineProperty','WEBHOOK_ERROR','date','3525039EerRsf','8JkkOzu','WEBHOOK_PROCESSED','default','readdirSync','api_calls','error','logWhiteDomainError','webhooks_errors','logWebhookError','cointopay_status_changes','size','shop_webhooks_sent'];a79_0x11b1=function(){return _0x3a993c;};return a79_0x11b1();}