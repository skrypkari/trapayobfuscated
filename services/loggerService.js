'use strict';const a48_0x22a8e9=a48_0x2f05;(function(_0x210f94,_0x3f67c6){const _0x369016=a48_0x2f05,_0xac2823=_0x210f94();while(!![]){try{const _0x5d6269=parseInt(_0x369016(0xe9))/0x1+-parseInt(_0x369016(0xc5))/0x2*(parseInt(_0x369016(0xdf))/0x3)+-parseInt(_0x369016(0xb7))/0x4+-parseInt(_0x369016(0xaf))/0x5*(parseInt(_0x369016(0xe4))/0x6)+parseInt(_0x369016(0xba))/0x7*(parseInt(_0x369016(0xca))/0x8)+-parseInt(_0x369016(0xd3))/0x9+-parseInt(_0x369016(0xbe))/0xa*(-parseInt(_0x369016(0x9f))/0xb);if(_0x5d6269===_0x3f67c6)break;else _0xac2823['push'](_0xac2823['shift']());}catch(_0x16d17f){_0xac2823['push'](_0xac2823['shift']());}}}(a48_0x16ee,0xd846c));var __importDefault=this&&this['__importDefault']||function(_0x3f12fa){const _0x2c5447=a48_0x2f05;return _0x3f12fa&&_0x3f12fa[_0x2c5447(0xa3)]?_0x3f12fa:{'default':_0x3f12fa};};Object[a48_0x22a8e9(0xe2)](exports,'__esModule',{'value':!![]}),exports[a48_0x22a8e9(0xdd)]=exports[a48_0x22a8e9(0xdc)]=void 0x0;const fs_1=__importDefault(require('fs')),path_1=__importDefault(require(a48_0x22a8e9(0x9b)));class LoggerService{constructor(){const _0x46e7ec=a48_0x22a8e9;this[_0x46e7ec(0xc8)]=path_1[_0x46e7ec(0xb6)][_0x46e7ec(0xc3)](process[_0x46e7ec(0xb3)](),_0x46e7ec(0x9d)),this[_0x46e7ec(0xa0)]();}[a48_0x22a8e9(0xa0)](){const _0x4700e7=a48_0x22a8e9;!fs_1[_0x4700e7(0xb6)][_0x4700e7(0xbd)](this[_0x4700e7(0xc8)])&&(fs_1[_0x4700e7(0xb6)]['mkdirSync'](this[_0x4700e7(0xc8)],{'recursive':!![]}),console['log'](_0x4700e7(0xa5)+this[_0x4700e7(0xc8)]));}[a48_0x22a8e9(0xd5)](_0xba1c58){const _0x23e08c=a48_0x22a8e9,_0x1a471e=new Date()[_0x23e08c(0xa7)]()[_0x23e08c(0xb1)]('T')[0x0];return path_1[_0x23e08c(0xb6)]['join'](this[_0x23e08c(0xc8)],_0xba1c58+'_'+_0x1a471e+_0x23e08c(0xcc));}[a48_0x22a8e9(0xae)](_0x463ba1,_0x910886){const _0x3d801e=a48_0x22a8e9;try{const _0x48fe64=new Date()['toISOString'](),_0x8b180f={'timestamp':_0x48fe64,..._0x910886},_0x5d608b=JSON[_0x3d801e(0xea)](_0x8b180f)+'\x0a',_0x460dca=this[_0x3d801e(0xd5)](_0x463ba1);fs_1['default'][_0x3d801e(0xc6)](_0x460dca,_0x5d608b,'utf8');}catch(_0xaebe2a){console[_0x3d801e(0xe5)](_0x3d801e(0xc4)+_0x463ba1+'\x20log:',_0xaebe2a);}}['logWhiteDomainRequest'](_0x11aa2e,_0x511194,_0x217ab0,_0xe29f90){const _0x40b446=a48_0x22a8e9;this[_0x40b446(0xae)](_0x40b446(0xbf),{'type':_0x40b446(0xa8),'gateway':_0x11aa2e,'endpoint':_0x511194,'method':_0x217ab0,'data':_0xe29f90});}['logWhiteDomainResponse'](_0x3823cc,_0x21b065,_0x39cd8c,_0x40a3fc,_0x4201e4){const _0x4cf801=a48_0x22a8e9;this['writeLog'](_0x4cf801(0xdb),{'type':_0x4cf801(0xab),'gateway':_0x3823cc,'endpoint':_0x21b065,'status':_0x39cd8c,'responseTime':_0x4201e4,'data':_0x40a3fc});}[a48_0x22a8e9(0xe6)](_0xdb8003,_0x196056,_0x343fa9){const _0x8a969=a48_0x22a8e9;this[_0x8a969(0xae)]('white_domain_errors',{'type':'ERROR','gateway':_0xdb8003,'endpoint':_0x196056,'error':_0x343fa9 instanceof Error?{'message':_0x343fa9['message'],'stack':_0x343fa9['stack']}:_0x343fa9});}[a48_0x22a8e9(0xa9)](_0x18c71d,_0x2a3a48,_0x411ef4){const _0x1ad269=a48_0x22a8e9;this[_0x1ad269(0xae)]('webhooks_received',{'type':_0x1ad269(0xe7),'gateway':_0x18c71d,'headers':_0x411ef4,'data':_0x2a3a48});}[a48_0x22a8e9(0xc9)](_0x6a1ac7,_0x5a6c98,_0x427d6b,_0x2fed75,_0x402685){const _0x326a2e=a48_0x22a8e9;this[_0x326a2e(0xae)](_0x326a2e(0xb2),{'type':_0x326a2e(0xda),'gateway':_0x6a1ac7,'paymentId':_0x5a6c98,'oldStatus':_0x427d6b,'newStatus':_0x2fed75,'originalData':_0x402685});}[a48_0x22a8e9(0xd1)](_0x1f3e3d,_0x2c643b,_0x573e2a){const _0x9207b6=a48_0x22a8e9;this[_0x9207b6(0xae)]('webhooks_errors',{'type':_0x9207b6(0xd4),'gateway':_0x1f3e3d,'error':_0x2c643b instanceof Error?{'message':_0x2c643b['message'],'stack':_0x2c643b[_0x9207b6(0xd2)]}:_0x2c643b,'originalData':_0x573e2a});}['logCoinToPayStatus'](_0x5e1541){const _0x43c2d6=a48_0x22a8e9;this[_0x43c2d6(0xae)](_0x43c2d6(0xac),{'type':_0x43c2d6(0xcb),..._0x5e1541});}[a48_0x22a8e9(0xad)](_0x322fed){const _0x188902=a48_0x22a8e9;this[_0x188902(0xae)](_0x188902(0xbb),{'type':_0x188902(0xce),..._0x322fed});}[a48_0x22a8e9(0xa4)](_0x411dfd,_0x3f64c4,_0x502b05,_0x5e8234,_0x31ee0b,_0x118a18){const _0x496e19=a48_0x22a8e9;this[_0x496e19(0xae)](_0x496e19(0xe8),{'type':_0x496e19(0xe1),'shopId':_0x411dfd,'webhookUrl':_0x3f64c4,'event':_0x502b05,'status':_0x5e8234,'responseTime':_0x31ee0b,'payload':_0x118a18});}[a48_0x22a8e9(0xb4)](_0x3c8aec,_0x302b6a,_0x492648,_0x3a3ed9,_0x4f2deb){const _0x3963b5=a48_0x22a8e9;this[_0x3963b5(0xae)](_0x3963b5(0xb9),{'type':_0x3963b5(0xd7),'shopId':_0x3c8aec,'webhookUrl':_0x302b6a,'event':_0x492648,'error':_0x3a3ed9 instanceof Error?{'message':_0x3a3ed9[_0x3963b5(0xe0)],'stack':_0x3a3ed9[_0x3963b5(0xd2)]}:_0x3a3ed9,'payload':_0x4f2deb});}[a48_0x22a8e9(0xa6)](_0x2954a2,_0x2e4465,_0x3f9b3b,_0x180f57,_0x47a55c){const _0x5e486d=a48_0x22a8e9;this[_0x5e486d(0xae)](_0x5e486d(0xaa),{'type':'PAYMENT_CREATED','gateway':_0x2954a2,'paymentId':_0x2e4465,'shopId':_0x3f9b3b,'amount':_0x180f57,'currency':_0x47a55c});}['logApiCall'](_0x504159,_0x314427,_0x4ae7f3,_0x4a388b,_0x54738b){const _0x8f4a8e=a48_0x22a8e9;this[_0x8f4a8e(0xae)](_0x8f4a8e(0xc0),{'type':_0x8f4a8e(0x9a),'endpoint':_0x504159,'method':_0x314427,'userId':_0x4ae7f3,'userRole':_0x4a388b,'requestData':_0x54738b});}[a48_0x22a8e9(0xb8)](){const _0x33a835=a48_0x22a8e9;try{const _0x19c363=fs_1[_0x33a835(0xb6)][_0x33a835(0x9c)](this[_0x33a835(0xc8)]),_0x2abc7c=_0x19c363[_0x33a835(0xbc)](_0x8b41fc=>_0x8b41fc[_0x33a835(0xc2)](_0x33a835(0xcc))),_0x580704=[...new Set(_0x2abc7c[_0x33a835(0xd9)](_0x15995e=>_0x15995e['split']('_')[0x0]))],_0x33edc3=_0x2abc7c['map'](_0x32c5a7=>{const _0x2c8df5=_0x33a835,_0x586702=path_1['default'][_0x2c8df5(0xc3)](this[_0x2c8df5(0xc8)],_0x32c5a7),_0x240ba5=fs_1[_0x2c8df5(0xb6)][_0x2c8df5(0xb0)](_0x586702),[_0x7a948a,_0x1e6b93]=_0x32c5a7[_0x2c8df5(0x9e)](_0x2c8df5(0xcc),'')['split']('_');return{'type':_0x7a948a,'date':_0x1e6b93,'size':_0x240ba5['size']};})[_0x33a835(0xc1)]((_0x21d317,_0x26a097)=>_0x26a097[_0x33a835(0xb5)][_0x33a835(0xa1)](_0x21d317[_0x33a835(0xb5)]));return{'totalFiles':_0x2abc7c[_0x33a835(0xd6)],'logTypes':_0x580704,'latestLogs':_0x33edc3['slice'](0x0,0xa)};}catch(_0x1a38e5){return console[_0x33a835(0xe5)](_0x33a835(0xe3),_0x1a38e5),{'totalFiles':0x0,'logTypes':[],'latestLogs':[]};}}[a48_0x22a8e9(0xde)](_0x2787ba=0x1e){const _0x3c8e4a=a48_0x22a8e9;try{const _0x49dd5a=fs_1[_0x3c8e4a(0xb6)]['readdirSync'](this[_0x3c8e4a(0xc8)]),_0x9b8b18=new Date();_0x9b8b18[_0x3c8e4a(0xd8)](_0x9b8b18[_0x3c8e4a(0xc7)]()-_0x2787ba);let _0x2c03f5=0x0;_0x49dd5a['forEach'](_0x5ce8da=>{const _0x462720=_0x3c8e4a;if(!_0x5ce8da[_0x462720(0xc2)](_0x462720(0xcc)))return;const _0x489051=path_1['default']['join'](this[_0x462720(0xc8)],_0x5ce8da),_0x331895=fs_1[_0x462720(0xb6)][_0x462720(0xb0)](_0x489051);_0x331895['mtime']<_0x9b8b18&&(fs_1[_0x462720(0xb6)][_0x462720(0xcf)](_0x489051),_0x2c03f5++,console[_0x462720(0xcd)](_0x462720(0xa2)+_0x5ce8da));}),console['log']('🧹\x20Cleaned\x20'+_0x2c03f5+'\x20old\x20log\x20files\x20(older\x20than\x20'+_0x2787ba+_0x3c8e4a(0xd0));}catch(_0x76ea05){console[_0x3c8e4a(0xe5)]('Failed\x20to\x20clean\x20old\x20logs:',_0x76ea05);}}}function a48_0x16ee(){const _0x45f6a=['8ODIacI','appendFileSync','getDate','logsDir','logWebhookProcessed','35800WGmpNA','COINTOPAY_STATUS_CHANGE','.log','log','COINTOPAY_ERROR','unlinkSync','\x20days)','logWebhookError','stack','7206255fOkvqz','WEBHOOK_ERROR','getLogFileName','length','SHOP_WEBHOOK_ERROR','setDate','map','WEBHOOK_PROCESSED','white_domain_responses','LoggerService','loggerService','cleanOldLogs','593853tNLjie','message','SHOP_WEBHOOK_SENT','defineProperty','Failed\x20to\x20get\x20log\x20stats:','775722nFbHbc','error','logWhiteDomainError','WEBHOOK_RECEIVED','shop_webhooks_sent','943879NDUdpf','stringify','API_CALL','path','readdirSync','logs','replace','418pDEHoN','ensureLogsDirectory','localeCompare','🗑️\x20Deleted\x20old\x20log\x20file:\x20','__esModule','logShopWebhookSent','📁\x20Created\x20logs\x20directory:\x20','logPaymentCreated','toISOString','REQUEST','logWebhookReceived','payments_created','RESPONSE','cointopay_status_changes','logCoinToPayError','writeLog','60ISjavk','statSync','split','webhooks_processed','cwd','logShopWebhookError','date','default','3189708HGZnao','getLogStats','shop_webhooks_errors','1813mKolOe','cointopay_errors','filter','existsSync','716930ImgrTr','white_domain_requests','api_calls','sort','endsWith','join','Failed\x20to\x20write\x20'];a48_0x16ee=function(){return _0x45f6a;};return a48_0x16ee();}function a48_0x2f05(_0x442506,_0x1a8371){const _0x16eefb=a48_0x16ee();return a48_0x2f05=function(_0x2f053,_0x39c45b){_0x2f053=_0x2f053-0x9a;let _0xc82177=_0x16eefb[_0x2f053];return _0xc82177;},a48_0x2f05(_0x442506,_0x1a8371);}exports[a48_0x22a8e9(0xdc)]=LoggerService,exports[a48_0x22a8e9(0xdd)]=new LoggerService();