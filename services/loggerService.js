'use strict';const a48_0x4a2024=a48_0x119b;(function(_0x41b1ec,_0x9efef8){const _0x713a1a=a48_0x119b,_0x19934c=_0x41b1ec();while(!![]){try{const _0x35ec17=-parseInt(_0x713a1a(0x1c5))/0x1*(parseInt(_0x713a1a(0x1f6))/0x2)+parseInt(_0x713a1a(0x1f7))/0x3*(-parseInt(_0x713a1a(0x1e4))/0x4)+parseInt(_0x713a1a(0x1bb))/0x5*(-parseInt(_0x713a1a(0x1c3))/0x6)+-parseInt(_0x713a1a(0x1f3))/0x7+-parseInt(_0x713a1a(0x1d9))/0x8*(parseInt(_0x713a1a(0x1fd))/0x9)+parseInt(_0x713a1a(0x204))/0xa*(parseInt(_0x713a1a(0x1b5))/0xb)+parseInt(_0x713a1a(0x1f2))/0xc*(parseInt(_0x713a1a(0x1db))/0xd);if(_0x35ec17===_0x9efef8)break;else _0x19934c['push'](_0x19934c['shift']());}catch(_0x482360){_0x19934c['push'](_0x19934c['shift']());}}}(a48_0x508f,0x1e173));var __importDefault=this&&this[a48_0x4a2024(0x1f8)]||function(_0x4b08c0){const _0x33e13c=a48_0x4a2024;return _0x4b08c0&&_0x4b08c0[_0x33e13c(0x1b1)]?_0x4b08c0:{'default':_0x4b08c0};};function a48_0x119b(_0x541516,_0x3646c2){const _0x508fd7=a48_0x508f();return a48_0x119b=function(_0x119b47,_0x36769a){_0x119b47=_0x119b47-0x1b0;let _0x55726b=_0x508fd7[_0x119b47];return _0x55726b;},a48_0x119b(_0x541516,_0x3646c2);}Object[a48_0x4a2024(0x1be)](exports,a48_0x4a2024(0x1b1),{'value':!![]}),exports[a48_0x4a2024(0x1ff)]=exports[a48_0x4a2024(0x1b0)]=void 0x0;const fs_1=__importDefault(require('fs')),path_1=__importDefault(require('path'));function a48_0x508f(){const _0x4f6c2b=['1753910PAXION','message','endsWith','ERROR','LoggerService','__esModule','logWhiteDomainResponse','SHOP_WEBHOOK_SENT','default','11KPaXKr','stringify','\x20old\x20log\x20files\x20(older\x20than\x20','error','logWhiteDomainRequest','shop_webhooks_errors','10CYbCcv','logsDir','length','defineProperty','webhooks_processed','toISOString','logShopWebhookError','stack','115896hofhxk','api_calls','3kUvMpu','localeCompare','log','existsSync','COINTOPAY_ERROR','statSync','RESPONSE','Failed\x20to\x20clean\x20old\x20logs:','\x20log:','white_domain_responses','map','logWebhookReceived','logWebhookProcessed','cointopay_errors','webhooks_received','join','cointopay_status_changes','logApiCall','logs','REQUEST','1488rqytcJ','WEBHOOK_PROCESSED','26BzWhGg','Failed\x20to\x20write\x20','logCoinToPayError','getLogStats','replace','logWhiteDomainError','PAYMENT_CREATED','cleanOldLogs','utf8','500740HpIfiQ','mtime','ensureLogsDirectory','COINTOPAY_STATUS_CHANGE','\x20days)','split','appendFileSync','writeLog','.log','sort','readdirSync','logPaymentCreated','logShopWebhookSent','SHOP_WEBHOOK_ERROR','1172508KipaIE','83678RFAySO','date','filter','35582ubEVRa','3MiSasD','__importDefault','white_domain_requests','API_CALL','WEBHOOK_ERROR','size','891EMdIdi','forEach','loggerService','getLogFileName','🗑️\x20Deleted\x20old\x20log\x20file:\x20','getDate','slice'];a48_0x508f=function(){return _0x4f6c2b;};return a48_0x508f();}class LoggerService{constructor(){const _0x2e4f21=a48_0x4a2024;this[_0x2e4f21(0x1bc)]=path_1[_0x2e4f21(0x1b4)][_0x2e4f21(0x1d4)](process['cwd'](),_0x2e4f21(0x1d7)),this[_0x2e4f21(0x1e6)]();}[a48_0x4a2024(0x1e6)](){const _0x104736=a48_0x4a2024;!fs_1[_0x104736(0x1b4)][_0x104736(0x1c8)](this['logsDir'])&&(fs_1[_0x104736(0x1b4)]['mkdirSync'](this[_0x104736(0x1bc)],{'recursive':!![]}),console[_0x104736(0x1c7)]('📁\x20Created\x20logs\x20directory:\x20'+this[_0x104736(0x1bc)]));}[a48_0x4a2024(0x200)](_0x15c3bf){const _0x14ea9f=a48_0x4a2024,_0x457406=new Date()[_0x14ea9f(0x1c0)]()[_0x14ea9f(0x1e9)]('T')[0x0];return path_1[_0x14ea9f(0x1b4)]['join'](this[_0x14ea9f(0x1bc)],_0x15c3bf+'_'+_0x457406+_0x14ea9f(0x1ec));}[a48_0x4a2024(0x1eb)](_0x3d94d8,_0x181873){const _0x148f3e=a48_0x4a2024;try{const _0x3bbe4d=new Date()['toISOString'](),_0xa953ae={'timestamp':_0x3bbe4d,..._0x181873},_0x5e9a04=JSON[_0x148f3e(0x1b6)](_0xa953ae)+'\x0a',_0x14bf87=this[_0x148f3e(0x200)](_0x3d94d8);fs_1['default'][_0x148f3e(0x1ea)](_0x14bf87,_0x5e9a04,_0x148f3e(0x1e3));}catch(_0x446bdc){console[_0x148f3e(0x1b8)](_0x148f3e(0x1dc)+_0x3d94d8+_0x148f3e(0x1cd),_0x446bdc);}}[a48_0x4a2024(0x1b9)](_0x2ac842,_0x19f209,_0x27f736,_0x4c347b){const _0x46b48c=a48_0x4a2024;this['writeLog'](_0x46b48c(0x1f9),{'type':_0x46b48c(0x1d8),'gateway':_0x2ac842,'endpoint':_0x19f209,'method':_0x27f736,'data':_0x4c347b});}[a48_0x4a2024(0x1b2)](_0x34cf65,_0x597474,_0x4fe3d8,_0x4ae40e,_0x3ac69e){const _0x873c69=a48_0x4a2024;this[_0x873c69(0x1eb)](_0x873c69(0x1ce),{'type':_0x873c69(0x1cb),'gateway':_0x34cf65,'endpoint':_0x597474,'status':_0x4fe3d8,'responseTime':_0x3ac69e,'data':_0x4ae40e});}[a48_0x4a2024(0x1e0)](_0x3baad8,_0xbb0381,_0x141f79){const _0x1fa9d6=a48_0x4a2024;this[_0x1fa9d6(0x1eb)]('white_domain_errors',{'type':_0x1fa9d6(0x207),'gateway':_0x3baad8,'endpoint':_0xbb0381,'error':_0x141f79 instanceof Error?{'message':_0x141f79[_0x1fa9d6(0x205)],'stack':_0x141f79[_0x1fa9d6(0x1c2)]}:_0x141f79});}[a48_0x4a2024(0x1d0)](_0x3a73ec,_0x4e6e85,_0x3c1178){const _0x2c1ff9=a48_0x4a2024;this[_0x2c1ff9(0x1eb)](_0x2c1ff9(0x1d3),{'type':'WEBHOOK_RECEIVED','gateway':_0x3a73ec,'headers':_0x3c1178,'data':_0x4e6e85});}[a48_0x4a2024(0x1d1)](_0x3665d4,_0x80db6,_0x41b607,_0xb53656,_0x86f2da){const _0x456ad3=a48_0x4a2024;this[_0x456ad3(0x1eb)](_0x456ad3(0x1bf),{'type':_0x456ad3(0x1da),'gateway':_0x3665d4,'paymentId':_0x80db6,'oldStatus':_0x41b607,'newStatus':_0xb53656,'originalData':_0x86f2da});}['logWebhookError'](_0x3e1b9c,_0x3f59dc,_0x44d4e5){const _0x5be4d=a48_0x4a2024;this[_0x5be4d(0x1eb)]('webhooks_errors',{'type':_0x5be4d(0x1fb),'gateway':_0x3e1b9c,'error':_0x3f59dc instanceof Error?{'message':_0x3f59dc[_0x5be4d(0x205)],'stack':_0x3f59dc[_0x5be4d(0x1c2)]}:_0x3f59dc,'originalData':_0x44d4e5});}['logCoinToPayStatus'](_0x22e645){const _0x54918b=a48_0x4a2024;this[_0x54918b(0x1eb)](_0x54918b(0x1d5),{'type':_0x54918b(0x1e7),..._0x22e645});}[a48_0x4a2024(0x1dd)](_0x447e12){const _0x3c8f35=a48_0x4a2024;this['writeLog'](_0x3c8f35(0x1d2),{'type':_0x3c8f35(0x1c9),..._0x447e12});}[a48_0x4a2024(0x1f0)](_0x362e0a,_0x533c76,_0x36cc34,_0x740344,_0x23860f,_0x33eaac){const _0xfc46ee=a48_0x4a2024;this[_0xfc46ee(0x1eb)]('shop_webhooks_sent',{'type':_0xfc46ee(0x1b3),'shopId':_0x362e0a,'webhookUrl':_0x533c76,'event':_0x36cc34,'status':_0x740344,'responseTime':_0x23860f,'payload':_0x33eaac});}[a48_0x4a2024(0x1c1)](_0x5b8fd9,_0x47f414,_0x1e8f8c,_0x244a7e,_0x270733){const _0x336e5c=a48_0x4a2024;this['writeLog'](_0x336e5c(0x1ba),{'type':_0x336e5c(0x1f1),'shopId':_0x5b8fd9,'webhookUrl':_0x47f414,'event':_0x1e8f8c,'error':_0x244a7e instanceof Error?{'message':_0x244a7e['message'],'stack':_0x244a7e[_0x336e5c(0x1c2)]}:_0x244a7e,'payload':_0x270733});}[a48_0x4a2024(0x1ef)](_0x7839a0,_0x2ecfc8,_0x239887,_0x3937dc,_0x25b84d){const _0x2cde4f=a48_0x4a2024;this[_0x2cde4f(0x1eb)]('payments_created',{'type':_0x2cde4f(0x1e1),'gateway':_0x7839a0,'paymentId':_0x2ecfc8,'shopId':_0x239887,'amount':_0x3937dc,'currency':_0x25b84d});}[a48_0x4a2024(0x1d6)](_0x5015cd,_0x42f998,_0x5b1a9d,_0x5a37f0,_0x1fda2d){const _0x3944cb=a48_0x4a2024;this[_0x3944cb(0x1eb)](_0x3944cb(0x1c4),{'type':_0x3944cb(0x1fa),'endpoint':_0x5015cd,'method':_0x42f998,'userId':_0x5b1a9d,'userRole':_0x5a37f0,'requestData':_0x1fda2d});}[a48_0x4a2024(0x1de)](){const _0x436f9c=a48_0x4a2024;try{const _0x4f9a17=fs_1['default'][_0x436f9c(0x1ee)](this[_0x436f9c(0x1bc)]),_0x6309d9=_0x4f9a17[_0x436f9c(0x1f5)](_0x40ad9f=>_0x40ad9f[_0x436f9c(0x206)](_0x436f9c(0x1ec))),_0x28ea73=[...new Set(_0x6309d9['map'](_0x367a06=>_0x367a06[_0x436f9c(0x1e9)]('_')[0x0]))],_0xbe4039=_0x6309d9[_0x436f9c(0x1cf)](_0x237624=>{const _0x3a7cb9=_0x436f9c,_0x535f0b=path_1['default']['join'](this['logsDir'],_0x237624),_0x2d6fc9=fs_1[_0x3a7cb9(0x1b4)][_0x3a7cb9(0x1ca)](_0x535f0b),[_0x3cbd34,_0x2150f4]=_0x237624[_0x3a7cb9(0x1df)](_0x3a7cb9(0x1ec),'')[_0x3a7cb9(0x1e9)]('_');return{'type':_0x3cbd34,'date':_0x2150f4,'size':_0x2d6fc9[_0x3a7cb9(0x1fc)]};})[_0x436f9c(0x1ed)]((_0x2f59ef,_0x223f2f)=>_0x223f2f[_0x436f9c(0x1f4)][_0x436f9c(0x1c6)](_0x2f59ef[_0x436f9c(0x1f4)]));return{'totalFiles':_0x6309d9[_0x436f9c(0x1bd)],'logTypes':_0x28ea73,'latestLogs':_0xbe4039[_0x436f9c(0x203)](0x0,0xa)};}catch(_0x26e87d){return console['error']('Failed\x20to\x20get\x20log\x20stats:',_0x26e87d),{'totalFiles':0x0,'logTypes':[],'latestLogs':[]};}}[a48_0x4a2024(0x1e2)](_0x3e7a89=0x1e){const _0x3ee8c6=a48_0x4a2024;try{const _0x5062c2=fs_1[_0x3ee8c6(0x1b4)][_0x3ee8c6(0x1ee)](this[_0x3ee8c6(0x1bc)]),_0x2b1378=new Date();_0x2b1378['setDate'](_0x2b1378[_0x3ee8c6(0x202)]()-_0x3e7a89);let _0x5be74e=0x0;_0x5062c2[_0x3ee8c6(0x1fe)](_0x1136f4=>{const _0x10627f=_0x3ee8c6;if(!_0x1136f4[_0x10627f(0x206)](_0x10627f(0x1ec)))return;const _0x409563=path_1['default'][_0x10627f(0x1d4)](this['logsDir'],_0x1136f4),_0x4657a4=fs_1[_0x10627f(0x1b4)][_0x10627f(0x1ca)](_0x409563);_0x4657a4[_0x10627f(0x1e5)]<_0x2b1378&&(fs_1['default']['unlinkSync'](_0x409563),_0x5be74e++,console[_0x10627f(0x1c7)](_0x10627f(0x201)+_0x1136f4));}),console['log']('🧹\x20Cleaned\x20'+_0x5be74e+_0x3ee8c6(0x1b7)+_0x3e7a89+_0x3ee8c6(0x1e8));}catch(_0x5bf6a1){console['error'](_0x3ee8c6(0x1cc),_0x5bf6a1);}}}exports[a48_0x4a2024(0x1b0)]=LoggerService,exports[a48_0x4a2024(0x1ff)]=new LoggerService();