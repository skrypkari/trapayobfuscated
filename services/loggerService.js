'use strict';const a44_0x34eeaa=a44_0x41a3;(function(_0x11ccbc,_0x51a1ea){const _0x4158cc=a44_0x41a3,_0xfd3938=_0x11ccbc();while(!![]){try{const _0x8c154f=parseInt(_0x4158cc(0x123))/0x1*(-parseInt(_0x4158cc(0x132))/0x2)+parseInt(_0x4158cc(0x143))/0x3*(parseInt(_0x4158cc(0x12a))/0x4)+-parseInt(_0x4158cc(0x122))/0x5+-parseInt(_0x4158cc(0x129))/0x6+-parseInt(_0x4158cc(0x117))/0x7+parseInt(_0x4158cc(0x124))/0x8+parseInt(_0x4158cc(0x12c))/0x9;if(_0x8c154f===_0x51a1ea)break;else _0xfd3938['push'](_0xfd3938['shift']());}catch(_0x385019){_0xfd3938['push'](_0xfd3938['shift']());}}}(a44_0x5336,0xe5dbf));var __importDefault=this&&this['__importDefault']||function(_0x2a5aab){const _0x1f6ad3=a44_0x41a3;return _0x2a5aab&&_0x2a5aab[_0x1f6ad3(0x141)]?_0x2a5aab:{'default':_0x2a5aab};};Object['defineProperty'](exports,a44_0x34eeaa(0x141),{'value':!![]}),exports['loggerService']=exports['LoggerService']=void 0x0;const fs_1=__importDefault(require('fs')),path_1=__importDefault(require(a44_0x34eeaa(0x144)));function a44_0x41a3(_0x45b931,_0x336dd1){const _0x5336b1=a44_0x5336();return a44_0x41a3=function(_0x41a3de,_0x87ce15){_0x41a3de=_0x41a3de-0x100;let _0x4f1ea7=_0x5336b1[_0x41a3de];return _0x4f1ea7;},a44_0x41a3(_0x45b931,_0x336dd1);}class LoggerService{constructor(){const _0x44e20=a44_0x34eeaa;this[_0x44e20(0x127)]=path_1[_0x44e20(0x134)][_0x44e20(0x109)](process[_0x44e20(0x14b)](),'logs'),this[_0x44e20(0x13c)]();}['ensureLogsDirectory'](){const _0x1d474f=a44_0x34eeaa;!fs_1[_0x1d474f(0x134)][_0x1d474f(0x14f)](this[_0x1d474f(0x127)])&&(fs_1[_0x1d474f(0x134)][_0x1d474f(0x149)](this[_0x1d474f(0x127)],{'recursive':!![]}),console[_0x1d474f(0x139)](_0x1d474f(0x138)+this[_0x1d474f(0x127)]));}['getLogFileName'](_0x3b9bbf){const _0x4ee5f1=a44_0x34eeaa,_0x44f75b=new Date()[_0x4ee5f1(0x146)]()['split']('T')[0x0];return path_1[_0x4ee5f1(0x134)][_0x4ee5f1(0x109)](this['logsDir'],_0x3b9bbf+'_'+_0x44f75b+_0x4ee5f1(0x128));}[a44_0x34eeaa(0x103)](_0x24bc86,_0x4f9b9c){const _0x4bb33b=a44_0x34eeaa;try{const _0x33cdb7=new Date()['toISOString'](),_0x4c7b55={'timestamp':_0x33cdb7,..._0x4f9b9c},_0xaac454=JSON[_0x4bb33b(0x11a)](_0x4c7b55)+'\x0a',_0x1191f9=this[_0x4bb33b(0x130)](_0x24bc86);fs_1[_0x4bb33b(0x134)]['appendFileSync'](_0x1191f9,_0xaac454,'utf8');}catch(_0x30e525){console[_0x4bb33b(0x14c)](_0x4bb33b(0x11b)+_0x24bc86+_0x4bb33b(0x150),_0x30e525);}}[a44_0x34eeaa(0x115)](_0x4a1b68,_0xb6fd2b,_0x1168d3,_0x3cfe84){const _0x100165=a44_0x34eeaa;this['writeLog']('white_domain_requests',{'type':_0x100165(0x118),'gateway':_0x4a1b68,'endpoint':_0xb6fd2b,'method':_0x1168d3,'data':_0x3cfe84});}[a44_0x34eeaa(0x110)](_0x2814f5,_0x23aa07,_0x11795f,_0x10a9ad,_0x1e2dca){const _0x56fed4=a44_0x34eeaa;this[_0x56fed4(0x103)](_0x56fed4(0x13b),{'type':_0x56fed4(0x12b),'gateway':_0x2814f5,'endpoint':_0x23aa07,'status':_0x11795f,'responseTime':_0x1e2dca,'data':_0x10a9ad});}[a44_0x34eeaa(0x112)](_0x89cdd8,_0x693868,_0x56f734){const _0x1182ba=a44_0x34eeaa;this[_0x1182ba(0x103)]('white_domain_errors',{'type':'ERROR','gateway':_0x89cdd8,'endpoint':_0x693868,'error':_0x56f734 instanceof Error?{'message':_0x56f734['message'],'stack':_0x56f734[_0x1182ba(0x10d)]}:_0x56f734});}['logWebhookReceived'](_0x5410ce,_0xa7016c,_0x115f48){const _0x33940d=a44_0x34eeaa;this['writeLog'](_0x33940d(0x120),{'type':'WEBHOOK_RECEIVED','gateway':_0x5410ce,'headers':_0x115f48,'data':_0xa7016c});}['logWebhookProcessed'](_0x4166ef,_0x584d2a,_0x306a6e,_0x52a04a,_0x960074){const _0x2c70ac=a44_0x34eeaa;this[_0x2c70ac(0x103)](_0x2c70ac(0x106),{'type':_0x2c70ac(0x11c),'gateway':_0x4166ef,'paymentId':_0x584d2a,'oldStatus':_0x306a6e,'newStatus':_0x52a04a,'originalData':_0x960074});}[a44_0x34eeaa(0x136)](_0x51b832,_0x43025b,_0x1c0686){const _0x1cfdfe=a44_0x34eeaa;this[_0x1cfdfe(0x103)](_0x1cfdfe(0x108),{'type':'WEBHOOK_ERROR','gateway':_0x51b832,'error':_0x43025b instanceof Error?{'message':_0x43025b[_0x1cfdfe(0x111)],'stack':_0x43025b[_0x1cfdfe(0x10d)]}:_0x43025b,'originalData':_0x1c0686});}[a44_0x34eeaa(0x11f)](_0x3690e1){const _0x4b1c4d=a44_0x34eeaa;this['writeLog'](_0x4b1c4d(0x151),{'type':'COINTOPAY_STATUS_CHANGE',..._0x3690e1});}[a44_0x34eeaa(0x11e)](_0x354857){const _0x98ecf3=a44_0x34eeaa;this['writeLog'](_0x98ecf3(0x147),{'type':_0x98ecf3(0x145),..._0x354857});}[a44_0x34eeaa(0x125)](_0x58b7fd,_0x36f057,_0x499e3f,_0x20d688,_0xedc1ff,_0x51bcbe){const _0x1b663b=a44_0x34eeaa;this[_0x1b663b(0x103)](_0x1b663b(0x113),{'type':'SHOP_WEBHOOK_SENT','shopId':_0x58b7fd,'webhookUrl':_0x36f057,'event':_0x499e3f,'status':_0x20d688,'responseTime':_0xedc1ff,'payload':_0x51bcbe});}[a44_0x34eeaa(0x104)](_0x4d38e7,_0x278861,_0x169816,_0x15e843,_0xeca32e){const _0x1adf12=a44_0x34eeaa;this[_0x1adf12(0x103)]('shop_webhooks_errors',{'type':_0x1adf12(0x126),'shopId':_0x4d38e7,'webhookUrl':_0x278861,'event':_0x169816,'error':_0x15e843 instanceof Error?{'message':_0x15e843[_0x1adf12(0x111)],'stack':_0x15e843['stack']}:_0x15e843,'payload':_0xeca32e});}[a44_0x34eeaa(0x13e)](_0x22bc65,_0x236d61,_0x5cf108,_0x4bd3ba,_0x470292){const _0x3ed674=a44_0x34eeaa;this[_0x3ed674(0x103)](_0x3ed674(0x12f),{'type':_0x3ed674(0x13d),'gateway':_0x22bc65,'paymentId':_0x236d61,'shopId':_0x5cf108,'amount':_0x4bd3ba,'currency':_0x470292});}[a44_0x34eeaa(0x14a)](_0x221d52,_0x1dc075,_0x14287f,_0x2cbee8,_0xd291ac){const _0x492c73=a44_0x34eeaa;this[_0x492c73(0x103)](_0x492c73(0x116),{'type':_0x492c73(0x148),'endpoint':_0x221d52,'method':_0x1dc075,'userId':_0x14287f,'userRole':_0x2cbee8,'requestData':_0xd291ac});}[a44_0x34eeaa(0x10a)](){const _0x56690b=a44_0x34eeaa;try{const _0x440e7e=fs_1['default'][_0x56690b(0x100)](this[_0x56690b(0x127)]),_0x45c727=_0x440e7e[_0x56690b(0x10b)](_0x295828=>_0x295828[_0x56690b(0x10e)](_0x56690b(0x128))),_0x20b7af=[...new Set(_0x45c727[_0x56690b(0x119)](_0x5477e9=>_0x5477e9['split']('_')[0x0]))],_0x32cbb6=_0x45c727[_0x56690b(0x119)](_0x5836f1=>{const _0xc5e32c=_0x56690b,_0x3e0ca1=path_1[_0xc5e32c(0x134)][_0xc5e32c(0x109)](this[_0xc5e32c(0x127)],_0x5836f1),_0x456c24=fs_1[_0xc5e32c(0x134)][_0xc5e32c(0x142)](_0x3e0ca1),[_0x49e77d,_0xf9ae53]=_0x5836f1[_0xc5e32c(0x107)](_0xc5e32c(0x128),'')[_0xc5e32c(0x11d)]('_');return{'type':_0x49e77d,'date':_0xf9ae53,'size':_0x456c24[_0xc5e32c(0x13f)]};})[_0x56690b(0x105)]((_0x4424b7,_0x2f0103)=>_0x2f0103[_0x56690b(0x133)][_0x56690b(0x12e)](_0x4424b7[_0x56690b(0x133)]));return{'totalFiles':_0x45c727[_0x56690b(0x12d)],'logTypes':_0x20b7af,'latestLogs':_0x32cbb6[_0x56690b(0x101)](0x0,0xa)};}catch(_0x4c1df0){return console[_0x56690b(0x14c)](_0x56690b(0x121),_0x4c1df0),{'totalFiles':0x0,'logTypes':[],'latestLogs':[]};}}[a44_0x34eeaa(0x10c)](_0x10fd08=0x1e){const _0x55219b=a44_0x34eeaa;try{const _0x3cb2d4=fs_1['default'][_0x55219b(0x100)](this[_0x55219b(0x127)]),_0x48d2a0=new Date();_0x48d2a0[_0x55219b(0x137)](_0x48d2a0[_0x55219b(0x114)]()-_0x10fd08);let _0x1a7af6=0x0;_0x3cb2d4[_0x55219b(0x140)](_0x5f2f1f=>{const _0x576430=_0x55219b;if(!_0x5f2f1f[_0x576430(0x10e)](_0x576430(0x128)))return;const _0x399eb5=path_1['default'][_0x576430(0x109)](this[_0x576430(0x127)],_0x5f2f1f),_0x3b646f=fs_1[_0x576430(0x134)][_0x576430(0x142)](_0x399eb5);_0x3b646f[_0x576430(0x102)]<_0x48d2a0&&(fs_1['default']['unlinkSync'](_0x399eb5),_0x1a7af6++,console[_0x576430(0x139)](_0x576430(0x14d)+_0x5f2f1f));}),console[_0x55219b(0x139)](_0x55219b(0x135)+_0x1a7af6+_0x55219b(0x10f)+_0x10fd08+'\x20days)');}catch(_0x1caaa9){console[_0x55219b(0x14c)](_0x55219b(0x13a),_0x1caaa9);}}}exports[a44_0x34eeaa(0x14e)]=LoggerService,exports[a44_0x34eeaa(0x131)]=new LoggerService();function a44_0x5336(){const _0x37072d=['stack','endsWith','\x20old\x20log\x20files\x20(older\x20than\x20','logWhiteDomainResponse','message','logWhiteDomainError','shop_webhooks_sent','getDate','logWhiteDomainRequest','api_calls','13033832xVWYnl','REQUEST','map','stringify','Failed\x20to\x20write\x20','WEBHOOK_PROCESSED','split','logCoinToPayError','logCoinToPayStatus','webhooks_received','Failed\x20to\x20get\x20log\x20stats:','1427200lPGDsw','207tmFUmO','12964184SCWbmF','logShopWebhookSent','SHOP_WEBHOOK_ERROR','logsDir','.log','139026lWrZpy','940412mrsVKU','RESPONSE','12531087CTAyUJ','length','localeCompare','payments_created','getLogFileName','loggerService','14942INQqPX','date','default','ğŸ§¹\x20Cleaned\x20','logWebhookError','setDate','ğŸ“\x20Created\x20logs\x20directory:\x20','log','Failed\x20to\x20clean\x20old\x20logs:','white_domain_responses','ensureLogsDirectory','PAYMENT_CREATED','logPaymentCreated','size','forEach','__esModule','statSync','21wOGwfg','path','COINTOPAY_ERROR','toISOString','cointopay_errors','API_CALL','mkdirSync','logApiCall','cwd','error','ğŸ—‘ï¸\x20Deleted\x20old\x20log\x20file:\x20','LoggerService','existsSync','\x20log:','cointopay_status_changes','readdirSync','slice','mtime','writeLog','logShopWebhookError','sort','webhooks_processed','replace','webhooks_errors','join','getLogStats','filter','cleanOldLogs'];a44_0x5336=function(){return _0x37072d;};return a44_0x5336();}