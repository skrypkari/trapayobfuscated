'use strict';function a44_0x500c(){const _0x265f0e=['length','webhooks_received','1255292BmdauW','Failed\x20to\x20get\x20log\x20stats:','🗑️\x20Deleted\x20old\x20log\x20file:\x20','logShopWebhookSent','white_domain_errors','1011585bAKGvm','5451649vZdsQp','SHOP_WEBHOOK_ERROR','writeLog','setDate','log','RESPONSE','7036408zHeVTf','logApiCall','508kbceIi','3502638iNebsF','logs','cwd','\x20old\x20log\x20files\x20(older\x20than\x20','getLogFileName','__esModule','ensureLogsDirectory','map','logPaymentCreated','slice','utf8','WEBHOOK_ERROR','error','ERROR','localeCompare','📁\x20Created\x20logs\x20directory:\x20','toISOString','split','shop_webhooks_sent','logShopWebhookError','date','replace','join','white_domain_requests','1pIUhdZ','458883YZJjTA','170LFmORU','webhooks_errors','api_calls','LoggerService','PAYMENT_CREATED','appendFileSync','SHOP_WEBHOOK_SENT','WEBHOOK_RECEIVED','API_CALL','size','endsWith','logWebhookProcessed','webhooks_processed','default','17335Cyjsyj','cleanOldLogs','payments_created','WEBHOOK_PROCESSED','readdirSync','logWhiteDomainError','sort','getLogStats','logsDir','statSync','stack','🧹\x20Cleaned\x20','.log','path'];a44_0x500c=function(){return _0x265f0e;};return a44_0x500c();}function a44_0x10b0(_0x4b3221,_0x4f28af){const _0x500c7c=a44_0x500c();return a44_0x10b0=function(_0x10b0ec,_0xe8ddfa){_0x10b0ec=_0x10b0ec-0x111;let _0x35d0ae=_0x500c7c[_0x10b0ec];return _0x35d0ae;},a44_0x10b0(_0x4b3221,_0x4f28af);}const a44_0x2fb329=a44_0x10b0;(function(_0x4bd9b7,_0x36a3ed){const _0x355e54=a44_0x10b0,_0x4a06cd=_0x4bd9b7();while(!![]){try{const _0x4846a6=-parseInt(_0x355e54(0x111))/0x1*(parseInt(_0x355e54(0x131))/0x2)+-parseInt(_0x355e54(0x136))/0x3+parseInt(_0x355e54(0x13f))/0x4*(-parseInt(_0x355e54(0x121))/0x5)+-parseInt(_0x355e54(0x140))/0x6+parseInt(_0x355e54(0x137))/0x7+parseInt(_0x355e54(0x13d))/0x8+parseInt(_0x355e54(0x112))/0x9*(parseInt(_0x355e54(0x113))/0xa);if(_0x4846a6===_0x36a3ed)break;else _0x4a06cd['push'](_0x4a06cd['shift']());}catch(_0x545ec1){_0x4a06cd['push'](_0x4a06cd['shift']());}}}(a44_0x500c,0x82e96));var __importDefault=this&&this['__importDefault']||function(_0x5cd43c){const _0x242f39=a44_0x10b0;return _0x5cd43c&&_0x5cd43c[_0x242f39(0x145)]?_0x5cd43c:{'default':_0x5cd43c};};Object['defineProperty'](exports,a44_0x2fb329(0x145),{'value':!![]}),exports['loggerService']=exports[a44_0x2fb329(0x116)]=void 0x0;const fs_1=__importDefault(require('fs')),path_1=__importDefault(require(a44_0x2fb329(0x12e)));class LoggerService{constructor(){const _0xfe4fe9=a44_0x2fb329;this[_0xfe4fe9(0x129)]=path_1[_0xfe4fe9(0x120)][_0xfe4fe9(0x156)](process[_0xfe4fe9(0x142)](),_0xfe4fe9(0x141)),this[_0xfe4fe9(0x146)]();}[a44_0x2fb329(0x146)](){const _0x26dc1b=a44_0x2fb329;!fs_1[_0x26dc1b(0x120)]['existsSync'](this[_0x26dc1b(0x129)])&&(fs_1['default']['mkdirSync'](this[_0x26dc1b(0x129)],{'recursive':!![]}),console[_0x26dc1b(0x13b)](_0x26dc1b(0x14f)+this[_0x26dc1b(0x129)]));}[a44_0x2fb329(0x144)](_0x34a8b4){const _0xba4060=a44_0x2fb329,_0x2b27ae=new Date()[_0xba4060(0x150)]()['split']('T')[0x0];return path_1[_0xba4060(0x120)][_0xba4060(0x156)](this[_0xba4060(0x129)],_0x34a8b4+'_'+_0x2b27ae+_0xba4060(0x12d));}['writeLog'](_0x28d12d,_0x9d6d81){const _0x210676=a44_0x2fb329;try{const _0x59cd84=new Date()[_0x210676(0x150)](),_0x2e8a60={'timestamp':_0x59cd84,..._0x9d6d81},_0x69878=JSON['stringify'](_0x2e8a60)+'\x0a',_0x2d0ea8=this[_0x210676(0x144)](_0x28d12d);fs_1[_0x210676(0x120)][_0x210676(0x118)](_0x2d0ea8,_0x69878,_0x210676(0x14a));}catch(_0xeb81c4){console[_0x210676(0x14c)]('Failed\x20to\x20write\x20'+_0x28d12d+'\x20log:',_0xeb81c4);}}['logWhiteDomainRequest'](_0x4f356a,_0x223b53,_0x59566c,_0x80e89b){const _0x39e111=a44_0x2fb329;this[_0x39e111(0x139)](_0x39e111(0x157),{'type':'REQUEST','gateway':_0x4f356a,'endpoint':_0x223b53,'method':_0x59566c,'data':_0x80e89b});}['logWhiteDomainResponse'](_0x29cd20,_0xf72603,_0x5929a5,_0x358c54,_0x16365a){const _0x4be007=a44_0x2fb329;this['writeLog']('white_domain_responses',{'type':_0x4be007(0x13c),'gateway':_0x29cd20,'endpoint':_0xf72603,'status':_0x5929a5,'responseTime':_0x16365a,'data':_0x358c54});}[a44_0x2fb329(0x126)](_0x57b223,_0x5b57cb,_0x2afd2a){const _0x314c12=a44_0x2fb329;this[_0x314c12(0x139)](_0x314c12(0x135),{'type':_0x314c12(0x14d),'gateway':_0x57b223,'endpoint':_0x5b57cb,'error':_0x2afd2a instanceof Error?{'message':_0x2afd2a['message'],'stack':_0x2afd2a[_0x314c12(0x12b)]}:_0x2afd2a});}['logWebhookReceived'](_0x300087,_0x3ce8e2,_0xf8c1c8){const _0x53540c=a44_0x2fb329;this[_0x53540c(0x139)](_0x53540c(0x130),{'type':_0x53540c(0x11a),'gateway':_0x300087,'headers':_0xf8c1c8,'data':_0x3ce8e2});}[a44_0x2fb329(0x11e)](_0x2ef157,_0x225d2c,_0x4b6622,_0xbe1c26,_0x5875e2){const _0x46fa1e=a44_0x2fb329;this['writeLog'](_0x46fa1e(0x11f),{'type':_0x46fa1e(0x124),'gateway':_0x2ef157,'paymentId':_0x225d2c,'oldStatus':_0x4b6622,'newStatus':_0xbe1c26,'originalData':_0x5875e2});}['logWebhookError'](_0x4adf3c,_0xdc95a6,_0x245987){const _0x4e63eb=a44_0x2fb329;this['writeLog'](_0x4e63eb(0x114),{'type':_0x4e63eb(0x14b),'gateway':_0x4adf3c,'error':_0xdc95a6 instanceof Error?{'message':_0xdc95a6['message'],'stack':_0xdc95a6[_0x4e63eb(0x12b)]}:_0xdc95a6,'originalData':_0x245987});}[a44_0x2fb329(0x134)](_0x56c13a,_0x419776,_0x3020a4,_0x56df2b,_0x469046,_0x5e8a3e){const _0x7bd441=a44_0x2fb329;this['writeLog'](_0x7bd441(0x152),{'type':_0x7bd441(0x119),'shopId':_0x56c13a,'webhookUrl':_0x419776,'event':_0x3020a4,'status':_0x56df2b,'responseTime':_0x469046,'payload':_0x5e8a3e});}[a44_0x2fb329(0x153)](_0x367bf9,_0xbbbbb,_0x4bf5e1,_0xf17ba8,_0x265407){const _0x44599c=a44_0x2fb329;this[_0x44599c(0x139)]('shop_webhooks_errors',{'type':_0x44599c(0x138),'shopId':_0x367bf9,'webhookUrl':_0xbbbbb,'event':_0x4bf5e1,'error':_0xf17ba8 instanceof Error?{'message':_0xf17ba8['message'],'stack':_0xf17ba8[_0x44599c(0x12b)]}:_0xf17ba8,'payload':_0x265407});}[a44_0x2fb329(0x148)](_0x5bff76,_0x496ff5,_0x55a808,_0x3143c5,_0x2878a9){const _0x3fdd03=a44_0x2fb329;this['writeLog'](_0x3fdd03(0x123),{'type':_0x3fdd03(0x117),'gateway':_0x5bff76,'paymentId':_0x496ff5,'shopId':_0x55a808,'amount':_0x3143c5,'currency':_0x2878a9});}[a44_0x2fb329(0x13e)](_0x57f867,_0x3c4742,_0x263531,_0x423eb3,_0x343b74){const _0x3341f9=a44_0x2fb329;this[_0x3341f9(0x139)](_0x3341f9(0x115),{'type':_0x3341f9(0x11b),'endpoint':_0x57f867,'method':_0x3c4742,'userId':_0x263531,'userRole':_0x423eb3,'requestData':_0x343b74});}[a44_0x2fb329(0x128)](){const _0x4791d2=a44_0x2fb329;try{const _0x374f7f=fs_1[_0x4791d2(0x120)]['readdirSync'](this[_0x4791d2(0x129)]),_0x1486b9=_0x374f7f['filter'](_0x836de4=>_0x836de4[_0x4791d2(0x11d)](_0x4791d2(0x12d))),_0x58a540=[...new Set(_0x1486b9['map'](_0x49ad07=>_0x49ad07[_0x4791d2(0x151)]('_')[0x0]))],_0x4ca917=_0x1486b9[_0x4791d2(0x147)](_0x30230b=>{const _0x507f8e=_0x4791d2,_0x170c71=path_1[_0x507f8e(0x120)][_0x507f8e(0x156)](this[_0x507f8e(0x129)],_0x30230b),_0x5b3b94=fs_1[_0x507f8e(0x120)][_0x507f8e(0x12a)](_0x170c71),[_0x509c12,_0x1e54c2]=_0x30230b[_0x507f8e(0x155)]('.log','')[_0x507f8e(0x151)]('_');return{'type':_0x509c12,'date':_0x1e54c2,'size':_0x5b3b94[_0x507f8e(0x11c)]};})[_0x4791d2(0x127)]((_0x2c466d,_0x37be81)=>_0x37be81[_0x4791d2(0x154)][_0x4791d2(0x14e)](_0x2c466d[_0x4791d2(0x154)]));return{'totalFiles':_0x1486b9[_0x4791d2(0x12f)],'logTypes':_0x58a540,'latestLogs':_0x4ca917[_0x4791d2(0x149)](0x0,0xa)};}catch(_0xe0af87){return console[_0x4791d2(0x14c)](_0x4791d2(0x132),_0xe0af87),{'totalFiles':0x0,'logTypes':[],'latestLogs':[]};}}[a44_0x2fb329(0x122)](_0x9ea258=0x1e){const _0x3f123f=a44_0x2fb329;try{const _0x51b31c=fs_1[_0x3f123f(0x120)][_0x3f123f(0x125)](this['logsDir']),_0x3be5ce=new Date();_0x3be5ce[_0x3f123f(0x13a)](_0x3be5ce['getDate']()-_0x9ea258);let _0x5a18cd=0x0;_0x51b31c['forEach'](_0x1c9694=>{const _0x6a22a1=_0x3f123f;if(!_0x1c9694[_0x6a22a1(0x11d)](_0x6a22a1(0x12d)))return;const _0x484123=path_1[_0x6a22a1(0x120)]['join'](this[_0x6a22a1(0x129)],_0x1c9694),_0x3e476d=fs_1[_0x6a22a1(0x120)][_0x6a22a1(0x12a)](_0x484123);_0x3e476d['mtime']<_0x3be5ce&&(fs_1[_0x6a22a1(0x120)]['unlinkSync'](_0x484123),_0x5a18cd++,console[_0x6a22a1(0x13b)](_0x6a22a1(0x133)+_0x1c9694));}),console['log'](_0x3f123f(0x12c)+_0x5a18cd+_0x3f123f(0x143)+_0x9ea258+'\x20days)');}catch(_0x21e8c5){console[_0x3f123f(0x14c)]('Failed\x20to\x20clean\x20old\x20logs:',_0x21e8c5);}}}exports[a44_0x2fb329(0x116)]=LoggerService,exports['loggerService']=new LoggerService();