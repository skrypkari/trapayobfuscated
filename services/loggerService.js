'use strict';const a44_0x258971=a44_0x406f;(function(_0x37ad1c,_0x110165){const _0x391a67=a44_0x406f,_0x30aa06=_0x37ad1c();while(!![]){try{const _0x24b9f3=parseInt(_0x391a67(0x71))/0x1+parseInt(_0x391a67(0x8f))/0x2*(parseInt(_0x391a67(0x90))/0x3)+-parseInt(_0x391a67(0x9a))/0x4*(parseInt(_0x391a67(0x76))/0x5)+parseInt(_0x391a67(0x6f))/0x6+parseInt(_0x391a67(0x8a))/0x7+-parseInt(_0x391a67(0x6c))/0x8*(-parseInt(_0x391a67(0xae))/0x9)+-parseInt(_0x391a67(0x6a))/0xa;if(_0x24b9f3===_0x110165)break;else _0x30aa06['push'](_0x30aa06['shift']());}catch(_0x3866bc){_0x30aa06['push'](_0x30aa06['shift']());}}}(a44_0x44c8,0x390fb));function a44_0x406f(_0x4fb215,_0x18df96){const _0x44c8ad=a44_0x44c8();return a44_0x406f=function(_0x406f0f,_0x3fa0bb){_0x406f0f=_0x406f0f-0x6a;let _0x21bfe4=_0x44c8ad[_0x406f0f];return _0x21bfe4;},a44_0x406f(_0x4fb215,_0x18df96);}function a44_0x44c8(){const _0x4fbf3b=['__esModule','WEBHOOK_RECEIVED','\x20old\x20log\x20files\x20(older\x20than\x20','join','\x20log:','13414620SrcZyN','unlinkSync','8kyJKAi','Failed\x20to\x20clean\x20old\x20logs:','payments_created','2219544QtyixC','cwd','423279Zqlmul','loggerService','WEBHOOK_ERROR','getLogStats','replace','25mdZEvc','length','REQUEST','setDate','sort','statSync','getDate','white_domain_responses','📁\x20Created\x20logs\x20directory:\x20','date','\x20days)','log','map','writeLog','path','webhooks_errors','webhooks_received','stringify','readdirSync','logWebhookError','1854167pTlFoM','white_domain_errors','shop_webhooks_sent','cleanOldLogs','endsWith','4gDbNTm','539913AOLJqU','LoggerService','logWhiteDomainRequest','.log','Failed\x20to\x20get\x20log\x20stats:','logsDir','logWhiteDomainError','forEach','split','toISOString','67196VOHSxF','__importDefault','stack','SHOP_WEBHOOK_ERROR','Failed\x20to\x20write\x20','message','existsSync','error','logShopWebhookError','logShopWebhookSent','logWebhookReceived','white_domain_requests','filter','default','🧹\x20Cleaned\x20','shop_webhooks_errors','mkdirSync','PAYMENT_CREATED','logApiCall','mtime','2170386lbwXAH'];a44_0x44c8=function(){return _0x4fbf3b;};return a44_0x44c8();}var __importDefault=this&&this[a44_0x258971(0x9b)]||function(_0x30cc58){const _0x9b6dec=a44_0x258971;return _0x30cc58&&_0x30cc58[_0x9b6dec(0xaf)]?_0x30cc58:{'default':_0x30cc58};};Object['defineProperty'](exports,a44_0x258971(0xaf),{'value':!![]}),exports[a44_0x258971(0x72)]=exports['LoggerService']=void 0x0;const fs_1=__importDefault(require('fs')),path_1=__importDefault(require(a44_0x258971(0x84)));class LoggerService{constructor(){const _0x986f5=a44_0x258971;this[_0x986f5(0x95)]=path_1[_0x986f5(0xa7)]['join'](process[_0x986f5(0x70)](),'logs'),this['ensureLogsDirectory']();}['ensureLogsDirectory'](){const _0x3d4e19=a44_0x258971;!fs_1[_0x3d4e19(0xa7)][_0x3d4e19(0xa0)](this[_0x3d4e19(0x95)])&&(fs_1[_0x3d4e19(0xa7)][_0x3d4e19(0xaa)](this[_0x3d4e19(0x95)],{'recursive':!![]}),console[_0x3d4e19(0x81)](_0x3d4e19(0x7e)+this[_0x3d4e19(0x95)]));}['getLogFileName'](_0x566ad4){const _0x3b6eef=a44_0x258971,_0x357fc4=new Date()[_0x3b6eef(0x99)]()[_0x3b6eef(0x98)]('T')[0x0];return path_1[_0x3b6eef(0xa7)]['join'](this[_0x3b6eef(0x95)],_0x566ad4+'_'+_0x357fc4+'.log');}[a44_0x258971(0x83)](_0x2eb1eb,_0x5120d2){const _0x2cc87c=a44_0x258971;try{const _0x3ce68a=new Date()[_0x2cc87c(0x99)](),_0x1a6a5a={'timestamp':_0x3ce68a,..._0x5120d2},_0x5d4102=JSON[_0x2cc87c(0x87)](_0x1a6a5a)+'\x0a',_0x5add06=this['getLogFileName'](_0x2eb1eb);fs_1['default']['appendFileSync'](_0x5add06,_0x5d4102,'utf8');}catch(_0x17fa61){console[_0x2cc87c(0xa1)](_0x2cc87c(0x9e)+_0x2eb1eb+_0x2cc87c(0xb3),_0x17fa61);}}[a44_0x258971(0x92)](_0x327f0f,_0x1adae9,_0x16b1d2,_0x2e4ffa){const _0x137b20=a44_0x258971;this[_0x137b20(0x83)](_0x137b20(0xa5),{'type':_0x137b20(0x78),'gateway':_0x327f0f,'endpoint':_0x1adae9,'method':_0x16b1d2,'data':_0x2e4ffa});}['logWhiteDomainResponse'](_0x28352f,_0x4b8c1f,_0xcf051c,_0x44200b,_0x136f7b){const _0x4a3aa0=a44_0x258971;this[_0x4a3aa0(0x83)](_0x4a3aa0(0x7d),{'type':'RESPONSE','gateway':_0x28352f,'endpoint':_0x4b8c1f,'status':_0xcf051c,'responseTime':_0x136f7b,'data':_0x44200b});}[a44_0x258971(0x96)](_0x2e6676,_0x2735c7,_0x38d918){const _0x411505=a44_0x258971;this[_0x411505(0x83)](_0x411505(0x8b),{'type':'ERROR','gateway':_0x2e6676,'endpoint':_0x2735c7,'error':_0x38d918 instanceof Error?{'message':_0x38d918[_0x411505(0x9f)],'stack':_0x38d918[_0x411505(0x9c)]}:_0x38d918});}[a44_0x258971(0xa4)](_0x526de9,_0x378732,_0x1bbb5c){const _0x5aa611=a44_0x258971;this[_0x5aa611(0x83)](_0x5aa611(0x86),{'type':_0x5aa611(0xb0),'gateway':_0x526de9,'headers':_0x1bbb5c,'data':_0x378732});}['logWebhookProcessed'](_0x474e24,_0x5e4091,_0x5754c2,_0x522458,_0x5d124b){this['writeLog']('webhooks_processed',{'type':'WEBHOOK_PROCESSED','gateway':_0x474e24,'paymentId':_0x5e4091,'oldStatus':_0x5754c2,'newStatus':_0x522458,'originalData':_0x5d124b});}[a44_0x258971(0x89)](_0x999d7a,_0x3065e0,_0x50e8ff){const _0x2702d1=a44_0x258971;this[_0x2702d1(0x83)](_0x2702d1(0x85),{'type':_0x2702d1(0x73),'gateway':_0x999d7a,'error':_0x3065e0 instanceof Error?{'message':_0x3065e0['message'],'stack':_0x3065e0[_0x2702d1(0x9c)]}:_0x3065e0,'originalData':_0x50e8ff});}[a44_0x258971(0xa3)](_0x36c166,_0x48a78a,_0x28dc61,_0x1889d6,_0x261bc5,_0x35951a){const _0xd22020=a44_0x258971;this['writeLog'](_0xd22020(0x8c),{'type':'SHOP_WEBHOOK_SENT','shopId':_0x36c166,'webhookUrl':_0x48a78a,'event':_0x28dc61,'status':_0x1889d6,'responseTime':_0x261bc5,'payload':_0x35951a});}[a44_0x258971(0xa2)](_0x52611f,_0x58ba8b,_0x33e20f,_0x58360a,_0x198e07){const _0x52bbfd=a44_0x258971;this['writeLog'](_0x52bbfd(0xa9),{'type':_0x52bbfd(0x9d),'shopId':_0x52611f,'webhookUrl':_0x58ba8b,'event':_0x33e20f,'error':_0x58360a instanceof Error?{'message':_0x58360a[_0x52bbfd(0x9f)],'stack':_0x58360a['stack']}:_0x58360a,'payload':_0x198e07});}['logPaymentCreated'](_0xa73877,_0x48fe3f,_0x285247,_0x234ade,_0x5d796e){const _0x3a2e6e=a44_0x258971;this['writeLog'](_0x3a2e6e(0x6e),{'type':_0x3a2e6e(0xab),'gateway':_0xa73877,'paymentId':_0x48fe3f,'shopId':_0x285247,'amount':_0x234ade,'currency':_0x5d796e});}[a44_0x258971(0xac)](_0x244236,_0x3aaca2,_0x540947,_0x218002,_0x291a45){const _0x2b168e=a44_0x258971;this[_0x2b168e(0x83)]('api_calls',{'type':'API_CALL','endpoint':_0x244236,'method':_0x3aaca2,'userId':_0x540947,'userRole':_0x218002,'requestData':_0x291a45});}[a44_0x258971(0x74)](){const _0x134ce4=a44_0x258971;try{const _0x916e6d=fs_1[_0x134ce4(0xa7)][_0x134ce4(0x88)](this[_0x134ce4(0x95)]),_0x4e24a3=_0x916e6d[_0x134ce4(0xa6)](_0x162773=>_0x162773[_0x134ce4(0x8e)](_0x134ce4(0x93))),_0x4afa1d=[...new Set(_0x4e24a3[_0x134ce4(0x82)](_0x3bcde7=>_0x3bcde7[_0x134ce4(0x98)]('_')[0x0]))],_0x5d40ac=_0x4e24a3['map'](_0x3b7ca0=>{const _0x4667e5=_0x134ce4,_0x475f26=path_1[_0x4667e5(0xa7)][_0x4667e5(0xb2)](this[_0x4667e5(0x95)],_0x3b7ca0),_0x4a04a4=fs_1[_0x4667e5(0xa7)][_0x4667e5(0x7b)](_0x475f26),[_0x1842dd,_0x55887f]=_0x3b7ca0[_0x4667e5(0x75)](_0x4667e5(0x93),'')['split']('_');return{'type':_0x1842dd,'date':_0x55887f,'size':_0x4a04a4['size']};})[_0x134ce4(0x7a)]((_0x2d4766,_0x1b063a)=>_0x1b063a['date']['localeCompare'](_0x2d4766[_0x134ce4(0x7f)]));return{'totalFiles':_0x4e24a3[_0x134ce4(0x77)],'logTypes':_0x4afa1d,'latestLogs':_0x5d40ac['slice'](0x0,0xa)};}catch(_0x3ec878){return console[_0x134ce4(0xa1)](_0x134ce4(0x94),_0x3ec878),{'totalFiles':0x0,'logTypes':[],'latestLogs':[]};}}[a44_0x258971(0x8d)](_0x3b0e11=0x1e){const _0x23bb97=a44_0x258971;try{const _0x36cd25=fs_1['default']['readdirSync'](this[_0x23bb97(0x95)]),_0x5ee01e=new Date();_0x5ee01e[_0x23bb97(0x79)](_0x5ee01e[_0x23bb97(0x7c)]()-_0x3b0e11);let _0x24c7ff=0x0;_0x36cd25[_0x23bb97(0x97)](_0x11b7cd=>{const _0xb3659c=_0x23bb97;if(!_0x11b7cd[_0xb3659c(0x8e)]('.log'))return;const _0x54fd13=path_1['default'][_0xb3659c(0xb2)](this[_0xb3659c(0x95)],_0x11b7cd),_0x82df3a=fs_1[_0xb3659c(0xa7)][_0xb3659c(0x7b)](_0x54fd13);_0x82df3a[_0xb3659c(0xad)]<_0x5ee01e&&(fs_1[_0xb3659c(0xa7)][_0xb3659c(0x6b)](_0x54fd13),_0x24c7ff++,console['log']('🗑️\x20Deleted\x20old\x20log\x20file:\x20'+_0x11b7cd));}),console['log'](_0x23bb97(0xa8)+_0x24c7ff+_0x23bb97(0xb1)+_0x3b0e11+_0x23bb97(0x80));}catch(_0x5ad810){console[_0x23bb97(0xa1)](_0x23bb97(0x6d),_0x5ad810);}}}exports[a44_0x258971(0x91)]=LoggerService,exports[a44_0x258971(0x72)]=new LoggerService();