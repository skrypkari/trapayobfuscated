'use strict';function a48_0x263a(){const _0x26e886=['\x20old\x20log\x20files\x20(older\x20than\x20','log','Failed\x20to\x20write\x20','path','unlinkSync','logsDir','3804648zjzhNr','readdirSync','804969FaZSvt','getLogFileName','cleanOldLogs','RESPONSE','forEach','SHOP_WEBHOOK_ERROR','toISOString','logWebhookReceived','message','7338464HksAtQ','REQUEST','default','writeLog','logShopWebhookError','logPaymentCreated','stringify','WEBHOOK_RECEIVED','replace','white_domain_requests','filter','join','ensureLogsDirectory','WEBHOOK_PROCESSED','getLogStats','white_domain_responses','localeCompare','stack','loggerService','537990pPGSIw','logCoinToPayStatus','payments_created','PAYMENT_CREATED','logCoinToPayError','ERROR','__importDefault','defineProperty','260ffRIRB','cwd','white_domain_errors','.log','shop_webhooks_sent','statSync','COINTOPAY_STATUS_CHANGE','1XnIFuc','split','appendFileSync','endsWith','🧹\x20Cleaned\x20','API_CALL','3827175jmLZzW','197926mTVBZt','LoggerService','existsSync','2496621bEtClZ','4jVvFYZ','cointopay_status_changes','logApiCall','map','webhooks_errors','\x20log:','error','__esModule','🗑️\x20Deleted\x20old\x20log\x20file:\x20','SHOP_WEBHOOK_SENT','api_calls','utf8','setDate','logWhiteDomainRequest','Failed\x20to\x20clean\x20old\x20logs:','logShopWebhookSent','WEBHOOK_ERROR','logWhiteDomainResponse','\x20days)','shop_webhooks_errors','webhooks_received','COINTOPAY_ERROR','Failed\x20to\x20get\x20log\x20stats:','webhooks_processed'];a48_0x263a=function(){return _0x26e886;};return a48_0x263a();}const a48_0x5242b6=a48_0x4bf3;function a48_0x4bf3(_0x583a98,_0x2b74b5){const _0x263a19=a48_0x263a();return a48_0x4bf3=function(_0x4bf300,_0x5e8c51){_0x4bf300=_0x4bf300-0x1ef;let _0x5e2ec0=_0x263a19[_0x4bf300];return _0x5e2ec0;},a48_0x4bf3(_0x583a98,_0x2b74b5);}(function(_0x13a5c2,_0x36d547){const _0x30ef69=a48_0x4bf3,_0x51c831=_0x13a5c2();while(!![]){try{const _0x2d6b19=-parseInt(_0x30ef69(0x240))/0x1*(parseInt(_0x30ef69(0x1f1))/0x2)+-parseInt(_0x30ef69(0x1f4))/0x3*(-parseInt(_0x30ef69(0x1f5))/0x4)+-parseInt(_0x30ef69(0x1f0))/0x5+-parseInt(_0x30ef69(0x231))/0x6+-parseInt(_0x30ef69(0x21e))/0x7+-parseInt(_0x30ef69(0x213))/0x8+-parseInt(_0x30ef69(0x215))/0x9*(-parseInt(_0x30ef69(0x239))/0xa);if(_0x2d6b19===_0x36d547)break;else _0x51c831['push'](_0x51c831['shift']());}catch(_0x284d3f){_0x51c831['push'](_0x51c831['shift']());}}}(a48_0x263a,0xa5efd));var __importDefault=this&&this[a48_0x5242b6(0x237)]||function(_0x28148a){const _0x14a0c4=a48_0x5242b6;return _0x28148a&&_0x28148a[_0x14a0c4(0x1fc)]?_0x28148a:{'default':_0x28148a};};Object[a48_0x5242b6(0x238)](exports,a48_0x5242b6(0x1fc),{'value':!![]}),exports[a48_0x5242b6(0x230)]=exports[a48_0x5242b6(0x1f2)]=void 0x0;const fs_1=__importDefault(require('fs')),path_1=__importDefault(require(a48_0x5242b6(0x210)));class LoggerService{constructor(){const _0x44557a=a48_0x5242b6;this[_0x44557a(0x212)]=path_1[_0x44557a(0x220)][_0x44557a(0x229)](process[_0x44557a(0x23a)](),'logs'),this[_0x44557a(0x22a)]();}[a48_0x5242b6(0x22a)](){const _0x47f669=a48_0x5242b6;!fs_1['default'][_0x47f669(0x1f3)](this['logsDir'])&&(fs_1[_0x47f669(0x220)]['mkdirSync'](this['logsDir'],{'recursive':!![]}),console[_0x47f669(0x20e)]('📁\x20Created\x20logs\x20directory:\x20'+this[_0x47f669(0x212)]));}[a48_0x5242b6(0x216)](_0x59b00f){const _0x702f8e=a48_0x5242b6,_0x339a59=new Date()[_0x702f8e(0x21b)]()[_0x702f8e(0x241)]('T')[0x0];return path_1[_0x702f8e(0x220)]['join'](this[_0x702f8e(0x212)],_0x59b00f+'_'+_0x339a59+_0x702f8e(0x23c));}[a48_0x5242b6(0x221)](_0x1820c2,_0x350de5){const _0x2a990b=a48_0x5242b6;try{const _0x8a3b8a=new Date()[_0x2a990b(0x21b)](),_0x58b9f9={'timestamp':_0x8a3b8a,..._0x350de5},_0x1b63d8=JSON[_0x2a990b(0x224)](_0x58b9f9)+'\x0a',_0x37495b=this[_0x2a990b(0x216)](_0x1820c2);fs_1[_0x2a990b(0x220)][_0x2a990b(0x242)](_0x37495b,_0x1b63d8,_0x2a990b(0x200));}catch(_0x336dd){console[_0x2a990b(0x1fb)](_0x2a990b(0x20f)+_0x1820c2+_0x2a990b(0x1fa),_0x336dd);}}[a48_0x5242b6(0x202)](_0x421d0e,_0x209f8f,_0x2c869d,_0x45df6a){const _0x4029a7=a48_0x5242b6;this['writeLog'](_0x4029a7(0x227),{'type':_0x4029a7(0x21f),'gateway':_0x421d0e,'endpoint':_0x209f8f,'method':_0x2c869d,'data':_0x45df6a});}[a48_0x5242b6(0x206)](_0x2286b6,_0x3339dd,_0x3f50d3,_0x2e0f06,_0x29a4d4){const _0x24d40f=a48_0x5242b6;this[_0x24d40f(0x221)](_0x24d40f(0x22d),{'type':_0x24d40f(0x218),'gateway':_0x2286b6,'endpoint':_0x3339dd,'status':_0x3f50d3,'responseTime':_0x29a4d4,'data':_0x2e0f06});}['logWhiteDomainError'](_0x4b3667,_0x2a9556,_0x255acb){const _0x11aaff=a48_0x5242b6;this[_0x11aaff(0x221)](_0x11aaff(0x23b),{'type':_0x11aaff(0x236),'gateway':_0x4b3667,'endpoint':_0x2a9556,'error':_0x255acb instanceof Error?{'message':_0x255acb[_0x11aaff(0x21d)],'stack':_0x255acb['stack']}:_0x255acb});}[a48_0x5242b6(0x21c)](_0x4b58b3,_0x3007a0,_0x1bf9ce){const _0xa0aa3=a48_0x5242b6;this[_0xa0aa3(0x221)](_0xa0aa3(0x209),{'type':_0xa0aa3(0x225),'gateway':_0x4b58b3,'headers':_0x1bf9ce,'data':_0x3007a0});}['logWebhookProcessed'](_0x2b3b98,_0x31a6ef,_0x5a04dc,_0x48936b,_0xdd2dee){const _0x69324c=a48_0x5242b6;this[_0x69324c(0x221)](_0x69324c(0x20c),{'type':_0x69324c(0x22b),'gateway':_0x2b3b98,'paymentId':_0x31a6ef,'oldStatus':_0x5a04dc,'newStatus':_0x48936b,'originalData':_0xdd2dee});}['logWebhookError'](_0x3bd5fd,_0x5326a1,_0x1fe264){const _0x3a0171=a48_0x5242b6;this[_0x3a0171(0x221)](_0x3a0171(0x1f9),{'type':_0x3a0171(0x205),'gateway':_0x3bd5fd,'error':_0x5326a1 instanceof Error?{'message':_0x5326a1[_0x3a0171(0x21d)],'stack':_0x5326a1[_0x3a0171(0x22f)]}:_0x5326a1,'originalData':_0x1fe264});}[a48_0x5242b6(0x232)](_0x24e4f4){const _0x28aedb=a48_0x5242b6;this[_0x28aedb(0x221)](_0x28aedb(0x1f6),{'type':_0x28aedb(0x23f),..._0x24e4f4});}[a48_0x5242b6(0x235)](_0x46ca28){const _0x1f29e0=a48_0x5242b6;this[_0x1f29e0(0x221)]('cointopay_errors',{'type':_0x1f29e0(0x20a),..._0x46ca28});}[a48_0x5242b6(0x204)](_0x148834,_0x4ad447,_0x271ac1,_0xb41fa5,_0x230996,_0x1101b7){const _0x4d1c68=a48_0x5242b6;this[_0x4d1c68(0x221)](_0x4d1c68(0x23d),{'type':_0x4d1c68(0x1fe),'shopId':_0x148834,'webhookUrl':_0x4ad447,'event':_0x271ac1,'status':_0xb41fa5,'responseTime':_0x230996,'payload':_0x1101b7});}[a48_0x5242b6(0x222)](_0x399f4e,_0x24bb07,_0x4eee7d,_0x4224fb,_0x55342d){const _0x234c60=a48_0x5242b6;this[_0x234c60(0x221)](_0x234c60(0x208),{'type':_0x234c60(0x21a),'shopId':_0x399f4e,'webhookUrl':_0x24bb07,'event':_0x4eee7d,'error':_0x4224fb instanceof Error?{'message':_0x4224fb[_0x234c60(0x21d)],'stack':_0x4224fb[_0x234c60(0x22f)]}:_0x4224fb,'payload':_0x55342d});}[a48_0x5242b6(0x223)](_0x595e7d,_0x2bd8c9,_0xf183b7,_0x158753,_0x43c867){const _0x381e0a=a48_0x5242b6;this[_0x381e0a(0x221)](_0x381e0a(0x233),{'type':_0x381e0a(0x234),'gateway':_0x595e7d,'paymentId':_0x2bd8c9,'shopId':_0xf183b7,'amount':_0x158753,'currency':_0x43c867});}[a48_0x5242b6(0x1f7)](_0x3fb20f,_0x15985c,_0x172d60,_0x191a00,_0xd265ee){const _0xa15b08=a48_0x5242b6;this[_0xa15b08(0x221)](_0xa15b08(0x1ff),{'type':_0xa15b08(0x1ef),'endpoint':_0x3fb20f,'method':_0x15985c,'userId':_0x172d60,'userRole':_0x191a00,'requestData':_0xd265ee});}[a48_0x5242b6(0x22c)](){const _0x1e6c90=a48_0x5242b6;try{const _0x70aa9b=fs_1[_0x1e6c90(0x220)][_0x1e6c90(0x214)](this[_0x1e6c90(0x212)]),_0x37c913=_0x70aa9b[_0x1e6c90(0x228)](_0x16e596=>_0x16e596[_0x1e6c90(0x243)](_0x1e6c90(0x23c))),_0x3472a5=[...new Set(_0x37c913[_0x1e6c90(0x1f8)](_0x2b367c=>_0x2b367c[_0x1e6c90(0x241)]('_')[0x0]))],_0x29e3ed=_0x37c913['map'](_0x1e770e=>{const _0x4f5c64=_0x1e6c90,_0x2d5060=path_1['default'][_0x4f5c64(0x229)](this[_0x4f5c64(0x212)],_0x1e770e),_0x47cb0b=fs_1['default'][_0x4f5c64(0x23e)](_0x2d5060),[_0x520375,_0x16ee67]=_0x1e770e[_0x4f5c64(0x226)]('.log','')[_0x4f5c64(0x241)]('_');return{'type':_0x520375,'date':_0x16ee67,'size':_0x47cb0b['size']};})['sort']((_0x263935,_0x4a7764)=>_0x4a7764['date'][_0x1e6c90(0x22e)](_0x263935['date']));return{'totalFiles':_0x37c913['length'],'logTypes':_0x3472a5,'latestLogs':_0x29e3ed['slice'](0x0,0xa)};}catch(_0x389a54){return console[_0x1e6c90(0x1fb)](_0x1e6c90(0x20b),_0x389a54),{'totalFiles':0x0,'logTypes':[],'latestLogs':[]};}}[a48_0x5242b6(0x217)](_0x5249ba=0x1e){const _0x1da61f=a48_0x5242b6;try{const _0x56f20a=fs_1[_0x1da61f(0x220)][_0x1da61f(0x214)](this[_0x1da61f(0x212)]),_0xfd34a8=new Date();_0xfd34a8[_0x1da61f(0x201)](_0xfd34a8['getDate']()-_0x5249ba);let _0x6cd2b=0x0;_0x56f20a[_0x1da61f(0x219)](_0x5a758b=>{const _0x2a9fcf=_0x1da61f;if(!_0x5a758b['endsWith']('.log'))return;const _0x5d7a1b=path_1[_0x2a9fcf(0x220)][_0x2a9fcf(0x229)](this['logsDir'],_0x5a758b),_0x8ec2d9=fs_1[_0x2a9fcf(0x220)]['statSync'](_0x5d7a1b);_0x8ec2d9['mtime']<_0xfd34a8&&(fs_1[_0x2a9fcf(0x220)][_0x2a9fcf(0x211)](_0x5d7a1b),_0x6cd2b++,console[_0x2a9fcf(0x20e)](_0x2a9fcf(0x1fd)+_0x5a758b));}),console[_0x1da61f(0x20e)](_0x1da61f(0x244)+_0x6cd2b+_0x1da61f(0x20d)+_0x5249ba+_0x1da61f(0x207));}catch(_0x2b0a69){console[_0x1da61f(0x1fb)](_0x1da61f(0x203),_0x2b0a69);}}}exports[a48_0x5242b6(0x1f2)]=LoggerService,exports[a48_0x5242b6(0x230)]=new LoggerService();