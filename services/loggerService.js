'use strict';const a44_0x7eb856=a44_0x46b0;(function(_0x234147,_0x476462){const _0x1bfb74=a44_0x46b0,_0x29191a=_0x234147();while(!![]){try{const _0x2c3a59=-parseInt(_0x1bfb74(0x217))/0x1+parseInt(_0x1bfb74(0x212))/0x2+parseInt(_0x1bfb74(0x20a))/0x3+-parseInt(_0x1bfb74(0x1eb))/0x4*(-parseInt(_0x1bfb74(0x1ed))/0x5)+parseInt(_0x1bfb74(0x1ea))/0x6*(parseInt(_0x1bfb74(0x1f6))/0x7)+-parseInt(_0x1bfb74(0x208))/0x8+parseInt(_0x1bfb74(0x21d))/0x9;if(_0x2c3a59===_0x476462)break;else _0x29191a['push'](_0x29191a['shift']());}catch(_0x1be4a7){_0x29191a['push'](_0x29191a['shift']());}}}(a44_0x501f,0x6621f));function a44_0x46b0(_0xd19ba0,_0x529ab4){const _0x501f3a=a44_0x501f();return a44_0x46b0=function(_0x46b01a,_0x5eb9e6){_0x46b01a=_0x46b01a-0x1d2;let _0xa0950=_0x501f3a[_0x46b01a];return _0xa0950;},a44_0x46b0(_0xd19ba0,_0x529ab4);}var __importDefault=this&&this['__importDefault']||function(_0x404814){const _0x4220cf=a44_0x46b0;return _0x404814&&_0x404814[_0x4220cf(0x1f0)]?_0x404814:{'default':_0x404814};};Object[a44_0x7eb856(0x1e2)](exports,a44_0x7eb856(0x1f0),{'value':!![]}),exports[a44_0x7eb856(0x21c)]=exports[a44_0x7eb856(0x1ef)]=void 0x0;const fs_1=__importDefault(require('fs')),path_1=__importDefault(require(a44_0x7eb856(0x1d2)));class LoggerService{constructor(){const _0x36f33f=a44_0x7eb856;this[_0x36f33f(0x1d6)]=path_1[_0x36f33f(0x216)][_0x36f33f(0x1f7)](process[_0x36f33f(0x1e5)](),_0x36f33f(0x1e6)),this[_0x36f33f(0x1ec)]();}['ensureLogsDirectory'](){const _0x16d55c=a44_0x7eb856;!fs_1[_0x16d55c(0x216)][_0x16d55c(0x1e1)](this[_0x16d55c(0x1d6)])&&(fs_1[_0x16d55c(0x216)][_0x16d55c(0x1f5)](this['logsDir'],{'recursive':!![]}),console[_0x16d55c(0x21a)](_0x16d55c(0x201)+this['logsDir']));}[a44_0x7eb856(0x200)](_0x4bf585){const _0x261503=a44_0x7eb856,_0x758779=new Date()['toISOString']()[_0x261503(0x1df)]('T')[0x0];return path_1[_0x261503(0x216)][_0x261503(0x1f7)](this[_0x261503(0x1d6)],_0x4bf585+'_'+_0x758779+_0x261503(0x1e7));}['writeLog'](_0x338aa8,_0x137b56){const _0x1aae7e=a44_0x7eb856;try{const _0x50f66d=new Date()[_0x1aae7e(0x1fb)](),_0x24533c={'timestamp':_0x50f66d,..._0x137b56},_0x35c3c2=JSON[_0x1aae7e(0x1dc)](_0x24533c)+'\x0a',_0x3cbb62=this[_0x1aae7e(0x200)](_0x338aa8);fs_1['default'][_0x1aae7e(0x1f4)](_0x3cbb62,_0x35c3c2,'utf8');}catch(_0x30c919){console[_0x1aae7e(0x1d7)](_0x1aae7e(0x1d8)+_0x338aa8+_0x1aae7e(0x218),_0x30c919);}}['logWhiteDomainRequest'](_0x160a00,_0x2b0832,_0xcb302f,_0x1da9c5){const _0x59694a=a44_0x7eb856;this[_0x59694a(0x1e0)](_0x59694a(0x1f2),{'type':_0x59694a(0x1e3),'gateway':_0x160a00,'endpoint':_0x2b0832,'method':_0xcb302f,'data':_0x1da9c5});}['logWhiteDomainResponse'](_0x1acf37,_0x21154f,_0xcb5bfd,_0x3c40f9,_0x52fdcc){const _0x161d00=a44_0x7eb856;this['writeLog'](_0x161d00(0x1d9),{'type':_0x161d00(0x1d3),'gateway':_0x1acf37,'endpoint':_0x21154f,'status':_0xcb5bfd,'responseTime':_0x52fdcc,'data':_0x3c40f9});}['logWhiteDomainError'](_0x3f5a13,_0x48119a,_0x3f4e84){const _0x4b7060=a44_0x7eb856;this[_0x4b7060(0x1e0)](_0x4b7060(0x1e8),{'type':_0x4b7060(0x20d),'gateway':_0x3f5a13,'endpoint':_0x48119a,'error':_0x3f4e84 instanceof Error?{'message':_0x3f4e84[_0x4b7060(0x1dd)],'stack':_0x3f4e84[_0x4b7060(0x210)]}:_0x3f4e84});}[a44_0x7eb856(0x209)](_0x5b3649,_0x2e91b8,_0x46cb62){const _0x559530=a44_0x7eb856;this[_0x559530(0x1e0)](_0x559530(0x1e9),{'type':_0x559530(0x1f3),'gateway':_0x5b3649,'headers':_0x46cb62,'data':_0x2e91b8});}[a44_0x7eb856(0x1fc)](_0x256f5b,_0x190747,_0x409192,_0x23d92b,_0xe5531){const _0x135382=a44_0x7eb856;this[_0x135382(0x1e0)](_0x135382(0x211),{'type':'WEBHOOK_PROCESSED','gateway':_0x256f5b,'paymentId':_0x190747,'oldStatus':_0x409192,'newStatus':_0x23d92b,'originalData':_0xe5531});}[a44_0x7eb856(0x1f8)](_0xd4e82a,_0x2422ed,_0x24f84e){const _0x453abf=a44_0x7eb856;this[_0x453abf(0x1e0)](_0x453abf(0x203),{'type':'WEBHOOK_ERROR','gateway':_0xd4e82a,'error':_0x2422ed instanceof Error?{'message':_0x2422ed[_0x453abf(0x1dd)],'stack':_0x2422ed[_0x453abf(0x210)]}:_0x2422ed,'originalData':_0x24f84e});}[a44_0x7eb856(0x1db)](_0x585308,_0x39de05,_0x1123b4,_0x17140a,_0xc20406,_0x34fb45){const _0x387edc=a44_0x7eb856;this[_0x387edc(0x1e0)](_0x387edc(0x20b),{'type':'SHOP_WEBHOOK_SENT','shopId':_0x585308,'webhookUrl':_0x39de05,'event':_0x1123b4,'status':_0x17140a,'responseTime':_0xc20406,'payload':_0x34fb45});}['logShopWebhookError'](_0x4d46b0,_0x3b808e,_0x1e8618,_0x1fdd7f,_0x5bd58d){const _0x2dec30=a44_0x7eb856;this[_0x2dec30(0x1e0)]('shop_webhooks_errors',{'type':_0x2dec30(0x1f1),'shopId':_0x4d46b0,'webhookUrl':_0x3b808e,'event':_0x1e8618,'error':_0x1fdd7f instanceof Error?{'message':_0x1fdd7f[_0x2dec30(0x1dd)],'stack':_0x1fdd7f[_0x2dec30(0x210)]}:_0x1fdd7f,'payload':_0x5bd58d});}[a44_0x7eb856(0x21b)](_0x357e78,_0x22be5f,_0x473f7f,_0x485713,_0x528043){const _0x4207b4=a44_0x7eb856;this[_0x4207b4(0x1e0)]('payments_created',{'type':_0x4207b4(0x1e4),'gateway':_0x357e78,'paymentId':_0x22be5f,'shopId':_0x473f7f,'amount':_0x485713,'currency':_0x528043});}['logApiCall'](_0x323361,_0x12b202,_0x584387,_0x40548d,_0x5ce316){const _0x2e7099=a44_0x7eb856;this[_0x2e7099(0x1e0)](_0x2e7099(0x213),{'type':_0x2e7099(0x207),'endpoint':_0x323361,'method':_0x12b202,'userId':_0x584387,'userRole':_0x40548d,'requestData':_0x5ce316});}[a44_0x7eb856(0x21e)](){const _0x53dff3=a44_0x7eb856;try{const _0x230869=fs_1[_0x53dff3(0x216)][_0x53dff3(0x1fe)](this[_0x53dff3(0x1d6)]),_0x5ce1c9=_0x230869[_0x53dff3(0x205)](_0x14d73f=>_0x14d73f[_0x53dff3(0x206)](_0x53dff3(0x1e7))),_0x2a7297=[...new Set(_0x5ce1c9[_0x53dff3(0x204)](_0x1b3f15=>_0x1b3f15[_0x53dff3(0x1df)]('_')[0x0]))],_0xaefc01=_0x5ce1c9[_0x53dff3(0x204)](_0x13e40e=>{const _0x45d8de=_0x53dff3,_0x3fbf54=path_1[_0x45d8de(0x216)][_0x45d8de(0x1f7)](this[_0x45d8de(0x1d6)],_0x13e40e),_0x214d6f=fs_1[_0x45d8de(0x216)][_0x45d8de(0x1de)](_0x3fbf54),[_0x3b601f,_0x3eb8fd]=_0x13e40e[_0x45d8de(0x1fd)]('.log','')[_0x45d8de(0x1df)]('_');return{'type':_0x3b601f,'date':_0x3eb8fd,'size':_0x214d6f[_0x45d8de(0x219)]};})[_0x53dff3(0x1f9)]((_0x2830ee,_0x716385)=>_0x716385[_0x53dff3(0x1da)][_0x53dff3(0x1ff)](_0x2830ee[_0x53dff3(0x1da)]));return{'totalFiles':_0x5ce1c9[_0x53dff3(0x1d5)],'logTypes':_0x2a7297,'latestLogs':_0xaefc01[_0x53dff3(0x202)](0x0,0xa)};}catch(_0x321a65){return console[_0x53dff3(0x1d7)]('Failed\x20to\x20get\x20log\x20stats:',_0x321a65),{'totalFiles':0x0,'logTypes':[],'latestLogs':[]};}}['cleanOldLogs'](_0x1f987b=0x1e){const _0x40f421=a44_0x7eb856;try{const _0x1c2394=fs_1[_0x40f421(0x216)][_0x40f421(0x1fe)](this[_0x40f421(0x1d6)]),_0x4837d9=new Date();_0x4837d9[_0x40f421(0x1d4)](_0x4837d9['getDate']()-_0x1f987b);let _0x31a21b=0x0;_0x1c2394[_0x40f421(0x214)](_0x2e6fea=>{const _0x5bc344=_0x40f421;if(!_0x2e6fea['endsWith'](_0x5bc344(0x1e7)))return;const _0x27d7d5=path_1[_0x5bc344(0x216)]['join'](this[_0x5bc344(0x1d6)],_0x2e6fea),_0xa9931a=fs_1[_0x5bc344(0x216)][_0x5bc344(0x1de)](_0x27d7d5);_0xa9931a[_0x5bc344(0x20f)]<_0x4837d9&&(fs_1[_0x5bc344(0x216)][_0x5bc344(0x1fa)](_0x27d7d5),_0x31a21b++,console[_0x5bc344(0x21a)](_0x5bc344(0x1ee)+_0x2e6fea));}),console[_0x40f421(0x21a)](_0x40f421(0x215)+_0x31a21b+'\x20old\x20log\x20files\x20(older\x20than\x20'+_0x1f987b+_0x40f421(0x20e));}catch(_0xd6605e){console[_0x40f421(0x1d7)](_0x40f421(0x20c),_0xd6605e);}}}exports['LoggerService']=LoggerService,exports['loggerService']=new LoggerService();function a44_0x501f(){const _0x437ed9=['3491352LVhXqN','logWebhookReceived','692109HUcMMw','shop_webhooks_sent','Failed\x20to\x20clean\x20old\x20logs:','ERROR','\x20days)','mtime','stack','webhooks_processed','1177184SNnuYH','api_calls','forEach','ðŸ§¹\x20Cleaned\x20','default','666501mVURwv','\x20log:','size','log','logPaymentCreated','loggerService','375156UVVnnH','getLogStats','path','RESPONSE','setDate','length','logsDir','error','Failed\x20to\x20write\x20','white_domain_responses','date','logShopWebhookSent','stringify','message','statSync','split','writeLog','existsSync','defineProperty','REQUEST','PAYMENT_CREATED','cwd','logs','.log','white_domain_errors','webhooks_received','823854qeEzZp','59332GcQeUl','ensureLogsDirectory','130czxrJc','ðŸ—‘ï¸\x20Deleted\x20old\x20log\x20file:\x20','LoggerService','__esModule','SHOP_WEBHOOK_ERROR','white_domain_requests','WEBHOOK_RECEIVED','appendFileSync','mkdirSync','14vOhRMT','join','logWebhookError','sort','unlinkSync','toISOString','logWebhookProcessed','replace','readdirSync','localeCompare','getLogFileName','ðŸ“\x20Created\x20logs\x20directory:\x20','slice','webhooks_errors','map','filter','endsWith','API_CALL'];a44_0x501f=function(){return _0x437ed9;};return a44_0x501f();}