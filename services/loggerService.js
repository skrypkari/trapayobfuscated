'use strict';function a44_0x5b71(_0x257716,_0x3fa599){const _0x2daf25=a44_0x2daf();return a44_0x5b71=function(_0x5b717d,_0xfe176){_0x5b717d=_0x5b717d-0x10e;let _0x2d8a9a=_0x2daf25[_0x5b717d];return _0x2d8a9a;},a44_0x5b71(_0x257716,_0x3fa599);}const a44_0x501c49=a44_0x5b71;(function(_0x1c2881,_0x13d642){const _0x288efd=a44_0x5b71,_0x4581ff=_0x1c2881();while(!![]){try{const _0x560479=parseInt(_0x288efd(0x158))/0x1*(parseInt(_0x288efd(0x126))/0x2)+-parseInt(_0x288efd(0x10e))/0x3+parseInt(_0x288efd(0x12e))/0x4+parseInt(_0x288efd(0x12f))/0x5*(-parseInt(_0x288efd(0x13f))/0x6)+-parseInt(_0x288efd(0x14e))/0x7*(parseInt(_0x288efd(0x13d))/0x8)+-parseInt(_0x288efd(0x152))/0x9+-parseInt(_0x288efd(0x14f))/0xa*(-parseInt(_0x288efd(0x140))/0xb);if(_0x560479===_0x13d642)break;else _0x4581ff['push'](_0x4581ff['shift']());}catch(_0x50904b){_0x4581ff['push'](_0x4581ff['shift']());}}}(a44_0x2daf,0x7bbef));var __importDefault=this&&this[a44_0x501c49(0x145)]||function(_0x5ae4c3){const _0xd8d545=a44_0x501c49;return _0x5ae4c3&&_0x5ae4c3[_0xd8d545(0x112)]?_0x5ae4c3:{'default':_0x5ae4c3};};Object[a44_0x501c49(0x12c)](exports,a44_0x501c49(0x112),{'value':!![]}),exports[a44_0x501c49(0x139)]=exports[a44_0x501c49(0x130)]=void 0x0;const fs_1=__importDefault(require('fs')),path_1=__importDefault(require('path'));class LoggerService{constructor(){const _0x23993f=a44_0x501c49;this[_0x23993f(0x116)]=path_1['default']['join'](process[_0x23993f(0x115)](),_0x23993f(0x12a)),this['ensureLogsDirectory']();}['ensureLogsDirectory'](){const _0x3b3c88=a44_0x501c49;!fs_1['default'][_0x3b3c88(0x13a)](this[_0x3b3c88(0x116)])&&(fs_1[_0x3b3c88(0x150)][_0x3b3c88(0x132)](this[_0x3b3c88(0x116)],{'recursive':!![]}),console['log'](_0x3b3c88(0x13e)+this[_0x3b3c88(0x116)]));}[a44_0x501c49(0x153)](_0x19626c){const _0x2e7132=a44_0x501c49,_0x47cc37=new Date()['toISOString']()[_0x2e7132(0x120)]('T')[0x0];return path_1[_0x2e7132(0x150)][_0x2e7132(0x11f)](this[_0x2e7132(0x116)],_0x19626c+'_'+_0x47cc37+_0x2e7132(0x134));}[a44_0x501c49(0x143)](_0x39eccb,_0x2b8fa0){const _0x174289=a44_0x501c49;try{const _0x5e905b=new Date()[_0x174289(0x110)](),_0xbfb1ed={'timestamp':_0x5e905b,..._0x2b8fa0},_0x40b159=JSON['stringify'](_0xbfb1ed)+'\x0a',_0x4173e2=this[_0x174289(0x153)](_0x39eccb);fs_1[_0x174289(0x150)][_0x174289(0x127)](_0x4173e2,_0x40b159,'utf8');}catch(_0x51341c){console[_0x174289(0x135)]('Failed\x20to\x20write\x20'+_0x39eccb+_0x174289(0x146),_0x51341c);}}['logWhiteDomainRequest'](_0x43d2a7,_0x4f6a90,_0x25c601,_0x369200){const _0x5be506=a44_0x501c49;this[_0x5be506(0x143)](_0x5be506(0x11b),{'type':_0x5be506(0x154),'gateway':_0x43d2a7,'endpoint':_0x4f6a90,'method':_0x25c601,'data':_0x369200});}['logWhiteDomainResponse'](_0x19b93d,_0x18f617,_0x3801de,_0x47923a,_0x2f4553){const _0x328c6f=a44_0x501c49;this['writeLog']('white_domain_responses',{'type':_0x328c6f(0x15a),'gateway':_0x19b93d,'endpoint':_0x18f617,'status':_0x3801de,'responseTime':_0x2f4553,'data':_0x47923a});}[a44_0x501c49(0x13b)](_0x59e085,_0x3bfe01,_0x1b6b5c){const _0x3c6116=a44_0x501c49;this[_0x3c6116(0x143)](_0x3c6116(0x141),{'type':_0x3c6116(0x119),'gateway':_0x59e085,'endpoint':_0x3bfe01,'error':_0x1b6b5c instanceof Error?{'message':_0x1b6b5c[_0x3c6116(0x12b)],'stack':_0x1b6b5c['stack']}:_0x1b6b5c});}[a44_0x501c49(0x11c)](_0x427229,_0x46d08d,_0x5beb4b){const _0x2040d7=a44_0x501c49;this[_0x2040d7(0x143)](_0x2040d7(0x15b),{'type':'WEBHOOK_RECEIVED','gateway':_0x427229,'headers':_0x5beb4b,'data':_0x46d08d});}[a44_0x501c49(0x133)](_0x356bbc,_0x2a20d7,_0x440849,_0x9c3b06,_0x573abe){const _0x87bcfc=a44_0x501c49;this[_0x87bcfc(0x143)](_0x87bcfc(0x128),{'type':_0x87bcfc(0x131),'gateway':_0x356bbc,'paymentId':_0x2a20d7,'oldStatus':_0x440849,'newStatus':_0x9c3b06,'originalData':_0x573abe});}[a44_0x501c49(0x157)](_0x428f46,_0x8ec5e6,_0x307ad5){const _0x58aea5=a44_0x501c49;this[_0x58aea5(0x143)](_0x58aea5(0x14a),{'type':'WEBHOOK_ERROR','gateway':_0x428f46,'error':_0x8ec5e6 instanceof Error?{'message':_0x8ec5e6[_0x58aea5(0x12b)],'stack':_0x8ec5e6[_0x58aea5(0x12d)]}:_0x8ec5e6,'originalData':_0x307ad5});}['logCoinToPayStatus'](_0x51fa63){const _0x1af17a=a44_0x501c49;this['writeLog'](_0x1af17a(0x14d),{'type':_0x1af17a(0x11e),..._0x51fa63});}['logCoinToPayError'](_0x528932){const _0x158c9b=a44_0x501c49;this[_0x158c9b(0x143)]('cointopay_errors',{'type':_0x158c9b(0x114),..._0x528932});}[a44_0x501c49(0x13c)](_0x4e2312,_0x47f21f,_0x9e846b,_0x1fb115,_0x2e214f,_0x85c65c){const _0x51200e=a44_0x501c49;this[_0x51200e(0x143)](_0x51200e(0x113),{'type':'SHOP_WEBHOOK_SENT','shopId':_0x4e2312,'webhookUrl':_0x47f21f,'event':_0x9e846b,'status':_0x1fb115,'responseTime':_0x2e214f,'payload':_0x85c65c});}[a44_0x501c49(0x129)](_0x451409,_0x3e7872,_0x1dfa86,_0x3b7a1d,_0x1f94ba){const _0x3973d8=a44_0x501c49;this['writeLog'](_0x3973d8(0x159),{'type':_0x3973d8(0x137),'shopId':_0x451409,'webhookUrl':_0x3e7872,'event':_0x1dfa86,'error':_0x3b7a1d instanceof Error?{'message':_0x3b7a1d[_0x3973d8(0x12b)],'stack':_0x3b7a1d['stack']}:_0x3b7a1d,'payload':_0x1f94ba});}[a44_0x501c49(0x10f)](_0x348e34,_0x24c54b,_0x310913,_0x54effe,_0x1212e0){const _0x4f2071=a44_0x501c49;this['writeLog'](_0x4f2071(0x117),{'type':'PAYMENT_CREATED','gateway':_0x348e34,'paymentId':_0x24c54b,'shopId':_0x310913,'amount':_0x54effe,'currency':_0x1212e0});}[a44_0x501c49(0x151)](_0x3adf13,_0x3bc005,_0x54f4b4,_0x543dc3,_0x2a8a62){const _0x11ed58=a44_0x501c49;this['writeLog'](_0x11ed58(0x155),{'type':_0x11ed58(0x11d),'endpoint':_0x3adf13,'method':_0x3bc005,'userId':_0x54f4b4,'userRole':_0x543dc3,'requestData':_0x2a8a62});}[a44_0x501c49(0x111)](){const _0x5a5ee0=a44_0x501c49;try{const _0x4066c5=fs_1['default'][_0x5a5ee0(0x14c)](this[_0x5a5ee0(0x116)]),_0x59c1ae=_0x4066c5['filter'](_0x3069d0=>_0x3069d0[_0x5a5ee0(0x147)](_0x5a5ee0(0x134))),_0x17108d=[...new Set(_0x59c1ae[_0x5a5ee0(0x122)](_0xe06177=>_0xe06177[_0x5a5ee0(0x120)]('_')[0x0]))],_0x1ed001=_0x59c1ae['map'](_0x191d38=>{const _0x112e48=_0x5a5ee0,_0x145e62=path_1[_0x112e48(0x150)][_0x112e48(0x11f)](this[_0x112e48(0x116)],_0x191d38),_0x54f0d6=fs_1[_0x112e48(0x150)][_0x112e48(0x138)](_0x145e62),[_0x5112d1,_0x2105ec]=_0x191d38['replace'](_0x112e48(0x134),'')[_0x112e48(0x120)]('_');return{'type':_0x5112d1,'date':_0x2105ec,'size':_0x54f0d6[_0x112e48(0x118)]};})[_0x5a5ee0(0x156)]((_0x2fe7a7,_0x288f9e)=>_0x288f9e[_0x5a5ee0(0x149)]['localeCompare'](_0x2fe7a7[_0x5a5ee0(0x149)]));return{'totalFiles':_0x59c1ae['length'],'logTypes':_0x17108d,'latestLogs':_0x1ed001['slice'](0x0,0xa)};}catch(_0x3b640a){return console[_0x5a5ee0(0x135)](_0x5a5ee0(0x15c),_0x3b640a),{'totalFiles':0x0,'logTypes':[],'latestLogs':[]};}}[a44_0x501c49(0x142)](_0x3fe2f3=0x1e){const _0x51ed91=a44_0x501c49;try{const _0x4827ef=fs_1[_0x51ed91(0x150)][_0x51ed91(0x14c)](this[_0x51ed91(0x116)]),_0x330b4b=new Date();_0x330b4b[_0x51ed91(0x136)](_0x330b4b[_0x51ed91(0x125)]()-_0x3fe2f3);let _0x2d64ba=0x0;_0x4827ef[_0x51ed91(0x144)](_0x53c524=>{const _0x317a31=_0x51ed91;if(!_0x53c524[_0x317a31(0x147)](_0x317a31(0x134)))return;const _0x5b5a31=path_1[_0x317a31(0x150)]['join'](this[_0x317a31(0x116)],_0x53c524),_0x549514=fs_1['default']['statSync'](_0x5b5a31);_0x549514['mtime']<_0x330b4b&&(fs_1['default'][_0x317a31(0x121)](_0x5b5a31),_0x2d64ba++,console[_0x317a31(0x14b)](_0x317a31(0x11a)+_0x53c524));}),console[_0x51ed91(0x14b)](_0x51ed91(0x123)+_0x2d64ba+'\x20old\x20log\x20files\x20(older\x20than\x20'+_0x3fe2f3+_0x51ed91(0x148));}catch(_0x5cae34){console['error'](_0x51ed91(0x124),_0x5cae34);}}}exports[a44_0x501c49(0x130)]=LoggerService,exports[a44_0x501c49(0x139)]=new LoggerService();function a44_0x2daf(){const _0x52907e=['map','ðŸ§¹\x20Cleaned\x20','Failed\x20to\x20clean\x20old\x20logs:','getDate','2PoxGfS','appendFileSync','webhooks_processed','logShopWebhookError','logs','message','defineProperty','stack','963612xeGPUK','70MsXoML','LoggerService','WEBHOOK_PROCESSED','mkdirSync','logWebhookProcessed','.log','error','setDate','SHOP_WEBHOOK_ERROR','statSync','loggerService','existsSync','logWhiteDomainError','logShopWebhookSent','88vHaQki','ðŸ“\x20Created\x20logs\x20directory:\x20','375234tmbLPc','286CYMUMj','white_domain_errors','cleanOldLogs','writeLog','forEach','__importDefault','\x20log:','endsWith','\x20days)','date','webhooks_errors','log','readdirSync','cointopay_status_changes','284564ebwBrc','606290kksNJk','default','logApiCall','3448818AiGMEq','getLogFileName','REQUEST','api_calls','sort','logWebhookError','715071xKBOfl','shop_webhooks_errors','RESPONSE','webhooks_received','Failed\x20to\x20get\x20log\x20stats:','958635TXZIwz','logPaymentCreated','toISOString','getLogStats','__esModule','shop_webhooks_sent','COINTOPAY_ERROR','cwd','logsDir','payments_created','size','ERROR','ðŸ—‘ï¸\x20Deleted\x20old\x20log\x20file:\x20','white_domain_requests','logWebhookReceived','API_CALL','COINTOPAY_STATUS_CHANGE','join','split','unlinkSync'];a44_0x2daf=function(){return _0x52907e;};return a44_0x2daf();}