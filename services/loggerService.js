'use strict';function a44_0x5280(){const _0x51fb93=['WEBHOOK_ERROR','replace','appendFileSync','657958TLqCvC','1259151aCbArm','getLogFileName','webhooks_errors','LoggerService','writeLog','\x20log:','ðŸ§¹\x20Cleaned\x20','log','path','toISOString','4866iAcsKP','defineProperty','message','forEach','white_domain_errors','webhooks_processed','webhooks_received','getDate','1448307MsjqRY','WEBHOOK_RECEIVED','mkdirSync','existsSync','RESPONSE','24onDmuf','cwd','logsDir','endsWith','\x20days)','default','REQUEST','.log','date','ERROR','localeCompare','slice','white_domain_requests','readdirSync','logWhiteDomainRequest','SHOP_WEBHOOK_SENT','getLogStats','77115gmtiJd','2559744hRbKcT','error','loggerService','API_CALL','white_domain_responses','WEBHOOK_PROCESSED','filter','__importDefault','\x20old\x20log\x20files\x20(older\x20than\x20','sort','statSync','split','stack','logWebhookProcessed','ðŸ“\x20Created\x20logs\x20directory:\x20','map','stringify','20WBcOoo','logWhiteDomainResponse','join','Failed\x20to\x20clean\x20old\x20logs:','ensureLogsDirectory','shop_webhooks_sent','setDate','logShopWebhookError','payments_created','__esModule','cleanOldLogs','530784iurlly','PAYMENT_CREATED'];a44_0x5280=function(){return _0x51fb93;};return a44_0x5280();}const a44_0x24e946=a44_0x469a;(function(_0x1adbc8,_0x774a20){const _0x3cd80a=a44_0x469a,_0x44f272=_0x1adbc8();while(!![]){try{const _0x5939de=parseInt(_0x3cd80a(0x1ee))/0x1*(-parseInt(_0x3cd80a(0x1be))/0x2)+-parseInt(_0x3cd80a(0x1b4))/0x3+parseInt(_0x3cd80a(0x1ae))/0x4+parseInt(_0x3cd80a(0x1dc))/0x5+-parseInt(_0x3cd80a(0x1cb))/0x6*(-parseInt(_0x3cd80a(0x1b3))/0x7)+parseInt(_0x3cd80a(0x1dd))/0x8+-parseInt(_0x3cd80a(0x1c6))/0x9;if(_0x5939de===_0x774a20)break;else _0x44f272['push'](_0x44f272['shift']());}catch(_0x49138d){_0x44f272['push'](_0x44f272['shift']());}}}(a44_0x5280,0x346eb));function a44_0x469a(_0xd334cb,_0xd33e18){const _0x52800c=a44_0x5280();return a44_0x469a=function(_0x469ab9,_0x3f3da1){_0x469ab9=_0x469ab9-0x1a5;let _0x4bdbd3=_0x52800c[_0x469ab9];return _0x4bdbd3;},a44_0x469a(_0xd334cb,_0xd33e18);}var __importDefault=this&&this[a44_0x24e946(0x1e4)]||function(_0x4903c2){const _0x24e793=a44_0x24e946;return _0x4903c2&&_0x4903c2[_0x24e793(0x1ac)]?_0x4903c2:{'default':_0x4903c2};};Object[a44_0x24e946(0x1bf)](exports,a44_0x24e946(0x1ac),{'value':!![]}),exports[a44_0x24e946(0x1df)]=exports[a44_0x24e946(0x1b7)]=void 0x0;const fs_1=__importDefault(require('fs')),path_1=__importDefault(require(a44_0x24e946(0x1bc)));class LoggerService{constructor(){const _0x46c091=a44_0x24e946;this[_0x46c091(0x1cd)]=path_1[_0x46c091(0x1d0)][_0x46c091(0x1a5)](process[_0x46c091(0x1cc)](),'logs'),this[_0x46c091(0x1a7)]();}[a44_0x24e946(0x1a7)](){const _0x1f415d=a44_0x24e946;!fs_1[_0x1f415d(0x1d0)][_0x1f415d(0x1c9)](this['logsDir'])&&(fs_1[_0x1f415d(0x1d0)][_0x1f415d(0x1c8)](this['logsDir'],{'recursive':!![]}),console[_0x1f415d(0x1bb)](_0x1f415d(0x1eb)+this[_0x1f415d(0x1cd)]));}['getLogFileName'](_0x1a6a7b){const _0x3b84e3=a44_0x24e946,_0x5926e5=new Date()[_0x3b84e3(0x1bd)]()[_0x3b84e3(0x1e8)]('T')[0x0];return path_1[_0x3b84e3(0x1d0)]['join'](this[_0x3b84e3(0x1cd)],_0x1a6a7b+'_'+_0x5926e5+_0x3b84e3(0x1d2));}[a44_0x24e946(0x1b8)](_0x1b8c92,_0x6e65a8){const _0x2af8fa=a44_0x24e946;try{const _0x5bef37=new Date()['toISOString'](),_0x355eb3={'timestamp':_0x5bef37,..._0x6e65a8},_0x197b71=JSON[_0x2af8fa(0x1ed)](_0x355eb3)+'\x0a',_0x136428=this[_0x2af8fa(0x1b5)](_0x1b8c92);fs_1[_0x2af8fa(0x1d0)][_0x2af8fa(0x1b2)](_0x136428,_0x197b71,'utf8');}catch(_0x564639){console[_0x2af8fa(0x1de)]('Failed\x20to\x20write\x20'+_0x1b8c92+_0x2af8fa(0x1b9),_0x564639);}}[a44_0x24e946(0x1d9)](_0x390311,_0x31c753,_0x16286a,_0x4b649f){const _0x90030e=a44_0x24e946;this[_0x90030e(0x1b8)](_0x90030e(0x1d7),{'type':_0x90030e(0x1d1),'gateway':_0x390311,'endpoint':_0x31c753,'method':_0x16286a,'data':_0x4b649f});}[a44_0x24e946(0x1ef)](_0x37a2a9,_0x1f7341,_0x5a872d,_0x1f1974,_0x1b3e6b){const _0x1b51cc=a44_0x24e946;this[_0x1b51cc(0x1b8)](_0x1b51cc(0x1e1),{'type':_0x1b51cc(0x1ca),'gateway':_0x37a2a9,'endpoint':_0x1f7341,'status':_0x5a872d,'responseTime':_0x1b3e6b,'data':_0x1f1974});}['logWhiteDomainError'](_0x1d37e4,_0x21b402,_0x51badd){const _0xed082e=a44_0x24e946;this[_0xed082e(0x1b8)](_0xed082e(0x1c2),{'type':_0xed082e(0x1d4),'gateway':_0x1d37e4,'endpoint':_0x21b402,'error':_0x51badd instanceof Error?{'message':_0x51badd[_0xed082e(0x1c0)],'stack':_0x51badd[_0xed082e(0x1e9)]}:_0x51badd});}['logWebhookReceived'](_0x4ff88f,_0x3f6bfc,_0x31cd8f){const _0x1d523b=a44_0x24e946;this[_0x1d523b(0x1b8)](_0x1d523b(0x1c4),{'type':_0x1d523b(0x1c7),'gateway':_0x4ff88f,'headers':_0x31cd8f,'data':_0x3f6bfc});}[a44_0x24e946(0x1ea)](_0x3810dd,_0x2851b8,_0x153700,_0x4a5cd6,_0x14545a){const _0x16faae=a44_0x24e946;this[_0x16faae(0x1b8)](_0x16faae(0x1c3),{'type':_0x16faae(0x1e2),'gateway':_0x3810dd,'paymentId':_0x2851b8,'oldStatus':_0x153700,'newStatus':_0x4a5cd6,'originalData':_0x14545a});}['logWebhookError'](_0x513fcb,_0x1f711c,_0x29b7f0){const _0x479d78=a44_0x24e946;this[_0x479d78(0x1b8)](_0x479d78(0x1b6),{'type':_0x479d78(0x1b0),'gateway':_0x513fcb,'error':_0x1f711c instanceof Error?{'message':_0x1f711c['message'],'stack':_0x1f711c[_0x479d78(0x1e9)]}:_0x1f711c,'originalData':_0x29b7f0});}['logShopWebhookSent'](_0x280578,_0x393148,_0x326713,_0x4fdf46,_0x4be90e,_0xd63597){const _0x41fe06=a44_0x24e946;this[_0x41fe06(0x1b8)](_0x41fe06(0x1a8),{'type':_0x41fe06(0x1da),'shopId':_0x280578,'webhookUrl':_0x393148,'event':_0x326713,'status':_0x4fdf46,'responseTime':_0x4be90e,'payload':_0xd63597});}[a44_0x24e946(0x1aa)](_0x5820dd,_0x4d160b,_0x105357,_0x1389e1,_0x442ee6){const _0xfec895=a44_0x24e946;this[_0xfec895(0x1b8)]('shop_webhooks_errors',{'type':'SHOP_WEBHOOK_ERROR','shopId':_0x5820dd,'webhookUrl':_0x4d160b,'event':_0x105357,'error':_0x1389e1 instanceof Error?{'message':_0x1389e1['message'],'stack':_0x1389e1[_0xfec895(0x1e9)]}:_0x1389e1,'payload':_0x442ee6});}['logPaymentCreated'](_0x248c4a,_0x311b90,_0xa792b5,_0x552c6c,_0x40b0b3){const _0x55fec=a44_0x24e946;this[_0x55fec(0x1b8)](_0x55fec(0x1ab),{'type':_0x55fec(0x1af),'gateway':_0x248c4a,'paymentId':_0x311b90,'shopId':_0xa792b5,'amount':_0x552c6c,'currency':_0x40b0b3});}['logApiCall'](_0x6448b0,_0x5830a0,_0x1bbb83,_0x56405e,_0x1fe838){const _0x5a7752=a44_0x24e946;this['writeLog']('api_calls',{'type':_0x5a7752(0x1e0),'endpoint':_0x6448b0,'method':_0x5830a0,'userId':_0x1bbb83,'userRole':_0x56405e,'requestData':_0x1fe838});}[a44_0x24e946(0x1db)](){const _0x75d9a1=a44_0x24e946;try{const _0x627c8a=fs_1[_0x75d9a1(0x1d0)][_0x75d9a1(0x1d8)](this[_0x75d9a1(0x1cd)]),_0x2ef6f5=_0x627c8a[_0x75d9a1(0x1e3)](_0x1a85de=>_0x1a85de['endsWith']('.log')),_0x5e785f=[...new Set(_0x2ef6f5[_0x75d9a1(0x1ec)](_0x4426bc=>_0x4426bc['split']('_')[0x0]))],_0x4e8201=_0x2ef6f5['map'](_0x2105cb=>{const _0x243306=_0x75d9a1,_0x2ee3e5=path_1[_0x243306(0x1d0)][_0x243306(0x1a5)](this[_0x243306(0x1cd)],_0x2105cb),_0x472722=fs_1['default'][_0x243306(0x1e7)](_0x2ee3e5),[_0x4e1c51,_0x11f351]=_0x2105cb[_0x243306(0x1b1)]('.log','')[_0x243306(0x1e8)]('_');return{'type':_0x4e1c51,'date':_0x11f351,'size':_0x472722['size']};})[_0x75d9a1(0x1e6)]((_0x27074a,_0x11e4c7)=>_0x11e4c7[_0x75d9a1(0x1d3)][_0x75d9a1(0x1d5)](_0x27074a[_0x75d9a1(0x1d3)]));return{'totalFiles':_0x2ef6f5['length'],'logTypes':_0x5e785f,'latestLogs':_0x4e8201[_0x75d9a1(0x1d6)](0x0,0xa)};}catch(_0x36af1b){return console[_0x75d9a1(0x1de)]('Failed\x20to\x20get\x20log\x20stats:',_0x36af1b),{'totalFiles':0x0,'logTypes':[],'latestLogs':[]};}}[a44_0x24e946(0x1ad)](_0x47d18d=0x1e){const _0x164d5e=a44_0x24e946;try{const _0xf61093=fs_1[_0x164d5e(0x1d0)][_0x164d5e(0x1d8)](this[_0x164d5e(0x1cd)]),_0x16dc7a=new Date();_0x16dc7a[_0x164d5e(0x1a9)](_0x16dc7a[_0x164d5e(0x1c5)]()-_0x47d18d);let _0x1449fe=0x0;_0xf61093[_0x164d5e(0x1c1)](_0x290da5=>{const _0x3fc52b=_0x164d5e;if(!_0x290da5[_0x3fc52b(0x1ce)](_0x3fc52b(0x1d2)))return;const _0x100dcf=path_1[_0x3fc52b(0x1d0)][_0x3fc52b(0x1a5)](this['logsDir'],_0x290da5),_0xfe880a=fs_1[_0x3fc52b(0x1d0)][_0x3fc52b(0x1e7)](_0x100dcf);_0xfe880a['mtime']<_0x16dc7a&&(fs_1[_0x3fc52b(0x1d0)]['unlinkSync'](_0x100dcf),_0x1449fe++,console[_0x3fc52b(0x1bb)]('ðŸ—‘ï¸\x20Deleted\x20old\x20log\x20file:\x20'+_0x290da5));}),console[_0x164d5e(0x1bb)](_0x164d5e(0x1ba)+_0x1449fe+_0x164d5e(0x1e5)+_0x47d18d+_0x164d5e(0x1cf));}catch(_0x3a4fce){console[_0x164d5e(0x1de)](_0x164d5e(0x1a6),_0x3a4fce);}}}exports[a44_0x24e946(0x1b7)]=LoggerService,exports[a44_0x24e946(0x1df)]=new LoggerService();