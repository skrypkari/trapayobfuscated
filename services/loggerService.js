'use strict';const a53_0x28afa3=a53_0x59da;(function(_0x459c98,_0x59e09f){const _0x15a2ca=a53_0x59da,_0x5d666f=_0x459c98();while(!![]){try{const _0x26819f=parseInt(_0x15a2ca(0x1ca))/0x1*(parseInt(_0x15a2ca(0x1a7))/0x2)+-parseInt(_0x15a2ca(0x187))/0x3*(parseInt(_0x15a2ca(0x1a8))/0x4)+-parseInt(_0x15a2ca(0x19a))/0x5+-parseInt(_0x15a2ca(0x1ad))/0x6*(-parseInt(_0x15a2ca(0x1c0))/0x7)+-parseInt(_0x15a2ca(0x1a4))/0x8+parseInt(_0x15a2ca(0x17a))/0x9+-parseInt(_0x15a2ca(0x1aa))/0xa*(parseInt(_0x15a2ca(0x188))/0xb);if(_0x26819f===_0x59e09f)break;else _0x5d666f['push'](_0x5d666f['shift']());}catch(_0x1d5494){_0x5d666f['push'](_0x5d666f['shift']());}}}(a53_0x31b8,0x9c180));var __importDefault=this&&this[a53_0x28afa3(0x1a1)]||function(_0x2ba419){return _0x2ba419&&_0x2ba419['__esModule']?_0x2ba419:{'default':_0x2ba419};};Object[a53_0x28afa3(0x1b2)](exports,a53_0x28afa3(0x186),{'value':!![]}),exports[a53_0x28afa3(0x1b7)]=exports[a53_0x28afa3(0x18f)]=void 0x0;const fs_1=__importDefault(require('fs')),path_1=__importDefault(require(a53_0x28afa3(0x1cb)));class LoggerService{constructor(){const _0x3b90e6=a53_0x28afa3;this[_0x3b90e6(0x1a5)]=path_1[_0x3b90e6(0x19b)][_0x3b90e6(0x18a)](process[_0x3b90e6(0x1b1)](),_0x3b90e6(0x179)),this[_0x3b90e6(0x19e)]();}[a53_0x28afa3(0x19e)](){const _0x3b2836=a53_0x28afa3;!fs_1['default'][_0x3b2836(0x198)](this[_0x3b2836(0x1a5)])&&(fs_1[_0x3b2836(0x19b)][_0x3b2836(0x1ce)](this[_0x3b2836(0x1a5)],{'recursive':!![]}),console['log']('📁\x20Created\x20logs\x20directory:\x20'+this[_0x3b2836(0x1a5)]));}[a53_0x28afa3(0x1b4)](_0x325896){const _0x63390d=a53_0x28afa3,_0x4e2803=new Date()[_0x63390d(0x1a2)]()[_0x63390d(0x1c6)]('T')[0x0];return path_1['default'][_0x63390d(0x18a)](this[_0x63390d(0x1a5)],_0x325896+'_'+_0x4e2803+_0x63390d(0x183));}[a53_0x28afa3(0x19f)](_0x4a11cd,_0x10af2c){const _0x91b06c=a53_0x28afa3;try{const _0x508669=new Date()['toISOString'](),_0x249d28={'timestamp':_0x508669,..._0x10af2c},_0x140ec5=JSON[_0x91b06c(0x17b)](_0x249d28)+'\x0a',_0x40c61f=this[_0x91b06c(0x1b4)](_0x4a11cd);fs_1['default']['appendFileSync'](_0x40c61f,_0x140ec5,_0x91b06c(0x1cc));}catch(_0x3adaef){console[_0x91b06c(0x180)]('Failed\x20to\x20write\x20'+_0x4a11cd+_0x91b06c(0x18b),_0x3adaef);}}[a53_0x28afa3(0x184)](_0x5bd10a,_0x2c288f,_0x422cb5,_0x568e08){const _0x2e6624=a53_0x28afa3;this['writeLog'](_0x2e6624(0x1a6),{'type':_0x2e6624(0x1ba),'gateway':_0x5bd10a,'endpoint':_0x2c288f,'method':_0x422cb5,'data':_0x568e08});}[a53_0x28afa3(0x19c)](_0x5fdfb9,_0x4ffd11,_0x43c92e,_0x3c554a,_0x427a0a){const _0xc7e3e0=a53_0x28afa3;this['writeLog'](_0xc7e3e0(0x17f),{'type':_0xc7e3e0(0x1b8),'gateway':_0x5fdfb9,'endpoint':_0x4ffd11,'status':_0x43c92e,'responseTime':_0x427a0a,'data':_0x3c554a});}[a53_0x28afa3(0x18c)](_0x2a3fd9,_0x2fcaf7,_0x23d5eb){const _0x3a248d=a53_0x28afa3;this[_0x3a248d(0x19f)]('white_domain_errors',{'type':_0x3a248d(0x197),'gateway':_0x2a3fd9,'endpoint':_0x2fcaf7,'error':_0x23d5eb instanceof Error?{'message':_0x23d5eb['message'],'stack':_0x23d5eb[_0x3a248d(0x1b3)]}:_0x23d5eb});}[a53_0x28afa3(0x193)](_0x32aeac,_0x126b2d,_0x2af986){const _0x2ab743=a53_0x28afa3;this[_0x2ab743(0x19f)](_0x2ab743(0x190),{'type':_0x2ab743(0x191),'gateway':_0x32aeac,'headers':_0x2af986,'data':_0x126b2d});}[a53_0x28afa3(0x1bc)](_0xfc5883,_0x1ae48b,_0x1e5897,_0x54c9ba,_0x44b7a5){const _0x2533f2=a53_0x28afa3;this[_0x2533f2(0x19f)](_0x2533f2(0x1be),{'type':_0x2533f2(0x182),'gateway':_0xfc5883,'paymentId':_0x1ae48b,'oldStatus':_0x1e5897,'newStatus':_0x54c9ba,'originalData':_0x44b7a5});}[a53_0x28afa3(0x1c3)](_0x45a900,_0x1eb739,_0x3308ab){const _0x2cbde3=a53_0x28afa3;this[_0x2cbde3(0x19f)](_0x2cbde3(0x1c8),{'type':_0x2cbde3(0x1c2),'gateway':_0x45a900,'error':_0x1eb739 instanceof Error?{'message':_0x1eb739['message'],'stack':_0x1eb739['stack']}:_0x1eb739,'originalData':_0x3308ab});}[a53_0x28afa3(0x17e)](_0x583cf2){const _0x26958c=a53_0x28afa3;this[_0x26958c(0x19f)](_0x26958c(0x1cd),{'type':_0x26958c(0x1c4),..._0x583cf2});}[a53_0x28afa3(0x181)](_0x371cad){const _0x3539c3=a53_0x28afa3;this[_0x3539c3(0x19f)]('cointopay_errors',{'type':_0x3539c3(0x1c5),..._0x371cad});}['logShopWebhookSent'](_0x52ef8a,_0x428ab4,_0x3c88b5,_0x35acd5,_0x495db6,_0x59ff78){const _0x378773=a53_0x28afa3;this[_0x378773(0x19f)]('shop_webhooks_sent',{'type':_0x378773(0x1c7),'shopId':_0x52ef8a,'webhookUrl':_0x428ab4,'event':_0x3c88b5,'status':_0x35acd5,'responseTime':_0x495db6,'payload':_0x59ff78});}[a53_0x28afa3(0x1af)](_0x512dbd,_0x49a2b3,_0x52345c,_0x117e99,_0x24d9bc){const _0x1e6164=a53_0x28afa3;this['writeLog'](_0x1e6164(0x1bb),{'type':'SHOP_WEBHOOK_ERROR','shopId':_0x512dbd,'webhookUrl':_0x49a2b3,'event':_0x52345c,'error':_0x117e99 instanceof Error?{'message':_0x117e99['message'],'stack':_0x117e99[_0x1e6164(0x1b3)]}:_0x117e99,'payload':_0x24d9bc});}[a53_0x28afa3(0x1b9)](_0x59353,_0x2b495c,_0x515e87,_0x1968aa,_0x1ea6a0){const _0x1c3914=a53_0x28afa3;this[_0x1c3914(0x19f)](_0x1c3914(0x17c),{'type':_0x1c3914(0x196),'gateway':_0x59353,'paymentId':_0x2b495c,'shopId':_0x515e87,'amount':_0x1968aa,'currency':_0x1ea6a0});}[a53_0x28afa3(0x1a3)](_0x40caec,_0x26487d,_0x46fd21,_0x461888,_0x94f3b5){this['writeLog']('api_calls',{'type':'API_CALL','endpoint':_0x40caec,'method':_0x26487d,'userId':_0x46fd21,'userRole':_0x461888,'requestData':_0x94f3b5});}[a53_0x28afa3(0x1a0)](){const _0x334760=a53_0x28afa3;try{const _0x27a07e=fs_1['default'][_0x334760(0x1bd)](this[_0x334760(0x1a5)]),_0x18ba34=_0x27a07e['filter'](_0x3e31ea=>_0x3e31ea[_0x334760(0x18d)](_0x334760(0x183))),_0x1558ea=[...new Set(_0x18ba34['map'](_0x51b05c=>_0x51b05c[_0x334760(0x1c6)]('_')[0x0]))],_0x2da459=_0x18ba34[_0x334760(0x1b6)](_0x4eb378=>{const _0x342971=_0x334760,_0xe48f46=path_1[_0x342971(0x19b)][_0x342971(0x18a)](this[_0x342971(0x1a5)],_0x4eb378),_0x21531c=fs_1['default'][_0x342971(0x1b5)](_0xe48f46),[_0x3885a9,_0x574182]=_0x4eb378[_0x342971(0x1bf)]('.log','')['split']('_');return{'type':_0x3885a9,'date':_0x574182,'size':_0x21531c['size']};})['sort']((_0x5aea9c,_0x5f107f)=>_0x5f107f[_0x334760(0x1ab)][_0x334760(0x194)](_0x5aea9c[_0x334760(0x1ab)]));return{'totalFiles':_0x18ba34[_0x334760(0x1ae)],'logTypes':_0x1558ea,'latestLogs':_0x2da459[_0x334760(0x1ac)](0x0,0xa)};}catch(_0x283a13){return console[_0x334760(0x180)]('Failed\x20to\x20get\x20log\x20stats:',_0x283a13),{'totalFiles':0x0,'logTypes':[],'latestLogs':[]};}}[a53_0x28afa3(0x1b0)](_0x4e8961=0x1e){const _0x28af51=a53_0x28afa3;try{const _0x1afdf1=fs_1[_0x28af51(0x19b)][_0x28af51(0x1bd)](this['logsDir']),_0x16f8a1=new Date();_0x16f8a1[_0x28af51(0x17d)](_0x16f8a1[_0x28af51(0x189)]()-_0x4e8961);let _0xcb291b=0x0;_0x1afdf1[_0x28af51(0x195)](_0x1a7019=>{const _0x15e921=_0x28af51;if(!_0x1a7019[_0x15e921(0x18d)](_0x15e921(0x183)))return;const _0x3b0945=path_1[_0x15e921(0x19b)][_0x15e921(0x18a)](this[_0x15e921(0x1a5)],_0x1a7019),_0x4ffcab=fs_1[_0x15e921(0x19b)]['statSync'](_0x3b0945);_0x4ffcab[_0x15e921(0x1a9)]<_0x16f8a1&&(fs_1['default'][_0x15e921(0x1c9)](_0x3b0945),_0xcb291b++,console[_0x15e921(0x1c1)](_0x15e921(0x19d)+_0x1a7019));}),console[_0x28af51(0x1c1)](_0x28af51(0x185)+_0xcb291b+_0x28af51(0x18e)+_0x4e8961+_0x28af51(0x199));}catch(_0x246d16){console[_0x28af51(0x180)](_0x28af51(0x192),_0x246d16);}}}function a53_0x59da(_0x38ea39,_0x2fa8e9){const _0x31b81c=a53_0x31b8();return a53_0x59da=function(_0x59daf8,_0x516bbe){_0x59daf8=_0x59daf8-0x179;let _0x331ef0=_0x31b81c[_0x59daf8];return _0x331ef0;},a53_0x59da(_0x38ea39,_0x2fa8e9);}exports[a53_0x28afa3(0x18f)]=LoggerService,exports['loggerService']=new LoggerService();function a53_0x31b8(){const _0x226541=['__esModule','954zvvarK','143VOXOgf','getDate','join','\x20log:','logWhiteDomainError','endsWith','\x20old\x20log\x20files\x20(older\x20than\x20','LoggerService','webhooks_received','WEBHOOK_RECEIVED','Failed\x20to\x20clean\x20old\x20logs:','logWebhookReceived','localeCompare','forEach','PAYMENT_CREATED','ERROR','existsSync','\x20days)','1081870TZAfFb','default','logWhiteDomainResponse','🗑️\x20Deleted\x20old\x20log\x20file:\x20','ensureLogsDirectory','writeLog','getLogStats','__importDefault','toISOString','logApiCall','7414992NDaPPO','logsDir','white_domain_requests','2221132nKbIet','3580FWrmsS','mtime','333070QcJpNJ','date','slice','10572fZVxQV','length','logShopWebhookError','cleanOldLogs','cwd','defineProperty','stack','getLogFileName','statSync','map','loggerService','RESPONSE','logPaymentCreated','REQUEST','shop_webhooks_errors','logWebhookProcessed','readdirSync','webhooks_processed','replace','4613dLLMqE','log','WEBHOOK_ERROR','logWebhookError','COINTOPAY_STATUS_CHANGE','COINTOPAY_ERROR','split','SHOP_WEBHOOK_SENT','webhooks_errors','unlinkSync','1YZPpEu','path','utf8','cointopay_status_changes','mkdirSync','logs','2056365rrhThG','stringify','payments_created','setDate','logCoinToPayStatus','white_domain_responses','error','logCoinToPayError','WEBHOOK_PROCESSED','.log','logWhiteDomainRequest','🧹\x20Cleaned\x20'];a53_0x31b8=function(){return _0x226541;};return a53_0x31b8();}