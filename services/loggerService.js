'use strict';const a48_0x186fc2=a48_0x5d6e;(function(_0x2cccb4,_0x284c15){const _0x4f6c99=a48_0x5d6e,_0x5e4021=_0x2cccb4();while(!![]){try{const _0x2de32d=-parseInt(_0x4f6c99(0x97))/0x1+-parseInt(_0x4f6c99(0xb5))/0x2*(parseInt(_0x4f6c99(0x98))/0x3)+-parseInt(_0x4f6c99(0x87))/0x4+-parseInt(_0x4f6c99(0x8c))/0x5+-parseInt(_0x4f6c99(0x72))/0x6*(-parseInt(_0x4f6c99(0x78))/0x7)+parseInt(_0x4f6c99(0x71))/0x8+-parseInt(_0x4f6c99(0xad))/0x9*(-parseInt(_0x4f6c99(0x9d))/0xa);if(_0x2de32d===_0x284c15)break;else _0x5e4021['push'](_0x5e4021['shift']());}catch(_0x1f9b5c){_0x5e4021['push'](_0x5e4021['shift']());}}}(a48_0x35d6,0x3d9e3));var __importDefault=this&&this['__importDefault']||function(_0x55e3cf){const _0x5094da=a48_0x5d6e;return _0x55e3cf&&_0x55e3cf[_0x5094da(0x77)]?_0x55e3cf:{'default':_0x55e3cf};};Object[a48_0x186fc2(0x7d)](exports,a48_0x186fc2(0x77),{'value':!![]}),exports['loggerService']=exports['LoggerService']=void 0x0;function a48_0x5d6e(_0x3a59ee,_0x5038a9){const _0x35d696=a48_0x35d6();return a48_0x5d6e=function(_0x5d6e60,_0x4f80be){_0x5d6e60=_0x5d6e60-0x6e;let _0x1eb30f=_0x35d696[_0x5d6e60];return _0x1eb30f;},a48_0x5d6e(_0x3a59ee,_0x5038a9);}const fs_1=__importDefault(require('fs')),path_1=__importDefault(require(a48_0x186fc2(0xa7)));class LoggerService{constructor(){const _0x4fe2d2=a48_0x186fc2;this[_0x4fe2d2(0xa6)]=path_1[_0x4fe2d2(0xaa)][_0x4fe2d2(0x7a)](process[_0x4fe2d2(0x73)](),'logs'),this[_0x4fe2d2(0xb7)]();}[a48_0x186fc2(0xb7)](){const _0x36eaf0=a48_0x186fc2;!fs_1[_0x36eaf0(0xaa)][_0x36eaf0(0x75)](this[_0x36eaf0(0xa6)])&&(fs_1[_0x36eaf0(0xaa)]['mkdirSync'](this[_0x36eaf0(0xa6)],{'recursive':!![]}),console[_0x36eaf0(0x8e)](_0x36eaf0(0x91)+this[_0x36eaf0(0xa6)]));}['getLogFileName'](_0x368635){const _0x17fc21=a48_0x186fc2,_0x131196=new Date()[_0x17fc21(0xb1)]()[_0x17fc21(0x9c)]('T')[0x0];return path_1[_0x17fc21(0xaa)][_0x17fc21(0x7a)](this[_0x17fc21(0xa6)],_0x368635+'_'+_0x131196+_0x17fc21(0x70));}['writeLog'](_0xc93cd6,_0x13aadb){const _0x395fba=a48_0x186fc2;try{const _0x1431b3=new Date()[_0x395fba(0xb1)](),_0x1d8c32={'timestamp':_0x1431b3,..._0x13aadb},_0x6c7ef6=JSON[_0x395fba(0x88)](_0x1d8c32)+'\x0a',_0x2a97a2=this['getLogFileName'](_0xc93cd6);fs_1[_0x395fba(0xaa)]['appendFileSync'](_0x2a97a2,_0x6c7ef6,_0x395fba(0x9a));}catch(_0x2ccae5){console[_0x395fba(0xaf)](_0x395fba(0x81)+_0xc93cd6+_0x395fba(0x6e),_0x2ccae5);}}[a48_0x186fc2(0x8a)](_0x4b1009,_0x323d39,_0x4775b1,_0x52eb86){const _0x4b33e6=a48_0x186fc2;this[_0x4b33e6(0xb4)](_0x4b33e6(0x85),{'type':_0x4b33e6(0x99),'gateway':_0x4b1009,'endpoint':_0x323d39,'method':_0x4775b1,'data':_0x52eb86});}[a48_0x186fc2(0x9e)](_0x250061,_0x5da9e8,_0x3c2512,_0x2f3983,_0x5bad03){const _0x50a1f8=a48_0x186fc2;this['writeLog'](_0x50a1f8(0xa2),{'type':_0x50a1f8(0x86),'gateway':_0x250061,'endpoint':_0x5da9e8,'status':_0x3c2512,'responseTime':_0x5bad03,'data':_0x2f3983});}[a48_0x186fc2(0xa1)](_0x195820,_0x1d1826,_0x31173b){const _0x5bc638=a48_0x186fc2;this['writeLog'](_0x5bc638(0xa5),{'type':'ERROR','gateway':_0x195820,'endpoint':_0x1d1826,'error':_0x31173b instanceof Error?{'message':_0x31173b[_0x5bc638(0x9f)],'stack':_0x31173b[_0x5bc638(0x92)]}:_0x31173b});}['logWebhookReceived'](_0x37038d,_0x219ae0,_0x5ed35b){const _0x2dc911=a48_0x186fc2;this[_0x2dc911(0xb4)](_0x2dc911(0xb3),{'type':'WEBHOOK_RECEIVED','gateway':_0x37038d,'headers':_0x5ed35b,'data':_0x219ae0});}[a48_0x186fc2(0x95)](_0x5b13b6,_0x5b1781,_0x31d550,_0x365dd2,_0x2c5fd8){const _0x371bc8=a48_0x186fc2;this['writeLog'](_0x371bc8(0xac),{'type':'WEBHOOK_PROCESSED','gateway':_0x5b13b6,'paymentId':_0x5b1781,'oldStatus':_0x31d550,'newStatus':_0x365dd2,'originalData':_0x2c5fd8});}[a48_0x186fc2(0x7c)](_0x831ab6,_0x29459b,_0x2d9889){const _0x25f5bf=a48_0x186fc2;this[_0x25f5bf(0xb4)]('webhooks_errors',{'type':'WEBHOOK_ERROR','gateway':_0x831ab6,'error':_0x29459b instanceof Error?{'message':_0x29459b['message'],'stack':_0x29459b[_0x25f5bf(0x92)]}:_0x29459b,'originalData':_0x2d9889});}[a48_0x186fc2(0xae)](_0xb12f08){const _0x30e503=a48_0x186fc2;this[_0x30e503(0xb4)](_0x30e503(0x8b),{'type':'COINTOPAY_STATUS_CHANGE',..._0xb12f08});}[a48_0x186fc2(0x83)](_0x1ea0c0){const _0x182b7e=a48_0x186fc2;this['writeLog'](_0x182b7e(0x94),{'type':_0x182b7e(0xa3),..._0x1ea0c0});}[a48_0x186fc2(0xbb)](_0x2cdbfc,_0x4b3f64,_0x5b824a,_0x1527b0,_0x1ece3d,_0x2f700c){const _0x9a4724=a48_0x186fc2;this[_0x9a4724(0xb4)](_0x9a4724(0x84),{'type':'SHOP_WEBHOOK_SENT','shopId':_0x2cdbfc,'webhookUrl':_0x4b3f64,'event':_0x5b824a,'status':_0x1527b0,'responseTime':_0x1ece3d,'payload':_0x2f700c});}[a48_0x186fc2(0xb6)](_0x3c44c9,_0x11f971,_0x26bbcf,_0x5bd9e0,_0x2fb4a3){const _0x31ac90=a48_0x186fc2;this[_0x31ac90(0xb4)]('shop_webhooks_errors',{'type':'SHOP_WEBHOOK_ERROR','shopId':_0x3c44c9,'webhookUrl':_0x11f971,'event':_0x26bbcf,'error':_0x5bd9e0 instanceof Error?{'message':_0x5bd9e0[_0x31ac90(0x9f)],'stack':_0x5bd9e0[_0x31ac90(0x92)]}:_0x5bd9e0,'payload':_0x2fb4a3});}[a48_0x186fc2(0xba)](_0x157f0c,_0x8b7f2e,_0x4c748e,_0x4cf908,_0x276fbf){const _0x55aa04=a48_0x186fc2;this[_0x55aa04(0xb4)](_0x55aa04(0x6f),{'type':_0x55aa04(0xa9),'gateway':_0x157f0c,'paymentId':_0x8b7f2e,'shopId':_0x4c748e,'amount':_0x4cf908,'currency':_0x276fbf});}[a48_0x186fc2(0x7e)](_0x701091,_0x4d4b47,_0xc4792f,_0x16fd7c,_0x5760c5){const _0x514f34=a48_0x186fc2;this[_0x514f34(0xb4)](_0x514f34(0x90),{'type':'API_CALL','endpoint':_0x701091,'method':_0x4d4b47,'userId':_0xc4792f,'userRole':_0x16fd7c,'requestData':_0x5760c5});}['getLogStats'](){const _0x4974a4=a48_0x186fc2;try{const _0x28cffc=fs_1[_0x4974a4(0xaa)][_0x4974a4(0xb2)](this[_0x4974a4(0xa6)]),_0x33964a=_0x28cffc[_0x4974a4(0xa4)](_0x73673c=>_0x73673c[_0x4974a4(0x89)]('.log')),_0x247ee2=[...new Set(_0x33964a[_0x4974a4(0xbc)](_0xd54c84=>_0xd54c84[_0x4974a4(0x9c)]('_')[0x0]))],_0x50a7b3=_0x33964a['map'](_0x530644=>{const _0xc193f5=_0x4974a4,_0x3d7647=path_1['default'][_0xc193f5(0x7a)](this[_0xc193f5(0xa6)],_0x530644),_0x20a3ff=fs_1[_0xc193f5(0xaa)][_0xc193f5(0xa0)](_0x3d7647),[_0x2f3c06,_0x3fe16b]=_0x530644[_0xc193f5(0xbd)](_0xc193f5(0x70),'')[_0xc193f5(0x9c)]('_');return{'type':_0x2f3c06,'date':_0x3fe16b,'size':_0x20a3ff[_0xc193f5(0xb9)]};})[_0x4974a4(0x8f)]((_0x1a8244,_0x9bb58e)=>_0x9bb58e[_0x4974a4(0x9b)][_0x4974a4(0xab)](_0x1a8244[_0x4974a4(0x9b)]));return{'totalFiles':_0x33964a[_0x4974a4(0x82)],'logTypes':_0x247ee2,'latestLogs':_0x50a7b3[_0x4974a4(0xa8)](0x0,0xa)};}catch(_0xefe032){return console[_0x4974a4(0xaf)](_0x4974a4(0x8d),_0xefe032),{'totalFiles':0x0,'logTypes':[],'latestLogs':[]};}}[a48_0x186fc2(0xb8)](_0xef5287=0x1e){const _0x1bbb12=a48_0x186fc2;try{const _0x1f7529=fs_1[_0x1bbb12(0xaa)][_0x1bbb12(0xb2)](this[_0x1bbb12(0xa6)]),_0x1a24ed=new Date();_0x1a24ed[_0x1bbb12(0x80)](_0x1a24ed['getDate']()-_0xef5287);let _0x9199a9=0x0;_0x1f7529['forEach'](_0x252d4c=>{const _0x5ba41d=_0x1bbb12;if(!_0x252d4c[_0x5ba41d(0x89)](_0x5ba41d(0x70)))return;const _0x1f8496=path_1[_0x5ba41d(0xaa)]['join'](this[_0x5ba41d(0xa6)],_0x252d4c),_0xabe2ad=fs_1[_0x5ba41d(0xaa)][_0x5ba41d(0xa0)](_0x1f8496);_0xabe2ad[_0x5ba41d(0x96)]<_0x1a24ed&&(fs_1['default'][_0x5ba41d(0x7b)](_0x1f8496),_0x9199a9++,console[_0x5ba41d(0x8e)](_0x5ba41d(0xb0)+_0x252d4c));}),console[_0x1bbb12(0x8e)](_0x1bbb12(0x93)+_0x9199a9+_0x1bbb12(0x79)+_0xef5287+_0x1bbb12(0x74));}catch(_0x572c85){console[_0x1bbb12(0xaf)](_0x1bbb12(0x7f),_0x572c85);}}}function a48_0x35d6(){const _0x5c3801=['cointopay_status_changes','257370olRFQv','Failed\x20to\x20get\x20log\x20stats:','log','sort','api_calls','📁\x20Created\x20logs\x20directory:\x20','stack','🧹\x20Cleaned\x20','cointopay_errors','logWebhookProcessed','mtime','346144jGthou','735576qKIrHW','REQUEST','utf8','date','split','1340TqXiyi','logWhiteDomainResponse','message','statSync','logWhiteDomainError','white_domain_responses','COINTOPAY_ERROR','filter','white_domain_errors','logsDir','path','slice','PAYMENT_CREATED','default','localeCompare','webhooks_processed','55089giYNYJ','logCoinToPayStatus','error','🗑️\x20Deleted\x20old\x20log\x20file:\x20','toISOString','readdirSync','webhooks_received','writeLog','2IgaUcN','logShopWebhookError','ensureLogsDirectory','cleanOldLogs','size','logPaymentCreated','logShopWebhookSent','map','replace','\x20log:','payments_created','.log','1567968AJGiqi','238002GWBcvm','cwd','\x20days)','existsSync','loggerService','__esModule','7QzfRPS','\x20old\x20log\x20files\x20(older\x20than\x20','join','unlinkSync','logWebhookError','defineProperty','logApiCall','Failed\x20to\x20clean\x20old\x20logs:','setDate','Failed\x20to\x20write\x20','length','logCoinToPayError','shop_webhooks_sent','white_domain_requests','RESPONSE','642720DeXxYX','stringify','endsWith','logWhiteDomainRequest'];a48_0x35d6=function(){return _0x5c3801;};return a48_0x35d6();}exports['LoggerService']=LoggerService,exports[a48_0x186fc2(0x76)]=new LoggerService();