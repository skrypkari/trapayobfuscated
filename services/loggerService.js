'use strict';const a44_0x395713=a44_0x4ee9;(function(_0x23b1f3,_0x273e74){const _0x20b63f=a44_0x4ee9,_0xe23656=_0x23b1f3();while(!![]){try{const _0x6dbfb9=-parseInt(_0x20b63f(0x1e5))/0x1+parseInt(_0x20b63f(0x1dc))/0x2*(-parseInt(_0x20b63f(0x1d5))/0x3)+-parseInt(_0x20b63f(0x1d0))/0x4+parseInt(_0x20b63f(0x1ad))/0x5+-parseInt(_0x20b63f(0x1aa))/0x6*(-parseInt(_0x20b63f(0x1ba))/0x7)+parseInt(_0x20b63f(0x1b9))/0x8*(parseInt(_0x20b63f(0x1ec))/0x9)+parseInt(_0x20b63f(0x1b4))/0xa*(parseInt(_0x20b63f(0x1e3))/0xb);if(_0x6dbfb9===_0x273e74)break;else _0xe23656['push'](_0xe23656['shift']());}catch(_0x1c642b){_0xe23656['push'](_0xe23656['shift']());}}}(a44_0x19df,0xa54cd));var __importDefault=this&&this['__importDefault']||function(_0x43c988){const _0x456bde=a44_0x4ee9;return _0x43c988&&_0x43c988[_0x456bde(0x1be)]?_0x43c988:{'default':_0x43c988};};function a44_0x4ee9(_0x3307d6,_0xde5cda){const _0x19dfbe=a44_0x19df();return a44_0x4ee9=function(_0x4ee999,_0x2e01b7){_0x4ee999=_0x4ee999-0x1a1;let _0x21299a=_0x19dfbe[_0x4ee999];return _0x21299a;},a44_0x4ee9(_0x3307d6,_0xde5cda);}Object['defineProperty'](exports,a44_0x395713(0x1be),{'value':!![]}),exports[a44_0x395713(0x1f0)]=exports[a44_0x395713(0x1e4)]=void 0x0;function a44_0x19df(){const _0x3c777e=['4666480AHRaFS','unlinkSync','size','sort','webhooks_received','setDate','logWebhookProcessed','3545510uaaPrx','WEBHOOK_RECEIVED','getDate','mkdirSync','stringify','168xgNDhN','1960qvudXR','🧹\x20Cleaned\x20','logWebhookError','error','__esModule','\x20days)','.log','RESPONSE','statSync','ensureLogsDirectory','endsWith','getLogFileName','default','replace','REQUEST','forEach','shop_webhooks_sent','date','📁\x20Created\x20logs\x20directory:\x20','logApiCall','webhooks_processed','white_domain_errors','3490328EWBCtq','SHOP_WEBHOOK_SENT','PAYMENT_CREATED','WEBHOOK_ERROR','appendFileSync','52827WyceJT','\x20old\x20log\x20files\x20(older\x20than\x20','Failed\x20to\x20clean\x20old\x20logs:','map','writeLog','length','WEBHOOK_PROCESSED','122YLklVn','readdirSync','\x20log:','cleanOldLogs','path','cointopay_errors','log','22ExoKHi','LoggerService','120881ibqprh','toISOString','utf8','logWhiteDomainRequest','api_calls','logsDir','getLogStats','145647BrxkIT','split','logWhiteDomainResponse','localeCompare','loggerService','Failed\x20to\x20get\x20log\x20stats:','message','stack','logShopWebhookSent','COINTOPAY_ERROR','logPaymentCreated','cointopay_status_changes','API_CALL','logWebhookReceived','join','16338ZsgFNg','cwd','shop_webhooks_errors'];a44_0x19df=function(){return _0x3c777e;};return a44_0x19df();}const fs_1=__importDefault(require('fs')),path_1=__importDefault(require(a44_0x395713(0x1e0)));class LoggerService{constructor(){const _0x5c22ef=a44_0x395713;this['logsDir']=path_1[_0x5c22ef(0x1c6)]['join'](process[_0x5c22ef(0x1ab)](),'logs'),this['ensureLogsDirectory']();}[a44_0x395713(0x1c3)](){const _0x1c145b=a44_0x395713;!fs_1[_0x1c145b(0x1c6)]['existsSync'](this[_0x1c145b(0x1ea)])&&(fs_1[_0x1c145b(0x1c6)][_0x1c145b(0x1b7)](this[_0x1c145b(0x1ea)],{'recursive':!![]}),console[_0x1c145b(0x1e2)](_0x1c145b(0x1cc)+this[_0x1c145b(0x1ea)]));}[a44_0x395713(0x1c5)](_0x144a69){const _0x368b46=a44_0x395713,_0x5e9f0a=new Date()[_0x368b46(0x1e6)]()[_0x368b46(0x1ed)]('T')[0x0];return path_1['default']['join'](this['logsDir'],_0x144a69+'_'+_0x5e9f0a+_0x368b46(0x1c0));}[a44_0x395713(0x1d9)](_0x4da2b1,_0x2bf2da){const _0x1d54ff=a44_0x395713;try{const _0x466d18=new Date()['toISOString'](),_0x2d8a65={'timestamp':_0x466d18,..._0x2bf2da},_0x1cc522=JSON[_0x1d54ff(0x1b8)](_0x2d8a65)+'\x0a',_0x305832=this[_0x1d54ff(0x1c5)](_0x4da2b1);fs_1[_0x1d54ff(0x1c6)][_0x1d54ff(0x1d4)](_0x305832,_0x1cc522,_0x1d54ff(0x1e7));}catch(_0x51f9ba){console[_0x1d54ff(0x1bd)]('Failed\x20to\x20write\x20'+_0x4da2b1+_0x1d54ff(0x1de),_0x51f9ba);}}[a44_0x395713(0x1e8)](_0x33a24b,_0x2b254a,_0x27c00b,_0x5deab7){const _0x3574a0=a44_0x395713;this[_0x3574a0(0x1d9)]('white_domain_requests',{'type':_0x3574a0(0x1c8),'gateway':_0x33a24b,'endpoint':_0x2b254a,'method':_0x27c00b,'data':_0x5deab7});}[a44_0x395713(0x1ee)](_0x311030,_0x2e8165,_0x39adfc,_0x158606,_0x55f39e){const _0x5ac285=a44_0x395713;this[_0x5ac285(0x1d9)]('white_domain_responses',{'type':_0x5ac285(0x1c1),'gateway':_0x311030,'endpoint':_0x2e8165,'status':_0x39adfc,'responseTime':_0x55f39e,'data':_0x158606});}['logWhiteDomainError'](_0x26abce,_0x1f5388,_0x778d3e){const _0x4f9938=a44_0x395713;this[_0x4f9938(0x1d9)](_0x4f9938(0x1cf),{'type':'ERROR','gateway':_0x26abce,'endpoint':_0x1f5388,'error':_0x778d3e instanceof Error?{'message':_0x778d3e[_0x4f9938(0x1a1)],'stack':_0x778d3e[_0x4f9938(0x1a2)]}:_0x778d3e});}[a44_0x395713(0x1a8)](_0x20ffeb,_0x3f9767,_0x649e5d){const _0x3aa258=a44_0x395713;this[_0x3aa258(0x1d9)](_0x3aa258(0x1b1),{'type':_0x3aa258(0x1b5),'gateway':_0x20ffeb,'headers':_0x649e5d,'data':_0x3f9767});}[a44_0x395713(0x1b3)](_0x135842,_0x592c52,_0x485526,_0x522f81,_0x3a4591){const _0x3b86f2=a44_0x395713;this[_0x3b86f2(0x1d9)](_0x3b86f2(0x1ce),{'type':_0x3b86f2(0x1db),'gateway':_0x135842,'paymentId':_0x592c52,'oldStatus':_0x485526,'newStatus':_0x522f81,'originalData':_0x3a4591});}[a44_0x395713(0x1bc)](_0x34f82e,_0x53cf39,_0x25c161){const _0x212241=a44_0x395713;this[_0x212241(0x1d9)]('webhooks_errors',{'type':_0x212241(0x1d3),'gateway':_0x34f82e,'error':_0x53cf39 instanceof Error?{'message':_0x53cf39['message'],'stack':_0x53cf39[_0x212241(0x1a2)]}:_0x53cf39,'originalData':_0x25c161});}['logCoinToPayStatus'](_0x46ebb2){const _0x555bdd=a44_0x395713;this[_0x555bdd(0x1d9)](_0x555bdd(0x1a6),{'type':'COINTOPAY_STATUS_CHANGE',..._0x46ebb2});}['logCoinToPayError'](_0x49282a){const _0x451815=a44_0x395713;this['writeLog'](_0x451815(0x1e1),{'type':_0x451815(0x1a4),..._0x49282a});}[a44_0x395713(0x1a3)](_0x33cd1c,_0x5e1b4e,_0xfbc2e6,_0x180d02,_0x435ed1,_0x552265){const _0x52ab1e=a44_0x395713;this[_0x52ab1e(0x1d9)](_0x52ab1e(0x1ca),{'type':_0x52ab1e(0x1d1),'shopId':_0x33cd1c,'webhookUrl':_0x5e1b4e,'event':_0xfbc2e6,'status':_0x180d02,'responseTime':_0x435ed1,'payload':_0x552265});}['logShopWebhookError'](_0x476349,_0x2e09dd,_0x426c82,_0x474691,_0x1e1419){const _0x1072a5=a44_0x395713;this[_0x1072a5(0x1d9)](_0x1072a5(0x1ac),{'type':'SHOP_WEBHOOK_ERROR','shopId':_0x476349,'webhookUrl':_0x2e09dd,'event':_0x426c82,'error':_0x474691 instanceof Error?{'message':_0x474691[_0x1072a5(0x1a1)],'stack':_0x474691['stack']}:_0x474691,'payload':_0x1e1419});}[a44_0x395713(0x1a5)](_0x1ef68b,_0x157ce5,_0x4f47ff,_0x26b48e,_0xd5c6e9){const _0x1f7097=a44_0x395713;this[_0x1f7097(0x1d9)]('payments_created',{'type':_0x1f7097(0x1d2),'gateway':_0x1ef68b,'paymentId':_0x157ce5,'shopId':_0x4f47ff,'amount':_0x26b48e,'currency':_0xd5c6e9});}[a44_0x395713(0x1cd)](_0x3e9b99,_0x25fd13,_0x2f50de,_0x4eb8ae,_0x4a7811){const _0x83c94c=a44_0x395713;this[_0x83c94c(0x1d9)](_0x83c94c(0x1e9),{'type':_0x83c94c(0x1a7),'endpoint':_0x3e9b99,'method':_0x25fd13,'userId':_0x2f50de,'userRole':_0x4eb8ae,'requestData':_0x4a7811});}[a44_0x395713(0x1eb)](){const _0x59f78d=a44_0x395713;try{const _0x2a7cb5=fs_1['default'][_0x59f78d(0x1dd)](this[_0x59f78d(0x1ea)]),_0x362733=_0x2a7cb5['filter'](_0x459371=>_0x459371[_0x59f78d(0x1c4)](_0x59f78d(0x1c0))),_0x1c41dc=[...new Set(_0x362733[_0x59f78d(0x1d8)](_0x328b9b=>_0x328b9b['split']('_')[0x0]))],_0x214a25=_0x362733[_0x59f78d(0x1d8)](_0x4531d4=>{const _0x583b70=_0x59f78d,_0x1f3cc4=path_1[_0x583b70(0x1c6)]['join'](this[_0x583b70(0x1ea)],_0x4531d4),_0x58ed5f=fs_1[_0x583b70(0x1c6)]['statSync'](_0x1f3cc4),[_0x41eeed,_0x4e8041]=_0x4531d4[_0x583b70(0x1c7)](_0x583b70(0x1c0),'')['split']('_');return{'type':_0x41eeed,'date':_0x4e8041,'size':_0x58ed5f[_0x583b70(0x1af)]};})[_0x59f78d(0x1b0)]((_0x10de74,_0x256d66)=>_0x256d66[_0x59f78d(0x1cb)][_0x59f78d(0x1ef)](_0x10de74['date']));return{'totalFiles':_0x362733[_0x59f78d(0x1da)],'logTypes':_0x1c41dc,'latestLogs':_0x214a25['slice'](0x0,0xa)};}catch(_0x538b33){return console['error'](_0x59f78d(0x1f1),_0x538b33),{'totalFiles':0x0,'logTypes':[],'latestLogs':[]};}}[a44_0x395713(0x1df)](_0x43a945=0x1e){const _0x2aca69=a44_0x395713;try{const _0xed60c8=fs_1[_0x2aca69(0x1c6)]['readdirSync'](this[_0x2aca69(0x1ea)]),_0x56f604=new Date();_0x56f604[_0x2aca69(0x1b2)](_0x56f604[_0x2aca69(0x1b6)]()-_0x43a945);let _0x3c73a5=0x0;_0xed60c8[_0x2aca69(0x1c9)](_0x2d8523=>{const _0x45e094=_0x2aca69;if(!_0x2d8523[_0x45e094(0x1c4)](_0x45e094(0x1c0)))return;const _0x104da6=path_1[_0x45e094(0x1c6)][_0x45e094(0x1a9)](this[_0x45e094(0x1ea)],_0x2d8523),_0x2d936b=fs_1[_0x45e094(0x1c6)][_0x45e094(0x1c2)](_0x104da6);_0x2d936b['mtime']<_0x56f604&&(fs_1[_0x45e094(0x1c6)][_0x45e094(0x1ae)](_0x104da6),_0x3c73a5++,console['log']('🗑️\x20Deleted\x20old\x20log\x20file:\x20'+_0x2d8523));}),console[_0x2aca69(0x1e2)](_0x2aca69(0x1bb)+_0x3c73a5+_0x2aca69(0x1d6)+_0x43a945+_0x2aca69(0x1bf));}catch(_0x245626){console[_0x2aca69(0x1bd)](_0x2aca69(0x1d7),_0x245626);}}}exports[a44_0x395713(0x1e4)]=LoggerService,exports['loggerService']=new LoggerService();