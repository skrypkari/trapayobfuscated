'use strict';function a59_0x5b53(_0x7eb50d,_0x25c721){const _0x3f84c3=a59_0x3f84();return a59_0x5b53=function(_0x5b5359,_0x2c55cd){_0x5b5359=_0x5b5359-0x74;let _0x184923=_0x3f84c3[_0x5b5359];return _0x184923;},a59_0x5b53(_0x7eb50d,_0x25c721);}const a59_0x18dc31=a59_0x5b53;(function(_0x59b0ea,_0x1eccf0){const _0x29098f=a59_0x5b53,_0x57f049=_0x59b0ea();while(!![]){try{const _0x40e15d=parseInt(_0x29098f(0xa7))/0x1*(parseInt(_0x29098f(0xaa))/0x2)+parseInt(_0x29098f(0xc5))/0x3+parseInt(_0x29098f(0x7a))/0x4*(parseInt(_0x29098f(0xc1))/0x5)+parseInt(_0x29098f(0xa2))/0x6+parseInt(_0x29098f(0x87))/0x7+parseInt(_0x29098f(0x75))/0x8+-parseInt(_0x29098f(0xc7))/0x9*(parseInt(_0x29098f(0x9c))/0xa);if(_0x40e15d===_0x1eccf0)break;else _0x57f049['push'](_0x57f049['shift']());}catch(_0x53511a){_0x57f049['push'](_0x57f049['shift']());}}}(a59_0x3f84,0x9171b));var __importDefault=this&&this[a59_0x18dc31(0x91)]||function(_0x2de9c1){return _0x2de9c1&&_0x2de9c1['__esModule']?_0x2de9c1:{'default':_0x2de9c1};};Object[a59_0x18dc31(0x84)](exports,a59_0x18dc31(0x7b),{'value':!![]}),exports[a59_0x18dc31(0xbd)]=exports[a59_0x18dc31(0xc2)]=void 0x0;const fs_1=__importDefault(require('fs')),path_1=__importDefault(require(a59_0x18dc31(0xa1)));class LoggerService{constructor(){const _0x274c36=a59_0x18dc31;this[_0x274c36(0xb9)]=path_1[_0x274c36(0x94)]['join'](process[_0x274c36(0x8f)](),_0x274c36(0x9a)),this['ensureLogsDirectory']();}[a59_0x18dc31(0x7d)](){const _0x262b1=a59_0x18dc31;!fs_1[_0x262b1(0x94)][_0x262b1(0x92)](this[_0x262b1(0xb9)])&&(fs_1[_0x262b1(0x94)][_0x262b1(0xb8)](this['logsDir'],{'recursive':!![]}),console[_0x262b1(0xac)](_0x262b1(0xae)+this['logsDir']));}['getLogFileName'](_0xa017b7){const _0x43e0c1=a59_0x18dc31,_0x795398=new Date()[_0x43e0c1(0xc8)]()[_0x43e0c1(0xa5)]('T')[0x0];return path_1[_0x43e0c1(0x94)][_0x43e0c1(0x81)](this['logsDir'],_0xa017b7+'_'+_0x795398+_0x43e0c1(0xa8));}[a59_0x18dc31(0x78)](_0x51f9c8,_0x3ce2c6){const _0xf67c78=a59_0x18dc31;try{const _0x20518c=new Date()[_0xf67c78(0xc8)](),_0x7cb450={'timestamp':_0x20518c,..._0x3ce2c6},_0x3152e1=JSON[_0xf67c78(0x98)](_0x7cb450)+'\x0a',_0x28fef2=this[_0xf67c78(0x86)](_0x51f9c8);fs_1[_0xf67c78(0x94)][_0xf67c78(0x8e)](_0x28fef2,_0x3152e1,_0xf67c78(0x9f));}catch(_0x1c34d1){console[_0xf67c78(0xa9)](_0xf67c78(0x7e)+_0x51f9c8+_0xf67c78(0xc9),_0x1c34d1);}}[a59_0x18dc31(0x89)](_0x5bbbf2,_0x5072a3,_0x34b40c,_0x2547ca){const _0x475dd3=a59_0x18dc31;this[_0x475dd3(0x78)]('white_domain_requests',{'type':_0x475dd3(0xb5),'gateway':_0x5bbbf2,'endpoint':_0x5072a3,'method':_0x34b40c,'data':_0x2547ca});}[a59_0x18dc31(0x96)](_0x5dd1cd,_0xd295c0,_0x5eb31f,_0x2f6fa9,_0x4537cb){const _0x2c1616=a59_0x18dc31;this['writeLog'](_0x2c1616(0xab),{'type':_0x2c1616(0x7c),'gateway':_0x5dd1cd,'endpoint':_0xd295c0,'status':_0x5eb31f,'responseTime':_0x4537cb,'data':_0x2f6fa9});}['logWhiteDomainError'](_0x9e6703,_0x3fcaf1,_0x58d39d){const _0xec2124=a59_0x18dc31;this[_0xec2124(0x78)]('white_domain_errors',{'type':_0xec2124(0xb2),'gateway':_0x9e6703,'endpoint':_0x3fcaf1,'error':_0x58d39d instanceof Error?{'message':_0x58d39d[_0xec2124(0x9d)],'stack':_0x58d39d[_0xec2124(0xc4)]}:_0x58d39d});}['logWebhookReceived'](_0x265427,_0x185362,_0x860590){const _0x40bb14=a59_0x18dc31;this[_0x40bb14(0x78)](_0x40bb14(0xbf),{'type':_0x40bb14(0x79),'gateway':_0x265427,'headers':_0x860590,'data':_0x185362});}[a59_0x18dc31(0xa3)](_0x2f0122,_0x42a861,_0x57e3bd,_0x41b731,_0x40083e){const _0x1aa8c6=a59_0x18dc31;this[_0x1aa8c6(0x78)](_0x1aa8c6(0xce),{'type':'WEBHOOK_PROCESSED','gateway':_0x2f0122,'paymentId':_0x42a861,'oldStatus':_0x57e3bd,'newStatus':_0x41b731,'originalData':_0x40083e});}[a59_0x18dc31(0xb3)](_0x3fc634,_0x3b0cb4,_0x1bc043){const _0x286e9c=a59_0x18dc31;this['writeLog'](_0x286e9c(0xcd),{'type':_0x286e9c(0xc0),'gateway':_0x3fc634,'error':_0x3b0cb4 instanceof Error?{'message':_0x3b0cb4[_0x286e9c(0x9d)],'stack':_0x3b0cb4[_0x286e9c(0xc4)]}:_0x3b0cb4,'originalData':_0x1bc043});}[a59_0x18dc31(0xca)](_0x15e7e4){const _0x479a3b=a59_0x18dc31;this[_0x479a3b(0x78)](_0x479a3b(0xba),{'type':_0x479a3b(0xb6),..._0x15e7e4});}[a59_0x18dc31(0x99)](_0x3af94c){const _0x48c735=a59_0x18dc31;this['writeLog']('cointopay_errors',{'type':_0x48c735(0xb1),..._0x3af94c});}[a59_0x18dc31(0x7f)](_0x41f214,_0xe8008f,_0xa53fd9,_0xbecca6,_0xc18534,_0x28cdd8){const _0x319c3c=a59_0x18dc31;this[_0x319c3c(0x78)](_0x319c3c(0xbe),{'type':_0x319c3c(0x8b),'shopId':_0x41f214,'webhookUrl':_0xe8008f,'event':_0xa53fd9,'status':_0xbecca6,'responseTime':_0xc18534,'payload':_0x28cdd8});}[a59_0x18dc31(0xcb)](_0xfeaf59,_0x17293f,_0x45c377,_0x4c5302,_0x3fb19e){const _0x5b111d=a59_0x18dc31;this['writeLog'](_0x5b111d(0xb7),{'type':_0x5b111d(0xa0),'shopId':_0xfeaf59,'webhookUrl':_0x17293f,'event':_0x45c377,'error':_0x4c5302 instanceof Error?{'message':_0x4c5302[_0x5b111d(0x9d)],'stack':_0x4c5302[_0x5b111d(0xc4)]}:_0x4c5302,'payload':_0x3fb19e});}[a59_0x18dc31(0xcc)](_0x58f058,_0x52aff4,_0x38090c,_0x3c0e9d,_0x3bed6b){const _0x1ebae4=a59_0x18dc31;this[_0x1ebae4(0x78)](_0x1ebae4(0x8c),{'type':'PAYMENT_CREATED','gateway':_0x58f058,'paymentId':_0x52aff4,'shopId':_0x38090c,'amount':_0x3c0e9d,'currency':_0x3bed6b});}[a59_0x18dc31(0x83)](_0x109d46,_0x32dfba,_0x17853a,_0x18ab5a,_0x4a5170){const _0x26720e=a59_0x18dc31;this[_0x26720e(0x78)](_0x26720e(0x80),{'type':_0x26720e(0xaf),'endpoint':_0x109d46,'method':_0x32dfba,'userId':_0x17853a,'userRole':_0x18ab5a,'requestData':_0x4a5170});}[a59_0x18dc31(0x8a)](){const _0x6430ff=a59_0x18dc31;try{const _0x5d10d3=fs_1[_0x6430ff(0x94)][_0x6430ff(0x74)](this[_0x6430ff(0xb9)]),_0x1a6d98=_0x5d10d3[_0x6430ff(0x77)](_0x4e1c70=>_0x4e1c70[_0x6430ff(0x90)]('.log')),_0x4962e4=[...new Set(_0x1a6d98[_0x6430ff(0xc6)](_0xbb0071=>_0xbb0071[_0x6430ff(0xa5)]('_')[0x0]))],_0x1849f4=_0x1a6d98[_0x6430ff(0xc6)](_0x5e0ba1=>{const _0x5a0756=_0x6430ff,_0x3829e4=path_1[_0x5a0756(0x94)][_0x5a0756(0x81)](this[_0x5a0756(0xb9)],_0x5e0ba1),_0x112226=fs_1[_0x5a0756(0x94)]['statSync'](_0x3829e4),[_0x1c5603,_0x2899c3]=_0x5e0ba1[_0x5a0756(0xa4)](_0x5a0756(0xa8),'')[_0x5a0756(0xa5)]('_');return{'type':_0x1c5603,'date':_0x2899c3,'size':_0x112226[_0x5a0756(0x9e)]};})[_0x6430ff(0x88)]((_0xca86e5,_0x5d5f48)=>_0x5d5f48[_0x6430ff(0xb0)][_0x6430ff(0x93)](_0xca86e5[_0x6430ff(0xb0)]));return{'totalFiles':_0x1a6d98['length'],'logTypes':_0x4962e4,'latestLogs':_0x1849f4[_0x6430ff(0x85)](0x0,0xa)};}catch(_0x400b67){return console[_0x6430ff(0xa9)](_0x6430ff(0xbc),_0x400b67),{'totalFiles':0x0,'logTypes':[],'latestLogs':[]};}}[a59_0x18dc31(0x82)](_0x48d15c=0x1e){const _0x464186=a59_0x18dc31;try{const _0x3a7bbc=fs_1['default'][_0x464186(0x74)](this[_0x464186(0xb9)]),_0x2d7597=new Date();_0x2d7597[_0x464186(0xa6)](_0x2d7597[_0x464186(0x8d)]()-_0x48d15c);let _0x581b46=0x0;_0x3a7bbc[_0x464186(0xad)](_0x3f1b90=>{const _0x556499=_0x464186;if(!_0x3f1b90[_0x556499(0x90)](_0x556499(0xa8)))return;const _0x4d939d=path_1[_0x556499(0x94)]['join'](this['logsDir'],_0x3f1b90),_0x499612=fs_1['default'][_0x556499(0x97)](_0x4d939d);_0x499612[_0x556499(0xc3)]<_0x2d7597&&(fs_1[_0x556499(0x94)][_0x556499(0x95)](_0x4d939d),_0x581b46++,console[_0x556499(0xac)](_0x556499(0x76)+_0x3f1b90));}),console['log'](_0x464186(0xbb)+_0x581b46+_0x464186(0xb4)+_0x48d15c+'\x20days)');}catch(_0x590f8a){console[_0x464186(0xa9)](_0x464186(0x9b),_0x590f8a);}}}exports['LoggerService']=LoggerService,exports[a59_0x18dc31(0xbd)]=new LoggerService();function a59_0x3f84(){const _0x554bea=['loggerService','shop_webhooks_sent','webhooks_received','WEBHOOK_ERROR','145eAEbtO','LoggerService','mtime','stack','2399007oMsDUU','map','3329037ohxQIy','toISOString','\x20log:','logCoinToPayStatus','logShopWebhookError','logPaymentCreated','webhooks_errors','webhooks_processed','readdirSync','6360992exfzDQ','🗑️\x20Deleted\x20old\x20log\x20file:\x20','filter','writeLog','WEBHOOK_RECEIVED','36812mKFIbP','__esModule','RESPONSE','ensureLogsDirectory','Failed\x20to\x20write\x20','logShopWebhookSent','api_calls','join','cleanOldLogs','logApiCall','defineProperty','slice','getLogFileName','4652389MvQzZE','sort','logWhiteDomainRequest','getLogStats','SHOP_WEBHOOK_SENT','payments_created','getDate','appendFileSync','cwd','endsWith','__importDefault','existsSync','localeCompare','default','unlinkSync','logWhiteDomainResponse','statSync','stringify','logCoinToPayError','logs','Failed\x20to\x20clean\x20old\x20logs:','90BgWUKD','message','size','utf8','SHOP_WEBHOOK_ERROR','path','4746900lgeVgu','logWebhookProcessed','replace','split','setDate','607319BLbuXr','.log','error','2LsSiiB','white_domain_responses','log','forEach','📁\x20Created\x20logs\x20directory:\x20','API_CALL','date','COINTOPAY_ERROR','ERROR','logWebhookError','\x20old\x20log\x20files\x20(older\x20than\x20','REQUEST','COINTOPAY_STATUS_CHANGE','shop_webhooks_errors','mkdirSync','logsDir','cointopay_status_changes','🧹\x20Cleaned\x20','Failed\x20to\x20get\x20log\x20stats:'];a59_0x3f84=function(){return _0x554bea;};return a59_0x3f84();}