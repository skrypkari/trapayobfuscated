'use strict';function a44_0x1095(){const _0x1aa508=['mkdirSync','6404528qoCCQy','1164671TKgqek','stack','\x20days)','cwd','logWebhookProcessed','existsSync','appendFileSync','18fLAQWO','logPaymentCreated','unlinkSync','cointopay_status_changes','white_domain_errors','31552074IrWnkB','toISOString','message','logWhiteDomainError','webhooks_processed','localeCompare','payments_created','api_calls','SHOP_WEBHOOK_SENT','size','default','RESPONSE','API_CALL','replace','slice','filter','ERROR','ðŸ“\x20Created\x20logs\x20directory:\x20','mtime','white_domain_responses','logWebhookReceived','\x20log:','log','15885VFDVTP','shop_webhooks_sent','logApiCall','stringify','3247408YHaXhR','logCoinToPayError','__importDefault','date','cleanOldLogs','logShopWebhookError','WEBHOOK_RECEIVED','getDate','white_domain_requests','Failed\x20to\x20get\x20log\x20stats:','shop_webhooks_errors','Failed\x20to\x20clean\x20old\x20logs:','__esModule','getLogFileName','readdirSync','split','5rbHLvQ','logsDir','endsWith','COINTOPAY_STATUS_CHANGE','Failed\x20to\x20write\x20','sort','map','SHOP_WEBHOOK_ERROR','9148979nuJOIQ','logShopWebhookSent','forEach','ðŸ—‘ï¸\x20Deleted\x20old\x20log\x20file:\x20','REQUEST','ensureLogsDirectory','.log','WEBHOOK_ERROR','logWhiteDomainResponse','length','logWhiteDomainRequest','COINTOPAY_ERROR','writeLog','LoggerService','loggerService','error','cointopay_errors','join','logs','1625172OpTLok'];a44_0x1095=function(){return _0x1aa508;};return a44_0x1095();}const a44_0x2f2555=a44_0x2112;(function(_0x5c225d,_0x28df78){const _0x22b126=a44_0x2112,_0xeabaf6=_0x5c225d();while(!![]){try{const _0x98be5b=parseInt(_0x22b126(0x1d5))/0x1+-parseInt(_0x22b126(0x1dc))/0x2*(-parseInt(_0x22b126(0x1f8))/0x3)+parseInt(_0x22b126(0x1fc))/0x4+-parseInt(_0x22b126(0x20c))/0x5*(-parseInt(_0x22b126(0x1d2))/0x6)+parseInt(_0x22b126(0x214))/0x7+parseInt(_0x22b126(0x1d4))/0x8+-parseInt(_0x22b126(0x1e1))/0x9;if(_0x98be5b===_0x28df78)break;else _0xeabaf6['push'](_0xeabaf6['shift']());}catch(_0x5ed00f){_0xeabaf6['push'](_0xeabaf6['shift']());}}}(a44_0x1095,0xdaf31));var __importDefault=this&&this[a44_0x2f2555(0x1fe)]||function(_0x4df32f){const _0x5bc3f1=a44_0x2f2555;return _0x4df32f&&_0x4df32f[_0x5bc3f1(0x208)]?_0x4df32f:{'default':_0x4df32f};};function a44_0x2112(_0x19ff2a,_0xdafc47){const _0x10957a=a44_0x1095();return a44_0x2112=function(_0x2112ea,_0x5eb8fc){_0x2112ea=_0x2112ea-0x1d1;let _0x43a0cd=_0x10957a[_0x2112ea];return _0x43a0cd;},a44_0x2112(_0x19ff2a,_0xdafc47);}Object['defineProperty'](exports,'__esModule',{'value':!![]}),exports[a44_0x2f2555(0x222)]=exports[a44_0x2f2555(0x221)]=void 0x0;const fs_1=__importDefault(require('fs')),path_1=__importDefault(require('path'));class LoggerService{constructor(){const _0x335e50=a44_0x2f2555;this[_0x335e50(0x20d)]=path_1[_0x335e50(0x1eb)]['join'](process[_0x335e50(0x1d8)](),_0x335e50(0x1d1)),this['ensureLogsDirectory']();}[a44_0x2f2555(0x219)](){const _0x46b408=a44_0x2f2555;!fs_1[_0x46b408(0x1eb)][_0x46b408(0x1da)](this[_0x46b408(0x20d)])&&(fs_1[_0x46b408(0x1eb)][_0x46b408(0x1d3)](this['logsDir'],{'recursive':!![]}),console[_0x46b408(0x1f7)](_0x46b408(0x1f2)+this[_0x46b408(0x20d)]));}[a44_0x2f2555(0x209)](_0x32bb46){const _0x4dde5a=a44_0x2f2555,_0x1fdb5e=new Date()[_0x4dde5a(0x1e2)]()[_0x4dde5a(0x20b)]('T')[0x0];return path_1[_0x4dde5a(0x1eb)]['join'](this[_0x4dde5a(0x20d)],_0x32bb46+'_'+_0x1fdb5e+_0x4dde5a(0x21a));}[a44_0x2f2555(0x220)](_0x3cf3f8,_0x23fa0f){const _0xdc5a83=a44_0x2f2555;try{const _0x14f98f=new Date()[_0xdc5a83(0x1e2)](),_0x4d0957={'timestamp':_0x14f98f,..._0x23fa0f},_0x579c1a=JSON[_0xdc5a83(0x1fb)](_0x4d0957)+'\x0a',_0x44d069=this[_0xdc5a83(0x209)](_0x3cf3f8);fs_1[_0xdc5a83(0x1eb)][_0xdc5a83(0x1db)](_0x44d069,_0x579c1a,'utf8');}catch(_0x1598b3){console[_0xdc5a83(0x223)](_0xdc5a83(0x210)+_0x3cf3f8+_0xdc5a83(0x1f6),_0x1598b3);}}[a44_0x2f2555(0x21e)](_0x52b686,_0x3373a8,_0x4ec6a9,_0x4be6d4){const _0x1a7dc5=a44_0x2f2555;this[_0x1a7dc5(0x220)](_0x1a7dc5(0x204),{'type':_0x1a7dc5(0x218),'gateway':_0x52b686,'endpoint':_0x3373a8,'method':_0x4ec6a9,'data':_0x4be6d4});}[a44_0x2f2555(0x21c)](_0x1f26dd,_0x45f620,_0x583248,_0xc987a7,_0x256bdf){const _0x2225b7=a44_0x2f2555;this['writeLog'](_0x2225b7(0x1f4),{'type':_0x2225b7(0x1ec),'gateway':_0x1f26dd,'endpoint':_0x45f620,'status':_0x583248,'responseTime':_0x256bdf,'data':_0xc987a7});}[a44_0x2f2555(0x1e4)](_0x1caa57,_0xac6033,_0x29d730){const _0x579979=a44_0x2f2555;this[_0x579979(0x220)](_0x579979(0x1e0),{'type':_0x579979(0x1f1),'gateway':_0x1caa57,'endpoint':_0xac6033,'error':_0x29d730 instanceof Error?{'message':_0x29d730[_0x579979(0x1e3)],'stack':_0x29d730['stack']}:_0x29d730});}[a44_0x2f2555(0x1f5)](_0x11a2b6,_0x485840,_0x2dfed5){const _0x2f8f4e=a44_0x2f2555;this['writeLog']('webhooks_received',{'type':_0x2f8f4e(0x202),'gateway':_0x11a2b6,'headers':_0x2dfed5,'data':_0x485840});}[a44_0x2f2555(0x1d9)](_0x4626b6,_0x4c04de,_0x3c0143,_0x1022e0,_0x357090){const _0x36f1ea=a44_0x2f2555;this[_0x36f1ea(0x220)](_0x36f1ea(0x1e5),{'type':'WEBHOOK_PROCESSED','gateway':_0x4626b6,'paymentId':_0x4c04de,'oldStatus':_0x3c0143,'newStatus':_0x1022e0,'originalData':_0x357090});}['logWebhookError'](_0x1b40ae,_0x2ae34a,_0x351ede){const _0xad301e=a44_0x2f2555;this[_0xad301e(0x220)]('webhooks_errors',{'type':_0xad301e(0x21b),'gateway':_0x1b40ae,'error':_0x2ae34a instanceof Error?{'message':_0x2ae34a[_0xad301e(0x1e3)],'stack':_0x2ae34a[_0xad301e(0x1d6)]}:_0x2ae34a,'originalData':_0x351ede});}['logCoinToPayStatus'](_0x50a10f){const _0x2b004f=a44_0x2f2555;this[_0x2b004f(0x220)](_0x2b004f(0x1df),{'type':_0x2b004f(0x20f),..._0x50a10f});}[a44_0x2f2555(0x1fd)](_0x77efd){const _0x217f50=a44_0x2f2555;this['writeLog'](_0x217f50(0x224),{'type':_0x217f50(0x21f),..._0x77efd});}[a44_0x2f2555(0x215)](_0x42a3a0,_0x49f646,_0x7fc515,_0x25bdd8,_0xea5909,_0x390492){const _0x185012=a44_0x2f2555;this[_0x185012(0x220)](_0x185012(0x1f9),{'type':_0x185012(0x1e9),'shopId':_0x42a3a0,'webhookUrl':_0x49f646,'event':_0x7fc515,'status':_0x25bdd8,'responseTime':_0xea5909,'payload':_0x390492});}[a44_0x2f2555(0x201)](_0x12c1b6,_0xd9b979,_0x527754,_0x4ffc90,_0x29a36d){const _0x1a0c5e=a44_0x2f2555;this['writeLog'](_0x1a0c5e(0x206),{'type':_0x1a0c5e(0x213),'shopId':_0x12c1b6,'webhookUrl':_0xd9b979,'event':_0x527754,'error':_0x4ffc90 instanceof Error?{'message':_0x4ffc90[_0x1a0c5e(0x1e3)],'stack':_0x4ffc90['stack']}:_0x4ffc90,'payload':_0x29a36d});}[a44_0x2f2555(0x1dd)](_0x424436,_0x1b86bc,_0x4d3d0a,_0x5110dc,_0x43ddf5){const _0x207803=a44_0x2f2555;this[_0x207803(0x220)](_0x207803(0x1e7),{'type':'PAYMENT_CREATED','gateway':_0x424436,'paymentId':_0x1b86bc,'shopId':_0x4d3d0a,'amount':_0x5110dc,'currency':_0x43ddf5});}[a44_0x2f2555(0x1fa)](_0x5e0168,_0xf3ab66,_0x1fb8bc,_0x3aa56b,_0x57b94e){const _0x14dcce=a44_0x2f2555;this[_0x14dcce(0x220)](_0x14dcce(0x1e8),{'type':_0x14dcce(0x1ed),'endpoint':_0x5e0168,'method':_0xf3ab66,'userId':_0x1fb8bc,'userRole':_0x3aa56b,'requestData':_0x57b94e});}['getLogStats'](){const _0x930b11=a44_0x2f2555;try{const _0x21e09e=fs_1[_0x930b11(0x1eb)][_0x930b11(0x20a)](this[_0x930b11(0x20d)]),_0x2a3aed=_0x21e09e[_0x930b11(0x1f0)](_0x5f5c2b=>_0x5f5c2b[_0x930b11(0x20e)](_0x930b11(0x21a))),_0x160fe2=[...new Set(_0x2a3aed[_0x930b11(0x212)](_0x13b357=>_0x13b357[_0x930b11(0x20b)]('_')[0x0]))],_0x473f37=_0x2a3aed[_0x930b11(0x212)](_0x2f42c2=>{const _0x447e9b=_0x930b11,_0x4200fd=path_1['default'][_0x447e9b(0x225)](this[_0x447e9b(0x20d)],_0x2f42c2),_0xdc510f=fs_1[_0x447e9b(0x1eb)]['statSync'](_0x4200fd),[_0x510f48,_0x16b078]=_0x2f42c2[_0x447e9b(0x1ee)](_0x447e9b(0x21a),'')[_0x447e9b(0x20b)]('_');return{'type':_0x510f48,'date':_0x16b078,'size':_0xdc510f[_0x447e9b(0x1ea)]};})[_0x930b11(0x211)]((_0x186ccf,_0x57f570)=>_0x57f570[_0x930b11(0x1ff)][_0x930b11(0x1e6)](_0x186ccf[_0x930b11(0x1ff)]));return{'totalFiles':_0x2a3aed[_0x930b11(0x21d)],'logTypes':_0x160fe2,'latestLogs':_0x473f37[_0x930b11(0x1ef)](0x0,0xa)};}catch(_0x393791){return console[_0x930b11(0x223)](_0x930b11(0x205),_0x393791),{'totalFiles':0x0,'logTypes':[],'latestLogs':[]};}}[a44_0x2f2555(0x200)](_0x135b89=0x1e){const _0x34d785=a44_0x2f2555;try{const _0x452c71=fs_1['default'][_0x34d785(0x20a)](this['logsDir']),_0x49b9d6=new Date();_0x49b9d6['setDate'](_0x49b9d6[_0x34d785(0x203)]()-_0x135b89);let _0x161358=0x0;_0x452c71[_0x34d785(0x216)](_0x2266e1=>{const _0x5acfbb=_0x34d785;if(!_0x2266e1[_0x5acfbb(0x20e)](_0x5acfbb(0x21a)))return;const _0x701a4a=path_1[_0x5acfbb(0x1eb)][_0x5acfbb(0x225)](this[_0x5acfbb(0x20d)],_0x2266e1),_0x24a1c8=fs_1[_0x5acfbb(0x1eb)]['statSync'](_0x701a4a);_0x24a1c8[_0x5acfbb(0x1f3)]<_0x49b9d6&&(fs_1[_0x5acfbb(0x1eb)][_0x5acfbb(0x1de)](_0x701a4a),_0x161358++,console[_0x5acfbb(0x1f7)](_0x5acfbb(0x217)+_0x2266e1));}),console['log']('ðŸ§¹\x20Cleaned\x20'+_0x161358+'\x20old\x20log\x20files\x20(older\x20than\x20'+_0x135b89+_0x34d785(0x1d7));}catch(_0x1f0832){console['error'](_0x34d785(0x207),_0x1f0832);}}}exports[a44_0x2f2555(0x221)]=LoggerService,exports[a44_0x2f2555(0x222)]=new LoggerService();