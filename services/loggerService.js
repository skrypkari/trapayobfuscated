'use strict';function a48_0x4ec5(_0x417529,_0x44ff00){const _0x24029f=a48_0x2402();return a48_0x4ec5=function(_0x4ec591,_0x4a4bd3){_0x4ec591=_0x4ec591-0x147;let _0x400652=_0x24029f[_0x4ec591];return _0x400652;},a48_0x4ec5(_0x417529,_0x44ff00);}const a48_0x39af58=a48_0x4ec5;(function(_0x254438,_0x4af0cf){const _0x27d890=a48_0x4ec5,_0x281a25=_0x254438();while(!![]){try{const _0xea0803=-parseInt(_0x27d890(0x16a))/0x1+parseInt(_0x27d890(0x188))/0x2*(parseInt(_0x27d890(0x16d))/0x3)+-parseInt(_0x27d890(0x190))/0x4*(-parseInt(_0x27d890(0x185))/0x5)+-parseInt(_0x27d890(0x161))/0x6+parseInt(_0x27d890(0x17f))/0x7*(parseInt(_0x27d890(0x17c))/0x8)+-parseInt(_0x27d890(0x178))/0x9+-parseInt(_0x27d890(0x176))/0xa*(-parseInt(_0x27d890(0x164))/0xb);if(_0xea0803===_0x4af0cf)break;else _0x281a25['push'](_0x281a25['shift']());}catch(_0x380eca){_0x281a25['push'](_0x281a25['shift']());}}}(a48_0x2402,0xe49af));var __importDefault=this&&this['__importDefault']||function(_0x22204b){return _0x22204b&&_0x22204b['__esModule']?_0x22204b:{'default':_0x22204b};};Object['defineProperty'](exports,a48_0x39af58(0x15f),{'value':!![]}),exports[a48_0x39af58(0x15a)]=exports[a48_0x39af58(0x186)]=void 0x0;const fs_1=__importDefault(require('fs')),path_1=__importDefault(require(a48_0x39af58(0x167)));class LoggerService{constructor(){const _0x10f749=a48_0x39af58;this[_0x10f749(0x180)]=path_1[_0x10f749(0x159)][_0x10f749(0x155)](process[_0x10f749(0x171)](),_0x10f749(0x150)),this['ensureLogsDirectory']();}[a48_0x39af58(0x194)](){const _0x2df835=a48_0x39af58;!fs_1[_0x2df835(0x159)][_0x2df835(0x187)](this[_0x2df835(0x180)])&&(fs_1['default'][_0x2df835(0x18c)](this[_0x2df835(0x180)],{'recursive':!![]}),console['log'](_0x2df835(0x182)+this[_0x2df835(0x180)]));}['getLogFileName'](_0x5cae7a){const _0x58f459=a48_0x39af58,_0x45bdad=new Date()[_0x58f459(0x14a)]()[_0x58f459(0x149)]('T')[0x0];return path_1['default'][_0x58f459(0x155)](this[_0x58f459(0x180)],_0x5cae7a+'_'+_0x45bdad+_0x58f459(0x196));}[a48_0x39af58(0x160)](_0xff5787,_0x4ad5a8){const _0x5ae6f3=a48_0x39af58;try{const _0x58f000=new Date()[_0x5ae6f3(0x14a)](),_0x1951a2={'timestamp':_0x58f000,..._0x4ad5a8},_0x48da20=JSON[_0x5ae6f3(0x15b)](_0x1951a2)+'\x0a',_0x375904=this[_0x5ae6f3(0x156)](_0xff5787);fs_1[_0x5ae6f3(0x159)][_0x5ae6f3(0x165)](_0x375904,_0x48da20,_0x5ae6f3(0x172));}catch(_0x10a44d){console['error']('Failed\x20to\x20write\x20'+_0xff5787+_0x5ae6f3(0x15e),_0x10a44d);}}[a48_0x39af58(0x189)](_0x97adec,_0x2c547f,_0x2169da,_0x3853e5){const _0x4a28f2=a48_0x39af58;this['writeLog']('white_domain_requests',{'type':_0x4a28f2(0x192),'gateway':_0x97adec,'endpoint':_0x2c547f,'method':_0x2169da,'data':_0x3853e5});}[a48_0x39af58(0x166)](_0xb6546b,_0x16a468,_0x3206f9,_0x2a2a1a,_0x42f48b){const _0x45af06=a48_0x39af58;this[_0x45af06(0x160)]('white_domain_responses',{'type':'RESPONSE','gateway':_0xb6546b,'endpoint':_0x16a468,'status':_0x3206f9,'responseTime':_0x42f48b,'data':_0x2a2a1a});}[a48_0x39af58(0x153)](_0x3488ca,_0x49225e,_0x57c945){const _0x2b02b0=a48_0x39af58;this[_0x2b02b0(0x160)](_0x2b02b0(0x158),{'type':'ERROR','gateway':_0x3488ca,'endpoint':_0x49225e,'error':_0x57c945 instanceof Error?{'message':_0x57c945[_0x2b02b0(0x162)],'stack':_0x57c945['stack']}:_0x57c945});}[a48_0x39af58(0x177)](_0x380fb5,_0x1dd999,_0x4282da){const _0x2e3bff=a48_0x39af58;this[_0x2e3bff(0x160)](_0x2e3bff(0x148),{'type':'WEBHOOK_RECEIVED','gateway':_0x380fb5,'headers':_0x4282da,'data':_0x1dd999});}[a48_0x39af58(0x17d)](_0x5d4779,_0x4086e4,_0x2dc393,_0x564921,_0x3e538a){const _0x283540=a48_0x39af58;this[_0x283540(0x160)](_0x283540(0x14c),{'type':'WEBHOOK_PROCESSED','gateway':_0x5d4779,'paymentId':_0x4086e4,'oldStatus':_0x2dc393,'newStatus':_0x564921,'originalData':_0x3e538a});}[a48_0x39af58(0x17e)](_0x578f0c,_0x4d09b7,_0x3c0b85){const _0x3415c7=a48_0x39af58;this[_0x3415c7(0x160)](_0x3415c7(0x169),{'type':'WEBHOOK_ERROR','gateway':_0x578f0c,'error':_0x4d09b7 instanceof Error?{'message':_0x4d09b7[_0x3415c7(0x162)],'stack':_0x4d09b7[_0x3415c7(0x181)]}:_0x4d09b7,'originalData':_0x3c0b85});}['logCoinToPayStatus'](_0x235184){const _0x129524=a48_0x39af58;this['writeLog']('cointopay_status_changes',{'type':_0x129524(0x18a),..._0x235184});}[a48_0x39af58(0x18b)](_0x38b9d2){const _0x1ebf44=a48_0x39af58;this[_0x1ebf44(0x160)](_0x1ebf44(0x163),{'type':_0x1ebf44(0x14f),..._0x38b9d2});}[a48_0x39af58(0x151)](_0x1e96a2,_0x54b7c3,_0x433fdf,_0x21bced,_0x1eb552,_0x6cce6e){const _0x2ae75c=a48_0x39af58;this[_0x2ae75c(0x160)](_0x2ae75c(0x18d),{'type':_0x2ae75c(0x193),'shopId':_0x1e96a2,'webhookUrl':_0x54b7c3,'event':_0x433fdf,'status':_0x21bced,'responseTime':_0x1eb552,'payload':_0x6cce6e});}[a48_0x39af58(0x157)](_0x11aebc,_0x5d0722,_0x2457ae,_0x2196fc,_0x4c72d3){const _0x4cfcfb=a48_0x39af58;this['writeLog']('shop_webhooks_errors',{'type':_0x4cfcfb(0x170),'shopId':_0x11aebc,'webhookUrl':_0x5d0722,'event':_0x2457ae,'error':_0x2196fc instanceof Error?{'message':_0x2196fc[_0x4cfcfb(0x162)],'stack':_0x2196fc[_0x4cfcfb(0x181)]}:_0x2196fc,'payload':_0x4c72d3});}[a48_0x39af58(0x191)](_0x6b41c8,_0x539b6f,_0x4bbe2e,_0x28d6c5,_0x5c9191){const _0xa4a9da=a48_0x39af58;this[_0xa4a9da(0x160)](_0xa4a9da(0x16f),{'type':'PAYMENT_CREATED','gateway':_0x6b41c8,'paymentId':_0x539b6f,'shopId':_0x4bbe2e,'amount':_0x28d6c5,'currency':_0x5c9191});}[a48_0x39af58(0x154)](_0x53dd63,_0x28d8be,_0x79e4bc,_0x1c9d3a,_0x2eadd5){const _0x5e96ec=a48_0x39af58;this['writeLog'](_0x5e96ec(0x152),{'type':_0x5e96ec(0x18f),'endpoint':_0x53dd63,'method':_0x28d8be,'userId':_0x79e4bc,'userRole':_0x1c9d3a,'requestData':_0x2eadd5});}['getLogStats'](){const _0x2c8395=a48_0x39af58;try{const _0x238810=fs_1[_0x2c8395(0x159)][_0x2c8395(0x14e)](this[_0x2c8395(0x180)]),_0x4a6c10=_0x238810['filter'](_0x3389c0=>_0x3389c0[_0x2c8395(0x16c)](_0x2c8395(0x196))),_0x144e86=[...new Set(_0x4a6c10[_0x2c8395(0x168)](_0x505c9e=>_0x505c9e[_0x2c8395(0x149)]('_')[0x0]))],_0x290797=_0x4a6c10[_0x2c8395(0x168)](_0x3f1303=>{const _0x33fed0=_0x2c8395,_0xf7b958=path_1['default'][_0x33fed0(0x155)](this[_0x33fed0(0x180)],_0x3f1303),_0x5024e5=fs_1[_0x33fed0(0x159)][_0x33fed0(0x184)](_0xf7b958),[_0x5140d1,_0x448c80]=_0x3f1303[_0x33fed0(0x174)]('.log','')[_0x33fed0(0x149)]('_');return{'type':_0x5140d1,'date':_0x448c80,'size':_0x5024e5['size']};})[_0x2c8395(0x14d)]((_0xe2648,_0x282fd2)=>_0x282fd2['date']['localeCompare'](_0xe2648['date']));return{'totalFiles':_0x4a6c10[_0x2c8395(0x15d)],'logTypes':_0x144e86,'latestLogs':_0x290797[_0x2c8395(0x14b)](0x0,0xa)};}catch(_0x3dac71){return console[_0x2c8395(0x17b)](_0x2c8395(0x17a),_0x3dac71),{'totalFiles':0x0,'logTypes':[],'latestLogs':[]};}}[a48_0x39af58(0x179)](_0x355db8=0x1e){const _0xd601bf=a48_0x39af58;try{const _0x1d8944=fs_1[_0xd601bf(0x159)][_0xd601bf(0x14e)](this[_0xd601bf(0x180)]),_0x3d080d=new Date();_0x3d080d[_0xd601bf(0x173)](_0x3d080d[_0xd601bf(0x15c)]()-_0x355db8);let _0x20c695=0x0;_0x1d8944[_0xd601bf(0x183)](_0x418e9f=>{const _0x81fe50=_0xd601bf;if(!_0x418e9f[_0x81fe50(0x16c)](_0x81fe50(0x196)))return;const _0xccd7e=path_1[_0x81fe50(0x159)]['join'](this[_0x81fe50(0x180)],_0x418e9f),_0x142b71=fs_1[_0x81fe50(0x159)][_0x81fe50(0x184)](_0xccd7e);_0x142b71['mtime']<_0x3d080d&&(fs_1[_0x81fe50(0x159)][_0x81fe50(0x18e)](_0xccd7e),_0x20c695++,console[_0x81fe50(0x16b)]('🗑️\x20Deleted\x20old\x20log\x20file:\x20'+_0x418e9f));}),console[_0xd601bf(0x16b)](_0xd601bf(0x175)+_0x20c695+_0xd601bf(0x195)+_0x355db8+_0xd601bf(0x147));}catch(_0x366eb8){console[_0xd601bf(0x17b)](_0xd601bf(0x16e),_0x366eb8);}}}exports[a48_0x39af58(0x186)]=LoggerService,exports[a48_0x39af58(0x15a)]=new LoggerService();function a48_0x2402(){const _0x42a16f=['endsWith','288LDGMmc','Failed\x20to\x20clean\x20old\x20logs:','payments_created','SHOP_WEBHOOK_ERROR','cwd','utf8','setDate','replace','🧹\x20Cleaned\x20','1270gyHQBv','logWebhookReceived','3490479oGQQPq','cleanOldLogs','Failed\x20to\x20get\x20log\x20stats:','error','376iKqLWA','logWebhookProcessed','logWebhookError','136738TpJcBg','logsDir','stack','📁\x20Created\x20logs\x20directory:\x20','forEach','statSync','785khyTBX','LoggerService','existsSync','16696zMHJlD','logWhiteDomainRequest','COINTOPAY_STATUS_CHANGE','logCoinToPayError','mkdirSync','shop_webhooks_sent','unlinkSync','API_CALL','30376xThbGc','logPaymentCreated','REQUEST','SHOP_WEBHOOK_SENT','ensureLogsDirectory','\x20old\x20log\x20files\x20(older\x20than\x20','.log','\x20days)','webhooks_received','split','toISOString','slice','webhooks_processed','sort','readdirSync','COINTOPAY_ERROR','logs','logShopWebhookSent','api_calls','logWhiteDomainError','logApiCall','join','getLogFileName','logShopWebhookError','white_domain_errors','default','loggerService','stringify','getDate','length','\x20log:','__esModule','writeLog','6306624KMoiHg','message','cointopay_errors','15917EIhOjD','appendFileSync','logWhiteDomainResponse','path','map','webhooks_errors','720231HWFjxO','log'];a48_0x2402=function(){return _0x42a16f;};return a48_0x2402();}