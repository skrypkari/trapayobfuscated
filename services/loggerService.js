'use strict';const a67_0x326ede=a67_0x4453;(function(_0x59af65,_0x38592c){const _0x23cada=a67_0x4453,_0x370391=_0x59af65();while(!![]){try{const _0x3b8ab8=-parseInt(_0x23cada(0x112))/0x1+-parseInt(_0x23cada(0x11c))/0x2+-parseInt(_0x23cada(0x118))/0x3*(parseInt(_0x23cada(0x124))/0x4)+parseInt(_0x23cada(0x114))/0x5+parseInt(_0x23cada(0x106))/0x6+-parseInt(_0x23cada(0xff))/0x7+parseInt(_0x23cada(0x111))/0x8*(parseInt(_0x23cada(0xfe))/0x9);if(_0x3b8ab8===_0x38592c)break;else _0x370391['push'](_0x370391['shift']());}catch(_0x512ebe){_0x370391['push'](_0x370391['shift']());}}}(a67_0x1873,0xc2e6d));var __importDefault=this&&this[a67_0x326ede(0x13e)]||function(_0x55779b){return _0x55779b&&_0x55779b['__esModule']?_0x55779b:{'default':_0x55779b};};Object[a67_0x326ede(0xfa)](exports,a67_0x326ede(0xf7),{'value':!![]}),exports['loggerService']=exports[a67_0x326ede(0x12c)]=void 0x0;function a67_0x4453(_0x2c6245,_0x25517c){_0x2c6245=_0x2c6245-0xf1;const _0x187310=a67_0x1873();let _0x445346=_0x187310[_0x2c6245];return _0x445346;}const fs_1=__importDefault(require('fs')),path_1=__importDefault(require('path'));class LoggerService{constructor(){const _0x467fa2=a67_0x326ede;this[_0x467fa2(0x12f)]=path_1['default'][_0x467fa2(0x110)](process[_0x467fa2(0x129)](),'logs'),this['ensureLogsDirectory']();}['ensureLogsDirectory'](){const _0x4ec381=a67_0x326ede;!fs_1[_0x4ec381(0xf4)]['existsSync'](this[_0x4ec381(0x12f)])&&(fs_1[_0x4ec381(0xf4)]['mkdirSync'](this[_0x4ec381(0x12f)],{'recursive':!![]}),console[_0x4ec381(0x10e)](_0x4ec381(0x11b)+this[_0x4ec381(0x12f)]));}[a67_0x326ede(0x12b)](_0x223b54){const _0x19da58=a67_0x326ede,_0xe3ba8c=new Date()[_0x19da58(0x11d)]()['split']('T')[0x0];return path_1['default'][_0x19da58(0x110)](this[_0x19da58(0x12f)],_0x223b54+'_'+_0xe3ba8c+_0x19da58(0x101));}[a67_0x326ede(0x10a)](_0x6596de,_0x401105){const _0x2c59b0=a67_0x326ede;try{const _0x1f3c45=new Date()[_0x2c59b0(0x11d)](),_0x6e74cf={'timestamp':_0x1f3c45,..._0x401105},_0x2a3191=JSON[_0x2c59b0(0x109)](_0x6e74cf)+'\x0a',_0x2ea786=this['getLogFileName'](_0x6596de);fs_1[_0x2c59b0(0xf4)][_0x2c59b0(0x108)](_0x2ea786,_0x2a3191,_0x2c59b0(0x123));}catch(_0x203424){console[_0x2c59b0(0x132)](_0x2c59b0(0x113)+_0x6596de+_0x2c59b0(0x138),_0x203424);}}['logWhiteDomainRequest'](_0x2b1f14,_0x5c2e61,_0xcb9b8b,_0x472150){const _0x108b3e=a67_0x326ede;this['writeLog']('white_domain_requests',{'type':_0x108b3e(0xf8),'gateway':_0x2b1f14,'endpoint':_0x5c2e61,'method':_0xcb9b8b,'data':_0x472150});}[a67_0x326ede(0x10d)](_0xf1efb8,_0x2b3b6d,_0x4c2026,_0x462168,_0x4e31f7){const _0x2a9716=a67_0x326ede;this[_0x2a9716(0x10a)](_0x2a9716(0xf5),{'type':_0x2a9716(0x136),'gateway':_0xf1efb8,'endpoint':_0x2b3b6d,'status':_0x4c2026,'responseTime':_0x4e31f7,'data':_0x462168});}[a67_0x326ede(0x131)](_0x322ec5,_0x4ff9b9,_0x33d717){const _0x2322d8=a67_0x326ede;this['writeLog']('white_domain_errors',{'type':'ERROR','gateway':_0x322ec5,'endpoint':_0x4ff9b9,'error':_0x33d717 instanceof Error?{'message':_0x33d717[_0x2322d8(0x11a)],'stack':_0x33d717[_0x2322d8(0x13c)]}:_0x33d717});}[a67_0x326ede(0xfc)](_0x134c2c,_0xd39553,_0x1a1372){const _0x30d54d=a67_0x326ede;this['writeLog'](_0x30d54d(0x100),{'type':_0x30d54d(0xfb),'gateway':_0x134c2c,'headers':_0x1a1372,'data':_0xd39553});}[a67_0x326ede(0x139)](_0x4bb264,_0x4ec961,_0x2e2bc7,_0x16cdf8,_0x1f8917){const _0x153407=a67_0x326ede;this[_0x153407(0x10a)](_0x153407(0x12a),{'type':_0x153407(0xf6),'gateway':_0x4bb264,'paymentId':_0x4ec961,'oldStatus':_0x2e2bc7,'newStatus':_0x16cdf8,'originalData':_0x1f8917});}[a67_0x326ede(0x116)](_0x16ccd9,_0x5d3801,_0x60b4bf){const _0x16d637=a67_0x326ede;this[_0x16d637(0x10a)](_0x16d637(0x117),{'type':_0x16d637(0x12e),'gateway':_0x16ccd9,'error':_0x5d3801 instanceof Error?{'message':_0x5d3801[_0x16d637(0x11a)],'stack':_0x5d3801[_0x16d637(0x13c)]}:_0x5d3801,'originalData':_0x60b4bf});}['logCoinToPayStatus'](_0x4d6831){const _0x3729ec=a67_0x326ede;this[_0x3729ec(0x10a)](_0x3729ec(0x127),{'type':_0x3729ec(0x10b),..._0x4d6831});}[a67_0x326ede(0x133)](_0x3b86d2){const _0x4d38ea=a67_0x326ede;this[_0x4d38ea(0x10a)](_0x4d38ea(0xfd),{'type':_0x4d38ea(0xf2),..._0x3b86d2});}[a67_0x326ede(0x120)](_0x55a439,_0x596805,_0x5de4f0,_0x348b02,_0x1bb45f,_0x259548){const _0x44d91c=a67_0x326ede;this[_0x44d91c(0x10a)](_0x44d91c(0x125),{'type':'SHOP_WEBHOOK_SENT','shopId':_0x55a439,'webhookUrl':_0x596805,'event':_0x5de4f0,'status':_0x348b02,'responseTime':_0x1bb45f,'payload':_0x259548});}[a67_0x326ede(0x11e)](_0x5f0093,_0x44220b,_0x1a0395,_0x426231,_0x43b119){const _0x2208b4=a67_0x326ede;this['writeLog']('shop_webhooks_errors',{'type':_0x2208b4(0x12d),'shopId':_0x5f0093,'webhookUrl':_0x44220b,'event':_0x1a0395,'error':_0x426231 instanceof Error?{'message':_0x426231[_0x2208b4(0x11a)],'stack':_0x426231['stack']}:_0x426231,'payload':_0x43b119});}[a67_0x326ede(0x126)](_0x2a29c4,_0x592aaf,_0x4cc3da,_0x3a22bc,_0x2059c8){const _0x58dacc=a67_0x326ede;this[_0x58dacc(0x10a)]('payments_created',{'type':_0x58dacc(0x13a),'gateway':_0x2a29c4,'paymentId':_0x592aaf,'shopId':_0x4cc3da,'amount':_0x3a22bc,'currency':_0x2059c8});}[a67_0x326ede(0xf1)](_0x4d4d1a,_0x308a8d,_0x17e3ff,_0x6e97c4,_0x4b35e9){const _0x5d6254=a67_0x326ede;this[_0x5d6254(0x10a)]('api_calls',{'type':_0x5d6254(0x135),'endpoint':_0x4d4d1a,'method':_0x308a8d,'userId':_0x17e3ff,'userRole':_0x6e97c4,'requestData':_0x4b35e9});}['getLogStats'](){const _0x5ca0a5=a67_0x326ede;try{const _0xf53ad3=fs_1[_0x5ca0a5(0xf4)][_0x5ca0a5(0x103)](this[_0x5ca0a5(0x12f)]),_0x48652b=_0xf53ad3[_0x5ca0a5(0x10f)](_0x209612=>_0x209612[_0x5ca0a5(0x122)]('.log')),_0x267dc9=[...new Set(_0x48652b[_0x5ca0a5(0x130)](_0x3f7191=>_0x3f7191['split']('_')[0x0]))],_0x4ea2d6=_0x48652b[_0x5ca0a5(0x130)](_0x3633d2=>{const _0x52db73=_0x5ca0a5,_0x340fdf=path_1[_0x52db73(0xf4)]['join'](this['logsDir'],_0x3633d2),_0xb68748=fs_1[_0x52db73(0xf4)][_0x52db73(0x121)](_0x340fdf),[_0x357241,_0x1d6f1c]=_0x3633d2[_0x52db73(0x119)](_0x52db73(0x101),'')[_0x52db73(0x134)]('_');return{'type':_0x357241,'date':_0x1d6f1c,'size':_0xb68748['size']};})[_0x5ca0a5(0x105)]((_0x33eac4,_0x7143b0)=>_0x7143b0[_0x5ca0a5(0x10c)][_0x5ca0a5(0x13d)](_0x33eac4[_0x5ca0a5(0x10c)]));return{'totalFiles':_0x48652b['length'],'logTypes':_0x267dc9,'latestLogs':_0x4ea2d6['slice'](0x0,0xa)};}catch(_0x5b6f6b){return console[_0x5ca0a5(0x132)]('Failed\x20to\x20get\x20log\x20stats:',_0x5b6f6b),{'totalFiles':0x0,'logTypes':[],'latestLogs':[]};}}[a67_0x326ede(0x128)](_0x38a71c=0x1e){const _0x2d9f2c=a67_0x326ede;try{const _0x5244e5=fs_1[_0x2d9f2c(0xf4)][_0x2d9f2c(0x103)](this[_0x2d9f2c(0x12f)]),_0x1de06c=new Date();_0x1de06c['setDate'](_0x1de06c[_0x2d9f2c(0x107)]()-_0x38a71c);let _0x4ff57f=0x0;_0x5244e5[_0x2d9f2c(0x13b)](_0x18a7a5=>{const _0xd0f77f=_0x2d9f2c;if(!_0x18a7a5[_0xd0f77f(0x122)](_0xd0f77f(0x101)))return;const _0x3ba8ee=path_1[_0xd0f77f(0xf4)][_0xd0f77f(0x110)](this[_0xd0f77f(0x12f)],_0x18a7a5),_0x1b192d=fs_1['default'][_0xd0f77f(0x121)](_0x3ba8ee);_0x1b192d[_0xd0f77f(0xf3)]<_0x1de06c&&(fs_1[_0xd0f77f(0xf4)][_0xd0f77f(0x104)](_0x3ba8ee),_0x4ff57f++,console[_0xd0f77f(0x10e)](_0xd0f77f(0x11f)+_0x18a7a5));}),console[_0x2d9f2c(0x10e)]('ðŸ§¹\x20Cleaned\x20'+_0x4ff57f+_0x2d9f2c(0x137)+_0x38a71c+_0x2d9f2c(0x115));}catch(_0x8608e3){console[_0x2d9f2c(0x132)](_0x2d9f2c(0x102),_0x8608e3);}}}function a67_0x1873(){const _0x131816=['forEach','stack','localeCompare','__importDefault','logApiCall','COINTOPAY_ERROR','mtime','default','white_domain_responses','WEBHOOK_PROCESSED','__esModule','REQUEST','loggerService','defineProperty','WEBHOOK_RECEIVED','logWebhookReceived','cointopay_errors','9taAtuc','2505531hEUAky','webhooks_received','.log','Failed\x20to\x20clean\x20old\x20logs:','readdirSync','unlinkSync','sort','1757964QttsSh','getDate','appendFileSync','stringify','writeLog','COINTOPAY_STATUS_CHANGE','date','logWhiteDomainResponse','log','filter','join','6660008ztiJlt','487548mhbYli','Failed\x20to\x20write\x20','7132475hYcYfK','\x20days)','logWebhookError','webhooks_errors','6yjIdjV','replace','message','ðŸ“\x20Created\x20logs\x20directory:\x20','1126040uplXXp','toISOString','logShopWebhookError','ðŸ—‘ï¸\x20Deleted\x20old\x20log\x20file:\x20','logShopWebhookSent','statSync','endsWith','utf8','690344hTZZTj','shop_webhooks_sent','logPaymentCreated','cointopay_status_changes','cleanOldLogs','cwd','webhooks_processed','getLogFileName','LoggerService','SHOP_WEBHOOK_ERROR','WEBHOOK_ERROR','logsDir','map','logWhiteDomainError','error','logCoinToPayError','split','API_CALL','RESPONSE','\x20old\x20log\x20files\x20(older\x20than\x20','\x20log:','logWebhookProcessed','PAYMENT_CREATED'];a67_0x1873=function(){return _0x131816;};return a67_0x1873();}exports['LoggerService']=LoggerService,exports[a67_0x326ede(0xf9)]=new LoggerService();