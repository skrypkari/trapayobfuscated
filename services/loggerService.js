'use strict';const a52_0x3b920f=a52_0x448b;(function(_0x49daca,_0x4f2573){const _0x5eeb20=a52_0x448b,_0x6ceb01=_0x49daca();while(!![]){try{const _0x8678be=-parseInt(_0x5eeb20(0x1ff))/0x1*(-parseInt(_0x5eeb20(0x1e5))/0x2)+parseInt(_0x5eeb20(0x21d))/0x3*(-parseInt(_0x5eeb20(0x22d))/0x4)+parseInt(_0x5eeb20(0x1e4))/0x5+-parseInt(_0x5eeb20(0x1e7))/0x6*(-parseInt(_0x5eeb20(0x1ed))/0x7)+-parseInt(_0x5eeb20(0x20e))/0x8*(-parseInt(_0x5eeb20(0x204))/0x9)+-parseInt(_0x5eeb20(0x219))/0xa*(parseInt(_0x5eeb20(0x1da))/0xb)+-parseInt(_0x5eeb20(0x1e6))/0xc*(parseInt(_0x5eeb20(0x216))/0xd);if(_0x8678be===_0x4f2573)break;else _0x6ceb01['push'](_0x6ceb01['shift']());}catch(_0x18bf97){_0x6ceb01['push'](_0x6ceb01['shift']());}}}(a52_0x3bf0,0x62f24));var __importDefault=this&&this[a52_0x3b920f(0x22e)]||function(_0x59f52c){const _0x160d2e=a52_0x3b920f;return _0x59f52c&&_0x59f52c[_0x160d2e(0x20a)]?_0x59f52c:{'default':_0x59f52c};};Object[a52_0x3b920f(0x225)](exports,a52_0x3b920f(0x20a),{'value':!![]}),exports[a52_0x3b920f(0x21b)]=exports[a52_0x3b920f(0x1fb)]=void 0x0;const fs_1=__importDefault(require('fs')),path_1=__importDefault(require('path'));class LoggerService{constructor(){const _0xa6b569=a52_0x3b920f;this['logsDir']=path_1[_0xa6b569(0x232)][_0xa6b569(0x211)](process[_0xa6b569(0x1fa)](),_0xa6b569(0x1e2)),this[_0xa6b569(0x217)]();}['ensureLogsDirectory'](){const _0x2c9eca=a52_0x3b920f;!fs_1['default'][_0x2c9eca(0x1fc)](this['logsDir'])&&(fs_1['default'][_0x2c9eca(0x202)](this[_0x2c9eca(0x1db)],{'recursive':!![]}),console[_0x2c9eca(0x209)](_0x2c9eca(0x231)+this[_0x2c9eca(0x1db)]));}['getLogFileName'](_0x1a35dd){const _0x11e907=a52_0x3b920f,_0x2c2f70=new Date()[_0x11e907(0x20c)]()[_0x11e907(0x1eb)]('T')[0x0];return path_1['default'][_0x11e907(0x211)](this[_0x11e907(0x1db)],_0x1a35dd+'_'+_0x2c2f70+_0x11e907(0x1ef));}['writeLog'](_0x2e438b,_0x339e3a){const _0x5b01d6=a52_0x3b920f;try{const _0x51685f=new Date()['toISOString'](),_0x1cefe3={'timestamp':_0x51685f,..._0x339e3a},_0x61bb31=JSON[_0x5b01d6(0x214)](_0x1cefe3)+'\x0a',_0x41dc33=this[_0x5b01d6(0x1f0)](_0x2e438b);fs_1[_0x5b01d6(0x232)]['appendFileSync'](_0x41dc33,_0x61bb31,_0x5b01d6(0x1e0));}catch(_0x5cbf8a){console['error'](_0x5b01d6(0x220)+_0x2e438b+'\x20log:',_0x5cbf8a);}}[a52_0x3b920f(0x1f7)](_0x1acc0d,_0x15cab8,_0xde2a29,_0x1cbcc7){const _0x21ac78=a52_0x3b920f;this[_0x21ac78(0x1df)](_0x21ac78(0x1f9),{'type':_0x21ac78(0x22a),'gateway':_0x1acc0d,'endpoint':_0x15cab8,'method':_0xde2a29,'data':_0x1cbcc7});}[a52_0x3b920f(0x210)](_0x154d71,_0x43795b,_0x1d1cab,_0x25b52d,_0x3eee99){const _0x10410f=a52_0x3b920f;this[_0x10410f(0x1df)](_0x10410f(0x1f1),{'type':_0x10410f(0x20f),'gateway':_0x154d71,'endpoint':_0x43795b,'status':_0x1d1cab,'responseTime':_0x3eee99,'data':_0x25b52d});}[a52_0x3b920f(0x212)](_0x41ffd3,_0x4e83a1,_0x58c4b6){const _0x612b2b=a52_0x3b920f;this['writeLog'](_0x612b2b(0x20b),{'type':_0x612b2b(0x20d),'gateway':_0x41ffd3,'endpoint':_0x4e83a1,'error':_0x58c4b6 instanceof Error?{'message':_0x58c4b6[_0x612b2b(0x223)],'stack':_0x58c4b6[_0x612b2b(0x21a)]}:_0x58c4b6});}[a52_0x3b920f(0x21f)](_0x3371c0,_0x3f9b56,_0x13bfcd){const _0x38b3e3=a52_0x3b920f;this[_0x38b3e3(0x1df)](_0x38b3e3(0x208),{'type':_0x38b3e3(0x206),'gateway':_0x3371c0,'headers':_0x13bfcd,'data':_0x3f9b56});}[a52_0x3b920f(0x1e8)](_0x3602f6,_0x433af6,_0x48c7bd,_0x54a273,_0x184a4e){const _0x3e8b0b=a52_0x3b920f;this[_0x3e8b0b(0x1df)](_0x3e8b0b(0x228),{'type':_0x3e8b0b(0x227),'gateway':_0x3602f6,'paymentId':_0x433af6,'oldStatus':_0x48c7bd,'newStatus':_0x54a273,'originalData':_0x184a4e});}[a52_0x3b920f(0x1ea)](_0x2f5118,_0x385959,_0x1fa041){const _0x50e59f=a52_0x3b920f;this[_0x50e59f(0x1df)](_0x50e59f(0x1e1),{'type':_0x50e59f(0x22f),'gateway':_0x2f5118,'error':_0x385959 instanceof Error?{'message':_0x385959[_0x50e59f(0x223)],'stack':_0x385959['stack']}:_0x385959,'originalData':_0x1fa041});}[a52_0x3b920f(0x1fe)](_0x57285e){const _0x40b51d=a52_0x3b920f;this[_0x40b51d(0x1df)](_0x40b51d(0x1f3),{'type':_0x40b51d(0x1e3),..._0x57285e});}[a52_0x3b920f(0x22c)](_0x27831e){const _0x2f89f5=a52_0x3b920f;this['writeLog'](_0x2f89f5(0x21e),{'type':_0x2f89f5(0x1ec),..._0x27831e});}['logShopWebhookSent'](_0x2e703b,_0x48f2df,_0x2c900a,_0x1cd70b,_0x5586e8,_0x3b099d){const _0xfd3349=a52_0x3b920f;this[_0xfd3349(0x1df)]('shop_webhooks_sent',{'type':'SHOP_WEBHOOK_SENT','shopId':_0x2e703b,'webhookUrl':_0x48f2df,'event':_0x2c900a,'status':_0x1cd70b,'responseTime':_0x5586e8,'payload':_0x3b099d});}[a52_0x3b920f(0x203)](_0x76c934,_0x4ad60d,_0x2b4502,_0x5551ff,_0x533976){const _0x437c7c=a52_0x3b920f;this['writeLog']('shop_webhooks_errors',{'type':_0x437c7c(0x205),'shopId':_0x76c934,'webhookUrl':_0x4ad60d,'event':_0x2b4502,'error':_0x5551ff instanceof Error?{'message':_0x5551ff['message'],'stack':_0x5551ff[_0x437c7c(0x21a)]}:_0x5551ff,'payload':_0x533976});}[a52_0x3b920f(0x224)](_0x12bf6c,_0x54cb65,_0x1ff4f6,_0x5911ae,_0x4d7d20){const _0x171e91=a52_0x3b920f;this[_0x171e91(0x1df)](_0x171e91(0x1f2),{'type':_0x171e91(0x1e9),'gateway':_0x12bf6c,'paymentId':_0x54cb65,'shopId':_0x1ff4f6,'amount':_0x5911ae,'currency':_0x4d7d20});}['logApiCall'](_0x3f36cf,_0x126380,_0x2693e5,_0x1cfafd,_0x1b7927){const _0x288b3e=a52_0x3b920f;this[_0x288b3e(0x1df)]('api_calls',{'type':_0x288b3e(0x1ee),'endpoint':_0x3f36cf,'method':_0x126380,'userId':_0x2693e5,'userRole':_0x1cfafd,'requestData':_0x1b7927});}[a52_0x3b920f(0x221)](){const _0x4625e8=a52_0x3b920f;try{const _0x19079e=fs_1['default'][_0x4625e8(0x218)](this[_0x4625e8(0x1db)]),_0x35e8f1=_0x19079e[_0x4625e8(0x1dd)](_0x2591aa=>_0x2591aa[_0x4625e8(0x1f6)](_0x4625e8(0x1ef))),_0x5eb127=[...new Set(_0x35e8f1[_0x4625e8(0x21c)](_0x43d9db=>_0x43d9db[_0x4625e8(0x1eb)]('_')[0x0]))],_0x988cb1=_0x35e8f1[_0x4625e8(0x21c)](_0xc274b2=>{const _0x5dd92e=_0x4625e8,_0x50b90a=path_1['default'][_0x5dd92e(0x211)](this[_0x5dd92e(0x1db)],_0xc274b2),_0x3c17dd=fs_1[_0x5dd92e(0x232)][_0x5dd92e(0x222)](_0x50b90a),[_0x31e87f,_0x150ae4]=_0xc274b2['replace']('.log','')['split']('_');return{'type':_0x31e87f,'date':_0x150ae4,'size':_0x3c17dd['size']};})['sort']((_0x42d904,_0x541ec7)=>_0x541ec7[_0x4625e8(0x215)][_0x4625e8(0x207)](_0x42d904[_0x4625e8(0x215)]));return{'totalFiles':_0x35e8f1['length'],'logTypes':_0x5eb127,'latestLogs':_0x988cb1[_0x4625e8(0x213)](0x0,0xa)};}catch(_0x4e9c00){return console[_0x4625e8(0x1f8)](_0x4625e8(0x226),_0x4e9c00),{'totalFiles':0x0,'logTypes':[],'latestLogs':[]};}}[a52_0x3b920f(0x200)](_0x4f1451=0x1e){const _0x80e8e8=a52_0x3b920f;try{const _0x2306e0=fs_1['default'][_0x80e8e8(0x218)](this[_0x80e8e8(0x1db)]),_0x366886=new Date();_0x366886[_0x80e8e8(0x1de)](_0x366886[_0x80e8e8(0x1f5)]()-_0x4f1451);let _0x5d4470=0x0;_0x2306e0[_0x80e8e8(0x1fd)](_0x3dd65e=>{const _0x59badd=_0x80e8e8;if(!_0x3dd65e[_0x59badd(0x1f6)]('.log'))return;const _0x39b6e8=path_1[_0x59badd(0x232)][_0x59badd(0x211)](this[_0x59badd(0x1db)],_0x3dd65e),_0x459b8a=fs_1[_0x59badd(0x232)][_0x59badd(0x222)](_0x39b6e8);_0x459b8a[_0x59badd(0x229)]<_0x366886&&(fs_1[_0x59badd(0x232)]['unlinkSync'](_0x39b6e8),_0x5d4470++,console[_0x59badd(0x209)](_0x59badd(0x22b)+_0x3dd65e));}),console[_0x80e8e8(0x209)](_0x80e8e8(0x1f4)+_0x5d4470+_0x80e8e8(0x1dc)+_0x4f1451+_0x80e8e8(0x201));}catch(_0x54df90){console[_0x80e8e8(0x1f8)](_0x80e8e8(0x230),_0x54df90);}}}exports['LoggerService']=LoggerService,exports['loggerService']=new LoggerService();function a52_0x448b(_0x4a6bf7,_0x169e91){const _0x3bf010=a52_0x3bf0();return a52_0x448b=function(_0x448b0e,_0x562b44){_0x448b0e=_0x448b0e-0x1da;let _0xadb677=_0x3bf010[_0x448b0e];return _0xadb677;},a52_0x448b(_0x4a6bf7,_0x169e91);}function a52_0x3bf0(){const _0x5274c1=['COINTOPAY_STATUS_CHANGE','3844835bpWQVU','34Lsfrpg','1524sDOdQQ','934854HIkvwy','logWebhookProcessed','PAYMENT_CREATED','logWebhookError','split','COINTOPAY_ERROR','21QRBOTo','API_CALL','.log','getLogFileName','white_domain_responses','payments_created','cointopay_status_changes','🧹\x20Cleaned\x20','getDate','endsWith','logWhiteDomainRequest','error','white_domain_requests','cwd','LoggerService','existsSync','forEach','logCoinToPayStatus','25832VtsAYL','cleanOldLogs','\x20days)','mkdirSync','logShopWebhookError','1721403ClcOFp','SHOP_WEBHOOK_ERROR','WEBHOOK_RECEIVED','localeCompare','webhooks_received','log','__esModule','white_domain_errors','toISOString','ERROR','8qDwGuh','RESPONSE','logWhiteDomainResponse','join','logWhiteDomainError','slice','stringify','date','91052mKlDte','ensureLogsDirectory','readdirSync','840AsMXwf','stack','loggerService','map','169485VZfrFi','cointopay_errors','logWebhookReceived','Failed\x20to\x20write\x20','getLogStats','statSync','message','logPaymentCreated','defineProperty','Failed\x20to\x20get\x20log\x20stats:','WEBHOOK_PROCESSED','webhooks_processed','mtime','REQUEST','🗑️\x20Deleted\x20old\x20log\x20file:\x20','logCoinToPayError','12DbivGi','__importDefault','WEBHOOK_ERROR','Failed\x20to\x20clean\x20old\x20logs:','📁\x20Created\x20logs\x20directory:\x20','default','52712oUKXab','logsDir','\x20old\x20log\x20files\x20(older\x20than\x20','filter','setDate','writeLog','utf8','webhooks_errors','logs'];a52_0x3bf0=function(){return _0x5274c1;};return a52_0x3bf0();}