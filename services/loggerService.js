'use strict';const a44_0x5e12d9=a44_0x5c5d;(function(_0xda75d3,_0x1a5f34){const _0x31a8e3=a44_0x5c5d,_0x55151d=_0xda75d3();while(!![]){try{const _0x275488=parseInt(_0x31a8e3(0x168))/0x1*(-parseInt(_0x31a8e3(0x13f))/0x2)+-parseInt(_0x31a8e3(0x148))/0x3*(parseInt(_0x31a8e3(0x136))/0x4)+-parseInt(_0x31a8e3(0x141))/0x5*(-parseInt(_0x31a8e3(0x11d))/0x6)+-parseInt(_0x31a8e3(0x132))/0x7+parseInt(_0x31a8e3(0x16d))/0x8*(parseInt(_0x31a8e3(0x15e))/0x9)+-parseInt(_0x31a8e3(0x13c))/0xa+parseInt(_0x31a8e3(0x155))/0xb*(parseInt(_0x31a8e3(0x12e))/0xc);if(_0x275488===_0x1a5f34)break;else _0x55151d['push'](_0x55151d['shift']());}catch(_0xbc8d6a){_0x55151d['push'](_0x55151d['shift']());}}}(a44_0x41cd,0xb2c41));function a44_0x41cd(){const _0x447a23=['size','loggerService','7721814dxRgte','error','shop_webhooks_sent','log','getLogStats','WEBHOOK_RECEIVED','white_domain_requests','📁\x20Created\x20logs\x20directory:\x20','API_CALL','unlinkSync','filter','endsWith','🧹\x20Cleaned\x20','existsSync','PAYMENT_CREATED','webhooks_received','LoggerService','1361604XBwYIV','slice','logShopWebhookError','toISOString','3832892lSxsqo','api_calls','__importDefault','join','1015468pKazMO','SHOP_WEBHOOK_SENT','.log','mtime','Failed\x20to\x20clean\x20old\x20logs:','cleanOldLogs','11807370HFYqON','setDate','localeCompare','3598EknINH','writeLog','5gwyFDo','WEBHOOK_ERROR','map','shop_webhooks_errors','ERROR','Failed\x20to\x20write\x20','logWhiteDomainRequest','15WCHWqH','getLogFileName','logApiCall','mkdirSync','stringify','\x20log:','\x20old\x20log\x20files\x20(older\x20than\x20','logPaymentCreated','forEach','logWebhookReceived','white_domain_errors','REQUEST','\x20days)','198YsyCGd','__esModule','webhooks_errors','cwd','logWebhookError','appendFileSync','WEBHOOK_PROCESSED','logsDir','logWhiteDomainResponse','9JJXUgb','webhooks_processed','default','replace','logs','stack','message','split','date','readdirSync','181bUfCaF','length','payments_created','statSync','path','5808776EPpmbU','utf8'];a44_0x41cd=function(){return _0x447a23;};return a44_0x41cd();}var __importDefault=this&&this[a44_0x5e12d9(0x134)]||function(_0x5e07f2){const _0x2e0e96=a44_0x5e12d9;return _0x5e07f2&&_0x5e07f2[_0x2e0e96(0x156)]?_0x5e07f2:{'default':_0x5e07f2};};Object['defineProperty'](exports,'__esModule',{'value':!![]}),exports['loggerService']=exports[a44_0x5e12d9(0x12d)]=void 0x0;const fs_1=__importDefault(require('fs')),path_1=__importDefault(require(a44_0x5e12d9(0x16c)));function a44_0x5c5d(_0x368cb8,_0x33309d){const _0x41cd6e=a44_0x41cd();return a44_0x5c5d=function(_0x5c5d86,_0xdbcb05){_0x5c5d86=_0x5c5d86-0x11a;let _0x2d58a0=_0x41cd6e[_0x5c5d86];return _0x2d58a0;},a44_0x5c5d(_0x368cb8,_0x33309d);}class LoggerService{constructor(){const _0x42b818=a44_0x5e12d9;this[_0x42b818(0x15c)]=path_1[_0x42b818(0x160)][_0x42b818(0x135)](process[_0x42b818(0x158)](),_0x42b818(0x162)),this['ensureLogsDirectory']();}['ensureLogsDirectory'](){const _0x4e0c1b=a44_0x5e12d9;!fs_1[_0x4e0c1b(0x160)][_0x4e0c1b(0x12a)](this[_0x4e0c1b(0x15c)])&&(fs_1[_0x4e0c1b(0x160)][_0x4e0c1b(0x14b)](this['logsDir'],{'recursive':!![]}),console['log'](_0x4e0c1b(0x124)+this['logsDir']));}[a44_0x5e12d9(0x149)](_0x10ebe7){const _0x550b9f=a44_0x5e12d9,_0x59ccf9=new Date()['toISOString']()[_0x550b9f(0x165)]('T')[0x0];return path_1['default'][_0x550b9f(0x135)](this['logsDir'],_0x10ebe7+'_'+_0x59ccf9+_0x550b9f(0x138));}['writeLog'](_0xb17ab6,_0x37f031){const _0xa7d703=a44_0x5e12d9;try{const _0x27b2f5=new Date()[_0xa7d703(0x131)](),_0x4f0816={'timestamp':_0x27b2f5,..._0x37f031},_0x1f6f6c=JSON[_0xa7d703(0x14c)](_0x4f0816)+'\x0a',_0x4d19cd=this['getLogFileName'](_0xb17ab6);fs_1[_0xa7d703(0x160)][_0xa7d703(0x15a)](_0x4d19cd,_0x1f6f6c,_0xa7d703(0x11a));}catch(_0x164503){console[_0xa7d703(0x11e)](_0xa7d703(0x146)+_0xb17ab6+_0xa7d703(0x14d),_0x164503);}}[a44_0x5e12d9(0x147)](_0x3765bb,_0x36be42,_0x3a1eff,_0x15e287){const _0x97a2de=a44_0x5e12d9;this[_0x97a2de(0x140)](_0x97a2de(0x123),{'type':_0x97a2de(0x153),'gateway':_0x3765bb,'endpoint':_0x36be42,'method':_0x3a1eff,'data':_0x15e287});}[a44_0x5e12d9(0x15d)](_0x44acd6,_0x117b27,_0xf92e04,_0x21237e,_0x1acfe1){const _0x5cbead=a44_0x5e12d9;this[_0x5cbead(0x140)]('white_domain_responses',{'type':'RESPONSE','gateway':_0x44acd6,'endpoint':_0x117b27,'status':_0xf92e04,'responseTime':_0x1acfe1,'data':_0x21237e});}['logWhiteDomainError'](_0x13cefa,_0x332992,_0x436a58){const _0xad576c=a44_0x5e12d9;this['writeLog'](_0xad576c(0x152),{'type':_0xad576c(0x145),'gateway':_0x13cefa,'endpoint':_0x332992,'error':_0x436a58 instanceof Error?{'message':_0x436a58[_0xad576c(0x164)],'stack':_0x436a58[_0xad576c(0x163)]}:_0x436a58});}[a44_0x5e12d9(0x151)](_0x38bd1f,_0x85877e,_0x3f05fa){const _0x444a98=a44_0x5e12d9;this['writeLog'](_0x444a98(0x12c),{'type':_0x444a98(0x122),'gateway':_0x38bd1f,'headers':_0x3f05fa,'data':_0x85877e});}['logWebhookProcessed'](_0x1dea67,_0x1cc262,_0x33ba9f,_0x10bce4,_0x2852ad){const _0x16cf49=a44_0x5e12d9;this[_0x16cf49(0x140)](_0x16cf49(0x15f),{'type':_0x16cf49(0x15b),'gateway':_0x1dea67,'paymentId':_0x1cc262,'oldStatus':_0x33ba9f,'newStatus':_0x10bce4,'originalData':_0x2852ad});}[a44_0x5e12d9(0x159)](_0x21dee2,_0x1646f8,_0x587a15){const _0x1659fc=a44_0x5e12d9;this[_0x1659fc(0x140)](_0x1659fc(0x157),{'type':_0x1659fc(0x142),'gateway':_0x21dee2,'error':_0x1646f8 instanceof Error?{'message':_0x1646f8[_0x1659fc(0x164)],'stack':_0x1646f8[_0x1659fc(0x163)]}:_0x1646f8,'originalData':_0x587a15});}['logShopWebhookSent'](_0x5d34f3,_0x4880bd,_0x47d1cd,_0x27f21f,_0x30bb9c,_0x1d992f){const _0x4f6dcc=a44_0x5e12d9;this[_0x4f6dcc(0x140)](_0x4f6dcc(0x11f),{'type':_0x4f6dcc(0x137),'shopId':_0x5d34f3,'webhookUrl':_0x4880bd,'event':_0x47d1cd,'status':_0x27f21f,'responseTime':_0x30bb9c,'payload':_0x1d992f});}[a44_0x5e12d9(0x130)](_0x3347c1,_0x1edbc8,_0x214572,_0x6888b1,_0x5d3071){const _0x5ed4bf=a44_0x5e12d9;this['writeLog'](_0x5ed4bf(0x144),{'type':'SHOP_WEBHOOK_ERROR','shopId':_0x3347c1,'webhookUrl':_0x1edbc8,'event':_0x214572,'error':_0x6888b1 instanceof Error?{'message':_0x6888b1[_0x5ed4bf(0x164)],'stack':_0x6888b1['stack']}:_0x6888b1,'payload':_0x5d3071});}[a44_0x5e12d9(0x14f)](_0x4d6f1d,_0xbb99d0,_0xd6e591,_0x5c3edc,_0x11f0ea){const _0x3ecb3e=a44_0x5e12d9;this[_0x3ecb3e(0x140)](_0x3ecb3e(0x16a),{'type':_0x3ecb3e(0x12b),'gateway':_0x4d6f1d,'paymentId':_0xbb99d0,'shopId':_0xd6e591,'amount':_0x5c3edc,'currency':_0x11f0ea});}[a44_0x5e12d9(0x14a)](_0x449a44,_0x255cf5,_0xb10722,_0x147546,_0x4c08b2){const _0x25af01=a44_0x5e12d9;this[_0x25af01(0x140)](_0x25af01(0x133),{'type':_0x25af01(0x125),'endpoint':_0x449a44,'method':_0x255cf5,'userId':_0xb10722,'userRole':_0x147546,'requestData':_0x4c08b2});}[a44_0x5e12d9(0x121)](){const _0x4839b5=a44_0x5e12d9;try{const _0x1dcde7=fs_1[_0x4839b5(0x160)]['readdirSync'](this[_0x4839b5(0x15c)]),_0x39a799=_0x1dcde7[_0x4839b5(0x127)](_0x402449=>_0x402449[_0x4839b5(0x128)](_0x4839b5(0x138))),_0x25f6ac=[...new Set(_0x39a799[_0x4839b5(0x143)](_0x11674e=>_0x11674e[_0x4839b5(0x165)]('_')[0x0]))],_0x13c717=_0x39a799[_0x4839b5(0x143)](_0x1c680c=>{const _0x4577c1=_0x4839b5,_0x2f491d=path_1['default'][_0x4577c1(0x135)](this[_0x4577c1(0x15c)],_0x1c680c),_0x71d07e=fs_1[_0x4577c1(0x160)]['statSync'](_0x2f491d),[_0x582f70,_0x192d4a]=_0x1c680c[_0x4577c1(0x161)]('.log','')[_0x4577c1(0x165)]('_');return{'type':_0x582f70,'date':_0x192d4a,'size':_0x71d07e[_0x4577c1(0x11b)]};})['sort']((_0x460165,_0x4a0bd2)=>_0x4a0bd2[_0x4839b5(0x166)][_0x4839b5(0x13e)](_0x460165[_0x4839b5(0x166)]));return{'totalFiles':_0x39a799[_0x4839b5(0x169)],'logTypes':_0x25f6ac,'latestLogs':_0x13c717[_0x4839b5(0x12f)](0x0,0xa)};}catch(_0x29e374){return console[_0x4839b5(0x11e)]('Failed\x20to\x20get\x20log\x20stats:',_0x29e374),{'totalFiles':0x0,'logTypes':[],'latestLogs':[]};}}[a44_0x5e12d9(0x13b)](_0xbfca9e=0x1e){const _0x387211=a44_0x5e12d9;try{const _0x5be4e2=fs_1[_0x387211(0x160)][_0x387211(0x167)](this['logsDir']),_0x5660cd=new Date();_0x5660cd[_0x387211(0x13d)](_0x5660cd['getDate']()-_0xbfca9e);let _0x42a41c=0x0;_0x5be4e2[_0x387211(0x150)](_0x35fba5=>{const _0x50acac=_0x387211;if(!_0x35fba5[_0x50acac(0x128)](_0x50acac(0x138)))return;const _0x2a9aa2=path_1[_0x50acac(0x160)][_0x50acac(0x135)](this[_0x50acac(0x15c)],_0x35fba5),_0x17449=fs_1[_0x50acac(0x160)][_0x50acac(0x16b)](_0x2a9aa2);_0x17449[_0x50acac(0x139)]<_0x5660cd&&(fs_1[_0x50acac(0x160)][_0x50acac(0x126)](_0x2a9aa2),_0x42a41c++,console[_0x50acac(0x120)]('🗑️\x20Deleted\x20old\x20log\x20file:\x20'+_0x35fba5));}),console['log'](_0x387211(0x129)+_0x42a41c+_0x387211(0x14e)+_0xbfca9e+_0x387211(0x154));}catch(_0x14c141){console[_0x387211(0x11e)](_0x387211(0x13a),_0x14c141);}}}exports[a44_0x5e12d9(0x12d)]=LoggerService,exports[a44_0x5e12d9(0x11c)]=new LoggerService();