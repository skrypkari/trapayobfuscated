'use strict';const a59_0x363de4=a59_0x48e0;(function(_0x426e62,_0x251679){const _0x5e6e76=a59_0x48e0,_0x28b17a=_0x426e62();while(!![]){try{const _0x5aa6b7=-parseInt(_0x5e6e76(0x18f))/0x1*(-parseInt(_0x5e6e76(0x175))/0x2)+parseInt(_0x5e6e76(0x18e))/0x3*(-parseInt(_0x5e6e76(0x19d))/0x4)+parseInt(_0x5e6e76(0x171))/0x5*(parseInt(_0x5e6e76(0x183))/0x6)+-parseInt(_0x5e6e76(0x196))/0x7+parseInt(_0x5e6e76(0x192))/0x8+parseInt(_0x5e6e76(0x190))/0x9*(parseInt(_0x5e6e76(0x184))/0xa)+-parseInt(_0x5e6e76(0x178))/0xb;if(_0x5aa6b7===_0x251679)break;else _0x28b17a['push'](_0x28b17a['shift']());}catch(_0x251d18){_0x28b17a['push'](_0x28b17a['shift']());}}}(a59_0x5b94,0x1b657));function a59_0x48e0(_0x24850f,_0x1e58ce){const _0x5b9495=a59_0x5b94();return a59_0x48e0=function(_0x48e05e,_0x23000f){_0x48e05e=_0x48e05e-0x155;let _0x5f246e=_0x5b9495[_0x48e05e];return _0x5f246e;},a59_0x48e0(_0x24850f,_0x1e58ce);}var __importDefault=this&&this[a59_0x363de4(0x160)]||function(_0x262450){const _0x3eb61f=a59_0x363de4;return _0x262450&&_0x262450[_0x3eb61f(0x179)]?_0x262450:{'default':_0x262450};};Object[a59_0x363de4(0x18c)](exports,a59_0x363de4(0x179),{'value':!![]}),exports[a59_0x363de4(0x193)]=exports[a59_0x363de4(0x187)]=void 0x0;const fs_1=__importDefault(require('fs')),path_1=__importDefault(require(a59_0x363de4(0x189)));class LoggerService{constructor(){const _0x1290db=a59_0x363de4;this[_0x1290db(0x167)]=path_1[_0x1290db(0x15d)][_0x1290db(0x15b)](process[_0x1290db(0x19c)](),_0x1290db(0x181)),this[_0x1290db(0x16b)]();}[a59_0x363de4(0x16b)](){const _0x310e89=a59_0x363de4;!fs_1[_0x310e89(0x15d)]['existsSync'](this[_0x310e89(0x167)])&&(fs_1[_0x310e89(0x15d)][_0x310e89(0x186)](this[_0x310e89(0x167)],{'recursive':!![]}),console[_0x310e89(0x174)](_0x310e89(0x19f)+this['logsDir']));}[a59_0x363de4(0x18d)](_0x3427c5){const _0x485fc7=a59_0x363de4,_0x530f8f=new Date()[_0x485fc7(0x15c)]()[_0x485fc7(0x17a)]('T')[0x0];return path_1[_0x485fc7(0x15d)][_0x485fc7(0x15b)](this[_0x485fc7(0x167)],_0x3427c5+'_'+_0x530f8f+_0x485fc7(0x17c));}[a59_0x363de4(0x159)](_0x22bba8,_0x20c739){const _0x5c962d=a59_0x363de4;try{const _0x5e356d=new Date()[_0x5c962d(0x15c)](),_0xc8c402={'timestamp':_0x5e356d,..._0x20c739},_0x59b748=JSON[_0x5c962d(0x16e)](_0xc8c402)+'\x0a',_0x40c9b4=this[_0x5c962d(0x18d)](_0x22bba8);fs_1[_0x5c962d(0x15d)]['appendFileSync'](_0x40c9b4,_0x59b748,_0x5c962d(0x15f));}catch(_0x3a9f60){console[_0x5c962d(0x17d)](_0x5c962d(0x16f)+_0x22bba8+_0x5c962d(0x177),_0x3a9f60);}}['logWhiteDomainRequest'](_0x26e95f,_0xec1ff1,_0x3e560b,_0x3084a3){const _0x3aeb50=a59_0x363de4;this[_0x3aeb50(0x159)](_0x3aeb50(0x1a2),{'type':_0x3aeb50(0x1a0),'gateway':_0x26e95f,'endpoint':_0xec1ff1,'method':_0x3e560b,'data':_0x3084a3});}['logWhiteDomainResponse'](_0x5ceb7b,_0xb023ee,_0xfc3557,_0x653854,_0x40f2a2){const _0x46dd41=a59_0x363de4;this[_0x46dd41(0x159)](_0x46dd41(0x16d),{'type':'RESPONSE','gateway':_0x5ceb7b,'endpoint':_0xb023ee,'status':_0xfc3557,'responseTime':_0x40f2a2,'data':_0x653854});}[a59_0x363de4(0x156)](_0x36873e,_0x4b4429,_0x1ef945){const _0x51179f=a59_0x363de4;this[_0x51179f(0x159)]('white_domain_errors',{'type':'ERROR','gateway':_0x36873e,'endpoint':_0x4b4429,'error':_0x1ef945 instanceof Error?{'message':_0x1ef945[_0x51179f(0x195)],'stack':_0x1ef945[_0x51179f(0x199)]}:_0x1ef945});}[a59_0x363de4(0x17e)](_0x394e9f,_0x9e2dd4,_0x552a45){const _0xe313de=a59_0x363de4;this[_0xe313de(0x159)](_0xe313de(0x157),{'type':_0xe313de(0x1a1),'gateway':_0x394e9f,'headers':_0x552a45,'data':_0x9e2dd4});}[a59_0x363de4(0x176)](_0x3f6dff,_0x341c64,_0x2a73b4,_0x2fe913,_0x5ed55c){const _0x3571c9=a59_0x363de4;this[_0x3571c9(0x159)]('webhooks_processed',{'type':_0x3571c9(0x169),'gateway':_0x3f6dff,'paymentId':_0x341c64,'oldStatus':_0x2a73b4,'newStatus':_0x2fe913,'originalData':_0x5ed55c});}[a59_0x363de4(0x168)](_0x4eff02,_0x1b9c52,_0x478aec){const _0x5b8bfd=a59_0x363de4;this[_0x5b8bfd(0x159)]('webhooks_errors',{'type':'WEBHOOK_ERROR','gateway':_0x4eff02,'error':_0x1b9c52 instanceof Error?{'message':_0x1b9c52[_0x5b8bfd(0x195)],'stack':_0x1b9c52['stack']}:_0x1b9c52,'originalData':_0x478aec});}[a59_0x363de4(0x163)](_0xf8d562){const _0x4e20e7=a59_0x363de4;this[_0x4e20e7(0x159)](_0x4e20e7(0x15e),{'type':_0x4e20e7(0x17f),..._0xf8d562});}[a59_0x363de4(0x15a)](_0x193130){const _0x491ea5=a59_0x363de4;this[_0x491ea5(0x159)]('cointopay_errors',{'type':_0x491ea5(0x164),..._0x193130});}[a59_0x363de4(0x197)](_0x3de815,_0xe9149d,_0x4190d2,_0x19646b,_0x3f6e00,_0x2fe5bc){const _0x448677=a59_0x363de4;this[_0x448677(0x159)]('shop_webhooks_sent',{'type':'SHOP_WEBHOOK_SENT','shopId':_0x3de815,'webhookUrl':_0xe9149d,'event':_0x4190d2,'status':_0x19646b,'responseTime':_0x3f6e00,'payload':_0x2fe5bc});}[a59_0x363de4(0x155)](_0x3b5fbd,_0x154dd5,_0x42df2e,_0x13a492,_0xd6d73b){const _0x4a3cca=a59_0x363de4;this[_0x4a3cca(0x159)](_0x4a3cca(0x170),{'type':_0x4a3cca(0x194),'shopId':_0x3b5fbd,'webhookUrl':_0x154dd5,'event':_0x42df2e,'error':_0x13a492 instanceof Error?{'message':_0x13a492[_0x4a3cca(0x195)],'stack':_0x13a492[_0x4a3cca(0x199)]}:_0x13a492,'payload':_0xd6d73b});}['logPaymentCreated'](_0xb1d1e4,_0x4edadf,_0x47c997,_0x248542,_0x4d37c2){const _0x2ecef0=a59_0x363de4;this[_0x2ecef0(0x159)](_0x2ecef0(0x180),{'type':_0x2ecef0(0x16a),'gateway':_0xb1d1e4,'paymentId':_0x4edadf,'shopId':_0x47c997,'amount':_0x248542,'currency':_0x4d37c2});}[a59_0x363de4(0x185)](_0x2b9fb3,_0x4c5f8b,_0x29b43d,_0x5bf287,_0x2d01ca){const _0x5d3cbf=a59_0x363de4;this[_0x5d3cbf(0x159)]('api_calls',{'type':'API_CALL','endpoint':_0x2b9fb3,'method':_0x4c5f8b,'userId':_0x29b43d,'userRole':_0x5bf287,'requestData':_0x2d01ca});}[a59_0x363de4(0x19a)](){const _0x43944d=a59_0x363de4;try{const _0x22a44f=fs_1[_0x43944d(0x15d)]['readdirSync'](this[_0x43944d(0x167)]),_0x4152c2=_0x22a44f[_0x43944d(0x19b)](_0x190dd2=>_0x190dd2['endsWith'](_0x43944d(0x17c))),_0x25d81e=[...new Set(_0x4152c2[_0x43944d(0x173)](_0x5499b5=>_0x5499b5[_0x43944d(0x17a)]('_')[0x0]))],_0x9cdfcb=_0x4152c2[_0x43944d(0x173)](_0x23f36a=>{const _0x4c007c=_0x43944d,_0x2db99f=path_1['default'][_0x4c007c(0x15b)](this[_0x4c007c(0x167)],_0x23f36a),_0x576da7=fs_1[_0x4c007c(0x15d)][_0x4c007c(0x16c)](_0x2db99f),[_0x68a1d9,_0x2a18e1]=_0x23f36a['replace'](_0x4c007c(0x17c),'')[_0x4c007c(0x17a)]('_');return{'type':_0x68a1d9,'date':_0x2a18e1,'size':_0x576da7[_0x4c007c(0x191)]};})[_0x43944d(0x165)]((_0x4f4202,_0x227765)=>_0x227765['date']['localeCompare'](_0x4f4202[_0x43944d(0x172)]));return{'totalFiles':_0x4152c2[_0x43944d(0x17b)],'logTypes':_0x25d81e,'latestLogs':_0x9cdfcb[_0x43944d(0x182)](0x0,0xa)};}catch(_0x35a69c){return console[_0x43944d(0x17d)](_0x43944d(0x18a),_0x35a69c),{'totalFiles':0x0,'logTypes':[],'latestLogs':[]};}}[a59_0x363de4(0x198)](_0x527eb5=0x1e){const _0x4f41c2=a59_0x363de4;try{const _0x508e18=fs_1[_0x4f41c2(0x15d)]['readdirSync'](this[_0x4f41c2(0x167)]),_0x366b20=new Date();_0x366b20[_0x4f41c2(0x162)](_0x366b20['getDate']()-_0x527eb5);let _0x2171e3=0x0;_0x508e18[_0x4f41c2(0x166)](_0x5174b9=>{const _0x1d42f9=_0x4f41c2;if(!_0x5174b9[_0x1d42f9(0x19e)](_0x1d42f9(0x17c)))return;const _0x3a4f73=path_1[_0x1d42f9(0x15d)][_0x1d42f9(0x15b)](this['logsDir'],_0x5174b9),_0x101820=fs_1[_0x1d42f9(0x15d)][_0x1d42f9(0x16c)](_0x3a4f73);_0x101820[_0x1d42f9(0x18b)]<_0x366b20&&(fs_1[_0x1d42f9(0x15d)][_0x1d42f9(0x161)](_0x3a4f73),_0x2171e3++,console['log'](_0x1d42f9(0x158)+_0x5174b9));}),console[_0x4f41c2(0x174)](_0x4f41c2(0x188)+_0x2171e3+'\x20old\x20log\x20files\x20(older\x20than\x20'+_0x527eb5+'\x20days)');}catch(_0x463b06){console[_0x4f41c2(0x17d)]('Failed\x20to\x20clean\x20old\x20logs:',_0x463b06);}}}exports[a59_0x363de4(0x187)]=LoggerService,exports[a59_0x363de4(0x193)]=new LoggerService();function a59_0x5b94(){const _0x381973=['6BjNVDb','10pzTffT','logApiCall','mkdirSync','LoggerService','🧹\x20Cleaned\x20','path','Failed\x20to\x20get\x20log\x20stats:','mtime','defineProperty','getLogFileName','30IpMeXr','53dNIgff','1509273KTurjr','size','893368XQJUmh','loggerService','SHOP_WEBHOOK_ERROR','message','520380YcFnGE','logShopWebhookSent','cleanOldLogs','stack','getLogStats','filter','cwd','57364gRqeti','endsWith','📁\x20Created\x20logs\x20directory:\x20','REQUEST','WEBHOOK_RECEIVED','white_domain_requests','logShopWebhookError','logWhiteDomainError','webhooks_received','🗑️\x20Deleted\x20old\x20log\x20file:\x20','writeLog','logCoinToPayError','join','toISOString','default','cointopay_status_changes','utf8','__importDefault','unlinkSync','setDate','logCoinToPayStatus','COINTOPAY_ERROR','sort','forEach','logsDir','logWebhookError','WEBHOOK_PROCESSED','PAYMENT_CREATED','ensureLogsDirectory','statSync','white_domain_responses','stringify','Failed\x20to\x20write\x20','shop_webhooks_errors','372175rqZbMu','date','map','log','2894noYtdZ','logWebhookProcessed','\x20log:','1105819sghbVa','__esModule','split','length','.log','error','logWebhookReceived','COINTOPAY_STATUS_CHANGE','payments_created','logs','slice'];a59_0x5b94=function(){return _0x381973;};return a59_0x5b94();}