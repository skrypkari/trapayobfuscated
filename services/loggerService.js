'use strict';function a56_0x31cb(){const _0x5bd4b9=['getLogStats','\x20log:','__esModule','endsWith','\x20old\x20log\x20files\x20(older\x20than\x20','join','9528276jiwPoo','11LagoRn','cleanOldLogs','setDate','4163250IDCNaU','WEBHOOK_PROCESSED','2065116TFvMeh','writeLog','11916hULtTc','length','logWebhookProcessed','PAYMENT_CREATED','5DJcruc','path','SHOP_WEBHOOK_SENT','readdirSync','COINTOPAY_ERROR','\x20days)','LoggerService','date','ensureLogsDirectory','localeCompare','logWebhookError','webhooks_processed','split','api_calls','logPaymentCreated','WEBHOOK_RECEIVED','🗑️\x20Deleted\x20old\x20log\x20file:\x20','defineProperty','logs','cointopay_status_changes','Failed\x20to\x20get\x20log\x20stats:','getDate','Failed\x20to\x20write\x20','shop_webhooks_sent','logsDir','5517488EMBuyl','.log','default','statSync','logShopWebhookError','stack','size','__importDefault','mtime','logCoinToPayStatus','842163UCwmpz','webhooks_received','log','white_domain_errors','stringify','utf8','filter','error','RESPONSE','slice','SHOP_WEBHOOK_ERROR','logCoinToPayError','existsSync','logWhiteDomainError','logApiCall','9QIzIvu','loggerService','message','logWebhookReceived','1woELHv','toISOString','API_CALL','384iGEziY','replace','ERROR','858964XAIOwJ'];a56_0x31cb=function(){return _0x5bd4b9;};return a56_0x31cb();}const a56_0x22ac84=a56_0x2759;(function(_0x37192c,_0x4683bf){const _0x355948=a56_0x2759,_0x39c610=_0x37192c();while(!![]){try{const _0x293640=-parseInt(_0x355948(0x12b))/0x1*(parseInt(_0x355948(0x131))/0x2)+parseInt(_0x355948(0x140))/0x3*(-parseInt(_0x355948(0x12e))/0x4)+parseInt(_0x355948(0x144))/0x5*(parseInt(_0x355948(0x13e))/0x6)+-parseInt(_0x355948(0x118))/0x7+parseInt(_0x355948(0x10e))/0x8*(parseInt(_0x355948(0x127))/0x9)+-parseInt(_0x355948(0x13c))/0xa+-parseInt(_0x355948(0x139))/0xb*(-parseInt(_0x355948(0x138))/0xc);if(_0x293640===_0x4683bf)break;else _0x39c610['push'](_0x39c610['shift']());}catch(_0x431763){_0x39c610['push'](_0x39c610['shift']());}}}(a56_0x31cb,0x754d3));var __importDefault=this&&this[a56_0x22ac84(0x115)]||function(_0x501ca3){const _0x3b66ff=a56_0x22ac84;return _0x501ca3&&_0x501ca3[_0x3b66ff(0x134)]?_0x501ca3:{'default':_0x501ca3};};function a56_0x2759(_0x3b9eb4,_0x2ed372){const _0x31cb3b=a56_0x31cb();return a56_0x2759=function(_0x2759b6,_0x397bb3){_0x2759b6=_0x2759b6-0x10a;let _0x495cc6=_0x31cb3b[_0x2759b6];return _0x495cc6;},a56_0x2759(_0x3b9eb4,_0x2ed372);}Object[a56_0x22ac84(0x155)](exports,'__esModule',{'value':!![]}),exports[a56_0x22ac84(0x128)]=exports[a56_0x22ac84(0x14a)]=void 0x0;const fs_1=__importDefault(require('fs')),path_1=__importDefault(require(a56_0x22ac84(0x145)));class LoggerService{constructor(){const _0x4647c6=a56_0x22ac84;this['logsDir']=path_1[_0x4647c6(0x110)][_0x4647c6(0x137)](process['cwd'](),_0x4647c6(0x156)),this[_0x4647c6(0x14c)]();}['ensureLogsDirectory'](){const _0x31a758=a56_0x22ac84;!fs_1[_0x31a758(0x110)][_0x31a758(0x124)](this[_0x31a758(0x10d)])&&(fs_1[_0x31a758(0x110)]['mkdirSync'](this[_0x31a758(0x10d)],{'recursive':!![]}),console[_0x31a758(0x11a)]('📁\x20Created\x20logs\x20directory:\x20'+this[_0x31a758(0x10d)]));}['getLogFileName'](_0x189d51){const _0x25915c=a56_0x22ac84,_0x2c4222=new Date()[_0x25915c(0x12c)]()[_0x25915c(0x150)]('T')[0x0];return path_1['default'][_0x25915c(0x137)](this[_0x25915c(0x10d)],_0x189d51+'_'+_0x2c4222+'.log');}[a56_0x22ac84(0x13f)](_0x6eca84,_0x1de66a){const _0x38d2a1=a56_0x22ac84;try{const _0x3d2c3f=new Date()['toISOString'](),_0x24d86a={'timestamp':_0x3d2c3f,..._0x1de66a},_0x151df8=JSON[_0x38d2a1(0x11c)](_0x24d86a)+'\x0a',_0x1e9541=this['getLogFileName'](_0x6eca84);fs_1[_0x38d2a1(0x110)]['appendFileSync'](_0x1e9541,_0x151df8,_0x38d2a1(0x11d));}catch(_0x594c81){console[_0x38d2a1(0x11f)](_0x38d2a1(0x10b)+_0x6eca84+_0x38d2a1(0x133),_0x594c81);}}['logWhiteDomainRequest'](_0x452741,_0x4d39da,_0x3c2c49,_0x401a08){const _0xa5331e=a56_0x22ac84;this[_0xa5331e(0x13f)]('white_domain_requests',{'type':'REQUEST','gateway':_0x452741,'endpoint':_0x4d39da,'method':_0x3c2c49,'data':_0x401a08});}['logWhiteDomainResponse'](_0xc635d0,_0x464ad3,_0x448174,_0x1fd26f,_0x5d1040){const _0x27eef5=a56_0x22ac84;this[_0x27eef5(0x13f)]('white_domain_responses',{'type':_0x27eef5(0x120),'gateway':_0xc635d0,'endpoint':_0x464ad3,'status':_0x448174,'responseTime':_0x5d1040,'data':_0x1fd26f});}[a56_0x22ac84(0x125)](_0x4725b5,_0x26f0de,_0x6e6e36){const _0x21ed11=a56_0x22ac84;this[_0x21ed11(0x13f)](_0x21ed11(0x11b),{'type':_0x21ed11(0x130),'gateway':_0x4725b5,'endpoint':_0x26f0de,'error':_0x6e6e36 instanceof Error?{'message':_0x6e6e36[_0x21ed11(0x129)],'stack':_0x6e6e36['stack']}:_0x6e6e36});}[a56_0x22ac84(0x12a)](_0x2bae6a,_0x3dda36,_0x262215){const _0x6a4e40=a56_0x22ac84;this[_0x6a4e40(0x13f)](_0x6a4e40(0x119),{'type':_0x6a4e40(0x153),'gateway':_0x2bae6a,'headers':_0x262215,'data':_0x3dda36});}[a56_0x22ac84(0x142)](_0x43153a,_0x4715a0,_0x1833a9,_0x7e0de3,_0x13254d){const _0x17f696=a56_0x22ac84;this[_0x17f696(0x13f)](_0x17f696(0x14f),{'type':_0x17f696(0x13d),'gateway':_0x43153a,'paymentId':_0x4715a0,'oldStatus':_0x1833a9,'newStatus':_0x7e0de3,'originalData':_0x13254d});}[a56_0x22ac84(0x14e)](_0x2e6a48,_0x49193c,_0x299b12){const _0x4fb3be=a56_0x22ac84;this[_0x4fb3be(0x13f)]('webhooks_errors',{'type':'WEBHOOK_ERROR','gateway':_0x2e6a48,'error':_0x49193c instanceof Error?{'message':_0x49193c[_0x4fb3be(0x129)],'stack':_0x49193c['stack']}:_0x49193c,'originalData':_0x299b12});}[a56_0x22ac84(0x117)](_0xfa3386){const _0x55c057=a56_0x22ac84;this[_0x55c057(0x13f)](_0x55c057(0x157),{'type':'COINTOPAY_STATUS_CHANGE',..._0xfa3386});}[a56_0x22ac84(0x123)](_0x23a909){const _0x2cb41f=a56_0x22ac84;this[_0x2cb41f(0x13f)]('cointopay_errors',{'type':_0x2cb41f(0x148),..._0x23a909});}['logShopWebhookSent'](_0x4eaa7e,_0x38c9a1,_0x38d00e,_0x3b4e7f,_0xabf7ec,_0x1a2745){const _0xd5bc27=a56_0x22ac84;this[_0xd5bc27(0x13f)](_0xd5bc27(0x10c),{'type':_0xd5bc27(0x146),'shopId':_0x4eaa7e,'webhookUrl':_0x38c9a1,'event':_0x38d00e,'status':_0x3b4e7f,'responseTime':_0xabf7ec,'payload':_0x1a2745});}[a56_0x22ac84(0x112)](_0xaa9554,_0x415628,_0x4be38b,_0x4ec06d,_0x1fd4e2){const _0x4e70bc=a56_0x22ac84;this['writeLog']('shop_webhooks_errors',{'type':_0x4e70bc(0x122),'shopId':_0xaa9554,'webhookUrl':_0x415628,'event':_0x4be38b,'error':_0x4ec06d instanceof Error?{'message':_0x4ec06d[_0x4e70bc(0x129)],'stack':_0x4ec06d[_0x4e70bc(0x113)]}:_0x4ec06d,'payload':_0x1fd4e2});}[a56_0x22ac84(0x152)](_0xde8a35,_0x156b48,_0x3b3bb5,_0x183c5f,_0x553032){const _0x34b723=a56_0x22ac84;this[_0x34b723(0x13f)]('payments_created',{'type':_0x34b723(0x143),'gateway':_0xde8a35,'paymentId':_0x156b48,'shopId':_0x3b3bb5,'amount':_0x183c5f,'currency':_0x553032});}[a56_0x22ac84(0x126)](_0x189c18,_0x3a1889,_0x2f3666,_0x124eac,_0x245cf3){const _0x3ed402=a56_0x22ac84;this['writeLog'](_0x3ed402(0x151),{'type':_0x3ed402(0x12d),'endpoint':_0x189c18,'method':_0x3a1889,'userId':_0x2f3666,'userRole':_0x124eac,'requestData':_0x245cf3});}[a56_0x22ac84(0x132)](){const _0x28262b=a56_0x22ac84;try{const _0x14bf35=fs_1[_0x28262b(0x110)][_0x28262b(0x147)](this[_0x28262b(0x10d)]),_0x4f11d7=_0x14bf35[_0x28262b(0x11e)](_0x22dc68=>_0x22dc68[_0x28262b(0x135)]('.log')),_0x334174=[...new Set(_0x4f11d7['map'](_0x250906=>_0x250906['split']('_')[0x0]))],_0x1faac1=_0x4f11d7['map'](_0x42be62=>{const _0x88ecf8=_0x28262b,_0x52a51e=path_1[_0x88ecf8(0x110)][_0x88ecf8(0x137)](this[_0x88ecf8(0x10d)],_0x42be62),_0x60678d=fs_1[_0x88ecf8(0x110)][_0x88ecf8(0x111)](_0x52a51e),[_0x1a36f1,_0x5cf209]=_0x42be62[_0x88ecf8(0x12f)](_0x88ecf8(0x10f),'')[_0x88ecf8(0x150)]('_');return{'type':_0x1a36f1,'date':_0x5cf209,'size':_0x60678d[_0x88ecf8(0x114)]};})['sort']((_0x5e58c9,_0xcec892)=>_0xcec892[_0x28262b(0x14b)][_0x28262b(0x14d)](_0x5e58c9[_0x28262b(0x14b)]));return{'totalFiles':_0x4f11d7[_0x28262b(0x141)],'logTypes':_0x334174,'latestLogs':_0x1faac1[_0x28262b(0x121)](0x0,0xa)};}catch(_0x432c1f){return console[_0x28262b(0x11f)](_0x28262b(0x158),_0x432c1f),{'totalFiles':0x0,'logTypes':[],'latestLogs':[]};}}[a56_0x22ac84(0x13a)](_0x443b13=0x1e){const _0x3cd31b=a56_0x22ac84;try{const _0x5c1082=fs_1[_0x3cd31b(0x110)]['readdirSync'](this['logsDir']),_0x3f6719=new Date();_0x3f6719[_0x3cd31b(0x13b)](_0x3f6719[_0x3cd31b(0x10a)]()-_0x443b13);let _0x27e028=0x0;_0x5c1082['forEach'](_0x492d5f=>{const _0x298446=_0x3cd31b;if(!_0x492d5f[_0x298446(0x135)](_0x298446(0x10f)))return;const _0x3d20e7=path_1[_0x298446(0x110)][_0x298446(0x137)](this[_0x298446(0x10d)],_0x492d5f),_0x5ebbb1=fs_1[_0x298446(0x110)][_0x298446(0x111)](_0x3d20e7);_0x5ebbb1[_0x298446(0x116)]<_0x3f6719&&(fs_1[_0x298446(0x110)]['unlinkSync'](_0x3d20e7),_0x27e028++,console[_0x298446(0x11a)](_0x298446(0x154)+_0x492d5f));}),console[_0x3cd31b(0x11a)]('🧹\x20Cleaned\x20'+_0x27e028+_0x3cd31b(0x136)+_0x443b13+_0x3cd31b(0x149));}catch(_0x24ed5f){console[_0x3cd31b(0x11f)]('Failed\x20to\x20clean\x20old\x20logs:',_0x24ed5f);}}}exports[a56_0x22ac84(0x14a)]=LoggerService,exports['loggerService']=new LoggerService();