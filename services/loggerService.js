'use strict';const a44_0x128140=a44_0x1eda;(function(_0x39a864,_0x3164ff){const _0x504112=a44_0x1eda,_0xbcc5d8=_0x39a864();while(!![]){try{const _0x3f741a=-parseInt(_0x504112(0x125))/0x1*(-parseInt(_0x504112(0x104))/0x2)+-parseInt(_0x504112(0xf9))/0x3*(parseInt(_0x504112(0xfa))/0x4)+parseInt(_0x504112(0x126))/0x5*(parseInt(_0x504112(0x10b))/0x6)+-parseInt(_0x504112(0xe9))/0x7*(parseInt(_0x504112(0x127))/0x8)+parseInt(_0x504112(0xef))/0x9+parseInt(_0x504112(0x112))/0xa*(parseInt(_0x504112(0x107))/0xb)+parseInt(_0x504112(0x109))/0xc*(-parseInt(_0x504112(0xf4))/0xd);if(_0x3f741a===_0x3164ff)break;else _0xbcc5d8['push'](_0xbcc5d8['shift']());}catch(_0x3c0c34){_0xbcc5d8['push'](_0xbcc5d8['shift']());}}}(a44_0xdf9b,0x1ff43));function a44_0x1eda(_0x22181e,_0x5bb850){const _0xdf9b5d=a44_0xdf9b();return a44_0x1eda=function(_0x1edad4,_0x31328c){_0x1edad4=_0x1edad4-0xe6;let _0xc0501=_0xdf9b5d[_0x1edad4];return _0xc0501;},a44_0x1eda(_0x22181e,_0x5bb850);}var __importDefault=this&&this[a44_0x128140(0x100)]||function(_0x11330e){const _0x21fcfc=a44_0x128140;return _0x11330e&&_0x11330e[_0x21fcfc(0x128)]?_0x11330e:{'default':_0x11330e};};Object['defineProperty'](exports,a44_0x128140(0x128),{'value':!![]}),exports[a44_0x128140(0x10c)]=exports['LoggerService']=void 0x0;function a44_0xdf9b(){const _0x5e08ed=['default','API_CALL','Failed\x20to\x20write\x20','57mVEeGP','38092fiGiTj','length','logApiCall','split','size','white_domain_responses','__importDefault','writeLog','mkdirSync','getDate','2hSbueY','white_domain_errors','SHOP_WEBHOOK_ERROR','16643lojNxf','WEBHOOK_ERROR','330408Dxocbv','cleanOldLogs','1507938JFGHNS','loggerService','logWebhookProcessed','utf8','webhooks_processed','webhooks_errors','\x20old\x20log\x20files\x20(older\x20than\x20','410YDdOTx','white_domain_requests','REQUEST','existsSync','error','payments_created','setDate','webhooks_received','logWebhookReceived','filter','forEach','.log','join','ðŸ§¹\x20Cleaned\x20','getLogFileName','logWhiteDomainRequest','PAYMENT_CREATED','log','WEBHOOK_PROCESSED','175434nlRUih','5HHCqiF','480JDFFSY','__esModule','stack','message','ðŸ—‘ï¸\x20Deleted\x20old\x20log\x20file:\x20','logWhiteDomainError','RESPONSE','api_calls','logShopWebhookError','map','cwd','readdirSync','date','endsWith','14581pluwOq','slice','path','Failed\x20to\x20get\x20log\x20stats:','ERROR','mtime','1266732RVWXHc','shop_webhooks_sent','ensureLogsDirectory','statSync','SHOP_WEBHOOK_SENT','91RmOPUt','logsDir'];a44_0xdf9b=function(){return _0x5e08ed;};return a44_0xdf9b();}const fs_1=__importDefault(require('fs')),path_1=__importDefault(require(a44_0x128140(0xeb)));class LoggerService{constructor(){const _0x3bd08d=a44_0x128140;this['logsDir']=path_1[_0x3bd08d(0xf6)][_0x3bd08d(0x11e)](process[_0x3bd08d(0x131)](),'logs'),this[_0x3bd08d(0xf1)]();}['ensureLogsDirectory'](){const _0x440f12=a44_0x128140;!fs_1['default'][_0x440f12(0x115)](this[_0x440f12(0xf5)])&&(fs_1['default'][_0x440f12(0x102)](this[_0x440f12(0xf5)],{'recursive':!![]}),console['log']('ðŸ“\x20Created\x20logs\x20directory:\x20'+this['logsDir']));}[a44_0x128140(0x120)](_0x3e009c){const _0x1e3cf6=a44_0x128140,_0xc3c977=new Date()['toISOString']()[_0x1e3cf6(0xfd)]('T')[0x0];return path_1[_0x1e3cf6(0xf6)][_0x1e3cf6(0x11e)](this['logsDir'],_0x3e009c+'_'+_0xc3c977+'.log');}[a44_0x128140(0x101)](_0x3c102f,_0x707efa){const _0x43ad08=a44_0x128140;try{const _0x46433a=new Date()['toISOString'](),_0x56b63d={'timestamp':_0x46433a,..._0x707efa},_0x1d79d0=JSON['stringify'](_0x56b63d)+'\x0a',_0x5164a9=this['getLogFileName'](_0x3c102f);fs_1[_0x43ad08(0xf6)]['appendFileSync'](_0x5164a9,_0x1d79d0,_0x43ad08(0x10e));}catch(_0xb933e9){console[_0x43ad08(0x116)](_0x43ad08(0xf8)+_0x3c102f+'\x20log:',_0xb933e9);}}[a44_0x128140(0x121)](_0x2ef5cc,_0x4b3633,_0xc9ec40,_0x38fb35){const _0x34e65f=a44_0x128140;this[_0x34e65f(0x101)](_0x34e65f(0x113),{'type':_0x34e65f(0x114),'gateway':_0x2ef5cc,'endpoint':_0x4b3633,'method':_0xc9ec40,'data':_0x38fb35});}['logWhiteDomainResponse'](_0x5cad78,_0x19b21b,_0x2c999a,_0xf49271,_0x183f5a){const _0x421195=a44_0x128140;this['writeLog'](_0x421195(0xff),{'type':_0x421195(0x12d),'gateway':_0x5cad78,'endpoint':_0x19b21b,'status':_0x2c999a,'responseTime':_0x183f5a,'data':_0xf49271});}[a44_0x128140(0x12c)](_0x358938,_0xc88d7b,_0x479269){const _0x5e0eb8=a44_0x128140;this[_0x5e0eb8(0x101)](_0x5e0eb8(0x105),{'type':_0x5e0eb8(0xed),'gateway':_0x358938,'endpoint':_0xc88d7b,'error':_0x479269 instanceof Error?{'message':_0x479269[_0x5e0eb8(0x12a)],'stack':_0x479269[_0x5e0eb8(0x129)]}:_0x479269});}[a44_0x128140(0x11a)](_0x19a67d,_0x18f7d4,_0x361997){const _0x5c3e6a=a44_0x128140;this[_0x5c3e6a(0x101)](_0x5c3e6a(0x119),{'type':'WEBHOOK_RECEIVED','gateway':_0x19a67d,'headers':_0x361997,'data':_0x18f7d4});}[a44_0x128140(0x10d)](_0x22b970,_0x203ccb,_0x16521b,_0x1ea093,_0x9e4b33){const _0x191798=a44_0x128140;this[_0x191798(0x101)](_0x191798(0x10f),{'type':_0x191798(0x124),'gateway':_0x22b970,'paymentId':_0x203ccb,'oldStatus':_0x16521b,'newStatus':_0x1ea093,'originalData':_0x9e4b33});}['logWebhookError'](_0xf25e51,_0x131ae3,_0x3e9ba6){const _0x3c5a58=a44_0x128140;this['writeLog'](_0x3c5a58(0x110),{'type':_0x3c5a58(0x108),'gateway':_0xf25e51,'error':_0x131ae3 instanceof Error?{'message':_0x131ae3['message'],'stack':_0x131ae3[_0x3c5a58(0x129)]}:_0x131ae3,'originalData':_0x3e9ba6});}['logShopWebhookSent'](_0x21e959,_0x2a3e14,_0x71d46c,_0xe69be7,_0x5c64bb,_0x5673bf){const _0x28fa76=a44_0x128140;this['writeLog'](_0x28fa76(0xf0),{'type':_0x28fa76(0xf3),'shopId':_0x21e959,'webhookUrl':_0x2a3e14,'event':_0x71d46c,'status':_0xe69be7,'responseTime':_0x5c64bb,'payload':_0x5673bf});}[a44_0x128140(0x12f)](_0x505f12,_0x940802,_0x2e4cec,_0x4d800e,_0x28a9fa){const _0x33ad0d=a44_0x128140;this[_0x33ad0d(0x101)]('shop_webhooks_errors',{'type':_0x33ad0d(0x106),'shopId':_0x505f12,'webhookUrl':_0x940802,'event':_0x2e4cec,'error':_0x4d800e instanceof Error?{'message':_0x4d800e[_0x33ad0d(0x12a)],'stack':_0x4d800e[_0x33ad0d(0x129)]}:_0x4d800e,'payload':_0x28a9fa});}['logPaymentCreated'](_0xcada24,_0x339d4a,_0x21bb75,_0x5d1fd0,_0x1c53e9){const _0x37cf50=a44_0x128140;this[_0x37cf50(0x101)](_0x37cf50(0x117),{'type':_0x37cf50(0x122),'gateway':_0xcada24,'paymentId':_0x339d4a,'shopId':_0x21bb75,'amount':_0x5d1fd0,'currency':_0x1c53e9});}[a44_0x128140(0xfc)](_0x20bcc8,_0x43517f,_0x240412,_0x2aee0d,_0xb4adb3){const _0x15e26e=a44_0x128140;this[_0x15e26e(0x101)](_0x15e26e(0x12e),{'type':_0x15e26e(0xf7),'endpoint':_0x20bcc8,'method':_0x43517f,'userId':_0x240412,'userRole':_0x2aee0d,'requestData':_0xb4adb3});}['getLogStats'](){const _0x17b525=a44_0x128140;try{const _0x4ba7b7=fs_1['default'][_0x17b525(0xe6)](this['logsDir']),_0x52fd1a=_0x4ba7b7[_0x17b525(0x11b)](_0x3a7712=>_0x3a7712['endsWith'](_0x17b525(0x11d))),_0x4ab2d=[...new Set(_0x52fd1a[_0x17b525(0x130)](_0x2c5f17=>_0x2c5f17[_0x17b525(0xfd)]('_')[0x0]))],_0xc5a542=_0x52fd1a[_0x17b525(0x130)](_0x36f9a8=>{const _0x391073=_0x17b525,_0x2f5373=path_1[_0x391073(0xf6)][_0x391073(0x11e)](this[_0x391073(0xf5)],_0x36f9a8),_0x22fe7d=fs_1[_0x391073(0xf6)][_0x391073(0xf2)](_0x2f5373),[_0x1fde15,_0x5699c0]=_0x36f9a8['replace'](_0x391073(0x11d),'')['split']('_');return{'type':_0x1fde15,'date':_0x5699c0,'size':_0x22fe7d[_0x391073(0xfe)]};})['sort']((_0x5ef359,_0x16653d)=>_0x16653d[_0x17b525(0xe7)]['localeCompare'](_0x5ef359[_0x17b525(0xe7)]));return{'totalFiles':_0x52fd1a[_0x17b525(0xfb)],'logTypes':_0x4ab2d,'latestLogs':_0xc5a542[_0x17b525(0xea)](0x0,0xa)};}catch(_0x46ed6){return console[_0x17b525(0x116)](_0x17b525(0xec),_0x46ed6),{'totalFiles':0x0,'logTypes':[],'latestLogs':[]};}}[a44_0x128140(0x10a)](_0x2440da=0x1e){const _0x1b78e1=a44_0x128140;try{const _0x2c36ef=fs_1['default']['readdirSync'](this[_0x1b78e1(0xf5)]),_0x248036=new Date();_0x248036[_0x1b78e1(0x118)](_0x248036[_0x1b78e1(0x103)]()-_0x2440da);let _0x6c4ff5=0x0;_0x2c36ef[_0x1b78e1(0x11c)](_0x1a7264=>{const _0x302180=_0x1b78e1;if(!_0x1a7264[_0x302180(0xe8)](_0x302180(0x11d)))return;const _0xe2ed6f=path_1[_0x302180(0xf6)]['join'](this[_0x302180(0xf5)],_0x1a7264),_0x5c21c6=fs_1[_0x302180(0xf6)][_0x302180(0xf2)](_0xe2ed6f);_0x5c21c6[_0x302180(0xee)]<_0x248036&&(fs_1[_0x302180(0xf6)]['unlinkSync'](_0xe2ed6f),_0x6c4ff5++,console[_0x302180(0x123)](_0x302180(0x12b)+_0x1a7264));}),console[_0x1b78e1(0x123)](_0x1b78e1(0x11f)+_0x6c4ff5+_0x1b78e1(0x111)+_0x2440da+'\x20days)');}catch(_0xef0ac3){console[_0x1b78e1(0x116)]('Failed\x20to\x20clean\x20old\x20logs:',_0xef0ac3);}}}exports['LoggerService']=LoggerService,exports[a44_0x128140(0x10c)]=new LoggerService();