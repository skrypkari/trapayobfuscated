'use strict';function a49_0x1733(_0x20e034,_0x769668){const _0x2041a0=a49_0x2041();return a49_0x1733=function(_0x1733d7,_0x14b63e){_0x1733d7=_0x1733d7-0x177;let _0x50c12d=_0x2041a0[_0x1733d7];return _0x50c12d;},a49_0x1733(_0x20e034,_0x769668);}function a49_0x2041(){const _0xabe1c=['🧹\x20Cleaned\x20','logShopWebhookSent','logWebhookProcessed','unlinkSync','message','writeLog','split','3506XKDSCf','defineProperty','logWhiteDomainRequest','error','__importDefault','Failed\x20to\x20clean\x20old\x20logs:','\x20old\x20log\x20files\x20(older\x20than\x20','appendFileSync','getLogStats','4686UfGlVn','RESPONSE','SHOP_WEBHOOK_ERROR','default','📁\x20Created\x20logs\x20directory:\x20','join','cwd','white_domain_responses','logsDir','mkdirSync','53034ujBWKW','api_calls','getLogFileName','size','mtime','filter','652GRUFgM','shop_webhooks_errors','stack','length','cleanOldLogs','WEBHOOK_ERROR','logCoinToPayError','forEach','log','shop_webhooks_sent','logWhiteDomainResponse','.log','COINTOPAY_ERROR','365VpCFiN','logWhiteDomainError','map','logShopWebhookError','48xhSavt','statSync','white_domain_requests','date','WEBHOOK_RECEIVED','logPaymentCreated','toISOString','9320XVVbQy','logWebhookReceived','API_CALL','cointopay_status_changes','1786659KnGahU','3SKmNwx','loggerService','payments_created','1434381jUegjm','webhooks_received','webhooks_processed','existsSync','webhooks_errors','endsWith','52532kLUbaC','REQUEST','white_domain_errors','Failed\x20to\x20get\x20log\x20stats:','localeCompare','__esModule','logWebhookError','getDate','46664XFpptQ','Failed\x20to\x20write\x20','logApiCall','LoggerService','replace','COINTOPAY_STATUS_CHANGE','2304EHxLJd'];a49_0x2041=function(){return _0xabe1c;};return a49_0x2041();}const a49_0x454eba=a49_0x1733;(function(_0x39c7be,_0x1851d1){const _0x229703=a49_0x1733,_0x168d57=_0x39c7be();while(!![]){try{const _0x14ba07=parseInt(_0x229703(0x199))/0x1*(-parseInt(_0x229703(0x180))/0x2)+-parseInt(_0x229703(0x1b6))/0x3*(-parseInt(_0x229703(0x1bf))/0x4)+parseInt(_0x229703(0x1a6))/0x5*(-parseInt(_0x229703(0x193))/0x6)+parseInt(_0x229703(0x1b5))/0x7+-parseInt(_0x229703(0x1c7))/0x8*(-parseInt(_0x229703(0x178))/0x9)+-parseInt(_0x229703(0x1b1))/0xa*(-parseInt(_0x229703(0x189))/0xb)+parseInt(_0x229703(0x1aa))/0xc*(parseInt(_0x229703(0x1b9))/0xd);if(_0x14ba07===_0x1851d1)break;else _0x168d57['push'](_0x168d57['shift']());}catch(_0x5e1848){_0x168d57['push'](_0x168d57['shift']());}}}(a49_0x2041,0xc6313));var __importDefault=this&&this[a49_0x454eba(0x184)]||function(_0x8b0b18){const _0x996d28=a49_0x454eba;return _0x8b0b18&&_0x8b0b18[_0x996d28(0x1c4)]?_0x8b0b18:{'default':_0x8b0b18};};Object[a49_0x454eba(0x181)](exports,a49_0x454eba(0x1c4),{'value':!![]}),exports[a49_0x454eba(0x1b7)]=exports[a49_0x454eba(0x1ca)]=void 0x0;const fs_1=__importDefault(require('fs')),path_1=__importDefault(require('path'));class LoggerService{constructor(){const _0x3e6eb2=a49_0x454eba;this[_0x3e6eb2(0x191)]=path_1['default'][_0x3e6eb2(0x18e)](process[_0x3e6eb2(0x18f)](),'logs'),this['ensureLogsDirectory']();}['ensureLogsDirectory'](){const _0x374830=a49_0x454eba;!fs_1[_0x374830(0x18c)][_0x374830(0x1bc)](this[_0x374830(0x191)])&&(fs_1[_0x374830(0x18c)][_0x374830(0x192)](this[_0x374830(0x191)],{'recursive':!![]}),console[_0x374830(0x1a1)](_0x374830(0x18d)+this[_0x374830(0x191)]));}['getLogFileName'](_0x4a2d9d){const _0x57afef=a49_0x454eba,_0x148c18=new Date()['toISOString']()[_0x57afef(0x17f)]('T')[0x0];return path_1[_0x57afef(0x18c)][_0x57afef(0x18e)](this[_0x57afef(0x191)],_0x4a2d9d+'_'+_0x148c18+'.log');}[a49_0x454eba(0x17e)](_0xd71f24,_0x170dc9){const _0x1670ce=a49_0x454eba;try{const _0x55ee1b=new Date()[_0x1670ce(0x1b0)](),_0x222ff0={'timestamp':_0x55ee1b,..._0x170dc9},_0x259a0c=JSON['stringify'](_0x222ff0)+'\x0a',_0x271427=this[_0x1670ce(0x195)](_0xd71f24);fs_1['default'][_0x1670ce(0x187)](_0x271427,_0x259a0c,'utf8');}catch(_0x466f09){console['error'](_0x1670ce(0x1c8)+_0xd71f24+'\x20log:',_0x466f09);}}[a49_0x454eba(0x182)](_0x1382ba,_0x38fa49,_0x2cb7fa,_0x16b38b){const _0xad0a7c=a49_0x454eba;this[_0xad0a7c(0x17e)](_0xad0a7c(0x1ac),{'type':_0xad0a7c(0x1c0),'gateway':_0x1382ba,'endpoint':_0x38fa49,'method':_0x2cb7fa,'data':_0x16b38b});}[a49_0x454eba(0x1a3)](_0x5d234d,_0x4ad2f6,_0x5dfdbd,_0x5f302b,_0x1c13f4){const _0x1533e6=a49_0x454eba;this['writeLog'](_0x1533e6(0x190),{'type':_0x1533e6(0x18a),'gateway':_0x5d234d,'endpoint':_0x4ad2f6,'status':_0x5dfdbd,'responseTime':_0x1c13f4,'data':_0x5f302b});}[a49_0x454eba(0x1a7)](_0x335fce,_0x358eb8,_0x26ac2f){const _0x178b4f=a49_0x454eba;this[_0x178b4f(0x17e)](_0x178b4f(0x1c1),{'type':'ERROR','gateway':_0x335fce,'endpoint':_0x358eb8,'error':_0x26ac2f instanceof Error?{'message':_0x26ac2f[_0x178b4f(0x17d)],'stack':_0x26ac2f[_0x178b4f(0x19b)]}:_0x26ac2f});}[a49_0x454eba(0x1b2)](_0x5e5261,_0x3831ab,_0x270c4d){const _0x296b26=a49_0x454eba;this[_0x296b26(0x17e)](_0x296b26(0x1ba),{'type':_0x296b26(0x1ae),'gateway':_0x5e5261,'headers':_0x270c4d,'data':_0x3831ab});}[a49_0x454eba(0x17b)](_0x4838f2,_0x239bd8,_0x37e6e0,_0x559fe1,_0x3f4974){const _0x49d0ff=a49_0x454eba;this[_0x49d0ff(0x17e)](_0x49d0ff(0x1bb),{'type':'WEBHOOK_PROCESSED','gateway':_0x4838f2,'paymentId':_0x239bd8,'oldStatus':_0x37e6e0,'newStatus':_0x559fe1,'originalData':_0x3f4974});}[a49_0x454eba(0x1c5)](_0x57c261,_0x45253c,_0x469b21){const _0x33722d=a49_0x454eba;this[_0x33722d(0x17e)](_0x33722d(0x1bd),{'type':_0x33722d(0x19e),'gateway':_0x57c261,'error':_0x45253c instanceof Error?{'message':_0x45253c['message'],'stack':_0x45253c[_0x33722d(0x19b)]}:_0x45253c,'originalData':_0x469b21});}['logCoinToPayStatus'](_0x328409){const _0x4b2ccb=a49_0x454eba;this[_0x4b2ccb(0x17e)](_0x4b2ccb(0x1b4),{'type':_0x4b2ccb(0x177),..._0x328409});}[a49_0x454eba(0x19f)](_0x175ec0){const _0x2afff8=a49_0x454eba;this[_0x2afff8(0x17e)]('cointopay_errors',{'type':_0x2afff8(0x1a5),..._0x175ec0});}[a49_0x454eba(0x17a)](_0x16eb26,_0x54ef7d,_0x446191,_0x42a666,_0x404e98,_0x20d933){const _0x2572d8=a49_0x454eba;this[_0x2572d8(0x17e)](_0x2572d8(0x1a2),{'type':'SHOP_WEBHOOK_SENT','shopId':_0x16eb26,'webhookUrl':_0x54ef7d,'event':_0x446191,'status':_0x42a666,'responseTime':_0x404e98,'payload':_0x20d933});}[a49_0x454eba(0x1a9)](_0x2d36cc,_0x4fe895,_0x1ee76d,_0x662a50,_0x27df56){const _0x2eb58a=a49_0x454eba;this[_0x2eb58a(0x17e)](_0x2eb58a(0x19a),{'type':_0x2eb58a(0x18b),'shopId':_0x2d36cc,'webhookUrl':_0x4fe895,'event':_0x1ee76d,'error':_0x662a50 instanceof Error?{'message':_0x662a50[_0x2eb58a(0x17d)],'stack':_0x662a50[_0x2eb58a(0x19b)]}:_0x662a50,'payload':_0x27df56});}[a49_0x454eba(0x1af)](_0x4dfcd4,_0x2b2009,_0x31053d,_0x216c9d,_0x107480){const _0x57b23c=a49_0x454eba;this[_0x57b23c(0x17e)](_0x57b23c(0x1b8),{'type':'PAYMENT_CREATED','gateway':_0x4dfcd4,'paymentId':_0x2b2009,'shopId':_0x31053d,'amount':_0x216c9d,'currency':_0x107480});}[a49_0x454eba(0x1c9)](_0x5d360c,_0x9a35b1,_0xbba35,_0x4a17a5,_0x249793){const _0x4204b3=a49_0x454eba;this[_0x4204b3(0x17e)](_0x4204b3(0x194),{'type':_0x4204b3(0x1b3),'endpoint':_0x5d360c,'method':_0x9a35b1,'userId':_0xbba35,'userRole':_0x4a17a5,'requestData':_0x249793});}[a49_0x454eba(0x188)](){const _0x452e47=a49_0x454eba;try{const _0x3a4586=fs_1[_0x452e47(0x18c)]['readdirSync'](this[_0x452e47(0x191)]),_0x4b5b14=_0x3a4586[_0x452e47(0x198)](_0x451367=>_0x451367['endsWith'](_0x452e47(0x1a4))),_0x1c2236=[...new Set(_0x4b5b14[_0x452e47(0x1a8)](_0x2a8b5a=>_0x2a8b5a[_0x452e47(0x17f)]('_')[0x0]))],_0x161eb7=_0x4b5b14[_0x452e47(0x1a8)](_0x3d747c=>{const _0x588e8b=_0x452e47,_0x371971=path_1[_0x588e8b(0x18c)][_0x588e8b(0x18e)](this[_0x588e8b(0x191)],_0x3d747c),_0x230ddd=fs_1[_0x588e8b(0x18c)][_0x588e8b(0x1ab)](_0x371971),[_0x522129,_0xd5e4df]=_0x3d747c[_0x588e8b(0x1cb)]('.log','')['split']('_');return{'type':_0x522129,'date':_0xd5e4df,'size':_0x230ddd[_0x588e8b(0x196)]};})['sort']((_0x4d77e6,_0x35afd1)=>_0x35afd1['date'][_0x452e47(0x1c3)](_0x4d77e6[_0x452e47(0x1ad)]));return{'totalFiles':_0x4b5b14[_0x452e47(0x19c)],'logTypes':_0x1c2236,'latestLogs':_0x161eb7['slice'](0x0,0xa)};}catch(_0x46f29b){return console['error'](_0x452e47(0x1c2),_0x46f29b),{'totalFiles':0x0,'logTypes':[],'latestLogs':[]};}}[a49_0x454eba(0x19d)](_0x31a413=0x1e){const _0x39d79a=a49_0x454eba;try{const _0xc8a1c4=fs_1[_0x39d79a(0x18c)]['readdirSync'](this['logsDir']),_0x28d8a5=new Date();_0x28d8a5['setDate'](_0x28d8a5[_0x39d79a(0x1c6)]()-_0x31a413);let _0x1b295f=0x0;_0xc8a1c4[_0x39d79a(0x1a0)](_0x3d8e26=>{const _0x768b13=_0x39d79a;if(!_0x3d8e26[_0x768b13(0x1be)](_0x768b13(0x1a4)))return;const _0x29f4fd=path_1['default'][_0x768b13(0x18e)](this[_0x768b13(0x191)],_0x3d8e26),_0x266871=fs_1['default'][_0x768b13(0x1ab)](_0x29f4fd);_0x266871[_0x768b13(0x197)]<_0x28d8a5&&(fs_1[_0x768b13(0x18c)][_0x768b13(0x17c)](_0x29f4fd),_0x1b295f++,console[_0x768b13(0x1a1)]('🗑️\x20Deleted\x20old\x20log\x20file:\x20'+_0x3d8e26));}),console[_0x39d79a(0x1a1)](_0x39d79a(0x179)+_0x1b295f+_0x39d79a(0x186)+_0x31a413+'\x20days)');}catch(_0x2fac78){console[_0x39d79a(0x183)](_0x39d79a(0x185),_0x2fac78);}}}exports[a49_0x454eba(0x1ca)]=LoggerService,exports[a49_0x454eba(0x1b7)]=new LoggerService();