'use strict';const a75_0x1f528a=a75_0x2e9c;(function(_0x5303aa,_0x1f6cc4){const _0x14d83a=a75_0x2e9c,_0x408f37=_0x5303aa();while(!![]){try{const _0x278c19=parseInt(_0x14d83a(0xba))/0x1+-parseInt(_0x14d83a(0x87))/0x2+-parseInt(_0x14d83a(0x97))/0x3+-parseInt(_0x14d83a(0xa3))/0x4*(parseInt(_0x14d83a(0xc5))/0x5)+-parseInt(_0x14d83a(0xc1))/0x6+-parseInt(_0x14d83a(0xaf))/0x7*(parseInt(_0x14d83a(0xaa))/0x8)+parseInt(_0x14d83a(0xc7))/0x9;if(_0x278c19===_0x1f6cc4)break;else _0x408f37['push'](_0x408f37['shift']());}catch(_0x1a569a){_0x408f37['push'](_0x408f37['shift']());}}}(a75_0x5478,0x8ce64));function a75_0x2e9c(_0x14ed23,_0x182233){_0x14ed23=_0x14ed23-0x82;const _0x547898=a75_0x5478();let _0x2e9c68=_0x547898[_0x14ed23];return _0x2e9c68;}function a75_0x5478(){const _0x25e0d6=['cwd','1052270CNHuaU','logWebhookReceived','COINTOPAY_STATUS_CHANGE','\x20log:','LoggerService','\x20old\x20log\x20files\x20(older\x20than\x20','logShopWebhookSent','772812NstYVV','date','Failed\x20to\x20clean\x20old\x20logs:','endsWith','5rZrFMf','.log','21902445jXhYMu','ERROR','PAYMENT_CREATED','logWhiteDomainError','__importDefault','ðŸ“\x20Created\x20logs\x20directory:\x20','writeLog','replace','toISOString','slice','logWhiteDomainRequest','1280446pJpgZW','logsDir','log','loggerService','Failed\x20to\x20get\x20log\x20stats:','WEBHOOK_PROCESSED','SHOP_WEBHOOK_ERROR','readdirSync','cointopay_status_changes','logApiCall','COINTOPAY_ERROR','appendFileSync','WEBHOOK_ERROR','api_calls','logShopWebhookError','webhooks_received','2015373RibIpy','logWebhookError','logCoinToPayError','SHOP_WEBHOOK_SENT','RESPONSE','filter','ensureLogsDirectory','utf8','error','webhooks_processed','defineProperty','statSync','4104164LFXvRf','WEBHOOK_RECEIVED','default','ðŸ—‘ï¸\x20Deleted\x20old\x20log\x20file:\x20','forEach','getDate','shop_webhooks_errors','75216vXndmF','webhooks_errors','message','stack','cleanOldLogs','329hkjiha','map','logWhiteDomainResponse','split','path','cointopay_errors','join','mtime','getLogFileName','size'];a75_0x5478=function(){return _0x25e0d6;};return a75_0x5478();}var __importDefault=this&&this[a75_0x1f528a(0xcb)]||function(_0xac7757){return _0xac7757&&_0xac7757['__esModule']?_0xac7757:{'default':_0xac7757};};Object[a75_0x1f528a(0xa1)](exports,'__esModule',{'value':!![]}),exports[a75_0x1f528a(0x8a)]=exports[a75_0x1f528a(0xbe)]=void 0x0;const fs_1=__importDefault(require('fs')),path_1=__importDefault(require(a75_0x1f528a(0xb3)));class LoggerService{constructor(){const _0x1b9cb7=a75_0x1f528a;this['logsDir']=path_1[_0x1b9cb7(0xa5)][_0x1b9cb7(0xb5)](process[_0x1b9cb7(0xb9)](),'logs'),this[_0x1b9cb7(0x9d)]();}[a75_0x1f528a(0x9d)](){const _0x210655=a75_0x1f528a;!fs_1[_0x210655(0xa5)]['existsSync'](this['logsDir'])&&(fs_1[_0x210655(0xa5)]['mkdirSync'](this[_0x210655(0x88)],{'recursive':!![]}),console['log'](_0x210655(0xcc)+this[_0x210655(0x88)]));}[a75_0x1f528a(0xb7)](_0x2b2ed6){const _0x2707a5=a75_0x1f528a,_0x3869bf=new Date()['toISOString']()[_0x2707a5(0xb2)]('T')[0x0];return path_1[_0x2707a5(0xa5)][_0x2707a5(0xb5)](this[_0x2707a5(0x88)],_0x2b2ed6+'_'+_0x3869bf+_0x2707a5(0xc6));}[a75_0x1f528a(0x82)](_0xd9809c,_0x42ae05){const _0x3e6b0a=a75_0x1f528a;try{const _0x522ca3=new Date()[_0x3e6b0a(0x84)](),_0x4e72b2={'timestamp':_0x522ca3,..._0x42ae05},_0x3b1647=JSON['stringify'](_0x4e72b2)+'\x0a',_0x905bd9=this[_0x3e6b0a(0xb7)](_0xd9809c);fs_1['default'][_0x3e6b0a(0x92)](_0x905bd9,_0x3b1647,_0x3e6b0a(0x9e));}catch(_0x3ff391){console[_0x3e6b0a(0x9f)]('Failed\x20to\x20write\x20'+_0xd9809c+_0x3e6b0a(0xbd),_0x3ff391);}}[a75_0x1f528a(0x86)](_0x4cefd7,_0x2d758d,_0x4f03aa,_0x54047b){const _0x333394=a75_0x1f528a;this[_0x333394(0x82)]('white_domain_requests',{'type':'REQUEST','gateway':_0x4cefd7,'endpoint':_0x2d758d,'method':_0x4f03aa,'data':_0x54047b});}[a75_0x1f528a(0xb1)](_0x9147aa,_0x2b1aa9,_0xe26598,_0x4113e6,_0x12cbb5){const _0x2b17f4=a75_0x1f528a;this[_0x2b17f4(0x82)]('white_domain_responses',{'type':_0x2b17f4(0x9b),'gateway':_0x9147aa,'endpoint':_0x2b1aa9,'status':_0xe26598,'responseTime':_0x12cbb5,'data':_0x4113e6});}[a75_0x1f528a(0xca)](_0x30712a,_0x135bdd,_0x198b61){const _0x402a57=a75_0x1f528a;this[_0x402a57(0x82)]('white_domain_errors',{'type':_0x402a57(0xc8),'gateway':_0x30712a,'endpoint':_0x135bdd,'error':_0x198b61 instanceof Error?{'message':_0x198b61[_0x402a57(0xac)],'stack':_0x198b61[_0x402a57(0xad)]}:_0x198b61});}[a75_0x1f528a(0xbb)](_0x2e6858,_0xd09180,_0x39e92f){const _0x24e0c9=a75_0x1f528a;this[_0x24e0c9(0x82)](_0x24e0c9(0x96),{'type':_0x24e0c9(0xa4),'gateway':_0x2e6858,'headers':_0x39e92f,'data':_0xd09180});}['logWebhookProcessed'](_0x5c689b,_0x329881,_0x345ff5,_0x1a6d22,_0x592a98){const _0xe4cf4d=a75_0x1f528a;this['writeLog'](_0xe4cf4d(0xa0),{'type':_0xe4cf4d(0x8c),'gateway':_0x5c689b,'paymentId':_0x329881,'oldStatus':_0x345ff5,'newStatus':_0x1a6d22,'originalData':_0x592a98});}[a75_0x1f528a(0x98)](_0x39de9e,_0x2652ec,_0x269057){const _0x4eaac5=a75_0x1f528a;this[_0x4eaac5(0x82)](_0x4eaac5(0xab),{'type':_0x4eaac5(0x93),'gateway':_0x39de9e,'error':_0x2652ec instanceof Error?{'message':_0x2652ec[_0x4eaac5(0xac)],'stack':_0x2652ec[_0x4eaac5(0xad)]}:_0x2652ec,'originalData':_0x269057});}['logCoinToPayStatus'](_0x250778){const _0x258171=a75_0x1f528a;this[_0x258171(0x82)](_0x258171(0x8f),{'type':_0x258171(0xbc),..._0x250778});}[a75_0x1f528a(0x99)](_0x1b98ca){const _0x407c8a=a75_0x1f528a;this[_0x407c8a(0x82)](_0x407c8a(0xb4),{'type':_0x407c8a(0x91),..._0x1b98ca});}[a75_0x1f528a(0xc0)](_0x433c77,_0x42959a,_0x555484,_0x13ffe4,_0x42db9a,_0x14d717){const _0x6e91a1=a75_0x1f528a;this[_0x6e91a1(0x82)]('shop_webhooks_sent',{'type':_0x6e91a1(0x9a),'shopId':_0x433c77,'webhookUrl':_0x42959a,'event':_0x555484,'status':_0x13ffe4,'responseTime':_0x42db9a,'payload':_0x14d717});}[a75_0x1f528a(0x95)](_0x19fe78,_0x5b4161,_0x296770,_0x11f8cb,_0x13a353){const _0xf7bea8=a75_0x1f528a;this[_0xf7bea8(0x82)](_0xf7bea8(0xa9),{'type':_0xf7bea8(0x8d),'shopId':_0x19fe78,'webhookUrl':_0x5b4161,'event':_0x296770,'error':_0x11f8cb instanceof Error?{'message':_0x11f8cb['message'],'stack':_0x11f8cb[_0xf7bea8(0xad)]}:_0x11f8cb,'payload':_0x13a353});}['logPaymentCreated'](_0x4bbbf8,_0x1aa672,_0x42be4e,_0x17b445,_0x6a0adb){const _0x3a2e09=a75_0x1f528a;this[_0x3a2e09(0x82)]('payments_created',{'type':_0x3a2e09(0xc9),'gateway':_0x4bbbf8,'paymentId':_0x1aa672,'shopId':_0x42be4e,'amount':_0x17b445,'currency':_0x6a0adb});}[a75_0x1f528a(0x90)](_0xdefffe,_0x4b4def,_0x4998ab,_0x35527e,_0xeb7db8){const _0x2cf757=a75_0x1f528a;this[_0x2cf757(0x82)](_0x2cf757(0x94),{'type':'API_CALL','endpoint':_0xdefffe,'method':_0x4b4def,'userId':_0x4998ab,'userRole':_0x35527e,'requestData':_0xeb7db8});}['getLogStats'](){const _0x56c5fd=a75_0x1f528a;try{const _0x21b55b=fs_1[_0x56c5fd(0xa5)][_0x56c5fd(0x8e)](this[_0x56c5fd(0x88)]),_0x434558=_0x21b55b[_0x56c5fd(0x9c)](_0x59a4b1=>_0x59a4b1[_0x56c5fd(0xc4)](_0x56c5fd(0xc6))),_0x185673=[...new Set(_0x434558[_0x56c5fd(0xb0)](_0x5ddda1=>_0x5ddda1['split']('_')[0x0]))],_0x801e8b=_0x434558[_0x56c5fd(0xb0)](_0x35ef14=>{const _0x325700=_0x56c5fd,_0x317a8b=path_1['default'][_0x325700(0xb5)](this['logsDir'],_0x35ef14),_0x5c6753=fs_1['default'][_0x325700(0xa2)](_0x317a8b),[_0x1fe93d,_0x3e2325]=_0x35ef14[_0x325700(0x83)](_0x325700(0xc6),'')[_0x325700(0xb2)]('_');return{'type':_0x1fe93d,'date':_0x3e2325,'size':_0x5c6753[_0x325700(0xb8)]};})['sort']((_0x582af6,_0x2bdb6c)=>_0x2bdb6c[_0x56c5fd(0xc2)]['localeCompare'](_0x582af6[_0x56c5fd(0xc2)]));return{'totalFiles':_0x434558['length'],'logTypes':_0x185673,'latestLogs':_0x801e8b[_0x56c5fd(0x85)](0x0,0xa)};}catch(_0x1fff90){return console[_0x56c5fd(0x9f)](_0x56c5fd(0x8b),_0x1fff90),{'totalFiles':0x0,'logTypes':[],'latestLogs':[]};}}[a75_0x1f528a(0xae)](_0x18d7ab=0x1e){const _0x38a8af=a75_0x1f528a;try{const _0x37c12d=fs_1[_0x38a8af(0xa5)][_0x38a8af(0x8e)](this[_0x38a8af(0x88)]),_0x3a4dee=new Date();_0x3a4dee['setDate'](_0x3a4dee[_0x38a8af(0xa8)]()-_0x18d7ab);let _0x234c29=0x0;_0x37c12d[_0x38a8af(0xa7)](_0x1bd052=>{const _0x1723b7=_0x38a8af;if(!_0x1bd052[_0x1723b7(0xc4)](_0x1723b7(0xc6)))return;const _0xc804cc=path_1[_0x1723b7(0xa5)][_0x1723b7(0xb5)](this[_0x1723b7(0x88)],_0x1bd052),_0x11fa2c=fs_1[_0x1723b7(0xa5)]['statSync'](_0xc804cc);_0x11fa2c[_0x1723b7(0xb6)]<_0x3a4dee&&(fs_1[_0x1723b7(0xa5)]['unlinkSync'](_0xc804cc),_0x234c29++,console['log'](_0x1723b7(0xa6)+_0x1bd052));}),console[_0x38a8af(0x89)]('ðŸ§¹\x20Cleaned\x20'+_0x234c29+_0x38a8af(0xbf)+_0x18d7ab+'\x20days)');}catch(_0x2952c5){console[_0x38a8af(0x9f)](_0x38a8af(0xc3),_0x2952c5);}}}exports[a75_0x1f528a(0xbe)]=LoggerService,exports[a75_0x1f528a(0x8a)]=new LoggerService();