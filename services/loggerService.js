'use strict';const a48_0x5182e6=a48_0x5be2;(function(_0x5c4530,_0x3e11e9){const _0xec290b=a48_0x5be2,_0x26d398=_0x5c4530();while(!![]){try{const _0x23dd72=-parseInt(_0xec290b(0xe7))/0x1+-parseInt(_0xec290b(0xed))/0x2+-parseInt(_0xec290b(0x113))/0x3+parseInt(_0xec290b(0x115))/0x4+parseInt(_0xec290b(0x10c))/0x5*(parseInt(_0xec290b(0xd4))/0x6)+parseInt(_0xec290b(0x114))/0x7*(parseInt(_0xec290b(0xee))/0x8)+parseInt(_0xec290b(0x10f))/0x9;if(_0x23dd72===_0x3e11e9)break;else _0x26d398['push'](_0x26d398['shift']());}catch(_0x129bbd){_0x26d398['push'](_0x26d398['shift']());}}}(a48_0x2b63,0xe629c));function a48_0x2b63(){const _0x5c9906=['\x20log:','setDate','error','Failed\x20to\x20get\x20log\x20stats:','statSync','writeLog','slice','defineProperty','\x20days)','WEBHOOK_PROCESSED','1722sIKkVi','logCoinToPayError','sort','mkdirSync','logWebhookError','WEBHOOK_RECEIVED','cleanOldLogs','getLogFileName','logCoinToPayStatus','split','SHOP_WEBHOOK_SENT','shop_webhooks_errors','getLogStats','logWebhookReceived','\x20old\x20log\x20files\x20(older\x20than\x20','toISOString','date','🧹\x20Cleaned\x20','localeCompare','5407RbcUmI','COINTOPAY_ERROR','message','logsDir','cointopay_errors','map','3484836dCNSoC','449992OXASfc','RESPONSE','ensureLogsDirectory','forEach','cointopay_status_changes','size','logPaymentCreated','log','logWhiteDomainResponse','Failed\x20to\x20write\x20','🗑️\x20Deleted\x20old\x20log\x20file:\x20','logs','webhooks_errors','stringify','filter','logShopWebhookError','shop_webhooks_sent','WEBHOOK_ERROR','__esModule','.log','logWhiteDomainRequest','join','ERROR','unlinkSync','__importDefault','LoggerService','endsWith','cwd','appendFileSync','loggerService','13160apnRAp','readdirSync','Failed\x20to\x20clean\x20old\x20logs:','5619681FCPvhh','REQUEST','logShopWebhookSent','replace','1850466bUCpxN','42BTfrlt','6360432obCTOz','stack','default','utf8','webhooks_received','white_domain_requests','white_domain_errors','existsSync','logWhiteDomainError'];a48_0x2b63=function(){return _0x5c9906;};return a48_0x2b63();}var __importDefault=this&&this[a48_0x5182e6(0x106)]||function(_0x3c7608){const _0x112be7=a48_0x5182e6;return _0x3c7608&&_0x3c7608[_0x112be7(0x100)]?_0x3c7608:{'default':_0x3c7608};};Object[a48_0x5182e6(0xd1)](exports,a48_0x5182e6(0x100),{'value':!![]}),exports[a48_0x5182e6(0x10b)]=exports[a48_0x5182e6(0x107)]=void 0x0;function a48_0x5be2(_0x27f005,_0x512247){const _0x2b6341=a48_0x2b63();return a48_0x5be2=function(_0x5be22e,_0x4fdc70){_0x5be22e=_0x5be22e-0xce;let _0x95c73f=_0x2b6341[_0x5be22e];return _0x95c73f;},a48_0x5be2(_0x27f005,_0x512247);}const fs_1=__importDefault(require('fs')),path_1=__importDefault(require('path'));class LoggerService{constructor(){const _0x1932fe=a48_0x5182e6;this[_0x1932fe(0xea)]=path_1['default'][_0x1932fe(0x103)](process[_0x1932fe(0x109)](),_0x1932fe(0xf9)),this[_0x1932fe(0xf0)]();}[a48_0x5182e6(0xf0)](){const _0x328947=a48_0x5182e6;!fs_1['default'][_0x328947(0x11c)](this['logsDir'])&&(fs_1['default'][_0x328947(0xd7)](this['logsDir'],{'recursive':!![]}),console[_0x328947(0xf5)]('📁\x20Created\x20logs\x20directory:\x20'+this['logsDir']));}[a48_0x5182e6(0xdb)](_0x2d0a1e){const _0x205e23=a48_0x5182e6,_0xfcefa3=new Date()[_0x205e23(0xe3)]()['split']('T')[0x0];return path_1[_0x205e23(0x117)]['join'](this['logsDir'],_0x2d0a1e+'_'+_0xfcefa3+_0x205e23(0x101));}['writeLog'](_0x3aa92a,_0x377538){const _0x1fd7ff=a48_0x5182e6;try{const _0x4355b8=new Date()[_0x1fd7ff(0xe3)](),_0x5b9c7d={'timestamp':_0x4355b8,..._0x377538},_0xca5938=JSON[_0x1fd7ff(0xfb)](_0x5b9c7d)+'\x0a',_0x3e5b84=this[_0x1fd7ff(0xdb)](_0x3aa92a);fs_1[_0x1fd7ff(0x117)][_0x1fd7ff(0x10a)](_0x3e5b84,_0xca5938,_0x1fd7ff(0x118));}catch(_0x278786){console[_0x1fd7ff(0x120)](_0x1fd7ff(0xf7)+_0x3aa92a+_0x1fd7ff(0x11e),_0x278786);}}[a48_0x5182e6(0x102)](_0x3c216c,_0xd92b4b,_0x5ee1eb,_0x15e3f3){const _0x11c633=a48_0x5182e6;this[_0x11c633(0xcf)](_0x11c633(0x11a),{'type':_0x11c633(0x110),'gateway':_0x3c216c,'endpoint':_0xd92b4b,'method':_0x5ee1eb,'data':_0x15e3f3});}[a48_0x5182e6(0xf6)](_0x4f6c9b,_0x4ea540,_0x49bafa,_0x3abc07,_0x399354){const _0x25d7e2=a48_0x5182e6;this[_0x25d7e2(0xcf)]('white_domain_responses',{'type':_0x25d7e2(0xef),'gateway':_0x4f6c9b,'endpoint':_0x4ea540,'status':_0x49bafa,'responseTime':_0x399354,'data':_0x3abc07});}[a48_0x5182e6(0x11d)](_0x423489,_0x3548ef,_0x430d17){const _0x1376cc=a48_0x5182e6;this[_0x1376cc(0xcf)](_0x1376cc(0x11b),{'type':_0x1376cc(0x104),'gateway':_0x423489,'endpoint':_0x3548ef,'error':_0x430d17 instanceof Error?{'message':_0x430d17['message'],'stack':_0x430d17[_0x1376cc(0x116)]}:_0x430d17});}[a48_0x5182e6(0xe1)](_0x489e11,_0x358df6,_0x427a66){const _0x568e83=a48_0x5182e6;this['writeLog'](_0x568e83(0x119),{'type':_0x568e83(0xd9),'gateway':_0x489e11,'headers':_0x427a66,'data':_0x358df6});}['logWebhookProcessed'](_0x2b44cc,_0x363842,_0x570fbb,_0x224263,_0x4d6986){const _0x4eff31=a48_0x5182e6;this['writeLog']('webhooks_processed',{'type':_0x4eff31(0xd3),'gateway':_0x2b44cc,'paymentId':_0x363842,'oldStatus':_0x570fbb,'newStatus':_0x224263,'originalData':_0x4d6986});}[a48_0x5182e6(0xd8)](_0x29eeda,_0x5b24d7,_0x187eac){const _0x53f99a=a48_0x5182e6;this[_0x53f99a(0xcf)](_0x53f99a(0xfa),{'type':_0x53f99a(0xff),'gateway':_0x29eeda,'error':_0x5b24d7 instanceof Error?{'message':_0x5b24d7[_0x53f99a(0xe9)],'stack':_0x5b24d7[_0x53f99a(0x116)]}:_0x5b24d7,'originalData':_0x187eac});}[a48_0x5182e6(0xdc)](_0x266e1a){const _0x44dab9=a48_0x5182e6;this[_0x44dab9(0xcf)](_0x44dab9(0xf2),{'type':'COINTOPAY_STATUS_CHANGE',..._0x266e1a});}[a48_0x5182e6(0xd5)](_0x28a4c8){const _0xb3a747=a48_0x5182e6;this[_0xb3a747(0xcf)](_0xb3a747(0xeb),{'type':_0xb3a747(0xe8),..._0x28a4c8});}[a48_0x5182e6(0x111)](_0x106301,_0x329cd8,_0x47075c,_0x5009e0,_0xd1406e,_0x132474){const _0x3656df=a48_0x5182e6;this[_0x3656df(0xcf)](_0x3656df(0xfe),{'type':_0x3656df(0xde),'shopId':_0x106301,'webhookUrl':_0x329cd8,'event':_0x47075c,'status':_0x5009e0,'responseTime':_0xd1406e,'payload':_0x132474});}[a48_0x5182e6(0xfd)](_0x286b2a,_0x30fb8b,_0x38b485,_0x284f41,_0x49f32a){const _0x2b7b10=a48_0x5182e6;this['writeLog'](_0x2b7b10(0xdf),{'type':'SHOP_WEBHOOK_ERROR','shopId':_0x286b2a,'webhookUrl':_0x30fb8b,'event':_0x38b485,'error':_0x284f41 instanceof Error?{'message':_0x284f41[_0x2b7b10(0xe9)],'stack':_0x284f41[_0x2b7b10(0x116)]}:_0x284f41,'payload':_0x49f32a});}[a48_0x5182e6(0xf4)](_0x234ef4,_0x2c3a46,_0x52556f,_0x187068,_0x3063fc){const _0x289078=a48_0x5182e6;this[_0x289078(0xcf)]('payments_created',{'type':'PAYMENT_CREATED','gateway':_0x234ef4,'paymentId':_0x2c3a46,'shopId':_0x52556f,'amount':_0x187068,'currency':_0x3063fc});}['logApiCall'](_0x1ac947,_0xc17a76,_0xbfa643,_0xacd5dc,_0x2acef4){const _0x361b34=a48_0x5182e6;this[_0x361b34(0xcf)]('api_calls',{'type':'API_CALL','endpoint':_0x1ac947,'method':_0xc17a76,'userId':_0xbfa643,'userRole':_0xacd5dc,'requestData':_0x2acef4});}[a48_0x5182e6(0xe0)](){const _0x178d29=a48_0x5182e6;try{const _0x220f02=fs_1[_0x178d29(0x117)][_0x178d29(0x10d)](this[_0x178d29(0xea)]),_0x49815c=_0x220f02[_0x178d29(0xfc)](_0x170bdd=>_0x170bdd[_0x178d29(0x108)](_0x178d29(0x101))),_0x2bcc19=[...new Set(_0x49815c[_0x178d29(0xec)](_0x3f908c=>_0x3f908c[_0x178d29(0xdd)]('_')[0x0]))],_0x3c8384=_0x49815c[_0x178d29(0xec)](_0x2546d2=>{const _0x37fa6b=_0x178d29,_0x1692a0=path_1[_0x37fa6b(0x117)][_0x37fa6b(0x103)](this[_0x37fa6b(0xea)],_0x2546d2),_0x3e6767=fs_1[_0x37fa6b(0x117)][_0x37fa6b(0xce)](_0x1692a0),[_0x1b2d6a,_0x1336db]=_0x2546d2[_0x37fa6b(0x112)](_0x37fa6b(0x101),'')[_0x37fa6b(0xdd)]('_');return{'type':_0x1b2d6a,'date':_0x1336db,'size':_0x3e6767[_0x37fa6b(0xf3)]};})[_0x178d29(0xd6)]((_0x4c7f94,_0x22573a)=>_0x22573a[_0x178d29(0xe4)][_0x178d29(0xe6)](_0x4c7f94[_0x178d29(0xe4)]));return{'totalFiles':_0x49815c['length'],'logTypes':_0x2bcc19,'latestLogs':_0x3c8384[_0x178d29(0xd0)](0x0,0xa)};}catch(_0x411b2e){return console[_0x178d29(0x120)](_0x178d29(0x121),_0x411b2e),{'totalFiles':0x0,'logTypes':[],'latestLogs':[]};}}[a48_0x5182e6(0xda)](_0x59a941=0x1e){const _0x385984=a48_0x5182e6;try{const _0x3552f3=fs_1[_0x385984(0x117)][_0x385984(0x10d)](this['logsDir']),_0x76749c=new Date();_0x76749c[_0x385984(0x11f)](_0x76749c['getDate']()-_0x59a941);let _0x1840d9=0x0;_0x3552f3[_0x385984(0xf1)](_0x33a989=>{const _0x44b3e4=_0x385984;if(!_0x33a989[_0x44b3e4(0x108)](_0x44b3e4(0x101)))return;const _0x5c55e1=path_1[_0x44b3e4(0x117)][_0x44b3e4(0x103)](this[_0x44b3e4(0xea)],_0x33a989),_0x43eb5d=fs_1[_0x44b3e4(0x117)]['statSync'](_0x5c55e1);_0x43eb5d['mtime']<_0x76749c&&(fs_1['default'][_0x44b3e4(0x105)](_0x5c55e1),_0x1840d9++,console[_0x44b3e4(0xf5)](_0x44b3e4(0xf8)+_0x33a989));}),console[_0x385984(0xf5)](_0x385984(0xe5)+_0x1840d9+_0x385984(0xe2)+_0x59a941+_0x385984(0xd2));}catch(_0x820135){console[_0x385984(0x120)](_0x385984(0x10e),_0x820135);}}}exports[a48_0x5182e6(0x107)]=LoggerService,exports[a48_0x5182e6(0x10b)]=new LoggerService();