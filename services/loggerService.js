'use strict';function a44_0x2a3c(_0x573b7c,_0x468d09){const _0x3921a4=a44_0x3921();return a44_0x2a3c=function(_0x2a3c75,_0x42f859){_0x2a3c75=_0x2a3c75-0x14f;let _0x4d94cb=_0x3921a4[_0x2a3c75];return _0x4d94cb;},a44_0x2a3c(_0x573b7c,_0x468d09);}const a44_0x453ef8=a44_0x2a3c;(function(_0x1de57e,_0x45ee2c){const _0x5ed5c4=a44_0x2a3c,_0x38be65=_0x1de57e();while(!![]){try{const _0x46fd34=parseInt(_0x5ed5c4(0x190))/0x1+-parseInt(_0x5ed5c4(0x162))/0x2+parseInt(_0x5ed5c4(0x175))/0x3*(-parseInt(_0x5ed5c4(0x19a))/0x4)+parseInt(_0x5ed5c4(0x17f))/0x5+parseInt(_0x5ed5c4(0x173))/0x6+-parseInt(_0x5ed5c4(0x1a4))/0x7*(-parseInt(_0x5ed5c4(0x152))/0x8)+-parseInt(_0x5ed5c4(0x156))/0x9;if(_0x46fd34===_0x45ee2c)break;else _0x38be65['push'](_0x38be65['shift']());}catch(_0x20c0b8){_0x38be65['push'](_0x38be65['shift']());}}}(a44_0x3921,0xccb29));var __importDefault=this&&this[a44_0x453ef8(0x16e)]||function(_0x136f75){const _0x40be0c=a44_0x453ef8;return _0x136f75&&_0x136f75[_0x40be0c(0x196)]?_0x136f75:{'default':_0x136f75};};Object['defineProperty'](exports,'__esModule',{'value':!![]}),exports['loggerService']=exports[a44_0x453ef8(0x169)]=void 0x0;const fs_1=__importDefault(require('fs')),path_1=__importDefault(require(a44_0x453ef8(0x17d)));class LoggerService{constructor(){const _0x3370f9=a44_0x453ef8;this['logsDir']=path_1[_0x3370f9(0x19d)][_0x3370f9(0x161)](process[_0x3370f9(0x159)](),_0x3370f9(0x167)),this[_0x3370f9(0x19b)]();}[a44_0x453ef8(0x19b)](){const _0x1172e3=a44_0x453ef8;!fs_1[_0x1172e3(0x19d)][_0x1172e3(0x151)](this[_0x1172e3(0x18f)])&&(fs_1['default'][_0x1172e3(0x176)](this[_0x1172e3(0x18f)],{'recursive':!![]}),console['log'](_0x1172e3(0x1a1)+this[_0x1172e3(0x18f)]));}[a44_0x453ef8(0x174)](_0x5843b1){const _0xcb4344=a44_0x453ef8,_0x213c51=new Date()['toISOString']()['split']('T')[0x0];return path_1[_0xcb4344(0x19d)]['join'](this[_0xcb4344(0x18f)],_0x5843b1+'_'+_0x213c51+_0xcb4344(0x1a5));}[a44_0x453ef8(0x17b)](_0x517809,_0x5cec96){const _0x46f051=a44_0x453ef8;try{const _0x5f1649=new Date()[_0x46f051(0x15f)](),_0x42ba9d={'timestamp':_0x5f1649,..._0x5cec96},_0x35f9f6=JSON['stringify'](_0x42ba9d)+'\x0a',_0x230c16=this[_0x46f051(0x174)](_0x517809);fs_1['default'][_0x46f051(0x183)](_0x230c16,_0x35f9f6,_0x46f051(0x19f));}catch(_0x493f75){console['error'](_0x46f051(0x18b)+_0x517809+_0x46f051(0x150),_0x493f75);}}[a44_0x453ef8(0x19c)](_0x38a606,_0x30a46e,_0xbf3c6c,_0x18a893){const _0x15fa25=a44_0x453ef8;this[_0x15fa25(0x17b)](_0x15fa25(0x172),{'type':'REQUEST','gateway':_0x38a606,'endpoint':_0x30a46e,'method':_0xbf3c6c,'data':_0x18a893});}[a44_0x453ef8(0x15e)](_0x524497,_0x4eb633,_0x5189ea,_0x947d67,_0x42a1ee){const _0x1b51de=a44_0x453ef8;this[_0x1b51de(0x17b)](_0x1b51de(0x153),{'type':_0x1b51de(0x166),'gateway':_0x524497,'endpoint':_0x4eb633,'status':_0x5189ea,'responseTime':_0x42a1ee,'data':_0x947d67});}[a44_0x453ef8(0x178)](_0x5b6fe4,_0x4e6a76,_0x9c6ab7){const _0x49b172=a44_0x453ef8;this['writeLog'](_0x49b172(0x17c),{'type':_0x49b172(0x16c),'gateway':_0x5b6fe4,'endpoint':_0x4e6a76,'error':_0x9c6ab7 instanceof Error?{'message':_0x9c6ab7[_0x49b172(0x182)],'stack':_0x9c6ab7[_0x49b172(0x155)]}:_0x9c6ab7});}[a44_0x453ef8(0x160)](_0x41b333,_0x46c9e3,_0x32d4f2){const _0x451d37=a44_0x453ef8;this[_0x451d37(0x17b)](_0x451d37(0x15d),{'type':_0x451d37(0x15c),'gateway':_0x41b333,'headers':_0x32d4f2,'data':_0x46c9e3});}[a44_0x453ef8(0x1a0)](_0x3c5f7d,_0x3bdf62,_0x3bf123,_0x5ca513,_0x17a9fc){const _0x4be594=a44_0x453ef8;this[_0x4be594(0x17b)](_0x4be594(0x154),{'type':'WEBHOOK_PROCESSED','gateway':_0x3c5f7d,'paymentId':_0x3bdf62,'oldStatus':_0x3bf123,'newStatus':_0x5ca513,'originalData':_0x17a9fc});}[a44_0x453ef8(0x1a3)](_0x21038c,_0x1feac3,_0x3ad04b){const _0x56e8e8=a44_0x453ef8;this['writeLog'](_0x56e8e8(0x171),{'type':_0x56e8e8(0x189),'gateway':_0x21038c,'error':_0x1feac3 instanceof Error?{'message':_0x1feac3['message'],'stack':_0x1feac3[_0x56e8e8(0x155)]}:_0x1feac3,'originalData':_0x3ad04b});}['logCoinToPayStatus'](_0x385fa4){const _0x9104df=a44_0x453ef8;this['writeLog'](_0x9104df(0x16f),{'type':_0x9104df(0x187),..._0x385fa4});}[a44_0x453ef8(0x165)](_0x48add2){const _0x3b7219=a44_0x453ef8;this[_0x3b7219(0x17b)](_0x3b7219(0x18c),{'type':_0x3b7219(0x1a2),..._0x48add2});}[a44_0x453ef8(0x15b)](_0x4e8d5b,_0x215158,_0xb366cc,_0xacfa2d,_0x19554f,_0x18f41e){const _0x2654c5=a44_0x453ef8;this[_0x2654c5(0x17b)](_0x2654c5(0x191),{'type':'SHOP_WEBHOOK_SENT','shopId':_0x4e8d5b,'webhookUrl':_0x215158,'event':_0xb366cc,'status':_0xacfa2d,'responseTime':_0x19554f,'payload':_0x18f41e});}[a44_0x453ef8(0x19e)](_0x295047,_0xb463e3,_0x1620cb,_0x4ae231,_0x3485a0){const _0x45a8de=a44_0x453ef8;this[_0x45a8de(0x17b)](_0x45a8de(0x17e),{'type':_0x45a8de(0x15a),'shopId':_0x295047,'webhookUrl':_0xb463e3,'event':_0x1620cb,'error':_0x4ae231 instanceof Error?{'message':_0x4ae231[_0x45a8de(0x182)],'stack':_0x4ae231[_0x45a8de(0x155)]}:_0x4ae231,'payload':_0x3485a0});}[a44_0x453ef8(0x18e)](_0xf9b495,_0x1738bd,_0x72f86a,_0x1fad62,_0x5eebe5){const _0x51f2b4=a44_0x453ef8;this['writeLog'](_0x51f2b4(0x16b),{'type':_0x51f2b4(0x170),'gateway':_0xf9b495,'paymentId':_0x1738bd,'shopId':_0x72f86a,'amount':_0x1fad62,'currency':_0x5eebe5});}[a44_0x453ef8(0x194)](_0x3604fe,_0x504fce,_0x4ed4b0,_0xd34a3d,_0x161ba2){const _0x5c906e=a44_0x453ef8;this[_0x5c906e(0x17b)](_0x5c906e(0x158),{'type':_0x5c906e(0x195),'endpoint':_0x3604fe,'method':_0x504fce,'userId':_0x4ed4b0,'userRole':_0xd34a3d,'requestData':_0x161ba2});}[a44_0x453ef8(0x199)](){const _0x1dcc3a=a44_0x453ef8;try{const _0xd616f5=fs_1['default'][_0x1dcc3a(0x184)](this[_0x1dcc3a(0x18f)]),_0x28588c=_0xd616f5[_0x1dcc3a(0x198)](_0x25be9f=>_0x25be9f[_0x1dcc3a(0x188)](_0x1dcc3a(0x1a5))),_0x53149c=[...new Set(_0x28588c[_0x1dcc3a(0x180)](_0x1db160=>_0x1db160[_0x1dcc3a(0x192)]('_')[0x0]))],_0x4327b8=_0x28588c['map'](_0x5a2adf=>{const _0x174f2c=_0x1dcc3a,_0xf3e846=path_1[_0x174f2c(0x19d)][_0x174f2c(0x161)](this[_0x174f2c(0x18f)],_0x5a2adf),_0x274854=fs_1[_0x174f2c(0x19d)][_0x174f2c(0x16a)](_0xf3e846),[_0x3c06d8,_0x5d876e]=_0x5a2adf[_0x174f2c(0x18d)](_0x174f2c(0x1a5),'')['split']('_');return{'type':_0x3c06d8,'date':_0x5d876e,'size':_0x274854[_0x174f2c(0x186)]};})[_0x1dcc3a(0x181)]((_0x5ea60e,_0xf756c1)=>_0xf756c1[_0x1dcc3a(0x17a)]['localeCompare'](_0x5ea60e[_0x1dcc3a(0x17a)]));return{'totalFiles':_0x28588c[_0x1dcc3a(0x157)],'logTypes':_0x53149c,'latestLogs':_0x4327b8[_0x1dcc3a(0x179)](0x0,0xa)};}catch(_0xb228ab){return console['error']('Failed\x20to\x20get\x20log\x20stats:',_0xb228ab),{'totalFiles':0x0,'logTypes':[],'latestLogs':[]};}}['cleanOldLogs'](_0x1a093a=0x1e){const _0x118911=a44_0x453ef8;try{const _0x55b593=fs_1[_0x118911(0x19d)][_0x118911(0x184)](this[_0x118911(0x18f)]),_0x24fbd7=new Date();_0x24fbd7['setDate'](_0x24fbd7[_0x118911(0x16d)]()-_0x1a093a);let _0x3a5ba6=0x0;_0x55b593[_0x118911(0x197)](_0x470a84=>{const _0x2490eb=_0x118911;if(!_0x470a84[_0x2490eb(0x188)](_0x2490eb(0x1a5)))return;const _0x8a1906=path_1[_0x2490eb(0x19d)][_0x2490eb(0x161)](this[_0x2490eb(0x18f)],_0x470a84),_0x325f81=fs_1['default'][_0x2490eb(0x16a)](_0x8a1906);_0x325f81[_0x2490eb(0x185)]<_0x24fbd7&&(fs_1[_0x2490eb(0x19d)][_0x2490eb(0x177)](_0x8a1906),_0x3a5ba6++,console[_0x2490eb(0x164)](_0x2490eb(0x18a)+_0x470a84));}),console[_0x118911(0x164)]('ğŸ§¹\x20Cleaned\x20'+_0x3a5ba6+_0x118911(0x14f)+_0x1a093a+'\x20days)');}catch(_0x342e08){console[_0x118911(0x168)](_0x118911(0x193),_0x342e08);}}}exports[a44_0x453ef8(0x169)]=LoggerService,exports[a44_0x453ef8(0x163)]=new LoggerService();function a44_0x3921(){const _0x2aee6f=['logShopWebhookError','utf8','logWebhookProcessed','ğŸ“\x20Created\x20logs\x20directory:\x20','COINTOPAY_ERROR','logWebhookError','899773JjJPyL','.log','\x20old\x20log\x20files\x20(older\x20than\x20','\x20log:','existsSync','56fywmQn','white_domain_responses','webhooks_processed','stack','33844977uVkPWz','length','api_calls','cwd','SHOP_WEBHOOK_ERROR','logShopWebhookSent','WEBHOOK_RECEIVED','webhooks_received','logWhiteDomainResponse','toISOString','logWebhookReceived','join','337992ffDWWW','loggerService','log','logCoinToPayError','RESPONSE','logs','error','LoggerService','statSync','payments_created','ERROR','getDate','__importDefault','cointopay_status_changes','PAYMENT_CREATED','webhooks_errors','white_domain_requests','8296500ehBhoP','getLogFileName','393JkOCRz','mkdirSync','unlinkSync','logWhiteDomainError','slice','date','writeLog','white_domain_errors','path','shop_webhooks_errors','7074480rQoxue','map','sort','message','appendFileSync','readdirSync','mtime','size','COINTOPAY_STATUS_CHANGE','endsWith','WEBHOOK_ERROR','ğŸ—‘ï¸\x20Deleted\x20old\x20log\x20file:\x20','Failed\x20to\x20write\x20','cointopay_errors','replace','logPaymentCreated','logsDir','1289996zoqpGZ','shop_webhooks_sent','split','Failed\x20to\x20clean\x20old\x20logs:','logApiCall','API_CALL','__esModule','forEach','filter','getLogStats','6700TEYPJc','ensureLogsDirectory','logWhiteDomainRequest','default'];a44_0x3921=function(){return _0x2aee6f;};return a44_0x3921();}