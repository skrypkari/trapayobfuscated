'use strict';const a44_0x7a764=a44_0x3dbc;(function(_0x453572,_0xa19ad){const _0x49e28e=a44_0x3dbc,_0x17af3d=_0x453572();while(!![]){try{const _0x1fb53b=parseInt(_0x49e28e(0xa2))/0x1+parseInt(_0x49e28e(0x8f))/0x2+-parseInt(_0x49e28e(0x89))/0x3*(-parseInt(_0x49e28e(0xa3))/0x4)+-parseInt(_0x49e28e(0xbd))/0x5+parseInt(_0x49e28e(0x83))/0x6*(parseInt(_0x49e28e(0x90))/0x7)+-parseInt(_0x49e28e(0x96))/0x8+-parseInt(_0x49e28e(0xc7))/0x9*(parseInt(_0x49e28e(0x8b))/0xa);if(_0x1fb53b===_0xa19ad)break;else _0x17af3d['push'](_0x17af3d['shift']());}catch(_0x366774){_0x17af3d['push'](_0x17af3d['shift']());}}}(a44_0x1b82,0xba05b));var __importDefault=this&&this['__importDefault']||function(_0x55f3cf){const _0x463b04=a44_0x3dbc;return _0x55f3cf&&_0x55f3cf[_0x463b04(0xb9)]?_0x55f3cf:{'default':_0x55f3cf};};Object[a44_0x7a764(0x91)](exports,'__esModule',{'value':!![]}),exports[a44_0x7a764(0xb4)]=exports[a44_0x7a764(0xb1)]=void 0x0;function a44_0x3dbc(_0x3a1b06,_0x31468f){const _0x1b820e=a44_0x1b82();return a44_0x3dbc=function(_0x3dbc3a,_0x5bdab3){_0x3dbc3a=_0x3dbc3a-0x82;let _0xf3e366=_0x1b820e[_0x3dbc3a];return _0xf3e366;},a44_0x3dbc(_0x3a1b06,_0x31468f);}const fs_1=__importDefault(require('fs')),path_1=__importDefault(require(a44_0x7a764(0x8a)));function a44_0x1b82(){const _0x4ba924=['cwd','endsWith','\x20days)','white_domain_errors','WEBHOOK_RECEIVED','writeLog','ensureLogsDirectory','Failed\x20to\x20clean\x20old\x20logs:','error','getLogFileName','\x20log:','1467798SdQMNg','1494644XMjLxA','white_domain_requests','message','map','\x20old\x20log\x20files\x20(older\x20than\x20','webhooks_received','shop_webhooks_errors','cleanOldLogs','mkdirSync','statSync','logWhiteDomainResponse','Failed\x20to\x20write\x20','REQUEST','join','LoggerService','getDate','getLogStats','loggerService','logsDir','setDate','ERROR','.log','__esModule','payments_created','webhooks_errors','sort','1051990zcvKdg','logShopWebhookSent','logWebhookError','default','RESPONSE','log','toISOString','logWebhookProcessed','API_CALL','length','9FKeDpa','webhooks_processed','PAYMENT_CREATED','ðŸ“\x20Created\x20logs\x20directory:\x20','date','logWhiteDomainError','6tdtfbp','stack','ðŸ—‘ï¸\x20Deleted\x20old\x20log\x20file:\x20','split','Failed\x20to\x20get\x20log\x20stats:','white_domain_responses','3rfKcyR','path','14457410MLbdaQ','unlinkSync','WEBHOOK_PROCESSED','readdirSync','2937280OqtNjP','1033732shbfRm','defineProperty','utf8','slice','size','logWhiteDomainRequest','8317512oSkVmi'];a44_0x1b82=function(){return _0x4ba924;};return a44_0x1b82();}class LoggerService{constructor(){const _0x3e6ef5=a44_0x7a764;this['logsDir']=path_1['default'][_0x3e6ef5(0xb0)](process[_0x3e6ef5(0x97)](),'logs'),this['ensureLogsDirectory']();}[a44_0x7a764(0x9d)](){const _0x6900f1=a44_0x7a764;!fs_1['default']['existsSync'](this['logsDir'])&&(fs_1[_0x6900f1(0xc0)][_0x6900f1(0xab)](this['logsDir'],{'recursive':!![]}),console['log'](_0x6900f1(0xca)+this[_0x6900f1(0xb5)]));}[a44_0x7a764(0xa0)](_0x5ef3db){const _0x4d04ce=a44_0x7a764,_0x5b4ec5=new Date()[_0x4d04ce(0xc3)]()[_0x4d04ce(0x86)]('T')[0x0];return path_1['default']['join'](this[_0x4d04ce(0xb5)],_0x5ef3db+'_'+_0x5b4ec5+'.log');}[a44_0x7a764(0x9c)](_0x201ae4,_0x3eaf2f){const _0x24473e=a44_0x7a764;try{const _0x14a12b=new Date()[_0x24473e(0xc3)](),_0x51bcb1={'timestamp':_0x14a12b,..._0x3eaf2f},_0x5ead45=JSON['stringify'](_0x51bcb1)+'\x0a',_0x8d0ce1=this[_0x24473e(0xa0)](_0x201ae4);fs_1[_0x24473e(0xc0)]['appendFileSync'](_0x8d0ce1,_0x5ead45,_0x24473e(0x92));}catch(_0x243bbf){console[_0x24473e(0x9f)](_0x24473e(0xae)+_0x201ae4+_0x24473e(0xa1),_0x243bbf);}}[a44_0x7a764(0x95)](_0x582f22,_0x1bfcf6,_0x444472,_0x34a014){const _0x8770d7=a44_0x7a764;this[_0x8770d7(0x9c)](_0x8770d7(0xa4),{'type':_0x8770d7(0xaf),'gateway':_0x582f22,'endpoint':_0x1bfcf6,'method':_0x444472,'data':_0x34a014});}[a44_0x7a764(0xad)](_0x2d3563,_0x56c05e,_0x41884e,_0x797f10,_0x2ddd20){const _0x337ccb=a44_0x7a764;this[_0x337ccb(0x9c)](_0x337ccb(0x88),{'type':_0x337ccb(0xc1),'gateway':_0x2d3563,'endpoint':_0x56c05e,'status':_0x41884e,'responseTime':_0x2ddd20,'data':_0x797f10});}[a44_0x7a764(0x82)](_0x2fd060,_0x355070,_0x32d31e){const _0x3d7df8=a44_0x7a764;this[_0x3d7df8(0x9c)](_0x3d7df8(0x9a),{'type':_0x3d7df8(0xb7),'gateway':_0x2fd060,'endpoint':_0x355070,'error':_0x32d31e instanceof Error?{'message':_0x32d31e['message'],'stack':_0x32d31e[_0x3d7df8(0x84)]}:_0x32d31e});}['logWebhookReceived'](_0x5f1b84,_0x1f60e4,_0x45ede5){const _0x29a804=a44_0x7a764;this[_0x29a804(0x9c)](_0x29a804(0xa8),{'type':_0x29a804(0x9b),'gateway':_0x5f1b84,'headers':_0x45ede5,'data':_0x1f60e4});}[a44_0x7a764(0xc4)](_0x3e43a9,_0x404cb2,_0x5bebed,_0xe787c1,_0x1876bf){const _0x41d1a6=a44_0x7a764;this[_0x41d1a6(0x9c)](_0x41d1a6(0xc8),{'type':_0x41d1a6(0x8d),'gateway':_0x3e43a9,'paymentId':_0x404cb2,'oldStatus':_0x5bebed,'newStatus':_0xe787c1,'originalData':_0x1876bf});}[a44_0x7a764(0xbf)](_0x2e041e,_0x5319a0,_0x9ffe5c){const _0x1fed9c=a44_0x7a764;this[_0x1fed9c(0x9c)](_0x1fed9c(0xbb),{'type':'WEBHOOK_ERROR','gateway':_0x2e041e,'error':_0x5319a0 instanceof Error?{'message':_0x5319a0[_0x1fed9c(0xa5)],'stack':_0x5319a0[_0x1fed9c(0x84)]}:_0x5319a0,'originalData':_0x9ffe5c});}[a44_0x7a764(0xbe)](_0x2b40a1,_0x31af92,_0x5d8f7a,_0x2bbd88,_0x53dffa,_0x2eb357){const _0x55b853=a44_0x7a764;this[_0x55b853(0x9c)]('shop_webhooks_sent',{'type':'SHOP_WEBHOOK_SENT','shopId':_0x2b40a1,'webhookUrl':_0x31af92,'event':_0x5d8f7a,'status':_0x2bbd88,'responseTime':_0x53dffa,'payload':_0x2eb357});}['logShopWebhookError'](_0x24cf29,_0x17b9c8,_0x4c35f8,_0x192cd4,_0x2ad259){const _0x2e381e=a44_0x7a764;this['writeLog'](_0x2e381e(0xa9),{'type':'SHOP_WEBHOOK_ERROR','shopId':_0x24cf29,'webhookUrl':_0x17b9c8,'event':_0x4c35f8,'error':_0x192cd4 instanceof Error?{'message':_0x192cd4['message'],'stack':_0x192cd4[_0x2e381e(0x84)]}:_0x192cd4,'payload':_0x2ad259});}['logPaymentCreated'](_0x40a09c,_0x4daf85,_0x118d94,_0x41dd1d,_0x167737){const _0x2c7815=a44_0x7a764;this[_0x2c7815(0x9c)](_0x2c7815(0xba),{'type':_0x2c7815(0xc9),'gateway':_0x40a09c,'paymentId':_0x4daf85,'shopId':_0x118d94,'amount':_0x41dd1d,'currency':_0x167737});}['logApiCall'](_0x5bb3ac,_0x52f422,_0x457f92,_0x58d6d3,_0x1e575a){const _0x558fb9=a44_0x7a764;this[_0x558fb9(0x9c)]('api_calls',{'type':_0x558fb9(0xc5),'endpoint':_0x5bb3ac,'method':_0x52f422,'userId':_0x457f92,'userRole':_0x58d6d3,'requestData':_0x1e575a});}[a44_0x7a764(0xb3)](){const _0x3dd859=a44_0x7a764;try{const _0x6099ae=fs_1['default'][_0x3dd859(0x8e)](this[_0x3dd859(0xb5)]),_0x264290=_0x6099ae['filter'](_0x9cc0b9=>_0x9cc0b9[_0x3dd859(0x98)](_0x3dd859(0xb8))),_0x1894d0=[...new Set(_0x264290[_0x3dd859(0xa6)](_0x12d365=>_0x12d365[_0x3dd859(0x86)]('_')[0x0]))],_0x19026d=_0x264290[_0x3dd859(0xa6)](_0x3f4608=>{const _0x363a97=_0x3dd859,_0x4748f5=path_1['default'][_0x363a97(0xb0)](this[_0x363a97(0xb5)],_0x3f4608),_0x5c0a6f=fs_1[_0x363a97(0xc0)][_0x363a97(0xac)](_0x4748f5),[_0x426e16,_0x50258a]=_0x3f4608['replace'](_0x363a97(0xb8),'')['split']('_');return{'type':_0x426e16,'date':_0x50258a,'size':_0x5c0a6f[_0x363a97(0x94)]};})[_0x3dd859(0xbc)]((_0xc00983,_0x9c24d3)=>_0x9c24d3['date']['localeCompare'](_0xc00983[_0x3dd859(0xcb)]));return{'totalFiles':_0x264290[_0x3dd859(0xc6)],'logTypes':_0x1894d0,'latestLogs':_0x19026d[_0x3dd859(0x93)](0x0,0xa)};}catch(_0x3e11b3){return console[_0x3dd859(0x9f)](_0x3dd859(0x87),_0x3e11b3),{'totalFiles':0x0,'logTypes':[],'latestLogs':[]};}}[a44_0x7a764(0xaa)](_0x53cf54=0x1e){const _0x2d2f97=a44_0x7a764;try{const _0x3ce6c9=fs_1['default'][_0x2d2f97(0x8e)](this['logsDir']),_0x252d77=new Date();_0x252d77[_0x2d2f97(0xb6)](_0x252d77[_0x2d2f97(0xb2)]()-_0x53cf54);let _0x2ca410=0x0;_0x3ce6c9['forEach'](_0x51767b=>{const _0x1f6b36=_0x2d2f97;if(!_0x51767b['endsWith']('.log'))return;const _0x414ccb=path_1['default'][_0x1f6b36(0xb0)](this[_0x1f6b36(0xb5)],_0x51767b),_0x2e5bca=fs_1[_0x1f6b36(0xc0)][_0x1f6b36(0xac)](_0x414ccb);_0x2e5bca['mtime']<_0x252d77&&(fs_1[_0x1f6b36(0xc0)][_0x1f6b36(0x8c)](_0x414ccb),_0x2ca410++,console[_0x1f6b36(0xc2)](_0x1f6b36(0x85)+_0x51767b));}),console[_0x2d2f97(0xc2)]('ðŸ§¹\x20Cleaned\x20'+_0x2ca410+_0x2d2f97(0xa7)+_0x53cf54+_0x2d2f97(0x99));}catch(_0x564e44){console[_0x2d2f97(0x9f)](_0x2d2f97(0x9e),_0x564e44);}}}exports[a44_0x7a764(0xb1)]=LoggerService,exports['loggerService']=new LoggerService();