'use strict';const a44_0x6ce4b8=a44_0x294f;(function(_0x31164c,_0x3b1068){const _0x5b5015=a44_0x294f,_0x32af30=_0x31164c();while(!![]){try{const _0x2e9cc2=parseInt(_0x5b5015(0xcc))/0x1*(-parseInt(_0x5b5015(0xe9))/0x2)+-parseInt(_0x5b5015(0xbb))/0x3+-parseInt(_0x5b5015(0xcf))/0x4*(parseInt(_0x5b5015(0xa1))/0x5)+parseInt(_0x5b5015(0xa6))/0x6*(parseInt(_0x5b5015(0xb0))/0x7)+parseInt(_0x5b5015(0xce))/0x8*(-parseInt(_0x5b5015(0xd4))/0x9)+parseInt(_0x5b5015(0xbe))/0xa*(-parseInt(_0x5b5015(0xe3))/0xb)+parseInt(_0x5b5015(0xc7))/0xc;if(_0x2e9cc2===_0x3b1068)break;else _0x32af30['push'](_0x32af30['shift']());}catch(_0x4aeaf0){_0x32af30['push'](_0x32af30['shift']());}}}(a44_0x1b85,0x97e53));var __importDefault=this&&this[a44_0x6ce4b8(0xd6)]||function(_0x1ee7b8){const _0x1a02f5=a44_0x6ce4b8;return _0x1ee7b8&&_0x1ee7b8[_0x1a02f5(0xe1)]?_0x1ee7b8:{'default':_0x1ee7b8};};function a44_0x294f(_0x47ac3a,_0x4b255f){const _0x1b85d9=a44_0x1b85();return a44_0x294f=function(_0x294fc2,_0x56e9fc){_0x294fc2=_0x294fc2-0x9d;let _0x17591b=_0x1b85d9[_0x294fc2];return _0x17591b;},a44_0x294f(_0x47ac3a,_0x4b255f);}Object[a44_0x6ce4b8(0xa9)](exports,'__esModule',{'value':!![]}),exports[a44_0x6ce4b8(0xe0)]=exports['LoggerService']=void 0x0;const fs_1=__importDefault(require('fs')),path_1=__importDefault(require(a44_0x6ce4b8(0xb8)));class LoggerService{constructor(){const _0x3740c3=a44_0x6ce4b8;this['logsDir']=path_1['default'][_0x3740c3(0xa0)](process[_0x3740c3(0xa8)](),'logs'),this['ensureLogsDirectory']();}[a44_0x6ce4b8(0xa5)](){const _0x2a0866=a44_0x6ce4b8;!fs_1[_0x2a0866(0xc4)][_0x2a0866(0xc5)](this[_0x2a0866(0xaf)])&&(fs_1['default']['mkdirSync'](this['logsDir'],{'recursive':!![]}),console['log'](_0x2a0866(0xe2)+this[_0x2a0866(0xaf)]));}['getLogFileName'](_0x31154f){const _0x1c7eda=a44_0x6ce4b8,_0xe70c03=new Date()[_0x1c7eda(0xa3)]()['split']('T')[0x0];return path_1['default']['join'](this[_0x1c7eda(0xaf)],_0x31154f+'_'+_0xe70c03+'.log');}[a44_0x6ce4b8(0xbc)](_0x57c81e,_0x1af175){const _0x12f823=a44_0x6ce4b8;try{const _0x1f017d=new Date()['toISOString'](),_0x1c7187={'timestamp':_0x1f017d,..._0x1af175},_0x3062cc=JSON[_0x12f823(0xb5)](_0x1c7187)+'\x0a',_0x203adb=this['getLogFileName'](_0x57c81e);fs_1[_0x12f823(0xc4)]['appendFileSync'](_0x203adb,_0x3062cc,_0x12f823(0x9f));}catch(_0x14cf37){console[_0x12f823(0xbf)](_0x12f823(0xec)+_0x57c81e+_0x12f823(0xd2),_0x14cf37);}}[a44_0x6ce4b8(0xc6)](_0x4cb55d,_0x3818c1,_0x14c9a4,_0x21bfd6){const _0x45046e=a44_0x6ce4b8;this[_0x45046e(0xbc)](_0x45046e(0xda),{'type':_0x45046e(0xe6),'gateway':_0x4cb55d,'endpoint':_0x3818c1,'method':_0x14c9a4,'data':_0x21bfd6});}[a44_0x6ce4b8(0xdc)](_0x2cf9e9,_0xe850ec,_0x15025f,_0x172cec,_0x1a8dd1){const _0xd6c04e=a44_0x6ce4b8;this[_0xd6c04e(0xbc)](_0xd6c04e(0xba),{'type':'RESPONSE','gateway':_0x2cf9e9,'endpoint':_0xe850ec,'status':_0x15025f,'responseTime':_0x1a8dd1,'data':_0x172cec});}['logWhiteDomainError'](_0x1c359a,_0xd6de8c,_0xeafc0a){const _0x17896f=a44_0x6ce4b8;this['writeLog'](_0x17896f(0xac),{'type':_0x17896f(0xb6),'gateway':_0x1c359a,'endpoint':_0xd6de8c,'error':_0xeafc0a instanceof Error?{'message':_0xeafc0a['message'],'stack':_0xeafc0a[_0x17896f(0xdd)]}:_0xeafc0a});}[a44_0x6ce4b8(0xb4)](_0x38c330,_0x30cf85,_0x39243f){const _0x185442=a44_0x6ce4b8;this[_0x185442(0xbc)]('webhooks_received',{'type':_0x185442(0xa4),'gateway':_0x38c330,'headers':_0x39243f,'data':_0x30cf85});}[a44_0x6ce4b8(0xca)](_0x30c6cc,_0x501348,_0x323145,_0x43455d,_0x187f77){const _0x4169d2=a44_0x6ce4b8;this[_0x4169d2(0xbc)]('webhooks_processed',{'type':_0x4169d2(0x9d),'gateway':_0x30c6cc,'paymentId':_0x501348,'oldStatus':_0x323145,'newStatus':_0x43455d,'originalData':_0x187f77});}[a44_0x6ce4b8(0xd3)](_0x382ddb,_0x298cd9,_0x41177b){const _0x21a1ad=a44_0x6ce4b8;this['writeLog'](_0x21a1ad(0xd1),{'type':_0x21a1ad(0xc1),'gateway':_0x382ddb,'error':_0x298cd9 instanceof Error?{'message':_0x298cd9[_0x21a1ad(0xe7)],'stack':_0x298cd9[_0x21a1ad(0xdd)]}:_0x298cd9,'originalData':_0x41177b});}[a44_0x6ce4b8(0xe5)](_0x57a56c,_0x3f8bca,_0x5629e4,_0x595cfa,_0x2e2831,_0x12e0d8){const _0x576d59=a44_0x6ce4b8;this[_0x576d59(0xbc)](_0x576d59(0xd5),{'type':_0x576d59(0xb3),'shopId':_0x57a56c,'webhookUrl':_0x3f8bca,'event':_0x5629e4,'status':_0x595cfa,'responseTime':_0x2e2831,'payload':_0x12e0d8});}[a44_0x6ce4b8(0xd7)](_0x4a8805,_0x59c48a,_0x5da8e0,_0x4c1313,_0x554888){const _0x4315a2=a44_0x6ce4b8;this[_0x4315a2(0xbc)](_0x4315a2(0xab),{'type':_0x4315a2(0xea),'shopId':_0x4a8805,'webhookUrl':_0x59c48a,'event':_0x5da8e0,'error':_0x4c1313 instanceof Error?{'message':_0x4c1313[_0x4315a2(0xe7)],'stack':_0x4c1313['stack']}:_0x4c1313,'payload':_0x554888});}['logPaymentCreated'](_0x4f3977,_0x236e36,_0x3749f7,_0x1ad938,_0x9a3139){const _0x27abec=a44_0x6ce4b8;this[_0x27abec(0xbc)](_0x27abec(0xa2),{'type':_0x27abec(0xed),'gateway':_0x4f3977,'paymentId':_0x236e36,'shopId':_0x3749f7,'amount':_0x1ad938,'currency':_0x9a3139});}[a44_0x6ce4b8(0xc3)](_0x51d641,_0x10bb63,_0x1b9b8f,_0x493e35,_0x54327d){const _0x19b096=a44_0x6ce4b8;this[_0x19b096(0xbc)](_0x19b096(0xc2),{'type':_0x19b096(0xb9),'endpoint':_0x51d641,'method':_0x10bb63,'userId':_0x1b9b8f,'userRole':_0x493e35,'requestData':_0x54327d});}[a44_0x6ce4b8(0xde)](){const _0x17dc7f=a44_0x6ce4b8;try{const _0x270f15=fs_1[_0x17dc7f(0xc4)][_0x17dc7f(0xdf)](this[_0x17dc7f(0xaf)]),_0x42376b=_0x270f15['filter'](_0x1f48c5=>_0x1f48c5[_0x17dc7f(0xcd)](_0x17dc7f(0xd8))),_0x4bbcaf=[...new Set(_0x42376b[_0x17dc7f(0xd9)](_0x29fdbe=>_0x29fdbe[_0x17dc7f(0xe8)]('_')[0x0]))],_0x441b2f=_0x42376b['map'](_0x1233fb=>{const _0x85f8fc=_0x17dc7f,_0x6d8715=path_1[_0x85f8fc(0xc4)][_0x85f8fc(0xa0)](this[_0x85f8fc(0xaf)],_0x1233fb),_0x21c974=fs_1[_0x85f8fc(0xc4)]['statSync'](_0x6d8715),[_0x5a192d,_0xffb549]=_0x1233fb[_0x85f8fc(0xa7)](_0x85f8fc(0xd8),'')['split']('_');return{'type':_0x5a192d,'date':_0xffb549,'size':_0x21c974[_0x85f8fc(0xd0)]};})[_0x17dc7f(0xe4)]((_0xa7c5b4,_0x2bec1c)=>_0x2bec1c[_0x17dc7f(0xeb)][_0x17dc7f(0xc8)](_0xa7c5b4[_0x17dc7f(0xeb)]));return{'totalFiles':_0x42376b[_0x17dc7f(0xb1)],'logTypes':_0x4bbcaf,'latestLogs':_0x441b2f[_0x17dc7f(0xad)](0x0,0xa)};}catch(_0x193a68){return console[_0x17dc7f(0xbf)]('Failed\x20to\x20get\x20log\x20stats:',_0x193a68),{'totalFiles':0x0,'logTypes':[],'latestLogs':[]};}}['cleanOldLogs'](_0x52017b=0x1e){const _0x3e1c3c=a44_0x6ce4b8;try{const _0x57e4de=fs_1[_0x3e1c3c(0xc4)][_0x3e1c3c(0xdf)](this['logsDir']),_0x467ae0=new Date();_0x467ae0[_0x3e1c3c(0xbd)](_0x467ae0[_0x3e1c3c(0xb2)]()-_0x52017b);let _0x3aafc3=0x0;_0x57e4de[_0x3e1c3c(0xc0)](_0x2090e6=>{const _0x2c8ce4=_0x3e1c3c;if(!_0x2090e6[_0x2c8ce4(0xcd)](_0x2c8ce4(0xd8)))return;const _0x3c8393=path_1[_0x2c8ce4(0xc4)][_0x2c8ce4(0xa0)](this[_0x2c8ce4(0xaf)],_0x2090e6),_0x1b4712=fs_1['default'][_0x2c8ce4(0xaa)](_0x3c8393);_0x1b4712[_0x2c8ce4(0xc9)]<_0x467ae0&&(fs_1[_0x2c8ce4(0xc4)][_0x2c8ce4(0xb7)](_0x3c8393),_0x3aafc3++,console[_0x2c8ce4(0xdb)](_0x2c8ce4(0x9e)+_0x2090e6));}),console[_0x3e1c3c(0xdb)](_0x3e1c3c(0xcb)+_0x3aafc3+'\x20old\x20log\x20files\x20(older\x20than\x20'+_0x52017b+'\x20days)');}catch(_0x503620){console[_0x3e1c3c(0xbf)]('Failed\x20to\x20clean\x20old\x20logs:',_0x503620);}}}exports[a44_0x6ce4b8(0xae)]=LoggerService,exports[a44_0x6ce4b8(0xe0)]=new LoggerService();function a44_0x1b85(){const _0x5ea991=['toISOString','WEBHOOK_RECEIVED','ensureLogsDirectory','5677554CSShju','replace','cwd','defineProperty','statSync','shop_webhooks_errors','white_domain_errors','slice','LoggerService','logsDir','7unnxPl','length','getDate','SHOP_WEBHOOK_SENT','logWebhookReceived','stringify','ERROR','unlinkSync','path','API_CALL','white_domain_responses','1200273IbPMUt','writeLog','setDate','10gcrqRs','error','forEach','WEBHOOK_ERROR','api_calls','logApiCall','default','existsSync','logWhiteDomainRequest','39977124GloOpe','localeCompare','mtime','logWebhookProcessed','ðŸ§¹\x20Cleaned\x20','5lXgcAM','endsWith','8eRINGv','12DVQxiN','size','webhooks_errors','\x20log:','logWebhookError','6378516ewZOwt','shop_webhooks_sent','__importDefault','logShopWebhookError','.log','map','white_domain_requests','log','logWhiteDomainResponse','stack','getLogStats','readdirSync','loggerService','__esModule','ðŸ“\x20Created\x20logs\x20directory:\x20','7973339aMzAlv','sort','logShopWebhookSent','REQUEST','message','split','364600lIyJFI','SHOP_WEBHOOK_ERROR','date','Failed\x20to\x20write\x20','PAYMENT_CREATED','WEBHOOK_PROCESSED','ðŸ—‘ï¸\x20Deleted\x20old\x20log\x20file:\x20','utf8','join','1517265uySABM','payments_created'];a44_0x1b85=function(){return _0x5ea991;};return a44_0x1b85();}