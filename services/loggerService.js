'use strict';const a48_0x2abf17=a48_0x7a11;(function(_0x27a839,_0x45f3e9){const _0x1bdc49=a48_0x7a11,_0x2f7e13=_0x27a839();while(!![]){try{const _0x42357e=parseInt(_0x1bdc49(0x10c))/0x1+parseInt(_0x1bdc49(0xfc))/0x2+-parseInt(_0x1bdc49(0xf5))/0x3*(parseInt(_0x1bdc49(0x123))/0x4)+parseInt(_0x1bdc49(0xda))/0x5*(parseInt(_0x1bdc49(0x110))/0x6)+-parseInt(_0x1bdc49(0x10a))/0x7*(-parseInt(_0x1bdc49(0xd9))/0x8)+parseInt(_0x1bdc49(0xf0))/0x9*(-parseInt(_0x1bdc49(0x10f))/0xa)+parseInt(_0x1bdc49(0x129))/0xb;if(_0x42357e===_0x45f3e9)break;else _0x2f7e13['push'](_0x2f7e13['shift']());}catch(_0x155b27){_0x2f7e13['push'](_0x2f7e13['shift']());}}}(a48_0x98fb,0x23ed3));function a48_0x7a11(_0x462638,_0x35f44f){const _0x98fbaf=a48_0x98fb();return a48_0x7a11=function(_0x7a1176,_0x43650d){_0x7a1176=_0x7a1176-0xd8;let _0x36adfe=_0x98fbaf[_0x7a1176];return _0x36adfe;},a48_0x7a11(_0x462638,_0x35f44f);}var __importDefault=this&&this[a48_0x2abf17(0x119)]||function(_0x1e8225){const _0x263bd8=a48_0x2abf17;return _0x1e8225&&_0x1e8225[_0x263bd8(0xf7)]?_0x1e8225:{'default':_0x1e8225};};Object[a48_0x2abf17(0x111)](exports,a48_0x2abf17(0xf7),{'value':!![]}),exports['loggerService']=exports[a48_0x2abf17(0xdd)]=void 0x0;const fs_1=__importDefault(require('fs')),path_1=__importDefault(require('path'));class LoggerService{constructor(){const _0x4cb4d4=a48_0x2abf17;this[_0x4cb4d4(0x115)]=path_1[_0x4cb4d4(0x122)][_0x4cb4d4(0xf4)](process[_0x4cb4d4(0xf9)](),_0x4cb4d4(0x124)),this[_0x4cb4d4(0xd8)]();}[a48_0x2abf17(0xd8)](){const _0xd85dca=a48_0x2abf17;!fs_1['default'][_0xd85dca(0x11a)](this['logsDir'])&&(fs_1['default'][_0xd85dca(0x109)](this['logsDir'],{'recursive':!![]}),console[_0xd85dca(0xe4)](_0xd85dca(0xdf)+this['logsDir']));}['getLogFileName'](_0x402b92){const _0x223e13=a48_0x2abf17,_0x1a80df=new Date()[_0x223e13(0x126)]()[_0x223e13(0xf8)]('T')[0x0];return path_1[_0x223e13(0x122)]['join'](this[_0x223e13(0x115)],_0x402b92+'_'+_0x1a80df+_0x223e13(0x10e));}['writeLog'](_0x5dae03,_0x4d1b37){const _0x1262d1=a48_0x2abf17;try{const _0x59b6e7=new Date()[_0x1262d1(0x126)](),_0x579260={'timestamp':_0x59b6e7,..._0x4d1b37},_0x4f1573=JSON['stringify'](_0x579260)+'\x0a',_0x134aa9=this[_0x1262d1(0xf3)](_0x5dae03);fs_1[_0x1262d1(0x122)]['appendFileSync'](_0x134aa9,_0x4f1573,_0x1262d1(0x11d));}catch(_0x15d5c7){console[_0x1262d1(0x116)](_0x1262d1(0x10b)+_0x5dae03+'\x20log:',_0x15d5c7);}}[a48_0x2abf17(0xed)](_0x54990b,_0x3ec8ee,_0x30ad10,_0x349f2d){const _0x41a2e2=a48_0x2abf17;this[_0x41a2e2(0xfe)](_0x41a2e2(0xe9),{'type':_0x41a2e2(0x105),'gateway':_0x54990b,'endpoint':_0x3ec8ee,'method':_0x30ad10,'data':_0x349f2d});}['logWhiteDomainResponse'](_0x5df93a,_0x3389ea,_0x5a58d8,_0x4db7db,_0x501f6d){const _0x117c58=a48_0x2abf17;this[_0x117c58(0xfe)](_0x117c58(0xe3),{'type':'RESPONSE','gateway':_0x5df93a,'endpoint':_0x3389ea,'status':_0x5a58d8,'responseTime':_0x501f6d,'data':_0x4db7db});}[a48_0x2abf17(0x114)](_0x1e79fc,_0x2a6d98,_0x93d114){const _0x9146c5=a48_0x2abf17;this[_0x9146c5(0xfe)](_0x9146c5(0x106),{'type':_0x9146c5(0xf1),'gateway':_0x1e79fc,'endpoint':_0x2a6d98,'error':_0x93d114 instanceof Error?{'message':_0x93d114[_0x9146c5(0xfd)],'stack':_0x93d114['stack']}:_0x93d114});}[a48_0x2abf17(0x100)](_0x89f873,_0x17ddd5,_0x441ed8){const _0xab98bb=a48_0x2abf17;this[_0xab98bb(0xfe)](_0xab98bb(0xe1),{'type':'WEBHOOK_RECEIVED','gateway':_0x89f873,'headers':_0x441ed8,'data':_0x17ddd5});}['logWebhookProcessed'](_0x4a5c39,_0x2ae0a3,_0x5330bd,_0x56930f,_0x5f01bb){const _0x11d796=a48_0x2abf17;this[_0x11d796(0xfe)]('webhooks_processed',{'type':'WEBHOOK_PROCESSED','gateway':_0x4a5c39,'paymentId':_0x2ae0a3,'oldStatus':_0x5330bd,'newStatus':_0x56930f,'originalData':_0x5f01bb});}[a48_0x2abf17(0x107)](_0x526db0,_0x1299a3,_0x207b5e){const _0x3ad09c=a48_0x2abf17;this[_0x3ad09c(0xfe)](_0x3ad09c(0xef),{'type':_0x3ad09c(0xe2),'gateway':_0x526db0,'error':_0x1299a3 instanceof Error?{'message':_0x1299a3['message'],'stack':_0x1299a3[_0x3ad09c(0xde)]}:_0x1299a3,'originalData':_0x207b5e});}[a48_0x2abf17(0xeb)](_0x453a01){const _0xc504bf=a48_0x2abf17;this[_0xc504bf(0xfe)]('cointopay_status_changes',{'type':_0xc504bf(0x117),..._0x453a01});}[a48_0x2abf17(0xf2)](_0x57c7ec){const _0x41e6f6=a48_0x2abf17;this[_0x41e6f6(0xfe)](_0x41e6f6(0x11c),{'type':_0x41e6f6(0x12a),..._0x57c7ec});}[a48_0x2abf17(0x121)](_0x4ce1a0,_0x2cea28,_0x3cfb5a,_0x311109,_0x6eed8d,_0x491ef2){const _0x37fd32=a48_0x2abf17;this['writeLog'](_0x37fd32(0x113),{'type':_0x37fd32(0x125),'shopId':_0x4ce1a0,'webhookUrl':_0x2cea28,'event':_0x3cfb5a,'status':_0x311109,'responseTime':_0x6eed8d,'payload':_0x491ef2});}[a48_0x2abf17(0x128)](_0x4a6ebe,_0x196b6c,_0x223e21,_0x2352be,_0x5492ca){const _0x275851=a48_0x2abf17;this['writeLog'](_0x275851(0x11f),{'type':_0x275851(0xee),'shopId':_0x4a6ebe,'webhookUrl':_0x196b6c,'event':_0x223e21,'error':_0x2352be instanceof Error?{'message':_0x2352be['message'],'stack':_0x2352be['stack']}:_0x2352be,'payload':_0x5492ca});}[a48_0x2abf17(0x118)](_0x36ca80,_0x4c891e,_0x23899e,_0x9c2eaf,_0x33c662){const _0x1a19c1=a48_0x2abf17;this[_0x1a19c1(0xfe)](_0x1a19c1(0x120),{'type':'PAYMENT_CREATED','gateway':_0x36ca80,'paymentId':_0x4c891e,'shopId':_0x23899e,'amount':_0x9c2eaf,'currency':_0x33c662});}[a48_0x2abf17(0xe7)](_0x5e9583,_0x2257b5,_0x7980e,_0x352f11,_0x358ec2){const _0x12048f=a48_0x2abf17;this[_0x12048f(0xfe)](_0x12048f(0xe5),{'type':_0x12048f(0x10d),'endpoint':_0x5e9583,'method':_0x2257b5,'userId':_0x7980e,'userRole':_0x352f11,'requestData':_0x358ec2});}[a48_0x2abf17(0xec)](){const _0x4de862=a48_0x2abf17;try{const _0x2c74f2=fs_1['default'][_0x4de862(0xfa)](this[_0x4de862(0x115)]),_0x5696aa=_0x2c74f2[_0x4de862(0x102)](_0x508bb9=>_0x508bb9[_0x4de862(0x12b)](_0x4de862(0x10e))),_0x278e0c=[...new Set(_0x5696aa[_0x4de862(0xf6)](_0x151df2=>_0x151df2[_0x4de862(0xf8)]('_')[0x0]))],_0x320844=_0x5696aa[_0x4de862(0xf6)](_0x4b3244=>{const _0x205444=_0x4de862,_0x23532c=path_1[_0x205444(0x122)][_0x205444(0xf4)](this[_0x205444(0x115)],_0x4b3244),_0xc8df27=fs_1[_0x205444(0x122)]['statSync'](_0x23532c),[_0x1c6d9f,_0x12379e]=_0x4b3244[_0x205444(0x11e)]('.log','')[_0x205444(0xf8)]('_');return{'type':_0x1c6d9f,'date':_0x12379e,'size':_0xc8df27['size']};})[_0x4de862(0x11b)]((_0x5df1f3,_0x506d4f)=>_0x506d4f[_0x4de862(0xe0)][_0x4de862(0x112)](_0x5df1f3[_0x4de862(0xe0)]));return{'totalFiles':_0x5696aa[_0x4de862(0xfb)],'logTypes':_0x278e0c,'latestLogs':_0x320844['slice'](0x0,0xa)};}catch(_0x515084){return console[_0x4de862(0x116)]('Failed\x20to\x20get\x20log\x20stats:',_0x515084),{'totalFiles':0x0,'logTypes':[],'latestLogs':[]};}}[a48_0x2abf17(0x108)](_0x32afcc=0x1e){const _0x5c7fc0=a48_0x2abf17;try{const _0x1d8603=fs_1[_0x5c7fc0(0x122)][_0x5c7fc0(0xfa)](this[_0x5c7fc0(0x115)]),_0x1109dc=new Date();_0x1109dc[_0x5c7fc0(0xdb)](_0x1109dc[_0x5c7fc0(0x104)]()-_0x32afcc);let _0x53b445=0x0;_0x1d8603[_0x5c7fc0(0x127)](_0x42e183=>{const _0x205f43=_0x5c7fc0;if(!_0x42e183[_0x205f43(0x12b)]('.log'))return;const _0x1a1cd8=path_1[_0x205f43(0x122)][_0x205f43(0xf4)](this[_0x205f43(0x115)],_0x42e183),_0xb601c4=fs_1[_0x205f43(0x122)][_0x205f43(0xdc)](_0x1a1cd8);_0xb601c4['mtime']<_0x1109dc&&(fs_1['default']['unlinkSync'](_0x1a1cd8),_0x53b445++,console[_0x205f43(0xe4)](_0x205f43(0x101)+_0x42e183));}),console[_0x5c7fc0(0xe4)](_0x5c7fc0(0xff)+_0x53b445+_0x5c7fc0(0xe6)+_0x32afcc+_0x5c7fc0(0xe8));}catch(_0x24dec4){console[_0x5c7fc0(0x116)](_0x5c7fc0(0xea),_0x24dec4);}}}exports[a48_0x2abf17(0xdd)]=LoggerService,exports[a48_0x2abf17(0x103)]=new LoggerService();function a48_0x98fb(){const _0x50fcbf=['split','cwd','readdirSync','length','183086giQLTD','message','writeLog','🧹\x20Cleaned\x20','logWebhookReceived','🗑️\x20Deleted\x20old\x20log\x20file:\x20','filter','loggerService','getDate','REQUEST','white_domain_errors','logWebhookError','cleanOldLogs','mkdirSync','7zbrAMZ','Failed\x20to\x20write\x20','35640mrFgjZ','API_CALL','.log','50JWVEbD','66nbxAgt','defineProperty','localeCompare','shop_webhooks_sent','logWhiteDomainError','logsDir','error','COINTOPAY_STATUS_CHANGE','logPaymentCreated','__importDefault','existsSync','sort','cointopay_errors','utf8','replace','shop_webhooks_errors','payments_created','logShopWebhookSent','default','780776qToBJT','logs','SHOP_WEBHOOK_SENT','toISOString','forEach','logShopWebhookError','2634236FgOXVu','COINTOPAY_ERROR','endsWith','ensureLogsDirectory','75496vHwFeK','105290himyEZ','setDate','statSync','LoggerService','stack','📁\x20Created\x20logs\x20directory:\x20','date','webhooks_received','WEBHOOK_ERROR','white_domain_responses','log','api_calls','\x20old\x20log\x20files\x20(older\x20than\x20','logApiCall','\x20days)','white_domain_requests','Failed\x20to\x20clean\x20old\x20logs:','logCoinToPayStatus','getLogStats','logWhiteDomainRequest','SHOP_WEBHOOK_ERROR','webhooks_errors','477693GoDvFv','ERROR','logCoinToPayError','getLogFileName','join','3wDcoyP','map','__esModule'];a48_0x98fb=function(){return _0x50fcbf;};return a48_0x98fb();}