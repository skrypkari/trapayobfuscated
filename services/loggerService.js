'use strict';function a67_0x326f(_0x2a7a47,_0x2f2a12){_0x2a7a47=_0x2a7a47-0x1a5;const _0x8b24ce=a67_0x8b24();let _0x326f03=_0x8b24ce[_0x2a7a47];return _0x326f03;}const a67_0x56500e=a67_0x326f;(function(_0x581569,_0x30ea1c){const _0x16f5c0=a67_0x326f,_0x2dcf4e=_0x581569();while(!![]){try{const _0x50f38b=parseInt(_0x16f5c0(0x1bc))/0x1*(parseInt(_0x16f5c0(0x1f1))/0x2)+parseInt(_0x16f5c0(0x1b6))/0x3+parseInt(_0x16f5c0(0x1b7))/0x4+-parseInt(_0x16f5c0(0x1b0))/0x5*(parseInt(_0x16f5c0(0x1b4))/0x6)+-parseInt(_0x16f5c0(0x1e0))/0x7*(-parseInt(_0x16f5c0(0x1a5))/0x8)+-parseInt(_0x16f5c0(0x1f4))/0x9*(parseInt(_0x16f5c0(0x1d0))/0xa)+-parseInt(_0x16f5c0(0x1d9))/0xb;if(_0x50f38b===_0x30ea1c)break;else _0x2dcf4e['push'](_0x2dcf4e['shift']());}catch(_0x1f7657){_0x2dcf4e['push'](_0x2dcf4e['shift']());}}}(a67_0x8b24,0x21a02));var __importDefault=this&&this['__importDefault']||function(_0x355983){const _0x2d5625=a67_0x326f;return _0x355983&&_0x355983[_0x2d5625(0x1c7)]?_0x355983:{'default':_0x355983};};Object[a67_0x56500e(0x1a7)](exports,a67_0x56500e(0x1c7),{'value':!![]}),exports[a67_0x56500e(0x1d7)]=exports[a67_0x56500e(0x1e4)]=void 0x0;const fs_1=__importDefault(require('fs')),path_1=__importDefault(require(a67_0x56500e(0x1c1)));class LoggerService{constructor(){const _0x4ebbe1=a67_0x56500e;this[_0x4ebbe1(0x1eb)]=path_1[_0x4ebbe1(0x1c3)]['join'](process[_0x4ebbe1(0x1a8)](),_0x4ebbe1(0x1d4)),this[_0x4ebbe1(0x1d5)]();}['ensureLogsDirectory'](){const _0x38d899=a67_0x56500e;!fs_1['default'][_0x38d899(0x1b3)](this[_0x38d899(0x1eb)])&&(fs_1[_0x38d899(0x1c3)][_0x38d899(0x1d6)](this[_0x38d899(0x1eb)],{'recursive':!![]}),console[_0x38d899(0x1fb)](_0x38d899(0x1ac)+this[_0x38d899(0x1eb)]));}[a67_0x56500e(0x1d3)](_0x1c6e25){const _0x4a067b=a67_0x56500e,_0x38c7ae=new Date()[_0x4a067b(0x1ab)]()['split']('T')[0x0];return path_1[_0x4a067b(0x1c3)][_0x4a067b(0x1c6)](this[_0x4a067b(0x1eb)],_0x1c6e25+'_'+_0x38c7ae+'.log');}[a67_0x56500e(0x1cc)](_0x2d2d45,_0x4baa87){const _0x4127fd=a67_0x56500e;try{const _0x5c9223=new Date()[_0x4127fd(0x1ab)](),_0xa59b7e={'timestamp':_0x5c9223,..._0x4baa87},_0x45bb1d=JSON[_0x4127fd(0x1de)](_0xa59b7e)+'\x0a',_0x1cd7a8=this['getLogFileName'](_0x2d2d45);fs_1[_0x4127fd(0x1c3)][_0x4127fd(0x1ad)](_0x1cd7a8,_0x45bb1d,_0x4127fd(0x1ed));}catch(_0x37d786){console[_0x4127fd(0x1f3)](_0x4127fd(0x1c8)+_0x2d2d45+_0x4127fd(0x1e5),_0x37d786);}}[a67_0x56500e(0x1b8)](_0x35bc7,_0x3a984c,_0x53985b,_0x5302ab){const _0x1e9af8=a67_0x56500e;this['writeLog'](_0x1e9af8(0x1c9),{'type':'REQUEST','gateway':_0x35bc7,'endpoint':_0x3a984c,'method':_0x53985b,'data':_0x5302ab});}[a67_0x56500e(0x1ae)](_0x2813cd,_0x403517,_0x16a98c,_0x5034c9,_0x4e4477){const _0x4be63c=a67_0x56500e;this['writeLog'](_0x4be63c(0x1dd),{'type':_0x4be63c(0x1e7),'gateway':_0x2813cd,'endpoint':_0x403517,'status':_0x16a98c,'responseTime':_0x4e4477,'data':_0x5034c9});}['logWhiteDomainError'](_0x34b39a,_0x235f34,_0x3b8ab9){const _0x100b7f=a67_0x56500e;this[_0x100b7f(0x1cc)]('white_domain_errors',{'type':_0x100b7f(0x1e6),'gateway':_0x34b39a,'endpoint':_0x235f34,'error':_0x3b8ab9 instanceof Error?{'message':_0x3b8ab9[_0x100b7f(0x1a6)],'stack':_0x3b8ab9['stack']}:_0x3b8ab9});}[a67_0x56500e(0x1f6)](_0x81de8b,_0x4ba4a4,_0x5c6ed0){const _0x344bf8=a67_0x56500e;this['writeLog'](_0x344bf8(0x1ce),{'type':_0x344bf8(0x1aa),'gateway':_0x81de8b,'headers':_0x5c6ed0,'data':_0x4ba4a4});}[a67_0x56500e(0x1bb)](_0x2fdcb4,_0x21638e,_0x387c9c,_0x27e51f,_0xe0b6fa){const _0x15545f=a67_0x56500e;this['writeLog'](_0x15545f(0x1b9),{'type':_0x15545f(0x1b2),'gateway':_0x2fdcb4,'paymentId':_0x21638e,'oldStatus':_0x387c9c,'newStatus':_0x27e51f,'originalData':_0xe0b6fa});}[a67_0x56500e(0x1be)](_0x221bce,_0x470400,_0x54347c){const _0x4061da=a67_0x56500e;this[_0x4061da(0x1cc)](_0x4061da(0x1c5),{'type':'WEBHOOK_ERROR','gateway':_0x221bce,'error':_0x470400 instanceof Error?{'message':_0x470400['message'],'stack':_0x470400[_0x4061da(0x1fa)]}:_0x470400,'originalData':_0x54347c});}[a67_0x56500e(0x1c2)](_0x19f9d0){const _0x10656d=a67_0x56500e;this[_0x10656d(0x1cc)](_0x10656d(0x1db),{'type':_0x10656d(0x1bf),..._0x19f9d0});}[a67_0x56500e(0x1df)](_0xf551df){const _0x39b246=a67_0x56500e;this[_0x39b246(0x1cc)]('cointopay_errors',{'type':_0x39b246(0x1d2),..._0xf551df});}[a67_0x56500e(0x1f5)](_0x48fb38,_0x9ed263,_0x3035b2,_0x391f07,_0x48b9d1,_0x34a2f7){const _0x5c5d5e=a67_0x56500e;this['writeLog'](_0x5c5d5e(0x1f8),{'type':_0x5c5d5e(0x1c0),'shopId':_0x48fb38,'webhookUrl':_0x9ed263,'event':_0x3035b2,'status':_0x391f07,'responseTime':_0x48b9d1,'payload':_0x34a2f7});}[a67_0x56500e(0x1e2)](_0x149726,_0x345df9,_0x5e825f,_0x524e3f,_0xb14774){const _0xee7972=a67_0x56500e;this[_0xee7972(0x1cc)](_0xee7972(0x1fc),{'type':_0xee7972(0x1fd),'shopId':_0x149726,'webhookUrl':_0x345df9,'event':_0x5e825f,'error':_0x524e3f instanceof Error?{'message':_0x524e3f[_0xee7972(0x1a6)],'stack':_0x524e3f[_0xee7972(0x1fa)]}:_0x524e3f,'payload':_0xb14774});}[a67_0x56500e(0x1cd)](_0x3bdba8,_0x3a8777,_0x29d559,_0x47d363,_0x18869a){const _0x11ba6d=a67_0x56500e;this[_0x11ba6d(0x1cc)](_0x11ba6d(0x1b5),{'type':'PAYMENT_CREATED','gateway':_0x3bdba8,'paymentId':_0x3a8777,'shopId':_0x29d559,'amount':_0x47d363,'currency':_0x18869a});}['logApiCall'](_0x439fc9,_0x7693bf,_0x52151e,_0x5b5592,_0x10ea3e){const _0x19433f=a67_0x56500e;this[_0x19433f(0x1cc)](_0x19433f(0x1dc),{'type':_0x19433f(0x1cb),'endpoint':_0x439fc9,'method':_0x7693bf,'userId':_0x52151e,'userRole':_0x5b5592,'requestData':_0x10ea3e});}[a67_0x56500e(0x1bd)](){const _0x1333ee=a67_0x56500e;try{const _0x47cf4d=fs_1[_0x1333ee(0x1c3)][_0x1333ee(0x1e9)](this[_0x1333ee(0x1eb)]),_0x2f4440=_0x47cf4d[_0x1333ee(0x1b1)](_0x52adac=>_0x52adac['endsWith']('.log')),_0x4ffb48=[...new Set(_0x2f4440[_0x1333ee(0x1f2)](_0x22c51a=>_0x22c51a[_0x1333ee(0x1ca)]('_')[0x0]))],_0x3deefc=_0x2f4440[_0x1333ee(0x1f2)](_0x3446dc=>{const _0xed19e3=_0x1333ee,_0x5a1811=path_1[_0xed19e3(0x1c3)][_0xed19e3(0x1c6)](this[_0xed19e3(0x1eb)],_0x3446dc),_0x54720a=fs_1['default'][_0xed19e3(0x1ea)](_0x5a1811),[_0x50d3ff,_0x40505f]=_0x3446dc[_0xed19e3(0x1ee)](_0xed19e3(0x1af),'')[_0xed19e3(0x1ca)]('_');return{'type':_0x50d3ff,'date':_0x40505f,'size':_0x54720a[_0xed19e3(0x1a9)]};})['sort']((_0x374bb4,_0xf5ddec)=>_0xf5ddec[_0x1333ee(0x1d1)][_0x1333ee(0x1f0)](_0x374bb4[_0x1333ee(0x1d1)]));return{'totalFiles':_0x2f4440[_0x1333ee(0x1e1)],'logTypes':_0x4ffb48,'latestLogs':_0x3deefc[_0x1333ee(0x1ef)](0x0,0xa)};}catch(_0x10f78f){return console['error'](_0x1333ee(0x1f7),_0x10f78f),{'totalFiles':0x0,'logTypes':[],'latestLogs':[]};}}[a67_0x56500e(0x1ba)](_0x1ab3bf=0x1e){const _0x4adfc3=a67_0x56500e;try{const _0x3f4fdb=fs_1[_0x4adfc3(0x1c3)][_0x4adfc3(0x1e9)](this[_0x4adfc3(0x1eb)]),_0x2c6b59=new Date();_0x2c6b59[_0x4adfc3(0x1cf)](_0x2c6b59[_0x4adfc3(0x1e8)]()-_0x1ab3bf);let _0x4adcf3=0x0;_0x3f4fdb[_0x4adfc3(0x1e3)](_0x102fd9=>{const _0x12c19b=_0x4adfc3;if(!_0x102fd9[_0x12c19b(0x1f9)](_0x12c19b(0x1af)))return;const _0x38c956=path_1[_0x12c19b(0x1c3)]['join'](this['logsDir'],_0x102fd9),_0x5bd498=fs_1[_0x12c19b(0x1c3)][_0x12c19b(0x1ea)](_0x38c956);_0x5bd498['mtime']<_0x2c6b59&&(fs_1['default']['unlinkSync'](_0x38c956),_0x4adcf3++,console['log'](_0x12c19b(0x1ec)+_0x102fd9));}),console[_0x4adfc3(0x1fb)](_0x4adfc3(0x1d8)+_0x4adcf3+'\x20old\x20log\x20files\x20(older\x20than\x20'+_0x1ab3bf+_0x4adfc3(0x1da));}catch(_0x4e98a9){console[_0x4adfc3(0x1f3)](_0x4adfc3(0x1c4),_0x4e98a9);}}}function a67_0x8b24(){const _0x5c5d48=['statSync','logsDir','ðŸ—‘ï¸\x20Deleted\x20old\x20log\x20file:\x20','utf8','replace','slice','localeCompare','4fzQuPB','map','error','604161udHNqu','logShopWebhookSent','logWebhookReceived','Failed\x20to\x20get\x20log\x20stats:','shop_webhooks_sent','endsWith','stack','log','shop_webhooks_errors','SHOP_WEBHOOK_ERROR','40jQKjBt','message','defineProperty','cwd','size','WEBHOOK_RECEIVED','toISOString','ðŸ“\x20Created\x20logs\x20directory:\x20','appendFileSync','logWhiteDomainResponse','.log','1905oQZUhc','filter','WEBHOOK_PROCESSED','existsSync','180vnaJFv','payments_created','450852jlSvhY','25152kQzQZf','logWhiteDomainRequest','webhooks_processed','cleanOldLogs','logWebhookProcessed','134375VFHgfg','getLogStats','logWebhookError','COINTOPAY_STATUS_CHANGE','SHOP_WEBHOOK_SENT','path','logCoinToPayStatus','default','Failed\x20to\x20clean\x20old\x20logs:','webhooks_errors','join','__esModule','Failed\x20to\x20write\x20','white_domain_requests','split','API_CALL','writeLog','logPaymentCreated','webhooks_received','setDate','10fcZVAB','date','COINTOPAY_ERROR','getLogFileName','logs','ensureLogsDirectory','mkdirSync','loggerService','ðŸ§¹\x20Cleaned\x20','3363833oqmjqn','\x20days)','cointopay_status_changes','api_calls','white_domain_responses','stringify','logCoinToPayError','135478KnxvZL','length','logShopWebhookError','forEach','LoggerService','\x20log:','ERROR','RESPONSE','getDate','readdirSync'];a67_0x8b24=function(){return _0x5c5d48;};return a67_0x8b24();}exports[a67_0x56500e(0x1e4)]=LoggerService,exports['loggerService']=new LoggerService();