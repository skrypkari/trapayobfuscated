'use strict';const a48_0x48dd98=a48_0x4b48;(function(_0x4a7725,_0x4eff97){const _0x28c5a5=a48_0x4b48,_0x4e13b1=_0x4a7725();while(!![]){try{const _0x2e3da0=-parseInt(_0x28c5a5(0x121))/0x1+parseInt(_0x28c5a5(0x114))/0x2+parseInt(_0x28c5a5(0x13c))/0x3+-parseInt(_0x28c5a5(0x104))/0x4*(-parseInt(_0x28c5a5(0x131))/0x5)+parseInt(_0x28c5a5(0x13d))/0x6*(parseInt(_0x28c5a5(0x134))/0x7)+parseInt(_0x28c5a5(0x10e))/0x8*(parseInt(_0x28c5a5(0x108))/0x9)+-parseInt(_0x28c5a5(0x11c))/0xa*(parseInt(_0x28c5a5(0x10f))/0xb);if(_0x2e3da0===_0x4eff97)break;else _0x4e13b1['push'](_0x4e13b1['shift']());}catch(_0x2a0a84){_0x4e13b1['push'](_0x4e13b1['shift']());}}}(a48_0x2526,0x2c7f7));var __importDefault=this&&this[a48_0x48dd98(0x109)]||function(_0x273b98){const _0x44fc9d=a48_0x48dd98;return _0x273b98&&_0x273b98[_0x44fc9d(0x12f)]?_0x273b98:{'default':_0x273b98};};Object[a48_0x48dd98(0xf8)](exports,a48_0x48dd98(0x12f),{'value':!![]}),exports['loggerService']=exports[a48_0x48dd98(0x13e)]=void 0x0;const fs_1=__importDefault(require('fs')),path_1=__importDefault(require(a48_0x48dd98(0x10b)));class LoggerService{constructor(){const _0x115d34=a48_0x48dd98;this[_0x115d34(0x133)]=path_1[_0x115d34(0x12a)]['join'](process['cwd'](),_0x115d34(0x120)),this[_0x115d34(0x115)]();}['ensureLogsDirectory'](){const _0x17a838=a48_0x48dd98;!fs_1[_0x17a838(0x12a)]['existsSync'](this[_0x17a838(0x133)])&&(fs_1[_0x17a838(0x12a)][_0x17a838(0x10a)](this[_0x17a838(0x133)],{'recursive':!![]}),console[_0x17a838(0x141)](_0x17a838(0x124)+this[_0x17a838(0x133)]));}[a48_0x48dd98(0x10c)](_0x3c8a2a){const _0x1cc5a0=a48_0x48dd98,_0x2501fe=new Date()[_0x1cc5a0(0xf6)]()['split']('T')[0x0];return path_1[_0x1cc5a0(0x12a)]['join'](this['logsDir'],_0x3c8a2a+'_'+_0x2501fe+_0x1cc5a0(0xfc));}['writeLog'](_0x1351d0,_0x428e4b){const _0x52a2ff=a48_0x48dd98;try{const _0x327d32=new Date()['toISOString'](),_0x30be86={'timestamp':_0x327d32,..._0x428e4b},_0x41c3b9=JSON[_0x52a2ff(0x119)](_0x30be86)+'\x0a',_0x1c9862=this[_0x52a2ff(0x10c)](_0x1351d0);fs_1['default'][_0x52a2ff(0x140)](_0x1c9862,_0x41c3b9,_0x52a2ff(0x116));}catch(_0x508dd3){console[_0x52a2ff(0x126)](_0x52a2ff(0x136)+_0x1351d0+_0x52a2ff(0x110),_0x508dd3);}}['logWhiteDomainRequest'](_0x2a3918,_0xa020b,_0x3260bf,_0x322d9f){const _0x3eef53=a48_0x48dd98;this[_0x3eef53(0x123)](_0x3eef53(0x129),{'type':_0x3eef53(0x11e),'gateway':_0x2a3918,'endpoint':_0xa020b,'method':_0x3260bf,'data':_0x322d9f});}['logWhiteDomainResponse'](_0x4d3cfd,_0x3b6cc6,_0x3464f3,_0x16f7ff,_0x3c79aa){const _0x20e5a9=a48_0x48dd98;this['writeLog'](_0x20e5a9(0xf4),{'type':_0x20e5a9(0xff),'gateway':_0x4d3cfd,'endpoint':_0x3b6cc6,'status':_0x3464f3,'responseTime':_0x3c79aa,'data':_0x16f7ff});}[a48_0x48dd98(0x122)](_0x39cb39,_0x10776c,_0x441900){const _0xdc3b61=a48_0x48dd98;this[_0xdc3b61(0x123)](_0xdc3b61(0x132),{'type':'ERROR','gateway':_0x39cb39,'endpoint':_0x10776c,'error':_0x441900 instanceof Error?{'message':_0x441900['message'],'stack':_0x441900[_0xdc3b61(0x11a)]}:_0x441900});}[a48_0x48dd98(0x138)](_0x1e9b48,_0x10753c,_0x525f7d){const _0x3349c7=a48_0x48dd98;this[_0x3349c7(0x123)](_0x3349c7(0x107),{'type':'WEBHOOK_RECEIVED','gateway':_0x1e9b48,'headers':_0x525f7d,'data':_0x10753c});}[a48_0x48dd98(0x106)](_0xb875f8,_0x3b9cd9,_0x469794,_0x4b2c4b,_0x327b9){const _0x5d4c25=a48_0x48dd98;this[_0x5d4c25(0x123)](_0x5d4c25(0x100),{'type':_0x5d4c25(0x10d),'gateway':_0xb875f8,'paymentId':_0x3b9cd9,'oldStatus':_0x469794,'newStatus':_0x4b2c4b,'originalData':_0x327b9});}[a48_0x48dd98(0x105)](_0x50444c,_0xd33244,_0x31460e){const _0xc765c7=a48_0x48dd98;this[_0xc765c7(0x123)](_0xc765c7(0x12b),{'type':_0xc765c7(0x112),'gateway':_0x50444c,'error':_0xd33244 instanceof Error?{'message':_0xd33244['message'],'stack':_0xd33244['stack']}:_0xd33244,'originalData':_0x31460e});}[a48_0x48dd98(0x111)](_0x24ef0d){const _0x2aa290=a48_0x48dd98;this[_0x2aa290(0x123)](_0x2aa290(0x118),{'type':_0x2aa290(0x130),..._0x24ef0d});}[a48_0x48dd98(0x127)](_0x81e24c){const _0x337f05=a48_0x48dd98;this[_0x337f05(0x123)]('cointopay_errors',{'type':'COINTOPAY_ERROR',..._0x81e24c});}[a48_0x48dd98(0xf3)](_0xb19c73,_0x216bfb,_0x48ce31,_0x360f01,_0x4433f9,_0x2579ce){const _0x43afdb=a48_0x48dd98;this[_0x43afdb(0x123)]('shop_webhooks_sent',{'type':'SHOP_WEBHOOK_SENT','shopId':_0xb19c73,'webhookUrl':_0x216bfb,'event':_0x48ce31,'status':_0x360f01,'responseTime':_0x4433f9,'payload':_0x2579ce});}[a48_0x48dd98(0xf2)](_0x17d391,_0x4b479d,_0x1b7db7,_0x48fa61,_0x496671){const _0x26ebcc=a48_0x48dd98;this[_0x26ebcc(0x123)]('shop_webhooks_errors',{'type':_0x26ebcc(0xf7),'shopId':_0x17d391,'webhookUrl':_0x4b479d,'event':_0x1b7db7,'error':_0x48fa61 instanceof Error?{'message':_0x48fa61[_0x26ebcc(0xfd)],'stack':_0x48fa61[_0x26ebcc(0x11a)]}:_0x48fa61,'payload':_0x496671});}['logPaymentCreated'](_0x2c9237,_0x1c083e,_0x384ba7,_0x4a0e8f,_0x426ef5){const _0x38f745=a48_0x48dd98;this[_0x38f745(0x123)]('payments_created',{'type':_0x38f745(0x11b),'gateway':_0x2c9237,'paymentId':_0x1c083e,'shopId':_0x384ba7,'amount':_0x4a0e8f,'currency':_0x426ef5});}['logApiCall'](_0x44aba5,_0x1ab3c6,_0x20de0e,_0x3634aa,_0x56163e){const _0x3aa5a3=a48_0x48dd98;this[_0x3aa5a3(0x123)](_0x3aa5a3(0xf5),{'type':_0x3aa5a3(0xf1),'endpoint':_0x44aba5,'method':_0x1ab3c6,'userId':_0x20de0e,'userRole':_0x3634aa,'requestData':_0x56163e});}['getLogStats'](){const _0x112cc1=a48_0x48dd98;try{const _0x559b39=fs_1[_0x112cc1(0x12a)][_0x112cc1(0x13a)](this[_0x112cc1(0x133)]),_0x23ba9e=_0x559b39[_0x112cc1(0xfa)](_0x28d2c5=>_0x28d2c5[_0x112cc1(0x12c)]('.log')),_0xa5899c=[...new Set(_0x23ba9e[_0x112cc1(0x125)](_0x1073bb=>_0x1073bb[_0x112cc1(0x101)]('_')[0x0]))],_0x35fca4=_0x23ba9e[_0x112cc1(0x125)](_0x3c00cd=>{const _0x1ee35f=_0x112cc1,_0x1dac7c=path_1[_0x1ee35f(0x12a)][_0x1ee35f(0xf9)](this[_0x1ee35f(0x133)],_0x3c00cd),_0x1cccd7=fs_1[_0x1ee35f(0x12a)][_0x1ee35f(0x117)](_0x1dac7c),[_0x15f4ff,_0xe12fc6]=_0x3c00cd[_0x1ee35f(0x13f)](_0x1ee35f(0xfc),'')[_0x1ee35f(0x101)]('_');return{'type':_0x15f4ff,'date':_0xe12fc6,'size':_0x1cccd7['size']};})[_0x112cc1(0x103)]((_0x23d322,_0x5863fa)=>_0x5863fa['date'][_0x112cc1(0xfb)](_0x23d322[_0x112cc1(0x12e)]));return{'totalFiles':_0x23ba9e[_0x112cc1(0x135)],'logTypes':_0xa5899c,'latestLogs':_0x35fca4[_0x112cc1(0xfe)](0x0,0xa)};}catch(_0x2c6add){return console[_0x112cc1(0x126)](_0x112cc1(0x102),_0x2c6add),{'totalFiles':0x0,'logTypes':[],'latestLogs':[]};}}[a48_0x48dd98(0x128)](_0x4df35a=0x1e){const _0x290edc=a48_0x48dd98;try{const _0x4ab25c=fs_1['default']['readdirSync'](this[_0x290edc(0x133)]),_0x5aa137=new Date();_0x5aa137[_0x290edc(0x113)](_0x5aa137[_0x290edc(0x11d)]()-_0x4df35a);let _0x2511f4=0x0;_0x4ab25c['forEach'](_0x366219=>{const _0x4eb0b3=_0x290edc;if(!_0x366219['endsWith'](_0x4eb0b3(0xfc)))return;const _0x211506=path_1['default'][_0x4eb0b3(0xf9)](this[_0x4eb0b3(0x133)],_0x366219),_0x12d3e1=fs_1['default'][_0x4eb0b3(0x117)](_0x211506);_0x12d3e1[_0x4eb0b3(0x11f)]<_0x5aa137&&(fs_1[_0x4eb0b3(0x12a)][_0x4eb0b3(0x137)](_0x211506),_0x2511f4++,console[_0x4eb0b3(0x141)](_0x4eb0b3(0x12d)+_0x366219));}),console[_0x290edc(0x141)]('🧹\x20Cleaned\x20'+_0x2511f4+_0x290edc(0x139)+_0x4df35a+'\x20days)');}catch(_0x1e3c36){console[_0x290edc(0x126)]('Failed\x20to\x20clean\x20old\x20logs:',_0x1e3c36);}}}function a48_0x2526(){const _0x5f4db0=['length','Failed\x20to\x20write\x20','unlinkSync','logWebhookReceived','\x20old\x20log\x20files\x20(older\x20than\x20','readdirSync','loggerService','318666wsetAi','6JhHEuc','LoggerService','replace','appendFileSync','log','API_CALL','logShopWebhookError','logShopWebhookSent','white_domain_responses','api_calls','toISOString','SHOP_WEBHOOK_ERROR','defineProperty','join','filter','localeCompare','.log','message','slice','RESPONSE','webhooks_processed','split','Failed\x20to\x20get\x20log\x20stats:','sort','8hLHEMB','logWebhookError','logWebhookProcessed','webhooks_received','9QTYVBf','__importDefault','mkdirSync','path','getLogFileName','WEBHOOK_PROCESSED','1238192CHIYLD','69817VReyjp','\x20log:','logCoinToPayStatus','WEBHOOK_ERROR','setDate','242576Hoymmm','ensureLogsDirectory','utf8','statSync','cointopay_status_changes','stringify','stack','PAYMENT_CREATED','140INQpZy','getDate','REQUEST','mtime','logs','145839USRypB','logWhiteDomainError','writeLog','📁\x20Created\x20logs\x20directory:\x20','map','error','logCoinToPayError','cleanOldLogs','white_domain_requests','default','webhooks_errors','endsWith','🗑️\x20Deleted\x20old\x20log\x20file:\x20','date','__esModule','COINTOPAY_STATUS_CHANGE','71715NPAkZU','white_domain_errors','logsDir','41930MvgGFo'];a48_0x2526=function(){return _0x5f4db0;};return a48_0x2526();}function a48_0x4b48(_0x1d56b9,_0x113ee6){const _0x2526be=a48_0x2526();return a48_0x4b48=function(_0x4b4890,_0x146a66){_0x4b4890=_0x4b4890-0xf1;let _0x5da8d8=_0x2526be[_0x4b4890];return _0x5da8d8;},a48_0x4b48(_0x1d56b9,_0x113ee6);}exports[a48_0x48dd98(0x13e)]=LoggerService,exports[a48_0x48dd98(0x13b)]=new LoggerService();