'use strict';const a79_0x13238e=a79_0xdf94;(function(_0x58eb37,_0x299f01){const _0x26ddb6=a79_0xdf94,_0x4a38d3=_0x58eb37();while(!![]){try{const _0x244984=-parseInt(_0x26ddb6(0x12f))/0x1*(parseInt(_0x26ddb6(0x125))/0x2)+-parseInt(_0x26ddb6(0x139))/0x3*(-parseInt(_0x26ddb6(0x120))/0x4)+-parseInt(_0x26ddb6(0x13a))/0x5*(parseInt(_0x26ddb6(0x122))/0x6)+parseInt(_0x26ddb6(0x10f))/0x7*(-parseInt(_0x26ddb6(0x113))/0x8)+parseInt(_0x26ddb6(0xec))/0x9*(parseInt(_0x26ddb6(0x105))/0xa)+-parseInt(_0x26ddb6(0xe6))/0xb*(parseInt(_0x26ddb6(0x10a))/0xc)+parseInt(_0x26ddb6(0x10d))/0xd*(parseInt(_0x26ddb6(0xf5))/0xe);if(_0x244984===_0x299f01)break;else _0x4a38d3['push'](_0x4a38d3['shift']());}catch(_0x34cbe7){_0x4a38d3['push'](_0x4a38d3['shift']());}}}(a79_0x4cea,0xa2be8));var __importDefault=this&&this[a79_0x13238e(0x11f)]||function(_0x5f3611){return _0x5f3611&&_0x5f3611['__esModule']?_0x5f3611:{'default':_0x5f3611};};Object[a79_0x13238e(0x130)](exports,'__esModule',{'value':!![]}),exports[a79_0x13238e(0xf0)]=exports[a79_0x13238e(0xff)]=void 0x0;function a79_0x4cea(){const _0x1e4f66=['path','loggerService','sort','SHOP_WEBHOOK_ERROR','message','log','56RoqKYC','white_domain_requests','.log','appendFileSync','RESPONSE','length','logWhiteDomainError','SHOP_WEBHOOK_SENT','logWebhookError','getLogFileName','LoggerService','existsSync','filter','unlinkSync','Failed\x20to\x20write\x20','utf8','3914570AgAtRb','readdirSync','Failed\x20to\x20get\x20log\x20stats:','setDate','stringify','12BRjCVY','mkdirSync','shop_webhooks_errors','2823964VgDeiH','logShopWebhookSent','7tbpNqE','webhooks_received','default','logApiCall','6048608AOxtJX','API_CALL','shop_webhooks_sent','statSync','mtime','writeLog','ERROR','toISOString','PAYMENT_CREATED','error','map','ensureLogsDirectory','__importDefault','28916lSDVrc','cointopay_status_changes','24vCYmvp','cointopay_errors','split','11348NkPvNW','size','WEBHOOK_RECEIVED','WEBHOOK_PROCESSED','replace','logsDir','slice','ðŸ§¹\x20Cleaned\x20','date','api_calls','13fNFHlx','defineProperty','localeCompare','logs','getLogStats','COINTOPAY_STATUS_CHANGE','endsWith','webhooks_processed','REQUEST','stack','507MEjPvo','12530aJDwBT','logCoinToPayError','logShopWebhookError','Failed\x20to\x20clean\x20old\x20logs:','WEBHOOK_ERROR','10731688KLWnDU','payments_created','join','\x20old\x20log\x20files\x20(older\x20than\x20','white_domain_responses','ðŸ“\x20Created\x20logs\x20directory:\x20','9RqlaIp','cleanOldLogs','\x20days)'];a79_0x4cea=function(){return _0x1e4f66;};return a79_0x4cea();}const fs_1=__importDefault(require('fs')),path_1=__importDefault(require(a79_0x13238e(0xef)));function a79_0xdf94(_0x4e79a2,_0x38a417){_0x4e79a2=_0x4e79a2-0xe5;const _0x4cea26=a79_0x4cea();let _0xdf942e=_0x4cea26[_0x4e79a2];return _0xdf942e;}class LoggerService{constructor(){const _0x114c60=a79_0x13238e;this[_0x114c60(0x12a)]=path_1['default']['join'](process['cwd'](),_0x114c60(0x132)),this[_0x114c60(0x11e)]();}['ensureLogsDirectory'](){const _0x50a068=a79_0x13238e;!fs_1[_0x50a068(0x111)][_0x50a068(0x100)](this['logsDir'])&&(fs_1[_0x50a068(0x111)][_0x50a068(0x10b)](this[_0x50a068(0x12a)],{'recursive':!![]}),console['log'](_0x50a068(0xeb)+this[_0x50a068(0x12a)]));}[a79_0x13238e(0xfe)](_0x206984){const _0x54c8a5=a79_0x13238e,_0x59d3b3=new Date()[_0x54c8a5(0x11a)]()[_0x54c8a5(0x124)]('T')[0x0];return path_1['default'][_0x54c8a5(0xe8)](this[_0x54c8a5(0x12a)],_0x206984+'_'+_0x59d3b3+_0x54c8a5(0xf7));}[a79_0x13238e(0x118)](_0xa20b88,_0x37d9a2){const _0x1186df=a79_0x13238e;try{const _0x3e6c2d=new Date()['toISOString'](),_0x2553fd={'timestamp':_0x3e6c2d,..._0x37d9a2},_0x379df2=JSON[_0x1186df(0x109)](_0x2553fd)+'\x0a',_0xce1449=this[_0x1186df(0xfe)](_0xa20b88);fs_1[_0x1186df(0x111)][_0x1186df(0xf8)](_0xce1449,_0x379df2,_0x1186df(0x104));}catch(_0xb3ef09){console[_0x1186df(0x11c)](_0x1186df(0x103)+_0xa20b88+'\x20log:',_0xb3ef09);}}['logWhiteDomainRequest'](_0x564faa,_0x210805,_0x31513d,_0x2ca35a){const _0x4ec4e5=a79_0x13238e;this[_0x4ec4e5(0x118)](_0x4ec4e5(0xf6),{'type':_0x4ec4e5(0x137),'gateway':_0x564faa,'endpoint':_0x210805,'method':_0x31513d,'data':_0x2ca35a});}['logWhiteDomainResponse'](_0x2737e4,_0x32cbef,_0x19e196,_0x26321a,_0x462d8e){const _0x278e2e=a79_0x13238e;this['writeLog'](_0x278e2e(0xea),{'type':_0x278e2e(0xf9),'gateway':_0x2737e4,'endpoint':_0x32cbef,'status':_0x19e196,'responseTime':_0x462d8e,'data':_0x26321a});}[a79_0x13238e(0xfb)](_0x288ba4,_0x4cbfaf,_0x59e270){const _0x364339=a79_0x13238e;this['writeLog']('white_domain_errors',{'type':_0x364339(0x119),'gateway':_0x288ba4,'endpoint':_0x4cbfaf,'error':_0x59e270 instanceof Error?{'message':_0x59e270[_0x364339(0xf3)],'stack':_0x59e270[_0x364339(0x138)]}:_0x59e270});}['logWebhookReceived'](_0x56b7c4,_0x5e93ab,_0x2989ca){const _0x3d39cc=a79_0x13238e;this[_0x3d39cc(0x118)](_0x3d39cc(0x110),{'type':_0x3d39cc(0x127),'gateway':_0x56b7c4,'headers':_0x2989ca,'data':_0x5e93ab});}['logWebhookProcessed'](_0x690dd2,_0x3b53c3,_0x144777,_0x73a188,_0x56f039){const _0x2ca900=a79_0x13238e;this[_0x2ca900(0x118)](_0x2ca900(0x136),{'type':_0x2ca900(0x128),'gateway':_0x690dd2,'paymentId':_0x3b53c3,'oldStatus':_0x144777,'newStatus':_0x73a188,'originalData':_0x56f039});}[a79_0x13238e(0xfd)](_0x53f816,_0x17c087,_0xc7772f){const _0x224724=a79_0x13238e;this[_0x224724(0x118)]('webhooks_errors',{'type':_0x224724(0xe5),'gateway':_0x53f816,'error':_0x17c087 instanceof Error?{'message':_0x17c087[_0x224724(0xf3)],'stack':_0x17c087[_0x224724(0x138)]}:_0x17c087,'originalData':_0xc7772f});}['logCoinToPayStatus'](_0x5c4211){const _0x12b118=a79_0x13238e;this[_0x12b118(0x118)](_0x12b118(0x121),{'type':_0x12b118(0x134),..._0x5c4211});}[a79_0x13238e(0x13b)](_0x3b8ed4){const _0x5328de=a79_0x13238e;this[_0x5328de(0x118)](_0x5328de(0x123),{'type':'COINTOPAY_ERROR',..._0x3b8ed4});}[a79_0x13238e(0x10e)](_0x5d568e,_0xa22b25,_0x3db749,_0x7403da,_0x11140d,_0x487d6e){const _0x24e214=a79_0x13238e;this[_0x24e214(0x118)](_0x24e214(0x115),{'type':_0x24e214(0xfc),'shopId':_0x5d568e,'webhookUrl':_0xa22b25,'event':_0x3db749,'status':_0x7403da,'responseTime':_0x11140d,'payload':_0x487d6e});}[a79_0x13238e(0x13c)](_0x40ab87,_0x358642,_0x2fd1da,_0x5819ff,_0x4efe8a){const _0x2b74da=a79_0x13238e;this[_0x2b74da(0x118)](_0x2b74da(0x10c),{'type':_0x2b74da(0xf2),'shopId':_0x40ab87,'webhookUrl':_0x358642,'event':_0x2fd1da,'error':_0x5819ff instanceof Error?{'message':_0x5819ff[_0x2b74da(0xf3)],'stack':_0x5819ff[_0x2b74da(0x138)]}:_0x5819ff,'payload':_0x4efe8a});}['logPaymentCreated'](_0x3ff37a,_0x321e6a,_0x168324,_0x4e8756,_0x37e83b){const _0x5038e2=a79_0x13238e;this[_0x5038e2(0x118)](_0x5038e2(0xe7),{'type':_0x5038e2(0x11b),'gateway':_0x3ff37a,'paymentId':_0x321e6a,'shopId':_0x168324,'amount':_0x4e8756,'currency':_0x37e83b});}[a79_0x13238e(0x112)](_0x2be346,_0x39def3,_0x2a65c2,_0x187142,_0x7d53f4){const _0x206097=a79_0x13238e;this[_0x206097(0x118)](_0x206097(0x12e),{'type':_0x206097(0x114),'endpoint':_0x2be346,'method':_0x39def3,'userId':_0x2a65c2,'userRole':_0x187142,'requestData':_0x7d53f4});}[a79_0x13238e(0x133)](){const _0x7ab7f8=a79_0x13238e;try{const _0x420be0=fs_1[_0x7ab7f8(0x111)][_0x7ab7f8(0x106)](this[_0x7ab7f8(0x12a)]),_0x102c0b=_0x420be0[_0x7ab7f8(0x101)](_0x2a5302=>_0x2a5302[_0x7ab7f8(0x135)](_0x7ab7f8(0xf7))),_0x43e030=[...new Set(_0x102c0b[_0x7ab7f8(0x11d)](_0x4ed2da=>_0x4ed2da[_0x7ab7f8(0x124)]('_')[0x0]))],_0x34d594=_0x102c0b[_0x7ab7f8(0x11d)](_0x1f72e1=>{const _0x5e1fca=_0x7ab7f8,_0x28bbdb=path_1[_0x5e1fca(0x111)][_0x5e1fca(0xe8)](this[_0x5e1fca(0x12a)],_0x1f72e1),_0x4622a0=fs_1[_0x5e1fca(0x111)][_0x5e1fca(0x116)](_0x28bbdb),[_0x3b8bc5,_0x9ac3b2]=_0x1f72e1[_0x5e1fca(0x129)](_0x5e1fca(0xf7),'')[_0x5e1fca(0x124)]('_');return{'type':_0x3b8bc5,'date':_0x9ac3b2,'size':_0x4622a0[_0x5e1fca(0x126)]};})[_0x7ab7f8(0xf1)]((_0xea3d7a,_0xb65d5a)=>_0xb65d5a[_0x7ab7f8(0x12d)][_0x7ab7f8(0x131)](_0xea3d7a['date']));return{'totalFiles':_0x102c0b[_0x7ab7f8(0xfa)],'logTypes':_0x43e030,'latestLogs':_0x34d594[_0x7ab7f8(0x12b)](0x0,0xa)};}catch(_0x28cf30){return console[_0x7ab7f8(0x11c)](_0x7ab7f8(0x107),_0x28cf30),{'totalFiles':0x0,'logTypes':[],'latestLogs':[]};}}[a79_0x13238e(0xed)](_0x429458=0x1e){const _0x4ba357=a79_0x13238e;try{const _0x21657e=fs_1[_0x4ba357(0x111)][_0x4ba357(0x106)](this[_0x4ba357(0x12a)]),_0x2e31dd=new Date();_0x2e31dd[_0x4ba357(0x108)](_0x2e31dd['getDate']()-_0x429458);let _0x4607f2=0x0;_0x21657e['forEach'](_0x4741cf=>{const _0x26ae52=_0x4ba357;if(!_0x4741cf['endsWith'](_0x26ae52(0xf7)))return;const _0x2d0382=path_1['default'][_0x26ae52(0xe8)](this[_0x26ae52(0x12a)],_0x4741cf),_0x35b5bd=fs_1[_0x26ae52(0x111)]['statSync'](_0x2d0382);_0x35b5bd[_0x26ae52(0x117)]<_0x2e31dd&&(fs_1['default'][_0x26ae52(0x102)](_0x2d0382),_0x4607f2++,console['log']('ðŸ—‘ï¸\x20Deleted\x20old\x20log\x20file:\x20'+_0x4741cf));}),console[_0x4ba357(0xf4)](_0x4ba357(0x12c)+_0x4607f2+_0x4ba357(0xe9)+_0x429458+_0x4ba357(0xee));}catch(_0x5ebda5){console[_0x4ba357(0x11c)](_0x4ba357(0x13d),_0x5ebda5);}}}exports[a79_0x13238e(0xff)]=LoggerService,exports['loggerService']=new LoggerService();