'use strict';const a44_0x3ac5f1=a44_0x35ab;(function(_0x20e2bf,_0x2718b6){const _0x3d8013=a44_0x35ab,_0x17224c=_0x20e2bf();while(!![]){try{const _0x3a9565=-parseInt(_0x3d8013(0x152))/0x1+-parseInt(_0x3d8013(0x15f))/0x2+-parseInt(_0x3d8013(0x157))/0x3*(parseInt(_0x3d8013(0x13e))/0x4)+-parseInt(_0x3d8013(0x16c))/0x5*(parseInt(_0x3d8013(0x167))/0x6)+-parseInt(_0x3d8013(0x144))/0x7*(parseInt(_0x3d8013(0x13d))/0x8)+parseInt(_0x3d8013(0x14d))/0x9+parseInt(_0x3d8013(0x128))/0xa;if(_0x3a9565===_0x2718b6)break;else _0x17224c['push'](_0x17224c['shift']());}catch(_0x476e0c){_0x17224c['push'](_0x17224c['shift']());}}}(a44_0x43d6,0x87fe0));function a44_0x35ab(_0x186870,_0x1af44a){const _0x43d640=a44_0x43d6();return a44_0x35ab=function(_0x35ab47,_0x219e7b){_0x35ab47=_0x35ab47-0x121;let _0x58b6a5=_0x43d640[_0x35ab47];return _0x58b6a5;},a44_0x35ab(_0x186870,_0x1af44a);}function a44_0x43d6(){const _0x2f95ac=['Failed\x20to\x20write\x20','loggerService','endsWith','forEach','logs','logWhiteDomainError','length','cleanOldLogs','5514759zhbUaU','getLogStats','error','LoggerService','replace','779239ManUCN','readdirSync','Failed\x20to\x20get\x20log\x20stats:','size','appendFileSync','522rGVVgJ','WEBHOOK_ERROR','map','getLogFileName','logWhiteDomainRequest','toISOString','writeLog','shop_webhooks_sent','1206600hOXJdo','split','WEBHOOK_RECEIVED','RESPONSE','.log','default','logPaymentCreated','logsDir','18fqyUDC','white_domain_errors','webhooks_processed','cwd','message','1608740kbzVOw','white_domain_requests','path','statSync','join','mkdirSync','SHOP_WEBHOOK_SENT','webhooks_errors','shop_webhooks_errors','logWebhookProcessed','33731880VlnLaJ','webhooks_received','ERROR','ğŸ§¹\x20Cleaned\x20','logShopWebhookError','mtime','logShopWebhookSent','\x20log:','existsSync','logApiCall','date','unlinkSync','ensureLogsDirectory','slice','utf8','stringify','__esModule','logWhiteDomainResponse','Failed\x20to\x20clean\x20old\x20logs:','sort','stack','2721640dGJitU','9212zoDuqD','log','localeCompare','PAYMENT_CREATED','logWebhookError','API_CALL','14VOyYnB'];a44_0x43d6=function(){return _0x2f95ac;};return a44_0x43d6();}var __importDefault=this&&this['__importDefault']||function(_0x2edf2b){const _0x1c6908=a44_0x35ab;return _0x2edf2b&&_0x2edf2b[_0x1c6908(0x138)]?_0x2edf2b:{'default':_0x2edf2b};};Object['defineProperty'](exports,a44_0x3ac5f1(0x138),{'value':!![]}),exports['loggerService']=exports[a44_0x3ac5f1(0x150)]=void 0x0;const fs_1=__importDefault(require('fs')),path_1=__importDefault(require(a44_0x3ac5f1(0x16e)));class LoggerService{constructor(){const _0x47f01a=a44_0x3ac5f1;this['logsDir']=path_1[_0x47f01a(0x164)]['join'](process[_0x47f01a(0x16a)](),_0x47f01a(0x149)),this[_0x47f01a(0x134)]();}[a44_0x3ac5f1(0x134)](){const _0x4cef86=a44_0x3ac5f1;!fs_1[_0x4cef86(0x164)][_0x4cef86(0x130)](this[_0x4cef86(0x166)])&&(fs_1[_0x4cef86(0x164)][_0x4cef86(0x123)](this[_0x4cef86(0x166)],{'recursive':!![]}),console[_0x4cef86(0x13f)]('ğŸ“\x20Created\x20logs\x20directory:\x20'+this[_0x4cef86(0x166)]));}[a44_0x3ac5f1(0x15a)](_0x4de76d){const _0x1eec34=a44_0x3ac5f1,_0x49c35d=new Date()[_0x1eec34(0x15c)]()[_0x1eec34(0x160)]('T')[0x0];return path_1[_0x1eec34(0x164)][_0x1eec34(0x122)](this[_0x1eec34(0x166)],_0x4de76d+'_'+_0x49c35d+_0x1eec34(0x163));}[a44_0x3ac5f1(0x15d)](_0x2e7c2f,_0x34bba6){const _0x2b2649=a44_0x3ac5f1;try{const _0x247e2a=new Date()[_0x2b2649(0x15c)](),_0x36cd90={'timestamp':_0x247e2a,..._0x34bba6},_0x494eb1=JSON[_0x2b2649(0x137)](_0x36cd90)+'\x0a',_0x45030b=this[_0x2b2649(0x15a)](_0x2e7c2f);fs_1['default'][_0x2b2649(0x156)](_0x45030b,_0x494eb1,_0x2b2649(0x136));}catch(_0x39184c){console['error'](_0x2b2649(0x145)+_0x2e7c2f+_0x2b2649(0x12f),_0x39184c);}}[a44_0x3ac5f1(0x15b)](_0x3355e8,_0x5eea15,_0x2ec928,_0x3d4bb9){const _0x2fa959=a44_0x3ac5f1;this[_0x2fa959(0x15d)](_0x2fa959(0x16d),{'type':'REQUEST','gateway':_0x3355e8,'endpoint':_0x5eea15,'method':_0x2ec928,'data':_0x3d4bb9});}[a44_0x3ac5f1(0x139)](_0x28bca6,_0x3e8fc1,_0x499591,_0x585c1f,_0x5d4bf4){const _0x434646=a44_0x3ac5f1;this[_0x434646(0x15d)]('white_domain_responses',{'type':_0x434646(0x162),'gateway':_0x28bca6,'endpoint':_0x3e8fc1,'status':_0x499591,'responseTime':_0x5d4bf4,'data':_0x585c1f});}[a44_0x3ac5f1(0x14a)](_0x5111d9,_0x4b2fb5,_0x2fb870){const _0x56404b=a44_0x3ac5f1;this[_0x56404b(0x15d)](_0x56404b(0x168),{'type':_0x56404b(0x12a),'gateway':_0x5111d9,'endpoint':_0x4b2fb5,'error':_0x2fb870 instanceof Error?{'message':_0x2fb870[_0x56404b(0x16b)],'stack':_0x2fb870['stack']}:_0x2fb870});}['logWebhookReceived'](_0x3cd8a4,_0x57b2ab,_0x38b8d7){const _0xab96f2=a44_0x3ac5f1;this['writeLog'](_0xab96f2(0x129),{'type':_0xab96f2(0x161),'gateway':_0x3cd8a4,'headers':_0x38b8d7,'data':_0x57b2ab});}[a44_0x3ac5f1(0x127)](_0x3e4ac7,_0x3f51a8,_0xfa19ab,_0x50fbad,_0x16075b){const _0xc38b8d=a44_0x3ac5f1;this[_0xc38b8d(0x15d)](_0xc38b8d(0x169),{'type':'WEBHOOK_PROCESSED','gateway':_0x3e4ac7,'paymentId':_0x3f51a8,'oldStatus':_0xfa19ab,'newStatus':_0x50fbad,'originalData':_0x16075b});}[a44_0x3ac5f1(0x142)](_0x1bd488,_0x12f51f,_0x3d6cd0){const _0x460127=a44_0x3ac5f1;this[_0x460127(0x15d)](_0x460127(0x125),{'type':_0x460127(0x158),'gateway':_0x1bd488,'error':_0x12f51f instanceof Error?{'message':_0x12f51f[_0x460127(0x16b)],'stack':_0x12f51f[_0x460127(0x13c)]}:_0x12f51f,'originalData':_0x3d6cd0});}[a44_0x3ac5f1(0x12e)](_0x24d7fb,_0x5c69b1,_0x3afcca,_0x51dd29,_0x5e2954,_0x499f75){const _0x40b310=a44_0x3ac5f1;this[_0x40b310(0x15d)](_0x40b310(0x15e),{'type':_0x40b310(0x124),'shopId':_0x24d7fb,'webhookUrl':_0x5c69b1,'event':_0x3afcca,'status':_0x51dd29,'responseTime':_0x5e2954,'payload':_0x499f75});}[a44_0x3ac5f1(0x12c)](_0xde488d,_0x52411,_0x290436,_0x15c5b6,_0x79a53b){const _0x468c32=a44_0x3ac5f1;this['writeLog'](_0x468c32(0x126),{'type':'SHOP_WEBHOOK_ERROR','shopId':_0xde488d,'webhookUrl':_0x52411,'event':_0x290436,'error':_0x15c5b6 instanceof Error?{'message':_0x15c5b6['message'],'stack':_0x15c5b6[_0x468c32(0x13c)]}:_0x15c5b6,'payload':_0x79a53b});}[a44_0x3ac5f1(0x165)](_0xacbb4b,_0xcdc91c,_0x4a94ce,_0x5407e5,_0x121606){const _0x320aa4=a44_0x3ac5f1;this[_0x320aa4(0x15d)]('payments_created',{'type':_0x320aa4(0x141),'gateway':_0xacbb4b,'paymentId':_0xcdc91c,'shopId':_0x4a94ce,'amount':_0x5407e5,'currency':_0x121606});}[a44_0x3ac5f1(0x131)](_0x2d29d5,_0x61fd8b,_0x2aa705,_0x4e8dbe,_0x560f78){const _0x3d29f7=a44_0x3ac5f1;this[_0x3d29f7(0x15d)]('api_calls',{'type':_0x3d29f7(0x143),'endpoint':_0x2d29d5,'method':_0x61fd8b,'userId':_0x2aa705,'userRole':_0x4e8dbe,'requestData':_0x560f78});}[a44_0x3ac5f1(0x14e)](){const _0xd2c334=a44_0x3ac5f1;try{const _0x569eae=fs_1[_0xd2c334(0x164)][_0xd2c334(0x153)](this[_0xd2c334(0x166)]),_0x273d2d=_0x569eae['filter'](_0x3530ad=>_0x3530ad[_0xd2c334(0x147)](_0xd2c334(0x163))),_0xe7d84b=[...new Set(_0x273d2d[_0xd2c334(0x159)](_0x578d96=>_0x578d96[_0xd2c334(0x160)]('_')[0x0]))],_0x22c773=_0x273d2d[_0xd2c334(0x159)](_0x4ddf0c=>{const _0x55a56f=_0xd2c334,_0x3380d4=path_1['default'][_0x55a56f(0x122)](this[_0x55a56f(0x166)],_0x4ddf0c),_0x20cab5=fs_1[_0x55a56f(0x164)][_0x55a56f(0x121)](_0x3380d4),[_0x5a7024,_0x47766e]=_0x4ddf0c[_0x55a56f(0x151)](_0x55a56f(0x163),'')['split']('_');return{'type':_0x5a7024,'date':_0x47766e,'size':_0x20cab5[_0x55a56f(0x155)]};})[_0xd2c334(0x13b)]((_0x110b97,_0x2f4a5d)=>_0x2f4a5d['date'][_0xd2c334(0x140)](_0x110b97[_0xd2c334(0x132)]));return{'totalFiles':_0x273d2d[_0xd2c334(0x14b)],'logTypes':_0xe7d84b,'latestLogs':_0x22c773[_0xd2c334(0x135)](0x0,0xa)};}catch(_0x5a277f){return console[_0xd2c334(0x14f)](_0xd2c334(0x154),_0x5a277f),{'totalFiles':0x0,'logTypes':[],'latestLogs':[]};}}[a44_0x3ac5f1(0x14c)](_0x2eb417=0x1e){const _0x57c3fe=a44_0x3ac5f1;try{const _0x41f7fc=fs_1[_0x57c3fe(0x164)][_0x57c3fe(0x153)](this[_0x57c3fe(0x166)]),_0x222c84=new Date();_0x222c84['setDate'](_0x222c84['getDate']()-_0x2eb417);let _0x3d5dc8=0x0;_0x41f7fc[_0x57c3fe(0x148)](_0x18208c=>{const _0x501121=_0x57c3fe;if(!_0x18208c[_0x501121(0x147)](_0x501121(0x163)))return;const _0x504c44=path_1['default'][_0x501121(0x122)](this[_0x501121(0x166)],_0x18208c),_0x2884dd=fs_1[_0x501121(0x164)][_0x501121(0x121)](_0x504c44);_0x2884dd[_0x501121(0x12d)]<_0x222c84&&(fs_1[_0x501121(0x164)][_0x501121(0x133)](_0x504c44),_0x3d5dc8++,console[_0x501121(0x13f)]('ğŸ—‘ï¸\x20Deleted\x20old\x20log\x20file:\x20'+_0x18208c));}),console[_0x57c3fe(0x13f)](_0x57c3fe(0x12b)+_0x3d5dc8+'\x20old\x20log\x20files\x20(older\x20than\x20'+_0x2eb417+'\x20days)');}catch(_0x2a33cf){console[_0x57c3fe(0x14f)](_0x57c3fe(0x13a),_0x2a33cf);}}}exports['LoggerService']=LoggerService,exports[a44_0x3ac5f1(0x146)]=new LoggerService();