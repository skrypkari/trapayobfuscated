'use strict';const a44_0xc4b101=a44_0x49fd;(function(_0x4388e4,_0x4a49ca){const _0x141cb8=a44_0x49fd,_0x4e155b=_0x4388e4();while(!![]){try{const _0x237aeb=parseInt(_0x141cb8(0xc7))/0x1*(-parseInt(_0x141cb8(0xab))/0x2)+parseInt(_0x141cb8(0xf0))/0x3*(-parseInt(_0x141cb8(0xa0))/0x4)+parseInt(_0x141cb8(0xaa))/0x5+parseInt(_0x141cb8(0xac))/0x6*(-parseInt(_0x141cb8(0xa7))/0x7)+-parseInt(_0x141cb8(0xb7))/0x8+-parseInt(_0x141cb8(0xdb))/0x9*(-parseInt(_0x141cb8(0xa8))/0xa)+parseInt(_0x141cb8(0xbf))/0xb;if(_0x237aeb===_0x4a49ca)break;else _0x4e155b['push'](_0x4e155b['shift']());}catch(_0x5b32a3){_0x4e155b['push'](_0x4e155b['shift']());}}}(a44_0xb978,0x2a8f5));function a44_0x49fd(_0x374b43,_0x313413){const _0xb97872=a44_0xb978();return a44_0x49fd=function(_0x49fd29,_0x13bde4){_0x49fd29=_0x49fd29-0xa0;let _0x53de0b=_0xb97872[_0x49fd29];return _0x53de0b;},a44_0x49fd(_0x374b43,_0x313413);}var __importDefault=this&&this[a44_0xc4b101(0xa3)]||function(_0x51df20){const _0x1b46b8=a44_0xc4b101;return _0x51df20&&_0x51df20[_0x1b46b8(0xb4)]?_0x51df20:{'default':_0x51df20};};Object[a44_0xc4b101(0xea)](exports,a44_0xc4b101(0xb4),{'value':!![]}),exports[a44_0xc4b101(0xda)]=exports['LoggerService']=void 0x0;function a44_0xb978(){const _0x1e16ea=['cwd','webhooks_processed','PAYMENT_CREATED','endsWith','defineProperty','shop_webhooks_sent','setDate','filter','writeLog','error','3jTEZZS','626276Cehpmo','webhooks_errors','message','__importDefault','length','white_domain_errors','SHOP_WEBHOOK_ERROR','178129hVRsoj','430PiLpXz','\x20days)','1533300ATfdLB','4holDIR','66mWtjIL','payments_created','🧹\x20Cleaned\x20','logsDir','toISOString','logApiCall','mtime','slice','__esModule','REQUEST','logWhiteDomainError','1072968mYNdNb','logWebhookReceived','map','📁\x20Created\x20logs\x20directory:\x20','WEBHOOK_ERROR','logWhiteDomainRequest','white_domain_responses','mkdirSync','4736017RkFwtV','🗑️\x20Deleted\x20old\x20log\x20file:\x20','ensureLogsDirectory','Failed\x20to\x20get\x20log\x20stats:','getLogFileName','Failed\x20to\x20clean\x20old\x20logs:','default','log','133157SxtZeo','readdirSync','size','sort','existsSync','WEBHOOK_RECEIVED','.log','white_domain_requests','utf8','shop_webhooks_errors','logShopWebhookSent','WEBHOOK_PROCESSED','Failed\x20to\x20write\x20','path','\x20log:','getDate','appendFileSync','statSync','stack','loggerService','57357KajZyF','logWhiteDomainResponse','stringify','join','RESPONSE','logWebhookError','logs','API_CALL','localeCompare','getLogStats','unlinkSync'];a44_0xb978=function(){return _0x1e16ea;};return a44_0xb978();}const fs_1=__importDefault(require('fs')),path_1=__importDefault(require(a44_0xc4b101(0xd4)));class LoggerService{constructor(){const _0x71e5cd=a44_0xc4b101;this[_0x71e5cd(0xaf)]=path_1[_0x71e5cd(0xc5)][_0x71e5cd(0xde)](process[_0x71e5cd(0xe6)](),_0x71e5cd(0xe1)),this[_0x71e5cd(0xc1)]();}[a44_0xc4b101(0xc1)](){const _0x21e36e=a44_0xc4b101;!fs_1[_0x21e36e(0xc5)][_0x21e36e(0xcb)](this[_0x21e36e(0xaf)])&&(fs_1[_0x21e36e(0xc5)][_0x21e36e(0xbe)](this['logsDir'],{'recursive':!![]}),console[_0x21e36e(0xc6)](_0x21e36e(0xba)+this[_0x21e36e(0xaf)]));}[a44_0xc4b101(0xc3)](_0x6926a0){const _0x1d4447=a44_0xc4b101,_0x2f3d0a=new Date()[_0x1d4447(0xb0)]()['split']('T')[0x0];return path_1[_0x1d4447(0xc5)][_0x1d4447(0xde)](this[_0x1d4447(0xaf)],_0x6926a0+'_'+_0x2f3d0a+_0x1d4447(0xcd));}['writeLog'](_0x160d8a,_0x22f6e3){const _0x1987e9=a44_0xc4b101;try{const _0x49fc29=new Date()[_0x1987e9(0xb0)](),_0x370bde={'timestamp':_0x49fc29,..._0x22f6e3},_0x718a72=JSON[_0x1987e9(0xdd)](_0x370bde)+'\x0a',_0x1e24b8=this['getLogFileName'](_0x160d8a);fs_1['default'][_0x1987e9(0xd7)](_0x1e24b8,_0x718a72,_0x1987e9(0xcf));}catch(_0x5a02f3){console[_0x1987e9(0xef)](_0x1987e9(0xd3)+_0x160d8a+_0x1987e9(0xd5),_0x5a02f3);}}[a44_0xc4b101(0xbc)](_0x493d96,_0x4c4561,_0x2d9bb1,_0x448662){const _0x24db07=a44_0xc4b101;this[_0x24db07(0xee)](_0x24db07(0xce),{'type':_0x24db07(0xb5),'gateway':_0x493d96,'endpoint':_0x4c4561,'method':_0x2d9bb1,'data':_0x448662});}[a44_0xc4b101(0xdc)](_0x3b7810,_0x2986d5,_0x55d7f9,_0x2d2cc8,_0x3dfd82){const _0x4cd2e9=a44_0xc4b101;this[_0x4cd2e9(0xee)](_0x4cd2e9(0xbd),{'type':_0x4cd2e9(0xdf),'gateway':_0x3b7810,'endpoint':_0x2986d5,'status':_0x55d7f9,'responseTime':_0x3dfd82,'data':_0x2d2cc8});}[a44_0xc4b101(0xb6)](_0x46762e,_0x47ddb9,_0x3a3323){const _0x26c624=a44_0xc4b101;this[_0x26c624(0xee)](_0x26c624(0xa5),{'type':'ERROR','gateway':_0x46762e,'endpoint':_0x47ddb9,'error':_0x3a3323 instanceof Error?{'message':_0x3a3323[_0x26c624(0xa2)],'stack':_0x3a3323['stack']}:_0x3a3323});}[a44_0xc4b101(0xb8)](_0x1b565b,_0x322a66,_0x31e7fe){const _0x963a23=a44_0xc4b101;this['writeLog']('webhooks_received',{'type':_0x963a23(0xcc),'gateway':_0x1b565b,'headers':_0x31e7fe,'data':_0x322a66});}['logWebhookProcessed'](_0x386cb8,_0x58962f,_0x594377,_0x55b58d,_0x270138){const _0x531d6f=a44_0xc4b101;this[_0x531d6f(0xee)](_0x531d6f(0xe7),{'type':_0x531d6f(0xd2),'gateway':_0x386cb8,'paymentId':_0x58962f,'oldStatus':_0x594377,'newStatus':_0x55b58d,'originalData':_0x270138});}[a44_0xc4b101(0xe0)](_0x4aaed1,_0x133595,_0x15c678){const _0x44ce57=a44_0xc4b101;this[_0x44ce57(0xee)](_0x44ce57(0xa1),{'type':_0x44ce57(0xbb),'gateway':_0x4aaed1,'error':_0x133595 instanceof Error?{'message':_0x133595[_0x44ce57(0xa2)],'stack':_0x133595[_0x44ce57(0xd9)]}:_0x133595,'originalData':_0x15c678});}[a44_0xc4b101(0xd1)](_0x3ee321,_0x264ff8,_0x5ab8dd,_0x3da341,_0xb19931,_0x5cc5b8){const _0x4ad2fe=a44_0xc4b101;this[_0x4ad2fe(0xee)](_0x4ad2fe(0xeb),{'type':'SHOP_WEBHOOK_SENT','shopId':_0x3ee321,'webhookUrl':_0x264ff8,'event':_0x5ab8dd,'status':_0x3da341,'responseTime':_0xb19931,'payload':_0x5cc5b8});}['logShopWebhookError'](_0x1420f1,_0xfc9ccf,_0x42e601,_0x456fc7,_0x2cfe29){const _0x5278e7=a44_0xc4b101;this[_0x5278e7(0xee)](_0x5278e7(0xd0),{'type':_0x5278e7(0xa6),'shopId':_0x1420f1,'webhookUrl':_0xfc9ccf,'event':_0x42e601,'error':_0x456fc7 instanceof Error?{'message':_0x456fc7[_0x5278e7(0xa2)],'stack':_0x456fc7[_0x5278e7(0xd9)]}:_0x456fc7,'payload':_0x2cfe29});}['logPaymentCreated'](_0x49d92f,_0x50d574,_0x7fbc,_0x5f8a1a,_0x189f02){const _0x30d0aa=a44_0xc4b101;this[_0x30d0aa(0xee)](_0x30d0aa(0xad),{'type':_0x30d0aa(0xe8),'gateway':_0x49d92f,'paymentId':_0x50d574,'shopId':_0x7fbc,'amount':_0x5f8a1a,'currency':_0x189f02});}[a44_0xc4b101(0xb1)](_0x201ea3,_0x2d9baf,_0x25f368,_0x127154,_0xafa0a6){const _0x37fc5b=a44_0xc4b101;this['writeLog']('api_calls',{'type':_0x37fc5b(0xe2),'endpoint':_0x201ea3,'method':_0x2d9baf,'userId':_0x25f368,'userRole':_0x127154,'requestData':_0xafa0a6});}[a44_0xc4b101(0xe4)](){const _0xcb4d0a=a44_0xc4b101;try{const _0x32a018=fs_1['default'][_0xcb4d0a(0xc8)](this[_0xcb4d0a(0xaf)]),_0x536a6a=_0x32a018[_0xcb4d0a(0xed)](_0x180dbc=>_0x180dbc[_0xcb4d0a(0xe9)](_0xcb4d0a(0xcd))),_0x2aa294=[...new Set(_0x536a6a[_0xcb4d0a(0xb9)](_0x3b76af=>_0x3b76af['split']('_')[0x0]))],_0x605547=_0x536a6a[_0xcb4d0a(0xb9)](_0x55721e=>{const _0x36d689=_0xcb4d0a,_0x29cb9a=path_1[_0x36d689(0xc5)][_0x36d689(0xde)](this[_0x36d689(0xaf)],_0x55721e),_0x1f1317=fs_1['default']['statSync'](_0x29cb9a),[_0x5eda19,_0x5467d8]=_0x55721e['replace'](_0x36d689(0xcd),'')['split']('_');return{'type':_0x5eda19,'date':_0x5467d8,'size':_0x1f1317[_0x36d689(0xc9)]};})[_0xcb4d0a(0xca)]((_0x40cbe1,_0x2dd4da)=>_0x2dd4da['date'][_0xcb4d0a(0xe3)](_0x40cbe1['date']));return{'totalFiles':_0x536a6a[_0xcb4d0a(0xa4)],'logTypes':_0x2aa294,'latestLogs':_0x605547[_0xcb4d0a(0xb3)](0x0,0xa)};}catch(_0x2193a0){return console[_0xcb4d0a(0xef)](_0xcb4d0a(0xc2),_0x2193a0),{'totalFiles':0x0,'logTypes':[],'latestLogs':[]};}}['cleanOldLogs'](_0x2c4917=0x1e){const _0x2fc50e=a44_0xc4b101;try{const _0xf95619=fs_1[_0x2fc50e(0xc5)][_0x2fc50e(0xc8)](this[_0x2fc50e(0xaf)]),_0xe0d3f6=new Date();_0xe0d3f6[_0x2fc50e(0xec)](_0xe0d3f6[_0x2fc50e(0xd6)]()-_0x2c4917);let _0x19cc2d=0x0;_0xf95619['forEach'](_0x5ebfff=>{const _0x1c3ad7=_0x2fc50e;if(!_0x5ebfff['endsWith']('.log'))return;const _0x596f04=path_1[_0x1c3ad7(0xc5)][_0x1c3ad7(0xde)](this[_0x1c3ad7(0xaf)],_0x5ebfff),_0x4feed8=fs_1[_0x1c3ad7(0xc5)][_0x1c3ad7(0xd8)](_0x596f04);_0x4feed8[_0x1c3ad7(0xb2)]<_0xe0d3f6&&(fs_1[_0x1c3ad7(0xc5)][_0x1c3ad7(0xe5)](_0x596f04),_0x19cc2d++,console[_0x1c3ad7(0xc6)](_0x1c3ad7(0xc0)+_0x5ebfff));}),console[_0x2fc50e(0xc6)](_0x2fc50e(0xae)+_0x19cc2d+'\x20old\x20log\x20files\x20(older\x20than\x20'+_0x2c4917+_0x2fc50e(0xa9));}catch(_0x52eb6b){console[_0x2fc50e(0xef)](_0x2fc50e(0xc4),_0x52eb6b);}}}exports['LoggerService']=LoggerService,exports[a44_0xc4b101(0xda)]=new LoggerService();