'use strict';const a47_0x5e979c=a47_0x569a;(function(_0x340382,_0x55e8f6){const _0x59549c=a47_0x569a,_0x2ce61b=_0x340382();while(!![]){try{const _0x30f86d=parseInt(_0x59549c(0xa8))/0x1*(-parseInt(_0x59549c(0xac))/0x2)+parseInt(_0x59549c(0xa3))/0x3*(parseInt(_0x59549c(0xb0))/0x4)+parseInt(_0x59549c(0xb1))/0x5+parseInt(_0x59549c(0xb2))/0x6+parseInt(_0x59549c(0xb4))/0x7+parseInt(_0x59549c(0xaa))/0x8*(-parseInt(_0x59549c(0xa6))/0x9)+parseInt(_0x59549c(0xad))/0xa;if(_0x30f86d===_0x55e8f6)break;else _0x2ce61b['push'](_0x2ce61b['shift']());}catch(_0x400e73){_0x2ce61b['push'](_0x2ce61b['shift']());}}}(a47_0x1e70,0x56675));var __importDefault=this&&this['__importDefault']||function(_0x5b79c8){const _0x40bc2b=a47_0x569a;return _0x5b79c8&&_0x5b79c8[_0x40bc2b(0x9d)]?_0x5b79c8:{'default':_0x5b79c8};};Object['defineProperty'](exports,'__esModule',{'value':!![]}),exports[a47_0x5e979c(0xb3)]=void 0x0;function a47_0x1e70(){const _0x217269=['parse','1455669anwXXm','getIntegrations','1QVmlHE','updateWebhookSettings','24ZiepwB','webhookEvents','1311556gqqKan','3367720TcJKyK','findUnique','string','764676ZfTrnu','3413885MBUwiE','974034UfHyNb','IntegrationsService','852971UYvlld','ensureSettingsExist','Shop\x20settings\x20not\x20found','shopSettings','__esModule','../config/database','webhookUrl','default','isArray','parseWebhookEvents','3jXFmlj','create'];a47_0x1e70=function(){return _0x217269;};return a47_0x1e70();}function a47_0x569a(_0x4128c1,_0x298126){const _0x1e7085=a47_0x1e70();return a47_0x569a=function(_0x569a07,_0x54ac50){_0x569a07=_0x569a07-0x9a;let _0xeeb62=_0x1e7085[_0x569a07];return _0xeeb62;},a47_0x569a(_0x4128c1,_0x298126);}const database_1=__importDefault(require(a47_0x5e979c(0x9e)));class IntegrationsService{[a47_0x5e979c(0xa2)](_0x879b46){const _0x4f591b=a47_0x5e979c;if(!_0x879b46)return[];if(Array[_0x4f591b(0xa1)](_0x879b46))return _0x879b46;if(typeof _0x879b46===_0x4f591b(0xaf))try{const _0x28b7a1=JSON[_0x4f591b(0xa5)](_0x879b46);return Array[_0x4f591b(0xa1)](_0x28b7a1)?_0x28b7a1:[];}catch{return[];}return[];}async[a47_0x5e979c(0xa7)](_0x4a5193){const _0x54cea5=a47_0x5e979c;await this[_0x54cea5(0x9a)](_0x4a5193);const _0x55b947=await database_1['default'][_0x54cea5(0x9c)][_0x54cea5(0xae)]({'where':{'shopId':_0x4a5193},'select':{'webhookUrl':!![],'webhookEvents':!![]}});if(!_0x55b947)throw new Error(_0x54cea5(0x9b));return{'webhook':{'url':_0x55b947[_0x54cea5(0x9f)],'events':this[_0x54cea5(0xa2)](_0x55b947[_0x54cea5(0xab)])}};}async[a47_0x5e979c(0xa9)](_0x2faaec,_0x192191){const _0x134964=a47_0x5e979c;await this[_0x134964(0x9a)](_0x2faaec);const _0x3eb7d7={};_0x192191[_0x134964(0x9f)]!==undefined&&(_0x3eb7d7[_0x134964(0x9f)]=_0x192191['webhookUrl']||null),_0x192191['webhookEvents']!==undefined&&(_0x3eb7d7[_0x134964(0xab)]=_0x192191[_0x134964(0xab)]||[]),await database_1[_0x134964(0xa0)]['shopSettings']['update']({'where':{'shopId':_0x2faaec},'data':_0x3eb7d7});}async[a47_0x5e979c(0x9a)](_0x3d41f7){const _0xf37716=a47_0x5e979c,_0x14f321=await database_1[_0xf37716(0xa0)][_0xf37716(0x9c)][_0xf37716(0xae)]({'where':{'shopId':_0x3d41f7}});!_0x14f321&&await database_1[_0xf37716(0xa0)][_0xf37716(0x9c)][_0xf37716(0xa4)]({'data':{'shopId':_0x3d41f7}});}}exports[a47_0x5e979c(0xb3)]=IntegrationsService;