'use strict';const a43_0x393cf8=a43_0x2846;function a43_0x1736(){const _0x31d439=['shopSettings','create','parseWebhookEvents','136LuCqQC','webhookUrl','693847TZjYqj','__esModule','1139157rxeHGO','../config/database','default','IntegrationsService','245204LtCsoO','update','2336UUTBQs','9573396Fsmkph','updateWebhookSettings','12tkqFva','Shop\x20settings\x20not\x20found','parse','1019889VcoWbA','webhookEvents','34636657hAVKJC','ensureSettingsExist','40YcXrpA','isArray','1254kMHdjZ','15gTFGuW'];a43_0x1736=function(){return _0x31d439;};return a43_0x1736();}(function(_0xfc586d,_0x5d9eaf){const _0x477818=a43_0x2846,_0x206a6c=_0xfc586d();while(!![]){try{const _0x5542e3=parseInt(_0x477818(0xd9))/0x1+-parseInt(_0x477818(0xd3))/0x2*(parseInt(_0x477818(0xdf))/0x3)+parseInt(_0x477818(0xd1))/0x4*(-parseInt(_0x477818(0xe0))/0x5)+parseInt(_0x477818(0xd4))/0x6+-parseInt(_0x477818(0xe6))/0x7*(-parseInt(_0x477818(0xe4))/0x8)+-parseInt(_0x477818(0xe8))/0x9*(-parseInt(_0x477818(0xdd))/0xa)+parseInt(_0x477818(0xdb))/0xb*(-parseInt(_0x477818(0xd6))/0xc);if(_0x5542e3===_0x5d9eaf)break;else _0x206a6c['push'](_0x206a6c['shift']());}catch(_0x422a90){_0x206a6c['push'](_0x206a6c['shift']());}}}(a43_0x1736,0xf0b22));function a43_0x2846(_0x507e9b,_0x4d7afd){const _0x1736d6=a43_0x1736();return a43_0x2846=function(_0x2846cc,_0x3dfadb){_0x2846cc=_0x2846cc-0xd1;let _0x20309d=_0x1736d6[_0x2846cc];return _0x20309d;},a43_0x2846(_0x507e9b,_0x4d7afd);}var __importDefault=this&&this['__importDefault']||function(_0x1cc7b0){return _0x1cc7b0&&_0x1cc7b0['__esModule']?_0x1cc7b0:{'default':_0x1cc7b0};};Object['defineProperty'](exports,a43_0x393cf8(0xe7),{'value':!![]}),exports[a43_0x393cf8(0xeb)]=void 0x0;const database_1=__importDefault(require(a43_0x393cf8(0xe9)));class IntegrationsService{['parseWebhookEvents'](_0xec3824){const _0x795f6=a43_0x393cf8;if(!_0xec3824)return[];if(Array['isArray'](_0xec3824))return _0xec3824;if(typeof _0xec3824==='string')try{const _0x2218a5=JSON[_0x795f6(0xd8)](_0xec3824);return Array[_0x795f6(0xde)](_0x2218a5)?_0x2218a5:[];}catch{return[];}return[];}async['getIntegrations'](_0x3b094f){const _0x48c31c=a43_0x393cf8;await this[_0x48c31c(0xdc)](_0x3b094f);const _0x58cf97=await database_1[_0x48c31c(0xea)][_0x48c31c(0xe1)]['findUnique']({'where':{'shopId':_0x3b094f},'select':{'webhookUrl':!![],'webhookEvents':!![]}});if(!_0x58cf97)throw new Error(_0x48c31c(0xd7));return{'webhook':{'url':_0x58cf97['webhookUrl'],'events':this[_0x48c31c(0xe3)](_0x58cf97['webhookEvents'])}};}async[a43_0x393cf8(0xd5)](_0x32eaf,_0x5aa82c){const _0x53002a=a43_0x393cf8;await this[_0x53002a(0xdc)](_0x32eaf);const _0x47c70d={};_0x5aa82c[_0x53002a(0xe5)]!==undefined&&(_0x47c70d['webhookUrl']=_0x5aa82c[_0x53002a(0xe5)]||null),_0x5aa82c[_0x53002a(0xda)]!==undefined&&(_0x47c70d[_0x53002a(0xda)]=_0x5aa82c[_0x53002a(0xda)]||[]),await database_1['default'][_0x53002a(0xe1)][_0x53002a(0xd2)]({'where':{'shopId':_0x32eaf},'data':_0x47c70d});}async['ensureSettingsExist'](_0x11ec52){const _0x34dbbd=a43_0x393cf8,_0x3da02b=await database_1[_0x34dbbd(0xea)][_0x34dbbd(0xe1)]['findUnique']({'where':{'shopId':_0x11ec52}});!_0x3da02b&&await database_1['default'][_0x34dbbd(0xe1)][_0x34dbbd(0xe2)]({'data':{'shopId':_0x11ec52}});}}exports[a43_0x393cf8(0xeb)]=IntegrationsService;