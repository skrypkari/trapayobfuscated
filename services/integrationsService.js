'use strict';const a78_0x1b8e1f=a78_0x4221;function a78_0x57b6(){const _0x55ae00=['2288mXaYAJ','371lhcjFs','default','isArray','parseWebhookEvents','IntegrationsService','webhookUrl','792sovgRz','ensureSettingsExist','defineProperty','3135075cWEAdb','446606zwnzys','3505ihdlSN','string','webhookEvents','__esModule','69294mdjnGo','147418hBrywJ','shopSettings','updateWebhookSettings','36952yLwUEg','getIntegrations','19434690VlqNRJ'];a78_0x57b6=function(){return _0x55ae00;};return a78_0x57b6();}(function(_0x307568,_0x39c950){const _0x61e346=a78_0x4221,_0x3e19fb=_0x307568();while(!![]){try{const _0xaed6af=parseInt(_0x61e346(0x163))/0x1+parseInt(_0x61e346(0x15d))/0x2+-parseInt(_0x61e346(0x15c))/0x3+parseInt(_0x61e346(0x169))/0x4*(parseInt(_0x61e346(0x15e))/0x5)+parseInt(_0x61e346(0x162))/0x6*(-parseInt(_0x61e346(0x16a))/0x7)+parseInt(_0x61e346(0x166))/0x8*(-parseInt(_0x61e346(0x159))/0x9)+parseInt(_0x61e346(0x168))/0xa;if(_0xaed6af===_0x39c950)break;else _0x3e19fb['push'](_0x3e19fb['shift']());}catch(_0x1d7ef8){_0x3e19fb['push'](_0x3e19fb['shift']());}}}(a78_0x57b6,0x9f130));var __importDefault=this&&this['__importDefault']||function(_0x1c3509){return _0x1c3509&&_0x1c3509['__esModule']?_0x1c3509:{'default':_0x1c3509};};Object[a78_0x1b8e1f(0x15b)](exports,a78_0x1b8e1f(0x161),{'value':!![]}),exports[a78_0x1b8e1f(0x157)]=void 0x0;function a78_0x4221(_0x324ab2,_0x1e6604){_0x324ab2=_0x324ab2-0x157;const _0x57b61f=a78_0x57b6();let _0x4221a1=_0x57b61f[_0x324ab2];return _0x4221a1;}const database_1=__importDefault(require('../config/database'));class IntegrationsService{['parseWebhookEvents'](_0x15d55d){const _0x4cdbea=a78_0x1b8e1f;if(!_0x15d55d)return[];if(Array[_0x4cdbea(0x16c)](_0x15d55d))return _0x15d55d;if(typeof _0x15d55d===_0x4cdbea(0x15f))try{const _0x43f927=JSON['parse'](_0x15d55d);return Array[_0x4cdbea(0x16c)](_0x43f927)?_0x43f927:[];}catch{return[];}return[];}async[a78_0x1b8e1f(0x167)](_0x2aebb8){const _0x96bc26=a78_0x1b8e1f;await this[_0x96bc26(0x15a)](_0x2aebb8);const _0x22f021=await database_1[_0x96bc26(0x16b)][_0x96bc26(0x164)]['findUnique']({'where':{'shopId':_0x2aebb8},'select':{'webhookUrl':!![],'webhookEvents':!![]}});if(!_0x22f021)throw new Error('Shop\x20settings\x20not\x20found');return{'webhook':{'url':_0x22f021[_0x96bc26(0x158)],'events':this[_0x96bc26(0x16d)](_0x22f021['webhookEvents'])}};}async[a78_0x1b8e1f(0x165)](_0x3acabc,_0x1f2da9){const _0x49b8de=a78_0x1b8e1f;await this[_0x49b8de(0x15a)](_0x3acabc);const _0x50fcba={};_0x1f2da9['webhookUrl']!==undefined&&(_0x50fcba['webhookUrl']=_0x1f2da9[_0x49b8de(0x158)]||null),_0x1f2da9[_0x49b8de(0x160)]!==undefined&&(_0x50fcba['webhookEvents']=_0x1f2da9[_0x49b8de(0x160)]||[]),await database_1[_0x49b8de(0x16b)]['shopSettings']['update']({'where':{'shopId':_0x3acabc},'data':_0x50fcba});}async[a78_0x1b8e1f(0x15a)](_0x170cb7){const _0x1d90f0=a78_0x1b8e1f,_0x144bcc=await database_1['default']['shopSettings']['findUnique']({'where':{'shopId':_0x170cb7}});!_0x144bcc&&await database_1[_0x1d90f0(0x16b)][_0x1d90f0(0x164)]['create']({'data':{'shopId':_0x170cb7}});}}exports[a78_0x1b8e1f(0x157)]=IntegrationsService;