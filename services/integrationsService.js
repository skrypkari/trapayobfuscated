'use strict';const a48_0xe0bc22=a48_0x6e84;(function(_0x4fecd2,_0x11070d){const _0x1c0e7e=a48_0x6e84,_0x1cba4f=_0x4fecd2();while(!![]){try{const _0xe4a1e1=parseInt(_0x1c0e7e(0x13e))/0x1+parseInt(_0x1c0e7e(0x147))/0x2*(-parseInt(_0x1c0e7e(0x138))/0x3)+-parseInt(_0x1c0e7e(0x133))/0x4*(parseInt(_0x1c0e7e(0x149))/0x5)+parseInt(_0x1c0e7e(0x140))/0x6+parseInt(_0x1c0e7e(0x136))/0x7*(-parseInt(_0x1c0e7e(0x141))/0x8)+parseInt(_0x1c0e7e(0x143))/0x9+parseInt(_0x1c0e7e(0x14c))/0xa*(-parseInt(_0x1c0e7e(0x134))/0xb);if(_0xe4a1e1===_0x11070d)break;else _0x1cba4f['push'](_0x1cba4f['shift']());}catch(_0x887e47){_0x1cba4f['push'](_0x1cba4f['shift']());}}}(a48_0x31c9,0x8ff79));function a48_0x6e84(_0x162ef7,_0x1cd2e5){const _0x31c943=a48_0x31c9();return a48_0x6e84=function(_0x6e84da,_0x1a1d6a){_0x6e84da=_0x6e84da-0x133;let _0x3648d8=_0x31c943[_0x6e84da];return _0x3648d8;},a48_0x6e84(_0x162ef7,_0x1cd2e5);}function a48_0x31c9(){const _0x4d9694=['Shop\x20settings\x20not\x20found','shopSettings','findUnique','366fXARqf','default','18535KXPRFI','webhookUrl','IntegrationsService','10lFrkBa','ensureSettingsExist','parseWebhookEvents','652MOJPIl','2237191cAcCaA','__esModule','141673bTvixm','defineProperty','2058iNlbCS','parse','update','webhookEvents','isArray','__importDefault','686989zqcZdS','getIntegrations','6499806FyeQhA','184ERwjVQ','string','1962504wSnfiD'];a48_0x31c9=function(){return _0x4d9694;};return a48_0x31c9();}var __importDefault=this&&this[a48_0xe0bc22(0x13d)]||function(_0x57d9d2){const _0x40b71b=a48_0xe0bc22;return _0x57d9d2&&_0x57d9d2[_0x40b71b(0x135)]?_0x57d9d2:{'default':_0x57d9d2};};Object[a48_0xe0bc22(0x137)](exports,a48_0xe0bc22(0x135),{'value':!![]}),exports[a48_0xe0bc22(0x14b)]=void 0x0;const database_1=__importDefault(require('../config/database'));class IntegrationsService{[a48_0xe0bc22(0x14e)](_0x3ffacd){const _0x145021=a48_0xe0bc22;if(!_0x3ffacd)return[];if(Array[_0x145021(0x13c)](_0x3ffacd))return _0x3ffacd;if(typeof _0x3ffacd===_0x145021(0x142))try{const _0x10f98b=JSON[_0x145021(0x139)](_0x3ffacd);return Array[_0x145021(0x13c)](_0x10f98b)?_0x10f98b:[];}catch{return[];}return[];}async[a48_0xe0bc22(0x13f)](_0x1f7b78){const _0x501448=a48_0xe0bc22;await this['ensureSettingsExist'](_0x1f7b78);const _0x51e1f0=await database_1['default']['shopSettings']['findUnique']({'where':{'shopId':_0x1f7b78},'select':{'webhookUrl':!![],'webhookEvents':!![]}});if(!_0x51e1f0)throw new Error(_0x501448(0x144));return{'webhook':{'url':_0x51e1f0[_0x501448(0x14a)],'events':this[_0x501448(0x14e)](_0x51e1f0[_0x501448(0x13b)])}};}async['updateWebhookSettings'](_0x237e9d,_0x2e6963){const _0x393103=a48_0xe0bc22;await this[_0x393103(0x14d)](_0x237e9d);const _0x1708f5={};_0x2e6963[_0x393103(0x14a)]!==undefined&&(_0x1708f5['webhookUrl']=_0x2e6963[_0x393103(0x14a)]||null),_0x2e6963['webhookEvents']!==undefined&&(_0x1708f5['webhookEvents']=_0x2e6963[_0x393103(0x13b)]||[]),await database_1[_0x393103(0x148)][_0x393103(0x145)][_0x393103(0x13a)]({'where':{'shopId':_0x237e9d},'data':_0x1708f5});}async[a48_0xe0bc22(0x14d)](_0x358410){const _0x26dba9=a48_0xe0bc22,_0x9b2dd=await database_1[_0x26dba9(0x148)][_0x26dba9(0x145)][_0x26dba9(0x146)]({'where':{'shopId':_0x358410}});!_0x9b2dd&&await database_1[_0x26dba9(0x148)][_0x26dba9(0x145)]['create']({'data':{'shopId':_0x358410}});}}exports[a48_0xe0bc22(0x14b)]=IntegrationsService;