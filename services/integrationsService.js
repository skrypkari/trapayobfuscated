'use strict';function a43_0x24fa(_0x326052,_0x1570d2){const _0x39fbe1=a43_0x39fb();return a43_0x24fa=function(_0x24fa1d,_0x1fe1ac){_0x24fa1d=_0x24fa1d-0x10e;let _0x279ccf=_0x39fbe1[_0x24fa1d];return _0x279ccf;},a43_0x24fa(_0x326052,_0x1570d2);}function a43_0x39fb(){const _0x130e73=['1763853OFXQSu','1dhJFHH','IntegrationsService','../config/database','update','__esModule','isArray','ensureSettingsExist','default','132638yKVrCN','shopSettings','getIntegrations','156125dpOyYF','1239570DFcntu','214992oYwqGf','updateWebhookSettings','1025286gFWsav','2006464klBLOG','findUnique','webhookUrl','string','parse','webhookEvents','72vuyKSq','create','parseWebhookEvents','defineProperty','__importDefault'];a43_0x39fb=function(){return _0x130e73;};return a43_0x39fb();}const a43_0x157a70=a43_0x24fa;(function(_0x3d1550,_0x10a3a1){const _0x364e92=a43_0x24fa,_0x272d84=_0x3d1550();while(!![]){try{const _0xec6ee7=parseInt(_0x364e92(0x11b))/0x1*(parseInt(_0x364e92(0x123))/0x2)+-parseInt(_0x364e92(0x128))/0x3+-parseInt(_0x364e92(0x10f))/0x4+parseInt(_0x364e92(0x126))/0x5+-parseInt(_0x364e92(0x10e))/0x6+-parseInt(_0x364e92(0x11a))/0x7+-parseInt(_0x364e92(0x115))/0x8*(-parseInt(_0x364e92(0x127))/0x9);if(_0xec6ee7===_0x10a3a1)break;else _0x272d84['push'](_0x272d84['shift']());}catch(_0x1feba5){_0x272d84['push'](_0x272d84['shift']());}}}(a43_0x39fb,0x533ee));var __importDefault=this&&this[a43_0x157a70(0x119)]||function(_0x5bf718){const _0x32dd7f=a43_0x157a70;return _0x5bf718&&_0x5bf718[_0x32dd7f(0x11f)]?_0x5bf718:{'default':_0x5bf718};};Object[a43_0x157a70(0x118)](exports,a43_0x157a70(0x11f),{'value':!![]}),exports[a43_0x157a70(0x11c)]=void 0x0;const database_1=__importDefault(require(a43_0x157a70(0x11d)));class IntegrationsService{['parseWebhookEvents'](_0x1d01db){const _0x79fbe8=a43_0x157a70;if(!_0x1d01db)return[];if(Array[_0x79fbe8(0x120)](_0x1d01db))return _0x1d01db;if(typeof _0x1d01db===_0x79fbe8(0x112))try{const _0x3a63dd=JSON[_0x79fbe8(0x113)](_0x1d01db);return Array[_0x79fbe8(0x120)](_0x3a63dd)?_0x3a63dd:[];}catch{return[];}return[];}async[a43_0x157a70(0x125)](_0x2101ee){const _0x23d6c8=a43_0x157a70;await this[_0x23d6c8(0x121)](_0x2101ee);const _0x3debeb=await database_1['default']['shopSettings'][_0x23d6c8(0x110)]({'where':{'shopId':_0x2101ee},'select':{'webhookUrl':!![],'webhookEvents':!![]}});if(!_0x3debeb)throw new Error('Shop\x20settings\x20not\x20found');return{'webhook':{'url':_0x3debeb[_0x23d6c8(0x111)],'events':this[_0x23d6c8(0x117)](_0x3debeb['webhookEvents'])}};}async[a43_0x157a70(0x129)](_0x48c2ba,_0x201212){const _0x32b94f=a43_0x157a70;await this[_0x32b94f(0x121)](_0x48c2ba);const _0x5acecd={};_0x201212[_0x32b94f(0x111)]!==undefined&&(_0x5acecd[_0x32b94f(0x111)]=_0x201212[_0x32b94f(0x111)]||null),_0x201212['webhookEvents']!==undefined&&(_0x5acecd[_0x32b94f(0x114)]=_0x201212['webhookEvents']||[]),await database_1[_0x32b94f(0x122)][_0x32b94f(0x124)][_0x32b94f(0x11e)]({'where':{'shopId':_0x48c2ba},'data':_0x5acecd});}async[a43_0x157a70(0x121)](_0x5ab19f){const _0x30d0ce=a43_0x157a70,_0x54a265=await database_1[_0x30d0ce(0x122)][_0x30d0ce(0x124)]['findUnique']({'where':{'shopId':_0x5ab19f}});!_0x54a265&&await database_1[_0x30d0ce(0x122)][_0x30d0ce(0x124)][_0x30d0ce(0x116)]({'data':{'shopId':_0x5ab19f}});}}exports[a43_0x157a70(0x11c)]=IntegrationsService;