'use strict';function a58_0x3f7b(_0xe260b8,_0x562a78){const _0x4e5abe=a58_0x4e5a();return a58_0x3f7b=function(_0x3f7ba5,_0x2a908a){_0x3f7ba5=_0x3f7ba5-0xb3;let _0x228fd0=_0x4e5abe[_0x3f7ba5];return _0x228fd0;},a58_0x3f7b(_0xe260b8,_0x562a78);}function a58_0x4e5a(){const _0x1ea204=['55BUUjGQ','webhookUrl','Shop\x20settings\x20not\x20found','566680cpsqYs','parse','ensureSettingsExist','119238sSpYQC','5uFPxRk','isArray','string','default','shopSettings','83652TuNoea','1256QFlefn','2240296onWXqX','2561034sGcngL','webhookEvents','create','getIntegrations','__importDefault','__esModule','2894208aXaGqn','14YYXpcN','defineProperty','31275iAXRZz','updateWebhookSettings','../config/database','IntegrationsService'];a58_0x4e5a=function(){return _0x1ea204;};return a58_0x4e5a();}const a58_0x3be24f=a58_0x3f7b;(function(_0x3a4330,_0x1ced82){const _0x546ddd=a58_0x3f7b,_0x4b0872=_0x3a4330();while(!![]){try{const _0x5d3162=-parseInt(_0x546ddd(0xc8))/0x1+parseInt(_0x546ddd(0xbc))/0x2*(-parseInt(_0x546ddd(0xce))/0x3)+parseInt(_0x546ddd(0xb4))/0x4*(parseInt(_0x546ddd(0xc9))/0x5)+-parseInt(_0x546ddd(0xbb))/0x6+parseInt(_0x546ddd(0xb5))/0x7+-parseInt(_0x546ddd(0xb3))/0x8*(-parseInt(_0x546ddd(0xbe))/0x9)+-parseInt(_0x546ddd(0xc5))/0xa*(parseInt(_0x546ddd(0xc2))/0xb);if(_0x5d3162===_0x1ced82)break;else _0x4b0872['push'](_0x4b0872['shift']());}catch(_0x489cf6){_0x4b0872['push'](_0x4b0872['shift']());}}}(a58_0x4e5a,0x5f8d1));var __importDefault=this&&this[a58_0x3be24f(0xb9)]||function(_0xa74d4b){const _0xa10a96=a58_0x3be24f;return _0xa74d4b&&_0xa74d4b[_0xa10a96(0xba)]?_0xa74d4b:{'default':_0xa74d4b};};Object[a58_0x3be24f(0xbd)](exports,a58_0x3be24f(0xba),{'value':!![]}),exports[a58_0x3be24f(0xc1)]=void 0x0;const database_1=__importDefault(require(a58_0x3be24f(0xc0)));class IntegrationsService{['parseWebhookEvents'](_0xd22c93){const _0x34c3ac=a58_0x3be24f;if(!_0xd22c93)return[];if(Array[_0x34c3ac(0xca)](_0xd22c93))return _0xd22c93;if(typeof _0xd22c93===_0x34c3ac(0xcb))try{const _0x3a0748=JSON[_0x34c3ac(0xc6)](_0xd22c93);return Array[_0x34c3ac(0xca)](_0x3a0748)?_0x3a0748:[];}catch{return[];}return[];}async[a58_0x3be24f(0xb8)](_0x184a36){const _0x5b69eb=a58_0x3be24f;await this[_0x5b69eb(0xc7)](_0x184a36);const _0x39355e=await database_1[_0x5b69eb(0xcc)][_0x5b69eb(0xcd)]['findUnique']({'where':{'shopId':_0x184a36},'select':{'webhookUrl':!![],'webhookEvents':!![]}});if(!_0x39355e)throw new Error(_0x5b69eb(0xc4));return{'webhook':{'url':_0x39355e[_0x5b69eb(0xc3)],'events':this['parseWebhookEvents'](_0x39355e[_0x5b69eb(0xb6)])}};}async[a58_0x3be24f(0xbf)](_0x3d60ac,_0x5933b0){const _0x339d7d=a58_0x3be24f;await this[_0x339d7d(0xc7)](_0x3d60ac);const _0x33edc1={};_0x5933b0['webhookUrl']!==undefined&&(_0x33edc1[_0x339d7d(0xc3)]=_0x5933b0['webhookUrl']||null),_0x5933b0['webhookEvents']!==undefined&&(_0x33edc1[_0x339d7d(0xb6)]=_0x5933b0[_0x339d7d(0xb6)]||[]),await database_1[_0x339d7d(0xcc)][_0x339d7d(0xcd)]['update']({'where':{'shopId':_0x3d60ac},'data':_0x33edc1});}async[a58_0x3be24f(0xc7)](_0x3661a2){const _0x555f5c=a58_0x3be24f,_0x396579=await database_1[_0x555f5c(0xcc)][_0x555f5c(0xcd)]['findUnique']({'where':{'shopId':_0x3661a2}});!_0x396579&&await database_1['default'][_0x555f5c(0xcd)][_0x555f5c(0xb7)]({'data':{'shopId':_0x3661a2}});}}exports[a58_0x3be24f(0xc1)]=IntegrationsService;