'use strict';const a78_0x2213bf=a78_0x406d;(function(_0x9aa876,_0x3afb85){const _0x13a0ed=a78_0x406d,_0x38778b=_0x9aa876();while(!![]){try{const _0x1e2191=parseInt(_0x13a0ed(0x1d8))/0x1*(parseInt(_0x13a0ed(0x1e6))/0x2)+parseInt(_0x13a0ed(0x1db))/0x3+-parseInt(_0x13a0ed(0x1ce))/0x4*(-parseInt(_0x13a0ed(0x1da))/0x5)+-parseInt(_0x13a0ed(0x1dd))/0x6*(-parseInt(_0x13a0ed(0x1dc))/0x7)+parseInt(_0x13a0ed(0x1d3))/0x8*(parseInt(_0x13a0ed(0x1d6))/0x9)+-parseInt(_0x13a0ed(0x1d4))/0xa*(-parseInt(_0x13a0ed(0x1d2))/0xb)+parseInt(_0x13a0ed(0x1d1))/0xc*(-parseInt(_0x13a0ed(0x1e8))/0xd);if(_0x1e2191===_0x3afb85)break;else _0x38778b['push'](_0x38778b['shift']());}catch(_0x1f0e97){_0x38778b['push'](_0x38778b['shift']());}}}(a78_0x3247,0x77214));var __importDefault=this&&this[a78_0x2213bf(0x1e7)]||function(_0x3bfff7){const _0x4fb248=a78_0x2213bf;return _0x3bfff7&&_0x3bfff7[_0x4fb248(0x1d9)]?_0x3bfff7:{'default':_0x3bfff7};};Object['defineProperty'](exports,a78_0x2213bf(0x1d9),{'value':!![]}),exports[a78_0x2213bf(0x1cf)]=void 0x0;function a78_0x3247(){const _0x21b87a=['webhookUrl','webhookEvents','../config/database','string','58816WiXRIm','__importDefault','10837099habOBl','shopSettings','parseWebhookEvents','12RQfgTR','IntegrationsService','default','36WaZKBB','5422241ekJKSJ','366488jcPAbQ','10RApTpH','update','36tLNADc','Shop\x20settings\x20not\x20found','23IzWweT','__esModule','526135ZtfBPZ','2282754HPtGFZ','3917669LvJynq','6tBWRHn','ensureSettingsExist','create','isArray','findUnique'];a78_0x3247=function(){return _0x21b87a;};return a78_0x3247();}const database_1=__importDefault(require(a78_0x2213bf(0x1e4)));class IntegrationsService{[a78_0x2213bf(0x1ea)](_0x5eec9b){const _0x214f84=a78_0x2213bf;if(!_0x5eec9b)return[];if(Array[_0x214f84(0x1e0)](_0x5eec9b))return _0x5eec9b;if(typeof _0x5eec9b===_0x214f84(0x1e5))try{const _0x25badc=JSON['parse'](_0x5eec9b);return Array['isArray'](_0x25badc)?_0x25badc:[];}catch{return[];}return[];}async['getIntegrations'](_0x424550){const _0x3b29a4=a78_0x2213bf;await this[_0x3b29a4(0x1de)](_0x424550);const _0x21c691=await database_1[_0x3b29a4(0x1d0)][_0x3b29a4(0x1e9)][_0x3b29a4(0x1e1)]({'where':{'shopId':_0x424550},'select':{'webhookUrl':!![],'webhookEvents':!![]}});if(!_0x21c691)throw new Error(_0x3b29a4(0x1d7));return{'webhook':{'url':_0x21c691[_0x3b29a4(0x1e2)],'events':this[_0x3b29a4(0x1ea)](_0x21c691[_0x3b29a4(0x1e3)])}};}async['updateWebhookSettings'](_0x423768,_0x403f25){const _0x1a15f8=a78_0x2213bf;await this[_0x1a15f8(0x1de)](_0x423768);const _0x41f2f3={};_0x403f25[_0x1a15f8(0x1e2)]!==undefined&&(_0x41f2f3[_0x1a15f8(0x1e2)]=_0x403f25[_0x1a15f8(0x1e2)]||null),_0x403f25['webhookEvents']!==undefined&&(_0x41f2f3[_0x1a15f8(0x1e3)]=_0x403f25[_0x1a15f8(0x1e3)]||[]),await database_1['default'][_0x1a15f8(0x1e9)][_0x1a15f8(0x1d5)]({'where':{'shopId':_0x423768},'data':_0x41f2f3});}async[a78_0x2213bf(0x1de)](_0x23429e){const _0x159af9=a78_0x2213bf,_0x483743=await database_1['default'][_0x159af9(0x1e9)][_0x159af9(0x1e1)]({'where':{'shopId':_0x23429e}});!_0x483743&&await database_1[_0x159af9(0x1d0)]['shopSettings'][_0x159af9(0x1df)]({'data':{'shopId':_0x23429e}});}}function a78_0x406d(_0x2a8417,_0xb929e5){_0x2a8417=_0x2a8417-0x1ce;const _0x3247ce=a78_0x3247();let _0x406dd5=_0x3247ce[_0x2a8417];return _0x406dd5;}exports[a78_0x2213bf(0x1cf)]=IntegrationsService;