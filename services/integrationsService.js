'use strict';const a43_0x3d2d7c=a43_0x2685;(function(_0x33fdb8,_0x45ee08){const _0x5c0ee5=a43_0x2685,_0x2b19d5=_0x33fdb8();while(!![]){try{const _0x5792fb=parseInt(_0x5c0ee5(0x11a))/0x1+parseInt(_0x5c0ee5(0x132))/0x2+-parseInt(_0x5c0ee5(0x128))/0x3+-parseInt(_0x5c0ee5(0x125))/0x4*(-parseInt(_0x5c0ee5(0x11e))/0x5)+-parseInt(_0x5c0ee5(0x11b))/0x6*(parseInt(_0x5c0ee5(0x11c))/0x7)+-parseInt(_0x5c0ee5(0x122))/0x8*(parseInt(_0x5c0ee5(0x131))/0x9)+parseInt(_0x5c0ee5(0x129))/0xa;if(_0x5792fb===_0x45ee08)break;else _0x2b19d5['push'](_0x2b19d5['shift']());}catch(_0x51452f){_0x2b19d5['push'](_0x2b19d5['shift']());}}}(a43_0x15f3,0x40cf9));function a43_0x15f3(){const _0x2de87b=['646443iEHmII','74268sGktck','default','412691wsLDIH','13236SVcodR','637zdCUrQ','string','5ohISVr','webhookUrl','IntegrationsService','__esModule','16OzoSWe','../config/database','getIntegrations','1386188QtgLni','parseWebhookEvents','defineProperty','1392657wWOADj','2777120uNGDTR','__importDefault','webhookEvents','findUnique','create','ensureSettingsExist','shopSettings','isArray'];a43_0x15f3=function(){return _0x2de87b;};return a43_0x15f3();}var __importDefault=this&&this[a43_0x3d2d7c(0x12a)]||function(_0x42f5c0){const _0x167969=a43_0x3d2d7c;return _0x42f5c0&&_0x42f5c0[_0x167969(0x121)]?_0x42f5c0:{'default':_0x42f5c0};};Object[a43_0x3d2d7c(0x127)](exports,a43_0x3d2d7c(0x121),{'value':!![]}),exports[a43_0x3d2d7c(0x120)]=void 0x0;const database_1=__importDefault(require(a43_0x3d2d7c(0x123)));function a43_0x2685(_0x1ca170,_0x4d3388){const _0x15f35b=a43_0x15f3();return a43_0x2685=function(_0x268597,_0xadd5cb){_0x268597=_0x268597-0x119;let _0x18d040=_0x15f35b[_0x268597];return _0x18d040;},a43_0x2685(_0x1ca170,_0x4d3388);}class IntegrationsService{[a43_0x3d2d7c(0x126)](_0x323467){const _0x3b5b0c=a43_0x3d2d7c;if(!_0x323467)return[];if(Array[_0x3b5b0c(0x130)](_0x323467))return _0x323467;if(typeof _0x323467===_0x3b5b0c(0x11d))try{const _0x2891da=JSON['parse'](_0x323467);return Array[_0x3b5b0c(0x130)](_0x2891da)?_0x2891da:[];}catch{return[];}return[];}async[a43_0x3d2d7c(0x124)](_0x1689e8){const _0x4e0bb7=a43_0x3d2d7c;await this[_0x4e0bb7(0x12e)](_0x1689e8);const _0x589da8=await database_1[_0x4e0bb7(0x119)]['shopSettings'][_0x4e0bb7(0x12c)]({'where':{'shopId':_0x1689e8},'select':{'webhookUrl':!![],'webhookEvents':!![]}});if(!_0x589da8)throw new Error('Shop\x20settings\x20not\x20found');return{'webhook':{'url':_0x589da8[_0x4e0bb7(0x11f)],'events':this[_0x4e0bb7(0x126)](_0x589da8[_0x4e0bb7(0x12b)])}};}async['updateWebhookSettings'](_0x5503d5,_0xeba9e0){const _0x4fb6c6=a43_0x3d2d7c;await this['ensureSettingsExist'](_0x5503d5);const _0x464de1={};_0xeba9e0['webhookUrl']!==undefined&&(_0x464de1[_0x4fb6c6(0x11f)]=_0xeba9e0[_0x4fb6c6(0x11f)]||null),_0xeba9e0[_0x4fb6c6(0x12b)]!==undefined&&(_0x464de1['webhookEvents']=_0xeba9e0['webhookEvents']||[]),await database_1['default'][_0x4fb6c6(0x12f)]['update']({'where':{'shopId':_0x5503d5},'data':_0x464de1});}async['ensureSettingsExist'](_0x12816b){const _0x36aa30=a43_0x3d2d7c,_0x79bad2=await database_1[_0x36aa30(0x119)][_0x36aa30(0x12f)][_0x36aa30(0x12c)]({'where':{'shopId':_0x12816b}});!_0x79bad2&&await database_1[_0x36aa30(0x119)][_0x36aa30(0x12f)][_0x36aa30(0x12d)]({'data':{'shopId':_0x12816b}});}}exports[a43_0x3d2d7c(0x120)]=IntegrationsService;