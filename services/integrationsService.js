'use strict';const a55_0x5b1142=a55_0x38a3;(function(_0x3fbba9,_0x4eb424){const _0x40f8c8=a55_0x38a3,_0xdd6d3d=_0x3fbba9();while(!![]){try{const _0x556bc8=parseInt(_0x40f8c8(0x100))/0x1*(parseInt(_0x40f8c8(0x10d))/0x2)+-parseInt(_0x40f8c8(0xfe))/0x3+parseInt(_0x40f8c8(0x107))/0x4*(parseInt(_0x40f8c8(0xfc))/0x5)+parseInt(_0x40f8c8(0xf9))/0x6+-parseInt(_0x40f8c8(0xfd))/0x7+-parseInt(_0x40f8c8(0xf6))/0x8*(parseInt(_0x40f8c8(0x108))/0x9)+parseInt(_0x40f8c8(0x10e))/0xa;if(_0x556bc8===_0x4eb424)break;else _0xdd6d3d['push'](_0xdd6d3d['shift']());}catch(_0x5802fe){_0xdd6d3d['push'](_0xdd6d3d['shift']());}}}(a55_0x3f67,0xd343f));var __importDefault=this&&this[a55_0x5b1142(0xff)]||function(_0x207d4d){return _0x207d4d&&_0x207d4d['__esModule']?_0x207d4d:{'default':_0x207d4d};};function a55_0x3f67(){const _0x286bb5=['ensureSettingsExist','webhookUrl','8UEjrnl','parse','isArray','4357422brWnLg','parseWebhookEvents','create','145HIuhck','3882725lkTAjm','4617399jFjohU','__importDefault','1260859zuBPRs','findUnique','string','Shop\x20settings\x20not\x20found','defineProperty','shopSettings','updateWebhookSettings','148084wvqfkp','4605507GQqAwE','webhookEvents','../config/database','default','getIntegrations','2jIQnFp','4101690laIHcW','IntegrationsService'];a55_0x3f67=function(){return _0x286bb5;};return a55_0x3f67();}Object[a55_0x5b1142(0x104)](exports,'__esModule',{'value':!![]}),exports[a55_0x5b1142(0x10f)]=void 0x0;function a55_0x38a3(_0x22c988,_0x352393){const _0x3f6710=a55_0x3f67();return a55_0x38a3=function(_0x38a390,_0x4c77ad){_0x38a390=_0x38a390-0xf5;let _0x67450f=_0x3f6710[_0x38a390];return _0x67450f;},a55_0x38a3(_0x22c988,_0x352393);}const database_1=__importDefault(require(a55_0x5b1142(0x10a)));class IntegrationsService{[a55_0x5b1142(0xfa)](_0x2aef99){const _0xb74c8c=a55_0x5b1142;if(!_0x2aef99)return[];if(Array[_0xb74c8c(0xf8)](_0x2aef99))return _0x2aef99;if(typeof _0x2aef99===_0xb74c8c(0x102))try{const _0x1e8e76=JSON[_0xb74c8c(0xf7)](_0x2aef99);return Array[_0xb74c8c(0xf8)](_0x1e8e76)?_0x1e8e76:[];}catch{return[];}return[];}async[a55_0x5b1142(0x10c)](_0x3184f5){const _0x2b35b5=a55_0x5b1142;await this[_0x2b35b5(0x110)](_0x3184f5);const _0x5a0528=await database_1['default'][_0x2b35b5(0x105)][_0x2b35b5(0x101)]({'where':{'shopId':_0x3184f5},'select':{'webhookUrl':!![],'webhookEvents':!![]}});if(!_0x5a0528)throw new Error(_0x2b35b5(0x103));return{'webhook':{'url':_0x5a0528[_0x2b35b5(0xf5)],'events':this['parseWebhookEvents'](_0x5a0528[_0x2b35b5(0x109)])}};}async[a55_0x5b1142(0x106)](_0x2db4d6,_0x26aafc){const _0x3435b3=a55_0x5b1142;await this[_0x3435b3(0x110)](_0x2db4d6);const _0x135201={};_0x26aafc['webhookUrl']!==undefined&&(_0x135201[_0x3435b3(0xf5)]=_0x26aafc['webhookUrl']||null),_0x26aafc[_0x3435b3(0x109)]!==undefined&&(_0x135201[_0x3435b3(0x109)]=_0x26aafc['webhookEvents']||[]),await database_1[_0x3435b3(0x10b)][_0x3435b3(0x105)]['update']({'where':{'shopId':_0x2db4d6},'data':_0x135201});}async['ensureSettingsExist'](_0x2a4dce){const _0x5bc24a=a55_0x5b1142,_0x176243=await database_1['default']['shopSettings'][_0x5bc24a(0x101)]({'where':{'shopId':_0x2a4dce}});!_0x176243&&await database_1[_0x5bc24a(0x10b)][_0x5bc24a(0x105)][_0x5bc24a(0xfb)]({'data':{'shopId':_0x2a4dce}});}}exports[a55_0x5b1142(0x10f)]=IntegrationsService;