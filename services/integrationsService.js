'use strict';const a42_0x28294a=a42_0x537b;function a42_0x5485(){const _0x4127e5=['223797klLUHS','829314XgmnfF','11Yotmoq','2pzrCDV','../config/database','__esModule','20RjtxHx','IntegrationsService','parseWebhookEvents','64154YATLEn','parse','webhookEvents','isArray','73770yxRPdx','10JXFHYZ','8PtCtcD','shopSettings','findUnique','default','Shop\x20settings\x20not\x20found','3224806xuTsoa','update','48dTNjuv','ensureSettingsExist','1813836PacNhk','100152rKKsqh','getIntegrations','string','webhookUrl'];a42_0x5485=function(){return _0x4127e5;};return a42_0x5485();}(function(_0x592e1f,_0x514408){const _0x1e0987=a42_0x537b,_0x3eba99=_0x592e1f();while(!![]){try{const _0x4f605c=parseInt(_0x1e0987(0x162))/0x1*(-parseInt(_0x1e0987(0x15c))/0x2)+-parseInt(_0x1e0987(0x166))/0x3*(parseInt(_0x1e0987(0x168))/0x4)+parseInt(_0x1e0987(0x167))/0x5*(parseInt(_0x1e0987(0x172))/0x6)+-parseInt(_0x1e0987(0x159))/0x7*(-parseInt(_0x1e0987(0x16f))/0x8)+parseInt(_0x1e0987(0x15a))/0x9*(parseInt(_0x1e0987(0x15f))/0xa)+-parseInt(_0x1e0987(0x15b))/0xb*(-parseInt(_0x1e0987(0x171))/0xc)+-parseInt(_0x1e0987(0x16d))/0xd;if(_0x4f605c===_0x514408)break;else _0x3eba99['push'](_0x3eba99['shift']());}catch(_0x1ca0cd){_0x3eba99['push'](_0x3eba99['shift']());}}}(a42_0x5485,0x30a5b));var __importDefault=this&&this['__importDefault']||function(_0x1ee910){const _0x5cfd21=a42_0x537b;return _0x1ee910&&_0x1ee910[_0x5cfd21(0x15e)]?_0x1ee910:{'default':_0x1ee910};};Object['defineProperty'](exports,a42_0x28294a(0x15e),{'value':!![]}),exports['IntegrationsService']=void 0x0;const database_1=__importDefault(require(a42_0x28294a(0x15d)));function a42_0x537b(_0x12dc27,_0x342e40){const _0x5485cc=a42_0x5485();return a42_0x537b=function(_0x537b3b,_0x4eb425){_0x537b3b=_0x537b3b-0x157;let _0x23e439=_0x5485cc[_0x537b3b];return _0x23e439;},a42_0x537b(_0x12dc27,_0x342e40);}class IntegrationsService{['parseWebhookEvents'](_0xbda45e){const _0x38da0f=a42_0x28294a;if(!_0xbda45e)return[];if(Array['isArray'](_0xbda45e))return _0xbda45e;if(typeof _0xbda45e===_0x38da0f(0x157))try{const _0x3b15de=JSON[_0x38da0f(0x163)](_0xbda45e);return Array[_0x38da0f(0x165)](_0x3b15de)?_0x3b15de:[];}catch{return[];}return[];}async[a42_0x28294a(0x173)](_0x298973){const _0x1b6be5=a42_0x28294a;await this[_0x1b6be5(0x170)](_0x298973);const _0xc6940e=await database_1[_0x1b6be5(0x16b)][_0x1b6be5(0x169)]['findUnique']({'where':{'shopId':_0x298973},'select':{'webhookUrl':!![],'webhookEvents':!![]}});if(!_0xc6940e)throw new Error(_0x1b6be5(0x16c));return{'webhook':{'url':_0xc6940e[_0x1b6be5(0x158)],'events':this[_0x1b6be5(0x161)](_0xc6940e[_0x1b6be5(0x164)])}};}async['updateWebhookSettings'](_0x5000e6,_0x2ecec5){const _0x18f735=a42_0x28294a;await this[_0x18f735(0x170)](_0x5000e6);const _0x26be5c={};_0x2ecec5['webhookUrl']!==undefined&&(_0x26be5c[_0x18f735(0x158)]=_0x2ecec5[_0x18f735(0x158)]||null),_0x2ecec5[_0x18f735(0x164)]!==undefined&&(_0x26be5c[_0x18f735(0x164)]=_0x2ecec5[_0x18f735(0x164)]||[]),await database_1[_0x18f735(0x16b)][_0x18f735(0x169)][_0x18f735(0x16e)]({'where':{'shopId':_0x5000e6},'data':_0x26be5c});}async[a42_0x28294a(0x170)](_0x25a553){const _0x476da0=a42_0x28294a,_0x479878=await database_1['default']['shopSettings'][_0x476da0(0x16a)]({'where':{'shopId':_0x25a553}});!_0x479878&&await database_1[_0x476da0(0x16b)][_0x476da0(0x169)]['create']({'data':{'shopId':_0x25a553}});}}exports[a42_0x28294a(0x160)]=IntegrationsService;