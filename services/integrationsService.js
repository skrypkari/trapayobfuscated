'use strict';function a78_0x1cf2(_0x3e709f,_0x4e9fea){_0x3e709f=_0x3e709f-0xe8;const _0x575ec1=a78_0x575e();let _0x1cf22d=_0x575ec1[_0x3e709f];return _0x1cf22d;}const a78_0x470071=a78_0x1cf2;(function(_0x3bc0e8,_0x1ad510){const _0x2b2158=a78_0x1cf2,_0x51b224=_0x3bc0e8();while(!![]){try{const _0x30c17c=parseInt(_0x2b2158(0xfd))/0x1+parseInt(_0x2b2158(0xef))/0x2*(-parseInt(_0x2b2158(0xf0))/0x3)+-parseInt(_0x2b2158(0xe8))/0x4+parseInt(_0x2b2158(0xec))/0x5+-parseInt(_0x2b2158(0xfa))/0x6*(parseInt(_0x2b2158(0xf9))/0x7)+parseInt(_0x2b2158(0x100))/0x8+parseInt(_0x2b2158(0xf6))/0x9;if(_0x30c17c===_0x1ad510)break;else _0x51b224['push'](_0x51b224['shift']());}catch(_0x558cb0){_0x51b224['push'](_0x51b224['shift']());}}}(a78_0x575e,0xd6004));var __importDefault=this&&this['__importDefault']||function(_0x1fd151){const _0x1eecd1=a78_0x1cf2;return _0x1fd151&&_0x1fd151[_0x1eecd1(0xf8)]?_0x1fd151:{'default':_0x1fd151};};Object['defineProperty'](exports,a78_0x470071(0xf8),{'value':!![]}),exports[a78_0x470071(0xed)]=void 0x0;const database_1=__importDefault(require(a78_0x470071(0xf3)));function a78_0x575e(){const _0x1e1e08=['__esModule','35bNdoUt','1914252axuEqM','create','webhookUrl','649166SDnTjh','parseWebhookEvents','isArray','7496096Rixqay','4731628XAUHXx','Shop\x20settings\x20not\x20found','findUnique','webhookEvents','8332745eXKumD','IntegrationsService','string','669070UJqyCK','15SZBCNj','ensureSettingsExist','shopSettings','../config/database','updateWebhookSettings','default','18671517TFETJr','update'];a78_0x575e=function(){return _0x1e1e08;};return a78_0x575e();}class IntegrationsService{[a78_0x470071(0xfe)](_0x9b215e){const _0x42a8d9=a78_0x470071;if(!_0x9b215e)return[];if(Array[_0x42a8d9(0xff)](_0x9b215e))return _0x9b215e;if(typeof _0x9b215e===_0x42a8d9(0xee))try{const _0x3305e1=JSON['parse'](_0x9b215e);return Array[_0x42a8d9(0xff)](_0x3305e1)?_0x3305e1:[];}catch{return[];}return[];}async['getIntegrations'](_0x1f2693){const _0x5b3060=a78_0x470071;await this[_0x5b3060(0xf1)](_0x1f2693);const _0x3aab35=await database_1['default']['shopSettings'][_0x5b3060(0xea)]({'where':{'shopId':_0x1f2693},'select':{'webhookUrl':!![],'webhookEvents':!![]}});if(!_0x3aab35)throw new Error(_0x5b3060(0xe9));return{'webhook':{'url':_0x3aab35['webhookUrl'],'events':this[_0x5b3060(0xfe)](_0x3aab35[_0x5b3060(0xeb)])}};}async[a78_0x470071(0xf4)](_0x5d1cf2,_0x23a9c5){const _0x66aa88=a78_0x470071;await this['ensureSettingsExist'](_0x5d1cf2);const _0x78be5b={};_0x23a9c5[_0x66aa88(0xfc)]!==undefined&&(_0x78be5b['webhookUrl']=_0x23a9c5['webhookUrl']||null),_0x23a9c5[_0x66aa88(0xeb)]!==undefined&&(_0x78be5b[_0x66aa88(0xeb)]=_0x23a9c5['webhookEvents']||[]),await database_1[_0x66aa88(0xf5)][_0x66aa88(0xf2)][_0x66aa88(0xf7)]({'where':{'shopId':_0x5d1cf2},'data':_0x78be5b});}async['ensureSettingsExist'](_0x33f816){const _0x5afed1=a78_0x470071,_0x372c83=await database_1[_0x5afed1(0xf5)][_0x5afed1(0xf2)][_0x5afed1(0xea)]({'where':{'shopId':_0x33f816}});!_0x372c83&&await database_1[_0x5afed1(0xf5)]['shopSettings'][_0x5afed1(0xfb)]({'data':{'shopId':_0x33f816}});}}exports[a78_0x470071(0xed)]=IntegrationsService;