'use strict';const a66_0x1efa0f=a66_0x4d7f;(function(_0x46ee22,_0xf5ffaf){const _0x296a12=a66_0x4d7f,_0x1e55f2=_0x46ee22();while(!![]){try{const _0x3c02c1=parseInt(_0x296a12(0x81))/0x1+-parseInt(_0x296a12(0x85))/0x2*(-parseInt(_0x296a12(0x94))/0x3)+parseInt(_0x296a12(0x8e))/0x4*(parseInt(_0x296a12(0x86))/0x5)+-parseInt(_0x296a12(0x8f))/0x6+parseInt(_0x296a12(0x8a))/0x7*(parseInt(_0x296a12(0x90))/0x8)+parseInt(_0x296a12(0x83))/0x9+-parseInt(_0x296a12(0x8d))/0xa;if(_0x3c02c1===_0xf5ffaf)break;else _0x1e55f2['push'](_0x1e55f2['shift']());}catch(_0x14e899){_0x1e55f2['push'](_0x1e55f2['shift']());}}}(a66_0x5457,0xeaeae));function a66_0x4d7f(_0x149907,_0x5a2a7a){_0x149907=_0x149907-0x7f;const _0x545796=a66_0x5457();let _0x4d7f28=_0x545796[_0x149907];return _0x4d7f28;}var __importDefault=this&&this[a66_0x1efa0f(0x89)]||function(_0x24e467){return _0x24e467&&_0x24e467['__esModule']?_0x24e467:{'default':_0x24e467};};Object[a66_0x1efa0f(0x9a)](exports,'__esModule',{'value':!![]}),exports[a66_0x1efa0f(0x88)]=void 0x0;function a66_0x5457(){const _0x2c0638=['webhookEvents','IntegrationsService','__importDefault','2443IZYzPw','getIntegrations','ensureSettingsExist','53059870ZNTmyD','412eJrNyC','91464IkTgLq','9712OHesfa','shopSettings','parseWebhookEvents','findUnique','495ckzcrN','../config/database','isArray','update','parse','string','defineProperty','create','webhookUrl','1442151VYrqAU','default','10433763FyWJNY','Shop\x20settings\x20not\x20found','20464aiJqMN','76215orMOzE'];a66_0x5457=function(){return _0x2c0638;};return a66_0x5457();}const database_1=__importDefault(require(a66_0x1efa0f(0x95)));class IntegrationsService{[a66_0x1efa0f(0x92)](_0x1c2b42){const _0x517c79=a66_0x1efa0f;if(!_0x1c2b42)return[];if(Array[_0x517c79(0x96)](_0x1c2b42))return _0x1c2b42;if(typeof _0x1c2b42===_0x517c79(0x99))try{const _0x47e9ef=JSON[_0x517c79(0x98)](_0x1c2b42);return Array[_0x517c79(0x96)](_0x47e9ef)?_0x47e9ef:[];}catch{return[];}return[];}async[a66_0x1efa0f(0x8b)](_0x17c4e7){const _0x235e24=a66_0x1efa0f;await this[_0x235e24(0x8c)](_0x17c4e7);const _0x2139c9=await database_1['default'][_0x235e24(0x91)]['findUnique']({'where':{'shopId':_0x17c4e7},'select':{'webhookUrl':!![],'webhookEvents':!![]}});if(!_0x2139c9)throw new Error(_0x235e24(0x84));return{'webhook':{'url':_0x2139c9[_0x235e24(0x80)],'events':this['parseWebhookEvents'](_0x2139c9[_0x235e24(0x87)])}};}async['updateWebhookSettings'](_0x5a6938,_0x57cd5d){const _0x5bfc14=a66_0x1efa0f;await this[_0x5bfc14(0x8c)](_0x5a6938);const _0x4bc749={};_0x57cd5d[_0x5bfc14(0x80)]!==undefined&&(_0x4bc749['webhookUrl']=_0x57cd5d[_0x5bfc14(0x80)]||null),_0x57cd5d[_0x5bfc14(0x87)]!==undefined&&(_0x4bc749[_0x5bfc14(0x87)]=_0x57cd5d[_0x5bfc14(0x87)]||[]),await database_1[_0x5bfc14(0x82)]['shopSettings'][_0x5bfc14(0x97)]({'where':{'shopId':_0x5a6938},'data':_0x4bc749});}async[a66_0x1efa0f(0x8c)](_0x3b52c1){const _0x5b9c2b=a66_0x1efa0f,_0x4021a5=await database_1['default']['shopSettings'][_0x5b9c2b(0x93)]({'where':{'shopId':_0x3b52c1}});!_0x4021a5&&await database_1[_0x5b9c2b(0x82)][_0x5b9c2b(0x91)][_0x5b9c2b(0x7f)]({'data':{'shopId':_0x3b52c1}});}}exports[a66_0x1efa0f(0x88)]=IntegrationsService;