'use strict';const a78_0x39a129=a78_0xd7d5;(function(_0x43f753,_0x57043d){const _0x53e85e=a78_0xd7d5,_0x58d247=_0x43f753();while(!![]){try{const _0x1c76ff=-parseInt(_0x53e85e(0xfa))/0x1+-parseInt(_0x53e85e(0xfb))/0x2+parseInt(_0x53e85e(0x100))/0x3+parseInt(_0x53e85e(0x10a))/0x4*(parseInt(_0x53e85e(0x10c))/0x5)+-parseInt(_0x53e85e(0x10b))/0x6*(parseInt(_0x53e85e(0x111))/0x7)+-parseInt(_0x53e85e(0x101))/0x8+parseInt(_0x53e85e(0x102))/0x9;if(_0x1c76ff===_0x57043d)break;else _0x58d247['push'](_0x58d247['shift']());}catch(_0x48405c){_0x58d247['push'](_0x58d247['shift']());}}}(a78_0x1aa2,0x29537));var __importDefault=this&&this[a78_0x39a129(0xfc)]||function(_0x3a323f){const _0x54aacc=a78_0x39a129;return _0x3a323f&&_0x3a323f[_0x54aacc(0x105)]?_0x3a323f:{'default':_0x3a323f};};function a78_0x1aa2(){const _0x39bc45=['findUnique','webhookUrl','shopSettings','Shop\x20settings\x20not\x20found','48WKRiLe','22962uUXbMD','68240EsSgMt','parseWebhookEvents','../config/database','ensureSettingsExist','create','287sQqmgk','string','54409CfEHOH','476254YjWNjf','__importDefault','webhookEvents','parse','updateWebhookSettings','705216JsTBdz','868160TMmJqQ','2955474rVTKBv','IntegrationsService','default','__esModule'];a78_0x1aa2=function(){return _0x39bc45;};return a78_0x1aa2();}Object['defineProperty'](exports,'__esModule',{'value':!![]}),exports['IntegrationsService']=void 0x0;const database_1=__importDefault(require(a78_0x39a129(0x10e)));class IntegrationsService{[a78_0x39a129(0x10d)](_0x4ae530){const _0x45ffef=a78_0x39a129;if(!_0x4ae530)return[];if(Array['isArray'](_0x4ae530))return _0x4ae530;if(typeof _0x4ae530===_0x45ffef(0xf9))try{const _0x224c87=JSON[_0x45ffef(0xfe)](_0x4ae530);return Array['isArray'](_0x224c87)?_0x224c87:[];}catch{return[];}return[];}async['getIntegrations'](_0x14ff65){const _0x1f3637=a78_0x39a129;await this[_0x1f3637(0x10f)](_0x14ff65);const _0x25ac1a=await database_1[_0x1f3637(0x104)][_0x1f3637(0x108)][_0x1f3637(0x106)]({'where':{'shopId':_0x14ff65},'select':{'webhookUrl':!![],'webhookEvents':!![]}});if(!_0x25ac1a)throw new Error(_0x1f3637(0x109));return{'webhook':{'url':_0x25ac1a[_0x1f3637(0x107)],'events':this[_0x1f3637(0x10d)](_0x25ac1a[_0x1f3637(0xfd)])}};}async[a78_0x39a129(0xff)](_0xcfd435,_0x15aa0e){const _0x30caa9=a78_0x39a129;await this[_0x30caa9(0x10f)](_0xcfd435);const _0x339c39={};_0x15aa0e['webhookUrl']!==undefined&&(_0x339c39[_0x30caa9(0x107)]=_0x15aa0e[_0x30caa9(0x107)]||null),_0x15aa0e[_0x30caa9(0xfd)]!==undefined&&(_0x339c39['webhookEvents']=_0x15aa0e['webhookEvents']||[]),await database_1[_0x30caa9(0x104)][_0x30caa9(0x108)]['update']({'where':{'shopId':_0xcfd435},'data':_0x339c39});}async['ensureSettingsExist'](_0xd4e076){const _0x157a3a=a78_0x39a129,_0x1d9f02=await database_1[_0x157a3a(0x104)][_0x157a3a(0x108)][_0x157a3a(0x106)]({'where':{'shopId':_0xd4e076}});!_0x1d9f02&&await database_1[_0x157a3a(0x104)][_0x157a3a(0x108)][_0x157a3a(0x110)]({'data':{'shopId':_0xd4e076}});}}function a78_0xd7d5(_0x48c642,_0x1301e9){_0x48c642=_0x48c642-0xf9;const _0x1aa299=a78_0x1aa2();let _0xd7d5b6=_0x1aa299[_0x48c642];return _0xd7d5b6;}exports[a78_0x39a129(0x103)]=IntegrationsService;