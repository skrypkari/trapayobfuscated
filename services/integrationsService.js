'use strict';function a47_0x3035(_0x55ffd3,_0x527365){const _0x571f40=a47_0x571f();return a47_0x3035=function(_0x303508,_0x1f4054){_0x303508=_0x303508-0xcf;let _0x4fdbdc=_0x571f40[_0x303508];return _0x4fdbdc;},a47_0x3035(_0x55ffd3,_0x527365);}const a47_0x251286=a47_0x3035;(function(_0x205d0e,_0x37302d){const _0x19077a=a47_0x3035,_0x49f578=_0x205d0e();while(!![]){try{const _0x4e4695=parseInt(_0x19077a(0xd7))/0x1+-parseInt(_0x19077a(0xd9))/0x2+-parseInt(_0x19077a(0xd1))/0x3+-parseInt(_0x19077a(0xdb))/0x4+parseInt(_0x19077a(0xdf))/0x5*(-parseInt(_0x19077a(0xd2))/0x6)+-parseInt(_0x19077a(0xe2))/0x7*(parseInt(_0x19077a(0xd8))/0x8)+parseInt(_0x19077a(0xd6))/0x9*(parseInt(_0x19077a(0xe4))/0xa);if(_0x4e4695===_0x37302d)break;else _0x49f578['push'](_0x49f578['shift']());}catch(_0x2e89e2){_0x49f578['push'](_0x49f578['shift']());}}}(a47_0x571f,0xd5edc));var __importDefault=this&&this['__importDefault']||function(_0x5b795b){const _0x594da7=a47_0x3035;return _0x5b795b&&_0x5b795b[_0x594da7(0xd4)]?_0x5b795b:{'default':_0x5b795b};};Object[a47_0x251286(0xdd)](exports,a47_0x251286(0xd4),{'value':!![]}),exports['IntegrationsService']=void 0x0;const database_1=__importDefault(require(a47_0x251286(0xda)));function a47_0x571f(){const _0x4cbd2a=['shopSettings','default','webhookUrl','4592841vooxwf','2317188JoUVAk','parse','__esModule','update','9MbGAzN','1297163JQMCKs','16iavaZA','3134458ToIqqe','../config/database','3388124cTnxps','Shop\x20settings\x20not\x20found','defineProperty','create','10RyQfsk','isArray','webhookEvents','1587929gzMzME','parseWebhookEvents','47503860qjKUPU','updateWebhookSettings','ensureSettingsExist','findUnique','getIntegrations'];a47_0x571f=function(){return _0x4cbd2a;};return a47_0x571f();}class IntegrationsService{[a47_0x251286(0xe3)](_0x58b560){const _0x1ff0e9=a47_0x251286;if(!_0x58b560)return[];if(Array['isArray'](_0x58b560))return _0x58b560;if(typeof _0x58b560==='string')try{const _0x1f5af0=JSON[_0x1ff0e9(0xd3)](_0x58b560);return Array[_0x1ff0e9(0xe0)](_0x1f5af0)?_0x1f5af0:[];}catch{return[];}return[];}async[a47_0x251286(0xe8)](_0x13525b){const _0x1176c1=a47_0x251286;await this['ensureSettingsExist'](_0x13525b);const _0x139e89=await database_1[_0x1176c1(0xcf)]['shopSettings']['findUnique']({'where':{'shopId':_0x13525b},'select':{'webhookUrl':!![],'webhookEvents':!![]}});if(!_0x139e89)throw new Error(_0x1176c1(0xdc));return{'webhook':{'url':_0x139e89[_0x1176c1(0xd0)],'events':this['parseWebhookEvents'](_0x139e89[_0x1176c1(0xe1)])}};}async[a47_0x251286(0xe5)](_0x1d7ece,_0x47a5ad){const _0x4033a2=a47_0x251286;await this[_0x4033a2(0xe6)](_0x1d7ece);const _0x365a1b={};_0x47a5ad['webhookUrl']!==undefined&&(_0x365a1b[_0x4033a2(0xd0)]=_0x47a5ad[_0x4033a2(0xd0)]||null),_0x47a5ad[_0x4033a2(0xe1)]!==undefined&&(_0x365a1b['webhookEvents']=_0x47a5ad[_0x4033a2(0xe1)]||[]),await database_1[_0x4033a2(0xcf)]['shopSettings'][_0x4033a2(0xd5)]({'where':{'shopId':_0x1d7ece},'data':_0x365a1b});}async['ensureSettingsExist'](_0x3c6472){const _0x4f9c3d=a47_0x251286,_0x571096=await database_1[_0x4f9c3d(0xcf)]['shopSettings'][_0x4f9c3d(0xe7)]({'where':{'shopId':_0x3c6472}});!_0x571096&&await database_1[_0x4f9c3d(0xcf)][_0x4f9c3d(0xe9)][_0x4f9c3d(0xde)]({'data':{'shopId':_0x3c6472}});}}exports['IntegrationsService']=IntegrationsService;