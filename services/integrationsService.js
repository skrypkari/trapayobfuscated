'use strict';const a70_0x3b57c5=a70_0x44db;(function(_0x28146c,_0x5b6c25){const _0x47ca8c=a70_0x44db,_0x37832f=_0x28146c();while(!![]){try{const _0x229572=-parseInt(_0x47ca8c(0x105))/0x1*(-parseInt(_0x47ca8c(0x107))/0x2)+-parseInt(_0x47ca8c(0x108))/0x3+-parseInt(_0x47ca8c(0xff))/0x4*(parseInt(_0x47ca8c(0xf2))/0x5)+parseInt(_0x47ca8c(0xf7))/0x6+-parseInt(_0x47ca8c(0xf8))/0x7*(parseInt(_0x47ca8c(0xf3))/0x8)+-parseInt(_0x47ca8c(0x10a))/0x9*(-parseInt(_0x47ca8c(0xf9))/0xa)+-parseInt(_0x47ca8c(0xf4))/0xb*(-parseInt(_0x47ca8c(0x100))/0xc);if(_0x229572===_0x5b6c25)break;else _0x37832f['push'](_0x37832f['shift']());}catch(_0x4f5f4a){_0x37832f['push'](_0x37832f['shift']());}}}(a70_0x3669,0x7babf));function a70_0x3669(){const _0x107dac=['74459PcuUMl','default','webhookUrl','2393730IlCPbI','91dkyrwH','171750OWZTvw','__esModule','findUnique','__importDefault','getIntegrations','webhookEvents','308ymcnjF','936IXnmRj','../config/database','ensureSettingsExist','parseWebhookEvents','update','59PJHOGc','IntegrationsService','32726ArTePP','2700897siKcxi','isArray','297kyhBmU','Shop\x20settings\x20not\x20found','create','shopSettings','string','45245BkZRga','218768OrCPlY'];a70_0x3669=function(){return _0x107dac;};return a70_0x3669();}var __importDefault=this&&this[a70_0x3b57c5(0xfc)]||function(_0x20ffe5){const _0x374aa1=a70_0x3b57c5;return _0x20ffe5&&_0x20ffe5[_0x374aa1(0xfa)]?_0x20ffe5:{'default':_0x20ffe5};};Object['defineProperty'](exports,a70_0x3b57c5(0xfa),{'value':!![]}),exports[a70_0x3b57c5(0x106)]=void 0x0;const database_1=__importDefault(require(a70_0x3b57c5(0x101)));class IntegrationsService{[a70_0x3b57c5(0x103)](_0x2c917f){const _0x5c4a86=a70_0x3b57c5;if(!_0x2c917f)return[];if(Array['isArray'](_0x2c917f))return _0x2c917f;if(typeof _0x2c917f===_0x5c4a86(0xf1))try{const _0x2761ce=JSON['parse'](_0x2c917f);return Array[_0x5c4a86(0x109)](_0x2761ce)?_0x2761ce:[];}catch{return[];}return[];}async[a70_0x3b57c5(0xfd)](_0x772d68){const _0x7e1182=a70_0x3b57c5;await this['ensureSettingsExist'](_0x772d68);const _0x31bb43=await database_1[_0x7e1182(0xf5)]['shopSettings']['findUnique']({'where':{'shopId':_0x772d68},'select':{'webhookUrl':!![],'webhookEvents':!![]}});if(!_0x31bb43)throw new Error(_0x7e1182(0xee));return{'webhook':{'url':_0x31bb43[_0x7e1182(0xf6)],'events':this[_0x7e1182(0x103)](_0x31bb43[_0x7e1182(0xfe)])}};}async['updateWebhookSettings'](_0x38a8b9,_0x1920dc){const _0x20462c=a70_0x3b57c5;await this[_0x20462c(0x102)](_0x38a8b9);const _0x567581={};_0x1920dc[_0x20462c(0xf6)]!==undefined&&(_0x567581[_0x20462c(0xf6)]=_0x1920dc['webhookUrl']||null),_0x1920dc[_0x20462c(0xfe)]!==undefined&&(_0x567581[_0x20462c(0xfe)]=_0x1920dc['webhookEvents']||[]),await database_1['default']['shopSettings'][_0x20462c(0x104)]({'where':{'shopId':_0x38a8b9},'data':_0x567581});}async[a70_0x3b57c5(0x102)](_0x542ac3){const _0x5704ef=a70_0x3b57c5,_0x369bed=await database_1[_0x5704ef(0xf5)][_0x5704ef(0xf0)][_0x5704ef(0xfb)]({'where':{'shopId':_0x542ac3}});!_0x369bed&&await database_1[_0x5704ef(0xf5)][_0x5704ef(0xf0)][_0x5704ef(0xef)]({'data':{'shopId':_0x542ac3}});}}function a70_0x44db(_0x54f7cd,_0x44ff03){_0x54f7cd=_0x54f7cd-0xee;const _0x366938=a70_0x3669();let _0x44db7c=_0x366938[_0x54f7cd];return _0x44db7c;}exports['IntegrationsService']=IntegrationsService;