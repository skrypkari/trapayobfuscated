'use strict';const a50_0x421859=a50_0x4308;function a50_0x3d92(){const _0x49bdb1=['webhookEvents','109020XcqdIb','__importDefault','Shop\x20settings\x20not\x20found','updateWebhookSettings','default','431213PPsmqZ','9303472djWZrS','320173GYMFfP','ensureSettingsExist','update','3035136jBzVUv','36PkkAcK','parseWebhookEvents','findUnique','create','IntegrationsService','15607521mevaIV','../config/database','2ijOoJG','getIntegrations','parse','shopSettings','10lmFTWM','defineProperty','webhookUrl','2901213DhGCjC','__esModule','isArray'];a50_0x3d92=function(){return _0x49bdb1;};return a50_0x3d92();}(function(_0x1301f7,_0x5339f9){const _0x15ebd4=a50_0x4308,_0x18e957=_0x1301f7();while(!![]){try{const _0x2dff65=parseInt(_0x15ebd4(0x1d7))/0x1+parseInt(_0x15ebd4(0x1e4))/0x2*(-parseInt(_0x15ebd4(0x1eb))/0x3)+parseInt(_0x15ebd4(0x1dc))/0x4+-parseInt(_0x15ebd4(0x1ef))/0x5*(-parseInt(_0x15ebd4(0x1dd))/0x6)+-parseInt(_0x15ebd4(0x1d9))/0x7+-parseInt(_0x15ebd4(0x1d8))/0x8+parseInt(_0x15ebd4(0x1e2))/0x9*(parseInt(_0x15ebd4(0x1e8))/0xa);if(_0x2dff65===_0x5339f9)break;else _0x18e957['push'](_0x18e957['shift']());}catch(_0x29148f){_0x18e957['push'](_0x18e957['shift']());}}}(a50_0x3d92,0xd6a8e));var __importDefault=this&&this[a50_0x421859(0x1f0)]||function(_0x5013f3){const _0x1ba431=a50_0x421859;return _0x5013f3&&_0x5013f3[_0x1ba431(0x1ec)]?_0x5013f3:{'default':_0x5013f3};};Object[a50_0x421859(0x1e9)](exports,a50_0x421859(0x1ec),{'value':!![]}),exports[a50_0x421859(0x1e1)]=void 0x0;const database_1=__importDefault(require(a50_0x421859(0x1e3)));class IntegrationsService{[a50_0x421859(0x1de)](_0x51b31f){const _0x3667d3=a50_0x421859;if(!_0x51b31f)return[];if(Array[_0x3667d3(0x1ed)](_0x51b31f))return _0x51b31f;if(typeof _0x51b31f==='string')try{const _0xa4b009=JSON[_0x3667d3(0x1e6)](_0x51b31f);return Array['isArray'](_0xa4b009)?_0xa4b009:[];}catch{return[];}return[];}async[a50_0x421859(0x1e5)](_0x3ece1c){const _0x1b1707=a50_0x421859;await this[_0x1b1707(0x1da)](_0x3ece1c);const _0x18cb4d=await database_1[_0x1b1707(0x1f3)][_0x1b1707(0x1e7)][_0x1b1707(0x1df)]({'where':{'shopId':_0x3ece1c},'select':{'webhookUrl':!![],'webhookEvents':!![]}});if(!_0x18cb4d)throw new Error(_0x1b1707(0x1f1));return{'webhook':{'url':_0x18cb4d[_0x1b1707(0x1ea)],'events':this[_0x1b1707(0x1de)](_0x18cb4d[_0x1b1707(0x1ee)])}};}async[a50_0x421859(0x1f2)](_0x3229e2,_0x209ab7){const _0x2a6107=a50_0x421859;await this[_0x2a6107(0x1da)](_0x3229e2);const _0x1d54c2={};_0x209ab7[_0x2a6107(0x1ea)]!==undefined&&(_0x1d54c2['webhookUrl']=_0x209ab7[_0x2a6107(0x1ea)]||null),_0x209ab7[_0x2a6107(0x1ee)]!==undefined&&(_0x1d54c2['webhookEvents']=_0x209ab7[_0x2a6107(0x1ee)]||[]),await database_1[_0x2a6107(0x1f3)][_0x2a6107(0x1e7)][_0x2a6107(0x1db)]({'where':{'shopId':_0x3229e2},'data':_0x1d54c2});}async[a50_0x421859(0x1da)](_0x50afc8){const _0x183a19=a50_0x421859,_0xe67874=await database_1[_0x183a19(0x1f3)][_0x183a19(0x1e7)][_0x183a19(0x1df)]({'where':{'shopId':_0x50afc8}});!_0xe67874&&await database_1['default'][_0x183a19(0x1e7)][_0x183a19(0x1e0)]({'data':{'shopId':_0x50afc8}});}}function a50_0x4308(_0x559eb3,_0x359f80){const _0x3d926=a50_0x3d92();return a50_0x4308=function(_0x4308a3,_0x4d7019){_0x4308a3=_0x4308a3-0x1d7;let _0x257fb8=_0x3d926[_0x4308a3];return _0x257fb8;},a50_0x4308(_0x559eb3,_0x359f80);}exports[a50_0x421859(0x1e1)]=IntegrationsService;