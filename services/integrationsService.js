'use strict';const a52_0x4d0cc8=a52_0x32c2;(function(_0x34c076,_0x213064){const _0xafa96e=a52_0x32c2,_0x94e19d=_0x34c076();while(!![]){try{const _0x176125=parseInt(_0xafa96e(0xd8))/0x1+parseInt(_0xafa96e(0xc9))/0x2*(-parseInt(_0xafa96e(0xd7))/0x3)+-parseInt(_0xafa96e(0xd3))/0x4+parseInt(_0xafa96e(0xdb))/0x5+-parseInt(_0xafa96e(0xdd))/0x6+parseInt(_0xafa96e(0xd9))/0x7*(-parseInt(_0xafa96e(0xd4))/0x8)+parseInt(_0xafa96e(0xd6))/0x9;if(_0x176125===_0x213064)break;else _0x94e19d['push'](_0x94e19d['shift']());}catch(_0x29c821){_0x94e19d['push'](_0x94e19d['shift']());}}}(a52_0x3ca0,0x3e075));function a52_0x3ca0(){const _0x4cd77d=['__esModule','isArray','ensureSettingsExist','59908BPPSUX','parseWebhookEvents','parse','../config/database','getIntegrations','webhookEvents','shopSettings','updateWebhookSettings','findUnique','defineProperty','1671132FHptlI','16OlHBHL','IntegrationsService','7856766VqVDuY','24pnXaXw','302840UkvTgY','3178jsnalR','__importDefault','758580TKGDdl','webhookUrl','2490828DbluNi','default'];a52_0x3ca0=function(){return _0x4cd77d;};return a52_0x3ca0();}var __importDefault=this&&this[a52_0x4d0cc8(0xda)]||function(_0x353061){const _0x1ea51b=a52_0x4d0cc8;return _0x353061&&_0x353061[_0x1ea51b(0xdf)]?_0x353061:{'default':_0x353061};};function a52_0x32c2(_0x3699a7,_0x56cd4a){const _0x3ca0c6=a52_0x3ca0();return a52_0x32c2=function(_0x32c230,_0x97965){_0x32c230=_0x32c230-0xc9;let _0x5edfd5=_0x3ca0c6[_0x32c230];return _0x5edfd5;},a52_0x32c2(_0x3699a7,_0x56cd4a);}Object[a52_0x4d0cc8(0xd2)](exports,a52_0x4d0cc8(0xdf),{'value':!![]}),exports[a52_0x4d0cc8(0xd5)]=void 0x0;const database_1=__importDefault(require(a52_0x4d0cc8(0xcc)));class IntegrationsService{[a52_0x4d0cc8(0xca)](_0x38d9f0){const _0x2b49d1=a52_0x4d0cc8;if(!_0x38d9f0)return[];if(Array[_0x2b49d1(0xe0)](_0x38d9f0))return _0x38d9f0;if(typeof _0x38d9f0==='string')try{const _0x574160=JSON[_0x2b49d1(0xcb)](_0x38d9f0);return Array[_0x2b49d1(0xe0)](_0x574160)?_0x574160:[];}catch{return[];}return[];}async[a52_0x4d0cc8(0xcd)](_0x299782){const _0x4496c2=a52_0x4d0cc8;await this['ensureSettingsExist'](_0x299782);const _0x5215c0=await database_1[_0x4496c2(0xde)][_0x4496c2(0xcf)][_0x4496c2(0xd1)]({'where':{'shopId':_0x299782},'select':{'webhookUrl':!![],'webhookEvents':!![]}});if(!_0x5215c0)throw new Error('Shop\x20settings\x20not\x20found');return{'webhook':{'url':_0x5215c0[_0x4496c2(0xdc)],'events':this[_0x4496c2(0xca)](_0x5215c0[_0x4496c2(0xce)])}};}async[a52_0x4d0cc8(0xd0)](_0x438f48,_0x42f3a5){const _0x1a3619=a52_0x4d0cc8;await this[_0x1a3619(0xe1)](_0x438f48);const _0x1fe4a6={};_0x42f3a5[_0x1a3619(0xdc)]!==undefined&&(_0x1fe4a6['webhookUrl']=_0x42f3a5['webhookUrl']||null),_0x42f3a5[_0x1a3619(0xce)]!==undefined&&(_0x1fe4a6[_0x1a3619(0xce)]=_0x42f3a5[_0x1a3619(0xce)]||[]),await database_1[_0x1a3619(0xde)][_0x1a3619(0xcf)]['update']({'where':{'shopId':_0x438f48},'data':_0x1fe4a6});}async[a52_0x4d0cc8(0xe1)](_0x47f4a4){const _0x299db2=a52_0x4d0cc8,_0x3e7e2a=await database_1['default'][_0x299db2(0xcf)][_0x299db2(0xd1)]({'where':{'shopId':_0x47f4a4}});!_0x3e7e2a&&await database_1[_0x299db2(0xde)][_0x299db2(0xcf)]['create']({'data':{'shopId':_0x47f4a4}});}}exports[a52_0x4d0cc8(0xd5)]=IntegrationsService;