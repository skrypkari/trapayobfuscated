'use strict';const a54_0x5c2260=a54_0x48a1;(function(_0x2ca26e,_0x5cfe11){const _0x3513f2=a54_0x48a1,_0x57176d=_0x2ca26e();while(!![]){try{const _0x223f86=parseInt(_0x3513f2(0x18b))/0x1+parseInt(_0x3513f2(0x18a))/0x2*(parseInt(_0x3513f2(0x17e))/0x3)+parseInt(_0x3513f2(0x178))/0x4+-parseInt(_0x3513f2(0x176))/0x5+parseInt(_0x3513f2(0x182))/0x6+-parseInt(_0x3513f2(0x186))/0x7+parseInt(_0x3513f2(0x183))/0x8*(-parseInt(_0x3513f2(0x189))/0x9);if(_0x223f86===_0x5cfe11)break;else _0x57176d['push'](_0x57176d['shift']());}catch(_0x32645f){_0x57176d['push'](_0x57176d['shift']());}}}(a54_0x4710,0x2f170));var __importDefault=this&&this[a54_0x5c2260(0x188)]||function(_0x4db385){const _0x521dea=a54_0x5c2260;return _0x4db385&&_0x4db385[_0x521dea(0x184)]?_0x4db385:{'default':_0x4db385};};Object[a54_0x5c2260(0x18d)](exports,'__esModule',{'value':!![]}),exports['IntegrationsService']=void 0x0;function a54_0x4710(){const _0x38cdef=['887000WUahOF','isArray','1108080dMCZLH','webhookUrl','webhookEvents','shopSettings','findUnique','default','3ldeNxQ','ensureSettingsExist','create','parse','2106936fxaAsa','5906024iUSIxi','__esModule','Shop\x20settings\x20not\x20found','1161069tjFCCF','update','__importDefault','9SMMbrz','685632ptSRxo','303408HNTQLb','getIntegrations','defineProperty','parseWebhookEvents','string'];a54_0x4710=function(){return _0x38cdef;};return a54_0x4710();}const database_1=__importDefault(require('../config/database'));function a54_0x48a1(_0xc8fb48,_0x8acadd){const _0x471089=a54_0x4710();return a54_0x48a1=function(_0x48a190,_0x30686e){_0x48a190=_0x48a190-0x175;let _0x1ab3e8=_0x471089[_0x48a190];return _0x1ab3e8;},a54_0x48a1(_0xc8fb48,_0x8acadd);}class IntegrationsService{[a54_0x5c2260(0x18e)](_0x23101c){const _0x52884a=a54_0x5c2260;if(!_0x23101c)return[];if(Array['isArray'](_0x23101c))return _0x23101c;if(typeof _0x23101c===_0x52884a(0x175))try{const _0x213f18=JSON[_0x52884a(0x181)](_0x23101c);return Array[_0x52884a(0x177)](_0x213f18)?_0x213f18:[];}catch{return[];}return[];}async[a54_0x5c2260(0x18c)](_0x3f0e6b){const _0x50aab4=a54_0x5c2260;await this[_0x50aab4(0x17f)](_0x3f0e6b);const _0x377d8f=await database_1[_0x50aab4(0x17d)][_0x50aab4(0x17b)][_0x50aab4(0x17c)]({'where':{'shopId':_0x3f0e6b},'select':{'webhookUrl':!![],'webhookEvents':!![]}});if(!_0x377d8f)throw new Error(_0x50aab4(0x185));return{'webhook':{'url':_0x377d8f['webhookUrl'],'events':this[_0x50aab4(0x18e)](_0x377d8f[_0x50aab4(0x17a)])}};}async['updateWebhookSettings'](_0x17e9ad,_0x2fdfad){const _0x4ffaaa=a54_0x5c2260;await this[_0x4ffaaa(0x17f)](_0x17e9ad);const _0x6cabde={};_0x2fdfad[_0x4ffaaa(0x179)]!==undefined&&(_0x6cabde[_0x4ffaaa(0x179)]=_0x2fdfad[_0x4ffaaa(0x179)]||null),_0x2fdfad['webhookEvents']!==undefined&&(_0x6cabde['webhookEvents']=_0x2fdfad[_0x4ffaaa(0x17a)]||[]),await database_1[_0x4ffaaa(0x17d)][_0x4ffaaa(0x17b)][_0x4ffaaa(0x187)]({'where':{'shopId':_0x17e9ad},'data':_0x6cabde});}async[a54_0x5c2260(0x17f)](_0x4f5f80){const _0x1dca1d=a54_0x5c2260,_0xe05b78=await database_1['default']['shopSettings']['findUnique']({'where':{'shopId':_0x4f5f80}});!_0xe05b78&&await database_1[_0x1dca1d(0x17d)][_0x1dca1d(0x17b)][_0x1dca1d(0x180)]({'data':{'shopId':_0x4f5f80}});}}exports['IntegrationsService']=IntegrationsService;