'use strict';const a42_0x595973=a42_0x2263;(function(_0x1cd744,_0x41e5f7){const _0x2f070d=a42_0x2263,_0x2a67d6=_0x1cd744();while(!![]){try{const _0x10b96f=-parseInt(_0x2f070d(0x160))/0x1+parseInt(_0x2f070d(0x161))/0x2+parseInt(_0x2f070d(0x175))/0x3*(-parseInt(_0x2f070d(0x162))/0x4)+-parseInt(_0x2f070d(0x170))/0x5*(parseInt(_0x2f070d(0x177))/0x6)+-parseInt(_0x2f070d(0x174))/0x7+parseInt(_0x2f070d(0x16a))/0x8+parseInt(_0x2f070d(0x16c))/0x9;if(_0x10b96f===_0x41e5f7)break;else _0x2a67d6['push'](_0x2a67d6['shift']());}catch(_0xa8ccd9){_0x2a67d6['push'](_0x2a67d6['shift']());}}}(a42_0x5558,0xb5fd3));function a42_0x2263(_0x9e07a9,_0x1f545c){const _0x555801=a42_0x5558();return a42_0x2263=function(_0x226344,_0x3f3b2e){_0x226344=_0x226344-0x15f;let _0x4271e1=_0x555801[_0x226344];return _0x4271e1;},a42_0x2263(_0x9e07a9,_0x1f545c);}var __importDefault=this&&this[a42_0x595973(0x176)]||function(_0x5cdebe){const _0x1e624b=a42_0x595973;return _0x5cdebe&&_0x5cdebe[_0x1e624b(0x164)]?_0x5cdebe:{'default':_0x5cdebe};};Object[a42_0x595973(0x171)](exports,a42_0x595973(0x164),{'value':!![]}),exports['IntegrationsService']=void 0x0;const database_1=__importDefault(require(a42_0x595973(0x167)));function a42_0x5558(){const _0x3300db=['shopSettings','5824791ppOqkv','9MWwWws','__importDefault','339666vjnYBk','webhookEvents','1212104BJzyMO','2587814PlBFim','1422004GPvhll','webhookUrl','__esModule','getIntegrations','default','../config/database','create','parseWebhookEvents','3509272UEqAzr','ensureSettingsExist','21659724VTLnvV','parse','isArray','update','25qIknBz','defineProperty','findUnique'];a42_0x5558=function(){return _0x3300db;};return a42_0x5558();}class IntegrationsService{[a42_0x595973(0x169)](_0x55325e){const _0x3a552c=a42_0x595973;if(!_0x55325e)return[];if(Array[_0x3a552c(0x16e)](_0x55325e))return _0x55325e;if(typeof _0x55325e==='string')try{const _0x3f8745=JSON[_0x3a552c(0x16d)](_0x55325e);return Array[_0x3a552c(0x16e)](_0x3f8745)?_0x3f8745:[];}catch{return[];}return[];}async[a42_0x595973(0x165)](_0x55b0e8){const _0x285ad7=a42_0x595973;await this[_0x285ad7(0x16b)](_0x55b0e8);const _0x4ab942=await database_1['default']['shopSettings'][_0x285ad7(0x172)]({'where':{'shopId':_0x55b0e8},'select':{'webhookUrl':!![],'webhookEvents':!![]}});if(!_0x4ab942)throw new Error('Shop\x20settings\x20not\x20found');return{'webhook':{'url':_0x4ab942[_0x285ad7(0x163)],'events':this[_0x285ad7(0x169)](_0x4ab942[_0x285ad7(0x15f)])}};}async['updateWebhookSettings'](_0x430e0c,_0x4d61d2){const _0x272876=a42_0x595973;await this['ensureSettingsExist'](_0x430e0c);const _0x8c8f71={};_0x4d61d2[_0x272876(0x163)]!==undefined&&(_0x8c8f71[_0x272876(0x163)]=_0x4d61d2[_0x272876(0x163)]||null),_0x4d61d2['webhookEvents']!==undefined&&(_0x8c8f71[_0x272876(0x15f)]=_0x4d61d2[_0x272876(0x15f)]||[]),await database_1['default'][_0x272876(0x173)][_0x272876(0x16f)]({'where':{'shopId':_0x430e0c},'data':_0x8c8f71});}async[a42_0x595973(0x16b)](_0x372e13){const _0x44ffaf=a42_0x595973,_0x52d682=await database_1[_0x44ffaf(0x166)][_0x44ffaf(0x173)][_0x44ffaf(0x172)]({'where':{'shopId':_0x372e13}});!_0x52d682&&await database_1[_0x44ffaf(0x166)][_0x44ffaf(0x173)][_0x44ffaf(0x168)]({'data':{'shopId':_0x372e13}});}}exports['IntegrationsService']=IntegrationsService;