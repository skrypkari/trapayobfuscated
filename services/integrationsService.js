'use strict';const a52_0x2a4807=a52_0x58a1;function a52_0x58a1(_0x1b0c6b,_0x37eb81){const _0x515a8f=a52_0x515a();return a52_0x58a1=function(_0x58a137,_0x21ba48){_0x58a137=_0x58a137-0x1b5;let _0x1e79e5=_0x515a8f[_0x58a137];return _0x1e79e5;},a52_0x58a1(_0x1b0c6b,_0x37eb81);}(function(_0x20a287,_0x577cc4){const _0x3fab3f=a52_0x58a1,_0x5349a9=_0x20a287();while(!![]){try{const _0x14301e=parseInt(_0x3fab3f(0x1be))/0x1+parseInt(_0x3fab3f(0x1b8))/0x2+-parseInt(_0x3fab3f(0x1ba))/0x3+-parseInt(_0x3fab3f(0x1bc))/0x4+parseInt(_0x3fab3f(0x1bb))/0x5+parseInt(_0x3fab3f(0x1cc))/0x6+-parseInt(_0x3fab3f(0x1c7))/0x7*(-parseInt(_0x3fab3f(0x1c1))/0x8);if(_0x14301e===_0x577cc4)break;else _0x5349a9['push'](_0x5349a9['shift']());}catch(_0x15e3ac){_0x5349a9['push'](_0x5349a9['shift']());}}}(a52_0x515a,0x1bc95));var __importDefault=this&&this[a52_0x2a4807(0x1b6)]||function(_0x4bbbad){return _0x4bbbad&&_0x4bbbad['__esModule']?_0x4bbbad:{'default':_0x4bbbad};};function a52_0x515a(){const _0x506626=['../config/database','23418Mgnqda','update','parseWebhookEvents','Shop\x20settings\x20not\x20found','__importDefault','updateWebhookSettings','454956Ygexjs','default','635502GXHulV','620475cCyeEg','646520onhzMb','__esModule','50977GAxnoA','webhookUrl','webhookEvents','32sCHMPn','shopSettings','IntegrationsService','create','ensureSettingsExist','isArray','141442QJKcdm','defineProperty','findUnique','getIntegrations'];a52_0x515a=function(){return _0x506626;};return a52_0x515a();}Object[a52_0x2a4807(0x1c8)](exports,a52_0x2a4807(0x1bd),{'value':!![]}),exports['IntegrationsService']=void 0x0;const database_1=__importDefault(require(a52_0x2a4807(0x1cb)));class IntegrationsService{[a52_0x2a4807(0x1ce)](_0x18db53){const _0x533251=a52_0x2a4807;if(!_0x18db53)return[];if(Array[_0x533251(0x1c6)](_0x18db53))return _0x18db53;if(typeof _0x18db53==='string')try{const _0x3dccb4=JSON['parse'](_0x18db53);return Array[_0x533251(0x1c6)](_0x3dccb4)?_0x3dccb4:[];}catch{return[];}return[];}async[a52_0x2a4807(0x1ca)](_0x139e8b){const _0x3ccd13=a52_0x2a4807;await this[_0x3ccd13(0x1c5)](_0x139e8b);const _0x4883f6=await database_1[_0x3ccd13(0x1b9)][_0x3ccd13(0x1c2)][_0x3ccd13(0x1c9)]({'where':{'shopId':_0x139e8b},'select':{'webhookUrl':!![],'webhookEvents':!![]}});if(!_0x4883f6)throw new Error(_0x3ccd13(0x1b5));return{'webhook':{'url':_0x4883f6['webhookUrl'],'events':this[_0x3ccd13(0x1ce)](_0x4883f6[_0x3ccd13(0x1c0)])}};}async[a52_0x2a4807(0x1b7)](_0x34b8b2,_0x171853){const _0x3fa2b2=a52_0x2a4807;await this['ensureSettingsExist'](_0x34b8b2);const _0x58f6ed={};_0x171853[_0x3fa2b2(0x1bf)]!==undefined&&(_0x58f6ed[_0x3fa2b2(0x1bf)]=_0x171853['webhookUrl']||null),_0x171853[_0x3fa2b2(0x1c0)]!==undefined&&(_0x58f6ed['webhookEvents']=_0x171853[_0x3fa2b2(0x1c0)]||[]),await database_1[_0x3fa2b2(0x1b9)][_0x3fa2b2(0x1c2)][_0x3fa2b2(0x1cd)]({'where':{'shopId':_0x34b8b2},'data':_0x58f6ed});}async['ensureSettingsExist'](_0x1dcccc){const _0x767af3=a52_0x2a4807,_0x225b4a=await database_1[_0x767af3(0x1b9)]['shopSettings'][_0x767af3(0x1c9)]({'where':{'shopId':_0x1dcccc}});!_0x225b4a&&await database_1[_0x767af3(0x1b9)][_0x767af3(0x1c2)][_0x767af3(0x1c4)]({'data':{'shopId':_0x1dcccc}});}}exports[a52_0x2a4807(0x1c3)]=IntegrationsService;