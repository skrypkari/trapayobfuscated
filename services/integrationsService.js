'use strict';const a46_0x192e1d=a46_0x2e3a;(function(_0x57af23,_0x1581f8){const _0x39b533=a46_0x2e3a,_0x71dfb5=_0x57af23();while(!![]){try{const _0x4c1acc=-parseInt(_0x39b533(0x1a3))/0x1+parseInt(_0x39b533(0x18e))/0x2+parseInt(_0x39b533(0x199))/0x3*(-parseInt(_0x39b533(0x18a))/0x4)+parseInt(_0x39b533(0x190))/0x5*(-parseInt(_0x39b533(0x194))/0x6)+parseInt(_0x39b533(0x198))/0x7+parseInt(_0x39b533(0x195))/0x8+parseInt(_0x39b533(0x193))/0x9;if(_0x4c1acc===_0x1581f8)break;else _0x71dfb5['push'](_0x71dfb5['shift']());}catch(_0x1ffdf8){_0x71dfb5['push'](_0x71dfb5['shift']());}}}(a46_0x1345,0x1c6fb));function a46_0x2e3a(_0x76838f,_0x49ce02){const _0x1345b2=a46_0x1345();return a46_0x2e3a=function(_0x2e3a27,_0xba342c){_0x2e3a27=_0x2e3a27-0x18a;let _0x2fcd70=_0x1345b2[_0x2e3a27];return _0x2fcd70;},a46_0x2e3a(_0x76838f,_0x49ce02);}var __importDefault=this&&this[a46_0x192e1d(0x196)]||function(_0x427c2f){const _0x957787=a46_0x192e1d;return _0x427c2f&&_0x427c2f[_0x957787(0x197)]?_0x427c2f:{'default':_0x427c2f};};Object[a46_0x192e1d(0x1a2)](exports,'__esModule',{'value':!![]}),exports[a46_0x192e1d(0x19e)]=void 0x0;const database_1=__importDefault(require(a46_0x192e1d(0x18f)));function a46_0x1345(){const _0x287942=['default','webhookUrl','3409128jVJaKz','120228UrmGZj','126792FrPtnO','__importDefault','__esModule','218904ZzESRV','3387ZLwwOC','update','webhookEvents','isArray','getIntegrations','IntegrationsService','findUnique','create','string','defineProperty','56159JPzvGF','ensureSettingsExist','Shop\x20settings\x20not\x20found','696AJSmae','shopSettings','parse','parseWebhookEvents','46638lmFxdy','../config/database','20PVzxWS'];a46_0x1345=function(){return _0x287942;};return a46_0x1345();}class IntegrationsService{[a46_0x192e1d(0x18d)](_0x53d3a7){const _0x56de19=a46_0x192e1d;if(!_0x53d3a7)return[];if(Array[_0x56de19(0x19c)](_0x53d3a7))return _0x53d3a7;if(typeof _0x53d3a7===_0x56de19(0x1a1))try{const _0x209c28=JSON[_0x56de19(0x18c)](_0x53d3a7);return Array['isArray'](_0x209c28)?_0x209c28:[];}catch{return[];}return[];}async[a46_0x192e1d(0x19d)](_0x49b613){const _0x23d9ed=a46_0x192e1d;await this['ensureSettingsExist'](_0x49b613);const _0x5904d8=await database_1['default'][_0x23d9ed(0x18b)]['findUnique']({'where':{'shopId':_0x49b613},'select':{'webhookUrl':!![],'webhookEvents':!![]}});if(!_0x5904d8)throw new Error(_0x23d9ed(0x1a5));return{'webhook':{'url':_0x5904d8[_0x23d9ed(0x192)],'events':this[_0x23d9ed(0x18d)](_0x5904d8['webhookEvents'])}};}async['updateWebhookSettings'](_0x20c686,_0x180cf2){const _0xb1e25c=a46_0x192e1d;await this[_0xb1e25c(0x1a4)](_0x20c686);const _0x85dfe8={};_0x180cf2[_0xb1e25c(0x192)]!==undefined&&(_0x85dfe8[_0xb1e25c(0x192)]=_0x180cf2['webhookUrl']||null),_0x180cf2[_0xb1e25c(0x19b)]!==undefined&&(_0x85dfe8[_0xb1e25c(0x19b)]=_0x180cf2[_0xb1e25c(0x19b)]||[]),await database_1['default'][_0xb1e25c(0x18b)][_0xb1e25c(0x19a)]({'where':{'shopId':_0x20c686},'data':_0x85dfe8});}async['ensureSettingsExist'](_0x5f2f8f){const _0x109332=a46_0x192e1d,_0x432550=await database_1['default'][_0x109332(0x18b)][_0x109332(0x19f)]({'where':{'shopId':_0x5f2f8f}});!_0x432550&&await database_1[_0x109332(0x191)][_0x109332(0x18b)][_0x109332(0x1a0)]({'data':{'shopId':_0x5f2f8f}});}}exports[a46_0x192e1d(0x19e)]=IntegrationsService;