'use strict';const a47_0xb1b28c=a47_0x2ed6;(function(_0x689cbd,_0x1dbc90){const _0xfdab62=a47_0x2ed6,_0x286b8d=_0x689cbd();while(!![]){try{const _0x52d9a6=-parseInt(_0xfdab62(0xc1))/0x1*(parseInt(_0xfdab62(0xc9))/0x2)+-parseInt(_0xfdab62(0xc4))/0x3+-parseInt(_0xfdab62(0xc0))/0x4+parseInt(_0xfdab62(0xd5))/0x5+parseInt(_0xfdab62(0xd3))/0x6*(parseInt(_0xfdab62(0xd9))/0x7)+parseInt(_0xfdab62(0xca))/0x8*(parseInt(_0xfdab62(0xd0))/0x9)+parseInt(_0xfdab62(0xc3))/0xa*(parseInt(_0xfdab62(0xd4))/0xb);if(_0x52d9a6===_0x1dbc90)break;else _0x286b8d['push'](_0x286b8d['shift']());}catch(_0x106dc0){_0x286b8d['push'](_0x286b8d['shift']());}}}(a47_0x4005,0xef1ba));var __importDefault=this&&this[a47_0xb1b28c(0xd6)]||function(_0x1c4f7a){return _0x1c4f7a&&_0x1c4f7a['__esModule']?_0x1c4f7a:{'default':_0x1c4f7a};};function a47_0x4005(){const _0x2aceee=['88MjwVZo','webhookUrl','parseWebhookEvents','IntegrationsService','create','parse','1328823xudGhU','defineProperty','string','35886XHvTuP','66ReueYB','8439365bHZtwQ','__importDefault','shopSettings','__esModule','1022ccQQIf','webhookEvents','getIntegrations','isArray','update','6054492ruMrrt','68QigvlR','updateWebhookSettings','2106620ERtPcb','3929085nSEuks','ensureSettingsExist','../config/database','findUnique','default','48426racfFq'];a47_0x4005=function(){return _0x2aceee;};return a47_0x4005();}Object[a47_0xb1b28c(0xd1)](exports,a47_0xb1b28c(0xd8),{'value':!![]}),exports[a47_0xb1b28c(0xcd)]=void 0x0;const database_1=__importDefault(require(a47_0xb1b28c(0xc6)));class IntegrationsService{[a47_0xb1b28c(0xcc)](_0x1cc9ce){const _0x1f1e20=a47_0xb1b28c;if(!_0x1cc9ce)return[];if(Array['isArray'](_0x1cc9ce))return _0x1cc9ce;if(typeof _0x1cc9ce===_0x1f1e20(0xd2))try{const _0x144014=JSON[_0x1f1e20(0xcf)](_0x1cc9ce);return Array[_0x1f1e20(0xbe)](_0x144014)?_0x144014:[];}catch{return[];}return[];}async[a47_0xb1b28c(0xbd)](_0xa219af){const _0x4b18fa=a47_0xb1b28c;await this['ensureSettingsExist'](_0xa219af);const _0xd87ea0=await database_1[_0x4b18fa(0xc8)][_0x4b18fa(0xd7)]['findUnique']({'where':{'shopId':_0xa219af},'select':{'webhookUrl':!![],'webhookEvents':!![]}});if(!_0xd87ea0)throw new Error('Shop\x20settings\x20not\x20found');return{'webhook':{'url':_0xd87ea0[_0x4b18fa(0xcb)],'events':this[_0x4b18fa(0xcc)](_0xd87ea0['webhookEvents'])}};}async[a47_0xb1b28c(0xc2)](_0x49abf5,_0x142914){const _0x4fa76a=a47_0xb1b28c;await this[_0x4fa76a(0xc5)](_0x49abf5);const _0x115c67={};_0x142914[_0x4fa76a(0xcb)]!==undefined&&(_0x115c67[_0x4fa76a(0xcb)]=_0x142914[_0x4fa76a(0xcb)]||null),_0x142914['webhookEvents']!==undefined&&(_0x115c67[_0x4fa76a(0xda)]=_0x142914['webhookEvents']||[]),await database_1[_0x4fa76a(0xc8)][_0x4fa76a(0xd7)][_0x4fa76a(0xbf)]({'where':{'shopId':_0x49abf5},'data':_0x115c67});}async[a47_0xb1b28c(0xc5)](_0x30bcd5){const _0xf1b304=a47_0xb1b28c,_0x4405bb=await database_1['default'][_0xf1b304(0xd7)][_0xf1b304(0xc7)]({'where':{'shopId':_0x30bcd5}});!_0x4405bb&&await database_1[_0xf1b304(0xc8)][_0xf1b304(0xd7)][_0xf1b304(0xce)]({'data':{'shopId':_0x30bcd5}});}}function a47_0x2ed6(_0x15c4d5,_0x4a6545){const _0x400587=a47_0x4005();return a47_0x2ed6=function(_0x2ed6bb,_0x3c53b4){_0x2ed6bb=_0x2ed6bb-0xbd;let _0x60ed17=_0x400587[_0x2ed6bb];return _0x60ed17;},a47_0x2ed6(_0x15c4d5,_0x4a6545);}exports[a47_0xb1b28c(0xcd)]=IntegrationsService;