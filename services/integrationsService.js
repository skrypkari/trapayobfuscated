'use strict';const a50_0x249847=a50_0x4f13;(function(_0x419504,_0x12d589){const _0x593795=a50_0x4f13,_0xc0c74=_0x419504();while(!![]){try{const _0x4a543b=parseInt(_0x593795(0x1ac))/0x1+-parseInt(_0x593795(0x1ba))/0x2+-parseInt(_0x593795(0x1c3))/0x3+-parseInt(_0x593795(0x1ad))/0x4+parseInt(_0x593795(0x1b5))/0x5+parseInt(_0x593795(0x1bc))/0x6+parseInt(_0x593795(0x1c0))/0x7*(parseInt(_0x593795(0x1c2))/0x8);if(_0x4a543b===_0x12d589)break;else _0xc0c74['push'](_0xc0c74['shift']());}catch(_0x59fe9e){_0xc0c74['push'](_0xc0c74['shift']());}}}(a50_0x31e9,0xcf7b8));function a50_0x4f13(_0x45ecde,_0x501c24){const _0x31e98f=a50_0x31e9();return a50_0x4f13=function(_0x4f138a,_0x56ccf8){_0x4f138a=_0x4f138a-0x1ac;let _0x318d5c=_0x31e98f[_0x4f138a];return _0x318d5c;},a50_0x4f13(_0x45ecde,_0x501c24);}var __importDefault=this&&this[a50_0x249847(0x1b1)]||function(_0x39bf07){const _0x3ccc56=a50_0x249847;return _0x39bf07&&_0x39bf07[_0x3ccc56(0x1c4)]?_0x39bf07:{'default':_0x39bf07};};Object[a50_0x249847(0x1af)](exports,a50_0x249847(0x1c4),{'value':!![]}),exports[a50_0x249847(0x1b8)]=void 0x0;const database_1=__importDefault(require(a50_0x249847(0x1b6)));function a50_0x31e9(){const _0x1b9d0c=['ensureSettingsExist','isArray','359950aFNymZ','2380936fALxTA','findUnique','defineProperty','update','__importDefault','default','getIntegrations','parseWebhookEvents','6420885XUrckf','../config/database','string','IntegrationsService','webhookUrl','2954844TRlgNc','updateWebhookSettings','1700850jlGgWv','webhookEvents','Shop\x20settings\x20not\x20found','create','903elLSQf','shopSettings','61744yDRDaZ','2160eANAaA','__esModule'];a50_0x31e9=function(){return _0x1b9d0c;};return a50_0x31e9();}class IntegrationsService{[a50_0x249847(0x1b4)](_0x891500){const _0x264b40=a50_0x249847;if(!_0x891500)return[];if(Array['isArray'](_0x891500))return _0x891500;if(typeof _0x891500===_0x264b40(0x1b7))try{const _0x5d4077=JSON['parse'](_0x891500);return Array[_0x264b40(0x1c6)](_0x5d4077)?_0x5d4077:[];}catch{return[];}return[];}async[a50_0x249847(0x1b3)](_0x20e455){const _0x176a3b=a50_0x249847;await this[_0x176a3b(0x1c5)](_0x20e455);const _0x1ae26d=await database_1[_0x176a3b(0x1b2)][_0x176a3b(0x1c1)][_0x176a3b(0x1ae)]({'where':{'shopId':_0x20e455},'select':{'webhookUrl':!![],'webhookEvents':!![]}});if(!_0x1ae26d)throw new Error(_0x176a3b(0x1be));return{'webhook':{'url':_0x1ae26d[_0x176a3b(0x1b9)],'events':this[_0x176a3b(0x1b4)](_0x1ae26d[_0x176a3b(0x1bd)])}};}async[a50_0x249847(0x1bb)](_0x46a457,_0x502b00){const _0x22155d=a50_0x249847;await this['ensureSettingsExist'](_0x46a457);const _0x3ee3a7={};_0x502b00[_0x22155d(0x1b9)]!==undefined&&(_0x3ee3a7['webhookUrl']=_0x502b00[_0x22155d(0x1b9)]||null),_0x502b00[_0x22155d(0x1bd)]!==undefined&&(_0x3ee3a7[_0x22155d(0x1bd)]=_0x502b00[_0x22155d(0x1bd)]||[]),await database_1[_0x22155d(0x1b2)][_0x22155d(0x1c1)][_0x22155d(0x1b0)]({'where':{'shopId':_0x46a457},'data':_0x3ee3a7});}async['ensureSettingsExist'](_0x46486f){const _0x2ff7d5=a50_0x249847,_0x998174=await database_1['default'][_0x2ff7d5(0x1c1)][_0x2ff7d5(0x1ae)]({'where':{'shopId':_0x46486f}});!_0x998174&&await database_1[_0x2ff7d5(0x1b2)][_0x2ff7d5(0x1c1)][_0x2ff7d5(0x1bf)]({'data':{'shopId':_0x46486f}});}}exports['IntegrationsService']=IntegrationsService;