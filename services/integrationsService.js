'use strict';const a50_0x192b86=a50_0x1b79;(function(_0x4ba777,_0x3d6d86){const _0x447cfc=a50_0x1b79,_0x4403dc=_0x4ba777();while(!![]){try{const _0x5230f6=parseInt(_0x447cfc(0x1eb))/0x1+-parseInt(_0x447cfc(0x1fc))/0x2*(parseInt(_0x447cfc(0x1ed))/0x3)+-parseInt(_0x447cfc(0x1e9))/0x4+parseInt(_0x447cfc(0x1fd))/0x5+parseInt(_0x447cfc(0x1f5))/0x6*(-parseInt(_0x447cfc(0x1f0))/0x7)+parseInt(_0x447cfc(0x1ff))/0x8*(parseInt(_0x447cfc(0x1ef))/0x9)+parseInt(_0x447cfc(0x1e8))/0xa;if(_0x5230f6===_0x3d6d86)break;else _0x4403dc['push'](_0x4403dc['shift']());}catch(_0x2b8ae0){_0x4403dc['push'](_0x4403dc['shift']());}}}(a50_0x4549,0xd5fb9));var __importDefault=this&&this['__importDefault']||function(_0x433950){return _0x433950&&_0x433950['__esModule']?_0x433950:{'default':_0x433950};};function a50_0x1b79(_0x5733be,_0xe24f45){const _0x454939=a50_0x4549();return a50_0x1b79=function(_0x1b7938,_0x1d07ff){_0x1b7938=_0x1b7938-0x1e8;let _0x2ba0cf=_0x454939[_0x1b7938];return _0x2ba0cf;},a50_0x1b79(_0x5733be,_0xe24f45);}Object[a50_0x192b86(0x1f3)](exports,a50_0x192b86(0x1f2),{'value':!![]}),exports['IntegrationsService']=void 0x0;const database_1=__importDefault(require('../config/database'));function a50_0x4549(){const _0x1baad4=['7402150rhUPRe','68840vLrhmu','updateWebhookSettings','1362451tmznyz','webhookEvents','48hGMLNX','default','157725Nxgfex','7oKxDgP','isArray','__esModule','defineProperty','ensureSettingsExist','8328738RPQCxu','Shop\x20settings\x20not\x20found','parseWebhookEvents','webhookUrl','findUnique','getIntegrations','shopSettings','137084cCazLw','1296810wjXZbK','create','464ZXlZpG'];a50_0x4549=function(){return _0x1baad4;};return a50_0x4549();}class IntegrationsService{[a50_0x192b86(0x1f7)](_0x2a331c){const _0x422c84=a50_0x192b86;if(!_0x2a331c)return[];if(Array['isArray'](_0x2a331c))return _0x2a331c;if(typeof _0x2a331c==='string')try{const _0x534889=JSON['parse'](_0x2a331c);return Array[_0x422c84(0x1f1)](_0x534889)?_0x534889:[];}catch{return[];}return[];}async[a50_0x192b86(0x1fa)](_0x5151f8){const _0x103c8a=a50_0x192b86;await this[_0x103c8a(0x1f4)](_0x5151f8);const _0x4ba86e=await database_1['default'][_0x103c8a(0x1fb)][_0x103c8a(0x1f9)]({'where':{'shopId':_0x5151f8},'select':{'webhookUrl':!![],'webhookEvents':!![]}});if(!_0x4ba86e)throw new Error(_0x103c8a(0x1f6));return{'webhook':{'url':_0x4ba86e['webhookUrl'],'events':this[_0x103c8a(0x1f7)](_0x4ba86e[_0x103c8a(0x1ec)])}};}async[a50_0x192b86(0x1ea)](_0x337f96,_0xa388b2){const _0x4d5d01=a50_0x192b86;await this[_0x4d5d01(0x1f4)](_0x337f96);const _0x3564e0={};_0xa388b2[_0x4d5d01(0x1f8)]!==undefined&&(_0x3564e0['webhookUrl']=_0xa388b2[_0x4d5d01(0x1f8)]||null),_0xa388b2[_0x4d5d01(0x1ec)]!==undefined&&(_0x3564e0[_0x4d5d01(0x1ec)]=_0xa388b2[_0x4d5d01(0x1ec)]||[]),await database_1[_0x4d5d01(0x1ee)][_0x4d5d01(0x1fb)]['update']({'where':{'shopId':_0x337f96},'data':_0x3564e0});}async[a50_0x192b86(0x1f4)](_0x3da1a5){const _0x22b43c=a50_0x192b86,_0x15db63=await database_1[_0x22b43c(0x1ee)]['shopSettings'][_0x22b43c(0x1f9)]({'where':{'shopId':_0x3da1a5}});!_0x15db63&&await database_1[_0x22b43c(0x1ee)]['shopSettings'][_0x22b43c(0x1fe)]({'data':{'shopId':_0x3da1a5}});}}exports['IntegrationsService']=IntegrationsService;