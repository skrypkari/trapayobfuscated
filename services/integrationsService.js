'use strict';const a48_0x4a6f8d=a48_0x29fc;(function(_0x448e2c,_0x35a49e){const _0x2191a8=a48_0x29fc,_0x450b01=_0x448e2c();while(!![]){try{const _0x5a2402=-parseInt(_0x2191a8(0xe5))/0x1+parseInt(_0x2191a8(0xde))/0x2*(parseInt(_0x2191a8(0xd3))/0x3)+-parseInt(_0x2191a8(0xd2))/0x4*(-parseInt(_0x2191a8(0xe6))/0x5)+parseInt(_0x2191a8(0xed))/0x6*(-parseInt(_0x2191a8(0xd5))/0x7)+parseInt(_0x2191a8(0xd7))/0x8*(parseInt(_0x2191a8(0xe2))/0x9)+parseInt(_0x2191a8(0xdf))/0xa+-parseInt(_0x2191a8(0xd6))/0xb;if(_0x5a2402===_0x35a49e)break;else _0x450b01['push'](_0x450b01['shift']());}catch(_0x28fe30){_0x450b01['push'](_0x450b01['shift']());}}}(a48_0x3ab0,0x6525f));var __importDefault=this&&this[a48_0x4a6f8d(0xeb)]||function(_0x24ca82){const _0x1d4625=a48_0x4a6f8d;return _0x24ca82&&_0x24ca82[_0x1d4625(0xe1)]?_0x24ca82:{'default':_0x24ca82};};Object[a48_0x4a6f8d(0xe8)](exports,'__esModule',{'value':!![]}),exports[a48_0x4a6f8d(0xe9)]=void 0x0;function a48_0x3ab0(){const _0xe13d34=['getIntegrations','11370idwLKM','webhookUrl','52176wEcoaK','1310613RtcZNv','findUnique','231MeKIgJ','6630481tbmNnv','1328QCDbKF','ensureSettingsExist','Shop\x20settings\x20not\x20found','parseWebhookEvents','parse','string','update','2KrxRFF','6746230KvLQUf','webhookEvents','__esModule','3852wuFpEV','create','isArray','572517vJjAnM','180zKmwkB','shopSettings','defineProperty','IntegrationsService','default','__importDefault'];a48_0x3ab0=function(){return _0xe13d34;};return a48_0x3ab0();}const database_1=__importDefault(require('../config/database'));class IntegrationsService{[a48_0x4a6f8d(0xda)](_0x1f8939){const _0x5bbdee=a48_0x4a6f8d;if(!_0x1f8939)return[];if(Array[_0x5bbdee(0xe4)](_0x1f8939))return _0x1f8939;if(typeof _0x1f8939===_0x5bbdee(0xdc))try{const _0x551233=JSON[_0x5bbdee(0xdb)](_0x1f8939);return Array[_0x5bbdee(0xe4)](_0x551233)?_0x551233:[];}catch{return[];}return[];}async[a48_0x4a6f8d(0xec)](_0x3259e9){const _0x166d94=a48_0x4a6f8d;await this[_0x166d94(0xd8)](_0x3259e9);const _0x888d87=await database_1[_0x166d94(0xea)][_0x166d94(0xe7)][_0x166d94(0xd4)]({'where':{'shopId':_0x3259e9},'select':{'webhookUrl':!![],'webhookEvents':!![]}});if(!_0x888d87)throw new Error(_0x166d94(0xd9));return{'webhook':{'url':_0x888d87[_0x166d94(0xd1)],'events':this[_0x166d94(0xda)](_0x888d87[_0x166d94(0xe0)])}};}async['updateWebhookSettings'](_0x2b9823,_0x320142){const _0x40e1c0=a48_0x4a6f8d;await this[_0x40e1c0(0xd8)](_0x2b9823);const _0x581412={};_0x320142[_0x40e1c0(0xd1)]!==undefined&&(_0x581412[_0x40e1c0(0xd1)]=_0x320142[_0x40e1c0(0xd1)]||null),_0x320142[_0x40e1c0(0xe0)]!==undefined&&(_0x581412[_0x40e1c0(0xe0)]=_0x320142['webhookEvents']||[]),await database_1[_0x40e1c0(0xea)][_0x40e1c0(0xe7)][_0x40e1c0(0xdd)]({'where':{'shopId':_0x2b9823},'data':_0x581412});}async[a48_0x4a6f8d(0xd8)](_0xc84aef){const _0x146a63=a48_0x4a6f8d,_0x453b13=await database_1['default'][_0x146a63(0xe7)]['findUnique']({'where':{'shopId':_0xc84aef}});!_0x453b13&&await database_1[_0x146a63(0xea)]['shopSettings'][_0x146a63(0xe3)]({'data':{'shopId':_0xc84aef}});}}function a48_0x29fc(_0x5dc17f,_0x8893c4){const _0x3ab0ab=a48_0x3ab0();return a48_0x29fc=function(_0x29fcb3,_0x507e20){_0x29fcb3=_0x29fcb3-0xd1;let _0x1588da=_0x3ab0ab[_0x29fcb3];return _0x1588da;},a48_0x29fc(_0x5dc17f,_0x8893c4);}exports[a48_0x4a6f8d(0xe9)]=IntegrationsService;