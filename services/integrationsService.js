'use strict';const a47_0x532c6c=a47_0x4839;function a47_0x4839(_0x342d17,_0x139667){const _0x2fa3de=a47_0x2fa3();return a47_0x4839=function(_0x483978,_0x2c0ac3){_0x483978=_0x483978-0x18b;let _0x3692cb=_0x2fa3de[_0x483978];return _0x3692cb;},a47_0x4839(_0x342d17,_0x139667);}(function(_0x101278,_0x16cabd){const _0x472326=a47_0x4839,_0x14c51c=_0x101278();while(!![]){try{const _0x46c124=-parseInt(_0x472326(0x1a4))/0x1+parseInt(_0x472326(0x19b))/0x2*(-parseInt(_0x472326(0x19e))/0x3)+-parseInt(_0x472326(0x194))/0x4*(parseInt(_0x472326(0x191))/0x5)+-parseInt(_0x472326(0x1a3))/0x6+-parseInt(_0x472326(0x18e))/0x7+parseInt(_0x472326(0x19a))/0x8*(parseInt(_0x472326(0x193))/0x9)+parseInt(_0x472326(0x19c))/0xa;if(_0x46c124===_0x16cabd)break;else _0x14c51c['push'](_0x14c51c['shift']());}catch(_0x5a9111){_0x14c51c['push'](_0x14c51c['shift']());}}}(a47_0x2fa3,0x22033));var __importDefault=this&&this['__importDefault']||function(_0x48f6ae){const _0x53063a=a47_0x4839;return _0x48f6ae&&_0x48f6ae[_0x53063a(0x18b)]?_0x48f6ae:{'default':_0x48f6ae};};function a47_0x2fa3(){const _0x432065=['IntegrationsService','5RmvhRQ','parseWebhookEvents','36fCmLpM','891876opkyAn','webhookUrl','string','shopSettings','create','isArray','78536ZeWiKS','2DFrtZa','7105870UujsSc','../config/database','70212TNzjxM','parse','webhookEvents','findUnique','getIntegrations','465336ZREJia','245557DnzUmV','__esModule','ensureSettingsExist','default','287378XMrOKG','updateWebhookSettings'];a47_0x2fa3=function(){return _0x432065;};return a47_0x2fa3();}Object['defineProperty'](exports,a47_0x532c6c(0x18b),{'value':!![]}),exports[a47_0x532c6c(0x190)]=void 0x0;const database_1=__importDefault(require(a47_0x532c6c(0x19d)));class IntegrationsService{['parseWebhookEvents'](_0xf52751){const _0x3ab2cd=a47_0x532c6c;if(!_0xf52751)return[];if(Array[_0x3ab2cd(0x199)](_0xf52751))return _0xf52751;if(typeof _0xf52751===_0x3ab2cd(0x196))try{const _0x87468f=JSON[_0x3ab2cd(0x19f)](_0xf52751);return Array[_0x3ab2cd(0x199)](_0x87468f)?_0x87468f:[];}catch{return[];}return[];}async[a47_0x532c6c(0x1a2)](_0x3ee53e){const _0x211a17=a47_0x532c6c;await this[_0x211a17(0x18c)](_0x3ee53e);const _0x2080c5=await database_1[_0x211a17(0x18d)][_0x211a17(0x197)][_0x211a17(0x1a1)]({'where':{'shopId':_0x3ee53e},'select':{'webhookUrl':!![],'webhookEvents':!![]}});if(!_0x2080c5)throw new Error('Shop\x20settings\x20not\x20found');return{'webhook':{'url':_0x2080c5[_0x211a17(0x195)],'events':this[_0x211a17(0x192)](_0x2080c5[_0x211a17(0x1a0)])}};}async[a47_0x532c6c(0x18f)](_0xe45b1,_0x4ef538){const _0x4935e0=a47_0x532c6c;await this[_0x4935e0(0x18c)](_0xe45b1);const _0x3ec7b2={};_0x4ef538[_0x4935e0(0x195)]!==undefined&&(_0x3ec7b2[_0x4935e0(0x195)]=_0x4ef538[_0x4935e0(0x195)]||null),_0x4ef538['webhookEvents']!==undefined&&(_0x3ec7b2['webhookEvents']=_0x4ef538[_0x4935e0(0x1a0)]||[]),await database_1['default'][_0x4935e0(0x197)]['update']({'where':{'shopId':_0xe45b1},'data':_0x3ec7b2});}async['ensureSettingsExist'](_0x2a28f0){const _0x3a0985=a47_0x532c6c,_0x31d5e5=await database_1[_0x3a0985(0x18d)][_0x3a0985(0x197)][_0x3a0985(0x1a1)]({'where':{'shopId':_0x2a28f0}});!_0x31d5e5&&await database_1[_0x3a0985(0x18d)][_0x3a0985(0x197)][_0x3a0985(0x198)]({'data':{'shopId':_0x2a28f0}});}}exports[a47_0x532c6c(0x190)]=IntegrationsService;