'use strict';const a47_0x500d1c=a47_0x267c;(function(_0x47e9c4,_0x40ffe9){const _0xaa353d=a47_0x267c,_0x44a733=_0x47e9c4();while(!![]){try{const _0x1e920d=parseInt(_0xaa353d(0xac))/0x1+parseInt(_0xaa353d(0xaa))/0x2+-parseInt(_0xaa353d(0x96))/0x3+parseInt(_0xaa353d(0x9c))/0x4+parseInt(_0xaa353d(0xad))/0x5+parseInt(_0xaa353d(0xa5))/0x6*(parseInt(_0xaa353d(0x9e))/0x7)+-parseInt(_0xaa353d(0xa1))/0x8*(parseInt(_0xaa353d(0xa0))/0x9);if(_0x1e920d===_0x40ffe9)break;else _0x44a733['push'](_0x44a733['shift']());}catch(_0x1a3173){_0x44a733['push'](_0x44a733['shift']());}}}(a47_0x48e0,0xae4f2));function a47_0x48e0(){const _0x110085=['569192BpyoLb','create','parse','findUnique','164898rspeYb','string','isArray','__esModule','webhookEvents','2006068PgAQpx','update','248297bqeIkK','3688230BjdyZk','default','getIntegrations','3049578gPIRGh','__importDefault','updateWebhookSettings','webhookUrl','parseWebhookEvents','shopSettings','3081008lpUbHP','../config/database','336tWkEih','ensureSettingsExist','297lIxiDS'];a47_0x48e0=function(){return _0x110085;};return a47_0x48e0();}var __importDefault=this&&this[a47_0x500d1c(0x97)]||function(_0x73b3ed){return _0x73b3ed&&_0x73b3ed['__esModule']?_0x73b3ed:{'default':_0x73b3ed};};Object['defineProperty'](exports,a47_0x500d1c(0xa8),{'value':!![]}),exports['IntegrationsService']=void 0x0;function a47_0x267c(_0x2ed9b5,_0x34bd27){const _0x48e05a=a47_0x48e0();return a47_0x267c=function(_0x267c61,_0x3df34b){_0x267c61=_0x267c61-0x96;let _0x4e5fc3=_0x48e05a[_0x267c61];return _0x4e5fc3;},a47_0x267c(_0x2ed9b5,_0x34bd27);}const database_1=__importDefault(require(a47_0x500d1c(0x9d)));class IntegrationsService{[a47_0x500d1c(0x9a)](_0x363554){const _0x4889ef=a47_0x500d1c;if(!_0x363554)return[];if(Array['isArray'](_0x363554))return _0x363554;if(typeof _0x363554===_0x4889ef(0xa6))try{const _0x280143=JSON[_0x4889ef(0xa3)](_0x363554);return Array[_0x4889ef(0xa7)](_0x280143)?_0x280143:[];}catch{return[];}return[];}async[a47_0x500d1c(0xaf)](_0x555392){const _0x227b8c=a47_0x500d1c;await this[_0x227b8c(0x9f)](_0x555392);const _0x2040d7=await database_1[_0x227b8c(0xae)]['shopSettings'][_0x227b8c(0xa4)]({'where':{'shopId':_0x555392},'select':{'webhookUrl':!![],'webhookEvents':!![]}});if(!_0x2040d7)throw new Error('Shop\x20settings\x20not\x20found');return{'webhook':{'url':_0x2040d7[_0x227b8c(0x99)],'events':this[_0x227b8c(0x9a)](_0x2040d7[_0x227b8c(0xa9)])}};}async[a47_0x500d1c(0x98)](_0x27f166,_0x26a0c6){const _0x54ae39=a47_0x500d1c;await this[_0x54ae39(0x9f)](_0x27f166);const _0x1a3a43={};_0x26a0c6[_0x54ae39(0x99)]!==undefined&&(_0x1a3a43[_0x54ae39(0x99)]=_0x26a0c6[_0x54ae39(0x99)]||null),_0x26a0c6[_0x54ae39(0xa9)]!==undefined&&(_0x1a3a43[_0x54ae39(0xa9)]=_0x26a0c6[_0x54ae39(0xa9)]||[]),await database_1[_0x54ae39(0xae)]['shopSettings'][_0x54ae39(0xab)]({'where':{'shopId':_0x27f166},'data':_0x1a3a43});}async[a47_0x500d1c(0x9f)](_0x26c4e1){const _0x764bda=a47_0x500d1c,_0x107c14=await database_1[_0x764bda(0xae)][_0x764bda(0x9b)][_0x764bda(0xa4)]({'where':{'shopId':_0x26c4e1}});!_0x107c14&&await database_1['default'][_0x764bda(0x9b)][_0x764bda(0xa2)]({'data':{'shopId':_0x26c4e1}});}}exports['IntegrationsService']=IntegrationsService;