'use strict';function a74_0x142b(_0x215644,_0x38571b){_0x215644=_0x215644-0x1b7;const _0xc659db=a74_0xc659();let _0x142b55=_0xc659db[_0x215644];return _0x142b55;}function a74_0xc659(){const _0x861d29=['IntegrationsService','72aykGDy','isArray','11lFqfNJ','764772eNCGNu','14LXRpxG','64929BkLbrV','updateWebhookSettings','177536iilEcr','__esModule','defineProperty','4282930oVacUa','shopSettings','webhookEvents','16270476BcPzuw','getIntegrations','findUnique','webhookUrl','parseWebhookEvents','parse','34667jFBRFK','__importDefault','string','create','ensureSettingsExist','58530ALsIkn','14LOahgA','144usPmMl','default','Shop\x20settings\x20not\x20found'];a74_0xc659=function(){return _0x861d29;};return a74_0xc659();}const a74_0x158a5c=a74_0x142b;(function(_0x297a4e,_0x4bf52b){const _0x3aa64a=a74_0x142b,_0x52e23b=_0x297a4e();while(!![]){try{const _0x13cd2c=-parseInt(_0x3aa64a(0x1d4))/0x1+-parseInt(_0x3aa64a(0x1c5))/0x2*(-parseInt(_0x3aa64a(0x1c6))/0x3)+parseInt(_0x3aa64a(0x1c1))/0x4*(-parseInt(_0x3aa64a(0x1bb))/0x5)+-parseInt(_0x3aa64a(0x1c4))/0x6*(parseInt(_0x3aa64a(0x1bc))/0x7)+parseInt(_0x3aa64a(0x1c8))/0x8*(-parseInt(_0x3aa64a(0x1bd))/0x9)+-parseInt(_0x3aa64a(0x1cb))/0xa*(parseInt(_0x3aa64a(0x1c3))/0xb)+parseInt(_0x3aa64a(0x1ce))/0xc;if(_0x13cd2c===_0x4bf52b)break;else _0x52e23b['push'](_0x52e23b['shift']());}catch(_0x595a37){_0x52e23b['push'](_0x52e23b['shift']());}}}(a74_0xc659,0x369de));var __importDefault=this&&this[a74_0x158a5c(0x1b7)]||function(_0xb9c7cc){const _0x39320d=a74_0x158a5c;return _0xb9c7cc&&_0xb9c7cc[_0x39320d(0x1c9)]?_0xb9c7cc:{'default':_0xb9c7cc};};Object[a74_0x158a5c(0x1ca)](exports,a74_0x158a5c(0x1c9),{'value':!![]}),exports[a74_0x158a5c(0x1c0)]=void 0x0;const database_1=__importDefault(require('../config/database'));class IntegrationsService{[a74_0x158a5c(0x1d2)](_0x10e100){const _0x459718=a74_0x158a5c;if(!_0x10e100)return[];if(Array[_0x459718(0x1c2)](_0x10e100))return _0x10e100;if(typeof _0x10e100===_0x459718(0x1b8))try{const _0x494f42=JSON[_0x459718(0x1d3)](_0x10e100);return Array['isArray'](_0x494f42)?_0x494f42:[];}catch{return[];}return[];}async[a74_0x158a5c(0x1cf)](_0xf28e84){const _0x666c76=a74_0x158a5c;await this[_0x666c76(0x1ba)](_0xf28e84);const _0x436443=await database_1[_0x666c76(0x1be)][_0x666c76(0x1cc)][_0x666c76(0x1d0)]({'where':{'shopId':_0xf28e84},'select':{'webhookUrl':!![],'webhookEvents':!![]}});if(!_0x436443)throw new Error(_0x666c76(0x1bf));return{'webhook':{'url':_0x436443[_0x666c76(0x1d1)],'events':this[_0x666c76(0x1d2)](_0x436443[_0x666c76(0x1cd)])}};}async[a74_0x158a5c(0x1c7)](_0x273384,_0x158d41){const _0x28361e=a74_0x158a5c;await this['ensureSettingsExist'](_0x273384);const _0x49184a={};_0x158d41[_0x28361e(0x1d1)]!==undefined&&(_0x49184a['webhookUrl']=_0x158d41[_0x28361e(0x1d1)]||null),_0x158d41['webhookEvents']!==undefined&&(_0x49184a[_0x28361e(0x1cd)]=_0x158d41['webhookEvents']||[]),await database_1['default'][_0x28361e(0x1cc)]['update']({'where':{'shopId':_0x273384},'data':_0x49184a});}async[a74_0x158a5c(0x1ba)](_0xa23584){const _0xb24fa2=a74_0x158a5c,_0x4a5965=await database_1[_0xb24fa2(0x1be)][_0xb24fa2(0x1cc)]['findUnique']({'where':{'shopId':_0xa23584}});!_0x4a5965&&await database_1[_0xb24fa2(0x1be)]['shopSettings'][_0xb24fa2(0x1b9)]({'data':{'shopId':_0xa23584}});}}exports[a74_0x158a5c(0x1c0)]=IntegrationsService;