'use strict';const a51_0x502fe2=a51_0xf594;function a51_0x50d9(){const _0x14fba0=['4CexQwe','ensureSettingsExist','1755aqqFqB','string','Shop\x20settings\x20not\x20found','10536VmARLO','47716ueJTdQ','__importDefault','defineProperty','isArray','webhookEvents','8128338SmyDhG','../config/database','webhookUrl','3635550DQlXGV','parseWebhookEvents','shopSettings','982270mhsnTW','8145200GeSwVP','5690795XWqfSk','updateWebhookSettings','__esModule','default','IntegrationsService','getIntegrations'];a51_0x50d9=function(){return _0x14fba0;};return a51_0x50d9();}function a51_0xf594(_0x4e9b30,_0x24d0c2){const _0x50d95a=a51_0x50d9();return a51_0xf594=function(_0xf59458,_0x53fd1d){_0xf59458=_0xf59458-0x1e2;let _0x45ee90=_0x50d95a[_0xf59458];return _0x45ee90;},a51_0xf594(_0x4e9b30,_0x24d0c2);}(function(_0x34d39c,_0x11ca63){const _0x225ca2=a51_0xf594,_0x1ebf51=_0x34d39c();while(!![]){try{const _0x19afb4=-parseInt(_0x225ca2(0x1e2))/0x1+parseInt(_0x225ca2(0x1ed))/0x2+-parseInt(_0x225ca2(0x1ea))/0x3+parseInt(_0x225ca2(0x1f5))/0x4*(parseInt(_0x225ca2(0x1ef))/0x5)+parseInt(_0x225ca2(0x1e7))/0x6+-parseInt(_0x225ca2(0x1ee))/0x7+-parseInt(_0x225ca2(0x1fa))/0x8*(-parseInt(_0x225ca2(0x1f7))/0x9);if(_0x19afb4===_0x11ca63)break;else _0x1ebf51['push'](_0x1ebf51['shift']());}catch(_0x1729b8){_0x1ebf51['push'](_0x1ebf51['shift']());}}}(a51_0x50d9,0xc7a02));var __importDefault=this&&this[a51_0x502fe2(0x1e3)]||function(_0x23a1bd){const _0x59995c=a51_0x502fe2;return _0x23a1bd&&_0x23a1bd[_0x59995c(0x1f1)]?_0x23a1bd:{'default':_0x23a1bd};};Object[a51_0x502fe2(0x1e4)](exports,'__esModule',{'value':!![]}),exports[a51_0x502fe2(0x1f3)]=void 0x0;const database_1=__importDefault(require(a51_0x502fe2(0x1e8)));class IntegrationsService{[a51_0x502fe2(0x1eb)](_0x12a703){const _0x4396b8=a51_0x502fe2;if(!_0x12a703)return[];if(Array[_0x4396b8(0x1e5)](_0x12a703))return _0x12a703;if(typeof _0x12a703===_0x4396b8(0x1f8))try{const _0x1657df=JSON['parse'](_0x12a703);return Array['isArray'](_0x1657df)?_0x1657df:[];}catch{return[];}return[];}async[a51_0x502fe2(0x1f4)](_0x306905){const _0x5eb7c6=a51_0x502fe2;await this[_0x5eb7c6(0x1f6)](_0x306905);const _0x3bd448=await database_1[_0x5eb7c6(0x1f2)][_0x5eb7c6(0x1ec)]['findUnique']({'where':{'shopId':_0x306905},'select':{'webhookUrl':!![],'webhookEvents':!![]}});if(!_0x3bd448)throw new Error(_0x5eb7c6(0x1f9));return{'webhook':{'url':_0x3bd448[_0x5eb7c6(0x1e9)],'events':this['parseWebhookEvents'](_0x3bd448[_0x5eb7c6(0x1e6)])}};}async[a51_0x502fe2(0x1f0)](_0x1649f2,_0x140bae){const _0x8a01ec=a51_0x502fe2;await this[_0x8a01ec(0x1f6)](_0x1649f2);const _0x3253e={};_0x140bae[_0x8a01ec(0x1e9)]!==undefined&&(_0x3253e['webhookUrl']=_0x140bae['webhookUrl']||null),_0x140bae[_0x8a01ec(0x1e6)]!==undefined&&(_0x3253e[_0x8a01ec(0x1e6)]=_0x140bae[_0x8a01ec(0x1e6)]||[]),await database_1[_0x8a01ec(0x1f2)][_0x8a01ec(0x1ec)]['update']({'where':{'shopId':_0x1649f2},'data':_0x3253e});}async[a51_0x502fe2(0x1f6)](_0x4a36d5){const _0x1de74a=a51_0x502fe2,_0x24105a=await database_1[_0x1de74a(0x1f2)][_0x1de74a(0x1ec)]['findUnique']({'where':{'shopId':_0x4a36d5}});!_0x24105a&&await database_1[_0x1de74a(0x1f2)][_0x1de74a(0x1ec)]['create']({'data':{'shopId':_0x4a36d5}});}}exports[a51_0x502fe2(0x1f3)]=IntegrationsService;