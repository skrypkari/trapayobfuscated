'use strict';const a47_0x39ed7f=a47_0x5e42;(function(_0x1e7cfb,_0x26e3bd){const _0xde24b2=a47_0x5e42,_0x14eeb3=_0x1e7cfb();while(!![]){try{const _0x4a6e59=parseInt(_0xde24b2(0x15a))/0x1*(parseInt(_0xde24b2(0x14c))/0x2)+parseInt(_0xde24b2(0x157))/0x3*(-parseInt(_0xde24b2(0x15c))/0x4)+parseInt(_0xde24b2(0x156))/0x5+-parseInt(_0xde24b2(0x14d))/0x6*(-parseInt(_0xde24b2(0x148))/0x7)+-parseInt(_0xde24b2(0x14a))/0x8*(-parseInt(_0xde24b2(0x15e))/0x9)+-parseInt(_0xde24b2(0x153))/0xa*(parseInt(_0xde24b2(0x143))/0xb)+parseInt(_0xde24b2(0x159))/0xc;if(_0x4a6e59===_0x26e3bd)break;else _0x14eeb3['push'](_0x14eeb3['shift']());}catch(_0x39f9d1){_0x14eeb3['push'](_0x14eeb3['shift']());}}}(a47_0x57d3,0x36433));function a47_0x57d3(){const _0x5ef691=['findUnique','9RbAxSt','__importDefault','4877323vJhlwB','shopSettings','default','ensureSettingsExist','__esModule','7zUEEXY','updateWebhookSettings','756232HRbSNJ','update','4CRvtrw','63582BgftXA','defineProperty','isArray','parseWebhookEvents','Shop\x20settings\x20not\x20found','string','10WHkMzH','webhookEvents','webhookUrl','992095sMfKHz','25647phnXSf','create','4659912mvyzDI','196341nOlHiF','IntegrationsService','196HxngHJ'];a47_0x57d3=function(){return _0x5ef691;};return a47_0x57d3();}var __importDefault=this&&this[a47_0x39ed7f(0x142)]||function(_0x69357a){const _0x58ad1e=a47_0x39ed7f;return _0x69357a&&_0x69357a[_0x58ad1e(0x147)]?_0x69357a:{'default':_0x69357a};};Object[a47_0x39ed7f(0x14e)](exports,a47_0x39ed7f(0x147),{'value':!![]}),exports[a47_0x39ed7f(0x15b)]=void 0x0;function a47_0x5e42(_0xe42811,_0x233455){const _0x57d353=a47_0x57d3();return a47_0x5e42=function(_0x5e4272,_0x30973d){_0x5e4272=_0x5e4272-0x142;let _0xd86b7f=_0x57d353[_0x5e4272];return _0xd86b7f;},a47_0x5e42(_0xe42811,_0x233455);}const database_1=__importDefault(require('../config/database'));class IntegrationsService{[a47_0x39ed7f(0x150)](_0x5d4bf2){const _0x3a7544=a47_0x39ed7f;if(!_0x5d4bf2)return[];if(Array[_0x3a7544(0x14f)](_0x5d4bf2))return _0x5d4bf2;if(typeof _0x5d4bf2===_0x3a7544(0x152))try{const _0x14ba0e=JSON['parse'](_0x5d4bf2);return Array['isArray'](_0x14ba0e)?_0x14ba0e:[];}catch{return[];}return[];}async['getIntegrations'](_0x4e43c3){const _0x1b7fed=a47_0x39ed7f;await this[_0x1b7fed(0x146)](_0x4e43c3);const _0x209b98=await database_1['default'][_0x1b7fed(0x144)]['findUnique']({'where':{'shopId':_0x4e43c3},'select':{'webhookUrl':!![],'webhookEvents':!![]}});if(!_0x209b98)throw new Error(_0x1b7fed(0x151));return{'webhook':{'url':_0x209b98[_0x1b7fed(0x155)],'events':this[_0x1b7fed(0x150)](_0x209b98[_0x1b7fed(0x154)])}};}async[a47_0x39ed7f(0x149)](_0x320517,_0x45e827){const _0x347459=a47_0x39ed7f;await this['ensureSettingsExist'](_0x320517);const _0x23195b={};_0x45e827[_0x347459(0x155)]!==undefined&&(_0x23195b[_0x347459(0x155)]=_0x45e827['webhookUrl']||null),_0x45e827[_0x347459(0x154)]!==undefined&&(_0x23195b['webhookEvents']=_0x45e827[_0x347459(0x154)]||[]),await database_1[_0x347459(0x145)][_0x347459(0x144)][_0x347459(0x14b)]({'where':{'shopId':_0x320517},'data':_0x23195b});}async[a47_0x39ed7f(0x146)](_0x4bc27){const _0x48f510=a47_0x39ed7f,_0x4880c5=await database_1[_0x48f510(0x145)][_0x48f510(0x144)][_0x48f510(0x15d)]({'where':{'shopId':_0x4bc27}});!_0x4880c5&&await database_1[_0x48f510(0x145)]['shopSettings'][_0x48f510(0x158)]({'data':{'shopId':_0x4bc27}});}}exports[a47_0x39ed7f(0x15b)]=IntegrationsService;