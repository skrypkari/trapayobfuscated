'use strict';function a66_0x3a91(_0xec418b,_0x2d5af7){_0xec418b=_0xec418b-0x108;const _0x2ac057=a66_0x2ac0();let _0x3a9143=_0x2ac057[_0xec418b];return _0x3a9143;}const a66_0x14f074=a66_0x3a91;(function(_0x2d98d3,_0x576722){const _0x302ea1=a66_0x3a91,_0x2f18b6=_0x2d98d3();while(!![]){try{const _0x35dee0=-parseInt(_0x302ea1(0x11d))/0x1*(parseInt(_0x302ea1(0x119))/0x2)+parseInt(_0x302ea1(0x11c))/0x3*(parseInt(_0x302ea1(0x10b))/0x4)+parseInt(_0x302ea1(0x11b))/0x5+parseInt(_0x302ea1(0x10d))/0x6*(parseInt(_0x302ea1(0x123))/0x7)+-parseInt(_0x302ea1(0x117))/0x8+-parseInt(_0x302ea1(0x113))/0x9+-parseInt(_0x302ea1(0x10f))/0xa*(-parseInt(_0x302ea1(0x120))/0xb);if(_0x35dee0===_0x576722)break;else _0x2f18b6['push'](_0x2f18b6['shift']());}catch(_0x1f043d){_0x2f18b6['push'](_0x2f18b6['shift']());}}}(a66_0x2ac0,0x88d0f));var __importDefault=this&&this['__importDefault']||function(_0x1bdecd){const _0x46a048=a66_0x3a91;return _0x1bdecd&&_0x1bdecd[_0x46a048(0x11f)]?_0x1bdecd:{'default':_0x1bdecd};};function a66_0x2ac0(){const _0x536941=['parse','../config/database','5952303WkkqGR','isArray','webhookEvents','create','5894784epUyyO','updateWebhookSettings','32408UUfCcx','IntegrationsService','801065ofbXhU','570gbLZWy','19rrnVwe','getIntegrations','__esModule','583iHKDUG','findUnique','webhookUrl','68369daVBwv','parseWebhookEvents','shopSettings','ensureSettingsExist','1216gXiUKL','defineProperty','48dpGWHV','default','371770UasEyW','Shop\x20settings\x20not\x20found'];a66_0x2ac0=function(){return _0x536941;};return a66_0x2ac0();}Object[a66_0x14f074(0x10c)](exports,a66_0x14f074(0x11f),{'value':!![]}),exports[a66_0x14f074(0x11a)]=void 0x0;const database_1=__importDefault(require(a66_0x14f074(0x112)));class IntegrationsService{[a66_0x14f074(0x108)](_0x31a109){const _0x259e05=a66_0x14f074;if(!_0x31a109)return[];if(Array[_0x259e05(0x114)](_0x31a109))return _0x31a109;if(typeof _0x31a109==='string')try{const _0x277deb=JSON[_0x259e05(0x111)](_0x31a109);return Array[_0x259e05(0x114)](_0x277deb)?_0x277deb:[];}catch{return[];}return[];}async[a66_0x14f074(0x11e)](_0x38fd6a){const _0x51c65b=a66_0x14f074;await this[_0x51c65b(0x10a)](_0x38fd6a);const _0x3ac1a7=await database_1[_0x51c65b(0x10e)][_0x51c65b(0x109)][_0x51c65b(0x121)]({'where':{'shopId':_0x38fd6a},'select':{'webhookUrl':!![],'webhookEvents':!![]}});if(!_0x3ac1a7)throw new Error(_0x51c65b(0x110));return{'webhook':{'url':_0x3ac1a7['webhookUrl'],'events':this['parseWebhookEvents'](_0x3ac1a7[_0x51c65b(0x115)])}};}async[a66_0x14f074(0x118)](_0x4b4bf0,_0x129b1a){const _0x235dac=a66_0x14f074;await this[_0x235dac(0x10a)](_0x4b4bf0);const _0x28e14a={};_0x129b1a[_0x235dac(0x122)]!==undefined&&(_0x28e14a[_0x235dac(0x122)]=_0x129b1a[_0x235dac(0x122)]||null),_0x129b1a['webhookEvents']!==undefined&&(_0x28e14a[_0x235dac(0x115)]=_0x129b1a[_0x235dac(0x115)]||[]),await database_1['default'][_0x235dac(0x109)]['update']({'where':{'shopId':_0x4b4bf0},'data':_0x28e14a});}async[a66_0x14f074(0x10a)](_0x35c505){const _0x2fc029=a66_0x14f074,_0x5a9eba=await database_1[_0x2fc029(0x10e)]['shopSettings'][_0x2fc029(0x121)]({'where':{'shopId':_0x35c505}});!_0x5a9eba&&await database_1[_0x2fc029(0x10e)][_0x2fc029(0x109)][_0x2fc029(0x116)]({'data':{'shopId':_0x35c505}});}}exports[a66_0x14f074(0x11a)]=IntegrationsService;