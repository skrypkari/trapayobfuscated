'use strict';const a50_0x500cfd=a50_0x27c7;(function(_0x1c7a61,_0x102cd7){const _0x2e944c=a50_0x27c7,_0x304917=_0x1c7a61();while(!![]){try{const _0x2390d9=parseInt(_0x2e944c(0xd4))/0x1+parseInt(_0x2e944c(0xc6))/0x2*(parseInt(_0x2e944c(0xc2))/0x3)+parseInt(_0x2e944c(0xce))/0x4*(-parseInt(_0x2e944c(0xd2))/0x5)+-parseInt(_0x2e944c(0xda))/0x6*(parseInt(_0x2e944c(0xcd))/0x7)+parseInt(_0x2e944c(0xd1))/0x8+parseInt(_0x2e944c(0xcf))/0x9+-parseInt(_0x2e944c(0xd5))/0xa;if(_0x2390d9===_0x102cd7)break;else _0x304917['push'](_0x304917['shift']());}catch(_0x2af333){_0x304917['push'](_0x304917['shift']());}}}(a50_0x3c3d,0xbcc6e));function a50_0x27c7(_0x193fa6,_0x3ba3f2){const _0x3c3d14=a50_0x3c3d();return a50_0x27c7=function(_0x27c70a,_0xa32b39){_0x27c70a=_0x27c70a-0xc2;let _0x2b2657=_0x3c3d14[_0x27c70a];return _0x2b2657;},a50_0x27c7(_0x193fa6,_0x3ba3f2);}function a50_0x3c3d(){const _0x2f6914=['IntegrationsService','611121XYMRoZ','ensureSettingsExist','getIntegrations','parseWebhookEvents','6ngSoGM','isArray','webhookUrl','../config/database','__esModule','webhookEvents','default','23079NFNNqA','1422480BpIuNn','4330062zgPwey','string','5924112XAJdye','15bEFpLE','parse','1026747jAppVF','8908270qFFSWr','shopSettings','__importDefault','Shop\x20settings\x20not\x20found','findUnique','234fapayx'];a50_0x3c3d=function(){return _0x2f6914;};return a50_0x3c3d();}var __importDefault=this&&this[a50_0x500cfd(0xd7)]||function(_0x4e50bd){const _0x803072=a50_0x500cfd;return _0x4e50bd&&_0x4e50bd[_0x803072(0xca)]?_0x4e50bd:{'default':_0x4e50bd};};Object['defineProperty'](exports,'__esModule',{'value':!![]}),exports[a50_0x500cfd(0xdb)]=void 0x0;const database_1=__importDefault(require(a50_0x500cfd(0xc9)));class IntegrationsService{[a50_0x500cfd(0xc5)](_0x96b7d7){const _0x28eaab=a50_0x500cfd;if(!_0x96b7d7)return[];if(Array[_0x28eaab(0xc7)](_0x96b7d7))return _0x96b7d7;if(typeof _0x96b7d7===_0x28eaab(0xd0))try{const _0x5c8b04=JSON[_0x28eaab(0xd3)](_0x96b7d7);return Array['isArray'](_0x5c8b04)?_0x5c8b04:[];}catch{return[];}return[];}async[a50_0x500cfd(0xc4)](_0x4584e2){const _0x12a98d=a50_0x500cfd;await this[_0x12a98d(0xc3)](_0x4584e2);const _0x2c29f5=await database_1[_0x12a98d(0xcc)][_0x12a98d(0xd6)][_0x12a98d(0xd9)]({'where':{'shopId':_0x4584e2},'select':{'webhookUrl':!![],'webhookEvents':!![]}});if(!_0x2c29f5)throw new Error(_0x12a98d(0xd8));return{'webhook':{'url':_0x2c29f5[_0x12a98d(0xc8)],'events':this[_0x12a98d(0xc5)](_0x2c29f5[_0x12a98d(0xcb)])}};}async['updateWebhookSettings'](_0x28dc6c,_0xa3b62){const _0x4f5ddd=a50_0x500cfd;await this[_0x4f5ddd(0xc3)](_0x28dc6c);const _0x35bfe9={};_0xa3b62['webhookUrl']!==undefined&&(_0x35bfe9[_0x4f5ddd(0xc8)]=_0xa3b62[_0x4f5ddd(0xc8)]||null),_0xa3b62[_0x4f5ddd(0xcb)]!==undefined&&(_0x35bfe9['webhookEvents']=_0xa3b62[_0x4f5ddd(0xcb)]||[]),await database_1['default'][_0x4f5ddd(0xd6)]['update']({'where':{'shopId':_0x28dc6c},'data':_0x35bfe9});}async[a50_0x500cfd(0xc3)](_0x49a230){const _0x317cf0=a50_0x500cfd,_0x14004e=await database_1[_0x317cf0(0xcc)][_0x317cf0(0xd6)]['findUnique']({'where':{'shopId':_0x49a230}});!_0x14004e&&await database_1[_0x317cf0(0xcc)][_0x317cf0(0xd6)]['create']({'data':{'shopId':_0x49a230}});}}exports[a50_0x500cfd(0xdb)]=IntegrationsService;