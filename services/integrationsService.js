'use strict';function a47_0x3f37(){const _0x436eab=['814760hcYvFe','24596217bcrGhf','62138dCJNZC','__importDefault','updateWebhookSettings','webhookUrl','findUnique','parseWebhookEvents','__esModule','6208244tSoTTm','Shop\x20settings\x20not\x20found','138bQFKcy','defineProperty','shopSettings','webhookEvents','2116296mdwLwP','string','96190NLdJZn','1453768nvpDqw','ensureSettingsExist','getIntegrations','create','../config/database','isArray','30tQEkIQ','IntegrationsService','default'];a47_0x3f37=function(){return _0x436eab;};return a47_0x3f37();}const a47_0x34e274=a47_0x1a18;(function(_0x141238,_0x587338){const _0x183246=a47_0x1a18,_0x4b2e15=_0x141238();while(!![]){try{const _0xd899ca=-parseInt(_0x183246(0x1e7))/0x1+-parseInt(_0x183246(0x1e9))/0x2*(parseInt(_0x183246(0x1e4))/0x3)+-parseInt(_0x183246(0x1db))/0x4+parseInt(_0x183246(0x1dd))/0x5*(parseInt(_0x183246(0x1d7))/0x6)+-parseInt(_0x183246(0x1f0))/0x7+-parseInt(_0x183246(0x1de))/0x8+parseInt(_0x183246(0x1e8))/0x9;if(_0xd899ca===_0x587338)break;else _0x4b2e15['push'](_0x4b2e15['shift']());}catch(_0x15ed33){_0x4b2e15['push'](_0x4b2e15['shift']());}}}(a47_0x3f37,0x6e69a));var __importDefault=this&&this[a47_0x34e274(0x1ea)]||function(_0x1a60a6){const _0x8693d3=a47_0x34e274;return _0x1a60a6&&_0x1a60a6[_0x8693d3(0x1ef)]?_0x1a60a6:{'default':_0x1a60a6};};function a47_0x1a18(_0x418546,_0x188b50){const _0x3f37a3=a47_0x3f37();return a47_0x1a18=function(_0x1a1819,_0x3a3043){_0x1a1819=_0x1a1819-0x1d6;let _0x3de444=_0x3f37a3[_0x1a1819];return _0x3de444;},a47_0x1a18(_0x418546,_0x188b50);}Object[a47_0x34e274(0x1d8)](exports,a47_0x34e274(0x1ef),{'value':!![]}),exports[a47_0x34e274(0x1e5)]=void 0x0;const database_1=__importDefault(require(a47_0x34e274(0x1e2)));class IntegrationsService{['parseWebhookEvents'](_0x2f879c){const _0x11e140=a47_0x34e274;if(!_0x2f879c)return[];if(Array['isArray'](_0x2f879c))return _0x2f879c;if(typeof _0x2f879c===_0x11e140(0x1dc))try{const _0x240196=JSON['parse'](_0x2f879c);return Array[_0x11e140(0x1e3)](_0x240196)?_0x240196:[];}catch{return[];}return[];}async[a47_0x34e274(0x1e0)](_0x5b2b73){const _0x34afd2=a47_0x34e274;await this[_0x34afd2(0x1df)](_0x5b2b73);const _0x2e567c=await database_1[_0x34afd2(0x1e6)]['shopSettings'][_0x34afd2(0x1ed)]({'where':{'shopId':_0x5b2b73},'select':{'webhookUrl':!![],'webhookEvents':!![]}});if(!_0x2e567c)throw new Error(_0x34afd2(0x1d6));return{'webhook':{'url':_0x2e567c[_0x34afd2(0x1ec)],'events':this[_0x34afd2(0x1ee)](_0x2e567c['webhookEvents'])}};}async[a47_0x34e274(0x1eb)](_0x6515b5,_0x356b6f){const _0x2fe917=a47_0x34e274;await this[_0x2fe917(0x1df)](_0x6515b5);const _0x5e9e0a={};_0x356b6f[_0x2fe917(0x1ec)]!==undefined&&(_0x5e9e0a[_0x2fe917(0x1ec)]=_0x356b6f[_0x2fe917(0x1ec)]||null),_0x356b6f[_0x2fe917(0x1da)]!==undefined&&(_0x5e9e0a['webhookEvents']=_0x356b6f[_0x2fe917(0x1da)]||[]),await database_1[_0x2fe917(0x1e6)][_0x2fe917(0x1d9)]['update']({'where':{'shopId':_0x6515b5},'data':_0x5e9e0a});}async[a47_0x34e274(0x1df)](_0x444e52){const _0x5c25cc=a47_0x34e274,_0x500d96=await database_1[_0x5c25cc(0x1e6)][_0x5c25cc(0x1d9)][_0x5c25cc(0x1ed)]({'where':{'shopId':_0x444e52}});!_0x500d96&&await database_1[_0x5c25cc(0x1e6)][_0x5c25cc(0x1d9)][_0x5c25cc(0x1e1)]({'data':{'shopId':_0x444e52}});}}exports[a47_0x34e274(0x1e5)]=IntegrationsService;