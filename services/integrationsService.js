'use strict';const a58_0x500bb6=a58_0x2c6e;function a58_0x58ab(){const _0x58ea6b=['6968pvxiNV','ensureSettingsExist','findUnique','20222KHLOqB','84dKKHZR','942332toloPP','create','1122363XJfRQM','default','1555092ZsVGuG','__esModule','webhookUrl','5JgRHuT','parseWebhookEvents','20tFwWQl','getIntegrations','update','Shop\x20settings\x20not\x20found','1848HApkby','webhookEvents','148751KVAJdG','isArray','shopSettings','__importDefault','331276jQuZbz','IntegrationsService'];a58_0x58ab=function(){return _0x58ea6b;};return a58_0x58ab();}(function(_0x44d22c,_0x19b4c5){const _0x5b598e=a58_0x2c6e,_0x3e58ab=_0x44d22c();while(!![]){try{const _0x367945=-parseInt(_0x5b598e(0x89))/0x1+-parseInt(_0x5b598e(0x92))/0x2*(-parseInt(_0x5b598e(0x93))/0x3)+parseInt(_0x5b598e(0x94))/0x4*(-parseInt(_0x5b598e(0x9b))/0x5)+parseInt(_0x5b598e(0x98))/0x6+-parseInt(_0x5b598e(0x87))/0x7*(-parseInt(_0x5b598e(0x8f))/0x8)+-parseInt(_0x5b598e(0x96))/0x9+parseInt(_0x5b598e(0x9d))/0xa*(-parseInt(_0x5b598e(0x8d))/0xb);if(_0x367945===_0x19b4c5)break;else _0x3e58ab['push'](_0x3e58ab['shift']());}catch(_0x4d67ce){_0x3e58ab['push'](_0x3e58ab['shift']());}}}(a58_0x58ab,0x318d1));var __importDefault=this&&this[a58_0x500bb6(0x8c)]||function(_0x5bb055){const _0x2aba16=a58_0x500bb6;return _0x5bb055&&_0x5bb055[_0x2aba16(0x99)]?_0x5bb055:{'default':_0x5bb055};};Object['defineProperty'](exports,a58_0x500bb6(0x99),{'value':!![]}),exports[a58_0x500bb6(0x8e)]=void 0x0;function a58_0x2c6e(_0x508cea,_0x23dbd2){const _0x58ab0e=a58_0x58ab();return a58_0x2c6e=function(_0x2c6e6f,_0x1a21f8){_0x2c6e6f=_0x2c6e6f-0x84;let _0x3da3ed=_0x58ab0e[_0x2c6e6f];return _0x3da3ed;},a58_0x2c6e(_0x508cea,_0x23dbd2);}const database_1=__importDefault(require('../config/database'));class IntegrationsService{[a58_0x500bb6(0x9c)](_0x5c97ab){const _0x3c3d86=a58_0x500bb6;if(!_0x5c97ab)return[];if(Array[_0x3c3d86(0x8a)](_0x5c97ab))return _0x5c97ab;if(typeof _0x5c97ab==='string')try{const _0x230649=JSON['parse'](_0x5c97ab);return Array[_0x3c3d86(0x8a)](_0x230649)?_0x230649:[];}catch{return[];}return[];}async[a58_0x500bb6(0x84)](_0x1851b1){const _0xcb688d=a58_0x500bb6;await this[_0xcb688d(0x90)](_0x1851b1);const _0x5088e3=await database_1[_0xcb688d(0x97)][_0xcb688d(0x8b)][_0xcb688d(0x91)]({'where':{'shopId':_0x1851b1},'select':{'webhookUrl':!![],'webhookEvents':!![]}});if(!_0x5088e3)throw new Error(_0xcb688d(0x86));return{'webhook':{'url':_0x5088e3[_0xcb688d(0x9a)],'events':this['parseWebhookEvents'](_0x5088e3['webhookEvents'])}};}async['updateWebhookSettings'](_0x55c488,_0x10213b){const _0xd55bb=a58_0x500bb6;await this[_0xd55bb(0x90)](_0x55c488);const _0x34f113={};_0x10213b['webhookUrl']!==undefined&&(_0x34f113[_0xd55bb(0x9a)]=_0x10213b[_0xd55bb(0x9a)]||null),_0x10213b['webhookEvents']!==undefined&&(_0x34f113[_0xd55bb(0x88)]=_0x10213b['webhookEvents']||[]),await database_1[_0xd55bb(0x97)][_0xd55bb(0x8b)][_0xd55bb(0x85)]({'where':{'shopId':_0x55c488},'data':_0x34f113});}async[a58_0x500bb6(0x90)](_0x51df23){const _0x832ded=a58_0x500bb6,_0x42ee1d=await database_1['default'][_0x832ded(0x8b)]['findUnique']({'where':{'shopId':_0x51df23}});!_0x42ee1d&&await database_1[_0x832ded(0x97)]['shopSettings'][_0x832ded(0x95)]({'data':{'shopId':_0x51df23}});}}exports[a58_0x500bb6(0x8e)]=IntegrationsService;