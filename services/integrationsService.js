'use strict';const a47_0x29b901=a47_0x59cc;function a47_0xd642(){const _0x2f7561=['parseWebhookEvents','1204ClbDOA','default','../config/database','isArray','2178csZRXU','15TQXMbf','ensureSettingsExist','534UPfmhy','6535330xsHJKD','12928PSPsjR','2450462GLmoRh','updateWebhookSettings','987270JKjXHg','create','IntegrationsService','webhookEvents','555642iXgNka','string','getIntegrations','shopSettings','88617uCuNVh','findUnique','webhookUrl','Shop\x20settings\x20not\x20found'];a47_0xd642=function(){return _0x2f7561;};return a47_0xd642();}(function(_0x23abc0,_0x533233){const _0x44e5d7=a47_0x59cc,_0x1e8de7=_0x23abc0();while(!![]){try{const _0x161d9a=-parseInt(_0x44e5d7(0xdc))/0x1+parseInt(_0x44e5d7(0xd8))/0x2+-parseInt(_0x44e5d7(0xe8))/0x3*(parseInt(_0x44e5d7(0xe1))/0x4)+-parseInt(_0x44e5d7(0xe6))/0x5*(parseInt(_0x44e5d7(0xed))/0x6)+parseInt(_0x44e5d7(0xeb))/0x7+-parseInt(_0x44e5d7(0xea))/0x8*(parseInt(_0x44e5d7(0xe5))/0x9)+parseInt(_0x44e5d7(0xe9))/0xa;if(_0x161d9a===_0x533233)break;else _0x1e8de7['push'](_0x1e8de7['shift']());}catch(_0x72db33){_0x1e8de7['push'](_0x1e8de7['shift']());}}}(a47_0xd642,0x3e236));var __importDefault=this&&this['__importDefault']||function(_0x44db7b){return _0x44db7b&&_0x44db7b['__esModule']?_0x44db7b:{'default':_0x44db7b};};Object['defineProperty'](exports,'__esModule',{'value':!![]}),exports[a47_0x29b901(0xd6)]=void 0x0;const database_1=__importDefault(require(a47_0x29b901(0xe3)));function a47_0x59cc(_0x2c9ee2,_0x47fa31){const _0xd64234=a47_0xd642();return a47_0x59cc=function(_0x59cc70,_0x209d9d){_0x59cc70=_0x59cc70-0xd6;let _0x1784dd=_0xd64234[_0x59cc70];return _0x1784dd;},a47_0x59cc(_0x2c9ee2,_0x47fa31);}class IntegrationsService{[a47_0x29b901(0xe0)](_0x226ef0){const _0x2186c1=a47_0x29b901;if(!_0x226ef0)return[];if(Array[_0x2186c1(0xe4)](_0x226ef0))return _0x226ef0;if(typeof _0x226ef0===_0x2186c1(0xd9))try{const _0x1e17aa=JSON['parse'](_0x226ef0);return Array[_0x2186c1(0xe4)](_0x1e17aa)?_0x1e17aa:[];}catch{return[];}return[];}async[a47_0x29b901(0xda)](_0x43ccd3){const _0x468c95=a47_0x29b901;await this[_0x468c95(0xe7)](_0x43ccd3);const _0x23945f=await database_1[_0x468c95(0xe2)][_0x468c95(0xdb)]['findUnique']({'where':{'shopId':_0x43ccd3},'select':{'webhookUrl':!![],'webhookEvents':!![]}});if(!_0x23945f)throw new Error(_0x468c95(0xdf));return{'webhook':{'url':_0x23945f[_0x468c95(0xde)],'events':this['parseWebhookEvents'](_0x23945f[_0x468c95(0xd7)])}};}async[a47_0x29b901(0xec)](_0x54e2aa,_0xa05e64){const _0x288c89=a47_0x29b901;await this[_0x288c89(0xe7)](_0x54e2aa);const _0x34ba05={};_0xa05e64[_0x288c89(0xde)]!==undefined&&(_0x34ba05[_0x288c89(0xde)]=_0xa05e64[_0x288c89(0xde)]||null),_0xa05e64['webhookEvents']!==undefined&&(_0x34ba05[_0x288c89(0xd7)]=_0xa05e64[_0x288c89(0xd7)]||[]),await database_1['default'][_0x288c89(0xdb)]['update']({'where':{'shopId':_0x54e2aa},'data':_0x34ba05});}async[a47_0x29b901(0xe7)](_0x27322b){const _0x14a6c0=a47_0x29b901,_0x3a1eac=await database_1[_0x14a6c0(0xe2)][_0x14a6c0(0xdb)][_0x14a6c0(0xdd)]({'where':{'shopId':_0x27322b}});!_0x3a1eac&&await database_1['default'][_0x14a6c0(0xdb)][_0x14a6c0(0xee)]({'data':{'shopId':_0x27322b}});}}exports[a47_0x29b901(0xd6)]=IntegrationsService;