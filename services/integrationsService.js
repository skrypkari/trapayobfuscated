'use strict';const a43_0x187cf0=a43_0xae5f;(function(_0x87bb4c,_0x529cf6){const _0x349b23=a43_0xae5f,_0x5d5c0a=_0x87bb4c();while(!![]){try{const _0x9c6886=-parseInt(_0x349b23(0x1bb))/0x1*(parseInt(_0x349b23(0x1c8))/0x2)+-parseInt(_0x349b23(0x1b7))/0x3+-parseInt(_0x349b23(0x1bc))/0x4*(-parseInt(_0x349b23(0x1b9))/0x5)+-parseInt(_0x349b23(0x1b1))/0x6+-parseInt(_0x349b23(0x1c1))/0x7+parseInt(_0x349b23(0x1b5))/0x8+parseInt(_0x349b23(0x1c6))/0x9;if(_0x9c6886===_0x529cf6)break;else _0x5d5c0a['push'](_0x5d5c0a['shift']());}catch(_0x7574af){_0x5d5c0a['push'](_0x5d5c0a['shift']());}}}(a43_0x227d,0x39932));function a43_0xae5f(_0x5c4f9f,_0x9a2c7){const _0x227d66=a43_0x227d();return a43_0xae5f=function(_0xae5f18,_0x265b7e){_0xae5f18=_0xae5f18-0x1af;let _0x2ea277=_0x227d66[_0xae5f18];return _0x2ea277;},a43_0xae5f(_0x5c4f9f,_0x9a2c7);}var __importDefault=this&&this[a43_0x187cf0(0x1b0)]||function(_0x23322a){const _0x51a45f=a43_0x187cf0;return _0x23322a&&_0x23322a[_0x51a45f(0x1b6)]?_0x23322a:{'default':_0x23322a};};Object[a43_0x187cf0(0x1c3)](exports,a43_0x187cf0(0x1b6),{'value':!![]}),exports[a43_0x187cf0(0x1bf)]=void 0x0;const database_1=__importDefault(require('../config/database'));class IntegrationsService{[a43_0x187cf0(0x1bd)](_0x30ac1d){const _0x5e8a59=a43_0x187cf0;if(!_0x30ac1d)return[];if(Array[_0x5e8a59(0x1af)](_0x30ac1d))return _0x30ac1d;if(typeof _0x30ac1d===_0x5e8a59(0x1b4))try{const _0x1dd08c=JSON[_0x5e8a59(0x1b2)](_0x30ac1d);return Array['isArray'](_0x1dd08c)?_0x1dd08c:[];}catch{return[];}return[];}async[a43_0x187cf0(0x1c2)](_0x159d3c){const _0x5f1cab=a43_0x187cf0;await this['ensureSettingsExist'](_0x159d3c);const _0x5d4e7f=await database_1[_0x5f1cab(0x1b3)][_0x5f1cab(0x1b8)]['findUnique']({'where':{'shopId':_0x159d3c},'select':{'webhookUrl':!![],'webhookEvents':!![]}});if(!_0x5d4e7f)throw new Error(_0x5f1cab(0x1c0));return{'webhook':{'url':_0x5d4e7f[_0x5f1cab(0x1be)],'events':this['parseWebhookEvents'](_0x5d4e7f[_0x5f1cab(0x1c7)])}};}async['updateWebhookSettings'](_0x1437d4,_0x17915f){const _0x194add=a43_0x187cf0;await this[_0x194add(0x1ba)](_0x1437d4);const _0x27b2f7={};_0x17915f[_0x194add(0x1be)]!==undefined&&(_0x27b2f7[_0x194add(0x1be)]=_0x17915f['webhookUrl']||null),_0x17915f[_0x194add(0x1c7)]!==undefined&&(_0x27b2f7[_0x194add(0x1c7)]=_0x17915f[_0x194add(0x1c7)]||[]),await database_1['default'][_0x194add(0x1b8)][_0x194add(0x1c4)]({'where':{'shopId':_0x1437d4},'data':_0x27b2f7});}async[a43_0x187cf0(0x1ba)](_0x429409){const _0x43fe5f=a43_0x187cf0,_0xb22b28=await database_1[_0x43fe5f(0x1b3)][_0x43fe5f(0x1b8)]['findUnique']({'where':{'shopId':_0x429409}});!_0xb22b28&&await database_1['default'][_0x43fe5f(0x1b8)][_0x43fe5f(0x1c5)]({'data':{'shopId':_0x429409}});}}function a43_0x227d(){const _0x1f5250=['parseWebhookEvents','webhookUrl','IntegrationsService','Shop\x20settings\x20not\x20found','605738srdkDL','getIntegrations','defineProperty','update','create','4944960pANGkU','webhookEvents','2UfkoCC','isArray','__importDefault','387108RJvydV','parse','default','string','888544bmoJOd','__esModule','1007232NQmxwE','shopSettings','205725jzGCjy','ensureSettingsExist','143611MCSsBr','20ODvNaJ'];a43_0x227d=function(){return _0x1f5250;};return a43_0x227d();}exports[a43_0x187cf0(0x1bf)]=IntegrationsService;