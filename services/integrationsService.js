'use strict';function a46_0x355a(){const _0xa5f31b=['120153qqNLqH','parseWebhookEvents','update','__esModule','shopSettings','2899100llOSKj','webhookUrl','defineProperty','findUnique','parse','9849130VezHSv','1734742jPKxcK','1845iRYQaz','updateWebhookSettings','isArray','ensureSettingsExist','default','webhookEvents','24152AmvBFa','3499500KoRGTB','3IocDFx','IntegrationsService','__importDefault','Shop\x20settings\x20not\x20found','261527HIuaei','create','30fetQUG'];a46_0x355a=function(){return _0xa5f31b;};return a46_0x355a();}const a46_0x584187=a46_0x120f;(function(_0x2dda27,_0x76f867){const _0x19d858=a46_0x120f,_0x1a3eed=_0x2dda27();while(!![]){try{const _0xb2d558=-parseInt(_0x19d858(0xbc))/0x1+-parseInt(_0x19d858(0xc7))/0x2*(parseInt(_0x19d858(0xd0))/0x3)+-parseInt(_0x19d858(0xcf))/0x4+parseInt(_0x19d858(0xc1))/0x5+parseInt(_0x19d858(0xbb))/0x6*(parseInt(_0x19d858(0xb9))/0x7)+parseInt(_0x19d858(0xce))/0x8*(parseInt(_0x19d858(0xc8))/0x9)+parseInt(_0x19d858(0xc6))/0xa;if(_0xb2d558===_0x76f867)break;else _0x1a3eed['push'](_0x1a3eed['shift']());}catch(_0x4becab){_0x1a3eed['push'](_0x1a3eed['shift']());}}}(a46_0x355a,0x7c082));function a46_0x120f(_0x3e7364,_0xce99c8){const _0x355a9d=a46_0x355a();return a46_0x120f=function(_0x120fbe,_0x2afbdb){_0x120fbe=_0x120fbe-0xb7;let _0x23ea5a=_0x355a9d[_0x120fbe];return _0x23ea5a;},a46_0x120f(_0x3e7364,_0xce99c8);}var __importDefault=this&&this[a46_0x584187(0xb7)]||function(_0x19daaf){const _0x28c9bd=a46_0x584187;return _0x19daaf&&_0x19daaf[_0x28c9bd(0xbf)]?_0x19daaf:{'default':_0x19daaf};};Object[a46_0x584187(0xc3)](exports,'__esModule',{'value':!![]}),exports[a46_0x584187(0xd1)]=void 0x0;const database_1=__importDefault(require('../config/database'));class IntegrationsService{[a46_0x584187(0xbd)](_0x2e77b0){const _0x56bcb6=a46_0x584187;if(!_0x2e77b0)return[];if(Array['isArray'](_0x2e77b0))return _0x2e77b0;if(typeof _0x2e77b0==='string')try{const _0x1d07c2=JSON[_0x56bcb6(0xc5)](_0x2e77b0);return Array[_0x56bcb6(0xca)](_0x1d07c2)?_0x1d07c2:[];}catch{return[];}return[];}async['getIntegrations'](_0x2d5d09){const _0x237d49=a46_0x584187;await this[_0x237d49(0xcb)](_0x2d5d09);const _0x239dbf=await database_1['default'][_0x237d49(0xc0)][_0x237d49(0xc4)]({'where':{'shopId':_0x2d5d09},'select':{'webhookUrl':!![],'webhookEvents':!![]}});if(!_0x239dbf)throw new Error(_0x237d49(0xb8));return{'webhook':{'url':_0x239dbf['webhookUrl'],'events':this[_0x237d49(0xbd)](_0x239dbf[_0x237d49(0xcd)])}};}async[a46_0x584187(0xc9)](_0x3572af,_0x41053b){const _0x4a7a76=a46_0x584187;await this[_0x4a7a76(0xcb)](_0x3572af);const _0x3ec193={};_0x41053b[_0x4a7a76(0xc2)]!==undefined&&(_0x3ec193[_0x4a7a76(0xc2)]=_0x41053b[_0x4a7a76(0xc2)]||null),_0x41053b['webhookEvents']!==undefined&&(_0x3ec193[_0x4a7a76(0xcd)]=_0x41053b[_0x4a7a76(0xcd)]||[]),await database_1['default'][_0x4a7a76(0xc0)][_0x4a7a76(0xbe)]({'where':{'shopId':_0x3572af},'data':_0x3ec193});}async['ensureSettingsExist'](_0x217688){const _0x4fe35e=a46_0x584187,_0xb03f8f=await database_1[_0x4fe35e(0xcc)][_0x4fe35e(0xc0)]['findUnique']({'where':{'shopId':_0x217688}});!_0xb03f8f&&await database_1[_0x4fe35e(0xcc)]['shopSettings'][_0x4fe35e(0xba)]({'data':{'shopId':_0x217688}});}}exports[a46_0x584187(0xd1)]=IntegrationsService;