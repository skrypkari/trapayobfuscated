'use strict';const a47_0x3631de=a47_0x3eb0;(function(_0x50ac7a,_0x2c5d86){const _0x5bf04d=a47_0x3eb0,_0x23a33e=_0x50ac7a();while(!![]){try{const _0x3d2832=-parseInt(_0x5bf04d(0x1a4))/0x1*(parseInt(_0x5bf04d(0x1b2))/0x2)+parseInt(_0x5bf04d(0x19e))/0x3*(parseInt(_0x5bf04d(0x197))/0x4)+-parseInt(_0x5bf04d(0x19f))/0x5+-parseInt(_0x5bf04d(0x1a1))/0x6*(-parseInt(_0x5bf04d(0x1a8))/0x7)+-parseInt(_0x5bf04d(0x1ab))/0x8*(-parseInt(_0x5bf04d(0x1af))/0x9)+-parseInt(_0x5bf04d(0x19a))/0xa*(parseInt(_0x5bf04d(0x1a0))/0xb)+-parseInt(_0x5bf04d(0x199))/0xc*(-parseInt(_0x5bf04d(0x19b))/0xd);if(_0x3d2832===_0x2c5d86)break;else _0x23a33e['push'](_0x23a33e['shift']());}catch(_0x5d68b3){_0x23a33e['push'](_0x23a33e['shift']());}}}(a47_0x59ec,0x6dc2a));function a47_0x3eb0(_0x3e03e4,_0x158423){const _0x59ec5a=a47_0x59ec();return a47_0x3eb0=function(_0x3eb0ff,_0x30e92a){_0x3eb0ff=_0x3eb0ff-0x197;let _0x99325f=_0x59ec5a[_0x3eb0ff];return _0x99325f;},a47_0x3eb0(_0x3e03e4,_0x158423);}var __importDefault=this&&this[a47_0x3631de(0x1a7)]||function(_0x2a9ad8){const _0x19f47a=a47_0x3631de;return _0x2a9ad8&&_0x2a9ad8[_0x19f47a(0x1ae)]?_0x2a9ad8:{'default':_0x2a9ad8};};Object[a47_0x3631de(0x1b3)](exports,'__esModule',{'value':!![]}),exports[a47_0x3631de(0x1a6)]=void 0x0;const database_1=__importDefault(require(a47_0x3631de(0x19d)));function a47_0x59ec(){const _0x39d510=['findUnique','1psISwF','webhookUrl','IntegrationsService','__importDefault','7Fxrogl','create','update','23752RYNZOd','isArray','ensureSettingsExist','__esModule','2592HeENBW','webhookEvents','shopSettings','999446mbIecP','defineProperty','parse','updateWebhookSettings','parseWebhookEvents','4enheMm','getIntegrations','27696OvehrL','10ixNPGx','312BrLpIJ','default','../config/database','938421GtCdMU','1022090EqDVzY','3762187UkisNe','1634790oUFmyS','string'];a47_0x59ec=function(){return _0x39d510;};return a47_0x59ec();}class IntegrationsService{[a47_0x3631de(0x1b6)](_0x2c6f2d){const _0x431f97=a47_0x3631de;if(!_0x2c6f2d)return[];if(Array[_0x431f97(0x1ac)](_0x2c6f2d))return _0x2c6f2d;if(typeof _0x2c6f2d===_0x431f97(0x1a2))try{const _0x406fa5=JSON[_0x431f97(0x1b4)](_0x2c6f2d);return Array[_0x431f97(0x1ac)](_0x406fa5)?_0x406fa5:[];}catch{return[];}return[];}async[a47_0x3631de(0x198)](_0x4a0c95){const _0x3aa282=a47_0x3631de;await this[_0x3aa282(0x1ad)](_0x4a0c95);const _0x5df202=await database_1['default'][_0x3aa282(0x1b1)][_0x3aa282(0x1a3)]({'where':{'shopId':_0x4a0c95},'select':{'webhookUrl':!![],'webhookEvents':!![]}});if(!_0x5df202)throw new Error('Shop\x20settings\x20not\x20found');return{'webhook':{'url':_0x5df202[_0x3aa282(0x1a5)],'events':this[_0x3aa282(0x1b6)](_0x5df202[_0x3aa282(0x1b0)])}};}async[a47_0x3631de(0x1b5)](_0x53c7ff,_0x1776a5){const _0x137a77=a47_0x3631de;await this['ensureSettingsExist'](_0x53c7ff);const _0x109de3={};_0x1776a5[_0x137a77(0x1a5)]!==undefined&&(_0x109de3['webhookUrl']=_0x1776a5[_0x137a77(0x1a5)]||null),_0x1776a5['webhookEvents']!==undefined&&(_0x109de3[_0x137a77(0x1b0)]=_0x1776a5[_0x137a77(0x1b0)]||[]),await database_1['default'][_0x137a77(0x1b1)][_0x137a77(0x1aa)]({'where':{'shopId':_0x53c7ff},'data':_0x109de3});}async[a47_0x3631de(0x1ad)](_0x4e2be3){const _0x1285e0=a47_0x3631de,_0x43bbf6=await database_1[_0x1285e0(0x19c)][_0x1285e0(0x1b1)]['findUnique']({'where':{'shopId':_0x4e2be3}});!_0x43bbf6&&await database_1[_0x1285e0(0x19c)]['shopSettings'][_0x1285e0(0x1a9)]({'data':{'shopId':_0x4e2be3}});}}exports[a47_0x3631de(0x1a6)]=IntegrationsService;