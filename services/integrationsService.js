'use strict';const a55_0x1bb9cd=a55_0x4b00;function a55_0xaa5c(){const _0x57efac=['404961OvZzjU','15HyEXnP','155802BbXfgY','173148jwXxbB','24UNrSJo','ensureSettingsExist','parseWebhookEvents','update','570267RHWGkz','default','__esModule','280320CgaDFY','../config/database','isArray','webhookUrl','defineProperty','Shop\x20settings\x20not\x20found','webhookEvents','22AAjCfL','shopSettings','__importDefault','43206upeuAA','findUnique','create','856090ierBke','119eFPowH'];a55_0xaa5c=function(){return _0x57efac;};return a55_0xaa5c();}(function(_0x47a4ec,_0x2812c6){const _0x3de3f0=a55_0x4b00,_0x36ed56=_0x47a4ec();while(!![]){try{const _0x52c087=parseInt(_0x3de3f0(0xb7))/0x1+-parseInt(_0x3de3f0(0xc0))/0x2+-parseInt(_0x3de3f0(0xb5))/0x3+parseInt(_0x3de3f0(0xb8))/0x4*(parseInt(_0x3de3f0(0xb6))/0x5)+-parseInt(_0x3de3f0(0xca))/0x6*(-parseInt(_0x3de3f0(0xb4))/0x7)+-parseInt(_0x3de3f0(0xb9))/0x8*(parseInt(_0x3de3f0(0xbd))/0x9)+-parseInt(_0x3de3f0(0xb3))/0xa*(-parseInt(_0x3de3f0(0xc7))/0xb);if(_0x52c087===_0x2812c6)break;else _0x36ed56['push'](_0x36ed56['shift']());}catch(_0x592131){_0x36ed56['push'](_0x36ed56['shift']());}}}(a55_0xaa5c,0x1bd8e));function a55_0x4b00(_0x542d32,_0x4e09a2){const _0xaa5c8c=a55_0xaa5c();return a55_0x4b00=function(_0x4b00e8,_0x3cb7d8){_0x4b00e8=_0x4b00e8-0xb3;let _0x4857fe=_0xaa5c8c[_0x4b00e8];return _0x4857fe;},a55_0x4b00(_0x542d32,_0x4e09a2);}var __importDefault=this&&this[a55_0x1bb9cd(0xc9)]||function(_0x378917){const _0x2f5d44=a55_0x1bb9cd;return _0x378917&&_0x378917[_0x2f5d44(0xbf)]?_0x378917:{'default':_0x378917};};Object[a55_0x1bb9cd(0xc4)](exports,a55_0x1bb9cd(0xbf),{'value':!![]}),exports['IntegrationsService']=void 0x0;const database_1=__importDefault(require(a55_0x1bb9cd(0xc1)));class IntegrationsService{[a55_0x1bb9cd(0xbb)](_0x41f60f){const _0x58b60e=a55_0x1bb9cd;if(!_0x41f60f)return[];if(Array[_0x58b60e(0xc2)](_0x41f60f))return _0x41f60f;if(typeof _0x41f60f==='string')try{const _0x5bc53d=JSON['parse'](_0x41f60f);return Array[_0x58b60e(0xc2)](_0x5bc53d)?_0x5bc53d:[];}catch{return[];}return[];}async['getIntegrations'](_0x49d9d9){const _0x2b27cb=a55_0x1bb9cd;await this[_0x2b27cb(0xba)](_0x49d9d9);const _0xa01f15=await database_1['default']['shopSettings']['findUnique']({'where':{'shopId':_0x49d9d9},'select':{'webhookUrl':!![],'webhookEvents':!![]}});if(!_0xa01f15)throw new Error(_0x2b27cb(0xc5));return{'webhook':{'url':_0xa01f15[_0x2b27cb(0xc3)],'events':this[_0x2b27cb(0xbb)](_0xa01f15[_0x2b27cb(0xc6)])}};}async['updateWebhookSettings'](_0x4fa9bd,_0x1ce864){const _0x5069b5=a55_0x1bb9cd;await this[_0x5069b5(0xba)](_0x4fa9bd);const _0x34b983={};_0x1ce864[_0x5069b5(0xc3)]!==undefined&&(_0x34b983[_0x5069b5(0xc3)]=_0x1ce864['webhookUrl']||null),_0x1ce864[_0x5069b5(0xc6)]!==undefined&&(_0x34b983['webhookEvents']=_0x1ce864['webhookEvents']||[]),await database_1[_0x5069b5(0xbe)][_0x5069b5(0xc8)][_0x5069b5(0xbc)]({'where':{'shopId':_0x4fa9bd},'data':_0x34b983});}async[a55_0x1bb9cd(0xba)](_0x40cb78){const _0x5b4b26=a55_0x1bb9cd,_0x42e37d=await database_1['default'][_0x5b4b26(0xc8)][_0x5b4b26(0xcb)]({'where':{'shopId':_0x40cb78}});!_0x42e37d&&await database_1[_0x5b4b26(0xbe)]['shopSettings'][_0x5b4b26(0xcc)]({'data':{'shopId':_0x40cb78}});}}exports['IntegrationsService']=IntegrationsService;