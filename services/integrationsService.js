'use strict';const a46_0x586e69=a46_0x8243;(function(_0xd9c5db,_0x42b2d9){const _0x53121d=a46_0x8243,_0x4b7b46=_0xd9c5db();while(!![]){try{const _0x4d7521=parseInt(_0x53121d(0x187))/0x1+parseInt(_0x53121d(0x173))/0x2+-parseInt(_0x53121d(0x17d))/0x3+parseInt(_0x53121d(0x174))/0x4+parseInt(_0x53121d(0x17e))/0x5+parseInt(_0x53121d(0x18a))/0x6*(-parseInt(_0x53121d(0x17a))/0x7)+-parseInt(_0x53121d(0x17b))/0x8;if(_0x4d7521===_0x42b2d9)break;else _0x4b7b46['push'](_0x4b7b46['shift']());}catch(_0xe12dda){_0x4b7b46['push'](_0x4b7b46['shift']());}}}(a46_0x278c,0xdb69a));var __importDefault=this&&this['__importDefault']||function(_0x1287c1){const _0x4a3065=a46_0x8243;return _0x1287c1&&_0x1287c1[_0x4a3065(0x182)]?_0x1287c1:{'default':_0x1287c1};};function a46_0x8243(_0x59fd9a,_0x652af8){const _0x278c28=a46_0x278c();return a46_0x8243=function(_0x824305,_0x32adff){_0x824305=_0x824305-0x173;let _0x277481=_0x278c28[_0x824305];return _0x277481;},a46_0x8243(_0x59fd9a,_0x652af8);}function a46_0x278c(){const _0x49fb86=['../config/database','759703VuFCRk','4873560LbejIL','default','882351zlwyEl','3422135cSuqlj','create','getIntegrations','ensureSettingsExist','__esModule','shopSettings','IntegrationsService','parseWebhookEvents','webhookUrl','1078698Puoblb','Shop\x20settings\x20not\x20found','findUnique','30epWFkX','defineProperty','1002050PdFKJk','322084IcLmTp','updateWebhookSettings','update','webhookEvents','isArray'];a46_0x278c=function(){return _0x49fb86;};return a46_0x278c();}Object[a46_0x586e69(0x18b)](exports,'__esModule',{'value':!![]}),exports[a46_0x586e69(0x184)]=void 0x0;const database_1=__importDefault(require(a46_0x586e69(0x179)));class IntegrationsService{['parseWebhookEvents'](_0xafdc8){const _0x1ef6ab=a46_0x586e69;if(!_0xafdc8)return[];if(Array[_0x1ef6ab(0x178)](_0xafdc8))return _0xafdc8;if(typeof _0xafdc8==='string')try{const _0xd512ab=JSON['parse'](_0xafdc8);return Array[_0x1ef6ab(0x178)](_0xd512ab)?_0xd512ab:[];}catch{return[];}return[];}async[a46_0x586e69(0x180)](_0x38be5a){const _0x40020d=a46_0x586e69;await this['ensureSettingsExist'](_0x38be5a);const _0x4e61c1=await database_1[_0x40020d(0x17c)][_0x40020d(0x183)][_0x40020d(0x189)]({'where':{'shopId':_0x38be5a},'select':{'webhookUrl':!![],'webhookEvents':!![]}});if(!_0x4e61c1)throw new Error(_0x40020d(0x188));return{'webhook':{'url':_0x4e61c1[_0x40020d(0x186)],'events':this[_0x40020d(0x185)](_0x4e61c1[_0x40020d(0x177)])}};}async[a46_0x586e69(0x175)](_0x40ddd7,_0x5059f5){const _0x5e3b18=a46_0x586e69;await this[_0x5e3b18(0x181)](_0x40ddd7);const _0x2133ac={};_0x5059f5[_0x5e3b18(0x186)]!==undefined&&(_0x2133ac[_0x5e3b18(0x186)]=_0x5059f5[_0x5e3b18(0x186)]||null),_0x5059f5[_0x5e3b18(0x177)]!==undefined&&(_0x2133ac[_0x5e3b18(0x177)]=_0x5059f5[_0x5e3b18(0x177)]||[]),await database_1['default'][_0x5e3b18(0x183)][_0x5e3b18(0x176)]({'where':{'shopId':_0x40ddd7},'data':_0x2133ac});}async[a46_0x586e69(0x181)](_0x21b1c8){const _0x296a34=a46_0x586e69,_0xa90281=await database_1['default'][_0x296a34(0x183)][_0x296a34(0x189)]({'where':{'shopId':_0x21b1c8}});!_0xa90281&&await database_1['default'][_0x296a34(0x183)][_0x296a34(0x17f)]({'data':{'shopId':_0x21b1c8}});}}exports[a46_0x586e69(0x184)]=IntegrationsService;