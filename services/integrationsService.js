'use strict';const a43_0x321c4d=a43_0x5b37;function a43_0x5b37(_0x50540f,_0x46e23b){const _0x3d4cef=a43_0x3d4c();return a43_0x5b37=function(_0x5b3709,_0x3041fc){_0x5b3709=_0x5b3709-0xca;let _0x2452a3=_0x3d4cef[_0x5b3709];return _0x2452a3;},a43_0x5b37(_0x50540f,_0x46e23b);}(function(_0x5cab2c,_0x3e1cf3){const _0xcdeb33=a43_0x5b37,_0x2012d5=_0x5cab2c();while(!![]){try{const _0x1dd99d=parseInt(_0xcdeb33(0xcb))/0x1+parseInt(_0xcdeb33(0xd7))/0x2+-parseInt(_0xcdeb33(0xd6))/0x3*(parseInt(_0xcdeb33(0xda))/0x4)+parseInt(_0xcdeb33(0xdc))/0x5+-parseInt(_0xcdeb33(0xe3))/0x6*(parseInt(_0xcdeb33(0xca))/0x7)+-parseInt(_0xcdeb33(0xe0))/0x8*(parseInt(_0xcdeb33(0xce))/0x9)+parseInt(_0xcdeb33(0xe1))/0xa*(parseInt(_0xcdeb33(0xe2))/0xb);if(_0x1dd99d===_0x3e1cf3)break;else _0x2012d5['push'](_0x2012d5['shift']());}catch(_0x5ea8d4){_0x2012d5['push'](_0x2012d5['shift']());}}}(a43_0x3d4c,0x6ce78));var __importDefault=this&&this['__importDefault']||function(_0x10f2ca){const _0x3a1a69=a43_0x5b37;return _0x10f2ca&&_0x10f2ca[_0x3a1a69(0xd0)]?_0x10f2ca:{'default':_0x10f2ca};};Object['defineProperty'](exports,a43_0x321c4d(0xd0),{'value':!![]}),exports[a43_0x321c4d(0xcf)]=void 0x0;const database_1=__importDefault(require(a43_0x321c4d(0xd2)));class IntegrationsService{['parseWebhookEvents'](_0x17e732){const _0x2faa58=a43_0x321c4d;if(!_0x17e732)return[];if(Array[_0x2faa58(0xcc)](_0x17e732))return _0x17e732;if(typeof _0x17e732===_0x2faa58(0xdd))try{const _0x52a41c=JSON[_0x2faa58(0xd1)](_0x17e732);return Array[_0x2faa58(0xcc)](_0x52a41c)?_0x52a41c:[];}catch{return[];}return[];}async[a43_0x321c4d(0xcd)](_0x640ef3){const _0x4c8675=a43_0x321c4d;await this[_0x4c8675(0xe4)](_0x640ef3);const _0x4a14c4=await database_1[_0x4c8675(0xdb)][_0x4c8675(0xd3)][_0x4c8675(0xd8)]({'where':{'shopId':_0x640ef3},'select':{'webhookUrl':!![],'webhookEvents':!![]}});if(!_0x4a14c4)throw new Error(_0x4c8675(0xd5));return{'webhook':{'url':_0x4a14c4[_0x4c8675(0xde)],'events':this[_0x4c8675(0xdf)](_0x4a14c4['webhookEvents'])}};}async['updateWebhookSettings'](_0xdf39fd,_0x454bbc){const _0x5c212e=a43_0x321c4d;await this[_0x5c212e(0xe4)](_0xdf39fd);const _0x6adee5={};_0x454bbc['webhookUrl']!==undefined&&(_0x6adee5['webhookUrl']=_0x454bbc['webhookUrl']||null),_0x454bbc[_0x5c212e(0xd9)]!==undefined&&(_0x6adee5[_0x5c212e(0xd9)]=_0x454bbc[_0x5c212e(0xd9)]||[]),await database_1[_0x5c212e(0xdb)]['shopSettings']['update']({'where':{'shopId':_0xdf39fd},'data':_0x6adee5});}async[a43_0x321c4d(0xe4)](_0x33ae04){const _0x25f767=a43_0x321c4d,_0x434550=await database_1['default']['shopSettings'][_0x25f767(0xd8)]({'where':{'shopId':_0x33ae04}});!_0x434550&&await database_1['default'][_0x25f767(0xd3)][_0x25f767(0xd4)]({'data':{'shopId':_0x33ae04}});}}function a43_0x3d4c(){const _0x4fbc6e=['54TjxvpM','ensureSettingsExist','522739HiWcvJ','600841vxHiwz','isArray','getIntegrations','9pXfuhc','IntegrationsService','__esModule','parse','../config/database','shopSettings','create','Shop\x20settings\x20not\x20found','60yqrAAK','618176iRhOGM','findUnique','webhookEvents','14548kEAaAn','default','1605470sOVhio','string','webhookUrl','parseWebhookEvents','3637880nuQvzl','4146170FIzkml','11cyfplF'];a43_0x3d4c=function(){return _0x4fbc6e;};return a43_0x3d4c();}exports[a43_0x321c4d(0xcf)]=IntegrationsService;