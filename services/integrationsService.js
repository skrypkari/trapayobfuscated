'use strict';function a47_0x1fb6(){const _0x13f07e=['15oswfEf','8397IkYgCr','139078zgqOds','create','update','parseWebhookEvents','19610PYViyq','isArray','824313WlKgRe','1088TXQmPt','841099XorPCF','default','webhookUrl','339966QFaqvU','string','findUnique','__esModule','shopSettings','IntegrationsService','updateWebhookSettings','parse','ensureSettingsExist','defineProperty','1YNkXPp','webhookEvents','Shop\x20settings\x20not\x20found','../config/database','128080MYrIZj','1397oRvKnT'];a47_0x1fb6=function(){return _0x13f07e;};return a47_0x1fb6();}const a47_0x5d6bc2=a47_0x13a1;(function(_0x45b45b,_0x31af36){const _0x276309=a47_0x13a1,_0x565216=_0x45b45b();while(!![]){try{const _0x122bfa=parseInt(_0x276309(0x1cb))/0x1*(parseInt(_0x276309(0x1d3))/0x2)+-parseInt(_0x276309(0x1d9))/0x3+-parseInt(_0x276309(0x1cf))/0x4*(-parseInt(_0x276309(0x1d1))/0x5)+parseInt(_0x276309(0x1c1))/0x6+-parseInt(_0x276309(0x1db))/0x7+-parseInt(_0x276309(0x1da))/0x8*(-parseInt(_0x276309(0x1d2))/0x9)+-parseInt(_0x276309(0x1d7))/0xa*(-parseInt(_0x276309(0x1d0))/0xb);if(_0x122bfa===_0x31af36)break;else _0x565216['push'](_0x565216['shift']());}catch(_0x5438e9){_0x565216['push'](_0x565216['shift']());}}}(a47_0x1fb6,0x31a03));var __importDefault=this&&this['__importDefault']||function(_0x47d70e){const _0x501660=a47_0x13a1;return _0x47d70e&&_0x47d70e[_0x501660(0x1c4)]?_0x47d70e:{'default':_0x47d70e};};Object[a47_0x5d6bc2(0x1ca)](exports,'__esModule',{'value':!![]}),exports[a47_0x5d6bc2(0x1c6)]=void 0x0;function a47_0x13a1(_0xcbeb2f,_0x267611){const _0x1fb64d=a47_0x1fb6();return a47_0x13a1=function(_0x13a1bf,_0x464c1b){_0x13a1bf=_0x13a1bf-0x1bf;let _0x1ded9b=_0x1fb64d[_0x13a1bf];return _0x1ded9b;},a47_0x13a1(_0xcbeb2f,_0x267611);}const database_1=__importDefault(require(a47_0x5d6bc2(0x1ce)));class IntegrationsService{['parseWebhookEvents'](_0x270552){const _0x3ab521=a47_0x5d6bc2;if(!_0x270552)return[];if(Array[_0x3ab521(0x1d8)](_0x270552))return _0x270552;if(typeof _0x270552===_0x3ab521(0x1c2))try{const _0x3204fc=JSON[_0x3ab521(0x1c8)](_0x270552);return Array['isArray'](_0x3204fc)?_0x3204fc:[];}catch{return[];}return[];}async['getIntegrations'](_0x4e5621){const _0x586878=a47_0x5d6bc2;await this[_0x586878(0x1c9)](_0x4e5621);const _0x1a09a1=await database_1[_0x586878(0x1bf)][_0x586878(0x1c5)][_0x586878(0x1c3)]({'where':{'shopId':_0x4e5621},'select':{'webhookUrl':!![],'webhookEvents':!![]}});if(!_0x1a09a1)throw new Error(_0x586878(0x1cd));return{'webhook':{'url':_0x1a09a1[_0x586878(0x1c0)],'events':this[_0x586878(0x1d6)](_0x1a09a1[_0x586878(0x1cc)])}};}async[a47_0x5d6bc2(0x1c7)](_0x380c12,_0x38c27a){const _0x105e9c=a47_0x5d6bc2;await this['ensureSettingsExist'](_0x380c12);const _0x4e132f={};_0x38c27a[_0x105e9c(0x1c0)]!==undefined&&(_0x4e132f[_0x105e9c(0x1c0)]=_0x38c27a[_0x105e9c(0x1c0)]||null),_0x38c27a[_0x105e9c(0x1cc)]!==undefined&&(_0x4e132f[_0x105e9c(0x1cc)]=_0x38c27a[_0x105e9c(0x1cc)]||[]),await database_1['default'][_0x105e9c(0x1c5)][_0x105e9c(0x1d5)]({'where':{'shopId':_0x380c12},'data':_0x4e132f});}async['ensureSettingsExist'](_0x466781){const _0x2847d5=a47_0x5d6bc2,_0x15bfe6=await database_1[_0x2847d5(0x1bf)][_0x2847d5(0x1c5)][_0x2847d5(0x1c3)]({'where':{'shopId':_0x466781}});!_0x15bfe6&&await database_1[_0x2847d5(0x1bf)][_0x2847d5(0x1c5)][_0x2847d5(0x1d4)]({'data':{'shopId':_0x466781}});}}exports['IntegrationsService']=IntegrationsService;