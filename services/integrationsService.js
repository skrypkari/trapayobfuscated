'use strict';const a47_0x4a9336=a47_0x3b78;function a47_0x1a12(){const _0x2af7ab=['string','isArray','375508dhTjGU','Shop\x20settings\x20not\x20found','__esModule','ensureSettingsExist','2392860DLLLmC','create','10drWZWY','webhookEvents','1647012NSYRDQ','9eRBaUJ','IntegrationsService','2lNcXhQ','getIntegrations','parse','parseWebhookEvents','findUnique','496420GZVvjy','12oQHLWI','8EtELiC','3619091wObPJD','24201265JQPknv','default','804804faFqiq','defineProperty','webhookUrl','updateWebhookSettings','shopSettings'];a47_0x1a12=function(){return _0x2af7ab;};return a47_0x1a12();}(function(_0x358088,_0x297fe4){const _0x180da5=a47_0x3b78,_0x270536=_0x358088();while(!![]){try{const _0x4adfc3=parseInt(_0x180da5(0x11f))/0x1*(-parseInt(_0x180da5(0x11a))/0x2)+-parseInt(_0x180da5(0x125))/0x3+-parseInt(_0x180da5(0x12c))/0x4+-parseInt(_0x180da5(0x132))/0x5*(parseInt(_0x180da5(0x134))/0x6)+-parseInt(_0x180da5(0x122))/0x7*(parseInt(_0x180da5(0x121))/0x8)+parseInt(_0x180da5(0x135))/0x9*(parseInt(_0x180da5(0x130))/0xa)+parseInt(_0x180da5(0x123))/0xb*(parseInt(_0x180da5(0x120))/0xc);if(_0x4adfc3===_0x297fe4)break;else _0x270536['push'](_0x270536['shift']());}catch(_0x443f40){_0x270536['push'](_0x270536['shift']());}}}(a47_0x1a12,0x7db03));var __importDefault=this&&this['__importDefault']||function(_0x391903){const _0x50bccf=a47_0x3b78;return _0x391903&&_0x391903[_0x50bccf(0x12e)]?_0x391903:{'default':_0x391903};};Object[a47_0x4a9336(0x126)](exports,a47_0x4a9336(0x12e),{'value':!![]}),exports[a47_0x4a9336(0x136)]=void 0x0;function a47_0x3b78(_0xb1c825,_0xc9bcac){const _0x1a128a=a47_0x1a12();return a47_0x3b78=function(_0x3b7854,_0xb176e9){_0x3b7854=_0x3b7854-0x11a;let _0x293890=_0x1a128a[_0x3b7854];return _0x293890;},a47_0x3b78(_0xb1c825,_0xc9bcac);}const database_1=__importDefault(require('../config/database'));class IntegrationsService{[a47_0x4a9336(0x11d)](_0x58e965){const _0x423677=a47_0x4a9336;if(!_0x58e965)return[];if(Array['isArray'](_0x58e965))return _0x58e965;if(typeof _0x58e965===_0x423677(0x12a))try{const _0x2b4134=JSON[_0x423677(0x11c)](_0x58e965);return Array[_0x423677(0x12b)](_0x2b4134)?_0x2b4134:[];}catch{return[];}return[];}async[a47_0x4a9336(0x11b)](_0x5553fc){const _0x405739=a47_0x4a9336;await this[_0x405739(0x12f)](_0x5553fc);const _0x3c1d96=await database_1[_0x405739(0x124)]['shopSettings'][_0x405739(0x11e)]({'where':{'shopId':_0x5553fc},'select':{'webhookUrl':!![],'webhookEvents':!![]}});if(!_0x3c1d96)throw new Error(_0x405739(0x12d));return{'webhook':{'url':_0x3c1d96[_0x405739(0x127)],'events':this[_0x405739(0x11d)](_0x3c1d96[_0x405739(0x133)])}};}async[a47_0x4a9336(0x128)](_0x5be580,_0x355710){const _0x343ad5=a47_0x4a9336;await this[_0x343ad5(0x12f)](_0x5be580);const _0x44313c={};_0x355710[_0x343ad5(0x127)]!==undefined&&(_0x44313c[_0x343ad5(0x127)]=_0x355710[_0x343ad5(0x127)]||null),_0x355710[_0x343ad5(0x133)]!==undefined&&(_0x44313c[_0x343ad5(0x133)]=_0x355710[_0x343ad5(0x133)]||[]),await database_1[_0x343ad5(0x124)]['shopSettings']['update']({'where':{'shopId':_0x5be580},'data':_0x44313c});}async['ensureSettingsExist'](_0x2bc043){const _0x1df2aa=a47_0x4a9336,_0x474f2d=await database_1[_0x1df2aa(0x124)][_0x1df2aa(0x129)][_0x1df2aa(0x11e)]({'where':{'shopId':_0x2bc043}});!_0x474f2d&&await database_1['default'][_0x1df2aa(0x129)][_0x1df2aa(0x131)]({'data':{'shopId':_0x2bc043}});}}exports[a47_0x4a9336(0x136)]=IntegrationsService;