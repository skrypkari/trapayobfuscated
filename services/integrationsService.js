'use strict';const a58_0x164ee6=a58_0x40c1;function a58_0x40c1(_0x5a6d91,_0x14b544){const _0x5d7b92=a58_0x5d7b();return a58_0x40c1=function(_0x40c18f,_0x1fcb71){_0x40c18f=_0x40c18f-0x65;let _0x162e86=_0x5d7b92[_0x40c18f];return _0x162e86;},a58_0x40c1(_0x5a6d91,_0x14b544);}(function(_0x5d7a75,_0x27271d){const _0x4e6266=a58_0x40c1,_0x27ffec=_0x5d7a75();while(!![]){try{const _0x91bbf8=parseInt(_0x4e6266(0x75))/0x1+parseInt(_0x4e6266(0x7b))/0x2*(parseInt(_0x4e6266(0x6c))/0x3)+parseInt(_0x4e6266(0x79))/0x4*(parseInt(_0x4e6266(0x6a))/0x5)+-parseInt(_0x4e6266(0x6d))/0x6+-parseInt(_0x4e6266(0x80))/0x7*(parseInt(_0x4e6266(0x7e))/0x8)+-parseInt(_0x4e6266(0x6e))/0x9*(-parseInt(_0x4e6266(0x73))/0xa)+-parseInt(_0x4e6266(0x6f))/0xb*(parseInt(_0x4e6266(0x69))/0xc);if(_0x91bbf8===_0x27271d)break;else _0x27ffec['push'](_0x27ffec['shift']());}catch(_0xdae060){_0x27ffec['push'](_0x27ffec['shift']());}}}(a58_0x5d7b,0xac208));function a58_0x5d7b(){const _0x2ad8b6=['Shop\x20settings\x20not\x20found','default','132460sMgwgM','update','594bPYGpT','defineProperty','webhookEvents','858136dLGSBY','__esModule','56ggCyVM','findUnique','__importDefault','getIntegrations','webhookUrl','IntegrationsService','12jSPoGL','130ukEtmn','updateWebhookSettings','12303OzILSg','3432126hqgahN','90DwYcFg','13453011sHLJAj','isArray','ensureSettingsExist','shopSettings','846770SJxJMn','parseWebhookEvents','432433vMdzOD','parse'];a58_0x5d7b=function(){return _0x2ad8b6;};return a58_0x5d7b();}var __importDefault=this&&this[a58_0x164ee6(0x65)]||function(_0x3a564a){const _0x29d416=a58_0x164ee6;return _0x3a564a&&_0x3a564a[_0x29d416(0x7f)]?_0x3a564a:{'default':_0x3a564a};};Object[a58_0x164ee6(0x7c)](exports,a58_0x164ee6(0x7f),{'value':!![]}),exports['IntegrationsService']=void 0x0;const database_1=__importDefault(require('../config/database'));class IntegrationsService{[a58_0x164ee6(0x74)](_0x12c580){const _0x412563=a58_0x164ee6;if(!_0x12c580)return[];if(Array[_0x412563(0x70)](_0x12c580))return _0x12c580;if(typeof _0x12c580==='string')try{const _0x30e11f=JSON[_0x412563(0x76)](_0x12c580);return Array[_0x412563(0x70)](_0x30e11f)?_0x30e11f:[];}catch{return[];}return[];}async[a58_0x164ee6(0x66)](_0x4546d8){const _0x49716c=a58_0x164ee6;await this[_0x49716c(0x71)](_0x4546d8);const _0xc6b86b=await database_1[_0x49716c(0x78)][_0x49716c(0x72)][_0x49716c(0x81)]({'where':{'shopId':_0x4546d8},'select':{'webhookUrl':!![],'webhookEvents':!![]}});if(!_0xc6b86b)throw new Error(_0x49716c(0x77));return{'webhook':{'url':_0xc6b86b['webhookUrl'],'events':this[_0x49716c(0x74)](_0xc6b86b[_0x49716c(0x7d)])}};}async[a58_0x164ee6(0x6b)](_0x5c7836,_0x534cd8){const _0x2340f5=a58_0x164ee6;await this[_0x2340f5(0x71)](_0x5c7836);const _0x995c82={};_0x534cd8[_0x2340f5(0x67)]!==undefined&&(_0x995c82[_0x2340f5(0x67)]=_0x534cd8['webhookUrl']||null),_0x534cd8[_0x2340f5(0x7d)]!==undefined&&(_0x995c82[_0x2340f5(0x7d)]=_0x534cd8['webhookEvents']||[]),await database_1[_0x2340f5(0x78)]['shopSettings'][_0x2340f5(0x7a)]({'where':{'shopId':_0x5c7836},'data':_0x995c82});}async['ensureSettingsExist'](_0x27bb8e){const _0x69fe7f=a58_0x164ee6,_0x474cb0=await database_1['default'][_0x69fe7f(0x72)]['findUnique']({'where':{'shopId':_0x27bb8e}});!_0x474cb0&&await database_1[_0x69fe7f(0x78)][_0x69fe7f(0x72)]['create']({'data':{'shopId':_0x27bb8e}});}}exports[a58_0x164ee6(0x68)]=IntegrationsService;