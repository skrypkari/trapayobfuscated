'use strict';const a48_0x13c317=a48_0x4772;(function(_0x12ae88,_0x136678){const _0x5408df=a48_0x4772,_0x4af7c4=_0x12ae88();while(!![]){try{const _0x48cce3=parseInt(_0x5408df(0x12b))/0x1*(parseInt(_0x5408df(0x113))/0x2)+-parseInt(_0x5408df(0x11f))/0x3*(parseInt(_0x5408df(0x11a))/0x4)+parseInt(_0x5408df(0x12c))/0x5+parseInt(_0x5408df(0x117))/0x6+parseInt(_0x5408df(0x126))/0x7+parseInt(_0x5408df(0x114))/0x8*(parseInt(_0x5408df(0x11c))/0x9)+-parseInt(_0x5408df(0x122))/0xa*(parseInt(_0x5408df(0x129))/0xb);if(_0x48cce3===_0x136678)break;else _0x4af7c4['push'](_0x4af7c4['shift']());}catch(_0xc2a471){_0x4af7c4['push'](_0x4af7c4['shift']());}}}(a48_0xc1b7,0x5b671));function a48_0xc1b7(){const _0x16fce4=['webhookUrl','3WfAmVD','parseWebhookEvents','webhookEvents','11420yvIFHl','../config/database','__importDefault','parse','5231373gNnmtI','isArray','__esModule','20603RvxDxv','shopSettings','2ieqPvj','3738330qycHln','defineProperty','632542ywuuCD','1376gPAgay','default','IntegrationsService','333162ycqAqa','findUnique','update','699548ZWOgyu','ensureSettingsExist','26433BFiKme','create'];a48_0xc1b7=function(){return _0x16fce4;};return a48_0xc1b7();}var __importDefault=this&&this[a48_0x13c317(0x124)]||function(_0x4353d8){const _0x230fbc=a48_0x13c317;return _0x4353d8&&_0x4353d8[_0x230fbc(0x128)]?_0x4353d8:{'default':_0x4353d8};};function a48_0x4772(_0x487f35,_0x1c1975){const _0xc1b771=a48_0xc1b7();return a48_0x4772=function(_0x477212,_0x2d9994){_0x477212=_0x477212-0x112;let _0x2eae0b=_0xc1b771[_0x477212];return _0x2eae0b;},a48_0x4772(_0x487f35,_0x1c1975);}Object[a48_0x13c317(0x112)](exports,'__esModule',{'value':!![]}),exports[a48_0x13c317(0x116)]=void 0x0;const database_1=__importDefault(require(a48_0x13c317(0x123)));class IntegrationsService{[a48_0x13c317(0x120)](_0x11a08){const _0x5c7efc=a48_0x13c317;if(!_0x11a08)return[];if(Array[_0x5c7efc(0x127)](_0x11a08))return _0x11a08;if(typeof _0x11a08==='string')try{const _0x15cdba=JSON[_0x5c7efc(0x125)](_0x11a08);return Array[_0x5c7efc(0x127)](_0x15cdba)?_0x15cdba:[];}catch{return[];}return[];}async['getIntegrations'](_0x19493c){const _0x44bc1a=a48_0x13c317;await this[_0x44bc1a(0x11b)](_0x19493c);const _0x355969=await database_1[_0x44bc1a(0x115)]['shopSettings'][_0x44bc1a(0x118)]({'where':{'shopId':_0x19493c},'select':{'webhookUrl':!![],'webhookEvents':!![]}});if(!_0x355969)throw new Error('Shop\x20settings\x20not\x20found');return{'webhook':{'url':_0x355969[_0x44bc1a(0x11e)],'events':this[_0x44bc1a(0x120)](_0x355969[_0x44bc1a(0x121)])}};}async['updateWebhookSettings'](_0x1cc128,_0x3f6b00){const _0xb7863e=a48_0x13c317;await this[_0xb7863e(0x11b)](_0x1cc128);const _0x3d4df5={};_0x3f6b00[_0xb7863e(0x11e)]!==undefined&&(_0x3d4df5[_0xb7863e(0x11e)]=_0x3f6b00[_0xb7863e(0x11e)]||null),_0x3f6b00['webhookEvents']!==undefined&&(_0x3d4df5[_0xb7863e(0x121)]=_0x3f6b00[_0xb7863e(0x121)]||[]),await database_1[_0xb7863e(0x115)]['shopSettings'][_0xb7863e(0x119)]({'where':{'shopId':_0x1cc128},'data':_0x3d4df5});}async[a48_0x13c317(0x11b)](_0x3dbccf){const _0x4853cf=a48_0x13c317,_0x565727=await database_1[_0x4853cf(0x115)]['shopSettings'][_0x4853cf(0x118)]({'where':{'shopId':_0x3dbccf}});!_0x565727&&await database_1[_0x4853cf(0x115)][_0x4853cf(0x12a)][_0x4853cf(0x11d)]({'data':{'shopId':_0x3dbccf}});}}exports[a48_0x13c317(0x116)]=IntegrationsService;