'use strict';function a43_0x59d9(){const _0xd95860=['parse','webhookEvents','18sWQzae','55hcaUiP','create','isArray','__esModule','6014056ekVfLZ','shopSettings','2376352HEQQEe','8405075VECLDH','update','1602519tMDNcX','Shop\x20settings\x20not\x20found','defineProperty','updateWebhookSettings','string','getIntegrations','findUnique','webhookUrl','__importDefault','ensureSettingsExist','../config/database','708450klwSbm','IntegrationsService','parseWebhookEvents','611176Cpztdx','default','3682072KyjlyD'];a43_0x59d9=function(){return _0xd95860;};return a43_0x59d9();}const a43_0x3cf8c2=a43_0x1a0b;(function(_0x9c6c5b,_0x5ca2fe){const _0x287dd4=a43_0x1a0b,_0x18fee7=_0x9c6c5b();while(!![]){try{const _0x291e89=-parseInt(_0x287dd4(0xf5))/0x1+-parseInt(_0x287dd4(0xe4))/0x2+parseInt(_0x287dd4(0xe7))/0x3+parseInt(_0x287dd4(0xf7))/0x4+parseInt(_0x287dd4(0xde))/0x5*(parseInt(_0x287dd4(0xf2))/0x6)+parseInt(_0x287dd4(0xe5))/0x7+parseInt(_0x287dd4(0xe2))/0x8*(-parseInt(_0x287dd4(0xdd))/0x9);if(_0x291e89===_0x5ca2fe)break;else _0x18fee7['push'](_0x18fee7['shift']());}catch(_0xf8578d){_0x18fee7['push'](_0x18fee7['shift']());}}}(a43_0x59d9,0x9f06f));var __importDefault=this&&this[a43_0x3cf8c2(0xef)]||function(_0x16982f){const _0x171eeb=a43_0x3cf8c2;return _0x16982f&&_0x16982f[_0x171eeb(0xe1)]?_0x16982f:{'default':_0x16982f};};Object[a43_0x3cf8c2(0xe9)](exports,a43_0x3cf8c2(0xe1),{'value':!![]}),exports['IntegrationsService']=void 0x0;const database_1=__importDefault(require(a43_0x3cf8c2(0xf1)));function a43_0x1a0b(_0xb8863d,_0x5d6276){const _0x59d9de=a43_0x59d9();return a43_0x1a0b=function(_0x1a0bc3,_0x5ab3ca){_0x1a0bc3=_0x1a0bc3-0xdb;let _0x533e29=_0x59d9de[_0x1a0bc3];return _0x533e29;},a43_0x1a0b(_0xb8863d,_0x5d6276);}class IntegrationsService{[a43_0x3cf8c2(0xf4)](_0x17a4e8){const _0x1452e9=a43_0x3cf8c2;if(!_0x17a4e8)return[];if(Array['isArray'](_0x17a4e8))return _0x17a4e8;if(typeof _0x17a4e8===_0x1452e9(0xeb))try{const _0x578599=JSON[_0x1452e9(0xdb)](_0x17a4e8);return Array[_0x1452e9(0xe0)](_0x578599)?_0x578599:[];}catch{return[];}return[];}async[a43_0x3cf8c2(0xec)](_0x1c4c58){const _0x41879d=a43_0x3cf8c2;await this[_0x41879d(0xf0)](_0x1c4c58);const _0x17aadc=await database_1['default'][_0x41879d(0xe3)][_0x41879d(0xed)]({'where':{'shopId':_0x1c4c58},'select':{'webhookUrl':!![],'webhookEvents':!![]}});if(!_0x17aadc)throw new Error(_0x41879d(0xe8));return{'webhook':{'url':_0x17aadc[_0x41879d(0xee)],'events':this[_0x41879d(0xf4)](_0x17aadc['webhookEvents'])}};}async[a43_0x3cf8c2(0xea)](_0xf7b7b8,_0x4195d9){const _0x4554a2=a43_0x3cf8c2;await this[_0x4554a2(0xf0)](_0xf7b7b8);const _0x3a913e={};_0x4195d9[_0x4554a2(0xee)]!==undefined&&(_0x3a913e['webhookUrl']=_0x4195d9['webhookUrl']||null),_0x4195d9['webhookEvents']!==undefined&&(_0x3a913e[_0x4554a2(0xdc)]=_0x4195d9[_0x4554a2(0xdc)]||[]),await database_1[_0x4554a2(0xf6)][_0x4554a2(0xe3)][_0x4554a2(0xe6)]({'where':{'shopId':_0xf7b7b8},'data':_0x3a913e});}async[a43_0x3cf8c2(0xf0)](_0x5f110e){const _0x4fe428=a43_0x3cf8c2,_0x1abf7c=await database_1[_0x4fe428(0xf6)][_0x4fe428(0xe3)][_0x4fe428(0xed)]({'where':{'shopId':_0x5f110e}});!_0x1abf7c&&await database_1[_0x4fe428(0xf6)][_0x4fe428(0xe3)][_0x4fe428(0xdf)]({'data':{'shopId':_0x5f110e}});}}exports[a43_0x3cf8c2(0xf3)]=IntegrationsService;