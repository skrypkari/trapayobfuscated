'use strict';const a58_0x4bd42c=a58_0xd30b;(function(_0x3a7a18,_0x26f764){const _0x8e776e=a58_0xd30b,_0xd4e877=_0x3a7a18();while(!![]){try{const _0x7d8194=parseInt(_0x8e776e(0xf6))/0x1*(-parseInt(_0x8e776e(0xef))/0x2)+-parseInt(_0x8e776e(0xfb))/0x3+-parseInt(_0x8e776e(0xe3))/0x4*(parseInt(_0x8e776e(0xec))/0x5)+parseInt(_0x8e776e(0xfc))/0x6*(parseInt(_0x8e776e(0xf8))/0x7)+parseInt(_0x8e776e(0xe7))/0x8+parseInt(_0x8e776e(0xf3))/0x9+parseInt(_0x8e776e(0xe4))/0xa*(parseInt(_0x8e776e(0xf2))/0xb);if(_0x7d8194===_0x26f764)break;else _0xd4e877['push'](_0xd4e877['shift']());}catch(_0x1b71bf){_0xd4e877['push'](_0xd4e877['shift']());}}}(a58_0xaa65,0x25c6e));function a58_0xd30b(_0x5f1910,_0x2388df){const _0xaa65c0=a58_0xaa65();return a58_0xd30b=function(_0xd30b72,_0xce3979){_0xd30b72=_0xd30b72-0xe2;let _0x3788a4=_0xaa65c0[_0xd30b72];return _0x3788a4;},a58_0xd30b(_0x5f1910,_0x2388df);}var __importDefault=this&&this[a58_0x4bd42c(0xe6)]||function(_0x52f52e){return _0x52f52e&&_0x52f52e['__esModule']?_0x52f52e:{'default':_0x52f52e};};Object['defineProperty'](exports,'__esModule',{'value':!![]}),exports[a58_0x4bd42c(0xe9)]=void 0x0;const database_1=__importDefault(require(a58_0x4bd42c(0xea)));function a58_0xaa65(){const _0x502a1e=['Shop\x20settings\x20not\x20found','148152QPPZDp','15798GdEKCJ','getIntegrations','parse','3056MxGPoE','10JVPeIy','findUnique','__importDefault','1147104awDJTE','webhookUrl','IntegrationsService','../config/database','isArray','865tGlljS','create','webhookEvents','148476jzlZRR','parseWebhookEvents','default','804683gCsPSz','399780ikadwY','shopSettings','string','2RmcVwa','updateWebhookSettings','595aRtIrO','ensureSettingsExist'];a58_0xaa65=function(){return _0x502a1e;};return a58_0xaa65();}class IntegrationsService{[a58_0x4bd42c(0xf0)](_0x51ccb4){const _0x23f1d1=a58_0x4bd42c;if(!_0x51ccb4)return[];if(Array[_0x23f1d1(0xeb)](_0x51ccb4))return _0x51ccb4;if(typeof _0x51ccb4===_0x23f1d1(0xf5))try{const _0x3b0a57=JSON[_0x23f1d1(0xe2)](_0x51ccb4);return Array['isArray'](_0x3b0a57)?_0x3b0a57:[];}catch{return[];}return[];}async[a58_0x4bd42c(0xfd)](_0x6475bc){const _0xc97ff1=a58_0x4bd42c;await this[_0xc97ff1(0xf9)](_0x6475bc);const _0x561399=await database_1[_0xc97ff1(0xf1)][_0xc97ff1(0xf4)][_0xc97ff1(0xe5)]({'where':{'shopId':_0x6475bc},'select':{'webhookUrl':!![],'webhookEvents':!![]}});if(!_0x561399)throw new Error(_0xc97ff1(0xfa));return{'webhook':{'url':_0x561399[_0xc97ff1(0xe8)],'events':this['parseWebhookEvents'](_0x561399[_0xc97ff1(0xee)])}};}async[a58_0x4bd42c(0xf7)](_0x174b16,_0x505986){const _0x33a0e5=a58_0x4bd42c;await this['ensureSettingsExist'](_0x174b16);const _0x195d7e={};_0x505986['webhookUrl']!==undefined&&(_0x195d7e[_0x33a0e5(0xe8)]=_0x505986[_0x33a0e5(0xe8)]||null),_0x505986[_0x33a0e5(0xee)]!==undefined&&(_0x195d7e['webhookEvents']=_0x505986[_0x33a0e5(0xee)]||[]),await database_1[_0x33a0e5(0xf1)][_0x33a0e5(0xf4)]['update']({'where':{'shopId':_0x174b16},'data':_0x195d7e});}async[a58_0x4bd42c(0xf9)](_0xef3483){const _0x3d79d1=a58_0x4bd42c,_0x3e8a98=await database_1['default'][_0x3d79d1(0xf4)][_0x3d79d1(0xe5)]({'where':{'shopId':_0xef3483}});!_0x3e8a98&&await database_1[_0x3d79d1(0xf1)][_0x3d79d1(0xf4)][_0x3d79d1(0xed)]({'data':{'shopId':_0xef3483}});}}exports[a58_0x4bd42c(0xe9)]=IntegrationsService;