'use strict';const a48_0x3909e1=a48_0x150e;function a48_0x150e(_0x5bc01b,_0x49803b){const _0x17200d=a48_0x1720();return a48_0x150e=function(_0x150ece,_0xa1bb9b){_0x150ece=_0x150ece-0x8c;let _0x5442a2=_0x17200d[_0x150ece];return _0x5442a2;},a48_0x150e(_0x5bc01b,_0x49803b);}function a48_0x1720(){const _0x1cdf5d=['2192864dEMRYM','ensureSettingsExist','2dUSSKd','webhookEvents','3332545AWXbMq','__importDefault','webhookUrl','1834944AsVGcs','Shop\x20settings\x20not\x20found','shopSettings','1723841DrUmuX','12YXaZve','isArray','__esModule','create','parseWebhookEvents','updateWebhookSettings','3278652EJTwnB','default','IntegrationsService','findUnique','string','150232Luiznd','31508505TAcNKl'];a48_0x1720=function(){return _0x1cdf5d;};return a48_0x1720();}(function(_0x179cc9,_0x220907){const _0x3b2e13=a48_0x150e,_0x187126=_0x179cc9();while(!![]){try{const _0x34c4cb=-parseInt(_0x3b2e13(0x98))/0x1*(-parseInt(_0x3b2e13(0x9c))/0x2)+-parseInt(_0x3b2e13(0x93))/0x3+-parseInt(_0x3b2e13(0xa1))/0x4+-parseInt(_0x3b2e13(0x9e))/0x5*(parseInt(_0x3b2e13(0x8d))/0x6)+parseInt(_0x3b2e13(0x8c))/0x7+-parseInt(_0x3b2e13(0x9a))/0x8+parseInt(_0x3b2e13(0x99))/0x9;if(_0x34c4cb===_0x220907)break;else _0x187126['push'](_0x187126['shift']());}catch(_0xeecf82){_0x187126['push'](_0x187126['shift']());}}}(a48_0x1720,0xb4586));var __importDefault=this&&this[a48_0x3909e1(0x9f)]||function(_0xde1198){const _0x2ddb66=a48_0x3909e1;return _0xde1198&&_0xde1198[_0x2ddb66(0x8f)]?_0xde1198:{'default':_0xde1198};};Object['defineProperty'](exports,'__esModule',{'value':!![]}),exports[a48_0x3909e1(0x95)]=void 0x0;const database_1=__importDefault(require('../config/database'));class IntegrationsService{['parseWebhookEvents'](_0x120fa8){const _0x198610=a48_0x3909e1;if(!_0x120fa8)return[];if(Array[_0x198610(0x8e)](_0x120fa8))return _0x120fa8;if(typeof _0x120fa8===_0x198610(0x97))try{const _0x4b26a8=JSON['parse'](_0x120fa8);return Array['isArray'](_0x4b26a8)?_0x4b26a8:[];}catch{return[];}return[];}async['getIntegrations'](_0x30d138){const _0x9ef76e=a48_0x3909e1;await this[_0x9ef76e(0x9b)](_0x30d138);const _0x56d2ab=await database_1[_0x9ef76e(0x94)][_0x9ef76e(0xa3)][_0x9ef76e(0x96)]({'where':{'shopId':_0x30d138},'select':{'webhookUrl':!![],'webhookEvents':!![]}});if(!_0x56d2ab)throw new Error(_0x9ef76e(0xa2));return{'webhook':{'url':_0x56d2ab[_0x9ef76e(0xa0)],'events':this[_0x9ef76e(0x91)](_0x56d2ab['webhookEvents'])}};}async[a48_0x3909e1(0x92)](_0x1d9f5b,_0x2b2548){const _0x18b619=a48_0x3909e1;await this[_0x18b619(0x9b)](_0x1d9f5b);const _0x5c8208={};_0x2b2548[_0x18b619(0xa0)]!==undefined&&(_0x5c8208[_0x18b619(0xa0)]=_0x2b2548['webhookUrl']||null),_0x2b2548[_0x18b619(0x9d)]!==undefined&&(_0x5c8208[_0x18b619(0x9d)]=_0x2b2548[_0x18b619(0x9d)]||[]),await database_1[_0x18b619(0x94)][_0x18b619(0xa3)]['update']({'where':{'shopId':_0x1d9f5b},'data':_0x5c8208});}async[a48_0x3909e1(0x9b)](_0x42158a){const _0x3a276b=a48_0x3909e1,_0x3bed70=await database_1[_0x3a276b(0x94)][_0x3a276b(0xa3)]['findUnique']({'where':{'shopId':_0x42158a}});!_0x3bed70&&await database_1[_0x3a276b(0x94)]['shopSettings'][_0x3a276b(0x90)]({'data':{'shopId':_0x42158a}});}}exports[a48_0x3909e1(0x95)]=IntegrationsService;