'use strict';const a43_0x3fcf12=a43_0x5959;(function(_0x500ba0,_0x3e26ef){const _0x285a48=a43_0x5959,_0x28fac4=_0x500ba0();while(!![]){try{const _0x48a348=-parseInt(_0x285a48(0x17c))/0x1+-parseInt(_0x285a48(0x177))/0x2*(parseInt(_0x285a48(0x174))/0x3)+parseInt(_0x285a48(0x17b))/0x4+-parseInt(_0x285a48(0x183))/0x5+parseInt(_0x285a48(0x182))/0x6*(-parseInt(_0x285a48(0x186))/0x7)+-parseInt(_0x285a48(0x172))/0x8+parseInt(_0x285a48(0x171))/0x9;if(_0x48a348===_0x3e26ef)break;else _0x28fac4['push'](_0x28fac4['shift']());}catch(_0x1fd001){_0x28fac4['push'](_0x28fac4['shift']());}}}(a43_0x232e,0x21e75));function a43_0x232e(){const _0x535f40=['default','ensureSettingsExist','getIntegrations','../config/database','findUnique','isArray','3774465CIDuae','178920jwsemU','Shop\x20settings\x20not\x20found','3pmrPdy','update','webhookUrl','128886sWFtev','__esModule','IntegrationsService','string','398044BwSsQD','100011zGMjHI','__importDefault','defineProperty','updateWebhookSettings','shopSettings','parseWebhookEvents','127698QzgIxs','114720yMCTGb','create','webhookEvents','56VHSJZb'];a43_0x232e=function(){return _0x535f40;};return a43_0x232e();}function a43_0x5959(_0x57211e,_0x26d3e4){const _0x232e77=a43_0x232e();return a43_0x5959=function(_0x595957,_0x180e96){_0x595957=_0x595957-0x16f;let _0x35e27e=_0x232e77[_0x595957];return _0x35e27e;},a43_0x5959(_0x57211e,_0x26d3e4);}var __importDefault=this&&this[a43_0x3fcf12(0x17d)]||function(_0x211e69){const _0x5c2d93=a43_0x3fcf12;return _0x211e69&&_0x211e69[_0x5c2d93(0x178)]?_0x211e69:{'default':_0x211e69};};Object[a43_0x3fcf12(0x17e)](exports,a43_0x3fcf12(0x178),{'value':!![]}),exports['IntegrationsService']=void 0x0;const database_1=__importDefault(require(a43_0x3fcf12(0x18a)));class IntegrationsService{[a43_0x3fcf12(0x181)](_0x22e27f){const _0x3fd886=a43_0x3fcf12;if(!_0x22e27f)return[];if(Array[_0x3fd886(0x170)](_0x22e27f))return _0x22e27f;if(typeof _0x22e27f===_0x3fd886(0x17a))try{const _0x5d2418=JSON['parse'](_0x22e27f);return Array[_0x3fd886(0x170)](_0x5d2418)?_0x5d2418:[];}catch{return[];}return[];}async[a43_0x3fcf12(0x189)](_0x1c67f7){const _0x28e8a3=a43_0x3fcf12;await this[_0x28e8a3(0x188)](_0x1c67f7);const _0x20ed2d=await database_1[_0x28e8a3(0x187)][_0x28e8a3(0x180)][_0x28e8a3(0x16f)]({'where':{'shopId':_0x1c67f7},'select':{'webhookUrl':!![],'webhookEvents':!![]}});if(!_0x20ed2d)throw new Error(_0x28e8a3(0x173));return{'webhook':{'url':_0x20ed2d[_0x28e8a3(0x176)],'events':this[_0x28e8a3(0x181)](_0x20ed2d['webhookEvents'])}};}async[a43_0x3fcf12(0x17f)](_0x332c6c,_0x4cd379){const _0x42a8e6=a43_0x3fcf12;await this[_0x42a8e6(0x188)](_0x332c6c);const _0x244ded={};_0x4cd379[_0x42a8e6(0x176)]!==undefined&&(_0x244ded['webhookUrl']=_0x4cd379['webhookUrl']||null),_0x4cd379[_0x42a8e6(0x185)]!==undefined&&(_0x244ded[_0x42a8e6(0x185)]=_0x4cd379[_0x42a8e6(0x185)]||[]),await database_1[_0x42a8e6(0x187)][_0x42a8e6(0x180)][_0x42a8e6(0x175)]({'where':{'shopId':_0x332c6c},'data':_0x244ded});}async[a43_0x3fcf12(0x188)](_0x469d34){const _0x9ff5b1=a43_0x3fcf12,_0xea0ed5=await database_1['default']['shopSettings']['findUnique']({'where':{'shopId':_0x469d34}});!_0xea0ed5&&await database_1[_0x9ff5b1(0x187)][_0x9ff5b1(0x180)][_0x9ff5b1(0x184)]({'data':{'shopId':_0x469d34}});}}exports[a43_0x3fcf12(0x179)]=IntegrationsService;