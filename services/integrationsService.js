'use strict';const a43_0x1ed496=a43_0x1ae6;function a43_0x41e4(){const _0x24bb78=['shopSettings','13681449YzVKvA','11XkrDsa','1080591XReQpF','IntegrationsService','8ilFOiG','parse','859566GUClVO','webhookEvents','26258110iMGoxc','6924070JFIbvt','defineProperty','6hQCeJW','ensureSettingsExist','parseWebhookEvents','updateWebhookSettings','39136ZAeJvt','webhookUrl','../config/database','findUnique','__esModule','5548hQIRcD','196sSPnkH','default'];a43_0x41e4=function(){return _0x24bb78;};return a43_0x41e4();}(function(_0x245a63,_0x1ecf06){const _0x28920c=a43_0x1ae6,_0x52ced9=_0x245a63();while(!![]){try{const _0x387bee=parseInt(_0x28920c(0x10a))/0x1+-parseInt(_0x28920c(0x11c))/0x2+-parseInt(_0x28920c(0x10e))/0x3*(parseInt(_0x28920c(0x10c))/0x4)+parseInt(_0x28920c(0x111))/0x5*(parseInt(_0x28920c(0x113))/0x6)+-parseInt(_0x28920c(0x105))/0x7*(-parseInt(_0x28920c(0x117))/0x8)+parseInt(_0x28920c(0x108))/0x9+parseInt(_0x28920c(0x110))/0xa*(-parseInt(_0x28920c(0x109))/0xb);if(_0x387bee===_0x1ecf06)break;else _0x52ced9['push'](_0x52ced9['shift']());}catch(_0x39a180){_0x52ced9['push'](_0x52ced9['shift']());}}}(a43_0x41e4,0xe0d51));function a43_0x1ae6(_0x4fa0a2,_0x6835e3){const _0x41e45f=a43_0x41e4();return a43_0x1ae6=function(_0x1ae6ba,_0x48dc4f){_0x1ae6ba=_0x1ae6ba-0x105;let _0x5435e0=_0x41e45f[_0x1ae6ba];return _0x5435e0;},a43_0x1ae6(_0x4fa0a2,_0x6835e3);}var __importDefault=this&&this['__importDefault']||function(_0x2225d0){const _0x3a9a09=a43_0x1ae6;return _0x2225d0&&_0x2225d0[_0x3a9a09(0x11b)]?_0x2225d0:{'default':_0x2225d0};};Object[a43_0x1ed496(0x112)](exports,a43_0x1ed496(0x11b),{'value':!![]}),exports[a43_0x1ed496(0x10b)]=void 0x0;const database_1=__importDefault(require(a43_0x1ed496(0x119)));class IntegrationsService{[a43_0x1ed496(0x115)](_0x35b4af){const _0x5e33c9=a43_0x1ed496;if(!_0x35b4af)return[];if(Array['isArray'](_0x35b4af))return _0x35b4af;if(typeof _0x35b4af==='string')try{const _0x52068e=JSON[_0x5e33c9(0x10d)](_0x35b4af);return Array['isArray'](_0x52068e)?_0x52068e:[];}catch{return[];}return[];}async['getIntegrations'](_0x3cc5d0){const _0x33fe39=a43_0x1ed496;await this['ensureSettingsExist'](_0x3cc5d0);const _0x1c9a36=await database_1['default'][_0x33fe39(0x107)][_0x33fe39(0x11a)]({'where':{'shopId':_0x3cc5d0},'select':{'webhookUrl':!![],'webhookEvents':!![]}});if(!_0x1c9a36)throw new Error('Shop\x20settings\x20not\x20found');return{'webhook':{'url':_0x1c9a36[_0x33fe39(0x118)],'events':this[_0x33fe39(0x115)](_0x1c9a36['webhookEvents'])}};}async[a43_0x1ed496(0x116)](_0x53954a,_0x52f2b3){const _0x12b618=a43_0x1ed496;await this[_0x12b618(0x114)](_0x53954a);const _0x3a52d7={};_0x52f2b3['webhookUrl']!==undefined&&(_0x3a52d7[_0x12b618(0x118)]=_0x52f2b3[_0x12b618(0x118)]||null),_0x52f2b3['webhookEvents']!==undefined&&(_0x3a52d7[_0x12b618(0x10f)]=_0x52f2b3[_0x12b618(0x10f)]||[]),await database_1['default'][_0x12b618(0x107)]['update']({'where':{'shopId':_0x53954a},'data':_0x3a52d7});}async[a43_0x1ed496(0x114)](_0x287cbf){const _0x120d32=a43_0x1ed496,_0xee7f59=await database_1[_0x120d32(0x106)]['shopSettings'][_0x120d32(0x11a)]({'where':{'shopId':_0x287cbf}});!_0xee7f59&&await database_1[_0x120d32(0x106)]['shopSettings']['create']({'data':{'shopId':_0x287cbf}});}}exports['IntegrationsService']=IntegrationsService;