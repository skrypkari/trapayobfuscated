'use strict';function a58_0x9854(){const _0x3efaf0=['311100DNmlls','2246571gMuICp','shopSettings','parseWebhookEvents','getIntegrations','76VhWmqJ','__importDefault','ensureSettingsExist','529502HATBZV','27867wlUYfi','webhookEvents','update','77091xWKBfY','webhookUrl','48DZqlZi','findUnique','isArray','Shop\x20settings\x20not\x20found','string','2255740SfJCxO','__esModule','defineProperty','updateWebhookSettings','../config/database','1185660KudXcK'];a58_0x9854=function(){return _0x3efaf0;};return a58_0x9854();}const a58_0x45eb8a=a58_0x3ece;(function(_0x31673a,_0x4ff0c9){const _0x26730c=a58_0x3ece,_0x36f7ba=_0x31673a();while(!![]){try{const _0x8a79e9=parseInt(_0x26730c(0x17b))/0x1+-parseInt(_0x26730c(0x16a))/0x2+-parseInt(_0x26730c(0x16b))/0x3*(-parseInt(_0x26730c(0x180))/0x4)+parseInt(_0x26730c(0x175))/0x5+-parseInt(_0x26730c(0x17a))/0x6+parseInt(_0x26730c(0x16e))/0x7*(parseInt(_0x26730c(0x170))/0x8)+-parseInt(_0x26730c(0x17c))/0x9;if(_0x8a79e9===_0x4ff0c9)break;else _0x36f7ba['push'](_0x36f7ba['shift']());}catch(_0x361695){_0x36f7ba['push'](_0x36f7ba['shift']());}}}(a58_0x9854,0x477e5));function a58_0x3ece(_0x5f29a1,_0x349cff){const _0x9854e2=a58_0x9854();return a58_0x3ece=function(_0x3ece31,_0x521b45){_0x3ece31=_0x3ece31-0x169;let _0x1f426d=_0x9854e2[_0x3ece31];return _0x1f426d;},a58_0x3ece(_0x5f29a1,_0x349cff);}var __importDefault=this&&this[a58_0x45eb8a(0x181)]||function(_0x57fb4a){const _0x4d02b1=a58_0x45eb8a;return _0x57fb4a&&_0x57fb4a[_0x4d02b1(0x176)]?_0x57fb4a:{'default':_0x57fb4a};};Object[a58_0x45eb8a(0x177)](exports,a58_0x45eb8a(0x176),{'value':!![]}),exports['IntegrationsService']=void 0x0;const database_1=__importDefault(require(a58_0x45eb8a(0x179)));class IntegrationsService{[a58_0x45eb8a(0x17e)](_0x28056d){const _0x167763=a58_0x45eb8a;if(!_0x28056d)return[];if(Array[_0x167763(0x172)](_0x28056d))return _0x28056d;if(typeof _0x28056d===_0x167763(0x174))try{const _0xc3b793=JSON['parse'](_0x28056d);return Array[_0x167763(0x172)](_0xc3b793)?_0xc3b793:[];}catch{return[];}return[];}async[a58_0x45eb8a(0x17f)](_0x55cf57){const _0x20feb4=a58_0x45eb8a;await this[_0x20feb4(0x169)](_0x55cf57);const _0x26d7cf=await database_1['default'][_0x20feb4(0x17d)][_0x20feb4(0x171)]({'where':{'shopId':_0x55cf57},'select':{'webhookUrl':!![],'webhookEvents':!![]}});if(!_0x26d7cf)throw new Error(_0x20feb4(0x173));return{'webhook':{'url':_0x26d7cf['webhookUrl'],'events':this['parseWebhookEvents'](_0x26d7cf[_0x20feb4(0x16c)])}};}async[a58_0x45eb8a(0x178)](_0x1db791,_0xba40c2){const _0xb52aa6=a58_0x45eb8a;await this[_0xb52aa6(0x169)](_0x1db791);const _0x5d69a6={};_0xba40c2['webhookUrl']!==undefined&&(_0x5d69a6[_0xb52aa6(0x16f)]=_0xba40c2['webhookUrl']||null),_0xba40c2[_0xb52aa6(0x16c)]!==undefined&&(_0x5d69a6[_0xb52aa6(0x16c)]=_0xba40c2[_0xb52aa6(0x16c)]||[]),await database_1['default'][_0xb52aa6(0x17d)][_0xb52aa6(0x16d)]({'where':{'shopId':_0x1db791},'data':_0x5d69a6});}async[a58_0x45eb8a(0x169)](_0xd64788){const _0x499307=a58_0x45eb8a,_0x4c48d6=await database_1['default'][_0x499307(0x17d)]['findUnique']({'where':{'shopId':_0xd64788}});!_0x4c48d6&&await database_1['default']['shopSettings']['create']({'data':{'shopId':_0xd64788}});}}exports['IntegrationsService']=IntegrationsService;