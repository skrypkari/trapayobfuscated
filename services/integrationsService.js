'use strict';const a48_0x5e3ce2=a48_0x5c82;(function(_0x5cc118,_0x3ad9d3){const _0x279ed0=a48_0x5c82,_0x9c3ef7=_0x5cc118();while(!![]){try{const _0x4a78f7=-parseInt(_0x279ed0(0x1a6))/0x1+parseInt(_0x279ed0(0x1a2))/0x2+-parseInt(_0x279ed0(0x1a1))/0x3*(-parseInt(_0x279ed0(0x197))/0x4)+parseInt(_0x279ed0(0x1a7))/0x5+parseInt(_0x279ed0(0x19e))/0x6+parseInt(_0x279ed0(0x19f))/0x7*(-parseInt(_0x279ed0(0x1ad))/0x8)+-parseInt(_0x279ed0(0x1a3))/0x9;if(_0x4a78f7===_0x3ad9d3)break;else _0x9c3ef7['push'](_0x9c3ef7['shift']());}catch(_0x4770e9){_0x9c3ef7['push'](_0x9c3ef7['shift']());}}}(a48_0x22ec,0x1ad2d));var __importDefault=this&&this[a48_0x5e3ce2(0x1aa)]||function(_0x41ca64){const _0x475cc1=a48_0x5e3ce2;return _0x41ca64&&_0x41ca64[_0x475cc1(0x1ac)]?_0x41ca64:{'default':_0x41ca64};};function a48_0x5c82(_0x4b4863,_0x20c321){const _0x22ece0=a48_0x22ec();return a48_0x5c82=function(_0x5c8283,_0x52f533){_0x5c8283=_0x5c8283-0x197;let _0x58f645=_0x22ece0[_0x5c8283];return _0x58f645;},a48_0x5c82(_0x4b4863,_0x20c321);}Object[a48_0x5e3ce2(0x1af)](exports,a48_0x5e3ce2(0x1ac),{'value':!![]}),exports[a48_0x5e3ce2(0x199)]=void 0x0;function a48_0x22ec(){const _0x3e823b=['findUnique','webhookEvents','__importDefault','getIntegrations','__esModule','24DiCKfK','isArray','defineProperty','../config/database','parseWebhookEvents','660272tviZom','Shop\x20settings\x20not\x20found','IntegrationsService','create','webhookUrl','string','default','629448stWdlU','110579OyOajS','ensureSettingsExist','3JHudmg','98034VkRqQG','1420650GICXcE','updateWebhookSettings','shopSettings','190169NJUhuC','931430laYPHK'];a48_0x22ec=function(){return _0x3e823b;};return a48_0x22ec();}const database_1=__importDefault(require(a48_0x5e3ce2(0x1b0)));class IntegrationsService{[a48_0x5e3ce2(0x1b1)](_0x4128e7){const _0x5c1b69=a48_0x5e3ce2;if(!_0x4128e7)return[];if(Array[_0x5c1b69(0x1ae)](_0x4128e7))return _0x4128e7;if(typeof _0x4128e7===_0x5c1b69(0x19c))try{const _0x5032db=JSON['parse'](_0x4128e7);return Array[_0x5c1b69(0x1ae)](_0x5032db)?_0x5032db:[];}catch{return[];}return[];}async[a48_0x5e3ce2(0x1ab)](_0x547408){const _0x565c25=a48_0x5e3ce2;await this[_0x565c25(0x1a0)](_0x547408);const _0xc8e3d4=await database_1[_0x565c25(0x19d)]['shopSettings'][_0x565c25(0x1a8)]({'where':{'shopId':_0x547408},'select':{'webhookUrl':!![],'webhookEvents':!![]}});if(!_0xc8e3d4)throw new Error(_0x565c25(0x198));return{'webhook':{'url':_0xc8e3d4['webhookUrl'],'events':this[_0x565c25(0x1b1)](_0xc8e3d4[_0x565c25(0x1a9)])}};}async[a48_0x5e3ce2(0x1a4)](_0x18ce94,_0x4fe209){const _0x431fcc=a48_0x5e3ce2;await this['ensureSettingsExist'](_0x18ce94);const _0x13e098={};_0x4fe209[_0x431fcc(0x19b)]!==undefined&&(_0x13e098[_0x431fcc(0x19b)]=_0x4fe209[_0x431fcc(0x19b)]||null),_0x4fe209[_0x431fcc(0x1a9)]!==undefined&&(_0x13e098[_0x431fcc(0x1a9)]=_0x4fe209[_0x431fcc(0x1a9)]||[]),await database_1[_0x431fcc(0x19d)][_0x431fcc(0x1a5)]['update']({'where':{'shopId':_0x18ce94},'data':_0x13e098});}async['ensureSettingsExist'](_0x4bf78d){const _0x7ccfe0=a48_0x5e3ce2,_0x16a850=await database_1[_0x7ccfe0(0x19d)][_0x7ccfe0(0x1a5)]['findUnique']({'where':{'shopId':_0x4bf78d}});!_0x16a850&&await database_1[_0x7ccfe0(0x19d)][_0x7ccfe0(0x1a5)][_0x7ccfe0(0x19a)]({'data':{'shopId':_0x4bf78d}});}}exports[a48_0x5e3ce2(0x199)]=IntegrationsService;