'use strict';const a48_0x5380a8=a48_0xdc09;(function(_0x18609e,_0x125218){const _0x11d6eb=a48_0xdc09,_0x58c4a2=_0x18609e();while(!![]){try{const _0x237052=-parseInt(_0x11d6eb(0xd0))/0x1*(parseInt(_0x11d6eb(0xe3))/0x2)+-parseInt(_0x11d6eb(0xd8))/0x3+-parseInt(_0x11d6eb(0xd9))/0x4*(parseInt(_0x11d6eb(0xcb))/0x5)+-parseInt(_0x11d6eb(0xe6))/0x6*(parseInt(_0x11d6eb(0xd3))/0x7)+parseInt(_0x11d6eb(0xd1))/0x8+parseInt(_0x11d6eb(0xcd))/0x9*(-parseInt(_0x11d6eb(0xdf))/0xa)+parseInt(_0x11d6eb(0xd2))/0xb*(parseInt(_0x11d6eb(0xe1))/0xc);if(_0x237052===_0x125218)break;else _0x58c4a2['push'](_0x58c4a2['shift']());}catch(_0x2f5a91){_0x58c4a2['push'](_0x58c4a2['shift']());}}}(a48_0x4974,0x46ff1));function a48_0x4974(){const _0x449b6d=['1VnxITC','613560pHZosm','8096dKcHai','120757imdFhR','getIntegrations','string','ensureSettingsExist','parse','679161dsfwfy','4upfqqe','isArray','update','webhookUrl','__esModule','updateWebhookSettings','10uDCTcF','IntegrationsService','18084EuTihh','__importDefault','397756uEfViN','webhookEvents','default','66EcDMuk','shopSettings','findUnique','671410HMHtrW','Shop\x20settings\x20not\x20found','1311642VfUCbk','parseWebhookEvents','defineProperty'];a48_0x4974=function(){return _0x449b6d;};return a48_0x4974();}var __importDefault=this&&this[a48_0x5380a8(0xe2)]||function(_0x550683){return _0x550683&&_0x550683['__esModule']?_0x550683:{'default':_0x550683};};Object[a48_0x5380a8(0xcf)](exports,a48_0x5380a8(0xdd),{'value':!![]}),exports[a48_0x5380a8(0xe0)]=void 0x0;const database_1=__importDefault(require('../config/database'));class IntegrationsService{['parseWebhookEvents'](_0x189e68){const _0x5e23b7=a48_0x5380a8;if(!_0x189e68)return[];if(Array[_0x5e23b7(0xda)](_0x189e68))return _0x189e68;if(typeof _0x189e68===_0x5e23b7(0xd5))try{const _0x5df7e6=JSON[_0x5e23b7(0xd7)](_0x189e68);return Array[_0x5e23b7(0xda)](_0x5df7e6)?_0x5df7e6:[];}catch{return[];}return[];}async[a48_0x5380a8(0xd4)](_0x2c1715){const _0x262d69=a48_0x5380a8;await this[_0x262d69(0xd6)](_0x2c1715);const _0x165cd0=await database_1[_0x262d69(0xe5)][_0x262d69(0xc9)][_0x262d69(0xca)]({'where':{'shopId':_0x2c1715},'select':{'webhookUrl':!![],'webhookEvents':!![]}});if(!_0x165cd0)throw new Error(_0x262d69(0xcc));return{'webhook':{'url':_0x165cd0['webhookUrl'],'events':this[_0x262d69(0xce)](_0x165cd0[_0x262d69(0xe4)])}};}async[a48_0x5380a8(0xde)](_0x259334,_0x52904a){const _0xb862f3=a48_0x5380a8;await this[_0xb862f3(0xd6)](_0x259334);const _0x4f55f1={};_0x52904a[_0xb862f3(0xdc)]!==undefined&&(_0x4f55f1['webhookUrl']=_0x52904a[_0xb862f3(0xdc)]||null),_0x52904a[_0xb862f3(0xe4)]!==undefined&&(_0x4f55f1[_0xb862f3(0xe4)]=_0x52904a[_0xb862f3(0xe4)]||[]),await database_1[_0xb862f3(0xe5)][_0xb862f3(0xc9)][_0xb862f3(0xdb)]({'where':{'shopId':_0x259334},'data':_0x4f55f1});}async[a48_0x5380a8(0xd6)](_0x52d776){const _0x5cc50e=a48_0x5380a8,_0x12a124=await database_1[_0x5cc50e(0xe5)][_0x5cc50e(0xc9)]['findUnique']({'where':{'shopId':_0x52d776}});!_0x12a124&&await database_1[_0x5cc50e(0xe5)]['shopSettings']['create']({'data':{'shopId':_0x52d776}});}}function a48_0xdc09(_0x1d6525,_0x21cb07){const _0x4974b8=a48_0x4974();return a48_0xdc09=function(_0xdc096e,_0x1b775a){_0xdc096e=_0xdc096e-0xc9;let _0x58ad12=_0x4974b8[_0xdc096e];return _0x58ad12;},a48_0xdc09(_0x1d6525,_0x21cb07);}exports[a48_0x5380a8(0xe0)]=IntegrationsService;