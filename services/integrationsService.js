'use strict';const a47_0x18fefc=a47_0x236e;(function(_0x55ad96,_0x434fd6){const _0x11e06a=a47_0x236e,_0xb1376a=_0x55ad96();while(!![]){try{const _0x280d35=parseInt(_0x11e06a(0xac))/0x1+-parseInt(_0x11e06a(0xb1))/0x2*(-parseInt(_0x11e06a(0xb4))/0x3)+parseInt(_0x11e06a(0xa6))/0x4+-parseInt(_0x11e06a(0xa9))/0x5+parseInt(_0x11e06a(0xa0))/0x6+parseInt(_0x11e06a(0xaf))/0x7+-parseInt(_0x11e06a(0x9f))/0x8;if(_0x280d35===_0x434fd6)break;else _0xb1376a['push'](_0xb1376a['shift']());}catch(_0xbbe1fc){_0xb1376a['push'](_0xb1376a['shift']());}}}(a47_0x52d7,0x96e76));var __importDefault=this&&this[a47_0x18fefc(0xb3)]||function(_0x2e824d){return _0x2e824d&&_0x2e824d['__esModule']?_0x2e824d:{'default':_0x2e824d};};function a47_0x52d7(){const _0x4645be=['4845460cBBfbj','Shop\x20settings\x20not\x20found','webhookUrl','414800gBSCDl','webhookEvents','string','8394078vlOjCs','shopSettings','12qXeKFe','getIntegrations','__importDefault','234603CRxFyH','parse','create','IntegrationsService','updateWebhookSettings','isArray','10352136nrBdbf','3587694vxjslE','__esModule','update','ensureSettingsExist','default','parseWebhookEvents','800408plAhhG','findUnique','defineProperty'];a47_0x52d7=function(){return _0x4645be;};return a47_0x52d7();}Object[a47_0x18fefc(0xa8)](exports,a47_0x18fefc(0xa1),{'value':!![]}),exports[a47_0x18fefc(0xb7)]=void 0x0;const database_1=__importDefault(require('../config/database'));function a47_0x236e(_0x4198be,_0x4d7be1){const _0x52d7fc=a47_0x52d7();return a47_0x236e=function(_0x236ee6,_0x3650d7){_0x236ee6=_0x236ee6-0x9f;let _0x107102=_0x52d7fc[_0x236ee6];return _0x107102;},a47_0x236e(_0x4198be,_0x4d7be1);}class IntegrationsService{[a47_0x18fefc(0xa5)](_0x58915a){const _0x16e6ef=a47_0x18fefc;if(!_0x58915a)return[];if(Array[_0x16e6ef(0xb9)](_0x58915a))return _0x58915a;if(typeof _0x58915a===_0x16e6ef(0xae))try{const _0x42d635=JSON[_0x16e6ef(0xb5)](_0x58915a);return Array[_0x16e6ef(0xb9)](_0x42d635)?_0x42d635:[];}catch{return[];}return[];}async[a47_0x18fefc(0xb2)](_0x735393){const _0x58e01b=a47_0x18fefc;await this[_0x58e01b(0xa3)](_0x735393);const _0x22a2bb=await database_1[_0x58e01b(0xa4)][_0x58e01b(0xb0)][_0x58e01b(0xa7)]({'where':{'shopId':_0x735393},'select':{'webhookUrl':!![],'webhookEvents':!![]}});if(!_0x22a2bb)throw new Error(_0x58e01b(0xaa));return{'webhook':{'url':_0x22a2bb[_0x58e01b(0xab)],'events':this[_0x58e01b(0xa5)](_0x22a2bb['webhookEvents'])}};}async[a47_0x18fefc(0xb8)](_0x5061fd,_0x586c8d){const _0x342b48=a47_0x18fefc;await this[_0x342b48(0xa3)](_0x5061fd);const _0x487327={};_0x586c8d[_0x342b48(0xab)]!==undefined&&(_0x487327[_0x342b48(0xab)]=_0x586c8d[_0x342b48(0xab)]||null),_0x586c8d[_0x342b48(0xad)]!==undefined&&(_0x487327[_0x342b48(0xad)]=_0x586c8d[_0x342b48(0xad)]||[]),await database_1[_0x342b48(0xa4)]['shopSettings'][_0x342b48(0xa2)]({'where':{'shopId':_0x5061fd},'data':_0x487327});}async[a47_0x18fefc(0xa3)](_0x49f7b1){const _0x363613=a47_0x18fefc,_0x5831fe=await database_1[_0x363613(0xa4)][_0x363613(0xb0)][_0x363613(0xa7)]({'where':{'shopId':_0x49f7b1}});!_0x5831fe&&await database_1[_0x363613(0xa4)]['shopSettings'][_0x363613(0xb6)]({'data':{'shopId':_0x49f7b1}});}}exports[a47_0x18fefc(0xb7)]=IntegrationsService;