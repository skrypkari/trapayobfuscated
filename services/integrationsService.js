'use strict';function a58_0x534c(_0x45c73e,_0x451479){const _0x2db18d=a58_0x2db1();return a58_0x534c=function(_0x534cd6,_0x2a9267){_0x534cd6=_0x534cd6-0x88;let _0x4850f7=_0x2db18d[_0x534cd6];return _0x4850f7;},a58_0x534c(_0x45c73e,_0x451479);}const a58_0x28a083=a58_0x534c;(function(_0x379437,_0x42c5f0){const _0x30be66=a58_0x534c,_0x2ac800=_0x379437();while(!![]){try{const _0x21ab35=parseInt(_0x30be66(0x95))/0x1+parseInt(_0x30be66(0x9b))/0x2+-parseInt(_0x30be66(0x9c))/0x3+-parseInt(_0x30be66(0x99))/0x4+parseInt(_0x30be66(0x90))/0x5+-parseInt(_0x30be66(0x9d))/0x6+parseInt(_0x30be66(0x8b))/0x7*(-parseInt(_0x30be66(0x8c))/0x8);if(_0x21ab35===_0x42c5f0)break;else _0x2ac800['push'](_0x2ac800['shift']());}catch(_0x665639){_0x2ac800['push'](_0x2ac800['shift']());}}}(a58_0x2db1,0x502d2));function a58_0x2db1(){const _0xeb71d7=['ensureSettingsExist','192360cbkNNr','webhookUrl','651716KDyFld','852801AwBNTt','990084HWjvkc','update','IntegrationsService','Shop\x20settings\x20not\x20found','parseWebhookEvents','webhookEvents','175917cdhDcE','24WioItV','create','parse','isArray','1823000DtOIfJ','shopSettings','__esModule','findUnique','updateWebhookSettings','210708qbINzZ','__importDefault','default'];a58_0x2db1=function(){return _0xeb71d7;};return a58_0x2db1();}var __importDefault=this&&this[a58_0x28a083(0x96)]||function(_0x41c2bd){return _0x41c2bd&&_0x41c2bd['__esModule']?_0x41c2bd:{'default':_0x41c2bd};};Object['defineProperty'](exports,a58_0x28a083(0x92),{'value':!![]}),exports['IntegrationsService']=void 0x0;const database_1=__importDefault(require('../config/database'));class IntegrationsService{['parseWebhookEvents'](_0x52bf90){const _0x139889=a58_0x28a083;if(!_0x52bf90)return[];if(Array[_0x139889(0x8f)](_0x52bf90))return _0x52bf90;if(typeof _0x52bf90==='string')try{const _0x17a43c=JSON[_0x139889(0x8e)](_0x52bf90);return Array['isArray'](_0x17a43c)?_0x17a43c:[];}catch{return[];}return[];}async['getIntegrations'](_0x20c63f){const _0x3ef745=a58_0x28a083;await this[_0x3ef745(0x98)](_0x20c63f);const _0x495932=await database_1[_0x3ef745(0x97)][_0x3ef745(0x91)][_0x3ef745(0x93)]({'where':{'shopId':_0x20c63f},'select':{'webhookUrl':!![],'webhookEvents':!![]}});if(!_0x495932)throw new Error(_0x3ef745(0x88));return{'webhook':{'url':_0x495932[_0x3ef745(0x9a)],'events':this[_0x3ef745(0x89)](_0x495932['webhookEvents'])}};}async[a58_0x28a083(0x94)](_0x16efad,_0x15d9e1){const _0x1d91ef=a58_0x28a083;await this[_0x1d91ef(0x98)](_0x16efad);const _0x577990={};_0x15d9e1[_0x1d91ef(0x9a)]!==undefined&&(_0x577990[_0x1d91ef(0x9a)]=_0x15d9e1[_0x1d91ef(0x9a)]||null),_0x15d9e1[_0x1d91ef(0x8a)]!==undefined&&(_0x577990[_0x1d91ef(0x8a)]=_0x15d9e1['webhookEvents']||[]),await database_1['default'][_0x1d91ef(0x91)][_0x1d91ef(0x9e)]({'where':{'shopId':_0x16efad},'data':_0x577990});}async[a58_0x28a083(0x98)](_0x586694){const _0x1da8ea=a58_0x28a083,_0x525ed4=await database_1['default'][_0x1da8ea(0x91)][_0x1da8ea(0x93)]({'where':{'shopId':_0x586694}});!_0x525ed4&&await database_1[_0x1da8ea(0x97)][_0x1da8ea(0x91)][_0x1da8ea(0x8d)]({'data':{'shopId':_0x586694}});}}exports[a58_0x28a083(0x9f)]=IntegrationsService;