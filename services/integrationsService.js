'use strict';const a43_0x493167=a43_0x3ad5;(function(_0x39368f,_0x3bdb5a){const _0x49cbc9=a43_0x3ad5,_0x3ced5d=_0x39368f();while(!![]){try{const _0x86b0bc=parseInt(_0x49cbc9(0x10e))/0x1*(-parseInt(_0x49cbc9(0x111))/0x2)+parseInt(_0x49cbc9(0x118))/0x3*(-parseInt(_0x49cbc9(0x108))/0x4)+-parseInt(_0x49cbc9(0x106))/0x5*(parseInt(_0x49cbc9(0x104))/0x6)+-parseInt(_0x49cbc9(0x10c))/0x7+parseInt(_0x49cbc9(0x110))/0x8+parseInt(_0x49cbc9(0x10f))/0x9+parseInt(_0x49cbc9(0x101))/0xa*(parseInt(_0x49cbc9(0x113))/0xb);if(_0x86b0bc===_0x3bdb5a)break;else _0x3ced5d['push'](_0x3ced5d['shift']());}catch(_0x183a09){_0x3ced5d['push'](_0x3ced5d['shift']());}}}(a43_0x52e5,0xe8ab5));function a43_0x3ad5(_0x4e10e8,_0x13363a){const _0x52e5da=a43_0x52e5();return a43_0x3ad5=function(_0x3ad555,_0x3a01c2){_0x3ad555=_0x3ad555-0x101;let _0x1a9eaa=_0x52e5da[_0x3ad555];return _0x1a9eaa;},a43_0x3ad5(_0x4e10e8,_0x13363a);}var __importDefault=this&&this['__importDefault']||function(_0x595df4){const _0xeb9ea7=a43_0x3ad5;return _0x595df4&&_0x595df4[_0xeb9ea7(0x115)]?_0x595df4:{'default':_0x595df4};};function a43_0x52e5(){const _0x346254=['update','323ZToSYk','11049579dCJscR','2715176xTclGP','3194cAHjzE','IntegrationsService','22FCKxNO','../config/database','__esModule','ensureSettingsExist','Shop\x20settings\x20not\x20found','30HqvjXA','default','8513060hhrWGw','isArray','parse','4089822cIVkjI','webhookUrl','5yCZVaG','getIntegrations','379964PvKurr','parseWebhookEvents','shopSettings','webhookEvents','1185443eEmskr'];a43_0x52e5=function(){return _0x346254;};return a43_0x52e5();}Object['defineProperty'](exports,a43_0x493167(0x115),{'value':!![]}),exports[a43_0x493167(0x112)]=void 0x0;const database_1=__importDefault(require(a43_0x493167(0x114)));class IntegrationsService{[a43_0x493167(0x109)](_0x2e59a1){const _0x56b251=a43_0x493167;if(!_0x2e59a1)return[];if(Array[_0x56b251(0x102)](_0x2e59a1))return _0x2e59a1;if(typeof _0x2e59a1==='string')try{const _0x362796=JSON[_0x56b251(0x103)](_0x2e59a1);return Array[_0x56b251(0x102)](_0x362796)?_0x362796:[];}catch{return[];}return[];}async[a43_0x493167(0x107)](_0x58a008){const _0xf4f0be=a43_0x493167;await this[_0xf4f0be(0x116)](_0x58a008);const _0x160976=await database_1['default'][_0xf4f0be(0x10a)]['findUnique']({'where':{'shopId':_0x58a008},'select':{'webhookUrl':!![],'webhookEvents':!![]}});if(!_0x160976)throw new Error(_0xf4f0be(0x117));return{'webhook':{'url':_0x160976[_0xf4f0be(0x105)],'events':this[_0xf4f0be(0x109)](_0x160976[_0xf4f0be(0x10b)])}};}async['updateWebhookSettings'](_0x2b5947,_0x2b26aa){const _0x522c5d=a43_0x493167;await this[_0x522c5d(0x116)](_0x2b5947);const _0x5bb0d5={};_0x2b26aa[_0x522c5d(0x105)]!==undefined&&(_0x5bb0d5['webhookUrl']=_0x2b26aa[_0x522c5d(0x105)]||null),_0x2b26aa[_0x522c5d(0x10b)]!==undefined&&(_0x5bb0d5[_0x522c5d(0x10b)]=_0x2b26aa[_0x522c5d(0x10b)]||[]),await database_1['default']['shopSettings'][_0x522c5d(0x10d)]({'where':{'shopId':_0x2b5947},'data':_0x5bb0d5});}async['ensureSettingsExist'](_0x1dff89){const _0x41265a=a43_0x493167,_0x2eeb74=await database_1[_0x41265a(0x119)][_0x41265a(0x10a)]['findUnique']({'where':{'shopId':_0x1dff89}});!_0x2eeb74&&await database_1[_0x41265a(0x119)][_0x41265a(0x10a)]['create']({'data':{'shopId':_0x1dff89}});}}exports['IntegrationsService']=IntegrationsService;