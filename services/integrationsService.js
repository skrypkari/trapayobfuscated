'use strict';const a48_0x2057e7=a48_0x25a8;function a48_0x25a8(_0x465600,_0x1a5141){const _0x21158e=a48_0x2115();return a48_0x25a8=function(_0x25a848,_0x55aeca){_0x25a848=_0x25a848-0x167;let _0x43959b=_0x21158e[_0x25a848];return _0x43959b;},a48_0x25a8(_0x465600,_0x1a5141);}function a48_0x2115(){const _0x22069b=['isArray','create','findUnique','444145qDnVMk','parseWebhookEvents','__importDefault','shopSettings','ensureSettingsExist','Shop\x20settings\x20not\x20found','6172560rYEodK','5369268kjHTNv','1497632CezqJy','8UXXfkV','2015692RJVTHK','defineProperty','getIntegrations','string','1256477qzeYrF','15846rzTdwG','parse','default','webhookEvents','../config/database','webhookUrl','IntegrationsService','update','__esModule'];a48_0x2115=function(){return _0x22069b;};return a48_0x2115();}(function(_0x46accf,_0x14c043){const _0x5b3143=a48_0x25a8,_0x5f4134=_0x46accf();while(!![]){try{const _0x176f3a=parseInt(_0x5b3143(0x16e))/0x1+-parseInt(_0x5b3143(0x168))/0x2+parseInt(_0x5b3143(0x16f))/0x3*(-parseInt(_0x5b3143(0x169))/0x4)+parseInt(_0x5b3143(0x17b))/0x5+-parseInt(_0x5b3143(0x167))/0x6+parseInt(_0x5b3143(0x16a))/0x7+parseInt(_0x5b3143(0x181))/0x8;if(_0x176f3a===_0x14c043)break;else _0x5f4134['push'](_0x5f4134['shift']());}catch(_0x2626dc){_0x5f4134['push'](_0x5f4134['shift']());}}}(a48_0x2115,0xb73ee));var __importDefault=this&&this[a48_0x2057e7(0x17d)]||function(_0x17fc68){const _0x509077=a48_0x2057e7;return _0x17fc68&&_0x17fc68[_0x509077(0x177)]?_0x17fc68:{'default':_0x17fc68};};Object[a48_0x2057e7(0x16b)](exports,a48_0x2057e7(0x177),{'value':!![]}),exports[a48_0x2057e7(0x175)]=void 0x0;const database_1=__importDefault(require(a48_0x2057e7(0x173)));class IntegrationsService{['parseWebhookEvents'](_0x3f83a7){const _0x409bd5=a48_0x2057e7;if(!_0x3f83a7)return[];if(Array[_0x409bd5(0x178)](_0x3f83a7))return _0x3f83a7;if(typeof _0x3f83a7===_0x409bd5(0x16d))try{const _0xff0aa2=JSON[_0x409bd5(0x170)](_0x3f83a7);return Array[_0x409bd5(0x178)](_0xff0aa2)?_0xff0aa2:[];}catch{return[];}return[];}async[a48_0x2057e7(0x16c)](_0x22e485){const _0x1400bb=a48_0x2057e7;await this[_0x1400bb(0x17f)](_0x22e485);const _0x1fe521=await database_1[_0x1400bb(0x171)][_0x1400bb(0x17e)]['findUnique']({'where':{'shopId':_0x22e485},'select':{'webhookUrl':!![],'webhookEvents':!![]}});if(!_0x1fe521)throw new Error(_0x1400bb(0x180));return{'webhook':{'url':_0x1fe521[_0x1400bb(0x174)],'events':this[_0x1400bb(0x17c)](_0x1fe521[_0x1400bb(0x172)])}};}async['updateWebhookSettings'](_0x178e50,_0x4b70d3){const _0x363dc7=a48_0x2057e7;await this[_0x363dc7(0x17f)](_0x178e50);const _0x28b50c={};_0x4b70d3[_0x363dc7(0x174)]!==undefined&&(_0x28b50c['webhookUrl']=_0x4b70d3[_0x363dc7(0x174)]||null),_0x4b70d3[_0x363dc7(0x172)]!==undefined&&(_0x28b50c[_0x363dc7(0x172)]=_0x4b70d3['webhookEvents']||[]),await database_1[_0x363dc7(0x171)][_0x363dc7(0x17e)][_0x363dc7(0x176)]({'where':{'shopId':_0x178e50},'data':_0x28b50c});}async[a48_0x2057e7(0x17f)](_0x54dd1e){const _0x29b61=a48_0x2057e7,_0x68af08=await database_1[_0x29b61(0x171)][_0x29b61(0x17e)][_0x29b61(0x17a)]({'where':{'shopId':_0x54dd1e}});!_0x68af08&&await database_1[_0x29b61(0x171)][_0x29b61(0x17e)][_0x29b61(0x179)]({'data':{'shopId':_0x54dd1e}});}}exports['IntegrationsService']=IntegrationsService;