'use strict';const a66_0x49dde2=a66_0x1c86;(function(_0xdfe14c,_0x2cf027){const _0x5d2bc1=a66_0x1c86,_0x333aff=_0xdfe14c();while(!![]){try{const _0x43707d=-parseInt(_0x5d2bc1(0x1e4))/0x1+parseInt(_0x5d2bc1(0x1d2))/0x2*(parseInt(_0x5d2bc1(0x1df))/0x3)+parseInt(_0x5d2bc1(0x1d6))/0x4+-parseInt(_0x5d2bc1(0x1e6))/0x5+-parseInt(_0x5d2bc1(0x1d7))/0x6*(parseInt(_0x5d2bc1(0x1d5))/0x7)+parseInt(_0x5d2bc1(0x1d4))/0x8+-parseInt(_0x5d2bc1(0x1de))/0x9*(-parseInt(_0x5d2bc1(0x1d1))/0xa);if(_0x43707d===_0x2cf027)break;else _0x333aff['push'](_0x333aff['shift']());}catch(_0x2ecac3){_0x333aff['push'](_0x333aff['shift']());}}}(a66_0x1c43,0x5b7e4));var __importDefault=this&&this['__importDefault']||function(_0x4993dc){const _0x4410d8=a66_0x1c86;return _0x4993dc&&_0x4993dc[_0x4410d8(0x1dc)]?_0x4993dc:{'default':_0x4993dc};};Object[a66_0x49dde2(0x1e3)](exports,a66_0x49dde2(0x1dc),{'value':!![]}),exports['IntegrationsService']=void 0x0;const database_1=__importDefault(require('../config/database'));class IntegrationsService{[a66_0x49dde2(0x1d3)](_0x9402d3){const _0x2e979e=a66_0x49dde2;if(!_0x9402d3)return[];if(Array[_0x2e979e(0x1e2)](_0x9402d3))return _0x9402d3;if(typeof _0x9402d3===_0x2e979e(0x1d9))try{const _0x25e4a8=JSON['parse'](_0x9402d3);return Array[_0x2e979e(0x1e2)](_0x25e4a8)?_0x25e4a8:[];}catch{return[];}return[];}async[a66_0x49dde2(0x1e5)](_0x1f9df5){const _0x2d97d4=a66_0x49dde2;await this[_0x2d97d4(0x1e1)](_0x1f9df5);const _0x3e5005=await database_1[_0x2d97d4(0x1db)]['shopSettings'][_0x2d97d4(0x1d8)]({'where':{'shopId':_0x1f9df5},'select':{'webhookUrl':!![],'webhookEvents':!![]}});if(!_0x3e5005)throw new Error(_0x2d97d4(0x1dd));return{'webhook':{'url':_0x3e5005['webhookUrl'],'events':this[_0x2d97d4(0x1d3)](_0x3e5005[_0x2d97d4(0x1e0)])}};}async['updateWebhookSettings'](_0x482e51,_0x4004d6){const _0x5baadf=a66_0x49dde2;await this[_0x5baadf(0x1e1)](_0x482e51);const _0x279716={};_0x4004d6[_0x5baadf(0x1da)]!==undefined&&(_0x279716[_0x5baadf(0x1da)]=_0x4004d6['webhookUrl']||null),_0x4004d6['webhookEvents']!==undefined&&(_0x279716[_0x5baadf(0x1e0)]=_0x4004d6[_0x5baadf(0x1e0)]||[]),await database_1[_0x5baadf(0x1db)]['shopSettings']['update']({'where':{'shopId':_0x482e51},'data':_0x279716});}async[a66_0x49dde2(0x1e1)](_0x9a46d7){const _0x54ee56=a66_0x49dde2,_0x143c04=await database_1[_0x54ee56(0x1db)]['shopSettings'][_0x54ee56(0x1d8)]({'where':{'shopId':_0x9a46d7}});!_0x143c04&&await database_1[_0x54ee56(0x1db)]['shopSettings']['create']({'data':{'shopId':_0x9a46d7}});}}function a66_0x1c86(_0x17f6cb,_0x35d141){_0x17f6cb=_0x17f6cb-0x1d1;const _0x1c433c=a66_0x1c43();let _0x1c8601=_0x1c433c[_0x17f6cb];return _0x1c8601;}exports['IntegrationsService']=IntegrationsService;function a66_0x1c43(){const _0x1474dd=['parseWebhookEvents','2646304BPUAgr','225141POgtBO','1851264HwEwUc','96linbmo','findUnique','string','webhookUrl','default','__esModule','Shop\x20settings\x20not\x20found','701109dwGDiW','3090qvPgre','webhookEvents','ensureSettingsExist','isArray','defineProperty','244102cBWuaQ','getIntegrations','1788065UncxRX','50SISZga','598TtAMbG'];a66_0x1c43=function(){return _0x1474dd;};return a66_0x1c43();}