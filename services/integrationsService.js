'use strict';const a43_0x374d5b=a43_0x5d3e;function a43_0x5dd2(){const _0x2f6f5f=['../config/database','default','shopSettings','1667454MPBWom','webhookEvents','ensureSettingsExist','61zcpIrW','getIntegrations','isArray','10638018YDyyZh','findUnique','32590oGXRjd','4578025SWwlDU','webhookUrl','2897484BKuMqf','__esModule','parseWebhookEvents','string','parse','428724JQuMui','create','update','IntegrationsService','2949080uuRUpe','7giIpiY','defineProperty'];a43_0x5dd2=function(){return _0x2f6f5f;};return a43_0x5dd2();}(function(_0x3ce9dd,_0x1c0ff7){const _0x444939=a43_0x5d3e,_0x270e2e=_0x3ce9dd();while(!![]){try{const _0x2ac13e=parseInt(_0x444939(0x11c))/0x1*(parseInt(_0x444939(0x107))/0x2)+-parseInt(_0x444939(0x119))/0x3+-parseInt(_0x444939(0x10a))/0x4+-parseInt(_0x444939(0x108))/0x5+parseInt(_0x444939(0x105))/0x6+parseInt(_0x444939(0x114))/0x7*(parseInt(_0x444939(0x113))/0x8)+-parseInt(_0x444939(0x10f))/0x9;if(_0x2ac13e===_0x1c0ff7)break;else _0x270e2e['push'](_0x270e2e['shift']());}catch(_0x3a8289){_0x270e2e['push'](_0x270e2e['shift']());}}}(a43_0x5dd2,0xd9d2b));var __importDefault=this&&this['__importDefault']||function(_0x2a545e){const _0x5d56fd=a43_0x5d3e;return _0x2a545e&&_0x2a545e[_0x5d56fd(0x10b)]?_0x2a545e:{'default':_0x2a545e};};Object[a43_0x374d5b(0x115)](exports,'__esModule',{'value':!![]}),exports['IntegrationsService']=void 0x0;const database_1=__importDefault(require(a43_0x374d5b(0x116)));function a43_0x5d3e(_0x3bbbc1,_0x3ea05a){const _0x5dd24e=a43_0x5dd2();return a43_0x5d3e=function(_0x5d3e9a,_0xc39640){_0x5d3e9a=_0x5d3e9a-0x103;let _0xa3b204=_0x5dd24e[_0x5d3e9a];return _0xa3b204;},a43_0x5d3e(_0x3bbbc1,_0x3ea05a);}class IntegrationsService{['parseWebhookEvents'](_0x1f0bbe){const _0x345c8b=a43_0x374d5b;if(!_0x1f0bbe)return[];if(Array[_0x345c8b(0x104)](_0x1f0bbe))return _0x1f0bbe;if(typeof _0x1f0bbe===_0x345c8b(0x10d))try{const _0x1e3c7d=JSON[_0x345c8b(0x10e)](_0x1f0bbe);return Array[_0x345c8b(0x104)](_0x1e3c7d)?_0x1e3c7d:[];}catch{return[];}return[];}async[a43_0x374d5b(0x103)](_0x5bfff7){const _0x343600=a43_0x374d5b;await this[_0x343600(0x11b)](_0x5bfff7);const _0x1cfe13=await database_1[_0x343600(0x117)]['shopSettings'][_0x343600(0x106)]({'where':{'shopId':_0x5bfff7},'select':{'webhookUrl':!![],'webhookEvents':!![]}});if(!_0x1cfe13)throw new Error('Shop\x20settings\x20not\x20found');return{'webhook':{'url':_0x1cfe13[_0x343600(0x109)],'events':this[_0x343600(0x10c)](_0x1cfe13['webhookEvents'])}};}async['updateWebhookSettings'](_0x4f4db0,_0x5971f7){const _0x45c0fd=a43_0x374d5b;await this[_0x45c0fd(0x11b)](_0x4f4db0);const _0x49c785={};_0x5971f7[_0x45c0fd(0x109)]!==undefined&&(_0x49c785[_0x45c0fd(0x109)]=_0x5971f7[_0x45c0fd(0x109)]||null),_0x5971f7[_0x45c0fd(0x11a)]!==undefined&&(_0x49c785[_0x45c0fd(0x11a)]=_0x5971f7[_0x45c0fd(0x11a)]||[]),await database_1[_0x45c0fd(0x117)][_0x45c0fd(0x118)][_0x45c0fd(0x111)]({'where':{'shopId':_0x4f4db0},'data':_0x49c785});}async[a43_0x374d5b(0x11b)](_0x4ab624){const _0x56ec97=a43_0x374d5b,_0x4a5392=await database_1[_0x56ec97(0x117)][_0x56ec97(0x118)]['findUnique']({'where':{'shopId':_0x4ab624}});!_0x4a5392&&await database_1[_0x56ec97(0x117)][_0x56ec97(0x118)][_0x56ec97(0x110)]({'data':{'shopId':_0x4ab624}});}}exports[a43_0x374d5b(0x112)]=IntegrationsService;