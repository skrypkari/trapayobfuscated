'use strict';const a50_0x174ae1=a50_0x37c8;function a50_0x4cdd(){const _0x39d463=['20187wjKwmz','parseWebhookEvents','Shop\x20settings\x20not\x20found','238392vEySNu','default','updateWebhookSettings','1434ezljYq','19872hpxDue','update','618661AHIEeD','shopSettings','isArray','defineProperty','../config/database','ensureSettingsExist','IntegrationsService','92cHkqfu','2028845fdxgCw','parse','webhookEvents','__esModule','findUnique','webhookUrl','create','32VlwmvR','211870DBsVqa','__importDefault','10775RmzSkb'];a50_0x4cdd=function(){return _0x39d463;};return a50_0x4cdd();}(function(_0x5e4e64,_0x2f8c82){const _0x5b4206=a50_0x37c8,_0x481b8d=_0x5e4e64();while(!![]){try{const _0x3d7d3c=parseInt(_0x5b4206(0x1aa))/0x1+parseInt(_0x5b4206(0x1c0))/0x2+-parseInt(_0x5b4206(0x1bd))/0x3*(-parseInt(_0x5b4206(0x1b1))/0x4)+parseInt(_0x5b4206(0x1bc))/0x5*(-parseInt(_0x5b4206(0x1c3))/0x6)+parseInt(_0x5b4206(0x1b2))/0x7+-parseInt(_0x5b4206(0x1b9))/0x8*(-parseInt(_0x5b4206(0x1c4))/0x9)+parseInt(_0x5b4206(0x1ba))/0xa;if(_0x3d7d3c===_0x2f8c82)break;else _0x481b8d['push'](_0x481b8d['shift']());}catch(_0x52157d){_0x481b8d['push'](_0x481b8d['shift']());}}}(a50_0x4cdd,0xaa459));function a50_0x37c8(_0x483032,_0xd71383){const _0x4cdd0e=a50_0x4cdd();return a50_0x37c8=function(_0x37c847,_0x143b50){_0x37c847=_0x37c847-0x1aa;let _0x24b700=_0x4cdd0e[_0x37c847];return _0x24b700;},a50_0x37c8(_0x483032,_0xd71383);}var __importDefault=this&&this[a50_0x174ae1(0x1bb)]||function(_0x4cf518){return _0x4cf518&&_0x4cf518['__esModule']?_0x4cf518:{'default':_0x4cf518};};Object[a50_0x174ae1(0x1ad)](exports,a50_0x174ae1(0x1b5),{'value':!![]}),exports['IntegrationsService']=void 0x0;const database_1=__importDefault(require(a50_0x174ae1(0x1ae)));class IntegrationsService{['parseWebhookEvents'](_0x365462){const _0x442636=a50_0x174ae1;if(!_0x365462)return[];if(Array[_0x442636(0x1ac)](_0x365462))return _0x365462;if(typeof _0x365462==='string')try{const _0x1b5fa6=JSON[_0x442636(0x1b3)](_0x365462);return Array[_0x442636(0x1ac)](_0x1b5fa6)?_0x1b5fa6:[];}catch{return[];}return[];}async['getIntegrations'](_0x31c47a){const _0x1ed18f=a50_0x174ae1;await this[_0x1ed18f(0x1af)](_0x31c47a);const _0x2e85b3=await database_1[_0x1ed18f(0x1c1)][_0x1ed18f(0x1ab)][_0x1ed18f(0x1b6)]({'where':{'shopId':_0x31c47a},'select':{'webhookUrl':!![],'webhookEvents':!![]}});if(!_0x2e85b3)throw new Error(_0x1ed18f(0x1bf));return{'webhook':{'url':_0x2e85b3[_0x1ed18f(0x1b7)],'events':this[_0x1ed18f(0x1be)](_0x2e85b3['webhookEvents'])}};}async[a50_0x174ae1(0x1c2)](_0x5b83b0,_0x3a1797){const _0x53805c=a50_0x174ae1;await this[_0x53805c(0x1af)](_0x5b83b0);const _0x424d95={};_0x3a1797[_0x53805c(0x1b7)]!==undefined&&(_0x424d95[_0x53805c(0x1b7)]=_0x3a1797[_0x53805c(0x1b7)]||null),_0x3a1797[_0x53805c(0x1b4)]!==undefined&&(_0x424d95[_0x53805c(0x1b4)]=_0x3a1797[_0x53805c(0x1b4)]||[]),await database_1[_0x53805c(0x1c1)][_0x53805c(0x1ab)][_0x53805c(0x1c5)]({'where':{'shopId':_0x5b83b0},'data':_0x424d95});}async[a50_0x174ae1(0x1af)](_0x51c445){const _0x5875c0=a50_0x174ae1,_0x420cb6=await database_1['default']['shopSettings'][_0x5875c0(0x1b6)]({'where':{'shopId':_0x51c445}});!_0x420cb6&&await database_1[_0x5875c0(0x1c1)]['shopSettings'][_0x5875c0(0x1b8)]({'data':{'shopId':_0x51c445}});}}exports[a50_0x174ae1(0x1b0)]=IntegrationsService;