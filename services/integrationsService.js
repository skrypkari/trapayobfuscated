'use strict';const a66_0x205ea2=a66_0x314a;function a66_0x314a(_0x3acd28,_0x27e8b3){_0x3acd28=_0x3acd28-0x1e6;const _0x3aaa42=a66_0x3aaa();let _0x314a4b=_0x3aaa42[_0x3acd28];return _0x314a4b;}function a66_0x3aaa(){const _0x4f89a4=['866930iYyaoq','isArray','webhookEvents','8392JsmkRW','28548Wcvlkd','__importDefault','findUnique','getIntegrations','create','shopSettings','__esModule','default','defineProperty','5211kpUIsJ','webhookUrl','93774tBqyMT','updateWebhookSettings','4pnwdqM','3443BFQZUa','string','ensureSettingsExist','814nUuorV','742WPPWgv','15010720zGEUXE','IntegrationsService','12891ZkocQA','parseWebhookEvents','984781gAwbwF','Shop\x20settings\x20not\x20found'];a66_0x3aaa=function(){return _0x4f89a4;};return a66_0x3aaa();}(function(_0x258005,_0x594be5){const _0x4f0671=a66_0x314a,_0x2ed1e6=_0x258005();while(!![]){try{const _0x161a44=parseInt(_0x4f0671(0x201))/0x1+parseInt(_0x4f0671(0x1fb))/0x2*(-parseInt(_0x4f0671(0x1ff))/0x3)+-parseInt(_0x4f0671(0x1f7))/0x4*(-parseInt(_0x4f0671(0x1e6))/0x5)+-parseInt(_0x4f0671(0x1f5))/0x6*(-parseInt(_0x4f0671(0x1fc))/0x7)+parseInt(_0x4f0671(0x1e9))/0x8*(parseInt(_0x4f0671(0x1f3))/0x9)+-parseInt(_0x4f0671(0x1fd))/0xa+-parseInt(_0x4f0671(0x1f8))/0xb*(-parseInt(_0x4f0671(0x1ea))/0xc);if(_0x161a44===_0x594be5)break;else _0x2ed1e6['push'](_0x2ed1e6['shift']());}catch(_0x5f3cfc){_0x2ed1e6['push'](_0x2ed1e6['shift']());}}}(a66_0x3aaa,0xdfd98));var __importDefault=this&&this[a66_0x205ea2(0x1eb)]||function(_0x25505b){const _0x58f5d8=a66_0x205ea2;return _0x25505b&&_0x25505b[_0x58f5d8(0x1f0)]?_0x25505b:{'default':_0x25505b};};Object[a66_0x205ea2(0x1f2)](exports,a66_0x205ea2(0x1f0),{'value':!![]}),exports[a66_0x205ea2(0x1fe)]=void 0x0;const database_1=__importDefault(require('../config/database'));class IntegrationsService{[a66_0x205ea2(0x200)](_0x3a5049){const _0x172b6a=a66_0x205ea2;if(!_0x3a5049)return[];if(Array['isArray'](_0x3a5049))return _0x3a5049;if(typeof _0x3a5049===_0x172b6a(0x1f9))try{const _0x54d6d3=JSON['parse'](_0x3a5049);return Array[_0x172b6a(0x1e7)](_0x54d6d3)?_0x54d6d3:[];}catch{return[];}return[];}async[a66_0x205ea2(0x1ed)](_0x5cabdb){const _0x47a9e8=a66_0x205ea2;await this[_0x47a9e8(0x1fa)](_0x5cabdb);const _0x20b6ed=await database_1['default'][_0x47a9e8(0x1ef)][_0x47a9e8(0x1ec)]({'where':{'shopId':_0x5cabdb},'select':{'webhookUrl':!![],'webhookEvents':!![]}});if(!_0x20b6ed)throw new Error(_0x47a9e8(0x202));return{'webhook':{'url':_0x20b6ed[_0x47a9e8(0x1f4)],'events':this['parseWebhookEvents'](_0x20b6ed[_0x47a9e8(0x1e8)])}};}async[a66_0x205ea2(0x1f6)](_0x253d97,_0x3e42f2){const _0x1e3cc2=a66_0x205ea2;await this[_0x1e3cc2(0x1fa)](_0x253d97);const _0x5d7b1c={};_0x3e42f2[_0x1e3cc2(0x1f4)]!==undefined&&(_0x5d7b1c['webhookUrl']=_0x3e42f2[_0x1e3cc2(0x1f4)]||null),_0x3e42f2[_0x1e3cc2(0x1e8)]!==undefined&&(_0x5d7b1c['webhookEvents']=_0x3e42f2[_0x1e3cc2(0x1e8)]||[]),await database_1['default'][_0x1e3cc2(0x1ef)]['update']({'where':{'shopId':_0x253d97},'data':_0x5d7b1c});}async[a66_0x205ea2(0x1fa)](_0x49f216){const _0xf99c68=a66_0x205ea2,_0x146242=await database_1[_0xf99c68(0x1f1)]['shopSettings'][_0xf99c68(0x1ec)]({'where':{'shopId':_0x49f216}});!_0x146242&&await database_1[_0xf99c68(0x1f1)][_0xf99c68(0x1ef)][_0xf99c68(0x1ee)]({'data':{'shopId':_0x49f216}});}}exports['IntegrationsService']=IntegrationsService;