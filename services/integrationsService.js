'use strict';const a47_0x1c7cd4=a47_0x255e;(function(_0x16f787,_0x181024){const _0x19d1bf=a47_0x255e,_0x38703b=_0x16f787();while(!![]){try{const _0x1dac1a=-parseInt(_0x19d1bf(0x1b9))/0x1+parseInt(_0x19d1bf(0x1be))/0x2+parseInt(_0x19d1bf(0x1ba))/0x3*(parseInt(_0x19d1bf(0x1b3))/0x4)+-parseInt(_0x19d1bf(0x1ad))/0x5+parseInt(_0x19d1bf(0x1c1))/0x6*(parseInt(_0x19d1bf(0x1b1))/0x7)+parseInt(_0x19d1bf(0x1b4))/0x8*(-parseInt(_0x19d1bf(0x1ae))/0x9)+parseInt(_0x19d1bf(0x1c3))/0xa;if(_0x1dac1a===_0x181024)break;else _0x38703b['push'](_0x38703b['shift']());}catch(_0x2f1cd3){_0x38703b['push'](_0x38703b['shift']());}}}(a47_0x3be0,0x296a4));function a47_0x255e(_0x1d3ccf,_0x24f9bb){const _0x3be003=a47_0x3be0();return a47_0x255e=function(_0x255e5e,_0x11e35f){_0x255e5e=_0x255e5e-0x1a9;let _0x3ed052=_0x3be003[_0x255e5e];return _0x3ed052;},a47_0x255e(_0x1d3ccf,_0x24f9bb);}var __importDefault=this&&this['__importDefault']||function(_0x2abf06){const _0x581e0e=a47_0x255e;return _0x2abf06&&_0x2abf06[_0x581e0e(0x1aa)]?_0x2abf06:{'default':_0x2abf06};};Object['defineProperty'](exports,a47_0x1c7cd4(0x1aa),{'value':!![]}),exports[a47_0x1c7cd4(0x1b2)]=void 0x0;const database_1=__importDefault(require(a47_0x1c7cd4(0x1bf)));class IntegrationsService{['parseWebhookEvents'](_0x37500e){const _0x5dcf4c=a47_0x1c7cd4;if(!_0x37500e)return[];if(Array[_0x5dcf4c(0x1ab)](_0x37500e))return _0x37500e;if(typeof _0x37500e===_0x5dcf4c(0x1b0))try{const _0x258358=JSON[_0x5dcf4c(0x1b7)](_0x37500e);return Array['isArray'](_0x258358)?_0x258358:[];}catch{return[];}return[];}async[a47_0x1c7cd4(0x1bd)](_0x15815f){const _0xb038d2=a47_0x1c7cd4;await this[_0xb038d2(0x1af)](_0x15815f);const _0x53bd09=await database_1['default']['shopSettings'][_0xb038d2(0x1a9)]({'where':{'shopId':_0x15815f},'select':{'webhookUrl':!![],'webhookEvents':!![]}});if(!_0x53bd09)throw new Error('Shop\x20settings\x20not\x20found');return{'webhook':{'url':_0x53bd09[_0xb038d2(0x1b6)],'events':this[_0xb038d2(0x1c2)](_0x53bd09[_0xb038d2(0x1bc)])}};}async[a47_0x1c7cd4(0x1bb)](_0xb24aa2,_0x19ec6f){const _0x159ed5=a47_0x1c7cd4;await this[_0x159ed5(0x1af)](_0xb24aa2);const _0x23a707={};_0x19ec6f[_0x159ed5(0x1b6)]!==undefined&&(_0x23a707[_0x159ed5(0x1b6)]=_0x19ec6f['webhookUrl']||null),_0x19ec6f[_0x159ed5(0x1bc)]!==undefined&&(_0x23a707[_0x159ed5(0x1bc)]=_0x19ec6f[_0x159ed5(0x1bc)]||[]),await database_1[_0x159ed5(0x1b5)][_0x159ed5(0x1b8)][_0x159ed5(0x1ac)]({'where':{'shopId':_0xb24aa2},'data':_0x23a707});}async['ensureSettingsExist'](_0x4c5a6){const _0x1cda4f=a47_0x1c7cd4,_0x3367b4=await database_1['default']['shopSettings'][_0x1cda4f(0x1a9)]({'where':{'shopId':_0x4c5a6}});!_0x3367b4&&await database_1[_0x1cda4f(0x1b5)][_0x1cda4f(0x1b8)][_0x1cda4f(0x1c0)]({'data':{'shopId':_0x4c5a6}});}}exports[a47_0x1c7cd4(0x1b2)]=IntegrationsService;function a47_0x3be0(){const _0x44922c=['isArray','update','1474710OwuBxy','45XacdMO','ensureSettingsExist','string','7PbAypf','IntegrationsService','76GNTAbC','287032omTPPu','default','webhookUrl','parse','shopSettings','15919CpkAnb','1845atOGEs','updateWebhookSettings','webhookEvents','getIntegrations','377008dCRIHy','../config/database','create','1526142NxjBVY','parseWebhookEvents','2053460cbtWDs','findUnique','__esModule'];a47_0x3be0=function(){return _0x44922c;};return a47_0x3be0();}