'use strict';function a50_0x3b1e(){const _0x57c7fe=['default','isArray','updateWebhookSettings','5OcxgXf','defineProperty','895618kYlRRq','update','findUnique','965880OpkEjN','getIntegrations','shopSettings','webhookUrl','__esModule','parse','parseWebhookEvents','ensureSettingsExist','Shop\x20settings\x20not\x20found','21311mbAQYd','903780YRrIls','IntegrationsService','26084Slmnuy','994956spclES','644049UJLrZA','webhookEvents','3XBuOga'];a50_0x3b1e=function(){return _0x57c7fe;};return a50_0x3b1e();}const a50_0x2ce9bc=a50_0x1944;(function(_0x440a20,_0x2ec105){const _0x26a4f9=a50_0x1944,_0x29ac4a=_0x440a20();while(!![]){try{const _0x110246=parseInt(_0x26a4f9(0x133))/0x1+-parseInt(_0x26a4f9(0x127))/0x2*(-parseInt(_0x26a4f9(0x121))/0x3)+parseInt(_0x26a4f9(0x136))/0x4*(-parseInt(_0x26a4f9(0x125))/0x5)+-parseInt(_0x26a4f9(0x11e))/0x6+-parseInt(_0x26a4f9(0x11f))/0x7+parseInt(_0x26a4f9(0x12a))/0x8+-parseInt(_0x26a4f9(0x134))/0x9;if(_0x110246===_0x2ec105)break;else _0x29ac4a['push'](_0x29ac4a['shift']());}catch(_0x1c2e20){_0x29ac4a['push'](_0x29ac4a['shift']());}}}(a50_0x3b1e,0x36f39));var __importDefault=this&&this['__importDefault']||function(_0xf2bbd7){const _0x56ab9b=a50_0x1944;return _0xf2bbd7&&_0xf2bbd7[_0x56ab9b(0x12e)]?_0xf2bbd7:{'default':_0xf2bbd7};};function a50_0x1944(_0x5742f1,_0x3b7e59){const _0x3b1e6a=a50_0x3b1e();return a50_0x1944=function(_0x1944d5,_0x261012){_0x1944d5=_0x1944d5-0x11e;let _0x276166=_0x3b1e6a[_0x1944d5];return _0x276166;},a50_0x1944(_0x5742f1,_0x3b7e59);}Object[a50_0x2ce9bc(0x126)](exports,a50_0x2ce9bc(0x12e),{'value':!![]}),exports[a50_0x2ce9bc(0x135)]=void 0x0;const database_1=__importDefault(require('../config/database'));class IntegrationsService{[a50_0x2ce9bc(0x130)](_0x36ec24){const _0x19d1c2=a50_0x2ce9bc;if(!_0x36ec24)return[];if(Array[_0x19d1c2(0x123)](_0x36ec24))return _0x36ec24;if(typeof _0x36ec24==='string')try{const _0x3f37c2=JSON[_0x19d1c2(0x12f)](_0x36ec24);return Array[_0x19d1c2(0x123)](_0x3f37c2)?_0x3f37c2:[];}catch{return[];}return[];}async[a50_0x2ce9bc(0x12b)](_0x28b768){const _0x5420ed=a50_0x2ce9bc;await this[_0x5420ed(0x131)](_0x28b768);const _0x226d37=await database_1['default']['shopSettings'][_0x5420ed(0x129)]({'where':{'shopId':_0x28b768},'select':{'webhookUrl':!![],'webhookEvents':!![]}});if(!_0x226d37)throw new Error(_0x5420ed(0x132));return{'webhook':{'url':_0x226d37[_0x5420ed(0x12d)],'events':this[_0x5420ed(0x130)](_0x226d37['webhookEvents'])}};}async[a50_0x2ce9bc(0x124)](_0x485c2e,_0x473964){const _0x3e9b32=a50_0x2ce9bc;await this['ensureSettingsExist'](_0x485c2e);const _0x583d50={};_0x473964[_0x3e9b32(0x12d)]!==undefined&&(_0x583d50[_0x3e9b32(0x12d)]=_0x473964[_0x3e9b32(0x12d)]||null),_0x473964['webhookEvents']!==undefined&&(_0x583d50[_0x3e9b32(0x120)]=_0x473964[_0x3e9b32(0x120)]||[]),await database_1[_0x3e9b32(0x122)][_0x3e9b32(0x12c)][_0x3e9b32(0x128)]({'where':{'shopId':_0x485c2e},'data':_0x583d50});}async[a50_0x2ce9bc(0x131)](_0x5d9d54){const _0xd1bb28=a50_0x2ce9bc,_0x5424b9=await database_1['default'][_0xd1bb28(0x12c)][_0xd1bb28(0x129)]({'where':{'shopId':_0x5d9d54}});!_0x5424b9&&await database_1[_0xd1bb28(0x122)][_0xd1bb28(0x12c)]['create']({'data':{'shopId':_0x5d9d54}});}}exports[a50_0x2ce9bc(0x135)]=IntegrationsService;