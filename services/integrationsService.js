'use strict';const a78_0x1a811e=a78_0x5f39;(function(_0xce3e94,_0xfbf750){const _0xa8eed3=a78_0x5f39,_0x5af548=_0xce3e94();while(!![]){try{const _0x2542b6=-parseInt(_0xa8eed3(0x114))/0x1*(parseInt(_0xa8eed3(0x127))/0x2)+-parseInt(_0xa8eed3(0x113))/0x3+-parseInt(_0xa8eed3(0x121))/0x4*(parseInt(_0xa8eed3(0x12c))/0x5)+-parseInt(_0xa8eed3(0x125))/0x6*(parseInt(_0xa8eed3(0x117))/0x7)+parseInt(_0xa8eed3(0x11c))/0x8*(-parseInt(_0xa8eed3(0x122))/0x9)+-parseInt(_0xa8eed3(0x116))/0xa+parseInt(_0xa8eed3(0x11f))/0xb;if(_0x2542b6===_0xfbf750)break;else _0x5af548['push'](_0x5af548['shift']());}catch(_0x3c518e){_0x5af548['push'](_0x5af548['shift']());}}}(a78_0x1bc5,0xe85f9));var __importDefault=this&&this[a78_0x1a811e(0x120)]||function(_0x372472){const _0x453fba=a78_0x1a811e;return _0x372472&&_0x372472[_0x453fba(0x124)]?_0x372472:{'default':_0x372472};};Object['defineProperty'](exports,a78_0x1a811e(0x124),{'value':!![]}),exports[a78_0x1a811e(0x126)]=void 0x0;const database_1=__importDefault(require(a78_0x1a811e(0x118)));class IntegrationsService{[a78_0x1a811e(0x115)](_0x3413d7){const _0x2f1d70=a78_0x1a811e;if(!_0x3413d7)return[];if(Array[_0x2f1d70(0x12e)](_0x3413d7))return _0x3413d7;if(typeof _0x3413d7===_0x2f1d70(0x12f))try{const _0x4426af=JSON[_0x2f1d70(0x119)](_0x3413d7);return Array[_0x2f1d70(0x12e)](_0x4426af)?_0x4426af:[];}catch{return[];}return[];}async[a78_0x1a811e(0x12b)](_0x257d85){const _0x23d218=a78_0x1a811e;await this['ensureSettingsExist'](_0x257d85);const _0x59adaa=await database_1['default'][_0x23d218(0x11e)]['findUnique']({'where':{'shopId':_0x257d85},'select':{'webhookUrl':!![],'webhookEvents':!![]}});if(!_0x59adaa)throw new Error(_0x23d218(0x129));return{'webhook':{'url':_0x59adaa[_0x23d218(0x123)],'events':this[_0x23d218(0x115)](_0x59adaa[_0x23d218(0x128)])}};}async[a78_0x1a811e(0x12a)](_0x42ee7a,_0x1b1205){const _0x370733=a78_0x1a811e;await this[_0x370733(0x11d)](_0x42ee7a);const _0x4dc44b={};_0x1b1205[_0x370733(0x123)]!==undefined&&(_0x4dc44b[_0x370733(0x123)]=_0x1b1205[_0x370733(0x123)]||null),_0x1b1205[_0x370733(0x128)]!==undefined&&(_0x4dc44b['webhookEvents']=_0x1b1205[_0x370733(0x128)]||[]),await database_1[_0x370733(0x12d)][_0x370733(0x11e)][_0x370733(0x11a)]({'where':{'shopId':_0x42ee7a},'data':_0x4dc44b});}async['ensureSettingsExist'](_0x1c72eb){const _0x4a4a59=a78_0x1a811e,_0x470b3f=await database_1[_0x4a4a59(0x12d)][_0x4a4a59(0x11e)][_0x4a4a59(0x11b)]({'where':{'shopId':_0x1c72eb}});!_0x470b3f&&await database_1[_0x4a4a59(0x12d)][_0x4a4a59(0x11e)]['create']({'data':{'shopId':_0x1c72eb}});}}function a78_0x1bc5(){const _0x41772a=['138271NaWOln','../config/database','parse','update','findUnique','8aFOfrr','ensureSettingsExist','shopSettings','87785027EMEmwk','__importDefault','186400ddtVPA','11373426wqpmhK','webhookUrl','__esModule','300FHqPzv','IntegrationsService','22kmKzWE','webhookEvents','Shop\x20settings\x20not\x20found','updateWebhookSettings','getIntegrations','115jrEsrK','default','isArray','string','5037942NATcRT','121331XapbXh','parseWebhookEvents','6915370VSKHPq'];a78_0x1bc5=function(){return _0x41772a;};return a78_0x1bc5();}function a78_0x5f39(_0xaf9476,_0x426ede){_0xaf9476=_0xaf9476-0x113;const _0x1bc5c4=a78_0x1bc5();let _0x5f39e3=_0x1bc5c4[_0xaf9476];return _0x5f39e3;}exports[a78_0x1a811e(0x126)]=IntegrationsService;