'use strict';const a43_0x532523=a43_0xbba1;(function(_0x1aa31f,_0x2a5efe){const _0x272ea7=a43_0xbba1,_0x4202dc=_0x1aa31f();while(!![]){try{const _0x5e4cf2=-parseInt(_0x272ea7(0xeb))/0x1+parseInt(_0x272ea7(0xed))/0x2+-parseInt(_0x272ea7(0xfb))/0x3*(parseInt(_0x272ea7(0xf4))/0x4)+-parseInt(_0x272ea7(0xf7))/0x5+parseInt(_0x272ea7(0xf3))/0x6*(parseInt(_0x272ea7(0xe4))/0x7)+parseInt(_0x272ea7(0xe7))/0x8*(parseInt(_0x272ea7(0xe2))/0x9)+-parseInt(_0x272ea7(0xef))/0xa;if(_0x5e4cf2===_0x2a5efe)break;else _0x4202dc['push'](_0x4202dc['shift']());}catch(_0xe3b803){_0x4202dc['push'](_0x4202dc['shift']());}}}(a43_0x1244,0xb27d7));function a43_0x1244(){const _0x2feb65=['IntegrationsService','ensureSettingsExist','parseWebhookEvents','509117oPOuMs','default','1910142NLVdsi','shopSettings','2253230oAornB','getIntegrations','string','findUnique','7260024iAmBjB','340172KGBnFK','create','__esModule','2541605ZpuTrj','isArray','webhookEvents','webhookUrl','45rBJgkI','../config/database','Shop\x20settings\x20not\x20found','4879917zfUcda','__importDefault','7PpOBVu','defineProperty','update','16yBrNLo'];a43_0x1244=function(){return _0x2feb65;};return a43_0x1244();}function a43_0xbba1(_0x383aae,_0x2e4aee){const _0x124463=a43_0x1244();return a43_0xbba1=function(_0xbba1fa,_0x231c70){_0xbba1fa=_0xbba1fa-0xe0;let _0x5c5c6e=_0x124463[_0xbba1fa];return _0x5c5c6e;},a43_0xbba1(_0x383aae,_0x2e4aee);}var __importDefault=this&&this[a43_0x532523(0xe3)]||function(_0x5c6ab2){const _0xa7582=a43_0x532523;return _0x5c6ab2&&_0x5c6ab2[_0xa7582(0xf6)]?_0x5c6ab2:{'default':_0x5c6ab2};};Object[a43_0x532523(0xe5)](exports,a43_0x532523(0xf6),{'value':!![]}),exports[a43_0x532523(0xe8)]=void 0x0;const database_1=__importDefault(require(a43_0x532523(0xe0)));class IntegrationsService{[a43_0x532523(0xea)](_0x2477f4){const _0x50307a=a43_0x532523;if(!_0x2477f4)return[];if(Array['isArray'](_0x2477f4))return _0x2477f4;if(typeof _0x2477f4===_0x50307a(0xf1))try{const _0x19f471=JSON['parse'](_0x2477f4);return Array[_0x50307a(0xf8)](_0x19f471)?_0x19f471:[];}catch{return[];}return[];}async[a43_0x532523(0xf0)](_0x512c92){const _0x4962c9=a43_0x532523;await this[_0x4962c9(0xe9)](_0x512c92);const _0x1a44f3=await database_1[_0x4962c9(0xec)]['shopSettings'][_0x4962c9(0xf2)]({'where':{'shopId':_0x512c92},'select':{'webhookUrl':!![],'webhookEvents':!![]}});if(!_0x1a44f3)throw new Error(_0x4962c9(0xe1));return{'webhook':{'url':_0x1a44f3[_0x4962c9(0xfa)],'events':this[_0x4962c9(0xea)](_0x1a44f3[_0x4962c9(0xf9)])}};}async['updateWebhookSettings'](_0x3e5901,_0x3b6332){const _0x4f167b=a43_0x532523;await this['ensureSettingsExist'](_0x3e5901);const _0x3fc8b2={};_0x3b6332[_0x4f167b(0xfa)]!==undefined&&(_0x3fc8b2['webhookUrl']=_0x3b6332[_0x4f167b(0xfa)]||null),_0x3b6332[_0x4f167b(0xf9)]!==undefined&&(_0x3fc8b2[_0x4f167b(0xf9)]=_0x3b6332['webhookEvents']||[]),await database_1[_0x4f167b(0xec)][_0x4f167b(0xee)][_0x4f167b(0xe6)]({'where':{'shopId':_0x3e5901},'data':_0x3fc8b2});}async[a43_0x532523(0xe9)](_0x58315d){const _0x4728bb=a43_0x532523,_0x52553e=await database_1[_0x4728bb(0xec)][_0x4728bb(0xee)][_0x4728bb(0xf2)]({'where':{'shopId':_0x58315d}});!_0x52553e&&await database_1[_0x4728bb(0xec)][_0x4728bb(0xee)][_0x4728bb(0xf5)]({'data':{'shopId':_0x58315d}});}}exports['IntegrationsService']=IntegrationsService;