'use strict';const a46_0x516f6c=a46_0x5826;(function(_0x4292a0,_0x35b7d1){const _0x70950d=a46_0x5826,_0x576e27=_0x4292a0();while(!![]){try{const _0x598aff=-parseInt(_0x70950d(0xc7))/0x1*(-parseInt(_0x70950d(0xc2))/0x2)+parseInt(_0x70950d(0xd4))/0x3*(parseInt(_0x70950d(0xd2))/0x4)+-parseInt(_0x70950d(0xbf))/0x5*(-parseInt(_0x70950d(0xca))/0x6)+-parseInt(_0x70950d(0xd0))/0x7+-parseInt(_0x70950d(0xcd))/0x8*(-parseInt(_0x70950d(0xc4))/0x9)+parseInt(_0x70950d(0xd7))/0xa+-parseInt(_0x70950d(0xc0))/0xb;if(_0x598aff===_0x35b7d1)break;else _0x576e27['push'](_0x576e27['shift']());}catch(_0x47095e){_0x576e27['push'](_0x576e27['shift']());}}}(a46_0x4dc8,0x8b2a7));function a46_0x4dc8(){const _0x53380e=['parseWebhookEvents','2391207reLVqY','defineProperty','2044JWYdaW','isArray','1335FAYcxs','webhookUrl','__esModule','5447440XpYsns','../config/database','30830nqkKFZ','14473932BGCqOF','IntegrationsService','32356hOjfrX','webhookEvents','45AVAviS','update','__importDefault','46dLmKFO','default','shopSettings','204KSimtm','parse','ensureSettingsExist','802344pmbTZO','create'];a46_0x4dc8=function(){return _0x53380e;};return a46_0x4dc8();}var __importDefault=this&&this[a46_0x516f6c(0xc6)]||function(_0x45ffd5){const _0x4abb19=a46_0x516f6c;return _0x45ffd5&&_0x45ffd5[_0x4abb19(0xd6)]?_0x45ffd5:{'default':_0x45ffd5};};function a46_0x5826(_0x888269,_0x68f46){const _0x4dc8f6=a46_0x4dc8();return a46_0x5826=function(_0x58267b,_0x19d22d){_0x58267b=_0x58267b-0xbf;let _0x5cafe9=_0x4dc8f6[_0x58267b];return _0x5cafe9;},a46_0x5826(_0x888269,_0x68f46);}Object[a46_0x516f6c(0xd1)](exports,a46_0x516f6c(0xd6),{'value':!![]}),exports['IntegrationsService']=void 0x0;const database_1=__importDefault(require(a46_0x516f6c(0xd8)));class IntegrationsService{['parseWebhookEvents'](_0x57a92b){const _0x2f81a2=a46_0x516f6c;if(!_0x57a92b)return[];if(Array[_0x2f81a2(0xd3)](_0x57a92b))return _0x57a92b;if(typeof _0x57a92b==='string')try{const _0x541763=JSON[_0x2f81a2(0xcb)](_0x57a92b);return Array[_0x2f81a2(0xd3)](_0x541763)?_0x541763:[];}catch{return[];}return[];}async['getIntegrations'](_0x11fe84){const _0x34198b=a46_0x516f6c;await this[_0x34198b(0xcc)](_0x11fe84);const _0x349e44=await database_1[_0x34198b(0xc8)][_0x34198b(0xc9)]['findUnique']({'where':{'shopId':_0x11fe84},'select':{'webhookUrl':!![],'webhookEvents':!![]}});if(!_0x349e44)throw new Error('Shop\x20settings\x20not\x20found');return{'webhook':{'url':_0x349e44[_0x34198b(0xd5)],'events':this[_0x34198b(0xcf)](_0x349e44[_0x34198b(0xc3)])}};}async['updateWebhookSettings'](_0x130f2f,_0x107ad3){const _0x5747e5=a46_0x516f6c;await this[_0x5747e5(0xcc)](_0x130f2f);const _0x229888={};_0x107ad3[_0x5747e5(0xd5)]!==undefined&&(_0x229888[_0x5747e5(0xd5)]=_0x107ad3[_0x5747e5(0xd5)]||null),_0x107ad3[_0x5747e5(0xc3)]!==undefined&&(_0x229888['webhookEvents']=_0x107ad3[_0x5747e5(0xc3)]||[]),await database_1['default']['shopSettings'][_0x5747e5(0xc5)]({'where':{'shopId':_0x130f2f},'data':_0x229888});}async[a46_0x516f6c(0xcc)](_0x2c8169){const _0x5d0aac=a46_0x516f6c,_0x816650=await database_1['default'][_0x5d0aac(0xc9)]['findUnique']({'where':{'shopId':_0x2c8169}});!_0x816650&&await database_1[_0x5d0aac(0xc8)]['shopSettings'][_0x5d0aac(0xce)]({'data':{'shopId':_0x2c8169}});}}exports[a46_0x516f6c(0xc1)]=IntegrationsService;