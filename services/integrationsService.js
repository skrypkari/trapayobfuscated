'use strict';const a47_0x25aa57=a47_0x28e8;(function(_0xcb20a8,_0x528eb4){const _0x1d113e=a47_0x28e8,_0x5f2b78=_0xcb20a8();while(!![]){try{const _0x552b53=parseInt(_0x1d113e(0xea))/0x1+-parseInt(_0x1d113e(0xf6))/0x2*(-parseInt(_0x1d113e(0xf5))/0x3)+-parseInt(_0x1d113e(0xeb))/0x4+parseInt(_0x1d113e(0xfb))/0x5*(parseInt(_0x1d113e(0xe6))/0x6)+-parseInt(_0x1d113e(0xee))/0x7+-parseInt(_0x1d113e(0xf0))/0x8+-parseInt(_0x1d113e(0xe5))/0x9;if(_0x552b53===_0x528eb4)break;else _0x5f2b78['push'](_0x5f2b78['shift']());}catch(_0x89bc00){_0x5f2b78['push'](_0x5f2b78['shift']());}}}(a47_0x163f,0x69aa1));var __importDefault=this&&this['__importDefault']||function(_0x599762){const _0x55f5a7=a47_0x28e8;return _0x599762&&_0x599762[_0x55f5a7(0xe4)]?_0x599762:{'default':_0x599762};};function a47_0x163f(){const _0x41a261=['3VytrCg','1094646umubNd','IntegrationsService','webhookUrl','isArray','ensureSettingsExist','5mGATun','__esModule','7607403EEVNBD','4558926kvdZoB','shopSettings','updateWebhookSettings','defineProperty','281218VGSZet','234124QEoIEX','../config/database','findUnique','1229116GBXuWF','string','609400HMaeMo','parseWebhookEvents','default','parse','webhookEvents'];a47_0x163f=function(){return _0x41a261;};return a47_0x163f();}Object[a47_0x25aa57(0xe9)](exports,a47_0x25aa57(0xe4),{'value':!![]}),exports[a47_0x25aa57(0xf7)]=void 0x0;function a47_0x28e8(_0xdb57ae,_0x40b52a){const _0x163f50=a47_0x163f();return a47_0x28e8=function(_0x28e89b,_0x19b128){_0x28e89b=_0x28e89b-0xe4;let _0x3c2b9f=_0x163f50[_0x28e89b];return _0x3c2b9f;},a47_0x28e8(_0xdb57ae,_0x40b52a);}const database_1=__importDefault(require(a47_0x25aa57(0xec)));class IntegrationsService{['parseWebhookEvents'](_0xea4590){const _0x4acc01=a47_0x25aa57;if(!_0xea4590)return[];if(Array[_0x4acc01(0xf9)](_0xea4590))return _0xea4590;if(typeof _0xea4590===_0x4acc01(0xef))try{const _0x2812a0=JSON[_0x4acc01(0xf3)](_0xea4590);return Array[_0x4acc01(0xf9)](_0x2812a0)?_0x2812a0:[];}catch{return[];}return[];}async['getIntegrations'](_0xc2a4d4){const _0x42b394=a47_0x25aa57;await this[_0x42b394(0xfa)](_0xc2a4d4);const _0x4d88eb=await database_1[_0x42b394(0xf2)][_0x42b394(0xe7)]['findUnique']({'where':{'shopId':_0xc2a4d4},'select':{'webhookUrl':!![],'webhookEvents':!![]}});if(!_0x4d88eb)throw new Error('Shop\x20settings\x20not\x20found');return{'webhook':{'url':_0x4d88eb[_0x42b394(0xf8)],'events':this[_0x42b394(0xf1)](_0x4d88eb[_0x42b394(0xf4)])}};}async[a47_0x25aa57(0xe8)](_0x4d9d87,_0x4f19ee){const _0x54bff9=a47_0x25aa57;await this[_0x54bff9(0xfa)](_0x4d9d87);const _0x3f7298={};_0x4f19ee[_0x54bff9(0xf8)]!==undefined&&(_0x3f7298[_0x54bff9(0xf8)]=_0x4f19ee[_0x54bff9(0xf8)]||null),_0x4f19ee['webhookEvents']!==undefined&&(_0x3f7298[_0x54bff9(0xf4)]=_0x4f19ee[_0x54bff9(0xf4)]||[]),await database_1[_0x54bff9(0xf2)][_0x54bff9(0xe7)]['update']({'where':{'shopId':_0x4d9d87},'data':_0x3f7298});}async['ensureSettingsExist'](_0xd0297d){const _0x4eaa9d=a47_0x25aa57,_0x44e18b=await database_1[_0x4eaa9d(0xf2)][_0x4eaa9d(0xe7)][_0x4eaa9d(0xed)]({'where':{'shopId':_0xd0297d}});!_0x44e18b&&await database_1[_0x4eaa9d(0xf2)][_0x4eaa9d(0xe7)]['create']({'data':{'shopId':_0xd0297d}});}}exports[a47_0x25aa57(0xf7)]=IntegrationsService;