'use strict';const a43_0x3f570f=a43_0x12e5;function a43_0x12e5(_0x571440,_0xe24fa4){const _0x27870c=a43_0x2787();return a43_0x12e5=function(_0x12e5a3,_0x3b7848){_0x12e5a3=_0x12e5a3-0x92;let _0xc01272=_0x27870c[_0x12e5a3];return _0xc01272;},a43_0x12e5(_0x571440,_0xe24fa4);}(function(_0x3d3ce1,_0xf809b9){const _0x39dfdf=a43_0x12e5,_0x599c30=_0x3d3ce1();while(!![]){try{const _0x249121=parseInt(_0x39dfdf(0xa4))/0x1+-parseInt(_0x39dfdf(0x95))/0x2+parseInt(_0x39dfdf(0x9d))/0x3+-parseInt(_0x39dfdf(0x93))/0x4*(-parseInt(_0x39dfdf(0xab))/0x5)+parseInt(_0x39dfdf(0xa0))/0x6*(parseInt(_0x39dfdf(0x99))/0x7)+parseInt(_0x39dfdf(0xa6))/0x8*(parseInt(_0x39dfdf(0x98))/0x9)+-parseInt(_0x39dfdf(0x9b))/0xa;if(_0x249121===_0xf809b9)break;else _0x599c30['push'](_0x599c30['shift']());}catch(_0x436d53){_0x599c30['push'](_0x599c30['shift']());}}}(a43_0x2787,0xc3df1));function a43_0x2787(){const _0x4f0cc5=['1684djgDMl','__esModule','1549652cNTxqN','isArray','webhookEvents','20349bCPMHs','49KvMjOn','findUnique','21680570wjVaRJ','shopSettings','2406633Wrecxk','parseWebhookEvents','string','549942EuRpZD','webhookUrl','__importDefault','update','1437602rWNOMi','Shop\x20settings\x20not\x20found','2584leCZBD','getIntegrations','../config/database','defineProperty','default','1585xmVHun','ensureSettingsExist'];a43_0x2787=function(){return _0x4f0cc5;};return a43_0x2787();}var __importDefault=this&&this[a43_0x3f570f(0xa2)]||function(_0x255cb5){const _0x390a86=a43_0x3f570f;return _0x255cb5&&_0x255cb5[_0x390a86(0x94)]?_0x255cb5:{'default':_0x255cb5};};Object[a43_0x3f570f(0xa9)](exports,'__esModule',{'value':!![]}),exports['IntegrationsService']=void 0x0;const database_1=__importDefault(require(a43_0x3f570f(0xa8)));class IntegrationsService{[a43_0x3f570f(0x9e)](_0x4c7fac){const _0x1fa50d=a43_0x3f570f;if(!_0x4c7fac)return[];if(Array[_0x1fa50d(0x96)](_0x4c7fac))return _0x4c7fac;if(typeof _0x4c7fac===_0x1fa50d(0x9f))try{const _0x1f12ab=JSON['parse'](_0x4c7fac);return Array[_0x1fa50d(0x96)](_0x1f12ab)?_0x1f12ab:[];}catch{return[];}return[];}async[a43_0x3f570f(0xa7)](_0x391920){const _0x4abe00=a43_0x3f570f;await this[_0x4abe00(0x92)](_0x391920);const _0x44476e=await database_1[_0x4abe00(0xaa)][_0x4abe00(0x9c)][_0x4abe00(0x9a)]({'where':{'shopId':_0x391920},'select':{'webhookUrl':!![],'webhookEvents':!![]}});if(!_0x44476e)throw new Error(_0x4abe00(0xa5));return{'webhook':{'url':_0x44476e[_0x4abe00(0xa1)],'events':this[_0x4abe00(0x9e)](_0x44476e[_0x4abe00(0x97)])}};}async['updateWebhookSettings'](_0x1292ce,_0x67ca3a){const _0x7edbb=a43_0x3f570f;await this[_0x7edbb(0x92)](_0x1292ce);const _0xe759db={};_0x67ca3a[_0x7edbb(0xa1)]!==undefined&&(_0xe759db[_0x7edbb(0xa1)]=_0x67ca3a['webhookUrl']||null),_0x67ca3a[_0x7edbb(0x97)]!==undefined&&(_0xe759db[_0x7edbb(0x97)]=_0x67ca3a[_0x7edbb(0x97)]||[]),await database_1[_0x7edbb(0xaa)][_0x7edbb(0x9c)][_0x7edbb(0xa3)]({'where':{'shopId':_0x1292ce},'data':_0xe759db});}async['ensureSettingsExist'](_0x1b8707){const _0x4d8176=a43_0x3f570f,_0x269d98=await database_1[_0x4d8176(0xaa)][_0x4d8176(0x9c)][_0x4d8176(0x9a)]({'where':{'shopId':_0x1b8707}});!_0x269d98&&await database_1[_0x4d8176(0xaa)][_0x4d8176(0x9c)]['create']({'data':{'shopId':_0x1b8707}});}}exports['IntegrationsService']=IntegrationsService;