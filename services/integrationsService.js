'use strict';const a66_0x17e816=a66_0x390f;function a66_0x1958(){const _0x4ffb60=['webhookEvents','parse','isArray','359900LtscSx','2358664oknvNx','webhookUrl','__esModule','158478KSIKDj','460050UEGDCD','13797584gmwTnN','2380182ZXGnoX','IntegrationsService','parseWebhookEvents','findUnique','1zpIeNg','Shop\x20settings\x20not\x20found','updateWebhookSettings','create','2659500NdGiHq','shopSettings','default','ensureSettingsExist','__importDefault'];a66_0x1958=function(){return _0x4ffb60;};return a66_0x1958();}function a66_0x390f(_0x476b52,_0x422ed8){_0x476b52=_0x476b52-0x19c;const _0x195845=a66_0x1958();let _0x390fd9=_0x195845[_0x476b52];return _0x390fd9;}(function(_0x327482,_0x3484b2){const _0x4b2c0c=a66_0x390f,_0x594dda=_0x327482();while(!![]){try{const _0x32a57b=parseInt(_0x4b2c0c(0x1b0))/0x1*(parseInt(_0x4b2c0c(0x1a9))/0x2)+-parseInt(_0x4b2c0c(0x1aa))/0x3+-parseInt(_0x4b2c0c(0x1a6))/0x4+parseInt(_0x4b2c0c(0x1a5))/0x5+-parseInt(_0x4b2c0c(0x19d))/0x6+-parseInt(_0x4b2c0c(0x1ac))/0x7+parseInt(_0x4b2c0c(0x1ab))/0x8;if(_0x32a57b===_0x3484b2)break;else _0x594dda['push'](_0x594dda['shift']());}catch(_0x35cb86){_0x594dda['push'](_0x594dda['shift']());}}}(a66_0x1958,0x555b9));var __importDefault=this&&this[a66_0x17e816(0x1a1)]||function(_0x69aa6){const _0x5bdda2=a66_0x17e816;return _0x69aa6&&_0x69aa6[_0x5bdda2(0x1a8)]?_0x69aa6:{'default':_0x69aa6};};Object['defineProperty'](exports,'__esModule',{'value':!![]}),exports[a66_0x17e816(0x1ad)]=void 0x0;const database_1=__importDefault(require('../config/database'));class IntegrationsService{[a66_0x17e816(0x1ae)](_0x13a284){const _0x5f4ef1=a66_0x17e816;if(!_0x13a284)return[];if(Array[_0x5f4ef1(0x1a4)](_0x13a284))return _0x13a284;if(typeof _0x13a284==='string')try{const _0x5c0c36=JSON[_0x5f4ef1(0x1a3)](_0x13a284);return Array[_0x5f4ef1(0x1a4)](_0x5c0c36)?_0x5c0c36:[];}catch{return[];}return[];}async['getIntegrations'](_0x3d6b9a){const _0x23b6c4=a66_0x17e816;await this[_0x23b6c4(0x1a0)](_0x3d6b9a);const _0x4bc0f5=await database_1[_0x23b6c4(0x19f)][_0x23b6c4(0x19e)][_0x23b6c4(0x1af)]({'where':{'shopId':_0x3d6b9a},'select':{'webhookUrl':!![],'webhookEvents':!![]}});if(!_0x4bc0f5)throw new Error(_0x23b6c4(0x1b1));return{'webhook':{'url':_0x4bc0f5['webhookUrl'],'events':this['parseWebhookEvents'](_0x4bc0f5[_0x23b6c4(0x1a2)])}};}async[a66_0x17e816(0x1b2)](_0x504ce9,_0x1f1bfa){const _0xdcd86b=a66_0x17e816;await this[_0xdcd86b(0x1a0)](_0x504ce9);const _0x5df192={};_0x1f1bfa[_0xdcd86b(0x1a7)]!==undefined&&(_0x5df192[_0xdcd86b(0x1a7)]=_0x1f1bfa[_0xdcd86b(0x1a7)]||null),_0x1f1bfa[_0xdcd86b(0x1a2)]!==undefined&&(_0x5df192[_0xdcd86b(0x1a2)]=_0x1f1bfa[_0xdcd86b(0x1a2)]||[]),await database_1[_0xdcd86b(0x19f)]['shopSettings']['update']({'where':{'shopId':_0x504ce9},'data':_0x5df192});}async[a66_0x17e816(0x1a0)](_0x4724de){const _0x424ae3=a66_0x17e816,_0x3bd50e=await database_1[_0x424ae3(0x19f)]['shopSettings'][_0x424ae3(0x1af)]({'where':{'shopId':_0x4724de}});!_0x3bd50e&&await database_1['default'][_0x424ae3(0x19e)][_0x424ae3(0x19c)]({'data':{'shopId':_0x4724de}});}}exports['IntegrationsService']=IntegrationsService;