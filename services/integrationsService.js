'use strict';const a47_0x544520=a47_0x47ba;(function(_0x5841e7,_0x354844){const _0x1b2368=a47_0x47ba,_0x557dc3=_0x5841e7();while(!![]){try{const _0x2137bb=parseInt(_0x1b2368(0xc0))/0x1*(parseInt(_0x1b2368(0xb3))/0x2)+parseInt(_0x1b2368(0xb4))/0x3+-parseInt(_0x1b2368(0xc1))/0x4+parseInt(_0x1b2368(0xc5))/0x5*(parseInt(_0x1b2368(0xc3))/0x6)+-parseInt(_0x1b2368(0xae))/0x7*(-parseInt(_0x1b2368(0xbe))/0x8)+-parseInt(_0x1b2368(0xb0))/0x9+-parseInt(_0x1b2368(0xc2))/0xa*(-parseInt(_0x1b2368(0xaf))/0xb);if(_0x2137bb===_0x354844)break;else _0x557dc3['push'](_0x557dc3['shift']());}catch(_0x380821){_0x557dc3['push'](_0x557dc3['shift']());}}}(a47_0x3c91,0x37c58));function a47_0x47ba(_0x4f8c35,_0x20dfe2){const _0x3c91c4=a47_0x3c91();return a47_0x47ba=function(_0x47ba82,_0x14349c){_0x47ba82=_0x47ba82-0xae;let _0x3a1b11=_0x3c91c4[_0x47ba82];return _0x3a1b11;},a47_0x47ba(_0x4f8c35,_0x20dfe2);}function a47_0x3c91(){const _0x2832d2=['../config/database','438bpXkFJ','716502brGzGM','shopSettings','findUnique','parseWebhookEvents','getIntegrations','string','__esModule','isArray','IntegrationsService','__importDefault','8aVFeJK','defineProperty','84rVzTQK','1250616RMezhL','930LZeXHW','6Pfrbit','parse','588635bflFmQ','webhookEvents','ensureSettingsExist','create','updateWebhookSettings','webhookUrl','770322HGgFKO','49643sLzoCR','3272562YRWAAL','default'];a47_0x3c91=function(){return _0x2832d2;};return a47_0x3c91();}var __importDefault=this&&this[a47_0x544520(0xbd)]||function(_0x41f8b1){return _0x41f8b1&&_0x41f8b1['__esModule']?_0x41f8b1:{'default':_0x41f8b1};};Object[a47_0x544520(0xbf)](exports,a47_0x544520(0xba),{'value':!![]}),exports[a47_0x544520(0xbc)]=void 0x0;const database_1=__importDefault(require(a47_0x544520(0xb2)));class IntegrationsService{[a47_0x544520(0xb7)](_0x6cba4a){const _0x3621a2=a47_0x544520;if(!_0x6cba4a)return[];if(Array[_0x3621a2(0xbb)](_0x6cba4a))return _0x6cba4a;if(typeof _0x6cba4a===_0x3621a2(0xb9))try{const _0xfd470f=JSON[_0x3621a2(0xc4)](_0x6cba4a);return Array[_0x3621a2(0xbb)](_0xfd470f)?_0xfd470f:[];}catch{return[];}return[];}async[a47_0x544520(0xb8)](_0x582d11){const _0x215945=a47_0x544520;await this[_0x215945(0xc7)](_0x582d11);const _0x396ac5=await database_1[_0x215945(0xb1)]['shopSettings'][_0x215945(0xb6)]({'where':{'shopId':_0x582d11},'select':{'webhookUrl':!![],'webhookEvents':!![]}});if(!_0x396ac5)throw new Error('Shop\x20settings\x20not\x20found');return{'webhook':{'url':_0x396ac5[_0x215945(0xca)],'events':this[_0x215945(0xb7)](_0x396ac5[_0x215945(0xc6)])}};}async[a47_0x544520(0xc9)](_0xc5cf79,_0x35c94d){const _0x3b84b3=a47_0x544520;await this[_0x3b84b3(0xc7)](_0xc5cf79);const _0x12bb9e={};_0x35c94d['webhookUrl']!==undefined&&(_0x12bb9e[_0x3b84b3(0xca)]=_0x35c94d[_0x3b84b3(0xca)]||null),_0x35c94d[_0x3b84b3(0xc6)]!==undefined&&(_0x12bb9e[_0x3b84b3(0xc6)]=_0x35c94d[_0x3b84b3(0xc6)]||[]),await database_1[_0x3b84b3(0xb1)]['shopSettings']['update']({'where':{'shopId':_0xc5cf79},'data':_0x12bb9e});}async[a47_0x544520(0xc7)](_0xae640c){const _0x162b8a=a47_0x544520,_0x16b642=await database_1[_0x162b8a(0xb1)][_0x162b8a(0xb5)][_0x162b8a(0xb6)]({'where':{'shopId':_0xae640c}});!_0x16b642&&await database_1[_0x162b8a(0xb1)]['shopSettings'][_0x162b8a(0xc8)]({'data':{'shopId':_0xae640c}});}}exports[a47_0x544520(0xbc)]=IntegrationsService;