'use strict';function a47_0x589a(){const _0x43f27a=['default','640955ZrNbuR','1179252MavKmZ','887520WVPZaw','ensureSettingsExist','create','6ZabYbR','webhookUrl','414hAKWTp','2432485cNIHbE','getIntegrations','updateWebhookSettings','Shop\x20settings\x20not\x20found','parseWebhookEvents','string','152BIaOLH','78XvOAWC','shopSettings','__esModule','58720CtwNfC','webhookEvents','../config/database','parse','64211BkcbOF','IntegrationsService','__importDefault','1890ZZQOgg','isArray'];a47_0x589a=function(){return _0x43f27a;};return a47_0x589a();}const a47_0x5309a1=a47_0x4ac1;(function(_0x1aa3ae,_0x30a28d){const _0x126e48=a47_0x4ac1,_0x1d2682=_0x1aa3ae();while(!![]){try{const _0x41c229=-parseInt(_0x126e48(0x158))/0x1*(parseInt(_0x126e48(0x14e))/0x2)+parseInt(_0x126e48(0x15d))/0x3+parseInt(_0x126e48(0x15c))/0x4+-parseInt(_0x126e48(0x15b))/0x5*(parseInt(_0x126e48(0x144))/0x6)+parseInt(_0x126e48(0x155))/0x7*(-parseInt(_0x126e48(0x14d))/0x8)+-parseInt(_0x126e48(0x146))/0x9*(parseInt(_0x126e48(0x151))/0xa)+parseInt(_0x126e48(0x147))/0xb;if(_0x41c229===_0x30a28d)break;else _0x1d2682['push'](_0x1d2682['shift']());}catch(_0x5aa15b){_0x1d2682['push'](_0x1d2682['shift']());}}}(a47_0x589a,0x28670));var __importDefault=this&&this[a47_0x5309a1(0x157)]||function(_0x15f1ad){const _0x297da3=a47_0x5309a1;return _0x15f1ad&&_0x15f1ad[_0x297da3(0x150)]?_0x15f1ad:{'default':_0x15f1ad};};Object['defineProperty'](exports,a47_0x5309a1(0x150),{'value':!![]}),exports[a47_0x5309a1(0x156)]=void 0x0;const database_1=__importDefault(require(a47_0x5309a1(0x153)));function a47_0x4ac1(_0x54c485,_0x3d4bee){const _0x589a9f=a47_0x589a();return a47_0x4ac1=function(_0x4ac1da,_0xbf6405){_0x4ac1da=_0x4ac1da-0x142;let _0x40f5c2=_0x589a9f[_0x4ac1da];return _0x40f5c2;},a47_0x4ac1(_0x54c485,_0x3d4bee);}class IntegrationsService{[a47_0x5309a1(0x14b)](_0xbc16c1){const _0x173a2e=a47_0x5309a1;if(!_0xbc16c1)return[];if(Array[_0x173a2e(0x159)](_0xbc16c1))return _0xbc16c1;if(typeof _0xbc16c1===_0x173a2e(0x14c))try{const _0x527336=JSON[_0x173a2e(0x154)](_0xbc16c1);return Array[_0x173a2e(0x159)](_0x527336)?_0x527336:[];}catch{return[];}return[];}async[a47_0x5309a1(0x148)](_0x3ec7c9){const _0x410928=a47_0x5309a1;await this['ensureSettingsExist'](_0x3ec7c9);const _0x24f37a=await database_1[_0x410928(0x15a)]['shopSettings']['findUnique']({'where':{'shopId':_0x3ec7c9},'select':{'webhookUrl':!![],'webhookEvents':!![]}});if(!_0x24f37a)throw new Error(_0x410928(0x14a));return{'webhook':{'url':_0x24f37a[_0x410928(0x145)],'events':this[_0x410928(0x14b)](_0x24f37a[_0x410928(0x152)])}};}async[a47_0x5309a1(0x149)](_0x2c4806,_0x3d7841){const _0x239169=a47_0x5309a1;await this[_0x239169(0x142)](_0x2c4806);const _0x5d04ac={};_0x3d7841['webhookUrl']!==undefined&&(_0x5d04ac[_0x239169(0x145)]=_0x3d7841[_0x239169(0x145)]||null),_0x3d7841[_0x239169(0x152)]!==undefined&&(_0x5d04ac[_0x239169(0x152)]=_0x3d7841[_0x239169(0x152)]||[]),await database_1['default'][_0x239169(0x14f)]['update']({'where':{'shopId':_0x2c4806},'data':_0x5d04ac});}async['ensureSettingsExist'](_0x2723ba){const _0x17f1cd=a47_0x5309a1,_0x4f22f9=await database_1[_0x17f1cd(0x15a)][_0x17f1cd(0x14f)]['findUnique']({'where':{'shopId':_0x2723ba}});!_0x4f22f9&&await database_1[_0x17f1cd(0x15a)][_0x17f1cd(0x14f)][_0x17f1cd(0x143)]({'data':{'shopId':_0x2723ba}});}}exports[a47_0x5309a1(0x156)]=IntegrationsService;