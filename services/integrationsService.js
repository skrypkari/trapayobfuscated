'use strict';function a50_0x9f40(){const _0x4cad97=['144745nUFuij','default','parseWebhookEvents','12WIZwUH','28921MSDsuM','IntegrationsService','string','ensureSettingsExist','getIntegrations','8087586gfNmqR','isArray','20ZuLYEJ','findUnique','1854769BImvnN','__importDefault','webhookEvents','69165aITFxW','267TbAEBY','796FWMFNb','__esModule','../config/database','shopSettings','webhookUrl','updateWebhookSettings','create','update','8xKZubB','28402jgZQDV','54ytJivO','parse','14GIsotq'];a50_0x9f40=function(){return _0x4cad97;};return a50_0x9f40();}const a50_0x5f0bfa=a50_0x3bad;(function(_0x410b68,_0xd407e2){const _0x1dd498=a50_0x3bad,_0xa11564=_0x410b68();while(!![]){try{const _0x30db4a=-parseInt(_0x1dd498(0xea))/0x1*(-parseInt(_0x1dd498(0xe5))/0x2)+-parseInt(_0x1dd498(0xf7))/0x3*(-parseInt(_0x1dd498(0xf8))/0x4)+parseInt(_0x1dd498(0xe6))/0x5*(parseInt(_0x1dd498(0xe3))/0x6)+-parseInt(_0x1dd498(0xf3))/0x7*(-parseInt(_0x1dd498(0xe1))/0x8)+parseInt(_0x1dd498(0xf6))/0x9+-parseInt(_0x1dd498(0xf1))/0xa*(-parseInt(_0x1dd498(0xe2))/0xb)+-parseInt(_0x1dd498(0xe9))/0xc*(parseInt(_0x1dd498(0xef))/0xd);if(_0x30db4a===_0xd407e2)break;else _0xa11564['push'](_0xa11564['shift']());}catch(_0x143fbb){_0xa11564['push'](_0xa11564['shift']());}}}(a50_0x9f40,0x214c9));var __importDefault=this&&this[a50_0x5f0bfa(0xf4)]||function(_0x52d5e8){const _0x4a4816=a50_0x5f0bfa;return _0x52d5e8&&_0x52d5e8[_0x4a4816(0xf9)]?_0x52d5e8:{'default':_0x52d5e8};};function a50_0x3bad(_0x5b35e9,_0x44513d){const _0x9f40e6=a50_0x9f40();return a50_0x3bad=function(_0x3bad14,_0x1c9610){_0x3bad14=_0x3bad14-0xdd;let _0x2ae1fa=_0x9f40e6[_0x3bad14];return _0x2ae1fa;},a50_0x3bad(_0x5b35e9,_0x44513d);}Object['defineProperty'](exports,a50_0x5f0bfa(0xf9),{'value':!![]}),exports[a50_0x5f0bfa(0xeb)]=void 0x0;const database_1=__importDefault(require(a50_0x5f0bfa(0xfa)));class IntegrationsService{[a50_0x5f0bfa(0xe8)](_0x37a56f){const _0x407673=a50_0x5f0bfa;if(!_0x37a56f)return[];if(Array[_0x407673(0xf0)](_0x37a56f))return _0x37a56f;if(typeof _0x37a56f===_0x407673(0xec))try{const _0x302429=JSON[_0x407673(0xe4)](_0x37a56f);return Array[_0x407673(0xf0)](_0x302429)?_0x302429:[];}catch{return[];}return[];}async[a50_0x5f0bfa(0xee)](_0x45f9f3){const _0x4889ac=a50_0x5f0bfa;await this['ensureSettingsExist'](_0x45f9f3);const _0x4e7e51=await database_1[_0x4889ac(0xe7)][_0x4889ac(0xfb)][_0x4889ac(0xf2)]({'where':{'shopId':_0x45f9f3},'select':{'webhookUrl':!![],'webhookEvents':!![]}});if(!_0x4e7e51)throw new Error('Shop\x20settings\x20not\x20found');return{'webhook':{'url':_0x4e7e51['webhookUrl'],'events':this['parseWebhookEvents'](_0x4e7e51['webhookEvents'])}};}async[a50_0x5f0bfa(0xde)](_0x80c243,_0x5e4300){const _0x5ea88b=a50_0x5f0bfa;await this[_0x5ea88b(0xed)](_0x80c243);const _0x41dfe0={};_0x5e4300[_0x5ea88b(0xdd)]!==undefined&&(_0x41dfe0[_0x5ea88b(0xdd)]=_0x5e4300[_0x5ea88b(0xdd)]||null),_0x5e4300[_0x5ea88b(0xf5)]!==undefined&&(_0x41dfe0[_0x5ea88b(0xf5)]=_0x5e4300['webhookEvents']||[]),await database_1['default'][_0x5ea88b(0xfb)][_0x5ea88b(0xe0)]({'where':{'shopId':_0x80c243},'data':_0x41dfe0});}async[a50_0x5f0bfa(0xed)](_0x41d11a){const _0x473d74=a50_0x5f0bfa,_0x137589=await database_1[_0x473d74(0xe7)][_0x473d74(0xfb)][_0x473d74(0xf2)]({'where':{'shopId':_0x41d11a}});!_0x137589&&await database_1[_0x473d74(0xe7)][_0x473d74(0xfb)][_0x473d74(0xdf)]({'data':{'shopId':_0x41d11a}});}}exports[a50_0x5f0bfa(0xeb)]=IntegrationsService;