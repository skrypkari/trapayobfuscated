'use strict';function a58_0x3bd5(){const _0xfc53fb=['shopSettings','ensureSettingsExist','findUnique','updateWebhookSettings','isArray','792256exzeLG','parse','10qAndgv','52elWOOM','IntegrationsService','string','webhookUrl','create','33549EslERb','2169076RJpHoi','__esModule','defineProperty','parseWebhookEvents','default','1309194AEgLTa','getIntegrations','webhookEvents','Shop\x20settings\x20not\x20found','1684IpCQjq','__importDefault','1088570KvnLDu','update','964476AwAQAm'];a58_0x3bd5=function(){return _0xfc53fb;};return a58_0x3bd5();}const a58_0x3438c8=a58_0x3a0c;(function(_0x528016,_0xd80dbc){const _0x18cd53=a58_0x3a0c,_0x392c24=_0x528016();while(!![]){try{const _0x1b20b0=-parseInt(_0x18cd53(0x150))/0x1*(-parseInt(_0x18cd53(0x144))/0x2)+-parseInt(_0x18cd53(0x13a))/0x3*(parseInt(_0x18cd53(0x151))/0x4)+-parseInt(_0x18cd53(0x146))/0x5+parseInt(_0x18cd53(0x148))/0x6+parseInt(_0x18cd53(0x13b))/0x7+-parseInt(_0x18cd53(0x14e))/0x8+parseInt(_0x18cd53(0x140))/0x9;if(_0x1b20b0===_0xd80dbc)break;else _0x392c24['push'](_0x392c24['shift']());}catch(_0x523b47){_0x392c24['push'](_0x392c24['shift']());}}}(a58_0x3bd5,0x27a47));var __importDefault=this&&this[a58_0x3438c8(0x145)]||function(_0x51c651){return _0x51c651&&_0x51c651['__esModule']?_0x51c651:{'default':_0x51c651};};function a58_0x3a0c(_0x2acf8b,_0x2bec83){const _0x3bd53d=a58_0x3bd5();return a58_0x3a0c=function(_0x3a0c6d,_0x54d64c){_0x3a0c6d=_0x3a0c6d-0x138;let _0x27e986=_0x3bd53d[_0x3a0c6d];return _0x27e986;},a58_0x3a0c(_0x2acf8b,_0x2bec83);}Object[a58_0x3438c8(0x13d)](exports,a58_0x3438c8(0x13c),{'value':!![]}),exports[a58_0x3438c8(0x152)]=void 0x0;const database_1=__importDefault(require('../config/database'));class IntegrationsService{[a58_0x3438c8(0x13e)](_0xc73d12){const _0x429946=a58_0x3438c8;if(!_0xc73d12)return[];if(Array[_0x429946(0x14d)](_0xc73d12))return _0xc73d12;if(typeof _0xc73d12===_0x429946(0x153))try{const _0x136f9b=JSON[_0x429946(0x14f)](_0xc73d12);return Array[_0x429946(0x14d)](_0x136f9b)?_0x136f9b:[];}catch{return[];}return[];}async[a58_0x3438c8(0x141)](_0x7aedd6){const _0x2d352e=a58_0x3438c8;await this[_0x2d352e(0x14a)](_0x7aedd6);const _0x4cb1b4=await database_1[_0x2d352e(0x13f)][_0x2d352e(0x149)][_0x2d352e(0x14b)]({'where':{'shopId':_0x7aedd6},'select':{'webhookUrl':!![],'webhookEvents':!![]}});if(!_0x4cb1b4)throw new Error(_0x2d352e(0x143));return{'webhook':{'url':_0x4cb1b4[_0x2d352e(0x138)],'events':this[_0x2d352e(0x13e)](_0x4cb1b4[_0x2d352e(0x142)])}};}async[a58_0x3438c8(0x14c)](_0x3f09c8,_0x19aff4){const _0x104f7f=a58_0x3438c8;await this['ensureSettingsExist'](_0x3f09c8);const _0x7d1f9a={};_0x19aff4['webhookUrl']!==undefined&&(_0x7d1f9a[_0x104f7f(0x138)]=_0x19aff4[_0x104f7f(0x138)]||null),_0x19aff4['webhookEvents']!==undefined&&(_0x7d1f9a[_0x104f7f(0x142)]=_0x19aff4[_0x104f7f(0x142)]||[]),await database_1['default'][_0x104f7f(0x149)][_0x104f7f(0x147)]({'where':{'shopId':_0x3f09c8},'data':_0x7d1f9a});}async[a58_0x3438c8(0x14a)](_0x59b207){const _0x242568=a58_0x3438c8,_0x3d5332=await database_1['default'][_0x242568(0x149)]['findUnique']({'where':{'shopId':_0x59b207}});!_0x3d5332&&await database_1[_0x242568(0x13f)]['shopSettings'][_0x242568(0x139)]({'data':{'shopId':_0x59b207}});}}exports[a58_0x3438c8(0x152)]=IntegrationsService;