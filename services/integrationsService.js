'use strict';function a47_0x2fef(_0x3ab4e1,_0x3408bf){const _0x12ba12=a47_0x12ba();return a47_0x2fef=function(_0x2fef3e,_0x456764){_0x2fef3e=_0x2fef3e-0xe7;let _0x114971=_0x12ba12[_0x2fef3e];return _0x114971;},a47_0x2fef(_0x3ab4e1,_0x3408bf);}const a47_0xf8cb01=a47_0x2fef;(function(_0x4a2fc4,_0x1e16c0){const _0x4bcd1c=a47_0x2fef,_0x21ac8d=_0x4a2fc4();while(!![]){try{const _0x1adde4=-parseInt(_0x4bcd1c(0xed))/0x1+-parseInt(_0x4bcd1c(0x101))/0x2*(parseInt(_0x4bcd1c(0xf8))/0x3)+-parseInt(_0x4bcd1c(0x102))/0x4*(parseInt(_0x4bcd1c(0xec))/0x5)+parseInt(_0x4bcd1c(0xf2))/0x6+parseInt(_0x4bcd1c(0xf4))/0x7+-parseInt(_0x4bcd1c(0x100))/0x8+parseInt(_0x4bcd1c(0xfe))/0x9;if(_0x1adde4===_0x1e16c0)break;else _0x21ac8d['push'](_0x21ac8d['shift']());}catch(_0xf9e52b){_0x21ac8d['push'](_0x21ac8d['shift']());}}}(a47_0x12ba,0xcaeb8));var __importDefault=this&&this[a47_0xf8cb01(0xf6)]||function(_0x389cd7){const _0x1955d0=a47_0xf8cb01;return _0x389cd7&&_0x389cd7[_0x1955d0(0xf1)]?_0x389cd7:{'default':_0x389cd7};};Object[a47_0xf8cb01(0xfd)](exports,a47_0xf8cb01(0xf1),{'value':!![]}),exports[a47_0xf8cb01(0xf7)]=void 0x0;const database_1=__importDefault(require(a47_0xf8cb01(0xfc)));class IntegrationsService{['parseWebhookEvents'](_0x2dec80){const _0x400447=a47_0xf8cb01;if(!_0x2dec80)return[];if(Array[_0x400447(0xee)](_0x2dec80))return _0x2dec80;if(typeof _0x2dec80===_0x400447(0xeb))try{const _0x388d46=JSON[_0x400447(0xf9)](_0x2dec80);return Array['isArray'](_0x388d46)?_0x388d46:[];}catch{return[];}return[];}async[a47_0xf8cb01(0xfa)](_0x1b2d4d){const _0x3273dd=a47_0xf8cb01;await this[_0x3273dd(0xfb)](_0x1b2d4d);const _0x140324=await database_1[_0x3273dd(0xf5)]['shopSettings']['findUnique']({'where':{'shopId':_0x1b2d4d},'select':{'webhookUrl':!![],'webhookEvents':!![]}});if(!_0x140324)throw new Error(_0x3273dd(0xe8));return{'webhook':{'url':_0x140324[_0x3273dd(0xef)],'events':this[_0x3273dd(0xe9)](_0x140324[_0x3273dd(0xff)])}};}async[a47_0xf8cb01(0xe7)](_0x28520c,_0x4f6d9a){const _0x5713f3=a47_0xf8cb01;await this['ensureSettingsExist'](_0x28520c);const _0x54d3f1={};_0x4f6d9a[_0x5713f3(0xef)]!==undefined&&(_0x54d3f1[_0x5713f3(0xef)]=_0x4f6d9a[_0x5713f3(0xef)]||null),_0x4f6d9a['webhookEvents']!==undefined&&(_0x54d3f1[_0x5713f3(0xff)]=_0x4f6d9a[_0x5713f3(0xff)]||[]),await database_1['default']['shopSettings'][_0x5713f3(0xea)]({'where':{'shopId':_0x28520c},'data':_0x54d3f1});}async[a47_0xf8cb01(0xfb)](_0x259724){const _0x3018eb=a47_0xf8cb01,_0x2f6292=await database_1[_0x3018eb(0xf5)][_0x3018eb(0xf3)][_0x3018eb(0xf0)]({'where':{'shopId':_0x259724}});!_0x2f6292&&await database_1[_0x3018eb(0xf5)][_0x3018eb(0xf3)]['create']({'data':{'shopId':_0x259724}});}}function a47_0x12ba(){const _0x2ca801=['shopSettings','5256006pyGjoL','default','__importDefault','IntegrationsService','6JGJFEk','parse','getIntegrations','ensureSettingsExist','../config/database','defineProperty','31406643bohfwb','webhookEvents','13083520NKCApd','1004918GRaXtS','467308YqNqaf','updateWebhookSettings','Shop\x20settings\x20not\x20found','parseWebhookEvents','update','string','20QlyBsX','1445557smzpxV','isArray','webhookUrl','findUnique','__esModule','6863388vmDMDn'];a47_0x12ba=function(){return _0x2ca801;};return a47_0x12ba();}exports['IntegrationsService']=IntegrationsService;