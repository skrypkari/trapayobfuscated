'use strict';const a47_0x5c6dc6=a47_0x1a76;(function(_0x56724c,_0x3f6707){const _0x4d01a3=a47_0x1a76,_0x541929=_0x56724c();while(!![]){try{const _0x4e16d4=parseInt(_0x4d01a3(0x11c))/0x1*(parseInt(_0x4d01a3(0x110))/0x2)+parseInt(_0x4d01a3(0x11d))/0x3+-parseInt(_0x4d01a3(0x114))/0x4*(-parseInt(_0x4d01a3(0x103))/0x5)+-parseInt(_0x4d01a3(0x112))/0x6*(parseInt(_0x4d01a3(0x106))/0x7)+parseInt(_0x4d01a3(0x100))/0x8*(parseInt(_0x4d01a3(0x10a))/0x9)+-parseInt(_0x4d01a3(0x116))/0xa*(parseInt(_0x4d01a3(0x101))/0xb)+-parseInt(_0x4d01a3(0x109))/0xc*(-parseInt(_0x4d01a3(0x119))/0xd);if(_0x4e16d4===_0x3f6707)break;else _0x541929['push'](_0x541929['shift']());}catch(_0xefe596){_0x541929['push'](_0x541929['shift']());}}}(a47_0x1a67,0xcd630));var __importDefault=this&&this[a47_0x5c6dc6(0x10e)]||function(_0x4499cb){return _0x4499cb&&_0x4499cb['__esModule']?_0x4499cb:{'default':_0x4499cb};};Object['defineProperty'](exports,a47_0x5c6dc6(0x10d),{'value':!![]}),exports[a47_0x5c6dc6(0x11a)]=void 0x0;function a47_0x1a67(){const _0x2b8881=['getIntegrations','2672033ZGNPqj','IntegrationsService','ensureSettingsExist','1vSrgcB','1236888VqHONX','isArray','232024TxKqjt','1492381rKvjVm','shopSettings','2166645wZLjYz','webhookUrl','../config/database','7625387KGBenT','updateWebhookSettings','update','24bIBSMA','81ENfrKn','findUnique','webhookEvents','__esModule','__importDefault','create','2725136vTlndn','default','6sEPAnc','parseWebhookEvents','4TwREbM','parse','70goBNXz','Shop\x20settings\x20not\x20found'];a47_0x1a67=function(){return _0x2b8881;};return a47_0x1a67();}function a47_0x1a76(_0x1d54ee,_0x8318e7){const _0x1a6772=a47_0x1a67();return a47_0x1a76=function(_0x1a7633,_0x5d6119){_0x1a7633=_0x1a7633-0x100;let _0x52fb3c=_0x1a6772[_0x1a7633];return _0x52fb3c;},a47_0x1a76(_0x1d54ee,_0x8318e7);}const database_1=__importDefault(require(a47_0x5c6dc6(0x105)));class IntegrationsService{[a47_0x5c6dc6(0x113)](_0x166f0c){const _0xf769e6=a47_0x5c6dc6;if(!_0x166f0c)return[];if(Array[_0xf769e6(0x11e)](_0x166f0c))return _0x166f0c;if(typeof _0x166f0c==='string')try{const _0xb3dddb=JSON[_0xf769e6(0x115)](_0x166f0c);return Array[_0xf769e6(0x11e)](_0xb3dddb)?_0xb3dddb:[];}catch{return[];}return[];}async[a47_0x5c6dc6(0x118)](_0x11b671){const _0x56c06d=a47_0x5c6dc6;await this[_0x56c06d(0x11b)](_0x11b671);const _0xf14d2=await database_1[_0x56c06d(0x111)][_0x56c06d(0x102)][_0x56c06d(0x10b)]({'where':{'shopId':_0x11b671},'select':{'webhookUrl':!![],'webhookEvents':!![]}});if(!_0xf14d2)throw new Error(_0x56c06d(0x117));return{'webhook':{'url':_0xf14d2[_0x56c06d(0x104)],'events':this[_0x56c06d(0x113)](_0xf14d2['webhookEvents'])}};}async[a47_0x5c6dc6(0x107)](_0x581dda,_0x1303df){const _0x5f5bd7=a47_0x5c6dc6;await this[_0x5f5bd7(0x11b)](_0x581dda);const _0x2cb6fd={};_0x1303df['webhookUrl']!==undefined&&(_0x2cb6fd[_0x5f5bd7(0x104)]=_0x1303df[_0x5f5bd7(0x104)]||null),_0x1303df[_0x5f5bd7(0x10c)]!==undefined&&(_0x2cb6fd[_0x5f5bd7(0x10c)]=_0x1303df[_0x5f5bd7(0x10c)]||[]),await database_1[_0x5f5bd7(0x111)][_0x5f5bd7(0x102)][_0x5f5bd7(0x108)]({'where':{'shopId':_0x581dda},'data':_0x2cb6fd});}async['ensureSettingsExist'](_0x5a6751){const _0x42abe9=a47_0x5c6dc6,_0x23a709=await database_1['default']['shopSettings'][_0x42abe9(0x10b)]({'where':{'shopId':_0x5a6751}});!_0x23a709&&await database_1['default']['shopSettings'][_0x42abe9(0x10f)]({'data':{'shopId':_0x5a6751}});}}exports[a47_0x5c6dc6(0x11a)]=IntegrationsService;