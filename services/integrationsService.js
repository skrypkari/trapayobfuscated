'use strict';const a70_0x42e14d=a70_0x1df7;(function(_0x1b7a43,_0x4aef3f){const _0x4f29b5=a70_0x1df7,_0x2c9208=_0x1b7a43();while(!![]){try{const _0x3085c4=-parseInt(_0x4f29b5(0x1e7))/0x1*(parseInt(_0x4f29b5(0x1db))/0x2)+-parseInt(_0x4f29b5(0x1dd))/0x3+-parseInt(_0x4f29b5(0x1e6))/0x4*(parseInt(_0x4f29b5(0x1e0))/0x5)+parseInt(_0x4f29b5(0x1da))/0x6+-parseInt(_0x4f29b5(0x1d3))/0x7*(-parseInt(_0x4f29b5(0x1e9))/0x8)+-parseInt(_0x4f29b5(0x1d8))/0x9+parseInt(_0x4f29b5(0x1ec))/0xa;if(_0x3085c4===_0x4aef3f)break;else _0x2c9208['push'](_0x2c9208['shift']());}catch(_0x5a5c74){_0x2c9208['push'](_0x2c9208['shift']());}}}(a70_0x453c,0x22773));var __importDefault=this&&this[a70_0x42e14d(0x1d4)]||function(_0x10830f){const _0x378fe5=a70_0x42e14d;return _0x10830f&&_0x10830f[_0x378fe5(0x1d5)]?_0x10830f:{'default':_0x10830f};};Object[a70_0x42e14d(0x1e4)](exports,a70_0x42e14d(0x1d5),{'value':!![]}),exports[a70_0x42e14d(0x1dc)]=void 0x0;function a70_0x453c(){const _0xe8a0f=['update','create','5SclQMh','findUnique','ensureSettingsExist','Shop\x20settings\x20not\x20found','defineProperty','updateWebhookSettings','1039584UhXwhO','9IxVCKM','webhookEvents','8AAvWtA','string','../config/database','4448950oTUrZd','isArray','default','getIntegrations','parseWebhookEvents','1210006igZNVU','__importDefault','__esModule','parse','webhookUrl','1485189cLVcvY','shopSettings','1590858TKVqpP','11434VaVLYX','IntegrationsService','796065OoxyIx'];a70_0x453c=function(){return _0xe8a0f;};return a70_0x453c();}function a70_0x1df7(_0x449281,_0x4360f8){_0x449281=_0x449281-0x1d2;const _0x453ce1=a70_0x453c();let _0x1df7a4=_0x453ce1[_0x449281];return _0x1df7a4;}const database_1=__importDefault(require(a70_0x42e14d(0x1eb)));class IntegrationsService{[a70_0x42e14d(0x1d2)](_0x12f52b){const _0x187cf9=a70_0x42e14d;if(!_0x12f52b)return[];if(Array[_0x187cf9(0x1ed)](_0x12f52b))return _0x12f52b;if(typeof _0x12f52b===_0x187cf9(0x1ea))try{const _0x400552=JSON[_0x187cf9(0x1d6)](_0x12f52b);return Array[_0x187cf9(0x1ed)](_0x400552)?_0x400552:[];}catch{return[];}return[];}async[a70_0x42e14d(0x1ef)](_0x5d569d){const _0xefb50=a70_0x42e14d;await this[_0xefb50(0x1e2)](_0x5d569d);const _0x586bb3=await database_1[_0xefb50(0x1ee)][_0xefb50(0x1d9)][_0xefb50(0x1e1)]({'where':{'shopId':_0x5d569d},'select':{'webhookUrl':!![],'webhookEvents':!![]}});if(!_0x586bb3)throw new Error(_0xefb50(0x1e3));return{'webhook':{'url':_0x586bb3[_0xefb50(0x1d7)],'events':this[_0xefb50(0x1d2)](_0x586bb3[_0xefb50(0x1e8)])}};}async[a70_0x42e14d(0x1e5)](_0x43be30,_0x34b4c1){const _0xd8e1c8=a70_0x42e14d;await this['ensureSettingsExist'](_0x43be30);const _0x122cea={};_0x34b4c1[_0xd8e1c8(0x1d7)]!==undefined&&(_0x122cea[_0xd8e1c8(0x1d7)]=_0x34b4c1[_0xd8e1c8(0x1d7)]||null),_0x34b4c1['webhookEvents']!==undefined&&(_0x122cea[_0xd8e1c8(0x1e8)]=_0x34b4c1[_0xd8e1c8(0x1e8)]||[]),await database_1[_0xd8e1c8(0x1ee)][_0xd8e1c8(0x1d9)][_0xd8e1c8(0x1de)]({'where':{'shopId':_0x43be30},'data':_0x122cea});}async[a70_0x42e14d(0x1e2)](_0x4fcf46){const _0x3e599b=a70_0x42e14d,_0x1981e1=await database_1[_0x3e599b(0x1ee)][_0x3e599b(0x1d9)][_0x3e599b(0x1e1)]({'where':{'shopId':_0x4fcf46}});!_0x1981e1&&await database_1[_0x3e599b(0x1ee)][_0x3e599b(0x1d9)][_0x3e599b(0x1df)]({'data':{'shopId':_0x4fcf46}});}}exports[a70_0x42e14d(0x1dc)]=IntegrationsService;