'use strict';const a51_0x45f433=a51_0x3d20;(function(_0x463320,_0x1cf4f0){const _0x3b8624=a51_0x3d20,_0xa407bc=_0x463320();while(!![]){try{const _0xafc63d=-parseInt(_0x3b8624(0x80))/0x1*(parseInt(_0x3b8624(0x87))/0x2)+-parseInt(_0x3b8624(0x7a))/0x3*(parseInt(_0x3b8624(0x95))/0x4)+-parseInt(_0x3b8624(0x8d))/0x5*(-parseInt(_0x3b8624(0x7c))/0x6)+parseInt(_0x3b8624(0x86))/0x7+-parseInt(_0x3b8624(0x8b))/0x8*(parseInt(_0x3b8624(0x94))/0x9)+parseInt(_0x3b8624(0x82))/0xa+parseInt(_0x3b8624(0x91))/0xb*(parseInt(_0x3b8624(0x83))/0xc);if(_0xafc63d===_0x1cf4f0)break;else _0xa407bc['push'](_0xa407bc['shift']());}catch(_0x4329fc){_0xa407bc['push'](_0xa407bc['shift']());}}}(a51_0x2f85,0xbc26d));function a51_0x3d20(_0x3364dd,_0x4ad672){const _0x2f855d=a51_0x2f85();return a51_0x3d20=function(_0x3d20f3,_0x2fabdb){_0x3d20f3=_0x3d20f3-0x7a;let _0x36ba0d=_0x2f855d[_0x3d20f3];return _0x36ba0d;},a51_0x3d20(_0x3364dd,_0x4ad672);}function a51_0x2f85(){const _0x32e144=['../config/database','400025hUOtSe','isArray','IntegrationsService','webhookEvents','33TvclVq','shopSettings','create','90sTWlPp','6124472YvMNbc','parse','3poOVAH','string','66ZodBnf','__esModule','webhookUrl','updateWebhookSettings','1gMCpMu','__importDefault','5590860FhXRXQ','1221084AAziJT','findUnique','ensureSettingsExist','8037036AgkdrJ','1176326zwaGKm','update','parseWebhookEvents','default','2088pRqvbe'];a51_0x2f85=function(){return _0x32e144;};return a51_0x2f85();}var __importDefault=this&&this[a51_0x45f433(0x81)]||function(_0x150935){const _0x1cb24d=a51_0x45f433;return _0x150935&&_0x150935[_0x1cb24d(0x7d)]?_0x150935:{'default':_0x150935};};Object['defineProperty'](exports,a51_0x45f433(0x7d),{'value':!![]}),exports[a51_0x45f433(0x8f)]=void 0x0;const database_1=__importDefault(require(a51_0x45f433(0x8c)));class IntegrationsService{[a51_0x45f433(0x89)](_0x33c67f){const _0x2d0ef5=a51_0x45f433;if(!_0x33c67f)return[];if(Array[_0x2d0ef5(0x8e)](_0x33c67f))return _0x33c67f;if(typeof _0x33c67f===_0x2d0ef5(0x7b))try{const _0x1e0961=JSON[_0x2d0ef5(0x96)](_0x33c67f);return Array[_0x2d0ef5(0x8e)](_0x1e0961)?_0x1e0961:[];}catch{return[];}return[];}async['getIntegrations'](_0x513a7a){const _0x5b1776=a51_0x45f433;await this[_0x5b1776(0x85)](_0x513a7a);const _0x4e84f9=await database_1[_0x5b1776(0x8a)][_0x5b1776(0x92)][_0x5b1776(0x84)]({'where':{'shopId':_0x513a7a},'select':{'webhookUrl':!![],'webhookEvents':!![]}});if(!_0x4e84f9)throw new Error('Shop\x20settings\x20not\x20found');return{'webhook':{'url':_0x4e84f9[_0x5b1776(0x7e)],'events':this[_0x5b1776(0x89)](_0x4e84f9[_0x5b1776(0x90)])}};}async[a51_0x45f433(0x7f)](_0x1ca3f5,_0x38046c){const _0x3576d3=a51_0x45f433;await this['ensureSettingsExist'](_0x1ca3f5);const _0x157536={};_0x38046c[_0x3576d3(0x7e)]!==undefined&&(_0x157536[_0x3576d3(0x7e)]=_0x38046c[_0x3576d3(0x7e)]||null),_0x38046c['webhookEvents']!==undefined&&(_0x157536[_0x3576d3(0x90)]=_0x38046c[_0x3576d3(0x90)]||[]),await database_1['default'][_0x3576d3(0x92)][_0x3576d3(0x88)]({'where':{'shopId':_0x1ca3f5},'data':_0x157536});}async[a51_0x45f433(0x85)](_0x1a28da){const _0x2d0fe6=a51_0x45f433,_0x26f9bf=await database_1[_0x2d0fe6(0x8a)][_0x2d0fe6(0x92)][_0x2d0fe6(0x84)]({'where':{'shopId':_0x1a28da}});!_0x26f9bf&&await database_1[_0x2d0fe6(0x8a)]['shopSettings'][_0x2d0fe6(0x93)]({'data':{'shopId':_0x1a28da}});}}exports[a51_0x45f433(0x8f)]=IntegrationsService;