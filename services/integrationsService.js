'use strict';const a52_0x1b79f4=a52_0x4e6d;function a52_0x4e6d(_0x4df68c,_0x5cbecf){const _0x75581=a52_0x7558();return a52_0x4e6d=function(_0x4e6df8,_0x52556a){_0x4e6df8=_0x4e6df8-0x71;let _0x5a91ff=_0x75581[_0x4e6df8];return _0x5a91ff;},a52_0x4e6d(_0x4df68c,_0x5cbecf);}(function(_0x1cafda,_0x18abd4){const _0x25ea30=a52_0x4e6d,_0x1e47db=_0x1cafda();while(!![]){try{const _0x6efb55=-parseInt(_0x25ea30(0x7c))/0x1*(-parseInt(_0x25ea30(0x7b))/0x2)+parseInt(_0x25ea30(0x74))/0x3*(parseInt(_0x25ea30(0x81))/0x4)+parseInt(_0x25ea30(0x8c))/0x5+-parseInt(_0x25ea30(0x7d))/0x6+parseInt(_0x25ea30(0x7f))/0x7*(-parseInt(_0x25ea30(0x71))/0x8)+-parseInt(_0x25ea30(0x7e))/0x9+parseInt(_0x25ea30(0x84))/0xa;if(_0x6efb55===_0x18abd4)break;else _0x1e47db['push'](_0x1e47db['shift']());}catch(_0x10eabd){_0x1e47db['push'](_0x1e47db['shift']());}}}(a52_0x7558,0x95cec));var __importDefault=this&&this[a52_0x1b79f4(0x86)]||function(_0x2999bb){const _0x2a4d61=a52_0x1b79f4;return _0x2999bb&&_0x2999bb[_0x2a4d61(0x83)]?_0x2999bb:{'default':_0x2999bb};};Object[a52_0x1b79f4(0x87)](exports,a52_0x1b79f4(0x83),{'value':!![]}),exports[a52_0x1b79f4(0x79)]=void 0x0;const database_1=__importDefault(require('../config/database'));class IntegrationsService{[a52_0x1b79f4(0x82)](_0x557d0c){const _0x3a6fe8=a52_0x1b79f4;if(!_0x557d0c)return[];if(Array['isArray'](_0x557d0c))return _0x557d0c;if(typeof _0x557d0c===_0x3a6fe8(0x8a))try{const _0x27dc1d=JSON[_0x3a6fe8(0x85)](_0x557d0c);return Array[_0x3a6fe8(0x77)](_0x27dc1d)?_0x27dc1d:[];}catch{return[];}return[];}async[a52_0x1b79f4(0x89)](_0x139982){const _0x3d1a21=a52_0x1b79f4;await this['ensureSettingsExist'](_0x139982);const _0x108819=await database_1['default'][_0x3d1a21(0x88)][_0x3d1a21(0x80)]({'where':{'shopId':_0x139982},'select':{'webhookUrl':!![],'webhookEvents':!![]}});if(!_0x108819)throw new Error(_0x3d1a21(0x8b));return{'webhook':{'url':_0x108819[_0x3d1a21(0x76)],'events':this[_0x3d1a21(0x82)](_0x108819[_0x3d1a21(0x72)])}};}async['updateWebhookSettings'](_0x51fcf6,_0x364117){const _0x37dbbf=a52_0x1b79f4;await this[_0x37dbbf(0x75)](_0x51fcf6);const _0x3fb301={};_0x364117[_0x37dbbf(0x76)]!==undefined&&(_0x3fb301[_0x37dbbf(0x76)]=_0x364117['webhookUrl']||null),_0x364117['webhookEvents']!==undefined&&(_0x3fb301[_0x37dbbf(0x72)]=_0x364117[_0x37dbbf(0x72)]||[]),await database_1[_0x37dbbf(0x78)][_0x37dbbf(0x88)][_0x37dbbf(0x73)]({'where':{'shopId':_0x51fcf6},'data':_0x3fb301});}async['ensureSettingsExist'](_0x1b7cc4){const _0x7ea768=a52_0x1b79f4,_0x526ea5=await database_1[_0x7ea768(0x78)]['shopSettings']['findUnique']({'where':{'shopId':_0x1b7cc4}});!_0x526ea5&&await database_1['default'][_0x7ea768(0x88)][_0x7ea768(0x7a)]({'data':{'shopId':_0x1b7cc4}});}}exports[a52_0x1b79f4(0x79)]=IntegrationsService;function a52_0x7558(){const _0x101bcc=['isArray','default','IntegrationsService','create','636470NeMNad','2DGuWjf','2048898wXqNnJ','1181556qPSUbH','4361xZviTX','findUnique','92044sMGwAs','parseWebhookEvents','__esModule','1044850MkGVZf','parse','__importDefault','defineProperty','shopSettings','getIntegrations','string','Shop\x20settings\x20not\x20found','2795850RIFKeE','7768nuZGas','webhookEvents','update','51GaExTk','ensureSettingsExist','webhookUrl'];a52_0x7558=function(){return _0x101bcc;};return a52_0x7558();}