'use strict';const a43_0xbf319=a43_0x18df;(function(_0x1e35e3,_0x41dadb){const _0x22f5ee=a43_0x18df,_0x2bd3ba=_0x1e35e3();while(!![]){try{const _0x55abea=-parseInt(_0x22f5ee(0x157))/0x1+parseInt(_0x22f5ee(0x151))/0x2+parseInt(_0x22f5ee(0x14f))/0x3+-parseInt(_0x22f5ee(0x15a))/0x4*(parseInt(_0x22f5ee(0x163))/0x5)+-parseInt(_0x22f5ee(0x15b))/0x6+parseInt(_0x22f5ee(0x152))/0x7*(-parseInt(_0x22f5ee(0x165))/0x8)+-parseInt(_0x22f5ee(0x160))/0x9*(-parseInt(_0x22f5ee(0x14b))/0xa);if(_0x55abea===_0x41dadb)break;else _0x2bd3ba['push'](_0x2bd3ba['shift']());}catch(_0x59590c){_0x2bd3ba['push'](_0x2bd3ba['shift']());}}}(a43_0x4699,0x6787f));function a43_0x18df(_0x4f79dd,_0x38bcc8){const _0x469971=a43_0x4699();return a43_0x18df=function(_0x18df52,_0x56b751){_0x18df52=_0x18df52-0x14b;let _0x3afbfa=_0x469971[_0x18df52];return _0x3afbfa;},a43_0x18df(_0x4f79dd,_0x38bcc8);}function a43_0x4699(){const _0x4073ac=['updateWebhookSettings','3592nhRLJu','780oUKjVx','webhookUrl','getIntegrations','__importDefault','234267WIhORo','defineProperty','1248730EwpERR','1211qfrKEd','IntegrationsService','string','findUnique','webhookEvents','645832saSyGV','ensureSettingsExist','../config/database','494836gwAfjt','2690694Lwocsg','Shop\x20settings\x20not\x20found','default','shopSettings','create','117378qZHLSD','parseWebhookEvents','isArray','5NsMFtq'];a43_0x4699=function(){return _0x4073ac;};return a43_0x4699();}var __importDefault=this&&this[a43_0xbf319(0x14e)]||function(_0x1f7039){return _0x1f7039&&_0x1f7039['__esModule']?_0x1f7039:{'default':_0x1f7039};};Object[a43_0xbf319(0x150)](exports,'__esModule',{'value':!![]}),exports['IntegrationsService']=void 0x0;const database_1=__importDefault(require(a43_0xbf319(0x159)));class IntegrationsService{[a43_0xbf319(0x161)](_0x501a88){const _0x6435da=a43_0xbf319;if(!_0x501a88)return[];if(Array['isArray'](_0x501a88))return _0x501a88;if(typeof _0x501a88===_0x6435da(0x154))try{const _0x376f19=JSON['parse'](_0x501a88);return Array[_0x6435da(0x162)](_0x376f19)?_0x376f19:[];}catch{return[];}return[];}async[a43_0xbf319(0x14d)](_0x35e51c){const _0x410cd6=a43_0xbf319;await this[_0x410cd6(0x158)](_0x35e51c);const _0x5628ac=await database_1[_0x410cd6(0x15d)][_0x410cd6(0x15e)][_0x410cd6(0x155)]({'where':{'shopId':_0x35e51c},'select':{'webhookUrl':!![],'webhookEvents':!![]}});if(!_0x5628ac)throw new Error(_0x410cd6(0x15c));return{'webhook':{'url':_0x5628ac[_0x410cd6(0x14c)],'events':this[_0x410cd6(0x161)](_0x5628ac[_0x410cd6(0x156)])}};}async[a43_0xbf319(0x164)](_0x1410c9,_0x4f32aa){const _0x5a0451=a43_0xbf319;await this[_0x5a0451(0x158)](_0x1410c9);const _0x13bf18={};_0x4f32aa['webhookUrl']!==undefined&&(_0x13bf18[_0x5a0451(0x14c)]=_0x4f32aa['webhookUrl']||null),_0x4f32aa[_0x5a0451(0x156)]!==undefined&&(_0x13bf18[_0x5a0451(0x156)]=_0x4f32aa[_0x5a0451(0x156)]||[]),await database_1[_0x5a0451(0x15d)][_0x5a0451(0x15e)]['update']({'where':{'shopId':_0x1410c9},'data':_0x13bf18});}async[a43_0xbf319(0x158)](_0x558067){const _0x1e3192=a43_0xbf319,_0x1382c4=await database_1['default']['shopSettings'][_0x1e3192(0x155)]({'where':{'shopId':_0x558067}});!_0x1382c4&&await database_1[_0x1e3192(0x15d)]['shopSettings'][_0x1e3192(0x15f)]({'data':{'shopId':_0x558067}});}}exports[a43_0xbf319(0x153)]=IntegrationsService;