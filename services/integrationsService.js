'use strict';function a47_0x1723(_0x2d0289,_0x3fa95a){const _0x3a48b3=a47_0x3a48();return a47_0x1723=function(_0x172319,_0x2f8a02){_0x172319=_0x172319-0xd5;let _0xbe1006=_0x3a48b3[_0x172319];return _0xbe1006;},a47_0x1723(_0x2d0289,_0x3fa95a);}const a47_0x15977e=a47_0x1723;(function(_0x175f21,_0x25307d){const _0x3fadc2=a47_0x1723,_0x3cc9c5=_0x175f21();while(!![]){try{const _0x298d80=-parseInt(_0x3fadc2(0xe1))/0x1+parseInt(_0x3fadc2(0xd7))/0x2*(parseInt(_0x3fadc2(0xde))/0x3)+-parseInt(_0x3fadc2(0xe2))/0x4+parseInt(_0x3fadc2(0xe6))/0x5*(parseInt(_0x3fadc2(0xdd))/0x6)+-parseInt(_0x3fadc2(0xeb))/0x7+-parseInt(_0x3fadc2(0xe4))/0x8+-parseInt(_0x3fadc2(0xec))/0x9*(-parseInt(_0x3fadc2(0xdc))/0xa);if(_0x298d80===_0x25307d)break;else _0x3cc9c5['push'](_0x3cc9c5['shift']());}catch(_0x2705e5){_0x3cc9c5['push'](_0x3cc9c5['shift']());}}}(a47_0x3a48,0x81ec8));var __importDefault=this&&this[a47_0x15977e(0xdb)]||function(_0x45f4e4){const _0x51853e=a47_0x15977e;return _0x45f4e4&&_0x45f4e4[_0x51853e(0xdf)]?_0x45f4e4:{'default':_0x45f4e4};};Object[a47_0x15977e(0xe9)](exports,a47_0x15977e(0xdf),{'value':!![]}),exports[a47_0x15977e(0xf1)]=void 0x0;function a47_0x3a48(){const _0x1ef265=['5927362XHPiwm','2369313JedGYK','findUnique','updateWebhookSettings','isArray','webhookUrl','IntegrationsService','default','parse','14TrWmDD','ensureSettingsExist','getIntegrations','parseWebhookEvents','__importDefault','70zxyLaM','12awHzBa','330519jAYmny','__esModule','Shop\x20settings\x20not\x20found','880906eWsJxk','1526512oZPkML','shopSettings','8117440qvzUyQ','update','2605345pMTWEQ','create','webhookEvents','defineProperty','string'];a47_0x3a48=function(){return _0x1ef265;};return a47_0x3a48();}const database_1=__importDefault(require('../config/database'));class IntegrationsService{['parseWebhookEvents'](_0x37a76c){const _0x16db2f=a47_0x15977e;if(!_0x37a76c)return[];if(Array[_0x16db2f(0xef)](_0x37a76c))return _0x37a76c;if(typeof _0x37a76c===_0x16db2f(0xea))try{const _0x28f5e9=JSON[_0x16db2f(0xd6)](_0x37a76c);return Array[_0x16db2f(0xef)](_0x28f5e9)?_0x28f5e9:[];}catch{return[];}return[];}async[a47_0x15977e(0xd9)](_0x4b1128){const _0x5025e3=a47_0x15977e;await this[_0x5025e3(0xd8)](_0x4b1128);const _0x1a5edb=await database_1[_0x5025e3(0xd5)][_0x5025e3(0xe3)][_0x5025e3(0xed)]({'where':{'shopId':_0x4b1128},'select':{'webhookUrl':!![],'webhookEvents':!![]}});if(!_0x1a5edb)throw new Error(_0x5025e3(0xe0));return{'webhook':{'url':_0x1a5edb['webhookUrl'],'events':this[_0x5025e3(0xda)](_0x1a5edb[_0x5025e3(0xe8)])}};}async[a47_0x15977e(0xee)](_0x40ee04,_0x561155){const _0x5806da=a47_0x15977e;await this[_0x5806da(0xd8)](_0x40ee04);const _0x471ac9={};_0x561155['webhookUrl']!==undefined&&(_0x471ac9[_0x5806da(0xf0)]=_0x561155[_0x5806da(0xf0)]||null),_0x561155[_0x5806da(0xe8)]!==undefined&&(_0x471ac9[_0x5806da(0xe8)]=_0x561155['webhookEvents']||[]),await database_1[_0x5806da(0xd5)]['shopSettings'][_0x5806da(0xe5)]({'where':{'shopId':_0x40ee04},'data':_0x471ac9});}async[a47_0x15977e(0xd8)](_0xabbcf5){const _0x334ed7=a47_0x15977e,_0x1b8d06=await database_1[_0x334ed7(0xd5)][_0x334ed7(0xe3)]['findUnique']({'where':{'shopId':_0xabbcf5}});!_0x1b8d06&&await database_1[_0x334ed7(0xd5)][_0x334ed7(0xe3)][_0x334ed7(0xe7)]({'data':{'shopId':_0xabbcf5}});}}exports[a47_0x15977e(0xf1)]=IntegrationsService;