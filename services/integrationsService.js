'use strict';function a50_0x3864(_0x1ea98e,_0x263889){const _0x557146=a50_0x5571();return a50_0x3864=function(_0x386458,_0x22df11){_0x386458=_0x386458-0x7d;let _0x5139a9=_0x557146[_0x386458];return _0x5139a9;},a50_0x3864(_0x1ea98e,_0x263889);}const a50_0x38da6d=a50_0x3864;(function(_0x20de4e,_0x572cd7){const _0x4ef17b=a50_0x3864,_0x26328c=_0x20de4e();while(!![]){try{const _0x587730=-parseInt(_0x4ef17b(0x8e))/0x1+-parseInt(_0x4ef17b(0x8d))/0x2*(parseInt(_0x4ef17b(0x97))/0x3)+-parseInt(_0x4ef17b(0x82))/0x4+parseInt(_0x4ef17b(0x83))/0x5*(parseInt(_0x4ef17b(0x8c))/0x6)+-parseInt(_0x4ef17b(0x93))/0x7+parseInt(_0x4ef17b(0x8f))/0x8*(-parseInt(_0x4ef17b(0x85))/0x9)+parseInt(_0x4ef17b(0x7e))/0xa*(parseInt(_0x4ef17b(0x87))/0xb);if(_0x587730===_0x572cd7)break;else _0x26328c['push'](_0x26328c['shift']());}catch(_0x289d12){_0x26328c['push'](_0x26328c['shift']());}}}(a50_0x5571,0x3ff2b));var __importDefault=this&&this[a50_0x38da6d(0x86)]||function(_0x22c31a){const _0x2918b2=a50_0x38da6d;return _0x22c31a&&_0x22c31a[_0x2918b2(0x8b)]?_0x22c31a:{'default':_0x22c31a};};Object[a50_0x38da6d(0x7d)](exports,a50_0x38da6d(0x8b),{'value':!![]}),exports[a50_0x38da6d(0x91)]=void 0x0;const database_1=__importDefault(require('../config/database'));function a50_0x5571(){const _0x2e1d43=['5htMjFH','ensureSettingsExist','27qWzGqD','__importDefault','2782285sPxVdy','parseWebhookEvents','default','shopSettings','__esModule','62034bWBWAE','17826vQAidw','20080oFrwdC','954184FLxxBm','getIntegrations','IntegrationsService','webhookEvents','630805LtMPYl','string','parse','update','87aJfTYA','findUnique','defineProperty','40qWEnxu','create','webhookUrl','isArray','134628wIWMNX'];a50_0x5571=function(){return _0x2e1d43;};return a50_0x5571();}class IntegrationsService{[a50_0x38da6d(0x88)](_0x3adfe3){const _0x1d643b=a50_0x38da6d;if(!_0x3adfe3)return[];if(Array[_0x1d643b(0x81)](_0x3adfe3))return _0x3adfe3;if(typeof _0x3adfe3===_0x1d643b(0x94))try{const _0x5de5b3=JSON[_0x1d643b(0x95)](_0x3adfe3);return Array[_0x1d643b(0x81)](_0x5de5b3)?_0x5de5b3:[];}catch{return[];}return[];}async[a50_0x38da6d(0x90)](_0x399805){const _0xaa705b=a50_0x38da6d;await this[_0xaa705b(0x84)](_0x399805);const _0x294d33=await database_1['default']['shopSettings'][_0xaa705b(0x98)]({'where':{'shopId':_0x399805},'select':{'webhookUrl':!![],'webhookEvents':!![]}});if(!_0x294d33)throw new Error('Shop\x20settings\x20not\x20found');return{'webhook':{'url':_0x294d33[_0xaa705b(0x80)],'events':this[_0xaa705b(0x88)](_0x294d33['webhookEvents'])}};}async['updateWebhookSettings'](_0x3fbc1f,_0xa7b389){const _0x38867f=a50_0x38da6d;await this[_0x38867f(0x84)](_0x3fbc1f);const _0x2b9dd7={};_0xa7b389[_0x38867f(0x80)]!==undefined&&(_0x2b9dd7[_0x38867f(0x80)]=_0xa7b389['webhookUrl']||null),_0xa7b389[_0x38867f(0x92)]!==undefined&&(_0x2b9dd7['webhookEvents']=_0xa7b389['webhookEvents']||[]),await database_1[_0x38867f(0x89)]['shopSettings'][_0x38867f(0x96)]({'where':{'shopId':_0x3fbc1f},'data':_0x2b9dd7});}async['ensureSettingsExist'](_0x499883){const _0x15c005=a50_0x38da6d,_0x5b0c7d=await database_1[_0x15c005(0x89)]['shopSettings'][_0x15c005(0x98)]({'where':{'shopId':_0x499883}});!_0x5b0c7d&&await database_1[_0x15c005(0x89)][_0x15c005(0x8a)][_0x15c005(0x7f)]({'data':{'shopId':_0x499883}});}}exports[a50_0x38da6d(0x91)]=IntegrationsService;