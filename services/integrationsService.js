'use strict';function a66_0x5dbc(){const _0x32fbf5=['2351853rxIOsu','webhookEvents','isArray','5927552kbKtum','__esModule','parseWebhookEvents','2VNfPaX','1672422APjbAM','create','Shop\x20settings\x20not\x20found','IntegrationsService','string','ensureSettingsExist','webhookUrl','5775abRDkR','3564126OVzztj','default','19290wshuEu','shopSettings','update','__importDefault','findUnique','932LjToIw','updateWebhookSettings','115962juRkVc'];a66_0x5dbc=function(){return _0x32fbf5;};return a66_0x5dbc();}const a66_0x11222c=a66_0x31fd;(function(_0x533e45,_0x50016d){const _0x27ab24=a66_0x31fd,_0x100a57=_0x533e45();while(!![]){try{const _0x20b03c=parseInt(_0x27ab24(0x9d))/0x1+parseInt(_0x27ab24(0x8b))/0x2*(-parseInt(_0x27ab24(0x8c))/0x3)+-parseInt(_0x27ab24(0x9b))/0x4*(-parseInt(_0x27ab24(0x93))/0x5)+-parseInt(_0x27ab24(0x96))/0x6+parseInt(_0x27ab24(0x9e))/0x7+parseInt(_0x27ab24(0x88))/0x8+-parseInt(_0x27ab24(0x94))/0x9;if(_0x20b03c===_0x50016d)break;else _0x100a57['push'](_0x100a57['shift']());}catch(_0x249afa){_0x100a57['push'](_0x100a57['shift']());}}}(a66_0x5dbc,0x7b5d1));var __importDefault=this&&this[a66_0x11222c(0x99)]||function(_0x180927){const _0x23bb35=a66_0x11222c;return _0x180927&&_0x180927[_0x23bb35(0x89)]?_0x180927:{'default':_0x180927};};Object['defineProperty'](exports,a66_0x11222c(0x89),{'value':!![]}),exports[a66_0x11222c(0x8f)]=void 0x0;const database_1=__importDefault(require('../config/database'));class IntegrationsService{[a66_0x11222c(0x8a)](_0x58f5c6){const _0x2c4e9b=a66_0x11222c;if(!_0x58f5c6)return[];if(Array[_0x2c4e9b(0x87)](_0x58f5c6))return _0x58f5c6;if(typeof _0x58f5c6===_0x2c4e9b(0x90))try{const _0x56c105=JSON['parse'](_0x58f5c6);return Array[_0x2c4e9b(0x87)](_0x56c105)?_0x56c105:[];}catch{return[];}return[];}async['getIntegrations'](_0x7f027a){const _0x7128da=a66_0x11222c;await this[_0x7128da(0x91)](_0x7f027a);const _0x1cc4e5=await database_1[_0x7128da(0x95)][_0x7128da(0x97)]['findUnique']({'where':{'shopId':_0x7f027a},'select':{'webhookUrl':!![],'webhookEvents':!![]}});if(!_0x1cc4e5)throw new Error(_0x7128da(0x8e));return{'webhook':{'url':_0x1cc4e5[_0x7128da(0x92)],'events':this['parseWebhookEvents'](_0x1cc4e5[_0x7128da(0x86)])}};}async[a66_0x11222c(0x9c)](_0x34d4fd,_0x55d7c2){const _0x53dc16=a66_0x11222c;await this[_0x53dc16(0x91)](_0x34d4fd);const _0x258694={};_0x55d7c2[_0x53dc16(0x92)]!==undefined&&(_0x258694[_0x53dc16(0x92)]=_0x55d7c2[_0x53dc16(0x92)]||null),_0x55d7c2['webhookEvents']!==undefined&&(_0x258694[_0x53dc16(0x86)]=_0x55d7c2['webhookEvents']||[]),await database_1[_0x53dc16(0x95)]['shopSettings'][_0x53dc16(0x98)]({'where':{'shopId':_0x34d4fd},'data':_0x258694});}async[a66_0x11222c(0x91)](_0x514457){const _0x334c21=a66_0x11222c,_0x30d18e=await database_1['default'][_0x334c21(0x97)][_0x334c21(0x9a)]({'where':{'shopId':_0x514457}});!_0x30d18e&&await database_1['default'][_0x334c21(0x97)][_0x334c21(0x8d)]({'data':{'shopId':_0x514457}});}}function a66_0x31fd(_0x14716e,_0x52b406){_0x14716e=_0x14716e-0x86;const _0x5dbc6d=a66_0x5dbc();let _0x31fdc8=_0x5dbc6d[_0x14716e];return _0x31fdc8;}exports[a66_0x11222c(0x8f)]=IntegrationsService;