'use strict';const a50_0x506097=a50_0x5d22;(function(_0x2b3eae,_0xa261f){const _0x5159f4=a50_0x5d22,_0x479ed3=_0x2b3eae();while(!![]){try{const _0x96e9fa=-parseInt(_0x5159f4(0xb2))/0x1*(parseInt(_0x5159f4(0xac))/0x2)+parseInt(_0x5159f4(0xa4))/0x3+parseInt(_0x5159f4(0xa1))/0x4+parseInt(_0x5159f4(0xa5))/0x5*(-parseInt(_0x5159f4(0x9d))/0x6)+-parseInt(_0x5159f4(0xa2))/0x7+-parseInt(_0x5159f4(0xa7))/0x8+parseInt(_0x5159f4(0x9f))/0x9;if(_0x96e9fa===_0xa261f)break;else _0x479ed3['push'](_0x479ed3['shift']());}catch(_0x4985c4){_0x479ed3['push'](_0x479ed3['shift']());}}}(a50_0x9d0b,0x2e75e));function a50_0x9d0b(){const _0x5b7d3b=['findUnique','webhookEvents','shopSettings','120826BUiVGy','string','parseWebhookEvents','Shop\x20settings\x20not\x20found','IntegrationsService','345516bbrOPl','getIntegrations','6111261JuUNcE','ensureSettingsExist','1091116QULBHV','541464ajcgyj','update','616398QAaRYE','25mGmvlF','default','2880304TkZTFX','webhookUrl','isArray','__esModule','../config/database','4MpveTw','parse','defineProperty'];a50_0x9d0b=function(){return _0x5b7d3b;};return a50_0x9d0b();}function a50_0x5d22(_0x5412dd,_0x300213){const _0x9d0b68=a50_0x9d0b();return a50_0x5d22=function(_0x5d22cd,_0x1cc8a0){_0x5d22cd=_0x5d22cd-0x99;let _0x69d8f4=_0x9d0b68[_0x5d22cd];return _0x69d8f4;},a50_0x5d22(_0x5412dd,_0x300213);}var __importDefault=this&&this['__importDefault']||function(_0x1ddca1){const _0x180e17=a50_0x5d22;return _0x1ddca1&&_0x1ddca1[_0x180e17(0xaa)]?_0x1ddca1:{'default':_0x1ddca1};};Object[a50_0x506097(0xae)](exports,a50_0x506097(0xaa),{'value':!![]}),exports[a50_0x506097(0x9c)]=void 0x0;const database_1=__importDefault(require(a50_0x506097(0xab)));class IntegrationsService{['parseWebhookEvents'](_0x38188c){const _0x263490=a50_0x506097;if(!_0x38188c)return[];if(Array[_0x263490(0xa9)](_0x38188c))return _0x38188c;if(typeof _0x38188c===_0x263490(0x99))try{const _0x1db80a=JSON[_0x263490(0xad)](_0x38188c);return Array[_0x263490(0xa9)](_0x1db80a)?_0x1db80a:[];}catch{return[];}return[];}async[a50_0x506097(0x9e)](_0x4ac42a){const _0x303015=a50_0x506097;await this[_0x303015(0xa0)](_0x4ac42a);const _0x2d6e75=await database_1[_0x303015(0xa6)][_0x303015(0xb1)]['findUnique']({'where':{'shopId':_0x4ac42a},'select':{'webhookUrl':!![],'webhookEvents':!![]}});if(!_0x2d6e75)throw new Error(_0x303015(0x9b));return{'webhook':{'url':_0x2d6e75[_0x303015(0xa8)],'events':this[_0x303015(0x9a)](_0x2d6e75[_0x303015(0xb0)])}};}async['updateWebhookSettings'](_0xedc6b1,_0x37c60f){const _0x27681d=a50_0x506097;await this[_0x27681d(0xa0)](_0xedc6b1);const _0x31b2b2={};_0x37c60f['webhookUrl']!==undefined&&(_0x31b2b2[_0x27681d(0xa8)]=_0x37c60f[_0x27681d(0xa8)]||null),_0x37c60f[_0x27681d(0xb0)]!==undefined&&(_0x31b2b2[_0x27681d(0xb0)]=_0x37c60f['webhookEvents']||[]),await database_1[_0x27681d(0xa6)]['shopSettings'][_0x27681d(0xa3)]({'where':{'shopId':_0xedc6b1},'data':_0x31b2b2});}async[a50_0x506097(0xa0)](_0x27b0e7){const _0x45578f=a50_0x506097,_0x5a37dd=await database_1[_0x45578f(0xa6)]['shopSettings'][_0x45578f(0xaf)]({'where':{'shopId':_0x27b0e7}});!_0x5a37dd&&await database_1[_0x45578f(0xa6)][_0x45578f(0xb1)]['create']({'data':{'shopId':_0x27b0e7}});}}exports[a50_0x506097(0x9c)]=IntegrationsService;