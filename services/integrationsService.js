'use strict';const a43_0x39f95d=a43_0x2d78;(function(_0x3c8a78,_0x4b5942){const _0x231998=a43_0x2d78,_0x50fe39=_0x3c8a78();while(!![]){try{const _0x25c132=-parseInt(_0x231998(0xb5))/0x1*(parseInt(_0x231998(0xba))/0x2)+-parseInt(_0x231998(0xc1))/0x3+-parseInt(_0x231998(0xb2))/0x4*(-parseInt(_0x231998(0xbe))/0x5)+-parseInt(_0x231998(0xc3))/0x6*(parseInt(_0x231998(0xc0))/0x7)+-parseInt(_0x231998(0xb9))/0x8+parseInt(_0x231998(0xb6))/0x9*(-parseInt(_0x231998(0xbb))/0xa)+-parseInt(_0x231998(0xae))/0xb*(-parseInt(_0x231998(0xaa))/0xc);if(_0x25c132===_0x4b5942)break;else _0x50fe39['push'](_0x50fe39['shift']());}catch(_0x597798){_0x50fe39['push'](_0x50fe39['shift']());}}}(a43_0x38a6,0xe8eae));function a43_0x2d78(_0xcf0d73,_0x7044f8){const _0x38a63e=a43_0x38a6();return a43_0x2d78=function(_0x2d78a9,_0x469bb8){_0x2d78a9=_0x2d78a9-0xa8;let _0x149c9e=_0x38a63e[_0x2d78a9];return _0x149c9e;},a43_0x2d78(_0xcf0d73,_0x7044f8);}var __importDefault=this&&this[a43_0x39f95d(0xab)]||function(_0x121f67){const _0x381e3d=a43_0x39f95d;return _0x121f67&&_0x121f67[_0x381e3d(0xa8)]?_0x121f67:{'default':_0x121f67};};Object[a43_0x39f95d(0xb0)](exports,a43_0x39f95d(0xa8),{'value':!![]}),exports[a43_0x39f95d(0xb8)]=void 0x0;function a43_0x38a6(){const _0x4505fe=['35rNvIPb','4390047ZaWFwc','string','1607532xZDklT','isArray','__esModule','updateWebhookSettings','36582984EpXZbt','__importDefault','ensureSettingsExist','default','22rzSKzW','webhookEvents','defineProperty','parseWebhookEvents','4552220IEYnhw','create','findUnique','185923NTPHTE','1293876OoHKyu','webhookUrl','IntegrationsService','8412232pyckcJ','6WiBuGR','130JkGqsX','parse','shopSettings','5hTCYvn','update'];a43_0x38a6=function(){return _0x4505fe;};return a43_0x38a6();}const database_1=__importDefault(require('../config/database'));class IntegrationsService{[a43_0x39f95d(0xb1)](_0x1d8884){const _0x5285cd=a43_0x39f95d;if(!_0x1d8884)return[];if(Array[_0x5285cd(0xc4)](_0x1d8884))return _0x1d8884;if(typeof _0x1d8884===_0x5285cd(0xc2))try{const _0x48a75d=JSON[_0x5285cd(0xbc)](_0x1d8884);return Array[_0x5285cd(0xc4)](_0x48a75d)?_0x48a75d:[];}catch{return[];}return[];}async['getIntegrations'](_0x1f028e){const _0x5a063d=a43_0x39f95d;await this['ensureSettingsExist'](_0x1f028e);const _0x257156=await database_1[_0x5a063d(0xad)][_0x5a063d(0xbd)][_0x5a063d(0xb4)]({'where':{'shopId':_0x1f028e},'select':{'webhookUrl':!![],'webhookEvents':!![]}});if(!_0x257156)throw new Error('Shop\x20settings\x20not\x20found');return{'webhook':{'url':_0x257156[_0x5a063d(0xb7)],'events':this[_0x5a063d(0xb1)](_0x257156[_0x5a063d(0xaf)])}};}async[a43_0x39f95d(0xa9)](_0x2ced7f,_0x7e0071){const _0x3f707f=a43_0x39f95d;await this[_0x3f707f(0xac)](_0x2ced7f);const _0x494675={};_0x7e0071[_0x3f707f(0xb7)]!==undefined&&(_0x494675[_0x3f707f(0xb7)]=_0x7e0071['webhookUrl']||null),_0x7e0071[_0x3f707f(0xaf)]!==undefined&&(_0x494675[_0x3f707f(0xaf)]=_0x7e0071[_0x3f707f(0xaf)]||[]),await database_1[_0x3f707f(0xad)][_0x3f707f(0xbd)][_0x3f707f(0xbf)]({'where':{'shopId':_0x2ced7f},'data':_0x494675});}async[a43_0x39f95d(0xac)](_0x320c8d){const _0x3c5d99=a43_0x39f95d,_0x5ad122=await database_1[_0x3c5d99(0xad)][_0x3c5d99(0xbd)][_0x3c5d99(0xb4)]({'where':{'shopId':_0x320c8d}});!_0x5ad122&&await database_1['default']['shopSettings'][_0x3c5d99(0xb3)]({'data':{'shopId':_0x320c8d}});}}exports[a43_0x39f95d(0xb8)]=IntegrationsService;