'use strict';const a47_0x230c59=a47_0x31fe;(function(_0x2a1d39,_0x3d9e75){const _0x549f65=a47_0x31fe,_0x1749e5=_0x2a1d39();while(!![]){try{const _0x3c15d7=parseInt(_0x549f65(0xe3))/0x1+-parseInt(_0x549f65(0xce))/0x2+parseInt(_0x549f65(0xd4))/0x3+parseInt(_0x549f65(0xdf))/0x4+-parseInt(_0x549f65(0xe6))/0x5+parseInt(_0x549f65(0xcf))/0x6*(-parseInt(_0x549f65(0xe1))/0x7)+-parseInt(_0x549f65(0xd9))/0x8*(-parseInt(_0x549f65(0xd7))/0x9);if(_0x3c15d7===_0x3d9e75)break;else _0x1749e5['push'](_0x1749e5['shift']());}catch(_0xa52be5){_0x1749e5['push'](_0x1749e5['shift']());}}}(a47_0x19d2,0x78373));var __importDefault=this&&this[a47_0x230c59(0xdc)]||function(_0x18fdb3){const _0x41453a=a47_0x230c59;return _0x18fdb3&&_0x18fdb3[_0x41453a(0xd2)]?_0x18fdb3:{'default':_0x18fdb3};};function a47_0x31fe(_0x529512,_0x206061){const _0x19d22b=a47_0x19d2();return a47_0x31fe=function(_0x31fe47,_0x4dfc82){_0x31fe47=_0x31fe47-0xce;let _0x483b64=_0x19d22b[_0x31fe47];return _0x483b64;},a47_0x31fe(_0x529512,_0x206061);}Object[a47_0x230c59(0xd3)](exports,a47_0x230c59(0xd2),{'value':!![]}),exports[a47_0x230c59(0xe2)]=void 0x0;function a47_0x19d2(){const _0x4e9641=['__esModule','defineProperty','152952UsUxOC','string','getIntegrations','1506906DjFrwC','findUnique','24KWCmwF','isArray','default','__importDefault','ensureSettingsExist','updateWebhookSettings','3191424xsupnu','webhookEvents','14zPbgJG','IntegrationsService','353770LJCIQv','create','parse','2117555PJEqpb','shopSettings','webhookUrl','190132WiPKOh','2081796qoSRHk','Shop\x20settings\x20not\x20found','parseWebhookEvents'];a47_0x19d2=function(){return _0x4e9641;};return a47_0x19d2();}const database_1=__importDefault(require('../config/database'));class IntegrationsService{[a47_0x230c59(0xd1)](_0x3679c9){const _0xfcaffe=a47_0x230c59;if(!_0x3679c9)return[];if(Array[_0xfcaffe(0xda)](_0x3679c9))return _0x3679c9;if(typeof _0x3679c9===_0xfcaffe(0xd5))try{const _0x38fde8=JSON[_0xfcaffe(0xe5)](_0x3679c9);return Array['isArray'](_0x38fde8)?_0x38fde8:[];}catch{return[];}return[];}async[a47_0x230c59(0xd6)](_0x30f0c5){const _0x26cd84=a47_0x230c59;await this[_0x26cd84(0xdd)](_0x30f0c5);const _0x2c1780=await database_1['default'][_0x26cd84(0xe7)][_0x26cd84(0xd8)]({'where':{'shopId':_0x30f0c5},'select':{'webhookUrl':!![],'webhookEvents':!![]}});if(!_0x2c1780)throw new Error(_0x26cd84(0xd0));return{'webhook':{'url':_0x2c1780[_0x26cd84(0xe8)],'events':this[_0x26cd84(0xd1)](_0x2c1780['webhookEvents'])}};}async[a47_0x230c59(0xde)](_0x19cdbd,_0x63601b){const _0x4d795c=a47_0x230c59;await this[_0x4d795c(0xdd)](_0x19cdbd);const _0x534d9a={};_0x63601b['webhookUrl']!==undefined&&(_0x534d9a[_0x4d795c(0xe8)]=_0x63601b[_0x4d795c(0xe8)]||null),_0x63601b[_0x4d795c(0xe0)]!==undefined&&(_0x534d9a['webhookEvents']=_0x63601b['webhookEvents']||[]),await database_1[_0x4d795c(0xdb)]['shopSettings']['update']({'where':{'shopId':_0x19cdbd},'data':_0x534d9a});}async[a47_0x230c59(0xdd)](_0x2dd80a){const _0x2214fe=a47_0x230c59,_0x15bd64=await database_1[_0x2214fe(0xdb)][_0x2214fe(0xe7)][_0x2214fe(0xd8)]({'where':{'shopId':_0x2dd80a}});!_0x15bd64&&await database_1['default'][_0x2214fe(0xe7)][_0x2214fe(0xe4)]({'data':{'shopId':_0x2dd80a}});}}exports[a47_0x230c59(0xe2)]=IntegrationsService;