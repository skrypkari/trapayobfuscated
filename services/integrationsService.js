'use strict';function a70_0xb3ce(_0x1d2210,_0xe44059){_0x1d2210=_0x1d2210-0x109;const _0x3b62fc=a70_0x3b62();let _0xb3ce40=_0x3b62fc[_0x1d2210];return _0xb3ce40;}const a70_0x4de93c=a70_0xb3ce;(function(_0x234875,_0x4ac21d){const _0x18d868=a70_0xb3ce,_0x5999bc=_0x234875();while(!![]){try{const _0x128cf3=-parseInt(_0x18d868(0x115))/0x1*(-parseInt(_0x18d868(0x118))/0x2)+-parseInt(_0x18d868(0x10b))/0x3+parseInt(_0x18d868(0x109))/0x4+-parseInt(_0x18d868(0x119))/0x5+parseInt(_0x18d868(0x121))/0x6+parseInt(_0x18d868(0x114))/0x7*(parseInt(_0x18d868(0x11d))/0x8)+-parseInt(_0x18d868(0x111))/0x9;if(_0x128cf3===_0x4ac21d)break;else _0x5999bc['push'](_0x5999bc['shift']());}catch(_0x5609f6){_0x5999bc['push'](_0x5999bc['shift']());}}}(a70_0x3b62,0x26b9a));var __importDefault=this&&this[a70_0x4de93c(0x11f)]||function(_0x2607a5){const _0x687618=a70_0x4de93c;return _0x2607a5&&_0x2607a5[_0x687618(0x11b)]?_0x2607a5:{'default':_0x2607a5};};Object['defineProperty'](exports,a70_0x4de93c(0x11b),{'value':!![]}),exports['IntegrationsService']=void 0x0;function a70_0x3b62(){const _0x154d6d=['webhookUrl','1375704vDcckq','267808etXdho','string','442827MGVsTe','ensureSettingsExist','isArray','shopSettings','Shop\x20settings\x20not\x20found','default','1177731ZrLLEy','getIntegrations','create','7UyixrU','1HbigkF','parse','parseWebhookEvents','292762zLDZtP','668670ieHFFC','update','__esModule','webhookEvents','1025624cxZclm','findUnique','__importDefault'];a70_0x3b62=function(){return _0x154d6d;};return a70_0x3b62();}const database_1=__importDefault(require('../config/database'));class IntegrationsService{[a70_0x4de93c(0x117)](_0x5d8127){const _0x53387c=a70_0x4de93c;if(!_0x5d8127)return[];if(Array[_0x53387c(0x10d)](_0x5d8127))return _0x5d8127;if(typeof _0x5d8127===_0x53387c(0x10a))try{const _0x30d2b0=JSON[_0x53387c(0x116)](_0x5d8127);return Array[_0x53387c(0x10d)](_0x30d2b0)?_0x30d2b0:[];}catch{return[];}return[];}async[a70_0x4de93c(0x112)](_0x5067b4){const _0x19cf6c=a70_0x4de93c;await this['ensureSettingsExist'](_0x5067b4);const _0x18c6b5=await database_1['default'][_0x19cf6c(0x10e)]['findUnique']({'where':{'shopId':_0x5067b4},'select':{'webhookUrl':!![],'webhookEvents':!![]}});if(!_0x18c6b5)throw new Error(_0x19cf6c(0x10f));return{'webhook':{'url':_0x18c6b5['webhookUrl'],'events':this[_0x19cf6c(0x117)](_0x18c6b5[_0x19cf6c(0x11c)])}};}async['updateWebhookSettings'](_0x1961fd,_0xced143){const _0x2c2f13=a70_0x4de93c;await this[_0x2c2f13(0x10c)](_0x1961fd);const _0x556352={};_0xced143[_0x2c2f13(0x120)]!==undefined&&(_0x556352[_0x2c2f13(0x120)]=_0xced143[_0x2c2f13(0x120)]||null),_0xced143['webhookEvents']!==undefined&&(_0x556352[_0x2c2f13(0x11c)]=_0xced143[_0x2c2f13(0x11c)]||[]),await database_1[_0x2c2f13(0x110)]['shopSettings'][_0x2c2f13(0x11a)]({'where':{'shopId':_0x1961fd},'data':_0x556352});}async[a70_0x4de93c(0x10c)](_0x2ca795){const _0x393b31=a70_0x4de93c,_0x1b4d71=await database_1[_0x393b31(0x110)][_0x393b31(0x10e)][_0x393b31(0x11e)]({'where':{'shopId':_0x2ca795}});!_0x1b4d71&&await database_1['default'][_0x393b31(0x10e)][_0x393b31(0x113)]({'data':{'shopId':_0x2ca795}});}}exports['IntegrationsService']=IntegrationsService;