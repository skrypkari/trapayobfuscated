'use strict';const a66_0x269f00=a66_0x24d6;(function(_0x103b7e,_0x290674){const _0x24ffac=a66_0x24d6,_0x145bb9=_0x103b7e();while(!![]){try{const _0x52090a=-parseInt(_0x24ffac(0xf1))/0x1*(-parseInt(_0x24ffac(0xfc))/0x2)+parseInt(_0x24ffac(0xf3))/0x3*(-parseInt(_0x24ffac(0xf6))/0x4)+-parseInt(_0x24ffac(0xed))/0x5+-parseInt(_0x24ffac(0xe8))/0x6*(-parseInt(_0x24ffac(0xfa))/0x7)+parseInt(_0x24ffac(0xf4))/0x8*(-parseInt(_0x24ffac(0xf5))/0x9)+-parseInt(_0x24ffac(0xe7))/0xa+parseInt(_0x24ffac(0xe9))/0xb;if(_0x52090a===_0x290674)break;else _0x145bb9['push'](_0x145bb9['shift']());}catch(_0x4dc851){_0x145bb9['push'](_0x145bb9['shift']());}}}(a66_0x1953,0x86d62));var __importDefault=this&&this[a66_0x269f00(0xe2)]||function(_0x3dc558){const _0x5c175e=a66_0x269f00;return _0x3dc558&&_0x3dc558[_0x5c175e(0xe5)]?_0x3dc558:{'default':_0x3dc558};};function a66_0x1953(){const _0x131ada=['72LMSTnp','31221839nvRoNK','getIntegrations','defineProperty','parseWebhookEvents','4002915SdqbiM','ensureSettingsExist','findUnique','shopSettings','53419vbYxqL','webhookEvents','2199ComazX','1702048VnsOse','27NtCBvW','5204WUzwnc','Shop\x20settings\x20not\x20found','default','webhookUrl','144263GsDsOK','IntegrationsService','2qqeoEz','string','__importDefault','create','isArray','__esModule','updateWebhookSettings','1943020epusdS'];a66_0x1953=function(){return _0x131ada;};return a66_0x1953();}Object[a66_0x269f00(0xeb)](exports,a66_0x269f00(0xe5),{'value':!![]}),exports[a66_0x269f00(0xfb)]=void 0x0;const database_1=__importDefault(require('../config/database'));function a66_0x24d6(_0x7043aa,_0x537b4c){_0x7043aa=_0x7043aa-0xe2;const _0x195335=a66_0x1953();let _0x24d672=_0x195335[_0x7043aa];return _0x24d672;}class IntegrationsService{[a66_0x269f00(0xec)](_0x51d317){const _0x373a58=a66_0x269f00;if(!_0x51d317)return[];if(Array[_0x373a58(0xe4)](_0x51d317))return _0x51d317;if(typeof _0x51d317===_0x373a58(0xfd))try{const _0x247625=JSON['parse'](_0x51d317);return Array[_0x373a58(0xe4)](_0x247625)?_0x247625:[];}catch{return[];}return[];}async[a66_0x269f00(0xea)](_0x405a6e){const _0x218a2b=a66_0x269f00;await this['ensureSettingsExist'](_0x405a6e);const _0x590477=await database_1[_0x218a2b(0xf8)][_0x218a2b(0xf0)]['findUnique']({'where':{'shopId':_0x405a6e},'select':{'webhookUrl':!![],'webhookEvents':!![]}});if(!_0x590477)throw new Error(_0x218a2b(0xf7));return{'webhook':{'url':_0x590477[_0x218a2b(0xf9)],'events':this[_0x218a2b(0xec)](_0x590477[_0x218a2b(0xf2)])}};}async[a66_0x269f00(0xe6)](_0x5f54ef,_0x23000b){const _0x1f8ff1=a66_0x269f00;await this['ensureSettingsExist'](_0x5f54ef);const _0x1757b7={};_0x23000b['webhookUrl']!==undefined&&(_0x1757b7['webhookUrl']=_0x23000b[_0x1f8ff1(0xf9)]||null),_0x23000b[_0x1f8ff1(0xf2)]!==undefined&&(_0x1757b7[_0x1f8ff1(0xf2)]=_0x23000b[_0x1f8ff1(0xf2)]||[]),await database_1[_0x1f8ff1(0xf8)][_0x1f8ff1(0xf0)]['update']({'where':{'shopId':_0x5f54ef},'data':_0x1757b7});}async[a66_0x269f00(0xee)](_0xec7260){const _0x145e20=a66_0x269f00,_0x2c5dcb=await database_1[_0x145e20(0xf8)]['shopSettings'][_0x145e20(0xef)]({'where':{'shopId':_0xec7260}});!_0x2c5dcb&&await database_1[_0x145e20(0xf8)]['shopSettings'][_0x145e20(0xe3)]({'data':{'shopId':_0xec7260}});}}exports['IntegrationsService']=IntegrationsService;