'use strict';const a47_0x1fe42f=a47_0x3411;(function(_0x5f458b,_0x5ea9d5){const _0x438bda=a47_0x3411,_0x1c31ed=_0x5f458b();while(!![]){try{const _0xf1b4b6=-parseInt(_0x438bda(0x8b))/0x1*(parseInt(_0x438bda(0x9e))/0x2)+parseInt(_0x438bda(0x95))/0x3+-parseInt(_0x438bda(0x92))/0x4*(-parseInt(_0x438bda(0xa5))/0x5)+-parseInt(_0x438bda(0x8c))/0x6+parseInt(_0x438bda(0x8d))/0x7*(-parseInt(_0x438bda(0x93))/0x8)+-parseInt(_0x438bda(0x8e))/0x9*(-parseInt(_0x438bda(0x8f))/0xa)+parseInt(_0x438bda(0x9c))/0xb*(parseInt(_0x438bda(0xa0))/0xc);if(_0xf1b4b6===_0x5ea9d5)break;else _0x1c31ed['push'](_0x1c31ed['shift']());}catch(_0x20ed70){_0x1c31ed['push'](_0x1c31ed['shift']());}}}(a47_0xeb70,0x55232));function a47_0xeb70(){const _0x2d5121=['default','findUnique','5968DxUTMO','1856160DteJwR','IntegrationsService','1947798tkzggy','Shop\x20settings\x20not\x20found','__esModule','ensureSettingsExist','updateWebhookSettings','string','defineProperty','22GMaOVK','isArray','20414lOHdHS','webhookUrl','2265312jKSAmG','getIntegrations','webhookEvents','parseWebhookEvents','parse','400BiWngF','shopSettings','43kptdRf','4164036UySJub','7yvOsYb','27sygIQM','1891570ETLqPW'];a47_0xeb70=function(){return _0x2d5121;};return a47_0xeb70();}var __importDefault=this&&this['__importDefault']||function(_0x426a26){const _0x16da74=a47_0x3411;return _0x426a26&&_0x426a26[_0x16da74(0x97)]?_0x426a26:{'default':_0x426a26};};function a47_0x3411(_0x42e0b7,_0x27cbc4){const _0xeb7064=a47_0xeb70();return a47_0x3411=function(_0x341154,_0x2c80bd){_0x341154=_0x341154-0x8b;let _0x4cdde4=_0xeb7064[_0x341154];return _0x4cdde4;},a47_0x3411(_0x42e0b7,_0x27cbc4);}Object[a47_0x1fe42f(0x9b)](exports,'__esModule',{'value':!![]}),exports['IntegrationsService']=void 0x0;const database_1=__importDefault(require('../config/database'));class IntegrationsService{['parseWebhookEvents'](_0x318781){const _0x1fb81d=a47_0x1fe42f;if(!_0x318781)return[];if(Array[_0x1fb81d(0x9d)](_0x318781))return _0x318781;if(typeof _0x318781===_0x1fb81d(0x9a))try{const _0x374d4d=JSON[_0x1fb81d(0xa4)](_0x318781);return Array[_0x1fb81d(0x9d)](_0x374d4d)?_0x374d4d:[];}catch{return[];}return[];}async[a47_0x1fe42f(0xa1)](_0x4bdd61){const _0x133224=a47_0x1fe42f;await this[_0x133224(0x98)](_0x4bdd61);const _0x4aa848=await database_1['default']['shopSettings'][_0x133224(0x91)]({'where':{'shopId':_0x4bdd61},'select':{'webhookUrl':!![],'webhookEvents':!![]}});if(!_0x4aa848)throw new Error(_0x133224(0x96));return{'webhook':{'url':_0x4aa848['webhookUrl'],'events':this[_0x133224(0xa3)](_0x4aa848[_0x133224(0xa2)])}};}async[a47_0x1fe42f(0x99)](_0x1d2c16,_0xeaaffb){const _0x2df842=a47_0x1fe42f;await this['ensureSettingsExist'](_0x1d2c16);const _0x29b8cb={};_0xeaaffb[_0x2df842(0x9f)]!==undefined&&(_0x29b8cb[_0x2df842(0x9f)]=_0xeaaffb['webhookUrl']||null),_0xeaaffb[_0x2df842(0xa2)]!==undefined&&(_0x29b8cb[_0x2df842(0xa2)]=_0xeaaffb[_0x2df842(0xa2)]||[]),await database_1['default'][_0x2df842(0xa6)]['update']({'where':{'shopId':_0x1d2c16},'data':_0x29b8cb});}async[a47_0x1fe42f(0x98)](_0xfd17e5){const _0x459a7f=a47_0x1fe42f,_0x1370b9=await database_1[_0x459a7f(0x90)]['shopSettings']['findUnique']({'where':{'shopId':_0xfd17e5}});!_0x1370b9&&await database_1[_0x459a7f(0x90)][_0x459a7f(0xa6)]['create']({'data':{'shopId':_0xfd17e5}});}}exports[a47_0x1fe42f(0x94)]=IntegrationsService;