'use strict';function a48_0x357d(_0x3b8d4a,_0x3b638d){const _0x52c8e5=a48_0x52c8();return a48_0x357d=function(_0x357d43,_0x2bb285){_0x357d43=_0x357d43-0x11e;let _0x12dc95=_0x52c8e5[_0x357d43];return _0x12dc95;},a48_0x357d(_0x3b8d4a,_0x3b638d);}const a48_0x30f965=a48_0x357d;(function(_0x3e72ad,_0xd50e5d){const _0x40b3cb=a48_0x357d,_0x187b24=_0x3e72ad();while(!![]){try{const _0x45e573=-parseInt(_0x40b3cb(0x137))/0x1*(-parseInt(_0x40b3cb(0x128))/0x2)+parseInt(_0x40b3cb(0x121))/0x3+parseInt(_0x40b3cb(0x136))/0x4+parseInt(_0x40b3cb(0x124))/0x5+-parseInt(_0x40b3cb(0x132))/0x6*(parseInt(_0x40b3cb(0x12d))/0x7)+-parseInt(_0x40b3cb(0x12a))/0x8+-parseInt(_0x40b3cb(0x135))/0x9;if(_0x45e573===_0xd50e5d)break;else _0x187b24['push'](_0x187b24['shift']());}catch(_0x11b4be){_0x187b24['push'](_0x187b24['shift']());}}}(a48_0x52c8,0x233e1));function a48_0x52c8(){const _0x46258a=['parseWebhookEvents','__importDefault','webhookUrl','673200YKiUPM','IntegrationsService','parse','436430xKbohB','ensureSettingsExist','updateWebhookSettings','__esModule','117596YuyCWv','create','2190648ghubjv','default','defineProperty','1589AIMgnG','getIntegrations','shopSettings','update','webhookEvents','4938zaLouZ','findUnique','../config/database','897219sxGjjC','631272JGzBvW','4NgENJI','isArray'];a48_0x52c8=function(){return _0x46258a;};return a48_0x52c8();}var __importDefault=this&&this[a48_0x30f965(0x11f)]||function(_0x4ccd3a){const _0x4c637e=a48_0x30f965;return _0x4ccd3a&&_0x4ccd3a[_0x4c637e(0x127)]?_0x4ccd3a:{'default':_0x4ccd3a};};Object[a48_0x30f965(0x12c)](exports,a48_0x30f965(0x127),{'value':!![]}),exports[a48_0x30f965(0x122)]=void 0x0;const database_1=__importDefault(require(a48_0x30f965(0x134)));class IntegrationsService{[a48_0x30f965(0x11e)](_0x30415a){const _0x199b7c=a48_0x30f965;if(!_0x30415a)return[];if(Array['isArray'](_0x30415a))return _0x30415a;if(typeof _0x30415a==='string')try{const _0x44022b=JSON[_0x199b7c(0x123)](_0x30415a);return Array[_0x199b7c(0x138)](_0x44022b)?_0x44022b:[];}catch{return[];}return[];}async[a48_0x30f965(0x12e)](_0x232c02){const _0x413b9f=a48_0x30f965;await this[_0x413b9f(0x125)](_0x232c02);const _0x2aef19=await database_1[_0x413b9f(0x12b)][_0x413b9f(0x12f)][_0x413b9f(0x133)]({'where':{'shopId':_0x232c02},'select':{'webhookUrl':!![],'webhookEvents':!![]}});if(!_0x2aef19)throw new Error('Shop\x20settings\x20not\x20found');return{'webhook':{'url':_0x2aef19[_0x413b9f(0x120)],'events':this[_0x413b9f(0x11e)](_0x2aef19[_0x413b9f(0x131)])}};}async[a48_0x30f965(0x126)](_0x4b4e44,_0x3fe41f){const _0x1e3729=a48_0x30f965;await this['ensureSettingsExist'](_0x4b4e44);const _0x43f5f7={};_0x3fe41f['webhookUrl']!==undefined&&(_0x43f5f7[_0x1e3729(0x120)]=_0x3fe41f[_0x1e3729(0x120)]||null),_0x3fe41f[_0x1e3729(0x131)]!==undefined&&(_0x43f5f7[_0x1e3729(0x131)]=_0x3fe41f['webhookEvents']||[]),await database_1[_0x1e3729(0x12b)][_0x1e3729(0x12f)][_0x1e3729(0x130)]({'where':{'shopId':_0x4b4e44},'data':_0x43f5f7});}async[a48_0x30f965(0x125)](_0x2cbe75){const _0x145e17=a48_0x30f965,_0x365efd=await database_1[_0x145e17(0x12b)]['shopSettings'][_0x145e17(0x133)]({'where':{'shopId':_0x2cbe75}});!_0x365efd&&await database_1[_0x145e17(0x12b)][_0x145e17(0x12f)][_0x145e17(0x129)]({'data':{'shopId':_0x2cbe75}});}}exports[a48_0x30f965(0x122)]=IntegrationsService;