'use strict';const a54_0x349e0a=a54_0x4076;(function(_0x36efea,_0x48bc89){const _0x522ad2=a54_0x4076,_0x5b1544=_0x36efea();while(!![]){try{const _0x90d1ad=-parseInt(_0x522ad2(0x137))/0x1+-parseInt(_0x522ad2(0x142))/0x2+-parseInt(_0x522ad2(0x143))/0x3+parseInt(_0x522ad2(0x14c))/0x4+parseInt(_0x522ad2(0x14e))/0x5*(parseInt(_0x522ad2(0x146))/0x6)+-parseInt(_0x522ad2(0x13d))/0x7*(-parseInt(_0x522ad2(0x149))/0x8)+parseInt(_0x522ad2(0x148))/0x9;if(_0x90d1ad===_0x48bc89)break;else _0x5b1544['push'](_0x5b1544['shift']());}catch(_0x1eccd7){_0x5b1544['push'](_0x5b1544['shift']());}}}(a54_0xee83,0x2ba84));var __importDefault=this&&this[a54_0x349e0a(0x139)]||function(_0x3040fe){return _0x3040fe&&_0x3040fe['__esModule']?_0x3040fe:{'default':_0x3040fe};};function a54_0x4076(_0x29ef93,_0x10970f){const _0xee8399=a54_0xee83();return a54_0x4076=function(_0x407640,_0x4b463a){_0x407640=_0x407640-0x136;let _0x2a2e48=_0xee8399[_0x407640];return _0x2a2e48;},a54_0x4076(_0x29ef93,_0x10970f);}Object[a54_0x349e0a(0x144)](exports,'__esModule',{'value':!![]}),exports[a54_0x349e0a(0x138)]=void 0x0;const database_1=__importDefault(require(a54_0x349e0a(0x136)));function a54_0xee83(){const _0x1a7acf=['webhookUrl','364446XLZqiG','543831lkBmBd','defineProperty','create','8022EnimAb','default','1055241EuSpPF','789512pEAIqk','isArray','webhookEvents','509260XJzCgK','findUnique','610lKNyCm','string','../config/database','62736zkuknC','IntegrationsService','__importDefault','getIntegrations','parse','update','14xjOYJr','shopSettings','ensureSettingsExist','parseWebhookEvents'];a54_0xee83=function(){return _0x1a7acf;};return a54_0xee83();}class IntegrationsService{['parseWebhookEvents'](_0x201613){const _0x519452=a54_0x349e0a;if(!_0x201613)return[];if(Array[_0x519452(0x14a)](_0x201613))return _0x201613;if(typeof _0x201613===_0x519452(0x14f))try{const _0x2da2d3=JSON[_0x519452(0x13b)](_0x201613);return Array[_0x519452(0x14a)](_0x2da2d3)?_0x2da2d3:[];}catch{return[];}return[];}async[a54_0x349e0a(0x13a)](_0x41bfcb){const _0x4d5665=a54_0x349e0a;await this[_0x4d5665(0x13f)](_0x41bfcb);const _0x49fec8=await database_1[_0x4d5665(0x147)]['shopSettings']['findUnique']({'where':{'shopId':_0x41bfcb},'select':{'webhookUrl':!![],'webhookEvents':!![]}});if(!_0x49fec8)throw new Error('Shop\x20settings\x20not\x20found');return{'webhook':{'url':_0x49fec8['webhookUrl'],'events':this[_0x4d5665(0x140)](_0x49fec8['webhookEvents'])}};}async['updateWebhookSettings'](_0x237d76,_0x30e849){const _0x3549a0=a54_0x349e0a;await this[_0x3549a0(0x13f)](_0x237d76);const _0x33e7f5={};_0x30e849[_0x3549a0(0x141)]!==undefined&&(_0x33e7f5[_0x3549a0(0x141)]=_0x30e849['webhookUrl']||null),_0x30e849[_0x3549a0(0x14b)]!==undefined&&(_0x33e7f5[_0x3549a0(0x14b)]=_0x30e849[_0x3549a0(0x14b)]||[]),await database_1['default'][_0x3549a0(0x13e)][_0x3549a0(0x13c)]({'where':{'shopId':_0x237d76},'data':_0x33e7f5});}async['ensureSettingsExist'](_0x1c93ff){const _0x3148fb=a54_0x349e0a,_0x561c4e=await database_1[_0x3148fb(0x147)]['shopSettings'][_0x3148fb(0x14d)]({'where':{'shopId':_0x1c93ff}});!_0x561c4e&&await database_1[_0x3148fb(0x147)][_0x3148fb(0x13e)][_0x3148fb(0x145)]({'data':{'shopId':_0x1c93ff}});}}exports['IntegrationsService']=IntegrationsService;