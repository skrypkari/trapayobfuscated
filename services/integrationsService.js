'use strict';const a43_0x29f7d1=a43_0x2782;function a43_0x2782(_0x1ce64b,_0x38c4ec){const _0x1ece9d=a43_0x1ece();return a43_0x2782=function(_0x278245,_0x45a742){_0x278245=_0x278245-0x112;let _0xaa46e0=_0x1ece9d[_0x278245];return _0xaa46e0;},a43_0x2782(_0x1ce64b,_0x38c4ec);}(function(_0x2e17ea,_0x6faff6){const _0x56979b=a43_0x2782,_0x44c106=_0x2e17ea();while(!![]){try{const _0xa08acd=parseInt(_0x56979b(0x123))/0x1*(parseInt(_0x56979b(0x124))/0x2)+parseInt(_0x56979b(0x129))/0x3*(parseInt(_0x56979b(0x120))/0x4)+-parseInt(_0x56979b(0x12a))/0x5*(-parseInt(_0x56979b(0x11e))/0x6)+-parseInt(_0x56979b(0x117))/0x7+-parseInt(_0x56979b(0x11c))/0x8+parseInt(_0x56979b(0x118))/0x9+-parseInt(_0x56979b(0x115))/0xa*(parseInt(_0x56979b(0x112))/0xb);if(_0xa08acd===_0x6faff6)break;else _0x44c106['push'](_0x44c106['shift']());}catch(_0x18f740){_0x44c106['push'](_0x44c106['shift']());}}}(a43_0x1ece,0x33229));var __importDefault=this&&this[a43_0x29f7d1(0x11a)]||function(_0xcfbcd4){const _0xdc5eb5=a43_0x29f7d1;return _0xcfbcd4&&_0xcfbcd4[_0xdc5eb5(0x11b)]?_0xcfbcd4:{'default':_0xcfbcd4};};Object[a43_0x29f7d1(0x121)](exports,a43_0x29f7d1(0x11b),{'value':!![]}),exports[a43_0x29f7d1(0x11f)]=void 0x0;const database_1=__importDefault(require(a43_0x29f7d1(0x12b)));function a43_0x1ece(){const _0x3cf59f=['webhookUrl','15OXPRYE','5eWXdRF','../config/database','string','parseWebhookEvents','shopSettings','979lzdUEo','parse','updateWebhookSettings','2210WbnRDt','getIntegrations','1691620jsJjtR','1691541rhGbSs','webhookEvents','__importDefault','__esModule','720672ZVNIHg','ensureSettingsExist','822LOMkLL','IntegrationsService','296756tXgOSk','defineProperty','default','1831MbtfsI','2XEIHPK','isArray','findUnique','create'];a43_0x1ece=function(){return _0x3cf59f;};return a43_0x1ece();}class IntegrationsService{[a43_0x29f7d1(0x12d)](_0x474e8e){const _0x2b2e75=a43_0x29f7d1;if(!_0x474e8e)return[];if(Array[_0x2b2e75(0x125)](_0x474e8e))return _0x474e8e;if(typeof _0x474e8e===_0x2b2e75(0x12c))try{const _0x3941b1=JSON[_0x2b2e75(0x113)](_0x474e8e);return Array[_0x2b2e75(0x125)](_0x3941b1)?_0x3941b1:[];}catch{return[];}return[];}async[a43_0x29f7d1(0x116)](_0x5e6baf){const _0x271990=a43_0x29f7d1;await this[_0x271990(0x11d)](_0x5e6baf);const _0x4d607d=await database_1[_0x271990(0x122)]['shopSettings'][_0x271990(0x126)]({'where':{'shopId':_0x5e6baf},'select':{'webhookUrl':!![],'webhookEvents':!![]}});if(!_0x4d607d)throw new Error('Shop\x20settings\x20not\x20found');return{'webhook':{'url':_0x4d607d[_0x271990(0x128)],'events':this[_0x271990(0x12d)](_0x4d607d[_0x271990(0x119)])}};}async[a43_0x29f7d1(0x114)](_0x549ae4,_0x55d7d3){const _0x2e8557=a43_0x29f7d1;await this[_0x2e8557(0x11d)](_0x549ae4);const _0x211df8={};_0x55d7d3[_0x2e8557(0x128)]!==undefined&&(_0x211df8[_0x2e8557(0x128)]=_0x55d7d3[_0x2e8557(0x128)]||null),_0x55d7d3[_0x2e8557(0x119)]!==undefined&&(_0x211df8[_0x2e8557(0x119)]=_0x55d7d3[_0x2e8557(0x119)]||[]),await database_1[_0x2e8557(0x122)][_0x2e8557(0x12e)]['update']({'where':{'shopId':_0x549ae4},'data':_0x211df8});}async[a43_0x29f7d1(0x11d)](_0x168f4b){const _0x3ef595=a43_0x29f7d1,_0x492736=await database_1['default'][_0x3ef595(0x12e)]['findUnique']({'where':{'shopId':_0x168f4b}});!_0x492736&&await database_1[_0x3ef595(0x122)][_0x3ef595(0x12e)][_0x3ef595(0x127)]({'data':{'shopId':_0x168f4b}});}}exports[a43_0x29f7d1(0x11f)]=IntegrationsService;