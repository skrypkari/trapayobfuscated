'use strict';const a47_0x591c20=a47_0x2004;(function(_0x5f55be,_0x40241c){const _0x56a508=a47_0x2004,_0xa9cd3e=_0x5f55be();while(!![]){try{const _0x2640b1=-parseInt(_0x56a508(0x190))/0x1*(-parseInt(_0x56a508(0x192))/0x2)+parseInt(_0x56a508(0x184))/0x3+-parseInt(_0x56a508(0x191))/0x4+-parseInt(_0x56a508(0x17e))/0x5+-parseInt(_0x56a508(0x186))/0x6*(-parseInt(_0x56a508(0x18a))/0x7)+-parseInt(_0x56a508(0x17b))/0x8*(parseInt(_0x56a508(0x17a))/0x9)+parseInt(_0x56a508(0x18e))/0xa*(parseInt(_0x56a508(0x18b))/0xb);if(_0x2640b1===_0x40241c)break;else _0xa9cd3e['push'](_0xa9cd3e['shift']());}catch(_0x5c1a54){_0xa9cd3e['push'](_0xa9cd3e['shift']());}}}(a47_0x3adb,0x84e93));function a47_0x2004(_0x45ebcb,_0x48c434){const _0x3adb70=a47_0x3adb();return a47_0x2004=function(_0x2004b6,_0x302de5){_0x2004b6=_0x2004b6-0x17a;let _0x382e83=_0x3adb70[_0x2004b6];return _0x382e83;},a47_0x2004(_0x45ebcb,_0x48c434);}var __importDefault=this&&this[a47_0x591c20(0x185)]||function(_0x17982f){const _0x44295a=a47_0x591c20;return _0x17982f&&_0x17982f[_0x44295a(0x18c)]?_0x17982f:{'default':_0x17982f};};Object[a47_0x591c20(0x196)](exports,a47_0x591c20(0x18c),{'value':!![]}),exports[a47_0x591c20(0x187)]=void 0x0;const database_1=__importDefault(require('../config/database'));class IntegrationsService{[a47_0x591c20(0x182)](_0x4ae1b4){const _0x24ac06=a47_0x591c20;if(!_0x4ae1b4)return[];if(Array[_0x24ac06(0x194)](_0x4ae1b4))return _0x4ae1b4;if(typeof _0x4ae1b4===_0x24ac06(0x18f))try{const _0x85af95=JSON[_0x24ac06(0x195)](_0x4ae1b4);return Array[_0x24ac06(0x194)](_0x85af95)?_0x85af95:[];}catch{return[];}return[];}async[a47_0x591c20(0x183)](_0x575764){const _0x57d965=a47_0x591c20;await this['ensureSettingsExist'](_0x575764);const _0x4cee76=await database_1[_0x57d965(0x189)]['shopSettings'][_0x57d965(0x188)]({'where':{'shopId':_0x575764},'select':{'webhookUrl':!![],'webhookEvents':!![]}});if(!_0x4cee76)throw new Error(_0x57d965(0x18d));return{'webhook':{'url':_0x4cee76['webhookUrl'],'events':this[_0x57d965(0x182)](_0x4cee76[_0x57d965(0x17f)])}};}async[a47_0x591c20(0x180)](_0x1a3d52,_0x5d52a4){const _0x335000=a47_0x591c20;await this['ensureSettingsExist'](_0x1a3d52);const _0x131369={};_0x5d52a4[_0x335000(0x193)]!==undefined&&(_0x131369[_0x335000(0x193)]=_0x5d52a4['webhookUrl']||null),_0x5d52a4[_0x335000(0x17f)]!==undefined&&(_0x131369[_0x335000(0x17f)]=_0x5d52a4['webhookEvents']||[]),await database_1['default'][_0x335000(0x17d)]['update']({'where':{'shopId':_0x1a3d52},'data':_0x131369});}async[a47_0x591c20(0x17c)](_0x3d0542){const _0xe0fddf=a47_0x591c20,_0x3e0123=await database_1[_0xe0fddf(0x189)][_0xe0fddf(0x17d)]['findUnique']({'where':{'shopId':_0x3d0542}});!_0x3e0123&&await database_1[_0xe0fddf(0x189)][_0xe0fddf(0x17d)][_0xe0fddf(0x181)]({'data':{'shopId':_0x3d0542}});}}function a47_0x3adb(){const _0x5ea854=['1BOTghb','3037732lkCzdQ','1326124kCRRsv','webhookUrl','isArray','parse','defineProperty','13563QapxOK','2992aHtNeE','ensureSettingsExist','shopSettings','1202710KgMnlY','webhookEvents','updateWebhookSettings','create','parseWebhookEvents','getIntegrations','2113716wzOrTx','__importDefault','6LgYuDP','IntegrationsService','findUnique','default','1869945JdZcDu','11gmBqyY','__esModule','Shop\x20settings\x20not\x20found','4732270xZOWBl','string'];a47_0x3adb=function(){return _0x5ea854;};return a47_0x3adb();}exports[a47_0x591c20(0x187)]=IntegrationsService;