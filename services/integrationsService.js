'use strict';const a43_0x32fbd7=a43_0x26fd;function a43_0x4d1f(){const _0x10fe8a=['14718jMwwmA','179788GUVCUF','1AbRekv','default','2430800eVfMXI','__esModule','parse','isArray','shopSettings','3830GcKcTY','defineProperty','1009614OBFjwn','getIntegrations','IntegrationsService','updateWebhookSettings','../config/database','create','webhookEvents','3KwWtyC','ensureSettingsExist','parseWebhookEvents','findUnique','update','480150vHVqeK','webhookUrl','419475cUtgkl','184YhdjpM','37822cgxPDR'];a43_0x4d1f=function(){return _0x10fe8a;};return a43_0x4d1f();}(function(_0x11d2b4,_0x1df658){const _0x5547bd=a43_0x26fd,_0x23876e=_0x11d2b4();while(!![]){try{const _0x30029d=-parseInt(_0x5547bd(0x179))/0x1*(parseInt(_0x5547bd(0x176))/0x2)+-parseInt(_0x5547bd(0x16d))/0x3*(parseInt(_0x5547bd(0x17b))/0x4)+parseInt(_0x5547bd(0x174))/0x5+-parseInt(_0x5547bd(0x166))/0x6+-parseInt(_0x5547bd(0x178))/0x7*(-parseInt(_0x5547bd(0x175))/0x8)+-parseInt(_0x5547bd(0x172))/0x9+parseInt(_0x5547bd(0x164))/0xa*(parseInt(_0x5547bd(0x177))/0xb);if(_0x30029d===_0x1df658)break;else _0x23876e['push'](_0x23876e['shift']());}catch(_0x44ddb6){_0x23876e['push'](_0x23876e['shift']());}}}(a43_0x4d1f,0x52ba3));function a43_0x26fd(_0x2411cd,_0x2ffae5){const _0x4d1ff1=a43_0x4d1f();return a43_0x26fd=function(_0x26fd2a,_0x1dcd5c){_0x26fd2a=_0x26fd2a-0x161;let _0x1e9f0a=_0x4d1ff1[_0x26fd2a];return _0x1e9f0a;},a43_0x26fd(_0x2411cd,_0x2ffae5);}var __importDefault=this&&this['__importDefault']||function(_0x326f4b){const _0xaa781=a43_0x26fd;return _0x326f4b&&_0x326f4b[_0xaa781(0x17c)]?_0x326f4b:{'default':_0x326f4b};};Object[a43_0x32fbd7(0x165)](exports,'__esModule',{'value':!![]}),exports[a43_0x32fbd7(0x168)]=void 0x0;const database_1=__importDefault(require(a43_0x32fbd7(0x16a)));class IntegrationsService{['parseWebhookEvents'](_0x1b08f5){const _0x38bc6c=a43_0x32fbd7;if(!_0x1b08f5)return[];if(Array['isArray'](_0x1b08f5))return _0x1b08f5;if(typeof _0x1b08f5==='string')try{const _0xd979b6=JSON[_0x38bc6c(0x161)](_0x1b08f5);return Array[_0x38bc6c(0x162)](_0xd979b6)?_0xd979b6:[];}catch{return[];}return[];}async[a43_0x32fbd7(0x167)](_0x80443a){const _0x184c7b=a43_0x32fbd7;await this[_0x184c7b(0x16e)](_0x80443a);const _0x1c9871=await database_1[_0x184c7b(0x17a)][_0x184c7b(0x163)][_0x184c7b(0x170)]({'where':{'shopId':_0x80443a},'select':{'webhookUrl':!![],'webhookEvents':!![]}});if(!_0x1c9871)throw new Error('Shop\x20settings\x20not\x20found');return{'webhook':{'url':_0x1c9871[_0x184c7b(0x173)],'events':this[_0x184c7b(0x16f)](_0x1c9871[_0x184c7b(0x16c)])}};}async[a43_0x32fbd7(0x169)](_0x4dfd54,_0x260da6){const _0x334e8d=a43_0x32fbd7;await this[_0x334e8d(0x16e)](_0x4dfd54);const _0x320c47={};_0x260da6[_0x334e8d(0x173)]!==undefined&&(_0x320c47[_0x334e8d(0x173)]=_0x260da6['webhookUrl']||null),_0x260da6[_0x334e8d(0x16c)]!==undefined&&(_0x320c47['webhookEvents']=_0x260da6[_0x334e8d(0x16c)]||[]),await database_1[_0x334e8d(0x17a)][_0x334e8d(0x163)][_0x334e8d(0x171)]({'where':{'shopId':_0x4dfd54},'data':_0x320c47});}async[a43_0x32fbd7(0x16e)](_0x11a558){const _0x5754e2=a43_0x32fbd7,_0x1d1fc0=await database_1[_0x5754e2(0x17a)][_0x5754e2(0x163)][_0x5754e2(0x170)]({'where':{'shopId':_0x11a558}});!_0x1d1fc0&&await database_1[_0x5754e2(0x17a)][_0x5754e2(0x163)][_0x5754e2(0x16b)]({'data':{'shopId':_0x11a558}});}}exports['IntegrationsService']=IntegrationsService;