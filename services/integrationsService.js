'use strict';function a54_0x101f(_0xfbebf6,_0x501d97){const _0xe3e0f9=a54_0xe3e0();return a54_0x101f=function(_0x101fa5,_0xdeaeb4){_0x101fa5=_0x101fa5-0xe7;let _0x96f949=_0xe3e0f9[_0x101fa5];return _0x96f949;},a54_0x101f(_0xfbebf6,_0x501d97);}const a54_0x20d1b9=a54_0x101f;(function(_0x329fae,_0xc333da){const _0x2bec4e=a54_0x101f,_0xab1224=_0x329fae();while(!![]){try{const _0x1987f9=parseInt(_0x2bec4e(0xf9))/0x1*(-parseInt(_0x2bec4e(0xea))/0x2)+-parseInt(_0x2bec4e(0xe7))/0x3+parseInt(_0x2bec4e(0xff))/0x4+parseInt(_0x2bec4e(0xfd))/0x5*(-parseInt(_0x2bec4e(0xf3))/0x6)+-parseInt(_0x2bec4e(0xfa))/0x7*(parseInt(_0x2bec4e(0xfe))/0x8)+parseInt(_0x2bec4e(0xf4))/0x9+parseInt(_0x2bec4e(0xe9))/0xa*(parseInt(_0x2bec4e(0xf7))/0xb);if(_0x1987f9===_0xc333da)break;else _0xab1224['push'](_0xab1224['shift']());}catch(_0xda2ebc){_0xab1224['push'](_0xab1224['shift']());}}}(a54_0xe3e0,0x186bd));var __importDefault=this&&this[a54_0x20d1b9(0xfb)]||function(_0x536685){const _0x33598c=a54_0x20d1b9;return _0x536685&&_0x536685[_0x33598c(0xe8)]?_0x536685:{'default':_0x536685};};Object['defineProperty'](exports,a54_0x20d1b9(0xe8),{'value':!![]}),exports[a54_0x20d1b9(0xef)]=void 0x0;function a54_0xe3e0(){const _0xa54118=['Shop\x20settings\x20not\x20found','../config/database','getIntegrations','findUnique','IntegrationsService','webhookUrl','shopSettings','parse','18FVhNNW','1047222bukmvY','webhookEvents','update','11nixvAD','ensureSettingsExist','1vtptmU','791SnnFzT','__importDefault','default','60445qSacgv','2848TiRhrg','594044CQCJwD','isArray','parseWebhookEvents','create','405480AIMimP','__esModule','1138580xajJFG','134086SjvCWv'];a54_0xe3e0=function(){return _0xa54118;};return a54_0xe3e0();}const database_1=__importDefault(require(a54_0x20d1b9(0xec)));class IntegrationsService{[a54_0x20d1b9(0x101)](_0x29a98a){const _0x37e514=a54_0x20d1b9;if(!_0x29a98a)return[];if(Array[_0x37e514(0x100)](_0x29a98a))return _0x29a98a;if(typeof _0x29a98a==='string')try{const _0x957167=JSON[_0x37e514(0xf2)](_0x29a98a);return Array[_0x37e514(0x100)](_0x957167)?_0x957167:[];}catch{return[];}return[];}async[a54_0x20d1b9(0xed)](_0x12e942){const _0xbe4a3f=a54_0x20d1b9;await this[_0xbe4a3f(0xf8)](_0x12e942);const _0x477024=await database_1[_0xbe4a3f(0xfc)][_0xbe4a3f(0xf1)][_0xbe4a3f(0xee)]({'where':{'shopId':_0x12e942},'select':{'webhookUrl':!![],'webhookEvents':!![]}});if(!_0x477024)throw new Error(_0xbe4a3f(0xeb));return{'webhook':{'url':_0x477024[_0xbe4a3f(0xf0)],'events':this[_0xbe4a3f(0x101)](_0x477024['webhookEvents'])}};}async['updateWebhookSettings'](_0x545ab1,_0x1e47c3){const _0x4dcd90=a54_0x20d1b9;await this['ensureSettingsExist'](_0x545ab1);const _0x5370be={};_0x1e47c3[_0x4dcd90(0xf0)]!==undefined&&(_0x5370be[_0x4dcd90(0xf0)]=_0x1e47c3[_0x4dcd90(0xf0)]||null),_0x1e47c3[_0x4dcd90(0xf5)]!==undefined&&(_0x5370be[_0x4dcd90(0xf5)]=_0x1e47c3[_0x4dcd90(0xf5)]||[]),await database_1[_0x4dcd90(0xfc)]['shopSettings'][_0x4dcd90(0xf6)]({'where':{'shopId':_0x545ab1},'data':_0x5370be});}async[a54_0x20d1b9(0xf8)](_0x14560e){const _0x236a6d=a54_0x20d1b9,_0xdf22cc=await database_1[_0x236a6d(0xfc)][_0x236a6d(0xf1)][_0x236a6d(0xee)]({'where':{'shopId':_0x14560e}});!_0xdf22cc&&await database_1[_0x236a6d(0xfc)][_0x236a6d(0xf1)][_0x236a6d(0x102)]({'data':{'shopId':_0x14560e}});}}exports[a54_0x20d1b9(0xef)]=IntegrationsService;