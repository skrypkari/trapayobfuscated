'use strict';const a55_0xd164f0=a55_0x350f;function a55_0x2942(){const _0x118ca6=['24492ChTUPI','1365579svKzrY','update','24uspkrN','default','1198282yCiCgt','shopSettings','__importDefault','defineProperty','4911VyMnHt','1144EDKeqF','parse','findUnique','Shop\x20settings\x20not\x20found','247836DkqaOx','260pzNLKj','webhookEvents','../config/database','webhookUrl','1067BHIieG','907004VQJAvF','isArray','ensureSettingsExist','create','13119580nXHcle','IntegrationsService','parseWebhookEvents','1VyyHwH'];a55_0x2942=function(){return _0x118ca6;};return a55_0x2942();}(function(_0x474ba6,_0x4efc9c){const _0x2dd98c=a55_0x350f,_0x3b72cf=_0x474ba6();while(!![]){try{const _0x5a8019=parseInt(_0x2dd98c(0xa2))/0x1*(-parseInt(_0x2dd98c(0xa8))/0x2)+-parseInt(_0x2dd98c(0xac))/0x3*(-parseInt(_0x2dd98c(0xad))/0x4)+-parseInt(_0x2dd98c(0x96))/0x5*(parseInt(_0x2dd98c(0xa3))/0x6)+parseInt(_0x2dd98c(0x9b))/0x7+-parseInt(_0x2dd98c(0xa6))/0x8*(-parseInt(_0x2dd98c(0xa4))/0x9)+-parseInt(_0x2dd98c(0x9f))/0xa+parseInt(_0x2dd98c(0x9a))/0xb*(parseInt(_0x2dd98c(0x95))/0xc);if(_0x5a8019===_0x4efc9c)break;else _0x3b72cf['push'](_0x3b72cf['shift']());}catch(_0x4960dc){_0x3b72cf['push'](_0x3b72cf['shift']());}}}(a55_0x2942,0xe3c3d));var __importDefault=this&&this[a55_0xd164f0(0xaa)]||function(_0x57148e){return _0x57148e&&_0x57148e['__esModule']?_0x57148e:{'default':_0x57148e};};Object[a55_0xd164f0(0xab)](exports,'__esModule',{'value':!![]}),exports[a55_0xd164f0(0xa0)]=void 0x0;const database_1=__importDefault(require(a55_0xd164f0(0x98)));class IntegrationsService{[a55_0xd164f0(0xa1)](_0x2e5cc1){const _0x2c3d03=a55_0xd164f0;if(!_0x2e5cc1)return[];if(Array[_0x2c3d03(0x9c)](_0x2e5cc1))return _0x2e5cc1;if(typeof _0x2e5cc1==='string')try{const _0x4ca5a8=JSON[_0x2c3d03(0xae)](_0x2e5cc1);return Array['isArray'](_0x4ca5a8)?_0x4ca5a8:[];}catch{return[];}return[];}async['getIntegrations'](_0x24181f){const _0x540143=a55_0xd164f0;await this[_0x540143(0x9d)](_0x24181f);const _0x18a0d5=await database_1[_0x540143(0xa7)][_0x540143(0xa9)][_0x540143(0xaf)]({'where':{'shopId':_0x24181f},'select':{'webhookUrl':!![],'webhookEvents':!![]}});if(!_0x18a0d5)throw new Error(_0x540143(0xb0));return{'webhook':{'url':_0x18a0d5[_0x540143(0x99)],'events':this['parseWebhookEvents'](_0x18a0d5[_0x540143(0x97)])}};}async['updateWebhookSettings'](_0x5713e6,_0xeeff33){const _0x340a6c=a55_0xd164f0;await this[_0x340a6c(0x9d)](_0x5713e6);const _0x55226f={};_0xeeff33['webhookUrl']!==undefined&&(_0x55226f[_0x340a6c(0x99)]=_0xeeff33[_0x340a6c(0x99)]||null),_0xeeff33['webhookEvents']!==undefined&&(_0x55226f['webhookEvents']=_0xeeff33[_0x340a6c(0x97)]||[]),await database_1[_0x340a6c(0xa7)][_0x340a6c(0xa9)][_0x340a6c(0xa5)]({'where':{'shopId':_0x5713e6},'data':_0x55226f});}async[a55_0xd164f0(0x9d)](_0x1dba51){const _0x6feaa=a55_0xd164f0,_0x2ed2ce=await database_1['default']['shopSettings']['findUnique']({'where':{'shopId':_0x1dba51}});!_0x2ed2ce&&await database_1[_0x6feaa(0xa7)]['shopSettings'][_0x6feaa(0x9e)]({'data':{'shopId':_0x1dba51}});}}function a55_0x350f(_0xf8c5ed,_0xe64dca){const _0x294283=a55_0x2942();return a55_0x350f=function(_0x350fab,_0x24df77){_0x350fab=_0x350fab-0x95;let _0x2762e2=_0x294283[_0x350fab];return _0x2762e2;},a55_0x350f(_0xf8c5ed,_0xe64dca);}exports[a55_0xd164f0(0xa0)]=IntegrationsService;