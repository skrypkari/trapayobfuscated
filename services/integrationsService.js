'use strict';const a47_0x1c655a=a47_0x3dd0;(function(_0x239af7,_0x401ac8){const _0x34b399=a47_0x3dd0,_0x3feb76=_0x239af7();while(!![]){try{const _0x5585e8=parseInt(_0x34b399(0x132))/0x1+-parseInt(_0x34b399(0x143))/0x2+-parseInt(_0x34b399(0x146))/0x3+parseInt(_0x34b399(0x148))/0x4*(-parseInt(_0x34b399(0x133))/0x5)+-parseInt(_0x34b399(0x14c))/0x6*(parseInt(_0x34b399(0x13d))/0x7)+-parseInt(_0x34b399(0x145))/0x8*(-parseInt(_0x34b399(0x136))/0x9)+parseInt(_0x34b399(0x13c))/0xa*(parseInt(_0x34b399(0x14b))/0xb);if(_0x5585e8===_0x401ac8)break;else _0x3feb76['push'](_0x3feb76['shift']());}catch(_0x2eb70a){_0x3feb76['push'](_0x3feb76['shift']());}}}(a47_0x5960,0xe8aa7));var __importDefault=this&&this[a47_0x1c655a(0x138)]||function(_0x27ebac){const _0x46953b=a47_0x1c655a;return _0x27ebac&&_0x27ebac[_0x46953b(0x14a)]?_0x27ebac:{'default':_0x27ebac};};Object['defineProperty'](exports,a47_0x1c655a(0x14a),{'value':!![]}),exports[a47_0x1c655a(0x142)]=void 0x0;function a47_0x3dd0(_0x4cd377,_0x5c851c){const _0x59605f=a47_0x5960();return a47_0x3dd0=function(_0x3dd0a4,_0xa0ad0d){_0x3dd0a4=_0x3dd0a4-0x132;let _0x230081=_0x59605f[_0x3dd0a4];return _0x230081;},a47_0x3dd0(_0x4cd377,_0x5c851c);}function a47_0x5960(){const _0x30adde=['17408770YdLBKX','133QpjuJs','ensureSettingsExist','getIntegrations','findUnique','parse','IntegrationsService','3271140ejFhrd','webhookUrl','581776XhocjP','5066961UATJzV','../config/database','4UwRMnC','shopSettings','__esModule','22sqsTWW','346548MqyxEs','create','1768457ueZSSo','4466805eomkNb','isArray','update','126INItVC','webhookEvents','__importDefault','Shop\x20settings\x20not\x20found','parseWebhookEvents','default'];a47_0x5960=function(){return _0x30adde;};return a47_0x5960();}const database_1=__importDefault(require(a47_0x1c655a(0x147)));class IntegrationsService{[a47_0x1c655a(0x13a)](_0x371b8f){const _0x257452=a47_0x1c655a;if(!_0x371b8f)return[];if(Array[_0x257452(0x134)](_0x371b8f))return _0x371b8f;if(typeof _0x371b8f==='string')try{const _0x527bf1=JSON[_0x257452(0x141)](_0x371b8f);return Array[_0x257452(0x134)](_0x527bf1)?_0x527bf1:[];}catch{return[];}return[];}async[a47_0x1c655a(0x13f)](_0x29f944){const _0x4ff04f=a47_0x1c655a;await this[_0x4ff04f(0x13e)](_0x29f944);const _0x2b0963=await database_1[_0x4ff04f(0x13b)][_0x4ff04f(0x149)][_0x4ff04f(0x140)]({'where':{'shopId':_0x29f944},'select':{'webhookUrl':!![],'webhookEvents':!![]}});if(!_0x2b0963)throw new Error(_0x4ff04f(0x139));return{'webhook':{'url':_0x2b0963[_0x4ff04f(0x144)],'events':this[_0x4ff04f(0x13a)](_0x2b0963['webhookEvents'])}};}async['updateWebhookSettings'](_0x5863f8,_0x5c799f){const _0x18eb6b=a47_0x1c655a;await this[_0x18eb6b(0x13e)](_0x5863f8);const _0x479b9a={};_0x5c799f[_0x18eb6b(0x144)]!==undefined&&(_0x479b9a[_0x18eb6b(0x144)]=_0x5c799f[_0x18eb6b(0x144)]||null),_0x5c799f[_0x18eb6b(0x137)]!==undefined&&(_0x479b9a['webhookEvents']=_0x5c799f[_0x18eb6b(0x137)]||[]),await database_1[_0x18eb6b(0x13b)][_0x18eb6b(0x149)][_0x18eb6b(0x135)]({'where':{'shopId':_0x5863f8},'data':_0x479b9a});}async[a47_0x1c655a(0x13e)](_0x3fa612){const _0x206748=a47_0x1c655a,_0x1afc79=await database_1[_0x206748(0x13b)]['shopSettings'][_0x206748(0x140)]({'where':{'shopId':_0x3fa612}});!_0x1afc79&&await database_1[_0x206748(0x13b)]['shopSettings'][_0x206748(0x14d)]({'data':{'shopId':_0x3fa612}});}}exports[a47_0x1c655a(0x142)]=IntegrationsService;