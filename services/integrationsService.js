'use strict';const a46_0x4e4ddf=a46_0xad8f;(function(_0x6179d0,_0xa10daa){const _0x5bfdce=a46_0xad8f,_0x5a7da3=_0x6179d0();while(!![]){try{const _0x388326=parseInt(_0x5bfdce(0x134))/0x1+-parseInt(_0x5bfdce(0x13b))/0x2+parseInt(_0x5bfdce(0x132))/0x3*(-parseInt(_0x5bfdce(0x12c))/0x4)+-parseInt(_0x5bfdce(0x12d))/0x5*(parseInt(_0x5bfdce(0x141))/0x6)+parseInt(_0x5bfdce(0x13a))/0x7*(-parseInt(_0x5bfdce(0x143))/0x8)+parseInt(_0x5bfdce(0x142))/0x9*(parseInt(_0x5bfdce(0x130))/0xa)+parseInt(_0x5bfdce(0x13e))/0xb*(parseInt(_0x5bfdce(0x12e))/0xc);if(_0x388326===_0xa10daa)break;else _0x5a7da3['push'](_0x5a7da3['shift']());}catch(_0x2fe0d8){_0x5a7da3['push'](_0x5a7da3['shift']());}}}(a46_0x56dd,0x1e780));var __importDefault=this&&this[a46_0x4e4ddf(0x12f)]||function(_0x36dae2){const _0x54a02d=a46_0x4e4ddf;return _0x36dae2&&_0x36dae2[_0x54a02d(0x139)]?_0x36dae2:{'default':_0x36dae2};};Object[a46_0x4e4ddf(0x12b)](exports,'__esModule',{'value':!![]}),exports[a46_0x4e4ddf(0x140)]=void 0x0;function a46_0x56dd(){const _0x283ef0=['36KjvDxT','__importDefault','1219100oJPCDi','ensureSettingsExist','2361rccqOx','webhookEvents','170862SuqwUt','shopSettings','../config/database','webhookUrl','default','__esModule','21wBDncy','317838MFbOvS','string','parseWebhookEvents','2100516uLMxlc','updateWebhookSettings','IntegrationsService','1431732VtzVvd','9xfrNHs','273272qtrDjN','getIntegrations','findUnique','parse','defineProperty','1224iKafZP','5mCYIoN'];a46_0x56dd=function(){return _0x283ef0;};return a46_0x56dd();}function a46_0xad8f(_0x451b4c,_0x41138b){const _0x56ddb2=a46_0x56dd();return a46_0xad8f=function(_0xad8f03,_0x514e2c){_0xad8f03=_0xad8f03-0x12b;let _0x31c0c1=_0x56ddb2[_0xad8f03];return _0x31c0c1;},a46_0xad8f(_0x451b4c,_0x41138b);}const database_1=__importDefault(require(a46_0x4e4ddf(0x136)));class IntegrationsService{[a46_0x4e4ddf(0x13d)](_0x3d255b){const _0x6d2aa4=a46_0x4e4ddf;if(!_0x3d255b)return[];if(Array['isArray'](_0x3d255b))return _0x3d255b;if(typeof _0x3d255b===_0x6d2aa4(0x13c))try{const _0x2472e5=JSON[_0x6d2aa4(0x146)](_0x3d255b);return Array['isArray'](_0x2472e5)?_0x2472e5:[];}catch{return[];}return[];}async[a46_0x4e4ddf(0x144)](_0x249b98){const _0x50910f=a46_0x4e4ddf;await this[_0x50910f(0x131)](_0x249b98);const _0x46db56=await database_1[_0x50910f(0x138)][_0x50910f(0x135)]['findUnique']({'where':{'shopId':_0x249b98},'select':{'webhookUrl':!![],'webhookEvents':!![]}});if(!_0x46db56)throw new Error('Shop\x20settings\x20not\x20found');return{'webhook':{'url':_0x46db56['webhookUrl'],'events':this[_0x50910f(0x13d)](_0x46db56[_0x50910f(0x133)])}};}async[a46_0x4e4ddf(0x13f)](_0x592f01,_0x480152){const _0x102544=a46_0x4e4ddf;await this[_0x102544(0x131)](_0x592f01);const _0x59c028={};_0x480152[_0x102544(0x137)]!==undefined&&(_0x59c028[_0x102544(0x137)]=_0x480152['webhookUrl']||null),_0x480152[_0x102544(0x133)]!==undefined&&(_0x59c028['webhookEvents']=_0x480152[_0x102544(0x133)]||[]),await database_1[_0x102544(0x138)][_0x102544(0x135)]['update']({'where':{'shopId':_0x592f01},'data':_0x59c028});}async['ensureSettingsExist'](_0x271885){const _0x566da6=a46_0x4e4ddf,_0x1aa78e=await database_1[_0x566da6(0x138)][_0x566da6(0x135)][_0x566da6(0x145)]({'where':{'shopId':_0x271885}});!_0x1aa78e&&await database_1['default'][_0x566da6(0x135)]['create']({'data':{'shopId':_0x271885}});}}exports[a46_0x4e4ddf(0x140)]=IntegrationsService;