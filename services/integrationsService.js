'use strict';const a47_0x2b8594=a47_0x17dc;(function(_0x583762,_0xb903b){const _0x218b48=a47_0x17dc,_0x19622e=_0x583762();while(!![]){try{const _0x432921=-parseInt(_0x218b48(0x1c9))/0x1+-parseInt(_0x218b48(0x1d1))/0x2+-parseInt(_0x218b48(0x1cb))/0x3*(parseInt(_0x218b48(0x1d3))/0x4)+-parseInt(_0x218b48(0x1ce))/0x5+-parseInt(_0x218b48(0x1cc))/0x6+parseInt(_0x218b48(0x1dc))/0x7*(-parseInt(_0x218b48(0x1c7))/0x8)+-parseInt(_0x218b48(0x1cf))/0x9*(-parseInt(_0x218b48(0x1c8))/0xa);if(_0x432921===_0xb903b)break;else _0x19622e['push'](_0x19622e['shift']());}catch(_0x2cdf64){_0x19622e['push'](_0x19622e['shift']());}}}(a47_0x39de,0xb8eb5));function a47_0x39de(){const _0x5f19ff=['10428677BuVNOC','update','webhookEvents','findUnique','8JTaaWY','2440vgGYRd','971689DbgIsU','ensureSettingsExist','119961ZebMoD','4243338ZtrUhQ','default','1363795OhHLzM','178785hhwPip','IntegrationsService','416584EiyMDg','parse','44vwggdX','defineProperty','isArray','__esModule','shopSettings','../config/database','Shop\x20settings\x20not\x20found','webhookUrl','parseWebhookEvents'];a47_0x39de=function(){return _0x5f19ff;};return a47_0x39de();}var __importDefault=this&&this['__importDefault']||function(_0x465bf6){const _0x1867da=a47_0x17dc;return _0x465bf6&&_0x465bf6[_0x1867da(0x1d6)]?_0x465bf6:{'default':_0x465bf6};};function a47_0x17dc(_0xa46361,_0x37c85c){const _0x39deb0=a47_0x39de();return a47_0x17dc=function(_0x17dc1b,_0x5535c5){_0x17dc1b=_0x17dc1b-0x1c5;let _0x11b302=_0x39deb0[_0x17dc1b];return _0x11b302;},a47_0x17dc(_0xa46361,_0x37c85c);}Object[a47_0x2b8594(0x1d4)](exports,'__esModule',{'value':!![]}),exports['IntegrationsService']=void 0x0;const database_1=__importDefault(require(a47_0x2b8594(0x1d8)));class IntegrationsService{[a47_0x2b8594(0x1db)](_0x3877bc){const _0x54b2bb=a47_0x2b8594;if(!_0x3877bc)return[];if(Array[_0x54b2bb(0x1d5)](_0x3877bc))return _0x3877bc;if(typeof _0x3877bc==='string')try{const _0x1fe39b=JSON[_0x54b2bb(0x1d2)](_0x3877bc);return Array['isArray'](_0x1fe39b)?_0x1fe39b:[];}catch{return[];}return[];}async['getIntegrations'](_0x106a92){const _0xce2f5=a47_0x2b8594;await this['ensureSettingsExist'](_0x106a92);const _0x3c9683=await database_1[_0xce2f5(0x1cd)][_0xce2f5(0x1d7)][_0xce2f5(0x1c6)]({'where':{'shopId':_0x106a92},'select':{'webhookUrl':!![],'webhookEvents':!![]}});if(!_0x3c9683)throw new Error(_0xce2f5(0x1d9));return{'webhook':{'url':_0x3c9683['webhookUrl'],'events':this[_0xce2f5(0x1db)](_0x3c9683[_0xce2f5(0x1c5)])}};}async['updateWebhookSettings'](_0x5d0726,_0x18e95e){const _0x512d28=a47_0x2b8594;await this[_0x512d28(0x1ca)](_0x5d0726);const _0x16a415={};_0x18e95e[_0x512d28(0x1da)]!==undefined&&(_0x16a415[_0x512d28(0x1da)]=_0x18e95e[_0x512d28(0x1da)]||null),_0x18e95e['webhookEvents']!==undefined&&(_0x16a415[_0x512d28(0x1c5)]=_0x18e95e[_0x512d28(0x1c5)]||[]),await database_1[_0x512d28(0x1cd)][_0x512d28(0x1d7)][_0x512d28(0x1dd)]({'where':{'shopId':_0x5d0726},'data':_0x16a415});}async[a47_0x2b8594(0x1ca)](_0x16e89b){const _0x2c1cd6=a47_0x2b8594,_0x1a8760=await database_1[_0x2c1cd6(0x1cd)]['shopSettings']['findUnique']({'where':{'shopId':_0x16e89b}});!_0x1a8760&&await database_1[_0x2c1cd6(0x1cd)][_0x2c1cd6(0x1d7)]['create']({'data':{'shopId':_0x16e89b}});}}exports[a47_0x2b8594(0x1d0)]=IntegrationsService;