'use strict';function a43_0xe052(_0x379edf,_0x583fa4){const _0x1374d7=a43_0x1374();return a43_0xe052=function(_0xe05239,_0x236f51){_0xe05239=_0xe05239-0x1f3;let _0x4df826=_0x1374d7[_0xe05239];return _0x4df826;},a43_0xe052(_0x379edf,_0x583fa4);}const a43_0x48ec59=a43_0xe052;(function(_0x44e909,_0x3b3096){const _0x17c1af=a43_0xe052,_0x5b7efd=_0x44e909();while(!![]){try{const _0x249611=-parseInt(_0x17c1af(0x207))/0x1*(-parseInt(_0x17c1af(0x206))/0x2)+-parseInt(_0x17c1af(0x1f7))/0x3+-parseInt(_0x17c1af(0x202))/0x4*(parseInt(_0x17c1af(0x1f8))/0x5)+parseInt(_0x17c1af(0x1f3))/0x6*(-parseInt(_0x17c1af(0x1fb))/0x7)+-parseInt(_0x17c1af(0x1f5))/0x8*(-parseInt(_0x17c1af(0x208))/0x9)+parseInt(_0x17c1af(0x1f9))/0xa+-parseInt(_0x17c1af(0x20b))/0xb*(-parseInt(_0x17c1af(0x1f4))/0xc);if(_0x249611===_0x3b3096)break;else _0x5b7efd['push'](_0x5b7efd['shift']());}catch(_0x3a97e8){_0x5b7efd['push'](_0x5b7efd['shift']());}}}(a43_0x1374,0xc3472));function a43_0x1374(){const _0x4cb2af=['13926GZqiDu','Shop\x20settings\x20not\x20found','IntegrationsService','59358DruimM','17280GyQhLA','74600ackcus','shopSettings','4145214AGLZsZ','5oiXQGJ','13179650jNRTjz','parse','819ieIDGY','ensureSettingsExist','__esModule','string','isArray','default','webhookEvents','4108464sJZQyU','parseWebhookEvents','getIntegrations','../config/database','3566oEHZxS','661SbgoAt','45rkaYmh','defineProperty','webhookUrl'];a43_0x1374=function(){return _0x4cb2af;};return a43_0x1374();}var __importDefault=this&&this['__importDefault']||function(_0x28f158){const _0x35a056=a43_0xe052;return _0x28f158&&_0x28f158[_0x35a056(0x1fd)]?_0x28f158:{'default':_0x28f158};};Object[a43_0x48ec59(0x209)](exports,a43_0x48ec59(0x1fd),{'value':!![]}),exports[a43_0x48ec59(0x20d)]=void 0x0;const database_1=__importDefault(require(a43_0x48ec59(0x205)));class IntegrationsService{[a43_0x48ec59(0x203)](_0x18f1eb){const _0x1c07d9=a43_0x48ec59;if(!_0x18f1eb)return[];if(Array['isArray'](_0x18f1eb))return _0x18f1eb;if(typeof _0x18f1eb===_0x1c07d9(0x1fe))try{const _0xb6920f=JSON[_0x1c07d9(0x1fa)](_0x18f1eb);return Array[_0x1c07d9(0x1ff)](_0xb6920f)?_0xb6920f:[];}catch{return[];}return[];}async[a43_0x48ec59(0x204)](_0x103f06){const _0x5c0729=a43_0x48ec59;await this[_0x5c0729(0x1fc)](_0x103f06);const _0x50a5ec=await database_1['default'][_0x5c0729(0x1f6)]['findUnique']({'where':{'shopId':_0x103f06},'select':{'webhookUrl':!![],'webhookEvents':!![]}});if(!_0x50a5ec)throw new Error(_0x5c0729(0x20c));return{'webhook':{'url':_0x50a5ec[_0x5c0729(0x20a)],'events':this[_0x5c0729(0x203)](_0x50a5ec['webhookEvents'])}};}async['updateWebhookSettings'](_0x148e98,_0xcde480){const _0x418635=a43_0x48ec59;await this['ensureSettingsExist'](_0x148e98);const _0x31b6f6={};_0xcde480[_0x418635(0x20a)]!==undefined&&(_0x31b6f6[_0x418635(0x20a)]=_0xcde480[_0x418635(0x20a)]||null),_0xcde480[_0x418635(0x201)]!==undefined&&(_0x31b6f6[_0x418635(0x201)]=_0xcde480[_0x418635(0x201)]||[]),await database_1[_0x418635(0x200)][_0x418635(0x1f6)]['update']({'where':{'shopId':_0x148e98},'data':_0x31b6f6});}async['ensureSettingsExist'](_0x53ac0a){const _0x5ab6f9=a43_0x48ec59,_0x153d22=await database_1[_0x5ab6f9(0x200)][_0x5ab6f9(0x1f6)]['findUnique']({'where':{'shopId':_0x53ac0a}});!_0x153d22&&await database_1[_0x5ab6f9(0x200)][_0x5ab6f9(0x1f6)]['create']({'data':{'shopId':_0x53ac0a}});}}exports[a43_0x48ec59(0x20d)]=IntegrationsService;