'use strict';const a43_0x295099=a43_0x4fb1;(function(_0xca65f4,_0x30c353){const _0xb6e466=a43_0x4fb1,_0x3397c8=_0xca65f4();while(!![]){try{const _0x292697=parseInt(_0xb6e466(0x1be))/0x1*(-parseInt(_0xb6e466(0x1bf))/0x2)+-parseInt(_0xb6e466(0x1ae))/0x3+parseInt(_0xb6e466(0x1b9))/0x4+parseInt(_0xb6e466(0x1b0))/0x5+parseInt(_0xb6e466(0x1b3))/0x6+parseInt(_0xb6e466(0x1b7))/0x7+parseInt(_0xb6e466(0x1b1))/0x8;if(_0x292697===_0x30c353)break;else _0x3397c8['push'](_0x3397c8['shift']());}catch(_0x4f8cee){_0x3397c8['push'](_0x3397c8['shift']());}}}(a43_0x3030,0xd108e));function a43_0x4fb1(_0x94cf69,_0x275f4b){const _0x303041=a43_0x3030();return a43_0x4fb1=function(_0x4fb16c,_0x5107b5){_0x4fb16c=_0x4fb16c-0x1ab;let _0x339666=_0x303041[_0x4fb16c];return _0x339666;},a43_0x4fb1(_0x94cf69,_0x275f4b);}var __importDefault=this&&this['__importDefault']||function(_0xa951ed){const _0x11fea6=a43_0x4fb1;return _0xa951ed&&_0xa951ed[_0x11fea6(0x1b5)]?_0xa951ed:{'default':_0xa951ed};};function a43_0x3030(){const _0x267f71=['ensureSettingsExist','webhookUrl','3998091FmWVwx','updateWebhookSettings','3278745gZAwOf','13567168WCBtMJ','isArray','3133260whVWdy','shopSettings','__esModule','default','870898onpwSz','parse','2109264UIHGFI','parseWebhookEvents','defineProperty','../config/database','webhookEvents','668341oEaNNX','4fyEAOQ','findUnique','string'];a43_0x3030=function(){return _0x267f71;};return a43_0x3030();}Object[a43_0x295099(0x1bb)](exports,a43_0x295099(0x1b5),{'value':!![]}),exports['IntegrationsService']=void 0x0;const database_1=__importDefault(require(a43_0x295099(0x1bc)));class IntegrationsService{[a43_0x295099(0x1ba)](_0x4744b1){const _0x46ca50=a43_0x295099;if(!_0x4744b1)return[];if(Array[_0x46ca50(0x1b2)](_0x4744b1))return _0x4744b1;if(typeof _0x4744b1===_0x46ca50(0x1ab))try{const _0x4fe0e7=JSON[_0x46ca50(0x1b8)](_0x4744b1);return Array[_0x46ca50(0x1b2)](_0x4fe0e7)?_0x4fe0e7:[];}catch{return[];}return[];}async['getIntegrations'](_0x4f4a9d){const _0x15d2c6=a43_0x295099;await this[_0x15d2c6(0x1ac)](_0x4f4a9d);const _0x4560c7=await database_1[_0x15d2c6(0x1b6)]['shopSettings'][_0x15d2c6(0x1c0)]({'where':{'shopId':_0x4f4a9d},'select':{'webhookUrl':!![],'webhookEvents':!![]}});if(!_0x4560c7)throw new Error('Shop\x20settings\x20not\x20found');return{'webhook':{'url':_0x4560c7['webhookUrl'],'events':this[_0x15d2c6(0x1ba)](_0x4560c7[_0x15d2c6(0x1bd)])}};}async[a43_0x295099(0x1af)](_0x5ccff9,_0x5cc7fb){const _0x37fd34=a43_0x295099;await this[_0x37fd34(0x1ac)](_0x5ccff9);const _0x47ecc0={};_0x5cc7fb[_0x37fd34(0x1ad)]!==undefined&&(_0x47ecc0[_0x37fd34(0x1ad)]=_0x5cc7fb[_0x37fd34(0x1ad)]||null),_0x5cc7fb['webhookEvents']!==undefined&&(_0x47ecc0['webhookEvents']=_0x5cc7fb[_0x37fd34(0x1bd)]||[]),await database_1[_0x37fd34(0x1b6)][_0x37fd34(0x1b4)]['update']({'where':{'shopId':_0x5ccff9},'data':_0x47ecc0});}async[a43_0x295099(0x1ac)](_0x16514e){const _0x171de4=a43_0x295099,_0x442035=await database_1[_0x171de4(0x1b6)]['shopSettings'][_0x171de4(0x1c0)]({'where':{'shopId':_0x16514e}});!_0x442035&&await database_1[_0x171de4(0x1b6)][_0x171de4(0x1b4)]['create']({'data':{'shopId':_0x16514e}});}}exports['IntegrationsService']=IntegrationsService;