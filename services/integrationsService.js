'use strict';function a58_0xd6c1(_0x2f72dd,_0x6d80c9){const _0x4603c0=a58_0x4603();return a58_0xd6c1=function(_0xd6c1aa,_0x3256bb){_0xd6c1aa=_0xd6c1aa-0x185;let _0x383ff0=_0x4603c0[_0xd6c1aa];return _0x383ff0;},a58_0xd6c1(_0x2f72dd,_0x6d80c9);}const a58_0x50bd24=a58_0xd6c1;(function(_0x42baa7,_0x30853a){const _0xbeef29=a58_0xd6c1,_0x12a954=_0x42baa7();while(!![]){try{const _0x3f8f61=-parseInt(_0xbeef29(0x19c))/0x1+-parseInt(_0xbeef29(0x18c))/0x2+-parseInt(_0xbeef29(0x189))/0x3+parseInt(_0xbeef29(0x195))/0x4*(-parseInt(_0xbeef29(0x185))/0x5)+-parseInt(_0xbeef29(0x18f))/0x6*(-parseInt(_0xbeef29(0x191))/0x7)+-parseInt(_0xbeef29(0x186))/0x8*(parseInt(_0xbeef29(0x193))/0x9)+parseInt(_0xbeef29(0x18e))/0xa*(parseInt(_0xbeef29(0x18d))/0xb);if(_0x3f8f61===_0x30853a)break;else _0x12a954['push'](_0x12a954['shift']());}catch(_0xb8d70){_0x12a954['push'](_0x12a954['shift']());}}}(a58_0x4603,0x2e232));function a58_0x4603(){const _0x4ba934=['2951020ntTwsZ','6kAZsIf','updateWebhookSettings','331667BwaVLk','isArray','1393641xAuNKk','webhookEvents','4dcqRfk','parse','webhookUrl','ensureSettingsExist','string','getIntegrations','__esModule','20190JPMTxg','IntegrationsService','../config/database','1810355BVKgnl','8TKPeYp','update','default','82818EeRlko','create','shopSettings','357986ecrmCY','33aEFHVm'];a58_0x4603=function(){return _0x4ba934;};return a58_0x4603();}var __importDefault=this&&this['__importDefault']||function(_0x284885){const _0x490b39=a58_0xd6c1;return _0x284885&&_0x284885[_0x490b39(0x19b)]?_0x284885:{'default':_0x284885};};Object['defineProperty'](exports,a58_0x50bd24(0x19b),{'value':!![]}),exports[a58_0x50bd24(0x19d)]=void 0x0;const database_1=__importDefault(require(a58_0x50bd24(0x19e)));class IntegrationsService{['parseWebhookEvents'](_0x5f2bed){const _0x10008c=a58_0x50bd24;if(!_0x5f2bed)return[];if(Array[_0x10008c(0x192)](_0x5f2bed))return _0x5f2bed;if(typeof _0x5f2bed===_0x10008c(0x199))try{const _0x13e3c9=JSON[_0x10008c(0x196)](_0x5f2bed);return Array[_0x10008c(0x192)](_0x13e3c9)?_0x13e3c9:[];}catch{return[];}return[];}async[a58_0x50bd24(0x19a)](_0x5bba26){const _0x37babf=a58_0x50bd24;await this[_0x37babf(0x198)](_0x5bba26);const _0xd5ba2f=await database_1[_0x37babf(0x188)][_0x37babf(0x18b)]['findUnique']({'where':{'shopId':_0x5bba26},'select':{'webhookUrl':!![],'webhookEvents':!![]}});if(!_0xd5ba2f)throw new Error('Shop\x20settings\x20not\x20found');return{'webhook':{'url':_0xd5ba2f[_0x37babf(0x197)],'events':this['parseWebhookEvents'](_0xd5ba2f[_0x37babf(0x194)])}};}async[a58_0x50bd24(0x190)](_0x2ed785,_0x50df18){const _0x55f74f=a58_0x50bd24;await this['ensureSettingsExist'](_0x2ed785);const _0x5e101c={};_0x50df18[_0x55f74f(0x197)]!==undefined&&(_0x5e101c[_0x55f74f(0x197)]=_0x50df18['webhookUrl']||null),_0x50df18['webhookEvents']!==undefined&&(_0x5e101c['webhookEvents']=_0x50df18[_0x55f74f(0x194)]||[]),await database_1['default'][_0x55f74f(0x18b)][_0x55f74f(0x187)]({'where':{'shopId':_0x2ed785},'data':_0x5e101c});}async[a58_0x50bd24(0x198)](_0x5d5164){const _0x136520=a58_0x50bd24,_0x3d6b5c=await database_1[_0x136520(0x188)][_0x136520(0x18b)]['findUnique']({'where':{'shopId':_0x5d5164}});!_0x3d6b5c&&await database_1[_0x136520(0x188)][_0x136520(0x18b)][_0x136520(0x18a)]({'data':{'shopId':_0x5d5164}});}}exports[a58_0x50bd24(0x19d)]=IntegrationsService;