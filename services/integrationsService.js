'use strict';function a52_0x450d(){const _0x42f1e2=['ensureSettingsExist','424840FTjckX','522lgVPDR','3shRsQD','isArray','string','webhookEvents','shopSettings','default','create','defineProperty','getIntegrations','updateWebhookSettings','__esModule','webhookUrl','15219112edjuvT','718545NYlsGz','parse','1490098bmsNbi','../config/database','591108iQlKbd','30McSmjA','__importDefault','3064908bPgpag','findUnique','parseWebhookEvents','3542220OPIXly'];a52_0x450d=function(){return _0x42f1e2;};return a52_0x450d();}const a52_0x212306=a52_0x9711;(function(_0x15a327,_0x188024){const _0x5c7b84=a52_0x9711,_0x35c121=_0x15a327();while(!![]){try{const _0x2c482b=-parseInt(_0x5c7b84(0xdc))/0x1+parseInt(_0x5c7b84(0xc9))/0x2+-parseInt(_0x5c7b84(0xcd))/0x3*(-parseInt(_0x5c7b84(0xe1))/0x4)+-parseInt(_0x5c7b84(0xda))/0x5*(parseInt(_0x5c7b84(0xdf))/0x6)+parseInt(_0x5c7b84(0xde))/0x7+-parseInt(_0x5c7b84(0xd9))/0x8+parseInt(_0x5c7b84(0xcc))/0x9*(parseInt(_0x5c7b84(0xcb))/0xa);if(_0x2c482b===_0x188024)break;else _0x35c121['push'](_0x35c121['shift']());}catch(_0x3715e2){_0x35c121['push'](_0x35c121['shift']());}}}(a52_0x450d,0xedfe5));var __importDefault=this&&this[a52_0x212306(0xe0)]||function(_0x3dbcd4){const _0x3b1d85=a52_0x212306;return _0x3dbcd4&&_0x3dbcd4[_0x3b1d85(0xd7)]?_0x3dbcd4:{'default':_0x3dbcd4};};Object[a52_0x212306(0xd4)](exports,a52_0x212306(0xd7),{'value':!![]}),exports['IntegrationsService']=void 0x0;const database_1=__importDefault(require(a52_0x212306(0xdd)));function a52_0x9711(_0x2dbfb1,_0x1639a6){const _0x450d4a=a52_0x450d();return a52_0x9711=function(_0x9711ca,_0x547e85){_0x9711ca=_0x9711ca-0xc9;let _0x238b46=_0x450d4a[_0x9711ca];return _0x238b46;},a52_0x9711(_0x2dbfb1,_0x1639a6);}class IntegrationsService{[a52_0x212306(0xe3)](_0x3633e0){const _0x20d3c6=a52_0x212306;if(!_0x3633e0)return[];if(Array['isArray'](_0x3633e0))return _0x3633e0;if(typeof _0x3633e0===_0x20d3c6(0xcf))try{const _0x597369=JSON[_0x20d3c6(0xdb)](_0x3633e0);return Array[_0x20d3c6(0xce)](_0x597369)?_0x597369:[];}catch{return[];}return[];}async[a52_0x212306(0xd5)](_0xf3b156){const _0x31673b=a52_0x212306;await this[_0x31673b(0xca)](_0xf3b156);const _0x1ec7bf=await database_1[_0x31673b(0xd2)][_0x31673b(0xd1)][_0x31673b(0xe2)]({'where':{'shopId':_0xf3b156},'select':{'webhookUrl':!![],'webhookEvents':!![]}});if(!_0x1ec7bf)throw new Error('Shop\x20settings\x20not\x20found');return{'webhook':{'url':_0x1ec7bf['webhookUrl'],'events':this['parseWebhookEvents'](_0x1ec7bf[_0x31673b(0xd0)])}};}async[a52_0x212306(0xd6)](_0x2add97,_0x36b312){const _0x40f3f3=a52_0x212306;await this['ensureSettingsExist'](_0x2add97);const _0x24aa3a={};_0x36b312[_0x40f3f3(0xd8)]!==undefined&&(_0x24aa3a[_0x40f3f3(0xd8)]=_0x36b312[_0x40f3f3(0xd8)]||null),_0x36b312[_0x40f3f3(0xd0)]!==undefined&&(_0x24aa3a['webhookEvents']=_0x36b312[_0x40f3f3(0xd0)]||[]),await database_1[_0x40f3f3(0xd2)]['shopSettings']['update']({'where':{'shopId':_0x2add97},'data':_0x24aa3a});}async['ensureSettingsExist'](_0x4d48a7){const _0x348ff6=a52_0x212306,_0x167c92=await database_1[_0x348ff6(0xd2)]['shopSettings'][_0x348ff6(0xe2)]({'where':{'shopId':_0x4d48a7}});!_0x167c92&&await database_1[_0x348ff6(0xd2)][_0x348ff6(0xd1)][_0x348ff6(0xd3)]({'data':{'shopId':_0x4d48a7}});}}exports['IntegrationsService']=IntegrationsService;