'use strict';const a48_0x137345=a48_0x5aa4;function a48_0x2167(){const _0x4363ed=['parse','updateWebhookSettings','webhookUrl','isArray','Shop\x20settings\x20not\x20found','ensureSettingsExist','__esModule','3253452KOYHcq','1242716rOchCQ','create','findUnique','parseWebhookEvents','defineProperty','string','2606838YlWnxO','28erGzkA','__importDefault','shopSettings','380155AEZswT','14042960SSBIKE','../config/database','IntegrationsService','default','1645126HIRFFD','webhookEvents','getIntegrations','544339JYAQYS'];a48_0x2167=function(){return _0x4363ed;};return a48_0x2167();}(function(_0x4aba54,_0x4a7bbf){const _0xb29398=a48_0x5aa4,_0x23aee9=_0x4aba54();while(!![]){try{const _0x356a58=parseInt(_0xb29398(0x1ca))/0x1+parseInt(_0xb29398(0x1b8))/0x2+parseInt(_0xb29398(0x1be))/0x3+-parseInt(_0xb29398(0x1bf))/0x4*(-parseInt(_0xb29398(0x1c2))/0x5)+-parseInt(_0xb29398(0x1d2))/0x6+parseInt(_0xb29398(0x1c7))/0x7+-parseInt(_0xb29398(0x1c3))/0x8;if(_0x356a58===_0x4a7bbf)break;else _0x23aee9['push'](_0x23aee9['shift']());}catch(_0x5e5115){_0x23aee9['push'](_0x23aee9['shift']());}}}(a48_0x2167,0x7b1ca));var __importDefault=this&&this[a48_0x137345(0x1c0)]||function(_0x2ecbf1){const _0x2642bb=a48_0x137345;return _0x2ecbf1&&_0x2ecbf1[_0x2642bb(0x1d1)]?_0x2ecbf1:{'default':_0x2ecbf1};};Object[a48_0x137345(0x1bc)](exports,a48_0x137345(0x1d1),{'value':!![]}),exports[a48_0x137345(0x1c5)]=void 0x0;const database_1=__importDefault(require(a48_0x137345(0x1c4)));function a48_0x5aa4(_0x4f0b82,_0x27148b){const _0x2167ae=a48_0x2167();return a48_0x5aa4=function(_0x5aa4ff,_0x13af85){_0x5aa4ff=_0x5aa4ff-0x1b8;let _0x2cb450=_0x2167ae[_0x5aa4ff];return _0x2cb450;},a48_0x5aa4(_0x4f0b82,_0x27148b);}class IntegrationsService{[a48_0x137345(0x1bb)](_0x68c0b2){const _0x561b74=a48_0x137345;if(!_0x68c0b2)return[];if(Array[_0x561b74(0x1ce)](_0x68c0b2))return _0x68c0b2;if(typeof _0x68c0b2===_0x561b74(0x1bd))try{const _0x4c8e07=JSON[_0x561b74(0x1cb)](_0x68c0b2);return Array[_0x561b74(0x1ce)](_0x4c8e07)?_0x4c8e07:[];}catch{return[];}return[];}async[a48_0x137345(0x1c9)](_0x71037f){const _0x111e9f=a48_0x137345;await this[_0x111e9f(0x1d0)](_0x71037f);const _0x450caa=await database_1[_0x111e9f(0x1c6)]['shopSettings'][_0x111e9f(0x1ba)]({'where':{'shopId':_0x71037f},'select':{'webhookUrl':!![],'webhookEvents':!![]}});if(!_0x450caa)throw new Error(_0x111e9f(0x1cf));return{'webhook':{'url':_0x450caa[_0x111e9f(0x1cd)],'events':this[_0x111e9f(0x1bb)](_0x450caa[_0x111e9f(0x1c8)])}};}async[a48_0x137345(0x1cc)](_0x101a1c,_0x1054ba){const _0x42e980=a48_0x137345;await this[_0x42e980(0x1d0)](_0x101a1c);const _0x36bc50={};_0x1054ba[_0x42e980(0x1cd)]!==undefined&&(_0x36bc50[_0x42e980(0x1cd)]=_0x1054ba['webhookUrl']||null),_0x1054ba[_0x42e980(0x1c8)]!==undefined&&(_0x36bc50[_0x42e980(0x1c8)]=_0x1054ba[_0x42e980(0x1c8)]||[]),await database_1['default'][_0x42e980(0x1c1)]['update']({'where':{'shopId':_0x101a1c},'data':_0x36bc50});}async[a48_0x137345(0x1d0)](_0x4cec8a){const _0x39b282=a48_0x137345,_0x5e4462=await database_1[_0x39b282(0x1c6)][_0x39b282(0x1c1)][_0x39b282(0x1ba)]({'where':{'shopId':_0x4cec8a}});!_0x5e4462&&await database_1['default']['shopSettings'][_0x39b282(0x1b9)]({'data':{'shopId':_0x4cec8a}});}}exports[a48_0x137345(0x1c5)]=IntegrationsService;