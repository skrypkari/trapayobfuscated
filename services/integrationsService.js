'use strict';function a58_0x1df1(){const _0x40f8cc=['default','122533renQkv','ensureSettingsExist','../config/database','3270387FJnPmd','IntegrationsService','defineProperty','shopSettings','866575vyVdlV','8UdQQlW','parse','5943672djespL','20IWlhLJ','isArray','parseWebhookEvents','28eTfqzF','string','1923273gHYqZi','__importDefault','webhookUrl','updateWebhookSettings','update','webhookEvents','43882610MTNuaJ','5041644OExDEg','getIntegrations'];a58_0x1df1=function(){return _0x40f8cc;};return a58_0x1df1();}const a58_0x2a7892=a58_0x1b35;(function(_0x1205c7,_0xf898fc){const _0x51c39d=a58_0x1b35,_0x55fe44=_0x1205c7();while(!![]){try{const _0x2dde2d=parseInt(_0x51c39d(0x1dd))/0x1*(-parseInt(_0x51c39d(0x1d1))/0x2)+-parseInt(_0x51c39d(0x1c6))/0x3+parseInt(_0x51c39d(0x1ce))/0x4*(parseInt(_0x51c39d(0x1ca))/0x5)+-parseInt(_0x51c39d(0x1da))/0x6+parseInt(_0x51c39d(0x1cd))/0x7*(-parseInt(_0x51c39d(0x1cb))/0x8)+parseInt(_0x51c39d(0x1d3))/0x9+parseInt(_0x51c39d(0x1d9))/0xa;if(_0x2dde2d===_0xf898fc)break;else _0x55fe44['push'](_0x55fe44['shift']());}catch(_0x1a97ce){_0x55fe44['push'](_0x55fe44['shift']());}}}(a58_0x1df1,0xedb04));var __importDefault=this&&this[a58_0x2a7892(0x1d4)]||function(_0x454ca3){return _0x454ca3&&_0x454ca3['__esModule']?_0x454ca3:{'default':_0x454ca3};};function a58_0x1b35(_0x1d00a1,_0x21f489){const _0x1df182=a58_0x1df1();return a58_0x1b35=function(_0x1b350e,_0x1d7ec0){_0x1b350e=_0x1b350e-0x1c4;let _0x189125=_0x1df182[_0x1b350e];return _0x189125;},a58_0x1b35(_0x1d00a1,_0x21f489);}Object[a58_0x2a7892(0x1c8)](exports,'__esModule',{'value':!![]}),exports[a58_0x2a7892(0x1c7)]=void 0x0;const database_1=__importDefault(require(a58_0x2a7892(0x1c5)));class IntegrationsService{[a58_0x2a7892(0x1d0)](_0x107407){const _0xf3922=a58_0x2a7892;if(!_0x107407)return[];if(Array[_0xf3922(0x1cf)](_0x107407))return _0x107407;if(typeof _0x107407===_0xf3922(0x1d2))try{const _0x3a734e=JSON[_0xf3922(0x1cc)](_0x107407);return Array['isArray'](_0x3a734e)?_0x3a734e:[];}catch{return[];}return[];}async[a58_0x2a7892(0x1db)](_0x116a28){const _0x23e116=a58_0x2a7892;await this['ensureSettingsExist'](_0x116a28);const _0x3bf77f=await database_1['default'][_0x23e116(0x1c9)]['findUnique']({'where':{'shopId':_0x116a28},'select':{'webhookUrl':!![],'webhookEvents':!![]}});if(!_0x3bf77f)throw new Error('Shop\x20settings\x20not\x20found');return{'webhook':{'url':_0x3bf77f[_0x23e116(0x1d5)],'events':this[_0x23e116(0x1d0)](_0x3bf77f[_0x23e116(0x1d8)])}};}async[a58_0x2a7892(0x1d6)](_0x44d479,_0x332ed4){const _0x499f66=a58_0x2a7892;await this[_0x499f66(0x1c4)](_0x44d479);const _0x22dd0b={};_0x332ed4['webhookUrl']!==undefined&&(_0x22dd0b['webhookUrl']=_0x332ed4[_0x499f66(0x1d5)]||null),_0x332ed4['webhookEvents']!==undefined&&(_0x22dd0b[_0x499f66(0x1d8)]=_0x332ed4[_0x499f66(0x1d8)]||[]),await database_1[_0x499f66(0x1dc)][_0x499f66(0x1c9)][_0x499f66(0x1d7)]({'where':{'shopId':_0x44d479},'data':_0x22dd0b});}async[a58_0x2a7892(0x1c4)](_0x3d302b){const _0x1dee08=a58_0x2a7892,_0x228d55=await database_1[_0x1dee08(0x1dc)]['shopSettings']['findUnique']({'where':{'shopId':_0x3d302b}});!_0x228d55&&await database_1[_0x1dee08(0x1dc)][_0x1dee08(0x1c9)]['create']({'data':{'shopId':_0x3d302b}});}}exports[a58_0x2a7892(0x1c7)]=IntegrationsService;