'use strict';const a78_0x2af7a5=a78_0x4ff3;(function(_0x560047,_0x440a12){const _0x526614=a78_0x4ff3,_0x1fa001=_0x560047();while(!![]){try{const _0x445009=parseInt(_0x526614(0x197))/0x1+-parseInt(_0x526614(0x196))/0x2+parseInt(_0x526614(0x193))/0x3*(-parseInt(_0x526614(0x191))/0x4)+parseInt(_0x526614(0x19b))/0x5*(-parseInt(_0x526614(0x1ac))/0x6)+parseInt(_0x526614(0x1a0))/0x7*(parseInt(_0x526614(0x19c))/0x8)+-parseInt(_0x526614(0x1aa))/0x9*(-parseInt(_0x526614(0x1a2))/0xa)+parseInt(_0x526614(0x19d))/0xb*(parseInt(_0x526614(0x1a3))/0xc);if(_0x445009===_0x440a12)break;else _0x1fa001['push'](_0x1fa001['shift']());}catch(_0x280870){_0x1fa001['push'](_0x1fa001['shift']());}}}(a78_0x42e4,0xc5baf));function a78_0x42e4(){const _0x464cee=['272kShwAt','ensureSettingsExist','22587docxCe','webhookEvents','default','1274332OXsVKS','166257opJgNN','IntegrationsService','create','shopSettings','280qDVGyK','816152BuvGbd','22NVpkGo','string','Shop\x20settings\x20not\x20found','91zLrKyF','findUnique','18410itxmJC','743448NrNPPj','getIntegrations','__esModule','updateWebhookSettings','__importDefault','parse','parseWebhookEvents','5877JojbiM','webhookUrl','92094BbepMx','update','defineProperty'];a78_0x42e4=function(){return _0x464cee;};return a78_0x42e4();}function a78_0x4ff3(_0x3dce65,_0x54e076){_0x3dce65=_0x3dce65-0x18f;const _0x42e4f3=a78_0x42e4();let _0x4ff3af=_0x42e4f3[_0x3dce65];return _0x4ff3af;}var __importDefault=this&&this[a78_0x2af7a5(0x1a7)]||function(_0x534188){return _0x534188&&_0x534188['__esModule']?_0x534188:{'default':_0x534188};};Object[a78_0x2af7a5(0x190)](exports,a78_0x2af7a5(0x1a5),{'value':!![]}),exports[a78_0x2af7a5(0x198)]=void 0x0;const database_1=__importDefault(require('../config/database'));class IntegrationsService{[a78_0x2af7a5(0x1a9)](_0x4fd617){const _0x689ba2=a78_0x2af7a5;if(!_0x4fd617)return[];if(Array['isArray'](_0x4fd617))return _0x4fd617;if(typeof _0x4fd617===_0x689ba2(0x19e))try{const _0x203052=JSON[_0x689ba2(0x1a8)](_0x4fd617);return Array['isArray'](_0x203052)?_0x203052:[];}catch{return[];}return[];}async[a78_0x2af7a5(0x1a4)](_0x56b988){const _0x5dc501=a78_0x2af7a5;await this['ensureSettingsExist'](_0x56b988);const _0x3fa3ae=await database_1[_0x5dc501(0x195)][_0x5dc501(0x19a)][_0x5dc501(0x1a1)]({'where':{'shopId':_0x56b988},'select':{'webhookUrl':!![],'webhookEvents':!![]}});if(!_0x3fa3ae)throw new Error(_0x5dc501(0x19f));return{'webhook':{'url':_0x3fa3ae['webhookUrl'],'events':this[_0x5dc501(0x1a9)](_0x3fa3ae[_0x5dc501(0x194)])}};}async[a78_0x2af7a5(0x1a6)](_0x15b54b,_0x3a7054){const _0x29ccd6=a78_0x2af7a5;await this[_0x29ccd6(0x192)](_0x15b54b);const _0x28e826={};_0x3a7054[_0x29ccd6(0x1ab)]!==undefined&&(_0x28e826[_0x29ccd6(0x1ab)]=_0x3a7054[_0x29ccd6(0x1ab)]||null),_0x3a7054[_0x29ccd6(0x194)]!==undefined&&(_0x28e826['webhookEvents']=_0x3a7054[_0x29ccd6(0x194)]||[]),await database_1[_0x29ccd6(0x195)][_0x29ccd6(0x19a)][_0x29ccd6(0x18f)]({'where':{'shopId':_0x15b54b},'data':_0x28e826});}async[a78_0x2af7a5(0x192)](_0x2593ee){const _0x1220af=a78_0x2af7a5,_0x3af343=await database_1[_0x1220af(0x195)][_0x1220af(0x19a)]['findUnique']({'where':{'shopId':_0x2593ee}});!_0x3af343&&await database_1[_0x1220af(0x195)]['shopSettings'][_0x1220af(0x199)]({'data':{'shopId':_0x2593ee}});}}exports[a78_0x2af7a5(0x198)]=IntegrationsService;