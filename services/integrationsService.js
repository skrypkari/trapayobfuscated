'use strict';const a47_0x24434e=a47_0x4649;(function(_0x50c392,_0x39b6ea){const _0x571b0e=a47_0x4649,_0x11ff93=_0x50c392();while(!![]){try{const _0x34c8fb=-parseInt(_0x571b0e(0x84))/0x1*(-parseInt(_0x571b0e(0x83))/0x2)+-parseInt(_0x571b0e(0x9d))/0x3+parseInt(_0x571b0e(0x99))/0x4*(-parseInt(_0x571b0e(0x88))/0x5)+parseInt(_0x571b0e(0x91))/0x6*(parseInt(_0x571b0e(0x87))/0x7)+-parseInt(_0x571b0e(0x97))/0x8+-parseInt(_0x571b0e(0x90))/0x9*(-parseInt(_0x571b0e(0x92))/0xa)+parseInt(_0x571b0e(0x9e))/0xb*(parseInt(_0x571b0e(0x85))/0xc);if(_0x34c8fb===_0x39b6ea)break;else _0x11ff93['push'](_0x11ff93['shift']());}catch(_0x65abfc){_0x11ff93['push'](_0x11ff93['shift']());}}}(a47_0x1d1c,0x9849d));var __importDefault=this&&this['__importDefault']||function(_0x1beacf){const _0x341d36=a47_0x4649;return _0x1beacf&&_0x1beacf[_0x341d36(0x9f)]?_0x1beacf:{'default':_0x1beacf};};Object[a47_0x24434e(0x93)](exports,a47_0x24434e(0x9f),{'value':!![]}),exports['IntegrationsService']=void 0x0;function a47_0x4649(_0x50f13a,_0x5b5c4e){const _0x1d1cea=a47_0x1d1c();return a47_0x4649=function(_0x4649ca,_0x30c943){_0x4649ca=_0x4649ca-0x83;let _0x4cc2a9=_0x1d1cea[_0x4649ca];return _0x4cc2a9;},a47_0x4649(_0x50f13a,_0x5b5c4e);}function a47_0x1d1c(){const _0x187708=['../config/database','1637199KqZRBg','18089731JjMSLB','__esModule','431966qjqvyP','3VeRrWq','12nGQCzn','shopSettings','90979omIRcX','1316245gXiQRA','getIntegrations','update','isArray','parseWebhookEvents','webhookEvents','ensureSettingsExist','webhookUrl','9rleIEc','18JPzAKy','6828580bjSAOF','defineProperty','Shop\x20settings\x20not\x20found','parse','create','8440528dcFQwP','default','12ENDDEZ','IntegrationsService','findUnique'];a47_0x1d1c=function(){return _0x187708;};return a47_0x1d1c();}const database_1=__importDefault(require(a47_0x24434e(0x9c)));class IntegrationsService{[a47_0x24434e(0x8c)](_0x2c2bb7){const _0x55ab82=a47_0x24434e;if(!_0x2c2bb7)return[];if(Array[_0x55ab82(0x8b)](_0x2c2bb7))return _0x2c2bb7;if(typeof _0x2c2bb7==='string')try{const _0x3518b0=JSON[_0x55ab82(0x95)](_0x2c2bb7);return Array[_0x55ab82(0x8b)](_0x3518b0)?_0x3518b0:[];}catch{return[];}return[];}async[a47_0x24434e(0x89)](_0x2d6640){const _0x2e080a=a47_0x24434e;await this[_0x2e080a(0x8e)](_0x2d6640);const _0x23e9cc=await database_1['default']['shopSettings'][_0x2e080a(0x9b)]({'where':{'shopId':_0x2d6640},'select':{'webhookUrl':!![],'webhookEvents':!![]}});if(!_0x23e9cc)throw new Error(_0x2e080a(0x94));return{'webhook':{'url':_0x23e9cc[_0x2e080a(0x8f)],'events':this[_0x2e080a(0x8c)](_0x23e9cc[_0x2e080a(0x8d)])}};}async['updateWebhookSettings'](_0x1a3ca4,_0x4d2080){const _0x49b1a3=a47_0x24434e;await this[_0x49b1a3(0x8e)](_0x1a3ca4);const _0x139042={};_0x4d2080[_0x49b1a3(0x8f)]!==undefined&&(_0x139042[_0x49b1a3(0x8f)]=_0x4d2080[_0x49b1a3(0x8f)]||null),_0x4d2080[_0x49b1a3(0x8d)]!==undefined&&(_0x139042[_0x49b1a3(0x8d)]=_0x4d2080['webhookEvents']||[]),await database_1[_0x49b1a3(0x98)][_0x49b1a3(0x86)][_0x49b1a3(0x8a)]({'where':{'shopId':_0x1a3ca4},'data':_0x139042});}async[a47_0x24434e(0x8e)](_0x1c8636){const _0x56f249=a47_0x24434e,_0x428f56=await database_1['default'][_0x56f249(0x86)][_0x56f249(0x9b)]({'where':{'shopId':_0x1c8636}});!_0x428f56&&await database_1[_0x56f249(0x98)][_0x56f249(0x86)][_0x56f249(0x96)]({'data':{'shopId':_0x1c8636}});}}exports[a47_0x24434e(0x9a)]=IntegrationsService;