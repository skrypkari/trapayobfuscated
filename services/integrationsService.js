'use strict';const a66_0x3fe469=a66_0x3ee5;function a66_0x3ee5(_0x51cf74,_0x1a7beb){_0x51cf74=_0x51cf74-0xe2;const _0x4138a7=a66_0x4138();let _0x3ee52f=_0x4138a7[_0x51cf74];return _0x3ee52f;}(function(_0x37d659,_0x37b49b){const _0xda700=a66_0x3ee5,_0x518e85=_0x37d659();while(!![]){try{const _0x2b5ba9=-parseInt(_0xda700(0xe6))/0x1*(-parseInt(_0xda700(0xfc))/0x2)+parseInt(_0xda700(0xe8))/0x3+parseInt(_0xda700(0xf9))/0x4*(-parseInt(_0xda700(0xf2))/0x5)+parseInt(_0xda700(0xe2))/0x6*(parseInt(_0xda700(0xfe))/0x7)+parseInt(_0xda700(0xf4))/0x8+parseInt(_0xda700(0xec))/0x9*(parseInt(_0xda700(0xf7))/0xa)+-parseInt(_0xda700(0xf0))/0xb*(parseInt(_0xda700(0xf8))/0xc);if(_0x2b5ba9===_0x37b49b)break;else _0x518e85['push'](_0x518e85['shift']());}catch(_0x440bc4){_0x518e85['push'](_0x518e85['shift']());}}}(a66_0x4138,0x5b06c));var __importDefault=this&&this[a66_0x3fe469(0xff)]||function(_0x43967b){const _0x1c6330=a66_0x3fe469;return _0x43967b&&_0x43967b[_0x1c6330(0xe9)]?_0x43967b:{'default':_0x43967b};};function a66_0x4138(){const _0x5db1ff=['shopSettings','11LUJMod','isArray','25TWwWdk','parseWebhookEvents','2566464HLIXQf','IntegrationsService','../config/database','10Jywovn','9472116fpcXSs','1752UfyPhf','findUnique','parse','4aTzEzB','webhookEvents','56UglZbt','__importDefault','string','354876pjOUdw','update','Shop\x20settings\x20not\x20found','webhookUrl','69886aoLHku','default','558396rqPkJQ','__esModule','ensureSettingsExist','defineProperty','400473yfyBng','getIntegrations','create'];a66_0x4138=function(){return _0x5db1ff;};return a66_0x4138();}Object[a66_0x3fe469(0xeb)](exports,a66_0x3fe469(0xe9),{'value':!![]}),exports[a66_0x3fe469(0xf5)]=void 0x0;const database_1=__importDefault(require(a66_0x3fe469(0xf6)));class IntegrationsService{[a66_0x3fe469(0xf3)](_0x5cdb03){const _0x402175=a66_0x3fe469;if(!_0x5cdb03)return[];if(Array['isArray'](_0x5cdb03))return _0x5cdb03;if(typeof _0x5cdb03===_0x402175(0x100))try{const _0x33efa3=JSON[_0x402175(0xfb)](_0x5cdb03);return Array[_0x402175(0xf1)](_0x33efa3)?_0x33efa3:[];}catch{return[];}return[];}async[a66_0x3fe469(0xed)](_0x237c8d){const _0x5e5291=a66_0x3fe469;await this[_0x5e5291(0xea)](_0x237c8d);const _0x5b0dfb=await database_1[_0x5e5291(0xe7)][_0x5e5291(0xef)][_0x5e5291(0xfa)]({'where':{'shopId':_0x237c8d},'select':{'webhookUrl':!![],'webhookEvents':!![]}});if(!_0x5b0dfb)throw new Error(_0x5e5291(0xe4));return{'webhook':{'url':_0x5b0dfb[_0x5e5291(0xe5)],'events':this[_0x5e5291(0xf3)](_0x5b0dfb[_0x5e5291(0xfd)])}};}async['updateWebhookSettings'](_0x562cd5,_0x43f13d){const _0x3a3eb0=a66_0x3fe469;await this[_0x3a3eb0(0xea)](_0x562cd5);const _0x5c64e5={};_0x43f13d[_0x3a3eb0(0xe5)]!==undefined&&(_0x5c64e5[_0x3a3eb0(0xe5)]=_0x43f13d[_0x3a3eb0(0xe5)]||null),_0x43f13d[_0x3a3eb0(0xfd)]!==undefined&&(_0x5c64e5[_0x3a3eb0(0xfd)]=_0x43f13d['webhookEvents']||[]),await database_1['default'][_0x3a3eb0(0xef)][_0x3a3eb0(0xe3)]({'where':{'shopId':_0x562cd5},'data':_0x5c64e5});}async[a66_0x3fe469(0xea)](_0x113536){const _0x2a2c82=a66_0x3fe469,_0xa75d4c=await database_1[_0x2a2c82(0xe7)][_0x2a2c82(0xef)][_0x2a2c82(0xfa)]({'where':{'shopId':_0x113536}});!_0xa75d4c&&await database_1[_0x2a2c82(0xe7)]['shopSettings'][_0x2a2c82(0xee)]({'data':{'shopId':_0x113536}});}}exports[a66_0x3fe469(0xf5)]=IntegrationsService;