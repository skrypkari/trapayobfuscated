'use strict';function a47_0x29d6(_0x1ca12c,_0x454426){const _0x15d35f=a47_0x15d3();return a47_0x29d6=function(_0x29d6b5,_0x14a63e){_0x29d6b5=_0x29d6b5-0x86;let _0x19b885=_0x15d35f[_0x29d6b5];return _0x19b885;},a47_0x29d6(_0x1ca12c,_0x454426);}const a47_0x3a2bba=a47_0x29d6;function a47_0x15d3(){const _0x2d188d=['1pLfEcZ','60493807VVzlJK','webhookUrl','default','updateWebhookSettings','shopSettings','getIntegrations','defineProperty','1319902IGrHsu','create','parse','2610472jzzlyT','3933640GSHITn','IntegrationsService','webhookEvents','23995FwrTEW','9YpPWqa','84SKkYjF','string','parseWebhookEvents','__importDefault','3140417qEagQF','isArray','249159zQzsUb','ensureSettingsExist','__esModule','findUnique','1236qJgmvy'];a47_0x15d3=function(){return _0x2d188d;};return a47_0x15d3();}(function(_0x209b9e,_0x5566a1){const _0x6377ef=a47_0x29d6,_0x456be2=_0x209b9e();while(!![]){try{const _0x5c7489=-parseInt(_0x6377ef(0x96))/0x1*(parseInt(_0x6377ef(0x9e))/0x2)+parseInt(_0x6377ef(0x91))/0x3*(-parseInt(_0x6377ef(0x8b))/0x4)+-parseInt(_0x6377ef(0x89))/0x5*(parseInt(_0x6377ef(0x95))/0x6)+-parseInt(_0x6377ef(0x8f))/0x7+-parseInt(_0x6377ef(0xa1))/0x8*(parseInt(_0x6377ef(0x8a))/0x9)+-parseInt(_0x6377ef(0x86))/0xa+parseInt(_0x6377ef(0x97))/0xb;if(_0x5c7489===_0x5566a1)break;else _0x456be2['push'](_0x456be2['shift']());}catch(_0x30b84d){_0x456be2['push'](_0x456be2['shift']());}}}(a47_0x15d3,0xe51eb));var __importDefault=this&&this[a47_0x3a2bba(0x8e)]||function(_0x8d8f94){const _0x2b3b5a=a47_0x3a2bba;return _0x8d8f94&&_0x8d8f94[_0x2b3b5a(0x93)]?_0x8d8f94:{'default':_0x8d8f94};};Object[a47_0x3a2bba(0x9d)](exports,'__esModule',{'value':!![]}),exports[a47_0x3a2bba(0x87)]=void 0x0;const database_1=__importDefault(require('../config/database'));class IntegrationsService{[a47_0x3a2bba(0x8d)](_0x21936d){const _0x34a9c5=a47_0x3a2bba;if(!_0x21936d)return[];if(Array[_0x34a9c5(0x90)](_0x21936d))return _0x21936d;if(typeof _0x21936d===_0x34a9c5(0x8c))try{const _0x38aa3f=JSON[_0x34a9c5(0xa0)](_0x21936d);return Array[_0x34a9c5(0x90)](_0x38aa3f)?_0x38aa3f:[];}catch{return[];}return[];}async[a47_0x3a2bba(0x9c)](_0x3ae8c1){const _0x5e5c43=a47_0x3a2bba;await this[_0x5e5c43(0x92)](_0x3ae8c1);const _0x4f6297=await database_1['default'][_0x5e5c43(0x9b)][_0x5e5c43(0x94)]({'where':{'shopId':_0x3ae8c1},'select':{'webhookUrl':!![],'webhookEvents':!![]}});if(!_0x4f6297)throw new Error('Shop\x20settings\x20not\x20found');return{'webhook':{'url':_0x4f6297[_0x5e5c43(0x98)],'events':this[_0x5e5c43(0x8d)](_0x4f6297[_0x5e5c43(0x88)])}};}async[a47_0x3a2bba(0x9a)](_0x52aab3,_0x5acd39){const _0x20dded=a47_0x3a2bba;await this['ensureSettingsExist'](_0x52aab3);const _0x3afb5c={};_0x5acd39[_0x20dded(0x98)]!==undefined&&(_0x3afb5c['webhookUrl']=_0x5acd39[_0x20dded(0x98)]||null),_0x5acd39[_0x20dded(0x88)]!==undefined&&(_0x3afb5c[_0x20dded(0x88)]=_0x5acd39[_0x20dded(0x88)]||[]),await database_1[_0x20dded(0x99)][_0x20dded(0x9b)]['update']({'where':{'shopId':_0x52aab3},'data':_0x3afb5c});}async[a47_0x3a2bba(0x92)](_0x5f8b07){const _0x18217c=a47_0x3a2bba,_0x157b40=await database_1[_0x18217c(0x99)][_0x18217c(0x9b)][_0x18217c(0x94)]({'where':{'shopId':_0x5f8b07}});!_0x157b40&&await database_1[_0x18217c(0x99)]['shopSettings'][_0x18217c(0x9f)]({'data':{'shopId':_0x5f8b07}});}}exports[a47_0x3a2bba(0x87)]=IntegrationsService;