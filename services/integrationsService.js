'use strict';const a47_0x3ee154=a47_0x994f;(function(_0x1ac0f3,_0x51a7b2){const _0x134bf1=a47_0x994f,_0x35dc6d=_0x1ac0f3();while(!![]){try{const _0x38c32a=-parseInt(_0x134bf1(0x1b3))/0x1+parseInt(_0x134bf1(0x1a3))/0x2*(parseInt(_0x134bf1(0x1b0))/0x3)+parseInt(_0x134bf1(0x1a6))/0x4+-parseInt(_0x134bf1(0x1a9))/0x5+-parseInt(_0x134bf1(0x1b9))/0x6+parseInt(_0x134bf1(0x1a5))/0x7*(-parseInt(_0x134bf1(0x1b8))/0x8)+parseInt(_0x134bf1(0x1b7))/0x9;if(_0x38c32a===_0x51a7b2)break;else _0x35dc6d['push'](_0x35dc6d['shift']());}catch(_0x5d7bb5){_0x35dc6d['push'](_0x35dc6d['shift']());}}}(a47_0x5c99,0x5ef5f));var __importDefault=this&&this['__importDefault']||function(_0x212dc4){const _0x13347b=a47_0x994f;return _0x212dc4&&_0x212dc4[_0x13347b(0x1b1)]?_0x212dc4:{'default':_0x212dc4};};Object[a47_0x3ee154(0x1ad)](exports,a47_0x3ee154(0x1b1),{'value':!![]}),exports[a47_0x3ee154(0x1ae)]=void 0x0;function a47_0x5c99(){const _0x441f28=['default','webhookUrl','updateWebhookSettings','12081447OHuhZR','8TjnOwk','619026xhMBrU','create','ensureSettingsExist','987958kQhSNb','parseWebhookEvents','4261327FcPTfQ','572836kUwOQS','update','getIntegrations','2283120KIhNbI','isArray','shopSettings','findUnique','defineProperty','IntegrationsService','../config/database','3XxcInJ','__esModule','webhookEvents','422056aQEHWH'];a47_0x5c99=function(){return _0x441f28;};return a47_0x5c99();}const database_1=__importDefault(require(a47_0x3ee154(0x1af)));class IntegrationsService{['parseWebhookEvents'](_0x9e89e8){const _0x16e03a=a47_0x3ee154;if(!_0x9e89e8)return[];if(Array[_0x16e03a(0x1aa)](_0x9e89e8))return _0x9e89e8;if(typeof _0x9e89e8==='string')try{const _0x2b6756=JSON['parse'](_0x9e89e8);return Array['isArray'](_0x2b6756)?_0x2b6756:[];}catch{return[];}return[];}async[a47_0x3ee154(0x1a8)](_0x2cb5f5){const _0xba1ed5=a47_0x3ee154;await this[_0xba1ed5(0x1a2)](_0x2cb5f5);const _0x202d4f=await database_1['default']['shopSettings']['findUnique']({'where':{'shopId':_0x2cb5f5},'select':{'webhookUrl':!![],'webhookEvents':!![]}});if(!_0x202d4f)throw new Error('Shop\x20settings\x20not\x20found');return{'webhook':{'url':_0x202d4f['webhookUrl'],'events':this[_0xba1ed5(0x1a4)](_0x202d4f['webhookEvents'])}};}async[a47_0x3ee154(0x1b6)](_0x54ffdb,_0x525292){const _0x1782a7=a47_0x3ee154;await this[_0x1782a7(0x1a2)](_0x54ffdb);const _0x4e14c4={};_0x525292[_0x1782a7(0x1b5)]!==undefined&&(_0x4e14c4[_0x1782a7(0x1b5)]=_0x525292[_0x1782a7(0x1b5)]||null),_0x525292[_0x1782a7(0x1b2)]!==undefined&&(_0x4e14c4[_0x1782a7(0x1b2)]=_0x525292['webhookEvents']||[]),await database_1[_0x1782a7(0x1b4)][_0x1782a7(0x1ab)][_0x1782a7(0x1a7)]({'where':{'shopId':_0x54ffdb},'data':_0x4e14c4});}async[a47_0x3ee154(0x1a2)](_0x1d215c){const _0x4f2839=a47_0x3ee154,_0x41aef6=await database_1[_0x4f2839(0x1b4)]['shopSettings'][_0x4f2839(0x1ac)]({'where':{'shopId':_0x1d215c}});!_0x41aef6&&await database_1['default']['shopSettings'][_0x4f2839(0x1a1)]({'data':{'shopId':_0x1d215c}});}}function a47_0x994f(_0x369a87,_0x4534f1){const _0x5c99b1=a47_0x5c99();return a47_0x994f=function(_0x994ff7,_0x1d1fff){_0x994ff7=_0x994ff7-0x1a1;let _0x399e9a=_0x5c99b1[_0x994ff7];return _0x399e9a;},a47_0x994f(_0x369a87,_0x4534f1);}exports[a47_0x3ee154(0x1ae)]=IntegrationsService;