'use strict';const a47_0x125f1b=a47_0x55ee;(function(_0x49430b,_0x447f7f){const _0xedc58b=a47_0x55ee,_0x476fd=_0x49430b();while(!![]){try{const _0x3d67c6=-parseInt(_0xedc58b(0xc9))/0x1*(parseInt(_0xedc58b(0xcd))/0x2)+parseInt(_0xedc58b(0xc8))/0x3+parseInt(_0xedc58b(0xd1))/0x4+-parseInt(_0xedc58b(0xd6))/0x5*(parseInt(_0xedc58b(0xc2))/0x6)+parseInt(_0xedc58b(0xdc))/0x7*(parseInt(_0xedc58b(0xc1))/0x8)+-parseInt(_0xedc58b(0xcf))/0x9*(-parseInt(_0xedc58b(0xd4))/0xa)+parseInt(_0xedc58b(0xd0))/0xb*(-parseInt(_0xedc58b(0xbf))/0xc);if(_0x3d67c6===_0x447f7f)break;else _0x476fd['push'](_0x476fd['shift']());}catch(_0x5ef727){_0x476fd['push'](_0x476fd['shift']());}}}(a47_0x2ff3,0xa1865));var __importDefault=this&&this[a47_0x125f1b(0xce)]||function(_0xbdc9d6){const _0x3c26f8=a47_0x125f1b;return _0xbdc9d6&&_0xbdc9d6[_0x3c26f8(0xca)]?_0xbdc9d6:{'default':_0xbdc9d6};};Object[a47_0x125f1b(0xc4)](exports,a47_0x125f1b(0xca),{'value':!![]}),exports['IntegrationsService']=void 0x0;const database_1=__importDefault(require(a47_0x125f1b(0xdd)));function a47_0x55ee(_0x35ca4e,_0x44b26d){const _0x2ff384=a47_0x2ff3();return a47_0x55ee=function(_0x55eee9,_0x306f45){_0x55eee9=_0x55eee9-0xbe;let _0xacd1f4=_0x2ff384[_0x55eee9];return _0xacd1f4;},a47_0x55ee(_0x35ca4e,_0x44b26d);}function a47_0x2ff3(){const _0xec9687=['4764896HklTbk','webhookUrl','getIntegrations','830LfmvAz','create','1593895nhipxf','default','webhookEvents','IntegrationsService','update','parseWebhookEvents','3661lObSYP','../config/database','isArray','444juhggx','updateWebhookSettings','13032ReABhy','18lpiEvt','string','defineProperty','parse','shopSettings','Shop\x20settings\x20not\x20found','860058PljEfy','523ydTHRP','__esModule','ensureSettingsExist','findUnique','1396BtUOjN','__importDefault','3879RJfGdk','113762paAUHE'];a47_0x2ff3=function(){return _0xec9687;};return a47_0x2ff3();}class IntegrationsService{[a47_0x125f1b(0xdb)](_0x2b22b7){const _0x4adb2d=a47_0x125f1b;if(!_0x2b22b7)return[];if(Array[_0x4adb2d(0xbe)](_0x2b22b7))return _0x2b22b7;if(typeof _0x2b22b7===_0x4adb2d(0xc3))try{const _0x41fdd1=JSON[_0x4adb2d(0xc5)](_0x2b22b7);return Array['isArray'](_0x41fdd1)?_0x41fdd1:[];}catch{return[];}return[];}async[a47_0x125f1b(0xd3)](_0x218340){const _0x29e48f=a47_0x125f1b;await this[_0x29e48f(0xcb)](_0x218340);const _0x419d1e=await database_1[_0x29e48f(0xd7)][_0x29e48f(0xc6)][_0x29e48f(0xcc)]({'where':{'shopId':_0x218340},'select':{'webhookUrl':!![],'webhookEvents':!![]}});if(!_0x419d1e)throw new Error(_0x29e48f(0xc7));return{'webhook':{'url':_0x419d1e[_0x29e48f(0xd2)],'events':this['parseWebhookEvents'](_0x419d1e[_0x29e48f(0xd8)])}};}async[a47_0x125f1b(0xc0)](_0x2841fe,_0x2d2d6e){const _0x3a0c33=a47_0x125f1b;await this[_0x3a0c33(0xcb)](_0x2841fe);const _0x1c79cf={};_0x2d2d6e[_0x3a0c33(0xd2)]!==undefined&&(_0x1c79cf[_0x3a0c33(0xd2)]=_0x2d2d6e['webhookUrl']||null),_0x2d2d6e['webhookEvents']!==undefined&&(_0x1c79cf['webhookEvents']=_0x2d2d6e[_0x3a0c33(0xd8)]||[]),await database_1[_0x3a0c33(0xd7)]['shopSettings'][_0x3a0c33(0xda)]({'where':{'shopId':_0x2841fe},'data':_0x1c79cf});}async[a47_0x125f1b(0xcb)](_0x59cae0){const _0x1faad3=a47_0x125f1b,_0x4c7587=await database_1[_0x1faad3(0xd7)][_0x1faad3(0xc6)][_0x1faad3(0xcc)]({'where':{'shopId':_0x59cae0}});!_0x4c7587&&await database_1[_0x1faad3(0xd7)]['shopSettings'][_0x1faad3(0xd5)]({'data':{'shopId':_0x59cae0}});}}exports[a47_0x125f1b(0xd9)]=IntegrationsService;