'use strict';const a52_0x33c236=a52_0x2ab8;function a52_0x4965(){const _0x5b026b=['default','25070130VLqSCp','__importDefault','webhookEvents','8oxMPBg','6261100eRCwNC','8330886TBUsUS','string','6VXJhMf','__esModule','IntegrationsService','2EjZrsx','parse','webhookUrl','162733ybPqOO','shopSettings','defineProperty','1584457BfVFpj','updateWebhookSettings','findUnique','Shop\x20settings\x20not\x20found','4497294Svuglx','4268965jLRrBG','ensureSettingsExist'];a52_0x4965=function(){return _0x5b026b;};return a52_0x4965();}(function(_0x26967f,_0x320854){const _0x30644f=a52_0x2ab8,_0x111fb4=_0x26967f();while(!![]){try{const _0x4e5e1a=parseInt(_0x30644f(0x182))/0x1*(parseInt(_0x30644f(0x197))/0x2)+parseInt(_0x30644f(0x189))/0x3+parseInt(_0x30644f(0x191))/0x4+parseInt(_0x30644f(0x18a))/0x5*(parseInt(_0x30644f(0x194))/0x6)+parseInt(_0x30644f(0x185))/0x7+-parseInt(_0x30644f(0x190))/0x8*(parseInt(_0x30644f(0x192))/0x9)+-parseInt(_0x30644f(0x18d))/0xa;if(_0x4e5e1a===_0x320854)break;else _0x111fb4['push'](_0x111fb4['shift']());}catch(_0xd3343d){_0x111fb4['push'](_0x111fb4['shift']());}}}(a52_0x4965,0xd5857));var __importDefault=this&&this[a52_0x33c236(0x18e)]||function(_0x2c110d){return _0x2c110d&&_0x2c110d['__esModule']?_0x2c110d:{'default':_0x2c110d};};Object[a52_0x33c236(0x184)](exports,a52_0x33c236(0x195),{'value':!![]}),exports[a52_0x33c236(0x196)]=void 0x0;function a52_0x2ab8(_0x4dc486,_0x140ace){const _0x4965a9=a52_0x4965();return a52_0x2ab8=function(_0x2ab8fa,_0x3bea2e){_0x2ab8fa=_0x2ab8fa-0x181;let _0x4121ec=_0x4965a9[_0x2ab8fa];return _0x4121ec;},a52_0x2ab8(_0x4dc486,_0x140ace);}const database_1=__importDefault(require('../config/database'));class IntegrationsService{['parseWebhookEvents'](_0x5401e1){const _0x52384b=a52_0x33c236;if(!_0x5401e1)return[];if(Array['isArray'](_0x5401e1))return _0x5401e1;if(typeof _0x5401e1===_0x52384b(0x193))try{const _0x49521e=JSON[_0x52384b(0x198)](_0x5401e1);return Array['isArray'](_0x49521e)?_0x49521e:[];}catch{return[];}return[];}async['getIntegrations'](_0x2a3f79){const _0x41b10b=a52_0x33c236;await this[_0x41b10b(0x18b)](_0x2a3f79);const _0xcb43a8=await database_1['default']['shopSettings'][_0x41b10b(0x187)]({'where':{'shopId':_0x2a3f79},'select':{'webhookUrl':!![],'webhookEvents':!![]}});if(!_0xcb43a8)throw new Error(_0x41b10b(0x188));return{'webhook':{'url':_0xcb43a8['webhookUrl'],'events':this['parseWebhookEvents'](_0xcb43a8['webhookEvents'])}};}async[a52_0x33c236(0x186)](_0x3618d0,_0x8a3362){const _0x1d47fe=a52_0x33c236;await this[_0x1d47fe(0x18b)](_0x3618d0);const _0x57e046={};_0x8a3362[_0x1d47fe(0x181)]!==undefined&&(_0x57e046[_0x1d47fe(0x181)]=_0x8a3362['webhookUrl']||null),_0x8a3362['webhookEvents']!==undefined&&(_0x57e046['webhookEvents']=_0x8a3362[_0x1d47fe(0x18f)]||[]),await database_1[_0x1d47fe(0x18c)][_0x1d47fe(0x183)]['update']({'where':{'shopId':_0x3618d0},'data':_0x57e046});}async[a52_0x33c236(0x18b)](_0x1dcd88){const _0x5ef162=a52_0x33c236,_0x4304dd=await database_1[_0x5ef162(0x18c)][_0x5ef162(0x183)][_0x5ef162(0x187)]({'where':{'shopId':_0x1dcd88}});!_0x4304dd&&await database_1[_0x5ef162(0x18c)][_0x5ef162(0x183)]['create']({'data':{'shopId':_0x1dcd88}});}}exports[a52_0x33c236(0x196)]=IntegrationsService;