'use strict';const a43_0x5ba040=a43_0x58fd;(function(_0x52312c,_0x5bd687){const _0x58dbe=a43_0x58fd,_0x3f73fa=_0x52312c();while(!![]){try{const _0x550ee7=-parseInt(_0x58dbe(0x14c))/0x1+-parseInt(_0x58dbe(0x147))/0x2+parseInt(_0x58dbe(0x150))/0x3+parseInt(_0x58dbe(0x140))/0x4+parseInt(_0x58dbe(0x13e))/0x5+-parseInt(_0x58dbe(0x141))/0x6*(-parseInt(_0x58dbe(0x146))/0x7)+-parseInt(_0x58dbe(0x138))/0x8;if(_0x550ee7===_0x5bd687)break;else _0x3f73fa['push'](_0x3f73fa['shift']());}catch(_0xccc8ae){_0x3f73fa['push'](_0x3f73fa['shift']());}}}(a43_0x543a,0xdcac2));function a43_0x58fd(_0x3fdda3,_0x3d339f){const _0x543ad2=a43_0x543a();return a43_0x58fd=function(_0x58fd07,_0x13c1bd){_0x58fd07=_0x58fd07-0x137;let _0x8aa06e=_0x543ad2[_0x58fd07];return _0x8aa06e;},a43_0x58fd(_0x3fdda3,_0x3d339f);}function a43_0x543a(){const _0x55e1cc=['3426535JnZhrK','1926392rafaOV','__importDefault','updateWebhookSettings','findUnique','create','365717Eyuyrb','IntegrationsService','webhookUrl','Shop\x20settings\x20not\x20found','4147035jvCxDK','defineProperty','9712216MWMcMT','ensureSettingsExist','update','getIntegrations','webhookEvents','shopSettings','438785XBrZHv','parseWebhookEvents','2032788tLQWgo','18HAJlqd','__esModule','default','../config/database','isArray'];a43_0x543a=function(){return _0x55e1cc;};return a43_0x543a();}var __importDefault=this&&this[a43_0x5ba040(0x148)]||function(_0x5d5ed1){const _0x3b33c4=a43_0x5ba040;return _0x5d5ed1&&_0x5d5ed1[_0x3b33c4(0x142)]?_0x5d5ed1:{'default':_0x5d5ed1};};Object[a43_0x5ba040(0x137)](exports,'__esModule',{'value':!![]}),exports[a43_0x5ba040(0x14d)]=void 0x0;const database_1=__importDefault(require(a43_0x5ba040(0x144)));class IntegrationsService{[a43_0x5ba040(0x13f)](_0x4d6226){const _0x22244d=a43_0x5ba040;if(!_0x4d6226)return[];if(Array[_0x22244d(0x145)](_0x4d6226))return _0x4d6226;if(typeof _0x4d6226==='string')try{const _0x927313=JSON['parse'](_0x4d6226);return Array[_0x22244d(0x145)](_0x927313)?_0x927313:[];}catch{return[];}return[];}async[a43_0x5ba040(0x13b)](_0x1752e8){const _0x3fabdd=a43_0x5ba040;await this['ensureSettingsExist'](_0x1752e8);const _0x1d4446=await database_1[_0x3fabdd(0x143)][_0x3fabdd(0x13d)][_0x3fabdd(0x14a)]({'where':{'shopId':_0x1752e8},'select':{'webhookUrl':!![],'webhookEvents':!![]}});if(!_0x1d4446)throw new Error(_0x3fabdd(0x14f));return{'webhook':{'url':_0x1d4446[_0x3fabdd(0x14e)],'events':this[_0x3fabdd(0x13f)](_0x1d4446[_0x3fabdd(0x13c)])}};}async[a43_0x5ba040(0x149)](_0x11db3c,_0x26a84){const _0x303291=a43_0x5ba040;await this[_0x303291(0x139)](_0x11db3c);const _0x428456={};_0x26a84['webhookUrl']!==undefined&&(_0x428456['webhookUrl']=_0x26a84[_0x303291(0x14e)]||null),_0x26a84[_0x303291(0x13c)]!==undefined&&(_0x428456[_0x303291(0x13c)]=_0x26a84['webhookEvents']||[]),await database_1[_0x303291(0x143)][_0x303291(0x13d)][_0x303291(0x13a)]({'where':{'shopId':_0x11db3c},'data':_0x428456});}async[a43_0x5ba040(0x139)](_0x583856){const _0x19f57e=a43_0x5ba040,_0x4613aa=await database_1['default'][_0x19f57e(0x13d)][_0x19f57e(0x14a)]({'where':{'shopId':_0x583856}});!_0x4613aa&&await database_1[_0x19f57e(0x143)][_0x19f57e(0x13d)][_0x19f57e(0x14b)]({'data':{'shopId':_0x583856}});}}exports[a43_0x5ba040(0x14d)]=IntegrationsService;