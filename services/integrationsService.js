'use strict';function a50_0x3b0a(_0x3568ca,_0x5349d3){const _0x1cb851=a50_0x1cb8();return a50_0x3b0a=function(_0x3b0a44,_0x3bdfa6){_0x3b0a44=_0x3b0a44-0xb1;let _0x1b5aa8=_0x1cb851[_0x3b0a44];return _0x1b5aa8;},a50_0x3b0a(_0x3568ca,_0x5349d3);}const a50_0x5124c6=a50_0x3b0a;(function(_0x322fda,_0x2152b4){const _0x2bcc79=a50_0x3b0a,_0x51fb3a=_0x322fda();while(!![]){try{const _0x324994=-parseInt(_0x2bcc79(0xbf))/0x1*(-parseInt(_0x2bcc79(0xc0))/0x2)+-parseInt(_0x2bcc79(0xb3))/0x3+-parseInt(_0x2bcc79(0xb6))/0x4+parseInt(_0x2bcc79(0xc3))/0x5+parseInt(_0x2bcc79(0xb1))/0x6*(-parseInt(_0x2bcc79(0xbe))/0x7)+parseInt(_0x2bcc79(0xbc))/0x8+-parseInt(_0x2bcc79(0xc8))/0x9*(-parseInt(_0x2bcc79(0xbb))/0xa);if(_0x324994===_0x2152b4)break;else _0x51fb3a['push'](_0x51fb3a['shift']());}catch(_0x23ee35){_0x51fb3a['push'](_0x51fb3a['shift']());}}}(a50_0x1cb8,0xa4388));var __importDefault=this&&this[a50_0x5124c6(0xc5)]||function(_0x3f8931){return _0x3f8931&&_0x3f8931['__esModule']?_0x3f8931:{'default':_0x3f8931};};function a50_0x1cb8(){const _0x223808=['webhookEvents','isArray','5570181QxtAPv','defineProperty','../config/database','IntegrationsService','parseWebhookEvents','findUnique','5959026wdTRvE','default','2787303fmgyUD','parse','getIntegrations','1653520gIkMkG','ensureSettingsExist','__esModule','string','update','10xCDGRG','10745088FNaHqq','updateWebhookSettings','7mqGzXy','7065XVEEad','14aavyxo','shopSettings','webhookUrl','4984000fBreXt','create','__importDefault'];a50_0x1cb8=function(){return _0x223808;};return a50_0x1cb8();}Object[a50_0x5124c6(0xc9)](exports,a50_0x5124c6(0xb8),{'value':!![]}),exports['IntegrationsService']=void 0x0;const database_1=__importDefault(require(a50_0x5124c6(0xca)));class IntegrationsService{['parseWebhookEvents'](_0x1c889a){const _0x450a48=a50_0x5124c6;if(!_0x1c889a)return[];if(Array[_0x450a48(0xc7)](_0x1c889a))return _0x1c889a;if(typeof _0x1c889a===_0x450a48(0xb9))try{const _0x43d7e7=JSON[_0x450a48(0xb4)](_0x1c889a);return Array[_0x450a48(0xc7)](_0x43d7e7)?_0x43d7e7:[];}catch{return[];}return[];}async[a50_0x5124c6(0xb5)](_0x53f662){const _0xe2e216=a50_0x5124c6;await this['ensureSettingsExist'](_0x53f662);const _0x6c4de=await database_1[_0xe2e216(0xb2)]['shopSettings']['findUnique']({'where':{'shopId':_0x53f662},'select':{'webhookUrl':!![],'webhookEvents':!![]}});if(!_0x6c4de)throw new Error('Shop\x20settings\x20not\x20found');return{'webhook':{'url':_0x6c4de[_0xe2e216(0xc2)],'events':this[_0xe2e216(0xcc)](_0x6c4de['webhookEvents'])}};}async[a50_0x5124c6(0xbd)](_0x509252,_0x53fd94){const _0x4a701e=a50_0x5124c6;await this[_0x4a701e(0xb7)](_0x509252);const _0x2ae242={};_0x53fd94[_0x4a701e(0xc2)]!==undefined&&(_0x2ae242[_0x4a701e(0xc2)]=_0x53fd94[_0x4a701e(0xc2)]||null),_0x53fd94['webhookEvents']!==undefined&&(_0x2ae242[_0x4a701e(0xc6)]=_0x53fd94['webhookEvents']||[]),await database_1[_0x4a701e(0xb2)][_0x4a701e(0xc1)][_0x4a701e(0xba)]({'where':{'shopId':_0x509252},'data':_0x2ae242});}async[a50_0x5124c6(0xb7)](_0x1ee5f5){const _0x23fc35=a50_0x5124c6,_0x17a9d2=await database_1[_0x23fc35(0xb2)][_0x23fc35(0xc1)][_0x23fc35(0xcd)]({'where':{'shopId':_0x1ee5f5}});!_0x17a9d2&&await database_1[_0x23fc35(0xb2)][_0x23fc35(0xc1)][_0x23fc35(0xc4)]({'data':{'shopId':_0x1ee5f5}});}}exports[a50_0x5124c6(0xcb)]=IntegrationsService;