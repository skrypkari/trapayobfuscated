'use strict';const a43_0x14e6b6=a43_0x4ef7;(function(_0x414f89,_0x54f67c){const _0x3397c8=a43_0x4ef7,_0x2659e8=_0x414f89();while(!![]){try{const _0x58cc03=parseInt(_0x3397c8(0x8d))/0x1+parseInt(_0x3397c8(0x90))/0x2+-parseInt(_0x3397c8(0x9e))/0x3+parseInt(_0x3397c8(0x96))/0x4*(parseInt(_0x3397c8(0x97))/0x5)+-parseInt(_0x3397c8(0xa3))/0x6*(parseInt(_0x3397c8(0x98))/0x7)+-parseInt(_0x3397c8(0x9b))/0x8*(-parseInt(_0x3397c8(0x8e))/0x9)+-parseInt(_0x3397c8(0x9c))/0xa;if(_0x58cc03===_0x54f67c)break;else _0x2659e8['push'](_0x2659e8['shift']());}catch(_0x41bf2c){_0x2659e8['push'](_0x2659e8['shift']());}}}(a43_0x2b49,0x7d236));function a43_0x4ef7(_0x2932d6,_0x32457b){const _0x2b495f=a43_0x2b49();return a43_0x4ef7=function(_0x4ef779,_0x380301){_0x4ef779=_0x4ef779-0x8d;let _0x15cb8f=_0x2b495f[_0x4ef779];return _0x15cb8f;},a43_0x4ef7(_0x2932d6,_0x32457b);}function a43_0x2b49(){const _0x42e0d4=['default','__esModule','__importDefault','updateWebhookSettings','12xiIxFw','1155535sTfBCJ','3220vlQTqL','../config/database','getIntegrations','246424vGmVcG','5536110aTOCAW','ensureSettingsExist','951525ESitsd','shopSettings','create','parse','webhookEvents','282hiGINn','parseWebhookEvents','webhookUrl','604855lywoFN','9VXlpZM','isArray','151986NMlwqn','IntegrationsService'];a43_0x2b49=function(){return _0x42e0d4;};return a43_0x2b49();}var __importDefault=this&&this[a43_0x14e6b6(0x94)]||function(_0x271f9b){const _0x343cd4=a43_0x14e6b6;return _0x271f9b&&_0x271f9b[_0x343cd4(0x93)]?_0x271f9b:{'default':_0x271f9b};};Object['defineProperty'](exports,a43_0x14e6b6(0x93),{'value':!![]}),exports[a43_0x14e6b6(0x91)]=void 0x0;const database_1=__importDefault(require(a43_0x14e6b6(0x99)));class IntegrationsService{[a43_0x14e6b6(0xa4)](_0x314021){const _0x4c6c19=a43_0x14e6b6;if(!_0x314021)return[];if(Array[_0x4c6c19(0x8f)](_0x314021))return _0x314021;if(typeof _0x314021==='string')try{const _0x155ca6=JSON[_0x4c6c19(0xa1)](_0x314021);return Array[_0x4c6c19(0x8f)](_0x155ca6)?_0x155ca6:[];}catch{return[];}return[];}async[a43_0x14e6b6(0x9a)](_0x59f6aa){const _0x3e11e1=a43_0x14e6b6;await this[_0x3e11e1(0x9d)](_0x59f6aa);const _0x487d81=await database_1[_0x3e11e1(0x92)][_0x3e11e1(0x9f)]['findUnique']({'where':{'shopId':_0x59f6aa},'select':{'webhookUrl':!![],'webhookEvents':!![]}});if(!_0x487d81)throw new Error('Shop\x20settings\x20not\x20found');return{'webhook':{'url':_0x487d81[_0x3e11e1(0xa5)],'events':this[_0x3e11e1(0xa4)](_0x487d81[_0x3e11e1(0xa2)])}};}async[a43_0x14e6b6(0x95)](_0x4718e7,_0x2d323d){const _0x3ad36b=a43_0x14e6b6;await this[_0x3ad36b(0x9d)](_0x4718e7);const _0x526be2={};_0x2d323d[_0x3ad36b(0xa5)]!==undefined&&(_0x526be2[_0x3ad36b(0xa5)]=_0x2d323d['webhookUrl']||null),_0x2d323d[_0x3ad36b(0xa2)]!==undefined&&(_0x526be2['webhookEvents']=_0x2d323d[_0x3ad36b(0xa2)]||[]),await database_1['default']['shopSettings']['update']({'where':{'shopId':_0x4718e7},'data':_0x526be2});}async[a43_0x14e6b6(0x9d)](_0x2a769e){const _0x4ea2c1=a43_0x14e6b6,_0x2e40de=await database_1[_0x4ea2c1(0x92)][_0x4ea2c1(0x9f)]['findUnique']({'where':{'shopId':_0x2a769e}});!_0x2e40de&&await database_1[_0x4ea2c1(0x92)][_0x4ea2c1(0x9f)][_0x4ea2c1(0xa0)]({'data':{'shopId':_0x2a769e}});}}exports[a43_0x14e6b6(0x91)]=IntegrationsService;