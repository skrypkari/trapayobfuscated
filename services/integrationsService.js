'use strict';function a55_0x55df(_0x55beb1,_0x161aa4){const _0x2b2bc6=a55_0x2b2b();return a55_0x55df=function(_0x55dfed,_0x96eb75){_0x55dfed=_0x55dfed-0x122;let _0x2e5087=_0x2b2bc6[_0x55dfed];return _0x2e5087;},a55_0x55df(_0x55beb1,_0x161aa4);}const a55_0x22f1fa=a55_0x55df;(function(_0x5e1613,_0x1bc31d){const _0x2735bb=a55_0x55df,_0x2b0d3e=_0x5e1613();while(!![]){try{const _0xd5c828=parseInt(_0x2735bb(0x13e))/0x1+-parseInt(_0x2735bb(0x123))/0x2*(parseInt(_0x2735bb(0x127))/0x3)+parseInt(_0x2735bb(0x139))/0x4*(-parseInt(_0x2735bb(0x130))/0x5)+-parseInt(_0x2735bb(0x133))/0x6+parseInt(_0x2735bb(0x125))/0x7*(parseInt(_0x2735bb(0x136))/0x8)+-parseInt(_0x2735bb(0x129))/0x9+-parseInt(_0x2735bb(0x137))/0xa*(-parseInt(_0x2735bb(0x135))/0xb);if(_0xd5c828===_0x1bc31d)break;else _0x2b0d3e['push'](_0x2b0d3e['shift']());}catch(_0x289d73){_0x2b0d3e['push'](_0x2b0d3e['shift']());}}}(a55_0x2b2b,0xad13b));function a55_0x2b2b(){const _0x5844a1=['webhookUrl','1324390BGqFJL','IntegrationsService','602LMPvkF','isArray','3FRnpYs','getIntegrations','11342025azZizZ','parseWebhookEvents','__importDefault','defineProperty','__esModule','Shop\x20settings\x20not\x20found','create','45CBxccp','webhookEvents','updateWebhookSettings','3786804CDmRGt','shopSettings','8628070LRbfWP','107936BZcKUT','30bQgSqb','findUnique','556964TGzbPy','default','ensureSettingsExist','../config/database','update','1002224hmvxip'];a55_0x2b2b=function(){return _0x5844a1;};return a55_0x2b2b();}var __importDefault=this&&this[a55_0x22f1fa(0x12b)]||function(_0xc3c006){const _0x5c037d=a55_0x22f1fa;return _0xc3c006&&_0xc3c006[_0x5c037d(0x12d)]?_0xc3c006:{'default':_0xc3c006};};Object[a55_0x22f1fa(0x12c)](exports,'__esModule',{'value':!![]}),exports[a55_0x22f1fa(0x124)]=void 0x0;const database_1=__importDefault(require(a55_0x22f1fa(0x13c)));class IntegrationsService{['parseWebhookEvents'](_0x5bb9a2){const _0x34e3d9=a55_0x22f1fa;if(!_0x5bb9a2)return[];if(Array[_0x34e3d9(0x126)](_0x5bb9a2))return _0x5bb9a2;if(typeof _0x5bb9a2==='string')try{const _0xd3c694=JSON['parse'](_0x5bb9a2);return Array[_0x34e3d9(0x126)](_0xd3c694)?_0xd3c694:[];}catch{return[];}return[];}async[a55_0x22f1fa(0x128)](_0x30591c){const _0x14288e=a55_0x22f1fa;await this[_0x14288e(0x13b)](_0x30591c);const _0x1b780e=await database_1[_0x14288e(0x13a)]['shopSettings'][_0x14288e(0x138)]({'where':{'shopId':_0x30591c},'select':{'webhookUrl':!![],'webhookEvents':!![]}});if(!_0x1b780e)throw new Error(_0x14288e(0x12e));return{'webhook':{'url':_0x1b780e[_0x14288e(0x122)],'events':this[_0x14288e(0x12a)](_0x1b780e['webhookEvents'])}};}async[a55_0x22f1fa(0x132)](_0x1da331,_0x54bb29){const _0x1d4f0f=a55_0x22f1fa;await this[_0x1d4f0f(0x13b)](_0x1da331);const _0x13640d={};_0x54bb29[_0x1d4f0f(0x122)]!==undefined&&(_0x13640d['webhookUrl']=_0x54bb29[_0x1d4f0f(0x122)]||null),_0x54bb29[_0x1d4f0f(0x131)]!==undefined&&(_0x13640d[_0x1d4f0f(0x131)]=_0x54bb29['webhookEvents']||[]),await database_1[_0x1d4f0f(0x13a)]['shopSettings'][_0x1d4f0f(0x13d)]({'where':{'shopId':_0x1da331},'data':_0x13640d});}async['ensureSettingsExist'](_0x2c191c){const _0x46b3aa=a55_0x22f1fa,_0x375d78=await database_1[_0x46b3aa(0x13a)]['shopSettings'][_0x46b3aa(0x138)]({'where':{'shopId':_0x2c191c}});!_0x375d78&&await database_1[_0x46b3aa(0x13a)][_0x46b3aa(0x134)][_0x46b3aa(0x12f)]({'data':{'shopId':_0x2c191c}});}}exports[a55_0x22f1fa(0x124)]=IntegrationsService;