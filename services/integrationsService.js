'use strict';const a78_0x29d0fd=a78_0x13dc;(function(_0x4ee294,_0x5235e9){const _0x543ba4=a78_0x13dc,_0x577971=_0x4ee294();while(!![]){try{const _0x408cdd=-parseInt(_0x543ba4(0x13b))/0x1+parseInt(_0x543ba4(0x152))/0x2*(parseInt(_0x543ba4(0x150))/0x3)+-parseInt(_0x543ba4(0x14c))/0x4+parseInt(_0x543ba4(0x148))/0x5*(-parseInt(_0x543ba4(0x13d))/0x6)+parseInt(_0x543ba4(0x14f))/0x7*(-parseInt(_0x543ba4(0x13c))/0x8)+-parseInt(_0x543ba4(0x143))/0x9*(-parseInt(_0x543ba4(0x13a))/0xa)+parseInt(_0x543ba4(0x139))/0xb;if(_0x408cdd===_0x5235e9)break;else _0x577971['push'](_0x577971['shift']());}catch(_0x2b10d2){_0x577971['push'](_0x577971['shift']());}}}(a78_0x1fa5,0xab8ff));function a78_0x1fa5(){const _0x214fcf=['8237075IYVIOy','44229cmEkFo','../config/database','10AjJNUO','__importDefault','parse','defineProperty','41254587ucvmCW','6314230zuXbqN','1268145JOsHEW','8UhBuCq','696XEgaOq','getIntegrations','shopSettings','updateWebhookSettings','findUnique','__esModule','9KDZpQI','create','ensureSettingsExist','default','string','46005kBpNay','webhookUrl','webhookEvents','parseWebhookEvents','962600BLFoWD','isArray','update'];a78_0x1fa5=function(){return _0x214fcf;};return a78_0x1fa5();}var __importDefault=this&&this[a78_0x29d0fd(0x153)]||function(_0xd87a50){const _0x1454f5=a78_0x29d0fd;return _0xd87a50&&_0xd87a50[_0x1454f5(0x142)]?_0xd87a50:{'default':_0xd87a50};};Object[a78_0x29d0fd(0x155)](exports,a78_0x29d0fd(0x142),{'value':!![]}),exports['IntegrationsService']=void 0x0;function a78_0x13dc(_0x2fcfdc,_0x475574){_0x2fcfdc=_0x2fcfdc-0x139;const _0x1fa57f=a78_0x1fa5();let _0x13dca7=_0x1fa57f[_0x2fcfdc];return _0x13dca7;}const database_1=__importDefault(require(a78_0x29d0fd(0x151)));class IntegrationsService{['parseWebhookEvents'](_0x45ed66){const _0x22b6d8=a78_0x29d0fd;if(!_0x45ed66)return[];if(Array[_0x22b6d8(0x14d)](_0x45ed66))return _0x45ed66;if(typeof _0x45ed66===_0x22b6d8(0x147))try{const _0x1f6a5f=JSON[_0x22b6d8(0x154)](_0x45ed66);return Array['isArray'](_0x1f6a5f)?_0x1f6a5f:[];}catch{return[];}return[];}async[a78_0x29d0fd(0x13e)](_0x218a68){const _0x3d8079=a78_0x29d0fd;await this[_0x3d8079(0x145)](_0x218a68);const _0x59af8b=await database_1[_0x3d8079(0x146)][_0x3d8079(0x13f)][_0x3d8079(0x141)]({'where':{'shopId':_0x218a68},'select':{'webhookUrl':!![],'webhookEvents':!![]}});if(!_0x59af8b)throw new Error('Shop\x20settings\x20not\x20found');return{'webhook':{'url':_0x59af8b[_0x3d8079(0x149)],'events':this[_0x3d8079(0x14b)](_0x59af8b[_0x3d8079(0x14a)])}};}async[a78_0x29d0fd(0x140)](_0x161935,_0x23254e){const _0x54960b=a78_0x29d0fd;await this[_0x54960b(0x145)](_0x161935);const _0x496d58={};_0x23254e[_0x54960b(0x149)]!==undefined&&(_0x496d58[_0x54960b(0x149)]=_0x23254e[_0x54960b(0x149)]||null),_0x23254e[_0x54960b(0x14a)]!==undefined&&(_0x496d58[_0x54960b(0x14a)]=_0x23254e[_0x54960b(0x14a)]||[]),await database_1['default'][_0x54960b(0x13f)][_0x54960b(0x14e)]({'where':{'shopId':_0x161935},'data':_0x496d58});}async[a78_0x29d0fd(0x145)](_0x115c9c){const _0x17cf3c=a78_0x29d0fd,_0x1d7671=await database_1[_0x17cf3c(0x146)]['shopSettings'][_0x17cf3c(0x141)]({'where':{'shopId':_0x115c9c}});!_0x1d7671&&await database_1[_0x17cf3c(0x146)]['shopSettings'][_0x17cf3c(0x144)]({'data':{'shopId':_0x115c9c}});}}exports['IntegrationsService']=IntegrationsService;