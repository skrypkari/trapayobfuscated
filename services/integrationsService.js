'use strict';function a47_0x33cc(){const _0x38fe77=['getIntegrations','string','78QIgqzX','498nCrLvE','defineProperty','9997254eMuibV','parse','__esModule','ensureSettingsExist','__importDefault','7839616cZsUch','3549410PpxaPZ','2346866UKAeZl','60718dtZoTB','115452XWvVgz','findUnique','default','updateWebhookSettings','parseWebhookEvents','5871790uAviQT','update','webhookUrl','shopSettings','1OaNfZn','isArray','Shop\x20settings\x20not\x20found','create','../config/database','webhookEvents'];a47_0x33cc=function(){return _0x38fe77;};return a47_0x33cc();}const a47_0xc9eba7=a47_0x1e87;(function(_0x9bd12d,_0x3c7e6a){const _0x47f9a7=a47_0x1e87,_0x16144f=_0x9bd12d();while(!![]){try{const _0x552bdd=parseInt(_0x47f9a7(0xe3))/0x1*(parseInt(_0x47f9a7(0xd8))/0x2)+-parseInt(_0x47f9a7(0xce))/0x3*(-parseInt(_0x47f9a7(0xda))/0x4)+parseInt(_0x47f9a7(0xd7))/0x5+parseInt(_0x47f9a7(0xcf))/0x6*(parseInt(_0x47f9a7(0xd9))/0x7)+-parseInt(_0x47f9a7(0xd6))/0x8+-parseInt(_0x47f9a7(0xd1))/0x9+-parseInt(_0x47f9a7(0xdf))/0xa;if(_0x552bdd===_0x3c7e6a)break;else _0x16144f['push'](_0x16144f['shift']());}catch(_0x55b0e2){_0x16144f['push'](_0x16144f['shift']());}}}(a47_0x33cc,0xa4fae));var __importDefault=this&&this[a47_0xc9eba7(0xd5)]||function(_0x410d60){const _0x5e691f=a47_0xc9eba7;return _0x410d60&&_0x410d60[_0x5e691f(0xd3)]?_0x410d60:{'default':_0x410d60};};Object[a47_0xc9eba7(0xd0)](exports,a47_0xc9eba7(0xd3),{'value':!![]}),exports['IntegrationsService']=void 0x0;const database_1=__importDefault(require(a47_0xc9eba7(0xca)));function a47_0x1e87(_0x39eeae,_0x3e21b0){const _0x33ccc5=a47_0x33cc();return a47_0x1e87=function(_0x1e8756,_0x2b6621){_0x1e8756=_0x1e8756-0xc7;let _0x3e61a0=_0x33ccc5[_0x1e8756];return _0x3e61a0;},a47_0x1e87(_0x39eeae,_0x3e21b0);}class IntegrationsService{[a47_0xc9eba7(0xde)](_0x153851){const _0x123559=a47_0xc9eba7;if(!_0x153851)return[];if(Array['isArray'](_0x153851))return _0x153851;if(typeof _0x153851===_0x123559(0xcd))try{const _0x38d0ca=JSON[_0x123559(0xd2)](_0x153851);return Array[_0x123559(0xc7)](_0x38d0ca)?_0x38d0ca:[];}catch{return[];}return[];}async[a47_0xc9eba7(0xcc)](_0x3fdca0){const _0x3d1b51=a47_0xc9eba7;await this['ensureSettingsExist'](_0x3fdca0);const _0x58ffc3=await database_1[_0x3d1b51(0xdc)][_0x3d1b51(0xe2)][_0x3d1b51(0xdb)]({'where':{'shopId':_0x3fdca0},'select':{'webhookUrl':!![],'webhookEvents':!![]}});if(!_0x58ffc3)throw new Error(_0x3d1b51(0xc8));return{'webhook':{'url':_0x58ffc3[_0x3d1b51(0xe1)],'events':this[_0x3d1b51(0xde)](_0x58ffc3[_0x3d1b51(0xcb)])}};}async[a47_0xc9eba7(0xdd)](_0x218d9e,_0xc0b368){const _0x16c183=a47_0xc9eba7;await this['ensureSettingsExist'](_0x218d9e);const _0x518460={};_0xc0b368['webhookUrl']!==undefined&&(_0x518460[_0x16c183(0xe1)]=_0xc0b368[_0x16c183(0xe1)]||null),_0xc0b368[_0x16c183(0xcb)]!==undefined&&(_0x518460[_0x16c183(0xcb)]=_0xc0b368[_0x16c183(0xcb)]||[]),await database_1['default'][_0x16c183(0xe2)][_0x16c183(0xe0)]({'where':{'shopId':_0x218d9e},'data':_0x518460});}async[a47_0xc9eba7(0xd4)](_0x4cdcb3){const _0x3de9ae=a47_0xc9eba7,_0x34afc2=await database_1[_0x3de9ae(0xdc)][_0x3de9ae(0xe2)][_0x3de9ae(0xdb)]({'where':{'shopId':_0x4cdcb3}});!_0x34afc2&&await database_1[_0x3de9ae(0xdc)][_0x3de9ae(0xe2)][_0x3de9ae(0xc9)]({'data':{'shopId':_0x4cdcb3}});}}exports['IntegrationsService']=IntegrationsService;