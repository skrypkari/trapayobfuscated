'use strict';const a47_0x4e6e48=a47_0xdd01;(function(_0x3deb93,_0x24e73c){const _0x4176dd=a47_0xdd01,_0x29f9e3=_0x3deb93();while(!![]){try{const _0x211afb=-parseInt(_0x4176dd(0x8b))/0x1*(parseInt(_0x4176dd(0x83))/0x2)+parseInt(_0x4176dd(0x92))/0x3*(parseInt(_0x4176dd(0x93))/0x4)+parseInt(_0x4176dd(0x97))/0x5*(-parseInt(_0x4176dd(0x89))/0x6)+-parseInt(_0x4176dd(0x8d))/0x7+parseInt(_0x4176dd(0x81))/0x8+parseInt(_0x4176dd(0x84))/0x9+parseInt(_0x4176dd(0x80))/0xa*(-parseInt(_0x4176dd(0x88))/0xb);if(_0x211afb===_0x24e73c)break;else _0x29f9e3['push'](_0x29f9e3['shift']());}catch(_0x5550e2){_0x29f9e3['push'](_0x29f9e3['shift']());}}}(a47_0x33a4,0xe5d4d));function a47_0xdd01(_0x356d33,_0x24c093){const _0x33a437=a47_0x33a4();return a47_0xdd01=function(_0xdd0186,_0x4bf62d){_0xdd0186=_0xdd0186-0x7f;let _0xc890c3=_0x33a437[_0xdd0186];return _0xc890c3;},a47_0xdd01(_0x356d33,_0x24c093);}function a47_0x33a4(){const _0x8f893f=['Shop\x20settings\x20not\x20found','../config/database','286hQXKXD','6HBvVVR','__esModule','22QWselI','update','1740641rhZuup','create','webhookUrl','shopSettings','getIntegrations','2196XMsrMN','828wbmnCv','updateWebhookSettings','IntegrationsService','webhookEvents','372565weoeGX','isArray','findUnique','parseWebhookEvents','269690vVryXn','14966360eZVsfi','default','13456GjnVhe','823104IfHYYm','ensureSettingsExist'];a47_0x33a4=function(){return _0x8f893f;};return a47_0x33a4();}var __importDefault=this&&this['__importDefault']||function(_0x27a715){const _0x462f0d=a47_0xdd01;return _0x27a715&&_0x27a715[_0x462f0d(0x8a)]?_0x27a715:{'default':_0x27a715};};Object['defineProperty'](exports,a47_0x4e6e48(0x8a),{'value':!![]}),exports[a47_0x4e6e48(0x95)]=void 0x0;const database_1=__importDefault(require(a47_0x4e6e48(0x87)));class IntegrationsService{[a47_0x4e6e48(0x7f)](_0x509b13){const _0xaf0585=a47_0x4e6e48;if(!_0x509b13)return[];if(Array[_0xaf0585(0x98)](_0x509b13))return _0x509b13;if(typeof _0x509b13==='string')try{const _0xd4d311=JSON['parse'](_0x509b13);return Array[_0xaf0585(0x98)](_0xd4d311)?_0xd4d311:[];}catch{return[];}return[];}async[a47_0x4e6e48(0x91)](_0x238c90){const _0x1faab9=a47_0x4e6e48;await this[_0x1faab9(0x85)](_0x238c90);const _0x558271=await database_1[_0x1faab9(0x82)]['shopSettings'][_0x1faab9(0x99)]({'where':{'shopId':_0x238c90},'select':{'webhookUrl':!![],'webhookEvents':!![]}});if(!_0x558271)throw new Error(_0x1faab9(0x86));return{'webhook':{'url':_0x558271[_0x1faab9(0x8f)],'events':this[_0x1faab9(0x7f)](_0x558271[_0x1faab9(0x96)])}};}async[a47_0x4e6e48(0x94)](_0x311344,_0x226684){const _0x57104f=a47_0x4e6e48;await this['ensureSettingsExist'](_0x311344);const _0x57c62a={};_0x226684[_0x57104f(0x8f)]!==undefined&&(_0x57c62a[_0x57104f(0x8f)]=_0x226684['webhookUrl']||null),_0x226684[_0x57104f(0x96)]!==undefined&&(_0x57c62a[_0x57104f(0x96)]=_0x226684['webhookEvents']||[]),await database_1['default'][_0x57104f(0x90)][_0x57104f(0x8c)]({'where':{'shopId':_0x311344},'data':_0x57c62a});}async[a47_0x4e6e48(0x85)](_0x39dca3){const _0x3d52b5=a47_0x4e6e48,_0x4c9c6c=await database_1['default'][_0x3d52b5(0x90)]['findUnique']({'where':{'shopId':_0x39dca3}});!_0x4c9c6c&&await database_1[_0x3d52b5(0x82)]['shopSettings'][_0x3d52b5(0x8e)]({'data':{'shopId':_0x39dca3}});}}exports[a47_0x4e6e48(0x95)]=IntegrationsService;