'use strict';const a55_0x56b708=a55_0x4e21;(function(_0x4483d0,_0x317b4d){const _0x37f282=a55_0x4e21,_0x5708ae=_0x4483d0();while(!![]){try{const _0x2db617=-parseInt(_0x37f282(0x15d))/0x1+parseInt(_0x37f282(0x166))/0x2+-parseInt(_0x37f282(0x164))/0x3+-parseInt(_0x37f282(0x150))/0x4*(parseInt(_0x37f282(0x15a))/0x5)+parseInt(_0x37f282(0x153))/0x6*(parseInt(_0x37f282(0x151))/0x7)+-parseInt(_0x37f282(0x159))/0x8+parseInt(_0x37f282(0x154))/0x9*(parseInt(_0x37f282(0x161))/0xa);if(_0x2db617===_0x317b4d)break;else _0x5708ae['push'](_0x5708ae['shift']());}catch(_0xcade68){_0x5708ae['push'](_0x5708ae['shift']());}}}(a55_0x4b67,0x7aae2));var __importDefault=this&&this[a55_0x56b708(0x155)]||function(_0x34f9f9){return _0x34f9f9&&_0x34f9f9['__esModule']?_0x34f9f9:{'default':_0x34f9f9};};function a55_0x4b67(){const _0x53bd6e=['isArray','3215964eTuSPm','252UeZoQs','__importDefault','../config/database','default','findUnique','6869224FioXHi','2709895TJKsuk','ensureSettingsExist','webhookUrl','931426ULgtLz','webhookEvents','create','parseWebhookEvents','928130fKTEKL','shopSettings','parse','1147560UVkTpM','IntegrationsService','164636GRohlz','Shop\x20settings\x20not\x20found','defineProperty','getIntegrations','4wcqljg','7INZrdc'];a55_0x4b67=function(){return _0x53bd6e;};return a55_0x4b67();}Object[a55_0x56b708(0x168)](exports,'__esModule',{'value':!![]}),exports[a55_0x56b708(0x165)]=void 0x0;function a55_0x4e21(_0x36ac11,_0x31f620){const _0x4b6730=a55_0x4b67();return a55_0x4e21=function(_0x4e21da,_0x1c194c){_0x4e21da=_0x4e21da-0x150;let _0x58d223=_0x4b6730[_0x4e21da];return _0x58d223;},a55_0x4e21(_0x36ac11,_0x31f620);}const database_1=__importDefault(require(a55_0x56b708(0x156)));class IntegrationsService{[a55_0x56b708(0x160)](_0x34bc48){const _0x688a47=a55_0x56b708;if(!_0x34bc48)return[];if(Array[_0x688a47(0x152)](_0x34bc48))return _0x34bc48;if(typeof _0x34bc48==='string')try{const _0x4d54df=JSON[_0x688a47(0x163)](_0x34bc48);return Array[_0x688a47(0x152)](_0x4d54df)?_0x4d54df:[];}catch{return[];}return[];}async[a55_0x56b708(0x169)](_0x2f9449){const _0x2f75a8=a55_0x56b708;await this[_0x2f75a8(0x15b)](_0x2f9449);const _0xa5dc6c=await database_1['default']['shopSettings'][_0x2f75a8(0x158)]({'where':{'shopId':_0x2f9449},'select':{'webhookUrl':!![],'webhookEvents':!![]}});if(!_0xa5dc6c)throw new Error(_0x2f75a8(0x167));return{'webhook':{'url':_0xa5dc6c['webhookUrl'],'events':this[_0x2f75a8(0x160)](_0xa5dc6c[_0x2f75a8(0x15e)])}};}async['updateWebhookSettings'](_0x12cf10,_0x2147b0){const _0x528ee9=a55_0x56b708;await this[_0x528ee9(0x15b)](_0x12cf10);const _0x1533ea={};_0x2147b0['webhookUrl']!==undefined&&(_0x1533ea[_0x528ee9(0x15c)]=_0x2147b0[_0x528ee9(0x15c)]||null),_0x2147b0[_0x528ee9(0x15e)]!==undefined&&(_0x1533ea[_0x528ee9(0x15e)]=_0x2147b0[_0x528ee9(0x15e)]||[]),await database_1[_0x528ee9(0x157)]['shopSettings']['update']({'where':{'shopId':_0x12cf10},'data':_0x1533ea});}async[a55_0x56b708(0x15b)](_0x41c686){const _0x333bfa=a55_0x56b708,_0x8ef488=await database_1[_0x333bfa(0x157)]['shopSettings']['findUnique']({'where':{'shopId':_0x41c686}});!_0x8ef488&&await database_1[_0x333bfa(0x157)][_0x333bfa(0x162)][_0x333bfa(0x15f)]({'data':{'shopId':_0x41c686}});}}exports['IntegrationsService']=IntegrationsService;