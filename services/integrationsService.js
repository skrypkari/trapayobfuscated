'use strict';const a58_0x2038f1=a58_0x2f08;(function(_0x24b6bb,_0x38ed5a){const _0x30f464=a58_0x2f08,_0x1aac14=_0x24b6bb();while(!![]){try{const _0x3deaaa=parseInt(_0x30f464(0x1f3))/0x1*(-parseInt(_0x30f464(0x1ef))/0x2)+parseInt(_0x30f464(0x1e5))/0x3*(parseInt(_0x30f464(0x1f2))/0x4)+parseInt(_0x30f464(0x1e2))/0x5*(parseInt(_0x30f464(0x1f6))/0x6)+-parseInt(_0x30f464(0x1ea))/0x7*(-parseInt(_0x30f464(0x1e9))/0x8)+-parseInt(_0x30f464(0x1f7))/0x9*(-parseInt(_0x30f464(0x1e4))/0xa)+parseInt(_0x30f464(0x1e3))/0xb+parseInt(_0x30f464(0x1ee))/0xc*(-parseInt(_0x30f464(0x1e6))/0xd);if(_0x3deaaa===_0x38ed5a)break;else _0x1aac14['push'](_0x1aac14['shift']());}catch(_0x141401){_0x1aac14['push'](_0x1aac14['shift']());}}}(a58_0x1bd6,0x6d136));function a58_0x1bd6(){const _0x2f51aa=['__esModule','webhookEvents','parse','34284jvFRRI','11678mkkyiF','defineProperty','Shop\x20settings\x20not\x20found','16HpqKco','20zBnetG','shopSettings','webhookUrl','1038WpABfT','1749825yGyzDg','create','findUnique','parseWebhookEvents','updateWebhookSettings','default','IntegrationsService','24635IIyyvd','5901918WGuAIH','30bwJazd','309387YZumSa','11726HsmPmr','ensureSettingsExist','update','32TQggUc','1322769VsGSPk'];a58_0x1bd6=function(){return _0x2f51aa;};return a58_0x1bd6();}function a58_0x2f08(_0x27771a,_0x5855f4){const _0x1bd6bb=a58_0x1bd6();return a58_0x2f08=function(_0x2f0853,_0x3a0fb0){_0x2f0853=_0x2f0853-0x1e2;let _0x1d1296=_0x1bd6bb[_0x2f0853];return _0x1d1296;},a58_0x2f08(_0x27771a,_0x5855f4);}var __importDefault=this&&this['__importDefault']||function(_0x5541c5){const _0x3c5b20=a58_0x2f08;return _0x5541c5&&_0x5541c5[_0x3c5b20(0x1eb)]?_0x5541c5:{'default':_0x5541c5};};Object[a58_0x2038f1(0x1f0)](exports,'__esModule',{'value':!![]}),exports[a58_0x2038f1(0x1fd)]=void 0x0;const database_1=__importDefault(require('../config/database'));class IntegrationsService{[a58_0x2038f1(0x1fa)](_0x204d40){const _0x79b441=a58_0x2038f1;if(!_0x204d40)return[];if(Array['isArray'](_0x204d40))return _0x204d40;if(typeof _0x204d40==='string')try{const _0x196318=JSON[_0x79b441(0x1ed)](_0x204d40);return Array['isArray'](_0x196318)?_0x196318:[];}catch{return[];}return[];}async['getIntegrations'](_0x229680){const _0x459697=a58_0x2038f1;await this['ensureSettingsExist'](_0x229680);const _0x39f1e9=await database_1['default'][_0x459697(0x1f4)]['findUnique']({'where':{'shopId':_0x229680},'select':{'webhookUrl':!![],'webhookEvents':!![]}});if(!_0x39f1e9)throw new Error(_0x459697(0x1f1));return{'webhook':{'url':_0x39f1e9[_0x459697(0x1f5)],'events':this[_0x459697(0x1fa)](_0x39f1e9['webhookEvents'])}};}async[a58_0x2038f1(0x1fb)](_0x3f7619,_0x32f1c6){const _0x4be5f3=a58_0x2038f1;await this['ensureSettingsExist'](_0x3f7619);const _0x348fef={};_0x32f1c6[_0x4be5f3(0x1f5)]!==undefined&&(_0x348fef['webhookUrl']=_0x32f1c6[_0x4be5f3(0x1f5)]||null),_0x32f1c6[_0x4be5f3(0x1ec)]!==undefined&&(_0x348fef[_0x4be5f3(0x1ec)]=_0x32f1c6[_0x4be5f3(0x1ec)]||[]),await database_1[_0x4be5f3(0x1fc)][_0x4be5f3(0x1f4)][_0x4be5f3(0x1e8)]({'where':{'shopId':_0x3f7619},'data':_0x348fef});}async[a58_0x2038f1(0x1e7)](_0x4ad66f){const _0x65c585=a58_0x2038f1,_0x5f2f14=await database_1[_0x65c585(0x1fc)][_0x65c585(0x1f4)][_0x65c585(0x1f9)]({'where':{'shopId':_0x4ad66f}});!_0x5f2f14&&await database_1[_0x65c585(0x1fc)]['shopSettings'][_0x65c585(0x1f8)]({'data':{'shopId':_0x4ad66f}});}}exports[a58_0x2038f1(0x1fd)]=IntegrationsService;