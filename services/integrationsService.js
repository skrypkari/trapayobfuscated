'use strict';const a47_0x4c1c75=a47_0x1870;(function(_0x34d77d,_0x4a0a4d){const _0x4125c4=a47_0x1870,_0x17517c=_0x34d77d();while(!![]){try{const _0x359983=parseInt(_0x4125c4(0x12c))/0x1*(-parseInt(_0x4125c4(0x143))/0x2)+parseInt(_0x4125c4(0x139))/0x3*(parseInt(_0x4125c4(0x130))/0x4)+parseInt(_0x4125c4(0x131))/0x5+-parseInt(_0x4125c4(0x13d))/0x6+-parseInt(_0x4125c4(0x13b))/0x7+parseInt(_0x4125c4(0x129))/0x8*(parseInt(_0x4125c4(0x12a))/0x9)+-parseInt(_0x4125c4(0x132))/0xa*(-parseInt(_0x4125c4(0x134))/0xb);if(_0x359983===_0x4a0a4d)break;else _0x17517c['push'](_0x17517c['shift']());}catch(_0x208e2a){_0x17517c['push'](_0x17517c['shift']());}}}(a47_0x1f44,0x8ff4d));var __importDefault=this&&this[a47_0x4c1c75(0x133)]||function(_0x5a3fc3){const _0x18f462=a47_0x4c1c75;return _0x5a3fc3&&_0x5a3fc3[_0x18f462(0x135)]?_0x5a3fc3:{'default':_0x5a3fc3};};Object[a47_0x4c1c75(0x128)](exports,a47_0x4c1c75(0x135),{'value':!![]}),exports[a47_0x4c1c75(0x137)]=void 0x0;const database_1=__importDefault(require('../config/database'));function a47_0x1870(_0x56204e,_0x2e3ab8){const _0x1f446e=a47_0x1f44();return a47_0x1870=function(_0x1870f5,_0x30ad13){_0x1870f5=_0x1870f5-0x128;let _0x3045ed=_0x1f446e[_0x1870f5];return _0x3045ed;},a47_0x1870(_0x56204e,_0x2e3ab8);}class IntegrationsService{[a47_0x4c1c75(0x12b)](_0x42c762){const _0x436617=a47_0x4c1c75;if(!_0x42c762)return[];if(Array['isArray'](_0x42c762))return _0x42c762;if(typeof _0x42c762===_0x436617(0x142))try{const _0x3a68e5=JSON[_0x436617(0x13e)](_0x42c762);return Array[_0x436617(0x12f)](_0x3a68e5)?_0x3a68e5:[];}catch{return[];}return[];}async[a47_0x4c1c75(0x141)](_0x39e466){const _0x5d0691=a47_0x4c1c75;await this['ensureSettingsExist'](_0x39e466);const _0x48edec=await database_1[_0x5d0691(0x12d)][_0x5d0691(0x13c)][_0x5d0691(0x12e)]({'where':{'shopId':_0x39e466},'select':{'webhookUrl':!![],'webhookEvents':!![]}});if(!_0x48edec)throw new Error(_0x5d0691(0x136));return{'webhook':{'url':_0x48edec[_0x5d0691(0x140)],'events':this['parseWebhookEvents'](_0x48edec[_0x5d0691(0x13a)])}};}async['updateWebhookSettings'](_0x3e3c1f,_0x3e3ca8){const _0x220160=a47_0x4c1c75;await this[_0x220160(0x138)](_0x3e3c1f);const _0x15a66f={};_0x3e3ca8[_0x220160(0x140)]!==undefined&&(_0x15a66f['webhookUrl']=_0x3e3ca8[_0x220160(0x140)]||null),_0x3e3ca8[_0x220160(0x13a)]!==undefined&&(_0x15a66f[_0x220160(0x13a)]=_0x3e3ca8[_0x220160(0x13a)]||[]),await database_1[_0x220160(0x12d)][_0x220160(0x13c)][_0x220160(0x13f)]({'where':{'shopId':_0x3e3c1f},'data':_0x15a66f});}async['ensureSettingsExist'](_0x370b8d){const _0x4d5303=a47_0x4c1c75,_0x2c17da=await database_1[_0x4d5303(0x12d)]['shopSettings']['findUnique']({'where':{'shopId':_0x370b8d}});!_0x2c17da&&await database_1['default'][_0x4d5303(0x13c)]['create']({'data':{'shopId':_0x370b8d}});}}exports[a47_0x4c1c75(0x137)]=IntegrationsService;function a47_0x1f44(){const _0x1749eb=['2753274DaAcxF','parse','update','webhookUrl','getIntegrations','string','39946EuGyjR','defineProperty','153544xyDEhL','162MbCROq','parseWebhookEvents','59Dgschh','default','findUnique','isArray','4lZDHhq','1774800BmzcIF','50XgJcsP','__importDefault','2413081rPjLeD','__esModule','Shop\x20settings\x20not\x20found','IntegrationsService','ensureSettingsExist','1758084ldlIHp','webhookEvents','1094702ZxYUuw','shopSettings'];a47_0x1f44=function(){return _0x1749eb;};return a47_0x1f44();}