'use strict';const a48_0x534710=a48_0x4e21;(function(_0x3fe32b,_0x210342){const _0x5a15a4=a48_0x4e21,_0x5463dc=_0x3fe32b();while(!![]){try{const _0x55f819=-parseInt(_0x5a15a4(0x157))/0x1*(-parseInt(_0x5a15a4(0x14d))/0x2)+-parseInt(_0x5a15a4(0x152))/0x3+parseInt(_0x5a15a4(0x156))/0x4+parseInt(_0x5a15a4(0x15d))/0x5+-parseInt(_0x5a15a4(0x150))/0x6+parseInt(_0x5a15a4(0x14a))/0x7*(-parseInt(_0x5a15a4(0x146))/0x8)+-parseInt(_0x5a15a4(0x147))/0x9*(-parseInt(_0x5a15a4(0x148))/0xa);if(_0x55f819===_0x210342)break;else _0x5463dc['push'](_0x5463dc['shift']());}catch(_0x287748){_0x5463dc['push'](_0x5463dc['shift']());}}}(a48_0x2903,0x36e9c));var __importDefault=this&&this[a48_0x534710(0x14b)]||function(_0x114097){const _0x217fdf=a48_0x534710;return _0x114097&&_0x114097[_0x217fdf(0x15c)]?_0x114097:{'default':_0x114097};};function a48_0x2903(){const _0x5b3b00=['defineProperty','isArray','ensureSettingsExist','updateWebhookSettings','__esModule','1965245rMKZoI','create','2481208BhmKCh','135wuuHBA','87880zBmELs','getIntegrations','7yOTLET','__importDefault','webhookUrl','788uGKqHR','shopSettings','IntegrationsService','1927974WTzXni','default','224685qHOJPw','webhookEvents','parseWebhookEvents','findUnique','331824CGRDoW','821Knjmkp'];a48_0x2903=function(){return _0x5b3b00;};return a48_0x2903();}Object[a48_0x534710(0x158)](exports,a48_0x534710(0x15c),{'value':!![]}),exports[a48_0x534710(0x14f)]=void 0x0;function a48_0x4e21(_0x3d2f49,_0x3c47e7){const _0x29038c=a48_0x2903();return a48_0x4e21=function(_0x4e21d9,_0x3761d8){_0x4e21d9=_0x4e21d9-0x146;let _0x379753=_0x29038c[_0x4e21d9];return _0x379753;},a48_0x4e21(_0x3d2f49,_0x3c47e7);}const database_1=__importDefault(require('../config/database'));class IntegrationsService{[a48_0x534710(0x154)](_0x40cb4d){const _0x132684=a48_0x534710;if(!_0x40cb4d)return[];if(Array[_0x132684(0x159)](_0x40cb4d))return _0x40cb4d;if(typeof _0x40cb4d==='string')try{const _0x258d98=JSON['parse'](_0x40cb4d);return Array[_0x132684(0x159)](_0x258d98)?_0x258d98:[];}catch{return[];}return[];}async[a48_0x534710(0x149)](_0x595bea){const _0x188d54=a48_0x534710;await this[_0x188d54(0x15a)](_0x595bea);const _0x5bb23f=await database_1[_0x188d54(0x151)][_0x188d54(0x14e)][_0x188d54(0x155)]({'where':{'shopId':_0x595bea},'select':{'webhookUrl':!![],'webhookEvents':!![]}});if(!_0x5bb23f)throw new Error('Shop\x20settings\x20not\x20found');return{'webhook':{'url':_0x5bb23f['webhookUrl'],'events':this[_0x188d54(0x154)](_0x5bb23f[_0x188d54(0x153)])}};}async[a48_0x534710(0x15b)](_0x7ba355,_0x45b1c4){const _0xeaa21=a48_0x534710;await this['ensureSettingsExist'](_0x7ba355);const _0x12c406={};_0x45b1c4[_0xeaa21(0x14c)]!==undefined&&(_0x12c406[_0xeaa21(0x14c)]=_0x45b1c4[_0xeaa21(0x14c)]||null),_0x45b1c4[_0xeaa21(0x153)]!==undefined&&(_0x12c406[_0xeaa21(0x153)]=_0x45b1c4[_0xeaa21(0x153)]||[]),await database_1[_0xeaa21(0x151)][_0xeaa21(0x14e)]['update']({'where':{'shopId':_0x7ba355},'data':_0x12c406});}async[a48_0x534710(0x15a)](_0x11ea4e){const _0x3431f8=a48_0x534710,_0x548899=await database_1[_0x3431f8(0x151)][_0x3431f8(0x14e)][_0x3431f8(0x155)]({'where':{'shopId':_0x11ea4e}});!_0x548899&&await database_1[_0x3431f8(0x151)][_0x3431f8(0x14e)][_0x3431f8(0x15e)]({'data':{'shopId':_0x11ea4e}});}}exports[a48_0x534710(0x14f)]=IntegrationsService;