'use strict';const a47_0x182c4b=a47_0x5c16;(function(_0x4cb888,_0x4e3674){const _0x418d76=a47_0x5c16,_0x48545d=_0x4cb888();while(!![]){try{const _0x35ab5f=-parseInt(_0x418d76(0x1a1))/0x1+parseInt(_0x418d76(0x192))/0x2*(parseInt(_0x418d76(0x199))/0x3)+-parseInt(_0x418d76(0x1a0))/0x4+parseInt(_0x418d76(0x19a))/0x5*(parseInt(_0x418d76(0x18b))/0x6)+parseInt(_0x418d76(0x18c))/0x7*(parseInt(_0x418d76(0x19c))/0x8)+parseInt(_0x418d76(0x19d))/0x9+parseInt(_0x418d76(0x18a))/0xa;if(_0x35ab5f===_0x4e3674)break;else _0x48545d['push'](_0x48545d['shift']());}catch(_0x2970c9){_0x48545d['push'](_0x48545d['shift']());}}}(a47_0x3c0e,0x781c1));function a47_0x3c0e(){const _0x5ab70c=['192678CoBZpt','2935280WBAWud','parse','632qwAglD','6239106pXvdWt','update','shopSettings','1274980NnCtRx','876908PmJxVG','761650duGNMA','6YiKKFn','23653JFAkcZ','default','parseWebhookEvents','defineProperty','isArray','webhookEvents','2LRIGXe','getIntegrations','webhookUrl','__esModule','IntegrationsService','findUnique','ensureSettingsExist'];a47_0x3c0e=function(){return _0x5ab70c;};return a47_0x3c0e();}function a47_0x5c16(_0x2cf8da,_0x431186){const _0x3c0ecd=a47_0x3c0e();return a47_0x5c16=function(_0x5c166d,_0x4f4feb){_0x5c166d=_0x5c166d-0x18a;let _0xb835bc=_0x3c0ecd[_0x5c166d];return _0xb835bc;},a47_0x5c16(_0x2cf8da,_0x431186);}var __importDefault=this&&this['__importDefault']||function(_0x4cf45c){const _0x3f44d5=a47_0x5c16;return _0x4cf45c&&_0x4cf45c[_0x3f44d5(0x195)]?_0x4cf45c:{'default':_0x4cf45c};};Object[a47_0x182c4b(0x18f)](exports,a47_0x182c4b(0x195),{'value':!![]}),exports['IntegrationsService']=void 0x0;const database_1=__importDefault(require('../config/database'));class IntegrationsService{[a47_0x182c4b(0x18e)](_0x285ce8){const _0x2123a7=a47_0x182c4b;if(!_0x285ce8)return[];if(Array[_0x2123a7(0x190)](_0x285ce8))return _0x285ce8;if(typeof _0x285ce8==='string')try{const _0x42a911=JSON[_0x2123a7(0x19b)](_0x285ce8);return Array[_0x2123a7(0x190)](_0x42a911)?_0x42a911:[];}catch{return[];}return[];}async[a47_0x182c4b(0x193)](_0x19a53e){const _0x3f330f=a47_0x182c4b;await this['ensureSettingsExist'](_0x19a53e);const _0x2f2f10=await database_1['default'][_0x3f330f(0x19f)][_0x3f330f(0x197)]({'where':{'shopId':_0x19a53e},'select':{'webhookUrl':!![],'webhookEvents':!![]}});if(!_0x2f2f10)throw new Error('Shop\x20settings\x20not\x20found');return{'webhook':{'url':_0x2f2f10[_0x3f330f(0x194)],'events':this[_0x3f330f(0x18e)](_0x2f2f10['webhookEvents'])}};}async['updateWebhookSettings'](_0x2ff259,_0x13ac83){const _0x3ac437=a47_0x182c4b;await this[_0x3ac437(0x198)](_0x2ff259);const _0x12a531={};_0x13ac83['webhookUrl']!==undefined&&(_0x12a531[_0x3ac437(0x194)]=_0x13ac83['webhookUrl']||null),_0x13ac83[_0x3ac437(0x191)]!==undefined&&(_0x12a531[_0x3ac437(0x191)]=_0x13ac83[_0x3ac437(0x191)]||[]),await database_1[_0x3ac437(0x18d)][_0x3ac437(0x19f)][_0x3ac437(0x19e)]({'where':{'shopId':_0x2ff259},'data':_0x12a531});}async['ensureSettingsExist'](_0x33ac4c){const _0x55dbc0=a47_0x182c4b,_0x37e425=await database_1[_0x55dbc0(0x18d)]['shopSettings'][_0x55dbc0(0x197)]({'where':{'shopId':_0x33ac4c}});!_0x37e425&&await database_1[_0x55dbc0(0x18d)][_0x55dbc0(0x19f)]['create']({'data':{'shopId':_0x33ac4c}});}}exports[a47_0x182c4b(0x196)]=IntegrationsService;