'use strict';const a48_0x40e516=a48_0x1ca2;(function(_0x3af7d9,_0x2ea1ad){const _0x2179d6=a48_0x1ca2,_0x292a78=_0x3af7d9();while(!![]){try{const _0x405203=parseInt(_0x2179d6(0x1d8))/0x1*(-parseInt(_0x2179d6(0x1cd))/0x2)+parseInt(_0x2179d6(0x1df))/0x3*(-parseInt(_0x2179d6(0x1d7))/0x4)+parseInt(_0x2179d6(0x1ce))/0x5+-parseInt(_0x2179d6(0x1d4))/0x6*(-parseInt(_0x2179d6(0x1db))/0x7)+parseInt(_0x2179d6(0x1de))/0x8*(-parseInt(_0x2179d6(0x1d0))/0x9)+parseInt(_0x2179d6(0x1ca))/0xa*(parseInt(_0x2179d6(0x1d3))/0xb)+parseInt(_0x2179d6(0x1da))/0xc*(parseInt(_0x2179d6(0x1c7))/0xd);if(_0x405203===_0x2ea1ad)break;else _0x292a78['push'](_0x292a78['shift']());}catch(_0x414502){_0x292a78['push'](_0x292a78['shift']());}}}(a48_0x56b4,0x84d10));function a48_0x56b4(){const _0x5f4911=['38ZMLdKo','4030265aCGkZB','update','1157238VaaqMb','findUnique','webhookUrl','11Rextis','18ohnEsY','webhookEvents','updateWebhookSettings','1157496aGQmDq','22543Mzffye','parse','19428612YHLLsA','1026004isDkat','default','defineProperty','64UXBqxp','9YSxIBc','__importDefault','../config/database','parseWebhookEvents','shopSettings','create','13mqMrVN','ensureSettingsExist','Shop\x20settings\x20not\x20found','42910xRYhCM','string','IntegrationsService'];a48_0x56b4=function(){return _0x5f4911;};return a48_0x56b4();}var __importDefault=this&&this[a48_0x40e516(0x1e0)]||function(_0x38d14b){return _0x38d14b&&_0x38d14b['__esModule']?_0x38d14b:{'default':_0x38d14b};};Object[a48_0x40e516(0x1dd)](exports,'__esModule',{'value':!![]}),exports[a48_0x40e516(0x1cc)]=void 0x0;function a48_0x1ca2(_0x1cf9ad,_0x5d3bd7){const _0x56b481=a48_0x56b4();return a48_0x1ca2=function(_0x1ca29b,_0x3c013e){_0x1ca29b=_0x1ca29b-0x1c3;let _0x46a740=_0x56b481[_0x1ca29b];return _0x46a740;},a48_0x1ca2(_0x1cf9ad,_0x5d3bd7);}const database_1=__importDefault(require(a48_0x40e516(0x1c3)));class IntegrationsService{[a48_0x40e516(0x1c4)](_0x447fa1){const _0xb15e02=a48_0x40e516;if(!_0x447fa1)return[];if(Array['isArray'](_0x447fa1))return _0x447fa1;if(typeof _0x447fa1===_0xb15e02(0x1cb))try{const _0x4639ce=JSON[_0xb15e02(0x1d9)](_0x447fa1);return Array['isArray'](_0x4639ce)?_0x4639ce:[];}catch{return[];}return[];}async['getIntegrations'](_0xae7af){const _0x30fdf7=a48_0x40e516;await this['ensureSettingsExist'](_0xae7af);const _0x17189a=await database_1['default'][_0x30fdf7(0x1c5)][_0x30fdf7(0x1d1)]({'where':{'shopId':_0xae7af},'select':{'webhookUrl':!![],'webhookEvents':!![]}});if(!_0x17189a)throw new Error(_0x30fdf7(0x1c9));return{'webhook':{'url':_0x17189a[_0x30fdf7(0x1d2)],'events':this['parseWebhookEvents'](_0x17189a[_0x30fdf7(0x1d5)])}};}async[a48_0x40e516(0x1d6)](_0x4c81c1,_0xe28b90){const _0x142ad8=a48_0x40e516;await this[_0x142ad8(0x1c8)](_0x4c81c1);const _0x76a895={};_0xe28b90[_0x142ad8(0x1d2)]!==undefined&&(_0x76a895['webhookUrl']=_0xe28b90['webhookUrl']||null),_0xe28b90[_0x142ad8(0x1d5)]!==undefined&&(_0x76a895[_0x142ad8(0x1d5)]=_0xe28b90['webhookEvents']||[]),await database_1[_0x142ad8(0x1dc)][_0x142ad8(0x1c5)][_0x142ad8(0x1cf)]({'where':{'shopId':_0x4c81c1},'data':_0x76a895});}async[a48_0x40e516(0x1c8)](_0x2e6d85){const _0x102b4b=a48_0x40e516,_0x3fac6b=await database_1['default'][_0x102b4b(0x1c5)][_0x102b4b(0x1d1)]({'where':{'shopId':_0x2e6d85}});!_0x3fac6b&&await database_1['default']['shopSettings'][_0x102b4b(0x1c6)]({'data':{'shopId':_0x2e6d85}});}}exports[a48_0x40e516(0x1cc)]=IntegrationsService;