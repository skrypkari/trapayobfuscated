'use strict';const a78_0x45bce2=a78_0x22b5;(function(_0x277152,_0x352f78){const _0x701e48=a78_0x22b5,_0x2fdebd=_0x277152();while(!![]){try{const _0x869278=-parseInt(_0x701e48(0x1fb))/0x1+parseInt(_0x701e48(0x1fe))/0x2+-parseInt(_0x701e48(0x1e9))/0x3+parseInt(_0x701e48(0x1f1))/0x4*(parseInt(_0x701e48(0x1e8))/0x5)+parseInt(_0x701e48(0x1f3))/0x6*(parseInt(_0x701e48(0x1ee))/0x7)+-parseInt(_0x701e48(0x1f2))/0x8*(parseInt(_0x701e48(0x1ed))/0x9)+parseInt(_0x701e48(0x1f9))/0xa*(parseInt(_0x701e48(0x1fd))/0xb);if(_0x869278===_0x352f78)break;else _0x2fdebd['push'](_0x2fdebd['shift']());}catch(_0x3d2221){_0x2fdebd['push'](_0x2fdebd['shift']());}}}(a78_0xdbaf,0x37395));function a78_0xdbaf(){const _0x266110=['create','isArray','170xJTRdy','default','322765upEGGJ','__esModule','13948xetPDz','638508eqcJxc','updateWebhookSettings','../config/database','parse','defineProperty','getIntegrations','webhookUrl','2067555ftmtyQ','1089105ZmGlMZ','parseWebhookEvents','findUnique','shopSettings','248004bcxOmu','73864nbPLSA','ensureSettingsExist','IntegrationsService','4UUyTRq','40McJrNb','168ZgARIZ','string','webhookEvents','__importDefault'];a78_0xdbaf=function(){return _0x266110;};return a78_0xdbaf();}var __importDefault=this&&this[a78_0x45bce2(0x1f6)]||function(_0x40a01){const _0x246dde=a78_0x45bce2;return _0x40a01&&_0x40a01[_0x246dde(0x1fc)]?_0x40a01:{'default':_0x40a01};};Object[a78_0x45bce2(0x202)](exports,a78_0x45bce2(0x1fc),{'value':!![]}),exports['IntegrationsService']=void 0x0;function a78_0x22b5(_0x52cb64,_0x14ae6d){_0x52cb64=_0x52cb64-0x1e7;const _0xdbafb0=a78_0xdbaf();let _0x22b503=_0xdbafb0[_0x52cb64];return _0x22b503;}const database_1=__importDefault(require(a78_0x45bce2(0x200)));class IntegrationsService{[a78_0x45bce2(0x1ea)](_0x7034d6){const _0x8d0a11=a78_0x45bce2;if(!_0x7034d6)return[];if(Array[_0x8d0a11(0x1f8)](_0x7034d6))return _0x7034d6;if(typeof _0x7034d6===_0x8d0a11(0x1f4))try{const _0x14daa3=JSON[_0x8d0a11(0x201)](_0x7034d6);return Array[_0x8d0a11(0x1f8)](_0x14daa3)?_0x14daa3:[];}catch{return[];}return[];}async[a78_0x45bce2(0x203)](_0x5bc529){const _0x47dde4=a78_0x45bce2;await this['ensureSettingsExist'](_0x5bc529);const _0x22c14d=await database_1[_0x47dde4(0x1fa)]['shopSettings']['findUnique']({'where':{'shopId':_0x5bc529},'select':{'webhookUrl':!![],'webhookEvents':!![]}});if(!_0x22c14d)throw new Error('Shop\x20settings\x20not\x20found');return{'webhook':{'url':_0x22c14d[_0x47dde4(0x1e7)],'events':this[_0x47dde4(0x1ea)](_0x22c14d[_0x47dde4(0x1f5)])}};}async[a78_0x45bce2(0x1ff)](_0x37d201,_0x2095ae){const _0x1dad75=a78_0x45bce2;await this['ensureSettingsExist'](_0x37d201);const _0x4e3437={};_0x2095ae[_0x1dad75(0x1e7)]!==undefined&&(_0x4e3437[_0x1dad75(0x1e7)]=_0x2095ae[_0x1dad75(0x1e7)]||null),_0x2095ae[_0x1dad75(0x1f5)]!==undefined&&(_0x4e3437[_0x1dad75(0x1f5)]=_0x2095ae[_0x1dad75(0x1f5)]||[]),await database_1['default']['shopSettings']['update']({'where':{'shopId':_0x37d201},'data':_0x4e3437});}async[a78_0x45bce2(0x1ef)](_0x5eea64){const _0x1e62fe=a78_0x45bce2,_0x429458=await database_1[_0x1e62fe(0x1fa)][_0x1e62fe(0x1ec)][_0x1e62fe(0x1eb)]({'where':{'shopId':_0x5eea64}});!_0x429458&&await database_1[_0x1e62fe(0x1fa)][_0x1e62fe(0x1ec)][_0x1e62fe(0x1f7)]({'data':{'shopId':_0x5eea64}});}}exports[a78_0x45bce2(0x1f0)]=IntegrationsService;