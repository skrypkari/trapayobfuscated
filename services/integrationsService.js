'use strict';const a52_0xd297b2=a52_0xa408;(function(_0x278008,_0x40d373){const _0xfcf130=a52_0xa408,_0x2df83b=_0x278008();while(!![]){try{const _0xdf0ca4=-parseInt(_0xfcf130(0x143))/0x1+-parseInt(_0xfcf130(0x14f))/0x2*(parseInt(_0xfcf130(0x14e))/0x3)+-parseInt(_0xfcf130(0x14d))/0x4+parseInt(_0xfcf130(0x148))/0x5+-parseInt(_0xfcf130(0x13e))/0x6+parseInt(_0xfcf130(0x13b))/0x7+parseInt(_0xfcf130(0x152))/0x8;if(_0xdf0ca4===_0x40d373)break;else _0x2df83b['push'](_0x2df83b['shift']());}catch(_0x4c44e7){_0x2df83b['push'](_0x2df83b['shift']());}}}(a52_0xc1bd,0x257a9));var __importDefault=this&&this[a52_0xd297b2(0x13a)]||function(_0x4087f8){const _0x3c68ae=a52_0xd297b2;return _0x4087f8&&_0x4087f8[_0x3c68ae(0x13f)]?_0x4087f8:{'default':_0x4087f8};};function a52_0xa408(_0x4599a2,_0x534078){const _0xc1bd58=a52_0xc1bd();return a52_0xa408=function(_0xa4081a,_0x1752ab){_0xa4081a=_0xa4081a-0x13a;let _0x3467d5=_0xc1bd58[_0xa4081a];return _0x3467d5;},a52_0xa408(_0x4599a2,_0x534078);}Object[a52_0xd297b2(0x147)](exports,a52_0xd297b2(0x13f),{'value':!![]}),exports[a52_0xd297b2(0x141)]=void 0x0;const database_1=__importDefault(require(a52_0xd297b2(0x13d)));function a52_0xc1bd(){const _0x4525c4=['isArray','215232eSJwUY','15gzyRkg','4630nzuzdU','webhookUrl','string','2165800xkxAEy','findUnique','getIntegrations','__importDefault','2047255kwTbqR','create','../config/database','1192158nQacoF','__esModule','update','IntegrationsService','parse','190604dwcTUp','Shop\x20settings\x20not\x20found','updateWebhookSettings','shopSettings','defineProperty','225015uddWbw','webhookEvents','ensureSettingsExist','default'];a52_0xc1bd=function(){return _0x4525c4;};return a52_0xc1bd();}class IntegrationsService{['parseWebhookEvents'](_0x4f02ae){const _0x2ad933=a52_0xd297b2;if(!_0x4f02ae)return[];if(Array['isArray'](_0x4f02ae))return _0x4f02ae;if(typeof _0x4f02ae===_0x2ad933(0x151))try{const _0x47fb3e=JSON[_0x2ad933(0x142)](_0x4f02ae);return Array[_0x2ad933(0x14c)](_0x47fb3e)?_0x47fb3e:[];}catch{return[];}return[];}async[a52_0xd297b2(0x154)](_0x48867f){const _0x2b5ccc=a52_0xd297b2;await this[_0x2b5ccc(0x14a)](_0x48867f);const _0x52f0b6=await database_1[_0x2b5ccc(0x14b)][_0x2b5ccc(0x146)][_0x2b5ccc(0x153)]({'where':{'shopId':_0x48867f},'select':{'webhookUrl':!![],'webhookEvents':!![]}});if(!_0x52f0b6)throw new Error(_0x2b5ccc(0x144));return{'webhook':{'url':_0x52f0b6['webhookUrl'],'events':this['parseWebhookEvents'](_0x52f0b6[_0x2b5ccc(0x149)])}};}async[a52_0xd297b2(0x145)](_0x4cf37f,_0x4a9a54){const _0x31b5e1=a52_0xd297b2;await this[_0x31b5e1(0x14a)](_0x4cf37f);const _0x3aa802={};_0x4a9a54[_0x31b5e1(0x150)]!==undefined&&(_0x3aa802['webhookUrl']=_0x4a9a54['webhookUrl']||null),_0x4a9a54[_0x31b5e1(0x149)]!==undefined&&(_0x3aa802[_0x31b5e1(0x149)]=_0x4a9a54[_0x31b5e1(0x149)]||[]),await database_1[_0x31b5e1(0x14b)][_0x31b5e1(0x146)][_0x31b5e1(0x140)]({'where':{'shopId':_0x4cf37f},'data':_0x3aa802});}async[a52_0xd297b2(0x14a)](_0x17e78e){const _0x309167=a52_0xd297b2,_0x46d14c=await database_1[_0x309167(0x14b)]['shopSettings'][_0x309167(0x153)]({'where':{'shopId':_0x17e78e}});!_0x46d14c&&await database_1[_0x309167(0x14b)][_0x309167(0x146)][_0x309167(0x13c)]({'data':{'shopId':_0x17e78e}});}}exports[a52_0xd297b2(0x141)]=IntegrationsService;