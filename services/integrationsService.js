'use strict';function a58_0x2e17(_0x1c9dd0,_0x2acd7f){const _0x214878=a58_0x2148();return a58_0x2e17=function(_0x2e17f9,_0x2b4103){_0x2e17f9=_0x2e17f9-0xff;let _0x4b641a=_0x214878[_0x2e17f9];return _0x4b641a;},a58_0x2e17(_0x1c9dd0,_0x2acd7f);}const a58_0x3c9457=a58_0x2e17;(function(_0x3c850f,_0x4c0e9d){const _0x257204=a58_0x2e17,_0x434a3b=_0x3c850f();while(!![]){try{const _0x719290=-parseInt(_0x257204(0x114))/0x1+-parseInt(_0x257204(0x103))/0x2*(-parseInt(_0x257204(0x10d))/0x3)+-parseInt(_0x257204(0x116))/0x4+-parseInt(_0x257204(0x108))/0x5*(-parseInt(_0x257204(0x104))/0x6)+-parseInt(_0x257204(0x117))/0x7+parseInt(_0x257204(0x10b))/0x8*(parseInt(_0x257204(0xff))/0x9)+-parseInt(_0x257204(0x109))/0xa*(-parseInt(_0x257204(0x10a))/0xb);if(_0x719290===_0x4c0e9d)break;else _0x434a3b['push'](_0x434a3b['shift']());}catch(_0x413b48){_0x434a3b['push'](_0x434a3b['shift']());}}}(a58_0x2148,0x338b1));function a58_0x2148(){const _0x46611d=['string','85wIAMBY','1067330IEKvsd','11sPKObB','12856mhaEuE','shopSettings','21zIOQVh','webhookUrl','IntegrationsService','__esModule','ensureSettingsExist','create','defineProperty','204325CHgjNZ','getIntegrations','131660qifsVu','1179171RYAzwd','isArray','parse','findUnique','../config/database','801TCBLgK','updateWebhookSettings','__importDefault','update','93678ZncfUv','13830xjGeVT','webhookEvents','default'];a58_0x2148=function(){return _0x46611d;};return a58_0x2148();}var __importDefault=this&&this[a58_0x3c9457(0x101)]||function(_0x364bb8){const _0x124b5f=a58_0x3c9457;return _0x364bb8&&_0x364bb8[_0x124b5f(0x110)]?_0x364bb8:{'default':_0x364bb8};};Object[a58_0x3c9457(0x113)](exports,a58_0x3c9457(0x110),{'value':!![]}),exports[a58_0x3c9457(0x10f)]=void 0x0;const database_1=__importDefault(require(a58_0x3c9457(0x11b)));class IntegrationsService{['parseWebhookEvents'](_0xc9d6bf){const _0x10a837=a58_0x3c9457;if(!_0xc9d6bf)return[];if(Array[_0x10a837(0x118)](_0xc9d6bf))return _0xc9d6bf;if(typeof _0xc9d6bf===_0x10a837(0x107))try{const _0x3f5117=JSON[_0x10a837(0x119)](_0xc9d6bf);return Array['isArray'](_0x3f5117)?_0x3f5117:[];}catch{return[];}return[];}async[a58_0x3c9457(0x115)](_0x3d210f){const _0x50fc53=a58_0x3c9457;await this[_0x50fc53(0x111)](_0x3d210f);const _0x198905=await database_1[_0x50fc53(0x106)][_0x50fc53(0x10c)][_0x50fc53(0x11a)]({'where':{'shopId':_0x3d210f},'select':{'webhookUrl':!![],'webhookEvents':!![]}});if(!_0x198905)throw new Error('Shop\x20settings\x20not\x20found');return{'webhook':{'url':_0x198905[_0x50fc53(0x10e)],'events':this['parseWebhookEvents'](_0x198905[_0x50fc53(0x105)])}};}async[a58_0x3c9457(0x100)](_0x3d5729,_0x575a23){const _0x19616f=a58_0x3c9457;await this[_0x19616f(0x111)](_0x3d5729);const _0x40b83f={};_0x575a23['webhookUrl']!==undefined&&(_0x40b83f[_0x19616f(0x10e)]=_0x575a23['webhookUrl']||null),_0x575a23[_0x19616f(0x105)]!==undefined&&(_0x40b83f[_0x19616f(0x105)]=_0x575a23['webhookEvents']||[]),await database_1[_0x19616f(0x106)][_0x19616f(0x10c)][_0x19616f(0x102)]({'where':{'shopId':_0x3d5729},'data':_0x40b83f});}async[a58_0x3c9457(0x111)](_0x23d295){const _0x1e8648=a58_0x3c9457,_0x59a423=await database_1['default'][_0x1e8648(0x10c)][_0x1e8648(0x11a)]({'where':{'shopId':_0x23d295}});!_0x59a423&&await database_1[_0x1e8648(0x106)][_0x1e8648(0x10c)][_0x1e8648(0x112)]({'data':{'shopId':_0x23d295}});}}exports[a58_0x3c9457(0x10f)]=IntegrationsService;