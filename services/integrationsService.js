'use strict';const a58_0x48fcf3=a58_0x3f51;(function(_0x4a11cf,_0x4d50fa){const _0x395d9e=a58_0x3f51,_0x2a7606=_0x4a11cf();while(!![]){try{const _0x534782=parseInt(_0x395d9e(0x84))/0x1+-parseInt(_0x395d9e(0x83))/0x2+-parseInt(_0x395d9e(0x8c))/0x3+parseInt(_0x395d9e(0x8a))/0x4*(parseInt(_0x395d9e(0x86))/0x5)+-parseInt(_0x395d9e(0x85))/0x6+parseInt(_0x395d9e(0x88))/0x7+-parseInt(_0x395d9e(0x90))/0x8;if(_0x534782===_0x4d50fa)break;else _0x2a7606['push'](_0x2a7606['shift']());}catch(_0x2419f2){_0x2a7606['push'](_0x2a7606['shift']());}}}(a58_0x5d9d,0xc8306));var __importDefault=this&&this[a58_0x48fcf3(0x7f)]||function(_0xf1f5e7){const _0x55c90a=a58_0x48fcf3;return _0xf1f5e7&&_0xf1f5e7[_0x55c90a(0x79)]?_0xf1f5e7:{'default':_0xf1f5e7};};Object[a58_0x48fcf3(0x76)](exports,a58_0x48fcf3(0x79),{'value':!![]}),exports[a58_0x48fcf3(0x7c)]=void 0x0;function a58_0x3f51(_0x283cea,_0xe5c06c){const _0x5d9dec=a58_0x5d9d();return a58_0x3f51=function(_0x3f51e3,_0x1aa43e){_0x3f51e3=_0x3f51e3-0x76;let _0x549461=_0x5d9dec[_0x3f51e3];return _0x549461;},a58_0x3f51(_0x283cea,_0xe5c06c);}function a58_0x5d9d(){const _0x2e6a3e=['182220srSlZT','1128668vfUWZD','6227658aolYuk','7514980IgQxID','Shop\x20settings\x20not\x20found','4550679rYvvhx','findUnique','4xBSbyo','parse','1479489NZwztr','create','update','getIntegrations','6716568rmrvWH','defineProperty','webhookUrl','string','__esModule','webhookEvents','shopSettings','IntegrationsService','default','isArray','__importDefault','parseWebhookEvents','ensureSettingsExist','../config/database'];a58_0x5d9d=function(){return _0x2e6a3e;};return a58_0x5d9d();}const database_1=__importDefault(require(a58_0x48fcf3(0x82)));class IntegrationsService{[a58_0x48fcf3(0x80)](_0x11a34e){const _0x352185=a58_0x48fcf3;if(!_0x11a34e)return[];if(Array[_0x352185(0x7e)](_0x11a34e))return _0x11a34e;if(typeof _0x11a34e===_0x352185(0x78))try{const _0x5c76ba=JSON[_0x352185(0x8b)](_0x11a34e);return Array[_0x352185(0x7e)](_0x5c76ba)?_0x5c76ba:[];}catch{return[];}return[];}async[a58_0x48fcf3(0x8f)](_0x2fc908){const _0xae4af1=a58_0x48fcf3;await this[_0xae4af1(0x81)](_0x2fc908);const _0x5f159c=await database_1['default'][_0xae4af1(0x7b)][_0xae4af1(0x89)]({'where':{'shopId':_0x2fc908},'select':{'webhookUrl':!![],'webhookEvents':!![]}});if(!_0x5f159c)throw new Error(_0xae4af1(0x87));return{'webhook':{'url':_0x5f159c[_0xae4af1(0x77)],'events':this[_0xae4af1(0x80)](_0x5f159c[_0xae4af1(0x7a)])}};}async['updateWebhookSettings'](_0x4fb137,_0x4937da){const _0x21b753=a58_0x48fcf3;await this[_0x21b753(0x81)](_0x4fb137);const _0x4c971a={};_0x4937da['webhookUrl']!==undefined&&(_0x4c971a[_0x21b753(0x77)]=_0x4937da[_0x21b753(0x77)]||null),_0x4937da['webhookEvents']!==undefined&&(_0x4c971a[_0x21b753(0x7a)]=_0x4937da['webhookEvents']||[]),await database_1[_0x21b753(0x7d)][_0x21b753(0x7b)][_0x21b753(0x8e)]({'where':{'shopId':_0x4fb137},'data':_0x4c971a});}async[a58_0x48fcf3(0x81)](_0x4d9e3d){const _0x17a337=a58_0x48fcf3,_0xaead3f=await database_1[_0x17a337(0x7d)][_0x17a337(0x7b)][_0x17a337(0x89)]({'where':{'shopId':_0x4d9e3d}});!_0xaead3f&&await database_1[_0x17a337(0x7d)]['shopSettings'][_0x17a337(0x8d)]({'data':{'shopId':_0x4d9e3d}});}}exports['IntegrationsService']=IntegrationsService;