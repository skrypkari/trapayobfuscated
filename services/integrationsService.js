'use strict';const a54_0x2e9cb7=a54_0x446d;(function(_0x233a51,_0xcb7a4b){const _0x380b0d=a54_0x446d,_0x5bcec2=_0x233a51();while(!![]){try{const _0x3f432e=parseInt(_0x380b0d(0x84))/0x1+-parseInt(_0x380b0d(0x78))/0x2*(-parseInt(_0x380b0d(0x87))/0x3)+parseInt(_0x380b0d(0x7a))/0x4+parseInt(_0x380b0d(0x8e))/0x5*(-parseInt(_0x380b0d(0x8b))/0x6)+-parseInt(_0x380b0d(0x7e))/0x7+-parseInt(_0x380b0d(0x79))/0x8+parseInt(_0x380b0d(0x7c))/0x9;if(_0x3f432e===_0xcb7a4b)break;else _0x5bcec2['push'](_0x5bcec2['shift']());}catch(_0x1b5d07){_0x5bcec2['push'](_0x5bcec2['shift']());}}}(a54_0x4197,0x7ea82));var __importDefault=this&&this[a54_0x2e9cb7(0x80)]||function(_0x45a121){const _0x4c9599=a54_0x2e9cb7;return _0x45a121&&_0x45a121[_0x4c9599(0x82)]?_0x45a121:{'default':_0x45a121};};function a54_0x446d(_0x36aa37,_0x4e48f2){const _0x4197a6=a54_0x4197();return a54_0x446d=function(_0x446d6c,_0x3d3408){_0x446d6c=_0x446d6c-0x78;let _0x3b344a=_0x4197a6[_0x446d6c];return _0x3b344a;},a54_0x446d(_0x36aa37,_0x4e48f2);}Object[a54_0x2e9cb7(0x8d)](exports,'__esModule',{'value':!![]}),exports[a54_0x2e9cb7(0x8a)]=void 0x0;function a54_0x4197(){const _0x1e6b10=['webhookEvents','415981HlkfdQ','update','Shop\x20settings\x20not\x20found','1284ueADYw','ensureSettingsExist','parseWebhookEvents','IntegrationsService','54zbghgK','parse','defineProperty','175330tsBHea','string','default','4516bpTGYa','3295144ZJieQH','797072oQPtvM','shopSettings','3301236IDGjrQ','findUnique','4915428tbWzah','isArray','__importDefault','webhookUrl','__esModule'];a54_0x4197=function(){return _0x1e6b10;};return a54_0x4197();}const database_1=__importDefault(require('../config/database'));class IntegrationsService{[a54_0x2e9cb7(0x89)](_0x2b5694){const _0x2f2587=a54_0x2e9cb7;if(!_0x2b5694)return[];if(Array[_0x2f2587(0x7f)](_0x2b5694))return _0x2b5694;if(typeof _0x2b5694===_0x2f2587(0x8f))try{const _0x452add=JSON[_0x2f2587(0x8c)](_0x2b5694);return Array[_0x2f2587(0x7f)](_0x452add)?_0x452add:[];}catch{return[];}return[];}async['getIntegrations'](_0x1d6028){const _0x88c800=a54_0x2e9cb7;await this[_0x88c800(0x88)](_0x1d6028);const _0x1b07b8=await database_1[_0x88c800(0x90)][_0x88c800(0x7b)][_0x88c800(0x7d)]({'where':{'shopId':_0x1d6028},'select':{'webhookUrl':!![],'webhookEvents':!![]}});if(!_0x1b07b8)throw new Error(_0x88c800(0x86));return{'webhook':{'url':_0x1b07b8[_0x88c800(0x81)],'events':this[_0x88c800(0x89)](_0x1b07b8[_0x88c800(0x83)])}};}async['updateWebhookSettings'](_0x236c5e,_0x19242b){const _0x3c347e=a54_0x2e9cb7;await this[_0x3c347e(0x88)](_0x236c5e);const _0xbf91b1={};_0x19242b[_0x3c347e(0x81)]!==undefined&&(_0xbf91b1[_0x3c347e(0x81)]=_0x19242b[_0x3c347e(0x81)]||null),_0x19242b[_0x3c347e(0x83)]!==undefined&&(_0xbf91b1['webhookEvents']=_0x19242b['webhookEvents']||[]),await database_1[_0x3c347e(0x90)][_0x3c347e(0x7b)][_0x3c347e(0x85)]({'where':{'shopId':_0x236c5e},'data':_0xbf91b1});}async[a54_0x2e9cb7(0x88)](_0x35bb6){const _0x6065a1=a54_0x2e9cb7,_0x5338f1=await database_1[_0x6065a1(0x90)][_0x6065a1(0x7b)]['findUnique']({'where':{'shopId':_0x35bb6}});!_0x5338f1&&await database_1[_0x6065a1(0x90)][_0x6065a1(0x7b)]['create']({'data':{'shopId':_0x35bb6}});}}exports[a54_0x2e9cb7(0x8a)]=IntegrationsService;