'use strict';const a48_0x8d2723=a48_0x5922;(function(_0x39f859,_0x744fee){const _0x32f44a=a48_0x5922,_0x525f02=_0x39f859();while(!![]){try{const _0x5559dc=parseInt(_0x32f44a(0xbe))/0x1+parseInt(_0x32f44a(0xc1))/0x2+parseInt(_0x32f44a(0xc5))/0x3+-parseInt(_0x32f44a(0xae))/0x4*(parseInt(_0x32f44a(0xc2))/0x5)+parseInt(_0x32f44a(0xbb))/0x6+-parseInt(_0x32f44a(0xc7))/0x7*(parseInt(_0x32f44a(0xb1))/0x8)+parseInt(_0x32f44a(0xc6))/0x9*(-parseInt(_0x32f44a(0xb7))/0xa);if(_0x5559dc===_0x744fee)break;else _0x525f02['push'](_0x525f02['shift']());}catch(_0x4bebd6){_0x525f02['push'](_0x525f02['shift']());}}}(a48_0x50e0,0x7eef2));var __importDefault=this&&this[a48_0x8d2723(0xba)]||function(_0x37550d){const _0x23d9a8=a48_0x8d2723;return _0x37550d&&_0x37550d[_0x23d9a8(0xad)]?_0x37550d:{'default':_0x37550d};};Object['defineProperty'](exports,a48_0x8d2723(0xad),{'value':!![]}),exports[a48_0x8d2723(0xc4)]=void 0x0;const database_1=__importDefault(require(a48_0x8d2723(0xac)));function a48_0x50e0(){const _0x13064e=['default','shopSettings','159864MRaMjb','isArray','getIntegrations','Shop\x20settings\x20not\x20found','updateWebhookSettings','update','105940taJJmU','string','webhookEvents','__importDefault','595908LcnNqy','create','webhookUrl','480966poiFUT','findUnique','ensureSettingsExist','27732LRmikX','207265TtklyT','parseWebhookEvents','IntegrationsService','2187258LCxfiz','9brUPdG','147asOdDA','../config/database','__esModule','36CNsWBR'];a48_0x50e0=function(){return _0x13064e;};return a48_0x50e0();}function a48_0x5922(_0x28f60d,_0x512a67){const _0x50e040=a48_0x50e0();return a48_0x5922=function(_0x5922ad,_0x224821){_0x5922ad=_0x5922ad-0xac;let _0x4323e4=_0x50e040[_0x5922ad];return _0x4323e4;},a48_0x5922(_0x28f60d,_0x512a67);}class IntegrationsService{[a48_0x8d2723(0xc3)](_0x81fabd){const _0x322cb8=a48_0x8d2723;if(!_0x81fabd)return[];if(Array[_0x322cb8(0xb2)](_0x81fabd))return _0x81fabd;if(typeof _0x81fabd===_0x322cb8(0xb8))try{const _0x5a4241=JSON['parse'](_0x81fabd);return Array['isArray'](_0x5a4241)?_0x5a4241:[];}catch{return[];}return[];}async[a48_0x8d2723(0xb3)](_0xd56a53){const _0x1d86a7=a48_0x8d2723;await this[_0x1d86a7(0xc0)](_0xd56a53);const _0x5364db=await database_1[_0x1d86a7(0xaf)][_0x1d86a7(0xb0)][_0x1d86a7(0xbf)]({'where':{'shopId':_0xd56a53},'select':{'webhookUrl':!![],'webhookEvents':!![]}});if(!_0x5364db)throw new Error(_0x1d86a7(0xb4));return{'webhook':{'url':_0x5364db[_0x1d86a7(0xbd)],'events':this[_0x1d86a7(0xc3)](_0x5364db[_0x1d86a7(0xb9)])}};}async[a48_0x8d2723(0xb5)](_0x2f210e,_0xeaf3ef){const _0x27ac4a=a48_0x8d2723;await this[_0x27ac4a(0xc0)](_0x2f210e);const _0x10337b={};_0xeaf3ef[_0x27ac4a(0xbd)]!==undefined&&(_0x10337b['webhookUrl']=_0xeaf3ef['webhookUrl']||null),_0xeaf3ef['webhookEvents']!==undefined&&(_0x10337b[_0x27ac4a(0xb9)]=_0xeaf3ef[_0x27ac4a(0xb9)]||[]),await database_1['default'][_0x27ac4a(0xb0)][_0x27ac4a(0xb6)]({'where':{'shopId':_0x2f210e},'data':_0x10337b});}async[a48_0x8d2723(0xc0)](_0x3fdb57){const _0x346f99=a48_0x8d2723,_0x19e9e3=await database_1[_0x346f99(0xaf)][_0x346f99(0xb0)]['findUnique']({'where':{'shopId':_0x3fdb57}});!_0x19e9e3&&await database_1['default'][_0x346f99(0xb0)][_0x346f99(0xbc)]({'data':{'shopId':_0x3fdb57}});}}exports[a48_0x8d2723(0xc4)]=IntegrationsService;