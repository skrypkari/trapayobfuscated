'use strict';const a47_0x6700a=a47_0x210d;(function(_0x5d0a05,_0x4ae52e){const _0x4af6c0=a47_0x210d,_0x27ce68=_0x5d0a05();while(!![]){try{const _0x35d7ad=-parseInt(_0x4af6c0(0x189))/0x1*(-parseInt(_0x4af6c0(0x18c))/0x2)+-parseInt(_0x4af6c0(0x18f))/0x3+-parseInt(_0x4af6c0(0x180))/0x4*(-parseInt(_0x4af6c0(0x18b))/0x5)+parseInt(_0x4af6c0(0x179))/0x6*(parseInt(_0x4af6c0(0x18e))/0x7)+-parseInt(_0x4af6c0(0x185))/0x8+-parseInt(_0x4af6c0(0x17d))/0x9+parseInt(_0x4af6c0(0x176))/0xa;if(_0x35d7ad===_0x4ae52e)break;else _0x27ce68['push'](_0x27ce68['shift']());}catch(_0x400cfe){_0x27ce68['push'](_0x27ce68['shift']());}}}(a47_0x40c5,0x419ac));var __importDefault=this&&this[a47_0x6700a(0x184)]||function(_0x5dee5a){const _0x518afd=a47_0x6700a;return _0x5dee5a&&_0x5dee5a[_0x518afd(0x17b)]?_0x5dee5a:{'default':_0x5dee5a};};Object[a47_0x6700a(0x183)](exports,a47_0x6700a(0x17b),{'value':!![]}),exports[a47_0x6700a(0x17e)]=void 0x0;function a47_0x40c5(){const _0x518bec=['webhookEvents','4417938PSyWQO','IntegrationsService','getIntegrations','332pBqRxY','ensureSettingsExist','updateWebhookSettings','defineProperty','__importDefault','2801472yqHweV','parse','default','isArray','174487xCQJfx','string','24545aKsfQh','6bqfJEj','parseWebhookEvents','327747OXCIQK','1022928hHhDtw','update','../config/database','findUnique','984610NsbQpp','shopSettings','Shop\x20settings\x20not\x20found','54DIlTHX','webhookUrl','__esModule'];a47_0x40c5=function(){return _0x518bec;};return a47_0x40c5();}const database_1=__importDefault(require(a47_0x6700a(0x191)));class IntegrationsService{[a47_0x6700a(0x18d)](_0x1b5cab){const _0x1f3197=a47_0x6700a;if(!_0x1b5cab)return[];if(Array[_0x1f3197(0x188)](_0x1b5cab))return _0x1b5cab;if(typeof _0x1b5cab===_0x1f3197(0x18a))try{const _0x47546a=JSON[_0x1f3197(0x186)](_0x1b5cab);return Array[_0x1f3197(0x188)](_0x47546a)?_0x47546a:[];}catch{return[];}return[];}async[a47_0x6700a(0x17f)](_0x4979d0){const _0x968fda=a47_0x6700a;await this[_0x968fda(0x181)](_0x4979d0);const _0x43f259=await database_1[_0x968fda(0x187)]['shopSettings'][_0x968fda(0x175)]({'where':{'shopId':_0x4979d0},'select':{'webhookUrl':!![],'webhookEvents':!![]}});if(!_0x43f259)throw new Error(_0x968fda(0x178));return{'webhook':{'url':_0x43f259[_0x968fda(0x17a)],'events':this[_0x968fda(0x18d)](_0x43f259['webhookEvents'])}};}async[a47_0x6700a(0x182)](_0x5b0ba0,_0x5014e6){const _0x443fc2=a47_0x6700a;await this[_0x443fc2(0x181)](_0x5b0ba0);const _0xe32225={};_0x5014e6[_0x443fc2(0x17a)]!==undefined&&(_0xe32225[_0x443fc2(0x17a)]=_0x5014e6['webhookUrl']||null),_0x5014e6['webhookEvents']!==undefined&&(_0xe32225['webhookEvents']=_0x5014e6[_0x443fc2(0x17c)]||[]),await database_1[_0x443fc2(0x187)]['shopSettings'][_0x443fc2(0x190)]({'where':{'shopId':_0x5b0ba0},'data':_0xe32225});}async[a47_0x6700a(0x181)](_0x3127f4){const _0x1f833f=a47_0x6700a,_0x102cf1=await database_1[_0x1f833f(0x187)][_0x1f833f(0x177)][_0x1f833f(0x175)]({'where':{'shopId':_0x3127f4}});!_0x102cf1&&await database_1['default'][_0x1f833f(0x177)]['create']({'data':{'shopId':_0x3127f4}});}}function a47_0x210d(_0x5b40da,_0x139ff4){const _0x40c5db=a47_0x40c5();return a47_0x210d=function(_0x210d9f,_0xfff2ad){_0x210d9f=_0x210d9f-0x175;let _0x2b37af=_0x40c5db[_0x210d9f];return _0x2b37af;},a47_0x210d(_0x5b40da,_0x139ff4);}exports['IntegrationsService']=IntegrationsService;