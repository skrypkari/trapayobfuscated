'use strict';const a66_0x1ab914=a66_0x35ae;(function(_0x454843,_0x1a2eb1){const _0x3d2b2a=a66_0x35ae,_0x35e97f=_0x454843();while(!![]){try{const _0x15ed2c=-parseInt(_0x3d2b2a(0x144))/0x1*(-parseInt(_0x3d2b2a(0x15d))/0x2)+parseInt(_0x3d2b2a(0x14b))/0x3+-parseInt(_0x3d2b2a(0x149))/0x4*(-parseInt(_0x3d2b2a(0x15a))/0x5)+parseInt(_0x3d2b2a(0x14a))/0x6+-parseInt(_0x3d2b2a(0x150))/0x7*(-parseInt(_0x3d2b2a(0x14e))/0x8)+-parseInt(_0x3d2b2a(0x151))/0x9*(-parseInt(_0x3d2b2a(0x157))/0xa)+-parseInt(_0x3d2b2a(0x160))/0xb*(parseInt(_0x3d2b2a(0x14c))/0xc);if(_0x15ed2c===_0x1a2eb1)break;else _0x35e97f['push'](_0x35e97f['shift']());}catch(_0x1648db){_0x35e97f['push'](_0x35e97f['shift']());}}}(a66_0x24d7,0x66a94));function a66_0x24d7(){const _0x332434=['242028PYSVAA','695718QxNxHn','1956UrmJfR','webhookUrl','570888KDtNYK','../config/database','49CCKeqj','27yxppCw','parse','IntegrationsService','isArray','shopSettings','ensureSettingsExist','1919980vQPilO','parseWebhookEvents','webhookEvents','1835Bcqvwv','update','__importDefault','45868bFnwGw','create','getIntegrations','113630kuPnfo','13cjGVTV','string','default','findUnique','defineProperty','4996ZjeIdV'];a66_0x24d7=function(){return _0x332434;};return a66_0x24d7();}var __importDefault=this&&this[a66_0x1ab914(0x15c)]||function(_0x85d008){return _0x85d008&&_0x85d008['__esModule']?_0x85d008:{'default':_0x85d008};};function a66_0x35ae(_0x3712f4,_0x2b026f){_0x3712f4=_0x3712f4-0x144;const _0x24d7e0=a66_0x24d7();let _0x35aef6=_0x24d7e0[_0x3712f4];return _0x35aef6;}Object[a66_0x1ab914(0x148)](exports,'__esModule',{'value':!![]}),exports[a66_0x1ab914(0x153)]=void 0x0;const database_1=__importDefault(require(a66_0x1ab914(0x14f)));class IntegrationsService{[a66_0x1ab914(0x158)](_0x51db54){const _0x1b6de1=a66_0x1ab914;if(!_0x51db54)return[];if(Array[_0x1b6de1(0x154)](_0x51db54))return _0x51db54;if(typeof _0x51db54===_0x1b6de1(0x145))try{const _0x5f573c=JSON[_0x1b6de1(0x152)](_0x51db54);return Array[_0x1b6de1(0x154)](_0x5f573c)?_0x5f573c:[];}catch{return[];}return[];}async[a66_0x1ab914(0x15f)](_0x4ac998){const _0x59da60=a66_0x1ab914;await this[_0x59da60(0x156)](_0x4ac998);const _0x1b0604=await database_1[_0x59da60(0x146)][_0x59da60(0x155)][_0x59da60(0x147)]({'where':{'shopId':_0x4ac998},'select':{'webhookUrl':!![],'webhookEvents':!![]}});if(!_0x1b0604)throw new Error('Shop\x20settings\x20not\x20found');return{'webhook':{'url':_0x1b0604['webhookUrl'],'events':this[_0x59da60(0x158)](_0x1b0604[_0x59da60(0x159)])}};}async['updateWebhookSettings'](_0x3900c3,_0x312ab9){const _0x285688=a66_0x1ab914;await this[_0x285688(0x156)](_0x3900c3);const _0x1d21c7={};_0x312ab9[_0x285688(0x14d)]!==undefined&&(_0x1d21c7[_0x285688(0x14d)]=_0x312ab9[_0x285688(0x14d)]||null),_0x312ab9[_0x285688(0x159)]!==undefined&&(_0x1d21c7[_0x285688(0x159)]=_0x312ab9[_0x285688(0x159)]||[]),await database_1['default']['shopSettings'][_0x285688(0x15b)]({'where':{'shopId':_0x3900c3},'data':_0x1d21c7});}async[a66_0x1ab914(0x156)](_0x23b16d){const _0x23a35d=a66_0x1ab914,_0x5b14e9=await database_1['default'][_0x23a35d(0x155)]['findUnique']({'where':{'shopId':_0x23b16d}});!_0x5b14e9&&await database_1[_0x23a35d(0x146)]['shopSettings'][_0x23a35d(0x15e)]({'data':{'shopId':_0x23b16d}});}}exports['IntegrationsService']=IntegrationsService;