'use strict';const a47_0x15fb35=a47_0x4317;(function(_0x26dd0f,_0x47fca6){const _0x267d4e=a47_0x4317,_0x28b724=_0x26dd0f();while(!![]){try{const _0x5cdd25=-parseInt(_0x267d4e(0x1f0))/0x1+parseInt(_0x267d4e(0x1f1))/0x2*(-parseInt(_0x267d4e(0x1ec))/0x3)+parseInt(_0x267d4e(0x1ef))/0x4*(parseInt(_0x267d4e(0x1fa))/0x5)+parseInt(_0x267d4e(0x1e4))/0x6*(-parseInt(_0x267d4e(0x1f3))/0x7)+parseInt(_0x267d4e(0x1e0))/0x8+-parseInt(_0x267d4e(0x1e9))/0x9*(-parseInt(_0x267d4e(0x1f4))/0xa)+parseInt(_0x267d4e(0x1e6))/0xb*(parseInt(_0x267d4e(0x1e2))/0xc);if(_0x5cdd25===_0x47fca6)break;else _0x28b724['push'](_0x28b724['shift']());}catch(_0x597140){_0x28b724['push'](_0x28b724['shift']());}}}(a47_0x1600,0xd0e26));var __importDefault=this&&this['__importDefault']||function(_0x44c069){const _0x74a187=a47_0x4317;return _0x44c069&&_0x44c069[_0x74a187(0x1e1)]?_0x44c069:{'default':_0x44c069};};Object[a47_0x15fb35(0x1f8)](exports,'__esModule',{'value':!![]}),exports[a47_0x15fb35(0x1f9)]=void 0x0;function a47_0x4317(_0x4782dc,_0x4ba69a){const _0x16006b=a47_0x1600();return a47_0x4317=function(_0x431752,_0xe2d9c2){_0x431752=_0x431752-0x1df;let _0x59fbac=_0x16006b[_0x431752];return _0x59fbac;},a47_0x4317(_0x4782dc,_0x4ba69a);}function a47_0x1600(){const _0x5978c8=['findUnique','../config/database','7196SzTOAX','1317876bpMBVJ','2KNUTSn','Shop\x20settings\x20not\x20found','79303GpDhjr','50ZFNYnT','update','shopSettings','webhookEvents','defineProperty','IntegrationsService','410fsSfjH','default','6559472PfptHj','__esModule','156eBFNbH','updateWebhookSettings','654AFZFOS','parseWebhookEvents','2303862eaVBGA','ensureSettingsExist','parse','1923255PJenPu','webhookUrl','isArray','4051038AGvxlT'];a47_0x1600=function(){return _0x5978c8;};return a47_0x1600();}const database_1=__importDefault(require(a47_0x15fb35(0x1ee)));class IntegrationsService{[a47_0x15fb35(0x1e5)](_0xf68765){const _0x27e295=a47_0x15fb35;if(!_0xf68765)return[];if(Array[_0x27e295(0x1eb)](_0xf68765))return _0xf68765;if(typeof _0xf68765==='string')try{const _0x5bf8b1=JSON[_0x27e295(0x1e8)](_0xf68765);return Array[_0x27e295(0x1eb)](_0x5bf8b1)?_0x5bf8b1:[];}catch{return[];}return[];}async['getIntegrations'](_0x29aaae){const _0x394d17=a47_0x15fb35;await this[_0x394d17(0x1e7)](_0x29aaae);const _0x4f074f=await database_1[_0x394d17(0x1df)][_0x394d17(0x1f6)][_0x394d17(0x1ed)]({'where':{'shopId':_0x29aaae},'select':{'webhookUrl':!![],'webhookEvents':!![]}});if(!_0x4f074f)throw new Error(_0x394d17(0x1f2));return{'webhook':{'url':_0x4f074f[_0x394d17(0x1ea)],'events':this[_0x394d17(0x1e5)](_0x4f074f['webhookEvents'])}};}async[a47_0x15fb35(0x1e3)](_0x314b1d,_0x365876){const _0x53878c=a47_0x15fb35;await this[_0x53878c(0x1e7)](_0x314b1d);const _0x4067b2={};_0x365876[_0x53878c(0x1ea)]!==undefined&&(_0x4067b2['webhookUrl']=_0x365876[_0x53878c(0x1ea)]||null),_0x365876[_0x53878c(0x1f7)]!==undefined&&(_0x4067b2[_0x53878c(0x1f7)]=_0x365876[_0x53878c(0x1f7)]||[]),await database_1[_0x53878c(0x1df)][_0x53878c(0x1f6)][_0x53878c(0x1f5)]({'where':{'shopId':_0x314b1d},'data':_0x4067b2});}async[a47_0x15fb35(0x1e7)](_0x4d0505){const _0x4fea80=a47_0x15fb35,_0x241114=await database_1[_0x4fea80(0x1df)][_0x4fea80(0x1f6)][_0x4fea80(0x1ed)]({'where':{'shopId':_0x4d0505}});!_0x241114&&await database_1[_0x4fea80(0x1df)]['shopSettings']['create']({'data':{'shopId':_0x4d0505}});}}exports[a47_0x15fb35(0x1f9)]=IntegrationsService;