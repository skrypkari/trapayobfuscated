'use strict';const a47_0x426203=a47_0xaf7d;(function(_0x4b6581,_0x38c51e){const _0x4ebcf2=a47_0xaf7d,_0x455acf=_0x4b6581();while(!![]){try{const _0x28b996=-parseInt(_0x4ebcf2(0x177))/0x1+-parseInt(_0x4ebcf2(0x175))/0x2+-parseInt(_0x4ebcf2(0x183))/0x3+parseInt(_0x4ebcf2(0x180))/0x4*(-parseInt(_0x4ebcf2(0x172))/0x5)+-parseInt(_0x4ebcf2(0x17c))/0x6+-parseInt(_0x4ebcf2(0x16d))/0x7*(parseInt(_0x4ebcf2(0x17a))/0x8)+-parseInt(_0x4ebcf2(0x176))/0x9*(-parseInt(_0x4ebcf2(0x170))/0xa);if(_0x28b996===_0x38c51e)break;else _0x455acf['push'](_0x455acf['shift']());}catch(_0x1a0d75){_0x455acf['push'](_0x455acf['shift']());}}}(a47_0x3edd,0x8e09b));var __importDefault=this&&this[a47_0x426203(0x16e)]||function(_0x503051){const _0x29a832=a47_0x426203;return _0x503051&&_0x503051[_0x29a832(0x184)]?_0x503051:{'default':_0x503051};};Object[a47_0x426203(0x17e)](exports,a47_0x426203(0x184),{'value':!![]}),exports[a47_0x426203(0x171)]=void 0x0;function a47_0x3edd(){const _0xd9260a=['Shop\x20settings\x20not\x20found','4867914aQZZST','ensureSettingsExist','defineProperty','updateWebhookSettings','28EybogO','isArray','webhookEvents','3407925pumzZI','__esModule','shopSettings','getIntegrations','webhookUrl','7TgiAcm','__importDefault','../config/database','2220HwglFw','IntegrationsService','581870ZaPZgR','findUnique','parseWebhookEvents','1551486CxVQzZ','226431OlHHwM','886644DbpOMw','string','default','4633696hzsZJC'];a47_0x3edd=function(){return _0xd9260a;};return a47_0x3edd();}const database_1=__importDefault(require(a47_0x426203(0x16f)));function a47_0xaf7d(_0x56d67b,_0x4ba9b9){const _0x3edd9d=a47_0x3edd();return a47_0xaf7d=function(_0xaf7d92,_0x37d354){_0xaf7d92=_0xaf7d92-0x16a;let _0xead45a=_0x3edd9d[_0xaf7d92];return _0xead45a;},a47_0xaf7d(_0x56d67b,_0x4ba9b9);}class IntegrationsService{[a47_0x426203(0x174)](_0x10b222){const _0x38cf4b=a47_0x426203;if(!_0x10b222)return[];if(Array[_0x38cf4b(0x181)](_0x10b222))return _0x10b222;if(typeof _0x10b222===_0x38cf4b(0x178))try{const _0x2a7bd7=JSON['parse'](_0x10b222);return Array[_0x38cf4b(0x181)](_0x2a7bd7)?_0x2a7bd7:[];}catch{return[];}return[];}async[a47_0x426203(0x16b)](_0x53fe7e){const _0x225d72=a47_0x426203;await this[_0x225d72(0x17d)](_0x53fe7e);const _0x477268=await database_1[_0x225d72(0x179)]['shopSettings'][_0x225d72(0x173)]({'where':{'shopId':_0x53fe7e},'select':{'webhookUrl':!![],'webhookEvents':!![]}});if(!_0x477268)throw new Error(_0x225d72(0x17b));return{'webhook':{'url':_0x477268[_0x225d72(0x16c)],'events':this[_0x225d72(0x174)](_0x477268[_0x225d72(0x182)])}};}async[a47_0x426203(0x17f)](_0x3202c3,_0xca3112){const _0x5387bd=a47_0x426203;await this['ensureSettingsExist'](_0x3202c3);const _0x33392c={};_0xca3112[_0x5387bd(0x16c)]!==undefined&&(_0x33392c[_0x5387bd(0x16c)]=_0xca3112[_0x5387bd(0x16c)]||null),_0xca3112[_0x5387bd(0x182)]!==undefined&&(_0x33392c['webhookEvents']=_0xca3112[_0x5387bd(0x182)]||[]),await database_1['default'][_0x5387bd(0x16a)]['update']({'where':{'shopId':_0x3202c3},'data':_0x33392c});}async[a47_0x426203(0x17d)](_0x273220){const _0x512b9a=a47_0x426203,_0x32d5da=await database_1[_0x512b9a(0x179)][_0x512b9a(0x16a)][_0x512b9a(0x173)]({'where':{'shopId':_0x273220}});!_0x32d5da&&await database_1[_0x512b9a(0x179)][_0x512b9a(0x16a)]['create']({'data':{'shopId':_0x273220}});}}exports[a47_0x426203(0x171)]=IntegrationsService;