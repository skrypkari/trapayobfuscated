'use strict';const a72_0x3e5fd3=a72_0x53d1;function a72_0x53d1(_0x172926,_0x38e463){_0x172926=_0x172926-0x146;const _0x189ac3=a72_0x189a();let _0x53d149=_0x189ac3[_0x172926];return _0x53d149;}(function(_0x4ff693,_0x380e6d){const _0x10009b=a72_0x53d1,_0x573382=_0x4ff693();while(!![]){try{const _0x4c8829=parseInt(_0x10009b(0x14f))/0x1*(-parseInt(_0x10009b(0x15a))/0x2)+-parseInt(_0x10009b(0x14d))/0x3+parseInt(_0x10009b(0x155))/0x4+-parseInt(_0x10009b(0x14c))/0x5+-parseInt(_0x10009b(0x157))/0x6*(-parseInt(_0x10009b(0x152))/0x7)+-parseInt(_0x10009b(0x148))/0x8*(parseInt(_0x10009b(0x150))/0x9)+parseInt(_0x10009b(0x147))/0xa;if(_0x4c8829===_0x380e6d)break;else _0x573382['push'](_0x573382['shift']());}catch(_0x4e1111){_0x573382['push'](_0x573382['shift']());}}}(a72_0x189a,0x699bb));function a72_0x189a(){const _0x103e2b=['168pVdWhb','shopSettings','parseWebhookEvents','2VkSFlc','webhookUrl','__importDefault','IntegrationsService','17097120GIUEmr','16ZEglzo','webhookEvents','string','findUnique','1337450yiCyJb','2324121jinDBp','isArray','490901pwPUgU','3821355rqeVCl','ensureSettingsExist','100037ECeKYt','defineProperty','__esModule','2819996nayaUV','../config/database'];a72_0x189a=function(){return _0x103e2b;};return a72_0x189a();}var __importDefault=this&&this[a72_0x3e5fd3(0x15c)]||function(_0xbaf235){const _0xdc849f=a72_0x3e5fd3;return _0xbaf235&&_0xbaf235[_0xdc849f(0x154)]?_0xbaf235:{'default':_0xbaf235};};Object[a72_0x3e5fd3(0x153)](exports,a72_0x3e5fd3(0x154),{'value':!![]}),exports[a72_0x3e5fd3(0x146)]=void 0x0;const database_1=__importDefault(require(a72_0x3e5fd3(0x156)));class IntegrationsService{[a72_0x3e5fd3(0x159)](_0x4c2218){const _0x186f69=a72_0x3e5fd3;if(!_0x4c2218)return[];if(Array[_0x186f69(0x14e)](_0x4c2218))return _0x4c2218;if(typeof _0x4c2218===_0x186f69(0x14a))try{const _0x231dce=JSON['parse'](_0x4c2218);return Array[_0x186f69(0x14e)](_0x231dce)?_0x231dce:[];}catch{return[];}return[];}async['getIntegrations'](_0x1077ad){const _0x3cbdc3=a72_0x3e5fd3;await this[_0x3cbdc3(0x151)](_0x1077ad);const _0x24bed0=await database_1['default'][_0x3cbdc3(0x158)][_0x3cbdc3(0x14b)]({'where':{'shopId':_0x1077ad},'select':{'webhookUrl':!![],'webhookEvents':!![]}});if(!_0x24bed0)throw new Error('Shop\x20settings\x20not\x20found');return{'webhook':{'url':_0x24bed0['webhookUrl'],'events':this['parseWebhookEvents'](_0x24bed0['webhookEvents'])}};}async['updateWebhookSettings'](_0x2ee839,_0xacc574){const _0x1bfa8a=a72_0x3e5fd3;await this[_0x1bfa8a(0x151)](_0x2ee839);const _0x123d9b={};_0xacc574[_0x1bfa8a(0x15b)]!==undefined&&(_0x123d9b[_0x1bfa8a(0x15b)]=_0xacc574[_0x1bfa8a(0x15b)]||null),_0xacc574['webhookEvents']!==undefined&&(_0x123d9b[_0x1bfa8a(0x149)]=_0xacc574[_0x1bfa8a(0x149)]||[]),await database_1['default']['shopSettings']['update']({'where':{'shopId':_0x2ee839},'data':_0x123d9b});}async['ensureSettingsExist'](_0x5301cc){const _0x2ffb5c=await database_1['default']['shopSettings']['findUnique']({'where':{'shopId':_0x5301cc}});!_0x2ffb5c&&await database_1['default']['shopSettings']['create']({'data':{'shopId':_0x5301cc}});}}exports['IntegrationsService']=IntegrationsService;