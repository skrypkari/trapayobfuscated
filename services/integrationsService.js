'use strict';const a72_0x4cf168=a72_0x3e92;(function(_0x58af33,_0x4849c6){const _0x4dd913=a72_0x3e92,_0x213942=_0x58af33();while(!![]){try{const _0x5e000c=parseInt(_0x4dd913(0x99))/0x1*(parseInt(_0x4dd913(0x96))/0x2)+-parseInt(_0x4dd913(0x8b))/0x3+parseInt(_0x4dd913(0x9b))/0x4*(-parseInt(_0x4dd913(0x9d))/0x5)+parseInt(_0x4dd913(0xa4))/0x6+-parseInt(_0x4dd913(0xa3))/0x7*(-parseInt(_0x4dd913(0x97))/0x8)+-parseInt(_0x4dd913(0x8f))/0x9+parseInt(_0x4dd913(0xa1))/0xa;if(_0x5e000c===_0x4849c6)break;else _0x213942['push'](_0x213942['shift']());}catch(_0x7933d3){_0x213942['push'](_0x213942['shift']());}}}(a72_0x3749,0xe317f));var __importDefault=this&&this[a72_0x4cf168(0x98)]||function(_0x35bf9a){const _0x46be3d=a72_0x4cf168;return _0x35bf9a&&_0x35bf9a[_0x46be3d(0x90)]?_0x35bf9a:{'default':_0x35bf9a};};function a72_0x3749(){const _0x12d8b9=['getIntegrations','defineProperty','parse','4672LArKGm','8DkCiQT','__importDefault','211EaTPXK','webhookEvents','805204xmKzcU','update','5sJrZXX','IntegrationsService','parseWebhookEvents','findUnique','31520120VNNlXb','updateWebhookSettings','340851tYVXQY','1561614WHGxJv','default','3395385gLtcjg','Shop\x20settings\x20not\x20found','shopSettings','isArray','15215391olOCaD','__esModule','ensureSettingsExist','webhookUrl'];a72_0x3749=function(){return _0x12d8b9;};return a72_0x3749();}function a72_0x3e92(_0x4143e6,_0x4a2277){_0x4143e6=_0x4143e6-0x8a;const _0x374934=a72_0x3749();let _0x3e92f7=_0x374934[_0x4143e6];return _0x3e92f7;}Object[a72_0x4cf168(0x94)](exports,a72_0x4cf168(0x90),{'value':!![]}),exports['IntegrationsService']=void 0x0;const database_1=__importDefault(require('../config/database'));class IntegrationsService{[a72_0x4cf168(0x9f)](_0x28ba5d){const _0x90bc83=a72_0x4cf168;if(!_0x28ba5d)return[];if(Array[_0x90bc83(0x8e)](_0x28ba5d))return _0x28ba5d;if(typeof _0x28ba5d==='string')try{const _0x5b9897=JSON[_0x90bc83(0x95)](_0x28ba5d);return Array[_0x90bc83(0x8e)](_0x5b9897)?_0x5b9897:[];}catch{return[];}return[];}async[a72_0x4cf168(0x93)](_0x20fc65){const _0x2aabf2=a72_0x4cf168;await this['ensureSettingsExist'](_0x20fc65);const _0x90b0f8=await database_1[_0x2aabf2(0x8a)][_0x2aabf2(0x8d)][_0x2aabf2(0xa0)]({'where':{'shopId':_0x20fc65},'select':{'webhookUrl':!![],'webhookEvents':!![]}});if(!_0x90b0f8)throw new Error(_0x2aabf2(0x8c));return{'webhook':{'url':_0x90b0f8[_0x2aabf2(0x92)],'events':this['parseWebhookEvents'](_0x90b0f8[_0x2aabf2(0x9a)])}};}async[a72_0x4cf168(0xa2)](_0x35e916,_0x29331c){const _0x34420b=a72_0x4cf168;await this['ensureSettingsExist'](_0x35e916);const _0x1139b6={};_0x29331c[_0x34420b(0x92)]!==undefined&&(_0x1139b6[_0x34420b(0x92)]=_0x29331c[_0x34420b(0x92)]||null),_0x29331c['webhookEvents']!==undefined&&(_0x1139b6['webhookEvents']=_0x29331c[_0x34420b(0x9a)]||[]),await database_1[_0x34420b(0x8a)][_0x34420b(0x8d)][_0x34420b(0x9c)]({'where':{'shopId':_0x35e916},'data':_0x1139b6});}async[a72_0x4cf168(0x91)](_0x59b75e){const _0x4bb4c6=a72_0x4cf168,_0x5f36ce=await database_1[_0x4bb4c6(0x8a)]['shopSettings'][_0x4bb4c6(0xa0)]({'where':{'shopId':_0x59b75e}});!_0x5f36ce&&await database_1[_0x4bb4c6(0x8a)]['shopSettings']['create']({'data':{'shopId':_0x59b75e}});}}exports[a72_0x4cf168(0x9e)]=IntegrationsService;