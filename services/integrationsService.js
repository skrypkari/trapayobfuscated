'use strict';const a43_0x12971a=a43_0x2431;(function(_0x2ff8eb,_0x130683){const _0x296be5=a43_0x2431,_0x44533e=_0x2ff8eb();while(!![]){try{const _0x33289d=-parseInt(_0x296be5(0x160))/0x1*(parseInt(_0x296be5(0x154))/0x2)+-parseInt(_0x296be5(0x15d))/0x3+-parseInt(_0x296be5(0x14a))/0x4+-parseInt(_0x296be5(0x14e))/0x5*(parseInt(_0x296be5(0x15f))/0x6)+-parseInt(_0x296be5(0x14d))/0x7+parseInt(_0x296be5(0x156))/0x8*(parseInt(_0x296be5(0x15a))/0x9)+parseInt(_0x296be5(0x157))/0xa;if(_0x33289d===_0x130683)break;else _0x44533e['push'](_0x44533e['shift']());}catch(_0x1ae81a){_0x44533e['push'](_0x44533e['shift']());}}}(a43_0xeba1,0x5c0b5));var __importDefault=this&&this['__importDefault']||function(_0x312e80){const _0x29835d=a43_0x2431;return _0x312e80&&_0x312e80[_0x29835d(0x15e)]?_0x312e80:{'default':_0x312e80};};Object[a43_0x12971a(0x152)](exports,a43_0x12971a(0x15e),{'value':!![]}),exports[a43_0x12971a(0x150)]=void 0x0;function a43_0xeba1(){const _0x5b85ec=['21789250IkEvqw','../config/database','isArray','160065lWTUiU','webhookEvents','shopSettings','75429GGgtat','__esModule','6xUMBVG','133671APUWDg','getIntegrations','Shop\x20settings\x20not\x20found','updateWebhookSettings','2318292HGzMrf','default','webhookUrl','3279626ogMKbu','746240tVjtFL','create','IntegrationsService','string','defineProperty','findUnique','10qsJMCJ','ensureSettingsExist','40LzsqFn'];a43_0xeba1=function(){return _0x5b85ec;};return a43_0xeba1();}function a43_0x2431(_0x463323,_0x28a065){const _0xeba1c9=a43_0xeba1();return a43_0x2431=function(_0x24313b,_0x9fddfe){_0x24313b=_0x24313b-0x147;let _0x94096e=_0xeba1c9[_0x24313b];return _0x94096e;},a43_0x2431(_0x463323,_0x28a065);}const database_1=__importDefault(require(a43_0x12971a(0x158)));class IntegrationsService{['parseWebhookEvents'](_0x243a06){const _0x129a82=a43_0x12971a;if(!_0x243a06)return[];if(Array[_0x129a82(0x159)](_0x243a06))return _0x243a06;if(typeof _0x243a06===_0x129a82(0x151))try{const _0x4e3a62=JSON['parse'](_0x243a06);return Array['isArray'](_0x4e3a62)?_0x4e3a62:[];}catch{return[];}return[];}async[a43_0x12971a(0x147)](_0x32d647){const _0x566846=a43_0x12971a;await this[_0x566846(0x155)](_0x32d647);const _0x55c869=await database_1[_0x566846(0x14b)][_0x566846(0x15c)][_0x566846(0x153)]({'where':{'shopId':_0x32d647},'select':{'webhookUrl':!![],'webhookEvents':!![]}});if(!_0x55c869)throw new Error(_0x566846(0x148));return{'webhook':{'url':_0x55c869['webhookUrl'],'events':this['parseWebhookEvents'](_0x55c869['webhookEvents'])}};}async[a43_0x12971a(0x149)](_0x5e95a1,_0x3813cd){const _0x40ee25=a43_0x12971a;await this['ensureSettingsExist'](_0x5e95a1);const _0x1e7dfc={};_0x3813cd['webhookUrl']!==undefined&&(_0x1e7dfc[_0x40ee25(0x14c)]=_0x3813cd[_0x40ee25(0x14c)]||null),_0x3813cd[_0x40ee25(0x15b)]!==undefined&&(_0x1e7dfc[_0x40ee25(0x15b)]=_0x3813cd[_0x40ee25(0x15b)]||[]),await database_1[_0x40ee25(0x14b)][_0x40ee25(0x15c)]['update']({'where':{'shopId':_0x5e95a1},'data':_0x1e7dfc});}async['ensureSettingsExist'](_0x141e9f){const _0x15ff6f=a43_0x12971a,_0x16d463=await database_1[_0x15ff6f(0x14b)]['shopSettings']['findUnique']({'where':{'shopId':_0x141e9f}});!_0x16d463&&await database_1['default']['shopSettings'][_0x15ff6f(0x14f)]({'data':{'shopId':_0x141e9f}});}}exports[a43_0x12971a(0x150)]=IntegrationsService;