'use strict';const a47_0x36c41b=a47_0x5e86;function a47_0x4c28(){const _0x10b353=['11877899lomXPY','isArray','create','1YNpdpF','getIntegrations','updateWebhookSettings','default','parseWebhookEvents','Shop\x20settings\x20not\x20found','40anpBeg','webhookEvents','__esModule','IntegrationsService','defineProperty','3973884ftLDhZ','879389flCMTw','2371089QjVdTo','webhookUrl','__importDefault','39844yQQnRj','update','shopSettings','string','1724738FAQAxI','7881804VNdvQv','findUnique','ensureSettingsExist','40okFEss','5oWkTaH'];a47_0x4c28=function(){return _0x10b353;};return a47_0x4c28();}(function(_0x4d8f60,_0xeaa382){const _0x4b95c7=a47_0x5e86,_0x467e2a=_0x4d8f60();while(!![]){try{const _0x2e16bc=-parseInt(_0x4b95c7(0xc7))/0x1*(parseInt(_0x4b95c7(0xbe))/0x2)+-parseInt(_0x4b95c7(0xd4))/0x3+parseInt(_0x4b95c7(0xd7))/0x4*(parseInt(_0x4b95c7(0xc3))/0x5)+-parseInt(_0x4b95c7(0xd2))/0x6+-parseInt(_0x4b95c7(0xd3))/0x7*(parseInt(_0x4b95c7(0xc2))/0x8)+-parseInt(_0x4b95c7(0xbf))/0x9+parseInt(_0x4b95c7(0xcd))/0xa*(parseInt(_0x4b95c7(0xc4))/0xb);if(_0x2e16bc===_0xeaa382)break;else _0x467e2a['push'](_0x467e2a['shift']());}catch(_0x4b696e){_0x467e2a['push'](_0x467e2a['shift']());}}}(a47_0x4c28,0x7c934));var __importDefault=this&&this[a47_0x36c41b(0xd6)]||function(_0x49da6e){const _0x493a62=a47_0x36c41b;return _0x49da6e&&_0x49da6e[_0x493a62(0xcf)]?_0x49da6e:{'default':_0x49da6e};};Object[a47_0x36c41b(0xd1)](exports,a47_0x36c41b(0xcf),{'value':!![]}),exports[a47_0x36c41b(0xd0)]=void 0x0;const database_1=__importDefault(require('../config/database'));function a47_0x5e86(_0x3a6546,_0x19f3c7){const _0x4c28ff=a47_0x4c28();return a47_0x5e86=function(_0x5e86c9,_0x508010){_0x5e86c9=_0x5e86c9-0xbd;let _0x140080=_0x4c28ff[_0x5e86c9];return _0x140080;},a47_0x5e86(_0x3a6546,_0x19f3c7);}class IntegrationsService{[a47_0x36c41b(0xcb)](_0x2d3f0a){const _0xf8290a=a47_0x36c41b;if(!_0x2d3f0a)return[];if(Array[_0xf8290a(0xc5)](_0x2d3f0a))return _0x2d3f0a;if(typeof _0x2d3f0a===_0xf8290a(0xbd))try{const _0x2b1800=JSON['parse'](_0x2d3f0a);return Array['isArray'](_0x2b1800)?_0x2b1800:[];}catch{return[];}return[];}async[a47_0x36c41b(0xc8)](_0x463704){const _0x408443=a47_0x36c41b;await this[_0x408443(0xc1)](_0x463704);const _0x4962ee=await database_1['default'][_0x408443(0xd9)][_0x408443(0xc0)]({'where':{'shopId':_0x463704},'select':{'webhookUrl':!![],'webhookEvents':!![]}});if(!_0x4962ee)throw new Error(_0x408443(0xcc));return{'webhook':{'url':_0x4962ee[_0x408443(0xd5)],'events':this[_0x408443(0xcb)](_0x4962ee['webhookEvents'])}};}async[a47_0x36c41b(0xc9)](_0x965452,_0xbb39fb){const _0x5cf141=a47_0x36c41b;await this[_0x5cf141(0xc1)](_0x965452);const _0x3e94b5={};_0xbb39fb[_0x5cf141(0xd5)]!==undefined&&(_0x3e94b5[_0x5cf141(0xd5)]=_0xbb39fb[_0x5cf141(0xd5)]||null),_0xbb39fb[_0x5cf141(0xce)]!==undefined&&(_0x3e94b5[_0x5cf141(0xce)]=_0xbb39fb[_0x5cf141(0xce)]||[]),await database_1[_0x5cf141(0xca)][_0x5cf141(0xd9)][_0x5cf141(0xd8)]({'where':{'shopId':_0x965452},'data':_0x3e94b5});}async['ensureSettingsExist'](_0x5f456b){const _0x32782f=a47_0x36c41b,_0x11f8c7=await database_1[_0x32782f(0xca)][_0x32782f(0xd9)][_0x32782f(0xc0)]({'where':{'shopId':_0x5f456b}});!_0x11f8c7&&await database_1[_0x32782f(0xca)][_0x32782f(0xd9)][_0x32782f(0xc6)]({'data':{'shopId':_0x5f456b}});}}exports[a47_0x36c41b(0xd0)]=IntegrationsService;