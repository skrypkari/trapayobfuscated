'use strict';const a47_0x1462b8=a47_0x1088;(function(_0x1d7b4f,_0x27ccb5){const _0x9f550c=a47_0x1088,_0x1b9e6d=_0x1d7b4f();while(!![]){try{const _0x35097b=parseInt(_0x9f550c(0x13b))/0x1*(parseInt(_0x9f550c(0x151))/0x2)+parseInt(_0x9f550c(0x140))/0x3+parseInt(_0x9f550c(0x137))/0x4*(parseInt(_0x9f550c(0x14c))/0x5)+-parseInt(_0x9f550c(0x14e))/0x6+parseInt(_0x9f550c(0x14b))/0x7*(-parseInt(_0x9f550c(0x139))/0x8)+parseInt(_0x9f550c(0x150))/0x9+-parseInt(_0x9f550c(0x141))/0xa;if(_0x35097b===_0x27ccb5)break;else _0x1b9e6d['push'](_0x1b9e6d['shift']());}catch(_0x406754){_0x1b9e6d['push'](_0x1b9e6d['shift']());}}}(a47_0x5ad7,0x47154));var __importDefault=this&&this['__importDefault']||function(_0x6a067e){const _0x1dc8b7=a47_0x1088;return _0x6a067e&&_0x6a067e[_0x1dc8b7(0x138)]?_0x6a067e:{'default':_0x6a067e};};Object[a47_0x1462b8(0x143)](exports,'__esModule',{'value':!![]}),exports[a47_0x1462b8(0x13f)]=void 0x0;const database_1=__importDefault(require(a47_0x1462b8(0x147)));function a47_0x5ad7(){const _0x52e9f4=['getIntegrations','2778930vquPdN','34082LFfktj','webhookEvents','default','80732tGoGvN','__esModule','31232HQiqjL','parse','3KMdHtm','update','ensureSettingsExist','shopSettings','IntegrationsService','882942ePPQrO','4022610qqcCSC','isArray','defineProperty','findUnique','parseWebhookEvents','create','../config/database','updateWebhookSettings','string','Shop\x20settings\x20not\x20found','35YeiKCB','65wjByGF','webhookUrl','1221894MAllRy'];a47_0x5ad7=function(){return _0x52e9f4;};return a47_0x5ad7();}class IntegrationsService{[a47_0x1462b8(0x145)](_0x397fbc){const _0x32e926=a47_0x1462b8;if(!_0x397fbc)return[];if(Array[_0x32e926(0x142)](_0x397fbc))return _0x397fbc;if(typeof _0x397fbc===_0x32e926(0x149))try{const _0x2733c4=JSON[_0x32e926(0x13a)](_0x397fbc);return Array[_0x32e926(0x142)](_0x2733c4)?_0x2733c4:[];}catch{return[];}return[];}async[a47_0x1462b8(0x14f)](_0x1f4c6b){const _0x585dda=a47_0x1462b8;await this[_0x585dda(0x13d)](_0x1f4c6b);const _0x472e5e=await database_1[_0x585dda(0x136)][_0x585dda(0x13e)][_0x585dda(0x144)]({'where':{'shopId':_0x1f4c6b},'select':{'webhookUrl':!![],'webhookEvents':!![]}});if(!_0x472e5e)throw new Error(_0x585dda(0x14a));return{'webhook':{'url':_0x472e5e[_0x585dda(0x14d)],'events':this[_0x585dda(0x145)](_0x472e5e[_0x585dda(0x152)])}};}async[a47_0x1462b8(0x148)](_0x2a5ac8,_0x460239){const _0x4ec989=a47_0x1462b8;await this[_0x4ec989(0x13d)](_0x2a5ac8);const _0x58fe4b={};_0x460239['webhookUrl']!==undefined&&(_0x58fe4b['webhookUrl']=_0x460239[_0x4ec989(0x14d)]||null),_0x460239[_0x4ec989(0x152)]!==undefined&&(_0x58fe4b[_0x4ec989(0x152)]=_0x460239[_0x4ec989(0x152)]||[]),await database_1[_0x4ec989(0x136)][_0x4ec989(0x13e)][_0x4ec989(0x13c)]({'where':{'shopId':_0x2a5ac8},'data':_0x58fe4b});}async['ensureSettingsExist'](_0x426620){const _0x1a562f=a47_0x1462b8,_0x2a6c35=await database_1[_0x1a562f(0x136)][_0x1a562f(0x13e)]['findUnique']({'where':{'shopId':_0x426620}});!_0x2a6c35&&await database_1[_0x1a562f(0x136)][_0x1a562f(0x13e)][_0x1a562f(0x146)]({'data':{'shopId':_0x426620}});}}function a47_0x1088(_0x16787f,_0x5bfdac){const _0x5ad795=a47_0x5ad7();return a47_0x1088=function(_0x10881c,_0xb84b0d){_0x10881c=_0x10881c-0x136;let _0x1bb952=_0x5ad795[_0x10881c];return _0x1bb952;},a47_0x1088(_0x16787f,_0x5bfdac);}exports['IntegrationsService']=IntegrationsService;