'use strict';const a48_0x9a5c55=a48_0x3aa6;function a48_0x3aa6(_0x45c632,_0x3ec581){const _0x3de835=a48_0x3de8();return a48_0x3aa6=function(_0x3aa630,_0x3f9f70){_0x3aa630=_0x3aa630-0x158;let _0x12e6bd=_0x3de835[_0x3aa630];return _0x12e6bd;},a48_0x3aa6(_0x45c632,_0x3ec581);}(function(_0x2aada8,_0x277a43){const _0x29e863=a48_0x3aa6,_0x5908ee=_0x2aada8();while(!![]){try{const _0x3f9b46=parseInt(_0x29e863(0x16a))/0x1+-parseInt(_0x29e863(0x16d))/0x2*(-parseInt(_0x29e863(0x162))/0x3)+parseInt(_0x29e863(0x159))/0x4+parseInt(_0x29e863(0x163))/0x5*(-parseInt(_0x29e863(0x164))/0x6)+-parseInt(_0x29e863(0x16b))/0x7+parseInt(_0x29e863(0x16e))/0x8*(parseInt(_0x29e863(0x15e))/0x9)+-parseInt(_0x29e863(0x169))/0xa;if(_0x3f9b46===_0x277a43)break;else _0x5908ee['push'](_0x5908ee['shift']());}catch(_0x1d2f9a){_0x5908ee['push'](_0x5908ee['shift']());}}}(a48_0x3de8,0x49bb5));var __importDefault=this&&this[a48_0x9a5c55(0x160)]||function(_0x2f5475){const _0x570f01=a48_0x9a5c55;return _0x2f5475&&_0x2f5475[_0x570f01(0x15b)]?_0x2f5475:{'default':_0x2f5475};};Object[a48_0x9a5c55(0x167)](exports,'__esModule',{'value':!![]}),exports[a48_0x9a5c55(0x15a)]=void 0x0;const database_1=__importDefault(require('../config/database'));function a48_0x3de8(){const _0x26f6dd=['update','string','defineProperty','findUnique','8897130EzqbnX','432848SpZpps','1439893GdklPO','parse','2ePPSWT','64816FDbzrF','webhookUrl','isArray','Shop\x20settings\x20not\x20found','default','ensureSettingsExist','1883348DoXAyB','IntegrationsService','__esModule','getIntegrations','shopSettings','207NriMYJ','parseWebhookEvents','__importDefault','webhookEvents','1475751hVyqgK','5WnupNj','1107186LGbVUs'];a48_0x3de8=function(){return _0x26f6dd;};return a48_0x3de8();}class IntegrationsService{['parseWebhookEvents'](_0x2e8939){const _0x2fa20c=a48_0x9a5c55;if(!_0x2e8939)return[];if(Array[_0x2fa20c(0x170)](_0x2e8939))return _0x2e8939;if(typeof _0x2e8939===_0x2fa20c(0x166))try{const _0x5d3688=JSON[_0x2fa20c(0x16c)](_0x2e8939);return Array[_0x2fa20c(0x170)](_0x5d3688)?_0x5d3688:[];}catch{return[];}return[];}async[a48_0x9a5c55(0x15c)](_0x40de5d){const _0x1defd5=a48_0x9a5c55;await this[_0x1defd5(0x158)](_0x40de5d);const _0x135c1c=await database_1['default'][_0x1defd5(0x15d)][_0x1defd5(0x168)]({'where':{'shopId':_0x40de5d},'select':{'webhookUrl':!![],'webhookEvents':!![]}});if(!_0x135c1c)throw new Error(_0x1defd5(0x171));return{'webhook':{'url':_0x135c1c[_0x1defd5(0x16f)],'events':this[_0x1defd5(0x15f)](_0x135c1c[_0x1defd5(0x161)])}};}async['updateWebhookSettings'](_0x4a42da,_0x88cfee){const _0x50b78b=a48_0x9a5c55;await this[_0x50b78b(0x158)](_0x4a42da);const _0x203c0c={};_0x88cfee[_0x50b78b(0x16f)]!==undefined&&(_0x203c0c['webhookUrl']=_0x88cfee[_0x50b78b(0x16f)]||null),_0x88cfee['webhookEvents']!==undefined&&(_0x203c0c['webhookEvents']=_0x88cfee[_0x50b78b(0x161)]||[]),await database_1['default'][_0x50b78b(0x15d)][_0x50b78b(0x165)]({'where':{'shopId':_0x4a42da},'data':_0x203c0c});}async[a48_0x9a5c55(0x158)](_0x587602){const _0x262397=a48_0x9a5c55,_0x12f5c2=await database_1[_0x262397(0x172)][_0x262397(0x15d)][_0x262397(0x168)]({'where':{'shopId':_0x587602}});!_0x12f5c2&&await database_1[_0x262397(0x172)]['shopSettings']['create']({'data':{'shopId':_0x587602}});}}exports[a48_0x9a5c55(0x15a)]=IntegrationsService;