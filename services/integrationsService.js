'use strict';const a51_0x29063e=a51_0xd137;(function(_0x1d47f4,_0x26da4f){const _0x746f75=a51_0xd137,_0x4fd5dc=_0x1d47f4();while(!![]){try{const _0x5ac893=parseInt(_0x746f75(0x151))/0x1*(parseInt(_0x746f75(0x166))/0x2)+-parseInt(_0x746f75(0x161))/0x3+-parseInt(_0x746f75(0x162))/0x4*(parseInt(_0x746f75(0x14d))/0x5)+parseInt(_0x746f75(0x159))/0x6*(parseInt(_0x746f75(0x154))/0x7)+parseInt(_0x746f75(0x15b))/0x8*(-parseInt(_0x746f75(0x150))/0x9)+parseInt(_0x746f75(0x160))/0xa+parseInt(_0x746f75(0x15f))/0xb;if(_0x5ac893===_0x26da4f)break;else _0x4fd5dc['push'](_0x4fd5dc['shift']());}catch(_0xeadc4){_0x4fd5dc['push'](_0x4fd5dc['shift']());}}}(a51_0x1c17,0xc82c7));var __importDefault=this&&this[a51_0x29063e(0x165)]||function(_0x11ad98){return _0x11ad98&&_0x11ad98['__esModule']?_0x11ad98:{'default':_0x11ad98};};Object[a51_0x29063e(0x14f)](exports,a51_0x29063e(0x167),{'value':!![]}),exports[a51_0x29063e(0x15e)]=void 0x0;const database_1=__importDefault(require(a51_0x29063e(0x169)));function a51_0x1c17(){const _0x54e5cd=['86085AQgXRQ','963EKMEBW','create','isArray','469zQBWMd','webhookUrl','shopSettings','parse','getIntegrations','5298uyPHmH','webhookEvents','472GqqyrM','findUnique','updateWebhookSettings','IntegrationsService','11311751JQEmRm','3291940KgHSZf','803091ExMhhy','52780kUOIVa','ensureSettingsExist','default','__importDefault','2078grKVpf','__esModule','Shop\x20settings\x20not\x20found','../config/database','290RvzQll','parseWebhookEvents','defineProperty'];a51_0x1c17=function(){return _0x54e5cd;};return a51_0x1c17();}function a51_0xd137(_0x1b9607,_0x5c635a){const _0x1c17a7=a51_0x1c17();return a51_0xd137=function(_0xd13789,_0x20cf98){_0xd13789=_0xd13789-0x14d;let _0x466b29=_0x1c17a7[_0xd13789];return _0x466b29;},a51_0xd137(_0x1b9607,_0x5c635a);}class IntegrationsService{[a51_0x29063e(0x14e)](_0x1e95da){const _0x3b5d6a=a51_0x29063e;if(!_0x1e95da)return[];if(Array[_0x3b5d6a(0x153)](_0x1e95da))return _0x1e95da;if(typeof _0x1e95da==='string')try{const _0x2474af=JSON[_0x3b5d6a(0x157)](_0x1e95da);return Array[_0x3b5d6a(0x153)](_0x2474af)?_0x2474af:[];}catch{return[];}return[];}async[a51_0x29063e(0x158)](_0x44bc04){const _0xb215f0=a51_0x29063e;await this['ensureSettingsExist'](_0x44bc04);const _0x40ac26=await database_1[_0xb215f0(0x164)][_0xb215f0(0x156)][_0xb215f0(0x15c)]({'where':{'shopId':_0x44bc04},'select':{'webhookUrl':!![],'webhookEvents':!![]}});if(!_0x40ac26)throw new Error(_0xb215f0(0x168));return{'webhook':{'url':_0x40ac26[_0xb215f0(0x155)],'events':this[_0xb215f0(0x14e)](_0x40ac26['webhookEvents'])}};}async[a51_0x29063e(0x15d)](_0x414070,_0x5342cc){const _0x30d81b=a51_0x29063e;await this['ensureSettingsExist'](_0x414070);const _0x8fb369={};_0x5342cc[_0x30d81b(0x155)]!==undefined&&(_0x8fb369[_0x30d81b(0x155)]=_0x5342cc[_0x30d81b(0x155)]||null),_0x5342cc[_0x30d81b(0x15a)]!==undefined&&(_0x8fb369[_0x30d81b(0x15a)]=_0x5342cc[_0x30d81b(0x15a)]||[]),await database_1[_0x30d81b(0x164)][_0x30d81b(0x156)]['update']({'where':{'shopId':_0x414070},'data':_0x8fb369});}async[a51_0x29063e(0x163)](_0x3413f5){const _0x470d45=a51_0x29063e,_0x37b087=await database_1['default']['shopSettings'][_0x470d45(0x15c)]({'where':{'shopId':_0x3413f5}});!_0x37b087&&await database_1[_0x470d45(0x164)]['shopSettings'][_0x470d45(0x152)]({'data':{'shopId':_0x3413f5}});}}exports[a51_0x29063e(0x15e)]=IntegrationsService;