'use strict';const a54_0x127068=a54_0x4178;(function(_0x4418f9,_0x53a57d){const _0x2e7a7b=a54_0x4178,_0x10c53a=_0x4418f9();while(!![]){try{const _0x480c4e=-parseInt(_0x2e7a7b(0x19a))/0x1*(parseInt(_0x2e7a7b(0x199))/0x2)+-parseInt(_0x2e7a7b(0x1b1))/0x3*(-parseInt(_0x2e7a7b(0x19d))/0x4)+-parseInt(_0x2e7a7b(0x1b0))/0x5*(-parseInt(_0x2e7a7b(0x1af))/0x6)+parseInt(_0x2e7a7b(0x198))/0x7+-parseInt(_0x2e7a7b(0x1ac))/0x8*(parseInt(_0x2e7a7b(0x1a6))/0x9)+-parseInt(_0x2e7a7b(0x19b))/0xa*(parseInt(_0x2e7a7b(0x1a3))/0xb)+parseInt(_0x2e7a7b(0x196))/0xc;if(_0x480c4e===_0x53a57d)break;else _0x10c53a['push'](_0x10c53a['shift']());}catch(_0x53ebcd){_0x10c53a['push'](_0x10c53a['shift']());}}}(a54_0x23d9,0xed199));function a54_0x4178(_0x37adb1,_0x4257cb){const _0x23d9c9=a54_0x23d9();return a54_0x4178=function(_0x4178fd,_0x4fef6a){_0x4178fd=_0x4178fd-0x196;let _0x10dbff=_0x23d9c9[_0x4178fd];return _0x10dbff;},a54_0x4178(_0x37adb1,_0x4257cb);}var __importDefault=this&&this[a54_0x127068(0x1aa)]||function(_0x5d061c){const _0x55bb85=a54_0x127068;return _0x5d061c&&_0x5d061c[_0x55bb85(0x1a8)]?_0x5d061c:{'default':_0x5d061c};};function a54_0x23d9(){const _0x1ca0f0=['3887004DIAdRr','string','2271360MerRcL','54798XecnmF','37YceqMg','122130QPkYVX','default','4hCIRHf','webhookUrl','Shop\x20settings\x20not\x20found','ensureSettingsExist','../config/database','IntegrationsService','66ZsDgJO','getIntegrations','parseWebhookEvents','9EYpESe','shopSettings','__esModule','isArray','__importDefault','findUnique','1240696UpkGWC','create','webhookEvents','1726362pRsizo','25xAVBtJ','378771hEFtCk'];a54_0x23d9=function(){return _0x1ca0f0;};return a54_0x23d9();}Object['defineProperty'](exports,'__esModule',{'value':!![]}),exports[a54_0x127068(0x1a2)]=void 0x0;const database_1=__importDefault(require(a54_0x127068(0x1a1)));class IntegrationsService{['parseWebhookEvents'](_0x17893b){const _0x21c0e2=a54_0x127068;if(!_0x17893b)return[];if(Array['isArray'](_0x17893b))return _0x17893b;if(typeof _0x17893b===_0x21c0e2(0x197))try{const _0x16bff2=JSON['parse'](_0x17893b);return Array[_0x21c0e2(0x1a9)](_0x16bff2)?_0x16bff2:[];}catch{return[];}return[];}async[a54_0x127068(0x1a4)](_0x3c10f2){const _0x517820=a54_0x127068;await this['ensureSettingsExist'](_0x3c10f2);const _0x50f873=await database_1[_0x517820(0x19c)][_0x517820(0x1a7)][_0x517820(0x1ab)]({'where':{'shopId':_0x3c10f2},'select':{'webhookUrl':!![],'webhookEvents':!![]}});if(!_0x50f873)throw new Error(_0x517820(0x19f));return{'webhook':{'url':_0x50f873[_0x517820(0x19e)],'events':this[_0x517820(0x1a5)](_0x50f873[_0x517820(0x1ae)])}};}async['updateWebhookSettings'](_0x47794f,_0x1ee9f1){const _0x1d74ea=a54_0x127068;await this[_0x1d74ea(0x1a0)](_0x47794f);const _0x153a6f={};_0x1ee9f1[_0x1d74ea(0x19e)]!==undefined&&(_0x153a6f[_0x1d74ea(0x19e)]=_0x1ee9f1[_0x1d74ea(0x19e)]||null),_0x1ee9f1[_0x1d74ea(0x1ae)]!==undefined&&(_0x153a6f['webhookEvents']=_0x1ee9f1[_0x1d74ea(0x1ae)]||[]),await database_1[_0x1d74ea(0x19c)]['shopSettings']['update']({'where':{'shopId':_0x47794f},'data':_0x153a6f});}async[a54_0x127068(0x1a0)](_0xa49d9e){const _0x5f101b=a54_0x127068,_0xa3f2fd=await database_1['default']['shopSettings'][_0x5f101b(0x1ab)]({'where':{'shopId':_0xa49d9e}});!_0xa3f2fd&&await database_1['default'][_0x5f101b(0x1a7)][_0x5f101b(0x1ad)]({'data':{'shopId':_0xa49d9e}});}}exports[a54_0x127068(0x1a2)]=IntegrationsService;