'use strict';function a66_0x1ac2(){const _0x54b73f=['IntegrationsService','1606858bOHhGd','findUnique','string','shopSettings','webhookEvents','928IFcPxr','webhookUrl','create','4287696tFmLmR','defineProperty','parseWebhookEvents','updateWebhookSettings','__importDefault','isArray','default','3451458afhMgK','getIntegrations','5179305FFZNLz','ensureSettingsExist','../config/database','parse','update','2425173XEQIIO','149863lCOoXY','2831370OHMhJl','Shop\x20settings\x20not\x20found','__esModule'];a66_0x1ac2=function(){return _0x54b73f;};return a66_0x1ac2();}const a66_0x53750d=a66_0x439a;(function(_0x46d155,_0x495932){const _0x71c30c=a66_0x439a,_0x107c24=_0x46d155();while(!![]){try{const _0x4f91b2=parseInt(_0x71c30c(0x8b))/0x1+parseInt(_0x71c30c(0x87))/0x2+parseInt(_0x71c30c(0x85))/0x3+parseInt(_0x71c30c(0x93))/0x4+-parseInt(_0x71c30c(0x9c))/0x5+-parseInt(_0x71c30c(0x9a))/0x6+-parseInt(_0x71c30c(0x86))/0x7*(parseInt(_0x71c30c(0x90))/0x8);if(_0x4f91b2===_0x495932)break;else _0x107c24['push'](_0x107c24['shift']());}catch(_0x5ca4f6){_0x107c24['push'](_0x107c24['shift']());}}}(a66_0x1ac2,0xc5576));var __importDefault=this&&this[a66_0x53750d(0x97)]||function(_0x512510){const _0x3ae37e=a66_0x53750d;return _0x512510&&_0x512510[_0x3ae37e(0x89)]?_0x512510:{'default':_0x512510};};Object[a66_0x53750d(0x94)](exports,a66_0x53750d(0x89),{'value':!![]}),exports[a66_0x53750d(0x8a)]=void 0x0;const database_1=__importDefault(require(a66_0x53750d(0x9e)));function a66_0x439a(_0x48169d,_0x50efb2){_0x48169d=_0x48169d-0x83;const _0x1ac200=a66_0x1ac2();let _0x439acb=_0x1ac200[_0x48169d];return _0x439acb;}class IntegrationsService{[a66_0x53750d(0x95)](_0x17ee95){const _0x363e8d=a66_0x53750d;if(!_0x17ee95)return[];if(Array[_0x363e8d(0x98)](_0x17ee95))return _0x17ee95;if(typeof _0x17ee95===_0x363e8d(0x8d))try{const _0x48a35a=JSON[_0x363e8d(0x83)](_0x17ee95);return Array[_0x363e8d(0x98)](_0x48a35a)?_0x48a35a:[];}catch{return[];}return[];}async[a66_0x53750d(0x9b)](_0xeb3616){const _0x5d61d1=a66_0x53750d;await this[_0x5d61d1(0x9d)](_0xeb3616);const _0x54c046=await database_1[_0x5d61d1(0x99)][_0x5d61d1(0x8e)][_0x5d61d1(0x8c)]({'where':{'shopId':_0xeb3616},'select':{'webhookUrl':!![],'webhookEvents':!![]}});if(!_0x54c046)throw new Error(_0x5d61d1(0x88));return{'webhook':{'url':_0x54c046[_0x5d61d1(0x91)],'events':this['parseWebhookEvents'](_0x54c046[_0x5d61d1(0x8f)])}};}async[a66_0x53750d(0x96)](_0x2a1297,_0x1ae918){const _0xd8fed9=a66_0x53750d;await this[_0xd8fed9(0x9d)](_0x2a1297);const _0x3f8252={};_0x1ae918[_0xd8fed9(0x91)]!==undefined&&(_0x3f8252[_0xd8fed9(0x91)]=_0x1ae918[_0xd8fed9(0x91)]||null),_0x1ae918['webhookEvents']!==undefined&&(_0x3f8252[_0xd8fed9(0x8f)]=_0x1ae918[_0xd8fed9(0x8f)]||[]),await database_1[_0xd8fed9(0x99)][_0xd8fed9(0x8e)][_0xd8fed9(0x84)]({'where':{'shopId':_0x2a1297},'data':_0x3f8252});}async[a66_0x53750d(0x9d)](_0xedb62){const _0x4effbc=a66_0x53750d,_0x46ab0d=await database_1[_0x4effbc(0x99)]['shopSettings'][_0x4effbc(0x8c)]({'where':{'shopId':_0xedb62}});!_0x46ab0d&&await database_1['default'][_0x4effbc(0x8e)][_0x4effbc(0x92)]({'data':{'shopId':_0xedb62}});}}exports[a66_0x53750d(0x8a)]=IntegrationsService;