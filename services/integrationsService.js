'use strict';function a66_0x4b56(){const _0x5e7947=['create','../config/database','shopSettings','30550YAODTT','webhookUrl','defineProperty','4OTqHtU','660891hJyVnW','1121245fZHYxI','webhookEvents','Shop\x20settings\x20not\x20found','5890357KWAAen','updateWebhookSettings','457541uFowNz','24bNwYtv','927uGIRiO','__esModule','149730MUUsqR','9ylZjye','parseWebhookEvents','IntegrationsService','ensureSettingsExist','string','findUnique','default','__importDefault','1421124jenMVK','isArray','12WKaFAD'];a66_0x4b56=function(){return _0x5e7947;};return a66_0x4b56();}const a66_0x381e69=a66_0x2ba0;function a66_0x2ba0(_0x276cc0,_0x20d578){_0x276cc0=_0x276cc0-0x77;const _0x4b5634=a66_0x4b56();let _0x2ba037=_0x4b5634[_0x276cc0];return _0x2ba037;}(function(_0x15224c,_0x3ab01c){const _0x1c6e3c=a66_0x2ba0,_0x249526=_0x15224c();while(!![]){try{const _0x5ac403=-parseInt(_0x1c6e3c(0x88))/0x1+-parseInt(_0x1c6e3c(0x8c))/0x2*(-parseInt(_0x1c6e3c(0x8d))/0x3)+-parseInt(_0x1c6e3c(0x81))/0x4*(parseInt(_0x1c6e3c(0x83))/0x5)+parseInt(_0x1c6e3c(0x78))/0x6+parseInt(_0x1c6e3c(0x82))/0x7*(parseInt(_0x1c6e3c(0x89))/0x8)+parseInt(_0x1c6e3c(0x8a))/0x9*(-parseInt(_0x1c6e3c(0x7e))/0xa)+parseInt(_0x1c6e3c(0x86))/0xb*(parseInt(_0x1c6e3c(0x7a))/0xc);if(_0x5ac403===_0x3ab01c)break;else _0x249526['push'](_0x249526['shift']());}catch(_0x13eb1c){_0x249526['push'](_0x249526['shift']());}}}(a66_0x4b56,0x45448));var __importDefault=this&&this[a66_0x381e69(0x77)]||function(_0x55f43b){const _0x17ec67=a66_0x381e69;return _0x55f43b&&_0x55f43b[_0x17ec67(0x8b)]?_0x55f43b:{'default':_0x55f43b};};Object[a66_0x381e69(0x80)](exports,a66_0x381e69(0x8b),{'value':!![]}),exports['IntegrationsService']=void 0x0;const database_1=__importDefault(require(a66_0x381e69(0x7c)));class IntegrationsService{['parseWebhookEvents'](_0x4d6ec2){const _0xe2293c=a66_0x381e69;if(!_0x4d6ec2)return[];if(Array[_0xe2293c(0x79)](_0x4d6ec2))return _0x4d6ec2;if(typeof _0x4d6ec2===_0xe2293c(0x91))try{const _0x5e36d9=JSON['parse'](_0x4d6ec2);return Array[_0xe2293c(0x79)](_0x5e36d9)?_0x5e36d9:[];}catch{return[];}return[];}async['getIntegrations'](_0xc89e12){const _0x38ae48=a66_0x381e69;await this[_0x38ae48(0x90)](_0xc89e12);const _0x3a3854=await database_1['default'][_0x38ae48(0x7d)][_0x38ae48(0x92)]({'where':{'shopId':_0xc89e12},'select':{'webhookUrl':!![],'webhookEvents':!![]}});if(!_0x3a3854)throw new Error(_0x38ae48(0x85));return{'webhook':{'url':_0x3a3854[_0x38ae48(0x7f)],'events':this[_0x38ae48(0x8e)](_0x3a3854['webhookEvents'])}};}async[a66_0x381e69(0x87)](_0x578ccf,_0x5c6b63){const _0x1ac268=a66_0x381e69;await this[_0x1ac268(0x90)](_0x578ccf);const _0x4c1e01={};_0x5c6b63[_0x1ac268(0x7f)]!==undefined&&(_0x4c1e01[_0x1ac268(0x7f)]=_0x5c6b63[_0x1ac268(0x7f)]||null),_0x5c6b63[_0x1ac268(0x84)]!==undefined&&(_0x4c1e01[_0x1ac268(0x84)]=_0x5c6b63[_0x1ac268(0x84)]||[]),await database_1[_0x1ac268(0x93)][_0x1ac268(0x7d)]['update']({'where':{'shopId':_0x578ccf},'data':_0x4c1e01});}async[a66_0x381e69(0x90)](_0x4397a3){const _0x116842=a66_0x381e69,_0x2546a3=await database_1[_0x116842(0x93)][_0x116842(0x7d)][_0x116842(0x92)]({'where':{'shopId':_0x4397a3}});!_0x2546a3&&await database_1['default'][_0x116842(0x7d)][_0x116842(0x7b)]({'data':{'shopId':_0x4397a3}});}}exports[a66_0x381e69(0x8f)]=IntegrationsService;