'use strict';function a47_0x4bde(){const _0x449bb5=['IntegrationsService','309239Klnwgn','parseWebhookEvents','__importDefault','default','getIntegrations','30OHBPGK','2072005lHXOkv','isArray','create','26331740LisFDr','string','parse','webhookEvents','shopSettings','2264ffvOlE','3573648jbqFqG','981xbyHOQ','2693336TzYABA','ensureSettingsExist','update','webhookUrl','27cSEbLH','4428560pvMRmu'];a47_0x4bde=function(){return _0x449bb5;};return a47_0x4bde();}const a47_0x561811=a47_0x94db;function a47_0x94db(_0x1ecc39,_0xedb7a5){const _0x4bdeec=a47_0x4bde();return a47_0x94db=function(_0x94db4d,_0x5c87b6){_0x94db4d=_0x94db4d-0xcf;let _0x5493ca=_0x4bdeec[_0x94db4d];return _0x5493ca;},a47_0x94db(_0x1ecc39,_0xedb7a5);}(function(_0x4d3665,_0x58a7d8){const _0x45f28a=a47_0x94db,_0x2dba71=_0x4d3665();while(!![]){try{const _0x4f6c8d=-parseInt(_0x45f28a(0xe4))/0x1*(parseInt(_0x45f28a(0xe2))/0x2)+-parseInt(_0x45f28a(0xe3))/0x3+parseInt(_0x45f28a(0xd2))/0x4+parseInt(_0x45f28a(0xda))/0x5+-parseInt(_0x45f28a(0xd9))/0x6*(parseInt(_0x45f28a(0xd4))/0x7)+parseInt(_0x45f28a(0xe5))/0x8*(-parseInt(_0x45f28a(0xd1))/0x9)+parseInt(_0x45f28a(0xdd))/0xa;if(_0x4f6c8d===_0x58a7d8)break;else _0x2dba71['push'](_0x2dba71['shift']());}catch(_0x2312c9){_0x2dba71['push'](_0x2dba71['shift']());}}}(a47_0x4bde,0x97e29));var __importDefault=this&&this[a47_0x561811(0xd6)]||function(_0xb00519){return _0xb00519&&_0xb00519['__esModule']?_0xb00519:{'default':_0xb00519};};Object['defineProperty'](exports,'__esModule',{'value':!![]}),exports[a47_0x561811(0xd3)]=void 0x0;const database_1=__importDefault(require('../config/database'));class IntegrationsService{[a47_0x561811(0xd5)](_0x4377dc){const _0x185c3b=a47_0x561811;if(!_0x4377dc)return[];if(Array[_0x185c3b(0xdb)](_0x4377dc))return _0x4377dc;if(typeof _0x4377dc===_0x185c3b(0xde))try{const _0x4f2044=JSON[_0x185c3b(0xdf)](_0x4377dc);return Array[_0x185c3b(0xdb)](_0x4f2044)?_0x4f2044:[];}catch{return[];}return[];}async[a47_0x561811(0xd8)](_0x2cbe05){const _0x46165d=a47_0x561811;await this[_0x46165d(0xe6)](_0x2cbe05);const _0xe85279=await database_1[_0x46165d(0xd7)][_0x46165d(0xe1)]['findUnique']({'where':{'shopId':_0x2cbe05},'select':{'webhookUrl':!![],'webhookEvents':!![]}});if(!_0xe85279)throw new Error('Shop\x20settings\x20not\x20found');return{'webhook':{'url':_0xe85279['webhookUrl'],'events':this['parseWebhookEvents'](_0xe85279['webhookEvents'])}};}async['updateWebhookSettings'](_0xdfb81b,_0x22b310){const _0x173c75=a47_0x561811;await this[_0x173c75(0xe6)](_0xdfb81b);const _0x593ec8={};_0x22b310['webhookUrl']!==undefined&&(_0x593ec8['webhookUrl']=_0x22b310[_0x173c75(0xd0)]||null),_0x22b310[_0x173c75(0xe0)]!==undefined&&(_0x593ec8['webhookEvents']=_0x22b310['webhookEvents']||[]),await database_1['default'][_0x173c75(0xe1)][_0x173c75(0xcf)]({'where':{'shopId':_0xdfb81b},'data':_0x593ec8});}async[a47_0x561811(0xe6)](_0x1efaf8){const _0x158e75=a47_0x561811,_0x4d8cc5=await database_1['default'][_0x158e75(0xe1)]['findUnique']({'where':{'shopId':_0x1efaf8}});!_0x4d8cc5&&await database_1['default']['shopSettings'][_0x158e75(0xdc)]({'data':{'shopId':_0x1efaf8}});}}exports[a47_0x561811(0xd3)]=IntegrationsService;