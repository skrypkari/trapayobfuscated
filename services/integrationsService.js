'use strict';const a50_0x24d221=a50_0x43fb;(function(_0x1d45d8,_0x11af14){const _0x13987a=a50_0x43fb,_0x4ee462=_0x1d45d8();while(!![]){try{const _0x3306b6=-parseInt(_0x13987a(0x191))/0x1*(parseInt(_0x13987a(0x18c))/0x2)+-parseInt(_0x13987a(0x185))/0x3+-parseInt(_0x13987a(0x18d))/0x4+-parseInt(_0x13987a(0x190))/0x5+-parseInt(_0x13987a(0x189))/0x6+-parseInt(_0x13987a(0x192))/0x7+parseInt(_0x13987a(0x196))/0x8;if(_0x3306b6===_0x11af14)break;else _0x4ee462['push'](_0x4ee462['shift']());}catch(_0x13d9cf){_0x4ee462['push'](_0x4ee462['shift']());}}}(a50_0x9a10,0xc42f3));var __importDefault=this&&this[a50_0x24d221(0x19a)]||function(_0x40c8ae){const _0x5b405c=a50_0x24d221;return _0x40c8ae&&_0x40c8ae[_0x5b405c(0x188)]?_0x40c8ae:{'default':_0x40c8ae};};Object[a50_0x24d221(0x199)](exports,a50_0x24d221(0x188),{'value':!![]}),exports[a50_0x24d221(0x184)]=void 0x0;function a50_0x9a10(){const _0x4c9fbb=['IntegrationsService','665244MpGlfS','shopSettings','default','__esModule','1963044KmHTkL','create','parseWebhookEvents','1255106RVsOzw','4915992PiyiDk','updateWebhookSettings','findUnique','1639140TjfNwd','2USbNLO','10845429Bvjolr','Shop\x20settings\x20not\x20found','../config/database','isArray','45710176hjGTZh','webhookUrl','ensureSettingsExist','defineProperty','__importDefault','string','webhookEvents'];a50_0x9a10=function(){return _0x4c9fbb;};return a50_0x9a10();}const database_1=__importDefault(require(a50_0x24d221(0x194)));class IntegrationsService{[a50_0x24d221(0x18b)](_0x31c299){const _0x42d940=a50_0x24d221;if(!_0x31c299)return[];if(Array[_0x42d940(0x195)](_0x31c299))return _0x31c299;if(typeof _0x31c299===_0x42d940(0x19b))try{const _0x5c4d82=JSON['parse'](_0x31c299);return Array[_0x42d940(0x195)](_0x5c4d82)?_0x5c4d82:[];}catch{return[];}return[];}async['getIntegrations'](_0x4d7999){const _0x1fe0a9=a50_0x24d221;await this['ensureSettingsExist'](_0x4d7999);const _0x37749f=await database_1[_0x1fe0a9(0x187)]['shopSettings'][_0x1fe0a9(0x18f)]({'where':{'shopId':_0x4d7999},'select':{'webhookUrl':!![],'webhookEvents':!![]}});if(!_0x37749f)throw new Error(_0x1fe0a9(0x193));return{'webhook':{'url':_0x37749f[_0x1fe0a9(0x197)],'events':this[_0x1fe0a9(0x18b)](_0x37749f['webhookEvents'])}};}async[a50_0x24d221(0x18e)](_0x375c7e,_0xfec1b0){const _0x442b1b=a50_0x24d221;await this[_0x442b1b(0x198)](_0x375c7e);const _0x48c137={};_0xfec1b0[_0x442b1b(0x197)]!==undefined&&(_0x48c137[_0x442b1b(0x197)]=_0xfec1b0['webhookUrl']||null),_0xfec1b0['webhookEvents']!==undefined&&(_0x48c137['webhookEvents']=_0xfec1b0[_0x442b1b(0x183)]||[]),await database_1[_0x442b1b(0x187)]['shopSettings']['update']({'where':{'shopId':_0x375c7e},'data':_0x48c137});}async[a50_0x24d221(0x198)](_0x169f3a){const _0x173585=a50_0x24d221,_0x45b609=await database_1[_0x173585(0x187)][_0x173585(0x186)][_0x173585(0x18f)]({'where':{'shopId':_0x169f3a}});!_0x45b609&&await database_1[_0x173585(0x187)]['shopSettings'][_0x173585(0x18a)]({'data':{'shopId':_0x169f3a}});}}function a50_0x43fb(_0x445c8b,_0x2758f7){const _0x9a1059=a50_0x9a10();return a50_0x43fb=function(_0x43fb0f,_0xcf51af){_0x43fb0f=_0x43fb0f-0x183;let _0x51c7d8=_0x9a1059[_0x43fb0f];return _0x51c7d8;},a50_0x43fb(_0x445c8b,_0x2758f7);}exports[a50_0x24d221(0x184)]=IntegrationsService;