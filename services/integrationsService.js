'use strict';const a43_0xe7843=a43_0x1a00;(function(_0x425d7d,_0x44fcde){const _0x3bc176=a43_0x1a00,_0x479060=_0x425d7d();while(!![]){try{const _0x3c8038=-parseInt(_0x3bc176(0xd5))/0x1+parseInt(_0x3bc176(0xe1))/0x2*(parseInt(_0x3bc176(0xe4))/0x3)+-parseInt(_0x3bc176(0xdc))/0x4+parseInt(_0x3bc176(0xdb))/0x5+-parseInt(_0x3bc176(0xe0))/0x6*(parseInt(_0x3bc176(0xd7))/0x7)+parseInt(_0x3bc176(0xe6))/0x8+parseInt(_0x3bc176(0xd0))/0x9;if(_0x3c8038===_0x44fcde)break;else _0x479060['push'](_0x479060['shift']());}catch(_0x5e2ede){_0x479060['push'](_0x479060['shift']());}}}(a43_0x252b,0xac41a));function a43_0x1a00(_0x521a49,_0xb7e30e){const _0x252bc7=a43_0x252b();return a43_0x1a00=function(_0x1a0072,_0x480590){_0x1a0072=_0x1a0072-0xce;let _0x3273da=_0x252bc7[_0x1a0072];return _0x3273da;},a43_0x1a00(_0x521a49,_0xb7e30e);}var __importDefault=this&&this[a43_0xe7843(0xe3)]||function(_0x22169a){const _0x1906c6=a43_0xe7843;return _0x22169a&&_0x22169a[_0x1906c6(0xe5)]?_0x22169a:{'default':_0x22169a};};Object['defineProperty'](exports,'__esModule',{'value':!![]}),exports[a43_0xe7843(0xcf)]=void 0x0;const database_1=__importDefault(require(a43_0xe7843(0xd2)));function a43_0x252b(){const _0x5ab6aa=['ensureSettingsExist','367110OAvlbq','4727100cnQvrW','parse','string','parseWebhookEvents','877998XunLtp','1181290SyNnhz','webhookEvents','__importDefault','6KpEeNy','__esModule','4846016FDoqgg','create','default','IntegrationsService','19003347MQpeIa','webhookUrl','../config/database','isArray','Shop\x20settings\x20not\x20found','1206612XenjBI','findUnique','42hAATPK','updateWebhookSettings','shopSettings'];a43_0x252b=function(){return _0x5ab6aa;};return a43_0x252b();}class IntegrationsService{[a43_0xe7843(0xdf)](_0x4693ca){const _0x2a1d35=a43_0xe7843;if(!_0x4693ca)return[];if(Array[_0x2a1d35(0xd3)](_0x4693ca))return _0x4693ca;if(typeof _0x4693ca===_0x2a1d35(0xde))try{const _0x106ff9=JSON[_0x2a1d35(0xdd)](_0x4693ca);return Array[_0x2a1d35(0xd3)](_0x106ff9)?_0x106ff9:[];}catch{return[];}return[];}async['getIntegrations'](_0x39cb19){const _0x5a3fbb=a43_0xe7843;await this[_0x5a3fbb(0xda)](_0x39cb19);const _0x312045=await database_1[_0x5a3fbb(0xce)][_0x5a3fbb(0xd9)][_0x5a3fbb(0xd6)]({'where':{'shopId':_0x39cb19},'select':{'webhookUrl':!![],'webhookEvents':!![]}});if(!_0x312045)throw new Error(_0x5a3fbb(0xd4));return{'webhook':{'url':_0x312045['webhookUrl'],'events':this[_0x5a3fbb(0xdf)](_0x312045[_0x5a3fbb(0xe2)])}};}async[a43_0xe7843(0xd8)](_0x5ef241,_0x3c0ce4){const _0x5e9cd1=a43_0xe7843;await this[_0x5e9cd1(0xda)](_0x5ef241);const _0x192172={};_0x3c0ce4[_0x5e9cd1(0xd1)]!==undefined&&(_0x192172[_0x5e9cd1(0xd1)]=_0x3c0ce4[_0x5e9cd1(0xd1)]||null),_0x3c0ce4[_0x5e9cd1(0xe2)]!==undefined&&(_0x192172['webhookEvents']=_0x3c0ce4[_0x5e9cd1(0xe2)]||[]),await database_1[_0x5e9cd1(0xce)][_0x5e9cd1(0xd9)]['update']({'where':{'shopId':_0x5ef241},'data':_0x192172});}async[a43_0xe7843(0xda)](_0x3d77b0){const _0x50fdbc=a43_0xe7843,_0x435dbc=await database_1[_0x50fdbc(0xce)]['shopSettings'][_0x50fdbc(0xd6)]({'where':{'shopId':_0x3d77b0}});!_0x435dbc&&await database_1[_0x50fdbc(0xce)][_0x50fdbc(0xd9)][_0x50fdbc(0xe7)]({'data':{'shopId':_0x3d77b0}});}}exports['IntegrationsService']=IntegrationsService;