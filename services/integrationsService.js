'use strict';const a47_0x12b1f3=a47_0x261d;function a47_0x261d(_0x52bd21,_0x5e6a61){const _0x1d4a64=a47_0x1d4a();return a47_0x261d=function(_0x261d28,_0x5780cb){_0x261d28=_0x261d28-0x184;let _0x55befc=_0x1d4a64[_0x261d28];return _0x55befc;},a47_0x261d(_0x52bd21,_0x5e6a61);}(function(_0x3ce108,_0x1999c2){const _0x57781a=a47_0x261d,_0x422ab1=_0x3ce108();while(!![]){try{const _0x3f3317=-parseInt(_0x57781a(0x198))/0x1+parseInt(_0x57781a(0x19c))/0x2+parseInt(_0x57781a(0x18c))/0x3*(-parseInt(_0x57781a(0x184))/0x4)+-parseInt(_0x57781a(0x195))/0x5+-parseInt(_0x57781a(0x19a))/0x6*(-parseInt(_0x57781a(0x188))/0x7)+parseInt(_0x57781a(0x196))/0x8*(parseInt(_0x57781a(0x19b))/0x9)+parseInt(_0x57781a(0x185))/0xa;if(_0x3f3317===_0x1999c2)break;else _0x422ab1['push'](_0x422ab1['shift']());}catch(_0x5d550b){_0x422ab1['push'](_0x422ab1['shift']());}}}(a47_0x1d4a,0xa9f7a));function a47_0x1d4a(){const _0x52f4b3=['1805720vnmfef','webhookEvents','__importDefault','14nSfSpk','findUnique','__esModule','../config/database','12GgiOPP','string','Shop\x20settings\x20not\x20found','update','ensureSettingsExist','shopSettings','parse','isArray','IntegrationsService','4574870KQfdEJ','8oUMHPP','getIntegrations','176599dTZgEi','webhookUrl','1733304aUKZhB','7953633HGaton','2417220xiiSPf','parseWebhookEvents','default','1062928LFKDJh'];a47_0x1d4a=function(){return _0x52f4b3;};return a47_0x1d4a();}var __importDefault=this&&this[a47_0x12b1f3(0x187)]||function(_0xf6ca09){return _0xf6ca09&&_0xf6ca09['__esModule']?_0xf6ca09:{'default':_0xf6ca09};};Object['defineProperty'](exports,a47_0x12b1f3(0x18a),{'value':!![]}),exports['IntegrationsService']=void 0x0;const database_1=__importDefault(require(a47_0x12b1f3(0x18b)));class IntegrationsService{[a47_0x12b1f3(0x19d)](_0x239187){const _0x5e33a2=a47_0x12b1f3;if(!_0x239187)return[];if(Array[_0x5e33a2(0x193)](_0x239187))return _0x239187;if(typeof _0x239187===_0x5e33a2(0x18d))try{const _0x463abb=JSON[_0x5e33a2(0x192)](_0x239187);return Array[_0x5e33a2(0x193)](_0x463abb)?_0x463abb:[];}catch{return[];}return[];}async[a47_0x12b1f3(0x197)](_0x331a01){const _0x16b5d3=a47_0x12b1f3;await this['ensureSettingsExist'](_0x331a01);const _0x30f887=await database_1[_0x16b5d3(0x19e)][_0x16b5d3(0x191)][_0x16b5d3(0x189)]({'where':{'shopId':_0x331a01},'select':{'webhookUrl':!![],'webhookEvents':!![]}});if(!_0x30f887)throw new Error(_0x16b5d3(0x18e));return{'webhook':{'url':_0x30f887[_0x16b5d3(0x199)],'events':this[_0x16b5d3(0x19d)](_0x30f887[_0x16b5d3(0x186)])}};}async['updateWebhookSettings'](_0x55d89d,_0x47dd5c){const _0x53440d=a47_0x12b1f3;await this[_0x53440d(0x190)](_0x55d89d);const _0x16b12a={};_0x47dd5c[_0x53440d(0x199)]!==undefined&&(_0x16b12a[_0x53440d(0x199)]=_0x47dd5c[_0x53440d(0x199)]||null),_0x47dd5c[_0x53440d(0x186)]!==undefined&&(_0x16b12a['webhookEvents']=_0x47dd5c[_0x53440d(0x186)]||[]),await database_1[_0x53440d(0x19e)]['shopSettings'][_0x53440d(0x18f)]({'where':{'shopId':_0x55d89d},'data':_0x16b12a});}async[a47_0x12b1f3(0x190)](_0x8bcd9c){const _0xa519a6=a47_0x12b1f3,_0x346f91=await database_1['default'][_0xa519a6(0x191)][_0xa519a6(0x189)]({'where':{'shopId':_0x8bcd9c}});!_0x346f91&&await database_1[_0xa519a6(0x19e)]['shopSettings']['create']({'data':{'shopId':_0x8bcd9c}});}}exports[a47_0x12b1f3(0x194)]=IntegrationsService;