'use strict';const a47_0xfee40a=a47_0x3350;function a47_0x3350(_0x15eae9,_0x425195){const _0x5f0586=a47_0x5f05();return a47_0x3350=function(_0x335074,_0x54ef42){_0x335074=_0x335074-0x99;let _0x332ac3=_0x5f0586[_0x335074];return _0x332ac3;},a47_0x3350(_0x15eae9,_0x425195);}(function(_0x5c33e0,_0x5733df){const _0x45abbe=a47_0x3350,_0x9dd8a5=_0x5c33e0();while(!![]){try{const _0x4d3f9b=parseInt(_0x45abbe(0xa8))/0x1*(parseInt(_0x45abbe(0xae))/0x2)+parseInt(_0x45abbe(0xa1))/0x3*(parseInt(_0x45abbe(0x9d))/0x4)+-parseInt(_0x45abbe(0xa2))/0x5*(parseInt(_0x45abbe(0xb0))/0x6)+parseInt(_0x45abbe(0x9e))/0x7+parseInt(_0x45abbe(0xa4))/0x8+-parseInt(_0x45abbe(0xaf))/0x9+-parseInt(_0x45abbe(0xac))/0xa*(-parseInt(_0x45abbe(0x9b))/0xb);if(_0x4d3f9b===_0x5733df)break;else _0x9dd8a5['push'](_0x9dd8a5['shift']());}catch(_0x43fca2){_0x9dd8a5['push'](_0x9dd8a5['shift']());}}}(a47_0x5f05,0x86fb6));var __importDefault=this&&this[a47_0xfee40a(0xa6)]||function(_0x2f5d56){const _0x271541=a47_0xfee40a;return _0x2f5d56&&_0x2f5d56[_0x271541(0x9a)]?_0x2f5d56:{'default':_0x2f5d56};};Object[a47_0xfee40a(0xa0)](exports,a47_0xfee40a(0x9a),{'value':!![]}),exports[a47_0xfee40a(0xa9)]=void 0x0;const database_1=__importDefault(require(a47_0xfee40a(0xa3)));class IntegrationsService{['parseWebhookEvents'](_0x1124ed){const _0x15d6aa=a47_0xfee40a;if(!_0x1124ed)return[];if(Array['isArray'](_0x1124ed))return _0x1124ed;if(typeof _0x1124ed===_0x15d6aa(0xad))try{const _0x536995=JSON[_0x15d6aa(0xab)](_0x1124ed);return Array[_0x15d6aa(0xaa)](_0x536995)?_0x536995:[];}catch{return[];}return[];}async[a47_0xfee40a(0x9f)](_0x4d628c){const _0x254925=a47_0xfee40a;await this[_0x254925(0xb4)](_0x4d628c);const _0x569004=await database_1['default'][_0x254925(0x99)][_0x254925(0xb1)]({'where':{'shopId':_0x4d628c},'select':{'webhookUrl':!![],'webhookEvents':!![]}});if(!_0x569004)throw new Error(_0x254925(0xa7));return{'webhook':{'url':_0x569004[_0x254925(0xb2)],'events':this['parseWebhookEvents'](_0x569004['webhookEvents'])}};}async['updateWebhookSettings'](_0x1ce538,_0x20be2f){const _0x8756a7=a47_0xfee40a;await this[_0x8756a7(0xb4)](_0x1ce538);const _0xde284e={};_0x20be2f[_0x8756a7(0xb2)]!==undefined&&(_0xde284e['webhookUrl']=_0x20be2f['webhookUrl']||null),_0x20be2f['webhookEvents']!==undefined&&(_0xde284e[_0x8756a7(0xb3)]=_0x20be2f[_0x8756a7(0xb3)]||[]),await database_1[_0x8756a7(0x9c)][_0x8756a7(0x99)][_0x8756a7(0xa5)]({'where':{'shopId':_0x1ce538},'data':_0xde284e});}async[a47_0xfee40a(0xb4)](_0x56fc60){const _0x5ed0d5=a47_0xfee40a,_0x52a180=await database_1[_0x5ed0d5(0x9c)][_0x5ed0d5(0x99)]['findUnique']({'where':{'shopId':_0x56fc60}});!_0x52a180&&await database_1[_0x5ed0d5(0x9c)]['shopSettings']['create']({'data':{'shopId':_0x56fc60}});}}function a47_0x5f05(){const _0x565b61=['default','2757740ruYWPr','94423moZmMl','getIntegrations','defineProperty','3NJiUhp','4570395omQTMy','../config/database','1143384UWZmPJ','update','__importDefault','Shop\x20settings\x20not\x20found','1nISsmy','IntegrationsService','isArray','parse','10aUpPKD','string','1344788kvsmmB','1055016uWLgGN','6IzAaAm','findUnique','webhookUrl','webhookEvents','ensureSettingsExist','shopSettings','__esModule','725428LrpGAu'];a47_0x5f05=function(){return _0x565b61;};return a47_0x5f05();}exports['IntegrationsService']=IntegrationsService;