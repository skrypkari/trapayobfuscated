'use strict';const a70_0xd00618=a70_0x1a69;(function(_0x59375e,_0x499fa9){const _0x3416fd=a70_0x1a69,_0x3ead0d=_0x59375e();while(!![]){try{const _0x13f686=-parseInt(_0x3416fd(0x7f))/0x1+parseInt(_0x3416fd(0x75))/0x2+-parseInt(_0x3416fd(0x7a))/0x3*(parseInt(_0x3416fd(0x79))/0x4)+-parseInt(_0x3416fd(0x88))/0x5+parseInt(_0x3416fd(0x84))/0x6+parseInt(_0x3416fd(0x7d))/0x7*(-parseInt(_0x3416fd(0x76))/0x8)+parseInt(_0x3416fd(0x8b))/0x9;if(_0x13f686===_0x499fa9)break;else _0x3ead0d['push'](_0x3ead0d['shift']());}catch(_0x94cfea){_0x3ead0d['push'](_0x3ead0d['shift']());}}}(a70_0x53a7,0xc7a0a));function a70_0x53a7(){const _0x4f8a72=['webhookEvents','7959tSNIdR','__esModule','268241ijSnGj','parse','isArray','string','shopSettings','7667538UXnCdi','update','../config/database','IntegrationsService','3119550iuckIM','default','webhookUrl','10166085pkeOKt','defineProperty','3065052NTYeWp','9168uNtNCn','findUnique','parseWebhookEvents','4RXcVqa','2781561ECHxdP','ensureSettingsExist'];a70_0x53a7=function(){return _0x4f8a72;};return a70_0x53a7();}var __importDefault=this&&this['__importDefault']||function(_0x11a954){const _0x34dbf8=a70_0x1a69;return _0x11a954&&_0x11a954[_0x34dbf8(0x7e)]?_0x11a954:{'default':_0x11a954};};Object[a70_0xd00618(0x74)](exports,'__esModule',{'value':!![]}),exports[a70_0xd00618(0x87)]=void 0x0;const database_1=__importDefault(require(a70_0xd00618(0x86)));class IntegrationsService{[a70_0xd00618(0x78)](_0x4fe398){const _0x51187f=a70_0xd00618;if(!_0x4fe398)return[];if(Array[_0x51187f(0x81)](_0x4fe398))return _0x4fe398;if(typeof _0x4fe398===_0x51187f(0x82))try{const _0x41d44f=JSON[_0x51187f(0x80)](_0x4fe398);return Array[_0x51187f(0x81)](_0x41d44f)?_0x41d44f:[];}catch{return[];}return[];}async['getIntegrations'](_0x1bff80){const _0x12ebcc=a70_0xd00618;await this['ensureSettingsExist'](_0x1bff80);const _0x4d5089=await database_1['default']['shopSettings']['findUnique']({'where':{'shopId':_0x1bff80},'select':{'webhookUrl':!![],'webhookEvents':!![]}});if(!_0x4d5089)throw new Error('Shop\x20settings\x20not\x20found');return{'webhook':{'url':_0x4d5089[_0x12ebcc(0x8a)],'events':this['parseWebhookEvents'](_0x4d5089['webhookEvents'])}};}async['updateWebhookSettings'](_0x2d15f8,_0x172e96){const _0x175f92=a70_0xd00618;await this[_0x175f92(0x7b)](_0x2d15f8);const _0x29be02={};_0x172e96['webhookUrl']!==undefined&&(_0x29be02[_0x175f92(0x8a)]=_0x172e96['webhookUrl']||null),_0x172e96[_0x175f92(0x7c)]!==undefined&&(_0x29be02[_0x175f92(0x7c)]=_0x172e96[_0x175f92(0x7c)]||[]),await database_1['default']['shopSettings'][_0x175f92(0x85)]({'where':{'shopId':_0x2d15f8},'data':_0x29be02});}async[a70_0xd00618(0x7b)](_0x4814ce){const _0x9af7f0=a70_0xd00618,_0x2a51e2=await database_1[_0x9af7f0(0x89)][_0x9af7f0(0x83)][_0x9af7f0(0x77)]({'where':{'shopId':_0x4814ce}});!_0x2a51e2&&await database_1[_0x9af7f0(0x89)][_0x9af7f0(0x83)]['create']({'data':{'shopId':_0x4814ce}});}}function a70_0x1a69(_0x5aad26,_0x4f5f4f){_0x5aad26=_0x5aad26-0x74;const _0x53a74f=a70_0x53a7();let _0x1a699f=_0x53a74f[_0x5aad26];return _0x1a699f;}exports[a70_0xd00618(0x87)]=IntegrationsService;