'use strict';const a52_0x1e1e41=a52_0x5510;(function(_0x59d2df,_0x5dbfc3){const _0x87f6ea=a52_0x5510,_0x1b5c1b=_0x59d2df();while(!![]){try{const _0x4cb036=parseInt(_0x87f6ea(0x200))/0x1+parseInt(_0x87f6ea(0x1fb))/0x2+parseInt(_0x87f6ea(0x1f1))/0x3+-parseInt(_0x87f6ea(0x208))/0x4*(parseInt(_0x87f6ea(0x1fe))/0x5)+parseInt(_0x87f6ea(0x203))/0x6+-parseInt(_0x87f6ea(0x1f5))/0x7*(parseInt(_0x87f6ea(0x1f7))/0x8)+-parseInt(_0x87f6ea(0x1fa))/0x9;if(_0x4cb036===_0x5dbfc3)break;else _0x1b5c1b['push'](_0x1b5c1b['shift']());}catch(_0xca30a0){_0x1b5c1b['push'](_0x1b5c1b['shift']());}}}(a52_0x2a47,0x1db7a));function a52_0x2a47(){const _0x330978=['__esModule','webhookEvents','829176loLkOJ','ensureSettingsExist','findUnique','../config/database','parse','16924pzcAOj','string','getIntegrations','isArray','330876Zfaywm','shopSettings','default','Shop\x20settings\x20not\x20found','7yAeDAN','updateWebhookSettings','209096NCAWmW','parseWebhookEvents','create','2703564xFALJH','182084NfwcmJ','update','webhookUrl','5zXZNcZ','IntegrationsService','112956YNqaVq'];a52_0x2a47=function(){return _0x330978;};return a52_0x2a47();}function a52_0x5510(_0x4fc9ae,_0x3dfc7d){const _0x2a47f0=a52_0x2a47();return a52_0x5510=function(_0x55106b,_0x206833){_0x55106b=_0x55106b-0x1ee;let _0x266c71=_0x2a47f0[_0x55106b];return _0x266c71;},a52_0x5510(_0x4fc9ae,_0x3dfc7d);}var __importDefault=this&&this['__importDefault']||function(_0x3045cd){const _0x5ae41c=a52_0x5510;return _0x3045cd&&_0x3045cd[_0x5ae41c(0x201)]?_0x3045cd:{'default':_0x3045cd};};Object['defineProperty'](exports,a52_0x1e1e41(0x201),{'value':!![]}),exports[a52_0x1e1e41(0x1ff)]=void 0x0;const database_1=__importDefault(require(a52_0x1e1e41(0x206)));class IntegrationsService{[a52_0x1e1e41(0x1f8)](_0x571f30){const _0x3a6689=a52_0x1e1e41;if(!_0x571f30)return[];if(Array[_0x3a6689(0x1f0)](_0x571f30))return _0x571f30;if(typeof _0x571f30===_0x3a6689(0x1ee))try{const _0x5685b4=JSON[_0x3a6689(0x207)](_0x571f30);return Array[_0x3a6689(0x1f0)](_0x5685b4)?_0x5685b4:[];}catch{return[];}return[];}async[a52_0x1e1e41(0x1ef)](_0x153118){const _0x18b649=a52_0x1e1e41;await this[_0x18b649(0x204)](_0x153118);const _0x5130b4=await database_1[_0x18b649(0x1f3)][_0x18b649(0x1f2)][_0x18b649(0x205)]({'where':{'shopId':_0x153118},'select':{'webhookUrl':!![],'webhookEvents':!![]}});if(!_0x5130b4)throw new Error(_0x18b649(0x1f4));return{'webhook':{'url':_0x5130b4['webhookUrl'],'events':this[_0x18b649(0x1f8)](_0x5130b4[_0x18b649(0x202)])}};}async[a52_0x1e1e41(0x1f6)](_0x5e80f7,_0xb438e3){const _0x5009b1=a52_0x1e1e41;await this[_0x5009b1(0x204)](_0x5e80f7);const _0x44a9ed={};_0xb438e3[_0x5009b1(0x1fd)]!==undefined&&(_0x44a9ed[_0x5009b1(0x1fd)]=_0xb438e3[_0x5009b1(0x1fd)]||null),_0xb438e3[_0x5009b1(0x202)]!==undefined&&(_0x44a9ed[_0x5009b1(0x202)]=_0xb438e3['webhookEvents']||[]),await database_1[_0x5009b1(0x1f3)][_0x5009b1(0x1f2)][_0x5009b1(0x1fc)]({'where':{'shopId':_0x5e80f7},'data':_0x44a9ed});}async[a52_0x1e1e41(0x204)](_0x2e0b1f){const _0x3eba1b=a52_0x1e1e41,_0x17a8e6=await database_1[_0x3eba1b(0x1f3)][_0x3eba1b(0x1f2)][_0x3eba1b(0x205)]({'where':{'shopId':_0x2e0b1f}});!_0x17a8e6&&await database_1[_0x3eba1b(0x1f3)][_0x3eba1b(0x1f2)][_0x3eba1b(0x1f9)]({'data':{'shopId':_0x2e0b1f}});}}exports[a52_0x1e1e41(0x1ff)]=IntegrationsService;