'use strict';const a46_0x350ccc=a46_0x3864;(function(_0x344ee4,_0x325724){const _0x148c58=a46_0x3864,_0x315979=_0x344ee4();while(!![]){try{const _0x4005aa=-parseInt(_0x148c58(0x1f3))/0x1*(parseInt(_0x148c58(0x1fc))/0x2)+-parseInt(_0x148c58(0x1ff))/0x3+parseInt(_0x148c58(0x1fa))/0x4*(parseInt(_0x148c58(0x1ec))/0x5)+-parseInt(_0x148c58(0x1f4))/0x6+parseInt(_0x148c58(0x200))/0x7*(-parseInt(_0x148c58(0x1ef))/0x8)+-parseInt(_0x148c58(0x1ee))/0x9+parseInt(_0x148c58(0x1fe))/0xa;if(_0x4005aa===_0x325724)break;else _0x315979['push'](_0x315979['shift']());}catch(_0x2ee64d){_0x315979['push'](_0x315979['shift']());}}}(a46_0xa231,0x5ad06));var __importDefault=this&&this[a46_0x350ccc(0x202)]||function(_0x540d40){const _0x1d3039=a46_0x350ccc;return _0x540d40&&_0x540d40[_0x1d3039(0x1f7)]?_0x540d40:{'default':_0x540d40};};function a46_0x3864(_0x27e483,_0x1b96b4){const _0xa231e4=a46_0xa231();return a46_0x3864=function(_0x386445,_0x11bf68){_0x386445=_0x386445-0x1e8;let _0x41ff3d=_0xa231e4[_0x386445];return _0x41ff3d;},a46_0x3864(_0x27e483,_0x1b96b4);}function a46_0xa231(){const _0x669518=['112mOaPZA','../config/database','ensureSettingsExist','string','305337ELgpzU','2869428aVfyJx','Shop\x20settings\x20not\x20found','shopSettings','__esModule','defineProperty','IntegrationsService','4aSoVwc','create','2sNFuOV','parseWebhookEvents','27802820YETDlQ','2139429UvCKWR','341474mCMibC','default','__importDefault','update','findUnique','webhookUrl','parse','isArray','webhookEvents','266375jNZVOj','getIntegrations','2537253SNMemA'];a46_0xa231=function(){return _0x669518;};return a46_0xa231();}Object[a46_0x350ccc(0x1f8)](exports,'__esModule',{'value':!![]}),exports['IntegrationsService']=void 0x0;const database_1=__importDefault(require(a46_0x350ccc(0x1f0)));class IntegrationsService{[a46_0x350ccc(0x1fd)](_0x37ddc9){const _0x407f45=a46_0x350ccc;if(!_0x37ddc9)return[];if(Array[_0x407f45(0x1ea)](_0x37ddc9))return _0x37ddc9;if(typeof _0x37ddc9===_0x407f45(0x1f2))try{const _0x7125e9=JSON[_0x407f45(0x1e9)](_0x37ddc9);return Array[_0x407f45(0x1ea)](_0x7125e9)?_0x7125e9:[];}catch{return[];}return[];}async[a46_0x350ccc(0x1ed)](_0x2db945){const _0x4aee4e=a46_0x350ccc;await this['ensureSettingsExist'](_0x2db945);const _0x10a19f=await database_1['default'][_0x4aee4e(0x1f6)][_0x4aee4e(0x204)]({'where':{'shopId':_0x2db945},'select':{'webhookUrl':!![],'webhookEvents':!![]}});if(!_0x10a19f)throw new Error(_0x4aee4e(0x1f5));return{'webhook':{'url':_0x10a19f['webhookUrl'],'events':this[_0x4aee4e(0x1fd)](_0x10a19f[_0x4aee4e(0x1eb)])}};}async['updateWebhookSettings'](_0x130bb3,_0x1bee49){const _0x45ec14=a46_0x350ccc;await this[_0x45ec14(0x1f1)](_0x130bb3);const _0xbc325e={};_0x1bee49[_0x45ec14(0x1e8)]!==undefined&&(_0xbc325e[_0x45ec14(0x1e8)]=_0x1bee49['webhookUrl']||null),_0x1bee49[_0x45ec14(0x1eb)]!==undefined&&(_0xbc325e['webhookEvents']=_0x1bee49[_0x45ec14(0x1eb)]||[]),await database_1[_0x45ec14(0x201)][_0x45ec14(0x1f6)][_0x45ec14(0x203)]({'where':{'shopId':_0x130bb3},'data':_0xbc325e});}async[a46_0x350ccc(0x1f1)](_0x30d568){const _0x5a540b=a46_0x350ccc,_0xf123d6=await database_1[_0x5a540b(0x201)][_0x5a540b(0x1f6)][_0x5a540b(0x204)]({'where':{'shopId':_0x30d568}});!_0xf123d6&&await database_1['default']['shopSettings'][_0x5a540b(0x1fb)]({'data':{'shopId':_0x30d568}});}}exports[a46_0x350ccc(0x1f9)]=IntegrationsService;