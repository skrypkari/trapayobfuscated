'use strict';function a47_0x11a7(){const _0xb0787b=['8719528uYDxkG','9rZxoDV','string','ensureSettingsExist','getIntegrations','create','3tvaFax','shopSettings','114303xfoRBG','../config/database','defineProperty','isArray','1976866DsBDhm','1037671TFdNow','__esModule','findUnique','375YZUEGR','webhookEvents','2199196PjqKFh','parse','default','Shop\x20settings\x20not\x20found','IntegrationsService','update','webhookUrl','__importDefault','27902770VbjBhh','63948dyheuS'];a47_0x11a7=function(){return _0xb0787b;};return a47_0x11a7();}const a47_0x23abc5=a47_0x2fe9;(function(_0x135bb4,_0x4764a0){const _0x318719=a47_0x2fe9,_0x15b312=_0x135bb4();while(!![]){try{const _0x4c3031=parseInt(_0x318719(0x1df))/0x1+-parseInt(_0x318719(0x1de))/0x2*(-parseInt(_0x318719(0x1f4))/0x3)+-parseInt(_0x318719(0x1e4))/0x4+-parseInt(_0x318719(0x1e2))/0x5*(-parseInt(_0x318719(0x1ed))/0x6)+-parseInt(_0x318719(0x1f6))/0x7+-parseInt(_0x318719(0x1ee))/0x8*(-parseInt(_0x318719(0x1ef))/0x9)+-parseInt(_0x318719(0x1ec))/0xa;if(_0x4c3031===_0x4764a0)break;else _0x15b312['push'](_0x15b312['shift']());}catch(_0x3c2ca7){_0x15b312['push'](_0x15b312['shift']());}}}(a47_0x11a7,0x8878e));var __importDefault=this&&this[a47_0x23abc5(0x1eb)]||function(_0x36ae7c){return _0x36ae7c&&_0x36ae7c['__esModule']?_0x36ae7c:{'default':_0x36ae7c};};Object[a47_0x23abc5(0x1f8)](exports,a47_0x23abc5(0x1e0),{'value':!![]}),exports[a47_0x23abc5(0x1e8)]=void 0x0;function a47_0x2fe9(_0x31f9df,_0x36758c){const _0x11a733=a47_0x11a7();return a47_0x2fe9=function(_0x2fe91b,_0x4cf7c8){_0x2fe91b=_0x2fe91b-0x1dd;let _0x2842e7=_0x11a733[_0x2fe91b];return _0x2842e7;},a47_0x2fe9(_0x31f9df,_0x36758c);}const database_1=__importDefault(require(a47_0x23abc5(0x1f7)));class IntegrationsService{['parseWebhookEvents'](_0x16fd12){const _0x4cadd4=a47_0x23abc5;if(!_0x16fd12)return[];if(Array[_0x4cadd4(0x1dd)](_0x16fd12))return _0x16fd12;if(typeof _0x16fd12===_0x4cadd4(0x1f0))try{const _0x239d2f=JSON[_0x4cadd4(0x1e5)](_0x16fd12);return Array['isArray'](_0x239d2f)?_0x239d2f:[];}catch{return[];}return[];}async[a47_0x23abc5(0x1f2)](_0x225d79){const _0x29f66c=a47_0x23abc5;await this[_0x29f66c(0x1f1)](_0x225d79);const _0x570836=await database_1[_0x29f66c(0x1e6)][_0x29f66c(0x1f5)][_0x29f66c(0x1e1)]({'where':{'shopId':_0x225d79},'select':{'webhookUrl':!![],'webhookEvents':!![]}});if(!_0x570836)throw new Error(_0x29f66c(0x1e7));return{'webhook':{'url':_0x570836['webhookUrl'],'events':this['parseWebhookEvents'](_0x570836['webhookEvents'])}};}async['updateWebhookSettings'](_0x595a57,_0x45702a){const _0x1139f9=a47_0x23abc5;await this['ensureSettingsExist'](_0x595a57);const _0x223b4f={};_0x45702a[_0x1139f9(0x1ea)]!==undefined&&(_0x223b4f['webhookUrl']=_0x45702a[_0x1139f9(0x1ea)]||null),_0x45702a['webhookEvents']!==undefined&&(_0x223b4f[_0x1139f9(0x1e3)]=_0x45702a[_0x1139f9(0x1e3)]||[]),await database_1[_0x1139f9(0x1e6)][_0x1139f9(0x1f5)][_0x1139f9(0x1e9)]({'where':{'shopId':_0x595a57},'data':_0x223b4f});}async[a47_0x23abc5(0x1f1)](_0x44f806){const _0x279a13=a47_0x23abc5,_0x3832b4=await database_1['default']['shopSettings'][_0x279a13(0x1e1)]({'where':{'shopId':_0x44f806}});!_0x3832b4&&await database_1[_0x279a13(0x1e6)][_0x279a13(0x1f5)][_0x279a13(0x1f3)]({'data':{'shopId':_0x44f806}});}}exports[a47_0x23abc5(0x1e8)]=IntegrationsService;