'use strict';const a48_0x596974=a48_0x3235;(function(_0x11a109,_0x560da6){const _0x4d0529=a48_0x3235,_0x11e1d8=_0x11a109();while(!![]){try{const _0x7ff569=parseInt(_0x4d0529(0x2b9))/0x1+parseInt(_0x4d0529(0x23f))/0x2+-parseInt(_0x4d0529(0x262))/0x3+parseInt(_0x4d0529(0x25f))/0x4+parseInt(_0x4d0529(0x310))/0x5+-parseInt(_0x4d0529(0x2c6))/0x6+-parseInt(_0x4d0529(0x2a2))/0x7*(parseInt(_0x4d0529(0x1fc))/0x8);if(_0x7ff569===_0x560da6)break;else _0x11e1d8['push'](_0x11e1d8['shift']());}catch(_0xd370e){_0x11e1d8['push'](_0x11e1d8['shift']());}}}(a48_0x36fc,0x3d955));var __importDefault=this&&this[a48_0x596974(0x2ed)]||function(_0x4ee46e){return _0x4ee46e&&_0x4ee46e['__esModule']?_0x4ee46e:{'default':_0x4ee46e};};Object[a48_0x596974(0x20e)](exports,a48_0x596974(0x26f),{'value':!![]}),exports[a48_0x596974(0x266)]=void 0x0;const database_1=__importDefault(require(a48_0x596974(0x1ea))),bcryptjs_1=__importDefault(require(a48_0x596974(0x2da))),crypto_1=__importDefault(require(a48_0x596974(0x233))),currencyService_1=require(a48_0x596974(0x1e8)),telegramBotService_1=require(a48_0x596974(0x1d9)),gateway_1=require('../types/gateway');function a48_0x36fc(){const _0x52d664=['âœ…\x20Payout\x20created\x20in\x20DB:','usdcErcWallet','\x20merchants\x20with\x20rounded\x20balance\x20!=\x200.00\x20(excluding\x20balances\x20that\x20round\x20to\x200.00)','stringify','amountAfterCommissionUSDT','merchantEarningsUSDT','push','turnoverUSDT','error','getFullYear','all','deletePayout','week','wallets','groupBy','\x20\x20\x20ðŸ’¸\x20Total\x20payouts:\x20','\x20\x20\x20Merchant\x20gets:\x20','random','count','this_month','averageCheckUSDT','customerCountry','toFixed','startsWith','notes','\x20\x20\x20ðŸª\x20Gateway\x20earnings:\x20','ðŸ“Š\x20Using\x20saved\x20values\x20for\x20payment\x20','mastercard','usdcPolygonWallet','getPaymentById','dateFrom','averageCommissionRate','%\x20commission)','desc','publicKey','findUnique','min','âš ï¸\x20Payment\x20','\x20\x20\x20âœ…\x20Actual\x20available\x20balance:\x20','ðŸŽ¯\x20updateUser\x20called\x20with\x20ID:\x20','create','\x20in\x20','totalTurnover','klyme_eu','7bdFLWi','\x20merchants\x20for\x20selection','noda','REFUND','ðŸ’°\x20Payment\x20amount\x20is\x20NOT\x20deducted\x20(chargeback\x20penalty\x20only)','\x20has\x20zero\x20or\x20null\x20amountUSDT,\x20skipping...','currencyService','activateUser','paymentsCount','gatewaySettings','gateways','klyme_de','totalCommissionRate','ACTIVE','deleteUser','pk_','updateUser','0000','\x20USDT)','customerEmail','ðŸ’°\x20Found\x20','paymentGateways','dailyRevenue','96221ZAjOAY','currency','get','findMany','ðŸ”\x20Selected\x20erc20\x20wallet:\x20','reduce','\x20\x20\x20ðŸ¤”\x20Difference:\x20','slice','toISOString','\x20USDT\x20(after\x20','getMonth','shopUrl','fullName','917466bkQygx','_sum','ðŸ”\x20Initial\x20wallet\x20from\x20request:\x20','not\x20specified','customerIp','not\x20provided','ÐÐµ\x20ÑƒÐºÐ°Ð·Ð°Ð½','hex','getAllPayouts','createdAt','polygon','custom','rapyd','periodFrom','%\x20from\x20','usdtPolygonWallet','ðŸ“Š\x20Merchants\x20with\x20rounded\x20balance\x20!=\x200.00:\x20','customerUa','\x20\x20\x20Total\x20paid\x20out:\x20','\x20\x20\x20ï¿½\x20Total\x20payments\x20turnover:\x20','bcryptjs','\x20\x20\x20ï¿½ðŸ“Š\x20Total\x20payments:\x20','commissionUSDT','username','chargebackAmount','getMerchantsAwaitingPayout','admin','pendingPayout',']\x20Gateway\x20settings\x20JSON\x20string:','\x20\x20\x20ðŸŒ\x20IP:\x20','\x20\x20\x20Transaction\x20hash:\x20','âœ…\x20Using\x20wallet\x20from\x20request:\x20','amountAfterGatewayCommissionUSDT','\x20became\x20PAID:',']\x20User\x20updated,\x20gatewaySettings\x20from\x20DB:',']\x20Password\x20not\x20provided\x20or\x20empty,\x20skipping\x20password\x20update','ðŸ“…\x20Date\x20to\x20filter:\x20','balance','PENDING','__importDefault','gatewayOrderId','payouts','\x27\x20to\x20name\x20\x27','set','generateDailyStatistics','payment','\x20USDT\x20(sum\x20of\x20all\x20merchant\x20balances)','\x27\x20->\x20name\x20\x27','ðŸ“Š\x20Calculating\x20commission\x20manually\x20for\x20payment\x20','telegramId','ðŸ”„\x20Admin\x20updating\x20payment\x20','updatedAt','\x20\x20\x20ï¿½\x20Total\x20paid\x20out:\x20','\x20PAID\x20payments','\x20\x20\x20Payout\x20amount:\x20','statusChangedBy','log','getGatewayNameById','âœ…\x20Balance\x20check\x20passed\x20(with\x20tolerance)','\x20\x20\x20Merchant\x20loses:\x20','length','\x20balance\x20updated:','EXPIRED','Error\x20parsing\x20gateway\x20settings\x20for\x20payment\x20','Payment\x20not\x20found','\x20USDT\x20(gross\x20revenue)','sk_','getDate','\x20for\x20shop\x20','\x20\x20\x20Difference:\x20','ðŸŽ¯\x20[','\x20USDT,\x20merchant:\x20','âœ…\x20Payout\x20created:\x20','ðŸ“Š\x20Getting\x20payments\x20with\x20filters:','827210tseLRo','\x20\x20\x20Gateway:\x20','getMerchantsSelection','dateTo','yesterday','getUTCMonth','status','parse','Open\x20Banking\x202','\x27\x20->\x20ID\x20\x27','sort','ceil','shopId','\x20paid\x20payments\x20for\x20analysis','filter','replace','\x27)\x20not\x20found\x20in\x20database,\x20returning\x20empty\x20result','ðŸ“Š\x20Merchant\x20statistics\x20calculated:','availableBalance','ðŸ’³\x20Final\x20payout\x20wallet\x20for\x20','ðŸ’¸\x20CHARGEBACK:\x20Processing\x20penalty-only\x20deduction','insensitive','getGatewayDisplayName','\x27\x20(from\x20\x27','Error\x20processing\x20payment\x20','toUpperCase','amount','ru-RU','setHours','ðŸ”„\x20Gateway\x20mapping\x20(get):','round','today','turnover','$transaction','2020-01-01','periodTo','ðŸ’±\x20Currency\x20filter\x20applied:\x20','ðŸ“…\x20Payout\x20date\x20from\x20filter:\x20','merchantEarnings','randomBytes','ðŸ“‹\x20Found\x20','ðŸ’°\x20Shop\x20','\x20USDT\x20(theoretical\x20net)','amountUSDT','default','date','getUTCFullYear','\x20to\x20','ðŸ”§\x20[','ðŸ”\x20Creating\x20payout\x20with\x20data:','\x20USDT\x20(already\x20paid\x20out)','some','failUrl','failureMessage','\x20\x20\x20ðŸ”\x20Calculated\x20after\x20commission:\x20','telegram','payout','./telegramBotService','forEach','includes','join','ðŸ”\x20Balance\x20check\x20details:','totalPaidOut','setUTCDate','getUTCDay','findFirst','merchantUrl','commission','usdtTrcWallet','getAllUsers',',\x20chargebacks:\x20','plisio','./currencyService','\x20\x20\x20ðŸ’°\x20Total\x20payout:\x20','../config/database','\x20\x20\x20ðŸ’°\x20Total\x20turnover:\x20','network','custom_','\x20USDT\x20(calculated\x20-\x20payouts\x20-\x20balance)','ðŸ’¸\x20CHARGEBACK\x20penalty\x20ONLY:\x20-','\x20\x20\x20ðŸ“…\x20This\x20month:\x20','hash','update','adminNotes','gatewayEarnings','klyme_gb','totalAmountAfterCommissionUSDT','suspendUser','âš ï¸\x20Gateway\x20\x27','telegramBotService','delete','ðŸ”„\x20Updating\x20customer\x20data\x20for\x20payment\x20','2556152Fllbct','split','ðŸ“…\x20Period:\x20','totalPayout','last_month','ðŸ“Š\x20Statistics\x20date\x20range:\x20','PAID','txid','wallet','getGatewayInternalName','\x20\x20\x20ðŸŒ\x20Country:\x20','paidAt','values','toLocaleDateString','ðŸ“Š\x20Gateway\x20filter\x20applied:','\x20->\x20','Rapyd','whiteUrl','defineProperty','year',',\x20Commission:\x20','gateway','period','test_gateway','ðŸ”„\x20Gateway\x20mapping:','\x20status:\x20','lte','ðŸ”\x20Using\x20gateway\x20\x27','usdtErcWallet','warn','\x20USDT','SUSPENDED','CoinToPay','ðŸ’°\x20[PAYOUT]\x20Gateway\x20','successUrl',',\x20refunds:\x20','floor','\x20USDT\x20(current\x20balance\x20in\x20DB)','ðŸ“Š\x20Final\x20WHERE\x20conditions:','getUserById','month','gatewayCommissionRate','getUTCDate','\x20USDT\x20from\x20balance','\x20\x20\x20Available\x20(raw):\x20','Error\x20parsing\x20gateway\x20settings\x20for\x20shop\x20','password',']\x20Updating\x20password\x20for\x20user\x20','ðŸ”\x20Total\x20payments\x20matching\x20filters:\x20','\x20\x20\x20Current\x20total\x20paid\x20out:\x20','\x20USDT\x20for\x20payment\x20','name','paidOutUSDT','\x27\x20as\x20is\x20(not\x20found\x20in\x20mappings)','\x20order','crypto','ðŸ“Š\x20Calculated\x20commission\x20rate\x20for\x20payment\x20','getGatewayIdByName','\x20with\x20payout\x20history','shop','\x20USDT\x20(',']\x20Gateway\x20settings\x20before\x20saving:','ðŸ”„\x20Converted\x20gateway\x20name\x20\x27','lastMonth','Test\x20Gateway','ðŸ“Š\x20Getting\x20merchant\x20statistics\x20with\x20filters:','UTC','898962Qmtiwh','ðŸ“Š\x20Calculating\x20payout\x20statistics...','ðŸ”\x20Selected\x20polygon\x20wallet:\x20','ðŸ’°\x20Creating\x20payout\x20for\x20shop\x20','COMPLETED','toString','cointopay2','ðŸ”„\x20REFUND:\x20Payment\x20amount\x20already\x20deducted\x20from\x20balance','substr','entries','totalPayments','\x20\x20\x20Available\x20(number):\x20','\x20\x20\x20ðŸ’¸\x20Total\x20payouts\x20(all\x20time):\x20','updatePaymentStatus','aggregate','not\x20set','dailyPayments','âš ï¸\x20CHARGEBACK\x20without\x20penalty\x20amount\x20-\x20no\x20balance\x20change','ðŸ”„\x20Converted\x20gateway\x20ID\x20\x27','\x20\x20\x20ðŸ’°\x20Total\x20payments\x20turnover:\x20','KLYME\x20DE',',\x20successful:\x20','ðŸ“…\x20Payout\x20date\x20to\x20filter:\x20','Plisio','ðŸ“Š\x20Statistics\x20PAID\x20payments\x20count:\x20','âš ï¸\x20Requested\x20gateway\x20\x27','cointopay','\x20\x20\x20Tolerance:\x20','orderId','toLowerCase','ðŸ“Š\x20Sorting\x20payments\x20by\x20','\x20\x20\x20â³\x20Awaiting\x20payout:\x20','835604gwEgGD','revenue','setDate','586110NeyOJO','ðŸ“Š\x20Total\x20payments\x20(including\x20failed):\x20','ðŸ“±\x20Telegram\x20notification\x20sent\x20for\x20payout\x20','ðŸ“Š\x20Using\x20saved\x20commission\x20rate\x20for\x20payment\x20','AdminService','map','getTime','\x20USDT,\x20Requested:\x20','\x20\x20\x20Requested\x20(number):\x20',',\x20userId:\x20','CHARGEBACK','\x20USDT\x20(same\x20as\x20awaiting)','\x20\x20\x20ðŸ–¥ï¸\x20User\x20Agent:\x20','__esModule','\x20USDT\x20(total\x20paid\x20to\x20merchants)','getPayoutById','ðŸ”\x20No\x20wallet\x20provided,\x20looking\x20up\x20from\x20shop\x20settings...','Insufficient\x20balance.\x20Available:\x20','USDT','ðŸ”\x20['];a48_0x36fc=function(){return _0x52d664;};return a48_0x36fc();}class AdminService{async['getPayoutStats'](){const _0x3f297a=a48_0x596974;console[_0x3f297a(0x2fe)](_0x3f297a(0x240));const _0x3ed139=await database_1[_0x3f297a(0x1cc)][_0x3f297a(0x237)]['aggregate']({'_sum':{'balance':!![],'totalPaidOut':!![]}}),_0x3f1d89=await database_1['default'][_0x3f297a(0x2f3)][_0x3f297a(0x288)]({'where':{'status':_0x3f297a(0x202),'gateway':{'not':_0x3f297a(0x213)}}}),_0x229043=new Date(),_0x436386=new Date(_0x229043[_0x3f297a(0x27f)](),_0x229043['getMonth'](),0x1),_0x216785=new Date(_0x229043['getFullYear'](),_0x229043[_0x3f297a(0x2c3)]()+0x1,0x0,0x17,0x3b,0x3b,0x3e7),_0x138e7f=await database_1['default']['payout'][_0x3f297a(0x24d)]({'_sum':{'amount':!![]},'where':{'createdAt':{'gte':_0x436386,'lte':_0x216785},'status':'COMPLETED'}}),_0x754283=_0x3ed139[_0x3f297a(0x2c7)][_0x3f297a(0x1de)]||0x0,_0x5e9560=_0x3ed139['_sum']['balance']||0x0,_0x296692=_0x138e7f[_0x3f297a(0x2c7)][_0x3f297a(0x1ba)]||0x0,_0x4e6283={'totalPayout':Math['round'](_0x754283*0x64)/0x64,'awaitingPayout':Math[_0x3f297a(0x1be)](_0x5e9560*0x64)/0x64,'thisMonth':Math[_0x3f297a(0x1be)](_0x296692*0x64)/0x64,'availableBalance':Math[_0x3f297a(0x1be)](_0x5e9560*0x64)/0x64,'totalPayments':_0x3f1d89};return console[_0x3f297a(0x2fe)]('ðŸ“Š\x20Payout\x20statistics\x20calculated:'),console[_0x3f297a(0x2fe)](_0x3f297a(0x1e9)+_0x4e6283['totalPayout']+_0x3f297a(0x270)),console[_0x3f297a(0x2fe)](_0x3f297a(0x25e)+_0x4e6283['awaitingPayout']+_0x3f297a(0x2f4)),console[_0x3f297a(0x2fe)]('\x20\x20\x20ðŸ’µ\x20Available\x20balance:\x20'+_0x4e6283[_0x3f297a(0x1b2)]+_0x3f297a(0x26d)),console[_0x3f297a(0x2fe)](_0x3f297a(0x1f0)+_0x4e6283['thisMonth']+_0x3f297a(0x21a)),console[_0x3f297a(0x2fe)]('\x20\x20\x20ðŸ’³\x20Total\x20payments:\x20'+_0x4e6283['totalPayments']+_0x3f297a(0x2fb)),_0x4e6283;}async['updateCustomerData'](_0x5f2113,_0x2ee268){const _0xbcb184=a48_0x596974;console[_0xbcb184(0x2fe)](_0xbcb184(0x1fb)+_0x5f2113+':',_0x2ee268);const _0x1e3b7e=await database_1[_0xbcb184(0x1cc)][_0xbcb184(0x2f3)][_0xbcb184(0x299)]({'where':{'id':_0x5f2113},'select':{'id':!![],'customerEmail':!![],'customerName':!![],'customerCountry':!![],'customerIp':!![],'customerUa':!![]}});if(!_0x1e3b7e)throw new Error(_0xbcb184(0x306));const _0x3e1f47={};_0x2ee268[_0xbcb184(0x28b)]!==undefined&&(_0x3e1f47[_0xbcb184(0x28b)]=_0x2ee268['customerCountry']||null);_0x2ee268[_0xbcb184(0x2ca)]!==undefined&&(_0x3e1f47[_0xbcb184(0x2ca)]=_0x2ee268[_0xbcb184(0x2ca)]||null);_0x2ee268[_0xbcb184(0x2d7)]!==undefined&&(_0x3e1f47[_0xbcb184(0x2d7)]=_0x2ee268[_0xbcb184(0x2d7)]||null);const _0x1bb622=await database_1['default'][_0xbcb184(0x2f3)][_0xbcb184(0x1f2)]({'where':{'id':_0x5f2113},'data':{..._0x3e1f47,'updatedAt':new Date()},'select':{'id':!![],'customerEmail':!![],'customerName':!![],'customerCountry':!![],'customerIp':!![],'customerUa':!![],'updatedAt':!![]}});return console[_0xbcb184(0x2fe)]('âœ…\x20Customer\x20data\x20updated\x20for\x20payment\x20'+_0x5f2113),console[_0xbcb184(0x2fe)](_0xbcb184(0x206)+_0x1e3b7e[_0xbcb184(0x28b)]+'\x20->\x20'+_0x1bb622[_0xbcb184(0x28b)]),console[_0xbcb184(0x2fe)](_0xbcb184(0x2e3)+_0x1e3b7e[_0xbcb184(0x2ca)]+_0xbcb184(0x20b)+_0x1bb622['customerIp']),console[_0xbcb184(0x2fe)](_0xbcb184(0x26e)+(_0x1e3b7e[_0xbcb184(0x2d7)]?'set':_0xbcb184(0x24e))+_0xbcb184(0x20b)+(_0x1bb622[_0xbcb184(0x2d7)]?_0xbcb184(0x2f1):'not\x20set')),_0x1bb622;}async['getSystemStatistics'](_0x5e15c3,_0x8113f5){const _0x3dd387=a48_0x596974,_0x39732c=_0x8113f5?new Date(_0x8113f5):new Date();let _0x29706b,_0x48e54e;if(_0x5e15c3[_0x3dd387(0x28d)](_0x3dd387(0x1ed))){const _0x21f6f8=_0x5e15c3[_0x3dd387(0x31f)](_0x3dd387(0x1ed),'')['split']('_');if(_0x21f6f8[_0x3dd387(0x302)]===0x2){const _0x1d92bb=new Date(_0x21f6f8[0x0]),_0x4344e7=new Date(_0x21f6f8[0x1]);_0x29706b=new Date(Date[_0x3dd387(0x23e)](_0x1d92bb[_0x3dd387(0x1ce)](),_0x1d92bb[_0x3dd387(0x315)](),_0x1d92bb[_0x3dd387(0x226)](),0x0,0x0,0x0,0x0)),_0x48e54e=new Date(Date[_0x3dd387(0x23e)](_0x4344e7[_0x3dd387(0x1ce)](),_0x4344e7[_0x3dd387(0x315)](),_0x4344e7[_0x3dd387(0x226)](),0x17,0x3b,0x3b,0x3e7));}else{const _0x342288=new Date(Date[_0x3dd387(0x23e)](_0x39732c['getUTCFullYear'](),_0x39732c['getUTCMonth'](),_0x39732c[_0x3dd387(0x226)]()-0x1e));_0x29706b=new Date(Date[_0x3dd387(0x23e)](_0x342288[_0x3dd387(0x1ce)](),_0x342288[_0x3dd387(0x315)](),_0x342288[_0x3dd387(0x226)](),0x0,0x0,0x0,0x0)),_0x48e54e=new Date(Date[_0x3dd387(0x23e)](_0x39732c[_0x3dd387(0x1ce)](),_0x39732c[_0x3dd387(0x315)](),_0x39732c[_0x3dd387(0x226)](),0x17,0x3b,0x3b,0x3e7));}}else{switch(_0x5e15c3[_0x3dd387(0x25c)]()){case _0x3dd387(0x1bf):_0x29706b=new Date(Date[_0x3dd387(0x23e)](_0x39732c[_0x3dd387(0x1ce)](),_0x39732c['getUTCMonth'](),_0x39732c[_0x3dd387(0x226)](),0x0,0x0,0x0,0x0)),_0x48e54e=new Date(Date[_0x3dd387(0x23e)](_0x39732c[_0x3dd387(0x1ce)](),_0x39732c[_0x3dd387(0x315)](),_0x39732c[_0x3dd387(0x226)](),0x17,0x3b,0x3b,0x3e7));break;case _0x3dd387(0x314):const _0x4c376f=new Date(_0x39732c);_0x4c376f[_0x3dd387(0x1df)](_0x4c376f[_0x3dd387(0x226)]()-0x1),_0x29706b=new Date(Date[_0x3dd387(0x23e)](_0x4c376f[_0x3dd387(0x1ce)](),_0x4c376f[_0x3dd387(0x315)](),_0x4c376f['getUTCDate'](),0x0,0x0,0x0,0x0)),_0x48e54e=new Date(Date['UTC'](_0x4c376f[_0x3dd387(0x1ce)](),_0x4c376f[_0x3dd387(0x315)](),_0x4c376f[_0x3dd387(0x226)](),0x17,0x3b,0x3b,0x3e7));break;case'this_week':const _0xe9d63c=_0x39732c['getUTCDay'](),_0x4fbf10=_0xe9d63c===0x0?-0x6:0x1-_0xe9d63c,_0x40dd6b=_0x39732c[_0x3dd387(0x226)]()+_0x4fbf10;_0x29706b=new Date(Date[_0x3dd387(0x23e)](_0x39732c[_0x3dd387(0x1ce)](),_0x39732c[_0x3dd387(0x315)](),_0x40dd6b,0x0,0x0,0x0,0x0)),_0x48e54e=new Date(Date[_0x3dd387(0x23e)](_0x39732c['getUTCFullYear'](),_0x39732c[_0x3dd387(0x315)](),_0x39732c['getUTCDate'](),0x17,0x3b,0x3b,0x3e7));break;case'last_week':const _0x1c5252=new Date(Date[_0x3dd387(0x23e)](_0x39732c[_0x3dd387(0x1ce)](),_0x39732c['getUTCMonth'](),_0x39732c[_0x3dd387(0x226)]()-0x7)),_0x5de23f=_0x1c5252[_0x3dd387(0x1e0)](),_0x380e27=_0x5de23f===0x0?-0x6:0x1-_0x5de23f,_0x7cbb7=_0x1c5252[_0x3dd387(0x226)]()+_0x380e27;_0x29706b=new Date(Date[_0x3dd387(0x23e)](_0x1c5252[_0x3dd387(0x1ce)](),_0x1c5252[_0x3dd387(0x315)](),_0x7cbb7,0x0,0x0,0x0,0x0)),_0x48e54e=new Date(Date[_0x3dd387(0x23e)](_0x1c5252[_0x3dd387(0x1ce)](),_0x1c5252['getUTCMonth'](),_0x7cbb7+0x6,0x17,0x3b,0x3b,0x3e7));break;case _0x3dd387(0x289):_0x29706b=new Date(Date[_0x3dd387(0x23e)](_0x39732c['getUTCFullYear'](),_0x39732c[_0x3dd387(0x315)](),0x1,0x0,0x0,0x0,0x0)),_0x48e54e=new Date(Date[_0x3dd387(0x23e)](_0x39732c[_0x3dd387(0x1ce)](),_0x39732c[_0x3dd387(0x315)](),_0x39732c[_0x3dd387(0x226)](),0x17,0x3b,0x3b,0x3e7));break;case _0x3dd387(0x200):_0x29706b=new Date(Date[_0x3dd387(0x23e)](_0x39732c[_0x3dd387(0x1ce)](),_0x39732c[_0x3dd387(0x315)]()-0x1,0x1,0x0,0x0,0x0,0x0)),_0x48e54e=new Date(Date[_0x3dd387(0x23e)](_0x39732c[_0x3dd387(0x1ce)](),_0x39732c['getUTCMonth'](),0x0,0x17,0x3b,0x3b,0x3e7));break;case'all_time':_0x29706b=new Date(Date[_0x3dd387(0x23e)](0x7e9,0x5,0xe,0x0,0x0,0x0,0x0)),_0x48e54e=new Date(Date[_0x3dd387(0x23e)](_0x39732c[_0x3dd387(0x1ce)](),_0x39732c[_0x3dd387(0x315)](),_0x39732c[_0x3dd387(0x226)](),0x17,0x3b,0x3b,0x3e7));break;default:_0x29706b=new Date(_0x39732c[_0x3dd387(0x268)]()-0x1e*0x18*0x3c*0x3c*0x3e8);const _0x4e9aae=new Date(Date[_0x3dd387(0x23e)](_0x39732c['getUTCFullYear'](),_0x39732c[_0x3dd387(0x315)](),_0x39732c['getUTCDate']()-0x1e));_0x29706b=new Date(Date['UTC'](_0x4e9aae['getUTCFullYear'](),_0x4e9aae[_0x3dd387(0x315)](),_0x4e9aae[_0x3dd387(0x226)](),0x0,0x0,0x0,0x0)),_0x48e54e=new Date(Date[_0x3dd387(0x23e)](_0x39732c[_0x3dd387(0x1ce)](),_0x39732c[_0x3dd387(0x315)](),_0x39732c[_0x3dd387(0x226)](),0x17,0x3b,0x3b,0x3e7));}const _0x4eb40d={'gte':_0x29706b,'lte':_0x48e54e};console[_0x3dd387(0x2fe)](_0x3dd387(0x201)+_0x29706b[_0x3dd387(0x2c1)]()+_0x3dd387(0x1cf)+_0x48e54e['toISOString']());const [_0x2cc0ba,_0x51195e,_0x2370e9,_0x16c49a,_0x4247e9,_0x37f2f9,_0x8a14e1,_0x397d71,_0x3c8fdd]=await Promise[_0x3dd387(0x280)]([database_1[_0x3dd387(0x1cc)][_0x3dd387(0x237)][_0x3dd387(0x288)](),database_1[_0x3dd387(0x1cc)]['shop'][_0x3dd387(0x288)]({'where':{'status':'ACTIVE'}}),database_1['default'][_0x3dd387(0x2f3)][_0x3dd387(0x288)]({'where':{'status':'PAID','createdAt':_0x4eb40d,'gateway':{'not':_0x3dd387(0x213)}}}),database_1['default'][_0x3dd387(0x2f3)][_0x3dd387(0x288)]({'where':{'status':_0x3dd387(0x26c),'createdAt':_0x4eb40d,'gateway':{'not':_0x3dd387(0x213)}}}),database_1[_0x3dd387(0x1cc)][_0x3dd387(0x2f3)][_0x3dd387(0x288)]({'where':{'status':_0x3dd387(0x2a5),'createdAt':_0x4eb40d,'gateway':{'not':_0x3dd387(0x213)}}}),database_1[_0x3dd387(0x1cc)][_0x3dd387(0x2f3)][_0x3dd387(0x2bc)]({'where':{'status':_0x3dd387(0x202),'createdAt':_0x4eb40d,'gateway':{'not':_0x3dd387(0x213)}},'select':{'amount':!![],'currency':!![],'amountUSDT':!![],'amountAfterGatewayCommissionUSDT':!![]}}),database_1['default']['payment'][_0x3dd387(0x2bc)]({'where':{'gateway':{'not':_0x3dd387(0x213)}},'take':0xa,'orderBy':{'createdAt':_0x3dd387(0x297)},'include':{'shop':{'select':{'name':!![],'username':!![]}}}}),database_1['default'][_0x3dd387(0x2f3)]['findMany']({'where':{'createdAt':_0x4eb40d,'gateway':{'not':_0x3dd387(0x213)}},'select':{'amount':!![],'currency':!![],'status':!![],'amountUSDT':!![],'createdAt':!![]}}),database_1['default']['payment'][_0x3dd387(0x2bc)]({'where':{'status':_0x3dd387(0x202),'gateway':{'not':_0x3dd387(0x213)}},'select':{'amountUSDT':!![],'amountAfterGatewayCommissionUSDT':!![]}})]);console[_0x3dd387(0x2fe)](_0x3dd387(0x257)+_0x2370e9);let _0x10d6fe=0x0,_0x24b69c=0x0;for(const _0x311b47 of _0x37f2f9){const _0x5e2eb0=_0x311b47['amountUSDT']||0x0;_0x10d6fe+=_0x5e2eb0;if(_0x311b47['amountAfterGatewayCommissionUSDT']&&_0x311b47[_0x3dd387(0x1cb)]){const _0x2094e8=_0x311b47['amountUSDT']-_0x311b47[_0x3dd387(0x2e6)];_0x24b69c+=_0x2094e8;}}let _0x34aa3c=0x0;for(const _0x524e10 of _0x3c8fdd){if(_0x524e10[_0x3dd387(0x2e6)]&&_0x524e10[_0x3dd387(0x1cb)]){const _0x45ee82=_0x524e10[_0x3dd387(0x1cb)]-_0x524e10[_0x3dd387(0x2e6)];_0x34aa3c+=_0x45ee82;}}const _0x470ce9=_0x2370e9>0x0?_0x10d6fe/_0x2370e9:0x0,_0xd80632=this[_0x3dd387(0x2f2)](_0x397d71,_0x29706b,_0x48e54e),_0x376885=await database_1[_0x3dd387(0x1cc)]['payment']['count']({'where':{'createdAt':_0x4eb40d,'gateway':{'not':_0x3dd387(0x213)},'status':{'notIn':['PENDING',_0x3dd387(0x304)]}}}),_0x14403e=_0x376885>0x0?_0x2370e9/_0x376885*0x64:0x0;return{'totalShops':_0x2cc0ba,'activeShops':_0x51195e,'totalPayments':_0x376885,'successfulPayments':_0x2370e9,'totalAttempts':_0x376885,'chargebacks':_0x16c49a,'refunds':_0x4247e9,'totalRevenue':Math[_0x3dd387(0x1be)](_0x10d6fe*0x64)/0x64,'trapayEarnings':Math[_0x3dd387(0x1be)](_0x24b69c*0x64)/0x64,'trapayEarningsAllTime':Math['round'](_0x34aa3c*0x64)/0x64,'averagePaymentAmount':Math[_0x3dd387(0x1be)](_0x470ce9*0x64)/0x64,'conversionRate':Math[_0x3dd387(0x1be)](_0x14403e*0x64)/0x64,'dailyRevenue':_0xd80632[_0x3dd387(0x2b8)],'dailyPayments':_0xd80632[_0x3dd387(0x24f)],'recentPayments':_0x8a14e1[_0x3dd387(0x267)](_0x322cba=>({'id':_0x322cba['id'],'amount':_0x322cba[_0x3dd387(0x1ba)],'currency':_0x322cba['currency'],'status':_0x322cba[_0x3dd387(0x316)],'gateway':_0x322cba[_0x3dd387(0x211)],'shop':_0x322cba['shop'],'createdAt':_0x322cba[_0x3dd387(0x2cf)]}))};}}async['getMerchantStatistics'](_0x4c834d){const _0x101f05=a48_0x596974;console['log'](_0x101f05(0x23d),_0x4c834d);let _0x43fd76,_0x2f8ded=new Date();if(_0x4c834d[_0x101f05(0x212)]===_0x101f05(0x2d1)&&_0x4c834d[_0x101f05(0x294)]&&_0x4c834d[_0x101f05(0x313)]){const _0x3b97bb=new Date(_0x4c834d[_0x101f05(0x294)]),_0x35c491=new Date(_0x4c834d[_0x101f05(0x313)]);_0x43fd76=new Date(Date[_0x101f05(0x23e)](_0x3b97bb[_0x101f05(0x1ce)](),_0x3b97bb[_0x101f05(0x315)](),_0x3b97bb[_0x101f05(0x226)](),0x0,0x0,0x0,0x0)),_0x2f8ded=new Date(Date[_0x101f05(0x23e)](_0x35c491[_0x101f05(0x1ce)](),_0x35c491[_0x101f05(0x315)](),_0x35c491[_0x101f05(0x226)](),0x17,0x3b,0x3b,0x3e7));}else{const _0x4a628f=new Date();switch(_0x4c834d[_0x101f05(0x212)]){case _0x101f05(0x282):_0x43fd76=new Date(_0x4a628f[_0x101f05(0x268)]()-0x7*0x18*0x3c*0x3c*0x3e8),_0x43fd76[_0x101f05(0x1bc)](0x0,0x0,0x0,0x0),_0x2f8ded[_0x101f05(0x1bc)](0x17,0x3b,0x3b,0x3e7);break;case _0x101f05(0x224):_0x43fd76=new Date(Date[_0x101f05(0x23e)](_0x4a628f[_0x101f05(0x1ce)](),_0x4a628f['getUTCMonth'](),0x1,0x0,0x0,0x0,0x0)),_0x2f8ded=new Date(Date['UTC'](_0x4a628f[_0x101f05(0x1ce)](),_0x4a628f[_0x101f05(0x315)]()+0x1,0x0,0x17,0x3b,0x3b,0x3e7));break;case _0x101f05(0x23b):_0x43fd76=new Date(Date['UTC'](_0x4a628f[_0x101f05(0x1ce)](),_0x4a628f['getUTCMonth']()-0x1,0x1,0x0,0x0,0x0,0x0)),_0x2f8ded=new Date(Date[_0x101f05(0x23e)](_0x4a628f[_0x101f05(0x1ce)](),_0x4a628f['getUTCMonth'](),0x0,0x17,0x3b,0x3b,0x3e7));break;case _0x101f05(0x20f):_0x43fd76=new Date(_0x4a628f[_0x101f05(0x268)]()-0x16d*0x18*0x3c*0x3c*0x3e8),_0x43fd76[_0x101f05(0x1bc)](0x0,0x0,0x0,0x0),_0x2f8ded[_0x101f05(0x1bc)](0x17,0x3b,0x3b,0x3e7);break;case _0x101f05(0x280):default:_0x43fd76=new Date(_0x101f05(0x1c2)),_0x43fd76['setHours'](0x0,0x0,0x0,0x0),_0x2f8ded[_0x101f05(0x1bc)](0x17,0x3b,0x3b,0x3e7);break;}}console[_0x101f05(0x2fe)](_0x101f05(0x1fe)+_0x43fd76[_0x101f05(0x2c1)]()+_0x101f05(0x1cf)+_0x2f8ded[_0x101f05(0x2c1)]());const _0x4f2203={'status':_0x101f05(0x202),'gateway':{'not':_0x101f05(0x213)},'createdAt':{'gte':_0x43fd76,'lte':_0x2f8ded}};_0x4c834d[_0x101f05(0x31c)]&&(_0x4f2203[_0x101f05(0x31c)]=_0x4c834d[_0x101f05(0x31c)]);const _0x195a31=await database_1[_0x101f05(0x1cc)]['payment']['findMany']({'where':_0x4f2203,'select':{'id':!![],'amount':!![],'currency':!![],'amountUSDT':!![],'amountAfterGatewayCommissionUSDT':!![],'gatewayCommissionRate':!![],'gateway':!![],'shopId':!![],'paidAt':!![],'shop':{'select':{'id':!![],'name':!![],'username':!![],'gatewaySettings':!![]}}}});console[_0x101f05(0x2fe)](_0x101f05(0x2b6)+_0x195a31[_0x101f05(0x302)]+_0x101f05(0x31d));const _0x1207b7={'gateway':{'not':_0x101f05(0x213)},'status':{'notIn':[_0x101f05(0x2ec),_0x101f05(0x304)]},'createdAt':{'gte':_0x43fd76,'lte':_0x2f8ded}};_0x4c834d[_0x101f05(0x31c)]&&(_0x1207b7['shopId']=_0x4c834d[_0x101f05(0x31c)]);const _0x2f6bfd=await database_1[_0x101f05(0x1cc)]['payment'][_0x101f05(0x288)]({'where':_0x1207b7}),_0x569676={..._0x1207b7,'status':_0x101f05(0x26c)},_0x5d0431={..._0x1207b7,'status':_0x101f05(0x2a5)},[_0x161f05,_0x20ff5b]=await Promise[_0x101f05(0x280)]([database_1['default'][_0x101f05(0x2f3)][_0x101f05(0x288)]({'where':_0x569676}),database_1[_0x101f05(0x1cc)]['payment'][_0x101f05(0x288)]({'where':_0x5d0431})]);console[_0x101f05(0x2fe)](_0x101f05(0x263)+_0x2f6bfd+_0x101f05(0x254)+_0x195a31[_0x101f05(0x302)]+_0x101f05(0x1e6)+_0x161f05+_0x101f05(0x21f)+_0x20ff5b);let _0x45d4a0=0x0,_0x484c2f=0x0,_0x30ab6e=0x0;const _0x3aa43b={},_0x369938={},_0x38fbdc={},_0x53f246=new Date(_0x43fd76);while(_0x53f246<=_0x2f8ded){const _0x13788f=_0x53f246[_0x101f05(0x2c1)]()[_0x101f05(0x1fd)]('T')[0x0];_0x38fbdc[_0x13788f]={'date':_0x13788f,'turnover':0x0,'merchantEarnings':0x0,'gatewayEarnings':0x0,'paymentsCount':0x0},_0x53f246[_0x101f05(0x1df)](_0x53f246[_0x101f05(0x226)]()+0x1);}for(const _0x20db6b of _0x195a31){try{const _0x2de7ab=_0x20db6b[_0x101f05(0x1cb)]||0x0;if(_0x2de7ab<=0x0){console[_0x101f05(0x219)](_0x101f05(0x29b)+_0x20db6b['id']+_0x101f05(0x2a7));continue;}let _0x23c1c1,_0x253dbb;if(_0x20db6b['amountAfterGatewayCommissionUSDT']!==null&&_0x20db6b['amountAfterGatewayCommissionUSDT']!==undefined)_0x23c1c1=_0x20db6b[_0x101f05(0x2e6)],_0x253dbb=_0x2de7ab-_0x23c1c1,console['log'](_0x101f05(0x290)+_0x20db6b['id']+':\x20'+_0x2de7ab['toFixed'](0x6)+_0x101f05(0x30d)+_0x23c1c1[_0x101f05(0x28c)](0x6)+_0x101f05(0x21a));else{let _0x13c13f={};if(_0x20db6b[_0x101f05(0x237)][_0x101f05(0x2ab)])try{_0x13c13f=JSON['parse'](_0x20db6b[_0x101f05(0x237)]['gatewaySettings']);}catch(_0x10088c){console[_0x101f05(0x27e)](_0x101f05(0x229)+_0x20db6b[_0x101f05(0x31c)]+':',_0x10088c);}let _0x19df5e=0x2d;for(const [_0x4a5179,_0x4a5385]of Object[_0x101f05(0x248)](_0x13c13f)){if(_0x4a5179[_0x101f05(0x25c)]()===_0x20db6b['gateway'][_0x101f05(0x25c)]()){_0x19df5e=_0x4a5385[_0x101f05(0x1e3)]||0x2d;break;}}_0x253dbb=_0x2de7ab*(_0x19df5e/0x64),_0x23c1c1=_0x2de7ab-_0x253dbb,console[_0x101f05(0x2fe)](_0x101f05(0x2f6)+_0x20db6b['id']+':\x20'+_0x19df5e+'%\x20from\x20'+_0x2de7ab['toFixed'](0x6)+_0x101f05(0x21a));}_0x45d4a0+=_0x2de7ab,_0x484c2f+=_0x23c1c1,_0x30ab6e+=_0x253dbb;let _0x7a95db;_0x20db6b[_0x101f05(0x225)]!==null&&_0x20db6b[_0x101f05(0x225)]!==undefined?(_0x7a95db=_0x20db6b[_0x101f05(0x225)],console[_0x101f05(0x2fe)](_0x101f05(0x265)+_0x20db6b['id']+':\x20'+_0x7a95db+'%')):(_0x7a95db=_0x2de7ab>0x0?_0x253dbb/_0x2de7ab*0x64:0x0,console[_0x101f05(0x2fe)](_0x101f05(0x234)+_0x20db6b['id']+':\x20'+_0x7a95db[_0x101f05(0x28c)](0x2)+'%'));!_0x3aa43b[_0x20db6b[_0x101f05(0x211)]]&&(_0x3aa43b[_0x20db6b[_0x101f05(0x211)]]={'gateway':_0x20db6b['gateway'],'gatewayDisplayName':this[_0x101f05(0x1b6)](_0x20db6b['gateway']),'paymentsCount':0x0,'turnoverUSDT':0x0,'commissionUSDT':0x0,'merchantEarningsUSDT':0x0,'totalCommissionRate':0x0});_0x3aa43b[_0x20db6b['gateway']][_0x101f05(0x2aa)]++,_0x3aa43b[_0x20db6b[_0x101f05(0x211)]][_0x101f05(0x27d)]+=_0x2de7ab,_0x3aa43b[_0x20db6b['gateway']][_0x101f05(0x2dc)]+=_0x253dbb,_0x3aa43b[_0x20db6b[_0x101f05(0x211)]][_0x101f05(0x27b)]+=_0x23c1c1,_0x3aa43b[_0x20db6b[_0x101f05(0x211)]][_0x101f05(0x2ae)]+=_0x7a95db;!_0x4c834d[_0x101f05(0x31c)]&&(!_0x369938[_0x20db6b[_0x101f05(0x31c)]]&&(_0x369938[_0x20db6b[_0x101f05(0x31c)]]={'shopId':_0x20db6b[_0x101f05(0x31c)],'shopName':_0x20db6b[_0x101f05(0x237)]['name'],'shopUsername':_0x20db6b[_0x101f05(0x237)][_0x101f05(0x2dd)],'paymentsCount':0x0,'turnoverUSDT':0x0,'commissionUSDT':0x0,'merchantEarningsUSDT':0x0,'paidOutUSDT':0x0,'averageCheckUSDT':0x0}),_0x369938[_0x20db6b[_0x101f05(0x31c)]][_0x101f05(0x2aa)]++,_0x369938[_0x20db6b['shopId']][_0x101f05(0x27d)]+=_0x2de7ab,_0x369938[_0x20db6b[_0x101f05(0x31c)]][_0x101f05(0x2dc)]+=_0x253dbb,_0x369938[_0x20db6b[_0x101f05(0x31c)]][_0x101f05(0x27b)]+=_0x23c1c1);const _0x40fa19=_0x20db6b[_0x101f05(0x207)][_0x101f05(0x2c1)]()[_0x101f05(0x1fd)]('T')[0x0];_0x38fbdc[_0x40fa19]&&(_0x38fbdc[_0x40fa19][_0x101f05(0x1c0)]+=_0x2de7ab,_0x38fbdc[_0x40fa19]['merchantEarnings']+=_0x23c1c1,_0x38fbdc[_0x40fa19][_0x101f05(0x1f4)]+=_0x253dbb,_0x38fbdc[_0x40fa19]['paymentsCount']++);}catch(_0x3d9205){console[_0x101f05(0x27e)](_0x101f05(0x1b8)+_0x20db6b['id']+':',_0x3d9205);}}Object[_0x101f05(0x208)](_0x3aa43b)[_0x101f05(0x1da)](_0x512484=>{const _0x355675=_0x101f05;_0x512484[_0x355675(0x295)]=_0x512484[_0x355675(0x2aa)]>0x0?_0x512484['totalCommissionRate']/_0x512484[_0x355675(0x2aa)]:0x0,delete _0x512484['totalCommissionRate'];}),Object['values'](_0x369938)[_0x101f05(0x1da)](_0x12ad41=>{const _0x140f10=_0x101f05;_0x12ad41['averageCheckUSDT']=_0x12ad41[_0x140f10(0x2aa)]>0x0?_0x12ad41[_0x140f10(0x27d)]/_0x12ad41[_0x140f10(0x2aa)]:0x0;});let _0x3bf1b7=0x0,_0x2c2418=0x0;if(_0x4c834d[_0x101f05(0x31c)]){const _0x1537f6=await database_1[_0x101f05(0x1cc)]['payout'][_0x101f05(0x2bc)]({'where':{'shopId':_0x4c834d['shopId'],'status':_0x101f05(0x243),'createdAt':{'gte':_0x43fd76,'lte':_0x2f8ded}},'select':{'amount':!![]}});_0x3bf1b7=_0x1537f6[_0x101f05(0x2be)]((_0x2e66a1,_0x12a21b)=>_0x2e66a1+_0x12a21b[_0x101f05(0x1ba)],0x0);const _0x180a5f=await database_1[_0x101f05(0x1cc)][_0x101f05(0x1d8)]['findMany']({'where':{'shopId':_0x4c834d[_0x101f05(0x31c)],'status':_0x101f05(0x2ec),'createdAt':{'gte':_0x43fd76,'lte':_0x2f8ded}},'select':{'amount':!![]}});_0x2c2418=_0x180a5f[_0x101f05(0x2be)]((_0x545a8d,_0x92273e)=>_0x545a8d+_0x92273e[_0x101f05(0x1ba)],0x0);}const _0x19a09f=_0x2f6bfd,_0x2d19ec=_0x195a31[_0x101f05(0x302)],_0x5ad179=_0x2d19ec>0x0?_0x45d4a0/_0x2d19ec:0x0,_0x444373=_0x19a09f>0x0?Math['round'](_0x2d19ec/_0x19a09f*0x2710)/0x64:0x0,_0x2fa563=Math[_0x101f05(0x31b)]((_0x2f8ded[_0x101f05(0x268)]()-_0x43fd76['getTime']())/(0x3e8*0x3c*0x3c*0x18)),_0x22b149={'totalTurnover':Math[_0x101f05(0x1be)](_0x45d4a0*0x64)/0x64,'merchantEarnings':Math[_0x101f05(0x1be)](_0x484c2f*0x64)/0x64,'gatewayEarnings':Math[_0x101f05(0x1be)](_0x30ab6e*0x64)/0x64,'totalPaidOut':Math[_0x101f05(0x1be)](_0x3bf1b7*0x64)/0x64,'pendingPayout':Math['round'](_0x2c2418*0x64)/0x64,'averageCheck':Math[_0x101f05(0x1be)](_0x5ad179*0x64)/0x64,'totalPayments':_0x19a09f,'successfulPayments':_0x2d19ec,'conversionRate':_0x444373,'chargebacks':_0x161f05,'refunds':_0x20ff5b,'gatewayBreakdown':Object['values'](_0x3aa43b)[_0x101f05(0x267)](_0x46afd3=>({..._0x46afd3,'turnoverUSDT':Math['round'](_0x46afd3[_0x101f05(0x27d)]*0x64)/0x64,'commissionUSDT':Math[_0x101f05(0x1be)](_0x46afd3[_0x101f05(0x2dc)]*0x64)/0x64,'merchantEarningsUSDT':Math[_0x101f05(0x1be)](_0x46afd3[_0x101f05(0x27b)]*0x64)/0x64,'averageCommissionRate':Math[_0x101f05(0x1be)](_0x46afd3['averageCommissionRate']*0x64)/0x64})),'merchantBreakdown':_0x4c834d[_0x101f05(0x31c)]?undefined:Object[_0x101f05(0x208)](_0x369938)[_0x101f05(0x267)](_0x221f0e=>({..._0x221f0e,'turnoverUSDT':Math['round'](_0x221f0e[_0x101f05(0x27d)]*0x64)/0x64,'commissionUSDT':Math['round'](_0x221f0e[_0x101f05(0x2dc)]*0x64)/0x64,'merchantEarningsUSDT':Math['round'](_0x221f0e[_0x101f05(0x27b)]*0x64)/0x64,'paidOutUSDT':Math[_0x101f05(0x1be)](_0x221f0e[_0x101f05(0x230)]*0x64)/0x64,'averageCheckUSDT':Math[_0x101f05(0x1be)](_0x221f0e[_0x101f05(0x28a)]*0x64)/0x64})),'dailyData':Object[_0x101f05(0x208)](_0x38fbdc)[_0x101f05(0x267)](_0x27e87b=>({..._0x27e87b,'turnover':Math[_0x101f05(0x1be)](_0x27e87b[_0x101f05(0x1c0)]*0x64)/0x64,'merchantEarnings':Math[_0x101f05(0x1be)](_0x27e87b[_0x101f05(0x1c6)]*0x64)/0x64,'gatewayEarnings':Math[_0x101f05(0x1be)](_0x27e87b[_0x101f05(0x1f4)]*0x64)/0x64}))['sort']((_0x1447e7,_0x35751a)=>_0x1447e7[_0x101f05(0x1cd)]['localeCompare'](_0x35751a[_0x101f05(0x1cd)])),'periodInfo':{'from':_0x43fd76,'to':_0x2f8ded,'periodType':_0x4c834d['period']||_0x101f05(0x2d1),'daysCount':_0x2fa563}};return console[_0x101f05(0x2fe)](_0x101f05(0x1b1)),console[_0x101f05(0x2fe)](_0x101f05(0x1eb)+_0x22b149[_0x101f05(0x2a0)]+_0x101f05(0x21a)),console['log']('\x20\x20\x20ðŸ‘¤\x20Merchant\x20earnings:\x20'+_0x22b149[_0x101f05(0x1c6)]+_0x101f05(0x21a)),console[_0x101f05(0x2fe)](_0x101f05(0x28f)+_0x22b149[_0x101f05(0x1f4)]+'\x20USDT'),console['log'](_0x101f05(0x2fa)+_0x22b149[_0x101f05(0x1de)]+_0x101f05(0x21a)),console[_0x101f05(0x2fe)]('\x20\x20\x20â³\x20Pending\x20payout:\x20'+_0x22b149[_0x101f05(0x2e1)]+_0x101f05(0x21a)),console[_0x101f05(0x2fe)](_0x101f05(0x2db)+_0x22b149[_0x101f05(0x249)]),_0x22b149;}async[a48_0x596974(0x312)](_0x55aa39){const _0x135d0d=a48_0x596974;console[_0x135d0d(0x2fe)]('ðŸ“‹\x20Getting\x20merchants\x20selection\x20list...',{'hasPayoutHistory':_0x55aa39});let _0x3e94a0={};_0x55aa39&&(_0x3e94a0[_0x135d0d(0x2ef)]={'some':{}});const _0x557822=await database_1[_0x135d0d(0x1cc)][_0x135d0d(0x237)][_0x135d0d(0x2bc)]({'where':_0x3e94a0,'select':{'id':!![],'username':!![],'name':!![]},'orderBy':{'name':'asc'}});return console[_0x135d0d(0x2fe)](_0x135d0d(0x1c8)+_0x557822[_0x135d0d(0x302)]+_0x135d0d(0x2a3)+(_0x55aa39?_0x135d0d(0x236):'')),_0x557822[_0x135d0d(0x267)](_0x1a56ca=>({'id':_0x1a56ca['id'],'username':_0x1a56ca[_0x135d0d(0x2dd)],'name':_0x1a56ca[_0x135d0d(0x22f)]}));}[a48_0x596974(0x1b6)](_0x15ef27){const _0x28f6eb=a48_0x596974,_0x20d644={'test_gateway':_0x28f6eb(0x23c),'plisio':_0x28f6eb(0x256),'rapyd':_0x28f6eb(0x20c),'noda':'Noda','cointopay':_0x28f6eb(0x21c),'cointopay2':_0x28f6eb(0x318),'klyme_eu':'KLYME\x20EU','klyme_gb':'KLYME\x20GB','klyme_de':_0x28f6eb(0x253),'mastercard':'MasterCard'};return _0x20d644[_0x15ef27]||_0x15ef27;}[a48_0x596974(0x205)](_0x2b3ba0){const _0x364567=a48_0x596974,_0x120dba={'Test\x20Gateway':_0x364567(0x213),'Plisio':_0x364567(0x1e7),'Rapyd':_0x364567(0x2d2),'Noda':_0x364567(0x2a4),'CoinToPay':_0x364567(0x259),'CoinToPay2':_0x364567(0x245),'KLYME\x20EU':_0x364567(0x2a1),'KLYME\x20GB':_0x364567(0x1f5),'KLYME\x20DE':_0x364567(0x2ad),'MasterCard':_0x364567(0x291)};return _0x120dba[_0x2b3ba0]||_0x2b3ba0[_0x364567(0x25c)]();}async[a48_0x596974(0x2df)](_0x53fed2){const _0xe417c6=a48_0x596974,{page:_0x1e68e5,limit:_0xf80b09,minAmount:_0x29a778,search:_0x10c37d}=_0x53fed2;console[_0xe417c6(0x2fe)]('ðŸ“Š\x20Getting\x20merchants\x20awaiting\x20payout\x20with\x20filters:',_0x53fed2);let _0x48a348={};_0x10c37d&&(_0x48a348[_0xe417c6(0x22f)]={'contains':_0x10c37d,'mode':_0xe417c6(0x1b5)});const _0x3c63b1=await database_1[_0xe417c6(0x1cc)]['shop']['findMany']({'where':_0x48a348,'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'balance':!![],'totalPaidOut':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'usdcErcWallet':!![],'gatewaySettings':!![],'createdAt':!![]}}),_0x47e96e=_0x3c63b1[_0xe417c6(0x31e)](_0x27bf02=>{const _0x366e54=_0xe417c6,_0x435d1b=Math[_0x366e54(0x220)](_0x27bf02[_0x366e54(0x2eb)]*0x64)/0x64;if(_0x29a778&&_0x435d1b<_0x29a778)return![];return _0x435d1b!==0x0;});_0x47e96e[_0xe417c6(0x31a)]((_0x2d5f07,_0x10c7bb)=>_0x10c7bb[_0xe417c6(0x2eb)]-_0x2d5f07[_0xe417c6(0x2eb)]);const _0x399712=_0x47e96e[_0xe417c6(0x302)],_0x507e05=(_0x1e68e5-0x1)*_0xf80b09,_0x1f591b=_0x47e96e[_0xe417c6(0x2c0)](_0x507e05,_0x507e05+_0xf80b09);console[_0xe417c6(0x2fe)](_0xe417c6(0x2b6)+_0x1f591b[_0xe417c6(0x302)]+_0xe417c6(0x278));const _0x55bae1=await Promise[_0xe417c6(0x280)](_0x1f591b[_0xe417c6(0x267)](async _0x52de9c=>{const _0x4669b4=_0xe417c6,[_0x3df4fd,_0x5c6c24,_0x5dab27]=await Promise[_0x4669b4(0x280)]([database_1[_0x4669b4(0x1cc)][_0x4669b4(0x2f3)][_0x4669b4(0x288)]({'where':{'shopId':_0x52de9c['id'],'status':_0x4669b4(0x202),'gateway':{'not':_0x4669b4(0x213)}}}),database_1[_0x4669b4(0x1cc)][_0x4669b4(0x2f3)][_0x4669b4(0x1e1)]({'where':{'shopId':_0x52de9c['id'],'status':_0x4669b4(0x202),'gateway':{'not':_0x4669b4(0x213)}},'orderBy':{'paidAt':'asc'},'select':{'paidAt':!![]}}),database_1['default'][_0x4669b4(0x2f3)][_0x4669b4(0x284)]({'by':[_0x4669b4(0x211)],'where':{'shopId':_0x52de9c['id'],'status':_0x4669b4(0x202),'gateway':{'not':_0x4669b4(0x213)}},'_count':{'id':!![]},'_sum':{'amountUSDT':!![]}})]),_0x443977=new Date(),_0xc8ea79=new Date(_0x443977['getFullYear'](),_0x443977[_0x4669b4(0x2c3)](),0x1),_0x4464d4=new Date(_0x443977[_0x4669b4(0x27f)](),_0x443977['getMonth']()+0x1,0x0,0x17,0x3b,0x3b,0x3e7),[_0x4296bc,_0x176941]=await Promise[_0x4669b4(0x280)]([database_1[_0x4669b4(0x1cc)][_0x4669b4(0x1d8)][_0x4669b4(0x24d)]({'_sum':{'amount':!![]},'where':{'shopId':_0x52de9c['id'],'status':_0x4669b4(0x243)}}),database_1[_0x4669b4(0x1cc)]['payout'][_0x4669b4(0x24d)]({'_sum':{'amount':!![]},'where':{'shopId':_0x52de9c['id'],'status':_0x4669b4(0x243),'createdAt':{'gte':_0xc8ea79,'lte':_0x4464d4}}})]),_0x3d71b8=_0x4296bc[_0x4669b4(0x2c7)][_0x4669b4(0x1ba)]||0x0,_0x470e93=_0x176941[_0x4669b4(0x2c7)][_0x4669b4(0x1ba)]||0x0,_0x256dbb=await Promise[_0x4669b4(0x280)](_0x5dab27[_0x4669b4(0x267)](async _0x58426b=>{const _0x5f2bea=_0x4669b4;let _0x3796e2=0x2d;if(_0x52de9c[_0x5f2bea(0x2ab)])try{const _0x3f6b81=JSON[_0x5f2bea(0x317)](_0x52de9c['gatewaySettings']);for(const [_0x5184cd,_0x5f0517]of Object['entries'](_0x3f6b81)){if(_0x5184cd[_0x5f2bea(0x25c)]()===_0x58426b[_0x5f2bea(0x211)][_0x5f2bea(0x25c)]()){_0x3796e2=_0x5f0517[_0x5f2bea(0x1e3)]||0xa,console['log'](_0x5f2bea(0x21d)+_0x58426b[_0x5f2bea(0x211)]+'\x20for\x20shop\x20'+_0x52de9c['id']+':\x20commission\x20=\x20'+_0x3796e2+'%');break;}}}catch(_0x120f2b){console[_0x5f2bea(0x27e)](_0x5f2bea(0x229)+_0x52de9c['id']+':',_0x120f2b);}const _0xccdba8=_0x58426b['_sum']?.[_0x5f2bea(0x1cb)]||0x0,_0x3e00bd=_0xccdba8*(0x1-_0x3796e2/0x64);return{'gateway':_0x58426b[_0x5f2bea(0x211)],'count':_0x58426b['_count']?.['id']||0x0,'amountUSDT':Math[_0x5f2bea(0x1be)](_0xccdba8*0x64)/0x64,'amountAfterCommissionUSDT':Math['round'](_0x3e00bd*0x64)/0x64,'commission':_0x3796e2};})),_0x3ab794=_0x256dbb[_0x4669b4(0x2be)]((_0x3b7e45,_0x53bd40)=>_0x3b7e45+_0x53bd40[_0x4669b4(0x1cb)],0x0),_0x2eb1c2=_0x256dbb[_0x4669b4(0x2be)]((_0x16f9f1,_0xfe5c88)=>_0x16f9f1+_0xfe5c88[_0x4669b4(0x27a)],0x0),_0x36fa76=_0x52de9c['balance'];return console[_0x4669b4(0x2fe)]('ðŸ’°\x20[PAYOUT]\x20Merchant\x20'+_0x52de9c[_0x4669b4(0x2dd)]+':'),console[_0x4669b4(0x2fe)](_0x4669b4(0x2d9)+_0x3ab794['toFixed'](0x2)+_0x4669b4(0x307)),console[_0x4669b4(0x2fe)](_0x4669b4(0x1d6)+_0x2eb1c2[_0x4669b4(0x28c)](0x2)+_0x4669b4(0x1ca)),console[_0x4669b4(0x2fe)](_0x4669b4(0x29c)+_0x36fa76['toFixed'](0x2)+_0x4669b4(0x221)),console[_0x4669b4(0x2fe)](_0x4669b4(0x285)+_0x3d71b8[_0x4669b4(0x28c)](0x2)+_0x4669b4(0x1d2)),console[_0x4669b4(0x2fe)](_0x4669b4(0x2bf)+(_0x2eb1c2-_0x3d71b8-_0x36fa76)[_0x4669b4(0x28c)](0x2)+_0x4669b4(0x1ee)),{'id':_0x52de9c['id'],'fullName':_0x52de9c[_0x4669b4(0x22f)],'username':_0x52de9c[_0x4669b4(0x2dd)],'telegramId':_0x52de9c[_0x4669b4(0x1d7)],'merchantUrl':_0x52de9c[_0x4669b4(0x2c4)],'wallets':{'usdtPolygonWallet':_0x52de9c['usdtPolygonWallet'],'usdtTrcWallet':_0x52de9c[_0x4669b4(0x1e4)],'usdtErcWallet':_0x52de9c[_0x4669b4(0x218)],'usdcPolygonWallet':_0x52de9c['usdcPolygonWallet'],'usdcErcWallet':_0x52de9c[_0x4669b4(0x277)]},'totalAmountUSDT':Math['round'](_0x3ab794*0x64)/0x64,'totalAmountAfterCommissionUSDT':Math['round'](_0x2eb1c2*0x64)/0x64,'currentBalance':Math[_0x4669b4(0x220)](_0x36fa76*0x64)/0x64,'totalPayout':Math[_0x4669b4(0x1be)](_0x3d71b8*0x64)/0x64,'thisMonth':Math['round'](_0x470e93*0x64)/0x64,'paymentsCount':_0x3df4fd,'oldestPaymentDate':_0x5c6c24?.[_0x4669b4(0x207)]||_0x52de9c['createdAt'],'gatewayBreakdown':_0x256dbb};})),_0x5b0bd3=_0x55bae1[_0xe417c6(0x2be)]((_0x1c55b3,_0x41a177)=>_0x1c55b3+_0x41a177['totalAmountUSDT'],0x0),_0x333985=_0x55bae1['reduce']((_0x5d8685,_0x2d2ebd)=>_0x5d8685+_0x2d2ebd[_0xe417c6(0x1f6)],0x0),_0x2ef622=_0x55bae1['reduce']((_0x5a8b3b,_0x5945d7)=>_0x5a8b3b+_0x5945d7[_0xe417c6(0x1ff)],0x0),_0x178ad5=_0x55bae1['reduce']((_0xe5a41c,_0x123147)=>_0xe5a41c+_0x123147['thisMonth'],0x0);return console['log'](_0xe417c6(0x2d6)+_0x399712+'\x20merchants'),console[_0xe417c6(0x2fe)](_0xe417c6(0x252)+Math[_0xe417c6(0x1be)](_0x5b0bd3*0x64)/0x64+_0xe417c6(0x307)),console[_0xe417c6(0x2fe)]('\x20\x20\x20âœ…\x20Total\x20net\x20balances:\x20'+Math[_0xe417c6(0x1be)](_0x333985*0x64)/0x64+'\x20USDT\x20(rounded\x20to\x202\x20decimal\x20places)'),console[_0xe417c6(0x2fe)](_0xe417c6(0x24b)+Math['round'](_0x2ef622*0x64)/0x64+'\x20USDT'),console[_0xe417c6(0x2fe)]('\x20\x20\x20ðŸ“…\x20Total\x20payouts\x20(this\x20month):\x20'+Math[_0xe417c6(0x1be)](_0x178ad5*0x64)/0x64+_0xe417c6(0x21a)),{'merchants':_0x55bae1,'pagination':{'page':_0x1e68e5,'limit':_0xf80b09,'total':_0x399712,'totalPages':Math['ceil'](_0x399712/_0xf80b09)},'summary':{'totalMerchants':_0x399712,'totalAmountUSDT':Math[_0xe417c6(0x1be)](_0x5b0bd3*0x64)/0x64,'totalAmountAfterCommissionUSDT':Math['round'](_0x333985*0x64)/0x64,'totalPayout':Math[_0xe417c6(0x1be)](_0x2ef622*0x64)/0x64,'thisMonth':Math[_0xe417c6(0x1be)](_0x178ad5*0x64)/0x64}};}async['createPayout'](_0x4b1852){const _0xd67807=a48_0x596974,{shopId:_0x568d46,amount:_0x16c8f1,network:_0x4822bd,wallet:_0x47dad3,notes:_0x3d6257,txid:_0x5a97ab,periodFrom:_0x7cf0e1,periodTo:_0x4a00d5}=_0x4b1852,_0x78c4f3=await database_1[_0xd67807(0x1cc)][_0xd67807(0x1c1)](async _0x5f1c69=>{const _0x456849=_0xd67807,_0x188e07=await _0x5f1c69['shop'][_0x456849(0x299)]({'where':{'id':_0x568d46},'select':{'id':!![],'name':!![],'username':!![],'balance':!![],'totalPaidOut':!![]}});if(!_0x188e07)throw new Error('Shop\x20not\x20found');console['log'](_0x456849(0x242)+_0x188e07['username']+':'),console[_0x456849(0x2fe)]('\x20\x20\x20Current\x20balance:\x20'+_0x188e07['balance']['toFixed'](0x6)+'\x20USDT'),console[_0x456849(0x2fe)](_0x456849(0x2fc)+_0x16c8f1[_0x456849(0x28c)](0x6)+'\x20USDT'),console[_0x456849(0x2fe)](_0x456849(0x22d)+_0x188e07['totalPaidOut'][_0x456849(0x28c)](0x6)+'\x20USDT');if(_0x5a97ab)console['log'](_0x456849(0x2e4)+_0x5a97ab);const _0x2a0d71=0.000001,_0x5e41ee=Number(_0x188e07['balance']),_0x5c33f9=Number(_0x16c8f1);console[_0x456849(0x2fe)](_0x456849(0x1dd)),console[_0x456849(0x2fe)](_0x456849(0x228)+_0x188e07[_0x456849(0x2eb)]),console[_0x456849(0x2fe)](_0x456849(0x24a)+_0x5e41ee),console[_0x456849(0x2fe)](_0x456849(0x26a)+_0x5c33f9),console['log'](_0x456849(0x30b)+(_0x5e41ee-_0x5c33f9)),console[_0x456849(0x2fe)](_0x456849(0x25a)+_0x2a0d71);if(_0x5e41ee<_0x5c33f9-_0x2a0d71)throw new Error(_0x456849(0x273)+_0x5e41ee['toFixed'](0x6)+_0x456849(0x269)+_0x5c33f9[_0x456849(0x28c)](0x6)+'\x20USDT,\x20Difference:\x20'+(_0x5e41ee-_0x5c33f9)[_0x456849(0x28c)](0x8)+'\x20USDT');console[_0x456849(0x2fe)](_0x456849(0x300));const _0x49926f=Math[_0x456849(0x29a)](_0x5e41ee,_0x5c33f9);let _0xffe2f6=_0x47dad3;console[_0x456849(0x2fe)](_0x456849(0x2c8)+(_0x47dad3||_0x456849(0x2cb)));if(!_0xffe2f6){console[_0x456849(0x2fe)](_0x456849(0x272));const _0x512924=await _0x5f1c69['shop']['findUnique']({'where':{'id':_0x568d46},'select':{'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'usdcErcWallet':!![]}});console[_0x456849(0x2fe)]('ðŸ”\x20Shop\x20wallets:',_0x512924);if(_0x512924)switch(_0x4822bd){case _0x456849(0x2d0):_0xffe2f6=_0x512924[_0x456849(0x2d5)]||undefined,console['log'](_0x456849(0x241)+_0xffe2f6);break;case'trc20':_0xffe2f6=_0x512924[_0x456849(0x1e4)]||undefined,console['log']('ðŸ”\x20Selected\x20trc20\x20wallet:\x20'+_0xffe2f6);break;case'erc20':_0xffe2f6=_0x512924[_0x456849(0x218)]||undefined,console[_0x456849(0x2fe)](_0x456849(0x2bd)+_0xffe2f6);break;case'polygon_usdc':_0xffe2f6=_0x512924['usdcPolygonWallet']||undefined,console[_0x456849(0x2fe)]('ðŸ”\x20Selected\x20polygon_usdc\x20wallet:\x20'+_0xffe2f6);break;case'erc20_usdc':_0xffe2f6=_0x512924[_0x456849(0x277)]||undefined,console[_0x456849(0x2fe)]('ðŸ”\x20Selected\x20erc20_usdc\x20wallet:\x20'+_0xffe2f6);break;}}else console['log'](_0x456849(0x2e5)+_0xffe2f6);console[_0x456849(0x2fe)](_0x456849(0x1b3)+_0x4822bd+':\x20'+(_0xffe2f6||_0x456849(0x2c9))),console[_0x456849(0x2fe)](_0x456849(0x1d1),{'shopId':_0x568d46,'amount':_0x49926f,'network':_0x4822bd,'wallet':_0xffe2f6,'status':_0x456849(0x243),'txid':_0x5a97ab,'notes':_0x3d6257,'periodFrom':_0x7cf0e1?new Date(_0x7cf0e1):null,'periodTo':_0x4a00d5?new Date(_0x4a00d5):null});const _0x59d514=await _0x5f1c69[_0x456849(0x1d8)][_0x456849(0x29e)]({'data':{'shopId':_0x568d46,'amount':_0x49926f,'network':_0x4822bd,'wallet':_0xffe2f6,'status':'COMPLETED','txid':_0x5a97ab,'notes':_0x3d6257,'periodFrom':_0x7cf0e1?new Date(_0x7cf0e1):null,'periodTo':_0x4a00d5?new Date(_0x4a00d5):null,'createdAt':new Date(),'paidAt':new Date()}});console[_0x456849(0x2fe)](_0x456849(0x276),{'id':_0x59d514['id'],'wallet':_0x59d514[_0x456849(0x204)],'network':_0x59d514['network'],'amount':_0x59d514[_0x456849(0x1ba)]});const _0x18a4e0=_0x5e41ee-_0x49926f,_0x1f73ac=Number(_0x188e07['totalPaidOut'])+_0x49926f;return await _0x5f1c69[_0x456849(0x237)]['update']({'where':{'id':_0x568d46},'data':{'balance':_0x18a4e0,'totalPaidOut':_0x1f73ac}}),console['log'](_0x456849(0x1c9)+_0x188e07['username']+_0x456849(0x303)),console[_0x456849(0x2fe)]('\x20\x20\x20Balance:\x20'+_0x5e41ee['toFixed'](0x6)+_0x456849(0x20b)+_0x18a4e0[_0x456849(0x28c)](0x6)+'\x20USDT\x20(-'+_0x49926f[_0x456849(0x28c)](0x6)+')'),console[_0x456849(0x2fe)](_0x456849(0x2d8)+_0x188e07['totalPaidOut'][_0x456849(0x28c)](0x6)+_0x456849(0x20b)+_0x1f73ac[_0x456849(0x28c)](0x6)+'\x20USDT\x20(+'+_0x49926f['toFixed'](0x6)+')'),console[_0x456849(0x2fe)]('\x20\x20\x20Final\x20payout\x20amount\x20used:\x20'+_0x49926f[_0x456849(0x28c)](0x6)+_0x456849(0x21a)),{'payout':_0x59d514,'shop':_0x188e07};});console[_0xd67807(0x2fe)](_0xd67807(0x30e)+_0x78c4f3[_0xd67807(0x1d8)]['id']+_0xd67807(0x30a)+_0x78c4f3[_0xd67807(0x237)][_0xd67807(0x2dd)]+'\x20('+_0x78c4f3[_0xd67807(0x1d8)][_0xd67807(0x1ba)][_0xd67807(0x28c)](0x6)+_0xd67807(0x2b4));try{let _0xa8f46f=_0xd67807(0x2cc);if(_0x78c4f3[_0xd67807(0x1d8)][_0xd67807(0x2d3)]&&_0x78c4f3[_0xd67807(0x1d8)]['periodTo']){const _0x34ca4c=new Date(_0x78c4f3['payout'][_0xd67807(0x2d3)])[_0xd67807(0x209)](_0xd67807(0x1bb)),_0x3b1a6d=new Date(_0x78c4f3[_0xd67807(0x1d8)][_0xd67807(0x1c3)])[_0xd67807(0x209)](_0xd67807(0x1bb));_0xa8f46f=_0x34ca4c+'\x20-\x20'+_0x3b1a6d;}await telegramBotService_1[_0xd67807(0x1f9)]['sendPayoutNotification'](_0x78c4f3[_0xd67807(0x1d8)][_0xd67807(0x31c)],{'id':_0x78c4f3[_0xd67807(0x1d8)]['id'],'amount':_0x78c4f3[_0xd67807(0x1d8)][_0xd67807(0x1ba)],'network':_0x78c4f3[_0xd67807(0x1d8)][_0xd67807(0x1ec)],'wallet':_0x78c4f3[_0xd67807(0x1d8)][_0xd67807(0x204)],'period':_0xa8f46f,'createdAt':_0x78c4f3[_0xd67807(0x1d8)][_0xd67807(0x2cf)],'txid':_0x78c4f3[_0xd67807(0x1d8)][_0xd67807(0x203)]}),console[_0xd67807(0x2fe)](_0xd67807(0x264)+_0x78c4f3['payout']['id']);}catch(_0x3563d0){console[_0xd67807(0x27e)]('âŒ\x20Failed\x20to\x20send\x20Telegram\x20notification\x20for\x20payout\x20'+_0x78c4f3[_0xd67807(0x1d8)]['id']+':',_0x3563d0);}return{'id':_0x78c4f3[_0xd67807(0x1d8)]['id'],'shopId':_0x78c4f3[_0xd67807(0x1d8)]['shopId'],'shopName':_0x78c4f3[_0xd67807(0x237)]['name'],'shopUsername':_0x78c4f3['shop'][_0xd67807(0x2dd)],'amount':_0x78c4f3[_0xd67807(0x1d8)][_0xd67807(0x1ba)],'network':_0x78c4f3['payout'][_0xd67807(0x1ec)],'wallet':_0x78c4f3[_0xd67807(0x1d8)]['wallet'],'status':_0x78c4f3['payout'][_0xd67807(0x316)],'txid':_0x78c4f3[_0xd67807(0x1d8)][_0xd67807(0x203)],'notes':_0x78c4f3[_0xd67807(0x1d8)][_0xd67807(0x28e)],'periodFrom':_0x78c4f3[_0xd67807(0x1d8)]['periodFrom'],'periodTo':_0x78c4f3['payout'][_0xd67807(0x1c3)],'createdAt':_0x78c4f3[_0xd67807(0x1d8)][_0xd67807(0x2cf)],'paidAt':_0x78c4f3['payout'][_0xd67807(0x207)]};}async[a48_0x596974(0x2ce)](_0xefaaf7){const _0x25581e=a48_0x596974,{page:_0x12fc94,limit:_0x12092f,shopId:_0x289c9e,network:_0x33b733,dateFrom:_0x2553e8,dateTo:_0x2340d3,search:_0x316fdf}=_0xefaaf7,_0x2a7558=(_0x12fc94-0x1)*_0x12092f,_0x536a02={};_0x289c9e&&(_0x536a02[_0x25581e(0x31c)]=_0x289c9e);_0x33b733&&(_0x536a02[_0x25581e(0x1ec)]=_0x33b733);if(_0x2553e8||_0x2340d3){_0x536a02[_0x25581e(0x2cf)]={};if(_0x2553e8){const _0x1d1ddb=new Date(_0x2553e8);_0x1d1ddb[_0x25581e(0x1bc)](0x0,0x0,0x0,0x1),_0x536a02['createdAt']['gte']=_0x1d1ddb,console[_0x25581e(0x2fe)](_0x25581e(0x1c5)+_0x1d1ddb['toISOString']());}if(_0x2340d3){const _0x4c90f3=new Date(_0x2340d3);_0x4c90f3[_0x25581e(0x1bc)](0x17,0x3b,0x3b,0x3e7),_0x536a02[_0x25581e(0x2cf)][_0x25581e(0x216)]=_0x4c90f3,console['log'](_0x25581e(0x255)+_0x4c90f3[_0x25581e(0x2c1)]());}}_0x316fdf&&(_0x536a02['OR']=[{'shop':{'name':{'contains':_0x316fdf,'mode':_0x25581e(0x1b5)}}},{'shop':{'username':{'contains':_0x316fdf,'mode':_0x25581e(0x1b5)}}},{'notes':{'contains':_0x316fdf,'mode':_0x25581e(0x1b5)}}]);const [_0xde94d1,_0x9bad52]=await Promise[_0x25581e(0x280)]([database_1[_0x25581e(0x1cc)]['payout'][_0x25581e(0x2bc)]({'where':_0x536a02,'skip':_0x2a7558,'take':_0x12092f,'orderBy':{'createdAt':'desc'},'select':{'id':!![],'shopId':!![],'amount':!![],'network':!![],'status':!![],'txid':!![],'notes':!![],'periodFrom':!![],'periodTo':!![],'createdAt':!![],'wallet':!![],'paidAt':!![],'shop':{'select':{'name':!![],'username':!![]}}}}),database_1[_0x25581e(0x1cc)][_0x25581e(0x1d8)]['count']({'where':_0x536a02})]);return{'payouts':_0xde94d1[_0x25581e(0x267)](_0x41396d=>({'id':_0x41396d['id'],'shopId':_0x41396d[_0x25581e(0x31c)],'shopName':_0x41396d[_0x25581e(0x237)][_0x25581e(0x22f)],'shopUsername':_0x41396d['shop'][_0x25581e(0x2dd)],'amount':_0x41396d[_0x25581e(0x1ba)],'network':_0x41396d['network'],'wallet':_0x41396d[_0x25581e(0x204)],'status':_0x41396d[_0x25581e(0x316)],'txid':_0x41396d[_0x25581e(0x203)],'notes':_0x41396d[_0x25581e(0x28e)],'periodFrom':_0x41396d[_0x25581e(0x2d3)],'periodTo':_0x41396d['periodTo'],'createdAt':_0x41396d[_0x25581e(0x2cf)],'paidAt':_0x41396d[_0x25581e(0x207)]})),'pagination':{'page':_0x12fc94,'limit':_0x12092f,'total':_0x9bad52,'totalPages':Math[_0x25581e(0x31b)](_0x9bad52/_0x12092f)}};}async[a48_0x596974(0x271)](_0x2cf358){const _0x330273=a48_0x596974,_0x3e863a=await database_1[_0x330273(0x1cc)][_0x330273(0x1d8)][_0x330273(0x299)]({'where':{'id':_0x2cf358},'include':{'shop':{'select':{'name':!![],'username':!![]}}}});if(!_0x3e863a)return null;return{'id':_0x3e863a['id'],'shopId':_0x3e863a['shopId'],'shopName':_0x3e863a['shop'][_0x330273(0x22f)],'shopUsername':_0x3e863a[_0x330273(0x237)][_0x330273(0x2dd)],'amount':_0x3e863a[_0x330273(0x1ba)],'network':_0x3e863a['network'],'wallet':_0x3e863a[_0x330273(0x204)],'status':_0x3e863a[_0x330273(0x316)],'txid':_0x3e863a[_0x330273(0x203)],'notes':_0x3e863a[_0x330273(0x28e)],'periodFrom':_0x3e863a[_0x330273(0x2d3)],'periodTo':_0x3e863a[_0x330273(0x1c3)],'createdAt':_0x3e863a[_0x330273(0x2cf)],'paidAt':_0x3e863a[_0x330273(0x207)]};}async[a48_0x596974(0x281)](_0x4a7aa9){const _0x3094be=a48_0x596974;await database_1[_0x3094be(0x1cc)][_0x3094be(0x1d8)][_0x3094be(0x1fa)]({'where':{'id':_0x4a7aa9}});}async['getAllPayments'](_0x2f9359){const _0x5dc833=a48_0x596974,{page:_0x3913b4,limit:_0x2b8b84,status:_0x423c22,gateway:_0x1e0b4e,shopId:_0x288ed2,dateFrom:_0x5c44c6,dateTo:_0x2413b8,search:_0x491403,currency:_0x9587f5,sortBy:_0x23cd35,sortOrder:_0x5476b6}=_0x2f9359,_0x2add1c=(_0x3913b4-0x1)*_0x2b8b84;console['log'](_0x5dc833(0x30f),_0x2f9359);const _0x115eb1=await database_1[_0x5dc833(0x1cc)][_0x5dc833(0x2f3)]['groupBy']({'by':[_0x5dc833(0x211)],'_count':{'gateway':!![]}});console[_0x5dc833(0x2fe)]('ðŸ“Š\x20Available\x20gateways\x20in\x20database:',_0x115eb1[_0x5dc833(0x267)](_0x5763c5=>_0x5763c5['gateway']+'\x20('+_0x5763c5['_count'][_0x5dc833(0x211)]+'\x20payments)'));if(_0x1e0b4e){const _0x15926b=_0x115eb1[_0x5dc833(0x1d3)](_0x267cc4=>_0x267cc4['gateway'][_0x5dc833(0x25c)]()===_0x1e0b4e['toLowerCase']());!_0x15926b&&_0x1e0b4e['toLowerCase']()!=='test_gateway'&&console[_0x5dc833(0x2fe)](_0x5dc833(0x258)+_0x1e0b4e+'\x27\x20not\x20found.\x20Available\x20gateways:\x20'+_0x115eb1[_0x5dc833(0x267)](_0x2e4083=>_0x2e4083[_0x5dc833(0x211)])[_0x5dc833(0x1dc)](',\x20'));}const _0x4f2768={};_0x423c22&&(_0x4f2768[_0x5dc833(0x316)]=_0x423c22['toUpperCase']());if(!_0x1e0b4e)_0x4f2768[_0x5dc833(0x211)]={'not':'test_gateway'};else{if(_0x1e0b4e&&(_0x1e0b4e[_0x5dc833(0x25c)]()==='test_gateway'||_0x1e0b4e===_0x5dc833(0x2b3)))_0x4f2768['gateway']=_0x5dc833(0x213);else{let _0xa40dc5=_0x1e0b4e;const _0x5b4d03=(0x0,gateway_1[_0x5dc833(0x2ff)])(_0x1e0b4e);if(_0x5b4d03)_0xa40dc5=_0x5b4d03,console[_0x5dc833(0x2fe)](_0x5dc833(0x251)+_0x1e0b4e+_0x5dc833(0x2f0)+_0xa40dc5+'\x27');else{const _0x2a6a40=(0x0,gateway_1[_0x5dc833(0x235)])(_0x1e0b4e);if(_0x2a6a40){const _0x191b15=(0x0,gateway_1['getGatewayNameById'])(_0x2a6a40);_0x191b15&&(_0xa40dc5=_0x191b15,console[_0x5dc833(0x2fe)](_0x5dc833(0x23a)+_0x1e0b4e+_0x5dc833(0x319)+_0x2a6a40+_0x5dc833(0x2f5)+_0xa40dc5+'\x27'));}else console['log'](_0x5dc833(0x217)+_0x1e0b4e+_0x5dc833(0x231));}const _0x5b2891=await database_1['default'][_0x5dc833(0x2f3)][_0x5dc833(0x288)]({'where':{'gateway':_0xa40dc5[_0x5dc833(0x25c)]()},'take':0x1});_0x5b2891===0x0?(console[_0x5dc833(0x2fe)](_0x5dc833(0x1f8)+_0xa40dc5+_0x5dc833(0x1b7)+_0x1e0b4e+_0x5dc833(0x1b0)),_0x4f2768[_0x5dc833(0x211)]='NONEXISTENT_GATEWAY_FILTER'):(_0x4f2768[_0x5dc833(0x211)]=_0xa40dc5[_0x5dc833(0x25c)](),console[_0x5dc833(0x2fe)]('âœ…\x20Using\x20gateway\x20filter:\x20\x27'+_0xa40dc5+_0x5dc833(0x1b7)+_0x1e0b4e+'\x27)'));}}console[_0x5dc833(0x2fe)](_0x5dc833(0x20a),_0x4f2768[_0x5dc833(0x211)]);_0x288ed2&&(_0x4f2768[_0x5dc833(0x31c)]=_0x288ed2);_0x9587f5&&(_0x4f2768[_0x5dc833(0x2ba)]=_0x9587f5[_0x5dc833(0x1b9)](),console[_0x5dc833(0x2fe)](_0x5dc833(0x1c4)+_0x9587f5[_0x5dc833(0x1b9)]()));if(_0x5c44c6||_0x2413b8){_0x4f2768[_0x5dc833(0x2cf)]={};if(_0x5c44c6){const _0x4a43f7=new Date(_0x5c44c6),_0x2bd764=new Date(Date[_0x5dc833(0x23e)](_0x4a43f7[_0x5dc833(0x1ce)](),_0x4a43f7[_0x5dc833(0x315)](),_0x4a43f7[_0x5dc833(0x226)](),0x0,0x0,0x0,0x0));_0x4f2768[_0x5dc833(0x2cf)]['gte']=_0x2bd764,console[_0x5dc833(0x2fe)]('ðŸ“…\x20Date\x20from\x20filter:\x20'+_0x2bd764[_0x5dc833(0x2c1)]());}if(_0x2413b8){const _0x4c6c3c=new Date(_0x2413b8),_0xc8a6e8=new Date(Date[_0x5dc833(0x23e)](_0x4c6c3c[_0x5dc833(0x1ce)](),_0x4c6c3c[_0x5dc833(0x315)](),_0x4c6c3c[_0x5dc833(0x226)](),0x17,0x3b,0x3b,0x3e7));_0x4f2768[_0x5dc833(0x2cf)][_0x5dc833(0x216)]=_0xc8a6e8,console[_0x5dc833(0x2fe)](_0x5dc833(0x2ea)+_0xc8a6e8[_0x5dc833(0x2c1)]());}}_0x491403&&(_0x4f2768['OR']=[{'id':{'contains':_0x491403,'mode':_0x5dc833(0x1b5)}},{'orderId':{'contains':_0x491403,'mode':'insensitive'}},{'gatewayOrderId':{'contains':_0x491403,'mode':_0x5dc833(0x1b5)}},{'customerEmail':{'contains':_0x491403,'mode':_0x5dc833(0x1b5)}},{'shop':{'name':{'contains':_0x491403,'mode':_0x5dc833(0x1b5)}}},{'shop':{'username':{'contains':_0x491403,'mode':_0x5dc833(0x1b5)}}}]);console[_0x5dc833(0x2fe)](_0x5dc833(0x222),JSON[_0x5dc833(0x279)](_0x4f2768,null,0x2));const _0x4ccc3a=await database_1[_0x5dc833(0x1cc)]['payment'][_0x5dc833(0x288)]({'where':_0x4f2768});console['log'](_0x5dc833(0x22c)+_0x4ccc3a);let _0x259963={'createdAt':_0x5dc833(0x297)};if(_0x23cd35){const _0x358762=[_0x5dc833(0x1ba),_0x5dc833(0x2cf),_0x5dc833(0x2f9),_0x5dc833(0x316),_0x5dc833(0x211),'currency'],_0x11b2a8=['asc','desc'];if(_0x358762[_0x5dc833(0x1db)](_0x23cd35)){const _0x4d7ba0=_0x11b2a8['includes'](_0x5476b6)?_0x5476b6:'desc';_0x259963={[_0x23cd35]:_0x4d7ba0},console['log'](_0x5dc833(0x25d)+_0x23cd35+_0x5dc833(0x29f)+_0x4d7ba0+_0x5dc833(0x232));}}const [_0x51fec5,_0x4d0b1a]=await Promise['all']([database_1['default'][_0x5dc833(0x2f3)][_0x5dc833(0x2bc)]({'where':_0x4f2768,'skip':_0x2add1c,'take':_0x2b8b84,'orderBy':_0x259963,'include':{'shop':{'select':{'name':!![],'username':!![]}}}}),database_1[_0x5dc833(0x1cc)][_0x5dc833(0x2f3)][_0x5dc833(0x288)]({'where':_0x4f2768})]);let _0x1c4f6b,_0x35a178;if(_0x5c44c6){const _0x200e13=new Date(_0x5c44c6);_0x1c4f6b=new Date(Date['UTC'](_0x200e13['getUTCFullYear'](),_0x200e13['getUTCMonth'](),_0x200e13['getUTCDate'](),0x0,0x0,0x0,0x0));}else{const _0x4eafe7=new Date();_0x1c4f6b=new Date(Date[_0x5dc833(0x23e)](_0x4eafe7[_0x5dc833(0x1ce)](),_0x4eafe7[_0x5dc833(0x315)](),_0x4eafe7['getUTCDate'](),0x0,0x0,0x0,0x0));}if(_0x2413b8){const _0x23c8b4=new Date(_0x2413b8);_0x35a178=new Date(Date['UTC'](_0x23c8b4[_0x5dc833(0x1ce)](),_0x23c8b4[_0x5dc833(0x315)](),_0x23c8b4['getUTCDate'](),0x17,0x3b,0x3b,0x3e7));}else{if(_0x5c44c6){const _0x5e851f=new Date(_0x5c44c6);_0x35a178=new Date(Date['UTC'](_0x5e851f['getUTCFullYear'](),_0x5e851f[_0x5dc833(0x315)](),_0x5e851f[_0x5dc833(0x226)](),0x17,0x3b,0x3b,0x3e7));}else{const _0x370f81=new Date();_0x35a178=new Date(Date[_0x5dc833(0x23e)](_0x370f81[_0x5dc833(0x1ce)](),_0x370f81[_0x5dc833(0x315)](),_0x370f81[_0x5dc833(0x226)](),0x17,0x3b,0x3b,0x3e7));}}const _0x496d83={'status':_0x5dc833(0x202),'createdAt':{'gte':_0x1c4f6b,'lte':_0x35a178}};_0x1e0b4e?_0x496d83[_0x5dc833(0x211)]=_0x4f2768[_0x5dc833(0x211)]:_0x496d83['gateway']={'not':_0x5dc833(0x213)};_0x288ed2&&(_0x496d83[_0x5dc833(0x31c)]=_0x288ed2);const _0xa77d94=await database_1[_0x5dc833(0x1cc)][_0x5dc833(0x2f3)]['findMany']({'where':_0x496d83,'select':{'amountUSDT':!![],'currency':!![],'amount':!![]}}),_0x322f68={};let _0x2932dc=0x0;return _0xa77d94['forEach'](_0x2cb084=>{const _0x46afac=_0x5dc833;_0x2cb084[_0x46afac(0x1cb)]&&(_0x2932dc+=_0x2cb084[_0x46afac(0x1cb)]);if(_0x2cb084[_0x46afac(0x2ba)]){const _0x411c39=_0x2cb084[_0x46afac(0x2ba)]['toUpperCase']();!_0x322f68[_0x411c39]&&(_0x322f68[_0x411c39]=0x0),_0x322f68[_0x411c39]+=_0x2cb084[_0x46afac(0x1ba)];}}),_0x2932dc>0x0&&(_0x322f68[_0x5dc833(0x274)]=_0x2932dc),{'payments':_0x51fec5,'pagination':{'page':_0x3913b4,'limit':_0x2b8b84,'total':_0x4d0b1a,'totalPages':Math['ceil'](_0x4d0b1a/_0x2b8b84)},'statistics':_0x322f68};}async[a48_0x596974(0x293)](_0x1650eb){const _0x20127a=a48_0x596974,_0x57f719=await database_1[_0x20127a(0x1cc)][_0x20127a(0x2f3)][_0x20127a(0x299)]({'where':{'id':_0x1650eb},'select':{'id':!![],'shopId':!![],'amount':!![],'amountAfterGatewayCommissionUSDT':!![],'currency':!![],'sourceCurrency':!![],'status':!![],'gateway':!![],'orderId':!![],'gatewayOrderId':!![],'gatewayPaymentId':!![],'customerEmail':!![],'customerName':!![],'customerCountry':!![],'customerIp':!![],'customerUa':!![],'externalPaymentUrl':!![],'successUrl':!![],'failUrl':!![],'pendingUrl':!![],'whiteUrl':!![],'expiresAt':!![],'invoiceTotalSum':!![],'qrCode':!![],'qrUrl':!![],'country':!![],'language':!![],'amountIsEditable':!![],'maxPayments':!![],'rapydCustomer':!![],'cardLast4':!![],'paymentMethod':!![],'bankId':!![],'remitterIban':!![],'remitterName':!![],'failureMessage':!![],'usage':!![],'createdAt':!![],'updatedAt':!![],'shop':{'select':{'name':!![],'username':!![]}}}});if(!_0x57f719)return null;return{'id':_0x57f719['id'],'shopId':_0x57f719[_0x20127a(0x31c)],'gateway':_0x57f719[_0x20127a(0x211)],'amount':_0x57f719[_0x20127a(0x1ba)],'currency':_0x57f719['currency'],'status':_0x57f719[_0x20127a(0x316)],'orderId':_0x57f719[_0x20127a(0x25b)],'gatewayOrderId':_0x57f719[_0x20127a(0x2ee)],'customerEmail':_0x57f719[_0x20127a(0x2b5)],'customerName':_0x57f719['customerName'],'customerCountry':_0x57f719[_0x20127a(0x28b)],'customerIp':_0x57f719[_0x20127a(0x2ca)],'customerUa':_0x57f719[_0x20127a(0x2d7)],'failureMessage':_0x57f719[_0x20127a(0x1d5)],'externalPaymentUrl':_0x57f719['externalPaymentUrl'],'successUrl':_0x57f719[_0x20127a(0x21e)],'failUrl':_0x57f719[_0x20127a(0x1d4)],'pendingUrl':_0x57f719['pendingUrl'],'whiteUrl':_0x57f719[_0x20127a(0x20d)],'createdAt':_0x57f719[_0x20127a(0x2cf)],'updatedAt':_0x57f719[_0x20127a(0x2f9)],'shop':_0x57f719[_0x20127a(0x237)]};}async[a48_0x596974(0x24c)](_0x46d88c,_0x2666da,_0x721824,_0x2c294a){const _0x22ab72=a48_0x596974,_0x245e6e=await database_1[_0x22ab72(0x1cc)][_0x22ab72(0x1c1)](async _0x25bb46=>{const _0x28aa1a=_0x22ab72,_0x3730f8=await _0x25bb46['payment'][_0x28aa1a(0x299)]({'where':{'id':_0x46d88c},'include':{'shop':{'select':{'id':!![],'name':!![],'username':!![],'balance':!![]}}}});if(!_0x3730f8)throw new Error(_0x28aa1a(0x306));const _0x2abd59=_0x3730f8[_0x28aa1a(0x316)],_0x589dff=_0x2666da[_0x28aa1a(0x1b9)]();console[_0x28aa1a(0x2fe)](_0x28aa1a(0x2f8)+_0x46d88c+_0x28aa1a(0x215)+_0x2abd59+'\x20->\x20'+_0x589dff),console[_0x28aa1a(0x2fe)]('ðŸ’°\x20Current\x20shop\x20balance:\x20'+_0x3730f8[_0x28aa1a(0x237)][_0x28aa1a(0x2eb)]+_0x28aa1a(0x21a));const _0x37b027={'status':_0x589dff,'updatedAt':new Date(),'statusChangedBy':_0x28aa1a(0x2e0),'statusChangedAt':new Date()};_0x721824&&(_0x37b027[_0x28aa1a(0x1f3)]=_0x721824);_0x589dff===_0x28aa1a(0x26c)&&_0x2c294a&&(_0x37b027[_0x28aa1a(0x2de)]=_0x2c294a);let _0x3d1a8e=0x0,_0x44aca0=_0x3730f8[_0x28aa1a(0x237)][_0x28aa1a(0x2eb)];if(_0x589dff==='PAID'&&_0x2abd59!==_0x28aa1a(0x202)){_0x37b027[_0x28aa1a(0x207)]=new Date();const _0x80b401=await currencyService_1[_0x28aa1a(0x2a8)]['convertToUSDT'](_0x3730f8[_0x28aa1a(0x1ba)],_0x3730f8[_0x28aa1a(0x2ba)]);_0x37b027[_0x28aa1a(0x1cb)]=_0x80b401;let _0x39f22b=0x2d;const _0x526b7e=await _0x25bb46['shop'][_0x28aa1a(0x299)]({'where':{'id':_0x3730f8[_0x28aa1a(0x31c)]},'select':{'gatewaySettings':!![]}});if(_0x526b7e?.['gatewaySettings'])try{const _0x347101=JSON[_0x28aa1a(0x317)](_0x526b7e[_0x28aa1a(0x2ab)]);for(const [_0x4f1065,_0x189a15]of Object[_0x28aa1a(0x248)](_0x347101)){if(_0x4f1065[_0x28aa1a(0x25c)]()===_0x3730f8[_0x28aa1a(0x211)][_0x28aa1a(0x25c)]()){_0x39f22b=_0x189a15[_0x28aa1a(0x1e3)]||0xa;break;}}}catch(_0x2fe159){console[_0x28aa1a(0x27e)]('Error\x20parsing\x20gateway\x20settings\x20for\x20payment\x20'+_0x46d88c+':',_0x2fe159);}let _0x9cbe66;_0x3730f8[_0x28aa1a(0x2e6)]!==null&&_0x3730f8[_0x28aa1a(0x2e6)]!==undefined?(_0x9cbe66=_0x3730f8[_0x28aa1a(0x2e6)],console[_0x28aa1a(0x2fe)]('ðŸ“Š\x20[ADMIN]\x20Using\x20saved\x20amountAfterGatewayCommissionUSDT:\x20'+_0x9cbe66[_0x28aa1a(0x28c)](0x6)+_0x28aa1a(0x22e)+_0x46d88c)):(_0x9cbe66=_0x80b401*(0x1-_0x39f22b/0x64),console['log']('ðŸ“Š\x20[ADMIN]\x20Calculating\x20commission\x20manually\x20for\x20payment\x20'+_0x46d88c+':\x20'+_0x39f22b+_0x28aa1a(0x2d4)+_0x80b401[_0x28aa1a(0x28c)](0x6)+_0x28aa1a(0x21a)),_0x37b027[_0x28aa1a(0x2e6)]=_0x9cbe66,_0x37b027['gatewayCommissionRate']=_0x39f22b),_0x3d1a8e=_0x9cbe66,_0x44aca0+=_0x9cbe66,console['log']('ðŸ’°\x20Payment\x20'+_0x46d88c+_0x28aa1a(0x2e7)),console[_0x28aa1a(0x2fe)]('\x20\x20\x20Full\x20amount:\x20'+_0x80b401['toFixed'](0x6)+_0x28aa1a(0x21a)),console['log'](_0x28aa1a(0x311)+_0x3730f8[_0x28aa1a(0x211)]+_0x28aa1a(0x210)+_0x39f22b+'%'),console['log'](_0x28aa1a(0x286)+_0x9cbe66[_0x28aa1a(0x28c)](0x6)+_0x28aa1a(0x2c2)+_0x39f22b+_0x28aa1a(0x296)),console[_0x28aa1a(0x2fe)]('\x20\x20\x20Added\x20to\x20balance:\x20+'+_0x9cbe66[_0x28aa1a(0x28c)](0x6)+'\x20USDT');}else{if(_0x2abd59===_0x28aa1a(0x202)&&_0x589dff!==_0x28aa1a(0x202)&&_0x589dff!==_0x28aa1a(0x26c)){if(_0x3730f8[_0x28aa1a(0x1cb)]){let _0x4c3d40=0x2d;const _0x42f3e0=await _0x25bb46['shop'][_0x28aa1a(0x299)]({'where':{'id':_0x3730f8[_0x28aa1a(0x31c)]},'select':{'gatewaySettings':!![]}});if(_0x42f3e0?.['gatewaySettings'])try{const _0x45cb2e=JSON[_0x28aa1a(0x317)](_0x42f3e0[_0x28aa1a(0x2ab)]);for(const [_0x1afa89,_0xfd540]of Object[_0x28aa1a(0x248)](_0x45cb2e)){if(_0x1afa89[_0x28aa1a(0x25c)]()===_0x3730f8[_0x28aa1a(0x211)][_0x28aa1a(0x25c)]()){_0x4c3d40=_0xfd540[_0x28aa1a(0x1e3)]||0xa;break;}}}catch(_0x3ddcdd){console['error'](_0x28aa1a(0x305)+_0x46d88c+':',_0x3ddcdd);}const _0x3639b9=_0x3730f8[_0x28aa1a(0x1cb)]*(0x1-_0x4c3d40/0x64);_0x3d1a8e=-_0x3639b9,_0x44aca0-=_0x3639b9,console['log']('\x20\x20\x20Full\x20amount:\x20'+_0x3730f8[_0x28aa1a(0x1cb)][_0x28aa1a(0x28c)](0x6)+_0x28aa1a(0x21a)),console['log']('\x20\x20\x20Gateway:\x20'+_0x3730f8[_0x28aa1a(0x211)]+_0x28aa1a(0x210)+_0x4c3d40+'%'),console[_0x28aa1a(0x2fe)](_0x28aa1a(0x301)+_0x3639b9[_0x28aa1a(0x28c)](0x6)+'\x20USDT\x20(after\x20'+_0x4c3d40+_0x28aa1a(0x296)),console['log']('\x20\x20\x20Subtracted\x20from\x20balance:\x20-'+_0x3639b9[_0x28aa1a(0x28c)](0x6)+_0x28aa1a(0x21a));}}}_0x589dff==='CHARGEBACK'&&(console[_0x28aa1a(0x2fe)](_0x28aa1a(0x1b4)),_0x2c294a&&_0x2c294a>0x0?(_0x3d1a8e=-_0x2c294a,_0x44aca0-=_0x2c294a,console['log'](_0x28aa1a(0x1ef)+_0x2c294a[_0x28aa1a(0x28c)](0x6)+_0x28aa1a(0x227)),console[_0x28aa1a(0x2fe)](_0x28aa1a(0x2a6))):console[_0x28aa1a(0x2fe)](_0x28aa1a(0x250)),_0x37b027['chargebackAmount']=_0x2c294a||0x0);_0x589dff==='REFUND'&&_0x2abd59===_0x28aa1a(0x202)&&console[_0x28aa1a(0x2fe)](_0x28aa1a(0x246));const _0x5be638=await _0x25bb46[_0x28aa1a(0x2f3)][_0x28aa1a(0x1f2)]({'where':{'id':_0x46d88c},'data':_0x37b027,'include':{'shop':{'select':{'name':!![],'username':!![]}}}});return _0x3d1a8e!==0x0&&(await _0x25bb46['shop'][_0x28aa1a(0x1f2)]({'where':{'id':_0x3730f8[_0x28aa1a(0x31c)]},'data':{'balance':_0x44aca0}}),console[_0x28aa1a(0x2fe)](_0x28aa1a(0x1c9)+_0x3730f8['shopId']+'\x20balance\x20updated:\x20'+_0x3730f8[_0x28aa1a(0x237)][_0x28aa1a(0x2eb)]['toFixed'](0x6)+'\x20->\x20'+_0x44aca0['toFixed'](0x6)+_0x28aa1a(0x238)+(_0x3d1a8e>0x0?'+':'')+_0x3d1a8e['toFixed'](0x6)+')')),_0x5be638;});return{'id':_0x245e6e['id'],'shopId':_0x245e6e['shopId'],'gateway':_0x245e6e[_0x22ab72(0x211)],'amount':_0x245e6e[_0x22ab72(0x1ba)],'currency':_0x245e6e[_0x22ab72(0x2ba)],'status':_0x245e6e[_0x22ab72(0x316)],'orderId':_0x245e6e[_0x22ab72(0x25b)],'gatewayOrderId':_0x245e6e[_0x22ab72(0x2ee)],'customerEmail':_0x245e6e[_0x22ab72(0x2b5)],'customerName':_0x245e6e['customerName'],'customerCountry':_0x245e6e[_0x22ab72(0x28b)],'customerIp':_0x245e6e[_0x22ab72(0x2ca)],'customerUa':_0x245e6e['customerUa'],'failureMessage':_0x245e6e[_0x22ab72(0x1d5)],'adminNotes':_0x245e6e[_0x22ab72(0x1f3)],'chargebackAmount':_0x245e6e[_0x22ab72(0x2de)],'statusChangedBy':_0x245e6e[_0x22ab72(0x2fd)],'statusChangedAt':_0x245e6e['statusChangedAt'],'createdAt':_0x245e6e['createdAt'],'updatedAt':_0x245e6e[_0x22ab72(0x2f9)],'shop':_0x245e6e[_0x22ab72(0x237)]};}async[a48_0x596974(0x2b2)](_0x2df6a2,_0x540fe4){const _0x564c05=a48_0x596974,_0x4d141c=Math[_0x564c05(0x287)]()[_0x564c05(0x244)](0x24)[_0x564c05(0x247)](0x2,0x9);console[_0x564c05(0x2fe)](_0x564c05(0x29d)+_0x4d141c+_0x564c05(0x26b)+_0x2df6a2);const _0x582702={..._0x540fe4};_0x540fe4[_0x564c05(0x22a)]&&_0x540fe4[_0x564c05(0x22a)]['trim']()!==''?(console[_0x564c05(0x2fe)](_0x564c05(0x275)+_0x4d141c+_0x564c05(0x22b)+_0x2df6a2),_0x582702['password']=await bcryptjs_1[_0x564c05(0x1cc)][_0x564c05(0x1f1)](_0x540fe4[_0x564c05(0x22a)],0xc)):(console[_0x564c05(0x2fe)](_0x564c05(0x275)+_0x4d141c+_0x564c05(0x2e9)),delete _0x582702[_0x564c05(0x22a)]);_0x540fe4[_0x564c05(0x2c5)]&&(_0x582702['name']=_0x540fe4[_0x564c05(0x2c5)],delete _0x582702[_0x564c05(0x2c5)]);_0x540fe4[_0x564c05(0x2f7)]&&(_0x582702['telegram']=_0x540fe4[_0x564c05(0x2f7)],delete _0x582702[_0x564c05(0x2f7)]);_0x540fe4[_0x564c05(0x1e2)]&&(_0x582702[_0x564c05(0x2c4)]=_0x540fe4['merchantUrl'],delete _0x582702['merchantUrl']);if(_0x540fe4[_0x564c05(0x2ac)]){const _0x303cf5=_0x540fe4[_0x564c05(0x2ac)][_0x564c05(0x267)](_0x426945=>this[_0x564c05(0x205)](_0x426945));console[_0x564c05(0x2fe)](_0x564c05(0x214),_0x540fe4[_0x564c05(0x2ac)],'->',_0x303cf5),_0x582702[_0x564c05(0x2b7)]=JSON[_0x564c05(0x279)](_0x303cf5),delete _0x582702[_0x564c05(0x2ac)];}_0x540fe4[_0x564c05(0x2ab)]&&(console['log'](_0x564c05(0x1d0)+_0x4d141c+_0x564c05(0x239),_0x540fe4['gatewaySettings']),_0x582702[_0x564c05(0x2ab)]=JSON[_0x564c05(0x279)](_0x540fe4[_0x564c05(0x2ab)]),console[_0x564c05(0x2fe)]('ðŸ”§\x20['+_0x4d141c+_0x564c05(0x2e2),_0x582702['gatewaySettings']));_0x540fe4[_0x564c05(0x283)]&&(_0x540fe4[_0x564c05(0x283)][_0x564c05(0x2d5)]!==undefined&&(_0x582702['usdtPolygonWallet']=_0x540fe4[_0x564c05(0x283)]['usdtPolygonWallet']||null),_0x540fe4[_0x564c05(0x283)][_0x564c05(0x1e4)]!==undefined&&(_0x582702[_0x564c05(0x1e4)]=_0x540fe4['wallets'][_0x564c05(0x1e4)]||null),_0x540fe4[_0x564c05(0x283)]['usdtErcWallet']!==undefined&&(_0x582702['usdtErcWallet']=_0x540fe4[_0x564c05(0x283)][_0x564c05(0x218)]||null),_0x540fe4[_0x564c05(0x283)]['usdcPolygonWallet']!==undefined&&(_0x582702[_0x564c05(0x292)]=_0x540fe4[_0x564c05(0x283)]['usdcPolygonWallet']||null),delete _0x582702[_0x564c05(0x283)]);const _0x5c0686=await database_1[_0x564c05(0x1cc)][_0x564c05(0x237)][_0x564c05(0x1f2)]({'where':{'id':_0x2df6a2},'data':_0x582702,'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});return console[_0x564c05(0x2fe)](_0x564c05(0x30c)+_0x4d141c+_0x564c05(0x2e8),_0x5c0686[_0x564c05(0x2ab)]),{'id':_0x5c0686['id'],'fullName':_0x5c0686[_0x564c05(0x22f)],'username':_0x5c0686[_0x564c05(0x2dd)],'telegramId':_0x5c0686['telegram'],'merchantUrl':_0x5c0686['shopUrl'],'gateways':_0x5c0686[_0x564c05(0x2b7)]?JSON[_0x564c05(0x317)](_0x5c0686['paymentGateways']):null,'gatewaySettings':_0x5c0686[_0x564c05(0x2ab)]?JSON['parse'](_0x5c0686['gatewaySettings']):null,'publicKey':_0x5c0686['publicKey'],'wallets':{'usdtPolygonWallet':_0x5c0686[_0x564c05(0x2d5)],'usdtTrcWallet':_0x5c0686[_0x564c05(0x1e4)],'usdtErcWallet':_0x5c0686[_0x564c05(0x218)],'usdcPolygonWallet':_0x5c0686[_0x564c05(0x292)]},'status':_0x5c0686[_0x564c05(0x316)],'createdAt':_0x5c0686[_0x564c05(0x2cf)]};}async[a48_0x596974(0x1f7)](_0x50e017){const _0x45cc04=a48_0x596974,_0x8c9e13=await database_1[_0x45cc04(0x1cc)]['shop']['update']({'where':{'id':_0x50e017},'data':{'status':_0x45cc04(0x21b)},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});return{'id':_0x8c9e13['id'],'fullName':_0x8c9e13[_0x45cc04(0x22f)],'username':_0x8c9e13['username'],'telegramId':_0x8c9e13[_0x45cc04(0x1d7)],'merchantUrl':_0x8c9e13[_0x45cc04(0x2c4)],'gateways':_0x8c9e13[_0x45cc04(0x2b7)]?JSON[_0x45cc04(0x317)](_0x8c9e13['paymentGateways']):null,'gatewaySettings':_0x8c9e13[_0x45cc04(0x2ab)]?JSON[_0x45cc04(0x317)](_0x8c9e13[_0x45cc04(0x2ab)]):null,'publicKey':_0x8c9e13[_0x45cc04(0x298)],'wallets':{'usdtPolygonWallet':_0x8c9e13[_0x45cc04(0x2d5)],'usdtTrcWallet':_0x8c9e13[_0x45cc04(0x1e4)],'usdtErcWallet':_0x8c9e13[_0x45cc04(0x218)],'usdcPolygonWallet':_0x8c9e13['usdcPolygonWallet']},'status':_0x8c9e13[_0x45cc04(0x316)],'createdAt':_0x8c9e13[_0x45cc04(0x2cf)]};}async[a48_0x596974(0x2a9)](_0x1b9cf4){const _0x186d28=a48_0x596974,_0xe7ffda=await database_1[_0x186d28(0x1cc)][_0x186d28(0x237)][_0x186d28(0x1f2)]({'where':{'id':_0x1b9cf4},'data':{'status':_0x186d28(0x2af)},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});return{'id':_0xe7ffda['id'],'fullName':_0xe7ffda[_0x186d28(0x22f)],'username':_0xe7ffda[_0x186d28(0x2dd)],'telegramId':_0xe7ffda[_0x186d28(0x1d7)],'merchantUrl':_0xe7ffda[_0x186d28(0x2c4)],'gateways':_0xe7ffda[_0x186d28(0x2b7)]?JSON['parse'](_0xe7ffda['paymentGateways']):null,'gatewaySettings':_0xe7ffda[_0x186d28(0x2ab)]?JSON[_0x186d28(0x317)](_0xe7ffda[_0x186d28(0x2ab)]):null,'publicKey':_0xe7ffda['publicKey'],'wallets':{'usdtPolygonWallet':_0xe7ffda[_0x186d28(0x2d5)],'usdtTrcWallet':_0xe7ffda[_0x186d28(0x1e4)],'usdtErcWallet':_0xe7ffda[_0x186d28(0x218)],'usdcPolygonWallet':_0xe7ffda['usdcPolygonWallet']},'status':_0xe7ffda[_0x186d28(0x316)],'createdAt':_0xe7ffda['createdAt']};}async[a48_0x596974(0x1e5)](_0x105080){const _0x19ef2c=a48_0x596974,{page:_0x14ff8b,limit:_0x1e090f,status:_0x325b4d}=_0x105080,_0x306e94=(_0x14ff8b-0x1)*_0x1e090f,_0x303b2d={};_0x325b4d&&(_0x303b2d[_0x19ef2c(0x316)]=_0x325b4d[_0x19ef2c(0x1b9)]());const [_0x346d51,_0x339394]=await Promise['all']([database_1[_0x19ef2c(0x1cc)][_0x19ef2c(0x237)]['findMany']({'where':_0x303b2d,'skip':_0x306e94,'take':_0x1e090f,'orderBy':{'createdAt':_0x19ef2c(0x297)},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'usdcErcWallet':!![],'status':!![],'createdAt':!![]}}),database_1[_0x19ef2c(0x1cc)]['shop'][_0x19ef2c(0x288)]({'where':_0x303b2d})]);return{'users':_0x346d51[_0x19ef2c(0x267)](_0x32c603=>{const _0x260358=_0x19ef2c,_0x12f8c7=_0x32c603[_0x260358(0x2b7)]?JSON[_0x260358(0x317)](_0x32c603[_0x260358(0x2b7)]):null,_0x4f9acf=_0x12f8c7?_0x12f8c7[_0x260358(0x267)](_0x4e94e8=>this[_0x260358(0x1b6)](_0x4e94e8)):null;return{'id':_0x32c603['id'],'fullName':_0x32c603[_0x260358(0x22f)],'username':_0x32c603['username'],'telegramId':_0x32c603[_0x260358(0x1d7)],'merchantUrl':_0x32c603[_0x260358(0x2c4)],'gateways':_0x4f9acf,'gatewaySettings':_0x32c603[_0x260358(0x2ab)]?JSON[_0x260358(0x317)](_0x32c603[_0x260358(0x2ab)]):null,'publicKey':_0x32c603[_0x260358(0x298)],'wallets':{'usdtPolygonWallet':_0x32c603[_0x260358(0x2d5)],'usdtTrcWallet':_0x32c603['usdtTrcWallet'],'usdtErcWallet':_0x32c603[_0x260358(0x218)],'usdcPolygonWallet':_0x32c603[_0x260358(0x292)],'usdcErcWallet':_0x32c603[_0x260358(0x277)]},'status':_0x32c603[_0x260358(0x316)],'createdAt':_0x32c603[_0x260358(0x2cf)]};}),'pagination':{'page':_0x14ff8b,'limit':_0x1e090f,'total':_0x339394,'totalPages':Math[_0x19ef2c(0x31b)](_0x339394/_0x1e090f)}};}async[a48_0x596974(0x223)](_0x40c00a){const _0x42b331=a48_0x596974,_0x48b753=await database_1[_0x42b331(0x1cc)][_0x42b331(0x237)][_0x42b331(0x299)]({'where':{'id':_0x40c00a},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'usdcErcWallet':!![],'status':!![],'createdAt':!![]}});if(!_0x48b753)return null;const _0x6d91e6=_0x48b753[_0x42b331(0x2b7)]?JSON[_0x42b331(0x317)](_0x48b753[_0x42b331(0x2b7)]):null,_0x3f254c=_0x6d91e6?_0x6d91e6[_0x42b331(0x267)](_0x6d238f=>this[_0x42b331(0x1b6)](_0x6d238f)):null;return _0x6d91e6&&_0x3f254c&&console[_0x42b331(0x2fe)](_0x42b331(0x1bd),_0x6d91e6,'->',_0x3f254c),{'id':_0x48b753['id'],'fullName':_0x48b753[_0x42b331(0x22f)],'username':_0x48b753['username'],'telegramId':_0x48b753[_0x42b331(0x1d7)],'merchantUrl':_0x48b753[_0x42b331(0x2c4)],'gateways':_0x3f254c,'gatewaySettings':_0x48b753['gatewaySettings']?JSON[_0x42b331(0x317)](_0x48b753[_0x42b331(0x2ab)]):null,'publicKey':_0x48b753[_0x42b331(0x298)],'wallets':{'usdtPolygonWallet':_0x48b753[_0x42b331(0x2d5)],'usdtTrcWallet':_0x48b753['usdtTrcWallet'],'usdtErcWallet':_0x48b753[_0x42b331(0x218)],'usdcPolygonWallet':_0x48b753['usdcPolygonWallet'],'usdcErcWallet':_0x48b753[_0x42b331(0x277)]},'status':_0x48b753[_0x42b331(0x316)],'createdAt':_0x48b753[_0x42b331(0x2cf)]};}async['createUser'](_0x3c2dda){const _0x5037e9=a48_0x596974,{fullName:_0x351458,username:_0x5ef645,password:_0x36d009,telegramId:_0x3a0083,merchantUrl:_0x11c502,gateways:_0x35c75d,gatewaySettings:_0x40a8c1,wallets:_0x173493}=_0x3c2dda,_0x1539a9=await database_1[_0x5037e9(0x1cc)][_0x5037e9(0x237)][_0x5037e9(0x299)]({'where':{'username':_0x5ef645}});if(_0x1539a9)throw new Error('Username\x20already\x20exists');if(_0x3a0083){const _0x12bbe8=await database_1[_0x5037e9(0x1cc)][_0x5037e9(0x237)][_0x5037e9(0x299)]({'where':{'telegram':_0x3a0083}});if(_0x12bbe8)throw new Error('Telegram\x20username\x20already\x20exists');}const _0x434db2=await bcryptjs_1[_0x5037e9(0x1cc)]['hash'](_0x36d009,0xc),_0x6c56de=_0x5037e9(0x2b1)+crypto_1['default']['randomBytes'](0x20)['toString']('hex'),_0x4aa46e=_0x5037e9(0x308)+crypto_1[_0x5037e9(0x1cc)][_0x5037e9(0x1c7)](0x20)[_0x5037e9(0x244)](_0x5037e9(0x2cd)),_0x3171a5=_0x35c75d?_0x35c75d['map'](_0x2f8b63=>this[_0x5037e9(0x205)](_0x2f8b63)):null;_0x35c75d&&_0x3171a5&&console['log']('ðŸ”„\x20Gateway\x20mapping\x20(create):',_0x35c75d,'->',_0x3171a5);const _0x118853=await database_1[_0x5037e9(0x1cc)][_0x5037e9(0x237)][_0x5037e9(0x29e)]({'data':{'name':_0x351458,'username':_0x5ef645,'password':_0x434db2,'telegram':_0x3a0083,'shopUrl':_0x11c502,'paymentGateways':_0x3171a5?JSON['stringify'](_0x3171a5):null,'gatewaySettings':_0x40a8c1?JSON['stringify'](_0x40a8c1):null,'usdtPolygonWallet':_0x173493?.[_0x5037e9(0x2d5)]||null,'usdtTrcWallet':_0x173493?.[_0x5037e9(0x1e4)]||null,'usdtErcWallet':_0x173493?.[_0x5037e9(0x218)]||null,'usdcPolygonWallet':_0x173493?.[_0x5037e9(0x292)]||null,'publicKey':_0x6c56de,'secretKey':_0x4aa46e,'status':'ACTIVE'},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});return{'id':_0x118853['id'],'fullName':_0x118853[_0x5037e9(0x22f)],'username':_0x118853[_0x5037e9(0x2dd)],'telegramId':_0x118853[_0x5037e9(0x1d7)],'merchantUrl':_0x118853[_0x5037e9(0x2c4)],'gateways':_0x118853[_0x5037e9(0x2b7)]?JSON['parse'](_0x118853[_0x5037e9(0x2b7)]):null,'gatewaySettings':_0x118853[_0x5037e9(0x2ab)]?JSON['parse'](_0x118853[_0x5037e9(0x2ab)]):null,'publicKey':_0x118853[_0x5037e9(0x298)],'wallets':{'usdtPolygonWallet':_0x118853[_0x5037e9(0x2d5)],'usdtTrcWallet':_0x118853[_0x5037e9(0x1e4)],'usdtErcWallet':_0x118853[_0x5037e9(0x218)],'usdcPolygonWallet':_0x118853[_0x5037e9(0x292)]},'status':_0x118853[_0x5037e9(0x316)],'createdAt':_0x118853[_0x5037e9(0x2cf)]};}async[a48_0x596974(0x2b0)](_0x1fd9e6){const _0xb50e55=a48_0x596974;await database_1[_0xb50e55(0x1cc)]['shop'][_0xb50e55(0x1fa)]({'where':{'id':_0x1fd9e6}});}[a48_0x596974(0x2f2)](_0x31d7c4,_0x46ece1,_0x31e45a){const _0x4e5705=a48_0x596974,_0x19f25d=new Map(),_0x386504=new Date(_0x46ece1);while(_0x386504<=_0x31e45a){const _0x3eca1c=_0x386504[_0x4e5705(0x2c1)]()[_0x4e5705(0x1fd)]('T')[0x0];_0x19f25d[_0x4e5705(0x2f1)](_0x3eca1c,{'revenue':0x0,'count':0x0}),_0x386504[_0x4e5705(0x261)](_0x386504[_0x4e5705(0x309)]()+0x1);}for(const _0x59d667 of _0x31d7c4){const _0x2d52eb=_0x59d667[_0x4e5705(0x2cf)][_0x4e5705(0x2c1)]()[_0x4e5705(0x1fd)]('T')[0x0],_0x46c7e6=_0x19f25d[_0x4e5705(0x2bb)](_0x2d52eb);_0x46c7e6&&(_0x46c7e6[_0x4e5705(0x288)]+=0x1,_0x59d667[_0x4e5705(0x316)]==='PAID'&&(_0x59d667[_0x4e5705(0x1cb)]?_0x46c7e6[_0x4e5705(0x260)]+=_0x59d667[_0x4e5705(0x1cb)]:console[_0x4e5705(0x2fe)](_0x4e5705(0x29b)+_0x59d667['id']+'\x20missing\x20amountUSDT,\x20using\x20fallback\x20conversion')));}const _0x1cbc77=[],_0x3c6980=[];for(const [_0x1a552b,_0x4cecbc]of _0x19f25d){_0x1cbc77[_0x4e5705(0x27c)]({'date':_0x1a552b,'amount':Math[_0x4e5705(0x1be)](_0x4cecbc[_0x4e5705(0x260)]*0x64)/0x64}),_0x3c6980[_0x4e5705(0x27c)]({'date':_0x1a552b,'count':_0x4cecbc[_0x4e5705(0x288)]});}return{'dailyRevenue':_0x1cbc77,'dailyPayments':_0x3c6980};}}function a48_0x3235(_0x125d24,_0xf4f320){_0x125d24=_0x125d24-0x1b0;const _0x36fc16=a48_0x36fc();let _0x32353c=_0x36fc16[_0x125d24];return _0x32353c;}exports[a48_0x596974(0x266)]=AdminService;