'use strict';const a38_0x46f384=a38_0x4383;(function(_0x80a1d5,_0x322846){const _0x15469f=a38_0x4383,_0x5a1ff1=_0x80a1d5();while(!![]){try{const _0x1daf78=parseInt(_0x15469f(0xdc))/0x1+-parseInt(_0x15469f(0xf3))/0x2*(parseInt(_0x15469f(0x6b))/0x3)+parseInt(_0x15469f(0xd6))/0x4+-parseInt(_0x15469f(0x199))/0x5*(-parseInt(_0x15469f(0x127))/0x6)+parseInt(_0x15469f(0x76))/0x7*(-parseInt(_0x15469f(0x180))/0x8)+parseInt(_0x15469f(0xa3))/0x9*(-parseInt(_0x15469f(0x14a))/0xa)+parseInt(_0x15469f(0x8d))/0xb;if(_0x1daf78===_0x322846)break;else _0x5a1ff1['push'](_0x5a1ff1['shift']());}catch(_0x44b8c5){_0x5a1ff1['push'](_0x5a1ff1['shift']());}}}(a38_0x3985,0xba571));var __importDefault=this&&this[a38_0x46f384(0x164)]||function(_0x292c5a){const _0x3850cd=a38_0x46f384;return _0x292c5a&&_0x292c5a[_0x3850cd(0x9d)]?_0x292c5a:{'default':_0x292c5a};};Object['defineProperty'](exports,'__esModule',{'value':!![]}),exports[a38_0x46f384(0x193)]=void 0x0;const database_1=__importDefault(require('../config/database')),bcryptjs_1=__importDefault(require(a38_0x46f384(0x190))),crypto_1=__importDefault(require('crypto')),currencyService_1=require('./currencyService'),gateway_1=require(a38_0x46f384(0xa7));function a38_0x4383(_0x3d9d95,_0x6647eb){const _0x3985da=a38_0x3985();return a38_0x4383=function(_0x4383d6,_0x3ba2dc){_0x4383d6=_0x4383d6-0x67;let _0x27b1c0=_0x3985da[_0x4383d6];return _0x27b1c0;},a38_0x4383(_0x3d9d95,_0x6647eb);}class AdminService{async[a38_0x46f384(0x115)](){const _0xf0f3ad=a38_0x46f384;console[_0xf0f3ad(0x197)]('📊\x20Calculating\x20payout\x20statistics...');const _0x1f9747=await database_1['default']['shop'][_0xf0f3ad(0xc7)]({'_sum':{'balance':!![],'totalPaidOut':!![]},'where':{'status':_0xf0f3ad(0xa0)}}),_0x8079bd=await database_1[_0xf0f3ad(0x19b)][_0xf0f3ad(0x13a)]['count']({'where':{'status':_0xf0f3ad(0x6a),'gateway':{'not':_0xf0f3ad(0xba)}}}),_0xaddf31=new Date(),_0x26a72c=new Date(_0xaddf31[_0xf0f3ad(0x8c)](),_0xaddf31[_0xf0f3ad(0x150)](),0x1),_0x2f2a0a=new Date(_0xaddf31[_0xf0f3ad(0x8c)](),_0xaddf31['getMonth']()+0x1,0x0,0x17,0x3b,0x3b,0x3e7),_0x551f4b=await database_1[_0xf0f3ad(0x19b)][_0xf0f3ad(0x83)]['aggregate']({'_sum':{'amount':!![]},'where':{'createdAt':{'gte':_0x26a72c,'lte':_0x2f2a0a},'status':'COMPLETED'}}),_0x3551d1=_0x1f9747[_0xf0f3ad(0xd1)][_0xf0f3ad(0x74)]||0x0,_0xbfdcc5=_0x1f9747[_0xf0f3ad(0xd1)][_0xf0f3ad(0xe6)]||0x0,_0x79c84c=_0x551f4b[_0xf0f3ad(0xd1)][_0xf0f3ad(0xd9)]||0x0,_0x3a5f83={'totalPayout':Math[_0xf0f3ad(0x102)](_0x3551d1*0x64)/0x64,'awaitingPayout':Math[_0xf0f3ad(0x102)](_0xbfdcc5*0x64)/0x64,'thisMonth':Math[_0xf0f3ad(0x102)](_0x79c84c*0x64)/0x64,'availableBalance':Math['round'](_0xbfdcc5*0x64)/0x64,'totalPayments':_0x8079bd};return console[_0xf0f3ad(0x197)](_0xf0f3ad(0x71)),console[_0xf0f3ad(0x197)](_0xf0f3ad(0x113)+_0x3a5f83[_0xf0f3ad(0x11f)]+_0xf0f3ad(0xb8)),console[_0xf0f3ad(0x197)]('\x20\x20\x20⏳\x20Awaiting\x20payout:\x20'+_0x3a5f83[_0xf0f3ad(0x157)]+_0xf0f3ad(0x186)),console[_0xf0f3ad(0x197)](_0xf0f3ad(0x6e)+_0x3a5f83[_0xf0f3ad(0x187)]+_0xf0f3ad(0x18c)),console[_0xf0f3ad(0x197)]('\x20\x20\x20📅\x20This\x20month:\x20'+_0x3a5f83[_0xf0f3ad(0xe7)]+_0xf0f3ad(0xea)),console[_0xf0f3ad(0x197)](_0xf0f3ad(0x1a0)+_0x3a5f83[_0xf0f3ad(0x14c)]+'\x20PAID\x20payments'),_0x3a5f83;}async['updateCustomerData'](_0x1a5f1e,_0x5debb5){const _0x1b851d=a38_0x46f384;console[_0x1b851d(0x197)](_0x1b851d(0xed)+_0x1a5f1e+':',_0x5debb5);const _0x4a4094=await database_1[_0x1b851d(0x19b)][_0x1b851d(0x13a)][_0x1b851d(0x12e)]({'where':{'id':_0x1a5f1e},'select':{'id':!![],'customerEmail':!![],'customerName':!![],'customerCountry':!![],'customerIp':!![],'customerUa':!![]}});if(!_0x4a4094)throw new Error(_0x1b851d(0x108));const _0x7f4cd4={};_0x5debb5['customerCountry']!==undefined&&(_0x7f4cd4[_0x1b851d(0xa8)]=_0x5debb5['customerCountry']||null);_0x5debb5['customerIp']!==undefined&&(_0x7f4cd4[_0x1b851d(0x9c)]=_0x5debb5[_0x1b851d(0x9c)]||null);_0x5debb5[_0x1b851d(0x10d)]!==undefined&&(_0x7f4cd4['customerUa']=_0x5debb5['customerUa']||null);const _0x5eb25a=await database_1[_0x1b851d(0x19b)][_0x1b851d(0x13a)]['update']({'where':{'id':_0x1a5f1e},'data':{..._0x7f4cd4,'updatedAt':new Date()},'select':{'id':!![],'customerEmail':!![],'customerName':!![],'customerCountry':!![],'customerIp':!![],'customerUa':!![],'updatedAt':!![]}});return console[_0x1b851d(0x197)](_0x1b851d(0x9e)+_0x1a5f1e),console[_0x1b851d(0x197)]('\x20\x20\x20🌍\x20Country:\x20'+_0x4a4094[_0x1b851d(0xa8)]+_0x1b851d(0xbf)+_0x5eb25a[_0x1b851d(0xa8)]),console['log'](_0x1b851d(0x9f)+_0x4a4094['customerIp']+_0x1b851d(0xbf)+_0x5eb25a[_0x1b851d(0x9c)]),console['log']('\x20\x20\x20🖥️\x20User\x20Agent:\x20'+(_0x4a4094[_0x1b851d(0x10d)]?_0x1b851d(0x1ab):_0x1b851d(0x15b))+_0x1b851d(0xbf)+(_0x5eb25a[_0x1b851d(0x10d)]?'set':_0x1b851d(0x15b))),_0x5eb25a;}async[a38_0x46f384(0x170)](_0x475916){const _0x4eb00b=a38_0x46f384,_0x28c96b=new Date();let _0x47226f;switch(_0x475916[_0x4eb00b(0x148)]()){case _0x4eb00b(0x77):_0x47226f=new Date(_0x28c96b[_0x4eb00b(0x8c)](),_0x28c96b[_0x4eb00b(0x150)](),_0x28c96b[_0x4eb00b(0xe9)](),0x0,0x0,0x0,0x0);break;case'yesterday':const _0x947c82=new Date(_0x28c96b);_0x947c82['setDate'](_0x947c82[_0x4eb00b(0xe9)]()-0x1),_0x47226f=new Date(_0x947c82[_0x4eb00b(0x8c)](),_0x947c82[_0x4eb00b(0x150)](),_0x947c82[_0x4eb00b(0xe9)](),0x0,0x0,0x0,0x0);break;case'7d':_0x47226f=new Date(_0x28c96b[_0x4eb00b(0x196)]()-0x7*0x18*0x3c*0x3c*0x3e8);break;case'30d':_0x47226f=new Date(_0x28c96b[_0x4eb00b(0x196)]()-0x1e*0x18*0x3c*0x3c*0x3e8);break;case'90d':_0x47226f=new Date(_0x28c96b[_0x4eb00b(0x196)]()-0x5a*0x18*0x3c*0x3c*0x3e8);break;case'all':const _0x4ff70b=await database_1[_0x4eb00b(0x19b)][_0x4eb00b(0x13a)][_0x4eb00b(0xf6)]({'where':{'gateway':{'not':'test_gateway'}},'orderBy':{'createdAt':'asc'},'select':{'createdAt':!![]}});_0x47226f=_0x4ff70b?_0x4ff70b[_0x4eb00b(0x13e)]:new Date(_0x4eb00b(0x131));break;default:_0x47226f=new Date(_0x28c96b[_0x4eb00b(0x196)]()-0x1e*0x18*0x3c*0x3c*0x3e8);}_0x47226f[_0x4eb00b(0x174)](0x0,0x0,0x0,0x0);let _0x2394e8;if(_0x475916[_0x4eb00b(0x148)]()===_0x4eb00b(0xaf)){const _0x422894=new Date(_0x28c96b);_0x422894[_0x4eb00b(0x105)](_0x422894['getDate']()-0x1),_0x2394e8=new Date(_0x422894['getFullYear'](),_0x422894[_0x4eb00b(0x150)](),_0x422894[_0x4eb00b(0xe9)](),0x17,0x3b,0x3b,0x3e7);}const _0x4150e4={'gte':_0x47226f};_0x2394e8&&(_0x4150e4[_0x4eb00b(0xfe)]=_0x2394e8);const [_0x5c3ccd,_0xf6179,_0x2a66e8,_0x531f92,_0x57bf78,_0xc0838c]=await Promise[_0x4eb00b(0x198)]([database_1[_0x4eb00b(0x19b)][_0x4eb00b(0x189)][_0x4eb00b(0x16c)](),database_1['default'][_0x4eb00b(0x189)][_0x4eb00b(0x16c)]({'where':{'status':_0x4eb00b(0xa0)}}),database_1[_0x4eb00b(0x19b)][_0x4eb00b(0x13a)][_0x4eb00b(0x16c)]({'where':{'status':'PAID','createdAt':_0x4150e4,'gateway':{'not':'test_gateway'}}}),database_1['default'][_0x4eb00b(0x13a)]['findMany']({'where':{'status':'PAID','createdAt':_0x4150e4,'gateway':{'not':'test_gateway'}},'select':{'amount':!![],'currency':!![],'amountAfterGatewayCommissionUSDT':!![]}}),database_1[_0x4eb00b(0x19b)]['payment']['findMany']({'where':{'gateway':{'not':'test_gateway'}},'take':0xa,'orderBy':{'createdAt':_0x4eb00b(0xb5)},'include':{'shop':{'select':{'name':!![],'username':!![]}}}}),database_1[_0x4eb00b(0x19b)][_0x4eb00b(0x13a)][_0x4eb00b(0x67)]({'where':{'createdAt':_0x4150e4,'gateway':{'not':_0x4eb00b(0xba)}},'select':{'amount':!![],'currency':!![],'status':!![],'amountUSDT':!![],'createdAt':!![]}})]);let _0x13de91=0x0,_0x39b95b=0x0;for(const _0x1d81e2 of _0x531f92){const _0x317719=await currencyService_1[_0x4eb00b(0xbd)][_0x4eb00b(0x6f)](_0x1d81e2[_0x4eb00b(0xd9)],_0x1d81e2[_0x4eb00b(0x6c)]);_0x13de91+=_0x317719;if(_0x1d81e2[_0x4eb00b(0x141)]){const _0x472a31=await currencyService_1['currencyService']['convertToUSDT'](_0x1d81e2['amount'],_0x1d81e2[_0x4eb00b(0x6c)]),_0x18d38a=_0x1d81e2['amountAfterGatewayCommissionUSDT'],_0x203439=_0x472a31-_0x18d38a;_0x39b95b+=_0x203439;}}const _0xc92da6=_0x2a66e8>0x0?_0x13de91/_0x2a66e8:0x0,_0x215ea4=this['generateDailyStatistics'](_0xc0838c,_0x47226f,_0x2394e8||_0x28c96b),_0x56f740=await database_1[_0x4eb00b(0x19b)][_0x4eb00b(0x13a)][_0x4eb00b(0x16c)]({'where':{'createdAt':_0x4150e4,'gateway':{'not':_0x4eb00b(0xba)}}}),_0x4a6def=_0x56f740>0x0?_0x2a66e8/_0x56f740*0x64:0x0;return{'totalShops':_0x5c3ccd,'activeShops':_0xf6179,'totalPayments':_0x2a66e8,'successfulPayments':_0x2a66e8,'totalAttempts':_0x56f740,'totalRevenue':Math['round'](_0x13de91*0x64)/0x64,'trapayEarnings':Math[_0x4eb00b(0x102)](_0x39b95b*0x64)/0x64,'averagePaymentAmount':Math[_0x4eb00b(0x102)](_0xc92da6*0x64)/0x64,'conversionRate':Math[_0x4eb00b(0x102)](_0x4a6def*0x64)/0x64,'dailyRevenue':_0x215ea4[_0x4eb00b(0x130)],'dailyPayments':_0x215ea4[_0x4eb00b(0xca)],'recentPayments':_0x57bf78[_0x4eb00b(0x82)](_0x2d2a65=>({'id':_0x2d2a65['id'],'amount':_0x2d2a65[_0x4eb00b(0xd9)],'currency':_0x2d2a65[_0x4eb00b(0x6c)],'status':_0x2d2a65[_0x4eb00b(0xe0)],'gateway':_0x2d2a65[_0x4eb00b(0x1a5)],'shop':_0x2d2a65[_0x4eb00b(0x189)],'createdAt':_0x2d2a65['createdAt']}))};}async['getMerchantStatistics'](_0x192466){const _0x5b33f0=a38_0x46f384;console[_0x5b33f0(0x197)](_0x5b33f0(0xa6),_0x192466);let _0x4d1179,_0x543003=new Date();if(_0x192466['period']==='custom'&&_0x192466[_0x5b33f0(0x10a)]&&_0x192466['dateTo'])_0x4d1179=new Date(_0x192466['dateFrom']),_0x543003=new Date(_0x192466[_0x5b33f0(0x173)]),_0x4d1179[_0x5b33f0(0x174)](0x0,0x0,0x0,0x0),_0x543003['setHours'](0x17,0x3b,0x3b,0x3e7);else{const _0x397777=new Date();switch(_0x192466[_0x5b33f0(0x1a7)]){case _0x5b33f0(0x145):_0x4d1179=new Date(_0x397777['getTime']()-0x7*0x18*0x3c*0x3c*0x3e8);break;case _0x5b33f0(0x138):_0x4d1179=new Date(_0x397777[_0x5b33f0(0x196)]()-0x1e*0x18*0x3c*0x3c*0x3e8);break;case'year':_0x4d1179=new Date(_0x397777[_0x5b33f0(0x196)]()-0x16d*0x18*0x3c*0x3c*0x3e8);break;case _0x5b33f0(0x198):default:_0x4d1179=new Date(_0x5b33f0(0x131));break;}_0x4d1179[_0x5b33f0(0x174)](0x0,0x0,0x0,0x0),_0x543003['setHours'](0x17,0x3b,0x3b,0x3e7);}console[_0x5b33f0(0x197)](_0x5b33f0(0xf2)+_0x4d1179['toISOString']()+'\x20to\x20'+_0x543003[_0x5b33f0(0x84)]());const _0x26f925={'status':_0x5b33f0(0x6a),'gateway':{'not':'test_gateway'},'paidAt':{'gte':_0x4d1179,'lte':_0x543003}};_0x192466[_0x5b33f0(0xcd)]&&(_0x26f925[_0x5b33f0(0xcd)]=_0x192466[_0x5b33f0(0xcd)]);const _0x6af75b=await database_1[_0x5b33f0(0x19b)]['payment'][_0x5b33f0(0x67)]({'where':_0x26f925,'select':{'id':!![],'amount':!![],'currency':!![],'amountUSDT':!![],'amountAfterGatewayCommissionUSDT':!![],'gatewayCommissionRate':!![],'gateway':!![],'shopId':!![],'paidAt':!![],'shop':{'select':{'id':!![],'name':!![],'username':!![],'gatewaySettings':!![]}}}});console[_0x5b33f0(0x197)]('💰\x20Found\x20'+_0x6af75b[_0x5b33f0(0xf0)]+_0x5b33f0(0x162));const _0x362783={'gateway':{'not':_0x5b33f0(0xba)},'createdAt':{'gte':_0x4d1179,'lte':_0x543003}};_0x192466[_0x5b33f0(0xcd)]&&(_0x362783[_0x5b33f0(0xcd)]=_0x192466[_0x5b33f0(0xcd)]);const _0x57e061=await database_1[_0x5b33f0(0x19b)][_0x5b33f0(0x13a)][_0x5b33f0(0x16c)]({'where':_0x362783});console[_0x5b33f0(0x197)](_0x5b33f0(0xd5)+_0x57e061+_0x5b33f0(0x80)+_0x6af75b[_0x5b33f0(0xf0)]);let _0x14e4d8=0x0,_0x53365d=0x0,_0x1a6630=0x0;const _0x5a3cbc={},_0x30c106={},_0x462ccc={};for(const _0x45adf6 of _0x6af75b){try{const _0x8e7033=_0x45adf6[_0x5b33f0(0x124)]||0x0;if(_0x8e7033<=0x0){console[_0x5b33f0(0x134)](_0x5b33f0(0x14b)+_0x45adf6['id']+_0x5b33f0(0x101));continue;}let _0x52d7e5,_0x1005b7;if(_0x45adf6[_0x5b33f0(0x141)]!==null&&_0x45adf6[_0x5b33f0(0x141)]!==undefined)_0x52d7e5=_0x45adf6[_0x5b33f0(0x141)],_0x1005b7=_0x8e7033-_0x52d7e5,console['log'](_0x5b33f0(0x13b)+_0x45adf6['id']+':\x20'+_0x8e7033[_0x5b33f0(0xd3)](0x6)+_0x5b33f0(0x92)+_0x52d7e5[_0x5b33f0(0xd3)](0x6)+_0x5b33f0(0xea));else{let _0x51b30b={};if(_0x45adf6[_0x5b33f0(0x189)]['gatewaySettings'])try{_0x51b30b=JSON[_0x5b33f0(0xb1)](_0x45adf6[_0x5b33f0(0x189)][_0x5b33f0(0x96)]);}catch(_0x1769bf){console['error'](_0x5b33f0(0x171)+_0x45adf6[_0x5b33f0(0xcd)]+':',_0x1769bf);}let _0x51e20b=0x2d;for(const [_0x409714,_0x40b254]of Object[_0x5b33f0(0x166)](_0x51b30b)){if(_0x409714['toLowerCase']()===_0x45adf6['gateway'][_0x5b33f0(0x148)]()){_0x51e20b=_0x40b254['commission']||0x2d;break;}}_0x1005b7=_0x8e7033*(_0x51e20b/0x64),_0x52d7e5=_0x8e7033-_0x1005b7,console[_0x5b33f0(0x197)](_0x5b33f0(0x146)+_0x45adf6['id']+':\x20'+_0x51e20b+_0x5b33f0(0x89)+_0x8e7033[_0x5b33f0(0xd3)](0x6)+_0x5b33f0(0xea));}_0x14e4d8+=_0x8e7033,_0x53365d+=_0x52d7e5,_0x1a6630+=_0x1005b7;let _0x54719a;_0x45adf6[_0x5b33f0(0x1a4)]!==null&&_0x45adf6[_0x5b33f0(0x1a4)]!==undefined?(_0x54719a=_0x45adf6[_0x5b33f0(0x1a4)],console[_0x5b33f0(0x197)]('📊\x20Using\x20saved\x20commission\x20rate\x20for\x20payment\x20'+_0x45adf6['id']+':\x20'+_0x54719a+'%')):(_0x54719a=_0x8e7033>0x0?_0x1005b7/_0x8e7033*0x64:0x0,console[_0x5b33f0(0x197)]('📊\x20Calculated\x20commission\x20rate\x20for\x20payment\x20'+_0x45adf6['id']+':\x20'+_0x54719a['toFixed'](0x2)+'%'));!_0x5a3cbc[_0x45adf6['gateway']]&&(_0x5a3cbc[_0x45adf6[_0x5b33f0(0x1a5)]]={'gateway':_0x45adf6['gateway'],'gatewayDisplayName':this[_0x5b33f0(0x177)](_0x45adf6['gateway']),'paymentsCount':0x0,'turnoverUSDT':0x0,'commissionUSDT':0x0,'merchantEarningsUSDT':0x0,'totalCommissionRate':0x0});_0x5a3cbc[_0x45adf6['gateway']]['paymentsCount']++,_0x5a3cbc[_0x45adf6[_0x5b33f0(0x1a5)]]['turnoverUSDT']+=_0x8e7033,_0x5a3cbc[_0x45adf6[_0x5b33f0(0x1a5)]][_0x5b33f0(0x107)]+=_0x1005b7,_0x5a3cbc[_0x45adf6[_0x5b33f0(0x1a5)]][_0x5b33f0(0xab)]+=_0x52d7e5,_0x5a3cbc[_0x45adf6[_0x5b33f0(0x1a5)]][_0x5b33f0(0xfc)]+=_0x54719a;!_0x192466[_0x5b33f0(0xcd)]&&(!_0x30c106[_0x45adf6[_0x5b33f0(0xcd)]]&&(_0x30c106[_0x45adf6[_0x5b33f0(0xcd)]]={'shopId':_0x45adf6['shopId'],'shopName':_0x45adf6[_0x5b33f0(0x189)][_0x5b33f0(0x73)],'shopUsername':_0x45adf6[_0x5b33f0(0x189)][_0x5b33f0(0x15d)],'paymentsCount':0x0,'turnoverUSDT':0x0,'commissionUSDT':0x0,'merchantEarningsUSDT':0x0,'paidOutUSDT':0x0,'averageCheckUSDT':0x0}),_0x30c106[_0x45adf6[_0x5b33f0(0xcd)]]['paymentsCount']++,_0x30c106[_0x45adf6[_0x5b33f0(0xcd)]][_0x5b33f0(0xee)]+=_0x8e7033,_0x30c106[_0x45adf6[_0x5b33f0(0xcd)]]['commissionUSDT']+=_0x1005b7,_0x30c106[_0x45adf6['shopId']][_0x5b33f0(0xab)]+=_0x52d7e5);const _0x11a893=_0x45adf6[_0x5b33f0(0x79)][_0x5b33f0(0x84)]()['split']('T')[0x0];!_0x462ccc[_0x11a893]&&(_0x462ccc[_0x11a893]={'date':_0x11a893,'turnover':0x0,'merchantEarnings':0x0,'gatewayEarnings':0x0,'paymentsCount':0x0}),_0x462ccc[_0x11a893][_0x5b33f0(0x85)]+=_0x8e7033,_0x462ccc[_0x11a893]['merchantEarnings']+=_0x52d7e5,_0x462ccc[_0x11a893][_0x5b33f0(0xd8)]+=_0x1005b7,_0x462ccc[_0x11a893][_0x5b33f0(0x1a1)]++;}catch(_0xcc78ee){console[_0x5b33f0(0x169)](_0x5b33f0(0x142)+_0x45adf6['id']+':',_0xcc78ee);}}Object[_0x5b33f0(0xef)](_0x5a3cbc)[_0x5b33f0(0xce)](_0x4e4d69=>{const _0x3b3f78=_0x5b33f0;_0x4e4d69[_0x3b3f78(0xa2)]=_0x4e4d69[_0x3b3f78(0x1a1)]>0x0?_0x4e4d69[_0x3b3f78(0xfc)]/_0x4e4d69[_0x3b3f78(0x1a1)]:0x0,delete _0x4e4d69[_0x3b3f78(0xfc)];}),Object[_0x5b33f0(0xef)](_0x30c106)[_0x5b33f0(0xce)](_0x1c4151=>{const _0x3817b4=_0x5b33f0;_0x1c4151[_0x3817b4(0xec)]=_0x1c4151[_0x3817b4(0x1a1)]>0x0?_0x1c4151[_0x3817b4(0xee)]/_0x1c4151[_0x3817b4(0x1a1)]:0x0;});let _0x238c95=0x0,_0xcccb3=0x0;if(_0x192466[_0x5b33f0(0xcd)]){const _0x5bf71c=await database_1['default']['payout'][_0x5b33f0(0x67)]({'where':{'shopId':_0x192466[_0x5b33f0(0xcd)],'status':_0x5b33f0(0xe1),'createdAt':{'gte':_0x4d1179,'lte':_0x543003}},'select':{'amount':!![]}});_0x238c95=_0x5bf71c[_0x5b33f0(0xc0)]((_0x3a7ae2,_0x10a868)=>_0x3a7ae2+_0x10a868[_0x5b33f0(0xd9)],0x0);const _0x20d635=await database_1[_0x5b33f0(0x19b)][_0x5b33f0(0x83)]['findMany']({'where':{'shopId':_0x192466[_0x5b33f0(0xcd)],'status':'PENDING','createdAt':{'gte':_0x4d1179,'lte':_0x543003}},'select':{'amount':!![]}});_0xcccb3=_0x20d635[_0x5b33f0(0xc0)]((_0x358c42,_0x20c10e)=>_0x358c42+_0x20c10e[_0x5b33f0(0xd9)],0x0);}const _0x5b856c=_0x57e061,_0x2140d0=_0x6af75b[_0x5b33f0(0xf0)],_0xbe33d=_0x2140d0>0x0?_0x14e4d8/_0x2140d0:0x0,_0x4fdbbc=_0x5b856c>0x0?Math[_0x5b33f0(0x102)](_0x2140d0/_0x5b856c*0x2710)/0x64:0x0,_0x157d48=Math[_0x5b33f0(0x123)]((_0x543003[_0x5b33f0(0x196)]()-_0x4d1179['getTime']())/(0x3e8*0x3c*0x3c*0x18)),_0x4d95a3={'totalTurnover':Math[_0x5b33f0(0x102)](_0x14e4d8*0x64)/0x64,'merchantEarnings':Math[_0x5b33f0(0x102)](_0x53365d*0x64)/0x64,'gatewayEarnings':Math[_0x5b33f0(0x102)](_0x1a6630*0x64)/0x64,'totalPaidOut':Math[_0x5b33f0(0x102)](_0x238c95*0x64)/0x64,'pendingPayout':Math[_0x5b33f0(0x102)](_0xcccb3*0x64)/0x64,'averageCheck':Math['round'](_0xbe33d*0x64)/0x64,'totalPayments':_0x5b856c,'successfulPayments':_0x2140d0,'conversionRate':_0x4fdbbc,'gatewayBreakdown':Object[_0x5b33f0(0xef)](_0x5a3cbc)[_0x5b33f0(0x82)](_0x29e1d1=>({..._0x29e1d1,'turnoverUSDT':Math[_0x5b33f0(0x102)](_0x29e1d1[_0x5b33f0(0xee)]*0x64)/0x64,'commissionUSDT':Math[_0x5b33f0(0x102)](_0x29e1d1[_0x5b33f0(0x107)]*0x64)/0x64,'merchantEarningsUSDT':Math[_0x5b33f0(0x102)](_0x29e1d1[_0x5b33f0(0xab)]*0x64)/0x64,'averageCommissionRate':Math[_0x5b33f0(0x102)](_0x29e1d1[_0x5b33f0(0xa2)]*0x64)/0x64})),'merchantBreakdown':_0x192466[_0x5b33f0(0xcd)]?undefined:Object[_0x5b33f0(0xef)](_0x30c106)[_0x5b33f0(0x82)](_0x19411a=>({..._0x19411a,'turnoverUSDT':Math[_0x5b33f0(0x102)](_0x19411a['turnoverUSDT']*0x64)/0x64,'commissionUSDT':Math[_0x5b33f0(0x102)](_0x19411a[_0x5b33f0(0x107)]*0x64)/0x64,'merchantEarningsUSDT':Math[_0x5b33f0(0x102)](_0x19411a[_0x5b33f0(0xab)]*0x64)/0x64,'paidOutUSDT':Math[_0x5b33f0(0x102)](_0x19411a['paidOutUSDT']*0x64)/0x64,'averageCheckUSDT':Math[_0x5b33f0(0x102)](_0x19411a[_0x5b33f0(0xec)]*0x64)/0x64})),'dailyData':Object[_0x5b33f0(0xef)](_0x462ccc)[_0x5b33f0(0x82)](_0x56890e=>({..._0x56890e,'turnover':Math[_0x5b33f0(0x102)](_0x56890e[_0x5b33f0(0x85)]*0x64)/0x64,'merchantEarnings':Math[_0x5b33f0(0x102)](_0x56890e['merchantEarnings']*0x64)/0x64,'gatewayEarnings':Math[_0x5b33f0(0x102)](_0x56890e[_0x5b33f0(0xd8)]*0x64)/0x64}))[_0x5b33f0(0x13d)]((_0x3fadb8,_0x453bd5)=>_0x3fadb8[_0x5b33f0(0x16a)][_0x5b33f0(0x14f)](_0x453bd5[_0x5b33f0(0x16a)])),'periodInfo':{'from':_0x4d1179,'to':_0x543003,'periodType':_0x192466[_0x5b33f0(0x1a7)]||_0x5b33f0(0x195),'daysCount':_0x157d48}};return console['log']('📊\x20Merchant\x20statistics\x20calculated:'),console[_0x5b33f0(0x197)](_0x5b33f0(0xda)+_0x4d95a3['totalTurnover']+_0x5b33f0(0xea)),console[_0x5b33f0(0x197)](_0x5b33f0(0x17f)+_0x4d95a3[_0x5b33f0(0x17b)]+_0x5b33f0(0xea)),console['log'](_0x5b33f0(0x99)+_0x4d95a3[_0x5b33f0(0xd8)]+_0x5b33f0(0xea)),console[_0x5b33f0(0x197)](_0x5b33f0(0xcf)+_0x4d95a3[_0x5b33f0(0x74)]+_0x5b33f0(0xea)),console[_0x5b33f0(0x197)](_0x5b33f0(0x19a)+_0x4d95a3[_0x5b33f0(0xd0)]+_0x5b33f0(0xea)),console['log'](_0x5b33f0(0x129)+_0x4d95a3[_0x5b33f0(0x14c)]),_0x4d95a3;}async['getMerchantsSelection'](){const _0x14d9a1=a38_0x46f384;console[_0x14d9a1(0x197)](_0x14d9a1(0x17a));const _0x3de6c8=await database_1[_0x14d9a1(0x19b)][_0x14d9a1(0x189)][_0x14d9a1(0x67)]({'where':{'status':_0x14d9a1(0xa0)},'select':{'id':!![],'username':!![],'name':!![]},'orderBy':{'name':'asc'}});return console[_0x14d9a1(0x197)](_0x14d9a1(0x111)+_0x3de6c8[_0x14d9a1(0xf0)]+'\x20active\x20merchants\x20for\x20selection'),_0x3de6c8[_0x14d9a1(0x82)](_0xb93125=>({'id':_0xb93125['id'],'username':_0xb93125[_0x14d9a1(0x15d)],'name':_0xb93125[_0x14d9a1(0x73)]}));}[a38_0x46f384(0x177)](_0x14535c){const _0x5351d7=a38_0x46f384,_0x19bea3={'test_gateway':_0x5351d7(0x116),'plisio':'Plisio','rapyd':_0x5351d7(0x87),'noda':_0x5351d7(0x144),'cointopay':_0x5351d7(0x1a8),'cointopay2':_0x5351d7(0x15a),'klyme_eu':_0x5351d7(0x104),'klyme_gb':'KLYME\x20GB','klyme_de':_0x5351d7(0xff),'mastercard':_0x5351d7(0xc4)};return _0x19bea3[_0x14535c]||_0x14535c;}[a38_0x46f384(0xdb)](_0x1277d6){const _0x5f37e7=a38_0x46f384,_0x121260={'Test\x20Gateway':_0x5f37e7(0xba),'Plisio':_0x5f37e7(0xb2),'Rapyd':_0x5f37e7(0xeb),'Noda':_0x5f37e7(0x143),'CoinToPay':_0x5f37e7(0x81),'CoinToPay2':'cointopay2','KLYME\x20EU':_0x5f37e7(0xb0),'KLYME\x20GB':'klyme_gb','KLYME\x20DE':_0x5f37e7(0x152),'MasterCard':_0x5f37e7(0x98)};return _0x121260[_0x1277d6]||_0x1277d6[_0x5f37e7(0x148)]();}async[a38_0x46f384(0x18b)](_0x12890d){const _0x2f7ca1=a38_0x46f384,{page:_0x5dd41e,limit:_0x52323f,minAmount:_0x25e96c,search:_0x30dfe8}=_0x12890d,_0x321241=(_0x5dd41e-0x1)*_0x52323f;console[_0x2f7ca1(0x197)](_0x2f7ca1(0x97),_0x12890d);const _0x407240={'balance':{'gt':0x0},'status':_0x2f7ca1(0xa0)};_0x25e96c&&(_0x407240[_0x2f7ca1(0xe6)][_0x2f7ca1(0x188)]=_0x25e96c);_0x30dfe8&&(_0x407240[_0x2f7ca1(0x73)]={'contains':_0x30dfe8,'mode':_0x2f7ca1(0x165)});const [_0x3818dc,_0x1ed545]=await Promise[_0x2f7ca1(0x198)]([database_1[_0x2f7ca1(0x19b)]['shop'][_0x2f7ca1(0x67)]({'where':_0x407240,'skip':_0x321241,'take':_0x52323f,'orderBy':{'balance':_0x2f7ca1(0xb5)},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'balance':!![],'totalPaidOut':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'gatewaySettings':!![],'createdAt':!![]}}),database_1['default'][_0x2f7ca1(0x189)]['count']({'where':_0x407240})]);console[_0x2f7ca1(0x197)](_0x2f7ca1(0x137)+_0x3818dc[_0x2f7ca1(0xf0)]+_0x2f7ca1(0x16b));const _0x3fa587=await Promise['all'](_0x3818dc[_0x2f7ca1(0x82)](async _0x4f768d=>{const _0x4a5552=_0x2f7ca1,[_0x4b641e,_0x2b3c93,_0xe002d1]=await Promise[_0x4a5552(0x198)]([database_1['default'][_0x4a5552(0x13a)][_0x4a5552(0x16c)]({'where':{'shopId':_0x4f768d['id'],'status':_0x4a5552(0x6a),'gateway':{'not':_0x4a5552(0xba)}}}),database_1[_0x4a5552(0x19b)][_0x4a5552(0x13a)][_0x4a5552(0xf6)]({'where':{'shopId':_0x4f768d['id'],'status':_0x4a5552(0x6a),'gateway':{'not':_0x4a5552(0xba)}},'orderBy':{'paidAt':_0x4a5552(0x139)},'select':{'paidAt':!![]}}),database_1[_0x4a5552(0x19b)][_0x4a5552(0x13a)]['groupBy']({'by':[_0x4a5552(0x1a5)],'where':{'shopId':_0x4f768d['id'],'status':_0x4a5552(0x6a),'gateway':{'not':'test_gateway'}},'_count':{'id':!![]},'_sum':{'amountUSDT':!![]}})]),_0x4ca30f=new Date(),_0x30de9b=new Date(_0x4ca30f[_0x4a5552(0x8c)](),_0x4ca30f[_0x4a5552(0x150)](),0x1),_0x2f6ab8=new Date(_0x4ca30f['getFullYear'](),_0x4ca30f['getMonth']()+0x1,0x0,0x17,0x3b,0x3b,0x3e7),[_0x14b9ea,_0x3d097b]=await Promise['all']([database_1[_0x4a5552(0x19b)][_0x4a5552(0x83)][_0x4a5552(0xc7)]({'_sum':{'amount':!![]},'where':{'shopId':_0x4f768d['id'],'status':'COMPLETED'}}),database_1['default'][_0x4a5552(0x83)][_0x4a5552(0xc7)]({'_sum':{'amount':!![]},'where':{'shopId':_0x4f768d['id'],'status':_0x4a5552(0xe1),'createdAt':{'gte':_0x30de9b,'lte':_0x2f6ab8}}})]),_0x6abc5f=_0x14b9ea[_0x4a5552(0xd1)]['amount']||0x0,_0x3e068d=_0x3d097b[_0x4a5552(0xd1)][_0x4a5552(0xd9)]||0x0,_0x135a9e=await Promise[_0x4a5552(0x198)](_0xe002d1['map'](async _0x2c2491=>{const _0x11005c=_0x4a5552;let _0xf53d24=0x2d;if(_0x4f768d[_0x11005c(0x96)])try{const _0x10b08c=JSON[_0x11005c(0xb1)](_0x4f768d[_0x11005c(0x96)]);for(const [_0x2bbba5,_0xdd508f]of Object['entries'](_0x10b08c)){if(_0x2bbba5['toLowerCase']()===_0x2c2491[_0x11005c(0x1a5)][_0x11005c(0x148)]()){_0xf53d24=_0xdd508f[_0x11005c(0x16e)]||0xa,console[_0x11005c(0x197)](_0x11005c(0xa4)+_0x2c2491[_0x11005c(0x1a5)]+_0x11005c(0x184)+_0x4f768d['id']+_0x11005c(0x7c)+_0xf53d24+'%');break;}}}catch(_0x3f58bb){console[_0x11005c(0x169)]('Error\x20parsing\x20gateway\x20settings\x20for\x20shop\x20'+_0x4f768d['id']+':',_0x3f58bb);}const _0x49c8b9=_0x2c2491[_0x11005c(0xd1)]?.[_0x11005c(0x124)]||0x0,_0x137423=_0x49c8b9*(0x1-_0xf53d24/0x64);return{'gateway':_0x2c2491[_0x11005c(0x1a5)],'count':_0x2c2491[_0x11005c(0x161)]?.['id']||0x0,'amountUSDT':Math['round'](_0x49c8b9*0x64)/0x64,'amountAfterCommissionUSDT':Math[_0x11005c(0x102)](_0x137423*0x64)/0x64,'commission':_0xf53d24};})),_0xb30155=_0x135a9e['reduce']((_0x269103,_0x4921fe)=>_0x269103+_0x4921fe[_0x4a5552(0x124)],0x0),_0x3f5271=_0x135a9e[_0x4a5552(0xc0)]((_0x93f254,_0x160bc1)=>_0x93f254+_0x160bc1[_0x4a5552(0xe2)],0x0),_0x29f723=_0x4f768d[_0x4a5552(0xe6)];return console[_0x4a5552(0x197)](_0x4a5552(0xb4)+_0x4f768d[_0x4a5552(0x15d)]+':'),console[_0x4a5552(0x197)](_0x4a5552(0x151)+_0xb30155['toFixed'](0x2)+_0x4a5552(0xbb)),console['log'](_0x4a5552(0xc2)+_0x3f5271[_0x4a5552(0xd3)](0x2)+_0x4a5552(0x13c)),console['log'](_0x4a5552(0x7b)+_0x29f723[_0x4a5552(0xd3)](0x2)+'\x20USDT\x20(current\x20balance\x20in\x20DB)'),console['log']('\x20\x20\x20💸\x20Total\x20payouts:\x20'+_0x6abc5f[_0x4a5552(0xd3)](0x2)+_0x4a5552(0x17c)),console[_0x4a5552(0x197)](_0x4a5552(0xe5)+(_0x3f5271-_0x6abc5f-_0x29f723)[_0x4a5552(0xd3)](0x2)+_0x4a5552(0x172)),{'id':_0x4f768d['id'],'fullName':_0x4f768d[_0x4a5552(0x73)],'username':_0x4f768d['username'],'telegramId':_0x4f768d[_0x4a5552(0x94)],'merchantUrl':_0x4f768d[_0x4a5552(0x69)],'wallets':{'usdtPolygonWallet':_0x4f768d[_0x4a5552(0x17d)],'usdtTrcWallet':_0x4f768d['usdtTrcWallet'],'usdtErcWallet':_0x4f768d[_0x4a5552(0x1a3)],'usdcPolygonWallet':_0x4f768d[_0x4a5552(0xf8)]},'totalAmountUSDT':Math[_0x4a5552(0x102)](_0xb30155*0x64)/0x64,'totalAmountAfterCommissionUSDT':Math['round'](_0x3f5271*0x64)/0x64,'currentBalance':Math[_0x4a5552(0x102)](_0x29f723*0x64)/0x64,'totalPayout':Math[_0x4a5552(0x102)](_0x6abc5f*0x64)/0x64,'thisMonth':Math[_0x4a5552(0x102)](_0x3e068d*0x64)/0x64,'paymentsCount':_0x4b641e,'oldestPaymentDate':_0x2b3c93?.['paidAt']||_0x4f768d[_0x4a5552(0x13e)],'gatewayBreakdown':_0x135a9e};})),_0x5d17a3=_0x3fa587[_0x2f7ca1(0xc0)]((_0xfeedda,_0x1f071b)=>_0xfeedda+_0x1f071b[_0x2f7ca1(0x7f)],0x0),_0x289e32=_0x3fa587[_0x2f7ca1(0xc0)]((_0x9ea1cb,_0x66ca09)=>_0x9ea1cb+_0x66ca09['totalAmountAfterCommissionUSDT'],0x0),_0xb534f4=_0x3fa587[_0x2f7ca1(0xc0)]((_0x1f64f1,_0x4edcb2)=>_0x1f64f1+_0x4edcb2[_0x2f7ca1(0x11f)],0x0),_0x50b5e5=_0x3fa587[_0x2f7ca1(0xc0)]((_0xa03a58,_0x21044b)=>_0xa03a58+_0x21044b['thisMonth'],0x0);return console['log']('📊\x20Merchants\x20awaiting\x20payout:\x20'+_0x1ed545+_0x2f7ca1(0x140)),console[_0x2f7ca1(0x197)]('\x20\x20\x20💰\x20Total\x20payments\x20turnover:\x20'+Math['round'](_0x5d17a3*0x64)/0x64+_0x2f7ca1(0xbb)),console[_0x2f7ca1(0x197)](_0x2f7ca1(0xf4)+Math[_0x2f7ca1(0x102)](_0x289e32*0x64)/0x64+_0x2f7ca1(0x192)),console[_0x2f7ca1(0x197)](_0x2f7ca1(0x18a)+Math[_0x2f7ca1(0x102)](_0xb534f4*0x64)/0x64+'\x20USDT'),console[_0x2f7ca1(0x197)]('\x20\x20\x20📅\x20Total\x20payouts\x20(this\x20month):\x20'+Math[_0x2f7ca1(0x102)](_0x50b5e5*0x64)/0x64+_0x2f7ca1(0xea)),{'merchants':_0x3fa587,'pagination':{'page':_0x5dd41e,'limit':_0x52323f,'total':_0x1ed545,'totalPages':Math[_0x2f7ca1(0x123)](_0x1ed545/_0x52323f)},'summary':{'totalMerchants':_0x1ed545,'totalAmountUSDT':Math[_0x2f7ca1(0x102)](_0x5d17a3*0x64)/0x64,'totalAmountAfterCommissionUSDT':Math[_0x2f7ca1(0x102)](_0x289e32*0x64)/0x64,'totalPayout':Math[_0x2f7ca1(0x102)](_0xb534f4*0x64)/0x64,'thisMonth':Math[_0x2f7ca1(0x102)](_0x50b5e5*0x64)/0x64}};}async['createPayout'](_0x3a6202){const _0x417de4=a38_0x46f384,{shopId:_0x3fd40b,amount:_0x500cd8,network:_0x184f52,wallet:_0x241781,notes:_0x45f272,txid:_0x218db8,periodFrom:_0x28abe3,periodTo:_0x56e96f}=_0x3a6202,_0x47f1e0=await database_1['default'][_0x417de4(0x179)](async _0x20d0da=>{const _0x1fec6f=_0x417de4,_0x247ad7=await _0x20d0da[_0x1fec6f(0x189)][_0x1fec6f(0x12e)]({'where':{'id':_0x3fd40b},'select':{'id':!![],'name':!![],'username':!![],'balance':!![],'totalPaidOut':!![]}});if(!_0x247ad7)throw new Error('Shop\x20not\x20found');console['log'](_0x1fec6f(0x14d)+_0x247ad7[_0x1fec6f(0x15d)]+':'),console[_0x1fec6f(0x197)](_0x1fec6f(0x158)+_0x247ad7[_0x1fec6f(0xe6)][_0x1fec6f(0xd3)](0x6)+_0x1fec6f(0xea)),console['log']('\x20\x20\x20Payout\x20amount:\x20'+_0x500cd8[_0x1fec6f(0xd3)](0x6)+_0x1fec6f(0xea)),console['log']('\x20\x20\x20Current\x20total\x20paid\x20out:\x20'+_0x247ad7[_0x1fec6f(0x74)]['toFixed'](0x6)+_0x1fec6f(0xea));if(_0x218db8)console[_0x1fec6f(0x197)](_0x1fec6f(0x168)+_0x218db8);if(_0x247ad7[_0x1fec6f(0xe6)]<_0x500cd8)throw new Error('Insufficient\x20balance.\x20Available:\x20'+_0x247ad7[_0x1fec6f(0xe6)][_0x1fec6f(0xd3)](0x6)+_0x1fec6f(0xfa)+_0x500cd8[_0x1fec6f(0xd3)](0x6)+'\x20USDT');let _0x4abcdf=_0x241781;if(!_0x4abcdf){const _0x45600c=await _0x20d0da[_0x1fec6f(0x189)][_0x1fec6f(0x12e)]({'where':{'id':_0x3fd40b},'select':{'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![]}});if(_0x45600c)switch(_0x184f52){case _0x1fec6f(0x176):_0x4abcdf=_0x45600c['usdtPolygonWallet']||undefined;break;case _0x1fec6f(0x122):_0x4abcdf=_0x45600c['usdtTrcWallet']||undefined;break;case'erc20':_0x4abcdf=_0x45600c[_0x1fec6f(0x1a3)]||undefined;break;case _0x1fec6f(0xc1):_0x4abcdf=_0x45600c[_0x1fec6f(0xf8)]||undefined;break;}}console[_0x1fec6f(0x197)]('💳\x20Payout\x20wallet\x20for\x20'+_0x184f52+':\x20'+(_0x4abcdf||_0x1fec6f(0x8e)));const _0x3cd5ca=await _0x20d0da[_0x1fec6f(0x83)]['create']({'data':{'shopId':_0x3fd40b,'amount':_0x500cd8,'network':_0x184f52,'status':_0x1fec6f(0xe1),'txid':_0x218db8,'notes':_0x45f272,'periodFrom':_0x28abe3?new Date(_0x28abe3):null,'periodTo':_0x56e96f?new Date(_0x56e96f):null,'createdAt':new Date(),'paidAt':new Date()}}),_0x463853=_0x247ad7['balance']-_0x500cd8,_0x275895=_0x247ad7[_0x1fec6f(0x74)]+_0x500cd8;return await _0x20d0da[_0x1fec6f(0x189)][_0x1fec6f(0xcc)]({'where':{'id':_0x3fd40b},'data':{'balance':_0x463853,'totalPaidOut':_0x275895}}),console[_0x1fec6f(0x197)](_0x1fec6f(0x7a)+_0x247ad7['username']+_0x1fec6f(0x9a)),console[_0x1fec6f(0x197)](_0x1fec6f(0x163)+_0x247ad7['balance'][_0x1fec6f(0xd3)](0x6)+_0x1fec6f(0xbf)+_0x463853[_0x1fec6f(0xd3)](0x6)+_0x1fec6f(0x178)+_0x500cd8['toFixed'](0x6)+')'),console['log'](_0x1fec6f(0x14e)+_0x247ad7[_0x1fec6f(0x74)][_0x1fec6f(0xd3)](0x6)+'\x20->\x20'+_0x275895[_0x1fec6f(0xd3)](0x6)+_0x1fec6f(0xe3)+_0x500cd8['toFixed'](0x6)+')'),{'payout':_0x3cd5ca,'shop':_0x247ad7};});return console[_0x417de4(0x197)](_0x417de4(0x19d)+_0x47f1e0['payout']['id']+'\x20for\x20shop\x20'+_0x47f1e0[_0x417de4(0x189)][_0x417de4(0x15d)]+'\x20('+_0x500cd8+_0x417de4(0x19f)),{'id':_0x47f1e0[_0x417de4(0x83)]['id'],'shopId':_0x47f1e0['payout'][_0x417de4(0xcd)],'shopName':_0x47f1e0[_0x417de4(0x189)][_0x417de4(0x73)],'shopUsername':_0x47f1e0[_0x417de4(0x189)][_0x417de4(0x15d)],'amount':_0x47f1e0[_0x417de4(0x83)][_0x417de4(0xd9)],'network':_0x47f1e0[_0x417de4(0x83)][_0x417de4(0x90)],'status':_0x47f1e0[_0x417de4(0x83)][_0x417de4(0xe0)],'txid':_0x47f1e0[_0x417de4(0x83)]['txid'],'notes':_0x47f1e0[_0x417de4(0x83)][_0x417de4(0xc6)],'periodFrom':_0x47f1e0[_0x417de4(0x83)]['periodFrom'],'periodTo':_0x47f1e0[_0x417de4(0x83)][_0x417de4(0x19e)],'createdAt':_0x47f1e0[_0x417de4(0x83)]['createdAt'],'paidAt':_0x47f1e0['payout']['paidAt']};}async['getAllPayouts'](_0x75d715){const _0x44ad82=a38_0x46f384,{page:_0x3a12f1,limit:_0x15bf22,shopId:_0x3c77bb,network:_0x2eb7b1,dateFrom:_0x3cdcbc,dateTo:_0xb97481,search:_0x1d8080}=_0x75d715,_0x358773=(_0x3a12f1-0x1)*_0x15bf22,_0x5e49c3={};_0x3c77bb&&(_0x5e49c3['shopId']=_0x3c77bb);_0x2eb7b1&&(_0x5e49c3['network']=_0x2eb7b1);(_0x3cdcbc||_0xb97481)&&(_0x5e49c3[_0x44ad82(0x13e)]={},_0x3cdcbc&&(_0x5e49c3[_0x44ad82(0x13e)][_0x44ad82(0x188)]=new Date(_0x3cdcbc)),_0xb97481&&(_0x5e49c3[_0x44ad82(0x13e)][_0x44ad82(0xfe)]=new Date(_0xb97481)));_0x1d8080&&(_0x5e49c3['OR']=[{'shop':{'name':{'contains':_0x1d8080,'mode':_0x44ad82(0x165)}}},{'shop':{'username':{'contains':_0x1d8080,'mode':_0x44ad82(0x165)}}},{'notes':{'contains':_0x1d8080,'mode':_0x44ad82(0x165)}}]);const [_0x59a4c9,_0x3b7d52]=await Promise['all']([database_1[_0x44ad82(0x19b)]['payout']['findMany']({'where':_0x5e49c3,'skip':_0x358773,'take':_0x15bf22,'orderBy':{'createdAt':'desc'},'select':{'id':!![],'shopId':!![],'amount':!![],'network':!![],'status':!![],'txid':!![],'notes':!![],'periodFrom':!![],'periodTo':!![],'createdAt':!![],'paidAt':!![],'shop':{'select':{'name':!![],'username':!![]}}}}),database_1[_0x44ad82(0x19b)][_0x44ad82(0x83)][_0x44ad82(0x16c)]({'where':_0x5e49c3})]);return{'payouts':_0x59a4c9[_0x44ad82(0x82)](_0x12f185=>({'id':_0x12f185['id'],'shopId':_0x12f185['shopId'],'shopName':_0x12f185[_0x44ad82(0x189)][_0x44ad82(0x73)],'shopUsername':_0x12f185['shop'][_0x44ad82(0x15d)],'amount':_0x12f185['amount'],'network':_0x12f185[_0x44ad82(0x90)],'status':_0x12f185['status'],'txid':_0x12f185[_0x44ad82(0x128)],'notes':_0x12f185[_0x44ad82(0xc6)],'periodFrom':_0x12f185[_0x44ad82(0x114)],'periodTo':_0x12f185['periodTo'],'createdAt':_0x12f185[_0x44ad82(0x13e)],'paidAt':_0x12f185[_0x44ad82(0x79)]})),'pagination':{'page':_0x3a12f1,'limit':_0x15bf22,'total':_0x3b7d52,'totalPages':Math['ceil'](_0x3b7d52/_0x15bf22)}};}async['getPayoutById'](_0x39da59){const _0x265934=a38_0x46f384,_0x486d17=await database_1[_0x265934(0x19b)][_0x265934(0x83)]['findUnique']({'where':{'id':_0x39da59},'include':{'shop':{'select':{'name':!![],'username':!![]}}}});if(!_0x486d17)return null;return{'id':_0x486d17['id'],'shopId':_0x486d17[_0x265934(0xcd)],'shopName':_0x486d17[_0x265934(0x189)][_0x265934(0x73)],'shopUsername':_0x486d17['shop'][_0x265934(0x15d)],'amount':_0x486d17[_0x265934(0xd9)],'network':_0x486d17[_0x265934(0x90)],'status':_0x486d17['status'],'txid':_0x486d17[_0x265934(0x128)],'notes':_0x486d17[_0x265934(0xc6)],'periodFrom':_0x486d17['periodFrom'],'periodTo':_0x486d17['periodTo'],'createdAt':_0x486d17[_0x265934(0x13e)],'paidAt':_0x486d17[_0x265934(0x79)]};}async[a38_0x46f384(0x78)](_0x573fac){const _0x3ce84b=a38_0x46f384;await database_1[_0x3ce84b(0x19b)][_0x3ce84b(0x83)]['delete']({'where':{'id':_0x573fac}});}async[a38_0x46f384(0x18f)](_0x1c0037){const _0x85801d=a38_0x46f384,{page:_0x1d08a7,limit:_0x4add71,status:_0x345018,gateway:_0x507842,shopId:_0x4338b1,dateFrom:_0x32e9a5,dateTo:_0x3dcd58,search:_0x486f94,currency:_0x250e1d,sortBy:_0x10fa9f,sortOrder:_0x50b1d6}=_0x1c0037,_0x1658a1=(_0x1d08a7-0x1)*_0x4add71;console[_0x85801d(0x197)](_0x85801d(0xe4),_0x1c0037);const _0x1bae9a=await database_1[_0x85801d(0x19b)][_0x85801d(0x13a)][_0x85801d(0xa5)]({'by':[_0x85801d(0x1a5)],'_count':{'gateway':!![]}});console['log']('📊\x20Available\x20gateways\x20in\x20database:',_0x1bae9a[_0x85801d(0x82)](_0xcc655b=>_0xcc655b['gateway']+'\x20('+_0xcc655b[_0x85801d(0x161)][_0x85801d(0x1a5)]+_0x85801d(0x149)));if(_0x507842){const _0x3bcfee=_0x1bae9a['some'](_0x25dc4f=>_0x25dc4f[_0x85801d(0x1a5)]['toLowerCase']()===_0x507842[_0x85801d(0x148)]());!_0x3bcfee&&_0x507842[_0x85801d(0x148)]()!==_0x85801d(0xba)&&console[_0x85801d(0x197)](_0x85801d(0xa1)+_0x507842+_0x85801d(0x7d)+_0x1bae9a[_0x85801d(0x82)](_0x34d591=>_0x34d591[_0x85801d(0x1a5)])[_0x85801d(0x19c)](',\x20'));}const _0x1a7478={};_0x345018&&(_0x1a7478[_0x85801d(0xe0)]=_0x345018['toUpperCase']());if(!_0x507842)_0x1a7478[_0x85801d(0x1a5)]={'not':_0x85801d(0xba)};else{if(_0x507842&&(_0x507842[_0x85801d(0x148)]()===_0x85801d(0xba)||_0x507842===_0x85801d(0x1a9)))_0x1a7478[_0x85801d(0x1a5)]=_0x85801d(0xba);else{let _0x557340=_0x507842;const _0x23e095=(0x0,gateway_1[_0x85801d(0x100)])(_0x507842);if(_0x23e095)_0x557340=_0x23e095,console[_0x85801d(0x197)](_0x85801d(0x91)+_0x507842+_0x85801d(0x1a2)+_0x557340+'\x27');else{const _0x2be6c5=(0x0,gateway_1[_0x85801d(0x135)])(_0x507842);if(_0x2be6c5){const _0x11dec5=(0x0,gateway_1[_0x85801d(0x100)])(_0x2be6c5);_0x11dec5&&(_0x557340=_0x11dec5,console['log'](_0x85801d(0x15f)+_0x507842+_0x85801d(0x8a)+_0x2be6c5+_0x85801d(0xfd)+_0x557340+'\x27'));}else console[_0x85801d(0x197)](_0x85801d(0x8f)+_0x507842+'\x27\x20as\x20is\x20(not\x20found\x20in\x20mappings)');}const _0x4f56c1=await database_1[_0x85801d(0x19b)][_0x85801d(0x13a)][_0x85801d(0x16c)]({'where':{'gateway':_0x557340[_0x85801d(0x148)]()},'take':0x1});_0x4f56c1===0x0?(console['log']('⚠️\x20Gateway\x20\x27'+_0x557340+'\x27\x20(from\x20\x27'+_0x507842+_0x85801d(0x11c)),_0x1a7478['gateway']=_0x85801d(0x112)):(_0x1a7478['gateway']=_0x557340[_0x85801d(0x148)](),console[_0x85801d(0x197)]('✅\x20Using\x20gateway\x20filter:\x20\x27'+_0x557340+_0x85801d(0x119)+_0x507842+'\x27)'));}}console['log'](_0x85801d(0x126),_0x1a7478[_0x85801d(0x1a5)]);_0x4338b1&&(_0x1a7478[_0x85801d(0xcd)]=_0x4338b1);_0x250e1d&&(_0x1a7478[_0x85801d(0x6c)]=_0x250e1d[_0x85801d(0x68)](),console[_0x85801d(0x197)]('💱\x20Currency\x20filter\x20applied:\x20'+_0x250e1d[_0x85801d(0x68)]()));(_0x32e9a5||_0x3dcd58)&&(_0x1a7478[_0x85801d(0x13e)]={},_0x32e9a5&&(_0x1a7478['createdAt'][_0x85801d(0x188)]=new Date(_0x32e9a5)),_0x3dcd58&&(_0x1a7478['createdAt'][_0x85801d(0xfe)]=new Date(_0x3dcd58)));_0x486f94&&(_0x1a7478['OR']=[{'id':{'contains':_0x486f94,'mode':_0x85801d(0x165)}},{'orderId':{'contains':_0x486f94,'mode':_0x85801d(0x165)}},{'gatewayOrderId':{'contains':_0x486f94,'mode':_0x85801d(0x165)}},{'customerEmail':{'contains':_0x486f94,'mode':_0x85801d(0x165)}},{'shop':{'name':{'contains':_0x486f94,'mode':_0x85801d(0x165)}}},{'shop':{'username':{'contains':_0x486f94,'mode':'insensitive'}}}]);console[_0x85801d(0x197)](_0x85801d(0xa9),JSON[_0x85801d(0x154)](_0x1a7478,null,0x2));let _0x489e3b={'createdAt':_0x85801d(0xb5)};if(_0x10fa9f){const _0x1ff31b=[_0x85801d(0xd9),_0x85801d(0x13e),_0x85801d(0x16d),_0x85801d(0xe0),_0x85801d(0x1a5),_0x85801d(0x6c)],_0x14549a=['asc',_0x85801d(0xb5)];if(_0x1ff31b[_0x85801d(0x72)](_0x10fa9f)){const _0x2518ed=_0x14549a[_0x85801d(0x72)](_0x50b1d6)?_0x50b1d6:_0x85801d(0xb5);_0x489e3b={[_0x10fa9f]:_0x2518ed},console[_0x85801d(0x197)](_0x85801d(0x18d)+_0x10fa9f+_0x85801d(0xc9)+_0x2518ed+'\x20order');}}const [_0x406947,_0x154edc]=await Promise[_0x85801d(0x198)]([database_1[_0x85801d(0x19b)]['payment'][_0x85801d(0x67)]({'where':_0x1a7478,'skip':_0x1658a1,'take':_0x4add71,'orderBy':_0x489e3b,'include':{'shop':{'select':{'name':!![],'username':!![]}}}}),database_1[_0x85801d(0x19b)]['payment']['count']({'where':_0x1a7478})]);return{'payments':_0x406947,'pagination':{'page':_0x1d08a7,'limit':_0x4add71,'total':_0x154edc,'totalPages':Math[_0x85801d(0x123)](_0x154edc/_0x4add71)}};}async[a38_0x46f384(0x159)](_0x56d955){const _0x474406=a38_0x46f384,_0x1f9427=await database_1[_0x474406(0x19b)][_0x474406(0x13a)][_0x474406(0x12e)]({'where':{'id':_0x56d955},'select':{'id':!![],'shopId':!![],'amount':!![],'amountAfterGatewayCommissionUSDT':!![],'currency':!![],'sourceCurrency':!![],'status':!![],'gateway':!![],'orderId':!![],'gatewayOrderId':!![],'gatewayPaymentId':!![],'customerEmail':!![],'customerName':!![],'customerCountry':!![],'customerIp':!![],'customerUa':!![],'externalPaymentUrl':!![],'successUrl':!![],'failUrl':!![],'pendingUrl':!![],'whiteUrl':!![],'expiresAt':!![],'invoiceTotalSum':!![],'qrCode':!![],'qrUrl':!![],'country':!![],'language':!![],'amountIsEditable':!![],'maxPayments':!![],'rapydCustomer':!![],'cardLast4':!![],'paymentMethod':!![],'bankId':!![],'remitterIban':!![],'remitterName':!![],'failureMessage':!![],'usage':!![],'createdAt':!![],'updatedAt':!![],'shop':{'select':{'name':!![],'username':!![]}}}});if(!_0x1f9427)return null;return{'id':_0x1f9427['id'],'shopId':_0x1f9427[_0x474406(0xcd)],'gateway':_0x1f9427[_0x474406(0x1a5)],'amount':_0x1f9427[_0x474406(0xd9)],'currency':_0x1f9427[_0x474406(0x6c)],'status':_0x1f9427['status'],'orderId':_0x1f9427['orderId'],'gatewayOrderId':_0x1f9427[_0x474406(0x106)],'customerEmail':_0x1f9427[_0x474406(0x133)],'customerName':_0x1f9427[_0x474406(0x118)],'customerCountry':_0x1f9427[_0x474406(0xa8)],'customerIp':_0x1f9427[_0x474406(0x9c)],'customerUa':_0x1f9427['customerUa'],'failureMessage':_0x1f9427[_0x474406(0x125)],'externalPaymentUrl':_0x1f9427[_0x474406(0x185)],'successUrl':_0x1f9427[_0x474406(0x1aa)],'failUrl':_0x1f9427[_0x474406(0xf9)],'pendingUrl':_0x1f9427[_0x474406(0xae)],'whiteUrl':_0x1f9427[_0x474406(0xc5)],'createdAt':_0x1f9427[_0x474406(0x13e)],'updatedAt':_0x1f9427['updatedAt'],'shop':_0x1f9427[_0x474406(0x189)]};}async[a38_0x46f384(0x11b)](_0x3be663,_0x13bc75,_0x18ad82,_0x13d083){const _0x19cfbb=a38_0x46f384,_0x2871c9=await database_1[_0x19cfbb(0x19b)][_0x19cfbb(0x179)](async _0x31eb64=>{const _0x2243e8=_0x19cfbb,_0x4e7e59=await _0x31eb64[_0x2243e8(0x13a)][_0x2243e8(0x12e)]({'where':{'id':_0x3be663},'include':{'shop':{'select':{'id':!![],'name':!![],'username':!![],'balance':!![]}}}});if(!_0x4e7e59)throw new Error(_0x2243e8(0x108));const _0x200a86=_0x4e7e59[_0x2243e8(0xe0)],_0x2931a7=_0x13bc75[_0x2243e8(0x68)]();console[_0x2243e8(0x197)](_0x2243e8(0x11e)+_0x3be663+_0x2243e8(0x86)+_0x200a86+_0x2243e8(0xbf)+_0x2931a7),console[_0x2243e8(0x197)](_0x2243e8(0x155)+_0x4e7e59['shop'][_0x2243e8(0xe6)]+'\x20USDT');const _0x3776bd={'status':_0x2931a7,'updatedAt':new Date(),'statusChangedBy':_0x2243e8(0xd4),'statusChangedAt':new Date()};_0x18ad82&&(_0x3776bd['adminNotes']=_0x18ad82);_0x2931a7===_0x2243e8(0x12d)&&_0x13d083&&(_0x3776bd[_0x2243e8(0xd2)]=_0x13d083);let _0x1e5ac4=0x0,_0x4aa332=_0x4e7e59['shop'][_0x2243e8(0xe6)];if(_0x2931a7===_0x2243e8(0x6a)&&_0x200a86!==_0x2243e8(0x6a)){_0x3776bd[_0x2243e8(0x79)]=new Date();const _0x4985db=await currencyService_1['currencyService']['convertToUSDT'](_0x4e7e59['amount'],_0x4e7e59[_0x2243e8(0x6c)]);_0x3776bd[_0x2243e8(0x124)]=_0x4985db;let _0x2f984e=0x2d;const _0xce4a0d=await _0x31eb64[_0x2243e8(0x189)][_0x2243e8(0x12e)]({'where':{'id':_0x4e7e59[_0x2243e8(0xcd)]},'select':{'gatewaySettings':!![]}});if(_0xce4a0d?.[_0x2243e8(0x96)])try{const _0x428c4a=JSON[_0x2243e8(0xb1)](_0xce4a0d['gatewaySettings']);for(const [_0x4ae919,_0xf55eac]of Object[_0x2243e8(0x166)](_0x428c4a)){if(_0x4ae919[_0x2243e8(0x148)]()===_0x4e7e59[_0x2243e8(0x1a5)][_0x2243e8(0x148)]()){_0x2f984e=_0xf55eac[_0x2243e8(0x16e)]||0xa;break;}}}catch(_0x2f94d9){console[_0x2243e8(0x169)](_0x2243e8(0x13f)+_0x3be663+':',_0x2f94d9);}let _0x72f39;_0x4e7e59['amountAfterGatewayCommissionUSDT']!==null&&_0x4e7e59['amountAfterGatewayCommissionUSDT']!==undefined?(_0x72f39=_0x4e7e59[_0x2243e8(0x141)],console[_0x2243e8(0x197)]('📊\x20[ADMIN]\x20Using\x20saved\x20amountAfterGatewayCommissionUSDT:\x20'+_0x72f39[_0x2243e8(0xd3)](0x6)+'\x20USDT\x20for\x20payment\x20'+_0x3be663)):(_0x72f39=_0x4985db*(0x1-_0x2f984e/0x64),console[_0x2243e8(0x197)](_0x2243e8(0x17e)+_0x3be663+':\x20'+_0x2f984e+_0x2243e8(0x89)+_0x4985db[_0x2243e8(0xd3)](0x6)+'\x20USDT'),_0x3776bd[_0x2243e8(0x141)]=_0x72f39,_0x3776bd[_0x2243e8(0x1a4)]=_0x2f984e),_0x1e5ac4=_0x72f39,_0x4aa332+=_0x72f39,console['log'](_0x2243e8(0x109)+_0x3be663+_0x2243e8(0x11a)),console[_0x2243e8(0x197)](_0x2243e8(0xb6)+_0x4985db[_0x2243e8(0xd3)](0x6)+_0x2243e8(0xea)),console[_0x2243e8(0x197)](_0x2243e8(0x12b)+_0x4e7e59[_0x2243e8(0x1a5)]+_0x2243e8(0x153)+_0x2f984e+'%'),console[_0x2243e8(0x197)](_0x2243e8(0xaa)+_0x72f39['toFixed'](0x6)+_0x2243e8(0xf7)+_0x2f984e+_0x2243e8(0x10b)),console[_0x2243e8(0x197)](_0x2243e8(0x6d)+_0x72f39[_0x2243e8(0xd3)](0x6)+_0x2243e8(0xea));}else{if(_0x200a86===_0x2243e8(0x6a)&&_0x2931a7!==_0x2243e8(0x6a)){if(_0x4e7e59[_0x2243e8(0x124)]){let _0xcf7b7f=0x2d;const _0x28132a=await _0x31eb64['shop'][_0x2243e8(0x12e)]({'where':{'id':_0x4e7e59[_0x2243e8(0xcd)]},'select':{'gatewaySettings':!![]}});if(_0x28132a?.[_0x2243e8(0x96)])try{const _0x3fcc99=JSON['parse'](_0x28132a[_0x2243e8(0x96)]);for(const [_0x53af8c,_0x24d8fb]of Object[_0x2243e8(0x166)](_0x3fcc99)){if(_0x53af8c['toLowerCase']()===_0x4e7e59['gateway'][_0x2243e8(0x148)]()){_0xcf7b7f=_0x24d8fb[_0x2243e8(0x16e)]||0xa;break;}}}catch(_0xab9b11){console[_0x2243e8(0x169)](_0x2243e8(0x13f)+_0x3be663+':',_0xab9b11);}const _0x1770b9=_0x4e7e59[_0x2243e8(0x124)]*(0x1-_0xcf7b7f/0x64);_0x1e5ac4=-_0x1770b9,_0x4aa332-=_0x1770b9,_0x3776bd[_0x2243e8(0x124)]=null,_0x3776bd[_0x2243e8(0x141)]=null,console['log'](_0x2243e8(0x109)+_0x3be663+_0x2243e8(0xde)),console['log'](_0x2243e8(0xb6)+_0x4e7e59[_0x2243e8(0x124)][_0x2243e8(0xd3)](0x6)+'\x20USDT'),console[_0x2243e8(0x197)](_0x2243e8(0x12b)+_0x4e7e59[_0x2243e8(0x1a5)]+_0x2243e8(0x153)+_0xcf7b7f+'%'),console['log'](_0x2243e8(0xc3)+_0x1770b9['toFixed'](0x6)+_0x2243e8(0xf7)+_0xcf7b7f+_0x2243e8(0x10b)),console[_0x2243e8(0x197)](_0x2243e8(0x121)+_0x1770b9['toFixed'](0x6)+'\x20USDT');}}}_0x2931a7===_0x2243e8(0x12d)&&(_0x200a86==='PAID'&&_0x4e7e59[_0x2243e8(0x124)]&&console[_0x2243e8(0x197)]('💸\x20CHARGEBACK:\x20Merchant\x20amount\x20already\x20deducted\x20from\x20balance'),_0x13d083&&_0x13d083>0x0&&(_0x1e5ac4-=_0x13d083,_0x4aa332-=_0x13d083,console['log'](_0x2243e8(0xdd)+_0x13d083[_0x2243e8(0xd3)](0x6)+'\x20USDT\x20from\x20balance')));_0x2931a7===_0x2243e8(0xd7)&&_0x200a86==='PAID'&&console[_0x2243e8(0x197)](_0x2243e8(0x10e));const _0x45cdfc=await _0x31eb64[_0x2243e8(0x13a)][_0x2243e8(0xcc)]({'where':{'id':_0x3be663},'data':_0x3776bd,'include':{'shop':{'select':{'name':!![],'username':!![]}}}});return _0x1e5ac4!==0x0&&(await _0x31eb64[_0x2243e8(0x189)]['update']({'where':{'id':_0x4e7e59[_0x2243e8(0xcd)]},'data':{'balance':_0x4aa332}}),console[_0x2243e8(0x197)](_0x2243e8(0x7a)+_0x4e7e59['shopId']+_0x2243e8(0x7e)+_0x4e7e59[_0x2243e8(0x189)][_0x2243e8(0xe6)][_0x2243e8(0xd3)](0x6)+_0x2243e8(0xbf)+_0x4aa332[_0x2243e8(0xd3)](0x6)+_0x2243e8(0xf1)+(_0x1e5ac4>0x0?'+':'')+_0x1e5ac4['toFixed'](0x6)+')')),_0x45cdfc;});return{'id':_0x2871c9['id'],'shopId':_0x2871c9['shopId'],'gateway':_0x2871c9[_0x19cfbb(0x1a5)],'amount':_0x2871c9[_0x19cfbb(0xd9)],'currency':_0x2871c9[_0x19cfbb(0x6c)],'status':_0x2871c9[_0x19cfbb(0xe0)],'orderId':_0x2871c9[_0x19cfbb(0x160)],'gatewayOrderId':_0x2871c9['gatewayOrderId'],'customerEmail':_0x2871c9[_0x19cfbb(0x133)],'customerName':_0x2871c9[_0x19cfbb(0x118)],'customerCountry':_0x2871c9[_0x19cfbb(0xa8)],'customerIp':_0x2871c9['customerIp'],'customerUa':_0x2871c9['customerUa'],'failureMessage':_0x2871c9[_0x19cfbb(0x125)],'adminNotes':_0x2871c9[_0x19cfbb(0x110)],'chargebackAmount':_0x2871c9['chargebackAmount'],'statusChangedBy':_0x2871c9[_0x19cfbb(0x12c)],'statusChangedAt':_0x2871c9[_0x19cfbb(0x182)],'createdAt':_0x2871c9['createdAt'],'updatedAt':_0x2871c9[_0x19cfbb(0x16d)],'shop':_0x2871c9[_0x19cfbb(0x189)]};}async[a38_0x46f384(0xad)](_0xac97c7,_0x13ae0f){const _0x2c10fd=a38_0x46f384,_0x3eff2=Math[_0x2c10fd(0xdf)]()[_0x2c10fd(0xac)](0x24)['substr'](0x2,0x9);console[_0x2c10fd(0x197)](_0x2c10fd(0x75)+_0x3eff2+_0x2c10fd(0x191)+_0xac97c7);const _0x15545e={..._0x13ae0f};_0x13ae0f[_0x2c10fd(0x156)]&&_0x13ae0f['password'][_0x2c10fd(0x117)]()!==''?(console[_0x2c10fd(0x197)](_0x2c10fd(0xb7)+_0x3eff2+_0x2c10fd(0xc8)+_0xac97c7),_0x15545e[_0x2c10fd(0x156)]=await bcryptjs_1[_0x2c10fd(0x19b)][_0x2c10fd(0x15c)](_0x13ae0f[_0x2c10fd(0x156)],0xc)):(console[_0x2c10fd(0x197)](_0x2c10fd(0xb7)+_0x3eff2+_0x2c10fd(0xb9)),delete _0x15545e[_0x2c10fd(0x156)]);_0x13ae0f[_0x2c10fd(0xcb)]&&(_0x15545e[_0x2c10fd(0x73)]=_0x13ae0f[_0x2c10fd(0xcb)],delete _0x15545e['fullName']);_0x13ae0f[_0x2c10fd(0x11d)]&&(_0x15545e[_0x2c10fd(0x94)]=_0x13ae0f[_0x2c10fd(0x11d)],delete _0x15545e[_0x2c10fd(0x11d)]);_0x13ae0f[_0x2c10fd(0x1a6)]&&(_0x15545e[_0x2c10fd(0x69)]=_0x13ae0f['merchantUrl'],delete _0x15545e['merchantUrl']);if(_0x13ae0f[_0x2c10fd(0x8b)]){const _0x23bd99=_0x13ae0f[_0x2c10fd(0x8b)]['map'](_0x1bda41=>this[_0x2c10fd(0xdb)](_0x1bda41));console[_0x2c10fd(0x197)]('🔄\x20Gateway\x20mapping:',_0x13ae0f[_0x2c10fd(0x8b)],'->',_0x23bd99),_0x15545e[_0x2c10fd(0x9b)]=JSON[_0x2c10fd(0x154)](_0x23bd99),delete _0x15545e[_0x2c10fd(0x8b)];}_0x13ae0f[_0x2c10fd(0x96)]&&(console[_0x2c10fd(0x197)](_0x2c10fd(0x183)+_0x3eff2+_0x2c10fd(0xfb),_0x13ae0f[_0x2c10fd(0x96)]),_0x15545e[_0x2c10fd(0x96)]=JSON['stringify'](_0x13ae0f[_0x2c10fd(0x96)]),console['log'](_0x2c10fd(0x183)+_0x3eff2+_0x2c10fd(0x175),_0x15545e[_0x2c10fd(0x96)]));_0x13ae0f[_0x2c10fd(0x136)]&&(_0x13ae0f[_0x2c10fd(0x136)]['usdtPolygonWallet']!==undefined&&(_0x15545e[_0x2c10fd(0x17d)]=_0x13ae0f[_0x2c10fd(0x136)][_0x2c10fd(0x17d)]||null),_0x13ae0f[_0x2c10fd(0x136)][_0x2c10fd(0xbe)]!==undefined&&(_0x15545e[_0x2c10fd(0xbe)]=_0x13ae0f[_0x2c10fd(0x136)][_0x2c10fd(0xbe)]||null),_0x13ae0f[_0x2c10fd(0x136)][_0x2c10fd(0x1a3)]!==undefined&&(_0x15545e[_0x2c10fd(0x1a3)]=_0x13ae0f[_0x2c10fd(0x136)][_0x2c10fd(0x1a3)]||null),_0x13ae0f[_0x2c10fd(0x136)][_0x2c10fd(0xf8)]!==undefined&&(_0x15545e[_0x2c10fd(0xf8)]=_0x13ae0f[_0x2c10fd(0x136)]['usdcPolygonWallet']||null),delete _0x15545e['wallets']);const _0x5ad4a8=await database_1[_0x2c10fd(0x19b)][_0x2c10fd(0x189)][_0x2c10fd(0xcc)]({'where':{'id':_0xac97c7},'data':_0x15545e,'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});return console['log'](_0x2c10fd(0x194)+_0x3eff2+_0x2c10fd(0x167),_0x5ad4a8[_0x2c10fd(0x96)]),{'id':_0x5ad4a8['id'],'fullName':_0x5ad4a8[_0x2c10fd(0x73)],'username':_0x5ad4a8[_0x2c10fd(0x15d)],'telegramId':_0x5ad4a8[_0x2c10fd(0x94)],'merchantUrl':_0x5ad4a8['shopUrl'],'gateways':_0x5ad4a8[_0x2c10fd(0x9b)]?JSON[_0x2c10fd(0xb1)](_0x5ad4a8['paymentGateways']):null,'gatewaySettings':_0x5ad4a8[_0x2c10fd(0x96)]?JSON[_0x2c10fd(0xb1)](_0x5ad4a8['gatewaySettings']):null,'publicKey':_0x5ad4a8[_0x2c10fd(0x103)],'wallets':{'usdtPolygonWallet':_0x5ad4a8[_0x2c10fd(0x17d)],'usdtTrcWallet':_0x5ad4a8[_0x2c10fd(0xbe)],'usdtErcWallet':_0x5ad4a8[_0x2c10fd(0x1a3)],'usdcPolygonWallet':_0x5ad4a8['usdcPolygonWallet']},'status':_0x5ad4a8[_0x2c10fd(0xe0)],'createdAt':_0x5ad4a8[_0x2c10fd(0x13e)]};}async[a38_0x46f384(0x16f)](_0xe22db3){const _0x256d4d=a38_0x46f384,_0x5b23e3=await database_1[_0x256d4d(0x19b)][_0x256d4d(0x189)][_0x256d4d(0xcc)]({'where':{'id':_0xe22db3},'data':{'status':_0x256d4d(0x15e)},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});return{'id':_0x5b23e3['id'],'fullName':_0x5b23e3[_0x256d4d(0x73)],'username':_0x5b23e3[_0x256d4d(0x15d)],'telegramId':_0x5b23e3[_0x256d4d(0x94)],'merchantUrl':_0x5b23e3[_0x256d4d(0x69)],'gateways':_0x5b23e3['paymentGateways']?JSON[_0x256d4d(0xb1)](_0x5b23e3[_0x256d4d(0x9b)]):null,'gatewaySettings':_0x5b23e3[_0x256d4d(0x96)]?JSON[_0x256d4d(0xb1)](_0x5b23e3[_0x256d4d(0x96)]):null,'publicKey':_0x5b23e3['publicKey'],'wallets':{'usdtPolygonWallet':_0x5b23e3[_0x256d4d(0x17d)],'usdtTrcWallet':_0x5b23e3[_0x256d4d(0xbe)],'usdtErcWallet':_0x5b23e3[_0x256d4d(0x1a3)],'usdcPolygonWallet':_0x5b23e3[_0x256d4d(0xf8)]},'status':_0x5b23e3[_0x256d4d(0xe0)],'createdAt':_0x5b23e3['createdAt']};}async[a38_0x46f384(0xe8)](_0x1c15f4){const _0x3b1e58=a38_0x46f384,_0x137273=await database_1[_0x3b1e58(0x19b)][_0x3b1e58(0x189)][_0x3b1e58(0xcc)]({'where':{'id':_0x1c15f4},'data':{'status':'ACTIVE'},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});return{'id':_0x137273['id'],'fullName':_0x137273[_0x3b1e58(0x73)],'username':_0x137273['username'],'telegramId':_0x137273['telegram'],'merchantUrl':_0x137273[_0x3b1e58(0x69)],'gateways':_0x137273[_0x3b1e58(0x9b)]?JSON['parse'](_0x137273['paymentGateways']):null,'gatewaySettings':_0x137273[_0x3b1e58(0x96)]?JSON[_0x3b1e58(0xb1)](_0x137273[_0x3b1e58(0x96)]):null,'publicKey':_0x137273['publicKey'],'wallets':{'usdtPolygonWallet':_0x137273['usdtPolygonWallet'],'usdtTrcWallet':_0x137273['usdtTrcWallet'],'usdtErcWallet':_0x137273[_0x3b1e58(0x1a3)],'usdcPolygonWallet':_0x137273[_0x3b1e58(0xf8)]},'status':_0x137273[_0x3b1e58(0xe0)],'createdAt':_0x137273[_0x3b1e58(0x13e)]};}async[a38_0x46f384(0x10f)](_0x7843af){const _0x4d802f=a38_0x46f384,{page:_0x3c06f6,limit:_0xac2fa3,status:_0x5c556b}=_0x7843af,_0x58cf21=(_0x3c06f6-0x1)*_0xac2fa3,_0x1306b2={};_0x5c556b&&(_0x1306b2[_0x4d802f(0xe0)]=_0x5c556b[_0x4d802f(0x68)]());const [_0x4becab,_0x1dbb70]=await Promise[_0x4d802f(0x198)]([database_1[_0x4d802f(0x19b)][_0x4d802f(0x189)]['findMany']({'where':_0x1306b2,'skip':_0x58cf21,'take':_0xac2fa3,'orderBy':{'createdAt':_0x4d802f(0xb5)},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}}),database_1[_0x4d802f(0x19b)][_0x4d802f(0x189)][_0x4d802f(0x16c)]({'where':_0x1306b2})]);return{'users':_0x4becab[_0x4d802f(0x82)](_0x255d5d=>{const _0x58bece=_0x4d802f,_0x448023=_0x255d5d[_0x58bece(0x9b)]?JSON[_0x58bece(0xb1)](_0x255d5d[_0x58bece(0x9b)]):null,_0x2546bf=_0x448023?_0x448023['map'](_0x21ed84=>this['getGatewayDisplayName'](_0x21ed84)):null;return{'id':_0x255d5d['id'],'fullName':_0x255d5d['name'],'username':_0x255d5d[_0x58bece(0x15d)],'telegramId':_0x255d5d[_0x58bece(0x94)],'merchantUrl':_0x255d5d[_0x58bece(0x69)],'gateways':_0x2546bf,'gatewaySettings':_0x255d5d[_0x58bece(0x96)]?JSON[_0x58bece(0xb1)](_0x255d5d[_0x58bece(0x96)]):null,'publicKey':_0x255d5d[_0x58bece(0x103)],'wallets':{'usdtPolygonWallet':_0x255d5d['usdtPolygonWallet'],'usdtTrcWallet':_0x255d5d[_0x58bece(0xbe)],'usdtErcWallet':_0x255d5d['usdtErcWallet'],'usdcPolygonWallet':_0x255d5d[_0x58bece(0xf8)]},'status':_0x255d5d[_0x58bece(0xe0)],'createdAt':_0x255d5d[_0x58bece(0x13e)]};}),'pagination':{'page':_0x3c06f6,'limit':_0xac2fa3,'total':_0x1dbb70,'totalPages':Math[_0x4d802f(0x123)](_0x1dbb70/_0xac2fa3)}};}async[a38_0x46f384(0x70)](_0x555e43){const _0x1978f1=a38_0x46f384,_0x2b03df=await database_1[_0x1978f1(0x19b)][_0x1978f1(0x189)][_0x1978f1(0x12e)]({'where':{'id':_0x555e43},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});if(!_0x2b03df)return null;const _0x2ac85b=_0x2b03df[_0x1978f1(0x9b)]?JSON[_0x1978f1(0xb1)](_0x2b03df[_0x1978f1(0x9b)]):null,_0x394278=_0x2ac85b?_0x2ac85b[_0x1978f1(0x82)](_0x182e6a=>this[_0x1978f1(0x177)](_0x182e6a)):null;return _0x2ac85b&&_0x394278&&console['log'](_0x1978f1(0xf5),_0x2ac85b,'->',_0x394278),{'id':_0x2b03df['id'],'fullName':_0x2b03df['name'],'username':_0x2b03df[_0x1978f1(0x15d)],'telegramId':_0x2b03df[_0x1978f1(0x94)],'merchantUrl':_0x2b03df[_0x1978f1(0x69)],'gateways':_0x394278,'gatewaySettings':_0x2b03df[_0x1978f1(0x96)]?JSON['parse'](_0x2b03df['gatewaySettings']):null,'publicKey':_0x2b03df[_0x1978f1(0x103)],'wallets':{'usdtPolygonWallet':_0x2b03df[_0x1978f1(0x17d)],'usdtTrcWallet':_0x2b03df[_0x1978f1(0xbe)],'usdtErcWallet':_0x2b03df[_0x1978f1(0x1a3)],'usdcPolygonWallet':_0x2b03df[_0x1978f1(0xf8)]},'status':_0x2b03df['status'],'createdAt':_0x2b03df[_0x1978f1(0x13e)]};}async['createUser'](_0x261667){const _0x225c82=a38_0x46f384,{fullName:_0x4bdd60,username:_0x2708d9,password:_0x43f65c,telegramId:_0x58d604,merchantUrl:_0x1e88c2,gateways:_0x52820a,gatewaySettings:_0xe36ae4,wallets:_0x24c1fe}=_0x261667,_0x543832=await database_1[_0x225c82(0x19b)][_0x225c82(0x189)][_0x225c82(0x12e)]({'where':{'username':_0x2708d9}});if(_0x543832)throw new Error(_0x225c82(0x88));if(_0x58d604){const _0x431b11=await database_1[_0x225c82(0x19b)][_0x225c82(0x189)][_0x225c82(0x12e)]({'where':{'telegram':_0x58d604}});if(_0x431b11)throw new Error(_0x225c82(0x95));}const _0x301414=await bcryptjs_1[_0x225c82(0x19b)][_0x225c82(0x15c)](_0x43f65c,0xc),_0x12b2ea=_0x225c82(0x12a)+crypto_1[_0x225c82(0x19b)]['randomBytes'](0x20)['toString'](_0x225c82(0x181)),_0x101809='sk_'+crypto_1['default']['randomBytes'](0x20)['toString'](_0x225c82(0x181)),_0x4e2295=_0x52820a?_0x52820a[_0x225c82(0x82)](_0x252209=>this['getGatewayInternalName'](_0x252209)):null;_0x52820a&&_0x4e2295&&console['log'](_0x225c82(0x10c),_0x52820a,'->',_0x4e2295);const _0xa66b9f=await database_1['default'][_0x225c82(0x189)][_0x225c82(0x12f)]({'data':{'name':_0x4bdd60,'username':_0x2708d9,'password':_0x301414,'telegram':_0x58d604,'shopUrl':_0x1e88c2,'paymentGateways':_0x4e2295?JSON['stringify'](_0x4e2295):null,'gatewaySettings':_0xe36ae4?JSON['stringify'](_0xe36ae4):null,'usdtPolygonWallet':_0x24c1fe?.[_0x225c82(0x17d)]||null,'usdtTrcWallet':_0x24c1fe?.[_0x225c82(0xbe)]||null,'usdtErcWallet':_0x24c1fe?.['usdtErcWallet']||null,'usdcPolygonWallet':_0x24c1fe?.[_0x225c82(0xf8)]||null,'publicKey':_0x12b2ea,'secretKey':_0x101809,'status':'ACTIVE'},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});return{'id':_0xa66b9f['id'],'fullName':_0xa66b9f[_0x225c82(0x73)],'username':_0xa66b9f[_0x225c82(0x15d)],'telegramId':_0xa66b9f[_0x225c82(0x94)],'merchantUrl':_0xa66b9f[_0x225c82(0x69)],'gateways':_0xa66b9f['paymentGateways']?JSON[_0x225c82(0xb1)](_0xa66b9f[_0x225c82(0x9b)]):null,'gatewaySettings':_0xa66b9f['gatewaySettings']?JSON[_0x225c82(0xb1)](_0xa66b9f[_0x225c82(0x96)]):null,'publicKey':_0xa66b9f[_0x225c82(0x103)],'wallets':{'usdtPolygonWallet':_0xa66b9f['usdtPolygonWallet'],'usdtTrcWallet':_0xa66b9f['usdtTrcWallet'],'usdtErcWallet':_0xa66b9f[_0x225c82(0x1a3)],'usdcPolygonWallet':_0xa66b9f['usdcPolygonWallet']},'status':_0xa66b9f['status'],'createdAt':_0xa66b9f[_0x225c82(0x13e)]};}async[a38_0x46f384(0x120)](_0x45a4ee){const _0x46a7ff=a38_0x46f384;await database_1[_0x46a7ff(0x19b)][_0x46a7ff(0x189)]['delete']({'where':{'id':_0x45a4ee}});}[a38_0x46f384(0xb3)](_0x237862,_0x25c841,_0x2f8436){const _0x1d30a1=a38_0x46f384,_0x3ec7d2=new Map(),_0x276b9c=new Date(_0x25c841);while(_0x276b9c<=_0x2f8436){const _0xa8b015=_0x276b9c['toISOString']()[_0x1d30a1(0x132)]('T')[0x0];_0x3ec7d2[_0x1d30a1(0x1ab)](_0xa8b015,{'revenue':0x0,'count':0x0}),_0x276b9c[_0x1d30a1(0x105)](_0x276b9c[_0x1d30a1(0xe9)]()+0x1);}for(const _0x315bdf of _0x237862){const _0x36b0c4=_0x315bdf[_0x1d30a1(0x13e)]['toISOString']()[_0x1d30a1(0x132)]('T')[0x0],_0x526550=_0x3ec7d2[_0x1d30a1(0x18e)](_0x36b0c4);_0x526550&&(_0x526550['count']+=0x1,_0x315bdf[_0x1d30a1(0xe0)]===_0x1d30a1(0x6a)&&(_0x315bdf[_0x1d30a1(0x124)]?_0x526550['revenue']+=_0x315bdf[_0x1d30a1(0x124)]:console['log']('⚠️\x20Payment\x20'+_0x315bdf['id']+_0x1d30a1(0x93))));}const _0x59979b=[],_0x2107c9=[];for(const [_0x4e201f,_0x3fd8ef]of _0x3ec7d2){_0x59979b[_0x1d30a1(0x147)]({'date':_0x4e201f,'amount':Math['round'](_0x3fd8ef[_0x1d30a1(0xbc)]*0x64)/0x64}),_0x2107c9[_0x1d30a1(0x147)]({'date':_0x4e201f,'count':_0x3fd8ef['count']});}return{'dailyRevenue':_0x59979b,'dailyPayments':_0x2107c9};}}function a38_0x3985(){const _0x2fc073=['length','\x20USDT\x20(','📅\x20Period:\x20','2992NBuOzt','\x20\x20\x20✅\x20Total\x20available\x20for\x20payout:\x20','🔄\x20Gateway\x20mapping\x20(get):','findFirst','\x20USDT\x20(after\x20','usdcPolygonWallet','failUrl','\x20USDT,\x20Requested:\x20',']\x20Gateway\x20settings\x20before\x20saving:','totalCommissionRate','\x27\x20->\x20name\x20\x27','lte','KLYME\x20DE','getGatewayNameById','\x20has\x20zero\x20or\x20null\x20amountUSDT,\x20skipping...','round','publicKey','KLYME\x20EU','setDate','gatewayOrderId','commissionUSDT','Payment\x20not\x20found','💰\x20Payment\x20','dateFrom','%\x20commission)','🔄\x20Gateway\x20mapping\x20(create):','customerUa','🔄\x20REFUND:\x20Payment\x20amount\x20already\x20deducted\x20from\x20balance','getAllUsers','adminNotes','📋\x20Found\x20','NONEXISTENT_GATEWAY_FILTER','\x20\x20\x20💰\x20Total\x20payout:\x20','periodFrom','getPayoutStats','Test\x20Gateway','trim','customerName','\x27\x20(from\x20\x27','\x20became\x20PAID:','updatePaymentStatus','\x27)\x20not\x20found\x20in\x20database,\x20returning\x20empty\x20result','telegramId','🔄\x20Admin\x20updating\x20payment\x20','totalPayout','deleteUser','\x20\x20\x20Subtracted\x20from\x20balance:\x20-','trc20','ceil','amountUSDT','failureMessage','📊\x20Gateway\x20filter\x20applied:','24654hHUylb','txid','\x20\x20\x20�📊\x20Total\x20payments:\x20','pk_','\x20\x20\x20Gateway:\x20','statusChangedBy','CHARGEBACK','findUnique','create','dailyRevenue','2020-01-01','split','customerEmail','warn','getGatewayIdByName','wallets','💰\x20Found\x20','month','asc','payment','📊\x20Using\x20saved\x20values\x20for\x20payment\x20','\x20USDT\x20(theoretical\x20net)','sort','createdAt','Error\x20parsing\x20gateway\x20settings\x20for\x20payment\x20','\x20merchants','amountAfterGatewayCommissionUSDT','Error\x20processing\x20payment\x20','noda','Noda','week','📊\x20Calculating\x20commission\x20manually\x20for\x20payment\x20','push','toLowerCase','\x20payments)','80tpHvvU','⚠️\x20Payment\x20','totalPayments','💰\x20Creating\x20payout\x20for\x20shop\x20','\x20\x20\x20Total\x20paid\x20out:\x20','localeCompare','getMonth','\x20\x20\x20�\x20Total\x20payments\x20turnover:\x20','klyme_de',',\x20Commission:\x20','stringify','💰\x20Current\x20shop\x20balance:\x20','password','awaitingPayout','\x20\x20\x20Current\x20balance:\x20','getPaymentById','Open\x20Banking\x202','not\x20set','hash','username','SUSPENDED','🔄\x20Converted\x20gateway\x20name\x20\x27','orderId','_count','\x20paid\x20payments\x20for\x20analysis','\x20\x20\x20Balance:\x20','__importDefault','insensitive','entries',']\x20User\x20updated,\x20gatewaySettings\x20from\x20DB:','\x20\x20\x20Transaction\x20hash:\x20','error','date','\x20merchants\x20with\x20positive\x20balance','count','updatedAt','commission','suspendUser','getSystemStatistics','Error\x20parsing\x20gateway\x20settings\x20for\x20shop\x20','\x20USDT\x20(calculated\x20-\x20payouts\x20-\x20balance)','dateTo','setHours',']\x20Gateway\x20settings\x20JSON\x20string:','polygon','getGatewayDisplayName','\x20USDT\x20(-','$transaction','📋\x20Getting\x20merchants\x20selection\x20list...','merchantEarnings','\x20USDT\x20(already\x20paid\x20out)','usdtPolygonWallet','📊\x20[ADMIN]\x20Calculating\x20commission\x20manually\x20for\x20payment\x20','\x20\x20\x20👤\x20Merchant\x20earnings:\x20','27616TTEAKs','hex','statusChangedAt','🔧\x20[','\x20for\x20shop\x20','externalPaymentUrl','\x20USDT\x20(sum\x20of\x20all\x20merchant\x20balances)','availableBalance','gte','shop','\x20\x20\x20💸\x20Total\x20payouts\x20(all\x20time):\x20','getMerchantsAwaitingPayout','\x20USDT\x20(same\x20as\x20awaiting)','📊\x20Sorting\x20payments\x20by\x20','get','getAllPayments','bcryptjs',',\x20userId:\x20','\x20USDT\x20(actual\x20balances)','AdminService','🎯\x20[','custom','getTime','log','all','395vpLIwl','\x20\x20\x20⏳\x20Pending\x20payout:\x20','default','join','✅\x20Payout\x20created:\x20','periodTo','\x20USDT)','\x20\x20\x20💳\x20Total\x20payments:\x20','paymentsCount','\x27\x20to\x20name\x20\x27','usdtErcWallet','gatewayCommissionRate','gateway','merchantUrl','period','CoinToPay','0000','successUrl','set','findMany','toUpperCase','shopUrl','PAID','1944YukqjM','currency','\x20\x20\x20Added\x20to\x20balance:\x20+','\x20\x20\x20💵\x20Available\x20balance:\x20','convertToUSDT','getUserById','📊\x20Payout\x20statistics\x20calculated:','includes','name','totalPaidOut','🎯\x20updateUser\x20called\x20with\x20ID:\x20','1337FhplNY','day','deletePayout','paidAt','💰\x20Shop\x20','\x20\x20\x20✅\x20Actual\x20available\x20balance:\x20',':\x20commission\x20=\x20','\x27\x20not\x20found.\x20Available\x20gateways:\x20','\x20balance\x20updated:\x20','totalAmountUSDT',',\x20successful:\x20','cointopay','map','payout','toISOString','turnover','\x20status:\x20','Rapyd','Username\x20already\x20exists','%\x20from\x20','\x27\x20->\x20ID\x20\x27','gateways','getFullYear','11989483OiigIK','not\x20specified','🔍\x20Using\x20gateway\x20\x27','network','🔄\x20Converted\x20gateway\x20ID\x20\x27','\x20USDT,\x20merchant:\x20','\x20missing\x20amountUSDT,\x20using\x20fallback\x20conversion','telegram','Telegram\x20username\x20already\x20exists','gatewaySettings','📊\x20Getting\x20merchants\x20awaiting\x20payout\x20with\x20filters:','mastercard','\x20\x20\x20🏪\x20Gateway\x20earnings:\x20','\x20balance\x20updated:','paymentGateways','customerIp','__esModule','✅\x20Customer\x20data\x20updated\x20for\x20payment\x20','\x20\x20\x20🌐\x20IP:\x20','ACTIVE','⚠️\x20Requested\x20gateway\x20\x27','averageCommissionRate','39141fTXEvs','💰\x20[PAYOUT]\x20Gateway\x20','groupBy','📊\x20Getting\x20merchant\x20statistics\x20with\x20filters:','../types/gateway','customerCountry','📊\x20Final\x20WHERE\x20conditions:','\x20\x20\x20Merchant\x20gets:\x20','merchantEarningsUSDT','toString','updateUser','pendingUrl','yesterday','klyme_eu','parse','plisio','generateDailyStatistics','💰\x20[PAYOUT]\x20Merchant\x20','desc','\x20\x20\x20Full\x20amount:\x20','🔐\x20[','\x20USDT\x20(total\x20paid\x20to\x20merchants)',']\x20Password\x20not\x20provided\x20or\x20empty,\x20skipping\x20password\x20update','test_gateway','\x20USDT\x20(gross\x20revenue)','revenue','currencyService','usdtTrcWallet','\x20->\x20','reduce','polygon_usdc','\x20\x20\x20🔍\x20Calculated\x20after\x20commission:\x20','\x20\x20\x20Merchant\x20loses:\x20','MasterCard','whiteUrl','notes','aggregate',']\x20Updating\x20password\x20for\x20user\x20','\x20in\x20','dailyPayments','fullName','update','shopId','forEach','\x20\x20\x20�\x20Total\x20paid\x20out:\x20','pendingPayout','_sum','chargebackAmount','toFixed','admin','📊\x20Total\x20payments\x20(including\x20failed):\x20','3869440gSOwYV','REFUND','gatewayEarnings','amount','\x20\x20\x20💰\x20Total\x20turnover:\x20','getGatewayInternalName','44857jKftpd','💸\x20CHARGEBACK\x20penalty:\x20-','\x20no\x20longer\x20PAID:','random','status','COMPLETED','amountAfterCommissionUSDT','\x20USDT\x20(+','📊\x20Getting\x20payments\x20with\x20filters:','\x20\x20\x20🤔\x20Difference:\x20','balance','thisMonth','activateUser','getDate','\x20USDT','rapyd','averageCheckUSDT','🔄\x20Updating\x20customer\x20data\x20for\x20payment\x20','turnoverUSDT','values'];a38_0x3985=function(){return _0x2fc073;};return a38_0x3985();}exports[a38_0x46f384(0x193)]=AdminService;