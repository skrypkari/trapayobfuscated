'use strict';function a36_0x4635(_0x2f84f3,_0x20c8c8){const _0x5eb07b=a36_0x5eb0();return a36_0x4635=function(_0x463537,_0x15a00d){_0x463537=_0x463537-0xa6;let _0x385fe0=_0x5eb07b[_0x463537];return _0x385fe0;},a36_0x4635(_0x2f84f3,_0x20c8c8);}const a36_0x3bf6cf=a36_0x4635;(function(_0x520232,_0x1a11dc){const _0x1a85d1=a36_0x4635,_0xfe5dff=_0x520232();while(!![]){try{const _0x4a7748=-parseInt(_0x1a85d1(0x105))/0x1*(parseInt(_0x1a85d1(0x154))/0x2)+-parseInt(_0x1a85d1(0x1a6))/0x3*(parseInt(_0x1a85d1(0x1d9))/0x4)+-parseInt(_0x1a85d1(0x16b))/0x5+-parseInt(_0x1a85d1(0xfb))/0x6*(parseInt(_0x1a85d1(0x1ce))/0x7)+-parseInt(_0x1a85d1(0x13b))/0x8*(parseInt(_0x1a85d1(0x135))/0x9)+parseInt(_0x1a85d1(0x1b3))/0xa*(-parseInt(_0x1a85d1(0xaf))/0xb)+parseInt(_0x1a85d1(0xdb))/0xc;if(_0x4a7748===_0x1a11dc)break;else _0xfe5dff['push'](_0xfe5dff['shift']());}catch(_0x503103){_0xfe5dff['push'](_0xfe5dff['shift']());}}}(a36_0x5eb0,0x2cc96));var __importDefault=this&&this[a36_0x3bf6cf(0x170)]||function(_0x1c8f27){return _0x1c8f27&&_0x1c8f27['__esModule']?_0x1c8f27:{'default':_0x1c8f27};};Object[a36_0x3bf6cf(0x1ac)](exports,a36_0x3bf6cf(0x1b1),{'value':!![]}),exports[a36_0x3bf6cf(0x176)]=void 0x0;function a36_0x5eb0(){const _0x5172c7=['statusChangedBy','getAllUsers','getGatewayInternalName','publicKey','failureMessage','\x20\x20\x20Total\x20paid\x20out:\x20','map','%\x20commission)','status','\x20USDT\x20(theoretical\x20net)','merchantUrl',',\x20Commission:\x20','📊\x20Gateway\x20filter\x20applied:',',\x20userId:\x20','getAllPayouts','chargebackAmount','failUrl','totalPayout','length','pk_','📊\x20Calculating\x20commission\x20manually\x20for\x20payment\x20','parse','\x20\x20\x20�\x20Total\x20payments\x20turnover:\x20','%\x20from\x20','🔄\x20Converted\x20gateway\x20name\x20\x27','payment','gateways','forEach','reduce','currencyService','error','CHARGEBACK','🔍\x20Using\x20gateway\x20\x27','commissionUSDT','totalAmountAfterCommissionUSDT','trim','delete','shopUrl','all','some','\x20\x20\x20💳\x20Total\x20payments:\x20','📊\x20Final\x20WHERE\x20conditions:','values','COMPLETED','45HHbNzu','📊\x20Getting\x20merchant\x20statistics\x20with\x20filters:','date','getMerchantsSelection','🔄\x20Converted\x20gateway\x20ID\x20\x27','\x20to\x20','defineProperty',':\x20commission\x20=\x20','payout','30d','generateDailyStatistics','__esModule','totalPayments','90jytTfR','totalPaidOut','\x20\x20\x20✅\x20Total\x20available\x20for\x20payout:\x20','usdtErcWallet','\x20missing\x20amountUSDT,\x20using\x20fallback\x20conversion','💸\x20CHARGEBACK:\x20Merchant\x20amount\x20already\x20deducted\x20from\x20balance','KLYME\x20DE','averageCommissionRate','Username\x20already\x20exists','shop','\x20USDT\x20(total\x20paid\x20to\x20merchants)','REFUND','updatedAt','\x20USDT\x20(after\x20','get','../types/gateway','\x20merchants','📋\x20Getting\x20merchants\x20selection\x20list...','\x27\x20to\x20name\x20\x27','Payment\x20not\x20found','findFirst','\x20\x20\x20Current\x20total\x20paid\x20out:\x20','set','fullName','📊\x20Payout\x20statistics\x20calculated:','\x20\x20\x20Current\x20balance:\x20','gatewayEarnings','125468UeiBUk','🎯\x20updateUser\x20called\x20with\x20ID:\x20','klyme_eu','round','Shop\x20not\x20found','🔧\x20[','erc20','getGatewayIdByName','deleteUser','amount','📊\x20Sorting\x20payments\x20by\x20','65796wsQRgL','cointopay',']\x20Password\x20not\x20provided\x20or\x20empty,\x20skipping\x20password\x20update','💰\x20[PAYOUT]\x20Gateway\x20','amountAfterGatewayCommissionUSDT','\x20\x20\x20💰\x20Total\x20payout:\x20','PENDING','usdcPolygonWallet','sk_','hex','📊\x20Getting\x20payments\x20with\x20filters:','Error\x20processing\x20payment\x20','dailyPayments','test_gateway','\x27\x20->\x20ID\x20\x27','Noda','\x20\x20\x20🔍\x20Raw\x20balance\x20sum:\x20','\x20\x20\x20💵\x20Available\x20balance:\x20','⚠️\x20Requested\x20gateway\x20\x27','update','\x20\x20\x20Gateway:\x20','2020-01-01','\x20became\x20PAID:','hash','💰\x20Payment\x20','CoinToPay','💸\x20CHARGEBACK\x20penalty:\x20-','ACTIVE','toFixed','\x20\x20\x20👤\x20Merchant\x20earnings:\x20','Insufficient\x20balance.\x20Available:\x20','noda','92422kjEHqW','turnover','wallets','name','findUnique','updateCustomerData','toISOString','📅\x20Period:\x20','customerCountry',']\x20User\x20updated,\x20gatewaySettings\x20from\x20DB:','adminNotes','successUrl','\x20\x20\x20🌍\x20Country:\x20','username','NONEXISTENT_GATEWAY_FILTER','findMany','insensitive','\x20status:\x20','getAllPayments','totalAmountUSDT','summary','split','\x20USDT\x20(with\x20commission\x20deducted)','\x20\x20\x20Merchant\x20loses:\x20','week','activateUser','push','\x20\x20\x20Balance:\x20','deletePayout','\x20USDT\x20(without\x20commission)','substr','📊\x20Getting\x20merchants\x20awaiting\x20payout\x20with\x20filters:','admin','groupBy',']\x20Gateway\x20settings\x20JSON\x20string:','period','telegram','\x20\x20\x20�📊\x20Total\x20payments:\x20','\x20\x20\x20🌐\x20IP:\x20','\x20USDT\x20(-','createPayout','randomBytes','Rapyd','\x20USDT','14716380xujlra','🔄\x20Updating\x20customer\x20data\x20for\x20payment\x20','random','mastercard','🔄\x20Gateway\x20mapping\x20(create):','paidAt','network','\x20USDT)','join','📊\x20Total\x20payments\x20(including\x20failed):\x20','📊\x20[ADMIN]\x20Calculating\x20commission\x20manually\x20for\x20payment\x20','Open\x20Banking\x202','totalTurnover','📊\x20Available\x20gateways\x20in\x20database:','asc','polygon_usdc','txid','\x20\x20\x20📅\x20This\x20month:\x20','📊\x20[ADMIN]\x20Using\x20saved\x20amountAfterGatewayCommissionUSDT:\x20','\x20\x20\x20Subtracted\x20from\x20balance:\x20-','💰\x20Current\x20shop\x20balance:\x20','getMonth','updateUser',']\x20Updating\x20password\x20for\x20user\x20','\x20payments)','crypto','aggregate','klyme_gb','periodTo','gatewaySettings','customerIp','log','96dNDpiE','stringify','gte','$transaction','✅\x20Using\x20gateway\x20filter:\x20\x27','toLowerCase','getFullYear','\x20for\x20shop\x20','\x27\x20as\x20is\x20(not\x20found\x20in\x20mappings)','includes','5WqLyfk','\x20no\x20longer\x20PAID:','\x20balance\x20updated:','\x20\x20\x20Payout\x20amount:\x20','revenue','gateway','thisMonth','\x20USDT\x20(gross\x20revenue)','getPaymentById','amountUSDT','getPayoutStats','\x27\x20(from\x20\x27','paymentGateways','customerUa','currency',',\x20successful:\x20','orderId','turnoverUSDT','averageCheckUSDT','createdAt','\x20USDT\x20(same\x20as\x20awaiting)','\x20\x20\x20💸\x20Total\x20payouts\x20(all\x20time):\x20','merchantEarningsUSDT','\x20merchants\x20with\x20positive\x20balance','paymentsCount','✅\x20Customer\x20data\x20updated\x20for\x20payment\x20','count','awaitingPayout','✅\x20Payout\x20created:\x20','\x20->\x20','\x20paid\x20payments\x20for\x20analysis','Test\x20Gateway','💰\x20[PAYOUT]\x20Merchant\x20','KLYME\x20GB','Error\x20parsing\x20gateway\x20settings\x20for\x20payment\x20','usdtPolygonWallet','plisio','lte','\x20\x20\x20🏪\x20Gateway\x20earnings:\x20','localeCompare','polygon','dateFrom','\x20USDT\x20(','shopId','\x20active\x20merchants\x20for\x20selection','_count','convertToUSDT','Telegram\x20username\x20already\x20exists','1228581bIZomP','month','getGatewayDisplayName','toString','\x20\x20\x20✅\x20Actual\x20available\x20balance:\x20','desc','8ooXuhh','commission','KLYME\x20EU','getGatewayNameById','createUser',']\x20Gateway\x20settings\x20before\x20saving:','entries','\x20USDT,\x20Requested:\x20','password','Error\x20parsing\x20gateway\x20settings\x20for\x20shop\x20','0000','\x20USDT\x20(+','Plisio','totalCommissionRate','⚠️\x20Payment\x20','statusChangedAt','\x20\x20\x20�\x20Total\x20paid\x20out:\x20','dateTo','\x20USDT\x20(after\x20payouts)','PAID','ceil','bcryptjs','🔄\x20Gateway\x20mapping\x20(get):','\x27\x20not\x20found.\x20Available\x20gateways:\x20','default','24834NfQNbe','not\x20set','\x20\x20\x20🔍\x20Calculated\x20after\x20commission:\x20','telegramId','pendingPayout','_sum','🔄\x20REFUND:\x20Payment\x20amount\x20already\x20deducted\x20from\x20balance','\x20order','SUSPENDED','📊\x20Using\x20saved\x20amountAfterGatewayCommissionUSDT:\x20','paidOutUSDT','toUpperCase','🔐\x20[','../config/database','getTime','./currencyService','availableBalance','getMerchantStatistics','sort','gatewayOrderId','\x20\x20\x20Merchant\x20gets:\x20','merchantEarnings','usdtTrcWallet','1175940llVzkA','📊\x20Calculating\x20payout\x20statistics...','\x20\x20\x20⏳\x20Pending\x20payout:\x20','💰\x20Shop\x20','setDate','__importDefault','periodFrom','custom','MasterCard','customerName','\x20in\x20','AdminService','\x27)\x20not\x20found\x20in\x20database,\x20returning\x20empty\x20result','balance','create'];a36_0x5eb0=function(){return _0x5172c7;};return a36_0x5eb0();}const database_1=__importDefault(require(a36_0x3bf6cf(0x161))),bcryptjs_1=__importDefault(require(a36_0x3bf6cf(0x150))),crypto_1=__importDefault(require(a36_0x3bf6cf(0xf4))),currencyService_1=require(a36_0x3bf6cf(0x163)),gateway_1=require(a36_0x3bf6cf(0x1c2));class AdminService{async[a36_0x3bf6cf(0x10f)](){const _0x2d3f5f=a36_0x3bf6cf;console[_0x2d3f5f(0xfa)](_0x2d3f5f(0x16c));const _0x1902ea=await database_1[_0x2d3f5f(0x153)][_0x2d3f5f(0x1bc)][_0x2d3f5f(0xf5)]({'_sum':{'balance':!![],'totalPaidOut':!![]},'where':{'status':_0x2d3f5f(0xaa)}}),_0x3bb964=await this['getMerchantsAwaitingPayout']({'page':0x1,'limit':0x3e8}),_0x252d88=await database_1[_0x2d3f5f(0x153)]['payment']['count']({'where':{'status':'PAID','gateway':{'not':_0x2d3f5f(0x1e6)}}}),_0x4e23dd=new Date(),_0x407595=new Date(_0x4e23dd[_0x2d3f5f(0x101)](),_0x4e23dd[_0x2d3f5f(0xf0)](),0x1),_0x4a38e1=new Date(_0x4e23dd[_0x2d3f5f(0x101)](),_0x4e23dd[_0x2d3f5f(0xf0)]()+0x1,0x0,0x17,0x3b,0x3b,0x3e7),_0x1e3549=await database_1[_0x2d3f5f(0x153)][_0x2d3f5f(0x1ae)][_0x2d3f5f(0xf5)]({'_sum':{'amount':!![]},'where':{'createdAt':{'gte':_0x407595,'lte':_0x4a38e1},'status':_0x2d3f5f(0x1a5)}}),_0x56e795=_0x1902ea[_0x2d3f5f(0x159)][_0x2d3f5f(0x1b4)]||0x0,_0x13dc77=_0x3bb964[_0x2d3f5f(0xc3)][_0x2d3f5f(0x19c)],_0x3679a9=_0x1e3549[_0x2d3f5f(0x159)][_0x2d3f5f(0x1d7)]||0x0,_0x59ea26={'totalPayout':Math[_0x2d3f5f(0x1d1)](_0x56e795*0x64)/0x64,'awaitingPayout':Math[_0x2d3f5f(0x1d1)](_0x13dc77*0x64)/0x64,'thisMonth':Math['round'](_0x3679a9*0x64)/0x64,'availableBalance':Math[_0x2d3f5f(0x1d1)](_0x13dc77*0x64)/0x64,'totalPayments':_0x252d88};return console[_0x2d3f5f(0xfa)](_0x2d3f5f(0x1cb)),console[_0x2d3f5f(0xfa)](_0x2d3f5f(0x1de)+_0x59ea26[_0x2d3f5f(0x18b)]+_0x2d3f5f(0x1bd)),console[_0x2d3f5f(0xfa)]('\x20\x20\x20⏳\x20Awaiting\x20payout:\x20'+_0x59ea26[_0x2d3f5f(0x120)]+_0x2d3f5f(0xc5)),console[_0x2d3f5f(0xfa)](_0x2d3f5f(0x1ea)+_0x59ea26[_0x2d3f5f(0x164)]+_0x2d3f5f(0x119)),console['log'](_0x2d3f5f(0xec)+_0x59ea26[_0x2d3f5f(0x10b)]+_0x2d3f5f(0xda)),console[_0x2d3f5f(0xfa)](_0x2d3f5f(0x1a2)+_0x59ea26['totalPayments']+'\x20PAID\x20payments'),console[_0x2d3f5f(0xfa)](_0x2d3f5f(0x1e9)+(_0x1902ea['_sum'][_0x2d3f5f(0x178)]||0x0)[_0x2d3f5f(0xab)](0x2)+_0x2d3f5f(0xcc)),console[_0x2d3f5f(0xfa)]('\x20\x20\x20📊\x20Commission\x20difference:\x20'+((_0x1902ea[_0x2d3f5f(0x159)][_0x2d3f5f(0x178)]||0x0)-_0x13dc77)[_0x2d3f5f(0xab)](0x2)+_0x2d3f5f(0xda)),_0x59ea26;}async[a36_0x3bf6cf(0xb4)](_0x2d6cf,_0x1709ad){const _0x4bfa52=a36_0x3bf6cf;console[_0x4bfa52(0xfa)](_0x4bfa52(0xdc)+_0x2d6cf+':',_0x1709ad);const _0x1a45b6=await database_1[_0x4bfa52(0x153)][_0x4bfa52(0x193)][_0x4bfa52(0xb3)]({'where':{'id':_0x2d6cf},'select':{'id':!![],'customerEmail':!![],'customerName':!![],'customerCountry':!![],'customerIp':!![],'customerUa':!![]}});if(!_0x1a45b6)throw new Error(_0x4bfa52(0x1c6));const _0x27559d={};_0x1709ad[_0x4bfa52(0xb7)]!==undefined&&(_0x27559d[_0x4bfa52(0xb7)]=_0x1709ad[_0x4bfa52(0xb7)]||null);_0x1709ad[_0x4bfa52(0xf9)]!==undefined&&(_0x27559d['customerIp']=_0x1709ad['customerIp']||null);_0x1709ad[_0x4bfa52(0x112)]!==undefined&&(_0x27559d[_0x4bfa52(0x112)]=_0x1709ad['customerUa']||null);const _0x377072=await database_1[_0x4bfa52(0x153)][_0x4bfa52(0x193)][_0x4bfa52(0x1ec)]({'where':{'id':_0x2d6cf},'data':{..._0x27559d,'updatedAt':new Date()},'select':{'id':!![],'customerEmail':!![],'customerName':!![],'customerCountry':!![],'customerIp':!![],'customerUa':!![],'updatedAt':!![]}});return console['log'](_0x4bfa52(0x11e)+_0x2d6cf),console[_0x4bfa52(0xfa)](_0x4bfa52(0xbb)+_0x1a45b6[_0x4bfa52(0xb7)]+_0x4bfa52(0x122)+_0x377072[_0x4bfa52(0xb7)]),console[_0x4bfa52(0xfa)](_0x4bfa52(0xd5)+_0x1a45b6[_0x4bfa52(0xf9)]+'\x20->\x20'+_0x377072[_0x4bfa52(0xf9)]),console['log']('\x20\x20\x20🖥️\x20User\x20Agent:\x20'+(_0x1a45b6[_0x4bfa52(0x112)]?_0x4bfa52(0x1c9):'not\x20set')+_0x4bfa52(0x122)+(_0x377072[_0x4bfa52(0x112)]?_0x4bfa52(0x1c9):_0x4bfa52(0x155))),_0x377072;}async['getSystemStatistics'](_0x476592){const _0x3bce8c=a36_0x3bf6cf,_0x515e06=new Date();let _0x4f78ec;switch(_0x476592){case'7d':_0x4f78ec=new Date(_0x515e06[_0x3bce8c(0x162)]()-0x7*0x18*0x3c*0x3c*0x3e8);break;case _0x3bce8c(0x1af):_0x4f78ec=new Date(_0x515e06['getTime']()-0x1e*0x18*0x3c*0x3c*0x3e8);break;case'90d':_0x4f78ec=new Date(_0x515e06['getTime']()-0x5a*0x18*0x3c*0x3c*0x3e8);break;case _0x3bce8c(0x1a0):const _0x3a7263=await database_1[_0x3bce8c(0x153)][_0x3bce8c(0x193)][_0x3bce8c(0x1c7)]({'where':{'gateway':{'not':_0x3bce8c(0x1e6)}},'orderBy':{'createdAt':_0x3bce8c(0xe9)},'select':{'createdAt':!![]}});_0x4f78ec=_0x3a7263?_0x3a7263[_0x3bce8c(0x118)]:new Date(_0x3bce8c(0x1ee)),console[_0x3bce8c(0xfa)]('📅\x20Period\x20\x27all\x27:\x20Using\x20start\x20date\x20from\x20first\x20payment:\x20'+_0x4f78ec[_0x3bce8c(0xb5)]());break;default:_0x4f78ec=new Date(_0x515e06[_0x3bce8c(0x162)]()-0x1e*0x18*0x3c*0x3c*0x3e8);}const [_0x1998ee,_0x37edda,_0x2c8207,_0xb7f313,_0x1f569e,_0x1bdae1]=await Promise[_0x3bce8c(0x1a0)]([database_1[_0x3bce8c(0x153)][_0x3bce8c(0x1bc)]['count'](),database_1[_0x3bce8c(0x153)]['shop'][_0x3bce8c(0x11f)]({'where':{'status':'ACTIVE'}}),database_1[_0x3bce8c(0x153)][_0x3bce8c(0x193)][_0x3bce8c(0x11f)]({'where':{'status':_0x3bce8c(0x14e),'createdAt':{'gte':_0x4f78ec},'gateway':{'not':_0x3bce8c(0x1e6)}}}),database_1[_0x3bce8c(0x153)][_0x3bce8c(0x193)][_0x3bce8c(0xbe)]({'where':{'status':_0x3bce8c(0x14e),'createdAt':{'gte':_0x4f78ec},'gateway':{'not':_0x3bce8c(0x1e6)}},'select':{'amount':!![],'currency':!![],'amountAfterGatewayCommissionUSDT':!![]}}),database_1[_0x3bce8c(0x153)][_0x3bce8c(0x193)][_0x3bce8c(0xbe)]({'where':{'gateway':{'not':'test_gateway'}},'take':0xa,'orderBy':{'createdAt':_0x3bce8c(0x13a)},'include':{'shop':{'select':{'name':!![],'username':!![]}}}}),database_1[_0x3bce8c(0x153)][_0x3bce8c(0x193)][_0x3bce8c(0xbe)]({'where':{'createdAt':{'gte':_0x4f78ec},'gateway':{'not':_0x3bce8c(0x1e6)}},'select':{'amount':!![],'currency':!![],'status':!![],'amountUSDT':!![],'createdAt':!![]}})]);let _0x48e0e4=0x0,_0x24df7b=0x0;for(const _0x113312 of _0xb7f313){const _0x4994e5=await currencyService_1['currencyService']['convertToUSDT'](_0x113312['amount'],_0x113312[_0x3bce8c(0x113)]);_0x48e0e4+=_0x4994e5;if(_0x113312[_0x3bce8c(0x1dd)]){const _0x1709de=await currencyService_1['currencyService'][_0x3bce8c(0x133)](_0x113312[_0x3bce8c(0x1d7)],_0x113312[_0x3bce8c(0x113)]),_0x4db6a1=_0x113312[_0x3bce8c(0x1dd)],_0x1288ca=_0x1709de-_0x4db6a1;_0x24df7b+=_0x1288ca;}}const _0x2547cf=_0x2c8207>0x0?_0x48e0e4/_0x2c8207:0x0,_0x1a66dd=this[_0x3bce8c(0x1b0)](_0x1bdae1,_0x4f78ec,_0x515e06),_0x314aad=await database_1[_0x3bce8c(0x153)]['payment']['count']({'where':{'createdAt':{'gte':_0x4f78ec},'gateway':{'not':'test_gateway'}}}),_0x137e4c=_0x314aad>0x0?_0x2c8207/_0x314aad*0x64:0x0;return{'totalShops':_0x1998ee,'activeShops':_0x37edda,'totalPayments':_0x2c8207,'successfulPayments':_0x2c8207,'totalAttempts':_0x314aad,'totalRevenue':Math['round'](_0x48e0e4*0x64)/0x64,'trapayEarnings':Math[_0x3bce8c(0x1d1)](_0x24df7b*0x64)/0x64,'averagePaymentAmount':Math[_0x3bce8c(0x1d1)](_0x2547cf*0x64)/0x64,'conversionRate':Math[_0x3bce8c(0x1d1)](_0x137e4c*0x64)/0x64,'dailyRevenue':_0x1a66dd['dailyRevenue'],'dailyPayments':_0x1a66dd[_0x3bce8c(0x1e5)],'recentPayments':_0x1f569e[_0x3bce8c(0x180)](_0x101c78=>({'id':_0x101c78['id'],'amount':_0x101c78[_0x3bce8c(0x1d7)],'currency':_0x101c78[_0x3bce8c(0x113)],'status':_0x101c78[_0x3bce8c(0x182)],'gateway':_0x101c78[_0x3bce8c(0x10a)],'shop':_0x101c78[_0x3bce8c(0x1bc)],'createdAt':_0x101c78['createdAt']}))};}async[a36_0x3bf6cf(0x165)](_0x4601e6){const _0x35bd98=a36_0x3bf6cf;console[_0x35bd98(0xfa)](_0x35bd98(0x1a7),_0x4601e6);let _0x4f0c53,_0x5a4408=new Date();if(_0x4601e6['period']===_0x35bd98(0x172)&&_0x4601e6[_0x35bd98(0x12e)]&&_0x4601e6[_0x35bd98(0x14c)])_0x4f0c53=new Date(_0x4601e6[_0x35bd98(0x12e)]),_0x5a4408=new Date(_0x4601e6[_0x35bd98(0x14c)]);else{const _0x5bce9b=new Date();switch(_0x4601e6[_0x35bd98(0xd2)]){case _0x35bd98(0xc7):_0x4f0c53=new Date(_0x5bce9b[_0x35bd98(0x162)]()-0x7*0x18*0x3c*0x3c*0x3e8);break;case _0x35bd98(0x136):_0x4f0c53=new Date(_0x5bce9b[_0x35bd98(0x162)]()-0x1e*0x18*0x3c*0x3c*0x3e8);break;case'year':_0x4f0c53=new Date(_0x5bce9b[_0x35bd98(0x162)]()-0x16d*0x18*0x3c*0x3c*0x3e8);break;case'all':default:_0x4f0c53=new Date(_0x35bd98(0x1ee));break;}}console[_0x35bd98(0xfa)](_0x35bd98(0xb6)+_0x4f0c53['toISOString']()+_0x35bd98(0x1ab)+_0x5a4408[_0x35bd98(0xb5)]());const _0x297ff4={'status':_0x35bd98(0x14e),'gateway':{'not':_0x35bd98(0x1e6)},'paidAt':{'gte':_0x4f0c53,'lte':_0x5a4408}};_0x4601e6['shopId']&&(_0x297ff4[_0x35bd98(0x130)]=_0x4601e6[_0x35bd98(0x130)]);const _0x433338=await database_1[_0x35bd98(0x153)][_0x35bd98(0x193)][_0x35bd98(0xbe)]({'where':_0x297ff4,'include':{'shop':{'select':{'id':!![],'name':!![],'username':!![],'gatewaySettings':!![]}}}});console[_0x35bd98(0xfa)]('💰\x20Found\x20'+_0x433338[_0x35bd98(0x18c)]+_0x35bd98(0x123));const _0x1a3d02={'gateway':{'not':_0x35bd98(0x1e6)},'createdAt':{'gte':_0x4f0c53,'lte':_0x5a4408}};_0x4601e6[_0x35bd98(0x130)]&&(_0x1a3d02['shopId']=_0x4601e6[_0x35bd98(0x130)]);const _0x5c18ca=await database_1[_0x35bd98(0x153)][_0x35bd98(0x193)][_0x35bd98(0x11f)]({'where':_0x1a3d02});console[_0x35bd98(0xfa)](_0x35bd98(0xe4)+_0x5c18ca+_0x35bd98(0x114)+_0x433338[_0x35bd98(0x18c)]);let _0x912784=0x0,_0x4dc3cd=0x0,_0x38dc51=0x0;const _0x374967={},_0x2c08bd={},_0x148c36={};for(const _0x4f8214 of _0x433338){try{const _0x55c191=await currencyService_1[_0x35bd98(0x197)]['convertToUSDT'](_0x4f8214[_0x35bd98(0x1d7)],_0x4f8214['currency']);let _0x3c2c97={};if(_0x4f8214[_0x35bd98(0x1bc)][_0x35bd98(0xf8)])try{_0x3c2c97=JSON['parse'](_0x4f8214['shop'][_0x35bd98(0xf8)]);}catch(_0x57437e){console['error']('Error\x20parsing\x20gateway\x20settings\x20for\x20shop\x20'+_0x4f8214[_0x35bd98(0x130)]+':',_0x57437e);}let _0x2e737={},_0x5857d7=0xa;for(const [_0x2e178a,_0x286411]of Object[_0x35bd98(0x141)](_0x3c2c97)){if(_0x2e178a[_0x35bd98(0x100)]()===_0x4f8214[_0x35bd98(0x10a)]['toLowerCase']()){_0x2e737=_0x286411,_0x5857d7=_0x286411['commission']||0xa;break;}}let _0x348640,_0x1e23e8;_0x4f8214[_0x35bd98(0x1dd)]!==null&&_0x4f8214[_0x35bd98(0x1dd)]!==undefined?(_0x348640=_0x4f8214[_0x35bd98(0x1dd)],_0x1e23e8=_0x55c191-_0x348640,console[_0x35bd98(0xfa)](_0x35bd98(0x15d)+_0x348640['toFixed'](0x6)+'\x20USDT\x20for\x20payment\x20'+_0x4f8214['id'])):(_0x1e23e8=_0x55c191*(_0x5857d7/0x64),_0x348640=_0x55c191-_0x1e23e8,console[_0x35bd98(0xfa)](_0x35bd98(0x18e)+_0x4f8214['id']+':\x20'+_0x5857d7+_0x35bd98(0x191)+_0x55c191['toFixed'](0x6)+_0x35bd98(0xda)));_0x912784+=_0x55c191,_0x4dc3cd+=_0x348640,_0x38dc51+=_0x1e23e8;!_0x374967[_0x4f8214['gateway']]&&(_0x374967[_0x4f8214[_0x35bd98(0x10a)]]={'gateway':_0x4f8214[_0x35bd98(0x10a)],'gatewayDisplayName':this[_0x35bd98(0x137)](_0x4f8214[_0x35bd98(0x10a)]),'paymentsCount':0x0,'turnoverUSDT':0x0,'commissionUSDT':0x0,'merchantEarningsUSDT':0x0,'totalCommissionRate':0x0});_0x374967[_0x4f8214[_0x35bd98(0x10a)]][_0x35bd98(0x11d)]++,_0x374967[_0x4f8214['gateway']][_0x35bd98(0x116)]+=_0x55c191,_0x374967[_0x4f8214[_0x35bd98(0x10a)]][_0x35bd98(0x19b)]+=_0x1e23e8,_0x374967[_0x4f8214[_0x35bd98(0x10a)]][_0x35bd98(0x11b)]+=_0x348640,_0x374967[_0x4f8214['gateway']][_0x35bd98(0x148)]+=_0x5857d7;!_0x4601e6[_0x35bd98(0x130)]&&(!_0x2c08bd[_0x4f8214['shopId']]&&(_0x2c08bd[_0x4f8214[_0x35bd98(0x130)]]={'shopId':_0x4f8214['shopId'],'shopName':_0x4f8214[_0x35bd98(0x1bc)]['name'],'shopUsername':_0x4f8214[_0x35bd98(0x1bc)][_0x35bd98(0xbc)],'paymentsCount':0x0,'turnoverUSDT':0x0,'commissionUSDT':0x0,'merchantEarningsUSDT':0x0,'paidOutUSDT':0x0,'averageCheckUSDT':0x0}),_0x2c08bd[_0x4f8214[_0x35bd98(0x130)]][_0x35bd98(0x11d)]++,_0x2c08bd[_0x4f8214[_0x35bd98(0x130)]][_0x35bd98(0x116)]+=_0x55c191,_0x2c08bd[_0x4f8214[_0x35bd98(0x130)]][_0x35bd98(0x19b)]+=_0x1e23e8,_0x2c08bd[_0x4f8214[_0x35bd98(0x130)]][_0x35bd98(0x11b)]+=_0x348640);const _0x457c21=_0x4f8214[_0x35bd98(0xe0)][_0x35bd98(0xb5)]()[_0x35bd98(0xc4)]('T')[0x0];!_0x148c36[_0x457c21]&&(_0x148c36[_0x457c21]={'date':_0x457c21,'turnover':0x0,'merchantEarnings':0x0,'gatewayEarnings':0x0,'paymentsCount':0x0}),_0x148c36[_0x457c21]['turnover']+=_0x55c191,_0x148c36[_0x457c21][_0x35bd98(0x169)]+=_0x348640,_0x148c36[_0x457c21]['gatewayEarnings']+=_0x1e23e8,_0x148c36[_0x457c21][_0x35bd98(0x11d)]++;}catch(_0x7881d6){console[_0x35bd98(0x198)](_0x35bd98(0x1e4)+_0x4f8214['id']+':',_0x7881d6);}}Object[_0x35bd98(0x1a4)](_0x374967)[_0x35bd98(0x195)](_0x55bbf4=>{const _0x4e48e2=_0x35bd98;_0x55bbf4[_0x4e48e2(0x1ba)]=_0x55bbf4[_0x4e48e2(0x11d)]>0x0?_0x55bbf4['totalCommissionRate']/_0x55bbf4[_0x4e48e2(0x11d)]:0x0,delete _0x55bbf4[_0x4e48e2(0x148)];}),Object['values'](_0x2c08bd)[_0x35bd98(0x195)](_0x96ab=>{const _0x495cd0=_0x35bd98;_0x96ab[_0x495cd0(0x117)]=_0x96ab[_0x495cd0(0x11d)]>0x0?_0x96ab[_0x495cd0(0x116)]/_0x96ab[_0x495cd0(0x11d)]:0x0;});let _0x5edb2c=0x0,_0x30d6fc=0x0;if(_0x4601e6[_0x35bd98(0x130)]){const _0x1c0330=await database_1['default'][_0x35bd98(0x1ae)]['findMany']({'where':{'shopId':_0x4601e6[_0x35bd98(0x130)],'status':'COMPLETED','createdAt':{'gte':_0x4f0c53,'lte':_0x5a4408}},'select':{'amount':!![]}});_0x5edb2c=_0x1c0330['reduce']((_0x1e0f07,_0x3ec1dc)=>_0x1e0f07+_0x3ec1dc[_0x35bd98(0x1d7)],0x0);const _0x3cc5e6=await database_1['default'][_0x35bd98(0x1ae)][_0x35bd98(0xbe)]({'where':{'shopId':_0x4601e6['shopId'],'status':_0x35bd98(0x1df),'createdAt':{'gte':_0x4f0c53,'lte':_0x5a4408}},'select':{'amount':!![]}});_0x30d6fc=_0x3cc5e6['reduce']((_0x842442,_0x12b4fa)=>_0x842442+_0x12b4fa[_0x35bd98(0x1d7)],0x0);}const _0x37b2f8=_0x5c18ca,_0x4681a5=_0x433338[_0x35bd98(0x18c)],_0x41831e=_0x4681a5>0x0?_0x912784/_0x4681a5:0x0,_0x25a52f=_0x37b2f8>0x0?Math[_0x35bd98(0x1d1)](_0x4681a5/_0x37b2f8*0x2710)/0x64:0x0,_0x2db7b5=Math[_0x35bd98(0x14f)]((_0x5a4408[_0x35bd98(0x162)]()-_0x4f0c53['getTime']())/(0x3e8*0x3c*0x3c*0x18)),_0x5e3991={'totalTurnover':Math[_0x35bd98(0x1d1)](_0x912784*0x64)/0x64,'merchantEarnings':Math[_0x35bd98(0x1d1)](_0x4dc3cd*0x64)/0x64,'gatewayEarnings':Math['round'](_0x38dc51*0x64)/0x64,'totalPaidOut':Math[_0x35bd98(0x1d1)](_0x5edb2c*0x64)/0x64,'pendingPayout':Math[_0x35bd98(0x1d1)](_0x30d6fc*0x64)/0x64,'averageCheck':Math[_0x35bd98(0x1d1)](_0x41831e*0x64)/0x64,'totalPayments':_0x37b2f8,'successfulPayments':_0x4681a5,'conversionRate':_0x25a52f,'gatewayBreakdown':Object['values'](_0x374967)[_0x35bd98(0x180)](_0xdd3237=>({..._0xdd3237,'turnoverUSDT':Math[_0x35bd98(0x1d1)](_0xdd3237[_0x35bd98(0x116)]*0x64)/0x64,'commissionUSDT':Math[_0x35bd98(0x1d1)](_0xdd3237[_0x35bd98(0x19b)]*0x64)/0x64,'merchantEarningsUSDT':Math[_0x35bd98(0x1d1)](_0xdd3237['merchantEarningsUSDT']*0x64)/0x64,'averageCommissionRate':Math['round'](_0xdd3237[_0x35bd98(0x1ba)]*0x64)/0x64})),'merchantBreakdown':_0x4601e6[_0x35bd98(0x130)]?undefined:Object[_0x35bd98(0x1a4)](_0x2c08bd)[_0x35bd98(0x180)](_0x479fc8=>({..._0x479fc8,'turnoverUSDT':Math[_0x35bd98(0x1d1)](_0x479fc8[_0x35bd98(0x116)]*0x64)/0x64,'commissionUSDT':Math[_0x35bd98(0x1d1)](_0x479fc8[_0x35bd98(0x19b)]*0x64)/0x64,'merchantEarningsUSDT':Math[_0x35bd98(0x1d1)](_0x479fc8[_0x35bd98(0x11b)]*0x64)/0x64,'paidOutUSDT':Math[_0x35bd98(0x1d1)](_0x479fc8[_0x35bd98(0x15e)]*0x64)/0x64,'averageCheckUSDT':Math[_0x35bd98(0x1d1)](_0x479fc8['averageCheckUSDT']*0x64)/0x64})),'dailyData':Object[_0x35bd98(0x1a4)](_0x148c36)[_0x35bd98(0x180)](_0x5ba835=>({..._0x5ba835,'turnover':Math[_0x35bd98(0x1d1)](_0x5ba835[_0x35bd98(0xb0)]*0x64)/0x64,'merchantEarnings':Math[_0x35bd98(0x1d1)](_0x5ba835['merchantEarnings']*0x64)/0x64,'gatewayEarnings':Math['round'](_0x5ba835[_0x35bd98(0x1cd)]*0x64)/0x64}))[_0x35bd98(0x166)]((_0x48ef9a,_0x9e503c)=>_0x48ef9a[_0x35bd98(0x1a8)][_0x35bd98(0x12c)](_0x9e503c['date'])),'periodInfo':{'from':_0x4f0c53,'to':_0x5a4408,'periodType':_0x4601e6[_0x35bd98(0xd2)]||_0x35bd98(0x172),'daysCount':_0x2db7b5}};return console[_0x35bd98(0xfa)]('📊\x20Merchant\x20statistics\x20calculated:'),console[_0x35bd98(0xfa)]('\x20\x20\x20💰\x20Total\x20turnover:\x20'+_0x5e3991[_0x35bd98(0xe7)]+_0x35bd98(0xda)),console[_0x35bd98(0xfa)](_0x35bd98(0xac)+_0x5e3991[_0x35bd98(0x169)]+_0x35bd98(0xda)),console['log'](_0x35bd98(0x12b)+_0x5e3991['gatewayEarnings']+_0x35bd98(0xda)),console[_0x35bd98(0xfa)](_0x35bd98(0x14b)+_0x5e3991[_0x35bd98(0x1b4)]+_0x35bd98(0xda)),console['log'](_0x35bd98(0x16d)+_0x5e3991[_0x35bd98(0x158)]+_0x35bd98(0xda)),console['log'](_0x35bd98(0xd4)+_0x5e3991[_0x35bd98(0x1b2)]),_0x5e3991;}async[a36_0x3bf6cf(0x1a9)](){const _0x33b78d=a36_0x3bf6cf;console[_0x33b78d(0xfa)](_0x33b78d(0x1c4));const _0xfebd8d=await database_1[_0x33b78d(0x153)][_0x33b78d(0x1bc)][_0x33b78d(0xbe)]({'where':{'status':_0x33b78d(0xaa)},'select':{'id':!![],'username':!![],'name':!![]},'orderBy':{'name':'asc'}});return console[_0x33b78d(0xfa)]('📋\x20Found\x20'+_0xfebd8d[_0x33b78d(0x18c)]+_0x33b78d(0x131)),_0xfebd8d[_0x33b78d(0x180)](_0x189968=>({'id':_0x189968['id'],'username':_0x189968[_0x33b78d(0xbc)],'name':_0x189968[_0x33b78d(0xb2)]}));}[a36_0x3bf6cf(0x137)](_0x4bda69){const _0x49e745=a36_0x3bf6cf,_0x50e7d1={'test_gateway':_0x49e745(0x124),'plisio':_0x49e745(0x147),'rapyd':_0x49e745(0xd9),'noda':_0x49e745(0x1e8),'cointopay':_0x49e745(0xa8),'cointopay2':_0x49e745(0xe6),'klyme_eu':_0x49e745(0x13d),'klyme_gb':_0x49e745(0x126),'klyme_de':_0x49e745(0x1b9),'mastercard':_0x49e745(0x173)};return _0x50e7d1[_0x4bda69]||_0x4bda69;}[a36_0x3bf6cf(0x17c)](_0x217bb6){const _0x1dadbc=a36_0x3bf6cf,_0x40d14a={'Test\x20Gateway':_0x1dadbc(0x1e6),'Plisio':_0x1dadbc(0x129),'Rapyd':'rapyd','Noda':_0x1dadbc(0xae),'CoinToPay':_0x1dadbc(0x1da),'CoinToPay2':'cointopay2','KLYME\x20EU':_0x1dadbc(0x1d0),'KLYME\x20GB':_0x1dadbc(0xf6),'KLYME\x20DE':'klyme_de','MasterCard':_0x1dadbc(0xde)};return _0x40d14a[_0x217bb6]||_0x217bb6[_0x1dadbc(0x100)]();}async['getMerchantsAwaitingPayout'](_0x542e49){const _0x13ba07=a36_0x3bf6cf,{page:_0x8c51b6,limit:_0x149a9b,minAmount:_0x45a431,search:_0x32ab30}=_0x542e49,_0x560598=(_0x8c51b6-0x1)*_0x149a9b;console[_0x13ba07(0xfa)](_0x13ba07(0xce),_0x542e49);const _0x6bc2e={'balance':{'gt':0x0},'status':'ACTIVE'};_0x45a431&&(_0x6bc2e[_0x13ba07(0x178)][_0x13ba07(0xfd)]=_0x45a431);_0x32ab30&&(_0x6bc2e['OR']=[{'name':{'contains':_0x32ab30,'mode':_0x13ba07(0xbf)}},{'username':{'contains':_0x32ab30,'mode':'insensitive'}}]);const [_0x47e28d,_0x59a42a]=await Promise[_0x13ba07(0x1a0)]([database_1[_0x13ba07(0x153)]['shop'][_0x13ba07(0xbe)]({'where':_0x6bc2e,'skip':_0x560598,'take':_0x149a9b,'orderBy':{'balance':'desc'},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'balance':!![],'totalPaidOut':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'gatewaySettings':!![],'createdAt':!![]}}),database_1[_0x13ba07(0x153)]['shop']['count']({'where':_0x6bc2e})]);console[_0x13ba07(0xfa)]('💰\x20Found\x20'+_0x47e28d[_0x13ba07(0x18c)]+_0x13ba07(0x11c));const _0x3fb6bc=await Promise['all'](_0x47e28d['map'](async _0x1b9a68=>{const _0x38af2a=_0x13ba07,[_0x524f7b,_0x39a165,_0x1b852b]=await Promise[_0x38af2a(0x1a0)]([database_1[_0x38af2a(0x153)][_0x38af2a(0x193)][_0x38af2a(0x11f)]({'where':{'shopId':_0x1b9a68['id'],'status':_0x38af2a(0x14e),'gateway':{'not':_0x38af2a(0x1e6)}}}),database_1[_0x38af2a(0x153)][_0x38af2a(0x193)][_0x38af2a(0x1c7)]({'where':{'shopId':_0x1b9a68['id'],'status':_0x38af2a(0x14e),'gateway':{'not':_0x38af2a(0x1e6)}},'orderBy':{'paidAt':_0x38af2a(0xe9)},'select':{'paidAt':!![]}}),database_1[_0x38af2a(0x153)][_0x38af2a(0x193)]['groupBy']({'by':[_0x38af2a(0x10a)],'where':{'shopId':_0x1b9a68['id'],'status':_0x38af2a(0x14e),'gateway':{'not':_0x38af2a(0x1e6)}},'_count':{'id':!![]},'_sum':{'amountUSDT':!![]}})]),_0x50d0ac=new Date(),_0x5b9e76=new Date(_0x50d0ac[_0x38af2a(0x101)](),_0x50d0ac[_0x38af2a(0xf0)](),0x1),_0x4a39f1=new Date(_0x50d0ac[_0x38af2a(0x101)](),_0x50d0ac['getMonth']()+0x1,0x0,0x17,0x3b,0x3b,0x3e7),[_0x36c0e7,_0x18e77c]=await Promise['all']([database_1[_0x38af2a(0x153)][_0x38af2a(0x1ae)][_0x38af2a(0xf5)]({'_sum':{'amount':!![]},'where':{'shopId':_0x1b9a68['id'],'status':_0x38af2a(0x1a5)}}),database_1[_0x38af2a(0x153)][_0x38af2a(0x1ae)][_0x38af2a(0xf5)]({'_sum':{'amount':!![]},'where':{'shopId':_0x1b9a68['id'],'status':_0x38af2a(0x1a5),'createdAt':{'gte':_0x5b9e76,'lte':_0x4a39f1}}})]),_0x11f9e0=_0x36c0e7[_0x38af2a(0x159)]['amount']||0x0,_0x3ff5bf=_0x18e77c[_0x38af2a(0x159)][_0x38af2a(0x1d7)]||0x0,_0x4ac675=await Promise[_0x38af2a(0x1a0)](_0x1b852b['map'](async _0x37eef7=>{const _0x2359ba=_0x38af2a;let _0x3ab5d8=0xa;if(_0x1b9a68[_0x2359ba(0xf8)])try{const _0x4bbce5=JSON['parse'](_0x1b9a68['gatewaySettings']);for(const [_0x4425ab,_0x287767]of Object[_0x2359ba(0x141)](_0x4bbce5)){if(_0x4425ab[_0x2359ba(0x100)]()===_0x37eef7[_0x2359ba(0x10a)][_0x2359ba(0x100)]()){_0x3ab5d8=_0x287767[_0x2359ba(0x13c)]||0xa,console[_0x2359ba(0xfa)](_0x2359ba(0x1dc)+_0x37eef7[_0x2359ba(0x10a)]+_0x2359ba(0x102)+_0x1b9a68['id']+_0x2359ba(0x1ad)+_0x3ab5d8+'%');break;}}}catch(_0x4787f0){console[_0x2359ba(0x198)](_0x2359ba(0x144)+_0x1b9a68['id']+':',_0x4787f0);}const _0x49a743=_0x37eef7[_0x2359ba(0x159)]?.[_0x2359ba(0x10e)]||0x0,_0x5edaa3=_0x49a743*(0x1-_0x3ab5d8/0x64);return{'gateway':_0x37eef7['gateway'],'count':_0x37eef7[_0x2359ba(0x132)]?.['id']||0x0,'amountUSDT':Math[_0x2359ba(0x1d1)](_0x49a743*0x64)/0x64,'amountAfterCommissionUSDT':Math['round'](_0x5edaa3*0x64)/0x64,'commission':_0x3ab5d8};})),_0x47d74e=_0x4ac675[_0x38af2a(0x196)]((_0x404fea,_0x380872)=>_0x404fea+_0x380872['amountUSDT'],0x0),_0x2bd81a=_0x1b9a68[_0x38af2a(0x178)];return console['log'](_0x38af2a(0x125)+_0x1b9a68['username']+':'),console[_0x38af2a(0xfa)](_0x38af2a(0x190)+_0x47d74e[_0x38af2a(0xab)](0x2)+_0x38af2a(0x10c)),console['log'](_0x38af2a(0x156)+_0x4ac675['reduce']((_0x2847b5,_0x568b5c)=>_0x2847b5+_0x568b5c['amountAfterCommissionUSDT'],0x0)[_0x38af2a(0xab)](0x2)+_0x38af2a(0x183)),console[_0x38af2a(0xfa)](_0x38af2a(0x139)+_0x2bd81a[_0x38af2a(0xab)](0x2)+_0x38af2a(0x14d)),{'id':_0x1b9a68['id'],'fullName':_0x1b9a68[_0x38af2a(0xb2)],'username':_0x1b9a68[_0x38af2a(0xbc)],'telegramId':_0x1b9a68['telegram'],'merchantUrl':_0x1b9a68['shopUrl'],'wallets':{'usdtPolygonWallet':_0x1b9a68['usdtPolygonWallet'],'usdtTrcWallet':_0x1b9a68[_0x38af2a(0x16a)],'usdtErcWallet':_0x1b9a68[_0x38af2a(0x1b6)],'usdcPolygonWallet':_0x1b9a68[_0x38af2a(0x1e0)]},'totalAmountUSDT':Math[_0x38af2a(0x1d1)](_0x47d74e*0x64)/0x64,'totalAmountAfterCommissionUSDT':Math[_0x38af2a(0x1d1)](_0x2bd81a*0x64)/0x64,'totalPayout':Math[_0x38af2a(0x1d1)](_0x11f9e0*0x64)/0x64,'thisMonth':Math[_0x38af2a(0x1d1)](_0x3ff5bf*0x64)/0x64,'paymentsCount':_0x524f7b,'oldestPaymentDate':_0x39a165?.['paidAt']||_0x1b9a68['createdAt'],'gatewayBreakdown':_0x4ac675};})),_0x19c731=_0x3fb6bc[_0x13ba07(0x196)]((_0x11cf6d,_0x1ab1a0)=>_0x11cf6d+_0x1ab1a0[_0x13ba07(0xc2)],0x0),_0x387f46=_0x3fb6bc[_0x13ba07(0x196)]((_0x18fafc,_0x24539a)=>_0x18fafc+_0x24539a['totalAmountAfterCommissionUSDT'],0x0),_0x3d4225=_0x3fb6bc['reduce']((_0x2d9014,_0x869a0b)=>_0x2d9014+_0x869a0b[_0x13ba07(0x18b)],0x0),_0x53cc6d=_0x3fb6bc[_0x13ba07(0x196)]((_0x1c9608,_0xa25532)=>_0x1c9608+_0xa25532[_0x13ba07(0x10b)],0x0);return console[_0x13ba07(0xfa)]('📊\x20Merchants\x20awaiting\x20payout:\x20'+_0x59a42a+_0x13ba07(0x1c3)),console['log']('\x20\x20\x20💰\x20Total\x20payments\x20turnover:\x20'+Math[_0x13ba07(0x1d1)](_0x19c731*0x64)/0x64+_0x13ba07(0x10c)),console['log'](_0x13ba07(0x1b5)+Math[_0x13ba07(0x1d1)](_0x387f46*0x64)/0x64+'\x20USDT\x20(actual\x20balances)'),console[_0x13ba07(0xfa)](_0x13ba07(0x11a)+Math[_0x13ba07(0x1d1)](_0x3d4225*0x64)/0x64+'\x20USDT'),console[_0x13ba07(0xfa)]('\x20\x20\x20📅\x20Total\x20payouts\x20(this\x20month):\x20'+Math[_0x13ba07(0x1d1)](_0x53cc6d*0x64)/0x64+'\x20USDT'),{'merchants':_0x3fb6bc,'pagination':{'page':_0x8c51b6,'limit':_0x149a9b,'total':_0x59a42a,'totalPages':Math[_0x13ba07(0x14f)](_0x59a42a/_0x149a9b)},'summary':{'totalMerchants':_0x59a42a,'totalAmountUSDT':Math[_0x13ba07(0x1d1)](_0x19c731*0x64)/0x64,'totalAmountAfterCommissionUSDT':Math['round'](_0x387f46*0x64)/0x64,'totalPayout':Math[_0x13ba07(0x1d1)](_0x3d4225*0x64)/0x64,'thisMonth':Math['round'](_0x53cc6d*0x64)/0x64}};}async[a36_0x3bf6cf(0xd7)](_0x48fbc8){const _0x411b45=a36_0x3bf6cf,{shopId:_0x1bf09b,amount:_0x3d6b22,network:_0x177065,wallet:_0x3abe21,notes:_0x1b1f6a,txid:_0x3019d3,periodFrom:_0x2b7108,periodTo:_0x7113f1}=_0x48fbc8,_0x5d9dc0=await database_1[_0x411b45(0x153)]['$transaction'](async _0xcfe03d=>{const _0xdffbe7=_0x411b45,_0x1261a7=await _0xcfe03d[_0xdffbe7(0x1bc)]['findUnique']({'where':{'id':_0x1bf09b},'select':{'id':!![],'name':!![],'username':!![],'balance':!![],'totalPaidOut':!![]}});if(!_0x1261a7)throw new Error(_0xdffbe7(0x1d2));console[_0xdffbe7(0xfa)]('💰\x20Creating\x20payout\x20for\x20shop\x20'+_0x1261a7[_0xdffbe7(0xbc)]+':'),console[_0xdffbe7(0xfa)](_0xdffbe7(0x1cc)+_0x1261a7[_0xdffbe7(0x178)][_0xdffbe7(0xab)](0x6)+'\x20USDT'),console[_0xdffbe7(0xfa)](_0xdffbe7(0x108)+_0x3d6b22[_0xdffbe7(0xab)](0x6)+_0xdffbe7(0xda)),console['log'](_0xdffbe7(0x1c8)+_0x1261a7['totalPaidOut'][_0xdffbe7(0xab)](0x6)+_0xdffbe7(0xda));if(_0x3019d3)console[_0xdffbe7(0xfa)]('\x20\x20\x20Transaction\x20hash:\x20'+_0x3019d3);if(_0x1261a7[_0xdffbe7(0x178)]<_0x3d6b22)throw new Error(_0xdffbe7(0xad)+_0x1261a7[_0xdffbe7(0x178)][_0xdffbe7(0xab)](0x6)+_0xdffbe7(0x142)+_0x3d6b22[_0xdffbe7(0xab)](0x6)+_0xdffbe7(0xda));let _0xa02426=_0x3abe21;if(!_0xa02426){const _0x4b6de2=await _0xcfe03d[_0xdffbe7(0x1bc)][_0xdffbe7(0xb3)]({'where':{'id':_0x1bf09b},'select':{'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![]}});if(_0x4b6de2)switch(_0x177065){case _0xdffbe7(0x12d):_0xa02426=_0x4b6de2[_0xdffbe7(0x128)]||undefined;break;case'trc20':_0xa02426=_0x4b6de2[_0xdffbe7(0x16a)]||undefined;break;case _0xdffbe7(0x1d4):_0xa02426=_0x4b6de2[_0xdffbe7(0x1b6)]||undefined;break;case _0xdffbe7(0xea):_0xa02426=_0x4b6de2['usdcPolygonWallet']||undefined;break;}}console[_0xdffbe7(0xfa)]('💳\x20Payout\x20wallet\x20for\x20'+_0x177065+':\x20'+(_0xa02426||'not\x20specified'));const _0x44d97a=await _0xcfe03d['payout'][_0xdffbe7(0x179)]({'data':{'shopId':_0x1bf09b,'amount':_0x3d6b22,'network':_0x177065,'status':'COMPLETED','txid':_0x3019d3,'notes':_0x1b1f6a,'periodFrom':_0x2b7108?new Date(_0x2b7108):null,'periodTo':_0x7113f1?new Date(_0x7113f1):null,'createdAt':new Date(),'paidAt':new Date()}}),_0x3d2fbb=_0x1261a7['balance']-_0x3d6b22,_0x38106c=_0x1261a7['totalPaidOut']+_0x3d6b22;return await _0xcfe03d[_0xdffbe7(0x1bc)]['update']({'where':{'id':_0x1bf09b},'data':{'balance':_0x3d2fbb,'totalPaidOut':_0x38106c}}),console[_0xdffbe7(0xfa)](_0xdffbe7(0x16e)+_0x1261a7['username']+_0xdffbe7(0x107)),console[_0xdffbe7(0xfa)](_0xdffbe7(0xca)+_0x1261a7[_0xdffbe7(0x178)][_0xdffbe7(0xab)](0x6)+_0xdffbe7(0x122)+_0x3d2fbb[_0xdffbe7(0xab)](0x6)+_0xdffbe7(0xd6)+_0x3d6b22['toFixed'](0x6)+')'),console[_0xdffbe7(0xfa)](_0xdffbe7(0x17f)+_0x1261a7[_0xdffbe7(0x1b4)]['toFixed'](0x6)+'\x20->\x20'+_0x38106c[_0xdffbe7(0xab)](0x6)+_0xdffbe7(0x146)+_0x3d6b22['toFixed'](0x6)+')'),{'payout':_0x44d97a,'shop':_0x1261a7};});return console[_0x411b45(0xfa)](_0x411b45(0x121)+_0x5d9dc0['payout']['id']+_0x411b45(0x102)+_0x5d9dc0['shop'][_0x411b45(0xbc)]+'\x20('+_0x3d6b22+_0x411b45(0xe2)),{'id':_0x5d9dc0[_0x411b45(0x1ae)]['id'],'shopId':_0x5d9dc0['payout'][_0x411b45(0x130)],'shopName':_0x5d9dc0['shop'][_0x411b45(0xb2)],'shopUsername':_0x5d9dc0[_0x411b45(0x1bc)][_0x411b45(0xbc)],'amount':_0x5d9dc0[_0x411b45(0x1ae)][_0x411b45(0x1d7)],'network':_0x5d9dc0[_0x411b45(0x1ae)][_0x411b45(0xe1)],'status':_0x5d9dc0['payout']['status'],'txid':_0x5d9dc0[_0x411b45(0x1ae)][_0x411b45(0xeb)],'notes':_0x5d9dc0[_0x411b45(0x1ae)]['notes'],'periodFrom':_0x5d9dc0[_0x411b45(0x1ae)][_0x411b45(0x171)],'periodTo':_0x5d9dc0[_0x411b45(0x1ae)][_0x411b45(0xf7)],'createdAt':_0x5d9dc0['payout'][_0x411b45(0x118)],'paidAt':_0x5d9dc0[_0x411b45(0x1ae)][_0x411b45(0xe0)]};}async[a36_0x3bf6cf(0x188)](_0x33d865){const _0x515abc=a36_0x3bf6cf,{page:_0x323b70,limit:_0xd0cb77,shopId:_0x59e871,network:_0x10369a,dateFrom:_0x1cb9f5,dateTo:_0xee94a8,search:_0xaa9eaf}=_0x33d865,_0xcd93fe=(_0x323b70-0x1)*_0xd0cb77,_0x540664={};_0x59e871&&(_0x540664[_0x515abc(0x130)]=_0x59e871);_0x10369a&&(_0x540664[_0x515abc(0xe1)]=_0x10369a);(_0x1cb9f5||_0xee94a8)&&(_0x540664[_0x515abc(0x118)]={},_0x1cb9f5&&(_0x540664[_0x515abc(0x118)][_0x515abc(0xfd)]=new Date(_0x1cb9f5)),_0xee94a8&&(_0x540664[_0x515abc(0x118)][_0x515abc(0x12a)]=new Date(_0xee94a8)));_0xaa9eaf&&(_0x540664['OR']=[{'shop':{'name':{'contains':_0xaa9eaf,'mode':_0x515abc(0xbf)}}},{'shop':{'username':{'contains':_0xaa9eaf,'mode':_0x515abc(0xbf)}}},{'notes':{'contains':_0xaa9eaf,'mode':_0x515abc(0xbf)}}]);const [_0x32ef95,_0x1ce22a]=await Promise['all']([database_1[_0x515abc(0x153)][_0x515abc(0x1ae)][_0x515abc(0xbe)]({'where':_0x540664,'skip':_0xcd93fe,'take':_0xd0cb77,'orderBy':{'createdAt':_0x515abc(0x13a)},'select':{'id':!![],'shopId':!![],'amount':!![],'network':!![],'status':!![],'txid':!![],'notes':!![],'periodFrom':!![],'periodTo':!![],'createdAt':!![],'paidAt':!![],'shop':{'select':{'name':!![],'username':!![]}}}}),database_1[_0x515abc(0x153)][_0x515abc(0x1ae)]['count']({'where':_0x540664})]);return{'payouts':_0x32ef95[_0x515abc(0x180)](_0xe3a6d0=>({'id':_0xe3a6d0['id'],'shopId':_0xe3a6d0[_0x515abc(0x130)],'shopName':_0xe3a6d0[_0x515abc(0x1bc)][_0x515abc(0xb2)],'shopUsername':_0xe3a6d0[_0x515abc(0x1bc)][_0x515abc(0xbc)],'amount':_0xe3a6d0[_0x515abc(0x1d7)],'network':_0xe3a6d0[_0x515abc(0xe1)],'status':_0xe3a6d0[_0x515abc(0x182)],'txid':_0xe3a6d0[_0x515abc(0xeb)],'notes':_0xe3a6d0['notes'],'periodFrom':_0xe3a6d0[_0x515abc(0x171)],'periodTo':_0xe3a6d0['periodTo'],'createdAt':_0xe3a6d0[_0x515abc(0x118)],'paidAt':_0xe3a6d0[_0x515abc(0xe0)]})),'pagination':{'page':_0x323b70,'limit':_0xd0cb77,'total':_0x1ce22a,'totalPages':Math['ceil'](_0x1ce22a/_0xd0cb77)}};}async['getPayoutById'](_0x12c8fe){const _0x2f7c06=a36_0x3bf6cf,_0x4546d4=await database_1[_0x2f7c06(0x153)]['payout'][_0x2f7c06(0xb3)]({'where':{'id':_0x12c8fe},'include':{'shop':{'select':{'name':!![],'username':!![]}}}});if(!_0x4546d4)return null;return{'id':_0x4546d4['id'],'shopId':_0x4546d4[_0x2f7c06(0x130)],'shopName':_0x4546d4[_0x2f7c06(0x1bc)][_0x2f7c06(0xb2)],'shopUsername':_0x4546d4[_0x2f7c06(0x1bc)][_0x2f7c06(0xbc)],'amount':_0x4546d4[_0x2f7c06(0x1d7)],'network':_0x4546d4[_0x2f7c06(0xe1)],'status':_0x4546d4[_0x2f7c06(0x182)],'txid':_0x4546d4[_0x2f7c06(0xeb)],'notes':_0x4546d4['notes'],'periodFrom':_0x4546d4[_0x2f7c06(0x171)],'periodTo':_0x4546d4[_0x2f7c06(0xf7)],'createdAt':_0x4546d4[_0x2f7c06(0x118)],'paidAt':_0x4546d4['paidAt']};}async[a36_0x3bf6cf(0xcb)](_0x5cbfb4){const _0x2b460f=a36_0x3bf6cf;await database_1[_0x2b460f(0x153)][_0x2b460f(0x1ae)]['delete']({'where':{'id':_0x5cbfb4}});}async[a36_0x3bf6cf(0xc1)](_0x1fe325){const _0x1223f8=a36_0x3bf6cf,{page:_0x439d4b,limit:_0x675642,status:_0x404b91,gateway:_0x3ff8eb,shopId:_0x5a07e1,dateFrom:_0x1531bd,dateTo:_0x199606,search:_0x2422c0,currency:_0xf36d1,sortBy:_0x46fb66,sortOrder:_0xb8da5f}=_0x1fe325,_0x5ca6d5=(_0x439d4b-0x1)*_0x675642;console[_0x1223f8(0xfa)](_0x1223f8(0x1e3),_0x1fe325);const _0x154761=await database_1[_0x1223f8(0x153)][_0x1223f8(0x193)][_0x1223f8(0xd0)]({'by':[_0x1223f8(0x10a)],'_count':{'gateway':!![]}});console['log'](_0x1223f8(0xe8),_0x154761[_0x1223f8(0x180)](_0x19629a=>_0x19629a[_0x1223f8(0x10a)]+'\x20('+_0x19629a['_count']['gateway']+_0x1223f8(0xf3)));if(_0x3ff8eb){const _0x59bc3b=_0x154761[_0x1223f8(0x1a1)](_0x38e7d9=>_0x38e7d9['gateway'][_0x1223f8(0x100)]()===_0x3ff8eb['toLowerCase']());!_0x59bc3b&&_0x3ff8eb[_0x1223f8(0x100)]()!==_0x1223f8(0x1e6)&&console['log'](_0x1223f8(0x1eb)+_0x3ff8eb+_0x1223f8(0x152)+_0x154761[_0x1223f8(0x180)](_0x4b4178=>_0x4b4178[_0x1223f8(0x10a)])[_0x1223f8(0xe3)](',\x20'));}const _0x2cba94={};_0x404b91&&(_0x2cba94[_0x1223f8(0x182)]=_0x404b91['toUpperCase']());if(!_0x3ff8eb)_0x2cba94[_0x1223f8(0x10a)]={'not':_0x1223f8(0x1e6)};else{if(_0x3ff8eb&&(_0x3ff8eb[_0x1223f8(0x100)]()===_0x1223f8(0x1e6)||_0x3ff8eb===_0x1223f8(0x145)))_0x2cba94[_0x1223f8(0x10a)]='test_gateway';else{let _0x4d6458=_0x3ff8eb;const _0x592b46=(0x0,gateway_1[_0x1223f8(0x13e)])(_0x3ff8eb);if(_0x592b46)_0x4d6458=_0x592b46,console[_0x1223f8(0xfa)](_0x1223f8(0x1aa)+_0x3ff8eb+_0x1223f8(0x1c5)+_0x4d6458+'\x27');else{const _0x2d6ccb=(0x0,gateway_1[_0x1223f8(0x1d5)])(_0x3ff8eb);if(_0x2d6ccb){const _0x278d7b=(0x0,gateway_1[_0x1223f8(0x13e)])(_0x2d6ccb);_0x278d7b&&(_0x4d6458=_0x278d7b,console[_0x1223f8(0xfa)](_0x1223f8(0x192)+_0x3ff8eb+_0x1223f8(0x1e7)+_0x2d6ccb+'\x27\x20->\x20name\x20\x27'+_0x4d6458+'\x27'));}else console['log'](_0x1223f8(0x19a)+_0x3ff8eb+_0x1223f8(0x103));}const _0x7b682d=await database_1[_0x1223f8(0x153)][_0x1223f8(0x193)][_0x1223f8(0x11f)]({'where':{'gateway':_0x4d6458[_0x1223f8(0x100)]()},'take':0x1});_0x7b682d===0x0?(console[_0x1223f8(0xfa)]('⚠️\x20Gateway\x20\x27'+_0x4d6458+_0x1223f8(0x110)+_0x3ff8eb+_0x1223f8(0x177)),_0x2cba94[_0x1223f8(0x10a)]=_0x1223f8(0xbd)):(_0x2cba94[_0x1223f8(0x10a)]=_0x4d6458['toLowerCase'](),console[_0x1223f8(0xfa)](_0x1223f8(0xff)+_0x4d6458+_0x1223f8(0x110)+_0x3ff8eb+'\x27)'));}}console[_0x1223f8(0xfa)](_0x1223f8(0x186),_0x2cba94['gateway']);_0x5a07e1&&(_0x2cba94['shopId']=_0x5a07e1);_0xf36d1&&(_0x2cba94[_0x1223f8(0x113)]=_0xf36d1[_0x1223f8(0x15f)](),console[_0x1223f8(0xfa)]('💱\x20Currency\x20filter\x20applied:\x20'+_0xf36d1[_0x1223f8(0x15f)]()));(_0x1531bd||_0x199606)&&(_0x2cba94[_0x1223f8(0x118)]={},_0x1531bd&&(_0x2cba94['createdAt']['gte']=new Date(_0x1531bd)),_0x199606&&(_0x2cba94[_0x1223f8(0x118)]['lte']=new Date(_0x199606)));_0x2422c0&&(_0x2cba94['OR']=[{'id':{'contains':_0x2422c0,'mode':_0x1223f8(0xbf)}},{'orderId':{'contains':_0x2422c0,'mode':_0x1223f8(0xbf)}},{'gatewayOrderId':{'contains':_0x2422c0,'mode':'insensitive'}},{'customerEmail':{'contains':_0x2422c0,'mode':_0x1223f8(0xbf)}},{'shop':{'name':{'contains':_0x2422c0,'mode':'insensitive'}}},{'shop':{'username':{'contains':_0x2422c0,'mode':'insensitive'}}}]);console['log'](_0x1223f8(0x1a3),JSON[_0x1223f8(0xfc)](_0x2cba94,null,0x2));let _0x386dae={'createdAt':'desc'};if(_0x46fb66){const _0x52378a=[_0x1223f8(0x1d7),_0x1223f8(0x118),'updatedAt',_0x1223f8(0x182),_0x1223f8(0x10a),_0x1223f8(0x113)],_0x1f9984=[_0x1223f8(0xe9),_0x1223f8(0x13a)];if(_0x52378a[_0x1223f8(0x104)](_0x46fb66)){const _0x193f1c=_0x1f9984[_0x1223f8(0x104)](_0xb8da5f)?_0xb8da5f:_0x1223f8(0x13a);_0x386dae={[_0x46fb66]:_0x193f1c},console[_0x1223f8(0xfa)](_0x1223f8(0x1d8)+_0x46fb66+_0x1223f8(0x175)+_0x193f1c+_0x1223f8(0x15b));}}const [_0x50251e,_0x272838]=await Promise[_0x1223f8(0x1a0)]([database_1[_0x1223f8(0x153)][_0x1223f8(0x193)][_0x1223f8(0xbe)]({'where':_0x2cba94,'skip':_0x5ca6d5,'take':_0x675642,'orderBy':_0x386dae,'select':{'id':!![],'shopId':!![],'amount':!![],'amountAfterGatewayCommissionUSDT':!![],'currency':!![],'sourceCurrency':!![],'status':!![],'gateway':!![],'orderId':!![],'gatewayOrderId':!![],'gatewayPaymentId':!![],'customerEmail':!![],'customerName':!![],'customerCountry':!![],'customerIp':!![],'customerUa':!![],'externalPaymentUrl':!![],'successUrl':!![],'failUrl':!![],'pendingUrl':!![],'whiteUrl':!![],'expiresAt':!![],'invoiceTotalSum':!![],'qrCode':!![],'qrUrl':!![],'country':!![],'language':!![],'amountIsEditable':!![],'maxPayments':!![],'rapydCustomer':!![],'cardLast4':!![],'paymentMethod':!![],'bankId':!![],'remitterIban':!![],'remitterName':!![],'failureMessage':!![],'usage':!![],'createdAt':!![],'updatedAt':!![],'shop':{'select':{'name':!![],'username':!![]}}}}),database_1[_0x1223f8(0x153)]['payment'][_0x1223f8(0x11f)]({'where':_0x2cba94})]);return{'payments':_0x50251e,'pagination':{'page':_0x439d4b,'limit':_0x675642,'total':_0x272838,'totalPages':Math[_0x1223f8(0x14f)](_0x272838/_0x675642)}};}async[a36_0x3bf6cf(0x10d)](_0x10ac17){const _0x1ff76b=a36_0x3bf6cf,_0x48ae8e=await database_1[_0x1ff76b(0x153)][_0x1ff76b(0x193)][_0x1ff76b(0xb3)]({'where':{'id':_0x10ac17},'select':{'id':!![],'shopId':!![],'amount':!![],'amountAfterGatewayCommissionUSDT':!![],'currency':!![],'sourceCurrency':!![],'status':!![],'gateway':!![],'orderId':!![],'gatewayOrderId':!![],'gatewayPaymentId':!![],'customerEmail':!![],'customerName':!![],'customerCountry':!![],'customerIp':!![],'customerUa':!![],'externalPaymentUrl':!![],'successUrl':!![],'failUrl':!![],'pendingUrl':!![],'whiteUrl':!![],'expiresAt':!![],'invoiceTotalSum':!![],'qrCode':!![],'qrUrl':!![],'country':!![],'language':!![],'amountIsEditable':!![],'maxPayments':!![],'rapydCustomer':!![],'cardLast4':!![],'paymentMethod':!![],'bankId':!![],'remitterIban':!![],'remitterName':!![],'failureMessage':!![],'usage':!![],'createdAt':!![],'updatedAt':!![],'shop':{'select':{'name':!![],'username':!![]}}}});if(!_0x48ae8e)return null;return{'id':_0x48ae8e['id'],'shopId':_0x48ae8e[_0x1ff76b(0x130)],'gateway':_0x48ae8e['gateway'],'amount':_0x48ae8e[_0x1ff76b(0x1d7)],'currency':_0x48ae8e[_0x1ff76b(0x113)],'status':_0x48ae8e[_0x1ff76b(0x182)],'orderId':_0x48ae8e[_0x1ff76b(0x115)],'gatewayOrderId':_0x48ae8e[_0x1ff76b(0x167)],'customerEmail':_0x48ae8e['customerEmail'],'customerName':_0x48ae8e[_0x1ff76b(0x174)],'customerCountry':_0x48ae8e[_0x1ff76b(0xb7)],'customerIp':_0x48ae8e[_0x1ff76b(0xf9)],'customerUa':_0x48ae8e['customerUa'],'failureMessage':_0x48ae8e[_0x1ff76b(0x17e)],'externalPaymentUrl':_0x48ae8e['externalPaymentUrl'],'successUrl':_0x48ae8e[_0x1ff76b(0xba)],'failUrl':_0x48ae8e[_0x1ff76b(0x18a)],'pendingUrl':_0x48ae8e['pendingUrl'],'whiteUrl':_0x48ae8e['whiteUrl'],'createdAt':_0x48ae8e[_0x1ff76b(0x118)],'updatedAt':_0x48ae8e[_0x1ff76b(0x1bf)],'shop':_0x48ae8e['shop']};}async['updatePaymentStatus'](_0x2c1578,_0x2304ba,_0x3f9f2e,_0x72dee0){const _0x57cc00=a36_0x3bf6cf,_0x585933=await database_1[_0x57cc00(0x153)][_0x57cc00(0xfe)](async _0x146bb1=>{const _0x908543=_0x57cc00,_0x45b04e=await _0x146bb1['payment'][_0x908543(0xb3)]({'where':{'id':_0x2c1578},'include':{'shop':{'select':{'id':!![],'name':!![],'username':!![],'balance':!![]}}}});if(!_0x45b04e)throw new Error(_0x908543(0x1c6));const _0x1e6564=_0x45b04e[_0x908543(0x182)],_0x33428d=_0x2304ba[_0x908543(0x15f)]();console['log']('🔄\x20Admin\x20updating\x20payment\x20'+_0x2c1578+_0x908543(0xc0)+_0x1e6564+_0x908543(0x122)+_0x33428d),console['log'](_0x908543(0xef)+_0x45b04e[_0x908543(0x1bc)][_0x908543(0x178)]+'\x20USDT');const _0xc48a8a={'status':_0x33428d,'updatedAt':new Date(),'statusChangedBy':_0x908543(0xcf),'statusChangedAt':new Date()};_0x3f9f2e&&(_0xc48a8a[_0x908543(0xb9)]=_0x3f9f2e);_0x33428d==='CHARGEBACK'&&_0x72dee0&&(_0xc48a8a[_0x908543(0x189)]=_0x72dee0);let _0x463376=0x0,_0x27e484=_0x45b04e[_0x908543(0x1bc)][_0x908543(0x178)];if(_0x33428d===_0x908543(0x14e)&&_0x1e6564!==_0x908543(0x14e)){_0xc48a8a[_0x908543(0xe0)]=new Date();const _0x3d26f2=await currencyService_1[_0x908543(0x197)][_0x908543(0x133)](_0x45b04e[_0x908543(0x1d7)],_0x45b04e['currency']);_0xc48a8a[_0x908543(0x10e)]=_0x3d26f2;let _0x567f4d=0xa;const _0x3f69dc=await _0x146bb1[_0x908543(0x1bc)][_0x908543(0xb3)]({'where':{'id':_0x45b04e[_0x908543(0x130)]},'select':{'gatewaySettings':!![]}});if(_0x3f69dc?.[_0x908543(0xf8)])try{const _0x4d4b4c=JSON[_0x908543(0x18f)](_0x3f69dc[_0x908543(0xf8)]);for(const [_0xf02e23,_0x38da19]of Object[_0x908543(0x141)](_0x4d4b4c)){if(_0xf02e23[_0x908543(0x100)]()===_0x45b04e[_0x908543(0x10a)][_0x908543(0x100)]()){_0x567f4d=_0x38da19[_0x908543(0x13c)]||0xa;break;}}}catch(_0x3c2c0a){console[_0x908543(0x198)]('Error\x20parsing\x20gateway\x20settings\x20for\x20payment\x20'+_0x2c1578+':',_0x3c2c0a);}let _0x5adfb0;_0x45b04e[_0x908543(0x1dd)]!==null&&_0x45b04e[_0x908543(0x1dd)]!==undefined?(_0x5adfb0=_0x45b04e[_0x908543(0x1dd)],console[_0x908543(0xfa)](_0x908543(0xed)+_0x5adfb0[_0x908543(0xab)](0x6)+'\x20USDT\x20for\x20payment\x20'+_0x2c1578)):(_0x5adfb0=_0x3d26f2*(0x1-_0x567f4d/0x64),console['log'](_0x908543(0xe5)+_0x2c1578+':\x20'+_0x567f4d+_0x908543(0x191)+_0x3d26f2['toFixed'](0x6)+_0x908543(0xda)),_0xc48a8a[_0x908543(0x1dd)]=_0x5adfb0),_0x463376=_0x5adfb0,_0x27e484+=_0x5adfb0,console[_0x908543(0xfa)]('💰\x20Payment\x20'+_0x2c1578+_0x908543(0x1ef)),console[_0x908543(0xfa)]('\x20\x20\x20Full\x20amount:\x20'+_0x3d26f2['toFixed'](0x6)+_0x908543(0xda)),console[_0x908543(0xfa)](_0x908543(0x1ed)+_0x45b04e['gateway']+',\x20Commission:\x20'+_0x567f4d+'%'),console[_0x908543(0xfa)](_0x908543(0x168)+_0x5adfb0[_0x908543(0xab)](0x6)+'\x20USDT\x20(after\x20'+_0x567f4d+_0x908543(0x181)),console[_0x908543(0xfa)]('\x20\x20\x20Added\x20to\x20balance:\x20+'+_0x5adfb0[_0x908543(0xab)](0x6)+_0x908543(0xda));}else{if(_0x1e6564===_0x908543(0x14e)&&_0x33428d!==_0x908543(0x14e)){if(_0x45b04e[_0x908543(0x10e)]){let _0x10f217=0xa;const _0x4f4651=await _0x146bb1[_0x908543(0x1bc)][_0x908543(0xb3)]({'where':{'id':_0x45b04e[_0x908543(0x130)]},'select':{'gatewaySettings':!![]}});if(_0x4f4651?.['gatewaySettings'])try{const _0x484a37=JSON[_0x908543(0x18f)](_0x4f4651[_0x908543(0xf8)]);for(const [_0x28875e,_0x1af081]of Object[_0x908543(0x141)](_0x484a37)){if(_0x28875e[_0x908543(0x100)]()===_0x45b04e[_0x908543(0x10a)][_0x908543(0x100)]()){_0x10f217=_0x1af081['commission']||0xa;break;}}}catch(_0x2f0932){console[_0x908543(0x198)](_0x908543(0x127)+_0x2c1578+':',_0x2f0932);}const _0x40e330=_0x45b04e[_0x908543(0x10e)]*(0x1-_0x10f217/0x64);_0x463376=-_0x40e330,_0x27e484-=_0x40e330,_0xc48a8a[_0x908543(0x10e)]=null,_0xc48a8a[_0x908543(0x1dd)]=null,console[_0x908543(0xfa)](_0x908543(0xa7)+_0x2c1578+_0x908543(0x106)),console[_0x908543(0xfa)]('\x20\x20\x20Full\x20amount:\x20'+_0x45b04e[_0x908543(0x10e)][_0x908543(0xab)](0x6)+_0x908543(0xda)),console[_0x908543(0xfa)]('\x20\x20\x20Gateway:\x20'+_0x45b04e['gateway']+_0x908543(0x185)+_0x10f217+'%'),console[_0x908543(0xfa)](_0x908543(0xc6)+_0x40e330[_0x908543(0xab)](0x6)+_0x908543(0x1c0)+_0x10f217+_0x908543(0x181)),console['log'](_0x908543(0xee)+_0x40e330['toFixed'](0x6)+_0x908543(0xda));}}}_0x33428d===_0x908543(0x199)&&(_0x1e6564===_0x908543(0x14e)&&_0x45b04e[_0x908543(0x10e)]&&console[_0x908543(0xfa)](_0x908543(0x1b8)),_0x72dee0&&_0x72dee0>0x0&&(_0x463376-=_0x72dee0,_0x27e484-=_0x72dee0,console[_0x908543(0xfa)](_0x908543(0xa9)+_0x72dee0[_0x908543(0xab)](0x6)+'\x20USDT\x20from\x20balance')));_0x33428d===_0x908543(0x1be)&&_0x1e6564==='PAID'&&console[_0x908543(0xfa)](_0x908543(0x15a));const _0x2f72ee=await _0x146bb1[_0x908543(0x193)][_0x908543(0x1ec)]({'where':{'id':_0x2c1578},'data':_0xc48a8a,'include':{'shop':{'select':{'name':!![],'username':!![]}}}});return _0x463376!==0x0&&(await _0x146bb1[_0x908543(0x1bc)][_0x908543(0x1ec)]({'where':{'id':_0x45b04e[_0x908543(0x130)]},'data':{'balance':_0x27e484}}),console[_0x908543(0xfa)](_0x908543(0x16e)+_0x45b04e[_0x908543(0x130)]+'\x20balance\x20updated:\x20'+_0x45b04e[_0x908543(0x1bc)][_0x908543(0x178)][_0x908543(0xab)](0x6)+_0x908543(0x122)+_0x27e484[_0x908543(0xab)](0x6)+_0x908543(0x12f)+(_0x463376>0x0?'+':'')+_0x463376[_0x908543(0xab)](0x6)+')')),_0x2f72ee;});return{'id':_0x585933['id'],'shopId':_0x585933[_0x57cc00(0x130)],'gateway':_0x585933[_0x57cc00(0x10a)],'amount':_0x585933['amount'],'currency':_0x585933[_0x57cc00(0x113)],'status':_0x585933[_0x57cc00(0x182)],'orderId':_0x585933[_0x57cc00(0x115)],'gatewayOrderId':_0x585933[_0x57cc00(0x167)],'customerEmail':_0x585933['customerEmail'],'customerName':_0x585933['customerName'],'customerCountry':_0x585933[_0x57cc00(0xb7)],'customerIp':_0x585933[_0x57cc00(0xf9)],'customerUa':_0x585933[_0x57cc00(0x112)],'failureMessage':_0x585933[_0x57cc00(0x17e)],'adminNotes':_0x585933['adminNotes'],'chargebackAmount':_0x585933[_0x57cc00(0x189)],'statusChangedBy':_0x585933[_0x57cc00(0x17a)],'statusChangedAt':_0x585933[_0x57cc00(0x14a)],'createdAt':_0x585933[_0x57cc00(0x118)],'updatedAt':_0x585933[_0x57cc00(0x1bf)],'shop':_0x585933[_0x57cc00(0x1bc)]};}async[a36_0x3bf6cf(0xf1)](_0x1f4957,_0x1994f8){const _0x573d22=a36_0x3bf6cf,_0x2f4962=Math[_0x573d22(0xdd)]()['toString'](0x24)[_0x573d22(0xcd)](0x2,0x9);console[_0x573d22(0xfa)](_0x573d22(0x1cf)+_0x2f4962+_0x573d22(0x187)+_0x1f4957);const _0x5e2351={..._0x1994f8};_0x1994f8[_0x573d22(0x143)]&&_0x1994f8[_0x573d22(0x143)][_0x573d22(0x19d)]()!==''?(console[_0x573d22(0xfa)](_0x573d22(0x160)+_0x2f4962+_0x573d22(0xf2)+_0x1f4957),_0x5e2351[_0x573d22(0x143)]=await bcryptjs_1[_0x573d22(0x153)]['hash'](_0x1994f8[_0x573d22(0x143)],0xc)):(console['log'](_0x573d22(0x160)+_0x2f4962+_0x573d22(0x1db)),delete _0x5e2351[_0x573d22(0x143)]);_0x1994f8[_0x573d22(0x1ca)]&&(_0x5e2351[_0x573d22(0xb2)]=_0x1994f8[_0x573d22(0x1ca)],delete _0x5e2351[_0x573d22(0x1ca)]);_0x1994f8[_0x573d22(0x157)]&&(_0x5e2351[_0x573d22(0xd3)]=_0x1994f8[_0x573d22(0x157)],delete _0x5e2351[_0x573d22(0x157)]);_0x1994f8[_0x573d22(0x184)]&&(_0x5e2351[_0x573d22(0x19f)]=_0x1994f8['merchantUrl'],delete _0x5e2351[_0x573d22(0x184)]);if(_0x1994f8[_0x573d22(0x194)]){const _0xef1c94=_0x1994f8[_0x573d22(0x194)]['map'](_0x57de36=>this['getGatewayInternalName'](_0x57de36));console[_0x573d22(0xfa)]('🔄\x20Gateway\x20mapping:',_0x1994f8[_0x573d22(0x194)],'->',_0xef1c94),_0x5e2351[_0x573d22(0x111)]=JSON[_0x573d22(0xfc)](_0xef1c94),delete _0x5e2351[_0x573d22(0x194)];}_0x1994f8[_0x573d22(0xf8)]&&(console[_0x573d22(0xfa)](_0x573d22(0x1d3)+_0x2f4962+_0x573d22(0x140),_0x1994f8[_0x573d22(0xf8)]),_0x5e2351[_0x573d22(0xf8)]=JSON[_0x573d22(0xfc)](_0x1994f8['gatewaySettings']),console[_0x573d22(0xfa)](_0x573d22(0x1d3)+_0x2f4962+_0x573d22(0xd1),_0x5e2351[_0x573d22(0xf8)]));_0x1994f8[_0x573d22(0xb1)]&&(_0x1994f8[_0x573d22(0xb1)][_0x573d22(0x128)]!==undefined&&(_0x5e2351['usdtPolygonWallet']=_0x1994f8[_0x573d22(0xb1)][_0x573d22(0x128)]||null),_0x1994f8['wallets'][_0x573d22(0x16a)]!==undefined&&(_0x5e2351[_0x573d22(0x16a)]=_0x1994f8['wallets'][_0x573d22(0x16a)]||null),_0x1994f8['wallets'][_0x573d22(0x1b6)]!==undefined&&(_0x5e2351['usdtErcWallet']=_0x1994f8[_0x573d22(0xb1)][_0x573d22(0x1b6)]||null),_0x1994f8[_0x573d22(0xb1)]['usdcPolygonWallet']!==undefined&&(_0x5e2351[_0x573d22(0x1e0)]=_0x1994f8[_0x573d22(0xb1)]['usdcPolygonWallet']||null),delete _0x5e2351[_0x573d22(0xb1)]);const _0x39c3bb=await database_1[_0x573d22(0x153)][_0x573d22(0x1bc)][_0x573d22(0x1ec)]({'where':{'id':_0x1f4957},'data':_0x5e2351,'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});return console[_0x573d22(0xfa)]('🎯\x20['+_0x2f4962+_0x573d22(0xb8),_0x39c3bb[_0x573d22(0xf8)]),{'id':_0x39c3bb['id'],'fullName':_0x39c3bb[_0x573d22(0xb2)],'username':_0x39c3bb[_0x573d22(0xbc)],'telegramId':_0x39c3bb[_0x573d22(0xd3)],'merchantUrl':_0x39c3bb[_0x573d22(0x19f)],'gateways':_0x39c3bb['paymentGateways']?JSON[_0x573d22(0x18f)](_0x39c3bb[_0x573d22(0x111)]):null,'gatewaySettings':_0x39c3bb[_0x573d22(0xf8)]?JSON[_0x573d22(0x18f)](_0x39c3bb[_0x573d22(0xf8)]):null,'publicKey':_0x39c3bb[_0x573d22(0x17d)],'wallets':{'usdtPolygonWallet':_0x39c3bb[_0x573d22(0x128)],'usdtTrcWallet':_0x39c3bb[_0x573d22(0x16a)],'usdtErcWallet':_0x39c3bb['usdtErcWallet'],'usdcPolygonWallet':_0x39c3bb[_0x573d22(0x1e0)]},'status':_0x39c3bb[_0x573d22(0x182)],'createdAt':_0x39c3bb[_0x573d22(0x118)]};}async['suspendUser'](_0x2dc42b){const _0x3d0872=a36_0x3bf6cf,_0x1284bb=await database_1[_0x3d0872(0x153)]['shop']['update']({'where':{'id':_0x2dc42b},'data':{'status':_0x3d0872(0x15c)},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});return{'id':_0x1284bb['id'],'fullName':_0x1284bb['name'],'username':_0x1284bb['username'],'telegramId':_0x1284bb['telegram'],'merchantUrl':_0x1284bb[_0x3d0872(0x19f)],'gateways':_0x1284bb['paymentGateways']?JSON[_0x3d0872(0x18f)](_0x1284bb[_0x3d0872(0x111)]):null,'gatewaySettings':_0x1284bb[_0x3d0872(0xf8)]?JSON[_0x3d0872(0x18f)](_0x1284bb[_0x3d0872(0xf8)]):null,'publicKey':_0x1284bb[_0x3d0872(0x17d)],'wallets':{'usdtPolygonWallet':_0x1284bb[_0x3d0872(0x128)],'usdtTrcWallet':_0x1284bb[_0x3d0872(0x16a)],'usdtErcWallet':_0x1284bb[_0x3d0872(0x1b6)],'usdcPolygonWallet':_0x1284bb[_0x3d0872(0x1e0)]},'status':_0x1284bb[_0x3d0872(0x182)],'createdAt':_0x1284bb['createdAt']};}async[a36_0x3bf6cf(0xc8)](_0x3314f9){const _0x10ed4b=a36_0x3bf6cf,_0x24db85=await database_1['default'][_0x10ed4b(0x1bc)][_0x10ed4b(0x1ec)]({'where':{'id':_0x3314f9},'data':{'status':_0x10ed4b(0xaa)},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});return{'id':_0x24db85['id'],'fullName':_0x24db85[_0x10ed4b(0xb2)],'username':_0x24db85[_0x10ed4b(0xbc)],'telegramId':_0x24db85[_0x10ed4b(0xd3)],'merchantUrl':_0x24db85['shopUrl'],'gateways':_0x24db85['paymentGateways']?JSON[_0x10ed4b(0x18f)](_0x24db85[_0x10ed4b(0x111)]):null,'gatewaySettings':_0x24db85[_0x10ed4b(0xf8)]?JSON['parse'](_0x24db85[_0x10ed4b(0xf8)]):null,'publicKey':_0x24db85[_0x10ed4b(0x17d)],'wallets':{'usdtPolygonWallet':_0x24db85[_0x10ed4b(0x128)],'usdtTrcWallet':_0x24db85[_0x10ed4b(0x16a)],'usdtErcWallet':_0x24db85['usdtErcWallet'],'usdcPolygonWallet':_0x24db85[_0x10ed4b(0x1e0)]},'status':_0x24db85[_0x10ed4b(0x182)],'createdAt':_0x24db85[_0x10ed4b(0x118)]};}async[a36_0x3bf6cf(0x17b)](_0x3e7fe3){const _0x329df1=a36_0x3bf6cf,{page:_0x664610,limit:_0x56c47c,status:_0x412bb4}=_0x3e7fe3,_0x2a97e5=(_0x664610-0x1)*_0x56c47c,_0x45b2d7={};_0x412bb4&&(_0x45b2d7[_0x329df1(0x182)]=_0x412bb4[_0x329df1(0x15f)]());const [_0x4e7054,_0x47c285]=await Promise[_0x329df1(0x1a0)]([database_1[_0x329df1(0x153)][_0x329df1(0x1bc)][_0x329df1(0xbe)]({'where':_0x45b2d7,'skip':_0x2a97e5,'take':_0x56c47c,'orderBy':{'createdAt':'desc'},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}}),database_1['default'][_0x329df1(0x1bc)][_0x329df1(0x11f)]({'where':_0x45b2d7})]);return{'users':_0x4e7054[_0x329df1(0x180)](_0x30ae15=>{const _0x1f0fa1=_0x329df1,_0xc4e131=_0x30ae15[_0x1f0fa1(0x111)]?JSON['parse'](_0x30ae15[_0x1f0fa1(0x111)]):null,_0x4faf05=_0xc4e131?_0xc4e131[_0x1f0fa1(0x180)](_0x3b520c=>this[_0x1f0fa1(0x137)](_0x3b520c)):null;return{'id':_0x30ae15['id'],'fullName':_0x30ae15['name'],'username':_0x30ae15[_0x1f0fa1(0xbc)],'telegramId':_0x30ae15[_0x1f0fa1(0xd3)],'merchantUrl':_0x30ae15[_0x1f0fa1(0x19f)],'gateways':_0x4faf05,'gatewaySettings':_0x30ae15['gatewaySettings']?JSON[_0x1f0fa1(0x18f)](_0x30ae15['gatewaySettings']):null,'publicKey':_0x30ae15['publicKey'],'wallets':{'usdtPolygonWallet':_0x30ae15[_0x1f0fa1(0x128)],'usdtTrcWallet':_0x30ae15[_0x1f0fa1(0x16a)],'usdtErcWallet':_0x30ae15['usdtErcWallet'],'usdcPolygonWallet':_0x30ae15[_0x1f0fa1(0x1e0)]},'status':_0x30ae15[_0x1f0fa1(0x182)],'createdAt':_0x30ae15[_0x1f0fa1(0x118)]};}),'pagination':{'page':_0x664610,'limit':_0x56c47c,'total':_0x47c285,'totalPages':Math[_0x329df1(0x14f)](_0x47c285/_0x56c47c)}};}async['getUserById'](_0x2fbc45){const _0xfa80d9=a36_0x3bf6cf,_0x21ff7b=await database_1['default'][_0xfa80d9(0x1bc)]['findUnique']({'where':{'id':_0x2fbc45},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});if(!_0x21ff7b)return null;const _0x40d7cf=_0x21ff7b[_0xfa80d9(0x111)]?JSON[_0xfa80d9(0x18f)](_0x21ff7b['paymentGateways']):null,_0x4c806f=_0x40d7cf?_0x40d7cf['map'](_0x37029f=>this[_0xfa80d9(0x137)](_0x37029f)):null;return _0x40d7cf&&_0x4c806f&&console['log'](_0xfa80d9(0x151),_0x40d7cf,'->',_0x4c806f),{'id':_0x21ff7b['id'],'fullName':_0x21ff7b[_0xfa80d9(0xb2)],'username':_0x21ff7b[_0xfa80d9(0xbc)],'telegramId':_0x21ff7b[_0xfa80d9(0xd3)],'merchantUrl':_0x21ff7b['shopUrl'],'gateways':_0x4c806f,'gatewaySettings':_0x21ff7b['gatewaySettings']?JSON['parse'](_0x21ff7b[_0xfa80d9(0xf8)]):null,'publicKey':_0x21ff7b[_0xfa80d9(0x17d)],'wallets':{'usdtPolygonWallet':_0x21ff7b['usdtPolygonWallet'],'usdtTrcWallet':_0x21ff7b[_0xfa80d9(0x16a)],'usdtErcWallet':_0x21ff7b[_0xfa80d9(0x1b6)],'usdcPolygonWallet':_0x21ff7b[_0xfa80d9(0x1e0)]},'status':_0x21ff7b['status'],'createdAt':_0x21ff7b[_0xfa80d9(0x118)]};}async[a36_0x3bf6cf(0x13f)](_0x55d9d1){const _0x289ebc=a36_0x3bf6cf,{fullName:_0x27a60d,username:_0x39b4cd,password:_0x594d46,telegramId:_0x4b7609,merchantUrl:_0x1cec25,gateways:_0x31abd2,gatewaySettings:_0x1f7d70,wallets:_0x1240fd}=_0x55d9d1,_0x230c78=await database_1[_0x289ebc(0x153)][_0x289ebc(0x1bc)][_0x289ebc(0xb3)]({'where':{'username':_0x39b4cd}});if(_0x230c78)throw new Error(_0x289ebc(0x1bb));if(_0x4b7609){const _0x1527a6=await database_1[_0x289ebc(0x153)][_0x289ebc(0x1bc)][_0x289ebc(0xb3)]({'where':{'telegram':_0x4b7609}});if(_0x1527a6)throw new Error(_0x289ebc(0x134));}const _0x76242f=await bcryptjs_1[_0x289ebc(0x153)][_0x289ebc(0xa6)](_0x594d46,0xc),_0x530904=_0x289ebc(0x18d)+crypto_1[_0x289ebc(0x153)]['randomBytes'](0x20)[_0x289ebc(0x138)](_0x289ebc(0x1e2)),_0x2b8f9c=_0x289ebc(0x1e1)+crypto_1[_0x289ebc(0x153)][_0x289ebc(0xd8)](0x20)[_0x289ebc(0x138)](_0x289ebc(0x1e2)),_0x394bf1=_0x31abd2?_0x31abd2[_0x289ebc(0x180)](_0x428ad2=>this[_0x289ebc(0x17c)](_0x428ad2)):null;_0x31abd2&&_0x394bf1&&console[_0x289ebc(0xfa)](_0x289ebc(0xdf),_0x31abd2,'->',_0x394bf1);const _0x1e9b7b=await database_1[_0x289ebc(0x153)][_0x289ebc(0x1bc)][_0x289ebc(0x179)]({'data':{'name':_0x27a60d,'username':_0x39b4cd,'password':_0x76242f,'telegram':_0x4b7609,'shopUrl':_0x1cec25,'paymentGateways':_0x394bf1?JSON[_0x289ebc(0xfc)](_0x394bf1):null,'gatewaySettings':_0x1f7d70?JSON[_0x289ebc(0xfc)](_0x1f7d70):null,'usdtPolygonWallet':_0x1240fd?.[_0x289ebc(0x128)]||null,'usdtTrcWallet':_0x1240fd?.[_0x289ebc(0x16a)]||null,'usdtErcWallet':_0x1240fd?.['usdtErcWallet']||null,'usdcPolygonWallet':_0x1240fd?.[_0x289ebc(0x1e0)]||null,'publicKey':_0x530904,'secretKey':_0x2b8f9c,'status':_0x289ebc(0xaa)},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});return{'id':_0x1e9b7b['id'],'fullName':_0x1e9b7b[_0x289ebc(0xb2)],'username':_0x1e9b7b['username'],'telegramId':_0x1e9b7b['telegram'],'merchantUrl':_0x1e9b7b[_0x289ebc(0x19f)],'gateways':_0x1e9b7b[_0x289ebc(0x111)]?JSON[_0x289ebc(0x18f)](_0x1e9b7b[_0x289ebc(0x111)]):null,'gatewaySettings':_0x1e9b7b[_0x289ebc(0xf8)]?JSON[_0x289ebc(0x18f)](_0x1e9b7b[_0x289ebc(0xf8)]):null,'publicKey':_0x1e9b7b['publicKey'],'wallets':{'usdtPolygonWallet':_0x1e9b7b['usdtPolygonWallet'],'usdtTrcWallet':_0x1e9b7b[_0x289ebc(0x16a)],'usdtErcWallet':_0x1e9b7b[_0x289ebc(0x1b6)],'usdcPolygonWallet':_0x1e9b7b[_0x289ebc(0x1e0)]},'status':_0x1e9b7b['status'],'createdAt':_0x1e9b7b[_0x289ebc(0x118)]};}async[a36_0x3bf6cf(0x1d6)](_0x1b4129){const _0x3b53f1=a36_0x3bf6cf;await database_1['default'][_0x3b53f1(0x1bc)][_0x3b53f1(0x19e)]({'where':{'id':_0x1b4129}});}[a36_0x3bf6cf(0x1b0)](_0xd78c19,_0x17ecab,_0x283a92){const _0x422269=a36_0x3bf6cf,_0x30876e=new Map(),_0x4c5226=new Date(_0x17ecab);while(_0x4c5226<=_0x283a92){const _0x3e246b=_0x4c5226[_0x422269(0xb5)]()['split']('T')[0x0];_0x30876e[_0x422269(0x1c9)](_0x3e246b,{'revenue':0x0,'count':0x0}),_0x4c5226[_0x422269(0x16f)](_0x4c5226['getDate']()+0x1);}for(const _0x23190b of _0xd78c19){const _0x4dec2e=_0x23190b[_0x422269(0x118)][_0x422269(0xb5)]()[_0x422269(0xc4)]('T')[0x0],_0x3b80c7=_0x30876e[_0x422269(0x1c1)](_0x4dec2e);_0x3b80c7&&(_0x3b80c7[_0x422269(0x11f)]+=0x1,_0x23190b[_0x422269(0x182)]===_0x422269(0x14e)&&(_0x23190b[_0x422269(0x10e)]?_0x3b80c7['revenue']+=_0x23190b['amountUSDT']:console['log'](_0x422269(0x149)+_0x23190b['id']+_0x422269(0x1b7))));}const _0xd4655e=[],_0x5b06e5=[];for(const [_0x35eac3,_0x1cfaa2]of _0x30876e){_0xd4655e[_0x422269(0xc9)]({'date':_0x35eac3,'amount':Math[_0x422269(0x1d1)](_0x1cfaa2[_0x422269(0x109)]*0x64)/0x64}),_0x5b06e5[_0x422269(0xc9)]({'date':_0x35eac3,'count':_0x1cfaa2[_0x422269(0x11f)]});}return{'dailyRevenue':_0xd4655e,'dailyPayments':_0x5b06e5};}}exports[a36_0x3bf6cf(0x176)]=AdminService;