'use strict';const a38_0x718376=a38_0x468e;(function(_0x468a9f,_0x22ef62){const _0x4b513b=a38_0x468e,_0x2d540a=_0x468a9f();while(!![]){try{const _0x57571f=parseInt(_0x4b513b(0x156))/0x1+parseInt(_0x4b513b(0x1a5))/0x2*(parseInt(_0x4b513b(0x1e9))/0x3)+-parseInt(_0x4b513b(0x24d))/0x4+-parseInt(_0x4b513b(0x1f7))/0x5+parseInt(_0x4b513b(0x245))/0x6*(parseInt(_0x4b513b(0x148))/0x7)+-parseInt(_0x4b513b(0x1d4))/0x8*(-parseInt(_0x4b513b(0x23f))/0x9)+-parseInt(_0x4b513b(0x1d8))/0xa;if(_0x57571f===_0x22ef62)break;else _0x2d540a['push'](_0x2d540a['shift']());}catch(_0xb554ab){_0x2d540a['push'](_0x2d540a['shift']());}}}(a38_0x1b83,0x2f7f6));var __importDefault=this&&this[a38_0x718376(0x1b3)]||function(_0x5b5c86){const _0x426764=a38_0x718376;return _0x5b5c86&&_0x5b5c86[_0x426764(0x150)]?_0x5b5c86:{'default':_0x5b5c86};};Object[a38_0x718376(0x1cf)](exports,a38_0x718376(0x150),{'value':!![]}),exports[a38_0x718376(0x222)]=void 0x0;const database_1=__importDefault(require(a38_0x718376(0x1a3))),bcryptjs_1=__importDefault(require(a38_0x718376(0x24c))),crypto_1=__importDefault(require(a38_0x718376(0x1aa))),currencyService_1=require(a38_0x718376(0x13d)),gateway_1=require('../types/gateway');class AdminService{async['getPayoutStats'](){const _0x3b4f7d=a38_0x718376;console[_0x3b4f7d(0x1f9)](_0x3b4f7d(0x1f2));const _0x373d5b=await database_1['default']['shop'][_0x3b4f7d(0x176)]({'_sum':{'balance':!![],'totalPaidOut':!![]},'where':{'status':_0x3b4f7d(0x17a)}}),_0x193ead=await database_1['default'][_0x3b4f7d(0x215)][_0x3b4f7d(0x1d0)]({'where':{'status':_0x3b4f7d(0x201),'gateway':{'not':_0x3b4f7d(0x24f)}}}),_0x1d1f68=new Date(),_0x518db3=new Date(_0x1d1f68[_0x3b4f7d(0x1bd)](),_0x1d1f68[_0x3b4f7d(0x1e1)](),0x1),_0x5b22ee=new Date(_0x1d1f68[_0x3b4f7d(0x1bd)](),_0x1d1f68[_0x3b4f7d(0x1e1)]()+0x1,0x0,0x17,0x3b,0x3b,0x3e7),_0x1853cb=await database_1['default']['payout'][_0x3b4f7d(0x176)]({'_sum':{'amount':!![]},'where':{'createdAt':{'gte':_0x518db3,'lte':_0x5b22ee},'status':_0x3b4f7d(0x17e)}}),_0x4785f9=_0x373d5b[_0x3b4f7d(0x15f)][_0x3b4f7d(0x163)]||0x0,_0x71dd49=_0x373d5b[_0x3b4f7d(0x15f)][_0x3b4f7d(0x1c1)]||0x0,_0x4c034b=_0x1853cb['_sum']['amount']||0x0,_0x31aea7={'totalPayout':Math[_0x3b4f7d(0x1a2)](_0x4785f9*0x64)/0x64,'awaitingPayout':Math[_0x3b4f7d(0x1a2)](_0x71dd49*0x64)/0x64,'thisMonth':Math[_0x3b4f7d(0x1a2)](_0x4c034b*0x64)/0x64,'availableBalance':Math[_0x3b4f7d(0x1a2)](_0x71dd49*0x64)/0x64,'totalPayments':_0x193ead};return console['log'](_0x3b4f7d(0x151)),console['log'](_0x3b4f7d(0x15c)+_0x31aea7[_0x3b4f7d(0x203)]+_0x3b4f7d(0x179)),console[_0x3b4f7d(0x1f9)](_0x3b4f7d(0x11d)+_0x31aea7[_0x3b4f7d(0x251)]+_0x3b4f7d(0x184)),console['log'](_0x3b4f7d(0x20c)+_0x31aea7['availableBalance']+_0x3b4f7d(0x18d)),console[_0x3b4f7d(0x1f9)](_0x3b4f7d(0x1d9)+_0x31aea7[_0x3b4f7d(0x11b)]+_0x3b4f7d(0x1db)),console['log'](_0x3b4f7d(0x1c9)+_0x31aea7['totalPayments']+_0x3b4f7d(0x11f)),_0x31aea7;}async[a38_0x718376(0x206)](_0x4e169e,_0x35a225){const _0x478808=a38_0x718376;console[_0x478808(0x1f9)](_0x478808(0x1fe)+_0x4e169e+':',_0x35a225);const _0x272abf=await database_1[_0x478808(0x168)][_0x478808(0x215)][_0x478808(0x261)]({'where':{'id':_0x4e169e},'select':{'id':!![],'customerEmail':!![],'customerName':!![],'customerCountry':!![],'customerIp':!![],'customerUa':!![]}});if(!_0x272abf)throw new Error('Payment\x20not\x20found');const _0x4122e8={};_0x35a225['customerCountry']!==undefined&&(_0x4122e8[_0x478808(0x244)]=_0x35a225[_0x478808(0x244)]||null);_0x35a225[_0x478808(0x185)]!==undefined&&(_0x4122e8['customerIp']=_0x35a225[_0x478808(0x185)]||null);_0x35a225[_0x478808(0x15e)]!==undefined&&(_0x4122e8[_0x478808(0x15e)]=_0x35a225[_0x478808(0x15e)]||null);const _0x5b730e=await database_1[_0x478808(0x168)][_0x478808(0x215)][_0x478808(0x266)]({'where':{'id':_0x4e169e},'data':{..._0x4122e8,'updatedAt':new Date()},'select':{'id':!![],'customerEmail':!![],'customerName':!![],'customerCountry':!![],'customerIp':!![],'customerUa':!![],'updatedAt':!![]}});return console['log'](_0x478808(0x16c)+_0x4e169e),console[_0x478808(0x1f9)](_0x478808(0x25e)+_0x272abf[_0x478808(0x244)]+_0x478808(0x1b1)+_0x5b730e['customerCountry']),console[_0x478808(0x1f9)](_0x478808(0x1bf)+_0x272abf[_0x478808(0x185)]+_0x478808(0x1b1)+_0x5b730e[_0x478808(0x185)]),console['log'](_0x478808(0x14c)+(_0x272abf[_0x478808(0x15e)]?'set':'not\x20set')+_0x478808(0x1b1)+(_0x5b730e[_0x478808(0x15e)]?_0x478808(0x16a):'not\x20set')),_0x5b730e;}async[a38_0x718376(0x13c)](_0x85b6ee){const _0x2ee55d=a38_0x718376,_0x58ad2c=new Date();let _0x20da00;switch(_0x85b6ee[_0x2ee55d(0x21e)]()){case _0x2ee55d(0x123):_0x20da00=new Date(_0x58ad2c['getFullYear'](),_0x58ad2c[_0x2ee55d(0x1e1)](),_0x58ad2c['getDate'](),0x0,0x0,0x0,0x0);break;case _0x2ee55d(0x1b6):const _0x242ff7=new Date(_0x58ad2c);_0x242ff7[_0x2ee55d(0x16d)](_0x242ff7['getDate']()-0x1),_0x20da00=new Date(_0x242ff7[_0x2ee55d(0x1bd)](),_0x242ff7[_0x2ee55d(0x1e1)](),_0x242ff7[_0x2ee55d(0x14b)](),0x0,0x0,0x0,0x0);break;case'7d':_0x20da00=new Date(_0x58ad2c[_0x2ee55d(0x1df)]()-0x7*0x18*0x3c*0x3c*0x3e8);break;case _0x2ee55d(0x136):_0x20da00=new Date(_0x58ad2c[_0x2ee55d(0x1df)]()-0x1e*0x18*0x3c*0x3c*0x3e8);break;case'90d':_0x20da00=new Date(_0x58ad2c[_0x2ee55d(0x1df)]()-0x5a*0x18*0x3c*0x3c*0x3e8);break;case _0x2ee55d(0x127):const _0x54186b=await database_1[_0x2ee55d(0x168)][_0x2ee55d(0x215)][_0x2ee55d(0x1ce)]({'where':{'gateway':{'not':_0x2ee55d(0x24f)}},'orderBy':{'createdAt':'asc'},'select':{'createdAt':!![]}});_0x20da00=_0x54186b?_0x54186b[_0x2ee55d(0x187)]:new Date(_0x2ee55d(0x17d));break;default:_0x20da00=new Date(_0x58ad2c[_0x2ee55d(0x1df)]()-0x1e*0x18*0x3c*0x3c*0x3e8);}_0x20da00['setHours'](0x0,0x0,0x0,0x0);let _0x22d4ed;if(_0x85b6ee['toLowerCase']()===_0x2ee55d(0x1b6)){const _0x38741b=new Date(_0x58ad2c);_0x38741b['setDate'](_0x38741b[_0x2ee55d(0x14b)]()-0x1),_0x22d4ed=new Date(_0x38741b[_0x2ee55d(0x1bd)](),_0x38741b[_0x2ee55d(0x1e1)](),_0x38741b['getDate'](),0x17,0x3b,0x3b,0x3e7);}const _0x49bdbb={'gte':_0x20da00};_0x22d4ed&&(_0x49bdbb['lte']=_0x22d4ed);const [_0x424fd2,_0x4762c7,_0x24c97a,_0x374102,_0x255bbe,_0x263fb6]=await Promise[_0x2ee55d(0x127)]([database_1[_0x2ee55d(0x168)][_0x2ee55d(0x11c)][_0x2ee55d(0x1d0)](),database_1[_0x2ee55d(0x168)][_0x2ee55d(0x11c)][_0x2ee55d(0x1d0)]({'where':{'status':_0x2ee55d(0x17a)}}),database_1[_0x2ee55d(0x168)][_0x2ee55d(0x215)][_0x2ee55d(0x1d0)]({'where':{'status':_0x2ee55d(0x201),'createdAt':_0x49bdbb,'gateway':{'not':_0x2ee55d(0x24f)}}}),database_1[_0x2ee55d(0x168)][_0x2ee55d(0x215)]['findMany']({'where':{'status':'PAID','createdAt':_0x49bdbb,'gateway':{'not':'test_gateway'}},'select':{'amount':!![],'currency':!![],'amountAfterGatewayCommissionUSDT':!![]}}),database_1['default'][_0x2ee55d(0x215)][_0x2ee55d(0x22a)]({'where':{'gateway':{'not':_0x2ee55d(0x24f)}},'take':0xa,'orderBy':{'createdAt':_0x2ee55d(0x23c)},'include':{'shop':{'select':{'name':!![],'username':!![]}}}}),database_1[_0x2ee55d(0x168)][_0x2ee55d(0x215)]['findMany']({'where':{'createdAt':_0x49bdbb,'gateway':{'not':_0x2ee55d(0x24f)}},'select':{'amount':!![],'currency':!![],'status':!![],'amountUSDT':!![],'createdAt':!![]}})]);let _0x15d7ab=0x0,_0x474a74=0x0;for(const _0x13d21b of _0x374102){const _0x228c94=await currencyService_1[_0x2ee55d(0x149)][_0x2ee55d(0x1b8)](_0x13d21b[_0x2ee55d(0x1c3)],_0x13d21b[_0x2ee55d(0x20f)]);_0x15d7ab+=_0x228c94;if(_0x13d21b['amountAfterGatewayCommissionUSDT']){const _0x127719=await currencyService_1[_0x2ee55d(0x149)][_0x2ee55d(0x1b8)](_0x13d21b[_0x2ee55d(0x1c3)],_0x13d21b[_0x2ee55d(0x20f)]),_0x3175fb=_0x13d21b['amountAfterGatewayCommissionUSDT'],_0x5932d9=_0x127719-_0x3175fb;_0x474a74+=_0x5932d9;}}const _0x47a4d6=_0x24c97a>0x0?_0x15d7ab/_0x24c97a:0x0,_0x4c1a59=this[_0x2ee55d(0x267)](_0x263fb6,_0x20da00,_0x22d4ed||_0x58ad2c),_0x19cb31=await database_1[_0x2ee55d(0x168)][_0x2ee55d(0x215)][_0x2ee55d(0x1d0)]({'where':{'createdAt':_0x49bdbb,'gateway':{'not':'test_gateway'}}}),_0x364e4a=_0x19cb31>0x0?_0x24c97a/_0x19cb31*0x64:0x0;return{'totalShops':_0x424fd2,'activeShops':_0x4762c7,'totalPayments':_0x24c97a,'successfulPayments':_0x24c97a,'totalAttempts':_0x19cb31,'totalRevenue':Math[_0x2ee55d(0x1a2)](_0x15d7ab*0x64)/0x64,'trapayEarnings':Math[_0x2ee55d(0x1a2)](_0x474a74*0x64)/0x64,'averagePaymentAmount':Math[_0x2ee55d(0x1a2)](_0x47a4d6*0x64)/0x64,'conversionRate':Math[_0x2ee55d(0x1a2)](_0x364e4a*0x64)/0x64,'dailyRevenue':_0x4c1a59[_0x2ee55d(0x1cc)],'dailyPayments':_0x4c1a59[_0x2ee55d(0x210)],'recentPayments':_0x255bbe[_0x2ee55d(0x21a)](_0x9a3ba9=>({'id':_0x9a3ba9['id'],'amount':_0x9a3ba9[_0x2ee55d(0x1c3)],'currency':_0x9a3ba9[_0x2ee55d(0x20f)],'status':_0x9a3ba9[_0x2ee55d(0x172)],'gateway':_0x9a3ba9['gateway'],'shop':_0x9a3ba9[_0x2ee55d(0x11c)],'createdAt':_0x9a3ba9[_0x2ee55d(0x187)]}))};}async['getMerchantStatistics'](_0x534f52){const _0x50942a=a38_0x718376;console[_0x50942a(0x1f9)](_0x50942a(0x14a),_0x534f52);let _0x762da1,_0x2ba982=new Date();if(_0x534f52['period']===_0x50942a(0x230)&&_0x534f52[_0x50942a(0x220)]&&_0x534f52[_0x50942a(0x177)])_0x762da1=new Date(_0x534f52['dateFrom']),_0x2ba982=new Date(_0x534f52[_0x50942a(0x177)]),_0x762da1['setHours'](0x0,0x0,0x0,0x0),_0x2ba982['setHours'](0x17,0x3b,0x3b,0x3e7);else{const _0x1f5652=new Date();switch(_0x534f52[_0x50942a(0x173)]){case _0x50942a(0x16e):_0x762da1=new Date(_0x1f5652[_0x50942a(0x1df)]()-0x7*0x18*0x3c*0x3c*0x3e8);break;case _0x50942a(0x25c):_0x762da1=new Date(_0x1f5652[_0x50942a(0x1df)]()-0x1e*0x18*0x3c*0x3c*0x3e8);break;case'year':_0x762da1=new Date(_0x1f5652[_0x50942a(0x1df)]()-0x16d*0x18*0x3c*0x3c*0x3e8);break;case _0x50942a(0x127):default:_0x762da1=new Date(_0x50942a(0x17d));break;}_0x762da1[_0x50942a(0x124)](0x0,0x0,0x0,0x0),_0x2ba982[_0x50942a(0x124)](0x17,0x3b,0x3b,0x3e7);}console[_0x50942a(0x1f9)](_0x50942a(0x1d7)+_0x762da1['toISOString']()+_0x50942a(0x18c)+_0x2ba982[_0x50942a(0x169)]());const _0x36e022={'status':_0x50942a(0x201),'gateway':{'not':_0x50942a(0x24f)},'paidAt':{'gte':_0x762da1,'lte':_0x2ba982}};_0x534f52[_0x50942a(0x227)]&&(_0x36e022[_0x50942a(0x227)]=_0x534f52[_0x50942a(0x227)]);const _0x26fa01=await database_1[_0x50942a(0x168)][_0x50942a(0x215)][_0x50942a(0x22a)]({'where':_0x36e022,'select':{'id':!![],'amount':!![],'currency':!![],'amountUSDT':!![],'amountAfterGatewayCommissionUSDT':!![],'gatewayCommissionRate':!![],'gateway':!![],'shopId':!![],'paidAt':!![],'shop':{'select':{'id':!![],'name':!![],'username':!![],'gatewaySettings':!![]}}}});console['log'](_0x50942a(0x142)+_0x26fa01[_0x50942a(0x144)]+_0x50942a(0x145));const _0x49fcf4={'gateway':{'not':_0x50942a(0x24f)},'createdAt':{'gte':_0x762da1,'lte':_0x2ba982}};_0x534f52[_0x50942a(0x227)]&&(_0x49fcf4[_0x50942a(0x227)]=_0x534f52[_0x50942a(0x227)]);const _0x256a5b=await database_1[_0x50942a(0x168)][_0x50942a(0x215)]['count']({'where':_0x49fcf4});console[_0x50942a(0x1f9)](_0x50942a(0x1cd)+_0x256a5b+_0x50942a(0x1c0)+_0x26fa01[_0x50942a(0x144)]);let _0x4d6516=0x0,_0x4b9c8a=0x0,_0x36a5bc=0x0;const _0x3dfb1f={},_0x5b46a1={},_0x31da9e={};for(const _0x1bb535 of _0x26fa01){try{const _0x38eb25=_0x1bb535[_0x50942a(0x197)]||0x0;if(_0x38eb25<=0x0){console[_0x50942a(0x1e3)](_0x50942a(0x18e)+_0x1bb535['id']+_0x50942a(0x257));continue;}let _0xe5ca3f,_0x28b3b3;if(_0x1bb535[_0x50942a(0x13e)]!==null&&_0x1bb535['amountAfterGatewayCommissionUSDT']!==undefined)_0xe5ca3f=_0x1bb535['amountAfterGatewayCommissionUSDT'],_0x28b3b3=_0x38eb25-_0xe5ca3f,console[_0x50942a(0x1f9)]('📊\x20Using\x20saved\x20values\x20for\x20payment\x20'+_0x1bb535['id']+':\x20'+_0x38eb25['toFixed'](0x6)+_0x50942a(0x192)+_0xe5ca3f['toFixed'](0x6)+_0x50942a(0x1db));else{let _0x5e672a={};if(_0x1bb535[_0x50942a(0x11c)]['gatewaySettings'])try{_0x5e672a=JSON['parse'](_0x1bb535[_0x50942a(0x11c)]['gatewaySettings']);}catch(_0x422e2b){console[_0x50942a(0x167)](_0x50942a(0x129)+_0x1bb535[_0x50942a(0x227)]+':',_0x422e2b);}let _0xaa576e=0x2d;for(const [_0x46810f,_0x371678]of Object[_0x50942a(0x255)](_0x5e672a)){if(_0x46810f[_0x50942a(0x21e)]()===_0x1bb535['gateway'][_0x50942a(0x21e)]()){_0xaa576e=_0x371678[_0x50942a(0x1de)]||0x2d;break;}}_0x28b3b3=_0x38eb25*(_0xaa576e/0x64),_0xe5ca3f=_0x38eb25-_0x28b3b3,console['log'](_0x50942a(0x25f)+_0x1bb535['id']+':\x20'+_0xaa576e+_0x50942a(0x141)+_0x38eb25[_0x50942a(0x122)](0x6)+_0x50942a(0x1db));}_0x4d6516+=_0x38eb25,_0x4b9c8a+=_0xe5ca3f,_0x36a5bc+=_0x28b3b3;let _0x4bc190;_0x1bb535[_0x50942a(0x213)]!==null&&_0x1bb535[_0x50942a(0x213)]!==undefined?(_0x4bc190=_0x1bb535['gatewayCommissionRate'],console['log'](_0x50942a(0x1ec)+_0x1bb535['id']+':\x20'+_0x4bc190+'%')):(_0x4bc190=_0x38eb25>0x0?_0x28b3b3/_0x38eb25*0x64:0x0,console[_0x50942a(0x1f9)]('📊\x20Calculated\x20commission\x20rate\x20for\x20payment\x20'+_0x1bb535['id']+':\x20'+_0x4bc190[_0x50942a(0x122)](0x2)+'%'));!_0x3dfb1f[_0x1bb535[_0x50942a(0x159)]]&&(_0x3dfb1f[_0x1bb535['gateway']]={'gateway':_0x1bb535[_0x50942a(0x159)],'gatewayDisplayName':this['getGatewayDisplayName'](_0x1bb535['gateway']),'paymentsCount':0x0,'turnoverUSDT':0x0,'commissionUSDT':0x0,'merchantEarningsUSDT':0x0,'totalCommissionRate':0x0});_0x3dfb1f[_0x1bb535[_0x50942a(0x159)]]['paymentsCount']++,_0x3dfb1f[_0x1bb535[_0x50942a(0x159)]][_0x50942a(0x234)]+=_0x38eb25,_0x3dfb1f[_0x1bb535['gateway']][_0x50942a(0x16b)]+=_0x28b3b3,_0x3dfb1f[_0x1bb535[_0x50942a(0x159)]][_0x50942a(0x1eb)]+=_0xe5ca3f,_0x3dfb1f[_0x1bb535[_0x50942a(0x159)]][_0x50942a(0x152)]+=_0x4bc190;!_0x534f52[_0x50942a(0x227)]&&(!_0x5b46a1[_0x1bb535['shopId']]&&(_0x5b46a1[_0x1bb535['shopId']]={'shopId':_0x1bb535['shopId'],'shopName':_0x1bb535[_0x50942a(0x11c)]['name'],'shopUsername':_0x1bb535['shop'][_0x50942a(0x256)],'paymentsCount':0x0,'turnoverUSDT':0x0,'commissionUSDT':0x0,'merchantEarningsUSDT':0x0,'paidOutUSDT':0x0,'averageCheckUSDT':0x0}),_0x5b46a1[_0x1bb535[_0x50942a(0x227)]]['paymentsCount']++,_0x5b46a1[_0x1bb535[_0x50942a(0x227)]][_0x50942a(0x234)]+=_0x38eb25,_0x5b46a1[_0x1bb535[_0x50942a(0x227)]][_0x50942a(0x16b)]+=_0x28b3b3,_0x5b46a1[_0x1bb535[_0x50942a(0x227)]][_0x50942a(0x1eb)]+=_0xe5ca3f);const _0x22065a=_0x1bb535[_0x50942a(0x137)][_0x50942a(0x169)]()['split']('T')[0x0];!_0x31da9e[_0x22065a]&&(_0x31da9e[_0x22065a]={'date':_0x22065a,'turnover':0x0,'merchantEarnings':0x0,'gatewayEarnings':0x0,'paymentsCount':0x0}),_0x31da9e[_0x22065a][_0x50942a(0x183)]+=_0x38eb25,_0x31da9e[_0x22065a][_0x50942a(0x1f1)]+=_0xe5ca3f,_0x31da9e[_0x22065a][_0x50942a(0x1ac)]+=_0x28b3b3,_0x31da9e[_0x22065a][_0x50942a(0x125)]++;}catch(_0x57c78b){console['error'](_0x50942a(0x182)+_0x1bb535['id']+':',_0x57c78b);}}Object['values'](_0x3dfb1f)[_0x50942a(0x154)](_0x4bbf71=>{const _0x315a04=_0x50942a;_0x4bbf71['averageCommissionRate']=_0x4bbf71[_0x315a04(0x125)]>0x0?_0x4bbf71[_0x315a04(0x152)]/_0x4bbf71[_0x315a04(0x125)]:0x0,delete _0x4bbf71[_0x315a04(0x152)];}),Object['values'](_0x5b46a1)[_0x50942a(0x154)](_0x2b209d=>{const _0x4d4a58=_0x50942a;_0x2b209d[_0x4d4a58(0x1a0)]=_0x2b209d[_0x4d4a58(0x125)]>0x0?_0x2b209d['turnoverUSDT']/_0x2b209d[_0x4d4a58(0x125)]:0x0;});let _0x161090=0x0,_0x2305f6=0x0;if(_0x534f52[_0x50942a(0x227)]){const _0x4cc00d=await database_1['default'][_0x50942a(0x23d)]['findMany']({'where':{'shopId':_0x534f52[_0x50942a(0x227)],'status':'COMPLETED','createdAt':{'gte':_0x762da1,'lte':_0x2ba982}},'select':{'amount':!![]}});_0x161090=_0x4cc00d[_0x50942a(0x13f)]((_0x2bb3f3,_0x559b42)=>_0x2bb3f3+_0x559b42['amount'],0x0);const _0xfdcc=await database_1[_0x50942a(0x168)][_0x50942a(0x23d)][_0x50942a(0x22a)]({'where':{'shopId':_0x534f52[_0x50942a(0x227)],'status':_0x50942a(0x18f),'createdAt':{'gte':_0x762da1,'lte':_0x2ba982}},'select':{'amount':!![]}});_0x2305f6=_0xfdcc[_0x50942a(0x13f)]((_0x306b4d,_0x2a7220)=>_0x306b4d+_0x2a7220[_0x50942a(0x1c3)],0x0);}const _0x27d20e=_0x256a5b,_0x298cda=_0x26fa01['length'],_0x4490ed=_0x298cda>0x0?_0x4d6516/_0x298cda:0x0,_0x4cb1ff=_0x27d20e>0x0?Math['round'](_0x298cda/_0x27d20e*0x2710)/0x64:0x0,_0x45269b=Math['ceil']((_0x2ba982[_0x50942a(0x1df)]()-_0x762da1[_0x50942a(0x1df)]())/(0x3e8*0x3c*0x3c*0x18)),_0x29f7c8={'totalTurnover':Math[_0x50942a(0x1a2)](_0x4d6516*0x64)/0x64,'merchantEarnings':Math[_0x50942a(0x1a2)](_0x4b9c8a*0x64)/0x64,'gatewayEarnings':Math[_0x50942a(0x1a2)](_0x36a5bc*0x64)/0x64,'totalPaidOut':Math['round'](_0x161090*0x64)/0x64,'pendingPayout':Math[_0x50942a(0x1a2)](_0x2305f6*0x64)/0x64,'averageCheck':Math[_0x50942a(0x1a2)](_0x4490ed*0x64)/0x64,'totalPayments':_0x27d20e,'successfulPayments':_0x298cda,'conversionRate':_0x4cb1ff,'gatewayBreakdown':Object['values'](_0x3dfb1f)[_0x50942a(0x21a)](_0x383caa=>({..._0x383caa,'turnoverUSDT':Math[_0x50942a(0x1a2)](_0x383caa['turnoverUSDT']*0x64)/0x64,'commissionUSDT':Math[_0x50942a(0x1a2)](_0x383caa['commissionUSDT']*0x64)/0x64,'merchantEarningsUSDT':Math[_0x50942a(0x1a2)](_0x383caa[_0x50942a(0x1eb)]*0x64)/0x64,'averageCommissionRate':Math[_0x50942a(0x1a2)](_0x383caa['averageCommissionRate']*0x64)/0x64})),'merchantBreakdown':_0x534f52[_0x50942a(0x227)]?undefined:Object[_0x50942a(0x1c4)](_0x5b46a1)[_0x50942a(0x21a)](_0x18eec2=>({..._0x18eec2,'turnoverUSDT':Math[_0x50942a(0x1a2)](_0x18eec2[_0x50942a(0x234)]*0x64)/0x64,'commissionUSDT':Math[_0x50942a(0x1a2)](_0x18eec2[_0x50942a(0x16b)]*0x64)/0x64,'merchantEarningsUSDT':Math['round'](_0x18eec2[_0x50942a(0x1eb)]*0x64)/0x64,'paidOutUSDT':Math[_0x50942a(0x1a2)](_0x18eec2[_0x50942a(0x190)]*0x64)/0x64,'averageCheckUSDT':Math['round'](_0x18eec2[_0x50942a(0x1a0)]*0x64)/0x64})),'dailyData':Object[_0x50942a(0x1c4)](_0x31da9e)['map'](_0x348d6c=>({..._0x348d6c,'turnover':Math[_0x50942a(0x1a2)](_0x348d6c['turnover']*0x64)/0x64,'merchantEarnings':Math[_0x50942a(0x1a2)](_0x348d6c[_0x50942a(0x1f1)]*0x64)/0x64,'gatewayEarnings':Math[_0x50942a(0x1a2)](_0x348d6c['gatewayEarnings']*0x64)/0x64}))['sort']((_0xeef1f8,_0x3dad70)=>_0xeef1f8['date'][_0x50942a(0x11e)](_0x3dad70['date'])),'periodInfo':{'from':_0x762da1,'to':_0x2ba982,'periodType':_0x534f52['period']||_0x50942a(0x230),'daysCount':_0x45269b}};return console[_0x50942a(0x1f9)](_0x50942a(0x204)),console[_0x50942a(0x1f9)](_0x50942a(0x23e)+_0x29f7c8[_0x50942a(0x1a9)]+_0x50942a(0x1db)),console[_0x50942a(0x1f9)](_0x50942a(0x1c6)+_0x29f7c8[_0x50942a(0x1f1)]+_0x50942a(0x1db)),console[_0x50942a(0x1f9)](_0x50942a(0x1ba)+_0x29f7c8[_0x50942a(0x1ac)]+'\x20USDT'),console[_0x50942a(0x1f9)]('\x20\x20\x20�\x20Total\x20paid\x20out:\x20'+_0x29f7c8[_0x50942a(0x163)]+'\x20USDT'),console[_0x50942a(0x1f9)](_0x50942a(0x171)+_0x29f7c8['pendingPayout']+_0x50942a(0x1db)),console[_0x50942a(0x1f9)](_0x50942a(0x143)+_0x29f7c8[_0x50942a(0x268)]),_0x29f7c8;}async[a38_0x718376(0x240)](){const _0x257b25=a38_0x718376;console['log'](_0x257b25(0x1dc));const _0x9f041a=await database_1['default'][_0x257b25(0x11c)]['findMany']({'where':{'status':_0x257b25(0x17a)},'select':{'id':!![],'username':!![],'name':!![]},'orderBy':{'name':_0x257b25(0x17c)}});return console[_0x257b25(0x1f9)](_0x257b25(0x243)+_0x9f041a[_0x257b25(0x144)]+_0x257b25(0x166)),_0x9f041a[_0x257b25(0x21a)](_0x181dc6=>({'id':_0x181dc6['id'],'username':_0x181dc6[_0x257b25(0x256)],'name':_0x181dc6[_0x257b25(0x1fd)]}));}[a38_0x718376(0x1b7)](_0x2bdc22){const _0x44236c=a38_0x718376,_0x1b4556={'test_gateway':_0x44236c(0x248),'plisio':_0x44236c(0x202),'rapyd':_0x44236c(0x20b),'noda':_0x44236c(0x193),'cointopay':_0x44236c(0x12a),'cointopay2':_0x44236c(0x22d),'klyme_eu':'KLYME\x20EU','klyme_gb':_0x44236c(0x236),'klyme_de':_0x44236c(0x18b),'mastercard':'MasterCard'};return _0x1b4556[_0x2bdc22]||_0x2bdc22;}[a38_0x718376(0x260)](_0x41d1e5){const _0x26a0fc=a38_0x718376,_0x11aac3={'Test\x20Gateway':_0x26a0fc(0x24f),'Plisio':_0x26a0fc(0x241),'Rapyd':'rapyd','Noda':_0x26a0fc(0x19a),'CoinToPay':_0x26a0fc(0x12d),'CoinToPay2':_0x26a0fc(0x1e6),'KLYME\x20EU':_0x26a0fc(0x133),'KLYME\x20GB':_0x26a0fc(0x1ab),'KLYME\x20DE':_0x26a0fc(0x20d),'MasterCard':_0x26a0fc(0x24a)};return _0x11aac3[_0x41d1e5]||_0x41d1e5[_0x26a0fc(0x21e)]();}async[a38_0x718376(0x25b)](_0x1e1678){const _0x5c76f8=a38_0x718376,{page:_0x534cf0,limit:_0x277a04,minAmount:_0x4fad23,search:_0x5caab4}=_0x1e1678,_0x1d09a0=(_0x534cf0-0x1)*_0x277a04;console[_0x5c76f8(0x1f9)](_0x5c76f8(0x265),_0x1e1678);const _0x285ebd={'balance':{'gt':0x0},'status':_0x5c76f8(0x17a)};_0x4fad23&&(_0x285ebd['balance'][_0x5c76f8(0x1fa)]=_0x4fad23);_0x5caab4&&(_0x285ebd[_0x5c76f8(0x1fd)]={'contains':_0x5caab4,'mode':_0x5c76f8(0x214)});const [_0x1a7db9,_0x566cca]=await Promise[_0x5c76f8(0x127)]([database_1[_0x5c76f8(0x168)][_0x5c76f8(0x11c)][_0x5c76f8(0x22a)]({'where':_0x285ebd,'skip':_0x1d09a0,'take':_0x277a04,'orderBy':{'balance':_0x5c76f8(0x23c)},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'balance':!![],'totalPaidOut':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'gatewaySettings':!![],'createdAt':!![]}}),database_1['default'][_0x5c76f8(0x11c)][_0x5c76f8(0x1d0)]({'where':_0x285ebd})]);console[_0x5c76f8(0x1f9)](_0x5c76f8(0x142)+_0x1a7db9[_0x5c76f8(0x144)]+_0x5c76f8(0x162));const _0x23ece7=await Promise['all'](_0x1a7db9['map'](async _0x6d868f=>{const _0x35e5da=_0x5c76f8,[_0x4208fa,_0x12a14f,_0x4ad0ba]=await Promise[_0x35e5da(0x127)]([database_1[_0x35e5da(0x168)][_0x35e5da(0x215)][_0x35e5da(0x1d0)]({'where':{'shopId':_0x6d868f['id'],'status':_0x35e5da(0x201),'gateway':{'not':_0x35e5da(0x24f)}}}),database_1['default']['payment'][_0x35e5da(0x1ce)]({'where':{'shopId':_0x6d868f['id'],'status':_0x35e5da(0x201),'gateway':{'not':_0x35e5da(0x24f)}},'orderBy':{'paidAt':'asc'},'select':{'paidAt':!![]}}),database_1[_0x35e5da(0x168)]['payment'][_0x35e5da(0x1ca)]({'by':[_0x35e5da(0x159)],'where':{'shopId':_0x6d868f['id'],'status':_0x35e5da(0x201),'gateway':{'not':_0x35e5da(0x24f)}},'_count':{'id':!![]},'_sum':{'amountUSDT':!![]}})]),_0x1e93b8=new Date(),_0xa07c5=new Date(_0x1e93b8[_0x35e5da(0x1bd)](),_0x1e93b8[_0x35e5da(0x1e1)](),0x1),_0xf69295=new Date(_0x1e93b8['getFullYear'](),_0x1e93b8['getMonth']()+0x1,0x0,0x17,0x3b,0x3b,0x3e7),[_0x4b09c8,_0x3838cc]=await Promise['all']([database_1[_0x35e5da(0x168)][_0x35e5da(0x23d)][_0x35e5da(0x176)]({'_sum':{'amount':!![]},'where':{'shopId':_0x6d868f['id'],'status':_0x35e5da(0x17e)}}),database_1[_0x35e5da(0x168)]['payout'][_0x35e5da(0x176)]({'_sum':{'amount':!![]},'where':{'shopId':_0x6d868f['id'],'status':_0x35e5da(0x17e),'createdAt':{'gte':_0xa07c5,'lte':_0xf69295}}})]),_0x352f2c=_0x4b09c8[_0x35e5da(0x15f)][_0x35e5da(0x1c3)]||0x0,_0x8c1361=_0x3838cc[_0x35e5da(0x15f)][_0x35e5da(0x1c3)]||0x0,_0xb7b01d=await Promise[_0x35e5da(0x127)](_0x4ad0ba['map'](async _0x558bfa=>{const _0x34bf06=_0x35e5da;let _0x415a23=0x2d;if(_0x6d868f[_0x34bf06(0x126)])try{const _0xccf241=JSON[_0x34bf06(0x19e)](_0x6d868f[_0x34bf06(0x126)]);for(const [_0x166f7f,_0x198960]of Object[_0x34bf06(0x255)](_0xccf241)){if(_0x166f7f[_0x34bf06(0x21e)]()===_0x558bfa[_0x34bf06(0x159)]['toLowerCase']()){_0x415a23=_0x198960['commission']||0xa,console[_0x34bf06(0x1f9)](_0x34bf06(0x211)+_0x558bfa[_0x34bf06(0x159)]+'\x20for\x20shop\x20'+_0x6d868f['id']+_0x34bf06(0x1d6)+_0x415a23+'%');break;}}}catch(_0xe2a3e0){console[_0x34bf06(0x167)](_0x34bf06(0x129)+_0x6d868f['id']+':',_0xe2a3e0);}const _0x1f97d2=_0x558bfa[_0x34bf06(0x15f)]?.[_0x34bf06(0x197)]||0x0,_0x4be006=_0x1f97d2*(0x1-_0x415a23/0x64);return{'gateway':_0x558bfa['gateway'],'count':_0x558bfa[_0x34bf06(0x12e)]?.['id']||0x0,'amountUSDT':Math[_0x34bf06(0x1a2)](_0x1f97d2*0x64)/0x64,'amountAfterCommissionUSDT':Math[_0x34bf06(0x1a2)](_0x4be006*0x64)/0x64,'commission':_0x415a23};})),_0x4bc921=_0xb7b01d[_0x35e5da(0x13f)]((_0x1ea72b,_0x5e8f0f)=>_0x1ea72b+_0x5e8f0f[_0x35e5da(0x197)],0x0),_0x4e4866=_0xb7b01d['reduce']((_0x550e17,_0x419d92)=>_0x550e17+_0x419d92[_0x35e5da(0x218)],0x0),_0x4902e9=_0x6d868f['balance'];return console[_0x35e5da(0x1f9)](_0x35e5da(0x180)+_0x6d868f['username']+':'),console[_0x35e5da(0x1f9)](_0x35e5da(0x22c)+_0x4bc921[_0x35e5da(0x122)](0x2)+_0x35e5da(0x155)),console[_0x35e5da(0x1f9)](_0x35e5da(0x24b)+_0x4e4866[_0x35e5da(0x122)](0x2)+'\x20USDT\x20(theoretical\x20net)'),console[_0x35e5da(0x1f9)](_0x35e5da(0x1e4)+_0x4902e9['toFixed'](0x2)+'\x20USDT\x20(current\x20balance\x20in\x20DB)'),console[_0x35e5da(0x1f9)](_0x35e5da(0x1b5)+_0x352f2c[_0x35e5da(0x122)](0x2)+_0x35e5da(0x1c2)),console[_0x35e5da(0x1f9)](_0x35e5da(0x12b)+(_0x4e4866-_0x352f2c-_0x4902e9)[_0x35e5da(0x122)](0x2)+_0x35e5da(0x250)),{'id':_0x6d868f['id'],'fullName':_0x6d868f[_0x35e5da(0x1fd)],'username':_0x6d868f['username'],'telegramId':_0x6d868f['telegram'],'merchantUrl':_0x6d868f['shopUrl'],'wallets':{'usdtPolygonWallet':_0x6d868f[_0x35e5da(0x232)],'usdtTrcWallet':_0x6d868f[_0x35e5da(0x189)],'usdtErcWallet':_0x6d868f[_0x35e5da(0x263)],'usdcPolygonWallet':_0x6d868f[_0x35e5da(0x1b2)]},'totalAmountUSDT':Math['round'](_0x4bc921*0x64)/0x64,'totalAmountAfterCommissionUSDT':Math[_0x35e5da(0x1a2)](_0x4e4866*0x64)/0x64,'currentBalance':Math[_0x35e5da(0x1a2)](_0x4902e9*0x64)/0x64,'totalPayout':Math[_0x35e5da(0x1a2)](_0x352f2c*0x64)/0x64,'thisMonth':Math[_0x35e5da(0x1a2)](_0x8c1361*0x64)/0x64,'paymentsCount':_0x4208fa,'oldestPaymentDate':_0x12a14f?.[_0x35e5da(0x137)]||_0x6d868f[_0x35e5da(0x187)],'gatewayBreakdown':_0xb7b01d};})),_0x2c361f=_0x23ece7[_0x5c76f8(0x13f)]((_0x1c88be,_0x53981c)=>_0x1c88be+_0x53981c[_0x5c76f8(0x139)],0x0),_0x4f2510=_0x23ece7['reduce']((_0x175213,_0x5b1df2)=>_0x175213+_0x5b1df2[_0x5c76f8(0x1d3)],0x0),_0x1e9979=_0x23ece7['reduce']((_0x17f3c3,_0x405ef7)=>_0x17f3c3+_0x405ef7[_0x5c76f8(0x203)],0x0),_0x3bfc54=_0x23ece7[_0x5c76f8(0x13f)]((_0x1e409e,_0x3132df)=>_0x1e409e+_0x3132df[_0x5c76f8(0x11b)],0x0);return console['log'](_0x5c76f8(0x181)+_0x566cca+'\x20merchants'),console[_0x5c76f8(0x1f9)](_0x5c76f8(0x20a)+Math[_0x5c76f8(0x1a2)](_0x2c361f*0x64)/0x64+'\x20USDT\x20(gross\x20revenue)'),console['log'](_0x5c76f8(0x18a)+Math['round'](_0x4f2510*0x64)/0x64+_0x5c76f8(0x157)),console[_0x5c76f8(0x1f9)]('\x20\x20\x20💸\x20Total\x20payouts\x20(all\x20time):\x20'+Math[_0x5c76f8(0x1a2)](_0x1e9979*0x64)/0x64+_0x5c76f8(0x1db)),console[_0x5c76f8(0x1f9)](_0x5c76f8(0x1d2)+Math[_0x5c76f8(0x1a2)](_0x3bfc54*0x64)/0x64+_0x5c76f8(0x1db)),{'merchants':_0x23ece7,'pagination':{'page':_0x534cf0,'limit':_0x277a04,'total':_0x566cca,'totalPages':Math['ceil'](_0x566cca/_0x277a04)},'summary':{'totalMerchants':_0x566cca,'totalAmountUSDT':Math[_0x5c76f8(0x1a2)](_0x2c361f*0x64)/0x64,'totalAmountAfterCommissionUSDT':Math['round'](_0x4f2510*0x64)/0x64,'totalPayout':Math['round'](_0x1e9979*0x64)/0x64,'thisMonth':Math['round'](_0x3bfc54*0x64)/0x64}};}async['createPayout'](_0x22e376){const _0x103869=a38_0x718376,{shopId:_0x1f6a81,amount:_0x3f0665,network:_0x2fc650,wallet:_0xf8d9de,notes:_0x1fc638,txid:_0x5c2908,periodFrom:_0x3e4b99,periodTo:_0x410709}=_0x22e376,_0x504a6c=await database_1[_0x103869(0x168)][_0x103869(0x11a)](async _0x32c6d5=>{const _0xe4850e=_0x103869,_0x26bd8a=await _0x32c6d5['shop'][_0xe4850e(0x261)]({'where':{'id':_0x1f6a81},'select':{'id':!![],'name':!![],'username':!![],'balance':!![],'totalPaidOut':!![]}});if(!_0x26bd8a)throw new Error('Shop\x20not\x20found');console[_0xe4850e(0x1f9)](_0xe4850e(0x208)+_0x26bd8a[_0xe4850e(0x256)]+':'),console['log'](_0xe4850e(0x22f)+_0x26bd8a[_0xe4850e(0x1c1)][_0xe4850e(0x122)](0x6)+'\x20USDT'),console[_0xe4850e(0x1f9)](_0xe4850e(0x19b)+_0x3f0665[_0xe4850e(0x122)](0x6)+'\x20USDT'),console[_0xe4850e(0x1f9)](_0xe4850e(0x195)+_0x26bd8a[_0xe4850e(0x163)][_0xe4850e(0x122)](0x6)+'\x20USDT');if(_0x5c2908)console[_0xe4850e(0x1f9)](_0xe4850e(0x1e8)+_0x5c2908);if(_0x26bd8a['balance']<_0x3f0665)throw new Error(_0xe4850e(0x1d5)+_0x26bd8a[_0xe4850e(0x1c1)][_0xe4850e(0x122)](0x6)+_0xe4850e(0x1a6)+_0x3f0665[_0xe4850e(0x122)](0x6)+'\x20USDT');let _0x5a4283=_0xf8d9de;if(!_0x5a4283){const _0x14280a=await _0x32c6d5['shop'][_0xe4850e(0x261)]({'where':{'id':_0x1f6a81},'select':{'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![]}});if(_0x14280a)switch(_0x2fc650){case _0xe4850e(0x21c):_0x5a4283=_0x14280a[_0xe4850e(0x232)]||undefined;break;case _0xe4850e(0x1f4):_0x5a4283=_0x14280a[_0xe4850e(0x189)]||undefined;break;case _0xe4850e(0x217):_0x5a4283=_0x14280a['usdtErcWallet']||undefined;break;case _0xe4850e(0x258):_0x5a4283=_0x14280a[_0xe4850e(0x1b2)]||undefined;break;}}console[_0xe4850e(0x1f9)](_0xe4850e(0x128)+_0x2fc650+':\x20'+(_0x5a4283||_0xe4850e(0x1f0)));const _0x4ce473=await _0x32c6d5['payout']['create']({'data':{'shopId':_0x1f6a81,'amount':_0x3f0665,'network':_0x2fc650,'status':_0xe4850e(0x17e),'txid':_0x5c2908,'notes':_0x1fc638,'periodFrom':_0x3e4b99?new Date(_0x3e4b99):null,'periodTo':_0x410709?new Date(_0x410709):null,'createdAt':new Date(),'paidAt':new Date()}}),_0x424325=_0x26bd8a[_0xe4850e(0x1c1)]-_0x3f0665,_0x10f719=_0x26bd8a[_0xe4850e(0x163)]+_0x3f0665;return await _0x32c6d5[_0xe4850e(0x11c)][_0xe4850e(0x266)]({'where':{'id':_0x1f6a81},'data':{'balance':_0x424325,'totalPaidOut':_0x10f719}}),console[_0xe4850e(0x1f9)](_0xe4850e(0x132)+_0x26bd8a[_0xe4850e(0x256)]+_0xe4850e(0x1c5)),console[_0xe4850e(0x1f9)](_0xe4850e(0x252)+_0x26bd8a[_0xe4850e(0x1c1)][_0xe4850e(0x122)](0x6)+'\x20->\x20'+_0x424325[_0xe4850e(0x122)](0x6)+_0xe4850e(0x216)+_0x3f0665['toFixed'](0x6)+')'),console['log']('\x20\x20\x20Total\x20paid\x20out:\x20'+_0x26bd8a[_0xe4850e(0x163)][_0xe4850e(0x122)](0x6)+_0xe4850e(0x1b1)+_0x10f719['toFixed'](0x6)+_0xe4850e(0x1ff)+_0x3f0665[_0xe4850e(0x122)](0x6)+')'),{'payout':_0x4ce473,'shop':_0x26bd8a};});return console['log'](_0x103869(0x1bc)+_0x504a6c[_0x103869(0x23d)]['id']+_0x103869(0x24e)+_0x504a6c[_0x103869(0x11c)][_0x103869(0x256)]+'\x20('+_0x3f0665+_0x103869(0x233)),{'id':_0x504a6c[_0x103869(0x23d)]['id'],'shopId':_0x504a6c[_0x103869(0x23d)][_0x103869(0x227)],'shopName':_0x504a6c['shop']['name'],'shopUsername':_0x504a6c['shop'][_0x103869(0x256)],'amount':_0x504a6c[_0x103869(0x23d)][_0x103869(0x1c3)],'network':_0x504a6c[_0x103869(0x23d)][_0x103869(0x21d)],'status':_0x504a6c[_0x103869(0x23d)][_0x103869(0x172)],'txid':_0x504a6c[_0x103869(0x23d)][_0x103869(0x1f5)],'notes':_0x504a6c['payout'][_0x103869(0x147)],'periodFrom':_0x504a6c[_0x103869(0x23d)][_0x103869(0x209)],'periodTo':_0x504a6c[_0x103869(0x23d)][_0x103869(0x259)],'createdAt':_0x504a6c[_0x103869(0x23d)][_0x103869(0x187)],'paidAt':_0x504a6c[_0x103869(0x23d)][_0x103869(0x137)]};}async['getAllPayouts'](_0x1feac5){const _0x1a3389=a38_0x718376,{page:_0xbe49af,limit:_0x453648,shopId:_0x1169d4,network:_0x12b09e,dateFrom:_0x16be7f,dateTo:_0x36ce56,search:_0x1c53f7}=_0x1feac5,_0xe60507=(_0xbe49af-0x1)*_0x453648,_0x1c09ec={};_0x1169d4&&(_0x1c09ec[_0x1a3389(0x227)]=_0x1169d4);_0x12b09e&&(_0x1c09ec[_0x1a3389(0x21d)]=_0x12b09e);(_0x16be7f||_0x36ce56)&&(_0x1c09ec[_0x1a3389(0x187)]={},_0x16be7f&&(_0x1c09ec[_0x1a3389(0x187)][_0x1a3389(0x1fa)]=new Date(_0x16be7f)),_0x36ce56&&(_0x1c09ec[_0x1a3389(0x187)][_0x1a3389(0x247)]=new Date(_0x36ce56)));_0x1c53f7&&(_0x1c09ec['OR']=[{'shop':{'name':{'contains':_0x1c53f7,'mode':_0x1a3389(0x214)}}},{'shop':{'username':{'contains':_0x1c53f7,'mode':_0x1a3389(0x214)}}},{'notes':{'contains':_0x1c53f7,'mode':_0x1a3389(0x214)}}]);const [_0x2490bd,_0x56bac1]=await Promise[_0x1a3389(0x127)]([database_1['default']['payout']['findMany']({'where':_0x1c09ec,'skip':_0xe60507,'take':_0x453648,'orderBy':{'createdAt':'desc'},'select':{'id':!![],'shopId':!![],'amount':!![],'network':!![],'status':!![],'txid':!![],'notes':!![],'periodFrom':!![],'periodTo':!![],'createdAt':!![],'paidAt':!![],'shop':{'select':{'name':!![],'username':!![]}}}}),database_1[_0x1a3389(0x168)]['payout'][_0x1a3389(0x1d0)]({'where':_0x1c09ec})]);return{'payouts':_0x2490bd[_0x1a3389(0x21a)](_0x2e0c3b=>({'id':_0x2e0c3b['id'],'shopId':_0x2e0c3b['shopId'],'shopName':_0x2e0c3b['shop'][_0x1a3389(0x1fd)],'shopUsername':_0x2e0c3b[_0x1a3389(0x11c)]['username'],'amount':_0x2e0c3b['amount'],'network':_0x2e0c3b[_0x1a3389(0x21d)],'status':_0x2e0c3b[_0x1a3389(0x172)],'txid':_0x2e0c3b[_0x1a3389(0x1f5)],'notes':_0x2e0c3b[_0x1a3389(0x147)],'periodFrom':_0x2e0c3b[_0x1a3389(0x209)],'periodTo':_0x2e0c3b[_0x1a3389(0x259)],'createdAt':_0x2e0c3b[_0x1a3389(0x187)],'paidAt':_0x2e0c3b[_0x1a3389(0x137)]})),'pagination':{'page':_0xbe49af,'limit':_0x453648,'total':_0x56bac1,'totalPages':Math['ceil'](_0x56bac1/_0x453648)}};}async[a38_0x718376(0x223)](_0x4191d9){const _0x284d26=a38_0x718376,_0x41d95f=await database_1[_0x284d26(0x168)][_0x284d26(0x23d)][_0x284d26(0x261)]({'where':{'id':_0x4191d9},'include':{'shop':{'select':{'name':!![],'username':!![]}}}});if(!_0x41d95f)return null;return{'id':_0x41d95f['id'],'shopId':_0x41d95f[_0x284d26(0x227)],'shopName':_0x41d95f[_0x284d26(0x11c)][_0x284d26(0x1fd)],'shopUsername':_0x41d95f[_0x284d26(0x11c)][_0x284d26(0x256)],'amount':_0x41d95f[_0x284d26(0x1c3)],'network':_0x41d95f['network'],'status':_0x41d95f[_0x284d26(0x172)],'txid':_0x41d95f['txid'],'notes':_0x41d95f[_0x284d26(0x147)],'periodFrom':_0x41d95f[_0x284d26(0x209)],'periodTo':_0x41d95f['periodTo'],'createdAt':_0x41d95f[_0x284d26(0x187)],'paidAt':_0x41d95f[_0x284d26(0x137)]};}async[a38_0x718376(0x1c8)](_0x3ea49d){const _0x385b8d=a38_0x718376;await database_1['default'][_0x385b8d(0x23d)][_0x385b8d(0x19f)]({'where':{'id':_0x3ea49d}});}async['getAllPayments'](_0x10c1a7){const _0x1a682f=a38_0x718376,{page:_0x413cae,limit:_0x58122e,status:_0x25e0a2,gateway:_0x3a4486,shopId:_0x406c95,dateFrom:_0x595319,dateTo:_0x4177e4,search:_0x445d4f,currency:_0x496752,sortBy:_0x100646,sortOrder:_0x1c020a}=_0x10c1a7,_0x9407e4=(_0x413cae-0x1)*_0x58122e;console[_0x1a682f(0x1f9)](_0x1a682f(0x1f8),_0x10c1a7);const _0x13e7aa=await database_1['default'][_0x1a682f(0x215)]['groupBy']({'by':[_0x1a682f(0x159)],'_count':{'gateway':!![]}});console[_0x1a682f(0x1f9)](_0x1a682f(0x1fb),_0x13e7aa[_0x1a682f(0x21a)](_0x3d4c32=>_0x3d4c32['gateway']+'\x20('+_0x3d4c32[_0x1a682f(0x12e)][_0x1a682f(0x159)]+_0x1a682f(0x15b)));if(_0x3a4486){const _0x57d10a=_0x13e7aa['some'](_0x1d5457=>_0x1d5457[_0x1a682f(0x159)][_0x1a682f(0x21e)]()===_0x3a4486['toLowerCase']());!_0x57d10a&&_0x3a4486['toLowerCase']()!=='test_gateway'&&console[_0x1a682f(0x1f9)](_0x1a682f(0x135)+_0x3a4486+'\x27\x20not\x20found.\x20Available\x20gateways:\x20'+_0x13e7aa[_0x1a682f(0x21a)](_0x22e38e=>_0x22e38e[_0x1a682f(0x159)])[_0x1a682f(0x21f)](',\x20'));}const _0x5f5808={};_0x25e0a2&&(_0x5f5808[_0x1a682f(0x172)]=_0x25e0a2[_0x1a682f(0x235)]());if(!_0x3a4486)_0x5f5808[_0x1a682f(0x159)]={'not':_0x1a682f(0x24f)};else{if(_0x3a4486&&(_0x3a4486[_0x1a682f(0x21e)]()===_0x1a682f(0x24f)||_0x3a4486==='0000'))_0x5f5808[_0x1a682f(0x159)]=_0x1a682f(0x24f);else{let _0x3504c3=_0x3a4486;const _0x230831=(0x0,gateway_1[_0x1a682f(0x231)])(_0x3a4486);if(_0x230831)_0x3504c3=_0x230831,console[_0x1a682f(0x1f9)](_0x1a682f(0x1cb)+_0x3a4486+_0x1a682f(0x1ad)+_0x3504c3+'\x27');else{const _0x3c4342=(0x0,gateway_1['getGatewayIdByName'])(_0x3a4486);if(_0x3c4342){const _0x5635a9=(0x0,gateway_1[_0x1a682f(0x231)])(_0x3c4342);_0x5635a9&&(_0x3504c3=_0x5635a9,console[_0x1a682f(0x1f9)](_0x1a682f(0x1af)+_0x3a4486+_0x1a682f(0x200)+_0x3c4342+_0x1a682f(0x23b)+_0x3504c3+'\x27'));}else console['log']('🔍\x20Using\x20gateway\x20\x27'+_0x3a4486+'\x27\x20as\x20is\x20(not\x20found\x20in\x20mappings)');}const _0x750aa7=await database_1['default'][_0x1a682f(0x215)][_0x1a682f(0x1d0)]({'where':{'gateway':_0x3504c3[_0x1a682f(0x21e)]()},'take':0x1});_0x750aa7===0x0?(console[_0x1a682f(0x1f9)]('⚠️\x20Gateway\x20\x27'+_0x3504c3+_0x1a682f(0x1b4)+_0x3a4486+_0x1a682f(0x1e2)),_0x5f5808[_0x1a682f(0x159)]=_0x1a682f(0x1a4)):(_0x5f5808['gateway']=_0x3504c3[_0x1a682f(0x21e)](),console[_0x1a682f(0x1f9)](_0x1a682f(0x158)+_0x3504c3+'\x27\x20(from\x20\x27'+_0x3a4486+'\x27)'));}}console[_0x1a682f(0x1f9)](_0x1a682f(0x194),_0x5f5808['gateway']);_0x406c95&&(_0x5f5808[_0x1a682f(0x227)]=_0x406c95);_0x496752&&(_0x5f5808[_0x1a682f(0x20f)]=_0x496752[_0x1a682f(0x235)](),console[_0x1a682f(0x1f9)](_0x1a682f(0x134)+_0x496752[_0x1a682f(0x235)]()));(_0x595319||_0x4177e4)&&(_0x5f5808[_0x1a682f(0x187)]={},_0x595319&&(_0x5f5808[_0x1a682f(0x187)][_0x1a682f(0x1fa)]=new Date(_0x595319)),_0x4177e4&&(_0x5f5808[_0x1a682f(0x187)][_0x1a682f(0x247)]=new Date(_0x4177e4)));_0x445d4f&&(_0x5f5808['OR']=[{'id':{'contains':_0x445d4f,'mode':'insensitive'}},{'orderId':{'contains':_0x445d4f,'mode':_0x1a682f(0x214)}},{'gatewayOrderId':{'contains':_0x445d4f,'mode':_0x1a682f(0x214)}},{'customerEmail':{'contains':_0x445d4f,'mode':_0x1a682f(0x214)}},{'shop':{'name':{'contains':_0x445d4f,'mode':_0x1a682f(0x214)}}},{'shop':{'username':{'contains':_0x445d4f,'mode':'insensitive'}}}]);console[_0x1a682f(0x1f9)](_0x1a682f(0x264),JSON['stringify'](_0x5f5808,null,0x2));let _0x40f624={'createdAt':'desc'};if(_0x100646){const _0x15da83=['amount',_0x1a682f(0x187),_0x1a682f(0x191),'status',_0x1a682f(0x159),_0x1a682f(0x20f)],_0x53f7ea=['asc',_0x1a682f(0x23c)];if(_0x15da83[_0x1a682f(0x188)](_0x100646)){const _0x8f2da4=_0x53f7ea['includes'](_0x1c020a)?_0x1c020a:_0x1a682f(0x23c);_0x40f624={[_0x100646]:_0x8f2da4},console[_0x1a682f(0x1f9)](_0x1a682f(0x19c)+_0x100646+_0x1a682f(0x207)+_0x8f2da4+_0x1a682f(0x12c));}}const [_0x20f959,_0x2a44e5]=await Promise[_0x1a682f(0x127)]([database_1['default'][_0x1a682f(0x215)][_0x1a682f(0x22a)]({'where':_0x5f5808,'skip':_0x9407e4,'take':_0x58122e,'orderBy':_0x40f624,'select':{'id':!![],'shopId':!![],'amount':!![],'amountAfterGatewayCommissionUSDT':!![],'currency':!![],'sourceCurrency':!![],'status':!![],'gateway':!![],'orderId':!![],'gatewayOrderId':!![],'gatewayPaymentId':!![],'customerEmail':!![],'customerName':!![],'customerCountry':!![],'customerIp':!![],'customerUa':!![],'externalPaymentUrl':!![],'successUrl':!![],'failUrl':!![],'pendingUrl':!![],'whiteUrl':!![],'expiresAt':!![],'invoiceTotalSum':!![],'qrCode':!![],'qrUrl':!![],'country':!![],'language':!![],'amountIsEditable':!![],'maxPayments':!![],'rapydCustomer':!![],'cardLast4':!![],'paymentMethod':!![],'bankId':!![],'remitterIban':!![],'remitterName':!![],'failureMessage':!![],'usage':!![],'createdAt':!![],'updatedAt':!![],'shop':{'select':{'name':!![],'username':!![]}}}}),database_1[_0x1a682f(0x168)][_0x1a682f(0x215)]['count']({'where':_0x5f5808})]);return{'payments':_0x20f959,'pagination':{'page':_0x413cae,'limit':_0x58122e,'total':_0x2a44e5,'totalPages':Math[_0x1a682f(0x15a)](_0x2a44e5/_0x58122e)}};}async['getPaymentById'](_0x288217){const _0x6d6297=a38_0x718376,_0x453bee=await database_1[_0x6d6297(0x168)][_0x6d6297(0x215)][_0x6d6297(0x261)]({'where':{'id':_0x288217},'select':{'id':!![],'shopId':!![],'amount':!![],'amountAfterGatewayCommissionUSDT':!![],'currency':!![],'sourceCurrency':!![],'status':!![],'gateway':!![],'orderId':!![],'gatewayOrderId':!![],'gatewayPaymentId':!![],'customerEmail':!![],'customerName':!![],'customerCountry':!![],'customerIp':!![],'customerUa':!![],'externalPaymentUrl':!![],'successUrl':!![],'failUrl':!![],'pendingUrl':!![],'whiteUrl':!![],'expiresAt':!![],'invoiceTotalSum':!![],'qrCode':!![],'qrUrl':!![],'country':!![],'language':!![],'amountIsEditable':!![],'maxPayments':!![],'rapydCustomer':!![],'cardLast4':!![],'paymentMethod':!![],'bankId':!![],'remitterIban':!![],'remitterName':!![],'failureMessage':!![],'usage':!![],'createdAt':!![],'updatedAt':!![],'shop':{'select':{'name':!![],'username':!![]}}}});if(!_0x453bee)return null;return{'id':_0x453bee['id'],'shopId':_0x453bee[_0x6d6297(0x227)],'gateway':_0x453bee[_0x6d6297(0x159)],'amount':_0x453bee[_0x6d6297(0x1c3)],'currency':_0x453bee[_0x6d6297(0x20f)],'status':_0x453bee[_0x6d6297(0x172)],'orderId':_0x453bee[_0x6d6297(0x1a8)],'gatewayOrderId':_0x453bee['gatewayOrderId'],'customerEmail':_0x453bee[_0x6d6297(0x25a)],'customerName':_0x453bee['customerName'],'customerCountry':_0x453bee[_0x6d6297(0x244)],'customerIp':_0x453bee['customerIp'],'customerUa':_0x453bee[_0x6d6297(0x15e)],'failureMessage':_0x453bee[_0x6d6297(0x153)],'externalPaymentUrl':_0x453bee[_0x6d6297(0x262)],'successUrl':_0x453bee[_0x6d6297(0x1e5)],'failUrl':_0x453bee['failUrl'],'pendingUrl':_0x453bee[_0x6d6297(0x12f)],'whiteUrl':_0x453bee[_0x6d6297(0x1b0)],'createdAt':_0x453bee[_0x6d6297(0x187)],'updatedAt':_0x453bee[_0x6d6297(0x191)],'shop':_0x453bee[_0x6d6297(0x11c)]};}async[a38_0x718376(0x13a)](_0x4b4f3d,_0x48c0a5,_0x42c055,_0x57face){const _0x34d12a=a38_0x718376,_0x173ebe=await database_1[_0x34d12a(0x168)][_0x34d12a(0x11a)](async _0x433158=>{const _0x3f1625=_0x34d12a,_0x305c08=await _0x433158[_0x3f1625(0x215)]['findUnique']({'where':{'id':_0x4b4f3d},'include':{'shop':{'select':{'id':!![],'name':!![],'username':!![],'balance':!![]}}}});if(!_0x305c08)throw new Error(_0x3f1625(0x21b));const _0x530bd4=_0x305c08['status'],_0x41e547=_0x48c0a5[_0x3f1625(0x235)]();console[_0x3f1625(0x1f9)]('🔄\x20Admin\x20updating\x20payment\x20'+_0x4b4f3d+_0x3f1625(0x15d)+_0x530bd4+'\x20->\x20'+_0x41e547),console['log'](_0x3f1625(0x239)+_0x305c08[_0x3f1625(0x11c)][_0x3f1625(0x1c1)]+'\x20USDT');const _0x454c9c={'status':_0x41e547,'updatedAt':new Date(),'statusChangedBy':'admin','statusChangedAt':new Date()};_0x42c055&&(_0x454c9c[_0x3f1625(0x1ee)]=_0x42c055);_0x41e547===_0x3f1625(0x229)&&_0x57face&&(_0x454c9c['chargebackAmount']=_0x57face);let _0x48f2dd=0x0,_0x277988=_0x305c08[_0x3f1625(0x11c)][_0x3f1625(0x1c1)];if(_0x41e547==='PAID'&&_0x530bd4!==_0x3f1625(0x201)){_0x454c9c[_0x3f1625(0x137)]=new Date();const _0x17c9a4=await currencyService_1['currencyService'][_0x3f1625(0x1b8)](_0x305c08[_0x3f1625(0x1c3)],_0x305c08[_0x3f1625(0x20f)]);_0x454c9c[_0x3f1625(0x197)]=_0x17c9a4;let _0x4e0e8b=0x2d;const _0x1aa73c=await _0x433158[_0x3f1625(0x11c)][_0x3f1625(0x261)]({'where':{'id':_0x305c08['shopId']},'select':{'gatewaySettings':!![]}});if(_0x1aa73c?.[_0x3f1625(0x126)])try{const _0x48b1c0=JSON[_0x3f1625(0x19e)](_0x1aa73c[_0x3f1625(0x126)]);for(const [_0x389d5a,_0x56f1c8]of Object[_0x3f1625(0x255)](_0x48b1c0)){if(_0x389d5a[_0x3f1625(0x21e)]()===_0x305c08[_0x3f1625(0x159)][_0x3f1625(0x21e)]()){_0x4e0e8b=_0x56f1c8[_0x3f1625(0x1de)]||0xa;break;}}}catch(_0x317642){console[_0x3f1625(0x167)](_0x3f1625(0x1da)+_0x4b4f3d+':',_0x317642);}let _0x1f7c4b;_0x305c08['amountAfterGatewayCommissionUSDT']!==null&&_0x305c08[_0x3f1625(0x13e)]!==undefined?(_0x1f7c4b=_0x305c08[_0x3f1625(0x13e)],console[_0x3f1625(0x1f9)](_0x3f1625(0x1be)+_0x1f7c4b[_0x3f1625(0x122)](0x6)+_0x3f1625(0x1a1)+_0x4b4f3d)):(_0x1f7c4b=_0x17c9a4*(0x1-_0x4e0e8b/0x64),console['log'](_0x3f1625(0x1ef)+_0x4b4f3d+':\x20'+_0x4e0e8b+_0x3f1625(0x141)+_0x17c9a4[_0x3f1625(0x122)](0x6)+'\x20USDT'),_0x454c9c['amountAfterGatewayCommissionUSDT']=_0x1f7c4b,_0x454c9c[_0x3f1625(0x213)]=_0x4e0e8b),_0x48f2dd=_0x1f7c4b,_0x277988+=_0x1f7c4b,console[_0x3f1625(0x1f9)](_0x3f1625(0x130)+_0x4b4f3d+_0x3f1625(0x1c7)),console[_0x3f1625(0x1f9)](_0x3f1625(0x1a7)+_0x17c9a4['toFixed'](0x6)+_0x3f1625(0x1db)),console[_0x3f1625(0x1f9)](_0x3f1625(0x246)+_0x305c08[_0x3f1625(0x159)]+',\x20Commission:\x20'+_0x4e0e8b+'%'),console['log'](_0x3f1625(0x1ea)+_0x1f7c4b[_0x3f1625(0x122)](0x6)+_0x3f1625(0x146)+_0x4e0e8b+'%\x20commission)'),console[_0x3f1625(0x1f9)]('\x20\x20\x20Added\x20to\x20balance:\x20+'+_0x1f7c4b[_0x3f1625(0x122)](0x6)+_0x3f1625(0x1db));}else{if(_0x530bd4==='PAID'&&_0x41e547!==_0x3f1625(0x201)){if(_0x305c08[_0x3f1625(0x197)]){let _0x318634=0x2d;const _0x449abc=await _0x433158[_0x3f1625(0x11c)]['findUnique']({'where':{'id':_0x305c08[_0x3f1625(0x227)]},'select':{'gatewaySettings':!![]}});if(_0x449abc?.[_0x3f1625(0x126)])try{const _0x425a15=JSON[_0x3f1625(0x19e)](_0x449abc['gatewaySettings']);for(const [_0x45d4d6,_0x254c14]of Object[_0x3f1625(0x255)](_0x425a15)){if(_0x45d4d6[_0x3f1625(0x21e)]()===_0x305c08[_0x3f1625(0x159)][_0x3f1625(0x21e)]()){_0x318634=_0x254c14[_0x3f1625(0x1de)]||0xa;break;}}}catch(_0x35e941){console[_0x3f1625(0x167)](_0x3f1625(0x1da)+_0x4b4f3d+':',_0x35e941);}const _0x21b3d1=_0x305c08[_0x3f1625(0x197)]*(0x1-_0x318634/0x64);_0x48f2dd=-_0x21b3d1,_0x277988-=_0x21b3d1,_0x454c9c[_0x3f1625(0x197)]=null,_0x454c9c['amountAfterGatewayCommissionUSDT']=null,console[_0x3f1625(0x1f9)](_0x3f1625(0x130)+_0x4b4f3d+_0x3f1625(0x1f6)),console[_0x3f1625(0x1f9)]('\x20\x20\x20Full\x20amount:\x20'+_0x305c08[_0x3f1625(0x197)]['toFixed'](0x6)+_0x3f1625(0x1db)),console['log'](_0x3f1625(0x246)+_0x305c08['gateway']+_0x3f1625(0x212)+_0x318634+'%'),console[_0x3f1625(0x1f9)]('\x20\x20\x20Merchant\x20loses:\x20'+_0x21b3d1[_0x3f1625(0x122)](0x6)+_0x3f1625(0x146)+_0x318634+_0x3f1625(0x164)),console['log'](_0x3f1625(0x161)+_0x21b3d1['toFixed'](0x6)+_0x3f1625(0x1db));}}}_0x41e547===_0x3f1625(0x229)&&(_0x530bd4===_0x3f1625(0x201)&&_0x305c08[_0x3f1625(0x197)]&&console[_0x3f1625(0x1f9)](_0x3f1625(0x120)),_0x57face&&_0x57face>0x0&&(_0x48f2dd-=_0x57face,_0x277988-=_0x57face,console['log'](_0x3f1625(0x17f)+_0x57face[_0x3f1625(0x122)](0x6)+_0x3f1625(0x196))));_0x41e547===_0x3f1625(0x165)&&_0x530bd4===_0x3f1625(0x201)&&console[_0x3f1625(0x1f9)](_0x3f1625(0x254));const _0x17a59a=await _0x433158['payment'][_0x3f1625(0x266)]({'where':{'id':_0x4b4f3d},'data':_0x454c9c,'include':{'shop':{'select':{'name':!![],'username':!![]}}}});return _0x48f2dd!==0x0&&(await _0x433158['shop'][_0x3f1625(0x266)]({'where':{'id':_0x305c08[_0x3f1625(0x227)]},'data':{'balance':_0x277988}}),console['log'](_0x3f1625(0x132)+_0x305c08[_0x3f1625(0x227)]+_0x3f1625(0x160)+_0x305c08[_0x3f1625(0x11c)][_0x3f1625(0x1c1)][_0x3f1625(0x122)](0x6)+_0x3f1625(0x1b1)+_0x277988[_0x3f1625(0x122)](0x6)+_0x3f1625(0x237)+(_0x48f2dd>0x0?'+':'')+_0x48f2dd[_0x3f1625(0x122)](0x6)+')')),_0x17a59a;});return{'id':_0x173ebe['id'],'shopId':_0x173ebe['shopId'],'gateway':_0x173ebe['gateway'],'amount':_0x173ebe[_0x34d12a(0x1c3)],'currency':_0x173ebe['currency'],'status':_0x173ebe[_0x34d12a(0x172)],'orderId':_0x173ebe['orderId'],'gatewayOrderId':_0x173ebe[_0x34d12a(0x14d)],'customerEmail':_0x173ebe[_0x34d12a(0x25a)],'customerName':_0x173ebe[_0x34d12a(0x225)],'customerCountry':_0x173ebe[_0x34d12a(0x244)],'customerIp':_0x173ebe[_0x34d12a(0x185)],'customerUa':_0x173ebe[_0x34d12a(0x15e)],'failureMessage':_0x173ebe[_0x34d12a(0x153)],'adminNotes':_0x173ebe['adminNotes'],'chargebackAmount':_0x173ebe[_0x34d12a(0x131)],'statusChangedBy':_0x173ebe['statusChangedBy'],'statusChangedAt':_0x173ebe[_0x34d12a(0x249)],'createdAt':_0x173ebe[_0x34d12a(0x187)],'updatedAt':_0x173ebe[_0x34d12a(0x191)],'shop':_0x173ebe['shop']};}async['updateUser'](_0x179cca,_0x5db616){const _0x4ba28e=a38_0x718376,_0x2e99c1=Math['random']()[_0x4ba28e(0x22e)](0x24)[_0x4ba28e(0x138)](0x2,0x9);console[_0x4ba28e(0x1f9)](_0x4ba28e(0x16f)+_0x2e99c1+_0x4ba28e(0x242)+_0x179cca);const _0x2cd29f={..._0x5db616};_0x5db616[_0x4ba28e(0x14e)]&&_0x5db616['password'][_0x4ba28e(0x23a)]()!==''?(console[_0x4ba28e(0x1f9)](_0x4ba28e(0x1d1)+_0x2e99c1+_0x4ba28e(0x253)+_0x179cca),_0x2cd29f[_0x4ba28e(0x14e)]=await bcryptjs_1[_0x4ba28e(0x168)][_0x4ba28e(0x13b)](_0x5db616['password'],0xc)):(console[_0x4ba28e(0x1f9)](_0x4ba28e(0x1d1)+_0x2e99c1+']\x20Password\x20not\x20provided\x20or\x20empty,\x20skipping\x20password\x20update'),delete _0x2cd29f[_0x4ba28e(0x14e)]);_0x5db616[_0x4ba28e(0x1f3)]&&(_0x2cd29f['name']=_0x5db616[_0x4ba28e(0x1f3)],delete _0x2cd29f[_0x4ba28e(0x1f3)]);_0x5db616[_0x4ba28e(0x1e7)]&&(_0x2cd29f[_0x4ba28e(0x205)]=_0x5db616['telegramId'],delete _0x2cd29f[_0x4ba28e(0x1e7)]);_0x5db616[_0x4ba28e(0x228)]&&(_0x2cd29f[_0x4ba28e(0x1bb)]=_0x5db616[_0x4ba28e(0x228)],delete _0x2cd29f['merchantUrl']);if(_0x5db616[_0x4ba28e(0x219)]){const _0x1cecc6=_0x5db616['gateways'][_0x4ba28e(0x21a)](_0x5592ff=>this[_0x4ba28e(0x260)](_0x5592ff));console[_0x4ba28e(0x1f9)](_0x4ba28e(0x25d),_0x5db616[_0x4ba28e(0x219)],'->',_0x1cecc6),_0x2cd29f[_0x4ba28e(0x1ed)]=JSON['stringify'](_0x1cecc6),delete _0x2cd29f['gateways'];}_0x5db616[_0x4ba28e(0x126)]&&(console[_0x4ba28e(0x1f9)]('🔧\x20['+_0x2e99c1+']\x20Gateway\x20settings\x20before\x20saving:',_0x5db616[_0x4ba28e(0x126)]),_0x2cd29f[_0x4ba28e(0x126)]=JSON[_0x4ba28e(0x198)](_0x5db616[_0x4ba28e(0x126)]),console[_0x4ba28e(0x1f9)](_0x4ba28e(0x1b9)+_0x2e99c1+_0x4ba28e(0x17b),_0x2cd29f[_0x4ba28e(0x126)]));_0x5db616['wallets']&&(_0x5db616[_0x4ba28e(0x224)][_0x4ba28e(0x232)]!==undefined&&(_0x2cd29f[_0x4ba28e(0x232)]=_0x5db616[_0x4ba28e(0x224)][_0x4ba28e(0x232)]||null),_0x5db616[_0x4ba28e(0x224)]['usdtTrcWallet']!==undefined&&(_0x2cd29f[_0x4ba28e(0x189)]=_0x5db616['wallets'][_0x4ba28e(0x189)]||null),_0x5db616[_0x4ba28e(0x224)][_0x4ba28e(0x263)]!==undefined&&(_0x2cd29f[_0x4ba28e(0x263)]=_0x5db616[_0x4ba28e(0x224)]['usdtErcWallet']||null),_0x5db616[_0x4ba28e(0x224)][_0x4ba28e(0x1b2)]!==undefined&&(_0x2cd29f[_0x4ba28e(0x1b2)]=_0x5db616[_0x4ba28e(0x224)][_0x4ba28e(0x1b2)]||null),delete _0x2cd29f[_0x4ba28e(0x224)]);const _0x3976c9=await database_1[_0x4ba28e(0x168)][_0x4ba28e(0x11c)][_0x4ba28e(0x266)]({'where':{'id':_0x179cca},'data':_0x2cd29f,'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});return console[_0x4ba28e(0x1f9)](_0x4ba28e(0x199)+_0x2e99c1+_0x4ba28e(0x14f),_0x3976c9[_0x4ba28e(0x126)]),{'id':_0x3976c9['id'],'fullName':_0x3976c9[_0x4ba28e(0x1fd)],'username':_0x3976c9[_0x4ba28e(0x256)],'telegramId':_0x3976c9['telegram'],'merchantUrl':_0x3976c9[_0x4ba28e(0x1bb)],'gateways':_0x3976c9[_0x4ba28e(0x1ed)]?JSON[_0x4ba28e(0x19e)](_0x3976c9[_0x4ba28e(0x1ed)]):null,'gatewaySettings':_0x3976c9[_0x4ba28e(0x126)]?JSON[_0x4ba28e(0x19e)](_0x3976c9[_0x4ba28e(0x126)]):null,'publicKey':_0x3976c9[_0x4ba28e(0x121)],'wallets':{'usdtPolygonWallet':_0x3976c9[_0x4ba28e(0x232)],'usdtTrcWallet':_0x3976c9[_0x4ba28e(0x189)],'usdtErcWallet':_0x3976c9[_0x4ba28e(0x263)],'usdcPolygonWallet':_0x3976c9[_0x4ba28e(0x1b2)]},'status':_0x3976c9['status'],'createdAt':_0x3976c9[_0x4ba28e(0x187)]};}async[a38_0x718376(0x22b)](_0x48252c){const _0x455905=a38_0x718376,_0x24de17=await database_1[_0x455905(0x168)][_0x455905(0x11c)][_0x455905(0x266)]({'where':{'id':_0x48252c},'data':{'status':_0x455905(0x1e0)},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});return{'id':_0x24de17['id'],'fullName':_0x24de17[_0x455905(0x1fd)],'username':_0x24de17[_0x455905(0x256)],'telegramId':_0x24de17['telegram'],'merchantUrl':_0x24de17[_0x455905(0x1bb)],'gateways':_0x24de17[_0x455905(0x1ed)]?JSON[_0x455905(0x19e)](_0x24de17[_0x455905(0x1ed)]):null,'gatewaySettings':_0x24de17[_0x455905(0x126)]?JSON['parse'](_0x24de17['gatewaySettings']):null,'publicKey':_0x24de17[_0x455905(0x121)],'wallets':{'usdtPolygonWallet':_0x24de17[_0x455905(0x232)],'usdtTrcWallet':_0x24de17['usdtTrcWallet'],'usdtErcWallet':_0x24de17['usdtErcWallet'],'usdcPolygonWallet':_0x24de17['usdcPolygonWallet']},'status':_0x24de17[_0x455905(0x172)],'createdAt':_0x24de17[_0x455905(0x187)]};}async['activateUser'](_0x90bb61){const _0x231471=a38_0x718376,_0x826a2f=await database_1[_0x231471(0x168)][_0x231471(0x11c)]['update']({'where':{'id':_0x90bb61},'data':{'status':'ACTIVE'},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});return{'id':_0x826a2f['id'],'fullName':_0x826a2f[_0x231471(0x1fd)],'username':_0x826a2f[_0x231471(0x256)],'telegramId':_0x826a2f['telegram'],'merchantUrl':_0x826a2f[_0x231471(0x1bb)],'gateways':_0x826a2f[_0x231471(0x1ed)]?JSON['parse'](_0x826a2f['paymentGateways']):null,'gatewaySettings':_0x826a2f[_0x231471(0x126)]?JSON['parse'](_0x826a2f[_0x231471(0x126)]):null,'publicKey':_0x826a2f[_0x231471(0x121)],'wallets':{'usdtPolygonWallet':_0x826a2f[_0x231471(0x232)],'usdtTrcWallet':_0x826a2f[_0x231471(0x189)],'usdtErcWallet':_0x826a2f[_0x231471(0x263)],'usdcPolygonWallet':_0x826a2f[_0x231471(0x1b2)]},'status':_0x826a2f[_0x231471(0x172)],'createdAt':_0x826a2f[_0x231471(0x187)]};}async[a38_0x718376(0x226)](_0xf390cd){const _0xca07cb=a38_0x718376,{page:_0x12c7a5,limit:_0x5995ad,status:_0x3d189c}=_0xf390cd,_0x3290bf=(_0x12c7a5-0x1)*_0x5995ad,_0x163332={};_0x3d189c&&(_0x163332['status']=_0x3d189c[_0xca07cb(0x235)]());const [_0x16fd63,_0xf6372a]=await Promise[_0xca07cb(0x127)]([database_1[_0xca07cb(0x168)][_0xca07cb(0x11c)][_0xca07cb(0x22a)]({'where':_0x163332,'skip':_0x3290bf,'take':_0x5995ad,'orderBy':{'createdAt':_0xca07cb(0x23c)},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}}),database_1[_0xca07cb(0x168)]['shop']['count']({'where':_0x163332})]);return{'users':_0x16fd63[_0xca07cb(0x21a)](_0x1816d0=>{const _0x5a6378=_0xca07cb,_0xe22dbf=_0x1816d0[_0x5a6378(0x1ed)]?JSON[_0x5a6378(0x19e)](_0x1816d0[_0x5a6378(0x1ed)]):null,_0x149a99=_0xe22dbf?_0xe22dbf[_0x5a6378(0x21a)](_0x33175a=>this[_0x5a6378(0x1b7)](_0x33175a)):null;return{'id':_0x1816d0['id'],'fullName':_0x1816d0[_0x5a6378(0x1fd)],'username':_0x1816d0[_0x5a6378(0x256)],'telegramId':_0x1816d0[_0x5a6378(0x205)],'merchantUrl':_0x1816d0['shopUrl'],'gateways':_0x149a99,'gatewaySettings':_0x1816d0[_0x5a6378(0x126)]?JSON['parse'](_0x1816d0[_0x5a6378(0x126)]):null,'publicKey':_0x1816d0['publicKey'],'wallets':{'usdtPolygonWallet':_0x1816d0[_0x5a6378(0x232)],'usdtTrcWallet':_0x1816d0[_0x5a6378(0x189)],'usdtErcWallet':_0x1816d0[_0x5a6378(0x263)],'usdcPolygonWallet':_0x1816d0[_0x5a6378(0x1b2)]},'status':_0x1816d0[_0x5a6378(0x172)],'createdAt':_0x1816d0['createdAt']};}),'pagination':{'page':_0x12c7a5,'limit':_0x5995ad,'total':_0xf6372a,'totalPages':Math['ceil'](_0xf6372a/_0x5995ad)}};}async['getUserById'](_0xe5afd0){const _0x1c1dcd=a38_0x718376,_0xb9b216=await database_1[_0x1c1dcd(0x168)][_0x1c1dcd(0x11c)][_0x1c1dcd(0x261)]({'where':{'id':_0xe5afd0},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});if(!_0xb9b216)return null;const _0x3a5b0b=_0xb9b216[_0x1c1dcd(0x1ed)]?JSON[_0x1c1dcd(0x19e)](_0xb9b216['paymentGateways']):null,_0x47533f=_0x3a5b0b?_0x3a5b0b[_0x1c1dcd(0x21a)](_0x15e692=>this['getGatewayDisplayName'](_0x15e692)):null;return _0x3a5b0b&&_0x47533f&&console[_0x1c1dcd(0x1f9)](_0x1c1dcd(0x20e),_0x3a5b0b,'->',_0x47533f),{'id':_0xb9b216['id'],'fullName':_0xb9b216[_0x1c1dcd(0x1fd)],'username':_0xb9b216[_0x1c1dcd(0x256)],'telegramId':_0xb9b216[_0x1c1dcd(0x205)],'merchantUrl':_0xb9b216[_0x1c1dcd(0x1bb)],'gateways':_0x47533f,'gatewaySettings':_0xb9b216[_0x1c1dcd(0x126)]?JSON[_0x1c1dcd(0x19e)](_0xb9b216[_0x1c1dcd(0x126)]):null,'publicKey':_0xb9b216[_0x1c1dcd(0x121)],'wallets':{'usdtPolygonWallet':_0xb9b216[_0x1c1dcd(0x232)],'usdtTrcWallet':_0xb9b216[_0x1c1dcd(0x189)],'usdtErcWallet':_0xb9b216[_0x1c1dcd(0x263)],'usdcPolygonWallet':_0xb9b216[_0x1c1dcd(0x1b2)]},'status':_0xb9b216[_0x1c1dcd(0x172)],'createdAt':_0xb9b216['createdAt']};}async[a38_0x718376(0x1fc)](_0x4fcc86){const _0x2aab90=a38_0x718376,{fullName:_0x17b53a,username:_0x51e0cf,password:_0x212e5c,telegramId:_0x2e86ce,merchantUrl:_0xd3cf48,gateways:_0x57ce84,gatewaySettings:_0x5d775f,wallets:_0x1b03db}=_0x4fcc86,_0x1fb8cc=await database_1[_0x2aab90(0x168)]['shop'][_0x2aab90(0x261)]({'where':{'username':_0x51e0cf}});if(_0x1fb8cc)throw new Error(_0x2aab90(0x1ae));if(_0x2e86ce){const _0x5af330=await database_1[_0x2aab90(0x168)][_0x2aab90(0x11c)][_0x2aab90(0x261)]({'where':{'telegram':_0x2e86ce}});if(_0x5af330)throw new Error(_0x2aab90(0x19d));}const _0xa33acf=await bcryptjs_1['default'][_0x2aab90(0x13b)](_0x212e5c,0xc),_0x463e38=_0x2aab90(0x170)+crypto_1[_0x2aab90(0x168)]['randomBytes'](0x20)[_0x2aab90(0x22e)]('hex'),_0x5c7f6f=_0x2aab90(0x1dd)+crypto_1[_0x2aab90(0x168)][_0x2aab90(0x178)](0x20)[_0x2aab90(0x22e)](_0x2aab90(0x174)),_0x11b643=_0x57ce84?_0x57ce84[_0x2aab90(0x21a)](_0xdf70e4=>this[_0x2aab90(0x260)](_0xdf70e4)):null;_0x57ce84&&_0x11b643&&console[_0x2aab90(0x1f9)](_0x2aab90(0x140),_0x57ce84,'->',_0x11b643);const _0x36d11c=await database_1[_0x2aab90(0x168)]['shop'][_0x2aab90(0x186)]({'data':{'name':_0x17b53a,'username':_0x51e0cf,'password':_0xa33acf,'telegram':_0x2e86ce,'shopUrl':_0xd3cf48,'paymentGateways':_0x11b643?JSON[_0x2aab90(0x198)](_0x11b643):null,'gatewaySettings':_0x5d775f?JSON['stringify'](_0x5d775f):null,'usdtPolygonWallet':_0x1b03db?.[_0x2aab90(0x232)]||null,'usdtTrcWallet':_0x1b03db?.['usdtTrcWallet']||null,'usdtErcWallet':_0x1b03db?.[_0x2aab90(0x263)]||null,'usdcPolygonWallet':_0x1b03db?.[_0x2aab90(0x1b2)]||null,'publicKey':_0x463e38,'secretKey':_0x5c7f6f,'status':'ACTIVE'},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});return{'id':_0x36d11c['id'],'fullName':_0x36d11c[_0x2aab90(0x1fd)],'username':_0x36d11c[_0x2aab90(0x256)],'telegramId':_0x36d11c[_0x2aab90(0x205)],'merchantUrl':_0x36d11c[_0x2aab90(0x1bb)],'gateways':_0x36d11c[_0x2aab90(0x1ed)]?JSON['parse'](_0x36d11c[_0x2aab90(0x1ed)]):null,'gatewaySettings':_0x36d11c[_0x2aab90(0x126)]?JSON[_0x2aab90(0x19e)](_0x36d11c[_0x2aab90(0x126)]):null,'publicKey':_0x36d11c[_0x2aab90(0x121)],'wallets':{'usdtPolygonWallet':_0x36d11c['usdtPolygonWallet'],'usdtTrcWallet':_0x36d11c['usdtTrcWallet'],'usdtErcWallet':_0x36d11c[_0x2aab90(0x263)],'usdcPolygonWallet':_0x36d11c['usdcPolygonWallet']},'status':_0x36d11c[_0x2aab90(0x172)],'createdAt':_0x36d11c[_0x2aab90(0x187)]};}async['deleteUser'](_0x324441){const _0x4d035b=a38_0x718376;await database_1[_0x4d035b(0x168)][_0x4d035b(0x11c)][_0x4d035b(0x19f)]({'where':{'id':_0x324441}});}[a38_0x718376(0x267)](_0x5bb8cb,_0x4562b4,_0x828ff3){const _0x3e4b48=a38_0x718376,_0x570749=new Map(),_0x2f7b97=new Date(_0x4562b4);while(_0x2f7b97<=_0x828ff3){const _0x4de0aa=_0x2f7b97[_0x3e4b48(0x169)]()[_0x3e4b48(0x221)]('T')[0x0];_0x570749['set'](_0x4de0aa,{'revenue':0x0,'count':0x0}),_0x2f7b97[_0x3e4b48(0x16d)](_0x2f7b97[_0x3e4b48(0x14b)]()+0x1);}for(const _0x15f6a4 of _0x5bb8cb){const _0x4b118e=_0x15f6a4[_0x3e4b48(0x187)][_0x3e4b48(0x169)]()['split']('T')[0x0],_0x4029ac=_0x570749['get'](_0x4b118e);_0x4029ac&&(_0x4029ac[_0x3e4b48(0x1d0)]+=0x1,_0x15f6a4[_0x3e4b48(0x172)]===_0x3e4b48(0x201)&&(_0x15f6a4[_0x3e4b48(0x197)]?_0x4029ac[_0x3e4b48(0x238)]+=_0x15f6a4['amountUSDT']:console[_0x3e4b48(0x1f9)](_0x3e4b48(0x18e)+_0x15f6a4['id']+'\x20missing\x20amountUSDT,\x20using\x20fallback\x20conversion')));}const _0x4bcd04=[],_0x259cc2=[];for(const [_0xa9b2e6,_0x4169d9]of _0x570749){_0x4bcd04[_0x3e4b48(0x175)]({'date':_0xa9b2e6,'amount':Math[_0x3e4b48(0x1a2)](_0x4169d9[_0x3e4b48(0x238)]*0x64)/0x64}),_0x259cc2[_0x3e4b48(0x175)]({'date':_0xa9b2e6,'count':_0x4169d9[_0x3e4b48(0x1d0)]});}return{'dailyRevenue':_0x4bcd04,'dailyPayments':_0x259cc2};}}function a38_0x468e(_0x2d5b03,_0xcf7d9a){const _0x1b8304=a38_0x1b83();return a38_0x468e=function(_0x468e39,_0x1be795){_0x468e39=_0x468e39-0x11a;let _0x4f6030=_0x1b8304[_0x468e39];return _0x4f6030;},a38_0x468e(_0x2d5b03,_0xcf7d9a);}function a38_0x1b83(){const _0x2a2f07=['Telegram\x20username\x20already\x20exists','parse','delete','averageCheckUSDT','\x20USDT\x20for\x20payment\x20','round','../config/database','NONEXISTENT_GATEWAY_FILTER','2LETDRl','\x20USDT,\x20Requested:\x20','\x20\x20\x20Full\x20amount:\x20','orderId','totalTurnover','crypto','klyme_gb','gatewayEarnings','\x27\x20to\x20name\x20\x27','Username\x20already\x20exists','🔄\x20Converted\x20gateway\x20name\x20\x27','whiteUrl','\x20->\x20','usdcPolygonWallet','__importDefault','\x27\x20(from\x20\x27','\x20\x20\x20💸\x20Total\x20payouts:\x20','yesterday','getGatewayDisplayName','convertToUSDT','🔧\x20[','\x20\x20\x20🏪\x20Gateway\x20earnings:\x20','shopUrl','✅\x20Payout\x20created:\x20','getFullYear','📊\x20[ADMIN]\x20Using\x20saved\x20amountAfterGatewayCommissionUSDT:\x20','\x20\x20\x20🌐\x20IP:\x20',',\x20successful:\x20','balance','\x20USDT\x20(already\x20paid\x20out)','amount','values','\x20balance\x20updated:','\x20\x20\x20👤\x20Merchant\x20earnings:\x20','\x20became\x20PAID:','deletePayout','\x20\x20\x20💳\x20Total\x20payments:\x20','groupBy','🔄\x20Converted\x20gateway\x20ID\x20\x27','dailyRevenue','📊\x20Total\x20payments\x20(including\x20failed):\x20','findFirst','defineProperty','count','🔐\x20[','\x20\x20\x20📅\x20Total\x20payouts\x20(this\x20month):\x20','totalAmountAfterCommissionUSDT','215984qQFbhy','Insufficient\x20balance.\x20Available:\x20',':\x20commission\x20=\x20','📅\x20Period:\x20','888350hniYVD','\x20\x20\x20📅\x20This\x20month:\x20','Error\x20parsing\x20gateway\x20settings\x20for\x20payment\x20','\x20USDT','📋\x20Getting\x20merchants\x20selection\x20list...','sk_','commission','getTime','SUSPENDED','getMonth','\x27)\x20not\x20found\x20in\x20database,\x20returning\x20empty\x20result','warn','\x20\x20\x20✅\x20Actual\x20available\x20balance:\x20','successUrl','cointopay2','telegramId','\x20\x20\x20Transaction\x20hash:\x20','56919jqMtHd','\x20\x20\x20Merchant\x20gets:\x20','merchantEarningsUSDT','📊\x20Using\x20saved\x20commission\x20rate\x20for\x20payment\x20','paymentGateways','adminNotes','📊\x20[ADMIN]\x20Calculating\x20commission\x20manually\x20for\x20payment\x20','not\x20specified','merchantEarnings','📊\x20Calculating\x20payout\x20statistics...','fullName','trc20','txid','\x20no\x20longer\x20PAID:','526880nRYoev','📊\x20Getting\x20payments\x20with\x20filters:','log','gte','📊\x20Available\x20gateways\x20in\x20database:','createUser','name','🔄\x20Updating\x20customer\x20data\x20for\x20payment\x20','\x20USDT\x20(+','\x27\x20->\x20ID\x20\x27','PAID','Plisio','totalPayout','📊\x20Merchant\x20statistics\x20calculated:','telegram','updateCustomerData','\x20in\x20','💰\x20Creating\x20payout\x20for\x20shop\x20','periodFrom','\x20\x20\x20💰\x20Total\x20payments\x20turnover:\x20','Rapyd','\x20\x20\x20💵\x20Available\x20balance:\x20','klyme_de','🔄\x20Gateway\x20mapping\x20(get):','currency','dailyPayments','💰\x20[PAYOUT]\x20Gateway\x20',',\x20Commission:\x20','gatewayCommissionRate','insensitive','payment','\x20USDT\x20(-','erc20','amountAfterCommissionUSDT','gateways','map','Payment\x20not\x20found','polygon','network','toLowerCase','join','dateFrom','split','AdminService','getPayoutById','wallets','customerName','getAllUsers','shopId','merchantUrl','CHARGEBACK','findMany','suspendUser','\x20\x20\x20�\x20Total\x20payments\x20turnover:\x20','Open\x20Banking\x202','toString','\x20\x20\x20Current\x20balance:\x20','custom','getGatewayNameById','usdtPolygonWallet','\x20USDT)','turnoverUSDT','toUpperCase','KLYME\x20GB','\x20USDT\x20(','revenue','💰\x20Current\x20shop\x20balance:\x20','trim','\x27\x20->\x20name\x20\x27','desc','payout','\x20\x20\x20💰\x20Total\x20turnover:\x20','117eKaZpb','getMerchantsSelection','plisio',',\x20userId:\x20','📋\x20Found\x20','customerCountry','12330GdDsxk','\x20\x20\x20Gateway:\x20','lte','Test\x20Gateway','statusChangedAt','mastercard','\x20\x20\x20🔍\x20Calculated\x20after\x20commission:\x20','bcryptjs','1389244cianSK','\x20for\x20shop\x20','test_gateway','\x20USDT\x20(calculated\x20-\x20payouts\x20-\x20balance)','awaitingPayout','\x20\x20\x20Balance:\x20',']\x20Updating\x20password\x20for\x20user\x20','🔄\x20REFUND:\x20Payment\x20amount\x20already\x20deducted\x20from\x20balance','entries','username','\x20has\x20zero\x20or\x20null\x20amountUSDT,\x20skipping...','polygon_usdc','periodTo','customerEmail','getMerchantsAwaitingPayout','month','🔄\x20Gateway\x20mapping:','\x20\x20\x20🌍\x20Country:\x20','📊\x20Calculating\x20commission\x20manually\x20for\x20payment\x20','getGatewayInternalName','findUnique','externalPaymentUrl','usdtErcWallet','📊\x20Final\x20WHERE\x20conditions:','📊\x20Getting\x20merchants\x20awaiting\x20payout\x20with\x20filters:','update','generateDailyStatistics','totalPayments','$transaction','thisMonth','shop','\x20\x20\x20⏳\x20Awaiting\x20payout:\x20','localeCompare','\x20PAID\x20payments','💸\x20CHARGEBACK:\x20Merchant\x20amount\x20already\x20deducted\x20from\x20balance','publicKey','toFixed','day','setHours','paymentsCount','gatewaySettings','all','💳\x20Payout\x20wallet\x20for\x20','Error\x20parsing\x20gateway\x20settings\x20for\x20shop\x20','CoinToPay','\x20\x20\x20🤔\x20Difference:\x20','\x20order','cointopay','_count','pendingUrl','💰\x20Payment\x20','chargebackAmount','💰\x20Shop\x20','klyme_eu','💱\x20Currency\x20filter\x20applied:\x20','⚠️\x20Requested\x20gateway\x20\x27','30d','paidAt','substr','totalAmountUSDT','updatePaymentStatus','hash','getSystemStatistics','./currencyService','amountAfterGatewayCommissionUSDT','reduce','🔄\x20Gateway\x20mapping\x20(create):','%\x20from\x20','💰\x20Found\x20','\x20\x20\x20�📊\x20Total\x20payments:\x20','length','\x20paid\x20payments\x20for\x20analysis','\x20USDT\x20(after\x20','notes','1134RVlvhz','currencyService','📊\x20Getting\x20merchant\x20statistics\x20with\x20filters:','getDate','\x20\x20\x20🖥️\x20User\x20Agent:\x20','gatewayOrderId','password',']\x20User\x20updated,\x20gatewaySettings\x20from\x20DB:','__esModule','📊\x20Payout\x20statistics\x20calculated:','totalCommissionRate','failureMessage','forEach','\x20USDT\x20(gross\x20revenue)','33215uaqEKh','\x20USDT\x20(actual\x20balances)','✅\x20Using\x20gateway\x20filter:\x20\x27','gateway','ceil','\x20payments)','\x20\x20\x20💰\x20Total\x20payout:\x20','\x20status:\x20','customerUa','_sum','\x20balance\x20updated:\x20','\x20\x20\x20Subtracted\x20from\x20balance:\x20-','\x20merchants\x20with\x20positive\x20balance','totalPaidOut','%\x20commission)','REFUND','\x20active\x20merchants\x20for\x20selection','error','default','toISOString','set','commissionUSDT','✅\x20Customer\x20data\x20updated\x20for\x20payment\x20','setDate','week','🎯\x20updateUser\x20called\x20with\x20ID:\x20','pk_','\x20\x20\x20⏳\x20Pending\x20payout:\x20','status','period','hex','push','aggregate','dateTo','randomBytes','\x20USDT\x20(total\x20paid\x20to\x20merchants)','ACTIVE',']\x20Gateway\x20settings\x20JSON\x20string:','asc','2020-01-01','COMPLETED','💸\x20CHARGEBACK\x20penalty:\x20-','💰\x20[PAYOUT]\x20Merchant\x20','📊\x20Merchants\x20awaiting\x20payout:\x20','Error\x20processing\x20payment\x20','turnover','\x20USDT\x20(sum\x20of\x20all\x20merchant\x20balances)','customerIp','create','createdAt','includes','usdtTrcWallet','\x20\x20\x20✅\x20Total\x20available\x20for\x20payout:\x20','KLYME\x20DE','\x20to\x20','\x20USDT\x20(same\x20as\x20awaiting)','⚠️\x20Payment\x20','PENDING','paidOutUSDT','updatedAt','\x20USDT,\x20merchant:\x20','Noda','📊\x20Gateway\x20filter\x20applied:','\x20\x20\x20Current\x20total\x20paid\x20out:\x20','\x20USDT\x20from\x20balance','amountUSDT','stringify','🎯\x20[','noda','\x20\x20\x20Payout\x20amount:\x20','📊\x20Sorting\x20payments\x20by\x20'];a38_0x1b83=function(){return _0x2a2f07;};return a38_0x1b83();}exports[a38_0x718376(0x222)]=AdminService;