'use strict';const a48_0x230d10=a48_0x3ff4;function a48_0x3ff4(_0x20ad19,_0x4c6bb7){_0x20ad19=_0x20ad19-0x1cc;const _0x25b064=a48_0x25b0();let _0x3ff463=_0x25b064[_0x20ad19];return _0x3ff463;}(function(_0x274045,_0x69cd){const _0x21f08c=a48_0x3ff4,_0x11254f=_0x274045();while(!![]){try{const _0x77f888=parseInt(_0x21f08c(0x218))/0x1*(parseInt(_0x21f08c(0x316))/0x2)+parseInt(_0x21f08c(0x32c))/0x3+-parseInt(_0x21f08c(0x337))/0x4+parseInt(_0x21f08c(0x28a))/0x5+parseInt(_0x21f08c(0x2e9))/0x6+parseInt(_0x21f08c(0x25c))/0x7*(-parseInt(_0x21f08c(0x300))/0x8)+-parseInt(_0x21f08c(0x29c))/0x9*(-parseInt(_0x21f08c(0x333))/0xa);if(_0x77f888===_0x69cd)break;else _0x11254f['push'](_0x11254f['shift']());}catch(_0x25c120){_0x11254f['push'](_0x11254f['shift']());}}}(a48_0x25b0,0x75bc0));var __importDefault=this&&this['__importDefault']||function(_0x424b1d){const _0x33a3fa=a48_0x3ff4;return _0x424b1d&&_0x424b1d[_0x33a3fa(0x353)]?_0x424b1d:{'default':_0x424b1d};};Object[a48_0x230d10(0x253)](exports,'__esModule',{'value':!![]}),exports[a48_0x230d10(0x34e)]=void 0x0;const database_1=__importDefault(require('../config/database')),bcryptjs_1=__importDefault(require(a48_0x230d10(0x1cc))),crypto_1=__importDefault(require(a48_0x230d10(0x22b))),fs_1=__importDefault(require('fs')),path_1=__importDefault(require(a48_0x230d10(0x295))),speakeasy_1=__importDefault(require(a48_0x230d10(0x303))),qrcode_1=__importDefault(require(a48_0x230d10(0x33e))),config_1=require('../config/config'),currencyService_1=require('./currencyService'),telegramBotService_1=require('./telegramBotService'),gateway_1=require(a48_0x230d10(0x268));function a48_0x25b0(){const _0x173f14=['payout','\x20\x20\x20ðŸ’°\x20Total\x20payout:\x20','asc','getPayoutById','gatewayOrderId','\x20missing\x20amountUSDT,\x20using\x20fallback\x20conversion','Invalid\x202FA\x20token\x20or\x20backup\x20code','ðŸ“…\x20Date\x20to\x20filter:\x20','erc20_usdc','AmPay\x20TRY','âš ï¸\x20Payment\x20','admin','setDate','network','AmPay','round','totalAmountAfterCommissionUSDT','8rYZPXw','\x20\x20\x20Amount\x20decreased\x20by\x20','stringify','speakeasy','ðŸ“‹\x20Getting\x20merchants\x20selection\x20list...','Error\x20parsing\x20gateway\x20settings\x20for\x20shop\x20','passwordHash','TrapaPay\x20Admin\x20(',']\x20Updating\x20password\x20for\x20user\x20',',\x20Commission:\x20','min','\x20\x20\x20Total\x20paid\x20out:\x20','balance','ðŸ“Š\x20Merchant\x20statistics\x20calculated:','publicKey','merchantEarnings','2FA\x20not\x20set\x20up.\x20Please\x20call\x20setup\x20endpoint\x20first','\x20\x20\x20Full\x20amount:\x20','REFUND','amount','\x20USDT\x20(gross\x20revenue)','âœ…\x20Using\x20gateway\x20filter:\x20\x27','9002CRcMoy','disable2FA','\x20\x20\x20New\x20amount:\x20','ADMIN_BACKUP_CODES=','deleteUser','ðŸ”\x20Initial\x20wallet\x20from\x20request:\x20','utf8','externalPaymentUrl','ðŸŽ¯\x20[','averageCheckUSDT','setHours','Payment\x20not\x20found','readFileSync','all','ADMIN_2FA_ENABLED=true','ðŸ”\x20Admin\x202FA\x20enabled','availableBalance','reduce','getPayoutStats','includes','yesterday','setUTCDate','501480ERnCzU','\x20has\x20zero\x20or\x20null\x20amountUSDT,\x20skipping...','\x20\x20\x20Available\x20(number):\x20','password','customerEmail','\x20\x20\x20ï¿½\x20Total\x20paid\x20out:\x20','Amer','10onCELv','\x20backup\x20codes','usdcErcWallet','telegramBotService','3441488pLgdtw','CHARGEBACK','ðŸ“Š\x20[ADMIN]\x20Calculating\x20commission\x20manually\x20for\x20payment\x20','month','last_month','customerCountry','gateway','qrcode','parse','currencyService','\x20USDT,\x20Difference:\x20','CoinToPay','\x20\x20\x20ðŸ“…\x20Total\x20payouts\x20(this\x20month):\x20','thisMonth','currency','failUrl','updatePaymentStatus','ðŸ”\x20Total\x20payments\x20matching\x20filters:\x20','orderId','\x20\x20\x20ðŸ‘¤\x20Merchant\x20earnings:\x20','ðŸ“Š\x20Final\x20WHERE\x20conditions:','updateCustomerData','sort','AdminService',',\x20successful:\x20','ðŸ’°\x20Found\x20','all_time','ðŸ”\x20Selected\x20trc20\x20wallet:\x20','__esModule','ðŸ”\x20Balance\x20check\x20details:','âœ…\x20Customer\x20data\x20updated\x20for\x20payment\x20','updateUser','merchantUrl','sk_','createUser','ðŸ’°\x20Shop\x20','periodTo','\x20\x20\x20Merchant\x20gets:\x20','OnRamp','2020-01-01','\x20\x20\x20ï¿½ðŸ“Š\x20Total\x20payments:\x20',':\x20commission\x20=\x20','ADMIN_2FA_SECRET=','_count','shopUrl','TrapaPay\x20(','hex','lte','\x20\x20\x20ðŸ’¸\x20Total\x20payouts\x20(all\x20time):\x20','\x20\x20\x20Current\x20total\x20paid\x20out:\x20','replace','compare','\x20\x20\x20ðŸŒ\x20Country:\x20',']\x20User\x20updated,\x20gatewaySettings\x20from\x20DB:','today','\x20\x20\x20Shop\x20totalPaidOut:\x20','ðŸ“Š\x20Statistics\x20date\x20range:\x20','ðŸ“‹\x20Found\x20','wallets','totalPaidOut','MasterCard','disableAdmin2FA','\x20USDT,\x20Required:\x20','\x20\x20\x20Requested\x20(number):\x20','join','\x20USDT,\x20merchant:\x20','\x20status:\x20','ðŸ”\x20Shop\x20wallets:','payouts','adminNotes','hash','\x20USDT\x20(already\x20paid\x20out)','\x27)\x20not\x20found\x20in\x20database,\x20returning\x20empty\x20result','ðŸ”\x20Admin\x20password\x20changed\x20successfully','ðŸ“…\x20Payout\x20date\x20from\x20filter:\x20','ðŸ’¸\x20CHARGEBACK\x20penalty\x20ONLY:\x20-','2FA\x20is\x20already\x20enabled','ðŸ”§\x20[','%\x20commission)','lastMonth','backupCodes','klyme_de','\x20USDT\x20from\x20balance','ðŸ’°\x20[PAYOUT]\x20Gateway\x20','gatewaySettings','slice','writeFileSync','turnover','createPayout','PENDING','verify','\x20\x20\x20Amount\x20increased\x20by\x20','bcryptjs','totalCommissionRate','_sum','klyme_gb','Plisio','\x27\x20as\x20is\x20(not\x20found\x20in\x20mappings)',']\x20Gateway\x20settings\x20before\x20saving:','polygon','sendPayoutNotification','totalTurnover','dailyPayments','splice','ðŸ’°\x20[PAYOUT]\x20Merchant\x20','periodFrom','default','getPaymentById','name','successUrl','usdtErcWallet','\x20USDT\x20(theoretical\x20net)','ðŸ’°\x20Payment\x20','dateTo','getTime','ðŸ“…\x20Date\x20from\x20filter:\x20','failureMessage','ðŸ”„\x20Updating\x20customer\x20data\x20for\x20payment\x20','\x20\x20\x20Available\x20(raw):\x20','txid','toFixed','TrapaPay\x20Admin','substr','findMany',',\x20userId:\x20','test_gateway','ðŸ“Š\x20Merchants\x20with\x20rounded\x20balance\x20!=\x200.00:\x20','findUnique','Insufficient\x20balance.\x20Available:\x20','\x20\x20\x20ðŸ’°\x20Total\x20payments\x20turnover:\x20','\x20\x20\x20Amount\x20difference:\x20','Telegram\x20username\x20already\x20exists','paymentsCount','\x20\x20\x20â³\x20Pending\x20payout:\x20','push','Invalid\x202FA\x20token','config','random','generateBackupCodes','\x20-\x20','KLYME\x20GB','\x20\x20\x20Current\x20network:\x20','ðŸ”\x202FA\x20disabled\x20for\x20shop:\x20','New\x20password\x20must\x20be\x20at\x20least\x206\x20characters\x20long','\x20USDT\x20(-','2FA\x20token\x20is\x20required','status','usdcPolygonWallet','.env','ðŸ”\x20Admin\x202FA\x20disabled','createdAt','telegramId','deletePayout','\x27\x20->\x20name\x20\x27','ADMIN_PASSWORD_HASH=','length','klyme_eu','ðŸ”‘\x20Generated\x20','ðŸ’°\x20Creating\x20payout\x20for\x20shop\x20','existsSync','\x20\x20\x20Balance:\x20','totalPayments','toString','totalPayout','\x20\x20\x20ðŸ’³\x20Total\x20payments:\x20','statusChangedBy','turnoverUSDT',']\x20Password\x20not\x20provided\x20or\x20empty,\x20skipping\x20password\x20update','134QWvAfK','entries','ðŸ’³\x20Final\x20payout\x20wallet\x20for\x20','âœ…\x20Payout\x20','ðŸ“±\x20Telegram\x20notification\x20sent\x20for\x20payout\x20','abs','\x20\x20\x20Merchant\x20loses:\x20','whiteUrl','\x20\x20\x20Difference:\x20','ACTIVE','getAllPayments','getGatewayNameById','pendingUrl','ðŸ“…\x20Payout\x20date\x20to\x20filter:\x20','customerIp','twoFactorEnabled','getDate','\x20in\x20','merchantEarningsUSDT','crypto','\x20USDT\x20(','\x20USDT\x20(total\x20paid\x20to\x20merchants)','\x20\x20\x20ðŸ“…\x20This\x20month:\x20','paymentGateways','get2FASettings','split','\x20\x20\x20Subtracted\x20from\x20balance:\x20-','gatewayEarnings','\x20PAID\x20payments','usdtTrcWallet','map','\x20\x20\x20âœ…\x20Actual\x20available\x20balance:\x20','\x20\x20\x20ðŸ”\x20Calculated\x20after\x20commission:\x20','setup2FA','\x20\x20\x20âœ…\x20Total\x20net\x20balances:\x20','gatewayCommissionRate','getAllPayouts','getMonth','ðŸ“Š\x20Calculated\x20commission\x20rate\x20for\x20payment\x20','localeCompare','log','NONEXISTENT_GATEWAY_FILTER','\x20order','customerName','\x20USDT\x20(current\x20balance\x20in\x20DB)','EXPIRED','\x20\x20\x20Current\x20amount:\x20','Current\x20password\x20is\x20incorrect','ðŸ’¸\x20CHARGEBACK:\x20Processing\x20penalty-only\x20deduction','shop','gateways','\x20to\x20','week','erc20','notes','commission','USDT','\x20USDT\x20for\x20payment\x20','ðŸ”„\x20Converted\x20gateway\x20ID\x20\x27','defineProperty','âœ…\x20Balance\x20check\x20passed\x20(with\x20tolerance)','floor','commissionUSDT','ðŸ“Š\x20Payout\x20statistics\x20calculated:','payment','amountUSDT','groupBy','\x20paid\x20payments\x20for\x20analysis','6305257WQJGrL','ðŸ’°\x20Updating\x20payout\x20','forEach','ðŸ“Š\x20Total\x20payments\x20(including\x20failed):\x20','0000','\x27\x20not\x20found.\x20Available\x20gateways:\x20','trc20','ðŸ”\x20Selected\x20polygon\x20wallet:\x20','ADMIN_2FA_ENABLED=','date','not\x20provided','\x20\x20\x20Final\x20payout\x20amount\x20used:\x20','../types/gateway','Interac','ðŸ“Š\x20Sorting\x20payments\x20by\x20','gte','ðŸ”\x20Admin\x202FA\x20setup\x20initiated','usdtPolygonWallet','UTC','year','values','Shop\x20not\x20found','âš ï¸\x20Gateway\x20\x27','updatedAt','$transaction','enableAdmin2FA','revenue','toDataURL','filter','\x20\x20\x20Added\x20to\x20balance:\x20+','Test\x20Gateway','ðŸ“Š\x20Available\x20gateways\x20in\x20database:','toISOString','changeAdminPassword','custom','ðŸ”\x20Selected\x20erc20_usdc\x20wallet:\x20','\x20payments)','getUTCMonth','ðŸ”\x20Selected\x20erc20\x20wallet:\x20','delete','\x20\x20\x20Transaction\x20hash:\x20','getShopWallets','\x20\x20\x20ðŸ’°\x20Total\x20turnover:\x20','insensitive','statusChangedAt','getGatewayInternalName','3021905CRcBzm','ceil','\x20with\x20payout\x20history','COMPLETED','ðŸ”\x20[','this_month','\x20->\x20','\x20\x20\x20Payout\x20amount:\x20','twoFactorSecret','pk_','getGatewayIdByName','path','paidAt','getFullYear','ðŸ“Š\x20Getting\x20payments\x20with\x20filters:','last_week','ðŸ”\x20Selected\x20polygon_usdc\x20wallet:\x20','polygon_usdc','2918547bLFnCn','dateFrom','getMerchantsAwaitingPayout','generateDailyStatistics','get','startsWith','Error\x20parsing\x20backup\x20codes:','telegram','\x20USDT','\x20merchants','update','OxaPay','\x20for\x20shop\x20','convertToUSDT','PAID','averageCommissionRate','Error\x20parsing\x20gateway\x20settings\x20for\x20payment\x20','ðŸ“Š\x20Calculating\x20payout\x20statistics...','getUTCDate','telegramUsers','\x20\x20\x20ðŸ’¸\x20Total\x20payouts:\x20','\x20USDT\x20(after\x20','ðŸ“Š\x20Getting\x20merchant\x20statistics\x20with\x20filters:','set','getAllUsers','TrapaPay','cwd','create','Insufficient\x20balance\x20for\x20amount\x20increase.\x20Available:\x20','ðŸ“Š\x20Statistics\x20PAID\x20payments\x20count:\x20','activateUser','getMerchantsSelection','base32','customerUa','Visa/MasterCard','\x20updated\x20successfully','generateSecret','\x27\x20(from\x20\x27','chargebackAmount','randomBytes','âœ…\x20Using\x20wallet\x20from\x20request:\x20','\x20\x20\x20Gateway:\x20','period','ru-RU','error','ðŸ”\x20No\x20wallet\x20provided,\x20looking\x20up\x20from\x20shop\x20settings...','âš ï¸\x20CHARGEBACK\x20without\x20penalty\x20amount\x20-\x20no\x20balance\x20change','\x27\x20to\x20name\x20\x27','findFirst','\x20\x20\x20Tolerance:\x20','\x20\x20\x20Shop\x20balance:\x20','\x20USDT\x20(same\x20as\x20awaiting)','ADMIN_2FA_ENABLED=false','amountAfterGatewayCommissionUSDT','ðŸ”„\x20REFUND:\x20Payment\x20amount\x20already\x20deducted\x20from\x20balance','\x20USDT\x20-\x20will\x20return\x20to\x20balance','getGatewayDisplayName','%\x20from\x20','updatePayout','shopId','desc','trim','toUpperCase','wallet','ðŸŽ¯\x20updateUser\x20called\x20with\x20ID:\x20','username','ðŸ”\x20Creating\x20payout\x20with\x20data:','otpauth_url','ðŸ’±\x20Currency\x20filter\x20applied:\x20','fullName',',\x20refunds:\x20','custom_','totp','\x20\x20\x20ðŸ–¥ï¸\x20User\x20Agent:\x20','this_week','getUTCFullYear','MaxPara','3266430iaCoMr','count','aggregate','Error\x20processing\x20payment\x20',']\x20Gateway\x20settings\x20JSON\x20string:','toLowerCase'];a48_0x25b0=function(){return _0x173f14;};return a48_0x25b0();}class AdminService{async[a48_0x230d10(0x328)](){const _0x2b3cab=a48_0x230d10;console[_0x2b3cab(0x240)](_0x2b3cab(0x2ad));const _0x514b13=await database_1[_0x2b3cab(0x1da)]['shop'][_0x2b3cab(0x2eb)]({'_sum':{'balance':!![],'totalPaidOut':!![]}}),_0x3800f9=await database_1['default'][_0x2b3cab(0x258)]['count']({'where':{'status':_0x2b3cab(0x2aa),'gateway':{'not':_0x2b3cab(0x1ed)}}}),_0x20827e=new Date(),_0x3d1e84=new Date(_0x20827e[_0x2b3cab(0x297)](),_0x20827e[_0x2b3cab(0x23d)](),0x1),_0x33ff61=new Date(_0x20827e[_0x2b3cab(0x297)](),_0x20827e[_0x2b3cab(0x23d)]()+0x1,0x0,0x17,0x3b,0x3b,0x3e7),_0x137775=await database_1[_0x2b3cab(0x1da)]['payout']['aggregate']({'_sum':{'amount':!![]},'where':{'createdAt':{'gte':_0x3d1e84,'lte':_0x33ff61},'status':_0x2b3cab(0x28d)}}),_0x3df1cb=_0x514b13['_sum']['totalPaidOut']||0x0,_0x9265a5=_0x514b13[_0x2b3cab(0x1ce)][_0x2b3cab(0x30c)]||0x0,_0x14a48c=_0x137775[_0x2b3cab(0x1ce)]['amount']||0x0,_0x9e60fa={'totalPayout':Math[_0x2b3cab(0x2fe)](_0x3df1cb*0x64)/0x64,'awaitingPayout':Math[_0x2b3cab(0x2fe)](_0x9265a5*0x64)/0x64,'thisMonth':Math['round'](_0x14a48c*0x64)/0x64,'availableBalance':Math['round'](_0x9265a5*0x64)/0x64,'totalPayments':_0x3800f9};return console[_0x2b3cab(0x240)](_0x2b3cab(0x257)),console[_0x2b3cab(0x240)](_0x2b3cab(0x2f0)+_0x9e60fa[_0x2b3cab(0x213)]+_0x2b3cab(0x22d)),console[_0x2b3cab(0x240)]('\x20\x20\x20â³\x20Awaiting\x20payout:\x20'+_0x9e60fa['awaitingPayout']+'\x20USDT\x20(sum\x20of\x20all\x20merchant\x20balances)'),console[_0x2b3cab(0x240)]('\x20\x20\x20ðŸ’µ\x20Available\x20balance:\x20'+_0x9e60fa[_0x2b3cab(0x326)]+_0x2b3cab(0x2cf)),console['log'](_0x2b3cab(0x22e)+_0x9e60fa[_0x2b3cab(0x344)]+_0x2b3cab(0x2a4)),console[_0x2b3cab(0x240)](_0x2b3cab(0x214)+_0x9e60fa[_0x2b3cab(0x211)]+_0x2b3cab(0x234)),_0x9e60fa;}async[a48_0x230d10(0x34c)](_0x5d7a50,_0x47f459){const _0x542514=a48_0x230d10;console[_0x542514(0x240)](_0x542514(0x1e5)+_0x5d7a50+':',_0x47f459);const _0x31aa6d=await database_1[_0x542514(0x1da)][_0x542514(0x258)][_0x542514(0x1ef)]({'where':{'id':_0x5d7a50},'select':{'id':!![],'customerEmail':!![],'customerName':!![],'customerCountry':!![],'customerIp':!![],'customerUa':!![]}});if(!_0x31aa6d)throw new Error('Payment\x20not\x20found');const _0x35d5b8={};_0x47f459[_0x542514(0x33c)]!==undefined&&(_0x35d5b8['customerCountry']=_0x47f459[_0x542514(0x33c)]||null);_0x47f459[_0x542514(0x226)]!==undefined&&(_0x35d5b8[_0x542514(0x226)]=_0x47f459['customerIp']||null);_0x47f459[_0x542514(0x2bd)]!==undefined&&(_0x35d5b8[_0x542514(0x2bd)]=_0x47f459[_0x542514(0x2bd)]||null);const _0x541da9=await database_1[_0x542514(0x1da)]['payment']['update']({'where':{'id':_0x5d7a50},'data':{..._0x35d5b8,'updatedAt':new Date()},'select':{'id':!![],'customerEmail':!![],'customerName':!![],'customerCountry':!![],'customerIp':!![],'customerUa':!![],'updatedAt':!![]}});return console[_0x542514(0x240)](_0x542514(0x355)+_0x5d7a50),console[_0x542514(0x240)](_0x542514(0x36b)+_0x31aa6d['customerCountry']+_0x542514(0x290)+_0x541da9[_0x542514(0x33c)]),console[_0x542514(0x240)]('\x20\x20\x20ðŸŒ\x20IP:\x20'+_0x31aa6d[_0x542514(0x226)]+'\x20->\x20'+_0x541da9['customerIp']),console['log'](_0x542514(0x2e5)+(_0x31aa6d[_0x542514(0x2bd)]?'set':'not\x20set')+'\x20->\x20'+(_0x541da9['customerUa']?'set':'not\x20set')),_0x541da9;}async['getSystemStatistics'](_0x31c5e9,_0x3c828a){const _0x3e4ba0=a48_0x230d10,_0x41e9d3=_0x3c828a?new Date(_0x3c828a):new Date();let _0x246725,_0x2e71d9;if(_0x31c5e9[_0x3e4ba0(0x2a1)](_0x3e4ba0(0x2e3))){const _0x5d6cfe=_0x31c5e9[_0x3e4ba0(0x369)](_0x3e4ba0(0x2e3),'')[_0x3e4ba0(0x231)]('_');if(_0x5d6cfe[_0x3e4ba0(0x20b)]===0x2){const _0x4751f6=new Date(_0x5d6cfe[0x0]),_0x1d5f25=new Date(_0x5d6cfe[0x1]);_0x246725=new Date(Date[_0x3e4ba0(0x26e)](_0x4751f6[_0x3e4ba0(0x2e7)](),_0x4751f6['getUTCMonth'](),_0x4751f6[_0x3e4ba0(0x2ae)](),0x0,0x0,0x0,0x0)),_0x2e71d9=new Date(Date[_0x3e4ba0(0x26e)](_0x1d5f25[_0x3e4ba0(0x2e7)](),_0x1d5f25[_0x3e4ba0(0x281)](),_0x1d5f25[_0x3e4ba0(0x2ae)](),0x17,0x3b,0x3b,0x3e7));}else{const _0x1266b0=new Date(Date['UTC'](_0x41e9d3[_0x3e4ba0(0x2e7)](),_0x41e9d3[_0x3e4ba0(0x281)](),_0x41e9d3['getUTCDate']()-0x1e));_0x246725=new Date(Date[_0x3e4ba0(0x26e)](_0x1266b0[_0x3e4ba0(0x2e7)](),_0x1266b0[_0x3e4ba0(0x281)](),_0x1266b0['getUTCDate'](),0x0,0x0,0x0,0x0)),_0x2e71d9=new Date(Date['UTC'](_0x41e9d3[_0x3e4ba0(0x2e7)](),_0x41e9d3[_0x3e4ba0(0x281)](),_0x41e9d3['getUTCDate'](),0x17,0x3b,0x3b,0x3e7));}}else{switch(_0x31c5e9[_0x3e4ba0(0x2ee)]()){case _0x3e4ba0(0x36d):_0x246725=new Date(Date[_0x3e4ba0(0x26e)](_0x41e9d3[_0x3e4ba0(0x2e7)](),_0x41e9d3[_0x3e4ba0(0x281)](),_0x41e9d3[_0x3e4ba0(0x2ae)](),0x0,0x0,0x0,0x0)),_0x2e71d9=new Date(Date[_0x3e4ba0(0x26e)](_0x41e9d3[_0x3e4ba0(0x2e7)](),_0x41e9d3['getUTCMonth'](),_0x41e9d3[_0x3e4ba0(0x2ae)](),0x17,0x3b,0x3b,0x3e7));break;case _0x3e4ba0(0x32a):const _0x5d0bd3=new Date(_0x41e9d3);_0x5d0bd3[_0x3e4ba0(0x32b)](_0x5d0bd3[_0x3e4ba0(0x2ae)]()-0x1),_0x246725=new Date(Date[_0x3e4ba0(0x26e)](_0x5d0bd3['getUTCFullYear'](),_0x5d0bd3[_0x3e4ba0(0x281)](),_0x5d0bd3['getUTCDate'](),0x0,0x0,0x0,0x0)),_0x2e71d9=new Date(Date['UTC'](_0x5d0bd3[_0x3e4ba0(0x2e7)](),_0x5d0bd3[_0x3e4ba0(0x281)](),_0x5d0bd3[_0x3e4ba0(0x2ae)](),0x17,0x3b,0x3b,0x3e7));break;case _0x3e4ba0(0x2e6):const _0x42d297=_0x41e9d3['getUTCDay'](),_0x31df1f=_0x42d297===0x0?-0x6:0x1-_0x42d297,_0x987e0a=_0x41e9d3[_0x3e4ba0(0x2ae)]()+_0x31df1f;_0x246725=new Date(Date['UTC'](_0x41e9d3[_0x3e4ba0(0x2e7)](),_0x41e9d3[_0x3e4ba0(0x281)](),_0x987e0a,0x0,0x0,0x0,0x0)),_0x2e71d9=new Date(Date['UTC'](_0x41e9d3[_0x3e4ba0(0x2e7)](),_0x41e9d3[_0x3e4ba0(0x281)](),_0x41e9d3[_0x3e4ba0(0x2ae)](),0x17,0x3b,0x3b,0x3e7));break;case _0x3e4ba0(0x299):const _0x50a9a6=new Date(Date[_0x3e4ba0(0x26e)](_0x41e9d3[_0x3e4ba0(0x2e7)](),_0x41e9d3['getUTCMonth'](),_0x41e9d3[_0x3e4ba0(0x2ae)]()-0x7)),_0x370bee=_0x50a9a6['getUTCDay'](),_0xdd12dd=_0x370bee===0x0?-0x6:0x1-_0x370bee,_0x2d2ec2=_0x50a9a6[_0x3e4ba0(0x2ae)]()+_0xdd12dd;_0x246725=new Date(Date[_0x3e4ba0(0x26e)](_0x50a9a6['getUTCFullYear'](),_0x50a9a6['getUTCMonth'](),_0x2d2ec2,0x0,0x0,0x0,0x0)),_0x2e71d9=new Date(Date[_0x3e4ba0(0x26e)](_0x50a9a6[_0x3e4ba0(0x2e7)](),_0x50a9a6[_0x3e4ba0(0x281)](),_0x2d2ec2+0x6,0x17,0x3b,0x3b,0x3e7));break;case _0x3e4ba0(0x28f):_0x246725=new Date(Date[_0x3e4ba0(0x26e)](_0x41e9d3[_0x3e4ba0(0x2e7)](),_0x41e9d3[_0x3e4ba0(0x281)](),0x1,0x0,0x0,0x0,0x0)),_0x2e71d9=new Date(Date[_0x3e4ba0(0x26e)](_0x41e9d3['getUTCFullYear'](),_0x41e9d3['getUTCMonth'](),_0x41e9d3[_0x3e4ba0(0x2ae)](),0x17,0x3b,0x3b,0x3e7));break;case _0x3e4ba0(0x33b):_0x246725=new Date(Date[_0x3e4ba0(0x26e)](_0x41e9d3[_0x3e4ba0(0x2e7)](),_0x41e9d3['getUTCMonth']()-0x1,0x1,0x0,0x0,0x0,0x0)),_0x2e71d9=new Date(Date['UTC'](_0x41e9d3[_0x3e4ba0(0x2e7)](),_0x41e9d3['getUTCMonth'](),0x0,0x17,0x3b,0x3b,0x3e7));break;case _0x3e4ba0(0x351):_0x246725=new Date(Date[_0x3e4ba0(0x26e)](0x7e9,0x5,0xe,0x0,0x0,0x0,0x0)),_0x2e71d9=new Date(Date['UTC'](_0x41e9d3['getUTCFullYear'](),_0x41e9d3[_0x3e4ba0(0x281)](),_0x41e9d3['getUTCDate'](),0x17,0x3b,0x3b,0x3e7));break;default:_0x246725=new Date(_0x41e9d3[_0x3e4ba0(0x1e2)]()-0x1e*0x18*0x3c*0x3c*0x3e8);const _0x1a64c3=new Date(Date[_0x3e4ba0(0x26e)](_0x41e9d3[_0x3e4ba0(0x2e7)](),_0x41e9d3[_0x3e4ba0(0x281)](),_0x41e9d3[_0x3e4ba0(0x2ae)]()-0x1e));_0x246725=new Date(Date[_0x3e4ba0(0x26e)](_0x1a64c3['getUTCFullYear'](),_0x1a64c3[_0x3e4ba0(0x281)](),_0x1a64c3[_0x3e4ba0(0x2ae)](),0x0,0x0,0x0,0x0)),_0x2e71d9=new Date(Date[_0x3e4ba0(0x26e)](_0x41e9d3[_0x3e4ba0(0x2e7)](),_0x41e9d3['getUTCMonth'](),_0x41e9d3[_0x3e4ba0(0x2ae)](),0x17,0x3b,0x3b,0x3e7));}const _0x5d74a1={'gte':_0x246725,'lte':_0x2e71d9};console[_0x3e4ba0(0x240)](_0x3e4ba0(0x36f)+_0x246725['toISOString']()+_0x3e4ba0(0x24b)+_0x2e71d9[_0x3e4ba0(0x27c)]());const [_0x4ec7c1,_0xcab714,_0x3ceae4,_0x191f4d,_0x31eec6,_0x2731f2,_0x1440f6,_0x4c9d3d,_0x8950b6]=await Promise['all']([database_1[_0x3e4ba0(0x1da)][_0x3e4ba0(0x249)][_0x3e4ba0(0x2ea)](),database_1['default'][_0x3e4ba0(0x249)]['count']({'where':{'status':_0x3e4ba0(0x221)}}),database_1[_0x3e4ba0(0x1da)][_0x3e4ba0(0x258)]['count']({'where':{'status':_0x3e4ba0(0x2aa),'createdAt':_0x5d74a1,'gateway':{'not':_0x3e4ba0(0x1ed)}}}),database_1['default'][_0x3e4ba0(0x258)]['count']({'where':{'status':'CHARGEBACK','createdAt':_0x5d74a1,'gateway':{'not':_0x3e4ba0(0x1ed)}}}),database_1[_0x3e4ba0(0x1da)][_0x3e4ba0(0x258)][_0x3e4ba0(0x2ea)]({'where':{'status':_0x3e4ba0(0x312),'createdAt':_0x5d74a1,'gateway':{'not':_0x3e4ba0(0x1ed)}}}),database_1[_0x3e4ba0(0x1da)][_0x3e4ba0(0x258)][_0x3e4ba0(0x1eb)]({'where':{'status':'PAID','createdAt':_0x5d74a1,'gateway':{'not':_0x3e4ba0(0x1ed)}},'select':{'amount':!![],'currency':!![],'amountUSDT':!![],'amountAfterGatewayCommissionUSDT':!![]}}),database_1[_0x3e4ba0(0x1da)]['payment'][_0x3e4ba0(0x1eb)]({'where':{'gateway':{'not':'test_gateway'}},'take':0xa,'orderBy':{'createdAt':'desc'},'include':{'shop':{'select':{'name':!![],'username':!![]}}}}),database_1[_0x3e4ba0(0x1da)][_0x3e4ba0(0x258)]['findMany']({'where':{'createdAt':_0x5d74a1,'gateway':{'not':_0x3e4ba0(0x1ed)}},'select':{'amount':!![],'currency':!![],'status':!![],'amountUSDT':!![],'createdAt':!![]}}),database_1[_0x3e4ba0(0x1da)][_0x3e4ba0(0x258)][_0x3e4ba0(0x1eb)]({'where':{'status':_0x3e4ba0(0x2aa),'gateway':{'not':_0x3e4ba0(0x1ed)}},'select':{'amountUSDT':!![],'amountAfterGatewayCommissionUSDT':!![]}})]);console[_0x3e4ba0(0x240)](_0x3e4ba0(0x2b9)+_0x3ceae4);let _0x884626=0x0,_0x1d9d3b=0x0;for(const _0x2d21c8 of _0x2731f2){const _0x488583=_0x2d21c8['amountUSDT']||0x0;_0x884626+=_0x488583;if(_0x2d21c8[_0x3e4ba0(0x2d1)]&&_0x2d21c8[_0x3e4ba0(0x259)]){const _0x27916a=_0x2d21c8[_0x3e4ba0(0x259)]-_0x2d21c8[_0x3e4ba0(0x2d1)];_0x1d9d3b+=_0x27916a;}}let _0x52f240=0x0;for(const _0x55842a of _0x8950b6){if(_0x55842a[_0x3e4ba0(0x2d1)]&&_0x55842a['amountUSDT']){const _0x5d4eee=_0x55842a[_0x3e4ba0(0x259)]-_0x55842a[_0x3e4ba0(0x2d1)];_0x52f240+=_0x5d4eee;}}const _0x4daabb=_0x3ceae4>0x0?_0x884626/_0x3ceae4:0x0,_0x3583ad=this[_0x3e4ba0(0x29f)](_0x4c9d3d,_0x246725,_0x2e71d9),_0x3774c1=await database_1[_0x3e4ba0(0x1da)][_0x3e4ba0(0x258)][_0x3e4ba0(0x2ea)]({'where':{'createdAt':_0x5d74a1,'gateway':{'not':_0x3e4ba0(0x1ed)},'status':{'notIn':[_0x3e4ba0(0x390),_0x3e4ba0(0x245)]}}}),_0x2d840a=_0x3774c1>0x0?_0x3ceae4/_0x3774c1*0x64:0x0;return{'totalShops':_0x4ec7c1,'activeShops':_0xcab714,'totalPayments':_0x3774c1,'successfulPayments':_0x3ceae4,'totalAttempts':_0x3774c1,'chargebacks':_0x191f4d,'refunds':_0x31eec6,'totalRevenue':Math[_0x3e4ba0(0x2fe)](_0x884626*0x64)/0x64,'trapayEarnings':Math[_0x3e4ba0(0x2fe)](_0x1d9d3b*0x64)/0x64,'trapayEarningsAllTime':Math[_0x3e4ba0(0x2fe)](_0x52f240*0x64)/0x64,'averagePaymentAmount':Math[_0x3e4ba0(0x2fe)](_0x4daabb*0x64)/0x64,'conversionRate':Math[_0x3e4ba0(0x2fe)](_0x2d840a*0x64)/0x64,'dailyRevenue':_0x3583ad['dailyRevenue'],'dailyPayments':_0x3583ad[_0x3e4ba0(0x1d6)],'recentPayments':_0x1440f6[_0x3e4ba0(0x236)](_0x4b2787=>({'id':_0x4b2787['id'],'amount':_0x4b2787[_0x3e4ba0(0x313)],'currency':_0x4b2787[_0x3e4ba0(0x345)],'status':_0x4b2787[_0x3e4ba0(0x202)],'gateway':_0x4b2787['gateway'],'shop':_0x4b2787[_0x3e4ba0(0x249)],'createdAt':_0x4b2787[_0x3e4ba0(0x206)]}))};}}async['getMerchantStatistics'](_0x4f88de){const _0x2e8dd9=a48_0x230d10;console[_0x2e8dd9(0x240)](_0x2e8dd9(0x2b2),_0x4f88de);let _0x26fa57,_0x45ab9e=new Date();if(_0x4f88de['period']===_0x2e8dd9(0x27e)&&_0x4f88de['dateFrom']&&_0x4f88de['dateTo']){const _0x1366f2=new Date(_0x4f88de[_0x2e8dd9(0x29d)]),_0x510b5a=new Date(_0x4f88de[_0x2e8dd9(0x1e1)]);_0x26fa57=new Date(Date[_0x2e8dd9(0x26e)](_0x1366f2[_0x2e8dd9(0x2e7)](),_0x1366f2[_0x2e8dd9(0x281)](),_0x1366f2[_0x2e8dd9(0x2ae)](),0x0,0x0,0x0,0x0)),_0x45ab9e=new Date(Date['UTC'](_0x510b5a[_0x2e8dd9(0x2e7)](),_0x510b5a[_0x2e8dd9(0x281)](),_0x510b5a[_0x2e8dd9(0x2ae)](),0x17,0x3b,0x3b,0x3e7));}else{const _0x76973=new Date();switch(_0x4f88de[_0x2e8dd9(0x2c6)]){case _0x2e8dd9(0x24c):_0x26fa57=new Date(_0x76973['getTime']()-0x7*0x18*0x3c*0x3c*0x3e8),_0x26fa57[_0x2e8dd9(0x320)](0x0,0x0,0x0,0x0),_0x45ab9e['setHours'](0x17,0x3b,0x3b,0x3e7);break;case _0x2e8dd9(0x33a):_0x26fa57=new Date(Date[_0x2e8dd9(0x26e)](_0x76973['getUTCFullYear'](),_0x76973[_0x2e8dd9(0x281)](),0x1,0x0,0x0,0x0,0x0)),_0x45ab9e=new Date(Date['UTC'](_0x76973['getUTCFullYear'](),_0x76973['getUTCMonth']()+0x1,0x0,0x17,0x3b,0x3b,0x3e7));break;case _0x2e8dd9(0x386):_0x26fa57=new Date(Date[_0x2e8dd9(0x26e)](_0x76973[_0x2e8dd9(0x2e7)](),_0x76973[_0x2e8dd9(0x281)]()-0x1,0x1,0x0,0x0,0x0,0x0)),_0x45ab9e=new Date(Date['UTC'](_0x76973['getUTCFullYear'](),_0x76973[_0x2e8dd9(0x281)](),0x0,0x17,0x3b,0x3b,0x3e7));break;case _0x2e8dd9(0x26f):_0x26fa57=new Date(_0x76973[_0x2e8dd9(0x1e2)]()-0x16d*0x18*0x3c*0x3c*0x3e8),_0x26fa57[_0x2e8dd9(0x320)](0x0,0x0,0x0,0x0),_0x45ab9e[_0x2e8dd9(0x320)](0x17,0x3b,0x3b,0x3e7);break;case'all':default:_0x26fa57=new Date(_0x2e8dd9(0x35e)),_0x26fa57[_0x2e8dd9(0x320)](0x0,0x0,0x0,0x0),_0x45ab9e['setHours'](0x17,0x3b,0x3b,0x3e7);break;}}console[_0x2e8dd9(0x240)]('ðŸ“…\x20Period:\x20'+_0x26fa57[_0x2e8dd9(0x27c)]()+_0x2e8dd9(0x24b)+_0x45ab9e[_0x2e8dd9(0x27c)]());const _0x3a8844={'status':'PAID','gateway':{'not':_0x2e8dd9(0x1ed)},'createdAt':{'gte':_0x26fa57,'lte':_0x45ab9e}};_0x4f88de['shopId']&&(_0x3a8844[_0x2e8dd9(0x2d7)]=_0x4f88de[_0x2e8dd9(0x2d7)]);const _0x33147b=await database_1[_0x2e8dd9(0x1da)][_0x2e8dd9(0x258)]['findMany']({'where':_0x3a8844,'select':{'id':!![],'amount':!![],'currency':!![],'amountUSDT':!![],'amountAfterGatewayCommissionUSDT':!![],'gatewayCommissionRate':!![],'gateway':!![],'shopId':!![],'paidAt':!![],'shop':{'select':{'id':!![],'name':!![],'username':!![],'gatewaySettings':!![]}}}});console[_0x2e8dd9(0x240)](_0x2e8dd9(0x350)+_0x33147b[_0x2e8dd9(0x20b)]+_0x2e8dd9(0x25b));const _0x252148={'gateway':{'not':'test_gateway'},'status':{'notIn':['PENDING',_0x2e8dd9(0x245)]},'createdAt':{'gte':_0x26fa57,'lte':_0x45ab9e}};_0x4f88de[_0x2e8dd9(0x2d7)]&&(_0x252148[_0x2e8dd9(0x2d7)]=_0x4f88de[_0x2e8dd9(0x2d7)]);const _0x2e2695=await database_1[_0x2e8dd9(0x1da)][_0x2e8dd9(0x258)][_0x2e8dd9(0x2ea)]({'where':_0x252148}),_0x47fa29={..._0x252148,'status':_0x2e8dd9(0x338)},_0x346569={..._0x252148,'status':'REFUND'},[_0x1ee2fd,_0x2b0647]=await Promise[_0x2e8dd9(0x323)]([database_1[_0x2e8dd9(0x1da)][_0x2e8dd9(0x258)]['count']({'where':_0x47fa29}),database_1['default'][_0x2e8dd9(0x258)]['count']({'where':_0x346569})]);console[_0x2e8dd9(0x240)](_0x2e8dd9(0x25f)+_0x2e2695+_0x2e8dd9(0x34f)+_0x33147b[_0x2e8dd9(0x20b)]+',\x20chargebacks:\x20'+_0x1ee2fd+_0x2e8dd9(0x2e2)+_0x2b0647);let _0x2f0be0=0x0,_0x13455f=0x0,_0x47025e=0x0;const _0x148df7={},_0x1ad821={},_0x4d1e91={},_0x3cb8dd=new Date(_0x26fa57);while(_0x3cb8dd<=_0x45ab9e){const _0x63c6d1=_0x3cb8dd['toISOString']()[_0x2e8dd9(0x231)]('T')[0x0];_0x4d1e91[_0x63c6d1]={'date':_0x63c6d1,'turnover':0x0,'merchantEarnings':0x0,'gatewayEarnings':0x0,'paymentsCount':0x0},_0x3cb8dd[_0x2e8dd9(0x32b)](_0x3cb8dd[_0x2e8dd9(0x2ae)]()+0x1);}for(const _0x58e592 of _0x33147b){try{const _0x248fba=_0x58e592['amountUSDT']||0x0;if(_0x248fba<=0x0){console['warn']('âš ï¸\x20Payment\x20'+_0x58e592['id']+_0x2e8dd9(0x32d));continue;}let _0x3f0e94,_0x3d83dd;if(_0x58e592['amountAfterGatewayCommissionUSDT']!==null&&_0x58e592['amountAfterGatewayCommissionUSDT']!==undefined)_0x3f0e94=_0x58e592['amountAfterGatewayCommissionUSDT'],_0x3d83dd=_0x248fba-_0x3f0e94,console[_0x2e8dd9(0x240)]('ðŸ“Š\x20Using\x20saved\x20values\x20for\x20payment\x20'+_0x58e592['id']+':\x20'+_0x248fba[_0x2e8dd9(0x1e8)](0x6)+_0x2e8dd9(0x378)+_0x3f0e94['toFixed'](0x6)+_0x2e8dd9(0x2a4));else{let _0xeb7531={};if(_0x58e592[_0x2e8dd9(0x249)][_0x2e8dd9(0x38b)])try{_0xeb7531=JSON[_0x2e8dd9(0x33f)](_0x58e592['shop'][_0x2e8dd9(0x38b)]);}catch(_0x54f8fa){console[_0x2e8dd9(0x2c8)]('Error\x20parsing\x20gateway\x20settings\x20for\x20shop\x20'+_0x58e592[_0x2e8dd9(0x2d7)]+':',_0x54f8fa);}let _0x589452=0x2d;for(const [_0x35ffd2,_0x119b89]of Object[_0x2e8dd9(0x219)](_0xeb7531)){if(_0x35ffd2[_0x2e8dd9(0x2ee)]()===_0x58e592[_0x2e8dd9(0x33d)]['toLowerCase']()){_0x589452=_0x119b89[_0x2e8dd9(0x24f)]||0x2d;break;}}_0x3d83dd=_0x248fba*(_0x589452/0x64),_0x3f0e94=_0x248fba-_0x3d83dd,console[_0x2e8dd9(0x240)]('ðŸ“Š\x20Calculating\x20commission\x20manually\x20for\x20payment\x20'+_0x58e592['id']+':\x20'+_0x589452+_0x2e8dd9(0x2d5)+_0x248fba[_0x2e8dd9(0x1e8)](0x6)+_0x2e8dd9(0x2a4));}_0x2f0be0+=_0x248fba,_0x13455f+=_0x3f0e94,_0x47025e+=_0x3d83dd;let _0x25577d;_0x58e592[_0x2e8dd9(0x23b)]!==null&&_0x58e592['gatewayCommissionRate']!==undefined?(_0x25577d=_0x58e592[_0x2e8dd9(0x23b)],console[_0x2e8dd9(0x240)]('ðŸ“Š\x20Using\x20saved\x20commission\x20rate\x20for\x20payment\x20'+_0x58e592['id']+':\x20'+_0x25577d+'%')):(_0x25577d=_0x248fba>0x0?_0x3d83dd/_0x248fba*0x64:0x0,console['log'](_0x2e8dd9(0x23e)+_0x58e592['id']+':\x20'+_0x25577d[_0x2e8dd9(0x1e8)](0x2)+'%'));!_0x148df7[_0x58e592[_0x2e8dd9(0x33d)]]&&(_0x148df7[_0x58e592[_0x2e8dd9(0x33d)]]={'gateway':_0x58e592[_0x2e8dd9(0x33d)],'gatewayDisplayName':this[_0x2e8dd9(0x2d4)](_0x58e592['gateway']),'paymentsCount':0x0,'turnoverUSDT':0x0,'commissionUSDT':0x0,'merchantEarningsUSDT':0x0,'totalCommissionRate':0x0});_0x148df7[_0x58e592[_0x2e8dd9(0x33d)]][_0x2e8dd9(0x1f4)]++,_0x148df7[_0x58e592[_0x2e8dd9(0x33d)]][_0x2e8dd9(0x216)]+=_0x248fba,_0x148df7[_0x58e592[_0x2e8dd9(0x33d)]][_0x2e8dd9(0x256)]+=_0x3d83dd,_0x148df7[_0x58e592[_0x2e8dd9(0x33d)]][_0x2e8dd9(0x22a)]+=_0x3f0e94,_0x148df7[_0x58e592[_0x2e8dd9(0x33d)]][_0x2e8dd9(0x1cd)]+=_0x25577d;!_0x4f88de['shopId']&&(!_0x1ad821[_0x58e592[_0x2e8dd9(0x2d7)]]&&(_0x1ad821[_0x58e592[_0x2e8dd9(0x2d7)]]={'shopId':_0x58e592['shopId'],'shopName':_0x58e592[_0x2e8dd9(0x249)]['name'],'shopUsername':_0x58e592['shop'][_0x2e8dd9(0x2dd)],'paymentsCount':0x0,'turnoverUSDT':0x0,'commissionUSDT':0x0,'merchantEarningsUSDT':0x0,'paidOutUSDT':0x0,'averageCheckUSDT':0x0}),_0x1ad821[_0x58e592[_0x2e8dd9(0x2d7)]][_0x2e8dd9(0x1f4)]++,_0x1ad821[_0x58e592['shopId']][_0x2e8dd9(0x216)]+=_0x248fba,_0x1ad821[_0x58e592[_0x2e8dd9(0x2d7)]][_0x2e8dd9(0x256)]+=_0x3d83dd,_0x1ad821[_0x58e592[_0x2e8dd9(0x2d7)]][_0x2e8dd9(0x22a)]+=_0x3f0e94);const _0x1edb85=_0x58e592[_0x2e8dd9(0x296)][_0x2e8dd9(0x27c)]()[_0x2e8dd9(0x231)]('T')[0x0];_0x4d1e91[_0x1edb85]&&(_0x4d1e91[_0x1edb85][_0x2e8dd9(0x38e)]+=_0x248fba,_0x4d1e91[_0x1edb85][_0x2e8dd9(0x30f)]+=_0x3f0e94,_0x4d1e91[_0x1edb85]['gatewayEarnings']+=_0x3d83dd,_0x4d1e91[_0x1edb85][_0x2e8dd9(0x1f4)]++);}catch(_0x266d0c){console[_0x2e8dd9(0x2c8)](_0x2e8dd9(0x2ec)+_0x58e592['id']+':',_0x266d0c);}}Object[_0x2e8dd9(0x270)](_0x148df7)['forEach'](_0x3aaa24=>{const _0x4a3a34=_0x2e8dd9;_0x3aaa24[_0x4a3a34(0x2ab)]=_0x3aaa24['paymentsCount']>0x0?_0x3aaa24['totalCommissionRate']/_0x3aaa24[_0x4a3a34(0x1f4)]:0x0,delete _0x3aaa24[_0x4a3a34(0x1cd)];}),Object['values'](_0x1ad821)[_0x2e8dd9(0x25e)](_0x174ced=>{const _0xdb2abc=_0x2e8dd9;_0x174ced[_0xdb2abc(0x31f)]=_0x174ced[_0xdb2abc(0x1f4)]>0x0?_0x174ced[_0xdb2abc(0x216)]/_0x174ced[_0xdb2abc(0x1f4)]:0x0;});let _0x4dfd52=0x0,_0x5738ea=0x0;if(_0x4f88de[_0x2e8dd9(0x2d7)]){const _0x4189a1=await database_1[_0x2e8dd9(0x1da)][_0x2e8dd9(0x2ef)][_0x2e8dd9(0x1eb)]({'where':{'shopId':_0x4f88de['shopId'],'status':_0x2e8dd9(0x28d),'createdAt':{'gte':_0x26fa57,'lte':_0x45ab9e}},'select':{'amount':!![]}});_0x4dfd52=_0x4189a1['reduce']((_0x2edc95,_0x4e477b)=>_0x2edc95+_0x4e477b[_0x2e8dd9(0x313)],0x0);const _0x28f03e=await database_1['default'][_0x2e8dd9(0x2ef)][_0x2e8dd9(0x1eb)]({'where':{'shopId':_0x4f88de[_0x2e8dd9(0x2d7)],'status':_0x2e8dd9(0x390),'createdAt':{'gte':_0x26fa57,'lte':_0x45ab9e}},'select':{'amount':!![]}});_0x5738ea=_0x28f03e[_0x2e8dd9(0x327)]((_0x16cc40,_0x149d9c)=>_0x16cc40+_0x149d9c['amount'],0x0);}const _0x5cd991=_0x2e2695,_0x504592=_0x33147b[_0x2e8dd9(0x20b)],_0x383d3d=_0x504592>0x0?_0x2f0be0/_0x504592:0x0,_0x476289=_0x5cd991>0x0?Math[_0x2e8dd9(0x2fe)](_0x504592/_0x5cd991*0x2710)/0x64:0x0,_0x28f981=Math[_0x2e8dd9(0x28b)]((_0x45ab9e[_0x2e8dd9(0x1e2)]()-_0x26fa57[_0x2e8dd9(0x1e2)]())/(0x3e8*0x3c*0x3c*0x18)),_0xc2fb67={'totalTurnover':Math[_0x2e8dd9(0x2fe)](_0x2f0be0*0x64)/0x64,'merchantEarnings':Math[_0x2e8dd9(0x2fe)](_0x13455f*0x64)/0x64,'gatewayEarnings':Math[_0x2e8dd9(0x2fe)](_0x47025e*0x64)/0x64,'totalPaidOut':Math[_0x2e8dd9(0x2fe)](_0x4dfd52*0x64)/0x64,'pendingPayout':Math[_0x2e8dd9(0x2fe)](_0x5738ea*0x64)/0x64,'averageCheck':Math[_0x2e8dd9(0x2fe)](_0x383d3d*0x64)/0x64,'totalPayments':_0x5cd991,'successfulPayments':_0x504592,'conversionRate':_0x476289,'chargebacks':_0x1ee2fd,'refunds':_0x2b0647,'gatewayBreakdown':Object['values'](_0x148df7)[_0x2e8dd9(0x236)](_0x3aa9db=>({..._0x3aa9db,'turnoverUSDT':Math[_0x2e8dd9(0x2fe)](_0x3aa9db[_0x2e8dd9(0x216)]*0x64)/0x64,'commissionUSDT':Math[_0x2e8dd9(0x2fe)](_0x3aa9db[_0x2e8dd9(0x256)]*0x64)/0x64,'merchantEarningsUSDT':Math[_0x2e8dd9(0x2fe)](_0x3aa9db['merchantEarningsUSDT']*0x64)/0x64,'averageCommissionRate':Math[_0x2e8dd9(0x2fe)](_0x3aa9db[_0x2e8dd9(0x2ab)]*0x64)/0x64})),'merchantBreakdown':_0x4f88de[_0x2e8dd9(0x2d7)]?undefined:Object[_0x2e8dd9(0x270)](_0x1ad821)[_0x2e8dd9(0x236)](_0x5eb13a=>({..._0x5eb13a,'turnoverUSDT':Math[_0x2e8dd9(0x2fe)](_0x5eb13a['turnoverUSDT']*0x64)/0x64,'commissionUSDT':Math[_0x2e8dd9(0x2fe)](_0x5eb13a[_0x2e8dd9(0x256)]*0x64)/0x64,'merchantEarningsUSDT':Math[_0x2e8dd9(0x2fe)](_0x5eb13a['merchantEarningsUSDT']*0x64)/0x64,'paidOutUSDT':Math['round'](_0x5eb13a['paidOutUSDT']*0x64)/0x64,'averageCheckUSDT':Math['round'](_0x5eb13a[_0x2e8dd9(0x31f)]*0x64)/0x64})),'dailyData':Object[_0x2e8dd9(0x270)](_0x4d1e91)[_0x2e8dd9(0x236)](_0x93dfc4=>({..._0x93dfc4,'turnover':Math['round'](_0x93dfc4[_0x2e8dd9(0x38e)]*0x64)/0x64,'merchantEarnings':Math[_0x2e8dd9(0x2fe)](_0x93dfc4[_0x2e8dd9(0x30f)]*0x64)/0x64,'gatewayEarnings':Math[_0x2e8dd9(0x2fe)](_0x93dfc4[_0x2e8dd9(0x233)]*0x64)/0x64}))[_0x2e8dd9(0x34d)]((_0x31c99f,_0x16777d)=>_0x31c99f[_0x2e8dd9(0x265)][_0x2e8dd9(0x23f)](_0x16777d[_0x2e8dd9(0x265)])),'periodInfo':{'from':_0x26fa57,'to':_0x45ab9e,'periodType':_0x4f88de[_0x2e8dd9(0x2c6)]||_0x2e8dd9(0x27e),'daysCount':_0x28f981}};return console['log'](_0x2e8dd9(0x30d)),console[_0x2e8dd9(0x240)](_0x2e8dd9(0x286)+_0xc2fb67[_0x2e8dd9(0x1d5)]+'\x20USDT'),console[_0x2e8dd9(0x240)](_0x2e8dd9(0x34a)+_0xc2fb67[_0x2e8dd9(0x30f)]+_0x2e8dd9(0x2a4)),console[_0x2e8dd9(0x240)]('\x20\x20\x20ðŸª\x20Gateway\x20earnings:\x20'+_0xc2fb67[_0x2e8dd9(0x233)]+_0x2e8dd9(0x2a4)),console[_0x2e8dd9(0x240)](_0x2e8dd9(0x331)+_0xc2fb67['totalPaidOut']+_0x2e8dd9(0x2a4)),console['log'](_0x2e8dd9(0x1f5)+_0xc2fb67['pendingPayout']+_0x2e8dd9(0x2a4)),console[_0x2e8dd9(0x240)](_0x2e8dd9(0x35f)+_0xc2fb67[_0x2e8dd9(0x211)]),_0xc2fb67;}async[a48_0x230d10(0x2bb)](_0x5520e8){const _0x54dd48=a48_0x230d10;console[_0x54dd48(0x240)](_0x54dd48(0x304),{'hasPayoutHistory':_0x5520e8});let _0x573270={};_0x5520e8&&(_0x573270[_0x54dd48(0x37b)]={'some':{}});const _0x4d3229=await database_1[_0x54dd48(0x1da)][_0x54dd48(0x249)]['findMany']({'where':_0x573270,'select':{'id':!![],'username':!![],'name':!![]},'orderBy':{'name':'asc'}});return console[_0x54dd48(0x240)](_0x54dd48(0x370)+_0x4d3229[_0x54dd48(0x20b)]+'\x20merchants\x20for\x20selection'+(_0x5520e8?_0x54dd48(0x28c):'')),_0x4d3229[_0x54dd48(0x236)](_0x1b2c5e=>({'id':_0x1b2c5e['id'],'username':_0x1b2c5e[_0x54dd48(0x2dd)],'name':_0x1b2c5e[_0x54dd48(0x1dc)]}));}[a48_0x230d10(0x2d4)](_0x309d8f){const _0x5d7dec=a48_0x230d10,_0x18ab41={'test_gateway':_0x5d7dec(0x27a),'plisio':_0x5d7dec(0x1d0),'rapyd':'Rapyd','noda':'Noda','cointopay':_0x5d7dec(0x342),'cointopay2':'CoinToPay2','klyme_eu':'KLYME\x20EU','klyme_gb':_0x5d7dec(0x1fc),'klyme_de':'KLYME\x20DE','mastercard':_0x5d7dec(0x373),'visa/mastercard':_0x5d7dec(0x2be),'amer':_0x5d7dec(0x332),'myxspend':'MyXSpend','ampay':_0x5d7dec(0x2fd),'ampay_try':_0x5d7dec(0x2f8),'sepa':'Sepa','interac':_0x5d7dec(0x269),'onramp':_0x5d7dec(0x35d),'squirrelpay':'SquirrelPay','maxpara':_0x5d7dec(0x2e8),'instaxchange':'InstaXchange','oxapay':_0x5d7dec(0x2a7)};return _0x18ab41[_0x309d8f]||_0x309d8f;}['getGatewayInternalName'](_0x4f8eec){const _0xb86c1=a48_0x230d10,_0x445beb={'Test\x20Gateway':'test_gateway','Plisio':'plisio','Rapyd':'rapyd','Noda':'noda','CoinToPay':'cointopay','CoinToPay2':'cointopay2','KLYME\x20EU':_0xb86c1(0x20c),'KLYME\x20GB':_0xb86c1(0x1cf),'KLYME\x20DE':_0xb86c1(0x388),'MasterCard':'mastercard'};return _0x445beb[_0x4f8eec]||_0x4f8eec[_0xb86c1(0x2ee)]();}async[a48_0x230d10(0x29e)](_0x30799f){const _0x581424=a48_0x230d10,{page:_0x416f8c,limit:_0x1d61bc,minAmount:_0x1e831a,search:_0x2a8b59}=_0x30799f;console[_0x581424(0x240)]('ðŸ“Š\x20Getting\x20merchants\x20awaiting\x20payout\x20with\x20filters:',_0x30799f);let _0x24836c={};_0x2a8b59&&(_0x24836c['name']={'contains':_0x2a8b59,'mode':_0x581424(0x287)});const _0x44c9f6=await database_1[_0x581424(0x1da)]['shop'][_0x581424(0x1eb)]({'where':_0x24836c,'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'balance':!![],'totalPaidOut':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'usdcErcWallet':!![],'gatewaySettings':!![],'createdAt':!![]}}),_0x3d17aa=_0x44c9f6[_0x581424(0x278)](_0x295f6a=>{const _0x3c1a3f=_0x581424,_0x40bee3=Math[_0x3c1a3f(0x255)](_0x295f6a[_0x3c1a3f(0x30c)]*0x64)/0x64;if(_0x1e831a&&_0x40bee3<_0x1e831a)return![];return _0x40bee3!==0x0;});_0x3d17aa[_0x581424(0x34d)]((_0x1d2028,_0x58d1a6)=>_0x58d1a6['balance']-_0x1d2028['balance']);const _0x47d5c5=_0x3d17aa[_0x581424(0x20b)],_0x20612b=(_0x416f8c-0x1)*_0x1d61bc,_0x2acbc1=_0x3d17aa[_0x581424(0x38c)](_0x20612b,_0x20612b+_0x1d61bc);console[_0x581424(0x240)]('ðŸ’°\x20Found\x20'+_0x2acbc1[_0x581424(0x20b)]+'\x20merchants\x20with\x20rounded\x20balance\x20!=\x200.00\x20(excluding\x20balances\x20that\x20round\x20to\x200.00)');const _0x156b60=await Promise[_0x581424(0x323)](_0x2acbc1[_0x581424(0x236)](async _0x574bec=>{const _0x4029d0=_0x581424,[_0x1db76b,_0x3a2ac2,_0x3beb2a]=await Promise[_0x4029d0(0x323)]([database_1[_0x4029d0(0x1da)]['payment'][_0x4029d0(0x2ea)]({'where':{'shopId':_0x574bec['id'],'status':'PAID','gateway':{'not':_0x4029d0(0x1ed)}}}),database_1[_0x4029d0(0x1da)][_0x4029d0(0x258)][_0x4029d0(0x2cc)]({'where':{'shopId':_0x574bec['id'],'status':_0x4029d0(0x2aa),'gateway':{'not':_0x4029d0(0x1ed)}},'orderBy':{'paidAt':_0x4029d0(0x2f1)},'select':{'paidAt':!![]}}),database_1[_0x4029d0(0x1da)][_0x4029d0(0x258)]['groupBy']({'by':[_0x4029d0(0x33d)],'where':{'shopId':_0x574bec['id'],'status':'PAID','gateway':{'not':_0x4029d0(0x1ed)}},'_count':{'id':!![]},'_sum':{'amountUSDT':!![]}})]),_0x11c50b=new Date(),_0x2119d3=new Date(_0x11c50b[_0x4029d0(0x297)](),_0x11c50b['getMonth'](),0x1),_0x3bbe68=new Date(_0x11c50b['getFullYear'](),_0x11c50b[_0x4029d0(0x23d)]()+0x1,0x0,0x17,0x3b,0x3b,0x3e7),[_0x1094d2,_0x54c1a8]=await Promise['all']([database_1['default'][_0x4029d0(0x2ef)]['aggregate']({'_sum':{'amount':!![]},'where':{'shopId':_0x574bec['id'],'status':_0x4029d0(0x28d)}}),database_1[_0x4029d0(0x1da)]['payout'][_0x4029d0(0x2eb)]({'_sum':{'amount':!![]},'where':{'shopId':_0x574bec['id'],'status':_0x4029d0(0x28d),'createdAt':{'gte':_0x2119d3,'lte':_0x3bbe68}}})]),_0x19b638=_0x1094d2[_0x4029d0(0x1ce)][_0x4029d0(0x313)]||0x0,_0x48b9b8=_0x54c1a8['_sum'][_0x4029d0(0x313)]||0x0,_0x3adf58=await Promise[_0x4029d0(0x323)](_0x3beb2a[_0x4029d0(0x236)](async _0x560253=>{const _0x12b268=_0x4029d0;let _0x292ed1=0x2d;if(_0x574bec[_0x12b268(0x38b)])try{const _0x3a49b6=JSON[_0x12b268(0x33f)](_0x574bec[_0x12b268(0x38b)]);for(const [_0x4ce03b,_0x33479d]of Object['entries'](_0x3a49b6)){if(_0x4ce03b[_0x12b268(0x2ee)]()===_0x560253[_0x12b268(0x33d)][_0x12b268(0x2ee)]()){_0x292ed1=_0x33479d[_0x12b268(0x24f)]||0xa,console[_0x12b268(0x240)](_0x12b268(0x38a)+_0x560253[_0x12b268(0x33d)]+_0x12b268(0x2a8)+_0x574bec['id']+_0x12b268(0x360)+_0x292ed1+'%');break;}}}catch(_0x58ae93){console[_0x12b268(0x2c8)](_0x12b268(0x305)+_0x574bec['id']+':',_0x58ae93);}const _0xfb2717=_0x560253[_0x12b268(0x1ce)]?.[_0x12b268(0x259)]||0x0,_0x55be87=_0xfb2717*(0x1-_0x292ed1/0x64);return{'gateway':_0x560253[_0x12b268(0x33d)],'count':_0x560253[_0x12b268(0x362)]?.['id']||0x0,'amountUSDT':Math[_0x12b268(0x2fe)](_0xfb2717*0x64)/0x64,'amountAfterCommissionUSDT':Math[_0x12b268(0x2fe)](_0x55be87*0x64)/0x64,'commission':_0x292ed1};})),_0x2ba94b=_0x3adf58[_0x4029d0(0x327)]((_0x4aee25,_0x5a5c4b)=>_0x4aee25+_0x5a5c4b[_0x4029d0(0x259)],0x0),_0x5516b8=_0x3adf58['reduce']((_0x17895c,_0x3b5801)=>_0x17895c+_0x3b5801['amountAfterCommissionUSDT'],0x0),_0x5d3406=_0x574bec[_0x4029d0(0x30c)];return console[_0x4029d0(0x240)](_0x4029d0(0x1d8)+_0x574bec['username']+':'),console['log']('\x20\x20\x20ï¿½\x20Total\x20payments\x20turnover:\x20'+_0x2ba94b['toFixed'](0x2)+_0x4029d0(0x314)),console[_0x4029d0(0x240)](_0x4029d0(0x238)+_0x5516b8['toFixed'](0x2)+_0x4029d0(0x1df)),console['log'](_0x4029d0(0x237)+_0x5d3406[_0x4029d0(0x1e8)](0x2)+_0x4029d0(0x244)),console[_0x4029d0(0x240)](_0x4029d0(0x2b0)+_0x19b638[_0x4029d0(0x1e8)](0x2)+_0x4029d0(0x37e)),console[_0x4029d0(0x240)]('\x20\x20\x20ðŸ¤”\x20Difference:\x20'+(_0x5516b8-_0x19b638-_0x5d3406)[_0x4029d0(0x1e8)](0x2)+'\x20USDT\x20(calculated\x20-\x20payouts\x20-\x20balance)'),{'id':_0x574bec['id'],'fullName':_0x574bec['name'],'username':_0x574bec[_0x4029d0(0x2dd)],'telegramId':_0x574bec['telegram'],'merchantUrl':_0x574bec[_0x4029d0(0x363)],'wallets':{'usdtPolygonWallet':_0x574bec[_0x4029d0(0x26d)],'usdtTrcWallet':_0x574bec[_0x4029d0(0x235)],'usdtErcWallet':_0x574bec[_0x4029d0(0x1de)],'usdcPolygonWallet':_0x574bec[_0x4029d0(0x203)],'usdcErcWallet':_0x574bec[_0x4029d0(0x335)]},'totalAmountUSDT':Math['round'](_0x2ba94b*0x64)/0x64,'totalAmountAfterCommissionUSDT':Math[_0x4029d0(0x2fe)](_0x5516b8*0x64)/0x64,'currentBalance':Math[_0x4029d0(0x255)](_0x5d3406*0x64)/0x64,'totalPayout':Math['round'](_0x19b638*0x64)/0x64,'thisMonth':Math[_0x4029d0(0x2fe)](_0x48b9b8*0x64)/0x64,'paymentsCount':_0x1db76b,'oldestPaymentDate':_0x3a2ac2?.['paidAt']||_0x574bec['createdAt'],'gatewayBreakdown':_0x3adf58};})),_0x3947fd=_0x156b60['reduce']((_0x2a2f7f,_0x52bfc5)=>_0x2a2f7f+_0x52bfc5['totalAmountUSDT'],0x0),_0x5d7e9d=_0x156b60[_0x581424(0x327)]((_0x527c21,_0x54cfe7)=>_0x527c21+_0x54cfe7[_0x581424(0x2ff)],0x0),_0x37457f=_0x156b60[_0x581424(0x327)]((_0x24a446,_0x39bf1c)=>_0x24a446+_0x39bf1c[_0x581424(0x213)],0x0),_0x5b1edc=_0x156b60[_0x581424(0x327)]((_0x84fe85,_0x5005ca)=>_0x84fe85+_0x5005ca['thisMonth'],0x0);return console[_0x581424(0x240)](_0x581424(0x1ee)+_0x47d5c5+_0x581424(0x2a5)),console[_0x581424(0x240)](_0x581424(0x1f1)+Math[_0x581424(0x2fe)](_0x3947fd*0x64)/0x64+_0x581424(0x314)),console[_0x581424(0x240)](_0x581424(0x23a)+Math[_0x581424(0x2fe)](_0x5d7e9d*0x64)/0x64+'\x20USDT\x20(rounded\x20to\x202\x20decimal\x20places)'),console['log'](_0x581424(0x367)+Math['round'](_0x37457f*0x64)/0x64+'\x20USDT'),console[_0x581424(0x240)](_0x581424(0x343)+Math[_0x581424(0x2fe)](_0x5b1edc*0x64)/0x64+_0x581424(0x2a4)),{'merchants':_0x156b60,'pagination':{'page':_0x416f8c,'limit':_0x1d61bc,'total':_0x47d5c5,'totalPages':Math[_0x581424(0x28b)](_0x47d5c5/_0x1d61bc)},'summary':{'totalMerchants':_0x47d5c5,'totalAmountUSDT':Math[_0x581424(0x2fe)](_0x3947fd*0x64)/0x64,'totalAmountAfterCommissionUSDT':Math[_0x581424(0x2fe)](_0x5d7e9d*0x64)/0x64,'totalPayout':Math[_0x581424(0x2fe)](_0x37457f*0x64)/0x64,'thisMonth':Math['round'](_0x5b1edc*0x64)/0x64}};}async[a48_0x230d10(0x38f)](_0x47bff1){const _0x4db589=a48_0x230d10,{shopId:_0x56d122,amount:_0x2a8187,network:_0x226e2d,wallet:_0xbe9c85,notes:_0x15d6a1,txid:_0x51c63d,periodFrom:_0x2e2dde,periodTo:_0x24c88b}=_0x47bff1,_0x5d8f30=await database_1[_0x4db589(0x1da)][_0x4db589(0x274)](async _0x4a3294=>{const _0x1f1c81=_0x4db589,_0x317a7d=await _0x4a3294[_0x1f1c81(0x249)][_0x1f1c81(0x1ef)]({'where':{'id':_0x56d122},'select':{'id':!![],'name':!![],'username':!![],'balance':!![],'totalPaidOut':!![]}});if(!_0x317a7d)throw new Error(_0x1f1c81(0x271));console[_0x1f1c81(0x240)](_0x1f1c81(0x20e)+_0x317a7d[_0x1f1c81(0x2dd)]+':'),console[_0x1f1c81(0x240)]('\x20\x20\x20Current\x20balance:\x20'+_0x317a7d[_0x1f1c81(0x30c)]['toFixed'](0x6)+_0x1f1c81(0x2a4)),console[_0x1f1c81(0x240)](_0x1f1c81(0x291)+_0x2a8187['toFixed'](0x6)+_0x1f1c81(0x2a4)),console['log'](_0x1f1c81(0x368)+_0x317a7d[_0x1f1c81(0x372)][_0x1f1c81(0x1e8)](0x6)+_0x1f1c81(0x2a4));if(_0x51c63d)console['log'](_0x1f1c81(0x284)+_0x51c63d);const _0x528dc3=0.000001,_0x4f8e40=Number(_0x317a7d[_0x1f1c81(0x30c)]),_0x2c0579=Number(_0x2a8187);console['log'](_0x1f1c81(0x354)),console[_0x1f1c81(0x240)](_0x1f1c81(0x1e6)+_0x317a7d[_0x1f1c81(0x30c)]),console[_0x1f1c81(0x240)](_0x1f1c81(0x32e)+_0x4f8e40),console[_0x1f1c81(0x240)](_0x1f1c81(0x376)+_0x2c0579),console['log'](_0x1f1c81(0x220)+(_0x4f8e40-_0x2c0579)),console[_0x1f1c81(0x240)](_0x1f1c81(0x2cd)+_0x528dc3);if(_0x4f8e40<_0x2c0579-_0x528dc3)throw new Error(_0x1f1c81(0x1f0)+_0x4f8e40[_0x1f1c81(0x1e8)](0x6)+'\x20USDT,\x20Requested:\x20'+_0x2c0579[_0x1f1c81(0x1e8)](0x6)+_0x1f1c81(0x341)+(_0x4f8e40-_0x2c0579)[_0x1f1c81(0x1e8)](0x8)+_0x1f1c81(0x2a4));console[_0x1f1c81(0x240)](_0x1f1c81(0x254));const _0x5961e8=Math[_0x1f1c81(0x30a)](_0x4f8e40,_0x2c0579);let _0x28ac93=_0xbe9c85;console['log'](_0x1f1c81(0x31b)+(_0xbe9c85||_0x1f1c81(0x266)));if(!_0x28ac93){console[_0x1f1c81(0x240)](_0x1f1c81(0x2c9));const _0x51e7be=await _0x4a3294[_0x1f1c81(0x249)][_0x1f1c81(0x1ef)]({'where':{'id':_0x56d122},'select':{'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'usdcErcWallet':!![]}});console['log'](_0x1f1c81(0x37a),_0x51e7be);if(_0x51e7be)switch(_0x226e2d){case _0x1f1c81(0x1d3):_0x28ac93=_0x51e7be[_0x1f1c81(0x26d)]||undefined,console['log'](_0x1f1c81(0x263)+_0x28ac93);break;case _0x1f1c81(0x262):_0x28ac93=_0x51e7be['usdtTrcWallet']||undefined,console[_0x1f1c81(0x240)](_0x1f1c81(0x352)+_0x28ac93);break;case _0x1f1c81(0x24d):_0x28ac93=_0x51e7be[_0x1f1c81(0x1de)]||undefined,console[_0x1f1c81(0x240)](_0x1f1c81(0x282)+_0x28ac93);break;case _0x1f1c81(0x29b):_0x28ac93=_0x51e7be['usdcPolygonWallet']||undefined,console[_0x1f1c81(0x240)](_0x1f1c81(0x29a)+_0x28ac93);break;case _0x1f1c81(0x2f7):_0x28ac93=_0x51e7be[_0x1f1c81(0x335)]||undefined,console['log'](_0x1f1c81(0x27f)+_0x28ac93);break;}}else console[_0x1f1c81(0x240)](_0x1f1c81(0x2c4)+_0x28ac93);console[_0x1f1c81(0x240)](_0x1f1c81(0x21a)+_0x226e2d+':\x20'+(_0x28ac93||'not\x20specified')),console['log'](_0x1f1c81(0x2de),{'shopId':_0x56d122,'amount':_0x5961e8,'network':_0x226e2d,'wallet':_0x28ac93,'status':_0x1f1c81(0x28d),'txid':_0x51c63d,'notes':_0x15d6a1,'periodFrom':_0x2e2dde?new Date(_0x2e2dde):null,'periodTo':_0x24c88b?new Date(_0x24c88b):null});const _0x1a3677=await _0x4a3294[_0x1f1c81(0x2ef)][_0x1f1c81(0x2b7)]({'data':{'shopId':_0x56d122,'amount':_0x5961e8,'network':_0x226e2d,'wallet':_0x28ac93,'status':_0x1f1c81(0x28d),'txid':_0x51c63d,'notes':_0x15d6a1,'periodFrom':_0x2e2dde?new Date(_0x2e2dde):null,'periodTo':_0x24c88b?new Date(_0x24c88b):null,'createdAt':new Date(),'paidAt':new Date()}});console[_0x1f1c81(0x240)]('âœ…\x20Payout\x20created\x20in\x20DB:',{'id':_0x1a3677['id'],'wallet':_0x1a3677[_0x1f1c81(0x2db)],'network':_0x1a3677[_0x1f1c81(0x2fc)],'amount':_0x1a3677[_0x1f1c81(0x313)]});const _0x449163=_0x4f8e40-_0x5961e8,_0x2c9958=Number(_0x317a7d[_0x1f1c81(0x372)])+_0x5961e8;return await _0x4a3294[_0x1f1c81(0x249)]['update']({'where':{'id':_0x56d122},'data':{'balance':_0x449163,'totalPaidOut':_0x2c9958}}),console['log'](_0x1f1c81(0x35a)+_0x317a7d['username']+'\x20balance\x20updated:'),console[_0x1f1c81(0x240)]('\x20\x20\x20Balance:\x20'+_0x4f8e40[_0x1f1c81(0x1e8)](0x6)+_0x1f1c81(0x290)+_0x449163[_0x1f1c81(0x1e8)](0x6)+_0x1f1c81(0x200)+_0x5961e8[_0x1f1c81(0x1e8)](0x6)+')'),console['log'](_0x1f1c81(0x30b)+_0x317a7d[_0x1f1c81(0x372)][_0x1f1c81(0x1e8)](0x6)+_0x1f1c81(0x290)+_0x2c9958['toFixed'](0x6)+'\x20USDT\x20(+'+_0x5961e8[_0x1f1c81(0x1e8)](0x6)+')'),console[_0x1f1c81(0x240)](_0x1f1c81(0x267)+_0x5961e8['toFixed'](0x6)+_0x1f1c81(0x2a4)),{'payout':_0x1a3677,'shop':_0x317a7d};});console[_0x4db589(0x240)]('âœ…\x20Payout\x20created:\x20'+_0x5d8f30[_0x4db589(0x2ef)]['id']+_0x4db589(0x2a8)+_0x5d8f30[_0x4db589(0x249)]['username']+'\x20('+_0x5d8f30[_0x4db589(0x2ef)][_0x4db589(0x313)][_0x4db589(0x1e8)](0x6)+'\x20USDT)');try{let _0x44bb6c='ÐÐµ\x20ÑƒÐºÐ°Ð·Ð°Ð½';if(_0x5d8f30[_0x4db589(0x2ef)][_0x4db589(0x1d9)]&&_0x5d8f30[_0x4db589(0x2ef)][_0x4db589(0x35b)]){const _0x3541f6=new Date(_0x5d8f30['payout']['periodFrom'])['toLocaleDateString'](_0x4db589(0x2c7)),_0x49c7b5=new Date(_0x5d8f30[_0x4db589(0x2ef)][_0x4db589(0x35b)])['toLocaleDateString'](_0x4db589(0x2c7));_0x44bb6c=_0x3541f6+_0x4db589(0x1fb)+_0x49c7b5;}await telegramBotService_1[_0x4db589(0x336)][_0x4db589(0x1d4)](_0x5d8f30[_0x4db589(0x2ef)][_0x4db589(0x2d7)],{'id':_0x5d8f30[_0x4db589(0x2ef)]['id'],'amount':_0x5d8f30[_0x4db589(0x2ef)]['amount'],'network':_0x5d8f30[_0x4db589(0x2ef)][_0x4db589(0x2fc)],'wallet':_0x5d8f30[_0x4db589(0x2ef)]['wallet'],'period':_0x44bb6c,'createdAt':_0x5d8f30[_0x4db589(0x2ef)][_0x4db589(0x206)],'txid':_0x5d8f30['payout'][_0x4db589(0x1e7)]}),console[_0x4db589(0x240)](_0x4db589(0x21c)+_0x5d8f30[_0x4db589(0x2ef)]['id']);}catch(_0x3c1bfa){console[_0x4db589(0x2c8)]('âŒ\x20Failed\x20to\x20send\x20Telegram\x20notification\x20for\x20payout\x20'+_0x5d8f30[_0x4db589(0x2ef)]['id']+':',_0x3c1bfa);}return{'id':_0x5d8f30['payout']['id'],'shopId':_0x5d8f30[_0x4db589(0x2ef)]['shopId'],'shopName':_0x5d8f30[_0x4db589(0x249)][_0x4db589(0x1dc)],'shopUsername':_0x5d8f30[_0x4db589(0x249)][_0x4db589(0x2dd)],'amount':_0x5d8f30[_0x4db589(0x2ef)][_0x4db589(0x313)],'network':_0x5d8f30[_0x4db589(0x2ef)][_0x4db589(0x2fc)],'wallet':_0x5d8f30[_0x4db589(0x2ef)][_0x4db589(0x2db)],'status':_0x5d8f30[_0x4db589(0x2ef)][_0x4db589(0x202)],'txid':_0x5d8f30[_0x4db589(0x2ef)]['txid'],'notes':_0x5d8f30[_0x4db589(0x2ef)][_0x4db589(0x24e)],'periodFrom':_0x5d8f30['payout'][_0x4db589(0x1d9)],'periodTo':_0x5d8f30[_0x4db589(0x2ef)]['periodTo'],'createdAt':_0x5d8f30[_0x4db589(0x2ef)][_0x4db589(0x206)],'paidAt':_0x5d8f30[_0x4db589(0x2ef)][_0x4db589(0x296)]};}async[a48_0x230d10(0x23c)](_0x4ee4ac){const _0x46c477=a48_0x230d10,{page:_0xaf7e51,limit:_0x2a538b,shopId:_0x1b538f,network:_0x5cd685,dateFrom:_0x5b193d,dateTo:_0x17b1ae,search:_0x2566b1}=_0x4ee4ac,_0x9c1326=(_0xaf7e51-0x1)*_0x2a538b,_0x3927da={};_0x1b538f&&(_0x3927da[_0x46c477(0x2d7)]=_0x1b538f);_0x5cd685&&(_0x3927da[_0x46c477(0x2fc)]=_0x5cd685);if(_0x5b193d||_0x17b1ae){_0x3927da['createdAt']={};if(_0x5b193d){const _0xecef7b=new Date(_0x5b193d);_0xecef7b['setHours'](0x0,0x0,0x0,0x1),_0x3927da['createdAt'][_0x46c477(0x26b)]=_0xecef7b,console[_0x46c477(0x240)](_0x46c477(0x381)+_0xecef7b[_0x46c477(0x27c)]());}if(_0x17b1ae){const _0x140986=new Date(_0x17b1ae);_0x140986[_0x46c477(0x320)](0x17,0x3b,0x3b,0x3e7),_0x3927da[_0x46c477(0x206)][_0x46c477(0x366)]=_0x140986,console[_0x46c477(0x240)](_0x46c477(0x225)+_0x140986['toISOString']());}}_0x2566b1&&(_0x3927da['OR']=[{'shop':{'name':{'contains':_0x2566b1,'mode':_0x46c477(0x287)}}},{'shop':{'username':{'contains':_0x2566b1,'mode':_0x46c477(0x287)}}},{'notes':{'contains':_0x2566b1,'mode':'insensitive'}}]);const [_0x2d8dbc,_0x33efa9]=await Promise[_0x46c477(0x323)]([database_1[_0x46c477(0x1da)][_0x46c477(0x2ef)][_0x46c477(0x1eb)]({'where':_0x3927da,'skip':_0x9c1326,'take':_0x2a538b,'orderBy':{'createdAt':_0x46c477(0x2d8)},'select':{'id':!![],'shopId':!![],'amount':!![],'network':!![],'status':!![],'txid':!![],'notes':!![],'periodFrom':!![],'periodTo':!![],'createdAt':!![],'wallet':!![],'paidAt':!![],'shop':{'select':{'name':!![],'username':!![]}}}}),database_1[_0x46c477(0x1da)][_0x46c477(0x2ef)][_0x46c477(0x2ea)]({'where':_0x3927da})]);return{'payouts':_0x2d8dbc[_0x46c477(0x236)](_0x210212=>({'id':_0x210212['id'],'shopId':_0x210212[_0x46c477(0x2d7)],'shopName':_0x210212[_0x46c477(0x249)][_0x46c477(0x1dc)],'shopUsername':_0x210212[_0x46c477(0x249)][_0x46c477(0x2dd)],'amount':_0x210212[_0x46c477(0x313)],'network':_0x210212[_0x46c477(0x2fc)],'wallet':_0x210212[_0x46c477(0x2db)],'status':_0x210212[_0x46c477(0x202)],'txid':_0x210212[_0x46c477(0x1e7)],'notes':_0x210212[_0x46c477(0x24e)],'periodFrom':_0x210212['periodFrom'],'periodTo':_0x210212[_0x46c477(0x35b)],'createdAt':_0x210212[_0x46c477(0x206)],'paidAt':_0x210212[_0x46c477(0x296)]})),'pagination':{'page':_0xaf7e51,'limit':_0x2a538b,'total':_0x33efa9,'totalPages':Math[_0x46c477(0x28b)](_0x33efa9/_0x2a538b)}};}async[a48_0x230d10(0x2f2)](_0xe612f5){const _0x38c4c3=a48_0x230d10,_0x5728e1=await database_1[_0x38c4c3(0x1da)][_0x38c4c3(0x2ef)]['findUnique']({'where':{'id':_0xe612f5},'include':{'shop':{'select':{'name':!![],'username':!![]}}}});if(!_0x5728e1)return null;return{'id':_0x5728e1['id'],'shopId':_0x5728e1[_0x38c4c3(0x2d7)],'shopName':_0x5728e1[_0x38c4c3(0x249)][_0x38c4c3(0x1dc)],'shopUsername':_0x5728e1[_0x38c4c3(0x249)]['username'],'amount':_0x5728e1[_0x38c4c3(0x313)],'network':_0x5728e1[_0x38c4c3(0x2fc)],'wallet':_0x5728e1[_0x38c4c3(0x2db)],'status':_0x5728e1[_0x38c4c3(0x202)],'txid':_0x5728e1['txid'],'notes':_0x5728e1[_0x38c4c3(0x24e)],'periodFrom':_0x5728e1[_0x38c4c3(0x1d9)],'periodTo':_0x5728e1[_0x38c4c3(0x35b)],'createdAt':_0x5728e1['createdAt'],'paidAt':_0x5728e1[_0x38c4c3(0x296)]};}async[a48_0x230d10(0x208)](_0x268dff){const _0x30afa5=a48_0x230d10;await database_1['default'][_0x30afa5(0x2ef)][_0x30afa5(0x283)]({'where':{'id':_0x268dff}});}async[a48_0x230d10(0x2d6)](_0x318eba,_0x3231c5){const _0xf6180a=a48_0x230d10,_0x5cd901=await database_1[_0xf6180a(0x1da)][_0xf6180a(0x274)](async _0x21c254=>{const _0x26dd36=_0xf6180a,_0x931dbe=await _0x21c254[_0x26dd36(0x2ef)][_0x26dd36(0x1ef)]({'where':{'id':_0x318eba},'include':{'shop':{'select':{'id':!![],'name':!![],'username':!![],'balance':!![],'totalPaidOut':!![]}}}});if(!_0x931dbe)throw new Error('Payout\x20not\x20found');console[_0x26dd36(0x240)](_0x26dd36(0x25d)+_0x318eba+'\x20for\x20shop\x20'+_0x931dbe[_0x26dd36(0x249)][_0x26dd36(0x2dd)]+':'),console[_0x26dd36(0x240)](_0x26dd36(0x246)+_0x931dbe['amount']['toFixed'](0x6)+'\x20USDT'),console['log'](_0x26dd36(0x1fd)+_0x931dbe[_0x26dd36(0x2fc)]),console[_0x26dd36(0x240)](_0x26dd36(0x2ce)+_0x931dbe[_0x26dd36(0x249)]['balance'][_0x26dd36(0x1e8)](0x6)+_0x26dd36(0x2a4)),console[_0x26dd36(0x240)](_0x26dd36(0x36e)+_0x931dbe[_0x26dd36(0x249)][_0x26dd36(0x372)][_0x26dd36(0x1e8)](0x6)+_0x26dd36(0x2a4));let _0x58e490=0x0;if(_0x3231c5[_0x26dd36(0x313)]!==undefined){const _0x29517a=Number(_0x931dbe['amount']),_0x3e58f5=Number(_0x3231c5[_0x26dd36(0x313)]);_0x58e490=_0x3e58f5-_0x29517a,console['log'](_0x26dd36(0x318)+_0x3e58f5[_0x26dd36(0x1e8)](0x6)+_0x26dd36(0x2a4)),console['log'](_0x26dd36(0x1f2)+_0x58e490[_0x26dd36(0x1e8)](0x6)+'\x20USDT');if(_0x58e490<0x0)console[_0x26dd36(0x240)](_0x26dd36(0x301)+Math[_0x26dd36(0x21d)](_0x58e490)[_0x26dd36(0x1e8)](0x6)+_0x26dd36(0x2d3));else{if(_0x58e490>0x0){const _0x19def6=Number(_0x931dbe['shop'][_0x26dd36(0x30c)]);console[_0x26dd36(0x240)](_0x26dd36(0x392)+_0x58e490[_0x26dd36(0x1e8)](0x6)+'\x20USDT\x20-\x20will\x20deduct\x20from\x20balance');if(_0x19def6<_0x58e490)throw new Error(_0x26dd36(0x2b8)+_0x19def6['toFixed'](0x6)+_0x26dd36(0x375)+_0x58e490['toFixed'](0x6)+_0x26dd36(0x2a4));}}}const _0x5aba94={};if(_0x3231c5[_0x26dd36(0x313)]!==undefined)_0x5aba94[_0x26dd36(0x313)]=_0x3231c5[_0x26dd36(0x313)];if(_0x3231c5[_0x26dd36(0x2fc)]!==undefined)_0x5aba94[_0x26dd36(0x2fc)]=_0x3231c5[_0x26dd36(0x2fc)];if(_0x3231c5[_0x26dd36(0x2db)]!==undefined)_0x5aba94[_0x26dd36(0x2db)]=_0x3231c5[_0x26dd36(0x2db)]||null;if(_0x3231c5[_0x26dd36(0x24e)]!==undefined)_0x5aba94['notes']=_0x3231c5[_0x26dd36(0x24e)]||null;if(_0x3231c5[_0x26dd36(0x1e7)]!==undefined)_0x5aba94[_0x26dd36(0x1e7)]=_0x3231c5[_0x26dd36(0x1e7)]||null;if(_0x3231c5[_0x26dd36(0x1d9)]!==undefined)_0x5aba94[_0x26dd36(0x1d9)]=_0x3231c5[_0x26dd36(0x1d9)]?new Date(_0x3231c5[_0x26dd36(0x1d9)]):null;if(_0x3231c5['periodTo']!==undefined)_0x5aba94['periodTo']=_0x3231c5[_0x26dd36(0x35b)]?new Date(_0x3231c5[_0x26dd36(0x35b)]):null;const _0x479f51=await _0x21c254[_0x26dd36(0x2ef)][_0x26dd36(0x2a6)]({'where':{'id':_0x318eba},'data':_0x5aba94,'include':{'shop':{'select':{'name':!![],'username':!![]}}}});if(_0x58e490!==0x0){const _0x2a5485=Number(_0x931dbe[_0x26dd36(0x249)]['balance']),_0x35929d=Number(_0x931dbe[_0x26dd36(0x249)][_0x26dd36(0x372)]),_0x2d52e1=_0x2a5485-_0x58e490,_0xeaf239=_0x35929d+_0x58e490;await _0x21c254[_0x26dd36(0x249)][_0x26dd36(0x2a6)]({'where':{'id':_0x931dbe['shopId']},'data':{'balance':_0x2d52e1,'totalPaidOut':_0xeaf239}}),console[_0x26dd36(0x240)](_0x26dd36(0x35a)+_0x931dbe['shop'][_0x26dd36(0x2dd)]+'\x20balance\x20updated:'),console[_0x26dd36(0x240)](_0x26dd36(0x210)+_0x2a5485[_0x26dd36(0x1e8)](0x6)+_0x26dd36(0x290)+_0x2d52e1[_0x26dd36(0x1e8)](0x6)+_0x26dd36(0x2a4)),console['log']('\x20\x20\x20Total\x20paid\x20out:\x20'+_0x35929d[_0x26dd36(0x1e8)](0x6)+_0x26dd36(0x290)+_0xeaf239[_0x26dd36(0x1e8)](0x6)+'\x20USDT');}return console[_0x26dd36(0x240)](_0x26dd36(0x21b)+_0x318eba+_0x26dd36(0x2bf)),_0x479f51;});return{'id':_0x5cd901['id'],'shopId':_0x5cd901['shopId'],'shopName':_0x5cd901[_0xf6180a(0x249)]['name'],'shopUsername':_0x5cd901['shop']['username'],'amount':Number(_0x5cd901['amount']),'network':_0x5cd901[_0xf6180a(0x2fc)],'wallet':_0x5cd901[_0xf6180a(0x2db)],'status':_0x5cd901[_0xf6180a(0x202)],'txid':_0x5cd901[_0xf6180a(0x1e7)],'notes':_0x5cd901[_0xf6180a(0x24e)],'periodFrom':_0x5cd901[_0xf6180a(0x1d9)],'periodTo':_0x5cd901[_0xf6180a(0x35b)],'createdAt':_0x5cd901[_0xf6180a(0x206)],'paidAt':_0x5cd901[_0xf6180a(0x296)]};}async[a48_0x230d10(0x222)](_0x37c3a7){const _0x27bfac=a48_0x230d10,{page:_0x221592,limit:_0x3d41d5,status:_0x4c1f47,gateway:_0x3517fa,shopId:_0x44fe4f,dateFrom:_0x5d2103,dateTo:_0x13cfa4,search:_0x1583dd,currency:_0x198a1c,sortBy:_0x494a03,sortOrder:_0xfcbb40}=_0x37c3a7,_0x3daa4b=(_0x221592-0x1)*_0x3d41d5;console[_0x27bfac(0x240)](_0x27bfac(0x298),_0x37c3a7);const _0x3290ab=await database_1[_0x27bfac(0x1da)][_0x27bfac(0x258)][_0x27bfac(0x25a)]({'by':[_0x27bfac(0x33d)],'_count':{'gateway':!![]}});console['log'](_0x27bfac(0x27b),_0x3290ab['map'](_0x328a01=>_0x328a01[_0x27bfac(0x33d)]+'\x20('+_0x328a01[_0x27bfac(0x362)][_0x27bfac(0x33d)]+_0x27bfac(0x280)));if(_0x3517fa){const _0x2127b0=_0x3290ab['some'](_0x2aa4e7=>_0x2aa4e7[_0x27bfac(0x33d)][_0x27bfac(0x2ee)]()===_0x3517fa[_0x27bfac(0x2ee)]());!_0x2127b0&&_0x3517fa[_0x27bfac(0x2ee)]()!==_0x27bfac(0x1ed)&&console[_0x27bfac(0x240)]('âš ï¸\x20Requested\x20gateway\x20\x27'+_0x3517fa+_0x27bfac(0x261)+_0x3290ab[_0x27bfac(0x236)](_0x5056ba=>_0x5056ba['gateway'])[_0x27bfac(0x377)](',\x20'));}const _0x129ac8={};_0x4c1f47&&(_0x129ac8[_0x27bfac(0x202)]=_0x4c1f47[_0x27bfac(0x2da)]());if(!_0x3517fa)_0x129ac8[_0x27bfac(0x33d)]={'not':_0x27bfac(0x1ed)};else{if(_0x3517fa&&(_0x3517fa['toLowerCase']()===_0x27bfac(0x1ed)||_0x3517fa===_0x27bfac(0x260)))_0x129ac8[_0x27bfac(0x33d)]=_0x27bfac(0x1ed);else{let _0x25de5b=_0x3517fa;const _0x6565df=(0x0,gateway_1[_0x27bfac(0x223)])(_0x3517fa);if(_0x6565df)_0x25de5b=_0x6565df,console[_0x27bfac(0x240)](_0x27bfac(0x252)+_0x3517fa+_0x27bfac(0x2cb)+_0x25de5b+'\x27');else{const _0x4cb40f=(0x0,gateway_1[_0x27bfac(0x294)])(_0x3517fa);if(_0x4cb40f){const _0x2f712d=(0x0,gateway_1[_0x27bfac(0x223)])(_0x4cb40f);_0x2f712d&&(_0x25de5b=_0x2f712d,console[_0x27bfac(0x240)]('ðŸ”„\x20Converted\x20gateway\x20name\x20\x27'+_0x3517fa+'\x27\x20->\x20ID\x20\x27'+_0x4cb40f+_0x27bfac(0x209)+_0x25de5b+'\x27'));}else console[_0x27bfac(0x240)]('ðŸ”\x20Using\x20gateway\x20\x27'+_0x3517fa+_0x27bfac(0x1d1));}const _0x5eaa5e=await database_1[_0x27bfac(0x1da)]['payment'][_0x27bfac(0x2ea)]({'where':{'gateway':_0x25de5b['toLowerCase']()},'take':0x1});_0x5eaa5e===0x0?(console['log'](_0x27bfac(0x272)+_0x25de5b+_0x27bfac(0x2c1)+_0x3517fa+_0x27bfac(0x37f)),_0x129ac8[_0x27bfac(0x33d)]=_0x27bfac(0x241)):(_0x129ac8[_0x27bfac(0x33d)]=_0x25de5b[_0x27bfac(0x2ee)](),console[_0x27bfac(0x240)](_0x27bfac(0x315)+_0x25de5b+_0x27bfac(0x2c1)+_0x3517fa+'\x27)'));}}console['log']('ðŸ“Š\x20Gateway\x20filter\x20applied:',_0x129ac8[_0x27bfac(0x33d)]);_0x44fe4f&&(_0x129ac8[_0x27bfac(0x2d7)]=_0x44fe4f);_0x198a1c&&(_0x129ac8['currency']=_0x198a1c[_0x27bfac(0x2da)](),console['log'](_0x27bfac(0x2e0)+_0x198a1c[_0x27bfac(0x2da)]()));if(_0x5d2103||_0x13cfa4){_0x129ac8[_0x27bfac(0x206)]={};if(_0x5d2103){const _0x189e17=new Date(_0x5d2103),_0x3bd1e5=new Date(Date[_0x27bfac(0x26e)](_0x189e17[_0x27bfac(0x2e7)](),_0x189e17[_0x27bfac(0x281)](),_0x189e17[_0x27bfac(0x2ae)](),0x0,0x0,0x0,0x0));_0x129ac8[_0x27bfac(0x206)][_0x27bfac(0x26b)]=_0x3bd1e5,console['log'](_0x27bfac(0x1e3)+_0x3bd1e5[_0x27bfac(0x27c)]());}if(_0x13cfa4){const _0xe05b92=new Date(_0x13cfa4),_0x39b11a=new Date(Date[_0x27bfac(0x26e)](_0xe05b92['getUTCFullYear'](),_0xe05b92[_0x27bfac(0x281)](),_0xe05b92['getUTCDate'](),0x17,0x3b,0x3b,0x3e7));_0x129ac8['createdAt'][_0x27bfac(0x366)]=_0x39b11a,console['log'](_0x27bfac(0x2f6)+_0x39b11a[_0x27bfac(0x27c)]());}}_0x1583dd&&(_0x129ac8['OR']=[{'id':{'contains':_0x1583dd,'mode':_0x27bfac(0x287)}},{'orderId':{'contains':_0x1583dd,'mode':'insensitive'}},{'gatewayOrderId':{'contains':_0x1583dd,'mode':_0x27bfac(0x287)}},{'customerEmail':{'contains':_0x1583dd,'mode':'insensitive'}},{'shop':{'name':{'contains':_0x1583dd,'mode':_0x27bfac(0x287)}}},{'shop':{'username':{'contains':_0x1583dd,'mode':_0x27bfac(0x287)}}}]);console[_0x27bfac(0x240)](_0x27bfac(0x34b),JSON[_0x27bfac(0x302)](_0x129ac8,null,0x2));const _0x5bd045=await database_1['default'][_0x27bfac(0x258)]['count']({'where':_0x129ac8});console[_0x27bfac(0x240)](_0x27bfac(0x348)+_0x5bd045);let _0x3f3e31={'createdAt':_0x27bfac(0x2d8)};if(_0x494a03){const _0x6c5fd9=[_0x27bfac(0x313),_0x27bfac(0x206),_0x27bfac(0x273),_0x27bfac(0x202),_0x27bfac(0x33d),_0x27bfac(0x345)],_0x588bae=[_0x27bfac(0x2f1),'desc'];if(_0x6c5fd9[_0x27bfac(0x329)](_0x494a03)){const _0x4a217c=_0x588bae[_0x27bfac(0x329)](_0xfcbb40)?_0xfcbb40:_0x27bfac(0x2d8);_0x3f3e31={[_0x494a03]:_0x4a217c},console[_0x27bfac(0x240)](_0x27bfac(0x26a)+_0x494a03+_0x27bfac(0x229)+_0x4a217c+_0x27bfac(0x242));}}const [_0x1af590,_0x238aa4]=await Promise['all']([database_1['default'][_0x27bfac(0x258)]['findMany']({'where':_0x129ac8,'skip':_0x3daa4b,'take':_0x3d41d5,'orderBy':_0x3f3e31,'include':{'shop':{'select':{'name':!![],'username':!![]}}}}),database_1[_0x27bfac(0x1da)][_0x27bfac(0x258)]['count']({'where':_0x129ac8})]);let _0x1f1008,_0x1d2a86;if(_0x5d2103){const _0x2fe97c=new Date(_0x5d2103);_0x1f1008=new Date(Date[_0x27bfac(0x26e)](_0x2fe97c[_0x27bfac(0x2e7)](),_0x2fe97c[_0x27bfac(0x281)](),_0x2fe97c[_0x27bfac(0x2ae)](),0x0,0x0,0x0,0x0));}else{const _0x5dbd8d=new Date();_0x1f1008=new Date(Date[_0x27bfac(0x26e)](_0x5dbd8d['getUTCFullYear'](),_0x5dbd8d['getUTCMonth'](),_0x5dbd8d['getUTCDate'](),0x0,0x0,0x0,0x0));}if(_0x13cfa4){const _0x826091=new Date(_0x13cfa4);_0x1d2a86=new Date(Date[_0x27bfac(0x26e)](_0x826091[_0x27bfac(0x2e7)](),_0x826091['getUTCMonth'](),_0x826091[_0x27bfac(0x2ae)](),0x17,0x3b,0x3b,0x3e7));}else{if(_0x5d2103){const _0x5ece4f=new Date(_0x5d2103);_0x1d2a86=new Date(Date['UTC'](_0x5ece4f[_0x27bfac(0x2e7)](),_0x5ece4f[_0x27bfac(0x281)](),_0x5ece4f['getUTCDate'](),0x17,0x3b,0x3b,0x3e7));}else{const _0x4043fd=new Date();_0x1d2a86=new Date(Date[_0x27bfac(0x26e)](_0x4043fd[_0x27bfac(0x2e7)](),_0x4043fd[_0x27bfac(0x281)](),_0x4043fd['getUTCDate'](),0x17,0x3b,0x3b,0x3e7));}}const _0x13e6e7={'status':_0x27bfac(0x2aa),'createdAt':{'gte':_0x1f1008,'lte':_0x1d2a86}};_0x3517fa?_0x13e6e7['gateway']=_0x129ac8[_0x27bfac(0x33d)]:_0x13e6e7[_0x27bfac(0x33d)]={'not':_0x27bfac(0x1ed)};_0x44fe4f&&(_0x13e6e7[_0x27bfac(0x2d7)]=_0x44fe4f);_0x198a1c&&(_0x13e6e7[_0x27bfac(0x345)]=_0x198a1c[_0x27bfac(0x2da)]());console[_0x27bfac(0x240)]('ðŸ“Š\x20Statistics\x20WHERE\x20conditions:',JSON[_0x27bfac(0x302)](_0x13e6e7,null,0x2));const _0x25007a=await database_1[_0x27bfac(0x1da)][_0x27bfac(0x258)][_0x27bfac(0x1eb)]({'where':_0x13e6e7,'select':{'amountUSDT':!![],'currency':!![],'amount':!![]}}),_0x38f6b4={};let _0x1a1ac2=0x0;return _0x25007a[_0x27bfac(0x25e)](_0x4cf1f9=>{const _0x17df79=_0x27bfac;_0x4cf1f9[_0x17df79(0x259)]&&(_0x1a1ac2+=_0x4cf1f9['amountUSDT']);if(_0x4cf1f9[_0x17df79(0x345)]){const _0x5ba75c=_0x4cf1f9[_0x17df79(0x345)][_0x17df79(0x2da)]();!_0x38f6b4[_0x5ba75c]&&(_0x38f6b4[_0x5ba75c]=0x0),_0x38f6b4[_0x5ba75c]+=_0x4cf1f9[_0x17df79(0x313)];}}),_0x1a1ac2>0x0&&(_0x38f6b4[_0x27bfac(0x250)]=_0x1a1ac2),{'payments':_0x1af590,'pagination':{'page':_0x221592,'limit':_0x3d41d5,'total':_0x238aa4,'totalPages':Math[_0x27bfac(0x28b)](_0x238aa4/_0x3d41d5)},'statistics':_0x38f6b4};}async[a48_0x230d10(0x1db)](_0x27438d){const _0x590499=a48_0x230d10,_0x141799=await database_1[_0x590499(0x1da)][_0x590499(0x258)][_0x590499(0x1ef)]({'where':{'id':_0x27438d},'select':{'id':!![],'shopId':!![],'amount':!![],'amountAfterGatewayCommissionUSDT':!![],'currency':!![],'sourceCurrency':!![],'status':!![],'gateway':!![],'orderId':!![],'gatewayOrderId':!![],'gatewayPaymentId':!![],'customerEmail':!![],'customerName':!![],'customerCountry':!![],'customerIp':!![],'customerUa':!![],'externalPaymentUrl':!![],'successUrl':!![],'failUrl':!![],'pendingUrl':!![],'whiteUrl':!![],'expiresAt':!![],'invoiceTotalSum':!![],'qrCode':!![],'qrUrl':!![],'country':!![],'language':!![],'amountIsEditable':!![],'maxPayments':!![],'rapydCustomer':!![],'cardLast4':!![],'paymentMethod':!![],'bankId':!![],'remitterIban':!![],'remitterName':!![],'failureMessage':!![],'usage':!![],'createdAt':!![],'updatedAt':!![],'shop':{'select':{'name':!![],'username':!![]}}}});if(!_0x141799)return null;return{'id':_0x141799['id'],'shopId':_0x141799[_0x590499(0x2d7)],'gateway':_0x141799[_0x590499(0x33d)],'amount':_0x141799[_0x590499(0x313)],'currency':_0x141799[_0x590499(0x345)],'status':_0x141799[_0x590499(0x202)],'orderId':_0x141799[_0x590499(0x349)],'gatewayOrderId':_0x141799['gatewayOrderId'],'customerEmail':_0x141799[_0x590499(0x330)],'customerName':_0x141799[_0x590499(0x243)],'customerCountry':_0x141799[_0x590499(0x33c)],'customerIp':_0x141799['customerIp'],'customerUa':_0x141799[_0x590499(0x2bd)],'failureMessage':_0x141799[_0x590499(0x1e4)],'externalPaymentUrl':_0x141799[_0x590499(0x31d)],'successUrl':_0x141799[_0x590499(0x1dd)],'failUrl':_0x141799[_0x590499(0x346)],'pendingUrl':_0x141799[_0x590499(0x224)],'whiteUrl':_0x141799[_0x590499(0x21f)],'createdAt':_0x141799['createdAt'],'updatedAt':_0x141799['updatedAt'],'shop':_0x141799[_0x590499(0x249)]};}async[a48_0x230d10(0x347)](_0x58e852,_0x331a9d,_0x5b1415,_0x5daf8e){const _0xdccb04=a48_0x230d10,_0x4f0eee=await database_1[_0xdccb04(0x1da)]['$transaction'](async _0x4b1b01=>{const _0x476989=_0xdccb04,_0x261f10=await _0x4b1b01[_0x476989(0x258)][_0x476989(0x1ef)]({'where':{'id':_0x58e852},'include':{'shop':{'select':{'id':!![],'name':!![],'username':!![],'balance':!![]}}}});if(!_0x261f10)throw new Error(_0x476989(0x321));const _0x50692a=_0x261f10[_0x476989(0x202)],_0x437d1b=_0x331a9d[_0x476989(0x2da)]();console[_0x476989(0x240)]('ðŸ”„\x20Admin\x20updating\x20payment\x20'+_0x58e852+_0x476989(0x379)+_0x50692a+'\x20->\x20'+_0x437d1b),console[_0x476989(0x240)]('ðŸ’°\x20Current\x20shop\x20balance:\x20'+_0x261f10[_0x476989(0x249)]['balance']+_0x476989(0x2a4));const _0x4fdac1={'status':_0x437d1b,'updatedAt':new Date(),'statusChangedBy':'admin','statusChangedAt':new Date()};_0x5b1415&&(_0x4fdac1[_0x476989(0x37c)]=_0x5b1415);_0x437d1b===_0x476989(0x338)&&_0x5daf8e&&(_0x4fdac1[_0x476989(0x2c2)]=_0x5daf8e);let _0x192d63=0x0,_0x9ea05e=_0x261f10['shop']['balance'];if(_0x437d1b===_0x476989(0x2aa)&&_0x50692a!==_0x476989(0x2aa)){_0x4fdac1['paidAt']=new Date();const _0x207d77=await currencyService_1[_0x476989(0x340)][_0x476989(0x2a9)](_0x261f10[_0x476989(0x313)],_0x261f10[_0x476989(0x345)]);_0x4fdac1[_0x476989(0x259)]=_0x207d77;let _0x3912b5=0x2d;const _0x7ca958=await _0x4b1b01[_0x476989(0x249)][_0x476989(0x1ef)]({'where':{'id':_0x261f10[_0x476989(0x2d7)]},'select':{'gatewaySettings':!![]}});if(_0x7ca958?.[_0x476989(0x38b)])try{const _0x5825c3=JSON[_0x476989(0x33f)](_0x7ca958[_0x476989(0x38b)]);for(const [_0x4b0d62,_0x58b369]of Object[_0x476989(0x219)](_0x5825c3)){if(_0x4b0d62['toLowerCase']()===_0x261f10[_0x476989(0x33d)][_0x476989(0x2ee)]()){_0x3912b5=_0x58b369[_0x476989(0x24f)]||0xa;break;}}}catch(_0x31f176){console[_0x476989(0x2c8)](_0x476989(0x2ac)+_0x58e852+':',_0x31f176);}let _0x3955bf;_0x261f10[_0x476989(0x2d1)]!==null&&_0x261f10[_0x476989(0x2d1)]!==undefined?(_0x3955bf=_0x261f10[_0x476989(0x2d1)],console[_0x476989(0x240)]('ðŸ“Š\x20[ADMIN]\x20Using\x20saved\x20amountAfterGatewayCommissionUSDT:\x20'+_0x3955bf[_0x476989(0x1e8)](0x6)+_0x476989(0x251)+_0x58e852)):(_0x3955bf=_0x207d77*(0x1-_0x3912b5/0x64),console[_0x476989(0x240)](_0x476989(0x339)+_0x58e852+':\x20'+_0x3912b5+_0x476989(0x2d5)+_0x207d77[_0x476989(0x1e8)](0x6)+_0x476989(0x2a4)),_0x4fdac1['amountAfterGatewayCommissionUSDT']=_0x3955bf,_0x4fdac1[_0x476989(0x23b)]=_0x3912b5),_0x192d63=_0x3955bf,_0x9ea05e+=_0x3955bf,console['log'](_0x476989(0x1e0)+_0x58e852+'\x20became\x20PAID:'),console[_0x476989(0x240)](_0x476989(0x311)+_0x207d77['toFixed'](0x6)+_0x476989(0x2a4)),console[_0x476989(0x240)](_0x476989(0x2c5)+_0x261f10[_0x476989(0x33d)]+_0x476989(0x309)+_0x3912b5+'%'),console['log'](_0x476989(0x35c)+_0x3955bf[_0x476989(0x1e8)](0x6)+'\x20USDT\x20(after\x20'+_0x3912b5+_0x476989(0x385)),console[_0x476989(0x240)](_0x476989(0x279)+_0x3955bf[_0x476989(0x1e8)](0x6)+_0x476989(0x2a4));}else{if(_0x50692a===_0x476989(0x2aa)&&_0x437d1b!==_0x476989(0x2aa)&&_0x437d1b!==_0x476989(0x338)){if(_0x261f10[_0x476989(0x259)]){let _0x562ba6=0x2d;const _0x17b0e7=await _0x4b1b01['shop']['findUnique']({'where':{'id':_0x261f10['shopId']},'select':{'gatewaySettings':!![]}});if(_0x17b0e7?.[_0x476989(0x38b)])try{const _0x2eedd5=JSON[_0x476989(0x33f)](_0x17b0e7[_0x476989(0x38b)]);for(const [_0x55f022,_0x20cbf9]of Object['entries'](_0x2eedd5)){if(_0x55f022[_0x476989(0x2ee)]()===_0x261f10[_0x476989(0x33d)]['toLowerCase']()){_0x562ba6=_0x20cbf9[_0x476989(0x24f)]||0xa;break;}}}catch(_0x9ff76c){console[_0x476989(0x2c8)](_0x476989(0x2ac)+_0x58e852+':',_0x9ff76c);}const _0x10d551=_0x261f10['amountUSDT']*(0x1-_0x562ba6/0x64);_0x192d63=-_0x10d551,_0x9ea05e-=_0x10d551,console['log']('\x20\x20\x20Full\x20amount:\x20'+_0x261f10['amountUSDT'][_0x476989(0x1e8)](0x6)+'\x20USDT'),console[_0x476989(0x240)]('\x20\x20\x20Gateway:\x20'+_0x261f10[_0x476989(0x33d)]+_0x476989(0x309)+_0x562ba6+'%'),console[_0x476989(0x240)](_0x476989(0x21e)+_0x10d551[_0x476989(0x1e8)](0x6)+_0x476989(0x2b1)+_0x562ba6+_0x476989(0x385)),console[_0x476989(0x240)](_0x476989(0x232)+_0x10d551['toFixed'](0x6)+_0x476989(0x2a4));}}}_0x437d1b===_0x476989(0x338)&&(console[_0x476989(0x240)](_0x476989(0x248)),_0x5daf8e&&_0x5daf8e>0x0?(_0x192d63=-_0x5daf8e,_0x9ea05e-=_0x5daf8e,console[_0x476989(0x240)](_0x476989(0x382)+_0x5daf8e[_0x476989(0x1e8)](0x6)+_0x476989(0x389)),console[_0x476989(0x240)]('ðŸ’°\x20Payment\x20amount\x20is\x20NOT\x20deducted\x20(chargeback\x20penalty\x20only)')):console[_0x476989(0x240)](_0x476989(0x2ca)),_0x4fdac1[_0x476989(0x2c2)]=_0x5daf8e||0x0);_0x437d1b===_0x476989(0x312)&&_0x50692a===_0x476989(0x2aa)&&console[_0x476989(0x240)](_0x476989(0x2d2));const _0x10fd99=await _0x4b1b01[_0x476989(0x258)][_0x476989(0x2a6)]({'where':{'id':_0x58e852},'data':_0x4fdac1,'include':{'shop':{'select':{'name':!![],'username':!![]}}}});return _0x192d63!==0x0&&(await _0x4b1b01['shop'][_0x476989(0x2a6)]({'where':{'id':_0x261f10[_0x476989(0x2d7)]},'data':{'balance':_0x9ea05e}}),console['log'](_0x476989(0x35a)+_0x261f10[_0x476989(0x2d7)]+'\x20balance\x20updated:\x20'+_0x261f10[_0x476989(0x249)][_0x476989(0x30c)][_0x476989(0x1e8)](0x6)+_0x476989(0x290)+_0x9ea05e['toFixed'](0x6)+_0x476989(0x22c)+(_0x192d63>0x0?'+':'')+_0x192d63[_0x476989(0x1e8)](0x6)+')')),_0x10fd99;});return{'id':_0x4f0eee['id'],'shopId':_0x4f0eee[_0xdccb04(0x2d7)],'gateway':_0x4f0eee[_0xdccb04(0x33d)],'amount':_0x4f0eee[_0xdccb04(0x313)],'currency':_0x4f0eee[_0xdccb04(0x345)],'status':_0x4f0eee[_0xdccb04(0x202)],'orderId':_0x4f0eee[_0xdccb04(0x349)],'gatewayOrderId':_0x4f0eee[_0xdccb04(0x2f3)],'customerEmail':_0x4f0eee[_0xdccb04(0x330)],'customerName':_0x4f0eee['customerName'],'customerCountry':_0x4f0eee['customerCountry'],'customerIp':_0x4f0eee['customerIp'],'customerUa':_0x4f0eee[_0xdccb04(0x2bd)],'failureMessage':_0x4f0eee[_0xdccb04(0x1e4)],'adminNotes':_0x4f0eee[_0xdccb04(0x37c)],'chargebackAmount':_0x4f0eee[_0xdccb04(0x2c2)],'statusChangedBy':_0x4f0eee[_0xdccb04(0x215)],'statusChangedAt':_0x4f0eee[_0xdccb04(0x288)],'createdAt':_0x4f0eee[_0xdccb04(0x206)],'updatedAt':_0x4f0eee[_0xdccb04(0x273)],'shop':_0x4f0eee[_0xdccb04(0x249)]};}async[a48_0x230d10(0x356)](_0x19f043,_0x3de789){const _0x594489=a48_0x230d10,_0x54fa58=Math[_0x594489(0x1f9)]()[_0x594489(0x212)](0x24)[_0x594489(0x1ea)](0x2,0x9);console['log'](_0x594489(0x2dc)+_0x54fa58+_0x594489(0x1ec)+_0x19f043);const _0x38443b={..._0x3de789};_0x3de789[_0x594489(0x32f)]&&_0x3de789[_0x594489(0x32f)][_0x594489(0x2d9)]()!==''?(console[_0x594489(0x240)](_0x594489(0x28e)+_0x54fa58+_0x594489(0x308)+_0x19f043),_0x38443b[_0x594489(0x32f)]=await bcryptjs_1[_0x594489(0x1da)][_0x594489(0x37d)](_0x3de789['password'],0xc)):(console[_0x594489(0x240)](_0x594489(0x28e)+_0x54fa58+_0x594489(0x217)),delete _0x38443b[_0x594489(0x32f)]);_0x3de789['fullName']&&(_0x38443b[_0x594489(0x1dc)]=_0x3de789[_0x594489(0x2e1)],delete _0x38443b['fullName']);_0x3de789['telegramId']&&(_0x38443b['telegram']=_0x3de789['telegramId'],delete _0x38443b[_0x594489(0x207)]);_0x3de789[_0x594489(0x357)]&&(_0x38443b[_0x594489(0x363)]=_0x3de789['merchantUrl'],delete _0x38443b[_0x594489(0x357)]);if(_0x3de789[_0x594489(0x24a)]){const _0x3dbecb=_0x3de789[_0x594489(0x24a)][_0x594489(0x236)](_0x9d87d2=>this[_0x594489(0x289)](_0x9d87d2));console['log']('ðŸ”„\x20Gateway\x20mapping:',_0x3de789[_0x594489(0x24a)],'->',_0x3dbecb),_0x38443b['paymentGateways']=JSON[_0x594489(0x302)](_0x3dbecb),delete _0x38443b[_0x594489(0x24a)];}_0x3de789[_0x594489(0x38b)]&&(console[_0x594489(0x240)](_0x594489(0x384)+_0x54fa58+_0x594489(0x1d2),_0x3de789[_0x594489(0x38b)]),_0x38443b[_0x594489(0x38b)]=JSON[_0x594489(0x302)](_0x3de789[_0x594489(0x38b)]),console[_0x594489(0x240)](_0x594489(0x384)+_0x54fa58+_0x594489(0x2ed),_0x38443b[_0x594489(0x38b)]));_0x3de789[_0x594489(0x371)]&&(_0x3de789[_0x594489(0x371)][_0x594489(0x26d)]!==undefined&&(_0x38443b[_0x594489(0x26d)]=_0x3de789[_0x594489(0x371)][_0x594489(0x26d)]||null),_0x3de789['wallets'][_0x594489(0x235)]!==undefined&&(_0x38443b[_0x594489(0x235)]=_0x3de789[_0x594489(0x371)]['usdtTrcWallet']||null),_0x3de789[_0x594489(0x371)][_0x594489(0x1de)]!==undefined&&(_0x38443b[_0x594489(0x1de)]=_0x3de789[_0x594489(0x371)]['usdtErcWallet']||null),_0x3de789['wallets'][_0x594489(0x203)]!==undefined&&(_0x38443b[_0x594489(0x203)]=_0x3de789[_0x594489(0x371)][_0x594489(0x203)]||null),delete _0x38443b[_0x594489(0x371)]);const _0x31d11c=await database_1[_0x594489(0x1da)][_0x594489(0x249)][_0x594489(0x2a6)]({'where':{'id':_0x19f043},'data':_0x38443b,'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});return console[_0x594489(0x240)](_0x594489(0x31e)+_0x54fa58+_0x594489(0x36c),_0x31d11c[_0x594489(0x38b)]),{'id':_0x31d11c['id'],'fullName':_0x31d11c[_0x594489(0x1dc)],'username':_0x31d11c['username'],'telegramId':_0x31d11c['telegram'],'merchantUrl':_0x31d11c[_0x594489(0x363)],'gateways':_0x31d11c['paymentGateways']?JSON[_0x594489(0x33f)](_0x31d11c[_0x594489(0x22f)]):null,'gatewaySettings':_0x31d11c[_0x594489(0x38b)]?JSON[_0x594489(0x33f)](_0x31d11c[_0x594489(0x38b)]):null,'publicKey':_0x31d11c[_0x594489(0x30e)],'wallets':{'usdtPolygonWallet':_0x31d11c[_0x594489(0x26d)],'usdtTrcWallet':_0x31d11c['usdtTrcWallet'],'usdtErcWallet':_0x31d11c['usdtErcWallet'],'usdcPolygonWallet':_0x31d11c[_0x594489(0x203)]},'status':_0x31d11c[_0x594489(0x202)],'createdAt':_0x31d11c[_0x594489(0x206)]};}async['suspendUser'](_0x84d221){const _0x46174d=a48_0x230d10,_0xb0f832=await database_1['default'][_0x46174d(0x249)][_0x46174d(0x2a6)]({'where':{'id':_0x84d221},'data':{'status':'SUSPENDED'},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});return{'id':_0xb0f832['id'],'fullName':_0xb0f832[_0x46174d(0x1dc)],'username':_0xb0f832['username'],'telegramId':_0xb0f832[_0x46174d(0x2a3)],'merchantUrl':_0xb0f832[_0x46174d(0x363)],'gateways':_0xb0f832[_0x46174d(0x22f)]?JSON[_0x46174d(0x33f)](_0xb0f832[_0x46174d(0x22f)]):null,'gatewaySettings':_0xb0f832[_0x46174d(0x38b)]?JSON[_0x46174d(0x33f)](_0xb0f832['gatewaySettings']):null,'publicKey':_0xb0f832[_0x46174d(0x30e)],'wallets':{'usdtPolygonWallet':_0xb0f832['usdtPolygonWallet'],'usdtTrcWallet':_0xb0f832['usdtTrcWallet'],'usdtErcWallet':_0xb0f832[_0x46174d(0x1de)],'usdcPolygonWallet':_0xb0f832[_0x46174d(0x203)]},'status':_0xb0f832[_0x46174d(0x202)],'createdAt':_0xb0f832['createdAt']};}async[a48_0x230d10(0x2ba)](_0x1705dc){const _0x1c735e=a48_0x230d10,_0x33383d=await database_1[_0x1c735e(0x1da)][_0x1c735e(0x249)][_0x1c735e(0x2a6)]({'where':{'id':_0x1705dc},'data':{'status':_0x1c735e(0x221)},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});return{'id':_0x33383d['id'],'fullName':_0x33383d[_0x1c735e(0x1dc)],'username':_0x33383d[_0x1c735e(0x2dd)],'telegramId':_0x33383d['telegram'],'merchantUrl':_0x33383d[_0x1c735e(0x363)],'gateways':_0x33383d[_0x1c735e(0x22f)]?JSON['parse'](_0x33383d[_0x1c735e(0x22f)]):null,'gatewaySettings':_0x33383d['gatewaySettings']?JSON['parse'](_0x33383d[_0x1c735e(0x38b)]):null,'publicKey':_0x33383d['publicKey'],'wallets':{'usdtPolygonWallet':_0x33383d[_0x1c735e(0x26d)],'usdtTrcWallet':_0x33383d[_0x1c735e(0x235)],'usdtErcWallet':_0x33383d['usdtErcWallet'],'usdcPolygonWallet':_0x33383d[_0x1c735e(0x203)]},'status':_0x33383d['status'],'createdAt':_0x33383d[_0x1c735e(0x206)]};}async[a48_0x230d10(0x2b4)](_0x5e5546){const _0x5783a3=a48_0x230d10,{page:_0x59691f,limit:_0x176db9,status:_0x2d47a9,search:_0x5ef481}=_0x5e5546,_0x2413a4=(_0x59691f-0x1)*_0x176db9,_0x5e8b85={};_0x2d47a9&&(_0x5e8b85['status']=_0x2d47a9[_0x5783a3(0x2da)]());_0x5ef481&&(_0x5e8b85['OR']=[{'name':{'contains':_0x5ef481,'mode':_0x5783a3(0x287)}},{'username':{'contains':_0x5ef481,'mode':'insensitive'}},{'telegram':{'contains':_0x5ef481,'mode':_0x5783a3(0x287)}},{'shopUrl':{'contains':_0x5ef481,'mode':_0x5783a3(0x287)}}]);const [_0x2a1f53,_0x1b6e68]=await Promise[_0x5783a3(0x323)]([database_1[_0x5783a3(0x1da)][_0x5783a3(0x249)][_0x5783a3(0x1eb)]({'where':_0x5e8b85,'skip':_0x2413a4,'take':_0x176db9,'orderBy':{'createdAt':_0x5783a3(0x2d8)},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'usdcErcWallet':!![],'status':!![],'twoFactorEnabled':!![],'createdAt':!![],'_count':{'select':{'telegramUsers':!![]}}}}),database_1[_0x5783a3(0x1da)]['shop'][_0x5783a3(0x2ea)]({'where':_0x5e8b85})]);return{'users':_0x2a1f53[_0x5783a3(0x236)](_0x25a50d=>{const _0x345d68=_0x5783a3,_0x4097c2=_0x25a50d['paymentGateways']?JSON[_0x345d68(0x33f)](_0x25a50d[_0x345d68(0x22f)]):null,_0x403268=_0x4097c2?_0x4097c2[_0x345d68(0x236)](_0xea2bde=>this[_0x345d68(0x2d4)](_0xea2bde)):null;return{'id':_0x25a50d['id'],'fullName':_0x25a50d[_0x345d68(0x1dc)],'username':_0x25a50d[_0x345d68(0x2dd)],'telegramId':_0x25a50d['telegram'],'merchantUrl':_0x25a50d['shopUrl'],'gateways':_0x403268,'gatewaySettings':_0x25a50d[_0x345d68(0x38b)]?JSON[_0x345d68(0x33f)](_0x25a50d['gatewaySettings']):null,'publicKey':_0x25a50d[_0x345d68(0x30e)],'wallets':{'usdtPolygonWallet':_0x25a50d[_0x345d68(0x26d)],'usdtTrcWallet':_0x25a50d[_0x345d68(0x235)],'usdtErcWallet':_0x25a50d[_0x345d68(0x1de)],'usdcPolygonWallet':_0x25a50d['usdcPolygonWallet'],'usdcErcWallet':_0x25a50d[_0x345d68(0x335)]},'status':_0x25a50d[_0x345d68(0x202)],'twoFactorEnabled':_0x25a50d[_0x345d68(0x227)]||![],'telegramUsersCount':_0x25a50d[_0x345d68(0x362)][_0x345d68(0x2af)],'createdAt':_0x25a50d['createdAt']};}),'pagination':{'page':_0x59691f,'limit':_0x176db9,'total':_0x1b6e68,'totalPages':Math[_0x5783a3(0x28b)](_0x1b6e68/_0x176db9)}};}async['getUserById'](_0x98ca76){const _0x1108ab=a48_0x230d10,_0x19f2c0=await database_1[_0x1108ab(0x1da)]['shop'][_0x1108ab(0x1ef)]({'where':{'id':_0x98ca76},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'usdcErcWallet':!![],'status':!![],'createdAt':!![]}});if(!_0x19f2c0)return null;const _0x1a36db=_0x19f2c0['paymentGateways']?JSON[_0x1108ab(0x33f)](_0x19f2c0[_0x1108ab(0x22f)]):null,_0xe07b4d=_0x1a36db?_0x1a36db[_0x1108ab(0x236)](_0x54f6d4=>this[_0x1108ab(0x2d4)](_0x54f6d4)):null;return _0x1a36db&&_0xe07b4d&&console[_0x1108ab(0x240)]('ðŸ”„\x20Gateway\x20mapping\x20(get):',_0x1a36db,'->',_0xe07b4d),{'id':_0x19f2c0['id'],'fullName':_0x19f2c0[_0x1108ab(0x1dc)],'username':_0x19f2c0[_0x1108ab(0x2dd)],'telegramId':_0x19f2c0[_0x1108ab(0x2a3)],'merchantUrl':_0x19f2c0[_0x1108ab(0x363)],'gateways':_0xe07b4d,'gatewaySettings':_0x19f2c0[_0x1108ab(0x38b)]?JSON[_0x1108ab(0x33f)](_0x19f2c0[_0x1108ab(0x38b)]):null,'publicKey':_0x19f2c0[_0x1108ab(0x30e)],'wallets':{'usdtPolygonWallet':_0x19f2c0[_0x1108ab(0x26d)],'usdtTrcWallet':_0x19f2c0['usdtTrcWallet'],'usdtErcWallet':_0x19f2c0['usdtErcWallet'],'usdcPolygonWallet':_0x19f2c0['usdcPolygonWallet'],'usdcErcWallet':_0x19f2c0[_0x1108ab(0x335)]},'status':_0x19f2c0[_0x1108ab(0x202)],'createdAt':_0x19f2c0['createdAt']};}async[a48_0x230d10(0x359)](_0x5d7ec0){const _0x3b765b=a48_0x230d10,{fullName:_0x5d74bd,username:_0x465b6d,password:_0x426c73,telegramId:_0x3909e7,merchantUrl:_0x2b1173,gateways:_0x371508,gatewaySettings:_0x203e96,wallets:_0x22739d}=_0x5d7ec0,_0x76f0eb=await database_1[_0x3b765b(0x1da)][_0x3b765b(0x249)][_0x3b765b(0x1ef)]({'where':{'username':_0x465b6d}});if(_0x76f0eb)throw new Error('Username\x20already\x20exists');if(_0x3909e7){const _0x574982=await database_1[_0x3b765b(0x1da)]['shop'][_0x3b765b(0x1ef)]({'where':{'telegram':_0x3909e7}});if(_0x574982)throw new Error(_0x3b765b(0x1f3));}const _0x598ba0=await bcryptjs_1[_0x3b765b(0x1da)][_0x3b765b(0x37d)](_0x426c73,0xc),_0x5df670=_0x3b765b(0x293)+crypto_1['default'][_0x3b765b(0x2c3)](0x20)['toString']('hex'),_0x34ff36=_0x3b765b(0x358)+crypto_1[_0x3b765b(0x1da)][_0x3b765b(0x2c3)](0x20)[_0x3b765b(0x212)](_0x3b765b(0x365)),_0x336d34=_0x371508?_0x371508[_0x3b765b(0x236)](_0x17d990=>this[_0x3b765b(0x289)](_0x17d990)):null;_0x371508&&_0x336d34&&console[_0x3b765b(0x240)]('ðŸ”„\x20Gateway\x20mapping\x20(create):',_0x371508,'->',_0x336d34);const _0x571244=await database_1[_0x3b765b(0x1da)][_0x3b765b(0x249)][_0x3b765b(0x2b7)]({'data':{'name':_0x5d74bd,'username':_0x465b6d,'password':_0x598ba0,'telegram':_0x3909e7,'shopUrl':_0x2b1173,'paymentGateways':_0x336d34?JSON[_0x3b765b(0x302)](_0x336d34):null,'gatewaySettings':_0x203e96?JSON['stringify'](_0x203e96):null,'usdtPolygonWallet':_0x22739d?.['usdtPolygonWallet']||null,'usdtTrcWallet':_0x22739d?.[_0x3b765b(0x235)]||null,'usdtErcWallet':_0x22739d?.[_0x3b765b(0x1de)]||null,'usdcPolygonWallet':_0x22739d?.['usdcPolygonWallet']||null,'publicKey':_0x5df670,'secretKey':_0x34ff36,'status':_0x3b765b(0x221)},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});return{'id':_0x571244['id'],'fullName':_0x571244[_0x3b765b(0x1dc)],'username':_0x571244[_0x3b765b(0x2dd)],'telegramId':_0x571244[_0x3b765b(0x2a3)],'merchantUrl':_0x571244[_0x3b765b(0x363)],'gateways':_0x571244[_0x3b765b(0x22f)]?JSON[_0x3b765b(0x33f)](_0x571244[_0x3b765b(0x22f)]):null,'gatewaySettings':_0x571244['gatewaySettings']?JSON[_0x3b765b(0x33f)](_0x571244[_0x3b765b(0x38b)]):null,'publicKey':_0x571244[_0x3b765b(0x30e)],'wallets':{'usdtPolygonWallet':_0x571244[_0x3b765b(0x26d)],'usdtTrcWallet':_0x571244[_0x3b765b(0x235)],'usdtErcWallet':_0x571244[_0x3b765b(0x1de)],'usdcPolygonWallet':_0x571244[_0x3b765b(0x203)]},'status':_0x571244[_0x3b765b(0x202)],'createdAt':_0x571244[_0x3b765b(0x206)]};}async[a48_0x230d10(0x31a)](_0x40aa51,_0x1363e5){const _0xf699fa=a48_0x230d10;if(config_1[_0xf699fa(0x1f8)][_0xf699fa(0x2fa)][_0xf699fa(0x227)]){if(!_0x1363e5)throw new Error(_0xf699fa(0x201));const _0x5d654d=speakeasy_1[_0xf699fa(0x1da)][_0xf699fa(0x2e4)]['verify']({'secret':config_1[_0xf699fa(0x1f8)]['admin'][_0xf699fa(0x292)],'encoding':_0xf699fa(0x2bc),'token':_0x1363e5,'window':0x2});if(!_0x5d654d){let _0x1fd9ed=![];if(config_1[_0xf699fa(0x1f8)][_0xf699fa(0x2fa)]['backupCodes']){const _0xb1d6cd=JSON['parse'](config_1['config'][_0xf699fa(0x2fa)][_0xf699fa(0x387)]);for(let _0x20107f=0x0;_0x20107f<_0xb1d6cd[_0xf699fa(0x20b)];_0x20107f++){const _0x37e123=await bcryptjs_1[_0xf699fa(0x1da)][_0xf699fa(0x36a)](_0x1363e5,_0xb1d6cd[_0x20107f]);if(_0x37e123){_0x1fd9ed=!![],_0xb1d6cd[_0xf699fa(0x1d7)](_0x20107f,0x1),config_1[_0xf699fa(0x1f8)][_0xf699fa(0x2fa)][_0xf699fa(0x387)]=JSON[_0xf699fa(0x302)](_0xb1d6cd);const _0x4f9f68=path_1[_0xf699fa(0x1da)][_0xf699fa(0x377)](process[_0xf699fa(0x2b6)](),_0xf699fa(0x204));if(fs_1[_0xf699fa(0x1da)]['existsSync'](_0x4f9f68)){let _0x1a02e7=fs_1[_0xf699fa(0x1da)][_0xf699fa(0x322)](_0x4f9f68,_0xf699fa(0x31c));const _0x147b09=_0x1a02e7['split']('\x0a');for(let _0x104666=0x0;_0x104666<_0x147b09[_0xf699fa(0x20b)];_0x104666++){if(_0x147b09[_0x104666]['startsWith'](_0xf699fa(0x319))){_0x147b09[_0x104666]=_0xf699fa(0x319)+JSON[_0xf699fa(0x302)](_0xb1d6cd);break;}}fs_1[_0xf699fa(0x1da)][_0xf699fa(0x38d)](_0x4f9f68,_0x147b09[_0xf699fa(0x377)]('\x0a'),'utf8');}break;}}}if(!_0x1fd9ed)throw new Error(_0xf699fa(0x2f5));}}await database_1[_0xf699fa(0x1da)]['shop'][_0xf699fa(0x283)]({'where':{'id':_0x40aa51}});}async[a48_0x230d10(0x285)](_0x1aa9b7){const _0x172f96=a48_0x230d10,_0x52c910=await database_1['default'][_0x172f96(0x249)][_0x172f96(0x1ef)]({'where':{'id':_0x1aa9b7},'select':{'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'usdcErcWallet':!![]}});if(!_0x52c910)throw new Error(_0x172f96(0x271));return{'usdtPolygonWallet':_0x52c910['usdtPolygonWallet'],'usdtTrcWallet':_0x52c910[_0x172f96(0x235)],'usdtErcWallet':_0x52c910[_0x172f96(0x1de)],'usdcPolygonWallet':_0x52c910[_0x172f96(0x203)],'usdcErcWallet':_0x52c910[_0x172f96(0x335)]};}[a48_0x230d10(0x1fa)](_0x3a2194=0x8){const _0x11772e=a48_0x230d10,_0xade52e=[];for(let _0x5c9f5b=0x0;_0x5c9f5b<_0x3a2194;_0x5c9f5b++){const _0x5bd53d=crypto_1['default'][_0x11772e(0x2c3)](0x4)['toString'](_0x11772e(0x365))['toUpperCase']();_0xade52e[_0x11772e(0x1f6)](_0x5bd53d);}return _0xade52e;}async[a48_0x230d10(0x239)](_0x494563){const _0x19d741=a48_0x230d10,_0x1040ad=await database_1[_0x19d741(0x1da)][_0x19d741(0x249)][_0x19d741(0x1ef)]({'where':{'id':_0x494563},'select':{'id':!![],'name':!![],'username':!![],'twoFactorEnabled':!![]}});if(!_0x1040ad)throw new Error('Shop\x20not\x20found');const _0x33d77b=speakeasy_1['default'][_0x19d741(0x2c0)]({'name':_0x19d741(0x364)+_0x1040ad[_0x19d741(0x2dd)]+')','issuer':_0x19d741(0x2b5),'length':0x20}),_0xaa1a76=await qrcode_1['default']['toDataURL'](_0x33d77b[_0x19d741(0x2df)]),_0x2982bc=this[_0x19d741(0x1fa)](0x8),_0x24c367=await Promise[_0x19d741(0x323)](_0x2982bc[_0x19d741(0x236)](_0x4e73f2=>bcryptjs_1[_0x19d741(0x1da)]['hash'](_0x4e73f2,0xa)));return await database_1[_0x19d741(0x1da)]['shop'][_0x19d741(0x2a6)]({'where':{'id':_0x494563},'data':{'twoFactorSecret':_0x33d77b[_0x19d741(0x2bc)],'backupCodes':JSON['stringify'](_0x24c367)}}),console['log']('ðŸ”\x202FA\x20setup\x20initiated\x20for\x20shop:\x20'+_0x1040ad[_0x19d741(0x2dd)]),console[_0x19d741(0x240)](_0x19d741(0x20d)+_0x2982bc['length']+_0x19d741(0x334)),{'secret':_0x33d77b[_0x19d741(0x2bc)],'qrCode':_0xaa1a76,'manualEntryKey':_0x33d77b[_0x19d741(0x2bc)],'backupCodes':_0x2982bc};}async['enable2FA'](_0x48ddab,_0x4338a5){const _0x52c8d8=a48_0x230d10,_0x74be2b=await database_1[_0x52c8d8(0x1da)]['shop'][_0x52c8d8(0x1ef)]({'where':{'id':_0x48ddab},'select':{'id':!![],'username':!![],'twoFactorSecret':!![],'twoFactorEnabled':!![]}});if(!_0x74be2b)throw new Error(_0x52c8d8(0x271));if(!_0x74be2b[_0x52c8d8(0x292)])throw new Error(_0x52c8d8(0x310));if(_0x74be2b[_0x52c8d8(0x227)])throw new Error(_0x52c8d8(0x383));const _0x333164=speakeasy_1['default'][_0x52c8d8(0x2e4)][_0x52c8d8(0x391)]({'secret':_0x74be2b['twoFactorSecret'],'encoding':_0x52c8d8(0x2bc),'token':_0x4338a5,'window':0x2});if(!_0x333164)throw new Error(_0x52c8d8(0x1f7));return await database_1[_0x52c8d8(0x1da)][_0x52c8d8(0x249)][_0x52c8d8(0x2a6)]({'where':{'id':_0x48ddab},'data':{'twoFactorEnabled':!![]}}),console[_0x52c8d8(0x240)]('ðŸ”\x202FA\x20enabled\x20for\x20shop:\x20'+_0x74be2b[_0x52c8d8(0x2dd)]),{'enabled':!![]};}async[a48_0x230d10(0x317)](_0x53d133){const _0x29d165=a48_0x230d10,_0x1fdd5d=await database_1[_0x29d165(0x1da)][_0x29d165(0x249)]['findUnique']({'where':{'id':_0x53d133},'select':{'id':!![],'username':!![],'twoFactorEnabled':!![]}});if(!_0x1fdd5d)throw new Error(_0x29d165(0x271));await database_1[_0x29d165(0x1da)][_0x29d165(0x249)][_0x29d165(0x2a6)]({'where':{'id':_0x53d133},'data':{'twoFactorEnabled':![],'twoFactorSecret':null,'backupCodes':null}}),console[_0x29d165(0x240)](_0x29d165(0x1fe)+_0x1fdd5d[_0x29d165(0x2dd)]);}async[a48_0x230d10(0x27d)](_0x18973e,_0x2d05ac,_0x47c4b3,_0x571bcd){const _0x4f3853=a48_0x230d10;if(_0x2d05ac!==_0x47c4b3)throw new Error('New\x20password\x20and\x20confirmation\x20do\x20not\x20match');if(_0x2d05ac[_0x4f3853(0x20b)]<0x6)throw new Error(_0x4f3853(0x1ff));const _0x592d78=await bcryptjs_1[_0x4f3853(0x1da)][_0x4f3853(0x36a)](_0x18973e,config_1[_0x4f3853(0x1f8)][_0x4f3853(0x2fa)][_0x4f3853(0x306)]);if(!_0x592d78)throw new Error(_0x4f3853(0x247));if(config_1['config'][_0x4f3853(0x2fa)][_0x4f3853(0x227)]){if(!_0x571bcd)throw new Error(_0x4f3853(0x201));const _0x5c0304=speakeasy_1[_0x4f3853(0x1da)]['totp'][_0x4f3853(0x391)]({'secret':config_1[_0x4f3853(0x1f8)][_0x4f3853(0x2fa)][_0x4f3853(0x292)],'encoding':_0x4f3853(0x2bc),'token':_0x571bcd,'window':0x2});if(!_0x5c0304){let _0x375eb6=![];if(config_1['config']['admin'][_0x4f3853(0x387)]){const _0x4eb6f4=JSON[_0x4f3853(0x33f)](config_1[_0x4f3853(0x1f8)][_0x4f3853(0x2fa)]['backupCodes']);for(let _0x4dab1b=0x0;_0x4dab1b<_0x4eb6f4[_0x4f3853(0x20b)];_0x4dab1b++){const _0x35265e=await bcryptjs_1[_0x4f3853(0x1da)]['compare'](_0x571bcd,_0x4eb6f4[_0x4dab1b]);if(_0x35265e){_0x375eb6=!![],_0x4eb6f4['splice'](_0x4dab1b,0x1),config_1[_0x4f3853(0x1f8)][_0x4f3853(0x2fa)]['backupCodes']=JSON[_0x4f3853(0x302)](_0x4eb6f4);const _0x45e7e7=path_1[_0x4f3853(0x1da)][_0x4f3853(0x377)](process[_0x4f3853(0x2b6)](),_0x4f3853(0x204));if(fs_1[_0x4f3853(0x1da)][_0x4f3853(0x20f)](_0x45e7e7)){let _0x3d3974=fs_1[_0x4f3853(0x1da)][_0x4f3853(0x322)](_0x45e7e7,_0x4f3853(0x31c));const _0x3d0a8d=_0x3d3974[_0x4f3853(0x231)]('\x0a');for(let _0x3b3027=0x0;_0x3b3027<_0x3d0a8d[_0x4f3853(0x20b)];_0x3b3027++){if(_0x3d0a8d[_0x3b3027][_0x4f3853(0x2a1)]('ADMIN_BACKUP_CODES=')){_0x3d0a8d[_0x3b3027]=_0x4f3853(0x319)+JSON[_0x4f3853(0x302)](_0x4eb6f4);break;}}fs_1[_0x4f3853(0x1da)][_0x4f3853(0x38d)](_0x45e7e7,_0x3d0a8d[_0x4f3853(0x377)]('\x0a'),'utf8');}break;}}}if(!_0x375eb6)throw new Error(_0x4f3853(0x2f5));}}const _0xdb60b=await bcryptjs_1['default'][_0x4f3853(0x37d)](_0x2d05ac,0xc);config_1[_0x4f3853(0x1f8)][_0x4f3853(0x2fa)][_0x4f3853(0x306)]=_0xdb60b;const _0x97939e=path_1['default']['join'](process[_0x4f3853(0x2b6)](),'.env');let _0x22a2d9='';if(fs_1[_0x4f3853(0x1da)][_0x4f3853(0x20f)](_0x97939e)){_0x22a2d9=fs_1[_0x4f3853(0x1da)][_0x4f3853(0x322)](_0x97939e,_0x4f3853(0x31c));const _0x2322de=_0x22a2d9[_0x4f3853(0x231)]('\x0a');let _0x4e7b63=![];for(let _0x111368=0x0;_0x111368<_0x2322de[_0x4f3853(0x20b)];_0x111368++){if(_0x2322de[_0x111368][_0x4f3853(0x2a1)]('ADMIN_PASSWORD_HASH=')){_0x2322de[_0x111368]=_0x4f3853(0x20a)+_0xdb60b,_0x4e7b63=!![];break;}}!_0x4e7b63&&_0x2322de[_0x4f3853(0x1f6)](_0x4f3853(0x20a)+_0xdb60b),_0x22a2d9=_0x2322de['join']('\x0a'),fs_1['default'][_0x4f3853(0x38d)](_0x97939e,_0x22a2d9,_0x4f3853(0x31c));}console[_0x4f3853(0x240)](_0x4f3853(0x380));}async[a48_0x230d10(0x230)](){const _0x1d0bad=a48_0x230d10;let _0x221160=0x0;if(config_1[_0x1d0bad(0x1f8)][_0x1d0bad(0x2fa)][_0x1d0bad(0x387)])try{const _0x564660=JSON['parse'](config_1[_0x1d0bad(0x1f8)][_0x1d0bad(0x2fa)][_0x1d0bad(0x387)]);_0x221160=_0x564660[_0x1d0bad(0x20b)];}catch(_0x5b7c71){console[_0x1d0bad(0x2c8)](_0x1d0bad(0x2a2),_0x5b7c71);}return{'twoFactorEnabled':config_1['config'][_0x1d0bad(0x2fa)][_0x1d0bad(0x227)],'backupCodesCount':_0x221160};}async['setupAdmin2FA'](){const _0x35e572=a48_0x230d10,_0x5d1d02=speakeasy_1[_0x35e572(0x1da)][_0x35e572(0x2c0)]({'name':_0x35e572(0x307)+config_1[_0x35e572(0x1f8)][_0x35e572(0x2fa)][_0x35e572(0x2dd)]+')','issuer':_0x35e572(0x1e9),'length':0x20}),_0xbccdf6=await qrcode_1[_0x35e572(0x1da)][_0x35e572(0x277)](_0x5d1d02['otpauth_url']),_0x5ead3a=[];for(let _0x34ef48=0x0;_0x34ef48<0x8;_0x34ef48++){const _0x4ea91e=crypto_1[_0x35e572(0x1da)][_0x35e572(0x2c3)](0x4)[_0x35e572(0x212)](_0x35e572(0x365))[_0x35e572(0x2da)]();_0x5ead3a[_0x35e572(0x1f6)](_0x4ea91e);}const _0x3f9c84=await Promise[_0x35e572(0x323)](_0x5ead3a[_0x35e572(0x236)](_0x3ab7d3=>bcryptjs_1[_0x35e572(0x1da)]['hash'](_0x3ab7d3,0xa)));config_1[_0x35e572(0x1f8)][_0x35e572(0x2fa)][_0x35e572(0x292)]=_0x5d1d02[_0x35e572(0x2bc)],config_1[_0x35e572(0x1f8)][_0x35e572(0x2fa)][_0x35e572(0x387)]=JSON['stringify'](_0x3f9c84);const _0x46aee5=path_1[_0x35e572(0x1da)][_0x35e572(0x377)](process[_0x35e572(0x2b6)](),'.env');if(fs_1[_0x35e572(0x1da)][_0x35e572(0x20f)](_0x46aee5)){let _0x54f906=fs_1['default'][_0x35e572(0x322)](_0x46aee5,_0x35e572(0x31c));const _0x5d6cc3=_0x54f906['split']('\x0a');let _0x3951eb=![],_0x225576=![];for(let _0xaae4d4=0x0;_0xaae4d4<_0x5d6cc3[_0x35e572(0x20b)];_0xaae4d4++){_0x5d6cc3[_0xaae4d4]['startsWith'](_0x35e572(0x361))&&(_0x5d6cc3[_0xaae4d4]=_0x35e572(0x361)+_0x5d1d02[_0x35e572(0x2bc)],_0x3951eb=!![]),_0x5d6cc3[_0xaae4d4][_0x35e572(0x2a1)]('ADMIN_BACKUP_CODES=')&&(_0x5d6cc3[_0xaae4d4]=_0x35e572(0x319)+JSON[_0x35e572(0x302)](_0x3f9c84),_0x225576=!![]);}if(!_0x3951eb)_0x5d6cc3['push'](_0x35e572(0x361)+_0x5d1d02[_0x35e572(0x2bc)]);if(!_0x225576)_0x5d6cc3[_0x35e572(0x1f6)](_0x35e572(0x319)+JSON[_0x35e572(0x302)](_0x3f9c84));fs_1['default'][_0x35e572(0x38d)](_0x46aee5,_0x5d6cc3['join']('\x0a'),_0x35e572(0x31c));}return console[_0x35e572(0x240)](_0x35e572(0x26c)),console[_0x35e572(0x240)]('ðŸ”‘\x20Generated\x20'+_0x5ead3a['length']+_0x35e572(0x334)),{'secret':_0x5d1d02[_0x35e572(0x2bc)],'qrCode':_0xbccdf6,'manualEntryKey':_0x5d1d02[_0x35e572(0x2bc)],'backupCodes':_0x5ead3a};}async[a48_0x230d10(0x275)](_0xa23ca){const _0x41b566=a48_0x230d10;if(!config_1['config']['admin']['twoFactorSecret'])throw new Error(_0x41b566(0x310));if(config_1[_0x41b566(0x1f8)]['admin'][_0x41b566(0x227)])throw new Error(_0x41b566(0x383));const _0x1b4c9e=speakeasy_1['default'][_0x41b566(0x2e4)][_0x41b566(0x391)]({'secret':config_1['config']['admin'][_0x41b566(0x292)],'encoding':'base32','token':_0xa23ca,'window':0x2});if(!_0x1b4c9e)throw new Error(_0x41b566(0x1f7));config_1['config'][_0x41b566(0x2fa)][_0x41b566(0x227)]=!![];const _0x893575=path_1[_0x41b566(0x1da)][_0x41b566(0x377)](process[_0x41b566(0x2b6)](),_0x41b566(0x204));if(fs_1[_0x41b566(0x1da)][_0x41b566(0x20f)](_0x893575)){let _0x34506f=fs_1[_0x41b566(0x1da)][_0x41b566(0x322)](_0x893575,'utf8');const _0x153bc2=_0x34506f[_0x41b566(0x231)]('\x0a');let _0x245147=![];for(let _0x5d20ef=0x0;_0x5d20ef<_0x153bc2['length'];_0x5d20ef++){if(_0x153bc2[_0x5d20ef]['startsWith'](_0x41b566(0x264))){_0x153bc2[_0x5d20ef]=_0x41b566(0x324),_0x245147=!![];break;}}if(!_0x245147)_0x153bc2['push']('ADMIN_2FA_ENABLED=true');fs_1[_0x41b566(0x1da)][_0x41b566(0x38d)](_0x893575,_0x153bc2[_0x41b566(0x377)]('\x0a'),_0x41b566(0x31c));}return console['log'](_0x41b566(0x325)),{'enabled':!![]};}async[a48_0x230d10(0x374)](){const _0x37fe78=a48_0x230d10;config_1[_0x37fe78(0x1f8)]['admin'][_0x37fe78(0x227)]=![],config_1['config'][_0x37fe78(0x2fa)]['twoFactorSecret']='',config_1[_0x37fe78(0x1f8)][_0x37fe78(0x2fa)][_0x37fe78(0x387)]='';const _0x1a82ef=path_1[_0x37fe78(0x1da)][_0x37fe78(0x377)](process[_0x37fe78(0x2b6)](),_0x37fe78(0x204));if(fs_1[_0x37fe78(0x1da)][_0x37fe78(0x20f)](_0x1a82ef)){let _0x236934=fs_1[_0x37fe78(0x1da)]['readFileSync'](_0x1a82ef,'utf8');const _0x5e033b=_0x236934[_0x37fe78(0x231)]('\x0a');for(let _0x4acb1a=0x0;_0x4acb1a<_0x5e033b[_0x37fe78(0x20b)];_0x4acb1a++){_0x5e033b[_0x4acb1a][_0x37fe78(0x2a1)](_0x37fe78(0x264))&&(_0x5e033b[_0x4acb1a]=_0x37fe78(0x2d0)),_0x5e033b[_0x4acb1a]['startsWith']('ADMIN_2FA_SECRET=')&&(_0x5e033b[_0x4acb1a]=_0x37fe78(0x361)),_0x5e033b[_0x4acb1a][_0x37fe78(0x2a1)](_0x37fe78(0x319))&&(_0x5e033b[_0x4acb1a]=_0x37fe78(0x319));}fs_1[_0x37fe78(0x1da)][_0x37fe78(0x38d)](_0x1a82ef,_0x5e033b[_0x37fe78(0x377)]('\x0a'),'utf8');}console[_0x37fe78(0x240)](_0x37fe78(0x205));}['generateDailyStatistics'](_0x1da1fb,_0x4ab1fb,_0x375974){const _0x1ebbd1=a48_0x230d10,_0x149bf3=new Map(),_0xde168c=new Date(_0x4ab1fb);while(_0xde168c<=_0x375974){const _0x4a1835=_0xde168c[_0x1ebbd1(0x27c)]()[_0x1ebbd1(0x231)]('T')[0x0];_0x149bf3[_0x1ebbd1(0x2b3)](_0x4a1835,{'revenue':0x0,'count':0x0}),_0xde168c[_0x1ebbd1(0x2fb)](_0xde168c[_0x1ebbd1(0x228)]()+0x1);}for(const _0x351260 of _0x1da1fb){const _0x57c215=_0x351260[_0x1ebbd1(0x206)][_0x1ebbd1(0x27c)]()[_0x1ebbd1(0x231)]('T')[0x0],_0x532070=_0x149bf3[_0x1ebbd1(0x2a0)](_0x57c215);_0x532070&&(_0x532070[_0x1ebbd1(0x2ea)]+=0x1,_0x351260[_0x1ebbd1(0x202)]===_0x1ebbd1(0x2aa)&&(_0x351260['amountUSDT']?_0x532070[_0x1ebbd1(0x276)]+=_0x351260[_0x1ebbd1(0x259)]:console[_0x1ebbd1(0x240)](_0x1ebbd1(0x2f9)+_0x351260['id']+_0x1ebbd1(0x2f4))));}const _0xca264b=[],_0xd22c2e=[];for(const [_0x841424,_0x5d8483]of _0x149bf3){_0xca264b[_0x1ebbd1(0x1f6)]({'date':_0x841424,'amount':Math[_0x1ebbd1(0x2fe)](_0x5d8483[_0x1ebbd1(0x276)]*0x64)/0x64}),_0xd22c2e[_0x1ebbd1(0x1f6)]({'date':_0x841424,'count':_0x5d8483[_0x1ebbd1(0x2ea)]});}return{'dailyRevenue':_0xca264b,'dailyPayments':_0xd22c2e};}}exports[a48_0x230d10(0x34e)]=AdminService;