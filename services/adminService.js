'use strict';const a40_0x1f4f38=a40_0x354d;function a40_0x4ebd(){const _0x197086=['chargebackAmount','toFixed','2196432nxoiWP','statusChangedBy','generateDailyStatistics','\x20\x20\x20Merchant\x20gets:\x20','currency','\x20USDT\x20from\x20balance','\x20USDT,\x20Difference:\x20','\x27\x20(from\x20\x27','week','📊\x20Calculated\x20commission\x20rate\x20for\x20payment\x20','pk_','averageCheckUSDT','getMerchantStatistics','📅\x20Period:\x20','klyme_eu','paidOutUSDT','Insufficient\x20balance.\x20Available:\x20','\x20active\x20merchants\x20for\x20selection','📊\x20Available\x20gateways\x20in\x20database:','🔍\x20Using\x20gateway\x20\x27','\x20has\x20zero\x20or\x20null\x20amountUSDT,\x20skipping...','Payment\x20not\x20found','\x20\x20\x20Full\x20amount:\x20','txid','CHARGEBACK','aggregate','15759927EwZDae','8wKRBhO','name','count','join','hex','admin','payment','findMany','\x20USDT,\x20Requested:\x20','round','delete','\x20USDT\x20(gross\x20revenue)','getGatewayDisplayName','balance','4IMpmva','merchantUrl','878310DnQaNU','custom','whiteUrl','values','90d','amountAfterGatewayCommissionUSDT','createdAt','toISOString','\x27\x20to\x20name\x20\x27','log',']\x20Gateway\x20settings\x20before\x20saving:','\x20USDT\x20(theoretical\x20net)','customerIp','\x20\x20\x20Current\x20balance:\x20','push','📊\x20Getting\x20merchants\x20awaiting\x20payout\x20with\x20filters:','convertToUSDT','periodFrom','../config/database','asc','1262382STlvdO','usdcPolygonWallet','payout','📊\x20Getting\x20payments\x20with\x20filters:','📊\x20Merchant\x20statistics\x20calculated:','💰\x20Found\x20','all','username','\x20\x20\x20✅\x20Actual\x20available\x20balance:\x20','commissionUSDT','dateFrom','period','\x20\x20\x20📅\x20This\x20month:\x20','mastercard','network','failureMessage','adminNotes','cointopay2','substr','\x20USDT','MasterCard','\x20\x20\x20Difference:\x20','usdtPolygonWallet','\x27\x20->\x20ID\x20\x27','\x20\x20\x20🤔\x20Difference:\x20','🔄\x20Gateway\x20mapping\x20(create):','date','set',',\x20successful:\x20','Rapyd','\x20\x20\x20🏪\x20Gateway\x20earnings:\x20','trim','💱\x20Currency\x20filter\x20applied:\x20','setDate','amount','📊\x20Sorting\x20payments\x20by\x20','reduce','🎯\x20updateUser\x20called\x20with\x20ID:\x20','desc','PENDING','📊\x20Total\x20payments\x20(including\x20failed):\x20','ceil',',\x20userId:\x20','createPayout','Error\x20parsing\x20gateway\x20settings\x20for\x20payment\x20','toLowerCase','\x20merchants\x20with\x20positive\x20balance','✅\x20Balance\x20check\x20passed\x20(with\x20tolerance)','\x27)\x20not\x20found\x20in\x20database,\x20returning\x20empty\x20result','amountAfterCommissionUSDT','paymentsCount','getUserById','default','error','updateCustomerData','\x20USDT\x20(-','updatePaymentStatus','getTime','getMonth','\x20\x20\x20💰\x20Total\x20payments\x20turnover:\x20','⚠️\x20Payment\x20','\x20balance\x20updated:\x20','polygon_usdc','updateUser','📊\x20[ADMIN]\x20Calculating\x20commission\x20manually\x20for\x20payment\x20','\x20USDT\x20(','\x27\x20not\x20found.\x20Available\x20gateways:\x20','\x20\x20\x20⏳\x20Pending\x20payout:\x20','🔄\x20Admin\x20updating\x20payment\x20','totalPayout','\x20\x20\x20💸\x20Total\x20payouts:\x20','klyme_gb','⚠️\x20Gateway\x20\x27','\x20balance\x20updated:','ACTIVE','toString','2020-01-01','customerCountry','\x20\x20\x20💰\x20Total\x20payout:\x20','usdtTrcWallet','\x20USDT\x20(same\x20as\x20awaiting)','setHours','Noda','\x20\x20\x20✅\x20Total\x20available\x20for\x20payout:\x20','random','parse','getGatewayInternalName','polygon','AdminService','⚠️\x20CHARGEBACK\x20without\x20penalty\x20amount\x20-\x20no\x20balance\x20change','entries','Shop\x20not\x20found','dailyPayments','gatewayOrderId','\x20\x20\x20Tolerance:\x20','test_gateway','Telegram\x20username\x20already\x20exists','%\x20from\x20','_sum','min','💰\x20[PAYOUT]\x20Gateway\x20','usdtErcWallet','dateTo','update','findUnique','💰\x20Payment\x20','suspendUser','\x20\x20\x20Current\x20total\x20paid\x20out:\x20','getFullYear','\x20\x20\x20Transaction\x20hash:\x20','Plisio','🔄\x20Converted\x20gateway\x20ID\x20\x27','hash','\x20\x20\x20Available\x20(number):\x20','paidAt','availableBalance','\x20\x20\x20Total\x20paid\x20out:\x20','📊\x20Using\x20saved\x20commission\x20rate\x20for\x20payment\x20','statusChangedAt','forEach','yesterday','customerUa','../types/gateway','publicKey','\x20USDT\x20(total\x20paid\x20to\x20merchants)','\x20missing\x20amountUSDT,\x20using\x20fallback\x20conversion','shopId','\x20\x20\x20Balance:\x20','\x20PAID\x20payments','💸\x20CHARGEBACK:\x20Processing\x20penalty-only\x20deduction','day','dailyRevenue','1637420AvJrVM','gateways','includes','✅\x20Using\x20gateway\x20filter:\x20\x27','insensitive','\x20\x20\x20�\x20Total\x20paid\x20out:\x20','💰\x20Current\x20shop\x20balance:\x20','\x20->\x20','amountUSDT','customerEmail','PAID','shopUrl','\x20\x20\x20💸\x20Total\x20payouts\x20(all\x20time):\x20','shop','map','defineProperty','rapyd','randomBytes','🔍\x20Balance\x20check\x20details:','\x20\x20\x20🌐\x20IP:\x20','\x20in\x20','paymentGateways','pendingPayout','merchantEarnings','\x20\x20\x20Added\x20to\x20balance:\x20+','getSystemStatistics','\x20USDT\x20(actual\x20balances)','💰\x20Shop\x20','COMPLETED','merchantEarningsUSDT','Username\x20already\x20exists','getDate','__importDefault','stringify','\x20\x20\x20Payout\x20amount:\x20','lte','💰\x20Creating\x20payout\x20for\x20shop\x20','deleteUser','NONEXISTENT_GATEWAY_FILTER','\x20payments)','\x20USDT)','✅\x20Customer\x20data\x20updated\x20for\x20payment\x20','plisio','%\x20commission)','30d','\x20\x20\x20🖥️\x20User\x20Agent:\x20','updatedAt','\x20paid\x20payments\x20for\x20analysis','\x20USDT,\x20merchant:\x20','📋\x20Getting\x20merchants\x20selection\x20list...','notes','\x20USDT\x20(after\x20','customerName','KLYME\x20DE','fullName','totalPaidOut','groupBy','activateUser','📊\x20Using\x20saved\x20values\x20for\x20payment\x20','299242XTpLkJ','create','gte','📊\x20Calculating\x20commission\x20manually\x20for\x20payment\x20','currencyService','turnoverUSDT','📊\x20Final\x20WHERE\x20conditions:','successUrl','📊\x20Merchants\x20awaiting\x20payout:\x20','status','toUpperCase','totalPayments','getPaymentById','\x20for\x20shop\x20','🔐\x20[','\x20\x20\x20👤\x20Merchant\x20earnings:\x20','awaitingPayout','password','some','revenue','commission','\x20\x20\x20Gateway:\x20','gatewayEarnings','\x20USDT\x20(already\x20paid\x20out)','CoinToPay','get','averageCommissionRate','✅\x20Payout\x20created:\x20','\x20USDT\x20(sum\x20of\x20all\x20merchant\x20balances)','./currencyService','\x20USDT\x20(current\x20balance\x20in\x20DB)','Test\x20Gateway','Error\x20parsing\x20gateway\x20settings\x20for\x20shop\x20','bcryptjs','pendingUrl','totalCommissionRate','💳\x20Payout\x20wallet\x20for\x20','\x20\x20\x20Final\x20payout\x20amount\x20used:\x20','getGatewayNameById','telegramId','findFirst','🔄\x20Gateway\x20mapping\x20(get):','gateway','year','length',']\x20Updating\x20password\x20for\x20user\x20',',\x20Commission:\x20','💸\x20CHARGEBACK\x20penalty\x20ONLY:\x20-','wallets','getAllUsers','orderId','⚠️\x20Requested\x20gateway\x20\x27','telegram','39860vIDveL','erc20_usdc','🔄\x20Converted\x20gateway\x20name\x20\x27','\x20\x20\x20📅\x20Total\x20payouts\x20(this\x20month):\x20','split','0000','gatewayCommissionRate','\x20USDT\x20for\x20payment\x20','$transaction','💰\x20Payment\x20amount\x20is\x20NOT\x20deducted\x20(chargeback\x20penalty\x20only)','\x20\x20\x20Requested\x20(number):\x20','gatewaySettings','getPayoutById','💰\x20[PAYOUT]\x20Merchant\x20','crypto','getGatewayIdByName','usdcErcWallet','\x20to\x20','periodTo'];a40_0x4ebd=function(){return _0x197086;};return a40_0x4ebd();}(function(_0x588879,_0x3f8d10){const _0x375ad2=a40_0x354d,_0x467166=_0x588879();while(!![]){try{const _0x2c29c3=-parseInt(_0x375ad2(0x19d))/0x1+parseInt(_0x375ad2(0x1d2))/0x2+-parseInt(_0x375ad2(0xde))/0x3+-parseInt(_0x375ad2(0xc8))/0x4*(parseInt(_0x375ad2(0x162))/0x5)+-parseInt(_0x375ad2(0xca))/0x6+-parseInt(_0x375ad2(0x9f))/0x7*(parseInt(_0x375ad2(0xba))/0x8)+parseInt(_0x375ad2(0xb9))/0x9;if(_0x2c29c3===_0x3f8d10)break;else _0x467166['push'](_0x467166['shift']());}catch(_0xcce6b3){_0x467166['push'](_0x467166['shift']());}}}(a40_0x4ebd,0x404b8));function a40_0x354d(_0x5babf3,_0x2b77d1){const _0x4ebdd3=a40_0x4ebd();return a40_0x354d=function(_0x354de2,_0x166d8f){_0x354de2=_0x354de2-0x9b;let _0x4c577c=_0x4ebdd3[_0x354de2];return _0x4c577c;},a40_0x354d(_0x5babf3,_0x2b77d1);}var __importDefault=this&&this[a40_0x1f4f38(0x182)]||function(_0x58cd59){return _0x58cd59&&_0x58cd59['__esModule']?_0x58cd59:{'default':_0x58cd59};};Object[a40_0x1f4f38(0x171)](exports,'__esModule',{'value':!![]}),exports['AdminService']=void 0x0;const database_1=__importDefault(require(a40_0x1f4f38(0xdc))),bcryptjs_1=__importDefault(require(a40_0x1f4f38(0x1be))),crypto_1=__importDefault(require(a40_0x1f4f38(0x1e0))),currencyService_1=require(a40_0x1f4f38(0x1ba)),gateway_1=require(a40_0x1f4f38(0x158));class AdminService{async['getPayoutStats'](){const _0x19b91a=a40_0x1f4f38;console['log']('📊\x20Calculating\x20payout\x20statistics...');const _0x4c7ac9=await database_1[_0x19b91a(0x112)][_0x19b91a(0x16f)][_0x19b91a(0xb8)]({'_sum':{'balance':!![],'totalPaidOut':!![]},'where':{'status':'ACTIVE'}}),_0x16ae73=await database_1[_0x19b91a(0x112)][_0x19b91a(0xc0)][_0x19b91a(0xbc)]({'where':{'status':_0x19b91a(0x16c),'gateway':{'not':_0x19b91a(0x13d)}}}),_0x5a80f2=new Date(),_0x3543a0=new Date(_0x5a80f2[_0x19b91a(0x14a)](),_0x5a80f2[_0x19b91a(0x118)](),0x1),_0x35eb5e=new Date(_0x5a80f2[_0x19b91a(0x14a)](),_0x5a80f2['getMonth']()+0x1,0x0,0x17,0x3b,0x3b,0x3e7),_0x579414=await database_1[_0x19b91a(0x112)][_0x19b91a(0xe0)]['aggregate']({'_sum':{'amount':!![]},'where':{'createdAt':{'gte':_0x3543a0,'lte':_0x35eb5e},'status':_0x19b91a(0x17e)}}),_0x582a8d=_0x4c7ac9[_0x19b91a(0x140)][_0x19b91a(0x199)]||0x0,_0x3f6e94=_0x4c7ac9[_0x19b91a(0x140)][_0x19b91a(0xc7)]||0x0,_0x2a97fb=_0x579414['_sum'][_0x19b91a(0x100)]||0x0,_0x3801ef={'totalPayout':Math[_0x19b91a(0xc3)](_0x582a8d*0x64)/0x64,'awaitingPayout':Math['round'](_0x3f6e94*0x64)/0x64,'thisMonth':Math[_0x19b91a(0xc3)](_0x2a97fb*0x64)/0x64,'availableBalance':Math[_0x19b91a(0xc3)](_0x3f6e94*0x64)/0x64,'totalPayments':_0x16ae73};return console[_0x19b91a(0xd3)]('📊\x20Payout\x20statistics\x20calculated:'),console['log'](_0x19b91a(0x12c)+_0x3801ef[_0x19b91a(0x123)]+_0x19b91a(0x15a)),console[_0x19b91a(0xd3)]('\x20\x20\x20⏳\x20Awaiting\x20payout:\x20'+_0x3801ef[_0x19b91a(0x1ad)]+_0x19b91a(0x1b9)),console[_0x19b91a(0xd3)]('\x20\x20\x20💵\x20Available\x20balance:\x20'+_0x3801ef[_0x19b91a(0x151)]+_0x19b91a(0x12e)),console['log'](_0x19b91a(0xea)+_0x3801ef['thisMonth']+_0x19b91a(0xf1)),console[_0x19b91a(0xd3)]('\x20\x20\x20💳\x20Total\x20payments:\x20'+_0x3801ef[_0x19b91a(0x1a8)]+_0x19b91a(0x15e)),_0x3801ef;}async[a40_0x1f4f38(0x114)](_0x4eb744,_0x3c3909){const _0x91f2bd=a40_0x1f4f38;console[_0x91f2bd(0xd3)]('🔄\x20Updating\x20customer\x20data\x20for\x20payment\x20'+_0x4eb744+':',_0x3c3909);const _0x230e20=await database_1['default'][_0x91f2bd(0xc0)][_0x91f2bd(0x146)]({'where':{'id':_0x4eb744},'select':{'id':!![],'customerEmail':!![],'customerName':!![],'customerCountry':!![],'customerIp':!![],'customerUa':!![]}});if(!_0x230e20)throw new Error('Payment\x20not\x20found');const _0x28aa70={};_0x3c3909[_0x91f2bd(0x12b)]!==undefined&&(_0x28aa70[_0x91f2bd(0x12b)]=_0x3c3909[_0x91f2bd(0x12b)]||null);_0x3c3909['customerIp']!==undefined&&(_0x28aa70[_0x91f2bd(0xd6)]=_0x3c3909[_0x91f2bd(0xd6)]||null);_0x3c3909[_0x91f2bd(0x157)]!==undefined&&(_0x28aa70[_0x91f2bd(0x157)]=_0x3c3909['customerUa']||null);const _0x2512ea=await database_1[_0x91f2bd(0x112)][_0x91f2bd(0xc0)][_0x91f2bd(0x145)]({'where':{'id':_0x4eb744},'data':{..._0x28aa70,'updatedAt':new Date()},'select':{'id':!![],'customerEmail':!![],'customerName':!![],'customerCountry':!![],'customerIp':!![],'customerUa':!![],'updatedAt':!![]}});return console[_0x91f2bd(0xd3)](_0x91f2bd(0x18b)+_0x4eb744),console[_0x91f2bd(0xd3)]('\x20\x20\x20🌍\x20Country:\x20'+_0x230e20[_0x91f2bd(0x12b)]+_0x91f2bd(0x169)+_0x2512ea[_0x91f2bd(0x12b)]),console['log'](_0x91f2bd(0x175)+_0x230e20[_0x91f2bd(0xd6)]+'\x20->\x20'+_0x2512ea[_0x91f2bd(0xd6)]),console[_0x91f2bd(0xd3)](_0x91f2bd(0x18f)+(_0x230e20[_0x91f2bd(0x157)]?_0x91f2bd(0xf9):'not\x20set')+_0x91f2bd(0x169)+(_0x2512ea[_0x91f2bd(0x157)]?'set':'not\x20set')),_0x2512ea;}async[a40_0x1f4f38(0x17b)](_0x21d1f7){const _0x379379=a40_0x1f4f38,_0x584284=new Date();let _0x558b3c;switch(_0x21d1f7[_0x379379(0x10b)]()){case _0x379379(0x160):_0x558b3c=new Date(_0x584284[_0x379379(0x14a)](),_0x584284[_0x379379(0x118)](),_0x584284[_0x379379(0x181)](),0x0,0x0,0x0,0x0);break;case _0x379379(0x156):const _0xdcdcc2=new Date(_0x584284);_0xdcdcc2[_0x379379(0xff)](_0xdcdcc2[_0x379379(0x181)]()-0x1),_0x558b3c=new Date(_0xdcdcc2[_0x379379(0x14a)](),_0xdcdcc2[_0x379379(0x118)](),_0xdcdcc2[_0x379379(0x181)](),0x0,0x0,0x0,0x0);break;case'7d':_0x558b3c=new Date(_0x584284[_0x379379(0x117)]()-0x7*0x18*0x3c*0x3c*0x3e8);break;case _0x379379(0x18e):_0x558b3c=new Date(_0x584284[_0x379379(0x117)]()-0x1e*0x18*0x3c*0x3c*0x3e8);break;case _0x379379(0xce):_0x558b3c=new Date(_0x584284[_0x379379(0x117)]()-0x5a*0x18*0x3c*0x3c*0x3e8);break;case _0x379379(0xe4):const _0x1ed246=await database_1[_0x379379(0x112)][_0x379379(0xc0)][_0x379379(0x1c5)]({'where':{'gateway':{'not':_0x379379(0x13d)}},'orderBy':{'createdAt':_0x379379(0xdd)},'select':{'createdAt':!![]}});_0x558b3c=_0x1ed246?_0x1ed246[_0x379379(0xd0)]:new Date(_0x379379(0x12a));break;default:_0x558b3c=new Date(_0x584284['getTime']()-0x1e*0x18*0x3c*0x3c*0x3e8);}_0x558b3c[_0x379379(0x12f)](0x0,0x0,0x0,0x0);let _0x1ca2f8;if(_0x21d1f7[_0x379379(0x10b)]()===_0x379379(0x156)){const _0x563211=new Date(_0x584284);_0x563211[_0x379379(0xff)](_0x563211[_0x379379(0x181)]()-0x1),_0x1ca2f8=new Date(_0x563211[_0x379379(0x14a)](),_0x563211['getMonth'](),_0x563211[_0x379379(0x181)](),0x17,0x3b,0x3b,0x3e7);}const _0x773115={'gte':_0x558b3c};_0x1ca2f8&&(_0x773115[_0x379379(0x185)]=_0x1ca2f8);const [_0x157d73,_0x3dfe54,_0x1df982,_0x11e06d,_0x6bafe8,_0x204e3c]=await Promise[_0x379379(0xe4)]([database_1[_0x379379(0x112)][_0x379379(0x16f)]['count'](),database_1[_0x379379(0x112)][_0x379379(0x16f)][_0x379379(0xbc)]({'where':{'status':'ACTIVE'}}),database_1[_0x379379(0x112)][_0x379379(0xc0)]['count']({'where':{'status':_0x379379(0x16c),'createdAt':_0x773115,'gateway':{'not':_0x379379(0x13d)}}}),database_1[_0x379379(0x112)][_0x379379(0xc0)][_0x379379(0xc1)]({'where':{'status':_0x379379(0x16c),'createdAt':_0x773115,'gateway':{'not':_0x379379(0x13d)}},'select':{'amount':!![],'currency':!![],'amountAfterGatewayCommissionUSDT':!![]}}),database_1[_0x379379(0x112)]['payment'][_0x379379(0xc1)]({'where':{'gateway':{'not':_0x379379(0x13d)}},'take':0xa,'orderBy':{'createdAt':_0x379379(0x104)},'include':{'shop':{'select':{'name':!![],'username':!![]}}}}),database_1[_0x379379(0x112)][_0x379379(0xc0)][_0x379379(0xc1)]({'where':{'createdAt':_0x773115,'gateway':{'not':_0x379379(0x13d)}},'select':{'amount':!![],'currency':!![],'status':!![],'amountUSDT':!![],'createdAt':!![]}})]);let _0x183436=0x0,_0x3b88a6=0x0;for(const _0x5ca421 of _0x11e06d){const _0x5a1a56=await currencyService_1[_0x379379(0x1a1)][_0x379379(0xda)](_0x5ca421['amount'],_0x5ca421[_0x379379(0xa3)]);_0x183436+=_0x5a1a56;if(_0x5ca421['amountAfterGatewayCommissionUSDT']){const _0x3246ef=await currencyService_1[_0x379379(0x1a1)][_0x379379(0xda)](_0x5ca421[_0x379379(0x100)],_0x5ca421[_0x379379(0xa3)]),_0x4e6955=_0x5ca421[_0x379379(0xcf)],_0x359dfe=_0x3246ef-_0x4e6955;_0x3b88a6+=_0x359dfe;}}const _0x4968a3=_0x1df982>0x0?_0x183436/_0x1df982:0x0,_0x5f0ef7=this['generateDailyStatistics'](_0x204e3c,_0x558b3c,_0x1ca2f8||_0x584284),_0x3c84f8=await database_1[_0x379379(0x112)][_0x379379(0xc0)][_0x379379(0xbc)]({'where':{'createdAt':_0x773115,'gateway':{'not':_0x379379(0x13d)}}}),_0x362b9e=_0x3c84f8>0x0?_0x1df982/_0x3c84f8*0x64:0x0;return{'totalShops':_0x157d73,'activeShops':_0x3dfe54,'totalPayments':_0x1df982,'successfulPayments':_0x1df982,'totalAttempts':_0x3c84f8,'totalRevenue':Math['round'](_0x183436*0x64)/0x64,'trapayEarnings':Math['round'](_0x3b88a6*0x64)/0x64,'averagePaymentAmount':Math[_0x379379(0xc3)](_0x4968a3*0x64)/0x64,'conversionRate':Math[_0x379379(0xc3)](_0x362b9e*0x64)/0x64,'dailyRevenue':_0x5f0ef7[_0x379379(0x161)],'dailyPayments':_0x5f0ef7[_0x379379(0x13a)],'recentPayments':_0x6bafe8[_0x379379(0x170)](_0x1d0d69=>({'id':_0x1d0d69['id'],'amount':_0x1d0d69[_0x379379(0x100)],'currency':_0x1d0d69['currency'],'status':_0x1d0d69[_0x379379(0x1a6)],'gateway':_0x1d0d69['gateway'],'shop':_0x1d0d69[_0x379379(0x16f)],'createdAt':_0x1d0d69['createdAt']}))};}async[a40_0x1f4f38(0xab)](_0x286a99){const _0x2b52df=a40_0x1f4f38;console[_0x2b52df(0xd3)]('📊\x20Getting\x20merchant\x20statistics\x20with\x20filters:',_0x286a99);let _0x2b79b7,_0xf885c3=new Date();if(_0x286a99['period']===_0x2b52df(0xcb)&&_0x286a99[_0x2b52df(0xe8)]&&_0x286a99['dateTo'])_0x2b79b7=new Date(_0x286a99[_0x2b52df(0xe8)]),_0xf885c3=new Date(_0x286a99[_0x2b52df(0x144)]),_0x2b79b7[_0x2b52df(0x12f)](0x0,0x0,0x0,0x0),_0xf885c3['setHours'](0x17,0x3b,0x3b,0x3e7);else{const _0x3cfbba=new Date();switch(_0x286a99[_0x2b52df(0xe9)]){case _0x2b52df(0xa7):_0x2b79b7=new Date(_0x3cfbba[_0x2b52df(0x117)]()-0x7*0x18*0x3c*0x3c*0x3e8);break;case'month':_0x2b79b7=new Date(_0x3cfbba['getTime']()-0x1e*0x18*0x3c*0x3c*0x3e8);break;case _0x2b52df(0x1c8):_0x2b79b7=new Date(_0x3cfbba[_0x2b52df(0x117)]()-0x16d*0x18*0x3c*0x3c*0x3e8);break;case _0x2b52df(0xe4):default:_0x2b79b7=new Date(_0x2b52df(0x12a));break;}_0x2b79b7[_0x2b52df(0x12f)](0x0,0x0,0x0,0x0),_0xf885c3[_0x2b52df(0x12f)](0x17,0x3b,0x3b,0x3e7);}console[_0x2b52df(0xd3)](_0x2b52df(0xac)+_0x2b79b7[_0x2b52df(0xd1)]()+_0x2b52df(0x9b)+_0xf885c3['toISOString']());const _0x224aaa={'status':_0x2b52df(0x16c),'gateway':{'not':'test_gateway'},'paidAt':{'gte':_0x2b79b7,'lte':_0xf885c3}};_0x286a99['shopId']&&(_0x224aaa['shopId']=_0x286a99[_0x2b52df(0x15c)]);const _0x310195=await database_1[_0x2b52df(0x112)]['payment'][_0x2b52df(0xc1)]({'where':_0x224aaa,'select':{'id':!![],'amount':!![],'currency':!![],'amountUSDT':!![],'amountAfterGatewayCommissionUSDT':!![],'gatewayCommissionRate':!![],'gateway':!![],'shopId':!![],'paidAt':!![],'shop':{'select':{'id':!![],'name':!![],'username':!![],'gatewaySettings':!![]}}}});console[_0x2b52df(0xd3)](_0x2b52df(0xe3)+_0x310195[_0x2b52df(0x1c9)]+_0x2b52df(0x191));const _0x3c36f5={'gateway':{'not':_0x2b52df(0x13d)},'createdAt':{'gte':_0x2b79b7,'lte':_0xf885c3}};_0x286a99[_0x2b52df(0x15c)]&&(_0x3c36f5[_0x2b52df(0x15c)]=_0x286a99[_0x2b52df(0x15c)]);const _0x211666=await database_1[_0x2b52df(0x112)][_0x2b52df(0xc0)][_0x2b52df(0xbc)]({'where':_0x3c36f5});console[_0x2b52df(0xd3)](_0x2b52df(0x106)+_0x211666+_0x2b52df(0xfa)+_0x310195[_0x2b52df(0x1c9)]);let _0x307db9=0x0,_0x24ba5a=0x0,_0x53926c=0x0;const _0x58c344={},_0x32bd7d={},_0x5b82b8={};for(const _0x3b7064 of _0x310195){try{const _0x383366=_0x3b7064['amountUSDT']||0x0;if(_0x383366<=0x0){console['warn'](_0x2b52df(0x11a)+_0x3b7064['id']+_0x2b52df(0xb3));continue;}let _0x212237,_0x58c46e;if(_0x3b7064[_0x2b52df(0xcf)]!==null&&_0x3b7064[_0x2b52df(0xcf)]!==undefined)_0x212237=_0x3b7064[_0x2b52df(0xcf)],_0x58c46e=_0x383366-_0x212237,console[_0x2b52df(0xd3)](_0x2b52df(0x19c)+_0x3b7064['id']+':\x20'+_0x383366['toFixed'](0x6)+_0x2b52df(0x192)+_0x212237[_0x2b52df(0x9e)](0x6)+_0x2b52df(0xf1));else{let _0x45e7a9={};if(_0x3b7064[_0x2b52df(0x16f)][_0x2b52df(0x1dd)])try{_0x45e7a9=JSON[_0x2b52df(0x133)](_0x3b7064[_0x2b52df(0x16f)][_0x2b52df(0x1dd)]);}catch(_0x2cef5f){console[_0x2b52df(0x113)](_0x2b52df(0x1bd)+_0x3b7064[_0x2b52df(0x15c)]+':',_0x2cef5f);}let _0x3313e4=0x2d;for(const [_0x335567,_0x3f4ae1]of Object['entries'](_0x45e7a9)){if(_0x335567[_0x2b52df(0x10b)]()===_0x3b7064[_0x2b52df(0x1c7)][_0x2b52df(0x10b)]()){_0x3313e4=_0x3f4ae1['commission']||0x2d;break;}}_0x58c46e=_0x383366*(_0x3313e4/0x64),_0x212237=_0x383366-_0x58c46e,console[_0x2b52df(0xd3)](_0x2b52df(0x1a0)+_0x3b7064['id']+':\x20'+_0x3313e4+_0x2b52df(0x13f)+_0x383366[_0x2b52df(0x9e)](0x6)+_0x2b52df(0xf1));}_0x307db9+=_0x383366,_0x24ba5a+=_0x212237,_0x53926c+=_0x58c46e;let _0xf5d848;_0x3b7064[_0x2b52df(0x1d8)]!==null&&_0x3b7064[_0x2b52df(0x1d8)]!==undefined?(_0xf5d848=_0x3b7064[_0x2b52df(0x1d8)],console[_0x2b52df(0xd3)](_0x2b52df(0x153)+_0x3b7064['id']+':\x20'+_0xf5d848+'%')):(_0xf5d848=_0x383366>0x0?_0x58c46e/_0x383366*0x64:0x0,console[_0x2b52df(0xd3)](_0x2b52df(0xa8)+_0x3b7064['id']+':\x20'+_0xf5d848['toFixed'](0x2)+'%'));!_0x58c344[_0x3b7064['gateway']]&&(_0x58c344[_0x3b7064[_0x2b52df(0x1c7)]]={'gateway':_0x3b7064[_0x2b52df(0x1c7)],'gatewayDisplayName':this[_0x2b52df(0xc6)](_0x3b7064[_0x2b52df(0x1c7)]),'paymentsCount':0x0,'turnoverUSDT':0x0,'commissionUSDT':0x0,'merchantEarningsUSDT':0x0,'totalCommissionRate':0x0});_0x58c344[_0x3b7064['gateway']][_0x2b52df(0x110)]++,_0x58c344[_0x3b7064['gateway']][_0x2b52df(0x1a2)]+=_0x383366,_0x58c344[_0x3b7064[_0x2b52df(0x1c7)]]['commissionUSDT']+=_0x58c46e,_0x58c344[_0x3b7064[_0x2b52df(0x1c7)]][_0x2b52df(0x17f)]+=_0x212237,_0x58c344[_0x3b7064[_0x2b52df(0x1c7)]][_0x2b52df(0x1c0)]+=_0xf5d848;!_0x286a99[_0x2b52df(0x15c)]&&(!_0x32bd7d[_0x3b7064['shopId']]&&(_0x32bd7d[_0x3b7064[_0x2b52df(0x15c)]]={'shopId':_0x3b7064[_0x2b52df(0x15c)],'shopName':_0x3b7064[_0x2b52df(0x16f)][_0x2b52df(0xbb)],'shopUsername':_0x3b7064['shop'][_0x2b52df(0xe5)],'paymentsCount':0x0,'turnoverUSDT':0x0,'commissionUSDT':0x0,'merchantEarningsUSDT':0x0,'paidOutUSDT':0x0,'averageCheckUSDT':0x0}),_0x32bd7d[_0x3b7064[_0x2b52df(0x15c)]]['paymentsCount']++,_0x32bd7d[_0x3b7064['shopId']][_0x2b52df(0x1a2)]+=_0x383366,_0x32bd7d[_0x3b7064[_0x2b52df(0x15c)]][_0x2b52df(0xe7)]+=_0x58c46e,_0x32bd7d[_0x3b7064[_0x2b52df(0x15c)]][_0x2b52df(0x17f)]+=_0x212237);const _0x4be490=_0x3b7064[_0x2b52df(0x150)][_0x2b52df(0xd1)]()[_0x2b52df(0x1d6)]('T')[0x0];!_0x5b82b8[_0x4be490]&&(_0x5b82b8[_0x4be490]={'date':_0x4be490,'turnover':0x0,'merchantEarnings':0x0,'gatewayEarnings':0x0,'paymentsCount':0x0}),_0x5b82b8[_0x4be490]['turnover']+=_0x383366,_0x5b82b8[_0x4be490][_0x2b52df(0x179)]+=_0x212237,_0x5b82b8[_0x4be490][_0x2b52df(0x1b3)]+=_0x58c46e,_0x5b82b8[_0x4be490]['paymentsCount']++;}catch(_0x36e7e4){console['error']('Error\x20processing\x20payment\x20'+_0x3b7064['id']+':',_0x36e7e4);}}Object[_0x2b52df(0xcd)](_0x58c344)[_0x2b52df(0x155)](_0x24403c=>{const _0x5b3964=_0x2b52df;_0x24403c['averageCommissionRate']=_0x24403c[_0x5b3964(0x110)]>0x0?_0x24403c['totalCommissionRate']/_0x24403c[_0x5b3964(0x110)]:0x0,delete _0x24403c[_0x5b3964(0x1c0)];}),Object['values'](_0x32bd7d)['forEach'](_0x58462c=>{const _0x13b968=_0x2b52df;_0x58462c['averageCheckUSDT']=_0x58462c[_0x13b968(0x110)]>0x0?_0x58462c[_0x13b968(0x1a2)]/_0x58462c[_0x13b968(0x110)]:0x0;});let _0x332f16=0x0,_0xb831f9=0x0;if(_0x286a99[_0x2b52df(0x15c)]){const _0x5b8cf9=await database_1[_0x2b52df(0x112)][_0x2b52df(0xe0)][_0x2b52df(0xc1)]({'where':{'shopId':_0x286a99[_0x2b52df(0x15c)],'status':_0x2b52df(0x17e),'createdAt':{'gte':_0x2b79b7,'lte':_0xf885c3}},'select':{'amount':!![]}});_0x332f16=_0x5b8cf9[_0x2b52df(0x102)]((_0x2443e3,_0x28f671)=>_0x2443e3+_0x28f671[_0x2b52df(0x100)],0x0);const _0x4de495=await database_1[_0x2b52df(0x112)][_0x2b52df(0xe0)][_0x2b52df(0xc1)]({'where':{'shopId':_0x286a99['shopId'],'status':_0x2b52df(0x105),'createdAt':{'gte':_0x2b79b7,'lte':_0xf885c3}},'select':{'amount':!![]}});_0xb831f9=_0x4de495[_0x2b52df(0x102)]((_0x4cb9e1,_0x5f272e)=>_0x4cb9e1+_0x5f272e[_0x2b52df(0x100)],0x0);}const _0x2eb498=_0x211666,_0x4300a4=_0x310195[_0x2b52df(0x1c9)],_0x38b21f=_0x4300a4>0x0?_0x307db9/_0x4300a4:0x0,_0x3ac37d=_0x2eb498>0x0?Math['round'](_0x4300a4/_0x2eb498*0x2710)/0x64:0x0,_0x5dbcc3=Math['ceil']((_0xf885c3['getTime']()-_0x2b79b7[_0x2b52df(0x117)]())/(0x3e8*0x3c*0x3c*0x18)),_0x2f2751={'totalTurnover':Math['round'](_0x307db9*0x64)/0x64,'merchantEarnings':Math[_0x2b52df(0xc3)](_0x24ba5a*0x64)/0x64,'gatewayEarnings':Math['round'](_0x53926c*0x64)/0x64,'totalPaidOut':Math[_0x2b52df(0xc3)](_0x332f16*0x64)/0x64,'pendingPayout':Math['round'](_0xb831f9*0x64)/0x64,'averageCheck':Math[_0x2b52df(0xc3)](_0x38b21f*0x64)/0x64,'totalPayments':_0x2eb498,'successfulPayments':_0x4300a4,'conversionRate':_0x3ac37d,'gatewayBreakdown':Object[_0x2b52df(0xcd)](_0x58c344)[_0x2b52df(0x170)](_0x41fda4=>({..._0x41fda4,'turnoverUSDT':Math[_0x2b52df(0xc3)](_0x41fda4[_0x2b52df(0x1a2)]*0x64)/0x64,'commissionUSDT':Math[_0x2b52df(0xc3)](_0x41fda4[_0x2b52df(0xe7)]*0x64)/0x64,'merchantEarningsUSDT':Math[_0x2b52df(0xc3)](_0x41fda4[_0x2b52df(0x17f)]*0x64)/0x64,'averageCommissionRate':Math[_0x2b52df(0xc3)](_0x41fda4[_0x2b52df(0x1b7)]*0x64)/0x64})),'merchantBreakdown':_0x286a99[_0x2b52df(0x15c)]?undefined:Object[_0x2b52df(0xcd)](_0x32bd7d)[_0x2b52df(0x170)](_0x26ccb5=>({..._0x26ccb5,'turnoverUSDT':Math[_0x2b52df(0xc3)](_0x26ccb5[_0x2b52df(0x1a2)]*0x64)/0x64,'commissionUSDT':Math[_0x2b52df(0xc3)](_0x26ccb5[_0x2b52df(0xe7)]*0x64)/0x64,'merchantEarningsUSDT':Math[_0x2b52df(0xc3)](_0x26ccb5[_0x2b52df(0x17f)]*0x64)/0x64,'paidOutUSDT':Math['round'](_0x26ccb5[_0x2b52df(0xae)]*0x64)/0x64,'averageCheckUSDT':Math[_0x2b52df(0xc3)](_0x26ccb5[_0x2b52df(0xaa)]*0x64)/0x64})),'dailyData':Object[_0x2b52df(0xcd)](_0x5b82b8)[_0x2b52df(0x170)](_0x3a3ce2=>({..._0x3a3ce2,'turnover':Math['round'](_0x3a3ce2['turnover']*0x64)/0x64,'merchantEarnings':Math[_0x2b52df(0xc3)](_0x3a3ce2['merchantEarnings']*0x64)/0x64,'gatewayEarnings':Math['round'](_0x3a3ce2[_0x2b52df(0x1b3)]*0x64)/0x64}))['sort']((_0x11278e,_0x988c76)=>_0x11278e['date']['localeCompare'](_0x988c76[_0x2b52df(0xf8)])),'periodInfo':{'from':_0x2b79b7,'to':_0xf885c3,'periodType':_0x286a99[_0x2b52df(0xe9)]||_0x2b52df(0xcb),'daysCount':_0x5dbcc3}};return console[_0x2b52df(0xd3)](_0x2b52df(0xe2)),console[_0x2b52df(0xd3)]('\x20\x20\x20💰\x20Total\x20turnover:\x20'+_0x2f2751['totalTurnover']+_0x2b52df(0xf1)),console[_0x2b52df(0xd3)](_0x2b52df(0x1ac)+_0x2f2751['merchantEarnings']+_0x2b52df(0xf1)),console[_0x2b52df(0xd3)](_0x2b52df(0xfc)+_0x2f2751['gatewayEarnings']+'\x20USDT'),console['log'](_0x2b52df(0x167)+_0x2f2751[_0x2b52df(0x199)]+_0x2b52df(0xf1)),console['log'](_0x2b52df(0x121)+_0x2f2751[_0x2b52df(0x178)]+_0x2b52df(0xf1)),console[_0x2b52df(0xd3)]('\x20\x20\x20�📊\x20Total\x20payments:\x20'+_0x2f2751[_0x2b52df(0x1a8)]),_0x2f2751;}async['getMerchantsSelection'](){const _0x1d0578=a40_0x1f4f38;console[_0x1d0578(0xd3)](_0x1d0578(0x193));const _0x14288d=await database_1[_0x1d0578(0x112)][_0x1d0578(0x16f)][_0x1d0578(0xc1)]({'where':{'status':_0x1d0578(0x128)},'select':{'id':!![],'username':!![],'name':!![]},'orderBy':{'name':_0x1d0578(0xdd)}});return console[_0x1d0578(0xd3)]('📋\x20Found\x20'+_0x14288d['length']+_0x1d0578(0xb0)),_0x14288d[_0x1d0578(0x170)](_0x505b0a=>({'id':_0x505b0a['id'],'username':_0x505b0a[_0x1d0578(0xe5)],'name':_0x505b0a[_0x1d0578(0xbb)]}));}[a40_0x1f4f38(0xc6)](_0x2b1377){const _0x1bb67e=a40_0x1f4f38,_0x8130e7={'test_gateway':_0x1bb67e(0x1bc),'plisio':_0x1bb67e(0x14c),'rapyd':_0x1bb67e(0xfb),'noda':_0x1bb67e(0x130),'cointopay':_0x1bb67e(0x1b5),'cointopay2':'Open\x20Banking\x202','klyme_eu':'KLYME\x20EU','klyme_gb':'KLYME\x20GB','klyme_de':_0x1bb67e(0x197),'mastercard':_0x1bb67e(0xf2)};return _0x8130e7[_0x2b1377]||_0x2b1377;}[a40_0x1f4f38(0x134)](_0x3e8d71){const _0x3766a8=a40_0x1f4f38,_0x50df5e={'Test\x20Gateway':_0x3766a8(0x13d),'Plisio':_0x3766a8(0x18c),'Rapyd':_0x3766a8(0x172),'Noda':'noda','CoinToPay':'cointopay','CoinToPay2':_0x3766a8(0xef),'KLYME\x20EU':_0x3766a8(0xad),'KLYME\x20GB':_0x3766a8(0x125),'KLYME\x20DE':'klyme_de','MasterCard':_0x3766a8(0xeb)};return _0x50df5e[_0x3e8d71]||_0x3e8d71[_0x3766a8(0x10b)]();}async['getMerchantsAwaitingPayout'](_0x2015e3){const _0x18db2a=a40_0x1f4f38,{page:_0x2d8450,limit:_0x4b08bf,minAmount:_0x48c537,search:_0x5c4d3e}=_0x2015e3,_0x5b983a=(_0x2d8450-0x1)*_0x4b08bf;console[_0x18db2a(0xd3)](_0x18db2a(0xd9),_0x2015e3);const _0x2fa244={'balance':{'gt':0x0},'status':_0x18db2a(0x128)};_0x48c537&&(_0x2fa244[_0x18db2a(0xc7)][_0x18db2a(0x19f)]=_0x48c537);_0x5c4d3e&&(_0x2fa244[_0x18db2a(0xbb)]={'contains':_0x5c4d3e,'mode':_0x18db2a(0x166)});const [_0x304316,_0x536585]=await Promise[_0x18db2a(0xe4)]([database_1[_0x18db2a(0x112)][_0x18db2a(0x16f)]['findMany']({'where':_0x2fa244,'skip':_0x5b983a,'take':_0x4b08bf,'orderBy':{'balance':_0x18db2a(0x104)},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'balance':!![],'totalPaidOut':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'usdcErcWallet':!![],'gatewaySettings':!![],'createdAt':!![]}}),database_1[_0x18db2a(0x112)][_0x18db2a(0x16f)]['count']({'where':_0x2fa244})]);console[_0x18db2a(0xd3)](_0x18db2a(0xe3)+_0x304316[_0x18db2a(0x1c9)]+_0x18db2a(0x10c));const _0x5c268f=await Promise[_0x18db2a(0xe4)](_0x304316[_0x18db2a(0x170)](async _0x11d8b0=>{const _0x44660d=_0x18db2a,[_0x31f70b,_0x40723e,_0x4a15a8]=await Promise[_0x44660d(0xe4)]([database_1[_0x44660d(0x112)][_0x44660d(0xc0)][_0x44660d(0xbc)]({'where':{'shopId':_0x11d8b0['id'],'status':_0x44660d(0x16c),'gateway':{'not':_0x44660d(0x13d)}}}),database_1['default'][_0x44660d(0xc0)][_0x44660d(0x1c5)]({'where':{'shopId':_0x11d8b0['id'],'status':_0x44660d(0x16c),'gateway':{'not':_0x44660d(0x13d)}},'orderBy':{'paidAt':_0x44660d(0xdd)},'select':{'paidAt':!![]}}),database_1['default'][_0x44660d(0xc0)]['groupBy']({'by':[_0x44660d(0x1c7)],'where':{'shopId':_0x11d8b0['id'],'status':_0x44660d(0x16c),'gateway':{'not':_0x44660d(0x13d)}},'_count':{'id':!![]},'_sum':{'amountUSDT':!![]}})]),_0x74c6c2=new Date(),_0xc095f=new Date(_0x74c6c2[_0x44660d(0x14a)](),_0x74c6c2[_0x44660d(0x118)](),0x1),_0x6be0e0=new Date(_0x74c6c2[_0x44660d(0x14a)](),_0x74c6c2[_0x44660d(0x118)]()+0x1,0x0,0x17,0x3b,0x3b,0x3e7),[_0x14a750,_0x2a05e6]=await Promise['all']([database_1[_0x44660d(0x112)][_0x44660d(0xe0)][_0x44660d(0xb8)]({'_sum':{'amount':!![]},'where':{'shopId':_0x11d8b0['id'],'status':_0x44660d(0x17e)}}),database_1[_0x44660d(0x112)][_0x44660d(0xe0)]['aggregate']({'_sum':{'amount':!![]},'where':{'shopId':_0x11d8b0['id'],'status':_0x44660d(0x17e),'createdAt':{'gte':_0xc095f,'lte':_0x6be0e0}}})]),_0x2c98ff=_0x14a750['_sum'][_0x44660d(0x100)]||0x0,_0x275985=_0x2a05e6[_0x44660d(0x140)][_0x44660d(0x100)]||0x0,_0xd708d1=await Promise[_0x44660d(0xe4)](_0x4a15a8['map'](async _0x52c4e2=>{const _0x933e8f=_0x44660d;let _0x332db6=0x2d;if(_0x11d8b0[_0x933e8f(0x1dd)])try{const _0x2f09d4=JSON[_0x933e8f(0x133)](_0x11d8b0[_0x933e8f(0x1dd)]);for(const [_0x2d5a69,_0x3013b9]of Object[_0x933e8f(0x138)](_0x2f09d4)){if(_0x2d5a69[_0x933e8f(0x10b)]()===_0x52c4e2[_0x933e8f(0x1c7)]['toLowerCase']()){_0x332db6=_0x3013b9[_0x933e8f(0x1b1)]||0xa,console[_0x933e8f(0xd3)](_0x933e8f(0x142)+_0x52c4e2['gateway']+_0x933e8f(0x1aa)+_0x11d8b0['id']+':\x20commission\x20=\x20'+_0x332db6+'%');break;}}}catch(_0x3ac47f){console[_0x933e8f(0x113)](_0x933e8f(0x1bd)+_0x11d8b0['id']+':',_0x3ac47f);}const _0x277bd3=_0x52c4e2[_0x933e8f(0x140)]?.[_0x933e8f(0x16a)]||0x0,_0x2c529f=_0x277bd3*(0x1-_0x332db6/0x64);return{'gateway':_0x52c4e2[_0x933e8f(0x1c7)],'count':_0x52c4e2['_count']?.['id']||0x0,'amountUSDT':Math['round'](_0x277bd3*0x64)/0x64,'amountAfterCommissionUSDT':Math[_0x933e8f(0xc3)](_0x2c529f*0x64)/0x64,'commission':_0x332db6};})),_0x213d3e=_0xd708d1[_0x44660d(0x102)]((_0x3f764f,_0x2ccbca)=>_0x3f764f+_0x2ccbca['amountUSDT'],0x0),_0x1de265=_0xd708d1['reduce']((_0x58b219,_0x2477af)=>_0x58b219+_0x2477af[_0x44660d(0x10f)],0x0),_0xfc7ef8=_0x11d8b0[_0x44660d(0xc7)];return console[_0x44660d(0xd3)](_0x44660d(0x1df)+_0x11d8b0[_0x44660d(0xe5)]+':'),console[_0x44660d(0xd3)]('\x20\x20\x20�\x20Total\x20payments\x20turnover:\x20'+_0x213d3e[_0x44660d(0x9e)](0x2)+_0x44660d(0xc5)),console[_0x44660d(0xd3)]('\x20\x20\x20🔍\x20Calculated\x20after\x20commission:\x20'+_0x1de265['toFixed'](0x2)+_0x44660d(0xd5)),console[_0x44660d(0xd3)](_0x44660d(0xe6)+_0xfc7ef8[_0x44660d(0x9e)](0x2)+_0x44660d(0x1bb)),console[_0x44660d(0xd3)](_0x44660d(0x124)+_0x2c98ff['toFixed'](0x2)+_0x44660d(0x1b4)),console[_0x44660d(0xd3)](_0x44660d(0xf6)+(_0x1de265-_0x2c98ff-_0xfc7ef8)['toFixed'](0x2)+'\x20USDT\x20(calculated\x20-\x20payouts\x20-\x20balance)'),{'id':_0x11d8b0['id'],'fullName':_0x11d8b0[_0x44660d(0xbb)],'username':_0x11d8b0[_0x44660d(0xe5)],'telegramId':_0x11d8b0[_0x44660d(0x1d1)],'merchantUrl':_0x11d8b0[_0x44660d(0x16d)],'wallets':{'usdtPolygonWallet':_0x11d8b0[_0x44660d(0xf4)],'usdtTrcWallet':_0x11d8b0[_0x44660d(0x12d)],'usdtErcWallet':_0x11d8b0[_0x44660d(0x143)],'usdcPolygonWallet':_0x11d8b0[_0x44660d(0xdf)],'usdcErcWallet':_0x11d8b0[_0x44660d(0x1e2)]},'totalAmountUSDT':Math[_0x44660d(0xc3)](_0x213d3e*0x64)/0x64,'totalAmountAfterCommissionUSDT':Math['round'](_0x1de265*0x64)/0x64,'currentBalance':Math['round'](_0xfc7ef8*0x64)/0x64,'totalPayout':Math[_0x44660d(0xc3)](_0x2c98ff*0x64)/0x64,'thisMonth':Math[_0x44660d(0xc3)](_0x275985*0x64)/0x64,'paymentsCount':_0x31f70b,'oldestPaymentDate':_0x40723e?.[_0x44660d(0x150)]||_0x11d8b0[_0x44660d(0xd0)],'gatewayBreakdown':_0xd708d1};})),_0x28fe01=_0x5c268f[_0x18db2a(0x102)]((_0x2b5214,_0x28e535)=>_0x2b5214+_0x28e535['totalAmountUSDT'],0x0),_0x2e0423=_0x5c268f['reduce']((_0x5285a4,_0x417e23)=>_0x5285a4+_0x417e23['totalAmountAfterCommissionUSDT'],0x0),_0x173bf0=_0x5c268f[_0x18db2a(0x102)]((_0x42960c,_0x33704d)=>_0x42960c+_0x33704d['totalPayout'],0x0),_0x1e6d05=_0x5c268f[_0x18db2a(0x102)]((_0x547722,_0x842d5b)=>_0x547722+_0x842d5b['thisMonth'],0x0);return console[_0x18db2a(0xd3)](_0x18db2a(0x1a5)+_0x536585+'\x20merchants'),console[_0x18db2a(0xd3)](_0x18db2a(0x119)+Math[_0x18db2a(0xc3)](_0x28fe01*0x64)/0x64+_0x18db2a(0xc5)),console['log'](_0x18db2a(0x131)+Math[_0x18db2a(0xc3)](_0x2e0423*0x64)/0x64+_0x18db2a(0x17c)),console[_0x18db2a(0xd3)](_0x18db2a(0x16e)+Math[_0x18db2a(0xc3)](_0x173bf0*0x64)/0x64+_0x18db2a(0xf1)),console[_0x18db2a(0xd3)](_0x18db2a(0x1d5)+Math['round'](_0x1e6d05*0x64)/0x64+'\x20USDT'),{'merchants':_0x5c268f,'pagination':{'page':_0x2d8450,'limit':_0x4b08bf,'total':_0x536585,'totalPages':Math[_0x18db2a(0x107)](_0x536585/_0x4b08bf)},'summary':{'totalMerchants':_0x536585,'totalAmountUSDT':Math[_0x18db2a(0xc3)](_0x28fe01*0x64)/0x64,'totalAmountAfterCommissionUSDT':Math[_0x18db2a(0xc3)](_0x2e0423*0x64)/0x64,'totalPayout':Math[_0x18db2a(0xc3)](_0x173bf0*0x64)/0x64,'thisMonth':Math['round'](_0x1e6d05*0x64)/0x64}};}async[a40_0x1f4f38(0x109)](_0x5afb39){const _0x46a318=a40_0x1f4f38,{shopId:_0x458398,amount:_0x3e587b,network:_0x2d34f5,wallet:_0x5a1905,notes:_0x8d1231,txid:_0x107cd6,periodFrom:_0x37a532,periodTo:_0xfc9320}=_0x5afb39,_0x405092=await database_1[_0x46a318(0x112)][_0x46a318(0x1da)](async _0x303da1=>{const _0x1c7d8c=_0x46a318,_0x5ebbeb=await _0x303da1[_0x1c7d8c(0x16f)][_0x1c7d8c(0x146)]({'where':{'id':_0x458398},'select':{'id':!![],'name':!![],'username':!![],'balance':!![],'totalPaidOut':!![]}});if(!_0x5ebbeb)throw new Error(_0x1c7d8c(0x139));console[_0x1c7d8c(0xd3)](_0x1c7d8c(0x186)+_0x5ebbeb['username']+':'),console[_0x1c7d8c(0xd3)](_0x1c7d8c(0xd7)+_0x5ebbeb[_0x1c7d8c(0xc7)]['toFixed'](0x6)+_0x1c7d8c(0xf1)),console[_0x1c7d8c(0xd3)](_0x1c7d8c(0x184)+_0x3e587b[_0x1c7d8c(0x9e)](0x6)+'\x20USDT'),console['log'](_0x1c7d8c(0x149)+_0x5ebbeb[_0x1c7d8c(0x199)]['toFixed'](0x6)+_0x1c7d8c(0xf1));if(_0x107cd6)console[_0x1c7d8c(0xd3)](_0x1c7d8c(0x14b)+_0x107cd6);const _0x293e34=0.000001,_0x1cf352=Number(_0x5ebbeb[_0x1c7d8c(0xc7)]),_0x327435=Number(_0x3e587b);console[_0x1c7d8c(0xd3)](_0x1c7d8c(0x174)),console[_0x1c7d8c(0xd3)]('\x20\x20\x20Available\x20(raw):\x20'+_0x5ebbeb[_0x1c7d8c(0xc7)]),console[_0x1c7d8c(0xd3)](_0x1c7d8c(0x14f)+_0x1cf352),console[_0x1c7d8c(0xd3)](_0x1c7d8c(0x1dc)+_0x327435),console[_0x1c7d8c(0xd3)](_0x1c7d8c(0xf3)+(_0x1cf352-_0x327435)),console[_0x1c7d8c(0xd3)](_0x1c7d8c(0x13c)+_0x293e34);if(_0x1cf352<_0x327435-_0x293e34)throw new Error(_0x1c7d8c(0xaf)+_0x1cf352['toFixed'](0x6)+_0x1c7d8c(0xc2)+_0x327435[_0x1c7d8c(0x9e)](0x6)+_0x1c7d8c(0xa5)+(_0x1cf352-_0x327435)['toFixed'](0x8)+_0x1c7d8c(0xf1));console[_0x1c7d8c(0xd3)](_0x1c7d8c(0x10d));const _0x234ba2=Math[_0x1c7d8c(0x141)](_0x1cf352,_0x327435);let _0x248659=_0x5a1905;if(!_0x248659){const _0x34cf1f=await _0x303da1['shop'][_0x1c7d8c(0x146)]({'where':{'id':_0x458398},'select':{'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'usdcErcWallet':!![]}});if(_0x34cf1f)switch(_0x2d34f5){case _0x1c7d8c(0x135):_0x248659=_0x34cf1f[_0x1c7d8c(0xf4)]||undefined;break;case'trc20':_0x248659=_0x34cf1f[_0x1c7d8c(0x12d)]||undefined;break;case'erc20':_0x248659=_0x34cf1f[_0x1c7d8c(0x143)]||undefined;break;case _0x1c7d8c(0x11c):_0x248659=_0x34cf1f[_0x1c7d8c(0xdf)]||undefined;break;case _0x1c7d8c(0x1d3):_0x248659=_0x34cf1f[_0x1c7d8c(0x1e2)]||undefined;break;}}console[_0x1c7d8c(0xd3)](_0x1c7d8c(0x1c1)+_0x2d34f5+':\x20'+(_0x248659||'not\x20specified'));const _0x536b5f=await _0x303da1[_0x1c7d8c(0xe0)][_0x1c7d8c(0x19e)]({'data':{'shopId':_0x458398,'amount':_0x234ba2,'network':_0x2d34f5,'status':'COMPLETED','txid':_0x107cd6,'notes':_0x8d1231,'periodFrom':_0x37a532?new Date(_0x37a532):null,'periodTo':_0xfc9320?new Date(_0xfc9320):null,'createdAt':new Date(),'paidAt':new Date()}}),_0x177a66=_0x1cf352-_0x234ba2,_0x1b8ce9=Number(_0x5ebbeb[_0x1c7d8c(0x199)])+_0x234ba2;return await _0x303da1[_0x1c7d8c(0x16f)]['update']({'where':{'id':_0x458398},'data':{'balance':_0x177a66,'totalPaidOut':_0x1b8ce9}}),console[_0x1c7d8c(0xd3)](_0x1c7d8c(0x17d)+_0x5ebbeb['username']+_0x1c7d8c(0x127)),console[_0x1c7d8c(0xd3)](_0x1c7d8c(0x15d)+_0x1cf352['toFixed'](0x6)+_0x1c7d8c(0x169)+_0x177a66['toFixed'](0x6)+_0x1c7d8c(0x115)+_0x234ba2[_0x1c7d8c(0x9e)](0x6)+')'),console[_0x1c7d8c(0xd3)](_0x1c7d8c(0x152)+_0x5ebbeb[_0x1c7d8c(0x199)][_0x1c7d8c(0x9e)](0x6)+_0x1c7d8c(0x169)+_0x1b8ce9['toFixed'](0x6)+'\x20USDT\x20(+'+_0x234ba2[_0x1c7d8c(0x9e)](0x6)+')'),console[_0x1c7d8c(0xd3)](_0x1c7d8c(0x1c2)+_0x234ba2[_0x1c7d8c(0x9e)](0x6)+'\x20USDT'),{'payout':_0x536b5f,'shop':_0x5ebbeb};});return console[_0x46a318(0xd3)](_0x46a318(0x1b8)+_0x405092[_0x46a318(0xe0)]['id']+'\x20for\x20shop\x20'+_0x405092['shop'][_0x46a318(0xe5)]+'\x20('+_0x405092[_0x46a318(0xe0)][_0x46a318(0x100)][_0x46a318(0x9e)](0x6)+_0x46a318(0x18a)),{'id':_0x405092[_0x46a318(0xe0)]['id'],'shopId':_0x405092[_0x46a318(0xe0)]['shopId'],'shopName':_0x405092[_0x46a318(0x16f)][_0x46a318(0xbb)],'shopUsername':_0x405092[_0x46a318(0x16f)][_0x46a318(0xe5)],'amount':_0x405092['payout'][_0x46a318(0x100)],'network':_0x405092['payout'][_0x46a318(0xec)],'status':_0x405092[_0x46a318(0xe0)]['status'],'txid':_0x405092[_0x46a318(0xe0)][_0x46a318(0xb6)],'notes':_0x405092[_0x46a318(0xe0)][_0x46a318(0x194)],'periodFrom':_0x405092[_0x46a318(0xe0)][_0x46a318(0xdb)],'periodTo':_0x405092[_0x46a318(0xe0)][_0x46a318(0x9c)],'createdAt':_0x405092[_0x46a318(0xe0)][_0x46a318(0xd0)],'paidAt':_0x405092[_0x46a318(0xe0)][_0x46a318(0x150)]};}async['getAllPayouts'](_0x5d38ce){const _0x5a4eda=a40_0x1f4f38,{page:_0xf5423e,limit:_0x543928,shopId:_0x3d07f1,network:_0x197815,dateFrom:_0x4887e3,dateTo:_0x4d7af3,search:_0x16cd15}=_0x5d38ce,_0x2d21f0=(_0xf5423e-0x1)*_0x543928,_0x43a469={};_0x3d07f1&&(_0x43a469[_0x5a4eda(0x15c)]=_0x3d07f1);_0x197815&&(_0x43a469['network']=_0x197815);(_0x4887e3||_0x4d7af3)&&(_0x43a469[_0x5a4eda(0xd0)]={},_0x4887e3&&(_0x43a469['createdAt']['gte']=new Date(_0x4887e3)),_0x4d7af3&&(_0x43a469[_0x5a4eda(0xd0)][_0x5a4eda(0x185)]=new Date(_0x4d7af3)));_0x16cd15&&(_0x43a469['OR']=[{'shop':{'name':{'contains':_0x16cd15,'mode':_0x5a4eda(0x166)}}},{'shop':{'username':{'contains':_0x16cd15,'mode':_0x5a4eda(0x166)}}},{'notes':{'contains':_0x16cd15,'mode':'insensitive'}}]);const [_0x51821a,_0x1fc709]=await Promise['all']([database_1[_0x5a4eda(0x112)][_0x5a4eda(0xe0)][_0x5a4eda(0xc1)]({'where':_0x43a469,'skip':_0x2d21f0,'take':_0x543928,'orderBy':{'createdAt':_0x5a4eda(0x104)},'select':{'id':!![],'shopId':!![],'amount':!![],'network':!![],'status':!![],'txid':!![],'notes':!![],'periodFrom':!![],'periodTo':!![],'createdAt':!![],'paidAt':!![],'shop':{'select':{'name':!![],'username':!![]}}}}),database_1[_0x5a4eda(0x112)][_0x5a4eda(0xe0)][_0x5a4eda(0xbc)]({'where':_0x43a469})]);return{'payouts':_0x51821a[_0x5a4eda(0x170)](_0x4d8c21=>({'id':_0x4d8c21['id'],'shopId':_0x4d8c21[_0x5a4eda(0x15c)],'shopName':_0x4d8c21['shop'][_0x5a4eda(0xbb)],'shopUsername':_0x4d8c21[_0x5a4eda(0x16f)][_0x5a4eda(0xe5)],'amount':_0x4d8c21['amount'],'network':_0x4d8c21[_0x5a4eda(0xec)],'status':_0x4d8c21['status'],'txid':_0x4d8c21[_0x5a4eda(0xb6)],'notes':_0x4d8c21[_0x5a4eda(0x194)],'periodFrom':_0x4d8c21[_0x5a4eda(0xdb)],'periodTo':_0x4d8c21[_0x5a4eda(0x9c)],'createdAt':_0x4d8c21[_0x5a4eda(0xd0)],'paidAt':_0x4d8c21[_0x5a4eda(0x150)]})),'pagination':{'page':_0xf5423e,'limit':_0x543928,'total':_0x1fc709,'totalPages':Math[_0x5a4eda(0x107)](_0x1fc709/_0x543928)}};}async[a40_0x1f4f38(0x1de)](_0x1046e0){const _0xc0aac4=a40_0x1f4f38,_0x161042=await database_1[_0xc0aac4(0x112)][_0xc0aac4(0xe0)][_0xc0aac4(0x146)]({'where':{'id':_0x1046e0},'include':{'shop':{'select':{'name':!![],'username':!![]}}}});if(!_0x161042)return null;return{'id':_0x161042['id'],'shopId':_0x161042[_0xc0aac4(0x15c)],'shopName':_0x161042['shop'][_0xc0aac4(0xbb)],'shopUsername':_0x161042[_0xc0aac4(0x16f)]['username'],'amount':_0x161042['amount'],'network':_0x161042[_0xc0aac4(0xec)],'status':_0x161042[_0xc0aac4(0x1a6)],'txid':_0x161042['txid'],'notes':_0x161042[_0xc0aac4(0x194)],'periodFrom':_0x161042[_0xc0aac4(0xdb)],'periodTo':_0x161042[_0xc0aac4(0x9c)],'createdAt':_0x161042['createdAt'],'paidAt':_0x161042[_0xc0aac4(0x150)]};}async['deletePayout'](_0x178bcb){const _0x420630=a40_0x1f4f38;await database_1['default'][_0x420630(0xe0)][_0x420630(0xc4)]({'where':{'id':_0x178bcb}});}async['getAllPayments'](_0x26ca12){const _0x4e9d3b=a40_0x1f4f38,{page:_0x19e221,limit:_0x267c3e,status:_0x669f95,gateway:_0x25fe75,shopId:_0x48d4ec,dateFrom:_0xcf36d4,dateTo:_0x2eec2a,search:_0x12e404,currency:_0x8d0a73,sortBy:_0xed517d,sortOrder:_0x252c76}=_0x26ca12,_0xa7bb4d=(_0x19e221-0x1)*_0x267c3e;console[_0x4e9d3b(0xd3)](_0x4e9d3b(0xe1),_0x26ca12);const _0x4375ea=await database_1['default'][_0x4e9d3b(0xc0)][_0x4e9d3b(0x19a)]({'by':['gateway'],'_count':{'gateway':!![]}});console[_0x4e9d3b(0xd3)](_0x4e9d3b(0xb1),_0x4375ea[_0x4e9d3b(0x170)](_0x9429c6=>_0x9429c6[_0x4e9d3b(0x1c7)]+'\x20('+_0x9429c6['_count'][_0x4e9d3b(0x1c7)]+_0x4e9d3b(0x189)));if(_0x25fe75){const _0x5a0d87=_0x4375ea[_0x4e9d3b(0x1af)](_0x9417a2=>_0x9417a2[_0x4e9d3b(0x1c7)][_0x4e9d3b(0x10b)]()===_0x25fe75['toLowerCase']());!_0x5a0d87&&_0x25fe75[_0x4e9d3b(0x10b)]()!==_0x4e9d3b(0x13d)&&console[_0x4e9d3b(0xd3)](_0x4e9d3b(0x1d0)+_0x25fe75+_0x4e9d3b(0x120)+_0x4375ea[_0x4e9d3b(0x170)](_0x2f0a91=>_0x2f0a91[_0x4e9d3b(0x1c7)])[_0x4e9d3b(0xbd)](',\x20'));}const _0x2e83cf={};_0x669f95&&(_0x2e83cf[_0x4e9d3b(0x1a6)]=_0x669f95[_0x4e9d3b(0x1a7)]());if(!_0x25fe75)_0x2e83cf['gateway']={'not':'test_gateway'};else{if(_0x25fe75&&(_0x25fe75[_0x4e9d3b(0x10b)]()===_0x4e9d3b(0x13d)||_0x25fe75===_0x4e9d3b(0x1d7)))_0x2e83cf[_0x4e9d3b(0x1c7)]=_0x4e9d3b(0x13d);else{let _0x1c88b0=_0x25fe75;const _0x2853e1=(0x0,gateway_1[_0x4e9d3b(0x1c3)])(_0x25fe75);if(_0x2853e1)_0x1c88b0=_0x2853e1,console[_0x4e9d3b(0xd3)](_0x4e9d3b(0x14d)+_0x25fe75+_0x4e9d3b(0xd2)+_0x1c88b0+'\x27');else{const _0x210d11=(0x0,gateway_1[_0x4e9d3b(0x1e1)])(_0x25fe75);if(_0x210d11){const _0x8315d4=(0x0,gateway_1[_0x4e9d3b(0x1c3)])(_0x210d11);_0x8315d4&&(_0x1c88b0=_0x8315d4,console[_0x4e9d3b(0xd3)](_0x4e9d3b(0x1d4)+_0x25fe75+_0x4e9d3b(0xf5)+_0x210d11+'\x27\x20->\x20name\x20\x27'+_0x1c88b0+'\x27'));}else console[_0x4e9d3b(0xd3)](_0x4e9d3b(0xb2)+_0x25fe75+'\x27\x20as\x20is\x20(not\x20found\x20in\x20mappings)');}const _0x6cd220=await database_1[_0x4e9d3b(0x112)][_0x4e9d3b(0xc0)][_0x4e9d3b(0xbc)]({'where':{'gateway':_0x1c88b0['toLowerCase']()},'take':0x1});_0x6cd220===0x0?(console['log'](_0x4e9d3b(0x126)+_0x1c88b0+_0x4e9d3b(0xa6)+_0x25fe75+_0x4e9d3b(0x10e)),_0x2e83cf[_0x4e9d3b(0x1c7)]=_0x4e9d3b(0x188)):(_0x2e83cf[_0x4e9d3b(0x1c7)]=_0x1c88b0[_0x4e9d3b(0x10b)](),console[_0x4e9d3b(0xd3)](_0x4e9d3b(0x165)+_0x1c88b0+_0x4e9d3b(0xa6)+_0x25fe75+'\x27)'));}}console[_0x4e9d3b(0xd3)]('📊\x20Gateway\x20filter\x20applied:',_0x2e83cf[_0x4e9d3b(0x1c7)]);_0x48d4ec&&(_0x2e83cf[_0x4e9d3b(0x15c)]=_0x48d4ec);_0x8d0a73&&(_0x2e83cf[_0x4e9d3b(0xa3)]=_0x8d0a73[_0x4e9d3b(0x1a7)](),console[_0x4e9d3b(0xd3)](_0x4e9d3b(0xfe)+_0x8d0a73['toUpperCase']()));(_0xcf36d4||_0x2eec2a)&&(_0x2e83cf[_0x4e9d3b(0xd0)]={},_0xcf36d4&&(_0x2e83cf[_0x4e9d3b(0xd0)]['gte']=new Date(_0xcf36d4)),_0x2eec2a&&(_0x2e83cf[_0x4e9d3b(0xd0)]['lte']=new Date(_0x2eec2a)));_0x12e404&&(_0x2e83cf['OR']=[{'id':{'contains':_0x12e404,'mode':'insensitive'}},{'orderId':{'contains':_0x12e404,'mode':_0x4e9d3b(0x166)}},{'gatewayOrderId':{'contains':_0x12e404,'mode':_0x4e9d3b(0x166)}},{'customerEmail':{'contains':_0x12e404,'mode':'insensitive'}},{'shop':{'name':{'contains':_0x12e404,'mode':_0x4e9d3b(0x166)}}},{'shop':{'username':{'contains':_0x12e404,'mode':_0x4e9d3b(0x166)}}}]);console[_0x4e9d3b(0xd3)](_0x4e9d3b(0x1a3),JSON[_0x4e9d3b(0x183)](_0x2e83cf,null,0x2));let _0x579124={'createdAt':_0x4e9d3b(0x104)};if(_0xed517d){const _0x54292a=[_0x4e9d3b(0x100),_0x4e9d3b(0xd0),_0x4e9d3b(0x190),_0x4e9d3b(0x1a6),_0x4e9d3b(0x1c7),_0x4e9d3b(0xa3)],_0xa9e94c=['asc',_0x4e9d3b(0x104)];if(_0x54292a['includes'](_0xed517d)){const _0x1bf425=_0xa9e94c[_0x4e9d3b(0x164)](_0x252c76)?_0x252c76:_0x4e9d3b(0x104);_0x579124={[_0xed517d]:_0x1bf425},console[_0x4e9d3b(0xd3)](_0x4e9d3b(0x101)+_0xed517d+_0x4e9d3b(0x176)+_0x1bf425+'\x20order');}}const [_0x461fd0,_0x30119d]=await Promise[_0x4e9d3b(0xe4)]([database_1[_0x4e9d3b(0x112)][_0x4e9d3b(0xc0)][_0x4e9d3b(0xc1)]({'where':_0x2e83cf,'skip':_0xa7bb4d,'take':_0x267c3e,'orderBy':_0x579124,'include':{'shop':{'select':{'name':!![],'username':!![]}}}}),database_1[_0x4e9d3b(0x112)]['payment'][_0x4e9d3b(0xbc)]({'where':_0x2e83cf})]);return{'payments':_0x461fd0,'pagination':{'page':_0x19e221,'limit':_0x267c3e,'total':_0x30119d,'totalPages':Math[_0x4e9d3b(0x107)](_0x30119d/_0x267c3e)}};}async[a40_0x1f4f38(0x1a9)](_0x199982){const _0x47e244=a40_0x1f4f38,_0xdfadb3=await database_1[_0x47e244(0x112)]['payment']['findUnique']({'where':{'id':_0x199982},'select':{'id':!![],'shopId':!![],'amount':!![],'amountAfterGatewayCommissionUSDT':!![],'currency':!![],'sourceCurrency':!![],'status':!![],'gateway':!![],'orderId':!![],'gatewayOrderId':!![],'gatewayPaymentId':!![],'customerEmail':!![],'customerName':!![],'customerCountry':!![],'customerIp':!![],'customerUa':!![],'externalPaymentUrl':!![],'successUrl':!![],'failUrl':!![],'pendingUrl':!![],'whiteUrl':!![],'expiresAt':!![],'invoiceTotalSum':!![],'qrCode':!![],'qrUrl':!![],'country':!![],'language':!![],'amountIsEditable':!![],'maxPayments':!![],'rapydCustomer':!![],'cardLast4':!![],'paymentMethod':!![],'bankId':!![],'remitterIban':!![],'remitterName':!![],'failureMessage':!![],'usage':!![],'createdAt':!![],'updatedAt':!![],'shop':{'select':{'name':!![],'username':!![]}}}});if(!_0xdfadb3)return null;return{'id':_0xdfadb3['id'],'shopId':_0xdfadb3[_0x47e244(0x15c)],'gateway':_0xdfadb3[_0x47e244(0x1c7)],'amount':_0xdfadb3['amount'],'currency':_0xdfadb3[_0x47e244(0xa3)],'status':_0xdfadb3[_0x47e244(0x1a6)],'orderId':_0xdfadb3[_0x47e244(0x1cf)],'gatewayOrderId':_0xdfadb3[_0x47e244(0x13b)],'customerEmail':_0xdfadb3[_0x47e244(0x16b)],'customerName':_0xdfadb3['customerName'],'customerCountry':_0xdfadb3[_0x47e244(0x12b)],'customerIp':_0xdfadb3[_0x47e244(0xd6)],'customerUa':_0xdfadb3[_0x47e244(0x157)],'failureMessage':_0xdfadb3[_0x47e244(0xed)],'externalPaymentUrl':_0xdfadb3['externalPaymentUrl'],'successUrl':_0xdfadb3[_0x47e244(0x1a4)],'failUrl':_0xdfadb3['failUrl'],'pendingUrl':_0xdfadb3[_0x47e244(0x1bf)],'whiteUrl':_0xdfadb3[_0x47e244(0xcc)],'createdAt':_0xdfadb3[_0x47e244(0xd0)],'updatedAt':_0xdfadb3[_0x47e244(0x190)],'shop':_0xdfadb3[_0x47e244(0x16f)]};}async[a40_0x1f4f38(0x116)](_0x36f5b7,_0x5e6642,_0x14500c,_0x535867){const _0x45601d=a40_0x1f4f38,_0x3d0c8d=await database_1[_0x45601d(0x112)][_0x45601d(0x1da)](async _0x13267a=>{const _0x58f049=_0x45601d,_0x361cec=await _0x13267a['payment'][_0x58f049(0x146)]({'where':{'id':_0x36f5b7},'include':{'shop':{'select':{'id':!![],'name':!![],'username':!![],'balance':!![]}}}});if(!_0x361cec)throw new Error(_0x58f049(0xb4));const _0x2620d8=_0x361cec[_0x58f049(0x1a6)],_0x3339f3=_0x5e6642['toUpperCase']();console[_0x58f049(0xd3)](_0x58f049(0x122)+_0x36f5b7+'\x20status:\x20'+_0x2620d8+'\x20->\x20'+_0x3339f3),console['log'](_0x58f049(0x168)+_0x361cec['shop'][_0x58f049(0xc7)]+_0x58f049(0xf1));const _0x3fa8a6={'status':_0x3339f3,'updatedAt':new Date(),'statusChangedBy':_0x58f049(0xbf),'statusChangedAt':new Date()};_0x14500c&&(_0x3fa8a6[_0x58f049(0xee)]=_0x14500c);_0x3339f3===_0x58f049(0xb7)&&_0x535867&&(_0x3fa8a6['chargebackAmount']=_0x535867);let _0x4e0269=0x0,_0xb5d71c=_0x361cec[_0x58f049(0x16f)][_0x58f049(0xc7)];if(_0x3339f3===_0x58f049(0x16c)&&_0x2620d8!==_0x58f049(0x16c)){_0x3fa8a6[_0x58f049(0x150)]=new Date();const _0x67e425=await currencyService_1[_0x58f049(0x1a1)][_0x58f049(0xda)](_0x361cec[_0x58f049(0x100)],_0x361cec[_0x58f049(0xa3)]);_0x3fa8a6[_0x58f049(0x16a)]=_0x67e425;let _0x18039b=0x2d;const _0x4735e9=await _0x13267a['shop'][_0x58f049(0x146)]({'where':{'id':_0x361cec[_0x58f049(0x15c)]},'select':{'gatewaySettings':!![]}});if(_0x4735e9?.[_0x58f049(0x1dd)])try{const _0x20607a=JSON['parse'](_0x4735e9[_0x58f049(0x1dd)]);for(const [_0x26b915,_0x319af3]of Object['entries'](_0x20607a)){if(_0x26b915[_0x58f049(0x10b)]()===_0x361cec[_0x58f049(0x1c7)]['toLowerCase']()){_0x18039b=_0x319af3['commission']||0xa;break;}}}catch(_0x195adb){console['error'](_0x58f049(0x10a)+_0x36f5b7+':',_0x195adb);}let _0x228a93;_0x361cec['amountAfterGatewayCommissionUSDT']!==null&&_0x361cec[_0x58f049(0xcf)]!==undefined?(_0x228a93=_0x361cec[_0x58f049(0xcf)],console[_0x58f049(0xd3)]('📊\x20[ADMIN]\x20Using\x20saved\x20amountAfterGatewayCommissionUSDT:\x20'+_0x228a93[_0x58f049(0x9e)](0x6)+_0x58f049(0x1d9)+_0x36f5b7)):(_0x228a93=_0x67e425*(0x1-_0x18039b/0x64),console['log'](_0x58f049(0x11e)+_0x36f5b7+':\x20'+_0x18039b+_0x58f049(0x13f)+_0x67e425[_0x58f049(0x9e)](0x6)+_0x58f049(0xf1)),_0x3fa8a6[_0x58f049(0xcf)]=_0x228a93,_0x3fa8a6[_0x58f049(0x1d8)]=_0x18039b),_0x4e0269=_0x228a93,_0xb5d71c+=_0x228a93,console[_0x58f049(0xd3)](_0x58f049(0x147)+_0x36f5b7+'\x20became\x20PAID:'),console[_0x58f049(0xd3)]('\x20\x20\x20Full\x20amount:\x20'+_0x67e425['toFixed'](0x6)+_0x58f049(0xf1)),console[_0x58f049(0xd3)](_0x58f049(0x1b2)+_0x361cec[_0x58f049(0x1c7)]+_0x58f049(0x1cb)+_0x18039b+'%'),console[_0x58f049(0xd3)](_0x58f049(0xa2)+_0x228a93[_0x58f049(0x9e)](0x6)+'\x20USDT\x20(after\x20'+_0x18039b+_0x58f049(0x18d)),console['log'](_0x58f049(0x17a)+_0x228a93['toFixed'](0x6)+'\x20USDT');}else{if(_0x2620d8===_0x58f049(0x16c)&&_0x3339f3!==_0x58f049(0x16c)&&_0x3339f3!==_0x58f049(0xb7)){if(_0x361cec[_0x58f049(0x16a)]){let _0x3e44dd=0x2d;const _0x2ccddf=await _0x13267a[_0x58f049(0x16f)][_0x58f049(0x146)]({'where':{'id':_0x361cec[_0x58f049(0x15c)]},'select':{'gatewaySettings':!![]}});if(_0x2ccddf?.[_0x58f049(0x1dd)])try{const _0x31d735=JSON[_0x58f049(0x133)](_0x2ccddf['gatewaySettings']);for(const [_0x379502,_0x4f3c48]of Object[_0x58f049(0x138)](_0x31d735)){if(_0x379502['toLowerCase']()===_0x361cec[_0x58f049(0x1c7)][_0x58f049(0x10b)]()){_0x3e44dd=_0x4f3c48['commission']||0xa;break;}}}catch(_0x1ab6af){console[_0x58f049(0x113)]('Error\x20parsing\x20gateway\x20settings\x20for\x20payment\x20'+_0x36f5b7+':',_0x1ab6af);}const _0x31c3de=_0x361cec[_0x58f049(0x16a)]*(0x1-_0x3e44dd/0x64);_0x4e0269=-_0x31c3de,_0xb5d71c-=_0x31c3de,console['log'](_0x58f049(0xb5)+_0x361cec[_0x58f049(0x16a)]['toFixed'](0x6)+_0x58f049(0xf1)),console[_0x58f049(0xd3)](_0x58f049(0x1b2)+_0x361cec['gateway']+_0x58f049(0x1cb)+_0x3e44dd+'%'),console[_0x58f049(0xd3)]('\x20\x20\x20Merchant\x20loses:\x20'+_0x31c3de[_0x58f049(0x9e)](0x6)+_0x58f049(0x195)+_0x3e44dd+_0x58f049(0x18d)),console[_0x58f049(0xd3)]('\x20\x20\x20Subtracted\x20from\x20balance:\x20-'+_0x31c3de[_0x58f049(0x9e)](0x6)+_0x58f049(0xf1));}}}_0x3339f3==='CHARGEBACK'&&(console[_0x58f049(0xd3)](_0x58f049(0x15f)),_0x535867&&_0x535867>0x0?(_0x4e0269=-_0x535867,_0xb5d71c-=_0x535867,console[_0x58f049(0xd3)](_0x58f049(0x1cc)+_0x535867[_0x58f049(0x9e)](0x6)+_0x58f049(0xa4)),console[_0x58f049(0xd3)](_0x58f049(0x1db))):console[_0x58f049(0xd3)](_0x58f049(0x137)),_0x3fa8a6[_0x58f049(0x9d)]=_0x535867||0x0);_0x3339f3==='REFUND'&&_0x2620d8===_0x58f049(0x16c)&&console[_0x58f049(0xd3)]('🔄\x20REFUND:\x20Payment\x20amount\x20already\x20deducted\x20from\x20balance');const _0x339c80=await _0x13267a[_0x58f049(0xc0)][_0x58f049(0x145)]({'where':{'id':_0x36f5b7},'data':_0x3fa8a6,'include':{'shop':{'select':{'name':!![],'username':!![]}}}});return _0x4e0269!==0x0&&(await _0x13267a[_0x58f049(0x16f)][_0x58f049(0x145)]({'where':{'id':_0x361cec[_0x58f049(0x15c)]},'data':{'balance':_0xb5d71c}}),console['log'](_0x58f049(0x17d)+_0x361cec['shopId']+_0x58f049(0x11b)+_0x361cec[_0x58f049(0x16f)][_0x58f049(0xc7)][_0x58f049(0x9e)](0x6)+'\x20->\x20'+_0xb5d71c[_0x58f049(0x9e)](0x6)+_0x58f049(0x11f)+(_0x4e0269>0x0?'+':'')+_0x4e0269['toFixed'](0x6)+')')),_0x339c80;});return{'id':_0x3d0c8d['id'],'shopId':_0x3d0c8d[_0x45601d(0x15c)],'gateway':_0x3d0c8d['gateway'],'amount':_0x3d0c8d[_0x45601d(0x100)],'currency':_0x3d0c8d[_0x45601d(0xa3)],'status':_0x3d0c8d[_0x45601d(0x1a6)],'orderId':_0x3d0c8d[_0x45601d(0x1cf)],'gatewayOrderId':_0x3d0c8d[_0x45601d(0x13b)],'customerEmail':_0x3d0c8d[_0x45601d(0x16b)],'customerName':_0x3d0c8d[_0x45601d(0x196)],'customerCountry':_0x3d0c8d[_0x45601d(0x12b)],'customerIp':_0x3d0c8d[_0x45601d(0xd6)],'customerUa':_0x3d0c8d[_0x45601d(0x157)],'failureMessage':_0x3d0c8d[_0x45601d(0xed)],'adminNotes':_0x3d0c8d[_0x45601d(0xee)],'chargebackAmount':_0x3d0c8d['chargebackAmount'],'statusChangedBy':_0x3d0c8d[_0x45601d(0xa0)],'statusChangedAt':_0x3d0c8d[_0x45601d(0x154)],'createdAt':_0x3d0c8d[_0x45601d(0xd0)],'updatedAt':_0x3d0c8d[_0x45601d(0x190)],'shop':_0x3d0c8d[_0x45601d(0x16f)]};}async[a40_0x1f4f38(0x11d)](_0x617b91,_0x2099de){const _0x10aa71=a40_0x1f4f38,_0x5b4d06=Math[_0x10aa71(0x132)]()[_0x10aa71(0x129)](0x24)[_0x10aa71(0xf0)](0x2,0x9);console[_0x10aa71(0xd3)](_0x10aa71(0x103)+_0x5b4d06+_0x10aa71(0x108)+_0x617b91);const _0x2c74cd={..._0x2099de};_0x2099de[_0x10aa71(0x1ae)]&&_0x2099de['password'][_0x10aa71(0xfd)]()!==''?(console['log'](_0x10aa71(0x1ab)+_0x5b4d06+_0x10aa71(0x1ca)+_0x617b91),_0x2c74cd[_0x10aa71(0x1ae)]=await bcryptjs_1[_0x10aa71(0x112)][_0x10aa71(0x14e)](_0x2099de['password'],0xc)):(console[_0x10aa71(0xd3)](_0x10aa71(0x1ab)+_0x5b4d06+']\x20Password\x20not\x20provided\x20or\x20empty,\x20skipping\x20password\x20update'),delete _0x2c74cd[_0x10aa71(0x1ae)]);_0x2099de[_0x10aa71(0x198)]&&(_0x2c74cd['name']=_0x2099de['fullName'],delete _0x2c74cd['fullName']);_0x2099de[_0x10aa71(0x1c4)]&&(_0x2c74cd[_0x10aa71(0x1d1)]=_0x2099de['telegramId'],delete _0x2c74cd[_0x10aa71(0x1c4)]);_0x2099de['merchantUrl']&&(_0x2c74cd[_0x10aa71(0x16d)]=_0x2099de['merchantUrl'],delete _0x2c74cd[_0x10aa71(0xc9)]);if(_0x2099de[_0x10aa71(0x163)]){const _0x309770=_0x2099de[_0x10aa71(0x163)]['map'](_0x1fc0ed=>this[_0x10aa71(0x134)](_0x1fc0ed));console[_0x10aa71(0xd3)]('🔄\x20Gateway\x20mapping:',_0x2099de[_0x10aa71(0x163)],'->',_0x309770),_0x2c74cd[_0x10aa71(0x177)]=JSON[_0x10aa71(0x183)](_0x309770),delete _0x2c74cd[_0x10aa71(0x163)];}_0x2099de[_0x10aa71(0x1dd)]&&(console[_0x10aa71(0xd3)]('🔧\x20['+_0x5b4d06+_0x10aa71(0xd4),_0x2099de[_0x10aa71(0x1dd)]),_0x2c74cd['gatewaySettings']=JSON[_0x10aa71(0x183)](_0x2099de[_0x10aa71(0x1dd)]),console[_0x10aa71(0xd3)]('🔧\x20['+_0x5b4d06+']\x20Gateway\x20settings\x20JSON\x20string:',_0x2c74cd[_0x10aa71(0x1dd)]));_0x2099de[_0x10aa71(0x1cd)]&&(_0x2099de[_0x10aa71(0x1cd)]['usdtPolygonWallet']!==undefined&&(_0x2c74cd['usdtPolygonWallet']=_0x2099de['wallets'][_0x10aa71(0xf4)]||null),_0x2099de[_0x10aa71(0x1cd)][_0x10aa71(0x12d)]!==undefined&&(_0x2c74cd[_0x10aa71(0x12d)]=_0x2099de['wallets'][_0x10aa71(0x12d)]||null),_0x2099de[_0x10aa71(0x1cd)][_0x10aa71(0x143)]!==undefined&&(_0x2c74cd[_0x10aa71(0x143)]=_0x2099de[_0x10aa71(0x1cd)][_0x10aa71(0x143)]||null),_0x2099de[_0x10aa71(0x1cd)]['usdcPolygonWallet']!==undefined&&(_0x2c74cd['usdcPolygonWallet']=_0x2099de[_0x10aa71(0x1cd)][_0x10aa71(0xdf)]||null),delete _0x2c74cd[_0x10aa71(0x1cd)]);const _0x2e8071=await database_1[_0x10aa71(0x112)][_0x10aa71(0x16f)]['update']({'where':{'id':_0x617b91},'data':_0x2c74cd,'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});return console['log']('🎯\x20['+_0x5b4d06+']\x20User\x20updated,\x20gatewaySettings\x20from\x20DB:',_0x2e8071[_0x10aa71(0x1dd)]),{'id':_0x2e8071['id'],'fullName':_0x2e8071[_0x10aa71(0xbb)],'username':_0x2e8071[_0x10aa71(0xe5)],'telegramId':_0x2e8071[_0x10aa71(0x1d1)],'merchantUrl':_0x2e8071['shopUrl'],'gateways':_0x2e8071['paymentGateways']?JSON[_0x10aa71(0x133)](_0x2e8071[_0x10aa71(0x177)]):null,'gatewaySettings':_0x2e8071[_0x10aa71(0x1dd)]?JSON['parse'](_0x2e8071[_0x10aa71(0x1dd)]):null,'publicKey':_0x2e8071[_0x10aa71(0x159)],'wallets':{'usdtPolygonWallet':_0x2e8071['usdtPolygonWallet'],'usdtTrcWallet':_0x2e8071['usdtTrcWallet'],'usdtErcWallet':_0x2e8071[_0x10aa71(0x143)],'usdcPolygonWallet':_0x2e8071['usdcPolygonWallet']},'status':_0x2e8071[_0x10aa71(0x1a6)],'createdAt':_0x2e8071['createdAt']};}async[a40_0x1f4f38(0x148)](_0x307564){const _0x4fdb98=a40_0x1f4f38,_0x42c6b7=await database_1[_0x4fdb98(0x112)][_0x4fdb98(0x16f)][_0x4fdb98(0x145)]({'where':{'id':_0x307564},'data':{'status':'SUSPENDED'},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});return{'id':_0x42c6b7['id'],'fullName':_0x42c6b7[_0x4fdb98(0xbb)],'username':_0x42c6b7['username'],'telegramId':_0x42c6b7[_0x4fdb98(0x1d1)],'merchantUrl':_0x42c6b7[_0x4fdb98(0x16d)],'gateways':_0x42c6b7['paymentGateways']?JSON[_0x4fdb98(0x133)](_0x42c6b7[_0x4fdb98(0x177)]):null,'gatewaySettings':_0x42c6b7[_0x4fdb98(0x1dd)]?JSON['parse'](_0x42c6b7[_0x4fdb98(0x1dd)]):null,'publicKey':_0x42c6b7[_0x4fdb98(0x159)],'wallets':{'usdtPolygonWallet':_0x42c6b7[_0x4fdb98(0xf4)],'usdtTrcWallet':_0x42c6b7[_0x4fdb98(0x12d)],'usdtErcWallet':_0x42c6b7['usdtErcWallet'],'usdcPolygonWallet':_0x42c6b7[_0x4fdb98(0xdf)]},'status':_0x42c6b7['status'],'createdAt':_0x42c6b7['createdAt']};}async[a40_0x1f4f38(0x19b)](_0x75b21d){const _0x3a8369=a40_0x1f4f38,_0x494529=await database_1[_0x3a8369(0x112)][_0x3a8369(0x16f)][_0x3a8369(0x145)]({'where':{'id':_0x75b21d},'data':{'status':_0x3a8369(0x128)},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});return{'id':_0x494529['id'],'fullName':_0x494529[_0x3a8369(0xbb)],'username':_0x494529[_0x3a8369(0xe5)],'telegramId':_0x494529[_0x3a8369(0x1d1)],'merchantUrl':_0x494529[_0x3a8369(0x16d)],'gateways':_0x494529['paymentGateways']?JSON[_0x3a8369(0x133)](_0x494529[_0x3a8369(0x177)]):null,'gatewaySettings':_0x494529['gatewaySettings']?JSON[_0x3a8369(0x133)](_0x494529[_0x3a8369(0x1dd)]):null,'publicKey':_0x494529[_0x3a8369(0x159)],'wallets':{'usdtPolygonWallet':_0x494529[_0x3a8369(0xf4)],'usdtTrcWallet':_0x494529[_0x3a8369(0x12d)],'usdtErcWallet':_0x494529[_0x3a8369(0x143)],'usdcPolygonWallet':_0x494529[_0x3a8369(0xdf)]},'status':_0x494529[_0x3a8369(0x1a6)],'createdAt':_0x494529[_0x3a8369(0xd0)]};}async[a40_0x1f4f38(0x1ce)](_0x17d2ce){const _0x2caeac=a40_0x1f4f38,{page:_0x175e9d,limit:_0x275bcf,status:_0x3fd332}=_0x17d2ce,_0x27b3cc=(_0x175e9d-0x1)*_0x275bcf,_0x398108={};_0x3fd332&&(_0x398108['status']=_0x3fd332[_0x2caeac(0x1a7)]());const [_0x5ded19,_0x4766cd]=await Promise['all']([database_1[_0x2caeac(0x112)][_0x2caeac(0x16f)][_0x2caeac(0xc1)]({'where':_0x398108,'skip':_0x27b3cc,'take':_0x275bcf,'orderBy':{'createdAt':'desc'},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}}),database_1['default'][_0x2caeac(0x16f)][_0x2caeac(0xbc)]({'where':_0x398108})]);return{'users':_0x5ded19['map'](_0x8b77f4=>{const _0x4ebe7d=_0x2caeac,_0x291c0b=_0x8b77f4[_0x4ebe7d(0x177)]?JSON['parse'](_0x8b77f4[_0x4ebe7d(0x177)]):null,_0x55312c=_0x291c0b?_0x291c0b['map'](_0x59178e=>this['getGatewayDisplayName'](_0x59178e)):null;return{'id':_0x8b77f4['id'],'fullName':_0x8b77f4['name'],'username':_0x8b77f4[_0x4ebe7d(0xe5)],'telegramId':_0x8b77f4[_0x4ebe7d(0x1d1)],'merchantUrl':_0x8b77f4[_0x4ebe7d(0x16d)],'gateways':_0x55312c,'gatewaySettings':_0x8b77f4[_0x4ebe7d(0x1dd)]?JSON['parse'](_0x8b77f4['gatewaySettings']):null,'publicKey':_0x8b77f4['publicKey'],'wallets':{'usdtPolygonWallet':_0x8b77f4[_0x4ebe7d(0xf4)],'usdtTrcWallet':_0x8b77f4[_0x4ebe7d(0x12d)],'usdtErcWallet':_0x8b77f4[_0x4ebe7d(0x143)],'usdcPolygonWallet':_0x8b77f4[_0x4ebe7d(0xdf)]},'status':_0x8b77f4[_0x4ebe7d(0x1a6)],'createdAt':_0x8b77f4[_0x4ebe7d(0xd0)]};}),'pagination':{'page':_0x175e9d,'limit':_0x275bcf,'total':_0x4766cd,'totalPages':Math[_0x2caeac(0x107)](_0x4766cd/_0x275bcf)}};}async[a40_0x1f4f38(0x111)](_0x5dd001){const _0x2408d9=a40_0x1f4f38,_0xb5d187=await database_1[_0x2408d9(0x112)][_0x2408d9(0x16f)]['findUnique']({'where':{'id':_0x5dd001},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});if(!_0xb5d187)return null;const _0x5dd3ee=_0xb5d187['paymentGateways']?JSON[_0x2408d9(0x133)](_0xb5d187[_0x2408d9(0x177)]):null,_0x3eac12=_0x5dd3ee?_0x5dd3ee[_0x2408d9(0x170)](_0x58dddd=>this[_0x2408d9(0xc6)](_0x58dddd)):null;return _0x5dd3ee&&_0x3eac12&&console[_0x2408d9(0xd3)](_0x2408d9(0x1c6),_0x5dd3ee,'->',_0x3eac12),{'id':_0xb5d187['id'],'fullName':_0xb5d187[_0x2408d9(0xbb)],'username':_0xb5d187[_0x2408d9(0xe5)],'telegramId':_0xb5d187[_0x2408d9(0x1d1)],'merchantUrl':_0xb5d187['shopUrl'],'gateways':_0x3eac12,'gatewaySettings':_0xb5d187[_0x2408d9(0x1dd)]?JSON[_0x2408d9(0x133)](_0xb5d187[_0x2408d9(0x1dd)]):null,'publicKey':_0xb5d187[_0x2408d9(0x159)],'wallets':{'usdtPolygonWallet':_0xb5d187[_0x2408d9(0xf4)],'usdtTrcWallet':_0xb5d187['usdtTrcWallet'],'usdtErcWallet':_0xb5d187[_0x2408d9(0x143)],'usdcPolygonWallet':_0xb5d187[_0x2408d9(0xdf)]},'status':_0xb5d187[_0x2408d9(0x1a6)],'createdAt':_0xb5d187[_0x2408d9(0xd0)]};}async['createUser'](_0x1bae31){const _0x5631ff=a40_0x1f4f38,{fullName:_0x2ac8b7,username:_0x2bb482,password:_0x1c91c7,telegramId:_0x487a0f,merchantUrl:_0x106472,gateways:_0x51c931,gatewaySettings:_0x245fe9,wallets:_0x877f73}=_0x1bae31,_0x475349=await database_1[_0x5631ff(0x112)][_0x5631ff(0x16f)][_0x5631ff(0x146)]({'where':{'username':_0x2bb482}});if(_0x475349)throw new Error(_0x5631ff(0x180));if(_0x487a0f){const _0x84a7fb=await database_1[_0x5631ff(0x112)][_0x5631ff(0x16f)][_0x5631ff(0x146)]({'where':{'telegram':_0x487a0f}});if(_0x84a7fb)throw new Error(_0x5631ff(0x13e));}const _0x56fe57=await bcryptjs_1['default'][_0x5631ff(0x14e)](_0x1c91c7,0xc),_0x179890=_0x5631ff(0xa9)+crypto_1[_0x5631ff(0x112)][_0x5631ff(0x173)](0x20)[_0x5631ff(0x129)]('hex'),_0x51d390='sk_'+crypto_1[_0x5631ff(0x112)][_0x5631ff(0x173)](0x20)[_0x5631ff(0x129)](_0x5631ff(0xbe)),_0x20542f=_0x51c931?_0x51c931[_0x5631ff(0x170)](_0x12903a=>this[_0x5631ff(0x134)](_0x12903a)):null;_0x51c931&&_0x20542f&&console['log'](_0x5631ff(0xf7),_0x51c931,'->',_0x20542f);const _0x152a3c=await database_1[_0x5631ff(0x112)][_0x5631ff(0x16f)]['create']({'data':{'name':_0x2ac8b7,'username':_0x2bb482,'password':_0x56fe57,'telegram':_0x487a0f,'shopUrl':_0x106472,'paymentGateways':_0x20542f?JSON[_0x5631ff(0x183)](_0x20542f):null,'gatewaySettings':_0x245fe9?JSON[_0x5631ff(0x183)](_0x245fe9):null,'usdtPolygonWallet':_0x877f73?.[_0x5631ff(0xf4)]||null,'usdtTrcWallet':_0x877f73?.['usdtTrcWallet']||null,'usdtErcWallet':_0x877f73?.[_0x5631ff(0x143)]||null,'usdcPolygonWallet':_0x877f73?.[_0x5631ff(0xdf)]||null,'publicKey':_0x179890,'secretKey':_0x51d390,'status':_0x5631ff(0x128)},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});return{'id':_0x152a3c['id'],'fullName':_0x152a3c[_0x5631ff(0xbb)],'username':_0x152a3c[_0x5631ff(0xe5)],'telegramId':_0x152a3c[_0x5631ff(0x1d1)],'merchantUrl':_0x152a3c[_0x5631ff(0x16d)],'gateways':_0x152a3c[_0x5631ff(0x177)]?JSON['parse'](_0x152a3c[_0x5631ff(0x177)]):null,'gatewaySettings':_0x152a3c['gatewaySettings']?JSON[_0x5631ff(0x133)](_0x152a3c[_0x5631ff(0x1dd)]):null,'publicKey':_0x152a3c['publicKey'],'wallets':{'usdtPolygonWallet':_0x152a3c['usdtPolygonWallet'],'usdtTrcWallet':_0x152a3c[_0x5631ff(0x12d)],'usdtErcWallet':_0x152a3c['usdtErcWallet'],'usdcPolygonWallet':_0x152a3c['usdcPolygonWallet']},'status':_0x152a3c['status'],'createdAt':_0x152a3c[_0x5631ff(0xd0)]};}async[a40_0x1f4f38(0x187)](_0x4593b5){const _0x1b6dd6=a40_0x1f4f38;await database_1['default']['shop'][_0x1b6dd6(0xc4)]({'where':{'id':_0x4593b5}});}[a40_0x1f4f38(0xa1)](_0xb52f19,_0x59c43e,_0x452be6){const _0x43a37b=a40_0x1f4f38,_0x4c0ab2=new Map(),_0x40289d=new Date(_0x59c43e);while(_0x40289d<=_0x452be6){const _0x3bcdcf=_0x40289d[_0x43a37b(0xd1)]()[_0x43a37b(0x1d6)]('T')[0x0];_0x4c0ab2['set'](_0x3bcdcf,{'revenue':0x0,'count':0x0}),_0x40289d[_0x43a37b(0xff)](_0x40289d[_0x43a37b(0x181)]()+0x1);}for(const _0x42e274 of _0xb52f19){const _0x478772=_0x42e274[_0x43a37b(0xd0)]['toISOString']()[_0x43a37b(0x1d6)]('T')[0x0],_0x4c9cd3=_0x4c0ab2[_0x43a37b(0x1b6)](_0x478772);_0x4c9cd3&&(_0x4c9cd3[_0x43a37b(0xbc)]+=0x1,_0x42e274['status']===_0x43a37b(0x16c)&&(_0x42e274['amountUSDT']?_0x4c9cd3[_0x43a37b(0x1b0)]+=_0x42e274[_0x43a37b(0x16a)]:console[_0x43a37b(0xd3)](_0x43a37b(0x11a)+_0x42e274['id']+_0x43a37b(0x15b))));}const _0x2753f6=[],_0x2bd71f=[];for(const [_0x23d796,_0x1f8f5c]of _0x4c0ab2){_0x2753f6['push']({'date':_0x23d796,'amount':Math['round'](_0x1f8f5c['revenue']*0x64)/0x64}),_0x2bd71f[_0x43a37b(0xd8)]({'date':_0x23d796,'count':_0x1f8f5c['count']});}return{'dailyRevenue':_0x2753f6,'dailyPayments':_0x2bd71f};}}exports[a40_0x1f4f38(0x136)]=AdminService;