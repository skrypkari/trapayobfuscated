'use strict';const a35_0x3ed49f=a35_0x51fc;(function(_0x17b23e,_0x2c8463){const _0x59e6c0=a35_0x51fc,_0xe0bc6b=_0x17b23e();while(!![]){try{const _0x34179c=-parseInt(_0x59e6c0(0x150))/0x1*(-parseInt(_0x59e6c0(0x126))/0x2)+-parseInt(_0x59e6c0(0xf3))/0x3+-parseInt(_0x59e6c0(0x9c))/0x4+parseInt(_0x59e6c0(0x152))/0x5*(parseInt(_0x59e6c0(0xc5))/0x6)+parseInt(_0x59e6c0(0xe4))/0x7*(-parseInt(_0x59e6c0(0xb0))/0x8)+parseInt(_0x59e6c0(0x127))/0x9+parseInt(_0x59e6c0(0x16a))/0xa;if(_0x34179c===_0x2c8463)break;else _0xe0bc6b['push'](_0xe0bc6b['shift']());}catch(_0x355189){_0xe0bc6b['push'](_0xe0bc6b['shift']());}}}(a35_0x4589,0x60c6d));var __importDefault=this&&this[a35_0x3ed49f(0xed)]||function(_0x46e05e){const _0x8fc06b=a35_0x3ed49f;return _0x46e05e&&_0x46e05e[_0x8fc06b(0xd3)]?_0x46e05e:{'default':_0x46e05e};};Object[a35_0x3ed49f(0xc4)](exports,a35_0x3ed49f(0xd3),{'value':!![]}),exports['AdminService']=void 0x0;function a35_0x51fc(_0x501382,_0x167c5a){const _0x4589bf=a35_0x4589();return a35_0x51fc=function(_0x51fc30,_0x130f7f){_0x51fc30=_0x51fc30-0x70;let _0x5c7661=_0x4589bf[_0x51fc30];return _0x5c7661;},a35_0x51fc(_0x501382,_0x167c5a);}function a35_0x4589(){const _0x1917da=['admin','currencyService','💰\x20Shop\x20','\x20\x20\x20Commission\x20from\x20shop\x20settings:\x20','📅\x20Period:\x20','dateFrom','\x20merchants\x20with\x20positive\x20balance','map','\x20USDT\x20(-','paidOutUSDT','gatewaySettings','getPaymentById','push','whiteUrl','balance','defineProperty','192VPuBGB','notes','\x20USDT,\x20Requested:\x20','string','📊\x20Getting\x20merchants\x20awaiting\x20payout\x20with\x20filters:','keys','amount','Telegram\x20username\x20already\x20exists','updatePaymentStatus','statusChangedAt','averageCommissionRate','week','INACTIVE','create','__esModule','payment','dailyRevenue','📊\x20Calculating\x20payout\x20statistics...','\x20USDT','totalTurnover','Payment\x20not\x20found','delete','revenue','length','paymentGateways','username','\x20payments\x20for\x20daily\x20statistics','error','stringify','turnoverUSDT','\x20\x20\x20👤\x20Merchant\x20earnings:\x20','13013GkQVVf','📊\x20Payout\x20statistics\x20calculated:','periodTo','bankId','find','shop','crypto','Plisio','Error\x20parsing\x20gateway\x20settings\x20for\x20shop\x20','__importDefault','getMerchantsSelection','lte','\x20\x20\x20Total\x20paid\x20out:\x20','totalPaidOut','\x20\x20\x20Raw\x20gatewaySettings:\x20','1869519lWoxLy','\x20\x20\x20Parsed\x20gatewaySettings:','txid','CHARGEBACK','_sum','insensitive','📊\x20Merchants\x20awaiting\x20payout:\x20','totalCommissionRate','\x20\x20\x20🖥️\x20User\x20Agent:\x20','default','📊\x20Total\x20payments\x20(all\x20statuses):\x20','_count','telegram','toString','commissionUSDT','\x20paid\x20payments\x20for\x20analysis','createPayout','Insufficient\x20balance.\x20Available:\x20','⚠️\x20[DAILY]\x20Failed\x20to\x20convert\x20','payout','\x20\x20\x20Commission\x20from\x20settings:\x20','ceil','\x20\x20\x20Current\x20balance:\x20','\x20\x20\x20🏪\x20Gateway\x20earnings:\x20','\x20USDT\x20for\x20payment\x20on\x20','currency','deletePayout','\x20\x20\x20✅\x20Successful\x20payments:\x20','status','externalPaymentUrl','successfulPayments','🔄\x20Updating\x20customer\x20data\x20for\x20payment\x20','customerIp','KLYME\x20GB','\x20->\x20','suspendUser','Noda','✅\x20Payout\x20created:\x20','\x20\x20\x20💵\x20Available\x20balance:\x20','paymentMethod','🔄\x20REFUND:\x20Payment\x20amount\x20already\x20deducted\x20from\x20balance','\x20USDT\x20from\x20balance','usdtPolygonWallet','update','💰\x20Found\x20','\x20merchants,\x20','reduce','📊\x20[ADMIN]\x20Processing\x20','\x20PAID\x20payments\x20out\x20of\x20','merchantEarningsUSDT','failUrl','890ZAMDSn','1803861IusRUm','deleteUser','💱\x20[DAILY]\x20Converted\x20','dateTo','getAllUsers','💸\x20CHARGEBACK\x20penalty:\x20-','customerUa','\x20\x20\x20🌍\x20Country:\x20','findUnique','📊\x20Payment\x20','\x20balance\x20updated:\x20','📊\x20[ADMIN]\x20Period:\x20','\x20USDT\x20(total\x20paid\x20to\x20merchants)','📊\x20[DAILY]\x20Processed\x20','aggregate','paidAt','getGatewayDisplayName','\x20\x20\x20📅\x20This\x20month:\x20','createdAt','usdcPolygonWallet','\x20\x20\x20Name:\x20','customerName','test_gateway','count','toUpperCase','Rapyd','telegramId','\x20\x20\x20Total\x20payments:\x20','getPayoutById','gatewayOrderId','month','getPayoutStats','warn','not\x20found','💰\x20[DAILY]\x20Added\x20','shopUrl','\x20\x20\x20Conversion\x20rate:\x20','gateways','groupBy','📊\x20Conversion\x20rate\x20calculation:','periodFrom','1198fXaHyA','CoinToPay','70275JZUOQT','✅\x20Successful\x20payments:\x20','\x20USDT\x20(+','desc','successUrl','fullName','\x20became\x20PAID:\x20+','\x20\x20\x20Current\x20total\x20paid\x20out:\x20','📊\x20[DAILY]\x20Total\x20revenue\x20processed:\x20','$transaction','password','asc','\x20no\x20longer\x20PAID:\x20-','null','updatedAt','date','./currencyService','\x20\x20\x20Balance:\x20','split','hex','bcryptjs','\x20\x20\x20Successful\x20payments:\x20','year','\x20\x20\x20🌐\x20IP:\x20','9915520uXGUvk','sk_','remitterName','failureMessage','paymentsCount','📊\x20Getting\x20merchant\x20statistics\x20with\x20filters:','orderId','💰\x20Payment\x20','updateCustomerData','getFullYear','findMany','customerEmail','\x20\x20\x20📈\x20Conversion\x20rate:\x20','totalPayout','\x20USDT\x20(total\x20merchant\x20balances)','\x20status:\x20','custom','includes','\x20\x20\x20💰\x20Total\x20turnover:\x20','chargebackAmount','\x20\x20\x20💰\x20Total\x20payout:\x20','availableBalance','COMPLETED','toFixed','gatewayEarnings','REFUND','sort','customerCountry','usdtErcWallet','period','averageCheckUSDT','publicKey','PAID','round','pendingUrl','remitterIban','convertToUSDT','log','📊\x20Shop\x20info\x20for\x20','setDate','parse','hash','awaitingPayout','shopId','set','not\x20set','usdtTrcWallet','activateUser','📊\x20[ADMIN]\x20Status\x20breakdown:','getSystemStatistics','💰\x20Creating\x20payout\x20for\x20shop\x20','merchantUrl','gateway','name','\x20to\x20','✅\x20Customer\x20data\x20updated\x20for\x20payment\x20','values','getTime','Error\x20processing\x20payment\x20','forEach','createUser','1810316QTlYFh','totalPayments','\x20USDT)','toISOString','wallets','cardLast4','\x20\x20\x20Payout\x20amount:\x20','network','\x20\x20\x20Gateway\x20key\x20found:\x20','gte','\x20for\x20shop\x20','toLowerCase','amountUSDT','commission','thisMonth','all','merchantEarnings','../config/database','getAllPayments','ACTIVE','3024zGSQGq','adminNotes','getMerchantsAwaitingPayout','\x20\x20\x20⏳\x20Awaiting\x20payout:\x20','\x20balance\x20updated:'];a35_0x4589=function(){return _0x1917da;};return a35_0x4589();}const database_1=__importDefault(require(a35_0x3ed49f(0xad))),bcryptjs_1=__importDefault(require(a35_0x3ed49f(0x166))),crypto_1=__importDefault(require(a35_0x3ed49f(0xea))),currencyService_1=require(a35_0x3ed49f(0x162));class AdminService{async[a35_0x3ed49f(0x146)](){const _0x3f95c0=a35_0x3ed49f;console['log'](_0x3f95c0(0xd6));const _0x117cdb=await database_1[_0x3f95c0(0xfc)][_0x3f95c0(0xe9)][_0x3f95c0(0x135)]({'_sum':{'balance':!![],'totalPaidOut':!![]},'where':{'status':_0x3f95c0(0xaf)}}),_0x3b7802=new Date(),_0x14cd7f=new Date(_0x3b7802[_0x3f95c0(0x173)](),_0x3b7802['getMonth'](),0x1),_0x57232f=new Date(_0x3b7802[_0x3f95c0(0x173)](),_0x3b7802['getMonth']()+0x1,0x0,0x17,0x3b,0x3b,0x3e7),_0x4a2895=await database_1[_0x3f95c0(0xfc)][_0x3f95c0(0x106)][_0x3f95c0(0x135)]({'_sum':{'amount':!![]},'where':{'createdAt':{'gte':_0x14cd7f,'lte':_0x57232f},'status':_0x3f95c0(0x75)}}),_0x43b357=_0x117cdb[_0x3f95c0(0xf7)][_0x3f95c0(0xf1)]||0x0,_0x79237e=_0x117cdb['_sum'][_0x3f95c0(0xc3)]||0x0,_0x3afe50=_0x4a2895['_sum'][_0x3f95c0(0xcb)]||0x0,_0x1cf0bd={'totalPayout':Math[_0x3f95c0(0x80)](_0x43b357*0x64)/0x64,'awaitingPayout':Math['round'](_0x79237e*0x64)/0x64,'thisMonth':Math[_0x3f95c0(0x80)](_0x3afe50*0x64)/0x64,'availableBalance':Math[_0x3f95c0(0x80)](_0x79237e*0x64)/0x64};return console[_0x3f95c0(0x84)](_0x3f95c0(0xe5)),console['log'](_0x3f95c0(0x73)+_0x1cf0bd[_0x3f95c0(0x177)]+_0x3f95c0(0x133)),console[_0x3f95c0(0x84)](_0x3f95c0(0xb3)+_0x1cf0bd[_0x3f95c0(0x89)]+_0x3f95c0(0x178)),console[_0x3f95c0(0x84)](_0x3f95c0(0x119)+_0x1cf0bd[_0x3f95c0(0x74)]+'\x20USDT\x20(same\x20as\x20awaiting)'),console['log'](_0x3f95c0(0x138)+_0x1cf0bd[_0x3f95c0(0xaa)]+_0x3f95c0(0xd7)),_0x1cf0bd;}async[a35_0x3ed49f(0x172)](_0x532e3,_0x31ff51){const _0xbb1a0c=a35_0x3ed49f;console[_0xbb1a0c(0x84)](_0xbb1a0c(0x112)+_0x532e3+':',_0x31ff51);const _0x161c4e=await database_1[_0xbb1a0c(0xfc)][_0xbb1a0c(0xd4)][_0xbb1a0c(0x12f)]({'where':{'id':_0x532e3},'select':{'id':!![],'customerEmail':!![],'customerName':!![],'customerCountry':!![],'customerIp':!![],'customerUa':!![]}});if(!_0x161c4e)throw new Error(_0xbb1a0c(0xd9));const _0x405da3={};_0x31ff51[_0xbb1a0c(0x7a)]!==undefined&&(_0x405da3[_0xbb1a0c(0x7a)]=_0x31ff51[_0xbb1a0c(0x7a)]||null);_0x31ff51[_0xbb1a0c(0x113)]!==undefined&&(_0x405da3['customerIp']=_0x31ff51[_0xbb1a0c(0x113)]||null);_0x31ff51[_0xbb1a0c(0x12d)]!==undefined&&(_0x405da3[_0xbb1a0c(0x12d)]=_0x31ff51[_0xbb1a0c(0x12d)]||null);const _0x511b22=await database_1[_0xbb1a0c(0xfc)]['payment'][_0xbb1a0c(0x11e)]({'where':{'id':_0x532e3},'data':{..._0x405da3,'updatedAt':new Date()},'select':{'id':!![],'customerEmail':!![],'customerName':!![],'customerCountry':!![],'customerIp':!![],'customerUa':!![],'updatedAt':!![]}});return console[_0xbb1a0c(0x84)](_0xbb1a0c(0x96)+_0x532e3),console[_0xbb1a0c(0x84)](_0xbb1a0c(0x12e)+_0x161c4e[_0xbb1a0c(0x7a)]+'\x20->\x20'+_0x511b22[_0xbb1a0c(0x7a)]),console['log'](_0xbb1a0c(0x169)+_0x161c4e['customerIp']+'\x20->\x20'+_0x511b22['customerIp']),console[_0xbb1a0c(0x84)](_0xbb1a0c(0xfb)+(_0x161c4e[_0xbb1a0c(0x12d)]?_0xbb1a0c(0x8b):'not\x20set')+_0xbb1a0c(0x115)+(_0x511b22[_0xbb1a0c(0x12d)]?'set':_0xbb1a0c(0x8c))),_0x511b22;}async[a35_0x3ed49f(0x90)](_0x32dd96){const _0x62a20b=a35_0x3ed49f,_0x5d2026=new Date();let _0x384ac1;switch(_0x32dd96){case'7d':_0x384ac1=new Date(_0x5d2026[_0x62a20b(0x98)]()-0x7*0x18*0x3c*0x3c*0x3e8);break;case'30d':_0x384ac1=new Date(_0x5d2026['getTime']()-0x1e*0x18*0x3c*0x3c*0x3e8);break;case'90d':_0x384ac1=new Date(_0x5d2026[_0x62a20b(0x98)]()-0x5a*0x18*0x3c*0x3c*0x3e8);break;default:_0x384ac1=new Date(_0x5d2026['getTime']()-0x1e*0x18*0x3c*0x3c*0x3e8);}const [_0x5bae75,_0x203e64,_0x44dece,_0x45ffae,_0x580aec,_0x277739,_0x2d33fd]=await Promise[_0x62a20b(0xab)]([database_1[_0x62a20b(0xfc)]['shop'][_0x62a20b(0x13e)](),database_1[_0x62a20b(0xfc)][_0x62a20b(0xe9)][_0x62a20b(0x13e)]({'where':{'status':_0x62a20b(0xaf)}}),database_1['default'][_0x62a20b(0xd4)][_0x62a20b(0x13e)]({'where':{'createdAt':{'gte':_0x384ac1},'gateway':{'not':'test_gateway'}}}),database_1[_0x62a20b(0xfc)]['payment'][_0x62a20b(0x13e)]({'where':{'status':_0x62a20b(0x7f),'createdAt':{'gte':_0x384ac1},'gateway':{'not':_0x62a20b(0x13d)}}}),database_1['default']['payment'][_0x62a20b(0x174)]({'where':{'status':_0x62a20b(0x7f),'createdAt':{'gte':_0x384ac1},'gateway':{'not':_0x62a20b(0x13d)}},'select':{'amount':!![],'currency':!![],'amountUSDT':!![],'createdAt':!![]}}),database_1[_0x62a20b(0xfc)][_0x62a20b(0xd4)][_0x62a20b(0x174)]({'where':{'gateway':{'not':_0x62a20b(0x13d)}},'take':0xa,'orderBy':{'createdAt':'desc'},'include':{'shop':{'select':{'name':!![],'username':!![]}}}}),database_1[_0x62a20b(0xfc)][_0x62a20b(0xd4)][_0x62a20b(0x174)]({'where':{'createdAt':{'gte':_0x384ac1},'gateway':{'not':_0x62a20b(0x13d)}},'select':{'status':!![],'amountUSDT':!![],'amount':!![],'currency':!![],'createdAt':!![]},'orderBy':{'createdAt':_0x62a20b(0x15d)}})]);let _0x18804f=0x0;for(const _0x545a82 of _0x580aec){if(_0x545a82['amountUSDT'])_0x18804f+=_0x545a82[_0x62a20b(0xa8)];else{const _0x3b5d59=await currencyService_1['currencyService'][_0x62a20b(0x83)](_0x545a82[_0x62a20b(0xcb)],_0x545a82[_0x62a20b(0x10c)]);_0x18804f+=_0x3b5d59;}}console[_0x62a20b(0x84)](_0x62a20b(0x122)+_0x2d33fd[_0x62a20b(0xdc)]+_0x62a20b(0xdf)),console[_0x62a20b(0x84)](_0x62a20b(0x132)+_0x384ac1['toISOString']()[_0x62a20b(0x164)]('T')[0x0]+_0x62a20b(0x95)+_0x5d2026[_0x62a20b(0x9f)]()[_0x62a20b(0x164)]('T')[0x0]);const _0x3759e4=_0x2d33fd[_0x62a20b(0x121)]((_0x1ec48b,_0x352aef)=>{const _0x173ca7=_0x62a20b;return _0x1ec48b[_0x352aef[_0x173ca7(0x10f)]]=(_0x1ec48b[_0x352aef[_0x173ca7(0x10f)]]||0x0)+0x1,_0x1ec48b;},{});console[_0x62a20b(0x84)](_0x62a20b(0x8f),_0x3759e4);const _0x537839=await this['generateDailyStatistics'](_0x2d33fd,_0x384ac1,_0x5d2026),_0x33e020=_0x44dece>0x0?_0x45ffae/_0x44dece*0x64:0x0;return{'totalShops':_0x5bae75,'activeShops':_0x203e64,'totalPayments':_0x44dece,'successfulPayments':_0x45ffae,'totalRevenue':Math[_0x62a20b(0x80)](_0x18804f*0x64)/0x64,'conversionRate':Math[_0x62a20b(0x80)](_0x33e020*0x64)/0x64,'dailyRevenue':_0x537839[_0x62a20b(0xd5)],'dailyPayments':_0x537839['dailyPayments'],'recentPayments':_0x277739[_0x62a20b(0xbc)](_0x1b2086=>({'id':_0x1b2086['id'],'amount':_0x1b2086['amount'],'currency':_0x1b2086[_0x62a20b(0x10c)],'status':_0x1b2086['status'],'gateway':_0x1b2086['gateway'],'shop':_0x1b2086[_0x62a20b(0xe9)],'createdAt':_0x1b2086['createdAt']}))};}async['generateDailyStatistics'](_0x2e2458,_0x426fd7,_0x5a1a0d){const _0x4164cf=a35_0x3ed49f,_0x4b7cfd=new Map(),_0x2c5a12=new Date(_0x426fd7);while(_0x2c5a12<=_0x5a1a0d){const _0x58b16b=_0x2c5a12[_0x4164cf(0x9f)]()[_0x4164cf(0x164)]('T')[0x0];_0x4b7cfd['set'](_0x58b16b,{'revenue':0x0,'count':0x0}),_0x2c5a12[_0x4164cf(0x86)](_0x2c5a12['getDate']()+0x1);}let _0x214000=0x0,_0xa6696e=0x0;for(const _0x593852 of _0x2e2458){const _0x3edb0d=_0x593852[_0x4164cf(0x139)][_0x4164cf(0x9f)]()['split']('T')[0x0],_0xcf2219=_0x4b7cfd['get'](_0x3edb0d);if(_0xcf2219){_0xcf2219['count']+=0x1;if(_0x593852[_0x4164cf(0x10f)]===_0x4164cf(0x7f)){_0x214000++;if(_0x593852[_0x4164cf(0xa8)])_0xcf2219[_0x4164cf(0xdb)]+=_0x593852['amountUSDT'],_0xa6696e+=_0x593852[_0x4164cf(0xa8)],console[_0x4164cf(0x84)](_0x4164cf(0x149)+_0x593852[_0x4164cf(0xa8)]+'\x20USDT\x20for\x20'+_0x3edb0d+'\x20(direct\x20amountUSDT)');else try{const _0x474f85=await currencyService_1[_0x4164cf(0xb6)][_0x4164cf(0x83)](_0x593852[_0x4164cf(0xcb)],_0x593852[_0x4164cf(0x10c)]);_0xcf2219[_0x4164cf(0xdb)]+=_0x474f85,_0xa6696e+=_0x474f85,console[_0x4164cf(0x84)](_0x4164cf(0x129)+_0x593852['amount']+'\x20'+_0x593852[_0x4164cf(0x10c)]+_0x4164cf(0x95)+_0x474f85+_0x4164cf(0x10b)+_0x3edb0d);}catch(_0x1e5dfb){console[_0x4164cf(0x147)](_0x4164cf(0x105)+_0x593852[_0x4164cf(0xcb)]+'\x20'+_0x593852[_0x4164cf(0x10c)]+'\x20for\x20payment\x20on\x20'+_0x3edb0d+':',_0x1e5dfb);}}}}console['log'](_0x4164cf(0x134)+_0x214000+_0x4164cf(0x123)+_0x2e2458[_0x4164cf(0xdc)]+'\x20total'),console[_0x4164cf(0x84)](_0x4164cf(0x15a)+_0xa6696e+'\x20USDT');const _0x107896=[],_0x2858c5=[];for(const [_0x34d1e0,_0x596e6a]of _0x4b7cfd){_0x107896['push']({'date':_0x34d1e0,'amount':Math['round'](_0x596e6a[_0x4164cf(0xdb)]*0x64)/0x64}),_0x2858c5[_0x4164cf(0xc1)]({'date':_0x34d1e0,'count':_0x596e6a[_0x4164cf(0x13e)]});}return{'dailyRevenue':_0x107896,'dailyPayments':_0x2858c5};}async['getMerchantStatistics'](_0x48721d){const _0x4c8c4a=a35_0x3ed49f;console[_0x4c8c4a(0x84)](_0x4c8c4a(0x16f),_0x48721d);let _0x6ae80c,_0x50284f=new Date();if(_0x48721d['period']===_0x4c8c4a(0x17a)&&_0x48721d['dateFrom']&&_0x48721d[_0x4c8c4a(0x12a)])_0x6ae80c=new Date(_0x48721d[_0x4c8c4a(0xba)]),_0x50284f=new Date(_0x48721d['dateTo']);else{const _0x5700cd=new Date();switch(_0x48721d[_0x4c8c4a(0x7c)]){case _0x4c8c4a(0xd0):_0x6ae80c=new Date(_0x5700cd[_0x4c8c4a(0x98)]()-0x7*0x18*0x3c*0x3c*0x3e8);break;case _0x4c8c4a(0x145):_0x6ae80c=new Date(_0x5700cd['getTime']()-0x1e*0x18*0x3c*0x3c*0x3e8);break;case _0x4c8c4a(0x168):_0x6ae80c=new Date(_0x5700cd['getTime']()-0x16d*0x18*0x3c*0x3c*0x3e8);break;case'all':default:_0x6ae80c=new Date('2020-01-01');break;}}console[_0x4c8c4a(0x84)](_0x4c8c4a(0xb9)+_0x6ae80c[_0x4c8c4a(0x9f)]()+_0x4c8c4a(0x95)+_0x50284f['toISOString']());if(_0x48721d['shopId']){const _0x63256b=await database_1[_0x4c8c4a(0xfc)][_0x4c8c4a(0xe9)][_0x4c8c4a(0x12f)]({'where':{'id':_0x48721d['shopId']},'select':{'id':!![],'name':!![],'username':!![],'gatewaySettings':!![]}});console[_0x4c8c4a(0x84)](_0x4c8c4a(0x85)+_0x48721d[_0x4c8c4a(0x8a)]+':'),console[_0x4c8c4a(0x84)](_0x4c8c4a(0x13b)+_0x63256b?.['name']),console['log']('\x20\x20\x20Username:\x20'+_0x63256b?.[_0x4c8c4a(0xde)]),console[_0x4c8c4a(0x84)](_0x4c8c4a(0xf2)+(_0x63256b?.[_0x4c8c4a(0xbf)]||_0x4c8c4a(0x15f)));if(_0x63256b?.[_0x4c8c4a(0xbf)])try{const _0x1262fa=JSON['parse'](_0x63256b[_0x4c8c4a(0xbf)]);console[_0x4c8c4a(0x84)](_0x4c8c4a(0xf4),_0x1262fa),console[_0x4c8c4a(0x84)](_0x4c8c4a(0xb8)+(_0x1262fa[_0x4c8c4a(0xa9)]||'not\x20found'));}catch(_0x1c81aa){console[_0x4c8c4a(0x84)]('\x20\x20\x20Failed\x20to\x20parse\x20gatewaySettings:\x20'+_0x1c81aa);}}const _0x2d53a2={'status':_0x4c8c4a(0x7f),'gateway':{'not':_0x4c8c4a(0x13d)},'paidAt':{'gte':_0x6ae80c,'lte':_0x50284f}};_0x48721d[_0x4c8c4a(0x8a)]&&(_0x2d53a2[_0x4c8c4a(0x8a)]=_0x48721d['shopId']);const _0x56bcc3=await database_1['default'][_0x4c8c4a(0xd4)][_0x4c8c4a(0x174)]({'where':_0x2d53a2,'include':{'shop':{'select':{'id':!![],'name':!![],'username':!![],'gatewaySettings':!![]}}}});console[_0x4c8c4a(0x84)]('💰\x20Found\x20'+_0x56bcc3[_0x4c8c4a(0xdc)]+_0x4c8c4a(0x102));const _0xa68ed5={'gateway':{'not':'test_gateway'},'createdAt':{'gte':_0x6ae80c,'lte':_0x50284f}};_0x48721d[_0x4c8c4a(0x8a)]&&(_0xa68ed5[_0x4c8c4a(0x8a)]=_0x48721d[_0x4c8c4a(0x8a)]);const _0x2e5700=await database_1[_0x4c8c4a(0xfc)]['payment'][_0x4c8c4a(0x13e)]({'where':_0xa68ed5});console['log'](_0x4c8c4a(0xfd)+_0x2e5700),console[_0x4c8c4a(0x84)](_0x4c8c4a(0x153)+_0x56bcc3[_0x4c8c4a(0xdc)]);let _0x5e8c78=0x0,_0x1ebe10=0x0,_0x19f8c7=0x0;const _0xd91b36={},_0x1e62e9={},_0x2da9f0={};for(const _0x5d47e5 of _0x56bcc3){try{const _0x408787=await currencyService_1[_0x4c8c4a(0xb6)][_0x4c8c4a(0x83)](_0x5d47e5[_0x4c8c4a(0xcb)],_0x5d47e5['currency']);let _0x19acf0={};if(_0x5d47e5[_0x4c8c4a(0xe9)][_0x4c8c4a(0xbf)])try{_0x19acf0=JSON['parse'](_0x5d47e5[_0x4c8c4a(0xe9)][_0x4c8c4a(0xbf)]);}catch(_0x4e91ff){console[_0x4c8c4a(0xe0)](_0x4c8c4a(0xec)+_0x5d47e5[_0x4c8c4a(0x8a)]+':',_0x4e91ff);}let _0x212ef6=0xa;const _0x19dde5=Object[_0x4c8c4a(0xca)](_0x19acf0)[_0x4c8c4a(0xe8)](_0x4fbdd8=>_0x4fbdd8[_0x4c8c4a(0xa7)]()===_0x5d47e5[_0x4c8c4a(0x93)]['toLowerCase']());_0x19dde5&&_0x19acf0[_0x19dde5]&&_0x19acf0[_0x19dde5]['commission']&&(_0x212ef6=_0x19acf0[_0x19dde5][_0x4c8c4a(0xa9)]);console[_0x4c8c4a(0x84)](_0x4c8c4a(0x130)+_0x5d47e5['id']+'\x20commission\x20analysis:'),console[_0x4c8c4a(0x84)]('\x20\x20\x20Shop:\x20'+_0x5d47e5[_0x4c8c4a(0xe9)][_0x4c8c4a(0x94)]+'\x20('+_0x5d47e5[_0x4c8c4a(0x8a)]+')'),console[_0x4c8c4a(0x84)]('\x20\x20\x20Gateway:\x20'+_0x5d47e5['gateway']),console[_0x4c8c4a(0x84)]('\x20\x20\x20Raw\x20gatewaySettings:\x20'+(_0x5d47e5[_0x4c8c4a(0xe9)][_0x4c8c4a(0xbf)]||_0x4c8c4a(0x15f))),console[_0x4c8c4a(0x84)](_0x4c8c4a(0xf4),_0x19acf0),console[_0x4c8c4a(0x84)](_0x4c8c4a(0xa4)+(_0x19dde5||_0x4c8c4a(0x148))),console['log'](_0x4c8c4a(0x107)+(_0x19dde5&&_0x19acf0[_0x19dde5]?_0x19acf0[_0x19dde5][_0x4c8c4a(0xa9)]:_0x4c8c4a(0x148))),console[_0x4c8c4a(0x84)]('\x20\x20\x20Final\x20commission\x20used:\x20'+_0x212ef6+'%');const _0x20228b=_0x408787*(_0x212ef6/0x64),_0x2aa071=_0x408787-_0x20228b;_0x5e8c78+=_0x408787,_0x1ebe10+=_0x2aa071,_0x19f8c7+=_0x20228b;!_0xd91b36[_0x5d47e5['gateway']]&&(_0xd91b36[_0x5d47e5[_0x4c8c4a(0x93)]]={'gateway':_0x5d47e5['gateway'],'gatewayDisplayName':this[_0x4c8c4a(0x137)](_0x5d47e5[_0x4c8c4a(0x93)]),'paymentsCount':0x0,'turnoverUSDT':0x0,'commissionUSDT':0x0,'merchantEarningsUSDT':0x0,'totalCommissionRate':0x0});_0xd91b36[_0x5d47e5[_0x4c8c4a(0x93)]]['paymentsCount']++,_0xd91b36[_0x5d47e5[_0x4c8c4a(0x93)]][_0x4c8c4a(0xe2)]+=_0x408787,_0xd91b36[_0x5d47e5[_0x4c8c4a(0x93)]][_0x4c8c4a(0x101)]+=_0x20228b,_0xd91b36[_0x5d47e5[_0x4c8c4a(0x93)]][_0x4c8c4a(0x124)]+=_0x2aa071,_0xd91b36[_0x5d47e5[_0x4c8c4a(0x93)]][_0x4c8c4a(0xfa)]+=_0x212ef6;!_0x48721d[_0x4c8c4a(0x8a)]&&(!_0x1e62e9[_0x5d47e5[_0x4c8c4a(0x8a)]]&&(_0x1e62e9[_0x5d47e5[_0x4c8c4a(0x8a)]]={'shopId':_0x5d47e5['shopId'],'shopName':_0x5d47e5[_0x4c8c4a(0xe9)][_0x4c8c4a(0x94)],'shopUsername':_0x5d47e5[_0x4c8c4a(0xe9)][_0x4c8c4a(0xde)],'paymentsCount':0x0,'turnoverUSDT':0x0,'commissionUSDT':0x0,'merchantEarningsUSDT':0x0,'paidOutUSDT':0x0,'averageCheckUSDT':0x0}),_0x1e62e9[_0x5d47e5['shopId']][_0x4c8c4a(0x16e)]++,_0x1e62e9[_0x5d47e5['shopId']][_0x4c8c4a(0xe2)]+=_0x408787,_0x1e62e9[_0x5d47e5[_0x4c8c4a(0x8a)]][_0x4c8c4a(0x101)]+=_0x20228b,_0x1e62e9[_0x5d47e5[_0x4c8c4a(0x8a)]][_0x4c8c4a(0x124)]+=_0x2aa071);const _0x22c75e=_0x5d47e5[_0x4c8c4a(0x136)][_0x4c8c4a(0x9f)]()[_0x4c8c4a(0x164)]('T')[0x0];!_0x2da9f0[_0x22c75e]&&(_0x2da9f0[_0x22c75e]={'date':_0x22c75e,'turnover':0x0,'merchantEarnings':0x0,'gatewayEarnings':0x0,'paymentsCount':0x0}),_0x2da9f0[_0x22c75e]['turnover']+=_0x408787,_0x2da9f0[_0x22c75e][_0x4c8c4a(0xac)]+=_0x2aa071,_0x2da9f0[_0x22c75e][_0x4c8c4a(0x77)]+=_0x20228b,_0x2da9f0[_0x22c75e][_0x4c8c4a(0x16e)]++;}catch(_0x4e74bd){console['error'](_0x4c8c4a(0x99)+_0x5d47e5['id']+':',_0x4e74bd);}}Object[_0x4c8c4a(0x97)](_0xd91b36)[_0x4c8c4a(0x9a)](_0x4bcc94=>{const _0x4bdc2c=_0x4c8c4a;_0x4bcc94[_0x4bdc2c(0xcf)]=_0x4bcc94[_0x4bdc2c(0x16e)]>0x0?_0x4bcc94['totalCommissionRate']/_0x4bcc94[_0x4bdc2c(0x16e)]:0x0,delete _0x4bcc94[_0x4bdc2c(0xfa)];}),Object['values'](_0x1e62e9)[_0x4c8c4a(0x9a)](_0x2e96e8=>{const _0x2cdc9c=_0x4c8c4a;_0x2e96e8[_0x2cdc9c(0x7d)]=_0x2e96e8[_0x2cdc9c(0x16e)]>0x0?_0x2e96e8[_0x2cdc9c(0xe2)]/_0x2e96e8[_0x2cdc9c(0x16e)]:0x0;});let _0x1303c6=0x0;if(_0x48721d[_0x4c8c4a(0x8a)]){const _0x3d09b0=await database_1[_0x4c8c4a(0xfc)][_0x4c8c4a(0x106)][_0x4c8c4a(0x174)]({'where':{'shopId':_0x48721d[_0x4c8c4a(0x8a)],'status':'COMPLETED','createdAt':{'gte':_0x6ae80c,'lte':_0x50284f}},'select':{'amount':!![]}});_0x1303c6=_0x3d09b0[_0x4c8c4a(0x121)]((_0x56963d,_0xf46091)=>_0x56963d+_0xf46091[_0x4c8c4a(0xcb)],0x0);}const _0x196778=_0x2e5700,_0x2075d3=_0x56bcc3[_0x4c8c4a(0xdc)],_0x277dbd=_0x2075d3>0x0?_0x5e8c78/_0x2075d3:0x0,_0x19f0bc=_0x196778>0x0?_0x2075d3/_0x196778*0x64:0x0;console['log'](_0x4c8c4a(0x14e)),console[_0x4c8c4a(0x84)](_0x4c8c4a(0x142)+_0x196778),console['log'](_0x4c8c4a(0x167)+_0x2075d3),console['log'](_0x4c8c4a(0x14b)+_0x19f0bc[_0x4c8c4a(0x76)](0x2)+'%');const _0x574be9=Math['ceil']((_0x50284f[_0x4c8c4a(0x98)]()-_0x6ae80c[_0x4c8c4a(0x98)]())/(0x3e8*0x3c*0x3c*0x18)),_0x281e56={'totalTurnover':Math[_0x4c8c4a(0x80)](_0x5e8c78*0x64)/0x64,'merchantEarnings':Math[_0x4c8c4a(0x80)](_0x1ebe10*0x64)/0x64,'gatewayEarnings':Math['round'](_0x19f8c7*0x64)/0x64,'totalPaidOut':Math[_0x4c8c4a(0x80)](_0x1303c6*0x64)/0x64,'averageCheck':Math[_0x4c8c4a(0x80)](_0x277dbd*0x64)/0x64,'totalPayments':_0x196778,'successfulPayments':_0x2075d3,'conversionRate':Math[_0x4c8c4a(0x80)](_0x19f0bc*0x64)/0x64,'gatewayBreakdown':Object[_0x4c8c4a(0x97)](_0xd91b36)[_0x4c8c4a(0xbc)](_0x9c41e0=>({..._0x9c41e0,'turnoverUSDT':Math[_0x4c8c4a(0x80)](_0x9c41e0[_0x4c8c4a(0xe2)]*0x64)/0x64,'commissionUSDT':Math[_0x4c8c4a(0x80)](_0x9c41e0[_0x4c8c4a(0x101)]*0x64)/0x64,'merchantEarningsUSDT':Math[_0x4c8c4a(0x80)](_0x9c41e0[_0x4c8c4a(0x124)]*0x64)/0x64,'averageCommissionRate':Math['round'](_0x9c41e0[_0x4c8c4a(0xcf)]*0x64)/0x64})),'merchantBreakdown':_0x48721d['shopId']?undefined:Object['values'](_0x1e62e9)[_0x4c8c4a(0xbc)](_0x99a513=>({..._0x99a513,'turnoverUSDT':Math[_0x4c8c4a(0x80)](_0x99a513[_0x4c8c4a(0xe2)]*0x64)/0x64,'commissionUSDT':Math[_0x4c8c4a(0x80)](_0x99a513[_0x4c8c4a(0x101)]*0x64)/0x64,'merchantEarningsUSDT':Math[_0x4c8c4a(0x80)](_0x99a513[_0x4c8c4a(0x124)]*0x64)/0x64,'paidOutUSDT':Math['round'](_0x99a513[_0x4c8c4a(0xbe)]*0x64)/0x64,'averageCheckUSDT':Math['round'](_0x99a513[_0x4c8c4a(0x7d)]*0x64)/0x64})),'dailyData':Object['values'](_0x2da9f0)[_0x4c8c4a(0xbc)](_0x23a837=>({..._0x23a837,'turnover':Math[_0x4c8c4a(0x80)](_0x23a837['turnover']*0x64)/0x64,'merchantEarnings':Math[_0x4c8c4a(0x80)](_0x23a837[_0x4c8c4a(0xac)]*0x64)/0x64,'gatewayEarnings':Math[_0x4c8c4a(0x80)](_0x23a837[_0x4c8c4a(0x77)]*0x64)/0x64}))[_0x4c8c4a(0x79)]((_0xa53d0b,_0x5401ed)=>_0xa53d0b[_0x4c8c4a(0x161)]['localeCompare'](_0x5401ed['date'])),'periodInfo':{'from':_0x6ae80c,'to':_0x50284f,'periodType':_0x48721d[_0x4c8c4a(0x7c)]||_0x4c8c4a(0x17a),'daysCount':_0x574be9}};return console[_0x4c8c4a(0x84)]('📊\x20Merchant\x20statistics\x20calculated:'),console[_0x4c8c4a(0x84)](_0x4c8c4a(0x71)+_0x281e56[_0x4c8c4a(0xd8)]+_0x4c8c4a(0xd7)),console[_0x4c8c4a(0x84)](_0x4c8c4a(0xe3)+_0x281e56[_0x4c8c4a(0xac)]+'\x20USDT'),console[_0x4c8c4a(0x84)](_0x4c8c4a(0x10a)+_0x281e56[_0x4c8c4a(0x77)]+_0x4c8c4a(0xd7)),console[_0x4c8c4a(0x84)]('\x20\x20\x20📊\x20Total\x20payments:\x20'+_0x281e56[_0x4c8c4a(0x9d)]),console[_0x4c8c4a(0x84)](_0x4c8c4a(0x10e)+_0x281e56[_0x4c8c4a(0x111)]),console[_0x4c8c4a(0x84)](_0x4c8c4a(0x176)+_0x281e56['conversionRate']+'%'),_0x281e56;}[a35_0x3ed49f(0x137)](_0x278c4a){const _0x312016=a35_0x3ed49f,_0x430d5c={'test_gateway':'Test\x20Gateway','plisio':_0x312016(0xeb),'rapyd':_0x312016(0x140),'noda':_0x312016(0x117),'cointopay':_0x312016(0x151),'klyme_eu':'KLYME\x20EU','klyme_gb':_0x312016(0x114),'klyme_de':'KLYME\x20DE'};return _0x430d5c[_0x278c4a]||_0x278c4a;}async[a35_0x3ed49f(0xb2)](_0x233662){const _0x553c89=a35_0x3ed49f,{page:_0x55c6bc,limit:_0x257c23,minAmount:_0x5c8921,search:_0x365973}=_0x233662,_0x3fc809=(_0x55c6bc-0x1)*_0x257c23;console['log'](_0x553c89(0xc9),_0x233662);const _0x486833={'balance':{'gt':0x0},'status':'ACTIVE'};_0x5c8921&&(_0x486833['balance'][_0x553c89(0xa5)]=_0x5c8921);_0x365973&&(_0x486833['OR']=[{'name':{'contains':_0x365973,'mode':_0x553c89(0xf8)}},{'username':{'contains':_0x365973,'mode':'insensitive'}}]);const [_0x2a0e78,_0x606ba1]=await Promise['all']([database_1[_0x553c89(0xfc)][_0x553c89(0xe9)][_0x553c89(0x174)]({'where':_0x486833,'skip':_0x3fc809,'take':_0x257c23,'orderBy':{'balance':_0x553c89(0x155)},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'balance':!![],'totalPaidOut':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'createdAt':!![]}}),database_1['default'][_0x553c89(0xe9)]['count']({'where':_0x486833})]);console[_0x553c89(0x84)](_0x553c89(0x11f)+_0x2a0e78['length']+_0x553c89(0xbb));const _0x5743d7=await Promise[_0x553c89(0xab)](_0x2a0e78[_0x553c89(0xbc)](async _0xff1937=>{const _0x37cb0f=_0x553c89,[_0x28c808,_0x50e352,_0x16e25f]=await Promise[_0x37cb0f(0xab)]([database_1[_0x37cb0f(0xfc)]['payment'][_0x37cb0f(0x13e)]({'where':{'shopId':_0xff1937['id'],'status':_0x37cb0f(0x7f),'amountUSDT':{'not':null}}}),database_1[_0x37cb0f(0xfc)][_0x37cb0f(0xd4)]['findFirst']({'where':{'shopId':_0xff1937['id'],'status':_0x37cb0f(0x7f),'amountUSDT':{'not':null}},'orderBy':{'paidAt':_0x37cb0f(0x15d)},'select':{'paidAt':!![]}}),database_1[_0x37cb0f(0xfc)][_0x37cb0f(0xd4)][_0x37cb0f(0x14d)]({'by':[_0x37cb0f(0x93)],'where':{'shopId':_0xff1937['id'],'status':_0x37cb0f(0x7f),'amountUSDT':{'not':null}},'_count':{'id':!![]},'_sum':{'amountUSDT':!![]}})]),_0x4fbec8=_0x16e25f[_0x37cb0f(0xbc)](_0xc24742=>({'gateway':_0xc24742['gateway'],'count':_0xc24742[_0x37cb0f(0xfe)]['id'],'amountUSDT':_0xc24742[_0x37cb0f(0xf7)]['amountUSDT']||0x0,'amountAfterCommissionUSDT':_0xc24742[_0x37cb0f(0xf7)][_0x37cb0f(0xa8)]||0x0,'commission':0x0}));return{'id':_0xff1937['id'],'fullName':_0xff1937[_0x37cb0f(0x94)],'username':_0xff1937[_0x37cb0f(0xde)],'telegramId':_0xff1937[_0x37cb0f(0xff)],'merchantUrl':_0xff1937[_0x37cb0f(0x14a)],'wallets':{'usdtPolygonWallet':_0xff1937[_0x37cb0f(0x11d)],'usdtTrcWallet':_0xff1937[_0x37cb0f(0x8d)],'usdtErcWallet':_0xff1937['usdtErcWallet'],'usdcPolygonWallet':_0xff1937[_0x37cb0f(0x13a)]},'totalAmountUSDT':_0xff1937['balance'],'totalAmountAfterCommissionUSDT':_0xff1937['balance'],'paymentsCount':_0x28c808,'oldestPaymentDate':_0x50e352?.[_0x37cb0f(0x136)]||_0xff1937[_0x37cb0f(0x139)],'gatewayBreakdown':_0x4fbec8};})),_0x2a9758=_0x2a0e78[_0x553c89(0x121)]((_0x9c7d1b,_0x2d9936)=>_0x9c7d1b+_0x2d9936[_0x553c89(0xc3)],0x0),_0xe67c69=_0x2a9758;return console['log'](_0x553c89(0xf9)+_0x606ba1+_0x553c89(0x120)+Math[_0x553c89(0x80)](_0xe67c69*0x64)/0x64+'\x20USDT\x20total'),{'merchants':_0x5743d7,'pagination':{'page':_0x55c6bc,'limit':_0x257c23,'total':_0x606ba1,'totalPages':Math[_0x553c89(0x108)](_0x606ba1/_0x257c23)},'summary':{'totalMerchants':_0x606ba1,'totalAmountUSDT':Math[_0x553c89(0x80)](_0x2a9758*0x64)/0x64,'totalAmountAfterCommissionUSDT':Math['round'](_0xe67c69*0x64)/0x64}};}async[a35_0x3ed49f(0x103)](_0x108d6a){const _0x4bd5ca=a35_0x3ed49f,{shopId:_0x2fb796,amount:_0x7d6fc4,network:_0x1f25a1,notes:_0x2627be,periodFrom:_0x3762ff,periodTo:_0x5a00a3}=_0x108d6a,_0x4b9c99=await database_1[_0x4bd5ca(0xfc)][_0x4bd5ca(0x15b)](async _0x2ff50e=>{const _0x3dc354=_0x4bd5ca,_0x44c868=await _0x2ff50e[_0x3dc354(0xe9)][_0x3dc354(0x12f)]({'where':{'id':_0x2fb796},'select':{'id':!![],'name':!![],'username':!![],'balance':!![],'totalPaidOut':!![]}});if(!_0x44c868)throw new Error('Shop\x20not\x20found');console[_0x3dc354(0x84)](_0x3dc354(0x91)+_0x44c868['username']+':'),console['log'](_0x3dc354(0x109)+_0x44c868['balance']['toFixed'](0x6)+'\x20USDT'),console[_0x3dc354(0x84)](_0x3dc354(0xa2)+_0x7d6fc4[_0x3dc354(0x76)](0x6)+_0x3dc354(0xd7)),console[_0x3dc354(0x84)](_0x3dc354(0x159)+_0x44c868[_0x3dc354(0xf1)][_0x3dc354(0x76)](0x6)+_0x3dc354(0xd7));if(_0x44c868[_0x3dc354(0xc3)]<_0x7d6fc4)throw new Error(_0x3dc354(0x104)+_0x44c868[_0x3dc354(0xc3)][_0x3dc354(0x76)](0x6)+_0x3dc354(0xc7)+_0x7d6fc4[_0x3dc354(0x76)](0x6)+_0x3dc354(0xd7));const _0x5b7aa1=await _0x2ff50e[_0x3dc354(0x106)][_0x3dc354(0xd2)]({'data':{'shopId':_0x2fb796,'amount':_0x7d6fc4,'network':_0x1f25a1,'status':'COMPLETED','notes':_0x2627be,'periodFrom':_0x3762ff?new Date(_0x3762ff):null,'periodTo':_0x5a00a3?new Date(_0x5a00a3):null,'createdAt':new Date(),'paidAt':new Date()}}),_0x8f976a=_0x44c868[_0x3dc354(0xc3)]-_0x7d6fc4,_0xe90ce1=_0x44c868['totalPaidOut']+_0x7d6fc4;return await _0x2ff50e['shop'][_0x3dc354(0x11e)]({'where':{'id':_0x2fb796},'data':{'balance':_0x8f976a,'totalPaidOut':_0xe90ce1}}),console[_0x3dc354(0x84)]('💰\x20Shop\x20'+_0x44c868[_0x3dc354(0xde)]+_0x3dc354(0xb4)),console['log'](_0x3dc354(0x163)+_0x44c868[_0x3dc354(0xc3)][_0x3dc354(0x76)](0x6)+_0x3dc354(0x115)+_0x8f976a[_0x3dc354(0x76)](0x6)+_0x3dc354(0xbd)+_0x7d6fc4[_0x3dc354(0x76)](0x6)+')'),console[_0x3dc354(0x84)](_0x3dc354(0xf0)+_0x44c868['totalPaidOut'][_0x3dc354(0x76)](0x6)+_0x3dc354(0x115)+_0xe90ce1[_0x3dc354(0x76)](0x6)+_0x3dc354(0x154)+_0x7d6fc4['toFixed'](0x6)+')'),{'payout':_0x5b7aa1,'shop':_0x44c868};});return console[_0x4bd5ca(0x84)](_0x4bd5ca(0x118)+_0x4b9c99[_0x4bd5ca(0x106)]['id']+_0x4bd5ca(0xa6)+_0x4b9c99['shop'][_0x4bd5ca(0xde)]+'\x20('+_0x7d6fc4+_0x4bd5ca(0x9e)),{'id':_0x4b9c99[_0x4bd5ca(0x106)]['id'],'shopId':_0x4b9c99[_0x4bd5ca(0x106)][_0x4bd5ca(0x8a)],'shopName':_0x4b9c99[_0x4bd5ca(0xe9)][_0x4bd5ca(0x94)],'shopUsername':_0x4b9c99[_0x4bd5ca(0xe9)][_0x4bd5ca(0xde)],'amount':_0x4b9c99['payout']['amount'],'network':_0x4b9c99['payout']['network'],'status':_0x4b9c99[_0x4bd5ca(0x106)][_0x4bd5ca(0x10f)],'txid':_0x4b9c99[_0x4bd5ca(0x106)][_0x4bd5ca(0xf5)],'notes':_0x4b9c99[_0x4bd5ca(0x106)][_0x4bd5ca(0xc6)],'periodFrom':_0x4b9c99['payout'][_0x4bd5ca(0x14f)],'periodTo':_0x4b9c99[_0x4bd5ca(0x106)][_0x4bd5ca(0xe6)],'createdAt':_0x4b9c99[_0x4bd5ca(0x106)][_0x4bd5ca(0x139)],'paidAt':_0x4b9c99[_0x4bd5ca(0x106)][_0x4bd5ca(0x136)]};}async['getAllPayouts'](_0x2cdc89){const _0x95b910=a35_0x3ed49f,{page:_0x89af61,limit:_0x1fc69d,shopId:_0x4bb881,network:_0x515dd5,dateFrom:_0x29f00d,dateTo:_0x10baee,search:_0x57c053}=_0x2cdc89,_0x235765=(_0x89af61-0x1)*_0x1fc69d,_0x597959={};_0x4bb881&&(_0x597959[_0x95b910(0x8a)]=_0x4bb881);_0x515dd5&&(_0x597959[_0x95b910(0xa3)]=_0x515dd5);(_0x29f00d||_0x10baee)&&(_0x597959[_0x95b910(0x139)]={},_0x29f00d&&(_0x597959[_0x95b910(0x139)][_0x95b910(0xa5)]=new Date(_0x29f00d)),_0x10baee&&(_0x597959[_0x95b910(0x139)][_0x95b910(0xef)]=new Date(_0x10baee)));_0x57c053&&(_0x597959['OR']=[{'shop':{'name':{'contains':_0x57c053,'mode':_0x95b910(0xf8)}}},{'shop':{'username':{'contains':_0x57c053,'mode':_0x95b910(0xf8)}}},{'notes':{'contains':_0x57c053,'mode':_0x95b910(0xf8)}}]);const [_0x1e3593,_0x4f8ea7]=await Promise['all']([database_1[_0x95b910(0xfc)][_0x95b910(0x106)][_0x95b910(0x174)]({'where':_0x597959,'skip':_0x235765,'take':_0x1fc69d,'orderBy':{'createdAt':_0x95b910(0x155)},'include':{'shop':{'select':{'name':!![],'username':!![]}}}}),database_1[_0x95b910(0xfc)][_0x95b910(0x106)][_0x95b910(0x13e)]({'where':_0x597959})]);return{'payouts':_0x1e3593[_0x95b910(0xbc)](_0x876dec=>({'id':_0x876dec['id'],'shopId':_0x876dec[_0x95b910(0x8a)],'shopName':_0x876dec[_0x95b910(0xe9)][_0x95b910(0x94)],'shopUsername':_0x876dec[_0x95b910(0xe9)][_0x95b910(0xde)],'amount':_0x876dec[_0x95b910(0xcb)],'network':_0x876dec[_0x95b910(0xa3)],'status':_0x876dec[_0x95b910(0x10f)],'txid':_0x876dec[_0x95b910(0xf5)],'notes':_0x876dec[_0x95b910(0xc6)],'periodFrom':_0x876dec[_0x95b910(0x14f)],'periodTo':_0x876dec['periodTo'],'createdAt':_0x876dec['createdAt'],'paidAt':_0x876dec[_0x95b910(0x136)]})),'pagination':{'page':_0x89af61,'limit':_0x1fc69d,'total':_0x4f8ea7,'totalPages':Math[_0x95b910(0x108)](_0x4f8ea7/_0x1fc69d)}};}async[a35_0x3ed49f(0x143)](_0x2e3e1b){const _0x3051c5=a35_0x3ed49f,_0x13d78b=await database_1[_0x3051c5(0xfc)][_0x3051c5(0x106)][_0x3051c5(0x12f)]({'where':{'id':_0x2e3e1b},'include':{'shop':{'select':{'name':!![],'username':!![]}}}});if(!_0x13d78b)return null;return{'id':_0x13d78b['id'],'shopId':_0x13d78b[_0x3051c5(0x8a)],'shopName':_0x13d78b[_0x3051c5(0xe9)][_0x3051c5(0x94)],'shopUsername':_0x13d78b[_0x3051c5(0xe9)]['username'],'amount':_0x13d78b[_0x3051c5(0xcb)],'network':_0x13d78b[_0x3051c5(0xa3)],'status':_0x13d78b[_0x3051c5(0x10f)],'txid':_0x13d78b[_0x3051c5(0xf5)],'notes':_0x13d78b[_0x3051c5(0xc6)],'periodFrom':_0x13d78b[_0x3051c5(0x14f)],'periodTo':_0x13d78b['periodTo'],'createdAt':_0x13d78b[_0x3051c5(0x139)],'paidAt':_0x13d78b[_0x3051c5(0x136)]};}async[a35_0x3ed49f(0x10d)](_0x12bde8){const _0x431917=a35_0x3ed49f;await database_1['default'][_0x431917(0x106)][_0x431917(0xda)]({'where':{'id':_0x12bde8}});}async[a35_0x3ed49f(0xae)](_0xa44124){const _0x2d056f=a35_0x3ed49f,{page:_0x51d22e,limit:_0x5a8b1d,status:_0x561ac7,gateway:_0x411610,shopId:_0x2bc2e6,dateFrom:_0x211a0a,dateTo:_0x2fa18d,search:_0x1a80d0}=_0xa44124,_0xf98d7b=(_0x51d22e-0x1)*_0x5a8b1d,_0x4f3527={};_0x561ac7&&(_0x4f3527[_0x2d056f(0x10f)]=_0x561ac7[_0x2d056f(0x13f)]());_0x411610&&(_0x4f3527[_0x2d056f(0x93)]=_0x411610[_0x2d056f(0xa7)]());_0x4f3527[_0x2d056f(0x93)]=_0x4f3527[_0x2d056f(0x93)]?_0x4f3527[_0x2d056f(0x93)]:{'not':_0x2d056f(0x13d)};if(typeof _0x4f3527[_0x2d056f(0x93)]===_0x2d056f(0xc8)&&_0x4f3527[_0x2d056f(0x93)]!==_0x2d056f(0x13d)){}else{if(typeof _0x4f3527['gateway']===_0x2d056f(0xc8)&&_0x4f3527[_0x2d056f(0x93)]===_0x2d056f(0x13d)){}else _0x4f3527['gateway']={'not':_0x2d056f(0x13d)};}_0x2bc2e6&&(_0x4f3527[_0x2d056f(0x8a)]=_0x2bc2e6);(_0x211a0a||_0x2fa18d)&&(_0x4f3527[_0x2d056f(0x139)]={},_0x211a0a&&(_0x4f3527[_0x2d056f(0x139)][_0x2d056f(0xa5)]=new Date(_0x211a0a)),_0x2fa18d&&(_0x4f3527['createdAt'][_0x2d056f(0xef)]=new Date(_0x2fa18d)));_0x1a80d0&&(_0x4f3527['OR']=[{'orderId':{'contains':_0x1a80d0,'mode':_0x2d056f(0xf8)}},{'gatewayOrderId':{'contains':_0x1a80d0,'mode':'insensitive'}},{'customerEmail':{'contains':_0x1a80d0,'mode':'insensitive'}},{'shop':{'name':{'contains':_0x1a80d0,'mode':_0x2d056f(0xf8)}}},{'shop':{'username':{'contains':_0x1a80d0,'mode':_0x2d056f(0xf8)}}}]);const [_0x19999d,_0x45f3c3]=await Promise['all']([database_1['default'][_0x2d056f(0xd4)][_0x2d056f(0x174)]({'where':_0x4f3527,'skip':_0xf98d7b,'take':_0x5a8b1d,'orderBy':{'createdAt':_0x2d056f(0x155)},'include':{'shop':{'select':{'name':!![],'username':!![]}}}}),database_1[_0x2d056f(0xfc)][_0x2d056f(0xd4)][_0x2d056f(0x13e)]({'where':_0x4f3527})]);return{'payments':_0x19999d[_0x2d056f(0xbc)](_0x4c5c18=>({'id':_0x4c5c18['id'],'shopId':_0x4c5c18[_0x2d056f(0x8a)],'gateway':_0x4c5c18['gateway'],'amount':_0x4c5c18[_0x2d056f(0xcb)],'currency':_0x4c5c18[_0x2d056f(0x10c)],'status':_0x4c5c18[_0x2d056f(0x10f)],'orderId':_0x4c5c18[_0x2d056f(0x170)],'gatewayOrderId':_0x4c5c18['gatewayOrderId'],'customerEmail':_0x4c5c18['customerEmail'],'customerName':_0x4c5c18[_0x2d056f(0x13c)],'customerCountry':_0x4c5c18[_0x2d056f(0x7a)],'customerIp':_0x4c5c18['customerIp'],'customerUa':_0x4c5c18[_0x2d056f(0x12d)],'failureMessage':_0x4c5c18[_0x2d056f(0x16d)],'cardLast4':_0x4c5c18[_0x2d056f(0xa1)],'paymentMethod':_0x4c5c18[_0x2d056f(0x11a)],'bankId':_0x4c5c18[_0x2d056f(0xe7)],'remitterIban':_0x4c5c18[_0x2d056f(0x82)],'remitterName':_0x4c5c18[_0x2d056f(0x16c)],'txUrls':_0x4c5c18['txUrls'],'createdAt':_0x4c5c18[_0x2d056f(0x139)],'updatedAt':_0x4c5c18['updatedAt'],'shop':_0x4c5c18[_0x2d056f(0xe9)]})),'pagination':{'page':_0x51d22e,'limit':_0x5a8b1d,'total':_0x45f3c3,'totalPages':Math[_0x2d056f(0x108)](_0x45f3c3/_0x5a8b1d)}};}async[a35_0x3ed49f(0xc0)](_0x150444){const _0x2549fc=a35_0x3ed49f,_0x360e76=await database_1[_0x2549fc(0xfc)]['payment']['findUnique']({'where':{'id':_0x150444},'include':{'shop':{'select':{'name':!![],'username':!![]}}}});if(!_0x360e76)return null;return{'id':_0x360e76['id'],'shopId':_0x360e76[_0x2549fc(0x8a)],'gateway':_0x360e76[_0x2549fc(0x93)],'amount':_0x360e76[_0x2549fc(0xcb)],'currency':_0x360e76['currency'],'status':_0x360e76[_0x2549fc(0x10f)],'orderId':_0x360e76[_0x2549fc(0x170)],'gatewayOrderId':_0x360e76[_0x2549fc(0x144)],'customerEmail':_0x360e76[_0x2549fc(0x175)],'customerName':_0x360e76[_0x2549fc(0x13c)],'customerCountry':_0x360e76['customerCountry'],'customerIp':_0x360e76[_0x2549fc(0x113)],'customerUa':_0x360e76[_0x2549fc(0x12d)],'failureMessage':_0x360e76[_0x2549fc(0x16d)],'externalPaymentUrl':_0x360e76[_0x2549fc(0x110)],'successUrl':_0x360e76[_0x2549fc(0x156)],'failUrl':_0x360e76[_0x2549fc(0x125)],'pendingUrl':_0x360e76[_0x2549fc(0x81)],'whiteUrl':_0x360e76[_0x2549fc(0xc2)],'cardLast4':_0x360e76[_0x2549fc(0xa1)],'paymentMethod':_0x360e76['paymentMethod'],'bankId':_0x360e76[_0x2549fc(0xe7)],'remitterIban':_0x360e76[_0x2549fc(0x82)],'remitterName':_0x360e76['remitterName'],'txUrls':_0x360e76['txUrls'],'createdAt':_0x360e76[_0x2549fc(0x139)],'updatedAt':_0x360e76[_0x2549fc(0x160)],'shop':_0x360e76[_0x2549fc(0xe9)]};}async[a35_0x3ed49f(0xcd)](_0x5c9a88,_0x3aa78c,_0x3c63b0,_0x52a5d3){const _0x6f1000=a35_0x3ed49f,_0x561e6f=await database_1[_0x6f1000(0xfc)][_0x6f1000(0x15b)](async _0x715c60=>{const _0x1154b7=_0x6f1000,_0x51aa02=await _0x715c60['payment'][_0x1154b7(0x12f)]({'where':{'id':_0x5c9a88},'include':{'shop':{'select':{'id':!![],'name':!![],'username':!![],'balance':!![]}}}});if(!_0x51aa02)throw new Error(_0x1154b7(0xd9));const _0x5e653a=_0x51aa02[_0x1154b7(0x10f)],_0x5952ff=_0x3aa78c[_0x1154b7(0x13f)]();console[_0x1154b7(0x84)]('🔄\x20Admin\x20updating\x20payment\x20'+_0x5c9a88+_0x1154b7(0x179)+_0x5e653a+_0x1154b7(0x115)+_0x5952ff),console['log']('💰\x20Current\x20shop\x20balance:\x20'+_0x51aa02['shop']['balance']+_0x1154b7(0xd7));const _0x19b189={'status':_0x5952ff,'updatedAt':new Date(),'statusChangedBy':_0x1154b7(0xb5),'statusChangedAt':new Date()};_0x3c63b0&&(_0x19b189[_0x1154b7(0xb1)]=_0x3c63b0);_0x5952ff==='CHARGEBACK'&&_0x52a5d3&&(_0x19b189[_0x1154b7(0x72)]=_0x52a5d3);let _0x363e20=0x0,_0x1369db=_0x51aa02['shop'][_0x1154b7(0xc3)];if(_0x5952ff==='PAID'&&_0x5e653a!==_0x1154b7(0x7f)){_0x19b189['paidAt']=new Date();const _0x13f829=await currencyService_1[_0x1154b7(0xb6)][_0x1154b7(0x83)](_0x51aa02[_0x1154b7(0xcb)],_0x51aa02[_0x1154b7(0x10c)]);_0x19b189[_0x1154b7(0xa8)]=_0x13f829,_0x363e20=_0x13f829,_0x1369db+=_0x13f829,console[_0x1154b7(0x84)](_0x1154b7(0x171)+_0x5c9a88+_0x1154b7(0x158)+_0x13f829[_0x1154b7(0x76)](0x6)+'\x20USDT\x20to\x20balance');}else _0x5e653a===_0x1154b7(0x7f)&&_0x5952ff!=='PAID'&&(_0x51aa02[_0x1154b7(0xa8)]&&(_0x363e20=-_0x51aa02['amountUSDT'],_0x1369db-=_0x51aa02[_0x1154b7(0xa8)],_0x19b189[_0x1154b7(0xa8)]=null,console[_0x1154b7(0x84)](_0x1154b7(0x171)+_0x5c9a88+_0x1154b7(0x15e)+_0x51aa02[_0x1154b7(0xa8)]['toFixed'](0x6)+_0x1154b7(0x11c))));if(_0x5952ff===_0x1154b7(0xf6)){if(_0x5e653a===_0x1154b7(0x7f)&&_0x51aa02[_0x1154b7(0xa8)]){}_0x52a5d3&&_0x52a5d3>0x0&&(_0x363e20-=_0x52a5d3,_0x1369db-=_0x52a5d3,console['log'](_0x1154b7(0x12c)+_0x52a5d3[_0x1154b7(0x76)](0x6)+'\x20USDT\x20from\x20balance'));}_0x5952ff===_0x1154b7(0x78)&&_0x5e653a===_0x1154b7(0x7f)&&console['log'](_0x1154b7(0x11b));const _0x578367=await _0x715c60['payment'][_0x1154b7(0x11e)]({'where':{'id':_0x5c9a88},'data':_0x19b189,'include':{'shop':{'select':{'name':!![],'username':!![]}}}});return _0x363e20!==0x0&&(await _0x715c60[_0x1154b7(0xe9)][_0x1154b7(0x11e)]({'where':{'id':_0x51aa02[_0x1154b7(0x8a)]},'data':{'balance':_0x1369db}}),console['log'](_0x1154b7(0xb7)+_0x51aa02[_0x1154b7(0x8a)]+_0x1154b7(0x131)+_0x51aa02[_0x1154b7(0xe9)][_0x1154b7(0xc3)]['toFixed'](0x6)+'\x20->\x20'+_0x1369db[_0x1154b7(0x76)](0x6)+'\x20USDT\x20('+(_0x363e20>0x0?'+':'')+_0x363e20['toFixed'](0x6)+')')),_0x578367;});return{'id':_0x561e6f['id'],'shopId':_0x561e6f[_0x6f1000(0x8a)],'gateway':_0x561e6f['gateway'],'amount':_0x561e6f[_0x6f1000(0xcb)],'currency':_0x561e6f['currency'],'status':_0x561e6f['status'],'orderId':_0x561e6f[_0x6f1000(0x170)],'gatewayOrderId':_0x561e6f[_0x6f1000(0x144)],'customerEmail':_0x561e6f[_0x6f1000(0x175)],'customerName':_0x561e6f['customerName'],'customerCountry':_0x561e6f[_0x6f1000(0x7a)],'customerIp':_0x561e6f['customerIp'],'customerUa':_0x561e6f[_0x6f1000(0x12d)],'failureMessage':_0x561e6f[_0x6f1000(0x16d)],'adminNotes':_0x561e6f['adminNotes'],'chargebackAmount':_0x561e6f[_0x6f1000(0x72)],'statusChangedBy':_0x561e6f['statusChangedBy'],'statusChangedAt':_0x561e6f[_0x6f1000(0xce)],'createdAt':_0x561e6f[_0x6f1000(0x139)],'updatedAt':_0x561e6f[_0x6f1000(0x160)],'shop':_0x561e6f[_0x6f1000(0xe9)]};}async['updateUser'](_0x314523,_0x41515f){const _0x4aa354=a35_0x3ed49f,_0x3c0fd3={..._0x41515f};_0x41515f['password']&&(_0x3c0fd3['password']=await bcryptjs_1[_0x4aa354(0xfc)]['hash'](_0x41515f[_0x4aa354(0x15c)],0xc));_0x41515f[_0x4aa354(0x157)]&&(_0x3c0fd3[_0x4aa354(0x94)]=_0x41515f[_0x4aa354(0x157)],delete _0x3c0fd3[_0x4aa354(0x157)]);_0x41515f[_0x4aa354(0x141)]&&(_0x3c0fd3[_0x4aa354(0xff)]=_0x41515f[_0x4aa354(0x141)],delete _0x3c0fd3['telegramId']);_0x41515f[_0x4aa354(0x92)]&&(_0x3c0fd3['shopUrl']=_0x41515f[_0x4aa354(0x92)],delete _0x3c0fd3['merchantUrl']);_0x41515f[_0x4aa354(0x14c)]&&(_0x3c0fd3['paymentGateways']=JSON[_0x4aa354(0xe1)](_0x41515f[_0x4aa354(0x14c)]),delete _0x3c0fd3[_0x4aa354(0x14c)]);_0x41515f[_0x4aa354(0xbf)]&&(_0x3c0fd3[_0x4aa354(0xbf)]=JSON[_0x4aa354(0xe1)](_0x41515f[_0x4aa354(0xbf)]),delete _0x3c0fd3[_0x4aa354(0xbf)]);_0x41515f[_0x4aa354(0xa0)]&&(_0x41515f[_0x4aa354(0xa0)][_0x4aa354(0x11d)]!==undefined&&(_0x3c0fd3[_0x4aa354(0x11d)]=_0x41515f[_0x4aa354(0xa0)][_0x4aa354(0x11d)]||null),_0x41515f[_0x4aa354(0xa0)][_0x4aa354(0x8d)]!==undefined&&(_0x3c0fd3['usdtTrcWallet']=_0x41515f[_0x4aa354(0xa0)][_0x4aa354(0x8d)]||null),_0x41515f['wallets'][_0x4aa354(0x7b)]!==undefined&&(_0x3c0fd3[_0x4aa354(0x7b)]=_0x41515f['wallets'][_0x4aa354(0x7b)]||null),_0x41515f[_0x4aa354(0xa0)][_0x4aa354(0x13a)]!==undefined&&(_0x3c0fd3[_0x4aa354(0x13a)]=_0x41515f['wallets'][_0x4aa354(0x13a)]||null),delete _0x3c0fd3['wallets']);const _0x442fc1=await database_1[_0x4aa354(0xfc)][_0x4aa354(0xe9)]['update']({'where':{'id':_0x314523},'data':_0x3c0fd3,'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});return{'id':_0x442fc1['id'],'fullName':_0x442fc1[_0x4aa354(0x94)],'username':_0x442fc1[_0x4aa354(0xde)],'telegramId':_0x442fc1['telegram'],'merchantUrl':_0x442fc1[_0x4aa354(0x14a)],'gateways':_0x442fc1[_0x4aa354(0xdd)]?JSON['parse'](_0x442fc1['paymentGateways']):null,'gatewaySettings':_0x442fc1[_0x4aa354(0xbf)]?JSON[_0x4aa354(0x87)](_0x442fc1['gatewaySettings']):null,'publicKey':_0x442fc1['publicKey'],'wallets':{'usdtPolygonWallet':_0x442fc1[_0x4aa354(0x11d)],'usdtTrcWallet':_0x442fc1[_0x4aa354(0x8d)],'usdtErcWallet':_0x442fc1[_0x4aa354(0x7b)],'usdcPolygonWallet':_0x442fc1[_0x4aa354(0x13a)]},'status':_0x442fc1[_0x4aa354(0x10f)],'createdAt':_0x442fc1[_0x4aa354(0x139)]};}async[a35_0x3ed49f(0x116)](_0x2ea87d){const _0x1021aa=a35_0x3ed49f,_0x2706fe=await database_1[_0x1021aa(0xfc)][_0x1021aa(0xe9)][_0x1021aa(0x11e)]({'where':{'id':_0x2ea87d},'data':{'status':'SUSPENDED'},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});return{'id':_0x2706fe['id'],'fullName':_0x2706fe[_0x1021aa(0x94)],'username':_0x2706fe['username'],'telegramId':_0x2706fe[_0x1021aa(0xff)],'merchantUrl':_0x2706fe['shopUrl'],'gateways':_0x2706fe[_0x1021aa(0xdd)]?JSON[_0x1021aa(0x87)](_0x2706fe[_0x1021aa(0xdd)]):null,'gatewaySettings':_0x2706fe['gatewaySettings']?JSON[_0x1021aa(0x87)](_0x2706fe[_0x1021aa(0xbf)]):null,'publicKey':_0x2706fe['publicKey'],'wallets':{'usdtPolygonWallet':_0x2706fe['usdtPolygonWallet'],'usdtTrcWallet':_0x2706fe[_0x1021aa(0x8d)],'usdtErcWallet':_0x2706fe[_0x1021aa(0x7b)],'usdcPolygonWallet':_0x2706fe[_0x1021aa(0x13a)]},'status':_0x2706fe[_0x1021aa(0x10f)],'createdAt':_0x2706fe[_0x1021aa(0x139)]};}async[a35_0x3ed49f(0x8e)](_0x31addb){const _0x44c435=a35_0x3ed49f,_0x8cf82c=await database_1[_0x44c435(0xfc)][_0x44c435(0xe9)][_0x44c435(0x11e)]({'where':{'id':_0x31addb},'data':{'status':_0x44c435(0xaf)},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});return{'id':_0x8cf82c['id'],'fullName':_0x8cf82c['name'],'username':_0x8cf82c[_0x44c435(0xde)],'telegramId':_0x8cf82c[_0x44c435(0xff)],'merchantUrl':_0x8cf82c[_0x44c435(0x14a)],'gateways':_0x8cf82c[_0x44c435(0xdd)]?JSON[_0x44c435(0x87)](_0x8cf82c[_0x44c435(0xdd)]):null,'gatewaySettings':_0x8cf82c[_0x44c435(0xbf)]?JSON['parse'](_0x8cf82c['gatewaySettings']):null,'publicKey':_0x8cf82c[_0x44c435(0x7e)],'wallets':{'usdtPolygonWallet':_0x8cf82c[_0x44c435(0x11d)],'usdtTrcWallet':_0x8cf82c[_0x44c435(0x8d)],'usdtErcWallet':_0x8cf82c[_0x44c435(0x7b)],'usdcPolygonWallet':_0x8cf82c[_0x44c435(0x13a)]},'status':_0x8cf82c[_0x44c435(0x10f)],'createdAt':_0x8cf82c['createdAt']};}async[a35_0x3ed49f(0x12b)](_0x1184c1){const _0x451188=a35_0x3ed49f,{page:_0x2a96fe,limit:_0x10aee4,status:_0x39c553}=_0x1184c1,_0x313a2b=(_0x2a96fe-0x1)*_0x10aee4,_0x4607e4={};_0x39c553&&(_0x4607e4['status']=_0x39c553[_0x451188(0x13f)]());const [_0x199699,_0x2634c3]=await Promise['all']([database_1[_0x451188(0xfc)][_0x451188(0xe9)]['findMany']({'where':_0x4607e4,'skip':_0x313a2b,'take':_0x10aee4,'orderBy':{'createdAt':_0x451188(0x155)},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}}),database_1[_0x451188(0xfc)][_0x451188(0xe9)][_0x451188(0x13e)]({'where':_0x4607e4})]);return{'users':_0x199699['map'](_0x190470=>({'id':_0x190470['id'],'fullName':_0x190470[_0x451188(0x94)],'username':_0x190470[_0x451188(0xde)],'telegramId':_0x190470['telegram'],'merchantUrl':_0x190470[_0x451188(0x14a)],'gateways':_0x190470['paymentGateways']?JSON[_0x451188(0x87)](_0x190470['paymentGateways']):null,'gatewaySettings':_0x190470[_0x451188(0xbf)]?JSON[_0x451188(0x87)](_0x190470[_0x451188(0xbf)]):null,'publicKey':_0x190470['publicKey'],'wallets':{'usdtPolygonWallet':_0x190470[_0x451188(0x11d)],'usdtTrcWallet':_0x190470[_0x451188(0x8d)],'usdtErcWallet':_0x190470[_0x451188(0x7b)],'usdcPolygonWallet':_0x190470[_0x451188(0x13a)]},'status':_0x190470[_0x451188(0x10f)],'createdAt':_0x190470[_0x451188(0x139)]})),'pagination':{'page':_0x2a96fe,'limit':_0x10aee4,'total':_0x2634c3,'totalPages':Math['ceil'](_0x2634c3/_0x10aee4)}};}async['getUserById'](_0x413dc4){const _0x21126f=a35_0x3ed49f,_0x5e24bf=await database_1[_0x21126f(0xfc)][_0x21126f(0xe9)][_0x21126f(0x12f)]({'where':{'id':_0x413dc4},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});if(!_0x5e24bf)return null;return{'id':_0x5e24bf['id'],'fullName':_0x5e24bf[_0x21126f(0x94)],'username':_0x5e24bf[_0x21126f(0xde)],'telegramId':_0x5e24bf[_0x21126f(0xff)],'merchantUrl':_0x5e24bf[_0x21126f(0x14a)],'gateways':_0x5e24bf['paymentGateways']?JSON[_0x21126f(0x87)](_0x5e24bf[_0x21126f(0xdd)]):null,'gatewaySettings':_0x5e24bf[_0x21126f(0xbf)]?JSON[_0x21126f(0x87)](_0x5e24bf[_0x21126f(0xbf)]):null,'publicKey':_0x5e24bf[_0x21126f(0x7e)],'wallets':{'usdtPolygonWallet':_0x5e24bf[_0x21126f(0x11d)],'usdtTrcWallet':_0x5e24bf[_0x21126f(0x8d)],'usdtErcWallet':_0x5e24bf[_0x21126f(0x7b)],'usdcPolygonWallet':_0x5e24bf[_0x21126f(0x13a)]},'status':_0x5e24bf[_0x21126f(0x10f)],'createdAt':_0x5e24bf['createdAt']};}async[a35_0x3ed49f(0x9b)](_0x2cd0d9){const _0x8e5a2b=a35_0x3ed49f,{fullName:_0x249274,username:_0x5f5bfa,password:_0x2f20a1,telegramId:_0x3417e2,merchantUrl:_0x101a4d,gateways:_0x160f1d,gatewaySettings:_0x41130b,wallets:_0xc587ca}=_0x2cd0d9,_0x184fce=await database_1[_0x8e5a2b(0xfc)][_0x8e5a2b(0xe9)]['findUnique']({'where':{'username':_0x5f5bfa}});if(_0x184fce)throw new Error('Username\x20already\x20exists');if(_0x3417e2){const _0x5dcdea=await database_1['default'][_0x8e5a2b(0xe9)][_0x8e5a2b(0x12f)]({'where':{'telegram':_0x3417e2}});if(_0x5dcdea)throw new Error(_0x8e5a2b(0xcc));}const _0x2218c9=await bcryptjs_1[_0x8e5a2b(0xfc)][_0x8e5a2b(0x88)](_0x2f20a1,0xc),_0x3d01eb='pk_'+crypto_1['default']['randomBytes'](0x20)[_0x8e5a2b(0x100)]('hex'),_0x3d88a5=_0x8e5a2b(0x16b)+crypto_1[_0x8e5a2b(0xfc)]['randomBytes'](0x20)['toString'](_0x8e5a2b(0x165)),_0x29bb1f=await database_1[_0x8e5a2b(0xfc)][_0x8e5a2b(0xe9)][_0x8e5a2b(0xd2)]({'data':{'name':_0x249274,'username':_0x5f5bfa,'password':_0x2218c9,'telegram':_0x3417e2,'shopUrl':_0x101a4d,'paymentGateways':_0x160f1d?JSON['stringify'](_0x160f1d):null,'gatewaySettings':_0x41130b?JSON['stringify'](_0x41130b):null,'usdtPolygonWallet':_0xc587ca?.[_0x8e5a2b(0x11d)]||null,'usdtTrcWallet':_0xc587ca?.['usdtTrcWallet']||null,'usdtErcWallet':_0xc587ca?.['usdtErcWallet']||null,'usdcPolygonWallet':_0xc587ca?.[_0x8e5a2b(0x13a)]||null,'publicKey':_0x3d01eb,'secretKey':_0x3d88a5,'status':_0x8e5a2b(0xaf)},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});return{'id':_0x29bb1f['id'],'fullName':_0x29bb1f[_0x8e5a2b(0x94)],'username':_0x29bb1f[_0x8e5a2b(0xde)],'telegramId':_0x29bb1f[_0x8e5a2b(0xff)],'merchantUrl':_0x29bb1f[_0x8e5a2b(0x14a)],'gateways':_0x29bb1f['paymentGateways']?JSON[_0x8e5a2b(0x87)](_0x29bb1f['paymentGateways']):null,'gatewaySettings':_0x29bb1f[_0x8e5a2b(0xbf)]?JSON[_0x8e5a2b(0x87)](_0x29bb1f[_0x8e5a2b(0xbf)]):null,'publicKey':_0x29bb1f['publicKey'],'wallets':{'usdtPolygonWallet':_0x29bb1f[_0x8e5a2b(0x11d)],'usdtTrcWallet':_0x29bb1f[_0x8e5a2b(0x8d)],'usdtErcWallet':_0x29bb1f[_0x8e5a2b(0x7b)],'usdcPolygonWallet':_0x29bb1f['usdcPolygonWallet']},'status':_0x29bb1f[_0x8e5a2b(0x10f)],'createdAt':_0x29bb1f[_0x8e5a2b(0x139)]};}async[a35_0x3ed49f(0x128)](_0x4a03ff){const _0x1af354=a35_0x3ed49f;await database_1[_0x1af354(0xfc)][_0x1af354(0xe9)][_0x1af354(0xda)]({'where':{'id':_0x4a03ff}});}async[a35_0x3ed49f(0xee)](_0x24b9e6){const _0x593361=a35_0x3ed49f,_0xec9c26={};_0x24b9e6&&[_0x593361(0xaf),_0x593361(0xd1),'SUSPENDED'][_0x593361(0x70)](_0x24b9e6['toUpperCase']())&&(_0xec9c26[_0x593361(0x10f)]=_0x24b9e6['toUpperCase']());const _0x4a4ef4=await database_1[_0x593361(0xfc)]['shop'][_0x593361(0x174)]({'where':_0xec9c26,'select':{'id':!![],'username':!![],'name':!![]},'orderBy':{'name':'asc'}});return _0x4a4ef4;}}exports['AdminService']=AdminService;