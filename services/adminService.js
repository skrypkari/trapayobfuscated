'use strict';function a35_0x1850(_0x4efa5c,_0x1afcaa){const _0x5c884b=a35_0x5c88();return a35_0x1850=function(_0x1850d3,_0x24b49d){_0x1850d3=_0x1850d3-0x1e9;let _0x4229ec=_0x5c884b[_0x1850d3];return _0x4229ec;},a35_0x1850(_0x4efa5c,_0x1afcaa);}const a35_0x2100e6=a35_0x1850;function a35_0x5c88(){const _0x1345b0=['insensitive','\x20in\x20','customerUa','gte','lte','telegram','password','activateUser','üîÑ\x20Gateway\x20mapping\x20(get):','noda','\x20USDT\x20(total\x20paid\x20to\x20merchants)','KLYME\x20DE','getDate','\x20\x20\x20ÔøΩüìä\x20Total\x20payments:\x20',',\x20successful:\x20','toUpperCase','paidOutUSDT','Telegram\x20username\x20already\x20exists','updatePaymentStatus','pendingUrl','adminNotes','\x27\x20(from\x20\x27','CHARGEBACK','findMany','getDay','txid','0000','revenue','publicKey',']\x20Gateway\x20settings\x20JSON\x20string:','\x20\x20\x20ÔøΩ\x20Total\x20payments\x20turnover:\x20','shop','\x20\x20\x20Current\x20total\x20paid\x20out:\x20','\x20\x20\x20üìÖ\x20This\x20month:\x20','usdtErcWallet','\x20USDT\x20from\x20balance','\x20\x20\x20üåç\x20Country:\x20','createUser','customerName','Shop\x20not\x20found',']\x20Updating\x20password\x20for\x20user\x20','deleteUser','delete','merchantUrl','getPayoutById','paymentsCount','1RurRmK','polygon','\x20USDT','\x20\x20\x20üìä\x20Commission\x20difference:\x20','shopId','totalTurnover','‚ö†Ô∏è\x20Requested\x20gateway\x20\x27','üîÑ\x20Converted\x20gateway\x20ID\x20\x27','\x20USDT\x20(after\x20','convertToUSDT','thisMonth','month','\x20\x20\x20Gateway:\x20','\x20\x20\x20‚úÖ\x20Total\x20available\x20for\x20payout:\x20','üîÑ\x20Gateway\x20mapping:','\x20USDT,\x20Requested:\x20','merchantEarningsUSDT','30d','turnover','\x20\x20\x20Payout\x20amount:\x20','paymentGateways','66bMivUY','\x20USDT\x20for\x20payment\x20','findUnique','üîê\x20[','amountAfterGatewayCommissionUSDT','Test\x20Gateway','log','commission','19357mUUgDn','payment','customerIp','üéØ\x20updateUser\x20called\x20with\x20ID:\x20','getMerchantStatistics','values','‚úÖ\x20Using\x20gateway\x20filter:\x20\x27','default','length','28107XWGfYY','getMerchantsSelection','\x20\x20\x20üí∞\x20Total\x20payout:\x20','\x20\x20\x20ÔøΩ\x20Total\x20paid\x20out:\x20','update','join','getGatewayInternalName','\x20balance\x20updated:','ceil','getPaymentById','pk_','forEach',',\x20userId:\x20','üí∞\x20Payment\x20','gatewaySettings','dateFrom','getUserById','updatedAt','includes','‚úÖ\x20Customer\x20data\x20updated\x20for\x20payment\x20','üîß\x20[','\x20\x20\x20üíµ\x20Available\x20balance:\x20','random','toString','16wFNmfp','\x20\x20\x20üîç\x20Raw\x20balance\x20sum:\x20','\x20active\x20merchants\x20for\x20selection','some','AdminService','toFixed','amountAfterCommissionUSDT','localeCompare','üéØ\x20[','\x20\x20\x20üí∞\x20Total\x20payments\x20turnover:\x20','üîÑ\x20Admin\x20updating\x20payment\x20','\x20PAID\x20payments','‚ö†Ô∏è\x20Payment\x20','usdcPolygonWallet','hex','notes','\x20\x20\x20Balance:\x20','üí∞\x20[PAYOUT]\x20Merchant\x20','period','\x20\x20\x20üåê\x20IP:\x20','\x20merchants','CoinToPay','REFUND','toLowerCase','custom','2110dCElrJ','üìä\x20Merchant\x20statistics\x20calculated:','../config/database','commissionUSDT','\x20\x20\x20üí≥\x20Total\x20payments:\x20','split','payout','\x20USDT\x20(without\x20commission)','whiteUrl','\x20\x20\x20üìÖ\x20Total\x20payouts\x20(this\x20month):\x20','currencyService','wallets','updateUser','getGatewayNameById',']\x20Password\x20not\x20provided\x20or\x20empty,\x20skipping\x20password\x20update','Payment\x20not\x20found','414891WYzUhI','\x20paid\x20payments\x20for\x20analysis','year','getFullYear','not\x20set','\x20missing\x20amountUSDT,\x20using\x20fallback\x20conversion','üìÖ\x20Period\x20\x27all\x27:\x20Using\x20start\x20date\x20from\x20first\x20payment:\x20','MasterCard','PAID','194474fvznTr','9173758fbnCNK','defineProperty','successUrl','totalPayout','\x20status:\x20','COMPLETED','üìä\x20Merchants\x20awaiting\x20payout:\x20','klyme_gb','generateDailyStatistics','periodFrom','get','90d','getTime','averageCheckUSDT','\x20\x20\x20Merchant\x20loses:\x20','../types/gateway','count','amountUSDT','randomBytes','__importDefault','gateway','üìä\x20Available\x20gateways\x20in\x20database:','chargebackAmount','üìä\x20Getting\x20merchants\x20awaiting\x20payout\x20with\x20filters:','statusChangedAt','Error\x20parsing\x20gateway\x20settings\x20for\x20payment\x20',']\x20User\x20updated,\x20gatewaySettings\x20from\x20DB:','üìä\x20Final\x20WHERE\x20conditions:','üîÑ\x20REFUND:\x20Payment\x20amount\x20already\x20deducted\x20from\x20balance','aggregate','createdAt','failureMessage','entries','orderId','üìä\x20Getting\x20merchant\x20statistics\x20with\x20filters:','\x20\x20\x20üë§\x20Merchant\x20earnings:\x20','üí∏\x20CHARGEBACK\x20penalty:\x20-','./currencyService','\x27\x20not\x20found.\x20Available\x20gateways:\x20','crypto','üìä\x20[ADMIN]\x20Calculating\x20commission\x20manually\x20for\x20payment\x20','getMonth','72dHYFhT','cointopay2','%\x20commission)','_count','\x20USDT\x20(after\x20payouts)',']\x20Gateway\x20settings\x20before\x20saving:','name','\x20became\x20PAID:','push','customerCountry','\x20for\x20shop\x20','üìä\x20Payout\x20statistics\x20calculated:','üîç\x20Using\x20gateway\x20\x27','cointopay','toISOString','error','üí∞\x20Creating\x20payout\x20for\x20shop\x20','externalPaymentUrl','setDate','merchantEarnings','currency','balance','KLYME\x20EU','\x27\x20as\x20is\x20(not\x20found\x20in\x20mappings)','SUSPENDED','statusChangedBy','805452yvWfWX','fullName','Open\x20Banking\x202','usdtTrcWallet','\x20USDT\x20(+','üìä\x20Calculating\x20payout\x20statistics...','test_gateway','dailyRevenue','totalAmountAfterCommissionUSDT','üí∞\x20Shop\x20','\x20USDT\x20(','round','status','üìã\x20Found\x20','üí∞\x20[PAYOUT]\x20Gateway\x20','üîÑ\x20Converted\x20gateway\x20name\x20\x27','amount','erc20','getAllPayouts','gatewayEarnings','all','\x20order','groupBy','asc','desc','%\x20from\x20','totalPaidOut','turnoverUSDT','\x20\x20\x20Merchant\x20gets:\x20','set','\x20->\x20','‚úÖ\x20Payout\x20created:\x20','\x20payments)','mastercard','\x20USDT\x20(-','telegramId','klyme_de',',\x20Commission:\x20','‚ö†Ô∏è\x20Gateway\x20\x27','shopUrl','\x20USDT)','parse','awaitingPayout','network','trc20','\x20to\x20','reduce','usdtPolygonWallet','Insufficient\x20balance.\x20Available:\x20','getAllUsers','pendingPayout','dailyPayments','\x27\x20->\x20name\x20\x27','üí∞\x20Found\x20','üí∞\x20Current\x20shop\x20balance:\x20','date','__esModule','üîÑ\x20Updating\x20customer\x20data\x20for\x20payment\x20','\x20\x20\x20Transaction\x20hash:\x20','22716znzcJg','\x20\x20\x20üè™\x20Gateway\x20earnings:\x20','totalCommissionRate','_sum','totalPayments','stringify','üìä\x20Total\x20payments\x20(including\x20failed):\x20','\x20\x20\x20üîç\x20Calculated\x20after\x20commission:\x20','username','\x20USDT\x20(with\x20commission\x20deducted)','klyme_eu','gateways','create','$transaction','Noda','Error\x20parsing\x20gateway\x20settings\x20for\x20shop\x20','getGatewayDisplayName','rapyd','getMerchantsAwaitingPayout','bcryptjs','ACTIVE','hash','\x27\x20to\x20name\x20\x27','Rapyd','dateTo','gatewayOrderId','week','PENDING','Username\x20already\x20exists','findFirst','paidAt','\x20USDT\x20(actual\x20balances)','253465RGvxhW','\x20\x20\x20üí∞\x20Total\x20turnover:\x20','2020-01-01','map','plisio','üîÑ\x20Gateway\x20mapping\x20(create):','customerEmail','availableBalance','averageCommissionRate','NONEXISTENT_GATEWAY_FILTER','periodTo','updateCustomerData','\x20\x20\x20Added\x20to\x20balance:\x20+','setHours'];a35_0x5c88=function(){return _0x1345b0;};return a35_0x5c88();}(function(_0x15ca2d,_0x4dda37){const _0x1a10bf=a35_0x1850,_0x3c480e=_0x15ca2d();while(!![]){try{const _0x522d8a=-parseInt(_0x1a10bf(0x23a))/0x1*(-parseInt(_0x1a10bf(0x2ef))/0x2)+-parseInt(_0x1a10bf(0x2a1))/0x3*(-parseInt(_0x1a10bf(0x278))/0x4)+parseInt(_0x1a10bf(0x1fe))/0x5*(parseInt(_0x1a10bf(0x24f))/0x6)+-parseInt(_0x1a10bf(0x2aa))/0x7*(-parseInt(_0x1a10bf(0x2d5))/0x8)+parseInt(_0x1a10bf(0x260))/0x9*(parseInt(_0x1a10bf(0x291))/0xa)+parseInt(_0x1a10bf(0x2ab))/0xb+parseInt(_0x1a10bf(0x32a))/0xc*(-parseInt(_0x1a10bf(0x257))/0xd);if(_0x522d8a===_0x4dda37)break;else _0x3c480e['push'](_0x3c480e['shift']());}catch(_0x4658ea){_0x3c480e['push'](_0x3c480e['shift']());}}}(a35_0x5c88,0x6ae45));var __importDefault=this&&this[a35_0x2100e6(0x2be)]||function(_0x166040){const _0x319d1d=a35_0x2100e6;return _0x166040&&_0x166040[_0x319d1d(0x327)]?_0x166040:{'default':_0x166040};};Object[a35_0x2100e6(0x2ac)](exports,'__esModule',{'value':!![]}),exports['AdminService']=void 0x0;const database_1=__importDefault(require(a35_0x2100e6(0x293))),bcryptjs_1=__importDefault(require(a35_0x2100e6(0x1f1))),crypto_1=__importDefault(require(a35_0x2100e6(0x2d2))),currencyService_1=require(a35_0x2100e6(0x2d0)),gateway_1=require(a35_0x2100e6(0x2ba));class AdminService{async['getPayoutStats'](){const _0x314932=a35_0x2100e6;console['log'](_0x314932(0x2f4));const _0x2934be=await database_1[_0x314932(0x25e)][_0x314932(0x22b)][_0x314932(0x2c8)]({'_sum':{'balance':!![],'totalPaidOut':!![]},'where':{'status':_0x314932(0x1f2)}}),_0x45637e=await this[_0x314932(0x1f0)]({'page':0x1,'limit':0x3e8}),_0x1d5397=await database_1[_0x314932(0x25e)][_0x314932(0x258)][_0x314932(0x2bb)]({'where':{'status':'PAID','gateway':{'not':_0x314932(0x2f5)}}}),_0x38f62e=new Date(),_0x19b15f=new Date(_0x38f62e['getFullYear'](),_0x38f62e[_0x314932(0x2d4)](),0x1),_0x3a709c=new Date(_0x38f62e['getFullYear'](),_0x38f62e[_0x314932(0x2d4)]()+0x1,0x0,0x17,0x3b,0x3b,0x3e7),_0x469856=await database_1[_0x314932(0x25e)][_0x314932(0x297)]['aggregate']({'_sum':{'amount':!![]},'where':{'createdAt':{'gte':_0x19b15f,'lte':_0x3a709c},'status':'COMPLETED'}}),_0x3699e=_0x2934be['_sum'][_0x314932(0x309)]||0x0,_0x8982b9=_0x45637e['summary'][_0x314932(0x2f7)],_0xa4d30c=_0x469856[_0x314932(0x32d)]['amount']||0x0,_0x39aab7={'totalPayout':Math['round'](_0x3699e*0x64)/0x64,'awaitingPayout':Math[_0x314932(0x2fa)](_0x8982b9*0x64)/0x64,'thisMonth':Math[_0x314932(0x2fa)](_0xa4d30c*0x64)/0x64,'availableBalance':Math[_0x314932(0x2fa)](_0x8982b9*0x64)/0x64,'totalPayments':_0x1d5397};return console[_0x314932(0x255)](_0x314932(0x2e0)),console['log'](_0x314932(0x262)+_0x39aab7[_0x314932(0x2ae)]+_0x314932(0x216)),console['log']('\x20\x20\x20‚è≥\x20Awaiting\x20payout:\x20'+_0x39aab7[_0x314932(0x319)]+_0x314932(0x333)),console[_0x314932(0x255)](_0x314932(0x275)+_0x39aab7[_0x314932(0x205)]+'\x20USDT\x20(same\x20as\x20awaiting)'),console[_0x314932(0x255)](_0x314932(0x22d)+_0x39aab7[_0x314932(0x244)]+_0x314932(0x23c)),console[_0x314932(0x255)](_0x314932(0x295)+_0x39aab7[_0x314932(0x32e)]+_0x314932(0x283)),console[_0x314932(0x255)](_0x314932(0x279)+(_0x2934be[_0x314932(0x32d)][_0x314932(0x2ea)]||0x0)[_0x314932(0x27d)](0x2)+_0x314932(0x298)),console['log'](_0x314932(0x23d)+((_0x2934be[_0x314932(0x32d)][_0x314932(0x2ea)]||0x0)-_0x8982b9)['toFixed'](0x2)+_0x314932(0x23c)),_0x39aab7;}async[a35_0x2100e6(0x209)](_0x959552,_0x32a34a){const _0x2341ae=a35_0x2100e6;console[_0x2341ae(0x255)](_0x2341ae(0x328)+_0x959552+':',_0x32a34a);const _0x1ea26b=await database_1[_0x2341ae(0x25e)]['payment']['findUnique']({'where':{'id':_0x959552},'select':{'id':!![],'customerEmail':!![],'customerName':!![],'customerCountry':!![],'customerIp':!![],'customerUa':!![]}});if(!_0x1ea26b)throw new Error(_0x2341ae(0x2a0));const _0x2e6b1e={};_0x32a34a[_0x2341ae(0x2de)]!==undefined&&(_0x2e6b1e[_0x2341ae(0x2de)]=_0x32a34a[_0x2341ae(0x2de)]||null);_0x32a34a[_0x2341ae(0x259)]!==undefined&&(_0x2e6b1e[_0x2341ae(0x259)]=_0x32a34a[_0x2341ae(0x259)]||null);_0x32a34a[_0x2341ae(0x20e)]!==undefined&&(_0x2e6b1e[_0x2341ae(0x20e)]=_0x32a34a['customerUa']||null);const _0x3f526b=await database_1[_0x2341ae(0x25e)][_0x2341ae(0x258)][_0x2341ae(0x264)]({'where':{'id':_0x959552},'data':{..._0x2e6b1e,'updatedAt':new Date()},'select':{'id':!![],'customerEmail':!![],'customerName':!![],'customerCountry':!![],'customerIp':!![],'customerUa':!![],'updatedAt':!![]}});return console[_0x2341ae(0x255)](_0x2341ae(0x273)+_0x959552),console[_0x2341ae(0x255)](_0x2341ae(0x230)+_0x1ea26b['customerCountry']+'\x20->\x20'+_0x3f526b[_0x2341ae(0x2de)]),console[_0x2341ae(0x255)](_0x2341ae(0x28b)+_0x1ea26b['customerIp']+'\x20->\x20'+_0x3f526b['customerIp']),console[_0x2341ae(0x255)]('\x20\x20\x20üñ•Ô∏è\x20User\x20Agent:\x20'+(_0x1ea26b[_0x2341ae(0x20e)]?_0x2341ae(0x30c):_0x2341ae(0x2a5))+'\x20->\x20'+(_0x3f526b[_0x2341ae(0x20e)]?'set':_0x2341ae(0x2a5))),_0x3f526b;}async['getSystemStatistics'](_0x10c095){const _0x57bea9=a35_0x2100e6,_0x2d929e=new Date();let _0x517c49;switch(_0x10c095){case'7d':_0x517c49=new Date(_0x2d929e[_0x57bea9(0x2b7)]()-0x7*0x18*0x3c*0x3c*0x3e8);break;case _0x57bea9(0x24b):_0x517c49=new Date(_0x2d929e['getTime']()-0x1e*0x18*0x3c*0x3c*0x3e8);break;case _0x57bea9(0x2b6):_0x517c49=new Date(_0x2d929e['getTime']()-0x5a*0x18*0x3c*0x3c*0x3e8);break;case _0x57bea9(0x303):const _0x4c7b48=await database_1[_0x57bea9(0x25e)][_0x57bea9(0x258)][_0x57bea9(0x1fb)]({'where':{'gateway':{'not':_0x57bea9(0x2f5)}},'orderBy':{'createdAt':_0x57bea9(0x306)},'select':{'createdAt':!![]}});_0x517c49=_0x4c7b48?_0x4c7b48[_0x57bea9(0x2c9)]:new Date(_0x57bea9(0x200)),console['log'](_0x57bea9(0x2a7)+_0x517c49[_0x57bea9(0x2e3)]());break;default:_0x517c49=new Date(_0x2d929e['getTime']()-0x1e*0x18*0x3c*0x3c*0x3e8);}const [_0x33502d,_0x301b51,_0x582bd8,_0x5d516a,_0x5d697f,_0x3039b5,_0x1da05a]=await Promise[_0x57bea9(0x303)]([database_1['default'][_0x57bea9(0x22b)]['count'](),database_1['default'][_0x57bea9(0x22b)][_0x57bea9(0x2bb)]({'where':{'status':'ACTIVE'}}),database_1['default'][_0x57bea9(0x258)][_0x57bea9(0x2bb)]({'where':{'createdAt':{'gte':_0x517c49},'gateway':{'not':_0x57bea9(0x2f5)}}}),database_1[_0x57bea9(0x25e)]['payment'][_0x57bea9(0x2bb)]({'where':{'status':_0x57bea9(0x2a9),'createdAt':{'gte':_0x517c49},'gateway':{'not':_0x57bea9(0x2f5)}}}),database_1['default'][_0x57bea9(0x258)][_0x57bea9(0x223)]({'where':{'status':_0x57bea9(0x2a9),'createdAt':{'gte':_0x517c49},'gateway':{'not':_0x57bea9(0x2f5)}},'select':{'amount':!![],'currency':!![]}}),database_1[_0x57bea9(0x25e)]['payment'][_0x57bea9(0x223)]({'where':{'gateway':{'not':_0x57bea9(0x2f5)}},'take':0xa,'orderBy':{'createdAt':'desc'},'include':{'shop':{'select':{'name':!![],'username':!![]}}}}),database_1['default'][_0x57bea9(0x258)][_0x57bea9(0x223)]({'where':{'createdAt':{'gte':_0x517c49},'gateway':{'not':'test_gateway'}},'select':{'amount':!![],'currency':!![],'status':!![],'amountUSDT':!![],'createdAt':!![]}})]);let _0x2ac320=0x0;for(const _0xd8e6b5 of _0x5d697f){const _0x5f5295=await currencyService_1[_0x57bea9(0x29b)][_0x57bea9(0x243)](_0xd8e6b5[_0x57bea9(0x2ff)],_0xd8e6b5[_0x57bea9(0x2e9)]);_0x2ac320+=_0x5f5295;}const _0x51023d=this[_0x57bea9(0x2b3)](_0x1da05a,_0x517c49,_0x2d929e),_0x5bc729=_0x582bd8>0x0?_0x5d516a/_0x582bd8*0x64:0x0;return{'totalShops':_0x33502d,'activeShops':_0x301b51,'totalPayments':_0x582bd8,'successfulPayments':_0x5d516a,'totalRevenue':Math[_0x57bea9(0x2fa)](_0x2ac320*0x64)/0x64,'conversionRate':Math[_0x57bea9(0x2fa)](_0x5bc729*0x64)/0x64,'dailyRevenue':_0x51023d[_0x57bea9(0x2f6)],'dailyPayments':_0x51023d[_0x57bea9(0x322)],'recentPayments':_0x3039b5[_0x57bea9(0x201)](_0x24eb44=>({'id':_0x24eb44['id'],'amount':_0x24eb44['amount'],'currency':_0x24eb44['currency'],'status':_0x24eb44['status'],'gateway':_0x24eb44[_0x57bea9(0x2bf)],'shop':_0x24eb44[_0x57bea9(0x22b)],'createdAt':_0x24eb44['createdAt']}))};}async[a35_0x2100e6(0x25b)](_0x58010d){const _0x33aec0=a35_0x2100e6;console[_0x33aec0(0x255)](_0x33aec0(0x2cd),_0x58010d);let _0x46374b,_0x40bec6=new Date();if(_0x58010d[_0x33aec0(0x28a)]===_0x33aec0(0x290)&&_0x58010d[_0x33aec0(0x26f)]&&_0x58010d['dateTo'])_0x46374b=new Date(_0x58010d['dateFrom']),_0x40bec6=new Date(_0x58010d[_0x33aec0(0x1f6)]);else{const _0x201a8d=new Date();switch(_0x58010d[_0x33aec0(0x28a)]){case _0x33aec0(0x1f8):const _0x18bfad=_0x201a8d[_0x33aec0(0x224)](),_0x38904b=_0x18bfad===0x0?0x6:_0x18bfad-0x1;_0x46374b=new Date(_0x201a8d[_0x33aec0(0x2b7)]()-_0x38904b*0x18*0x3c*0x3c*0x3e8),_0x46374b[_0x33aec0(0x20b)](0x0,0x0,0x0,0x0);break;case _0x33aec0(0x245):_0x46374b=new Date(_0x201a8d[_0x33aec0(0x2a4)](),_0x201a8d['getMonth'](),0x1);break;case _0x33aec0(0x2a3):_0x46374b=new Date(_0x201a8d[_0x33aec0(0x2a4)](),0x0,0x1);break;case'all':default:_0x46374b=new Date(_0x33aec0(0x200));break;}}console[_0x33aec0(0x255)]('üìÖ\x20Period:\x20'+_0x46374b[_0x33aec0(0x2e3)]()+_0x33aec0(0x31c)+_0x40bec6[_0x33aec0(0x2e3)]());const _0x39381b={'status':'PAID','gateway':{'not':_0x33aec0(0x2f5)},'paidAt':{'gte':_0x46374b,'lte':_0x40bec6}};_0x58010d[_0x33aec0(0x23e)]&&(_0x39381b['shopId']=_0x58010d[_0x33aec0(0x23e)]);const _0x1cb468=await database_1[_0x33aec0(0x25e)][_0x33aec0(0x258)][_0x33aec0(0x223)]({'where':_0x39381b,'include':{'shop':{'select':{'id':!![],'name':!![],'username':!![],'gatewaySettings':!![]}}}});console[_0x33aec0(0x255)](_0x33aec0(0x324)+_0x1cb468['length']+_0x33aec0(0x2a2));const _0xe1a6ed={'gateway':{'not':_0x33aec0(0x2f5)},'createdAt':{'gte':_0x46374b,'lte':_0x40bec6}};_0x58010d[_0x33aec0(0x23e)]&&(_0xe1a6ed[_0x33aec0(0x23e)]=_0x58010d[_0x33aec0(0x23e)]);const _0x3f9be6=await database_1[_0x33aec0(0x25e)][_0x33aec0(0x258)][_0x33aec0(0x2bb)]({'where':_0xe1a6ed});console[_0x33aec0(0x255)](_0x33aec0(0x330)+_0x3f9be6+_0x33aec0(0x21a)+_0x1cb468['length']);let _0x29fecd=0x0,_0x2fac60=0x0,_0x272a68=0x0;const _0x104a8f={},_0x46e876={},_0x1a75cf={};for(const _0x41b43c of _0x1cb468){try{const _0x4d412e=await currencyService_1[_0x33aec0(0x29b)][_0x33aec0(0x243)](_0x41b43c['amount'],_0x41b43c[_0x33aec0(0x2e9)]);let _0x476104={};if(_0x41b43c[_0x33aec0(0x22b)][_0x33aec0(0x26e)])try{_0x476104=JSON[_0x33aec0(0x318)](_0x41b43c[_0x33aec0(0x22b)][_0x33aec0(0x26e)]);}catch(_0x4d04ba){console[_0x33aec0(0x2e4)](_0x33aec0(0x1ed)+_0x41b43c[_0x33aec0(0x23e)]+':',_0x4d04ba);}let _0x3475a9={},_0x2d66d3=0xa;for(const [_0x430aef,_0x32aba7]of Object[_0x33aec0(0x2cb)](_0x476104)){if(_0x430aef[_0x33aec0(0x28f)]()===_0x41b43c[_0x33aec0(0x2bf)]['toLowerCase']()){_0x3475a9=_0x32aba7,_0x2d66d3=_0x32aba7[_0x33aec0(0x256)]||0xa;break;}}let _0x5a3f9b,_0x17c9dd;_0x41b43c[_0x33aec0(0x253)]!==null&&_0x41b43c[_0x33aec0(0x253)]!==undefined?(_0x5a3f9b=_0x41b43c['amountAfterGatewayCommissionUSDT'],_0x17c9dd=_0x4d412e-_0x5a3f9b,console['log']('üìä\x20Using\x20saved\x20amountAfterGatewayCommissionUSDT:\x20'+_0x5a3f9b[_0x33aec0(0x27d)](0x6)+_0x33aec0(0x250)+_0x41b43c['id'])):(_0x17c9dd=_0x4d412e*(_0x2d66d3/0x64),_0x5a3f9b=_0x4d412e-_0x17c9dd,console[_0x33aec0(0x255)]('üìä\x20Calculating\x20commission\x20manually\x20for\x20payment\x20'+_0x41b43c['id']+':\x20'+_0x2d66d3+_0x33aec0(0x308)+_0x4d412e['toFixed'](0x6)+_0x33aec0(0x23c)));_0x29fecd+=_0x4d412e,_0x2fac60+=_0x5a3f9b,_0x272a68+=_0x17c9dd;!_0x104a8f[_0x41b43c[_0x33aec0(0x2bf)]]&&(_0x104a8f[_0x41b43c[_0x33aec0(0x2bf)]]={'gateway':_0x41b43c[_0x33aec0(0x2bf)],'gatewayDisplayName':this['getGatewayDisplayName'](_0x41b43c[_0x33aec0(0x2bf)]),'paymentsCount':0x0,'turnoverUSDT':0x0,'commissionUSDT':0x0,'merchantEarningsUSDT':0x0,'totalCommissionRate':0x0});_0x104a8f[_0x41b43c[_0x33aec0(0x2bf)]][_0x33aec0(0x239)]++,_0x104a8f[_0x41b43c[_0x33aec0(0x2bf)]][_0x33aec0(0x30a)]+=_0x4d412e,_0x104a8f[_0x41b43c[_0x33aec0(0x2bf)]][_0x33aec0(0x294)]+=_0x17c9dd,_0x104a8f[_0x41b43c[_0x33aec0(0x2bf)]]['merchantEarningsUSDT']+=_0x5a3f9b,_0x104a8f[_0x41b43c[_0x33aec0(0x2bf)]]['totalCommissionRate']+=_0x2d66d3;!_0x58010d[_0x33aec0(0x23e)]&&(!_0x46e876[_0x41b43c['shopId']]&&(_0x46e876[_0x41b43c[_0x33aec0(0x23e)]]={'shopId':_0x41b43c[_0x33aec0(0x23e)],'shopName':_0x41b43c['shop'][_0x33aec0(0x2db)],'shopUsername':_0x41b43c[_0x33aec0(0x22b)][_0x33aec0(0x332)],'paymentsCount':0x0,'turnoverUSDT':0x0,'commissionUSDT':0x0,'merchantEarningsUSDT':0x0,'paidOutUSDT':0x0,'averageCheckUSDT':0x0}),_0x46e876[_0x41b43c['shopId']][_0x33aec0(0x239)]++,_0x46e876[_0x41b43c[_0x33aec0(0x23e)]][_0x33aec0(0x30a)]+=_0x4d412e,_0x46e876[_0x41b43c[_0x33aec0(0x23e)]][_0x33aec0(0x294)]+=_0x17c9dd,_0x46e876[_0x41b43c[_0x33aec0(0x23e)]]['merchantEarningsUSDT']+=_0x5a3f9b);const _0x32a88a=_0x41b43c['paidAt'][_0x33aec0(0x2e3)]()[_0x33aec0(0x296)]('T')[0x0];!_0x1a75cf[_0x32a88a]&&(_0x1a75cf[_0x32a88a]={'date':_0x32a88a,'turnover':0x0,'merchantEarnings':0x0,'gatewayEarnings':0x0,'paymentsCount':0x0}),_0x1a75cf[_0x32a88a]['turnover']+=_0x4d412e,_0x1a75cf[_0x32a88a][_0x33aec0(0x2e8)]+=_0x5a3f9b,_0x1a75cf[_0x32a88a]['gatewayEarnings']+=_0x17c9dd,_0x1a75cf[_0x32a88a]['paymentsCount']++;}catch(_0x2ffe4a){console['error']('Error\x20processing\x20payment\x20'+_0x41b43c['id']+':',_0x2ffe4a);}}Object[_0x33aec0(0x25c)](_0x104a8f)[_0x33aec0(0x26b)](_0x320a58=>{const _0x4d7206=_0x33aec0;_0x320a58[_0x4d7206(0x206)]=_0x320a58[_0x4d7206(0x239)]>0x0?_0x320a58[_0x4d7206(0x32c)]/_0x320a58['paymentsCount']:0x0,delete _0x320a58[_0x4d7206(0x32c)];}),Object['values'](_0x46e876)[_0x33aec0(0x26b)](_0x3e71d0=>{const _0x5ccffe=_0x33aec0;_0x3e71d0[_0x5ccffe(0x2b8)]=_0x3e71d0[_0x5ccffe(0x239)]>0x0?_0x3e71d0[_0x5ccffe(0x30a)]/_0x3e71d0['paymentsCount']:0x0;});let _0x42ac88=0x0,_0x2fbdb9=0x0;if(_0x58010d[_0x33aec0(0x23e)]){const _0x154dc7=await database_1[_0x33aec0(0x25e)][_0x33aec0(0x297)][_0x33aec0(0x223)]({'where':{'shopId':_0x58010d[_0x33aec0(0x23e)],'status':_0x33aec0(0x2b0),'createdAt':{'gte':_0x46374b,'lte':_0x40bec6}},'select':{'amount':!![]}});_0x42ac88=_0x154dc7[_0x33aec0(0x31d)]((_0x32a8fd,_0x2337d6)=>_0x32a8fd+_0x2337d6['amount'],0x0);const _0x254615=await database_1[_0x33aec0(0x25e)]['payout'][_0x33aec0(0x223)]({'where':{'shopId':_0x58010d[_0x33aec0(0x23e)],'status':_0x33aec0(0x1f9),'createdAt':{'gte':_0x46374b,'lte':_0x40bec6}},'select':{'amount':!![]}});_0x2fbdb9=_0x254615[_0x33aec0(0x31d)]((_0x2b9d6e,_0x5c8e36)=>_0x2b9d6e+_0x5c8e36[_0x33aec0(0x2ff)],0x0);}const _0x2e9eb1=_0x3f9be6,_0x222b7e=_0x1cb468['length'],_0x449642=_0x222b7e>0x0?_0x29fecd/_0x222b7e:0x0,_0x1eaf91=_0x2e9eb1>0x0?Math[_0x33aec0(0x2fa)](_0x222b7e/_0x2e9eb1*0x2710)/0x64:0x0,_0x16514b=Math[_0x33aec0(0x268)]((_0x40bec6[_0x33aec0(0x2b7)]()-_0x46374b[_0x33aec0(0x2b7)]())/(0x3e8*0x3c*0x3c*0x18)),_0x3c2ce1={'totalTurnover':Math[_0x33aec0(0x2fa)](_0x29fecd*0x64)/0x64,'merchantEarnings':Math[_0x33aec0(0x2fa)](_0x2fac60*0x64)/0x64,'gatewayEarnings':Math[_0x33aec0(0x2fa)](_0x272a68*0x64)/0x64,'totalPaidOut':Math['round'](_0x42ac88*0x64)/0x64,'pendingPayout':Math[_0x33aec0(0x2fa)](_0x2fbdb9*0x64)/0x64,'averageCheck':Math[_0x33aec0(0x2fa)](_0x449642*0x64)/0x64,'totalPayments':_0x2e9eb1,'successfulPayments':_0x222b7e,'conversionRate':_0x1eaf91,'gatewayBreakdown':Object[_0x33aec0(0x25c)](_0x104a8f)[_0x33aec0(0x201)](_0xa033b5=>({..._0xa033b5,'turnoverUSDT':Math[_0x33aec0(0x2fa)](_0xa033b5[_0x33aec0(0x30a)]*0x64)/0x64,'commissionUSDT':Math[_0x33aec0(0x2fa)](_0xa033b5[_0x33aec0(0x294)]*0x64)/0x64,'merchantEarningsUSDT':Math[_0x33aec0(0x2fa)](_0xa033b5[_0x33aec0(0x24a)]*0x64)/0x64,'averageCommissionRate':Math[_0x33aec0(0x2fa)](_0xa033b5[_0x33aec0(0x206)]*0x64)/0x64})),'merchantBreakdown':_0x58010d[_0x33aec0(0x23e)]?undefined:Object['values'](_0x46e876)[_0x33aec0(0x201)](_0x11cdca=>({..._0x11cdca,'turnoverUSDT':Math['round'](_0x11cdca[_0x33aec0(0x30a)]*0x64)/0x64,'commissionUSDT':Math['round'](_0x11cdca['commissionUSDT']*0x64)/0x64,'merchantEarningsUSDT':Math[_0x33aec0(0x2fa)](_0x11cdca[_0x33aec0(0x24a)]*0x64)/0x64,'paidOutUSDT':Math[_0x33aec0(0x2fa)](_0x11cdca[_0x33aec0(0x21c)]*0x64)/0x64,'averageCheckUSDT':Math[_0x33aec0(0x2fa)](_0x11cdca[_0x33aec0(0x2b8)]*0x64)/0x64})),'dailyData':Object[_0x33aec0(0x25c)](_0x1a75cf)[_0x33aec0(0x201)](_0x11c29c=>({..._0x11c29c,'turnover':Math['round'](_0x11c29c[_0x33aec0(0x24c)]*0x64)/0x64,'merchantEarnings':Math[_0x33aec0(0x2fa)](_0x11c29c[_0x33aec0(0x2e8)]*0x64)/0x64,'gatewayEarnings':Math[_0x33aec0(0x2fa)](_0x11c29c[_0x33aec0(0x302)]*0x64)/0x64}))['sort']((_0x1bf4b9,_0x234eaa)=>_0x1bf4b9[_0x33aec0(0x326)][_0x33aec0(0x27f)](_0x234eaa[_0x33aec0(0x326)])),'periodInfo':{'from':_0x46374b,'to':_0x40bec6,'periodType':_0x58010d[_0x33aec0(0x28a)]||_0x33aec0(0x290),'daysCount':_0x16514b}};return console[_0x33aec0(0x255)](_0x33aec0(0x292)),console['log'](_0x33aec0(0x1ff)+_0x3c2ce1[_0x33aec0(0x23f)]+_0x33aec0(0x23c)),console[_0x33aec0(0x255)](_0x33aec0(0x2ce)+_0x3c2ce1[_0x33aec0(0x2e8)]+_0x33aec0(0x23c)),console['log'](_0x33aec0(0x32b)+_0x3c2ce1[_0x33aec0(0x302)]+_0x33aec0(0x23c)),console[_0x33aec0(0x255)](_0x33aec0(0x263)+_0x3c2ce1[_0x33aec0(0x309)]+_0x33aec0(0x23c)),console['log']('\x20\x20\x20‚è≥\x20Pending\x20payout:\x20'+_0x3c2ce1[_0x33aec0(0x321)]+_0x33aec0(0x23c)),console[_0x33aec0(0x255)](_0x33aec0(0x219)+_0x3c2ce1[_0x33aec0(0x32e)]),_0x3c2ce1;}async[a35_0x2100e6(0x261)](){const _0x1c263a=a35_0x2100e6;console[_0x1c263a(0x255)]('üìã\x20Getting\x20merchants\x20selection\x20list...');const _0x6449ee=await database_1[_0x1c263a(0x25e)][_0x1c263a(0x22b)][_0x1c263a(0x223)]({'where':{'status':_0x1c263a(0x1f2)},'select':{'id':!![],'username':!![],'name':!![]},'orderBy':{'name':_0x1c263a(0x306)}});return console['log'](_0x1c263a(0x2fc)+_0x6449ee[_0x1c263a(0x25f)]+_0x1c263a(0x27a)),_0x6449ee['map'](_0x1654dc=>({'id':_0x1654dc['id'],'username':_0x1654dc['username'],'name':_0x1654dc[_0x1c263a(0x2db)]}));}[a35_0x2100e6(0x1ee)](_0x31f007){const _0x1a367c=a35_0x2100e6,_0x56eec9={'test_gateway':_0x1a367c(0x254),'plisio':'Plisio','rapyd':_0x1a367c(0x1f5),'noda':_0x1a367c(0x1ec),'cointopay':_0x1a367c(0x28d),'cointopay2':_0x1a367c(0x2f1),'klyme_eu':_0x1a367c(0x2eb),'klyme_gb':'KLYME\x20GB','klyme_de':_0x1a367c(0x217),'mastercard':_0x1a367c(0x2a8)};return _0x56eec9[_0x31f007]||_0x31f007;}['getGatewayInternalName'](_0x5ab2fa){const _0x4f77ff=a35_0x2100e6,_0x303adc={'Test\x20Gateway':'test_gateway','Plisio':_0x4f77ff(0x202),'Rapyd':_0x4f77ff(0x1ef),'Noda':_0x4f77ff(0x215),'CoinToPay':_0x4f77ff(0x2e2),'CoinToPay2':_0x4f77ff(0x2d6),'KLYME\x20EU':_0x4f77ff(0x334),'KLYME\x20GB':_0x4f77ff(0x2b2),'KLYME\x20DE':_0x4f77ff(0x313),'MasterCard':_0x4f77ff(0x310)};return _0x303adc[_0x5ab2fa]||_0x5ab2fa[_0x4f77ff(0x28f)]();}async[a35_0x2100e6(0x1f0)](_0x3f3d19){const _0x552b01=a35_0x2100e6,{page:_0x3fa62,limit:_0x1d54db,minAmount:_0x544505,search:_0x95ba31}=_0x3f3d19,_0x3f16d6=(_0x3fa62-0x1)*_0x1d54db;console[_0x552b01(0x255)](_0x552b01(0x2c2),_0x3f3d19);const _0xf321fe={'balance':{'gt':0x0},'status':'ACTIVE'};_0x544505&&(_0xf321fe[_0x552b01(0x2ea)][_0x552b01(0x20f)]=_0x544505);_0x95ba31&&(_0xf321fe['OR']=[{'name':{'contains':_0x95ba31,'mode':'insensitive'}},{'username':{'contains':_0x95ba31,'mode':_0x552b01(0x20c)}}]);const [_0x16df0b,_0x17eeb1]=await Promise[_0x552b01(0x303)]([database_1[_0x552b01(0x25e)][_0x552b01(0x22b)][_0x552b01(0x223)]({'where':_0xf321fe,'skip':_0x3f16d6,'take':_0x1d54db,'orderBy':{'balance':_0x552b01(0x307)},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'balance':!![],'totalPaidOut':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'gatewaySettings':!![],'createdAt':!![]}}),database_1['default'][_0x552b01(0x22b)][_0x552b01(0x2bb)]({'where':_0xf321fe})]);console[_0x552b01(0x255)](_0x552b01(0x324)+_0x16df0b[_0x552b01(0x25f)]+'\x20merchants\x20with\x20positive\x20balance');const _0x4aa421=await Promise[_0x552b01(0x303)](_0x16df0b['map'](async _0x1595a5=>{const _0x454ee1=_0x552b01,[_0x1d9b8a,_0x1f02f0,_0x47b794]=await Promise[_0x454ee1(0x303)]([database_1[_0x454ee1(0x25e)][_0x454ee1(0x258)][_0x454ee1(0x2bb)]({'where':{'shopId':_0x1595a5['id'],'status':'PAID','gateway':{'not':_0x454ee1(0x2f5)}}}),database_1[_0x454ee1(0x25e)][_0x454ee1(0x258)][_0x454ee1(0x1fb)]({'where':{'shopId':_0x1595a5['id'],'status':_0x454ee1(0x2a9),'gateway':{'not':_0x454ee1(0x2f5)}},'orderBy':{'paidAt':_0x454ee1(0x306)},'select':{'paidAt':!![]}}),database_1[_0x454ee1(0x25e)][_0x454ee1(0x258)][_0x454ee1(0x305)]({'by':[_0x454ee1(0x2bf)],'where':{'shopId':_0x1595a5['id'],'status':_0x454ee1(0x2a9),'gateway':{'not':_0x454ee1(0x2f5)}},'_count':{'id':!![]},'_sum':{'amountUSDT':!![]}})]),_0xd15879=new Date(),_0x23c921=new Date(_0xd15879[_0x454ee1(0x2a4)](),_0xd15879[_0x454ee1(0x2d4)](),0x1),_0x292672=new Date(_0xd15879['getFullYear'](),_0xd15879[_0x454ee1(0x2d4)]()+0x1,0x0,0x17,0x3b,0x3b,0x3e7),[_0x36fa08,_0x3c40f7]=await Promise[_0x454ee1(0x303)]([database_1[_0x454ee1(0x25e)][_0x454ee1(0x297)][_0x454ee1(0x2c8)]({'_sum':{'amount':!![]},'where':{'shopId':_0x1595a5['id'],'status':'COMPLETED'}}),database_1[_0x454ee1(0x25e)][_0x454ee1(0x297)][_0x454ee1(0x2c8)]({'_sum':{'amount':!![]},'where':{'shopId':_0x1595a5['id'],'status':'COMPLETED','createdAt':{'gte':_0x23c921,'lte':_0x292672}}})]),_0x277b98=_0x36fa08[_0x454ee1(0x32d)][_0x454ee1(0x2ff)]||0x0,_0x19fadb=_0x3c40f7[_0x454ee1(0x32d)][_0x454ee1(0x2ff)]||0x0,_0x1bda67=await Promise[_0x454ee1(0x303)](_0x47b794[_0x454ee1(0x201)](async _0x46971e=>{const _0x1d11c9=_0x454ee1;let _0x1d35a6=0xa;if(_0x1595a5[_0x1d11c9(0x26e)])try{const _0xd1b45e=JSON[_0x1d11c9(0x318)](_0x1595a5[_0x1d11c9(0x26e)]);for(const [_0x187565,_0x5931ef]of Object[_0x1d11c9(0x2cb)](_0xd1b45e)){if(_0x187565[_0x1d11c9(0x28f)]()===_0x46971e[_0x1d11c9(0x2bf)][_0x1d11c9(0x28f)]()){_0x1d35a6=_0x5931ef['commission']||0xa,console[_0x1d11c9(0x255)](_0x1d11c9(0x2fd)+_0x46971e[_0x1d11c9(0x2bf)]+_0x1d11c9(0x2df)+_0x1595a5['id']+':\x20commission\x20=\x20'+_0x1d35a6+'%');break;}}}catch(_0x1b8ae9){console[_0x1d11c9(0x2e4)](_0x1d11c9(0x1ed)+_0x1595a5['id']+':',_0x1b8ae9);}const _0x306cbe=_0x46971e[_0x1d11c9(0x32d)]?.[_0x1d11c9(0x2bc)]||0x0,_0x1048f2=_0x306cbe*(0x1-_0x1d35a6/0x64);return{'gateway':_0x46971e['gateway'],'count':_0x46971e[_0x1d11c9(0x2d8)]?.['id']||0x0,'amountUSDT':Math[_0x1d11c9(0x2fa)](_0x306cbe*0x64)/0x64,'amountAfterCommissionUSDT':Math['round'](_0x1048f2*0x64)/0x64,'commission':_0x1d35a6};})),_0x5a74eb=_0x1bda67[_0x454ee1(0x31d)]((_0x8d8d0b,_0x34c0f1)=>_0x8d8d0b+_0x34c0f1[_0x454ee1(0x2bc)],0x0),_0x5cdfa8=_0x1595a5['balance'];return console[_0x454ee1(0x255)](_0x454ee1(0x289)+_0x1595a5['username']+':'),console['log'](_0x454ee1(0x22a)+_0x5a74eb[_0x454ee1(0x27d)](0x2)+'\x20USDT\x20(gross\x20revenue)'),console[_0x454ee1(0x255)](_0x454ee1(0x331)+_0x1bda67['reduce']((_0x4b0839,_0x332b55)=>_0x4b0839+_0x332b55[_0x454ee1(0x27e)],0x0)[_0x454ee1(0x27d)](0x2)+'\x20USDT\x20(theoretical\x20net)'),console[_0x454ee1(0x255)]('\x20\x20\x20‚úÖ\x20Actual\x20available\x20balance:\x20'+_0x5cdfa8[_0x454ee1(0x27d)](0x2)+_0x454ee1(0x2d9)),{'id':_0x1595a5['id'],'fullName':_0x1595a5[_0x454ee1(0x2db)],'username':_0x1595a5[_0x454ee1(0x332)],'telegramId':_0x1595a5[_0x454ee1(0x211)],'merchantUrl':_0x1595a5[_0x454ee1(0x316)],'wallets':{'usdtPolygonWallet':_0x1595a5[_0x454ee1(0x31e)],'usdtTrcWallet':_0x1595a5['usdtTrcWallet'],'usdtErcWallet':_0x1595a5[_0x454ee1(0x22e)],'usdcPolygonWallet':_0x1595a5[_0x454ee1(0x285)]},'totalAmountUSDT':Math[_0x454ee1(0x2fa)](_0x5a74eb*0x64)/0x64,'totalAmountAfterCommissionUSDT':Math['round'](_0x5cdfa8*0x64)/0x64,'totalPayout':Math[_0x454ee1(0x2fa)](_0x277b98*0x64)/0x64,'thisMonth':Math[_0x454ee1(0x2fa)](_0x19fadb*0x64)/0x64,'paymentsCount':_0x1d9b8a,'oldestPaymentDate':_0x1f02f0?.[_0x454ee1(0x1fc)]||_0x1595a5['createdAt'],'gatewayBreakdown':_0x1bda67};})),_0x3a30d5=_0x4aa421[_0x552b01(0x31d)]((_0x1535ee,_0x2f661a)=>_0x1535ee+_0x2f661a['totalAmountUSDT'],0x0),_0x174c92=_0x4aa421[_0x552b01(0x31d)]((_0x146b0d,_0xc884a3)=>_0x146b0d+_0xc884a3['totalAmountAfterCommissionUSDT'],0x0),_0x306552=_0x4aa421[_0x552b01(0x31d)]((_0x3ae026,_0x53e36a)=>_0x3ae026+_0x53e36a[_0x552b01(0x2ae)],0x0),_0x43dbeb=_0x4aa421[_0x552b01(0x31d)]((_0x4af6c7,_0x47e2cb)=>_0x4af6c7+_0x47e2cb[_0x552b01(0x244)],0x0);return console['log'](_0x552b01(0x2b1)+_0x17eeb1+_0x552b01(0x28c)),console[_0x552b01(0x255)](_0x552b01(0x281)+Math[_0x552b01(0x2fa)](_0x3a30d5*0x64)/0x64+'\x20USDT\x20(gross\x20revenue)'),console[_0x552b01(0x255)](_0x552b01(0x247)+Math['round'](_0x174c92*0x64)/0x64+_0x552b01(0x1fd)),console[_0x552b01(0x255)]('\x20\x20\x20üí∏\x20Total\x20payouts\x20(all\x20time):\x20'+Math[_0x552b01(0x2fa)](_0x306552*0x64)/0x64+_0x552b01(0x23c)),console['log'](_0x552b01(0x29a)+Math['round'](_0x43dbeb*0x64)/0x64+'\x20USDT'),{'merchants':_0x4aa421,'pagination':{'page':_0x3fa62,'limit':_0x1d54db,'total':_0x17eeb1,'totalPages':Math['ceil'](_0x17eeb1/_0x1d54db)},'summary':{'totalMerchants':_0x17eeb1,'totalAmountUSDT':Math['round'](_0x3a30d5*0x64)/0x64,'totalAmountAfterCommissionUSDT':Math[_0x552b01(0x2fa)](_0x174c92*0x64)/0x64,'totalPayout':Math[_0x552b01(0x2fa)](_0x306552*0x64)/0x64,'thisMonth':Math[_0x552b01(0x2fa)](_0x43dbeb*0x64)/0x64}};}async['createPayout'](_0x362d57){const _0x4a64a0=a35_0x2100e6,{shopId:_0x266aff,amount:_0x3c4fb0,network:_0x5d9844,wallet:_0x3e4876,notes:_0x3e4088,txid:_0x36e2d1,periodFrom:_0xe1c0e8,periodTo:_0x353421}=_0x362d57,_0x3fb97a=await database_1['default']['$transaction'](async _0x51a53c=>{const _0x24482e=a35_0x1850,_0x1761ce=await _0x51a53c['shop']['findUnique']({'where':{'id':_0x266aff},'select':{'id':!![],'name':!![],'username':!![],'balance':!![],'totalPaidOut':!![]}});if(!_0x1761ce)throw new Error(_0x24482e(0x233));console[_0x24482e(0x255)](_0x24482e(0x2e5)+_0x1761ce['username']+':'),console['log']('\x20\x20\x20Current\x20balance:\x20'+_0x1761ce[_0x24482e(0x2ea)]['toFixed'](0x6)+'\x20USDT'),console[_0x24482e(0x255)](_0x24482e(0x24d)+_0x3c4fb0[_0x24482e(0x27d)](0x6)+_0x24482e(0x23c)),console[_0x24482e(0x255)](_0x24482e(0x22c)+_0x1761ce[_0x24482e(0x309)][_0x24482e(0x27d)](0x6)+_0x24482e(0x23c));if(_0x36e2d1)console[_0x24482e(0x255)](_0x24482e(0x329)+_0x36e2d1);if(_0x1761ce[_0x24482e(0x2ea)]<_0x3c4fb0)throw new Error(_0x24482e(0x31f)+_0x1761ce[_0x24482e(0x2ea)]['toFixed'](0x6)+_0x24482e(0x249)+_0x3c4fb0[_0x24482e(0x27d)](0x6)+_0x24482e(0x23c));let _0x5ec6bd=_0x3e4876;if(!_0x5ec6bd){const _0x3d2a88=await _0x51a53c[_0x24482e(0x22b)][_0x24482e(0x251)]({'where':{'id':_0x266aff},'select':{'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![]}});if(_0x3d2a88)switch(_0x5d9844){case _0x24482e(0x23b):_0x5ec6bd=_0x3d2a88['usdtPolygonWallet']||undefined;break;case _0x24482e(0x31b):_0x5ec6bd=_0x3d2a88[_0x24482e(0x2f2)]||undefined;break;case _0x24482e(0x300):_0x5ec6bd=_0x3d2a88['usdtErcWallet']||undefined;break;case'polygon_usdc':_0x5ec6bd=_0x3d2a88[_0x24482e(0x285)]||undefined;break;}}console[_0x24482e(0x255)]('üí≥\x20Payout\x20wallet\x20for\x20'+_0x5d9844+':\x20'+(_0x5ec6bd||'not\x20specified'));const _0x48a36a=await _0x51a53c['payout'][_0x24482e(0x1ea)]({'data':{'shopId':_0x266aff,'amount':_0x3c4fb0,'network':_0x5d9844,'status':_0x24482e(0x2b0),'txid':_0x36e2d1,'notes':_0x3e4088,'periodFrom':_0xe1c0e8?new Date(_0xe1c0e8):null,'periodTo':_0x353421?new Date(_0x353421):null,'createdAt':new Date(),'paidAt':new Date()}}),_0xeb6534=_0x1761ce[_0x24482e(0x2ea)]-_0x3c4fb0,_0x2d539f=_0x1761ce[_0x24482e(0x309)]+_0x3c4fb0;return await _0x51a53c[_0x24482e(0x22b)][_0x24482e(0x264)]({'where':{'id':_0x266aff},'data':{'balance':_0xeb6534,'totalPaidOut':_0x2d539f}}),console[_0x24482e(0x255)](_0x24482e(0x2f8)+_0x1761ce['username']+_0x24482e(0x267)),console[_0x24482e(0x255)](_0x24482e(0x288)+_0x1761ce['balance'][_0x24482e(0x27d)](0x6)+_0x24482e(0x30d)+_0xeb6534['toFixed'](0x6)+_0x24482e(0x311)+_0x3c4fb0[_0x24482e(0x27d)](0x6)+')'),console[_0x24482e(0x255)]('\x20\x20\x20Total\x20paid\x20out:\x20'+_0x1761ce[_0x24482e(0x309)][_0x24482e(0x27d)](0x6)+'\x20->\x20'+_0x2d539f[_0x24482e(0x27d)](0x6)+_0x24482e(0x2f3)+_0x3c4fb0['toFixed'](0x6)+')'),{'payout':_0x48a36a,'shop':_0x1761ce};});return console['log'](_0x4a64a0(0x30e)+_0x3fb97a[_0x4a64a0(0x297)]['id']+_0x4a64a0(0x2df)+_0x3fb97a['shop'][_0x4a64a0(0x332)]+'\x20('+_0x3c4fb0+_0x4a64a0(0x317)),{'id':_0x3fb97a[_0x4a64a0(0x297)]['id'],'shopId':_0x3fb97a[_0x4a64a0(0x297)]['shopId'],'shopName':_0x3fb97a[_0x4a64a0(0x22b)][_0x4a64a0(0x2db)],'shopUsername':_0x3fb97a[_0x4a64a0(0x22b)][_0x4a64a0(0x332)],'amount':_0x3fb97a[_0x4a64a0(0x297)][_0x4a64a0(0x2ff)],'network':_0x3fb97a[_0x4a64a0(0x297)]['network'],'status':_0x3fb97a[_0x4a64a0(0x297)][_0x4a64a0(0x2fb)],'txid':_0x3fb97a['payout'][_0x4a64a0(0x225)],'notes':_0x3fb97a[_0x4a64a0(0x297)][_0x4a64a0(0x287)],'periodFrom':_0x3fb97a[_0x4a64a0(0x297)][_0x4a64a0(0x2b4)],'periodTo':_0x3fb97a[_0x4a64a0(0x297)][_0x4a64a0(0x208)],'createdAt':_0x3fb97a[_0x4a64a0(0x297)][_0x4a64a0(0x2c9)],'paidAt':_0x3fb97a[_0x4a64a0(0x297)][_0x4a64a0(0x1fc)]};}async[a35_0x2100e6(0x301)](_0x214f59){const _0x24bdc5=a35_0x2100e6,{page:_0x2db418,limit:_0x2e3522,shopId:_0x57d380,network:_0x9a7e3f,dateFrom:_0x55098e,dateTo:_0xfbdb9,search:_0x98510f}=_0x214f59,_0x421850=(_0x2db418-0x1)*_0x2e3522,_0x37708d={};_0x57d380&&(_0x37708d[_0x24bdc5(0x23e)]=_0x57d380);_0x9a7e3f&&(_0x37708d[_0x24bdc5(0x31a)]=_0x9a7e3f);(_0x55098e||_0xfbdb9)&&(_0x37708d[_0x24bdc5(0x2c9)]={},_0x55098e&&(_0x37708d[_0x24bdc5(0x2c9)]['gte']=new Date(_0x55098e)),_0xfbdb9&&(_0x37708d[_0x24bdc5(0x2c9)][_0x24bdc5(0x210)]=new Date(_0xfbdb9)));_0x98510f&&(_0x37708d['OR']=[{'shop':{'name':{'contains':_0x98510f,'mode':_0x24bdc5(0x20c)}}},{'shop':{'username':{'contains':_0x98510f,'mode':_0x24bdc5(0x20c)}}},{'notes':{'contains':_0x98510f,'mode':_0x24bdc5(0x20c)}}]);const [_0x43e13c,_0x4ecacb]=await Promise[_0x24bdc5(0x303)]([database_1[_0x24bdc5(0x25e)][_0x24bdc5(0x297)][_0x24bdc5(0x223)]({'where':_0x37708d,'skip':_0x421850,'take':_0x2e3522,'orderBy':{'createdAt':_0x24bdc5(0x307)},'select':{'id':!![],'shopId':!![],'amount':!![],'network':!![],'status':!![],'txid':!![],'notes':!![],'periodFrom':!![],'periodTo':!![],'createdAt':!![],'paidAt':!![],'shop':{'select':{'name':!![],'username':!![]}}}}),database_1[_0x24bdc5(0x25e)][_0x24bdc5(0x297)]['count']({'where':_0x37708d})]);return{'payouts':_0x43e13c['map'](_0xa0f71a=>({'id':_0xa0f71a['id'],'shopId':_0xa0f71a[_0x24bdc5(0x23e)],'shopName':_0xa0f71a[_0x24bdc5(0x22b)][_0x24bdc5(0x2db)],'shopUsername':_0xa0f71a[_0x24bdc5(0x22b)][_0x24bdc5(0x332)],'amount':_0xa0f71a['amount'],'network':_0xa0f71a[_0x24bdc5(0x31a)],'status':_0xa0f71a[_0x24bdc5(0x2fb)],'txid':_0xa0f71a[_0x24bdc5(0x225)],'notes':_0xa0f71a[_0x24bdc5(0x287)],'periodFrom':_0xa0f71a[_0x24bdc5(0x2b4)],'periodTo':_0xa0f71a[_0x24bdc5(0x208)],'createdAt':_0xa0f71a['createdAt'],'paidAt':_0xa0f71a['paidAt']})),'pagination':{'page':_0x2db418,'limit':_0x2e3522,'total':_0x4ecacb,'totalPages':Math[_0x24bdc5(0x268)](_0x4ecacb/_0x2e3522)}};}async[a35_0x2100e6(0x238)](_0x52bc0d){const _0x4094df=a35_0x2100e6,_0x282078=await database_1['default'][_0x4094df(0x297)][_0x4094df(0x251)]({'where':{'id':_0x52bc0d},'include':{'shop':{'select':{'name':!![],'username':!![]}}}});if(!_0x282078)return null;return{'id':_0x282078['id'],'shopId':_0x282078[_0x4094df(0x23e)],'shopName':_0x282078[_0x4094df(0x22b)][_0x4094df(0x2db)],'shopUsername':_0x282078[_0x4094df(0x22b)][_0x4094df(0x332)],'amount':_0x282078[_0x4094df(0x2ff)],'network':_0x282078[_0x4094df(0x31a)],'status':_0x282078[_0x4094df(0x2fb)],'txid':_0x282078[_0x4094df(0x225)],'notes':_0x282078[_0x4094df(0x287)],'periodFrom':_0x282078['periodFrom'],'periodTo':_0x282078['periodTo'],'createdAt':_0x282078[_0x4094df(0x2c9)],'paidAt':_0x282078[_0x4094df(0x1fc)]};}async['deletePayout'](_0x3869e2){const _0x238fc3=a35_0x2100e6;await database_1[_0x238fc3(0x25e)]['payout'][_0x238fc3(0x236)]({'where':{'id':_0x3869e2}});}async['getAllPayments'](_0x4831e8){const _0x32a3f9=a35_0x2100e6,{page:_0x31e8e6,limit:_0x5b292e,status:_0x3d9d24,gateway:_0x21d054,shopId:_0x207b9a,dateFrom:_0x4b3461,dateTo:_0x56c4c6,search:_0x151c65,currency:_0x4ed019,sortBy:_0x3b30c5,sortOrder:_0x35fa36}=_0x4831e8,_0x664f57=(_0x31e8e6-0x1)*_0x5b292e;console[_0x32a3f9(0x255)]('üìä\x20Getting\x20payments\x20with\x20filters:',_0x4831e8);const _0x1c9cac=await database_1[_0x32a3f9(0x25e)][_0x32a3f9(0x258)]['groupBy']({'by':['gateway'],'_count':{'gateway':!![]}});console[_0x32a3f9(0x255)](_0x32a3f9(0x2c0),_0x1c9cac['map'](_0x5d7175=>_0x5d7175[_0x32a3f9(0x2bf)]+'\x20('+_0x5d7175[_0x32a3f9(0x2d8)]['gateway']+_0x32a3f9(0x30f)));if(_0x21d054){const _0x1238d7=_0x1c9cac[_0x32a3f9(0x27b)](_0x226099=>_0x226099[_0x32a3f9(0x2bf)][_0x32a3f9(0x28f)]()===_0x21d054[_0x32a3f9(0x28f)]());!_0x1238d7&&_0x21d054[_0x32a3f9(0x28f)]()!==_0x32a3f9(0x2f5)&&console['log'](_0x32a3f9(0x240)+_0x21d054+_0x32a3f9(0x2d1)+_0x1c9cac[_0x32a3f9(0x201)](_0x459e7c=>_0x459e7c[_0x32a3f9(0x2bf)])[_0x32a3f9(0x265)](',\x20'));}const _0x5965ba={};_0x3d9d24&&(_0x5965ba[_0x32a3f9(0x2fb)]=_0x3d9d24[_0x32a3f9(0x21b)]());if(!_0x21d054)_0x5965ba[_0x32a3f9(0x2bf)]={'not':_0x32a3f9(0x2f5)};else{if(_0x21d054&&(_0x21d054['toLowerCase']()===_0x32a3f9(0x2f5)||_0x21d054===_0x32a3f9(0x226)))_0x5965ba[_0x32a3f9(0x2bf)]=_0x32a3f9(0x2f5);else{let _0x5bb6ad=_0x21d054;const _0x5a1854=(0x0,gateway_1['getGatewayNameById'])(_0x21d054);if(_0x5a1854)_0x5bb6ad=_0x5a1854,console[_0x32a3f9(0x255)](_0x32a3f9(0x241)+_0x21d054+_0x32a3f9(0x1f4)+_0x5bb6ad+'\x27');else{const _0x2422b5=(0x0,gateway_1['getGatewayIdByName'])(_0x21d054);if(_0x2422b5){const _0x497389=(0x0,gateway_1[_0x32a3f9(0x29e)])(_0x2422b5);_0x497389&&(_0x5bb6ad=_0x497389,console[_0x32a3f9(0x255)](_0x32a3f9(0x2fe)+_0x21d054+'\x27\x20->\x20ID\x20\x27'+_0x2422b5+_0x32a3f9(0x323)+_0x5bb6ad+'\x27'));}else console['log'](_0x32a3f9(0x2e1)+_0x21d054+_0x32a3f9(0x2ec));}const _0x3597eb=await database_1[_0x32a3f9(0x25e)][_0x32a3f9(0x258)][_0x32a3f9(0x2bb)]({'where':{'gateway':_0x5bb6ad[_0x32a3f9(0x28f)]()},'take':0x1});_0x3597eb===0x0?(console[_0x32a3f9(0x255)](_0x32a3f9(0x315)+_0x5bb6ad+_0x32a3f9(0x221)+_0x21d054+'\x27)\x20not\x20found\x20in\x20database,\x20returning\x20empty\x20result'),_0x5965ba[_0x32a3f9(0x2bf)]=_0x32a3f9(0x207)):(_0x5965ba[_0x32a3f9(0x2bf)]=_0x5bb6ad[_0x32a3f9(0x28f)](),console[_0x32a3f9(0x255)](_0x32a3f9(0x25d)+_0x5bb6ad+'\x27\x20(from\x20\x27'+_0x21d054+'\x27)'));}}console[_0x32a3f9(0x255)]('üìä\x20Gateway\x20filter\x20applied:',_0x5965ba[_0x32a3f9(0x2bf)]);_0x207b9a&&(_0x5965ba['shopId']=_0x207b9a);_0x4ed019&&(_0x5965ba[_0x32a3f9(0x2e9)]=_0x4ed019[_0x32a3f9(0x21b)](),console['log']('üí±\x20Currency\x20filter\x20applied:\x20'+_0x4ed019[_0x32a3f9(0x21b)]()));(_0x4b3461||_0x56c4c6)&&(_0x5965ba[_0x32a3f9(0x2c9)]={},_0x4b3461&&(_0x5965ba[_0x32a3f9(0x2c9)][_0x32a3f9(0x20f)]=new Date(_0x4b3461)),_0x56c4c6&&(_0x5965ba[_0x32a3f9(0x2c9)][_0x32a3f9(0x210)]=new Date(_0x56c4c6)));_0x151c65&&(_0x5965ba['OR']=[{'id':{'contains':_0x151c65,'mode':_0x32a3f9(0x20c)}},{'orderId':{'contains':_0x151c65,'mode':_0x32a3f9(0x20c)}},{'gatewayOrderId':{'contains':_0x151c65,'mode':_0x32a3f9(0x20c)}},{'customerEmail':{'contains':_0x151c65,'mode':_0x32a3f9(0x20c)}},{'shop':{'name':{'contains':_0x151c65,'mode':_0x32a3f9(0x20c)}}},{'shop':{'username':{'contains':_0x151c65,'mode':_0x32a3f9(0x20c)}}}]);console[_0x32a3f9(0x255)](_0x32a3f9(0x2c6),JSON['stringify'](_0x5965ba,null,0x2));let _0x10e65e={'createdAt':_0x32a3f9(0x307)};if(_0x3b30c5){const _0x33966a=[_0x32a3f9(0x2ff),_0x32a3f9(0x2c9),_0x32a3f9(0x271),_0x32a3f9(0x2fb),'gateway',_0x32a3f9(0x2e9)],_0x1c7669=[_0x32a3f9(0x306),_0x32a3f9(0x307)];if(_0x33966a[_0x32a3f9(0x272)](_0x3b30c5)){const _0x1c76c5=_0x1c7669[_0x32a3f9(0x272)](_0x35fa36)?_0x35fa36:_0x32a3f9(0x307);_0x10e65e={[_0x3b30c5]:_0x1c76c5},console[_0x32a3f9(0x255)]('üìä\x20Sorting\x20payments\x20by\x20'+_0x3b30c5+_0x32a3f9(0x20d)+_0x1c76c5+_0x32a3f9(0x304));}}const [_0x26561d,_0x50faa7]=await Promise['all']([database_1['default']['payment'][_0x32a3f9(0x223)]({'where':_0x5965ba,'skip':_0x664f57,'take':_0x5b292e,'orderBy':_0x10e65e,'include':{'shop':{'select':{'name':!![],'username':!![]}}}}),database_1[_0x32a3f9(0x25e)][_0x32a3f9(0x258)][_0x32a3f9(0x2bb)]({'where':_0x5965ba})]);return{'payments':_0x26561d,'pagination':{'page':_0x31e8e6,'limit':_0x5b292e,'total':_0x50faa7,'totalPages':Math['ceil'](_0x50faa7/_0x5b292e)}};}async[a35_0x2100e6(0x269)](_0x4de370){const _0x2c8192=a35_0x2100e6,_0x3da881=await database_1[_0x2c8192(0x25e)][_0x2c8192(0x258)]['findUnique']({'where':{'id':_0x4de370},'include':{'shop':{'select':{'name':!![],'username':!![]}}}});if(!_0x3da881)return null;return{'id':_0x3da881['id'],'shopId':_0x3da881[_0x2c8192(0x23e)],'gateway':_0x3da881[_0x2c8192(0x2bf)],'amount':_0x3da881[_0x2c8192(0x2ff)],'currency':_0x3da881[_0x2c8192(0x2e9)],'status':_0x3da881['status'],'orderId':_0x3da881[_0x2c8192(0x2cc)],'gatewayOrderId':_0x3da881[_0x2c8192(0x1f7)],'customerEmail':_0x3da881[_0x2c8192(0x204)],'customerName':_0x3da881[_0x2c8192(0x232)],'customerCountry':_0x3da881['customerCountry'],'customerIp':_0x3da881[_0x2c8192(0x259)],'customerUa':_0x3da881[_0x2c8192(0x20e)],'failureMessage':_0x3da881[_0x2c8192(0x2ca)],'externalPaymentUrl':_0x3da881[_0x2c8192(0x2e6)],'successUrl':_0x3da881[_0x2c8192(0x2ad)],'failUrl':_0x3da881['failUrl'],'pendingUrl':_0x3da881[_0x2c8192(0x21f)],'whiteUrl':_0x3da881[_0x2c8192(0x299)],'createdAt':_0x3da881[_0x2c8192(0x2c9)],'updatedAt':_0x3da881[_0x2c8192(0x271)],'shop':_0x3da881[_0x2c8192(0x22b)]};}async[a35_0x2100e6(0x21e)](_0x9dbf57,_0x1bb2d9,_0xae6d13,_0x39e732){const _0xada181=a35_0x2100e6,_0x129ba9=await database_1[_0xada181(0x25e)][_0xada181(0x1eb)](async _0x927b80=>{const _0x15d2a9=_0xada181,_0x2668ed=await _0x927b80[_0x15d2a9(0x258)]['findUnique']({'where':{'id':_0x9dbf57},'include':{'shop':{'select':{'id':!![],'name':!![],'username':!![],'balance':!![]}}}});if(!_0x2668ed)throw new Error(_0x15d2a9(0x2a0));const _0x572737=_0x2668ed['status'],_0x322f8a=_0x1bb2d9[_0x15d2a9(0x21b)]();console[_0x15d2a9(0x255)](_0x15d2a9(0x282)+_0x9dbf57+_0x15d2a9(0x2af)+_0x572737+'\x20->\x20'+_0x322f8a),console['log'](_0x15d2a9(0x325)+_0x2668ed[_0x15d2a9(0x22b)]['balance']+_0x15d2a9(0x23c));const _0x4fe112={'status':_0x322f8a,'updatedAt':new Date(),'statusChangedBy':'admin','statusChangedAt':new Date()};_0xae6d13&&(_0x4fe112[_0x15d2a9(0x220)]=_0xae6d13);_0x322f8a===_0x15d2a9(0x222)&&_0x39e732&&(_0x4fe112[_0x15d2a9(0x2c1)]=_0x39e732);let _0xdd5833=0x0,_0x9b9d40=_0x2668ed[_0x15d2a9(0x22b)][_0x15d2a9(0x2ea)];if(_0x322f8a===_0x15d2a9(0x2a9)&&_0x572737!==_0x15d2a9(0x2a9)){_0x4fe112[_0x15d2a9(0x1fc)]=new Date();const _0x5ce66c=await currencyService_1[_0x15d2a9(0x29b)][_0x15d2a9(0x243)](_0x2668ed[_0x15d2a9(0x2ff)],_0x2668ed[_0x15d2a9(0x2e9)]);_0x4fe112['amountUSDT']=_0x5ce66c;let _0x4232cb=0xa;const _0x2031ce=await _0x927b80[_0x15d2a9(0x22b)][_0x15d2a9(0x251)]({'where':{'id':_0x2668ed[_0x15d2a9(0x23e)]},'select':{'gatewaySettings':!![]}});if(_0x2031ce?.[_0x15d2a9(0x26e)])try{const _0x187d64=JSON[_0x15d2a9(0x318)](_0x2031ce[_0x15d2a9(0x26e)]);for(const [_0x231221,_0x32e72e]of Object['entries'](_0x187d64)){if(_0x231221[_0x15d2a9(0x28f)]()===_0x2668ed[_0x15d2a9(0x2bf)][_0x15d2a9(0x28f)]()){_0x4232cb=_0x32e72e[_0x15d2a9(0x256)]||0xa;break;}}}catch(_0x50962){console['error'](_0x15d2a9(0x2c4)+_0x9dbf57+':',_0x50962);}let _0x112126;_0x2668ed[_0x15d2a9(0x253)]!==null&&_0x2668ed[_0x15d2a9(0x253)]!==undefined?(_0x112126=_0x2668ed['amountAfterGatewayCommissionUSDT'],console[_0x15d2a9(0x255)]('üìä\x20[ADMIN]\x20Using\x20saved\x20amountAfterGatewayCommissionUSDT:\x20'+_0x112126['toFixed'](0x6)+_0x15d2a9(0x250)+_0x9dbf57)):(_0x112126=_0x5ce66c*(0x1-_0x4232cb/0x64),console['log'](_0x15d2a9(0x2d3)+_0x9dbf57+':\x20'+_0x4232cb+'%\x20from\x20'+_0x5ce66c[_0x15d2a9(0x27d)](0x6)+'\x20USDT'),_0x4fe112['amountAfterGatewayCommissionUSDT']=_0x112126),_0xdd5833=_0x112126,_0x9b9d40+=_0x112126,console[_0x15d2a9(0x255)](_0x15d2a9(0x26d)+_0x9dbf57+_0x15d2a9(0x2dc)),console[_0x15d2a9(0x255)]('\x20\x20\x20Full\x20amount:\x20'+_0x5ce66c[_0x15d2a9(0x27d)](0x6)+_0x15d2a9(0x23c)),console['log'](_0x15d2a9(0x246)+_0x2668ed[_0x15d2a9(0x2bf)]+_0x15d2a9(0x314)+_0x4232cb+'%'),console[_0x15d2a9(0x255)](_0x15d2a9(0x30b)+_0x112126['toFixed'](0x6)+_0x15d2a9(0x242)+_0x4232cb+'%\x20commission)'),console[_0x15d2a9(0x255)](_0x15d2a9(0x20a)+_0x112126[_0x15d2a9(0x27d)](0x6)+_0x15d2a9(0x23c));}else{if(_0x572737===_0x15d2a9(0x2a9)&&_0x322f8a!==_0x15d2a9(0x2a9)){if(_0x2668ed[_0x15d2a9(0x2bc)]){let _0x1048e8=0xa;const _0x2b0d7a=await _0x927b80['shop'][_0x15d2a9(0x251)]({'where':{'id':_0x2668ed[_0x15d2a9(0x23e)]},'select':{'gatewaySettings':!![]}});if(_0x2b0d7a?.[_0x15d2a9(0x26e)])try{const _0x195ab2=JSON[_0x15d2a9(0x318)](_0x2b0d7a[_0x15d2a9(0x26e)]);for(const [_0x1dc01a,_0xe76736]of Object['entries'](_0x195ab2)){if(_0x1dc01a[_0x15d2a9(0x28f)]()===_0x2668ed[_0x15d2a9(0x2bf)][_0x15d2a9(0x28f)]()){_0x1048e8=_0xe76736[_0x15d2a9(0x256)]||0xa;break;}}}catch(_0x3053be){console[_0x15d2a9(0x2e4)](_0x15d2a9(0x2c4)+_0x9dbf57+':',_0x3053be);}const _0x270731=_0x2668ed['amountUSDT']*(0x1-_0x1048e8/0x64);_0xdd5833=-_0x270731,_0x9b9d40-=_0x270731,_0x4fe112['amountUSDT']=null,_0x4fe112[_0x15d2a9(0x253)]=null,console[_0x15d2a9(0x255)](_0x15d2a9(0x26d)+_0x9dbf57+'\x20no\x20longer\x20PAID:'),console['log']('\x20\x20\x20Full\x20amount:\x20'+_0x2668ed[_0x15d2a9(0x2bc)]['toFixed'](0x6)+'\x20USDT'),console[_0x15d2a9(0x255)](_0x15d2a9(0x246)+_0x2668ed[_0x15d2a9(0x2bf)]+_0x15d2a9(0x314)+_0x1048e8+'%'),console[_0x15d2a9(0x255)](_0x15d2a9(0x2b9)+_0x270731[_0x15d2a9(0x27d)](0x6)+_0x15d2a9(0x242)+_0x1048e8+_0x15d2a9(0x2d7)),console[_0x15d2a9(0x255)]('\x20\x20\x20Subtracted\x20from\x20balance:\x20-'+_0x270731[_0x15d2a9(0x27d)](0x6)+'\x20USDT');}}}_0x322f8a===_0x15d2a9(0x222)&&(_0x572737==='PAID'&&_0x2668ed[_0x15d2a9(0x2bc)]&&console[_0x15d2a9(0x255)]('üí∏\x20CHARGEBACK:\x20Merchant\x20amount\x20already\x20deducted\x20from\x20balance'),_0x39e732&&_0x39e732>0x0&&(_0xdd5833-=_0x39e732,_0x9b9d40-=_0x39e732,console[_0x15d2a9(0x255)](_0x15d2a9(0x2cf)+_0x39e732[_0x15d2a9(0x27d)](0x6)+_0x15d2a9(0x22f))));_0x322f8a===_0x15d2a9(0x28e)&&_0x572737===_0x15d2a9(0x2a9)&&console[_0x15d2a9(0x255)](_0x15d2a9(0x2c7));const _0x1fb9ba=await _0x927b80[_0x15d2a9(0x258)][_0x15d2a9(0x264)]({'where':{'id':_0x9dbf57},'data':_0x4fe112,'include':{'shop':{'select':{'name':!![],'username':!![]}}}});return _0xdd5833!==0x0&&(await _0x927b80[_0x15d2a9(0x22b)][_0x15d2a9(0x264)]({'where':{'id':_0x2668ed['shopId']},'data':{'balance':_0x9b9d40}}),console[_0x15d2a9(0x255)](_0x15d2a9(0x2f8)+_0x2668ed['shopId']+'\x20balance\x20updated:\x20'+_0x2668ed[_0x15d2a9(0x22b)][_0x15d2a9(0x2ea)][_0x15d2a9(0x27d)](0x6)+_0x15d2a9(0x30d)+_0x9b9d40[_0x15d2a9(0x27d)](0x6)+_0x15d2a9(0x2f9)+(_0xdd5833>0x0?'+':'')+_0xdd5833[_0x15d2a9(0x27d)](0x6)+')')),_0x1fb9ba;});return{'id':_0x129ba9['id'],'shopId':_0x129ba9[_0xada181(0x23e)],'gateway':_0x129ba9['gateway'],'amount':_0x129ba9[_0xada181(0x2ff)],'currency':_0x129ba9[_0xada181(0x2e9)],'status':_0x129ba9[_0xada181(0x2fb)],'orderId':_0x129ba9['orderId'],'gatewayOrderId':_0x129ba9[_0xada181(0x1f7)],'customerEmail':_0x129ba9[_0xada181(0x204)],'customerName':_0x129ba9[_0xada181(0x232)],'customerCountry':_0x129ba9[_0xada181(0x2de)],'customerIp':_0x129ba9[_0xada181(0x259)],'customerUa':_0x129ba9[_0xada181(0x20e)],'failureMessage':_0x129ba9[_0xada181(0x2ca)],'adminNotes':_0x129ba9[_0xada181(0x220)],'chargebackAmount':_0x129ba9['chargebackAmount'],'statusChangedBy':_0x129ba9[_0xada181(0x2ee)],'statusChangedAt':_0x129ba9[_0xada181(0x2c3)],'createdAt':_0x129ba9[_0xada181(0x2c9)],'updatedAt':_0x129ba9[_0xada181(0x271)],'shop':_0x129ba9[_0xada181(0x22b)]};}async[a35_0x2100e6(0x29d)](_0x355125,_0x3882d9){const _0x4d8523=a35_0x2100e6,_0x3f1a70=Math[_0x4d8523(0x276)]()[_0x4d8523(0x277)](0x24)['substr'](0x2,0x9);console[_0x4d8523(0x255)](_0x4d8523(0x25a)+_0x3f1a70+_0x4d8523(0x26c)+_0x355125);const _0x33de22={..._0x3882d9};_0x3882d9[_0x4d8523(0x212)]&&_0x3882d9[_0x4d8523(0x212)]['trim']()!==''?(console['log'](_0x4d8523(0x252)+_0x3f1a70+_0x4d8523(0x234)+_0x355125),_0x33de22[_0x4d8523(0x212)]=await bcryptjs_1['default'][_0x4d8523(0x1f3)](_0x3882d9[_0x4d8523(0x212)],0xc)):(console[_0x4d8523(0x255)](_0x4d8523(0x252)+_0x3f1a70+_0x4d8523(0x29f)),delete _0x33de22['password']);_0x3882d9[_0x4d8523(0x2f0)]&&(_0x33de22[_0x4d8523(0x2db)]=_0x3882d9['fullName'],delete _0x33de22[_0x4d8523(0x2f0)]);_0x3882d9[_0x4d8523(0x312)]&&(_0x33de22[_0x4d8523(0x211)]=_0x3882d9[_0x4d8523(0x312)],delete _0x33de22[_0x4d8523(0x312)]);_0x3882d9['merchantUrl']&&(_0x33de22[_0x4d8523(0x316)]=_0x3882d9[_0x4d8523(0x237)],delete _0x33de22[_0x4d8523(0x237)]);if(_0x3882d9[_0x4d8523(0x1e9)]){const _0x44579b=_0x3882d9[_0x4d8523(0x1e9)][_0x4d8523(0x201)](_0x1e6054=>this[_0x4d8523(0x266)](_0x1e6054));console[_0x4d8523(0x255)](_0x4d8523(0x248),_0x3882d9['gateways'],'->',_0x44579b),_0x33de22[_0x4d8523(0x24e)]=JSON['stringify'](_0x44579b),delete _0x33de22[_0x4d8523(0x1e9)];}_0x3882d9['gatewaySettings']&&(console[_0x4d8523(0x255)](_0x4d8523(0x274)+_0x3f1a70+_0x4d8523(0x2da),_0x3882d9['gatewaySettings']),_0x33de22[_0x4d8523(0x26e)]=JSON['stringify'](_0x3882d9[_0x4d8523(0x26e)]),console[_0x4d8523(0x255)]('üîß\x20['+_0x3f1a70+_0x4d8523(0x229),_0x33de22[_0x4d8523(0x26e)]));_0x3882d9[_0x4d8523(0x29c)]&&(_0x3882d9['wallets']['usdtPolygonWallet']!==undefined&&(_0x33de22[_0x4d8523(0x31e)]=_0x3882d9[_0x4d8523(0x29c)]['usdtPolygonWallet']||null),_0x3882d9[_0x4d8523(0x29c)][_0x4d8523(0x2f2)]!==undefined&&(_0x33de22[_0x4d8523(0x2f2)]=_0x3882d9['wallets'][_0x4d8523(0x2f2)]||null),_0x3882d9['wallets'][_0x4d8523(0x22e)]!==undefined&&(_0x33de22[_0x4d8523(0x22e)]=_0x3882d9[_0x4d8523(0x29c)][_0x4d8523(0x22e)]||null),_0x3882d9['wallets'][_0x4d8523(0x285)]!==undefined&&(_0x33de22[_0x4d8523(0x285)]=_0x3882d9[_0x4d8523(0x29c)][_0x4d8523(0x285)]||null),delete _0x33de22[_0x4d8523(0x29c)]);const _0x38e49b=await database_1[_0x4d8523(0x25e)][_0x4d8523(0x22b)][_0x4d8523(0x264)]({'where':{'id':_0x355125},'data':_0x33de22,'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});return console['log'](_0x4d8523(0x280)+_0x3f1a70+_0x4d8523(0x2c5),_0x38e49b[_0x4d8523(0x26e)]),{'id':_0x38e49b['id'],'fullName':_0x38e49b[_0x4d8523(0x2db)],'username':_0x38e49b[_0x4d8523(0x332)],'telegramId':_0x38e49b[_0x4d8523(0x211)],'merchantUrl':_0x38e49b[_0x4d8523(0x316)],'gateways':_0x38e49b[_0x4d8523(0x24e)]?JSON['parse'](_0x38e49b['paymentGateways']):null,'gatewaySettings':_0x38e49b['gatewaySettings']?JSON['parse'](_0x38e49b[_0x4d8523(0x26e)]):null,'publicKey':_0x38e49b[_0x4d8523(0x228)],'wallets':{'usdtPolygonWallet':_0x38e49b[_0x4d8523(0x31e)],'usdtTrcWallet':_0x38e49b[_0x4d8523(0x2f2)],'usdtErcWallet':_0x38e49b[_0x4d8523(0x22e)],'usdcPolygonWallet':_0x38e49b['usdcPolygonWallet']},'status':_0x38e49b[_0x4d8523(0x2fb)],'createdAt':_0x38e49b['createdAt']};}async['suspendUser'](_0x57d6f1){const _0x1dbbbd=a35_0x2100e6,_0x4799bf=await database_1[_0x1dbbbd(0x25e)][_0x1dbbbd(0x22b)][_0x1dbbbd(0x264)]({'where':{'id':_0x57d6f1},'data':{'status':_0x1dbbbd(0x2ed)},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});return{'id':_0x4799bf['id'],'fullName':_0x4799bf[_0x1dbbbd(0x2db)],'username':_0x4799bf[_0x1dbbbd(0x332)],'telegramId':_0x4799bf[_0x1dbbbd(0x211)],'merchantUrl':_0x4799bf['shopUrl'],'gateways':_0x4799bf[_0x1dbbbd(0x24e)]?JSON['parse'](_0x4799bf[_0x1dbbbd(0x24e)]):null,'gatewaySettings':_0x4799bf[_0x1dbbbd(0x26e)]?JSON[_0x1dbbbd(0x318)](_0x4799bf[_0x1dbbbd(0x26e)]):null,'publicKey':_0x4799bf[_0x1dbbbd(0x228)],'wallets':{'usdtPolygonWallet':_0x4799bf[_0x1dbbbd(0x31e)],'usdtTrcWallet':_0x4799bf['usdtTrcWallet'],'usdtErcWallet':_0x4799bf[_0x1dbbbd(0x22e)],'usdcPolygonWallet':_0x4799bf[_0x1dbbbd(0x285)]},'status':_0x4799bf['status'],'createdAt':_0x4799bf[_0x1dbbbd(0x2c9)]};}async[a35_0x2100e6(0x213)](_0x2d02d4){const _0x559d33=a35_0x2100e6,_0x1be5d4=await database_1[_0x559d33(0x25e)]['shop'][_0x559d33(0x264)]({'where':{'id':_0x2d02d4},'data':{'status':_0x559d33(0x1f2)},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});return{'id':_0x1be5d4['id'],'fullName':_0x1be5d4[_0x559d33(0x2db)],'username':_0x1be5d4[_0x559d33(0x332)],'telegramId':_0x1be5d4[_0x559d33(0x211)],'merchantUrl':_0x1be5d4[_0x559d33(0x316)],'gateways':_0x1be5d4['paymentGateways']?JSON['parse'](_0x1be5d4[_0x559d33(0x24e)]):null,'gatewaySettings':_0x1be5d4['gatewaySettings']?JSON[_0x559d33(0x318)](_0x1be5d4[_0x559d33(0x26e)]):null,'publicKey':_0x1be5d4[_0x559d33(0x228)],'wallets':{'usdtPolygonWallet':_0x1be5d4[_0x559d33(0x31e)],'usdtTrcWallet':_0x1be5d4[_0x559d33(0x2f2)],'usdtErcWallet':_0x1be5d4[_0x559d33(0x22e)],'usdcPolygonWallet':_0x1be5d4['usdcPolygonWallet']},'status':_0x1be5d4[_0x559d33(0x2fb)],'createdAt':_0x1be5d4[_0x559d33(0x2c9)]};}async[a35_0x2100e6(0x320)](_0x3815b1){const _0x40b558=a35_0x2100e6,{page:_0x37dfd3,limit:_0x1e4f5e,status:_0x375a7b}=_0x3815b1,_0x3b6f56=(_0x37dfd3-0x1)*_0x1e4f5e,_0x5a728a={};_0x375a7b&&(_0x5a728a[_0x40b558(0x2fb)]=_0x375a7b[_0x40b558(0x21b)]());const [_0x8a28bd,_0x50fb25]=await Promise['all']([database_1[_0x40b558(0x25e)][_0x40b558(0x22b)][_0x40b558(0x223)]({'where':_0x5a728a,'skip':_0x3b6f56,'take':_0x1e4f5e,'orderBy':{'createdAt':_0x40b558(0x307)},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}}),database_1[_0x40b558(0x25e)]['shop'][_0x40b558(0x2bb)]({'where':_0x5a728a})]);return{'users':_0x8a28bd[_0x40b558(0x201)](_0x2ee35c=>{const _0x21648e=_0x40b558,_0x7bdfa3=_0x2ee35c[_0x21648e(0x24e)]?JSON[_0x21648e(0x318)](_0x2ee35c[_0x21648e(0x24e)]):null,_0x221cd4=_0x7bdfa3?_0x7bdfa3[_0x21648e(0x201)](_0x4b69bc=>this[_0x21648e(0x1ee)](_0x4b69bc)):null;return{'id':_0x2ee35c['id'],'fullName':_0x2ee35c['name'],'username':_0x2ee35c[_0x21648e(0x332)],'telegramId':_0x2ee35c['telegram'],'merchantUrl':_0x2ee35c['shopUrl'],'gateways':_0x221cd4,'gatewaySettings':_0x2ee35c[_0x21648e(0x26e)]?JSON[_0x21648e(0x318)](_0x2ee35c[_0x21648e(0x26e)]):null,'publicKey':_0x2ee35c['publicKey'],'wallets':{'usdtPolygonWallet':_0x2ee35c[_0x21648e(0x31e)],'usdtTrcWallet':_0x2ee35c[_0x21648e(0x2f2)],'usdtErcWallet':_0x2ee35c[_0x21648e(0x22e)],'usdcPolygonWallet':_0x2ee35c[_0x21648e(0x285)]},'status':_0x2ee35c[_0x21648e(0x2fb)],'createdAt':_0x2ee35c[_0x21648e(0x2c9)]};}),'pagination':{'page':_0x37dfd3,'limit':_0x1e4f5e,'total':_0x50fb25,'totalPages':Math[_0x40b558(0x268)](_0x50fb25/_0x1e4f5e)}};}async[a35_0x2100e6(0x270)](_0x196a98){const _0x53cfb4=a35_0x2100e6,_0x450865=await database_1['default'][_0x53cfb4(0x22b)][_0x53cfb4(0x251)]({'where':{'id':_0x196a98},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});if(!_0x450865)return null;const _0x3373e3=_0x450865[_0x53cfb4(0x24e)]?JSON[_0x53cfb4(0x318)](_0x450865[_0x53cfb4(0x24e)]):null,_0xc2f05e=_0x3373e3?_0x3373e3[_0x53cfb4(0x201)](_0x559ce6=>this['getGatewayDisplayName'](_0x559ce6)):null;return _0x3373e3&&_0xc2f05e&&console[_0x53cfb4(0x255)](_0x53cfb4(0x214),_0x3373e3,'->',_0xc2f05e),{'id':_0x450865['id'],'fullName':_0x450865[_0x53cfb4(0x2db)],'username':_0x450865[_0x53cfb4(0x332)],'telegramId':_0x450865[_0x53cfb4(0x211)],'merchantUrl':_0x450865[_0x53cfb4(0x316)],'gateways':_0xc2f05e,'gatewaySettings':_0x450865['gatewaySettings']?JSON[_0x53cfb4(0x318)](_0x450865['gatewaySettings']):null,'publicKey':_0x450865[_0x53cfb4(0x228)],'wallets':{'usdtPolygonWallet':_0x450865[_0x53cfb4(0x31e)],'usdtTrcWallet':_0x450865[_0x53cfb4(0x2f2)],'usdtErcWallet':_0x450865[_0x53cfb4(0x22e)],'usdcPolygonWallet':_0x450865[_0x53cfb4(0x285)]},'status':_0x450865[_0x53cfb4(0x2fb)],'createdAt':_0x450865[_0x53cfb4(0x2c9)]};}async[a35_0x2100e6(0x231)](_0x527757){const _0x2573ac=a35_0x2100e6,{fullName:_0x1f5759,username:_0x503e55,password:_0x419816,telegramId:_0x2f862b,merchantUrl:_0x46eb4c,gateways:_0x2fc1cb,gatewaySettings:_0x32b8ee,wallets:_0xdce711}=_0x527757,_0x3d22f6=await database_1[_0x2573ac(0x25e)][_0x2573ac(0x22b)][_0x2573ac(0x251)]({'where':{'username':_0x503e55}});if(_0x3d22f6)throw new Error(_0x2573ac(0x1fa));if(_0x2f862b){const _0x182f27=await database_1[_0x2573ac(0x25e)][_0x2573ac(0x22b)][_0x2573ac(0x251)]({'where':{'telegram':_0x2f862b}});if(_0x182f27)throw new Error(_0x2573ac(0x21d));}const _0x2e09bc=await bcryptjs_1[_0x2573ac(0x25e)][_0x2573ac(0x1f3)](_0x419816,0xc),_0x2cb028=_0x2573ac(0x26a)+crypto_1['default']['randomBytes'](0x20)[_0x2573ac(0x277)](_0x2573ac(0x286)),_0x4ab8f4='sk_'+crypto_1[_0x2573ac(0x25e)][_0x2573ac(0x2bd)](0x20)[_0x2573ac(0x277)](_0x2573ac(0x286)),_0xbf22d0=_0x2fc1cb?_0x2fc1cb[_0x2573ac(0x201)](_0x822458=>this[_0x2573ac(0x266)](_0x822458)):null;_0x2fc1cb&&_0xbf22d0&&console[_0x2573ac(0x255)](_0x2573ac(0x203),_0x2fc1cb,'->',_0xbf22d0);const _0x5d211c=await database_1['default'][_0x2573ac(0x22b)][_0x2573ac(0x1ea)]({'data':{'name':_0x1f5759,'username':_0x503e55,'password':_0x2e09bc,'telegram':_0x2f862b,'shopUrl':_0x46eb4c,'paymentGateways':_0xbf22d0?JSON[_0x2573ac(0x32f)](_0xbf22d0):null,'gatewaySettings':_0x32b8ee?JSON['stringify'](_0x32b8ee):null,'usdtPolygonWallet':_0xdce711?.['usdtPolygonWallet']||null,'usdtTrcWallet':_0xdce711?.['usdtTrcWallet']||null,'usdtErcWallet':_0xdce711?.['usdtErcWallet']||null,'usdcPolygonWallet':_0xdce711?.['usdcPolygonWallet']||null,'publicKey':_0x2cb028,'secretKey':_0x4ab8f4,'status':'ACTIVE'},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});return{'id':_0x5d211c['id'],'fullName':_0x5d211c['name'],'username':_0x5d211c[_0x2573ac(0x332)],'telegramId':_0x5d211c['telegram'],'merchantUrl':_0x5d211c[_0x2573ac(0x316)],'gateways':_0x5d211c[_0x2573ac(0x24e)]?JSON['parse'](_0x5d211c[_0x2573ac(0x24e)]):null,'gatewaySettings':_0x5d211c[_0x2573ac(0x26e)]?JSON[_0x2573ac(0x318)](_0x5d211c[_0x2573ac(0x26e)]):null,'publicKey':_0x5d211c[_0x2573ac(0x228)],'wallets':{'usdtPolygonWallet':_0x5d211c[_0x2573ac(0x31e)],'usdtTrcWallet':_0x5d211c['usdtTrcWallet'],'usdtErcWallet':_0x5d211c[_0x2573ac(0x22e)],'usdcPolygonWallet':_0x5d211c[_0x2573ac(0x285)]},'status':_0x5d211c[_0x2573ac(0x2fb)],'createdAt':_0x5d211c['createdAt']};}async[a35_0x2100e6(0x235)](_0x233289){const _0x17ed25=a35_0x2100e6;await database_1[_0x17ed25(0x25e)][_0x17ed25(0x22b)][_0x17ed25(0x236)]({'where':{'id':_0x233289}});}['generateDailyStatistics'](_0x8a5b80,_0x57303f,_0x41a44c){const _0x41aadc=a35_0x2100e6,_0x55f8e9=new Map(),_0x7b18b0=new Date(_0x57303f);while(_0x7b18b0<=_0x41a44c){const _0x12978a=_0x7b18b0[_0x41aadc(0x2e3)]()['split']('T')[0x0];_0x55f8e9['set'](_0x12978a,{'revenue':0x0,'count':0x0}),_0x7b18b0[_0x41aadc(0x2e7)](_0x7b18b0[_0x41aadc(0x218)]()+0x1);}for(const _0x568cf5 of _0x8a5b80){const _0x3181f1=_0x568cf5[_0x41aadc(0x2c9)][_0x41aadc(0x2e3)]()[_0x41aadc(0x296)]('T')[0x0],_0x1c5e5c=_0x55f8e9[_0x41aadc(0x2b5)](_0x3181f1);_0x1c5e5c&&(_0x1c5e5c['count']+=0x1,_0x568cf5[_0x41aadc(0x2fb)]==='PAID'&&(_0x568cf5[_0x41aadc(0x2bc)]?_0x1c5e5c[_0x41aadc(0x227)]+=_0x568cf5[_0x41aadc(0x2bc)]:console[_0x41aadc(0x255)](_0x41aadc(0x284)+_0x568cf5['id']+_0x41aadc(0x2a6))));}const _0x22f3eb=[],_0x59bf82=[];for(const [_0x2637d1,_0x50fe24]of _0x55f8e9){_0x22f3eb[_0x41aadc(0x2dd)]({'date':_0x2637d1,'amount':Math['round'](_0x50fe24['revenue']*0x64)/0x64}),_0x59bf82['push']({'date':_0x2637d1,'count':_0x50fe24[_0x41aadc(0x2bb)]});}return{'dailyRevenue':_0x22f3eb,'dailyPayments':_0x59bf82};}}exports[a35_0x2100e6(0x27c)]=AdminService;