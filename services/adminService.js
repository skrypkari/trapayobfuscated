'use strict';const a35_0x3afee9=a35_0x2b47;(function(_0x3df8e5,_0x75cc57){const _0x458d26=a35_0x2b47,_0x224b44=_0x3df8e5();while(!![]){try{const _0xa59fda=-parseInt(_0x458d26(0x235))/0x1+-parseInt(_0x458d26(0x2aa))/0x2+parseInt(_0x458d26(0x1de))/0x3+-parseInt(_0x458d26(0x266))/0x4*(parseInt(_0x458d26(0x26e))/0x5)+parseInt(_0x458d26(0x2af))/0x6*(-parseInt(_0x458d26(0x28c))/0x7)+parseInt(_0x458d26(0x227))/0x8*(parseInt(_0x458d26(0x2ab))/0x9)+parseInt(_0x458d26(0x207))/0xa;if(_0xa59fda===_0x75cc57)break;else _0x224b44['push'](_0x224b44['shift']());}catch(_0x229120){_0x224b44['push'](_0x224b44['shift']());}}}(a35_0x9e3f,0xb1d1b));var __importDefault=this&&this[a35_0x3afee9(0x270)]||function(_0x337986){return _0x337986&&_0x337986['__esModule']?_0x337986:{'default':_0x337986};};function a35_0x2b47(_0xa4f45b,_0x4986e5){const _0x9e3f7e=a35_0x9e3f();return a35_0x2b47=function(_0x2b4734,_0x3563ff){_0x2b4734=_0x2b4734-0x1de;let _0x4cb488=_0x9e3f7e[_0x2b4734];return _0x4cb488;},a35_0x2b47(_0xa4f45b,_0x4986e5);}function a35_0x9e3f(){const _0x5a1a36=['\x20\x20\x20🖥️\x20User\x20Agent:\x20','../config/database','455HPvQEY','gateway','__importDefault','getPayoutStats','customerIp','map','\x20\x20\x20🏪\x20Gateway\x20earnings:\x20','📊\x20Merchants\x20awaiting\x20payout:\x20','getFullYear','wallets','getUserById','commission','convertToUSDT','\x20USDT','ceil','30d','✅\x20Using\x20gateway\x20filter:\x20\x27','CHARGEBACK','Error\x20parsing\x20gateway\x20settings\x20for\x20shop\x20','💰\x20Creating\x20payout\x20for\x20shop\x20','✅\x20Payout\x20created:\x20','parse','\x20\x20\x20💰\x20Total\x20payout:\x20','network','merchantUrl','polygon','lte','some','📋\x20Getting\x20merchants\x20selection\x20list...','groupBy','77XSJaoh','\x20order','_count','\x20\x20\x20Current\x20total\x20paid\x20out:\x20','availableBalance','Insufficient\x20balance.\x20Available:\x20','📊\x20Total\x20payments\x20(including\x20failed):\x20','split','Noda','$transaction','periodFrom','custom','telegramId','totalCommissionRate','paymentsCount','periodTo','⚠️\x20Gateway\x20\x27','getGatewayNameById','externalPaymentUrl','asc','\x20USDT\x20from\x20balance','set','gatewaySettings','findUnique','paidOutUSDT','gateways','getAllPayouts','shopId','✅\x20Customer\x20data\x20updated\x20for\x20payment\x20','🔄\x20Converted\x20gateway\x20ID\x20\x27','766510bUXRRe','367515icZBcM','statusChangedBy','KLYME\x20GB','\x20USDT\x20(','557394elglnj','getAllPayments','payout','ACTIVE','admin','polygon_usdc','🔄\x20REFUND:\x20Payment\x20amount\x20already\x20deducted\x20from\x20balance','commissionUSDT','getTime','averageCommissionRate','💰\x20Payment\x20','🔄\x20Updating\x20customer\x20data\x20for\x20payment\x20','deleteUser','📊\x20Sorting\x20payments\x20by\x20','dateFrom','toISOString','date','month','getMonth','\x20status:\x20','count','getAllUsers','shop','PAID','\x20\x20\x20📊\x20Total\x20payments:\x20','📅\x20Period:\x20','year','values','reduce','log','Payment\x20not\x20found','\x20merchants\x20with\x20positive\x20balance','\x20no\x20longer\x20PAID:\x20-','username','\x20\x20\x20Balance:\x20','balance','CoinToPay','customerCountry','getMerchantsAwaitingPayout','\x20active\x20merchants\x20for\x20selection','txid','updatedAt','getMerchantsSelection','Telegram\x20username\x20already\x20exists','2024061VueBdc','📊\x20Getting\x20merchants\x20awaiting\x20payout\x20with\x20filters:','password','toFixed','totalPayments','paidAt','activateUser','💰\x20Found\x20','Error\x20processing\x20payment\x20','update','stringify','insensitive','Username\x20already\x20exists','successUrl','not\x20set','📊\x20Merchant\x20statistics\x20calculated:','💰\x20Current\x20shop\x20balance:\x20','bcryptjs','statusChangedAt','findFirst','\x20USDT\x20(total\x20paid\x20to\x20merchants)','\x20became\x20PAID:\x20+','2020-01-01','hash','./currencyService','publicKey','default','customerUa','\x20USDT\x20(+','\x20\x20\x20👤\x20Merchant\x20earnings:\x20','createPayout','trc20','turnoverUSDT','💰\x20[PAYOUT]\x20Gateway\x20','../types/gateway','payment','totalTurnover','test_gateway','usdcPolygonWallet','erc20','forEach','22885900hvIavH','\x20\x20\x20Total\x20paid\x20out:\x20','📊\x20Getting\x20payments\x20with\x20filters:','name','💸\x20CHARGEBACK\x20penalty:\x20-','\x20\x20\x20💵\x20Available\x20balance:\x20','usdtTrcWallet','failureMessage','updateCustomerData','create','wallet','\x20balance\x20updated:','\x20in\x20','currencyService','entries','pk_','toLowerCase','includes','turnover','telegram','COMPLETED','KLYME\x20DE','defineProperty','90d','amount','sort','randomBytes','\x20USDT\x20to\x20balance','_sum','\x20to\x20','SUSPENDED','usdtPolygonWallet','40SqSLhN','KLYME\x20EU','merchantEarnings','\x20paid\x20payments\x20for\x20analysis','amountUSDT','getPaymentById','getGatewayDisplayName','all','toString','gatewayOrderId','\x20USDT\x20(same\x20as\x20awaiting)','\x20\x20\x20🌐\x20IP:\x20','aggregate','chargebackAmount','1024497BODvyM','period','merchantEarningsUSDT','\x20\x20\x20💰\x20Total\x20turnover:\x20','\x27\x20(from\x20\x27','localeCompare','failUrl','createdAt',':\x20commission\x20=\x20','customerEmail','⚠️\x20Requested\x20gateway\x20\x27','customerName','REFUND','\x20\x20\x20⏳\x20Awaiting\x20payout:\x20','totalAmountUSDT','\x20USDT\x20total','desc','toUpperCase','💰\x20Shop\x20','gatewayEarnings','round','averageCheckUSDT','findMany','📊\x20Calculating\x20payout\x20statistics...','pendingUrl','💳\x20Payout\x20wallet\x20for\x20','\x27\x20not\x20found.\x20Available\x20gateways:\x20','\x27)\x20not\x20found\x20in\x20database,\x20returning\x20empty\x20result','\x20\x20\x20Payout\x20amount:\x20','paymentGateways','whiteUrl','fullName','totalPaidOut','\x20->\x20','📊\x20Getting\x20merchant\x20statistics\x20with\x20filters:','status','usdtErcWallet','📊\x20Payout\x20statistics\x20calculated:','orderId','shopUrl','\x20for\x20shop\x20','length','notes','awaitingPayout','Shop\x20not\x20found','adminNotes','📋\x20Found\x20','error','AdminService','416UNfvqM','currency','\x27\x20to\x20name\x20\x27',',\x20successful:\x20','dateTo','week'];a35_0x9e3f=function(){return _0x5a1a36;};return a35_0x9e3f();}Object[a35_0x3afee9(0x21d)](exports,'__esModule',{'value':!![]}),exports[a35_0x3afee9(0x265)]=void 0x0;const database_1=__importDefault(require(a35_0x3afee9(0x26d))),bcryptjs_1=__importDefault(require(a35_0x3afee9(0x1ef))),crypto_1=__importDefault(require('crypto')),currencyService_1=require(a35_0x3afee9(0x1f6)),gateway_1=require(a35_0x3afee9(0x200));class AdminService{async[a35_0x3afee9(0x271)](){const _0x5a0c0c=a35_0x3afee9;console[_0x5a0c0c(0x2cc)](_0x5a0c0c(0x24c));const _0x296e22=await database_1[_0x5a0c0c(0x1f8)][_0x5a0c0c(0x2c5)][_0x5a0c0c(0x233)]({'_sum':{'balance':!![],'totalPaidOut':!![]},'where':{'status':_0x5a0c0c(0x2b2)}}),_0x38d59a=new Date(),_0x30fb9a=new Date(_0x38d59a[_0x5a0c0c(0x276)](),_0x38d59a[_0x5a0c0c(0x2c1)](),0x1),_0x307c81=new Date(_0x38d59a[_0x5a0c0c(0x276)](),_0x38d59a['getMonth']()+0x1,0x0,0x17,0x3b,0x3b,0x3e7),_0x3acf30=await database_1[_0x5a0c0c(0x1f8)][_0x5a0c0c(0x2b1)][_0x5a0c0c(0x233)]({'_sum':{'amount':!![]},'where':{'createdAt':{'gte':_0x30fb9a,'lte':_0x307c81},'status':_0x5a0c0c(0x21b)}}),_0x10d302=_0x296e22[_0x5a0c0c(0x223)][_0x5a0c0c(0x255)]||0x0,_0x1adf02=_0x296e22[_0x5a0c0c(0x223)]['balance']||0x0,_0x442e6e=_0x3acf30[_0x5a0c0c(0x223)][_0x5a0c0c(0x21f)]||0x0,_0x232706={'totalPayout':Math[_0x5a0c0c(0x249)](_0x10d302*0x64)/0x64,'awaitingPayout':Math['round'](_0x1adf02*0x64)/0x64,'thisMonth':Math[_0x5a0c0c(0x249)](_0x442e6e*0x64)/0x64,'availableBalance':Math[_0x5a0c0c(0x249)](_0x1adf02*0x64)/0x64};return console[_0x5a0c0c(0x2cc)](_0x5a0c0c(0x25a)),console[_0x5a0c0c(0x2cc)](_0x5a0c0c(0x284)+_0x232706['totalPayout']+_0x5a0c0c(0x1f2)),console['log'](_0x5a0c0c(0x242)+_0x232706[_0x5a0c0c(0x260)]+'\x20USDT\x20(total\x20merchant\x20balances)'),console[_0x5a0c0c(0x2cc)](_0x5a0c0c(0x20c)+_0x232706[_0x5a0c0c(0x290)]+_0x5a0c0c(0x231)),console[_0x5a0c0c(0x2cc)]('\x20\x20\x20📅\x20This\x20month:\x20'+_0x232706['thisMonth']+_0x5a0c0c(0x27b)),_0x232706;}async[a35_0x3afee9(0x20f)](_0x2b66a1,_0x55a70a){const _0x230ff5=a35_0x3afee9;console[_0x230ff5(0x2cc)](_0x230ff5(0x2ba)+_0x2b66a1+':',_0x55a70a);const _0x271562=await database_1['default'][_0x230ff5(0x201)]['findUnique']({'where':{'id':_0x2b66a1},'select':{'id':!![],'customerEmail':!![],'customerName':!![],'customerCountry':!![],'customerIp':!![],'customerUa':!![]}});if(!_0x271562)throw new Error(_0x230ff5(0x2cd));const _0x46e0f1={};_0x55a70a[_0x230ff5(0x2d4)]!==undefined&&(_0x46e0f1[_0x230ff5(0x2d4)]=_0x55a70a[_0x230ff5(0x2d4)]||null);_0x55a70a[_0x230ff5(0x272)]!==undefined&&(_0x46e0f1[_0x230ff5(0x272)]=_0x55a70a[_0x230ff5(0x272)]||null);_0x55a70a[_0x230ff5(0x1f9)]!==undefined&&(_0x46e0f1['customerUa']=_0x55a70a['customerUa']||null);const _0x100f1b=await database_1['default'][_0x230ff5(0x201)][_0x230ff5(0x1e7)]({'where':{'id':_0x2b66a1},'data':{..._0x46e0f1,'updatedAt':new Date()},'select':{'id':!![],'customerEmail':!![],'customerName':!![],'customerCountry':!![],'customerIp':!![],'customerUa':!![],'updatedAt':!![]}});return console[_0x230ff5(0x2cc)](_0x230ff5(0x2a8)+_0x2b66a1),console[_0x230ff5(0x2cc)]('\x20\x20\x20🌍\x20Country:\x20'+_0x271562[_0x230ff5(0x2d4)]+_0x230ff5(0x256)+_0x100f1b[_0x230ff5(0x2d4)]),console[_0x230ff5(0x2cc)](_0x230ff5(0x232)+_0x271562[_0x230ff5(0x272)]+'\x20->\x20'+_0x100f1b[_0x230ff5(0x272)]),console[_0x230ff5(0x2cc)](_0x230ff5(0x26c)+(_0x271562[_0x230ff5(0x1f9)]?_0x230ff5(0x2a1):_0x230ff5(0x1ec))+_0x230ff5(0x256)+(_0x100f1b[_0x230ff5(0x1f9)]?'set':_0x230ff5(0x1ec))),_0x100f1b;}async['getSystemStatistics'](_0x1b4625){const _0x2e3c30=a35_0x3afee9,_0x380c30=new Date();let _0x5c2cbb;switch(_0x1b4625){case'7d':_0x5c2cbb=new Date(_0x380c30[_0x2e3c30(0x2b7)]()-0x7*0x18*0x3c*0x3c*0x3e8);break;case _0x2e3c30(0x27d):_0x5c2cbb=new Date(_0x380c30[_0x2e3c30(0x2b7)]()-0x1e*0x18*0x3c*0x3c*0x3e8);break;case _0x2e3c30(0x21e):_0x5c2cbb=new Date(_0x380c30[_0x2e3c30(0x2b7)]()-0x5a*0x18*0x3c*0x3c*0x3e8);break;default:_0x5c2cbb=new Date(_0x380c30[_0x2e3c30(0x2b7)]()-0x1e*0x18*0x3c*0x3c*0x3e8);}const [_0x28e47a,_0x442934,_0x42db47,_0x266a94,_0x17bb85,_0x2c0f14]=await Promise[_0x2e3c30(0x22e)]([database_1['default'][_0x2e3c30(0x2c5)]['count'](),database_1[_0x2e3c30(0x1f8)][_0x2e3c30(0x2c5)]['count']({'where':{'status':_0x2e3c30(0x2b2)}}),database_1[_0x2e3c30(0x1f8)][_0x2e3c30(0x201)]['count']({'where':{'createdAt':{'gte':_0x5c2cbb},'gateway':{'not':_0x2e3c30(0x203)}}}),database_1['default'][_0x2e3c30(0x201)][_0x2e3c30(0x2c3)]({'where':{'status':'PAID','createdAt':{'gte':_0x5c2cbb},'gateway':{'not':'test_gateway'}}}),database_1[_0x2e3c30(0x1f8)]['payment']['findMany']({'where':{'status':_0x2e3c30(0x2c6),'createdAt':{'gte':_0x5c2cbb},'gateway':{'not':_0x2e3c30(0x203)}},'select':{'amount':!![],'currency':!![]}}),database_1['default'][_0x2e3c30(0x201)][_0x2e3c30(0x24b)]({'where':{'gateway':{'not':_0x2e3c30(0x203)}},'take':0xa,'orderBy':{'createdAt':'desc'},'include':{'shop':{'select':{'name':!![],'username':!![]}}}})]);let _0x1016df=0x0;for(const _0x88393b of _0x17bb85){const _0xfcfcc=await currencyService_1[_0x2e3c30(0x214)]['convertToUSDT'](_0x88393b[_0x2e3c30(0x21f)],_0x88393b[_0x2e3c30(0x267)]);_0x1016df+=_0xfcfcc;}const _0x43eea5=_0x42db47>0x0?_0x266a94/_0x42db47*0x64:0x0;return{'totalShops':_0x28e47a,'activeShops':_0x442934,'totalPayments':_0x42db47,'successfulPayments':_0x266a94,'totalRevenue':Math['round'](_0x1016df*0x64)/0x64,'conversionRate':Math[_0x2e3c30(0x249)](_0x43eea5*0x64)/0x64,'recentPayments':_0x2c0f14['map'](_0x33b9c8=>({'id':_0x33b9c8['id'],'amount':_0x33b9c8[_0x2e3c30(0x21f)],'currency':_0x33b9c8[_0x2e3c30(0x267)],'status':_0x33b9c8[_0x2e3c30(0x258)],'gateway':_0x33b9c8[_0x2e3c30(0x26f)],'shop':_0x33b9c8[_0x2e3c30(0x2c5)],'createdAt':_0x33b9c8[_0x2e3c30(0x23c)]}))};}async['getMerchantStatistics'](_0x15ccca){const _0x29434a=a35_0x3afee9;console[_0x29434a(0x2cc)](_0x29434a(0x257),_0x15ccca);let _0x28da8c,_0x54c80f=new Date();if(_0x15ccca[_0x29434a(0x236)]===_0x29434a(0x297)&&_0x15ccca[_0x29434a(0x2bd)]&&_0x15ccca[_0x29434a(0x26a)])_0x28da8c=new Date(_0x15ccca[_0x29434a(0x2bd)]),_0x54c80f=new Date(_0x15ccca[_0x29434a(0x26a)]);else{const _0x3dca96=new Date();switch(_0x15ccca['period']){case _0x29434a(0x26b):_0x28da8c=new Date(_0x3dca96[_0x29434a(0x2b7)]()-0x7*0x18*0x3c*0x3c*0x3e8);break;case _0x29434a(0x2c0):_0x28da8c=new Date(_0x3dca96[_0x29434a(0x2b7)]()-0x1e*0x18*0x3c*0x3c*0x3e8);break;case _0x29434a(0x2c9):_0x28da8c=new Date(_0x3dca96[_0x29434a(0x2b7)]()-0x16d*0x18*0x3c*0x3c*0x3e8);break;case _0x29434a(0x22e):default:_0x28da8c=new Date(_0x29434a(0x1f4));break;}}console[_0x29434a(0x2cc)](_0x29434a(0x2c8)+_0x28da8c[_0x29434a(0x2be)]()+_0x29434a(0x224)+_0x54c80f[_0x29434a(0x2be)]());const _0x3101a3={'status':_0x29434a(0x2c6),'gateway':{'not':_0x29434a(0x203)},'paidAt':{'gte':_0x28da8c,'lte':_0x54c80f}};_0x15ccca[_0x29434a(0x2a7)]&&(_0x3101a3[_0x29434a(0x2a7)]=_0x15ccca['shopId']);const _0x3721c7=await database_1[_0x29434a(0x1f8)]['payment']['findMany']({'where':_0x3101a3,'include':{'shop':{'select':{'id':!![],'name':!![],'username':!![],'gatewaySettings':!![]}}}});console[_0x29434a(0x2cc)](_0x29434a(0x1e5)+_0x3721c7[_0x29434a(0x25e)]+_0x29434a(0x22a));const _0x196fa4={'gateway':{'not':_0x29434a(0x203)},'createdAt':{'gte':_0x28da8c,'lte':_0x54c80f}};_0x15ccca[_0x29434a(0x2a7)]&&(_0x196fa4[_0x29434a(0x2a7)]=_0x15ccca[_0x29434a(0x2a7)]);const _0xb2132c=await database_1[_0x29434a(0x1f8)][_0x29434a(0x201)][_0x29434a(0x2c3)]({'where':_0x196fa4});console['log'](_0x29434a(0x292)+_0xb2132c+_0x29434a(0x269)+_0x3721c7[_0x29434a(0x25e)]);let _0x13ee7e=0x0,_0x5f1cdd=0x0,_0x5b3aa6=0x0;const _0x238ce1={},_0x5071c1={},_0x233bf2={};for(const _0x5529b0 of _0x3721c7){try{const _0x903ada=await currencyService_1['currencyService'][_0x29434a(0x27a)](_0x5529b0[_0x29434a(0x21f)],_0x5529b0[_0x29434a(0x267)]);let _0x4bb117={};if(_0x5529b0[_0x29434a(0x2c5)][_0x29434a(0x2a2)])try{_0x4bb117=JSON['parse'](_0x5529b0[_0x29434a(0x2c5)][_0x29434a(0x2a2)]);}catch(_0x5b54a1){console[_0x29434a(0x264)](_0x29434a(0x280)+_0x5529b0[_0x29434a(0x2a7)]+':',_0x5b54a1);}let _0x5ef7e2={},_0x59ed85=0xa;for(const [_0x4267ea,_0x12d679]of Object[_0x29434a(0x215)](_0x4bb117)){if(_0x4267ea[_0x29434a(0x217)]()===_0x5529b0[_0x29434a(0x26f)]['toLowerCase']()){_0x5ef7e2=_0x12d679,_0x59ed85=_0x12d679[_0x29434a(0x279)]||0xa;break;}}const _0x57eddc=_0x903ada*(_0x59ed85/0x64),_0x2c3f49=_0x903ada-_0x57eddc;_0x13ee7e+=_0x903ada,_0x5f1cdd+=_0x2c3f49,_0x5b3aa6+=_0x57eddc;!_0x238ce1[_0x5529b0[_0x29434a(0x26f)]]&&(_0x238ce1[_0x5529b0[_0x29434a(0x26f)]]={'gateway':_0x5529b0[_0x29434a(0x26f)],'gatewayDisplayName':this['getGatewayDisplayName'](_0x5529b0['gateway']),'paymentsCount':0x0,'turnoverUSDT':0x0,'commissionUSDT':0x0,'merchantEarningsUSDT':0x0,'totalCommissionRate':0x0});_0x238ce1[_0x5529b0[_0x29434a(0x26f)]][_0x29434a(0x29a)]++,_0x238ce1[_0x5529b0[_0x29434a(0x26f)]][_0x29434a(0x1fe)]+=_0x903ada,_0x238ce1[_0x5529b0[_0x29434a(0x26f)]][_0x29434a(0x2b6)]+=_0x57eddc,_0x238ce1[_0x5529b0[_0x29434a(0x26f)]][_0x29434a(0x237)]+=_0x2c3f49,_0x238ce1[_0x5529b0[_0x29434a(0x26f)]][_0x29434a(0x299)]+=_0x59ed85;!_0x15ccca[_0x29434a(0x2a7)]&&(!_0x5071c1[_0x5529b0[_0x29434a(0x2a7)]]&&(_0x5071c1[_0x5529b0[_0x29434a(0x2a7)]]={'shopId':_0x5529b0[_0x29434a(0x2a7)],'shopName':_0x5529b0[_0x29434a(0x2c5)]['name'],'shopUsername':_0x5529b0['shop'][_0x29434a(0x2d0)],'paymentsCount':0x0,'turnoverUSDT':0x0,'commissionUSDT':0x0,'merchantEarningsUSDT':0x0,'paidOutUSDT':0x0,'averageCheckUSDT':0x0}),_0x5071c1[_0x5529b0['shopId']][_0x29434a(0x29a)]++,_0x5071c1[_0x5529b0[_0x29434a(0x2a7)]][_0x29434a(0x1fe)]+=_0x903ada,_0x5071c1[_0x5529b0[_0x29434a(0x2a7)]][_0x29434a(0x2b6)]+=_0x57eddc,_0x5071c1[_0x5529b0[_0x29434a(0x2a7)]]['merchantEarningsUSDT']+=_0x2c3f49);const _0x4ae8b2=_0x5529b0[_0x29434a(0x1e3)]['toISOString']()[_0x29434a(0x293)]('T')[0x0];!_0x233bf2[_0x4ae8b2]&&(_0x233bf2[_0x4ae8b2]={'date':_0x4ae8b2,'turnover':0x0,'merchantEarnings':0x0,'gatewayEarnings':0x0,'paymentsCount':0x0}),_0x233bf2[_0x4ae8b2][_0x29434a(0x219)]+=_0x903ada,_0x233bf2[_0x4ae8b2]['merchantEarnings']+=_0x2c3f49,_0x233bf2[_0x4ae8b2]['gatewayEarnings']+=_0x57eddc,_0x233bf2[_0x4ae8b2]['paymentsCount']++;}catch(_0x3b765d){console[_0x29434a(0x264)](_0x29434a(0x1e6)+_0x5529b0['id']+':',_0x3b765d);}}Object[_0x29434a(0x2ca)](_0x238ce1)[_0x29434a(0x206)](_0x195754=>{const _0x4c737f=_0x29434a;_0x195754[_0x4c737f(0x2b8)]=_0x195754[_0x4c737f(0x29a)]>0x0?_0x195754[_0x4c737f(0x299)]/_0x195754['paymentsCount']:0x0,delete _0x195754[_0x4c737f(0x299)];}),Object[_0x29434a(0x2ca)](_0x5071c1)[_0x29434a(0x206)](_0x550ef8=>{const _0x516481=_0x29434a;_0x550ef8[_0x516481(0x24a)]=_0x550ef8[_0x516481(0x29a)]>0x0?_0x550ef8['turnoverUSDT']/_0x550ef8['paymentsCount']:0x0;});let _0x5d67fa=0x0;if(_0x15ccca['shopId']){const _0x585325=await database_1[_0x29434a(0x1f8)][_0x29434a(0x2b1)][_0x29434a(0x24b)]({'where':{'shopId':_0x15ccca[_0x29434a(0x2a7)],'status':_0x29434a(0x21b),'createdAt':{'gte':_0x28da8c,'lte':_0x54c80f}},'select':{'amount':!![]}});_0x5d67fa=_0x585325[_0x29434a(0x2cb)]((_0x213835,_0x5895d6)=>_0x213835+_0x5895d6[_0x29434a(0x21f)],0x0);}const _0x319f55=_0xb2132c,_0x599b20=_0x3721c7['length'],_0x33ac42=_0x599b20>0x0?_0x13ee7e/_0x599b20:0x0,_0x14c4e9=_0x319f55>0x0?Math[_0x29434a(0x249)](_0x599b20/_0x319f55*0x2710)/0x64:0x0,_0x484e03=Math[_0x29434a(0x27c)]((_0x54c80f['getTime']()-_0x28da8c['getTime']())/(0x3e8*0x3c*0x3c*0x18)),_0x5eae49={'totalTurnover':Math[_0x29434a(0x249)](_0x13ee7e*0x64)/0x64,'merchantEarnings':Math[_0x29434a(0x249)](_0x5f1cdd*0x64)/0x64,'gatewayEarnings':Math[_0x29434a(0x249)](_0x5b3aa6*0x64)/0x64,'totalPaidOut':Math['round'](_0x5d67fa*0x64)/0x64,'averageCheck':Math[_0x29434a(0x249)](_0x33ac42*0x64)/0x64,'totalPayments':_0x319f55,'successfulPayments':_0x599b20,'conversionRate':_0x14c4e9,'gatewayBreakdown':Object[_0x29434a(0x2ca)](_0x238ce1)['map'](_0x3c3cbe=>({..._0x3c3cbe,'turnoverUSDT':Math[_0x29434a(0x249)](_0x3c3cbe[_0x29434a(0x1fe)]*0x64)/0x64,'commissionUSDT':Math[_0x29434a(0x249)](_0x3c3cbe['commissionUSDT']*0x64)/0x64,'merchantEarningsUSDT':Math[_0x29434a(0x249)](_0x3c3cbe['merchantEarningsUSDT']*0x64)/0x64,'averageCommissionRate':Math[_0x29434a(0x249)](_0x3c3cbe['averageCommissionRate']*0x64)/0x64})),'merchantBreakdown':_0x15ccca[_0x29434a(0x2a7)]?undefined:Object[_0x29434a(0x2ca)](_0x5071c1)[_0x29434a(0x273)](_0x4e9474=>({..._0x4e9474,'turnoverUSDT':Math[_0x29434a(0x249)](_0x4e9474[_0x29434a(0x1fe)]*0x64)/0x64,'commissionUSDT':Math['round'](_0x4e9474[_0x29434a(0x2b6)]*0x64)/0x64,'merchantEarningsUSDT':Math[_0x29434a(0x249)](_0x4e9474[_0x29434a(0x237)]*0x64)/0x64,'paidOutUSDT':Math[_0x29434a(0x249)](_0x4e9474[_0x29434a(0x2a4)]*0x64)/0x64,'averageCheckUSDT':Math[_0x29434a(0x249)](_0x4e9474[_0x29434a(0x24a)]*0x64)/0x64})),'dailyData':Object['values'](_0x233bf2)[_0x29434a(0x273)](_0x11222c=>({..._0x11222c,'turnover':Math[_0x29434a(0x249)](_0x11222c[_0x29434a(0x219)]*0x64)/0x64,'merchantEarnings':Math[_0x29434a(0x249)](_0x11222c[_0x29434a(0x229)]*0x64)/0x64,'gatewayEarnings':Math[_0x29434a(0x249)](_0x11222c[_0x29434a(0x248)]*0x64)/0x64}))[_0x29434a(0x220)]((_0xfc8c65,_0x5dc921)=>_0xfc8c65[_0x29434a(0x2bf)][_0x29434a(0x23a)](_0x5dc921[_0x29434a(0x2bf)])),'periodInfo':{'from':_0x28da8c,'to':_0x54c80f,'periodType':_0x15ccca['period']||'custom','daysCount':_0x484e03}};return console[_0x29434a(0x2cc)](_0x29434a(0x1ed)),console[_0x29434a(0x2cc)](_0x29434a(0x238)+_0x5eae49[_0x29434a(0x202)]+_0x29434a(0x27b)),console[_0x29434a(0x2cc)](_0x29434a(0x1fb)+_0x5eae49[_0x29434a(0x229)]+_0x29434a(0x27b)),console['log'](_0x29434a(0x274)+_0x5eae49[_0x29434a(0x248)]+'\x20USDT'),console['log'](_0x29434a(0x2c7)+_0x5eae49[_0x29434a(0x1e2)]),_0x5eae49;}async[a35_0x3afee9(0x2d9)](){const _0x740db6=a35_0x3afee9;console['log'](_0x740db6(0x28a));const _0x13e426=await database_1['default'][_0x740db6(0x2c5)][_0x740db6(0x24b)]({'where':{'status':_0x740db6(0x2b2)},'select':{'id':!![],'username':!![],'name':!![]},'orderBy':{'name':_0x740db6(0x29f)}});return console['log'](_0x740db6(0x263)+_0x13e426[_0x740db6(0x25e)]+_0x740db6(0x2d6)),_0x13e426[_0x740db6(0x273)](_0x168eff=>({'id':_0x168eff['id'],'username':_0x168eff['username'],'name':_0x168eff[_0x740db6(0x20a)]}));}[a35_0x3afee9(0x22d)](_0x1f24ac){const _0x5ef05b=a35_0x3afee9,_0x5a16bd={'test_gateway':'Test\x20Gateway','plisio':'Plisio','rapyd':'Rapyd','noda':_0x5ef05b(0x294),'cointopay':_0x5ef05b(0x2d3),'klyme_eu':_0x5ef05b(0x228),'klyme_gb':_0x5ef05b(0x2ad),'klyme_de':_0x5ef05b(0x21c)};return _0x5a16bd[_0x1f24ac]||_0x1f24ac;}async[a35_0x3afee9(0x2d5)](_0xf00afb){const _0x428149=a35_0x3afee9,{page:_0x360ac0,limit:_0xadc96f,minAmount:_0x289e32,search:_0x120fe3}=_0xf00afb,_0x196971=(_0x360ac0-0x1)*_0xadc96f;console[_0x428149(0x2cc)](_0x428149(0x1df),_0xf00afb);const _0x428056={'balance':{'gt':0x0},'status':'ACTIVE'};_0x289e32&&(_0x428056[_0x428149(0x2d2)]['gte']=_0x289e32);_0x120fe3&&(_0x428056['OR']=[{'name':{'contains':_0x120fe3,'mode':_0x428149(0x1e9)}},{'username':{'contains':_0x120fe3,'mode':_0x428149(0x1e9)}}]);const [_0x86c580,_0x31ccd7]=await Promise[_0x428149(0x22e)]([database_1[_0x428149(0x1f8)][_0x428149(0x2c5)]['findMany']({'where':_0x428056,'skip':_0x196971,'take':_0xadc96f,'orderBy':{'balance':_0x428149(0x245)},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'balance':!![],'totalPaidOut':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'gatewaySettings':!![],'createdAt':!![]}}),database_1[_0x428149(0x1f8)][_0x428149(0x2c5)][_0x428149(0x2c3)]({'where':_0x428056})]);console[_0x428149(0x2cc)]('💰\x20Found\x20'+_0x86c580[_0x428149(0x25e)]+_0x428149(0x2ce));const _0x3563b4=await Promise[_0x428149(0x22e)](_0x86c580[_0x428149(0x273)](async _0x5c3e42=>{const _0x30e125=_0x428149,[_0x52d5a0,_0x374c16,_0x33ef08]=await Promise[_0x30e125(0x22e)]([database_1[_0x30e125(0x1f8)]['payment'][_0x30e125(0x2c3)]({'where':{'shopId':_0x5c3e42['id'],'status':_0x30e125(0x2c6),'amountUSDT':{'not':null}}}),database_1[_0x30e125(0x1f8)][_0x30e125(0x201)][_0x30e125(0x1f1)]({'where':{'shopId':_0x5c3e42['id'],'status':_0x30e125(0x2c6),'amountUSDT':{'not':null}},'orderBy':{'paidAt':_0x30e125(0x29f)},'select':{'paidAt':!![]}}),database_1['default'][_0x30e125(0x201)][_0x30e125(0x28b)]({'by':[_0x30e125(0x26f)],'where':{'shopId':_0x5c3e42['id'],'status':'PAID','amountUSDT':{'not':null}},'_count':{'id':!![]},'_sum':{'amountUSDT':!![]}})]),_0x27066d=await Promise['all'](_0x33ef08[_0x30e125(0x273)](async _0x713227=>{const _0x53d269=_0x30e125;let _0x882759=0xa;if(_0x5c3e42[_0x53d269(0x2a2)])try{const _0x56441f=JSON[_0x53d269(0x283)](_0x5c3e42['gatewaySettings']);for(const [_0x331971,_0xb2508a]of Object[_0x53d269(0x215)](_0x56441f)){if(_0x331971[_0x53d269(0x217)]()===_0x713227[_0x53d269(0x26f)][_0x53d269(0x217)]()){_0x882759=_0xb2508a[_0x53d269(0x279)]||0xa,console[_0x53d269(0x2cc)](_0x53d269(0x1ff)+_0x713227[_0x53d269(0x26f)]+'\x20for\x20shop\x20'+_0x5c3e42['id']+_0x53d269(0x23d)+_0x882759+'%');break;}}}catch(_0x1e9410){console[_0x53d269(0x264)](_0x53d269(0x280)+_0x5c3e42['id']+':',_0x1e9410);}const _0x50885d=_0x713227[_0x53d269(0x223)][_0x53d269(0x22b)]||0x0,_0x657d4b=_0x50885d*(0x1-_0x882759/0x64);return{'gateway':_0x713227['gateway'],'count':_0x713227['_count']['id'],'amountUSDT':Math['round'](_0x50885d*0x64)/0x64,'amountAfterCommissionUSDT':Math['round'](_0x657d4b*0x64)/0x64,'commission':_0x882759};})),_0x17f117=_0x27066d[_0x30e125(0x2cb)]((_0x442bad,_0x17defb)=>_0x442bad+_0x17defb[_0x30e125(0x22b)],0x0),_0x9728ed=_0x27066d['reduce']((_0x19dc6e,_0x543957)=>_0x19dc6e+_0x543957['amountAfterCommissionUSDT'],0x0);return{'id':_0x5c3e42['id'],'fullName':_0x5c3e42['name'],'username':_0x5c3e42['username'],'telegramId':_0x5c3e42[_0x30e125(0x21a)],'merchantUrl':_0x5c3e42[_0x30e125(0x25c)],'wallets':{'usdtPolygonWallet':_0x5c3e42[_0x30e125(0x226)],'usdtTrcWallet':_0x5c3e42[_0x30e125(0x20d)],'usdtErcWallet':_0x5c3e42[_0x30e125(0x259)],'usdcPolygonWallet':_0x5c3e42[_0x30e125(0x204)]},'totalAmountUSDT':Math[_0x30e125(0x249)](_0x17f117*0x64)/0x64,'totalAmountAfterCommissionUSDT':Math['round'](_0x9728ed*0x64)/0x64,'paymentsCount':_0x52d5a0,'oldestPaymentDate':_0x374c16?.[_0x30e125(0x1e3)]||_0x5c3e42[_0x30e125(0x23c)],'gatewayBreakdown':_0x27066d};})),_0x4f226e=_0x3563b4[_0x428149(0x2cb)]((_0x3b7665,_0x38bb35)=>_0x3b7665+_0x38bb35[_0x428149(0x243)],0x0),_0x580c6c=_0x3563b4[_0x428149(0x2cb)]((_0x44ea93,_0x1c6e1e)=>_0x44ea93+_0x1c6e1e['totalAmountAfterCommissionUSDT'],0x0);return console[_0x428149(0x2cc)](_0x428149(0x275)+_0x31ccd7+'\x20merchants,\x20'+Math['round'](_0x580c6c*0x64)/0x64+_0x428149(0x244)),{'merchants':_0x3563b4,'pagination':{'page':_0x360ac0,'limit':_0xadc96f,'total':_0x31ccd7,'totalPages':Math[_0x428149(0x27c)](_0x31ccd7/_0xadc96f)},'summary':{'totalMerchants':_0x31ccd7,'totalAmountUSDT':Math[_0x428149(0x249)](_0x4f226e*0x64)/0x64,'totalAmountAfterCommissionUSDT':Math[_0x428149(0x249)](_0x580c6c*0x64)/0x64}};}async[a35_0x3afee9(0x1fc)](_0x3c8c23){const _0x524210=a35_0x3afee9,{shopId:_0x2d1aa1,amount:_0xd1fd8d,network:_0x5ab27a,wallet:_0xf9b58b,notes:_0x262df6,txid:_0xc8c439,periodFrom:_0x32d15b,periodTo:_0x3178fb}=_0x3c8c23,_0x3897e9=await database_1[_0x524210(0x1f8)][_0x524210(0x295)](async _0x320250=>{const _0x3d3385=_0x524210,_0xe3e123=await _0x320250['shop']['findUnique']({'where':{'id':_0x2d1aa1},'select':{'id':!![],'name':!![],'username':!![],'balance':!![],'totalPaidOut':!![]}});if(!_0xe3e123)throw new Error(_0x3d3385(0x261));console[_0x3d3385(0x2cc)](_0x3d3385(0x281)+_0xe3e123[_0x3d3385(0x2d0)]+':'),console[_0x3d3385(0x2cc)]('\x20\x20\x20Current\x20balance:\x20'+_0xe3e123[_0x3d3385(0x2d2)][_0x3d3385(0x1e1)](0x6)+_0x3d3385(0x27b)),console[_0x3d3385(0x2cc)](_0x3d3385(0x251)+_0xd1fd8d['toFixed'](0x6)+_0x3d3385(0x27b)),console[_0x3d3385(0x2cc)](_0x3d3385(0x28f)+_0xe3e123['totalPaidOut']['toFixed'](0x6)+_0x3d3385(0x27b));if(_0xc8c439)console[_0x3d3385(0x2cc)]('\x20\x20\x20Transaction\x20hash:\x20'+_0xc8c439);if(_0xe3e123['balance']<_0xd1fd8d)throw new Error(_0x3d3385(0x291)+_0xe3e123[_0x3d3385(0x2d2)][_0x3d3385(0x1e1)](0x6)+'\x20USDT,\x20Requested:\x20'+_0xd1fd8d['toFixed'](0x6)+_0x3d3385(0x27b));let _0x30e74f=_0xf9b58b;if(!_0x30e74f){const _0x3dc0a7=await _0x320250[_0x3d3385(0x2c5)][_0x3d3385(0x2a3)]({'where':{'id':_0x2d1aa1},'select':{'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![]}});if(_0x3dc0a7)switch(_0x5ab27a){case _0x3d3385(0x287):_0x30e74f=_0x3dc0a7[_0x3d3385(0x226)]||undefined;break;case _0x3d3385(0x1fd):_0x30e74f=_0x3dc0a7['usdtTrcWallet']||undefined;break;case _0x3d3385(0x205):_0x30e74f=_0x3dc0a7[_0x3d3385(0x259)]||undefined;break;case _0x3d3385(0x2b4):_0x30e74f=_0x3dc0a7['usdcPolygonWallet']||undefined;break;}}console[_0x3d3385(0x2cc)](_0x3d3385(0x24e)+_0x5ab27a+':\x20'+(_0x30e74f||'not\x20specified'));const _0x21f577=await _0x320250[_0x3d3385(0x2b1)]['create']({'data':{'shopId':_0x2d1aa1,'amount':_0xd1fd8d,'network':_0x5ab27a,'status':_0x3d3385(0x21b),'txid':_0xc8c439,'notes':_0x262df6,'periodFrom':_0x32d15b?new Date(_0x32d15b):null,'periodTo':_0x3178fb?new Date(_0x3178fb):null,'createdAt':new Date(),'paidAt':new Date()}}),_0x23de7e=_0xe3e123[_0x3d3385(0x2d2)]-_0xd1fd8d,_0x5087b8=_0xe3e123['totalPaidOut']+_0xd1fd8d;return await _0x320250[_0x3d3385(0x2c5)][_0x3d3385(0x1e7)]({'where':{'id':_0x2d1aa1},'data':{'balance':_0x23de7e,'totalPaidOut':_0x5087b8}}),console[_0x3d3385(0x2cc)](_0x3d3385(0x247)+_0xe3e123[_0x3d3385(0x2d0)]+_0x3d3385(0x212)),console['log'](_0x3d3385(0x2d1)+_0xe3e123['balance'][_0x3d3385(0x1e1)](0x6)+'\x20->\x20'+_0x23de7e[_0x3d3385(0x1e1)](0x6)+'\x20USDT\x20(-'+_0xd1fd8d[_0x3d3385(0x1e1)](0x6)+')'),console[_0x3d3385(0x2cc)](_0x3d3385(0x208)+_0xe3e123['totalPaidOut']['toFixed'](0x6)+_0x3d3385(0x256)+_0x5087b8['toFixed'](0x6)+_0x3d3385(0x1fa)+_0xd1fd8d['toFixed'](0x6)+')'),{'payout':_0x21f577,'shop':_0xe3e123};});return console[_0x524210(0x2cc)](_0x524210(0x282)+_0x3897e9[_0x524210(0x2b1)]['id']+_0x524210(0x25d)+_0x3897e9[_0x524210(0x2c5)][_0x524210(0x2d0)]+'\x20('+_0xd1fd8d+'\x20USDT)'),{'id':_0x3897e9['payout']['id'],'shopId':_0x3897e9[_0x524210(0x2b1)][_0x524210(0x2a7)],'shopName':_0x3897e9['shop'][_0x524210(0x20a)],'shopUsername':_0x3897e9[_0x524210(0x2c5)]['username'],'amount':_0x3897e9[_0x524210(0x2b1)]['amount'],'network':_0x3897e9[_0x524210(0x2b1)][_0x524210(0x285)],'status':_0x3897e9[_0x524210(0x2b1)][_0x524210(0x258)],'txid':_0x3897e9['payout']['txid'],'notes':_0x3897e9['payout'][_0x524210(0x25f)],'periodFrom':_0x3897e9['payout'][_0x524210(0x296)],'periodTo':_0x3897e9[_0x524210(0x2b1)][_0x524210(0x29b)],'createdAt':_0x3897e9[_0x524210(0x2b1)][_0x524210(0x23c)],'paidAt':_0x3897e9[_0x524210(0x2b1)]['paidAt']};}async[a35_0x3afee9(0x2a6)](_0x43176b){const _0xe55c4b=a35_0x3afee9,{page:_0x484beb,limit:_0x20d086,shopId:_0x5d118b,network:_0x259f59,dateFrom:_0x5be8a2,dateTo:_0xba1c6d,search:_0x416c83}=_0x43176b,_0x19195d=(_0x484beb-0x1)*_0x20d086,_0x16689d={};_0x5d118b&&(_0x16689d[_0xe55c4b(0x2a7)]=_0x5d118b);_0x259f59&&(_0x16689d[_0xe55c4b(0x285)]=_0x259f59);(_0x5be8a2||_0xba1c6d)&&(_0x16689d[_0xe55c4b(0x23c)]={},_0x5be8a2&&(_0x16689d[_0xe55c4b(0x23c)]['gte']=new Date(_0x5be8a2)),_0xba1c6d&&(_0x16689d[_0xe55c4b(0x23c)][_0xe55c4b(0x288)]=new Date(_0xba1c6d)));_0x416c83&&(_0x16689d['OR']=[{'shop':{'name':{'contains':_0x416c83,'mode':_0xe55c4b(0x1e9)}}},{'shop':{'username':{'contains':_0x416c83,'mode':'insensitive'}}},{'notes':{'contains':_0x416c83,'mode':_0xe55c4b(0x1e9)}}]);const [_0x289143,_0x5ba6fb]=await Promise[_0xe55c4b(0x22e)]([database_1[_0xe55c4b(0x1f8)][_0xe55c4b(0x2b1)][_0xe55c4b(0x24b)]({'where':_0x16689d,'skip':_0x19195d,'take':_0x20d086,'orderBy':{'createdAt':_0xe55c4b(0x245)},'select':{'id':!![],'shopId':!![],'amount':!![],'network':!![],'wallet':!![],'status':!![],'txid':!![],'notes':!![],'periodFrom':!![],'periodTo':!![],'createdAt':!![],'paidAt':!![],'shop':{'select':{'name':!![],'username':!![]}}}}),database_1['default'][_0xe55c4b(0x2b1)][_0xe55c4b(0x2c3)]({'where':_0x16689d})]);return{'payouts':_0x289143[_0xe55c4b(0x273)](_0x2fcd4a=>({'id':_0x2fcd4a['id'],'shopId':_0x2fcd4a['shopId'],'shopName':_0x2fcd4a[_0xe55c4b(0x2c5)][_0xe55c4b(0x20a)],'shopUsername':_0x2fcd4a['shop'][_0xe55c4b(0x2d0)],'amount':_0x2fcd4a['amount'],'network':_0x2fcd4a[_0xe55c4b(0x285)],'wallet':_0x2fcd4a[_0xe55c4b(0x211)],'status':_0x2fcd4a[_0xe55c4b(0x258)],'txid':_0x2fcd4a[_0xe55c4b(0x2d7)],'notes':_0x2fcd4a[_0xe55c4b(0x25f)],'periodFrom':_0x2fcd4a[_0xe55c4b(0x296)],'periodTo':_0x2fcd4a[_0xe55c4b(0x29b)],'createdAt':_0x2fcd4a[_0xe55c4b(0x23c)],'paidAt':_0x2fcd4a['paidAt']})),'pagination':{'page':_0x484beb,'limit':_0x20d086,'total':_0x5ba6fb,'totalPages':Math['ceil'](_0x5ba6fb/_0x20d086)}};}async['getPayoutById'](_0x185eb8){const _0x443bc4=a35_0x3afee9,_0x1e4be9=await database_1[_0x443bc4(0x1f8)]['payout'][_0x443bc4(0x2a3)]({'where':{'id':_0x185eb8},'include':{'shop':{'select':{'name':!![],'username':!![]}}}});if(!_0x1e4be9)return null;return{'id':_0x1e4be9['id'],'shopId':_0x1e4be9['shopId'],'shopName':_0x1e4be9[_0x443bc4(0x2c5)][_0x443bc4(0x20a)],'shopUsername':_0x1e4be9['shop'][_0x443bc4(0x2d0)],'amount':_0x1e4be9[_0x443bc4(0x21f)],'network':_0x1e4be9[_0x443bc4(0x285)],'status':_0x1e4be9[_0x443bc4(0x258)],'txid':_0x1e4be9['txid'],'notes':_0x1e4be9['notes'],'periodFrom':_0x1e4be9['periodFrom'],'periodTo':_0x1e4be9[_0x443bc4(0x29b)],'createdAt':_0x1e4be9[_0x443bc4(0x23c)],'paidAt':_0x1e4be9[_0x443bc4(0x1e3)]};}async['deletePayout'](_0x4f1899){const _0x57a31c=a35_0x3afee9;await database_1[_0x57a31c(0x1f8)][_0x57a31c(0x2b1)]['delete']({'where':{'id':_0x4f1899}});}async[a35_0x3afee9(0x2b0)](_0x1a4046){const _0x1d1724=a35_0x3afee9,{page:_0x1546d6,limit:_0xb0ff54,status:_0x510531,gateway:_0xd4f77f,shopId:_0x15738f,dateFrom:_0x3595ef,dateTo:_0x56e305,search:_0x33ebe9,currency:_0x5f3074,sortBy:_0x336196,sortOrder:_0x112c89}=_0x1a4046,_0xef3caf=(_0x1546d6-0x1)*_0xb0ff54;console[_0x1d1724(0x2cc)](_0x1d1724(0x209),_0x1a4046);const _0x2644ce=await database_1['default'][_0x1d1724(0x201)][_0x1d1724(0x28b)]({'by':[_0x1d1724(0x26f)],'_count':{'gateway':!![]}});console['log']('📊\x20Available\x20gateways\x20in\x20database:',_0x2644ce['map'](_0x3bc585=>_0x3bc585[_0x1d1724(0x26f)]+'\x20('+_0x3bc585[_0x1d1724(0x28e)]['gateway']+'\x20payments)'));if(_0xd4f77f){const _0x57eb33=_0x2644ce[_0x1d1724(0x289)](_0xfe9926=>_0xfe9926[_0x1d1724(0x26f)]['toLowerCase']()===_0xd4f77f['toLowerCase']());!_0x57eb33&&_0xd4f77f[_0x1d1724(0x217)]()!=='test_gateway'&&console[_0x1d1724(0x2cc)](_0x1d1724(0x23f)+_0xd4f77f+_0x1d1724(0x24f)+_0x2644ce[_0x1d1724(0x273)](_0x4d6ec9=>_0x4d6ec9[_0x1d1724(0x26f)])['join'](',\x20'));}const _0x1129db={};_0x510531&&(_0x1129db['status']=_0x510531[_0x1d1724(0x246)]());if(!_0xd4f77f)_0x1129db['gateway']={'not':_0x1d1724(0x203)};else{if(_0xd4f77f&&(_0xd4f77f['toLowerCase']()==='test_gateway'||_0xd4f77f==='0000'))_0x1129db[_0x1d1724(0x26f)]=_0x1d1724(0x203);else{let _0x1f599e=_0xd4f77f;const _0x42f380=(0x0,gateway_1[_0x1d1724(0x29d)])(_0xd4f77f);_0x42f380&&(_0x1f599e=_0x42f380,console[_0x1d1724(0x2cc)](_0x1d1724(0x2a9)+_0xd4f77f+_0x1d1724(0x268)+_0x1f599e+'\x27'));const _0x37f983=await database_1[_0x1d1724(0x1f8)][_0x1d1724(0x201)][_0x1d1724(0x2c3)]({'where':{'gateway':_0x1f599e[_0x1d1724(0x217)]()},'take':0x1});_0x37f983===0x0?(console['log'](_0x1d1724(0x29c)+_0x1f599e+_0x1d1724(0x239)+_0xd4f77f+_0x1d1724(0x250)),_0x1129db[_0x1d1724(0x26f)]='NONEXISTENT_GATEWAY_FILTER'):(_0x1129db[_0x1d1724(0x26f)]=_0x1f599e['toLowerCase'](),console['log'](_0x1d1724(0x27e)+_0x1f599e+_0x1d1724(0x239)+_0xd4f77f+'\x27)'));}}console['log']('📊\x20Gateway\x20filter\x20applied:',_0x1129db[_0x1d1724(0x26f)]);_0x15738f&&(_0x1129db[_0x1d1724(0x2a7)]=_0x15738f);_0x5f3074&&(_0x1129db['currency']=_0x5f3074[_0x1d1724(0x246)]());(_0x3595ef||_0x56e305)&&(_0x1129db['createdAt']={},_0x3595ef&&(_0x1129db[_0x1d1724(0x23c)]['gte']=new Date(_0x3595ef)),_0x56e305&&(_0x1129db[_0x1d1724(0x23c)][_0x1d1724(0x288)]=new Date(_0x56e305)));_0x33ebe9&&(_0x1129db['OR']=[{'orderId':{'contains':_0x33ebe9,'mode':_0x1d1724(0x1e9)}},{'gatewayOrderId':{'contains':_0x33ebe9,'mode':'insensitive'}},{'customerEmail':{'contains':_0x33ebe9,'mode':_0x1d1724(0x1e9)}},{'shop':{'name':{'contains':_0x33ebe9,'mode':_0x1d1724(0x1e9)}}},{'shop':{'username':{'contains':_0x33ebe9,'mode':_0x1d1724(0x1e9)}}}]);let _0x5beab8={'createdAt':'desc'};if(_0x336196){const _0x13b315=[_0x1d1724(0x21f),_0x1d1724(0x23c),_0x1d1724(0x2d8),_0x1d1724(0x258),_0x1d1724(0x26f),'currency'],_0x377148=[_0x1d1724(0x29f),_0x1d1724(0x245)];if(_0x13b315[_0x1d1724(0x218)](_0x336196)){const _0x4686fa=_0x377148[_0x1d1724(0x218)](_0x112c89)?_0x112c89:_0x1d1724(0x245);_0x5beab8={[_0x336196]:_0x4686fa},console[_0x1d1724(0x2cc)](_0x1d1724(0x2bc)+_0x336196+_0x1d1724(0x213)+_0x4686fa+_0x1d1724(0x28d));}}const [_0x3b1987,_0x36553f]=await Promise[_0x1d1724(0x22e)]([database_1[_0x1d1724(0x1f8)][_0x1d1724(0x201)][_0x1d1724(0x24b)]({'where':_0x1129db,'skip':_0xef3caf,'take':_0xb0ff54,'orderBy':_0x5beab8,'include':{'shop':{'select':{'name':!![],'username':!![]}}}}),database_1['default'][_0x1d1724(0x201)][_0x1d1724(0x2c3)]({'where':_0x1129db})]);return{'payments':_0x3b1987[_0x1d1724(0x273)](_0x37502a=>({'id':_0x37502a['id'],'shopId':_0x37502a[_0x1d1724(0x2a7)],'gateway':_0x37502a[_0x1d1724(0x26f)],'amount':_0x37502a[_0x1d1724(0x21f)],'currency':_0x37502a['currency'],'status':_0x37502a[_0x1d1724(0x258)],'orderId':_0x37502a['orderId'],'gatewayOrderId':_0x37502a[_0x1d1724(0x230)],'customerEmail':_0x37502a[_0x1d1724(0x23e)],'customerName':_0x37502a[_0x1d1724(0x240)],'customerCountry':_0x37502a['customerCountry'],'customerIp':_0x37502a[_0x1d1724(0x272)],'customerUa':_0x37502a[_0x1d1724(0x1f9)],'failureMessage':_0x37502a[_0x1d1724(0x20e)],'createdAt':_0x37502a['createdAt'],'updatedAt':_0x37502a[_0x1d1724(0x2d8)],'shop':_0x37502a[_0x1d1724(0x2c5)]})),'pagination':{'page':_0x1546d6,'limit':_0xb0ff54,'total':_0x36553f,'totalPages':Math[_0x1d1724(0x27c)](_0x36553f/_0xb0ff54)}};}async[a35_0x3afee9(0x22c)](_0x3c0828){const _0x3781c7=a35_0x3afee9,_0x34d640=await database_1[_0x3781c7(0x1f8)]['payment'][_0x3781c7(0x2a3)]({'where':{'id':_0x3c0828},'include':{'shop':{'select':{'name':!![],'username':!![]}}}});if(!_0x34d640)return null;return{'id':_0x34d640['id'],'shopId':_0x34d640[_0x3781c7(0x2a7)],'gateway':_0x34d640[_0x3781c7(0x26f)],'amount':_0x34d640[_0x3781c7(0x21f)],'currency':_0x34d640[_0x3781c7(0x267)],'status':_0x34d640[_0x3781c7(0x258)],'orderId':_0x34d640[_0x3781c7(0x25b)],'gatewayOrderId':_0x34d640['gatewayOrderId'],'customerEmail':_0x34d640[_0x3781c7(0x23e)],'customerName':_0x34d640['customerName'],'customerCountry':_0x34d640[_0x3781c7(0x2d4)],'customerIp':_0x34d640[_0x3781c7(0x272)],'customerUa':_0x34d640[_0x3781c7(0x1f9)],'failureMessage':_0x34d640[_0x3781c7(0x20e)],'externalPaymentUrl':_0x34d640[_0x3781c7(0x29e)],'successUrl':_0x34d640[_0x3781c7(0x1eb)],'failUrl':_0x34d640[_0x3781c7(0x23b)],'pendingUrl':_0x34d640[_0x3781c7(0x24d)],'whiteUrl':_0x34d640[_0x3781c7(0x253)],'createdAt':_0x34d640['createdAt'],'updatedAt':_0x34d640['updatedAt'],'shop':_0x34d640[_0x3781c7(0x2c5)]};}async['updatePaymentStatus'](_0x2a67e0,_0x20b1e4,_0x233850,_0x3a188c){const _0x3df11e=a35_0x3afee9,_0x476705=await database_1[_0x3df11e(0x1f8)]['$transaction'](async _0x15690a=>{const _0x1cdfac=_0x3df11e,_0xc6489f=await _0x15690a[_0x1cdfac(0x201)][_0x1cdfac(0x2a3)]({'where':{'id':_0x2a67e0},'include':{'shop':{'select':{'id':!![],'name':!![],'username':!![],'balance':!![]}}}});if(!_0xc6489f)throw new Error(_0x1cdfac(0x2cd));const _0x1ff75e=_0xc6489f[_0x1cdfac(0x258)],_0x509c7d=_0x20b1e4[_0x1cdfac(0x246)]();console[_0x1cdfac(0x2cc)]('🔄\x20Admin\x20updating\x20payment\x20'+_0x2a67e0+_0x1cdfac(0x2c2)+_0x1ff75e+'\x20->\x20'+_0x509c7d),console[_0x1cdfac(0x2cc)](_0x1cdfac(0x1ee)+_0xc6489f[_0x1cdfac(0x2c5)][_0x1cdfac(0x2d2)]+'\x20USDT');const _0x4cca4c={'status':_0x509c7d,'updatedAt':new Date(),'statusChangedBy':_0x1cdfac(0x2b3),'statusChangedAt':new Date()};_0x233850&&(_0x4cca4c[_0x1cdfac(0x262)]=_0x233850);_0x509c7d==='CHARGEBACK'&&_0x3a188c&&(_0x4cca4c[_0x1cdfac(0x234)]=_0x3a188c);let _0x3a9486=0x0,_0x1c90d5=_0xc6489f[_0x1cdfac(0x2c5)][_0x1cdfac(0x2d2)];if(_0x509c7d===_0x1cdfac(0x2c6)&&_0x1ff75e!==_0x1cdfac(0x2c6)){_0x4cca4c[_0x1cdfac(0x1e3)]=new Date();const _0x5852e5=await currencyService_1['currencyService'][_0x1cdfac(0x27a)](_0xc6489f[_0x1cdfac(0x21f)],_0xc6489f['currency']);_0x4cca4c['amountUSDT']=_0x5852e5,_0x3a9486=_0x5852e5,_0x1c90d5+=_0x5852e5,console[_0x1cdfac(0x2cc)](_0x1cdfac(0x2b9)+_0x2a67e0+_0x1cdfac(0x1f3)+_0x5852e5['toFixed'](0x6)+_0x1cdfac(0x222));}else _0x1ff75e===_0x1cdfac(0x2c6)&&_0x509c7d!=='PAID'&&(_0xc6489f[_0x1cdfac(0x22b)]&&(_0x3a9486=-_0xc6489f[_0x1cdfac(0x22b)],_0x1c90d5-=_0xc6489f[_0x1cdfac(0x22b)],_0x4cca4c[_0x1cdfac(0x22b)]=null,console[_0x1cdfac(0x2cc)](_0x1cdfac(0x2b9)+_0x2a67e0+_0x1cdfac(0x2cf)+_0xc6489f[_0x1cdfac(0x22b)][_0x1cdfac(0x1e1)](0x6)+_0x1cdfac(0x2a0))));if(_0x509c7d===_0x1cdfac(0x27f)){if(_0x1ff75e===_0x1cdfac(0x2c6)&&_0xc6489f[_0x1cdfac(0x22b)]){}_0x3a188c&&_0x3a188c>0x0&&(_0x3a9486-=_0x3a188c,_0x1c90d5-=_0x3a188c,console[_0x1cdfac(0x2cc)](_0x1cdfac(0x20b)+_0x3a188c['toFixed'](0x6)+_0x1cdfac(0x2a0)));}_0x509c7d===_0x1cdfac(0x241)&&_0x1ff75e==='PAID'&&console['log'](_0x1cdfac(0x2b5));const _0x7a7d51=await _0x15690a[_0x1cdfac(0x201)][_0x1cdfac(0x1e7)]({'where':{'id':_0x2a67e0},'data':_0x4cca4c,'include':{'shop':{'select':{'name':!![],'username':!![]}}}});return _0x3a9486!==0x0&&(await _0x15690a['shop'][_0x1cdfac(0x1e7)]({'where':{'id':_0xc6489f[_0x1cdfac(0x2a7)]},'data':{'balance':_0x1c90d5}}),console[_0x1cdfac(0x2cc)]('💰\x20Shop\x20'+_0xc6489f[_0x1cdfac(0x2a7)]+'\x20balance\x20updated:\x20'+_0xc6489f[_0x1cdfac(0x2c5)][_0x1cdfac(0x2d2)]['toFixed'](0x6)+'\x20->\x20'+_0x1c90d5[_0x1cdfac(0x1e1)](0x6)+_0x1cdfac(0x2ae)+(_0x3a9486>0x0?'+':'')+_0x3a9486[_0x1cdfac(0x1e1)](0x6)+')')),_0x7a7d51;});return{'id':_0x476705['id'],'shopId':_0x476705[_0x3df11e(0x2a7)],'gateway':_0x476705[_0x3df11e(0x26f)],'amount':_0x476705['amount'],'currency':_0x476705['currency'],'status':_0x476705['status'],'orderId':_0x476705[_0x3df11e(0x25b)],'gatewayOrderId':_0x476705[_0x3df11e(0x230)],'customerEmail':_0x476705[_0x3df11e(0x23e)],'customerName':_0x476705['customerName'],'customerCountry':_0x476705[_0x3df11e(0x2d4)],'customerIp':_0x476705[_0x3df11e(0x272)],'customerUa':_0x476705['customerUa'],'failureMessage':_0x476705['failureMessage'],'adminNotes':_0x476705[_0x3df11e(0x262)],'chargebackAmount':_0x476705[_0x3df11e(0x234)],'statusChangedBy':_0x476705[_0x3df11e(0x2ac)],'statusChangedAt':_0x476705[_0x3df11e(0x1f0)],'createdAt':_0x476705[_0x3df11e(0x23c)],'updatedAt':_0x476705[_0x3df11e(0x2d8)],'shop':_0x476705[_0x3df11e(0x2c5)]};}async['updateUser'](_0x538b84,_0x429b09){const _0x9273d3=a35_0x3afee9,_0x1595e8={..._0x429b09};_0x429b09[_0x9273d3(0x1e0)]&&(_0x1595e8[_0x9273d3(0x1e0)]=await bcryptjs_1[_0x9273d3(0x1f8)]['hash'](_0x429b09['password'],0xc));_0x429b09[_0x9273d3(0x254)]&&(_0x1595e8[_0x9273d3(0x20a)]=_0x429b09['fullName'],delete _0x1595e8['fullName']);_0x429b09['telegramId']&&(_0x1595e8[_0x9273d3(0x21a)]=_0x429b09[_0x9273d3(0x298)],delete _0x1595e8['telegramId']);_0x429b09[_0x9273d3(0x286)]&&(_0x1595e8[_0x9273d3(0x25c)]=_0x429b09[_0x9273d3(0x286)],delete _0x1595e8[_0x9273d3(0x286)]);_0x429b09[_0x9273d3(0x2a5)]&&(_0x1595e8[_0x9273d3(0x252)]=JSON[_0x9273d3(0x1e8)](_0x429b09[_0x9273d3(0x2a5)]),delete _0x1595e8[_0x9273d3(0x2a5)]);_0x429b09['gatewaySettings']&&(_0x1595e8[_0x9273d3(0x2a2)]=JSON[_0x9273d3(0x1e8)](_0x429b09['gatewaySettings']),delete _0x1595e8['gatewaySettings']);_0x429b09[_0x9273d3(0x277)]&&(_0x429b09[_0x9273d3(0x277)][_0x9273d3(0x226)]!==undefined&&(_0x1595e8['usdtPolygonWallet']=_0x429b09[_0x9273d3(0x277)]['usdtPolygonWallet']||null),_0x429b09[_0x9273d3(0x277)][_0x9273d3(0x20d)]!==undefined&&(_0x1595e8[_0x9273d3(0x20d)]=_0x429b09[_0x9273d3(0x277)][_0x9273d3(0x20d)]||null),_0x429b09[_0x9273d3(0x277)][_0x9273d3(0x259)]!==undefined&&(_0x1595e8[_0x9273d3(0x259)]=_0x429b09[_0x9273d3(0x277)][_0x9273d3(0x259)]||null),_0x429b09['wallets'][_0x9273d3(0x204)]!==undefined&&(_0x1595e8[_0x9273d3(0x204)]=_0x429b09[_0x9273d3(0x277)][_0x9273d3(0x204)]||null),delete _0x1595e8[_0x9273d3(0x277)]);const _0x461dba=await database_1[_0x9273d3(0x1f8)][_0x9273d3(0x2c5)][_0x9273d3(0x1e7)]({'where':{'id':_0x538b84},'data':_0x1595e8,'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});return{'id':_0x461dba['id'],'fullName':_0x461dba['name'],'username':_0x461dba['username'],'telegramId':_0x461dba['telegram'],'merchantUrl':_0x461dba[_0x9273d3(0x25c)],'gateways':_0x461dba['paymentGateways']?JSON[_0x9273d3(0x283)](_0x461dba[_0x9273d3(0x252)]):null,'gatewaySettings':_0x461dba[_0x9273d3(0x2a2)]?JSON['parse'](_0x461dba[_0x9273d3(0x2a2)]):null,'publicKey':_0x461dba[_0x9273d3(0x1f7)],'wallets':{'usdtPolygonWallet':_0x461dba[_0x9273d3(0x226)],'usdtTrcWallet':_0x461dba[_0x9273d3(0x20d)],'usdtErcWallet':_0x461dba[_0x9273d3(0x259)],'usdcPolygonWallet':_0x461dba[_0x9273d3(0x204)]},'status':_0x461dba[_0x9273d3(0x258)],'createdAt':_0x461dba['createdAt']};}async['suspendUser'](_0x12c39f){const _0x1f5a6b=a35_0x3afee9,_0x10b5fb=await database_1['default'][_0x1f5a6b(0x2c5)][_0x1f5a6b(0x1e7)]({'where':{'id':_0x12c39f},'data':{'status':_0x1f5a6b(0x225)},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});return{'id':_0x10b5fb['id'],'fullName':_0x10b5fb['name'],'username':_0x10b5fb[_0x1f5a6b(0x2d0)],'telegramId':_0x10b5fb[_0x1f5a6b(0x21a)],'merchantUrl':_0x10b5fb[_0x1f5a6b(0x25c)],'gateways':_0x10b5fb['paymentGateways']?JSON[_0x1f5a6b(0x283)](_0x10b5fb[_0x1f5a6b(0x252)]):null,'gatewaySettings':_0x10b5fb[_0x1f5a6b(0x2a2)]?JSON['parse'](_0x10b5fb[_0x1f5a6b(0x2a2)]):null,'publicKey':_0x10b5fb[_0x1f5a6b(0x1f7)],'wallets':{'usdtPolygonWallet':_0x10b5fb['usdtPolygonWallet'],'usdtTrcWallet':_0x10b5fb[_0x1f5a6b(0x20d)],'usdtErcWallet':_0x10b5fb['usdtErcWallet'],'usdcPolygonWallet':_0x10b5fb[_0x1f5a6b(0x204)]},'status':_0x10b5fb[_0x1f5a6b(0x258)],'createdAt':_0x10b5fb['createdAt']};}async[a35_0x3afee9(0x1e4)](_0x449bc5){const _0x57405b=a35_0x3afee9,_0x3cd3ea=await database_1[_0x57405b(0x1f8)]['shop'][_0x57405b(0x1e7)]({'where':{'id':_0x449bc5},'data':{'status':_0x57405b(0x2b2)},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});return{'id':_0x3cd3ea['id'],'fullName':_0x3cd3ea[_0x57405b(0x20a)],'username':_0x3cd3ea['username'],'telegramId':_0x3cd3ea[_0x57405b(0x21a)],'merchantUrl':_0x3cd3ea[_0x57405b(0x25c)],'gateways':_0x3cd3ea[_0x57405b(0x252)]?JSON['parse'](_0x3cd3ea['paymentGateways']):null,'gatewaySettings':_0x3cd3ea[_0x57405b(0x2a2)]?JSON[_0x57405b(0x283)](_0x3cd3ea['gatewaySettings']):null,'publicKey':_0x3cd3ea['publicKey'],'wallets':{'usdtPolygonWallet':_0x3cd3ea[_0x57405b(0x226)],'usdtTrcWallet':_0x3cd3ea[_0x57405b(0x20d)],'usdtErcWallet':_0x3cd3ea['usdtErcWallet'],'usdcPolygonWallet':_0x3cd3ea[_0x57405b(0x204)]},'status':_0x3cd3ea[_0x57405b(0x258)],'createdAt':_0x3cd3ea['createdAt']};}async[a35_0x3afee9(0x2c4)](_0x2424fb){const _0x18659a=a35_0x3afee9,{page:_0x3ea94b,limit:_0x1715fc,status:_0x3b91ff}=_0x2424fb,_0x54f171=(_0x3ea94b-0x1)*_0x1715fc,_0xcfc4f8={};_0x3b91ff&&(_0xcfc4f8[_0x18659a(0x258)]=_0x3b91ff[_0x18659a(0x246)]());const [_0x5ab89e,_0x4af470]=await Promise['all']([database_1[_0x18659a(0x1f8)][_0x18659a(0x2c5)][_0x18659a(0x24b)]({'where':_0xcfc4f8,'skip':_0x54f171,'take':_0x1715fc,'orderBy':{'createdAt':_0x18659a(0x245)},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}}),database_1[_0x18659a(0x1f8)]['shop'][_0x18659a(0x2c3)]({'where':_0xcfc4f8})]);return{'users':_0x5ab89e[_0x18659a(0x273)](_0x4eb070=>({'id':_0x4eb070['id'],'fullName':_0x4eb070['name'],'username':_0x4eb070['username'],'telegramId':_0x4eb070['telegram'],'merchantUrl':_0x4eb070[_0x18659a(0x25c)],'gateways':_0x4eb070['paymentGateways']?JSON[_0x18659a(0x283)](_0x4eb070['paymentGateways']):null,'gatewaySettings':_0x4eb070[_0x18659a(0x2a2)]?JSON[_0x18659a(0x283)](_0x4eb070[_0x18659a(0x2a2)]):null,'publicKey':_0x4eb070[_0x18659a(0x1f7)],'wallets':{'usdtPolygonWallet':_0x4eb070[_0x18659a(0x226)],'usdtTrcWallet':_0x4eb070[_0x18659a(0x20d)],'usdtErcWallet':_0x4eb070[_0x18659a(0x259)],'usdcPolygonWallet':_0x4eb070[_0x18659a(0x204)]},'status':_0x4eb070[_0x18659a(0x258)],'createdAt':_0x4eb070[_0x18659a(0x23c)]})),'pagination':{'page':_0x3ea94b,'limit':_0x1715fc,'total':_0x4af470,'totalPages':Math['ceil'](_0x4af470/_0x1715fc)}};}async[a35_0x3afee9(0x278)](_0x1f603f){const _0x1daaec=a35_0x3afee9,_0x4536dc=await database_1[_0x1daaec(0x1f8)][_0x1daaec(0x2c5)]['findUnique']({'where':{'id':_0x1f603f},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});if(!_0x4536dc)return null;return{'id':_0x4536dc['id'],'fullName':_0x4536dc['name'],'username':_0x4536dc[_0x1daaec(0x2d0)],'telegramId':_0x4536dc['telegram'],'merchantUrl':_0x4536dc['shopUrl'],'gateways':_0x4536dc[_0x1daaec(0x252)]?JSON['parse'](_0x4536dc[_0x1daaec(0x252)]):null,'gatewaySettings':_0x4536dc[_0x1daaec(0x2a2)]?JSON['parse'](_0x4536dc[_0x1daaec(0x2a2)]):null,'publicKey':_0x4536dc[_0x1daaec(0x1f7)],'wallets':{'usdtPolygonWallet':_0x4536dc['usdtPolygonWallet'],'usdtTrcWallet':_0x4536dc[_0x1daaec(0x20d)],'usdtErcWallet':_0x4536dc[_0x1daaec(0x259)],'usdcPolygonWallet':_0x4536dc['usdcPolygonWallet']},'status':_0x4536dc[_0x1daaec(0x258)],'createdAt':_0x4536dc[_0x1daaec(0x23c)]};}async['createUser'](_0x858de2){const _0x30952b=a35_0x3afee9,{fullName:_0x50535d,username:_0x2870b7,password:_0x1028dc,telegramId:_0x2fb1f1,merchantUrl:_0x341de0,gateways:_0x3b3cae,gatewaySettings:_0x28a68f,wallets:_0x30f22e}=_0x858de2,_0x4ade86=await database_1[_0x30952b(0x1f8)][_0x30952b(0x2c5)][_0x30952b(0x2a3)]({'where':{'username':_0x2870b7}});if(_0x4ade86)throw new Error(_0x30952b(0x1ea));if(_0x2fb1f1){const _0x5ab5a5=await database_1['default'][_0x30952b(0x2c5)][_0x30952b(0x2a3)]({'where':{'telegram':_0x2fb1f1}});if(_0x5ab5a5)throw new Error(_0x30952b(0x2da));}const _0x2f0c87=await bcryptjs_1['default'][_0x30952b(0x1f5)](_0x1028dc,0xc),_0x5632ac=_0x30952b(0x216)+crypto_1[_0x30952b(0x1f8)][_0x30952b(0x221)](0x20)[_0x30952b(0x22f)]('hex'),_0x3b60f9='sk_'+crypto_1['default'][_0x30952b(0x221)](0x20)[_0x30952b(0x22f)]('hex'),_0xe4337d=await database_1[_0x30952b(0x1f8)][_0x30952b(0x2c5)][_0x30952b(0x210)]({'data':{'name':_0x50535d,'username':_0x2870b7,'password':_0x2f0c87,'telegram':_0x2fb1f1,'shopUrl':_0x341de0,'paymentGateways':_0x3b3cae?JSON[_0x30952b(0x1e8)](_0x3b3cae):null,'gatewaySettings':_0x28a68f?JSON[_0x30952b(0x1e8)](_0x28a68f):null,'usdtPolygonWallet':_0x30f22e?.['usdtPolygonWallet']||null,'usdtTrcWallet':_0x30f22e?.['usdtTrcWallet']||null,'usdtErcWallet':_0x30f22e?.[_0x30952b(0x259)]||null,'usdcPolygonWallet':_0x30f22e?.[_0x30952b(0x204)]||null,'publicKey':_0x5632ac,'secretKey':_0x3b60f9,'status':'ACTIVE'},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});return{'id':_0xe4337d['id'],'fullName':_0xe4337d[_0x30952b(0x20a)],'username':_0xe4337d[_0x30952b(0x2d0)],'telegramId':_0xe4337d[_0x30952b(0x21a)],'merchantUrl':_0xe4337d[_0x30952b(0x25c)],'gateways':_0xe4337d[_0x30952b(0x252)]?JSON[_0x30952b(0x283)](_0xe4337d[_0x30952b(0x252)]):null,'gatewaySettings':_0xe4337d[_0x30952b(0x2a2)]?JSON[_0x30952b(0x283)](_0xe4337d[_0x30952b(0x2a2)]):null,'publicKey':_0xe4337d['publicKey'],'wallets':{'usdtPolygonWallet':_0xe4337d[_0x30952b(0x226)],'usdtTrcWallet':_0xe4337d['usdtTrcWallet'],'usdtErcWallet':_0xe4337d[_0x30952b(0x259)],'usdcPolygonWallet':_0xe4337d[_0x30952b(0x204)]},'status':_0xe4337d[_0x30952b(0x258)],'createdAt':_0xe4337d[_0x30952b(0x23c)]};}async[a35_0x3afee9(0x2bb)](_0x190617){const _0x56ee4c=a35_0x3afee9;await database_1['default'][_0x56ee4c(0x2c5)]['delete']({'where':{'id':_0x190617}});}}exports[a35_0x3afee9(0x265)]=AdminService;