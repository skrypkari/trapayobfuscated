'use strict';const a48_0x586363=a48_0x5cdf;(function(_0x22f03b,_0xefc1d9){const _0x458a04=a48_0x5cdf,_0x479bcd=_0x22f03b();while(!![]){try{const _0x2eb854=parseInt(_0x458a04(0x2c3))/0x1+parseInt(_0x458a04(0x177))/0x2*(-parseInt(_0x458a04(0x1dd))/0x3)+parseInt(_0x458a04(0x287))/0x4*(-parseInt(_0x458a04(0x299))/0x5)+-parseInt(_0x458a04(0x228))/0x6*(parseInt(_0x458a04(0x1f7))/0x7)+-parseInt(_0x458a04(0x1db))/0x8*(parseInt(_0x458a04(0x1af))/0x9)+parseInt(_0x458a04(0x2b9))/0xa*(-parseInt(_0x458a04(0x1fb))/0xb)+parseInt(_0x458a04(0x24c))/0xc;if(_0x2eb854===_0xefc1d9)break;else _0x479bcd['push'](_0x479bcd['shift']());}catch(_0x490f20){_0x479bcd['push'](_0x479bcd['shift']());}}}(a48_0x187c,0x86ee3));var __importDefault=this&&this['__importDefault']||function(_0x2752e2){const _0x1f42e8=a48_0x5cdf;return _0x2752e2&&_0x2752e2[_0x1f42e8(0x198)]?_0x2752e2:{'default':_0x2752e2};};Object[a48_0x586363(0x27f)](exports,a48_0x586363(0x198),{'value':!![]}),exports[a48_0x586363(0x2e2)]=void 0x0;const database_1=__importDefault(require('../config/database')),bcryptjs_1=__importDefault(require(a48_0x586363(0x281))),crypto_1=__importDefault(require(a48_0x586363(0x29f))),speakeasy_1=__importDefault(require(a48_0x586363(0x175))),qrcode_1=__importDefault(require(a48_0x586363(0x1a4))),currencyService_1=require(a48_0x586363(0x1c5)),telegramBotService_1=require(a48_0x586363(0x1e2)),gateway_1=require(a48_0x586363(0x1b2));class AdminService{async[a48_0x586363(0x184)](){const _0x1789e8=a48_0x586363;console[_0x1789e8(0x260)](_0x1789e8(0x27b));const _0x15741b=await database_1['default']['shop'][_0x1789e8(0x2aa)]({'_sum':{'balance':!![],'totalPaidOut':!![]}}),_0x41553c=await database_1['default']['payment']['count']({'where':{'status':_0x1789e8(0x1ca),'gateway':{'not':_0x1789e8(0x17c)}}}),_0x7eefe1=new Date(),_0x48b386=new Date(_0x7eefe1[_0x1789e8(0x18b)](),_0x7eefe1[_0x1789e8(0x235)](),0x1),_0x38e4a8=new Date(_0x7eefe1['getFullYear'](),_0x7eefe1[_0x1789e8(0x235)]()+0x1,0x0,0x17,0x3b,0x3b,0x3e7),_0x2e64f1=await database_1[_0x1789e8(0x257)][_0x1789e8(0x20a)]['aggregate']({'_sum':{'amount':!![]},'where':{'createdAt':{'gte':_0x48b386,'lte':_0x38e4a8},'status':'COMPLETED'}}),_0x62889f=_0x15741b['_sum']['totalPaidOut']||0x0,_0x4bbb24=_0x15741b[_0x1789e8(0x270)][_0x1789e8(0x1d7)]||0x0,_0x37276b=_0x2e64f1['_sum'][_0x1789e8(0x2a7)]||0x0,_0x52bdb4={'totalPayout':Math['round'](_0x62889f*0x64)/0x64,'awaitingPayout':Math[_0x1789e8(0x1d1)](_0x4bbb24*0x64)/0x64,'thisMonth':Math['round'](_0x37276b*0x64)/0x64,'availableBalance':Math[_0x1789e8(0x1d1)](_0x4bbb24*0x64)/0x64,'totalPayments':_0x41553c};return console[_0x1789e8(0x260)](_0x1789e8(0x294)),console[_0x1789e8(0x260)](_0x1789e8(0x1df)+_0x52bdb4[_0x1789e8(0x1d4)]+_0x1789e8(0x1ab)),console[_0x1789e8(0x260)](_0x1789e8(0x1a0)+_0x52bdb4['awaitingPayout']+_0x1789e8(0x2c4)),console[_0x1789e8(0x260)](_0x1789e8(0x2a0)+_0x52bdb4[_0x1789e8(0x1d0)]+_0x1789e8(0x1d9)),console['log'](_0x1789e8(0x191)+_0x52bdb4['thisMonth']+_0x1789e8(0x1f1)),console[_0x1789e8(0x260)](_0x1789e8(0x2fa)+_0x52bdb4[_0x1789e8(0x25d)]+_0x1789e8(0x2c5)),_0x52bdb4;}async[a48_0x586363(0x280)](_0x17a74c,_0x5f387f){const _0x312e71=a48_0x586363;console['log']('ðŸ”„\x20Updating\x20customer\x20data\x20for\x20payment\x20'+_0x17a74c+':',_0x5f387f);const _0x211edd=await database_1[_0x312e71(0x257)][_0x312e71(0x1a5)][_0x312e71(0x19d)]({'where':{'id':_0x17a74c},'select':{'id':!![],'customerEmail':!![],'customerName':!![],'customerCountry':!![],'customerIp':!![],'customerUa':!![]}});if(!_0x211edd)throw new Error('Payment\x20not\x20found');const _0x500af9={};_0x5f387f[_0x312e71(0x245)]!==undefined&&(_0x500af9[_0x312e71(0x245)]=_0x5f387f[_0x312e71(0x245)]||null);_0x5f387f[_0x312e71(0x26d)]!==undefined&&(_0x500af9['customerIp']=_0x5f387f[_0x312e71(0x26d)]||null);_0x5f387f['customerUa']!==undefined&&(_0x500af9['customerUa']=_0x5f387f[_0x312e71(0x2cd)]||null);const _0x383c02=await database_1[_0x312e71(0x257)][_0x312e71(0x1a5)][_0x312e71(0x2d4)]({'where':{'id':_0x17a74c},'data':{..._0x500af9,'updatedAt':new Date()},'select':{'id':!![],'customerEmail':!![],'customerName':!![],'customerCountry':!![],'customerIp':!![],'customerUa':!![],'updatedAt':!![]}});return console[_0x312e71(0x260)](_0x312e71(0x272)+_0x17a74c),console[_0x312e71(0x260)](_0x312e71(0x1ce)+_0x211edd[_0x312e71(0x245)]+_0x312e71(0x230)+_0x383c02[_0x312e71(0x245)]),console['log'](_0x312e71(0x18a)+_0x211edd['customerIp']+_0x312e71(0x230)+_0x383c02[_0x312e71(0x26d)]),console['log'](_0x312e71(0x2ae)+(_0x211edd[_0x312e71(0x2cd)]?_0x312e71(0x29e):_0x312e71(0x2d0))+_0x312e71(0x230)+(_0x383c02[_0x312e71(0x2cd)]?_0x312e71(0x29e):_0x312e71(0x2d0))),_0x383c02;}async['getSystemStatistics'](_0x2840a4,_0x367cf7){const _0x45cce7=a48_0x586363,_0x406fb0=_0x367cf7?new Date(_0x367cf7):new Date();let _0x1abbfc,_0x5af218;if(_0x2840a4[_0x45cce7(0x217)](_0x45cce7(0x1be))){const _0x1bc11e=_0x2840a4[_0x45cce7(0x2cc)](_0x45cce7(0x1be),'')[_0x45cce7(0x308)]('_');if(_0x1bc11e[_0x45cce7(0x1e7)]===0x2){const _0x69b100=new Date(_0x1bc11e[0x0]),_0xd10bb9=new Date(_0x1bc11e[0x1]);_0x1abbfc=new Date(Date[_0x45cce7(0x2f8)](_0x69b100[_0x45cce7(0x1c2)](),_0x69b100[_0x45cce7(0x30c)](),_0x69b100['getUTCDate'](),0x0,0x0,0x0,0x0)),_0x5af218=new Date(Date[_0x45cce7(0x2f8)](_0xd10bb9['getUTCFullYear'](),_0xd10bb9[_0x45cce7(0x30c)](),_0xd10bb9['getUTCDate'](),0x17,0x3b,0x3b,0x3e7));}else{const _0x45be5b=new Date(Date[_0x45cce7(0x2f8)](_0x406fb0['getUTCFullYear'](),_0x406fb0[_0x45cce7(0x30c)](),_0x406fb0[_0x45cce7(0x282)]()-0x1e));_0x1abbfc=new Date(Date[_0x45cce7(0x2f8)](_0x45be5b[_0x45cce7(0x1c2)](),_0x45be5b[_0x45cce7(0x30c)](),_0x45be5b[_0x45cce7(0x282)](),0x0,0x0,0x0,0x0)),_0x5af218=new Date(Date[_0x45cce7(0x2f8)](_0x406fb0[_0x45cce7(0x1c2)](),_0x406fb0[_0x45cce7(0x30c)](),_0x406fb0['getUTCDate'](),0x17,0x3b,0x3b,0x3e7));}}else{switch(_0x2840a4[_0x45cce7(0x255)]()){case'today':_0x1abbfc=new Date(Date[_0x45cce7(0x2f8)](_0x406fb0['getUTCFullYear'](),_0x406fb0[_0x45cce7(0x30c)](),_0x406fb0[_0x45cce7(0x282)](),0x0,0x0,0x0,0x0)),_0x5af218=new Date(Date['UTC'](_0x406fb0['getUTCFullYear'](),_0x406fb0[_0x45cce7(0x30c)](),_0x406fb0[_0x45cce7(0x282)](),0x17,0x3b,0x3b,0x3e7));break;case _0x45cce7(0x20c):const _0x5abe25=new Date(_0x406fb0);_0x5abe25[_0x45cce7(0x25f)](_0x5abe25[_0x45cce7(0x282)]()-0x1),_0x1abbfc=new Date(Date[_0x45cce7(0x2f8)](_0x5abe25[_0x45cce7(0x1c2)](),_0x5abe25[_0x45cce7(0x30c)](),_0x5abe25[_0x45cce7(0x282)](),0x0,0x0,0x0,0x0)),_0x5af218=new Date(Date['UTC'](_0x5abe25[_0x45cce7(0x1c2)](),_0x5abe25[_0x45cce7(0x30c)](),_0x5abe25[_0x45cce7(0x282)](),0x17,0x3b,0x3b,0x3e7));break;case _0x45cce7(0x1a2):const _0x12dbd6=_0x406fb0[_0x45cce7(0x237)](),_0x4686f0=_0x12dbd6===0x0?-0x6:0x1-_0x12dbd6,_0x286b09=_0x406fb0[_0x45cce7(0x282)]()+_0x4686f0;_0x1abbfc=new Date(Date[_0x45cce7(0x2f8)](_0x406fb0[_0x45cce7(0x1c2)](),_0x406fb0[_0x45cce7(0x30c)](),_0x286b09,0x0,0x0,0x0,0x0)),_0x5af218=new Date(Date['UTC'](_0x406fb0[_0x45cce7(0x1c2)](),_0x406fb0['getUTCMonth'](),_0x406fb0['getUTCDate'](),0x17,0x3b,0x3b,0x3e7));break;case'last_week':const _0x28ec45=new Date(Date[_0x45cce7(0x2f8)](_0x406fb0['getUTCFullYear'](),_0x406fb0[_0x45cce7(0x30c)](),_0x406fb0[_0x45cce7(0x282)]()-0x7)),_0x5ac6a3=_0x28ec45[_0x45cce7(0x237)](),_0x1758ca=_0x5ac6a3===0x0?-0x6:0x1-_0x5ac6a3,_0x4e5419=_0x28ec45[_0x45cce7(0x282)]()+_0x1758ca;_0x1abbfc=new Date(Date[_0x45cce7(0x2f8)](_0x28ec45[_0x45cce7(0x1c2)](),_0x28ec45[_0x45cce7(0x30c)](),_0x4e5419,0x0,0x0,0x0,0x0)),_0x5af218=new Date(Date[_0x45cce7(0x2f8)](_0x28ec45[_0x45cce7(0x1c2)](),_0x28ec45[_0x45cce7(0x30c)](),_0x4e5419+0x6,0x17,0x3b,0x3b,0x3e7));break;case _0x45cce7(0x2fd):_0x1abbfc=new Date(Date['UTC'](_0x406fb0[_0x45cce7(0x1c2)](),_0x406fb0['getUTCMonth'](),0x1,0x0,0x0,0x0,0x0)),_0x5af218=new Date(Date[_0x45cce7(0x2f8)](_0x406fb0['getUTCFullYear'](),_0x406fb0[_0x45cce7(0x30c)](),_0x406fb0[_0x45cce7(0x282)](),0x17,0x3b,0x3b,0x3e7));break;case _0x45cce7(0x185):_0x1abbfc=new Date(Date[_0x45cce7(0x2f8)](_0x406fb0[_0x45cce7(0x1c2)](),_0x406fb0[_0x45cce7(0x30c)]()-0x1,0x1,0x0,0x0,0x0,0x0)),_0x5af218=new Date(Date[_0x45cce7(0x2f8)](_0x406fb0[_0x45cce7(0x1c2)](),_0x406fb0[_0x45cce7(0x30c)](),0x0,0x17,0x3b,0x3b,0x3e7));break;case _0x45cce7(0x210):_0x1abbfc=new Date(Date['UTC'](0x7e9,0x5,0xe,0x0,0x0,0x0,0x0)),_0x5af218=new Date(Date['UTC'](_0x406fb0[_0x45cce7(0x1c2)](),_0x406fb0[_0x45cce7(0x30c)](),_0x406fb0[_0x45cce7(0x282)](),0x17,0x3b,0x3b,0x3e7));break;default:_0x1abbfc=new Date(_0x406fb0['getTime']()-0x1e*0x18*0x3c*0x3c*0x3e8);const _0x43aa2b=new Date(Date[_0x45cce7(0x2f8)](_0x406fb0[_0x45cce7(0x1c2)](),_0x406fb0[_0x45cce7(0x30c)](),_0x406fb0[_0x45cce7(0x282)]()-0x1e));_0x1abbfc=new Date(Date[_0x45cce7(0x2f8)](_0x43aa2b[_0x45cce7(0x1c2)](),_0x43aa2b['getUTCMonth'](),_0x43aa2b[_0x45cce7(0x282)](),0x0,0x0,0x0,0x0)),_0x5af218=new Date(Date[_0x45cce7(0x2f8)](_0x406fb0[_0x45cce7(0x1c2)](),_0x406fb0[_0x45cce7(0x30c)](),_0x406fb0[_0x45cce7(0x282)](),0x17,0x3b,0x3b,0x3e7));}const _0xa6e047={'gte':_0x1abbfc,'lte':_0x5af218};console[_0x45cce7(0x260)]('ðŸ“Š\x20Statistics\x20date\x20range:\x20'+_0x1abbfc[_0x45cce7(0x289)]()+_0x45cce7(0x24a)+_0x5af218[_0x45cce7(0x289)]());const [_0x46c0d2,_0x174e93,_0x4bfaac,_0x364e22,_0x4c8f64,_0x27d908,_0x15878e,_0x3b8c46,_0x3265cb]=await Promise['all']([database_1[_0x45cce7(0x257)][_0x45cce7(0x2e5)]['count'](),database_1['default'][_0x45cce7(0x2e5)]['count']({'where':{'status':_0x45cce7(0x284)}}),database_1[_0x45cce7(0x257)][_0x45cce7(0x1a5)]['count']({'where':{'status':_0x45cce7(0x1ca),'createdAt':_0xa6e047,'gateway':{'not':'test_gateway'}}}),database_1[_0x45cce7(0x257)][_0x45cce7(0x1a5)][_0x45cce7(0x267)]({'where':{'status':_0x45cce7(0x2d5),'createdAt':_0xa6e047,'gateway':{'not':_0x45cce7(0x17c)}}}),database_1[_0x45cce7(0x257)][_0x45cce7(0x1a5)][_0x45cce7(0x267)]({'where':{'status':_0x45cce7(0x1a8),'createdAt':_0xa6e047,'gateway':{'not':_0x45cce7(0x17c)}}}),database_1[_0x45cce7(0x257)]['payment'][_0x45cce7(0x19f)]({'where':{'status':_0x45cce7(0x1ca),'createdAt':_0xa6e047,'gateway':{'not':_0x45cce7(0x17c)}},'select':{'amount':!![],'currency':!![],'amountUSDT':!![],'amountAfterGatewayCommissionUSDT':!![]}}),database_1[_0x45cce7(0x257)][_0x45cce7(0x1a5)][_0x45cce7(0x19f)]({'where':{'gateway':{'not':_0x45cce7(0x17c)}},'take':0xa,'orderBy':{'createdAt':'desc'},'include':{'shop':{'select':{'name':!![],'username':!![]}}}}),database_1[_0x45cce7(0x257)][_0x45cce7(0x1a5)]['findMany']({'where':{'createdAt':_0xa6e047,'gateway':{'not':_0x45cce7(0x17c)}},'select':{'amount':!![],'currency':!![],'status':!![],'amountUSDT':!![],'createdAt':!![]}}),database_1[_0x45cce7(0x257)]['payment'][_0x45cce7(0x19f)]({'where':{'status':_0x45cce7(0x1ca),'gateway':{'not':_0x45cce7(0x17c)}},'select':{'amountUSDT':!![],'amountAfterGatewayCommissionUSDT':!![]}})]);console['log'](_0x45cce7(0x258)+_0x4bfaac);let _0x68e6c0=0x0,_0x19f4bd=0x0;for(const _0x2ee07f of _0x27d908){const _0x2fc54b=_0x2ee07f[_0x45cce7(0x29b)]||0x0;_0x68e6c0+=_0x2fc54b;if(_0x2ee07f[_0x45cce7(0x196)]&&_0x2ee07f[_0x45cce7(0x29b)]){const _0x3ee85e=_0x2ee07f[_0x45cce7(0x29b)]-_0x2ee07f[_0x45cce7(0x196)];_0x19f4bd+=_0x3ee85e;}}let _0xc9f84a=0x0;for(const _0x5e7800 of _0x3265cb){if(_0x5e7800[_0x45cce7(0x196)]&&_0x5e7800[_0x45cce7(0x29b)]){const _0x50a72f=_0x5e7800[_0x45cce7(0x29b)]-_0x5e7800[_0x45cce7(0x196)];_0xc9f84a+=_0x50a72f;}}const _0x31d944=_0x4bfaac>0x0?_0x68e6c0/_0x4bfaac:0x0,_0x2b41ff=this['generateDailyStatistics'](_0x3b8c46,_0x1abbfc,_0x5af218),_0x5f10d8=await database_1[_0x45cce7(0x257)][_0x45cce7(0x1a5)]['count']({'where':{'createdAt':_0xa6e047,'gateway':{'not':'test_gateway'},'status':{'notIn':['PENDING',_0x45cce7(0x30d)]}}}),_0x3d361f=_0x5f10d8>0x0?_0x4bfaac/_0x5f10d8*0x64:0x0;return{'totalShops':_0x46c0d2,'activeShops':_0x174e93,'totalPayments':_0x5f10d8,'successfulPayments':_0x4bfaac,'totalAttempts':_0x5f10d8,'chargebacks':_0x364e22,'refunds':_0x4c8f64,'totalRevenue':Math[_0x45cce7(0x1d1)](_0x68e6c0*0x64)/0x64,'trapayEarnings':Math[_0x45cce7(0x1d1)](_0x19f4bd*0x64)/0x64,'trapayEarningsAllTime':Math[_0x45cce7(0x1d1)](_0xc9f84a*0x64)/0x64,'averagePaymentAmount':Math[_0x45cce7(0x1d1)](_0x31d944*0x64)/0x64,'conversionRate':Math[_0x45cce7(0x1d1)](_0x3d361f*0x64)/0x64,'dailyRevenue':_0x2b41ff[_0x45cce7(0x28f)],'dailyPayments':_0x2b41ff['dailyPayments'],'recentPayments':_0x15878e[_0x45cce7(0x16e)](_0x1360cf=>({'id':_0x1360cf['id'],'amount':_0x1360cf[_0x45cce7(0x2a7)],'currency':_0x1360cf['currency'],'status':_0x1360cf[_0x45cce7(0x233)],'gateway':_0x1360cf[_0x45cce7(0x21d)],'shop':_0x1360cf[_0x45cce7(0x2e5)],'createdAt':_0x1360cf['createdAt']}))};}}async[a48_0x586363(0x251)](_0x2bd66b){const _0x47f57f=a48_0x586363;console['log'](_0x47f57f(0x2d3),_0x2bd66b);let _0x59fbde,_0x41cdef=new Date();if(_0x2bd66b[_0x47f57f(0x23e)]===_0x47f57f(0x206)&&_0x2bd66b[_0x47f57f(0x2b0)]&&_0x2bd66b[_0x47f57f(0x2bc)]){const _0x48feb2=new Date(_0x2bd66b['dateFrom']),_0x10a2d3=new Date(_0x2bd66b[_0x47f57f(0x2bc)]);_0x59fbde=new Date(Date[_0x47f57f(0x2f8)](_0x48feb2['getUTCFullYear'](),_0x48feb2[_0x47f57f(0x30c)](),_0x48feb2[_0x47f57f(0x282)](),0x0,0x0,0x0,0x0)),_0x41cdef=new Date(Date[_0x47f57f(0x2f8)](_0x10a2d3['getUTCFullYear'](),_0x10a2d3[_0x47f57f(0x30c)](),_0x10a2d3[_0x47f57f(0x282)](),0x17,0x3b,0x3b,0x3e7));}else{const _0x2c513f=new Date();switch(_0x2bd66b[_0x47f57f(0x23e)]){case _0x47f57f(0x2f1):_0x59fbde=new Date(_0x2c513f[_0x47f57f(0x214)]()-0x7*0x18*0x3c*0x3c*0x3e8),_0x59fbde['setHours'](0x0,0x0,0x0,0x0),_0x41cdef['setHours'](0x17,0x3b,0x3b,0x3e7);break;case _0x47f57f(0x2d6):_0x59fbde=new Date(Date[_0x47f57f(0x2f8)](_0x2c513f[_0x47f57f(0x1c2)](),_0x2c513f[_0x47f57f(0x30c)](),0x1,0x0,0x0,0x0,0x0)),_0x41cdef=new Date(Date[_0x47f57f(0x2f8)](_0x2c513f[_0x47f57f(0x1c2)](),_0x2c513f[_0x47f57f(0x30c)]()+0x1,0x0,0x17,0x3b,0x3b,0x3e7));break;case _0x47f57f(0x1cc):_0x59fbde=new Date(Date[_0x47f57f(0x2f8)](_0x2c513f['getUTCFullYear'](),_0x2c513f[_0x47f57f(0x30c)]()-0x1,0x1,0x0,0x0,0x0,0x0)),_0x41cdef=new Date(Date['UTC'](_0x2c513f[_0x47f57f(0x1c2)](),_0x2c513f[_0x47f57f(0x30c)](),0x0,0x17,0x3b,0x3b,0x3e7));break;case'year':_0x59fbde=new Date(_0x2c513f[_0x47f57f(0x214)]()-0x16d*0x18*0x3c*0x3c*0x3e8),_0x59fbde[_0x47f57f(0x1d6)](0x0,0x0,0x0,0x0),_0x41cdef[_0x47f57f(0x1d6)](0x17,0x3b,0x3b,0x3e7);break;case _0x47f57f(0x1fd):default:_0x59fbde=new Date(_0x47f57f(0x1f3)),_0x59fbde[_0x47f57f(0x1d6)](0x0,0x0,0x0,0x0),_0x41cdef[_0x47f57f(0x1d6)](0x17,0x3b,0x3b,0x3e7);break;}}console[_0x47f57f(0x260)](_0x47f57f(0x250)+_0x59fbde['toISOString']()+_0x47f57f(0x24a)+_0x41cdef[_0x47f57f(0x289)]());const _0x1974af={'status':_0x47f57f(0x1ca),'gateway':{'not':_0x47f57f(0x17c)},'createdAt':{'gte':_0x59fbde,'lte':_0x41cdef}};_0x2bd66b[_0x47f57f(0x2db)]&&(_0x1974af['shopId']=_0x2bd66b['shopId']);const _0x53059f=await database_1[_0x47f57f(0x257)]['payment'][_0x47f57f(0x19f)]({'where':_0x1974af,'select':{'id':!![],'amount':!![],'currency':!![],'amountUSDT':!![],'amountAfterGatewayCommissionUSDT':!![],'gatewayCommissionRate':!![],'gateway':!![],'shopId':!![],'paidAt':!![],'shop':{'select':{'id':!![],'name':!![],'username':!![],'gatewaySettings':!![]}}}});console[_0x47f57f(0x260)]('ðŸ’°\x20Found\x20'+_0x53059f[_0x47f57f(0x1e7)]+_0x47f57f(0x1ea));const _0x29ef21={'gateway':{'not':_0x47f57f(0x17c)},'status':{'notIn':[_0x47f57f(0x205),_0x47f57f(0x30d)]},'createdAt':{'gte':_0x59fbde,'lte':_0x41cdef}};_0x2bd66b[_0x47f57f(0x2db)]&&(_0x29ef21[_0x47f57f(0x2db)]=_0x2bd66b[_0x47f57f(0x2db)]);const _0x44ae42=await database_1['default']['payment']['count']({'where':_0x29ef21}),_0x31af76={..._0x29ef21,'status':_0x47f57f(0x2d5)},_0x455306={..._0x29ef21,'status':_0x47f57f(0x1a8)},[_0x256494,_0x4f4068]=await Promise['all']([database_1[_0x47f57f(0x257)][_0x47f57f(0x1a5)]['count']({'where':_0x31af76}),database_1['default'][_0x47f57f(0x1a5)]['count']({'where':_0x455306})]);console[_0x47f57f(0x260)](_0x47f57f(0x2e8)+_0x44ae42+_0x47f57f(0x1d8)+_0x53059f['length']+_0x47f57f(0x182)+_0x256494+_0x47f57f(0x2eb)+_0x4f4068);let _0x413f71=0x0,_0x3a2e34=0x0,_0x15e3a3=0x0;const _0x3c2f9e={},_0x35c252={},_0x2a1665={},_0x28db04=new Date(_0x59fbde);while(_0x28db04<=_0x41cdef){const _0x312ae9=_0x28db04[_0x47f57f(0x289)]()['split']('T')[0x0];_0x2a1665[_0x312ae9]={'date':_0x312ae9,'turnover':0x0,'merchantEarnings':0x0,'gatewayEarnings':0x0,'paymentsCount':0x0},_0x28db04[_0x47f57f(0x25f)](_0x28db04[_0x47f57f(0x282)]()+0x1);}for(const _0x252c4c of _0x53059f){try{const _0x4582c7=_0x252c4c[_0x47f57f(0x29b)]||0x0;if(_0x4582c7<=0x0){console[_0x47f57f(0x30a)](_0x47f57f(0x2e6)+_0x252c4c['id']+'\x20has\x20zero\x20or\x20null\x20amountUSDT,\x20skipping...');continue;}let _0x1c8224,_0x41f9ac;if(_0x252c4c[_0x47f57f(0x196)]!==null&&_0x252c4c[_0x47f57f(0x196)]!==undefined)_0x1c8224=_0x252c4c[_0x47f57f(0x196)],_0x41f9ac=_0x4582c7-_0x1c8224,console[_0x47f57f(0x260)](_0x47f57f(0x18e)+_0x252c4c['id']+':\x20'+_0x4582c7[_0x47f57f(0x1b4)](0x6)+_0x47f57f(0x2f3)+_0x1c8224[_0x47f57f(0x1b4)](0x6)+_0x47f57f(0x1f1));else{let _0x33862b={};if(_0x252c4c[_0x47f57f(0x2e5)][_0x47f57f(0x241)])try{_0x33862b=JSON[_0x47f57f(0x208)](_0x252c4c[_0x47f57f(0x2e5)][_0x47f57f(0x241)]);}catch(_0x4765ad){console[_0x47f57f(0x2b8)](_0x47f57f(0x2cf)+_0x252c4c['shopId']+':',_0x4765ad);}let _0x18b705=0x2d;for(const [_0x230204,_0x46bfc7]of Object[_0x47f57f(0x2d7)](_0x33862b)){if(_0x230204[_0x47f57f(0x255)]()===_0x252c4c['gateway'][_0x47f57f(0x255)]()){_0x18b705=_0x46bfc7[_0x47f57f(0x283)]||0x2d;break;}}_0x41f9ac=_0x4582c7*(_0x18b705/0x64),_0x1c8224=_0x4582c7-_0x41f9ac,console[_0x47f57f(0x260)]('ðŸ“Š\x20Calculating\x20commission\x20manually\x20for\x20payment\x20'+_0x252c4c['id']+':\x20'+_0x18b705+_0x47f57f(0x2ff)+_0x4582c7['toFixed'](0x6)+_0x47f57f(0x1f1));}_0x413f71+=_0x4582c7,_0x3a2e34+=_0x1c8224,_0x15e3a3+=_0x41f9ac;let _0x58aa67;_0x252c4c[_0x47f57f(0x17d)]!==null&&_0x252c4c[_0x47f57f(0x17d)]!==undefined?(_0x58aa67=_0x252c4c[_0x47f57f(0x17d)],console[_0x47f57f(0x260)](_0x47f57f(0x215)+_0x252c4c['id']+':\x20'+_0x58aa67+'%')):(_0x58aa67=_0x4582c7>0x0?_0x41f9ac/_0x4582c7*0x64:0x0,console['log'](_0x47f57f(0x305)+_0x252c4c['id']+':\x20'+_0x58aa67['toFixed'](0x2)+'%'));!_0x3c2f9e[_0x252c4c['gateway']]&&(_0x3c2f9e[_0x252c4c['gateway']]={'gateway':_0x252c4c[_0x47f57f(0x21d)],'gatewayDisplayName':this[_0x47f57f(0x1f9)](_0x252c4c[_0x47f57f(0x21d)]),'paymentsCount':0x0,'turnoverUSDT':0x0,'commissionUSDT':0x0,'merchantEarningsUSDT':0x0,'totalCommissionRate':0x0});_0x3c2f9e[_0x252c4c[_0x47f57f(0x21d)]][_0x47f57f(0x271)]++,_0x3c2f9e[_0x252c4c[_0x47f57f(0x21d)]][_0x47f57f(0x1ac)]+=_0x4582c7,_0x3c2f9e[_0x252c4c[_0x47f57f(0x21d)]][_0x47f57f(0x1d5)]+=_0x41f9ac,_0x3c2f9e[_0x252c4c[_0x47f57f(0x21d)]]['merchantEarningsUSDT']+=_0x1c8224,_0x3c2f9e[_0x252c4c[_0x47f57f(0x21d)]][_0x47f57f(0x1ff)]+=_0x58aa67;!_0x2bd66b[_0x47f57f(0x2db)]&&(!_0x35c252[_0x252c4c[_0x47f57f(0x2db)]]&&(_0x35c252[_0x252c4c[_0x47f57f(0x2db)]]={'shopId':_0x252c4c['shopId'],'shopName':_0x252c4c[_0x47f57f(0x2e5)][_0x47f57f(0x2d2)],'shopUsername':_0x252c4c[_0x47f57f(0x2e5)]['username'],'paymentsCount':0x0,'turnoverUSDT':0x0,'commissionUSDT':0x0,'merchantEarningsUSDT':0x0,'paidOutUSDT':0x0,'averageCheckUSDT':0x0}),_0x35c252[_0x252c4c[_0x47f57f(0x2db)]][_0x47f57f(0x271)]++,_0x35c252[_0x252c4c['shopId']][_0x47f57f(0x1ac)]+=_0x4582c7,_0x35c252[_0x252c4c['shopId']][_0x47f57f(0x1d5)]+=_0x41f9ac,_0x35c252[_0x252c4c[_0x47f57f(0x2db)]][_0x47f57f(0x195)]+=_0x1c8224);const _0x58c4ee=_0x252c4c[_0x47f57f(0x254)]['toISOString']()[_0x47f57f(0x308)]('T')[0x0];_0x2a1665[_0x58c4ee]&&(_0x2a1665[_0x58c4ee][_0x47f57f(0x20e)]+=_0x4582c7,_0x2a1665[_0x58c4ee][_0x47f57f(0x248)]+=_0x1c8224,_0x2a1665[_0x58c4ee][_0x47f57f(0x265)]+=_0x41f9ac,_0x2a1665[_0x58c4ee][_0x47f57f(0x271)]++);}catch(_0x1ee237){console[_0x47f57f(0x2b8)](_0x47f57f(0x1fc)+_0x252c4c['id']+':',_0x1ee237);}}Object[_0x47f57f(0x301)](_0x3c2f9e)[_0x47f57f(0x223)](_0x244fdd=>{const _0x5dcc3e=_0x47f57f;_0x244fdd[_0x5dcc3e(0x2ef)]=_0x244fdd[_0x5dcc3e(0x271)]>0x0?_0x244fdd[_0x5dcc3e(0x1ff)]/_0x244fdd['paymentsCount']:0x0,delete _0x244fdd[_0x5dcc3e(0x1ff)];}),Object[_0x47f57f(0x301)](_0x35c252)[_0x47f57f(0x223)](_0x32d861=>{const _0x346ccb=_0x47f57f;_0x32d861[_0x346ccb(0x242)]=_0x32d861[_0x346ccb(0x271)]>0x0?_0x32d861[_0x346ccb(0x1ac)]/_0x32d861['paymentsCount']:0x0;});let _0x550aec=0x0,_0x4e100b=0x0;if(_0x2bd66b[_0x47f57f(0x2db)]){const _0x41cc78=await database_1['default']['payout'][_0x47f57f(0x19f)]({'where':{'shopId':_0x2bd66b[_0x47f57f(0x2db)],'status':'COMPLETED','createdAt':{'gte':_0x59fbde,'lte':_0x41cdef}},'select':{'amount':!![]}});_0x550aec=_0x41cc78[_0x47f57f(0x296)]((_0xd2f1e4,_0x2506d3)=>_0xd2f1e4+_0x2506d3['amount'],0x0);const _0x5b2f25=await database_1[_0x47f57f(0x257)][_0x47f57f(0x20a)]['findMany']({'where':{'shopId':_0x2bd66b[_0x47f57f(0x2db)],'status':_0x47f57f(0x205),'createdAt':{'gte':_0x59fbde,'lte':_0x41cdef}},'select':{'amount':!![]}});_0x4e100b=_0x5b2f25[_0x47f57f(0x296)]((_0x2c3214,_0x490c85)=>_0x2c3214+_0x490c85['amount'],0x0);}const _0x1c19b2=_0x44ae42,_0x58f89a=_0x53059f[_0x47f57f(0x1e7)],_0x5027f4=_0x58f89a>0x0?_0x413f71/_0x58f89a:0x0,_0x54f0e7=_0x1c19b2>0x0?Math[_0x47f57f(0x1d1)](_0x58f89a/_0x1c19b2*0x2710)/0x64:0x0,_0x23e37a=Math['ceil']((_0x41cdef['getTime']()-_0x59fbde[_0x47f57f(0x214)]())/(0x3e8*0x3c*0x3c*0x18)),_0x32157c={'totalTurnover':Math[_0x47f57f(0x1d1)](_0x413f71*0x64)/0x64,'merchantEarnings':Math[_0x47f57f(0x1d1)](_0x3a2e34*0x64)/0x64,'gatewayEarnings':Math['round'](_0x15e3a3*0x64)/0x64,'totalPaidOut':Math[_0x47f57f(0x1d1)](_0x550aec*0x64)/0x64,'pendingPayout':Math['round'](_0x4e100b*0x64)/0x64,'averageCheck':Math[_0x47f57f(0x1d1)](_0x5027f4*0x64)/0x64,'totalPayments':_0x1c19b2,'successfulPayments':_0x58f89a,'conversionRate':_0x54f0e7,'chargebacks':_0x256494,'refunds':_0x4f4068,'gatewayBreakdown':Object['values'](_0x3c2f9e)[_0x47f57f(0x16e)](_0x582883=>({..._0x582883,'turnoverUSDT':Math[_0x47f57f(0x1d1)](_0x582883['turnoverUSDT']*0x64)/0x64,'commissionUSDT':Math['round'](_0x582883[_0x47f57f(0x1d5)]*0x64)/0x64,'merchantEarningsUSDT':Math[_0x47f57f(0x1d1)](_0x582883[_0x47f57f(0x195)]*0x64)/0x64,'averageCommissionRate':Math[_0x47f57f(0x1d1)](_0x582883[_0x47f57f(0x2ef)]*0x64)/0x64})),'merchantBreakdown':_0x2bd66b['shopId']?undefined:Object[_0x47f57f(0x301)](_0x35c252)[_0x47f57f(0x16e)](_0x3e46bc=>({..._0x3e46bc,'turnoverUSDT':Math[_0x47f57f(0x1d1)](_0x3e46bc[_0x47f57f(0x1ac)]*0x64)/0x64,'commissionUSDT':Math[_0x47f57f(0x1d1)](_0x3e46bc[_0x47f57f(0x1d5)]*0x64)/0x64,'merchantEarningsUSDT':Math[_0x47f57f(0x1d1)](_0x3e46bc[_0x47f57f(0x195)]*0x64)/0x64,'paidOutUSDT':Math[_0x47f57f(0x1d1)](_0x3e46bc[_0x47f57f(0x288)]*0x64)/0x64,'averageCheckUSDT':Math[_0x47f57f(0x1d1)](_0x3e46bc[_0x47f57f(0x242)]*0x64)/0x64})),'dailyData':Object['values'](_0x2a1665)['map'](_0x5024de=>({..._0x5024de,'turnover':Math['round'](_0x5024de[_0x47f57f(0x20e)]*0x64)/0x64,'merchantEarnings':Math[_0x47f57f(0x1d1)](_0x5024de[_0x47f57f(0x248)]*0x64)/0x64,'gatewayEarnings':Math[_0x47f57f(0x1d1)](_0x5024de['gatewayEarnings']*0x64)/0x64}))[_0x47f57f(0x292)]((_0x4dc2ba,_0x3629ad)=>_0x4dc2ba[_0x47f57f(0x2df)][_0x47f57f(0x1f8)](_0x3629ad[_0x47f57f(0x2df)])),'periodInfo':{'from':_0x59fbde,'to':_0x41cdef,'periodType':_0x2bd66b[_0x47f57f(0x23e)]||_0x47f57f(0x206),'daysCount':_0x23e37a}};return console[_0x47f57f(0x260)](_0x47f57f(0x27a)),console[_0x47f57f(0x260)](_0x47f57f(0x263)+_0x32157c[_0x47f57f(0x220)]+_0x47f57f(0x1f1)),console['log'](_0x47f57f(0x225)+_0x32157c[_0x47f57f(0x248)]+_0x47f57f(0x1f1)),console[_0x47f57f(0x260)]('\x20\x20\x20ðŸª\x20Gateway\x20earnings:\x20'+_0x32157c[_0x47f57f(0x265)]+_0x47f57f(0x1f1)),console['log'](_0x47f57f(0x2ba)+_0x32157c['totalPaidOut']+_0x47f57f(0x1f1)),console['log'](_0x47f57f(0x18f)+_0x32157c[_0x47f57f(0x176)]+'\x20USDT'),console[_0x47f57f(0x260)](_0x47f57f(0x27d)+_0x32157c[_0x47f57f(0x25d)]),_0x32157c;}async[a48_0x586363(0x17a)](_0x317ab3){const _0x2c7d44=a48_0x586363;console[_0x2c7d44(0x260)](_0x2c7d44(0x2c7),{'hasPayoutHistory':_0x317ab3});let _0x1ea788={};_0x317ab3&&(_0x1ea788[_0x2c7d44(0x2bd)]={'some':{}});const _0x111fcf=await database_1[_0x2c7d44(0x257)]['shop'][_0x2c7d44(0x19f)]({'where':_0x1ea788,'select':{'id':!![],'username':!![],'name':!![]},'orderBy':{'name':_0x2c7d44(0x2ea)}});return console['log']('ðŸ“‹\x20Found\x20'+_0x111fcf[_0x2c7d44(0x1e7)]+'\x20merchants\x20for\x20selection'+(_0x317ab3?_0x2c7d44(0x181):'')),_0x111fcf[_0x2c7d44(0x16e)](_0x491d6f=>({'id':_0x491d6f['id'],'username':_0x491d6f['username'],'name':_0x491d6f[_0x2c7d44(0x2d2)]}));}[a48_0x586363(0x1f9)](_0x5591fe){const _0x50882d=a48_0x586363,_0x5db29e={'test_gateway':'Test\x20Gateway','plisio':'Plisio','rapyd':'Rapyd','noda':_0x50882d(0x22b),'cointopay':_0x50882d(0x190),'cointopay2':_0x50882d(0x279),'klyme_eu':_0x50882d(0x269),'klyme_gb':'KLYME\x20GB','klyme_de':'KLYME\x20DE','mastercard':_0x50882d(0x21a)};return _0x5db29e[_0x5591fe]||_0x5591fe;}[a48_0x586363(0x247)](_0x64fb93){const _0x331bf7=a48_0x586363,_0x44a277={'Test\x20Gateway':_0x331bf7(0x17c),'Plisio':'plisio','Rapyd':_0x331bf7(0x227),'Noda':_0x331bf7(0x28a),'CoinToPay':'cointopay','CoinToPay2':_0x331bf7(0x2fc),'KLYME\x20EU':_0x331bf7(0x1b0),'KLYME\x20GB':_0x331bf7(0x188),'KLYME\x20DE':_0x331bf7(0x22a),'MasterCard':'mastercard'};return _0x44a277[_0x64fb93]||_0x64fb93[_0x331bf7(0x255)]();}async[a48_0x586363(0x1b9)](_0x1b4d4f){const _0x2f12df=a48_0x586363,{page:_0x3f64fc,limit:_0x11031f,minAmount:_0x272f09,search:_0x3a02a9}=_0x1b4d4f;console[_0x2f12df(0x260)](_0x2f12df(0x307),_0x1b4d4f);let _0x29aa10={};_0x3a02a9&&(_0x29aa10[_0x2f12df(0x2d2)]={'contains':_0x3a02a9,'mode':_0x2f12df(0x1bf)});const _0x1498e0=await database_1[_0x2f12df(0x257)][_0x2f12df(0x2e5)][_0x2f12df(0x19f)]({'where':_0x29aa10,'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'balance':!![],'totalPaidOut':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'usdcErcWallet':!![],'gatewaySettings':!![],'createdAt':!![]}}),_0x29a297=_0x1498e0[_0x2f12df(0x277)](_0x42c445=>{const _0xa4ba19=_0x2f12df,_0x5465f7=Math[_0xa4ba19(0x26f)](_0x42c445[_0xa4ba19(0x1d7)]*0x64)/0x64;if(_0x272f09&&_0x5465f7<_0x272f09)return![];return _0x5465f7!==0x0;});_0x29a297[_0x2f12df(0x292)]((_0x4f054b,_0x5254dd)=>_0x5254dd[_0x2f12df(0x1d7)]-_0x4f054b[_0x2f12df(0x1d7)]);const _0x1036c6=_0x29a297[_0x2f12df(0x1e7)],_0x27024e=(_0x3f64fc-0x1)*_0x11031f,_0x163569=_0x29a297[_0x2f12df(0x2c9)](_0x27024e,_0x27024e+_0x11031f);console[_0x2f12df(0x260)]('ðŸ’°\x20Found\x20'+_0x163569[_0x2f12df(0x1e7)]+_0x2f12df(0x231));const _0x1a1498=await Promise[_0x2f12df(0x1fd)](_0x163569['map'](async _0x1302e8=>{const _0x38571f=_0x2f12df,[_0x59ab03,_0x4ba1e6,_0x5e5da0]=await Promise[_0x38571f(0x1fd)]([database_1[_0x38571f(0x257)]['payment']['count']({'where':{'shopId':_0x1302e8['id'],'status':_0x38571f(0x1ca),'gateway':{'not':'test_gateway'}}}),database_1['default'][_0x38571f(0x1a5)][_0x38571f(0x25b)]({'where':{'shopId':_0x1302e8['id'],'status':'PAID','gateway':{'not':_0x38571f(0x17c)}},'orderBy':{'paidAt':'asc'},'select':{'paidAt':!![]}}),database_1[_0x38571f(0x257)]['payment']['groupBy']({'by':[_0x38571f(0x21d)],'where':{'shopId':_0x1302e8['id'],'status':_0x38571f(0x1ca),'gateway':{'not':_0x38571f(0x17c)}},'_count':{'id':!![]},'_sum':{'amountUSDT':!![]}})]),_0x3a059e=new Date(),_0x1406f3=new Date(_0x3a059e[_0x38571f(0x18b)](),_0x3a059e[_0x38571f(0x235)](),0x1),_0x168d6a=new Date(_0x3a059e[_0x38571f(0x18b)](),_0x3a059e[_0x38571f(0x235)]()+0x1,0x0,0x17,0x3b,0x3b,0x3e7),[_0x57b13b,_0x39b35c]=await Promise[_0x38571f(0x1fd)]([database_1[_0x38571f(0x257)]['payout'][_0x38571f(0x2aa)]({'_sum':{'amount':!![]},'where':{'shopId':_0x1302e8['id'],'status':_0x38571f(0x194)}}),database_1[_0x38571f(0x257)][_0x38571f(0x20a)][_0x38571f(0x2aa)]({'_sum':{'amount':!![]},'where':{'shopId':_0x1302e8['id'],'status':_0x38571f(0x194),'createdAt':{'gte':_0x1406f3,'lte':_0x168d6a}}})]),_0xf0b3d2=_0x57b13b[_0x38571f(0x270)]['amount']||0x0,_0x2089cf=_0x39b35c['_sum'][_0x38571f(0x2a7)]||0x0,_0x1fe607=await Promise[_0x38571f(0x1fd)](_0x5e5da0[_0x38571f(0x16e)](async _0x509022=>{const _0xf15879=_0x38571f;let _0x637526=0x2d;if(_0x1302e8['gatewaySettings'])try{const _0x44d706=JSON[_0xf15879(0x208)](_0x1302e8[_0xf15879(0x241)]);for(const [_0x5369e6,_0x10c692]of Object[_0xf15879(0x2d7)](_0x44d706)){if(_0x5369e6[_0xf15879(0x255)]()===_0x509022['gateway'][_0xf15879(0x255)]()){_0x637526=_0x10c692[_0xf15879(0x283)]||0xa,console[_0xf15879(0x260)]('ðŸ’°\x20[PAYOUT]\x20Gateway\x20'+_0x509022['gateway']+'\x20for\x20shop\x20'+_0x1302e8['id']+_0xf15879(0x1a7)+_0x637526+'%');break;}}}catch(_0x15a2cd){console[_0xf15879(0x2b8)](_0xf15879(0x2cf)+_0x1302e8['id']+':',_0x15a2cd);}const _0x1bbb2a=_0x509022[_0xf15879(0x270)]?.[_0xf15879(0x29b)]||0x0,_0x5ad21f=_0x1bbb2a*(0x1-_0x637526/0x64);return{'gateway':_0x509022[_0xf15879(0x21d)],'count':_0x509022[_0xf15879(0x253)]?.['id']||0x0,'amountUSDT':Math[_0xf15879(0x1d1)](_0x1bbb2a*0x64)/0x64,'amountAfterCommissionUSDT':Math[_0xf15879(0x1d1)](_0x5ad21f*0x64)/0x64,'commission':_0x637526};})),_0x422b88=_0x1fe607[_0x38571f(0x296)]((_0x9089dd,_0x1eff1f)=>_0x9089dd+_0x1eff1f[_0x38571f(0x29b)],0x0),_0x24bfe2=_0x1fe607[_0x38571f(0x296)]((_0x3a157a,_0x527176)=>_0x3a157a+_0x527176[_0x38571f(0x1aa)],0x0),_0x282925=_0x1302e8[_0x38571f(0x1d7)];return console[_0x38571f(0x260)](_0x38571f(0x178)+_0x1302e8['username']+':'),console[_0x38571f(0x260)]('\x20\x20\x20ï¿½\x20Total\x20payments\x20turnover:\x20'+_0x422b88[_0x38571f(0x1b4)](0x2)+_0x38571f(0x2dd)),console[_0x38571f(0x260)](_0x38571f(0x2e9)+_0x24bfe2['toFixed'](0x2)+_0x38571f(0x2c8)),console[_0x38571f(0x260)]('\x20\x20\x20âœ…\x20Actual\x20available\x20balance:\x20'+_0x282925[_0x38571f(0x1b4)](0x2)+'\x20USDT\x20(current\x20balance\x20in\x20DB)'),console[_0x38571f(0x260)](_0x38571f(0x2b7)+_0xf0b3d2['toFixed'](0x2)+_0x38571f(0x1e6)),console[_0x38571f(0x260)]('\x20\x20\x20ðŸ¤”\x20Difference:\x20'+(_0x24bfe2-_0xf0b3d2-_0x282925)[_0x38571f(0x1b4)](0x2)+_0x38571f(0x273)),{'id':_0x1302e8['id'],'fullName':_0x1302e8[_0x38571f(0x2d2)],'username':_0x1302e8[_0x38571f(0x244)],'telegramId':_0x1302e8[_0x38571f(0x2b2)],'merchantUrl':_0x1302e8[_0x38571f(0x1cb)],'wallets':{'usdtPolygonWallet':_0x1302e8[_0x38571f(0x200)],'usdtTrcWallet':_0x1302e8[_0x38571f(0x23d)],'usdtErcWallet':_0x1302e8[_0x38571f(0x1e5)],'usdcPolygonWallet':_0x1302e8[_0x38571f(0x20f)],'usdcErcWallet':_0x1302e8[_0x38571f(0x21b)]},'totalAmountUSDT':Math[_0x38571f(0x1d1)](_0x422b88*0x64)/0x64,'totalAmountAfterCommissionUSDT':Math['round'](_0x24bfe2*0x64)/0x64,'currentBalance':Math['floor'](_0x282925*0x64)/0x64,'totalPayout':Math[_0x38571f(0x1d1)](_0xf0b3d2*0x64)/0x64,'thisMonth':Math[_0x38571f(0x1d1)](_0x2089cf*0x64)/0x64,'paymentsCount':_0x59ab03,'oldestPaymentDate':_0x4ba1e6?.[_0x38571f(0x254)]||_0x1302e8[_0x38571f(0x2af)],'gatewayBreakdown':_0x1fe607};})),_0x35e6e6=_0x1a1498[_0x2f12df(0x296)]((_0x27d5a3,_0x34d4f2)=>_0x27d5a3+_0x34d4f2[_0x2f12df(0x16d)],0x0),_0x285e66=_0x1a1498['reduce']((_0x1fd63f,_0x20a86c)=>_0x1fd63f+_0x20a86c['totalAmountAfterCommissionUSDT'],0x0),_0x100569=_0x1a1498[_0x2f12df(0x296)]((_0x4af1f0,_0x4928b0)=>_0x4af1f0+_0x4928b0[_0x2f12df(0x1d4)],0x0),_0x22ec0b=_0x1a1498[_0x2f12df(0x296)]((_0x229aa4,_0x40774e)=>_0x229aa4+_0x40774e[_0x2f12df(0x300)],0x0);return console[_0x2f12df(0x260)]('ðŸ“Š\x20Merchants\x20with\x20rounded\x20balance\x20!=\x200.00:\x20'+_0x1036c6+_0x2f12df(0x1f5)),console[_0x2f12df(0x260)]('\x20\x20\x20ðŸ’°\x20Total\x20payments\x20turnover:\x20'+Math['round'](_0x35e6e6*0x64)/0x64+_0x2f12df(0x2dd)),console['log'](_0x2f12df(0x1c1)+Math['round'](_0x285e66*0x64)/0x64+_0x2f12df(0x1ad)),console[_0x2f12df(0x260)](_0x2f12df(0x30e)+Math[_0x2f12df(0x1d1)](_0x100569*0x64)/0x64+'\x20USDT'),console[_0x2f12df(0x260)](_0x2f12df(0x1fe)+Math['round'](_0x22ec0b*0x64)/0x64+_0x2f12df(0x1f1)),{'merchants':_0x1a1498,'pagination':{'page':_0x3f64fc,'limit':_0x11031f,'total':_0x1036c6,'totalPages':Math[_0x2f12df(0x2f4)](_0x1036c6/_0x11031f)},'summary':{'totalMerchants':_0x1036c6,'totalAmountUSDT':Math[_0x2f12df(0x1d1)](_0x35e6e6*0x64)/0x64,'totalAmountAfterCommissionUSDT':Math[_0x2f12df(0x1d1)](_0x285e66*0x64)/0x64,'totalPayout':Math[_0x2f12df(0x1d1)](_0x100569*0x64)/0x64,'thisMonth':Math[_0x2f12df(0x1d1)](_0x22ec0b*0x64)/0x64}};}async[a48_0x586363(0x174)](_0x570b2e){const _0x4f71f1=a48_0x586363,{shopId:_0x4056fa,amount:_0x8086da,network:_0xf6e337,wallet:_0x333a78,notes:_0x41ffab,txid:_0x53cbf4,periodFrom:_0x3279ef,periodTo:_0x230f78}=_0x570b2e,_0x179a9b=await database_1[_0x4f71f1(0x257)][_0x4f71f1(0x16c)](async _0x5cb2f0=>{const _0x28d436=_0x4f71f1,_0x7d4645=await _0x5cb2f0[_0x28d436(0x2e5)]['findUnique']({'where':{'id':_0x4056fa},'select':{'id':!![],'name':!![],'username':!![],'balance':!![],'totalPaidOut':!![]}});if(!_0x7d4645)throw new Error(_0x28d436(0x21f));console[_0x28d436(0x260)](_0x28d436(0x252)+_0x7d4645[_0x28d436(0x244)]+':'),console[_0x28d436(0x260)](_0x28d436(0x201)+_0x7d4645['balance'][_0x28d436(0x1b4)](0x6)+_0x28d436(0x1f1)),console[_0x28d436(0x260)](_0x28d436(0x29c)+_0x8086da[_0x28d436(0x1b4)](0x6)+_0x28d436(0x1f1)),console[_0x28d436(0x260)](_0x28d436(0x1a9)+_0x7d4645[_0x28d436(0x22c)][_0x28d436(0x1b4)](0x6)+_0x28d436(0x1f1));if(_0x53cbf4)console[_0x28d436(0x260)](_0x28d436(0x21e)+_0x53cbf4);const _0x3b84a3=0.000001,_0x243a7f=Number(_0x7d4645[_0x28d436(0x1d7)]),_0xb83ea5=Number(_0x8086da);console[_0x28d436(0x260)](_0x28d436(0x2ca)),console[_0x28d436(0x260)]('\x20\x20\x20Available\x20(raw):\x20'+_0x7d4645[_0x28d436(0x1d7)]),console[_0x28d436(0x260)](_0x28d436(0x1ee)+_0x243a7f),console[_0x28d436(0x260)]('\x20\x20\x20Requested\x20(number):\x20'+_0xb83ea5),console[_0x28d436(0x260)](_0x28d436(0x2ac)+(_0x243a7f-_0xb83ea5)),console[_0x28d436(0x260)](_0x28d436(0x2e0)+_0x3b84a3);if(_0x243a7f<_0xb83ea5-_0x3b84a3)throw new Error(_0x28d436(0x306)+_0x243a7f[_0x28d436(0x1b4)](0x6)+_0x28d436(0x26c)+_0xb83ea5['toFixed'](0x6)+_0x28d436(0x249)+(_0x243a7f-_0xb83ea5)[_0x28d436(0x1b4)](0x8)+'\x20USDT');console[_0x28d436(0x260)](_0x28d436(0x1ec));const _0x41aadf=Math[_0x28d436(0x219)](_0x243a7f,_0xb83ea5);let _0x4464bb=_0x333a78;console[_0x28d436(0x260)]('ðŸ”\x20Initial\x20wallet\x20from\x20request:\x20'+(_0x333a78||_0x28d436(0x310)));if(!_0x4464bb){console['log'](_0x28d436(0x274));const _0x5ba698=await _0x5cb2f0[_0x28d436(0x2e5)]['findUnique']({'where':{'id':_0x4056fa},'select':{'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'usdcErcWallet':!![]}});console[_0x28d436(0x260)](_0x28d436(0x266),_0x5ba698);if(_0x5ba698)switch(_0xf6e337){case _0x28d436(0x1f0):_0x4464bb=_0x5ba698[_0x28d436(0x200)]||undefined,console['log']('ðŸ”\x20Selected\x20polygon\x20wallet:\x20'+_0x4464bb);break;case'trc20':_0x4464bb=_0x5ba698[_0x28d436(0x23d)]||undefined,console[_0x28d436(0x260)](_0x28d436(0x2a6)+_0x4464bb);break;case _0x28d436(0x25e):_0x4464bb=_0x5ba698['usdtErcWallet']||undefined,console['log'](_0x28d436(0x226)+_0x4464bb);break;case _0x28d436(0x1b5):_0x4464bb=_0x5ba698[_0x28d436(0x20f)]||undefined,console[_0x28d436(0x260)](_0x28d436(0x239)+_0x4464bb);break;case _0x28d436(0x2a3):_0x4464bb=_0x5ba698[_0x28d436(0x21b)]||undefined,console[_0x28d436(0x260)]('ðŸ”\x20Selected\x20erc20_usdc\x20wallet:\x20'+_0x4464bb);break;}}else console[_0x28d436(0x260)](_0x28d436(0x2b6)+_0x4464bb);console[_0x28d436(0x260)](_0x28d436(0x1f6)+_0xf6e337+':\x20'+(_0x4464bb||'not\x20specified')),console[_0x28d436(0x260)](_0x28d436(0x2ed),{'shopId':_0x4056fa,'amount':_0x41aadf,'network':_0xf6e337,'wallet':_0x4464bb,'status':'COMPLETED','txid':_0x53cbf4,'notes':_0x41ffab,'periodFrom':_0x3279ef?new Date(_0x3279ef):null,'periodTo':_0x230f78?new Date(_0x230f78):null});const _0x1bd846=await _0x5cb2f0[_0x28d436(0x20a)]['create']({'data':{'shopId':_0x4056fa,'amount':_0x41aadf,'network':_0xf6e337,'wallet':_0x4464bb,'status':'COMPLETED','txid':_0x53cbf4,'notes':_0x41ffab,'periodFrom':_0x3279ef?new Date(_0x3279ef):null,'periodTo':_0x230f78?new Date(_0x230f78):null,'createdAt':new Date(),'paidAt':new Date()}});console[_0x28d436(0x260)](_0x28d436(0x2ee),{'id':_0x1bd846['id'],'wallet':_0x1bd846['wallet'],'network':_0x1bd846['network'],'amount':_0x1bd846[_0x28d436(0x2a7)]});const _0x2b7770=_0x243a7f-_0x41aadf,_0x38ccc7=Number(_0x7d4645['totalPaidOut'])+_0x41aadf;return await _0x5cb2f0['shop'][_0x28d436(0x2d4)]({'where':{'id':_0x4056fa},'data':{'balance':_0x2b7770,'totalPaidOut':_0x38ccc7}}),console['log']('ðŸ’°\x20Shop\x20'+_0x7d4645[_0x28d436(0x244)]+_0x28d436(0x222)),console[_0x28d436(0x260)](_0x28d436(0x173)+_0x243a7f['toFixed'](0x6)+_0x28d436(0x230)+_0x2b7770[_0x28d436(0x1b4)](0x6)+_0x28d436(0x1e3)+_0x41aadf[_0x28d436(0x1b4)](0x6)+')'),console[_0x28d436(0x260)](_0x28d436(0x268)+_0x7d4645[_0x28d436(0x22c)][_0x28d436(0x1b4)](0x6)+_0x28d436(0x230)+_0x38ccc7[_0x28d436(0x1b4)](0x6)+_0x28d436(0x1b6)+_0x41aadf[_0x28d436(0x1b4)](0x6)+')'),console[_0x28d436(0x260)](_0x28d436(0x275)+_0x41aadf[_0x28d436(0x1b4)](0x6)+_0x28d436(0x1f1)),{'payout':_0x1bd846,'shop':_0x7d4645};});console[_0x4f71f1(0x260)]('âœ…\x20Payout\x20created:\x20'+_0x179a9b[_0x4f71f1(0x20a)]['id']+'\x20for\x20shop\x20'+_0x179a9b['shop'][_0x4f71f1(0x244)]+'\x20('+_0x179a9b[_0x4f71f1(0x20a)][_0x4f71f1(0x2a7)][_0x4f71f1(0x1b4)](0x6)+_0x4f71f1(0x1c0));try{let _0xd7d4c7=_0x4f71f1(0x1c4);if(_0x179a9b[_0x4f71f1(0x20a)][_0x4f71f1(0x2ec)]&&_0x179a9b[_0x4f71f1(0x20a)][_0x4f71f1(0x19c)]){const _0x3323e1=new Date(_0x179a9b[_0x4f71f1(0x20a)][_0x4f71f1(0x2ec)])['toLocaleDateString'](_0x4f71f1(0x1da)),_0x36621e=new Date(_0x179a9b[_0x4f71f1(0x20a)][_0x4f71f1(0x19c)])['toLocaleDateString'](_0x4f71f1(0x1da));_0xd7d4c7=_0x3323e1+_0x4f71f1(0x172)+_0x36621e;}await telegramBotService_1[_0x4f71f1(0x2ab)][_0x4f71f1(0x24e)](_0x179a9b[_0x4f71f1(0x20a)][_0x4f71f1(0x2db)],{'id':_0x179a9b['payout']['id'],'amount':_0x179a9b['payout'][_0x4f71f1(0x2a7)],'network':_0x179a9b[_0x4f71f1(0x20a)][_0x4f71f1(0x1cd)],'wallet':_0x179a9b[_0x4f71f1(0x20a)][_0x4f71f1(0x2c6)],'period':_0xd7d4c7,'createdAt':_0x179a9b['payout'][_0x4f71f1(0x2af)],'txid':_0x179a9b[_0x4f71f1(0x20a)][_0x4f71f1(0x2fb)]}),console[_0x4f71f1(0x260)](_0x4f71f1(0x2f0)+_0x179a9b[_0x4f71f1(0x20a)]['id']);}catch(_0x2e8d3c){console[_0x4f71f1(0x2b8)](_0x4f71f1(0x1ba)+_0x179a9b[_0x4f71f1(0x20a)]['id']+':',_0x2e8d3c);}return{'id':_0x179a9b[_0x4f71f1(0x20a)]['id'],'shopId':_0x179a9b[_0x4f71f1(0x20a)][_0x4f71f1(0x2db)],'shopName':_0x179a9b[_0x4f71f1(0x2e5)]['name'],'shopUsername':_0x179a9b[_0x4f71f1(0x2e5)][_0x4f71f1(0x244)],'amount':_0x179a9b[_0x4f71f1(0x20a)]['amount'],'network':_0x179a9b['payout']['network'],'wallet':_0x179a9b[_0x4f71f1(0x20a)][_0x4f71f1(0x2c6)],'status':_0x179a9b[_0x4f71f1(0x20a)][_0x4f71f1(0x233)],'txid':_0x179a9b[_0x4f71f1(0x20a)][_0x4f71f1(0x2fb)],'notes':_0x179a9b[_0x4f71f1(0x20a)][_0x4f71f1(0x285)],'periodFrom':_0x179a9b[_0x4f71f1(0x20a)][_0x4f71f1(0x2ec)],'periodTo':_0x179a9b['payout'][_0x4f71f1(0x19c)],'createdAt':_0x179a9b[_0x4f71f1(0x20a)][_0x4f71f1(0x2af)],'paidAt':_0x179a9b[_0x4f71f1(0x20a)][_0x4f71f1(0x254)]};}async[a48_0x586363(0x293)](_0x3eb7c5){const _0x53ec55=a48_0x586363,{page:_0x53e972,limit:_0x27ca98,shopId:_0x55a011,network:_0x6bc75e,dateFrom:_0x1137e9,dateTo:_0x392878,search:_0x434f03}=_0x3eb7c5,_0x4af58c=(_0x53e972-0x1)*_0x27ca98,_0x3e09ea={};_0x55a011&&(_0x3e09ea['shopId']=_0x55a011);_0x6bc75e&&(_0x3e09ea[_0x53ec55(0x1cd)]=_0x6bc75e);if(_0x1137e9||_0x392878){_0x3e09ea[_0x53ec55(0x2af)]={};if(_0x1137e9){const _0x58cf65=new Date(_0x1137e9);_0x58cf65[_0x53ec55(0x1d6)](0x0,0x0,0x0,0x1),_0x3e09ea[_0x53ec55(0x2af)][_0x53ec55(0x295)]=_0x58cf65,console[_0x53ec55(0x260)](_0x53ec55(0x1c3)+_0x58cf65[_0x53ec55(0x289)]());}if(_0x392878){const _0x5f1433=new Date(_0x392878);_0x5f1433[_0x53ec55(0x1d6)](0x17,0x3b,0x3b,0x3e7),_0x3e09ea[_0x53ec55(0x2af)]['lte']=_0x5f1433,console[_0x53ec55(0x260)](_0x53ec55(0x1eb)+_0x5f1433[_0x53ec55(0x289)]());}}_0x434f03&&(_0x3e09ea['OR']=[{'shop':{'name':{'contains':_0x434f03,'mode':_0x53ec55(0x1bf)}}},{'shop':{'username':{'contains':_0x434f03,'mode':_0x53ec55(0x1bf)}}},{'notes':{'contains':_0x434f03,'mode':_0x53ec55(0x1bf)}}]);const [_0x3d1f08,_0x89d294]=await Promise['all']([database_1[_0x53ec55(0x257)][_0x53ec55(0x20a)][_0x53ec55(0x19f)]({'where':_0x3e09ea,'skip':_0x4af58c,'take':_0x27ca98,'orderBy':{'createdAt':'desc'},'select':{'id':!![],'shopId':!![],'amount':!![],'network':!![],'status':!![],'txid':!![],'notes':!![],'periodFrom':!![],'periodTo':!![],'createdAt':!![],'wallet':!![],'paidAt':!![],'shop':{'select':{'name':!![],'username':!![]}}}}),database_1[_0x53ec55(0x257)][_0x53ec55(0x20a)]['count']({'where':_0x3e09ea})]);return{'payouts':_0x3d1f08[_0x53ec55(0x16e)](_0x9d4443=>({'id':_0x9d4443['id'],'shopId':_0x9d4443[_0x53ec55(0x2db)],'shopName':_0x9d4443['shop'][_0x53ec55(0x2d2)],'shopUsername':_0x9d4443[_0x53ec55(0x2e5)]['username'],'amount':_0x9d4443['amount'],'network':_0x9d4443[_0x53ec55(0x1cd)],'wallet':_0x9d4443[_0x53ec55(0x2c6)],'status':_0x9d4443[_0x53ec55(0x233)],'txid':_0x9d4443[_0x53ec55(0x2fb)],'notes':_0x9d4443[_0x53ec55(0x285)],'periodFrom':_0x9d4443['periodFrom'],'periodTo':_0x9d4443[_0x53ec55(0x19c)],'createdAt':_0x9d4443['createdAt'],'paidAt':_0x9d4443['paidAt']})),'pagination':{'page':_0x53e972,'limit':_0x27ca98,'total':_0x89d294,'totalPages':Math['ceil'](_0x89d294/_0x27ca98)}};}async[a48_0x586363(0x256)](_0x49ac21){const _0x4fccfd=a48_0x586363,_0x2a5c61=await database_1[_0x4fccfd(0x257)][_0x4fccfd(0x20a)][_0x4fccfd(0x19d)]({'where':{'id':_0x49ac21},'include':{'shop':{'select':{'name':!![],'username':!![]}}}});if(!_0x2a5c61)return null;return{'id':_0x2a5c61['id'],'shopId':_0x2a5c61[_0x4fccfd(0x2db)],'shopName':_0x2a5c61[_0x4fccfd(0x2e5)][_0x4fccfd(0x2d2)],'shopUsername':_0x2a5c61[_0x4fccfd(0x2e5)][_0x4fccfd(0x244)],'amount':_0x2a5c61['amount'],'network':_0x2a5c61[_0x4fccfd(0x1cd)],'wallet':_0x2a5c61[_0x4fccfd(0x2c6)],'status':_0x2a5c61[_0x4fccfd(0x233)],'txid':_0x2a5c61['txid'],'notes':_0x2a5c61[_0x4fccfd(0x285)],'periodFrom':_0x2a5c61[_0x4fccfd(0x2ec)],'periodTo':_0x2a5c61['periodTo'],'createdAt':_0x2a5c61['createdAt'],'paidAt':_0x2a5c61['paidAt']};}async[a48_0x586363(0x1b7)](_0x599298){const _0x7b133e=a48_0x586363;await database_1[_0x7b133e(0x257)][_0x7b133e(0x20a)]['delete']({'where':{'id':_0x599298}});}async['updatePayout'](_0x357e5b,_0x2b9e7d){const _0x3b0761=a48_0x586363,_0x3fc8bd=await database_1[_0x3b0761(0x257)]['$transaction'](async _0x19cf66=>{const _0x142200=_0x3b0761,_0x1b98db=await _0x19cf66[_0x142200(0x20a)][_0x142200(0x19d)]({'where':{'id':_0x357e5b},'include':{'shop':{'select':{'id':!![],'name':!![],'username':!![],'balance':!![],'totalPaidOut':!![]}}}});if(!_0x1b98db)throw new Error(_0x142200(0x232));console[_0x142200(0x260)](_0x142200(0x238)+_0x357e5b+_0x142200(0x2d8)+_0x1b98db[_0x142200(0x2e5)][_0x142200(0x244)]+':'),console[_0x142200(0x260)](_0x142200(0x28c)+_0x1b98db[_0x142200(0x2a7)][_0x142200(0x1b4)](0x6)+_0x142200(0x1f1)),console[_0x142200(0x260)](_0x142200(0x25c)+_0x1b98db[_0x142200(0x1cd)]),console['log'](_0x142200(0x2b1)+_0x1b98db[_0x142200(0x2e5)]['balance'][_0x142200(0x1b4)](0x6)+_0x142200(0x1f1)),console[_0x142200(0x260)]('\x20\x20\x20Shop\x20totalPaidOut:\x20'+_0x1b98db[_0x142200(0x2e5)]['totalPaidOut'][_0x142200(0x1b4)](0x6)+'\x20USDT');let _0xdde7fb=0x0;if(_0x2b9e7d[_0x142200(0x2a7)]!==undefined){const _0x110002=Number(_0x1b98db[_0x142200(0x2a7)]),_0x153186=Number(_0x2b9e7d[_0x142200(0x2a7)]);_0xdde7fb=_0x153186-_0x110002,console['log'](_0x142200(0x22f)+_0x153186['toFixed'](0x6)+'\x20USDT'),console[_0x142200(0x260)](_0x142200(0x183)+_0xdde7fb[_0x142200(0x1b4)](0x6)+_0x142200(0x1f1));if(_0xdde7fb<0x0)console[_0x142200(0x260)](_0x142200(0x213)+Math[_0x142200(0x2b4)](_0xdde7fb)[_0x142200(0x1b4)](0x6)+_0x142200(0x2ad));else{if(_0xdde7fb>0x0){const _0x18f215=Number(_0x1b98db['shop']['balance']);console[_0x142200(0x260)](_0x142200(0x204)+_0xdde7fb[_0x142200(0x1b4)](0x6)+_0x142200(0x203));if(_0x18f215<_0xdde7fb)throw new Error(_0x142200(0x179)+_0x18f215[_0x142200(0x1b4)](0x6)+_0x142200(0x1e1)+_0xdde7fb['toFixed'](0x6)+_0x142200(0x1f1));}}}const _0x30ff79={};if(_0x2b9e7d[_0x142200(0x2a7)]!==undefined)_0x30ff79['amount']=_0x2b9e7d[_0x142200(0x2a7)];if(_0x2b9e7d['network']!==undefined)_0x30ff79['network']=_0x2b9e7d[_0x142200(0x1cd)];if(_0x2b9e7d[_0x142200(0x2c6)]!==undefined)_0x30ff79[_0x142200(0x2c6)]=_0x2b9e7d[_0x142200(0x2c6)]||null;if(_0x2b9e7d[_0x142200(0x285)]!==undefined)_0x30ff79[_0x142200(0x285)]=_0x2b9e7d[_0x142200(0x285)]||null;if(_0x2b9e7d[_0x142200(0x2fb)]!==undefined)_0x30ff79[_0x142200(0x2fb)]=_0x2b9e7d['txid']||null;if(_0x2b9e7d[_0x142200(0x2ec)]!==undefined)_0x30ff79[_0x142200(0x2ec)]=_0x2b9e7d[_0x142200(0x2ec)]?new Date(_0x2b9e7d[_0x142200(0x2ec)]):null;if(_0x2b9e7d[_0x142200(0x19c)]!==undefined)_0x30ff79['periodTo']=_0x2b9e7d[_0x142200(0x19c)]?new Date(_0x2b9e7d[_0x142200(0x19c)]):null;const _0x23a2b7=await _0x19cf66[_0x142200(0x20a)][_0x142200(0x2d4)]({'where':{'id':_0x357e5b},'data':_0x30ff79,'include':{'shop':{'select':{'name':!![],'username':!![]}}}});if(_0xdde7fb!==0x0){const _0x11da31=Number(_0x1b98db[_0x142200(0x2e5)]['balance']),_0x44c33c=Number(_0x1b98db[_0x142200(0x2e5)][_0x142200(0x22c)]),_0xb88af4=_0x11da31-_0xdde7fb,_0x306078=_0x44c33c+_0xdde7fb;await _0x19cf66[_0x142200(0x2e5)][_0x142200(0x2d4)]({'where':{'id':_0x1b98db[_0x142200(0x2db)]},'data':{'balance':_0xb88af4,'totalPaidOut':_0x306078}}),console[_0x142200(0x260)](_0x142200(0x24d)+_0x1b98db[_0x142200(0x2e5)][_0x142200(0x244)]+_0x142200(0x222)),console['log'](_0x142200(0x173)+_0x11da31[_0x142200(0x1b4)](0x6)+_0x142200(0x230)+_0xb88af4[_0x142200(0x1b4)](0x6)+_0x142200(0x1f1)),console[_0x142200(0x260)](_0x142200(0x268)+_0x44c33c[_0x142200(0x1b4)](0x6)+_0x142200(0x230)+_0x306078['toFixed'](0x6)+_0x142200(0x1f1));}return console[_0x142200(0x260)](_0x142200(0x16b)+_0x357e5b+_0x142200(0x2a8)),_0x23a2b7;});return{'id':_0x3fc8bd['id'],'shopId':_0x3fc8bd[_0x3b0761(0x2db)],'shopName':_0x3fc8bd['shop'][_0x3b0761(0x2d2)],'shopUsername':_0x3fc8bd[_0x3b0761(0x2e5)][_0x3b0761(0x244)],'amount':Number(_0x3fc8bd[_0x3b0761(0x2a7)]),'network':_0x3fc8bd[_0x3b0761(0x1cd)],'wallet':_0x3fc8bd[_0x3b0761(0x2c6)],'status':_0x3fc8bd[_0x3b0761(0x233)],'txid':_0x3fc8bd[_0x3b0761(0x2fb)],'notes':_0x3fc8bd[_0x3b0761(0x285)],'periodFrom':_0x3fc8bd[_0x3b0761(0x2ec)],'periodTo':_0x3fc8bd[_0x3b0761(0x19c)],'createdAt':_0x3fc8bd[_0x3b0761(0x2af)],'paidAt':_0x3fc8bd[_0x3b0761(0x254)]};}async[a48_0x586363(0x187)](_0x4a1413){const _0x464595=a48_0x586363,{page:_0x5c804e,limit:_0x5e1261,status:_0x123af8,gateway:_0x503f97,shopId:_0x535559,dateFrom:_0x3d16be,dateTo:_0x5ecff1,search:_0xda8e3f,currency:_0x41b4f1,sortBy:_0x5ada92,sortOrder:_0x4577d3}=_0x4a1413,_0x357ee8=(_0x5c804e-0x1)*_0x5e1261;console[_0x464595(0x260)](_0x464595(0x1d3),_0x4a1413);const _0x3c8cf9=await database_1[_0x464595(0x257)][_0x464595(0x1a5)][_0x464595(0x170)]({'by':[_0x464595(0x21d)],'_count':{'gateway':!![]}});console['log'](_0x464595(0x209),_0x3c8cf9[_0x464595(0x16e)](_0x604d20=>_0x604d20[_0x464595(0x21d)]+'\x20('+_0x604d20[_0x464595(0x253)][_0x464595(0x21d)]+_0x464595(0x243)));if(_0x503f97){const _0x583bb9=_0x3c8cf9[_0x464595(0x246)](_0x5939bc=>_0x5939bc['gateway'][_0x464595(0x255)]()===_0x503f97[_0x464595(0x255)]());!_0x583bb9&&_0x503f97[_0x464595(0x255)]()!==_0x464595(0x17c)&&console[_0x464595(0x260)]('âš ï¸\x20Requested\x20gateway\x20\x27'+_0x503f97+_0x464595(0x2e1)+_0x3c8cf9[_0x464595(0x16e)](_0x24f4d4=>_0x24f4d4[_0x464595(0x21d)])[_0x464595(0x28d)](',\x20'));}const _0x1182a4={};_0x123af8&&(_0x1182a4[_0x464595(0x233)]=_0x123af8['toUpperCase']());if(!_0x503f97)_0x1182a4[_0x464595(0x21d)]={'not':_0x464595(0x17c)};else{if(_0x503f97&&(_0x503f97['toLowerCase']()===_0x464595(0x17c)||_0x503f97===_0x464595(0x23c)))_0x1182a4[_0x464595(0x21d)]='test_gateway';else{let _0x150039=_0x503f97;const _0x69940e=(0x0,gateway_1[_0x464595(0x23f)])(_0x503f97);if(_0x69940e)_0x150039=_0x69940e,console[_0x464595(0x260)]('ðŸ”„\x20Converted\x20gateway\x20ID\x20\x27'+_0x503f97+_0x464595(0x19a)+_0x150039+'\x27');else{const _0x47d778=(0x0,gateway_1[_0x464595(0x1b8)])(_0x503f97);if(_0x47d778){const _0x4a952e=(0x0,gateway_1['getGatewayNameById'])(_0x47d778);_0x4a952e&&(_0x150039=_0x4a952e,console[_0x464595(0x260)](_0x464595(0x27c)+_0x503f97+_0x464595(0x1b3)+_0x47d778+_0x464595(0x2c0)+_0x150039+'\x27'));}else console[_0x464595(0x260)](_0x464595(0x303)+_0x503f97+_0x464595(0x28b));}const _0x447e3c=await database_1[_0x464595(0x257)][_0x464595(0x1a5)]['count']({'where':{'gateway':_0x150039[_0x464595(0x255)]()},'take':0x1});_0x447e3c===0x0?(console[_0x464595(0x260)](_0x464595(0x2a4)+_0x150039+_0x464595(0x234)+_0x503f97+_0x464595(0x224)),_0x1182a4[_0x464595(0x21d)]=_0x464595(0x259)):(_0x1182a4['gateway']=_0x150039[_0x464595(0x255)](),console[_0x464595(0x260)](_0x464595(0x2f7)+_0x150039+'\x27\x20(from\x20\x27'+_0x503f97+'\x27)'));}}console['log'](_0x464595(0x24f),_0x1182a4[_0x464595(0x21d)]);_0x535559&&(_0x1182a4[_0x464595(0x2db)]=_0x535559);_0x41b4f1&&(_0x1182a4['currency']=_0x41b4f1['toUpperCase'](),console[_0x464595(0x260)]('ðŸ’±\x20Currency\x20filter\x20applied:\x20'+_0x41b4f1['toUpperCase']()));if(_0x3d16be||_0x5ecff1){_0x1182a4['createdAt']={};if(_0x3d16be){const _0x19e803=new Date(_0x3d16be),_0x482604=new Date(Date[_0x464595(0x2f8)](_0x19e803['getUTCFullYear'](),_0x19e803[_0x464595(0x30c)](),_0x19e803['getUTCDate'](),0x0,0x0,0x0,0x0));_0x1182a4[_0x464595(0x2af)][_0x464595(0x295)]=_0x482604,console['log']('ðŸ“…\x20Date\x20from\x20filter:\x20'+_0x482604[_0x464595(0x289)]());}if(_0x5ecff1){const _0x1c346c=new Date(_0x5ecff1),_0x5f21ad=new Date(Date[_0x464595(0x2f8)](_0x1c346c['getUTCFullYear'](),_0x1c346c['getUTCMonth'](),_0x1c346c['getUTCDate'](),0x17,0x3b,0x3b,0x3e7));_0x1182a4[_0x464595(0x2af)][_0x464595(0x2b5)]=_0x5f21ad,console[_0x464595(0x260)](_0x464595(0x276)+_0x5f21ad[_0x464595(0x289)]());}}_0xda8e3f&&(_0x1182a4['OR']=[{'id':{'contains':_0xda8e3f,'mode':_0x464595(0x1bf)}},{'orderId':{'contains':_0xda8e3f,'mode':_0x464595(0x1bf)}},{'gatewayOrderId':{'contains':_0xda8e3f,'mode':_0x464595(0x1bf)}},{'customerEmail':{'contains':_0xda8e3f,'mode':_0x464595(0x1bf)}},{'shop':{'name':{'contains':_0xda8e3f,'mode':_0x464595(0x1bf)}}},{'shop':{'username':{'contains':_0xda8e3f,'mode':_0x464595(0x1bf)}}}]);console[_0x464595(0x260)](_0x464595(0x1a6),JSON[_0x464595(0x2de)](_0x1182a4,null,0x2));const _0x413d43=await database_1[_0x464595(0x257)][_0x464595(0x1a5)][_0x464595(0x267)]({'where':_0x1182a4});console[_0x464595(0x260)](_0x464595(0x2f5)+_0x413d43);let _0x134b95={'createdAt':_0x464595(0x22e)};if(_0x5ada92){const _0x213333=[_0x464595(0x2a7),_0x464595(0x2af),_0x464595(0x20b),'status',_0x464595(0x21d),_0x464595(0x297)],_0xffe721=[_0x464595(0x2ea),_0x464595(0x22e)];if(_0x213333[_0x464595(0x17e)](_0x5ada92)){const _0x384a3b=_0xffe721[_0x464595(0x17e)](_0x4577d3)?_0x4577d3:_0x464595(0x22e);_0x134b95={[_0x5ada92]:_0x384a3b},console[_0x464595(0x260)](_0x464595(0x1ed)+_0x5ada92+_0x464595(0x2b3)+_0x384a3b+'\x20order');}}const [_0x12c24f,_0x2249f8]=await Promise[_0x464595(0x1fd)]([database_1[_0x464595(0x257)]['payment'][_0x464595(0x19f)]({'where':_0x1182a4,'skip':_0x357ee8,'take':_0x5e1261,'orderBy':_0x134b95,'include':{'shop':{'select':{'name':!![],'username':!![]}}}}),database_1[_0x464595(0x257)][_0x464595(0x1a5)]['count']({'where':_0x1182a4})]);let _0x3c9b22,_0x1ea1b1;if(_0x3d16be){const _0x23bcf7=new Date(_0x3d16be);_0x3c9b22=new Date(Date[_0x464595(0x2f8)](_0x23bcf7['getUTCFullYear'](),_0x23bcf7['getUTCMonth'](),_0x23bcf7['getUTCDate'](),0x0,0x0,0x0,0x0));}else{const _0x8fe203=new Date();_0x3c9b22=new Date(Date[_0x464595(0x2f8)](_0x8fe203[_0x464595(0x1c2)](),_0x8fe203[_0x464595(0x30c)](),_0x8fe203['getUTCDate'](),0x0,0x0,0x0,0x0));}if(_0x5ecff1){const _0x1c4edf=new Date(_0x5ecff1);_0x1ea1b1=new Date(Date[_0x464595(0x2f8)](_0x1c4edf[_0x464595(0x1c2)](),_0x1c4edf[_0x464595(0x30c)](),_0x1c4edf[_0x464595(0x282)](),0x17,0x3b,0x3b,0x3e7));}else{if(_0x3d16be){const _0x5f0242=new Date(_0x3d16be);_0x1ea1b1=new Date(Date[_0x464595(0x2f8)](_0x5f0242[_0x464595(0x1c2)](),_0x5f0242[_0x464595(0x30c)](),_0x5f0242['getUTCDate'](),0x17,0x3b,0x3b,0x3e7));}else{const _0xd7e77f=new Date();_0x1ea1b1=new Date(Date['UTC'](_0xd7e77f[_0x464595(0x1c2)](),_0xd7e77f[_0x464595(0x30c)](),_0xd7e77f[_0x464595(0x282)](),0x17,0x3b,0x3b,0x3e7));}}const _0x2bf28f={'status':_0x464595(0x1ca),'createdAt':{'gte':_0x3c9b22,'lte':_0x1ea1b1}};_0x503f97?_0x2bf28f[_0x464595(0x21d)]=_0x1182a4[_0x464595(0x21d)]:_0x2bf28f['gateway']={'not':_0x464595(0x17c)};_0x535559&&(_0x2bf28f[_0x464595(0x2db)]=_0x535559);_0x41b4f1&&(_0x2bf28f[_0x464595(0x297)]=_0x41b4f1[_0x464595(0x261)]());console[_0x464595(0x260)](_0x464595(0x2bf),JSON[_0x464595(0x2de)](_0x2bf28f,null,0x2));const _0xe1ad9b=await database_1[_0x464595(0x257)]['payment'][_0x464595(0x19f)]({'where':_0x2bf28f,'select':{'amountUSDT':!![],'currency':!![],'amount':!![]}}),_0x4a1652={};let _0x21833a=0x0;return _0xe1ad9b[_0x464595(0x223)](_0x1095e4=>{const _0x29153d=_0x464595;_0x1095e4[_0x29153d(0x29b)]&&(_0x21833a+=_0x1095e4[_0x29153d(0x29b)]);if(_0x1095e4[_0x29153d(0x297)]){const _0x387939=_0x1095e4[_0x29153d(0x297)][_0x29153d(0x261)]();!_0x4a1652[_0x387939]&&(_0x4a1652[_0x387939]=0x0),_0x4a1652[_0x387939]+=_0x1095e4[_0x29153d(0x2a7)];}}),_0x21833a>0x0&&(_0x4a1652[_0x464595(0x19e)]=_0x21833a),{'payments':_0x12c24f,'pagination':{'page':_0x5c804e,'limit':_0x5e1261,'total':_0x2249f8,'totalPages':Math[_0x464595(0x2f4)](_0x2249f8/_0x5e1261)},'statistics':_0x4a1652};}async[a48_0x586363(0x1fa)](_0x9bc501){const _0x12c2fe=a48_0x586363,_0x197c60=await database_1['default'][_0x12c2fe(0x1a5)][_0x12c2fe(0x19d)]({'where':{'id':_0x9bc501},'select':{'id':!![],'shopId':!![],'amount':!![],'amountAfterGatewayCommissionUSDT':!![],'currency':!![],'sourceCurrency':!![],'status':!![],'gateway':!![],'orderId':!![],'gatewayOrderId':!![],'gatewayPaymentId':!![],'customerEmail':!![],'customerName':!![],'customerCountry':!![],'customerIp':!![],'customerUa':!![],'externalPaymentUrl':!![],'successUrl':!![],'failUrl':!![],'pendingUrl':!![],'whiteUrl':!![],'expiresAt':!![],'invoiceTotalSum':!![],'qrCode':!![],'qrUrl':!![],'country':!![],'language':!![],'amountIsEditable':!![],'maxPayments':!![],'rapydCustomer':!![],'cardLast4':!![],'paymentMethod':!![],'bankId':!![],'remitterIban':!![],'remitterName':!![],'failureMessage':!![],'usage':!![],'createdAt':!![],'updatedAt':!![],'shop':{'select':{'name':!![],'username':!![]}}}});if(!_0x197c60)return null;return{'id':_0x197c60['id'],'shopId':_0x197c60['shopId'],'gateway':_0x197c60['gateway'],'amount':_0x197c60[_0x12c2fe(0x2a7)],'currency':_0x197c60[_0x12c2fe(0x297)],'status':_0x197c60[_0x12c2fe(0x233)],'orderId':_0x197c60[_0x12c2fe(0x192)],'gatewayOrderId':_0x197c60['gatewayOrderId'],'customerEmail':_0x197c60['customerEmail'],'customerName':_0x197c60[_0x12c2fe(0x17b)],'customerCountry':_0x197c60[_0x12c2fe(0x245)],'customerIp':_0x197c60[_0x12c2fe(0x26d)],'customerUa':_0x197c60[_0x12c2fe(0x2cd)],'failureMessage':_0x197c60['failureMessage'],'externalPaymentUrl':_0x197c60[_0x12c2fe(0x2a9)],'successUrl':_0x197c60['successUrl'],'failUrl':_0x197c60[_0x12c2fe(0x1f4)],'pendingUrl':_0x197c60[_0x12c2fe(0x216)],'whiteUrl':_0x197c60[_0x12c2fe(0x2d1)],'createdAt':_0x197c60['createdAt'],'updatedAt':_0x197c60[_0x12c2fe(0x20b)],'shop':_0x197c60[_0x12c2fe(0x2e5)]};}async[a48_0x586363(0x193)](_0x109201,_0x48e234,_0x4d1fe1,_0x1c384f){const _0x230c3e=a48_0x586363,_0x26ab81=await database_1[_0x230c3e(0x257)][_0x230c3e(0x16c)](async _0x22d260=>{const _0x16ea46=_0x230c3e,_0x3c992a=await _0x22d260[_0x16ea46(0x1a5)][_0x16ea46(0x19d)]({'where':{'id':_0x109201},'include':{'shop':{'select':{'id':!![],'name':!![],'username':!![],'balance':!![]}}}});if(!_0x3c992a)throw new Error('Payment\x20not\x20found');const _0x320bab=_0x3c992a[_0x16ea46(0x233)],_0x39b9b4=_0x48e234[_0x16ea46(0x261)]();console[_0x16ea46(0x260)](_0x16ea46(0x2cb)+_0x109201+'\x20status:\x20'+_0x320bab+_0x16ea46(0x230)+_0x39b9b4),console[_0x16ea46(0x260)](_0x16ea46(0x218)+_0x3c992a['shop']['balance']+'\x20USDT');const _0xd730a={'status':_0x39b9b4,'updatedAt':new Date(),'statusChangedBy':'admin','statusChangedAt':new Date()};_0x4d1fe1&&(_0xd730a['adminNotes']=_0x4d1fe1);_0x39b9b4==='CHARGEBACK'&&_0x1c384f&&(_0xd730a['chargebackAmount']=_0x1c384f);let _0x15d371=0x0,_0x3367a8=_0x3c992a[_0x16ea46(0x2e5)][_0x16ea46(0x1d7)];if(_0x39b9b4==='PAID'&&_0x320bab!==_0x16ea46(0x1ca)){_0xd730a[_0x16ea46(0x254)]=new Date();const _0x363299=await currencyService_1[_0x16ea46(0x312)][_0x16ea46(0x264)](_0x3c992a[_0x16ea46(0x2a7)],_0x3c992a['currency']);_0xd730a[_0x16ea46(0x29b)]=_0x363299;let _0x133e0e=0x2d;const _0x2d171e=await _0x22d260[_0x16ea46(0x2e5)][_0x16ea46(0x19d)]({'where':{'id':_0x3c992a['shopId']},'select':{'gatewaySettings':!![]}});if(_0x2d171e?.[_0x16ea46(0x241)])try{const _0x42280f=JSON[_0x16ea46(0x208)](_0x2d171e['gatewaySettings']);for(const [_0x392b6f,_0x2480de]of Object[_0x16ea46(0x2d7)](_0x42280f)){if(_0x392b6f[_0x16ea46(0x255)]()===_0x3c992a[_0x16ea46(0x21d)][_0x16ea46(0x255)]()){_0x133e0e=_0x2480de[_0x16ea46(0x283)]||0xa;break;}}}catch(_0x313130){console['error']('Error\x20parsing\x20gateway\x20settings\x20for\x20payment\x20'+_0x109201+':',_0x313130);}let _0xd1ce14;_0x3c992a['amountAfterGatewayCommissionUSDT']!==null&&_0x3c992a[_0x16ea46(0x196)]!==undefined?(_0xd1ce14=_0x3c992a[_0x16ea46(0x196)],console[_0x16ea46(0x260)](_0x16ea46(0x189)+_0xd1ce14[_0x16ea46(0x1b4)](0x6)+'\x20USDT\x20for\x20payment\x20'+_0x109201)):(_0xd1ce14=_0x363299*(0x1-_0x133e0e/0x64),console[_0x16ea46(0x260)]('ðŸ“Š\x20[ADMIN]\x20Calculating\x20commission\x20manually\x20for\x20payment\x20'+_0x109201+':\x20'+_0x133e0e+_0x16ea46(0x2ff)+_0x363299[_0x16ea46(0x1b4)](0x6)+_0x16ea46(0x1f1)),_0xd730a['amountAfterGatewayCommissionUSDT']=_0xd1ce14,_0xd730a['gatewayCommissionRate']=_0x133e0e),_0x15d371=_0xd1ce14,_0x3367a8+=_0xd1ce14,console[_0x16ea46(0x260)](_0x16ea46(0x180)+_0x109201+'\x20became\x20PAID:'),console[_0x16ea46(0x260)](_0x16ea46(0x1bc)+_0x363299['toFixed'](0x6)+_0x16ea46(0x1f1)),console[_0x16ea46(0x260)](_0x16ea46(0x2a1)+_0x3c992a['gateway']+_0x16ea46(0x207)+_0x133e0e+'%'),console[_0x16ea46(0x260)]('\x20\x20\x20Merchant\x20gets:\x20'+_0xd1ce14['toFixed'](0x6)+_0x16ea46(0x1bb)+_0x133e0e+_0x16ea46(0x2f9)),console['log'](_0x16ea46(0x18c)+_0xd1ce14['toFixed'](0x6)+_0x16ea46(0x1f1));}else{if(_0x320bab==='PAID'&&_0x39b9b4!==_0x16ea46(0x1ca)&&_0x39b9b4!==_0x16ea46(0x2d5)){if(_0x3c992a[_0x16ea46(0x29b)]){let _0x178b81=0x2d;const _0x40e9ff=await _0x22d260[_0x16ea46(0x2e5)][_0x16ea46(0x19d)]({'where':{'id':_0x3c992a[_0x16ea46(0x2db)]},'select':{'gatewaySettings':!![]}});if(_0x40e9ff?.[_0x16ea46(0x241)])try{const _0xaabc4=JSON[_0x16ea46(0x208)](_0x40e9ff[_0x16ea46(0x241)]);for(const [_0xa71e6d,_0x3954cc]of Object[_0x16ea46(0x2d7)](_0xaabc4)){if(_0xa71e6d['toLowerCase']()===_0x3c992a['gateway'][_0x16ea46(0x255)]()){_0x178b81=_0x3954cc[_0x16ea46(0x283)]||0xa;break;}}}catch(_0x23ae65){console['error'](_0x16ea46(0x30b)+_0x109201+':',_0x23ae65);}const _0x29c2cc=_0x3c992a[_0x16ea46(0x29b)]*(0x1-_0x178b81/0x64);_0x15d371=-_0x29c2cc,_0x3367a8-=_0x29c2cc,console['log'](_0x16ea46(0x1bc)+_0x3c992a[_0x16ea46(0x29b)][_0x16ea46(0x1b4)](0x6)+_0x16ea46(0x1f1)),console[_0x16ea46(0x260)](_0x16ea46(0x2a1)+_0x3c992a['gateway']+_0x16ea46(0x207)+_0x178b81+'%'),console['log'](_0x16ea46(0x2e7)+_0x29c2cc[_0x16ea46(0x1b4)](0x6)+_0x16ea46(0x1bb)+_0x178b81+'%\x20commission)'),console['log'](_0x16ea46(0x240)+_0x29c2cc[_0x16ea46(0x1b4)](0x6)+_0x16ea46(0x1f1));}}}_0x39b9b4===_0x16ea46(0x2d5)&&(console[_0x16ea46(0x260)](_0x16ea46(0x1c9)),_0x1c384f&&_0x1c384f>0x0?(_0x15d371=-_0x1c384f,_0x3367a8-=_0x1c384f,console[_0x16ea46(0x260)](_0x16ea46(0x298)+_0x1c384f[_0x16ea46(0x1b4)](0x6)+_0x16ea46(0x26b)),console[_0x16ea46(0x260)](_0x16ea46(0x2da))):console[_0x16ea46(0x260)](_0x16ea46(0x1ef)),_0xd730a[_0x16ea46(0x1dc)]=_0x1c384f||0x0);_0x39b9b4===_0x16ea46(0x1a8)&&_0x320bab===_0x16ea46(0x1ca)&&console[_0x16ea46(0x260)](_0x16ea46(0x278));const _0x1c586a=await _0x22d260[_0x16ea46(0x1a5)][_0x16ea46(0x2d4)]({'where':{'id':_0x109201},'data':_0xd730a,'include':{'shop':{'select':{'name':!![],'username':!![]}}}});return _0x15d371!==0x0&&(await _0x22d260[_0x16ea46(0x2e5)][_0x16ea46(0x2d4)]({'where':{'id':_0x3c992a[_0x16ea46(0x2db)]},'data':{'balance':_0x3367a8}}),console[_0x16ea46(0x260)]('ðŸ’°\x20Shop\x20'+_0x3c992a[_0x16ea46(0x2db)]+_0x16ea46(0x25a)+_0x3c992a[_0x16ea46(0x2e5)][_0x16ea46(0x1d7)][_0x16ea46(0x1b4)](0x6)+'\x20->\x20'+_0x3367a8[_0x16ea46(0x1b4)](0x6)+'\x20USDT\x20('+(_0x15d371>0x0?'+':'')+_0x15d371['toFixed'](0x6)+')')),_0x1c586a;});return{'id':_0x26ab81['id'],'shopId':_0x26ab81['shopId'],'gateway':_0x26ab81['gateway'],'amount':_0x26ab81[_0x230c3e(0x2a7)],'currency':_0x26ab81[_0x230c3e(0x297)],'status':_0x26ab81[_0x230c3e(0x233)],'orderId':_0x26ab81['orderId'],'gatewayOrderId':_0x26ab81[_0x230c3e(0x27e)],'customerEmail':_0x26ab81[_0x230c3e(0x1a3)],'customerName':_0x26ab81[_0x230c3e(0x17b)],'customerCountry':_0x26ab81[_0x230c3e(0x245)],'customerIp':_0x26ab81['customerIp'],'customerUa':_0x26ab81[_0x230c3e(0x2cd)],'failureMessage':_0x26ab81[_0x230c3e(0x22d)],'adminNotes':_0x26ab81[_0x230c3e(0x2a5)],'chargebackAmount':_0x26ab81[_0x230c3e(0x1dc)],'statusChangedBy':_0x26ab81[_0x230c3e(0x262)],'statusChangedAt':_0x26ab81[_0x230c3e(0x309)],'createdAt':_0x26ab81[_0x230c3e(0x2af)],'updatedAt':_0x26ab81[_0x230c3e(0x20b)],'shop':_0x26ab81[_0x230c3e(0x2e5)]};}async['updateUser'](_0x45d7f9,_0x25b792){const _0x544747=a48_0x586363,_0x36926e=Math['random']()[_0x544747(0x26e)](0x24)[_0x544747(0x21c)](0x2,0x9);console[_0x544747(0x260)](_0x544747(0x211)+_0x36926e+_0x544747(0x17f)+_0x45d7f9);const _0x44061f={..._0x25b792};_0x25b792[_0x544747(0x1e0)]&&_0x25b792[_0x544747(0x1e0)]['trim']()!==''?(console[_0x544747(0x260)]('ðŸ”\x20['+_0x36926e+']\x20Updating\x20password\x20for\x20user\x20'+_0x45d7f9),_0x44061f[_0x544747(0x1e0)]=await bcryptjs_1['default'][_0x544747(0x28e)](_0x25b792[_0x544747(0x1e0)],0xc)):(console[_0x544747(0x260)](_0x544747(0x212)+_0x36926e+_0x544747(0x1e4)),delete _0x44061f[_0x544747(0x1e0)]);_0x25b792['fullName']&&(_0x44061f[_0x544747(0x2d2)]=_0x25b792['fullName'],delete _0x44061f['fullName']);_0x25b792[_0x544747(0x2bb)]&&(_0x44061f[_0x544747(0x2b2)]=_0x25b792[_0x544747(0x2bb)],delete _0x44061f[_0x544747(0x2bb)]);_0x25b792[_0x544747(0x1c8)]&&(_0x44061f[_0x544747(0x1cb)]=_0x25b792[_0x544747(0x1c8)],delete _0x44061f[_0x544747(0x1c8)]);if(_0x25b792['gateways']){const _0x51bf4c=_0x25b792['gateways'][_0x544747(0x16e)](_0x52c656=>this[_0x544747(0x247)](_0x52c656));console[_0x544747(0x260)](_0x544747(0x199),_0x25b792[_0x544747(0x19b)],'->',_0x51bf4c),_0x44061f[_0x544747(0x236)]=JSON['stringify'](_0x51bf4c),delete _0x44061f['gateways'];}_0x25b792[_0x544747(0x241)]&&(console[_0x544747(0x260)](_0x544747(0x2dc)+_0x36926e+_0x544747(0x221),_0x25b792[_0x544747(0x241)]),_0x44061f['gatewaySettings']=JSON[_0x544747(0x2de)](_0x25b792['gatewaySettings']),console['log']('ðŸ”§\x20['+_0x36926e+_0x544747(0x2d9),_0x44061f['gatewaySettings']));_0x25b792['wallets']&&(_0x25b792['wallets'][_0x544747(0x200)]!==undefined&&(_0x44061f[_0x544747(0x200)]=_0x25b792[_0x544747(0x2f2)][_0x544747(0x200)]||null),_0x25b792['wallets'][_0x544747(0x23d)]!==undefined&&(_0x44061f['usdtTrcWallet']=_0x25b792[_0x544747(0x2f2)][_0x544747(0x23d)]||null),_0x25b792[_0x544747(0x2f2)][_0x544747(0x1e5)]!==undefined&&(_0x44061f[_0x544747(0x1e5)]=_0x25b792['wallets']['usdtErcWallet']||null),_0x25b792[_0x544747(0x2f2)]['usdcPolygonWallet']!==undefined&&(_0x44061f[_0x544747(0x20f)]=_0x25b792[_0x544747(0x2f2)][_0x544747(0x20f)]||null),delete _0x44061f[_0x544747(0x2f2)]);const _0x442c77=await database_1[_0x544747(0x257)][_0x544747(0x2e5)]['update']({'where':{'id':_0x45d7f9},'data':_0x44061f,'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});return console[_0x544747(0x260)](_0x544747(0x29d)+_0x36926e+_0x544747(0x304),_0x442c77[_0x544747(0x241)]),{'id':_0x442c77['id'],'fullName':_0x442c77['name'],'username':_0x442c77['username'],'telegramId':_0x442c77[_0x544747(0x2b2)],'merchantUrl':_0x442c77[_0x544747(0x1cb)],'gateways':_0x442c77['paymentGateways']?JSON[_0x544747(0x208)](_0x442c77[_0x544747(0x236)]):null,'gatewaySettings':_0x442c77['gatewaySettings']?JSON[_0x544747(0x208)](_0x442c77['gatewaySettings']):null,'publicKey':_0x442c77[_0x544747(0x2c2)],'wallets':{'usdtPolygonWallet':_0x442c77['usdtPolygonWallet'],'usdtTrcWallet':_0x442c77['usdtTrcWallet'],'usdtErcWallet':_0x442c77[_0x544747(0x1e5)],'usdcPolygonWallet':_0x442c77['usdcPolygonWallet']},'status':_0x442c77[_0x544747(0x233)],'createdAt':_0x442c77['createdAt']};}async[a48_0x586363(0x2ce)](_0x44c681){const _0x29e2e1=a48_0x586363,_0x3b264c=await database_1[_0x29e2e1(0x257)][_0x29e2e1(0x2e5)][_0x29e2e1(0x2d4)]({'where':{'id':_0x44c681},'data':{'status':_0x29e2e1(0x26a)},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});return{'id':_0x3b264c['id'],'fullName':_0x3b264c['name'],'username':_0x3b264c[_0x29e2e1(0x244)],'telegramId':_0x3b264c[_0x29e2e1(0x2b2)],'merchantUrl':_0x3b264c['shopUrl'],'gateways':_0x3b264c['paymentGateways']?JSON[_0x29e2e1(0x208)](_0x3b264c[_0x29e2e1(0x236)]):null,'gatewaySettings':_0x3b264c[_0x29e2e1(0x241)]?JSON[_0x29e2e1(0x208)](_0x3b264c[_0x29e2e1(0x241)]):null,'publicKey':_0x3b264c[_0x29e2e1(0x2c2)],'wallets':{'usdtPolygonWallet':_0x3b264c[_0x29e2e1(0x200)],'usdtTrcWallet':_0x3b264c[_0x29e2e1(0x23d)],'usdtErcWallet':_0x3b264c[_0x29e2e1(0x1e5)],'usdcPolygonWallet':_0x3b264c['usdcPolygonWallet']},'status':_0x3b264c[_0x29e2e1(0x233)],'createdAt':_0x3b264c[_0x29e2e1(0x2af)]};}async[a48_0x586363(0x302)](_0x1cbe9d){const _0x33488b=a48_0x586363,_0x198e26=await database_1[_0x33488b(0x257)][_0x33488b(0x2e5)]['update']({'where':{'id':_0x1cbe9d},'data':{'status':_0x33488b(0x284)},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});return{'id':_0x198e26['id'],'fullName':_0x198e26['name'],'username':_0x198e26[_0x33488b(0x244)],'telegramId':_0x198e26[_0x33488b(0x2b2)],'merchantUrl':_0x198e26['shopUrl'],'gateways':_0x198e26[_0x33488b(0x236)]?JSON[_0x33488b(0x208)](_0x198e26['paymentGateways']):null,'gatewaySettings':_0x198e26[_0x33488b(0x241)]?JSON[_0x33488b(0x208)](_0x198e26[_0x33488b(0x241)]):null,'publicKey':_0x198e26[_0x33488b(0x2c2)],'wallets':{'usdtPolygonWallet':_0x198e26[_0x33488b(0x200)],'usdtTrcWallet':_0x198e26[_0x33488b(0x23d)],'usdtErcWallet':_0x198e26[_0x33488b(0x1e5)],'usdcPolygonWallet':_0x198e26['usdcPolygonWallet']},'status':_0x198e26[_0x33488b(0x233)],'createdAt':_0x198e26[_0x33488b(0x2af)]};}async[a48_0x586363(0x2e3)](_0x5ac246){const _0x29c9e0=a48_0x586363,{page:_0xa33de6,limit:_0x52294b,status:_0x2b888d}=_0x5ac246,_0xec860=(_0xa33de6-0x1)*_0x52294b,_0x8dbb59={};_0x2b888d&&(_0x8dbb59[_0x29c9e0(0x233)]=_0x2b888d[_0x29c9e0(0x261)]());const [_0x59fcc1,_0x4a81c1]=await Promise[_0x29c9e0(0x1fd)]([database_1['default'][_0x29c9e0(0x2e5)][_0x29c9e0(0x19f)]({'where':_0x8dbb59,'skip':_0xec860,'take':_0x52294b,'orderBy':{'createdAt':_0x29c9e0(0x22e)},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'usdcErcWallet':!![],'status':!![],'twoFactorEnabled':!![],'createdAt':!![]}}),database_1[_0x29c9e0(0x257)][_0x29c9e0(0x2e5)][_0x29c9e0(0x267)]({'where':_0x8dbb59})]);return{'users':_0x59fcc1[_0x29c9e0(0x16e)](_0x2aabc8=>{const _0xd95aac=_0x29c9e0,_0x3e2276=_0x2aabc8[_0xd95aac(0x236)]?JSON['parse'](_0x2aabc8[_0xd95aac(0x236)]):null,_0x4ea1d3=_0x3e2276?_0x3e2276[_0xd95aac(0x16e)](_0x1b53e0=>this[_0xd95aac(0x1f9)](_0x1b53e0)):null;return{'id':_0x2aabc8['id'],'fullName':_0x2aabc8[_0xd95aac(0x2d2)],'username':_0x2aabc8[_0xd95aac(0x244)],'telegramId':_0x2aabc8['telegram'],'merchantUrl':_0x2aabc8[_0xd95aac(0x1cb)],'gateways':_0x4ea1d3,'gatewaySettings':_0x2aabc8['gatewaySettings']?JSON[_0xd95aac(0x208)](_0x2aabc8['gatewaySettings']):null,'publicKey':_0x2aabc8[_0xd95aac(0x2c2)],'wallets':{'usdtPolygonWallet':_0x2aabc8['usdtPolygonWallet'],'usdtTrcWallet':_0x2aabc8[_0xd95aac(0x23d)],'usdtErcWallet':_0x2aabc8[_0xd95aac(0x1e5)],'usdcPolygonWallet':_0x2aabc8[_0xd95aac(0x20f)],'usdcErcWallet':_0x2aabc8['usdcErcWallet']},'status':_0x2aabc8[_0xd95aac(0x233)],'twoFactorEnabled':_0x2aabc8['twoFactorEnabled']||![],'createdAt':_0x2aabc8['createdAt']};}),'pagination':{'page':_0xa33de6,'limit':_0x52294b,'total':_0x4a81c1,'totalPages':Math[_0x29c9e0(0x2f4)](_0x4a81c1/_0x52294b)}};}async[a48_0x586363(0x1ae)](_0x22aa50){const _0x2a188c=a48_0x586363,_0x1ffe49=await database_1[_0x2a188c(0x257)]['shop'][_0x2a188c(0x19d)]({'where':{'id':_0x22aa50},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'usdcErcWallet':!![],'status':!![],'createdAt':!![]}});if(!_0x1ffe49)return null;const _0x2c2f9a=_0x1ffe49[_0x2a188c(0x236)]?JSON[_0x2a188c(0x208)](_0x1ffe49['paymentGateways']):null,_0x425d42=_0x2c2f9a?_0x2c2f9a['map'](_0xd43f9c=>this['getGatewayDisplayName'](_0xd43f9c)):null;return _0x2c2f9a&&_0x425d42&&console[_0x2a188c(0x260)](_0x2a188c(0x18d),_0x2c2f9a,'->',_0x425d42),{'id':_0x1ffe49['id'],'fullName':_0x1ffe49[_0x2a188c(0x2d2)],'username':_0x1ffe49[_0x2a188c(0x244)],'telegramId':_0x1ffe49[_0x2a188c(0x2b2)],'merchantUrl':_0x1ffe49[_0x2a188c(0x1cb)],'gateways':_0x425d42,'gatewaySettings':_0x1ffe49[_0x2a188c(0x241)]?JSON[_0x2a188c(0x208)](_0x1ffe49[_0x2a188c(0x241)]):null,'publicKey':_0x1ffe49[_0x2a188c(0x2c2)],'wallets':{'usdtPolygonWallet':_0x1ffe49['usdtPolygonWallet'],'usdtTrcWallet':_0x1ffe49[_0x2a188c(0x23d)],'usdtErcWallet':_0x1ffe49[_0x2a188c(0x1e5)],'usdcPolygonWallet':_0x1ffe49['usdcPolygonWallet'],'usdcErcWallet':_0x1ffe49[_0x2a188c(0x21b)]},'status':_0x1ffe49[_0x2a188c(0x233)],'createdAt':_0x1ffe49[_0x2a188c(0x2af)]};}async['createUser'](_0x28cd2b){const _0x47b0c8=a48_0x586363,{fullName:_0x1f12d9,username:_0x430e00,password:_0x320d98,telegramId:_0x3a5f89,merchantUrl:_0x181fe4,gateways:_0x31db47,gatewaySettings:_0x11565d,wallets:_0x452dd4}=_0x28cd2b,_0x647f1f=await database_1[_0x47b0c8(0x257)][_0x47b0c8(0x2e5)][_0x47b0c8(0x19d)]({'where':{'username':_0x430e00}});if(_0x647f1f)throw new Error(_0x47b0c8(0x171));if(_0x3a5f89){const _0x5e623d=await database_1[_0x47b0c8(0x257)][_0x47b0c8(0x2e5)][_0x47b0c8(0x19d)]({'where':{'telegram':_0x3a5f89}});if(_0x5e623d)throw new Error(_0x47b0c8(0x1e8));}const _0x192e8d=await bcryptjs_1['default'][_0x47b0c8(0x28e)](_0x320d98,0xc),_0x4915e4=_0x47b0c8(0x2f6)+crypto_1[_0x47b0c8(0x257)][_0x47b0c8(0x290)](0x20)['toString']('hex'),_0x3f2a7d=_0x47b0c8(0x23b)+crypto_1[_0x47b0c8(0x257)][_0x47b0c8(0x290)](0x20)['toString'](_0x47b0c8(0x23a)),_0x5bc5f8=_0x31db47?_0x31db47[_0x47b0c8(0x16e)](_0x1df250=>this['getGatewayInternalName'](_0x1df250)):null;_0x31db47&&_0x5bc5f8&&console['log'](_0x47b0c8(0x1c6),_0x31db47,'->',_0x5bc5f8);const _0x4b160b=await database_1[_0x47b0c8(0x257)][_0x47b0c8(0x2e5)]['create']({'data':{'name':_0x1f12d9,'username':_0x430e00,'password':_0x192e8d,'telegram':_0x3a5f89,'shopUrl':_0x181fe4,'paymentGateways':_0x5bc5f8?JSON[_0x47b0c8(0x2de)](_0x5bc5f8):null,'gatewaySettings':_0x11565d?JSON[_0x47b0c8(0x2de)](_0x11565d):null,'usdtPolygonWallet':_0x452dd4?.[_0x47b0c8(0x200)]||null,'usdtTrcWallet':_0x452dd4?.['usdtTrcWallet']||null,'usdtErcWallet':_0x452dd4?.['usdtErcWallet']||null,'usdcPolygonWallet':_0x452dd4?.[_0x47b0c8(0x20f)]||null,'publicKey':_0x4915e4,'secretKey':_0x3f2a7d,'status':_0x47b0c8(0x284)},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});return{'id':_0x4b160b['id'],'fullName':_0x4b160b[_0x47b0c8(0x2d2)],'username':_0x4b160b[_0x47b0c8(0x244)],'telegramId':_0x4b160b[_0x47b0c8(0x2b2)],'merchantUrl':_0x4b160b[_0x47b0c8(0x1cb)],'gateways':_0x4b160b[_0x47b0c8(0x236)]?JSON[_0x47b0c8(0x208)](_0x4b160b[_0x47b0c8(0x236)]):null,'gatewaySettings':_0x4b160b[_0x47b0c8(0x241)]?JSON[_0x47b0c8(0x208)](_0x4b160b[_0x47b0c8(0x241)]):null,'publicKey':_0x4b160b['publicKey'],'wallets':{'usdtPolygonWallet':_0x4b160b[_0x47b0c8(0x200)],'usdtTrcWallet':_0x4b160b['usdtTrcWallet'],'usdtErcWallet':_0x4b160b[_0x47b0c8(0x1e5)],'usdcPolygonWallet':_0x4b160b[_0x47b0c8(0x20f)]},'status':_0x4b160b[_0x47b0c8(0x233)],'createdAt':_0x4b160b[_0x47b0c8(0x2af)]};}async[a48_0x586363(0x311)](_0x5a71d5){const _0x1a86b9=a48_0x586363;await database_1[_0x1a86b9(0x257)]['shop'][_0x1a86b9(0x1b1)]({'where':{'id':_0x5a71d5}});}async[a48_0x586363(0x202)](_0x5cd116){const _0x28737d=a48_0x586363,_0x1fd42d=await database_1['default'][_0x28737d(0x2e5)][_0x28737d(0x19d)]({'where':{'id':_0x5cd116},'select':{'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'usdcErcWallet':!![]}});if(!_0x1fd42d)throw new Error(_0x28737d(0x21f));return{'usdtPolygonWallet':_0x1fd42d['usdtPolygonWallet'],'usdtTrcWallet':_0x1fd42d[_0x28737d(0x23d)],'usdtErcWallet':_0x1fd42d[_0x28737d(0x1e5)],'usdcPolygonWallet':_0x1fd42d[_0x28737d(0x20f)],'usdcErcWallet':_0x1fd42d[_0x28737d(0x21b)]};}['generateBackupCodes'](_0x211d7f=0x8){const _0x51809c=a48_0x586363,_0x5f039c=[];for(let _0x4c3d6a=0x0;_0x4c3d6a<_0x211d7f;_0x4c3d6a++){const _0x5a9750=crypto_1[_0x51809c(0x257)][_0x51809c(0x290)](0x4)['toString'](_0x51809c(0x23a))['toUpperCase']();_0x5f039c[_0x51809c(0x16f)](_0x5a9750);}return _0x5f039c;}async[a48_0x586363(0x186)](_0x46820a){const _0x6c3622=a48_0x586363,_0x4c7bb9=await database_1[_0x6c3622(0x257)][_0x6c3622(0x2e5)][_0x6c3622(0x19d)]({'where':{'id':_0x46820a},'select':{'id':!![],'name':!![],'username':!![],'twoFactorEnabled':!![]}});if(!_0x4c7bb9)throw new Error('Shop\x20not\x20found');const _0x3f5b62=speakeasy_1[_0x6c3622(0x257)]['generateSecret']({'name':'TrapaPay\x20('+_0x4c7bb9[_0x6c3622(0x244)]+')','issuer':_0x6c3622(0x1d2),'length':0x20}),_0x1bb405=await qrcode_1['default'][_0x6c3622(0x1c7)](_0x3f5b62[_0x6c3622(0x1cf)]),_0x3c110c=this['generateBackupCodes'](0x8),_0x5a12a8=await Promise[_0x6c3622(0x1fd)](_0x3c110c[_0x6c3622(0x16e)](_0x474088=>bcryptjs_1[_0x6c3622(0x257)][_0x6c3622(0x28e)](_0x474088,0xa)));return await database_1[_0x6c3622(0x257)][_0x6c3622(0x2e5)]['update']({'where':{'id':_0x46820a},'data':{'twoFactorSecret':_0x3f5b62[_0x6c3622(0x1de)],'backupCodes':JSON[_0x6c3622(0x2de)](_0x5a12a8)}}),console[_0x6c3622(0x260)]('ðŸ”\x202FA\x20setup\x20initiated\x20for\x20shop:\x20'+_0x4c7bb9[_0x6c3622(0x244)]),console[_0x6c3622(0x260)](_0x6c3622(0x286)+_0x3c110c[_0x6c3622(0x1e7)]+_0x6c3622(0x1a1)),{'secret':_0x3f5b62[_0x6c3622(0x1de)],'qrCode':_0x1bb405,'manualEntryKey':_0x3f5b62['base32'],'backupCodes':_0x3c110c};}async[a48_0x586363(0x229)](_0x1be568,_0x1e847f){const _0x3ff63a=a48_0x586363,_0x58d449=await database_1[_0x3ff63a(0x257)][_0x3ff63a(0x2e5)]['findUnique']({'where':{'id':_0x1be568},'select':{'id':!![],'username':!![],'twoFactorSecret':!![],'twoFactorEnabled':!![]}});if(!_0x58d449)throw new Error('Shop\x20not\x20found');if(!_0x58d449[_0x3ff63a(0x20d)])throw new Error(_0x3ff63a(0x1f2));if(_0x58d449[_0x3ff63a(0x29a)])throw new Error(_0x3ff63a(0x2c1));const _0x12c81b=speakeasy_1[_0x3ff63a(0x257)][_0x3ff63a(0x2be)][_0x3ff63a(0x197)]({'secret':_0x58d449[_0x3ff63a(0x20d)],'encoding':'base32','token':_0x1e847f,'window':0x2});if(!_0x12c81b)throw new Error(_0x3ff63a(0x30f));return await database_1[_0x3ff63a(0x257)][_0x3ff63a(0x2e5)]['update']({'where':{'id':_0x1be568},'data':{'twoFactorEnabled':!![]}}),console[_0x3ff63a(0x260)](_0x3ff63a(0x1e9)+_0x58d449['username']),{'enabled':!![]};}async[a48_0x586363(0x2e4)](_0x344e69){const _0x26a4b9=a48_0x586363,_0x79d307=await database_1[_0x26a4b9(0x257)]['shop']['findUnique']({'where':{'id':_0x344e69},'select':{'id':!![],'username':!![],'twoFactorEnabled':!![]}});if(!_0x79d307)throw new Error(_0x26a4b9(0x21f));await database_1['default'][_0x26a4b9(0x2e5)][_0x26a4b9(0x2d4)]({'where':{'id':_0x344e69},'data':{'twoFactorEnabled':![],'twoFactorSecret':null,'backupCodes':null}}),console[_0x26a4b9(0x260)](_0x26a4b9(0x2a2)+_0x79d307[_0x26a4b9(0x244)]);}['generateDailyStatistics'](_0x227a9c,_0x224cbe,_0x4ab69d){const _0x29d017=a48_0x586363,_0x1a553a=new Map(),_0x2f78f2=new Date(_0x224cbe);while(_0x2f78f2<=_0x4ab69d){const _0x8bfe84=_0x2f78f2[_0x29d017(0x289)]()[_0x29d017(0x308)]('T')[0x0];_0x1a553a[_0x29d017(0x29e)](_0x8bfe84,{'revenue':0x0,'count':0x0}),_0x2f78f2[_0x29d017(0x2fe)](_0x2f78f2[_0x29d017(0x291)]()+0x1);}for(const _0x1b304b of _0x227a9c){const _0x4cf940=_0x1b304b['createdAt'][_0x29d017(0x289)]()[_0x29d017(0x308)]('T')[0x0],_0x5a54d6=_0x1a553a[_0x29d017(0x24b)](_0x4cf940);_0x5a54d6&&(_0x5a54d6['count']+=0x1,_0x1b304b[_0x29d017(0x233)]===_0x29d017(0x1ca)&&(_0x1b304b[_0x29d017(0x29b)]?_0x5a54d6[_0x29d017(0x1bd)]+=_0x1b304b[_0x29d017(0x29b)]:console[_0x29d017(0x260)](_0x29d017(0x2e6)+_0x1b304b['id']+'\x20missing\x20amountUSDT,\x20using\x20fallback\x20conversion')));}const _0x4b5b92=[],_0x4900b4=[];for(const [_0x53fdb4,_0x53bcdc]of _0x1a553a){_0x4b5b92[_0x29d017(0x16f)]({'date':_0x53fdb4,'amount':Math['round'](_0x53bcdc[_0x29d017(0x1bd)]*0x64)/0x64}),_0x4900b4[_0x29d017(0x16f)]({'date':_0x53fdb4,'count':_0x53bcdc[_0x29d017(0x267)]});}return{'dailyRevenue':_0x4b5b92,'dailyPayments':_0x4900b4};}}function a48_0x5cdf(_0x3a8a7e,_0x5bd389){_0x3a8a7e=_0x3a8a7e-0x16b;const _0x187c2c=a48_0x187c();let _0x5cdf6a=_0x187c2c[_0x3a8a7e];return _0x5cdf6a;}function a48_0x187c(){const _0x48cb32=['_count','paidAt','toLowerCase','getPayoutById','default','ðŸ“Š\x20Statistics\x20PAID\x20payments\x20count:\x20','NONEXISTENT_GATEWAY_FILTER','\x20balance\x20updated:\x20','findFirst','\x20\x20\x20Current\x20network:\x20','totalPayments','erc20','setUTCDate','log','toUpperCase','statusChangedBy','\x20\x20\x20ðŸ’°\x20Total\x20turnover:\x20','convertToUSDT','gatewayEarnings','ðŸ”\x20Shop\x20wallets:','count','\x20\x20\x20Total\x20paid\x20out:\x20','KLYME\x20EU','SUSPENDED','\x20USDT\x20from\x20balance','\x20USDT,\x20Requested:\x20','customerIp','toString','floor','_sum','paymentsCount','âœ…\x20Customer\x20data\x20updated\x20for\x20payment\x20','\x20USDT\x20(calculated\x20-\x20payouts\x20-\x20balance)','ðŸ”\x20No\x20wallet\x20provided,\x20looking\x20up\x20from\x20shop\x20settings...','\x20\x20\x20Final\x20payout\x20amount\x20used:\x20','ðŸ“…\x20Date\x20to\x20filter:\x20','filter','ðŸ”„\x20REFUND:\x20Payment\x20amount\x20already\x20deducted\x20from\x20balance','Open\x20Banking\x202','ðŸ“Š\x20Merchant\x20statistics\x20calculated:','ðŸ“Š\x20Calculating\x20payout\x20statistics...','ðŸ”„\x20Converted\x20gateway\x20name\x20\x27','\x20\x20\x20ï¿½ðŸ“Š\x20Total\x20payments:\x20','gatewayOrderId','defineProperty','updateCustomerData','bcryptjs','getUTCDate','commission','ACTIVE','notes','ðŸ”‘\x20Generated\x20','4fSSmpZ','paidOutUSDT','toISOString','noda','\x27\x20as\x20is\x20(not\x20found\x20in\x20mappings)','\x20\x20\x20Current\x20amount:\x20','join','hash','dailyRevenue','randomBytes','getDate','sort','getAllPayouts','ðŸ“Š\x20Payout\x20statistics\x20calculated:','gte','reduce','currency','ðŸ’¸\x20CHARGEBACK\x20penalty\x20ONLY:\x20-','1823920VPxXMn','twoFactorEnabled','amountUSDT','\x20\x20\x20Payout\x20amount:\x20','ðŸŽ¯\x20[','set','crypto','\x20\x20\x20ðŸ’µ\x20Available\x20balance:\x20','\x20\x20\x20Gateway:\x20','ðŸ”\x202FA\x20disabled\x20for\x20shop:\x20','erc20_usdc','âš ï¸\x20Gateway\x20\x27','adminNotes','ðŸ”\x20Selected\x20trc20\x20wallet:\x20','amount','\x20updated\x20successfully','externalPaymentUrl','aggregate','telegramBotService','\x20\x20\x20Difference:\x20','\x20USDT\x20-\x20will\x20return\x20to\x20balance','\x20\x20\x20ðŸ–¥ï¸\x20User\x20Agent:\x20','createdAt','dateFrom','\x20\x20\x20Shop\x20balance:\x20','telegram','\x20in\x20','abs','lte','âœ…\x20Using\x20wallet\x20from\x20request:\x20','\x20\x20\x20ðŸ’¸\x20Total\x20payouts:\x20','error','10xkgzNB','\x20\x20\x20ï¿½\x20Total\x20paid\x20out:\x20','telegramId','dateTo','payouts','totp','ðŸ“Š\x20Statistics\x20WHERE\x20conditions:','\x27\x20->\x20name\x20\x27','2FA\x20is\x20already\x20enabled','publicKey','682395lBjWeN','\x20USDT\x20(sum\x20of\x20all\x20merchant\x20balances)','\x20PAID\x20payments','wallet','ðŸ“‹\x20Getting\x20merchants\x20selection\x20list...','\x20USDT\x20(theoretical\x20net)','slice','ðŸ”\x20Balance\x20check\x20details:','ðŸ”„\x20Admin\x20updating\x20payment\x20','replace','customerUa','suspendUser','Error\x20parsing\x20gateway\x20settings\x20for\x20shop\x20','not\x20set','whiteUrl','name','ðŸ“Š\x20Getting\x20merchant\x20statistics\x20with\x20filters:','update','CHARGEBACK','month','entries','\x20for\x20shop\x20',']\x20Gateway\x20settings\x20JSON\x20string:','ðŸ’°\x20Payment\x20amount\x20is\x20NOT\x20deducted\x20(chargeback\x20penalty\x20only)','shopId','ðŸ”§\x20[','\x20USDT\x20(gross\x20revenue)','stringify','date','\x20\x20\x20Tolerance:\x20','\x27\x20not\x20found.\x20Available\x20gateways:\x20','AdminService','getAllUsers','disable2FA','shop','âš ï¸\x20Payment\x20','\x20\x20\x20Merchant\x20loses:\x20','ðŸ“Š\x20Total\x20payments\x20(including\x20failed):\x20','\x20\x20\x20ðŸ”\x20Calculated\x20after\x20commission:\x20','asc',',\x20refunds:\x20','periodFrom','ðŸ”\x20Creating\x20payout\x20with\x20data:','âœ…\x20Payout\x20created\x20in\x20DB:','averageCommissionRate','ðŸ“±\x20Telegram\x20notification\x20sent\x20for\x20payout\x20','week','wallets','\x20USDT,\x20merchant:\x20','ceil','ðŸ”\x20Total\x20payments\x20matching\x20filters:\x20','pk_','âœ…\x20Using\x20gateway\x20filter:\x20\x27','UTC','%\x20commission)','\x20\x20\x20ðŸ’³\x20Total\x20payments:\x20','txid','cointopay2','this_month','setDate','%\x20from\x20','thisMonth','values','activateUser','ðŸ”\x20Using\x20gateway\x20\x27',']\x20User\x20updated,\x20gatewaySettings\x20from\x20DB:','ðŸ“Š\x20Calculated\x20commission\x20rate\x20for\x20payment\x20','Insufficient\x20balance.\x20Available:\x20','ðŸ“Š\x20Getting\x20merchants\x20awaiting\x20payout\x20with\x20filters:','split','statusChangedAt','warn','Error\x20parsing\x20gateway\x20settings\x20for\x20payment\x20','getUTCMonth','EXPIRED','\x20\x20\x20ðŸ’¸\x20Total\x20payouts\x20(all\x20time):\x20','Invalid\x202FA\x20token','not\x20provided','deleteUser','currencyService','âœ…\x20Payout\x20','$transaction','totalAmountUSDT','map','push','groupBy','Username\x20already\x20exists','\x20-\x20','\x20\x20\x20Balance:\x20','createPayout','speakeasy','pendingPayout','22076aSUnwG','ðŸ’°\x20[PAYOUT]\x20Merchant\x20','Insufficient\x20balance\x20for\x20amount\x20increase.\x20Available:\x20','getMerchantsSelection','customerName','test_gateway','gatewayCommissionRate','includes',',\x20userId:\x20','ðŸ’°\x20Payment\x20','\x20with\x20payout\x20history',',\x20chargebacks:\x20','\x20\x20\x20Amount\x20difference:\x20','getPayoutStats','last_month','setup2FA','getAllPayments','klyme_gb','ðŸ“Š\x20[ADMIN]\x20Using\x20saved\x20amountAfterGatewayCommissionUSDT:\x20','\x20\x20\x20ðŸŒ\x20IP:\x20','getFullYear','\x20\x20\x20Added\x20to\x20balance:\x20+','ðŸ”„\x20Gateway\x20mapping\x20(get):','ðŸ“Š\x20Using\x20saved\x20values\x20for\x20payment\x20','\x20\x20\x20â³\x20Pending\x20payout:\x20','CoinToPay','\x20\x20\x20ðŸ“…\x20This\x20month:\x20','orderId','updatePaymentStatus','COMPLETED','merchantEarningsUSDT','amountAfterGatewayCommissionUSDT','verify','__esModule','ðŸ”„\x20Gateway\x20mapping:','\x27\x20to\x20name\x20\x27','gateways','periodTo','findUnique','USDT','findMany','\x20\x20\x20â³\x20Awaiting\x20payout:\x20','\x20backup\x20codes','this_week','customerEmail','qrcode','payment','ðŸ“Š\x20Final\x20WHERE\x20conditions:',':\x20commission\x20=\x20','REFUND','\x20\x20\x20Current\x20total\x20paid\x20out:\x20','amountAfterCommissionUSDT','\x20USDT\x20(total\x20paid\x20to\x20merchants)','turnoverUSDT','\x20USDT\x20(rounded\x20to\x202\x20decimal\x20places)','getUserById','1593gybtTH','klyme_eu','delete','../types/gateway','\x27\x20->\x20ID\x20\x27','toFixed','polygon_usdc','\x20USDT\x20(+','deletePayout','getGatewayIdByName','getMerchantsAwaitingPayout','âŒ\x20Failed\x20to\x20send\x20Telegram\x20notification\x20for\x20payout\x20','\x20USDT\x20(after\x20','\x20\x20\x20Full\x20amount:\x20','revenue','custom_','insensitive','\x20USDT)','\x20\x20\x20âœ…\x20Total\x20net\x20balances:\x20','getUTCFullYear','ðŸ“…\x20Payout\x20date\x20from\x20filter:\x20','ÐÐµ\x20ÑƒÐºÐ°Ð·Ð°Ð½','./currencyService','ðŸ”„\x20Gateway\x20mapping\x20(create):','toDataURL','merchantUrl','ðŸ’¸\x20CHARGEBACK:\x20Processing\x20penalty-only\x20deduction','PAID','shopUrl','lastMonth','network','\x20\x20\x20ðŸŒ\x20Country:\x20','otpauth_url','availableBalance','round','TrapaPay','ðŸ“Š\x20Getting\x20payments\x20with\x20filters:','totalPayout','commissionUSDT','setHours','balance',',\x20successful:\x20','\x20USDT\x20(same\x20as\x20awaiting)','ru-RU','24848rwWilv','chargebackAmount','294RUevwJ','base32','\x20\x20\x20ðŸ’°\x20Total\x20payout:\x20','password','\x20USDT,\x20Required:\x20','./telegramBotService','\x20USDT\x20(-',']\x20Password\x20not\x20provided\x20or\x20empty,\x20skipping\x20password\x20update','usdtErcWallet','\x20USDT\x20(already\x20paid\x20out)','length','Telegram\x20username\x20already\x20exists','ðŸ”\x202FA\x20enabled\x20for\x20shop:\x20','\x20paid\x20payments\x20for\x20analysis','ðŸ“…\x20Payout\x20date\x20to\x20filter:\x20','âœ…\x20Balance\x20check\x20passed\x20(with\x20tolerance)','ðŸ“Š\x20Sorting\x20payments\x20by\x20','\x20\x20\x20Available\x20(number):\x20','âš ï¸\x20CHARGEBACK\x20without\x20penalty\x20amount\x20-\x20no\x20balance\x20change','polygon','\x20USDT','2FA\x20not\x20set\x20up.\x20Please\x20call\x20setup\x20endpoint\x20first','2020-01-01','failUrl','\x20merchants','ðŸ’³\x20Final\x20payout\x20wallet\x20for\x20','3143vcbNyv','localeCompare','getGatewayDisplayName','getPaymentById','1095347dVVCQC','Error\x20processing\x20payment\x20','all','\x20\x20\x20ðŸ“…\x20Total\x20payouts\x20(this\x20month):\x20','totalCommissionRate','usdtPolygonWallet','\x20\x20\x20Current\x20balance:\x20','getShopWallets','\x20USDT\x20-\x20will\x20deduct\x20from\x20balance','\x20\x20\x20Amount\x20increased\x20by\x20','PENDING','custom',',\x20Commission:\x20','parse','ðŸ“Š\x20Available\x20gateways\x20in\x20database:','payout','updatedAt','yesterday','twoFactorSecret','turnover','usdcPolygonWallet','all_time','ðŸŽ¯\x20updateUser\x20called\x20with\x20ID:\x20','ðŸ”\x20[','\x20\x20\x20Amount\x20decreased\x20by\x20','getTime','ðŸ“Š\x20Using\x20saved\x20commission\x20rate\x20for\x20payment\x20','pendingUrl','startsWith','ðŸ’°\x20Current\x20shop\x20balance:\x20','min','MasterCard','usdcErcWallet','substr','gateway','\x20\x20\x20Transaction\x20hash:\x20','Shop\x20not\x20found','totalTurnover',']\x20Gateway\x20settings\x20before\x20saving:','\x20balance\x20updated:','forEach','\x27)\x20not\x20found\x20in\x20database,\x20returning\x20empty\x20result','\x20\x20\x20ðŸ‘¤\x20Merchant\x20earnings:\x20','ðŸ”\x20Selected\x20erc20\x20wallet:\x20','rapyd','4242WvXVRA','enable2FA','klyme_de','Noda','totalPaidOut','failureMessage','desc','\x20\x20\x20New\x20amount:\x20','\x20->\x20','\x20merchants\x20with\x20rounded\x20balance\x20!=\x200.00\x20(excluding\x20balances\x20that\x20round\x20to\x200.00)','Payout\x20not\x20found','status','\x27\x20(from\x20\x27','getMonth','paymentGateways','getUTCDay','ðŸ’°\x20Updating\x20payout\x20','ðŸ”\x20Selected\x20polygon_usdc\x20wallet:\x20','hex','sk_','0000','usdtTrcWallet','period','getGatewayNameById','\x20\x20\x20Subtracted\x20from\x20balance:\x20-','gatewaySettings','averageCheckUSDT','\x20payments)','username','customerCountry','some','getGatewayInternalName','merchantEarnings','\x20USDT,\x20Difference:\x20','\x20to\x20','get','27402840dPKIZO','ðŸ’°\x20Shop\x20','sendPayoutNotification','ðŸ“Š\x20Gateway\x20filter\x20applied:','ðŸ“…\x20Period:\x20','getMerchantStatistics','ðŸ’°\x20Creating\x20payout\x20for\x20shop\x20'];a48_0x187c=function(){return _0x48cb32;};return a48_0x187c();}exports[a48_0x586363(0x2e2)]=AdminService;