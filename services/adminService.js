'use strict';function a36_0x5d18(_0x4228cc,_0x4ff122){const _0x2d006d=a36_0x2d00();return a36_0x5d18=function(_0x5d1875,_0x2442f8){_0x5d1875=_0x5d1875-0x1ef;let _0x4ec9a8=_0x2d006d[_0x5d1875];return _0x4ec9a8;},a36_0x5d18(_0x4228cc,_0x4ff122);}const a36_0x30790d=a36_0x5d18;(function(_0x4c4c19,_0x2b38c9){const _0x1e4a90=a36_0x5d18,_0x1ea108=_0x4c4c19();while(!![]){try{const _0xdda1d2=-parseInt(_0x1e4a90(0x317))/0x1*(parseInt(_0x1e4a90(0x272))/0x2)+-parseInt(_0x1e4a90(0x31f))/0x3*(-parseInt(_0x1e4a90(0x310))/0x4)+parseInt(_0x1e4a90(0x2a3))/0x5+-parseInt(_0x1e4a90(0x2c5))/0x6*(-parseInt(_0x1e4a90(0x264))/0x7)+parseInt(_0x1e4a90(0x2d9))/0x8*(parseInt(_0x1e4a90(0x305))/0x9)+-parseInt(_0x1e4a90(0x228))/0xa+-parseInt(_0x1e4a90(0x20f))/0xb*(parseInt(_0x1e4a90(0x296))/0xc);if(_0xdda1d2===_0x2b38c9)break;else _0x1ea108['push'](_0x1ea108['shift']());}catch(_0x29dee9){_0x1ea108['push'](_0x1ea108['shift']());}}}(a36_0x2d00,0x534a2));var __importDefault=this&&this[a36_0x30790d(0x21d)]||function(_0x594424){const _0x1b2181=a36_0x30790d;return _0x594424&&_0x594424[_0x1b2181(0x2ce)]?_0x594424:{'default':_0x594424};};Object['defineProperty'](exports,a36_0x30790d(0x2ce),{'value':!![]}),exports['AdminService']=void 0x0;function a36_0x2d00(){const _0x34e4e6=['💳\x20Payout\x20wallet\x20for\x20','merchantEarningsUSDT',',\x20userId:\x20','log','\x27\x20(from\x20\x27','admin','getGatewayIdByName','shopId','usdtTrcWallet','\x20\x20\x20⏳\x20Pending\x20payout:\x20','notes','customerCountry','30d','PAID','paymentGateways','trc20','3564JlHvAl','SUSPENDED','chargebackAmount','\x20to\x20','status','polygon','round','Shop\x20not\x20found','telegram','gateways','📅\x20Period\x20\x27all\x27:\x20Using\x20start\x20date\x20from\x20first\x20payment:\x20','\x20became\x20PAID:','paidAt','3340640ZQHdEW','🔐\x20[','updateUser','✅\x20Customer\x20data\x20updated\x20for\x20payment\x20','\x20\x20\x20Current\x20balance:\x20','default','totalPayments','toUpperCase','erc20',':\x20commission\x20=\x20',',\x20successful:\x20','asc','Insufficient\x20balance.\x20Available:\x20','some','deleteUser','_count','forEach','NONEXISTENT_GATEWAY_FILTER','period','\x20\x20\x20⏳\x20Awaiting\x20payout:\x20','averageCommissionRate','dateFrom','txid','\x20USDT\x20(after\x20','\x20USDT\x20for\x20payment\x20','%\x20commission)','Telegram\x20username\x20already\x20exists','\x20USDT\x20(without\x20commission)','getPayoutStats','_sum','entries','summary','💰\x20Payment\x20','periodTo','24744eJluWo','Noda','\x20merchants','📊\x20[ADMIN]\x20Using\x20saved\x20amountAfterGatewayCommissionUSDT:\x20','randomBytes','currencyService','getFullYear','wallets','Rapyd','__esModule','ACTIVE','commission','ceil','\x20\x20\x20Merchant\x20loses:\x20','amount','usdcPolygonWallet','turnover','desc','externalPaymentUrl','totalCommissionRate','1570648ljVwtL','paidOutUSDT','publicKey','shop','hash','getGatewayDisplayName','COMPLETED','getMonth','\x27\x20not\x20found.\x20Available\x20gateways:\x20',']\x20Gateway\x20settings\x20before\x20saving:','currency','\x20\x20\x20�📊\x20Total\x20payments:\x20','getAllPayouts','📊\x20Getting\x20merchants\x20awaiting\x20payout\x20with\x20filters:','📋\x20Getting\x20merchants\x20selection\x20list...','Test\x20Gateway','gateway','convertToUSDT','dateTo','pendingPayout','🔄\x20Converted\x20gateway\x20name\x20\x27','Username\x20already\x20exists','\x27\x20->\x20ID\x20\x27','count','customerEmail',']\x20Updating\x20password\x20for\x20user\x20','🔧\x20[','\x20\x20\x20🌐\x20IP:\x20','💰\x20[PAYOUT]\x20Merchant\x20','failureMessage','length','not\x20specified','getMerchantsAwaitingPayout','gatewayOrderId','usdtErcWallet','\x20\x20\x20Current\x20total\x20paid\x20out:\x20','💰\x20Creating\x20payout\x20for\x20shop\x20','KLYME\x20DE','adminNotes','findMany','\x20USDT\x20(with\x20commission\x20deducted)','delete','\x20\x20\x20�\x20Total\x20payments\x20turnover:\x20','\x20in\x20','18LcSjpN','Error\x20parsing\x20gateway\x20settings\x20for\x20payment\x20','%\x20from\x20','periodFrom','getPayoutById','getGatewayInternalName','klyme_de','gatewayEarnings','⚠️\x20Requested\x20gateway\x20\x27','averageCheckUSDT','customerUa','484BCKcUm','random','\x20merchants\x20with\x20positive\x20balance','REFUND','dailyPayments','payout','🔄\x20Gateway\x20mapping:','394361KZIPuu','⚠️\x20Payment\x20','network','CHARGEBACK','\x20USDT','📊\x20Total\x20payments\x20(including\x20failed):\x20','getAllUsers','bcryptjs','13926XGgBbs','totalAmountAfterCommissionUSDT','failUrl','\x20\x20\x20Transaction\x20hash:\x20','month','📊\x20Getting\x20payments\x20with\x20filters:','\x20\x20\x20🏪\x20Gateway\x20earnings:\x20','\x20USDT\x20from\x20balance','./currencyService','paymentsCount','\x20USDT)','\x20active\x20merchants\x20for\x20selection','🔄\x20Gateway\x20mapping\x20(create):','CoinToPay','split','Plisio','\x20\x20\x20Balance:\x20','createUser','\x20\x20\x20🔍\x20Raw\x20balance\x20sum:\x20','mastercard','pk_','noda','merchantEarnings','Open\x20Banking\x202','../types/gateway','Error\x20processing\x20payment\x20','stringify',']\x20Password\x20not\x20provided\x20or\x20empty,\x20skipping\x20password\x20update','📊\x20Getting\x20merchant\x20statistics\x20with\x20filters:',',\x20Commission:\x20','merchantUrl','amountAfterCommissionUSDT','getMerchantStatistics','2020-01-01','0000','customerName','📊\x20Merchant\x20statistics\x20calculated:','\x20\x20\x20✅\x20Total\x20available\x20for\x20payout:\x20','Payment\x20not\x20found','💰\x20Found\x20',']\x20User\x20updated,\x20gatewaySettings\x20from\x20DB:','\x20->\x20','\x27\x20as\x20is\x20(not\x20found\x20in\x20mappings)','shopUrl','customerIp','plisio','totalPaidOut','sort','substr','📊\x20Sorting\x20payments\x20by\x20','\x20\x20\x20Payout\x20amount:\x20','33737zkwOKP','updatedAt','\x20balance\x20updated:','push','\x20\x20\x20📊\x20Commission\x20difference:\x20','🔄\x20Updating\x20customer\x20data\x20for\x20payment\x20','💸\x20CHARGEBACK:\x20Merchant\x20amount\x20already\x20deducted\x20from\x20balance','statusChangedBy','commissionUSDT','usdtPolygonWallet','toISOString','rapyd','week','deletePayout','__importDefault','parse','\x20USDT\x20(total\x20paid\x20to\x20merchants)','\x20USDT\x20(theoretical\x20net)','📅\x20Period:\x20','\x27)\x20not\x20found\x20in\x20database,\x20returning\x20empty\x20result','getAllPayments','📊\x20Merchants\x20awaiting\x20payout:\x20','💰\x20Shop\x20','\x20paid\x20payments\x20for\x20analysis','\x20status:\x20','3967060CRLYLt','update','🔄\x20REFUND:\x20Payment\x20amount\x20already\x20deducted\x20from\x20balance','all','createPayout','\x20\x20\x20Full\x20amount:\x20','Error\x20parsing\x20gateway\x20settings\x20for\x20shop\x20','\x20USDT\x20(gross\x20revenue)','toFixed','error','sk_','balance','pendingUrl','updateCustomerData','\x20balance\x20updated:\x20','🔄\x20Gateway\x20mapping\x20(get):','📊\x20Final\x20WHERE\x20conditions:','findFirst','aggregate','createdAt','\x20\x20\x20🖥️\x20User\x20Agent:\x20','hex','klyme_gb','PENDING','\x27\x20to\x20name\x20\x27','gte','lte','join','MasterCard','payment','findUnique','name','getTime','\x20no\x20longer\x20PAID:','thisMonth','💰\x20[PAYOUT]\x20Gateway\x20','\x20\x20\x20👤\x20Merchant\x20earnings:\x20','📊\x20Using\x20saved\x20amountAfterGatewayCommissionUSDT:\x20','map','telegramId','\x20\x20\x20🔍\x20Calculated\x20after\x20commission:\x20','date','localeCompare','\x20\x20\x20💸\x20Total\x20payouts\x20(all\x20time):\x20','../config/database','includes','\x20\x20\x20💰\x20Total\x20payments\x20turnover:\x20','activateUser','amountUSDT','KLYME\x20EU','📊\x20[ADMIN]\x20Calculating\x20commission\x20manually\x20for\x20payment\x20','\x20order','set','\x20\x20\x20💳\x20Total\x20payments:\x20','\x20USDT\x20(actual\x20balances)','\x20\x20\x20💰\x20Total\x20payout:\x20','create','amountAfterGatewayCommissionUSDT','gatewaySettings','whiteUrl','714pSQBUm','test_gateway','username','\x20\x20\x20📅\x20This\x20month:\x20','groupBy','availableBalance','orderId','\x20\x20\x20Merchant\x20gets:\x20','🔄\x20Admin\x20updating\x20payment\x20','turnoverUSDT','\x20USDT\x20(+','getSystemStatistics','🔄\x20Converted\x20gateway\x20ID\x20\x27','toLowerCase','2UZfLQt','⚠️\x20Gateway\x20\x27','revenue',']\x20Gateway\x20settings\x20JSON\x20string:','password','📊\x20Calculating\x20payout\x20statistics...','insensitive','reduce','getGatewayNameById','\x20\x20\x20Gateway:\x20','not\x20set','cointopay2','toString','KLYME\x20GB','generateDailyStatistics','fullName','values','\x20\x20\x20🌍\x20Country:\x20','totalPayout','totalAmountUSDT'];a36_0x2d00=function(){return _0x34e4e6;};return a36_0x2d00();}const database_1=__importDefault(require(a36_0x30790d(0x254))),bcryptjs_1=__importDefault(require(a36_0x30790d(0x31e))),crypto_1=__importDefault(require('crypto')),currencyService_1=require(a36_0x30790d(0x327)),gateway_1=require(a36_0x30790d(0x1f4));class AdminService{async[a36_0x30790d(0x2bf)](){const _0x4c26b4=a36_0x30790d;console[_0x4c26b4(0x289)](_0x4c26b4(0x277));const _0x2cc326=await database_1[_0x4c26b4(0x2a8)][_0x4c26b4(0x2dc)][_0x4c26b4(0x23a)]({'_sum':{'balance':!![],'totalPaidOut':!![]},'where':{'status':'ACTIVE'}}),_0x1921ef=await this[_0x4c26b4(0x2f9)]({'page':0x1,'limit':0x3e8}),_0x35d512=await database_1[_0x4c26b4(0x2a8)][_0x4c26b4(0x245)][_0x4c26b4(0x2f0)]({'where':{'status':_0x4c26b4(0x293),'gateway':{'not':'test_gateway'}}}),_0x391e09=new Date(),_0x49465a=new Date(_0x391e09[_0x4c26b4(0x2cb)](),_0x391e09[_0x4c26b4(0x2e0)](),0x1),_0x1e899c=new Date(_0x391e09[_0x4c26b4(0x2cb)](),_0x391e09[_0x4c26b4(0x2e0)]()+0x1,0x0,0x17,0x3b,0x3b,0x3e7),_0x13619d=await database_1[_0x4c26b4(0x2a8)]['payout'][_0x4c26b4(0x23a)]({'_sum':{'amount':!![]},'where':{'createdAt':{'gte':_0x49465a,'lte':_0x1e899c},'status':'COMPLETED'}}),_0x2671a0=_0x2cc326['_sum']['totalPaidOut']||0x0,_0x1871d4=_0x1921ef[_0x4c26b4(0x2c2)][_0x4c26b4(0x320)],_0x363573=_0x13619d[_0x4c26b4(0x2c0)][_0x4c26b4(0x2d3)]||0x0,_0x3abb4={'totalPayout':Math[_0x4c26b4(0x29c)](_0x2671a0*0x64)/0x64,'awaitingPayout':Math[_0x4c26b4(0x29c)](_0x1871d4*0x64)/0x64,'thisMonth':Math[_0x4c26b4(0x29c)](_0x363573*0x64)/0x64,'availableBalance':Math[_0x4c26b4(0x29c)](_0x1871d4*0x64)/0x64,'totalPayments':_0x35d512};return console[_0x4c26b4(0x289)]('📊\x20Payout\x20statistics\x20calculated:'),console[_0x4c26b4(0x289)](_0x4c26b4(0x25f)+_0x3abb4['totalPayout']+_0x4c26b4(0x21f)),console[_0x4c26b4(0x289)](_0x4c26b4(0x2b6)+_0x3abb4['awaitingPayout']+_0x4c26b4(0x301)),console['log']('\x20\x20\x20💵\x20Available\x20balance:\x20'+_0x3abb4[_0x4c26b4(0x269)]+'\x20USDT\x20(same\x20as\x20awaiting)'),console[_0x4c26b4(0x289)](_0x4c26b4(0x267)+_0x3abb4[_0x4c26b4(0x24a)]+'\x20USDT'),console['log'](_0x4c26b4(0x25d)+_0x3abb4['totalPayments']+'\x20PAID\x20payments'),console[_0x4c26b4(0x289)](_0x4c26b4(0x331)+(_0x2cc326['_sum'][_0x4c26b4(0x233)]||0x0)[_0x4c26b4(0x230)](0x2)+_0x4c26b4(0x2be)),console['log'](_0x4c26b4(0x213)+((_0x2cc326[_0x4c26b4(0x2c0)][_0x4c26b4(0x233)]||0x0)-_0x1871d4)['toFixed'](0x2)+_0x4c26b4(0x31b)),_0x3abb4;}async[a36_0x30790d(0x235)](_0x4f168f,_0x193b87){const _0x18e1b2=a36_0x30790d;console[_0x18e1b2(0x289)](_0x18e1b2(0x214)+_0x4f168f+':',_0x193b87);const _0x52ea58=await database_1[_0x18e1b2(0x2a8)][_0x18e1b2(0x245)]['findUnique']({'where':{'id':_0x4f168f},'select':{'id':!![],'customerEmail':!![],'customerName':!![],'customerCountry':!![],'customerIp':!![],'customerUa':!![]}});if(!_0x52ea58)throw new Error(_0x18e1b2(0x202));const _0x4a95da={};_0x193b87[_0x18e1b2(0x291)]!==undefined&&(_0x4a95da[_0x18e1b2(0x291)]=_0x193b87[_0x18e1b2(0x291)]||null);_0x193b87['customerIp']!==undefined&&(_0x4a95da[_0x18e1b2(0x208)]=_0x193b87[_0x18e1b2(0x208)]||null);_0x193b87[_0x18e1b2(0x30f)]!==undefined&&(_0x4a95da[_0x18e1b2(0x30f)]=_0x193b87[_0x18e1b2(0x30f)]||null);const _0x519965=await database_1[_0x18e1b2(0x2a8)][_0x18e1b2(0x245)][_0x18e1b2(0x229)]({'where':{'id':_0x4f168f},'data':{..._0x4a95da,'updatedAt':new Date()},'select':{'id':!![],'customerEmail':!![],'customerName':!![],'customerCountry':!![],'customerIp':!![],'customerUa':!![],'updatedAt':!![]}});return console[_0x18e1b2(0x289)](_0x18e1b2(0x2a6)+_0x4f168f),console[_0x18e1b2(0x289)](_0x18e1b2(0x283)+_0x52ea58['customerCountry']+_0x18e1b2(0x205)+_0x519965[_0x18e1b2(0x291)]),console['log'](_0x18e1b2(0x2f4)+_0x52ea58[_0x18e1b2(0x208)]+_0x18e1b2(0x205)+_0x519965['customerIp']),console[_0x18e1b2(0x289)](_0x18e1b2(0x23c)+(_0x52ea58[_0x18e1b2(0x30f)]?'set':_0x18e1b2(0x27c))+_0x18e1b2(0x205)+(_0x519965['customerUa']?_0x18e1b2(0x25c):_0x18e1b2(0x27c))),_0x519965;}async[a36_0x30790d(0x26f)](_0x519b5e){const _0x10d856=a36_0x30790d,_0x1be565=new Date();let _0x5d549f;switch(_0x519b5e){case'7d':_0x5d549f=new Date(_0x1be565[_0x10d856(0x248)]()-0x7*0x18*0x3c*0x3c*0x3e8);break;case _0x10d856(0x292):_0x5d549f=new Date(_0x1be565[_0x10d856(0x248)]()-0x1e*0x18*0x3c*0x3c*0x3e8);break;case'90d':_0x5d549f=new Date(_0x1be565[_0x10d856(0x248)]()-0x5a*0x18*0x3c*0x3c*0x3e8);break;case _0x10d856(0x22b):const _0x28d73d=await database_1[_0x10d856(0x2a8)][_0x10d856(0x245)][_0x10d856(0x239)]({'where':{'gateway':{'not':_0x10d856(0x265)}},'orderBy':{'createdAt':_0x10d856(0x2ae)},'select':{'createdAt':!![]}});_0x5d549f=_0x28d73d?_0x28d73d[_0x10d856(0x23b)]:new Date('2020-01-01'),console['log'](_0x10d856(0x2a0)+_0x5d549f[_0x10d856(0x219)]());break;default:_0x5d549f=new Date(_0x1be565[_0x10d856(0x248)]()-0x1e*0x18*0x3c*0x3c*0x3e8);}const [_0x47bc51,_0x181bee,_0x20fd88,_0x5017e7,_0x289b0f,_0xc17d8b]=await Promise[_0x10d856(0x22b)]([database_1[_0x10d856(0x2a8)][_0x10d856(0x2dc)][_0x10d856(0x2f0)](),database_1[_0x10d856(0x2a8)]['shop'][_0x10d856(0x2f0)]({'where':{'status':'ACTIVE'}}),database_1[_0x10d856(0x2a8)][_0x10d856(0x245)][_0x10d856(0x2f0)]({'where':{'status':_0x10d856(0x293),'createdAt':{'gte':_0x5d549f},'gateway':{'not':_0x10d856(0x265)}}}),database_1[_0x10d856(0x2a8)]['payment'][_0x10d856(0x300)]({'where':{'status':_0x10d856(0x293),'createdAt':{'gte':_0x5d549f},'gateway':{'not':_0x10d856(0x265)}},'select':{'amount':!![],'currency':!![],'amountAfterGatewayCommissionUSDT':!![]}}),database_1[_0x10d856(0x2a8)][_0x10d856(0x245)][_0x10d856(0x300)]({'where':{'gateway':{'not':_0x10d856(0x265)}},'take':0xa,'orderBy':{'createdAt':'desc'},'include':{'shop':{'select':{'name':!![],'username':!![]}}}}),database_1['default'][_0x10d856(0x245)][_0x10d856(0x300)]({'where':{'createdAt':{'gte':_0x5d549f},'gateway':{'not':_0x10d856(0x265)}},'select':{'amount':!![],'currency':!![],'status':!![],'amountUSDT':!![],'createdAt':!![]}})]);let _0x1d5287=0x0,_0x45c991=0x0;for(const _0x268397 of _0x5017e7){const _0xc6890a=await currencyService_1[_0x10d856(0x2ca)][_0x10d856(0x2ea)](_0x268397['amount'],_0x268397[_0x10d856(0x2e3)]);_0x1d5287+=_0xc6890a;if(_0x268397['amountAfterGatewayCommissionUSDT']){const _0x3c2a5a=await currencyService_1[_0x10d856(0x2ca)][_0x10d856(0x2ea)](_0x268397[_0x10d856(0x2d3)],_0x268397[_0x10d856(0x2e3)]),_0x2d291c=_0x268397[_0x10d856(0x261)],_0x3169bf=_0x3c2a5a-_0x2d291c;_0x45c991+=_0x3169bf;}}const _0x7e244e=_0x20fd88>0x0?_0x1d5287/_0x20fd88:0x0,_0x524dfb=this[_0x10d856(0x280)](_0xc17d8b,_0x5d549f,_0x1be565),_0x42c06=await database_1['default'][_0x10d856(0x245)][_0x10d856(0x2f0)]({'where':{'createdAt':{'gte':_0x5d549f},'gateway':{'not':'test_gateway'}}}),_0x13c03f=_0x42c06>0x0?_0x20fd88/_0x42c06*0x64:0x0;return{'totalShops':_0x47bc51,'activeShops':_0x181bee,'totalPayments':_0x20fd88,'successfulPayments':_0x20fd88,'totalAttempts':_0x42c06,'totalRevenue':Math[_0x10d856(0x29c)](_0x1d5287*0x64)/0x64,'trapayEarnings':Math[_0x10d856(0x29c)](_0x45c991*0x64)/0x64,'averagePaymentAmount':Math[_0x10d856(0x29c)](_0x7e244e*0x64)/0x64,'conversionRate':Math['round'](_0x13c03f*0x64)/0x64,'dailyRevenue':_0x524dfb['dailyRevenue'],'dailyPayments':_0x524dfb[_0x10d856(0x314)],'recentPayments':_0x289b0f[_0x10d856(0x24e)](_0xdb321d=>({'id':_0xdb321d['id'],'amount':_0xdb321d[_0x10d856(0x2d3)],'currency':_0xdb321d[_0x10d856(0x2e3)],'status':_0xdb321d['status'],'gateway':_0xdb321d[_0x10d856(0x2e9)],'shop':_0xdb321d['shop'],'createdAt':_0xdb321d[_0x10d856(0x23b)]}))};}async[a36_0x30790d(0x1fc)](_0x3e7423){const _0x35975f=a36_0x30790d;console[_0x35975f(0x289)](_0x35975f(0x1f8),_0x3e7423);let _0x460d21,_0x53cfe1=new Date();if(_0x3e7423['period']==='custom'&&_0x3e7423[_0x35975f(0x2b8)]&&_0x3e7423['dateTo'])_0x460d21=new Date(_0x3e7423['dateFrom']),_0x53cfe1=new Date(_0x3e7423[_0x35975f(0x2eb)]);else{const _0x4c4437=new Date();switch(_0x3e7423[_0x35975f(0x2b5)]){case _0x35975f(0x21b):_0x460d21=new Date(_0x4c4437[_0x35975f(0x248)]()-0x7*0x18*0x3c*0x3c*0x3e8);break;case _0x35975f(0x323):_0x460d21=new Date(_0x4c4437[_0x35975f(0x248)]()-0x1e*0x18*0x3c*0x3c*0x3e8);break;case'year':_0x460d21=new Date(_0x4c4437[_0x35975f(0x248)]()-0x16d*0x18*0x3c*0x3c*0x3e8);break;case _0x35975f(0x22b):default:_0x460d21=new Date(_0x35975f(0x1fd));break;}}console[_0x35975f(0x289)](_0x35975f(0x221)+_0x460d21[_0x35975f(0x219)]()+_0x35975f(0x299)+_0x53cfe1[_0x35975f(0x219)]());const _0x3f815a={'status':_0x35975f(0x293),'gateway':{'not':_0x35975f(0x265)},'paidAt':{'gte':_0x460d21,'lte':_0x53cfe1}};_0x3e7423['shopId']&&(_0x3f815a[_0x35975f(0x28d)]=_0x3e7423[_0x35975f(0x28d)]);const _0x4ded6e=await database_1[_0x35975f(0x2a8)][_0x35975f(0x245)][_0x35975f(0x300)]({'where':_0x3f815a,'include':{'shop':{'select':{'id':!![],'name':!![],'username':!![],'gatewaySettings':!![]}}}});console[_0x35975f(0x289)]('💰\x20Found\x20'+_0x4ded6e['length']+_0x35975f(0x226));const _0x424e71={'gateway':{'not':_0x35975f(0x265)},'createdAt':{'gte':_0x460d21,'lte':_0x53cfe1}};_0x3e7423['shopId']&&(_0x424e71[_0x35975f(0x28d)]=_0x3e7423[_0x35975f(0x28d)]);const _0x28e54f=await database_1[_0x35975f(0x2a8)][_0x35975f(0x245)][_0x35975f(0x2f0)]({'where':_0x424e71});console[_0x35975f(0x289)](_0x35975f(0x31c)+_0x28e54f+_0x35975f(0x2ad)+_0x4ded6e[_0x35975f(0x2f7)]);let _0x4ee482=0x0,_0x19a065=0x0,_0x9b04cc=0x0;const _0x311879={},_0x1dacfc={},_0x1ee1c1={};for(const _0x568401 of _0x4ded6e){try{const _0x2e8be2=await currencyService_1[_0x35975f(0x2ca)]['convertToUSDT'](_0x568401[_0x35975f(0x2d3)],_0x568401[_0x35975f(0x2e3)]);let _0x41bf2f={};if(_0x568401[_0x35975f(0x2dc)][_0x35975f(0x262)])try{_0x41bf2f=JSON[_0x35975f(0x21e)](_0x568401[_0x35975f(0x2dc)][_0x35975f(0x262)]);}catch(_0x43129f){console[_0x35975f(0x231)]('Error\x20parsing\x20gateway\x20settings\x20for\x20shop\x20'+_0x568401[_0x35975f(0x28d)]+':',_0x43129f);}let _0x1d748e={},_0x50f09a=0xa;for(const [_0x37b4a6,_0x2bb3c3]of Object[_0x35975f(0x2c1)](_0x41bf2f)){if(_0x37b4a6[_0x35975f(0x271)]()===_0x568401[_0x35975f(0x2e9)][_0x35975f(0x271)]()){_0x1d748e=_0x2bb3c3,_0x50f09a=_0x2bb3c3['commission']||0xa;break;}}let _0x1aef1c,_0x3c70b5;_0x568401[_0x35975f(0x261)]!==null&&_0x568401['amountAfterGatewayCommissionUSDT']!==undefined?(_0x1aef1c=_0x568401[_0x35975f(0x261)],_0x3c70b5=_0x2e8be2-_0x1aef1c,console[_0x35975f(0x289)](_0x35975f(0x24d)+_0x1aef1c[_0x35975f(0x230)](0x6)+_0x35975f(0x2bb)+_0x568401['id'])):(_0x3c70b5=_0x2e8be2*(_0x50f09a/0x64),_0x1aef1c=_0x2e8be2-_0x3c70b5,console['log']('📊\x20Calculating\x20commission\x20manually\x20for\x20payment\x20'+_0x568401['id']+':\x20'+_0x50f09a+_0x35975f(0x307)+_0x2e8be2[_0x35975f(0x230)](0x6)+_0x35975f(0x31b)));_0x4ee482+=_0x2e8be2,_0x19a065+=_0x1aef1c,_0x9b04cc+=_0x3c70b5;!_0x311879[_0x568401[_0x35975f(0x2e9)]]&&(_0x311879[_0x568401[_0x35975f(0x2e9)]]={'gateway':_0x568401[_0x35975f(0x2e9)],'gatewayDisplayName':this[_0x35975f(0x2de)](_0x568401[_0x35975f(0x2e9)]),'paymentsCount':0x0,'turnoverUSDT':0x0,'commissionUSDT':0x0,'merchantEarningsUSDT':0x0,'totalCommissionRate':0x0});_0x311879[_0x568401['gateway']][_0x35975f(0x328)]++,_0x311879[_0x568401[_0x35975f(0x2e9)]][_0x35975f(0x26d)]+=_0x2e8be2,_0x311879[_0x568401['gateway']][_0x35975f(0x217)]+=_0x3c70b5,_0x311879[_0x568401[_0x35975f(0x2e9)]][_0x35975f(0x287)]+=_0x1aef1c,_0x311879[_0x568401[_0x35975f(0x2e9)]][_0x35975f(0x2d8)]+=_0x50f09a;!_0x3e7423['shopId']&&(!_0x1dacfc[_0x568401[_0x35975f(0x28d)]]&&(_0x1dacfc[_0x568401[_0x35975f(0x28d)]]={'shopId':_0x568401[_0x35975f(0x28d)],'shopName':_0x568401[_0x35975f(0x2dc)][_0x35975f(0x247)],'shopUsername':_0x568401['shop']['username'],'paymentsCount':0x0,'turnoverUSDT':0x0,'commissionUSDT':0x0,'merchantEarningsUSDT':0x0,'paidOutUSDT':0x0,'averageCheckUSDT':0x0}),_0x1dacfc[_0x568401[_0x35975f(0x28d)]]['paymentsCount']++,_0x1dacfc[_0x568401[_0x35975f(0x28d)]][_0x35975f(0x26d)]+=_0x2e8be2,_0x1dacfc[_0x568401[_0x35975f(0x28d)]]['commissionUSDT']+=_0x3c70b5,_0x1dacfc[_0x568401[_0x35975f(0x28d)]][_0x35975f(0x287)]+=_0x1aef1c);const _0x2b5a0e=_0x568401[_0x35975f(0x2a2)][_0x35975f(0x219)]()[_0x35975f(0x32d)]('T')[0x0];!_0x1ee1c1[_0x2b5a0e]&&(_0x1ee1c1[_0x2b5a0e]={'date':_0x2b5a0e,'turnover':0x0,'merchantEarnings':0x0,'gatewayEarnings':0x0,'paymentsCount':0x0}),_0x1ee1c1[_0x2b5a0e][_0x35975f(0x2d5)]+=_0x2e8be2,_0x1ee1c1[_0x2b5a0e][_0x35975f(0x1f2)]+=_0x1aef1c,_0x1ee1c1[_0x2b5a0e][_0x35975f(0x30c)]+=_0x3c70b5,_0x1ee1c1[_0x2b5a0e][_0x35975f(0x328)]++;}catch(_0x2fe46e){console[_0x35975f(0x231)](_0x35975f(0x1f5)+_0x568401['id']+':',_0x2fe46e);}}Object[_0x35975f(0x282)](_0x311879)['forEach'](_0x25a3c7=>{const _0x4fdd85=_0x35975f;_0x25a3c7[_0x4fdd85(0x2b7)]=_0x25a3c7['paymentsCount']>0x0?_0x25a3c7[_0x4fdd85(0x2d8)]/_0x25a3c7[_0x4fdd85(0x328)]:0x0,delete _0x25a3c7[_0x4fdd85(0x2d8)];}),Object[_0x35975f(0x282)](_0x1dacfc)[_0x35975f(0x2b3)](_0x276e60=>{const _0x14e647=_0x35975f;_0x276e60[_0x14e647(0x30e)]=_0x276e60[_0x14e647(0x328)]>0x0?_0x276e60[_0x14e647(0x26d)]/_0x276e60['paymentsCount']:0x0;});let _0x21a6cd=0x0,_0x577125=0x0;if(_0x3e7423[_0x35975f(0x28d)]){const _0x386e7f=await database_1[_0x35975f(0x2a8)][_0x35975f(0x315)]['findMany']({'where':{'shopId':_0x3e7423[_0x35975f(0x28d)],'status':_0x35975f(0x2df),'createdAt':{'gte':_0x460d21,'lte':_0x53cfe1}},'select':{'amount':!![]}});_0x21a6cd=_0x386e7f['reduce']((_0xb4b711,_0x298c98)=>_0xb4b711+_0x298c98[_0x35975f(0x2d3)],0x0);const _0x5adc8a=await database_1['default'][_0x35975f(0x315)]['findMany']({'where':{'shopId':_0x3e7423[_0x35975f(0x28d)],'status':_0x35975f(0x23f),'createdAt':{'gte':_0x460d21,'lte':_0x53cfe1}},'select':{'amount':!![]}});_0x577125=_0x5adc8a['reduce']((_0xda5b91,_0x4d563d)=>_0xda5b91+_0x4d563d[_0x35975f(0x2d3)],0x0);}const _0x42beb2=_0x28e54f,_0x272907=_0x4ded6e[_0x35975f(0x2f7)],_0x4e36bf=_0x272907>0x0?_0x4ee482/_0x272907:0x0,_0x50ff66=_0x42beb2>0x0?Math[_0x35975f(0x29c)](_0x272907/_0x42beb2*0x2710)/0x64:0x0,_0x39d7ad=Math[_0x35975f(0x2d1)]((_0x53cfe1['getTime']()-_0x460d21[_0x35975f(0x248)]())/(0x3e8*0x3c*0x3c*0x18)),_0xbbccce={'totalTurnover':Math[_0x35975f(0x29c)](_0x4ee482*0x64)/0x64,'merchantEarnings':Math[_0x35975f(0x29c)](_0x19a065*0x64)/0x64,'gatewayEarnings':Math[_0x35975f(0x29c)](_0x9b04cc*0x64)/0x64,'totalPaidOut':Math[_0x35975f(0x29c)](_0x21a6cd*0x64)/0x64,'pendingPayout':Math[_0x35975f(0x29c)](_0x577125*0x64)/0x64,'averageCheck':Math[_0x35975f(0x29c)](_0x4e36bf*0x64)/0x64,'totalPayments':_0x42beb2,'successfulPayments':_0x272907,'conversionRate':_0x50ff66,'gatewayBreakdown':Object[_0x35975f(0x282)](_0x311879)[_0x35975f(0x24e)](_0x2e1e3f=>({..._0x2e1e3f,'turnoverUSDT':Math[_0x35975f(0x29c)](_0x2e1e3f[_0x35975f(0x26d)]*0x64)/0x64,'commissionUSDT':Math[_0x35975f(0x29c)](_0x2e1e3f['commissionUSDT']*0x64)/0x64,'merchantEarningsUSDT':Math['round'](_0x2e1e3f[_0x35975f(0x287)]*0x64)/0x64,'averageCommissionRate':Math[_0x35975f(0x29c)](_0x2e1e3f[_0x35975f(0x2b7)]*0x64)/0x64})),'merchantBreakdown':_0x3e7423[_0x35975f(0x28d)]?undefined:Object[_0x35975f(0x282)](_0x1dacfc)['map'](_0x287798=>({..._0x287798,'turnoverUSDT':Math['round'](_0x287798[_0x35975f(0x26d)]*0x64)/0x64,'commissionUSDT':Math[_0x35975f(0x29c)](_0x287798[_0x35975f(0x217)]*0x64)/0x64,'merchantEarningsUSDT':Math[_0x35975f(0x29c)](_0x287798[_0x35975f(0x287)]*0x64)/0x64,'paidOutUSDT':Math[_0x35975f(0x29c)](_0x287798[_0x35975f(0x2da)]*0x64)/0x64,'averageCheckUSDT':Math[_0x35975f(0x29c)](_0x287798[_0x35975f(0x30e)]*0x64)/0x64})),'dailyData':Object[_0x35975f(0x282)](_0x1ee1c1)['map'](_0x215f95=>({..._0x215f95,'turnover':Math[_0x35975f(0x29c)](_0x215f95[_0x35975f(0x2d5)]*0x64)/0x64,'merchantEarnings':Math[_0x35975f(0x29c)](_0x215f95[_0x35975f(0x1f2)]*0x64)/0x64,'gatewayEarnings':Math[_0x35975f(0x29c)](_0x215f95['gatewayEarnings']*0x64)/0x64}))[_0x35975f(0x20b)]((_0x460a60,_0x29a169)=>_0x460a60[_0x35975f(0x251)][_0x35975f(0x252)](_0x29a169['date'])),'periodInfo':{'from':_0x460d21,'to':_0x53cfe1,'periodType':_0x3e7423['period']||'custom','daysCount':_0x39d7ad}};return console['log'](_0x35975f(0x200)),console['log']('\x20\x20\x20💰\x20Total\x20turnover:\x20'+_0xbbccce['totalTurnover']+_0x35975f(0x31b)),console[_0x35975f(0x289)](_0x35975f(0x24c)+_0xbbccce[_0x35975f(0x1f2)]+'\x20USDT'),console[_0x35975f(0x289)](_0x35975f(0x325)+_0xbbccce['gatewayEarnings']+_0x35975f(0x31b)),console[_0x35975f(0x289)]('\x20\x20\x20�\x20Total\x20paid\x20out:\x20'+_0xbbccce['totalPaidOut']+'\x20USDT'),console[_0x35975f(0x289)](_0x35975f(0x28f)+_0xbbccce[_0x35975f(0x2ec)]+_0x35975f(0x31b)),console['log'](_0x35975f(0x2e4)+_0xbbccce[_0x35975f(0x2a9)]),_0xbbccce;}async['getMerchantsSelection'](){const _0x29ec9b=a36_0x30790d;console[_0x29ec9b(0x289)](_0x29ec9b(0x2e7));const _0x4285ae=await database_1[_0x29ec9b(0x2a8)]['shop'][_0x29ec9b(0x300)]({'where':{'status':_0x29ec9b(0x2cf)},'select':{'id':!![],'username':!![],'name':!![]},'orderBy':{'name':_0x29ec9b(0x2ae)}});return console['log']('📋\x20Found\x20'+_0x4285ae['length']+_0x29ec9b(0x32a)),_0x4285ae[_0x29ec9b(0x24e)](_0x691e5f=>({'id':_0x691e5f['id'],'username':_0x691e5f[_0x29ec9b(0x266)],'name':_0x691e5f[_0x29ec9b(0x247)]}));}[a36_0x30790d(0x2de)](_0x53bed9){const _0x4d48b7=a36_0x30790d,_0x55c457={'test_gateway':_0x4d48b7(0x2e8),'plisio':_0x4d48b7(0x32e),'rapyd':_0x4d48b7(0x2cd),'noda':_0x4d48b7(0x2c6),'cointopay':_0x4d48b7(0x32c),'cointopay2':_0x4d48b7(0x1f3),'klyme_eu':_0x4d48b7(0x259),'klyme_gb':_0x4d48b7(0x27f),'klyme_de':_0x4d48b7(0x2fe),'mastercard':_0x4d48b7(0x244)};return _0x55c457[_0x53bed9]||_0x53bed9;}[a36_0x30790d(0x30a)](_0x4f9f3e){const _0x17e5d4=a36_0x30790d,_0x4dcaf2={'Test\x20Gateway':_0x17e5d4(0x265),'Plisio':_0x17e5d4(0x209),'Rapyd':_0x17e5d4(0x21a),'Noda':_0x17e5d4(0x1f1),'CoinToPay':'cointopay','CoinToPay2':_0x17e5d4(0x27d),'KLYME\x20EU':'klyme_eu','KLYME\x20GB':_0x17e5d4(0x23e),'KLYME\x20DE':_0x17e5d4(0x30b),'MasterCard':_0x17e5d4(0x1ef)};return _0x4dcaf2[_0x4f9f3e]||_0x4f9f3e[_0x17e5d4(0x271)]();}async[a36_0x30790d(0x2f9)](_0x2d9516){const _0xb32aaf=a36_0x30790d,{page:_0x408454,limit:_0xd27059,minAmount:_0x124492,search:_0x3d91c0}=_0x2d9516,_0x4e1330=(_0x408454-0x1)*_0xd27059;console['log'](_0xb32aaf(0x2e6),_0x2d9516);const _0x9621dd={'balance':{'gt':0x0},'status':'ACTIVE'};_0x124492&&(_0x9621dd['balance']['gte']=_0x124492);_0x3d91c0&&(_0x9621dd['OR']=[{'name':{'contains':_0x3d91c0,'mode':'insensitive'}},{'username':{'contains':_0x3d91c0,'mode':'insensitive'}}]);const [_0x4db969,_0x2052f2]=await Promise['all']([database_1[_0xb32aaf(0x2a8)][_0xb32aaf(0x2dc)][_0xb32aaf(0x300)]({'where':_0x9621dd,'skip':_0x4e1330,'take':_0xd27059,'orderBy':{'balance':_0xb32aaf(0x2d6)},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'balance':!![],'totalPaidOut':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'gatewaySettings':!![],'createdAt':!![]}}),database_1[_0xb32aaf(0x2a8)]['shop'][_0xb32aaf(0x2f0)]({'where':_0x9621dd})]);console[_0xb32aaf(0x289)](_0xb32aaf(0x203)+_0x4db969[_0xb32aaf(0x2f7)]+_0xb32aaf(0x312));const _0x570f5b=await Promise[_0xb32aaf(0x22b)](_0x4db969[_0xb32aaf(0x24e)](async _0x556aef=>{const _0x3916ce=_0xb32aaf,[_0x415cba,_0x1f6053,_0x512827]=await Promise[_0x3916ce(0x22b)]([database_1[_0x3916ce(0x2a8)][_0x3916ce(0x245)]['count']({'where':{'shopId':_0x556aef['id'],'status':_0x3916ce(0x293),'gateway':{'not':_0x3916ce(0x265)}}}),database_1[_0x3916ce(0x2a8)][_0x3916ce(0x245)][_0x3916ce(0x239)]({'where':{'shopId':_0x556aef['id'],'status':'PAID','gateway':{'not':_0x3916ce(0x265)}},'orderBy':{'paidAt':_0x3916ce(0x2ae)},'select':{'paidAt':!![]}}),database_1[_0x3916ce(0x2a8)]['payment'][_0x3916ce(0x268)]({'by':[_0x3916ce(0x2e9)],'where':{'shopId':_0x556aef['id'],'status':'PAID','gateway':{'not':'test_gateway'}},'_count':{'id':!![]},'_sum':{'amountUSDT':!![]}})]),_0xf8178b=new Date(),_0x3afdc8=new Date(_0xf8178b['getFullYear'](),_0xf8178b['getMonth'](),0x1),_0x3424ff=new Date(_0xf8178b[_0x3916ce(0x2cb)](),_0xf8178b['getMonth']()+0x1,0x0,0x17,0x3b,0x3b,0x3e7),[_0x281707,_0x2b2552]=await Promise[_0x3916ce(0x22b)]([database_1['default']['payout'][_0x3916ce(0x23a)]({'_sum':{'amount':!![]},'where':{'shopId':_0x556aef['id'],'status':_0x3916ce(0x2df)}}),database_1['default'][_0x3916ce(0x315)][_0x3916ce(0x23a)]({'_sum':{'amount':!![]},'where':{'shopId':_0x556aef['id'],'status':_0x3916ce(0x2df),'createdAt':{'gte':_0x3afdc8,'lte':_0x3424ff}}})]),_0x19a6bc=_0x281707[_0x3916ce(0x2c0)][_0x3916ce(0x2d3)]||0x0,_0x45f9c8=_0x2b2552[_0x3916ce(0x2c0)][_0x3916ce(0x2d3)]||0x0,_0x508762=await Promise[_0x3916ce(0x22b)](_0x512827[_0x3916ce(0x24e)](async _0xa1e658=>{const _0x23e1dd=_0x3916ce;let _0x4b8be5=0xa;if(_0x556aef[_0x23e1dd(0x262)])try{const _0x5156aa=JSON['parse'](_0x556aef[_0x23e1dd(0x262)]);for(const [_0x41fba4,_0x4bddb3]of Object['entries'](_0x5156aa)){if(_0x41fba4[_0x23e1dd(0x271)]()===_0xa1e658['gateway'][_0x23e1dd(0x271)]()){_0x4b8be5=_0x4bddb3[_0x23e1dd(0x2d0)]||0xa,console[_0x23e1dd(0x289)](_0x23e1dd(0x24b)+_0xa1e658[_0x23e1dd(0x2e9)]+'\x20for\x20shop\x20'+_0x556aef['id']+_0x23e1dd(0x2ac)+_0x4b8be5+'%');break;}}}catch(_0x1e89d4){console['error'](_0x23e1dd(0x22e)+_0x556aef['id']+':',_0x1e89d4);}const _0x4a7200=_0xa1e658['_sum']?.[_0x23e1dd(0x258)]||0x0,_0x3e9a72=_0x4a7200*(0x1-_0x4b8be5/0x64);return{'gateway':_0xa1e658[_0x23e1dd(0x2e9)],'count':_0xa1e658[_0x23e1dd(0x2b2)]?.['id']||0x0,'amountUSDT':Math[_0x23e1dd(0x29c)](_0x4a7200*0x64)/0x64,'amountAfterCommissionUSDT':Math['round'](_0x3e9a72*0x64)/0x64,'commission':_0x4b8be5};})),_0x52a720=_0x508762['reduce']((_0x60505c,_0x3c4769)=>_0x60505c+_0x3c4769[_0x3916ce(0x258)],0x0),_0x3d216d=_0x556aef[_0x3916ce(0x233)];return console['log'](_0x3916ce(0x2f5)+_0x556aef[_0x3916ce(0x266)]+':'),console[_0x3916ce(0x289)](_0x3916ce(0x303)+_0x52a720[_0x3916ce(0x230)](0x2)+_0x3916ce(0x22f)),console[_0x3916ce(0x289)](_0x3916ce(0x250)+_0x508762[_0x3916ce(0x279)]((_0x18f586,_0x5c3f7b)=>_0x18f586+_0x5c3f7b[_0x3916ce(0x1fb)],0x0)[_0x3916ce(0x230)](0x2)+_0x3916ce(0x220)),console['log']('\x20\x20\x20✅\x20Actual\x20available\x20balance:\x20'+_0x3d216d[_0x3916ce(0x230)](0x2)+'\x20USDT\x20(after\x20payouts)'),{'id':_0x556aef['id'],'fullName':_0x556aef[_0x3916ce(0x247)],'username':_0x556aef[_0x3916ce(0x266)],'telegramId':_0x556aef[_0x3916ce(0x29e)],'merchantUrl':_0x556aef[_0x3916ce(0x207)],'wallets':{'usdtPolygonWallet':_0x556aef['usdtPolygonWallet'],'usdtTrcWallet':_0x556aef['usdtTrcWallet'],'usdtErcWallet':_0x556aef[_0x3916ce(0x2fb)],'usdcPolygonWallet':_0x556aef['usdcPolygonWallet']},'totalAmountUSDT':Math['round'](_0x52a720*0x64)/0x64,'totalAmountAfterCommissionUSDT':Math[_0x3916ce(0x29c)](_0x3d216d*0x64)/0x64,'totalPayout':Math[_0x3916ce(0x29c)](_0x19a6bc*0x64)/0x64,'thisMonth':Math[_0x3916ce(0x29c)](_0x45f9c8*0x64)/0x64,'paymentsCount':_0x415cba,'oldestPaymentDate':_0x1f6053?.[_0x3916ce(0x2a2)]||_0x556aef['createdAt'],'gatewayBreakdown':_0x508762};})),_0x562efd=_0x570f5b[_0xb32aaf(0x279)]((_0x1f29b5,_0x2becb2)=>_0x1f29b5+_0x2becb2[_0xb32aaf(0x285)],0x0),_0x29f906=_0x570f5b['reduce']((_0x53a634,_0x5711f6)=>_0x53a634+_0x5711f6[_0xb32aaf(0x320)],0x0),_0x318664=_0x570f5b['reduce']((_0x1f1326,_0xb2ab2d)=>_0x1f1326+_0xb2ab2d[_0xb32aaf(0x284)],0x0),_0x2d7e75=_0x570f5b['reduce']((_0x20623e,_0x473db9)=>_0x20623e+_0x473db9[_0xb32aaf(0x24a)],0x0);return console[_0xb32aaf(0x289)](_0xb32aaf(0x224)+_0x2052f2+_0xb32aaf(0x2c7)),console[_0xb32aaf(0x289)](_0xb32aaf(0x256)+Math['round'](_0x562efd*0x64)/0x64+'\x20USDT\x20(gross\x20revenue)'),console['log'](_0xb32aaf(0x201)+Math[_0xb32aaf(0x29c)](_0x29f906*0x64)/0x64+_0xb32aaf(0x25e)),console[_0xb32aaf(0x289)](_0xb32aaf(0x253)+Math[_0xb32aaf(0x29c)](_0x318664*0x64)/0x64+_0xb32aaf(0x31b)),console[_0xb32aaf(0x289)]('\x20\x20\x20📅\x20Total\x20payouts\x20(this\x20month):\x20'+Math[_0xb32aaf(0x29c)](_0x2d7e75*0x64)/0x64+_0xb32aaf(0x31b)),{'merchants':_0x570f5b,'pagination':{'page':_0x408454,'limit':_0xd27059,'total':_0x2052f2,'totalPages':Math['ceil'](_0x2052f2/_0xd27059)},'summary':{'totalMerchants':_0x2052f2,'totalAmountUSDT':Math[_0xb32aaf(0x29c)](_0x562efd*0x64)/0x64,'totalAmountAfterCommissionUSDT':Math[_0xb32aaf(0x29c)](_0x29f906*0x64)/0x64,'totalPayout':Math['round'](_0x318664*0x64)/0x64,'thisMonth':Math[_0xb32aaf(0x29c)](_0x2d7e75*0x64)/0x64}};}async[a36_0x30790d(0x22c)](_0x4aba27){const _0x2f0b2d=a36_0x30790d,{shopId:_0x24e196,amount:_0x551f2c,network:_0x4be5e9,wallet:_0x41a62c,notes:_0x11978d,txid:_0x5413ef,periodFrom:_0x3cadab,periodTo:_0x11befd}=_0x4aba27,_0x36bd3a=await database_1[_0x2f0b2d(0x2a8)]['$transaction'](async _0x5ce7fc=>{const _0x2a955c=_0x2f0b2d,_0x5bce12=await _0x5ce7fc['shop'][_0x2a955c(0x246)]({'where':{'id':_0x24e196},'select':{'id':!![],'name':!![],'username':!![],'balance':!![],'totalPaidOut':!![]}});if(!_0x5bce12)throw new Error(_0x2a955c(0x29d));console[_0x2a955c(0x289)](_0x2a955c(0x2fd)+_0x5bce12[_0x2a955c(0x266)]+':'),console[_0x2a955c(0x289)](_0x2a955c(0x2a7)+_0x5bce12['balance']['toFixed'](0x6)+_0x2a955c(0x31b)),console[_0x2a955c(0x289)](_0x2a955c(0x20e)+_0x551f2c[_0x2a955c(0x230)](0x6)+_0x2a955c(0x31b)),console[_0x2a955c(0x289)](_0x2a955c(0x2fc)+_0x5bce12[_0x2a955c(0x20a)][_0x2a955c(0x230)](0x6)+_0x2a955c(0x31b));if(_0x5413ef)console['log'](_0x2a955c(0x322)+_0x5413ef);if(_0x5bce12[_0x2a955c(0x233)]<_0x551f2c)throw new Error(_0x2a955c(0x2af)+_0x5bce12[_0x2a955c(0x233)]['toFixed'](0x6)+'\x20USDT,\x20Requested:\x20'+_0x551f2c[_0x2a955c(0x230)](0x6)+_0x2a955c(0x31b));let _0x35e055=_0x41a62c;if(!_0x35e055){const _0x3b9dd6=await _0x5ce7fc[_0x2a955c(0x2dc)][_0x2a955c(0x246)]({'where':{'id':_0x24e196},'select':{'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![]}});if(_0x3b9dd6)switch(_0x4be5e9){case _0x2a955c(0x29b):_0x35e055=_0x3b9dd6[_0x2a955c(0x218)]||undefined;break;case _0x2a955c(0x295):_0x35e055=_0x3b9dd6[_0x2a955c(0x28e)]||undefined;break;case _0x2a955c(0x2ab):_0x35e055=_0x3b9dd6['usdtErcWallet']||undefined;break;case'polygon_usdc':_0x35e055=_0x3b9dd6[_0x2a955c(0x2d4)]||undefined;break;}}console[_0x2a955c(0x289)](_0x2a955c(0x286)+_0x4be5e9+':\x20'+(_0x35e055||_0x2a955c(0x2f8)));const _0x3d4b36=await _0x5ce7fc[_0x2a955c(0x315)][_0x2a955c(0x260)]({'data':{'shopId':_0x24e196,'amount':_0x551f2c,'network':_0x4be5e9,'status':_0x2a955c(0x2df),'txid':_0x5413ef,'notes':_0x11978d,'periodFrom':_0x3cadab?new Date(_0x3cadab):null,'periodTo':_0x11befd?new Date(_0x11befd):null,'createdAt':new Date(),'paidAt':new Date()}}),_0x3498c6=_0x5bce12[_0x2a955c(0x233)]-_0x551f2c,_0x12c570=_0x5bce12['totalPaidOut']+_0x551f2c;return await _0x5ce7fc[_0x2a955c(0x2dc)]['update']({'where':{'id':_0x24e196},'data':{'balance':_0x3498c6,'totalPaidOut':_0x12c570}}),console[_0x2a955c(0x289)](_0x2a955c(0x225)+_0x5bce12[_0x2a955c(0x266)]+_0x2a955c(0x211)),console['log'](_0x2a955c(0x32f)+_0x5bce12[_0x2a955c(0x233)][_0x2a955c(0x230)](0x6)+_0x2a955c(0x205)+_0x3498c6['toFixed'](0x6)+'\x20USDT\x20(-'+_0x551f2c[_0x2a955c(0x230)](0x6)+')'),console[_0x2a955c(0x289)]('\x20\x20\x20Total\x20paid\x20out:\x20'+_0x5bce12[_0x2a955c(0x20a)][_0x2a955c(0x230)](0x6)+_0x2a955c(0x205)+_0x12c570['toFixed'](0x6)+_0x2a955c(0x26e)+_0x551f2c[_0x2a955c(0x230)](0x6)+')'),{'payout':_0x3d4b36,'shop':_0x5bce12};});return console['log']('✅\x20Payout\x20created:\x20'+_0x36bd3a['payout']['id']+'\x20for\x20shop\x20'+_0x36bd3a[_0x2f0b2d(0x2dc)][_0x2f0b2d(0x266)]+'\x20('+_0x551f2c+_0x2f0b2d(0x329)),{'id':_0x36bd3a['payout']['id'],'shopId':_0x36bd3a[_0x2f0b2d(0x315)][_0x2f0b2d(0x28d)],'shopName':_0x36bd3a[_0x2f0b2d(0x2dc)][_0x2f0b2d(0x247)],'shopUsername':_0x36bd3a[_0x2f0b2d(0x2dc)][_0x2f0b2d(0x266)],'amount':_0x36bd3a[_0x2f0b2d(0x315)][_0x2f0b2d(0x2d3)],'network':_0x36bd3a[_0x2f0b2d(0x315)][_0x2f0b2d(0x319)],'status':_0x36bd3a[_0x2f0b2d(0x315)]['status'],'txid':_0x36bd3a[_0x2f0b2d(0x315)][_0x2f0b2d(0x2b9)],'notes':_0x36bd3a[_0x2f0b2d(0x315)][_0x2f0b2d(0x290)],'periodFrom':_0x36bd3a[_0x2f0b2d(0x315)][_0x2f0b2d(0x308)],'periodTo':_0x36bd3a[_0x2f0b2d(0x315)]['periodTo'],'createdAt':_0x36bd3a[_0x2f0b2d(0x315)][_0x2f0b2d(0x23b)],'paidAt':_0x36bd3a[_0x2f0b2d(0x315)][_0x2f0b2d(0x2a2)]};}async[a36_0x30790d(0x2e5)](_0x166535){const _0x330a61=a36_0x30790d,{page:_0x17cba2,limit:_0x3c0f40,shopId:_0x406dae,network:_0x360e80,dateFrom:_0x370285,dateTo:_0x20fa62,search:_0x233e0a}=_0x166535,_0x3e5d47=(_0x17cba2-0x1)*_0x3c0f40,_0x503edf={};_0x406dae&&(_0x503edf[_0x330a61(0x28d)]=_0x406dae);_0x360e80&&(_0x503edf[_0x330a61(0x319)]=_0x360e80);(_0x370285||_0x20fa62)&&(_0x503edf[_0x330a61(0x23b)]={},_0x370285&&(_0x503edf[_0x330a61(0x23b)]['gte']=new Date(_0x370285)),_0x20fa62&&(_0x503edf[_0x330a61(0x23b)][_0x330a61(0x242)]=new Date(_0x20fa62)));_0x233e0a&&(_0x503edf['OR']=[{'shop':{'name':{'contains':_0x233e0a,'mode':'insensitive'}}},{'shop':{'username':{'contains':_0x233e0a,'mode':_0x330a61(0x278)}}},{'notes':{'contains':_0x233e0a,'mode':_0x330a61(0x278)}}]);const [_0x37d8cc,_0x18c885]=await Promise[_0x330a61(0x22b)]([database_1['default'][_0x330a61(0x315)][_0x330a61(0x300)]({'where':_0x503edf,'skip':_0x3e5d47,'take':_0x3c0f40,'orderBy':{'createdAt':_0x330a61(0x2d6)},'select':{'id':!![],'shopId':!![],'amount':!![],'network':!![],'status':!![],'txid':!![],'notes':!![],'periodFrom':!![],'periodTo':!![],'createdAt':!![],'paidAt':!![],'shop':{'select':{'name':!![],'username':!![]}}}}),database_1[_0x330a61(0x2a8)][_0x330a61(0x315)][_0x330a61(0x2f0)]({'where':_0x503edf})]);return{'payouts':_0x37d8cc[_0x330a61(0x24e)](_0x4b03f2=>({'id':_0x4b03f2['id'],'shopId':_0x4b03f2[_0x330a61(0x28d)],'shopName':_0x4b03f2[_0x330a61(0x2dc)][_0x330a61(0x247)],'shopUsername':_0x4b03f2[_0x330a61(0x2dc)]['username'],'amount':_0x4b03f2[_0x330a61(0x2d3)],'network':_0x4b03f2['network'],'status':_0x4b03f2[_0x330a61(0x29a)],'txid':_0x4b03f2['txid'],'notes':_0x4b03f2[_0x330a61(0x290)],'periodFrom':_0x4b03f2[_0x330a61(0x308)],'periodTo':_0x4b03f2[_0x330a61(0x2c4)],'createdAt':_0x4b03f2[_0x330a61(0x23b)],'paidAt':_0x4b03f2[_0x330a61(0x2a2)]})),'pagination':{'page':_0x17cba2,'limit':_0x3c0f40,'total':_0x18c885,'totalPages':Math['ceil'](_0x18c885/_0x3c0f40)}};}async[a36_0x30790d(0x309)](_0x141a64){const _0x202128=a36_0x30790d,_0x1f1bb1=await database_1[_0x202128(0x2a8)][_0x202128(0x315)][_0x202128(0x246)]({'where':{'id':_0x141a64},'include':{'shop':{'select':{'name':!![],'username':!![]}}}});if(!_0x1f1bb1)return null;return{'id':_0x1f1bb1['id'],'shopId':_0x1f1bb1[_0x202128(0x28d)],'shopName':_0x1f1bb1[_0x202128(0x2dc)][_0x202128(0x247)],'shopUsername':_0x1f1bb1[_0x202128(0x2dc)][_0x202128(0x266)],'amount':_0x1f1bb1[_0x202128(0x2d3)],'network':_0x1f1bb1['network'],'status':_0x1f1bb1[_0x202128(0x29a)],'txid':_0x1f1bb1[_0x202128(0x2b9)],'notes':_0x1f1bb1['notes'],'periodFrom':_0x1f1bb1[_0x202128(0x308)],'periodTo':_0x1f1bb1['periodTo'],'createdAt':_0x1f1bb1[_0x202128(0x23b)],'paidAt':_0x1f1bb1[_0x202128(0x2a2)]};}async[a36_0x30790d(0x21c)](_0x4a5f07){const _0xab95b1=a36_0x30790d;await database_1[_0xab95b1(0x2a8)]['payout']['delete']({'where':{'id':_0x4a5f07}});}async[a36_0x30790d(0x223)](_0x3f3028){const _0x20af6e=a36_0x30790d,{page:_0x29e178,limit:_0x334477,status:_0x1093dc,gateway:_0x5969e6,shopId:_0x91461f,dateFrom:_0x23f5e3,dateTo:_0x543a1a,search:_0x5a722a,currency:_0x4c0aa8,sortBy:_0x340311,sortOrder:_0x46b012}=_0x3f3028,_0x4ab438=(_0x29e178-0x1)*_0x334477;console[_0x20af6e(0x289)](_0x20af6e(0x324),_0x3f3028);const _0x37d0a0=await database_1['default'][_0x20af6e(0x245)][_0x20af6e(0x268)]({'by':[_0x20af6e(0x2e9)],'_count':{'gateway':!![]}});console[_0x20af6e(0x289)]('📊\x20Available\x20gateways\x20in\x20database:',_0x37d0a0[_0x20af6e(0x24e)](_0x57102b=>_0x57102b['gateway']+'\x20('+_0x57102b[_0x20af6e(0x2b2)][_0x20af6e(0x2e9)]+'\x20payments)'));if(_0x5969e6){const _0x1defd8=_0x37d0a0[_0x20af6e(0x2b0)](_0x3d097e=>_0x3d097e[_0x20af6e(0x2e9)][_0x20af6e(0x271)]()===_0x5969e6[_0x20af6e(0x271)]());!_0x1defd8&&_0x5969e6[_0x20af6e(0x271)]()!=='test_gateway'&&console[_0x20af6e(0x289)](_0x20af6e(0x30d)+_0x5969e6+_0x20af6e(0x2e1)+_0x37d0a0[_0x20af6e(0x24e)](_0x4f9317=>_0x4f9317[_0x20af6e(0x2e9)])[_0x20af6e(0x243)](',\x20'));}const _0x132fa8={};_0x1093dc&&(_0x132fa8[_0x20af6e(0x29a)]=_0x1093dc[_0x20af6e(0x2aa)]());if(!_0x5969e6)_0x132fa8[_0x20af6e(0x2e9)]={'not':_0x20af6e(0x265)};else{if(_0x5969e6&&(_0x5969e6['toLowerCase']()==='test_gateway'||_0x5969e6===_0x20af6e(0x1fe)))_0x132fa8[_0x20af6e(0x2e9)]='test_gateway';else{let _0x250703=_0x5969e6;const _0x3fa0e6=(0x0,gateway_1[_0x20af6e(0x27a)])(_0x5969e6);if(_0x3fa0e6)_0x250703=_0x3fa0e6,console[_0x20af6e(0x289)](_0x20af6e(0x270)+_0x5969e6+_0x20af6e(0x240)+_0x250703+'\x27');else{const _0x39a015=(0x0,gateway_1[_0x20af6e(0x28c)])(_0x5969e6);if(_0x39a015){const _0x4d4d9d=(0x0,gateway_1['getGatewayNameById'])(_0x39a015);_0x4d4d9d&&(_0x250703=_0x4d4d9d,console[_0x20af6e(0x289)](_0x20af6e(0x2ed)+_0x5969e6+_0x20af6e(0x2ef)+_0x39a015+'\x27\x20->\x20name\x20\x27'+_0x250703+'\x27'));}else console[_0x20af6e(0x289)]('🔍\x20Using\x20gateway\x20\x27'+_0x5969e6+_0x20af6e(0x206));}const _0x4b8e53=await database_1[_0x20af6e(0x2a8)][_0x20af6e(0x245)][_0x20af6e(0x2f0)]({'where':{'gateway':_0x250703['toLowerCase']()},'take':0x1});_0x4b8e53===0x0?(console[_0x20af6e(0x289)](_0x20af6e(0x273)+_0x250703+_0x20af6e(0x28a)+_0x5969e6+_0x20af6e(0x222)),_0x132fa8['gateway']=_0x20af6e(0x2b4)):(_0x132fa8['gateway']=_0x250703[_0x20af6e(0x271)](),console[_0x20af6e(0x289)]('✅\x20Using\x20gateway\x20filter:\x20\x27'+_0x250703+_0x20af6e(0x28a)+_0x5969e6+'\x27)'));}}console['log']('📊\x20Gateway\x20filter\x20applied:',_0x132fa8[_0x20af6e(0x2e9)]);_0x91461f&&(_0x132fa8[_0x20af6e(0x28d)]=_0x91461f);_0x4c0aa8&&(_0x132fa8['currency']=_0x4c0aa8[_0x20af6e(0x2aa)](),console[_0x20af6e(0x289)]('💱\x20Currency\x20filter\x20applied:\x20'+_0x4c0aa8[_0x20af6e(0x2aa)]()));(_0x23f5e3||_0x543a1a)&&(_0x132fa8['createdAt']={},_0x23f5e3&&(_0x132fa8[_0x20af6e(0x23b)][_0x20af6e(0x241)]=new Date(_0x23f5e3)),_0x543a1a&&(_0x132fa8['createdAt'][_0x20af6e(0x242)]=new Date(_0x543a1a)));_0x5a722a&&(_0x132fa8['OR']=[{'id':{'contains':_0x5a722a,'mode':_0x20af6e(0x278)}},{'orderId':{'contains':_0x5a722a,'mode':_0x20af6e(0x278)}},{'gatewayOrderId':{'contains':_0x5a722a,'mode':_0x20af6e(0x278)}},{'customerEmail':{'contains':_0x5a722a,'mode':_0x20af6e(0x278)}},{'shop':{'name':{'contains':_0x5a722a,'mode':_0x20af6e(0x278)}}},{'shop':{'username':{'contains':_0x5a722a,'mode':'insensitive'}}}]);console[_0x20af6e(0x289)](_0x20af6e(0x238),JSON['stringify'](_0x132fa8,null,0x2));let _0x4cb173={'createdAt':_0x20af6e(0x2d6)};if(_0x340311){const _0x5cdcde=[_0x20af6e(0x2d3),_0x20af6e(0x23b),_0x20af6e(0x210),_0x20af6e(0x29a),_0x20af6e(0x2e9),_0x20af6e(0x2e3)],_0xeaf91f=[_0x20af6e(0x2ae),_0x20af6e(0x2d6)];if(_0x5cdcde[_0x20af6e(0x255)](_0x340311)){const _0x304154=_0xeaf91f[_0x20af6e(0x255)](_0x46b012)?_0x46b012:_0x20af6e(0x2d6);_0x4cb173={[_0x340311]:_0x304154},console[_0x20af6e(0x289)](_0x20af6e(0x20d)+_0x340311+_0x20af6e(0x304)+_0x304154+_0x20af6e(0x25b));}}const [_0x5ae661,_0x4d14f1]=await Promise[_0x20af6e(0x22b)]([database_1[_0x20af6e(0x2a8)][_0x20af6e(0x245)][_0x20af6e(0x300)]({'where':_0x132fa8,'skip':_0x4ab438,'take':_0x334477,'orderBy':_0x4cb173}),database_1['default'][_0x20af6e(0x245)]['count']({'where':_0x132fa8})]);return{'payments':_0x5ae661,'pagination':{'page':_0x29e178,'limit':_0x334477,'total':_0x4d14f1,'totalPages':Math['ceil'](_0x4d14f1/_0x334477)}};}async['getPaymentById'](_0x3b72c1){const _0xc5e32a=a36_0x30790d,_0x96b6c6=await database_1['default'][_0xc5e32a(0x245)][_0xc5e32a(0x246)]({'where':{'id':_0x3b72c1},'select':{'id':!![],'shopId':!![],'amount':!![],'amountAfterGatewayCommissionUSDT':!![],'currency':!![],'sourceCurrency':!![],'status':!![],'gateway':!![],'orderId':!![],'gatewayOrderId':!![],'gatewayPaymentId':!![],'customerEmail':!![],'customerName':!![],'customerCountry':!![],'customerIp':!![],'customerUa':!![],'externalPaymentUrl':!![],'successUrl':!![],'failUrl':!![],'pendingUrl':!![],'whiteUrl':!![],'expiresAt':!![],'invoiceTotalSum':!![],'qrCode':!![],'qrUrl':!![],'country':!![],'language':!![],'amountIsEditable':!![],'maxPayments':!![],'rapydCustomer':!![],'cardLast4':!![],'paymentMethod':!![],'bankId':!![],'remitterIban':!![],'remitterName':!![],'failureMessage':!![],'usage':!![],'createdAt':!![],'updatedAt':!![],'shop':{'select':{'name':!![],'username':!![]}}}});if(!_0x96b6c6)return null;return{'id':_0x96b6c6['id'],'shopId':_0x96b6c6[_0xc5e32a(0x28d)],'gateway':_0x96b6c6['gateway'],'amount':_0x96b6c6[_0xc5e32a(0x2d3)],'currency':_0x96b6c6[_0xc5e32a(0x2e3)],'status':_0x96b6c6[_0xc5e32a(0x29a)],'orderId':_0x96b6c6['orderId'],'gatewayOrderId':_0x96b6c6[_0xc5e32a(0x2fa)],'customerEmail':_0x96b6c6['customerEmail'],'customerName':_0x96b6c6[_0xc5e32a(0x1ff)],'customerCountry':_0x96b6c6[_0xc5e32a(0x291)],'customerIp':_0x96b6c6[_0xc5e32a(0x208)],'customerUa':_0x96b6c6[_0xc5e32a(0x30f)],'failureMessage':_0x96b6c6[_0xc5e32a(0x2f6)],'externalPaymentUrl':_0x96b6c6[_0xc5e32a(0x2d7)],'successUrl':_0x96b6c6['successUrl'],'failUrl':_0x96b6c6[_0xc5e32a(0x321)],'pendingUrl':_0x96b6c6[_0xc5e32a(0x234)],'whiteUrl':_0x96b6c6[_0xc5e32a(0x263)],'createdAt':_0x96b6c6['createdAt'],'updatedAt':_0x96b6c6['updatedAt'],'shop':_0x96b6c6[_0xc5e32a(0x2dc)]};}async['updatePaymentStatus'](_0x4aff74,_0x33106f,_0x30314f,_0xd8ccf5){const _0x5a3d3f=a36_0x30790d,_0x1fcf7b=await database_1[_0x5a3d3f(0x2a8)]['$transaction'](async _0x3b56cc=>{const _0x5dadc6=_0x5a3d3f,_0x32c999=await _0x3b56cc[_0x5dadc6(0x245)][_0x5dadc6(0x246)]({'where':{'id':_0x4aff74},'include':{'shop':{'select':{'id':!![],'name':!![],'username':!![],'balance':!![]}}}});if(!_0x32c999)throw new Error(_0x5dadc6(0x202));const _0x39dff3=_0x32c999[_0x5dadc6(0x29a)],_0x2fae07=_0x33106f['toUpperCase']();console['log'](_0x5dadc6(0x26c)+_0x4aff74+_0x5dadc6(0x227)+_0x39dff3+'\x20->\x20'+_0x2fae07),console['log']('💰\x20Current\x20shop\x20balance:\x20'+_0x32c999[_0x5dadc6(0x2dc)][_0x5dadc6(0x233)]+_0x5dadc6(0x31b));const _0x14252a={'status':_0x2fae07,'updatedAt':new Date(),'statusChangedBy':_0x5dadc6(0x28b),'statusChangedAt':new Date()};_0x30314f&&(_0x14252a['adminNotes']=_0x30314f);_0x2fae07===_0x5dadc6(0x31a)&&_0xd8ccf5&&(_0x14252a[_0x5dadc6(0x298)]=_0xd8ccf5);let _0x40c56f=0x0,_0x2c9157=_0x32c999['shop'][_0x5dadc6(0x233)];if(_0x2fae07===_0x5dadc6(0x293)&&_0x39dff3!==_0x5dadc6(0x293)){_0x14252a[_0x5dadc6(0x2a2)]=new Date();const _0x4d207d=await currencyService_1[_0x5dadc6(0x2ca)][_0x5dadc6(0x2ea)](_0x32c999[_0x5dadc6(0x2d3)],_0x32c999[_0x5dadc6(0x2e3)]);_0x14252a[_0x5dadc6(0x258)]=_0x4d207d;let _0x15b7b1=0xa;const _0x592fe4=await _0x3b56cc['shop'][_0x5dadc6(0x246)]({'where':{'id':_0x32c999[_0x5dadc6(0x28d)]},'select':{'gatewaySettings':!![]}});if(_0x592fe4?.['gatewaySettings'])try{const _0x5ee955=JSON[_0x5dadc6(0x21e)](_0x592fe4[_0x5dadc6(0x262)]);for(const [_0x5c8d7f,_0x435d9a]of Object[_0x5dadc6(0x2c1)](_0x5ee955)){if(_0x5c8d7f['toLowerCase']()===_0x32c999[_0x5dadc6(0x2e9)][_0x5dadc6(0x271)]()){_0x15b7b1=_0x435d9a['commission']||0xa;break;}}}catch(_0x135d40){console[_0x5dadc6(0x231)](_0x5dadc6(0x306)+_0x4aff74+':',_0x135d40);}let _0x4abcbc;_0x32c999[_0x5dadc6(0x261)]!==null&&_0x32c999[_0x5dadc6(0x261)]!==undefined?(_0x4abcbc=_0x32c999[_0x5dadc6(0x261)],console[_0x5dadc6(0x289)](_0x5dadc6(0x2c8)+_0x4abcbc[_0x5dadc6(0x230)](0x6)+_0x5dadc6(0x2bb)+_0x4aff74)):(_0x4abcbc=_0x4d207d*(0x1-_0x15b7b1/0x64),console['log'](_0x5dadc6(0x25a)+_0x4aff74+':\x20'+_0x15b7b1+_0x5dadc6(0x307)+_0x4d207d[_0x5dadc6(0x230)](0x6)+_0x5dadc6(0x31b)),_0x14252a[_0x5dadc6(0x261)]=_0x4abcbc),_0x40c56f=_0x4abcbc,_0x2c9157+=_0x4abcbc,console[_0x5dadc6(0x289)]('💰\x20Payment\x20'+_0x4aff74+_0x5dadc6(0x2a1)),console[_0x5dadc6(0x289)]('\x20\x20\x20Full\x20amount:\x20'+_0x4d207d[_0x5dadc6(0x230)](0x6)+'\x20USDT'),console[_0x5dadc6(0x289)](_0x5dadc6(0x27b)+_0x32c999[_0x5dadc6(0x2e9)]+_0x5dadc6(0x1f9)+_0x15b7b1+'%'),console[_0x5dadc6(0x289)](_0x5dadc6(0x26b)+_0x4abcbc[_0x5dadc6(0x230)](0x6)+_0x5dadc6(0x2ba)+_0x15b7b1+_0x5dadc6(0x2bc)),console[_0x5dadc6(0x289)]('\x20\x20\x20Added\x20to\x20balance:\x20+'+_0x4abcbc[_0x5dadc6(0x230)](0x6)+_0x5dadc6(0x31b));}else{if(_0x39dff3===_0x5dadc6(0x293)&&_0x2fae07!==_0x5dadc6(0x293)){if(_0x32c999[_0x5dadc6(0x258)]){let _0x4f5a06=0xa;const _0x170c50=await _0x3b56cc[_0x5dadc6(0x2dc)]['findUnique']({'where':{'id':_0x32c999['shopId']},'select':{'gatewaySettings':!![]}});if(_0x170c50?.['gatewaySettings'])try{const _0x586c5b=JSON['parse'](_0x170c50[_0x5dadc6(0x262)]);for(const [_0x319e41,_0x3f755a]of Object[_0x5dadc6(0x2c1)](_0x586c5b)){if(_0x319e41[_0x5dadc6(0x271)]()===_0x32c999[_0x5dadc6(0x2e9)][_0x5dadc6(0x271)]()){_0x4f5a06=_0x3f755a[_0x5dadc6(0x2d0)]||0xa;break;}}}catch(_0x5aab29){console['error']('Error\x20parsing\x20gateway\x20settings\x20for\x20payment\x20'+_0x4aff74+':',_0x5aab29);}const _0x52a954=_0x32c999['amountUSDT']*(0x1-_0x4f5a06/0x64);_0x40c56f=-_0x52a954,_0x2c9157-=_0x52a954,_0x14252a[_0x5dadc6(0x258)]=null,_0x14252a['amountAfterGatewayCommissionUSDT']=null,console['log'](_0x5dadc6(0x2c3)+_0x4aff74+_0x5dadc6(0x249)),console['log'](_0x5dadc6(0x22d)+_0x32c999['amountUSDT'][_0x5dadc6(0x230)](0x6)+'\x20USDT'),console[_0x5dadc6(0x289)](_0x5dadc6(0x27b)+_0x32c999[_0x5dadc6(0x2e9)]+_0x5dadc6(0x1f9)+_0x4f5a06+'%'),console['log'](_0x5dadc6(0x2d2)+_0x52a954['toFixed'](0x6)+'\x20USDT\x20(after\x20'+_0x4f5a06+_0x5dadc6(0x2bc)),console[_0x5dadc6(0x289)]('\x20\x20\x20Subtracted\x20from\x20balance:\x20-'+_0x52a954[_0x5dadc6(0x230)](0x6)+_0x5dadc6(0x31b));}}}_0x2fae07===_0x5dadc6(0x31a)&&(_0x39dff3===_0x5dadc6(0x293)&&_0x32c999[_0x5dadc6(0x258)]&&console[_0x5dadc6(0x289)](_0x5dadc6(0x215)),_0xd8ccf5&&_0xd8ccf5>0x0&&(_0x40c56f-=_0xd8ccf5,_0x2c9157-=_0xd8ccf5,console[_0x5dadc6(0x289)]('💸\x20CHARGEBACK\x20penalty:\x20-'+_0xd8ccf5['toFixed'](0x6)+_0x5dadc6(0x326))));_0x2fae07===_0x5dadc6(0x313)&&_0x39dff3===_0x5dadc6(0x293)&&console[_0x5dadc6(0x289)](_0x5dadc6(0x22a));const _0x306bc1=await _0x3b56cc[_0x5dadc6(0x245)][_0x5dadc6(0x229)]({'where':{'id':_0x4aff74},'data':_0x14252a,'include':{'shop':{'select':{'name':!![],'username':!![]}}}});return _0x40c56f!==0x0&&(await _0x3b56cc[_0x5dadc6(0x2dc)][_0x5dadc6(0x229)]({'where':{'id':_0x32c999[_0x5dadc6(0x28d)]},'data':{'balance':_0x2c9157}}),console[_0x5dadc6(0x289)](_0x5dadc6(0x225)+_0x32c999[_0x5dadc6(0x28d)]+_0x5dadc6(0x236)+_0x32c999[_0x5dadc6(0x2dc)][_0x5dadc6(0x233)][_0x5dadc6(0x230)](0x6)+_0x5dadc6(0x205)+_0x2c9157[_0x5dadc6(0x230)](0x6)+'\x20USDT\x20('+(_0x40c56f>0x0?'+':'')+_0x40c56f[_0x5dadc6(0x230)](0x6)+')')),_0x306bc1;});return{'id':_0x1fcf7b['id'],'shopId':_0x1fcf7b[_0x5a3d3f(0x28d)],'gateway':_0x1fcf7b[_0x5a3d3f(0x2e9)],'amount':_0x1fcf7b[_0x5a3d3f(0x2d3)],'currency':_0x1fcf7b['currency'],'status':_0x1fcf7b[_0x5a3d3f(0x29a)],'orderId':_0x1fcf7b[_0x5a3d3f(0x26a)],'gatewayOrderId':_0x1fcf7b['gatewayOrderId'],'customerEmail':_0x1fcf7b[_0x5a3d3f(0x2f1)],'customerName':_0x1fcf7b[_0x5a3d3f(0x1ff)],'customerCountry':_0x1fcf7b[_0x5a3d3f(0x291)],'customerIp':_0x1fcf7b[_0x5a3d3f(0x208)],'customerUa':_0x1fcf7b['customerUa'],'failureMessage':_0x1fcf7b['failureMessage'],'adminNotes':_0x1fcf7b[_0x5a3d3f(0x2ff)],'chargebackAmount':_0x1fcf7b[_0x5a3d3f(0x298)],'statusChangedBy':_0x1fcf7b[_0x5a3d3f(0x216)],'statusChangedAt':_0x1fcf7b['statusChangedAt'],'createdAt':_0x1fcf7b[_0x5a3d3f(0x23b)],'updatedAt':_0x1fcf7b[_0x5a3d3f(0x210)],'shop':_0x1fcf7b[_0x5a3d3f(0x2dc)]};}async[a36_0x30790d(0x2a5)](_0x150114,_0x5544ed){const _0x456f82=a36_0x30790d,_0x451156=Math[_0x456f82(0x311)]()[_0x456f82(0x27e)](0x24)[_0x456f82(0x20c)](0x2,0x9);console[_0x456f82(0x289)]('🎯\x20updateUser\x20called\x20with\x20ID:\x20'+_0x451156+_0x456f82(0x288)+_0x150114);const _0x4755d0={..._0x5544ed};_0x5544ed['password']&&_0x5544ed[_0x456f82(0x276)]['trim']()!==''?(console['log'](_0x456f82(0x2a4)+_0x451156+_0x456f82(0x2f2)+_0x150114),_0x4755d0[_0x456f82(0x276)]=await bcryptjs_1[_0x456f82(0x2a8)][_0x456f82(0x2dd)](_0x5544ed[_0x456f82(0x276)],0xc)):(console[_0x456f82(0x289)](_0x456f82(0x2a4)+_0x451156+_0x456f82(0x1f7)),delete _0x4755d0[_0x456f82(0x276)]);_0x5544ed[_0x456f82(0x281)]&&(_0x4755d0['name']=_0x5544ed[_0x456f82(0x281)],delete _0x4755d0[_0x456f82(0x281)]);_0x5544ed[_0x456f82(0x24f)]&&(_0x4755d0['telegram']=_0x5544ed[_0x456f82(0x24f)],delete _0x4755d0[_0x456f82(0x24f)]);_0x5544ed[_0x456f82(0x1fa)]&&(_0x4755d0['shopUrl']=_0x5544ed['merchantUrl'],delete _0x4755d0[_0x456f82(0x1fa)]);if(_0x5544ed[_0x456f82(0x29f)]){const _0x42b7fb=_0x5544ed[_0x456f82(0x29f)]['map'](_0x38ba75=>this[_0x456f82(0x30a)](_0x38ba75));console[_0x456f82(0x289)](_0x456f82(0x316),_0x5544ed[_0x456f82(0x29f)],'->',_0x42b7fb),_0x4755d0[_0x456f82(0x294)]=JSON[_0x456f82(0x1f6)](_0x42b7fb),delete _0x4755d0[_0x456f82(0x29f)];}_0x5544ed['gatewaySettings']&&(console[_0x456f82(0x289)](_0x456f82(0x2f3)+_0x451156+_0x456f82(0x2e2),_0x5544ed[_0x456f82(0x262)]),_0x4755d0['gatewaySettings']=JSON['stringify'](_0x5544ed[_0x456f82(0x262)]),console[_0x456f82(0x289)](_0x456f82(0x2f3)+_0x451156+_0x456f82(0x275),_0x4755d0['gatewaySettings']));_0x5544ed['wallets']&&(_0x5544ed['wallets'][_0x456f82(0x218)]!==undefined&&(_0x4755d0[_0x456f82(0x218)]=_0x5544ed[_0x456f82(0x2cc)][_0x456f82(0x218)]||null),_0x5544ed['wallets'][_0x456f82(0x28e)]!==undefined&&(_0x4755d0[_0x456f82(0x28e)]=_0x5544ed[_0x456f82(0x2cc)][_0x456f82(0x28e)]||null),_0x5544ed[_0x456f82(0x2cc)][_0x456f82(0x2fb)]!==undefined&&(_0x4755d0[_0x456f82(0x2fb)]=_0x5544ed[_0x456f82(0x2cc)][_0x456f82(0x2fb)]||null),_0x5544ed[_0x456f82(0x2cc)][_0x456f82(0x2d4)]!==undefined&&(_0x4755d0['usdcPolygonWallet']=_0x5544ed['wallets'][_0x456f82(0x2d4)]||null),delete _0x4755d0['wallets']);const _0x28687a=await database_1[_0x456f82(0x2a8)][_0x456f82(0x2dc)]['update']({'where':{'id':_0x150114},'data':_0x4755d0,'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});return console[_0x456f82(0x289)]('🎯\x20['+_0x451156+_0x456f82(0x204),_0x28687a[_0x456f82(0x262)]),{'id':_0x28687a['id'],'fullName':_0x28687a[_0x456f82(0x247)],'username':_0x28687a[_0x456f82(0x266)],'telegramId':_0x28687a['telegram'],'merchantUrl':_0x28687a[_0x456f82(0x207)],'gateways':_0x28687a[_0x456f82(0x294)]?JSON['parse'](_0x28687a[_0x456f82(0x294)]):null,'gatewaySettings':_0x28687a['gatewaySettings']?JSON[_0x456f82(0x21e)](_0x28687a[_0x456f82(0x262)]):null,'publicKey':_0x28687a[_0x456f82(0x2db)],'wallets':{'usdtPolygonWallet':_0x28687a[_0x456f82(0x218)],'usdtTrcWallet':_0x28687a['usdtTrcWallet'],'usdtErcWallet':_0x28687a[_0x456f82(0x2fb)],'usdcPolygonWallet':_0x28687a['usdcPolygonWallet']},'status':_0x28687a[_0x456f82(0x29a)],'createdAt':_0x28687a[_0x456f82(0x23b)]};}async['suspendUser'](_0x4d2b45){const _0x431d07=a36_0x30790d,_0xf1e760=await database_1[_0x431d07(0x2a8)][_0x431d07(0x2dc)][_0x431d07(0x229)]({'where':{'id':_0x4d2b45},'data':{'status':_0x431d07(0x297)},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});return{'id':_0xf1e760['id'],'fullName':_0xf1e760[_0x431d07(0x247)],'username':_0xf1e760[_0x431d07(0x266)],'telegramId':_0xf1e760['telegram'],'merchantUrl':_0xf1e760[_0x431d07(0x207)],'gateways':_0xf1e760[_0x431d07(0x294)]?JSON['parse'](_0xf1e760[_0x431d07(0x294)]):null,'gatewaySettings':_0xf1e760[_0x431d07(0x262)]?JSON[_0x431d07(0x21e)](_0xf1e760[_0x431d07(0x262)]):null,'publicKey':_0xf1e760['publicKey'],'wallets':{'usdtPolygonWallet':_0xf1e760[_0x431d07(0x218)],'usdtTrcWallet':_0xf1e760[_0x431d07(0x28e)],'usdtErcWallet':_0xf1e760[_0x431d07(0x2fb)],'usdcPolygonWallet':_0xf1e760['usdcPolygonWallet']},'status':_0xf1e760['status'],'createdAt':_0xf1e760[_0x431d07(0x23b)]};}async[a36_0x30790d(0x257)](_0x4ea2e7){const _0x49aad3=a36_0x30790d,_0x1a6c58=await database_1['default'][_0x49aad3(0x2dc)][_0x49aad3(0x229)]({'where':{'id':_0x4ea2e7},'data':{'status':_0x49aad3(0x2cf)},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});return{'id':_0x1a6c58['id'],'fullName':_0x1a6c58[_0x49aad3(0x247)],'username':_0x1a6c58[_0x49aad3(0x266)],'telegramId':_0x1a6c58[_0x49aad3(0x29e)],'merchantUrl':_0x1a6c58['shopUrl'],'gateways':_0x1a6c58[_0x49aad3(0x294)]?JSON[_0x49aad3(0x21e)](_0x1a6c58[_0x49aad3(0x294)]):null,'gatewaySettings':_0x1a6c58[_0x49aad3(0x262)]?JSON['parse'](_0x1a6c58[_0x49aad3(0x262)]):null,'publicKey':_0x1a6c58[_0x49aad3(0x2db)],'wallets':{'usdtPolygonWallet':_0x1a6c58['usdtPolygonWallet'],'usdtTrcWallet':_0x1a6c58[_0x49aad3(0x28e)],'usdtErcWallet':_0x1a6c58[_0x49aad3(0x2fb)],'usdcPolygonWallet':_0x1a6c58[_0x49aad3(0x2d4)]},'status':_0x1a6c58['status'],'createdAt':_0x1a6c58[_0x49aad3(0x23b)]};}async[a36_0x30790d(0x31d)](_0x12a67b){const _0x34e977=a36_0x30790d,{page:_0x57f38b,limit:_0x338c09,status:_0x25637c}=_0x12a67b,_0x12e421=(_0x57f38b-0x1)*_0x338c09,_0x1f3404={};_0x25637c&&(_0x1f3404[_0x34e977(0x29a)]=_0x25637c['toUpperCase']());const [_0x2f81a8,_0x51f0b1]=await Promise['all']([database_1[_0x34e977(0x2a8)][_0x34e977(0x2dc)][_0x34e977(0x300)]({'where':_0x1f3404,'skip':_0x12e421,'take':_0x338c09,'orderBy':{'createdAt':_0x34e977(0x2d6)},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}}),database_1[_0x34e977(0x2a8)][_0x34e977(0x2dc)]['count']({'where':_0x1f3404})]);return{'users':_0x2f81a8[_0x34e977(0x24e)](_0x5accf6=>{const _0x5d3ae4=_0x34e977,_0x57c28b=_0x5accf6[_0x5d3ae4(0x294)]?JSON[_0x5d3ae4(0x21e)](_0x5accf6['paymentGateways']):null,_0x1d3f02=_0x57c28b?_0x57c28b[_0x5d3ae4(0x24e)](_0x4e5a51=>this[_0x5d3ae4(0x2de)](_0x4e5a51)):null;return{'id':_0x5accf6['id'],'fullName':_0x5accf6['name'],'username':_0x5accf6[_0x5d3ae4(0x266)],'telegramId':_0x5accf6[_0x5d3ae4(0x29e)],'merchantUrl':_0x5accf6[_0x5d3ae4(0x207)],'gateways':_0x1d3f02,'gatewaySettings':_0x5accf6[_0x5d3ae4(0x262)]?JSON[_0x5d3ae4(0x21e)](_0x5accf6[_0x5d3ae4(0x262)]):null,'publicKey':_0x5accf6[_0x5d3ae4(0x2db)],'wallets':{'usdtPolygonWallet':_0x5accf6[_0x5d3ae4(0x218)],'usdtTrcWallet':_0x5accf6['usdtTrcWallet'],'usdtErcWallet':_0x5accf6['usdtErcWallet'],'usdcPolygonWallet':_0x5accf6['usdcPolygonWallet']},'status':_0x5accf6['status'],'createdAt':_0x5accf6[_0x5d3ae4(0x23b)]};}),'pagination':{'page':_0x57f38b,'limit':_0x338c09,'total':_0x51f0b1,'totalPages':Math[_0x34e977(0x2d1)](_0x51f0b1/_0x338c09)}};}async['getUserById'](_0x299781){const _0x4430a4=a36_0x30790d,_0x545f1a=await database_1[_0x4430a4(0x2a8)][_0x4430a4(0x2dc)]['findUnique']({'where':{'id':_0x299781},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});if(!_0x545f1a)return null;const _0x1f3b37=_0x545f1a[_0x4430a4(0x294)]?JSON[_0x4430a4(0x21e)](_0x545f1a[_0x4430a4(0x294)]):null,_0x4d1e88=_0x1f3b37?_0x1f3b37['map'](_0x162e17=>this['getGatewayDisplayName'](_0x162e17)):null;return _0x1f3b37&&_0x4d1e88&&console[_0x4430a4(0x289)](_0x4430a4(0x237),_0x1f3b37,'->',_0x4d1e88),{'id':_0x545f1a['id'],'fullName':_0x545f1a[_0x4430a4(0x247)],'username':_0x545f1a[_0x4430a4(0x266)],'telegramId':_0x545f1a[_0x4430a4(0x29e)],'merchantUrl':_0x545f1a['shopUrl'],'gateways':_0x4d1e88,'gatewaySettings':_0x545f1a[_0x4430a4(0x262)]?JSON['parse'](_0x545f1a[_0x4430a4(0x262)]):null,'publicKey':_0x545f1a[_0x4430a4(0x2db)],'wallets':{'usdtPolygonWallet':_0x545f1a[_0x4430a4(0x218)],'usdtTrcWallet':_0x545f1a[_0x4430a4(0x28e)],'usdtErcWallet':_0x545f1a['usdtErcWallet'],'usdcPolygonWallet':_0x545f1a[_0x4430a4(0x2d4)]},'status':_0x545f1a[_0x4430a4(0x29a)],'createdAt':_0x545f1a[_0x4430a4(0x23b)]};}async[a36_0x30790d(0x330)](_0xb2cf61){const _0x56d95f=a36_0x30790d,{fullName:_0x1f1190,username:_0x50776f,password:_0x4b0411,telegramId:_0x40d8c7,merchantUrl:_0x1166ae,gateways:_0x58698f,gatewaySettings:_0x323405,wallets:_0x355210}=_0xb2cf61,_0x1e6b8b=await database_1[_0x56d95f(0x2a8)]['shop'][_0x56d95f(0x246)]({'where':{'username':_0x50776f}});if(_0x1e6b8b)throw new Error(_0x56d95f(0x2ee));if(_0x40d8c7){const _0x89171f=await database_1[_0x56d95f(0x2a8)]['shop']['findUnique']({'where':{'telegram':_0x40d8c7}});if(_0x89171f)throw new Error(_0x56d95f(0x2bd));}const _0x13ba42=await bcryptjs_1['default'][_0x56d95f(0x2dd)](_0x4b0411,0xc),_0x37e2a9=_0x56d95f(0x1f0)+crypto_1[_0x56d95f(0x2a8)][_0x56d95f(0x2c9)](0x20)[_0x56d95f(0x27e)](_0x56d95f(0x23d)),_0x4dcfda=_0x56d95f(0x232)+crypto_1[_0x56d95f(0x2a8)][_0x56d95f(0x2c9)](0x20)[_0x56d95f(0x27e)](_0x56d95f(0x23d)),_0x85ff63=_0x58698f?_0x58698f[_0x56d95f(0x24e)](_0x20fbd8=>this['getGatewayInternalName'](_0x20fbd8)):null;_0x58698f&&_0x85ff63&&console['log'](_0x56d95f(0x32b),_0x58698f,'->',_0x85ff63);const _0x1e66ab=await database_1['default'][_0x56d95f(0x2dc)]['create']({'data':{'name':_0x1f1190,'username':_0x50776f,'password':_0x13ba42,'telegram':_0x40d8c7,'shopUrl':_0x1166ae,'paymentGateways':_0x85ff63?JSON[_0x56d95f(0x1f6)](_0x85ff63):null,'gatewaySettings':_0x323405?JSON[_0x56d95f(0x1f6)](_0x323405):null,'usdtPolygonWallet':_0x355210?.['usdtPolygonWallet']||null,'usdtTrcWallet':_0x355210?.[_0x56d95f(0x28e)]||null,'usdtErcWallet':_0x355210?.[_0x56d95f(0x2fb)]||null,'usdcPolygonWallet':_0x355210?.[_0x56d95f(0x2d4)]||null,'publicKey':_0x37e2a9,'secretKey':_0x4dcfda,'status':_0x56d95f(0x2cf)},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});return{'id':_0x1e66ab['id'],'fullName':_0x1e66ab['name'],'username':_0x1e66ab['username'],'telegramId':_0x1e66ab['telegram'],'merchantUrl':_0x1e66ab[_0x56d95f(0x207)],'gateways':_0x1e66ab[_0x56d95f(0x294)]?JSON[_0x56d95f(0x21e)](_0x1e66ab['paymentGateways']):null,'gatewaySettings':_0x1e66ab[_0x56d95f(0x262)]?JSON[_0x56d95f(0x21e)](_0x1e66ab[_0x56d95f(0x262)]):null,'publicKey':_0x1e66ab['publicKey'],'wallets':{'usdtPolygonWallet':_0x1e66ab['usdtPolygonWallet'],'usdtTrcWallet':_0x1e66ab[_0x56d95f(0x28e)],'usdtErcWallet':_0x1e66ab[_0x56d95f(0x2fb)],'usdcPolygonWallet':_0x1e66ab[_0x56d95f(0x2d4)]},'status':_0x1e66ab[_0x56d95f(0x29a)],'createdAt':_0x1e66ab[_0x56d95f(0x23b)]};}async[a36_0x30790d(0x2b1)](_0x294b88){const _0x420714=a36_0x30790d;await database_1['default'][_0x420714(0x2dc)][_0x420714(0x302)]({'where':{'id':_0x294b88}});}[a36_0x30790d(0x280)](_0xb2c913,_0x47b236,_0x7b4da9){const _0x15d5c5=a36_0x30790d,_0x2f303b=new Map(),_0x3efd55=new Date(_0x47b236);while(_0x3efd55<=_0x7b4da9){const _0x571cbe=_0x3efd55[_0x15d5c5(0x219)]()['split']('T')[0x0];_0x2f303b[_0x15d5c5(0x25c)](_0x571cbe,{'revenue':0x0,'count':0x0}),_0x3efd55['setDate'](_0x3efd55['getDate']()+0x1);}for(const _0x2966f3 of _0xb2c913){const _0x38c435=_0x2966f3[_0x15d5c5(0x23b)][_0x15d5c5(0x219)]()['split']('T')[0x0],_0x540ef7=_0x2f303b['get'](_0x38c435);_0x540ef7&&(_0x540ef7[_0x15d5c5(0x2f0)]+=0x1,_0x2966f3[_0x15d5c5(0x29a)]===_0x15d5c5(0x293)&&(_0x2966f3['amountUSDT']?_0x540ef7[_0x15d5c5(0x274)]+=_0x2966f3[_0x15d5c5(0x258)]:console[_0x15d5c5(0x289)](_0x15d5c5(0x318)+_0x2966f3['id']+'\x20missing\x20amountUSDT,\x20using\x20fallback\x20conversion')));}const _0x4f5376=[],_0x29c960=[];for(const [_0x304e13,_0x3cace6]of _0x2f303b){_0x4f5376[_0x15d5c5(0x212)]({'date':_0x304e13,'amount':Math['round'](_0x3cace6[_0x15d5c5(0x274)]*0x64)/0x64}),_0x29c960['push']({'date':_0x304e13,'count':_0x3cace6[_0x15d5c5(0x2f0)]});}return{'dailyRevenue':_0x4f5376,'dailyPayments':_0x29c960};}}exports['AdminService']=AdminService;