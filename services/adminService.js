'use strict';const a38_0x5bb281=a38_0x4f39;(function(_0x320d0a,_0x1566e6){const _0x5a0d63=a38_0x4f39,_0x89e0b4=_0x320d0a();while(!![]){try{const _0x1f60ca=-parseInt(_0x5a0d63(0x127))/0x1+parseInt(_0x5a0d63(0x1d6))/0x2+parseInt(_0x5a0d63(0x196))/0x3*(parseInt(_0x5a0d63(0x13b))/0x4)+-parseInt(_0x5a0d63(0x1fa))/0x5+-parseInt(_0x5a0d63(0x1bd))/0x6+parseInt(_0x5a0d63(0x131))/0x7+-parseInt(_0x5a0d63(0x21a))/0x8*(-parseInt(_0x5a0d63(0x1f1))/0x9);if(_0x1f60ca===_0x1566e6)break;else _0x89e0b4['push'](_0x89e0b4['shift']());}catch(_0x572a01){_0x89e0b4['push'](_0x89e0b4['shift']());}}}(a38_0x59f2,0x4c0d8));var __importDefault=this&&this[a38_0x5bb281(0x133)]||function(_0x348bcc){const _0x51c027=a38_0x5bb281;return _0x348bcc&&_0x348bcc[_0x51c027(0x125)]?_0x348bcc:{'default':_0x348bcc};};Object[a38_0x5bb281(0x222)](exports,a38_0x5bb281(0x125),{'value':!![]}),exports['AdminService']=void 0x0;const database_1=__importDefault(require(a38_0x5bb281(0x1f3))),bcryptjs_1=__importDefault(require(a38_0x5bb281(0x252))),crypto_1=__importDefault(require('crypto')),currencyService_1=require(a38_0x5bb281(0x232)),gateway_1=require('../types/gateway');class AdminService{async[a38_0x5bb281(0x16f)](){const _0x12ded6=a38_0x5bb281;console['log'](_0x12ded6(0x212));const _0xac5022=await database_1[_0x12ded6(0x246)][_0x12ded6(0x140)][_0x12ded6(0x156)]({'_sum':{'balance':!![],'totalPaidOut':!![]},'where':{'status':_0x12ded6(0x1fb)}}),_0x5a213e=await database_1[_0x12ded6(0x246)]['payment'][_0x12ded6(0x1ed)]({'where':{'status':_0x12ded6(0x1cc),'gateway':{'not':_0x12ded6(0x25d)}}}),_0x39472c=new Date(),_0x1d8542=new Date(_0x39472c[_0x12ded6(0x124)](),_0x39472c[_0x12ded6(0x19a)](),0x1),_0x273827=new Date(_0x39472c[_0x12ded6(0x124)](),_0x39472c[_0x12ded6(0x19a)]()+0x1,0x0,0x17,0x3b,0x3b,0x3e7),_0x280c78=await database_1['default'][_0x12ded6(0x1c9)][_0x12ded6(0x156)]({'_sum':{'amount':!![]},'where':{'createdAt':{'gte':_0x1d8542,'lte':_0x273827},'status':'COMPLETED'}}),_0x2f8101=_0xac5022[_0x12ded6(0x19d)][_0x12ded6(0x14e)]||0x0,_0x1ff655=_0xac5022[_0x12ded6(0x19d)]['balance']||0x0,_0x2a1923=_0x280c78['_sum'][_0x12ded6(0x25c)]||0x0,_0x3ad81f={'totalPayout':Math[_0x12ded6(0x20e)](_0x2f8101*0x64)/0x64,'awaitingPayout':Math[_0x12ded6(0x20e)](_0x1ff655*0x64)/0x64,'thisMonth':Math[_0x12ded6(0x20e)](_0x2a1923*0x64)/0x64,'availableBalance':Math[_0x12ded6(0x20e)](_0x1ff655*0x64)/0x64,'totalPayments':_0x5a213e};return console['log'](_0x12ded6(0x123)),console[_0x12ded6(0x15b)](_0x12ded6(0x24f)+_0x3ad81f[_0x12ded6(0x12e)]+_0x12ded6(0x1ef)),console[_0x12ded6(0x15b)](_0x12ded6(0x1c0)+_0x3ad81f[_0x12ded6(0x174)]+'\x20USDT\x20(sum\x20of\x20all\x20merchant\x20balances)'),console[_0x12ded6(0x15b)](_0x12ded6(0x17b)+_0x3ad81f[_0x12ded6(0x195)]+'\x20USDT\x20(same\x20as\x20awaiting)'),console[_0x12ded6(0x15b)](_0x12ded6(0x14f)+_0x3ad81f[_0x12ded6(0x178)]+_0x12ded6(0x230)),console[_0x12ded6(0x15b)](_0x12ded6(0x136)+_0x3ad81f[_0x12ded6(0x24d)]+'\x20PAID\x20payments'),_0x3ad81f;}async[a38_0x5bb281(0x1de)](_0x452aff,_0xf76c3f){const _0x2a7f01=a38_0x5bb281;console[_0x2a7f01(0x15b)](_0x2a7f01(0x162)+_0x452aff+':',_0xf76c3f);const _0x2cace9=await database_1[_0x2a7f01(0x246)][_0x2a7f01(0x1c4)][_0x2a7f01(0x150)]({'where':{'id':_0x452aff},'select':{'id':!![],'customerEmail':!![],'customerName':!![],'customerCountry':!![],'customerIp':!![],'customerUa':!![]}});if(!_0x2cace9)throw new Error(_0x2a7f01(0x179));const _0x1f26d6={};_0xf76c3f[_0x2a7f01(0x165)]!==undefined&&(_0x1f26d6[_0x2a7f01(0x165)]=_0xf76c3f['customerCountry']||null);_0xf76c3f[_0x2a7f01(0x20f)]!==undefined&&(_0x1f26d6[_0x2a7f01(0x20f)]=_0xf76c3f[_0x2a7f01(0x20f)]||null);_0xf76c3f['customerUa']!==undefined&&(_0x1f26d6[_0x2a7f01(0x183)]=_0xf76c3f[_0x2a7f01(0x183)]||null);const _0x3ad485=await database_1[_0x2a7f01(0x246)][_0x2a7f01(0x1c4)][_0x2a7f01(0x1ce)]({'where':{'id':_0x452aff},'data':{..._0x1f26d6,'updatedAt':new Date()},'select':{'id':!![],'customerEmail':!![],'customerName':!![],'customerCountry':!![],'customerIp':!![],'customerUa':!![],'updatedAt':!![]}});return console[_0x2a7f01(0x15b)](_0x2a7f01(0x1da)+_0x452aff),console[_0x2a7f01(0x15b)](_0x2a7f01(0x1cf)+_0x2cace9['customerCountry']+_0x2a7f01(0x238)+_0x3ad485['customerCountry']),console[_0x2a7f01(0x15b)](_0x2a7f01(0x11f)+_0x2cace9[_0x2a7f01(0x20f)]+'\x20->\x20'+_0x3ad485[_0x2a7f01(0x20f)]),console['log'](_0x2a7f01(0x141)+(_0x2cace9['customerUa']?_0x2a7f01(0x1ac):'not\x20set')+_0x2a7f01(0x238)+(_0x3ad485[_0x2a7f01(0x183)]?_0x2a7f01(0x1ac):'not\x20set')),_0x3ad485;}async['getSystemStatistics'](_0x3d634d){const _0x1d0ba9=a38_0x5bb281,_0x571b73=new Date();let _0x5d423b;switch(_0x3d634d[_0x1d0ba9(0x159)]()){case'day':_0x5d423b=new Date(_0x571b73[_0x1d0ba9(0x124)](),_0x571b73[_0x1d0ba9(0x19a)](),_0x571b73['getDate'](),0x0,0x0,0x0,0x0);break;case _0x1d0ba9(0x1df):const _0x52ea44=new Date(_0x571b73);_0x52ea44['setDate'](_0x52ea44['getDate']()-0x1),_0x5d423b=new Date(_0x52ea44['getFullYear'](),_0x52ea44['getMonth'](),_0x52ea44[_0x1d0ba9(0x122)](),0x0,0x0,0x0,0x0);break;case'7d':_0x5d423b=new Date(_0x571b73[_0x1d0ba9(0x1a5)]()-0x7*0x18*0x3c*0x3c*0x3e8);break;case _0x1d0ba9(0x24b):_0x5d423b=new Date(_0x571b73[_0x1d0ba9(0x1a5)]()-0x1e*0x18*0x3c*0x3c*0x3e8);break;case _0x1d0ba9(0x1c2):_0x5d423b=new Date(_0x571b73['getTime']()-0x5a*0x18*0x3c*0x3c*0x3e8);break;case _0x1d0ba9(0x13a):const _0x3c6d97=await database_1[_0x1d0ba9(0x246)]['payment'][_0x1d0ba9(0x1dc)]({'where':{'gateway':{'not':'test_gateway'}},'orderBy':{'createdAt':_0x1d0ba9(0x1e5)},'select':{'createdAt':!![]}});_0x5d423b=_0x3c6d97?_0x3c6d97['createdAt']:new Date(_0x1d0ba9(0x200));break;default:_0x5d423b=new Date(_0x571b73[_0x1d0ba9(0x1a5)]()-0x1e*0x18*0x3c*0x3c*0x3e8);}_0x5d423b[_0x1d0ba9(0x135)](0x0,0x0,0x0,0x0);let _0x9c9e9c;if(_0x3d634d[_0x1d0ba9(0x159)]()===_0x1d0ba9(0x1df)){const _0x48a12f=new Date(_0x571b73);_0x48a12f['setDate'](_0x48a12f[_0x1d0ba9(0x122)]()-0x1),_0x9c9e9c=new Date(_0x48a12f[_0x1d0ba9(0x124)](),_0x48a12f['getMonth'](),_0x48a12f[_0x1d0ba9(0x122)](),0x17,0x3b,0x3b,0x3e7);}const _0x44b49a={'gte':_0x5d423b};_0x9c9e9c&&(_0x44b49a[_0x1d0ba9(0x144)]=_0x9c9e9c);const [_0x101e6b,_0xecb0c2,_0x3b4ff7,_0x4778ce,_0x5bcb25,_0x51ddb9]=await Promise[_0x1d0ba9(0x13a)]([database_1[_0x1d0ba9(0x246)]['shop'][_0x1d0ba9(0x1ed)](),database_1[_0x1d0ba9(0x246)]['shop'][_0x1d0ba9(0x1ed)]({'where':{'status':_0x1d0ba9(0x1fb)}}),database_1[_0x1d0ba9(0x246)][_0x1d0ba9(0x1c4)]['count']({'where':{'status':_0x1d0ba9(0x1cc),'createdAt':_0x44b49a,'gateway':{'not':_0x1d0ba9(0x25d)}}}),database_1['default'][_0x1d0ba9(0x1c4)]['findMany']({'where':{'status':_0x1d0ba9(0x1cc),'createdAt':_0x44b49a,'gateway':{'not':_0x1d0ba9(0x25d)}},'select':{'amount':!![],'currency':!![],'amountAfterGatewayCommissionUSDT':!![]}}),database_1[_0x1d0ba9(0x246)][_0x1d0ba9(0x1c4)][_0x1d0ba9(0x17c)]({'where':{'gateway':{'not':_0x1d0ba9(0x25d)}},'take':0xa,'orderBy':{'createdAt':_0x1d0ba9(0x1bf)},'include':{'shop':{'select':{'name':!![],'username':!![]}}}}),database_1[_0x1d0ba9(0x246)][_0x1d0ba9(0x1c4)][_0x1d0ba9(0x17c)]({'where':{'createdAt':_0x44b49a,'gateway':{'not':_0x1d0ba9(0x25d)}},'select':{'amount':!![],'currency':!![],'status':!![],'amountUSDT':!![],'createdAt':!![]}})]);let _0x19dd61=0x0,_0x10a578=0x0;for(const _0x2339b2 of _0x4778ce){const _0x4d8969=await currencyService_1[_0x1d0ba9(0x1a2)][_0x1d0ba9(0x1be)](_0x2339b2[_0x1d0ba9(0x25c)],_0x2339b2['currency']);_0x19dd61+=_0x4d8969;if(_0x2339b2[_0x1d0ba9(0x1ca)]){const _0x1250a4=await currencyService_1[_0x1d0ba9(0x1a2)][_0x1d0ba9(0x1be)](_0x2339b2[_0x1d0ba9(0x25c)],_0x2339b2[_0x1d0ba9(0x23e)]),_0x217bfc=_0x2339b2[_0x1d0ba9(0x1ca)],_0x13db97=_0x1250a4-_0x217bfc;_0x10a578+=_0x13db97;}}const _0x4a1b9d=_0x3b4ff7>0x0?_0x19dd61/_0x3b4ff7:0x0,_0x3e5359=this[_0x1d0ba9(0x1e8)](_0x51ddb9,_0x5d423b,_0x9c9e9c||_0x571b73),_0x11c205=await database_1['default'][_0x1d0ba9(0x1c4)]['count']({'where':{'createdAt':_0x44b49a,'gateway':{'not':_0x1d0ba9(0x25d)}}}),_0x254616=_0x11c205>0x0?_0x3b4ff7/_0x11c205*0x64:0x0;return{'totalShops':_0x101e6b,'activeShops':_0xecb0c2,'totalPayments':_0x3b4ff7,'successfulPayments':_0x3b4ff7,'totalAttempts':_0x11c205,'totalRevenue':Math[_0x1d0ba9(0x20e)](_0x19dd61*0x64)/0x64,'trapayEarnings':Math[_0x1d0ba9(0x20e)](_0x10a578*0x64)/0x64,'averagePaymentAmount':Math['round'](_0x4a1b9d*0x64)/0x64,'conversionRate':Math[_0x1d0ba9(0x20e)](_0x254616*0x64)/0x64,'dailyRevenue':_0x3e5359[_0x1d0ba9(0x221)],'dailyPayments':_0x3e5359['dailyPayments'],'recentPayments':_0x5bcb25['map'](_0x269fe1=>({'id':_0x269fe1['id'],'amount':_0x269fe1['amount'],'currency':_0x269fe1[_0x1d0ba9(0x23e)],'status':_0x269fe1[_0x1d0ba9(0x1b8)],'gateway':_0x269fe1['gateway'],'shop':_0x269fe1[_0x1d0ba9(0x140)],'createdAt':_0x269fe1[_0x1d0ba9(0x14a)]}))};}async['getMerchantStatistics'](_0x3db3d5){const _0x5ee501=a38_0x5bb281;console[_0x5ee501(0x15b)](_0x5ee501(0x22f),_0x3db3d5);let _0x3ece3f,_0x9fc0f7=new Date();if(_0x3db3d5['period']===_0x5ee501(0x201)&&_0x3db3d5[_0x5ee501(0x138)]&&_0x3db3d5[_0x5ee501(0x1c7)])_0x3ece3f=new Date(_0x3db3d5[_0x5ee501(0x138)]),_0x9fc0f7=new Date(_0x3db3d5[_0x5ee501(0x1c7)]),_0x3ece3f[_0x5ee501(0x135)](0x0,0x0,0x0,0x0),_0x9fc0f7[_0x5ee501(0x135)](0x17,0x3b,0x3b,0x3e7);else{const _0x3dcd69=new Date();switch(_0x3db3d5[_0x5ee501(0x202)]){case'week':_0x3ece3f=new Date(_0x3dcd69['getTime']()-0x7*0x18*0x3c*0x3c*0x3e8);break;case _0x5ee501(0x18e):_0x3ece3f=new Date(_0x3dcd69['getTime']()-0x1e*0x18*0x3c*0x3c*0x3e8);break;case _0x5ee501(0x1d3):_0x3ece3f=new Date(_0x3dcd69['getTime']()-0x16d*0x18*0x3c*0x3c*0x3e8);break;case _0x5ee501(0x13a):default:_0x3ece3f=new Date(_0x5ee501(0x200));break;}_0x3ece3f[_0x5ee501(0x135)](0x0,0x0,0x0,0x0),_0x9fc0f7['setHours'](0x17,0x3b,0x3b,0x3e7);}console[_0x5ee501(0x15b)](_0x5ee501(0x185)+_0x3ece3f[_0x5ee501(0x224)]()+_0x5ee501(0x175)+_0x9fc0f7['toISOString']());const _0x3c42e3={'status':_0x5ee501(0x1cc),'gateway':{'not':_0x5ee501(0x25d)},'paidAt':{'gte':_0x3ece3f,'lte':_0x9fc0f7}};_0x3db3d5[_0x5ee501(0x11b)]&&(_0x3c42e3[_0x5ee501(0x11b)]=_0x3db3d5[_0x5ee501(0x11b)]);const _0x553759=await database_1[_0x5ee501(0x246)][_0x5ee501(0x1c4)][_0x5ee501(0x17c)]({'where':_0x3c42e3,'select':{'id':!![],'amount':!![],'currency':!![],'amountUSDT':!![],'amountAfterGatewayCommissionUSDT':!![],'gatewayCommissionRate':!![],'gateway':!![],'shopId':!![],'paidAt':!![],'shop':{'select':{'id':!![],'name':!![],'username':!![],'gatewaySettings':!![]}}}});console[_0x5ee501(0x15b)](_0x5ee501(0x1f7)+_0x553759[_0x5ee501(0x1e6)]+_0x5ee501(0x20c));const _0x54f9d5={'gateway':{'not':_0x5ee501(0x25d)},'createdAt':{'gte':_0x3ece3f,'lte':_0x9fc0f7}};_0x3db3d5[_0x5ee501(0x11b)]&&(_0x54f9d5['shopId']=_0x3db3d5['shopId']);const _0x5bd198=await database_1[_0x5ee501(0x246)][_0x5ee501(0x1c4)][_0x5ee501(0x1ed)]({'where':_0x54f9d5});console[_0x5ee501(0x15b)]('📊\x20Total\x20payments\x20(including\x20failed):\x20'+_0x5bd198+_0x5ee501(0x1e2)+_0x553759['length']);let _0x4a1687=0x0,_0x9516fe=0x0,_0x4038cf=0x0;const _0x50c533={},_0x2d3c48={},_0x2fe2ae={};for(const _0x4e61b7 of _0x553759){try{const _0x10b9b4=_0x4e61b7['amountUSDT']||0x0;if(_0x10b9b4<=0x0){console['warn'](_0x5ee501(0x148)+_0x4e61b7['id']+_0x5ee501(0x24c));continue;}let _0x41ee4f,_0x53a92e;if(_0x4e61b7['amountAfterGatewayCommissionUSDT']!==null&&_0x4e61b7[_0x5ee501(0x1ca)]!==undefined)_0x41ee4f=_0x4e61b7['amountAfterGatewayCommissionUSDT'],_0x53a92e=_0x10b9b4-_0x41ee4f,console[_0x5ee501(0x15b)](_0x5ee501(0x1c5)+_0x4e61b7['id']+':\x20'+_0x10b9b4[_0x5ee501(0x25e)](0x6)+_0x5ee501(0x153)+_0x41ee4f[_0x5ee501(0x25e)](0x6)+_0x5ee501(0x230));else{let _0x163527={};if(_0x4e61b7['shop'][_0x5ee501(0x128)])try{_0x163527=JSON[_0x5ee501(0x236)](_0x4e61b7[_0x5ee501(0x140)][_0x5ee501(0x128)]);}catch(_0x1fa767){console[_0x5ee501(0x18f)](_0x5ee501(0x22d)+_0x4e61b7['shopId']+':',_0x1fa767);}let _0x408816=0x2d;for(const [_0xa7c303,_0x10570b]of Object[_0x5ee501(0x234)](_0x163527)){if(_0xa7c303[_0x5ee501(0x159)]()===_0x4e61b7[_0x5ee501(0x137)][_0x5ee501(0x159)]()){_0x408816=_0x10570b[_0x5ee501(0x151)]||0x2d;break;}}_0x53a92e=_0x10b9b4*(_0x408816/0x64),_0x41ee4f=_0x10b9b4-_0x53a92e,console['log'](_0x5ee501(0x25b)+_0x4e61b7['id']+':\x20'+_0x408816+_0x5ee501(0x1c8)+_0x10b9b4[_0x5ee501(0x25e)](0x6)+_0x5ee501(0x230));}_0x4a1687+=_0x10b9b4,_0x9516fe+=_0x41ee4f,_0x4038cf+=_0x53a92e;let _0x35aca4;_0x4e61b7[_0x5ee501(0x21c)]!==null&&_0x4e61b7[_0x5ee501(0x21c)]!==undefined?(_0x35aca4=_0x4e61b7[_0x5ee501(0x21c)],console['log'](_0x5ee501(0x130)+_0x4e61b7['id']+':\x20'+_0x35aca4+'%')):(_0x35aca4=_0x10b9b4>0x0?_0x53a92e/_0x10b9b4*0x64:0x0,console[_0x5ee501(0x15b)](_0x5ee501(0x19f)+_0x4e61b7['id']+':\x20'+_0x35aca4[_0x5ee501(0x25e)](0x2)+'%'));!_0x50c533[_0x4e61b7[_0x5ee501(0x137)]]&&(_0x50c533[_0x4e61b7[_0x5ee501(0x137)]]={'gateway':_0x4e61b7[_0x5ee501(0x137)],'gatewayDisplayName':this[_0x5ee501(0x18d)](_0x4e61b7['gateway']),'paymentsCount':0x0,'turnoverUSDT':0x0,'commissionUSDT':0x0,'merchantEarningsUSDT':0x0,'totalCommissionRate':0x0});_0x50c533[_0x4e61b7[_0x5ee501(0x137)]][_0x5ee501(0x226)]++,_0x50c533[_0x4e61b7[_0x5ee501(0x137)]][_0x5ee501(0x1d9)]+=_0x10b9b4,_0x50c533[_0x4e61b7[_0x5ee501(0x137)]][_0x5ee501(0x18b)]+=_0x53a92e,_0x50c533[_0x4e61b7[_0x5ee501(0x137)]]['merchantEarningsUSDT']+=_0x41ee4f,_0x50c533[_0x4e61b7['gateway']][_0x5ee501(0x24a)]+=_0x35aca4;!_0x3db3d5[_0x5ee501(0x11b)]&&(!_0x2d3c48[_0x4e61b7[_0x5ee501(0x11b)]]&&(_0x2d3c48[_0x4e61b7[_0x5ee501(0x11b)]]={'shopId':_0x4e61b7[_0x5ee501(0x11b)],'shopName':_0x4e61b7['shop'][_0x5ee501(0x1dd)],'shopUsername':_0x4e61b7[_0x5ee501(0x140)][_0x5ee501(0x189)],'paymentsCount':0x0,'turnoverUSDT':0x0,'commissionUSDT':0x0,'merchantEarningsUSDT':0x0,'paidOutUSDT':0x0,'averageCheckUSDT':0x0}),_0x2d3c48[_0x4e61b7[_0x5ee501(0x11b)]][_0x5ee501(0x226)]++,_0x2d3c48[_0x4e61b7[_0x5ee501(0x11b)]][_0x5ee501(0x1d9)]+=_0x10b9b4,_0x2d3c48[_0x4e61b7['shopId']][_0x5ee501(0x18b)]+=_0x53a92e,_0x2d3c48[_0x4e61b7[_0x5ee501(0x11b)]]['merchantEarningsUSDT']+=_0x41ee4f);const _0x4e14ef=_0x4e61b7['paidAt']['toISOString']()['split']('T')[0x0];!_0x2fe2ae[_0x4e14ef]&&(_0x2fe2ae[_0x4e14ef]={'date':_0x4e14ef,'turnover':0x0,'merchantEarnings':0x0,'gatewayEarnings':0x0,'paymentsCount':0x0}),_0x2fe2ae[_0x4e14ef][_0x5ee501(0x14d)]+=_0x10b9b4,_0x2fe2ae[_0x4e14ef][_0x5ee501(0x1f0)]+=_0x41ee4f,_0x2fe2ae[_0x4e14ef][_0x5ee501(0x1ea)]+=_0x53a92e,_0x2fe2ae[_0x4e14ef]['paymentsCount']++;}catch(_0x3fba08){console[_0x5ee501(0x18f)]('Error\x20processing\x20payment\x20'+_0x4e61b7['id']+':',_0x3fba08);}}Object[_0x5ee501(0x211)](_0x50c533)['forEach'](_0x58400f=>{const _0x5a153a=_0x5ee501;_0x58400f[_0x5a153a(0x21b)]=_0x58400f[_0x5a153a(0x226)]>0x0?_0x58400f[_0x5a153a(0x24a)]/_0x58400f[_0x5a153a(0x226)]:0x0,delete _0x58400f[_0x5a153a(0x24a)];}),Object[_0x5ee501(0x211)](_0x2d3c48)[_0x5ee501(0x256)](_0x1ac56f=>{const _0xd2472c=_0x5ee501;_0x1ac56f[_0xd2472c(0x215)]=_0x1ac56f[_0xd2472c(0x226)]>0x0?_0x1ac56f[_0xd2472c(0x1d9)]/_0x1ac56f['paymentsCount']:0x0;});let _0x1d1c9a=0x0,_0x391a73=0x0;if(_0x3db3d5[_0x5ee501(0x11b)]){const _0x1c92e4=await database_1['default'][_0x5ee501(0x1c9)][_0x5ee501(0x17c)]({'where':{'shopId':_0x3db3d5['shopId'],'status':_0x5ee501(0x1e7),'createdAt':{'gte':_0x3ece3f,'lte':_0x9fc0f7}},'select':{'amount':!![]}});_0x1d1c9a=_0x1c92e4[_0x5ee501(0x14c)]((_0x2e97b4,_0x5ae7b8)=>_0x2e97b4+_0x5ae7b8[_0x5ee501(0x25c)],0x0);const _0x3c8b44=await database_1[_0x5ee501(0x246)][_0x5ee501(0x1c9)][_0x5ee501(0x17c)]({'where':{'shopId':_0x3db3d5[_0x5ee501(0x11b)],'status':_0x5ee501(0x13d),'createdAt':{'gte':_0x3ece3f,'lte':_0x9fc0f7}},'select':{'amount':!![]}});_0x391a73=_0x3c8b44[_0x5ee501(0x14c)]((_0x6cfe9c,_0x2e0c0e)=>_0x6cfe9c+_0x2e0c0e[_0x5ee501(0x25c)],0x0);}const _0x31280e=_0x5bd198,_0x3a3b56=_0x553759[_0x5ee501(0x1e6)],_0x300e9f=_0x3a3b56>0x0?_0x4a1687/_0x3a3b56:0x0,_0x389cd2=_0x31280e>0x0?Math['round'](_0x3a3b56/_0x31280e*0x2710)/0x64:0x0,_0x50d2cb=Math[_0x5ee501(0x1f5)]((_0x9fc0f7[_0x5ee501(0x1a5)]()-_0x3ece3f[_0x5ee501(0x1a5)]())/(0x3e8*0x3c*0x3c*0x18)),_0x3ea9c8={'totalTurnover':Math[_0x5ee501(0x20e)](_0x4a1687*0x64)/0x64,'merchantEarnings':Math['round'](_0x9516fe*0x64)/0x64,'gatewayEarnings':Math[_0x5ee501(0x20e)](_0x4038cf*0x64)/0x64,'totalPaidOut':Math[_0x5ee501(0x20e)](_0x1d1c9a*0x64)/0x64,'pendingPayout':Math[_0x5ee501(0x20e)](_0x391a73*0x64)/0x64,'averageCheck':Math[_0x5ee501(0x20e)](_0x300e9f*0x64)/0x64,'totalPayments':_0x31280e,'successfulPayments':_0x3a3b56,'conversionRate':_0x389cd2,'gatewayBreakdown':Object['values'](_0x50c533)[_0x5ee501(0x163)](_0x147d45=>({..._0x147d45,'turnoverUSDT':Math[_0x5ee501(0x20e)](_0x147d45['turnoverUSDT']*0x64)/0x64,'commissionUSDT':Math[_0x5ee501(0x20e)](_0x147d45[_0x5ee501(0x18b)]*0x64)/0x64,'merchantEarningsUSDT':Math[_0x5ee501(0x20e)](_0x147d45['merchantEarningsUSDT']*0x64)/0x64,'averageCommissionRate':Math['round'](_0x147d45['averageCommissionRate']*0x64)/0x64})),'merchantBreakdown':_0x3db3d5[_0x5ee501(0x11b)]?undefined:Object[_0x5ee501(0x211)](_0x2d3c48)[_0x5ee501(0x163)](_0x13d7b0=>({..._0x13d7b0,'turnoverUSDT':Math[_0x5ee501(0x20e)](_0x13d7b0[_0x5ee501(0x1d9)]*0x64)/0x64,'commissionUSDT':Math[_0x5ee501(0x20e)](_0x13d7b0[_0x5ee501(0x18b)]*0x64)/0x64,'merchantEarningsUSDT':Math[_0x5ee501(0x20e)](_0x13d7b0[_0x5ee501(0x20b)]*0x64)/0x64,'paidOutUSDT':Math[_0x5ee501(0x20e)](_0x13d7b0['paidOutUSDT']*0x64)/0x64,'averageCheckUSDT':Math['round'](_0x13d7b0[_0x5ee501(0x215)]*0x64)/0x64})),'dailyData':Object[_0x5ee501(0x211)](_0x2fe2ae)['map'](_0x5752b7=>({..._0x5752b7,'turnover':Math['round'](_0x5752b7[_0x5ee501(0x14d)]*0x64)/0x64,'merchantEarnings':Math[_0x5ee501(0x20e)](_0x5752b7['merchantEarnings']*0x64)/0x64,'gatewayEarnings':Math[_0x5ee501(0x20e)](_0x5752b7[_0x5ee501(0x1ea)]*0x64)/0x64}))[_0x5ee501(0x17a)]((_0x2c0296,_0x12b406)=>_0x2c0296[_0x5ee501(0x1d7)][_0x5ee501(0x16a)](_0x12b406['date'])),'periodInfo':{'from':_0x3ece3f,'to':_0x9fc0f7,'periodType':_0x3db3d5[_0x5ee501(0x202)]||_0x5ee501(0x201),'daysCount':_0x50d2cb}};return console[_0x5ee501(0x15b)](_0x5ee501(0x16c)),console[_0x5ee501(0x15b)](_0x5ee501(0x168)+_0x3ea9c8[_0x5ee501(0x223)]+_0x5ee501(0x230)),console[_0x5ee501(0x15b)](_0x5ee501(0x126)+_0x3ea9c8[_0x5ee501(0x1f0)]+_0x5ee501(0x230)),console['log'](_0x5ee501(0x22a)+_0x3ea9c8[_0x5ee501(0x1ea)]+'\x20USDT'),console[_0x5ee501(0x15b)]('\x20\x20\x20�\x20Total\x20paid\x20out:\x20'+_0x3ea9c8[_0x5ee501(0x14e)]+_0x5ee501(0x230)),console[_0x5ee501(0x15b)](_0x5ee501(0x1e4)+_0x3ea9c8[_0x5ee501(0x23b)]+'\x20USDT'),console[_0x5ee501(0x15b)]('\x20\x20\x20�📊\x20Total\x20payments:\x20'+_0x3ea9c8[_0x5ee501(0x24d)]),_0x3ea9c8;}async[a38_0x5bb281(0x1b1)](){const _0x25552d=a38_0x5bb281;console['log']('📋\x20Getting\x20merchants\x20selection\x20list...');const _0x3dd3d9=await database_1[_0x25552d(0x246)]['shop'][_0x25552d(0x17c)]({'where':{'status':_0x25552d(0x1fb)},'select':{'id':!![],'username':!![],'name':!![]},'orderBy':{'name':'asc'}});return console[_0x25552d(0x15b)]('📋\x20Found\x20'+_0x3dd3d9[_0x25552d(0x1e6)]+_0x25552d(0x154)),_0x3dd3d9[_0x25552d(0x163)](_0x32f9aa=>({'id':_0x32f9aa['id'],'username':_0x32f9aa['username'],'name':_0x32f9aa[_0x25552d(0x1dd)]}));}[a38_0x5bb281(0x18d)](_0x49c392){const _0x35f572=a38_0x5bb281,_0x46327d={'test_gateway':_0x35f572(0x15c),'plisio':'Plisio','rapyd':_0x35f572(0x220),'noda':_0x35f572(0x1f9),'cointopay':_0x35f572(0x17d),'cointopay2':'Open\x20Banking\x202','klyme_eu':'KLYME\x20EU','klyme_gb':_0x35f572(0x1a6),'klyme_de':_0x35f572(0x21f),'mastercard':_0x35f572(0x157)};return _0x46327d[_0x49c392]||_0x49c392;}[a38_0x5bb281(0x227)](_0x13ae6e){const _0x409899=a38_0x5bb281,_0xf29aad={'Test\x20Gateway':_0x409899(0x25d),'Plisio':_0x409899(0x161),'Rapyd':_0x409899(0x1b4),'Noda':'noda','CoinToPay':_0x409899(0x24e),'CoinToPay2':_0x409899(0x166),'KLYME\x20EU':_0x409899(0x25f),'KLYME\x20GB':_0x409899(0x199),'KLYME\x20DE':_0x409899(0x12a),'MasterCard':'mastercard'};return _0xf29aad[_0x13ae6e]||_0x13ae6e[_0x409899(0x159)]();}async[a38_0x5bb281(0x258)](_0x5e7829){const _0x21db8e=a38_0x5bb281,{page:_0x49e6ba,limit:_0x5a7db3,minAmount:_0xd2536c,search:_0x54b532}=_0x5e7829,_0x341f81=(_0x49e6ba-0x1)*_0x5a7db3;console[_0x21db8e(0x15b)](_0x21db8e(0x1f2),_0x5e7829);const _0x417be8={'balance':{'gt':0x0},'status':_0x21db8e(0x1fb)};_0xd2536c&&(_0x417be8[_0x21db8e(0x1b7)][_0x21db8e(0x1b2)]=_0xd2536c);_0x54b532&&(_0x417be8[_0x21db8e(0x1dd)]={'contains':_0x54b532,'mode':_0x21db8e(0x209)});const [_0xd62f45,_0x387afb]=await Promise['all']([database_1[_0x21db8e(0x246)][_0x21db8e(0x140)][_0x21db8e(0x17c)]({'where':_0x417be8,'skip':_0x341f81,'take':_0x5a7db3,'orderBy':{'balance':_0x21db8e(0x1bf)},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'balance':!![],'totalPaidOut':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'gatewaySettings':!![],'createdAt':!![]}}),database_1[_0x21db8e(0x246)][_0x21db8e(0x140)][_0x21db8e(0x1ed)]({'where':_0x417be8})]);console[_0x21db8e(0x15b)]('💰\x20Found\x20'+_0xd62f45[_0x21db8e(0x1e6)]+_0x21db8e(0x1b5));const _0x2bd30e=await Promise[_0x21db8e(0x13a)](_0xd62f45[_0x21db8e(0x163)](async _0x155cd7=>{const _0x43dbef=_0x21db8e,[_0x210277,_0x328155,_0x3b5dd8]=await Promise[_0x43dbef(0x13a)]([database_1['default']['payment']['count']({'where':{'shopId':_0x155cd7['id'],'status':'PAID','gateway':{'not':_0x43dbef(0x25d)}}}),database_1[_0x43dbef(0x246)]['payment'][_0x43dbef(0x1dc)]({'where':{'shopId':_0x155cd7['id'],'status':'PAID','gateway':{'not':_0x43dbef(0x25d)}},'orderBy':{'paidAt':_0x43dbef(0x1e5)},'select':{'paidAt':!![]}}),database_1[_0x43dbef(0x246)]['payment'][_0x43dbef(0x25a)]({'by':['gateway'],'where':{'shopId':_0x155cd7['id'],'status':'PAID','gateway':{'not':_0x43dbef(0x25d)}},'_count':{'id':!![]},'_sum':{'amountUSDT':!![]}})]),_0x2689a2=new Date(),_0x4f9eed=new Date(_0x2689a2[_0x43dbef(0x124)](),_0x2689a2[_0x43dbef(0x19a)](),0x1),_0x4121c9=new Date(_0x2689a2[_0x43dbef(0x124)](),_0x2689a2[_0x43dbef(0x19a)]()+0x1,0x0,0x17,0x3b,0x3b,0x3e7),[_0x46a13f,_0x201701]=await Promise['all']([database_1['default'][_0x43dbef(0x1c9)][_0x43dbef(0x156)]({'_sum':{'amount':!![]},'where':{'shopId':_0x155cd7['id'],'status':_0x43dbef(0x1e7)}}),database_1[_0x43dbef(0x246)][_0x43dbef(0x1c9)][_0x43dbef(0x156)]({'_sum':{'amount':!![]},'where':{'shopId':_0x155cd7['id'],'status':_0x43dbef(0x1e7),'createdAt':{'gte':_0x4f9eed,'lte':_0x4121c9}}})]),_0x973ada=_0x46a13f[_0x43dbef(0x19d)]['amount']||0x0,_0x30e2c7=_0x201701['_sum'][_0x43dbef(0x25c)]||0x0,_0xe0e9ac=await Promise['all'](_0x3b5dd8[_0x43dbef(0x163)](async _0x377116=>{const _0x34c1f3=_0x43dbef;let _0x149507=0x2d;if(_0x155cd7[_0x34c1f3(0x128)])try{const _0x345fb6=JSON[_0x34c1f3(0x236)](_0x155cd7[_0x34c1f3(0x128)]);for(const [_0x5ca559,_0x254609]of Object['entries'](_0x345fb6)){if(_0x5ca559[_0x34c1f3(0x159)]()===_0x377116[_0x34c1f3(0x137)][_0x34c1f3(0x159)]()){_0x149507=_0x254609['commission']||0xa,console[_0x34c1f3(0x15b)]('💰\x20[PAYOUT]\x20Gateway\x20'+_0x377116[_0x34c1f3(0x137)]+_0x34c1f3(0x206)+_0x155cd7['id']+_0x34c1f3(0x251)+_0x149507+'%');break;}}}catch(_0x126fad){console[_0x34c1f3(0x18f)](_0x34c1f3(0x22d)+_0x155cd7['id']+':',_0x126fad);}const _0x1f639d=_0x377116['_sum']?.[_0x34c1f3(0x15d)]||0x0,_0x3799cf=_0x1f639d*(0x1-_0x149507/0x64);return{'gateway':_0x377116[_0x34c1f3(0x137)],'count':_0x377116[_0x34c1f3(0x1ff)]?.['id']||0x0,'amountUSDT':Math[_0x34c1f3(0x20e)](_0x1f639d*0x64)/0x64,'amountAfterCommissionUSDT':Math[_0x34c1f3(0x20e)](_0x3799cf*0x64)/0x64,'commission':_0x149507};})),_0x5778c0=_0xe0e9ac[_0x43dbef(0x14c)]((_0x57edb5,_0x5bf857)=>_0x57edb5+_0x5bf857['amountUSDT'],0x0),_0x409bd9=_0xe0e9ac[_0x43dbef(0x14c)]((_0x23586c,_0x43da6b)=>_0x23586c+_0x43da6b[_0x43dbef(0x1ab)],0x0),_0x3aadf6=_0x155cd7[_0x43dbef(0x1b7)];return console[_0x43dbef(0x15b)]('💰\x20[PAYOUT]\x20Merchant\x20'+_0x155cd7[_0x43dbef(0x189)]+':'),console[_0x43dbef(0x15b)](_0x43dbef(0x218)+_0x5778c0['toFixed'](0x2)+'\x20USDT\x20(gross\x20revenue)'),console[_0x43dbef(0x15b)](_0x43dbef(0x243)+_0x409bd9[_0x43dbef(0x25e)](0x2)+_0x43dbef(0x1cb)),console['log'](_0x43dbef(0x205)+_0x3aadf6[_0x43dbef(0x25e)](0x2)+'\x20USDT\x20(current\x20balance\x20in\x20DB)'),console[_0x43dbef(0x15b)](_0x43dbef(0x261)+_0x973ada[_0x43dbef(0x25e)](0x2)+_0x43dbef(0x149)),console[_0x43dbef(0x15b)](_0x43dbef(0x167)+(_0x409bd9-_0x973ada-_0x3aadf6)[_0x43dbef(0x25e)](0x2)+_0x43dbef(0x1c6)),{'id':_0x155cd7['id'],'fullName':_0x155cd7['name'],'username':_0x155cd7[_0x43dbef(0x189)],'telegramId':_0x155cd7['telegram'],'merchantUrl':_0x155cd7[_0x43dbef(0x23c)],'wallets':{'usdtPolygonWallet':_0x155cd7['usdtPolygonWallet'],'usdtTrcWallet':_0x155cd7[_0x43dbef(0x194)],'usdtErcWallet':_0x155cd7[_0x43dbef(0x207)],'usdcPolygonWallet':_0x155cd7[_0x43dbef(0x204)]},'totalAmountUSDT':Math[_0x43dbef(0x20e)](_0x5778c0*0x64)/0x64,'totalAmountAfterCommissionUSDT':Math[_0x43dbef(0x20e)](_0x409bd9*0x64)/0x64,'currentBalance':Math['round'](_0x3aadf6*0x64)/0x64,'totalPayout':Math[_0x43dbef(0x20e)](_0x973ada*0x64)/0x64,'thisMonth':Math['round'](_0x30e2c7*0x64)/0x64,'paymentsCount':_0x210277,'oldestPaymentDate':_0x328155?.['paidAt']||_0x155cd7[_0x43dbef(0x14a)],'gatewayBreakdown':_0xe0e9ac};})),_0xbc1db6=_0x2bd30e['reduce']((_0x56e897,_0x2437ea)=>_0x56e897+_0x2437ea[_0x21db8e(0x121)],0x0),_0x3fd5b6=_0x2bd30e['reduce']((_0x318675,_0x18c9d7)=>_0x318675+_0x18c9d7[_0x21db8e(0x1e9)],0x0),_0x1f558d=_0x2bd30e[_0x21db8e(0x14c)]((_0x5ba504,_0x1ff2fd)=>_0x5ba504+_0x1ff2fd[_0x21db8e(0x12e)],0x0),_0x2fc8ed=_0x2bd30e[_0x21db8e(0x14c)]((_0x51fdfe,_0x2cebff)=>_0x51fdfe+_0x2cebff[_0x21db8e(0x178)],0x0);return console['log'](_0x21db8e(0x1ba)+_0x387afb+_0x21db8e(0x18a)),console[_0x21db8e(0x15b)](_0x21db8e(0x120)+Math[_0x21db8e(0x20e)](_0xbc1db6*0x64)/0x64+_0x21db8e(0x172)),console[_0x21db8e(0x15b)](_0x21db8e(0x129)+Math[_0x21db8e(0x20e)](_0x3fd5b6*0x64)/0x64+_0x21db8e(0x12f)),console[_0x21db8e(0x15b)](_0x21db8e(0x182)+Math[_0x21db8e(0x20e)](_0x1f558d*0x64)/0x64+'\x20USDT'),console[_0x21db8e(0x15b)](_0x21db8e(0x214)+Math[_0x21db8e(0x20e)](_0x2fc8ed*0x64)/0x64+_0x21db8e(0x230)),{'merchants':_0x2bd30e,'pagination':{'page':_0x49e6ba,'limit':_0x5a7db3,'total':_0x387afb,'totalPages':Math[_0x21db8e(0x1f5)](_0x387afb/_0x5a7db3)},'summary':{'totalMerchants':_0x387afb,'totalAmountUSDT':Math[_0x21db8e(0x20e)](_0xbc1db6*0x64)/0x64,'totalAmountAfterCommissionUSDT':Math[_0x21db8e(0x20e)](_0x3fd5b6*0x64)/0x64,'totalPayout':Math[_0x21db8e(0x20e)](_0x1f558d*0x64)/0x64,'thisMonth':Math[_0x21db8e(0x20e)](_0x2fc8ed*0x64)/0x64}};}async['createPayout'](_0x26f3e9){const _0x5c5b7e=a38_0x5bb281,{shopId:_0x298fd0,amount:_0xe0db9e,network:_0x5e1a80,wallet:_0x3f68fc,notes:_0x18d276,txid:_0x439417,periodFrom:_0x3cc59f,periodTo:_0x1206c3}=_0x26f3e9,_0xa862cd=await database_1[_0x5c5b7e(0x246)][_0x5c5b7e(0x11e)](async _0x1a8eff=>{const _0x449f49=_0x5c5b7e,_0x35b60c=await _0x1a8eff[_0x449f49(0x140)]['findUnique']({'where':{'id':_0x298fd0},'select':{'id':!![],'name':!![],'username':!![],'balance':!![],'totalPaidOut':!![]}});if(!_0x35b60c)throw new Error(_0x449f49(0x22b));console[_0x449f49(0x15b)](_0x449f49(0x134)+_0x35b60c[_0x449f49(0x189)]+':'),console[_0x449f49(0x15b)]('\x20\x20\x20Current\x20balance:\x20'+_0x35b60c[_0x449f49(0x1b7)][_0x449f49(0x25e)](0x6)+_0x449f49(0x230)),console['log'](_0x449f49(0x17f)+_0xe0db9e[_0x449f49(0x25e)](0x6)+'\x20USDT'),console[_0x449f49(0x15b)](_0x449f49(0x23a)+_0x35b60c[_0x449f49(0x14e)][_0x449f49(0x25e)](0x6)+_0x449f49(0x230));if(_0x439417)console['log'](_0x449f49(0x158)+_0x439417);if(_0x35b60c[_0x449f49(0x1b7)]<_0xe0db9e)throw new Error(_0x449f49(0x1d0)+_0x35b60c[_0x449f49(0x1b7)][_0x449f49(0x25e)](0x6)+_0x449f49(0x180)+_0xe0db9e[_0x449f49(0x25e)](0x6)+'\x20USDT');let _0x37f44a=_0x3f68fc;if(!_0x37f44a){const _0x19754a=await _0x1a8eff[_0x449f49(0x140)][_0x449f49(0x150)]({'where':{'id':_0x298fd0},'select':{'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![]}});if(_0x19754a)switch(_0x5e1a80){case _0x449f49(0x240):_0x37f44a=_0x19754a['usdtPolygonWallet']||undefined;break;case _0x449f49(0x1e0):_0x37f44a=_0x19754a['usdtTrcWallet']||undefined;break;case'erc20':_0x37f44a=_0x19754a[_0x449f49(0x207)]||undefined;break;case _0x449f49(0x203):_0x37f44a=_0x19754a[_0x449f49(0x204)]||undefined;break;}}console[_0x449f49(0x15b)](_0x449f49(0x1e1)+_0x5e1a80+':\x20'+(_0x37f44a||_0x449f49(0x1b0)));const _0x19ec1c=await _0x1a8eff['payout'][_0x449f49(0x1af)]({'data':{'shopId':_0x298fd0,'amount':_0xe0db9e,'network':_0x5e1a80,'status':_0x449f49(0x1e7),'txid':_0x439417,'notes':_0x18d276,'periodFrom':_0x3cc59f?new Date(_0x3cc59f):null,'periodTo':_0x1206c3?new Date(_0x1206c3):null,'createdAt':new Date(),'paidAt':new Date()}}),_0xdccd81=_0x35b60c[_0x449f49(0x1b7)]-_0xe0db9e,_0x485758=_0x35b60c[_0x449f49(0x14e)]+_0xe0db9e;return await _0x1a8eff[_0x449f49(0x140)][_0x449f49(0x1ce)]({'where':{'id':_0x298fd0},'data':{'balance':_0xdccd81,'totalPaidOut':_0x485758}}),console[_0x449f49(0x15b)](_0x449f49(0x242)+_0x35b60c[_0x449f49(0x189)]+_0x449f49(0x259)),console[_0x449f49(0x15b)](_0x449f49(0x18c)+_0x35b60c[_0x449f49(0x1b7)][_0x449f49(0x25e)](0x6)+_0x449f49(0x238)+_0xdccd81[_0x449f49(0x25e)](0x6)+_0x449f49(0x1c1)+_0xe0db9e['toFixed'](0x6)+')'),console[_0x449f49(0x15b)](_0x449f49(0x12d)+_0x35b60c[_0x449f49(0x14e)][_0x449f49(0x25e)](0x6)+_0x449f49(0x238)+_0x485758[_0x449f49(0x25e)](0x6)+_0x449f49(0x255)+_0xe0db9e['toFixed'](0x6)+')'),{'payout':_0x19ec1c,'shop':_0x35b60c};});return console[_0x5c5b7e(0x15b)](_0x5c5b7e(0x22e)+_0xa862cd[_0x5c5b7e(0x1c9)]['id']+_0x5c5b7e(0x206)+_0xa862cd['shop'][_0x5c5b7e(0x189)]+'\x20('+_0xe0db9e+_0x5c5b7e(0x1a8)),{'id':_0xa862cd[_0x5c5b7e(0x1c9)]['id'],'shopId':_0xa862cd[_0x5c5b7e(0x1c9)][_0x5c5b7e(0x11b)],'shopName':_0xa862cd[_0x5c5b7e(0x140)][_0x5c5b7e(0x1dd)],'shopUsername':_0xa862cd[_0x5c5b7e(0x140)][_0x5c5b7e(0x189)],'amount':_0xa862cd[_0x5c5b7e(0x1c9)][_0x5c5b7e(0x25c)],'network':_0xa862cd[_0x5c5b7e(0x1c9)][_0x5c5b7e(0x16d)],'status':_0xa862cd[_0x5c5b7e(0x1c9)][_0x5c5b7e(0x1b8)],'txid':_0xa862cd[_0x5c5b7e(0x1c9)][_0x5c5b7e(0x1d8)],'notes':_0xa862cd[_0x5c5b7e(0x1c9)][_0x5c5b7e(0x15a)],'periodFrom':_0xa862cd[_0x5c5b7e(0x1c9)][_0x5c5b7e(0x1e3)],'periodTo':_0xa862cd[_0x5c5b7e(0x1c9)][_0x5c5b7e(0x1bc)],'createdAt':_0xa862cd['payout'][_0x5c5b7e(0x14a)],'paidAt':_0xa862cd[_0x5c5b7e(0x1c9)][_0x5c5b7e(0x164)]};}async['getAllPayouts'](_0xe37e66){const _0xf8b53d=a38_0x5bb281,{page:_0x99ef6b,limit:_0x5cf45d,shopId:_0x2d8d3f,network:_0x2bb386,dateFrom:_0x373464,dateTo:_0x13bc8b,search:_0x3bf3c5}=_0xe37e66,_0xbe2d22=(_0x99ef6b-0x1)*_0x5cf45d,_0x480595={};_0x2d8d3f&&(_0x480595['shopId']=_0x2d8d3f);_0x2bb386&&(_0x480595['network']=_0x2bb386);(_0x373464||_0x13bc8b)&&(_0x480595[_0xf8b53d(0x14a)]={},_0x373464&&(_0x480595[_0xf8b53d(0x14a)][_0xf8b53d(0x1b2)]=new Date(_0x373464)),_0x13bc8b&&(_0x480595[_0xf8b53d(0x14a)][_0xf8b53d(0x144)]=new Date(_0x13bc8b)));_0x3bf3c5&&(_0x480595['OR']=[{'shop':{'name':{'contains':_0x3bf3c5,'mode':_0xf8b53d(0x209)}}},{'shop':{'username':{'contains':_0x3bf3c5,'mode':_0xf8b53d(0x209)}}},{'notes':{'contains':_0x3bf3c5,'mode':'insensitive'}}]);const [_0x369ea7,_0x3a6133]=await Promise[_0xf8b53d(0x13a)]([database_1[_0xf8b53d(0x246)][_0xf8b53d(0x1c9)][_0xf8b53d(0x17c)]({'where':_0x480595,'skip':_0xbe2d22,'take':_0x5cf45d,'orderBy':{'createdAt':'desc'},'select':{'id':!![],'shopId':!![],'amount':!![],'network':!![],'status':!![],'txid':!![],'notes':!![],'periodFrom':!![],'periodTo':!![],'createdAt':!![],'paidAt':!![],'shop':{'select':{'name':!![],'username':!![]}}}}),database_1['default']['payout'][_0xf8b53d(0x1ed)]({'where':_0x480595})]);return{'payouts':_0x369ea7[_0xf8b53d(0x163)](_0x38e5a7=>({'id':_0x38e5a7['id'],'shopId':_0x38e5a7[_0xf8b53d(0x11b)],'shopName':_0x38e5a7['shop'][_0xf8b53d(0x1dd)],'shopUsername':_0x38e5a7['shop'][_0xf8b53d(0x189)],'amount':_0x38e5a7[_0xf8b53d(0x25c)],'network':_0x38e5a7[_0xf8b53d(0x16d)],'status':_0x38e5a7[_0xf8b53d(0x1b8)],'txid':_0x38e5a7[_0xf8b53d(0x1d8)],'notes':_0x38e5a7['notes'],'periodFrom':_0x38e5a7['periodFrom'],'periodTo':_0x38e5a7['periodTo'],'createdAt':_0x38e5a7[_0xf8b53d(0x14a)],'paidAt':_0x38e5a7[_0xf8b53d(0x164)]})),'pagination':{'page':_0x99ef6b,'limit':_0x5cf45d,'total':_0x3a6133,'totalPages':Math['ceil'](_0x3a6133/_0x5cf45d)}};}async[a38_0x5bb281(0x253)](_0x10d10f){const _0x8f503a=a38_0x5bb281,_0x1b651e=await database_1[_0x8f503a(0x246)][_0x8f503a(0x1c9)][_0x8f503a(0x150)]({'where':{'id':_0x10d10f},'include':{'shop':{'select':{'name':!![],'username':!![]}}}});if(!_0x1b651e)return null;return{'id':_0x1b651e['id'],'shopId':_0x1b651e[_0x8f503a(0x11b)],'shopName':_0x1b651e[_0x8f503a(0x140)]['name'],'shopUsername':_0x1b651e[_0x8f503a(0x140)][_0x8f503a(0x189)],'amount':_0x1b651e[_0x8f503a(0x25c)],'network':_0x1b651e['network'],'status':_0x1b651e[_0x8f503a(0x1b8)],'txid':_0x1b651e['txid'],'notes':_0x1b651e[_0x8f503a(0x15a)],'periodFrom':_0x1b651e[_0x8f503a(0x1e3)],'periodTo':_0x1b651e[_0x8f503a(0x1bc)],'createdAt':_0x1b651e['createdAt'],'paidAt':_0x1b651e[_0x8f503a(0x164)]};}async[a38_0x5bb281(0x17e)](_0x1200e1){const _0x1eafa7=a38_0x5bb281;await database_1[_0x1eafa7(0x246)][_0x1eafa7(0x1c9)]['delete']({'where':{'id':_0x1200e1}});}async[a38_0x5bb281(0x143)](_0x2af6a0){const _0x176d12=a38_0x5bb281,{page:_0x2fdac0,limit:_0x50e329,status:_0xc5d535,gateway:_0x4a2590,shopId:_0xeb077a,dateFrom:_0x1e8586,dateTo:_0x58dcc1,search:_0x765db2,currency:_0x238ddc,sortBy:_0x38b50e,sortOrder:_0x503bf1}=_0x2af6a0,_0x26a6dd=(_0x2fdac0-0x1)*_0x50e329;console[_0x176d12(0x15b)](_0x176d12(0x229),_0x2af6a0);const _0x1e9fe1=await database_1[_0x176d12(0x246)][_0x176d12(0x1c4)][_0x176d12(0x25a)]({'by':['gateway'],'_count':{'gateway':!![]}});console[_0x176d12(0x15b)]('📊\x20Available\x20gateways\x20in\x20database:',_0x1e9fe1[_0x176d12(0x163)](_0x370995=>_0x370995['gateway']+'\x20('+_0x370995[_0x176d12(0x1ff)][_0x176d12(0x137)]+_0x176d12(0x1f4)));if(_0x4a2590){const _0x18eade=_0x1e9fe1[_0x176d12(0x1f8)](_0x93e211=>_0x93e211[_0x176d12(0x137)][_0x176d12(0x159)]()===_0x4a2590[_0x176d12(0x159)]());!_0x18eade&&_0x4a2590[_0x176d12(0x159)]()!==_0x176d12(0x25d)&&console[_0x176d12(0x15b)](_0x176d12(0x177)+_0x4a2590+'\x27\x20not\x20found.\x20Available\x20gateways:\x20'+_0x1e9fe1[_0x176d12(0x163)](_0x137d23=>_0x137d23[_0x176d12(0x137)])[_0x176d12(0x20d)](',\x20'));}const _0x1a7bfc={};_0xc5d535&&(_0x1a7bfc[_0x176d12(0x1b8)]=_0xc5d535[_0x176d12(0x142)]());if(!_0x4a2590)_0x1a7bfc['gateway']={'not':'test_gateway'};else{if(_0x4a2590&&(_0x4a2590[_0x176d12(0x159)]()==='test_gateway'||_0x4a2590==='0000'))_0x1a7bfc[_0x176d12(0x137)]=_0x176d12(0x25d);else{let _0x381018=_0x4a2590;const _0x314334=(0x0,gateway_1[_0x176d12(0x1a3)])(_0x4a2590);if(_0x314334)_0x381018=_0x314334,console[_0x176d12(0x15b)]('🔄\x20Converted\x20gateway\x20ID\x20\x27'+_0x4a2590+_0x176d12(0x1a9)+_0x381018+'\x27');else{const _0x273e73=(0x0,gateway_1[_0x176d12(0x213)])(_0x4a2590);if(_0x273e73){const _0x3ad05c=(0x0,gateway_1[_0x176d12(0x1a3)])(_0x273e73);_0x3ad05c&&(_0x381018=_0x3ad05c,console['log'](_0x176d12(0x1b9)+_0x4a2590+'\x27\x20->\x20ID\x20\x27'+_0x273e73+_0x176d12(0x152)+_0x381018+'\x27'));}else console[_0x176d12(0x15b)](_0x176d12(0x11c)+_0x4a2590+_0x176d12(0x210));}const _0x29bacc=await database_1[_0x176d12(0x246)][_0x176d12(0x1c4)][_0x176d12(0x1ed)]({'where':{'gateway':_0x381018[_0x176d12(0x159)]()},'take':0x1});_0x29bacc===0x0?(console['log'](_0x176d12(0x244)+_0x381018+_0x176d12(0x239)+_0x4a2590+_0x176d12(0x176)),_0x1a7bfc['gateway']=_0x176d12(0x1c3)):(_0x1a7bfc['gateway']=_0x381018[_0x176d12(0x159)](),console['log'](_0x176d12(0x1d1)+_0x381018+_0x176d12(0x239)+_0x4a2590+'\x27)'));}}console['log'](_0x176d12(0x1ad),_0x1a7bfc[_0x176d12(0x137)]);_0xeb077a&&(_0x1a7bfc[_0x176d12(0x11b)]=_0xeb077a);_0x238ddc&&(_0x1a7bfc['currency']=_0x238ddc[_0x176d12(0x142)](),console['log'](_0x176d12(0x1bb)+_0x238ddc['toUpperCase']()));(_0x1e8586||_0x58dcc1)&&(_0x1a7bfc[_0x176d12(0x14a)]={},_0x1e8586&&(_0x1a7bfc[_0x176d12(0x14a)][_0x176d12(0x1b2)]=new Date(_0x1e8586)),_0x58dcc1&&(_0x1a7bfc['createdAt'][_0x176d12(0x144)]=new Date(_0x58dcc1)));_0x765db2&&(_0x1a7bfc['OR']=[{'id':{'contains':_0x765db2,'mode':_0x176d12(0x209)}},{'orderId':{'contains':_0x765db2,'mode':'insensitive'}},{'gatewayOrderId':{'contains':_0x765db2,'mode':_0x176d12(0x209)}},{'customerEmail':{'contains':_0x765db2,'mode':_0x176d12(0x209)}},{'shop':{'name':{'contains':_0x765db2,'mode':_0x176d12(0x209)}}},{'shop':{'username':{'contains':_0x765db2,'mode':_0x176d12(0x209)}}}]);console['log'](_0x176d12(0x19b),JSON['stringify'](_0x1a7bfc,null,0x2));let _0x146830={'createdAt':'desc'};if(_0x38b50e){const _0x38c783=['amount',_0x176d12(0x14a),_0x176d12(0x145),_0x176d12(0x1b8),_0x176d12(0x137),_0x176d12(0x23e)],_0x4fa5a9=[_0x176d12(0x1e5),_0x176d12(0x1bf)];if(_0x38c783[_0x176d12(0x16e)](_0x38b50e)){const _0x37aa72=_0x4fa5a9[_0x176d12(0x16e)](_0x503bf1)?_0x503bf1:_0x176d12(0x1bf);_0x146830={[_0x38b50e]:_0x37aa72},console[_0x176d12(0x15b)](_0x176d12(0x225)+_0x38b50e+'\x20in\x20'+_0x37aa72+'\x20order');}}const [_0x2b5da7,_0x752524]=await Promise[_0x176d12(0x13a)]([database_1[_0x176d12(0x246)][_0x176d12(0x1c4)][_0x176d12(0x17c)]({'where':_0x1a7bfc,'skip':_0x26a6dd,'take':_0x50e329,'orderBy':_0x146830,'include':{'shop':{'select':{'name':!![],'username':!![]}}}}),database_1[_0x176d12(0x246)][_0x176d12(0x1c4)][_0x176d12(0x1ed)]({'where':_0x1a7bfc})]);return{'payments':_0x2b5da7,'pagination':{'page':_0x2fdac0,'limit':_0x50e329,'total':_0x752524,'totalPages':Math['ceil'](_0x752524/_0x50e329)}};}async['getPaymentById'](_0x1874c5){const _0x71ba83=a38_0x5bb281,_0x5dc0ec=await database_1[_0x71ba83(0x246)]['payment'][_0x71ba83(0x150)]({'where':{'id':_0x1874c5},'select':{'id':!![],'shopId':!![],'amount':!![],'amountAfterGatewayCommissionUSDT':!![],'currency':!![],'sourceCurrency':!![],'status':!![],'gateway':!![],'orderId':!![],'gatewayOrderId':!![],'gatewayPaymentId':!![],'customerEmail':!![],'customerName':!![],'customerCountry':!![],'customerIp':!![],'customerUa':!![],'externalPaymentUrl':!![],'successUrl':!![],'failUrl':!![],'pendingUrl':!![],'whiteUrl':!![],'expiresAt':!![],'invoiceTotalSum':!![],'qrCode':!![],'qrUrl':!![],'country':!![],'language':!![],'amountIsEditable':!![],'maxPayments':!![],'rapydCustomer':!![],'cardLast4':!![],'paymentMethod':!![],'bankId':!![],'remitterIban':!![],'remitterName':!![],'failureMessage':!![],'usage':!![],'createdAt':!![],'updatedAt':!![],'shop':{'select':{'name':!![],'username':!![]}}}});if(!_0x5dc0ec)return null;return{'id':_0x5dc0ec['id'],'shopId':_0x5dc0ec['shopId'],'gateway':_0x5dc0ec['gateway'],'amount':_0x5dc0ec['amount'],'currency':_0x5dc0ec[_0x71ba83(0x23e)],'status':_0x5dc0ec['status'],'orderId':_0x5dc0ec['orderId'],'gatewayOrderId':_0x5dc0ec['gatewayOrderId'],'customerEmail':_0x5dc0ec['customerEmail'],'customerName':_0x5dc0ec[_0x71ba83(0x12c)],'customerCountry':_0x5dc0ec[_0x71ba83(0x165)],'customerIp':_0x5dc0ec['customerIp'],'customerUa':_0x5dc0ec['customerUa'],'failureMessage':_0x5dc0ec[_0x71ba83(0x1fc)],'externalPaymentUrl':_0x5dc0ec[_0x71ba83(0x132)],'successUrl':_0x5dc0ec[_0x71ba83(0x21e)],'failUrl':_0x5dc0ec[_0x71ba83(0x184)],'pendingUrl':_0x5dc0ec['pendingUrl'],'whiteUrl':_0x5dc0ec[_0x71ba83(0x181)],'createdAt':_0x5dc0ec[_0x71ba83(0x14a)],'updatedAt':_0x5dc0ec[_0x71ba83(0x145)],'shop':_0x5dc0ec[_0x71ba83(0x140)]};}async[a38_0x5bb281(0x228)](_0x37ef95,_0x1e6285,_0x5e1971,_0x4b5b99){const _0x4b9327=a38_0x5bb281,_0x1daba8=await database_1[_0x4b9327(0x246)][_0x4b9327(0x11e)](async _0x4c15c1=>{const _0x3a1a10=_0x4b9327,_0x7b4ae7=await _0x4c15c1[_0x3a1a10(0x1c4)][_0x3a1a10(0x150)]({'where':{'id':_0x37ef95},'include':{'shop':{'select':{'id':!![],'name':!![],'username':!![],'balance':!![]}}}});if(!_0x7b4ae7)throw new Error(_0x3a1a10(0x179));const _0x3c4622=_0x7b4ae7[_0x3a1a10(0x1b8)],_0xc36f58=_0x1e6285['toUpperCase']();console['log'](_0x3a1a10(0x237)+_0x37ef95+_0x3a1a10(0x160)+_0x3c4622+_0x3a1a10(0x238)+_0xc36f58),console[_0x3a1a10(0x15b)](_0x3a1a10(0x216)+_0x7b4ae7[_0x3a1a10(0x140)][_0x3a1a10(0x1b7)]+_0x3a1a10(0x230));const _0x54ccb6={'status':_0xc36f58,'updatedAt':new Date(),'statusChangedBy':_0x3a1a10(0x15f),'statusChangedAt':new Date()};_0x5e1971&&(_0x54ccb6[_0x3a1a10(0x235)]=_0x5e1971);_0xc36f58===_0x3a1a10(0x13f)&&_0x4b5b99&&(_0x54ccb6['chargebackAmount']=_0x4b5b99);let _0x38cebc=0x0,_0x19b1c4=_0x7b4ae7[_0x3a1a10(0x140)][_0x3a1a10(0x1b7)];if(_0xc36f58===_0x3a1a10(0x1cc)&&_0x3c4622!==_0x3a1a10(0x1cc)){_0x54ccb6[_0x3a1a10(0x164)]=new Date();const _0x51ce1b=await currencyService_1['currencyService'][_0x3a1a10(0x1be)](_0x7b4ae7[_0x3a1a10(0x25c)],_0x7b4ae7[_0x3a1a10(0x23e)]);_0x54ccb6[_0x3a1a10(0x15d)]=_0x51ce1b;let _0x2c9fad=0x2d;const _0x474279=await _0x4c15c1['shop']['findUnique']({'where':{'id':_0x7b4ae7[_0x3a1a10(0x11b)]},'select':{'gatewaySettings':!![]}});if(_0x474279?.[_0x3a1a10(0x128)])try{const _0x3bc168=JSON['parse'](_0x474279[_0x3a1a10(0x128)]);for(const [_0x2e1555,_0x31a73c]of Object[_0x3a1a10(0x234)](_0x3bc168)){if(_0x2e1555[_0x3a1a10(0x159)]()===_0x7b4ae7[_0x3a1a10(0x137)][_0x3a1a10(0x159)]()){_0x2c9fad=_0x31a73c[_0x3a1a10(0x151)]||0xa;break;}}}catch(_0x22e0f4){console[_0x3a1a10(0x18f)](_0x3a1a10(0x247)+_0x37ef95+':',_0x22e0f4);}let _0x196c3c;_0x7b4ae7[_0x3a1a10(0x1ca)]!==null&&_0x7b4ae7[_0x3a1a10(0x1ca)]!==undefined?(_0x196c3c=_0x7b4ae7[_0x3a1a10(0x1ca)],console[_0x3a1a10(0x15b)](_0x3a1a10(0x15e)+_0x196c3c['toFixed'](0x6)+'\x20USDT\x20for\x20payment\x20'+_0x37ef95)):(_0x196c3c=_0x51ce1b*(0x1-_0x2c9fad/0x64),console[_0x3a1a10(0x15b)](_0x3a1a10(0x1ee)+_0x37ef95+':\x20'+_0x2c9fad+_0x3a1a10(0x1c8)+_0x51ce1b[_0x3a1a10(0x25e)](0x6)+_0x3a1a10(0x230)),_0x54ccb6[_0x3a1a10(0x1ca)]=_0x196c3c,_0x54ccb6[_0x3a1a10(0x21c)]=_0x2c9fad),_0x38cebc=_0x196c3c,_0x19b1c4+=_0x196c3c,console[_0x3a1a10(0x15b)]('💰\x20Payment\x20'+_0x37ef95+'\x20became\x20PAID:'),console[_0x3a1a10(0x15b)](_0x3a1a10(0x146)+_0x51ce1b[_0x3a1a10(0x25e)](0x6)+_0x3a1a10(0x230)),console[_0x3a1a10(0x15b)]('\x20\x20\x20Gateway:\x20'+_0x7b4ae7[_0x3a1a10(0x137)]+_0x3a1a10(0x1fd)+_0x2c9fad+'%'),console[_0x3a1a10(0x15b)](_0x3a1a10(0x190)+_0x196c3c['toFixed'](0x6)+_0x3a1a10(0x198)+_0x2c9fad+_0x3a1a10(0x1d5)),console[_0x3a1a10(0x15b)]('\x20\x20\x20Added\x20to\x20balance:\x20+'+_0x196c3c[_0x3a1a10(0x25e)](0x6)+_0x3a1a10(0x230));}else{if(_0x3c4622===_0x3a1a10(0x1cc)&&_0xc36f58!==_0x3a1a10(0x1cc)){if(_0x7b4ae7[_0x3a1a10(0x15d)]){let _0x39ee3c=0x2d;const _0x394ad6=await _0x4c15c1[_0x3a1a10(0x140)]['findUnique']({'where':{'id':_0x7b4ae7['shopId']},'select':{'gatewaySettings':!![]}});if(_0x394ad6?.['gatewaySettings'])try{const _0x4e62cc=JSON['parse'](_0x394ad6[_0x3a1a10(0x128)]);for(const [_0x36c924,_0x3e333f]of Object[_0x3a1a10(0x234)](_0x4e62cc)){if(_0x36c924[_0x3a1a10(0x159)]()===_0x7b4ae7['gateway']['toLowerCase']()){_0x39ee3c=_0x3e333f[_0x3a1a10(0x151)]||0xa;break;}}}catch(_0x44f9ca){console[_0x3a1a10(0x18f)](_0x3a1a10(0x247)+_0x37ef95+':',_0x44f9ca);}const _0x4bd473=_0x7b4ae7[_0x3a1a10(0x15d)]*(0x1-_0x39ee3c/0x64);_0x38cebc=-_0x4bd473,_0x19b1c4-=_0x4bd473,_0x54ccb6[_0x3a1a10(0x15d)]=null,_0x54ccb6['amountAfterGatewayCommissionUSDT']=null,console[_0x3a1a10(0x15b)](_0x3a1a10(0x1f6)+_0x37ef95+_0x3a1a10(0x191)),console[_0x3a1a10(0x15b)](_0x3a1a10(0x146)+_0x7b4ae7['amountUSDT']['toFixed'](0x6)+_0x3a1a10(0x230)),console['log'](_0x3a1a10(0x186)+_0x7b4ae7['gateway']+_0x3a1a10(0x1fd)+_0x39ee3c+'%'),console[_0x3a1a10(0x15b)]('\x20\x20\x20Merchant\x20loses:\x20'+_0x4bd473['toFixed'](0x6)+_0x3a1a10(0x198)+_0x39ee3c+_0x3a1a10(0x1d5)),console['log'](_0x3a1a10(0x260)+_0x4bd473[_0x3a1a10(0x25e)](0x6)+'\x20USDT');}}}_0xc36f58===_0x3a1a10(0x13f)&&(_0x3c4622==='PAID'&&_0x7b4ae7['amountUSDT']&&console['log'](_0x3a1a10(0x188)),_0x4b5b99&&_0x4b5b99>0x0&&(_0x38cebc-=_0x4b5b99,_0x19b1c4-=_0x4b5b99,console[_0x3a1a10(0x15b)](_0x3a1a10(0x233)+_0x4b5b99[_0x3a1a10(0x25e)](0x6)+_0x3a1a10(0x217))));_0xc36f58===_0x3a1a10(0x1db)&&_0x3c4622==='PAID'&&console[_0x3a1a10(0x15b)](_0x3a1a10(0x1d2));const _0x51dc39=await _0x4c15c1[_0x3a1a10(0x1c4)][_0x3a1a10(0x1ce)]({'where':{'id':_0x37ef95},'data':_0x54ccb6,'include':{'shop':{'select':{'name':!![],'username':!![]}}}});return _0x38cebc!==0x0&&(await _0x4c15c1[_0x3a1a10(0x140)][_0x3a1a10(0x1ce)]({'where':{'id':_0x7b4ae7['shopId']},'data':{'balance':_0x19b1c4}}),console[_0x3a1a10(0x15b)]('💰\x20Shop\x20'+_0x7b4ae7[_0x3a1a10(0x11b)]+_0x3a1a10(0x23d)+_0x7b4ae7[_0x3a1a10(0x140)]['balance'][_0x3a1a10(0x25e)](0x6)+_0x3a1a10(0x238)+_0x19b1c4['toFixed'](0x6)+_0x3a1a10(0x1aa)+(_0x38cebc>0x0?'+':'')+_0x38cebc[_0x3a1a10(0x25e)](0x6)+')')),_0x51dc39;});return{'id':_0x1daba8['id'],'shopId':_0x1daba8[_0x4b9327(0x11b)],'gateway':_0x1daba8[_0x4b9327(0x137)],'amount':_0x1daba8[_0x4b9327(0x25c)],'currency':_0x1daba8['currency'],'status':_0x1daba8[_0x4b9327(0x1b8)],'orderId':_0x1daba8['orderId'],'gatewayOrderId':_0x1daba8[_0x4b9327(0x171)],'customerEmail':_0x1daba8['customerEmail'],'customerName':_0x1daba8['customerName'],'customerCountry':_0x1daba8['customerCountry'],'customerIp':_0x1daba8['customerIp'],'customerUa':_0x1daba8[_0x4b9327(0x183)],'failureMessage':_0x1daba8[_0x4b9327(0x1fc)],'adminNotes':_0x1daba8[_0x4b9327(0x235)],'chargebackAmount':_0x1daba8[_0x4b9327(0x147)],'statusChangedBy':_0x1daba8[_0x4b9327(0x231)],'statusChangedAt':_0x1daba8[_0x4b9327(0x19e)],'createdAt':_0x1daba8[_0x4b9327(0x14a)],'updatedAt':_0x1daba8[_0x4b9327(0x145)],'shop':_0x1daba8[_0x4b9327(0x140)]};}async['updateUser'](_0x3408c3,_0x4335c0){const _0x46ed75=a38_0x5bb281,_0xc2cab5=Math[_0x46ed75(0x1cd)]()[_0x46ed75(0x1a4)](0x24)['substr'](0x2,0x9);console[_0x46ed75(0x15b)]('🎯\x20updateUser\x20called\x20with\x20ID:\x20'+_0xc2cab5+_0x46ed75(0x1d4)+_0x3408c3);const _0x55ecef={..._0x4335c0};_0x4335c0['password']&&_0x4335c0[_0x46ed75(0x1a0)][_0x46ed75(0x13e)]()!==''?(console[_0x46ed75(0x15b)]('🔐\x20['+_0xc2cab5+_0x46ed75(0x1fe)+_0x3408c3),_0x55ecef[_0x46ed75(0x1a0)]=await bcryptjs_1['default'][_0x46ed75(0x13c)](_0x4335c0[_0x46ed75(0x1a0)],0xc)):(console[_0x46ed75(0x15b)]('🔐\x20['+_0xc2cab5+_0x46ed75(0x192)),delete _0x55ecef[_0x46ed75(0x1a0)]);_0x4335c0[_0x46ed75(0x170)]&&(_0x55ecef[_0x46ed75(0x1dd)]=_0x4335c0['fullName'],delete _0x55ecef[_0x46ed75(0x170)]);_0x4335c0['telegramId']&&(_0x55ecef[_0x46ed75(0x1ae)]=_0x4335c0['telegramId'],delete _0x55ecef[_0x46ed75(0x1a7)]);_0x4335c0['merchantUrl']&&(_0x55ecef[_0x46ed75(0x23c)]=_0x4335c0[_0x46ed75(0x249)],delete _0x55ecef[_0x46ed75(0x249)]);if(_0x4335c0[_0x46ed75(0x241)]){const _0x54f1e8=_0x4335c0[_0x46ed75(0x241)][_0x46ed75(0x163)](_0x2eea74=>this['getGatewayInternalName'](_0x2eea74));console['log'](_0x46ed75(0x1b3),_0x4335c0[_0x46ed75(0x241)],'->',_0x54f1e8),_0x55ecef['paymentGateways']=JSON['stringify'](_0x54f1e8),delete _0x55ecef[_0x46ed75(0x241)];}_0x4335c0['gatewaySettings']&&(console[_0x46ed75(0x15b)](_0x46ed75(0x11d)+_0xc2cab5+_0x46ed75(0x23f),_0x4335c0[_0x46ed75(0x128)]),_0x55ecef['gatewaySettings']=JSON[_0x46ed75(0x12b)](_0x4335c0[_0x46ed75(0x128)]),console[_0x46ed75(0x15b)](_0x46ed75(0x11d)+_0xc2cab5+_0x46ed75(0x1eb),_0x55ecef[_0x46ed75(0x128)]));_0x4335c0[_0x46ed75(0x16b)]&&(_0x4335c0['wallets'][_0x46ed75(0x173)]!==undefined&&(_0x55ecef[_0x46ed75(0x173)]=_0x4335c0[_0x46ed75(0x16b)][_0x46ed75(0x173)]||null),_0x4335c0[_0x46ed75(0x16b)][_0x46ed75(0x194)]!==undefined&&(_0x55ecef[_0x46ed75(0x194)]=_0x4335c0[_0x46ed75(0x16b)][_0x46ed75(0x194)]||null),_0x4335c0[_0x46ed75(0x16b)][_0x46ed75(0x207)]!==undefined&&(_0x55ecef[_0x46ed75(0x207)]=_0x4335c0[_0x46ed75(0x16b)][_0x46ed75(0x207)]||null),_0x4335c0['wallets'][_0x46ed75(0x204)]!==undefined&&(_0x55ecef[_0x46ed75(0x204)]=_0x4335c0[_0x46ed75(0x16b)]['usdcPolygonWallet']||null),delete _0x55ecef[_0x46ed75(0x16b)]);const _0x198642=await database_1[_0x46ed75(0x246)]['shop'][_0x46ed75(0x1ce)]({'where':{'id':_0x3408c3},'data':_0x55ecef,'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});return console[_0x46ed75(0x15b)](_0x46ed75(0x1b6)+_0xc2cab5+_0x46ed75(0x21d),_0x198642['gatewaySettings']),{'id':_0x198642['id'],'fullName':_0x198642[_0x46ed75(0x1dd)],'username':_0x198642['username'],'telegramId':_0x198642[_0x46ed75(0x1ae)],'merchantUrl':_0x198642[_0x46ed75(0x23c)],'gateways':_0x198642[_0x46ed75(0x22c)]?JSON['parse'](_0x198642[_0x46ed75(0x22c)]):null,'gatewaySettings':_0x198642['gatewaySettings']?JSON[_0x46ed75(0x236)](_0x198642[_0x46ed75(0x128)]):null,'publicKey':_0x198642[_0x46ed75(0x197)],'wallets':{'usdtPolygonWallet':_0x198642[_0x46ed75(0x173)],'usdtTrcWallet':_0x198642[_0x46ed75(0x194)],'usdtErcWallet':_0x198642[_0x46ed75(0x207)],'usdcPolygonWallet':_0x198642[_0x46ed75(0x204)]},'status':_0x198642[_0x46ed75(0x1b8)],'createdAt':_0x198642['createdAt']};}async[a38_0x5bb281(0x254)](_0x335e6f){const _0x394c79=a38_0x5bb281,_0x6f1664=await database_1[_0x394c79(0x246)][_0x394c79(0x140)][_0x394c79(0x1ce)]({'where':{'id':_0x335e6f},'data':{'status':_0x394c79(0x208)},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});return{'id':_0x6f1664['id'],'fullName':_0x6f1664[_0x394c79(0x1dd)],'username':_0x6f1664[_0x394c79(0x189)],'telegramId':_0x6f1664[_0x394c79(0x1ae)],'merchantUrl':_0x6f1664[_0x394c79(0x23c)],'gateways':_0x6f1664[_0x394c79(0x22c)]?JSON[_0x394c79(0x236)](_0x6f1664[_0x394c79(0x22c)]):null,'gatewaySettings':_0x6f1664[_0x394c79(0x128)]?JSON['parse'](_0x6f1664['gatewaySettings']):null,'publicKey':_0x6f1664[_0x394c79(0x197)],'wallets':{'usdtPolygonWallet':_0x6f1664[_0x394c79(0x173)],'usdtTrcWallet':_0x6f1664[_0x394c79(0x194)],'usdtErcWallet':_0x6f1664[_0x394c79(0x207)],'usdcPolygonWallet':_0x6f1664[_0x394c79(0x204)]},'status':_0x6f1664[_0x394c79(0x1b8)],'createdAt':_0x6f1664[_0x394c79(0x14a)]};}async[a38_0x5bb281(0x245)](_0x5a9f7c){const _0x4fba7a=a38_0x5bb281,_0x22ff24=await database_1['default'][_0x4fba7a(0x140)][_0x4fba7a(0x1ce)]({'where':{'id':_0x5a9f7c},'data':{'status':_0x4fba7a(0x1fb)},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});return{'id':_0x22ff24['id'],'fullName':_0x22ff24[_0x4fba7a(0x1dd)],'username':_0x22ff24[_0x4fba7a(0x189)],'telegramId':_0x22ff24['telegram'],'merchantUrl':_0x22ff24['shopUrl'],'gateways':_0x22ff24['paymentGateways']?JSON[_0x4fba7a(0x236)](_0x22ff24[_0x4fba7a(0x22c)]):null,'gatewaySettings':_0x22ff24['gatewaySettings']?JSON[_0x4fba7a(0x236)](_0x22ff24[_0x4fba7a(0x128)]):null,'publicKey':_0x22ff24['publicKey'],'wallets':{'usdtPolygonWallet':_0x22ff24[_0x4fba7a(0x173)],'usdtTrcWallet':_0x22ff24[_0x4fba7a(0x194)],'usdtErcWallet':_0x22ff24[_0x4fba7a(0x207)],'usdcPolygonWallet':_0x22ff24[_0x4fba7a(0x204)]},'status':_0x22ff24[_0x4fba7a(0x1b8)],'createdAt':_0x22ff24[_0x4fba7a(0x14a)]};}async[a38_0x5bb281(0x1a1)](_0x3b3f95){const _0xee5646=a38_0x5bb281,{page:_0x153847,limit:_0x1cec99,status:_0xcc41bd}=_0x3b3f95,_0x2c44ab=(_0x153847-0x1)*_0x1cec99,_0x471375={};_0xcc41bd&&(_0x471375[_0xee5646(0x1b8)]=_0xcc41bd['toUpperCase']());const [_0x5c3bc8,_0x5097ca]=await Promise[_0xee5646(0x13a)]([database_1['default']['shop']['findMany']({'where':_0x471375,'skip':_0x2c44ab,'take':_0x1cec99,'orderBy':{'createdAt':_0xee5646(0x1bf)},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}}),database_1['default'][_0xee5646(0x140)][_0xee5646(0x1ed)]({'where':_0x471375})]);return{'users':_0x5c3bc8[_0xee5646(0x163)](_0x5b4ff4=>{const _0x18e9a8=_0xee5646,_0x5a8ecb=_0x5b4ff4[_0x18e9a8(0x22c)]?JSON[_0x18e9a8(0x236)](_0x5b4ff4[_0x18e9a8(0x22c)]):null,_0x54142c=_0x5a8ecb?_0x5a8ecb['map'](_0x5dc8a0=>this[_0x18e9a8(0x18d)](_0x5dc8a0)):null;return{'id':_0x5b4ff4['id'],'fullName':_0x5b4ff4[_0x18e9a8(0x1dd)],'username':_0x5b4ff4['username'],'telegramId':_0x5b4ff4[_0x18e9a8(0x1ae)],'merchantUrl':_0x5b4ff4[_0x18e9a8(0x23c)],'gateways':_0x54142c,'gatewaySettings':_0x5b4ff4[_0x18e9a8(0x128)]?JSON[_0x18e9a8(0x236)](_0x5b4ff4[_0x18e9a8(0x128)]):null,'publicKey':_0x5b4ff4[_0x18e9a8(0x197)],'wallets':{'usdtPolygonWallet':_0x5b4ff4[_0x18e9a8(0x173)],'usdtTrcWallet':_0x5b4ff4[_0x18e9a8(0x194)],'usdtErcWallet':_0x5b4ff4['usdtErcWallet'],'usdcPolygonWallet':_0x5b4ff4[_0x18e9a8(0x204)]},'status':_0x5b4ff4[_0x18e9a8(0x1b8)],'createdAt':_0x5b4ff4[_0x18e9a8(0x14a)]};}),'pagination':{'page':_0x153847,'limit':_0x1cec99,'total':_0x5097ca,'totalPages':Math['ceil'](_0x5097ca/_0x1cec99)}};}async['getUserById'](_0x46e988){const _0x5c0b36=a38_0x5bb281,_0x627e3c=await database_1[_0x5c0b36(0x246)][_0x5c0b36(0x140)]['findUnique']({'where':{'id':_0x46e988},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});if(!_0x627e3c)return null;const _0x42a18d=_0x627e3c[_0x5c0b36(0x22c)]?JSON[_0x5c0b36(0x236)](_0x627e3c[_0x5c0b36(0x22c)]):null,_0x44ea4c=_0x42a18d?_0x42a18d[_0x5c0b36(0x163)](_0x43d87e=>this[_0x5c0b36(0x18d)](_0x43d87e)):null;return _0x42a18d&&_0x44ea4c&&console['log']('🔄\x20Gateway\x20mapping\x20(get):',_0x42a18d,'->',_0x44ea4c),{'id':_0x627e3c['id'],'fullName':_0x627e3c[_0x5c0b36(0x1dd)],'username':_0x627e3c[_0x5c0b36(0x189)],'telegramId':_0x627e3c['telegram'],'merchantUrl':_0x627e3c[_0x5c0b36(0x23c)],'gateways':_0x44ea4c,'gatewaySettings':_0x627e3c['gatewaySettings']?JSON[_0x5c0b36(0x236)](_0x627e3c['gatewaySettings']):null,'publicKey':_0x627e3c[_0x5c0b36(0x197)],'wallets':{'usdtPolygonWallet':_0x627e3c[_0x5c0b36(0x173)],'usdtTrcWallet':_0x627e3c[_0x5c0b36(0x194)],'usdtErcWallet':_0x627e3c[_0x5c0b36(0x207)],'usdcPolygonWallet':_0x627e3c[_0x5c0b36(0x204)]},'status':_0x627e3c[_0x5c0b36(0x1b8)],'createdAt':_0x627e3c[_0x5c0b36(0x14a)]};}async['createUser'](_0x32e537){const _0x4c81f9=a38_0x5bb281,{fullName:_0xff99cd,username:_0x39358f,password:_0x536e53,telegramId:_0x2b4db9,merchantUrl:_0x2202d3,gateways:_0x327279,gatewaySettings:_0x29727f,wallets:_0xb464a1}=_0x32e537,_0x5e53d5=await database_1[_0x4c81f9(0x246)][_0x4c81f9(0x140)]['findUnique']({'where':{'username':_0x39358f}});if(_0x5e53d5)throw new Error(_0x4c81f9(0x219));if(_0x2b4db9){const _0x4affd3=await database_1[_0x4c81f9(0x246)][_0x4c81f9(0x140)][_0x4c81f9(0x150)]({'where':{'telegram':_0x2b4db9}});if(_0x4affd3)throw new Error('Telegram\x20username\x20already\x20exists');}const _0xf24562=await bcryptjs_1['default'][_0x4c81f9(0x13c)](_0x536e53,0xc),_0x39b354='pk_'+crypto_1[_0x4c81f9(0x246)]['randomBytes'](0x20)[_0x4c81f9(0x1a4)](_0x4c81f9(0x20a)),_0x39e277=_0x4c81f9(0x14b)+crypto_1[_0x4c81f9(0x246)][_0x4c81f9(0x187)](0x20)[_0x4c81f9(0x1a4)](_0x4c81f9(0x20a)),_0x201f39=_0x327279?_0x327279['map'](_0x46d7d2=>this[_0x4c81f9(0x227)](_0x46d7d2)):null;_0x327279&&_0x201f39&&console[_0x4c81f9(0x15b)](_0x4c81f9(0x193),_0x327279,'->',_0x201f39);const _0xe27ea4=await database_1['default'][_0x4c81f9(0x140)][_0x4c81f9(0x1af)]({'data':{'name':_0xff99cd,'username':_0x39358f,'password':_0xf24562,'telegram':_0x2b4db9,'shopUrl':_0x2202d3,'paymentGateways':_0x201f39?JSON['stringify'](_0x201f39):null,'gatewaySettings':_0x29727f?JSON[_0x4c81f9(0x12b)](_0x29727f):null,'usdtPolygonWallet':_0xb464a1?.[_0x4c81f9(0x173)]||null,'usdtTrcWallet':_0xb464a1?.[_0x4c81f9(0x194)]||null,'usdtErcWallet':_0xb464a1?.[_0x4c81f9(0x207)]||null,'usdcPolygonWallet':_0xb464a1?.[_0x4c81f9(0x204)]||null,'publicKey':_0x39b354,'secretKey':_0x39e277,'status':_0x4c81f9(0x1fb)},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});return{'id':_0xe27ea4['id'],'fullName':_0xe27ea4[_0x4c81f9(0x1dd)],'username':_0xe27ea4[_0x4c81f9(0x189)],'telegramId':_0xe27ea4[_0x4c81f9(0x1ae)],'merchantUrl':_0xe27ea4['shopUrl'],'gateways':_0xe27ea4['paymentGateways']?JSON[_0x4c81f9(0x236)](_0xe27ea4[_0x4c81f9(0x22c)]):null,'gatewaySettings':_0xe27ea4[_0x4c81f9(0x128)]?JSON[_0x4c81f9(0x236)](_0xe27ea4[_0x4c81f9(0x128)]):null,'publicKey':_0xe27ea4[_0x4c81f9(0x197)],'wallets':{'usdtPolygonWallet':_0xe27ea4['usdtPolygonWallet'],'usdtTrcWallet':_0xe27ea4['usdtTrcWallet'],'usdtErcWallet':_0xe27ea4[_0x4c81f9(0x207)],'usdcPolygonWallet':_0xe27ea4[_0x4c81f9(0x204)]},'status':_0xe27ea4[_0x4c81f9(0x1b8)],'createdAt':_0xe27ea4[_0x4c81f9(0x14a)]};}async[a38_0x5bb281(0x155)](_0x2af9d2){const _0x5c31c6=a38_0x5bb281;await database_1[_0x5c31c6(0x246)][_0x5c31c6(0x140)][_0x5c31c6(0x19c)]({'where':{'id':_0x2af9d2}});}[a38_0x5bb281(0x1e8)](_0x3a6a3f,_0x5212c7,_0x5f3742){const _0x3b5ecd=a38_0x5bb281,_0x5de2aa=new Map(),_0x5fd14=new Date(_0x5212c7);while(_0x5fd14<=_0x5f3742){const _0x4fbbfb=_0x5fd14[_0x3b5ecd(0x224)]()['split']('T')[0x0];_0x5de2aa['set'](_0x4fbbfb,{'revenue':0x0,'count':0x0}),_0x5fd14['setDate'](_0x5fd14['getDate']()+0x1);}for(const _0x57c8d5 of _0x3a6a3f){const _0x450fb1=_0x57c8d5[_0x3b5ecd(0x14a)][_0x3b5ecd(0x224)]()[_0x3b5ecd(0x250)]('T')[0x0],_0x5af758=_0x5de2aa[_0x3b5ecd(0x248)](_0x450fb1);_0x5af758&&(_0x5af758[_0x3b5ecd(0x1ed)]+=0x1,_0x57c8d5[_0x3b5ecd(0x1b8)]===_0x3b5ecd(0x1cc)&&(_0x57c8d5['amountUSDT']?_0x5af758['revenue']+=_0x57c8d5[_0x3b5ecd(0x15d)]:console[_0x3b5ecd(0x15b)](_0x3b5ecd(0x148)+_0x57c8d5['id']+_0x3b5ecd(0x139))));}const _0x3e27f9=[],_0x102961=[];for(const [_0x2378cc,_0x2ef722]of _0x5de2aa){_0x3e27f9[_0x3b5ecd(0x1ec)]({'date':_0x2378cc,'amount':Math['round'](_0x2ef722[_0x3b5ecd(0x257)]*0x64)/0x64}),_0x102961[_0x3b5ecd(0x1ec)]({'date':_0x2378cc,'count':_0x2ef722[_0x3b5ecd(0x1ed)]});}return{'dailyRevenue':_0x3e27f9,'dailyPayments':_0x102961};}}exports[a38_0x5bb281(0x169)]=AdminService;function a38_0x4f39(_0x51c8aa,_0x2c93e1){const _0x59f2c9=a38_0x59f2();return a38_0x4f39=function(_0x4f390a,_0x5d4267){_0x4f390a=_0x4f390a-0x11b;let _0xd47023=_0x59f2c9[_0x4f390a];return _0xd47023;},a38_0x4f39(_0x51c8aa,_0x2c93e1);}function a38_0x59f2(){const _0x3eff2a=['updateCustomerData','yesterday','trc20','💳\x20Payout\x20wallet\x20for\x20',',\x20successful:\x20','periodFrom','\x20\x20\x20⏳\x20Pending\x20payout:\x20','asc','length','COMPLETED','generateDailyStatistics','totalAmountAfterCommissionUSDT','gatewayEarnings',']\x20Gateway\x20settings\x20JSON\x20string:','push','count','📊\x20[ADMIN]\x20Calculating\x20commission\x20manually\x20for\x20payment\x20','\x20USDT\x20(total\x20paid\x20to\x20merchants)','merchantEarnings','7317topIpG','📊\x20Getting\x20merchants\x20awaiting\x20payout\x20with\x20filters:','../config/database','\x20payments)','ceil','💰\x20Payment\x20','💰\x20Found\x20','some','Noda','2116810nBsQMC','ACTIVE','failureMessage',',\x20Commission:\x20',']\x20Updating\x20password\x20for\x20user\x20','_count','2020-01-01','custom','period','polygon_usdc','usdcPolygonWallet','\x20\x20\x20✅\x20Actual\x20available\x20balance:\x20','\x20for\x20shop\x20','usdtErcWallet','SUSPENDED','insensitive','hex','merchantEarningsUSDT','\x20paid\x20payments\x20for\x20analysis','join','round','customerIp','\x27\x20as\x20is\x20(not\x20found\x20in\x20mappings)','values','📊\x20Calculating\x20payout\x20statistics...','getGatewayIdByName','\x20\x20\x20📅\x20Total\x20payouts\x20(this\x20month):\x20','averageCheckUSDT','💰\x20Current\x20shop\x20balance:\x20','\x20USDT\x20from\x20balance','\x20\x20\x20�\x20Total\x20payments\x20turnover:\x20','Username\x20already\x20exists','9928iqPEcN','averageCommissionRate','gatewayCommissionRate',']\x20User\x20updated,\x20gatewaySettings\x20from\x20DB:','successUrl','KLYME\x20DE','Rapyd','dailyRevenue','defineProperty','totalTurnover','toISOString','📊\x20Sorting\x20payments\x20by\x20','paymentsCount','getGatewayInternalName','updatePaymentStatus','📊\x20Getting\x20payments\x20with\x20filters:','\x20\x20\x20🏪\x20Gateway\x20earnings:\x20','Shop\x20not\x20found','paymentGateways','Error\x20parsing\x20gateway\x20settings\x20for\x20shop\x20','✅\x20Payout\x20created:\x20','📊\x20Getting\x20merchant\x20statistics\x20with\x20filters:','\x20USDT','statusChangedBy','./currencyService','💸\x20CHARGEBACK\x20penalty:\x20-','entries','adminNotes','parse','🔄\x20Admin\x20updating\x20payment\x20','\x20->\x20','\x27\x20(from\x20\x27','\x20\x20\x20Current\x20total\x20paid\x20out:\x20','pendingPayout','shopUrl','\x20balance\x20updated:\x20','currency',']\x20Gateway\x20settings\x20before\x20saving:','polygon','gateways','💰\x20Shop\x20','\x20\x20\x20🔍\x20Calculated\x20after\x20commission:\x20','⚠️\x20Gateway\x20\x27','activateUser','default','Error\x20parsing\x20gateway\x20settings\x20for\x20payment\x20','get','merchantUrl','totalCommissionRate','30d','\x20has\x20zero\x20or\x20null\x20amountUSDT,\x20skipping...','totalPayments','cointopay','\x20\x20\x20💰\x20Total\x20payout:\x20','split',':\x20commission\x20=\x20','bcryptjs','getPayoutById','suspendUser','\x20USDT\x20(+','forEach','revenue','getMerchantsAwaitingPayout','\x20balance\x20updated:','groupBy','📊\x20Calculating\x20commission\x20manually\x20for\x20payment\x20','amount','test_gateway','toFixed','klyme_eu','\x20\x20\x20Subtracted\x20from\x20balance:\x20-','\x20\x20\x20💸\x20Total\x20payouts:\x20','shopId','🔍\x20Using\x20gateway\x20\x27','🔧\x20[','$transaction','\x20\x20\x20🌐\x20IP:\x20','\x20\x20\x20💰\x20Total\x20payments\x20turnover:\x20','totalAmountUSDT','getDate','📊\x20Payout\x20statistics\x20calculated:','getFullYear','__esModule','\x20\x20\x20👤\x20Merchant\x20earnings:\x20','602810XcdFxU','gatewaySettings','\x20\x20\x20✅\x20Total\x20available\x20for\x20payout:\x20','klyme_de','stringify','customerName','\x20\x20\x20Total\x20paid\x20out:\x20','totalPayout','\x20USDT\x20(actual\x20balances)','📊\x20Using\x20saved\x20commission\x20rate\x20for\x20payment\x20','2532943MfSaSx','externalPaymentUrl','__importDefault','💰\x20Creating\x20payout\x20for\x20shop\x20','setHours','\x20\x20\x20💳\x20Total\x20payments:\x20','gateway','dateFrom','\x20missing\x20amountUSDT,\x20using\x20fallback\x20conversion','all','359620sCEEYm','hash','PENDING','trim','CHARGEBACK','shop','\x20\x20\x20🖥️\x20User\x20Agent:\x20','toUpperCase','getAllPayments','lte','updatedAt','\x20\x20\x20Full\x20amount:\x20','chargebackAmount','⚠️\x20Payment\x20','\x20USDT\x20(already\x20paid\x20out)','createdAt','sk_','reduce','turnover','totalPaidOut','\x20\x20\x20📅\x20This\x20month:\x20','findUnique','commission','\x27\x20->\x20name\x20\x27','\x20USDT,\x20merchant:\x20','\x20active\x20merchants\x20for\x20selection','deleteUser','aggregate','MasterCard','\x20\x20\x20Transaction\x20hash:\x20','toLowerCase','notes','log','Test\x20Gateway','amountUSDT','📊\x20[ADMIN]\x20Using\x20saved\x20amountAfterGatewayCommissionUSDT:\x20','admin','\x20status:\x20','plisio','🔄\x20Updating\x20customer\x20data\x20for\x20payment\x20','map','paidAt','customerCountry','cointopay2','\x20\x20\x20🤔\x20Difference:\x20','\x20\x20\x20💰\x20Total\x20turnover:\x20','AdminService','localeCompare','wallets','📊\x20Merchant\x20statistics\x20calculated:','network','includes','getPayoutStats','fullName','gatewayOrderId','\x20USDT\x20(gross\x20revenue)','usdtPolygonWallet','awaitingPayout','\x20to\x20','\x27)\x20not\x20found\x20in\x20database,\x20returning\x20empty\x20result','⚠️\x20Requested\x20gateway\x20\x27','thisMonth','Payment\x20not\x20found','sort','\x20\x20\x20💵\x20Available\x20balance:\x20','findMany','CoinToPay','deletePayout','\x20\x20\x20Payout\x20amount:\x20','\x20USDT,\x20Requested:\x20','whiteUrl','\x20\x20\x20💸\x20Total\x20payouts\x20(all\x20time):\x20','customerUa','failUrl','📅\x20Period:\x20','\x20\x20\x20Gateway:\x20','randomBytes','💸\x20CHARGEBACK:\x20Merchant\x20amount\x20already\x20deducted\x20from\x20balance','username','\x20merchants','commissionUSDT','\x20\x20\x20Balance:\x20','getGatewayDisplayName','month','error','\x20\x20\x20Merchant\x20gets:\x20','\x20no\x20longer\x20PAID:',']\x20Password\x20not\x20provided\x20or\x20empty,\x20skipping\x20password\x20update','🔄\x20Gateway\x20mapping\x20(create):','usdtTrcWallet','availableBalance','9dImBLG','publicKey','\x20USDT\x20(after\x20','klyme_gb','getMonth','📊\x20Final\x20WHERE\x20conditions:','delete','_sum','statusChangedAt','📊\x20Calculated\x20commission\x20rate\x20for\x20payment\x20','password','getAllUsers','currencyService','getGatewayNameById','toString','getTime','KLYME\x20GB','telegramId','\x20USDT)','\x27\x20to\x20name\x20\x27','\x20USDT\x20(','amountAfterCommissionUSDT','set','📊\x20Gateway\x20filter\x20applied:','telegram','create','not\x20specified','getMerchantsSelection','gte','🔄\x20Gateway\x20mapping:','rapyd','\x20merchants\x20with\x20positive\x20balance','🎯\x20[','balance','status','🔄\x20Converted\x20gateway\x20name\x20\x27','📊\x20Merchants\x20awaiting\x20payout:\x20','💱\x20Currency\x20filter\x20applied:\x20','periodTo','3320586yBVJfm','convertToUSDT','desc','\x20\x20\x20⏳\x20Awaiting\x20payout:\x20','\x20USDT\x20(-','90d','NONEXISTENT_GATEWAY_FILTER','payment','📊\x20Using\x20saved\x20values\x20for\x20payment\x20','\x20USDT\x20(calculated\x20-\x20payouts\x20-\x20balance)','dateTo','%\x20from\x20','payout','amountAfterGatewayCommissionUSDT','\x20USDT\x20(theoretical\x20net)','PAID','random','update','\x20\x20\x20🌍\x20Country:\x20','Insufficient\x20balance.\x20Available:\x20','✅\x20Using\x20gateway\x20filter:\x20\x27','🔄\x20REFUND:\x20Payment\x20amount\x20already\x20deducted\x20from\x20balance','year',',\x20userId:\x20','%\x20commission)','501236HCubyN','date','txid','turnoverUSDT','✅\x20Customer\x20data\x20updated\x20for\x20payment\x20','REFUND','findFirst','name'];a38_0x59f2=function(){return _0x3eff2a;};return a38_0x59f2();}