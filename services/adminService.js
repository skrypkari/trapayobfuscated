'use strict';const a36_0x545440=a36_0x4ea1;function a36_0x4ea1(_0x24de81,_0x447b5d){const _0x4e6838=a36_0x4e68();return a36_0x4ea1=function(_0x4ea171,_0x1a3f05){_0x4ea171=_0x4ea171-0x72;let _0x2dd79b=_0x4e6838[_0x4ea171];return _0x2dd79b;},a36_0x4ea1(_0x24de81,_0x447b5d);}(function(_0x1f879f,_0x8b72f9){const _0x38fa1a=a36_0x4ea1,_0x33e8db=_0x1f879f();while(!![]){try{const _0x1660ab=parseInt(_0x38fa1a(0xf6))/0x1*(parseInt(_0x38fa1a(0x132))/0x2)+parseInt(_0x38fa1a(0x80))/0x3*(-parseInt(_0x38fa1a(0xb6))/0x4)+parseInt(_0x38fa1a(0x18f))/0x5*(-parseInt(_0x38fa1a(0x189))/0x6)+parseInt(_0x38fa1a(0x12c))/0x7*(parseInt(_0x38fa1a(0xc7))/0x8)+parseInt(_0x38fa1a(0x87))/0x9+parseInt(_0x38fa1a(0x135))/0xa*(-parseInt(_0x38fa1a(0xb0))/0xb)+parseInt(_0x38fa1a(0x14d))/0xc;if(_0x1660ab===_0x8b72f9)break;else _0x33e8db['push'](_0x33e8db['shift']());}catch(_0xc5894c){_0x33e8db['push'](_0x33e8db['shift']());}}}(a36_0x4e68,0xaf340));var __importDefault=this&&this['__importDefault']||function(_0x1eb92c){return _0x1eb92c&&_0x1eb92c['__esModule']?_0x1eb92c:{'default':_0x1eb92c};};Object[a36_0x545440(0xe2)](exports,a36_0x545440(0xa8),{'value':!![]}),exports['AdminService']=void 0x0;const database_1=__importDefault(require(a36_0x545440(0x7f))),bcryptjs_1=__importDefault(require(a36_0x545440(0x14a))),crypto_1=__importDefault(require('crypto')),currencyService_1=require(a36_0x545440(0x10c)),gateway_1=require(a36_0x545440(0x184));function a36_0x4e68(){const _0x41ef90=['✅\x20Customer\x20data\x20updated\x20for\x20payment\x20','get',':\x20commission\x20=\x20','\x20\x20\x20🤔\x20Difference:\x20','customerEmail','reduce','default','turnover','\x20\x20\x20Total\x20paid\x20out:\x20','usdtErcWallet','findUnique','parse','\x20\x20\x20Balance:\x20','polygon_usdc','createPayout','📊\x20Sorting\x20payments\x20by\x20','join','🔍\x20Using\x20gateway\x20\x27',',\x20userId:\x20','CHARGEBACK','findMany','totalCommissionRate','\x27)\x20not\x20found\x20in\x20database,\x20returning\x20empty\x20result','💱\x20Currency\x20filter\x20applied:\x20','getMerchantStatistics','📊\x20[ADMIN]\x20Calculating\x20commission\x20manually\x20for\x20payment\x20','PENDING','\x20USDT\x20(already\x20paid\x20out)','gatewaySettings','\x20\x20\x20Full\x20amount:\x20','__esModule','mastercard','updateUser','%\x20commission)','updatedAt','📊\x20Getting\x20payments\x20with\x20filters:','🔄\x20Gateway\x20mapping:','Open\x20Banking\x202','1250282iAfqrc','averageCheckUSDT','not\x20set','\x20\x20\x20�\x20Total\x20payments\x20turnover:\x20','\x20USDT','customerIp','4uvsNYp','\x20\x20\x20✅\x20Actual\x20available\x20balance:\x20','0000','\x20\x20\x20✅\x20Total\x20available\x20for\x20payout:\x20','telegramId','hash','Username\x20already\x20exists','COMPLETED','2020-01-01','getFullYear','update','txid','convertToUSDT','\x20\x20\x20Current\x20balance:\x20','🎯\x20updateUser\x20called\x20with\x20ID:\x20','dateFrom','chargebackAmount','24FjnAGJ','📊\x20Available\x20gateways\x20in\x20database:','📋\x20Getting\x20merchants\x20selection\x20list...','dateTo','💰\x20Found\x20','createdAt','💰\x20Shop\x20','klyme_eu','date','\x20\x20\x20🖥️\x20User\x20Agent:\x20','💸\x20CHARGEBACK\x20penalty:\x20-','\x20\x20\x20�\x20Total\x20paid\x20out:\x20','fullName','periodTo','\x20\x20\x20Merchant\x20loses:\x20','💰\x20Payment\x20','rapyd','\x20USDT\x20(calculated\x20-\x20payouts\x20-\x20balance)','stringify','amount','commission','getGatewayDisplayName','getGatewayInternalName','totalTurnover','📊\x20Merchants\x20awaiting\x20payout:\x20','\x20USDT\x20for\x20payment\x20','currency','defineProperty','\x20\x20\x20Gateway:\x20','\x27\x20->\x20name\x20\x27','paidOutUSDT','whiteUrl','\x20\x20\x20🌐\x20IP:\x20','gateways','🔧\x20[','gatewayCommissionRate','ACTIVE','toLowerCase','\x20USDT\x20from\x20balance','\x20\x20\x20🔍\x20Calculated\x20after\x20commission:\x20','💰\x20[PAYOUT]\x20Merchant\x20','\x20\x20\x20🌍\x20Country:\x20','\x20\x20\x20🏪\x20Gateway\x20earnings:\x20','orderId','payout','🎯\x20[','\x20\x20\x20💰\x20Total\x20payments\x20turnover:\x20','58QvtxDp','period','usdcPolygonWallet','year','createUser','findFirst','merchantEarnings','🔄\x20Converted\x20gateway\x20name\x20\x27','\x20USDT\x20(same\x20as\x20awaiting)','\x20\x20\x20�📊\x20Total\x20payments:\x20','\x20USDT,\x20Requested:\x20','⚠️\x20Requested\x20gateway\x20\x27','$transaction','setHours','dailyRevenue','🔐\x20[','getAllPayouts','commissionUSDT','\x20\x20\x20💰\x20Total\x20payout:\x20','error','getMerchantsAwaitingPayout','dailyPayments','./currencyService','split','merchantUrl','getMerchantsSelection','set','balance','getAllPayments','toUpperCase','toFixed','usdtPolygonWallet','\x20\x20\x20Payout\x20amount:\x20','password','📊\x20Using\x20saved\x20commission\x20rate\x20for\x20payment\x20','\x20USDT\x20(-','paymentGateways','awaitingPayout','🔄\x20REFUND:\x20Payment\x20amount\x20already\x20deducted\x20from\x20balance','asc','NONEXISTENT_GATEWAY_FILTER','merchantEarningsUSDT','notes','💸\x20CHARGEBACK:\x20Merchant\x20amount\x20already\x20deducted\x20from\x20balance','sk_','\x20USDT\x20(gross\x20revenue)','📊\x20Total\x20payments\x20(including\x20failed):\x20','getPayoutById','\x20USDT\x20(theoretical\x20net)','cointopay2','week','externalPaymentUrl','\x27\x20not\x20found.\x20Available\x20gateways:\x20','\x20USDT\x20(','3222254mRhcAS','payment','Rapyd','📊\x20Calculating\x20commission\x20manually\x20for\x20payment\x20','\x20\x20\x20💸\x20Total\x20payouts:\x20','setDate','15556XiIySq','statusChangedBy','forEach','100HVVLsc','\x20USDT,\x20merchant:\x20','statusChangedAt','gatewayEarnings','toISOString','custom','random','values','\x20USDT\x20(total\x20paid\x20to\x20merchants)','\x20\x20\x20⏳\x20Awaiting\x20payout:\x20','ceil','desc','PAID','gte','day','_sum','publicKey','\x20has\x20zero\x20or\x20null\x20amountUSDT,\x20skipping...','MasterCard','Insufficient\x20balance.\x20Available:\x20','Telegram\x20username\x20already\x20exists','bcryptjs','includes','📊\x20Gateway\x20filter\x20applied:','19800492petoKT','failureMessage','getMonth','getTime','pk_','amountAfterGatewayCommissionUSDT','warn','Error\x20parsing\x20gateway\x20settings\x20for\x20shop\x20','cointopay','⚠️\x20Gateway\x20\x27',']\x20Gateway\x20settings\x20before\x20saving:','count','📊\x20[ADMIN]\x20Using\x20saved\x20amountAfterGatewayCommissionUSDT:\x20','currencyService','getGatewayIdByName','username','length','network','yesterday','✅\x20Using\x20gateway\x20filter:\x20\x27','getPayoutStats','localeCompare','periodFrom','Payment\x20not\x20found','failUrl','totalPaidOut','getDate','create','\x20balance\x20updated:',']\x20Password\x20not\x20provided\x20or\x20empty,\x20skipping\x20password\x20update','averageCommissionRate','getSystemStatistics','push','totalPayout','totalAmountUSDT','activateUser','\x20USDT)','groupBy','lte',',\x20Commission:\x20','💰\x20Creating\x20payout\x20for\x20shop\x20','Plisio','noda','💰\x20[PAYOUT]\x20Gateway\x20','90d',']\x20Updating\x20password\x20for\x20user\x20','\x20\x20\x20⏳\x20Pending\x20payout:\x20','%\x20from\x20','name','shopId','customerName','\x20status:\x20','usdtTrcWallet','delete','all','../types/gateway','insensitive','\x20\x20\x20📅\x20This\x20month:\x20','hex','shopUrl','590466LetLPx','\x20USDT\x20(after\x20','plisio','getAllUsers','sort','\x20->\x20','55seeUvu','\x20\x20\x20Subtracted\x20from\x20balance:\x20-','📊\x20Calculating\x20payout\x20statistics...','gateway','\x20\x20\x20📅\x20Total\x20payouts\x20(this\x20month):\x20','KLYME\x20GB','customerCountry','_count','toString','\x20active\x20merchants\x20for\x20selection','💳\x20Payout\x20wallet\x20for\x20','📊\x20Merchant\x20statistics\x20calculated:','SUSPENDED','wallets','map','Error\x20parsing\x20gateway\x20settings\x20for\x20payment\x20','amountUSDT','\x20\x20\x20Added\x20to\x20balance:\x20+','deletePayout','\x20paid\x20payments\x20for\x20analysis','availableBalance','\x20\x20\x20Transaction\x20hash:\x20','⚠️\x20Payment\x20','entries','customerUa','\x20\x20\x20💳\x20Total\x20payments:\x20','generateDailyStatistics','\x20\x20\x20💵\x20Available\x20balance:\x20','shop','\x20no\x20longer\x20PAID:','getGatewayNameById','paidAt','\x27\x20->\x20ID\x20\x27','status','telegram','📊\x20Getting\x20merchant\x20statistics\x20with\x20filters:','trim','AdminService','successUrl','admin','totalPayments','\x20USDT\x20(+','totalAmountAfterCommissionUSDT','round','\x20\x20\x20💰\x20Total\x20turnover:\x20','paymentsCount','test_gateway','aggregate','../config/database','3983919rjBvjY','\x27\x20(from\x20\x27','\x20\x20\x20💸\x20Total\x20payouts\x20(all\x20time):\x20','turnoverUSDT','some','thisMonth','log','7043535iSEEQV','not\x20specified','gatewayOrderId'];a36_0x4e68=function(){return _0x41ef90;};return a36_0x4e68();}class AdminService{async[a36_0x545440(0x161)](){const _0x593d6b=a36_0x545440;console[_0x593d6b(0x86)](_0x593d6b(0x191));const _0x4bcf75=await database_1[_0x593d6b(0x90)][_0x593d6b(0x1ab)][_0x593d6b(0x7e)]({'_sum':{'balance':!![],'totalPaidOut':!![]},'where':{'status':_0x593d6b(0xeb)}}),_0x1be362=await database_1['default'][_0x593d6b(0x12d)][_0x593d6b(0x158)]({'where':{'status':'PAID','gateway':{'not':_0x593d6b(0x7d)}}}),_0x135ad7=new Date(),_0x145271=new Date(_0x135ad7['getFullYear'](),_0x135ad7['getMonth'](),0x1),_0x49e227=new Date(_0x135ad7[_0x593d6b(0xbf)](),_0x135ad7[_0x593d6b(0x14f)]()+0x1,0x0,0x17,0x3b,0x3b,0x3e7),_0x276a2e=await database_1[_0x593d6b(0x90)][_0x593d6b(0xf3)]['aggregate']({'_sum':{'amount':!![]},'where':{'createdAt':{'gte':_0x145271,'lte':_0x49e227},'status':'COMPLETED'}}),_0x4a7720=_0x4bcf75[_0x593d6b(0x144)]['totalPaidOut']||0x0,_0x4882fc=_0x4bcf75[_0x593d6b(0x144)][_0x593d6b(0x111)]||0x0,_0x557980=_0x276a2e[_0x593d6b(0x144)][_0x593d6b(0xda)]||0x0,_0x29d5ee={'totalPayout':Math[_0x593d6b(0x7a)](_0x4a7720*0x64)/0x64,'awaitingPayout':Math[_0x593d6b(0x7a)](_0x4882fc*0x64)/0x64,'thisMonth':Math[_0x593d6b(0x7a)](_0x557980*0x64)/0x64,'availableBalance':Math[_0x593d6b(0x7a)](_0x4882fc*0x64)/0x64,'totalPayments':_0x1be362};return console[_0x593d6b(0x86)]('📊\x20Payout\x20statistics\x20calculated:'),console[_0x593d6b(0x86)](_0x593d6b(0x108)+_0x29d5ee['totalPayout']+_0x593d6b(0x13d)),console['log'](_0x593d6b(0x13e)+_0x29d5ee[_0x593d6b(0x11b)]+'\x20USDT\x20(sum\x20of\x20all\x20merchant\x20balances)'),console[_0x593d6b(0x86)](_0x593d6b(0x1aa)+_0x29d5ee[_0x593d6b(0x1a3)]+_0x593d6b(0xfe)),console[_0x593d6b(0x86)](_0x593d6b(0x186)+_0x29d5ee[_0x593d6b(0x85)]+_0x593d6b(0xb4)),console['log'](_0x593d6b(0x1a8)+_0x29d5ee[_0x593d6b(0x77)]+'\x20PAID\x20payments'),_0x29d5ee;}async['updateCustomerData'](_0x419843,_0x26a0da){const _0x4446c1=a36_0x545440;console['log']('🔄\x20Updating\x20customer\x20data\x20for\x20payment\x20'+_0x419843+':',_0x26a0da);const _0xf59a87=await database_1[_0x4446c1(0x90)]['payment']['findUnique']({'where':{'id':_0x419843},'select':{'id':!![],'customerEmail':!![],'customerName':!![],'customerCountry':!![],'customerIp':!![],'customerUa':!![]}});if(!_0xf59a87)throw new Error(_0x4446c1(0x164));const _0x271b30={};_0x26a0da['customerCountry']!==undefined&&(_0x271b30[_0x4446c1(0x195)]=_0x26a0da[_0x4446c1(0x195)]||null);_0x26a0da[_0x4446c1(0xb5)]!==undefined&&(_0x271b30[_0x4446c1(0xb5)]=_0x26a0da[_0x4446c1(0xb5)]||null);_0x26a0da[_0x4446c1(0x1a7)]!==undefined&&(_0x271b30[_0x4446c1(0x1a7)]=_0x26a0da[_0x4446c1(0x1a7)]||null);const _0x130d1c=await database_1['default'][_0x4446c1(0x12d)][_0x4446c1(0xc0)]({'where':{'id':_0x419843},'data':{..._0x271b30,'updatedAt':new Date()},'select':{'id':!![],'customerEmail':!![],'customerName':!![],'customerCountry':!![],'customerIp':!![],'customerUa':!![],'updatedAt':!![]}});return console['log'](_0x4446c1(0x8a)+_0x419843),console[_0x4446c1(0x86)](_0x4446c1(0xf0)+_0xf59a87[_0x4446c1(0x195)]+'\x20->\x20'+_0x130d1c['customerCountry']),console[_0x4446c1(0x86)](_0x4446c1(0xe7)+_0xf59a87['customerIp']+_0x4446c1(0x18e)+_0x130d1c['customerIp']),console[_0x4446c1(0x86)](_0x4446c1(0xd0)+(_0xf59a87['customerUa']?'set':_0x4446c1(0xb2))+_0x4446c1(0x18e)+(_0x130d1c[_0x4446c1(0x1a7)]?_0x4446c1(0x110):'not\x20set')),_0x130d1c;}async[a36_0x545440(0x16c)](_0xa353e){const _0x51bba0=a36_0x545440,_0x4febbf=new Date();let _0x394a72;switch(_0xa353e['toLowerCase']()){case _0x51bba0(0x143):_0x394a72=new Date(_0x4febbf[_0x51bba0(0xbf)](),_0x4febbf['getMonth'](),_0x4febbf[_0x51bba0(0x167)](),0x0,0x0,0x0,0x0);break;case _0x51bba0(0x15f):const _0x1c0339=new Date(_0x4febbf);_0x1c0339['setDate'](_0x1c0339[_0x51bba0(0x167)]()-0x1),_0x394a72=new Date(_0x1c0339[_0x51bba0(0xbf)](),_0x1c0339[_0x51bba0(0x14f)](),_0x1c0339[_0x51bba0(0x167)](),0x0,0x0,0x0,0x0);break;case'7d':_0x394a72=new Date(_0x4febbf[_0x51bba0(0x150)]()-0x7*0x18*0x3c*0x3c*0x3e8);break;case'30d':_0x394a72=new Date(_0x4febbf['getTime']()-0x1e*0x18*0x3c*0x3c*0x3e8);break;case _0x51bba0(0x179):_0x394a72=new Date(_0x4febbf[_0x51bba0(0x150)]()-0x5a*0x18*0x3c*0x3c*0x3e8);break;case'all':const _0xfc59a5=await database_1[_0x51bba0(0x90)][_0x51bba0(0x12d)][_0x51bba0(0xfb)]({'where':{'gateway':{'not':_0x51bba0(0x7d)}},'orderBy':{'createdAt':_0x51bba0(0x11d)},'select':{'createdAt':!![]}});_0x394a72=_0xfc59a5?_0xfc59a5[_0x51bba0(0xcc)]:new Date('2020-01-01');break;default:_0x394a72=new Date(_0x4febbf['getTime']()-0x1e*0x18*0x3c*0x3c*0x3e8);}_0x394a72[_0x51bba0(0x103)](0x0,0x0,0x0,0x0);let _0xb105c3;if(_0xa353e['toLowerCase']()===_0x51bba0(0x15f)){const _0x4f8f79=new Date(_0x4febbf);_0x4f8f79[_0x51bba0(0x131)](_0x4f8f79['getDate']()-0x1),_0xb105c3=new Date(_0x4f8f79['getFullYear'](),_0x4f8f79['getMonth'](),_0x4f8f79['getDate'](),0x17,0x3b,0x3b,0x3e7);}const _0x3ce52f={'gte':_0x394a72};_0xb105c3&&(_0x3ce52f['lte']=_0xb105c3);const [_0x533903,_0x4fd8d2,_0x3bb5fe,_0x18c707,_0x259eae,_0x4a886f]=await Promise[_0x51bba0(0x183)]([database_1['default'][_0x51bba0(0x1ab)]['count'](),database_1[_0x51bba0(0x90)][_0x51bba0(0x1ab)]['count']({'where':{'status':_0x51bba0(0xeb)}}),database_1[_0x51bba0(0x90)][_0x51bba0(0x12d)][_0x51bba0(0x158)]({'where':{'status':_0x51bba0(0x141),'createdAt':_0x3ce52f,'gateway':{'not':'test_gateway'}}}),database_1[_0x51bba0(0x90)][_0x51bba0(0x12d)][_0x51bba0(0x9e)]({'where':{'status':_0x51bba0(0x141),'createdAt':_0x3ce52f,'gateway':{'not':_0x51bba0(0x7d)}},'select':{'amount':!![],'currency':!![],'amountAfterGatewayCommissionUSDT':!![]}}),database_1[_0x51bba0(0x90)][_0x51bba0(0x12d)][_0x51bba0(0x9e)]({'where':{'gateway':{'not':_0x51bba0(0x7d)}},'take':0xa,'orderBy':{'createdAt':_0x51bba0(0x140)},'include':{'shop':{'select':{'name':!![],'username':!![]}}}}),database_1[_0x51bba0(0x90)][_0x51bba0(0x12d)][_0x51bba0(0x9e)]({'where':{'createdAt':_0x3ce52f,'gateway':{'not':_0x51bba0(0x7d)}},'select':{'amount':!![],'currency':!![],'status':!![],'amountUSDT':!![],'createdAt':!![]}})]);let _0x433aae=0x0,_0x60ccf4=0x0;for(const _0x5e86d6 of _0x18c707){const _0x2bc40d=await currencyService_1[_0x51bba0(0x15a)][_0x51bba0(0xc2)](_0x5e86d6[_0x51bba0(0xda)],_0x5e86d6[_0x51bba0(0xe1)]);_0x433aae+=_0x2bc40d;if(_0x5e86d6['amountAfterGatewayCommissionUSDT']){const _0x5041c9=await currencyService_1['currencyService']['convertToUSDT'](_0x5e86d6['amount'],_0x5e86d6[_0x51bba0(0xe1)]),_0x3557c9=_0x5e86d6[_0x51bba0(0x152)],_0x46edc0=_0x5041c9-_0x3557c9;_0x60ccf4+=_0x46edc0;}}const _0x597597=_0x3bb5fe>0x0?_0x433aae/_0x3bb5fe:0x0,_0x4cdfc3=this[_0x51bba0(0x1a9)](_0x4a886f,_0x394a72,_0xb105c3||_0x4febbf),_0x3d7ef0=await database_1[_0x51bba0(0x90)][_0x51bba0(0x12d)]['count']({'where':{'createdAt':_0x3ce52f,'gateway':{'not':_0x51bba0(0x7d)}}}),_0x45574e=_0x3d7ef0>0x0?_0x3bb5fe/_0x3d7ef0*0x64:0x0;return{'totalShops':_0x533903,'activeShops':_0x4fd8d2,'totalPayments':_0x3bb5fe,'successfulPayments':_0x3bb5fe,'totalAttempts':_0x3d7ef0,'totalRevenue':Math['round'](_0x433aae*0x64)/0x64,'trapayEarnings':Math[_0x51bba0(0x7a)](_0x60ccf4*0x64)/0x64,'averagePaymentAmount':Math[_0x51bba0(0x7a)](_0x597597*0x64)/0x64,'conversionRate':Math['round'](_0x45574e*0x64)/0x64,'dailyRevenue':_0x4cdfc3[_0x51bba0(0x104)],'dailyPayments':_0x4cdfc3[_0x51bba0(0x10b)],'recentPayments':_0x259eae[_0x51bba0(0x19d)](_0x3b7a8c=>({'id':_0x3b7a8c['id'],'amount':_0x3b7a8c[_0x51bba0(0xda)],'currency':_0x3b7a8c[_0x51bba0(0xe1)],'status':_0x3b7a8c['status'],'gateway':_0x3b7a8c[_0x51bba0(0x192)],'shop':_0x3b7a8c['shop'],'createdAt':_0x3b7a8c['createdAt']}))};}async[a36_0x545440(0xa2)](_0x871dc1){const _0x717d57=a36_0x545440;console[_0x717d57(0x86)](_0x717d57(0x72),_0x871dc1);let _0x47d09b,_0x235a34=new Date();if(_0x871dc1[_0x717d57(0xf7)]==='custom'&&_0x871dc1[_0x717d57(0xc5)]&&_0x871dc1['dateTo'])_0x47d09b=new Date(_0x871dc1[_0x717d57(0xc5)]),_0x235a34=new Date(_0x871dc1[_0x717d57(0xca)]),_0x47d09b[_0x717d57(0x103)](0x0,0x0,0x0,0x0),_0x235a34[_0x717d57(0x103)](0x17,0x3b,0x3b,0x3e7);else{const _0x417a18=new Date();switch(_0x871dc1[_0x717d57(0xf7)]){case _0x717d57(0x128):_0x47d09b=new Date(_0x417a18[_0x717d57(0x150)]()-0x7*0x18*0x3c*0x3c*0x3e8);break;case'month':_0x47d09b=new Date(_0x417a18[_0x717d57(0x150)]()-0x1e*0x18*0x3c*0x3c*0x3e8);break;case _0x717d57(0xf9):_0x47d09b=new Date(_0x417a18['getTime']()-0x16d*0x18*0x3c*0x3c*0x3e8);break;case _0x717d57(0x183):default:_0x47d09b=new Date(_0x717d57(0xbe));break;}_0x47d09b[_0x717d57(0x103)](0x0,0x0,0x0,0x0),_0x235a34[_0x717d57(0x103)](0x17,0x3b,0x3b,0x3e7);}console[_0x717d57(0x86)]('📅\x20Period:\x20'+_0x47d09b['toISOString']()+'\x20to\x20'+_0x235a34[_0x717d57(0x139)]());const _0x4439b7={'status':_0x717d57(0x141),'gateway':{'not':_0x717d57(0x7d)},'paidAt':{'gte':_0x47d09b,'lte':_0x235a34}};_0x871dc1['shopId']&&(_0x4439b7[_0x717d57(0x17e)]=_0x871dc1[_0x717d57(0x17e)]);const _0x77be41=await database_1[_0x717d57(0x90)][_0x717d57(0x12d)]['findMany']({'where':_0x4439b7,'select':{'id':!![],'amount':!![],'currency':!![],'amountUSDT':!![],'amountAfterGatewayCommissionUSDT':!![],'gatewayCommissionRate':!![],'gateway':!![],'shopId':!![],'paidAt':!![],'shop':{'select':{'id':!![],'name':!![],'username':!![],'gatewaySettings':!![]}}}});console['log']('💰\x20Found\x20'+_0x77be41[_0x717d57(0x15d)]+_0x717d57(0x1a2));const _0x2afede={'gateway':{'not':_0x717d57(0x7d)},'createdAt':{'gte':_0x47d09b,'lte':_0x235a34}};_0x871dc1['shopId']&&(_0x2afede[_0x717d57(0x17e)]=_0x871dc1[_0x717d57(0x17e)]);const _0x3323e5=await database_1[_0x717d57(0x90)][_0x717d57(0x12d)][_0x717d57(0x158)]({'where':_0x2afede});console['log'](_0x717d57(0x124)+_0x3323e5+',\x20successful:\x20'+_0x77be41[_0x717d57(0x15d)]);let _0x22bb3c=0x0,_0x439e83=0x0,_0x4051c4=0x0;const _0x798562={},_0x5e6567={},_0x5b3700={};for(const _0x37595d of _0x77be41){try{const _0x53cab4=_0x37595d[_0x717d57(0x19f)]||0x0;if(_0x53cab4<=0x0){console[_0x717d57(0x153)](_0x717d57(0x1a5)+_0x37595d['id']+_0x717d57(0x146));continue;}let _0x158fa9,_0x1eb5cd;if(_0x37595d[_0x717d57(0x152)]!==null&&_0x37595d[_0x717d57(0x152)]!==undefined)_0x158fa9=_0x37595d[_0x717d57(0x152)],_0x1eb5cd=_0x53cab4-_0x158fa9,console['log']('📊\x20Using\x20saved\x20values\x20for\x20payment\x20'+_0x37595d['id']+':\x20'+_0x53cab4[_0x717d57(0x114)](0x6)+_0x717d57(0x136)+_0x158fa9[_0x717d57(0x114)](0x6)+'\x20USDT');else{let _0x216056={};if(_0x37595d[_0x717d57(0x1ab)]['gatewaySettings'])try{_0x216056=JSON['parse'](_0x37595d[_0x717d57(0x1ab)]['gatewaySettings']);}catch(_0x41b736){console['error'](_0x717d57(0x154)+_0x37595d[_0x717d57(0x17e)]+':',_0x41b736);}let _0xc4d2d4=0x2d;for(const [_0x54886f,_0x4e78ac]of Object[_0x717d57(0x1a6)](_0x216056)){if(_0x54886f[_0x717d57(0xec)]()===_0x37595d['gateway']['toLowerCase']()){_0xc4d2d4=_0x4e78ac[_0x717d57(0xdb)]||0x2d;break;}}_0x1eb5cd=_0x53cab4*(_0xc4d2d4/0x64),_0x158fa9=_0x53cab4-_0x1eb5cd,console[_0x717d57(0x86)](_0x717d57(0x12f)+_0x37595d['id']+':\x20'+_0xc4d2d4+'%\x20from\x20'+_0x53cab4[_0x717d57(0x114)](0x6)+'\x20USDT');}_0x22bb3c+=_0x53cab4,_0x439e83+=_0x158fa9,_0x4051c4+=_0x1eb5cd;let _0x3e8562;_0x37595d[_0x717d57(0xea)]!==null&&_0x37595d['gatewayCommissionRate']!==undefined?(_0x3e8562=_0x37595d[_0x717d57(0xea)],console[_0x717d57(0x86)](_0x717d57(0x118)+_0x37595d['id']+':\x20'+_0x3e8562+'%')):(_0x3e8562=_0x53cab4>0x0?_0x1eb5cd/_0x53cab4*0x64:0x0,console[_0x717d57(0x86)]('📊\x20Calculated\x20commission\x20rate\x20for\x20payment\x20'+_0x37595d['id']+':\x20'+_0x3e8562[_0x717d57(0x114)](0x2)+'%'));!_0x798562[_0x37595d[_0x717d57(0x192)]]&&(_0x798562[_0x37595d[_0x717d57(0x192)]]={'gateway':_0x37595d[_0x717d57(0x192)],'gatewayDisplayName':this[_0x717d57(0xdc)](_0x37595d[_0x717d57(0x192)]),'paymentsCount':0x0,'turnoverUSDT':0x0,'commissionUSDT':0x0,'merchantEarningsUSDT':0x0,'totalCommissionRate':0x0});_0x798562[_0x37595d['gateway']][_0x717d57(0x7c)]++,_0x798562[_0x37595d[_0x717d57(0x192)]][_0x717d57(0x83)]+=_0x53cab4,_0x798562[_0x37595d['gateway']][_0x717d57(0x107)]+=_0x1eb5cd,_0x798562[_0x37595d[_0x717d57(0x192)]][_0x717d57(0x11f)]+=_0x158fa9,_0x798562[_0x37595d[_0x717d57(0x192)]][_0x717d57(0x9f)]+=_0x3e8562;!_0x871dc1[_0x717d57(0x17e)]&&(!_0x5e6567[_0x37595d[_0x717d57(0x17e)]]&&(_0x5e6567[_0x37595d['shopId']]={'shopId':_0x37595d[_0x717d57(0x17e)],'shopName':_0x37595d['shop'][_0x717d57(0x17d)],'shopUsername':_0x37595d[_0x717d57(0x1ab)][_0x717d57(0x15c)],'paymentsCount':0x0,'turnoverUSDT':0x0,'commissionUSDT':0x0,'merchantEarningsUSDT':0x0,'paidOutUSDT':0x0,'averageCheckUSDT':0x0}),_0x5e6567[_0x37595d['shopId']][_0x717d57(0x7c)]++,_0x5e6567[_0x37595d[_0x717d57(0x17e)]][_0x717d57(0x83)]+=_0x53cab4,_0x5e6567[_0x37595d['shopId']]['commissionUSDT']+=_0x1eb5cd,_0x5e6567[_0x37595d[_0x717d57(0x17e)]]['merchantEarningsUSDT']+=_0x158fa9);const _0x60f576=_0x37595d[_0x717d57(0x1ae)][_0x717d57(0x139)]()[_0x717d57(0x10d)]('T')[0x0];!_0x5b3700[_0x60f576]&&(_0x5b3700[_0x60f576]={'date':_0x60f576,'turnover':0x0,'merchantEarnings':0x0,'gatewayEarnings':0x0,'paymentsCount':0x0}),_0x5b3700[_0x60f576][_0x717d57(0x91)]+=_0x53cab4,_0x5b3700[_0x60f576]['merchantEarnings']+=_0x158fa9,_0x5b3700[_0x60f576][_0x717d57(0x138)]+=_0x1eb5cd,_0x5b3700[_0x60f576][_0x717d57(0x7c)]++;}catch(_0x3415b5){console['error']('Error\x20processing\x20payment\x20'+_0x37595d['id']+':',_0x3415b5);}}Object[_0x717d57(0x13c)](_0x798562)[_0x717d57(0x134)](_0x5a2c4a=>{const _0x559300=_0x717d57;_0x5a2c4a[_0x559300(0x16b)]=_0x5a2c4a['paymentsCount']>0x0?_0x5a2c4a[_0x559300(0x9f)]/_0x5a2c4a['paymentsCount']:0x0,delete _0x5a2c4a[_0x559300(0x9f)];}),Object[_0x717d57(0x13c)](_0x5e6567)[_0x717d57(0x134)](_0x3e0fa5=>{const _0x3d3c30=_0x717d57;_0x3e0fa5[_0x3d3c30(0xb1)]=_0x3e0fa5[_0x3d3c30(0x7c)]>0x0?_0x3e0fa5[_0x3d3c30(0x83)]/_0x3e0fa5[_0x3d3c30(0x7c)]:0x0;});let _0x1f9573=0x0,_0x596587=0x0;if(_0x871dc1['shopId']){const _0x16d0c5=await database_1[_0x717d57(0x90)][_0x717d57(0xf3)]['findMany']({'where':{'shopId':_0x871dc1[_0x717d57(0x17e)],'status':_0x717d57(0xbd),'createdAt':{'gte':_0x47d09b,'lte':_0x235a34}},'select':{'amount':!![]}});_0x1f9573=_0x16d0c5[_0x717d57(0x8f)]((_0x144e85,_0x3c04d7)=>_0x144e85+_0x3c04d7['amount'],0x0);const _0x450986=await database_1[_0x717d57(0x90)][_0x717d57(0xf3)][_0x717d57(0x9e)]({'where':{'shopId':_0x871dc1[_0x717d57(0x17e)],'status':_0x717d57(0xa4),'createdAt':{'gte':_0x47d09b,'lte':_0x235a34}},'select':{'amount':!![]}});_0x596587=_0x450986['reduce']((_0x1ac062,_0x163cc4)=>_0x1ac062+_0x163cc4[_0x717d57(0xda)],0x0);}const _0x29491e=_0x3323e5,_0x391886=_0x77be41['length'],_0xbaaaa1=_0x391886>0x0?_0x22bb3c/_0x391886:0x0,_0x38dcdc=_0x29491e>0x0?Math['round'](_0x391886/_0x29491e*0x2710)/0x64:0x0,_0x3ddcf5=Math[_0x717d57(0x13f)]((_0x235a34[_0x717d57(0x150)]()-_0x47d09b[_0x717d57(0x150)]())/(0x3e8*0x3c*0x3c*0x18)),_0x50354f={'totalTurnover':Math[_0x717d57(0x7a)](_0x22bb3c*0x64)/0x64,'merchantEarnings':Math[_0x717d57(0x7a)](_0x439e83*0x64)/0x64,'gatewayEarnings':Math['round'](_0x4051c4*0x64)/0x64,'totalPaidOut':Math['round'](_0x1f9573*0x64)/0x64,'pendingPayout':Math[_0x717d57(0x7a)](_0x596587*0x64)/0x64,'averageCheck':Math[_0x717d57(0x7a)](_0xbaaaa1*0x64)/0x64,'totalPayments':_0x29491e,'successfulPayments':_0x391886,'conversionRate':_0x38dcdc,'gatewayBreakdown':Object[_0x717d57(0x13c)](_0x798562)['map'](_0x583482=>({..._0x583482,'turnoverUSDT':Math[_0x717d57(0x7a)](_0x583482[_0x717d57(0x83)]*0x64)/0x64,'commissionUSDT':Math[_0x717d57(0x7a)](_0x583482[_0x717d57(0x107)]*0x64)/0x64,'merchantEarningsUSDT':Math[_0x717d57(0x7a)](_0x583482[_0x717d57(0x11f)]*0x64)/0x64,'averageCommissionRate':Math['round'](_0x583482['averageCommissionRate']*0x64)/0x64})),'merchantBreakdown':_0x871dc1[_0x717d57(0x17e)]?undefined:Object[_0x717d57(0x13c)](_0x5e6567)[_0x717d57(0x19d)](_0x11c9d0=>({..._0x11c9d0,'turnoverUSDT':Math['round'](_0x11c9d0['turnoverUSDT']*0x64)/0x64,'commissionUSDT':Math['round'](_0x11c9d0[_0x717d57(0x107)]*0x64)/0x64,'merchantEarningsUSDT':Math['round'](_0x11c9d0[_0x717d57(0x11f)]*0x64)/0x64,'paidOutUSDT':Math[_0x717d57(0x7a)](_0x11c9d0[_0x717d57(0xe5)]*0x64)/0x64,'averageCheckUSDT':Math['round'](_0x11c9d0[_0x717d57(0xb1)]*0x64)/0x64})),'dailyData':Object[_0x717d57(0x13c)](_0x5b3700)[_0x717d57(0x19d)](_0x2a13a5=>({..._0x2a13a5,'turnover':Math[_0x717d57(0x7a)](_0x2a13a5[_0x717d57(0x91)]*0x64)/0x64,'merchantEarnings':Math[_0x717d57(0x7a)](_0x2a13a5[_0x717d57(0xfc)]*0x64)/0x64,'gatewayEarnings':Math['round'](_0x2a13a5[_0x717d57(0x138)]*0x64)/0x64}))[_0x717d57(0x18d)]((_0x1a569f,_0x2ff42c)=>_0x1a569f[_0x717d57(0xcf)][_0x717d57(0x162)](_0x2ff42c[_0x717d57(0xcf)])),'periodInfo':{'from':_0x47d09b,'to':_0x235a34,'periodType':_0x871dc1[_0x717d57(0xf7)]||_0x717d57(0x13a),'daysCount':_0x3ddcf5}};return console[_0x717d57(0x86)](_0x717d57(0x19a)),console[_0x717d57(0x86)](_0x717d57(0x7b)+_0x50354f[_0x717d57(0xde)]+'\x20USDT'),console[_0x717d57(0x86)]('\x20\x20\x20👤\x20Merchant\x20earnings:\x20'+_0x50354f[_0x717d57(0xfc)]+'\x20USDT'),console['log'](_0x717d57(0xf1)+_0x50354f[_0x717d57(0x138)]+_0x717d57(0xb4)),console[_0x717d57(0x86)](_0x717d57(0xd2)+_0x50354f[_0x717d57(0x166)]+_0x717d57(0xb4)),console[_0x717d57(0x86)](_0x717d57(0x17b)+_0x50354f['pendingPayout']+_0x717d57(0xb4)),console[_0x717d57(0x86)](_0x717d57(0xff)+_0x50354f[_0x717d57(0x77)]),_0x50354f;}async[a36_0x545440(0x10f)](){const _0x457c11=a36_0x545440;console[_0x457c11(0x86)](_0x457c11(0xc9));const _0x2d2651=await database_1[_0x457c11(0x90)][_0x457c11(0x1ab)][_0x457c11(0x9e)]({'where':{'status':'ACTIVE'},'select':{'id':!![],'username':!![],'name':!![]},'orderBy':{'name':_0x457c11(0x11d)}});return console[_0x457c11(0x86)]('📋\x20Found\x20'+_0x2d2651[_0x457c11(0x15d)]+_0x457c11(0x198)),_0x2d2651['map'](_0x5685d1=>({'id':_0x5685d1['id'],'username':_0x5685d1[_0x457c11(0x15c)],'name':_0x5685d1[_0x457c11(0x17d)]}));}[a36_0x545440(0xdc)](_0x365c9f){const _0x59480e=a36_0x545440,_0x2b7b6b={'test_gateway':'Test\x20Gateway','plisio':_0x59480e(0x176),'rapyd':_0x59480e(0x12e),'noda':'Noda','cointopay':'CoinToPay','cointopay2':_0x59480e(0xaf),'klyme_eu':'KLYME\x20EU','klyme_gb':_0x59480e(0x194),'klyme_de':'KLYME\x20DE','mastercard':_0x59480e(0x147)};return _0x2b7b6b[_0x365c9f]||_0x365c9f;}[a36_0x545440(0xdd)](_0x19c68d){const _0x219955=a36_0x545440,_0x149b2f={'Test\x20Gateway':_0x219955(0x7d),'Plisio':_0x219955(0x18b),'Rapyd':_0x219955(0xd7),'Noda':_0x219955(0x177),'CoinToPay':_0x219955(0x155),'CoinToPay2':_0x219955(0x127),'KLYME\x20EU':_0x219955(0xce),'KLYME\x20GB':'klyme_gb','KLYME\x20DE':'klyme_de','MasterCard':_0x219955(0xa9)};return _0x149b2f[_0x19c68d]||_0x19c68d['toLowerCase']();}async[a36_0x545440(0x10a)](_0x4e5feb){const _0x152397=a36_0x545440,{page:_0x5384ca,limit:_0x5d0b21,minAmount:_0x534f96,search:_0x3bf867}=_0x4e5feb,_0x174fc2=(_0x5384ca-0x1)*_0x5d0b21;console[_0x152397(0x86)]('📊\x20Getting\x20merchants\x20awaiting\x20payout\x20with\x20filters:',_0x4e5feb);const _0x25935f={'balance':{'gt':0x0},'status':_0x152397(0xeb)};_0x534f96&&(_0x25935f['balance'][_0x152397(0x142)]=_0x534f96);_0x3bf867&&(_0x25935f[_0x152397(0x17d)]={'contains':_0x3bf867,'mode':_0x152397(0x185)});const [_0x4722d0,_0x36d2cb]=await Promise['all']([database_1[_0x152397(0x90)]['shop'][_0x152397(0x9e)]({'where':_0x25935f,'skip':_0x174fc2,'take':_0x5d0b21,'orderBy':{'balance':_0x152397(0x140)},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'balance':!![],'totalPaidOut':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'gatewaySettings':!![],'createdAt':!![]}}),database_1[_0x152397(0x90)][_0x152397(0x1ab)]['count']({'where':_0x25935f})]);console[_0x152397(0x86)](_0x152397(0xcb)+_0x4722d0[_0x152397(0x15d)]+'\x20merchants\x20with\x20positive\x20balance');const _0x9edd32=await Promise[_0x152397(0x183)](_0x4722d0[_0x152397(0x19d)](async _0x64a66a=>{const _0x2b6691=_0x152397,[_0xe7b5d7,_0x33a339,_0x4eabdd]=await Promise[_0x2b6691(0x183)]([database_1['default'][_0x2b6691(0x12d)]['count']({'where':{'shopId':_0x64a66a['id'],'status':_0x2b6691(0x141),'gateway':{'not':_0x2b6691(0x7d)}}}),database_1['default'][_0x2b6691(0x12d)][_0x2b6691(0xfb)]({'where':{'shopId':_0x64a66a['id'],'status':'PAID','gateway':{'not':_0x2b6691(0x7d)}},'orderBy':{'paidAt':_0x2b6691(0x11d)},'select':{'paidAt':!![]}}),database_1[_0x2b6691(0x90)][_0x2b6691(0x12d)][_0x2b6691(0x172)]({'by':[_0x2b6691(0x192)],'where':{'shopId':_0x64a66a['id'],'status':_0x2b6691(0x141),'gateway':{'not':_0x2b6691(0x7d)}},'_count':{'id':!![]},'_sum':{'amountUSDT':!![]}})]),_0x3129bf=new Date(),_0x14355e=new Date(_0x3129bf[_0x2b6691(0xbf)](),_0x3129bf[_0x2b6691(0x14f)](),0x1),_0x3b1b5d=new Date(_0x3129bf['getFullYear'](),_0x3129bf[_0x2b6691(0x14f)]()+0x1,0x0,0x17,0x3b,0x3b,0x3e7),[_0x4f7b92,_0xfc4a32]=await Promise[_0x2b6691(0x183)]([database_1[_0x2b6691(0x90)]['payout']['aggregate']({'_sum':{'amount':!![]},'where':{'shopId':_0x64a66a['id'],'status':_0x2b6691(0xbd)}}),database_1[_0x2b6691(0x90)][_0x2b6691(0xf3)][_0x2b6691(0x7e)]({'_sum':{'amount':!![]},'where':{'shopId':_0x64a66a['id'],'status':_0x2b6691(0xbd),'createdAt':{'gte':_0x14355e,'lte':_0x3b1b5d}}})]),_0x224119=_0x4f7b92[_0x2b6691(0x144)]['amount']||0x0,_0x16d2d2=_0xfc4a32[_0x2b6691(0x144)][_0x2b6691(0xda)]||0x0,_0x5a4ad2=await Promise['all'](_0x4eabdd['map'](async _0x445a5e=>{const _0x2859d0=_0x2b6691;let _0x4cca27=0x2d;if(_0x64a66a[_0x2859d0(0xa6)])try{const _0x1f4e6f=JSON[_0x2859d0(0x95)](_0x64a66a[_0x2859d0(0xa6)]);for(const [_0x53025a,_0x131964]of Object['entries'](_0x1f4e6f)){if(_0x53025a['toLowerCase']()===_0x445a5e[_0x2859d0(0x192)][_0x2859d0(0xec)]()){_0x4cca27=_0x131964[_0x2859d0(0xdb)]||0xa,console[_0x2859d0(0x86)](_0x2859d0(0x178)+_0x445a5e[_0x2859d0(0x192)]+'\x20for\x20shop\x20'+_0x64a66a['id']+_0x2859d0(0x8c)+_0x4cca27+'%');break;}}}catch(_0xcb481b){console['error'](_0x2859d0(0x154)+_0x64a66a['id']+':',_0xcb481b);}const _0xa83d8e=_0x445a5e[_0x2859d0(0x144)]?.[_0x2859d0(0x19f)]||0x0,_0x47d342=_0xa83d8e*(0x1-_0x4cca27/0x64);return{'gateway':_0x445a5e['gateway'],'count':_0x445a5e['_count']?.['id']||0x0,'amountUSDT':Math[_0x2859d0(0x7a)](_0xa83d8e*0x64)/0x64,'amountAfterCommissionUSDT':Math[_0x2859d0(0x7a)](_0x47d342*0x64)/0x64,'commission':_0x4cca27};})),_0x421722=_0x5a4ad2[_0x2b6691(0x8f)]((_0x16e2de,_0x4be6e9)=>_0x16e2de+_0x4be6e9[_0x2b6691(0x19f)],0x0),_0x379a74=_0x5a4ad2['reduce']((_0x591a81,_0x4a00f9)=>_0x591a81+_0x4a00f9['amountAfterCommissionUSDT'],0x0),_0x55fc02=_0x64a66a[_0x2b6691(0x111)];return console['log'](_0x2b6691(0xef)+_0x64a66a[_0x2b6691(0x15c)]+':'),console[_0x2b6691(0x86)](_0x2b6691(0xb3)+_0x421722['toFixed'](0x2)+_0x2b6691(0x123)),console[_0x2b6691(0x86)](_0x2b6691(0xee)+_0x379a74[_0x2b6691(0x114)](0x2)+_0x2b6691(0x126)),console[_0x2b6691(0x86)](_0x2b6691(0xb7)+_0x55fc02[_0x2b6691(0x114)](0x2)+'\x20USDT\x20(current\x20balance\x20in\x20DB)'),console[_0x2b6691(0x86)](_0x2b6691(0x130)+_0x224119[_0x2b6691(0x114)](0x2)+_0x2b6691(0xa5)),console[_0x2b6691(0x86)](_0x2b6691(0x8d)+(_0x379a74-_0x224119-_0x55fc02)[_0x2b6691(0x114)](0x2)+_0x2b6691(0xd8)),{'id':_0x64a66a['id'],'fullName':_0x64a66a[_0x2b6691(0x17d)],'username':_0x64a66a[_0x2b6691(0x15c)],'telegramId':_0x64a66a[_0x2b6691(0x1b1)],'merchantUrl':_0x64a66a['shopUrl'],'wallets':{'usdtPolygonWallet':_0x64a66a['usdtPolygonWallet'],'usdtTrcWallet':_0x64a66a['usdtTrcWallet'],'usdtErcWallet':_0x64a66a[_0x2b6691(0x93)],'usdcPolygonWallet':_0x64a66a[_0x2b6691(0xf8)]},'totalAmountUSDT':Math[_0x2b6691(0x7a)](_0x421722*0x64)/0x64,'totalAmountAfterCommissionUSDT':Math['round'](_0x379a74*0x64)/0x64,'currentBalance':Math['round'](_0x55fc02*0x64)/0x64,'totalPayout':Math[_0x2b6691(0x7a)](_0x224119*0x64)/0x64,'thisMonth':Math[_0x2b6691(0x7a)](_0x16d2d2*0x64)/0x64,'paymentsCount':_0xe7b5d7,'oldestPaymentDate':_0x33a339?.[_0x2b6691(0x1ae)]||_0x64a66a[_0x2b6691(0xcc)],'gatewayBreakdown':_0x5a4ad2};})),_0x1e889b=_0x9edd32[_0x152397(0x8f)]((_0x2c11ac,_0x1f604e)=>_0x2c11ac+_0x1f604e[_0x152397(0x16f)],0x0),_0x246acc=_0x9edd32[_0x152397(0x8f)]((_0x3fceed,_0x25338b)=>_0x3fceed+_0x25338b[_0x152397(0x79)],0x0),_0x2fb4f1=_0x9edd32[_0x152397(0x8f)]((_0x5c49c6,_0x2366f0)=>_0x5c49c6+_0x2366f0[_0x152397(0x16e)],0x0),_0x6802a9=_0x9edd32[_0x152397(0x8f)]((_0x3cd432,_0x5d59a0)=>_0x3cd432+_0x5d59a0[_0x152397(0x85)],0x0);return console[_0x152397(0x86)](_0x152397(0xdf)+_0x36d2cb+'\x20merchants'),console[_0x152397(0x86)](_0x152397(0xf5)+Math[_0x152397(0x7a)](_0x1e889b*0x64)/0x64+_0x152397(0x123)),console['log'](_0x152397(0xb9)+Math[_0x152397(0x7a)](_0x246acc*0x64)/0x64+'\x20USDT\x20(actual\x20balances)'),console['log'](_0x152397(0x82)+Math[_0x152397(0x7a)](_0x2fb4f1*0x64)/0x64+_0x152397(0xb4)),console[_0x152397(0x86)](_0x152397(0x193)+Math[_0x152397(0x7a)](_0x6802a9*0x64)/0x64+'\x20USDT'),{'merchants':_0x9edd32,'pagination':{'page':_0x5384ca,'limit':_0x5d0b21,'total':_0x36d2cb,'totalPages':Math[_0x152397(0x13f)](_0x36d2cb/_0x5d0b21)},'summary':{'totalMerchants':_0x36d2cb,'totalAmountUSDT':Math[_0x152397(0x7a)](_0x1e889b*0x64)/0x64,'totalAmountAfterCommissionUSDT':Math['round'](_0x246acc*0x64)/0x64,'totalPayout':Math[_0x152397(0x7a)](_0x2fb4f1*0x64)/0x64,'thisMonth':Math[_0x152397(0x7a)](_0x6802a9*0x64)/0x64}};}async[a36_0x545440(0x98)](_0x5b7f6a){const _0x1b1a73=a36_0x545440,{shopId:_0x58a6a6,amount:_0x5dcad5,network:_0x393e57,wallet:_0x5f5d98,notes:_0x3f61db,txid:_0xfb96cb,periodFrom:_0xbd6b80,periodTo:_0x339b99}=_0x5b7f6a,_0x236765=await database_1[_0x1b1a73(0x90)][_0x1b1a73(0x102)](async _0x1df443=>{const _0x47be1e=_0x1b1a73,_0x129e0b=await _0x1df443[_0x47be1e(0x1ab)][_0x47be1e(0x94)]({'where':{'id':_0x58a6a6},'select':{'id':!![],'name':!![],'username':!![],'balance':!![],'totalPaidOut':!![]}});if(!_0x129e0b)throw new Error('Shop\x20not\x20found');console['log'](_0x47be1e(0x175)+_0x129e0b[_0x47be1e(0x15c)]+':'),console['log'](_0x47be1e(0xc3)+_0x129e0b[_0x47be1e(0x111)][_0x47be1e(0x114)](0x6)+'\x20USDT'),console[_0x47be1e(0x86)](_0x47be1e(0x116)+_0x5dcad5[_0x47be1e(0x114)](0x6)+'\x20USDT'),console['log']('\x20\x20\x20Current\x20total\x20paid\x20out:\x20'+_0x129e0b[_0x47be1e(0x166)][_0x47be1e(0x114)](0x6)+_0x47be1e(0xb4));if(_0xfb96cb)console[_0x47be1e(0x86)](_0x47be1e(0x1a4)+_0xfb96cb);if(_0x129e0b[_0x47be1e(0x111)]<_0x5dcad5)throw new Error(_0x47be1e(0x148)+_0x129e0b[_0x47be1e(0x111)][_0x47be1e(0x114)](0x6)+_0x47be1e(0x100)+_0x5dcad5[_0x47be1e(0x114)](0x6)+_0x47be1e(0xb4));let _0x26dc36=_0x5f5d98;if(!_0x26dc36){const _0x2be3f8=await _0x1df443[_0x47be1e(0x1ab)]['findUnique']({'where':{'id':_0x58a6a6},'select':{'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![]}});if(_0x2be3f8)switch(_0x393e57){case'polygon':_0x26dc36=_0x2be3f8[_0x47be1e(0x115)]||undefined;break;case'trc20':_0x26dc36=_0x2be3f8[_0x47be1e(0x181)]||undefined;break;case'erc20':_0x26dc36=_0x2be3f8[_0x47be1e(0x93)]||undefined;break;case _0x47be1e(0x97):_0x26dc36=_0x2be3f8['usdcPolygonWallet']||undefined;break;}}console[_0x47be1e(0x86)](_0x47be1e(0x199)+_0x393e57+':\x20'+(_0x26dc36||_0x47be1e(0x88)));const _0x1334ea=await _0x1df443[_0x47be1e(0xf3)][_0x47be1e(0x168)]({'data':{'shopId':_0x58a6a6,'amount':_0x5dcad5,'network':_0x393e57,'status':'COMPLETED','txid':_0xfb96cb,'notes':_0x3f61db,'periodFrom':_0xbd6b80?new Date(_0xbd6b80):null,'periodTo':_0x339b99?new Date(_0x339b99):null,'createdAt':new Date(),'paidAt':new Date()}}),_0x1db396=_0x129e0b[_0x47be1e(0x111)]-_0x5dcad5,_0x2357db=_0x129e0b['totalPaidOut']+_0x5dcad5;return await _0x1df443['shop'][_0x47be1e(0xc0)]({'where':{'id':_0x58a6a6},'data':{'balance':_0x1db396,'totalPaidOut':_0x2357db}}),console[_0x47be1e(0x86)](_0x47be1e(0xcd)+_0x129e0b[_0x47be1e(0x15c)]+_0x47be1e(0x169)),console['log'](_0x47be1e(0x96)+_0x129e0b[_0x47be1e(0x111)]['toFixed'](0x6)+'\x20->\x20'+_0x1db396[_0x47be1e(0x114)](0x6)+_0x47be1e(0x119)+_0x5dcad5[_0x47be1e(0x114)](0x6)+')'),console['log'](_0x47be1e(0x92)+_0x129e0b['totalPaidOut']['toFixed'](0x6)+_0x47be1e(0x18e)+_0x2357db[_0x47be1e(0x114)](0x6)+_0x47be1e(0x78)+_0x5dcad5['toFixed'](0x6)+')'),{'payout':_0x1334ea,'shop':_0x129e0b};});return console[_0x1b1a73(0x86)]('✅\x20Payout\x20created:\x20'+_0x236765['payout']['id']+'\x20for\x20shop\x20'+_0x236765[_0x1b1a73(0x1ab)][_0x1b1a73(0x15c)]+'\x20('+_0x5dcad5+_0x1b1a73(0x171)),{'id':_0x236765['payout']['id'],'shopId':_0x236765[_0x1b1a73(0xf3)][_0x1b1a73(0x17e)],'shopName':_0x236765['shop']['name'],'shopUsername':_0x236765[_0x1b1a73(0x1ab)]['username'],'amount':_0x236765['payout'][_0x1b1a73(0xda)],'network':_0x236765[_0x1b1a73(0xf3)][_0x1b1a73(0x15e)],'status':_0x236765[_0x1b1a73(0xf3)]['status'],'txid':_0x236765[_0x1b1a73(0xf3)][_0x1b1a73(0xc1)],'notes':_0x236765[_0x1b1a73(0xf3)][_0x1b1a73(0x120)],'periodFrom':_0x236765['payout'][_0x1b1a73(0x163)],'periodTo':_0x236765[_0x1b1a73(0xf3)][_0x1b1a73(0xd4)],'createdAt':_0x236765[_0x1b1a73(0xf3)][_0x1b1a73(0xcc)],'paidAt':_0x236765[_0x1b1a73(0xf3)][_0x1b1a73(0x1ae)]};}async[a36_0x545440(0x106)](_0x5c77f9){const _0x285a14=a36_0x545440,{page:_0x15366b,limit:_0x1e5a32,shopId:_0x53e2a4,network:_0x11519d,dateFrom:_0xb4d632,dateTo:_0x2037b2,search:_0x478e84}=_0x5c77f9,_0x1fa544=(_0x15366b-0x1)*_0x1e5a32,_0x1c0190={};_0x53e2a4&&(_0x1c0190[_0x285a14(0x17e)]=_0x53e2a4);_0x11519d&&(_0x1c0190[_0x285a14(0x15e)]=_0x11519d);(_0xb4d632||_0x2037b2)&&(_0x1c0190[_0x285a14(0xcc)]={},_0xb4d632&&(_0x1c0190[_0x285a14(0xcc)][_0x285a14(0x142)]=new Date(_0xb4d632)),_0x2037b2&&(_0x1c0190[_0x285a14(0xcc)][_0x285a14(0x173)]=new Date(_0x2037b2)));_0x478e84&&(_0x1c0190['OR']=[{'shop':{'name':{'contains':_0x478e84,'mode':'insensitive'}}},{'shop':{'username':{'contains':_0x478e84,'mode':_0x285a14(0x185)}}},{'notes':{'contains':_0x478e84,'mode':_0x285a14(0x185)}}]);const [_0x3ecd55,_0x3c8496]=await Promise['all']([database_1[_0x285a14(0x90)][_0x285a14(0xf3)][_0x285a14(0x9e)]({'where':_0x1c0190,'skip':_0x1fa544,'take':_0x1e5a32,'orderBy':{'createdAt':_0x285a14(0x140)},'select':{'id':!![],'shopId':!![],'amount':!![],'network':!![],'status':!![],'txid':!![],'notes':!![],'periodFrom':!![],'periodTo':!![],'createdAt':!![],'paidAt':!![],'shop':{'select':{'name':!![],'username':!![]}}}}),database_1['default'][_0x285a14(0xf3)]['count']({'where':_0x1c0190})]);return{'payouts':_0x3ecd55['map'](_0x57b6e=>({'id':_0x57b6e['id'],'shopId':_0x57b6e['shopId'],'shopName':_0x57b6e[_0x285a14(0x1ab)][_0x285a14(0x17d)],'shopUsername':_0x57b6e[_0x285a14(0x1ab)][_0x285a14(0x15c)],'amount':_0x57b6e['amount'],'network':_0x57b6e[_0x285a14(0x15e)],'status':_0x57b6e[_0x285a14(0x1b0)],'txid':_0x57b6e[_0x285a14(0xc1)],'notes':_0x57b6e['notes'],'periodFrom':_0x57b6e[_0x285a14(0x163)],'periodTo':_0x57b6e[_0x285a14(0xd4)],'createdAt':_0x57b6e['createdAt'],'paidAt':_0x57b6e['paidAt']})),'pagination':{'page':_0x15366b,'limit':_0x1e5a32,'total':_0x3c8496,'totalPages':Math['ceil'](_0x3c8496/_0x1e5a32)}};}async[a36_0x545440(0x125)](_0x2ce8a9){const _0x3eeb55=a36_0x545440,_0x34e4ac=await database_1['default']['payout'][_0x3eeb55(0x94)]({'where':{'id':_0x2ce8a9},'include':{'shop':{'select':{'name':!![],'username':!![]}}}});if(!_0x34e4ac)return null;return{'id':_0x34e4ac['id'],'shopId':_0x34e4ac['shopId'],'shopName':_0x34e4ac[_0x3eeb55(0x1ab)][_0x3eeb55(0x17d)],'shopUsername':_0x34e4ac[_0x3eeb55(0x1ab)]['username'],'amount':_0x34e4ac[_0x3eeb55(0xda)],'network':_0x34e4ac[_0x3eeb55(0x15e)],'status':_0x34e4ac[_0x3eeb55(0x1b0)],'txid':_0x34e4ac[_0x3eeb55(0xc1)],'notes':_0x34e4ac['notes'],'periodFrom':_0x34e4ac[_0x3eeb55(0x163)],'periodTo':_0x34e4ac[_0x3eeb55(0xd4)],'createdAt':_0x34e4ac[_0x3eeb55(0xcc)],'paidAt':_0x34e4ac[_0x3eeb55(0x1ae)]};}async[a36_0x545440(0x1a1)](_0x14862a){const _0x3efe49=a36_0x545440;await database_1[_0x3efe49(0x90)][_0x3efe49(0xf3)][_0x3efe49(0x182)]({'where':{'id':_0x14862a}});}async[a36_0x545440(0x112)](_0x581e03){const _0x465ee4=a36_0x545440,{page:_0x49bc59,limit:_0x3fa6e8,status:_0x429e16,gateway:_0x4f885c,shopId:_0x5585c5,dateFrom:_0x4f0449,dateTo:_0x1896be,search:_0x55a324,currency:_0x5d3746,sortBy:_0x2e0d49,sortOrder:_0x596b3d}=_0x581e03,_0x5b7fdd=(_0x49bc59-0x1)*_0x3fa6e8;console[_0x465ee4(0x86)](_0x465ee4(0xad),_0x581e03);const _0x1db547=await database_1[_0x465ee4(0x90)][_0x465ee4(0x12d)]['groupBy']({'by':['gateway'],'_count':{'gateway':!![]}});console[_0x465ee4(0x86)](_0x465ee4(0xc8),_0x1db547[_0x465ee4(0x19d)](_0x539db0=>_0x539db0['gateway']+'\x20('+_0x539db0[_0x465ee4(0x196)][_0x465ee4(0x192)]+'\x20payments)'));if(_0x4f885c){const _0x50feae=_0x1db547[_0x465ee4(0x84)](_0x488c08=>_0x488c08['gateway'][_0x465ee4(0xec)]()===_0x4f885c[_0x465ee4(0xec)]());!_0x50feae&&_0x4f885c['toLowerCase']()!==_0x465ee4(0x7d)&&console[_0x465ee4(0x86)](_0x465ee4(0x101)+_0x4f885c+_0x465ee4(0x12a)+_0x1db547[_0x465ee4(0x19d)](_0x202bf8=>_0x202bf8[_0x465ee4(0x192)])[_0x465ee4(0x9a)](',\x20'));}const _0x148996={};_0x429e16&&(_0x148996[_0x465ee4(0x1b0)]=_0x429e16['toUpperCase']());if(!_0x4f885c)_0x148996[_0x465ee4(0x192)]={'not':_0x465ee4(0x7d)};else{if(_0x4f885c&&(_0x4f885c[_0x465ee4(0xec)]()===_0x465ee4(0x7d)||_0x4f885c===_0x465ee4(0xb8)))_0x148996[_0x465ee4(0x192)]=_0x465ee4(0x7d);else{let _0x13c7ff=_0x4f885c;const _0x25a550=(0x0,gateway_1[_0x465ee4(0x1ad)])(_0x4f885c);if(_0x25a550)_0x13c7ff=_0x25a550,console[_0x465ee4(0x86)]('🔄\x20Converted\x20gateway\x20ID\x20\x27'+_0x4f885c+'\x27\x20to\x20name\x20\x27'+_0x13c7ff+'\x27');else{const _0xfa3103=(0x0,gateway_1[_0x465ee4(0x15b)])(_0x4f885c);if(_0xfa3103){const _0x6cfd8e=(0x0,gateway_1['getGatewayNameById'])(_0xfa3103);_0x6cfd8e&&(_0x13c7ff=_0x6cfd8e,console[_0x465ee4(0x86)](_0x465ee4(0xfd)+_0x4f885c+_0x465ee4(0x1af)+_0xfa3103+_0x465ee4(0xe4)+_0x13c7ff+'\x27'));}else console['log'](_0x465ee4(0x9b)+_0x4f885c+'\x27\x20as\x20is\x20(not\x20found\x20in\x20mappings)');}const _0x4f7d81=await database_1['default'][_0x465ee4(0x12d)][_0x465ee4(0x158)]({'where':{'gateway':_0x13c7ff[_0x465ee4(0xec)]()},'take':0x1});_0x4f7d81===0x0?(console[_0x465ee4(0x86)](_0x465ee4(0x156)+_0x13c7ff+_0x465ee4(0x81)+_0x4f885c+_0x465ee4(0xa0)),_0x148996[_0x465ee4(0x192)]=_0x465ee4(0x11e)):(_0x148996[_0x465ee4(0x192)]=_0x13c7ff[_0x465ee4(0xec)](),console[_0x465ee4(0x86)](_0x465ee4(0x160)+_0x13c7ff+_0x465ee4(0x81)+_0x4f885c+'\x27)'));}}console['log'](_0x465ee4(0x14c),_0x148996[_0x465ee4(0x192)]);_0x5585c5&&(_0x148996[_0x465ee4(0x17e)]=_0x5585c5);_0x5d3746&&(_0x148996[_0x465ee4(0xe1)]=_0x5d3746[_0x465ee4(0x113)](),console[_0x465ee4(0x86)](_0x465ee4(0xa1)+_0x5d3746[_0x465ee4(0x113)]()));(_0x4f0449||_0x1896be)&&(_0x148996[_0x465ee4(0xcc)]={},_0x4f0449&&(_0x148996[_0x465ee4(0xcc)][_0x465ee4(0x142)]=new Date(_0x4f0449)),_0x1896be&&(_0x148996[_0x465ee4(0xcc)][_0x465ee4(0x173)]=new Date(_0x1896be)));_0x55a324&&(_0x148996['OR']=[{'id':{'contains':_0x55a324,'mode':_0x465ee4(0x185)}},{'orderId':{'contains':_0x55a324,'mode':'insensitive'}},{'gatewayOrderId':{'contains':_0x55a324,'mode':'insensitive'}},{'customerEmail':{'contains':_0x55a324,'mode':'insensitive'}},{'shop':{'name':{'contains':_0x55a324,'mode':_0x465ee4(0x185)}}},{'shop':{'username':{'contains':_0x55a324,'mode':_0x465ee4(0x185)}}}]);console['log']('📊\x20Final\x20WHERE\x20conditions:',JSON['stringify'](_0x148996,null,0x2));let _0x5a7ed0={'createdAt':_0x465ee4(0x140)};if(_0x2e0d49){const _0x1823fc=[_0x465ee4(0xda),_0x465ee4(0xcc),_0x465ee4(0xac),'status','gateway','currency'],_0x4f6a33=[_0x465ee4(0x11d),_0x465ee4(0x140)];if(_0x1823fc[_0x465ee4(0x14b)](_0x2e0d49)){const _0x1bb75=_0x4f6a33[_0x465ee4(0x14b)](_0x596b3d)?_0x596b3d:_0x465ee4(0x140);_0x5a7ed0={[_0x2e0d49]:_0x1bb75},console[_0x465ee4(0x86)](_0x465ee4(0x99)+_0x2e0d49+'\x20in\x20'+_0x1bb75+'\x20order');}}const [_0x28315f,_0x5600a5]=await Promise[_0x465ee4(0x183)]([database_1['default'][_0x465ee4(0x12d)]['findMany']({'where':_0x148996,'skip':_0x5b7fdd,'take':_0x3fa6e8,'orderBy':_0x5a7ed0,'select':{'id':!![],'shopId':!![],'amount':!![],'amountAfterGatewayCommissionUSDT':!![],'currency':!![],'sourceCurrency':!![],'status':!![],'gateway':!![],'orderId':!![],'gatewayOrderId':!![],'gatewayPaymentId':!![],'customerEmail':!![],'customerName':!![],'customerCountry':!![],'customerIp':!![],'customerUa':!![],'externalPaymentUrl':!![],'successUrl':!![],'failUrl':!![],'pendingUrl':!![],'whiteUrl':!![],'expiresAt':!![],'invoiceTotalSum':!![],'qrCode':!![],'qrUrl':!![],'country':!![],'language':!![],'amountIsEditable':!![],'maxPayments':!![],'rapydCustomer':!![],'cardLast4':!![],'paymentMethod':!![],'bankId':!![],'remitterIban':!![],'remitterName':!![],'failureMessage':!![],'usage':!![],'createdAt':!![],'updatedAt':!![],'shop':{'select':{'name':!![],'username':!![]}}}}),database_1[_0x465ee4(0x90)][_0x465ee4(0x12d)][_0x465ee4(0x158)]({'where':_0x148996})]);return{'payments':_0x28315f,'pagination':{'page':_0x49bc59,'limit':_0x3fa6e8,'total':_0x5600a5,'totalPages':Math['ceil'](_0x5600a5/_0x3fa6e8)}};}async['getPaymentById'](_0x184945){const _0x2ed70c=a36_0x545440,_0x43a592=await database_1[_0x2ed70c(0x90)][_0x2ed70c(0x12d)][_0x2ed70c(0x94)]({'where':{'id':_0x184945},'select':{'id':!![],'shopId':!![],'amount':!![],'amountAfterGatewayCommissionUSDT':!![],'currency':!![],'sourceCurrency':!![],'status':!![],'gateway':!![],'orderId':!![],'gatewayOrderId':!![],'gatewayPaymentId':!![],'customerEmail':!![],'customerName':!![],'customerCountry':!![],'customerIp':!![],'customerUa':!![],'externalPaymentUrl':!![],'successUrl':!![],'failUrl':!![],'pendingUrl':!![],'whiteUrl':!![],'expiresAt':!![],'invoiceTotalSum':!![],'qrCode':!![],'qrUrl':!![],'country':!![],'language':!![],'amountIsEditable':!![],'maxPayments':!![],'rapydCustomer':!![],'cardLast4':!![],'paymentMethod':!![],'bankId':!![],'remitterIban':!![],'remitterName':!![],'failureMessage':!![],'usage':!![],'createdAt':!![],'updatedAt':!![],'shop':{'select':{'name':!![],'username':!![]}}}});if(!_0x43a592)return null;return{'id':_0x43a592['id'],'shopId':_0x43a592[_0x2ed70c(0x17e)],'gateway':_0x43a592['gateway'],'amount':_0x43a592['amount'],'currency':_0x43a592['currency'],'status':_0x43a592['status'],'orderId':_0x43a592['orderId'],'gatewayOrderId':_0x43a592[_0x2ed70c(0x89)],'customerEmail':_0x43a592[_0x2ed70c(0x8e)],'customerName':_0x43a592['customerName'],'customerCountry':_0x43a592[_0x2ed70c(0x195)],'customerIp':_0x43a592[_0x2ed70c(0xb5)],'customerUa':_0x43a592[_0x2ed70c(0x1a7)],'failureMessage':_0x43a592[_0x2ed70c(0x14e)],'externalPaymentUrl':_0x43a592[_0x2ed70c(0x129)],'successUrl':_0x43a592[_0x2ed70c(0x75)],'failUrl':_0x43a592[_0x2ed70c(0x165)],'pendingUrl':_0x43a592['pendingUrl'],'whiteUrl':_0x43a592[_0x2ed70c(0xe6)],'createdAt':_0x43a592[_0x2ed70c(0xcc)],'updatedAt':_0x43a592[_0x2ed70c(0xac)],'shop':_0x43a592[_0x2ed70c(0x1ab)]};}async['updatePaymentStatus'](_0x595654,_0x11ebea,_0x269630,_0x2738e8){const _0x3314f5=a36_0x545440,_0x42a5fe=await database_1[_0x3314f5(0x90)][_0x3314f5(0x102)](async _0x5cfc08=>{const _0x270681=_0x3314f5,_0x201ad8=await _0x5cfc08[_0x270681(0x12d)][_0x270681(0x94)]({'where':{'id':_0x595654},'include':{'shop':{'select':{'id':!![],'name':!![],'username':!![],'balance':!![]}}}});if(!_0x201ad8)throw new Error(_0x270681(0x164));const _0x10214b=_0x201ad8[_0x270681(0x1b0)],_0x586a18=_0x11ebea[_0x270681(0x113)]();console[_0x270681(0x86)]('🔄\x20Admin\x20updating\x20payment\x20'+_0x595654+_0x270681(0x180)+_0x10214b+'\x20->\x20'+_0x586a18),console[_0x270681(0x86)]('💰\x20Current\x20shop\x20balance:\x20'+_0x201ad8[_0x270681(0x1ab)][_0x270681(0x111)]+_0x270681(0xb4));const _0x515b8b={'status':_0x586a18,'updatedAt':new Date(),'statusChangedBy':_0x270681(0x76),'statusChangedAt':new Date()};_0x269630&&(_0x515b8b['adminNotes']=_0x269630);_0x586a18===_0x270681(0x9d)&&_0x2738e8&&(_0x515b8b[_0x270681(0xc6)]=_0x2738e8);let _0xf05a3b=0x0,_0x281e81=_0x201ad8[_0x270681(0x1ab)][_0x270681(0x111)];if(_0x586a18===_0x270681(0x141)&&_0x10214b!==_0x270681(0x141)){_0x515b8b[_0x270681(0x1ae)]=new Date();const _0x258486=await currencyService_1[_0x270681(0x15a)][_0x270681(0xc2)](_0x201ad8[_0x270681(0xda)],_0x201ad8['currency']);_0x515b8b['amountUSDT']=_0x258486;let _0x1fc992=0x2d;const _0x193481=await _0x5cfc08[_0x270681(0x1ab)]['findUnique']({'where':{'id':_0x201ad8[_0x270681(0x17e)]},'select':{'gatewaySettings':!![]}});if(_0x193481?.[_0x270681(0xa6)])try{const _0x2f4bd6=JSON[_0x270681(0x95)](_0x193481[_0x270681(0xa6)]);for(const [_0x1a3ba9,_0x5f36de]of Object['entries'](_0x2f4bd6)){if(_0x1a3ba9[_0x270681(0xec)]()===_0x201ad8['gateway'][_0x270681(0xec)]()){_0x1fc992=_0x5f36de[_0x270681(0xdb)]||0xa;break;}}}catch(_0x4fe550){console[_0x270681(0x109)]('Error\x20parsing\x20gateway\x20settings\x20for\x20payment\x20'+_0x595654+':',_0x4fe550);}let _0x1e12a6;_0x201ad8[_0x270681(0x152)]!==null&&_0x201ad8[_0x270681(0x152)]!==undefined?(_0x1e12a6=_0x201ad8[_0x270681(0x152)],console[_0x270681(0x86)](_0x270681(0x159)+_0x1e12a6[_0x270681(0x114)](0x6)+_0x270681(0xe0)+_0x595654)):(_0x1e12a6=_0x258486*(0x1-_0x1fc992/0x64),console[_0x270681(0x86)](_0x270681(0xa3)+_0x595654+':\x20'+_0x1fc992+_0x270681(0x17c)+_0x258486[_0x270681(0x114)](0x6)+_0x270681(0xb4)),_0x515b8b[_0x270681(0x152)]=_0x1e12a6,_0x515b8b[_0x270681(0xea)]=_0x1fc992),_0xf05a3b=_0x1e12a6,_0x281e81+=_0x1e12a6,console[_0x270681(0x86)]('💰\x20Payment\x20'+_0x595654+'\x20became\x20PAID:'),console['log']('\x20\x20\x20Full\x20amount:\x20'+_0x258486[_0x270681(0x114)](0x6)+'\x20USDT'),console[_0x270681(0x86)]('\x20\x20\x20Gateway:\x20'+_0x201ad8['gateway']+_0x270681(0x174)+_0x1fc992+'%'),console[_0x270681(0x86)]('\x20\x20\x20Merchant\x20gets:\x20'+_0x1e12a6[_0x270681(0x114)](0x6)+_0x270681(0x18a)+_0x1fc992+_0x270681(0xab)),console['log'](_0x270681(0x1a0)+_0x1e12a6['toFixed'](0x6)+_0x270681(0xb4));}else{if(_0x10214b===_0x270681(0x141)&&_0x586a18!==_0x270681(0x141)){if(_0x201ad8[_0x270681(0x19f)]){let _0x34cec7=0x2d;const _0x3dc19a=await _0x5cfc08[_0x270681(0x1ab)][_0x270681(0x94)]({'where':{'id':_0x201ad8[_0x270681(0x17e)]},'select':{'gatewaySettings':!![]}});if(_0x3dc19a?.[_0x270681(0xa6)])try{const _0x59f2f5=JSON[_0x270681(0x95)](_0x3dc19a[_0x270681(0xa6)]);for(const [_0x6d0ae0,_0x17023e]of Object['entries'](_0x59f2f5)){if(_0x6d0ae0[_0x270681(0xec)]()===_0x201ad8['gateway'][_0x270681(0xec)]()){_0x34cec7=_0x17023e['commission']||0xa;break;}}}catch(_0x26248){console[_0x270681(0x109)](_0x270681(0x19e)+_0x595654+':',_0x26248);}const _0x2e983a=_0x201ad8[_0x270681(0x19f)]*(0x1-_0x34cec7/0x64);_0xf05a3b=-_0x2e983a,_0x281e81-=_0x2e983a,_0x515b8b['amountUSDT']=null,_0x515b8b['amountAfterGatewayCommissionUSDT']=null,console[_0x270681(0x86)](_0x270681(0xd6)+_0x595654+_0x270681(0x1ac)),console['log'](_0x270681(0xa7)+_0x201ad8[_0x270681(0x19f)][_0x270681(0x114)](0x6)+_0x270681(0xb4)),console[_0x270681(0x86)](_0x270681(0xe3)+_0x201ad8[_0x270681(0x192)]+_0x270681(0x174)+_0x34cec7+'%'),console[_0x270681(0x86)](_0x270681(0xd5)+_0x2e983a['toFixed'](0x6)+'\x20USDT\x20(after\x20'+_0x34cec7+_0x270681(0xab)),console['log'](_0x270681(0x190)+_0x2e983a['toFixed'](0x6)+_0x270681(0xb4));}}}_0x586a18==='CHARGEBACK'&&(_0x10214b===_0x270681(0x141)&&_0x201ad8['amountUSDT']&&console[_0x270681(0x86)](_0x270681(0x121)),_0x2738e8&&_0x2738e8>0x0&&(_0xf05a3b-=_0x2738e8,_0x281e81-=_0x2738e8,console[_0x270681(0x86)](_0x270681(0xd1)+_0x2738e8['toFixed'](0x6)+_0x270681(0xed))));_0x586a18==='REFUND'&&_0x10214b==='PAID'&&console[_0x270681(0x86)](_0x270681(0x11c));const _0x266fd6=await _0x5cfc08[_0x270681(0x12d)][_0x270681(0xc0)]({'where':{'id':_0x595654},'data':_0x515b8b,'include':{'shop':{'select':{'name':!![],'username':!![]}}}});return _0xf05a3b!==0x0&&(await _0x5cfc08[_0x270681(0x1ab)][_0x270681(0xc0)]({'where':{'id':_0x201ad8['shopId']},'data':{'balance':_0x281e81}}),console[_0x270681(0x86)](_0x270681(0xcd)+_0x201ad8['shopId']+'\x20balance\x20updated:\x20'+_0x201ad8[_0x270681(0x1ab)][_0x270681(0x111)]['toFixed'](0x6)+_0x270681(0x18e)+_0x281e81['toFixed'](0x6)+_0x270681(0x12b)+(_0xf05a3b>0x0?'+':'')+_0xf05a3b[_0x270681(0x114)](0x6)+')')),_0x266fd6;});return{'id':_0x42a5fe['id'],'shopId':_0x42a5fe['shopId'],'gateway':_0x42a5fe[_0x3314f5(0x192)],'amount':_0x42a5fe[_0x3314f5(0xda)],'currency':_0x42a5fe[_0x3314f5(0xe1)],'status':_0x42a5fe[_0x3314f5(0x1b0)],'orderId':_0x42a5fe[_0x3314f5(0xf2)],'gatewayOrderId':_0x42a5fe[_0x3314f5(0x89)],'customerEmail':_0x42a5fe['customerEmail'],'customerName':_0x42a5fe[_0x3314f5(0x17f)],'customerCountry':_0x42a5fe[_0x3314f5(0x195)],'customerIp':_0x42a5fe[_0x3314f5(0xb5)],'customerUa':_0x42a5fe[_0x3314f5(0x1a7)],'failureMessage':_0x42a5fe[_0x3314f5(0x14e)],'adminNotes':_0x42a5fe['adminNotes'],'chargebackAmount':_0x42a5fe[_0x3314f5(0xc6)],'statusChangedBy':_0x42a5fe[_0x3314f5(0x133)],'statusChangedAt':_0x42a5fe[_0x3314f5(0x137)],'createdAt':_0x42a5fe['createdAt'],'updatedAt':_0x42a5fe['updatedAt'],'shop':_0x42a5fe[_0x3314f5(0x1ab)]};}async[a36_0x545440(0xaa)](_0x1829ea,_0x12ec1b){const _0x2ac581=a36_0x545440,_0x2d0f84=Math[_0x2ac581(0x13b)]()[_0x2ac581(0x197)](0x24)['substr'](0x2,0x9);console[_0x2ac581(0x86)](_0x2ac581(0xc4)+_0x2d0f84+_0x2ac581(0x9c)+_0x1829ea);const _0x3e37bf={..._0x12ec1b};_0x12ec1b['password']&&_0x12ec1b[_0x2ac581(0x117)][_0x2ac581(0x73)]()!==''?(console['log'](_0x2ac581(0x105)+_0x2d0f84+_0x2ac581(0x17a)+_0x1829ea),_0x3e37bf[_0x2ac581(0x117)]=await bcryptjs_1[_0x2ac581(0x90)]['hash'](_0x12ec1b[_0x2ac581(0x117)],0xc)):(console['log'](_0x2ac581(0x105)+_0x2d0f84+_0x2ac581(0x16a)),delete _0x3e37bf[_0x2ac581(0x117)]);_0x12ec1b['fullName']&&(_0x3e37bf[_0x2ac581(0x17d)]=_0x12ec1b[_0x2ac581(0xd3)],delete _0x3e37bf[_0x2ac581(0xd3)]);_0x12ec1b['telegramId']&&(_0x3e37bf[_0x2ac581(0x1b1)]=_0x12ec1b[_0x2ac581(0xba)],delete _0x3e37bf[_0x2ac581(0xba)]);_0x12ec1b['merchantUrl']&&(_0x3e37bf['shopUrl']=_0x12ec1b[_0x2ac581(0x10e)],delete _0x3e37bf['merchantUrl']);if(_0x12ec1b[_0x2ac581(0xe8)]){const _0x597526=_0x12ec1b['gateways']['map'](_0x4457ab=>this['getGatewayInternalName'](_0x4457ab));console[_0x2ac581(0x86)](_0x2ac581(0xae),_0x12ec1b[_0x2ac581(0xe8)],'->',_0x597526),_0x3e37bf[_0x2ac581(0x11a)]=JSON[_0x2ac581(0xd9)](_0x597526),delete _0x3e37bf[_0x2ac581(0xe8)];}_0x12ec1b[_0x2ac581(0xa6)]&&(console[_0x2ac581(0x86)]('🔧\x20['+_0x2d0f84+_0x2ac581(0x157),_0x12ec1b[_0x2ac581(0xa6)]),_0x3e37bf[_0x2ac581(0xa6)]=JSON['stringify'](_0x12ec1b[_0x2ac581(0xa6)]),console[_0x2ac581(0x86)](_0x2ac581(0xe9)+_0x2d0f84+']\x20Gateway\x20settings\x20JSON\x20string:',_0x3e37bf[_0x2ac581(0xa6)]));_0x12ec1b[_0x2ac581(0x19c)]&&(_0x12ec1b[_0x2ac581(0x19c)][_0x2ac581(0x115)]!==undefined&&(_0x3e37bf['usdtPolygonWallet']=_0x12ec1b[_0x2ac581(0x19c)]['usdtPolygonWallet']||null),_0x12ec1b[_0x2ac581(0x19c)][_0x2ac581(0x181)]!==undefined&&(_0x3e37bf[_0x2ac581(0x181)]=_0x12ec1b[_0x2ac581(0x19c)][_0x2ac581(0x181)]||null),_0x12ec1b[_0x2ac581(0x19c)][_0x2ac581(0x93)]!==undefined&&(_0x3e37bf[_0x2ac581(0x93)]=_0x12ec1b[_0x2ac581(0x19c)][_0x2ac581(0x93)]||null),_0x12ec1b[_0x2ac581(0x19c)][_0x2ac581(0xf8)]!==undefined&&(_0x3e37bf[_0x2ac581(0xf8)]=_0x12ec1b[_0x2ac581(0x19c)][_0x2ac581(0xf8)]||null),delete _0x3e37bf[_0x2ac581(0x19c)]);const _0x4044c9=await database_1[_0x2ac581(0x90)]['shop'][_0x2ac581(0xc0)]({'where':{'id':_0x1829ea},'data':_0x3e37bf,'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});return console[_0x2ac581(0x86)](_0x2ac581(0xf4)+_0x2d0f84+']\x20User\x20updated,\x20gatewaySettings\x20from\x20DB:',_0x4044c9[_0x2ac581(0xa6)]),{'id':_0x4044c9['id'],'fullName':_0x4044c9[_0x2ac581(0x17d)],'username':_0x4044c9[_0x2ac581(0x15c)],'telegramId':_0x4044c9[_0x2ac581(0x1b1)],'merchantUrl':_0x4044c9[_0x2ac581(0x188)],'gateways':_0x4044c9[_0x2ac581(0x11a)]?JSON[_0x2ac581(0x95)](_0x4044c9[_0x2ac581(0x11a)]):null,'gatewaySettings':_0x4044c9['gatewaySettings']?JSON[_0x2ac581(0x95)](_0x4044c9[_0x2ac581(0xa6)]):null,'publicKey':_0x4044c9[_0x2ac581(0x145)],'wallets':{'usdtPolygonWallet':_0x4044c9[_0x2ac581(0x115)],'usdtTrcWallet':_0x4044c9[_0x2ac581(0x181)],'usdtErcWallet':_0x4044c9[_0x2ac581(0x93)],'usdcPolygonWallet':_0x4044c9['usdcPolygonWallet']},'status':_0x4044c9[_0x2ac581(0x1b0)],'createdAt':_0x4044c9[_0x2ac581(0xcc)]};}async['suspendUser'](_0x2a6fae){const _0x57b7d4=a36_0x545440,_0x45e1a1=await database_1[_0x57b7d4(0x90)][_0x57b7d4(0x1ab)][_0x57b7d4(0xc0)]({'where':{'id':_0x2a6fae},'data':{'status':_0x57b7d4(0x19b)},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});return{'id':_0x45e1a1['id'],'fullName':_0x45e1a1[_0x57b7d4(0x17d)],'username':_0x45e1a1['username'],'telegramId':_0x45e1a1['telegram'],'merchantUrl':_0x45e1a1[_0x57b7d4(0x188)],'gateways':_0x45e1a1['paymentGateways']?JSON[_0x57b7d4(0x95)](_0x45e1a1[_0x57b7d4(0x11a)]):null,'gatewaySettings':_0x45e1a1[_0x57b7d4(0xa6)]?JSON['parse'](_0x45e1a1['gatewaySettings']):null,'publicKey':_0x45e1a1[_0x57b7d4(0x145)],'wallets':{'usdtPolygonWallet':_0x45e1a1[_0x57b7d4(0x115)],'usdtTrcWallet':_0x45e1a1[_0x57b7d4(0x181)],'usdtErcWallet':_0x45e1a1[_0x57b7d4(0x93)],'usdcPolygonWallet':_0x45e1a1[_0x57b7d4(0xf8)]},'status':_0x45e1a1['status'],'createdAt':_0x45e1a1[_0x57b7d4(0xcc)]};}async[a36_0x545440(0x170)](_0x5ce37a){const _0x56b58f=a36_0x545440,_0x58ee6e=await database_1[_0x56b58f(0x90)][_0x56b58f(0x1ab)]['update']({'where':{'id':_0x5ce37a},'data':{'status':'ACTIVE'},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});return{'id':_0x58ee6e['id'],'fullName':_0x58ee6e[_0x56b58f(0x17d)],'username':_0x58ee6e[_0x56b58f(0x15c)],'telegramId':_0x58ee6e[_0x56b58f(0x1b1)],'merchantUrl':_0x58ee6e[_0x56b58f(0x188)],'gateways':_0x58ee6e[_0x56b58f(0x11a)]?JSON[_0x56b58f(0x95)](_0x58ee6e['paymentGateways']):null,'gatewaySettings':_0x58ee6e[_0x56b58f(0xa6)]?JSON[_0x56b58f(0x95)](_0x58ee6e[_0x56b58f(0xa6)]):null,'publicKey':_0x58ee6e[_0x56b58f(0x145)],'wallets':{'usdtPolygonWallet':_0x58ee6e[_0x56b58f(0x115)],'usdtTrcWallet':_0x58ee6e['usdtTrcWallet'],'usdtErcWallet':_0x58ee6e[_0x56b58f(0x93)],'usdcPolygonWallet':_0x58ee6e['usdcPolygonWallet']},'status':_0x58ee6e[_0x56b58f(0x1b0)],'createdAt':_0x58ee6e[_0x56b58f(0xcc)]};}async[a36_0x545440(0x18c)](_0x4e5812){const _0x5494eb=a36_0x545440,{page:_0x4fb678,limit:_0x257cdb,status:_0x3f47a5}=_0x4e5812,_0x12e79f=(_0x4fb678-0x1)*_0x257cdb,_0xb91da4={};_0x3f47a5&&(_0xb91da4['status']=_0x3f47a5['toUpperCase']());const [_0x5c8e36,_0x2ec6ff]=await Promise[_0x5494eb(0x183)]([database_1['default'][_0x5494eb(0x1ab)]['findMany']({'where':_0xb91da4,'skip':_0x12e79f,'take':_0x257cdb,'orderBy':{'createdAt':'desc'},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}}),database_1[_0x5494eb(0x90)][_0x5494eb(0x1ab)]['count']({'where':_0xb91da4})]);return{'users':_0x5c8e36[_0x5494eb(0x19d)](_0x1d12a0=>{const _0x131b01=_0x5494eb,_0x6dce2c=_0x1d12a0[_0x131b01(0x11a)]?JSON[_0x131b01(0x95)](_0x1d12a0['paymentGateways']):null,_0x501d85=_0x6dce2c?_0x6dce2c[_0x131b01(0x19d)](_0x114c3e=>this[_0x131b01(0xdc)](_0x114c3e)):null;return{'id':_0x1d12a0['id'],'fullName':_0x1d12a0[_0x131b01(0x17d)],'username':_0x1d12a0[_0x131b01(0x15c)],'telegramId':_0x1d12a0[_0x131b01(0x1b1)],'merchantUrl':_0x1d12a0[_0x131b01(0x188)],'gateways':_0x501d85,'gatewaySettings':_0x1d12a0[_0x131b01(0xa6)]?JSON['parse'](_0x1d12a0[_0x131b01(0xa6)]):null,'publicKey':_0x1d12a0[_0x131b01(0x145)],'wallets':{'usdtPolygonWallet':_0x1d12a0[_0x131b01(0x115)],'usdtTrcWallet':_0x1d12a0[_0x131b01(0x181)],'usdtErcWallet':_0x1d12a0[_0x131b01(0x93)],'usdcPolygonWallet':_0x1d12a0['usdcPolygonWallet']},'status':_0x1d12a0[_0x131b01(0x1b0)],'createdAt':_0x1d12a0[_0x131b01(0xcc)]};}),'pagination':{'page':_0x4fb678,'limit':_0x257cdb,'total':_0x2ec6ff,'totalPages':Math[_0x5494eb(0x13f)](_0x2ec6ff/_0x257cdb)}};}async['getUserById'](_0x9ee5f3){const _0x1b61ba=a36_0x545440,_0x31dcf0=await database_1[_0x1b61ba(0x90)][_0x1b61ba(0x1ab)][_0x1b61ba(0x94)]({'where':{'id':_0x9ee5f3},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});if(!_0x31dcf0)return null;const _0x4e0341=_0x31dcf0[_0x1b61ba(0x11a)]?JSON['parse'](_0x31dcf0[_0x1b61ba(0x11a)]):null,_0x2f3b06=_0x4e0341?_0x4e0341[_0x1b61ba(0x19d)](_0x318e77=>this[_0x1b61ba(0xdc)](_0x318e77)):null;return _0x4e0341&&_0x2f3b06&&console[_0x1b61ba(0x86)]('🔄\x20Gateway\x20mapping\x20(get):',_0x4e0341,'->',_0x2f3b06),{'id':_0x31dcf0['id'],'fullName':_0x31dcf0[_0x1b61ba(0x17d)],'username':_0x31dcf0[_0x1b61ba(0x15c)],'telegramId':_0x31dcf0[_0x1b61ba(0x1b1)],'merchantUrl':_0x31dcf0[_0x1b61ba(0x188)],'gateways':_0x2f3b06,'gatewaySettings':_0x31dcf0['gatewaySettings']?JSON[_0x1b61ba(0x95)](_0x31dcf0[_0x1b61ba(0xa6)]):null,'publicKey':_0x31dcf0['publicKey'],'wallets':{'usdtPolygonWallet':_0x31dcf0[_0x1b61ba(0x115)],'usdtTrcWallet':_0x31dcf0[_0x1b61ba(0x181)],'usdtErcWallet':_0x31dcf0['usdtErcWallet'],'usdcPolygonWallet':_0x31dcf0[_0x1b61ba(0xf8)]},'status':_0x31dcf0[_0x1b61ba(0x1b0)],'createdAt':_0x31dcf0[_0x1b61ba(0xcc)]};}async[a36_0x545440(0xfa)](_0x225246){const _0x4db25c=a36_0x545440,{fullName:_0x36d78c,username:_0x18ce4c,password:_0x5edc3b,telegramId:_0x5ab363,merchantUrl:_0xdcf594,gateways:_0x151bb1,gatewaySettings:_0x25da03,wallets:_0x1e6653}=_0x225246,_0x2adb21=await database_1['default'][_0x4db25c(0x1ab)]['findUnique']({'where':{'username':_0x18ce4c}});if(_0x2adb21)throw new Error(_0x4db25c(0xbc));if(_0x5ab363){const _0x2a46e6=await database_1[_0x4db25c(0x90)][_0x4db25c(0x1ab)][_0x4db25c(0x94)]({'where':{'telegram':_0x5ab363}});if(_0x2a46e6)throw new Error(_0x4db25c(0x149));}const _0x4eec6e=await bcryptjs_1['default'][_0x4db25c(0xbb)](_0x5edc3b,0xc),_0x4bda4a=_0x4db25c(0x151)+crypto_1['default']['randomBytes'](0x20)[_0x4db25c(0x197)](_0x4db25c(0x187)),_0x1c6080=_0x4db25c(0x122)+crypto_1[_0x4db25c(0x90)]['randomBytes'](0x20)['toString'](_0x4db25c(0x187)),_0x13ce24=_0x151bb1?_0x151bb1[_0x4db25c(0x19d)](_0x182def=>this[_0x4db25c(0xdd)](_0x182def)):null;_0x151bb1&&_0x13ce24&&console['log']('🔄\x20Gateway\x20mapping\x20(create):',_0x151bb1,'->',_0x13ce24);const _0x5169ac=await database_1[_0x4db25c(0x90)]['shop'][_0x4db25c(0x168)]({'data':{'name':_0x36d78c,'username':_0x18ce4c,'password':_0x4eec6e,'telegram':_0x5ab363,'shopUrl':_0xdcf594,'paymentGateways':_0x13ce24?JSON[_0x4db25c(0xd9)](_0x13ce24):null,'gatewaySettings':_0x25da03?JSON[_0x4db25c(0xd9)](_0x25da03):null,'usdtPolygonWallet':_0x1e6653?.[_0x4db25c(0x115)]||null,'usdtTrcWallet':_0x1e6653?.['usdtTrcWallet']||null,'usdtErcWallet':_0x1e6653?.['usdtErcWallet']||null,'usdcPolygonWallet':_0x1e6653?.[_0x4db25c(0xf8)]||null,'publicKey':_0x4bda4a,'secretKey':_0x1c6080,'status':'ACTIVE'},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});return{'id':_0x5169ac['id'],'fullName':_0x5169ac['name'],'username':_0x5169ac[_0x4db25c(0x15c)],'telegramId':_0x5169ac[_0x4db25c(0x1b1)],'merchantUrl':_0x5169ac[_0x4db25c(0x188)],'gateways':_0x5169ac[_0x4db25c(0x11a)]?JSON['parse'](_0x5169ac[_0x4db25c(0x11a)]):null,'gatewaySettings':_0x5169ac[_0x4db25c(0xa6)]?JSON[_0x4db25c(0x95)](_0x5169ac[_0x4db25c(0xa6)]):null,'publicKey':_0x5169ac[_0x4db25c(0x145)],'wallets':{'usdtPolygonWallet':_0x5169ac[_0x4db25c(0x115)],'usdtTrcWallet':_0x5169ac[_0x4db25c(0x181)],'usdtErcWallet':_0x5169ac[_0x4db25c(0x93)],'usdcPolygonWallet':_0x5169ac[_0x4db25c(0xf8)]},'status':_0x5169ac[_0x4db25c(0x1b0)],'createdAt':_0x5169ac['createdAt']};}async['deleteUser'](_0x23e2e0){const _0x30f08f=a36_0x545440;await database_1[_0x30f08f(0x90)][_0x30f08f(0x1ab)]['delete']({'where':{'id':_0x23e2e0}});}[a36_0x545440(0x1a9)](_0x4bbcca,_0x3cb1dd,_0x4da43e){const _0x242c08=a36_0x545440,_0x3919b6=new Map(),_0x17442d=new Date(_0x3cb1dd);while(_0x17442d<=_0x4da43e){const _0x296787=_0x17442d[_0x242c08(0x139)]()[_0x242c08(0x10d)]('T')[0x0];_0x3919b6[_0x242c08(0x110)](_0x296787,{'revenue':0x0,'count':0x0}),_0x17442d['setDate'](_0x17442d[_0x242c08(0x167)]()+0x1);}for(const _0x373316 of _0x4bbcca){const _0xdf07a8=_0x373316[_0x242c08(0xcc)][_0x242c08(0x139)]()[_0x242c08(0x10d)]('T')[0x0],_0xbd8c00=_0x3919b6[_0x242c08(0x8b)](_0xdf07a8);_0xbd8c00&&(_0xbd8c00[_0x242c08(0x158)]+=0x1,_0x373316['status']==='PAID'&&(_0x373316[_0x242c08(0x19f)]?_0xbd8c00['revenue']+=_0x373316[_0x242c08(0x19f)]:console[_0x242c08(0x86)](_0x242c08(0x1a5)+_0x373316['id']+'\x20missing\x20amountUSDT,\x20using\x20fallback\x20conversion')));}const _0x57edcb=[],_0xaa9ad0=[];for(const [_0x16e49b,_0x5b0cf9]of _0x3919b6){_0x57edcb[_0x242c08(0x16d)]({'date':_0x16e49b,'amount':Math[_0x242c08(0x7a)](_0x5b0cf9['revenue']*0x64)/0x64}),_0xaa9ad0['push']({'date':_0x16e49b,'count':_0x5b0cf9[_0x242c08(0x158)]});}return{'dailyRevenue':_0x57edcb,'dailyPayments':_0xaa9ad0};}}exports[a36_0x545440(0x74)]=AdminService;