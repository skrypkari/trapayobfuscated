'use strict';function a35_0x4b69(){const _0x2d3e7b=['mastercard','week','admin','\x20balance\x20updated:','username','📊\x20Merchants\x20awaiting\x20payout:\x20','./currencyService','dailyRevenue','\x20USDT,\x20Requested:\x20','customerName','\x20->\x20','💰\x20Payment\x20','usdtErcWallet','random','thisMonth','__esModule','_sum','540229NWkCfK','285vmteug','\x20\x20\x20Current\x20total\x20paid\x20out:\x20','💰\x20[PAYOUT]\x20Gateway\x20','totalPayments','dateFrom','plisio','0000','totalPayout','📊\x20Payout\x20statistics\x20calculated:','_count','toFixed','\x20\x20\x20💳\x20Total\x20payments:\x20','paymentGateways',',\x20successful:\x20','⚠️\x20Requested\x20gateway\x20\x27','3066912vzYoJS','\x20\x20\x20✅\x20Actual\x20available\x20balance:\x20','reduce','\x20order','notes','\x20\x20\x20�\x20Total\x20paid\x20out:\x20','ACTIVE','customerEmail','💸\x20CHARGEBACK\x20penalty:\x20-','\x20PAID\x20payments','\x20USDT\x20for\x20payment\x20','📊\x20[ADMIN]\x20Using\x20saved\x20amountAfterGatewayCommissionUSDT:\x20','toISOString',',\x20Commission:\x20','Test\x20Gateway','externalPaymentUrl','ceil','2020-01-01','cointopay','shopUrl',',\x20userId:\x20','📋\x20Getting\x20merchants\x20selection\x20list...','paidAt','wallets','values','\x20to\x20','count','6920271KscBxm','KLYME\x20GB','txid','default','📊\x20Using\x20saved\x20amountAfterGatewayCommissionUSDT:\x20','gatewayEarnings','📊\x20Final\x20WHERE\x20conditions:','Open\x20Banking\x202','defineProperty','updatedAt','get','pendingPayout','🔄\x20Updating\x20customer\x20data\x20for\x20payment\x20','name','\x20\x20\x20🏪\x20Gateway\x20earnings:\x20','availableBalance','orderId','getUserById','\x27\x20->\x20ID\x20\x27','gatewaySettings','🔄\x20Gateway\x20mapping\x20(create):','📊\x20Sorting\x20payments\x20by\x20','Username\x20already\x20exists','\x27)\x20not\x20found\x20in\x20database,\x20returning\x20empty\x20result','failureMessage','setDate','getMonth','📊\x20Calculating\x20commission\x20manually\x20for\x20payment\x20','NONEXISTENT_GATEWAY_FILTER',']\x20User\x20updated,\x20gatewaySettings\x20from\x20DB:','aggregate','merchantEarnings','\x20\x20\x20💵\x20Available\x20balance:\x20','length','\x20\x20\x20💰\x20Total\x20turnover:\x20','\x20\x20\x20Subtracted\x20from\x20balance:\x20-','adminNotes','SUSPENDED','merchantUrl','includes','\x20\x20\x20Merchant\x20loses:\x20','getGatewayDisplayName','period','totalAmountUSDT','whiteUrl','bcryptjs','polygon_usdc','324561awHlac','\x20became\x20PAID:','\x20\x20\x20👤\x20Merchant\x20earnings:\x20','averageCheckUSDT','revenue','rapyd','push','shopId','totalAmountAfterCommissionUSDT','⚠️\x20Gateway\x20\x27','getGatewayInternalName','CHARGEBACK','📊\x20Getting\x20merchant\x20statistics\x20with\x20filters:','toUpperCase','createUser','\x20USDT\x20(total\x20paid\x20to\x20merchants)','join','desc','amountAfterGatewayCommissionUSDT','\x20USDT\x20(+','PENDING','\x20\x20\x20🌍\x20Country:\x20','\x20in\x20','../types/gateway','90d','statusChangedAt','Error\x20parsing\x20gateway\x20settings\x20for\x20shop\x20','📊\x20Gateway\x20filter\x20applied:','customerUa','\x20USDT\x20(without\x20commission)','deleteUser','getTime','chargebackAmount','\x20missing\x20amountUSDT,\x20using\x20fallback\x20conversion','\x27\x20->\x20name\x20\x27','%\x20from\x20','customerIp','__importDefault','📊\x20Total\x20payments\x20(including\x20failed):\x20','\x20\x20\x20🔍\x20Raw\x20balance\x20sum:\x20','MasterCard','localeCompare','Rapyd','totalPaidOut','usdtPolygonWallet','pendingUrl','balance','$transaction','updateCustomerData','getAllPayouts','🔐\x20[','Error\x20parsing\x20gateway\x20settings\x20for\x20payment\x20','toLowerCase','substr','customerCountry','not\x20specified','sort','klyme_eu','getPayoutStats','🔧\x20[','💰\x20Creating\x20payout\x20for\x20shop\x20','getFullYear','parse','fullName','all','getGatewayIdByName','entries','amount','log','💰\x20Current\x20shop\x20balance:\x20','\x20\x20\x20Added\x20to\x20balance:\x20+','publicKey','shop','\x20no\x20longer\x20PAID:','split','📊\x20Getting\x20payments\x20with\x20filters:','\x20\x20\x20�📊\x20Total\x20payments:\x20','\x20balance\x20updated:\x20','findUnique','currencyService','password','\x20USDT\x20(after\x20','usdcPolygonWallet','\x20status:\x20','gateways','\x20\x20\x20Current\x20balance:\x20','✅\x20Customer\x20data\x20updated\x20for\x20payment\x20','dateTo','\x20\x20\x20Payout\x20amount:\x20','periodFrom','periodTo','🔄\x20Gateway\x20mapping:','amountUSDT','some','statusChangedBy','\x20\x20\x20Full\x20amount:\x20','\x20\x20\x20📅\x20Total\x20payouts\x20(this\x20month):\x20','\x20\x20\x20💰\x20Total\x20payout:\x20','amountAfterCommissionUSDT','network','insensitive','📊\x20Merchant\x20statistics\x20calculated:','generateDailyStatistics','30d','randomBytes','\x20USDT\x20(gross\x20revenue)','\x20USDT\x20(with\x20commission\x20deducted)','💰\x20Shop\x20','📊\x20[ADMIN]\x20Calculating\x20commission\x20manually\x20for\x20payment\x20','getMerchantsAwaitingPayout','📊\x20Calculating\x20payout\x20statistics...','not\x20set','getAllPayments','gte',']\x20Gateway\x20settings\x20JSON\x20string:','\x20for\x20shop\x20','totalCommissionRate',':\x20commission\x20=\x20','trim','📅\x20Period\x20\x27all\x27:\x20Using\x20start\x20date\x20from\x20first\x20payment:\x20','sk_','Noda','Payment\x20not\x20found','\x20\x20\x20⏳\x20Pending\x20payout:\x20','COMPLETED','2VTBTIf',']\x20Gateway\x20settings\x20before\x20saving:','\x20\x20\x20Gateway:\x20','paidOutUSDT','Shop\x20not\x20found','telegramId','groupBy','klyme_de','merchantEarningsUSDT','\x20\x20\x20Balance:\x20','payout','hex','convertToUSDT','status','create','crypto','7818240ajVwzn','🔄\x20Gateway\x20mapping\x20(get):','date','payment','\x20\x20\x20💸\x20Total\x20payouts\x20(all\x20time):\x20','64252rrTPCZ','telegram','forEach','\x27\x20(from\x20\x27','findMany','KLYME\x20EU','cointopay2','lte','findFirst','\x20\x20\x20🌐\x20IP:\x20','\x20USDT\x20(-','totalTurnover','averageCommissionRate','successUrl','awaitingPayout','commissionUSDT','getPaymentById','\x20\x20\x20⏳\x20Awaiting\x20payout:\x20','\x20\x20\x20Total\x20paid\x20out:\x20','update','delete','📅\x20Period:\x20','summary','💸\x20CHARGEBACK:\x20Merchant\x20amount\x20already\x20deducted\x20from\x20balance','toString','\x20\x20\x20�\x20Total\x20payments\x20turnover:\x20','\x20payments)','\x27\x20not\x20found.\x20Available\x20gateways:\x20','stringify','💳\x20Payout\x20wallet\x20for\x20','activateUser','getGatewayNameById','Plisio','gateway','custom','\x20\x20\x20Transaction\x20hash:\x20','test_gateway','turnoverUSDT','year','2356858djrCai','PAID','\x20USDT','error','commission','📋\x20Found\x20','\x20\x20\x20💰\x20Total\x20payments\x20turnover:\x20','usdtTrcWallet','🔍\x20Using\x20gateway\x20\x27','⚠️\x20Payment\x20','%\x20commission)','getPayoutById','hash','asc','\x20\x20\x20🖥️\x20User\x20Agent:\x20','currency','paymentsCount','set','gatewayOrderId','turnover','noda','getMerchantsSelection','\x20\x20\x20🔍\x20Calculated\x20after\x20commission:\x20','createPayout','pk_','🔄\x20Converted\x20gateway\x20name\x20\x27','map','../config/database','AdminService','💰\x20Found\x20','round','createdAt'];a35_0x4b69=function(){return _0x2d3e7b;};return a35_0x4b69();}function a35_0x4f37(_0x5d6b33,_0x5a5514){const _0x4b69aa=a35_0x4b69();return a35_0x4f37=function(_0x4f3764,_0x142301){_0x4f3764=_0x4f3764-0xa6;let _0x21d180=_0x4b69aa[_0x4f3764];return _0x21d180;},a35_0x4f37(_0x5d6b33,_0x5a5514);}const a35_0x5da564=a35_0x4f37;(function(_0x3de24f,_0x2e82ab){const _0x950e2d=a35_0x4f37,_0x22ad0d=_0x3de24f();while(!![]){try{const _0x367b0b=parseInt(_0x950e2d(0xf9))/0x1+parseInt(_0x950e2d(0x1d0))/0x2*(parseInt(_0x950e2d(0x153))/0x3)+parseInt(_0x950e2d(0x1e5))/0x4*(parseInt(_0x950e2d(0xfa))/0x5)+-parseInt(_0x950e2d(0x109))/0x6+-parseInt(_0x950e2d(0xc8))/0x7+-parseInt(_0x950e2d(0x1e0))/0x8+parseInt(_0x950e2d(0x124))/0x9;if(_0x367b0b===_0x2e82ab)break;else _0x22ad0d['push'](_0x22ad0d['shift']());}catch(_0xcf2e1a){_0x22ad0d['push'](_0x22ad0d['shift']());}}}(a35_0x4b69,0x7bf98));var __importDefault=this&&this[a35_0x5da564(0x178)]||function(_0x1723d9){const _0x3aff64=a35_0x5da564;return _0x1723d9&&_0x1723d9[_0x3aff64(0xf7)]?_0x1723d9:{'default':_0x1723d9};};Object[a35_0x5da564(0x12c)](exports,'__esModule',{'value':!![]}),exports[a35_0x5da564(0xe4)]=void 0x0;const database_1=__importDefault(require(a35_0x5da564(0xe3))),bcryptjs_1=__importDefault(require(a35_0x5da564(0x151))),crypto_1=__importDefault(require(a35_0x5da564(0x1df))),currencyService_1=require(a35_0x5da564(0xee)),gateway_1=require(a35_0x5da564(0x16a));class AdminService{async[a35_0x5da564(0x18d)](){const _0x1b6e99=a35_0x5da564;console[_0x1b6e99(0x197)](_0x1b6e99(0x1c1));const _0x1c8e7c=await database_1[_0x1b6e99(0x127)][_0x1b6e99(0x19b)]['aggregate']({'_sum':{'balance':!![],'totalPaidOut':!![]},'where':{'status':_0x1b6e99(0x10f)}}),_0x293354=await this[_0x1b6e99(0x1c0)]({'page':0x1,'limit':0x3e8}),_0x4b421e=await database_1['default'][_0x1b6e99(0x1e3)][_0x1b6e99(0x123)]({'where':{'status':_0x1b6e99(0xc9),'gateway':{'not':_0x1b6e99(0xc5)}}}),_0x388ff6=new Date(),_0x2af538=new Date(_0x388ff6[_0x1b6e99(0x190)](),_0x388ff6['getMonth'](),0x1),_0x228c11=new Date(_0x388ff6[_0x1b6e99(0x190)](),_0x388ff6[_0x1b6e99(0x13e)]()+0x1,0x0,0x17,0x3b,0x3b,0x3e7),_0x2b0a93=await database_1[_0x1b6e99(0x127)][_0x1b6e99(0x1da)][_0x1b6e99(0x142)]({'_sum':{'amount':!![]},'where':{'createdAt':{'gte':_0x2af538,'lte':_0x228c11},'status':'COMPLETED'}}),_0x4a5516=_0x1c8e7c[_0x1b6e99(0xf8)][_0x1b6e99(0x17e)]||0x0,_0x17f4ac=_0x293354[_0x1b6e99(0xb7)]['totalAmountAfterCommissionUSDT'],_0x17fd4b=_0x2b0a93[_0x1b6e99(0xf8)][_0x1b6e99(0x196)]||0x0,_0x182e21={'totalPayout':Math[_0x1b6e99(0xe6)](_0x4a5516*0x64)/0x64,'awaitingPayout':Math['round'](_0x17f4ac*0x64)/0x64,'thisMonth':Math[_0x1b6e99(0xe6)](_0x17fd4b*0x64)/0x64,'availableBalance':Math[_0x1b6e99(0xe6)](_0x17f4ac*0x64)/0x64,'totalPayments':_0x4b421e};return console[_0x1b6e99(0x197)](_0x1b6e99(0x102)),console[_0x1b6e99(0x197)](_0x1b6e99(0x1b4)+_0x182e21[_0x1b6e99(0x101)]+_0x1b6e99(0x162)),console[_0x1b6e99(0x197)](_0x1b6e99(0xb2)+_0x182e21[_0x1b6e99(0xaf)]+_0x1b6e99(0x1bd)),console['log'](_0x1b6e99(0x144)+_0x182e21[_0x1b6e99(0x133)]+'\x20USDT\x20(same\x20as\x20awaiting)'),console[_0x1b6e99(0x197)]('\x20\x20\x20📅\x20This\x20month:\x20'+_0x182e21[_0x1b6e99(0xf6)]+_0x1b6e99(0xca)),console[_0x1b6e99(0x197)](_0x1b6e99(0x105)+_0x182e21[_0x1b6e99(0xfd)]+_0x1b6e99(0x112)),console[_0x1b6e99(0x197)](_0x1b6e99(0x17a)+(_0x1c8e7c['_sum'][_0x1b6e99(0x181)]||0x0)[_0x1b6e99(0x104)](0x2)+_0x1b6e99(0x170)),console[_0x1b6e99(0x197)]('\x20\x20\x20📊\x20Commission\x20difference:\x20'+((_0x1c8e7c[_0x1b6e99(0xf8)]['balance']||0x0)-_0x17f4ac)[_0x1b6e99(0x104)](0x2)+'\x20USDT'),_0x182e21;}async[a35_0x5da564(0x183)](_0x1a0fbb,_0x11dec0){const _0x4c0f5d=a35_0x5da564;console['log'](_0x4c0f5d(0x130)+_0x1a0fbb+':',_0x11dec0);const _0x34c66d=await database_1[_0x4c0f5d(0x127)][_0x4c0f5d(0x1e3)][_0x4c0f5d(0x1a1)]({'where':{'id':_0x1a0fbb},'select':{'id':!![],'customerEmail':!![],'customerName':!![],'customerCountry':!![],'customerIp':!![],'customerUa':!![]}});if(!_0x34c66d)throw new Error(_0x4c0f5d(0x1cd));const _0x10bf47={};_0x11dec0[_0x4c0f5d(0x189)]!==undefined&&(_0x10bf47['customerCountry']=_0x11dec0[_0x4c0f5d(0x189)]||null);_0x11dec0['customerIp']!==undefined&&(_0x10bf47[_0x4c0f5d(0x177)]=_0x11dec0[_0x4c0f5d(0x177)]||null);_0x11dec0['customerUa']!==undefined&&(_0x10bf47['customerUa']=_0x11dec0['customerUa']||null);const _0xb64666=await database_1[_0x4c0f5d(0x127)]['payment']['update']({'where':{'id':_0x1a0fbb},'data':{..._0x10bf47,'updatedAt':new Date()},'select':{'id':!![],'customerEmail':!![],'customerName':!![],'customerCountry':!![],'customerIp':!![],'customerUa':!![],'updatedAt':!![]}});return console['log'](_0x4c0f5d(0x1a9)+_0x1a0fbb),console[_0x4c0f5d(0x197)](_0x4c0f5d(0x168)+_0x34c66d[_0x4c0f5d(0x189)]+_0x4c0f5d(0xf2)+_0xb64666[_0x4c0f5d(0x189)]),console[_0x4c0f5d(0x197)](_0x4c0f5d(0xaa)+_0x34c66d[_0x4c0f5d(0x177)]+_0x4c0f5d(0xf2)+_0xb64666['customerIp']),console['log'](_0x4c0f5d(0xd6)+(_0x34c66d['customerUa']?_0x4c0f5d(0xd9):_0x4c0f5d(0x1c2))+_0x4c0f5d(0xf2)+(_0xb64666['customerUa']?_0x4c0f5d(0xd9):'not\x20set')),_0xb64666;}async['getSystemStatistics'](_0x4350f4){const _0x6bb3ea=a35_0x5da564,_0x42f4b1=new Date();let _0x4d91d5;switch(_0x4350f4){case'7d':_0x4d91d5=new Date(_0x42f4b1[_0x6bb3ea(0x172)]()-0x7*0x18*0x3c*0x3c*0x3e8);break;case _0x6bb3ea(0x1ba):_0x4d91d5=new Date(_0x42f4b1[_0x6bb3ea(0x172)]()-0x1e*0x18*0x3c*0x3c*0x3e8);break;case _0x6bb3ea(0x16b):_0x4d91d5=new Date(_0x42f4b1[_0x6bb3ea(0x172)]()-0x5a*0x18*0x3c*0x3c*0x3e8);break;case _0x6bb3ea(0x193):const _0x5ccd01=await database_1['default'][_0x6bb3ea(0x1e3)]['findFirst']({'where':{'gateway':{'not':_0x6bb3ea(0xc5)}},'orderBy':{'createdAt':_0x6bb3ea(0xd5)},'select':{'createdAt':!![]}});_0x4d91d5=_0x5ccd01?_0x5ccd01[_0x6bb3ea(0xe7)]:new Date(_0x6bb3ea(0x11a)),console[_0x6bb3ea(0x197)](_0x6bb3ea(0x1ca)+_0x4d91d5[_0x6bb3ea(0x115)]());break;default:_0x4d91d5=new Date(_0x42f4b1[_0x6bb3ea(0x172)]()-0x1e*0x18*0x3c*0x3c*0x3e8);}const [_0x36c308,_0x368cd7,_0x1de27a,_0x1928ae,_0x912608,_0x2ea3d7,_0x11c802]=await Promise['all']([database_1['default'][_0x6bb3ea(0x19b)][_0x6bb3ea(0x123)](),database_1[_0x6bb3ea(0x127)]['shop']['count']({'where':{'status':'ACTIVE'}}),database_1['default']['payment'][_0x6bb3ea(0x123)]({'where':{'createdAt':{'gte':_0x4d91d5},'gateway':{'not':'test_gateway'}}}),database_1[_0x6bb3ea(0x127)][_0x6bb3ea(0x1e3)][_0x6bb3ea(0x123)]({'where':{'status':_0x6bb3ea(0xc9),'createdAt':{'gte':_0x4d91d5},'gateway':{'not':_0x6bb3ea(0xc5)}}}),database_1[_0x6bb3ea(0x127)]['payment'][_0x6bb3ea(0x1e9)]({'where':{'status':_0x6bb3ea(0xc9),'createdAt':{'gte':_0x4d91d5},'gateway':{'not':_0x6bb3ea(0xc5)}},'select':{'amount':!![],'currency':!![]}}),database_1[_0x6bb3ea(0x127)][_0x6bb3ea(0x1e3)][_0x6bb3ea(0x1e9)]({'where':{'gateway':{'not':'test_gateway'}},'take':0xa,'orderBy':{'createdAt':'desc'},'include':{'shop':{'select':{'name':!![],'username':!![]}}}}),database_1[_0x6bb3ea(0x127)][_0x6bb3ea(0x1e3)]['findMany']({'where':{'createdAt':{'gte':_0x4d91d5},'gateway':{'not':_0x6bb3ea(0xc5)}},'select':{'amount':!![],'currency':!![],'status':!![],'amountUSDT':!![],'createdAt':!![]}})]);let _0x1d3461=0x0;for(const _0x4b40b9 of _0x912608){const _0x1561ca=await currencyService_1[_0x6bb3ea(0x1a2)][_0x6bb3ea(0x1dc)](_0x4b40b9['amount'],_0x4b40b9[_0x6bb3ea(0xd7)]);_0x1d3461+=_0x1561ca;}const _0x578ad8=this['generateDailyStatistics'](_0x11c802,_0x4d91d5,_0x42f4b1),_0x313c55=_0x1de27a>0x0?_0x1928ae/_0x1de27a*0x64:0x0;return{'totalShops':_0x36c308,'activeShops':_0x368cd7,'totalPayments':_0x1de27a,'successfulPayments':_0x1928ae,'totalRevenue':Math[_0x6bb3ea(0xe6)](_0x1d3461*0x64)/0x64,'conversionRate':Math[_0x6bb3ea(0xe6)](_0x313c55*0x64)/0x64,'dailyRevenue':_0x578ad8[_0x6bb3ea(0xef)],'dailyPayments':_0x578ad8['dailyPayments'],'recentPayments':_0x2ea3d7[_0x6bb3ea(0xe2)](_0x262aca=>({'id':_0x262aca['id'],'amount':_0x262aca[_0x6bb3ea(0x196)],'currency':_0x262aca[_0x6bb3ea(0xd7)],'status':_0x262aca[_0x6bb3ea(0x1dd)],'gateway':_0x262aca[_0x6bb3ea(0xc2)],'shop':_0x262aca[_0x6bb3ea(0x19b)],'createdAt':_0x262aca[_0x6bb3ea(0xe7)]}))};}async['getMerchantStatistics'](_0x39ddfc){const _0x6643f4=a35_0x5da564;console[_0x6643f4(0x197)](_0x6643f4(0x15f),_0x39ddfc);let _0x36f352,_0x41a279=new Date();if(_0x39ddfc['period']===_0x6643f4(0xc3)&&_0x39ddfc['dateFrom']&&_0x39ddfc['dateTo'])_0x36f352=new Date(_0x39ddfc[_0x6643f4(0xfe)]),_0x41a279=new Date(_0x39ddfc[_0x6643f4(0x1aa)]);else{const _0x183076=new Date();switch(_0x39ddfc[_0x6643f4(0x14e)]){case _0x6643f4(0xe9):_0x36f352=new Date(_0x183076['getTime']()-0x7*0x18*0x3c*0x3c*0x3e8);break;case'month':_0x36f352=new Date(_0x183076[_0x6643f4(0x172)]()-0x1e*0x18*0x3c*0x3c*0x3e8);break;case _0x6643f4(0xc7):_0x36f352=new Date(_0x183076['getTime']()-0x16d*0x18*0x3c*0x3c*0x3e8);break;case _0x6643f4(0x193):default:_0x36f352=new Date(_0x6643f4(0x11a));break;}}console['log'](_0x6643f4(0xb6)+_0x36f352[_0x6643f4(0x115)]()+_0x6643f4(0x122)+_0x41a279[_0x6643f4(0x115)]());const _0x4ab30a={'status':_0x6643f4(0xc9),'gateway':{'not':_0x6643f4(0xc5)},'paidAt':{'gte':_0x36f352,'lte':_0x41a279}};_0x39ddfc[_0x6643f4(0x15a)]&&(_0x4ab30a[_0x6643f4(0x15a)]=_0x39ddfc[_0x6643f4(0x15a)]);const _0x3cc5ee=await database_1[_0x6643f4(0x127)]['payment'][_0x6643f4(0x1e9)]({'where':_0x4ab30a,'include':{'shop':{'select':{'id':!![],'name':!![],'username':!![],'gatewaySettings':!![]}}}});console[_0x6643f4(0x197)](_0x6643f4(0xe5)+_0x3cc5ee[_0x6643f4(0x145)]+'\x20paid\x20payments\x20for\x20analysis');const _0x574466={'gateway':{'not':_0x6643f4(0xc5)},'createdAt':{'gte':_0x36f352,'lte':_0x41a279}};_0x39ddfc['shopId']&&(_0x574466['shopId']=_0x39ddfc[_0x6643f4(0x15a)]);const _0x37ef5b=await database_1[_0x6643f4(0x127)][_0x6643f4(0x1e3)][_0x6643f4(0x123)]({'where':_0x574466});console[_0x6643f4(0x197)](_0x6643f4(0x179)+_0x37ef5b+_0x6643f4(0x107)+_0x3cc5ee[_0x6643f4(0x145)]);let _0x37269f=0x0,_0x39959b=0x0,_0x50e188=0x0;const _0x23fa2e={},_0x5145ec={},_0x54139d={};for(const _0x586cdf of _0x3cc5ee){try{const _0x582313=await currencyService_1[_0x6643f4(0x1a2)][_0x6643f4(0x1dc)](_0x586cdf[_0x6643f4(0x196)],_0x586cdf[_0x6643f4(0xd7)]);let _0x47b438={};if(_0x586cdf[_0x6643f4(0x19b)][_0x6643f4(0x137)])try{_0x47b438=JSON[_0x6643f4(0x191)](_0x586cdf['shop']['gatewaySettings']);}catch(_0x4b39c5){console[_0x6643f4(0xcb)](_0x6643f4(0x16d)+_0x586cdf[_0x6643f4(0x15a)]+':',_0x4b39c5);}let _0x2444d8={},_0x5ee690=0xa;for(const [_0x34204c,_0x44e353]of Object[_0x6643f4(0x195)](_0x47b438)){if(_0x34204c[_0x6643f4(0x187)]()===_0x586cdf[_0x6643f4(0xc2)][_0x6643f4(0x187)]()){_0x2444d8=_0x44e353,_0x5ee690=_0x44e353[_0x6643f4(0xcc)]||0xa;break;}}let _0x5c6afa,_0x2d7686;_0x586cdf[_0x6643f4(0x165)]!==null&&_0x586cdf[_0x6643f4(0x165)]!==undefined?(_0x5c6afa=_0x586cdf[_0x6643f4(0x165)],_0x2d7686=_0x582313-_0x5c6afa,console['log'](_0x6643f4(0x128)+_0x5c6afa[_0x6643f4(0x104)](0x6)+_0x6643f4(0x113)+_0x586cdf['id'])):(_0x2d7686=_0x582313*(_0x5ee690/0x64),_0x5c6afa=_0x582313-_0x2d7686,console['log'](_0x6643f4(0x13f)+_0x586cdf['id']+':\x20'+_0x5ee690+'%\x20from\x20'+_0x582313[_0x6643f4(0x104)](0x6)+_0x6643f4(0xca)));_0x37269f+=_0x582313,_0x39959b+=_0x5c6afa,_0x50e188+=_0x2d7686;!_0x23fa2e[_0x586cdf['gateway']]&&(_0x23fa2e[_0x586cdf['gateway']]={'gateway':_0x586cdf[_0x6643f4(0xc2)],'gatewayDisplayName':this[_0x6643f4(0x14d)](_0x586cdf[_0x6643f4(0xc2)]),'paymentsCount':0x0,'turnoverUSDT':0x0,'commissionUSDT':0x0,'merchantEarningsUSDT':0x0,'totalCommissionRate':0x0});_0x23fa2e[_0x586cdf[_0x6643f4(0xc2)]][_0x6643f4(0xd8)]++,_0x23fa2e[_0x586cdf[_0x6643f4(0xc2)]]['turnoverUSDT']+=_0x582313,_0x23fa2e[_0x586cdf[_0x6643f4(0xc2)]][_0x6643f4(0xb0)]+=_0x2d7686,_0x23fa2e[_0x586cdf['gateway']][_0x6643f4(0x1d8)]+=_0x5c6afa,_0x23fa2e[_0x586cdf[_0x6643f4(0xc2)]][_0x6643f4(0x1c7)]+=_0x5ee690;!_0x39ddfc[_0x6643f4(0x15a)]&&(!_0x5145ec[_0x586cdf[_0x6643f4(0x15a)]]&&(_0x5145ec[_0x586cdf[_0x6643f4(0x15a)]]={'shopId':_0x586cdf[_0x6643f4(0x15a)],'shopName':_0x586cdf['shop'][_0x6643f4(0x131)],'shopUsername':_0x586cdf[_0x6643f4(0x19b)][_0x6643f4(0xec)],'paymentsCount':0x0,'turnoverUSDT':0x0,'commissionUSDT':0x0,'merchantEarningsUSDT':0x0,'paidOutUSDT':0x0,'averageCheckUSDT':0x0}),_0x5145ec[_0x586cdf[_0x6643f4(0x15a)]][_0x6643f4(0xd8)]++,_0x5145ec[_0x586cdf[_0x6643f4(0x15a)]][_0x6643f4(0xc6)]+=_0x582313,_0x5145ec[_0x586cdf['shopId']][_0x6643f4(0xb0)]+=_0x2d7686,_0x5145ec[_0x586cdf[_0x6643f4(0x15a)]][_0x6643f4(0x1d8)]+=_0x5c6afa);const _0x5289c8=_0x586cdf[_0x6643f4(0x11f)][_0x6643f4(0x115)]()[_0x6643f4(0x19d)]('T')[0x0];!_0x54139d[_0x5289c8]&&(_0x54139d[_0x5289c8]={'date':_0x5289c8,'turnover':0x0,'merchantEarnings':0x0,'gatewayEarnings':0x0,'paymentsCount':0x0}),_0x54139d[_0x5289c8]['turnover']+=_0x582313,_0x54139d[_0x5289c8][_0x6643f4(0x143)]+=_0x5c6afa,_0x54139d[_0x5289c8][_0x6643f4(0x129)]+=_0x2d7686,_0x54139d[_0x5289c8][_0x6643f4(0xd8)]++;}catch(_0x4513b4){console[_0x6643f4(0xcb)]('Error\x20processing\x20payment\x20'+_0x586cdf['id']+':',_0x4513b4);}}Object['values'](_0x23fa2e)['forEach'](_0x2495a7=>{const _0x4e59b2=_0x6643f4;_0x2495a7['averageCommissionRate']=_0x2495a7['paymentsCount']>0x0?_0x2495a7[_0x4e59b2(0x1c7)]/_0x2495a7[_0x4e59b2(0xd8)]:0x0,delete _0x2495a7[_0x4e59b2(0x1c7)];}),Object[_0x6643f4(0x121)](_0x5145ec)[_0x6643f4(0x1e7)](_0x80ef87=>{const _0x1d47d8=_0x6643f4;_0x80ef87[_0x1d47d8(0x156)]=_0x80ef87[_0x1d47d8(0xd8)]>0x0?_0x80ef87[_0x1d47d8(0xc6)]/_0x80ef87[_0x1d47d8(0xd8)]:0x0;});let _0x84e4a2=0x0,_0x1c53a5=0x0;if(_0x39ddfc[_0x6643f4(0x15a)]){const _0x2e75b8=await database_1[_0x6643f4(0x127)][_0x6643f4(0x1da)][_0x6643f4(0x1e9)]({'where':{'shopId':_0x39ddfc[_0x6643f4(0x15a)],'status':_0x6643f4(0x1cf),'createdAt':{'gte':_0x36f352,'lte':_0x41a279}},'select':{'amount':!![]}});_0x84e4a2=_0x2e75b8['reduce']((_0x21de08,_0x212a94)=>_0x21de08+_0x212a94[_0x6643f4(0x196)],0x0);const _0x4fca5c=await database_1[_0x6643f4(0x127)][_0x6643f4(0x1da)]['findMany']({'where':{'shopId':_0x39ddfc[_0x6643f4(0x15a)],'status':_0x6643f4(0x167),'createdAt':{'gte':_0x36f352,'lte':_0x41a279}},'select':{'amount':!![]}});_0x1c53a5=_0x4fca5c['reduce']((_0x417fa4,_0xc9f6a)=>_0x417fa4+_0xc9f6a['amount'],0x0);}const _0x7fcd33=_0x37ef5b,_0x571a7c=_0x3cc5ee['length'],_0xad9ae7=_0x571a7c>0x0?_0x37269f/_0x571a7c:0x0,_0x11c647=_0x7fcd33>0x0?Math['round'](_0x571a7c/_0x7fcd33*0x2710)/0x64:0x0,_0x1f0ea5=Math[_0x6643f4(0x119)]((_0x41a279[_0x6643f4(0x172)]()-_0x36f352[_0x6643f4(0x172)]())/(0x3e8*0x3c*0x3c*0x18)),_0x52ab98={'totalTurnover':Math[_0x6643f4(0xe6)](_0x37269f*0x64)/0x64,'merchantEarnings':Math[_0x6643f4(0xe6)](_0x39959b*0x64)/0x64,'gatewayEarnings':Math[_0x6643f4(0xe6)](_0x50e188*0x64)/0x64,'totalPaidOut':Math[_0x6643f4(0xe6)](_0x84e4a2*0x64)/0x64,'pendingPayout':Math[_0x6643f4(0xe6)](_0x1c53a5*0x64)/0x64,'averageCheck':Math[_0x6643f4(0xe6)](_0xad9ae7*0x64)/0x64,'totalPayments':_0x7fcd33,'successfulPayments':_0x571a7c,'conversionRate':_0x11c647,'gatewayBreakdown':Object[_0x6643f4(0x121)](_0x23fa2e)[_0x6643f4(0xe2)](_0x5b4c4f=>({..._0x5b4c4f,'turnoverUSDT':Math[_0x6643f4(0xe6)](_0x5b4c4f[_0x6643f4(0xc6)]*0x64)/0x64,'commissionUSDT':Math['round'](_0x5b4c4f['commissionUSDT']*0x64)/0x64,'merchantEarningsUSDT':Math[_0x6643f4(0xe6)](_0x5b4c4f['merchantEarningsUSDT']*0x64)/0x64,'averageCommissionRate':Math[_0x6643f4(0xe6)](_0x5b4c4f[_0x6643f4(0xad)]*0x64)/0x64})),'merchantBreakdown':_0x39ddfc['shopId']?undefined:Object[_0x6643f4(0x121)](_0x5145ec)['map'](_0x1014d2=>({..._0x1014d2,'turnoverUSDT':Math[_0x6643f4(0xe6)](_0x1014d2[_0x6643f4(0xc6)]*0x64)/0x64,'commissionUSDT':Math[_0x6643f4(0xe6)](_0x1014d2[_0x6643f4(0xb0)]*0x64)/0x64,'merchantEarningsUSDT':Math[_0x6643f4(0xe6)](_0x1014d2['merchantEarningsUSDT']*0x64)/0x64,'paidOutUSDT':Math[_0x6643f4(0xe6)](_0x1014d2[_0x6643f4(0x1d3)]*0x64)/0x64,'averageCheckUSDT':Math[_0x6643f4(0xe6)](_0x1014d2[_0x6643f4(0x156)]*0x64)/0x64})),'dailyData':Object['values'](_0x54139d)[_0x6643f4(0xe2)](_0xa5bdd4=>({..._0xa5bdd4,'turnover':Math[_0x6643f4(0xe6)](_0xa5bdd4[_0x6643f4(0xdb)]*0x64)/0x64,'merchantEarnings':Math[_0x6643f4(0xe6)](_0xa5bdd4[_0x6643f4(0x143)]*0x64)/0x64,'gatewayEarnings':Math[_0x6643f4(0xe6)](_0xa5bdd4[_0x6643f4(0x129)]*0x64)/0x64}))[_0x6643f4(0x18b)]((_0x43ce09,_0x2ea301)=>_0x43ce09['date'][_0x6643f4(0x17c)](_0x2ea301[_0x6643f4(0x1e2)])),'periodInfo':{'from':_0x36f352,'to':_0x41a279,'periodType':_0x39ddfc[_0x6643f4(0x14e)]||_0x6643f4(0xc3),'daysCount':_0x1f0ea5}};return console['log'](_0x6643f4(0x1b8)),console['log'](_0x6643f4(0x146)+_0x52ab98[_0x6643f4(0xac)]+_0x6643f4(0xca)),console[_0x6643f4(0x197)](_0x6643f4(0x155)+_0x52ab98[_0x6643f4(0x143)]+'\x20USDT'),console[_0x6643f4(0x197)](_0x6643f4(0x132)+_0x52ab98[_0x6643f4(0x129)]+_0x6643f4(0xca)),console[_0x6643f4(0x197)](_0x6643f4(0x10e)+_0x52ab98['totalPaidOut']+_0x6643f4(0xca)),console[_0x6643f4(0x197)](_0x6643f4(0x1ce)+_0x52ab98[_0x6643f4(0x12f)]+_0x6643f4(0xca)),console[_0x6643f4(0x197)](_0x6643f4(0x19f)+_0x52ab98[_0x6643f4(0xfd)]),_0x52ab98;}async[a35_0x5da564(0xdd)](){const _0x3ebe8d=a35_0x5da564;console[_0x3ebe8d(0x197)](_0x3ebe8d(0x11e));const _0x299ce0=await database_1[_0x3ebe8d(0x127)][_0x3ebe8d(0x19b)]['findMany']({'where':{'status':_0x3ebe8d(0x10f)},'select':{'id':!![],'username':!![],'name':!![]},'orderBy':{'name':_0x3ebe8d(0xd5)}});return console[_0x3ebe8d(0x197)](_0x3ebe8d(0xcd)+_0x299ce0[_0x3ebe8d(0x145)]+'\x20active\x20merchants\x20for\x20selection'),_0x299ce0[_0x3ebe8d(0xe2)](_0x5a97ac=>({'id':_0x5a97ac['id'],'username':_0x5a97ac[_0x3ebe8d(0xec)],'name':_0x5a97ac['name']}));}['getGatewayDisplayName'](_0xc3656f){const _0x4e62cc=a35_0x5da564,_0x54ee6a={'test_gateway':_0x4e62cc(0x117),'plisio':_0x4e62cc(0xc1),'rapyd':_0x4e62cc(0x17d),'noda':_0x4e62cc(0x1cc),'cointopay':'CoinToPay','cointopay2':_0x4e62cc(0x12b),'klyme_eu':_0x4e62cc(0xa6),'klyme_gb':_0x4e62cc(0x125),'klyme_de':'KLYME\x20DE','mastercard':_0x4e62cc(0x17b)};return _0x54ee6a[_0xc3656f]||_0xc3656f;}[a35_0x5da564(0x15d)](_0x58be4e){const _0x3f8b16=a35_0x5da564,_0x345e45={'Test\x20Gateway':_0x3f8b16(0xc5),'Plisio':_0x3f8b16(0xff),'Rapyd':_0x3f8b16(0x158),'Noda':_0x3f8b16(0xdc),'CoinToPay':_0x3f8b16(0x11b),'CoinToPay2':_0x3f8b16(0xa7),'KLYME\x20EU':_0x3f8b16(0x18c),'KLYME\x20GB':'klyme_gb','KLYME\x20DE':_0x3f8b16(0x1d7),'MasterCard':_0x3f8b16(0xe8)};return _0x345e45[_0x58be4e]||_0x58be4e[_0x3f8b16(0x187)]();}async[a35_0x5da564(0x1c0)](_0x342acd){const _0x33d55a=a35_0x5da564,{page:_0xa8a455,limit:_0x4cef42,minAmount:_0x472d41,search:_0x438500}=_0x342acd,_0x44217c=(_0xa8a455-0x1)*_0x4cef42;console[_0x33d55a(0x197)]('📊\x20Getting\x20merchants\x20awaiting\x20payout\x20with\x20filters:',_0x342acd);const _0xcf656a={'balance':{'gt':0x0},'status':_0x33d55a(0x10f)};_0x472d41&&(_0xcf656a[_0x33d55a(0x181)][_0x33d55a(0x1c4)]=_0x472d41);_0x438500&&(_0xcf656a['OR']=[{'name':{'contains':_0x438500,'mode':_0x33d55a(0x1b7)}},{'username':{'contains':_0x438500,'mode':_0x33d55a(0x1b7)}}]);const [_0x34f724,_0x15ca23]=await Promise[_0x33d55a(0x193)]([database_1[_0x33d55a(0x127)][_0x33d55a(0x19b)][_0x33d55a(0x1e9)]({'where':_0xcf656a,'skip':_0x44217c,'take':_0x4cef42,'orderBy':{'balance':_0x33d55a(0x164)},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'balance':!![],'totalPaidOut':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'gatewaySettings':!![],'createdAt':!![]}}),database_1[_0x33d55a(0x127)][_0x33d55a(0x19b)][_0x33d55a(0x123)]({'where':_0xcf656a})]);console['log'](_0x33d55a(0xe5)+_0x34f724[_0x33d55a(0x145)]+'\x20merchants\x20with\x20positive\x20balance');const _0x5a2182=await Promise['all'](_0x34f724[_0x33d55a(0xe2)](async _0x42c4b9=>{const _0x4445d4=_0x33d55a,[_0x3f4f90,_0x412a03,_0x4b69ef]=await Promise[_0x4445d4(0x193)]([database_1[_0x4445d4(0x127)]['payment'][_0x4445d4(0x123)]({'where':{'shopId':_0x42c4b9['id'],'status':_0x4445d4(0xc9),'gateway':{'not':_0x4445d4(0xc5)}}}),database_1['default'][_0x4445d4(0x1e3)][_0x4445d4(0xa9)]({'where':{'shopId':_0x42c4b9['id'],'status':_0x4445d4(0xc9),'gateway':{'not':_0x4445d4(0xc5)}},'orderBy':{'paidAt':_0x4445d4(0xd5)},'select':{'paidAt':!![]}}),database_1[_0x4445d4(0x127)]['payment'][_0x4445d4(0x1d6)]({'by':['gateway'],'where':{'shopId':_0x42c4b9['id'],'status':_0x4445d4(0xc9),'gateway':{'not':'test_gateway'}},'_count':{'id':!![]},'_sum':{'amountUSDT':!![]}})]),_0x13a644=new Date(),_0x30153e=new Date(_0x13a644[_0x4445d4(0x190)](),_0x13a644['getMonth'](),0x1),_0x4b29da=new Date(_0x13a644['getFullYear'](),_0x13a644[_0x4445d4(0x13e)]()+0x1,0x0,0x17,0x3b,0x3b,0x3e7),[_0x1be5b2,_0x5d73ad]=await Promise[_0x4445d4(0x193)]([database_1['default']['payout'][_0x4445d4(0x142)]({'_sum':{'amount':!![]},'where':{'shopId':_0x42c4b9['id'],'status':_0x4445d4(0x1cf)}}),database_1[_0x4445d4(0x127)][_0x4445d4(0x1da)]['aggregate']({'_sum':{'amount':!![]},'where':{'shopId':_0x42c4b9['id'],'status':_0x4445d4(0x1cf),'createdAt':{'gte':_0x30153e,'lte':_0x4b29da}}})]),_0x518de0=_0x1be5b2[_0x4445d4(0xf8)][_0x4445d4(0x196)]||0x0,_0x1d4d0d=_0x5d73ad[_0x4445d4(0xf8)][_0x4445d4(0x196)]||0x0,_0x3a419d=await Promise['all'](_0x4b69ef[_0x4445d4(0xe2)](async _0x5d1fe2=>{const _0x3880aa=_0x4445d4;let _0x22241a=0xa;if(_0x42c4b9[_0x3880aa(0x137)])try{const _0x83e0e5=JSON[_0x3880aa(0x191)](_0x42c4b9['gatewaySettings']);for(const [_0xfb2767,_0x40847c]of Object[_0x3880aa(0x195)](_0x83e0e5)){if(_0xfb2767[_0x3880aa(0x187)]()===_0x5d1fe2[_0x3880aa(0xc2)][_0x3880aa(0x187)]()){_0x22241a=_0x40847c[_0x3880aa(0xcc)]||0xa,console[_0x3880aa(0x197)](_0x3880aa(0xfc)+_0x5d1fe2[_0x3880aa(0xc2)]+_0x3880aa(0x1c6)+_0x42c4b9['id']+_0x3880aa(0x1c8)+_0x22241a+'%');break;}}}catch(_0x3913c5){console['error'](_0x3880aa(0x16d)+_0x42c4b9['id']+':',_0x3913c5);}const _0x2648d1=_0x5d1fe2[_0x3880aa(0xf8)]?.[_0x3880aa(0x1af)]||0x0,_0x5efee7=_0x2648d1*(0x1-_0x22241a/0x64);return{'gateway':_0x5d1fe2[_0x3880aa(0xc2)],'count':_0x5d1fe2[_0x3880aa(0x103)]?.['id']||0x0,'amountUSDT':Math['round'](_0x2648d1*0x64)/0x64,'amountAfterCommissionUSDT':Math[_0x3880aa(0xe6)](_0x5efee7*0x64)/0x64,'commission':_0x22241a};})),_0x401612=_0x3a419d[_0x4445d4(0x10b)]((_0x28ff93,_0x267d69)=>_0x28ff93+_0x267d69[_0x4445d4(0x1af)],0x0),_0x1d2d32=_0x42c4b9[_0x4445d4(0x181)];return console[_0x4445d4(0x197)]('💰\x20[PAYOUT]\x20Merchant\x20'+_0x42c4b9[_0x4445d4(0xec)]+':'),console[_0x4445d4(0x197)](_0x4445d4(0xba)+_0x401612['toFixed'](0x2)+'\x20USDT\x20(gross\x20revenue)'),console[_0x4445d4(0x197)](_0x4445d4(0xde)+_0x3a419d[_0x4445d4(0x10b)]((_0x187cc4,_0x1c0e50)=>_0x187cc4+_0x1c0e50[_0x4445d4(0x1b5)],0x0)['toFixed'](0x2)+'\x20USDT\x20(theoretical\x20net)'),console['log'](_0x4445d4(0x10a)+_0x1d2d32['toFixed'](0x2)+'\x20USDT\x20(after\x20payouts)'),{'id':_0x42c4b9['id'],'fullName':_0x42c4b9['name'],'username':_0x42c4b9[_0x4445d4(0xec)],'telegramId':_0x42c4b9[_0x4445d4(0x1e6)],'merchantUrl':_0x42c4b9[_0x4445d4(0x11c)],'wallets':{'usdtPolygonWallet':_0x42c4b9[_0x4445d4(0x17f)],'usdtTrcWallet':_0x42c4b9[_0x4445d4(0xcf)],'usdtErcWallet':_0x42c4b9['usdtErcWallet'],'usdcPolygonWallet':_0x42c4b9[_0x4445d4(0x1a5)]},'totalAmountUSDT':Math['round'](_0x401612*0x64)/0x64,'totalAmountAfterCommissionUSDT':Math[_0x4445d4(0xe6)](_0x1d2d32*0x64)/0x64,'totalPayout':Math[_0x4445d4(0xe6)](_0x518de0*0x64)/0x64,'thisMonth':Math['round'](_0x1d4d0d*0x64)/0x64,'paymentsCount':_0x3f4f90,'oldestPaymentDate':_0x412a03?.['paidAt']||_0x42c4b9[_0x4445d4(0xe7)],'gatewayBreakdown':_0x3a419d};})),_0x4a3ef1=_0x5a2182[_0x33d55a(0x10b)]((_0x53997f,_0x210fc3)=>_0x53997f+_0x210fc3[_0x33d55a(0x14f)],0x0),_0x5c936a=_0x5a2182[_0x33d55a(0x10b)]((_0x438ea5,_0x1c133f)=>_0x438ea5+_0x1c133f[_0x33d55a(0x15b)],0x0),_0x269a11=_0x5a2182[_0x33d55a(0x10b)]((_0x2136ee,_0x2c57e0)=>_0x2136ee+_0x2c57e0['totalPayout'],0x0),_0x391be6=_0x5a2182['reduce']((_0x393c53,_0xef1777)=>_0x393c53+_0xef1777[_0x33d55a(0xf6)],0x0);return console[_0x33d55a(0x197)](_0x33d55a(0xed)+_0x15ca23+'\x20merchants'),console[_0x33d55a(0x197)](_0x33d55a(0xce)+Math[_0x33d55a(0xe6)](_0x4a3ef1*0x64)/0x64+_0x33d55a(0x1bc)),console[_0x33d55a(0x197)]('\x20\x20\x20✅\x20Total\x20available\x20for\x20payout:\x20'+Math[_0x33d55a(0xe6)](_0x5c936a*0x64)/0x64+'\x20USDT\x20(actual\x20balances)'),console[_0x33d55a(0x197)](_0x33d55a(0x1e4)+Math[_0x33d55a(0xe6)](_0x269a11*0x64)/0x64+_0x33d55a(0xca)),console[_0x33d55a(0x197)](_0x33d55a(0x1b3)+Math[_0x33d55a(0xe6)](_0x391be6*0x64)/0x64+'\x20USDT'),{'merchants':_0x5a2182,'pagination':{'page':_0xa8a455,'limit':_0x4cef42,'total':_0x15ca23,'totalPages':Math[_0x33d55a(0x119)](_0x15ca23/_0x4cef42)},'summary':{'totalMerchants':_0x15ca23,'totalAmountUSDT':Math[_0x33d55a(0xe6)](_0x4a3ef1*0x64)/0x64,'totalAmountAfterCommissionUSDT':Math[_0x33d55a(0xe6)](_0x5c936a*0x64)/0x64,'totalPayout':Math[_0x33d55a(0xe6)](_0x269a11*0x64)/0x64,'thisMonth':Math[_0x33d55a(0xe6)](_0x391be6*0x64)/0x64}};}async[a35_0x5da564(0xdf)](_0x368532){const _0x503ed8=a35_0x5da564,{shopId:_0x2d44cd,amount:_0x35c5f6,network:_0xbe76b7,wallet:_0x55dad5,notes:_0x5adf7c,txid:_0x5d8509,periodFrom:_0x57f088,periodTo:_0x1d9284}=_0x368532,_0x7adcb6=await database_1[_0x503ed8(0x127)][_0x503ed8(0x182)](async _0x5c1bb5=>{const _0x542293=_0x503ed8,_0x10bc62=await _0x5c1bb5[_0x542293(0x19b)][_0x542293(0x1a1)]({'where':{'id':_0x2d44cd},'select':{'id':!![],'name':!![],'username':!![],'balance':!![],'totalPaidOut':!![]}});if(!_0x10bc62)throw new Error(_0x542293(0x1d4));console[_0x542293(0x197)](_0x542293(0x18f)+_0x10bc62['username']+':'),console[_0x542293(0x197)](_0x542293(0x1a8)+_0x10bc62['balance']['toFixed'](0x6)+_0x542293(0xca)),console[_0x542293(0x197)](_0x542293(0x1ab)+_0x35c5f6['toFixed'](0x6)+'\x20USDT'),console[_0x542293(0x197)](_0x542293(0xfb)+_0x10bc62[_0x542293(0x17e)][_0x542293(0x104)](0x6)+_0x542293(0xca));if(_0x5d8509)console[_0x542293(0x197)](_0x542293(0xc4)+_0x5d8509);if(_0x10bc62[_0x542293(0x181)]<_0x35c5f6)throw new Error('Insufficient\x20balance.\x20Available:\x20'+_0x10bc62[_0x542293(0x181)][_0x542293(0x104)](0x6)+_0x542293(0xf0)+_0x35c5f6[_0x542293(0x104)](0x6)+'\x20USDT');let _0x3ddc94=_0x55dad5;if(!_0x3ddc94){const _0x53a86c=await _0x5c1bb5[_0x542293(0x19b)][_0x542293(0x1a1)]({'where':{'id':_0x2d44cd},'select':{'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![]}});if(_0x53a86c)switch(_0xbe76b7){case'polygon':_0x3ddc94=_0x53a86c[_0x542293(0x17f)]||undefined;break;case'trc20':_0x3ddc94=_0x53a86c[_0x542293(0xcf)]||undefined;break;case'erc20':_0x3ddc94=_0x53a86c['usdtErcWallet']||undefined;break;case _0x542293(0x152):_0x3ddc94=_0x53a86c[_0x542293(0x1a5)]||undefined;break;}}console['log'](_0x542293(0xbe)+_0xbe76b7+':\x20'+(_0x3ddc94||_0x542293(0x18a)));const _0x2a3451=await _0x5c1bb5[_0x542293(0x1da)][_0x542293(0x1de)]({'data':{'shopId':_0x2d44cd,'amount':_0x35c5f6,'network':_0xbe76b7,'status':'COMPLETED','txid':_0x5d8509,'notes':_0x5adf7c,'periodFrom':_0x57f088?new Date(_0x57f088):null,'periodTo':_0x1d9284?new Date(_0x1d9284):null,'createdAt':new Date(),'paidAt':new Date()}}),_0x12c69c=_0x10bc62[_0x542293(0x181)]-_0x35c5f6,_0xba214e=_0x10bc62[_0x542293(0x17e)]+_0x35c5f6;return await _0x5c1bb5['shop'][_0x542293(0xb4)]({'where':{'id':_0x2d44cd},'data':{'balance':_0x12c69c,'totalPaidOut':_0xba214e}}),console[_0x542293(0x197)](_0x542293(0x1be)+_0x10bc62[_0x542293(0xec)]+_0x542293(0xeb)),console[_0x542293(0x197)](_0x542293(0x1d9)+_0x10bc62[_0x542293(0x181)][_0x542293(0x104)](0x6)+_0x542293(0xf2)+_0x12c69c[_0x542293(0x104)](0x6)+_0x542293(0xab)+_0x35c5f6['toFixed'](0x6)+')'),console[_0x542293(0x197)](_0x542293(0xb3)+_0x10bc62[_0x542293(0x17e)]['toFixed'](0x6)+_0x542293(0xf2)+_0xba214e[_0x542293(0x104)](0x6)+_0x542293(0x166)+_0x35c5f6[_0x542293(0x104)](0x6)+')'),{'payout':_0x2a3451,'shop':_0x10bc62};});return console['log']('✅\x20Payout\x20created:\x20'+_0x7adcb6[_0x503ed8(0x1da)]['id']+'\x20for\x20shop\x20'+_0x7adcb6[_0x503ed8(0x19b)]['username']+'\x20('+_0x35c5f6+'\x20USDT)'),{'id':_0x7adcb6[_0x503ed8(0x1da)]['id'],'shopId':_0x7adcb6[_0x503ed8(0x1da)][_0x503ed8(0x15a)],'shopName':_0x7adcb6['shop'][_0x503ed8(0x131)],'shopUsername':_0x7adcb6[_0x503ed8(0x19b)][_0x503ed8(0xec)],'amount':_0x7adcb6['payout'][_0x503ed8(0x196)],'network':_0x7adcb6[_0x503ed8(0x1da)][_0x503ed8(0x1b6)],'status':_0x7adcb6[_0x503ed8(0x1da)][_0x503ed8(0x1dd)],'txid':_0x7adcb6[_0x503ed8(0x1da)][_0x503ed8(0x126)],'notes':_0x7adcb6[_0x503ed8(0x1da)][_0x503ed8(0x10d)],'periodFrom':_0x7adcb6[_0x503ed8(0x1da)][_0x503ed8(0x1ac)],'periodTo':_0x7adcb6[_0x503ed8(0x1da)][_0x503ed8(0x1ad)],'createdAt':_0x7adcb6[_0x503ed8(0x1da)][_0x503ed8(0xe7)],'paidAt':_0x7adcb6[_0x503ed8(0x1da)]['paidAt']};}async[a35_0x5da564(0x184)](_0x121e6d){const _0x4e519a=a35_0x5da564,{page:_0x565cfe,limit:_0x406a4d,shopId:_0x30e46f,network:_0x22ab0e,dateFrom:_0x21a24b,dateTo:_0x3ba353,search:_0x11f41c}=_0x121e6d,_0x411402=(_0x565cfe-0x1)*_0x406a4d,_0xceed36={};_0x30e46f&&(_0xceed36[_0x4e519a(0x15a)]=_0x30e46f);_0x22ab0e&&(_0xceed36[_0x4e519a(0x1b6)]=_0x22ab0e);(_0x21a24b||_0x3ba353)&&(_0xceed36['createdAt']={},_0x21a24b&&(_0xceed36['createdAt'][_0x4e519a(0x1c4)]=new Date(_0x21a24b)),_0x3ba353&&(_0xceed36[_0x4e519a(0xe7)][_0x4e519a(0xa8)]=new Date(_0x3ba353)));_0x11f41c&&(_0xceed36['OR']=[{'shop':{'name':{'contains':_0x11f41c,'mode':_0x4e519a(0x1b7)}}},{'shop':{'username':{'contains':_0x11f41c,'mode':_0x4e519a(0x1b7)}}},{'notes':{'contains':_0x11f41c,'mode':_0x4e519a(0x1b7)}}]);const [_0x265f19,_0x253e16]=await Promise[_0x4e519a(0x193)]([database_1[_0x4e519a(0x127)]['payout'][_0x4e519a(0x1e9)]({'where':_0xceed36,'skip':_0x411402,'take':_0x406a4d,'orderBy':{'createdAt':_0x4e519a(0x164)},'select':{'id':!![],'shopId':!![],'amount':!![],'network':!![],'status':!![],'txid':!![],'notes':!![],'periodFrom':!![],'periodTo':!![],'createdAt':!![],'paidAt':!![],'shop':{'select':{'name':!![],'username':!![]}}}}),database_1[_0x4e519a(0x127)][_0x4e519a(0x1da)][_0x4e519a(0x123)]({'where':_0xceed36})]);return{'payouts':_0x265f19['map'](_0x315216=>({'id':_0x315216['id'],'shopId':_0x315216[_0x4e519a(0x15a)],'shopName':_0x315216['shop'][_0x4e519a(0x131)],'shopUsername':_0x315216[_0x4e519a(0x19b)][_0x4e519a(0xec)],'amount':_0x315216[_0x4e519a(0x196)],'network':_0x315216[_0x4e519a(0x1b6)],'status':_0x315216[_0x4e519a(0x1dd)],'txid':_0x315216['txid'],'notes':_0x315216['notes'],'periodFrom':_0x315216[_0x4e519a(0x1ac)],'periodTo':_0x315216[_0x4e519a(0x1ad)],'createdAt':_0x315216[_0x4e519a(0xe7)],'paidAt':_0x315216['paidAt']})),'pagination':{'page':_0x565cfe,'limit':_0x406a4d,'total':_0x253e16,'totalPages':Math['ceil'](_0x253e16/_0x406a4d)}};}async[a35_0x5da564(0xd3)](_0x4567b3){const _0x3fe9d9=a35_0x5da564,_0x118fb2=await database_1[_0x3fe9d9(0x127)][_0x3fe9d9(0x1da)]['findUnique']({'where':{'id':_0x4567b3},'include':{'shop':{'select':{'name':!![],'username':!![]}}}});if(!_0x118fb2)return null;return{'id':_0x118fb2['id'],'shopId':_0x118fb2[_0x3fe9d9(0x15a)],'shopName':_0x118fb2[_0x3fe9d9(0x19b)][_0x3fe9d9(0x131)],'shopUsername':_0x118fb2[_0x3fe9d9(0x19b)]['username'],'amount':_0x118fb2[_0x3fe9d9(0x196)],'network':_0x118fb2[_0x3fe9d9(0x1b6)],'status':_0x118fb2[_0x3fe9d9(0x1dd)],'txid':_0x118fb2[_0x3fe9d9(0x126)],'notes':_0x118fb2[_0x3fe9d9(0x10d)],'periodFrom':_0x118fb2[_0x3fe9d9(0x1ac)],'periodTo':_0x118fb2['periodTo'],'createdAt':_0x118fb2['createdAt'],'paidAt':_0x118fb2['paidAt']};}async['deletePayout'](_0x3ba935){const _0x3c75ed=a35_0x5da564;await database_1['default'][_0x3c75ed(0x1da)][_0x3c75ed(0xb5)]({'where':{'id':_0x3ba935}});}async[a35_0x5da564(0x1c3)](_0x13290b){const _0xcc7010=a35_0x5da564,{page:_0x524cac,limit:_0x42c37e,status:_0x5409eb,gateway:_0x5bfc65,shopId:_0x2eb7e3,dateFrom:_0x96875e,dateTo:_0x3ec3b8,search:_0x5ffc6e,currency:_0x2a2d13,sortBy:_0x584017,sortOrder:_0x5442cd}=_0x13290b,_0x14cf41=(_0x524cac-0x1)*_0x42c37e;console[_0xcc7010(0x197)](_0xcc7010(0x19e),_0x13290b);const _0x3b73b1=await database_1[_0xcc7010(0x127)]['payment'][_0xcc7010(0x1d6)]({'by':[_0xcc7010(0xc2)],'_count':{'gateway':!![]}});console[_0xcc7010(0x197)]('📊\x20Available\x20gateways\x20in\x20database:',_0x3b73b1[_0xcc7010(0xe2)](_0x5dbfb4=>_0x5dbfb4['gateway']+'\x20('+_0x5dbfb4[_0xcc7010(0x103)][_0xcc7010(0xc2)]+_0xcc7010(0xbb)));if(_0x5bfc65){const _0x1b62b8=_0x3b73b1[_0xcc7010(0x1b0)](_0xcd9484=>_0xcd9484[_0xcc7010(0xc2)]['toLowerCase']()===_0x5bfc65[_0xcc7010(0x187)]());!_0x1b62b8&&_0x5bfc65[_0xcc7010(0x187)]()!==_0xcc7010(0xc5)&&console[_0xcc7010(0x197)](_0xcc7010(0x108)+_0x5bfc65+_0xcc7010(0xbc)+_0x3b73b1[_0xcc7010(0xe2)](_0x5b30c2=>_0x5b30c2[_0xcc7010(0xc2)])[_0xcc7010(0x163)](',\x20'));}const _0x21f301={};_0x5409eb&&(_0x21f301['status']=_0x5409eb[_0xcc7010(0x160)]());if(!_0x5bfc65)_0x21f301['gateway']={'not':'test_gateway'};else{if(_0x5bfc65&&(_0x5bfc65[_0xcc7010(0x187)]()===_0xcc7010(0xc5)||_0x5bfc65===_0xcc7010(0x100)))_0x21f301[_0xcc7010(0xc2)]=_0xcc7010(0xc5);else{let _0x13c648=_0x5bfc65;const _0x3cfc21=(0x0,gateway_1['getGatewayNameById'])(_0x5bfc65);if(_0x3cfc21)_0x13c648=_0x3cfc21,console[_0xcc7010(0x197)]('🔄\x20Converted\x20gateway\x20ID\x20\x27'+_0x5bfc65+'\x27\x20to\x20name\x20\x27'+_0x13c648+'\x27');else{const _0x3bb24f=(0x0,gateway_1[_0xcc7010(0x194)])(_0x5bfc65);if(_0x3bb24f){const _0x2c5e1d=(0x0,gateway_1[_0xcc7010(0xc0)])(_0x3bb24f);_0x2c5e1d&&(_0x13c648=_0x2c5e1d,console[_0xcc7010(0x197)](_0xcc7010(0xe1)+_0x5bfc65+_0xcc7010(0x136)+_0x3bb24f+_0xcc7010(0x175)+_0x13c648+'\x27'));}else console['log'](_0xcc7010(0xd0)+_0x5bfc65+'\x27\x20as\x20is\x20(not\x20found\x20in\x20mappings)');}const _0x252c3f=await database_1['default'][_0xcc7010(0x1e3)][_0xcc7010(0x123)]({'where':{'gateway':_0x13c648['toLowerCase']()},'take':0x1});_0x252c3f===0x0?(console['log'](_0xcc7010(0x15c)+_0x13c648+_0xcc7010(0x1e8)+_0x5bfc65+_0xcc7010(0x13b)),_0x21f301[_0xcc7010(0xc2)]=_0xcc7010(0x140)):(_0x21f301[_0xcc7010(0xc2)]=_0x13c648[_0xcc7010(0x187)](),console[_0xcc7010(0x197)]('✅\x20Using\x20gateway\x20filter:\x20\x27'+_0x13c648+'\x27\x20(from\x20\x27'+_0x5bfc65+'\x27)'));}}console[_0xcc7010(0x197)](_0xcc7010(0x16e),_0x21f301[_0xcc7010(0xc2)]);_0x2eb7e3&&(_0x21f301[_0xcc7010(0x15a)]=_0x2eb7e3);_0x2a2d13&&(_0x21f301[_0xcc7010(0xd7)]=_0x2a2d13[_0xcc7010(0x160)](),console[_0xcc7010(0x197)]('💱\x20Currency\x20filter\x20applied:\x20'+_0x2a2d13[_0xcc7010(0x160)]()));(_0x96875e||_0x3ec3b8)&&(_0x21f301[_0xcc7010(0xe7)]={},_0x96875e&&(_0x21f301[_0xcc7010(0xe7)][_0xcc7010(0x1c4)]=new Date(_0x96875e)),_0x3ec3b8&&(_0x21f301[_0xcc7010(0xe7)]['lte']=new Date(_0x3ec3b8)));_0x5ffc6e&&(_0x21f301['OR']=[{'id':{'contains':_0x5ffc6e,'mode':_0xcc7010(0x1b7)}},{'orderId':{'contains':_0x5ffc6e,'mode':_0xcc7010(0x1b7)}},{'gatewayOrderId':{'contains':_0x5ffc6e,'mode':_0xcc7010(0x1b7)}},{'customerEmail':{'contains':_0x5ffc6e,'mode':_0xcc7010(0x1b7)}},{'shop':{'name':{'contains':_0x5ffc6e,'mode':'insensitive'}}},{'shop':{'username':{'contains':_0x5ffc6e,'mode':_0xcc7010(0x1b7)}}}]);console[_0xcc7010(0x197)](_0xcc7010(0x12a),JSON[_0xcc7010(0xbd)](_0x21f301,null,0x2));let _0x3036e7={'createdAt':'desc'};if(_0x584017){const _0x2681be=['amount',_0xcc7010(0xe7),'updatedAt',_0xcc7010(0x1dd),'gateway','currency'],_0x4ee4d1=[_0xcc7010(0xd5),_0xcc7010(0x164)];if(_0x2681be[_0xcc7010(0x14b)](_0x584017)){const _0x115c66=_0x4ee4d1[_0xcc7010(0x14b)](_0x5442cd)?_0x5442cd:_0xcc7010(0x164);_0x3036e7={[_0x584017]:_0x115c66},console[_0xcc7010(0x197)](_0xcc7010(0x139)+_0x584017+_0xcc7010(0x169)+_0x115c66+_0xcc7010(0x10c));}}const [_0x37d36e,_0x180dd6]=await Promise[_0xcc7010(0x193)]([database_1[_0xcc7010(0x127)][_0xcc7010(0x1e3)][_0xcc7010(0x1e9)]({'where':_0x21f301,'skip':_0x14cf41,'take':_0x42c37e,'orderBy':_0x3036e7,'include':{'shop':{'select':{'name':!![],'username':!![]}}}}),database_1['default'][_0xcc7010(0x1e3)]['count']({'where':_0x21f301})]);return{'payments':_0x37d36e,'pagination':{'page':_0x524cac,'limit':_0x42c37e,'total':_0x180dd6,'totalPages':Math[_0xcc7010(0x119)](_0x180dd6/_0x42c37e)}};}async[a35_0x5da564(0xb1)](_0x395021){const _0x131cd1=a35_0x5da564,_0x2df8ba=await database_1[_0x131cd1(0x127)]['payment']['findUnique']({'where':{'id':_0x395021},'include':{'shop':{'select':{'name':!![],'username':!![]}}}});if(!_0x2df8ba)return null;return{'id':_0x2df8ba['id'],'shopId':_0x2df8ba[_0x131cd1(0x15a)],'gateway':_0x2df8ba[_0x131cd1(0xc2)],'amount':_0x2df8ba[_0x131cd1(0x196)],'currency':_0x2df8ba['currency'],'status':_0x2df8ba[_0x131cd1(0x1dd)],'orderId':_0x2df8ba[_0x131cd1(0x134)],'gatewayOrderId':_0x2df8ba[_0x131cd1(0xda)],'customerEmail':_0x2df8ba[_0x131cd1(0x110)],'customerName':_0x2df8ba[_0x131cd1(0xf1)],'customerCountry':_0x2df8ba[_0x131cd1(0x189)],'customerIp':_0x2df8ba[_0x131cd1(0x177)],'customerUa':_0x2df8ba[_0x131cd1(0x16f)],'failureMessage':_0x2df8ba['failureMessage'],'externalPaymentUrl':_0x2df8ba[_0x131cd1(0x118)],'successUrl':_0x2df8ba[_0x131cd1(0xae)],'failUrl':_0x2df8ba['failUrl'],'pendingUrl':_0x2df8ba[_0x131cd1(0x180)],'whiteUrl':_0x2df8ba[_0x131cd1(0x150)],'createdAt':_0x2df8ba[_0x131cd1(0xe7)],'updatedAt':_0x2df8ba[_0x131cd1(0x12d)],'shop':_0x2df8ba[_0x131cd1(0x19b)]};}async['updatePaymentStatus'](_0x42d4c6,_0x15e348,_0x3c5ad9,_0x231971){const _0x3e4598=a35_0x5da564,_0x5a7f8a=await database_1['default'][_0x3e4598(0x182)](async _0x2d6a4a=>{const _0x5b97d5=_0x3e4598,_0x407b5a=await _0x2d6a4a[_0x5b97d5(0x1e3)]['findUnique']({'where':{'id':_0x42d4c6},'include':{'shop':{'select':{'id':!![],'name':!![],'username':!![],'balance':!![]}}}});if(!_0x407b5a)throw new Error(_0x5b97d5(0x1cd));const _0x15e033=_0x407b5a[_0x5b97d5(0x1dd)],_0x383ab7=_0x15e348['toUpperCase']();console[_0x5b97d5(0x197)]('🔄\x20Admin\x20updating\x20payment\x20'+_0x42d4c6+_0x5b97d5(0x1a6)+_0x15e033+_0x5b97d5(0xf2)+_0x383ab7),console[_0x5b97d5(0x197)](_0x5b97d5(0x198)+_0x407b5a[_0x5b97d5(0x19b)][_0x5b97d5(0x181)]+_0x5b97d5(0xca));const _0x392ed7={'status':_0x383ab7,'updatedAt':new Date(),'statusChangedBy':_0x5b97d5(0xea),'statusChangedAt':new Date()};_0x3c5ad9&&(_0x392ed7[_0x5b97d5(0x148)]=_0x3c5ad9);_0x383ab7===_0x5b97d5(0x15e)&&_0x231971&&(_0x392ed7['chargebackAmount']=_0x231971);let _0xd88bf9=0x0,_0x368de3=_0x407b5a[_0x5b97d5(0x19b)][_0x5b97d5(0x181)];if(_0x383ab7===_0x5b97d5(0xc9)&&_0x15e033!==_0x5b97d5(0xc9)){_0x392ed7[_0x5b97d5(0x11f)]=new Date();const _0xa99eb8=await currencyService_1[_0x5b97d5(0x1a2)][_0x5b97d5(0x1dc)](_0x407b5a[_0x5b97d5(0x196)],_0x407b5a['currency']);_0x392ed7[_0x5b97d5(0x1af)]=_0xa99eb8;let _0x4cb606=0xa;const _0xd1309d=await _0x2d6a4a['shop'][_0x5b97d5(0x1a1)]({'where':{'id':_0x407b5a[_0x5b97d5(0x15a)]},'select':{'gatewaySettings':!![]}});if(_0xd1309d?.['gatewaySettings'])try{const _0x37a4f5=JSON['parse'](_0xd1309d[_0x5b97d5(0x137)]);for(const [_0x4d6b2a,_0x10b678]of Object['entries'](_0x37a4f5)){if(_0x4d6b2a[_0x5b97d5(0x187)]()===_0x407b5a[_0x5b97d5(0xc2)][_0x5b97d5(0x187)]()){_0x4cb606=_0x10b678[_0x5b97d5(0xcc)]||0xa;break;}}}catch(_0x342a20){console[_0x5b97d5(0xcb)](_0x5b97d5(0x186)+_0x42d4c6+':',_0x342a20);}let _0xc3f3b;_0x407b5a[_0x5b97d5(0x165)]!==null&&_0x407b5a[_0x5b97d5(0x165)]!==undefined?(_0xc3f3b=_0x407b5a[_0x5b97d5(0x165)],console[_0x5b97d5(0x197)](_0x5b97d5(0x114)+_0xc3f3b[_0x5b97d5(0x104)](0x6)+_0x5b97d5(0x113)+_0x42d4c6)):(_0xc3f3b=_0xa99eb8*(0x1-_0x4cb606/0x64),console[_0x5b97d5(0x197)](_0x5b97d5(0x1bf)+_0x42d4c6+':\x20'+_0x4cb606+_0x5b97d5(0x176)+_0xa99eb8[_0x5b97d5(0x104)](0x6)+'\x20USDT'),_0x392ed7[_0x5b97d5(0x165)]=_0xc3f3b),_0xd88bf9=_0xc3f3b,_0x368de3+=_0xc3f3b,console[_0x5b97d5(0x197)](_0x5b97d5(0xf3)+_0x42d4c6+_0x5b97d5(0x154)),console['log'](_0x5b97d5(0x1b2)+_0xa99eb8[_0x5b97d5(0x104)](0x6)+'\x20USDT'),console[_0x5b97d5(0x197)](_0x5b97d5(0x1d2)+_0x407b5a['gateway']+',\x20Commission:\x20'+_0x4cb606+'%'),console[_0x5b97d5(0x197)]('\x20\x20\x20Merchant\x20gets:\x20'+_0xc3f3b[_0x5b97d5(0x104)](0x6)+_0x5b97d5(0x1a4)+_0x4cb606+_0x5b97d5(0xd2)),console[_0x5b97d5(0x197)](_0x5b97d5(0x199)+_0xc3f3b[_0x5b97d5(0x104)](0x6)+_0x5b97d5(0xca));}else{if(_0x15e033===_0x5b97d5(0xc9)&&_0x383ab7!=='PAID'){if(_0x407b5a[_0x5b97d5(0x1af)]){let _0x177685=0xa;const _0x3b4456=await _0x2d6a4a[_0x5b97d5(0x19b)][_0x5b97d5(0x1a1)]({'where':{'id':_0x407b5a[_0x5b97d5(0x15a)]},'select':{'gatewaySettings':!![]}});if(_0x3b4456?.[_0x5b97d5(0x137)])try{const _0x46c135=JSON['parse'](_0x3b4456[_0x5b97d5(0x137)]);for(const [_0x33923a,_0x3a5cba]of Object['entries'](_0x46c135)){if(_0x33923a[_0x5b97d5(0x187)]()===_0x407b5a[_0x5b97d5(0xc2)][_0x5b97d5(0x187)]()){_0x177685=_0x3a5cba['commission']||0xa;break;}}}catch(_0xeddcfe){console['error'](_0x5b97d5(0x186)+_0x42d4c6+':',_0xeddcfe);}const _0x2cec13=_0x407b5a[_0x5b97d5(0x1af)]*(0x1-_0x177685/0x64);_0xd88bf9=-_0x2cec13,_0x368de3-=_0x2cec13,_0x392ed7[_0x5b97d5(0x1af)]=null,_0x392ed7[_0x5b97d5(0x165)]=null,console['log'](_0x5b97d5(0xf3)+_0x42d4c6+_0x5b97d5(0x19c)),console[_0x5b97d5(0x197)]('\x20\x20\x20Full\x20amount:\x20'+_0x407b5a['amountUSDT'][_0x5b97d5(0x104)](0x6)+_0x5b97d5(0xca)),console[_0x5b97d5(0x197)]('\x20\x20\x20Gateway:\x20'+_0x407b5a['gateway']+_0x5b97d5(0x116)+_0x177685+'%'),console[_0x5b97d5(0x197)](_0x5b97d5(0x14c)+_0x2cec13['toFixed'](0x6)+_0x5b97d5(0x1a4)+_0x177685+_0x5b97d5(0xd2)),console[_0x5b97d5(0x197)](_0x5b97d5(0x147)+_0x2cec13[_0x5b97d5(0x104)](0x6)+_0x5b97d5(0xca));}}}_0x383ab7==='CHARGEBACK'&&(_0x15e033===_0x5b97d5(0xc9)&&_0x407b5a[_0x5b97d5(0x1af)]&&console[_0x5b97d5(0x197)](_0x5b97d5(0xb8)),_0x231971&&_0x231971>0x0&&(_0xd88bf9-=_0x231971,_0x368de3-=_0x231971,console[_0x5b97d5(0x197)](_0x5b97d5(0x111)+_0x231971['toFixed'](0x6)+'\x20USDT\x20from\x20balance')));_0x383ab7==='REFUND'&&_0x15e033===_0x5b97d5(0xc9)&&console['log']('🔄\x20REFUND:\x20Payment\x20amount\x20already\x20deducted\x20from\x20balance');const _0x4cfc19=await _0x2d6a4a[_0x5b97d5(0x1e3)][_0x5b97d5(0xb4)]({'where':{'id':_0x42d4c6},'data':_0x392ed7,'include':{'shop':{'select':{'name':!![],'username':!![]}}}});return _0xd88bf9!==0x0&&(await _0x2d6a4a[_0x5b97d5(0x19b)][_0x5b97d5(0xb4)]({'where':{'id':_0x407b5a[_0x5b97d5(0x15a)]},'data':{'balance':_0x368de3}}),console[_0x5b97d5(0x197)](_0x5b97d5(0x1be)+_0x407b5a['shopId']+_0x5b97d5(0x1a0)+_0x407b5a[_0x5b97d5(0x19b)][_0x5b97d5(0x181)][_0x5b97d5(0x104)](0x6)+_0x5b97d5(0xf2)+_0x368de3[_0x5b97d5(0x104)](0x6)+'\x20USDT\x20('+(_0xd88bf9>0x0?'+':'')+_0xd88bf9['toFixed'](0x6)+')')),_0x4cfc19;});return{'id':_0x5a7f8a['id'],'shopId':_0x5a7f8a[_0x3e4598(0x15a)],'gateway':_0x5a7f8a[_0x3e4598(0xc2)],'amount':_0x5a7f8a[_0x3e4598(0x196)],'currency':_0x5a7f8a[_0x3e4598(0xd7)],'status':_0x5a7f8a[_0x3e4598(0x1dd)],'orderId':_0x5a7f8a[_0x3e4598(0x134)],'gatewayOrderId':_0x5a7f8a['gatewayOrderId'],'customerEmail':_0x5a7f8a[_0x3e4598(0x110)],'customerName':_0x5a7f8a['customerName'],'customerCountry':_0x5a7f8a[_0x3e4598(0x189)],'customerIp':_0x5a7f8a[_0x3e4598(0x177)],'customerUa':_0x5a7f8a[_0x3e4598(0x16f)],'failureMessage':_0x5a7f8a[_0x3e4598(0x13c)],'adminNotes':_0x5a7f8a[_0x3e4598(0x148)],'chargebackAmount':_0x5a7f8a[_0x3e4598(0x173)],'statusChangedBy':_0x5a7f8a[_0x3e4598(0x1b1)],'statusChangedAt':_0x5a7f8a[_0x3e4598(0x16c)],'createdAt':_0x5a7f8a['createdAt'],'updatedAt':_0x5a7f8a[_0x3e4598(0x12d)],'shop':_0x5a7f8a['shop']};}async['updateUser'](_0xc71a9f,_0x35d7cf){const _0x3ee93b=a35_0x5da564,_0x5c3b57=Math[_0x3ee93b(0xf5)]()[_0x3ee93b(0xb9)](0x24)[_0x3ee93b(0x188)](0x2,0x9);console['log']('🎯\x20updateUser\x20called\x20with\x20ID:\x20'+_0x5c3b57+_0x3ee93b(0x11d)+_0xc71a9f);const _0x40253b={..._0x35d7cf};_0x35d7cf[_0x3ee93b(0x1a3)]&&_0x35d7cf[_0x3ee93b(0x1a3)][_0x3ee93b(0x1c9)]()!==''?(console[_0x3ee93b(0x197)]('🔐\x20['+_0x5c3b57+']\x20Updating\x20password\x20for\x20user\x20'+_0xc71a9f),_0x40253b[_0x3ee93b(0x1a3)]=await bcryptjs_1[_0x3ee93b(0x127)]['hash'](_0x35d7cf['password'],0xc)):(console[_0x3ee93b(0x197)](_0x3ee93b(0x185)+_0x5c3b57+']\x20Password\x20not\x20provided\x20or\x20empty,\x20skipping\x20password\x20update'),delete _0x40253b[_0x3ee93b(0x1a3)]);_0x35d7cf[_0x3ee93b(0x192)]&&(_0x40253b[_0x3ee93b(0x131)]=_0x35d7cf['fullName'],delete _0x40253b[_0x3ee93b(0x192)]);_0x35d7cf[_0x3ee93b(0x1d5)]&&(_0x40253b[_0x3ee93b(0x1e6)]=_0x35d7cf[_0x3ee93b(0x1d5)],delete _0x40253b[_0x3ee93b(0x1d5)]);_0x35d7cf[_0x3ee93b(0x14a)]&&(_0x40253b[_0x3ee93b(0x11c)]=_0x35d7cf['merchantUrl'],delete _0x40253b[_0x3ee93b(0x14a)]);if(_0x35d7cf[_0x3ee93b(0x1a7)]){const _0x3fb20b=_0x35d7cf[_0x3ee93b(0x1a7)][_0x3ee93b(0xe2)](_0xf8f953=>this[_0x3ee93b(0x15d)](_0xf8f953));console['log'](_0x3ee93b(0x1ae),_0x35d7cf[_0x3ee93b(0x1a7)],'->',_0x3fb20b),_0x40253b[_0x3ee93b(0x106)]=JSON[_0x3ee93b(0xbd)](_0x3fb20b),delete _0x40253b[_0x3ee93b(0x1a7)];}_0x35d7cf[_0x3ee93b(0x137)]&&(console['log'](_0x3ee93b(0x18e)+_0x5c3b57+_0x3ee93b(0x1d1),_0x35d7cf[_0x3ee93b(0x137)]),_0x40253b[_0x3ee93b(0x137)]=JSON[_0x3ee93b(0xbd)](_0x35d7cf[_0x3ee93b(0x137)]),console[_0x3ee93b(0x197)]('🔧\x20['+_0x5c3b57+_0x3ee93b(0x1c5),_0x40253b[_0x3ee93b(0x137)]));_0x35d7cf[_0x3ee93b(0x120)]&&(_0x35d7cf['wallets'][_0x3ee93b(0x17f)]!==undefined&&(_0x40253b['usdtPolygonWallet']=_0x35d7cf[_0x3ee93b(0x120)]['usdtPolygonWallet']||null),_0x35d7cf[_0x3ee93b(0x120)][_0x3ee93b(0xcf)]!==undefined&&(_0x40253b['usdtTrcWallet']=_0x35d7cf[_0x3ee93b(0x120)][_0x3ee93b(0xcf)]||null),_0x35d7cf[_0x3ee93b(0x120)][_0x3ee93b(0xf4)]!==undefined&&(_0x40253b[_0x3ee93b(0xf4)]=_0x35d7cf[_0x3ee93b(0x120)]['usdtErcWallet']||null),_0x35d7cf[_0x3ee93b(0x120)][_0x3ee93b(0x1a5)]!==undefined&&(_0x40253b[_0x3ee93b(0x1a5)]=_0x35d7cf[_0x3ee93b(0x120)][_0x3ee93b(0x1a5)]||null),delete _0x40253b['wallets']);const _0x5d559e=await database_1[_0x3ee93b(0x127)][_0x3ee93b(0x19b)]['update']({'where':{'id':_0xc71a9f},'data':_0x40253b,'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});return console[_0x3ee93b(0x197)]('🎯\x20['+_0x5c3b57+_0x3ee93b(0x141),_0x5d559e[_0x3ee93b(0x137)]),{'id':_0x5d559e['id'],'fullName':_0x5d559e[_0x3ee93b(0x131)],'username':_0x5d559e[_0x3ee93b(0xec)],'telegramId':_0x5d559e['telegram'],'merchantUrl':_0x5d559e[_0x3ee93b(0x11c)],'gateways':_0x5d559e[_0x3ee93b(0x106)]?JSON[_0x3ee93b(0x191)](_0x5d559e[_0x3ee93b(0x106)]):null,'gatewaySettings':_0x5d559e[_0x3ee93b(0x137)]?JSON[_0x3ee93b(0x191)](_0x5d559e[_0x3ee93b(0x137)]):null,'publicKey':_0x5d559e[_0x3ee93b(0x19a)],'wallets':{'usdtPolygonWallet':_0x5d559e[_0x3ee93b(0x17f)],'usdtTrcWallet':_0x5d559e[_0x3ee93b(0xcf)],'usdtErcWallet':_0x5d559e['usdtErcWallet'],'usdcPolygonWallet':_0x5d559e[_0x3ee93b(0x1a5)]},'status':_0x5d559e[_0x3ee93b(0x1dd)],'createdAt':_0x5d559e[_0x3ee93b(0xe7)]};}async['suspendUser'](_0x6d2bba){const _0x5aa935=a35_0x5da564,_0x58f26c=await database_1['default'][_0x5aa935(0x19b)][_0x5aa935(0xb4)]({'where':{'id':_0x6d2bba},'data':{'status':_0x5aa935(0x149)},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});return{'id':_0x58f26c['id'],'fullName':_0x58f26c[_0x5aa935(0x131)],'username':_0x58f26c[_0x5aa935(0xec)],'telegramId':_0x58f26c[_0x5aa935(0x1e6)],'merchantUrl':_0x58f26c[_0x5aa935(0x11c)],'gateways':_0x58f26c[_0x5aa935(0x106)]?JSON[_0x5aa935(0x191)](_0x58f26c[_0x5aa935(0x106)]):null,'gatewaySettings':_0x58f26c[_0x5aa935(0x137)]?JSON[_0x5aa935(0x191)](_0x58f26c[_0x5aa935(0x137)]):null,'publicKey':_0x58f26c[_0x5aa935(0x19a)],'wallets':{'usdtPolygonWallet':_0x58f26c['usdtPolygonWallet'],'usdtTrcWallet':_0x58f26c[_0x5aa935(0xcf)],'usdtErcWallet':_0x58f26c['usdtErcWallet'],'usdcPolygonWallet':_0x58f26c[_0x5aa935(0x1a5)]},'status':_0x58f26c[_0x5aa935(0x1dd)],'createdAt':_0x58f26c[_0x5aa935(0xe7)]};}async[a35_0x5da564(0xbf)](_0x4fb0e4){const _0x41eab4=a35_0x5da564,_0x466be6=await database_1[_0x41eab4(0x127)][_0x41eab4(0x19b)][_0x41eab4(0xb4)]({'where':{'id':_0x4fb0e4},'data':{'status':_0x41eab4(0x10f)},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});return{'id':_0x466be6['id'],'fullName':_0x466be6[_0x41eab4(0x131)],'username':_0x466be6['username'],'telegramId':_0x466be6[_0x41eab4(0x1e6)],'merchantUrl':_0x466be6[_0x41eab4(0x11c)],'gateways':_0x466be6[_0x41eab4(0x106)]?JSON[_0x41eab4(0x191)](_0x466be6['paymentGateways']):null,'gatewaySettings':_0x466be6[_0x41eab4(0x137)]?JSON[_0x41eab4(0x191)](_0x466be6[_0x41eab4(0x137)]):null,'publicKey':_0x466be6[_0x41eab4(0x19a)],'wallets':{'usdtPolygonWallet':_0x466be6[_0x41eab4(0x17f)],'usdtTrcWallet':_0x466be6[_0x41eab4(0xcf)],'usdtErcWallet':_0x466be6['usdtErcWallet'],'usdcPolygonWallet':_0x466be6[_0x41eab4(0x1a5)]},'status':_0x466be6[_0x41eab4(0x1dd)],'createdAt':_0x466be6['createdAt']};}async['getAllUsers'](_0xadea65){const _0x170c07=a35_0x5da564,{page:_0x394648,limit:_0x5883a3,status:_0x4ad7eb}=_0xadea65,_0xd6f872=(_0x394648-0x1)*_0x5883a3,_0x342878={};_0x4ad7eb&&(_0x342878['status']=_0x4ad7eb[_0x170c07(0x160)]());const [_0x1f8acb,_0x3e7193]=await Promise[_0x170c07(0x193)]([database_1[_0x170c07(0x127)]['shop'][_0x170c07(0x1e9)]({'where':_0x342878,'skip':_0xd6f872,'take':_0x5883a3,'orderBy':{'createdAt':'desc'},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}}),database_1[_0x170c07(0x127)]['shop'][_0x170c07(0x123)]({'where':_0x342878})]);return{'users':_0x1f8acb['map'](_0x1285f3=>{const _0x4188a6=_0x170c07,_0x49f925=_0x1285f3[_0x4188a6(0x106)]?JSON[_0x4188a6(0x191)](_0x1285f3[_0x4188a6(0x106)]):null,_0x5ad053=_0x49f925?_0x49f925[_0x4188a6(0xe2)](_0x2d710e=>this[_0x4188a6(0x14d)](_0x2d710e)):null;return{'id':_0x1285f3['id'],'fullName':_0x1285f3[_0x4188a6(0x131)],'username':_0x1285f3[_0x4188a6(0xec)],'telegramId':_0x1285f3[_0x4188a6(0x1e6)],'merchantUrl':_0x1285f3['shopUrl'],'gateways':_0x5ad053,'gatewaySettings':_0x1285f3[_0x4188a6(0x137)]?JSON[_0x4188a6(0x191)](_0x1285f3[_0x4188a6(0x137)]):null,'publicKey':_0x1285f3['publicKey'],'wallets':{'usdtPolygonWallet':_0x1285f3[_0x4188a6(0x17f)],'usdtTrcWallet':_0x1285f3[_0x4188a6(0xcf)],'usdtErcWallet':_0x1285f3['usdtErcWallet'],'usdcPolygonWallet':_0x1285f3[_0x4188a6(0x1a5)]},'status':_0x1285f3['status'],'createdAt':_0x1285f3[_0x4188a6(0xe7)]};}),'pagination':{'page':_0x394648,'limit':_0x5883a3,'total':_0x3e7193,'totalPages':Math[_0x170c07(0x119)](_0x3e7193/_0x5883a3)}};}async[a35_0x5da564(0x135)](_0x240fde){const _0x46de10=a35_0x5da564,_0x536b73=await database_1['default'][_0x46de10(0x19b)][_0x46de10(0x1a1)]({'where':{'id':_0x240fde},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});if(!_0x536b73)return null;const _0x5983b0=_0x536b73[_0x46de10(0x106)]?JSON['parse'](_0x536b73[_0x46de10(0x106)]):null,_0x3d22e8=_0x5983b0?_0x5983b0[_0x46de10(0xe2)](_0x226325=>this[_0x46de10(0x14d)](_0x226325)):null;return _0x5983b0&&_0x3d22e8&&console[_0x46de10(0x197)](_0x46de10(0x1e1),_0x5983b0,'->',_0x3d22e8),{'id':_0x536b73['id'],'fullName':_0x536b73[_0x46de10(0x131)],'username':_0x536b73[_0x46de10(0xec)],'telegramId':_0x536b73[_0x46de10(0x1e6)],'merchantUrl':_0x536b73[_0x46de10(0x11c)],'gateways':_0x3d22e8,'gatewaySettings':_0x536b73[_0x46de10(0x137)]?JSON[_0x46de10(0x191)](_0x536b73['gatewaySettings']):null,'publicKey':_0x536b73[_0x46de10(0x19a)],'wallets':{'usdtPolygonWallet':_0x536b73[_0x46de10(0x17f)],'usdtTrcWallet':_0x536b73[_0x46de10(0xcf)],'usdtErcWallet':_0x536b73[_0x46de10(0xf4)],'usdcPolygonWallet':_0x536b73[_0x46de10(0x1a5)]},'status':_0x536b73[_0x46de10(0x1dd)],'createdAt':_0x536b73['createdAt']};}async[a35_0x5da564(0x161)](_0x54182f){const _0x15e1e9=a35_0x5da564,{fullName:_0x3656b4,username:_0x54d3ee,password:_0x2281c7,telegramId:_0x490a9f,merchantUrl:_0x49d907,gateways:_0x2f2184,gatewaySettings:_0xed96f9,wallets:_0x299db1}=_0x54182f,_0x5da5b6=await database_1['default'][_0x15e1e9(0x19b)][_0x15e1e9(0x1a1)]({'where':{'username':_0x54d3ee}});if(_0x5da5b6)throw new Error(_0x15e1e9(0x13a));if(_0x490a9f){const _0x13a690=await database_1[_0x15e1e9(0x127)][_0x15e1e9(0x19b)][_0x15e1e9(0x1a1)]({'where':{'telegram':_0x490a9f}});if(_0x13a690)throw new Error('Telegram\x20username\x20already\x20exists');}const _0x568351=await bcryptjs_1[_0x15e1e9(0x127)][_0x15e1e9(0xd4)](_0x2281c7,0xc),_0x49ec75=_0x15e1e9(0xe0)+crypto_1[_0x15e1e9(0x127)]['randomBytes'](0x20)[_0x15e1e9(0xb9)](_0x15e1e9(0x1db)),_0x31c73c=_0x15e1e9(0x1cb)+crypto_1[_0x15e1e9(0x127)][_0x15e1e9(0x1bb)](0x20)[_0x15e1e9(0xb9)](_0x15e1e9(0x1db)),_0x4dfb2e=_0x2f2184?_0x2f2184[_0x15e1e9(0xe2)](_0x1aeba9=>this[_0x15e1e9(0x15d)](_0x1aeba9)):null;_0x2f2184&&_0x4dfb2e&&console['log'](_0x15e1e9(0x138),_0x2f2184,'->',_0x4dfb2e);const _0x9f46aa=await database_1[_0x15e1e9(0x127)][_0x15e1e9(0x19b)]['create']({'data':{'name':_0x3656b4,'username':_0x54d3ee,'password':_0x568351,'telegram':_0x490a9f,'shopUrl':_0x49d907,'paymentGateways':_0x4dfb2e?JSON[_0x15e1e9(0xbd)](_0x4dfb2e):null,'gatewaySettings':_0xed96f9?JSON[_0x15e1e9(0xbd)](_0xed96f9):null,'usdtPolygonWallet':_0x299db1?.[_0x15e1e9(0x17f)]||null,'usdtTrcWallet':_0x299db1?.[_0x15e1e9(0xcf)]||null,'usdtErcWallet':_0x299db1?.['usdtErcWallet']||null,'usdcPolygonWallet':_0x299db1?.[_0x15e1e9(0x1a5)]||null,'publicKey':_0x49ec75,'secretKey':_0x31c73c,'status':_0x15e1e9(0x10f)},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});return{'id':_0x9f46aa['id'],'fullName':_0x9f46aa[_0x15e1e9(0x131)],'username':_0x9f46aa['username'],'telegramId':_0x9f46aa[_0x15e1e9(0x1e6)],'merchantUrl':_0x9f46aa[_0x15e1e9(0x11c)],'gateways':_0x9f46aa[_0x15e1e9(0x106)]?JSON[_0x15e1e9(0x191)](_0x9f46aa[_0x15e1e9(0x106)]):null,'gatewaySettings':_0x9f46aa['gatewaySettings']?JSON['parse'](_0x9f46aa[_0x15e1e9(0x137)]):null,'publicKey':_0x9f46aa[_0x15e1e9(0x19a)],'wallets':{'usdtPolygonWallet':_0x9f46aa[_0x15e1e9(0x17f)],'usdtTrcWallet':_0x9f46aa['usdtTrcWallet'],'usdtErcWallet':_0x9f46aa[_0x15e1e9(0xf4)],'usdcPolygonWallet':_0x9f46aa[_0x15e1e9(0x1a5)]},'status':_0x9f46aa['status'],'createdAt':_0x9f46aa[_0x15e1e9(0xe7)]};}async[a35_0x5da564(0x171)](_0x6c1169){const _0x1bb13a=a35_0x5da564;await database_1[_0x1bb13a(0x127)][_0x1bb13a(0x19b)]['delete']({'where':{'id':_0x6c1169}});}[a35_0x5da564(0x1b9)](_0x52d2f8,_0x35c5c2,_0x3c9e55){const _0xa0eceb=a35_0x5da564,_0x43a8d4=new Map(),_0x54a71d=new Date(_0x35c5c2);while(_0x54a71d<=_0x3c9e55){const _0x5cd599=_0x54a71d[_0xa0eceb(0x115)]()['split']('T')[0x0];_0x43a8d4[_0xa0eceb(0xd9)](_0x5cd599,{'revenue':0x0,'count':0x0}),_0x54a71d[_0xa0eceb(0x13d)](_0x54a71d['getDate']()+0x1);}for(const _0x415a9d of _0x52d2f8){const _0x3a64bc=_0x415a9d['createdAt'][_0xa0eceb(0x115)]()[_0xa0eceb(0x19d)]('T')[0x0],_0x31a3e2=_0x43a8d4[_0xa0eceb(0x12e)](_0x3a64bc);_0x31a3e2&&(_0x31a3e2[_0xa0eceb(0x123)]+=0x1,_0x415a9d['status']==='PAID'&&(_0x415a9d[_0xa0eceb(0x1af)]?_0x31a3e2[_0xa0eceb(0x157)]+=_0x415a9d['amountUSDT']:console[_0xa0eceb(0x197)](_0xa0eceb(0xd1)+_0x415a9d['id']+_0xa0eceb(0x174))));}const _0x7c9a44=[],_0xe17d80=[];for(const [_0x58eced,_0x7c3620]of _0x43a8d4){_0x7c9a44['push']({'date':_0x58eced,'amount':Math[_0xa0eceb(0xe6)](_0x7c3620['revenue']*0x64)/0x64}),_0xe17d80[_0xa0eceb(0x159)]({'date':_0x58eced,'count':_0x7c3620[_0xa0eceb(0x123)]});}return{'dailyRevenue':_0x7c9a44,'dailyPayments':_0xe17d80};}}exports[a35_0x5da564(0xe4)]=AdminService;