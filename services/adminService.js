'use strict';function a35_0x4d5b(){const _0x38a9fd=['round','usdtErcWallet','parse','customerCountry','Username\x20already\x20exists','getTime','üìÖ\x20Period\x20\x27all\x27:\x20Using\x20start\x20date\x20from\x20first\x20payment:\x20','thisMonth','\x20USDT\x20(gross\x20revenue)','date','notes','amount','cointopay2','averageCommissionRate','\x20status:\x20','\x20\x20\x20üí∞\x20Total\x20payments\x20turnover:\x20','lte','updatedAt','\x20USDT\x20(total\x20paid\x20to\x20merchants)','\x20USDT\x20(','customerIp','Insufficient\x20balance.\x20Available:\x20','network','\x20\x20\x20ÔøΩ\x20Total\x20paid\x20out:\x20','\x20\x20\x20üè™\x20Gateway\x20earnings:\x20','gateways','toFixed','usdtPolygonWallet','üîÑ\x20Converted\x20gateway\x20ID\x20\x27','shopUrl','orderId','gatewayEarnings','usdtTrcWallet','PAID','aggregate','year','getMerchantsSelection','\x20USDT\x20(after\x20payouts)','telegram','shop','üìã\x20Found\x20','gateway','merchantEarningsUSDT','üîß\x20[','plisio','\x20USDT\x20(after\x20','\x20became\x20PAID:','entries','üìä\x20Available\x20gateways\x20in\x20database:','KLYME\x20EU','\x20PAID\x20payments','whiteUrl','createUser','trim','custom','getGatewayNameById','üìä\x20Calculating\x20commission\x20for\x20legacy\x20payment\x20','\x20\x20\x20üë§\x20Merchant\x20earnings:\x20','üí∞\x20[PAYOUT]\x20Gateway\x20','32860184IqEXtW','failureMessage','\x20\x20\x20üí∏\x20Total\x20payouts\x20(all\x20time):\x20','üéØ\x20updateUser\x20called\x20with\x20ID:\x20','\x20\x20\x20ÔøΩüìä\x20Total\x20payments:\x20','üí±\x20Currency\x20filter\x20applied:\x20','‚ö†Ô∏è\x20Payment\x20','\x20merchants\x20with\x20positive\x20balance','createPayout','__importDefault','updatePaymentStatus','üìÖ\x20Period:\x20','count','1608810EkcorC','polygon_usdc','‚ö†Ô∏è\x20Requested\x20gateway\x20\x27','\x20USDT\x20(+','set','_sum','rapyd','getMerchantsAwaitingPayout','Error\x20parsing\x20gateway\x20settings\x20for\x20payment\x20','getDay','status','get',',\x20Commission:\x20','hash','üîÑ\x20Converted\x20gateway\x20name\x20\x27','shopId','\x20\x20\x20‚úÖ\x20Actual\x20available\x20balance:\x20','split','reduce','getAllPayments','9XXuOLL','\x20USDT','CoinToPay','üìã\x20Getting\x20merchants\x20selection\x20list...','\x20USDT\x20(with\x20commission\x20deducted)','groupBy','\x20\x20\x20üìÖ\x20Total\x20payouts\x20(this\x20month):\x20','\x20\x20\x20Full\x20amount:\x20','delete','periodTo','MasterCard',']\x20Password\x20not\x20provided\x20or\x20empty,\x20skipping\x20password\x20update','toString','telegramId','values','noda','üìä\x20[ADMIN]\x20Using\x20saved\x20amountAfterGatewayCommissionUSDT:\x20','\x20USDT)','amountUSDT','substr','6996024TEAYyM','getFullYear','ceil','erc20','balance','üí∏\x20CHARGEBACK:\x20Merchant\x20amount\x20already\x20deducted\x20from\x20balance','convertToUSDT','\x20\x20\x20Subtracted\x20from\x20balance:\x20-','3133848NQHftU','Payment\x20not\x20found','../types/gateway','KLYME\x20GB','updateCustomerData','klyme_de','hex','adminNotes','findFirst',':\x20commission\x20=\x20','Rapyd','polygon','getGatewayDisplayName','payment','chargebackAmount','summary','customerUa','dateFrom','randomBytes','üìä\x20Sorting\x20payments\x20by\x20','\x20\x20\x20‚è≥\x20Pending\x20payout:\x20','periodFrom','90d','üí∞\x20Payment\x20','\x20USDT\x20(without\x20commission)','COMPLETED','\x20USDT\x20(-','customerEmail','üí∏\x20CHARGEBACK\x20penalty:\x20-','activateUser','üí∞\x20Found\x20','gatewayOrderId','usdcPolygonWallet','\x27\x20to\x20name\x20\x27','payout','%\x20commission)','mastercard','findMany','\x20\x20\x20Current\x20total\x20paid\x20out:\x20','\x20\x20\x20Merchant\x20loses:\x20','4RXrEdj','8765820IRJjqH','map',']\x20Gateway\x20settings\x20before\x20saving:','\x20\x20\x20‚úÖ\x20Total\x20available\x20for\x20payout:\x20','1900437YDIuYZ','bcryptjs','üîÑ\x20Gateway\x20mapping\x20(create):','error','getGatewayInternalName','\x20\x20\x20üñ•Ô∏è\x20User\x20Agent:\x20','üîÑ\x20Gateway\x20mapping\x20(get):',',\x20userId:\x20','turnover','not\x20set','\x20\x20\x20Total\x20paid\x20out:\x20','CHARGEBACK','pendingUrl','paymentGateways','default','averageCheckUSDT','üìä\x20Total\x20payments\x20(including\x20failed):\x20','trc20','üéØ\x20[','\x20payments)','dateTo','2020-01-01','\x27\x20as\x20is\x20(not\x20found\x20in\x20mappings)','commissionUSDT','month','üìä\x20Getting\x20merchants\x20awaiting\x20payout\x20with\x20filters:','getMonth','_count','deleteUser','\x27)\x20not\x20found\x20in\x20database,\x20returning\x20empty\x20result','KLYME\x20DE','statusChangedBy','merchantUrl','totalAmountAfterCommissionUSDT','\x20\x20\x20‚è≥\x20Awaiting\x20payout:\x20','includes','\x20no\x20longer\x20PAID:','SUSPENDED','createdAt','week','all','random','\x20\x20\x20Gateway:\x20','externalPaymentUrl','log','\x20active\x20merchants\x20for\x20selection','turnoverUSDT','getUserById','Shop\x20not\x20found','getAllUsers','test_gateway','\x27\x20(from\x20\x27','desc','totalPayout','asc','amountAfterCommissionUSDT','\x20USDT,\x20Requested:\x20','üìä\x20Gateway\x20filter\x20applied:','failUrl','\x20for\x20shop\x20','Error\x20processing\x20payment\x20','wallets','password','Telegram\x20username\x20already\x20exists','\x20\x20\x20üåê\x20IP:\x20','\x27\x20->\x20name\x20\x27','update','\x20USDT\x20for\x20payment\x20','dailyPayments','sk_','üìä\x20Merchants\x20awaiting\x20payout:\x20','gatewaySettings','üîÑ\x20REFUND:\x20Payment\x20amount\x20already\x20deducted\x20from\x20balance','updateUser',']\x20User\x20updated,\x20gatewaySettings\x20from\x20DB:','305486sboFwz','generateDailyStatistics','klyme_eu','name','push','defineProperty','fullName','paidOutUSDT','üí∞\x20Shop\x20','üìä\x20Merchant\x20statistics\x20calculated:','currencyService','\x20\x20\x20üíµ\x20Available\x20balance:\x20','üìä\x20Calculating\x20payout\x20statistics...','username','\x20->\x20','\x20balance\x20updated:','currency','‚úÖ\x20Payout\x20created:\x20','awaitingPayout','%\x20from\x20','../config/database','getSystemStatistics','NONEXISTENT_GATEWAY_FILTER','\x20\x20\x20üìÖ\x20This\x20month:\x20',']\x20Updating\x20password\x20for\x20user\x20','‚úÖ\x20Using\x20gateway\x20filter:\x20\x27','\x20merchants','\x20\x20\x20Current\x20balance:\x20','\x20\x20\x20üîç\x20Raw\x20balance\x20sum:\x20','Open\x20Banking\x202','insensitive','üìä\x20Getting\x20payments\x20with\x20filters:','Plisio','pk_','ACTIVE','PENDING','length','\x20\x20\x20Merchant\x20gets:\x20','successUrl','getPayoutById','toUpperCase','\x20\x20\x20ÔøΩ\x20Total\x20payments\x20turnover:\x20','setDate','merchantEarnings','cointopay','paymentsCount','‚ö†Ô∏è\x20Gateway\x20\x27','amountAfterGatewayCommissionUSDT','üîÑ\x20Updating\x20customer\x20data\x20for\x20payment\x20','__esModule','Error\x20parsing\x20gateway\x20settings\x20for\x20shop\x20','REFUND','gte','customerName','crypto','toISOString','\x20\x20\x20Added\x20to\x20balance:\x20+','\x20\x20\x20üîç\x20Calculated\x20after\x20commission:\x20','totalPaidOut','\x20\x20\x20Transaction\x20hash:\x20','paidAt','publicKey','dailyRevenue','create','findUnique','$transaction','üí∞\x20Current\x20shop\x20balance:\x20','üîê\x20[','stringify','join','klyme_gb','txid','\x20USDT\x20(actual\x20balances)','\x20\x20\x20üí≥\x20Total\x20payments:\x20','period','üîÑ\x20Admin\x20updating\x20payment\x20','commission','üìä\x20Final\x20WHERE\x20conditions:','\x20USDT\x20from\x20balance','\x27\x20not\x20found.\x20Available\x20gateways:\x20','toLowerCase'];a35_0x4d5b=function(){return _0x38a9fd;};return a35_0x4d5b();}const a35_0x8c2769=a35_0x24a8;(function(_0x991f81,_0x33a21f){const _0x53569d=a35_0x24a8,_0x2e6910=_0x991f81();while(!![]){try{const _0x2780fb=-parseInt(_0x53569d(0x1d9))/0x1*(parseInt(_0x53569d(0x2ca))/0x2)+parseInt(_0x53569d(0x2cf))/0x3+-parseInt(_0x53569d(0x29a))/0x4+parseInt(_0x53569d(0x272))/0x5+-parseInt(_0x53569d(0x2a2))/0x6+-parseInt(_0x53569d(0x2cb))/0x7+-parseInt(_0x53569d(0x265))/0x8*(-parseInt(_0x53569d(0x286))/0x9);if(_0x2780fb===_0x33a21f)break;else _0x2e6910['push'](_0x2e6910['shift']());}catch(_0x1020f0){_0x2e6910['push'](_0x2e6910['shift']());}}}(a35_0x4d5b,0xe29da));function a35_0x24a8(_0x4abba0,_0x10cec2){const _0x4d5b9c=a35_0x4d5b();return a35_0x24a8=function(_0x24a8ef,_0x2b4b4a){_0x24a8ef=_0x24a8ef-0x1ad;let _0x2eb6ef=_0x4d5b9c[_0x24a8ef];return _0x2eb6ef;},a35_0x24a8(_0x4abba0,_0x10cec2);}var __importDefault=this&&this[a35_0x8c2769(0x26e)]||function(_0x5152c4){const _0x211a70=a35_0x8c2769;return _0x5152c4&&_0x5152c4[_0x211a70(0x20a)]?_0x5152c4:{'default':_0x5152c4};};Object[a35_0x8c2769(0x1de)](exports,a35_0x8c2769(0x20a),{'value':!![]}),exports['AdminService']=void 0x0;const database_1=__importDefault(require(a35_0x8c2769(0x1ed))),bcryptjs_1=__importDefault(require(a35_0x8c2769(0x2d0))),crypto_1=__importDefault(require(a35_0x8c2769(0x20f))),currencyService_1=require('./currencyService'),gateway_1=require(a35_0x8c2769(0x2a4));class AdminService{async['getPayoutStats'](){const _0xdf25c8=a35_0x8c2769;console[_0xdf25c8(0x1ba)](_0xdf25c8(0x1e5));const _0x598552=await database_1[_0xdf25c8(0x2dd)]['shop'][_0xdf25c8(0x24c)]({'_sum':{'balance':!![],'totalPaidOut':!![]},'where':{'status':_0xdf25c8(0x1fb)}}),_0x1b2c7c=await this[_0xdf25c8(0x279)]({'page':0x1,'limit':0x3e8}),_0x53c2ef=await database_1[_0xdf25c8(0x2dd)][_0xdf25c8(0x2af)]['count']({'where':{'status':'PAID','gateway':{'not':_0xdf25c8(0x1c0)}}}),_0x1c3557=new Date(),_0x186cbd=new Date(_0x1c3557[_0xdf25c8(0x29b)](),_0x1c3557[_0xdf25c8(0x2e9)](),0x1),_0x3ee5c2=new Date(_0x1c3557[_0xdf25c8(0x29b)](),_0x1c3557['getMonth']()+0x1,0x0,0x17,0x3b,0x3b,0x3e7),_0x4d991c=await database_1[_0xdf25c8(0x2dd)][_0xdf25c8(0x2c4)][_0xdf25c8(0x24c)]({'_sum':{'amount':!![]},'where':{'createdAt':{'gte':_0x186cbd,'lte':_0x3ee5c2},'status':_0xdf25c8(0x2bb)}}),_0x10773c=_0x598552['_sum']['totalPaidOut']||0x0,_0x21749b=_0x1b2c7c[_0xdf25c8(0x2b1)][_0xdf25c8(0x1af)],_0x14e890=_0x4d991c[_0xdf25c8(0x277)]['amount']||0x0,_0x167921={'totalPayout':Math[_0xdf25c8(0x22a)](_0x10773c*0x64)/0x64,'awaitingPayout':Math[_0xdf25c8(0x22a)](_0x21749b*0x64)/0x64,'thisMonth':Math[_0xdf25c8(0x22a)](_0x14e890*0x64)/0x64,'availableBalance':Math[_0xdf25c8(0x22a)](_0x21749b*0x64)/0x64,'totalPayments':_0x53c2ef};return console['log']('üìä\x20Payout\x20statistics\x20calculated:'),console[_0xdf25c8(0x1ba)]('\x20\x20\x20üí∞\x20Total\x20payout:\x20'+_0x167921[_0xdf25c8(0x1c3)]+_0xdf25c8(0x23c)),console['log'](_0xdf25c8(0x1b0)+_0x167921[_0xdf25c8(0x1eb)]+_0xdf25c8(0x28a)),console[_0xdf25c8(0x1ba)](_0xdf25c8(0x1e4)+_0x167921['availableBalance']+'\x20USDT\x20(same\x20as\x20awaiting)'),console[_0xdf25c8(0x1ba)](_0xdf25c8(0x1f0)+_0x167921[_0xdf25c8(0x231)]+'\x20USDT'),console['log'](_0xdf25c8(0x222)+_0x167921['totalPayments']+_0xdf25c8(0x25c)),console[_0xdf25c8(0x1ba)](_0xdf25c8(0x1f5)+(_0x598552['_sum']['balance']||0x0)[_0xdf25c8(0x244)](0x2)+_0xdf25c8(0x2ba)),console[_0xdf25c8(0x1ba)]('\x20\x20\x20üìä\x20Commission\x20difference:\x20'+((_0x598552['_sum'][_0xdf25c8(0x29e)]||0x0)-_0x21749b)[_0xdf25c8(0x244)](0x2)+_0xdf25c8(0x287)),_0x167921;}async[a35_0x8c2769(0x2a6)](_0x4bd0f7,_0x272bef){const _0x27bb6e=a35_0x8c2769;console[_0x27bb6e(0x1ba)](_0x27bb6e(0x209)+_0x4bd0f7+':',_0x272bef);const _0x5a7af5=await database_1[_0x27bb6e(0x2dd)][_0x27bb6e(0x2af)][_0x27bb6e(0x219)]({'where':{'id':_0x4bd0f7},'select':{'id':!![],'customerEmail':!![],'customerName':!![],'customerCountry':!![],'customerIp':!![],'customerUa':!![]}});if(!_0x5a7af5)throw new Error(_0x27bb6e(0x2a3));const _0xad74a7={};_0x272bef[_0x27bb6e(0x22d)]!==undefined&&(_0xad74a7[_0x27bb6e(0x22d)]=_0x272bef['customerCountry']||null);_0x272bef[_0x27bb6e(0x23e)]!==undefined&&(_0xad74a7['customerIp']=_0x272bef[_0x27bb6e(0x23e)]||null);_0x272bef['customerUa']!==undefined&&(_0xad74a7[_0x27bb6e(0x2b2)]=_0x272bef['customerUa']||null);const _0x4dd370=await database_1['default'][_0x27bb6e(0x2af)][_0x27bb6e(0x1d0)]({'where':{'id':_0x4bd0f7},'data':{..._0xad74a7,'updatedAt':new Date()},'select':{'id':!![],'customerEmail':!![],'customerName':!![],'customerCountry':!![],'customerIp':!![],'customerUa':!![],'updatedAt':!![]}});return console[_0x27bb6e(0x1ba)]('‚úÖ\x20Customer\x20data\x20updated\x20for\x20payment\x20'+_0x4bd0f7),console[_0x27bb6e(0x1ba)]('\x20\x20\x20üåç\x20Country:\x20'+_0x5a7af5[_0x27bb6e(0x22d)]+'\x20->\x20'+_0x4dd370[_0x27bb6e(0x22d)]),console[_0x27bb6e(0x1ba)](_0x27bb6e(0x1ce)+_0x5a7af5[_0x27bb6e(0x23e)]+'\x20->\x20'+_0x4dd370[_0x27bb6e(0x23e)]),console['log'](_0x27bb6e(0x2d4)+(_0x5a7af5[_0x27bb6e(0x2b2)]?'set':_0x27bb6e(0x2d8))+_0x27bb6e(0x1e7)+(_0x4dd370[_0x27bb6e(0x2b2)]?_0x27bb6e(0x276):_0x27bb6e(0x2d8))),_0x4dd370;}async[a35_0x8c2769(0x1ee)](_0x4cba14){const _0x2d7ff9=a35_0x8c2769,_0x4bd4ee=new Date();let _0xfb4a8f;switch(_0x4cba14){case'7d':_0xfb4a8f=new Date(_0x4bd4ee[_0x2d7ff9(0x22f)]()-0x7*0x18*0x3c*0x3c*0x3e8);break;case'30d':_0xfb4a8f=new Date(_0x4bd4ee[_0x2d7ff9(0x22f)]()-0x1e*0x18*0x3c*0x3c*0x3e8);break;case _0x2d7ff9(0x2b8):_0xfb4a8f=new Date(_0x4bd4ee['getTime']()-0x5a*0x18*0x3c*0x3c*0x3e8);break;case'all':const _0x24a3a0=await database_1['default'][_0x2d7ff9(0x2af)][_0x2d7ff9(0x2aa)]({'where':{'gateway':{'not':'test_gateway'}},'orderBy':{'createdAt':_0x2d7ff9(0x1c4)},'select':{'createdAt':!![]}});_0xfb4a8f=_0x24a3a0?_0x24a3a0['createdAt']:new Date('2020-01-01'),console[_0x2d7ff9(0x1ba)](_0x2d7ff9(0x230)+_0xfb4a8f[_0x2d7ff9(0x210)]());break;default:_0xfb4a8f=new Date(_0x4bd4ee[_0x2d7ff9(0x22f)]()-0x1e*0x18*0x3c*0x3c*0x3e8);}const [_0x472699,_0x445f46,_0x28b621,_0x8d83f7,_0x452b68,_0xf1fce4,_0x282062]=await Promise[_0x2d7ff9(0x1b6)]([database_1['default'][_0x2d7ff9(0x251)][_0x2d7ff9(0x271)](),database_1['default'][_0x2d7ff9(0x251)][_0x2d7ff9(0x271)]({'where':{'status':_0x2d7ff9(0x1fb)}}),database_1[_0x2d7ff9(0x2dd)][_0x2d7ff9(0x2af)]['count']({'where':{'createdAt':{'gte':_0xfb4a8f},'gateway':{'not':_0x2d7ff9(0x1c0)}}}),database_1[_0x2d7ff9(0x2dd)][_0x2d7ff9(0x2af)][_0x2d7ff9(0x271)]({'where':{'status':'PAID','createdAt':{'gte':_0xfb4a8f},'gateway':{'not':_0x2d7ff9(0x1c0)}}}),database_1[_0x2d7ff9(0x2dd)][_0x2d7ff9(0x2af)]['findMany']({'where':{'status':'PAID','createdAt':{'gte':_0xfb4a8f},'gateway':{'not':_0x2d7ff9(0x1c0)}},'select':{'amount':!![],'currency':!![]}}),database_1[_0x2d7ff9(0x2dd)][_0x2d7ff9(0x2af)]['findMany']({'where':{'gateway':{'not':_0x2d7ff9(0x1c0)}},'take':0xa,'orderBy':{'createdAt':_0x2d7ff9(0x1c2)},'include':{'shop':{'select':{'name':!![],'username':!![]}}}}),database_1['default']['payment']['findMany']({'where':{'createdAt':{'gte':_0xfb4a8f},'gateway':{'not':_0x2d7ff9(0x1c0)}},'select':{'amount':!![],'currency':!![],'status':!![],'amountUSDT':!![],'createdAt':!![]}})]);let _0x1b2336=0x0;for(const _0x599c15 of _0x452b68){const _0x5c87d0=await currencyService_1[_0x2d7ff9(0x1e3)][_0x2d7ff9(0x2a0)](_0x599c15[_0x2d7ff9(0x235)],_0x599c15[_0x2d7ff9(0x1e9)]);_0x1b2336+=_0x5c87d0;}const _0x5d7a88=this[_0x2d7ff9(0x1da)](_0x282062,_0xfb4a8f,_0x4bd4ee),_0x3eb648=_0x28b621>0x0?_0x8d83f7/_0x28b621*0x64:0x0;return{'totalShops':_0x472699,'activeShops':_0x445f46,'totalPayments':_0x28b621,'successfulPayments':_0x8d83f7,'totalRevenue':Math['round'](_0x1b2336*0x64)/0x64,'conversionRate':Math[_0x2d7ff9(0x22a)](_0x3eb648*0x64)/0x64,'dailyRevenue':_0x5d7a88[_0x2d7ff9(0x217)],'dailyPayments':_0x5d7a88[_0x2d7ff9(0x1d2)],'recentPayments':_0xf1fce4[_0x2d7ff9(0x2cc)](_0x12f81b=>({'id':_0x12f81b['id'],'amount':_0x12f81b[_0x2d7ff9(0x235)],'currency':_0x12f81b[_0x2d7ff9(0x1e9)],'status':_0x12f81b[_0x2d7ff9(0x27c)],'gateway':_0x12f81b[_0x2d7ff9(0x253)],'shop':_0x12f81b[_0x2d7ff9(0x251)],'createdAt':_0x12f81b[_0x2d7ff9(0x1b4)]}))};}async['getMerchantStatistics'](_0x566dd6){const _0x9f6060=a35_0x8c2769;console['log']('üìä\x20Getting\x20merchant\x20statistics\x20with\x20filters:',_0x566dd6);let _0x3fd6cf,_0x5323df=new Date();if(_0x566dd6[_0x9f6060(0x223)]===_0x9f6060(0x260)&&_0x566dd6['dateFrom']&&_0x566dd6['dateTo'])_0x3fd6cf=new Date(_0x566dd6[_0x9f6060(0x2b3)]),_0x5323df=new Date(_0x566dd6[_0x9f6060(0x2e3)]);else{const _0x3af4f6=new Date();switch(_0x566dd6[_0x9f6060(0x223)]){case _0x9f6060(0x1b5):const _0x4d8e19=_0x3af4f6[_0x9f6060(0x27b)](),_0x26b625=_0x4d8e19===0x0?0x6:_0x4d8e19-0x1;_0x3fd6cf=new Date(_0x3af4f6[_0x9f6060(0x22f)]()-_0x26b625*0x18*0x3c*0x3c*0x3e8),_0x3fd6cf['setHours'](0x0,0x0,0x0,0x0);break;case _0x9f6060(0x2e7):_0x3fd6cf=new Date(_0x3af4f6[_0x9f6060(0x29b)](),_0x3af4f6['getMonth'](),0x1);break;case _0x9f6060(0x24d):_0x3fd6cf=new Date(_0x3af4f6[_0x9f6060(0x29b)](),0x0,0x1);break;case _0x9f6060(0x1b6):default:_0x3fd6cf=new Date(_0x9f6060(0x2e4));break;}}console[_0x9f6060(0x1ba)](_0x9f6060(0x270)+_0x3fd6cf[_0x9f6060(0x210)]()+'\x20to\x20'+_0x5323df[_0x9f6060(0x210)]());const _0x12506f={'status':'PAID','gateway':{'not':_0x9f6060(0x1c0)},'paidAt':{'gte':_0x3fd6cf,'lte':_0x5323df}};_0x566dd6[_0x9f6060(0x281)]&&(_0x12506f[_0x9f6060(0x281)]=_0x566dd6[_0x9f6060(0x281)]);const _0x541ff5=await database_1[_0x9f6060(0x2dd)][_0x9f6060(0x2af)][_0x9f6060(0x2c7)]({'where':_0x12506f,'include':{'shop':{'select':{'id':!![],'name':!![],'username':!![],'gatewaySettings':!![]}}}});console[_0x9f6060(0x1ba)](_0x9f6060(0x2c0)+_0x541ff5[_0x9f6060(0x1fd)]+'\x20paid\x20payments\x20for\x20analysis');const _0x2dc8ca={'gateway':{'not':_0x9f6060(0x1c0)},'createdAt':{'gte':_0x3fd6cf,'lte':_0x5323df}};_0x566dd6['shopId']&&(_0x2dc8ca[_0x9f6060(0x281)]=_0x566dd6[_0x9f6060(0x281)]);const _0x54271c=await database_1[_0x9f6060(0x2dd)][_0x9f6060(0x2af)]['count']({'where':_0x2dc8ca});console['log'](_0x9f6060(0x2df)+_0x54271c+',\x20successful:\x20'+_0x541ff5[_0x9f6060(0x1fd)]);let _0x62394c=0x0,_0x966e55=0x0,_0x4c8e42=0x0;const _0xf3acd5={},_0x476016={},_0x38c729={};for(const _0x25d8d6 of _0x541ff5){try{const _0x5e7854=await currencyService_1['currencyService'][_0x9f6060(0x2a0)](_0x25d8d6[_0x9f6060(0x235)],_0x25d8d6[_0x9f6060(0x1e9)]);let _0x59d97c={};if(_0x25d8d6[_0x9f6060(0x251)]['gatewaySettings'])try{_0x59d97c=JSON[_0x9f6060(0x22c)](_0x25d8d6[_0x9f6060(0x251)][_0x9f6060(0x1d5)]);}catch(_0x51cee6){console[_0x9f6060(0x2d2)](_0x9f6060(0x20b)+_0x25d8d6['shopId']+':',_0x51cee6);}let _0x249a64={},_0x4b5cdb=0xa;for(const [_0x1c8cda,_0x5812cd]of Object[_0x9f6060(0x259)](_0x59d97c)){if(_0x1c8cda[_0x9f6060(0x229)]()===_0x25d8d6[_0x9f6060(0x253)][_0x9f6060(0x229)]()){_0x249a64=_0x5812cd,_0x4b5cdb=_0x5812cd[_0x9f6060(0x225)]||0xa;break;}}let _0xdd90a5,_0x47ca87;_0x25d8d6[_0x9f6060(0x208)]!==null&&_0x25d8d6[_0x9f6060(0x208)]!==undefined?(_0xdd90a5=_0x25d8d6['amountAfterGatewayCommissionUSDT'],_0x47ca87=_0x5e7854-_0xdd90a5,console[_0x9f6060(0x1ba)]('üìä\x20Using\x20saved\x20historical\x20commission:\x20'+_0xdd90a5[_0x9f6060(0x244)](0x6)+_0x9f6060(0x1d1)+_0x25d8d6['id'])):(_0x47ca87=_0x5e7854*(_0x4b5cdb/0x64),_0xdd90a5=_0x5e7854-_0x47ca87,console[_0x9f6060(0x1ba)](_0x9f6060(0x262)+_0x25d8d6['id']+':\x20'+_0x4b5cdb+_0x9f6060(0x1ec)+_0x5e7854[_0x9f6060(0x244)](0x6)+_0x9f6060(0x287)));_0x62394c+=_0x5e7854,_0x966e55+=_0xdd90a5,_0x4c8e42+=_0x47ca87;!_0xf3acd5[_0x25d8d6['gateway']]&&(_0xf3acd5[_0x25d8d6[_0x9f6060(0x253)]]={'gateway':_0x25d8d6[_0x9f6060(0x253)],'gatewayDisplayName':this[_0x9f6060(0x2ae)](_0x25d8d6[_0x9f6060(0x253)]),'paymentsCount':0x0,'turnoverUSDT':0x0,'commissionUSDT':0x0,'merchantEarningsUSDT':0x0,'totalCommissionRate':0x0});_0xf3acd5[_0x25d8d6['gateway']][_0x9f6060(0x206)]++,_0xf3acd5[_0x25d8d6[_0x9f6060(0x253)]]['turnoverUSDT']+=_0x5e7854,_0xf3acd5[_0x25d8d6['gateway']][_0x9f6060(0x2e6)]+=_0x47ca87,_0xf3acd5[_0x25d8d6[_0x9f6060(0x253)]][_0x9f6060(0x254)]+=_0xdd90a5,_0xf3acd5[_0x25d8d6[_0x9f6060(0x253)]]['totalCommissionRate']+=_0x4b5cdb;!_0x566dd6['shopId']&&(!_0x476016[_0x25d8d6[_0x9f6060(0x281)]]&&(_0x476016[_0x25d8d6[_0x9f6060(0x281)]]={'shopId':_0x25d8d6[_0x9f6060(0x281)],'shopName':_0x25d8d6['shop'][_0x9f6060(0x1dc)],'shopUsername':_0x25d8d6['shop']['username'],'paymentsCount':0x0,'turnoverUSDT':0x0,'commissionUSDT':0x0,'merchantEarningsUSDT':0x0,'paidOutUSDT':0x0,'averageCheckUSDT':0x0}),_0x476016[_0x25d8d6[_0x9f6060(0x281)]][_0x9f6060(0x206)]++,_0x476016[_0x25d8d6[_0x9f6060(0x281)]][_0x9f6060(0x1bc)]+=_0x5e7854,_0x476016[_0x25d8d6[_0x9f6060(0x281)]][_0x9f6060(0x2e6)]+=_0x47ca87,_0x476016[_0x25d8d6[_0x9f6060(0x281)]][_0x9f6060(0x254)]+=_0xdd90a5);const _0xd3a052=_0x25d8d6['paidAt'][_0x9f6060(0x210)]()[_0x9f6060(0x283)]('T')[0x0];!_0x38c729[_0xd3a052]&&(_0x38c729[_0xd3a052]={'date':_0xd3a052,'turnover':0x0,'merchantEarnings':0x0,'gatewayEarnings':0x0,'paymentsCount':0x0}),_0x38c729[_0xd3a052]['turnover']+=_0x5e7854,_0x38c729[_0xd3a052][_0x9f6060(0x204)]+=_0xdd90a5,_0x38c729[_0xd3a052][_0x9f6060(0x249)]+=_0x47ca87,_0x38c729[_0xd3a052]['paymentsCount']++;}catch(_0x431563){console['error'](_0x9f6060(0x1ca)+_0x25d8d6['id']+':',_0x431563);}}Object[_0x9f6060(0x294)](_0xf3acd5)['forEach'](_0x13a034=>{const _0x5d6b87=_0x9f6060;_0x13a034[_0x5d6b87(0x237)]=_0x13a034['paymentsCount']>0x0?_0x13a034['totalCommissionRate']/_0x13a034[_0x5d6b87(0x206)]:0x0,delete _0x13a034['totalCommissionRate'];}),Object[_0x9f6060(0x294)](_0x476016)['forEach'](_0x1ee598=>{const _0x596058=_0x9f6060;_0x1ee598[_0x596058(0x2de)]=_0x1ee598[_0x596058(0x206)]>0x0?_0x1ee598[_0x596058(0x1bc)]/_0x1ee598[_0x596058(0x206)]:0x0;});let _0x390aae=0x0,_0x2501b1=0x0;if(_0x566dd6['shopId']){const _0x2150e9=await database_1[_0x9f6060(0x2dd)]['payout']['findMany']({'where':{'shopId':_0x566dd6[_0x9f6060(0x281)],'status':_0x9f6060(0x2bb),'createdAt':{'gte':_0x3fd6cf,'lte':_0x5323df}},'select':{'amount':!![]}});_0x390aae=_0x2150e9[_0x9f6060(0x284)]((_0x4d2a5c,_0x1d046f)=>_0x4d2a5c+_0x1d046f[_0x9f6060(0x235)],0x0);const _0x520f53=await database_1[_0x9f6060(0x2dd)]['payout'][_0x9f6060(0x2c7)]({'where':{'shopId':_0x566dd6[_0x9f6060(0x281)],'status':_0x9f6060(0x1fc),'createdAt':{'gte':_0x3fd6cf,'lte':_0x5323df}},'select':{'amount':!![]}});_0x2501b1=_0x520f53[_0x9f6060(0x284)]((_0x1807af,_0xb0c389)=>_0x1807af+_0xb0c389[_0x9f6060(0x235)],0x0);}const _0x42dd52=_0x54271c,_0x57d64c=_0x541ff5[_0x9f6060(0x1fd)],_0x3187a5=_0x57d64c>0x0?_0x62394c/_0x57d64c:0x0,_0x4fce8d=_0x42dd52>0x0?Math[_0x9f6060(0x22a)](_0x57d64c/_0x42dd52*0x2710)/0x64:0x0,_0x5575b5=Math['ceil']((_0x5323df[_0x9f6060(0x22f)]()-_0x3fd6cf['getTime']())/(0x3e8*0x3c*0x3c*0x18)),_0xf40413={'totalTurnover':Math[_0x9f6060(0x22a)](_0x62394c*0x64)/0x64,'merchantEarnings':Math[_0x9f6060(0x22a)](_0x966e55*0x64)/0x64,'gatewayEarnings':Math[_0x9f6060(0x22a)](_0x4c8e42*0x64)/0x64,'totalPaidOut':Math[_0x9f6060(0x22a)](_0x390aae*0x64)/0x64,'pendingPayout':Math[_0x9f6060(0x22a)](_0x2501b1*0x64)/0x64,'averageCheck':Math[_0x9f6060(0x22a)](_0x3187a5*0x64)/0x64,'totalPayments':_0x42dd52,'successfulPayments':_0x57d64c,'conversionRate':_0x4fce8d,'gatewayBreakdown':Object[_0x9f6060(0x294)](_0xf3acd5)[_0x9f6060(0x2cc)](_0x26a700=>({..._0x26a700,'turnoverUSDT':Math[_0x9f6060(0x22a)](_0x26a700['turnoverUSDT']*0x64)/0x64,'commissionUSDT':Math[_0x9f6060(0x22a)](_0x26a700[_0x9f6060(0x2e6)]*0x64)/0x64,'merchantEarningsUSDT':Math['round'](_0x26a700[_0x9f6060(0x254)]*0x64)/0x64,'averageCommissionRate':Math[_0x9f6060(0x22a)](_0x26a700[_0x9f6060(0x237)]*0x64)/0x64})),'merchantBreakdown':_0x566dd6[_0x9f6060(0x281)]?undefined:Object[_0x9f6060(0x294)](_0x476016)[_0x9f6060(0x2cc)](_0x253e25=>({..._0x253e25,'turnoverUSDT':Math[_0x9f6060(0x22a)](_0x253e25[_0x9f6060(0x1bc)]*0x64)/0x64,'commissionUSDT':Math[_0x9f6060(0x22a)](_0x253e25[_0x9f6060(0x2e6)]*0x64)/0x64,'merchantEarningsUSDT':Math['round'](_0x253e25[_0x9f6060(0x254)]*0x64)/0x64,'paidOutUSDT':Math['round'](_0x253e25[_0x9f6060(0x1e0)]*0x64)/0x64,'averageCheckUSDT':Math[_0x9f6060(0x22a)](_0x253e25[_0x9f6060(0x2de)]*0x64)/0x64})),'dailyData':Object[_0x9f6060(0x294)](_0x38c729)[_0x9f6060(0x2cc)](_0x1d7aaf=>({..._0x1d7aaf,'turnover':Math['round'](_0x1d7aaf[_0x9f6060(0x2d7)]*0x64)/0x64,'merchantEarnings':Math[_0x9f6060(0x22a)](_0x1d7aaf[_0x9f6060(0x204)]*0x64)/0x64,'gatewayEarnings':Math[_0x9f6060(0x22a)](_0x1d7aaf[_0x9f6060(0x249)]*0x64)/0x64}))['sort']((_0x5d0c0b,_0x63790e)=>_0x5d0c0b[_0x9f6060(0x233)]['localeCompare'](_0x63790e[_0x9f6060(0x233)])),'periodInfo':{'from':_0x3fd6cf,'to':_0x5323df,'periodType':_0x566dd6['period']||_0x9f6060(0x260),'daysCount':_0x5575b5}};return console[_0x9f6060(0x1ba)](_0x9f6060(0x1e2)),console[_0x9f6060(0x1ba)]('\x20\x20\x20üí∞\x20Total\x20turnover:\x20'+_0xf40413['totalTurnover']+_0x9f6060(0x287)),console[_0x9f6060(0x1ba)](_0x9f6060(0x263)+_0xf40413[_0x9f6060(0x204)]+_0x9f6060(0x287)),console[_0x9f6060(0x1ba)](_0x9f6060(0x242)+_0xf40413[_0x9f6060(0x249)]+'\x20USDT'),console[_0x9f6060(0x1ba)](_0x9f6060(0x241)+_0xf40413[_0x9f6060(0x213)]+_0x9f6060(0x287)),console[_0x9f6060(0x1ba)](_0x9f6060(0x2b6)+_0xf40413['pendingPayout']+_0x9f6060(0x287)),console[_0x9f6060(0x1ba)](_0x9f6060(0x269)+_0xf40413['totalPayments']),_0xf40413;}async[a35_0x8c2769(0x24e)](){const _0x3c0228=a35_0x8c2769;console[_0x3c0228(0x1ba)](_0x3c0228(0x289));const _0x81ac1a=await database_1[_0x3c0228(0x2dd)][_0x3c0228(0x251)]['findMany']({'where':{'status':_0x3c0228(0x1fb)},'select':{'id':!![],'username':!![],'name':!![]},'orderBy':{'name':_0x3c0228(0x1c4)}});return console['log'](_0x3c0228(0x252)+_0x81ac1a['length']+_0x3c0228(0x1bb)),_0x81ac1a[_0x3c0228(0x2cc)](_0x11e2ea=>({'id':_0x11e2ea['id'],'username':_0x11e2ea[_0x3c0228(0x1e6)],'name':_0x11e2ea[_0x3c0228(0x1dc)]}));}[a35_0x8c2769(0x2ae)](_0x1fd7b8){const _0x2a3154=a35_0x8c2769,_0x491b9b={'test_gateway':'Test\x20Gateway','plisio':_0x2a3154(0x1f9),'rapyd':_0x2a3154(0x2ac),'noda':'Noda','cointopay':_0x2a3154(0x288),'cointopay2':_0x2a3154(0x1f6),'klyme_eu':_0x2a3154(0x25b),'klyme_gb':_0x2a3154(0x2a5),'klyme_de':_0x2a3154(0x2ed),'mastercard':_0x2a3154(0x290)};return _0x491b9b[_0x1fd7b8]||_0x1fd7b8;}[a35_0x8c2769(0x2d3)](_0x2a740e){const _0x12a86d=a35_0x8c2769,_0x3382d0={'Test\x20Gateway':_0x12a86d(0x1c0),'Plisio':_0x12a86d(0x256),'Rapyd':_0x12a86d(0x278),'Noda':_0x12a86d(0x295),'CoinToPay':_0x12a86d(0x205),'CoinToPay2':_0x12a86d(0x236),'KLYME\x20EU':_0x12a86d(0x1db),'KLYME\x20GB':_0x12a86d(0x21f),'KLYME\x20DE':_0x12a86d(0x2a7),'MasterCard':_0x12a86d(0x2c6)};return _0x3382d0[_0x2a740e]||_0x2a740e[_0x12a86d(0x229)]();}async['getMerchantsAwaitingPayout'](_0x39dfe7){const _0x1abdf4=a35_0x8c2769,{page:_0xc0db7b,limit:_0x19390e,minAmount:_0x3adbb1,search:_0x4e273a}=_0x39dfe7,_0x5ac5fc=(_0xc0db7b-0x1)*_0x19390e;console['log'](_0x1abdf4(0x2e8),_0x39dfe7);const _0xfb89e2={'balance':{'gt':0x0},'status':_0x1abdf4(0x1fb)};_0x3adbb1&&(_0xfb89e2['balance'][_0x1abdf4(0x20d)]=_0x3adbb1);_0x4e273a&&(_0xfb89e2['OR']=[{'name':{'contains':_0x4e273a,'mode':_0x1abdf4(0x1f7)}},{'username':{'contains':_0x4e273a,'mode':_0x1abdf4(0x1f7)}}]);const [_0x599750,_0x3c87ff]=await Promise[_0x1abdf4(0x1b6)]([database_1[_0x1abdf4(0x2dd)][_0x1abdf4(0x251)][_0x1abdf4(0x2c7)]({'where':_0xfb89e2,'skip':_0x5ac5fc,'take':_0x19390e,'orderBy':{'balance':_0x1abdf4(0x1c2)},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'balance':!![],'totalPaidOut':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'gatewaySettings':!![],'createdAt':!![]}}),database_1[_0x1abdf4(0x2dd)][_0x1abdf4(0x251)][_0x1abdf4(0x271)]({'where':_0xfb89e2})]);console['log'](_0x1abdf4(0x2c0)+_0x599750[_0x1abdf4(0x1fd)]+_0x1abdf4(0x26c));const _0x57537d=await Promise[_0x1abdf4(0x1b6)](_0x599750[_0x1abdf4(0x2cc)](async _0x8537e8=>{const _0x393ac0=_0x1abdf4,[_0x3232d6,_0x22c36e,_0x3793d9]=await Promise[_0x393ac0(0x1b6)]([database_1[_0x393ac0(0x2dd)][_0x393ac0(0x2af)][_0x393ac0(0x271)]({'where':{'shopId':_0x8537e8['id'],'status':_0x393ac0(0x24b),'gateway':{'not':_0x393ac0(0x1c0)}}}),database_1[_0x393ac0(0x2dd)][_0x393ac0(0x2af)][_0x393ac0(0x2aa)]({'where':{'shopId':_0x8537e8['id'],'status':_0x393ac0(0x24b),'gateway':{'not':_0x393ac0(0x1c0)}},'orderBy':{'paidAt':_0x393ac0(0x1c4)},'select':{'paidAt':!![]}}),database_1[_0x393ac0(0x2dd)][_0x393ac0(0x2af)][_0x393ac0(0x28b)]({'by':[_0x393ac0(0x253)],'where':{'shopId':_0x8537e8['id'],'status':'PAID','gateway':{'not':_0x393ac0(0x1c0)}},'_count':{'id':!![]},'_sum':{'amountUSDT':!![]}})]),_0x37e9e5=new Date(),_0xa93163=new Date(_0x37e9e5['getFullYear'](),_0x37e9e5['getMonth'](),0x1),_0xdd93fd=new Date(_0x37e9e5[_0x393ac0(0x29b)](),_0x37e9e5[_0x393ac0(0x2e9)]()+0x1,0x0,0x17,0x3b,0x3b,0x3e7),[_0x31be8d,_0x1314f2]=await Promise[_0x393ac0(0x1b6)]([database_1[_0x393ac0(0x2dd)]['payout']['aggregate']({'_sum':{'amount':!![]},'where':{'shopId':_0x8537e8['id'],'status':'COMPLETED'}}),database_1[_0x393ac0(0x2dd)][_0x393ac0(0x2c4)][_0x393ac0(0x24c)]({'_sum':{'amount':!![]},'where':{'shopId':_0x8537e8['id'],'status':_0x393ac0(0x2bb),'createdAt':{'gte':_0xa93163,'lte':_0xdd93fd}}})]),_0x409294=_0x31be8d[_0x393ac0(0x277)]['amount']||0x0,_0xb8faf9=_0x1314f2[_0x393ac0(0x277)][_0x393ac0(0x235)]||0x0,_0x566bfe=await Promise[_0x393ac0(0x1b6)](_0x3793d9[_0x393ac0(0x2cc)](async _0x26697d=>{const _0x50b3f5=_0x393ac0;let _0x2e727a=0xa;if(_0x8537e8[_0x50b3f5(0x1d5)])try{const _0x282374=JSON[_0x50b3f5(0x22c)](_0x8537e8[_0x50b3f5(0x1d5)]);for(const [_0x5e48c8,_0x2cffb4]of Object[_0x50b3f5(0x259)](_0x282374)){if(_0x5e48c8[_0x50b3f5(0x229)]()===_0x26697d['gateway'][_0x50b3f5(0x229)]()){_0x2e727a=_0x2cffb4[_0x50b3f5(0x225)]||0xa,console['log'](_0x50b3f5(0x264)+_0x26697d[_0x50b3f5(0x253)]+_0x50b3f5(0x1c9)+_0x8537e8['id']+_0x50b3f5(0x2ab)+_0x2e727a+'%');break;}}}catch(_0x13c590){console['error'](_0x50b3f5(0x20b)+_0x8537e8['id']+':',_0x13c590);}const _0x4fd48e=_0x26697d[_0x50b3f5(0x277)]?.['amountUSDT']||0x0,_0x3d2c36=_0x4fd48e*(0x1-_0x2e727a/0x64);return{'gateway':_0x26697d[_0x50b3f5(0x253)],'count':_0x26697d[_0x50b3f5(0x2ea)]?.['id']||0x0,'amountUSDT':Math['round'](_0x4fd48e*0x64)/0x64,'amountAfterCommissionUSDT':Math['round'](_0x3d2c36*0x64)/0x64,'commission':_0x2e727a};})),_0x4b3a19=_0x566bfe[_0x393ac0(0x284)]((_0xb67058,_0x432393)=>_0xb67058+_0x432393[_0x393ac0(0x298)],0x0),_0x3ccb56=_0x8537e8[_0x393ac0(0x29e)];return console[_0x393ac0(0x1ba)]('üí∞\x20[PAYOUT]\x20Merchant\x20'+_0x8537e8['username']+':'),console[_0x393ac0(0x1ba)](_0x393ac0(0x202)+_0x4b3a19[_0x393ac0(0x244)](0x2)+_0x393ac0(0x232)),console[_0x393ac0(0x1ba)](_0x393ac0(0x212)+_0x566bfe[_0x393ac0(0x284)]((_0x2902a3,_0x249f0e)=>_0x2902a3+_0x249f0e[_0x393ac0(0x1c5)],0x0)[_0x393ac0(0x244)](0x2)+'\x20USDT\x20(theoretical\x20net)'),console[_0x393ac0(0x1ba)](_0x393ac0(0x282)+_0x3ccb56[_0x393ac0(0x244)](0x2)+_0x393ac0(0x24f)),{'id':_0x8537e8['id'],'fullName':_0x8537e8[_0x393ac0(0x1dc)],'username':_0x8537e8['username'],'telegramId':_0x8537e8[_0x393ac0(0x250)],'merchantUrl':_0x8537e8[_0x393ac0(0x247)],'wallets':{'usdtPolygonWallet':_0x8537e8[_0x393ac0(0x245)],'usdtTrcWallet':_0x8537e8[_0x393ac0(0x24a)],'usdtErcWallet':_0x8537e8[_0x393ac0(0x22b)],'usdcPolygonWallet':_0x8537e8['usdcPolygonWallet']},'totalAmountUSDT':Math[_0x393ac0(0x22a)](_0x4b3a19*0x64)/0x64,'totalAmountAfterCommissionUSDT':Math[_0x393ac0(0x22a)](_0x3ccb56*0x64)/0x64,'totalPayout':Math[_0x393ac0(0x22a)](_0x409294*0x64)/0x64,'thisMonth':Math[_0x393ac0(0x22a)](_0xb8faf9*0x64)/0x64,'paymentsCount':_0x3232d6,'oldestPaymentDate':_0x22c36e?.[_0x393ac0(0x215)]||_0x8537e8['createdAt'],'gatewayBreakdown':_0x566bfe};})),_0xe0253=_0x57537d['reduce']((_0x124345,_0x1dceaf)=>_0x124345+_0x1dceaf['totalAmountUSDT'],0x0),_0x38d609=_0x57537d['reduce']((_0x4ec67b,_0x325f78)=>_0x4ec67b+_0x325f78[_0x1abdf4(0x1af)],0x0),_0x3042ae=_0x57537d['reduce']((_0x58c34a,_0x5e3824)=>_0x58c34a+_0x5e3824[_0x1abdf4(0x1c3)],0x0),_0x211d3e=_0x57537d[_0x1abdf4(0x284)]((_0x5dcca5,_0x38c15f)=>_0x5dcca5+_0x38c15f[_0x1abdf4(0x231)],0x0);return console[_0x1abdf4(0x1ba)](_0x1abdf4(0x1d4)+_0x3c87ff+_0x1abdf4(0x1f3)),console[_0x1abdf4(0x1ba)](_0x1abdf4(0x239)+Math[_0x1abdf4(0x22a)](_0xe0253*0x64)/0x64+'\x20USDT\x20(gross\x20revenue)'),console['log'](_0x1abdf4(0x2ce)+Math[_0x1abdf4(0x22a)](_0x38d609*0x64)/0x64+_0x1abdf4(0x221)),console[_0x1abdf4(0x1ba)](_0x1abdf4(0x267)+Math['round'](_0x3042ae*0x64)/0x64+'\x20USDT'),console[_0x1abdf4(0x1ba)](_0x1abdf4(0x28c)+Math[_0x1abdf4(0x22a)](_0x211d3e*0x64)/0x64+'\x20USDT'),{'merchants':_0x57537d,'pagination':{'page':_0xc0db7b,'limit':_0x19390e,'total':_0x3c87ff,'totalPages':Math[_0x1abdf4(0x29c)](_0x3c87ff/_0x19390e)},'summary':{'totalMerchants':_0x3c87ff,'totalAmountUSDT':Math[_0x1abdf4(0x22a)](_0xe0253*0x64)/0x64,'totalAmountAfterCommissionUSDT':Math[_0x1abdf4(0x22a)](_0x38d609*0x64)/0x64,'totalPayout':Math[_0x1abdf4(0x22a)](_0x3042ae*0x64)/0x64,'thisMonth':Math[_0x1abdf4(0x22a)](_0x211d3e*0x64)/0x64}};}async[a35_0x8c2769(0x26d)](_0x48d8b5){const _0x2ae343=a35_0x8c2769,{shopId:_0x11fb1e,amount:_0xeeb23e,network:_0x3d83e7,wallet:_0x14004e,notes:_0x298b37,txid:_0x1aa28f,periodFrom:_0x3f740a,periodTo:_0x2dfe56}=_0x48d8b5,_0x5aed28=await database_1[_0x2ae343(0x2dd)]['$transaction'](async _0x29ac86=>{const _0x17bd98=_0x2ae343,_0x78a5b0=await _0x29ac86['shop'][_0x17bd98(0x219)]({'where':{'id':_0x11fb1e},'select':{'id':!![],'name':!![],'username':!![],'balance':!![],'totalPaidOut':!![]}});if(!_0x78a5b0)throw new Error(_0x17bd98(0x1be));console[_0x17bd98(0x1ba)]('üí∞\x20Creating\x20payout\x20for\x20shop\x20'+_0x78a5b0['username']+':'),console['log'](_0x17bd98(0x1f4)+_0x78a5b0[_0x17bd98(0x29e)][_0x17bd98(0x244)](0x6)+_0x17bd98(0x287)),console['log']('\x20\x20\x20Payout\x20amount:\x20'+_0xeeb23e[_0x17bd98(0x244)](0x6)+'\x20USDT'),console[_0x17bd98(0x1ba)](_0x17bd98(0x2c8)+_0x78a5b0[_0x17bd98(0x213)]['toFixed'](0x6)+_0x17bd98(0x287));if(_0x1aa28f)console[_0x17bd98(0x1ba)](_0x17bd98(0x214)+_0x1aa28f);if(_0x78a5b0[_0x17bd98(0x29e)]<_0xeeb23e)throw new Error(_0x17bd98(0x23f)+_0x78a5b0[_0x17bd98(0x29e)][_0x17bd98(0x244)](0x6)+_0x17bd98(0x1c6)+_0xeeb23e[_0x17bd98(0x244)](0x6)+_0x17bd98(0x287));let _0x21de15=_0x14004e;if(!_0x21de15){const _0x37e80e=await _0x29ac86[_0x17bd98(0x251)][_0x17bd98(0x219)]({'where':{'id':_0x11fb1e},'select':{'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![]}});if(_0x37e80e)switch(_0x3d83e7){case _0x17bd98(0x2ad):_0x21de15=_0x37e80e[_0x17bd98(0x245)]||undefined;break;case _0x17bd98(0x2e0):_0x21de15=_0x37e80e[_0x17bd98(0x24a)]||undefined;break;case _0x17bd98(0x29d):_0x21de15=_0x37e80e['usdtErcWallet']||undefined;break;case _0x17bd98(0x273):_0x21de15=_0x37e80e[_0x17bd98(0x2c2)]||undefined;break;}}console[_0x17bd98(0x1ba)]('üí≥\x20Payout\x20wallet\x20for\x20'+_0x3d83e7+':\x20'+(_0x21de15||'not\x20specified'));const _0x5cd35f=await _0x29ac86[_0x17bd98(0x2c4)][_0x17bd98(0x218)]({'data':{'shopId':_0x11fb1e,'amount':_0xeeb23e,'network':_0x3d83e7,'status':_0x17bd98(0x2bb),'txid':_0x1aa28f,'notes':_0x298b37,'periodFrom':_0x3f740a?new Date(_0x3f740a):null,'periodTo':_0x2dfe56?new Date(_0x2dfe56):null,'createdAt':new Date(),'paidAt':new Date()}}),_0x343eb8=_0x78a5b0['balance']-_0xeeb23e,_0x3f4c0f=_0x78a5b0[_0x17bd98(0x213)]+_0xeeb23e;return await _0x29ac86[_0x17bd98(0x251)][_0x17bd98(0x1d0)]({'where':{'id':_0x11fb1e},'data':{'balance':_0x343eb8,'totalPaidOut':_0x3f4c0f}}),console[_0x17bd98(0x1ba)](_0x17bd98(0x1e1)+_0x78a5b0[_0x17bd98(0x1e6)]+_0x17bd98(0x1e8)),console[_0x17bd98(0x1ba)]('\x20\x20\x20Balance:\x20'+_0x78a5b0['balance'][_0x17bd98(0x244)](0x6)+_0x17bd98(0x1e7)+_0x343eb8['toFixed'](0x6)+_0x17bd98(0x2bc)+_0xeeb23e['toFixed'](0x6)+')'),console['log'](_0x17bd98(0x2d9)+_0x78a5b0[_0x17bd98(0x213)][_0x17bd98(0x244)](0x6)+_0x17bd98(0x1e7)+_0x3f4c0f[_0x17bd98(0x244)](0x6)+_0x17bd98(0x275)+_0xeeb23e[_0x17bd98(0x244)](0x6)+')'),{'payout':_0x5cd35f,'shop':_0x78a5b0};});return console[_0x2ae343(0x1ba)](_0x2ae343(0x1ea)+_0x5aed28[_0x2ae343(0x2c4)]['id']+_0x2ae343(0x1c9)+_0x5aed28[_0x2ae343(0x251)][_0x2ae343(0x1e6)]+'\x20('+_0xeeb23e+_0x2ae343(0x297)),{'id':_0x5aed28[_0x2ae343(0x2c4)]['id'],'shopId':_0x5aed28[_0x2ae343(0x2c4)][_0x2ae343(0x281)],'shopName':_0x5aed28[_0x2ae343(0x251)][_0x2ae343(0x1dc)],'shopUsername':_0x5aed28[_0x2ae343(0x251)][_0x2ae343(0x1e6)],'amount':_0x5aed28['payout'][_0x2ae343(0x235)],'network':_0x5aed28['payout'][_0x2ae343(0x240)],'status':_0x5aed28[_0x2ae343(0x2c4)][_0x2ae343(0x27c)],'txid':_0x5aed28[_0x2ae343(0x2c4)][_0x2ae343(0x220)],'notes':_0x5aed28[_0x2ae343(0x2c4)][_0x2ae343(0x234)],'periodFrom':_0x5aed28[_0x2ae343(0x2c4)]['periodFrom'],'periodTo':_0x5aed28[_0x2ae343(0x2c4)]['periodTo'],'createdAt':_0x5aed28[_0x2ae343(0x2c4)]['createdAt'],'paidAt':_0x5aed28[_0x2ae343(0x2c4)][_0x2ae343(0x215)]};}async['getAllPayouts'](_0x2b5f08){const _0x3d9160=a35_0x8c2769,{page:_0xd6af9c,limit:_0x51fdb5,shopId:_0x10b95e,network:_0x51e029,dateFrom:_0x571806,dateTo:_0x5eb0bb,search:_0x5a8825}=_0x2b5f08,_0x22c487=(_0xd6af9c-0x1)*_0x51fdb5,_0xbb9bad={};_0x10b95e&&(_0xbb9bad[_0x3d9160(0x281)]=_0x10b95e);_0x51e029&&(_0xbb9bad[_0x3d9160(0x240)]=_0x51e029);(_0x571806||_0x5eb0bb)&&(_0xbb9bad['createdAt']={},_0x571806&&(_0xbb9bad[_0x3d9160(0x1b4)][_0x3d9160(0x20d)]=new Date(_0x571806)),_0x5eb0bb&&(_0xbb9bad['createdAt'][_0x3d9160(0x23a)]=new Date(_0x5eb0bb)));_0x5a8825&&(_0xbb9bad['OR']=[{'shop':{'name':{'contains':_0x5a8825,'mode':_0x3d9160(0x1f7)}}},{'shop':{'username':{'contains':_0x5a8825,'mode':_0x3d9160(0x1f7)}}},{'notes':{'contains':_0x5a8825,'mode':_0x3d9160(0x1f7)}}]);const [_0x84ff01,_0x36fe84]=await Promise[_0x3d9160(0x1b6)]([database_1[_0x3d9160(0x2dd)][_0x3d9160(0x2c4)]['findMany']({'where':_0xbb9bad,'skip':_0x22c487,'take':_0x51fdb5,'orderBy':{'createdAt':_0x3d9160(0x1c2)},'select':{'id':!![],'shopId':!![],'amount':!![],'network':!![],'status':!![],'txid':!![],'notes':!![],'periodFrom':!![],'periodTo':!![],'createdAt':!![],'paidAt':!![],'shop':{'select':{'name':!![],'username':!![]}}}}),database_1[_0x3d9160(0x2dd)]['payout'][_0x3d9160(0x271)]({'where':_0xbb9bad})]);return{'payouts':_0x84ff01['map'](_0xca1fc4=>({'id':_0xca1fc4['id'],'shopId':_0xca1fc4['shopId'],'shopName':_0xca1fc4[_0x3d9160(0x251)]['name'],'shopUsername':_0xca1fc4['shop'][_0x3d9160(0x1e6)],'amount':_0xca1fc4[_0x3d9160(0x235)],'network':_0xca1fc4[_0x3d9160(0x240)],'status':_0xca1fc4[_0x3d9160(0x27c)],'txid':_0xca1fc4[_0x3d9160(0x220)],'notes':_0xca1fc4[_0x3d9160(0x234)],'periodFrom':_0xca1fc4[_0x3d9160(0x2b7)],'periodTo':_0xca1fc4[_0x3d9160(0x28f)],'createdAt':_0xca1fc4[_0x3d9160(0x1b4)],'paidAt':_0xca1fc4[_0x3d9160(0x215)]})),'pagination':{'page':_0xd6af9c,'limit':_0x51fdb5,'total':_0x36fe84,'totalPages':Math['ceil'](_0x36fe84/_0x51fdb5)}};}async[a35_0x8c2769(0x200)](_0x181912){const _0x3839a4=a35_0x8c2769,_0x43be84=await database_1['default'][_0x3839a4(0x2c4)]['findUnique']({'where':{'id':_0x181912},'include':{'shop':{'select':{'name':!![],'username':!![]}}}});if(!_0x43be84)return null;return{'id':_0x43be84['id'],'shopId':_0x43be84['shopId'],'shopName':_0x43be84['shop']['name'],'shopUsername':_0x43be84[_0x3839a4(0x251)][_0x3839a4(0x1e6)],'amount':_0x43be84[_0x3839a4(0x235)],'network':_0x43be84[_0x3839a4(0x240)],'status':_0x43be84[_0x3839a4(0x27c)],'txid':_0x43be84[_0x3839a4(0x220)],'notes':_0x43be84[_0x3839a4(0x234)],'periodFrom':_0x43be84[_0x3839a4(0x2b7)],'periodTo':_0x43be84[_0x3839a4(0x28f)],'createdAt':_0x43be84[_0x3839a4(0x1b4)],'paidAt':_0x43be84[_0x3839a4(0x215)]};}async['deletePayout'](_0x46d8cc){const _0x38a9f3=a35_0x8c2769;await database_1[_0x38a9f3(0x2dd)][_0x38a9f3(0x2c4)]['delete']({'where':{'id':_0x46d8cc}});}async[a35_0x8c2769(0x285)](_0x5edfb9){const _0x4e849a=a35_0x8c2769,{page:_0x21c258,limit:_0x476588,status:_0x279556,gateway:_0x3fad1c,shopId:_0x339123,dateFrom:_0x33b2c6,dateTo:_0x244264,search:_0x463625,currency:_0x3d267d,sortBy:_0x4da6da,sortOrder:_0x49c933}=_0x5edfb9,_0xcbde4e=(_0x21c258-0x1)*_0x476588;console['log'](_0x4e849a(0x1f8),_0x5edfb9);const _0x20f979=await database_1[_0x4e849a(0x2dd)][_0x4e849a(0x2af)]['groupBy']({'by':[_0x4e849a(0x253)],'_count':{'gateway':!![]}});console[_0x4e849a(0x1ba)](_0x4e849a(0x25a),_0x20f979['map'](_0x8bfb5=>_0x8bfb5[_0x4e849a(0x253)]+'\x20('+_0x8bfb5[_0x4e849a(0x2ea)][_0x4e849a(0x253)]+_0x4e849a(0x2e2)));if(_0x3fad1c){const _0x1bcc7b=_0x20f979['some'](_0x45941d=>_0x45941d['gateway'][_0x4e849a(0x229)]()===_0x3fad1c['toLowerCase']());!_0x1bcc7b&&_0x3fad1c['toLowerCase']()!==_0x4e849a(0x1c0)&&console[_0x4e849a(0x1ba)](_0x4e849a(0x274)+_0x3fad1c+_0x4e849a(0x228)+_0x20f979[_0x4e849a(0x2cc)](_0x54ddf8=>_0x54ddf8[_0x4e849a(0x253)])[_0x4e849a(0x21e)](',\x20'));}const _0x31aa4f={};_0x279556&&(_0x31aa4f[_0x4e849a(0x27c)]=_0x279556[_0x4e849a(0x201)]());if(!_0x3fad1c)_0x31aa4f[_0x4e849a(0x253)]={'not':_0x4e849a(0x1c0)};else{if(_0x3fad1c&&(_0x3fad1c[_0x4e849a(0x229)]()===_0x4e849a(0x1c0)||_0x3fad1c==='0000'))_0x31aa4f[_0x4e849a(0x253)]=_0x4e849a(0x1c0);else{let _0x448472=_0x3fad1c;const _0x1a746d=(0x0,gateway_1[_0x4e849a(0x261)])(_0x3fad1c);if(_0x1a746d)_0x448472=_0x1a746d,console[_0x4e849a(0x1ba)](_0x4e849a(0x246)+_0x3fad1c+_0x4e849a(0x2c3)+_0x448472+'\x27');else{const _0xeed7c7=(0x0,gateway_1['getGatewayIdByName'])(_0x3fad1c);if(_0xeed7c7){const _0x1a3c7d=(0x0,gateway_1[_0x4e849a(0x261)])(_0xeed7c7);_0x1a3c7d&&(_0x448472=_0x1a3c7d,console[_0x4e849a(0x1ba)](_0x4e849a(0x280)+_0x3fad1c+'\x27\x20->\x20ID\x20\x27'+_0xeed7c7+_0x4e849a(0x1cf)+_0x448472+'\x27'));}else console[_0x4e849a(0x1ba)]('üîç\x20Using\x20gateway\x20\x27'+_0x3fad1c+_0x4e849a(0x2e5));}const _0x30045c=await database_1[_0x4e849a(0x2dd)][_0x4e849a(0x2af)][_0x4e849a(0x271)]({'where':{'gateway':_0x448472[_0x4e849a(0x229)]()},'take':0x1});_0x30045c===0x0?(console['log'](_0x4e849a(0x207)+_0x448472+_0x4e849a(0x1c1)+_0x3fad1c+_0x4e849a(0x2ec)),_0x31aa4f[_0x4e849a(0x253)]=_0x4e849a(0x1ef)):(_0x31aa4f[_0x4e849a(0x253)]=_0x448472[_0x4e849a(0x229)](),console['log'](_0x4e849a(0x1f2)+_0x448472+'\x27\x20(from\x20\x27'+_0x3fad1c+'\x27)'));}}console['log'](_0x4e849a(0x1c7),_0x31aa4f[_0x4e849a(0x253)]);_0x339123&&(_0x31aa4f[_0x4e849a(0x281)]=_0x339123);_0x3d267d&&(_0x31aa4f['currency']=_0x3d267d[_0x4e849a(0x201)](),console[_0x4e849a(0x1ba)](_0x4e849a(0x26a)+_0x3d267d['toUpperCase']()));(_0x33b2c6||_0x244264)&&(_0x31aa4f[_0x4e849a(0x1b4)]={},_0x33b2c6&&(_0x31aa4f['createdAt'][_0x4e849a(0x20d)]=new Date(_0x33b2c6)),_0x244264&&(_0x31aa4f[_0x4e849a(0x1b4)]['lte']=new Date(_0x244264)));_0x463625&&(_0x31aa4f['OR']=[{'id':{'contains':_0x463625,'mode':_0x4e849a(0x1f7)}},{'orderId':{'contains':_0x463625,'mode':_0x4e849a(0x1f7)}},{'gatewayOrderId':{'contains':_0x463625,'mode':'insensitive'}},{'customerEmail':{'contains':_0x463625,'mode':'insensitive'}},{'shop':{'name':{'contains':_0x463625,'mode':_0x4e849a(0x1f7)}}},{'shop':{'username':{'contains':_0x463625,'mode':_0x4e849a(0x1f7)}}}]);console['log'](_0x4e849a(0x226),JSON['stringify'](_0x31aa4f,null,0x2));let _0x325f02={'createdAt':_0x4e849a(0x1c2)};if(_0x4da6da){const _0x1b7560=[_0x4e849a(0x235),'createdAt','updatedAt','status',_0x4e849a(0x253),_0x4e849a(0x1e9)],_0x1f26d2=[_0x4e849a(0x1c4),'desc'];if(_0x1b7560[_0x4e849a(0x1b1)](_0x4da6da)){const _0x5ea4a2=_0x1f26d2['includes'](_0x49c933)?_0x49c933:_0x4e849a(0x1c2);_0x325f02={[_0x4da6da]:_0x5ea4a2},console[_0x4e849a(0x1ba)](_0x4e849a(0x2b5)+_0x4da6da+'\x20in\x20'+_0x5ea4a2+'\x20order');}}const [_0x48dde2,_0x5309dd]=await Promise[_0x4e849a(0x1b6)]([database_1[_0x4e849a(0x2dd)][_0x4e849a(0x2af)][_0x4e849a(0x2c7)]({'where':_0x31aa4f,'skip':_0xcbde4e,'take':_0x476588,'orderBy':_0x325f02,'include':{'shop':{'select':{'name':!![],'username':!![]}}}}),database_1[_0x4e849a(0x2dd)][_0x4e849a(0x2af)][_0x4e849a(0x271)]({'where':_0x31aa4f})]);return{'payments':_0x48dde2,'pagination':{'page':_0x21c258,'limit':_0x476588,'total':_0x5309dd,'totalPages':Math[_0x4e849a(0x29c)](_0x5309dd/_0x476588)}};}async['getPaymentById'](_0x4f7c6c){const _0x3748b8=a35_0x8c2769,_0x27944e=await database_1[_0x3748b8(0x2dd)][_0x3748b8(0x2af)][_0x3748b8(0x219)]({'where':{'id':_0x4f7c6c},'include':{'shop':{'select':{'name':!![],'username':!![]}}}});if(!_0x27944e)return null;return{'id':_0x27944e['id'],'shopId':_0x27944e[_0x3748b8(0x281)],'gateway':_0x27944e[_0x3748b8(0x253)],'amount':_0x27944e[_0x3748b8(0x235)],'currency':_0x27944e[_0x3748b8(0x1e9)],'status':_0x27944e[_0x3748b8(0x27c)],'orderId':_0x27944e[_0x3748b8(0x248)],'gatewayOrderId':_0x27944e[_0x3748b8(0x2c1)],'customerEmail':_0x27944e[_0x3748b8(0x2bd)],'customerName':_0x27944e[_0x3748b8(0x20e)],'customerCountry':_0x27944e[_0x3748b8(0x22d)],'customerIp':_0x27944e[_0x3748b8(0x23e)],'customerUa':_0x27944e['customerUa'],'failureMessage':_0x27944e['failureMessage'],'externalPaymentUrl':_0x27944e[_0x3748b8(0x1b9)],'successUrl':_0x27944e[_0x3748b8(0x1ff)],'failUrl':_0x27944e[_0x3748b8(0x1c8)],'pendingUrl':_0x27944e[_0x3748b8(0x2db)],'whiteUrl':_0x27944e[_0x3748b8(0x25d)],'createdAt':_0x27944e[_0x3748b8(0x1b4)],'updatedAt':_0x27944e[_0x3748b8(0x23b)],'shop':_0x27944e['shop']};}async[a35_0x8c2769(0x26f)](_0x694d9f,_0x5301da,_0x30e2a3,_0x539649){const _0x16d36b=a35_0x8c2769,_0x247c6a=await database_1[_0x16d36b(0x2dd)][_0x16d36b(0x21a)](async _0xed3606=>{const _0x4cfc12=_0x16d36b,_0x41f20f=await _0xed3606['payment'][_0x4cfc12(0x219)]({'where':{'id':_0x694d9f},'include':{'shop':{'select':{'id':!![],'name':!![],'username':!![],'balance':!![]}}}});if(!_0x41f20f)throw new Error(_0x4cfc12(0x2a3));const _0x48966c=_0x41f20f[_0x4cfc12(0x27c)],_0x338234=_0x5301da[_0x4cfc12(0x201)]();console['log'](_0x4cfc12(0x224)+_0x694d9f+_0x4cfc12(0x238)+_0x48966c+_0x4cfc12(0x1e7)+_0x338234),console['log'](_0x4cfc12(0x21b)+_0x41f20f[_0x4cfc12(0x251)][_0x4cfc12(0x29e)]+_0x4cfc12(0x287));const _0x5874c5={'status':_0x338234,'updatedAt':new Date(),'statusChangedBy':'admin','statusChangedAt':new Date()};_0x30e2a3&&(_0x5874c5[_0x4cfc12(0x2a9)]=_0x30e2a3);_0x338234===_0x4cfc12(0x2da)&&_0x539649&&(_0x5874c5[_0x4cfc12(0x2b0)]=_0x539649);let _0x1932ae=0x0,_0x4d0b24=_0x41f20f['shop'][_0x4cfc12(0x29e)];if(_0x338234===_0x4cfc12(0x24b)&&_0x48966c!==_0x4cfc12(0x24b)){_0x5874c5[_0x4cfc12(0x215)]=new Date();const _0x56a355=await currencyService_1[_0x4cfc12(0x1e3)][_0x4cfc12(0x2a0)](_0x41f20f[_0x4cfc12(0x235)],_0x41f20f[_0x4cfc12(0x1e9)]);_0x5874c5[_0x4cfc12(0x298)]=_0x56a355;let _0x4915c2=0xa;const _0x381ac9=await _0xed3606[_0x4cfc12(0x251)][_0x4cfc12(0x219)]({'where':{'id':_0x41f20f['shopId']},'select':{'gatewaySettings':!![]}});if(_0x381ac9?.[_0x4cfc12(0x1d5)])try{const _0x7ea003=JSON[_0x4cfc12(0x22c)](_0x381ac9['gatewaySettings']);for(const [_0x2c7013,_0x2e4fdb]of Object[_0x4cfc12(0x259)](_0x7ea003)){if(_0x2c7013[_0x4cfc12(0x229)]()===_0x41f20f['gateway'][_0x4cfc12(0x229)]()){_0x4915c2=_0x2e4fdb[_0x4cfc12(0x225)]||0xa;break;}}}catch(_0x32d103){console[_0x4cfc12(0x2d2)](_0x4cfc12(0x27a)+_0x694d9f+':',_0x32d103);}let _0x22336f;_0x41f20f[_0x4cfc12(0x208)]!==null&&_0x41f20f[_0x4cfc12(0x208)]!==undefined?(_0x22336f=_0x41f20f[_0x4cfc12(0x208)],console[_0x4cfc12(0x1ba)](_0x4cfc12(0x296)+_0x22336f['toFixed'](0x6)+_0x4cfc12(0x1d1)+_0x694d9f)):(_0x22336f=_0x56a355*(0x1-_0x4915c2/0x64),console[_0x4cfc12(0x1ba)]('üìä\x20[ADMIN]\x20Calculating\x20commission\x20manually\x20for\x20payment\x20'+_0x694d9f+':\x20'+_0x4915c2+_0x4cfc12(0x1ec)+_0x56a355[_0x4cfc12(0x244)](0x6)+_0x4cfc12(0x287)),_0x5874c5[_0x4cfc12(0x208)]=_0x22336f),_0x1932ae=_0x22336f,_0x4d0b24+=_0x22336f,console[_0x4cfc12(0x1ba)](_0x4cfc12(0x2b9)+_0x694d9f+_0x4cfc12(0x258)),console['log'](_0x4cfc12(0x28d)+_0x56a355[_0x4cfc12(0x244)](0x6)+_0x4cfc12(0x287)),console[_0x4cfc12(0x1ba)]('\x20\x20\x20Gateway:\x20'+_0x41f20f[_0x4cfc12(0x253)]+_0x4cfc12(0x27e)+_0x4915c2+'%'),console[_0x4cfc12(0x1ba)](_0x4cfc12(0x1fe)+_0x22336f[_0x4cfc12(0x244)](0x6)+'\x20USDT\x20(after\x20'+_0x4915c2+_0x4cfc12(0x2c5)),console[_0x4cfc12(0x1ba)](_0x4cfc12(0x211)+_0x22336f[_0x4cfc12(0x244)](0x6)+'\x20USDT');}else{if(_0x48966c==='PAID'&&_0x338234!==_0x4cfc12(0x24b)){if(_0x41f20f[_0x4cfc12(0x298)]){let _0x1799d6=0xa;const _0x581084=await _0xed3606[_0x4cfc12(0x251)][_0x4cfc12(0x219)]({'where':{'id':_0x41f20f[_0x4cfc12(0x281)]},'select':{'gatewaySettings':!![]}});if(_0x581084?.[_0x4cfc12(0x1d5)])try{const _0xee62ba=JSON[_0x4cfc12(0x22c)](_0x581084['gatewaySettings']);for(const [_0x179797,_0xf53bf]of Object['entries'](_0xee62ba)){if(_0x179797[_0x4cfc12(0x229)]()===_0x41f20f['gateway'][_0x4cfc12(0x229)]()){_0x1799d6=_0xf53bf[_0x4cfc12(0x225)]||0xa;break;}}}catch(_0x1d29ac){console[_0x4cfc12(0x2d2)]('Error\x20parsing\x20gateway\x20settings\x20for\x20payment\x20'+_0x694d9f+':',_0x1d29ac);}const _0x1c2a00=_0x41f20f[_0x4cfc12(0x298)]*(0x1-_0x1799d6/0x64);_0x1932ae=-_0x1c2a00,_0x4d0b24-=_0x1c2a00,_0x5874c5[_0x4cfc12(0x298)]=null,_0x5874c5[_0x4cfc12(0x208)]=null,console[_0x4cfc12(0x1ba)](_0x4cfc12(0x2b9)+_0x694d9f+_0x4cfc12(0x1b2)),console[_0x4cfc12(0x1ba)](_0x4cfc12(0x28d)+_0x41f20f[_0x4cfc12(0x298)][_0x4cfc12(0x244)](0x6)+_0x4cfc12(0x287)),console[_0x4cfc12(0x1ba)](_0x4cfc12(0x1b8)+_0x41f20f[_0x4cfc12(0x253)]+',\x20Commission:\x20'+_0x1799d6+'%'),console[_0x4cfc12(0x1ba)](_0x4cfc12(0x2c9)+_0x1c2a00[_0x4cfc12(0x244)](0x6)+_0x4cfc12(0x257)+_0x1799d6+_0x4cfc12(0x2c5)),console[_0x4cfc12(0x1ba)](_0x4cfc12(0x2a1)+_0x1c2a00[_0x4cfc12(0x244)](0x6)+'\x20USDT');}}}_0x338234===_0x4cfc12(0x2da)&&(_0x48966c===_0x4cfc12(0x24b)&&_0x41f20f[_0x4cfc12(0x298)]&&console[_0x4cfc12(0x1ba)](_0x4cfc12(0x29f)),_0x539649&&_0x539649>0x0&&(_0x1932ae-=_0x539649,_0x4d0b24-=_0x539649,console[_0x4cfc12(0x1ba)](_0x4cfc12(0x2be)+_0x539649[_0x4cfc12(0x244)](0x6)+_0x4cfc12(0x227))));_0x338234===_0x4cfc12(0x20c)&&_0x48966c===_0x4cfc12(0x24b)&&console[_0x4cfc12(0x1ba)](_0x4cfc12(0x1d6));const _0xe6a12=await _0xed3606[_0x4cfc12(0x2af)][_0x4cfc12(0x1d0)]({'where':{'id':_0x694d9f},'data':_0x5874c5,'include':{'shop':{'select':{'name':!![],'username':!![]}}}});return _0x1932ae!==0x0&&(await _0xed3606[_0x4cfc12(0x251)][_0x4cfc12(0x1d0)]({'where':{'id':_0x41f20f[_0x4cfc12(0x281)]},'data':{'balance':_0x4d0b24}}),console[_0x4cfc12(0x1ba)](_0x4cfc12(0x1e1)+_0x41f20f[_0x4cfc12(0x281)]+'\x20balance\x20updated:\x20'+_0x41f20f[_0x4cfc12(0x251)]['balance'][_0x4cfc12(0x244)](0x6)+'\x20->\x20'+_0x4d0b24[_0x4cfc12(0x244)](0x6)+_0x4cfc12(0x23d)+(_0x1932ae>0x0?'+':'')+_0x1932ae['toFixed'](0x6)+')')),_0xe6a12;});return{'id':_0x247c6a['id'],'shopId':_0x247c6a[_0x16d36b(0x281)],'gateway':_0x247c6a[_0x16d36b(0x253)],'amount':_0x247c6a[_0x16d36b(0x235)],'currency':_0x247c6a[_0x16d36b(0x1e9)],'status':_0x247c6a['status'],'orderId':_0x247c6a[_0x16d36b(0x248)],'gatewayOrderId':_0x247c6a[_0x16d36b(0x2c1)],'customerEmail':_0x247c6a[_0x16d36b(0x2bd)],'customerName':_0x247c6a[_0x16d36b(0x20e)],'customerCountry':_0x247c6a[_0x16d36b(0x22d)],'customerIp':_0x247c6a['customerIp'],'customerUa':_0x247c6a[_0x16d36b(0x2b2)],'failureMessage':_0x247c6a[_0x16d36b(0x266)],'adminNotes':_0x247c6a[_0x16d36b(0x2a9)],'chargebackAmount':_0x247c6a['chargebackAmount'],'statusChangedBy':_0x247c6a[_0x16d36b(0x1ad)],'statusChangedAt':_0x247c6a['statusChangedAt'],'createdAt':_0x247c6a[_0x16d36b(0x1b4)],'updatedAt':_0x247c6a['updatedAt'],'shop':_0x247c6a[_0x16d36b(0x251)]};}async[a35_0x8c2769(0x1d7)](_0x172a4e,_0x2395a4){const _0x53b6a9=a35_0x8c2769,_0xb39920=Math[_0x53b6a9(0x1b7)]()[_0x53b6a9(0x292)](0x24)[_0x53b6a9(0x299)](0x2,0x9);console[_0x53b6a9(0x1ba)](_0x53b6a9(0x268)+_0xb39920+_0x53b6a9(0x2d6)+_0x172a4e);const _0x3669ff={..._0x2395a4};_0x2395a4[_0x53b6a9(0x1cc)]&&_0x2395a4[_0x53b6a9(0x1cc)][_0x53b6a9(0x25f)]()!==''?(console['log'](_0x53b6a9(0x21c)+_0xb39920+_0x53b6a9(0x1f1)+_0x172a4e),_0x3669ff[_0x53b6a9(0x1cc)]=await bcryptjs_1[_0x53b6a9(0x2dd)][_0x53b6a9(0x27f)](_0x2395a4['password'],0xc)):(console[_0x53b6a9(0x1ba)](_0x53b6a9(0x21c)+_0xb39920+_0x53b6a9(0x291)),delete _0x3669ff[_0x53b6a9(0x1cc)]);_0x2395a4['fullName']&&(_0x3669ff[_0x53b6a9(0x1dc)]=_0x2395a4[_0x53b6a9(0x1df)],delete _0x3669ff['fullName']);_0x2395a4[_0x53b6a9(0x293)]&&(_0x3669ff[_0x53b6a9(0x250)]=_0x2395a4['telegramId'],delete _0x3669ff[_0x53b6a9(0x293)]);_0x2395a4[_0x53b6a9(0x1ae)]&&(_0x3669ff[_0x53b6a9(0x247)]=_0x2395a4[_0x53b6a9(0x1ae)],delete _0x3669ff['merchantUrl']);if(_0x2395a4[_0x53b6a9(0x243)]){const _0x1b1b4f=_0x2395a4['gateways'][_0x53b6a9(0x2cc)](_0x2df8a4=>this[_0x53b6a9(0x2d3)](_0x2df8a4));console['log']('üîÑ\x20Gateway\x20mapping:',_0x2395a4[_0x53b6a9(0x243)],'->',_0x1b1b4f),_0x3669ff[_0x53b6a9(0x2dc)]=JSON['stringify'](_0x1b1b4f),delete _0x3669ff[_0x53b6a9(0x243)];}_0x2395a4[_0x53b6a9(0x1d5)]&&(console[_0x53b6a9(0x1ba)](_0x53b6a9(0x255)+_0xb39920+_0x53b6a9(0x2cd),_0x2395a4[_0x53b6a9(0x1d5)]),_0x3669ff['gatewaySettings']=JSON['stringify'](_0x2395a4[_0x53b6a9(0x1d5)]),console[_0x53b6a9(0x1ba)](_0x53b6a9(0x255)+_0xb39920+']\x20Gateway\x20settings\x20JSON\x20string:',_0x3669ff[_0x53b6a9(0x1d5)]));_0x2395a4[_0x53b6a9(0x1cb)]&&(_0x2395a4[_0x53b6a9(0x1cb)][_0x53b6a9(0x245)]!==undefined&&(_0x3669ff[_0x53b6a9(0x245)]=_0x2395a4[_0x53b6a9(0x1cb)][_0x53b6a9(0x245)]||null),_0x2395a4[_0x53b6a9(0x1cb)][_0x53b6a9(0x24a)]!==undefined&&(_0x3669ff['usdtTrcWallet']=_0x2395a4['wallets'][_0x53b6a9(0x24a)]||null),_0x2395a4[_0x53b6a9(0x1cb)][_0x53b6a9(0x22b)]!==undefined&&(_0x3669ff[_0x53b6a9(0x22b)]=_0x2395a4['wallets'][_0x53b6a9(0x22b)]||null),_0x2395a4[_0x53b6a9(0x1cb)][_0x53b6a9(0x2c2)]!==undefined&&(_0x3669ff[_0x53b6a9(0x2c2)]=_0x2395a4[_0x53b6a9(0x1cb)][_0x53b6a9(0x2c2)]||null),delete _0x3669ff[_0x53b6a9(0x1cb)]);const _0x531dce=await database_1[_0x53b6a9(0x2dd)][_0x53b6a9(0x251)][_0x53b6a9(0x1d0)]({'where':{'id':_0x172a4e},'data':_0x3669ff,'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});return console[_0x53b6a9(0x1ba)](_0x53b6a9(0x2e1)+_0xb39920+_0x53b6a9(0x1d8),_0x531dce[_0x53b6a9(0x1d5)]),{'id':_0x531dce['id'],'fullName':_0x531dce[_0x53b6a9(0x1dc)],'username':_0x531dce[_0x53b6a9(0x1e6)],'telegramId':_0x531dce[_0x53b6a9(0x250)],'merchantUrl':_0x531dce[_0x53b6a9(0x247)],'gateways':_0x531dce[_0x53b6a9(0x2dc)]?JSON[_0x53b6a9(0x22c)](_0x531dce['paymentGateways']):null,'gatewaySettings':_0x531dce[_0x53b6a9(0x1d5)]?JSON[_0x53b6a9(0x22c)](_0x531dce['gatewaySettings']):null,'publicKey':_0x531dce[_0x53b6a9(0x216)],'wallets':{'usdtPolygonWallet':_0x531dce[_0x53b6a9(0x245)],'usdtTrcWallet':_0x531dce[_0x53b6a9(0x24a)],'usdtErcWallet':_0x531dce[_0x53b6a9(0x22b)],'usdcPolygonWallet':_0x531dce[_0x53b6a9(0x2c2)]},'status':_0x531dce['status'],'createdAt':_0x531dce['createdAt']};}async['suspendUser'](_0x2b7c5a){const _0x1e63df=a35_0x8c2769,_0x44608a=await database_1[_0x1e63df(0x2dd)][_0x1e63df(0x251)][_0x1e63df(0x1d0)]({'where':{'id':_0x2b7c5a},'data':{'status':_0x1e63df(0x1b3)},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});return{'id':_0x44608a['id'],'fullName':_0x44608a[_0x1e63df(0x1dc)],'username':_0x44608a[_0x1e63df(0x1e6)],'telegramId':_0x44608a[_0x1e63df(0x250)],'merchantUrl':_0x44608a[_0x1e63df(0x247)],'gateways':_0x44608a[_0x1e63df(0x2dc)]?JSON[_0x1e63df(0x22c)](_0x44608a['paymentGateways']):null,'gatewaySettings':_0x44608a[_0x1e63df(0x1d5)]?JSON[_0x1e63df(0x22c)](_0x44608a[_0x1e63df(0x1d5)]):null,'publicKey':_0x44608a[_0x1e63df(0x216)],'wallets':{'usdtPolygonWallet':_0x44608a[_0x1e63df(0x245)],'usdtTrcWallet':_0x44608a[_0x1e63df(0x24a)],'usdtErcWallet':_0x44608a['usdtErcWallet'],'usdcPolygonWallet':_0x44608a[_0x1e63df(0x2c2)]},'status':_0x44608a['status'],'createdAt':_0x44608a[_0x1e63df(0x1b4)]};}async[a35_0x8c2769(0x2bf)](_0x54d493){const _0xf0e595=a35_0x8c2769,_0x31b3d8=await database_1[_0xf0e595(0x2dd)][_0xf0e595(0x251)][_0xf0e595(0x1d0)]({'where':{'id':_0x54d493},'data':{'status':'ACTIVE'},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});return{'id':_0x31b3d8['id'],'fullName':_0x31b3d8['name'],'username':_0x31b3d8[_0xf0e595(0x1e6)],'telegramId':_0x31b3d8[_0xf0e595(0x250)],'merchantUrl':_0x31b3d8['shopUrl'],'gateways':_0x31b3d8[_0xf0e595(0x2dc)]?JSON[_0xf0e595(0x22c)](_0x31b3d8[_0xf0e595(0x2dc)]):null,'gatewaySettings':_0x31b3d8[_0xf0e595(0x1d5)]?JSON[_0xf0e595(0x22c)](_0x31b3d8[_0xf0e595(0x1d5)]):null,'publicKey':_0x31b3d8[_0xf0e595(0x216)],'wallets':{'usdtPolygonWallet':_0x31b3d8[_0xf0e595(0x245)],'usdtTrcWallet':_0x31b3d8[_0xf0e595(0x24a)],'usdtErcWallet':_0x31b3d8['usdtErcWallet'],'usdcPolygonWallet':_0x31b3d8[_0xf0e595(0x2c2)]},'status':_0x31b3d8['status'],'createdAt':_0x31b3d8['createdAt']};}async[a35_0x8c2769(0x1bf)](_0x37eb35){const _0x36da5a=a35_0x8c2769,{page:_0x1fa0bb,limit:_0x1b7b64,status:_0x30e0cb}=_0x37eb35,_0xd5ded1=(_0x1fa0bb-0x1)*_0x1b7b64,_0x234e2c={};_0x30e0cb&&(_0x234e2c['status']=_0x30e0cb[_0x36da5a(0x201)]());const [_0x52b1ef,_0x3afbe3]=await Promise[_0x36da5a(0x1b6)]([database_1[_0x36da5a(0x2dd)][_0x36da5a(0x251)]['findMany']({'where':_0x234e2c,'skip':_0xd5ded1,'take':_0x1b7b64,'orderBy':{'createdAt':_0x36da5a(0x1c2)},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}}),database_1['default']['shop']['count']({'where':_0x234e2c})]);return{'users':_0x52b1ef[_0x36da5a(0x2cc)](_0x20b3d0=>{const _0x49c88c=_0x36da5a,_0x6ce7ee=_0x20b3d0['paymentGateways']?JSON[_0x49c88c(0x22c)](_0x20b3d0[_0x49c88c(0x2dc)]):null,_0x2d8f9f=_0x6ce7ee?_0x6ce7ee['map'](_0x148271=>this[_0x49c88c(0x2ae)](_0x148271)):null;return{'id':_0x20b3d0['id'],'fullName':_0x20b3d0['name'],'username':_0x20b3d0[_0x49c88c(0x1e6)],'telegramId':_0x20b3d0[_0x49c88c(0x250)],'merchantUrl':_0x20b3d0[_0x49c88c(0x247)],'gateways':_0x2d8f9f,'gatewaySettings':_0x20b3d0[_0x49c88c(0x1d5)]?JSON['parse'](_0x20b3d0['gatewaySettings']):null,'publicKey':_0x20b3d0['publicKey'],'wallets':{'usdtPolygonWallet':_0x20b3d0[_0x49c88c(0x245)],'usdtTrcWallet':_0x20b3d0[_0x49c88c(0x24a)],'usdtErcWallet':_0x20b3d0[_0x49c88c(0x22b)],'usdcPolygonWallet':_0x20b3d0['usdcPolygonWallet']},'status':_0x20b3d0[_0x49c88c(0x27c)],'createdAt':_0x20b3d0['createdAt']};}),'pagination':{'page':_0x1fa0bb,'limit':_0x1b7b64,'total':_0x3afbe3,'totalPages':Math['ceil'](_0x3afbe3/_0x1b7b64)}};}async[a35_0x8c2769(0x1bd)](_0x3fdbf3){const _0x3867f8=a35_0x8c2769,_0x475331=await database_1[_0x3867f8(0x2dd)][_0x3867f8(0x251)]['findUnique']({'where':{'id':_0x3fdbf3},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});if(!_0x475331)return null;const _0x3e5dbe=_0x475331['paymentGateways']?JSON[_0x3867f8(0x22c)](_0x475331[_0x3867f8(0x2dc)]):null,_0x490b49=_0x3e5dbe?_0x3e5dbe[_0x3867f8(0x2cc)](_0x60816c=>this['getGatewayDisplayName'](_0x60816c)):null;return _0x3e5dbe&&_0x490b49&&console[_0x3867f8(0x1ba)](_0x3867f8(0x2d5),_0x3e5dbe,'->',_0x490b49),{'id':_0x475331['id'],'fullName':_0x475331[_0x3867f8(0x1dc)],'username':_0x475331['username'],'telegramId':_0x475331[_0x3867f8(0x250)],'merchantUrl':_0x475331[_0x3867f8(0x247)],'gateways':_0x490b49,'gatewaySettings':_0x475331[_0x3867f8(0x1d5)]?JSON[_0x3867f8(0x22c)](_0x475331[_0x3867f8(0x1d5)]):null,'publicKey':_0x475331[_0x3867f8(0x216)],'wallets':{'usdtPolygonWallet':_0x475331[_0x3867f8(0x245)],'usdtTrcWallet':_0x475331['usdtTrcWallet'],'usdtErcWallet':_0x475331[_0x3867f8(0x22b)],'usdcPolygonWallet':_0x475331['usdcPolygonWallet']},'status':_0x475331[_0x3867f8(0x27c)],'createdAt':_0x475331[_0x3867f8(0x1b4)]};}async[a35_0x8c2769(0x25e)](_0x5875fc){const _0x59a7f9=a35_0x8c2769,{fullName:_0x1e0ab3,username:_0x751442,password:_0x22af46,telegramId:_0x3627bd,merchantUrl:_0x1043cd,gateways:_0x28794e,gatewaySettings:_0x3e8d48,wallets:_0x2f2864}=_0x5875fc,_0x2a7414=await database_1[_0x59a7f9(0x2dd)][_0x59a7f9(0x251)]['findUnique']({'where':{'username':_0x751442}});if(_0x2a7414)throw new Error(_0x59a7f9(0x22e));if(_0x3627bd){const _0x1f7014=await database_1[_0x59a7f9(0x2dd)][_0x59a7f9(0x251)][_0x59a7f9(0x219)]({'where':{'telegram':_0x3627bd}});if(_0x1f7014)throw new Error(_0x59a7f9(0x1cd));}const _0x2c1e0d=await bcryptjs_1[_0x59a7f9(0x2dd)][_0x59a7f9(0x27f)](_0x22af46,0xc),_0xa98148=_0x59a7f9(0x1fa)+crypto_1[_0x59a7f9(0x2dd)][_0x59a7f9(0x2b4)](0x20)[_0x59a7f9(0x292)](_0x59a7f9(0x2a8)),_0x2e5afd=_0x59a7f9(0x1d3)+crypto_1[_0x59a7f9(0x2dd)][_0x59a7f9(0x2b4)](0x20)[_0x59a7f9(0x292)](_0x59a7f9(0x2a8)),_0x11c7c1=_0x28794e?_0x28794e[_0x59a7f9(0x2cc)](_0x14bab6=>this[_0x59a7f9(0x2d3)](_0x14bab6)):null;_0x28794e&&_0x11c7c1&&console[_0x59a7f9(0x1ba)](_0x59a7f9(0x2d1),_0x28794e,'->',_0x11c7c1);const _0x31e086=await database_1[_0x59a7f9(0x2dd)][_0x59a7f9(0x251)][_0x59a7f9(0x218)]({'data':{'name':_0x1e0ab3,'username':_0x751442,'password':_0x2c1e0d,'telegram':_0x3627bd,'shopUrl':_0x1043cd,'paymentGateways':_0x11c7c1?JSON[_0x59a7f9(0x21d)](_0x11c7c1):null,'gatewaySettings':_0x3e8d48?JSON[_0x59a7f9(0x21d)](_0x3e8d48):null,'usdtPolygonWallet':_0x2f2864?.[_0x59a7f9(0x245)]||null,'usdtTrcWallet':_0x2f2864?.[_0x59a7f9(0x24a)]||null,'usdtErcWallet':_0x2f2864?.[_0x59a7f9(0x22b)]||null,'usdcPolygonWallet':_0x2f2864?.['usdcPolygonWallet']||null,'publicKey':_0xa98148,'secretKey':_0x2e5afd,'status':'ACTIVE'},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});return{'id':_0x31e086['id'],'fullName':_0x31e086[_0x59a7f9(0x1dc)],'username':_0x31e086['username'],'telegramId':_0x31e086[_0x59a7f9(0x250)],'merchantUrl':_0x31e086[_0x59a7f9(0x247)],'gateways':_0x31e086[_0x59a7f9(0x2dc)]?JSON[_0x59a7f9(0x22c)](_0x31e086['paymentGateways']):null,'gatewaySettings':_0x31e086[_0x59a7f9(0x1d5)]?JSON[_0x59a7f9(0x22c)](_0x31e086[_0x59a7f9(0x1d5)]):null,'publicKey':_0x31e086['publicKey'],'wallets':{'usdtPolygonWallet':_0x31e086[_0x59a7f9(0x245)],'usdtTrcWallet':_0x31e086['usdtTrcWallet'],'usdtErcWallet':_0x31e086[_0x59a7f9(0x22b)],'usdcPolygonWallet':_0x31e086['usdcPolygonWallet']},'status':_0x31e086[_0x59a7f9(0x27c)],'createdAt':_0x31e086[_0x59a7f9(0x1b4)]};}async[a35_0x8c2769(0x2eb)](_0x255046){const _0xb80ef6=a35_0x8c2769;await database_1[_0xb80ef6(0x2dd)][_0xb80ef6(0x251)][_0xb80ef6(0x28e)]({'where':{'id':_0x255046}});}[a35_0x8c2769(0x1da)](_0x399829,_0x4f74a2,_0x32dc56){const _0x492899=a35_0x8c2769,_0x4f493a=new Map(),_0x18cf8e=new Date(_0x4f74a2);while(_0x18cf8e<=_0x32dc56){const _0x1b4f53=_0x18cf8e[_0x492899(0x210)]()[_0x492899(0x283)]('T')[0x0];_0x4f493a[_0x492899(0x276)](_0x1b4f53,{'revenue':0x0,'count':0x0}),_0x18cf8e[_0x492899(0x203)](_0x18cf8e['getDate']()+0x1);}for(const _0x7f98bc of _0x399829){const _0x701a1d=_0x7f98bc[_0x492899(0x1b4)][_0x492899(0x210)]()[_0x492899(0x283)]('T')[0x0],_0x3eb6b6=_0x4f493a[_0x492899(0x27d)](_0x701a1d);_0x3eb6b6&&(_0x3eb6b6[_0x492899(0x271)]+=0x1,_0x7f98bc[_0x492899(0x27c)]===_0x492899(0x24b)&&(_0x7f98bc[_0x492899(0x298)]?_0x3eb6b6['revenue']+=_0x7f98bc[_0x492899(0x298)]:console[_0x492899(0x1ba)](_0x492899(0x26b)+_0x7f98bc['id']+'\x20missing\x20amountUSDT,\x20using\x20fallback\x20conversion')));}const _0x1455d6=[],_0x174905=[];for(const [_0x2b5074,_0x30a1b6]of _0x4f493a){_0x1455d6[_0x492899(0x1dd)]({'date':_0x2b5074,'amount':Math[_0x492899(0x22a)](_0x30a1b6['revenue']*0x64)/0x64}),_0x174905[_0x492899(0x1dd)]({'date':_0x2b5074,'count':_0x30a1b6[_0x492899(0x271)]});}return{'dailyRevenue':_0x1455d6,'dailyPayments':_0x174905};}}exports['AdminService']=AdminService;