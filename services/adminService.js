'use strict';const a35_0x24f24a=a35_0x365d;(function(_0xe4ea5d,_0x587b5c){const _0x19d16e=a35_0x365d,_0x3ec003=_0xe4ea5d();while(!![]){try{const _0x46876b=parseInt(_0x19d16e(0x2a0))/0x1+parseInt(_0x19d16e(0x2ba))/0x2*(parseInt(_0x19d16e(0x2be))/0x3)+parseInt(_0x19d16e(0x239))/0x4+parseInt(_0x19d16e(0x226))/0x5+parseInt(_0x19d16e(0x1d2))/0x6+-parseInt(_0x19d16e(0x1d5))/0x7*(-parseInt(_0x19d16e(0x27b))/0x8)+-parseInt(_0x19d16e(0x299))/0x9*(parseInt(_0x19d16e(0x213))/0xa);if(_0x46876b===_0x587b5c)break;else _0x3ec003['push'](_0x3ec003['shift']());}catch(_0x48d86f){_0x3ec003['push'](_0x3ec003['shift']());}}}(a35_0x85a5,0xd348e));function a35_0x365d(_0x246e9a,_0x5be8be){const _0x85a5e7=a35_0x85a5();return a35_0x365d=function(_0x365d00,_0x4d8c60){_0x365d00=_0x365d00-0x1cc;let _0xc24b04=_0x85a5e7[_0x365d00];return _0xc24b04;},a35_0x365d(_0x246e9a,_0x5be8be);}var __importDefault=this&&this[a35_0x24f24a(0x2c8)]||function(_0x4b67a8){const _0x1f9bce=a35_0x24f24a;return _0x4b67a8&&_0x4b67a8[_0x1f9bce(0x2a1)]?_0x4b67a8:{'default':_0x4b67a8};};Object['defineProperty'](exports,a35_0x24f24a(0x2a1),{'value':!![]}),exports[a35_0x24f24a(0x1cf)]=void 0x0;const database_1=__importDefault(require('../config/database')),bcryptjs_1=__importDefault(require(a35_0x24f24a(0x209))),crypto_1=__importDefault(require(a35_0x24f24a(0x23e))),currencyService_1=require(a35_0x24f24a(0x2c6)),gateway_1=require('../types/gateway');class AdminService{async[a35_0x24f24a(0x202)](){const _0x43db64=a35_0x24f24a;console[_0x43db64(0x233)](_0x43db64(0x244));const _0x499a1e=await database_1[_0x43db64(0x2b7)][_0x43db64(0x2ad)][_0x43db64(0x201)]({'_sum':{'balance':!![],'totalPaidOut':!![]},'where':{'status':_0x43db64(0x260)}}),_0x22c405=new Date(),_0x4938fc=new Date(_0x22c405[_0x43db64(0x2c0)](),_0x22c405[_0x43db64(0x1da)](),0x1),_0x48c44c=new Date(_0x22c405[_0x43db64(0x2c0)](),_0x22c405[_0x43db64(0x1da)]()+0x1,0x0,0x17,0x3b,0x3b,0x3e7),_0x10e7d0=await database_1[_0x43db64(0x2b7)][_0x43db64(0x2ae)][_0x43db64(0x201)]({'_sum':{'amount':!![]},'where':{'createdAt':{'gte':_0x4938fc,'lte':_0x48c44c},'status':_0x43db64(0x1e3)}}),_0x2b2b17=_0x499a1e[_0x43db64(0x1ed)][_0x43db64(0x2d6)]||0x0,_0xa3cb66=_0x499a1e[_0x43db64(0x1ed)][_0x43db64(0x258)]||0x0,_0x1a65ee=_0x10e7d0[_0x43db64(0x1ed)]['amount']||0x0,_0x3605a4={'totalPayout':Math[_0x43db64(0x259)](_0x2b2b17*0x64)/0x64,'awaitingPayout':Math[_0x43db64(0x259)](_0xa3cb66*0x64)/0x64,'thisMonth':Math['round'](_0x1a65ee*0x64)/0x64,'availableBalance':Math[_0x43db64(0x259)](_0xa3cb66*0x64)/0x64};return console[_0x43db64(0x233)](_0x43db64(0x2bf)),console[_0x43db64(0x233)]('\x20\x20\x20💰\x20Total\x20payout:\x20'+_0x3605a4[_0x43db64(0x206)]+_0x43db64(0x215)),console[_0x43db64(0x233)]('\x20\x20\x20⏳\x20Awaiting\x20payout:\x20'+_0x3605a4[_0x43db64(0x1fa)]+'\x20USDT\x20(total\x20merchant\x20balances)'),console[_0x43db64(0x233)](_0x43db64(0x27c)+_0x3605a4[_0x43db64(0x217)]+_0x43db64(0x29e)),console[_0x43db64(0x233)](_0x43db64(0x23f)+_0x3605a4[_0x43db64(0x2d3)]+_0x43db64(0x1d9)),_0x3605a4;}async[a35_0x24f24a(0x241)](_0x527d03,_0x359606){const _0x3b974c=a35_0x24f24a;console['log'](_0x3b974c(0x2b6)+_0x527d03+':',_0x359606);const _0x140100=await database_1[_0x3b974c(0x2b7)][_0x3b974c(0x1db)][_0x3b974c(0x27e)]({'where':{'id':_0x527d03},'select':{'id':!![],'customerEmail':!![],'customerName':!![],'customerCountry':!![],'customerIp':!![],'customerUa':!![]}});if(!_0x140100)throw new Error(_0x3b974c(0x24e));const _0x46c14c={};_0x359606[_0x3b974c(0x238)]!==undefined&&(_0x46c14c['customerCountry']=_0x359606[_0x3b974c(0x238)]||null);_0x359606[_0x3b974c(0x1fe)]!==undefined&&(_0x46c14c[_0x3b974c(0x1fe)]=_0x359606[_0x3b974c(0x1fe)]||null);_0x359606[_0x3b974c(0x2c3)]!==undefined&&(_0x46c14c['customerUa']=_0x359606[_0x3b974c(0x2c3)]||null);const _0x270dc0=await database_1['default']['payment'][_0x3b974c(0x28e)]({'where':{'id':_0x527d03},'data':{..._0x46c14c,'updatedAt':new Date()},'select':{'id':!![],'customerEmail':!![],'customerName':!![],'customerCountry':!![],'customerIp':!![],'customerUa':!![],'updatedAt':!![]}});return console[_0x3b974c(0x233)](_0x3b974c(0x1f4)+_0x527d03),console[_0x3b974c(0x233)](_0x3b974c(0x2ce)+_0x140100[_0x3b974c(0x238)]+_0x3b974c(0x210)+_0x270dc0['customerCountry']),console[_0x3b974c(0x233)](_0x3b974c(0x24a)+_0x140100[_0x3b974c(0x1fe)]+_0x3b974c(0x210)+_0x270dc0['customerIp']),console[_0x3b974c(0x233)]('\x20\x20\x20🖥️\x20User\x20Agent:\x20'+(_0x140100[_0x3b974c(0x2c3)]?_0x3b974c(0x1ea):_0x3b974c(0x22a))+_0x3b974c(0x210)+(_0x270dc0[_0x3b974c(0x2c3)]?_0x3b974c(0x1ea):_0x3b974c(0x22a))),_0x270dc0;}async[a35_0x24f24a(0x261)](_0x25d036){const _0x2e77df=a35_0x24f24a,_0x4daf02=new Date();let _0x1f4a13;switch(_0x25d036){case'7d':_0x1f4a13=new Date(_0x4daf02[_0x2e77df(0x1ee)]()-0x7*0x18*0x3c*0x3c*0x3e8);break;case'30d':_0x1f4a13=new Date(_0x4daf02[_0x2e77df(0x1ee)]()-0x1e*0x18*0x3c*0x3c*0x3e8);break;case _0x2e77df(0x228):_0x1f4a13=new Date(_0x4daf02[_0x2e77df(0x1ee)]()-0x5a*0x18*0x3c*0x3c*0x3e8);break;case'all':const _0x48fc4a=await database_1['default'][_0x2e77df(0x1db)][_0x2e77df(0x29b)]({'where':{'gateway':{'not':_0x2e77df(0x211)}},'orderBy':{'createdAt':_0x2e77df(0x204)},'select':{'createdAt':!![]}});_0x1f4a13=_0x48fc4a?_0x48fc4a[_0x2e77df(0x1f5)]:new Date(_0x2e77df(0x26c)),console[_0x2e77df(0x233)](_0x2e77df(0x2a4)+_0x1f4a13['toISOString']());break;default:_0x1f4a13=new Date(_0x4daf02[_0x2e77df(0x1ee)]()-0x1e*0x18*0x3c*0x3c*0x3e8);}const [_0x5a42d5,_0x5d4e0e,_0xef4993,_0x3d42bc,_0x329ca5,_0x525981,_0x53321f]=await Promise['all']([database_1[_0x2e77df(0x2b7)][_0x2e77df(0x2ad)][_0x2e77df(0x269)](),database_1['default'][_0x2e77df(0x2ad)][_0x2e77df(0x269)]({'where':{'status':_0x2e77df(0x260)}}),database_1[_0x2e77df(0x2b7)]['payment'][_0x2e77df(0x269)]({'where':{'createdAt':{'gte':_0x1f4a13},'gateway':{'not':_0x2e77df(0x211)}}}),database_1['default'][_0x2e77df(0x1db)][_0x2e77df(0x269)]({'where':{'status':'PAID','createdAt':{'gte':_0x1f4a13},'gateway':{'not':_0x2e77df(0x211)}}}),database_1[_0x2e77df(0x2b7)]['payment'][_0x2e77df(0x22c)]({'where':{'status':'PAID','createdAt':{'gte':_0x1f4a13},'gateway':{'not':_0x2e77df(0x211)}},'select':{'amount':!![],'currency':!![]}}),database_1['default'][_0x2e77df(0x1db)]['findMany']({'where':{'gateway':{'not':_0x2e77df(0x211)}},'take':0xa,'orderBy':{'createdAt':_0x2e77df(0x26a)},'include':{'shop':{'select':{'name':!![],'username':!![]}}}}),database_1['default'][_0x2e77df(0x1db)][_0x2e77df(0x22c)]({'where':{'createdAt':{'gte':_0x1f4a13},'gateway':{'not':'test_gateway'}},'select':{'amount':!![],'currency':!![],'status':!![],'amountUSDT':!![],'createdAt':!![]}})]);let _0x4da980=0x0;for(const _0x192cfe of _0x329ca5){const _0x48101b=await currencyService_1[_0x2e77df(0x20e)][_0x2e77df(0x2cb)](_0x192cfe[_0x2e77df(0x25e)],_0x192cfe[_0x2e77df(0x2aa)]);_0x4da980+=_0x48101b;}const _0x5c806b=this[_0x2e77df(0x2b8)](_0x53321f,_0x1f4a13,_0x4daf02),_0x11ba3b=_0xef4993>0x0?_0x3d42bc/_0xef4993*0x64:0x0;return{'totalShops':_0x5a42d5,'activeShops':_0x5d4e0e,'totalPayments':_0xef4993,'successfulPayments':_0x3d42bc,'totalRevenue':Math['round'](_0x4da980*0x64)/0x64,'conversionRate':Math[_0x2e77df(0x259)](_0x11ba3b*0x64)/0x64,'dailyRevenue':_0x5c806b[_0x2e77df(0x1f9)],'dailyPayments':_0x5c806b[_0x2e77df(0x27a)],'recentPayments':_0x525981[_0x2e77df(0x297)](_0x5c2f81=>({'id':_0x5c2f81['id'],'amount':_0x5c2f81[_0x2e77df(0x25e)],'currency':_0x5c2f81['currency'],'status':_0x5c2f81[_0x2e77df(0x276)],'gateway':_0x5c2f81['gateway'],'shop':_0x5c2f81[_0x2e77df(0x2ad)],'createdAt':_0x5c2f81[_0x2e77df(0x1f5)]}))};}async[a35_0x24f24a(0x1df)](_0x3fa169){const _0x3d5914=a35_0x24f24a;console[_0x3d5914(0x233)](_0x3d5914(0x2c1),_0x3fa169);let _0x131ed0,_0x394c0c=new Date();if(_0x3fa169[_0x3d5914(0x25b)]===_0x3d5914(0x229)&&_0x3fa169[_0x3d5914(0x23d)]&&_0x3fa169[_0x3d5914(0x218)])_0x131ed0=new Date(_0x3fa169[_0x3d5914(0x23d)]),_0x394c0c=new Date(_0x3fa169['dateTo']);else{const _0x55219d=new Date();switch(_0x3fa169[_0x3d5914(0x25b)]){case _0x3d5914(0x231):_0x131ed0=new Date(_0x55219d['getTime']()-0x7*0x18*0x3c*0x3c*0x3e8);break;case'month':_0x131ed0=new Date(_0x55219d[_0x3d5914(0x1ee)]()-0x1e*0x18*0x3c*0x3c*0x3e8);break;case _0x3d5914(0x242):_0x131ed0=new Date(_0x55219d['getTime']()-0x16d*0x18*0x3c*0x3c*0x3e8);break;case _0x3d5914(0x20d):default:_0x131ed0=new Date(_0x3d5914(0x26c));break;}}console[_0x3d5914(0x233)](_0x3d5914(0x245)+_0x131ed0[_0x3d5914(0x2d5)]()+_0x3d5914(0x1d4)+_0x394c0c[_0x3d5914(0x2d5)]());const _0x349b41={'status':'PAID','gateway':{'not':'test_gateway'},'paidAt':{'gte':_0x131ed0,'lte':_0x394c0c}};_0x3fa169[_0x3d5914(0x2d9)]&&(_0x349b41[_0x3d5914(0x2d9)]=_0x3fa169['shopId']);const _0x50abbe=await database_1['default'][_0x3d5914(0x1db)][_0x3d5914(0x22c)]({'where':_0x349b41,'include':{'shop':{'select':{'id':!![],'name':!![],'username':!![],'gatewaySettings':!![]}}}});console[_0x3d5914(0x233)]('💰\x20Found\x20'+_0x50abbe[_0x3d5914(0x1f0)]+'\x20paid\x20payments\x20for\x20analysis');const _0x57fb6b={'gateway':{'not':_0x3d5914(0x211)},'createdAt':{'gte':_0x131ed0,'lte':_0x394c0c}};_0x3fa169[_0x3d5914(0x2d9)]&&(_0x57fb6b['shopId']=_0x3fa169[_0x3d5914(0x2d9)]);const _0x15cd0a=await database_1[_0x3d5914(0x2b7)][_0x3d5914(0x1db)]['count']({'where':_0x57fb6b});console[_0x3d5914(0x233)](_0x3d5914(0x24d)+_0x15cd0a+_0x3d5914(0x255)+_0x50abbe[_0x3d5914(0x1f0)]);let _0x17bb1b=0x0,_0x1d5b64=0x0,_0x27d9de=0x0;const _0x18a2af={},_0x3a71a4={},_0x5d7c2d={};for(const _0x186250 of _0x50abbe){try{const _0x1db6eb=await currencyService_1[_0x3d5914(0x20e)][_0x3d5914(0x2cb)](_0x186250[_0x3d5914(0x25e)],_0x186250[_0x3d5914(0x2aa)]);let _0x5f085e={};if(_0x186250[_0x3d5914(0x2ad)][_0x3d5914(0x254)])try{_0x5f085e=JSON[_0x3d5914(0x22b)](_0x186250[_0x3d5914(0x2ad)][_0x3d5914(0x254)]);}catch(_0xa5dbd){console[_0x3d5914(0x1e8)]('Error\x20parsing\x20gateway\x20settings\x20for\x20shop\x20'+_0x186250['shopId']+':',_0xa5dbd);}let _0x4e75d6={},_0x109a4b=0xa;for(const [_0x43194b,_0x57f4fc]of Object[_0x3d5914(0x1f1)](_0x5f085e)){if(_0x43194b[_0x3d5914(0x246)]()===_0x186250[_0x3d5914(0x2cc)][_0x3d5914(0x246)]()){_0x4e75d6=_0x57f4fc,_0x109a4b=_0x57f4fc[_0x3d5914(0x222)]||0xa;break;}}const _0x3c77f6=_0x1db6eb*(_0x109a4b/0x64),_0x41284b=_0x1db6eb-_0x3c77f6;_0x17bb1b+=_0x1db6eb,_0x1d5b64+=_0x41284b,_0x27d9de+=_0x3c77f6;!_0x18a2af[_0x186250[_0x3d5914(0x2cc)]]&&(_0x18a2af[_0x186250[_0x3d5914(0x2cc)]]={'gateway':_0x186250['gateway'],'gatewayDisplayName':this[_0x3d5914(0x26f)](_0x186250[_0x3d5914(0x2cc)]),'paymentsCount':0x0,'turnoverUSDT':0x0,'commissionUSDT':0x0,'merchantEarningsUSDT':0x0,'totalCommissionRate':0x0});_0x18a2af[_0x186250[_0x3d5914(0x2cc)]]['paymentsCount']++,_0x18a2af[_0x186250[_0x3d5914(0x2cc)]][_0x3d5914(0x21b)]+=_0x1db6eb,_0x18a2af[_0x186250['gateway']][_0x3d5914(0x221)]+=_0x3c77f6,_0x18a2af[_0x186250[_0x3d5914(0x2cc)]]['merchantEarningsUSDT']+=_0x41284b,_0x18a2af[_0x186250['gateway']][_0x3d5914(0x2c4)]+=_0x109a4b;!_0x3fa169[_0x3d5914(0x2d9)]&&(!_0x3a71a4[_0x186250[_0x3d5914(0x2d9)]]&&(_0x3a71a4[_0x186250[_0x3d5914(0x2d9)]]={'shopId':_0x186250[_0x3d5914(0x2d9)],'shopName':_0x186250[_0x3d5914(0x2ad)][_0x3d5914(0x248)],'shopUsername':_0x186250[_0x3d5914(0x2ad)][_0x3d5914(0x1eb)],'paymentsCount':0x0,'turnoverUSDT':0x0,'commissionUSDT':0x0,'merchantEarningsUSDT':0x0,'paidOutUSDT':0x0,'averageCheckUSDT':0x0}),_0x3a71a4[_0x186250[_0x3d5914(0x2d9)]][_0x3d5914(0x2c7)]++,_0x3a71a4[_0x186250[_0x3d5914(0x2d9)]]['turnoverUSDT']+=_0x1db6eb,_0x3a71a4[_0x186250[_0x3d5914(0x2d9)]][_0x3d5914(0x221)]+=_0x3c77f6,_0x3a71a4[_0x186250[_0x3d5914(0x2d9)]][_0x3d5914(0x200)]+=_0x41284b);const _0x1ae3a7=_0x186250['paidAt'][_0x3d5914(0x2d5)]()[_0x3d5914(0x22d)]('T')[0x0];!_0x5d7c2d[_0x1ae3a7]&&(_0x5d7c2d[_0x1ae3a7]={'date':_0x1ae3a7,'turnover':0x0,'merchantEarnings':0x0,'gatewayEarnings':0x0,'paymentsCount':0x0}),_0x5d7c2d[_0x1ae3a7][_0x3d5914(0x286)]+=_0x1db6eb,_0x5d7c2d[_0x1ae3a7]['merchantEarnings']+=_0x41284b,_0x5d7c2d[_0x1ae3a7][_0x3d5914(0x1d0)]+=_0x3c77f6,_0x5d7c2d[_0x1ae3a7]['paymentsCount']++;}catch(_0x4ff44c){console['error'](_0x3d5914(0x1f2)+_0x186250['id']+':',_0x4ff44c);}}Object[_0x3d5914(0x28d)](_0x18a2af)[_0x3d5914(0x298)](_0x295a96=>{const _0x1c637c=_0x3d5914;_0x295a96[_0x1c637c(0x227)]=_0x295a96['paymentsCount']>0x0?_0x295a96[_0x1c637c(0x2c4)]/_0x295a96['paymentsCount']:0x0,delete _0x295a96['totalCommissionRate'];}),Object['values'](_0x3a71a4)[_0x3d5914(0x298)](_0x3a735e=>{const _0x17409c=_0x3d5914;_0x3a735e[_0x17409c(0x234)]=_0x3a735e[_0x17409c(0x2c7)]>0x0?_0x3a735e[_0x17409c(0x21b)]/_0x3a735e[_0x17409c(0x2c7)]:0x0;});let _0x5224d2=0x0;if(_0x3fa169['shopId']){const _0x58c11a=await database_1['default'][_0x3d5914(0x2ae)][_0x3d5914(0x22c)]({'where':{'shopId':_0x3fa169[_0x3d5914(0x2d9)],'status':'COMPLETED','createdAt':{'gte':_0x131ed0,'lte':_0x394c0c}},'select':{'amount':!![]}});_0x5224d2=_0x58c11a[_0x3d5914(0x264)]((_0x44c782,_0x433160)=>_0x44c782+_0x433160[_0x3d5914(0x25e)],0x0);}const _0x10d562=_0x15cd0a,_0x524832=_0x50abbe[_0x3d5914(0x1f0)],_0x30fe5e=_0x524832>0x0?_0x17bb1b/_0x524832:0x0,_0x25ef7d=_0x10d562>0x0?Math['round'](_0x524832/_0x10d562*0x2710)/0x64:0x0,_0x38180f=Math[_0x3d5914(0x20c)]((_0x394c0c[_0x3d5914(0x1ee)]()-_0x131ed0[_0x3d5914(0x1ee)]())/(0x3e8*0x3c*0x3c*0x18)),_0x19c93f={'totalTurnover':Math[_0x3d5914(0x259)](_0x17bb1b*0x64)/0x64,'merchantEarnings':Math['round'](_0x1d5b64*0x64)/0x64,'gatewayEarnings':Math[_0x3d5914(0x259)](_0x27d9de*0x64)/0x64,'totalPaidOut':Math[_0x3d5914(0x259)](_0x5224d2*0x64)/0x64,'averageCheck':Math[_0x3d5914(0x259)](_0x30fe5e*0x64)/0x64,'totalPayments':_0x10d562,'successfulPayments':_0x524832,'conversionRate':_0x25ef7d,'gatewayBreakdown':Object[_0x3d5914(0x28d)](_0x18a2af)[_0x3d5914(0x297)](_0x227d62=>({..._0x227d62,'turnoverUSDT':Math['round'](_0x227d62['turnoverUSDT']*0x64)/0x64,'commissionUSDT':Math[_0x3d5914(0x259)](_0x227d62[_0x3d5914(0x221)]*0x64)/0x64,'merchantEarningsUSDT':Math['round'](_0x227d62['merchantEarningsUSDT']*0x64)/0x64,'averageCommissionRate':Math[_0x3d5914(0x259)](_0x227d62[_0x3d5914(0x227)]*0x64)/0x64})),'merchantBreakdown':_0x3fa169[_0x3d5914(0x2d9)]?undefined:Object[_0x3d5914(0x28d)](_0x3a71a4)['map'](_0x97c6c3=>({..._0x97c6c3,'turnoverUSDT':Math[_0x3d5914(0x259)](_0x97c6c3[_0x3d5914(0x21b)]*0x64)/0x64,'commissionUSDT':Math[_0x3d5914(0x259)](_0x97c6c3[_0x3d5914(0x221)]*0x64)/0x64,'merchantEarningsUSDT':Math[_0x3d5914(0x259)](_0x97c6c3[_0x3d5914(0x200)]*0x64)/0x64,'paidOutUSDT':Math[_0x3d5914(0x259)](_0x97c6c3[_0x3d5914(0x281)]*0x64)/0x64,'averageCheckUSDT':Math[_0x3d5914(0x259)](_0x97c6c3[_0x3d5914(0x234)]*0x64)/0x64})),'dailyData':Object['values'](_0x5d7c2d)[_0x3d5914(0x297)](_0xfcd32c=>({..._0xfcd32c,'turnover':Math[_0x3d5914(0x259)](_0xfcd32c[_0x3d5914(0x286)]*0x64)/0x64,'merchantEarnings':Math['round'](_0xfcd32c[_0x3d5914(0x271)]*0x64)/0x64,'gatewayEarnings':Math['round'](_0xfcd32c[_0x3d5914(0x1d0)]*0x64)/0x64}))[_0x3d5914(0x1ec)]((_0xc3767b,_0x51053e)=>_0xc3767b[_0x3d5914(0x21e)][_0x3d5914(0x28b)](_0x51053e[_0x3d5914(0x21e)])),'periodInfo':{'from':_0x131ed0,'to':_0x394c0c,'periodType':_0x3fa169[_0x3d5914(0x25b)]||_0x3d5914(0x229),'daysCount':_0x38180f}};return console[_0x3d5914(0x233)]('📊\x20Merchant\x20statistics\x20calculated:'),console[_0x3d5914(0x233)](_0x3d5914(0x289)+_0x19c93f[_0x3d5914(0x237)]+_0x3d5914(0x1d9)),console[_0x3d5914(0x233)](_0x3d5914(0x273)+_0x19c93f['merchantEarnings']+_0x3d5914(0x1d9)),console[_0x3d5914(0x233)](_0x3d5914(0x275)+_0x19c93f['gatewayEarnings']+_0x3d5914(0x1d9)),console[_0x3d5914(0x233)](_0x3d5914(0x2a7)+_0x19c93f['totalPayments']),_0x19c93f;}async[a35_0x24f24a(0x1de)](){const _0x43dc9d=a35_0x24f24a;console[_0x43dc9d(0x233)](_0x43dc9d(0x216));const _0x21e34b=await database_1[_0x43dc9d(0x2b7)][_0x43dc9d(0x2ad)][_0x43dc9d(0x22c)]({'where':{'status':_0x43dc9d(0x260)},'select':{'id':!![],'username':!![],'name':!![]},'orderBy':{'name':_0x43dc9d(0x204)}});return console[_0x43dc9d(0x233)](_0x43dc9d(0x29d)+_0x21e34b['length']+_0x43dc9d(0x277)),_0x21e34b[_0x43dc9d(0x297)](_0x5998aa=>({'id':_0x5998aa['id'],'username':_0x5998aa['username'],'name':_0x5998aa[_0x43dc9d(0x248)]}));}['getGatewayDisplayName'](_0x1ff1b4){const _0x3d4c4c=a35_0x24f24a,_0x3aff42={'test_gateway':'Test\x20Gateway','plisio':_0x3d4c4c(0x2a3),'rapyd':_0x3d4c4c(0x293),'noda':_0x3d4c4c(0x2cd),'cointopay':_0x3d4c4c(0x1d8),'klyme_eu':'KLYME\x20EU','klyme_gb':_0x3d4c4c(0x2a6),'klyme_de':_0x3d4c4c(0x29f)};return _0x3aff42[_0x1ff1b4]||_0x1ff1b4;}async[a35_0x24f24a(0x24f)](_0xe5ef17){const _0x4fcf32=a35_0x24f24a,{page:_0x566879,limit:_0x458522,minAmount:_0x2e04d9,search:_0x2a99f6}=_0xe5ef17,_0x2395c7=(_0x566879-0x1)*_0x458522;console[_0x4fcf32(0x233)](_0x4fcf32(0x2d7),_0xe5ef17);const _0x146732={'balance':{'gt':0x0},'status':_0x4fcf32(0x260)};_0x2e04d9&&(_0x146732[_0x4fcf32(0x258)][_0x4fcf32(0x1f8)]=_0x2e04d9);_0x2a99f6&&(_0x146732['OR']=[{'name':{'contains':_0x2a99f6,'mode':_0x4fcf32(0x26e)}},{'username':{'contains':_0x2a99f6,'mode':_0x4fcf32(0x26e)}}]);const [_0x248409,_0xc8a027]=await Promise['all']([database_1[_0x4fcf32(0x2b7)][_0x4fcf32(0x2ad)][_0x4fcf32(0x22c)]({'where':_0x146732,'skip':_0x2395c7,'take':_0x458522,'orderBy':{'balance':_0x4fcf32(0x26a)},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'balance':!![],'totalPaidOut':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'gatewaySettings':!![],'createdAt':!![]}}),database_1[_0x4fcf32(0x2b7)]['shop'][_0x4fcf32(0x269)]({'where':_0x146732})]);console[_0x4fcf32(0x233)]('💰\x20Found\x20'+_0x248409[_0x4fcf32(0x1f0)]+'\x20merchants\x20with\x20positive\x20balance');const _0x4de26d=await Promise[_0x4fcf32(0x20d)](_0x248409[_0x4fcf32(0x297)](async _0x4876e6=>{const _0x3cd811=_0x4fcf32,[_0x5eb9fb,_0x3ccea8,_0x385c97]=await Promise[_0x3cd811(0x20d)]([database_1['default'][_0x3cd811(0x1db)][_0x3cd811(0x269)]({'where':{'shopId':_0x4876e6['id'],'status':_0x3cd811(0x1e2),'amountUSDT':{'not':null}}}),database_1[_0x3cd811(0x2b7)]['payment']['findFirst']({'where':{'shopId':_0x4876e6['id'],'status':'PAID','amountUSDT':{'not':null}},'orderBy':{'paidAt':'asc'},'select':{'paidAt':!![]}}),database_1[_0x3cd811(0x2b7)]['payment']['groupBy']({'by':[_0x3cd811(0x2cc)],'where':{'shopId':_0x4876e6['id'],'status':_0x3cd811(0x1e2),'amountUSDT':{'not':null}},'_count':{'id':!![]},'_sum':{'amountUSDT':!![]}})]),_0x2abb40=await Promise[_0x3cd811(0x20d)](_0x385c97[_0x3cd811(0x297)](async _0xcc9286=>{const _0x16f576=_0x3cd811;let _0x54bb37=0xa;if(_0x4876e6['gatewaySettings'])try{const _0x515665=JSON['parse'](_0x4876e6[_0x16f576(0x254)]);for(const [_0x4170db,_0x4c1237]of Object[_0x16f576(0x1f1)](_0x515665)){if(_0x4170db[_0x16f576(0x246)]()===_0xcc9286[_0x16f576(0x2cc)]['toLowerCase']()){_0x54bb37=_0x4c1237[_0x16f576(0x222)]||0xa,console['log'](_0x16f576(0x252)+_0xcc9286[_0x16f576(0x2cc)]+_0x16f576(0x23b)+_0x4876e6['id']+_0x16f576(0x253)+_0x54bb37+'%');break;}}}catch(_0x1a6967){console[_0x16f576(0x1e8)](_0x16f576(0x2d8)+_0x4876e6['id']+':',_0x1a6967);}const _0x273bad=_0xcc9286[_0x16f576(0x1ed)][_0x16f576(0x28c)]||0x0,_0x286823=_0x273bad*(0x1-_0x54bb37/0x64);return{'gateway':_0xcc9286['gateway'],'count':_0xcc9286[_0x16f576(0x1fd)]['id'],'amountUSDT':Math[_0x16f576(0x259)](_0x273bad*0x64)/0x64,'amountAfterCommissionUSDT':Math[_0x16f576(0x259)](_0x286823*0x64)/0x64,'commission':_0x54bb37};})),_0x562979=_0x2abb40[_0x3cd811(0x264)]((_0xa8ff63,_0x1a57b6)=>_0xa8ff63+_0x1a57b6[_0x3cd811(0x28c)],0x0),_0x4d4c9b=_0x2abb40[_0x3cd811(0x264)]((_0x31ec3f,_0x572fbd)=>_0x31ec3f+_0x572fbd[_0x3cd811(0x2c5)],0x0);return{'id':_0x4876e6['id'],'fullName':_0x4876e6[_0x3cd811(0x248)],'username':_0x4876e6[_0x3cd811(0x1eb)],'telegramId':_0x4876e6[_0x3cd811(0x29a)],'merchantUrl':_0x4876e6['shopUrl'],'wallets':{'usdtPolygonWallet':_0x4876e6['usdtPolygonWallet'],'usdtTrcWallet':_0x4876e6['usdtTrcWallet'],'usdtErcWallet':_0x4876e6[_0x3cd811(0x1d6)],'usdcPolygonWallet':_0x4876e6[_0x3cd811(0x20f)]},'totalAmountUSDT':Math['round'](_0x562979*0x64)/0x64,'totalAmountAfterCommissionUSDT':Math[_0x3cd811(0x259)](_0x4d4c9b*0x64)/0x64,'paymentsCount':_0x5eb9fb,'oldestPaymentDate':_0x3ccea8?.[_0x3cd811(0x20a)]||_0x4876e6[_0x3cd811(0x1f5)],'gatewayBreakdown':_0x2abb40};})),_0x241b80=_0x4de26d[_0x4fcf32(0x264)]((_0x6f8343,_0x3169bd)=>_0x6f8343+_0x3169bd[_0x4fcf32(0x2b1)],0x0),_0x50d9f3=_0x4de26d[_0x4fcf32(0x264)]((_0x90d2e6,_0x375c48)=>_0x90d2e6+_0x375c48[_0x4fcf32(0x2a2)],0x0);return console['log'](_0x4fcf32(0x240)+_0xc8a027+_0x4fcf32(0x23c)+Math['round'](_0x50d9f3*0x64)/0x64+'\x20USDT\x20total'),{'merchants':_0x4de26d,'pagination':{'page':_0x566879,'limit':_0x458522,'total':_0xc8a027,'totalPages':Math[_0x4fcf32(0x20c)](_0xc8a027/_0x458522)},'summary':{'totalMerchants':_0xc8a027,'totalAmountUSDT':Math[_0x4fcf32(0x259)](_0x241b80*0x64)/0x64,'totalAmountAfterCommissionUSDT':Math['round'](_0x50d9f3*0x64)/0x64}};}async[a35_0x24f24a(0x26b)](_0x38d7ae){const _0x37f62c=a35_0x24f24a,{shopId:_0x4c8d80,amount:_0x362b06,network:_0x1701b6,wallet:_0x1b7017,notes:_0x3fe33e,txid:_0x3656a3,periodFrom:_0x5aa7b7,periodTo:_0x20e06c}=_0x38d7ae,_0x11805e=await database_1[_0x37f62c(0x2b7)][_0x37f62c(0x2b5)](async _0x5c4868=>{const _0x5b85b7=_0x37f62c,_0x473bdb=await _0x5c4868[_0x5b85b7(0x2ad)][_0x5b85b7(0x27e)]({'where':{'id':_0x4c8d80},'select':{'id':!![],'name':!![],'username':!![],'balance':!![],'totalPaidOut':!![]}});if(!_0x473bdb)throw new Error(_0x5b85b7(0x2c2));console['log'](_0x5b85b7(0x1e7)+_0x473bdb[_0x5b85b7(0x1eb)]+':'),console['log'](_0x5b85b7(0x249)+_0x473bdb[_0x5b85b7(0x258)][_0x5b85b7(0x1cc)](0x6)+_0x5b85b7(0x1d9)),console[_0x5b85b7(0x233)](_0x5b85b7(0x1f7)+_0x362b06['toFixed'](0x6)+'\x20USDT'),console[_0x5b85b7(0x233)]('\x20\x20\x20Current\x20total\x20paid\x20out:\x20'+_0x473bdb[_0x5b85b7(0x2d6)][_0x5b85b7(0x1cc)](0x6)+'\x20USDT');if(_0x3656a3)console[_0x5b85b7(0x233)](_0x5b85b7(0x278)+_0x3656a3);if(_0x473bdb[_0x5b85b7(0x258)]<_0x362b06)throw new Error(_0x5b85b7(0x280)+_0x473bdb[_0x5b85b7(0x258)][_0x5b85b7(0x1cc)](0x6)+_0x5b85b7(0x2d4)+_0x362b06[_0x5b85b7(0x1cc)](0x6)+'\x20USDT');let _0x1b5019=_0x1b7017;if(!_0x1b5019){const _0x365f80=await _0x5c4868['shop'][_0x5b85b7(0x27e)]({'where':{'id':_0x4c8d80},'select':{'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![]}});if(_0x365f80)switch(_0x1701b6){case _0x5b85b7(0x2bd):_0x1b5019=_0x365f80[_0x5b85b7(0x2ca)]||undefined;break;case _0x5b85b7(0x26d):_0x1b5019=_0x365f80[_0x5b85b7(0x256)]||undefined;break;case _0x5b85b7(0x235):_0x1b5019=_0x365f80[_0x5b85b7(0x1d6)]||undefined;break;case'polygon_usdc':_0x1b5019=_0x365f80[_0x5b85b7(0x20f)]||undefined;break;}}console[_0x5b85b7(0x233)]('💳\x20Payout\x20wallet\x20for\x20'+_0x1701b6+':\x20'+(_0x1b5019||'not\x20specified'));const _0x296630=await _0x5c4868[_0x5b85b7(0x2ae)][_0x5b85b7(0x1ce)]({'data':{'shopId':_0x4c8d80,'amount':_0x362b06,'network':_0x1701b6,'status':'COMPLETED','txid':_0x3656a3,'notes':_0x3fe33e,'periodFrom':_0x5aa7b7?new Date(_0x5aa7b7):null,'periodTo':_0x20e06c?new Date(_0x20e06c):null,'createdAt':new Date(),'paidAt':new Date()}}),_0x3196c2=_0x473bdb[_0x5b85b7(0x258)]-_0x362b06,_0x205f92=_0x473bdb['totalPaidOut']+_0x362b06;return await _0x5c4868['shop'][_0x5b85b7(0x28e)]({'where':{'id':_0x4c8d80},'data':{'balance':_0x3196c2,'totalPaidOut':_0x205f92}}),console['log'](_0x5b85b7(0x27d)+_0x473bdb[_0x5b85b7(0x1eb)]+_0x5b85b7(0x236)),console[_0x5b85b7(0x233)](_0x5b85b7(0x1fb)+_0x473bdb[_0x5b85b7(0x258)][_0x5b85b7(0x1cc)](0x6)+_0x5b85b7(0x210)+_0x3196c2[_0x5b85b7(0x1cc)](0x6)+'\x20USDT\x20(-'+_0x362b06['toFixed'](0x6)+')'),console[_0x5b85b7(0x233)]('\x20\x20\x20Total\x20paid\x20out:\x20'+_0x473bdb[_0x5b85b7(0x2d6)][_0x5b85b7(0x1cc)](0x6)+_0x5b85b7(0x210)+_0x205f92['toFixed'](0x6)+_0x5b85b7(0x224)+_0x362b06[_0x5b85b7(0x1cc)](0x6)+')'),{'payout':_0x296630,'shop':_0x473bdb};});return console[_0x37f62c(0x233)](_0x37f62c(0x1ef)+_0x11805e['payout']['id']+_0x37f62c(0x23b)+_0x11805e['shop'][_0x37f62c(0x1eb)]+'\x20('+_0x362b06+_0x37f62c(0x24b)),{'id':_0x11805e[_0x37f62c(0x2ae)]['id'],'shopId':_0x11805e[_0x37f62c(0x2ae)][_0x37f62c(0x2d9)],'shopName':_0x11805e[_0x37f62c(0x2ad)][_0x37f62c(0x248)],'shopUsername':_0x11805e[_0x37f62c(0x2ad)][_0x37f62c(0x1eb)],'amount':_0x11805e[_0x37f62c(0x2ae)][_0x37f62c(0x25e)],'network':_0x11805e['payout'][_0x37f62c(0x288)],'status':_0x11805e['payout']['status'],'txid':_0x11805e[_0x37f62c(0x2ae)][_0x37f62c(0x2a9)],'notes':_0x11805e[_0x37f62c(0x2ae)]['notes'],'periodFrom':_0x11805e[_0x37f62c(0x2ae)][_0x37f62c(0x295)],'periodTo':_0x11805e[_0x37f62c(0x2ae)][_0x37f62c(0x2cf)],'createdAt':_0x11805e[_0x37f62c(0x2ae)]['createdAt'],'paidAt':_0x11805e[_0x37f62c(0x2ae)][_0x37f62c(0x20a)]};}async['getAllPayouts'](_0x556bea){const _0x4f26c1=a35_0x24f24a,{page:_0x1ab274,limit:_0x4f9aeb,shopId:_0x512c23,network:_0x1ce3e9,dateFrom:_0x46ed98,dateTo:_0x287715,search:_0x5c3ade}=_0x556bea,_0x20a0c4=(_0x1ab274-0x1)*_0x4f9aeb,_0x2a7983={};_0x512c23&&(_0x2a7983[_0x4f26c1(0x2d9)]=_0x512c23);_0x1ce3e9&&(_0x2a7983[_0x4f26c1(0x288)]=_0x1ce3e9);(_0x46ed98||_0x287715)&&(_0x2a7983[_0x4f26c1(0x1f5)]={},_0x46ed98&&(_0x2a7983[_0x4f26c1(0x1f5)][_0x4f26c1(0x1f8)]=new Date(_0x46ed98)),_0x287715&&(_0x2a7983['createdAt'][_0x4f26c1(0x1d3)]=new Date(_0x287715)));_0x5c3ade&&(_0x2a7983['OR']=[{'shop':{'name':{'contains':_0x5c3ade,'mode':_0x4f26c1(0x26e)}}},{'shop':{'username':{'contains':_0x5c3ade,'mode':_0x4f26c1(0x26e)}}},{'notes':{'contains':_0x5c3ade,'mode':_0x4f26c1(0x26e)}}]);const [_0x559dbd,_0x3bb788]=await Promise['all']([database_1[_0x4f26c1(0x2b7)][_0x4f26c1(0x2ae)][_0x4f26c1(0x22c)]({'where':_0x2a7983,'skip':_0x20a0c4,'take':_0x4f9aeb,'orderBy':{'createdAt':_0x4f26c1(0x26a)},'select':{'id':!![],'shopId':!![],'amount':!![],'network':!![],'wallet':!![],'status':!![],'txid':!![],'notes':!![],'periodFrom':!![],'periodTo':!![],'createdAt':!![],'paidAt':!![],'shop':{'select':{'name':!![],'username':!![]}}}}),database_1['default'][_0x4f26c1(0x2ae)][_0x4f26c1(0x269)]({'where':_0x2a7983})]);return{'payouts':_0x559dbd[_0x4f26c1(0x297)](_0x14e3cf=>({'id':_0x14e3cf['id'],'shopId':_0x14e3cf[_0x4f26c1(0x2d9)],'shopName':_0x14e3cf[_0x4f26c1(0x2ad)][_0x4f26c1(0x248)],'shopUsername':_0x14e3cf['shop'][_0x4f26c1(0x1eb)],'amount':_0x14e3cf['amount'],'network':_0x14e3cf['network'],'wallet':_0x14e3cf[_0x4f26c1(0x292)],'status':_0x14e3cf[_0x4f26c1(0x276)],'txid':_0x14e3cf['txid'],'notes':_0x14e3cf['notes'],'periodFrom':_0x14e3cf['periodFrom'],'periodTo':_0x14e3cf[_0x4f26c1(0x2cf)],'createdAt':_0x14e3cf['createdAt'],'paidAt':_0x14e3cf[_0x4f26c1(0x20a)]})),'pagination':{'page':_0x1ab274,'limit':_0x4f9aeb,'total':_0x3bb788,'totalPages':Math[_0x4f26c1(0x20c)](_0x3bb788/_0x4f9aeb)}};}async['getPayoutById'](_0x16f1e2){const _0x21788d=a35_0x24f24a,_0x206d44=await database_1[_0x21788d(0x2b7)][_0x21788d(0x2ae)][_0x21788d(0x27e)]({'where':{'id':_0x16f1e2},'include':{'shop':{'select':{'name':!![],'username':!![]}}}});if(!_0x206d44)return null;return{'id':_0x206d44['id'],'shopId':_0x206d44['shopId'],'shopName':_0x206d44[_0x21788d(0x2ad)]['name'],'shopUsername':_0x206d44['shop'][_0x21788d(0x1eb)],'amount':_0x206d44[_0x21788d(0x25e)],'network':_0x206d44[_0x21788d(0x288)],'status':_0x206d44[_0x21788d(0x276)],'txid':_0x206d44['txid'],'notes':_0x206d44[_0x21788d(0x203)],'periodFrom':_0x206d44[_0x21788d(0x295)],'periodTo':_0x206d44[_0x21788d(0x2cf)],'createdAt':_0x206d44['createdAt'],'paidAt':_0x206d44[_0x21788d(0x20a)]};}async[a35_0x24f24a(0x2b0)](_0x4ab2bc){const _0x2eaea0=a35_0x24f24a;await database_1[_0x2eaea0(0x2b7)]['payout'][_0x2eaea0(0x2a5)]({'where':{'id':_0x4ab2bc}});}async[a35_0x24f24a(0x1cd)](_0x26107a){const _0x39257a=a35_0x24f24a,{page:_0x3797ee,limit:_0x16a792,status:_0x1472bf,gateway:_0x312ee5,shopId:_0x48f816,dateFrom:_0xb09c89,dateTo:_0x2a3ce2,search:_0xe3d718,currency:_0x9be2a9,sortBy:_0x1fb696,sortOrder:_0x4a8a40}=_0x26107a,_0x17ca89=(_0x3797ee-0x1)*_0x16a792;console[_0x39257a(0x233)](_0x39257a(0x247),_0x26107a);const _0x2411d9=await database_1[_0x39257a(0x2b7)][_0x39257a(0x1db)][_0x39257a(0x2af)]({'by':[_0x39257a(0x2cc)],'_count':{'gateway':!![]}});console[_0x39257a(0x233)](_0x39257a(0x2b2),_0x2411d9['map'](_0x4c6c41=>_0x4c6c41[_0x39257a(0x2cc)]+'\x20('+_0x4c6c41[_0x39257a(0x1fd)][_0x39257a(0x2cc)]+_0x39257a(0x2d2)));if(_0x312ee5){const _0x5a55d7=_0x2411d9[_0x39257a(0x223)](_0x40eb51=>_0x40eb51[_0x39257a(0x2cc)]['toLowerCase']()===_0x312ee5[_0x39257a(0x246)]());!_0x5a55d7&&_0x312ee5[_0x39257a(0x246)]()!==_0x39257a(0x211)&&console[_0x39257a(0x233)](_0x39257a(0x294)+_0x312ee5+'\x27\x20not\x20found.\x20Available\x20gateways:\x20'+_0x2411d9[_0x39257a(0x297)](_0xe7269c=>_0xe7269c[_0x39257a(0x2cc)])[_0x39257a(0x29c)](',\x20'));}const _0x3cdb0c={};_0x1472bf&&(_0x3cdb0c['status']=_0x1472bf[_0x39257a(0x268)]());if(!_0x312ee5)_0x3cdb0c[_0x39257a(0x2cc)]={'not':_0x39257a(0x211)};else{if(_0x312ee5&&(_0x312ee5[_0x39257a(0x246)]()===_0x39257a(0x211)||_0x312ee5===_0x39257a(0x1d7)))_0x3cdb0c['gateway']='test_gateway';else{let _0x5d6313=_0x312ee5;const _0x4b8c23=(0x0,gateway_1['getGatewayNameById'])(_0x312ee5);if(_0x4b8c23)_0x5d6313=_0x4b8c23,console[_0x39257a(0x233)](_0x39257a(0x24c)+_0x312ee5+_0x39257a(0x1e6)+_0x5d6313+'\x27');else{const _0x5b5f3d=(0x0,gateway_1[_0x39257a(0x270)])(_0x312ee5);if(_0x5b5f3d){const _0xd0950d=(0x0,gateway_1[_0x39257a(0x1e1)])(_0x5b5f3d);_0xd0950d&&(_0x5d6313=_0xd0950d,console[_0x39257a(0x233)](_0x39257a(0x214)+_0x312ee5+_0x39257a(0x1e0)+_0x5b5f3d+_0x39257a(0x230)+_0x5d6313+'\x27'));}else console[_0x39257a(0x233)](_0x39257a(0x27f)+_0x312ee5+_0x39257a(0x1dc));}const _0x43d3e1=await database_1[_0x39257a(0x2b7)][_0x39257a(0x1db)][_0x39257a(0x269)]({'where':{'gateway':_0x5d6313[_0x39257a(0x246)]()},'take':0x1});_0x43d3e1===0x0?(console[_0x39257a(0x233)](_0x39257a(0x208)+_0x5d6313+'\x27\x20(from\x20\x27'+_0x312ee5+_0x39257a(0x21a)),_0x3cdb0c[_0x39257a(0x2cc)]=_0x39257a(0x225)):(_0x3cdb0c[_0x39257a(0x2cc)]=_0x5d6313[_0x39257a(0x246)](),console[_0x39257a(0x233)]('✅\x20Using\x20gateway\x20filter:\x20\x27'+_0x5d6313+_0x39257a(0x2a8)+_0x312ee5+'\x27)'));}}console['log'](_0x39257a(0x25a),_0x3cdb0c[_0x39257a(0x2cc)]);_0x48f816&&(_0x3cdb0c[_0x39257a(0x2d9)]=_0x48f816);_0x9be2a9&&(_0x3cdb0c['currency']=_0x9be2a9['toUpperCase'](),console['log'](_0x39257a(0x1ff)+_0x9be2a9[_0x39257a(0x268)]()));(_0xb09c89||_0x2a3ce2)&&(_0x3cdb0c[_0x39257a(0x1f5)]={},_0xb09c89&&(_0x3cdb0c['createdAt']['gte']=new Date(_0xb09c89)),_0x2a3ce2&&(_0x3cdb0c['createdAt'][_0x39257a(0x1d3)]=new Date(_0x2a3ce2)));_0xe3d718&&(_0x3cdb0c['OR']=[{'id':{'contains':_0xe3d718,'mode':_0x39257a(0x26e)}},{'orderId':{'contains':_0xe3d718,'mode':_0x39257a(0x26e)}},{'gatewayOrderId':{'contains':_0xe3d718,'mode':_0x39257a(0x26e)}},{'customerEmail':{'contains':_0xe3d718,'mode':'insensitive'}},{'shop':{'name':{'contains':_0xe3d718,'mode':_0x39257a(0x26e)}}},{'shop':{'username':{'contains':_0xe3d718,'mode':'insensitive'}}}]);console['log']('📊\x20Final\x20WHERE\x20conditions:',JSON[_0x39257a(0x285)](_0x3cdb0c,null,0x2));let _0x4d63ad={'createdAt':_0x39257a(0x26a)};if(_0x1fb696){const _0x234398=['amount','createdAt',_0x39257a(0x25f),_0x39257a(0x276),_0x39257a(0x2cc),_0x39257a(0x2aa)],_0x2ad677=[_0x39257a(0x204),_0x39257a(0x26a)];if(_0x234398[_0x39257a(0x257)](_0x1fb696)){const _0x52147d=_0x2ad677[_0x39257a(0x257)](_0x4a8a40)?_0x4a8a40:'desc';_0x4d63ad={[_0x1fb696]:_0x52147d},console[_0x39257a(0x233)]('📊\x20Sorting\x20payments\x20by\x20'+_0x1fb696+_0x39257a(0x1dd)+_0x52147d+_0x39257a(0x291));}}const [_0x500b34,_0x3515a9]=await Promise[_0x39257a(0x20d)]([database_1[_0x39257a(0x2b7)][_0x39257a(0x1db)][_0x39257a(0x22c)]({'where':_0x3cdb0c,'skip':_0x17ca89,'take':_0x16a792,'orderBy':_0x4d63ad,'include':{'shop':{'select':{'name':!![],'username':!![]}}}}),database_1[_0x39257a(0x2b7)][_0x39257a(0x1db)][_0x39257a(0x269)]({'where':_0x3cdb0c})]);return{'payments':_0x500b34[_0x39257a(0x297)](_0x3881f3=>({'id':_0x3881f3['id'],'shopId':_0x3881f3[_0x39257a(0x2d9)],'gateway':_0x3881f3['gateway'],'amount':_0x3881f3['amount'],'currency':_0x3881f3[_0x39257a(0x2aa)],'status':_0x3881f3[_0x39257a(0x276)],'orderId':_0x3881f3[_0x39257a(0x20b)],'gatewayOrderId':_0x3881f3['gatewayOrderId'],'customerEmail':_0x3881f3[_0x39257a(0x2b3)],'customerName':_0x3881f3[_0x39257a(0x279)],'customerCountry':_0x3881f3[_0x39257a(0x238)],'customerIp':_0x3881f3[_0x39257a(0x1fe)],'customerUa':_0x3881f3['customerUa'],'failureMessage':_0x3881f3[_0x39257a(0x290)],'createdAt':_0x3881f3[_0x39257a(0x1f5)],'updatedAt':_0x3881f3['updatedAt'],'shop':_0x3881f3[_0x39257a(0x2ad)]})),'pagination':{'page':_0x3797ee,'limit':_0x16a792,'total':_0x3515a9,'totalPages':Math[_0x39257a(0x20c)](_0x3515a9/_0x16a792)}};}async[a35_0x24f24a(0x232)](_0x13ee0b){const _0x23d9f3=a35_0x24f24a,_0x581d5e=await database_1[_0x23d9f3(0x2b7)][_0x23d9f3(0x1db)]['findUnique']({'where':{'id':_0x13ee0b},'include':{'shop':{'select':{'name':!![],'username':!![]}}}});if(!_0x581d5e)return null;return{'id':_0x581d5e['id'],'shopId':_0x581d5e[_0x23d9f3(0x2d9)],'gateway':_0x581d5e['gateway'],'amount':_0x581d5e[_0x23d9f3(0x25e)],'currency':_0x581d5e['currency'],'status':_0x581d5e['status'],'orderId':_0x581d5e[_0x23d9f3(0x20b)],'gatewayOrderId':_0x581d5e['gatewayOrderId'],'customerEmail':_0x581d5e['customerEmail'],'customerName':_0x581d5e['customerName'],'customerCountry':_0x581d5e[_0x23d9f3(0x238)],'customerIp':_0x581d5e[_0x23d9f3(0x1fe)],'customerUa':_0x581d5e[_0x23d9f3(0x2c3)],'failureMessage':_0x581d5e[_0x23d9f3(0x290)],'externalPaymentUrl':_0x581d5e[_0x23d9f3(0x28a)],'successUrl':_0x581d5e['successUrl'],'failUrl':_0x581d5e['failUrl'],'pendingUrl':_0x581d5e[_0x23d9f3(0x28f)],'whiteUrl':_0x581d5e[_0x23d9f3(0x1e4)],'createdAt':_0x581d5e['createdAt'],'updatedAt':_0x581d5e[_0x23d9f3(0x25f)],'shop':_0x581d5e['shop']};}async[a35_0x24f24a(0x2c9)](_0x562f86,_0x3d6872,_0x4c93c0,_0x26c70b){const _0x287689=a35_0x24f24a,_0x2f43b6=await database_1[_0x287689(0x2b7)][_0x287689(0x2b5)](async _0x29ffd7=>{const _0x4b6f1c=_0x287689,_0x3dd553=await _0x29ffd7['payment'][_0x4b6f1c(0x27e)]({'where':{'id':_0x562f86},'include':{'shop':{'select':{'id':!![],'name':!![],'username':!![],'balance':!![]}}}});if(!_0x3dd553)throw new Error(_0x4b6f1c(0x24e));const _0x476202=_0x3dd553[_0x4b6f1c(0x276)],_0x5e9253=_0x3d6872[_0x4b6f1c(0x268)]();console[_0x4b6f1c(0x233)]('🔄\x20Admin\x20updating\x20payment\x20'+_0x562f86+'\x20status:\x20'+_0x476202+_0x4b6f1c(0x210)+_0x5e9253),console[_0x4b6f1c(0x233)](_0x4b6f1c(0x25c)+_0x3dd553[_0x4b6f1c(0x2ad)][_0x4b6f1c(0x258)]+_0x4b6f1c(0x1d9));const _0x23b1d1={'status':_0x5e9253,'updatedAt':new Date(),'statusChangedBy':_0x4b6f1c(0x265),'statusChangedAt':new Date()};_0x4c93c0&&(_0x23b1d1['adminNotes']=_0x4c93c0);_0x5e9253==='CHARGEBACK'&&_0x26c70b&&(_0x23b1d1[_0x4b6f1c(0x287)]=_0x26c70b);let _0x14d4b2=0x0,_0x3b54ca=_0x3dd553[_0x4b6f1c(0x2ad)][_0x4b6f1c(0x258)];if(_0x5e9253===_0x4b6f1c(0x1e2)&&_0x476202!==_0x4b6f1c(0x1e2)){_0x23b1d1[_0x4b6f1c(0x20a)]=new Date();const _0x5f3707=await currencyService_1[_0x4b6f1c(0x20e)]['convertToUSDT'](_0x3dd553[_0x4b6f1c(0x25e)],_0x3dd553[_0x4b6f1c(0x2aa)]);_0x23b1d1[_0x4b6f1c(0x28c)]=_0x5f3707,_0x14d4b2=_0x5f3707,_0x3b54ca+=_0x5f3707,console[_0x4b6f1c(0x233)]('💰\x20Payment\x20'+_0x562f86+_0x4b6f1c(0x1e5)+_0x5f3707[_0x4b6f1c(0x1cc)](0x6)+_0x4b6f1c(0x296));}else _0x476202===_0x4b6f1c(0x1e2)&&_0x5e9253!=='PAID'&&(_0x3dd553['amountUSDT']&&(_0x14d4b2=-_0x3dd553[_0x4b6f1c(0x28c)],_0x3b54ca-=_0x3dd553[_0x4b6f1c(0x28c)],_0x23b1d1[_0x4b6f1c(0x28c)]=null,console['log'](_0x4b6f1c(0x243)+_0x562f86+_0x4b6f1c(0x2b4)+_0x3dd553['amountUSDT'][_0x4b6f1c(0x1cc)](0x6)+_0x4b6f1c(0x2ac))));if(_0x5e9253===_0x4b6f1c(0x1f6)){if(_0x476202===_0x4b6f1c(0x1e2)&&_0x3dd553[_0x4b6f1c(0x28c)]){}_0x26c70b&&_0x26c70b>0x0&&(_0x14d4b2-=_0x26c70b,_0x3b54ca-=_0x26c70b,console[_0x4b6f1c(0x233)]('💸\x20CHARGEBACK\x20penalty:\x20-'+_0x26c70b[_0x4b6f1c(0x1cc)](0x6)+_0x4b6f1c(0x2ac)));}_0x5e9253===_0x4b6f1c(0x2bb)&&_0x476202===_0x4b6f1c(0x1e2)&&console[_0x4b6f1c(0x233)](_0x4b6f1c(0x263));const _0x248c76=await _0x29ffd7[_0x4b6f1c(0x1db)][_0x4b6f1c(0x28e)]({'where':{'id':_0x562f86},'data':_0x23b1d1,'include':{'shop':{'select':{'name':!![],'username':!![]}}}});return _0x14d4b2!==0x0&&(await _0x29ffd7[_0x4b6f1c(0x2ad)][_0x4b6f1c(0x28e)]({'where':{'id':_0x3dd553[_0x4b6f1c(0x2d9)]},'data':{'balance':_0x3b54ca}}),console[_0x4b6f1c(0x233)](_0x4b6f1c(0x27d)+_0x3dd553[_0x4b6f1c(0x2d9)]+'\x20balance\x20updated:\x20'+_0x3dd553[_0x4b6f1c(0x2ad)]['balance'][_0x4b6f1c(0x1cc)](0x6)+_0x4b6f1c(0x210)+_0x3b54ca[_0x4b6f1c(0x1cc)](0x6)+_0x4b6f1c(0x250)+(_0x14d4b2>0x0?'+':'')+_0x14d4b2['toFixed'](0x6)+')')),_0x248c76;});return{'id':_0x2f43b6['id'],'shopId':_0x2f43b6[_0x287689(0x2d9)],'gateway':_0x2f43b6[_0x287689(0x2cc)],'amount':_0x2f43b6['amount'],'currency':_0x2f43b6['currency'],'status':_0x2f43b6['status'],'orderId':_0x2f43b6[_0x287689(0x20b)],'gatewayOrderId':_0x2f43b6[_0x287689(0x2b9)],'customerEmail':_0x2f43b6[_0x287689(0x2b3)],'customerName':_0x2f43b6['customerName'],'customerCountry':_0x2f43b6[_0x287689(0x238)],'customerIp':_0x2f43b6['customerIp'],'customerUa':_0x2f43b6[_0x287689(0x2c3)],'failureMessage':_0x2f43b6[_0x287689(0x290)],'adminNotes':_0x2f43b6['adminNotes'],'chargebackAmount':_0x2f43b6[_0x287689(0x287)],'statusChangedBy':_0x2f43b6[_0x287689(0x1fc)],'statusChangedAt':_0x2f43b6[_0x287689(0x2bc)],'createdAt':_0x2f43b6[_0x287689(0x1f5)],'updatedAt':_0x2f43b6['updatedAt'],'shop':_0x2f43b6[_0x287689(0x2ad)]};}async[a35_0x24f24a(0x267)](_0x4e3833,_0xc579f9){const _0x516b86=a35_0x24f24a,_0x3672e0={..._0xc579f9};_0xc579f9[_0x516b86(0x284)]&&(_0x3672e0[_0x516b86(0x284)]=await bcryptjs_1['default'][_0x516b86(0x23a)](_0xc579f9['password'],0xc));_0xc579f9[_0x516b86(0x1e9)]&&(_0x3672e0[_0x516b86(0x248)]=_0xc579f9[_0x516b86(0x1e9)],delete _0x3672e0[_0x516b86(0x1e9)]);_0xc579f9['telegramId']&&(_0x3672e0[_0x516b86(0x29a)]=_0xc579f9[_0x516b86(0x21f)],delete _0x3672e0[_0x516b86(0x21f)]);_0xc579f9[_0x516b86(0x205)]&&(_0x3672e0['shopUrl']=_0xc579f9[_0x516b86(0x205)],delete _0x3672e0[_0x516b86(0x205)]);_0xc579f9[_0x516b86(0x262)]&&(_0x3672e0['paymentGateways']=JSON[_0x516b86(0x285)](_0xc579f9['gateways']),delete _0x3672e0[_0x516b86(0x262)]);_0xc579f9[_0x516b86(0x254)]&&(_0x3672e0[_0x516b86(0x254)]=JSON[_0x516b86(0x285)](_0xc579f9[_0x516b86(0x254)]),delete _0x3672e0['gatewaySettings']);_0xc579f9[_0x516b86(0x220)]&&(_0xc579f9[_0x516b86(0x220)][_0x516b86(0x2ca)]!==undefined&&(_0x3672e0['usdtPolygonWallet']=_0xc579f9[_0x516b86(0x220)][_0x516b86(0x2ca)]||null),_0xc579f9[_0x516b86(0x220)][_0x516b86(0x256)]!==undefined&&(_0x3672e0['usdtTrcWallet']=_0xc579f9[_0x516b86(0x220)][_0x516b86(0x256)]||null),_0xc579f9[_0x516b86(0x220)][_0x516b86(0x1d6)]!==undefined&&(_0x3672e0[_0x516b86(0x1d6)]=_0xc579f9[_0x516b86(0x220)]['usdtErcWallet']||null),_0xc579f9[_0x516b86(0x220)]['usdcPolygonWallet']!==undefined&&(_0x3672e0[_0x516b86(0x20f)]=_0xc579f9[_0x516b86(0x220)][_0x516b86(0x20f)]||null),delete _0x3672e0[_0x516b86(0x220)]);const _0x4f2a1e=await database_1['default'][_0x516b86(0x2ad)][_0x516b86(0x28e)]({'where':{'id':_0x4e3833},'data':_0x3672e0,'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});return{'id':_0x4f2a1e['id'],'fullName':_0x4f2a1e[_0x516b86(0x248)],'username':_0x4f2a1e[_0x516b86(0x1eb)],'telegramId':_0x4f2a1e[_0x516b86(0x29a)],'merchantUrl':_0x4f2a1e[_0x516b86(0x21c)],'gateways':_0x4f2a1e['paymentGateways']?JSON['parse'](_0x4f2a1e[_0x516b86(0x207)]):null,'gatewaySettings':_0x4f2a1e[_0x516b86(0x254)]?JSON['parse'](_0x4f2a1e[_0x516b86(0x254)]):null,'publicKey':_0x4f2a1e[_0x516b86(0x2d0)],'wallets':{'usdtPolygonWallet':_0x4f2a1e[_0x516b86(0x2ca)],'usdtTrcWallet':_0x4f2a1e[_0x516b86(0x256)],'usdtErcWallet':_0x4f2a1e[_0x516b86(0x1d6)],'usdcPolygonWallet':_0x4f2a1e['usdcPolygonWallet']},'status':_0x4f2a1e['status'],'createdAt':_0x4f2a1e['createdAt']};}async[a35_0x24f24a(0x2d1)](_0x30bc3e){const _0x527bf8=a35_0x24f24a,_0x4a890f=await database_1[_0x527bf8(0x2b7)][_0x527bf8(0x2ad)][_0x527bf8(0x28e)]({'where':{'id':_0x30bc3e},'data':{'status':_0x527bf8(0x25d)},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});return{'id':_0x4a890f['id'],'fullName':_0x4a890f[_0x527bf8(0x248)],'username':_0x4a890f['username'],'telegramId':_0x4a890f[_0x527bf8(0x29a)],'merchantUrl':_0x4a890f['shopUrl'],'gateways':_0x4a890f['paymentGateways']?JSON[_0x527bf8(0x22b)](_0x4a890f[_0x527bf8(0x207)]):null,'gatewaySettings':_0x4a890f[_0x527bf8(0x254)]?JSON[_0x527bf8(0x22b)](_0x4a890f[_0x527bf8(0x254)]):null,'publicKey':_0x4a890f[_0x527bf8(0x2d0)],'wallets':{'usdtPolygonWallet':_0x4a890f[_0x527bf8(0x2ca)],'usdtTrcWallet':_0x4a890f[_0x527bf8(0x256)],'usdtErcWallet':_0x4a890f[_0x527bf8(0x1d6)],'usdcPolygonWallet':_0x4a890f[_0x527bf8(0x20f)]},'status':_0x4a890f[_0x527bf8(0x276)],'createdAt':_0x4a890f[_0x527bf8(0x1f5)]};}async[a35_0x24f24a(0x266)](_0x490fcb){const _0x5f5057=a35_0x24f24a,_0xf06b3b=await database_1['default'][_0x5f5057(0x2ad)]['update']({'where':{'id':_0x490fcb},'data':{'status':'ACTIVE'},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});return{'id':_0xf06b3b['id'],'fullName':_0xf06b3b[_0x5f5057(0x248)],'username':_0xf06b3b[_0x5f5057(0x1eb)],'telegramId':_0xf06b3b[_0x5f5057(0x29a)],'merchantUrl':_0xf06b3b[_0x5f5057(0x21c)],'gateways':_0xf06b3b[_0x5f5057(0x207)]?JSON['parse'](_0xf06b3b[_0x5f5057(0x207)]):null,'gatewaySettings':_0xf06b3b[_0x5f5057(0x254)]?JSON[_0x5f5057(0x22b)](_0xf06b3b[_0x5f5057(0x254)]):null,'publicKey':_0xf06b3b['publicKey'],'wallets':{'usdtPolygonWallet':_0xf06b3b[_0x5f5057(0x2ca)],'usdtTrcWallet':_0xf06b3b[_0x5f5057(0x256)],'usdtErcWallet':_0xf06b3b[_0x5f5057(0x1d6)],'usdcPolygonWallet':_0xf06b3b[_0x5f5057(0x20f)]},'status':_0xf06b3b[_0x5f5057(0x276)],'createdAt':_0xf06b3b[_0x5f5057(0x1f5)]};}async['getAllUsers'](_0x3796d2){const _0x34579c=a35_0x24f24a,{page:_0xa64a31,limit:_0x673522,status:_0x80374}=_0x3796d2,_0x81cc09=(_0xa64a31-0x1)*_0x673522,_0x58f30b={};_0x80374&&(_0x58f30b[_0x34579c(0x276)]=_0x80374[_0x34579c(0x268)]());const [_0x422373,_0x56afc8]=await Promise[_0x34579c(0x20d)]([database_1['default'][_0x34579c(0x2ad)][_0x34579c(0x22c)]({'where':_0x58f30b,'skip':_0x81cc09,'take':_0x673522,'orderBy':{'createdAt':_0x34579c(0x26a)},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}}),database_1[_0x34579c(0x2b7)][_0x34579c(0x2ad)][_0x34579c(0x269)]({'where':_0x58f30b})]);return{'users':_0x422373[_0x34579c(0x297)](_0x53c86f=>({'id':_0x53c86f['id'],'fullName':_0x53c86f['name'],'username':_0x53c86f[_0x34579c(0x1eb)],'telegramId':_0x53c86f[_0x34579c(0x29a)],'merchantUrl':_0x53c86f['shopUrl'],'gateways':_0x53c86f['paymentGateways']?JSON[_0x34579c(0x22b)](_0x53c86f[_0x34579c(0x207)]):null,'gatewaySettings':_0x53c86f[_0x34579c(0x254)]?JSON[_0x34579c(0x22b)](_0x53c86f['gatewaySettings']):null,'publicKey':_0x53c86f[_0x34579c(0x2d0)],'wallets':{'usdtPolygonWallet':_0x53c86f[_0x34579c(0x2ca)],'usdtTrcWallet':_0x53c86f['usdtTrcWallet'],'usdtErcWallet':_0x53c86f['usdtErcWallet'],'usdcPolygonWallet':_0x53c86f[_0x34579c(0x20f)]},'status':_0x53c86f['status'],'createdAt':_0x53c86f[_0x34579c(0x1f5)]})),'pagination':{'page':_0xa64a31,'limit':_0x673522,'total':_0x56afc8,'totalPages':Math[_0x34579c(0x20c)](_0x56afc8/_0x673522)}};}async[a35_0x24f24a(0x283)](_0x510df0){const _0xb230dd=a35_0x24f24a,_0x3a1857=await database_1[_0xb230dd(0x2b7)][_0xb230dd(0x2ad)][_0xb230dd(0x27e)]({'where':{'id':_0x510df0},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});if(!_0x3a1857)return null;return{'id':_0x3a1857['id'],'fullName':_0x3a1857[_0xb230dd(0x248)],'username':_0x3a1857['username'],'telegramId':_0x3a1857[_0xb230dd(0x29a)],'merchantUrl':_0x3a1857[_0xb230dd(0x21c)],'gateways':_0x3a1857['paymentGateways']?JSON[_0xb230dd(0x22b)](_0x3a1857[_0xb230dd(0x207)]):null,'gatewaySettings':_0x3a1857[_0xb230dd(0x254)]?JSON[_0xb230dd(0x22b)](_0x3a1857[_0xb230dd(0x254)]):null,'publicKey':_0x3a1857['publicKey'],'wallets':{'usdtPolygonWallet':_0x3a1857[_0xb230dd(0x2ca)],'usdtTrcWallet':_0x3a1857['usdtTrcWallet'],'usdtErcWallet':_0x3a1857[_0xb230dd(0x1d6)],'usdcPolygonWallet':_0x3a1857[_0xb230dd(0x20f)]},'status':_0x3a1857[_0xb230dd(0x276)],'createdAt':_0x3a1857[_0xb230dd(0x1f5)]};}async[a35_0x24f24a(0x1d1)](_0x49c504){const _0x4ecc86=a35_0x24f24a,{fullName:_0x1705fb,username:_0x3c5107,password:_0x443428,telegramId:_0x1d032d,merchantUrl:_0x3dac3c,gateways:_0x4d29fb,gatewaySettings:_0x26dfd4,wallets:_0xbc2e4c}=_0x49c504,_0x4bbef3=await database_1[_0x4ecc86(0x2b7)][_0x4ecc86(0x2ad)][_0x4ecc86(0x27e)]({'where':{'username':_0x3c5107}});if(_0x4bbef3)throw new Error(_0x4ecc86(0x219));if(_0x1d032d){const _0x355712=await database_1['default'][_0x4ecc86(0x2ad)][_0x4ecc86(0x27e)]({'where':{'telegram':_0x1d032d}});if(_0x355712)throw new Error(_0x4ecc86(0x282));}const _0x34b99f=await bcryptjs_1[_0x4ecc86(0x2b7)][_0x4ecc86(0x23a)](_0x443428,0xc),_0x50d1b5='pk_'+crypto_1[_0x4ecc86(0x2b7)][_0x4ecc86(0x2ab)](0x20)[_0x4ecc86(0x1f3)](_0x4ecc86(0x212)),_0x5b5082='sk_'+crypto_1['default']['randomBytes'](0x20)['toString'](_0x4ecc86(0x212)),_0x2d752c=await database_1[_0x4ecc86(0x2b7)]['shop'][_0x4ecc86(0x1ce)]({'data':{'name':_0x1705fb,'username':_0x3c5107,'password':_0x34b99f,'telegram':_0x1d032d,'shopUrl':_0x3dac3c,'paymentGateways':_0x4d29fb?JSON['stringify'](_0x4d29fb):null,'gatewaySettings':_0x26dfd4?JSON['stringify'](_0x26dfd4):null,'usdtPolygonWallet':_0xbc2e4c?.[_0x4ecc86(0x2ca)]||null,'usdtTrcWallet':_0xbc2e4c?.['usdtTrcWallet']||null,'usdtErcWallet':_0xbc2e4c?.['usdtErcWallet']||null,'usdcPolygonWallet':_0xbc2e4c?.['usdcPolygonWallet']||null,'publicKey':_0x50d1b5,'secretKey':_0x5b5082,'status':_0x4ecc86(0x260)},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});return{'id':_0x2d752c['id'],'fullName':_0x2d752c['name'],'username':_0x2d752c[_0x4ecc86(0x1eb)],'telegramId':_0x2d752c[_0x4ecc86(0x29a)],'merchantUrl':_0x2d752c['shopUrl'],'gateways':_0x2d752c[_0x4ecc86(0x207)]?JSON[_0x4ecc86(0x22b)](_0x2d752c[_0x4ecc86(0x207)]):null,'gatewaySettings':_0x2d752c[_0x4ecc86(0x254)]?JSON['parse'](_0x2d752c[_0x4ecc86(0x254)]):null,'publicKey':_0x2d752c['publicKey'],'wallets':{'usdtPolygonWallet':_0x2d752c[_0x4ecc86(0x2ca)],'usdtTrcWallet':_0x2d752c[_0x4ecc86(0x256)],'usdtErcWallet':_0x2d752c[_0x4ecc86(0x1d6)],'usdcPolygonWallet':_0x2d752c[_0x4ecc86(0x20f)]},'status':_0x2d752c[_0x4ecc86(0x276)],'createdAt':_0x2d752c[_0x4ecc86(0x1f5)]};}async['deleteUser'](_0x125aa4){const _0x4eaf42=a35_0x24f24a;await database_1[_0x4eaf42(0x2b7)][_0x4eaf42(0x2ad)]['delete']({'where':{'id':_0x125aa4}});}[a35_0x24f24a(0x2b8)](_0x3576a7,_0x5b82f4,_0x185014){const _0x3c48ab=a35_0x24f24a,_0xc3da71=new Map(),_0x147cda=new Date(_0x5b82f4);while(_0x147cda<=_0x185014){const _0x296af1=_0x147cda['toISOString']()[_0x3c48ab(0x22d)]('T')[0x0];_0xc3da71['set'](_0x296af1,{'revenue':0x0,'count':0x0}),_0x147cda[_0x3c48ab(0x22f)](_0x147cda['getDate']()+0x1);}for(const _0x4a6e62 of _0x3576a7){const _0x3346e6=_0x4a6e62[_0x3c48ab(0x1f5)][_0x3c48ab(0x2d5)]()['split']('T')[0x0],_0x167793=_0xc3da71[_0x3c48ab(0x251)](_0x3346e6);_0x167793&&(_0x167793[_0x3c48ab(0x269)]+=0x1,_0x4a6e62[_0x3c48ab(0x276)]===_0x3c48ab(0x1e2)&&(_0x4a6e62[_0x3c48ab(0x28c)]?_0x167793[_0x3c48ab(0x22e)]+=_0x4a6e62[_0x3c48ab(0x28c)]:console[_0x3c48ab(0x233)](_0x3c48ab(0x21d)+_0x4a6e62['id']+_0x3c48ab(0x272))));}const _0x385bdc=[],_0x21049f=[];for(const [_0x5685f1,_0x494745]of _0xc3da71){_0x385bdc['push']({'date':_0x5685f1,'amount':Math[_0x3c48ab(0x259)](_0x494745[_0x3c48ab(0x22e)]*0x64)/0x64}),_0x21049f[_0x3c48ab(0x274)]({'date':_0x5685f1,'count':_0x494745['count']});}return{'dailyRevenue':_0x385bdc,'dailyPayments':_0x21049f};}}exports[a35_0x24f24a(0x1cf)]=AdminService;function a35_0x85a5(){const _0x39c05a=['REFUND','statusChangedAt','polygon','1200JzmpVz','📊\x20Payout\x20statistics\x20calculated:','getFullYear','📊\x20Getting\x20merchant\x20statistics\x20with\x20filters:','Shop\x20not\x20found','customerUa','totalCommissionRate','amountAfterCommissionUSDT','./currencyService','paymentsCount','__importDefault','updatePaymentStatus','usdtPolygonWallet','convertToUSDT','gateway','Noda','\x20\x20\x20🌍\x20Country:\x20','periodTo','publicKey','suspendUser','\x20payments)','thisMonth','\x20USDT,\x20Requested:\x20','toISOString','totalPaidOut','📊\x20Getting\x20merchants\x20awaiting\x20payout\x20with\x20filters:','Error\x20parsing\x20gateway\x20settings\x20for\x20shop\x20','shopId','toFixed','getAllPayments','create','AdminService','gatewayEarnings','createUser','7147554Mljrfx','lte','\x20to\x20','581nlRpsB','usdtErcWallet','0000','CoinToPay','\x20USDT','getMonth','payment','\x27\x20as\x20is\x20(not\x20found\x20in\x20mappings)','\x20in\x20','getMerchantsSelection','getMerchantStatistics','\x27\x20->\x20ID\x20\x27','getGatewayNameById','PAID','COMPLETED','whiteUrl','\x20became\x20PAID:\x20+','\x27\x20to\x20name\x20\x27','💰\x20Creating\x20payout\x20for\x20shop\x20','error','fullName','set','username','sort','_sum','getTime','✅\x20Payout\x20created:\x20','length','entries','Error\x20processing\x20payment\x20','toString','✅\x20Customer\x20data\x20updated\x20for\x20payment\x20','createdAt','CHARGEBACK','\x20\x20\x20Payout\x20amount:\x20','gte','dailyRevenue','awaitingPayout','\x20\x20\x20Balance:\x20','statusChangedBy','_count','customerIp','💱\x20Currency\x20filter\x20applied:\x20','merchantEarningsUSDT','aggregate','getPayoutStats','notes','asc','merchantUrl','totalPayout','paymentGateways','⚠️\x20Gateway\x20\x27','bcryptjs','paidAt','orderId','ceil','all','currencyService','usdcPolygonWallet','\x20->\x20','test_gateway','hex','10706610HLHjDY','🔄\x20Converted\x20gateway\x20name\x20\x27','\x20USDT\x20(total\x20paid\x20to\x20merchants)','📋\x20Getting\x20merchants\x20selection\x20list...','availableBalance','dateTo','Username\x20already\x20exists','\x27)\x20not\x20found\x20in\x20database,\x20returning\x20empty\x20result','turnoverUSDT','shopUrl','⚠️\x20Payment\x20','date','telegramId','wallets','commissionUSDT','commission','some','\x20USDT\x20(+','NONEXISTENT_GATEWAY_FILTER','6116115bCWDbZ','averageCommissionRate','90d','custom','not\x20set','parse','findMany','split','revenue','setDate','\x27\x20->\x20name\x20\x27','week','getPaymentById','log','averageCheckUSDT','erc20','\x20balance\x20updated:','totalTurnover','customerCountry','756788UjqPcM','hash','\x20for\x20shop\x20','\x20merchants,\x20','dateFrom','crypto','\x20\x20\x20📅\x20This\x20month:\x20','📊\x20Merchants\x20awaiting\x20payout:\x20','updateCustomerData','year','💰\x20Payment\x20','📊\x20Calculating\x20payout\x20statistics...','📅\x20Period:\x20','toLowerCase','📊\x20Getting\x20payments\x20with\x20filters:','name','\x20\x20\x20Current\x20balance:\x20','\x20\x20\x20🌐\x20IP:\x20','\x20USDT)','🔄\x20Converted\x20gateway\x20ID\x20\x27','📊\x20Total\x20payments\x20(including\x20failed):\x20','Payment\x20not\x20found','getMerchantsAwaitingPayout','\x20USDT\x20(','get','💰\x20[PAYOUT]\x20Gateway\x20',':\x20commission\x20=\x20','gatewaySettings',',\x20successful:\x20','usdtTrcWallet','includes','balance','round','📊\x20Gateway\x20filter\x20applied:','period','💰\x20Current\x20shop\x20balance:\x20','SUSPENDED','amount','updatedAt','ACTIVE','getSystemStatistics','gateways','🔄\x20REFUND:\x20Payment\x20amount\x20already\x20deducted\x20from\x20balance','reduce','admin','activateUser','updateUser','toUpperCase','count','desc','createPayout','2020-01-01','trc20','insensitive','getGatewayDisplayName','getGatewayIdByName','merchantEarnings','\x20missing\x20amountUSDT,\x20using\x20fallback\x20conversion','\x20\x20\x20👤\x20Merchant\x20earnings:\x20','push','\x20\x20\x20🏪\x20Gateway\x20earnings:\x20','status','\x20active\x20merchants\x20for\x20selection','\x20\x20\x20Transaction\x20hash:\x20','customerName','dailyPayments','158232Dlbuzo','\x20\x20\x20💵\x20Available\x20balance:\x20','💰\x20Shop\x20','findUnique','🔍\x20Using\x20gateway\x20\x27','Insufficient\x20balance.\x20Available:\x20','paidOutUSDT','Telegram\x20username\x20already\x20exists','getUserById','password','stringify','turnover','chargebackAmount','network','\x20\x20\x20💰\x20Total\x20turnover:\x20','externalPaymentUrl','localeCompare','amountUSDT','values','update','pendingUrl','failureMessage','\x20order','wallet','Rapyd','⚠️\x20Requested\x20gateway\x20\x27','periodFrom','\x20USDT\x20to\x20balance','map','forEach','45AgbGoS','telegram','findFirst','join','📋\x20Found\x20','\x20USDT\x20(same\x20as\x20awaiting)','KLYME\x20DE','368191vSdorl','__esModule','totalAmountAfterCommissionUSDT','Plisio','📅\x20Period\x20\x27all\x27:\x20Using\x20start\x20date\x20from\x20first\x20payment:\x20','delete','KLYME\x20GB','\x20\x20\x20📊\x20Total\x20payments:\x20','\x27\x20(from\x20\x27','txid','currency','randomBytes','\x20USDT\x20from\x20balance','shop','payout','groupBy','deletePayout','totalAmountUSDT','📊\x20Available\x20gateways\x20in\x20database:','customerEmail','\x20no\x20longer\x20PAID:\x20-','$transaction','🔄\x20Updating\x20customer\x20data\x20for\x20payment\x20','default','generateDailyStatistics','gatewayOrderId','8026eXDQQq'];a35_0x85a5=function(){return _0x39c05a;};return a35_0x85a5();}