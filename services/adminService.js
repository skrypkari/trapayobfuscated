'use strict';const a36_0xdea0a0=a36_0x123f;function a36_0x123f(_0x3e439c,_0x326f99){const _0x3c67b8=a36_0x3c67();return a36_0x123f=function(_0x123f08,_0x314726){_0x123f08=_0x123f08-0x10f;let _0x56b7f6=_0x3c67b8[_0x123f08];return _0x56b7f6;},a36_0x123f(_0x3e439c,_0x326f99);}(function(_0x28743f,_0x27ba1b){const _0x53f1de=a36_0x123f,_0x59029c=_0x28743f();while(!![]){try{const _0x2139ca=parseInt(_0x53f1de(0x156))/0x1*(-parseInt(_0x53f1de(0x19a))/0x2)+-parseInt(_0x53f1de(0x136))/0x3+parseInt(_0x53f1de(0x12b))/0x4+-parseInt(_0x53f1de(0x1b8))/0x5+-parseInt(_0x53f1de(0x16a))/0x6+parseInt(_0x53f1de(0x17e))/0x7*(parseInt(_0x53f1de(0x17f))/0x8)+parseInt(_0x53f1de(0x23c))/0x9;if(_0x2139ca===_0x27ba1b)break;else _0x59029c['push'](_0x59029c['shift']());}catch(_0x1fbc7a){_0x59029c['push'](_0x59029c['shift']());}}}(a36_0x3c67,0x9b544));var __importDefault=this&&this[a36_0xdea0a0(0x1f7)]||function(_0x45fc8b){const _0x537c3f=a36_0xdea0a0;return _0x45fc8b&&_0x45fc8b[_0x537c3f(0x22b)]?_0x45fc8b:{'default':_0x45fc8b};};Object['defineProperty'](exports,a36_0xdea0a0(0x22b),{'value':!![]}),exports[a36_0xdea0a0(0x24e)]=void 0x0;function a36_0x3c67(){const _0xc020da=['paidOutUSDT','toUpperCase','\x20USDT\x20(after\x20payouts)','\x20for\x20shop\x20','year','üìä\x20Merchant\x20statistics\x20calculated:','\x20USDT\x20(+','üîß\x20[','üìä\x20Gateway\x20filter\x20applied:','‚ö†Ô∏è\x20Gateway\x20\x27','log','\x20\x20\x20üîç\x20Raw\x20balance\x20sum:\x20','noda','‚úÖ\x20Using\x20gateway\x20filter:\x20\x27','getTime','Error\x20processing\x20payment\x20','desc','üìä\x20Getting\x20merchants\x20awaiting\x20payout\x20with\x20filters:','__esModule','polygon_usdc','plisio','CoinToPay','üí±\x20Currency\x20filter\x20applied:\x20','crypto','findUnique','currencyService','not\x20set','üìã\x20Getting\x20merchants\x20selection\x20list...','\x20missing\x20amountUSDT,\x20using\x20fallback\x20conversion','üîÑ\x20Converted\x20gateway\x20ID\x20\x27','\x20USDT\x20(same\x20as\x20awaiting)','getGatewayNameById','üìã\x20Found\x20','\x20USDT\x20(gross\x20revenue)','gatewayEarnings','35306739tLZlBE','all','customerUa','findFirst','üîÑ\x20Admin\x20updating\x20payment\x20','week','updateUser','\x20\x20\x20üìÖ\x20Total\x20payouts\x20(this\x20month):\x20','\x20balance\x20updated:','adminNotes',']\x20User\x20updated,\x20gatewaySettings\x20from\x20DB:','üìä\x20Calculating\x20commission\x20manually\x20for\x20payment\x20','\x27\x20->\x20name\x20\x27','some','usdcPolygonWallet','trc20','\x20\x20\x20Payout\x20amount:\x20','amount','AdminService','values','forEach','sk_','date','toFixed','getMerchantsAwaitingPayout','custom','\x20USDT\x20from\x20balance','KLYME\x20EU','üìä\x20[ADMIN]\x20Calculating\x20commission\x20manually\x20for\x20payment\x20','getPayoutStats','PAID','üîç\x20Using\x20gateway\x20\x27','getPaymentById','\x20\x20\x20Subtracted\x20from\x20balance:\x20-','üí∞\x20Creating\x20payout\x20for\x20shop\x20','üìÖ\x20Period:\x20','getGatewayDisplayName','totalAmountUSDT','\x20\x20\x20‚úÖ\x20Actual\x20available\x20balance:\x20','üîÑ\x20Updating\x20customer\x20data\x20for\x20payment\x20','thisMonth','join','txid','$transaction','REFUND','get','revenue','getMerchantsSelection','getMonth','getFullYear','1951192YKOOrt','totalPaidOut','\x20USDT\x20(','\x20to\x20','default','Payment\x20not\x20found','round','\x20\x20\x20üí∞\x20Total\x20payments\x20turnover:\x20','Error\x20parsing\x20gateway\x20settings\x20for\x20payment\x20','polygon','failureMessage','2427903iWyTsW','Open\x20Banking\x202','\x27\x20to\x20name\x20\x27','\x20became\x20PAID:','KLYME\x20GB','üéØ\x20updateUser\x20called\x20with\x20ID:\x20','\x20USDT','üîÑ\x20Gateway\x20mapping:','\x20\x20\x20üìä\x20Commission\x20difference:\x20','‚úÖ\x20Payout\x20created:\x20','\x20\x20\x20Merchant\x20gets:\x20','admin','\x20USDT\x20(with\x20commission\x20deducted)','gte','toISOString','SUSPENDED','Noda','hex','\x20status:\x20','paymentGateways','üìä\x20Getting\x20payments\x20with\x20filters:','hash','currency','username','./currencyService','\x20USDT\x20(theoretical\x20net)','customerCountry','balance','delete','customerIp','ACTIVE','\x20USDT\x20for\x20payment\x20','2eOryfI','\x20\x20\x20ÔøΩ\x20Total\x20paid\x20out:\x20','commissionUSDT','usdtErcWallet','insensitive','not\x20specified','length','\x20\x20\x20üè™\x20Gateway\x20earnings:\x20','periodTo','\x20\x20\x20üíµ\x20Available\x20balance:\x20','üí∏\x20CHARGEBACK\x20penalty:\x20-','KLYME\x20DE','\x20\x20\x20ÔøΩüìä\x20Total\x20payments:\x20','\x20no\x20longer\x20PAID:','usdtTrcWallet','üîÑ\x20Gateway\x20mapping\x20(create):','üí∏\x20CHARGEBACK:\x20Merchant\x20amount\x20already\x20deducted\x20from\x20balance','üìä\x20Calculating\x20payout\x20statistics...','localeCompare','createdAt','5838348UDfVwf','wallets','payment','_count','toString','\x27\x20->\x20ID\x20\x27','\x20USDT,\x20Requested:\x20','\x20\x20\x20Total\x20paid\x20out:\x20','includes','üìä\x20Total\x20payments\x20(including\x20failed):\x20','üí∞\x20Found\x20','‚ö†Ô∏è\x20Requested\x20gateway\x20\x27','password','../config/database','pendingPayout','aggregate','\x20\x20\x20‚è≥\x20Pending\x20payout:\x20','commission','getSystemStatistics','\x20\x20\x20‚è≥\x20Awaiting\x20payout:\x20','91UqqsVb','37136ilQuxO','getDate','\x20USDT\x20(-','stringify','üí≥\x20Payout\x20wallet\x20for\x20','DAY','day','createUser','updatedAt','\x20\x20\x20Merchant\x20loses:\x20','Error\x20parsing\x20gateway\x20settings\x20for\x20shop\x20','\x20USDT\x20(total\x20paid\x20to\x20merchants)','groupBy','Insufficient\x20balance.\x20Available:\x20','getPayoutById','üîÑ\x20REFUND:\x20Payment\x20amount\x20already\x20deducted\x20from\x20balance','erc20','getGatewayInternalName','\x20\x20\x20üîç\x20Calculated\x20after\x20commission:\x20','dateTo','dailyPayments','90d','üìä\x20Sorting\x20payments\x20by\x20','\x20merchants\x20with\x20positive\x20balance','amountAfterCommissionUSDT','customerEmail','notes','972862csjgwm','üîÑ\x20Converted\x20gateway\x20name\x20\x27','generateDailyStatistics','0000','\x20PAID\x20payments','reduce','payout','map','\x20USDT\x20(actual\x20balances)','availableBalance','üìä\x20[ADMIN]\x20Using\x20saved\x20amountAfterGatewayCommissionUSDT:\x20','chargebackAmount','gatewayOrderId','random','turnoverUSDT','shopUrl','\x20order','totalTurnover','count','\x20\x20\x20Balance:\x20',',\x20Commission:\x20','update','\x20\x20\x20Full\x20amount:\x20','‚ö†Ô∏è\x20Payment\x20','status','\x20\x20\x20Current\x20total\x20paid\x20out:\x20','Username\x20already\x20exists','usdtPolygonWallet','substr','getMerchantStatistics','5398330FkXHYo','üí∞\x20Payment\x20','üìä\x20Payout\x20statistics\x20calculated:','awaitingPayout','amountUSDT','shopId','statusChangedBy','asc','amountAfterGatewayCommissionUSDT','üí∞\x20[PAYOUT]\x20Merchant\x20','\x20\x20\x20üí∞\x20Total\x20turnover:\x20','COMPLETED','test_gateway','shop','create',']\x20Updating\x20password\x20for\x20user\x20','setDate','push','\x20\x20\x20üåç\x20Country:\x20','merchantEarnings',':\x20commission\x20=\x20','summary',',\x20userId:\x20','gatewaySettings','name','paymentsCount','2020-01-01','totalCommissionRate','convertToUSDT','setHours','dateFrom','klyme_eu',',\x20successful:\x20','error','\x20merchants','ceil',']\x20Password\x20not\x20provided\x20or\x20empty,\x20skipping\x20password\x20update','\x20->\x20','suspendUser','telegramId','bcryptjs','PENDING','\x20\x20\x20Gateway:\x20','paidAt','network','30d','averageCheckUSDT','findMany','cointopay','entries','_sum','parse','orderId','deletePayout','gateway','%\x20commission)','\x20USDT\x20(after\x20','üí∞\x20[PAYOUT]\x20Gateway\x20','getAllUsers','üìä\x20Getting\x20merchant\x20statistics\x20with\x20filters:','deleteUser','\x27\x20not\x20found.\x20Available\x20gateways:\x20','randomBytes','__importDefault','\x27\x20(from\x20\x27','üîê\x20[','customerName','period','externalPaymentUrl','merchantEarningsUSDT','CHARGEBACK','toLowerCase','\x27\x20as\x20is\x20(not\x20found\x20in\x20mappings)','month','merchantUrl','\x20USDT)','updateCustomerData','\x20\x20\x20üí∏\x20Total\x20payouts\x20(all\x20time):\x20','totalAmountAfterCommissionUSDT','periodFrom','publicKey','getAllPayouts','split','failUrl','üí∞\x20Shop\x20','gateways','sort','mastercard','trim','set','\x20paid\x20payments\x20for\x20analysis','getAllPayments','../types/gateway','%\x20from\x20','rapyd','averageCommissionRate','telegram'];a36_0x3c67=function(){return _0xc020da;};return a36_0x3c67();}const database_1=__importDefault(require(a36_0xdea0a0(0x177))),bcryptjs_1=__importDefault(require(a36_0xdea0a0(0x1e0))),crypto_1=__importDefault(require(a36_0xdea0a0(0x230))),currencyService_1=require(a36_0xdea0a0(0x14e)),gateway_1=require(a36_0xdea0a0(0x214));class AdminService{async[a36_0xdea0a0(0x116)](){const _0xe98607=a36_0xdea0a0;console[_0xe98607(0x223)](_0xe98607(0x167));const _0x3bca37=await database_1['default']['shop'][_0xe98607(0x179)]({'_sum':{'balance':!![],'totalPaidOut':!![]},'where':{'status':'ACTIVE'}}),_0x40bc3f=await this['getMerchantsAwaitingPayout']({'page':0x1,'limit':0x3e8}),_0x472bd4=await database_1[_0xe98607(0x12f)]['payment']['count']({'where':{'status':_0xe98607(0x117),'gateway':{'not':_0xe98607(0x1c4)}}}),_0x52d56b=new Date(),_0x534a22=new Date(_0x52d56b[_0xe98607(0x12a)](),_0x52d56b[_0xe98607(0x129)](),0x1),_0x44c481=new Date(_0x52d56b[_0xe98607(0x12a)](),_0x52d56b[_0xe98607(0x129)]()+0x1,0x0,0x17,0x3b,0x3b,0x3e7),_0x25a33a=await database_1[_0xe98607(0x12f)][_0xe98607(0x1a0)][_0xe98607(0x179)]({'_sum':{'amount':!![]},'where':{'createdAt':{'gte':_0x534a22,'lte':_0x44c481},'status':_0xe98607(0x1c3)}}),_0x36efd9=_0x3bca37[_0xe98607(0x1ea)][_0xe98607(0x12c)]||0x0,_0x516632=_0x40bc3f[_0xe98607(0x1cd)]['totalAmountAfterCommissionUSDT'],_0x28f197=_0x25a33a[_0xe98607(0x1ea)][_0xe98607(0x24d)]||0x0,_0x3cdbd6={'totalPayout':Math[_0xe98607(0x131)](_0x36efd9*0x64)/0x64,'awaitingPayout':Math[_0xe98607(0x131)](_0x516632*0x64)/0x64,'thisMonth':Math[_0xe98607(0x131)](_0x28f197*0x64)/0x64,'availableBalance':Math[_0xe98607(0x131)](_0x516632*0x64)/0x64,'totalPayments':_0x472bd4};return console[_0xe98607(0x223)](_0xe98607(0x1ba)),console[_0xe98607(0x223)]('\x20\x20\x20üí∞\x20Total\x20payout:\x20'+_0x3cdbd6['totalPayout']+_0xe98607(0x18a)),console['log'](_0xe98607(0x17d)+_0x3cdbd6[_0xe98607(0x1bb)]+_0xe98607(0x142)),console[_0xe98607(0x223)](_0xe98607(0x15f)+_0x3cdbd6[_0xe98607(0x1a3)]+_0xe98607(0x237)),console[_0xe98607(0x223)]('\x20\x20\x20üìÖ\x20This\x20month:\x20'+_0x3cdbd6[_0xe98607(0x121)]+_0xe98607(0x13c)),console[_0xe98607(0x223)]('\x20\x20\x20üí≥\x20Total\x20payments:\x20'+_0x3cdbd6['totalPayments']+_0xe98607(0x19e)),console[_0xe98607(0x223)](_0xe98607(0x224)+(_0x3bca37[_0xe98607(0x1ea)]['balance']||0x0)[_0xe98607(0x110)](0x2)+'\x20USDT\x20(without\x20commission)'),console[_0xe98607(0x223)](_0xe98607(0x13e)+((_0x3bca37['_sum'][_0xe98607(0x151)]||0x0)-_0x516632)['toFixed'](0x2)+_0xe98607(0x13c)),_0x3cdbd6;}async[a36_0xdea0a0(0x204)](_0x145731,_0x241219){const _0x292c76=a36_0xdea0a0;console[_0x292c76(0x223)](_0x292c76(0x120)+_0x145731+':',_0x241219);const _0x4c4a77=await database_1[_0x292c76(0x12f)][_0x292c76(0x16c)][_0x292c76(0x231)]({'where':{'id':_0x145731},'select':{'id':!![],'customerEmail':!![],'customerName':!![],'customerCountry':!![],'customerIp':!![],'customerUa':!![]}});if(!_0x4c4a77)throw new Error('Payment\x20not\x20found');const _0x4defb3={};_0x241219['customerCountry']!==undefined&&(_0x4defb3['customerCountry']=_0x241219['customerCountry']||null);_0x241219['customerIp']!==undefined&&(_0x4defb3['customerIp']=_0x241219[_0x292c76(0x153)]||null);_0x241219['customerUa']!==undefined&&(_0x4defb3['customerUa']=_0x241219[_0x292c76(0x23e)]||null);const _0xdab4b0=await database_1[_0x292c76(0x12f)][_0x292c76(0x16c)]['update']({'where':{'id':_0x145731},'data':{..._0x4defb3,'updatedAt':new Date()},'select':{'id':!![],'customerEmail':!![],'customerName':!![],'customerCountry':!![],'customerIp':!![],'customerUa':!![],'updatedAt':!![]}});return console[_0x292c76(0x223)]('‚úÖ\x20Customer\x20data\x20updated\x20for\x20payment\x20'+_0x145731),console['log'](_0x292c76(0x1ca)+_0x4c4a77[_0x292c76(0x150)]+_0x292c76(0x1dd)+_0xdab4b0[_0x292c76(0x150)]),console[_0x292c76(0x223)]('\x20\x20\x20üåê\x20IP:\x20'+_0x4c4a77[_0x292c76(0x153)]+'\x20->\x20'+_0xdab4b0[_0x292c76(0x153)]),console[_0x292c76(0x223)]('\x20\x20\x20üñ•Ô∏è\x20User\x20Agent:\x20'+(_0x4c4a77[_0x292c76(0x23e)]?_0x292c76(0x211):_0x292c76(0x233))+_0x292c76(0x1dd)+(_0xdab4b0[_0x292c76(0x23e)]?_0x292c76(0x211):_0x292c76(0x233))),_0xdab4b0;}async[a36_0xdea0a0(0x17c)](_0x20b1c8){const _0xe51373=a36_0xdea0a0,_0x551594=new Date();let _0x5ac10d;switch(_0x20b1c8[_0xe51373(0x1ff)]()){case _0xe51373(0x185):case _0xe51373(0x184):_0x5ac10d=new Date(_0x551594[_0xe51373(0x12a)](),_0x551594[_0xe51373(0x129)](),_0x551594[_0xe51373(0x180)](),0x0,0x0,0x0,0x0);break;case'7d':_0x5ac10d=new Date(_0x551594[_0xe51373(0x227)]()-0x7*0x18*0x3c*0x3c*0x3e8);break;case _0xe51373(0x1e5):_0x5ac10d=new Date(_0x551594[_0xe51373(0x227)]()-0x1e*0x18*0x3c*0x3c*0x3e8);break;case _0xe51373(0x194):_0x5ac10d=new Date(_0x551594[_0xe51373(0x227)]()-0x5a*0x18*0x3c*0x3c*0x3e8);break;case _0xe51373(0x23d):const _0xbc648f=await database_1[_0xe51373(0x12f)][_0xe51373(0x16c)][_0xe51373(0x23f)]({'where':{'gateway':{'not':_0xe51373(0x1c4)}},'orderBy':{'createdAt':_0xe51373(0x1bf)},'select':{'createdAt':!![]}});_0x5ac10d=_0xbc648f?_0xbc648f['createdAt']:new Date(_0xe51373(0x1d2));break;default:_0x5ac10d=new Date(_0x551594[_0xe51373(0x227)]()-0x1e*0x18*0x3c*0x3c*0x3e8);}_0x5ac10d[_0xe51373(0x1d5)](0x0,0x0,0x0,0x0);const [_0x20b59a,_0x4f1fea,_0x16a276,_0x592003,_0x3e44b8,_0x8b4683]=await Promise[_0xe51373(0x23d)]([database_1['default'][_0xe51373(0x1c5)][_0xe51373(0x1ac)](),database_1[_0xe51373(0x12f)]['shop']['count']({'where':{'status':_0xe51373(0x154)}}),database_1['default'][_0xe51373(0x16c)][_0xe51373(0x1ac)]({'where':{'status':_0xe51373(0x117),'createdAt':{'gte':_0x5ac10d},'gateway':{'not':'test_gateway'}}}),database_1['default'][_0xe51373(0x16c)]['findMany']({'where':{'status':_0xe51373(0x117),'createdAt':{'gte':_0x5ac10d},'gateway':{'not':'test_gateway'}},'select':{'amount':!![],'currency':!![],'amountAfterGatewayCommissionUSDT':!![]}}),database_1[_0xe51373(0x12f)][_0xe51373(0x16c)][_0xe51373(0x1e7)]({'where':{'gateway':{'not':'test_gateway'}},'take':0xa,'orderBy':{'createdAt':_0xe51373(0x229)},'include':{'shop':{'select':{'name':!![],'username':!![]}}}}),database_1['default']['payment'][_0xe51373(0x1e7)]({'where':{'createdAt':{'gte':_0x5ac10d},'gateway':{'not':_0xe51373(0x1c4)}},'select':{'amount':!![],'currency':!![],'status':!![],'amountUSDT':!![],'createdAt':!![]}})]);let _0x4ae6ff=0x0,_0x27f297=0x0;for(const _0x5356f4 of _0x592003){const _0x3c08c9=await currencyService_1[_0xe51373(0x232)][_0xe51373(0x1d4)](_0x5356f4['amount'],_0x5356f4[_0xe51373(0x14c)]);_0x4ae6ff+=_0x3c08c9;if(_0x5356f4['amountAfterGatewayCommissionUSDT']){const _0x13b721=await currencyService_1[_0xe51373(0x232)]['convertToUSDT'](_0x5356f4[_0xe51373(0x24d)],_0x5356f4[_0xe51373(0x14c)]),_0x46a2c2=_0x5356f4[_0xe51373(0x1c0)],_0x5e1166=_0x13b721-_0x46a2c2;_0x27f297+=_0x5e1166;}}const _0x460552=_0x16a276>0x0?_0x4ae6ff/_0x16a276:0x0,_0xdf2278=this[_0xe51373(0x19c)](_0x8b4683,_0x5ac10d,_0x551594),_0xeedf7c=await database_1['default'][_0xe51373(0x16c)][_0xe51373(0x1ac)]({'where':{'createdAt':{'gte':_0x5ac10d},'gateway':{'not':_0xe51373(0x1c4)}}}),_0x3e3536=_0xeedf7c>0x0?_0x16a276/_0xeedf7c*0x64:0x0;return{'totalShops':_0x20b59a,'activeShops':_0x4f1fea,'totalPayments':_0x16a276,'successfulPayments':_0x16a276,'totalAttempts':_0xeedf7c,'totalRevenue':Math[_0xe51373(0x131)](_0x4ae6ff*0x64)/0x64,'trapayEarnings':Math[_0xe51373(0x131)](_0x27f297*0x64)/0x64,'averagePaymentAmount':Math['round'](_0x460552*0x64)/0x64,'conversionRate':Math[_0xe51373(0x131)](_0x3e3536*0x64)/0x64,'dailyRevenue':_0xdf2278['dailyRevenue'],'dailyPayments':_0xdf2278[_0xe51373(0x193)],'recentPayments':_0x3e44b8['map'](_0x3c6b5b=>({'id':_0x3c6b5b['id'],'amount':_0x3c6b5b[_0xe51373(0x24d)],'currency':_0x3c6b5b[_0xe51373(0x14c)],'status':_0x3c6b5b[_0xe51373(0x1b2)],'gateway':_0x3c6b5b[_0xe51373(0x1ee)],'shop':_0x3c6b5b[_0xe51373(0x1c5)],'createdAt':_0x3c6b5b[_0xe51373(0x169)]}))};}async[a36_0xdea0a0(0x1b7)](_0x382e81){const _0x51a903=a36_0xdea0a0;console[_0x51a903(0x223)](_0x51a903(0x1f3),_0x382e81);let _0x5eefec,_0x55f6b0=new Date();if(_0x382e81['period']===_0x51a903(0x112)&&_0x382e81[_0x51a903(0x1d6)]&&_0x382e81[_0x51a903(0x192)])_0x5eefec=new Date(_0x382e81[_0x51a903(0x1d6)]),_0x55f6b0=new Date(_0x382e81['dateTo']),_0x5eefec[_0x51a903(0x1d5)](0x0,0x0,0x0,0x0),_0x55f6b0[_0x51a903(0x1d5)](0x17,0x3b,0x3b,0x3e7);else{const _0x3d7355=new Date();switch(_0x382e81[_0x51a903(0x1fb)]){case _0x51a903(0x241):_0x5eefec=new Date(_0x3d7355['getTime']()-0x7*0x18*0x3c*0x3c*0x3e8);break;case _0x51a903(0x201):_0x5eefec=new Date(_0x3d7355[_0x51a903(0x227)]()-0x1e*0x18*0x3c*0x3c*0x3e8);break;case _0x51a903(0x21d):_0x5eefec=new Date(_0x3d7355[_0x51a903(0x227)]()-0x16d*0x18*0x3c*0x3c*0x3e8);break;case _0x51a903(0x23d):default:_0x5eefec=new Date('2020-01-01');break;}_0x5eefec[_0x51a903(0x1d5)](0x0,0x0,0x0,0x0),_0x55f6b0[_0x51a903(0x1d5)](0x17,0x3b,0x3b,0x3e7);}console[_0x51a903(0x223)](_0x51a903(0x11c)+_0x5eefec[_0x51a903(0x144)]()+_0x51a903(0x12e)+_0x55f6b0[_0x51a903(0x144)]());const _0x123751={'status':_0x51a903(0x117),'gateway':{'not':_0x51a903(0x1c4)},'paidAt':{'gte':_0x5eefec,'lte':_0x55f6b0}};_0x382e81[_0x51a903(0x1bd)]&&(_0x123751[_0x51a903(0x1bd)]=_0x382e81[_0x51a903(0x1bd)]);const _0x3cb4a4=await database_1[_0x51a903(0x12f)][_0x51a903(0x16c)][_0x51a903(0x1e7)]({'where':_0x123751,'include':{'shop':{'select':{'id':!![],'name':!![],'username':!![],'gatewaySettings':!![]}}}});console[_0x51a903(0x223)](_0x51a903(0x174)+_0x3cb4a4[_0x51a903(0x15c)]+_0x51a903(0x212));const _0x4983b6={'gateway':{'not':_0x51a903(0x1c4)},'createdAt':{'gte':_0x5eefec,'lte':_0x55f6b0}};_0x382e81[_0x51a903(0x1bd)]&&(_0x4983b6[_0x51a903(0x1bd)]=_0x382e81[_0x51a903(0x1bd)]);const _0x2bfdff=await database_1['default']['payment'][_0x51a903(0x1ac)]({'where':_0x4983b6});console[_0x51a903(0x223)](_0x51a903(0x173)+_0x2bfdff+_0x51a903(0x1d8)+_0x3cb4a4[_0x51a903(0x15c)]);let _0x499aec=0x0,_0x22fd5d=0x0,_0x5738c0=0x0;const _0x2e3f60={},_0x413b94={},_0x3da478={};for(const _0x3d8312 of _0x3cb4a4){try{const _0x4c1fa1=await currencyService_1['currencyService']['convertToUSDT'](_0x3d8312[_0x51a903(0x24d)],_0x3d8312[_0x51a903(0x14c)]);let _0x3fd37d={};if(_0x3d8312[_0x51a903(0x1c5)][_0x51a903(0x1cf)])try{_0x3fd37d=JSON['parse'](_0x3d8312[_0x51a903(0x1c5)][_0x51a903(0x1cf)]);}catch(_0x435550){console[_0x51a903(0x1d9)](_0x51a903(0x189)+_0x3d8312[_0x51a903(0x1bd)]+':',_0x435550);}let _0x2eef7e={},_0x116fce=0x2d;for(const [_0xf87590,_0x4090bd]of Object[_0x51a903(0x1e9)](_0x3fd37d)){if(_0xf87590['toLowerCase']()===_0x3d8312[_0x51a903(0x1ee)][_0x51a903(0x1ff)]()){_0x2eef7e=_0x4090bd,_0x116fce=_0x4090bd[_0x51a903(0x17b)]||0xa;break;}}let _0x178125,_0x179cb8;_0x3d8312[_0x51a903(0x1c0)]!==null&&_0x3d8312['amountAfterGatewayCommissionUSDT']!==undefined?(_0x178125=_0x3d8312[_0x51a903(0x1c0)],_0x179cb8=_0x4c1fa1-_0x178125,console['log']('üìä\x20Using\x20saved\x20amountAfterGatewayCommissionUSDT:\x20'+_0x178125[_0x51a903(0x110)](0x6)+'\x20USDT\x20for\x20payment\x20'+_0x3d8312['id'])):(_0x179cb8=_0x4c1fa1*(_0x116fce/0x64),_0x178125=_0x4c1fa1-_0x179cb8,console[_0x51a903(0x223)](_0x51a903(0x247)+_0x3d8312['id']+':\x20'+_0x116fce+_0x51a903(0x215)+_0x4c1fa1[_0x51a903(0x110)](0x6)+'\x20USDT'));_0x499aec+=_0x4c1fa1,_0x22fd5d+=_0x178125,_0x5738c0+=_0x179cb8;!_0x2e3f60[_0x3d8312[_0x51a903(0x1ee)]]&&(_0x2e3f60[_0x3d8312['gateway']]={'gateway':_0x3d8312['gateway'],'gatewayDisplayName':this[_0x51a903(0x11d)](_0x3d8312[_0x51a903(0x1ee)]),'paymentsCount':0x0,'turnoverUSDT':0x0,'commissionUSDT':0x0,'merchantEarningsUSDT':0x0,'totalCommissionRate':0x0});_0x2e3f60[_0x3d8312[_0x51a903(0x1ee)]]['paymentsCount']++,_0x2e3f60[_0x3d8312[_0x51a903(0x1ee)]]['turnoverUSDT']+=_0x4c1fa1,_0x2e3f60[_0x3d8312[_0x51a903(0x1ee)]][_0x51a903(0x158)]+=_0x179cb8,_0x2e3f60[_0x3d8312[_0x51a903(0x1ee)]][_0x51a903(0x1fd)]+=_0x178125,_0x2e3f60[_0x3d8312[_0x51a903(0x1ee)]]['totalCommissionRate']+=_0x116fce;!_0x382e81[_0x51a903(0x1bd)]&&(!_0x413b94[_0x3d8312[_0x51a903(0x1bd)]]&&(_0x413b94[_0x3d8312[_0x51a903(0x1bd)]]={'shopId':_0x3d8312[_0x51a903(0x1bd)],'shopName':_0x3d8312[_0x51a903(0x1c5)][_0x51a903(0x1d0)],'shopUsername':_0x3d8312[_0x51a903(0x1c5)][_0x51a903(0x14d)],'paymentsCount':0x0,'turnoverUSDT':0x0,'commissionUSDT':0x0,'merchantEarningsUSDT':0x0,'paidOutUSDT':0x0,'averageCheckUSDT':0x0}),_0x413b94[_0x3d8312['shopId']]['paymentsCount']++,_0x413b94[_0x3d8312[_0x51a903(0x1bd)]]['turnoverUSDT']+=_0x4c1fa1,_0x413b94[_0x3d8312['shopId']][_0x51a903(0x158)]+=_0x179cb8,_0x413b94[_0x3d8312['shopId']][_0x51a903(0x1fd)]+=_0x178125);const _0x1119f7=_0x3d8312['paidAt'][_0x51a903(0x144)]()[_0x51a903(0x20a)]('T')[0x0];!_0x3da478[_0x1119f7]&&(_0x3da478[_0x1119f7]={'date':_0x1119f7,'turnover':0x0,'merchantEarnings':0x0,'gatewayEarnings':0x0,'paymentsCount':0x0}),_0x3da478[_0x1119f7]['turnover']+=_0x4c1fa1,_0x3da478[_0x1119f7][_0x51a903(0x1cb)]+=_0x178125,_0x3da478[_0x1119f7]['gatewayEarnings']+=_0x179cb8,_0x3da478[_0x1119f7][_0x51a903(0x1d1)]++;}catch(_0x45f9b9){console[_0x51a903(0x1d9)](_0x51a903(0x228)+_0x3d8312['id']+':',_0x45f9b9);}}Object[_0x51a903(0x24f)](_0x2e3f60)[_0x51a903(0x250)](_0x63113=>{const _0x4472e4=_0x51a903;_0x63113[_0x4472e4(0x217)]=_0x63113[_0x4472e4(0x1d1)]>0x0?_0x63113[_0x4472e4(0x1d3)]/_0x63113['paymentsCount']:0x0,delete _0x63113['totalCommissionRate'];}),Object[_0x51a903(0x24f)](_0x413b94)['forEach'](_0x1ff7ce=>{const _0x1f5ccd=_0x51a903;_0x1ff7ce[_0x1f5ccd(0x1e6)]=_0x1ff7ce[_0x1f5ccd(0x1d1)]>0x0?_0x1ff7ce['turnoverUSDT']/_0x1ff7ce['paymentsCount']:0x0;});let _0x1ba258=0x0,_0x47f330=0x0;if(_0x382e81[_0x51a903(0x1bd)]){const _0x301adb=await database_1[_0x51a903(0x12f)][_0x51a903(0x1a0)]['findMany']({'where':{'shopId':_0x382e81[_0x51a903(0x1bd)],'status':'COMPLETED','createdAt':{'gte':_0x5eefec,'lte':_0x55f6b0}},'select':{'amount':!![]}});_0x1ba258=_0x301adb['reduce']((_0x5c900d,_0x1daa6f)=>_0x5c900d+_0x1daa6f[_0x51a903(0x24d)],0x0);const _0x4d37bf=await database_1[_0x51a903(0x12f)][_0x51a903(0x1a0)][_0x51a903(0x1e7)]({'where':{'shopId':_0x382e81[_0x51a903(0x1bd)],'status':_0x51a903(0x1e1),'createdAt':{'gte':_0x5eefec,'lte':_0x55f6b0}},'select':{'amount':!![]}});_0x47f330=_0x4d37bf[_0x51a903(0x19f)]((_0x5c27a4,_0x36d738)=>_0x5c27a4+_0x36d738[_0x51a903(0x24d)],0x0);}const _0xdd9aa3=_0x2bfdff,_0x6af228=_0x3cb4a4[_0x51a903(0x15c)],_0x50e7ed=_0x6af228>0x0?_0x499aec/_0x6af228:0x0,_0x1c31aa=_0xdd9aa3>0x0?Math['round'](_0x6af228/_0xdd9aa3*0x2710)/0x64:0x0,_0x30447e=Math[_0x51a903(0x1db)]((_0x55f6b0[_0x51a903(0x227)]()-_0x5eefec[_0x51a903(0x227)]())/(0x3e8*0x3c*0x3c*0x18)),_0x5ddbc6={'totalTurnover':Math[_0x51a903(0x131)](_0x499aec*0x64)/0x64,'merchantEarnings':Math[_0x51a903(0x131)](_0x22fd5d*0x64)/0x64,'gatewayEarnings':Math['round'](_0x5738c0*0x64)/0x64,'totalPaidOut':Math[_0x51a903(0x131)](_0x1ba258*0x64)/0x64,'pendingPayout':Math[_0x51a903(0x131)](_0x47f330*0x64)/0x64,'averageCheck':Math[_0x51a903(0x131)](_0x50e7ed*0x64)/0x64,'totalPayments':_0xdd9aa3,'successfulPayments':_0x6af228,'conversionRate':_0x1c31aa,'gatewayBreakdown':Object[_0x51a903(0x24f)](_0x2e3f60)['map'](_0x16da57=>({..._0x16da57,'turnoverUSDT':Math[_0x51a903(0x131)](_0x16da57[_0x51a903(0x1a8)]*0x64)/0x64,'commissionUSDT':Math[_0x51a903(0x131)](_0x16da57[_0x51a903(0x158)]*0x64)/0x64,'merchantEarningsUSDT':Math[_0x51a903(0x131)](_0x16da57[_0x51a903(0x1fd)]*0x64)/0x64,'averageCommissionRate':Math[_0x51a903(0x131)](_0x16da57[_0x51a903(0x217)]*0x64)/0x64})),'merchantBreakdown':_0x382e81[_0x51a903(0x1bd)]?undefined:Object[_0x51a903(0x24f)](_0x413b94)['map'](_0x3381fd=>({..._0x3381fd,'turnoverUSDT':Math['round'](_0x3381fd[_0x51a903(0x1a8)]*0x64)/0x64,'commissionUSDT':Math[_0x51a903(0x131)](_0x3381fd[_0x51a903(0x158)]*0x64)/0x64,'merchantEarningsUSDT':Math[_0x51a903(0x131)](_0x3381fd[_0x51a903(0x1fd)]*0x64)/0x64,'paidOutUSDT':Math['round'](_0x3381fd[_0x51a903(0x219)]*0x64)/0x64,'averageCheckUSDT':Math[_0x51a903(0x131)](_0x3381fd['averageCheckUSDT']*0x64)/0x64})),'dailyData':Object[_0x51a903(0x24f)](_0x3da478)[_0x51a903(0x1a1)](_0x958a5d=>({..._0x958a5d,'turnover':Math['round'](_0x958a5d['turnover']*0x64)/0x64,'merchantEarnings':Math[_0x51a903(0x131)](_0x958a5d[_0x51a903(0x1cb)]*0x64)/0x64,'gatewayEarnings':Math[_0x51a903(0x131)](_0x958a5d[_0x51a903(0x23b)]*0x64)/0x64}))[_0x51a903(0x20e)]((_0x52a146,_0x41da5b)=>_0x52a146[_0x51a903(0x10f)][_0x51a903(0x168)](_0x41da5b[_0x51a903(0x10f)])),'periodInfo':{'from':_0x5eefec,'to':_0x55f6b0,'periodType':_0x382e81[_0x51a903(0x1fb)]||_0x51a903(0x112),'daysCount':_0x30447e}};return console[_0x51a903(0x223)](_0x51a903(0x21e)),console['log'](_0x51a903(0x1c2)+_0x5ddbc6[_0x51a903(0x1ab)]+_0x51a903(0x13c)),console[_0x51a903(0x223)]('\x20\x20\x20üë§\x20Merchant\x20earnings:\x20'+_0x5ddbc6['merchantEarnings']+_0x51a903(0x13c)),console[_0x51a903(0x223)](_0x51a903(0x15d)+_0x5ddbc6[_0x51a903(0x23b)]+_0x51a903(0x13c)),console[_0x51a903(0x223)](_0x51a903(0x157)+_0x5ddbc6[_0x51a903(0x12c)]+_0x51a903(0x13c)),console[_0x51a903(0x223)](_0x51a903(0x17a)+_0x5ddbc6[_0x51a903(0x178)]+_0x51a903(0x13c)),console[_0x51a903(0x223)](_0x51a903(0x162)+_0x5ddbc6['totalPayments']),_0x5ddbc6;}async[a36_0xdea0a0(0x128)](){const _0x51aede=a36_0xdea0a0;console[_0x51aede(0x223)](_0x51aede(0x234));const _0x458bd7=await database_1[_0x51aede(0x12f)][_0x51aede(0x1c5)][_0x51aede(0x1e7)]({'where':{'status':'ACTIVE'},'select':{'id':!![],'username':!![],'name':!![]},'orderBy':{'name':_0x51aede(0x1bf)}});return console[_0x51aede(0x223)](_0x51aede(0x239)+_0x458bd7[_0x51aede(0x15c)]+'\x20active\x20merchants\x20for\x20selection'),_0x458bd7[_0x51aede(0x1a1)](_0x16466d=>({'id':_0x16466d['id'],'username':_0x16466d['username'],'name':_0x16466d[_0x51aede(0x1d0)]}));}['getGatewayDisplayName'](_0x2025c6){const _0x536af4=a36_0xdea0a0,_0x80430d={'test_gateway':'Test\x20Gateway','plisio':'Plisio','rapyd':'Rapyd','noda':_0x536af4(0x146),'cointopay':_0x536af4(0x22e),'cointopay2':_0x536af4(0x137),'klyme_eu':_0x536af4(0x114),'klyme_gb':_0x536af4(0x13a),'klyme_de':_0x536af4(0x161),'mastercard':'MasterCard'};return _0x80430d[_0x2025c6]||_0x2025c6;}[a36_0xdea0a0(0x190)](_0x2782f0){const _0x8ddf52=a36_0xdea0a0,_0x552d1c={'Test\x20Gateway':_0x8ddf52(0x1c4),'Plisio':_0x8ddf52(0x22d),'Rapyd':_0x8ddf52(0x216),'Noda':_0x8ddf52(0x225),'CoinToPay':_0x8ddf52(0x1e8),'CoinToPay2':'cointopay2','KLYME\x20EU':_0x8ddf52(0x1d7),'KLYME\x20GB':'klyme_gb','KLYME\x20DE':'klyme_de','MasterCard':_0x8ddf52(0x20f)};return _0x552d1c[_0x2782f0]||_0x2782f0['toLowerCase']();}async[a36_0xdea0a0(0x111)](_0x5ef886){const _0x58c85e=a36_0xdea0a0,{page:_0x37affc,limit:_0x2475aa,minAmount:_0x4a4514,search:_0x2eea84}=_0x5ef886,_0x10a266=(_0x37affc-0x1)*_0x2475aa;console[_0x58c85e(0x223)](_0x58c85e(0x22a),_0x5ef886);const _0x206be0={'balance':{'gt':0x0},'status':_0x58c85e(0x154)};_0x4a4514&&(_0x206be0[_0x58c85e(0x151)][_0x58c85e(0x143)]=_0x4a4514);_0x2eea84&&(_0x206be0[_0x58c85e(0x1d0)]={'contains':_0x2eea84,'mode':_0x58c85e(0x15a)});const [_0x465e93,_0x47c563]=await Promise['all']([database_1[_0x58c85e(0x12f)][_0x58c85e(0x1c5)]['findMany']({'where':_0x206be0,'skip':_0x10a266,'take':_0x2475aa,'orderBy':{'balance':_0x58c85e(0x229)},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'balance':!![],'totalPaidOut':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'gatewaySettings':!![],'createdAt':!![]}}),database_1[_0x58c85e(0x12f)][_0x58c85e(0x1c5)][_0x58c85e(0x1ac)]({'where':_0x206be0})]);console['log'](_0x58c85e(0x174)+_0x465e93[_0x58c85e(0x15c)]+_0x58c85e(0x196));const _0x3fd8f5=await Promise[_0x58c85e(0x23d)](_0x465e93['map'](async _0x37a54f=>{const _0x19f237=_0x58c85e,[_0x45a415,_0x5a9502,_0xf102a5]=await Promise['all']([database_1[_0x19f237(0x12f)][_0x19f237(0x16c)][_0x19f237(0x1ac)]({'where':{'shopId':_0x37a54f['id'],'status':_0x19f237(0x117),'gateway':{'not':_0x19f237(0x1c4)}}}),database_1['default']['payment'][_0x19f237(0x23f)]({'where':{'shopId':_0x37a54f['id'],'status':_0x19f237(0x117),'gateway':{'not':_0x19f237(0x1c4)}},'orderBy':{'paidAt':_0x19f237(0x1bf)},'select':{'paidAt':!![]}}),database_1['default'][_0x19f237(0x16c)][_0x19f237(0x18b)]({'by':[_0x19f237(0x1ee)],'where':{'shopId':_0x37a54f['id'],'status':'PAID','gateway':{'not':_0x19f237(0x1c4)}},'_count':{'id':!![]},'_sum':{'amountUSDT':!![]}})]),_0x2f6060=new Date(),_0x23b5f4=new Date(_0x2f6060[_0x19f237(0x12a)](),_0x2f6060[_0x19f237(0x129)](),0x1),_0x238439=new Date(_0x2f6060[_0x19f237(0x12a)](),_0x2f6060[_0x19f237(0x129)]()+0x1,0x0,0x17,0x3b,0x3b,0x3e7),[_0x4016c5,_0x4dac53]=await Promise['all']([database_1[_0x19f237(0x12f)][_0x19f237(0x1a0)]['aggregate']({'_sum':{'amount':!![]},'where':{'shopId':_0x37a54f['id'],'status':_0x19f237(0x1c3)}}),database_1[_0x19f237(0x12f)]['payout'][_0x19f237(0x179)]({'_sum':{'amount':!![]},'where':{'shopId':_0x37a54f['id'],'status':'COMPLETED','createdAt':{'gte':_0x23b5f4,'lte':_0x238439}}})]),_0x7b72a5=_0x4016c5[_0x19f237(0x1ea)][_0x19f237(0x24d)]||0x0,_0x541d7b=_0x4dac53[_0x19f237(0x1ea)]['amount']||0x0,_0x310483=await Promise[_0x19f237(0x23d)](_0xf102a5[_0x19f237(0x1a1)](async _0x427d04=>{const _0x49d0a9=_0x19f237;let _0x127929=0x2d;if(_0x37a54f[_0x49d0a9(0x1cf)])try{const _0x4578f8=JSON[_0x49d0a9(0x1eb)](_0x37a54f['gatewaySettings']);for(const [_0xcd785d,_0x25cca4]of Object[_0x49d0a9(0x1e9)](_0x4578f8)){if(_0xcd785d[_0x49d0a9(0x1ff)]()===_0x427d04[_0x49d0a9(0x1ee)][_0x49d0a9(0x1ff)]()){_0x127929=_0x25cca4[_0x49d0a9(0x17b)]||0xa,console[_0x49d0a9(0x223)](_0x49d0a9(0x1f1)+_0x427d04['gateway']+_0x49d0a9(0x21c)+_0x37a54f['id']+_0x49d0a9(0x1cc)+_0x127929+'%');break;}}}catch(_0x41676a){console['error']('Error\x20parsing\x20gateway\x20settings\x20for\x20shop\x20'+_0x37a54f['id']+':',_0x41676a);}const _0x4f40fa=_0x427d04[_0x49d0a9(0x1ea)]?.[_0x49d0a9(0x1bc)]||0x0,_0x4358c1=_0x4f40fa*(0x1-_0x127929/0x64);return{'gateway':_0x427d04[_0x49d0a9(0x1ee)],'count':_0x427d04[_0x49d0a9(0x16d)]?.['id']||0x0,'amountUSDT':Math[_0x49d0a9(0x131)](_0x4f40fa*0x64)/0x64,'amountAfterCommissionUSDT':Math[_0x49d0a9(0x131)](_0x4358c1*0x64)/0x64,'commission':_0x127929};})),_0x75c9ab=_0x310483[_0x19f237(0x19f)]((_0xcbf96d,_0x2ba2eb)=>_0xcbf96d+_0x2ba2eb[_0x19f237(0x1bc)],0x0),_0x4b61ec=_0x37a54f['balance'];return console['log'](_0x19f237(0x1c1)+_0x37a54f[_0x19f237(0x14d)]+':'),console['log']('\x20\x20\x20ÔøΩ\x20Total\x20payments\x20turnover:\x20'+_0x75c9ab[_0x19f237(0x110)](0x2)+'\x20USDT\x20(gross\x20revenue)'),console[_0x19f237(0x223)](_0x19f237(0x191)+_0x310483[_0x19f237(0x19f)]((_0x5ba917,_0x32760c)=>_0x5ba917+_0x32760c[_0x19f237(0x197)],0x0)[_0x19f237(0x110)](0x2)+_0x19f237(0x14f)),console[_0x19f237(0x223)](_0x19f237(0x11f)+_0x4b61ec['toFixed'](0x2)+_0x19f237(0x21b)),{'id':_0x37a54f['id'],'fullName':_0x37a54f['name'],'username':_0x37a54f[_0x19f237(0x14d)],'telegramId':_0x37a54f[_0x19f237(0x218)],'merchantUrl':_0x37a54f[_0x19f237(0x1a9)],'wallets':{'usdtPolygonWallet':_0x37a54f[_0x19f237(0x1b5)],'usdtTrcWallet':_0x37a54f[_0x19f237(0x164)],'usdtErcWallet':_0x37a54f[_0x19f237(0x159)],'usdcPolygonWallet':_0x37a54f['usdcPolygonWallet']},'totalAmountUSDT':Math[_0x19f237(0x131)](_0x75c9ab*0x64)/0x64,'totalAmountAfterCommissionUSDT':Math[_0x19f237(0x131)](_0x4b61ec*0x64)/0x64,'totalPayout':Math['round'](_0x7b72a5*0x64)/0x64,'thisMonth':Math['round'](_0x541d7b*0x64)/0x64,'paymentsCount':_0x45a415,'oldestPaymentDate':_0x5a9502?.[_0x19f237(0x1e3)]||_0x37a54f[_0x19f237(0x169)],'gatewayBreakdown':_0x310483};})),_0x10d4b3=_0x3fd8f5[_0x58c85e(0x19f)]((_0x12829f,_0x19b142)=>_0x12829f+_0x19b142[_0x58c85e(0x11e)],0x0),_0x38b4f6=_0x3fd8f5[_0x58c85e(0x19f)]((_0x2ec84d,_0xe39983)=>_0x2ec84d+_0xe39983[_0x58c85e(0x206)],0x0),_0x3d6a91=_0x3fd8f5['reduce']((_0x3397fb,_0x2fffa1)=>_0x3397fb+_0x2fffa1['totalPayout'],0x0),_0xfc8503=_0x3fd8f5['reduce']((_0x42693c,_0x533d5a)=>_0x42693c+_0x533d5a[_0x58c85e(0x121)],0x0);return console[_0x58c85e(0x223)]('üìä\x20Merchants\x20awaiting\x20payout:\x20'+_0x47c563+_0x58c85e(0x1da)),console[_0x58c85e(0x223)](_0x58c85e(0x132)+Math[_0x58c85e(0x131)](_0x10d4b3*0x64)/0x64+_0x58c85e(0x23a)),console[_0x58c85e(0x223)]('\x20\x20\x20‚úÖ\x20Total\x20available\x20for\x20payout:\x20'+Math[_0x58c85e(0x131)](_0x38b4f6*0x64)/0x64+_0x58c85e(0x1a2)),console[_0x58c85e(0x223)](_0x58c85e(0x205)+Math[_0x58c85e(0x131)](_0x3d6a91*0x64)/0x64+_0x58c85e(0x13c)),console[_0x58c85e(0x223)](_0x58c85e(0x243)+Math[_0x58c85e(0x131)](_0xfc8503*0x64)/0x64+_0x58c85e(0x13c)),{'merchants':_0x3fd8f5,'pagination':{'page':_0x37affc,'limit':_0x2475aa,'total':_0x47c563,'totalPages':Math[_0x58c85e(0x1db)](_0x47c563/_0x2475aa)},'summary':{'totalMerchants':_0x47c563,'totalAmountUSDT':Math[_0x58c85e(0x131)](_0x10d4b3*0x64)/0x64,'totalAmountAfterCommissionUSDT':Math[_0x58c85e(0x131)](_0x38b4f6*0x64)/0x64,'totalPayout':Math[_0x58c85e(0x131)](_0x3d6a91*0x64)/0x64,'thisMonth':Math[_0x58c85e(0x131)](_0xfc8503*0x64)/0x64}};}async['createPayout'](_0x4244e3){const _0x41093c=a36_0xdea0a0,{shopId:_0x2fea28,amount:_0x467bce,network:_0x33aad6,wallet:_0xd40219,notes:_0x1f2cd4,txid:_0x4110f8,periodFrom:_0xf45ba7,periodTo:_0x5f5d82}=_0x4244e3,_0x4d6e39=await database_1[_0x41093c(0x12f)]['$transaction'](async _0x411cae=>{const _0x1f235e=_0x41093c,_0x9428ed=await _0x411cae[_0x1f235e(0x1c5)][_0x1f235e(0x231)]({'where':{'id':_0x2fea28},'select':{'id':!![],'name':!![],'username':!![],'balance':!![],'totalPaidOut':!![]}});if(!_0x9428ed)throw new Error('Shop\x20not\x20found');console[_0x1f235e(0x223)](_0x1f235e(0x11b)+_0x9428ed[_0x1f235e(0x14d)]+':'),console[_0x1f235e(0x223)]('\x20\x20\x20Current\x20balance:\x20'+_0x9428ed[_0x1f235e(0x151)][_0x1f235e(0x110)](0x6)+_0x1f235e(0x13c)),console[_0x1f235e(0x223)](_0x1f235e(0x24c)+_0x467bce[_0x1f235e(0x110)](0x6)+_0x1f235e(0x13c)),console[_0x1f235e(0x223)](_0x1f235e(0x1b3)+_0x9428ed['totalPaidOut'][_0x1f235e(0x110)](0x6)+_0x1f235e(0x13c));if(_0x4110f8)console['log']('\x20\x20\x20Transaction\x20hash:\x20'+_0x4110f8);if(_0x9428ed['balance']<_0x467bce)throw new Error(_0x1f235e(0x18c)+_0x9428ed[_0x1f235e(0x151)][_0x1f235e(0x110)](0x6)+_0x1f235e(0x170)+_0x467bce['toFixed'](0x6)+'\x20USDT');let _0x5ac5f1=_0xd40219;if(!_0x5ac5f1){const _0x5e4b65=await _0x411cae[_0x1f235e(0x1c5)]['findUnique']({'where':{'id':_0x2fea28},'select':{'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![]}});if(_0x5e4b65)switch(_0x33aad6){case _0x1f235e(0x134):_0x5ac5f1=_0x5e4b65[_0x1f235e(0x1b5)]||undefined;break;case _0x1f235e(0x24b):_0x5ac5f1=_0x5e4b65[_0x1f235e(0x164)]||undefined;break;case _0x1f235e(0x18f):_0x5ac5f1=_0x5e4b65[_0x1f235e(0x159)]||undefined;break;case _0x1f235e(0x22c):_0x5ac5f1=_0x5e4b65[_0x1f235e(0x24a)]||undefined;break;}}console[_0x1f235e(0x223)](_0x1f235e(0x183)+_0x33aad6+':\x20'+(_0x5ac5f1||_0x1f235e(0x15b)));const _0x2d1d0a=await _0x411cae[_0x1f235e(0x1a0)][_0x1f235e(0x1c6)]({'data':{'shopId':_0x2fea28,'amount':_0x467bce,'network':_0x33aad6,'status':_0x1f235e(0x1c3),'txid':_0x4110f8,'notes':_0x1f2cd4,'periodFrom':_0xf45ba7?new Date(_0xf45ba7):null,'periodTo':_0x5f5d82?new Date(_0x5f5d82):null,'createdAt':new Date(),'paidAt':new Date()}}),_0x27d5bd=_0x9428ed[_0x1f235e(0x151)]-_0x467bce,_0x7a6348=_0x9428ed['totalPaidOut']+_0x467bce;return await _0x411cae[_0x1f235e(0x1c5)][_0x1f235e(0x1af)]({'where':{'id':_0x2fea28},'data':{'balance':_0x27d5bd,'totalPaidOut':_0x7a6348}}),console['log'](_0x1f235e(0x20c)+_0x9428ed[_0x1f235e(0x14d)]+_0x1f235e(0x244)),console[_0x1f235e(0x223)](_0x1f235e(0x1ad)+_0x9428ed['balance'][_0x1f235e(0x110)](0x6)+_0x1f235e(0x1dd)+_0x27d5bd[_0x1f235e(0x110)](0x6)+_0x1f235e(0x181)+_0x467bce['toFixed'](0x6)+')'),console[_0x1f235e(0x223)](_0x1f235e(0x171)+_0x9428ed[_0x1f235e(0x12c)][_0x1f235e(0x110)](0x6)+_0x1f235e(0x1dd)+_0x7a6348[_0x1f235e(0x110)](0x6)+_0x1f235e(0x21f)+_0x467bce[_0x1f235e(0x110)](0x6)+')'),{'payout':_0x2d1d0a,'shop':_0x9428ed};});return console[_0x41093c(0x223)](_0x41093c(0x13f)+_0x4d6e39[_0x41093c(0x1a0)]['id']+_0x41093c(0x21c)+_0x4d6e39[_0x41093c(0x1c5)][_0x41093c(0x14d)]+'\x20('+_0x467bce+_0x41093c(0x203)),{'id':_0x4d6e39['payout']['id'],'shopId':_0x4d6e39['payout'][_0x41093c(0x1bd)],'shopName':_0x4d6e39[_0x41093c(0x1c5)][_0x41093c(0x1d0)],'shopUsername':_0x4d6e39[_0x41093c(0x1c5)][_0x41093c(0x14d)],'amount':_0x4d6e39[_0x41093c(0x1a0)][_0x41093c(0x24d)],'network':_0x4d6e39[_0x41093c(0x1a0)][_0x41093c(0x1e4)],'status':_0x4d6e39[_0x41093c(0x1a0)][_0x41093c(0x1b2)],'txid':_0x4d6e39[_0x41093c(0x1a0)]['txid'],'notes':_0x4d6e39[_0x41093c(0x1a0)][_0x41093c(0x199)],'periodFrom':_0x4d6e39['payout'][_0x41093c(0x207)],'periodTo':_0x4d6e39[_0x41093c(0x1a0)]['periodTo'],'createdAt':_0x4d6e39[_0x41093c(0x1a0)][_0x41093c(0x169)],'paidAt':_0x4d6e39['payout']['paidAt']};}async[a36_0xdea0a0(0x209)](_0x57dc33){const _0xa27b65=a36_0xdea0a0,{page:_0x2b873c,limit:_0x4f127a,shopId:_0x231238,network:_0x198e98,dateFrom:_0x22ad2e,dateTo:_0x318cd7,search:_0x306799}=_0x57dc33,_0x4deca1=(_0x2b873c-0x1)*_0x4f127a,_0x1f2e7b={};_0x231238&&(_0x1f2e7b[_0xa27b65(0x1bd)]=_0x231238);_0x198e98&&(_0x1f2e7b[_0xa27b65(0x1e4)]=_0x198e98);(_0x22ad2e||_0x318cd7)&&(_0x1f2e7b['createdAt']={},_0x22ad2e&&(_0x1f2e7b[_0xa27b65(0x169)][_0xa27b65(0x143)]=new Date(_0x22ad2e)),_0x318cd7&&(_0x1f2e7b[_0xa27b65(0x169)]['lte']=new Date(_0x318cd7)));_0x306799&&(_0x1f2e7b['OR']=[{'shop':{'name':{'contains':_0x306799,'mode':'insensitive'}}},{'shop':{'username':{'contains':_0x306799,'mode':_0xa27b65(0x15a)}}},{'notes':{'contains':_0x306799,'mode':'insensitive'}}]);const [_0xc91cc8,_0x338536]=await Promise[_0xa27b65(0x23d)]([database_1[_0xa27b65(0x12f)][_0xa27b65(0x1a0)]['findMany']({'where':_0x1f2e7b,'skip':_0x4deca1,'take':_0x4f127a,'orderBy':{'createdAt':'desc'},'select':{'id':!![],'shopId':!![],'amount':!![],'network':!![],'status':!![],'txid':!![],'notes':!![],'periodFrom':!![],'periodTo':!![],'createdAt':!![],'paidAt':!![],'shop':{'select':{'name':!![],'username':!![]}}}}),database_1['default'][_0xa27b65(0x1a0)][_0xa27b65(0x1ac)]({'where':_0x1f2e7b})]);return{'payouts':_0xc91cc8[_0xa27b65(0x1a1)](_0x9a56f6=>({'id':_0x9a56f6['id'],'shopId':_0x9a56f6[_0xa27b65(0x1bd)],'shopName':_0x9a56f6[_0xa27b65(0x1c5)]['name'],'shopUsername':_0x9a56f6[_0xa27b65(0x1c5)]['username'],'amount':_0x9a56f6[_0xa27b65(0x24d)],'network':_0x9a56f6[_0xa27b65(0x1e4)],'status':_0x9a56f6['status'],'txid':_0x9a56f6[_0xa27b65(0x123)],'notes':_0x9a56f6[_0xa27b65(0x199)],'periodFrom':_0x9a56f6['periodFrom'],'periodTo':_0x9a56f6[_0xa27b65(0x15e)],'createdAt':_0x9a56f6['createdAt'],'paidAt':_0x9a56f6['paidAt']})),'pagination':{'page':_0x2b873c,'limit':_0x4f127a,'total':_0x338536,'totalPages':Math[_0xa27b65(0x1db)](_0x338536/_0x4f127a)}};}async[a36_0xdea0a0(0x18d)](_0x5d1e43){const _0x3e3e33=a36_0xdea0a0,_0x146431=await database_1[_0x3e3e33(0x12f)][_0x3e3e33(0x1a0)][_0x3e3e33(0x231)]({'where':{'id':_0x5d1e43},'include':{'shop':{'select':{'name':!![],'username':!![]}}}});if(!_0x146431)return null;return{'id':_0x146431['id'],'shopId':_0x146431['shopId'],'shopName':_0x146431[_0x3e3e33(0x1c5)][_0x3e3e33(0x1d0)],'shopUsername':_0x146431[_0x3e3e33(0x1c5)][_0x3e3e33(0x14d)],'amount':_0x146431[_0x3e3e33(0x24d)],'network':_0x146431[_0x3e3e33(0x1e4)],'status':_0x146431['status'],'txid':_0x146431[_0x3e3e33(0x123)],'notes':_0x146431['notes'],'periodFrom':_0x146431[_0x3e3e33(0x207)],'periodTo':_0x146431[_0x3e3e33(0x15e)],'createdAt':_0x146431[_0x3e3e33(0x169)],'paidAt':_0x146431[_0x3e3e33(0x1e3)]};}async[a36_0xdea0a0(0x1ed)](_0x3833d2){const _0x1e219c=a36_0xdea0a0;await database_1[_0x1e219c(0x12f)][_0x1e219c(0x1a0)][_0x1e219c(0x152)]({'where':{'id':_0x3833d2}});}async[a36_0xdea0a0(0x213)](_0x1a3f37){const _0x324b6e=a36_0xdea0a0,{page:_0x2aaee6,limit:_0x29988d,status:_0x1535e4,gateway:_0x102255,shopId:_0x317b3d,dateFrom:_0xf9c2d8,dateTo:_0x2c6b95,search:_0xe1c16e,currency:_0x10801f,sortBy:_0x53efe9,sortOrder:_0xc979da}=_0x1a3f37,_0x2de81d=(_0x2aaee6-0x1)*_0x29988d;console[_0x324b6e(0x223)](_0x324b6e(0x14a),_0x1a3f37);const _0x163f36=await database_1[_0x324b6e(0x12f)][_0x324b6e(0x16c)]['groupBy']({'by':['gateway'],'_count':{'gateway':!![]}});console[_0x324b6e(0x223)]('üìä\x20Available\x20gateways\x20in\x20database:',_0x163f36[_0x324b6e(0x1a1)](_0x1ee6eb=>_0x1ee6eb[_0x324b6e(0x1ee)]+'\x20('+_0x1ee6eb[_0x324b6e(0x16d)][_0x324b6e(0x1ee)]+'\x20payments)'));if(_0x102255){const _0x403943=_0x163f36[_0x324b6e(0x249)](_0x43911e=>_0x43911e[_0x324b6e(0x1ee)][_0x324b6e(0x1ff)]()===_0x102255[_0x324b6e(0x1ff)]());!_0x403943&&_0x102255[_0x324b6e(0x1ff)]()!=='test_gateway'&&console[_0x324b6e(0x223)](_0x324b6e(0x175)+_0x102255+_0x324b6e(0x1f5)+_0x163f36['map'](_0x197c86=>_0x197c86[_0x324b6e(0x1ee)])[_0x324b6e(0x122)](',\x20'));}const _0x156bf5={};_0x1535e4&&(_0x156bf5[_0x324b6e(0x1b2)]=_0x1535e4[_0x324b6e(0x21a)]());if(!_0x102255)_0x156bf5[_0x324b6e(0x1ee)]={'not':_0x324b6e(0x1c4)};else{if(_0x102255&&(_0x102255['toLowerCase']()==='test_gateway'||_0x102255===_0x324b6e(0x19d)))_0x156bf5[_0x324b6e(0x1ee)]=_0x324b6e(0x1c4);else{let _0x42ec35=_0x102255;const _0x1aa196=(0x0,gateway_1[_0x324b6e(0x238)])(_0x102255);if(_0x1aa196)_0x42ec35=_0x1aa196,console[_0x324b6e(0x223)](_0x324b6e(0x236)+_0x102255+_0x324b6e(0x138)+_0x42ec35+'\x27');else{const _0x2981e4=(0x0,gateway_1['getGatewayIdByName'])(_0x102255);if(_0x2981e4){const _0x5ef375=(0x0,gateway_1[_0x324b6e(0x238)])(_0x2981e4);_0x5ef375&&(_0x42ec35=_0x5ef375,console[_0x324b6e(0x223)](_0x324b6e(0x19b)+_0x102255+_0x324b6e(0x16f)+_0x2981e4+_0x324b6e(0x248)+_0x42ec35+'\x27'));}else console[_0x324b6e(0x223)](_0x324b6e(0x118)+_0x102255+_0x324b6e(0x200));}const _0x5baeb3=await database_1[_0x324b6e(0x12f)][_0x324b6e(0x16c)]['count']({'where':{'gateway':_0x42ec35[_0x324b6e(0x1ff)]()},'take':0x1});_0x5baeb3===0x0?(console[_0x324b6e(0x223)](_0x324b6e(0x222)+_0x42ec35+_0x324b6e(0x1f8)+_0x102255+'\x27)\x20not\x20found\x20in\x20database,\x20returning\x20empty\x20result'),_0x156bf5['gateway']='NONEXISTENT_GATEWAY_FILTER'):(_0x156bf5[_0x324b6e(0x1ee)]=_0x42ec35[_0x324b6e(0x1ff)](),console['log'](_0x324b6e(0x226)+_0x42ec35+_0x324b6e(0x1f8)+_0x102255+'\x27)'));}}console[_0x324b6e(0x223)](_0x324b6e(0x221),_0x156bf5[_0x324b6e(0x1ee)]);_0x317b3d&&(_0x156bf5[_0x324b6e(0x1bd)]=_0x317b3d);_0x10801f&&(_0x156bf5[_0x324b6e(0x14c)]=_0x10801f[_0x324b6e(0x21a)](),console[_0x324b6e(0x223)](_0x324b6e(0x22f)+_0x10801f['toUpperCase']()));(_0xf9c2d8||_0x2c6b95)&&(_0x156bf5['createdAt']={},_0xf9c2d8&&(_0x156bf5['createdAt'][_0x324b6e(0x143)]=new Date(_0xf9c2d8)),_0x2c6b95&&(_0x156bf5[_0x324b6e(0x169)]['lte']=new Date(_0x2c6b95)));_0xe1c16e&&(_0x156bf5['OR']=[{'id':{'contains':_0xe1c16e,'mode':_0x324b6e(0x15a)}},{'orderId':{'contains':_0xe1c16e,'mode':_0x324b6e(0x15a)}},{'gatewayOrderId':{'contains':_0xe1c16e,'mode':'insensitive'}},{'customerEmail':{'contains':_0xe1c16e,'mode':_0x324b6e(0x15a)}},{'shop':{'name':{'contains':_0xe1c16e,'mode':'insensitive'}}},{'shop':{'username':{'contains':_0xe1c16e,'mode':_0x324b6e(0x15a)}}}]);console[_0x324b6e(0x223)]('üìä\x20Final\x20WHERE\x20conditions:',JSON[_0x324b6e(0x182)](_0x156bf5,null,0x2));let _0x3a2dd4={'createdAt':_0x324b6e(0x229)};if(_0x53efe9){const _0x45615f=[_0x324b6e(0x24d),_0x324b6e(0x169),_0x324b6e(0x187),_0x324b6e(0x1b2),_0x324b6e(0x1ee),'currency'],_0x1405d0=[_0x324b6e(0x1bf),_0x324b6e(0x229)];if(_0x45615f[_0x324b6e(0x172)](_0x53efe9)){const _0x3b4c40=_0x1405d0[_0x324b6e(0x172)](_0xc979da)?_0xc979da:_0x324b6e(0x229);_0x3a2dd4={[_0x53efe9]:_0x3b4c40},console['log'](_0x324b6e(0x195)+_0x53efe9+'\x20in\x20'+_0x3b4c40+_0x324b6e(0x1aa));}}const [_0x30e17b,_0x3e67fe]=await Promise[_0x324b6e(0x23d)]([database_1[_0x324b6e(0x12f)][_0x324b6e(0x16c)][_0x324b6e(0x1e7)]({'where':_0x156bf5,'skip':_0x2de81d,'take':_0x29988d,'orderBy':_0x3a2dd4,'select':{'id':!![],'shopId':!![],'amount':!![],'amountAfterGatewayCommissionUSDT':!![],'currency':!![],'sourceCurrency':!![],'status':!![],'gateway':!![],'orderId':!![],'gatewayOrderId':!![],'gatewayPaymentId':!![],'customerEmail':!![],'customerName':!![],'customerCountry':!![],'customerIp':!![],'customerUa':!![],'externalPaymentUrl':!![],'successUrl':!![],'failUrl':!![],'pendingUrl':!![],'whiteUrl':!![],'expiresAt':!![],'invoiceTotalSum':!![],'qrCode':!![],'qrUrl':!![],'country':!![],'language':!![],'amountIsEditable':!![],'maxPayments':!![],'rapydCustomer':!![],'cardLast4':!![],'paymentMethod':!![],'bankId':!![],'remitterIban':!![],'remitterName':!![],'failureMessage':!![],'usage':!![],'createdAt':!![],'updatedAt':!![],'shop':{'select':{'name':!![],'username':!![]}}}}),database_1['default'][_0x324b6e(0x16c)][_0x324b6e(0x1ac)]({'where':_0x156bf5})]);return{'payments':_0x30e17b,'pagination':{'page':_0x2aaee6,'limit':_0x29988d,'total':_0x3e67fe,'totalPages':Math[_0x324b6e(0x1db)](_0x3e67fe/_0x29988d)}};}async[a36_0xdea0a0(0x119)](_0x14e9d5){const _0x257cbb=a36_0xdea0a0,_0xd20e8b=await database_1['default']['payment'][_0x257cbb(0x231)]({'where':{'id':_0x14e9d5},'select':{'id':!![],'shopId':!![],'amount':!![],'amountAfterGatewayCommissionUSDT':!![],'currency':!![],'sourceCurrency':!![],'status':!![],'gateway':!![],'orderId':!![],'gatewayOrderId':!![],'gatewayPaymentId':!![],'customerEmail':!![],'customerName':!![],'customerCountry':!![],'customerIp':!![],'customerUa':!![],'externalPaymentUrl':!![],'successUrl':!![],'failUrl':!![],'pendingUrl':!![],'whiteUrl':!![],'expiresAt':!![],'invoiceTotalSum':!![],'qrCode':!![],'qrUrl':!![],'country':!![],'language':!![],'amountIsEditable':!![],'maxPayments':!![],'rapydCustomer':!![],'cardLast4':!![],'paymentMethod':!![],'bankId':!![],'remitterIban':!![],'remitterName':!![],'failureMessage':!![],'usage':!![],'createdAt':!![],'updatedAt':!![],'shop':{'select':{'name':!![],'username':!![]}}}});if(!_0xd20e8b)return null;return{'id':_0xd20e8b['id'],'shopId':_0xd20e8b['shopId'],'gateway':_0xd20e8b[_0x257cbb(0x1ee)],'amount':_0xd20e8b[_0x257cbb(0x24d)],'currency':_0xd20e8b[_0x257cbb(0x14c)],'status':_0xd20e8b[_0x257cbb(0x1b2)],'orderId':_0xd20e8b[_0x257cbb(0x1ec)],'gatewayOrderId':_0xd20e8b[_0x257cbb(0x1a6)],'customerEmail':_0xd20e8b[_0x257cbb(0x198)],'customerName':_0xd20e8b[_0x257cbb(0x1fa)],'customerCountry':_0xd20e8b['customerCountry'],'customerIp':_0xd20e8b[_0x257cbb(0x153)],'customerUa':_0xd20e8b['customerUa'],'failureMessage':_0xd20e8b['failureMessage'],'externalPaymentUrl':_0xd20e8b[_0x257cbb(0x1fc)],'successUrl':_0xd20e8b['successUrl'],'failUrl':_0xd20e8b[_0x257cbb(0x20b)],'pendingUrl':_0xd20e8b['pendingUrl'],'whiteUrl':_0xd20e8b['whiteUrl'],'createdAt':_0xd20e8b[_0x257cbb(0x169)],'updatedAt':_0xd20e8b[_0x257cbb(0x187)],'shop':_0xd20e8b[_0x257cbb(0x1c5)]};}async['updatePaymentStatus'](_0x2a79ce,_0x35b0b3,_0x11f1d2,_0x3a67b4){const _0x7c17ef=a36_0xdea0a0,_0x4d85f9=await database_1['default'][_0x7c17ef(0x124)](async _0x2eeac8=>{const _0x22fb01=_0x7c17ef,_0x1a8fdf=await _0x2eeac8[_0x22fb01(0x16c)][_0x22fb01(0x231)]({'where':{'id':_0x2a79ce},'include':{'shop':{'select':{'id':!![],'name':!![],'username':!![],'balance':!![]}}}});if(!_0x1a8fdf)throw new Error(_0x22fb01(0x130));const _0x5b44cc=_0x1a8fdf[_0x22fb01(0x1b2)],_0x22135a=_0x35b0b3[_0x22fb01(0x21a)]();console[_0x22fb01(0x223)](_0x22fb01(0x240)+_0x2a79ce+_0x22fb01(0x148)+_0x5b44cc+_0x22fb01(0x1dd)+_0x22135a),console[_0x22fb01(0x223)]('üí∞\x20Current\x20shop\x20balance:\x20'+_0x1a8fdf[_0x22fb01(0x1c5)][_0x22fb01(0x151)]+_0x22fb01(0x13c));const _0x588015={'status':_0x22135a,'updatedAt':new Date(),'statusChangedBy':_0x22fb01(0x141),'statusChangedAt':new Date()};_0x11f1d2&&(_0x588015[_0x22fb01(0x245)]=_0x11f1d2);_0x22135a===_0x22fb01(0x1fe)&&_0x3a67b4&&(_0x588015[_0x22fb01(0x1a5)]=_0x3a67b4);let _0x4be8ec=0x0,_0x142049=_0x1a8fdf['shop']['balance'];if(_0x22135a==='PAID'&&_0x5b44cc!==_0x22fb01(0x117)){_0x588015[_0x22fb01(0x1e3)]=new Date();const _0x5ea8c4=await currencyService_1[_0x22fb01(0x232)][_0x22fb01(0x1d4)](_0x1a8fdf[_0x22fb01(0x24d)],_0x1a8fdf[_0x22fb01(0x14c)]);_0x588015['amountUSDT']=_0x5ea8c4;let _0x3f0f70=0x2d;const _0x281eb4=await _0x2eeac8[_0x22fb01(0x1c5)][_0x22fb01(0x231)]({'where':{'id':_0x1a8fdf['shopId']},'select':{'gatewaySettings':!![]}});if(_0x281eb4?.['gatewaySettings'])try{const _0x4fce0a=JSON[_0x22fb01(0x1eb)](_0x281eb4[_0x22fb01(0x1cf)]);for(const [_0x5e3725,_0x3da9e8]of Object[_0x22fb01(0x1e9)](_0x4fce0a)){if(_0x5e3725[_0x22fb01(0x1ff)]()===_0x1a8fdf[_0x22fb01(0x1ee)]['toLowerCase']()){_0x3f0f70=_0x3da9e8[_0x22fb01(0x17b)]||0xa;break;}}}catch(_0x4d95ec){console['error'](_0x22fb01(0x133)+_0x2a79ce+':',_0x4d95ec);}let _0x4a1610;_0x1a8fdf['amountAfterGatewayCommissionUSDT']!==null&&_0x1a8fdf['amountAfterGatewayCommissionUSDT']!==undefined?(_0x4a1610=_0x1a8fdf['amountAfterGatewayCommissionUSDT'],console[_0x22fb01(0x223)](_0x22fb01(0x1a4)+_0x4a1610[_0x22fb01(0x110)](0x6)+_0x22fb01(0x155)+_0x2a79ce)):(_0x4a1610=_0x5ea8c4*(0x1-_0x3f0f70/0x64),console[_0x22fb01(0x223)](_0x22fb01(0x115)+_0x2a79ce+':\x20'+_0x3f0f70+_0x22fb01(0x215)+_0x5ea8c4[_0x22fb01(0x110)](0x6)+_0x22fb01(0x13c)),_0x588015[_0x22fb01(0x1c0)]=_0x4a1610),_0x4be8ec=_0x4a1610,_0x142049+=_0x4a1610,console[_0x22fb01(0x223)](_0x22fb01(0x1b9)+_0x2a79ce+_0x22fb01(0x139)),console[_0x22fb01(0x223)](_0x22fb01(0x1b0)+_0x5ea8c4[_0x22fb01(0x110)](0x6)+_0x22fb01(0x13c)),console[_0x22fb01(0x223)](_0x22fb01(0x1e2)+_0x1a8fdf[_0x22fb01(0x1ee)]+_0x22fb01(0x1ae)+_0x3f0f70+'%'),console['log'](_0x22fb01(0x140)+_0x4a1610[_0x22fb01(0x110)](0x6)+_0x22fb01(0x1f0)+_0x3f0f70+_0x22fb01(0x1ef)),console[_0x22fb01(0x223)]('\x20\x20\x20Added\x20to\x20balance:\x20+'+_0x4a1610['toFixed'](0x6)+_0x22fb01(0x13c));}else{if(_0x5b44cc===_0x22fb01(0x117)&&_0x22135a!=='PAID'){if(_0x1a8fdf[_0x22fb01(0x1bc)]){let _0x26d7f5=0x2d;const _0x26d83d=await _0x2eeac8[_0x22fb01(0x1c5)][_0x22fb01(0x231)]({'where':{'id':_0x1a8fdf['shopId']},'select':{'gatewaySettings':!![]}});if(_0x26d83d?.[_0x22fb01(0x1cf)])try{const _0x1c50cb=JSON[_0x22fb01(0x1eb)](_0x26d83d[_0x22fb01(0x1cf)]);for(const [_0x967800,_0x251554]of Object[_0x22fb01(0x1e9)](_0x1c50cb)){if(_0x967800[_0x22fb01(0x1ff)]()===_0x1a8fdf[_0x22fb01(0x1ee)][_0x22fb01(0x1ff)]()){_0x26d7f5=_0x251554[_0x22fb01(0x17b)]||0xa;break;}}}catch(_0x156f31){console[_0x22fb01(0x1d9)](_0x22fb01(0x133)+_0x2a79ce+':',_0x156f31);}const _0x575688=_0x1a8fdf[_0x22fb01(0x1bc)]*(0x1-_0x26d7f5/0x64);_0x4be8ec=-_0x575688,_0x142049-=_0x575688,_0x588015['amountUSDT']=null,_0x588015[_0x22fb01(0x1c0)]=null,console[_0x22fb01(0x223)](_0x22fb01(0x1b9)+_0x2a79ce+_0x22fb01(0x163)),console[_0x22fb01(0x223)]('\x20\x20\x20Full\x20amount:\x20'+_0x1a8fdf['amountUSDT']['toFixed'](0x6)+_0x22fb01(0x13c)),console['log'](_0x22fb01(0x1e2)+_0x1a8fdf['gateway']+_0x22fb01(0x1ae)+_0x26d7f5+'%'),console['log'](_0x22fb01(0x188)+_0x575688[_0x22fb01(0x110)](0x6)+_0x22fb01(0x1f0)+_0x26d7f5+'%\x20commission)'),console[_0x22fb01(0x223)](_0x22fb01(0x11a)+_0x575688[_0x22fb01(0x110)](0x6)+_0x22fb01(0x13c));}}}_0x22135a===_0x22fb01(0x1fe)&&(_0x5b44cc===_0x22fb01(0x117)&&_0x1a8fdf[_0x22fb01(0x1bc)]&&console['log'](_0x22fb01(0x166)),_0x3a67b4&&_0x3a67b4>0x0&&(_0x4be8ec-=_0x3a67b4,_0x142049-=_0x3a67b4,console[_0x22fb01(0x223)](_0x22fb01(0x160)+_0x3a67b4[_0x22fb01(0x110)](0x6)+_0x22fb01(0x113))));_0x22135a===_0x22fb01(0x125)&&_0x5b44cc===_0x22fb01(0x117)&&console[_0x22fb01(0x223)](_0x22fb01(0x18e));const _0x164e9a=await _0x2eeac8[_0x22fb01(0x16c)][_0x22fb01(0x1af)]({'where':{'id':_0x2a79ce},'data':_0x588015,'include':{'shop':{'select':{'name':!![],'username':!![]}}}});return _0x4be8ec!==0x0&&(await _0x2eeac8[_0x22fb01(0x1c5)]['update']({'where':{'id':_0x1a8fdf[_0x22fb01(0x1bd)]},'data':{'balance':_0x142049}}),console[_0x22fb01(0x223)](_0x22fb01(0x20c)+_0x1a8fdf['shopId']+'\x20balance\x20updated:\x20'+_0x1a8fdf[_0x22fb01(0x1c5)][_0x22fb01(0x151)]['toFixed'](0x6)+_0x22fb01(0x1dd)+_0x142049[_0x22fb01(0x110)](0x6)+_0x22fb01(0x12d)+(_0x4be8ec>0x0?'+':'')+_0x4be8ec['toFixed'](0x6)+')')),_0x164e9a;});return{'id':_0x4d85f9['id'],'shopId':_0x4d85f9[_0x7c17ef(0x1bd)],'gateway':_0x4d85f9[_0x7c17ef(0x1ee)],'amount':_0x4d85f9['amount'],'currency':_0x4d85f9[_0x7c17ef(0x14c)],'status':_0x4d85f9[_0x7c17ef(0x1b2)],'orderId':_0x4d85f9[_0x7c17ef(0x1ec)],'gatewayOrderId':_0x4d85f9[_0x7c17ef(0x1a6)],'customerEmail':_0x4d85f9[_0x7c17ef(0x198)],'customerName':_0x4d85f9[_0x7c17ef(0x1fa)],'customerCountry':_0x4d85f9['customerCountry'],'customerIp':_0x4d85f9['customerIp'],'customerUa':_0x4d85f9[_0x7c17ef(0x23e)],'failureMessage':_0x4d85f9[_0x7c17ef(0x135)],'adminNotes':_0x4d85f9[_0x7c17ef(0x245)],'chargebackAmount':_0x4d85f9[_0x7c17ef(0x1a5)],'statusChangedBy':_0x4d85f9[_0x7c17ef(0x1be)],'statusChangedAt':_0x4d85f9['statusChangedAt'],'createdAt':_0x4d85f9[_0x7c17ef(0x169)],'updatedAt':_0x4d85f9[_0x7c17ef(0x187)],'shop':_0x4d85f9[_0x7c17ef(0x1c5)]};}async[a36_0xdea0a0(0x242)](_0x69a441,_0x640353){const _0x1ec6e9=a36_0xdea0a0,_0x4833cc=Math[_0x1ec6e9(0x1a7)]()[_0x1ec6e9(0x16e)](0x24)[_0x1ec6e9(0x1b6)](0x2,0x9);console[_0x1ec6e9(0x223)](_0x1ec6e9(0x13b)+_0x4833cc+_0x1ec6e9(0x1ce)+_0x69a441);const _0x3bf5e6={..._0x640353};_0x640353[_0x1ec6e9(0x176)]&&_0x640353[_0x1ec6e9(0x176)][_0x1ec6e9(0x210)]()!==''?(console[_0x1ec6e9(0x223)](_0x1ec6e9(0x1f9)+_0x4833cc+_0x1ec6e9(0x1c7)+_0x69a441),_0x3bf5e6[_0x1ec6e9(0x176)]=await bcryptjs_1[_0x1ec6e9(0x12f)]['hash'](_0x640353[_0x1ec6e9(0x176)],0xc)):(console[_0x1ec6e9(0x223)](_0x1ec6e9(0x1f9)+_0x4833cc+_0x1ec6e9(0x1dc)),delete _0x3bf5e6[_0x1ec6e9(0x176)]);_0x640353['fullName']&&(_0x3bf5e6[_0x1ec6e9(0x1d0)]=_0x640353['fullName'],delete _0x3bf5e6['fullName']);_0x640353[_0x1ec6e9(0x1df)]&&(_0x3bf5e6[_0x1ec6e9(0x218)]=_0x640353['telegramId'],delete _0x3bf5e6[_0x1ec6e9(0x1df)]);_0x640353['merchantUrl']&&(_0x3bf5e6[_0x1ec6e9(0x1a9)]=_0x640353[_0x1ec6e9(0x202)],delete _0x3bf5e6[_0x1ec6e9(0x202)]);if(_0x640353[_0x1ec6e9(0x20d)]){const _0x57e0d8=_0x640353[_0x1ec6e9(0x20d)][_0x1ec6e9(0x1a1)](_0x4ed763=>this[_0x1ec6e9(0x190)](_0x4ed763));console[_0x1ec6e9(0x223)](_0x1ec6e9(0x13d),_0x640353[_0x1ec6e9(0x20d)],'->',_0x57e0d8),_0x3bf5e6['paymentGateways']=JSON['stringify'](_0x57e0d8),delete _0x3bf5e6[_0x1ec6e9(0x20d)];}_0x640353[_0x1ec6e9(0x1cf)]&&(console[_0x1ec6e9(0x223)]('üîß\x20['+_0x4833cc+']\x20Gateway\x20settings\x20before\x20saving:',_0x640353[_0x1ec6e9(0x1cf)]),_0x3bf5e6[_0x1ec6e9(0x1cf)]=JSON[_0x1ec6e9(0x182)](_0x640353[_0x1ec6e9(0x1cf)]),console[_0x1ec6e9(0x223)](_0x1ec6e9(0x220)+_0x4833cc+']\x20Gateway\x20settings\x20JSON\x20string:',_0x3bf5e6['gatewaySettings']));_0x640353['wallets']&&(_0x640353[_0x1ec6e9(0x16b)][_0x1ec6e9(0x1b5)]!==undefined&&(_0x3bf5e6[_0x1ec6e9(0x1b5)]=_0x640353[_0x1ec6e9(0x16b)][_0x1ec6e9(0x1b5)]||null),_0x640353[_0x1ec6e9(0x16b)][_0x1ec6e9(0x164)]!==undefined&&(_0x3bf5e6[_0x1ec6e9(0x164)]=_0x640353[_0x1ec6e9(0x16b)][_0x1ec6e9(0x164)]||null),_0x640353[_0x1ec6e9(0x16b)]['usdtErcWallet']!==undefined&&(_0x3bf5e6[_0x1ec6e9(0x159)]=_0x640353[_0x1ec6e9(0x16b)][_0x1ec6e9(0x159)]||null),_0x640353[_0x1ec6e9(0x16b)][_0x1ec6e9(0x24a)]!==undefined&&(_0x3bf5e6[_0x1ec6e9(0x24a)]=_0x640353[_0x1ec6e9(0x16b)]['usdcPolygonWallet']||null),delete _0x3bf5e6[_0x1ec6e9(0x16b)]);const _0x16563a=await database_1[_0x1ec6e9(0x12f)][_0x1ec6e9(0x1c5)][_0x1ec6e9(0x1af)]({'where':{'id':_0x69a441},'data':_0x3bf5e6,'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});return console[_0x1ec6e9(0x223)]('üéØ\x20['+_0x4833cc+_0x1ec6e9(0x246),_0x16563a[_0x1ec6e9(0x1cf)]),{'id':_0x16563a['id'],'fullName':_0x16563a[_0x1ec6e9(0x1d0)],'username':_0x16563a[_0x1ec6e9(0x14d)],'telegramId':_0x16563a[_0x1ec6e9(0x218)],'merchantUrl':_0x16563a[_0x1ec6e9(0x1a9)],'gateways':_0x16563a[_0x1ec6e9(0x149)]?JSON[_0x1ec6e9(0x1eb)](_0x16563a['paymentGateways']):null,'gatewaySettings':_0x16563a[_0x1ec6e9(0x1cf)]?JSON[_0x1ec6e9(0x1eb)](_0x16563a[_0x1ec6e9(0x1cf)]):null,'publicKey':_0x16563a[_0x1ec6e9(0x208)],'wallets':{'usdtPolygonWallet':_0x16563a[_0x1ec6e9(0x1b5)],'usdtTrcWallet':_0x16563a[_0x1ec6e9(0x164)],'usdtErcWallet':_0x16563a[_0x1ec6e9(0x159)],'usdcPolygonWallet':_0x16563a[_0x1ec6e9(0x24a)]},'status':_0x16563a['status'],'createdAt':_0x16563a[_0x1ec6e9(0x169)]};}async[a36_0xdea0a0(0x1de)](_0x5d07da){const _0x2af2b8=a36_0xdea0a0,_0x46a382=await database_1['default']['shop'][_0x2af2b8(0x1af)]({'where':{'id':_0x5d07da},'data':{'status':_0x2af2b8(0x145)},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});return{'id':_0x46a382['id'],'fullName':_0x46a382[_0x2af2b8(0x1d0)],'username':_0x46a382[_0x2af2b8(0x14d)],'telegramId':_0x46a382[_0x2af2b8(0x218)],'merchantUrl':_0x46a382[_0x2af2b8(0x1a9)],'gateways':_0x46a382[_0x2af2b8(0x149)]?JSON[_0x2af2b8(0x1eb)](_0x46a382['paymentGateways']):null,'gatewaySettings':_0x46a382[_0x2af2b8(0x1cf)]?JSON[_0x2af2b8(0x1eb)](_0x46a382[_0x2af2b8(0x1cf)]):null,'publicKey':_0x46a382['publicKey'],'wallets':{'usdtPolygonWallet':_0x46a382[_0x2af2b8(0x1b5)],'usdtTrcWallet':_0x46a382[_0x2af2b8(0x164)],'usdtErcWallet':_0x46a382[_0x2af2b8(0x159)],'usdcPolygonWallet':_0x46a382[_0x2af2b8(0x24a)]},'status':_0x46a382[_0x2af2b8(0x1b2)],'createdAt':_0x46a382[_0x2af2b8(0x169)]};}async['activateUser'](_0x23acc5){const _0x12075a=a36_0xdea0a0,_0xc32bd2=await database_1['default'][_0x12075a(0x1c5)][_0x12075a(0x1af)]({'where':{'id':_0x23acc5},'data':{'status':_0x12075a(0x154)},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});return{'id':_0xc32bd2['id'],'fullName':_0xc32bd2['name'],'username':_0xc32bd2[_0x12075a(0x14d)],'telegramId':_0xc32bd2['telegram'],'merchantUrl':_0xc32bd2[_0x12075a(0x1a9)],'gateways':_0xc32bd2[_0x12075a(0x149)]?JSON[_0x12075a(0x1eb)](_0xc32bd2[_0x12075a(0x149)]):null,'gatewaySettings':_0xc32bd2[_0x12075a(0x1cf)]?JSON['parse'](_0xc32bd2[_0x12075a(0x1cf)]):null,'publicKey':_0xc32bd2[_0x12075a(0x208)],'wallets':{'usdtPolygonWallet':_0xc32bd2[_0x12075a(0x1b5)],'usdtTrcWallet':_0xc32bd2[_0x12075a(0x164)],'usdtErcWallet':_0xc32bd2[_0x12075a(0x159)],'usdcPolygonWallet':_0xc32bd2[_0x12075a(0x24a)]},'status':_0xc32bd2[_0x12075a(0x1b2)],'createdAt':_0xc32bd2[_0x12075a(0x169)]};}async[a36_0xdea0a0(0x1f2)](_0x5d98b5){const _0x53b406=a36_0xdea0a0,{page:_0xa0a220,limit:_0x582eb9,status:_0x2ed420}=_0x5d98b5,_0xde015d=(_0xa0a220-0x1)*_0x582eb9,_0x2ce1a7={};_0x2ed420&&(_0x2ce1a7['status']=_0x2ed420['toUpperCase']());const [_0x5b4287,_0x321708]=await Promise[_0x53b406(0x23d)]([database_1[_0x53b406(0x12f)]['shop']['findMany']({'where':_0x2ce1a7,'skip':_0xde015d,'take':_0x582eb9,'orderBy':{'createdAt':_0x53b406(0x229)},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}}),database_1[_0x53b406(0x12f)][_0x53b406(0x1c5)]['count']({'where':_0x2ce1a7})]);return{'users':_0x5b4287[_0x53b406(0x1a1)](_0x219162=>{const _0x2fe58d=_0x53b406,_0x316fa8=_0x219162[_0x2fe58d(0x149)]?JSON[_0x2fe58d(0x1eb)](_0x219162[_0x2fe58d(0x149)]):null,_0x28f093=_0x316fa8?_0x316fa8['map'](_0x497d3e=>this[_0x2fe58d(0x11d)](_0x497d3e)):null;return{'id':_0x219162['id'],'fullName':_0x219162[_0x2fe58d(0x1d0)],'username':_0x219162[_0x2fe58d(0x14d)],'telegramId':_0x219162[_0x2fe58d(0x218)],'merchantUrl':_0x219162[_0x2fe58d(0x1a9)],'gateways':_0x28f093,'gatewaySettings':_0x219162[_0x2fe58d(0x1cf)]?JSON['parse'](_0x219162[_0x2fe58d(0x1cf)]):null,'publicKey':_0x219162[_0x2fe58d(0x208)],'wallets':{'usdtPolygonWallet':_0x219162[_0x2fe58d(0x1b5)],'usdtTrcWallet':_0x219162[_0x2fe58d(0x164)],'usdtErcWallet':_0x219162[_0x2fe58d(0x159)],'usdcPolygonWallet':_0x219162[_0x2fe58d(0x24a)]},'status':_0x219162['status'],'createdAt':_0x219162[_0x2fe58d(0x169)]};}),'pagination':{'page':_0xa0a220,'limit':_0x582eb9,'total':_0x321708,'totalPages':Math[_0x53b406(0x1db)](_0x321708/_0x582eb9)}};}async['getUserById'](_0x37ccf1){const _0x5baed4=a36_0xdea0a0,_0x144c8f=await database_1[_0x5baed4(0x12f)][_0x5baed4(0x1c5)]['findUnique']({'where':{'id':_0x37ccf1},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});if(!_0x144c8f)return null;const _0x2ec184=_0x144c8f[_0x5baed4(0x149)]?JSON[_0x5baed4(0x1eb)](_0x144c8f['paymentGateways']):null,_0x2840b2=_0x2ec184?_0x2ec184['map'](_0x517e26=>this[_0x5baed4(0x11d)](_0x517e26)):null;return _0x2ec184&&_0x2840b2&&console['log']('üîÑ\x20Gateway\x20mapping\x20(get):',_0x2ec184,'->',_0x2840b2),{'id':_0x144c8f['id'],'fullName':_0x144c8f[_0x5baed4(0x1d0)],'username':_0x144c8f[_0x5baed4(0x14d)],'telegramId':_0x144c8f[_0x5baed4(0x218)],'merchantUrl':_0x144c8f[_0x5baed4(0x1a9)],'gateways':_0x2840b2,'gatewaySettings':_0x144c8f[_0x5baed4(0x1cf)]?JSON[_0x5baed4(0x1eb)](_0x144c8f[_0x5baed4(0x1cf)]):null,'publicKey':_0x144c8f[_0x5baed4(0x208)],'wallets':{'usdtPolygonWallet':_0x144c8f[_0x5baed4(0x1b5)],'usdtTrcWallet':_0x144c8f[_0x5baed4(0x164)],'usdtErcWallet':_0x144c8f[_0x5baed4(0x159)],'usdcPolygonWallet':_0x144c8f['usdcPolygonWallet']},'status':_0x144c8f[_0x5baed4(0x1b2)],'createdAt':_0x144c8f['createdAt']};}async[a36_0xdea0a0(0x186)](_0x171916){const _0x3987bf=a36_0xdea0a0,{fullName:_0x1cc7ba,username:_0x52bb0a,password:_0x11f702,telegramId:_0x573ada,merchantUrl:_0x2caf40,gateways:_0x379a31,gatewaySettings:_0x504a4d,wallets:_0x613ef8}=_0x171916,_0x41a4bc=await database_1[_0x3987bf(0x12f)][_0x3987bf(0x1c5)][_0x3987bf(0x231)]({'where':{'username':_0x52bb0a}});if(_0x41a4bc)throw new Error(_0x3987bf(0x1b4));if(_0x573ada){const _0x4a3f10=await database_1['default'][_0x3987bf(0x1c5)][_0x3987bf(0x231)]({'where':{'telegram':_0x573ada}});if(_0x4a3f10)throw new Error('Telegram\x20username\x20already\x20exists');}const _0xc407a7=await bcryptjs_1[_0x3987bf(0x12f)][_0x3987bf(0x14b)](_0x11f702,0xc),_0x37d259='pk_'+crypto_1[_0x3987bf(0x12f)]['randomBytes'](0x20)[_0x3987bf(0x16e)](_0x3987bf(0x147)),_0x3f0e39=_0x3987bf(0x251)+crypto_1[_0x3987bf(0x12f)][_0x3987bf(0x1f6)](0x20)[_0x3987bf(0x16e)](_0x3987bf(0x147)),_0x493d1c=_0x379a31?_0x379a31[_0x3987bf(0x1a1)](_0x25d513=>this[_0x3987bf(0x190)](_0x25d513)):null;_0x379a31&&_0x493d1c&&console[_0x3987bf(0x223)](_0x3987bf(0x165),_0x379a31,'->',_0x493d1c);const _0x2ca923=await database_1[_0x3987bf(0x12f)][_0x3987bf(0x1c5)][_0x3987bf(0x1c6)]({'data':{'name':_0x1cc7ba,'username':_0x52bb0a,'password':_0xc407a7,'telegram':_0x573ada,'shopUrl':_0x2caf40,'paymentGateways':_0x493d1c?JSON[_0x3987bf(0x182)](_0x493d1c):null,'gatewaySettings':_0x504a4d?JSON[_0x3987bf(0x182)](_0x504a4d):null,'usdtPolygonWallet':_0x613ef8?.[_0x3987bf(0x1b5)]||null,'usdtTrcWallet':_0x613ef8?.[_0x3987bf(0x164)]||null,'usdtErcWallet':_0x613ef8?.['usdtErcWallet']||null,'usdcPolygonWallet':_0x613ef8?.[_0x3987bf(0x24a)]||null,'publicKey':_0x37d259,'secretKey':_0x3f0e39,'status':_0x3987bf(0x154)},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});return{'id':_0x2ca923['id'],'fullName':_0x2ca923[_0x3987bf(0x1d0)],'username':_0x2ca923['username'],'telegramId':_0x2ca923[_0x3987bf(0x218)],'merchantUrl':_0x2ca923['shopUrl'],'gateways':_0x2ca923[_0x3987bf(0x149)]?JSON[_0x3987bf(0x1eb)](_0x2ca923[_0x3987bf(0x149)]):null,'gatewaySettings':_0x2ca923[_0x3987bf(0x1cf)]?JSON['parse'](_0x2ca923[_0x3987bf(0x1cf)]):null,'publicKey':_0x2ca923[_0x3987bf(0x208)],'wallets':{'usdtPolygonWallet':_0x2ca923['usdtPolygonWallet'],'usdtTrcWallet':_0x2ca923[_0x3987bf(0x164)],'usdtErcWallet':_0x2ca923[_0x3987bf(0x159)],'usdcPolygonWallet':_0x2ca923[_0x3987bf(0x24a)]},'status':_0x2ca923[_0x3987bf(0x1b2)],'createdAt':_0x2ca923[_0x3987bf(0x169)]};}async[a36_0xdea0a0(0x1f4)](_0x81cc42){const _0x1ebceb=a36_0xdea0a0;await database_1[_0x1ebceb(0x12f)][_0x1ebceb(0x1c5)]['delete']({'where':{'id':_0x81cc42}});}[a36_0xdea0a0(0x19c)](_0x5f306f,_0x56e07d,_0x4cbd61){const _0x24460f=a36_0xdea0a0,_0xb84a9c=new Map(),_0x2f9678=new Date(_0x56e07d);while(_0x2f9678<=_0x4cbd61){const _0x551c3f=_0x2f9678[_0x24460f(0x144)]()['split']('T')[0x0];_0xb84a9c[_0x24460f(0x211)](_0x551c3f,{'revenue':0x0,'count':0x0}),_0x2f9678[_0x24460f(0x1c8)](_0x2f9678[_0x24460f(0x180)]()+0x1);}for(const _0x34b74f of _0x5f306f){const _0x2d0e67=_0x34b74f['createdAt']['toISOString']()[_0x24460f(0x20a)]('T')[0x0],_0x743b1e=_0xb84a9c[_0x24460f(0x126)](_0x2d0e67);_0x743b1e&&(_0x743b1e['count']+=0x1,_0x34b74f['status']===_0x24460f(0x117)&&(_0x34b74f['amountUSDT']?_0x743b1e['revenue']+=_0x34b74f[_0x24460f(0x1bc)]:console['log'](_0x24460f(0x1b1)+_0x34b74f['id']+_0x24460f(0x235))));}const _0x3b9a8e=[],_0x2e9a16=[];for(const [_0x437cfe,_0x30aaa5]of _0xb84a9c){_0x3b9a8e[_0x24460f(0x1c9)]({'date':_0x437cfe,'amount':Math[_0x24460f(0x131)](_0x30aaa5[_0x24460f(0x127)]*0x64)/0x64}),_0x2e9a16['push']({'date':_0x437cfe,'count':_0x30aaa5[_0x24460f(0x1ac)]});}return{'dailyRevenue':_0x3b9a8e,'dailyPayments':_0x2e9a16};}}exports[a36_0xdea0a0(0x24e)]=AdminService;