'use strict';const a38_0x406ac5=a38_0x3de1;(function(_0xa40b8,_0xbb56c1){const _0x168d14=a38_0x3de1,_0x2fdcbd=_0xa40b8();while(!![]){try{const _0x4ad922=parseInt(_0x168d14(0xaf))/0x1*(parseInt(_0x168d14(0xae))/0x2)+parseInt(_0x168d14(0xf5))/0x3*(-parseInt(_0x168d14(0xd4))/0x4)+-parseInt(_0x168d14(0x198))/0x5*(parseInt(_0x168d14(0xc1))/0x6)+parseInt(_0x168d14(0xb4))/0x7+parseInt(_0x168d14(0x14d))/0x8+-parseInt(_0x168d14(0xdc))/0x9*(parseInt(_0x168d14(0x1b7))/0xa)+parseInt(_0x168d14(0x19b))/0xb;if(_0x4ad922===_0xbb56c1)break;else _0x2fdcbd['push'](_0x2fdcbd['shift']());}catch(_0x5552ea){_0x2fdcbd['push'](_0x2fdcbd['shift']());}}}(a38_0x1ad8,0xf2773));var __importDefault=this&&this[a38_0x406ac5(0x147)]||function(_0x516607){const _0x4c2fae=a38_0x406ac5;return _0x516607&&_0x516607[_0x4c2fae(0x1ac)]?_0x516607:{'default':_0x516607};};Object[a38_0x406ac5(0x106)](exports,a38_0x406ac5(0x1ac),{'value':!![]}),exports[a38_0x406ac5(0x1a0)]=void 0x0;const database_1=__importDefault(require('../config/database')),bcryptjs_1=__importDefault(require(a38_0x406ac5(0x171))),crypto_1=__importDefault(require(a38_0x406ac5(0x145))),currencyService_1=require(a38_0x406ac5(0x19c)),gateway_1=require(a38_0x406ac5(0xea));class AdminService{async[a38_0x406ac5(0xad)](){const _0x1bd222=a38_0x406ac5;console[_0x1bd222(0x174)](_0x1bd222(0xd8));const _0x3a0043=await database_1[_0x1bd222(0x16e)][_0x1bd222(0x15c)][_0x1bd222(0x113)]({'_sum':{'balance':!![],'totalPaidOut':!![]},'where':{'status':_0x1bd222(0x192)}}),_0x50b173=await database_1[_0x1bd222(0x16e)][_0x1bd222(0x1bd)][_0x1bd222(0x178)]({'where':{'status':_0x1bd222(0x107),'gateway':{'not':_0x1bd222(0xce)}}}),_0x2abccb=new Date(),_0x78217e=new Date(_0x2abccb[_0x1bd222(0x127)](),_0x2abccb[_0x1bd222(0xcb)](),0x1),_0x103c89=new Date(_0x2abccb['getFullYear'](),_0x2abccb[_0x1bd222(0xcb)]()+0x1,0x0,0x17,0x3b,0x3b,0x3e7),_0x2a603a=await database_1[_0x1bd222(0x16e)][_0x1bd222(0x13d)][_0x1bd222(0x113)]({'_sum':{'amount':!![]},'where':{'createdAt':{'gte':_0x78217e,'lte':_0x103c89},'status':'COMPLETED'}}),_0x25114d=_0x3a0043[_0x1bd222(0x11b)]['totalPaidOut']||0x0,_0x37961c=_0x3a0043[_0x1bd222(0x11b)][_0x1bd222(0x11a)]||0x0,_0x36adaf=_0x2a603a['_sum'][_0x1bd222(0x183)]||0x0,_0x1578f0={'totalPayout':Math[_0x1bd222(0x185)](_0x25114d*0x64)/0x64,'awaitingPayout':Math[_0x1bd222(0x185)](_0x37961c*0x64)/0x64,'thisMonth':Math[_0x1bd222(0x185)](_0x36adaf*0x64)/0x64,'availableBalance':Math['round'](_0x37961c*0x64)/0x64,'totalPayments':_0x50b173};return console['log'](_0x1bd222(0x18b)),console[_0x1bd222(0x174)](_0x1bd222(0x196)+_0x1578f0[_0x1bd222(0xdb)]+'\x20USDT\x20(total\x20paid\x20to\x20merchants)'),console[_0x1bd222(0x174)](_0x1bd222(0x119)+_0x1578f0[_0x1bd222(0xec)]+_0x1bd222(0x1b1)),console[_0x1bd222(0x174)](_0x1bd222(0x151)+_0x1578f0[_0x1bd222(0x180)]+_0x1bd222(0x179)),console[_0x1bd222(0x174)]('\x20\x20\x20📅\x20This\x20month:\x20'+_0x1578f0[_0x1bd222(0x1c8)]+_0x1bd222(0xbb)),console['log'](_0x1bd222(0x168)+_0x1578f0[_0x1bd222(0x199)]+'\x20PAID\x20payments'),_0x1578f0;}async[a38_0x406ac5(0x15e)](_0xd9b295,_0x4da2f0){const _0x583b7b=a38_0x406ac5;console[_0x583b7b(0x174)]('🔄\x20Updating\x20customer\x20data\x20for\x20payment\x20'+_0xd9b295+':',_0x4da2f0);const _0x754903=await database_1[_0x583b7b(0x16e)][_0x583b7b(0x1bd)][_0x583b7b(0x98)]({'where':{'id':_0xd9b295},'select':{'id':!![],'customerEmail':!![],'customerName':!![],'customerCountry':!![],'customerIp':!![],'customerUa':!![]}});if(!_0x754903)throw new Error(_0x583b7b(0xbf));const _0x2dca2f={};_0x4da2f0[_0x583b7b(0x9c)]!==undefined&&(_0x2dca2f[_0x583b7b(0x9c)]=_0x4da2f0[_0x583b7b(0x9c)]||null);_0x4da2f0[_0x583b7b(0x160)]!==undefined&&(_0x2dca2f['customerIp']=_0x4da2f0[_0x583b7b(0x160)]||null);_0x4da2f0['customerUa']!==undefined&&(_0x2dca2f[_0x583b7b(0x103)]=_0x4da2f0[_0x583b7b(0x103)]||null);const _0x24cc44=await database_1[_0x583b7b(0x16e)][_0x583b7b(0x1bd)][_0x583b7b(0x116)]({'where':{'id':_0xd9b295},'data':{..._0x2dca2f,'updatedAt':new Date()},'select':{'id':!![],'customerEmail':!![],'customerName':!![],'customerCountry':!![],'customerIp':!![],'customerUa':!![],'updatedAt':!![]}});return console[_0x583b7b(0x174)](_0x583b7b(0x12d)+_0xd9b295),console[_0x583b7b(0x174)]('\x20\x20\x20🌍\x20Country:\x20'+_0x754903[_0x583b7b(0x9c)]+_0x583b7b(0x1c0)+_0x24cc44[_0x583b7b(0x9c)]),console['log'](_0x583b7b(0x125)+_0x754903[_0x583b7b(0x160)]+_0x583b7b(0x1c0)+_0x24cc44[_0x583b7b(0x160)]),console['log']('\x20\x20\x20🖥️\x20User\x20Agent:\x20'+(_0x754903[_0x583b7b(0x103)]?_0x583b7b(0xe0):_0x583b7b(0x17e))+'\x20->\x20'+(_0x24cc44['customerUa']?_0x583b7b(0xe0):_0x583b7b(0x17e))),_0x24cc44;}async[a38_0x406ac5(0x1b5)](_0xfe3d02){const _0x189fa5=a38_0x406ac5,_0xf2f12a=new Date();let _0x24f2fd;switch(_0xfe3d02[_0x189fa5(0xb8)]()){case _0x189fa5(0xff):_0x24f2fd=new Date(_0xf2f12a[_0x189fa5(0x127)](),_0xf2f12a[_0x189fa5(0xcb)](),_0xf2f12a[_0x189fa5(0x1a8)](),0x0,0x0,0x0,0x0);break;case _0x189fa5(0x12e):const _0x934240=new Date(_0xf2f12a);_0x934240[_0x189fa5(0x101)](_0x934240[_0x189fa5(0x1a8)]()-0x1),_0x24f2fd=new Date(_0x934240[_0x189fa5(0x127)](),_0x934240['getMonth'](),_0x934240['getDate'](),0x0,0x0,0x0,0x0);break;case'7d':_0x24f2fd=new Date(_0xf2f12a['getTime']()-0x7*0x18*0x3c*0x3c*0x3e8);break;case _0x189fa5(0x10a):_0x24f2fd=new Date(_0xf2f12a['getTime']()-0x1e*0x18*0x3c*0x3c*0x3e8);break;case'90d':_0x24f2fd=new Date(_0xf2f12a['getTime']()-0x5a*0x18*0x3c*0x3c*0x3e8);break;case'all':const _0x990ebe=await database_1[_0x189fa5(0x16e)]['payment'][_0x189fa5(0xca)]({'where':{'gateway':{'not':_0x189fa5(0xce)}},'orderBy':{'createdAt':'asc'},'select':{'createdAt':!![]}});_0x24f2fd=_0x990ebe?_0x990ebe['createdAt']:new Date(_0x189fa5(0x15d));break;default:_0x24f2fd=new Date(_0xf2f12a[_0x189fa5(0x163)]()-0x1e*0x18*0x3c*0x3c*0x3e8);}_0x24f2fd[_0x189fa5(0xb3)](0x0,0x0,0x0,0x0);let _0x3e06d4;if(_0xfe3d02['toLowerCase']()===_0x189fa5(0x12e)){const _0x5b88bd=new Date(_0xf2f12a);_0x5b88bd[_0x189fa5(0x101)](_0x5b88bd[_0x189fa5(0x1a8)]()-0x1),_0x3e06d4=new Date(_0x5b88bd['getFullYear'](),_0x5b88bd[_0x189fa5(0xcb)](),_0x5b88bd[_0x189fa5(0x1a8)](),0x17,0x3b,0x3b,0x3e7);}const _0xbabb29={'gte':_0x24f2fd};_0x3e06d4&&(_0xbabb29['lte']=_0x3e06d4);const [_0x6f1cc5,_0x16b292,_0x1c45fd,_0x8d66e3,_0x4213c3,_0x28cf0a]=await Promise['all']([database_1['default'][_0x189fa5(0x15c)][_0x189fa5(0x178)](),database_1['default']['shop']['count']({'where':{'status':'ACTIVE'}}),database_1[_0x189fa5(0x16e)]['payment']['count']({'where':{'status':_0x189fa5(0x107),'createdAt':_0xbabb29,'gateway':{'not':_0x189fa5(0xce)}}}),database_1[_0x189fa5(0x16e)][_0x189fa5(0x1bd)][_0x189fa5(0x193)]({'where':{'status':'PAID','createdAt':_0xbabb29,'gateway':{'not':'test_gateway'}},'select':{'amount':!![],'currency':!![],'amountAfterGatewayCommissionUSDT':!![]}}),database_1['default'][_0x189fa5(0x1bd)][_0x189fa5(0x193)]({'where':{'gateway':{'not':_0x189fa5(0xce)}},'take':0xa,'orderBy':{'createdAt':_0x189fa5(0x135)},'include':{'shop':{'select':{'name':!![],'username':!![]}}}}),database_1[_0x189fa5(0x16e)][_0x189fa5(0x1bd)][_0x189fa5(0x193)]({'where':{'createdAt':_0xbabb29,'gateway':{'not':'test_gateway'}},'select':{'amount':!![],'currency':!![],'status':!![],'amountUSDT':!![],'createdAt':!![]}})]);let _0xdb272d=0x0,_0x54f0c9=0x0;for(const _0x45e0b2 of _0x8d66e3){const _0x43cd36=await currencyService_1[_0x189fa5(0x162)][_0x189fa5(0xc8)](_0x45e0b2[_0x189fa5(0x183)],_0x45e0b2[_0x189fa5(0x1c3)]);_0xdb272d+=_0x43cd36;if(_0x45e0b2[_0x189fa5(0x17b)]){const _0x2a2e84=await currencyService_1[_0x189fa5(0x162)][_0x189fa5(0xc8)](_0x45e0b2[_0x189fa5(0x183)],_0x45e0b2[_0x189fa5(0x1c3)]),_0x27e71a=_0x45e0b2[_0x189fa5(0x17b)],_0x9684ab=_0x2a2e84-_0x27e71a;_0x54f0c9+=_0x9684ab;}}const _0x433fdd=_0x1c45fd>0x0?_0xdb272d/_0x1c45fd:0x0,_0x13efaa=this[_0x189fa5(0xd6)](_0x28cf0a,_0x24f2fd,_0x3e06d4||_0xf2f12a),_0x565349=await database_1[_0x189fa5(0x16e)]['payment']['count']({'where':{'createdAt':_0xbabb29,'gateway':{'not':_0x189fa5(0xce)}}}),_0x49087e=_0x565349>0x0?_0x1c45fd/_0x565349*0x64:0x0;return{'totalShops':_0x6f1cc5,'activeShops':_0x16b292,'totalPayments':_0x1c45fd,'successfulPayments':_0x1c45fd,'totalAttempts':_0x565349,'totalRevenue':Math['round'](_0xdb272d*0x64)/0x64,'trapayEarnings':Math['round'](_0x54f0c9*0x64)/0x64,'averagePaymentAmount':Math['round'](_0x433fdd*0x64)/0x64,'conversionRate':Math[_0x189fa5(0x185)](_0x49087e*0x64)/0x64,'dailyRevenue':_0x13efaa['dailyRevenue'],'dailyPayments':_0x13efaa[_0x189fa5(0x195)],'recentPayments':_0x4213c3[_0x189fa5(0x1cd)](_0x4f3956=>({'id':_0x4f3956['id'],'amount':_0x4f3956[_0x189fa5(0x183)],'currency':_0x4f3956[_0x189fa5(0x1c3)],'status':_0x4f3956[_0x189fa5(0x175)],'gateway':_0x4f3956[_0x189fa5(0xfe)],'shop':_0x4f3956['shop'],'createdAt':_0x4f3956[_0x189fa5(0x1c2)]}))};}async[a38_0x406ac5(0x134)](_0x34b9fb){const _0x5986ef=a38_0x406ac5;console['log'](_0x5986ef(0x1a2),_0x34b9fb);let _0x5366f2,_0x5e8aa0=new Date();if(_0x34b9fb['period']===_0x5986ef(0x121)&&_0x34b9fb[_0x5986ef(0x140)]&&_0x34b9fb[_0x5986ef(0x166)])_0x5366f2=new Date(_0x34b9fb['dateFrom']),_0x5e8aa0=new Date(_0x34b9fb[_0x5986ef(0x166)]),_0x5366f2[_0x5986ef(0xb3)](0x0,0x0,0x0,0x0),_0x5e8aa0[_0x5986ef(0xb3)](0x17,0x3b,0x3b,0x3e7);else{const _0x63aa03=new Date();switch(_0x34b9fb[_0x5986ef(0xcf)]){case'week':_0x5366f2=new Date(_0x63aa03[_0x5986ef(0x163)]()-0x7*0x18*0x3c*0x3c*0x3e8);break;case'month':_0x5366f2=new Date(_0x63aa03[_0x5986ef(0x163)]()-0x1e*0x18*0x3c*0x3c*0x3e8);break;case'year':_0x5366f2=new Date(_0x63aa03[_0x5986ef(0x163)]()-0x16d*0x18*0x3c*0x3c*0x3e8);break;case'all':default:_0x5366f2=new Date(_0x5986ef(0x15d));break;}_0x5366f2[_0x5986ef(0xb3)](0x0,0x0,0x0,0x0),_0x5e8aa0[_0x5986ef(0xb3)](0x17,0x3b,0x3b,0x3e7);}console[_0x5986ef(0x174)](_0x5986ef(0x1ae)+_0x5366f2[_0x5986ef(0x14b)]()+_0x5986ef(0x173)+_0x5e8aa0['toISOString']());const _0x14229d={'status':_0x5986ef(0x107),'gateway':{'not':'test_gateway'},'paidAt':{'gte':_0x5366f2,'lte':_0x5e8aa0}};_0x34b9fb['shopId']&&(_0x14229d['shopId']=_0x34b9fb[_0x5986ef(0x99)]);const _0x42fccc=await database_1[_0x5986ef(0x16e)][_0x5986ef(0x1bd)]['findMany']({'where':_0x14229d,'select':{'id':!![],'amount':!![],'currency':!![],'amountUSDT':!![],'amountAfterGatewayCommissionUSDT':!![],'gatewayCommissionRate':!![],'gateway':!![],'shopId':!![],'paidAt':!![],'shop':{'select':{'id':!![],'name':!![],'username':!![],'gatewaySettings':!![]}}}});console[_0x5986ef(0x174)](_0x5986ef(0xd0)+_0x42fccc[_0x5986ef(0x108)]+'\x20paid\x20payments\x20for\x20analysis');const _0x2a3873={'gateway':{'not':_0x5986ef(0xce)},'createdAt':{'gte':_0x5366f2,'lte':_0x5e8aa0}};_0x34b9fb[_0x5986ef(0x99)]&&(_0x2a3873[_0x5986ef(0x99)]=_0x34b9fb[_0x5986ef(0x99)]);const _0x76f65c=await database_1[_0x5986ef(0x16e)][_0x5986ef(0x1bd)][_0x5986ef(0x178)]({'where':_0x2a3873});console[_0x5986ef(0x174)]('📊\x20Total\x20payments\x20(including\x20failed):\x20'+_0x76f65c+_0x5986ef(0xef)+_0x42fccc['length']);let _0x26ff6f=0x0,_0x14867f=0x0,_0x572e56=0x0;const _0x111360={},_0x262f73={},_0x4a36cc={};for(const _0x47d8e2 of _0x42fccc){try{const _0xd06043=_0x47d8e2['amountUSDT']||0x0;if(_0xd06043<=0x0){console['warn'](_0x5986ef(0x165)+_0x47d8e2['id']+_0x5986ef(0xf8));continue;}let _0x315526,_0xe654b;if(_0x47d8e2[_0x5986ef(0x17b)]!==null&&_0x47d8e2[_0x5986ef(0x17b)]!==undefined)_0x315526=_0x47d8e2[_0x5986ef(0x17b)],_0xe654b=_0xd06043-_0x315526,console[_0x5986ef(0x174)](_0x5986ef(0x1c9)+_0x47d8e2['id']+':\x20'+_0xd06043[_0x5986ef(0x16c)](0x6)+'\x20USDT,\x20merchant:\x20'+_0x315526[_0x5986ef(0x16c)](0x6)+_0x5986ef(0xbb));else{let _0x405200={};if(_0x47d8e2[_0x5986ef(0x15c)][_0x5986ef(0x11d)])try{_0x405200=JSON['parse'](_0x47d8e2[_0x5986ef(0x15c)][_0x5986ef(0x11d)]);}catch(_0x1665bf){console[_0x5986ef(0x149)](_0x5986ef(0x9a)+_0x47d8e2[_0x5986ef(0x99)]+':',_0x1665bf);}let _0x54f0c5=0x2d;for(const [_0x13a540,_0x5dab43]of Object['entries'](_0x405200)){if(_0x13a540[_0x5986ef(0xb8)]()===_0x47d8e2[_0x5986ef(0xfe)][_0x5986ef(0xb8)]()){_0x54f0c5=_0x5dab43[_0x5986ef(0xbd)]||0x2d;break;}}_0xe654b=_0xd06043*(_0x54f0c5/0x64),_0x315526=_0xd06043-_0xe654b,console['log'](_0x5986ef(0x144)+_0x47d8e2['id']+':\x20'+_0x54f0c5+_0x5986ef(0x1af)+_0xd06043[_0x5986ef(0x16c)](0x6)+'\x20USDT');}_0x26ff6f+=_0xd06043,_0x14867f+=_0x315526,_0x572e56+=_0xe654b;let _0x31b362;_0x47d8e2[_0x5986ef(0x1c1)]!==null&&_0x47d8e2[_0x5986ef(0x1c1)]!==undefined?(_0x31b362=_0x47d8e2[_0x5986ef(0x1c1)],console[_0x5986ef(0x174)](_0x5986ef(0x1b4)+_0x47d8e2['id']+':\x20'+_0x31b362+'%')):(_0x31b362=_0xd06043>0x0?_0xe654b/_0xd06043*0x64:0x0,console['log']('📊\x20Calculated\x20commission\x20rate\x20for\x20payment\x20'+_0x47d8e2['id']+':\x20'+_0x31b362[_0x5986ef(0x16c)](0x2)+'%'));!_0x111360[_0x47d8e2[_0x5986ef(0xfe)]]&&(_0x111360[_0x47d8e2['gateway']]={'gateway':_0x47d8e2[_0x5986ef(0xfe)],'gatewayDisplayName':this['getGatewayDisplayName'](_0x47d8e2[_0x5986ef(0xfe)]),'paymentsCount':0x0,'turnoverUSDT':0x0,'commissionUSDT':0x0,'merchantEarningsUSDT':0x0,'totalCommissionRate':0x0});_0x111360[_0x47d8e2[_0x5986ef(0xfe)]][_0x5986ef(0xc3)]++,_0x111360[_0x47d8e2['gateway']]['turnoverUSDT']+=_0xd06043,_0x111360[_0x47d8e2[_0x5986ef(0xfe)]][_0x5986ef(0x1bf)]+=_0xe654b,_0x111360[_0x47d8e2[_0x5986ef(0xfe)]]['merchantEarningsUSDT']+=_0x315526,_0x111360[_0x47d8e2[_0x5986ef(0xfe)]]['totalCommissionRate']+=_0x31b362;!_0x34b9fb[_0x5986ef(0x99)]&&(!_0x262f73[_0x47d8e2[_0x5986ef(0x99)]]&&(_0x262f73[_0x47d8e2[_0x5986ef(0x99)]]={'shopId':_0x47d8e2[_0x5986ef(0x99)],'shopName':_0x47d8e2[_0x5986ef(0x15c)]['name'],'shopUsername':_0x47d8e2['shop'][_0x5986ef(0x1b2)],'paymentsCount':0x0,'turnoverUSDT':0x0,'commissionUSDT':0x0,'merchantEarningsUSDT':0x0,'paidOutUSDT':0x0,'averageCheckUSDT':0x0}),_0x262f73[_0x47d8e2['shopId']][_0x5986ef(0xc3)]++,_0x262f73[_0x47d8e2[_0x5986ef(0x99)]]['turnoverUSDT']+=_0xd06043,_0x262f73[_0x47d8e2[_0x5986ef(0x99)]][_0x5986ef(0x1bf)]+=_0xe654b,_0x262f73[_0x47d8e2[_0x5986ef(0x99)]]['merchantEarningsUSDT']+=_0x315526);const _0x3bf285=_0x47d8e2[_0x5986ef(0x123)][_0x5986ef(0x14b)]()[_0x5986ef(0x1be)]('T')[0x0];!_0x4a36cc[_0x3bf285]&&(_0x4a36cc[_0x3bf285]={'date':_0x3bf285,'turnover':0x0,'merchantEarnings':0x0,'gatewayEarnings':0x0,'paymentsCount':0x0}),_0x4a36cc[_0x3bf285][_0x5986ef(0x1ca)]+=_0xd06043,_0x4a36cc[_0x3bf285][_0x5986ef(0x19e)]+=_0x315526,_0x4a36cc[_0x3bf285][_0x5986ef(0x170)]+=_0xe654b,_0x4a36cc[_0x3bf285][_0x5986ef(0xc3)]++;}catch(_0x2ac614){console[_0x5986ef(0x149)](_0x5986ef(0x153)+_0x47d8e2['id']+':',_0x2ac614);}}Object['values'](_0x111360)[_0x5986ef(0x17d)](_0x55a476=>{const _0x49dbe3=_0x5986ef;_0x55a476['averageCommissionRate']=_0x55a476['paymentsCount']>0x0?_0x55a476[_0x49dbe3(0x161)]/_0x55a476[_0x49dbe3(0xc3)]:0x0,delete _0x55a476[_0x49dbe3(0x161)];}),Object[_0x5986ef(0x14c)](_0x262f73)['forEach'](_0x30ef7e=>{const _0x13ff64=_0x5986ef;_0x30ef7e['averageCheckUSDT']=_0x30ef7e[_0x13ff64(0xc3)]>0x0?_0x30ef7e[_0x13ff64(0x122)]/_0x30ef7e['paymentsCount']:0x0;});let _0x2af00b=0x0,_0x24cd39=0x0;if(_0x34b9fb[_0x5986ef(0x99)]){const _0x57a2dd=await database_1[_0x5986ef(0x16e)][_0x5986ef(0x13d)][_0x5986ef(0x193)]({'where':{'shopId':_0x34b9fb[_0x5986ef(0x99)],'status':_0x5986ef(0xaa),'createdAt':{'gte':_0x5366f2,'lte':_0x5e8aa0}},'select':{'amount':!![]}});_0x2af00b=_0x57a2dd[_0x5986ef(0x1b3)]((_0x49440b,_0x20ff01)=>_0x49440b+_0x20ff01[_0x5986ef(0x183)],0x0);const _0x5dab3d=await database_1[_0x5986ef(0x16e)][_0x5986ef(0x13d)][_0x5986ef(0x193)]({'where':{'shopId':_0x34b9fb[_0x5986ef(0x99)],'status':_0x5986ef(0x124),'createdAt':{'gte':_0x5366f2,'lte':_0x5e8aa0}},'select':{'amount':!![]}});_0x24cd39=_0x5dab3d['reduce']((_0x3b652d,_0x5c50f9)=>_0x3b652d+_0x5c50f9['amount'],0x0);}const _0x48a402=_0x76f65c,_0x27f36f=_0x42fccc['length'],_0x1dfe99=_0x27f36f>0x0?_0x26ff6f/_0x27f36f:0x0,_0x10e8cd=_0x48a402>0x0?Math[_0x5986ef(0x185)](_0x27f36f/_0x48a402*0x2710)/0x64:0x0,_0x413e29=Math['ceil']((_0x5e8aa0[_0x5986ef(0x163)]()-_0x5366f2[_0x5986ef(0x163)]())/(0x3e8*0x3c*0x3c*0x18)),_0x35b62c={'totalTurnover':Math[_0x5986ef(0x185)](_0x26ff6f*0x64)/0x64,'merchantEarnings':Math[_0x5986ef(0x185)](_0x14867f*0x64)/0x64,'gatewayEarnings':Math[_0x5986ef(0x185)](_0x572e56*0x64)/0x64,'totalPaidOut':Math[_0x5986ef(0x185)](_0x2af00b*0x64)/0x64,'pendingPayout':Math['round'](_0x24cd39*0x64)/0x64,'averageCheck':Math[_0x5986ef(0x185)](_0x1dfe99*0x64)/0x64,'totalPayments':_0x48a402,'successfulPayments':_0x27f36f,'conversionRate':_0x10e8cd,'gatewayBreakdown':Object[_0x5986ef(0x14c)](_0x111360)[_0x5986ef(0x1cd)](_0x16018b=>({..._0x16018b,'turnoverUSDT':Math[_0x5986ef(0x185)](_0x16018b[_0x5986ef(0x122)]*0x64)/0x64,'commissionUSDT':Math[_0x5986ef(0x185)](_0x16018b['commissionUSDT']*0x64)/0x64,'merchantEarningsUSDT':Math[_0x5986ef(0x185)](_0x16018b['merchantEarningsUSDT']*0x64)/0x64,'averageCommissionRate':Math[_0x5986ef(0x185)](_0x16018b['averageCommissionRate']*0x64)/0x64})),'merchantBreakdown':_0x34b9fb[_0x5986ef(0x99)]?undefined:Object[_0x5986ef(0x14c)](_0x262f73)[_0x5986ef(0x1cd)](_0x59c7c5=>({..._0x59c7c5,'turnoverUSDT':Math[_0x5986ef(0x185)](_0x59c7c5[_0x5986ef(0x122)]*0x64)/0x64,'commissionUSDT':Math['round'](_0x59c7c5[_0x5986ef(0x1bf)]*0x64)/0x64,'merchantEarningsUSDT':Math['round'](_0x59c7c5[_0x5986ef(0x10d)]*0x64)/0x64,'paidOutUSDT':Math['round'](_0x59c7c5[_0x5986ef(0xe5)]*0x64)/0x64,'averageCheckUSDT':Math[_0x5986ef(0x185)](_0x59c7c5[_0x5986ef(0xf6)]*0x64)/0x64})),'dailyData':Object[_0x5986ef(0x14c)](_0x4a36cc)[_0x5986ef(0x1cd)](_0x343603=>({..._0x343603,'turnover':Math[_0x5986ef(0x185)](_0x343603['turnover']*0x64)/0x64,'merchantEarnings':Math[_0x5986ef(0x185)](_0x343603['merchantEarnings']*0x64)/0x64,'gatewayEarnings':Math[_0x5986ef(0x185)](_0x343603['gatewayEarnings']*0x64)/0x64}))[_0x5986ef(0x1c7)]((_0xfac04a,_0x590f7f)=>_0xfac04a['date'][_0x5986ef(0xa9)](_0x590f7f['date'])),'periodInfo':{'from':_0x5366f2,'to':_0x5e8aa0,'periodType':_0x34b9fb['period']||_0x5986ef(0x121),'daysCount':_0x413e29}};return console[_0x5986ef(0x174)](_0x5986ef(0x104)),console['log'](_0x5986ef(0x9f)+_0x35b62c[_0x5986ef(0x188)]+'\x20USDT'),console['log'](_0x5986ef(0x130)+_0x35b62c[_0x5986ef(0x19e)]+_0x5986ef(0xbb)),console[_0x5986ef(0x174)](_0x5986ef(0xd2)+_0x35b62c[_0x5986ef(0x170)]+_0x5986ef(0xbb)),console['log'](_0x5986ef(0x18c)+_0x35b62c[_0x5986ef(0x156)]+_0x5986ef(0xbb)),console[_0x5986ef(0x174)](_0x5986ef(0xf9)+_0x35b62c[_0x5986ef(0x114)]+_0x5986ef(0xbb)),console[_0x5986ef(0x174)](_0x5986ef(0xf7)+_0x35b62c[_0x5986ef(0x199)]),_0x35b62c;}async['getMerchantsSelection'](){const _0x3195ce=a38_0x406ac5;console[_0x3195ce(0x174)]('📋\x20Getting\x20merchants\x20selection\x20list...');const _0x28060e=await database_1[_0x3195ce(0x16e)][_0x3195ce(0x15c)][_0x3195ce(0x193)]({'where':{'status':'ACTIVE'},'select':{'id':!![],'username':!![],'name':!![]},'orderBy':{'name':_0x3195ce(0x17f)}});return console[_0x3195ce(0x174)](_0x3195ce(0x18e)+_0x28060e[_0x3195ce(0x108)]+_0x3195ce(0x14a)),_0x28060e[_0x3195ce(0x1cd)](_0x406e3e=>({'id':_0x406e3e['id'],'username':_0x406e3e[_0x3195ce(0x1b2)],'name':_0x406e3e[_0x3195ce(0x16b)]}));}['getGatewayDisplayName'](_0x3e4898){const _0x5aa026=a38_0x406ac5,_0xc3bbf9={'test_gateway':_0x5aa026(0x10e),'plisio':_0x5aa026(0x18f),'rapyd':_0x5aa026(0xf0),'noda':_0x5aa026(0x12b),'cointopay':_0x5aa026(0xdd),'cointopay2':'Open\x20Banking\x202','klyme_eu':'KLYME\x20EU','klyme_gb':_0x5aa026(0x186),'klyme_de':'KLYME\x20DE','mastercard':_0x5aa026(0x105)};return _0xc3bbf9[_0x3e4898]||_0x3e4898;}[a38_0x406ac5(0x1bb)](_0x3047c5){const _0x1fba3d=a38_0x406ac5,_0xd07db0={'Test\x20Gateway':_0x1fba3d(0xce),'Plisio':_0x1fba3d(0x9d),'Rapyd':_0x1fba3d(0x131),'Noda':_0x1fba3d(0x1ce),'CoinToPay':_0x1fba3d(0xe7),'CoinToPay2':_0x1fba3d(0x1c4),'KLYME\x20EU':_0x1fba3d(0x15a),'KLYME\x20GB':_0x1fba3d(0x91),'KLYME\x20DE':_0x1fba3d(0xd5),'MasterCard':'mastercard'};return _0xd07db0[_0x3047c5]||_0x3047c5[_0x1fba3d(0xb8)]();}async[a38_0x406ac5(0xa1)](_0x186263){const _0x3d1a0b=a38_0x406ac5,{page:_0x445f96,limit:_0xd6dc97,minAmount:_0x507ddc,search:_0x4c3aba}=_0x186263,_0x263603=(_0x445f96-0x1)*_0xd6dc97;console[_0x3d1a0b(0x174)](_0x3d1a0b(0xfd),_0x186263);const _0x1c1e7d={'balance':{'gt':0x0},'status':_0x3d1a0b(0x192)};_0x507ddc&&(_0x1c1e7d[_0x3d1a0b(0x11a)][_0x3d1a0b(0xe3)]=_0x507ddc);_0x4c3aba&&(_0x1c1e7d[_0x3d1a0b(0x16b)]={'contains':_0x4c3aba,'mode':_0x3d1a0b(0x120)});const [_0x519211,_0x2ed6c6]=await Promise[_0x3d1a0b(0xa7)]([database_1['default'][_0x3d1a0b(0x15c)]['findMany']({'where':_0x1c1e7d,'skip':_0x263603,'take':_0xd6dc97,'orderBy':{'balance':'desc'},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'balance':!![],'totalPaidOut':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'gatewaySettings':!![],'createdAt':!![]}}),database_1[_0x3d1a0b(0x16e)][_0x3d1a0b(0x15c)][_0x3d1a0b(0x178)]({'where':_0x1c1e7d})]);console[_0x3d1a0b(0x174)](_0x3d1a0b(0xd0)+_0x519211[_0x3d1a0b(0x108)]+_0x3d1a0b(0x1ba));const _0x3c38d0=await Promise['all'](_0x519211['map'](async _0xf6c461=>{const _0xf9e54=_0x3d1a0b,[_0xf4ee81,_0x3f03eb,_0x522f48]=await Promise[_0xf9e54(0xa7)]([database_1[_0xf9e54(0x16e)][_0xf9e54(0x1bd)][_0xf9e54(0x178)]({'where':{'shopId':_0xf6c461['id'],'status':_0xf9e54(0x107),'gateway':{'not':_0xf9e54(0xce)}}}),database_1[_0xf9e54(0x16e)][_0xf9e54(0x1bd)]['findFirst']({'where':{'shopId':_0xf6c461['id'],'status':_0xf9e54(0x107),'gateway':{'not':_0xf9e54(0xce)}},'orderBy':{'paidAt':_0xf9e54(0x17f)},'select':{'paidAt':!![]}}),database_1[_0xf9e54(0x16e)]['payment']['groupBy']({'by':[_0xf9e54(0xfe)],'where':{'shopId':_0xf6c461['id'],'status':_0xf9e54(0x107),'gateway':{'not':_0xf9e54(0xce)}},'_count':{'id':!![]},'_sum':{'amountUSDT':!![]}})]),_0x361666=new Date(),_0x202f45=new Date(_0x361666[_0xf9e54(0x127)](),_0x361666['getMonth'](),0x1),_0x4cb548=new Date(_0x361666[_0xf9e54(0x127)](),_0x361666[_0xf9e54(0xcb)]()+0x1,0x0,0x17,0x3b,0x3b,0x3e7),[_0x115daa,_0x4f57e9]=await Promise[_0xf9e54(0xa7)]([database_1[_0xf9e54(0x16e)][_0xf9e54(0x13d)][_0xf9e54(0x113)]({'_sum':{'amount':!![]},'where':{'shopId':_0xf6c461['id'],'status':'COMPLETED'}}),database_1[_0xf9e54(0x16e)][_0xf9e54(0x13d)][_0xf9e54(0x113)]({'_sum':{'amount':!![]},'where':{'shopId':_0xf6c461['id'],'status':'COMPLETED','createdAt':{'gte':_0x202f45,'lte':_0x4cb548}}})]),_0x1bfb19=_0x115daa[_0xf9e54(0x11b)]['amount']||0x0,_0x1d7ef1=_0x4f57e9[_0xf9e54(0x11b)][_0xf9e54(0x183)]||0x0,_0x3dd5d6=await Promise[_0xf9e54(0xa7)](_0x522f48[_0xf9e54(0x1cd)](async _0x5e3e18=>{const _0x2e0fe6=_0xf9e54;let _0x864817=0x2d;if(_0xf6c461[_0x2e0fe6(0x11d)])try{const _0x57c3e2=JSON['parse'](_0xf6c461[_0x2e0fe6(0x11d)]);for(const [_0x296bc6,_0x3a79b3]of Object[_0x2e0fe6(0xde)](_0x57c3e2)){if(_0x296bc6['toLowerCase']()===_0x5e3e18[_0x2e0fe6(0xfe)][_0x2e0fe6(0xb8)]()){_0x864817=_0x3a79b3[_0x2e0fe6(0xbd)]||0xa,console[_0x2e0fe6(0x174)]('💰\x20[PAYOUT]\x20Gateway\x20'+_0x5e3e18[_0x2e0fe6(0xfe)]+'\x20for\x20shop\x20'+_0xf6c461['id']+_0x2e0fe6(0xf1)+_0x864817+'%');break;}}}catch(_0x3954c3){console[_0x2e0fe6(0x149)]('Error\x20parsing\x20gateway\x20settings\x20for\x20shop\x20'+_0xf6c461['id']+':',_0x3954c3);}const _0x3243d0=_0x5e3e18['_sum']?.[_0x2e0fe6(0xa4)]||0x0,_0x109a51=_0x3243d0*(0x1-_0x864817/0x64);return{'gateway':_0x5e3e18['gateway'],'count':_0x5e3e18[_0x2e0fe6(0x159)]?.['id']||0x0,'amountUSDT':Math['round'](_0x3243d0*0x64)/0x64,'amountAfterCommissionUSDT':Math['round'](_0x109a51*0x64)/0x64,'commission':_0x864817};})),_0x3268e2=_0x3dd5d6['reduce']((_0x23270c,_0x3f65da)=>_0x23270c+_0x3f65da['amountUSDT'],0x0),_0x4826c1=_0x3dd5d6[_0xf9e54(0x1b3)]((_0x34bd30,_0x32ec47)=>_0x34bd30+_0x32ec47[_0xf9e54(0xa6)],0x0),_0x56ea8c=_0xf6c461[_0xf9e54(0x11a)];return console[_0xf9e54(0x174)](_0xf9e54(0xdf)+_0xf6c461[_0xf9e54(0x1b2)]+':'),console[_0xf9e54(0x174)](_0xf9e54(0xc7)+_0x3268e2[_0xf9e54(0x16c)](0x2)+_0xf9e54(0xc0)),console[_0xf9e54(0x174)]('\x20\x20\x20🔍\x20Calculated\x20after\x20commission:\x20'+_0x4826c1[_0xf9e54(0x16c)](0x2)+'\x20USDT\x20(theoretical\x20net)'),console[_0xf9e54(0x174)]('\x20\x20\x20✅\x20Actual\x20available\x20balance:\x20'+_0x56ea8c[_0xf9e54(0x16c)](0x2)+'\x20USDT\x20(current\x20balance\x20in\x20DB)'),console[_0xf9e54(0x174)](_0xf9e54(0x12a)+_0x1bfb19[_0xf9e54(0x16c)](0x2)+_0xf9e54(0xee)),console['log'](_0xf9e54(0x191)+(_0x4826c1-_0x1bfb19-_0x56ea8c)[_0xf9e54(0x16c)](0x2)+_0xf9e54(0x111)),{'id':_0xf6c461['id'],'fullName':_0xf6c461[_0xf9e54(0x16b)],'username':_0xf6c461[_0xf9e54(0x1b2)],'telegramId':_0xf6c461['telegram'],'merchantUrl':_0xf6c461[_0xf9e54(0x128)],'wallets':{'usdtPolygonWallet':_0xf6c461[_0xf9e54(0x197)],'usdtTrcWallet':_0xf6c461[_0xf9e54(0x172)],'usdtErcWallet':_0xf6c461[_0xf9e54(0xa5)],'usdcPolygonWallet':_0xf6c461[_0xf9e54(0x167)]},'totalAmountUSDT':Math['round'](_0x3268e2*0x64)/0x64,'totalAmountAfterCommissionUSDT':Math[_0xf9e54(0x185)](_0x4826c1*0x64)/0x64,'currentBalance':Math[_0xf9e54(0x185)](_0x56ea8c*0x64)/0x64,'totalPayout':Math[_0xf9e54(0x185)](_0x1bfb19*0x64)/0x64,'thisMonth':Math[_0xf9e54(0x185)](_0x1d7ef1*0x64)/0x64,'paymentsCount':_0xf4ee81,'oldestPaymentDate':_0x3f03eb?.[_0xf9e54(0x123)]||_0xf6c461[_0xf9e54(0x1c2)],'gatewayBreakdown':_0x3dd5d6};})),_0xe90835=_0x3c38d0[_0x3d1a0b(0x1b3)]((_0x78b0bb,_0x256893)=>_0x78b0bb+_0x256893[_0x3d1a0b(0x126)],0x0),_0x33a474=_0x3c38d0[_0x3d1a0b(0x1b3)]((_0x478c0d,_0x4c33e8)=>_0x478c0d+_0x4c33e8['totalAmountAfterCommissionUSDT'],0x0),_0x2e42e2=_0x3c38d0[_0x3d1a0b(0x1b3)]((_0x5d55a3,_0x4491f4)=>_0x5d55a3+_0x4491f4[_0x3d1a0b(0xdb)],0x0),_0x17c3b6=_0x3c38d0[_0x3d1a0b(0x1b3)]((_0x4f3b05,_0x37ed14)=>_0x4f3b05+_0x37ed14['thisMonth'],0x0);return console[_0x3d1a0b(0x174)](_0x3d1a0b(0xbc)+_0x2ed6c6+_0x3d1a0b(0xb2)),console[_0x3d1a0b(0x174)](_0x3d1a0b(0x16d)+Math[_0x3d1a0b(0x185)](_0xe90835*0x64)/0x64+_0x3d1a0b(0xc0)),console['log'](_0x3d1a0b(0x12f)+Math[_0x3d1a0b(0x185)](_0x33a474*0x64)/0x64+'\x20USDT\x20(actual\x20balances)'),console[_0x3d1a0b(0x174)](_0x3d1a0b(0xc9)+Math[_0x3d1a0b(0x185)](_0x2e42e2*0x64)/0x64+_0x3d1a0b(0xbb)),console['log']('\x20\x20\x20📅\x20Total\x20payouts\x20(this\x20month):\x20'+Math[_0x3d1a0b(0x185)](_0x17c3b6*0x64)/0x64+_0x3d1a0b(0xbb)),{'merchants':_0x3c38d0,'pagination':{'page':_0x445f96,'limit':_0xd6dc97,'total':_0x2ed6c6,'totalPages':Math[_0x3d1a0b(0x13e)](_0x2ed6c6/_0xd6dc97)},'summary':{'totalMerchants':_0x2ed6c6,'totalAmountUSDT':Math[_0x3d1a0b(0x185)](_0xe90835*0x64)/0x64,'totalAmountAfterCommissionUSDT':Math['round'](_0x33a474*0x64)/0x64,'totalPayout':Math['round'](_0x2e42e2*0x64)/0x64,'thisMonth':Math[_0x3d1a0b(0x185)](_0x17c3b6*0x64)/0x64}};}async['createPayout'](_0x34c529){const _0x3b66c0=a38_0x406ac5,{shopId:_0x40ccbc,amount:_0x25f932,network:_0x555466,wallet:_0x2866d4,notes:_0x5f553c,txid:_0x1a5a1a,periodFrom:_0x5b458c,periodTo:_0x4dcfdf}=_0x34c529,_0x260739=await database_1[_0x3b66c0(0x16e)]['$transaction'](async _0x588c41=>{const _0x208d7d=_0x3b66c0,_0x2eabfd=await _0x588c41[_0x208d7d(0x15c)]['findUnique']({'where':{'id':_0x40ccbc},'select':{'id':!![],'name':!![],'username':!![],'balance':!![],'totalPaidOut':!![]}});if(!_0x2eabfd)throw new Error(_0x208d7d(0x1b6));console['log']('💰\x20Creating\x20payout\x20for\x20shop\x20'+_0x2eabfd['username']+':'),console[_0x208d7d(0x174)](_0x208d7d(0x9b)+_0x2eabfd['balance']['toFixed'](0x6)+'\x20USDT'),console[_0x208d7d(0x174)](_0x208d7d(0xf4)+_0x25f932['toFixed'](0x6)+_0x208d7d(0xbb)),console[_0x208d7d(0x174)](_0x208d7d(0x177)+_0x2eabfd['totalPaidOut'][_0x208d7d(0x16c)](0x6)+_0x208d7d(0xbb));if(_0x1a5a1a)console[_0x208d7d(0x174)]('\x20\x20\x20Transaction\x20hash:\x20'+_0x1a5a1a);if(_0x2eabfd['balance']<_0x25f932)throw new Error('Insufficient\x20balance.\x20Available:\x20'+_0x2eabfd[_0x208d7d(0x11a)][_0x208d7d(0x16c)](0x6)+_0x208d7d(0x1c5)+_0x25f932[_0x208d7d(0x16c)](0x6)+_0x208d7d(0xbb));let _0xfa5448=_0x2866d4;if(!_0xfa5448){const _0x27e0d6=await _0x588c41[_0x208d7d(0x15c)][_0x208d7d(0x98)]({'where':{'id':_0x40ccbc},'select':{'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![]}});if(_0x27e0d6)switch(_0x555466){case'polygon':_0xfa5448=_0x27e0d6['usdtPolygonWallet']||undefined;break;case _0x208d7d(0x16f):_0xfa5448=_0x27e0d6['usdtTrcWallet']||undefined;break;case _0x208d7d(0xa8):_0xfa5448=_0x27e0d6[_0x208d7d(0xa5)]||undefined;break;case _0x208d7d(0x15f):_0xfa5448=_0x27e0d6[_0x208d7d(0x167)]||undefined;break;}}console['log'](_0x208d7d(0x1cf)+_0x555466+':\x20'+(_0xfa5448||_0x208d7d(0x1c6)));const _0x9a98f2=await _0x588c41['payout']['create']({'data':{'shopId':_0x40ccbc,'amount':_0x25f932,'network':_0x555466,'status':_0x208d7d(0xaa),'txid':_0x1a5a1a,'notes':_0x5f553c,'periodFrom':_0x5b458c?new Date(_0x5b458c):null,'periodTo':_0x4dcfdf?new Date(_0x4dcfdf):null,'createdAt':new Date(),'paidAt':new Date()}}),_0xb14c37=_0x2eabfd['balance']-_0x25f932,_0x1d16a4=_0x2eabfd[_0x208d7d(0x156)]+_0x25f932;return await _0x588c41[_0x208d7d(0x15c)][_0x208d7d(0x116)]({'where':{'id':_0x40ccbc},'data':{'balance':_0xb14c37,'totalPaidOut':_0x1d16a4}}),console['log'](_0x208d7d(0xd3)+_0x2eabfd[_0x208d7d(0x1b2)]+_0x208d7d(0x154)),console[_0x208d7d(0x174)]('\x20\x20\x20Balance:\x20'+_0x2eabfd[_0x208d7d(0x11a)]['toFixed'](0x6)+_0x208d7d(0x1c0)+_0xb14c37['toFixed'](0x6)+_0x208d7d(0xe6)+_0x25f932['toFixed'](0x6)+')'),console[_0x208d7d(0x174)]('\x20\x20\x20Total\x20paid\x20out:\x20'+_0x2eabfd[_0x208d7d(0x156)][_0x208d7d(0x16c)](0x6)+_0x208d7d(0x1c0)+_0x1d16a4[_0x208d7d(0x16c)](0x6)+_0x208d7d(0x11c)+_0x25f932[_0x208d7d(0x16c)](0x6)+')'),{'payout':_0x9a98f2,'shop':_0x2eabfd};});return console['log'](_0x3b66c0(0x150)+_0x260739[_0x3b66c0(0x13d)]['id']+_0x3b66c0(0x1d0)+_0x260739[_0x3b66c0(0x15c)][_0x3b66c0(0x1b2)]+'\x20('+_0x25f932+_0x3b66c0(0x141)),{'id':_0x260739[_0x3b66c0(0x13d)]['id'],'shopId':_0x260739[_0x3b66c0(0x13d)]['shopId'],'shopName':_0x260739['shop'][_0x3b66c0(0x16b)],'shopUsername':_0x260739[_0x3b66c0(0x15c)][_0x3b66c0(0x1b2)],'amount':_0x260739[_0x3b66c0(0x13d)]['amount'],'network':_0x260739[_0x3b66c0(0x13d)][_0x3b66c0(0x194)],'status':_0x260739['payout'][_0x3b66c0(0x175)],'txid':_0x260739['payout'][_0x3b66c0(0x10b)],'notes':_0x260739[_0x3b66c0(0x13d)]['notes'],'periodFrom':_0x260739[_0x3b66c0(0x13d)][_0x3b66c0(0x12c)],'periodTo':_0x260739[_0x3b66c0(0x13d)]['periodTo'],'createdAt':_0x260739[_0x3b66c0(0x13d)][_0x3b66c0(0x1c2)],'paidAt':_0x260739[_0x3b66c0(0x13d)][_0x3b66c0(0x123)]};}async[a38_0x406ac5(0x95)](_0x433924){const _0x2d2db3=a38_0x406ac5,{page:_0x202c1c,limit:_0x1809b4,shopId:_0x5e7e5e,network:_0x5f3017,dateFrom:_0x13d4fe,dateTo:_0x487e8c,search:_0x3fcb07}=_0x433924,_0x37f7bc=(_0x202c1c-0x1)*_0x1809b4,_0x34da1e={};_0x5e7e5e&&(_0x34da1e['shopId']=_0x5e7e5e);_0x5f3017&&(_0x34da1e[_0x2d2db3(0x194)]=_0x5f3017);(_0x13d4fe||_0x487e8c)&&(_0x34da1e[_0x2d2db3(0x1c2)]={},_0x13d4fe&&(_0x34da1e[_0x2d2db3(0x1c2)][_0x2d2db3(0xe3)]=new Date(_0x13d4fe)),_0x487e8c&&(_0x34da1e['createdAt']['lte']=new Date(_0x487e8c)));_0x3fcb07&&(_0x34da1e['OR']=[{'shop':{'name':{'contains':_0x3fcb07,'mode':'insensitive'}}},{'shop':{'username':{'contains':_0x3fcb07,'mode':'insensitive'}}},{'notes':{'contains':_0x3fcb07,'mode':_0x2d2db3(0x120)}}]);const [_0x5c17a2,_0x2ae8d9]=await Promise[_0x2d2db3(0xa7)]([database_1[_0x2d2db3(0x16e)][_0x2d2db3(0x13d)][_0x2d2db3(0x193)]({'where':_0x34da1e,'skip':_0x37f7bc,'take':_0x1809b4,'orderBy':{'createdAt':_0x2d2db3(0x135)},'select':{'id':!![],'shopId':!![],'amount':!![],'network':!![],'status':!![],'txid':!![],'notes':!![],'periodFrom':!![],'periodTo':!![],'createdAt':!![],'paidAt':!![],'shop':{'select':{'name':!![],'username':!![]}}}}),database_1['default']['payout']['count']({'where':_0x34da1e})]);return{'payouts':_0x5c17a2['map'](_0x4068f6=>({'id':_0x4068f6['id'],'shopId':_0x4068f6[_0x2d2db3(0x99)],'shopName':_0x4068f6[_0x2d2db3(0x15c)][_0x2d2db3(0x16b)],'shopUsername':_0x4068f6[_0x2d2db3(0x15c)]['username'],'amount':_0x4068f6['amount'],'network':_0x4068f6[_0x2d2db3(0x194)],'status':_0x4068f6[_0x2d2db3(0x175)],'txid':_0x4068f6[_0x2d2db3(0x10b)],'notes':_0x4068f6[_0x2d2db3(0xfb)],'periodFrom':_0x4068f6[_0x2d2db3(0x12c)],'periodTo':_0x4068f6[_0x2d2db3(0x1ab)],'createdAt':_0x4068f6[_0x2d2db3(0x1c2)],'paidAt':_0x4068f6[_0x2d2db3(0x123)]})),'pagination':{'page':_0x202c1c,'limit':_0x1809b4,'total':_0x2ae8d9,'totalPages':Math['ceil'](_0x2ae8d9/_0x1809b4)}};}async[a38_0x406ac5(0x18a)](_0x4da485){const _0x3c3b97=a38_0x406ac5,_0x2dc732=await database_1['default'][_0x3c3b97(0x13d)]['findUnique']({'where':{'id':_0x4da485},'include':{'shop':{'select':{'name':!![],'username':!![]}}}});if(!_0x2dc732)return null;return{'id':_0x2dc732['id'],'shopId':_0x2dc732[_0x3c3b97(0x99)],'shopName':_0x2dc732[_0x3c3b97(0x15c)][_0x3c3b97(0x16b)],'shopUsername':_0x2dc732['shop']['username'],'amount':_0x2dc732[_0x3c3b97(0x183)],'network':_0x2dc732[_0x3c3b97(0x194)],'status':_0x2dc732['status'],'txid':_0x2dc732[_0x3c3b97(0x10b)],'notes':_0x2dc732[_0x3c3b97(0xfb)],'periodFrom':_0x2dc732[_0x3c3b97(0x12c)],'periodTo':_0x2dc732['periodTo'],'createdAt':_0x2dc732[_0x3c3b97(0x1c2)],'paidAt':_0x2dc732['paidAt']};}async[a38_0x406ac5(0x137)](_0x3242a4){await database_1['default']['payout']['delete']({'where':{'id':_0x3242a4}});}async[a38_0x406ac5(0x19a)](_0x42234f){const _0xbbaf1a=a38_0x406ac5,{page:_0xe0c6f2,limit:_0xf31fef,status:_0x4955e5,gateway:_0xbb0a7a,shopId:_0x3db998,dateFrom:_0x103951,dateTo:_0x4bb143,search:_0x210223,currency:_0x562cef,sortBy:_0x1d1a04,sortOrder:_0x32840e}=_0x42234f,_0x40f25f=(_0xe0c6f2-0x1)*_0xf31fef;console[_0xbbaf1a(0x174)](_0xbbaf1a(0x94),_0x42234f);const _0x4b7185=await database_1[_0xbbaf1a(0x16e)][_0xbbaf1a(0x1bd)][_0xbbaf1a(0x1ad)]({'by':[_0xbbaf1a(0xfe)],'_count':{'gateway':!![]}});console[_0xbbaf1a(0x174)]('📊\x20Available\x20gateways\x20in\x20database:',_0x4b7185[_0xbbaf1a(0x1cd)](_0x5b40d8=>_0x5b40d8['gateway']+'\x20('+_0x5b40d8[_0xbbaf1a(0x159)][_0xbbaf1a(0xfe)]+_0xbbaf1a(0x102)));if(_0xbb0a7a){const _0x245627=_0x4b7185['some'](_0x30386d=>_0x30386d[_0xbbaf1a(0xfe)][_0xbbaf1a(0xb8)]()===_0xbb0a7a['toLowerCase']());!_0x245627&&_0xbb0a7a[_0xbbaf1a(0xb8)]()!==_0xbbaf1a(0xce)&&console['log'](_0xbbaf1a(0x190)+_0xbb0a7a+'\x27\x20not\x20found.\x20Available\x20gateways:\x20'+_0x4b7185[_0xbbaf1a(0x1cd)](_0x288af7=>_0x288af7[_0xbbaf1a(0xfe)])['join'](',\x20'));}const _0x18b9e7={};_0x4955e5&&(_0x18b9e7[_0xbbaf1a(0x175)]=_0x4955e5[_0xbbaf1a(0xed)]());if(!_0xbb0a7a)_0x18b9e7[_0xbbaf1a(0xfe)]={'not':_0xbbaf1a(0xce)};else{if(_0xbb0a7a&&(_0xbb0a7a['toLowerCase']()===_0xbbaf1a(0xce)||_0xbb0a7a===_0xbbaf1a(0xb0)))_0x18b9e7[_0xbbaf1a(0xfe)]=_0xbbaf1a(0xce);else{let _0x34a840=_0xbb0a7a;const _0x583d09=(0x0,gateway_1['getGatewayNameById'])(_0xbb0a7a);if(_0x583d09)_0x34a840=_0x583d09,console['log']('🔄\x20Converted\x20gateway\x20ID\x20\x27'+_0xbb0a7a+_0xbbaf1a(0xfc)+_0x34a840+'\x27');else{const _0x4d886f=(0x0,gateway_1[_0xbbaf1a(0xcc)])(_0xbb0a7a);if(_0x4d886f){const _0x352a8c=(0x0,gateway_1[_0xbbaf1a(0x176)])(_0x4d886f);_0x352a8c&&(_0x34a840=_0x352a8c,console['log'](_0xbbaf1a(0xeb)+_0xbb0a7a+_0xbbaf1a(0xab)+_0x4d886f+_0xbbaf1a(0x184)+_0x34a840+'\x27'));}else console[_0xbbaf1a(0x174)](_0xbbaf1a(0x1a1)+_0xbb0a7a+_0xbbaf1a(0x112));}const _0x16c72a=await database_1[_0xbbaf1a(0x16e)][_0xbbaf1a(0x1bd)]['count']({'where':{'gateway':_0x34a840[_0xbbaf1a(0xb8)]()},'take':0x1});_0x16c72a===0x0?(console['log'](_0xbbaf1a(0x117)+_0x34a840+_0xbbaf1a(0x1b0)+_0xbb0a7a+'\x27)\x20not\x20found\x20in\x20database,\x20returning\x20empty\x20result'),_0x18b9e7[_0xbbaf1a(0xfe)]='NONEXISTENT_GATEWAY_FILTER'):(_0x18b9e7['gateway']=_0x34a840['toLowerCase'](),console[_0xbbaf1a(0x174)]('✅\x20Using\x20gateway\x20filter:\x20\x27'+_0x34a840+_0xbbaf1a(0x1b0)+_0xbb0a7a+'\x27)'));}}console[_0xbbaf1a(0x174)](_0xbbaf1a(0x13c),_0x18b9e7['gateway']);_0x3db998&&(_0x18b9e7['shopId']=_0x3db998);_0x562cef&&(_0x18b9e7[_0xbbaf1a(0x1c3)]=_0x562cef[_0xbbaf1a(0xed)](),console['log'](_0xbbaf1a(0x182)+_0x562cef['toUpperCase']()));(_0x103951||_0x4bb143)&&(_0x18b9e7['createdAt']={},_0x103951&&(_0x18b9e7[_0xbbaf1a(0x1c2)][_0xbbaf1a(0xe3)]=new Date(_0x103951)),_0x4bb143&&(_0x18b9e7[_0xbbaf1a(0x1c2)][_0xbbaf1a(0x19d)]=new Date(_0x4bb143)));_0x210223&&(_0x18b9e7['OR']=[{'id':{'contains':_0x210223,'mode':_0xbbaf1a(0x120)}},{'orderId':{'contains':_0x210223,'mode':_0xbbaf1a(0x120)}},{'gatewayOrderId':{'contains':_0x210223,'mode':_0xbbaf1a(0x120)}},{'customerEmail':{'contains':_0x210223,'mode':_0xbbaf1a(0x120)}},{'shop':{'name':{'contains':_0x210223,'mode':_0xbbaf1a(0x120)}}},{'shop':{'username':{'contains':_0x210223,'mode':_0xbbaf1a(0x120)}}}]);console[_0xbbaf1a(0x174)](_0xbbaf1a(0xb5),JSON[_0xbbaf1a(0x14e)](_0x18b9e7,null,0x2));let _0x1c276f={'createdAt':_0xbbaf1a(0x135)};if(_0x1d1a04){const _0x29515c=['amount','createdAt','updatedAt','status','gateway',_0xbbaf1a(0x1c3)],_0x16ef8e=[_0xbbaf1a(0x17f),_0xbbaf1a(0x135)];if(_0x29515c['includes'](_0x1d1a04)){const _0x518c0d=_0x16ef8e[_0xbbaf1a(0x1a6)](_0x32840e)?_0x32840e:'desc';_0x1c276f={[_0x1d1a04]:_0x518c0d},console[_0xbbaf1a(0x174)](_0xbbaf1a(0xbe)+_0x1d1a04+'\x20in\x20'+_0x518c0d+_0xbbaf1a(0xe9));}}const [_0x24fd47,_0x375378]=await Promise[_0xbbaf1a(0xa7)]([database_1[_0xbbaf1a(0x16e)][_0xbbaf1a(0x1bd)]['findMany']({'where':_0x18b9e7,'skip':_0x40f25f,'take':_0xf31fef,'orderBy':_0x1c276f,'select':{'id':!![],'shopId':!![],'amount':!![],'amountAfterGatewayCommissionUSDT':!![],'currency':!![],'sourceCurrency':!![],'status':!![],'gateway':!![],'orderId':!![],'gatewayOrderId':!![],'gatewayPaymentId':!![],'customerEmail':!![],'customerName':!![],'customerCountry':!![],'customerIp':!![],'customerUa':!![],'externalPaymentUrl':!![],'successUrl':!![],'failUrl':!![],'pendingUrl':!![],'whiteUrl':!![],'expiresAt':!![],'invoiceTotalSum':!![],'qrCode':!![],'qrUrl':!![],'country':!![],'language':!![],'amountIsEditable':!![],'maxPayments':!![],'rapydCustomer':!![],'cardLast4':!![],'paymentMethod':!![],'bankId':!![],'remitterIban':!![],'remitterName':!![],'failureMessage':!![],'usage':!![],'createdAt':!![],'updatedAt':!![],'shop':{'select':{'name':!![],'username':!![]}}}}),database_1[_0xbbaf1a(0x16e)][_0xbbaf1a(0x1bd)][_0xbbaf1a(0x178)]({'where':_0x18b9e7})]);return{'payments':_0x24fd47,'pagination':{'page':_0xe0c6f2,'limit':_0xf31fef,'total':_0x375378,'totalPages':Math['ceil'](_0x375378/_0xf31fef)}};}async[a38_0x406ac5(0xcd)](_0x1268ce){const _0x46148f=a38_0x406ac5,_0x4d19f2=await database_1[_0x46148f(0x16e)][_0x46148f(0x1bd)][_0x46148f(0x98)]({'where':{'id':_0x1268ce},'select':{'id':!![],'shopId':!![],'amount':!![],'amountAfterGatewayCommissionUSDT':!![],'currency':!![],'sourceCurrency':!![],'status':!![],'gateway':!![],'orderId':!![],'gatewayOrderId':!![],'gatewayPaymentId':!![],'customerEmail':!![],'customerName':!![],'customerCountry':!![],'customerIp':!![],'customerUa':!![],'externalPaymentUrl':!![],'successUrl':!![],'failUrl':!![],'pendingUrl':!![],'whiteUrl':!![],'expiresAt':!![],'invoiceTotalSum':!![],'qrCode':!![],'qrUrl':!![],'country':!![],'language':!![],'amountIsEditable':!![],'maxPayments':!![],'rapydCustomer':!![],'cardLast4':!![],'paymentMethod':!![],'bankId':!![],'remitterIban':!![],'remitterName':!![],'failureMessage':!![],'usage':!![],'createdAt':!![],'updatedAt':!![],'shop':{'select':{'name':!![],'username':!![]}}}});if(!_0x4d19f2)return null;return{'id':_0x4d19f2['id'],'shopId':_0x4d19f2[_0x46148f(0x99)],'gateway':_0x4d19f2[_0x46148f(0xfe)],'amount':_0x4d19f2[_0x46148f(0x183)],'currency':_0x4d19f2[_0x46148f(0x1c3)],'status':_0x4d19f2['status'],'orderId':_0x4d19f2[_0x46148f(0x157)],'gatewayOrderId':_0x4d19f2[_0x46148f(0x1cb)],'customerEmail':_0x4d19f2[_0x46148f(0x16a)],'customerName':_0x4d19f2[_0x46148f(0x132)],'customerCountry':_0x4d19f2['customerCountry'],'customerIp':_0x4d19f2[_0x46148f(0x160)],'customerUa':_0x4d19f2[_0x46148f(0x103)],'failureMessage':_0x4d19f2[_0x46148f(0x136)],'externalPaymentUrl':_0x4d19f2[_0x46148f(0xc4)],'successUrl':_0x4d19f2[_0x46148f(0xc2)],'failUrl':_0x4d19f2[_0x46148f(0xe1)],'pendingUrl':_0x4d19f2[_0x46148f(0x110)],'whiteUrl':_0x4d19f2[_0x46148f(0x1a9)],'createdAt':_0x4d19f2[_0x46148f(0x1c2)],'updatedAt':_0x4d19f2['updatedAt'],'shop':_0x4d19f2[_0x46148f(0x15c)]};}async[a38_0x406ac5(0xa2)](_0x33baaf,_0x4a40fc,_0x2ca182,_0x30e2bc){const _0x2966f0=a38_0x406ac5,_0x2d56fa=await database_1[_0x2966f0(0x16e)][_0x2966f0(0x158)](async _0x23fd1d=>{const _0x4c1b8d=_0x2966f0,_0x14e00a=await _0x23fd1d['payment']['findUnique']({'where':{'id':_0x33baaf},'include':{'shop':{'select':{'id':!![],'name':!![],'username':!![],'balance':!![]}}}});if(!_0x14e00a)throw new Error(_0x4c1b8d(0xbf));const _0x3161a3=_0x14e00a[_0x4c1b8d(0x175)],_0x36a11c=_0x4a40fc[_0x4c1b8d(0xed)]();console[_0x4c1b8d(0x174)]('🔄\x20Admin\x20updating\x20payment\x20'+_0x33baaf+_0x4c1b8d(0x169)+_0x3161a3+_0x4c1b8d(0x1c0)+_0x36a11c),console[_0x4c1b8d(0x174)](_0x4c1b8d(0x96)+_0x14e00a[_0x4c1b8d(0x15c)][_0x4c1b8d(0x11a)]+'\x20USDT');const _0x4fe07e={'status':_0x36a11c,'updatedAt':new Date(),'statusChangedBy':_0x4c1b8d(0x10f),'statusChangedAt':new Date()};_0x2ca182&&(_0x4fe07e[_0x4c1b8d(0xc5)]=_0x2ca182);_0x36a11c===_0x4c1b8d(0x109)&&_0x30e2bc&&(_0x4fe07e[_0x4c1b8d(0x10c)]=_0x30e2bc);let _0x27dadd=0x0,_0x3e3379=_0x14e00a[_0x4c1b8d(0x15c)]['balance'];if(_0x36a11c===_0x4c1b8d(0x107)&&_0x3161a3!==_0x4c1b8d(0x107)){_0x4fe07e[_0x4c1b8d(0x123)]=new Date();const _0x4bd4e8=await currencyService_1['currencyService'][_0x4c1b8d(0xc8)](_0x14e00a[_0x4c1b8d(0x183)],_0x14e00a[_0x4c1b8d(0x1c3)]);_0x4fe07e['amountUSDT']=_0x4bd4e8;let _0x4309e3=0x2d;const _0x2ad88f=await _0x23fd1d['shop'][_0x4c1b8d(0x98)]({'where':{'id':_0x14e00a[_0x4c1b8d(0x99)]},'select':{'gatewaySettings':!![]}});if(_0x2ad88f?.['gatewaySettings'])try{const _0x4bc3de=JSON[_0x4c1b8d(0x1a7)](_0x2ad88f['gatewaySettings']);for(const [_0x47330f,_0x41c5cb]of Object[_0x4c1b8d(0xde)](_0x4bc3de)){if(_0x47330f[_0x4c1b8d(0xb8)]()===_0x14e00a[_0x4c1b8d(0xfe)][_0x4c1b8d(0xb8)]()){_0x4309e3=_0x41c5cb['commission']||0xa;break;}}}catch(_0x1f7f96){console['error'](_0x4c1b8d(0x97)+_0x33baaf+':',_0x1f7f96);}let _0x1d2973;_0x14e00a['amountAfterGatewayCommissionUSDT']!==null&&_0x14e00a[_0x4c1b8d(0x17b)]!==undefined?(_0x1d2973=_0x14e00a['amountAfterGatewayCommissionUSDT'],console[_0x4c1b8d(0x174)](_0x4c1b8d(0x118)+_0x1d2973[_0x4c1b8d(0x16c)](0x6)+_0x4c1b8d(0xe2)+_0x33baaf)):(_0x1d2973=_0x4bd4e8*(0x1-_0x4309e3/0x64),console['log'](_0x4c1b8d(0x152)+_0x33baaf+':\x20'+_0x4309e3+_0x4c1b8d(0x1af)+_0x4bd4e8['toFixed'](0x6)+_0x4c1b8d(0xbb)),_0x4fe07e[_0x4c1b8d(0x17b)]=_0x1d2973,_0x4fe07e[_0x4c1b8d(0x1c1)]=_0x4309e3),_0x27dadd=_0x1d2973,_0x3e3379+=_0x1d2973,console[_0x4c1b8d(0x174)]('💰\x20Payment\x20'+_0x33baaf+_0x4c1b8d(0x9e)),console['log'](_0x4c1b8d(0xd9)+_0x4bd4e8[_0x4c1b8d(0x16c)](0x6)+_0x4c1b8d(0xbb)),console[_0x4c1b8d(0x174)]('\x20\x20\x20Gateway:\x20'+_0x14e00a[_0x4c1b8d(0xfe)]+_0x4c1b8d(0xd1)+_0x4309e3+'%'),console[_0x4c1b8d(0x174)](_0x4c1b8d(0xb1)+_0x1d2973[_0x4c1b8d(0x16c)](0x6)+_0x4c1b8d(0x1a5)+_0x4309e3+_0x4c1b8d(0x133)),console[_0x4c1b8d(0x174)](_0x4c1b8d(0xb7)+_0x1d2973[_0x4c1b8d(0x16c)](0x6)+_0x4c1b8d(0xbb));}else{if(_0x3161a3===_0x4c1b8d(0x107)&&_0x36a11c!=='PAID'){if(_0x14e00a[_0x4c1b8d(0xa4)]){let _0x3c2b6f=0x2d;const _0x126f36=await _0x23fd1d[_0x4c1b8d(0x15c)]['findUnique']({'where':{'id':_0x14e00a[_0x4c1b8d(0x99)]},'select':{'gatewaySettings':!![]}});if(_0x126f36?.[_0x4c1b8d(0x11d)])try{const _0x58a72a=JSON['parse'](_0x126f36['gatewaySettings']);for(const [_0x447775,_0x4b64fa]of Object['entries'](_0x58a72a)){if(_0x447775[_0x4c1b8d(0xb8)]()===_0x14e00a[_0x4c1b8d(0xfe)][_0x4c1b8d(0xb8)]()){_0x3c2b6f=_0x4b64fa[_0x4c1b8d(0xbd)]||0xa;break;}}}catch(_0x501ff9){console[_0x4c1b8d(0x149)]('Error\x20parsing\x20gateway\x20settings\x20for\x20payment\x20'+_0x33baaf+':',_0x501ff9);}const _0x3f134a=_0x14e00a['amountUSDT']*(0x1-_0x3c2b6f/0x64);_0x27dadd=-_0x3f134a,_0x3e3379-=_0x3f134a,_0x4fe07e[_0x4c1b8d(0xa4)]=null,_0x4fe07e[_0x4c1b8d(0x17b)]=null,console[_0x4c1b8d(0x174)](_0x4c1b8d(0xda)+_0x33baaf+_0x4c1b8d(0x11e)),console[_0x4c1b8d(0x174)](_0x4c1b8d(0xd9)+_0x14e00a[_0x4c1b8d(0xa4)][_0x4c1b8d(0x16c)](0x6)+_0x4c1b8d(0xbb)),console[_0x4c1b8d(0x174)](_0x4c1b8d(0x164)+_0x14e00a[_0x4c1b8d(0xfe)]+',\x20Commission:\x20'+_0x3c2b6f+'%'),console['log']('\x20\x20\x20Merchant\x20loses:\x20'+_0x3f134a[_0x4c1b8d(0x16c)](0x6)+_0x4c1b8d(0x1a5)+_0x3c2b6f+'%\x20commission)'),console[_0x4c1b8d(0x174)]('\x20\x20\x20Subtracted\x20from\x20balance:\x20-'+_0x3f134a[_0x4c1b8d(0x16c)](0x6)+_0x4c1b8d(0xbb));}}}_0x36a11c===_0x4c1b8d(0x109)&&(_0x3161a3===_0x4c1b8d(0x107)&&_0x14e00a[_0x4c1b8d(0xa4)]&&console['log'](_0x4c1b8d(0xac)),_0x30e2bc&&_0x30e2bc>0x0&&(_0x27dadd-=_0x30e2bc,_0x3e3379-=_0x30e2bc,console['log'](_0x4c1b8d(0xf2)+_0x30e2bc['toFixed'](0x6)+_0x4c1b8d(0xd7))));_0x36a11c==='REFUND'&&_0x3161a3===_0x4c1b8d(0x107)&&console[_0x4c1b8d(0x174)](_0x4c1b8d(0x1cc));const _0x19131c=await _0x23fd1d['payment'][_0x4c1b8d(0x116)]({'where':{'id':_0x33baaf},'data':_0x4fe07e,'include':{'shop':{'select':{'name':!![],'username':!![]}}}});return _0x27dadd!==0x0&&(await _0x23fd1d[_0x4c1b8d(0x15c)][_0x4c1b8d(0x116)]({'where':{'id':_0x14e00a[_0x4c1b8d(0x99)]},'data':{'balance':_0x3e3379}}),console[_0x4c1b8d(0x174)](_0x4c1b8d(0xd3)+_0x14e00a[_0x4c1b8d(0x99)]+'\x20balance\x20updated:\x20'+_0x14e00a[_0x4c1b8d(0x15c)][_0x4c1b8d(0x11a)][_0x4c1b8d(0x16c)](0x6)+'\x20->\x20'+_0x3e3379[_0x4c1b8d(0x16c)](0x6)+_0x4c1b8d(0x142)+(_0x27dadd>0x0?'+':'')+_0x27dadd[_0x4c1b8d(0x16c)](0x6)+')')),_0x19131c;});return{'id':_0x2d56fa['id'],'shopId':_0x2d56fa[_0x2966f0(0x99)],'gateway':_0x2d56fa[_0x2966f0(0xfe)],'amount':_0x2d56fa[_0x2966f0(0x183)],'currency':_0x2d56fa[_0x2966f0(0x1c3)],'status':_0x2d56fa[_0x2966f0(0x175)],'orderId':_0x2d56fa['orderId'],'gatewayOrderId':_0x2d56fa[_0x2966f0(0x1cb)],'customerEmail':_0x2d56fa[_0x2966f0(0x16a)],'customerName':_0x2d56fa[_0x2966f0(0x132)],'customerCountry':_0x2d56fa[_0x2966f0(0x9c)],'customerIp':_0x2d56fa[_0x2966f0(0x160)],'customerUa':_0x2d56fa[_0x2966f0(0x103)],'failureMessage':_0x2d56fa[_0x2966f0(0x136)],'adminNotes':_0x2d56fa['adminNotes'],'chargebackAmount':_0x2d56fa['chargebackAmount'],'statusChangedBy':_0x2d56fa[_0x2966f0(0x155)],'statusChangedAt':_0x2d56fa[_0x2966f0(0x115)],'createdAt':_0x2d56fa[_0x2966f0(0x1c2)],'updatedAt':_0x2d56fa[_0x2966f0(0xb6)],'shop':_0x2d56fa[_0x2966f0(0x15c)]};}async[a38_0x406ac5(0x13f)](_0x317fa6,_0x1e6d6c){const _0x3aa4fd=a38_0x406ac5,_0x4667c6=Math[_0x3aa4fd(0x1b8)]()[_0x3aa4fd(0xf3)](0x24)['substr'](0x2,0x9);console[_0x3aa4fd(0x174)]('🎯\x20updateUser\x20called\x20with\x20ID:\x20'+_0x4667c6+_0x3aa4fd(0x17a)+_0x317fa6);const _0x4c866c={..._0x1e6d6c};_0x1e6d6c[_0x3aa4fd(0xe8)]&&_0x1e6d6c['password']['trim']()!==''?(console[_0x3aa4fd(0x174)]('🔐\x20['+_0x4667c6+_0x3aa4fd(0x13a)+_0x317fa6),_0x4c866c[_0x3aa4fd(0xe8)]=await bcryptjs_1[_0x3aa4fd(0x16e)]['hash'](_0x1e6d6c[_0x3aa4fd(0xe8)],0xc)):(console['log'](_0x3aa4fd(0xe4)+_0x4667c6+_0x3aa4fd(0x181)),delete _0x4c866c[_0x3aa4fd(0xe8)]);_0x1e6d6c['fullName']&&(_0x4c866c[_0x3aa4fd(0x16b)]=_0x1e6d6c[_0x3aa4fd(0x19f)],delete _0x4c866c['fullName']);_0x1e6d6c[_0x3aa4fd(0x13b)]&&(_0x4c866c[_0x3aa4fd(0x1a4)]=_0x1e6d6c['telegramId'],delete _0x4c866c[_0x3aa4fd(0x13b)]);_0x1e6d6c[_0x3aa4fd(0x92)]&&(_0x4c866c[_0x3aa4fd(0x128)]=_0x1e6d6c[_0x3aa4fd(0x92)],delete _0x4c866c['merchantUrl']);if(_0x1e6d6c[_0x3aa4fd(0x11f)]){const _0x349270=_0x1e6d6c[_0x3aa4fd(0x11f)]['map'](_0x3d5171=>this[_0x3aa4fd(0x1bb)](_0x3d5171));console[_0x3aa4fd(0x174)](_0x3aa4fd(0x138),_0x1e6d6c[_0x3aa4fd(0x11f)],'->',_0x349270),_0x4c866c[_0x3aa4fd(0x146)]=JSON[_0x3aa4fd(0x14e)](_0x349270),delete _0x4c866c['gateways'];}_0x1e6d6c[_0x3aa4fd(0x11d)]&&(console[_0x3aa4fd(0x174)](_0x3aa4fd(0x93)+_0x4667c6+_0x3aa4fd(0xc6),_0x1e6d6c[_0x3aa4fd(0x11d)]),_0x4c866c[_0x3aa4fd(0x11d)]=JSON[_0x3aa4fd(0x14e)](_0x1e6d6c[_0x3aa4fd(0x11d)]),console[_0x3aa4fd(0x174)]('🔧\x20['+_0x4667c6+_0x3aa4fd(0xb9),_0x4c866c[_0x3aa4fd(0x11d)]));_0x1e6d6c[_0x3aa4fd(0x189)]&&(_0x1e6d6c[_0x3aa4fd(0x189)][_0x3aa4fd(0x197)]!==undefined&&(_0x4c866c[_0x3aa4fd(0x197)]=_0x1e6d6c['wallets'][_0x3aa4fd(0x197)]||null),_0x1e6d6c[_0x3aa4fd(0x189)][_0x3aa4fd(0x172)]!==undefined&&(_0x4c866c['usdtTrcWallet']=_0x1e6d6c[_0x3aa4fd(0x189)][_0x3aa4fd(0x172)]||null),_0x1e6d6c[_0x3aa4fd(0x189)]['usdtErcWallet']!==undefined&&(_0x4c866c[_0x3aa4fd(0xa5)]=_0x1e6d6c[_0x3aa4fd(0x189)][_0x3aa4fd(0xa5)]||null),_0x1e6d6c[_0x3aa4fd(0x189)][_0x3aa4fd(0x167)]!==undefined&&(_0x4c866c[_0x3aa4fd(0x167)]=_0x1e6d6c[_0x3aa4fd(0x189)]['usdcPolygonWallet']||null),delete _0x4c866c[_0x3aa4fd(0x189)]);const _0x31771a=await database_1[_0x3aa4fd(0x16e)][_0x3aa4fd(0x15c)][_0x3aa4fd(0x116)]({'where':{'id':_0x317fa6},'data':_0x4c866c,'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});return console[_0x3aa4fd(0x174)]('🎯\x20['+_0x4667c6+_0x3aa4fd(0xfa),_0x31771a[_0x3aa4fd(0x11d)]),{'id':_0x31771a['id'],'fullName':_0x31771a['name'],'username':_0x31771a[_0x3aa4fd(0x1b2)],'telegramId':_0x31771a['telegram'],'merchantUrl':_0x31771a[_0x3aa4fd(0x128)],'gateways':_0x31771a[_0x3aa4fd(0x146)]?JSON[_0x3aa4fd(0x1a7)](_0x31771a['paymentGateways']):null,'gatewaySettings':_0x31771a['gatewaySettings']?JSON[_0x3aa4fd(0x1a7)](_0x31771a[_0x3aa4fd(0x11d)]):null,'publicKey':_0x31771a[_0x3aa4fd(0x139)],'wallets':{'usdtPolygonWallet':_0x31771a['usdtPolygonWallet'],'usdtTrcWallet':_0x31771a[_0x3aa4fd(0x172)],'usdtErcWallet':_0x31771a[_0x3aa4fd(0xa5)],'usdcPolygonWallet':_0x31771a[_0x3aa4fd(0x167)]},'status':_0x31771a[_0x3aa4fd(0x175)],'createdAt':_0x31771a[_0x3aa4fd(0x1c2)]};}async['suspendUser'](_0x1b36b0){const _0x1dfd89=a38_0x406ac5,_0x3bc403=await database_1['default'][_0x1dfd89(0x15c)][_0x1dfd89(0x116)]({'where':{'id':_0x1b36b0},'data':{'status':_0x1dfd89(0x187)},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});return{'id':_0x3bc403['id'],'fullName':_0x3bc403[_0x1dfd89(0x16b)],'username':_0x3bc403[_0x1dfd89(0x1b2)],'telegramId':_0x3bc403[_0x1dfd89(0x1a4)],'merchantUrl':_0x3bc403[_0x1dfd89(0x128)],'gateways':_0x3bc403[_0x1dfd89(0x146)]?JSON[_0x1dfd89(0x1a7)](_0x3bc403[_0x1dfd89(0x146)]):null,'gatewaySettings':_0x3bc403[_0x1dfd89(0x11d)]?JSON['parse'](_0x3bc403[_0x1dfd89(0x11d)]):null,'publicKey':_0x3bc403[_0x1dfd89(0x139)],'wallets':{'usdtPolygonWallet':_0x3bc403[_0x1dfd89(0x197)],'usdtTrcWallet':_0x3bc403[_0x1dfd89(0x172)],'usdtErcWallet':_0x3bc403[_0x1dfd89(0xa5)],'usdcPolygonWallet':_0x3bc403['usdcPolygonWallet']},'status':_0x3bc403[_0x1dfd89(0x175)],'createdAt':_0x3bc403['createdAt']};}async[a38_0x406ac5(0x148)](_0x4b208c){const _0x286fd6=a38_0x406ac5,_0x2012f2=await database_1[_0x286fd6(0x16e)][_0x286fd6(0x15c)][_0x286fd6(0x116)]({'where':{'id':_0x4b208c},'data':{'status':'ACTIVE'},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});return{'id':_0x2012f2['id'],'fullName':_0x2012f2['name'],'username':_0x2012f2[_0x286fd6(0x1b2)],'telegramId':_0x2012f2[_0x286fd6(0x1a4)],'merchantUrl':_0x2012f2[_0x286fd6(0x128)],'gateways':_0x2012f2[_0x286fd6(0x146)]?JSON[_0x286fd6(0x1a7)](_0x2012f2[_0x286fd6(0x146)]):null,'gatewaySettings':_0x2012f2[_0x286fd6(0x11d)]?JSON[_0x286fd6(0x1a7)](_0x2012f2[_0x286fd6(0x11d)]):null,'publicKey':_0x2012f2[_0x286fd6(0x139)],'wallets':{'usdtPolygonWallet':_0x2012f2['usdtPolygonWallet'],'usdtTrcWallet':_0x2012f2['usdtTrcWallet'],'usdtErcWallet':_0x2012f2[_0x286fd6(0xa5)],'usdcPolygonWallet':_0x2012f2[_0x286fd6(0x167)]},'status':_0x2012f2[_0x286fd6(0x175)],'createdAt':_0x2012f2[_0x286fd6(0x1c2)]};}async['getAllUsers'](_0x2352a1){const _0x5c24bc=a38_0x406ac5,{page:_0x2763da,limit:_0xd05718,status:_0xa7ed78}=_0x2352a1,_0x1da450=(_0x2763da-0x1)*_0xd05718,_0x5c90a6={};_0xa7ed78&&(_0x5c90a6[_0x5c24bc(0x175)]=_0xa7ed78[_0x5c24bc(0xed)]());const [_0x3967c1,_0x6920ce]=await Promise['all']([database_1['default'][_0x5c24bc(0x15c)][_0x5c24bc(0x193)]({'where':_0x5c90a6,'skip':_0x1da450,'take':_0xd05718,'orderBy':{'createdAt':_0x5c24bc(0x135)},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}}),database_1['default'][_0x5c24bc(0x15c)][_0x5c24bc(0x178)]({'where':_0x5c90a6})]);return{'users':_0x3967c1[_0x5c24bc(0x1cd)](_0x3f1a58=>{const _0x4d2fb4=_0x5c24bc,_0x395148=_0x3f1a58['paymentGateways']?JSON[_0x4d2fb4(0x1a7)](_0x3f1a58[_0x4d2fb4(0x146)]):null,_0x4aec3f=_0x395148?_0x395148[_0x4d2fb4(0x1cd)](_0x4e32da=>this[_0x4d2fb4(0xa3)](_0x4e32da)):null;return{'id':_0x3f1a58['id'],'fullName':_0x3f1a58[_0x4d2fb4(0x16b)],'username':_0x3f1a58['username'],'telegramId':_0x3f1a58[_0x4d2fb4(0x1a4)],'merchantUrl':_0x3f1a58[_0x4d2fb4(0x128)],'gateways':_0x4aec3f,'gatewaySettings':_0x3f1a58['gatewaySettings']?JSON['parse'](_0x3f1a58['gatewaySettings']):null,'publicKey':_0x3f1a58[_0x4d2fb4(0x139)],'wallets':{'usdtPolygonWallet':_0x3f1a58['usdtPolygonWallet'],'usdtTrcWallet':_0x3f1a58[_0x4d2fb4(0x172)],'usdtErcWallet':_0x3f1a58['usdtErcWallet'],'usdcPolygonWallet':_0x3f1a58[_0x4d2fb4(0x167)]},'status':_0x3f1a58[_0x4d2fb4(0x175)],'createdAt':_0x3f1a58['createdAt']};}),'pagination':{'page':_0x2763da,'limit':_0xd05718,'total':_0x6920ce,'totalPages':Math['ceil'](_0x6920ce/_0xd05718)}};}async[a38_0x406ac5(0x15b)](_0x122979){const _0x485b9d=a38_0x406ac5,_0x4777af=await database_1[_0x485b9d(0x16e)][_0x485b9d(0x15c)][_0x485b9d(0x98)]({'where':{'id':_0x122979},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});if(!_0x4777af)return null;const _0x1e391a=_0x4777af[_0x485b9d(0x146)]?JSON[_0x485b9d(0x1a7)](_0x4777af[_0x485b9d(0x146)]):null,_0x12436e=_0x1e391a?_0x1e391a[_0x485b9d(0x1cd)](_0x4fe705=>this[_0x485b9d(0xa3)](_0x4fe705)):null;return _0x1e391a&&_0x12436e&&console['log'](_0x485b9d(0x100),_0x1e391a,'->',_0x12436e),{'id':_0x4777af['id'],'fullName':_0x4777af['name'],'username':_0x4777af[_0x485b9d(0x1b2)],'telegramId':_0x4777af[_0x485b9d(0x1a4)],'merchantUrl':_0x4777af[_0x485b9d(0x128)],'gateways':_0x12436e,'gatewaySettings':_0x4777af[_0x485b9d(0x11d)]?JSON['parse'](_0x4777af[_0x485b9d(0x11d)]):null,'publicKey':_0x4777af[_0x485b9d(0x139)],'wallets':{'usdtPolygonWallet':_0x4777af['usdtPolygonWallet'],'usdtTrcWallet':_0x4777af[_0x485b9d(0x172)],'usdtErcWallet':_0x4777af[_0x485b9d(0xa5)],'usdcPolygonWallet':_0x4777af[_0x485b9d(0x167)]},'status':_0x4777af[_0x485b9d(0x175)],'createdAt':_0x4777af['createdAt']};}async[a38_0x406ac5(0x1aa)](_0x2f3b03){const _0x3c91d4=a38_0x406ac5,{fullName:_0x3f5808,username:_0x1b4750,password:_0x219dc2,telegramId:_0x5c1404,merchantUrl:_0x1e100e,gateways:_0x4c6baa,gatewaySettings:_0xc12121,wallets:_0x4337b4}=_0x2f3b03,_0x257004=await database_1[_0x3c91d4(0x16e)]['shop'][_0x3c91d4(0x98)]({'where':{'username':_0x1b4750}});if(_0x257004)throw new Error(_0x3c91d4(0x1a3));if(_0x5c1404){const _0x13f8f1=await database_1['default'][_0x3c91d4(0x15c)][_0x3c91d4(0x98)]({'where':{'telegram':_0x5c1404}});if(_0x13f8f1)throw new Error(_0x3c91d4(0x17c));}const _0x5cc01b=await bcryptjs_1[_0x3c91d4(0x16e)]['hash'](_0x219dc2,0xc),_0x1c9280=_0x3c91d4(0x18d)+crypto_1['default'][_0x3c91d4(0x143)](0x20)[_0x3c91d4(0xf3)](_0x3c91d4(0x1bc)),_0x3ae3a5='sk_'+crypto_1['default'][_0x3c91d4(0x143)](0x20)[_0x3c91d4(0xf3)](_0x3c91d4(0x1bc)),_0xcd5cc4=_0x4c6baa?_0x4c6baa['map'](_0x2a337f=>this[_0x3c91d4(0x1bb)](_0x2a337f)):null;_0x4c6baa&&_0xcd5cc4&&console[_0x3c91d4(0x174)](_0x3c91d4(0x1b9),_0x4c6baa,'->',_0xcd5cc4);const _0x160a8f=await database_1[_0x3c91d4(0x16e)]['shop'][_0x3c91d4(0xa0)]({'data':{'name':_0x3f5808,'username':_0x1b4750,'password':_0x5cc01b,'telegram':_0x5c1404,'shopUrl':_0x1e100e,'paymentGateways':_0xcd5cc4?JSON[_0x3c91d4(0x14e)](_0xcd5cc4):null,'gatewaySettings':_0xc12121?JSON['stringify'](_0xc12121):null,'usdtPolygonWallet':_0x4337b4?.[_0x3c91d4(0x197)]||null,'usdtTrcWallet':_0x4337b4?.['usdtTrcWallet']||null,'usdtErcWallet':_0x4337b4?.[_0x3c91d4(0xa5)]||null,'usdcPolygonWallet':_0x4337b4?.['usdcPolygonWallet']||null,'publicKey':_0x1c9280,'secretKey':_0x3ae3a5,'status':_0x3c91d4(0x192)},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});return{'id':_0x160a8f['id'],'fullName':_0x160a8f['name'],'username':_0x160a8f[_0x3c91d4(0x1b2)],'telegramId':_0x160a8f[_0x3c91d4(0x1a4)],'merchantUrl':_0x160a8f['shopUrl'],'gateways':_0x160a8f[_0x3c91d4(0x146)]?JSON[_0x3c91d4(0x1a7)](_0x160a8f['paymentGateways']):null,'gatewaySettings':_0x160a8f[_0x3c91d4(0x11d)]?JSON[_0x3c91d4(0x1a7)](_0x160a8f[_0x3c91d4(0x11d)]):null,'publicKey':_0x160a8f[_0x3c91d4(0x139)],'wallets':{'usdtPolygonWallet':_0x160a8f[_0x3c91d4(0x197)],'usdtTrcWallet':_0x160a8f[_0x3c91d4(0x172)],'usdtErcWallet':_0x160a8f[_0x3c91d4(0xa5)],'usdcPolygonWallet':_0x160a8f[_0x3c91d4(0x167)]},'status':_0x160a8f['status'],'createdAt':_0x160a8f[_0x3c91d4(0x1c2)]};}async['deleteUser'](_0x43a4ed){const _0x2be7ab=a38_0x406ac5;await database_1[_0x2be7ab(0x16e)][_0x2be7ab(0x15c)]['delete']({'where':{'id':_0x43a4ed}});}[a38_0x406ac5(0xd6)](_0x518d02,_0x213f56,_0x118775){const _0x31db8b=a38_0x406ac5,_0x27248c=new Map(),_0x4bee64=new Date(_0x213f56);while(_0x4bee64<=_0x118775){const _0x5b48f8=_0x4bee64['toISOString']()[_0x31db8b(0x1be)]('T')[0x0];_0x27248c[_0x31db8b(0xe0)](_0x5b48f8,{'revenue':0x0,'count':0x0}),_0x4bee64[_0x31db8b(0x101)](_0x4bee64['getDate']()+0x1);}for(const _0x1048ab of _0x518d02){const _0x51eb8b=_0x1048ab[_0x31db8b(0x1c2)][_0x31db8b(0x14b)]()[_0x31db8b(0x1be)]('T')[0x0],_0xbf6905=_0x27248c[_0x31db8b(0xba)](_0x51eb8b);_0xbf6905&&(_0xbf6905[_0x31db8b(0x178)]+=0x1,_0x1048ab[_0x31db8b(0x175)]==='PAID'&&(_0x1048ab[_0x31db8b(0xa4)]?_0xbf6905[_0x31db8b(0x129)]+=_0x1048ab[_0x31db8b(0xa4)]:console[_0x31db8b(0x174)](_0x31db8b(0x165)+_0x1048ab['id']+'\x20missing\x20amountUSDT,\x20using\x20fallback\x20conversion')));}const _0x2872cf=[],_0x16d9ca=[];for(const [_0x3d7d7a,_0x91333d]of _0x27248c){_0x2872cf[_0x31db8b(0x14f)]({'date':_0x3d7d7a,'amount':Math[_0x31db8b(0x185)](_0x91333d['revenue']*0x64)/0x64}),_0x16d9ca[_0x31db8b(0x14f)]({'date':_0x3d7d7a,'count':_0x91333d[_0x31db8b(0x178)]});}return{'dailyRevenue':_0x2872cf,'dailyPayments':_0x16d9ca};}}function a38_0x1ad8(){const _0x5f1fcd=['getGatewayDisplayName','amountUSDT','usdtErcWallet','amountAfterCommissionUSDT','all','erc20','localeCompare','COMPLETED','\x27\x20->\x20ID\x20\x27','💸\x20CHARGEBACK:\x20Merchant\x20amount\x20already\x20deducted\x20from\x20balance','getPayoutStats','758dxVPbY','2591xsLdQQ','0000','\x20\x20\x20Merchant\x20gets:\x20','\x20merchants','setHours','1330672eFijSA','📊\x20Final\x20WHERE\x20conditions:','updatedAt','\x20\x20\x20Added\x20to\x20balance:\x20+','toLowerCase',']\x20Gateway\x20settings\x20JSON\x20string:','get','\x20USDT','📊\x20Merchants\x20awaiting\x20payout:\x20','commission','📊\x20Sorting\x20payments\x20by\x20','Payment\x20not\x20found','\x20USDT\x20(gross\x20revenue)','185730uZfBEu','successUrl','paymentsCount','externalPaymentUrl','adminNotes',']\x20Gateway\x20settings\x20before\x20saving:','\x20\x20\x20�\x20Total\x20payments\x20turnover:\x20','convertToUSDT','\x20\x20\x20💸\x20Total\x20payouts\x20(all\x20time):\x20','findFirst','getMonth','getGatewayIdByName','getPaymentById','test_gateway','period','💰\x20Found\x20',',\x20Commission:\x20','\x20\x20\x20🏪\x20Gateway\x20earnings:\x20','💰\x20Shop\x20','140348ZsuLga','klyme_de','generateDailyStatistics','\x20USDT\x20from\x20balance','📊\x20Calculating\x20payout\x20statistics...','\x20\x20\x20Full\x20amount:\x20','💰\x20Payment\x20','totalPayout','226107VcXgTM','CoinToPay','entries','💰\x20[PAYOUT]\x20Merchant\x20','set','failUrl','\x20USDT\x20for\x20payment\x20','gte','🔐\x20[','paidOutUSDT','\x20USDT\x20(-','cointopay','password','\x20order','../types/gateway','🔄\x20Converted\x20gateway\x20name\x20\x27','awaitingPayout','toUpperCase','\x20USDT\x20(already\x20paid\x20out)',',\x20successful:\x20','Rapyd',':\x20commission\x20=\x20','💸\x20CHARGEBACK\x20penalty:\x20-','toString','\x20\x20\x20Payout\x20amount:\x20','18ORHGFU','averageCheckUSDT','\x20\x20\x20�📊\x20Total\x20payments:\x20','\x20has\x20zero\x20or\x20null\x20amountUSDT,\x20skipping...','\x20\x20\x20⏳\x20Pending\x20payout:\x20',']\x20User\x20updated,\x20gatewaySettings\x20from\x20DB:','notes','\x27\x20to\x20name\x20\x27','📊\x20Getting\x20merchants\x20awaiting\x20payout\x20with\x20filters:','gateway','day','🔄\x20Gateway\x20mapping\x20(get):','setDate','\x20payments)','customerUa','📊\x20Merchant\x20statistics\x20calculated:','MasterCard','defineProperty','PAID','length','CHARGEBACK','30d','txid','chargebackAmount','merchantEarningsUSDT','Test\x20Gateway','admin','pendingUrl','\x20USDT\x20(calculated\x20-\x20payouts\x20-\x20balance)','\x27\x20as\x20is\x20(not\x20found\x20in\x20mappings)','aggregate','pendingPayout','statusChangedAt','update','⚠️\x20Gateway\x20\x27','📊\x20[ADMIN]\x20Using\x20saved\x20amountAfterGatewayCommissionUSDT:\x20','\x20\x20\x20⏳\x20Awaiting\x20payout:\x20','balance','_sum','\x20USDT\x20(+','gatewaySettings','\x20no\x20longer\x20PAID:','gateways','insensitive','custom','turnoverUSDT','paidAt','PENDING','\x20\x20\x20🌐\x20IP:\x20','totalAmountUSDT','getFullYear','shopUrl','revenue','\x20\x20\x20💸\x20Total\x20payouts:\x20','Noda','periodFrom','✅\x20Customer\x20data\x20updated\x20for\x20payment\x20','yesterday','\x20\x20\x20✅\x20Total\x20available\x20for\x20payout:\x20','\x20\x20\x20👤\x20Merchant\x20earnings:\x20','rapyd','customerName','%\x20commission)','getMerchantStatistics','desc','failureMessage','deletePayout','🔄\x20Gateway\x20mapping:','publicKey',']\x20Updating\x20password\x20for\x20user\x20','telegramId','📊\x20Gateway\x20filter\x20applied:','payout','ceil','updateUser','dateFrom','\x20USDT)','\x20USDT\x20(','randomBytes','📊\x20Calculating\x20commission\x20manually\x20for\x20payment\x20','crypto','paymentGateways','__importDefault','activateUser','error','\x20active\x20merchants\x20for\x20selection','toISOString','values','3775400bvnTTz','stringify','push','✅\x20Payout\x20created:\x20','\x20\x20\x20💵\x20Available\x20balance:\x20','📊\x20[ADMIN]\x20Calculating\x20commission\x20manually\x20for\x20payment\x20','Error\x20processing\x20payment\x20','\x20balance\x20updated:','statusChangedBy','totalPaidOut','orderId','$transaction','_count','klyme_eu','getUserById','shop','2020-01-01','updateCustomerData','polygon_usdc','customerIp','totalCommissionRate','currencyService','getTime','\x20\x20\x20Gateway:\x20','⚠️\x20Payment\x20','dateTo','usdcPolygonWallet','\x20\x20\x20💳\x20Total\x20payments:\x20','\x20status:\x20','customerEmail','name','toFixed','\x20\x20\x20💰\x20Total\x20payments\x20turnover:\x20','default','trc20','gatewayEarnings','bcryptjs','usdtTrcWallet','\x20to\x20','log','status','getGatewayNameById','\x20\x20\x20Current\x20total\x20paid\x20out:\x20','count','\x20USDT\x20(same\x20as\x20awaiting)',',\x20userId:\x20','amountAfterGatewayCommissionUSDT','Telegram\x20username\x20already\x20exists','forEach','not\x20set','asc','availableBalance',']\x20Password\x20not\x20provided\x20or\x20empty,\x20skipping\x20password\x20update','💱\x20Currency\x20filter\x20applied:\x20','amount','\x27\x20->\x20name\x20\x27','round','KLYME\x20GB','SUSPENDED','totalTurnover','wallets','getPayoutById','📊\x20Payout\x20statistics\x20calculated:','\x20\x20\x20�\x20Total\x20paid\x20out:\x20','pk_','📋\x20Found\x20','Plisio','⚠️\x20Requested\x20gateway\x20\x27','\x20\x20\x20🤔\x20Difference:\x20','ACTIVE','findMany','network','dailyPayments','\x20\x20\x20💰\x20Total\x20payout:\x20','usdtPolygonWallet','115vOcxPj','totalPayments','getAllPayments','11278366AkiOgI','./currencyService','lte','merchantEarnings','fullName','AdminService','🔍\x20Using\x20gateway\x20\x27','📊\x20Getting\x20merchant\x20statistics\x20with\x20filters:','Username\x20already\x20exists','telegram','\x20USDT\x20(after\x20','includes','parse','getDate','whiteUrl','createUser','periodTo','__esModule','groupBy','📅\x20Period:\x20','%\x20from\x20','\x27\x20(from\x20\x27','\x20USDT\x20(sum\x20of\x20all\x20merchant\x20balances)','username','reduce','📊\x20Using\x20saved\x20commission\x20rate\x20for\x20payment\x20','getSystemStatistics','Shop\x20not\x20found','300LxOdMr','random','🔄\x20Gateway\x20mapping\x20(create):','\x20merchants\x20with\x20positive\x20balance','getGatewayInternalName','hex','payment','split','commissionUSDT','\x20->\x20','gatewayCommissionRate','createdAt','currency','cointopay2','\x20USDT,\x20Requested:\x20','not\x20specified','sort','thisMonth','📊\x20Using\x20saved\x20values\x20for\x20payment\x20','turnover','gatewayOrderId','🔄\x20REFUND:\x20Payment\x20amount\x20already\x20deducted\x20from\x20balance','map','noda','💳\x20Payout\x20wallet\x20for\x20','\x20for\x20shop\x20','klyme_gb','merchantUrl','🔧\x20[','📊\x20Getting\x20payments\x20with\x20filters:','getAllPayouts','💰\x20Current\x20shop\x20balance:\x20','Error\x20parsing\x20gateway\x20settings\x20for\x20payment\x20','findUnique','shopId','Error\x20parsing\x20gateway\x20settings\x20for\x20shop\x20','\x20\x20\x20Current\x20balance:\x20','customerCountry','plisio','\x20became\x20PAID:','\x20\x20\x20💰\x20Total\x20turnover:\x20','create','getMerchantsAwaitingPayout','updatePaymentStatus'];a38_0x1ad8=function(){return _0x5f1fcd;};return a38_0x1ad8();}function a38_0x3de1(_0x50c248,_0x337d68){const _0x1ad88d=a38_0x1ad8();return a38_0x3de1=function(_0x3de1ec,_0x3509a9){_0x3de1ec=_0x3de1ec-0x91;let _0x2cf25f=_0x1ad88d[_0x3de1ec];return _0x2cf25f;},a38_0x3de1(_0x50c248,_0x337d68);}exports[a38_0x406ac5(0x1a0)]=AdminService;