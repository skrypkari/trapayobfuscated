'use strict';const a35_0x550295=a35_0x4df7;function a35_0x4df7(_0x50a783,_0x52d229){const _0x5144d8=a35_0x5144();return a35_0x4df7=function(_0x4df7f3,_0x4a05dc){_0x4df7f3=_0x4df7f3-0x14e;let _0x5f40c9=_0x5144d8[_0x4df7f3];return _0x5f40c9;},a35_0x4df7(_0x50a783,_0x52d229);}(function(_0x210401,_0x42607b){const _0x253d70=a35_0x4df7,_0x4584a4=_0x210401();while(!![]){try{const _0x566c17=parseInt(_0x253d70(0x161))/0x1*(parseInt(_0x253d70(0x1c2))/0x2)+-parseInt(_0x253d70(0x186))/0x3*(parseInt(_0x253d70(0x1e9))/0x4)+-parseInt(_0x253d70(0x162))/0x5*(-parseInt(_0x253d70(0x166))/0x6)+parseInt(_0x253d70(0x1b7))/0x7+-parseInt(_0x253d70(0x1a3))/0x8*(-parseInt(_0x253d70(0x204))/0x9)+-parseInt(_0x253d70(0x1a2))/0xa+-parseInt(_0x253d70(0x19f))/0xb;if(_0x566c17===_0x42607b)break;else _0x4584a4['push'](_0x4584a4['shift']());}catch(_0x1ae75b){_0x4584a4['push'](_0x4584a4['shift']());}}}(a35_0x5144,0x2537f));var __importDefault=this&&this['__importDefault']||function(_0x2a8d2d){const _0x34eec5=a35_0x4df7;return _0x2a8d2d&&_0x2a8d2d[_0x34eec5(0x182)]?_0x2a8d2d:{'default':_0x2a8d2d};};Object[a35_0x550295(0x1cc)](exports,a35_0x550295(0x182),{'value':!![]}),exports[a35_0x550295(0x17e)]=void 0x0;function a35_0x5144(){const _0x68cf06=['bcryptjs','getAllPayments','parse','all','sk_','merchantEarnings','error','thisMonth','updatedAt','customerEmail','REFUND','externalPaymentUrl','getDate','customerCountry','\x20USDT\x20to\x20balance','üí∞\x20Current\x20shop\x20balance:\x20','\x20USDT\x20(total\x20paid\x20to\x20merchants)','\x20\x20\x20üìä\x20Total\x20payments:\x20','\x20\x20\x20üìà\x20Conversion\x20rate:\x20','map','üí∞\x20[DAILY]\x20Added\x20','length','INACTIVE','aggregate','failUrl','gatewayOrderId','CHARGEBACK','\x20USDT','\x20became\x20PAID:\x20+','updateUser','shop','gatewayEarnings','toUpperCase','\x20\x20\x20üíµ\x20Available\x20balance:\x20','üìä\x20Conversion\x20rate\x20calculation:','amountUSDT','\x20\x20\x20üè™\x20Gateway\x20earnings:\x20','_count','KLYME\x20DE','\x20USDT\x20total','\x20PAID\x20payments\x20out\x20of\x20','gateway','_sum','\x20USDT\x20(-','üí∞\x20Payment\x20','chargebackAmount','\x20no\x20longer\x20PAID:\x20-','\x20\x20\x20‚úÖ\x20Successful\x20payments:\x20','üìä\x20Payout\x20statistics\x20calculated:','paymentMethod','stringify','currency','delete','payment','totalCommissionRate','default','balance','usdtTrcWallet','CoinToPay','1125KooRLX','5HwlffK','createdAt','üìä\x20Merchant\x20statistics\x20calculated:','awaitingPayout','1631106ERqium','\x20\x20\x20Payout\x20amount:\x20','update','bankId','\x20balance\x20updated:\x20','lte','üìä\x20Payment\x20','paymentsCount','ceil','\x20merchants\x20with\x20positive\x20balance','üìä\x20Getting\x20merchant\x20statistics\x20with\x20filters:','forEach','\x20\x20\x20üñ•Ô∏è\x20User\x20Agent:\x20','telegramId','Payment\x20not\x20found','dateTo','getPaymentById','\x20\x20\x20Gateway\x20key\x20found:\x20','Plisio','hex','periodTo','customerName','desc','ACTIVE','AdminService','\x20USDT\x20from\x20balance','totalPayments','customerUa','__esModule','toLowerCase','revenue','telegram','22242fwahKO','txid','üîÑ\x20Updating\x20customer\x20data\x20for\x20payment\x20','\x20\x20\x20Current\x20total\x20paid\x20out:\x20','getMonth','COMPLETED','findMany','randomBytes','fullName','remitterName','name','localeCompare','getPayoutStats','notes','push','updateCustomerData','\x20\x20\x20üë§\x20Merchant\x20earnings:\x20','pendingUrl','\x20\x20\x20Raw\x20gatewaySettings:\x20','\x20USDT\x20(','üìÖ\x20Period:\x20','SUSPENDED','publicKey','string','averageCheckUSDT','4961550nBdeuS','shopId','gateways','1536680NfwnMh','32zqtdIw','gatewaySettings','\x20merchants,\x20','totalPayout','round','turnoverUSDT','asc','remitterIban','convertToUSDT','totalTurnover','usdtPolygonWallet','not\x20found','Rapyd','usdcPolygonWallet','\x20\x20\x20Current\x20balance:\x20','Username\x20already\x20exists','split','merchantUrl','paymentGateways','week','1442938QFeLBN','getAllPayouts','crypto','getMerchantsSelection','Test\x20Gateway','log','dateFrom','üìä\x20[DAILY]\x20Total\x20revenue\x20processed:\x20','getMerchantStatistics','üìä\x20[DAILY]\x20Processed\x20','\x20USDT,\x20Requested:\x20','180zPuvgy','90d','count','getTime','\x20USDT\x20for\x20','\x20balance\x20updated:','2020-01-01','\x20\x20\x20Final\x20commission\x20used:\x20','\x20\x20\x20Name:\x20','getSystemStatistics','defineProperty','test_gateway','üí∞\x20Creating\x20payout\x20for\x20shop\x20','updatePaymentStatus','\x20->\x20','dailyPayments','‚úÖ\x20Customer\x20data\x20updated\x20for\x20payment\x20','\x20\x20\x20Total\x20paid\x20out:\x20','toString','\x20for\x20payment\x20on\x20','period','findUnique','\x20USDT\x20(+','getMerchantsAwaitingPayout','insensitive','‚ö†Ô∏è\x20[DAILY]\x20Failed\x20to\x20convert\x20','groupBy','../config/database','custom','year','\x20\x20\x20Balance:\x20','wallets','averageCommissionRate','paidOutUSDT','\x20\x20\x20Shop:\x20','toFixed','whiteUrl','date','get','12ablxCu','currencyService','Insufficient\x20balance.\x20Available:\x20','status','shopUrl','deleteUser','adminNotes','successUrl','commission','usdtErcWallet','create','./currencyService','totalPaidOut','üìä\x20Getting\x20merchants\x20awaiting\x20payout\x20with\x20filters:','Error\x20parsing\x20gateway\x20settings\x20for\x20shop\x20','\x20\x20\x20üí∞\x20Total\x20payout:\x20','generateDailyStatistics','\x20\x20\x20Parsed\x20gatewaySettings:','‚úÖ\x20Successful\x20payments:\x20','\x20payments\x20for\x20daily\x20statistics','commissionUSDT','getFullYear','\x20to\x20','\x20paid\x20payments\x20for\x20analysis','values','find','getAllUsers','450387yKemcn','üí∞\x20Shop\x20','username','reduce','periodFrom','not\x20set','\x20USDT\x20(same\x20as\x20awaiting)','payout','set','getGatewayDisplayName','$transaction','statusChangedBy','\x20\x20\x20üåç\x20Country:\x20','cardLast4','üí∞\x20Found\x20','gte','customerIp','password','orderId','null','\x20\x20\x20üåê\x20IP:\x20','turnover','Error\x20processing\x20payment\x20','Noda','\x20commission\x20analysis:','üîÑ\x20REFUND:\x20Payment\x20amount\x20already\x20deducted\x20from\x20balance','amount','network','keys','üîÑ\x20Admin\x20updating\x20payment\x20','merchantEarningsUSDT','\x20\x20\x20Gateway:\x20','üí±\x20[DAILY]\x20Converted\x20','findFirst','failureMessage','paidAt','PAID','toISOString','üí∏\x20CHARGEBACK\x20penalty:\x20-'];a35_0x5144=function(){return _0x68cf06;};return a35_0x5144();}const database_1=__importDefault(require(a35_0x550295(0x1dd))),bcryptjs_1=__importDefault(require(a35_0x550295(0x22b))),crypto_1=__importDefault(require(a35_0x550295(0x1b9))),currencyService_1=require(a35_0x550295(0x1f4));class AdminService{async[a35_0x550295(0x192)](){const _0x349351=a35_0x550295;console[_0x349351(0x1bc)]('üìä\x20Calculating\x20payout\x20statistics...');const _0x2e8679=await database_1[_0x349351(0x15d)][_0x349351(0x249)][_0x349351(0x242)]({'_sum':{'balance':!![],'totalPaidOut':!![]},'where':{'status':_0x349351(0x17d)}}),_0x5a25be=new Date(),_0x51deb2=new Date(_0x5a25be['getFullYear'](),_0x5a25be[_0x349351(0x18a)](),0x1),_0x14cc38=new Date(_0x5a25be[_0x349351(0x1fe)](),_0x5a25be[_0x349351(0x18a)]()+0x1,0x0,0x17,0x3b,0x3b,0x3e7),_0x169f4f=await database_1[_0x349351(0x15d)][_0x349351(0x20b)][_0x349351(0x242)]({'_sum':{'amount':!![]},'where':{'createdAt':{'gte':_0x51deb2,'lte':_0x14cc38},'status':'COMPLETED'}}),_0x56b0df=_0x2e8679['_sum'][_0x349351(0x1f5)]||0x0,_0x1a0971=_0x2e8679[_0x349351(0x150)][_0x349351(0x15e)]||0x0,_0x177e03=_0x169f4f[_0x349351(0x150)][_0x349351(0x21e)]||0x0,_0x453c6e={'totalPayout':Math[_0x349351(0x1a7)](_0x56b0df*0x64)/0x64,'awaitingPayout':Math[_0x349351(0x1a7)](_0x1a0971*0x64)/0x64,'thisMonth':Math['round'](_0x177e03*0x64)/0x64,'availableBalance':Math[_0x349351(0x1a7)](_0x1a0971*0x64)/0x64};return console[_0x349351(0x1bc)](_0x349351(0x156)),console[_0x349351(0x1bc)](_0x349351(0x1f8)+_0x453c6e[_0x349351(0x1a6)]+_0x349351(0x23b)),console[_0x349351(0x1bc)]('\x20\x20\x20‚è≥\x20Awaiting\x20payout:\x20'+_0x453c6e[_0x349351(0x165)]+'\x20USDT\x20(total\x20merchant\x20balances)'),console['log'](_0x349351(0x24c)+_0x453c6e['availableBalance']+_0x349351(0x20a)),console['log']('\x20\x20\x20üìÖ\x20This\x20month:\x20'+_0x453c6e[_0x349351(0x232)]+'\x20USDT'),_0x453c6e;}async[a35_0x550295(0x195)](_0x533a20,_0x31f77b){const _0x2b5748=a35_0x550295;console[_0x2b5748(0x1bc)](_0x2b5748(0x188)+_0x533a20+':',_0x31f77b);const _0x2c7f41=await database_1[_0x2b5748(0x15d)]['payment']['findUnique']({'where':{'id':_0x533a20},'select':{'id':!![],'customerEmail':!![],'customerName':!![],'customerCountry':!![],'customerIp':!![],'customerUa':!![]}});if(!_0x2c7f41)throw new Error(_0x2b5748(0x174));const _0x98bc82={};_0x31f77b[_0x2b5748(0x238)]!==undefined&&(_0x98bc82[_0x2b5748(0x238)]=_0x31f77b['customerCountry']||null);_0x31f77b[_0x2b5748(0x214)]!==undefined&&(_0x98bc82[_0x2b5748(0x214)]=_0x31f77b[_0x2b5748(0x214)]||null);_0x31f77b['customerUa']!==undefined&&(_0x98bc82[_0x2b5748(0x181)]=_0x31f77b[_0x2b5748(0x181)]||null);const _0x3aba71=await database_1[_0x2b5748(0x15d)][_0x2b5748(0x15b)][_0x2b5748(0x168)]({'where':{'id':_0x533a20},'data':{..._0x98bc82,'updatedAt':new Date()},'select':{'id':!![],'customerEmail':!![],'customerName':!![],'customerCountry':!![],'customerIp':!![],'customerUa':!![],'updatedAt':!![]}});return console[_0x2b5748(0x1bc)](_0x2b5748(0x1d2)+_0x533a20),console[_0x2b5748(0x1bc)](_0x2b5748(0x210)+_0x2c7f41['customerCountry']+_0x2b5748(0x1d0)+_0x3aba71[_0x2b5748(0x238)]),console[_0x2b5748(0x1bc)](_0x2b5748(0x218)+_0x2c7f41[_0x2b5748(0x214)]+_0x2b5748(0x1d0)+_0x3aba71['customerIp']),console[_0x2b5748(0x1bc)](_0x2b5748(0x172)+(_0x2c7f41[_0x2b5748(0x181)]?_0x2b5748(0x20c):_0x2b5748(0x209))+_0x2b5748(0x1d0)+(_0x3aba71['customerUa']?_0x2b5748(0x20c):'not\x20set')),_0x3aba71;}async[a35_0x550295(0x1cb)](_0x525412){const _0x3b280e=a35_0x550295,_0x39f11f=new Date();let _0x48b9e1;switch(_0x525412){case'7d':_0x48b9e1=new Date(_0x39f11f[_0x3b280e(0x1c5)]()-0x7*0x18*0x3c*0x3c*0x3e8);break;case'30d':_0x48b9e1=new Date(_0x39f11f[_0x3b280e(0x1c5)]()-0x1e*0x18*0x3c*0x3c*0x3e8);break;case _0x3b280e(0x1c3):_0x48b9e1=new Date(_0x39f11f[_0x3b280e(0x1c5)]()-0x5a*0x18*0x3c*0x3c*0x3e8);break;default:_0x48b9e1=new Date(_0x39f11f['getTime']()-0x1e*0x18*0x3c*0x3c*0x3e8);}const [_0x45af6d,_0x2d76d1,_0x1f42f7,_0x2e9f0c,_0x30e285,_0x3026a4,_0x21ffb1]=await Promise['all']([database_1['default'][_0x3b280e(0x249)][_0x3b280e(0x1c4)](),database_1[_0x3b280e(0x15d)]['shop'][_0x3b280e(0x1c4)]({'where':{'status':_0x3b280e(0x17d)}}),database_1['default']['payment'][_0x3b280e(0x1c4)]({'where':{'createdAt':{'gte':_0x48b9e1},'gateway':{'not':_0x3b280e(0x1cd)}}}),database_1[_0x3b280e(0x15d)][_0x3b280e(0x15b)][_0x3b280e(0x1c4)]({'where':{'status':_0x3b280e(0x228),'createdAt':{'gte':_0x48b9e1},'gateway':{'not':_0x3b280e(0x1cd)}}}),database_1[_0x3b280e(0x15d)][_0x3b280e(0x15b)][_0x3b280e(0x18c)]({'where':{'status':_0x3b280e(0x228),'createdAt':{'gte':_0x48b9e1},'gateway':{'not':_0x3b280e(0x1cd)}},'select':{'amount':!![],'currency':!![],'amountUSDT':!![],'createdAt':!![]}}),database_1[_0x3b280e(0x15d)]['payment'][_0x3b280e(0x18c)]({'where':{'gateway':{'not':_0x3b280e(0x1cd)}},'take':0xa,'orderBy':{'createdAt':'desc'},'include':{'shop':{'select':{'name':!![],'username':!![]}}}}),database_1[_0x3b280e(0x15d)][_0x3b280e(0x15b)][_0x3b280e(0x18c)]({'where':{'createdAt':{'gte':_0x48b9e1},'gateway':{'not':_0x3b280e(0x1cd)}},'select':{'status':!![],'amountUSDT':!![],'amount':!![],'currency':!![],'createdAt':!![]},'orderBy':{'createdAt':_0x3b280e(0x1a9)}})]);let _0x14cd3c=0x0;for(const _0x1e9bc7 of _0x30e285){if(_0x1e9bc7[_0x3b280e(0x24e)])_0x14cd3c+=_0x1e9bc7[_0x3b280e(0x24e)];else{const _0x3b82d4=await currencyService_1['currencyService'][_0x3b280e(0x1ab)](_0x1e9bc7[_0x3b280e(0x21e)],_0x1e9bc7[_0x3b280e(0x159)]);_0x14cd3c+=_0x3b82d4;}}console[_0x3b280e(0x1bc)]('üìä\x20[ADMIN]\x20Processing\x20'+_0x21ffb1[_0x3b280e(0x240)]+_0x3b280e(0x1fc)),console['log']('üìä\x20[ADMIN]\x20Period:\x20'+_0x48b9e1['toISOString']()['split']('T')[0x0]+_0x3b280e(0x1ff)+_0x39f11f[_0x3b280e(0x229)]()[_0x3b280e(0x1b3)]('T')[0x0]);const _0x13bfdb=_0x21ffb1[_0x3b280e(0x207)]((_0x4c5c88,_0x54ca0e)=>{const _0x400abd=_0x3b280e;return _0x4c5c88[_0x54ca0e[_0x400abd(0x1ec)]]=(_0x4c5c88[_0x54ca0e[_0x400abd(0x1ec)]]||0x0)+0x1,_0x4c5c88;},{});console[_0x3b280e(0x1bc)]('üìä\x20[ADMIN]\x20Status\x20breakdown:',_0x13bfdb);const _0xc541c=await this['generateDailyStatistics'](_0x21ffb1,_0x48b9e1,_0x39f11f),_0x35785c=_0x1f42f7>0x0?_0x2e9f0c/_0x1f42f7*0x64:0x0;return{'totalShops':_0x45af6d,'activeShops':_0x2d76d1,'totalPayments':_0x1f42f7,'successfulPayments':_0x2e9f0c,'totalRevenue':Math[_0x3b280e(0x1a7)](_0x14cd3c*0x64)/0x64,'conversionRate':Math[_0x3b280e(0x1a7)](_0x35785c*0x64)/0x64,'dailyRevenue':_0xc541c['dailyRevenue'],'dailyPayments':_0xc541c[_0x3b280e(0x1d1)],'recentPayments':_0x3026a4['map'](_0x2f4b6c=>({'id':_0x2f4b6c['id'],'amount':_0x2f4b6c[_0x3b280e(0x21e)],'currency':_0x2f4b6c['currency'],'status':_0x2f4b6c[_0x3b280e(0x1ec)],'gateway':_0x2f4b6c[_0x3b280e(0x14f)],'shop':_0x2f4b6c[_0x3b280e(0x249)],'createdAt':_0x2f4b6c['createdAt']}))};}async[a35_0x550295(0x1f9)](_0x16d246,_0x5778fa,_0x64953b){const _0x1e5f1d=a35_0x550295,_0x43ce20=new Map(),_0x459991=new Date(_0x5778fa);while(_0x459991<=_0x64953b){const _0x5be344=_0x459991['toISOString']()['split']('T')[0x0];_0x43ce20[_0x1e5f1d(0x20c)](_0x5be344,{'revenue':0x0,'count':0x0}),_0x459991['setDate'](_0x459991[_0x1e5f1d(0x237)]()+0x1);}let _0x552779=0x0,_0x48f4b5=0x0;for(const _0x7b8172 of _0x16d246){const _0x288ca5=_0x7b8172[_0x1e5f1d(0x163)][_0x1e5f1d(0x229)]()[_0x1e5f1d(0x1b3)]('T')[0x0],_0x49ceaa=_0x43ce20[_0x1e5f1d(0x1e8)](_0x288ca5);if(_0x49ceaa){_0x49ceaa[_0x1e5f1d(0x1c4)]+=0x1;if(_0x7b8172['status']===_0x1e5f1d(0x228)){_0x552779++;if(_0x7b8172[_0x1e5f1d(0x24e)])_0x49ceaa[_0x1e5f1d(0x184)]+=_0x7b8172['amountUSDT'],_0x48f4b5+=_0x7b8172['amountUSDT'],console['log'](_0x1e5f1d(0x23f)+_0x7b8172[_0x1e5f1d(0x24e)]+_0x1e5f1d(0x1c6)+_0x288ca5+'\x20(direct\x20amountUSDT)');else try{const _0x3272ab=await currencyService_1[_0x1e5f1d(0x1ea)][_0x1e5f1d(0x1ab)](_0x7b8172['amount'],_0x7b8172[_0x1e5f1d(0x159)]);_0x49ceaa[_0x1e5f1d(0x184)]+=_0x3272ab,_0x48f4b5+=_0x3272ab,console[_0x1e5f1d(0x1bc)](_0x1e5f1d(0x224)+_0x7b8172[_0x1e5f1d(0x21e)]+'\x20'+_0x7b8172[_0x1e5f1d(0x159)]+_0x1e5f1d(0x1ff)+_0x3272ab+'\x20USDT\x20for\x20payment\x20on\x20'+_0x288ca5);}catch(_0x5517d7){console['warn'](_0x1e5f1d(0x1db)+_0x7b8172[_0x1e5f1d(0x21e)]+'\x20'+_0x7b8172[_0x1e5f1d(0x159)]+_0x1e5f1d(0x1d5)+_0x288ca5+':',_0x5517d7);}}}}console[_0x1e5f1d(0x1bc)](_0x1e5f1d(0x1c0)+_0x552779+_0x1e5f1d(0x14e)+_0x16d246[_0x1e5f1d(0x240)]+'\x20total'),console['log'](_0x1e5f1d(0x1be)+_0x48f4b5+'\x20USDT');const _0x4abab2=[],_0x37c1b9=[];for(const [_0x3cc91e,_0x14b550]of _0x43ce20){_0x4abab2['push']({'date':_0x3cc91e,'amount':Math['round'](_0x14b550['revenue']*0x64)/0x64}),_0x37c1b9[_0x1e5f1d(0x194)]({'date':_0x3cc91e,'count':_0x14b550[_0x1e5f1d(0x1c4)]});}return{'dailyRevenue':_0x4abab2,'dailyPayments':_0x37c1b9};}async[a35_0x550295(0x1bf)](_0x2d17f5){const _0x5b963e=a35_0x550295;console['log'](_0x5b963e(0x170),_0x2d17f5);let _0xdc699b,_0x19ba70=new Date();if(_0x2d17f5[_0x5b963e(0x1d6)]===_0x5b963e(0x1de)&&_0x2d17f5['dateFrom']&&_0x2d17f5[_0x5b963e(0x175)])_0xdc699b=new Date(_0x2d17f5[_0x5b963e(0x1bd)]),_0x19ba70=new Date(_0x2d17f5[_0x5b963e(0x175)]);else{const _0x2d5578=new Date();switch(_0x2d17f5[_0x5b963e(0x1d6)]){case _0x5b963e(0x1b6):_0xdc699b=new Date(_0x2d5578[_0x5b963e(0x1c5)]()-0x7*0x18*0x3c*0x3c*0x3e8);break;case'month':_0xdc699b=new Date(_0x2d5578[_0x5b963e(0x1c5)]()-0x1e*0x18*0x3c*0x3c*0x3e8);break;case _0x5b963e(0x1df):_0xdc699b=new Date(_0x2d5578['getTime']()-0x16d*0x18*0x3c*0x3c*0x3e8);break;case _0x5b963e(0x22e):default:_0xdc699b=new Date(_0x5b963e(0x1c8));break;}}console[_0x5b963e(0x1bc)](_0x5b963e(0x19a)+_0xdc699b['toISOString']()+_0x5b963e(0x1ff)+_0x19ba70[_0x5b963e(0x229)]());if(_0x2d17f5['shopId']){const _0x2f2a09=await database_1['default'][_0x5b963e(0x249)]['findUnique']({'where':{'id':_0x2d17f5['shopId']},'select':{'id':!![],'name':!![],'username':!![],'gatewaySettings':!![]}});console[_0x5b963e(0x1bc)]('üìä\x20Shop\x20info\x20for\x20'+_0x2d17f5[_0x5b963e(0x1a0)]+':'),console[_0x5b963e(0x1bc)](_0x5b963e(0x1ca)+_0x2f2a09?.['name']),console[_0x5b963e(0x1bc)]('\x20\x20\x20Username:\x20'+_0x2f2a09?.[_0x5b963e(0x206)]),console[_0x5b963e(0x1bc)](_0x5b963e(0x198)+(_0x2f2a09?.['gatewaySettings']||_0x5b963e(0x217)));if(_0x2f2a09?.[_0x5b963e(0x1a4)])try{const _0xf42f32=JSON['parse'](_0x2f2a09['gatewaySettings']);console['log']('\x20\x20\x20Parsed\x20gatewaySettings:',_0xf42f32),console['log']('\x20\x20\x20Commission\x20from\x20shop\x20settings:\x20'+(_0xf42f32[_0x5b963e(0x1f1)]||_0x5b963e(0x1ae)));}catch(_0x4f6e61){console[_0x5b963e(0x1bc)]('\x20\x20\x20Failed\x20to\x20parse\x20gatewaySettings:\x20'+_0x4f6e61);}}const _0x104f17={'status':_0x5b963e(0x228),'gateway':{'not':'test_gateway'},'paidAt':{'gte':_0xdc699b,'lte':_0x19ba70}};_0x2d17f5['shopId']&&(_0x104f17[_0x5b963e(0x1a0)]=_0x2d17f5[_0x5b963e(0x1a0)]);const _0x3eda88=await database_1[_0x5b963e(0x15d)][_0x5b963e(0x15b)][_0x5b963e(0x18c)]({'where':_0x104f17,'include':{'shop':{'select':{'id':!![],'name':!![],'username':!![],'gatewaySettings':!![]}}}});console[_0x5b963e(0x1bc)](_0x5b963e(0x212)+_0x3eda88['length']+_0x5b963e(0x200));const _0xa89b16={'gateway':{'not':_0x5b963e(0x1cd)},'createdAt':{'gte':_0xdc699b,'lte':_0x19ba70}};_0x2d17f5[_0x5b963e(0x1a0)]&&(_0xa89b16[_0x5b963e(0x1a0)]=_0x2d17f5['shopId']);const _0x8ebd1d=await database_1[_0x5b963e(0x15d)][_0x5b963e(0x15b)][_0x5b963e(0x1c4)]({'where':_0xa89b16});console[_0x5b963e(0x1bc)]('üìä\x20Total\x20payments\x20(all\x20statuses):\x20'+_0x8ebd1d),console[_0x5b963e(0x1bc)](_0x5b963e(0x1fb)+_0x3eda88[_0x5b963e(0x240)]);let _0x2bcf17=0x0,_0x3e83c1=0x0,_0x13e453=0x0;const _0x33a8e5={},_0x477dac={},_0x789122={};for(const _0x13621c of _0x3eda88){try{const _0x54a56a=await currencyService_1[_0x5b963e(0x1ea)][_0x5b963e(0x1ab)](_0x13621c[_0x5b963e(0x21e)],_0x13621c['currency']);let _0x455c98={};if(_0x13621c[_0x5b963e(0x249)][_0x5b963e(0x1a4)])try{_0x455c98=JSON[_0x5b963e(0x22d)](_0x13621c['shop']['gatewaySettings']);}catch(_0x478450){console[_0x5b963e(0x231)](_0x5b963e(0x1f7)+_0x13621c['shopId']+':',_0x478450);}let _0x5557bd=0xa;const _0x263af8=Object[_0x5b963e(0x220)](_0x455c98)[_0x5b963e(0x202)](_0x5119c7=>_0x5119c7[_0x5b963e(0x183)]()===_0x13621c[_0x5b963e(0x14f)][_0x5b963e(0x183)]());_0x263af8&&_0x455c98[_0x263af8]&&_0x455c98[_0x263af8][_0x5b963e(0x1f1)]&&(_0x5557bd=_0x455c98[_0x263af8][_0x5b963e(0x1f1)]);console['log'](_0x5b963e(0x16c)+_0x13621c['id']+_0x5b963e(0x21c)),console['log'](_0x5b963e(0x1e4)+_0x13621c[_0x5b963e(0x249)][_0x5b963e(0x190)]+'\x20('+_0x13621c['shopId']+')'),console[_0x5b963e(0x1bc)](_0x5b963e(0x223)+_0x13621c[_0x5b963e(0x14f)]),console[_0x5b963e(0x1bc)](_0x5b963e(0x198)+(_0x13621c[_0x5b963e(0x249)][_0x5b963e(0x1a4)]||_0x5b963e(0x217))),console[_0x5b963e(0x1bc)](_0x5b963e(0x1fa),_0x455c98),console[_0x5b963e(0x1bc)](_0x5b963e(0x177)+(_0x263af8||_0x5b963e(0x1ae))),console[_0x5b963e(0x1bc)]('\x20\x20\x20Commission\x20from\x20settings:\x20'+(_0x263af8&&_0x455c98[_0x263af8]?_0x455c98[_0x263af8][_0x5b963e(0x1f1)]:_0x5b963e(0x1ae))),console['log'](_0x5b963e(0x1c9)+_0x5557bd+'%');const _0x2a94c3=_0x54a56a*(_0x5557bd/0x64),_0x2f8993=_0x54a56a-_0x2a94c3;_0x2bcf17+=_0x54a56a,_0x3e83c1+=_0x2f8993,_0x13e453+=_0x2a94c3;!_0x33a8e5[_0x13621c['gateway']]&&(_0x33a8e5[_0x13621c[_0x5b963e(0x14f)]]={'gateway':_0x13621c[_0x5b963e(0x14f)],'gatewayDisplayName':this[_0x5b963e(0x20d)](_0x13621c['gateway']),'paymentsCount':0x0,'turnoverUSDT':0x0,'commissionUSDT':0x0,'merchantEarningsUSDT':0x0,'totalCommissionRate':0x0});_0x33a8e5[_0x13621c[_0x5b963e(0x14f)]][_0x5b963e(0x16d)]++,_0x33a8e5[_0x13621c['gateway']][_0x5b963e(0x1a8)]+=_0x54a56a,_0x33a8e5[_0x13621c[_0x5b963e(0x14f)]][_0x5b963e(0x1fd)]+=_0x2a94c3,_0x33a8e5[_0x13621c[_0x5b963e(0x14f)]]['merchantEarningsUSDT']+=_0x2f8993,_0x33a8e5[_0x13621c[_0x5b963e(0x14f)]][_0x5b963e(0x15c)]+=_0x5557bd;!_0x2d17f5['shopId']&&(!_0x477dac[_0x13621c['shopId']]&&(_0x477dac[_0x13621c[_0x5b963e(0x1a0)]]={'shopId':_0x13621c[_0x5b963e(0x1a0)],'shopName':_0x13621c[_0x5b963e(0x249)][_0x5b963e(0x190)],'shopUsername':_0x13621c[_0x5b963e(0x249)][_0x5b963e(0x206)],'paymentsCount':0x0,'turnoverUSDT':0x0,'commissionUSDT':0x0,'merchantEarningsUSDT':0x0,'paidOutUSDT':0x0,'averageCheckUSDT':0x0}),_0x477dac[_0x13621c['shopId']]['paymentsCount']++,_0x477dac[_0x13621c[_0x5b963e(0x1a0)]][_0x5b963e(0x1a8)]+=_0x54a56a,_0x477dac[_0x13621c['shopId']]['commissionUSDT']+=_0x2a94c3,_0x477dac[_0x13621c[_0x5b963e(0x1a0)]][_0x5b963e(0x222)]+=_0x2f8993);const _0x946c96=_0x13621c[_0x5b963e(0x227)][_0x5b963e(0x229)]()[_0x5b963e(0x1b3)]('T')[0x0];!_0x789122[_0x946c96]&&(_0x789122[_0x946c96]={'date':_0x946c96,'turnover':0x0,'merchantEarnings':0x0,'gatewayEarnings':0x0,'paymentsCount':0x0}),_0x789122[_0x946c96][_0x5b963e(0x219)]+=_0x54a56a,_0x789122[_0x946c96][_0x5b963e(0x230)]+=_0x2f8993,_0x789122[_0x946c96][_0x5b963e(0x24a)]+=_0x2a94c3,_0x789122[_0x946c96][_0x5b963e(0x16d)]++;}catch(_0x15e5ba){console[_0x5b963e(0x231)](_0x5b963e(0x21a)+_0x13621c['id']+':',_0x15e5ba);}}Object[_0x5b963e(0x201)](_0x33a8e5)[_0x5b963e(0x171)](_0x2949f6=>{const _0x96ee11=_0x5b963e;_0x2949f6['averageCommissionRate']=_0x2949f6[_0x96ee11(0x16d)]>0x0?_0x2949f6[_0x96ee11(0x15c)]/_0x2949f6[_0x96ee11(0x16d)]:0x0,delete _0x2949f6['totalCommissionRate'];}),Object[_0x5b963e(0x201)](_0x477dac)['forEach'](_0x517610=>{const _0x3cdc69=_0x5b963e;_0x517610[_0x3cdc69(0x19e)]=_0x517610[_0x3cdc69(0x16d)]>0x0?_0x517610[_0x3cdc69(0x1a8)]/_0x517610['paymentsCount']:0x0;});let _0x34a4c4=0x0;if(_0x2d17f5[_0x5b963e(0x1a0)]){const _0x5e8def=await database_1[_0x5b963e(0x15d)][_0x5b963e(0x20b)][_0x5b963e(0x18c)]({'where':{'shopId':_0x2d17f5[_0x5b963e(0x1a0)],'status':_0x5b963e(0x18b),'createdAt':{'gte':_0xdc699b,'lte':_0x19ba70}},'select':{'amount':!![]}});_0x34a4c4=_0x5e8def[_0x5b963e(0x207)]((_0x7287a4,_0x2c95a7)=>_0x7287a4+_0x2c95a7[_0x5b963e(0x21e)],0x0);}const _0x48b164=_0x8ebd1d,_0x351910=_0x3eda88[_0x5b963e(0x240)],_0x459055=_0x351910>0x0?_0x2bcf17/_0x351910:0x0,_0x337f72=_0x48b164>0x0?_0x351910/_0x48b164*0x64:0x0;console[_0x5b963e(0x1bc)](_0x5b963e(0x24d)),console[_0x5b963e(0x1bc)]('\x20\x20\x20Total\x20payments:\x20'+_0x48b164),console['log']('\x20\x20\x20Successful\x20payments:\x20'+_0x351910),console['log']('\x20\x20\x20Conversion\x20rate:\x20'+_0x337f72[_0x5b963e(0x1e5)](0x2)+'%');const _0x33f1f5=Math['ceil']((_0x19ba70[_0x5b963e(0x1c5)]()-_0xdc699b[_0x5b963e(0x1c5)]())/(0x3e8*0x3c*0x3c*0x18)),_0x54be70={'totalTurnover':Math[_0x5b963e(0x1a7)](_0x2bcf17*0x64)/0x64,'merchantEarnings':Math[_0x5b963e(0x1a7)](_0x3e83c1*0x64)/0x64,'gatewayEarnings':Math[_0x5b963e(0x1a7)](_0x13e453*0x64)/0x64,'totalPaidOut':Math[_0x5b963e(0x1a7)](_0x34a4c4*0x64)/0x64,'averageCheck':Math['round'](_0x459055*0x64)/0x64,'totalPayments':_0x48b164,'successfulPayments':_0x351910,'conversionRate':Math[_0x5b963e(0x1a7)](_0x337f72*0x64)/0x64,'gatewayBreakdown':Object[_0x5b963e(0x201)](_0x33a8e5)[_0x5b963e(0x23e)](_0x386745=>({..._0x386745,'turnoverUSDT':Math[_0x5b963e(0x1a7)](_0x386745[_0x5b963e(0x1a8)]*0x64)/0x64,'commissionUSDT':Math['round'](_0x386745['commissionUSDT']*0x64)/0x64,'merchantEarningsUSDT':Math['round'](_0x386745[_0x5b963e(0x222)]*0x64)/0x64,'averageCommissionRate':Math[_0x5b963e(0x1a7)](_0x386745[_0x5b963e(0x1e2)]*0x64)/0x64})),'merchantBreakdown':_0x2d17f5[_0x5b963e(0x1a0)]?undefined:Object[_0x5b963e(0x201)](_0x477dac)[_0x5b963e(0x23e)](_0xdd6320=>({..._0xdd6320,'turnoverUSDT':Math[_0x5b963e(0x1a7)](_0xdd6320['turnoverUSDT']*0x64)/0x64,'commissionUSDT':Math['round'](_0xdd6320['commissionUSDT']*0x64)/0x64,'merchantEarningsUSDT':Math[_0x5b963e(0x1a7)](_0xdd6320[_0x5b963e(0x222)]*0x64)/0x64,'paidOutUSDT':Math['round'](_0xdd6320[_0x5b963e(0x1e3)]*0x64)/0x64,'averageCheckUSDT':Math[_0x5b963e(0x1a7)](_0xdd6320[_0x5b963e(0x19e)]*0x64)/0x64})),'dailyData':Object['values'](_0x789122)['map'](_0xb1a2fc=>({..._0xb1a2fc,'turnover':Math[_0x5b963e(0x1a7)](_0xb1a2fc['turnover']*0x64)/0x64,'merchantEarnings':Math[_0x5b963e(0x1a7)](_0xb1a2fc['merchantEarnings']*0x64)/0x64,'gatewayEarnings':Math['round'](_0xb1a2fc['gatewayEarnings']*0x64)/0x64}))['sort']((_0x1223f3,_0x183759)=>_0x1223f3[_0x5b963e(0x1e7)][_0x5b963e(0x191)](_0x183759['date'])),'periodInfo':{'from':_0xdc699b,'to':_0x19ba70,'periodType':_0x2d17f5[_0x5b963e(0x1d6)]||_0x5b963e(0x1de),'daysCount':_0x33f1f5}};return console[_0x5b963e(0x1bc)](_0x5b963e(0x164)),console[_0x5b963e(0x1bc)]('\x20\x20\x20üí∞\x20Total\x20turnover:\x20'+_0x54be70[_0x5b963e(0x1ac)]+_0x5b963e(0x246)),console['log'](_0x5b963e(0x196)+_0x54be70[_0x5b963e(0x230)]+_0x5b963e(0x246)),console[_0x5b963e(0x1bc)](_0x5b963e(0x24f)+_0x54be70['gatewayEarnings']+'\x20USDT'),console[_0x5b963e(0x1bc)](_0x5b963e(0x23c)+_0x54be70[_0x5b963e(0x180)]),console[_0x5b963e(0x1bc)](_0x5b963e(0x155)+_0x54be70['successfulPayments']),console[_0x5b963e(0x1bc)](_0x5b963e(0x23d)+_0x54be70['conversionRate']+'%'),_0x54be70;}[a35_0x550295(0x20d)](_0x3dd6e7){const _0x48cdd5=a35_0x550295,_0x11fbd6={'test_gateway':_0x48cdd5(0x1bb),'plisio':_0x48cdd5(0x178),'rapyd':_0x48cdd5(0x1af),'noda':_0x48cdd5(0x21b),'cointopay':_0x48cdd5(0x160),'klyme_eu':'KLYME\x20EU','klyme_gb':'KLYME\x20GB','klyme_de':_0x48cdd5(0x251)};return _0x11fbd6[_0x3dd6e7]||_0x3dd6e7;}async[a35_0x550295(0x1d9)](_0x4eaaa1){const _0x1a6cad=a35_0x550295,{page:_0x5b3904,limit:_0x103a21,minAmount:_0x2161cf,search:_0x156822}=_0x4eaaa1,_0x56fc35=(_0x5b3904-0x1)*_0x103a21;console[_0x1a6cad(0x1bc)](_0x1a6cad(0x1f6),_0x4eaaa1);const _0x34d1c6={'balance':{'gt':0x0},'status':_0x1a6cad(0x17d)};_0x2161cf&&(_0x34d1c6[_0x1a6cad(0x15e)][_0x1a6cad(0x213)]=_0x2161cf);_0x156822&&(_0x34d1c6['OR']=[{'name':{'contains':_0x156822,'mode':_0x1a6cad(0x1da)}},{'username':{'contains':_0x156822,'mode':_0x1a6cad(0x1da)}}]);const [_0x5394c6,_0x25c8cb]=await Promise['all']([database_1['default']['shop'][_0x1a6cad(0x18c)]({'where':_0x34d1c6,'skip':_0x56fc35,'take':_0x103a21,'orderBy':{'balance':'desc'},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'balance':!![],'totalPaidOut':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'createdAt':!![]}}),database_1['default'][_0x1a6cad(0x249)][_0x1a6cad(0x1c4)]({'where':_0x34d1c6})]);console[_0x1a6cad(0x1bc)]('üí∞\x20Found\x20'+_0x5394c6['length']+_0x1a6cad(0x16f));const _0x2f1e4f=await Promise[_0x1a6cad(0x22e)](_0x5394c6[_0x1a6cad(0x23e)](async _0x311514=>{const _0x51bfd9=_0x1a6cad,[_0x512e36,_0x3f24f0,_0x512624]=await Promise[_0x51bfd9(0x22e)]([database_1['default'][_0x51bfd9(0x15b)][_0x51bfd9(0x1c4)]({'where':{'shopId':_0x311514['id'],'status':'PAID','amountUSDT':{'not':null}}}),database_1['default'][_0x51bfd9(0x15b)][_0x51bfd9(0x225)]({'where':{'shopId':_0x311514['id'],'status':_0x51bfd9(0x228),'amountUSDT':{'not':null}},'orderBy':{'paidAt':_0x51bfd9(0x1a9)},'select':{'paidAt':!![]}}),database_1['default']['payment'][_0x51bfd9(0x1dc)]({'by':[_0x51bfd9(0x14f)],'where':{'shopId':_0x311514['id'],'status':'PAID','amountUSDT':{'not':null}},'_count':{'id':!![]},'_sum':{'amountUSDT':!![]}})]),_0x5762d6=_0x512624[_0x51bfd9(0x23e)](_0x35f53c=>({'gateway':_0x35f53c[_0x51bfd9(0x14f)],'count':_0x35f53c[_0x51bfd9(0x250)]['id'],'amountUSDT':_0x35f53c['_sum'][_0x51bfd9(0x24e)]||0x0,'amountAfterCommissionUSDT':_0x35f53c[_0x51bfd9(0x150)][_0x51bfd9(0x24e)]||0x0,'commission':0x0}));return{'id':_0x311514['id'],'fullName':_0x311514['name'],'username':_0x311514['username'],'telegramId':_0x311514[_0x51bfd9(0x185)],'merchantUrl':_0x311514['shopUrl'],'wallets':{'usdtPolygonWallet':_0x311514[_0x51bfd9(0x1ad)],'usdtTrcWallet':_0x311514[_0x51bfd9(0x15f)],'usdtErcWallet':_0x311514[_0x51bfd9(0x1f2)],'usdcPolygonWallet':_0x311514[_0x51bfd9(0x1b0)]},'totalAmountUSDT':_0x311514[_0x51bfd9(0x15e)],'totalAmountAfterCommissionUSDT':_0x311514[_0x51bfd9(0x15e)],'paymentsCount':_0x512e36,'oldestPaymentDate':_0x3f24f0?.['paidAt']||_0x311514['createdAt'],'gatewayBreakdown':_0x5762d6};})),_0x4643a0=_0x5394c6[_0x1a6cad(0x207)]((_0x290e14,_0x5e6892)=>_0x290e14+_0x5e6892[_0x1a6cad(0x15e)],0x0),_0x10ee28=_0x4643a0;return console[_0x1a6cad(0x1bc)]('üìä\x20Merchants\x20awaiting\x20payout:\x20'+_0x25c8cb+_0x1a6cad(0x1a5)+Math[_0x1a6cad(0x1a7)](_0x10ee28*0x64)/0x64+_0x1a6cad(0x252)),{'merchants':_0x2f1e4f,'pagination':{'page':_0x5b3904,'limit':_0x103a21,'total':_0x25c8cb,'totalPages':Math[_0x1a6cad(0x16e)](_0x25c8cb/_0x103a21)},'summary':{'totalMerchants':_0x25c8cb,'totalAmountUSDT':Math[_0x1a6cad(0x1a7)](_0x4643a0*0x64)/0x64,'totalAmountAfterCommissionUSDT':Math[_0x1a6cad(0x1a7)](_0x10ee28*0x64)/0x64}};}async['createPayout'](_0x479162){const _0x1cf0f5=a35_0x550295,{shopId:_0x556648,amount:_0x44d54e,network:_0x557a31,notes:_0x2bcd36,periodFrom:_0x5c9990,periodTo:_0x549ead}=_0x479162,_0x172edd=await database_1['default']['$transaction'](async _0x53a55b=>{const _0x54db96=a35_0x4df7,_0x56aa46=await _0x53a55b['shop']['findUnique']({'where':{'id':_0x556648},'select':{'id':!![],'name':!![],'username':!![],'balance':!![],'totalPaidOut':!![]}});if(!_0x56aa46)throw new Error('Shop\x20not\x20found');console['log'](_0x54db96(0x1ce)+_0x56aa46[_0x54db96(0x206)]+':'),console['log'](_0x54db96(0x1b1)+_0x56aa46[_0x54db96(0x15e)][_0x54db96(0x1e5)](0x6)+_0x54db96(0x246)),console[_0x54db96(0x1bc)](_0x54db96(0x167)+_0x44d54e[_0x54db96(0x1e5)](0x6)+_0x54db96(0x246)),console['log'](_0x54db96(0x189)+_0x56aa46[_0x54db96(0x1f5)][_0x54db96(0x1e5)](0x6)+_0x54db96(0x246));if(_0x56aa46[_0x54db96(0x15e)]<_0x44d54e)throw new Error(_0x54db96(0x1eb)+_0x56aa46[_0x54db96(0x15e)]['toFixed'](0x6)+_0x54db96(0x1c1)+_0x44d54e['toFixed'](0x6)+_0x54db96(0x246));const _0x146d48=await _0x53a55b[_0x54db96(0x20b)][_0x54db96(0x1f3)]({'data':{'shopId':_0x556648,'amount':_0x44d54e,'network':_0x557a31,'status':_0x54db96(0x18b),'notes':_0x2bcd36,'periodFrom':_0x5c9990?new Date(_0x5c9990):null,'periodTo':_0x549ead?new Date(_0x549ead):null,'createdAt':new Date(),'paidAt':new Date()}}),_0x3f4f77=_0x56aa46[_0x54db96(0x15e)]-_0x44d54e,_0x1510c3=_0x56aa46[_0x54db96(0x1f5)]+_0x44d54e;return await _0x53a55b[_0x54db96(0x249)][_0x54db96(0x168)]({'where':{'id':_0x556648},'data':{'balance':_0x3f4f77,'totalPaidOut':_0x1510c3}}),console['log'](_0x54db96(0x205)+_0x56aa46[_0x54db96(0x206)]+_0x54db96(0x1c7)),console[_0x54db96(0x1bc)](_0x54db96(0x1e0)+_0x56aa46[_0x54db96(0x15e)][_0x54db96(0x1e5)](0x6)+_0x54db96(0x1d0)+_0x3f4f77['toFixed'](0x6)+_0x54db96(0x151)+_0x44d54e[_0x54db96(0x1e5)](0x6)+')'),console[_0x54db96(0x1bc)](_0x54db96(0x1d3)+_0x56aa46[_0x54db96(0x1f5)][_0x54db96(0x1e5)](0x6)+_0x54db96(0x1d0)+_0x1510c3[_0x54db96(0x1e5)](0x6)+_0x54db96(0x1d8)+_0x44d54e['toFixed'](0x6)+')'),{'payout':_0x146d48,'shop':_0x56aa46};});return console[_0x1cf0f5(0x1bc)]('‚úÖ\x20Payout\x20created:\x20'+_0x172edd['payout']['id']+'\x20for\x20shop\x20'+_0x172edd[_0x1cf0f5(0x249)]['username']+'\x20('+_0x44d54e+'\x20USDT)'),{'id':_0x172edd[_0x1cf0f5(0x20b)]['id'],'shopId':_0x172edd[_0x1cf0f5(0x20b)][_0x1cf0f5(0x1a0)],'shopName':_0x172edd[_0x1cf0f5(0x249)][_0x1cf0f5(0x190)],'shopUsername':_0x172edd[_0x1cf0f5(0x249)]['username'],'amount':_0x172edd['payout'][_0x1cf0f5(0x21e)],'network':_0x172edd[_0x1cf0f5(0x20b)]['network'],'status':_0x172edd['payout'][_0x1cf0f5(0x1ec)],'txid':_0x172edd[_0x1cf0f5(0x20b)]['txid'],'notes':_0x172edd[_0x1cf0f5(0x20b)][_0x1cf0f5(0x193)],'periodFrom':_0x172edd[_0x1cf0f5(0x20b)][_0x1cf0f5(0x208)],'periodTo':_0x172edd[_0x1cf0f5(0x20b)][_0x1cf0f5(0x17a)],'createdAt':_0x172edd[_0x1cf0f5(0x20b)]['createdAt'],'paidAt':_0x172edd[_0x1cf0f5(0x20b)][_0x1cf0f5(0x227)]};}async[a35_0x550295(0x1b8)](_0x37e36f){const _0x34c5f7=a35_0x550295,{page:_0x195805,limit:_0x240e5c,shopId:_0x1679f5,network:_0x3087d9,dateFrom:_0x4d3552,dateTo:_0x37d134,search:_0x52b386}=_0x37e36f,_0x416fd5=(_0x195805-0x1)*_0x240e5c,_0x691d79={};_0x1679f5&&(_0x691d79[_0x34c5f7(0x1a0)]=_0x1679f5);_0x3087d9&&(_0x691d79['network']=_0x3087d9);(_0x4d3552||_0x37d134)&&(_0x691d79[_0x34c5f7(0x163)]={},_0x4d3552&&(_0x691d79['createdAt']['gte']=new Date(_0x4d3552)),_0x37d134&&(_0x691d79[_0x34c5f7(0x163)]['lte']=new Date(_0x37d134)));_0x52b386&&(_0x691d79['OR']=[{'shop':{'name':{'contains':_0x52b386,'mode':'insensitive'}}},{'shop':{'username':{'contains':_0x52b386,'mode':_0x34c5f7(0x1da)}}},{'notes':{'contains':_0x52b386,'mode':_0x34c5f7(0x1da)}}]);const [_0x733a4c,_0x3e7c08]=await Promise[_0x34c5f7(0x22e)]([database_1['default'][_0x34c5f7(0x20b)][_0x34c5f7(0x18c)]({'where':_0x691d79,'skip':_0x416fd5,'take':_0x240e5c,'orderBy':{'createdAt':'desc'},'include':{'shop':{'select':{'name':!![],'username':!![]}}}}),database_1[_0x34c5f7(0x15d)][_0x34c5f7(0x20b)][_0x34c5f7(0x1c4)]({'where':_0x691d79})]);return{'payouts':_0x733a4c[_0x34c5f7(0x23e)](_0x25a522=>({'id':_0x25a522['id'],'shopId':_0x25a522[_0x34c5f7(0x1a0)],'shopName':_0x25a522['shop'][_0x34c5f7(0x190)],'shopUsername':_0x25a522[_0x34c5f7(0x249)][_0x34c5f7(0x206)],'amount':_0x25a522[_0x34c5f7(0x21e)],'network':_0x25a522[_0x34c5f7(0x21f)],'status':_0x25a522[_0x34c5f7(0x1ec)],'txid':_0x25a522[_0x34c5f7(0x187)],'notes':_0x25a522[_0x34c5f7(0x193)],'periodFrom':_0x25a522[_0x34c5f7(0x208)],'periodTo':_0x25a522['periodTo'],'createdAt':_0x25a522[_0x34c5f7(0x163)],'paidAt':_0x25a522[_0x34c5f7(0x227)]})),'pagination':{'page':_0x195805,'limit':_0x240e5c,'total':_0x3e7c08,'totalPages':Math[_0x34c5f7(0x16e)](_0x3e7c08/_0x240e5c)}};}async['getPayoutById'](_0x19cc5c){const _0x450cd2=a35_0x550295,_0x1d8587=await database_1[_0x450cd2(0x15d)][_0x450cd2(0x20b)][_0x450cd2(0x1d7)]({'where':{'id':_0x19cc5c},'include':{'shop':{'select':{'name':!![],'username':!![]}}}});if(!_0x1d8587)return null;return{'id':_0x1d8587['id'],'shopId':_0x1d8587[_0x450cd2(0x1a0)],'shopName':_0x1d8587[_0x450cd2(0x249)][_0x450cd2(0x190)],'shopUsername':_0x1d8587[_0x450cd2(0x249)][_0x450cd2(0x206)],'amount':_0x1d8587[_0x450cd2(0x21e)],'network':_0x1d8587['network'],'status':_0x1d8587['status'],'txid':_0x1d8587['txid'],'notes':_0x1d8587[_0x450cd2(0x193)],'periodFrom':_0x1d8587[_0x450cd2(0x208)],'periodTo':_0x1d8587[_0x450cd2(0x17a)],'createdAt':_0x1d8587['createdAt'],'paidAt':_0x1d8587[_0x450cd2(0x227)]};}async['deletePayout'](_0x288957){const _0x1f6b87=a35_0x550295;await database_1[_0x1f6b87(0x15d)][_0x1f6b87(0x20b)][_0x1f6b87(0x15a)]({'where':{'id':_0x288957}});}async[a35_0x550295(0x22c)](_0x5cec25){const _0x4883bd=a35_0x550295,{page:_0x1daf35,limit:_0x4daa99,status:_0x47375f,gateway:_0x512fdb,shopId:_0xfb13c4,dateFrom:_0x3ef8a0,dateTo:_0x32c795,search:_0x2c9327}=_0x5cec25,_0xe92f6f=(_0x1daf35-0x1)*_0x4daa99,_0x114e86={};_0x47375f&&(_0x114e86[_0x4883bd(0x1ec)]=_0x47375f['toUpperCase']());_0x512fdb&&(_0x114e86[_0x4883bd(0x14f)]=_0x512fdb[_0x4883bd(0x183)]());_0x114e86[_0x4883bd(0x14f)]=_0x114e86[_0x4883bd(0x14f)]?_0x114e86[_0x4883bd(0x14f)]:{'not':_0x4883bd(0x1cd)};if(typeof _0x114e86[_0x4883bd(0x14f)]===_0x4883bd(0x19d)&&_0x114e86[_0x4883bd(0x14f)]!==_0x4883bd(0x1cd)){}else{if(typeof _0x114e86[_0x4883bd(0x14f)]===_0x4883bd(0x19d)&&_0x114e86['gateway']==='test_gateway'){}else _0x114e86[_0x4883bd(0x14f)]={'not':_0x4883bd(0x1cd)};}_0xfb13c4&&(_0x114e86[_0x4883bd(0x1a0)]=_0xfb13c4);(_0x3ef8a0||_0x32c795)&&(_0x114e86[_0x4883bd(0x163)]={},_0x3ef8a0&&(_0x114e86[_0x4883bd(0x163)][_0x4883bd(0x213)]=new Date(_0x3ef8a0)),_0x32c795&&(_0x114e86['createdAt'][_0x4883bd(0x16b)]=new Date(_0x32c795)));_0x2c9327&&(_0x114e86['OR']=[{'orderId':{'contains':_0x2c9327,'mode':_0x4883bd(0x1da)}},{'gatewayOrderId':{'contains':_0x2c9327,'mode':'insensitive'}},{'customerEmail':{'contains':_0x2c9327,'mode':_0x4883bd(0x1da)}},{'shop':{'name':{'contains':_0x2c9327,'mode':_0x4883bd(0x1da)}}},{'shop':{'username':{'contains':_0x2c9327,'mode':'insensitive'}}}]);const [_0x3b9ad8,_0x210b21]=await Promise[_0x4883bd(0x22e)]([database_1[_0x4883bd(0x15d)][_0x4883bd(0x15b)][_0x4883bd(0x18c)]({'where':_0x114e86,'skip':_0xe92f6f,'take':_0x4daa99,'orderBy':{'createdAt':_0x4883bd(0x17c)},'include':{'shop':{'select':{'name':!![],'username':!![]}}}}),database_1[_0x4883bd(0x15d)][_0x4883bd(0x15b)]['count']({'where':_0x114e86})]);return{'payments':_0x3b9ad8['map'](_0x42ca4a=>({'id':_0x42ca4a['id'],'shopId':_0x42ca4a['shopId'],'gateway':_0x42ca4a[_0x4883bd(0x14f)],'amount':_0x42ca4a['amount'],'currency':_0x42ca4a[_0x4883bd(0x159)],'status':_0x42ca4a[_0x4883bd(0x1ec)],'orderId':_0x42ca4a[_0x4883bd(0x216)],'gatewayOrderId':_0x42ca4a[_0x4883bd(0x244)],'customerEmail':_0x42ca4a[_0x4883bd(0x234)],'customerName':_0x42ca4a['customerName'],'customerCountry':_0x42ca4a[_0x4883bd(0x238)],'customerIp':_0x42ca4a[_0x4883bd(0x214)],'customerUa':_0x42ca4a[_0x4883bd(0x181)],'failureMessage':_0x42ca4a[_0x4883bd(0x226)],'cardLast4':_0x42ca4a[_0x4883bd(0x211)],'paymentMethod':_0x42ca4a['paymentMethod'],'bankId':_0x42ca4a['bankId'],'remitterIban':_0x42ca4a[_0x4883bd(0x1aa)],'remitterName':_0x42ca4a[_0x4883bd(0x18f)],'txUrls':_0x42ca4a['txUrls'],'createdAt':_0x42ca4a['createdAt'],'updatedAt':_0x42ca4a[_0x4883bd(0x233)],'shop':_0x42ca4a[_0x4883bd(0x249)]})),'pagination':{'page':_0x1daf35,'limit':_0x4daa99,'total':_0x210b21,'totalPages':Math['ceil'](_0x210b21/_0x4daa99)}};}async[a35_0x550295(0x176)](_0x3acbe9){const _0x5c89ed=a35_0x550295,_0x2e9b9b=await database_1['default'][_0x5c89ed(0x15b)][_0x5c89ed(0x1d7)]({'where':{'id':_0x3acbe9},'include':{'shop':{'select':{'name':!![],'username':!![]}}}});if(!_0x2e9b9b)return null;return{'id':_0x2e9b9b['id'],'shopId':_0x2e9b9b[_0x5c89ed(0x1a0)],'gateway':_0x2e9b9b[_0x5c89ed(0x14f)],'amount':_0x2e9b9b[_0x5c89ed(0x21e)],'currency':_0x2e9b9b[_0x5c89ed(0x159)],'status':_0x2e9b9b[_0x5c89ed(0x1ec)],'orderId':_0x2e9b9b[_0x5c89ed(0x216)],'gatewayOrderId':_0x2e9b9b[_0x5c89ed(0x244)],'customerEmail':_0x2e9b9b[_0x5c89ed(0x234)],'customerName':_0x2e9b9b[_0x5c89ed(0x17b)],'customerCountry':_0x2e9b9b[_0x5c89ed(0x238)],'customerIp':_0x2e9b9b[_0x5c89ed(0x214)],'customerUa':_0x2e9b9b[_0x5c89ed(0x181)],'failureMessage':_0x2e9b9b['failureMessage'],'externalPaymentUrl':_0x2e9b9b[_0x5c89ed(0x236)],'successUrl':_0x2e9b9b[_0x5c89ed(0x1f0)],'failUrl':_0x2e9b9b[_0x5c89ed(0x243)],'pendingUrl':_0x2e9b9b[_0x5c89ed(0x197)],'whiteUrl':_0x2e9b9b[_0x5c89ed(0x1e6)],'cardLast4':_0x2e9b9b[_0x5c89ed(0x211)],'paymentMethod':_0x2e9b9b[_0x5c89ed(0x157)],'bankId':_0x2e9b9b[_0x5c89ed(0x169)],'remitterIban':_0x2e9b9b[_0x5c89ed(0x1aa)],'remitterName':_0x2e9b9b['remitterName'],'txUrls':_0x2e9b9b['txUrls'],'createdAt':_0x2e9b9b[_0x5c89ed(0x163)],'updatedAt':_0x2e9b9b[_0x5c89ed(0x233)],'shop':_0x2e9b9b[_0x5c89ed(0x249)]};}async[a35_0x550295(0x1cf)](_0x4f9269,_0x5e1a5f,_0x175040,_0x4029a0){const _0x3c0a36=a35_0x550295,_0x373eaa=await database_1[_0x3c0a36(0x15d)][_0x3c0a36(0x20e)](async _0x67bc6a=>{const _0x40dfba=_0x3c0a36,_0x1515c6=await _0x67bc6a[_0x40dfba(0x15b)][_0x40dfba(0x1d7)]({'where':{'id':_0x4f9269},'include':{'shop':{'select':{'id':!![],'name':!![],'username':!![],'balance':!![]}}}});if(!_0x1515c6)throw new Error('Payment\x20not\x20found');const _0x5f2cac=_0x1515c6[_0x40dfba(0x1ec)],_0x45197a=_0x5e1a5f[_0x40dfba(0x24b)]();console[_0x40dfba(0x1bc)](_0x40dfba(0x221)+_0x4f9269+'\x20status:\x20'+_0x5f2cac+_0x40dfba(0x1d0)+_0x45197a),console[_0x40dfba(0x1bc)](_0x40dfba(0x23a)+_0x1515c6[_0x40dfba(0x249)][_0x40dfba(0x15e)]+'\x20USDT');const _0x2af4a8={'status':_0x45197a,'updatedAt':new Date(),'statusChangedBy':'admin','statusChangedAt':new Date()};_0x175040&&(_0x2af4a8['adminNotes']=_0x175040);_0x45197a===_0x40dfba(0x245)&&_0x4029a0&&(_0x2af4a8[_0x40dfba(0x153)]=_0x4029a0);let _0x4d1b2c=0x0,_0x2a7b50=_0x1515c6[_0x40dfba(0x249)]['balance'];if(_0x45197a==='PAID'&&_0x5f2cac!=='PAID'){_0x2af4a8[_0x40dfba(0x227)]=new Date();const _0x50dbe1=await currencyService_1[_0x40dfba(0x1ea)]['convertToUSDT'](_0x1515c6[_0x40dfba(0x21e)],_0x1515c6[_0x40dfba(0x159)]);_0x2af4a8[_0x40dfba(0x24e)]=_0x50dbe1,_0x4d1b2c=_0x50dbe1,_0x2a7b50+=_0x50dbe1,console[_0x40dfba(0x1bc)](_0x40dfba(0x152)+_0x4f9269+_0x40dfba(0x247)+_0x50dbe1['toFixed'](0x6)+_0x40dfba(0x239));}else _0x5f2cac==='PAID'&&_0x45197a!==_0x40dfba(0x228)&&(_0x1515c6[_0x40dfba(0x24e)]&&(_0x4d1b2c=-_0x1515c6['amountUSDT'],_0x2a7b50-=_0x1515c6['amountUSDT'],_0x2af4a8[_0x40dfba(0x24e)]=null,console[_0x40dfba(0x1bc)](_0x40dfba(0x152)+_0x4f9269+_0x40dfba(0x154)+_0x1515c6[_0x40dfba(0x24e)][_0x40dfba(0x1e5)](0x6)+_0x40dfba(0x17f))));if(_0x45197a===_0x40dfba(0x245)){if(_0x5f2cac==='PAID'&&_0x1515c6[_0x40dfba(0x24e)]){}_0x4029a0&&_0x4029a0>0x0&&(_0x4d1b2c-=_0x4029a0,_0x2a7b50-=_0x4029a0,console[_0x40dfba(0x1bc)](_0x40dfba(0x22a)+_0x4029a0[_0x40dfba(0x1e5)](0x6)+_0x40dfba(0x17f)));}_0x45197a===_0x40dfba(0x235)&&_0x5f2cac===_0x40dfba(0x228)&&console[_0x40dfba(0x1bc)](_0x40dfba(0x21d));const _0x48807b=await _0x67bc6a[_0x40dfba(0x15b)]['update']({'where':{'id':_0x4f9269},'data':_0x2af4a8,'include':{'shop':{'select':{'name':!![],'username':!![]}}}});return _0x4d1b2c!==0x0&&(await _0x67bc6a[_0x40dfba(0x249)]['update']({'where':{'id':_0x1515c6['shopId']},'data':{'balance':_0x2a7b50}}),console[_0x40dfba(0x1bc)](_0x40dfba(0x205)+_0x1515c6[_0x40dfba(0x1a0)]+_0x40dfba(0x16a)+_0x1515c6[_0x40dfba(0x249)][_0x40dfba(0x15e)][_0x40dfba(0x1e5)](0x6)+'\x20->\x20'+_0x2a7b50[_0x40dfba(0x1e5)](0x6)+_0x40dfba(0x199)+(_0x4d1b2c>0x0?'+':'')+_0x4d1b2c['toFixed'](0x6)+')')),_0x48807b;});return{'id':_0x373eaa['id'],'shopId':_0x373eaa[_0x3c0a36(0x1a0)],'gateway':_0x373eaa['gateway'],'amount':_0x373eaa['amount'],'currency':_0x373eaa[_0x3c0a36(0x159)],'status':_0x373eaa[_0x3c0a36(0x1ec)],'orderId':_0x373eaa[_0x3c0a36(0x216)],'gatewayOrderId':_0x373eaa[_0x3c0a36(0x244)],'customerEmail':_0x373eaa[_0x3c0a36(0x234)],'customerName':_0x373eaa[_0x3c0a36(0x17b)],'customerCountry':_0x373eaa[_0x3c0a36(0x238)],'customerIp':_0x373eaa[_0x3c0a36(0x214)],'customerUa':_0x373eaa[_0x3c0a36(0x181)],'failureMessage':_0x373eaa['failureMessage'],'adminNotes':_0x373eaa[_0x3c0a36(0x1ef)],'chargebackAmount':_0x373eaa['chargebackAmount'],'statusChangedBy':_0x373eaa[_0x3c0a36(0x20f)],'statusChangedAt':_0x373eaa['statusChangedAt'],'createdAt':_0x373eaa[_0x3c0a36(0x163)],'updatedAt':_0x373eaa[_0x3c0a36(0x233)],'shop':_0x373eaa['shop']};}async[a35_0x550295(0x248)](_0x3daa84,_0x421021){const _0x3a960f=a35_0x550295,_0x1c8336={..._0x421021};_0x421021[_0x3a960f(0x215)]&&(_0x1c8336[_0x3a960f(0x215)]=await bcryptjs_1[_0x3a960f(0x15d)]['hash'](_0x421021[_0x3a960f(0x215)],0xc));_0x421021[_0x3a960f(0x18e)]&&(_0x1c8336[_0x3a960f(0x190)]=_0x421021[_0x3a960f(0x18e)],delete _0x1c8336[_0x3a960f(0x18e)]);_0x421021[_0x3a960f(0x173)]&&(_0x1c8336['telegram']=_0x421021[_0x3a960f(0x173)],delete _0x1c8336[_0x3a960f(0x173)]);_0x421021[_0x3a960f(0x1b4)]&&(_0x1c8336['shopUrl']=_0x421021[_0x3a960f(0x1b4)],delete _0x1c8336[_0x3a960f(0x1b4)]);_0x421021[_0x3a960f(0x1a1)]&&(_0x1c8336[_0x3a960f(0x1b5)]=JSON[_0x3a960f(0x158)](_0x421021['gateways']),delete _0x1c8336['gateways']);_0x421021[_0x3a960f(0x1a4)]&&(_0x1c8336[_0x3a960f(0x1a4)]=JSON[_0x3a960f(0x158)](_0x421021[_0x3a960f(0x1a4)]),delete _0x1c8336[_0x3a960f(0x1a4)]);_0x421021['wallets']&&(_0x421021['wallets'][_0x3a960f(0x1ad)]!==undefined&&(_0x1c8336[_0x3a960f(0x1ad)]=_0x421021['wallets'][_0x3a960f(0x1ad)]||null),_0x421021[_0x3a960f(0x1e1)]['usdtTrcWallet']!==undefined&&(_0x1c8336['usdtTrcWallet']=_0x421021[_0x3a960f(0x1e1)]['usdtTrcWallet']||null),_0x421021[_0x3a960f(0x1e1)][_0x3a960f(0x1f2)]!==undefined&&(_0x1c8336[_0x3a960f(0x1f2)]=_0x421021['wallets']['usdtErcWallet']||null),_0x421021[_0x3a960f(0x1e1)]['usdcPolygonWallet']!==undefined&&(_0x1c8336['usdcPolygonWallet']=_0x421021['wallets'][_0x3a960f(0x1b0)]||null),delete _0x1c8336[_0x3a960f(0x1e1)]);const _0x281506=await database_1[_0x3a960f(0x15d)][_0x3a960f(0x249)]['update']({'where':{'id':_0x3daa84},'data':_0x1c8336,'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});return{'id':_0x281506['id'],'fullName':_0x281506[_0x3a960f(0x190)],'username':_0x281506['username'],'telegramId':_0x281506[_0x3a960f(0x185)],'merchantUrl':_0x281506[_0x3a960f(0x1ed)],'gateways':_0x281506[_0x3a960f(0x1b5)]?JSON[_0x3a960f(0x22d)](_0x281506[_0x3a960f(0x1b5)]):null,'gatewaySettings':_0x281506[_0x3a960f(0x1a4)]?JSON[_0x3a960f(0x22d)](_0x281506['gatewaySettings']):null,'publicKey':_0x281506[_0x3a960f(0x19c)],'wallets':{'usdtPolygonWallet':_0x281506[_0x3a960f(0x1ad)],'usdtTrcWallet':_0x281506[_0x3a960f(0x15f)],'usdtErcWallet':_0x281506[_0x3a960f(0x1f2)],'usdcPolygonWallet':_0x281506[_0x3a960f(0x1b0)]},'status':_0x281506[_0x3a960f(0x1ec)],'createdAt':_0x281506[_0x3a960f(0x163)]};}async['suspendUser'](_0x204830){const _0x2e88fc=a35_0x550295,_0x118d1f=await database_1[_0x2e88fc(0x15d)][_0x2e88fc(0x249)][_0x2e88fc(0x168)]({'where':{'id':_0x204830},'data':{'status':_0x2e88fc(0x19b)},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});return{'id':_0x118d1f['id'],'fullName':_0x118d1f[_0x2e88fc(0x190)],'username':_0x118d1f[_0x2e88fc(0x206)],'telegramId':_0x118d1f[_0x2e88fc(0x185)],'merchantUrl':_0x118d1f[_0x2e88fc(0x1ed)],'gateways':_0x118d1f[_0x2e88fc(0x1b5)]?JSON[_0x2e88fc(0x22d)](_0x118d1f[_0x2e88fc(0x1b5)]):null,'gatewaySettings':_0x118d1f[_0x2e88fc(0x1a4)]?JSON[_0x2e88fc(0x22d)](_0x118d1f[_0x2e88fc(0x1a4)]):null,'publicKey':_0x118d1f[_0x2e88fc(0x19c)],'wallets':{'usdtPolygonWallet':_0x118d1f[_0x2e88fc(0x1ad)],'usdtTrcWallet':_0x118d1f[_0x2e88fc(0x15f)],'usdtErcWallet':_0x118d1f[_0x2e88fc(0x1f2)],'usdcPolygonWallet':_0x118d1f[_0x2e88fc(0x1b0)]},'status':_0x118d1f[_0x2e88fc(0x1ec)],'createdAt':_0x118d1f[_0x2e88fc(0x163)]};}async['activateUser'](_0x555dc7){const _0x3e4022=a35_0x550295,_0x3b697f=await database_1['default'][_0x3e4022(0x249)]['update']({'where':{'id':_0x555dc7},'data':{'status':_0x3e4022(0x17d)},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});return{'id':_0x3b697f['id'],'fullName':_0x3b697f[_0x3e4022(0x190)],'username':_0x3b697f[_0x3e4022(0x206)],'telegramId':_0x3b697f['telegram'],'merchantUrl':_0x3b697f[_0x3e4022(0x1ed)],'gateways':_0x3b697f[_0x3e4022(0x1b5)]?JSON[_0x3e4022(0x22d)](_0x3b697f['paymentGateways']):null,'gatewaySettings':_0x3b697f[_0x3e4022(0x1a4)]?JSON['parse'](_0x3b697f[_0x3e4022(0x1a4)]):null,'publicKey':_0x3b697f[_0x3e4022(0x19c)],'wallets':{'usdtPolygonWallet':_0x3b697f[_0x3e4022(0x1ad)],'usdtTrcWallet':_0x3b697f['usdtTrcWallet'],'usdtErcWallet':_0x3b697f[_0x3e4022(0x1f2)],'usdcPolygonWallet':_0x3b697f[_0x3e4022(0x1b0)]},'status':_0x3b697f[_0x3e4022(0x1ec)],'createdAt':_0x3b697f[_0x3e4022(0x163)]};}async[a35_0x550295(0x203)](_0x670264){const _0x220eeb=a35_0x550295,{page:_0x323b77,limit:_0xdc889c,status:_0x3dc9dd}=_0x670264,_0x5d0809=(_0x323b77-0x1)*_0xdc889c,_0x43b069={};_0x3dc9dd&&(_0x43b069[_0x220eeb(0x1ec)]=_0x3dc9dd['toUpperCase']());const [_0x37b1d6,_0x3db4d3]=await Promise['all']([database_1['default'][_0x220eeb(0x249)][_0x220eeb(0x18c)]({'where':_0x43b069,'skip':_0x5d0809,'take':_0xdc889c,'orderBy':{'createdAt':'desc'},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}}),database_1['default']['shop'][_0x220eeb(0x1c4)]({'where':_0x43b069})]);return{'users':_0x37b1d6[_0x220eeb(0x23e)](_0x124b96=>({'id':_0x124b96['id'],'fullName':_0x124b96[_0x220eeb(0x190)],'username':_0x124b96['username'],'telegramId':_0x124b96['telegram'],'merchantUrl':_0x124b96[_0x220eeb(0x1ed)],'gateways':_0x124b96[_0x220eeb(0x1b5)]?JSON['parse'](_0x124b96['paymentGateways']):null,'gatewaySettings':_0x124b96['gatewaySettings']?JSON[_0x220eeb(0x22d)](_0x124b96[_0x220eeb(0x1a4)]):null,'publicKey':_0x124b96[_0x220eeb(0x19c)],'wallets':{'usdtPolygonWallet':_0x124b96[_0x220eeb(0x1ad)],'usdtTrcWallet':_0x124b96['usdtTrcWallet'],'usdtErcWallet':_0x124b96['usdtErcWallet'],'usdcPolygonWallet':_0x124b96['usdcPolygonWallet']},'status':_0x124b96[_0x220eeb(0x1ec)],'createdAt':_0x124b96[_0x220eeb(0x163)]})),'pagination':{'page':_0x323b77,'limit':_0xdc889c,'total':_0x3db4d3,'totalPages':Math['ceil'](_0x3db4d3/_0xdc889c)}};}async['getUserById'](_0x49b5b9){const _0x1d737c=a35_0x550295,_0x1721af=await database_1[_0x1d737c(0x15d)]['shop'][_0x1d737c(0x1d7)]({'where':{'id':_0x49b5b9},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});if(!_0x1721af)return null;return{'id':_0x1721af['id'],'fullName':_0x1721af[_0x1d737c(0x190)],'username':_0x1721af[_0x1d737c(0x206)],'telegramId':_0x1721af[_0x1d737c(0x185)],'merchantUrl':_0x1721af['shopUrl'],'gateways':_0x1721af[_0x1d737c(0x1b5)]?JSON[_0x1d737c(0x22d)](_0x1721af['paymentGateways']):null,'gatewaySettings':_0x1721af[_0x1d737c(0x1a4)]?JSON['parse'](_0x1721af[_0x1d737c(0x1a4)]):null,'publicKey':_0x1721af[_0x1d737c(0x19c)],'wallets':{'usdtPolygonWallet':_0x1721af[_0x1d737c(0x1ad)],'usdtTrcWallet':_0x1721af['usdtTrcWallet'],'usdtErcWallet':_0x1721af[_0x1d737c(0x1f2)],'usdcPolygonWallet':_0x1721af[_0x1d737c(0x1b0)]},'status':_0x1721af[_0x1d737c(0x1ec)],'createdAt':_0x1721af[_0x1d737c(0x163)]};}async['createUser'](_0x2be6e0){const _0x4dde2b=a35_0x550295,{fullName:_0xd653e8,username:_0x80904e,password:_0x175dd6,telegramId:_0xe56ac7,merchantUrl:_0x3b38bd,gateways:_0x4ba1d5,gatewaySettings:_0x3663f7,wallets:_0x3502c5}=_0x2be6e0,_0xcc6877=await database_1[_0x4dde2b(0x15d)]['shop'][_0x4dde2b(0x1d7)]({'where':{'username':_0x80904e}});if(_0xcc6877)throw new Error(_0x4dde2b(0x1b2));if(_0xe56ac7){const _0x508e14=await database_1[_0x4dde2b(0x15d)][_0x4dde2b(0x249)][_0x4dde2b(0x1d7)]({'where':{'telegram':_0xe56ac7}});if(_0x508e14)throw new Error('Telegram\x20username\x20already\x20exists');}const _0x255873=await bcryptjs_1['default']['hash'](_0x175dd6,0xc),_0x1fae50='pk_'+crypto_1[_0x4dde2b(0x15d)][_0x4dde2b(0x18d)](0x20)[_0x4dde2b(0x1d4)](_0x4dde2b(0x179)),_0x209793=_0x4dde2b(0x22f)+crypto_1['default'][_0x4dde2b(0x18d)](0x20)['toString'](_0x4dde2b(0x179)),_0x1c5f29=await database_1[_0x4dde2b(0x15d)][_0x4dde2b(0x249)][_0x4dde2b(0x1f3)]({'data':{'name':_0xd653e8,'username':_0x80904e,'password':_0x255873,'telegram':_0xe56ac7,'shopUrl':_0x3b38bd,'paymentGateways':_0x4ba1d5?JSON[_0x4dde2b(0x158)](_0x4ba1d5):null,'gatewaySettings':_0x3663f7?JSON[_0x4dde2b(0x158)](_0x3663f7):null,'usdtPolygonWallet':_0x3502c5?.[_0x4dde2b(0x1ad)]||null,'usdtTrcWallet':_0x3502c5?.[_0x4dde2b(0x15f)]||null,'usdtErcWallet':_0x3502c5?.[_0x4dde2b(0x1f2)]||null,'usdcPolygonWallet':_0x3502c5?.['usdcPolygonWallet']||null,'publicKey':_0x1fae50,'secretKey':_0x209793,'status':'ACTIVE'},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});return{'id':_0x1c5f29['id'],'fullName':_0x1c5f29[_0x4dde2b(0x190)],'username':_0x1c5f29[_0x4dde2b(0x206)],'telegramId':_0x1c5f29[_0x4dde2b(0x185)],'merchantUrl':_0x1c5f29[_0x4dde2b(0x1ed)],'gateways':_0x1c5f29[_0x4dde2b(0x1b5)]?JSON[_0x4dde2b(0x22d)](_0x1c5f29[_0x4dde2b(0x1b5)]):null,'gatewaySettings':_0x1c5f29[_0x4dde2b(0x1a4)]?JSON[_0x4dde2b(0x22d)](_0x1c5f29[_0x4dde2b(0x1a4)]):null,'publicKey':_0x1c5f29['publicKey'],'wallets':{'usdtPolygonWallet':_0x1c5f29['usdtPolygonWallet'],'usdtTrcWallet':_0x1c5f29[_0x4dde2b(0x15f)],'usdtErcWallet':_0x1c5f29['usdtErcWallet'],'usdcPolygonWallet':_0x1c5f29[_0x4dde2b(0x1b0)]},'status':_0x1c5f29[_0x4dde2b(0x1ec)],'createdAt':_0x1c5f29[_0x4dde2b(0x163)]};}async[a35_0x550295(0x1ee)](_0x5e541e){const _0xf2c3e1=a35_0x550295;await database_1['default'][_0xf2c3e1(0x249)][_0xf2c3e1(0x15a)]({'where':{'id':_0x5e541e}});}async[a35_0x550295(0x1ba)](_0x18fffe){const _0x5cafa6=a35_0x550295,_0x4d4481={};_0x18fffe&&['ACTIVE',_0x5cafa6(0x241),_0x5cafa6(0x19b)]['includes'](_0x18fffe[_0x5cafa6(0x24b)]())&&(_0x4d4481[_0x5cafa6(0x1ec)]=_0x18fffe[_0x5cafa6(0x24b)]());const _0x5ae966=await database_1[_0x5cafa6(0x15d)][_0x5cafa6(0x249)]['findMany']({'where':_0x4d4481,'select':{'id':!![],'username':!![],'name':!![]},'orderBy':{'name':_0x5cafa6(0x1a9)}});return _0x5ae966;}}exports[a35_0x550295(0x17e)]=AdminService;