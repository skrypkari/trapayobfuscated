'use strict';const a36_0x513ef4=a36_0x3a44;(function(_0x1a3c64,_0x412f7c){const _0x1aaf9b=a36_0x3a44,_0x3c14d0=_0x1a3c64();while(!![]){try{const _0x22fb37=-parseInt(_0x1aaf9b(0xe1))/0x1*(-parseInt(_0x1aaf9b(0x10d))/0x2)+parseInt(_0x1aaf9b(0x175))/0x3*(-parseInt(_0x1aaf9b(0x1b8))/0x4)+parseInt(_0x1aaf9b(0x156))/0x5+parseInt(_0x1aaf9b(0x18a))/0x6*(parseInt(_0x1aaf9b(0x9c))/0x7)+-parseInt(_0x1aaf9b(0x159))/0x8+parseInt(_0x1aaf9b(0x155))/0x9+parseInt(_0x1aaf9b(0x16e))/0xa*(-parseInt(_0x1aaf9b(0x108))/0xb);if(_0x22fb37===_0x412f7c)break;else _0x3c14d0['push'](_0x3c14d0['shift']());}catch(_0x57f855){_0x3c14d0['push'](_0x3c14d0['shift']());}}}(a36_0x4ece,0x9ef7f));var __importDefault=this&&this[a36_0x513ef4(0x183)]||function(_0x30aec2){const _0x35d2ad=a36_0x513ef4;return _0x30aec2&&_0x30aec2[_0x35d2ad(0xfd)]?_0x30aec2:{'default':_0x30aec2};};function a36_0x4ece(){const _0x5928ae=['totalCommissionRate','\x20\x20\x20Full\x20amount:\x20','KLYME\x20DE','90d','\x20\x20\x20💰\x20Total\x20payout:\x20','\x20payments)','🔄\x20REFUND:\x20Payment\x20amount\x20already\x20deducted\x20from\x20balance','amountAfterCommissionUSDT','🔐\x20[','⚠️\x20Payment\x20','updateCustomerData','\x20\x20\x20🏪\x20Gateway\x20earnings:\x20','generateDailyStatistics','Telegram\x20username\x20already\x20exists','whiteUrl','telegram','Username\x20already\x20exists','%\x20commission)',',\x20Commission:\x20','log','payment','network','setDate','createdAt','\x20\x20\x20🔍\x20Raw\x20balance\x20sum:\x20','desc',']\x20Gateway\x20settings\x20before\x20saving:','pendingPayout','error','%\x20from\x20','🔄\x20Gateway\x20mapping\x20(create):','usdtErcWallet','\x20\x20\x20🖥️\x20User\x20Agent:\x20',',\x20userId:\x20','CHARGEBACK','🔧\x20[','cointopay2','localeCompare','\x20USDT\x20(actual\x20balances)','merchantEarnings','10928169qeGkjI','5955400NvnIeJ','customerUa','currency','9152776VSKkDQ','totalAmountUSDT','paymentsCount',']\x20Password\x20not\x20provided\x20or\x20empty,\x20skipping\x20password\x20update','fullName','toISOString','name',']\x20Gateway\x20settings\x20JSON\x20string:','\x20\x20\x20Merchant\x20gets:\x20','pk_','\x20\x20\x20🔍\x20Calculated\x20after\x20commission:\x20','findUnique','usdtPolygonWallet','Error\x20parsing\x20gateway\x20settings\x20for\x20payment\x20','📋\x20Found\x20','gateways','status','\x20PAID\x20payments','Test\x20Gateway','forEach','💱\x20Currency\x20filter\x20applied:\x20','392510bHYKwP','stringify','getAllPayouts','toUpperCase','Error\x20parsing\x20gateway\x20settings\x20for\x20shop\x20','createUser','reduce','21YwTjuA','\x20\x20\x20Merchant\x20loses:\x20','delete','groupBy','plisio','🔄\x20Gateway\x20mapping:','map','all','✅\x20Payout\x20created:\x20','updatePaymentStatus','\x20USDT\x20(gross\x20revenue)','\x20\x20\x20�\x20Total\x20payments\x20turnover:\x20','push','lte','__importDefault','date','convertToUSDT','\x20\x20\x20🌍\x20Country:\x20','getPaymentById','shopUrl','defineProperty','31956HCoEnm','NONEXISTENT_GATEWAY_FILTER','parse','statusChangedBy','Open\x20Banking\x202','split','\x27)\x20not\x20found\x20in\x20database,\x20returning\x20empty\x20result','\x20USDT\x20(after\x20','random','toLowerCase','paymentGateways','30d','averageCheckUSDT','PAID','PENDING','getFullYear','awaitingPayout','$transaction','\x20to\x20','\x20\x20\x20⏳\x20Awaiting\x20payout:\x20','\x20USDT','rapyd','\x20in\x20','2020-01-01','getMerchantsAwaitingPayout','polygon_usdc','create','notes','\x27\x20->\x20ID\x20\x27','failureMessage','\x20\x20\x20🌐\x20IP:\x20','dateFrom','\x20\x20\x20💰\x20Total\x20turnover:\x20','\x20USDT\x20(-','\x20\x20\x20📅\x20This\x20month:\x20','\x20\x20\x20Payout\x20amount:\x20','klyme_eu','📊\x20Merchant\x20statistics\x20calculated:','\x20active\x20merchants\x20for\x20selection','usdcPolygonWallet','wallets','merchantUrl','toFixed','aggregate','cointopay','\x20USDT\x20from\x20balance','643612yqzOgu','totalPaidOut','username','📊\x20[ADMIN]\x20Using\x20saved\x20amountAfterGatewayCommissionUSDT:\x20','📋\x20Getting\x20merchants\x20selection\x20list...','📅\x20Period:\x20','📊\x20Payout\x20statistics\x20calculated:','\x20\x20\x20Transaction\x20hash:\x20',',\x20successful:\x20','\x20no\x20longer\x20PAID:','\x20balance\x20updated:\x20','update','chargebackAmount','week','ceil','dailyPayments','getGatewayInternalName','mastercard','totalPayout','\x27\x20not\x20found.\x20Available\x20gateways:\x20','shopId','📊\x20Getting\x20payments\x20with\x20filters:','join','revenue','length','turnoverUSDT','adminNotes','periodTo','klyme_gb','asc','📊\x20Calculating\x20commission\x20manually\x20for\x20payment\x20','Shop\x20not\x20found','168lGRrht','\x20missing\x20amountUSDT,\x20using\x20fallback\x20conversion','Error\x20processing\x20payment\x20','\x20USDT\x20for\x20payment\x20','🎯\x20updateUser\x20called\x20with\x20ID:\x20','gte','customerEmail','activateUser','💸\x20CHARGEBACK\x20penalty:\x20-','txid','customerIp','\x20USDT\x20(with\x20commission\x20deducted)','entries','polygon','trim','hash','💰\x20Current\x20shop\x20balance:\x20','\x20\x20\x20✅\x20Total\x20available\x20for\x20payout:\x20','turnover','get','\x20\x20\x20Balance:\x20','\x20USDT\x20(','updatedAt','\x20USDT\x20(+','../config/database','getMerchantStatistics','period','\x27\x20->\x20name\x20\x27','💰\x20Shop\x20','pendingUrl','SUSPENDED','../types/gateway','💳\x20Payout\x20wallet\x20for\x20','usdtTrcWallet','\x20\x20\x20Gateway:\x20','💰\x20Found\x20','getGatewayNameById','amountUSDT','telegramId','password','\x20\x20\x20�\x20Total\x20paid\x20out:\x20','\x20USDT\x20(theoretical\x20net)','randomBytes','some','\x20merchants','includes','\x20\x20\x20💵\x20Available\x20balance:\x20','\x20->\x20','📊\x20Available\x20gateways\x20in\x20database:','findMany','createPayout','summary','not\x20set','📊\x20Getting\x20merchant\x20statistics\x20with\x20filters:','\x27\x20as\x20is\x20(not\x20found\x20in\x20mappings)','🔄\x20Converted\x20gateway\x20name\x20\x27','insensitive','dateTo','\x20USDT\x20(after\x20payouts)','COMPLETED','getMonth','\x20\x20\x20📅\x20Total\x20payouts\x20(this\x20month):\x20','getMerchantsSelection','gatewaySettings','payout','gateway','count','📊\x20Gateway\x20filter\x20applied:','currencyService','1qEhnRs','_sum','\x20\x20\x20Subtracted\x20from\x20balance:\x20-','admin','shop','erc20','gatewayEarnings','getPayoutById','💰\x20[PAYOUT]\x20Gateway\x20','⚠️\x20Requested\x20gateway\x20\x27','⚠️\x20Gateway\x20\x27','\x20USDT)','\x27\x20(from\x20\x27','balance','./currencyService','round','customerCountry','amount','\x20\x20\x20💰\x20Total\x20payments\x20turnover:\x20','KLYME\x20EU','💰\x20Creating\x20payout\x20for\x20shop\x20','📊\x20Using\x20saved\x20amountAfterGatewayCommissionUSDT:\x20','_count','gatewayOrderId','📊\x20Sorting\x20payments\x20by\x20','paidOutUSDT','substr','commissionUSDT','__esModule','findFirst','\x20paid\x20payments\x20for\x20analysis','getUserById','deleteUser','\x20\x20\x20Added\x20to\x20balance:\x20+','\x20balance\x20updated:','noda','hex','\x20status:\x20','REFUND','253IMkzJW','updateUser','thisMonth','publicKey','🔄\x20Updating\x20customer\x20data\x20for\x20payment\x20','2582362kFOudO','default','\x20USDT\x20(without\x20commission)','amountAfterGatewayCommissionUSDT','paidAt','commission','failUrl','🔄\x20Admin\x20updating\x20payment\x20','ACTIVE','CoinToPay','🔄\x20Converted\x20gateway\x20ID\x20\x27','customerName','averageCommissionRate','totalPayments','getGatewayDisplayName','💰\x20Payment\x20','periodFrom','set','💸\x20CHARGEBACK:\x20Merchant\x20amount\x20already\x20deducted\x20from\x20balance',']\x20Updating\x20password\x20for\x20user\x20','📊\x20Calculating\x20payout\x20statistics...','Payment\x20not\x20found','test_gateway','values','toString','Rapyd','merchantEarningsUSDT',':\x20commission\x20=\x20','getTime','Insufficient\x20balance.\x20Available:\x20','totalAmountAfterCommissionUSDT','AdminService'];a36_0x4ece=function(){return _0x5928ae;};return a36_0x4ece();}function a36_0x3a44(_0x593be4,_0x250880){const _0x4ece60=a36_0x4ece();return a36_0x3a44=function(_0x3a4484,_0x1c0979){_0x3a4484=_0x3a4484-0x80;let _0x1b9321=_0x4ece60[_0x3a4484];return _0x1b9321;},a36_0x3a44(_0x593be4,_0x250880);}Object[a36_0x513ef4(0x189)](exports,a36_0x513ef4(0xfd),{'value':!![]}),exports[a36_0x513ef4(0x12c)]=void 0x0;const database_1=__importDefault(require(a36_0x513ef4(0xb4))),bcryptjs_1=__importDefault(require('bcryptjs')),crypto_1=__importDefault(require('crypto')),currencyService_1=require(a36_0x513ef4(0xef)),gateway_1=require(a36_0x513ef4(0xbb));class AdminService{async['getPayoutStats'](){const _0x79ae40=a36_0x513ef4;console[_0x79ae40(0x140)](_0x79ae40(0x121));const _0x1263b8=await database_1['default']['shop']['aggregate']({'_sum':{'balance':!![],'totalPaidOut':!![]},'where':{'status':_0x79ae40(0x115)}}),_0x45e148=await this[_0x79ae40(0x1a2)]({'page':0x1,'limit':0x3e8}),_0x4b6b91=await database_1[_0x79ae40(0x10e)][_0x79ae40(0x141)][_0x79ae40(0xde)]({'where':{'status':_0x79ae40(0x197),'gateway':{'not':_0x79ae40(0x123)}}}),_0x127a17=new Date(),_0xac5c30=new Date(_0x127a17[_0x79ae40(0x199)](),_0x127a17['getMonth'](),0x1),_0x89e829=new Date(_0x127a17[_0x79ae40(0x199)](),_0x127a17[_0x79ae40(0xd8)]()+0x1,0x0,0x17,0x3b,0x3b,0x3e7),_0x3da6f3=await database_1[_0x79ae40(0x10e)]['payout'][_0x79ae40(0x1b5)]({'_sum':{'amount':!![]},'where':{'createdAt':{'gte':_0xac5c30,'lte':_0x89e829},'status':'COMPLETED'}}),_0xbb1792=_0x1263b8[_0x79ae40(0xe2)]['totalPaidOut']||0x0,_0x3ef5e8=_0x45e148[_0x79ae40(0xcf)]['totalAmountAfterCommissionUSDT'],_0xf4d9ac=_0x3da6f3[_0x79ae40(0xe2)]['amount']||0x0,_0x589dd7={'totalPayout':Math['round'](_0xbb1792*0x64)/0x64,'awaitingPayout':Math[_0x79ae40(0xf0)](_0x3ef5e8*0x64)/0x64,'thisMonth':Math[_0x79ae40(0xf0)](_0xf4d9ac*0x64)/0x64,'availableBalance':Math[_0x79ae40(0xf0)](_0x3ef5e8*0x64)/0x64,'totalPayments':_0x4b6b91};return console[_0x79ae40(0x140)](_0x79ae40(0x82)),console[_0x79ae40(0x140)](_0x79ae40(0x131)+_0x589dd7[_0x79ae40(0x8e)]+'\x20USDT\x20(total\x20paid\x20to\x20merchants)'),console[_0x79ae40(0x140)](_0x79ae40(0x19d)+_0x589dd7[_0x79ae40(0x19a)]+_0x79ae40(0xa7)),console[_0x79ae40(0x140)](_0x79ae40(0xca)+_0x589dd7['availableBalance']+'\x20USDT\x20(same\x20as\x20awaiting)'),console[_0x79ae40(0x140)](_0x79ae40(0x1ac)+_0x589dd7[_0x79ae40(0x10a)]+_0x79ae40(0x19e)),console['log']('\x20\x20\x20💳\x20Total\x20payments:\x20'+_0x589dd7[_0x79ae40(0x11a)]+_0x79ae40(0x16a)),console[_0x79ae40(0x140)](_0x79ae40(0x145)+(_0x1263b8['_sum'][_0x79ae40(0xee)]||0x0)[_0x79ae40(0x1b4)](0x2)+_0x79ae40(0x10f)),console['log']('\x20\x20\x20📊\x20Commission\x20difference:\x20'+((_0x1263b8[_0x79ae40(0xe2)]['balance']||0x0)-_0x3ef5e8)[_0x79ae40(0x1b4)](0x2)+_0x79ae40(0x19e)),_0x589dd7;}async[a36_0x513ef4(0x137)](_0x5c1727,_0x24f307){const _0x567c57=a36_0x513ef4;console[_0x567c57(0x140)](_0x567c57(0x10c)+_0x5c1727+':',_0x24f307);const _0x29aa11=await database_1[_0x567c57(0x10e)][_0x567c57(0x141)][_0x567c57(0x164)]({'where':{'id':_0x5c1727},'select':{'id':!![],'customerEmail':!![],'customerName':!![],'customerCountry':!![],'customerIp':!![],'customerUa':!![]}});if(!_0x29aa11)throw new Error(_0x567c57(0x122));const _0x27a7ae={};_0x24f307[_0x567c57(0xf1)]!==undefined&&(_0x27a7ae[_0x567c57(0xf1)]=_0x24f307[_0x567c57(0xf1)]||null);_0x24f307[_0x567c57(0xa6)]!==undefined&&(_0x27a7ae['customerIp']=_0x24f307[_0x567c57(0xa6)]||null);_0x24f307['customerUa']!==undefined&&(_0x27a7ae[_0x567c57(0x157)]=_0x24f307[_0x567c57(0x157)]||null);const _0xf2012=await database_1[_0x567c57(0x10e)]['payment']['update']({'where':{'id':_0x5c1727},'data':{..._0x27a7ae,'updatedAt':new Date()},'select':{'id':!![],'customerEmail':!![],'customerName':!![],'customerCountry':!![],'customerIp':!![],'customerUa':!![],'updatedAt':!![]}});return console[_0x567c57(0x140)]('✅\x20Customer\x20data\x20updated\x20for\x20payment\x20'+_0x5c1727),console['log'](_0x567c57(0x186)+_0x29aa11[_0x567c57(0xf1)]+'\x20->\x20'+_0xf2012['customerCountry']),console[_0x567c57(0x140)](_0x567c57(0x1a8)+_0x29aa11[_0x567c57(0xa6)]+_0x567c57(0xcb)+_0xf2012[_0x567c57(0xa6)]),console[_0x567c57(0x140)](_0x567c57(0x14d)+(_0x29aa11['customerUa']?'set':_0x567c57(0xd0))+_0x567c57(0xcb)+(_0xf2012[_0x567c57(0x157)]?_0x567c57(0x11e):_0x567c57(0xd0))),_0xf2012;}async['getSystemStatistics'](_0x2cd059){const _0x5b5913=a36_0x513ef4,_0x54d46b=new Date();let _0x29abce;switch(_0x2cd059){case'7d':_0x29abce=new Date(_0x54d46b[_0x5b5913(0x129)]()-0x7*0x18*0x3c*0x3c*0x3e8);break;case _0x5b5913(0x195):_0x29abce=new Date(_0x54d46b[_0x5b5913(0x129)]()-0x1e*0x18*0x3c*0x3c*0x3e8);break;case _0x5b5913(0x130):_0x29abce=new Date(_0x54d46b[_0x5b5913(0x129)]()-0x5a*0x18*0x3c*0x3c*0x3e8);break;case _0x5b5913(0x17c):const _0x4cc5ce=await database_1[_0x5b5913(0x10e)][_0x5b5913(0x141)][_0x5b5913(0xfe)]({'where':{'gateway':{'not':_0x5b5913(0x123)}},'orderBy':{'createdAt':_0x5b5913(0x99)},'select':{'createdAt':!![]}});_0x29abce=_0x4cc5ce?_0x4cc5ce[_0x5b5913(0x144)]:new Date(_0x5b5913(0x1a1)),console[_0x5b5913(0x140)]('📅\x20Period\x20\x27all\x27:\x20Using\x20start\x20date\x20from\x20first\x20payment:\x20'+_0x29abce[_0x5b5913(0x15e)]());break;default:_0x29abce=new Date(_0x54d46b[_0x5b5913(0x129)]()-0x1e*0x18*0x3c*0x3c*0x3e8);}const [_0x290118,_0xa04c49,_0x5ab47d,_0x5f5a5b,_0x159a56,_0x1d88f3]=await Promise[_0x5b5913(0x17c)]([database_1[_0x5b5913(0x10e)][_0x5b5913(0xe5)][_0x5b5913(0xde)](),database_1[_0x5b5913(0x10e)][_0x5b5913(0xe5)][_0x5b5913(0xde)]({'where':{'status':_0x5b5913(0x115)}}),database_1[_0x5b5913(0x10e)]['payment']['count']({'where':{'status':_0x5b5913(0x197),'createdAt':{'gte':_0x29abce},'gateway':{'not':_0x5b5913(0x123)}}}),database_1[_0x5b5913(0x10e)][_0x5b5913(0x141)][_0x5b5913(0xcd)]({'where':{'status':_0x5b5913(0x197),'createdAt':{'gte':_0x29abce},'gateway':{'not':_0x5b5913(0x123)}},'select':{'amount':!![],'currency':!![],'amountAfterGatewayCommissionUSDT':!![]}}),database_1[_0x5b5913(0x10e)][_0x5b5913(0x141)][_0x5b5913(0xcd)]({'where':{'gateway':{'not':_0x5b5913(0x123)}},'take':0xa,'orderBy':{'createdAt':_0x5b5913(0x146)},'include':{'shop':{'select':{'name':!![],'username':!![]}}}}),database_1[_0x5b5913(0x10e)]['payment'][_0x5b5913(0xcd)]({'where':{'createdAt':{'gte':_0x29abce},'gateway':{'not':_0x5b5913(0x123)}},'select':{'amount':!![],'currency':!![],'status':!![],'amountUSDT':!![],'createdAt':!![]}})]);let _0x433632=0x0,_0x33f3bf=0x0;for(const _0x5b0f73 of _0x5f5a5b){const _0x37589e=await currencyService_1[_0x5b5913(0xe0)][_0x5b5913(0x185)](_0x5b0f73[_0x5b5913(0xf2)],_0x5b0f73['currency']);_0x433632+=_0x37589e;if(_0x5b0f73[_0x5b5913(0x110)]){const _0x32dbba=await currencyService_1[_0x5b5913(0xe0)][_0x5b5913(0x185)](_0x5b0f73[_0x5b5913(0xf2)],_0x5b0f73[_0x5b5913(0x158)]),_0x42fea5=_0x5b0f73[_0x5b5913(0x110)],_0x274824=_0x32dbba-_0x42fea5;_0x33f3bf+=_0x274824;}}const _0x31d089=_0x5ab47d>0x0?_0x433632/_0x5ab47d:0x0,_0x1733bc=this[_0x5b5913(0x139)](_0x1d88f3,_0x29abce,_0x54d46b),_0x248d74=await database_1[_0x5b5913(0x10e)]['payment'][_0x5b5913(0xde)]({'where':{'createdAt':{'gte':_0x29abce},'gateway':{'not':'test_gateway'}}}),_0x2d29bb=_0x248d74>0x0?_0x5ab47d/_0x248d74*0x64:0x0;return{'totalShops':_0x290118,'activeShops':_0xa04c49,'totalPayments':_0x5ab47d,'successfulPayments':_0x5ab47d,'totalAttempts':_0x248d74,'totalRevenue':Math[_0x5b5913(0xf0)](_0x433632*0x64)/0x64,'trapayEarnings':Math['round'](_0x33f3bf*0x64)/0x64,'averagePaymentAmount':Math[_0x5b5913(0xf0)](_0x31d089*0x64)/0x64,'conversionRate':Math[_0x5b5913(0xf0)](_0x2d29bb*0x64)/0x64,'dailyRevenue':_0x1733bc['dailyRevenue'],'dailyPayments':_0x1733bc[_0x5b5913(0x8b)],'recentPayments':_0x159a56[_0x5b5913(0x17b)](_0x2a4f83=>({'id':_0x2a4f83['id'],'amount':_0x2a4f83[_0x5b5913(0xf2)],'currency':_0x2a4f83[_0x5b5913(0x158)],'status':_0x2a4f83[_0x5b5913(0x169)],'gateway':_0x2a4f83['gateway'],'shop':_0x2a4f83[_0x5b5913(0xe5)],'createdAt':_0x2a4f83[_0x5b5913(0x144)]}))};}async[a36_0x513ef4(0xb5)](_0x20f608){const _0x493a2f=a36_0x513ef4;console[_0x493a2f(0x140)](_0x493a2f(0xd1),_0x20f608);let _0x5ce73e,_0x1c0463=new Date();if(_0x20f608['period']==='custom'&&_0x20f608[_0x493a2f(0x1a9)]&&_0x20f608[_0x493a2f(0xd5)])_0x5ce73e=new Date(_0x20f608[_0x493a2f(0x1a9)]),_0x1c0463=new Date(_0x20f608[_0x493a2f(0xd5)]);else{const _0x571ae4=new Date();switch(_0x20f608[_0x493a2f(0xb6)]){case _0x493a2f(0x89):_0x5ce73e=new Date(_0x571ae4[_0x493a2f(0x129)]()-0x7*0x18*0x3c*0x3c*0x3e8);break;case'month':_0x5ce73e=new Date(_0x571ae4[_0x493a2f(0x129)]()-0x1e*0x18*0x3c*0x3c*0x3e8);break;case'year':_0x5ce73e=new Date(_0x571ae4[_0x493a2f(0x129)]()-0x16d*0x18*0x3c*0x3c*0x3e8);break;case _0x493a2f(0x17c):default:_0x5ce73e=new Date(_0x493a2f(0x1a1));break;}}console[_0x493a2f(0x140)](_0x493a2f(0x81)+_0x5ce73e[_0x493a2f(0x15e)]()+_0x493a2f(0x19c)+_0x1c0463[_0x493a2f(0x15e)]());const _0x4d93c1={'status':'PAID','gateway':{'not':_0x493a2f(0x123)},'paidAt':{'gte':_0x5ce73e,'lte':_0x1c0463}};_0x20f608['shopId']&&(_0x4d93c1['shopId']=_0x20f608[_0x493a2f(0x90)]);const _0x5457b8=await database_1[_0x493a2f(0x10e)][_0x493a2f(0x141)][_0x493a2f(0xcd)]({'where':_0x4d93c1,'include':{'shop':{'select':{'id':!![],'name':!![],'username':!![],'gatewaySettings':!![]}}}});console[_0x493a2f(0x140)](_0x493a2f(0xbf)+_0x5457b8[_0x493a2f(0x94)]+_0x493a2f(0xff));const _0x49cd12={'gateway':{'not':_0x493a2f(0x123)},'createdAt':{'gte':_0x5ce73e,'lte':_0x1c0463}};_0x20f608[_0x493a2f(0x90)]&&(_0x49cd12[_0x493a2f(0x90)]=_0x20f608['shopId']);const _0x2805b1=await database_1[_0x493a2f(0x10e)][_0x493a2f(0x141)][_0x493a2f(0xde)]({'where':_0x49cd12});console[_0x493a2f(0x140)]('📊\x20Total\x20payments\x20(including\x20failed):\x20'+_0x2805b1+_0x493a2f(0x84)+_0x5457b8[_0x493a2f(0x94)]);let _0x2b754e=0x0,_0x56cf78=0x0,_0x12f0a0=0x0;const _0x242978={},_0x47c125={},_0x20ce90={};for(const _0x3b5d59 of _0x5457b8){try{const _0x274b07=await currencyService_1[_0x493a2f(0xe0)][_0x493a2f(0x185)](_0x3b5d59[_0x493a2f(0xf2)],_0x3b5d59[_0x493a2f(0x158)]);let _0x252668={};if(_0x3b5d59['shop']['gatewaySettings'])try{_0x252668=JSON[_0x493a2f(0x18c)](_0x3b5d59['shop'][_0x493a2f(0xdb)]);}catch(_0x4df111){console[_0x493a2f(0x149)](_0x493a2f(0x172)+_0x3b5d59['shopId']+':',_0x4df111);}let _0x4990e6={},_0x978d04=0xa;for(const [_0x9e4935,_0x1ad0b5]of Object[_0x493a2f(0xa8)](_0x252668)){if(_0x9e4935[_0x493a2f(0x193)]()===_0x3b5d59[_0x493a2f(0xdd)][_0x493a2f(0x193)]()){_0x4990e6=_0x1ad0b5,_0x978d04=_0x1ad0b5[_0x493a2f(0x112)]||0xa;break;}}let _0xba8d26,_0x19c199;_0x3b5d59[_0x493a2f(0x110)]!==null&&_0x3b5d59[_0x493a2f(0x110)]!==undefined?(_0xba8d26=_0x3b5d59[_0x493a2f(0x110)],_0x19c199=_0x274b07-_0xba8d26,console[_0x493a2f(0x140)](_0x493a2f(0xf6)+_0xba8d26['toFixed'](0x6)+_0x493a2f(0x9f)+_0x3b5d59['id'])):(_0x19c199=_0x274b07*(_0x978d04/0x64),_0xba8d26=_0x274b07-_0x19c199,console[_0x493a2f(0x140)](_0x493a2f(0x9a)+_0x3b5d59['id']+':\x20'+_0x978d04+_0x493a2f(0x14a)+_0x274b07[_0x493a2f(0x1b4)](0x6)+_0x493a2f(0x19e)));_0x2b754e+=_0x274b07,_0x56cf78+=_0xba8d26,_0x12f0a0+=_0x19c199;!_0x242978[_0x3b5d59[_0x493a2f(0xdd)]]&&(_0x242978[_0x3b5d59[_0x493a2f(0xdd)]]={'gateway':_0x3b5d59[_0x493a2f(0xdd)],'gatewayDisplayName':this['getGatewayDisplayName'](_0x3b5d59['gateway']),'paymentsCount':0x0,'turnoverUSDT':0x0,'commissionUSDT':0x0,'merchantEarningsUSDT':0x0,'totalCommissionRate':0x0});_0x242978[_0x3b5d59[_0x493a2f(0xdd)]]['paymentsCount']++,_0x242978[_0x3b5d59[_0x493a2f(0xdd)]]['turnoverUSDT']+=_0x274b07,_0x242978[_0x3b5d59['gateway']][_0x493a2f(0xfc)]+=_0x19c199,_0x242978[_0x3b5d59[_0x493a2f(0xdd)]][_0x493a2f(0x127)]+=_0xba8d26,_0x242978[_0x3b5d59[_0x493a2f(0xdd)]]['totalCommissionRate']+=_0x978d04;!_0x20f608['shopId']&&(!_0x47c125[_0x3b5d59['shopId']]&&(_0x47c125[_0x3b5d59[_0x493a2f(0x90)]]={'shopId':_0x3b5d59[_0x493a2f(0x90)],'shopName':_0x3b5d59[_0x493a2f(0xe5)][_0x493a2f(0x15f)],'shopUsername':_0x3b5d59['shop'][_0x493a2f(0x1ba)],'paymentsCount':0x0,'turnoverUSDT':0x0,'commissionUSDT':0x0,'merchantEarningsUSDT':0x0,'paidOutUSDT':0x0,'averageCheckUSDT':0x0}),_0x47c125[_0x3b5d59[_0x493a2f(0x90)]][_0x493a2f(0x15b)]++,_0x47c125[_0x3b5d59[_0x493a2f(0x90)]]['turnoverUSDT']+=_0x274b07,_0x47c125[_0x3b5d59[_0x493a2f(0x90)]]['commissionUSDT']+=_0x19c199,_0x47c125[_0x3b5d59['shopId']][_0x493a2f(0x127)]+=_0xba8d26);const _0x4d1904=_0x3b5d59[_0x493a2f(0x111)]['toISOString']()[_0x493a2f(0x18f)]('T')[0x0];!_0x20ce90[_0x4d1904]&&(_0x20ce90[_0x4d1904]={'date':_0x4d1904,'turnover':0x0,'merchantEarnings':0x0,'gatewayEarnings':0x0,'paymentsCount':0x0}),_0x20ce90[_0x4d1904][_0x493a2f(0xae)]+=_0x274b07,_0x20ce90[_0x4d1904][_0x493a2f(0x154)]+=_0xba8d26,_0x20ce90[_0x4d1904][_0x493a2f(0xe7)]+=_0x19c199,_0x20ce90[_0x4d1904][_0x493a2f(0x15b)]++;}catch(_0x4e2a2b){console[_0x493a2f(0x149)](_0x493a2f(0x9e)+_0x3b5d59['id']+':',_0x4e2a2b);}}Object[_0x493a2f(0x124)](_0x242978)[_0x493a2f(0x16c)](_0x154f1b=>{const _0x888aea=_0x493a2f;_0x154f1b[_0x888aea(0x119)]=_0x154f1b['paymentsCount']>0x0?_0x154f1b[_0x888aea(0x12d)]/_0x154f1b[_0x888aea(0x15b)]:0x0,delete _0x154f1b['totalCommissionRate'];}),Object[_0x493a2f(0x124)](_0x47c125)[_0x493a2f(0x16c)](_0x33a30c=>{const _0x132753=_0x493a2f;_0x33a30c['averageCheckUSDT']=_0x33a30c['paymentsCount']>0x0?_0x33a30c[_0x132753(0x95)]/_0x33a30c['paymentsCount']:0x0;});let _0x2104f9=0x0,_0x32b5a7=0x0;if(_0x20f608[_0x493a2f(0x90)]){const _0x44fb86=await database_1[_0x493a2f(0x10e)][_0x493a2f(0xdc)][_0x493a2f(0xcd)]({'where':{'shopId':_0x20f608['shopId'],'status':_0x493a2f(0xd7),'createdAt':{'gte':_0x5ce73e,'lte':_0x1c0463}},'select':{'amount':!![]}});_0x2104f9=_0x44fb86['reduce']((_0x33cb8d,_0x1fc493)=>_0x33cb8d+_0x1fc493['amount'],0x0);const _0x418551=await database_1[_0x493a2f(0x10e)]['payout'][_0x493a2f(0xcd)]({'where':{'shopId':_0x20f608[_0x493a2f(0x90)],'status':_0x493a2f(0x198),'createdAt':{'gte':_0x5ce73e,'lte':_0x1c0463}},'select':{'amount':!![]}});_0x32b5a7=_0x418551[_0x493a2f(0x174)]((_0x35b5b9,_0x31091c)=>_0x35b5b9+_0x31091c[_0x493a2f(0xf2)],0x0);}const _0x4975a4=_0x2805b1,_0x5a4ba1=_0x5457b8[_0x493a2f(0x94)],_0x1ab0d0=_0x5a4ba1>0x0?_0x2b754e/_0x5a4ba1:0x0,_0x3a9d5c=_0x4975a4>0x0?Math[_0x493a2f(0xf0)](_0x5a4ba1/_0x4975a4*0x2710)/0x64:0x0,_0x491ad4=Math['ceil']((_0x1c0463[_0x493a2f(0x129)]()-_0x5ce73e[_0x493a2f(0x129)]())/(0x3e8*0x3c*0x3c*0x18)),_0x279625={'totalTurnover':Math[_0x493a2f(0xf0)](_0x2b754e*0x64)/0x64,'merchantEarnings':Math['round'](_0x56cf78*0x64)/0x64,'gatewayEarnings':Math['round'](_0x12f0a0*0x64)/0x64,'totalPaidOut':Math['round'](_0x2104f9*0x64)/0x64,'pendingPayout':Math[_0x493a2f(0xf0)](_0x32b5a7*0x64)/0x64,'averageCheck':Math['round'](_0x1ab0d0*0x64)/0x64,'totalPayments':_0x4975a4,'successfulPayments':_0x5a4ba1,'conversionRate':_0x3a9d5c,'gatewayBreakdown':Object[_0x493a2f(0x124)](_0x242978)[_0x493a2f(0x17b)](_0x120710=>({..._0x120710,'turnoverUSDT':Math[_0x493a2f(0xf0)](_0x120710['turnoverUSDT']*0x64)/0x64,'commissionUSDT':Math[_0x493a2f(0xf0)](_0x120710[_0x493a2f(0xfc)]*0x64)/0x64,'merchantEarningsUSDT':Math[_0x493a2f(0xf0)](_0x120710['merchantEarningsUSDT']*0x64)/0x64,'averageCommissionRate':Math[_0x493a2f(0xf0)](_0x120710[_0x493a2f(0x119)]*0x64)/0x64})),'merchantBreakdown':_0x20f608[_0x493a2f(0x90)]?undefined:Object['values'](_0x47c125)[_0x493a2f(0x17b)](_0x153db8=>({..._0x153db8,'turnoverUSDT':Math['round'](_0x153db8[_0x493a2f(0x95)]*0x64)/0x64,'commissionUSDT':Math[_0x493a2f(0xf0)](_0x153db8[_0x493a2f(0xfc)]*0x64)/0x64,'merchantEarningsUSDT':Math[_0x493a2f(0xf0)](_0x153db8[_0x493a2f(0x127)]*0x64)/0x64,'paidOutUSDT':Math[_0x493a2f(0xf0)](_0x153db8[_0x493a2f(0xfa)]*0x64)/0x64,'averageCheckUSDT':Math[_0x493a2f(0xf0)](_0x153db8[_0x493a2f(0x196)]*0x64)/0x64})),'dailyData':Object[_0x493a2f(0x124)](_0x20ce90)[_0x493a2f(0x17b)](_0x46404c=>({..._0x46404c,'turnover':Math['round'](_0x46404c[_0x493a2f(0xae)]*0x64)/0x64,'merchantEarnings':Math['round'](_0x46404c[_0x493a2f(0x154)]*0x64)/0x64,'gatewayEarnings':Math[_0x493a2f(0xf0)](_0x46404c[_0x493a2f(0xe7)]*0x64)/0x64}))['sort']((_0x23fcbd,_0xa5c086)=>_0x23fcbd[_0x493a2f(0x184)][_0x493a2f(0x152)](_0xa5c086[_0x493a2f(0x184)])),'periodInfo':{'from':_0x5ce73e,'to':_0x1c0463,'periodType':_0x20f608[_0x493a2f(0xb6)]||'custom','daysCount':_0x491ad4}};return console[_0x493a2f(0x140)](_0x493a2f(0x1af)),console[_0x493a2f(0x140)](_0x493a2f(0x1aa)+_0x279625['totalTurnover']+_0x493a2f(0x19e)),console['log']('\x20\x20\x20👤\x20Merchant\x20earnings:\x20'+_0x279625[_0x493a2f(0x154)]+_0x493a2f(0x19e)),console[_0x493a2f(0x140)](_0x493a2f(0x138)+_0x279625[_0x493a2f(0xe7)]+_0x493a2f(0x19e)),console[_0x493a2f(0x140)](_0x493a2f(0xc4)+_0x279625[_0x493a2f(0x1b9)]+_0x493a2f(0x19e)),console[_0x493a2f(0x140)]('\x20\x20\x20⏳\x20Pending\x20payout:\x20'+_0x279625[_0x493a2f(0x148)]+_0x493a2f(0x19e)),console[_0x493a2f(0x140)]('\x20\x20\x20�📊\x20Total\x20payments:\x20'+_0x279625['totalPayments']),_0x279625;}async[a36_0x513ef4(0xda)](){const _0x6dc118=a36_0x513ef4;console[_0x6dc118(0x140)](_0x6dc118(0x80));const _0x24df58=await database_1['default'][_0x6dc118(0xe5)][_0x6dc118(0xcd)]({'where':{'status':'ACTIVE'},'select':{'id':!![],'username':!![],'name':!![]},'orderBy':{'name':_0x6dc118(0x99)}});return console['log'](_0x6dc118(0x167)+_0x24df58[_0x6dc118(0x94)]+_0x6dc118(0x1b0)),_0x24df58[_0x6dc118(0x17b)](_0x569a7c=>({'id':_0x569a7c['id'],'username':_0x569a7c[_0x6dc118(0x1ba)],'name':_0x569a7c[_0x6dc118(0x15f)]}));}[a36_0x513ef4(0x11b)](_0x3c1f90){const _0x5659b2=a36_0x513ef4,_0x3fa3e8={'test_gateway':_0x5659b2(0x16b),'plisio':'Plisio','rapyd':_0x5659b2(0x126),'noda':'Noda','cointopay':_0x5659b2(0x116),'cointopay2':_0x5659b2(0x18e),'klyme_eu':_0x5659b2(0xf4),'klyme_gb':'KLYME\x20GB','klyme_de':_0x5659b2(0x12f),'mastercard':'MasterCard'};return _0x3fa3e8[_0x3c1f90]||_0x3c1f90;}[a36_0x513ef4(0x8c)](_0x549694){const _0x1d3123=a36_0x513ef4,_0x84e6da={'Test\x20Gateway':_0x1d3123(0x123),'Plisio':_0x1d3123(0x179),'Rapyd':_0x1d3123(0x19f),'Noda':_0x1d3123(0x104),'CoinToPay':_0x1d3123(0x1b6),'CoinToPay2':_0x1d3123(0x151),'KLYME\x20EU':_0x1d3123(0x1ae),'KLYME\x20GB':_0x1d3123(0x98),'KLYME\x20DE':'klyme_de','MasterCard':_0x1d3123(0x8d)};return _0x84e6da[_0x549694]||_0x549694['toLowerCase']();}async[a36_0x513ef4(0x1a2)](_0x13057b){const _0x5ceeda=a36_0x513ef4,{page:_0x5cc4be,limit:_0x122795,minAmount:_0x14eb60,search:_0x496b20}=_0x13057b,_0x317355=(_0x5cc4be-0x1)*_0x122795;console[_0x5ceeda(0x140)]('📊\x20Getting\x20merchants\x20awaiting\x20payout\x20with\x20filters:',_0x13057b);const _0x52e8e5={'balance':{'gt':0x0},'status':_0x5ceeda(0x115)};_0x14eb60&&(_0x52e8e5[_0x5ceeda(0xee)][_0x5ceeda(0xa1)]=_0x14eb60);_0x496b20&&(_0x52e8e5['OR']=[{'name':{'contains':_0x496b20,'mode':_0x5ceeda(0xd4)}},{'username':{'contains':_0x496b20,'mode':'insensitive'}}]);const [_0x5a44e4,_0xe5462]=await Promise[_0x5ceeda(0x17c)]([database_1[_0x5ceeda(0x10e)][_0x5ceeda(0xe5)]['findMany']({'where':_0x52e8e5,'skip':_0x317355,'take':_0x122795,'orderBy':{'balance':_0x5ceeda(0x146)},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'balance':!![],'totalPaidOut':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'gatewaySettings':!![],'createdAt':!![]}}),database_1['default'][_0x5ceeda(0xe5)][_0x5ceeda(0xde)]({'where':_0x52e8e5})]);console[_0x5ceeda(0x140)](_0x5ceeda(0xbf)+_0x5a44e4[_0x5ceeda(0x94)]+'\x20merchants\x20with\x20positive\x20balance');const _0x90ed5b=await Promise[_0x5ceeda(0x17c)](_0x5a44e4[_0x5ceeda(0x17b)](async _0xb10f3d=>{const _0x56cd29=_0x5ceeda,[_0x3ea919,_0x48dae5,_0x4a9a54]=await Promise[_0x56cd29(0x17c)]([database_1[_0x56cd29(0x10e)][_0x56cd29(0x141)][_0x56cd29(0xde)]({'where':{'shopId':_0xb10f3d['id'],'status':_0x56cd29(0x197),'gateway':{'not':_0x56cd29(0x123)}}}),database_1[_0x56cd29(0x10e)][_0x56cd29(0x141)][_0x56cd29(0xfe)]({'where':{'shopId':_0xb10f3d['id'],'status':'PAID','gateway':{'not':'test_gateway'}},'orderBy':{'paidAt':_0x56cd29(0x99)},'select':{'paidAt':!![]}}),database_1[_0x56cd29(0x10e)][_0x56cd29(0x141)][_0x56cd29(0x178)]({'by':[_0x56cd29(0xdd)],'where':{'shopId':_0xb10f3d['id'],'status':_0x56cd29(0x197),'gateway':{'not':'test_gateway'}},'_count':{'id':!![]},'_sum':{'amountUSDT':!![]}})]),_0x212565=new Date(),_0x2719a8=new Date(_0x212565[_0x56cd29(0x199)](),_0x212565['getMonth'](),0x1),_0x3fb010=new Date(_0x212565['getFullYear'](),_0x212565['getMonth']()+0x1,0x0,0x17,0x3b,0x3b,0x3e7),[_0x39a96c,_0x59ac4e]=await Promise[_0x56cd29(0x17c)]([database_1['default'][_0x56cd29(0xdc)]['aggregate']({'_sum':{'amount':!![]},'where':{'shopId':_0xb10f3d['id'],'status':'COMPLETED'}}),database_1[_0x56cd29(0x10e)][_0x56cd29(0xdc)][_0x56cd29(0x1b5)]({'_sum':{'amount':!![]},'where':{'shopId':_0xb10f3d['id'],'status':'COMPLETED','createdAt':{'gte':_0x2719a8,'lte':_0x3fb010}}})]),_0x139bcb=_0x39a96c[_0x56cd29(0xe2)][_0x56cd29(0xf2)]||0x0,_0x4ce8b4=_0x59ac4e[_0x56cd29(0xe2)]['amount']||0x0,_0x29772d=await Promise[_0x56cd29(0x17c)](_0x4a9a54[_0x56cd29(0x17b)](async _0x1b6dce=>{const _0x5c3608=_0x56cd29;let _0x4201d8=0xa;if(_0xb10f3d[_0x5c3608(0xdb)])try{const _0x97475d=JSON['parse'](_0xb10f3d[_0x5c3608(0xdb)]);for(const [_0x2ead23,_0x2d940c]of Object[_0x5c3608(0xa8)](_0x97475d)){if(_0x2ead23['toLowerCase']()===_0x1b6dce['gateway'][_0x5c3608(0x193)]()){_0x4201d8=_0x2d940c[_0x5c3608(0x112)]||0xa,console[_0x5c3608(0x140)](_0x5c3608(0xe9)+_0x1b6dce[_0x5c3608(0xdd)]+'\x20for\x20shop\x20'+_0xb10f3d['id']+_0x5c3608(0x128)+_0x4201d8+'%');break;}}}catch(_0x513dbf){console['error'](_0x5c3608(0x172)+_0xb10f3d['id']+':',_0x513dbf);}const _0x348e30=_0x1b6dce['_sum']?.[_0x5c3608(0xc1)]||0x0,_0x30f53f=_0x348e30*(0x1-_0x4201d8/0x64);return{'gateway':_0x1b6dce[_0x5c3608(0xdd)],'count':_0x1b6dce['_count']?.['id']||0x0,'amountUSDT':Math[_0x5c3608(0xf0)](_0x348e30*0x64)/0x64,'amountAfterCommissionUSDT':Math[_0x5c3608(0xf0)](_0x30f53f*0x64)/0x64,'commission':_0x4201d8};})),_0x477e12=_0x29772d[_0x56cd29(0x174)]((_0x4651ec,_0x5512c8)=>_0x4651ec+_0x5512c8[_0x56cd29(0xc1)],0x0),_0x289f3b=_0xb10f3d[_0x56cd29(0xee)];return console[_0x56cd29(0x140)]('💰\x20[PAYOUT]\x20Merchant\x20'+_0xb10f3d['username']+':'),console[_0x56cd29(0x140)](_0x56cd29(0x180)+_0x477e12['toFixed'](0x2)+_0x56cd29(0x17f)),console['log'](_0x56cd29(0x163)+_0x29772d[_0x56cd29(0x174)]((_0x569ad5,_0x1ca3de)=>_0x569ad5+_0x1ca3de[_0x56cd29(0x134)],0x0)[_0x56cd29(0x1b4)](0x2)+_0x56cd29(0xc5)),console[_0x56cd29(0x140)]('\x20\x20\x20✅\x20Actual\x20available\x20balance:\x20'+_0x289f3b[_0x56cd29(0x1b4)](0x2)+_0x56cd29(0xd6)),{'id':_0xb10f3d['id'],'fullName':_0xb10f3d[_0x56cd29(0x15f)],'username':_0xb10f3d[_0x56cd29(0x1ba)],'telegramId':_0xb10f3d[_0x56cd29(0x13c)],'merchantUrl':_0xb10f3d[_0x56cd29(0x188)],'wallets':{'usdtPolygonWallet':_0xb10f3d['usdtPolygonWallet'],'usdtTrcWallet':_0xb10f3d[_0x56cd29(0xbd)],'usdtErcWallet':_0xb10f3d[_0x56cd29(0x14c)],'usdcPolygonWallet':_0xb10f3d[_0x56cd29(0x1b1)]},'totalAmountUSDT':Math[_0x56cd29(0xf0)](_0x477e12*0x64)/0x64,'totalAmountAfterCommissionUSDT':Math[_0x56cd29(0xf0)](_0x289f3b*0x64)/0x64,'totalPayout':Math[_0x56cd29(0xf0)](_0x139bcb*0x64)/0x64,'thisMonth':Math[_0x56cd29(0xf0)](_0x4ce8b4*0x64)/0x64,'paymentsCount':_0x3ea919,'oldestPaymentDate':_0x48dae5?.[_0x56cd29(0x111)]||_0xb10f3d[_0x56cd29(0x144)],'gatewayBreakdown':_0x29772d};})),_0x136922=_0x90ed5b[_0x5ceeda(0x174)]((_0x9d8e9b,_0xdcac8)=>_0x9d8e9b+_0xdcac8[_0x5ceeda(0x15a)],0x0),_0xcb52a9=_0x90ed5b[_0x5ceeda(0x174)]((_0x33fc9b,_0x578950)=>_0x33fc9b+_0x578950[_0x5ceeda(0x12b)],0x0),_0x4e1504=_0x90ed5b[_0x5ceeda(0x174)]((_0x8cedc5,_0x88b73a)=>_0x8cedc5+_0x88b73a[_0x5ceeda(0x8e)],0x0),_0x4c9c09=_0x90ed5b[_0x5ceeda(0x174)]((_0x4de373,_0x48de57)=>_0x4de373+_0x48de57['thisMonth'],0x0);return console[_0x5ceeda(0x140)]('📊\x20Merchants\x20awaiting\x20payout:\x20'+_0xe5462+_0x5ceeda(0xc8)),console[_0x5ceeda(0x140)](_0x5ceeda(0xf3)+Math[_0x5ceeda(0xf0)](_0x136922*0x64)/0x64+'\x20USDT\x20(gross\x20revenue)'),console[_0x5ceeda(0x140)](_0x5ceeda(0xad)+Math[_0x5ceeda(0xf0)](_0xcb52a9*0x64)/0x64+_0x5ceeda(0x153)),console['log']('\x20\x20\x20💸\x20Total\x20payouts\x20(all\x20time):\x20'+Math[_0x5ceeda(0xf0)](_0x4e1504*0x64)/0x64+_0x5ceeda(0x19e)),console[_0x5ceeda(0x140)](_0x5ceeda(0xd9)+Math['round'](_0x4c9c09*0x64)/0x64+_0x5ceeda(0x19e)),{'merchants':_0x90ed5b,'pagination':{'page':_0x5cc4be,'limit':_0x122795,'total':_0xe5462,'totalPages':Math[_0x5ceeda(0x8a)](_0xe5462/_0x122795)},'summary':{'totalMerchants':_0xe5462,'totalAmountUSDT':Math[_0x5ceeda(0xf0)](_0x136922*0x64)/0x64,'totalAmountAfterCommissionUSDT':Math[_0x5ceeda(0xf0)](_0xcb52a9*0x64)/0x64,'totalPayout':Math['round'](_0x4e1504*0x64)/0x64,'thisMonth':Math[_0x5ceeda(0xf0)](_0x4c9c09*0x64)/0x64}};}async[a36_0x513ef4(0xce)](_0x477659){const _0x58f61e=a36_0x513ef4,{shopId:_0x123e09,amount:_0x5ab6ec,network:_0x18fe4a,wallet:_0x5c506a,notes:_0x4808fc,txid:_0x20147c,periodFrom:_0x2885dc,periodTo:_0xf1e847}=_0x477659,_0x891bb7=await database_1[_0x58f61e(0x10e)][_0x58f61e(0x19b)](async _0xad4689=>{const _0x435301=_0x58f61e,_0x5186ed=await _0xad4689[_0x435301(0xe5)][_0x435301(0x164)]({'where':{'id':_0x123e09},'select':{'id':!![],'name':!![],'username':!![],'balance':!![],'totalPaidOut':!![]}});if(!_0x5186ed)throw new Error(_0x435301(0x9b));console[_0x435301(0x140)](_0x435301(0xf5)+_0x5186ed['username']+':'),console[_0x435301(0x140)]('\x20\x20\x20Current\x20balance:\x20'+_0x5186ed[_0x435301(0xee)][_0x435301(0x1b4)](0x6)+_0x435301(0x19e)),console[_0x435301(0x140)](_0x435301(0x1ad)+_0x5ab6ec['toFixed'](0x6)+_0x435301(0x19e)),console[_0x435301(0x140)]('\x20\x20\x20Current\x20total\x20paid\x20out:\x20'+_0x5186ed[_0x435301(0x1b9)][_0x435301(0x1b4)](0x6)+_0x435301(0x19e));if(_0x20147c)console[_0x435301(0x140)](_0x435301(0x83)+_0x20147c);if(_0x5186ed[_0x435301(0xee)]<_0x5ab6ec)throw new Error(_0x435301(0x12a)+_0x5186ed['balance'][_0x435301(0x1b4)](0x6)+'\x20USDT,\x20Requested:\x20'+_0x5ab6ec[_0x435301(0x1b4)](0x6)+_0x435301(0x19e));let _0x3f0547=_0x5c506a;if(!_0x3f0547){const _0x502088=await _0xad4689[_0x435301(0xe5)][_0x435301(0x164)]({'where':{'id':_0x123e09},'select':{'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![]}});if(_0x502088)switch(_0x18fe4a){case _0x435301(0xa9):_0x3f0547=_0x502088[_0x435301(0x165)]||undefined;break;case'trc20':_0x3f0547=_0x502088[_0x435301(0xbd)]||undefined;break;case _0x435301(0xe6):_0x3f0547=_0x502088['usdtErcWallet']||undefined;break;case _0x435301(0x1a3):_0x3f0547=_0x502088[_0x435301(0x1b1)]||undefined;break;}}console[_0x435301(0x140)](_0x435301(0xbc)+_0x18fe4a+':\x20'+(_0x3f0547||'not\x20specified'));const _0x36cc26=await _0xad4689[_0x435301(0xdc)]['create']({'data':{'shopId':_0x123e09,'amount':_0x5ab6ec,'network':_0x18fe4a,'status':'COMPLETED','txid':_0x20147c,'notes':_0x4808fc,'periodFrom':_0x2885dc?new Date(_0x2885dc):null,'periodTo':_0xf1e847?new Date(_0xf1e847):null,'createdAt':new Date(),'paidAt':new Date()}}),_0x40c076=_0x5186ed[_0x435301(0xee)]-_0x5ab6ec,_0x470d66=_0x5186ed['totalPaidOut']+_0x5ab6ec;return await _0xad4689[_0x435301(0xe5)][_0x435301(0x87)]({'where':{'id':_0x123e09},'data':{'balance':_0x40c076,'totalPaidOut':_0x470d66}}),console[_0x435301(0x140)](_0x435301(0xb8)+_0x5186ed[_0x435301(0x1ba)]+_0x435301(0x103)),console[_0x435301(0x140)](_0x435301(0xb0)+_0x5186ed[_0x435301(0xee)][_0x435301(0x1b4)](0x6)+'\x20->\x20'+_0x40c076[_0x435301(0x1b4)](0x6)+_0x435301(0x1ab)+_0x5ab6ec[_0x435301(0x1b4)](0x6)+')'),console[_0x435301(0x140)]('\x20\x20\x20Total\x20paid\x20out:\x20'+_0x5186ed[_0x435301(0x1b9)][_0x435301(0x1b4)](0x6)+_0x435301(0xcb)+_0x470d66[_0x435301(0x1b4)](0x6)+_0x435301(0xb3)+_0x5ab6ec[_0x435301(0x1b4)](0x6)+')'),{'payout':_0x36cc26,'shop':_0x5186ed};});return console[_0x58f61e(0x140)](_0x58f61e(0x17d)+_0x891bb7[_0x58f61e(0xdc)]['id']+'\x20for\x20shop\x20'+_0x891bb7['shop'][_0x58f61e(0x1ba)]+'\x20('+_0x5ab6ec+_0x58f61e(0xec)),{'id':_0x891bb7['payout']['id'],'shopId':_0x891bb7[_0x58f61e(0xdc)][_0x58f61e(0x90)],'shopName':_0x891bb7[_0x58f61e(0xe5)][_0x58f61e(0x15f)],'shopUsername':_0x891bb7['shop'][_0x58f61e(0x1ba)],'amount':_0x891bb7[_0x58f61e(0xdc)]['amount'],'network':_0x891bb7[_0x58f61e(0xdc)][_0x58f61e(0x142)],'status':_0x891bb7['payout'][_0x58f61e(0x169)],'txid':_0x891bb7[_0x58f61e(0xdc)]['txid'],'notes':_0x891bb7[_0x58f61e(0xdc)][_0x58f61e(0x1a5)],'periodFrom':_0x891bb7['payout'][_0x58f61e(0x11d)],'periodTo':_0x891bb7[_0x58f61e(0xdc)][_0x58f61e(0x97)],'createdAt':_0x891bb7[_0x58f61e(0xdc)][_0x58f61e(0x144)],'paidAt':_0x891bb7[_0x58f61e(0xdc)][_0x58f61e(0x111)]};}async[a36_0x513ef4(0x170)](_0x59a71a){const _0xcf65d5=a36_0x513ef4,{page:_0x1805eb,limit:_0x105dd9,shopId:_0x4f6d6b,network:_0xc20ce7,dateFrom:_0x310f41,dateTo:_0x293f36,search:_0xbba420}=_0x59a71a,_0x524b86=(_0x1805eb-0x1)*_0x105dd9,_0x51a4d4={};_0x4f6d6b&&(_0x51a4d4['shopId']=_0x4f6d6b);_0xc20ce7&&(_0x51a4d4['network']=_0xc20ce7);(_0x310f41||_0x293f36)&&(_0x51a4d4['createdAt']={},_0x310f41&&(_0x51a4d4['createdAt'][_0xcf65d5(0xa1)]=new Date(_0x310f41)),_0x293f36&&(_0x51a4d4[_0xcf65d5(0x144)][_0xcf65d5(0x182)]=new Date(_0x293f36)));_0xbba420&&(_0x51a4d4['OR']=[{'shop':{'name':{'contains':_0xbba420,'mode':_0xcf65d5(0xd4)}}},{'shop':{'username':{'contains':_0xbba420,'mode':'insensitive'}}},{'notes':{'contains':_0xbba420,'mode':_0xcf65d5(0xd4)}}]);const [_0x250828,_0x3089ae]=await Promise['all']([database_1['default'][_0xcf65d5(0xdc)][_0xcf65d5(0xcd)]({'where':_0x51a4d4,'skip':_0x524b86,'take':_0x105dd9,'orderBy':{'createdAt':_0xcf65d5(0x146)},'select':{'id':!![],'shopId':!![],'amount':!![],'network':!![],'status':!![],'txid':!![],'notes':!![],'periodFrom':!![],'periodTo':!![],'createdAt':!![],'paidAt':!![],'shop':{'select':{'name':!![],'username':!![]}}}}),database_1[_0xcf65d5(0x10e)][_0xcf65d5(0xdc)][_0xcf65d5(0xde)]({'where':_0x51a4d4})]);return{'payouts':_0x250828[_0xcf65d5(0x17b)](_0x4865f4=>({'id':_0x4865f4['id'],'shopId':_0x4865f4[_0xcf65d5(0x90)],'shopName':_0x4865f4[_0xcf65d5(0xe5)][_0xcf65d5(0x15f)],'shopUsername':_0x4865f4['shop']['username'],'amount':_0x4865f4[_0xcf65d5(0xf2)],'network':_0x4865f4[_0xcf65d5(0x142)],'status':_0x4865f4[_0xcf65d5(0x169)],'txid':_0x4865f4[_0xcf65d5(0xa5)],'notes':_0x4865f4[_0xcf65d5(0x1a5)],'periodFrom':_0x4865f4[_0xcf65d5(0x11d)],'periodTo':_0x4865f4[_0xcf65d5(0x97)],'createdAt':_0x4865f4[_0xcf65d5(0x144)],'paidAt':_0x4865f4['paidAt']})),'pagination':{'page':_0x1805eb,'limit':_0x105dd9,'total':_0x3089ae,'totalPages':Math[_0xcf65d5(0x8a)](_0x3089ae/_0x105dd9)}};}async[a36_0x513ef4(0xe8)](_0x2d3360){const _0x3e9ad5=a36_0x513ef4,_0x4aab04=await database_1[_0x3e9ad5(0x10e)][_0x3e9ad5(0xdc)][_0x3e9ad5(0x164)]({'where':{'id':_0x2d3360},'include':{'shop':{'select':{'name':!![],'username':!![]}}}});if(!_0x4aab04)return null;return{'id':_0x4aab04['id'],'shopId':_0x4aab04[_0x3e9ad5(0x90)],'shopName':_0x4aab04[_0x3e9ad5(0xe5)][_0x3e9ad5(0x15f)],'shopUsername':_0x4aab04[_0x3e9ad5(0xe5)][_0x3e9ad5(0x1ba)],'amount':_0x4aab04['amount'],'network':_0x4aab04[_0x3e9ad5(0x142)],'status':_0x4aab04['status'],'txid':_0x4aab04[_0x3e9ad5(0xa5)],'notes':_0x4aab04['notes'],'periodFrom':_0x4aab04[_0x3e9ad5(0x11d)],'periodTo':_0x4aab04[_0x3e9ad5(0x97)],'createdAt':_0x4aab04['createdAt'],'paidAt':_0x4aab04[_0x3e9ad5(0x111)]};}async['deletePayout'](_0x276292){const _0x4a62ba=a36_0x513ef4;await database_1[_0x4a62ba(0x10e)][_0x4a62ba(0xdc)]['delete']({'where':{'id':_0x276292}});}async['getAllPayments'](_0x45317c){const _0x9f95a2=a36_0x513ef4,{page:_0x5d8c28,limit:_0x55f131,status:_0x7990cb,gateway:_0x4754cd,shopId:_0x469d5a,dateFrom:_0x2806c5,dateTo:_0xaa63e4,search:_0x5d4cca,currency:_0x1d79b2,sortBy:_0x4dd505,sortOrder:_0xad0a0}=_0x45317c,_0x558e40=(_0x5d8c28-0x1)*_0x55f131;console[_0x9f95a2(0x140)](_0x9f95a2(0x91),_0x45317c);const _0x4b1fad=await database_1[_0x9f95a2(0x10e)][_0x9f95a2(0x141)][_0x9f95a2(0x178)]({'by':['gateway'],'_count':{'gateway':!![]}});console[_0x9f95a2(0x140)](_0x9f95a2(0xcc),_0x4b1fad['map'](_0x1be8ef=>_0x1be8ef['gateway']+'\x20('+_0x1be8ef[_0x9f95a2(0xf7)][_0x9f95a2(0xdd)]+_0x9f95a2(0x132)));if(_0x4754cd){const _0x5199ea=_0x4b1fad[_0x9f95a2(0xc7)](_0x1972d5=>_0x1972d5['gateway'][_0x9f95a2(0x193)]()===_0x4754cd['toLowerCase']());!_0x5199ea&&_0x4754cd[_0x9f95a2(0x193)]()!==_0x9f95a2(0x123)&&console[_0x9f95a2(0x140)](_0x9f95a2(0xea)+_0x4754cd+_0x9f95a2(0x8f)+_0x4b1fad['map'](_0x14eddf=>_0x14eddf[_0x9f95a2(0xdd)])[_0x9f95a2(0x92)](',\x20'));}const _0x378452={};_0x7990cb&&(_0x378452[_0x9f95a2(0x169)]=_0x7990cb['toUpperCase']());if(!_0x4754cd)_0x378452['gateway']={'not':_0x9f95a2(0x123)};else{if(_0x4754cd&&(_0x4754cd['toLowerCase']()===_0x9f95a2(0x123)||_0x4754cd==='0000'))_0x378452[_0x9f95a2(0xdd)]='test_gateway';else{let _0x4920e5=_0x4754cd;const _0x57acaa=(0x0,gateway_1[_0x9f95a2(0xc0)])(_0x4754cd);if(_0x57acaa)_0x4920e5=_0x57acaa,console[_0x9f95a2(0x140)](_0x9f95a2(0x117)+_0x4754cd+'\x27\x20to\x20name\x20\x27'+_0x4920e5+'\x27');else{const _0x2b60ea=(0x0,gateway_1['getGatewayIdByName'])(_0x4754cd);if(_0x2b60ea){const _0x372cd8=(0x0,gateway_1[_0x9f95a2(0xc0)])(_0x2b60ea);_0x372cd8&&(_0x4920e5=_0x372cd8,console[_0x9f95a2(0x140)](_0x9f95a2(0xd3)+_0x4754cd+_0x9f95a2(0x1a6)+_0x2b60ea+_0x9f95a2(0xb7)+_0x4920e5+'\x27'));}else console[_0x9f95a2(0x140)]('🔍\x20Using\x20gateway\x20\x27'+_0x4754cd+_0x9f95a2(0xd2));}const _0x5170a0=await database_1[_0x9f95a2(0x10e)][_0x9f95a2(0x141)][_0x9f95a2(0xde)]({'where':{'gateway':_0x4920e5[_0x9f95a2(0x193)]()},'take':0x1});_0x5170a0===0x0?(console[_0x9f95a2(0x140)](_0x9f95a2(0xeb)+_0x4920e5+'\x27\x20(from\x20\x27'+_0x4754cd+_0x9f95a2(0x190)),_0x378452[_0x9f95a2(0xdd)]=_0x9f95a2(0x18b)):(_0x378452[_0x9f95a2(0xdd)]=_0x4920e5[_0x9f95a2(0x193)](),console[_0x9f95a2(0x140)]('✅\x20Using\x20gateway\x20filter:\x20\x27'+_0x4920e5+_0x9f95a2(0xed)+_0x4754cd+'\x27)'));}}console[_0x9f95a2(0x140)](_0x9f95a2(0xdf),_0x378452[_0x9f95a2(0xdd)]);_0x469d5a&&(_0x378452['shopId']=_0x469d5a);_0x1d79b2&&(_0x378452[_0x9f95a2(0x158)]=_0x1d79b2['toUpperCase'](),console[_0x9f95a2(0x140)](_0x9f95a2(0x16d)+_0x1d79b2['toUpperCase']()));(_0x2806c5||_0xaa63e4)&&(_0x378452[_0x9f95a2(0x144)]={},_0x2806c5&&(_0x378452[_0x9f95a2(0x144)][_0x9f95a2(0xa1)]=new Date(_0x2806c5)),_0xaa63e4&&(_0x378452['createdAt'][_0x9f95a2(0x182)]=new Date(_0xaa63e4)));_0x5d4cca&&(_0x378452['OR']=[{'id':{'contains':_0x5d4cca,'mode':_0x9f95a2(0xd4)}},{'orderId':{'contains':_0x5d4cca,'mode':_0x9f95a2(0xd4)}},{'gatewayOrderId':{'contains':_0x5d4cca,'mode':_0x9f95a2(0xd4)}},{'customerEmail':{'contains':_0x5d4cca,'mode':'insensitive'}},{'shop':{'name':{'contains':_0x5d4cca,'mode':_0x9f95a2(0xd4)}}},{'shop':{'username':{'contains':_0x5d4cca,'mode':_0x9f95a2(0xd4)}}}]);console['log']('📊\x20Final\x20WHERE\x20conditions:',JSON['stringify'](_0x378452,null,0x2));let _0x162046={'createdAt':'desc'};if(_0x4dd505){const _0xb4c307=[_0x9f95a2(0xf2),_0x9f95a2(0x144),_0x9f95a2(0xb2),'status',_0x9f95a2(0xdd),'currency'],_0x56e1f4=['asc',_0x9f95a2(0x146)];if(_0xb4c307[_0x9f95a2(0xc9)](_0x4dd505)){const _0x398e3=_0x56e1f4[_0x9f95a2(0xc9)](_0xad0a0)?_0xad0a0:_0x9f95a2(0x146);_0x162046={[_0x4dd505]:_0x398e3},console['log'](_0x9f95a2(0xf9)+_0x4dd505+_0x9f95a2(0x1a0)+_0x398e3+'\x20order');}}const [_0x4860c0,_0x20f390]=await Promise[_0x9f95a2(0x17c)]([database_1['default'][_0x9f95a2(0x141)][_0x9f95a2(0xcd)]({'where':_0x378452,'skip':_0x558e40,'take':_0x55f131,'orderBy':_0x162046}),database_1[_0x9f95a2(0x10e)][_0x9f95a2(0x141)][_0x9f95a2(0xde)]({'where':_0x378452})]);return{'payments':_0x4860c0,'pagination':{'page':_0x5d8c28,'limit':_0x55f131,'total':_0x20f390,'totalPages':Math[_0x9f95a2(0x8a)](_0x20f390/_0x55f131)}};}async[a36_0x513ef4(0x187)](_0x2aa991){const _0x2e6e3d=a36_0x513ef4,_0x44e748=await database_1['default']['payment']['findUnique']({'where':{'id':_0x2aa991},'select':{'id':!![],'shopId':!![],'amount':!![],'amountAfterGatewayCommissionUSDT':!![],'currency':!![],'sourceCurrency':!![],'status':!![],'gateway':!![],'orderId':!![],'gatewayOrderId':!![],'gatewayPaymentId':!![],'customerEmail':!![],'customerName':!![],'customerCountry':!![],'customerIp':!![],'customerUa':!![],'externalPaymentUrl':!![],'successUrl':!![],'failUrl':!![],'pendingUrl':!![],'whiteUrl':!![],'expiresAt':!![],'invoiceTotalSum':!![],'qrCode':!![],'qrUrl':!![],'country':!![],'language':!![],'amountIsEditable':!![],'maxPayments':!![],'rapydCustomer':!![],'cardLast4':!![],'paymentMethod':!![],'bankId':!![],'remitterIban':!![],'remitterName':!![],'failureMessage':!![],'usage':!![],'createdAt':!![],'updatedAt':!![],'shop':{'select':{'name':!![],'username':!![]}}}});if(!_0x44e748)return null;return{'id':_0x44e748['id'],'shopId':_0x44e748['shopId'],'gateway':_0x44e748[_0x2e6e3d(0xdd)],'amount':_0x44e748[_0x2e6e3d(0xf2)],'currency':_0x44e748[_0x2e6e3d(0x158)],'status':_0x44e748[_0x2e6e3d(0x169)],'orderId':_0x44e748['orderId'],'gatewayOrderId':_0x44e748[_0x2e6e3d(0xf8)],'customerEmail':_0x44e748['customerEmail'],'customerName':_0x44e748['customerName'],'customerCountry':_0x44e748[_0x2e6e3d(0xf1)],'customerIp':_0x44e748[_0x2e6e3d(0xa6)],'customerUa':_0x44e748[_0x2e6e3d(0x157)],'failureMessage':_0x44e748[_0x2e6e3d(0x1a7)],'externalPaymentUrl':_0x44e748['externalPaymentUrl'],'successUrl':_0x44e748['successUrl'],'failUrl':_0x44e748[_0x2e6e3d(0x113)],'pendingUrl':_0x44e748[_0x2e6e3d(0xb9)],'whiteUrl':_0x44e748[_0x2e6e3d(0x13b)],'createdAt':_0x44e748[_0x2e6e3d(0x144)],'updatedAt':_0x44e748['updatedAt'],'shop':_0x44e748[_0x2e6e3d(0xe5)]};}async[a36_0x513ef4(0x17e)](_0x1e6e7e,_0x9943cd,_0x2e72b7,_0x50d23a){const _0x38bfd8=a36_0x513ef4,_0x847eab=await database_1[_0x38bfd8(0x10e)]['$transaction'](async _0x2a4cff=>{const _0x56cbb4=_0x38bfd8,_0x581a9e=await _0x2a4cff[_0x56cbb4(0x141)]['findUnique']({'where':{'id':_0x1e6e7e},'include':{'shop':{'select':{'id':!![],'name':!![],'username':!![],'balance':!![]}}}});if(!_0x581a9e)throw new Error(_0x56cbb4(0x122));const _0x29acc6=_0x581a9e['status'],_0x2269c9=_0x9943cd[_0x56cbb4(0x171)]();console[_0x56cbb4(0x140)](_0x56cbb4(0x114)+_0x1e6e7e+_0x56cbb4(0x106)+_0x29acc6+_0x56cbb4(0xcb)+_0x2269c9),console[_0x56cbb4(0x140)](_0x56cbb4(0xac)+_0x581a9e[_0x56cbb4(0xe5)][_0x56cbb4(0xee)]+_0x56cbb4(0x19e));const _0x20c003={'status':_0x2269c9,'updatedAt':new Date(),'statusChangedBy':_0x56cbb4(0xe4),'statusChangedAt':new Date()};_0x2e72b7&&(_0x20c003[_0x56cbb4(0x96)]=_0x2e72b7);_0x2269c9===_0x56cbb4(0x14f)&&_0x50d23a&&(_0x20c003[_0x56cbb4(0x88)]=_0x50d23a);let _0x5a7f54=0x0,_0x579c01=_0x581a9e['shop']['balance'];if(_0x2269c9==='PAID'&&_0x29acc6!=='PAID'){_0x20c003['paidAt']=new Date();const _0x32830a=await currencyService_1[_0x56cbb4(0xe0)][_0x56cbb4(0x185)](_0x581a9e['amount'],_0x581a9e[_0x56cbb4(0x158)]);_0x20c003[_0x56cbb4(0xc1)]=_0x32830a;let _0x2756a6=0xa;const _0x34351d=await _0x2a4cff['shop'][_0x56cbb4(0x164)]({'where':{'id':_0x581a9e[_0x56cbb4(0x90)]},'select':{'gatewaySettings':!![]}});if(_0x34351d?.[_0x56cbb4(0xdb)])try{const _0x177807=JSON['parse'](_0x34351d[_0x56cbb4(0xdb)]);for(const [_0x2322f2,_0x131898]of Object[_0x56cbb4(0xa8)](_0x177807)){if(_0x2322f2['toLowerCase']()===_0x581a9e[_0x56cbb4(0xdd)]['toLowerCase']()){_0x2756a6=_0x131898[_0x56cbb4(0x112)]||0xa;break;}}}catch(_0x2e656d){console[_0x56cbb4(0x149)](_0x56cbb4(0x166)+_0x1e6e7e+':',_0x2e656d);}let _0x2c7e12;_0x581a9e[_0x56cbb4(0x110)]!==null&&_0x581a9e[_0x56cbb4(0x110)]!==undefined?(_0x2c7e12=_0x581a9e[_0x56cbb4(0x110)],console[_0x56cbb4(0x140)](_0x56cbb4(0x1bb)+_0x2c7e12[_0x56cbb4(0x1b4)](0x6)+_0x56cbb4(0x9f)+_0x1e6e7e)):(_0x2c7e12=_0x32830a*(0x1-_0x2756a6/0x64),console['log']('📊\x20[ADMIN]\x20Calculating\x20commission\x20manually\x20for\x20payment\x20'+_0x1e6e7e+':\x20'+_0x2756a6+_0x56cbb4(0x14a)+_0x32830a[_0x56cbb4(0x1b4)](0x6)+_0x56cbb4(0x19e)),_0x20c003[_0x56cbb4(0x110)]=_0x2c7e12),_0x5a7f54=_0x2c7e12,_0x579c01+=_0x2c7e12,console[_0x56cbb4(0x140)](_0x56cbb4(0x11c)+_0x1e6e7e+'\x20became\x20PAID:'),console['log'](_0x56cbb4(0x12e)+_0x32830a[_0x56cbb4(0x1b4)](0x6)+'\x20USDT'),console[_0x56cbb4(0x140)](_0x56cbb4(0xbe)+_0x581a9e[_0x56cbb4(0xdd)]+_0x56cbb4(0x13f)+_0x2756a6+'%'),console['log'](_0x56cbb4(0x161)+_0x2c7e12[_0x56cbb4(0x1b4)](0x6)+'\x20USDT\x20(after\x20'+_0x2756a6+_0x56cbb4(0x13e)),console[_0x56cbb4(0x140)](_0x56cbb4(0x102)+_0x2c7e12[_0x56cbb4(0x1b4)](0x6)+_0x56cbb4(0x19e));}else{if(_0x29acc6===_0x56cbb4(0x197)&&_0x2269c9!==_0x56cbb4(0x197)){if(_0x581a9e[_0x56cbb4(0xc1)]){let _0x134934=0xa;const _0x594071=await _0x2a4cff[_0x56cbb4(0xe5)][_0x56cbb4(0x164)]({'where':{'id':_0x581a9e['shopId']},'select':{'gatewaySettings':!![]}});if(_0x594071?.['gatewaySettings'])try{const _0x44af19=JSON[_0x56cbb4(0x18c)](_0x594071[_0x56cbb4(0xdb)]);for(const [_0x35efee,_0x44360a]of Object[_0x56cbb4(0xa8)](_0x44af19)){if(_0x35efee[_0x56cbb4(0x193)]()===_0x581a9e[_0x56cbb4(0xdd)][_0x56cbb4(0x193)]()){_0x134934=_0x44360a[_0x56cbb4(0x112)]||0xa;break;}}}catch(_0x3b5f77){console[_0x56cbb4(0x149)]('Error\x20parsing\x20gateway\x20settings\x20for\x20payment\x20'+_0x1e6e7e+':',_0x3b5f77);}const _0x3d5918=_0x581a9e[_0x56cbb4(0xc1)]*(0x1-_0x134934/0x64);_0x5a7f54=-_0x3d5918,_0x579c01-=_0x3d5918,_0x20c003[_0x56cbb4(0xc1)]=null,_0x20c003[_0x56cbb4(0x110)]=null,console[_0x56cbb4(0x140)](_0x56cbb4(0x11c)+_0x1e6e7e+_0x56cbb4(0x85)),console['log'](_0x56cbb4(0x12e)+_0x581a9e[_0x56cbb4(0xc1)]['toFixed'](0x6)+_0x56cbb4(0x19e)),console[_0x56cbb4(0x140)](_0x56cbb4(0xbe)+_0x581a9e['gateway']+_0x56cbb4(0x13f)+_0x134934+'%'),console[_0x56cbb4(0x140)](_0x56cbb4(0x176)+_0x3d5918[_0x56cbb4(0x1b4)](0x6)+_0x56cbb4(0x191)+_0x134934+'%\x20commission)'),console[_0x56cbb4(0x140)](_0x56cbb4(0xe3)+_0x3d5918[_0x56cbb4(0x1b4)](0x6)+_0x56cbb4(0x19e));}}}_0x2269c9===_0x56cbb4(0x14f)&&(_0x29acc6===_0x56cbb4(0x197)&&_0x581a9e[_0x56cbb4(0xc1)]&&console[_0x56cbb4(0x140)](_0x56cbb4(0x11f)),_0x50d23a&&_0x50d23a>0x0&&(_0x5a7f54-=_0x50d23a,_0x579c01-=_0x50d23a,console['log'](_0x56cbb4(0xa4)+_0x50d23a['toFixed'](0x6)+_0x56cbb4(0x1b7))));_0x2269c9===_0x56cbb4(0x107)&&_0x29acc6===_0x56cbb4(0x197)&&console[_0x56cbb4(0x140)](_0x56cbb4(0x133));const _0x2b4348=await _0x2a4cff[_0x56cbb4(0x141)][_0x56cbb4(0x87)]({'where':{'id':_0x1e6e7e},'data':_0x20c003,'include':{'shop':{'select':{'name':!![],'username':!![]}}}});return _0x5a7f54!==0x0&&(await _0x2a4cff['shop']['update']({'where':{'id':_0x581a9e['shopId']},'data':{'balance':_0x579c01}}),console[_0x56cbb4(0x140)](_0x56cbb4(0xb8)+_0x581a9e[_0x56cbb4(0x90)]+_0x56cbb4(0x86)+_0x581a9e[_0x56cbb4(0xe5)][_0x56cbb4(0xee)][_0x56cbb4(0x1b4)](0x6)+'\x20->\x20'+_0x579c01[_0x56cbb4(0x1b4)](0x6)+_0x56cbb4(0xb1)+(_0x5a7f54>0x0?'+':'')+_0x5a7f54[_0x56cbb4(0x1b4)](0x6)+')')),_0x2b4348;});return{'id':_0x847eab['id'],'shopId':_0x847eab[_0x38bfd8(0x90)],'gateway':_0x847eab[_0x38bfd8(0xdd)],'amount':_0x847eab[_0x38bfd8(0xf2)],'currency':_0x847eab[_0x38bfd8(0x158)],'status':_0x847eab[_0x38bfd8(0x169)],'orderId':_0x847eab['orderId'],'gatewayOrderId':_0x847eab['gatewayOrderId'],'customerEmail':_0x847eab[_0x38bfd8(0xa2)],'customerName':_0x847eab[_0x38bfd8(0x118)],'customerCountry':_0x847eab['customerCountry'],'customerIp':_0x847eab[_0x38bfd8(0xa6)],'customerUa':_0x847eab[_0x38bfd8(0x157)],'failureMessage':_0x847eab[_0x38bfd8(0x1a7)],'adminNotes':_0x847eab[_0x38bfd8(0x96)],'chargebackAmount':_0x847eab[_0x38bfd8(0x88)],'statusChangedBy':_0x847eab[_0x38bfd8(0x18d)],'statusChangedAt':_0x847eab['statusChangedAt'],'createdAt':_0x847eab[_0x38bfd8(0x144)],'updatedAt':_0x847eab[_0x38bfd8(0xb2)],'shop':_0x847eab['shop']};}async[a36_0x513ef4(0x109)](_0x3fbcb7,_0xa0d214){const _0x5698ec=a36_0x513ef4,_0x5089f7=Math[_0x5698ec(0x192)]()[_0x5698ec(0x125)](0x24)[_0x5698ec(0xfb)](0x2,0x9);console[_0x5698ec(0x140)](_0x5698ec(0xa0)+_0x5089f7+_0x5698ec(0x14e)+_0x3fbcb7);const _0x1176cf={..._0xa0d214};_0xa0d214[_0x5698ec(0xc3)]&&_0xa0d214[_0x5698ec(0xc3)][_0x5698ec(0xaa)]()!==''?(console[_0x5698ec(0x140)](_0x5698ec(0x135)+_0x5089f7+_0x5698ec(0x120)+_0x3fbcb7),_0x1176cf[_0x5698ec(0xc3)]=await bcryptjs_1[_0x5698ec(0x10e)][_0x5698ec(0xab)](_0xa0d214['password'],0xc)):(console[_0x5698ec(0x140)](_0x5698ec(0x135)+_0x5089f7+_0x5698ec(0x15c)),delete _0x1176cf[_0x5698ec(0xc3)]);_0xa0d214[_0x5698ec(0x15d)]&&(_0x1176cf[_0x5698ec(0x15f)]=_0xa0d214[_0x5698ec(0x15d)],delete _0x1176cf[_0x5698ec(0x15d)]);_0xa0d214['telegramId']&&(_0x1176cf['telegram']=_0xa0d214[_0x5698ec(0xc2)],delete _0x1176cf[_0x5698ec(0xc2)]);_0xa0d214[_0x5698ec(0x1b3)]&&(_0x1176cf['shopUrl']=_0xa0d214['merchantUrl'],delete _0x1176cf[_0x5698ec(0x1b3)]);if(_0xa0d214[_0x5698ec(0x168)]){const _0x543566=_0xa0d214[_0x5698ec(0x168)][_0x5698ec(0x17b)](_0x1c6a1f=>this['getGatewayInternalName'](_0x1c6a1f));console[_0x5698ec(0x140)](_0x5698ec(0x17a),_0xa0d214[_0x5698ec(0x168)],'->',_0x543566),_0x1176cf[_0x5698ec(0x194)]=JSON['stringify'](_0x543566),delete _0x1176cf[_0x5698ec(0x168)];}_0xa0d214['gatewaySettings']&&(console[_0x5698ec(0x140)](_0x5698ec(0x150)+_0x5089f7+_0x5698ec(0x147),_0xa0d214[_0x5698ec(0xdb)]),_0x1176cf[_0x5698ec(0xdb)]=JSON[_0x5698ec(0x16f)](_0xa0d214['gatewaySettings']),console[_0x5698ec(0x140)](_0x5698ec(0x150)+_0x5089f7+_0x5698ec(0x160),_0x1176cf['gatewaySettings']));_0xa0d214['wallets']&&(_0xa0d214[_0x5698ec(0x1b2)][_0x5698ec(0x165)]!==undefined&&(_0x1176cf[_0x5698ec(0x165)]=_0xa0d214[_0x5698ec(0x1b2)][_0x5698ec(0x165)]||null),_0xa0d214[_0x5698ec(0x1b2)][_0x5698ec(0xbd)]!==undefined&&(_0x1176cf[_0x5698ec(0xbd)]=_0xa0d214['wallets'][_0x5698ec(0xbd)]||null),_0xa0d214[_0x5698ec(0x1b2)][_0x5698ec(0x14c)]!==undefined&&(_0x1176cf['usdtErcWallet']=_0xa0d214['wallets'][_0x5698ec(0x14c)]||null),_0xa0d214[_0x5698ec(0x1b2)][_0x5698ec(0x1b1)]!==undefined&&(_0x1176cf[_0x5698ec(0x1b1)]=_0xa0d214[_0x5698ec(0x1b2)]['usdcPolygonWallet']||null),delete _0x1176cf[_0x5698ec(0x1b2)]);const _0x239c40=await database_1[_0x5698ec(0x10e)]['shop'][_0x5698ec(0x87)]({'where':{'id':_0x3fbcb7},'data':_0x1176cf,'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});return console[_0x5698ec(0x140)]('🎯\x20['+_0x5089f7+']\x20User\x20updated,\x20gatewaySettings\x20from\x20DB:',_0x239c40['gatewaySettings']),{'id':_0x239c40['id'],'fullName':_0x239c40[_0x5698ec(0x15f)],'username':_0x239c40[_0x5698ec(0x1ba)],'telegramId':_0x239c40[_0x5698ec(0x13c)],'merchantUrl':_0x239c40[_0x5698ec(0x188)],'gateways':_0x239c40[_0x5698ec(0x194)]?JSON['parse'](_0x239c40[_0x5698ec(0x194)]):null,'gatewaySettings':_0x239c40[_0x5698ec(0xdb)]?JSON['parse'](_0x239c40[_0x5698ec(0xdb)]):null,'publicKey':_0x239c40['publicKey'],'wallets':{'usdtPolygonWallet':_0x239c40[_0x5698ec(0x165)],'usdtTrcWallet':_0x239c40[_0x5698ec(0xbd)],'usdtErcWallet':_0x239c40[_0x5698ec(0x14c)],'usdcPolygonWallet':_0x239c40[_0x5698ec(0x1b1)]},'status':_0x239c40[_0x5698ec(0x169)],'createdAt':_0x239c40['createdAt']};}async['suspendUser'](_0xd7c9dc){const _0x1149b6=a36_0x513ef4,_0x4f4f99=await database_1[_0x1149b6(0x10e)]['shop']['update']({'where':{'id':_0xd7c9dc},'data':{'status':_0x1149b6(0xba)},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});return{'id':_0x4f4f99['id'],'fullName':_0x4f4f99[_0x1149b6(0x15f)],'username':_0x4f4f99['username'],'telegramId':_0x4f4f99[_0x1149b6(0x13c)],'merchantUrl':_0x4f4f99[_0x1149b6(0x188)],'gateways':_0x4f4f99[_0x1149b6(0x194)]?JSON[_0x1149b6(0x18c)](_0x4f4f99[_0x1149b6(0x194)]):null,'gatewaySettings':_0x4f4f99['gatewaySettings']?JSON[_0x1149b6(0x18c)](_0x4f4f99[_0x1149b6(0xdb)]):null,'publicKey':_0x4f4f99[_0x1149b6(0x10b)],'wallets':{'usdtPolygonWallet':_0x4f4f99['usdtPolygonWallet'],'usdtTrcWallet':_0x4f4f99[_0x1149b6(0xbd)],'usdtErcWallet':_0x4f4f99[_0x1149b6(0x14c)],'usdcPolygonWallet':_0x4f4f99[_0x1149b6(0x1b1)]},'status':_0x4f4f99[_0x1149b6(0x169)],'createdAt':_0x4f4f99[_0x1149b6(0x144)]};}async[a36_0x513ef4(0xa3)](_0x341e4c){const _0x1416e5=a36_0x513ef4,_0x510fb3=await database_1[_0x1416e5(0x10e)][_0x1416e5(0xe5)][_0x1416e5(0x87)]({'where':{'id':_0x341e4c},'data':{'status':'ACTIVE'},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});return{'id':_0x510fb3['id'],'fullName':_0x510fb3['name'],'username':_0x510fb3[_0x1416e5(0x1ba)],'telegramId':_0x510fb3[_0x1416e5(0x13c)],'merchantUrl':_0x510fb3[_0x1416e5(0x188)],'gateways':_0x510fb3[_0x1416e5(0x194)]?JSON['parse'](_0x510fb3[_0x1416e5(0x194)]):null,'gatewaySettings':_0x510fb3['gatewaySettings']?JSON['parse'](_0x510fb3['gatewaySettings']):null,'publicKey':_0x510fb3[_0x1416e5(0x10b)],'wallets':{'usdtPolygonWallet':_0x510fb3[_0x1416e5(0x165)],'usdtTrcWallet':_0x510fb3['usdtTrcWallet'],'usdtErcWallet':_0x510fb3['usdtErcWallet'],'usdcPolygonWallet':_0x510fb3[_0x1416e5(0x1b1)]},'status':_0x510fb3['status'],'createdAt':_0x510fb3[_0x1416e5(0x144)]};}async['getAllUsers'](_0x4e38f4){const _0x5e335f=a36_0x513ef4,{page:_0x3ff832,limit:_0x1bf660,status:_0x547090}=_0x4e38f4,_0x364b60=(_0x3ff832-0x1)*_0x1bf660,_0x2adb1f={};_0x547090&&(_0x2adb1f[_0x5e335f(0x169)]=_0x547090[_0x5e335f(0x171)]());const [_0x126fb9,_0x1238f1]=await Promise[_0x5e335f(0x17c)]([database_1['default'][_0x5e335f(0xe5)][_0x5e335f(0xcd)]({'where':_0x2adb1f,'skip':_0x364b60,'take':_0x1bf660,'orderBy':{'createdAt':_0x5e335f(0x146)},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}}),database_1[_0x5e335f(0x10e)]['shop'][_0x5e335f(0xde)]({'where':_0x2adb1f})]);return{'users':_0x126fb9['map'](_0x419a76=>{const _0x10db79=_0x5e335f,_0x1a3bc3=_0x419a76['paymentGateways']?JSON[_0x10db79(0x18c)](_0x419a76[_0x10db79(0x194)]):null,_0x37ae33=_0x1a3bc3?_0x1a3bc3[_0x10db79(0x17b)](_0xf4e75=>this['getGatewayDisplayName'](_0xf4e75)):null;return{'id':_0x419a76['id'],'fullName':_0x419a76[_0x10db79(0x15f)],'username':_0x419a76[_0x10db79(0x1ba)],'telegramId':_0x419a76[_0x10db79(0x13c)],'merchantUrl':_0x419a76[_0x10db79(0x188)],'gateways':_0x37ae33,'gatewaySettings':_0x419a76[_0x10db79(0xdb)]?JSON[_0x10db79(0x18c)](_0x419a76[_0x10db79(0xdb)]):null,'publicKey':_0x419a76[_0x10db79(0x10b)],'wallets':{'usdtPolygonWallet':_0x419a76[_0x10db79(0x165)],'usdtTrcWallet':_0x419a76[_0x10db79(0xbd)],'usdtErcWallet':_0x419a76[_0x10db79(0x14c)],'usdcPolygonWallet':_0x419a76[_0x10db79(0x1b1)]},'status':_0x419a76[_0x10db79(0x169)],'createdAt':_0x419a76[_0x10db79(0x144)]};}),'pagination':{'page':_0x3ff832,'limit':_0x1bf660,'total':_0x1238f1,'totalPages':Math['ceil'](_0x1238f1/_0x1bf660)}};}async[a36_0x513ef4(0x100)](_0x2cd6ba){const _0x3b5d72=a36_0x513ef4,_0x336ffe=await database_1['default'][_0x3b5d72(0xe5)][_0x3b5d72(0x164)]({'where':{'id':_0x2cd6ba},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});if(!_0x336ffe)return null;const _0x11f6cb=_0x336ffe[_0x3b5d72(0x194)]?JSON[_0x3b5d72(0x18c)](_0x336ffe[_0x3b5d72(0x194)]):null,_0x5e40f7=_0x11f6cb?_0x11f6cb[_0x3b5d72(0x17b)](_0x38a97f=>this[_0x3b5d72(0x11b)](_0x38a97f)):null;return _0x11f6cb&&_0x5e40f7&&console[_0x3b5d72(0x140)]('🔄\x20Gateway\x20mapping\x20(get):',_0x11f6cb,'->',_0x5e40f7),{'id':_0x336ffe['id'],'fullName':_0x336ffe[_0x3b5d72(0x15f)],'username':_0x336ffe['username'],'telegramId':_0x336ffe[_0x3b5d72(0x13c)],'merchantUrl':_0x336ffe[_0x3b5d72(0x188)],'gateways':_0x5e40f7,'gatewaySettings':_0x336ffe[_0x3b5d72(0xdb)]?JSON[_0x3b5d72(0x18c)](_0x336ffe[_0x3b5d72(0xdb)]):null,'publicKey':_0x336ffe[_0x3b5d72(0x10b)],'wallets':{'usdtPolygonWallet':_0x336ffe['usdtPolygonWallet'],'usdtTrcWallet':_0x336ffe['usdtTrcWallet'],'usdtErcWallet':_0x336ffe[_0x3b5d72(0x14c)],'usdcPolygonWallet':_0x336ffe['usdcPolygonWallet']},'status':_0x336ffe[_0x3b5d72(0x169)],'createdAt':_0x336ffe[_0x3b5d72(0x144)]};}async[a36_0x513ef4(0x173)](_0x5db7dd){const _0x1cd83e=a36_0x513ef4,{fullName:_0x3324f7,username:_0x5f2ca2,password:_0x1984bc,telegramId:_0x2dc3b5,merchantUrl:_0x2138af,gateways:_0x4a618b,gatewaySettings:_0x3bbaad,wallets:_0xcaf05}=_0x5db7dd,_0x1ab14a=await database_1[_0x1cd83e(0x10e)][_0x1cd83e(0xe5)][_0x1cd83e(0x164)]({'where':{'username':_0x5f2ca2}});if(_0x1ab14a)throw new Error(_0x1cd83e(0x13d));if(_0x2dc3b5){const _0x586297=await database_1['default'][_0x1cd83e(0xe5)]['findUnique']({'where':{'telegram':_0x2dc3b5}});if(_0x586297)throw new Error(_0x1cd83e(0x13a));}const _0x23dab6=await bcryptjs_1[_0x1cd83e(0x10e)][_0x1cd83e(0xab)](_0x1984bc,0xc),_0x35e2f9=_0x1cd83e(0x162)+crypto_1[_0x1cd83e(0x10e)][_0x1cd83e(0xc6)](0x20)[_0x1cd83e(0x125)](_0x1cd83e(0x105)),_0x3027d2='sk_'+crypto_1[_0x1cd83e(0x10e)]['randomBytes'](0x20)[_0x1cd83e(0x125)](_0x1cd83e(0x105)),_0x4e925c=_0x4a618b?_0x4a618b['map'](_0x6c0a6a=>this[_0x1cd83e(0x8c)](_0x6c0a6a)):null;_0x4a618b&&_0x4e925c&&console[_0x1cd83e(0x140)](_0x1cd83e(0x14b),_0x4a618b,'->',_0x4e925c);const _0x3f286f=await database_1[_0x1cd83e(0x10e)]['shop'][_0x1cd83e(0x1a4)]({'data':{'name':_0x3324f7,'username':_0x5f2ca2,'password':_0x23dab6,'telegram':_0x2dc3b5,'shopUrl':_0x2138af,'paymentGateways':_0x4e925c?JSON[_0x1cd83e(0x16f)](_0x4e925c):null,'gatewaySettings':_0x3bbaad?JSON[_0x1cd83e(0x16f)](_0x3bbaad):null,'usdtPolygonWallet':_0xcaf05?.['usdtPolygonWallet']||null,'usdtTrcWallet':_0xcaf05?.['usdtTrcWallet']||null,'usdtErcWallet':_0xcaf05?.[_0x1cd83e(0x14c)]||null,'usdcPolygonWallet':_0xcaf05?.['usdcPolygonWallet']||null,'publicKey':_0x35e2f9,'secretKey':_0x3027d2,'status':_0x1cd83e(0x115)},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});return{'id':_0x3f286f['id'],'fullName':_0x3f286f['name'],'username':_0x3f286f[_0x1cd83e(0x1ba)],'telegramId':_0x3f286f[_0x1cd83e(0x13c)],'merchantUrl':_0x3f286f[_0x1cd83e(0x188)],'gateways':_0x3f286f[_0x1cd83e(0x194)]?JSON['parse'](_0x3f286f[_0x1cd83e(0x194)]):null,'gatewaySettings':_0x3f286f['gatewaySettings']?JSON[_0x1cd83e(0x18c)](_0x3f286f[_0x1cd83e(0xdb)]):null,'publicKey':_0x3f286f[_0x1cd83e(0x10b)],'wallets':{'usdtPolygonWallet':_0x3f286f[_0x1cd83e(0x165)],'usdtTrcWallet':_0x3f286f[_0x1cd83e(0xbd)],'usdtErcWallet':_0x3f286f[_0x1cd83e(0x14c)],'usdcPolygonWallet':_0x3f286f['usdcPolygonWallet']},'status':_0x3f286f[_0x1cd83e(0x169)],'createdAt':_0x3f286f[_0x1cd83e(0x144)]};}async[a36_0x513ef4(0x101)](_0x13027f){const _0x1d9566=a36_0x513ef4;await database_1[_0x1d9566(0x10e)]['shop'][_0x1d9566(0x177)]({'where':{'id':_0x13027f}});}[a36_0x513ef4(0x139)](_0x3c0ffb,_0x14278b,_0x343dd8){const _0x2c0d63=a36_0x513ef4,_0x182725=new Map(),_0x1a1313=new Date(_0x14278b);while(_0x1a1313<=_0x343dd8){const _0x19053a=_0x1a1313[_0x2c0d63(0x15e)]()[_0x2c0d63(0x18f)]('T')[0x0];_0x182725[_0x2c0d63(0x11e)](_0x19053a,{'revenue':0x0,'count':0x0}),_0x1a1313[_0x2c0d63(0x143)](_0x1a1313['getDate']()+0x1);}for(const _0x83236c of _0x3c0ffb){const _0xebdd35=_0x83236c[_0x2c0d63(0x144)][_0x2c0d63(0x15e)]()[_0x2c0d63(0x18f)]('T')[0x0],_0x1bd72d=_0x182725[_0x2c0d63(0xaf)](_0xebdd35);_0x1bd72d&&(_0x1bd72d[_0x2c0d63(0xde)]+=0x1,_0x83236c['status']===_0x2c0d63(0x197)&&(_0x83236c[_0x2c0d63(0xc1)]?_0x1bd72d[_0x2c0d63(0x93)]+=_0x83236c[_0x2c0d63(0xc1)]:console[_0x2c0d63(0x140)](_0x2c0d63(0x136)+_0x83236c['id']+_0x2c0d63(0x9d))));}const _0xcaba69=[],_0xa03c84=[];for(const [_0x248df7,_0x3aad33]of _0x182725){_0xcaba69[_0x2c0d63(0x181)]({'date':_0x248df7,'amount':Math['round'](_0x3aad33[_0x2c0d63(0x93)]*0x64)/0x64}),_0xa03c84[_0x2c0d63(0x181)]({'date':_0x248df7,'count':_0x3aad33[_0x2c0d63(0xde)]});}return{'dailyRevenue':_0xcaba69,'dailyPayments':_0xa03c84};}}exports[a36_0x513ef4(0x12c)]=AdminService;