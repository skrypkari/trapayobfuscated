'use strict';function a36_0xe8ad(_0x3ecf8d,_0x547c99){const _0x11dfc0=a36_0x11df();return a36_0xe8ad=function(_0xe8ad47,_0x5c19a5){_0xe8ad47=_0xe8ad47-0xeb;let _0x13a984=_0x11dfc0[_0xe8ad47];return _0x13a984;},a36_0xe8ad(_0x3ecf8d,_0x547c99);}function a36_0x11df(){const _0x5acae5=['mastercard','entries','_sum','__importDefault','hex','update','30d','all','polygon_usdc','\x20USDT)','totalPaidOut','date','getDate','3790568VGnWpB','customerEmail','gateways','\x20\x20\x20�\x20Total\x20payments\x20turnover:\x20','availableBalance','⚠️\x20Payment\x20','./currencyService','usdtTrcWallet',']\x20Updating\x20password\x20for\x20user\x20','📊\x20Available\x20gateways\x20in\x20database:','failureMessage','🎯\x20[','admin','📊\x20Total\x20payments\x20(including\x20failed):\x20','pendingUrl','Payment\x20not\x20found','getGatewayNameById','🔄\x20Admin\x20updating\x20payment\x20','\x20\x20\x20📅\x20This\x20month:\x20','asc','crypto','log','totalAmountAfterCommissionUSDT','💱\x20Currency\x20filter\x20applied:\x20','plisio','\x20to\x20','\x20payments)','map','Username\x20already\x20exists','Insufficient\x20balance.\x20Available:\x20','\x20for\x20shop\x20','trim','currencyService','\x20\x20\x20👤\x20Merchant\x20earnings:\x20','substr',',\x20Commission:\x20','toISOString','erc20','\x20balance\x20updated:','error','amountAfterGatewayCommissionUSDT','%\x20from\x20','🔄\x20Gateway\x20mapping\x20(get):','\x20\x20\x20🌍\x20Country:\x20','aggregate','summary','2092797SDLASe','txid','\x20merchants\x20with\x20positive\x20balance','join','commissionUSDT','📊\x20Getting\x20merchant\x20statistics\x20with\x20filters:','_count','dailyPayments','network','📊\x20Using\x20saved\x20amountAfterGatewayCommissionUSDT:\x20','period','payment','\x20\x20\x20🔍\x20Raw\x20balance\x20sum:\x20','usdtPolygonWallet','lte','2944795fBauZv','fullName','\x20\x20\x20�\x20Total\x20paid\x20out:\x20','reduce','includes','\x27\x20as\x20is\x20(not\x20found\x20in\x20mappings)','\x20\x20\x20💰\x20Total\x20payout:\x20','PENDING','COMPLETED','Shop\x20not\x20found','noda','amountUSDT','generateDailyStatistics','90d','amount','💰\x20Payment\x20',',\x20successful:\x20','\x20in\x20','\x27\x20->\x20name\x20\x27','pendingPayout','paymentGateways','customerIp','statusChangedBy','8889yVHRov','chargebackAmount','getMerchantsAwaitingPayout','count','🔄\x20Converted\x20gateway\x20ID\x20\x27','split','convertToUSDT','toUpperCase','getMerchantsSelection','🔄\x20Updating\x20customer\x20data\x20for\x20payment\x20','getAllPayments','push','getFullYear','test_gateway','Noda','\x20\x20\x20📊\x20Commission\x20difference:\x20','publicKey','usdcPolygonWallet','revenue','default','statusChangedAt','insensitive','\x20->\x20','merchantEarnings','NONEXISTENT_GATEWAY_FILTER','getPayoutStats','thisMonth',']\x20Gateway\x20settings\x20before\x20saving:','\x20\x20\x20Full\x20amount:\x20','delete','toLowerCase','totalAmountUSDT','values','AdminService','📊\x20[ADMIN]\x20Using\x20saved\x20amountAfterGatewayCommissionUSDT:\x20','toFixed','parse','hash','CoinToPay','\x27\x20to\x20name\x20\x27','sk_',':\x20commission\x20=\x20','custom','\x27\x20(from\x20\x27','get','customerName','\x20\x20\x20⏳\x20Pending\x20payout:\x20','\x20\x20\x20Gateway:\x20','💰\x20Creating\x20payout\x20for\x20shop\x20','sort','createdAt','../types/gateway','🔍\x20Using\x20gateway\x20\x27','externalPaymentUrl','\x20\x20\x20Merchant\x20gets:\x20','month','getPayoutById','📊\x20Merchants\x20awaiting\x20payout:\x20','getPaymentById','week','\x20\x20\x20💰\x20Total\x20payments\x20turnover:\x20','getMonth','shopId','\x20order','polygon','name','updatePaymentStatus','merchantUrl','deleteUser','\x20\x20\x20Current\x20balance:\x20','ACTIVE','\x20\x20\x20⏳\x20Awaiting\x20payout:\x20','__esModule','✅\x20Customer\x20data\x20updated\x20for\x20payment\x20','getSystemStatistics','\x20USDT\x20(total\x20paid\x20to\x20merchants)','deletePayout','periodFrom','📋\x20Found\x20','\x20balance\x20updated:\x20','gatewayOrderId','\x20\x20\x20Current\x20total\x20paid\x20out:\x20','\x20USDT\x20from\x20balance','\x20USDT\x20(gross\x20revenue)','notes','\x20\x20\x20Subtracted\x20from\x20balance:\x20-','Plisio','0000','not\x20set','\x20missing\x20amountUSDT,\x20using\x20fallback\x20conversion','failUrl','klyme_gb','paymentsCount','getGatewayInternalName','shopUrl','Telegram\x20username\x20already\x20exists','\x20USDT\x20(with\x20commission\x20deducted)','🎯\x20updateUser\x20called\x20with\x20ID:\x20','findFirst','round','periodTo','\x20\x20\x20💸\x20Total\x20payouts\x20(all\x20time):\x20',']\x20User\x20updated,\x20gatewaySettings\x20from\x20DB:','forEach','toString','✅\x20Using\x20gateway\x20filter:\x20\x27','gatewayEarnings','paidOutUSDT','createPayout','totalCommissionRate','\x20USDT\x20(same\x20as\x20awaiting)','groupBy','⚠️\x20Requested\x20gateway\x20\x27','shop','\x20\x20\x20Merchant\x20loses:\x20','\x27)\x20not\x20found\x20in\x20database,\x20returning\x20empty\x20result','💰\x20Shop\x20','totalPayout','💸\x20CHARGEBACK\x20penalty:\x20-','\x20USDT\x20(','📊\x20Sorting\x20payments\x20by\x20',']\x20Password\x20not\x20provided\x20or\x20empty,\x20skipping\x20password\x20update','\x20USDT\x20for\x20payment\x20','desc','awaitingPayout','setDate','suspendUser','dateFrom','payout','stringify','📋\x20Getting\x20merchants\x20selection\x20list...','\x20status:\x20','%\x20commission)','password','ceil','year','💰\x20Found\x20','\x20became\x20PAID:','customerUa','\x20paid\x20payments\x20for\x20analysis','set','commission','KLYME\x20DE','\x20\x20\x20Total\x20paid\x20out:\x20','findUnique','Error\x20parsing\x20gateway\x20settings\x20for\x20shop\x20','💳\x20Payout\x20wallet\x20for\x20','telegram','Rapyd','successUrl','KLYME\x20GB','✅\x20Payout\x20created:\x20','klyme_eu','gateway','pk_','💸\x20CHARGEBACK:\x20Merchant\x20amount\x20already\x20deducted\x20from\x20balance','getGatewayDisplayName','currency','PAID','merchantEarningsUSDT','REFUND','🔄\x20Gateway\x20mapping:','CHARGEBACK','\x20\x20\x20✅\x20Actual\x20available\x20balance:\x20','create','length','📊\x20Getting\x20merchants\x20awaiting\x20payout\x20with\x20filters:','updatedAt','\x27\x20not\x20found.\x20Available\x20gateways:\x20','status','findMany','gte','paidAt','314358mRtCEQ','⚠️\x20Gateway\x20\x27','223076tbwhYy','💰\x20[PAYOUT]\x20Gateway\x20','35hVNNmT','totalTurnover','activateUser','\x20USDT\x20(after\x20',',\x20userId:\x20','gatewaySettings','🔧\x20[','customerCountry','dateTo','whiteUrl','not\x20specified','\x20USDT','rapyd','🔄\x20REFUND:\x20Payment\x20amount\x20already\x20deducted\x20from\x20balance','$transaction','telegramId','updateUser','\x20active\x20merchants\x20for\x20selection','cointopay2','balance','random','\x20USDT\x20(actual\x20balances)','username','adminNotes','averageCommissionRate','\x20\x20\x20✅\x20Total\x20available\x20for\x20payout:\x20','2020-01-01','📊\x20Merchant\x20statistics\x20calculated:','wallets','updateCustomerData','totalPayments','\x20\x20\x20📅\x20Total\x20payouts\x20(this\x20month):\x20','📊\x20Gateway\x20filter\x20applied:','getUserById','randomBytes','🔐\x20[','106XcMVeh','\x20\x20\x20Added\x20to\x20balance:\x20+','averageCheckUSDT','getTime','trc20','getAllPayouts','turnoverUSDT','112157ydupTH','usdtErcWallet','📅\x20Period\x20\x27all\x27:\x20Using\x20start\x20date\x20from\x20first\x20payment:\x20'];a36_0x11df=function(){return _0x5acae5;};return a36_0x11df();}const a36_0x5dfbb9=a36_0xe8ad;(function(_0x375230,_0x579230){const _0x299cda=a36_0xe8ad,_0x3776e2=_0x375230();while(!![]){try{const _0x37795e=-parseInt(_0x299cda(0x1b0))/0x1+parseInt(_0x299cda(0x1a9))/0x2*(-parseInt(_0x299cda(0x214))/0x3)+-parseInt(_0x299cda(0x183))/0x4*(-parseInt(_0x299cda(0x185))/0x5)+parseInt(_0x299cda(0x181))/0x6+parseInt(_0x299cda(0x1fd))/0x7+-parseInt(_0x299cda(0x1c0))/0x8+parseInt(_0x299cda(0x1ee))/0x9;if(_0x37795e===_0x579230)break;else _0x3776e2['push'](_0x3776e2['shift']());}catch(_0x7bf7ef){_0x3776e2['push'](_0x3776e2['shift']());}}}(a36_0x11df,0x562d1));var __importDefault=this&&this[a36_0x5dfbb9(0x1b6)]||function(_0x40dfdd){return _0x40dfdd&&_0x40dfdd['__esModule']?_0x40dfdd:{'default':_0x40dfdd};};Object['defineProperty'](exports,a36_0x5dfbb9(0x11c),{'value':!![]}),exports[a36_0x5dfbb9(0xf5)]=void 0x0;const database_1=__importDefault(require('../config/database')),bcryptjs_1=__importDefault(require('bcryptjs')),crypto_1=__importDefault(require(a36_0x5dfbb9(0x1d4))),currencyService_1=require(a36_0x5dfbb9(0x1c6)),gateway_1=require(a36_0x5dfbb9(0x107));class AdminService{async[a36_0x5dfbb9(0xed)](){const _0x5e5117=a36_0x5dfbb9;console['log']('📊\x20Calculating\x20payout\x20statistics...');const _0x309ad5=await database_1[_0x5e5117(0x227)][_0x5e5117(0x145)][_0x5e5117(0x1ec)]({'_sum':{'balance':!![],'totalPaidOut':!![]},'where':{'status':_0x5e5117(0x11a)}}),_0x355b63=await this[_0x5e5117(0x216)]({'page':0x1,'limit':0x3e8}),_0x5b3e49=await database_1[_0x5e5117(0x227)][_0x5e5117(0x1f9)][_0x5e5117(0x217)]({'where':{'status':_0x5e5117(0x172),'gateway':{'not':'test_gateway'}}}),_0x338333=new Date(),_0xd2f9d=new Date(_0x338333['getFullYear'](),_0x338333['getMonth'](),0x1),_0x522e48=new Date(_0x338333[_0x5e5117(0x220)](),_0x338333['getMonth']()+0x1,0x0,0x17,0x3b,0x3b,0x3e7),_0x415422=await database_1['default'][_0x5e5117(0x154)][_0x5e5117(0x1ec)]({'_sum':{'amount':!![]},'where':{'createdAt':{'gte':_0xd2f9d,'lte':_0x522e48},'status':'COMPLETED'}}),_0x4ce694=_0x309ad5[_0x5e5117(0x1b5)][_0x5e5117(0x1bd)]||0x0,_0x32fd03=_0x355b63[_0x5e5117(0x1ed)][_0x5e5117(0x1d6)],_0x49b9bf=_0x415422[_0x5e5117(0x1b5)][_0x5e5117(0x20b)]||0x0,_0x1579a0={'totalPayout':Math[_0x5e5117(0x137)](_0x4ce694*0x64)/0x64,'awaitingPayout':Math[_0x5e5117(0x137)](_0x32fd03*0x64)/0x64,'thisMonth':Math[_0x5e5117(0x137)](_0x49b9bf*0x64)/0x64,'availableBalance':Math[_0x5e5117(0x137)](_0x32fd03*0x64)/0x64,'totalPayments':_0x5b3e49};return console['log']('📊\x20Payout\x20statistics\x20calculated:'),console[_0x5e5117(0x1d5)](_0x5e5117(0x203)+_0x1579a0[_0x5e5117(0x149)]+_0x5e5117(0x11f)),console[_0x5e5117(0x1d5)](_0x5e5117(0x11b)+_0x1579a0[_0x5e5117(0x150)]+_0x5e5117(0x134)),console[_0x5e5117(0x1d5)]('\x20\x20\x20💵\x20Available\x20balance:\x20'+_0x1579a0[_0x5e5117(0x1c4)]+_0x5e5117(0x142)),console['log'](_0x5e5117(0x1d2)+_0x1579a0[_0x5e5117(0xee)]+'\x20USDT'),console['log']('\x20\x20\x20💳\x20Total\x20payments:\x20'+_0x1579a0[_0x5e5117(0x1a3)]+'\x20PAID\x20payments'),console[_0x5e5117(0x1d5)](_0x5e5117(0x1fa)+(_0x309ad5[_0x5e5117(0x1b5)][_0x5e5117(0x198)]||0x0)['toFixed'](0x2)+'\x20USDT\x20(without\x20commission)'),console[_0x5e5117(0x1d5)](_0x5e5117(0x223)+((_0x309ad5[_0x5e5117(0x1b5)]['balance']||0x0)-_0x32fd03)[_0x5e5117(0xf7)](0x2)+_0x5e5117(0x190)),_0x1579a0;}async[a36_0x5dfbb9(0x1a2)](_0x3b88ab,_0x392a95){const _0x206d14=a36_0x5dfbb9;console[_0x206d14(0x1d5)](_0x206d14(0x21d)+_0x3b88ab+':',_0x392a95);const _0x24b7f5=await database_1[_0x206d14(0x227)][_0x206d14(0x1f9)]['findUnique']({'where':{'id':_0x3b88ab},'select':{'id':!![],'customerEmail':!![],'customerName':!![],'customerCountry':!![],'customerIp':!![],'customerUa':!![]}});if(!_0x24b7f5)throw new Error(_0x206d14(0x1cf));const _0x36ba5b={};_0x392a95[_0x206d14(0x18c)]!==undefined&&(_0x36ba5b[_0x206d14(0x18c)]=_0x392a95['customerCountry']||null);_0x392a95['customerIp']!==undefined&&(_0x36ba5b[_0x206d14(0x212)]=_0x392a95[_0x206d14(0x212)]||null);_0x392a95['customerUa']!==undefined&&(_0x36ba5b[_0x206d14(0x15e)]=_0x392a95[_0x206d14(0x15e)]||null);const _0x4e3d43=await database_1[_0x206d14(0x227)][_0x206d14(0x1f9)]['update']({'where':{'id':_0x3b88ab},'data':{..._0x36ba5b,'updatedAt':new Date()},'select':{'id':!![],'customerEmail':!![],'customerName':!![],'customerCountry':!![],'customerIp':!![],'customerUa':!![],'updatedAt':!![]}});return console[_0x206d14(0x1d5)](_0x206d14(0x11d)+_0x3b88ab),console['log'](_0x206d14(0x1eb)+_0x24b7f5[_0x206d14(0x18c)]+_0x206d14(0x22a)+_0x4e3d43[_0x206d14(0x18c)]),console[_0x206d14(0x1d5)]('\x20\x20\x20🌐\x20IP:\x20'+_0x24b7f5[_0x206d14(0x212)]+_0x206d14(0x22a)+_0x4e3d43['customerIp']),console[_0x206d14(0x1d5)]('\x20\x20\x20🖥️\x20User\x20Agent:\x20'+(_0x24b7f5[_0x206d14(0x15e)]?_0x206d14(0x160):_0x206d14(0x12c))+_0x206d14(0x22a)+(_0x4e3d43[_0x206d14(0x15e)]?'set':'not\x20set')),_0x4e3d43;}async[a36_0x5dfbb9(0x11e)](_0x20466a){const _0x4bd1f9=a36_0x5dfbb9,_0x12bcec=new Date();let _0x31ef36;switch(_0x20466a){case'7d':_0x31ef36=new Date(_0x12bcec[_0x4bd1f9(0x1ac)]()-0x7*0x18*0x3c*0x3c*0x3e8);break;case _0x4bd1f9(0x1b9):_0x31ef36=new Date(_0x12bcec[_0x4bd1f9(0x1ac)]()-0x1e*0x18*0x3c*0x3c*0x3e8);break;case _0x4bd1f9(0x20a):_0x31ef36=new Date(_0x12bcec[_0x4bd1f9(0x1ac)]()-0x5a*0x18*0x3c*0x3c*0x3e8);break;case _0x4bd1f9(0x1ba):const _0x1f870a=await database_1[_0x4bd1f9(0x227)][_0x4bd1f9(0x1f9)]['findFirst']({'where':{'gateway':{'not':_0x4bd1f9(0x221)}},'orderBy':{'createdAt':_0x4bd1f9(0x1d3)},'select':{'createdAt':!![]}});_0x31ef36=_0x1f870a?_0x1f870a[_0x4bd1f9(0x106)]:new Date('2020-01-01'),console[_0x4bd1f9(0x1d5)](_0x4bd1f9(0x1b2)+_0x31ef36[_0x4bd1f9(0x1e4)]());break;default:_0x31ef36=new Date(_0x12bcec[_0x4bd1f9(0x1ac)]()-0x1e*0x18*0x3c*0x3c*0x3e8);}const [_0x189efe,_0x35869a,_0x456015,_0x29edc3,_0x41a859,_0xc8ea94]=await Promise[_0x4bd1f9(0x1ba)]([database_1[_0x4bd1f9(0x227)][_0x4bd1f9(0x145)][_0x4bd1f9(0x217)](),database_1[_0x4bd1f9(0x227)][_0x4bd1f9(0x145)][_0x4bd1f9(0x217)]({'where':{'status':_0x4bd1f9(0x11a)}}),database_1[_0x4bd1f9(0x227)]['payment'][_0x4bd1f9(0x217)]({'where':{'status':_0x4bd1f9(0x172),'createdAt':{'gte':_0x31ef36},'gateway':{'not':_0x4bd1f9(0x221)}}}),database_1['default'][_0x4bd1f9(0x1f9)][_0x4bd1f9(0x17e)]({'where':{'status':_0x4bd1f9(0x172),'createdAt':{'gte':_0x31ef36},'gateway':{'not':_0x4bd1f9(0x221)}},'select':{'amount':!![],'currency':!![],'amountAfterGatewayCommissionUSDT':!![]}}),database_1[_0x4bd1f9(0x227)][_0x4bd1f9(0x1f9)][_0x4bd1f9(0x17e)]({'where':{'gateway':{'not':_0x4bd1f9(0x221)}},'take':0xa,'orderBy':{'createdAt':'desc'},'include':{'shop':{'select':{'name':!![],'username':!![]}}}}),database_1[_0x4bd1f9(0x227)][_0x4bd1f9(0x1f9)]['findMany']({'where':{'createdAt':{'gte':_0x31ef36},'gateway':{'not':_0x4bd1f9(0x221)}},'select':{'amount':!![],'currency':!![],'status':!![],'amountUSDT':!![],'createdAt':!![]}})]);let _0x1be35f=0x0,_0x431c66=0x0;for(const _0x8e1863 of _0x29edc3){const _0x8d048a=await currencyService_1[_0x4bd1f9(0x1e0)]['convertToUSDT'](_0x8e1863['amount'],_0x8e1863['currency']);_0x1be35f+=_0x8d048a;if(_0x8e1863[_0x4bd1f9(0x1e8)]){const _0x24e40b=await currencyService_1[_0x4bd1f9(0x1e0)][_0x4bd1f9(0x21a)](_0x8e1863['amount'],_0x8e1863['currency']),_0xe0f3c8=_0x8e1863[_0x4bd1f9(0x1e8)],_0x1fbb9e=_0x24e40b-_0xe0f3c8;_0x431c66+=_0x1fbb9e;}}const _0x1c399e=_0x456015>0x0?_0x1be35f/_0x456015:0x0,_0x3fb9b1=this[_0x4bd1f9(0x209)](_0xc8ea94,_0x31ef36,_0x12bcec),_0x4354be=await database_1['default'][_0x4bd1f9(0x1f9)][_0x4bd1f9(0x217)]({'where':{'createdAt':{'gte':_0x31ef36},'gateway':{'not':_0x4bd1f9(0x221)}}}),_0xae1894=_0x4354be>0x0?_0x456015/_0x4354be*0x64:0x0;return{'totalShops':_0x189efe,'activeShops':_0x35869a,'totalPayments':_0x456015,'successfulPayments':_0x456015,'totalAttempts':_0x4354be,'totalRevenue':Math['round'](_0x1be35f*0x64)/0x64,'trapayEarnings':Math[_0x4bd1f9(0x137)](_0x431c66*0x64)/0x64,'averagePaymentAmount':Math[_0x4bd1f9(0x137)](_0x1c399e*0x64)/0x64,'conversionRate':Math['round'](_0xae1894*0x64)/0x64,'dailyRevenue':_0x3fb9b1['dailyRevenue'],'dailyPayments':_0x3fb9b1[_0x4bd1f9(0x1f5)],'recentPayments':_0x41a859[_0x4bd1f9(0x1db)](_0x5314f6=>({'id':_0x5314f6['id'],'amount':_0x5314f6[_0x4bd1f9(0x20b)],'currency':_0x5314f6[_0x4bd1f9(0x171)],'status':_0x5314f6[_0x4bd1f9(0x17d)],'gateway':_0x5314f6['gateway'],'shop':_0x5314f6[_0x4bd1f9(0x145)],'createdAt':_0x5314f6[_0x4bd1f9(0x106)]}))};}async['getMerchantStatistics'](_0x432853){const _0x3d3909=a36_0x5dfbb9;console[_0x3d3909(0x1d5)](_0x3d3909(0x1f3),_0x432853);let _0x4af77f,_0x5223dc=new Date();if(_0x432853[_0x3d3909(0x1f8)]===_0x3d3909(0xfe)&&_0x432853[_0x3d3909(0x153)]&&_0x432853[_0x3d3909(0x18d)])_0x4af77f=new Date(_0x432853[_0x3d3909(0x153)]),_0x5223dc=new Date(_0x432853[_0x3d3909(0x18d)]);else{const _0x5ab330=new Date();switch(_0x432853[_0x3d3909(0x1f8)]){case _0x3d3909(0x10f):_0x4af77f=new Date(_0x5ab330['getTime']()-0x7*0x18*0x3c*0x3c*0x3e8);break;case _0x3d3909(0x10b):_0x4af77f=new Date(_0x5ab330[_0x3d3909(0x1ac)]()-0x1e*0x18*0x3c*0x3c*0x3e8);break;case _0x3d3909(0x15b):_0x4af77f=new Date(_0x5ab330['getTime']()-0x16d*0x18*0x3c*0x3c*0x3e8);break;case _0x3d3909(0x1ba):default:_0x4af77f=new Date(_0x3d3909(0x19f));break;}}console[_0x3d3909(0x1d5)]('📅\x20Period:\x20'+_0x4af77f['toISOString']()+_0x3d3909(0x1d9)+_0x5223dc[_0x3d3909(0x1e4)]());const _0x15c13b={'status':'PAID','gateway':{'not':_0x3d3909(0x221)},'paidAt':{'gte':_0x4af77f,'lte':_0x5223dc}};_0x432853[_0x3d3909(0x112)]&&(_0x15c13b[_0x3d3909(0x112)]=_0x432853[_0x3d3909(0x112)]);const _0x18003a=await database_1['default'][_0x3d3909(0x1f9)][_0x3d3909(0x17e)]({'where':_0x15c13b,'include':{'shop':{'select':{'id':!![],'name':!![],'username':!![],'gatewaySettings':!![]}}}});console[_0x3d3909(0x1d5)](_0x3d3909(0x15c)+_0x18003a[_0x3d3909(0x179)]+_0x3d3909(0x15f));const _0x21a297={'gateway':{'not':_0x3d3909(0x221)},'createdAt':{'gte':_0x4af77f,'lte':_0x5223dc}};_0x432853[_0x3d3909(0x112)]&&(_0x21a297[_0x3d3909(0x112)]=_0x432853[_0x3d3909(0x112)]);const _0x1ce191=await database_1[_0x3d3909(0x227)][_0x3d3909(0x1f9)][_0x3d3909(0x217)]({'where':_0x21a297});console[_0x3d3909(0x1d5)](_0x3d3909(0x1cd)+_0x1ce191+_0x3d3909(0x20d)+_0x18003a[_0x3d3909(0x179)]);let _0x46f0df=0x0,_0x26b143=0x0,_0x3b8311=0x0;const _0x3722f7={},_0x48acf9={},_0x31383c={};for(const _0x29c9dd of _0x18003a){try{const _0x5aa1a0=await currencyService_1[_0x3d3909(0x1e0)][_0x3d3909(0x21a)](_0x29c9dd[_0x3d3909(0x20b)],_0x29c9dd[_0x3d3909(0x171)]);let _0x4bffa1={};if(_0x29c9dd[_0x3d3909(0x145)][_0x3d3909(0x18a)])try{_0x4bffa1=JSON[_0x3d3909(0xf8)](_0x29c9dd[_0x3d3909(0x145)][_0x3d3909(0x18a)]);}catch(_0x4b1eda){console['error'](_0x3d3909(0x165)+_0x29c9dd['shopId']+':',_0x4b1eda);}let _0x3888e8={},_0x33b390=0xa;for(const [_0x465c8d,_0x306497]of Object[_0x3d3909(0x1b4)](_0x4bffa1)){if(_0x465c8d[_0x3d3909(0xf2)]()===_0x29c9dd[_0x3d3909(0x16d)][_0x3d3909(0xf2)]()){_0x3888e8=_0x306497,_0x33b390=_0x306497[_0x3d3909(0x161)]||0xa;break;}}let _0x523050,_0x16e5e2;_0x29c9dd['amountAfterGatewayCommissionUSDT']!==null&&_0x29c9dd['amountAfterGatewayCommissionUSDT']!==undefined?(_0x523050=_0x29c9dd[_0x3d3909(0x1e8)],_0x16e5e2=_0x5aa1a0-_0x523050,console[_0x3d3909(0x1d5)](_0x3d3909(0x1f7)+_0x523050['toFixed'](0x6)+_0x3d3909(0x14e)+_0x29c9dd['id'])):(_0x16e5e2=_0x5aa1a0*(_0x33b390/0x64),_0x523050=_0x5aa1a0-_0x16e5e2,console[_0x3d3909(0x1d5)]('📊\x20Calculating\x20commission\x20manually\x20for\x20payment\x20'+_0x29c9dd['id']+':\x20'+_0x33b390+_0x3d3909(0x1e9)+_0x5aa1a0[_0x3d3909(0xf7)](0x6)+_0x3d3909(0x190)));_0x46f0df+=_0x5aa1a0,_0x26b143+=_0x523050,_0x3b8311+=_0x16e5e2;!_0x3722f7[_0x29c9dd[_0x3d3909(0x16d)]]&&(_0x3722f7[_0x29c9dd['gateway']]={'gateway':_0x29c9dd['gateway'],'gatewayDisplayName':this[_0x3d3909(0x170)](_0x29c9dd[_0x3d3909(0x16d)]),'paymentsCount':0x0,'turnoverUSDT':0x0,'commissionUSDT':0x0,'merchantEarningsUSDT':0x0,'totalCommissionRate':0x0});_0x3722f7[_0x29c9dd[_0x3d3909(0x16d)]][_0x3d3909(0x130)]++,_0x3722f7[_0x29c9dd[_0x3d3909(0x16d)]][_0x3d3909(0x1af)]+=_0x5aa1a0,_0x3722f7[_0x29c9dd[_0x3d3909(0x16d)]][_0x3d3909(0x1f2)]+=_0x16e5e2,_0x3722f7[_0x29c9dd[_0x3d3909(0x16d)]]['merchantEarningsUSDT']+=_0x523050,_0x3722f7[_0x29c9dd[_0x3d3909(0x16d)]][_0x3d3909(0x141)]+=_0x33b390;!_0x432853[_0x3d3909(0x112)]&&(!_0x48acf9[_0x29c9dd[_0x3d3909(0x112)]]&&(_0x48acf9[_0x29c9dd[_0x3d3909(0x112)]]={'shopId':_0x29c9dd['shopId'],'shopName':_0x29c9dd['shop']['name'],'shopUsername':_0x29c9dd[_0x3d3909(0x145)][_0x3d3909(0x19b)],'paymentsCount':0x0,'turnoverUSDT':0x0,'commissionUSDT':0x0,'merchantEarningsUSDT':0x0,'paidOutUSDT':0x0,'averageCheckUSDT':0x0}),_0x48acf9[_0x29c9dd[_0x3d3909(0x112)]][_0x3d3909(0x130)]++,_0x48acf9[_0x29c9dd['shopId']][_0x3d3909(0x1af)]+=_0x5aa1a0,_0x48acf9[_0x29c9dd[_0x3d3909(0x112)]][_0x3d3909(0x1f2)]+=_0x16e5e2,_0x48acf9[_0x29c9dd[_0x3d3909(0x112)]][_0x3d3909(0x173)]+=_0x523050);const _0x538280=_0x29c9dd[_0x3d3909(0x180)][_0x3d3909(0x1e4)]()['split']('T')[0x0];!_0x31383c[_0x538280]&&(_0x31383c[_0x538280]={'date':_0x538280,'turnover':0x0,'merchantEarnings':0x0,'gatewayEarnings':0x0,'paymentsCount':0x0}),_0x31383c[_0x538280]['turnover']+=_0x5aa1a0,_0x31383c[_0x538280][_0x3d3909(0xeb)]+=_0x523050,_0x31383c[_0x538280][_0x3d3909(0x13e)]+=_0x16e5e2,_0x31383c[_0x538280][_0x3d3909(0x130)]++;}catch(_0x51099d){console['error']('Error\x20processing\x20payment\x20'+_0x29c9dd['id']+':',_0x51099d);}}Object[_0x3d3909(0xf4)](_0x3722f7)[_0x3d3909(0x13b)](_0x52d9ae=>{const _0x14e50e=_0x3d3909;_0x52d9ae[_0x14e50e(0x19d)]=_0x52d9ae[_0x14e50e(0x130)]>0x0?_0x52d9ae[_0x14e50e(0x141)]/_0x52d9ae['paymentsCount']:0x0,delete _0x52d9ae[_0x14e50e(0x141)];}),Object[_0x3d3909(0xf4)](_0x48acf9)['forEach'](_0x1e74d4=>{const _0xe1193=_0x3d3909;_0x1e74d4['averageCheckUSDT']=_0x1e74d4['paymentsCount']>0x0?_0x1e74d4[_0xe1193(0x1af)]/_0x1e74d4['paymentsCount']:0x0;});let _0x2ad18f=0x0,_0x4f8ebc=0x0;if(_0x432853[_0x3d3909(0x112)]){const _0x14c5a3=await database_1['default']['payout'][_0x3d3909(0x17e)]({'where':{'shopId':_0x432853[_0x3d3909(0x112)],'status':_0x3d3909(0x205),'createdAt':{'gte':_0x4af77f,'lte':_0x5223dc}},'select':{'amount':!![]}});_0x2ad18f=_0x14c5a3[_0x3d3909(0x200)]((_0x56727e,_0xd8736f)=>_0x56727e+_0xd8736f[_0x3d3909(0x20b)],0x0);const _0x1412a1=await database_1[_0x3d3909(0x227)][_0x3d3909(0x154)][_0x3d3909(0x17e)]({'where':{'shopId':_0x432853['shopId'],'status':_0x3d3909(0x204),'createdAt':{'gte':_0x4af77f,'lte':_0x5223dc}},'select':{'amount':!![]}});_0x4f8ebc=_0x1412a1[_0x3d3909(0x200)]((_0x16c969,_0x58290b)=>_0x16c969+_0x58290b['amount'],0x0);}const _0x35c0a6=_0x1ce191,_0x2bcd6c=_0x18003a['length'],_0x1dd5e7=_0x2bcd6c>0x0?_0x46f0df/_0x2bcd6c:0x0,_0x36425f=_0x35c0a6>0x0?Math[_0x3d3909(0x137)](_0x2bcd6c/_0x35c0a6*0x2710)/0x64:0x0,_0x23a90e=Math[_0x3d3909(0x15a)]((_0x5223dc['getTime']()-_0x4af77f[_0x3d3909(0x1ac)]())/(0x3e8*0x3c*0x3c*0x18)),_0x3109fc={'totalTurnover':Math[_0x3d3909(0x137)](_0x46f0df*0x64)/0x64,'merchantEarnings':Math[_0x3d3909(0x137)](_0x26b143*0x64)/0x64,'gatewayEarnings':Math[_0x3d3909(0x137)](_0x3b8311*0x64)/0x64,'totalPaidOut':Math[_0x3d3909(0x137)](_0x2ad18f*0x64)/0x64,'pendingPayout':Math[_0x3d3909(0x137)](_0x4f8ebc*0x64)/0x64,'averageCheck':Math['round'](_0x1dd5e7*0x64)/0x64,'totalPayments':_0x35c0a6,'successfulPayments':_0x2bcd6c,'conversionRate':_0x36425f,'gatewayBreakdown':Object[_0x3d3909(0xf4)](_0x3722f7)[_0x3d3909(0x1db)](_0x50303f=>({..._0x50303f,'turnoverUSDT':Math[_0x3d3909(0x137)](_0x50303f[_0x3d3909(0x1af)]*0x64)/0x64,'commissionUSDT':Math[_0x3d3909(0x137)](_0x50303f['commissionUSDT']*0x64)/0x64,'merchantEarningsUSDT':Math[_0x3d3909(0x137)](_0x50303f[_0x3d3909(0x173)]*0x64)/0x64,'averageCommissionRate':Math[_0x3d3909(0x137)](_0x50303f['averageCommissionRate']*0x64)/0x64})),'merchantBreakdown':_0x432853[_0x3d3909(0x112)]?undefined:Object[_0x3d3909(0xf4)](_0x48acf9)[_0x3d3909(0x1db)](_0x154939=>({..._0x154939,'turnoverUSDT':Math['round'](_0x154939['turnoverUSDT']*0x64)/0x64,'commissionUSDT':Math[_0x3d3909(0x137)](_0x154939[_0x3d3909(0x1f2)]*0x64)/0x64,'merchantEarningsUSDT':Math['round'](_0x154939[_0x3d3909(0x173)]*0x64)/0x64,'paidOutUSDT':Math[_0x3d3909(0x137)](_0x154939[_0x3d3909(0x13f)]*0x64)/0x64,'averageCheckUSDT':Math[_0x3d3909(0x137)](_0x154939[_0x3d3909(0x1ab)]*0x64)/0x64})),'dailyData':Object[_0x3d3909(0xf4)](_0x31383c)[_0x3d3909(0x1db)](_0x351691=>({..._0x351691,'turnover':Math[_0x3d3909(0x137)](_0x351691['turnover']*0x64)/0x64,'merchantEarnings':Math[_0x3d3909(0x137)](_0x351691['merchantEarnings']*0x64)/0x64,'gatewayEarnings':Math[_0x3d3909(0x137)](_0x351691[_0x3d3909(0x13e)]*0x64)/0x64}))[_0x3d3909(0x105)]((_0x35d3b1,_0x269946)=>_0x35d3b1[_0x3d3909(0x1be)]['localeCompare'](_0x269946[_0x3d3909(0x1be)])),'periodInfo':{'from':_0x4af77f,'to':_0x5223dc,'periodType':_0x432853['period']||_0x3d3909(0xfe),'daysCount':_0x23a90e}};return console['log'](_0x3d3909(0x1a0)),console[_0x3d3909(0x1d5)]('\x20\x20\x20💰\x20Total\x20turnover:\x20'+_0x3109fc[_0x3d3909(0x186)]+_0x3d3909(0x190)),console[_0x3d3909(0x1d5)](_0x3d3909(0x1e1)+_0x3109fc[_0x3d3909(0xeb)]+'\x20USDT'),console[_0x3d3909(0x1d5)]('\x20\x20\x20🏪\x20Gateway\x20earnings:\x20'+_0x3109fc['gatewayEarnings']+_0x3d3909(0x190)),console[_0x3d3909(0x1d5)](_0x3d3909(0x1ff)+_0x3109fc[_0x3d3909(0x1bd)]+_0x3d3909(0x190)),console[_0x3d3909(0x1d5)](_0x3d3909(0x102)+_0x3109fc[_0x3d3909(0x210)]+_0x3d3909(0x190)),console[_0x3d3909(0x1d5)]('\x20\x20\x20�📊\x20Total\x20payments:\x20'+_0x3109fc['totalPayments']),_0x3109fc;}async[a36_0x5dfbb9(0x21c)](){const _0x4adbac=a36_0x5dfbb9;console[_0x4adbac(0x1d5)](_0x4adbac(0x156));const _0x39c0ed=await database_1[_0x4adbac(0x227)]['shop'][_0x4adbac(0x17e)]({'where':{'status':'ACTIVE'},'select':{'id':!![],'username':!![],'name':!![]},'orderBy':{'name':_0x4adbac(0x1d3)}});return console[_0x4adbac(0x1d5)](_0x4adbac(0x122)+_0x39c0ed[_0x4adbac(0x179)]+_0x4adbac(0x196)),_0x39c0ed['map'](_0x334581=>({'id':_0x334581['id'],'username':_0x334581[_0x4adbac(0x19b)],'name':_0x334581[_0x4adbac(0x115)]}));}[a36_0x5dfbb9(0x170)](_0xabe258){const _0x17715b=a36_0x5dfbb9,_0xeb70c9={'test_gateway':'Test\x20Gateway','plisio':_0x17715b(0x12a),'rapyd':_0x17715b(0x168),'noda':_0x17715b(0x222),'cointopay':_0x17715b(0xfa),'cointopay2':'Open\x20Banking\x202','klyme_eu':'KLYME\x20EU','klyme_gb':_0x17715b(0x16a),'klyme_de':_0x17715b(0x162),'mastercard':'MasterCard'};return _0xeb70c9[_0xabe258]||_0xabe258;}[a36_0x5dfbb9(0x131)](_0x200730){const _0x134127=a36_0x5dfbb9,_0x55b856={'Test\x20Gateway':_0x134127(0x221),'Plisio':_0x134127(0x1d8),'Rapyd':_0x134127(0x191),'Noda':_0x134127(0x207),'CoinToPay':'cointopay','CoinToPay2':_0x134127(0x197),'KLYME\x20EU':_0x134127(0x16c),'KLYME\x20GB':_0x134127(0x12f),'KLYME\x20DE':'klyme_de','MasterCard':_0x134127(0x1b3)};return _0x55b856[_0x200730]||_0x200730[_0x134127(0xf2)]();}async[a36_0x5dfbb9(0x216)](_0x19a88c){const _0x1571c8=a36_0x5dfbb9,{page:_0x2a5494,limit:_0x576864,minAmount:_0x46eebe,search:_0x1ca437}=_0x19a88c,_0x31a77b=(_0x2a5494-0x1)*_0x576864;console[_0x1571c8(0x1d5)](_0x1571c8(0x17a),_0x19a88c);const _0x5e914f={'balance':{'gt':0x0},'status':_0x1571c8(0x11a)};_0x46eebe&&(_0x5e914f[_0x1571c8(0x198)][_0x1571c8(0x17f)]=_0x46eebe);_0x1ca437&&(_0x5e914f['OR']=[{'name':{'contains':_0x1ca437,'mode':_0x1571c8(0x229)}},{'username':{'contains':_0x1ca437,'mode':_0x1571c8(0x229)}}]);const [_0x3b616b,_0xe18a3b]=await Promise[_0x1571c8(0x1ba)]([database_1[_0x1571c8(0x227)]['shop'][_0x1571c8(0x17e)]({'where':_0x5e914f,'skip':_0x31a77b,'take':_0x576864,'orderBy':{'balance':_0x1571c8(0x14f)},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'balance':!![],'totalPaidOut':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'gatewaySettings':!![],'createdAt':!![]}}),database_1[_0x1571c8(0x227)][_0x1571c8(0x145)][_0x1571c8(0x217)]({'where':_0x5e914f})]);console[_0x1571c8(0x1d5)](_0x1571c8(0x15c)+_0x3b616b[_0x1571c8(0x179)]+_0x1571c8(0x1f0));const _0x5396b8=await Promise['all'](_0x3b616b[_0x1571c8(0x1db)](async _0x3959d4=>{const _0x492660=_0x1571c8,[_0x391f70,_0x1d8bd2,_0x19fffd]=await Promise['all']([database_1['default']['payment']['count']({'where':{'shopId':_0x3959d4['id'],'status':_0x492660(0x172),'gateway':{'not':_0x492660(0x221)}}}),database_1[_0x492660(0x227)][_0x492660(0x1f9)][_0x492660(0x136)]({'where':{'shopId':_0x3959d4['id'],'status':_0x492660(0x172),'gateway':{'not':'test_gateway'}},'orderBy':{'paidAt':'asc'},'select':{'paidAt':!![]}}),database_1[_0x492660(0x227)][_0x492660(0x1f9)][_0x492660(0x143)]({'by':[_0x492660(0x16d)],'where':{'shopId':_0x3959d4['id'],'status':_0x492660(0x172),'gateway':{'not':'test_gateway'}},'_count':{'id':!![]},'_sum':{'amountUSDT':!![]}})]),_0x2d72b2=new Date(),_0x211851=new Date(_0x2d72b2[_0x492660(0x220)](),_0x2d72b2[_0x492660(0x111)](),0x1),_0x4d2076=new Date(_0x2d72b2[_0x492660(0x220)](),_0x2d72b2[_0x492660(0x111)]()+0x1,0x0,0x17,0x3b,0x3b,0x3e7),[_0x3c34f7,_0x408a8a]=await Promise[_0x492660(0x1ba)]([database_1['default'][_0x492660(0x154)]['aggregate']({'_sum':{'amount':!![]},'where':{'shopId':_0x3959d4['id'],'status':_0x492660(0x205)}}),database_1[_0x492660(0x227)][_0x492660(0x154)][_0x492660(0x1ec)]({'_sum':{'amount':!![]},'where':{'shopId':_0x3959d4['id'],'status':_0x492660(0x205),'createdAt':{'gte':_0x211851,'lte':_0x4d2076}}})]),_0x58c207=_0x3c34f7[_0x492660(0x1b5)][_0x492660(0x20b)]||0x0,_0x37f499=_0x408a8a['_sum'][_0x492660(0x20b)]||0x0,_0x5eacd2=await Promise[_0x492660(0x1ba)](_0x19fffd[_0x492660(0x1db)](async _0x2a0431=>{const _0x493442=_0x492660;let _0x57a3ac=0xa;if(_0x3959d4[_0x493442(0x18a)])try{const _0x872bfe=JSON[_0x493442(0xf8)](_0x3959d4[_0x493442(0x18a)]);for(const [_0xb297e3,_0x399700]of Object[_0x493442(0x1b4)](_0x872bfe)){if(_0xb297e3[_0x493442(0xf2)]()===_0x2a0431[_0x493442(0x16d)][_0x493442(0xf2)]()){_0x57a3ac=_0x399700[_0x493442(0x161)]||0xa,console[_0x493442(0x1d5)](_0x493442(0x184)+_0x2a0431[_0x493442(0x16d)]+_0x493442(0x1de)+_0x3959d4['id']+_0x493442(0xfd)+_0x57a3ac+'%');break;}}}catch(_0x56977f){console[_0x493442(0x1e7)](_0x493442(0x165)+_0x3959d4['id']+':',_0x56977f);}const _0x4d8164=_0x2a0431[_0x493442(0x1b5)]?.['amountUSDT']||0x0,_0x5824ba=_0x4d8164*(0x1-_0x57a3ac/0x64);return{'gateway':_0x2a0431[_0x493442(0x16d)],'count':_0x2a0431['_count']?.['id']||0x0,'amountUSDT':Math['round'](_0x4d8164*0x64)/0x64,'amountAfterCommissionUSDT':Math[_0x493442(0x137)](_0x5824ba*0x64)/0x64,'commission':_0x57a3ac};})),_0x2b1aed=_0x5eacd2['reduce']((_0x54e91d,_0x6a378)=>_0x54e91d+_0x6a378['amountUSDT'],0x0),_0x5428b3=_0x3959d4[_0x492660(0x198)];return console[_0x492660(0x1d5)]('💰\x20[PAYOUT]\x20Merchant\x20'+_0x3959d4[_0x492660(0x19b)]+':'),console[_0x492660(0x1d5)](_0x492660(0x1c3)+_0x2b1aed['toFixed'](0x2)+_0x492660(0x127)),console[_0x492660(0x1d5)]('\x20\x20\x20🔍\x20Calculated\x20after\x20commission:\x20'+_0x5eacd2[_0x492660(0x200)]((_0x217d59,_0x5853e3)=>_0x217d59+_0x5853e3['amountAfterCommissionUSDT'],0x0)[_0x492660(0xf7)](0x2)+'\x20USDT\x20(theoretical\x20net)'),console['log'](_0x492660(0x177)+_0x5428b3[_0x492660(0xf7)](0x2)+'\x20USDT\x20(after\x20payouts)'),{'id':_0x3959d4['id'],'fullName':_0x3959d4[_0x492660(0x115)],'username':_0x3959d4['username'],'telegramId':_0x3959d4[_0x492660(0x167)],'merchantUrl':_0x3959d4[_0x492660(0x132)],'wallets':{'usdtPolygonWallet':_0x3959d4['usdtPolygonWallet'],'usdtTrcWallet':_0x3959d4[_0x492660(0x1c7)],'usdtErcWallet':_0x3959d4['usdtErcWallet'],'usdcPolygonWallet':_0x3959d4['usdcPolygonWallet']},'totalAmountUSDT':Math[_0x492660(0x137)](_0x2b1aed*0x64)/0x64,'totalAmountAfterCommissionUSDT':Math[_0x492660(0x137)](_0x5428b3*0x64)/0x64,'totalPayout':Math[_0x492660(0x137)](_0x58c207*0x64)/0x64,'thisMonth':Math['round'](_0x37f499*0x64)/0x64,'paymentsCount':_0x391f70,'oldestPaymentDate':_0x1d8bd2?.[_0x492660(0x180)]||_0x3959d4['createdAt'],'gatewayBreakdown':_0x5eacd2};})),_0x3707fc=_0x5396b8[_0x1571c8(0x200)]((_0x4c26fd,_0x4fe2b2)=>_0x4c26fd+_0x4fe2b2[_0x1571c8(0xf3)],0x0),_0x5d7df4=_0x5396b8[_0x1571c8(0x200)]((_0x1ebc8a,_0x469673)=>_0x1ebc8a+_0x469673[_0x1571c8(0x1d6)],0x0),_0x103cda=_0x5396b8[_0x1571c8(0x200)]((_0xf84e99,_0x304e44)=>_0xf84e99+_0x304e44['totalPayout'],0x0),_0x34f7b5=_0x5396b8[_0x1571c8(0x200)]((_0x3a6687,_0x2adc5b)=>_0x3a6687+_0x2adc5b['thisMonth'],0x0);return console['log'](_0x1571c8(0x10d)+_0xe18a3b+'\x20merchants'),console[_0x1571c8(0x1d5)](_0x1571c8(0x110)+Math['round'](_0x3707fc*0x64)/0x64+_0x1571c8(0x127)),console[_0x1571c8(0x1d5)](_0x1571c8(0x19e)+Math[_0x1571c8(0x137)](_0x5d7df4*0x64)/0x64+_0x1571c8(0x19a)),console[_0x1571c8(0x1d5)](_0x1571c8(0x139)+Math[_0x1571c8(0x137)](_0x103cda*0x64)/0x64+_0x1571c8(0x190)),console[_0x1571c8(0x1d5)](_0x1571c8(0x1a4)+Math[_0x1571c8(0x137)](_0x34f7b5*0x64)/0x64+'\x20USDT'),{'merchants':_0x5396b8,'pagination':{'page':_0x2a5494,'limit':_0x576864,'total':_0xe18a3b,'totalPages':Math[_0x1571c8(0x15a)](_0xe18a3b/_0x576864)},'summary':{'totalMerchants':_0xe18a3b,'totalAmountUSDT':Math[_0x1571c8(0x137)](_0x3707fc*0x64)/0x64,'totalAmountAfterCommissionUSDT':Math[_0x1571c8(0x137)](_0x5d7df4*0x64)/0x64,'totalPayout':Math[_0x1571c8(0x137)](_0x103cda*0x64)/0x64,'thisMonth':Math[_0x1571c8(0x137)](_0x34f7b5*0x64)/0x64}};}async[a36_0x5dfbb9(0x140)](_0x502cc3){const _0x30b73c=a36_0x5dfbb9,{shopId:_0x3bf9a4,amount:_0x228702,network:_0x3d32a4,wallet:_0x4db9c3,notes:_0x38f2f5,txid:_0x147f33,periodFrom:_0x52c2ff,periodTo:_0x3f9fc7}=_0x502cc3,_0x5c3b86=await database_1[_0x30b73c(0x227)][_0x30b73c(0x193)](async _0x42fcdb=>{const _0x1aabd5=_0x30b73c,_0x107a14=await _0x42fcdb['shop'][_0x1aabd5(0x164)]({'where':{'id':_0x3bf9a4},'select':{'id':!![],'name':!![],'username':!![],'balance':!![],'totalPaidOut':!![]}});if(!_0x107a14)throw new Error(_0x1aabd5(0x206));console[_0x1aabd5(0x1d5)](_0x1aabd5(0x104)+_0x107a14[_0x1aabd5(0x19b)]+':'),console['log'](_0x1aabd5(0x119)+_0x107a14[_0x1aabd5(0x198)]['toFixed'](0x6)+'\x20USDT'),console[_0x1aabd5(0x1d5)]('\x20\x20\x20Payout\x20amount:\x20'+_0x228702['toFixed'](0x6)+_0x1aabd5(0x190)),console['log'](_0x1aabd5(0x125)+_0x107a14[_0x1aabd5(0x1bd)][_0x1aabd5(0xf7)](0x6)+_0x1aabd5(0x190));if(_0x147f33)console['log']('\x20\x20\x20Transaction\x20hash:\x20'+_0x147f33);if(_0x107a14[_0x1aabd5(0x198)]<_0x228702)throw new Error(_0x1aabd5(0x1dd)+_0x107a14[_0x1aabd5(0x198)]['toFixed'](0x6)+'\x20USDT,\x20Requested:\x20'+_0x228702[_0x1aabd5(0xf7)](0x6)+_0x1aabd5(0x190));let _0x98bffc=_0x4db9c3;if(!_0x98bffc){const _0x1c3356=await _0x42fcdb[_0x1aabd5(0x145)][_0x1aabd5(0x164)]({'where':{'id':_0x3bf9a4},'select':{'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![]}});if(_0x1c3356)switch(_0x3d32a4){case _0x1aabd5(0x114):_0x98bffc=_0x1c3356['usdtPolygonWallet']||undefined;break;case _0x1aabd5(0x1ad):_0x98bffc=_0x1c3356[_0x1aabd5(0x1c7)]||undefined;break;case _0x1aabd5(0x1e5):_0x98bffc=_0x1c3356[_0x1aabd5(0x1b1)]||undefined;break;case _0x1aabd5(0x1bb):_0x98bffc=_0x1c3356[_0x1aabd5(0x225)]||undefined;break;}}console[_0x1aabd5(0x1d5)](_0x1aabd5(0x166)+_0x3d32a4+':\x20'+(_0x98bffc||_0x1aabd5(0x18f)));const _0x38e949=await _0x42fcdb['payout'][_0x1aabd5(0x178)]({'data':{'shopId':_0x3bf9a4,'amount':_0x228702,'network':_0x3d32a4,'status':_0x1aabd5(0x205),'txid':_0x147f33,'notes':_0x38f2f5,'periodFrom':_0x52c2ff?new Date(_0x52c2ff):null,'periodTo':_0x3f9fc7?new Date(_0x3f9fc7):null,'createdAt':new Date(),'paidAt':new Date()}}),_0x3b3d85=_0x107a14[_0x1aabd5(0x198)]-_0x228702,_0x2e6489=_0x107a14[_0x1aabd5(0x1bd)]+_0x228702;return await _0x42fcdb[_0x1aabd5(0x145)]['update']({'where':{'id':_0x3bf9a4},'data':{'balance':_0x3b3d85,'totalPaidOut':_0x2e6489}}),console[_0x1aabd5(0x1d5)](_0x1aabd5(0x148)+_0x107a14[_0x1aabd5(0x19b)]+_0x1aabd5(0x1e6)),console['log']('\x20\x20\x20Balance:\x20'+_0x107a14[_0x1aabd5(0x198)]['toFixed'](0x6)+'\x20->\x20'+_0x3b3d85[_0x1aabd5(0xf7)](0x6)+'\x20USDT\x20(-'+_0x228702[_0x1aabd5(0xf7)](0x6)+')'),console[_0x1aabd5(0x1d5)](_0x1aabd5(0x163)+_0x107a14[_0x1aabd5(0x1bd)][_0x1aabd5(0xf7)](0x6)+_0x1aabd5(0x22a)+_0x2e6489['toFixed'](0x6)+'\x20USDT\x20(+'+_0x228702[_0x1aabd5(0xf7)](0x6)+')'),{'payout':_0x38e949,'shop':_0x107a14};});return console['log'](_0x30b73c(0x16b)+_0x5c3b86[_0x30b73c(0x154)]['id']+_0x30b73c(0x1de)+_0x5c3b86[_0x30b73c(0x145)][_0x30b73c(0x19b)]+'\x20('+_0x228702+_0x30b73c(0x1bc)),{'id':_0x5c3b86['payout']['id'],'shopId':_0x5c3b86[_0x30b73c(0x154)][_0x30b73c(0x112)],'shopName':_0x5c3b86['shop'][_0x30b73c(0x115)],'shopUsername':_0x5c3b86[_0x30b73c(0x145)][_0x30b73c(0x19b)],'amount':_0x5c3b86[_0x30b73c(0x154)]['amount'],'network':_0x5c3b86[_0x30b73c(0x154)]['network'],'status':_0x5c3b86[_0x30b73c(0x154)][_0x30b73c(0x17d)],'txid':_0x5c3b86[_0x30b73c(0x154)][_0x30b73c(0x1ef)],'notes':_0x5c3b86['payout'][_0x30b73c(0x128)],'periodFrom':_0x5c3b86[_0x30b73c(0x154)][_0x30b73c(0x121)],'periodTo':_0x5c3b86[_0x30b73c(0x154)]['periodTo'],'createdAt':_0x5c3b86[_0x30b73c(0x154)][_0x30b73c(0x106)],'paidAt':_0x5c3b86[_0x30b73c(0x154)][_0x30b73c(0x180)]};}async[a36_0x5dfbb9(0x1ae)](_0x482f60){const _0x53f36c=a36_0x5dfbb9,{page:_0x26ce7b,limit:_0x4c15cb,shopId:_0x179659,network:_0x4e6b29,dateFrom:_0x2b9f24,dateTo:_0x42c25c,search:_0x3022db}=_0x482f60,_0x1616a4=(_0x26ce7b-0x1)*_0x4c15cb,_0x478cee={};_0x179659&&(_0x478cee[_0x53f36c(0x112)]=_0x179659);_0x4e6b29&&(_0x478cee[_0x53f36c(0x1f6)]=_0x4e6b29);(_0x2b9f24||_0x42c25c)&&(_0x478cee[_0x53f36c(0x106)]={},_0x2b9f24&&(_0x478cee['createdAt'][_0x53f36c(0x17f)]=new Date(_0x2b9f24)),_0x42c25c&&(_0x478cee[_0x53f36c(0x106)][_0x53f36c(0x1fc)]=new Date(_0x42c25c)));_0x3022db&&(_0x478cee['OR']=[{'shop':{'name':{'contains':_0x3022db,'mode':_0x53f36c(0x229)}}},{'shop':{'username':{'contains':_0x3022db,'mode':_0x53f36c(0x229)}}},{'notes':{'contains':_0x3022db,'mode':_0x53f36c(0x229)}}]);const [_0x573b55,_0x4ad366]=await Promise['all']([database_1[_0x53f36c(0x227)][_0x53f36c(0x154)]['findMany']({'where':_0x478cee,'skip':_0x1616a4,'take':_0x4c15cb,'orderBy':{'createdAt':_0x53f36c(0x14f)},'select':{'id':!![],'shopId':!![],'amount':!![],'network':!![],'status':!![],'txid':!![],'notes':!![],'periodFrom':!![],'periodTo':!![],'createdAt':!![],'paidAt':!![],'shop':{'select':{'name':!![],'username':!![]}}}}),database_1['default'][_0x53f36c(0x154)][_0x53f36c(0x217)]({'where':_0x478cee})]);return{'payouts':_0x573b55[_0x53f36c(0x1db)](_0x3742d5=>({'id':_0x3742d5['id'],'shopId':_0x3742d5[_0x53f36c(0x112)],'shopName':_0x3742d5[_0x53f36c(0x145)]['name'],'shopUsername':_0x3742d5[_0x53f36c(0x145)][_0x53f36c(0x19b)],'amount':_0x3742d5[_0x53f36c(0x20b)],'network':_0x3742d5['network'],'status':_0x3742d5['status'],'txid':_0x3742d5[_0x53f36c(0x1ef)],'notes':_0x3742d5[_0x53f36c(0x128)],'periodFrom':_0x3742d5[_0x53f36c(0x121)],'periodTo':_0x3742d5[_0x53f36c(0x138)],'createdAt':_0x3742d5['createdAt'],'paidAt':_0x3742d5[_0x53f36c(0x180)]})),'pagination':{'page':_0x26ce7b,'limit':_0x4c15cb,'total':_0x4ad366,'totalPages':Math[_0x53f36c(0x15a)](_0x4ad366/_0x4c15cb)}};}async[a36_0x5dfbb9(0x10c)](_0x575869){const _0x497267=a36_0x5dfbb9,_0x253ffd=await database_1['default'][_0x497267(0x154)]['findUnique']({'where':{'id':_0x575869},'include':{'shop':{'select':{'name':!![],'username':!![]}}}});if(!_0x253ffd)return null;return{'id':_0x253ffd['id'],'shopId':_0x253ffd[_0x497267(0x112)],'shopName':_0x253ffd[_0x497267(0x145)][_0x497267(0x115)],'shopUsername':_0x253ffd[_0x497267(0x145)][_0x497267(0x19b)],'amount':_0x253ffd[_0x497267(0x20b)],'network':_0x253ffd[_0x497267(0x1f6)],'status':_0x253ffd[_0x497267(0x17d)],'txid':_0x253ffd[_0x497267(0x1ef)],'notes':_0x253ffd['notes'],'periodFrom':_0x253ffd[_0x497267(0x121)],'periodTo':_0x253ffd[_0x497267(0x138)],'createdAt':_0x253ffd[_0x497267(0x106)],'paidAt':_0x253ffd[_0x497267(0x180)]};}async[a36_0x5dfbb9(0x120)](_0x3fa884){const _0x581063=a36_0x5dfbb9;await database_1[_0x581063(0x227)][_0x581063(0x154)][_0x581063(0xf1)]({'where':{'id':_0x3fa884}});}async[a36_0x5dfbb9(0x21e)](_0x28a464){const _0x22e8c6=a36_0x5dfbb9,{page:_0x1bbc3c,limit:_0x453a0c,status:_0x368268,gateway:_0x3fcf3a,shopId:_0x2efdb5,dateFrom:_0x3d2a02,dateTo:_0x83e5ba,search:_0xf15ad9,currency:_0x2a4e68,sortBy:_0xba19be,sortOrder:_0x3a083d}=_0x28a464,_0xd8276b=(_0x1bbc3c-0x1)*_0x453a0c;console[_0x22e8c6(0x1d5)]('📊\x20Getting\x20payments\x20with\x20filters:',_0x28a464);const _0x2c5f3a=await database_1[_0x22e8c6(0x227)][_0x22e8c6(0x1f9)][_0x22e8c6(0x143)]({'by':[_0x22e8c6(0x16d)],'_count':{'gateway':!![]}});console['log'](_0x22e8c6(0x1c9),_0x2c5f3a[_0x22e8c6(0x1db)](_0x2228ae=>_0x2228ae['gateway']+'\x20('+_0x2228ae[_0x22e8c6(0x1f4)][_0x22e8c6(0x16d)]+_0x22e8c6(0x1da)));if(_0x3fcf3a){const _0x5e18e5=_0x2c5f3a['some'](_0xf8c31f=>_0xf8c31f[_0x22e8c6(0x16d)][_0x22e8c6(0xf2)]()===_0x3fcf3a[_0x22e8c6(0xf2)]());!_0x5e18e5&&_0x3fcf3a[_0x22e8c6(0xf2)]()!=='test_gateway'&&console['log'](_0x22e8c6(0x144)+_0x3fcf3a+_0x22e8c6(0x17c)+_0x2c5f3a[_0x22e8c6(0x1db)](_0x226fd5=>_0x226fd5[_0x22e8c6(0x16d)])[_0x22e8c6(0x1f1)](',\x20'));}const _0x4f211b={};_0x368268&&(_0x4f211b[_0x22e8c6(0x17d)]=_0x368268[_0x22e8c6(0x21b)]());if(!_0x3fcf3a)_0x4f211b[_0x22e8c6(0x16d)]={'not':_0x22e8c6(0x221)};else{if(_0x3fcf3a&&(_0x3fcf3a['toLowerCase']()==='test_gateway'||_0x3fcf3a===_0x22e8c6(0x12b)))_0x4f211b[_0x22e8c6(0x16d)]=_0x22e8c6(0x221);else{let _0x5ec914=_0x3fcf3a;const _0x3fb22e=(0x0,gateway_1[_0x22e8c6(0x1d0)])(_0x3fcf3a);if(_0x3fb22e)_0x5ec914=_0x3fb22e,console[_0x22e8c6(0x1d5)](_0x22e8c6(0x218)+_0x3fcf3a+_0x22e8c6(0xfb)+_0x5ec914+'\x27');else{const _0x45da17=(0x0,gateway_1['getGatewayIdByName'])(_0x3fcf3a);if(_0x45da17){const _0x47e86b=(0x0,gateway_1['getGatewayNameById'])(_0x45da17);_0x47e86b&&(_0x5ec914=_0x47e86b,console['log']('🔄\x20Converted\x20gateway\x20name\x20\x27'+_0x3fcf3a+'\x27\x20->\x20ID\x20\x27'+_0x45da17+_0x22e8c6(0x20f)+_0x5ec914+'\x27'));}else console[_0x22e8c6(0x1d5)](_0x22e8c6(0x108)+_0x3fcf3a+_0x22e8c6(0x202));}const _0x474b5c=await database_1[_0x22e8c6(0x227)][_0x22e8c6(0x1f9)][_0x22e8c6(0x217)]({'where':{'gateway':_0x5ec914[_0x22e8c6(0xf2)]()},'take':0x1});_0x474b5c===0x0?(console['log'](_0x22e8c6(0x182)+_0x5ec914+_0x22e8c6(0xff)+_0x3fcf3a+_0x22e8c6(0x147)),_0x4f211b['gateway']=_0x22e8c6(0xec)):(_0x4f211b['gateway']=_0x5ec914[_0x22e8c6(0xf2)](),console[_0x22e8c6(0x1d5)](_0x22e8c6(0x13d)+_0x5ec914+'\x27\x20(from\x20\x27'+_0x3fcf3a+'\x27)'));}}console[_0x22e8c6(0x1d5)](_0x22e8c6(0x1a5),_0x4f211b[_0x22e8c6(0x16d)]);_0x2efdb5&&(_0x4f211b[_0x22e8c6(0x112)]=_0x2efdb5);_0x2a4e68&&(_0x4f211b[_0x22e8c6(0x171)]=_0x2a4e68['toUpperCase'](),console['log'](_0x22e8c6(0x1d7)+_0x2a4e68[_0x22e8c6(0x21b)]()));(_0x3d2a02||_0x83e5ba)&&(_0x4f211b[_0x22e8c6(0x106)]={},_0x3d2a02&&(_0x4f211b[_0x22e8c6(0x106)][_0x22e8c6(0x17f)]=new Date(_0x3d2a02)),_0x83e5ba&&(_0x4f211b['createdAt'][_0x22e8c6(0x1fc)]=new Date(_0x83e5ba)));_0xf15ad9&&(_0x4f211b['OR']=[{'id':{'contains':_0xf15ad9,'mode':_0x22e8c6(0x229)}},{'orderId':{'contains':_0xf15ad9,'mode':_0x22e8c6(0x229)}},{'gatewayOrderId':{'contains':_0xf15ad9,'mode':'insensitive'}},{'customerEmail':{'contains':_0xf15ad9,'mode':'insensitive'}},{'shop':{'name':{'contains':_0xf15ad9,'mode':_0x22e8c6(0x229)}}},{'shop':{'username':{'contains':_0xf15ad9,'mode':_0x22e8c6(0x229)}}}]);console[_0x22e8c6(0x1d5)]('📊\x20Final\x20WHERE\x20conditions:',JSON[_0x22e8c6(0x155)](_0x4f211b,null,0x2));let _0x4ae7ed={'createdAt':'desc'};if(_0xba19be){const _0x41b75d=['amount',_0x22e8c6(0x106),'updatedAt','status',_0x22e8c6(0x16d),'currency'],_0x21f296=[_0x22e8c6(0x1d3),_0x22e8c6(0x14f)];if(_0x41b75d['includes'](_0xba19be)){const _0x31dd22=_0x21f296[_0x22e8c6(0x201)](_0x3a083d)?_0x3a083d:'desc';_0x4ae7ed={[_0xba19be]:_0x31dd22},console[_0x22e8c6(0x1d5)](_0x22e8c6(0x14c)+_0xba19be+_0x22e8c6(0x20e)+_0x31dd22+_0x22e8c6(0x113));}}const [_0x3e15ab,_0x2881e6]=await Promise['all']([database_1['default'][_0x22e8c6(0x1f9)]['findMany']({'where':_0x4f211b,'skip':_0xd8276b,'take':_0x453a0c,'orderBy':_0x4ae7ed,'select':{'id':!![],'shopId':!![],'amount':!![],'amountAfterGatewayCommissionUSDT':!![],'currency':!![],'sourceCurrency':!![],'status':!![],'gateway':!![],'orderId':!![],'gatewayOrderId':!![],'customerEmail':!![],'customerName':!![],'customerCountry':!![],'customerIp':!![],'customerUa':!![],'createdAt':!![],'updatedAt':!![],'shop':{'select':{'name':!![],'username':!![]}}}}),database_1[_0x22e8c6(0x227)][_0x22e8c6(0x1f9)][_0x22e8c6(0x217)]({'where':_0x4f211b})]);return{'payments':_0x3e15ab,'pagination':{'page':_0x1bbc3c,'limit':_0x453a0c,'total':_0x2881e6,'totalPages':Math[_0x22e8c6(0x15a)](_0x2881e6/_0x453a0c)}};}async[a36_0x5dfbb9(0x10e)](_0x4a645c){const _0x3d024d=a36_0x5dfbb9,_0x5bb87e=await database_1[_0x3d024d(0x227)][_0x3d024d(0x1f9)]['findUnique']({'where':{'id':_0x4a645c},'select':{'id':!![],'shopId':!![],'amount':!![],'amountAfterGatewayCommissionUSDT':!![],'currency':!![],'sourceCurrency':!![],'status':!![],'gateway':!![],'orderId':!![],'gatewayOrderId':!![],'gatewayPaymentId':!![],'customerEmail':!![],'customerName':!![],'customerCountry':!![],'customerIp':!![],'customerUa':!![],'externalPaymentUrl':!![],'successUrl':!![],'failUrl':!![],'pendingUrl':!![],'whiteUrl':!![],'expiresAt':!![],'invoiceTotalSum':!![],'qrCode':!![],'qrUrl':!![],'country':!![],'language':!![],'amountIsEditable':!![],'maxPayments':!![],'rapydCustomer':!![],'cardLast4':!![],'paymentMethod':!![],'bankId':!![],'remitterIban':!![],'remitterName':!![],'failureMessage':!![],'usage':!![],'createdAt':!![],'updatedAt':!![],'shop':{'select':{'name':!![],'username':!![]}}}});if(!_0x5bb87e)return null;return{'id':_0x5bb87e['id'],'shopId':_0x5bb87e[_0x3d024d(0x112)],'gateway':_0x5bb87e['gateway'],'amount':_0x5bb87e['amount'],'currency':_0x5bb87e[_0x3d024d(0x171)],'status':_0x5bb87e[_0x3d024d(0x17d)],'orderId':_0x5bb87e['orderId'],'gatewayOrderId':_0x5bb87e[_0x3d024d(0x124)],'customerEmail':_0x5bb87e[_0x3d024d(0x1c1)],'customerName':_0x5bb87e['customerName'],'customerCountry':_0x5bb87e[_0x3d024d(0x18c)],'customerIp':_0x5bb87e[_0x3d024d(0x212)],'customerUa':_0x5bb87e[_0x3d024d(0x15e)],'failureMessage':_0x5bb87e[_0x3d024d(0x1ca)],'externalPaymentUrl':_0x5bb87e[_0x3d024d(0x109)],'successUrl':_0x5bb87e[_0x3d024d(0x169)],'failUrl':_0x5bb87e[_0x3d024d(0x12e)],'pendingUrl':_0x5bb87e[_0x3d024d(0x1ce)],'whiteUrl':_0x5bb87e[_0x3d024d(0x18e)],'createdAt':_0x5bb87e[_0x3d024d(0x106)],'updatedAt':_0x5bb87e[_0x3d024d(0x17b)],'shop':_0x5bb87e[_0x3d024d(0x145)]};}async[a36_0x5dfbb9(0x116)](_0x2b3caf,_0x50569f,_0x200485,_0x20bd73){const _0x1e289d=a36_0x5dfbb9,_0x194503=await database_1[_0x1e289d(0x227)][_0x1e289d(0x193)](async _0x5f09ce=>{const _0x52bda7=_0x1e289d,_0xb6ccd9=await _0x5f09ce[_0x52bda7(0x1f9)]['findUnique']({'where':{'id':_0x2b3caf},'include':{'shop':{'select':{'id':!![],'name':!![],'username':!![],'balance':!![]}}}});if(!_0xb6ccd9)throw new Error(_0x52bda7(0x1cf));const _0x29d54e=_0xb6ccd9[_0x52bda7(0x17d)],_0x3162d0=_0x50569f['toUpperCase']();console['log'](_0x52bda7(0x1d1)+_0x2b3caf+_0x52bda7(0x157)+_0x29d54e+_0x52bda7(0x22a)+_0x3162d0),console['log']('💰\x20Current\x20shop\x20balance:\x20'+_0xb6ccd9[_0x52bda7(0x145)][_0x52bda7(0x198)]+_0x52bda7(0x190));const _0x28c776={'status':_0x3162d0,'updatedAt':new Date(),'statusChangedBy':_0x52bda7(0x1cc),'statusChangedAt':new Date()};_0x200485&&(_0x28c776[_0x52bda7(0x19c)]=_0x200485);_0x3162d0==='CHARGEBACK'&&_0x20bd73&&(_0x28c776[_0x52bda7(0x215)]=_0x20bd73);let _0x5d3aa6=0x0,_0x5e33ba=_0xb6ccd9[_0x52bda7(0x145)][_0x52bda7(0x198)];if(_0x3162d0===_0x52bda7(0x172)&&_0x29d54e!==_0x52bda7(0x172)){_0x28c776[_0x52bda7(0x180)]=new Date();const _0x5b2a72=await currencyService_1[_0x52bda7(0x1e0)][_0x52bda7(0x21a)](_0xb6ccd9[_0x52bda7(0x20b)],_0xb6ccd9[_0x52bda7(0x171)]);_0x28c776[_0x52bda7(0x208)]=_0x5b2a72;let _0x15eb71=0xa;const _0x44fa3b=await _0x5f09ce[_0x52bda7(0x145)]['findUnique']({'where':{'id':_0xb6ccd9[_0x52bda7(0x112)]},'select':{'gatewaySettings':!![]}});if(_0x44fa3b?.['gatewaySettings'])try{const _0x33be85=JSON['parse'](_0x44fa3b['gatewaySettings']);for(const [_0x15d0e9,_0x6159e6]of Object['entries'](_0x33be85)){if(_0x15d0e9[_0x52bda7(0xf2)]()===_0xb6ccd9[_0x52bda7(0x16d)][_0x52bda7(0xf2)]()){_0x15eb71=_0x6159e6['commission']||0xa;break;}}}catch(_0x26bea2){console['error']('Error\x20parsing\x20gateway\x20settings\x20for\x20payment\x20'+_0x2b3caf+':',_0x26bea2);}let _0x2e4f46;_0xb6ccd9[_0x52bda7(0x1e8)]!==null&&_0xb6ccd9[_0x52bda7(0x1e8)]!==undefined?(_0x2e4f46=_0xb6ccd9['amountAfterGatewayCommissionUSDT'],console['log'](_0x52bda7(0xf6)+_0x2e4f46['toFixed'](0x6)+'\x20USDT\x20for\x20payment\x20'+_0x2b3caf)):(_0x2e4f46=_0x5b2a72*(0x1-_0x15eb71/0x64),console[_0x52bda7(0x1d5)]('📊\x20[ADMIN]\x20Calculating\x20commission\x20manually\x20for\x20payment\x20'+_0x2b3caf+':\x20'+_0x15eb71+_0x52bda7(0x1e9)+_0x5b2a72['toFixed'](0x6)+'\x20USDT'),_0x28c776[_0x52bda7(0x1e8)]=_0x2e4f46),_0x5d3aa6=_0x2e4f46,_0x5e33ba+=_0x2e4f46,console['log'](_0x52bda7(0x20c)+_0x2b3caf+_0x52bda7(0x15d)),console[_0x52bda7(0x1d5)](_0x52bda7(0xf0)+_0x5b2a72[_0x52bda7(0xf7)](0x6)+_0x52bda7(0x190)),console['log'](_0x52bda7(0x103)+_0xb6ccd9['gateway']+',\x20Commission:\x20'+_0x15eb71+'%'),console['log'](_0x52bda7(0x10a)+_0x2e4f46[_0x52bda7(0xf7)](0x6)+_0x52bda7(0x188)+_0x15eb71+_0x52bda7(0x158)),console[_0x52bda7(0x1d5)](_0x52bda7(0x1aa)+_0x2e4f46[_0x52bda7(0xf7)](0x6)+_0x52bda7(0x190));}else{if(_0x29d54e===_0x52bda7(0x172)&&_0x3162d0!=='PAID'){if(_0xb6ccd9['amountUSDT']){let _0x2ba97c=0xa;const _0x353ec7=await _0x5f09ce[_0x52bda7(0x145)][_0x52bda7(0x164)]({'where':{'id':_0xb6ccd9[_0x52bda7(0x112)]},'select':{'gatewaySettings':!![]}});if(_0x353ec7?.['gatewaySettings'])try{const _0x49cd50=JSON[_0x52bda7(0xf8)](_0x353ec7[_0x52bda7(0x18a)]);for(const [_0x2ed057,_0x5b93c8]of Object[_0x52bda7(0x1b4)](_0x49cd50)){if(_0x2ed057[_0x52bda7(0xf2)]()===_0xb6ccd9['gateway'][_0x52bda7(0xf2)]()){_0x2ba97c=_0x5b93c8['commission']||0xa;break;}}}catch(_0x48523c){console[_0x52bda7(0x1e7)]('Error\x20parsing\x20gateway\x20settings\x20for\x20payment\x20'+_0x2b3caf+':',_0x48523c);}const _0x34846e=_0xb6ccd9['amountUSDT']*(0x1-_0x2ba97c/0x64);_0x5d3aa6=-_0x34846e,_0x5e33ba-=_0x34846e,_0x28c776[_0x52bda7(0x208)]=null,_0x28c776[_0x52bda7(0x1e8)]=null,console[_0x52bda7(0x1d5)](_0x52bda7(0x20c)+_0x2b3caf+'\x20no\x20longer\x20PAID:'),console[_0x52bda7(0x1d5)](_0x52bda7(0xf0)+_0xb6ccd9['amountUSDT'][_0x52bda7(0xf7)](0x6)+_0x52bda7(0x190)),console[_0x52bda7(0x1d5)](_0x52bda7(0x103)+_0xb6ccd9['gateway']+_0x52bda7(0x1e3)+_0x2ba97c+'%'),console['log'](_0x52bda7(0x146)+_0x34846e['toFixed'](0x6)+_0x52bda7(0x188)+_0x2ba97c+_0x52bda7(0x158)),console[_0x52bda7(0x1d5)](_0x52bda7(0x129)+_0x34846e[_0x52bda7(0xf7)](0x6)+_0x52bda7(0x190));}}}_0x3162d0===_0x52bda7(0x176)&&(_0x29d54e===_0x52bda7(0x172)&&_0xb6ccd9[_0x52bda7(0x208)]&&console[_0x52bda7(0x1d5)](_0x52bda7(0x16f)),_0x20bd73&&_0x20bd73>0x0&&(_0x5d3aa6-=_0x20bd73,_0x5e33ba-=_0x20bd73,console['log'](_0x52bda7(0x14a)+_0x20bd73['toFixed'](0x6)+_0x52bda7(0x126))));_0x3162d0===_0x52bda7(0x174)&&_0x29d54e==='PAID'&&console[_0x52bda7(0x1d5)](_0x52bda7(0x192));const _0x21738e=await _0x5f09ce[_0x52bda7(0x1f9)]['update']({'where':{'id':_0x2b3caf},'data':_0x28c776,'include':{'shop':{'select':{'name':!![],'username':!![]}}}});return _0x5d3aa6!==0x0&&(await _0x5f09ce[_0x52bda7(0x145)][_0x52bda7(0x1b8)]({'where':{'id':_0xb6ccd9[_0x52bda7(0x112)]},'data':{'balance':_0x5e33ba}}),console[_0x52bda7(0x1d5)](_0x52bda7(0x148)+_0xb6ccd9['shopId']+_0x52bda7(0x123)+_0xb6ccd9[_0x52bda7(0x145)][_0x52bda7(0x198)][_0x52bda7(0xf7)](0x6)+_0x52bda7(0x22a)+_0x5e33ba['toFixed'](0x6)+_0x52bda7(0x14b)+(_0x5d3aa6>0x0?'+':'')+_0x5d3aa6[_0x52bda7(0xf7)](0x6)+')')),_0x21738e;});return{'id':_0x194503['id'],'shopId':_0x194503['shopId'],'gateway':_0x194503[_0x1e289d(0x16d)],'amount':_0x194503[_0x1e289d(0x20b)],'currency':_0x194503['currency'],'status':_0x194503[_0x1e289d(0x17d)],'orderId':_0x194503['orderId'],'gatewayOrderId':_0x194503[_0x1e289d(0x124)],'customerEmail':_0x194503['customerEmail'],'customerName':_0x194503[_0x1e289d(0x101)],'customerCountry':_0x194503[_0x1e289d(0x18c)],'customerIp':_0x194503[_0x1e289d(0x212)],'customerUa':_0x194503[_0x1e289d(0x15e)],'failureMessage':_0x194503[_0x1e289d(0x1ca)],'adminNotes':_0x194503[_0x1e289d(0x19c)],'chargebackAmount':_0x194503[_0x1e289d(0x215)],'statusChangedBy':_0x194503[_0x1e289d(0x213)],'statusChangedAt':_0x194503[_0x1e289d(0x228)],'createdAt':_0x194503[_0x1e289d(0x106)],'updatedAt':_0x194503['updatedAt'],'shop':_0x194503[_0x1e289d(0x145)]};}async[a36_0x5dfbb9(0x195)](_0x554107,_0xb44a9f){const _0x3e759a=a36_0x5dfbb9,_0x424baf=Math[_0x3e759a(0x199)]()['toString'](0x24)[_0x3e759a(0x1e2)](0x2,0x9);console[_0x3e759a(0x1d5)](_0x3e759a(0x135)+_0x424baf+_0x3e759a(0x189)+_0x554107);const _0x2b4318={..._0xb44a9f};_0xb44a9f['password']&&_0xb44a9f[_0x3e759a(0x159)][_0x3e759a(0x1df)]()!==''?(console['log'](_0x3e759a(0x1a8)+_0x424baf+_0x3e759a(0x1c8)+_0x554107),_0x2b4318['password']=await bcryptjs_1[_0x3e759a(0x227)][_0x3e759a(0xf9)](_0xb44a9f['password'],0xc)):(console[_0x3e759a(0x1d5)]('🔐\x20['+_0x424baf+_0x3e759a(0x14d)),delete _0x2b4318['password']);_0xb44a9f[_0x3e759a(0x1fe)]&&(_0x2b4318[_0x3e759a(0x115)]=_0xb44a9f['fullName'],delete _0x2b4318[_0x3e759a(0x1fe)]);_0xb44a9f[_0x3e759a(0x194)]&&(_0x2b4318[_0x3e759a(0x167)]=_0xb44a9f['telegramId'],delete _0x2b4318[_0x3e759a(0x194)]);_0xb44a9f['merchantUrl']&&(_0x2b4318[_0x3e759a(0x132)]=_0xb44a9f['merchantUrl'],delete _0x2b4318[_0x3e759a(0x117)]);if(_0xb44a9f[_0x3e759a(0x1c2)]){const _0x33ec61=_0xb44a9f[_0x3e759a(0x1c2)]['map'](_0x4e31e3=>this[_0x3e759a(0x131)](_0x4e31e3));console['log'](_0x3e759a(0x175),_0xb44a9f['gateways'],'->',_0x33ec61),_0x2b4318[_0x3e759a(0x211)]=JSON[_0x3e759a(0x155)](_0x33ec61),delete _0x2b4318['gateways'];}_0xb44a9f[_0x3e759a(0x18a)]&&(console[_0x3e759a(0x1d5)](_0x3e759a(0x18b)+_0x424baf+_0x3e759a(0xef),_0xb44a9f[_0x3e759a(0x18a)]),_0x2b4318[_0x3e759a(0x18a)]=JSON[_0x3e759a(0x155)](_0xb44a9f['gatewaySettings']),console[_0x3e759a(0x1d5)]('🔧\x20['+_0x424baf+']\x20Gateway\x20settings\x20JSON\x20string:',_0x2b4318[_0x3e759a(0x18a)]));_0xb44a9f[_0x3e759a(0x1a1)]&&(_0xb44a9f['wallets']['usdtPolygonWallet']!==undefined&&(_0x2b4318[_0x3e759a(0x1fb)]=_0xb44a9f[_0x3e759a(0x1a1)][_0x3e759a(0x1fb)]||null),_0xb44a9f[_0x3e759a(0x1a1)][_0x3e759a(0x1c7)]!==undefined&&(_0x2b4318[_0x3e759a(0x1c7)]=_0xb44a9f[_0x3e759a(0x1a1)][_0x3e759a(0x1c7)]||null),_0xb44a9f[_0x3e759a(0x1a1)][_0x3e759a(0x1b1)]!==undefined&&(_0x2b4318[_0x3e759a(0x1b1)]=_0xb44a9f['wallets']['usdtErcWallet']||null),_0xb44a9f[_0x3e759a(0x1a1)][_0x3e759a(0x225)]!==undefined&&(_0x2b4318['usdcPolygonWallet']=_0xb44a9f[_0x3e759a(0x1a1)][_0x3e759a(0x225)]||null),delete _0x2b4318[_0x3e759a(0x1a1)]);const _0x104d66=await database_1[_0x3e759a(0x227)][_0x3e759a(0x145)][_0x3e759a(0x1b8)]({'where':{'id':_0x554107},'data':_0x2b4318,'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});return console[_0x3e759a(0x1d5)](_0x3e759a(0x1cb)+_0x424baf+_0x3e759a(0x13a),_0x104d66['gatewaySettings']),{'id':_0x104d66['id'],'fullName':_0x104d66[_0x3e759a(0x115)],'username':_0x104d66[_0x3e759a(0x19b)],'telegramId':_0x104d66['telegram'],'merchantUrl':_0x104d66[_0x3e759a(0x132)],'gateways':_0x104d66[_0x3e759a(0x211)]?JSON['parse'](_0x104d66[_0x3e759a(0x211)]):null,'gatewaySettings':_0x104d66['gatewaySettings']?JSON[_0x3e759a(0xf8)](_0x104d66[_0x3e759a(0x18a)]):null,'publicKey':_0x104d66[_0x3e759a(0x224)],'wallets':{'usdtPolygonWallet':_0x104d66[_0x3e759a(0x1fb)],'usdtTrcWallet':_0x104d66[_0x3e759a(0x1c7)],'usdtErcWallet':_0x104d66[_0x3e759a(0x1b1)],'usdcPolygonWallet':_0x104d66[_0x3e759a(0x225)]},'status':_0x104d66[_0x3e759a(0x17d)],'createdAt':_0x104d66[_0x3e759a(0x106)]};}async[a36_0x5dfbb9(0x152)](_0x32425e){const _0x59a736=a36_0x5dfbb9,_0xc2aa00=await database_1[_0x59a736(0x227)][_0x59a736(0x145)][_0x59a736(0x1b8)]({'where':{'id':_0x32425e},'data':{'status':'SUSPENDED'},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});return{'id':_0xc2aa00['id'],'fullName':_0xc2aa00['name'],'username':_0xc2aa00['username'],'telegramId':_0xc2aa00[_0x59a736(0x167)],'merchantUrl':_0xc2aa00[_0x59a736(0x132)],'gateways':_0xc2aa00[_0x59a736(0x211)]?JSON['parse'](_0xc2aa00[_0x59a736(0x211)]):null,'gatewaySettings':_0xc2aa00[_0x59a736(0x18a)]?JSON['parse'](_0xc2aa00[_0x59a736(0x18a)]):null,'publicKey':_0xc2aa00[_0x59a736(0x224)],'wallets':{'usdtPolygonWallet':_0xc2aa00[_0x59a736(0x1fb)],'usdtTrcWallet':_0xc2aa00[_0x59a736(0x1c7)],'usdtErcWallet':_0xc2aa00[_0x59a736(0x1b1)],'usdcPolygonWallet':_0xc2aa00[_0x59a736(0x225)]},'status':_0xc2aa00[_0x59a736(0x17d)],'createdAt':_0xc2aa00[_0x59a736(0x106)]};}async[a36_0x5dfbb9(0x187)](_0x4bd3e2){const _0x4f35f4=a36_0x5dfbb9,_0x4da2c4=await database_1['default'][_0x4f35f4(0x145)][_0x4f35f4(0x1b8)]({'where':{'id':_0x4bd3e2},'data':{'status':_0x4f35f4(0x11a)},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});return{'id':_0x4da2c4['id'],'fullName':_0x4da2c4[_0x4f35f4(0x115)],'username':_0x4da2c4['username'],'telegramId':_0x4da2c4[_0x4f35f4(0x167)],'merchantUrl':_0x4da2c4[_0x4f35f4(0x132)],'gateways':_0x4da2c4[_0x4f35f4(0x211)]?JSON[_0x4f35f4(0xf8)](_0x4da2c4[_0x4f35f4(0x211)]):null,'gatewaySettings':_0x4da2c4['gatewaySettings']?JSON[_0x4f35f4(0xf8)](_0x4da2c4[_0x4f35f4(0x18a)]):null,'publicKey':_0x4da2c4[_0x4f35f4(0x224)],'wallets':{'usdtPolygonWallet':_0x4da2c4['usdtPolygonWallet'],'usdtTrcWallet':_0x4da2c4[_0x4f35f4(0x1c7)],'usdtErcWallet':_0x4da2c4['usdtErcWallet'],'usdcPolygonWallet':_0x4da2c4['usdcPolygonWallet']},'status':_0x4da2c4[_0x4f35f4(0x17d)],'createdAt':_0x4da2c4['createdAt']};}async['getAllUsers'](_0x1cdc11){const _0x1dfe12=a36_0x5dfbb9,{page:_0x2bbd4e,limit:_0x49f0a5,status:_0x1e0814}=_0x1cdc11,_0xae2c79=(_0x2bbd4e-0x1)*_0x49f0a5,_0x375667={};_0x1e0814&&(_0x375667[_0x1dfe12(0x17d)]=_0x1e0814[_0x1dfe12(0x21b)]());const [_0x4d45af,_0x45b38c]=await Promise[_0x1dfe12(0x1ba)]([database_1['default'][_0x1dfe12(0x145)]['findMany']({'where':_0x375667,'skip':_0xae2c79,'take':_0x49f0a5,'orderBy':{'createdAt':_0x1dfe12(0x14f)},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}}),database_1[_0x1dfe12(0x227)][_0x1dfe12(0x145)][_0x1dfe12(0x217)]({'where':_0x375667})]);return{'users':_0x4d45af[_0x1dfe12(0x1db)](_0x184ff0=>{const _0x8c0010=_0x1dfe12,_0x4a10f4=_0x184ff0[_0x8c0010(0x211)]?JSON[_0x8c0010(0xf8)](_0x184ff0[_0x8c0010(0x211)]):null,_0x5ed64f=_0x4a10f4?_0x4a10f4[_0x8c0010(0x1db)](_0xaea7e=>this[_0x8c0010(0x170)](_0xaea7e)):null;return{'id':_0x184ff0['id'],'fullName':_0x184ff0['name'],'username':_0x184ff0['username'],'telegramId':_0x184ff0[_0x8c0010(0x167)],'merchantUrl':_0x184ff0[_0x8c0010(0x132)],'gateways':_0x5ed64f,'gatewaySettings':_0x184ff0['gatewaySettings']?JSON[_0x8c0010(0xf8)](_0x184ff0['gatewaySettings']):null,'publicKey':_0x184ff0['publicKey'],'wallets':{'usdtPolygonWallet':_0x184ff0[_0x8c0010(0x1fb)],'usdtTrcWallet':_0x184ff0['usdtTrcWallet'],'usdtErcWallet':_0x184ff0[_0x8c0010(0x1b1)],'usdcPolygonWallet':_0x184ff0['usdcPolygonWallet']},'status':_0x184ff0[_0x8c0010(0x17d)],'createdAt':_0x184ff0['createdAt']};}),'pagination':{'page':_0x2bbd4e,'limit':_0x49f0a5,'total':_0x45b38c,'totalPages':Math[_0x1dfe12(0x15a)](_0x45b38c/_0x49f0a5)}};}async[a36_0x5dfbb9(0x1a6)](_0x1221de){const _0x4ef01b=a36_0x5dfbb9,_0x4ba33e=await database_1[_0x4ef01b(0x227)]['shop'][_0x4ef01b(0x164)]({'where':{'id':_0x1221de},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});if(!_0x4ba33e)return null;const _0x521add=_0x4ba33e[_0x4ef01b(0x211)]?JSON[_0x4ef01b(0xf8)](_0x4ba33e[_0x4ef01b(0x211)]):null,_0x293025=_0x521add?_0x521add[_0x4ef01b(0x1db)](_0x362653=>this[_0x4ef01b(0x170)](_0x362653)):null;return _0x521add&&_0x293025&&console[_0x4ef01b(0x1d5)](_0x4ef01b(0x1ea),_0x521add,'->',_0x293025),{'id':_0x4ba33e['id'],'fullName':_0x4ba33e[_0x4ef01b(0x115)],'username':_0x4ba33e[_0x4ef01b(0x19b)],'telegramId':_0x4ba33e[_0x4ef01b(0x167)],'merchantUrl':_0x4ba33e[_0x4ef01b(0x132)],'gateways':_0x293025,'gatewaySettings':_0x4ba33e[_0x4ef01b(0x18a)]?JSON[_0x4ef01b(0xf8)](_0x4ba33e[_0x4ef01b(0x18a)]):null,'publicKey':_0x4ba33e[_0x4ef01b(0x224)],'wallets':{'usdtPolygonWallet':_0x4ba33e[_0x4ef01b(0x1fb)],'usdtTrcWallet':_0x4ba33e[_0x4ef01b(0x1c7)],'usdtErcWallet':_0x4ba33e[_0x4ef01b(0x1b1)],'usdcPolygonWallet':_0x4ba33e[_0x4ef01b(0x225)]},'status':_0x4ba33e[_0x4ef01b(0x17d)],'createdAt':_0x4ba33e[_0x4ef01b(0x106)]};}async['createUser'](_0x6deec7){const _0x17f24e=a36_0x5dfbb9,{fullName:_0x4038e6,username:_0x5039a3,password:_0x21b8ac,telegramId:_0x473d78,merchantUrl:_0x5aa923,gateways:_0x519a41,gatewaySettings:_0x4cc592,wallets:_0x68c717}=_0x6deec7,_0x52bfb4=await database_1[_0x17f24e(0x227)][_0x17f24e(0x145)]['findUnique']({'where':{'username':_0x5039a3}});if(_0x52bfb4)throw new Error(_0x17f24e(0x1dc));if(_0x473d78){const _0x143129=await database_1[_0x17f24e(0x227)][_0x17f24e(0x145)]['findUnique']({'where':{'telegram':_0x473d78}});if(_0x143129)throw new Error(_0x17f24e(0x133));}const _0x9a3cd8=await bcryptjs_1[_0x17f24e(0x227)]['hash'](_0x21b8ac,0xc),_0x323195=_0x17f24e(0x16e)+crypto_1[_0x17f24e(0x227)]['randomBytes'](0x20)[_0x17f24e(0x13c)](_0x17f24e(0x1b7)),_0x4da9e3=_0x17f24e(0xfc)+crypto_1[_0x17f24e(0x227)][_0x17f24e(0x1a7)](0x20)['toString']('hex'),_0x365d4e=_0x519a41?_0x519a41[_0x17f24e(0x1db)](_0x573186=>this['getGatewayInternalName'](_0x573186)):null;_0x519a41&&_0x365d4e&&console[_0x17f24e(0x1d5)]('🔄\x20Gateway\x20mapping\x20(create):',_0x519a41,'->',_0x365d4e);const _0x577d50=await database_1['default'][_0x17f24e(0x145)][_0x17f24e(0x178)]({'data':{'name':_0x4038e6,'username':_0x5039a3,'password':_0x9a3cd8,'telegram':_0x473d78,'shopUrl':_0x5aa923,'paymentGateways':_0x365d4e?JSON[_0x17f24e(0x155)](_0x365d4e):null,'gatewaySettings':_0x4cc592?JSON['stringify'](_0x4cc592):null,'usdtPolygonWallet':_0x68c717?.[_0x17f24e(0x1fb)]||null,'usdtTrcWallet':_0x68c717?.[_0x17f24e(0x1c7)]||null,'usdtErcWallet':_0x68c717?.['usdtErcWallet']||null,'usdcPolygonWallet':_0x68c717?.[_0x17f24e(0x225)]||null,'publicKey':_0x323195,'secretKey':_0x4da9e3,'status':_0x17f24e(0x11a)},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});return{'id':_0x577d50['id'],'fullName':_0x577d50[_0x17f24e(0x115)],'username':_0x577d50[_0x17f24e(0x19b)],'telegramId':_0x577d50[_0x17f24e(0x167)],'merchantUrl':_0x577d50[_0x17f24e(0x132)],'gateways':_0x577d50['paymentGateways']?JSON[_0x17f24e(0xf8)](_0x577d50['paymentGateways']):null,'gatewaySettings':_0x577d50[_0x17f24e(0x18a)]?JSON[_0x17f24e(0xf8)](_0x577d50[_0x17f24e(0x18a)]):null,'publicKey':_0x577d50['publicKey'],'wallets':{'usdtPolygonWallet':_0x577d50[_0x17f24e(0x1fb)],'usdtTrcWallet':_0x577d50[_0x17f24e(0x1c7)],'usdtErcWallet':_0x577d50['usdtErcWallet'],'usdcPolygonWallet':_0x577d50[_0x17f24e(0x225)]},'status':_0x577d50[_0x17f24e(0x17d)],'createdAt':_0x577d50[_0x17f24e(0x106)]};}async[a36_0x5dfbb9(0x118)](_0x27b08f){const _0x3bf13e=a36_0x5dfbb9;await database_1[_0x3bf13e(0x227)][_0x3bf13e(0x145)][_0x3bf13e(0xf1)]({'where':{'id':_0x27b08f}});}['generateDailyStatistics'](_0x2b5103,_0x2cf6b2,_0x33a506){const _0x109508=a36_0x5dfbb9,_0x3cf730=new Map(),_0x3ab402=new Date(_0x2cf6b2);while(_0x3ab402<=_0x33a506){const _0x503db5=_0x3ab402[_0x109508(0x1e4)]()[_0x109508(0x219)]('T')[0x0];_0x3cf730[_0x109508(0x160)](_0x503db5,{'revenue':0x0,'count':0x0}),_0x3ab402[_0x109508(0x151)](_0x3ab402[_0x109508(0x1bf)]()+0x1);}for(const _0x322380 of _0x2b5103){const _0x46add8=_0x322380[_0x109508(0x106)][_0x109508(0x1e4)]()['split']('T')[0x0],_0x49f42d=_0x3cf730[_0x109508(0x100)](_0x46add8);_0x49f42d&&(_0x49f42d[_0x109508(0x217)]+=0x1,_0x322380[_0x109508(0x17d)]===_0x109508(0x172)&&(_0x322380['amountUSDT']?_0x49f42d['revenue']+=_0x322380[_0x109508(0x208)]:console[_0x109508(0x1d5)](_0x109508(0x1c5)+_0x322380['id']+_0x109508(0x12d))));}const _0x27af3a=[],_0xeb29e5=[];for(const [_0x4f6b20,_0x4c2656]of _0x3cf730){_0x27af3a[_0x109508(0x21f)]({'date':_0x4f6b20,'amount':Math[_0x109508(0x137)](_0x4c2656[_0x109508(0x226)]*0x64)/0x64}),_0xeb29e5['push']({'date':_0x4f6b20,'count':_0x4c2656[_0x109508(0x217)]});}return{'dailyRevenue':_0x27af3a,'dailyPayments':_0xeb29e5};}}exports[a36_0x5dfbb9(0xf5)]=AdminService;