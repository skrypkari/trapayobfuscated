'use strict';function a40_0x2aee(){const _0x4ad824=['commission','_sum','üí∞\x20[PAYOUT]\x20Merchant\x20','customerName','\x20USDT\x20(gross\x20revenue)','üîÑ\x20REFUND:\x20Payment\x20amount\x20already\x20deducted\x20from\x20balance','ceil','\x20->\x20','periodTo','suspendUser','getSystemStatistics','getMerchantStatistics','‚úÖ\x20Customer\x20data\x20updated\x20for\x20payment\x20','paidOutUSDT','toString','\x20missing\x20amountUSDT,\x20using\x20fallback\x20conversion','Telegram\x20username\x20already\x20exists','includes','rapyd','set','1946211zNgsUW','status','AdminService','merchantEarningsUSDT','\x20\x20\x20üíµ\x20Available\x20balance:\x20','üìä\x20Calculating\x20commission\x20manually\x20for\x20payment\x20','üìä\x20Merchants\x20with\x20rounded\x20balance\x20!=\x200.00:\x20','txid','\x20merchants\x20with\x20rounded\x20balance\x20!=\x200.00\x20(excluding\x20balances\x20that\x20round\x20to\x200.00)','\x20\x20\x20Tolerance:\x20','forEach','test_gateway','getGatewayNameById','successUrl','\x20\x20\x20üí∞\x20Total\x20turnover:\x20','üîÑ\x20Converted\x20gateway\x20ID\x20\x27','createdAt','deletePayout','\x20USDT\x20from\x20balance','telegram','\x20became\x20PAID:','reduce','custom','amountAfterCommissionUSDT','\x20USDT\x20(+','telegramId','adminNotes','üîÑ\x20Gateway\x20mapping:','\x20USDT\x20(sum\x20of\x20all\x20merchant\x20balances)','error','\x20\x20\x20‚è≥\x20Awaiting\x20payout:\x20','entries','gatewaySettings','‚ö†Ô∏è\x20Requested\x20gateway\x20\x27','üìä\x20[ADMIN]\x20Calculating\x20commission\x20manually\x20for\x20payment\x20','paymentGateways','createPayout','\x20\x20\x20Full\x20amount:\x20',',\x20userId:\x20','averageCommissionRate','\x20for\x20shop\x20','findUnique','../types/gateway','üìä\x20Calculating\x20payout\x20statistics...','updatedAt','admin','aggregate','\x20USDT\x20(rounded\x20to\x202\x20decimal\x20places)','\x20USDT','üìä\x20Using\x20saved\x20commission\x20rate\x20for\x20payment\x20','üí∞\x20Creating\x20payout\x20for\x20shop\x20','\x20has\x20zero\x20or\x20null\x20amountUSDT,\x20skipping...','\x20\x20\x20Requested\x20(number):\x20','min','usdcPolygonWallet','\x27\x20not\x20found.\x20Available\x20gateways:\x20','fullName','üìÖ\x20Period:\x20','desc','60IOKQxQ','updateUser','$transaction','PAID','toLowerCase','‚ö†Ô∏è\x20CHARGEBACK\x20without\x20penalty\x20amount\x20-\x20no\x20balance\x20change','KLYME\x20EU','getTime','amount','warn','\x27\x20->\x20name\x20\x27','merchantUrl','toISOString','üîß\x20[','‚úÖ\x20Using\x20gateway\x20filter:\x20\x27','%\x20from\x20','groupBy','dateTo','Username\x20already\x20exists','getPayoutById','üìä\x20Gateway\x20filter\x20applied:','\x20\x20\x20üí∏\x20Total\x20payouts\x20(all\x20time):\x20','Error\x20parsing\x20gateway\x20settings\x20for\x20shop\x20','CoinToPay','totalPaidOut','\x20\x20\x20Added\x20to\x20balance:\x20+','trc20','üí∏\x20CHARGEBACK\x20penalty\x20ONLY:\x20-','hash','_count','usdcErcWallet','\x20\x20\x20Final\x20payout\x20amount\x20used:\x20','amountAfterGatewayCommissionUSDT','cointopay2','balance','\x20USDT\x20(calculated\x20-\x20payouts\x20-\x20balance)','2020-01-01','length','%\x20commission)',',\x20successful:\x20','count','üîç\x20Balance\x20check\x20details:','72qnNGIQ','averageCheckUSDT','üîê\x20[','cointopay','date','\x20USDT)','gateway','\x20\x20\x20Available\x20(raw):\x20','üí∞\x20Found\x20','year','2584472WQKAGA','erc20','\x20\x20\x20Balance:\x20','revenue','convertToUSDT','\x20\x20\x20‚è≥\x20Pending\x20payout:\x20','\x20\x20\x20üí∞\x20Total\x20payout:\x20','findFirst','üí∏\x20CHARGEBACK:\x20Processing\x20penalty-only\x20deduction','\x20\x20\x20Available\x20(number):\x20','\x20\x20\x20Merchant\x20loses:\x20','usdtTrcWallet','turnoverUSDT','getAllPayments','REFUND','\x20payments)','gte','\x20USDT\x20for\x20payment\x20','3227550ChECND','klyme_eu','__esModule','Noda','polygon','4796hWyqMd','__importDefault','30d','üîÑ\x20Updating\x20customer\x20data\x20for\x20payment\x20','üìä\x20Merchant\x20statistics\x20calculated:','statusChangedAt','dailyPayments','polygon_usdc','shopUrl','\x20\x20\x20‚úÖ\x20Actual\x20available\x20balance:\x20','\x20\x20\x20ÔøΩüìä\x20Total\x20payments:\x20','turnover','dateFrom','hex','yesterday','getDate','customerIp','üîç\x20Using\x20gateway\x20\x27','usdtErcWallet','getAllUsers','totalPayments','some','\x20\x20\x20Current\x20total\x20paid\x20out:\x20','username','üìä\x20Total\x20payments\x20(including\x20failed):\x20','\x20\x20\x20Current\x20balance:\x20','üîÑ\x20Admin\x20updating\x20payment\x20','network','payout','default','totalAmountAfterCommissionUSDT','\x20to\x20','\x20\x20\x20üåê\x20IP:\x20','8489369dTDdhb','period','orderId','totalCommissionRate','push','getPaymentById','bcryptjs','üìã\x20Getting\x20merchants\x20selection\x20list...','getPayoutStats','\x20order','thisMonth','\x27\x20as\x20is\x20(not\x20found\x20in\x20mappings)','\x20in\x20','üí∞\x20[PAYOUT]\x20Gateway\x20','\x20USDT\x20(current\x20balance\x20in\x20DB)','22898riEEPS','round','amountUSDT','payment','\x20\x20\x20üí∏\x20Total\x20payouts:\x20','COMPLETED','\x20\x20\x20üåç\x20Country:\x20','84OjtIOv',',\x20Commission:\x20','\x20\x20\x20Merchant\x20gets:\x20','PENDING','chargebackAmount','getFullYear','join','failUrl','setDate','sort','gatewayEarnings','\x20USDT\x20(after\x20','wallets','paidAt','slice','5185oTLjac','üìä\x20Calculated\x20commission\x20rate\x20for\x20payment\x20','values','\x20\x20\x20üè™\x20Gateway\x20earnings:\x20','gateways','\x20USDT,\x20Requested:\x20','createUser','\x20status:\x20','usdtPolygonWallet','üí∞\x20Current\x20shop\x20balance:\x20','\x20\x20\x20ÔøΩ\x20Total\x20payments\x20turnover:\x20','not\x20specified',':\x20commission\x20=\x20','üìä\x20Using\x20saved\x20values\x20for\x20payment\x20','findMany','Error\x20parsing\x20gateway\x20settings\x20for\x20payment\x20','\x20USDT\x20(-','customerEmail','asc','month','shop','randomBytes','failureMessage','day','\x20USDT\x20(already\x20paid\x20out)','\x20\x20\x20Difference:\x20','toUpperCase','lte','gatewayCommissionRate','stringify','Payment\x20not\x20found','toFixed','‚ö†Ô∏è\x20Payment\x20','log','trim','Insufficient\x20balance.\x20Available:\x20','awaitingPayout','delete','periodFrom','\x20\x20\x20Gateway:\x20','gatewayOrderId','totalAmountUSDT','‚úÖ\x20Payout\x20created:\x20','random','üìã\x20Found\x20','\x20paid\x20payments\x20for\x20analysis','üìä\x20Payout\x20statistics\x20calculated:','generateDailyStatistics','ACTIVE',']\x20Gateway\x20settings\x20JSON\x20string:','currencyService','localeCompare','name','split','\x20\x20\x20ÔøΩ\x20Total\x20paid\x20out:\x20','update','get','\x20\x20\x20üí∞\x20Total\x20payments\x20turnover:\x20','totalPayout','updatePaymentStatus','customerUa','KLYME\x20GB','defineProperty','üìä\x20Final\x20WHERE\x20conditions:',']\x20Gateway\x20settings\x20before\x20saving:','MasterCard','crypto','üìä\x20Getting\x20merchant\x20statistics\x20with\x20filters:','KLYME\x20DE','create','plisio','deleteUser','setHours','currency','customerCountry','90d','getMerchantsSelection','getGatewayDisplayName','getGatewayInternalName','0000','dailyRevenue','üìä\x20Available\x20gateways\x20in\x20database:','\x27\x20->\x20ID\x20\x27','parse','statusChangedBy','map','publicKey','sk_','1839069gQAYDl','commissionUSDT','password','not\x20set','merchantEarnings','\x20USDT\x20(','\x20\x20\x20Subtracted\x20from\x20balance:\x20-','üìä\x20[ADMIN]\x20Using\x20saved\x20amountAfterGatewayCommissionUSDT:\x20','pendingUrl','CHARGEBACK','getMonth','Rapyd','‚ö†Ô∏è\x20Gateway\x20\x27','all','\x27)\x20not\x20found\x20in\x20database,\x20returning\x20empty\x20result','\x20active\x20merchants\x20for\x20selection','whiteUrl','notes','üí±\x20Currency\x20filter\x20applied:\x20','\x20balance\x20updated:','../config/database',']\x20Updating\x20password\x20for\x20user\x20','shopId','insensitive','paymentsCount','üí∞\x20Shop\x20'];a40_0x2aee=function(){return _0x4ad824;};return a40_0x2aee();}const a40_0x2ebb7d=a40_0x2c8d;(function(_0x50eb61,_0x2ba344){const _0x3adc99=a40_0x2c8d,_0x487f5f=_0x50eb61();while(!![]){try{const _0x3568b9=parseInt(_0x3adc99(0x24d))/0x1*(-parseInt(_0x3adc99(0x246))/0x2)+-parseInt(_0x3adc99(0x190))/0x3+parseInt(_0x3adc99(0x216))/0x4*(parseInt(_0x3adc99(0x25c))/0x5)+parseInt(_0x3adc99(0x211))/0x6+parseInt(_0x3adc99(0x237))/0x7+parseInt(_0x3adc99(0x1f5))/0x8*(-parseInt(_0x3adc99(0x2b4))/0x9)+parseInt(_0x3adc99(0x1cb))/0xa*(parseInt(_0x3adc99(0x1ff))/0xb);if(_0x3568b9===_0x2ba344)break;else _0x487f5f['push'](_0x487f5f['shift']());}catch(_0xd9ffe2){_0x487f5f['push'](_0x487f5f['shift']());}}}(a40_0x2aee,0xe8f85));var __importDefault=this&&this[a40_0x2ebb7d(0x217)]||function(_0x1bd88f){const _0x315944=a40_0x2ebb7d;return _0x1bd88f&&_0x1bd88f[_0x315944(0x213)]?_0x1bd88f:{'default':_0x1bd88f};};Object[a40_0x2ebb7d(0x29a)](exports,a40_0x2ebb7d(0x213),{'value':!![]}),exports[a40_0x2ebb7d(0x192)]=void 0x0;const database_1=__importDefault(require(a40_0x2ebb7d(0x2c8))),bcryptjs_1=__importDefault(require(a40_0x2ebb7d(0x23d))),crypto_1=__importDefault(require(a40_0x2ebb7d(0x29e))),currencyService_1=require('./currencyService'),gateway_1=require(a40_0x2ebb7d(0x1ba));class AdminService{async[a40_0x2ebb7d(0x23f)](){const _0x46176c=a40_0x2ebb7d;console[_0x46176c(0x27d)](_0x46176c(0x1bb));const _0x53546d=await database_1[_0x46176c(0x233)]['shop'][_0x46176c(0x1be)]({'_sum':{'balance':!![],'totalPaidOut':!![]},'where':{'status':_0x46176c(0x28c)}}),_0x2519ce=await database_1[_0x46176c(0x233)][_0x46176c(0x249)][_0x46176c(0x1f3)]({'where':{'status':_0x46176c(0x1ce),'gateway':{'not':_0x46176c(0x19b)}}}),_0x244961=new Date(),_0x2c2954=new Date(_0x244961[_0x46176c(0x252)](),_0x244961[_0x46176c(0x2be)](),0x1),_0x5d33b9=new Date(_0x244961[_0x46176c(0x252)](),_0x244961[_0x46176c(0x2be)]()+0x1,0x0,0x17,0x3b,0x3b,0x3e7),_0x538ea7=await database_1[_0x46176c(0x233)]['payout'][_0x46176c(0x1be)]({'_sum':{'amount':!![]},'where':{'createdAt':{'gte':_0x2c2954,'lte':_0x5d33b9},'status':_0x46176c(0x24b)}}),_0x3cf298=_0x53546d[_0x46176c(0x17d)][_0x46176c(0x1e3)]||0x0,_0x39d454=_0x53546d[_0x46176c(0x17d)][_0x46176c(0x1ed)]||0x0,_0x117eb6=_0x538ea7[_0x46176c(0x17d)]['amount']||0x0,_0x3fcbcd={'totalPayout':Math['round'](_0x3cf298*0x64)/0x64,'awaitingPayout':Math[_0x46176c(0x247)](_0x39d454*0x64)/0x64,'thisMonth':Math[_0x46176c(0x247)](_0x117eb6*0x64)/0x64,'availableBalance':Math[_0x46176c(0x247)](_0x39d454*0x64)/0x64,'totalPayments':_0x2519ce};return console[_0x46176c(0x27d)](_0x46176c(0x28a)),console[_0x46176c(0x27d)](_0x46176c(0x205)+_0x3fcbcd[_0x46176c(0x296)]+'\x20USDT\x20(total\x20paid\x20to\x20merchants)'),console['log'](_0x46176c(0x1ae)+_0x3fcbcd[_0x46176c(0x280)]+_0x46176c(0x1ac)),console['log'](_0x46176c(0x194)+_0x3fcbcd['availableBalance']+'\x20USDT\x20(same\x20as\x20awaiting)'),console['log']('\x20\x20\x20üìÖ\x20This\x20month:\x20'+_0x3fcbcd[_0x46176c(0x241)]+'\x20USDT'),console['log']('\x20\x20\x20üí≥\x20Total\x20payments:\x20'+_0x3fcbcd[_0x46176c(0x22a)]+'\x20PAID\x20payments'),_0x3fcbcd;}async['updateCustomerData'](_0x1696a8,_0x41f0a4){const _0x494583=a40_0x2ebb7d;console[_0x494583(0x27d)](_0x494583(0x219)+_0x1696a8+':',_0x41f0a4);const _0xcd8553=await database_1[_0x494583(0x233)][_0x494583(0x249)]['findUnique']({'where':{'id':_0x1696a8},'select':{'id':!![],'customerEmail':!![],'customerName':!![],'customerCountry':!![],'customerIp':!![],'customerUa':!![]}});if(!_0xcd8553)throw new Error(_0x494583(0x27a));const _0xfe534c={};_0x41f0a4[_0x494583(0x2a6)]!==undefined&&(_0xfe534c['customerCountry']=_0x41f0a4[_0x494583(0x2a6)]||null);_0x41f0a4[_0x494583(0x226)]!==undefined&&(_0xfe534c['customerIp']=_0x41f0a4[_0x494583(0x226)]||null);_0x41f0a4['customerUa']!==undefined&&(_0xfe534c[_0x494583(0x298)]=_0x41f0a4[_0x494583(0x298)]||null);const _0x5e66fd=await database_1[_0x494583(0x233)]['payment']['update']({'where':{'id':_0x1696a8},'data':{..._0xfe534c,'updatedAt':new Date()},'select':{'id':!![],'customerEmail':!![],'customerName':!![],'customerCountry':!![],'customerIp':!![],'customerUa':!![],'updatedAt':!![]}});return console[_0x494583(0x27d)](_0x494583(0x188)+_0x1696a8),console[_0x494583(0x27d)](_0x494583(0x24c)+_0xcd8553[_0x494583(0x2a6)]+_0x494583(0x183)+_0x5e66fd['customerCountry']),console[_0x494583(0x27d)](_0x494583(0x236)+_0xcd8553[_0x494583(0x226)]+_0x494583(0x183)+_0x5e66fd[_0x494583(0x226)]),console[_0x494583(0x27d)]('\x20\x20\x20üñ•Ô∏è\x20User\x20Agent:\x20'+(_0xcd8553[_0x494583(0x298)]?'set':_0x494583(0x2b7))+_0x494583(0x183)+(_0x5e66fd['customerUa']?_0x494583(0x18f):_0x494583(0x2b7))),_0x5e66fd;}async[a40_0x2ebb7d(0x186)](_0x2302ce){const _0x26f442=a40_0x2ebb7d,_0x13105b=new Date();let _0x1413bd;switch(_0x2302ce['toLowerCase']()){case _0x26f442(0x273):_0x1413bd=new Date(_0x13105b['getFullYear'](),_0x13105b[_0x26f442(0x2be)](),_0x13105b[_0x26f442(0x225)](),0x0,0x0,0x0,0x0);break;case _0x26f442(0x224):const _0x7bcdc1=new Date(_0x13105b);_0x7bcdc1['setDate'](_0x7bcdc1[_0x26f442(0x225)]()-0x1),_0x1413bd=new Date(_0x7bcdc1[_0x26f442(0x252)](),_0x7bcdc1[_0x26f442(0x2be)](),_0x7bcdc1[_0x26f442(0x225)](),0x0,0x0,0x0,0x0);break;case'7d':_0x1413bd=new Date(_0x13105b['getTime']()-0x7*0x18*0x3c*0x3c*0x3e8);break;case _0x26f442(0x218):_0x1413bd=new Date(_0x13105b[_0x26f442(0x1d2)]()-0x1e*0x18*0x3c*0x3c*0x3e8);break;case _0x26f442(0x2a7):_0x1413bd=new Date(_0x13105b[_0x26f442(0x1d2)]()-0x5a*0x18*0x3c*0x3c*0x3e8);break;case'all':const _0x15cf8b=await database_1[_0x26f442(0x233)][_0x26f442(0x249)][_0x26f442(0x206)]({'where':{'gateway':{'not':_0x26f442(0x19b)}},'orderBy':{'createdAt':_0x26f442(0x26e)},'select':{'createdAt':!![]}});_0x1413bd=_0x15cf8b?_0x15cf8b[_0x26f442(0x1a0)]:new Date(_0x26f442(0x1ef));break;default:_0x1413bd=new Date(_0x13105b[_0x26f442(0x1d2)]()-0x1e*0x18*0x3c*0x3c*0x3e8);}_0x1413bd[_0x26f442(0x2a4)](0x0,0x0,0x0,0x0);let _0x434474;if(_0x2302ce['toLowerCase']()===_0x26f442(0x224)){const _0x5790cc=new Date(_0x13105b);_0x5790cc[_0x26f442(0x255)](_0x5790cc[_0x26f442(0x225)]()-0x1),_0x434474=new Date(_0x5790cc[_0x26f442(0x252)](),_0x5790cc[_0x26f442(0x2be)](),_0x5790cc[_0x26f442(0x225)](),0x17,0x3b,0x3b,0x3e7);}const _0x1d1fc5={'gte':_0x1413bd};_0x434474&&(_0x1d1fc5[_0x26f442(0x277)]=_0x434474);const [_0x5effe5,_0x125e36,_0x372f12,_0x21a473,_0xac9f37,_0x3ef51d]=await Promise['all']([database_1[_0x26f442(0x233)][_0x26f442(0x270)][_0x26f442(0x1f3)](),database_1[_0x26f442(0x233)][_0x26f442(0x270)][_0x26f442(0x1f3)]({'where':{'status':'ACTIVE'}}),database_1['default'][_0x26f442(0x249)][_0x26f442(0x1f3)]({'where':{'status':_0x26f442(0x1ce),'createdAt':_0x1d1fc5,'gateway':{'not':_0x26f442(0x19b)}}}),database_1['default'][_0x26f442(0x249)][_0x26f442(0x26a)]({'where':{'status':_0x26f442(0x1ce),'createdAt':_0x1d1fc5,'gateway':{'not':_0x26f442(0x19b)}},'select':{'amount':!![],'currency':!![],'amountAfterGatewayCommissionUSDT':!![]}}),database_1['default'][_0x26f442(0x249)]['findMany']({'where':{'gateway':{'not':_0x26f442(0x19b)}},'take':0xa,'orderBy':{'createdAt':_0x26f442(0x1ca)},'include':{'shop':{'select':{'name':!![],'username':!![]}}}}),database_1[_0x26f442(0x233)][_0x26f442(0x249)][_0x26f442(0x26a)]({'where':{'createdAt':_0x1d1fc5,'gateway':{'not':_0x26f442(0x19b)}},'select':{'amount':!![],'currency':!![],'status':!![],'amountUSDT':!![],'createdAt':!![]}})]);let _0x1693f9=0x0,_0x16ab83=0x0;for(const _0x38c97c of _0x21a473){const _0x3c05bc=await currencyService_1[_0x26f442(0x28e)][_0x26f442(0x203)](_0x38c97c['amount'],_0x38c97c['currency']);_0x1693f9+=_0x3c05bc;if(_0x38c97c[_0x26f442(0x1eb)]){const _0x344bbc=await currencyService_1[_0x26f442(0x28e)][_0x26f442(0x203)](_0x38c97c[_0x26f442(0x1d3)],_0x38c97c[_0x26f442(0x2a5)]),_0x230f75=_0x38c97c[_0x26f442(0x1eb)],_0x510588=_0x344bbc-_0x230f75;_0x16ab83+=_0x510588;}}const _0x392b2e=_0x372f12>0x0?_0x1693f9/_0x372f12:0x0,_0x5da566=this['generateDailyStatistics'](_0x3ef51d,_0x1413bd,_0x434474||_0x13105b),_0x4b4a99=await database_1[_0x26f442(0x233)][_0x26f442(0x249)]['count']({'where':{'createdAt':_0x1d1fc5,'gateway':{'not':'test_gateway'}}}),_0x379da9=_0x4b4a99>0x0?_0x372f12/_0x4b4a99*0x64:0x0;return{'totalShops':_0x5effe5,'activeShops':_0x125e36,'totalPayments':_0x372f12,'successfulPayments':_0x372f12,'totalAttempts':_0x4b4a99,'totalRevenue':Math[_0x26f442(0x247)](_0x1693f9*0x64)/0x64,'trapayEarnings':Math[_0x26f442(0x247)](_0x16ab83*0x64)/0x64,'averagePaymentAmount':Math[_0x26f442(0x247)](_0x392b2e*0x64)/0x64,'conversionRate':Math[_0x26f442(0x247)](_0x379da9*0x64)/0x64,'dailyRevenue':_0x5da566[_0x26f442(0x2ac)],'dailyPayments':_0x5da566[_0x26f442(0x21c)],'recentPayments':_0xac9f37[_0x26f442(0x2b1)](_0x53e776=>({'id':_0x53e776['id'],'amount':_0x53e776['amount'],'currency':_0x53e776[_0x26f442(0x2a5)],'status':_0x53e776[_0x26f442(0x191)],'gateway':_0x53e776[_0x26f442(0x1fb)],'shop':_0x53e776[_0x26f442(0x270)],'createdAt':_0x53e776[_0x26f442(0x1a0)]}))};}async[a40_0x2ebb7d(0x187)](_0x54a961){const _0x2edb6f=a40_0x2ebb7d;console[_0x2edb6f(0x27d)](_0x2edb6f(0x29f),_0x54a961);let _0x5608e2,_0x230a9f=new Date();if(_0x54a961['period']===_0x2edb6f(0x1a6)&&_0x54a961[_0x2edb6f(0x222)]&&_0x54a961[_0x2edb6f(0x1dc)])_0x5608e2=new Date(_0x54a961[_0x2edb6f(0x222)]),_0x230a9f=new Date(_0x54a961[_0x2edb6f(0x1dc)]),_0x5608e2[_0x2edb6f(0x2a4)](0x0,0x0,0x0,0x0),_0x230a9f[_0x2edb6f(0x2a4)](0x17,0x3b,0x3b,0x3e7);else{const _0x396e2c=new Date();switch(_0x54a961[_0x2edb6f(0x238)]){case'week':_0x5608e2=new Date(_0x396e2c[_0x2edb6f(0x1d2)]()-0x7*0x18*0x3c*0x3c*0x3e8);break;case _0x2edb6f(0x26f):_0x5608e2=new Date(_0x396e2c[_0x2edb6f(0x1d2)]()-0x1e*0x18*0x3c*0x3c*0x3e8);break;case _0x2edb6f(0x1fe):_0x5608e2=new Date(_0x396e2c[_0x2edb6f(0x1d2)]()-0x16d*0x18*0x3c*0x3c*0x3e8);break;case'all':default:_0x5608e2=new Date(_0x2edb6f(0x1ef));break;}_0x5608e2[_0x2edb6f(0x2a4)](0x0,0x0,0x0,0x0),_0x230a9f[_0x2edb6f(0x2a4)](0x17,0x3b,0x3b,0x3e7);}console[_0x2edb6f(0x27d)](_0x2edb6f(0x1c9)+_0x5608e2['toISOString']()+_0x2edb6f(0x235)+_0x230a9f[_0x2edb6f(0x1d7)]());const _0xd4109a={'status':'PAID','gateway':{'not':_0x2edb6f(0x19b)},'paidAt':{'gte':_0x5608e2,'lte':_0x230a9f}};_0x54a961[_0x2edb6f(0x2ca)]&&(_0xd4109a[_0x2edb6f(0x2ca)]=_0x54a961[_0x2edb6f(0x2ca)]);const _0x1493ba=await database_1[_0x2edb6f(0x233)]['payment'][_0x2edb6f(0x26a)]({'where':_0xd4109a,'select':{'id':!![],'amount':!![],'currency':!![],'amountUSDT':!![],'amountAfterGatewayCommissionUSDT':!![],'gatewayCommissionRate':!![],'gateway':!![],'shopId':!![],'paidAt':!![],'shop':{'select':{'id':!![],'name':!![],'username':!![],'gatewaySettings':!![]}}}});console[_0x2edb6f(0x27d)](_0x2edb6f(0x1fd)+_0x1493ba[_0x2edb6f(0x1f0)]+_0x2edb6f(0x289));const _0x297b53={'gateway':{'not':_0x2edb6f(0x19b)},'createdAt':{'gte':_0x5608e2,'lte':_0x230a9f}};_0x54a961[_0x2edb6f(0x2ca)]&&(_0x297b53[_0x2edb6f(0x2ca)]=_0x54a961['shopId']);const _0x3cc5f5=await database_1[_0x2edb6f(0x233)][_0x2edb6f(0x249)]['count']({'where':_0x297b53});console['log'](_0x2edb6f(0x22e)+_0x3cc5f5+_0x2edb6f(0x1f2)+_0x1493ba[_0x2edb6f(0x1f0)]);let _0x4371ea=0x0,_0x2952d6=0x0,_0x15d22b=0x0;const _0x65b33d={},_0xd5b629={},_0x377523={};for(const _0x3b4109 of _0x1493ba){try{const _0x3329cc=_0x3b4109['amountUSDT']||0x0;if(_0x3329cc<=0x0){console[_0x2edb6f(0x1d4)]('‚ö†Ô∏è\x20Payment\x20'+_0x3b4109['id']+_0x2edb6f(0x1c3));continue;}let _0xce79c5,_0x330eae;if(_0x3b4109[_0x2edb6f(0x1eb)]!==null&&_0x3b4109[_0x2edb6f(0x1eb)]!==undefined)_0xce79c5=_0x3b4109[_0x2edb6f(0x1eb)],_0x330eae=_0x3329cc-_0xce79c5,console[_0x2edb6f(0x27d)](_0x2edb6f(0x269)+_0x3b4109['id']+':\x20'+_0x3329cc[_0x2edb6f(0x27b)](0x6)+'\x20USDT,\x20merchant:\x20'+_0xce79c5[_0x2edb6f(0x27b)](0x6)+_0x2edb6f(0x1c0));else{let _0x41f491={};if(_0x3b4109[_0x2edb6f(0x270)][_0x2edb6f(0x1b0)])try{_0x41f491=JSON[_0x2edb6f(0x2af)](_0x3b4109[_0x2edb6f(0x270)][_0x2edb6f(0x1b0)]);}catch(_0x16260a){console[_0x2edb6f(0x1ad)](_0x2edb6f(0x1e1)+_0x3b4109['shopId']+':',_0x16260a);}let _0x393678=0x2d;for(const [_0x5ea0e3,_0x792ab9]of Object['entries'](_0x41f491)){if(_0x5ea0e3[_0x2edb6f(0x1cf)]()===_0x3b4109[_0x2edb6f(0x1fb)]['toLowerCase']()){_0x393678=_0x792ab9['commission']||0x2d;break;}}_0x330eae=_0x3329cc*(_0x393678/0x64),_0xce79c5=_0x3329cc-_0x330eae,console[_0x2edb6f(0x27d)](_0x2edb6f(0x195)+_0x3b4109['id']+':\x20'+_0x393678+'%\x20from\x20'+_0x3329cc['toFixed'](0x6)+_0x2edb6f(0x1c0));}_0x4371ea+=_0x3329cc,_0x2952d6+=_0xce79c5,_0x15d22b+=_0x330eae;let _0x3adae0;_0x3b4109[_0x2edb6f(0x278)]!==null&&_0x3b4109[_0x2edb6f(0x278)]!==undefined?(_0x3adae0=_0x3b4109['gatewayCommissionRate'],console[_0x2edb6f(0x27d)](_0x2edb6f(0x1c1)+_0x3b4109['id']+':\x20'+_0x3adae0+'%')):(_0x3adae0=_0x3329cc>0x0?_0x330eae/_0x3329cc*0x64:0x0,console[_0x2edb6f(0x27d)](_0x2edb6f(0x25d)+_0x3b4109['id']+':\x20'+_0x3adae0[_0x2edb6f(0x27b)](0x2)+'%'));!_0x65b33d[_0x3b4109['gateway']]&&(_0x65b33d[_0x3b4109['gateway']]={'gateway':_0x3b4109[_0x2edb6f(0x1fb)],'gatewayDisplayName':this[_0x2edb6f(0x2a9)](_0x3b4109[_0x2edb6f(0x1fb)]),'paymentsCount':0x0,'turnoverUSDT':0x0,'commissionUSDT':0x0,'merchantEarningsUSDT':0x0,'totalCommissionRate':0x0});_0x65b33d[_0x3b4109['gateway']][_0x2edb6f(0x17a)]++,_0x65b33d[_0x3b4109[_0x2edb6f(0x1fb)]][_0x2edb6f(0x20b)]+=_0x3329cc,_0x65b33d[_0x3b4109[_0x2edb6f(0x1fb)]][_0x2edb6f(0x2b5)]+=_0x330eae,_0x65b33d[_0x3b4109[_0x2edb6f(0x1fb)]][_0x2edb6f(0x193)]+=_0xce79c5,_0x65b33d[_0x3b4109['gateway']]['totalCommissionRate']+=_0x3adae0;!_0x54a961['shopId']&&(!_0xd5b629[_0x3b4109[_0x2edb6f(0x2ca)]]&&(_0xd5b629[_0x3b4109[_0x2edb6f(0x2ca)]]={'shopId':_0x3b4109[_0x2edb6f(0x2ca)],'shopName':_0x3b4109[_0x2edb6f(0x270)][_0x2edb6f(0x290)],'shopUsername':_0x3b4109[_0x2edb6f(0x270)]['username'],'paymentsCount':0x0,'turnoverUSDT':0x0,'commissionUSDT':0x0,'merchantEarningsUSDT':0x0,'paidOutUSDT':0x0,'averageCheckUSDT':0x0}),_0xd5b629[_0x3b4109['shopId']][_0x2edb6f(0x17a)]++,_0xd5b629[_0x3b4109['shopId']][_0x2edb6f(0x20b)]+=_0x3329cc,_0xd5b629[_0x3b4109[_0x2edb6f(0x2ca)]][_0x2edb6f(0x2b5)]+=_0x330eae,_0xd5b629[_0x3b4109['shopId']]['merchantEarningsUSDT']+=_0xce79c5);const _0x3330ac=_0x3b4109[_0x2edb6f(0x25a)]['toISOString']()['split']('T')[0x0];!_0x377523[_0x3330ac]&&(_0x377523[_0x3330ac]={'date':_0x3330ac,'turnover':0x0,'merchantEarnings':0x0,'gatewayEarnings':0x0,'paymentsCount':0x0}),_0x377523[_0x3330ac][_0x2edb6f(0x221)]+=_0x3329cc,_0x377523[_0x3330ac][_0x2edb6f(0x2b8)]+=_0xce79c5,_0x377523[_0x3330ac][_0x2edb6f(0x257)]+=_0x330eae,_0x377523[_0x3330ac]['paymentsCount']++;}catch(_0x2a8179){console['error']('Error\x20processing\x20payment\x20'+_0x3b4109['id']+':',_0x2a8179);}}Object[_0x2edb6f(0x25e)](_0x65b33d)[_0x2edb6f(0x19a)](_0x4c7b92=>{const _0x26022d=_0x2edb6f;_0x4c7b92['averageCommissionRate']=_0x4c7b92['paymentsCount']>0x0?_0x4c7b92['totalCommissionRate']/_0x4c7b92[_0x26022d(0x17a)]:0x0,delete _0x4c7b92[_0x26022d(0x23a)];}),Object[_0x2edb6f(0x25e)](_0xd5b629)[_0x2edb6f(0x19a)](_0x7778fb=>{const _0x253a80=_0x2edb6f;_0x7778fb[_0x253a80(0x1f6)]=_0x7778fb[_0x253a80(0x17a)]>0x0?_0x7778fb['turnoverUSDT']/_0x7778fb['paymentsCount']:0x0;});let _0x333203=0x0,_0x5f2237=0x0;if(_0x54a961[_0x2edb6f(0x2ca)]){const _0x22700e=await database_1[_0x2edb6f(0x233)][_0x2edb6f(0x232)]['findMany']({'where':{'shopId':_0x54a961['shopId'],'status':_0x2edb6f(0x24b),'createdAt':{'gte':_0x5608e2,'lte':_0x230a9f}},'select':{'amount':!![]}});_0x333203=_0x22700e['reduce']((_0x5f5f54,_0x569b26)=>_0x5f5f54+_0x569b26[_0x2edb6f(0x1d3)],0x0);const _0x1b0b11=await database_1[_0x2edb6f(0x233)][_0x2edb6f(0x232)]['findMany']({'where':{'shopId':_0x54a961[_0x2edb6f(0x2ca)],'status':_0x2edb6f(0x250),'createdAt':{'gte':_0x5608e2,'lte':_0x230a9f}},'select':{'amount':!![]}});_0x5f2237=_0x1b0b11[_0x2edb6f(0x1a5)]((_0x122625,_0x3d1240)=>_0x122625+_0x3d1240['amount'],0x0);}const _0x207bfc=_0x3cc5f5,_0x181691=_0x1493ba['length'],_0x151a02=_0x181691>0x0?_0x4371ea/_0x181691:0x0,_0x152f6a=_0x207bfc>0x0?Math[_0x2edb6f(0x247)](_0x181691/_0x207bfc*0x2710)/0x64:0x0,_0x2def60=Math[_0x2edb6f(0x182)]((_0x230a9f['getTime']()-_0x5608e2['getTime']())/(0x3e8*0x3c*0x3c*0x18)),_0x21c8e0={'totalTurnover':Math['round'](_0x4371ea*0x64)/0x64,'merchantEarnings':Math['round'](_0x2952d6*0x64)/0x64,'gatewayEarnings':Math[_0x2edb6f(0x247)](_0x15d22b*0x64)/0x64,'totalPaidOut':Math[_0x2edb6f(0x247)](_0x333203*0x64)/0x64,'pendingPayout':Math[_0x2edb6f(0x247)](_0x5f2237*0x64)/0x64,'averageCheck':Math[_0x2edb6f(0x247)](_0x151a02*0x64)/0x64,'totalPayments':_0x207bfc,'successfulPayments':_0x181691,'conversionRate':_0x152f6a,'gatewayBreakdown':Object['values'](_0x65b33d)[_0x2edb6f(0x2b1)](_0x24141b=>({..._0x24141b,'turnoverUSDT':Math[_0x2edb6f(0x247)](_0x24141b[_0x2edb6f(0x20b)]*0x64)/0x64,'commissionUSDT':Math[_0x2edb6f(0x247)](_0x24141b[_0x2edb6f(0x2b5)]*0x64)/0x64,'merchantEarningsUSDT':Math['round'](_0x24141b[_0x2edb6f(0x193)]*0x64)/0x64,'averageCommissionRate':Math[_0x2edb6f(0x247)](_0x24141b[_0x2edb6f(0x1b7)]*0x64)/0x64})),'merchantBreakdown':_0x54a961[_0x2edb6f(0x2ca)]?undefined:Object[_0x2edb6f(0x25e)](_0xd5b629)['map'](_0x286f38=>({..._0x286f38,'turnoverUSDT':Math[_0x2edb6f(0x247)](_0x286f38[_0x2edb6f(0x20b)]*0x64)/0x64,'commissionUSDT':Math[_0x2edb6f(0x247)](_0x286f38['commissionUSDT']*0x64)/0x64,'merchantEarningsUSDT':Math[_0x2edb6f(0x247)](_0x286f38[_0x2edb6f(0x193)]*0x64)/0x64,'paidOutUSDT':Math[_0x2edb6f(0x247)](_0x286f38[_0x2edb6f(0x189)]*0x64)/0x64,'averageCheckUSDT':Math[_0x2edb6f(0x247)](_0x286f38[_0x2edb6f(0x1f6)]*0x64)/0x64})),'dailyData':Object[_0x2edb6f(0x25e)](_0x377523)[_0x2edb6f(0x2b1)](_0x953de3=>({..._0x953de3,'turnover':Math[_0x2edb6f(0x247)](_0x953de3['turnover']*0x64)/0x64,'merchantEarnings':Math[_0x2edb6f(0x247)](_0x953de3[_0x2edb6f(0x2b8)]*0x64)/0x64,'gatewayEarnings':Math['round'](_0x953de3['gatewayEarnings']*0x64)/0x64}))[_0x2edb6f(0x256)]((_0x45bd80,_0x53e255)=>_0x45bd80[_0x2edb6f(0x1f9)][_0x2edb6f(0x28f)](_0x53e255[_0x2edb6f(0x1f9)])),'periodInfo':{'from':_0x5608e2,'to':_0x230a9f,'periodType':_0x54a961['period']||_0x2edb6f(0x1a6),'daysCount':_0x2def60}};return console['log'](_0x2edb6f(0x21a)),console[_0x2edb6f(0x27d)](_0x2edb6f(0x19e)+_0x21c8e0['totalTurnover']+'\x20USDT'),console['log']('\x20\x20\x20üë§\x20Merchant\x20earnings:\x20'+_0x21c8e0[_0x2edb6f(0x2b8)]+_0x2edb6f(0x1c0)),console['log'](_0x2edb6f(0x25f)+_0x21c8e0[_0x2edb6f(0x257)]+'\x20USDT'),console['log'](_0x2edb6f(0x292)+_0x21c8e0[_0x2edb6f(0x1e3)]+_0x2edb6f(0x1c0)),console[_0x2edb6f(0x27d)](_0x2edb6f(0x204)+_0x21c8e0['pendingPayout']+_0x2edb6f(0x1c0)),console[_0x2edb6f(0x27d)](_0x2edb6f(0x220)+_0x21c8e0[_0x2edb6f(0x22a)]),_0x21c8e0;}async[a40_0x2ebb7d(0x2a8)](){const _0x2eb21c=a40_0x2ebb7d;console[_0x2eb21c(0x27d)](_0x2eb21c(0x23e));const _0x6c53fe=await database_1[_0x2eb21c(0x233)][_0x2eb21c(0x270)][_0x2eb21c(0x26a)]({'where':{'status':_0x2eb21c(0x28c)},'select':{'id':!![],'username':!![],'name':!![]},'orderBy':{'name':'asc'}});return console[_0x2eb21c(0x27d)](_0x2eb21c(0x288)+_0x6c53fe['length']+_0x2eb21c(0x2c3)),_0x6c53fe[_0x2eb21c(0x2b1)](_0xd027b6=>({'id':_0xd027b6['id'],'username':_0xd027b6[_0x2eb21c(0x22d)],'name':_0xd027b6[_0x2eb21c(0x290)]}));}['getGatewayDisplayName'](_0x3a1370){const _0x415e42=a40_0x2ebb7d,_0x5a8dfd={'test_gateway':'Test\x20Gateway','plisio':'Plisio','rapyd':_0x415e42(0x2bf),'noda':_0x415e42(0x214),'cointopay':_0x415e42(0x1e2),'cointopay2':'Open\x20Banking\x202','klyme_eu':_0x415e42(0x1d1),'klyme_gb':_0x415e42(0x299),'klyme_de':_0x415e42(0x2a0),'mastercard':_0x415e42(0x29d)};return _0x5a8dfd[_0x3a1370]||_0x3a1370;}[a40_0x2ebb7d(0x2aa)](_0xe375b4){const _0x485536=a40_0x2ebb7d,_0x2e8054={'Test\x20Gateway':_0x485536(0x19b),'Plisio':_0x485536(0x2a2),'Rapyd':_0x485536(0x18e),'Noda':'noda','CoinToPay':_0x485536(0x1f8),'CoinToPay2':_0x485536(0x1ec),'KLYME\x20EU':_0x485536(0x212),'KLYME\x20GB':'klyme_gb','KLYME\x20DE':'klyme_de','MasterCard':'mastercard'};return _0x2e8054[_0xe375b4]||_0xe375b4[_0x485536(0x1cf)]();}async['getMerchantsAwaitingPayout'](_0x4b5e1b){const _0x32363f=a40_0x2ebb7d,{page:_0x1179ea,limit:_0x205367,minAmount:_0x529d29,search:_0x577bf1}=_0x4b5e1b;console[_0x32363f(0x27d)]('üìä\x20Getting\x20merchants\x20awaiting\x20payout\x20with\x20filters:',_0x4b5e1b);let _0x8143ef={'status':_0x32363f(0x28c)};_0x577bf1&&(_0x8143ef[_0x32363f(0x290)]={'contains':_0x577bf1,'mode':'insensitive'});const _0x1fe466=await database_1['default'][_0x32363f(0x270)][_0x32363f(0x26a)]({'where':_0x8143ef,'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'balance':!![],'totalPaidOut':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'usdcErcWallet':!![],'gatewaySettings':!![],'createdAt':!![]}}),_0x45b93a=_0x1fe466['filter'](_0x103087=>{const _0x362067=Math['round'](_0x103087['balance']*0x64)/0x64;if(_0x529d29&&_0x362067<_0x529d29)return![];return _0x362067!==0x0;});_0x45b93a[_0x32363f(0x256)]((_0x238d44,_0x49935c)=>_0x49935c[_0x32363f(0x1ed)]-_0x238d44[_0x32363f(0x1ed)]);const _0x5a64f4=_0x45b93a[_0x32363f(0x1f0)],_0x48f57e=(_0x1179ea-0x1)*_0x205367,_0x415d73=_0x45b93a[_0x32363f(0x25b)](_0x48f57e,_0x48f57e+_0x205367);console[_0x32363f(0x27d)](_0x32363f(0x1fd)+_0x415d73[_0x32363f(0x1f0)]+_0x32363f(0x198));const _0x1d0d7f=await Promise[_0x32363f(0x2c1)](_0x415d73['map'](async _0x22834b=>{const _0x457518=_0x32363f,[_0x2c0b05,_0x269754,_0x2b4f0f]=await Promise[_0x457518(0x2c1)]([database_1[_0x457518(0x233)][_0x457518(0x249)]['count']({'where':{'shopId':_0x22834b['id'],'status':_0x457518(0x1ce),'gateway':{'not':_0x457518(0x19b)}}}),database_1[_0x457518(0x233)][_0x457518(0x249)][_0x457518(0x206)]({'where':{'shopId':_0x22834b['id'],'status':_0x457518(0x1ce),'gateway':{'not':_0x457518(0x19b)}},'orderBy':{'paidAt':_0x457518(0x26e)},'select':{'paidAt':!![]}}),database_1[_0x457518(0x233)][_0x457518(0x249)][_0x457518(0x1db)]({'by':[_0x457518(0x1fb)],'where':{'shopId':_0x22834b['id'],'status':_0x457518(0x1ce),'gateway':{'not':_0x457518(0x19b)}},'_count':{'id':!![]},'_sum':{'amountUSDT':!![]}})]),_0xef9284=new Date(),_0x668ba0=new Date(_0xef9284[_0x457518(0x252)](),_0xef9284[_0x457518(0x2be)](),0x1),_0x5ae490=new Date(_0xef9284[_0x457518(0x252)](),_0xef9284[_0x457518(0x2be)]()+0x1,0x0,0x17,0x3b,0x3b,0x3e7),[_0x52f398,_0xde33c6]=await Promise[_0x457518(0x2c1)]([database_1[_0x457518(0x233)]['payout'][_0x457518(0x1be)]({'_sum':{'amount':!![]},'where':{'shopId':_0x22834b['id'],'status':_0x457518(0x24b)}}),database_1['default'][_0x457518(0x232)][_0x457518(0x1be)]({'_sum':{'amount':!![]},'where':{'shopId':_0x22834b['id'],'status':_0x457518(0x24b),'createdAt':{'gte':_0x668ba0,'lte':_0x5ae490}}})]),_0x4443fd=_0x52f398['_sum'][_0x457518(0x1d3)]||0x0,_0x4a1c4e=_0xde33c6[_0x457518(0x17d)][_0x457518(0x1d3)]||0x0,_0x26ad17=await Promise[_0x457518(0x2c1)](_0x2b4f0f[_0x457518(0x2b1)](async _0x1b0599=>{const _0x595e1c=_0x457518;let _0x410b58=0x2d;if(_0x22834b[_0x595e1c(0x1b0)])try{const _0x2b7c39=JSON[_0x595e1c(0x2af)](_0x22834b[_0x595e1c(0x1b0)]);for(const [_0x52caa1,_0x3a8a89]of Object[_0x595e1c(0x1af)](_0x2b7c39)){if(_0x52caa1['toLowerCase']()===_0x1b0599[_0x595e1c(0x1fb)][_0x595e1c(0x1cf)]()){_0x410b58=_0x3a8a89[_0x595e1c(0x17c)]||0xa,console[_0x595e1c(0x27d)](_0x595e1c(0x244)+_0x1b0599['gateway']+'\x20for\x20shop\x20'+_0x22834b['id']+_0x595e1c(0x268)+_0x410b58+'%');break;}}}catch(_0x1102fc){console[_0x595e1c(0x1ad)](_0x595e1c(0x1e1)+_0x22834b['id']+':',_0x1102fc);}const _0x36f873=_0x1b0599[_0x595e1c(0x17d)]?.['amountUSDT']||0x0,_0x31f5bb=_0x36f873*(0x1-_0x410b58/0x64);return{'gateway':_0x1b0599['gateway'],'count':_0x1b0599[_0x595e1c(0x1e8)]?.['id']||0x0,'amountUSDT':Math['round'](_0x36f873*0x64)/0x64,'amountAfterCommissionUSDT':Math[_0x595e1c(0x247)](_0x31f5bb*0x64)/0x64,'commission':_0x410b58};})),_0x163f09=_0x26ad17[_0x457518(0x1a5)]((_0x45f4fc,_0x48850e)=>_0x45f4fc+_0x48850e[_0x457518(0x248)],0x0),_0x50aca6=_0x26ad17[_0x457518(0x1a5)]((_0x4b23f1,_0x4fb509)=>_0x4b23f1+_0x4fb509[_0x457518(0x1a7)],0x0),_0x4866e2=_0x22834b[_0x457518(0x1ed)];return console['log'](_0x457518(0x17e)+_0x22834b[_0x457518(0x22d)]+':'),console[_0x457518(0x27d)](_0x457518(0x266)+_0x163f09[_0x457518(0x27b)](0x2)+_0x457518(0x180)),console[_0x457518(0x27d)]('\x20\x20\x20üîç\x20Calculated\x20after\x20commission:\x20'+_0x50aca6[_0x457518(0x27b)](0x2)+'\x20USDT\x20(theoretical\x20net)'),console[_0x457518(0x27d)](_0x457518(0x21f)+_0x4866e2[_0x457518(0x27b)](0x2)+_0x457518(0x245)),console['log'](_0x457518(0x24a)+_0x4443fd[_0x457518(0x27b)](0x2)+_0x457518(0x274)),console['log']('\x20\x20\x20ü§î\x20Difference:\x20'+(_0x50aca6-_0x4443fd-_0x4866e2)[_0x457518(0x27b)](0x2)+_0x457518(0x1ee)),{'id':_0x22834b['id'],'fullName':_0x22834b[_0x457518(0x290)],'username':_0x22834b['username'],'telegramId':_0x22834b[_0x457518(0x1a3)],'merchantUrl':_0x22834b[_0x457518(0x21e)],'wallets':{'usdtPolygonWallet':_0x22834b[_0x457518(0x264)],'usdtTrcWallet':_0x22834b[_0x457518(0x20a)],'usdtErcWallet':_0x22834b[_0x457518(0x228)],'usdcPolygonWallet':_0x22834b['usdcPolygonWallet'],'usdcErcWallet':_0x22834b[_0x457518(0x1e9)]},'totalAmountUSDT':Math[_0x457518(0x247)](_0x163f09*0x64)/0x64,'totalAmountAfterCommissionUSDT':Math[_0x457518(0x247)](_0x50aca6*0x64)/0x64,'currentBalance':Math['round'](_0x4866e2*0x64)/0x64,'totalPayout':Math[_0x457518(0x247)](_0x4443fd*0x64)/0x64,'thisMonth':Math[_0x457518(0x247)](_0x4a1c4e*0x64)/0x64,'paymentsCount':_0x2c0b05,'oldestPaymentDate':_0x269754?.[_0x457518(0x25a)]||_0x22834b[_0x457518(0x1a0)],'gatewayBreakdown':_0x26ad17};})),_0x7421bb=_0x1d0d7f[_0x32363f(0x1a5)]((_0x4cea8b,_0x6ae8c0)=>_0x4cea8b+_0x6ae8c0[_0x32363f(0x285)],0x0),_0x47aa7d=_0x1d0d7f[_0x32363f(0x1a5)]((_0x59323b,_0x238baa)=>_0x59323b+_0x238baa[_0x32363f(0x234)],0x0),_0xdf1af=_0x1d0d7f[_0x32363f(0x1a5)]((_0x84f385,_0x375a68)=>_0x84f385+_0x375a68[_0x32363f(0x296)],0x0),_0x2f8409=_0x1d0d7f[_0x32363f(0x1a5)]((_0x20ca03,_0x3351d7)=>_0x20ca03+_0x3351d7['thisMonth'],0x0);return console['log'](_0x32363f(0x196)+_0x5a64f4+'\x20merchants'),console[_0x32363f(0x27d)](_0x32363f(0x295)+Math[_0x32363f(0x247)](_0x7421bb*0x64)/0x64+_0x32363f(0x180)),console['log']('\x20\x20\x20‚úÖ\x20Total\x20net\x20balances:\x20'+Math[_0x32363f(0x247)](_0x47aa7d*0x64)/0x64+_0x32363f(0x1bf)),console['log'](_0x32363f(0x1e0)+Math[_0x32363f(0x247)](_0xdf1af*0x64)/0x64+_0x32363f(0x1c0)),console['log']('\x20\x20\x20üìÖ\x20Total\x20payouts\x20(this\x20month):\x20'+Math[_0x32363f(0x247)](_0x2f8409*0x64)/0x64+_0x32363f(0x1c0)),{'merchants':_0x1d0d7f,'pagination':{'page':_0x1179ea,'limit':_0x205367,'total':_0x5a64f4,'totalPages':Math[_0x32363f(0x182)](_0x5a64f4/_0x205367)},'summary':{'totalMerchants':_0x5a64f4,'totalAmountUSDT':Math[_0x32363f(0x247)](_0x7421bb*0x64)/0x64,'totalAmountAfterCommissionUSDT':Math[_0x32363f(0x247)](_0x47aa7d*0x64)/0x64,'totalPayout':Math[_0x32363f(0x247)](_0xdf1af*0x64)/0x64,'thisMonth':Math[_0x32363f(0x247)](_0x2f8409*0x64)/0x64}};}async[a40_0x2ebb7d(0x1b4)](_0x40e22c){const _0x2f40ec=a40_0x2ebb7d,{shopId:_0x2b9d22,amount:_0x1ffde1,network:_0x2ed07d,wallet:_0x4d6e3f,notes:_0x19fe09,txid:_0x3700b5,periodFrom:_0x5b3948,periodTo:_0x614908}=_0x40e22c,_0x544d0a=await database_1['default'][_0x2f40ec(0x1cd)](async _0x51d3eb=>{const _0x349156=_0x2f40ec,_0x1e5d83=await _0x51d3eb[_0x349156(0x270)]['findUnique']({'where':{'id':_0x2b9d22},'select':{'id':!![],'name':!![],'username':!![],'balance':!![],'totalPaidOut':!![]}});if(!_0x1e5d83)throw new Error('Shop\x20not\x20found');console[_0x349156(0x27d)](_0x349156(0x1c2)+_0x1e5d83[_0x349156(0x22d)]+':'),console[_0x349156(0x27d)](_0x349156(0x22f)+_0x1e5d83[_0x349156(0x1ed)]['toFixed'](0x6)+_0x349156(0x1c0)),console[_0x349156(0x27d)]('\x20\x20\x20Payout\x20amount:\x20'+_0x1ffde1['toFixed'](0x6)+'\x20USDT'),console[_0x349156(0x27d)](_0x349156(0x22c)+_0x1e5d83[_0x349156(0x1e3)][_0x349156(0x27b)](0x6)+'\x20USDT');if(_0x3700b5)console[_0x349156(0x27d)]('\x20\x20\x20Transaction\x20hash:\x20'+_0x3700b5);const _0x52c391=0.000001,_0x1b1c14=Number(_0x1e5d83[_0x349156(0x1ed)]),_0xe53e60=Number(_0x1ffde1);console[_0x349156(0x27d)](_0x349156(0x1f4)),console['log'](_0x349156(0x1fc)+_0x1e5d83[_0x349156(0x1ed)]),console[_0x349156(0x27d)](_0x349156(0x208)+_0x1b1c14),console['log'](_0x349156(0x1c4)+_0xe53e60),console[_0x349156(0x27d)](_0x349156(0x275)+(_0x1b1c14-_0xe53e60)),console['log'](_0x349156(0x199)+_0x52c391);if(_0x1b1c14<_0xe53e60-_0x52c391)throw new Error(_0x349156(0x27f)+_0x1b1c14[_0x349156(0x27b)](0x6)+_0x349156(0x261)+_0xe53e60[_0x349156(0x27b)](0x6)+'\x20USDT,\x20Difference:\x20'+(_0x1b1c14-_0xe53e60)[_0x349156(0x27b)](0x8)+_0x349156(0x1c0));console[_0x349156(0x27d)]('‚úÖ\x20Balance\x20check\x20passed\x20(with\x20tolerance)');const _0x206099=Math[_0x349156(0x1c5)](_0x1b1c14,_0xe53e60);let _0x357e2f=_0x4d6e3f;if(!_0x357e2f){const _0x584527=await _0x51d3eb[_0x349156(0x270)]['findUnique']({'where':{'id':_0x2b9d22},'select':{'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'usdcErcWallet':!![]}});if(_0x584527)switch(_0x2ed07d){case _0x349156(0x215):_0x357e2f=_0x584527[_0x349156(0x264)]||undefined;break;case _0x349156(0x1e5):_0x357e2f=_0x584527[_0x349156(0x20a)]||undefined;break;case _0x349156(0x200):_0x357e2f=_0x584527[_0x349156(0x228)]||undefined;break;case _0x349156(0x21d):_0x357e2f=_0x584527[_0x349156(0x1c6)]||undefined;break;case'erc20_usdc':_0x357e2f=_0x584527[_0x349156(0x1e9)]||undefined;break;}}console[_0x349156(0x27d)]('üí≥\x20Payout\x20wallet\x20for\x20'+_0x2ed07d+':\x20'+(_0x357e2f||_0x349156(0x267)));const _0x29a893=await _0x51d3eb[_0x349156(0x232)][_0x349156(0x2a1)]({'data':{'shopId':_0x2b9d22,'amount':_0x206099,'network':_0x2ed07d,'status':'COMPLETED','txid':_0x3700b5,'notes':_0x19fe09,'periodFrom':_0x5b3948?new Date(_0x5b3948):null,'periodTo':_0x614908?new Date(_0x614908):null,'createdAt':new Date(),'paidAt':new Date()}}),_0x1105ce=_0x1b1c14-_0x206099,_0x148dda=Number(_0x1e5d83[_0x349156(0x1e3)])+_0x206099;return await _0x51d3eb[_0x349156(0x270)][_0x349156(0x293)]({'where':{'id':_0x2b9d22},'data':{'balance':_0x1105ce,'totalPaidOut':_0x148dda}}),console[_0x349156(0x27d)](_0x349156(0x17b)+_0x1e5d83[_0x349156(0x22d)]+_0x349156(0x2c7)),console['log'](_0x349156(0x201)+_0x1b1c14['toFixed'](0x6)+'\x20->\x20'+_0x1105ce[_0x349156(0x27b)](0x6)+_0x349156(0x26c)+_0x206099[_0x349156(0x27b)](0x6)+')'),console[_0x349156(0x27d)]('\x20\x20\x20Total\x20paid\x20out:\x20'+_0x1e5d83[_0x349156(0x1e3)]['toFixed'](0x6)+'\x20->\x20'+_0x148dda[_0x349156(0x27b)](0x6)+_0x349156(0x1a8)+_0x206099['toFixed'](0x6)+')'),console['log'](_0x349156(0x1ea)+_0x206099[_0x349156(0x27b)](0x6)+_0x349156(0x1c0)),{'payout':_0x29a893,'shop':_0x1e5d83};});return console[_0x2f40ec(0x27d)](_0x2f40ec(0x286)+_0x544d0a[_0x2f40ec(0x232)]['id']+_0x2f40ec(0x1b8)+_0x544d0a['shop'][_0x2f40ec(0x22d)]+'\x20('+_0x544d0a[_0x2f40ec(0x232)][_0x2f40ec(0x1d3)]['toFixed'](0x6)+_0x2f40ec(0x1fa)),{'id':_0x544d0a[_0x2f40ec(0x232)]['id'],'shopId':_0x544d0a[_0x2f40ec(0x232)][_0x2f40ec(0x2ca)],'shopName':_0x544d0a[_0x2f40ec(0x270)][_0x2f40ec(0x290)],'shopUsername':_0x544d0a[_0x2f40ec(0x270)][_0x2f40ec(0x22d)],'amount':_0x544d0a[_0x2f40ec(0x232)]['amount'],'network':_0x544d0a[_0x2f40ec(0x232)][_0x2f40ec(0x231)],'status':_0x544d0a['payout'][_0x2f40ec(0x191)],'txid':_0x544d0a['payout'][_0x2f40ec(0x197)],'notes':_0x544d0a[_0x2f40ec(0x232)][_0x2f40ec(0x2c5)],'periodFrom':_0x544d0a[_0x2f40ec(0x232)][_0x2f40ec(0x282)],'periodTo':_0x544d0a['payout'][_0x2f40ec(0x184)],'createdAt':_0x544d0a[_0x2f40ec(0x232)][_0x2f40ec(0x1a0)],'paidAt':_0x544d0a[_0x2f40ec(0x232)]['paidAt']};}async['getAllPayouts'](_0x534619){const _0x1f3332=a40_0x2ebb7d,{page:_0x36a037,limit:_0x3849a6,shopId:_0x4027a0,network:_0x1c2645,dateFrom:_0x4a20e4,dateTo:_0x394965,search:_0x356a72}=_0x534619,_0xb61bbf=(_0x36a037-0x1)*_0x3849a6,_0x8b5a19={};_0x4027a0&&(_0x8b5a19['shopId']=_0x4027a0);_0x1c2645&&(_0x8b5a19[_0x1f3332(0x231)]=_0x1c2645);(_0x4a20e4||_0x394965)&&(_0x8b5a19['createdAt']={},_0x4a20e4&&(_0x8b5a19[_0x1f3332(0x1a0)][_0x1f3332(0x20f)]=new Date(_0x4a20e4)),_0x394965&&(_0x8b5a19[_0x1f3332(0x1a0)]['lte']=new Date(_0x394965)));_0x356a72&&(_0x8b5a19['OR']=[{'shop':{'name':{'contains':_0x356a72,'mode':_0x1f3332(0x179)}}},{'shop':{'username':{'contains':_0x356a72,'mode':_0x1f3332(0x179)}}},{'notes':{'contains':_0x356a72,'mode':'insensitive'}}]);const [_0x54a527,_0x4280ef]=await Promise[_0x1f3332(0x2c1)]([database_1[_0x1f3332(0x233)]['payout'][_0x1f3332(0x26a)]({'where':_0x8b5a19,'skip':_0xb61bbf,'take':_0x3849a6,'orderBy':{'createdAt':_0x1f3332(0x1ca)},'select':{'id':!![],'shopId':!![],'amount':!![],'network':!![],'status':!![],'txid':!![],'notes':!![],'periodFrom':!![],'periodTo':!![],'createdAt':!![],'wallet':!![],'paidAt':!![],'shop':{'select':{'name':!![],'username':!![]}}}}),database_1[_0x1f3332(0x233)][_0x1f3332(0x232)]['count']({'where':_0x8b5a19})]);return{'payouts':_0x54a527[_0x1f3332(0x2b1)](_0x4bfcd6=>({'id':_0x4bfcd6['id'],'shopId':_0x4bfcd6['shopId'],'shopName':_0x4bfcd6[_0x1f3332(0x270)][_0x1f3332(0x290)],'shopUsername':_0x4bfcd6[_0x1f3332(0x270)][_0x1f3332(0x22d)],'amount':_0x4bfcd6[_0x1f3332(0x1d3)],'network':_0x4bfcd6['network'],'status':_0x4bfcd6[_0x1f3332(0x191)],'txid':_0x4bfcd6['txid'],'notes':_0x4bfcd6[_0x1f3332(0x2c5)],'periodFrom':_0x4bfcd6[_0x1f3332(0x282)],'periodTo':_0x4bfcd6[_0x1f3332(0x184)],'createdAt':_0x4bfcd6[_0x1f3332(0x1a0)],'paidAt':_0x4bfcd6[_0x1f3332(0x25a)]})),'pagination':{'page':_0x36a037,'limit':_0x3849a6,'total':_0x4280ef,'totalPages':Math[_0x1f3332(0x182)](_0x4280ef/_0x3849a6)}};}async[a40_0x2ebb7d(0x1de)](_0x1b91c5){const _0x424256=a40_0x2ebb7d,_0x3c09bf=await database_1[_0x424256(0x233)]['payout'][_0x424256(0x1b9)]({'where':{'id':_0x1b91c5},'include':{'shop':{'select':{'name':!![],'username':!![]}}}});if(!_0x3c09bf)return null;return{'id':_0x3c09bf['id'],'shopId':_0x3c09bf['shopId'],'shopName':_0x3c09bf['shop']['name'],'shopUsername':_0x3c09bf['shop'][_0x424256(0x22d)],'amount':_0x3c09bf[_0x424256(0x1d3)],'network':_0x3c09bf[_0x424256(0x231)],'status':_0x3c09bf[_0x424256(0x191)],'txid':_0x3c09bf['txid'],'notes':_0x3c09bf[_0x424256(0x2c5)],'periodFrom':_0x3c09bf[_0x424256(0x282)],'periodTo':_0x3c09bf['periodTo'],'createdAt':_0x3c09bf['createdAt'],'paidAt':_0x3c09bf[_0x424256(0x25a)]};}async[a40_0x2ebb7d(0x1a1)](_0x206b04){const _0x44a722=a40_0x2ebb7d;await database_1[_0x44a722(0x233)][_0x44a722(0x232)][_0x44a722(0x281)]({'where':{'id':_0x206b04}});}async[a40_0x2ebb7d(0x20c)](_0x1b03d1){const _0x14e4c4=a40_0x2ebb7d,{page:_0x2834c2,limit:_0x5758e8,status:_0x3783a8,gateway:_0x23949e,shopId:_0x33c57c,dateFrom:_0x36200d,dateTo:_0x3f3301,search:_0x174fa3,currency:_0x365809,sortBy:_0x43d945,sortOrder:_0x12b7be}=_0x1b03d1,_0x1adca7=(_0x2834c2-0x1)*_0x5758e8;console[_0x14e4c4(0x27d)]('üìä\x20Getting\x20payments\x20with\x20filters:',_0x1b03d1);const _0x4001c2=await database_1[_0x14e4c4(0x233)][_0x14e4c4(0x249)][_0x14e4c4(0x1db)]({'by':['gateway'],'_count':{'gateway':!![]}});console[_0x14e4c4(0x27d)](_0x14e4c4(0x2ad),_0x4001c2[_0x14e4c4(0x2b1)](_0x55efdd=>_0x55efdd['gateway']+'\x20('+_0x55efdd[_0x14e4c4(0x1e8)]['gateway']+_0x14e4c4(0x20e)));if(_0x23949e){const _0x24bd8f=_0x4001c2[_0x14e4c4(0x22b)](_0x202ed8=>_0x202ed8['gateway']['toLowerCase']()===_0x23949e[_0x14e4c4(0x1cf)]());!_0x24bd8f&&_0x23949e[_0x14e4c4(0x1cf)]()!==_0x14e4c4(0x19b)&&console[_0x14e4c4(0x27d)](_0x14e4c4(0x1b1)+_0x23949e+_0x14e4c4(0x1c7)+_0x4001c2[_0x14e4c4(0x2b1)](_0x538807=>_0x538807[_0x14e4c4(0x1fb)])[_0x14e4c4(0x253)](',\x20'));}const _0x5e216e={};_0x3783a8&&(_0x5e216e[_0x14e4c4(0x191)]=_0x3783a8[_0x14e4c4(0x276)]());if(!_0x23949e)_0x5e216e[_0x14e4c4(0x1fb)]={'not':_0x14e4c4(0x19b)};else{if(_0x23949e&&(_0x23949e['toLowerCase']()===_0x14e4c4(0x19b)||_0x23949e===_0x14e4c4(0x2ab)))_0x5e216e[_0x14e4c4(0x1fb)]=_0x14e4c4(0x19b);else{let _0x3a772f=_0x23949e;const _0x41d8d5=(0x0,gateway_1[_0x14e4c4(0x19c)])(_0x23949e);if(_0x41d8d5)_0x3a772f=_0x41d8d5,console['log'](_0x14e4c4(0x19f)+_0x23949e+'\x27\x20to\x20name\x20\x27'+_0x3a772f+'\x27');else{const _0x56fbe8=(0x0,gateway_1['getGatewayIdByName'])(_0x23949e);if(_0x56fbe8){const _0x1de38e=(0x0,gateway_1[_0x14e4c4(0x19c)])(_0x56fbe8);_0x1de38e&&(_0x3a772f=_0x1de38e,console[_0x14e4c4(0x27d)]('üîÑ\x20Converted\x20gateway\x20name\x20\x27'+_0x23949e+_0x14e4c4(0x2ae)+_0x56fbe8+_0x14e4c4(0x1d5)+_0x3a772f+'\x27'));}else console[_0x14e4c4(0x27d)](_0x14e4c4(0x227)+_0x23949e+_0x14e4c4(0x242));}const _0x308d2a=await database_1[_0x14e4c4(0x233)][_0x14e4c4(0x249)][_0x14e4c4(0x1f3)]({'where':{'gateway':_0x3a772f[_0x14e4c4(0x1cf)]()},'take':0x1});_0x308d2a===0x0?(console[_0x14e4c4(0x27d)](_0x14e4c4(0x2c0)+_0x3a772f+'\x27\x20(from\x20\x27'+_0x23949e+_0x14e4c4(0x2c2)),_0x5e216e[_0x14e4c4(0x1fb)]='NONEXISTENT_GATEWAY_FILTER'):(_0x5e216e[_0x14e4c4(0x1fb)]=_0x3a772f[_0x14e4c4(0x1cf)](),console[_0x14e4c4(0x27d)](_0x14e4c4(0x1d9)+_0x3a772f+'\x27\x20(from\x20\x27'+_0x23949e+'\x27)'));}}console[_0x14e4c4(0x27d)](_0x14e4c4(0x1df),_0x5e216e['gateway']);_0x33c57c&&(_0x5e216e[_0x14e4c4(0x2ca)]=_0x33c57c);_0x365809&&(_0x5e216e['currency']=_0x365809['toUpperCase'](),console[_0x14e4c4(0x27d)](_0x14e4c4(0x2c6)+_0x365809['toUpperCase']()));(_0x36200d||_0x3f3301)&&(_0x5e216e[_0x14e4c4(0x1a0)]={},_0x36200d&&(_0x5e216e[_0x14e4c4(0x1a0)][_0x14e4c4(0x20f)]=new Date(_0x36200d)),_0x3f3301&&(_0x5e216e['createdAt'][_0x14e4c4(0x277)]=new Date(_0x3f3301)));_0x174fa3&&(_0x5e216e['OR']=[{'id':{'contains':_0x174fa3,'mode':'insensitive'}},{'orderId':{'contains':_0x174fa3,'mode':_0x14e4c4(0x179)}},{'gatewayOrderId':{'contains':_0x174fa3,'mode':_0x14e4c4(0x179)}},{'customerEmail':{'contains':_0x174fa3,'mode':_0x14e4c4(0x179)}},{'shop':{'name':{'contains':_0x174fa3,'mode':_0x14e4c4(0x179)}}},{'shop':{'username':{'contains':_0x174fa3,'mode':'insensitive'}}}]);console[_0x14e4c4(0x27d)](_0x14e4c4(0x29b),JSON[_0x14e4c4(0x279)](_0x5e216e,null,0x2));let _0x48da2c={'createdAt':'desc'};if(_0x43d945){const _0xdea81c=[_0x14e4c4(0x1d3),_0x14e4c4(0x1a0),_0x14e4c4(0x1bc),_0x14e4c4(0x191),_0x14e4c4(0x1fb),_0x14e4c4(0x2a5)],_0x19e96a=[_0x14e4c4(0x26e),_0x14e4c4(0x1ca)];if(_0xdea81c[_0x14e4c4(0x18d)](_0x43d945)){const _0x2a5ee0=_0x19e96a['includes'](_0x12b7be)?_0x12b7be:'desc';_0x48da2c={[_0x43d945]:_0x2a5ee0},console[_0x14e4c4(0x27d)]('üìä\x20Sorting\x20payments\x20by\x20'+_0x43d945+_0x14e4c4(0x243)+_0x2a5ee0+_0x14e4c4(0x240));}}const [_0x4a2aaa,_0x2fafbd]=await Promise['all']([database_1[_0x14e4c4(0x233)][_0x14e4c4(0x249)]['findMany']({'where':_0x5e216e,'skip':_0x1adca7,'take':_0x5758e8,'orderBy':_0x48da2c,'include':{'shop':{'select':{'name':!![],'username':!![]}}}}),database_1[_0x14e4c4(0x233)]['payment'][_0x14e4c4(0x1f3)]({'where':_0x5e216e})]);return{'payments':_0x4a2aaa,'pagination':{'page':_0x2834c2,'limit':_0x5758e8,'total':_0x2fafbd,'totalPages':Math[_0x14e4c4(0x182)](_0x2fafbd/_0x5758e8)}};}async[a40_0x2ebb7d(0x23c)](_0x526ecd){const _0x459d03=a40_0x2ebb7d,_0x308de6=await database_1[_0x459d03(0x233)][_0x459d03(0x249)]['findUnique']({'where':{'id':_0x526ecd},'select':{'id':!![],'shopId':!![],'amount':!![],'amountAfterGatewayCommissionUSDT':!![],'currency':!![],'sourceCurrency':!![],'status':!![],'gateway':!![],'orderId':!![],'gatewayOrderId':!![],'gatewayPaymentId':!![],'customerEmail':!![],'customerName':!![],'customerCountry':!![],'customerIp':!![],'customerUa':!![],'externalPaymentUrl':!![],'successUrl':!![],'failUrl':!![],'pendingUrl':!![],'whiteUrl':!![],'expiresAt':!![],'invoiceTotalSum':!![],'qrCode':!![],'qrUrl':!![],'country':!![],'language':!![],'amountIsEditable':!![],'maxPayments':!![],'rapydCustomer':!![],'cardLast4':!![],'paymentMethod':!![],'bankId':!![],'remitterIban':!![],'remitterName':!![],'failureMessage':!![],'usage':!![],'createdAt':!![],'updatedAt':!![],'shop':{'select':{'name':!![],'username':!![]}}}});if(!_0x308de6)return null;return{'id':_0x308de6['id'],'shopId':_0x308de6[_0x459d03(0x2ca)],'gateway':_0x308de6[_0x459d03(0x1fb)],'amount':_0x308de6['amount'],'currency':_0x308de6['currency'],'status':_0x308de6[_0x459d03(0x191)],'orderId':_0x308de6['orderId'],'gatewayOrderId':_0x308de6[_0x459d03(0x284)],'customerEmail':_0x308de6['customerEmail'],'customerName':_0x308de6[_0x459d03(0x17f)],'customerCountry':_0x308de6[_0x459d03(0x2a6)],'customerIp':_0x308de6[_0x459d03(0x226)],'customerUa':_0x308de6['customerUa'],'failureMessage':_0x308de6[_0x459d03(0x272)],'externalPaymentUrl':_0x308de6['externalPaymentUrl'],'successUrl':_0x308de6[_0x459d03(0x19d)],'failUrl':_0x308de6[_0x459d03(0x254)],'pendingUrl':_0x308de6[_0x459d03(0x2bc)],'whiteUrl':_0x308de6[_0x459d03(0x2c4)],'createdAt':_0x308de6[_0x459d03(0x1a0)],'updatedAt':_0x308de6['updatedAt'],'shop':_0x308de6[_0x459d03(0x270)]};}async[a40_0x2ebb7d(0x297)](_0x5a8b6d,_0x51c631,_0x574d81,_0x522e1b){const _0x326bcf=a40_0x2ebb7d,_0x49783a=await database_1[_0x326bcf(0x233)][_0x326bcf(0x1cd)](async _0xebddc4=>{const _0x46078b=_0x326bcf,_0x4af95b=await _0xebddc4[_0x46078b(0x249)][_0x46078b(0x1b9)]({'where':{'id':_0x5a8b6d},'include':{'shop':{'select':{'id':!![],'name':!![],'username':!![],'balance':!![]}}}});if(!_0x4af95b)throw new Error(_0x46078b(0x27a));const _0x1d19a0=_0x4af95b[_0x46078b(0x191)],_0x858d64=_0x51c631[_0x46078b(0x276)]();console[_0x46078b(0x27d)](_0x46078b(0x230)+_0x5a8b6d+_0x46078b(0x263)+_0x1d19a0+_0x46078b(0x183)+_0x858d64),console[_0x46078b(0x27d)](_0x46078b(0x265)+_0x4af95b[_0x46078b(0x270)][_0x46078b(0x1ed)]+_0x46078b(0x1c0));const _0x2ea8f6={'status':_0x858d64,'updatedAt':new Date(),'statusChangedBy':_0x46078b(0x1bd),'statusChangedAt':new Date()};_0x574d81&&(_0x2ea8f6[_0x46078b(0x1aa)]=_0x574d81);_0x858d64===_0x46078b(0x2bd)&&_0x522e1b&&(_0x2ea8f6[_0x46078b(0x251)]=_0x522e1b);let _0x24ce5d=0x0,_0x3a16e5=_0x4af95b[_0x46078b(0x270)][_0x46078b(0x1ed)];if(_0x858d64===_0x46078b(0x1ce)&&_0x1d19a0!=='PAID'){_0x2ea8f6['paidAt']=new Date();const _0xce236a=await currencyService_1[_0x46078b(0x28e)][_0x46078b(0x203)](_0x4af95b[_0x46078b(0x1d3)],_0x4af95b[_0x46078b(0x2a5)]);_0x2ea8f6['amountUSDT']=_0xce236a;let _0x2a632f=0x2d;const _0x2cecc5=await _0xebddc4[_0x46078b(0x270)][_0x46078b(0x1b9)]({'where':{'id':_0x4af95b[_0x46078b(0x2ca)]},'select':{'gatewaySettings':!![]}});if(_0x2cecc5?.[_0x46078b(0x1b0)])try{const _0x1b8cff=JSON[_0x46078b(0x2af)](_0x2cecc5['gatewaySettings']);for(const [_0x7563b9,_0x5f478b]of Object[_0x46078b(0x1af)](_0x1b8cff)){if(_0x7563b9[_0x46078b(0x1cf)]()===_0x4af95b['gateway'][_0x46078b(0x1cf)]()){_0x2a632f=_0x5f478b[_0x46078b(0x17c)]||0xa;break;}}}catch(_0x5d5c9b){console['error']('Error\x20parsing\x20gateway\x20settings\x20for\x20payment\x20'+_0x5a8b6d+':',_0x5d5c9b);}let _0x57eea7;_0x4af95b[_0x46078b(0x1eb)]!==null&&_0x4af95b[_0x46078b(0x1eb)]!==undefined?(_0x57eea7=_0x4af95b[_0x46078b(0x1eb)],console[_0x46078b(0x27d)](_0x46078b(0x2bb)+_0x57eea7[_0x46078b(0x27b)](0x6)+_0x46078b(0x210)+_0x5a8b6d)):(_0x57eea7=_0xce236a*(0x1-_0x2a632f/0x64),console['log'](_0x46078b(0x1b2)+_0x5a8b6d+':\x20'+_0x2a632f+_0x46078b(0x1da)+_0xce236a[_0x46078b(0x27b)](0x6)+_0x46078b(0x1c0)),_0x2ea8f6[_0x46078b(0x1eb)]=_0x57eea7,_0x2ea8f6[_0x46078b(0x278)]=_0x2a632f),_0x24ce5d=_0x57eea7,_0x3a16e5+=_0x57eea7,console[_0x46078b(0x27d)]('üí∞\x20Payment\x20'+_0x5a8b6d+_0x46078b(0x1a4)),console[_0x46078b(0x27d)]('\x20\x20\x20Full\x20amount:\x20'+_0xce236a[_0x46078b(0x27b)](0x6)+_0x46078b(0x1c0)),console[_0x46078b(0x27d)]('\x20\x20\x20Gateway:\x20'+_0x4af95b['gateway']+_0x46078b(0x24e)+_0x2a632f+'%'),console[_0x46078b(0x27d)](_0x46078b(0x24f)+_0x57eea7[_0x46078b(0x27b)](0x6)+_0x46078b(0x258)+_0x2a632f+_0x46078b(0x1f1)),console['log'](_0x46078b(0x1e4)+_0x57eea7['toFixed'](0x6)+_0x46078b(0x1c0));}else{if(_0x1d19a0===_0x46078b(0x1ce)&&_0x858d64!==_0x46078b(0x1ce)&&_0x858d64!==_0x46078b(0x2bd)){if(_0x4af95b['amountUSDT']){let _0x3a8036=0x2d;const _0x448296=await _0xebddc4[_0x46078b(0x270)][_0x46078b(0x1b9)]({'where':{'id':_0x4af95b['shopId']},'select':{'gatewaySettings':!![]}});if(_0x448296?.[_0x46078b(0x1b0)])try{const _0x3359d1=JSON[_0x46078b(0x2af)](_0x448296[_0x46078b(0x1b0)]);for(const [_0x5d845c,_0x58e67e]of Object[_0x46078b(0x1af)](_0x3359d1)){if(_0x5d845c[_0x46078b(0x1cf)]()===_0x4af95b[_0x46078b(0x1fb)][_0x46078b(0x1cf)]()){_0x3a8036=_0x58e67e[_0x46078b(0x17c)]||0xa;break;}}}catch(_0x34fb4f){console['error'](_0x46078b(0x26b)+_0x5a8b6d+':',_0x34fb4f);}const _0x3a19dc=_0x4af95b[_0x46078b(0x248)]*(0x1-_0x3a8036/0x64);_0x24ce5d=-_0x3a19dc,_0x3a16e5-=_0x3a19dc,console['log'](_0x46078b(0x1b5)+_0x4af95b[_0x46078b(0x248)][_0x46078b(0x27b)](0x6)+_0x46078b(0x1c0)),console[_0x46078b(0x27d)](_0x46078b(0x283)+_0x4af95b[_0x46078b(0x1fb)]+',\x20Commission:\x20'+_0x3a8036+'%'),console[_0x46078b(0x27d)](_0x46078b(0x209)+_0x3a19dc[_0x46078b(0x27b)](0x6)+_0x46078b(0x258)+_0x3a8036+'%\x20commission)'),console['log'](_0x46078b(0x2ba)+_0x3a19dc[_0x46078b(0x27b)](0x6)+_0x46078b(0x1c0));}}}_0x858d64===_0x46078b(0x2bd)&&(console[_0x46078b(0x27d)](_0x46078b(0x207)),_0x522e1b&&_0x522e1b>0x0?(_0x24ce5d=-_0x522e1b,_0x3a16e5-=_0x522e1b,console[_0x46078b(0x27d)](_0x46078b(0x1e6)+_0x522e1b['toFixed'](0x6)+_0x46078b(0x1a2)),console['log']('üí∞\x20Payment\x20amount\x20is\x20NOT\x20deducted\x20(chargeback\x20penalty\x20only)')):console[_0x46078b(0x27d)](_0x46078b(0x1d0)),_0x2ea8f6[_0x46078b(0x251)]=_0x522e1b||0x0);_0x858d64===_0x46078b(0x20d)&&_0x1d19a0===_0x46078b(0x1ce)&&console[_0x46078b(0x27d)](_0x46078b(0x181));const _0x4034ae=await _0xebddc4[_0x46078b(0x249)]['update']({'where':{'id':_0x5a8b6d},'data':_0x2ea8f6,'include':{'shop':{'select':{'name':!![],'username':!![]}}}});return _0x24ce5d!==0x0&&(await _0xebddc4['shop']['update']({'where':{'id':_0x4af95b[_0x46078b(0x2ca)]},'data':{'balance':_0x3a16e5}}),console[_0x46078b(0x27d)]('üí∞\x20Shop\x20'+_0x4af95b['shopId']+'\x20balance\x20updated:\x20'+_0x4af95b[_0x46078b(0x270)][_0x46078b(0x1ed)][_0x46078b(0x27b)](0x6)+_0x46078b(0x183)+_0x3a16e5[_0x46078b(0x27b)](0x6)+_0x46078b(0x2b9)+(_0x24ce5d>0x0?'+':'')+_0x24ce5d[_0x46078b(0x27b)](0x6)+')')),_0x4034ae;});return{'id':_0x49783a['id'],'shopId':_0x49783a['shopId'],'gateway':_0x49783a[_0x326bcf(0x1fb)],'amount':_0x49783a[_0x326bcf(0x1d3)],'currency':_0x49783a[_0x326bcf(0x2a5)],'status':_0x49783a[_0x326bcf(0x191)],'orderId':_0x49783a[_0x326bcf(0x239)],'gatewayOrderId':_0x49783a[_0x326bcf(0x284)],'customerEmail':_0x49783a[_0x326bcf(0x26d)],'customerName':_0x49783a['customerName'],'customerCountry':_0x49783a['customerCountry'],'customerIp':_0x49783a[_0x326bcf(0x226)],'customerUa':_0x49783a[_0x326bcf(0x298)],'failureMessage':_0x49783a[_0x326bcf(0x272)],'adminNotes':_0x49783a[_0x326bcf(0x1aa)],'chargebackAmount':_0x49783a[_0x326bcf(0x251)],'statusChangedBy':_0x49783a[_0x326bcf(0x2b0)],'statusChangedAt':_0x49783a[_0x326bcf(0x21b)],'createdAt':_0x49783a[_0x326bcf(0x1a0)],'updatedAt':_0x49783a['updatedAt'],'shop':_0x49783a[_0x326bcf(0x270)]};}async[a40_0x2ebb7d(0x1cc)](_0xb6bc5,_0x29f04c){const _0x2f0902=a40_0x2ebb7d,_0x18c508=Math[_0x2f0902(0x287)]()[_0x2f0902(0x18a)](0x24)['substr'](0x2,0x9);console['log']('üéØ\x20updateUser\x20called\x20with\x20ID:\x20'+_0x18c508+_0x2f0902(0x1b6)+_0xb6bc5);const _0x2ecf0d={..._0x29f04c};_0x29f04c[_0x2f0902(0x2b6)]&&_0x29f04c['password'][_0x2f0902(0x27e)]()!==''?(console[_0x2f0902(0x27d)](_0x2f0902(0x1f7)+_0x18c508+_0x2f0902(0x2c9)+_0xb6bc5),_0x2ecf0d[_0x2f0902(0x2b6)]=await bcryptjs_1[_0x2f0902(0x233)][_0x2f0902(0x1e7)](_0x29f04c[_0x2f0902(0x2b6)],0xc)):(console[_0x2f0902(0x27d)](_0x2f0902(0x1f7)+_0x18c508+']\x20Password\x20not\x20provided\x20or\x20empty,\x20skipping\x20password\x20update'),delete _0x2ecf0d[_0x2f0902(0x2b6)]);_0x29f04c[_0x2f0902(0x1c8)]&&(_0x2ecf0d[_0x2f0902(0x290)]=_0x29f04c['fullName'],delete _0x2ecf0d[_0x2f0902(0x1c8)]);_0x29f04c[_0x2f0902(0x1a9)]&&(_0x2ecf0d[_0x2f0902(0x1a3)]=_0x29f04c[_0x2f0902(0x1a9)],delete _0x2ecf0d[_0x2f0902(0x1a9)]);_0x29f04c[_0x2f0902(0x1d6)]&&(_0x2ecf0d[_0x2f0902(0x21e)]=_0x29f04c[_0x2f0902(0x1d6)],delete _0x2ecf0d[_0x2f0902(0x1d6)]);if(_0x29f04c[_0x2f0902(0x260)]){const _0x5d0b0b=_0x29f04c[_0x2f0902(0x260)][_0x2f0902(0x2b1)](_0x53d219=>this[_0x2f0902(0x2aa)](_0x53d219));console[_0x2f0902(0x27d)](_0x2f0902(0x1ab),_0x29f04c[_0x2f0902(0x260)],'->',_0x5d0b0b),_0x2ecf0d[_0x2f0902(0x1b3)]=JSON[_0x2f0902(0x279)](_0x5d0b0b),delete _0x2ecf0d[_0x2f0902(0x260)];}_0x29f04c[_0x2f0902(0x1b0)]&&(console[_0x2f0902(0x27d)]('üîß\x20['+_0x18c508+_0x2f0902(0x29c),_0x29f04c[_0x2f0902(0x1b0)]),_0x2ecf0d[_0x2f0902(0x1b0)]=JSON[_0x2f0902(0x279)](_0x29f04c[_0x2f0902(0x1b0)]),console[_0x2f0902(0x27d)](_0x2f0902(0x1d8)+_0x18c508+_0x2f0902(0x28d),_0x2ecf0d['gatewaySettings']));_0x29f04c[_0x2f0902(0x259)]&&(_0x29f04c[_0x2f0902(0x259)][_0x2f0902(0x264)]!==undefined&&(_0x2ecf0d[_0x2f0902(0x264)]=_0x29f04c[_0x2f0902(0x259)][_0x2f0902(0x264)]||null),_0x29f04c[_0x2f0902(0x259)][_0x2f0902(0x20a)]!==undefined&&(_0x2ecf0d[_0x2f0902(0x20a)]=_0x29f04c['wallets'][_0x2f0902(0x20a)]||null),_0x29f04c[_0x2f0902(0x259)][_0x2f0902(0x228)]!==undefined&&(_0x2ecf0d[_0x2f0902(0x228)]=_0x29f04c['wallets'][_0x2f0902(0x228)]||null),_0x29f04c[_0x2f0902(0x259)]['usdcPolygonWallet']!==undefined&&(_0x2ecf0d[_0x2f0902(0x1c6)]=_0x29f04c[_0x2f0902(0x259)][_0x2f0902(0x1c6)]||null),delete _0x2ecf0d[_0x2f0902(0x259)]);const _0x301e8e=await database_1[_0x2f0902(0x233)][_0x2f0902(0x270)][_0x2f0902(0x293)]({'where':{'id':_0xb6bc5},'data':_0x2ecf0d,'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});return console[_0x2f0902(0x27d)]('üéØ\x20['+_0x18c508+']\x20User\x20updated,\x20gatewaySettings\x20from\x20DB:',_0x301e8e[_0x2f0902(0x1b0)]),{'id':_0x301e8e['id'],'fullName':_0x301e8e[_0x2f0902(0x290)],'username':_0x301e8e[_0x2f0902(0x22d)],'telegramId':_0x301e8e[_0x2f0902(0x1a3)],'merchantUrl':_0x301e8e[_0x2f0902(0x21e)],'gateways':_0x301e8e[_0x2f0902(0x1b3)]?JSON['parse'](_0x301e8e[_0x2f0902(0x1b3)]):null,'gatewaySettings':_0x301e8e[_0x2f0902(0x1b0)]?JSON[_0x2f0902(0x2af)](_0x301e8e['gatewaySettings']):null,'publicKey':_0x301e8e[_0x2f0902(0x2b2)],'wallets':{'usdtPolygonWallet':_0x301e8e['usdtPolygonWallet'],'usdtTrcWallet':_0x301e8e[_0x2f0902(0x20a)],'usdtErcWallet':_0x301e8e[_0x2f0902(0x228)],'usdcPolygonWallet':_0x301e8e['usdcPolygonWallet']},'status':_0x301e8e[_0x2f0902(0x191)],'createdAt':_0x301e8e['createdAt']};}async[a40_0x2ebb7d(0x185)](_0x51ba0b){const _0x38001f=a40_0x2ebb7d,_0x2048d7=await database_1['default'][_0x38001f(0x270)][_0x38001f(0x293)]({'where':{'id':_0x51ba0b},'data':{'status':'SUSPENDED'},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});return{'id':_0x2048d7['id'],'fullName':_0x2048d7[_0x38001f(0x290)],'username':_0x2048d7[_0x38001f(0x22d)],'telegramId':_0x2048d7[_0x38001f(0x1a3)],'merchantUrl':_0x2048d7['shopUrl'],'gateways':_0x2048d7[_0x38001f(0x1b3)]?JSON[_0x38001f(0x2af)](_0x2048d7[_0x38001f(0x1b3)]):null,'gatewaySettings':_0x2048d7[_0x38001f(0x1b0)]?JSON[_0x38001f(0x2af)](_0x2048d7['gatewaySettings']):null,'publicKey':_0x2048d7['publicKey'],'wallets':{'usdtPolygonWallet':_0x2048d7[_0x38001f(0x264)],'usdtTrcWallet':_0x2048d7['usdtTrcWallet'],'usdtErcWallet':_0x2048d7[_0x38001f(0x228)],'usdcPolygonWallet':_0x2048d7[_0x38001f(0x1c6)]},'status':_0x2048d7[_0x38001f(0x191)],'createdAt':_0x2048d7[_0x38001f(0x1a0)]};}async['activateUser'](_0x4562d3){const _0x22361e=a40_0x2ebb7d,_0x5ed5f8=await database_1[_0x22361e(0x233)][_0x22361e(0x270)]['update']({'where':{'id':_0x4562d3},'data':{'status':_0x22361e(0x28c)},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});return{'id':_0x5ed5f8['id'],'fullName':_0x5ed5f8[_0x22361e(0x290)],'username':_0x5ed5f8[_0x22361e(0x22d)],'telegramId':_0x5ed5f8['telegram'],'merchantUrl':_0x5ed5f8[_0x22361e(0x21e)],'gateways':_0x5ed5f8[_0x22361e(0x1b3)]?JSON[_0x22361e(0x2af)](_0x5ed5f8[_0x22361e(0x1b3)]):null,'gatewaySettings':_0x5ed5f8[_0x22361e(0x1b0)]?JSON[_0x22361e(0x2af)](_0x5ed5f8[_0x22361e(0x1b0)]):null,'publicKey':_0x5ed5f8[_0x22361e(0x2b2)],'wallets':{'usdtPolygonWallet':_0x5ed5f8['usdtPolygonWallet'],'usdtTrcWallet':_0x5ed5f8[_0x22361e(0x20a)],'usdtErcWallet':_0x5ed5f8['usdtErcWallet'],'usdcPolygonWallet':_0x5ed5f8[_0x22361e(0x1c6)]},'status':_0x5ed5f8[_0x22361e(0x191)],'createdAt':_0x5ed5f8[_0x22361e(0x1a0)]};}async[a40_0x2ebb7d(0x229)](_0x4f5ec5){const _0x2eaee7=a40_0x2ebb7d,{page:_0x55488c,limit:_0x5f57b8,status:_0x6c0eb3}=_0x4f5ec5,_0x8026e9=(_0x55488c-0x1)*_0x5f57b8,_0x4b90c6={};_0x6c0eb3&&(_0x4b90c6[_0x2eaee7(0x191)]=_0x6c0eb3[_0x2eaee7(0x276)]());const [_0x5bf79f,_0x439319]=await Promise[_0x2eaee7(0x2c1)]([database_1[_0x2eaee7(0x233)][_0x2eaee7(0x270)][_0x2eaee7(0x26a)]({'where':_0x4b90c6,'skip':_0x8026e9,'take':_0x5f57b8,'orderBy':{'createdAt':'desc'},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}}),database_1[_0x2eaee7(0x233)][_0x2eaee7(0x270)]['count']({'where':_0x4b90c6})]);return{'users':_0x5bf79f[_0x2eaee7(0x2b1)](_0x30ece1=>{const _0xb552ab=_0x2eaee7,_0x1cadbf=_0x30ece1[_0xb552ab(0x1b3)]?JSON[_0xb552ab(0x2af)](_0x30ece1['paymentGateways']):null,_0x152bab=_0x1cadbf?_0x1cadbf[_0xb552ab(0x2b1)](_0x279759=>this['getGatewayDisplayName'](_0x279759)):null;return{'id':_0x30ece1['id'],'fullName':_0x30ece1[_0xb552ab(0x290)],'username':_0x30ece1['username'],'telegramId':_0x30ece1[_0xb552ab(0x1a3)],'merchantUrl':_0x30ece1[_0xb552ab(0x21e)],'gateways':_0x152bab,'gatewaySettings':_0x30ece1[_0xb552ab(0x1b0)]?JSON[_0xb552ab(0x2af)](_0x30ece1[_0xb552ab(0x1b0)]):null,'publicKey':_0x30ece1[_0xb552ab(0x2b2)],'wallets':{'usdtPolygonWallet':_0x30ece1[_0xb552ab(0x264)],'usdtTrcWallet':_0x30ece1[_0xb552ab(0x20a)],'usdtErcWallet':_0x30ece1[_0xb552ab(0x228)],'usdcPolygonWallet':_0x30ece1[_0xb552ab(0x1c6)]},'status':_0x30ece1[_0xb552ab(0x191)],'createdAt':_0x30ece1[_0xb552ab(0x1a0)]};}),'pagination':{'page':_0x55488c,'limit':_0x5f57b8,'total':_0x439319,'totalPages':Math['ceil'](_0x439319/_0x5f57b8)}};}async['getUserById'](_0x5a65cb){const _0x1aabb3=a40_0x2ebb7d,_0x132554=await database_1[_0x1aabb3(0x233)][_0x1aabb3(0x270)][_0x1aabb3(0x1b9)]({'where':{'id':_0x5a65cb},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});if(!_0x132554)return null;const _0x4c3801=_0x132554[_0x1aabb3(0x1b3)]?JSON[_0x1aabb3(0x2af)](_0x132554['paymentGateways']):null,_0x31eb9f=_0x4c3801?_0x4c3801[_0x1aabb3(0x2b1)](_0xc103b3=>this[_0x1aabb3(0x2a9)](_0xc103b3)):null;return _0x4c3801&&_0x31eb9f&&console['log']('üîÑ\x20Gateway\x20mapping\x20(get):',_0x4c3801,'->',_0x31eb9f),{'id':_0x132554['id'],'fullName':_0x132554[_0x1aabb3(0x290)],'username':_0x132554[_0x1aabb3(0x22d)],'telegramId':_0x132554['telegram'],'merchantUrl':_0x132554[_0x1aabb3(0x21e)],'gateways':_0x31eb9f,'gatewaySettings':_0x132554[_0x1aabb3(0x1b0)]?JSON[_0x1aabb3(0x2af)](_0x132554[_0x1aabb3(0x1b0)]):null,'publicKey':_0x132554[_0x1aabb3(0x2b2)],'wallets':{'usdtPolygonWallet':_0x132554[_0x1aabb3(0x264)],'usdtTrcWallet':_0x132554[_0x1aabb3(0x20a)],'usdtErcWallet':_0x132554['usdtErcWallet'],'usdcPolygonWallet':_0x132554['usdcPolygonWallet']},'status':_0x132554[_0x1aabb3(0x191)],'createdAt':_0x132554[_0x1aabb3(0x1a0)]};}async[a40_0x2ebb7d(0x262)](_0x18070e){const _0x125215=a40_0x2ebb7d,{fullName:_0x5d3a88,username:_0x268aed,password:_0x53953e,telegramId:_0x135c48,merchantUrl:_0x390ed8,gateways:_0x1f6017,gatewaySettings:_0x31cc6b,wallets:_0x485739}=_0x18070e,_0x22283a=await database_1['default'][_0x125215(0x270)]['findUnique']({'where':{'username':_0x268aed}});if(_0x22283a)throw new Error(_0x125215(0x1dd));if(_0x135c48){const _0x26f543=await database_1['default'][_0x125215(0x270)]['findUnique']({'where':{'telegram':_0x135c48}});if(_0x26f543)throw new Error(_0x125215(0x18c));}const _0x2efd6b=await bcryptjs_1[_0x125215(0x233)][_0x125215(0x1e7)](_0x53953e,0xc),_0x161097='pk_'+crypto_1['default'][_0x125215(0x271)](0x20)[_0x125215(0x18a)](_0x125215(0x223)),_0x2f614b=_0x125215(0x2b3)+crypto_1[_0x125215(0x233)][_0x125215(0x271)](0x20)[_0x125215(0x18a)](_0x125215(0x223)),_0x3f4134=_0x1f6017?_0x1f6017[_0x125215(0x2b1)](_0x1bcf60=>this[_0x125215(0x2aa)](_0x1bcf60)):null;_0x1f6017&&_0x3f4134&&console[_0x125215(0x27d)]('üîÑ\x20Gateway\x20mapping\x20(create):',_0x1f6017,'->',_0x3f4134);const _0x4c042a=await database_1['default'][_0x125215(0x270)][_0x125215(0x2a1)]({'data':{'name':_0x5d3a88,'username':_0x268aed,'password':_0x2efd6b,'telegram':_0x135c48,'shopUrl':_0x390ed8,'paymentGateways':_0x3f4134?JSON['stringify'](_0x3f4134):null,'gatewaySettings':_0x31cc6b?JSON[_0x125215(0x279)](_0x31cc6b):null,'usdtPolygonWallet':_0x485739?.[_0x125215(0x264)]||null,'usdtTrcWallet':_0x485739?.[_0x125215(0x20a)]||null,'usdtErcWallet':_0x485739?.['usdtErcWallet']||null,'usdcPolygonWallet':_0x485739?.[_0x125215(0x1c6)]||null,'publicKey':_0x161097,'secretKey':_0x2f614b,'status':_0x125215(0x28c)},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});return{'id':_0x4c042a['id'],'fullName':_0x4c042a['name'],'username':_0x4c042a[_0x125215(0x22d)],'telegramId':_0x4c042a[_0x125215(0x1a3)],'merchantUrl':_0x4c042a['shopUrl'],'gateways':_0x4c042a[_0x125215(0x1b3)]?JSON[_0x125215(0x2af)](_0x4c042a[_0x125215(0x1b3)]):null,'gatewaySettings':_0x4c042a[_0x125215(0x1b0)]?JSON[_0x125215(0x2af)](_0x4c042a[_0x125215(0x1b0)]):null,'publicKey':_0x4c042a[_0x125215(0x2b2)],'wallets':{'usdtPolygonWallet':_0x4c042a[_0x125215(0x264)],'usdtTrcWallet':_0x4c042a[_0x125215(0x20a)],'usdtErcWallet':_0x4c042a[_0x125215(0x228)],'usdcPolygonWallet':_0x4c042a[_0x125215(0x1c6)]},'status':_0x4c042a[_0x125215(0x191)],'createdAt':_0x4c042a[_0x125215(0x1a0)]};}async[a40_0x2ebb7d(0x2a3)](_0x4520fc){const _0x1992c9=a40_0x2ebb7d;await database_1[_0x1992c9(0x233)][_0x1992c9(0x270)][_0x1992c9(0x281)]({'where':{'id':_0x4520fc}});}[a40_0x2ebb7d(0x28b)](_0x327d18,_0x113adc,_0x189b89){const _0x586c70=a40_0x2ebb7d,_0x3f74c5=new Map(),_0x6302aa=new Date(_0x113adc);while(_0x6302aa<=_0x189b89){const _0x1af8cd=_0x6302aa[_0x586c70(0x1d7)]()[_0x586c70(0x291)]('T')[0x0];_0x3f74c5[_0x586c70(0x18f)](_0x1af8cd,{'revenue':0x0,'count':0x0}),_0x6302aa[_0x586c70(0x255)](_0x6302aa[_0x586c70(0x225)]()+0x1);}for(const _0x3f3028 of _0x327d18){const _0x3f01c1=_0x3f3028[_0x586c70(0x1a0)][_0x586c70(0x1d7)]()[_0x586c70(0x291)]('T')[0x0],_0x119773=_0x3f74c5[_0x586c70(0x294)](_0x3f01c1);_0x119773&&(_0x119773['count']+=0x1,_0x3f3028[_0x586c70(0x191)]===_0x586c70(0x1ce)&&(_0x3f3028['amountUSDT']?_0x119773[_0x586c70(0x202)]+=_0x3f3028['amountUSDT']:console[_0x586c70(0x27d)](_0x586c70(0x27c)+_0x3f3028['id']+_0x586c70(0x18b))));}const _0x4323b6=[],_0x59f88f=[];for(const [_0x4079d8,_0x314b57]of _0x3f74c5){_0x4323b6[_0x586c70(0x23b)]({'date':_0x4079d8,'amount':Math[_0x586c70(0x247)](_0x314b57['revenue']*0x64)/0x64}),_0x59f88f[_0x586c70(0x23b)]({'date':_0x4079d8,'count':_0x314b57[_0x586c70(0x1f3)]});}return{'dailyRevenue':_0x4323b6,'dailyPayments':_0x59f88f};}}function a40_0x2c8d(_0xbe7d0b,_0x4b919e){const _0x2aeec8=a40_0x2aee();return a40_0x2c8d=function(_0x2c8d51,_0x5ad1bc){_0x2c8d51=_0x2c8d51-0x179;let _0x30ddea=_0x2aeec8[_0x2c8d51];return _0x30ddea;},a40_0x2c8d(_0xbe7d0b,_0x4b919e);}exports[a40_0x2ebb7d(0x192)]=AdminService;