'use strict';const a48_0x23d58a=a48_0xae52;(function(_0xe14325,_0x90c148){const _0x2ea195=a48_0xae52,_0x290641=_0xe14325();while(!![]){try{const _0x2c560c=parseInt(_0x2ea195(0x113))/0x1+-parseInt(_0x2ea195(0x199))/0x2+parseInt(_0x2ea195(0x1b1))/0x3*(-parseInt(_0x2ea195(0x173))/0x4)+parseInt(_0x2ea195(0x1fc))/0x5*(-parseInt(_0x2ea195(0x1ad))/0x6)+-parseInt(_0x2ea195(0x1e4))/0x7+-parseInt(_0x2ea195(0x258))/0x8*(parseInt(_0x2ea195(0x11e))/0x9)+parseInt(_0x2ea195(0x234))/0xa*(parseInt(_0x2ea195(0x277))/0xb);if(_0x2c560c===_0x90c148)break;else _0x290641['push'](_0x290641['shift']());}catch(_0x953cc7){_0x290641['push'](_0x290641['shift']());}}}(a48_0x3fb2,0xe36c1));function a48_0x3fb2(){const _0x55cb9c=['ðŸ”\x20Initial\x20wallet\x20from\x20request:\x20','_sum','\x20\x20\x20ï¿½\x20Total\x20payments\x20turnover:\x20','erc20_usdc','Payment\x20not\x20found','\x20USDT\x20(rounded\x20to\x202\x20decimal\x20places)','\x20USDT\x20from\x20balance','\x27\x20->\x20ID\x20\x27','getPaymentById','ðŸ“Š\x20Merchant\x20statistics\x20calculated:','gatewayOrderId','\x20\x20\x20ðŸŒ\x20Country:\x20','password','22446226WiTmVt','klyme_eu','__importDefault','\x20USDT\x20(already\x20paid\x20out)','getMerchantsSelection','push','chargebackAmount','update','custom','totalCommissionRate','getGatewayDisplayName','customerUa','hash','getTime','Telegram\x20username\x20already\x20exists','error','\x20USDT\x20(after\x20','717579ULBJdX','gatewayEarnings','\x27\x20(from\x20\x27','parse','__esModule','randomBytes','\x20\x20\x20Subtracted\x20from\x20balance:\x20-','updatedAt','getFullYear','amountAfterGatewayCommissionUSDT','AdminService','3142548TqLAJV','ðŸ“Š\x20Sorting\x20payments\x20by\x20','\x20\x20\x20Current\x20total\x20paid\x20out:\x20','ðŸ“…\x20Payout\x20date\x20to\x20filter:\x20','\x20\x20\x20Gateway:\x20','ðŸ”„\x20Admin\x20updating\x20payment\x20','âš ï¸\x20Requested\x20gateway\x20\x27','EXPIRED','ðŸ“Š\x20Payout\x20statistics\x20calculated:','\x20\x20\x20Merchant\x20gets:\x20','getAllPayouts','ðŸ”\x20Selected\x20erc20\x20wallet:\x20','\x20\x20\x20ï¿½\x20Total\x20paid\x20out:\x20','klyme_de','fullName','rapyd','dailyPayments','notes','\x20\x20\x20ðŸª\x20Gateway\x20earnings:\x20','%\x20from\x20','\x20\x20\x20Available\x20(raw):\x20','\x20-\x20','telegram','\x20status:\x20','delete','currencyService','âŒ\x20Failed\x20to\x20send\x20Telegram\x20notification\x20for\x20payout\x20','ðŸ”§\x20[','ðŸŽ¯\x20[','PENDING','test_gateway','awaitingPayout','floor','ðŸ“Š\x20[ADMIN]\x20Calculating\x20commission\x20manually\x20for\x20payment\x20','\x20\x20\x20Final\x20payout\x20amount\x20used:\x20','merchantEarningsUSDT','\x20\x20\x20ðŸŒ\x20IP:\x20','lte','pendingPayout','Shop\x20not\x20found','forEach','all_time','\x20missing\x20amountUSDT,\x20using\x20fallback\x20conversion','gateway','ðŸ’±\x20Currency\x20filter\x20applied:\x20','ðŸ”\x20Total\x20payments\x20matching\x20filters:\x20',':\x20commission\x20=\x20','Error\x20parsing\x20gateway\x20settings\x20for\x20shop\x20','periodTo','ðŸ’°\x20[PAYOUT]\x20Merchant\x20','today','ðŸ’°\x20Found\x20','username','statusChangedBy','\x20\x20\x20â³\x20Pending\x20payout:\x20','paymentGateways','defineProperty','hex','not\x20set','ðŸ“Š\x20Statistics\x20date\x20range:\x20','not\x20specified','getUTCFullYear','\x27)\x20not\x20found\x20in\x20database,\x20returning\x20empty\x20result','ðŸ’°\x20Shop\x20','paidOutUSDT','\x20USDT\x20(','toLowerCase','this_month','\x20USDT,\x20Requested:\x20','payment','amountUSDT','ðŸ’³\x20Final\x20payout\x20wallet\x20for\x20','ðŸ”\x20Selected\x20trc20\x20wallet:\x20','totalAmountUSDT','\x20merchants','get',']\x20Password\x20not\x20provided\x20or\x20empty,\x20skipping\x20password\x20update','setUTCDate','toISOString','\x20\x20\x20Payout\x20amount:\x20','getUTCMonth','erc20','currency','ðŸ“Š\x20Using\x20saved\x20commission\x20rate\x20for\x20payment\x20','ðŸ”\x20No\x20wallet\x20provided,\x20looking\x20up\x20from\x20shop\x20settings...','28iUNuUh','wallet','turnoverUSDT','turnover','getMerchantsAwaitingPayout','set','\x20USDT\x20(gross\x20revenue)','\x20USDT\x20for\x20payment\x20','getSystemStatistics','log','findMany','\x20balance\x20updated:\x20','usdtErcWallet','balance','trim','week','custom_','cointopay2','UTC','\x20\x20\x20ðŸ‘¤\x20Merchant\x20earnings:\x20','stringify',',\x20successful:\x20','revenue','status','ÐÐµ\x20ÑƒÐºÐ°Ð·Ð°Ð½','statusChangedAt','commission','\x20\x20\x20Balance:\x20','PAID','telegramId','\x20balance\x20updated:','CHARGEBACK','aggregate','txid','\x20\x20\x20ï¿½ðŸ“Š\x20Total\x20payments:\x20','totalTurnover','ðŸ’°\x20Current\x20shop\x20balance:\x20','\x20\x20\x20Full\x20amount:\x20','424958wTiatO','getAllUsers','ðŸ“±\x20Telegram\x20notification\x20sent\x20for\x20payout\x20','failUrl','\x20\x20\x20ðŸ–¥ï¸\x20User\x20Agent:\x20',',\x20chargebacks:\x20','KLYME\x20DE','trc20','ðŸ”\x20[','split','createdAt','substr','getUTCDay','ðŸ’°\x20Payment\x20','ðŸ’¸\x20CHARGEBACK:\x20Processing\x20penalty-only\x20deduction','usdcPolygonWallet','ðŸ”„\x20Converted\x20gateway\x20ID\x20\x27','merchantEarnings','\x20order','getGatewayIdByName','86808CnMhpA','paymentsCount','\x20USDT\x20(sum\x20of\x20all\x20merchant\x20balances)','gatewaySettings','567498IXbGzu','ceil','REFUND','Insufficient\x20balance.\x20Available:\x20','ðŸ“Š\x20Getting\x20merchants\x20awaiting\x20payout\x20with\x20filters:','telegramBotService','ðŸ“Š\x20Getting\x20merchant\x20statistics\x20with\x20filters:','ðŸ“Š\x20Calculated\x20commission\x20rate\x20for\x20payment\x20','\x20for\x20shop\x20','startsWith','all',']\x20User\x20updated,\x20gatewaySettings\x20from\x20DB:','polygon_usdc','âœ…\x20Customer\x20data\x20updated\x20for\x20payment\x20','createPayout','COMPLETED','Rapyd','âœ…\x20Payout\x20created\x20in\x20DB:','shop','values','random','orderId','Open\x20Banking\x202','filter','âš ï¸\x20Payment\x20','reduce','wallets','averageCheckUSDT','gateways','\x20to\x20','ðŸ”„\x20REFUND:\x20Payment\x20amount\x20already\x20deducted\x20from\x20balance','toLocaleDateString','\x20\x20\x20ðŸ’¸\x20Total\x20payouts:\x20','ðŸ“Š\x20Calculating\x20payout\x20statistics...','SUSPENDED','bcryptjs','$transaction','\x20\x20\x20ðŸ’°\x20Total\x20turnover:\x20','name','lastMonth','dateTo','\x20\x20\x20Transaction\x20hash:\x20','suspendUser','Username\x20already\x20exists','usdcErcWallet','âœ…\x20Payout\x20created:\x20',',\x20userId:\x20','\x20merchants\x20with\x20rounded\x20balance\x20!=\x200.00\x20(excluding\x20balances\x20that\x20round\x20to\x200.00)','pk_','cointopay','amount','244335lUcrqf','gatewayCommissionRate','ðŸ“Š\x20Total\x20payments\x20(including\x20failed):\x20','ðŸ”\x20Balance\x20check\x20details:','2020-01-01','warn','ru-RU','\x20USDT\x20(theoretical\x20net)','\x20\x20\x20ðŸ’³\x20Total\x20payments:\x20','usdtTrcWallet','toUpperCase','Test\x20Gateway','asc','totalPayout','sendPayoutNotification','entries','ðŸ“Š\x20Using\x20saved\x20values\x20for\x20payment\x20','desc','paidAt','\x20with\x20payout\x20history','\x20\x20\x20ðŸ”\x20Calculated\x20after\x20commission:\x20','./telegramBotService','groupBy','\x27\x20to\x20name\x20\x27','190lNyDwj','totalAmountAfterCommissionUSDT','availableBalance','map','slice','updatePaymentStatus','sort','ðŸ”\x20Selected\x20erc20_usdc\x20wallet:\x20','\x27\x20not\x20found.\x20Available\x20gateways:\x20','\x20became\x20PAID:','customerEmail','getMonth','getGatewayInternalName','admin','toString',']\x20Updating\x20password\x20for\x20user\x20','\x20\x20\x20ðŸ’°\x20Total\x20payout:\x20','ðŸ“Š\x20Calculating\x20commission\x20manually\x20for\x20payment\x20','ðŸ“Š\x20Statistics\x20PAID\x20payments\x20count:\x20','âš ï¸\x20CHARGEBACK\x20without\x20penalty\x20amount\x20-\x20no\x20balance\x20change','thisMonth','\x20\x20\x20Tolerance:\x20','setHours','dateFrom','ðŸ“‹\x20Found\x20','\x20USDT\x20(-','merchantUrl','CoinToPay','payout',']\x20Gateway\x20settings\x20JSON\x20string:','averageCommissionRate','getGatewayNameById','\x20has\x20zero\x20or\x20null\x20amountUSDT,\x20skipping...','ðŸ”„\x20Gateway\x20mapping:','ðŸ”„\x20Updating\x20customer\x20data\x20for\x20payment\x20','length','âš ï¸\x20Gateway\x20\x27','generateDailyStatistics','periodFrom','\x20\x20\x20ðŸ’°\x20Total\x20payments\x20turnover:\x20','\x20\x20\x20Available\x20(number):\x20','totalPayments','shopUrl','\x20PAID\x20payments','network','\x20USDT\x20(calculated\x20-\x20payouts\x20-\x20balance)','%\x20commission)','deleteUser','period','noda','getUTCDate','gte','includes','some','customerIp','insensitive','20jSymVE','ðŸ’°\x20[PAYOUT]\x20Gateway\x20','\x20\x20\x20ðŸ’¸\x20Total\x20payouts\x20(all\x20time):\x20','setDate','\x20USDT,\x20merchant:\x20','ACTIVE','Plisio','\x20in\x20','usdtPolygonWallet','findUnique','\x20->\x20','ðŸ“Š\x20Merchants\x20with\x20rounded\x20balance\x20!=\x200.00:\x20','getAllPayments','getDate','ðŸ“‹\x20Getting\x20merchants\x20selection\x20list...','count','MasterCard','\x20USDT\x20(total\x20paid\x20to\x20merchants)','Noda','totalPaidOut','activateUser','customerCountry','default','\x20\x20\x20âœ…\x20Total\x20net\x20balances:\x20','shopId','\x20USDT','updateCustomerData','Error\x20parsing\x20gateway\x20settings\x20for\x20payment\x20','ðŸ“…\x20Date\x20from\x20filter:\x20','\x20paid\x20payments\x20for\x20analysis','\x20\x20\x20Added\x20to\x20balance:\x20+','\x20\x20\x20Difference:\x20','round','findFirst','customerName','publicKey','40AhbcNy','date','\x20\x20\x20Requested\x20(number):\x20','toFixed','ðŸ“…\x20Payout\x20date\x20from\x20filter:\x20','commissionUSDT','\x20merchants\x20for\x20selection','failureMessage','_count','getUserById','ðŸŽ¯\x20updateUser\x20called\x20with\x20ID:\x20','last_week','ðŸ”\x20Shop\x20wallets:','not\x20provided','createUser','âœ…\x20Balance\x20check\x20passed\x20(with\x20tolerance)','yesterday','ðŸ“Š\x20Available\x20gateways\x20in\x20database:'];a48_0x3fb2=function(){return _0x55cb9c;};return a48_0x3fb2();}var __importDefault=this&&this[a48_0x23d58a(0x279)]||function(_0x47d70b){const _0x5dd6e9=a48_0x23d58a;return _0x47d70b&&_0x47d70b[_0x5dd6e9(0x117)]?_0x47d70b:{'default':_0x47d70b};};Object[a48_0x23d58a(0x156)](exports,a48_0x23d58a(0x117),{'value':!![]}),exports[a48_0x23d58a(0x11d)]=void 0x0;function a48_0xae52(_0x5d0fcf,_0x544103){_0x5d0fcf=_0x5d0fcf-0x10f;const _0x3fb29e=a48_0x3fb2();let _0xae5248=_0x3fb29e[_0x5d0fcf];return _0xae5248;}const database_1=__importDefault(require('../config/database')),bcryptjs_1=__importDefault(require(a48_0x23d58a(0x1d4))),crypto_1=__importDefault(require('crypto')),currencyService_1=require('./currencyService'),telegramBotService_1=require(a48_0x23d58a(0x1f9)),gateway_1=require('../types/gateway');class AdminService{async['getPayoutStats'](){const _0x4492bc=a48_0x23d58a;console['log'](_0x4492bc(0x1d2));const _0x18a98d=await database_1[_0x4492bc(0x24a)][_0x4492bc(0x1c3)][_0x4492bc(0x193)]({'_sum':{'balance':!![],'totalPaidOut':!![]}}),_0x4aa568=await database_1['default'][_0x4492bc(0x163)][_0x4492bc(0x243)]({'where':{'status':_0x4492bc(0x18f),'gateway':{'not':_0x4492bc(0x13c)}}}),_0x153faa=new Date(),_0x444e2a=new Date(_0x153faa[_0x4492bc(0x11b)](),_0x153faa[_0x4492bc(0x207)](),0x1),_0x6ea4f1=new Date(_0x153faa[_0x4492bc(0x11b)](),_0x153faa[_0x4492bc(0x207)]()+0x1,0x0,0x17,0x3b,0x3b,0x3e7),_0x3347f4=await database_1[_0x4492bc(0x24a)][_0x4492bc(0x218)]['aggregate']({'_sum':{'amount':!![]},'where':{'createdAt':{'gte':_0x444e2a,'lte':_0x6ea4f1},'status':_0x4492bc(0x1c0)}}),_0x22eec8=_0x18a98d['_sum'][_0x4492bc(0x247)]||0x0,_0x7a0a15=_0x18a98d[_0x4492bc(0x26b)][_0x4492bc(0x180)]||0x0,_0x66571a=_0x3347f4[_0x4492bc(0x26b)][_0x4492bc(0x1e3)]||0x0,_0x5aca32={'totalPayout':Math[_0x4492bc(0x254)](_0x22eec8*0x64)/0x64,'awaitingPayout':Math['round'](_0x7a0a15*0x64)/0x64,'thisMonth':Math['round'](_0x66571a*0x64)/0x64,'availableBalance':Math[_0x4492bc(0x254)](_0x7a0a15*0x64)/0x64,'totalPayments':_0x4aa568};return console[_0x4492bc(0x17c)](_0x4492bc(0x126)),console[_0x4492bc(0x17c)](_0x4492bc(0x20c)+_0x5aca32[_0x4492bc(0x1f1)]+_0x4492bc(0x245)),console[_0x4492bc(0x17c)]('\x20\x20\x20â³\x20Awaiting\x20payout:\x20'+_0x5aca32[_0x4492bc(0x13d)]+_0x4492bc(0x1af)),console[_0x4492bc(0x17c)]('\x20\x20\x20ðŸ’µ\x20Available\x20balance:\x20'+_0x5aca32[_0x4492bc(0x1fe)]+'\x20USDT\x20(same\x20as\x20awaiting)'),console[_0x4492bc(0x17c)]('\x20\x20\x20ðŸ“…\x20This\x20month:\x20'+_0x5aca32[_0x4492bc(0x210)]+'\x20USDT'),console[_0x4492bc(0x17c)](_0x4492bc(0x1ec)+_0x5aca32[_0x4492bc(0x225)]+_0x4492bc(0x227)),_0x5aca32;}async[a48_0x23d58a(0x24e)](_0x185f92,_0xf3f3e7){const _0x34d707=a48_0x23d58a;console[_0x34d707(0x17c)](_0x34d707(0x21e)+_0x185f92+':',_0xf3f3e7);const _0x1cb348=await database_1['default']['payment'][_0x34d707(0x23d)]({'where':{'id':_0x185f92},'select':{'id':!![],'customerEmail':!![],'customerName':!![],'customerCountry':!![],'customerIp':!![],'customerUa':!![]}});if(!_0x1cb348)throw new Error(_0x34d707(0x26e));const _0x242949={};_0xf3f3e7[_0x34d707(0x249)]!==undefined&&(_0x242949[_0x34d707(0x249)]=_0xf3f3e7[_0x34d707(0x249)]||null);_0xf3f3e7[_0x34d707(0x232)]!==undefined&&(_0x242949['customerIp']=_0xf3f3e7[_0x34d707(0x232)]||null);_0xf3f3e7[_0x34d707(0x282)]!==undefined&&(_0x242949[_0x34d707(0x282)]=_0xf3f3e7[_0x34d707(0x282)]||null);const _0x182999=await database_1[_0x34d707(0x24a)]['payment'][_0x34d707(0x27e)]({'where':{'id':_0x185f92},'data':{..._0x242949,'updatedAt':new Date()},'select':{'id':!![],'customerEmail':!![],'customerName':!![],'customerCountry':!![],'customerIp':!![],'customerUa':!![],'updatedAt':!![]}});return console[_0x34d707(0x17c)](_0x34d707(0x1be)+_0x185f92),console['log'](_0x34d707(0x275)+_0x1cb348['customerCountry']+'\x20->\x20'+_0x182999[_0x34d707(0x249)]),console[_0x34d707(0x17c)](_0x34d707(0x142)+_0x1cb348[_0x34d707(0x232)]+'\x20->\x20'+_0x182999[_0x34d707(0x232)]),console[_0x34d707(0x17c)](_0x34d707(0x19d)+(_0x1cb348[_0x34d707(0x282)]?_0x34d707(0x178):'not\x20set')+_0x34d707(0x23e)+(_0x182999['customerUa']?_0x34d707(0x178):_0x34d707(0x158))),_0x182999;}async[a48_0x23d58a(0x17b)](_0xaeb82f,_0x164767){const _0x419b42=a48_0x23d58a,_0x66538f=_0x164767?new Date(_0x164767):new Date();let _0x22c581,_0x389045;if(_0xaeb82f[_0x419b42(0x1ba)](_0x419b42(0x183))){const _0x26997e=_0xaeb82f['replace'](_0x419b42(0x183),'')['split']('_');if(_0x26997e[_0x419b42(0x21f)]===0x2){const _0x5af685=new Date(_0x26997e[0x0]),_0x59427b=new Date(_0x26997e[0x1]);_0x22c581=new Date(Date[_0x419b42(0x185)](_0x5af685[_0x419b42(0x15b)](),_0x5af685[_0x419b42(0x16e)](),_0x5af685[_0x419b42(0x22e)](),0x0,0x0,0x0,0x0)),_0x389045=new Date(Date['UTC'](_0x59427b[_0x419b42(0x15b)](),_0x59427b[_0x419b42(0x16e)](),_0x59427b[_0x419b42(0x22e)](),0x17,0x3b,0x3b,0x3e7));}else{const _0x403086=new Date(Date[_0x419b42(0x185)](_0x66538f[_0x419b42(0x15b)](),_0x66538f[_0x419b42(0x16e)](),_0x66538f[_0x419b42(0x22e)]()-0x1e));_0x22c581=new Date(Date[_0x419b42(0x185)](_0x403086['getUTCFullYear'](),_0x403086[_0x419b42(0x16e)](),_0x403086[_0x419b42(0x22e)](),0x0,0x0,0x0,0x0)),_0x389045=new Date(Date['UTC'](_0x66538f['getUTCFullYear'](),_0x66538f[_0x419b42(0x16e)](),_0x66538f['getUTCDate'](),0x17,0x3b,0x3b,0x3e7));}}else{switch(_0xaeb82f['toLowerCase']()){case _0x419b42(0x150):_0x22c581=new Date(Date[_0x419b42(0x185)](_0x66538f[_0x419b42(0x15b)](),_0x66538f['getUTCMonth'](),_0x66538f[_0x419b42(0x22e)](),0x0,0x0,0x0,0x0)),_0x389045=new Date(Date['UTC'](_0x66538f[_0x419b42(0x15b)](),_0x66538f[_0x419b42(0x16e)](),_0x66538f[_0x419b42(0x22e)](),0x17,0x3b,0x3b,0x3e7));break;case _0x419b42(0x268):const _0xe4389d=new Date(_0x66538f);_0xe4389d['setUTCDate'](_0xe4389d[_0x419b42(0x22e)]()-0x1),_0x22c581=new Date(Date[_0x419b42(0x185)](_0xe4389d[_0x419b42(0x15b)](),_0xe4389d[_0x419b42(0x16e)](),_0xe4389d[_0x419b42(0x22e)](),0x0,0x0,0x0,0x0)),_0x389045=new Date(Date[_0x419b42(0x185)](_0xe4389d['getUTCFullYear'](),_0xe4389d[_0x419b42(0x16e)](),_0xe4389d[_0x419b42(0x22e)](),0x17,0x3b,0x3b,0x3e7));break;case'this_week':const _0xb1c87b=_0x66538f[_0x419b42(0x1a5)](),_0x334e0c=_0xb1c87b===0x0?-0x6:0x1-_0xb1c87b,_0x587af3=_0x66538f[_0x419b42(0x22e)]()+_0x334e0c;_0x22c581=new Date(Date['UTC'](_0x66538f[_0x419b42(0x15b)](),_0x66538f['getUTCMonth'](),_0x587af3,0x0,0x0,0x0,0x0)),_0x389045=new Date(Date[_0x419b42(0x185)](_0x66538f[_0x419b42(0x15b)](),_0x66538f[_0x419b42(0x16e)](),_0x66538f[_0x419b42(0x22e)](),0x17,0x3b,0x3b,0x3e7));break;case _0x419b42(0x263):const _0x3ea1b6=new Date(Date[_0x419b42(0x185)](_0x66538f['getUTCFullYear'](),_0x66538f[_0x419b42(0x16e)](),_0x66538f[_0x419b42(0x22e)]()-0x7)),_0xdedce3=_0x3ea1b6['getUTCDay'](),_0x2d87e8=_0xdedce3===0x0?-0x6:0x1-_0xdedce3,_0x115437=_0x3ea1b6[_0x419b42(0x22e)]()+_0x2d87e8;_0x22c581=new Date(Date['UTC'](_0x3ea1b6[_0x419b42(0x15b)](),_0x3ea1b6[_0x419b42(0x16e)](),_0x115437,0x0,0x0,0x0,0x0)),_0x389045=new Date(Date[_0x419b42(0x185)](_0x3ea1b6[_0x419b42(0x15b)](),_0x3ea1b6[_0x419b42(0x16e)](),_0x115437+0x6,0x17,0x3b,0x3b,0x3e7));break;case _0x419b42(0x161):_0x22c581=new Date(Date[_0x419b42(0x185)](_0x66538f[_0x419b42(0x15b)](),_0x66538f[_0x419b42(0x16e)](),0x1,0x0,0x0,0x0,0x0)),_0x389045=new Date(Date['UTC'](_0x66538f[_0x419b42(0x15b)](),_0x66538f['getUTCMonth'](),_0x66538f[_0x419b42(0x22e)](),0x17,0x3b,0x3b,0x3e7));break;case'last_month':_0x22c581=new Date(Date['UTC'](_0x66538f[_0x419b42(0x15b)](),_0x66538f['getUTCMonth']()-0x1,0x1,0x0,0x0,0x0,0x0)),_0x389045=new Date(Date[_0x419b42(0x185)](_0x66538f[_0x419b42(0x15b)](),_0x66538f[_0x419b42(0x16e)](),0x0,0x17,0x3b,0x3b,0x3e7));break;case _0x419b42(0x147):_0x22c581=new Date(Date[_0x419b42(0x185)](0x7e9,0x5,0xe,0x0,0x0,0x0,0x0)),_0x389045=new Date(Date['UTC'](_0x66538f['getUTCFullYear'](),_0x66538f[_0x419b42(0x16e)](),_0x66538f[_0x419b42(0x22e)](),0x17,0x3b,0x3b,0x3e7));break;default:_0x22c581=new Date(_0x66538f[_0x419b42(0x10f)]()-0x1e*0x18*0x3c*0x3c*0x3e8);const _0x46bc10=new Date(Date[_0x419b42(0x185)](_0x66538f['getUTCFullYear'](),_0x66538f[_0x419b42(0x16e)](),_0x66538f[_0x419b42(0x22e)]()-0x1e));_0x22c581=new Date(Date[_0x419b42(0x185)](_0x46bc10[_0x419b42(0x15b)](),_0x46bc10['getUTCMonth'](),_0x46bc10[_0x419b42(0x22e)](),0x0,0x0,0x0,0x0)),_0x389045=new Date(Date[_0x419b42(0x185)](_0x66538f[_0x419b42(0x15b)](),_0x66538f[_0x419b42(0x16e)](),_0x66538f[_0x419b42(0x22e)](),0x17,0x3b,0x3b,0x3e7));}const _0x373ef6={'gte':_0x22c581,'lte':_0x389045};console[_0x419b42(0x17c)](_0x419b42(0x159)+_0x22c581['toISOString']()+_0x419b42(0x1ce)+_0x389045['toISOString']());const [_0x3f411b,_0x268296,_0x47a729,_0xc2def3,_0x5617cb,_0x18a1fa,_0x1a6daa,_0x1705df,_0x3bd52d]=await Promise['all']([database_1[_0x419b42(0x24a)][_0x419b42(0x1c3)][_0x419b42(0x243)](),database_1['default'][_0x419b42(0x1c3)][_0x419b42(0x243)]({'where':{'status':_0x419b42(0x239)}}),database_1[_0x419b42(0x24a)][_0x419b42(0x163)][_0x419b42(0x243)]({'where':{'status':_0x419b42(0x18f),'createdAt':_0x373ef6,'gateway':{'not':_0x419b42(0x13c)}}}),database_1[_0x419b42(0x24a)][_0x419b42(0x163)][_0x419b42(0x243)]({'where':{'status':_0x419b42(0x192),'createdAt':_0x373ef6,'gateway':{'not':_0x419b42(0x13c)}}}),database_1[_0x419b42(0x24a)]['payment'][_0x419b42(0x243)]({'where':{'status':_0x419b42(0x1b3),'createdAt':_0x373ef6,'gateway':{'not':'test_gateway'}}}),database_1[_0x419b42(0x24a)][_0x419b42(0x163)][_0x419b42(0x17d)]({'where':{'status':_0x419b42(0x18f),'createdAt':_0x373ef6,'gateway':{'not':_0x419b42(0x13c)}},'select':{'amount':!![],'currency':!![],'amountUSDT':!![],'amountAfterGatewayCommissionUSDT':!![]}}),database_1[_0x419b42(0x24a)][_0x419b42(0x163)][_0x419b42(0x17d)]({'where':{'gateway':{'not':_0x419b42(0x13c)}},'take':0xa,'orderBy':{'createdAt':'desc'},'include':{'shop':{'select':{'name':!![],'username':!![]}}}}),database_1[_0x419b42(0x24a)]['payment'][_0x419b42(0x17d)]({'where':{'createdAt':_0x373ef6,'gateway':{'not':'test_gateway'}},'select':{'amount':!![],'currency':!![],'status':!![],'amountUSDT':!![],'createdAt':!![]}}),database_1[_0x419b42(0x24a)][_0x419b42(0x163)]['findMany']({'where':{'status':_0x419b42(0x18f),'gateway':{'not':_0x419b42(0x13c)}},'select':{'amountUSDT':!![],'amountAfterGatewayCommissionUSDT':!![]}})]);console[_0x419b42(0x17c)](_0x419b42(0x20e)+_0x47a729);let _0x3c001f=0x0,_0x1d6a89=0x0;for(const _0x216f6b of _0x18a1fa){const _0x576926=_0x216f6b[_0x419b42(0x164)]||0x0;_0x3c001f+=_0x576926;if(_0x216f6b[_0x419b42(0x11c)]&&_0x216f6b[_0x419b42(0x164)]){const _0x5e5128=_0x216f6b[_0x419b42(0x164)]-_0x216f6b[_0x419b42(0x11c)];_0x1d6a89+=_0x5e5128;}}let _0x5ec540=0x0;for(const _0x8a1407 of _0x3bd52d){if(_0x8a1407['amountAfterGatewayCommissionUSDT']&&_0x8a1407[_0x419b42(0x164)]){const _0x203f10=_0x8a1407[_0x419b42(0x164)]-_0x8a1407[_0x419b42(0x11c)];_0x5ec540+=_0x203f10;}}const _0xa40b4a=_0x47a729>0x0?_0x3c001f/_0x47a729:0x0,_0x3aafc9=this[_0x419b42(0x221)](_0x1705df,_0x22c581,_0x389045),_0x13d9dd=await database_1[_0x419b42(0x24a)][_0x419b42(0x163)][_0x419b42(0x243)]({'where':{'createdAt':_0x373ef6,'gateway':{'not':'test_gateway'},'status':{'notIn':['PENDING',_0x419b42(0x125)]}}}),_0x4d732c=_0x13d9dd>0x0?_0x47a729/_0x13d9dd*0x64:0x0;return{'totalShops':_0x3f411b,'activeShops':_0x268296,'totalPayments':_0x13d9dd,'successfulPayments':_0x47a729,'totalAttempts':_0x13d9dd,'chargebacks':_0xc2def3,'refunds':_0x5617cb,'totalRevenue':Math[_0x419b42(0x254)](_0x3c001f*0x64)/0x64,'trapayEarnings':Math[_0x419b42(0x254)](_0x1d6a89*0x64)/0x64,'trapayEarningsAllTime':Math['round'](_0x5ec540*0x64)/0x64,'averagePaymentAmount':Math[_0x419b42(0x254)](_0xa40b4a*0x64)/0x64,'conversionRate':Math[_0x419b42(0x254)](_0x4d732c*0x64)/0x64,'dailyRevenue':_0x3aafc9['dailyRevenue'],'dailyPayments':_0x3aafc9[_0x419b42(0x12e)],'recentPayments':_0x1a6daa[_0x419b42(0x1ff)](_0x875c9d=>({'id':_0x875c9d['id'],'amount':_0x875c9d[_0x419b42(0x1e3)],'currency':_0x875c9d[_0x419b42(0x170)],'status':_0x875c9d[_0x419b42(0x18a)],'gateway':_0x875c9d['gateway'],'shop':_0x875c9d[_0x419b42(0x1c3)],'createdAt':_0x875c9d[_0x419b42(0x1a3)]}))};}}async['getMerchantStatistics'](_0x3c64d1){const _0x16383d=a48_0x23d58a;console[_0x16383d(0x17c)](_0x16383d(0x1b7),_0x3c64d1);let _0x1f7a6b,_0xe5fae7=new Date();if(_0x3c64d1[_0x16383d(0x22c)]==='custom'&&_0x3c64d1[_0x16383d(0x213)]&&_0x3c64d1[_0x16383d(0x1d9)]){const _0x407d0a=new Date(_0x3c64d1[_0x16383d(0x213)]),_0xd30c2d=new Date(_0x3c64d1[_0x16383d(0x1d9)]);_0x1f7a6b=new Date(Date['UTC'](_0x407d0a['getUTCFullYear'](),_0x407d0a[_0x16383d(0x16e)](),_0x407d0a[_0x16383d(0x22e)](),0x0,0x0,0x0,0x0)),_0xe5fae7=new Date(Date['UTC'](_0xd30c2d[_0x16383d(0x15b)](),_0xd30c2d[_0x16383d(0x16e)](),_0xd30c2d['getUTCDate'](),0x17,0x3b,0x3b,0x3e7));}else{const _0x5c188b=new Date();switch(_0x3c64d1[_0x16383d(0x22c)]){case _0x16383d(0x182):_0x1f7a6b=new Date(_0x5c188b['getTime']()-0x7*0x18*0x3c*0x3c*0x3e8),_0x1f7a6b['setHours'](0x0,0x0,0x0,0x0),_0xe5fae7[_0x16383d(0x212)](0x17,0x3b,0x3b,0x3e7);break;case'month':_0x1f7a6b=new Date(Date[_0x16383d(0x185)](_0x5c188b['getUTCFullYear'](),_0x5c188b[_0x16383d(0x16e)](),0x1,0x0,0x0,0x0,0x0)),_0xe5fae7=new Date(Date[_0x16383d(0x185)](_0x5c188b[_0x16383d(0x15b)](),_0x5c188b[_0x16383d(0x16e)]()+0x1,0x0,0x17,0x3b,0x3b,0x3e7));break;case _0x16383d(0x1d8):_0x1f7a6b=new Date(Date[_0x16383d(0x185)](_0x5c188b[_0x16383d(0x15b)](),_0x5c188b[_0x16383d(0x16e)]()-0x1,0x1,0x0,0x0,0x0,0x0)),_0xe5fae7=new Date(Date[_0x16383d(0x185)](_0x5c188b['getUTCFullYear'](),_0x5c188b[_0x16383d(0x16e)](),0x0,0x17,0x3b,0x3b,0x3e7));break;case'year':_0x1f7a6b=new Date(_0x5c188b[_0x16383d(0x10f)]()-0x16d*0x18*0x3c*0x3c*0x3e8),_0x1f7a6b['setHours'](0x0,0x0,0x0,0x0),_0xe5fae7['setHours'](0x17,0x3b,0x3b,0x3e7);break;case _0x16383d(0x1bb):default:_0x1f7a6b=new Date(_0x16383d(0x1e8)),_0x1f7a6b[_0x16383d(0x212)](0x0,0x0,0x0,0x0),_0xe5fae7['setHours'](0x17,0x3b,0x3b,0x3e7);break;}}console[_0x16383d(0x17c)]('ðŸ“…\x20Period:\x20'+_0x1f7a6b['toISOString']()+_0x16383d(0x1ce)+_0xe5fae7[_0x16383d(0x16c)]());const _0x252f7e={'status':_0x16383d(0x18f),'gateway':{'not':_0x16383d(0x13c)},'createdAt':{'gte':_0x1f7a6b,'lte':_0xe5fae7}};_0x3c64d1[_0x16383d(0x24c)]&&(_0x252f7e[_0x16383d(0x24c)]=_0x3c64d1[_0x16383d(0x24c)]);const _0x26ff2b=await database_1[_0x16383d(0x24a)][_0x16383d(0x163)]['findMany']({'where':_0x252f7e,'select':{'id':!![],'amount':!![],'currency':!![],'amountUSDT':!![],'amountAfterGatewayCommissionUSDT':!![],'gatewayCommissionRate':!![],'gateway':!![],'shopId':!![],'paidAt':!![],'shop':{'select':{'id':!![],'name':!![],'username':!![],'gatewaySettings':!![]}}}});console[_0x16383d(0x17c)](_0x16383d(0x151)+_0x26ff2b[_0x16383d(0x21f)]+_0x16383d(0x251));const _0x29022a={'gateway':{'not':_0x16383d(0x13c)},'status':{'notIn':[_0x16383d(0x13b),_0x16383d(0x125)]},'createdAt':{'gte':_0x1f7a6b,'lte':_0xe5fae7}};_0x3c64d1['shopId']&&(_0x29022a['shopId']=_0x3c64d1['shopId']);const _0x588366=await database_1[_0x16383d(0x24a)]['payment'][_0x16383d(0x243)]({'where':_0x29022a}),_0x398f39={..._0x29022a,'status':'CHARGEBACK'},_0x4507bb={..._0x29022a,'status':_0x16383d(0x1b3)},[_0x3dcdbb,_0x40d510]=await Promise[_0x16383d(0x1bb)]([database_1[_0x16383d(0x24a)][_0x16383d(0x163)][_0x16383d(0x243)]({'where':_0x398f39}),database_1[_0x16383d(0x24a)]['payment'][_0x16383d(0x243)]({'where':_0x4507bb})]);console[_0x16383d(0x17c)](_0x16383d(0x1e6)+_0x588366+_0x16383d(0x188)+_0x26ff2b['length']+_0x16383d(0x19e)+_0x3dcdbb+',\x20refunds:\x20'+_0x40d510);let _0x54b01f=0x0,_0x1f5efe=0x0,_0x5790f1=0x0;const _0x50cafb={},_0x38b2de={},_0x1c2e79={},_0x305347=new Date(_0x1f7a6b);while(_0x305347<=_0xe5fae7){const _0xbd91ec=_0x305347[_0x16383d(0x16c)]()['split']('T')[0x0];_0x1c2e79[_0xbd91ec]={'date':_0xbd91ec,'turnover':0x0,'merchantEarnings':0x0,'gatewayEarnings':0x0,'paymentsCount':0x0},_0x305347[_0x16383d(0x16b)](_0x305347['getUTCDate']()+0x1);}for(const _0x3ce235 of _0x26ff2b){try{const _0x29ba09=_0x3ce235[_0x16383d(0x164)]||0x0;if(_0x29ba09<=0x0){console[_0x16383d(0x1e9)](_0x16383d(0x1c9)+_0x3ce235['id']+_0x16383d(0x21c));continue;}let _0x1dc287,_0xb89c96;if(_0x3ce235['amountAfterGatewayCommissionUSDT']!==null&&_0x3ce235[_0x16383d(0x11c)]!==undefined)_0x1dc287=_0x3ce235[_0x16383d(0x11c)],_0xb89c96=_0x29ba09-_0x1dc287,console['log'](_0x16383d(0x1f4)+_0x3ce235['id']+':\x20'+_0x29ba09['toFixed'](0x6)+_0x16383d(0x238)+_0x1dc287['toFixed'](0x6)+_0x16383d(0x24d));else{let _0x48d7a1={};if(_0x3ce235[_0x16383d(0x1c3)][_0x16383d(0x1b0)])try{_0x48d7a1=JSON['parse'](_0x3ce235[_0x16383d(0x1c3)][_0x16383d(0x1b0)]);}catch(_0x54e603){console[_0x16383d(0x111)]('Error\x20parsing\x20gateway\x20settings\x20for\x20shop\x20'+_0x3ce235[_0x16383d(0x24c)]+':',_0x54e603);}let _0x5a8502=0x2d;for(const [_0x50594a,_0x49f9dd]of Object['entries'](_0x48d7a1)){if(_0x50594a[_0x16383d(0x160)]()===_0x3ce235[_0x16383d(0x149)][_0x16383d(0x160)]()){_0x5a8502=_0x49f9dd['commission']||0x2d;break;}}_0xb89c96=_0x29ba09*(_0x5a8502/0x64),_0x1dc287=_0x29ba09-_0xb89c96,console['log'](_0x16383d(0x20d)+_0x3ce235['id']+':\x20'+_0x5a8502+_0x16383d(0x131)+_0x29ba09[_0x16383d(0x25b)](0x6)+_0x16383d(0x24d));}_0x54b01f+=_0x29ba09,_0x1f5efe+=_0x1dc287,_0x5790f1+=_0xb89c96;let _0x38b1df;_0x3ce235[_0x16383d(0x1e5)]!==null&&_0x3ce235[_0x16383d(0x1e5)]!==undefined?(_0x38b1df=_0x3ce235[_0x16383d(0x1e5)],console[_0x16383d(0x17c)](_0x16383d(0x171)+_0x3ce235['id']+':\x20'+_0x38b1df+'%')):(_0x38b1df=_0x29ba09>0x0?_0xb89c96/_0x29ba09*0x64:0x0,console['log'](_0x16383d(0x1b8)+_0x3ce235['id']+':\x20'+_0x38b1df['toFixed'](0x2)+'%'));!_0x50cafb[_0x3ce235['gateway']]&&(_0x50cafb[_0x3ce235[_0x16383d(0x149)]]={'gateway':_0x3ce235['gateway'],'gatewayDisplayName':this['getGatewayDisplayName'](_0x3ce235[_0x16383d(0x149)]),'paymentsCount':0x0,'turnoverUSDT':0x0,'commissionUSDT':0x0,'merchantEarningsUSDT':0x0,'totalCommissionRate':0x0});_0x50cafb[_0x3ce235[_0x16383d(0x149)]]['paymentsCount']++,_0x50cafb[_0x3ce235[_0x16383d(0x149)]][_0x16383d(0x175)]+=_0x29ba09,_0x50cafb[_0x3ce235[_0x16383d(0x149)]][_0x16383d(0x25d)]+=_0xb89c96,_0x50cafb[_0x3ce235[_0x16383d(0x149)]][_0x16383d(0x141)]+=_0x1dc287,_0x50cafb[_0x3ce235[_0x16383d(0x149)]][_0x16383d(0x280)]+=_0x38b1df;!_0x3c64d1[_0x16383d(0x24c)]&&(!_0x38b2de[_0x3ce235['shopId']]&&(_0x38b2de[_0x3ce235[_0x16383d(0x24c)]]={'shopId':_0x3ce235[_0x16383d(0x24c)],'shopName':_0x3ce235[_0x16383d(0x1c3)]['name'],'shopUsername':_0x3ce235[_0x16383d(0x1c3)][_0x16383d(0x152)],'paymentsCount':0x0,'turnoverUSDT':0x0,'commissionUSDT':0x0,'merchantEarningsUSDT':0x0,'paidOutUSDT':0x0,'averageCheckUSDT':0x0}),_0x38b2de[_0x3ce235[_0x16383d(0x24c)]][_0x16383d(0x1ae)]++,_0x38b2de[_0x3ce235[_0x16383d(0x24c)]][_0x16383d(0x175)]+=_0x29ba09,_0x38b2de[_0x3ce235['shopId']]['commissionUSDT']+=_0xb89c96,_0x38b2de[_0x3ce235['shopId']][_0x16383d(0x141)]+=_0x1dc287);const _0x18166a=_0x3ce235[_0x16383d(0x1f6)][_0x16383d(0x16c)]()[_0x16383d(0x1a2)]('T')[0x0];_0x1c2e79[_0x18166a]&&(_0x1c2e79[_0x18166a][_0x16383d(0x176)]+=_0x29ba09,_0x1c2e79[_0x18166a][_0x16383d(0x1aa)]+=_0x1dc287,_0x1c2e79[_0x18166a]['gatewayEarnings']+=_0xb89c96,_0x1c2e79[_0x18166a][_0x16383d(0x1ae)]++);}catch(_0x131237){console['error']('Error\x20processing\x20payment\x20'+_0x3ce235['id']+':',_0x131237);}}Object['values'](_0x50cafb)[_0x16383d(0x146)](_0x26febe=>{const _0x436e40=_0x16383d;_0x26febe['averageCommissionRate']=_0x26febe[_0x436e40(0x1ae)]>0x0?_0x26febe[_0x436e40(0x280)]/_0x26febe[_0x436e40(0x1ae)]:0x0,delete _0x26febe[_0x436e40(0x280)];}),Object[_0x16383d(0x1c4)](_0x38b2de)['forEach'](_0x21e0d1=>{const _0xe5bd96=_0x16383d;_0x21e0d1['averageCheckUSDT']=_0x21e0d1['paymentsCount']>0x0?_0x21e0d1[_0xe5bd96(0x175)]/_0x21e0d1['paymentsCount']:0x0;});let _0x486e57=0x0,_0x1c5719=0x0;if(_0x3c64d1[_0x16383d(0x24c)]){const _0x48c222=await database_1[_0x16383d(0x24a)]['payout'][_0x16383d(0x17d)]({'where':{'shopId':_0x3c64d1['shopId'],'status':'COMPLETED','createdAt':{'gte':_0x1f7a6b,'lte':_0xe5fae7}},'select':{'amount':!![]}});_0x486e57=_0x48c222[_0x16383d(0x1ca)]((_0x5a6a3e,_0xadbc56)=>_0x5a6a3e+_0xadbc56[_0x16383d(0x1e3)],0x0);const _0x103853=await database_1[_0x16383d(0x24a)][_0x16383d(0x218)][_0x16383d(0x17d)]({'where':{'shopId':_0x3c64d1[_0x16383d(0x24c)],'status':_0x16383d(0x13b),'createdAt':{'gte':_0x1f7a6b,'lte':_0xe5fae7}},'select':{'amount':!![]}});_0x1c5719=_0x103853[_0x16383d(0x1ca)]((_0x318cee,_0x483724)=>_0x318cee+_0x483724[_0x16383d(0x1e3)],0x0);}const _0x27ff65=_0x588366,_0x79bb41=_0x26ff2b[_0x16383d(0x21f)],_0x1255eb=_0x79bb41>0x0?_0x54b01f/_0x79bb41:0x0,_0x3a7e6f=_0x27ff65>0x0?Math['round'](_0x79bb41/_0x27ff65*0x2710)/0x64:0x0,_0x1ba8aa=Math[_0x16383d(0x1b2)]((_0xe5fae7['getTime']()-_0x1f7a6b[_0x16383d(0x10f)]())/(0x3e8*0x3c*0x3c*0x18)),_0xd42472={'totalTurnover':Math[_0x16383d(0x254)](_0x54b01f*0x64)/0x64,'merchantEarnings':Math[_0x16383d(0x254)](_0x1f5efe*0x64)/0x64,'gatewayEarnings':Math[_0x16383d(0x254)](_0x5790f1*0x64)/0x64,'totalPaidOut':Math[_0x16383d(0x254)](_0x486e57*0x64)/0x64,'pendingPayout':Math['round'](_0x1c5719*0x64)/0x64,'averageCheck':Math[_0x16383d(0x254)](_0x1255eb*0x64)/0x64,'totalPayments':_0x27ff65,'successfulPayments':_0x79bb41,'conversionRate':_0x3a7e6f,'chargebacks':_0x3dcdbb,'refunds':_0x40d510,'gatewayBreakdown':Object['values'](_0x50cafb)[_0x16383d(0x1ff)](_0x5abd2c=>({..._0x5abd2c,'turnoverUSDT':Math[_0x16383d(0x254)](_0x5abd2c[_0x16383d(0x175)]*0x64)/0x64,'commissionUSDT':Math[_0x16383d(0x254)](_0x5abd2c[_0x16383d(0x25d)]*0x64)/0x64,'merchantEarningsUSDT':Math[_0x16383d(0x254)](_0x5abd2c[_0x16383d(0x141)]*0x64)/0x64,'averageCommissionRate':Math[_0x16383d(0x254)](_0x5abd2c[_0x16383d(0x21a)]*0x64)/0x64})),'merchantBreakdown':_0x3c64d1[_0x16383d(0x24c)]?undefined:Object[_0x16383d(0x1c4)](_0x38b2de)[_0x16383d(0x1ff)](_0x5e8ee4=>({..._0x5e8ee4,'turnoverUSDT':Math[_0x16383d(0x254)](_0x5e8ee4[_0x16383d(0x175)]*0x64)/0x64,'commissionUSDT':Math[_0x16383d(0x254)](_0x5e8ee4[_0x16383d(0x25d)]*0x64)/0x64,'merchantEarningsUSDT':Math[_0x16383d(0x254)](_0x5e8ee4['merchantEarningsUSDT']*0x64)/0x64,'paidOutUSDT':Math[_0x16383d(0x254)](_0x5e8ee4[_0x16383d(0x15e)]*0x64)/0x64,'averageCheckUSDT':Math['round'](_0x5e8ee4[_0x16383d(0x1cc)]*0x64)/0x64})),'dailyData':Object[_0x16383d(0x1c4)](_0x1c2e79)[_0x16383d(0x1ff)](_0x201787=>({..._0x201787,'turnover':Math[_0x16383d(0x254)](_0x201787[_0x16383d(0x176)]*0x64)/0x64,'merchantEarnings':Math['round'](_0x201787[_0x16383d(0x1aa)]*0x64)/0x64,'gatewayEarnings':Math['round'](_0x201787[_0x16383d(0x114)]*0x64)/0x64}))[_0x16383d(0x202)]((_0x5eda88,_0x450b43)=>_0x5eda88[_0x16383d(0x259)]['localeCompare'](_0x450b43[_0x16383d(0x259)])),'periodInfo':{'from':_0x1f7a6b,'to':_0xe5fae7,'periodType':_0x3c64d1[_0x16383d(0x22c)]||_0x16383d(0x27f),'daysCount':_0x1ba8aa}};return console[_0x16383d(0x17c)](_0x16383d(0x273)),console[_0x16383d(0x17c)](_0x16383d(0x1d6)+_0xd42472[_0x16383d(0x196)]+_0x16383d(0x24d)),console[_0x16383d(0x17c)](_0x16383d(0x186)+_0xd42472[_0x16383d(0x1aa)]+'\x20USDT'),console[_0x16383d(0x17c)](_0x16383d(0x130)+_0xd42472[_0x16383d(0x114)]+_0x16383d(0x24d)),console[_0x16383d(0x17c)](_0x16383d(0x12a)+_0xd42472[_0x16383d(0x247)]+_0x16383d(0x24d)),console[_0x16383d(0x17c)](_0x16383d(0x154)+_0xd42472[_0x16383d(0x144)]+'\x20USDT'),console[_0x16383d(0x17c)](_0x16383d(0x195)+_0xd42472[_0x16383d(0x225)]),_0xd42472;}async[a48_0x23d58a(0x27b)](_0x5d81e4){const _0x535196=a48_0x23d58a;console[_0x535196(0x17c)](_0x535196(0x242),{'hasPayoutHistory':_0x5d81e4});let _0x5bddb9={};_0x5d81e4&&(_0x5bddb9['payouts']={'some':{}});const _0x4b3ba2=await database_1[_0x535196(0x24a)][_0x535196(0x1c3)][_0x535196(0x17d)]({'where':_0x5bddb9,'select':{'id':!![],'username':!![],'name':!![]},'orderBy':{'name':_0x535196(0x1f0)}});return console['log'](_0x535196(0x214)+_0x4b3ba2['length']+_0x535196(0x25e)+(_0x5d81e4?_0x535196(0x1f7):'')),_0x4b3ba2['map'](_0x45b7bd=>({'id':_0x45b7bd['id'],'username':_0x45b7bd[_0x535196(0x152)],'name':_0x45b7bd[_0x535196(0x1d7)]}));}[a48_0x23d58a(0x281)](_0x8eb00d){const _0x54a03d=a48_0x23d58a,_0x5ea52b={'test_gateway':_0x54a03d(0x1ef),'plisio':_0x54a03d(0x23a),'rapyd':_0x54a03d(0x1c1),'noda':_0x54a03d(0x246),'cointopay':_0x54a03d(0x217),'cointopay2':_0x54a03d(0x1c7),'klyme_eu':'KLYME\x20EU','klyme_gb':'KLYME\x20GB','klyme_de':_0x54a03d(0x19f),'mastercard':_0x54a03d(0x244)};return _0x5ea52b[_0x8eb00d]||_0x8eb00d;}[a48_0x23d58a(0x208)](_0x278e90){const _0x131505=a48_0x23d58a,_0x2535fc={'Test\x20Gateway':_0x131505(0x13c),'Plisio':'plisio','Rapyd':_0x131505(0x12d),'Noda':_0x131505(0x22d),'CoinToPay':_0x131505(0x1e2),'CoinToPay2':_0x131505(0x184),'KLYME\x20EU':_0x131505(0x278),'KLYME\x20GB':'klyme_gb','KLYME\x20DE':_0x131505(0x12b),'MasterCard':'mastercard'};return _0x2535fc[_0x278e90]||_0x278e90[_0x131505(0x160)]();}async[a48_0x23d58a(0x177)](_0x4254de){const _0xbe599a=a48_0x23d58a,{page:_0x144ed7,limit:_0x37521c,minAmount:_0x3f8516,search:_0x1b5a1f}=_0x4254de;console[_0xbe599a(0x17c)](_0xbe599a(0x1b5),_0x4254de);let _0xc6c12e={};_0x1b5a1f&&(_0xc6c12e[_0xbe599a(0x1d7)]={'contains':_0x1b5a1f,'mode':_0xbe599a(0x233)});const _0x41ecee=await database_1[_0xbe599a(0x24a)][_0xbe599a(0x1c3)][_0xbe599a(0x17d)]({'where':_0xc6c12e,'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'balance':!![],'totalPaidOut':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'usdcErcWallet':!![],'gatewaySettings':!![],'createdAt':!![]}}),_0x22eedf=_0x41ecee[_0xbe599a(0x1c8)](_0x5eb44b=>{const _0x5099e3=_0xbe599a,_0x4a1f60=Math[_0x5099e3(0x13e)](_0x5eb44b[_0x5099e3(0x180)]*0x64)/0x64;if(_0x3f8516&&_0x4a1f60<_0x3f8516)return![];return _0x4a1f60!==0x0;});_0x22eedf[_0xbe599a(0x202)]((_0x18cd26,_0x342710)=>_0x342710['balance']-_0x18cd26['balance']);const _0xb9a8fb=_0x22eedf[_0xbe599a(0x21f)],_0x3763b9=(_0x144ed7-0x1)*_0x37521c,_0x321f64=_0x22eedf[_0xbe599a(0x200)](_0x3763b9,_0x3763b9+_0x37521c);console[_0xbe599a(0x17c)](_0xbe599a(0x151)+_0x321f64[_0xbe599a(0x21f)]+_0xbe599a(0x1e0));const _0x2444b6=await Promise[_0xbe599a(0x1bb)](_0x321f64[_0xbe599a(0x1ff)](async _0x4f7078=>{const _0xa7683c=_0xbe599a,[_0x14e476,_0x162d2e,_0x3cd9c4]=await Promise[_0xa7683c(0x1bb)]([database_1[_0xa7683c(0x24a)]['payment'][_0xa7683c(0x243)]({'where':{'shopId':_0x4f7078['id'],'status':_0xa7683c(0x18f),'gateway':{'not':_0xa7683c(0x13c)}}}),database_1[_0xa7683c(0x24a)]['payment'][_0xa7683c(0x255)]({'where':{'shopId':_0x4f7078['id'],'status':_0xa7683c(0x18f),'gateway':{'not':_0xa7683c(0x13c)}},'orderBy':{'paidAt':_0xa7683c(0x1f0)},'select':{'paidAt':!![]}}),database_1['default'][_0xa7683c(0x163)]['groupBy']({'by':[_0xa7683c(0x149)],'where':{'shopId':_0x4f7078['id'],'status':_0xa7683c(0x18f),'gateway':{'not':'test_gateway'}},'_count':{'id':!![]},'_sum':{'amountUSDT':!![]}})]),_0x46addd=new Date(),_0x27f94a=new Date(_0x46addd['getFullYear'](),_0x46addd[_0xa7683c(0x207)](),0x1),_0x4604da=new Date(_0x46addd[_0xa7683c(0x11b)](),_0x46addd[_0xa7683c(0x207)]()+0x1,0x0,0x17,0x3b,0x3b,0x3e7),[_0x4a349c,_0x2e7d04]=await Promise[_0xa7683c(0x1bb)]([database_1[_0xa7683c(0x24a)][_0xa7683c(0x218)][_0xa7683c(0x193)]({'_sum':{'amount':!![]},'where':{'shopId':_0x4f7078['id'],'status':'COMPLETED'}}),database_1[_0xa7683c(0x24a)][_0xa7683c(0x218)][_0xa7683c(0x193)]({'_sum':{'amount':!![]},'where':{'shopId':_0x4f7078['id'],'status':_0xa7683c(0x1c0),'createdAt':{'gte':_0x27f94a,'lte':_0x4604da}}})]),_0x3f3594=_0x4a349c[_0xa7683c(0x26b)][_0xa7683c(0x1e3)]||0x0,_0x3028e6=_0x2e7d04[_0xa7683c(0x26b)][_0xa7683c(0x1e3)]||0x0,_0x299c6a=await Promise[_0xa7683c(0x1bb)](_0x3cd9c4[_0xa7683c(0x1ff)](async _0x2140c0=>{const _0x58aab2=_0xa7683c;let _0x4bdee5=0x2d;if(_0x4f7078[_0x58aab2(0x1b0)])try{const _0x1e11a6=JSON['parse'](_0x4f7078[_0x58aab2(0x1b0)]);for(const [_0x782e24,_0x5dac4]of Object['entries'](_0x1e11a6)){if(_0x782e24[_0x58aab2(0x160)]()===_0x2140c0[_0x58aab2(0x149)][_0x58aab2(0x160)]()){_0x4bdee5=_0x5dac4[_0x58aab2(0x18d)]||0xa,console[_0x58aab2(0x17c)](_0x58aab2(0x235)+_0x2140c0[_0x58aab2(0x149)]+_0x58aab2(0x1b9)+_0x4f7078['id']+_0x58aab2(0x14c)+_0x4bdee5+'%');break;}}}catch(_0x16db6c){console[_0x58aab2(0x111)](_0x58aab2(0x14d)+_0x4f7078['id']+':',_0x16db6c);}const _0x365729=_0x2140c0['_sum']?.[_0x58aab2(0x164)]||0x0,_0x183946=_0x365729*(0x1-_0x4bdee5/0x64);return{'gateway':_0x2140c0[_0x58aab2(0x149)],'count':_0x2140c0[_0x58aab2(0x260)]?.['id']||0x0,'amountUSDT':Math[_0x58aab2(0x254)](_0x365729*0x64)/0x64,'amountAfterCommissionUSDT':Math[_0x58aab2(0x254)](_0x183946*0x64)/0x64,'commission':_0x4bdee5};})),_0x49890e=_0x299c6a[_0xa7683c(0x1ca)]((_0x2a8ac1,_0x2455da)=>_0x2a8ac1+_0x2455da['amountUSDT'],0x0),_0x1e35b0=_0x299c6a[_0xa7683c(0x1ca)]((_0x4576ae,_0x588456)=>_0x4576ae+_0x588456['amountAfterCommissionUSDT'],0x0),_0x3dd51f=_0x4f7078['balance'];return console[_0xa7683c(0x17c)](_0xa7683c(0x14f)+_0x4f7078[_0xa7683c(0x152)]+':'),console[_0xa7683c(0x17c)](_0xa7683c(0x26c)+_0x49890e[_0xa7683c(0x25b)](0x2)+_0xa7683c(0x179)),console['log'](_0xa7683c(0x1f8)+_0x1e35b0[_0xa7683c(0x25b)](0x2)+_0xa7683c(0x1eb)),console['log']('\x20\x20\x20âœ…\x20Actual\x20available\x20balance:\x20'+_0x3dd51f[_0xa7683c(0x25b)](0x2)+'\x20USDT\x20(current\x20balance\x20in\x20DB)'),console[_0xa7683c(0x17c)](_0xa7683c(0x1d1)+_0x3f3594[_0xa7683c(0x25b)](0x2)+_0xa7683c(0x27a)),console[_0xa7683c(0x17c)]('\x20\x20\x20ðŸ¤”\x20Difference:\x20'+(_0x1e35b0-_0x3f3594-_0x3dd51f)['toFixed'](0x2)+_0xa7683c(0x229)),{'id':_0x4f7078['id'],'fullName':_0x4f7078[_0xa7683c(0x1d7)],'username':_0x4f7078[_0xa7683c(0x152)],'telegramId':_0x4f7078[_0xa7683c(0x134)],'merchantUrl':_0x4f7078['shopUrl'],'wallets':{'usdtPolygonWallet':_0x4f7078['usdtPolygonWallet'],'usdtTrcWallet':_0x4f7078['usdtTrcWallet'],'usdtErcWallet':_0x4f7078[_0xa7683c(0x17f)],'usdcPolygonWallet':_0x4f7078[_0xa7683c(0x1a8)],'usdcErcWallet':_0x4f7078[_0xa7683c(0x1dd)]},'totalAmountUSDT':Math['round'](_0x49890e*0x64)/0x64,'totalAmountAfterCommissionUSDT':Math[_0xa7683c(0x254)](_0x1e35b0*0x64)/0x64,'currentBalance':Math[_0xa7683c(0x13e)](_0x3dd51f*0x64)/0x64,'totalPayout':Math[_0xa7683c(0x254)](_0x3f3594*0x64)/0x64,'thisMonth':Math[_0xa7683c(0x254)](_0x3028e6*0x64)/0x64,'paymentsCount':_0x14e476,'oldestPaymentDate':_0x162d2e?.[_0xa7683c(0x1f6)]||_0x4f7078['createdAt'],'gatewayBreakdown':_0x299c6a};})),_0x234c31=_0x2444b6[_0xbe599a(0x1ca)]((_0x66d1ed,_0x3eac0e)=>_0x66d1ed+_0x3eac0e[_0xbe599a(0x167)],0x0),_0x549a0f=_0x2444b6[_0xbe599a(0x1ca)]((_0x407f90,_0x292b37)=>_0x407f90+_0x292b37[_0xbe599a(0x1fd)],0x0),_0x4e87c2=_0x2444b6[_0xbe599a(0x1ca)]((_0x1e327a,_0x32f952)=>_0x1e327a+_0x32f952['totalPayout'],0x0),_0xb9a016=_0x2444b6['reduce']((_0x23ce4e,_0x155f41)=>_0x23ce4e+_0x155f41[_0xbe599a(0x210)],0x0);return console['log'](_0xbe599a(0x23f)+_0xb9a8fb+_0xbe599a(0x168)),console[_0xbe599a(0x17c)](_0xbe599a(0x223)+Math[_0xbe599a(0x254)](_0x234c31*0x64)/0x64+'\x20USDT\x20(gross\x20revenue)'),console[_0xbe599a(0x17c)](_0xbe599a(0x24b)+Math[_0xbe599a(0x254)](_0x549a0f*0x64)/0x64+_0xbe599a(0x26f)),console[_0xbe599a(0x17c)](_0xbe599a(0x236)+Math[_0xbe599a(0x254)](_0x4e87c2*0x64)/0x64+_0xbe599a(0x24d)),console['log']('\x20\x20\x20ðŸ“…\x20Total\x20payouts\x20(this\x20month):\x20'+Math[_0xbe599a(0x254)](_0xb9a016*0x64)/0x64+_0xbe599a(0x24d)),{'merchants':_0x2444b6,'pagination':{'page':_0x144ed7,'limit':_0x37521c,'total':_0xb9a8fb,'totalPages':Math[_0xbe599a(0x1b2)](_0xb9a8fb/_0x37521c)},'summary':{'totalMerchants':_0xb9a8fb,'totalAmountUSDT':Math[_0xbe599a(0x254)](_0x234c31*0x64)/0x64,'totalAmountAfterCommissionUSDT':Math[_0xbe599a(0x254)](_0x549a0f*0x64)/0x64,'totalPayout':Math[_0xbe599a(0x254)](_0x4e87c2*0x64)/0x64,'thisMonth':Math[_0xbe599a(0x254)](_0xb9a016*0x64)/0x64}};}async[a48_0x23d58a(0x1bf)](_0x23d4dc){const _0x3115e1=a48_0x23d58a,{shopId:_0x25ff34,amount:_0x5ca1c6,network:_0x1c1d71,wallet:_0xb621da,notes:_0xc59c6d,txid:_0x5c4743,periodFrom:_0xdb3101,periodTo:_0x391abd}=_0x23d4dc,_0x4e7f4d=await database_1['default']['$transaction'](async _0x14f82d=>{const _0x4a02b6=a48_0xae52,_0xb58fe5=await _0x14f82d[_0x4a02b6(0x1c3)][_0x4a02b6(0x23d)]({'where':{'id':_0x25ff34},'select':{'id':!![],'name':!![],'username':!![],'balance':!![],'totalPaidOut':!![]}});if(!_0xb58fe5)throw new Error(_0x4a02b6(0x145));console[_0x4a02b6(0x17c)]('ðŸ’°\x20Creating\x20payout\x20for\x20shop\x20'+_0xb58fe5[_0x4a02b6(0x152)]+':'),console[_0x4a02b6(0x17c)]('\x20\x20\x20Current\x20balance:\x20'+_0xb58fe5[_0x4a02b6(0x180)]['toFixed'](0x6)+_0x4a02b6(0x24d)),console[_0x4a02b6(0x17c)](_0x4a02b6(0x16d)+_0x5ca1c6[_0x4a02b6(0x25b)](0x6)+_0x4a02b6(0x24d)),console['log'](_0x4a02b6(0x120)+_0xb58fe5['totalPaidOut'][_0x4a02b6(0x25b)](0x6)+_0x4a02b6(0x24d));if(_0x5c4743)console[_0x4a02b6(0x17c)](_0x4a02b6(0x1da)+_0x5c4743);const _0x59f2e1=0.000001,_0x24e43=Number(_0xb58fe5['balance']),_0x4894be=Number(_0x5ca1c6);console['log'](_0x4a02b6(0x1e7)),console[_0x4a02b6(0x17c)](_0x4a02b6(0x132)+_0xb58fe5[_0x4a02b6(0x180)]),console[_0x4a02b6(0x17c)](_0x4a02b6(0x224)+_0x24e43),console[_0x4a02b6(0x17c)](_0x4a02b6(0x25a)+_0x4894be),console[_0x4a02b6(0x17c)](_0x4a02b6(0x253)+(_0x24e43-_0x4894be)),console[_0x4a02b6(0x17c)](_0x4a02b6(0x211)+_0x59f2e1);if(_0x24e43<_0x4894be-_0x59f2e1)throw new Error(_0x4a02b6(0x1b4)+_0x24e43['toFixed'](0x6)+_0x4a02b6(0x162)+_0x4894be[_0x4a02b6(0x25b)](0x6)+'\x20USDT,\x20Difference:\x20'+(_0x24e43-_0x4894be)[_0x4a02b6(0x25b)](0x8)+_0x4a02b6(0x24d));console[_0x4a02b6(0x17c)](_0x4a02b6(0x267));const _0x1eb88e=Math['min'](_0x24e43,_0x4894be);let _0x8c721d=_0xb621da;console[_0x4a02b6(0x17c)](_0x4a02b6(0x26a)+(_0xb621da||_0x4a02b6(0x265)));if(!_0x8c721d){console['log'](_0x4a02b6(0x172));const _0x3139d4=await _0x14f82d['shop'][_0x4a02b6(0x23d)]({'where':{'id':_0x25ff34},'select':{'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'usdcErcWallet':!![]}});console[_0x4a02b6(0x17c)](_0x4a02b6(0x264),_0x3139d4);if(_0x3139d4)switch(_0x1c1d71){case'polygon':_0x8c721d=_0x3139d4[_0x4a02b6(0x23c)]||undefined,console[_0x4a02b6(0x17c)]('ðŸ”\x20Selected\x20polygon\x20wallet:\x20'+_0x8c721d);break;case _0x4a02b6(0x1a0):_0x8c721d=_0x3139d4['usdtTrcWallet']||undefined,console[_0x4a02b6(0x17c)](_0x4a02b6(0x166)+_0x8c721d);break;case _0x4a02b6(0x16f):_0x8c721d=_0x3139d4[_0x4a02b6(0x17f)]||undefined,console[_0x4a02b6(0x17c)](_0x4a02b6(0x129)+_0x8c721d);break;case _0x4a02b6(0x1bd):_0x8c721d=_0x3139d4['usdcPolygonWallet']||undefined,console[_0x4a02b6(0x17c)]('ðŸ”\x20Selected\x20polygon_usdc\x20wallet:\x20'+_0x8c721d);break;case _0x4a02b6(0x26d):_0x8c721d=_0x3139d4['usdcErcWallet']||undefined,console[_0x4a02b6(0x17c)](_0x4a02b6(0x203)+_0x8c721d);break;}}else console[_0x4a02b6(0x17c)]('âœ…\x20Using\x20wallet\x20from\x20request:\x20'+_0x8c721d);console[_0x4a02b6(0x17c)](_0x4a02b6(0x165)+_0x1c1d71+':\x20'+(_0x8c721d||_0x4a02b6(0x15a))),console['log']('ðŸ”\x20Creating\x20payout\x20with\x20data:',{'shopId':_0x25ff34,'amount':_0x1eb88e,'network':_0x1c1d71,'wallet':_0x8c721d,'status':_0x4a02b6(0x1c0),'txid':_0x5c4743,'notes':_0xc59c6d,'periodFrom':_0xdb3101?new Date(_0xdb3101):null,'periodTo':_0x391abd?new Date(_0x391abd):null});const _0x23319e=await _0x14f82d['payout']['create']({'data':{'shopId':_0x25ff34,'amount':_0x1eb88e,'network':_0x1c1d71,'wallet':_0x8c721d,'status':_0x4a02b6(0x1c0),'txid':_0x5c4743,'notes':_0xc59c6d,'periodFrom':_0xdb3101?new Date(_0xdb3101):null,'periodTo':_0x391abd?new Date(_0x391abd):null,'createdAt':new Date(),'paidAt':new Date()}});console['log'](_0x4a02b6(0x1c2),{'id':_0x23319e['id'],'wallet':_0x23319e[_0x4a02b6(0x174)],'network':_0x23319e['network'],'amount':_0x23319e[_0x4a02b6(0x1e3)]});const _0x221679=_0x24e43-_0x1eb88e,_0x24e286=Number(_0xb58fe5[_0x4a02b6(0x247)])+_0x1eb88e;return await _0x14f82d[_0x4a02b6(0x1c3)][_0x4a02b6(0x27e)]({'where':{'id':_0x25ff34},'data':{'balance':_0x221679,'totalPaidOut':_0x24e286}}),console[_0x4a02b6(0x17c)]('ðŸ’°\x20Shop\x20'+_0xb58fe5[_0x4a02b6(0x152)]+_0x4a02b6(0x191)),console['log'](_0x4a02b6(0x18e)+_0x24e43['toFixed'](0x6)+_0x4a02b6(0x23e)+_0x221679[_0x4a02b6(0x25b)](0x6)+_0x4a02b6(0x215)+_0x1eb88e[_0x4a02b6(0x25b)](0x6)+')'),console[_0x4a02b6(0x17c)]('\x20\x20\x20Total\x20paid\x20out:\x20'+_0xb58fe5[_0x4a02b6(0x247)][_0x4a02b6(0x25b)](0x6)+'\x20->\x20'+_0x24e286[_0x4a02b6(0x25b)](0x6)+'\x20USDT\x20(+'+_0x1eb88e[_0x4a02b6(0x25b)](0x6)+')'),console[_0x4a02b6(0x17c)](_0x4a02b6(0x140)+_0x1eb88e[_0x4a02b6(0x25b)](0x6)+_0x4a02b6(0x24d)),{'payout':_0x23319e,'shop':_0xb58fe5};});console[_0x3115e1(0x17c)](_0x3115e1(0x1de)+_0x4e7f4d[_0x3115e1(0x218)]['id']+'\x20for\x20shop\x20'+_0x4e7f4d['shop'][_0x3115e1(0x152)]+'\x20('+_0x4e7f4d[_0x3115e1(0x218)]['amount']['toFixed'](0x6)+'\x20USDT)');try{let _0x6b05a=_0x3115e1(0x18b);if(_0x4e7f4d[_0x3115e1(0x218)]['periodFrom']&&_0x4e7f4d[_0x3115e1(0x218)][_0x3115e1(0x14e)]){const _0x1ec5f2=new Date(_0x4e7f4d[_0x3115e1(0x218)][_0x3115e1(0x222)])[_0x3115e1(0x1d0)]('ru-RU'),_0x2fcbe6=new Date(_0x4e7f4d[_0x3115e1(0x218)]['periodTo'])[_0x3115e1(0x1d0)](_0x3115e1(0x1ea));_0x6b05a=_0x1ec5f2+_0x3115e1(0x133)+_0x2fcbe6;}await telegramBotService_1[_0x3115e1(0x1b6)][_0x3115e1(0x1f2)](_0x4e7f4d['payout'][_0x3115e1(0x24c)],{'id':_0x4e7f4d[_0x3115e1(0x218)]['id'],'amount':_0x4e7f4d[_0x3115e1(0x218)]['amount'],'network':_0x4e7f4d[_0x3115e1(0x218)][_0x3115e1(0x228)],'wallet':_0x4e7f4d['payout'][_0x3115e1(0x174)],'period':_0x6b05a,'createdAt':_0x4e7f4d[_0x3115e1(0x218)][_0x3115e1(0x1a3)],'txid':_0x4e7f4d[_0x3115e1(0x218)][_0x3115e1(0x194)]}),console[_0x3115e1(0x17c)](_0x3115e1(0x19b)+_0x4e7f4d['payout']['id']);}catch(_0x2fffeb){console['error'](_0x3115e1(0x138)+_0x4e7f4d[_0x3115e1(0x218)]['id']+':',_0x2fffeb);}return{'id':_0x4e7f4d[_0x3115e1(0x218)]['id'],'shopId':_0x4e7f4d[_0x3115e1(0x218)][_0x3115e1(0x24c)],'shopName':_0x4e7f4d[_0x3115e1(0x1c3)][_0x3115e1(0x1d7)],'shopUsername':_0x4e7f4d[_0x3115e1(0x1c3)][_0x3115e1(0x152)],'amount':_0x4e7f4d['payout'][_0x3115e1(0x1e3)],'network':_0x4e7f4d[_0x3115e1(0x218)][_0x3115e1(0x228)],'wallet':_0x4e7f4d[_0x3115e1(0x218)][_0x3115e1(0x174)],'status':_0x4e7f4d[_0x3115e1(0x218)][_0x3115e1(0x18a)],'txid':_0x4e7f4d['payout'][_0x3115e1(0x194)],'notes':_0x4e7f4d[_0x3115e1(0x218)][_0x3115e1(0x12f)],'periodFrom':_0x4e7f4d[_0x3115e1(0x218)]['periodFrom'],'periodTo':_0x4e7f4d[_0x3115e1(0x218)][_0x3115e1(0x14e)],'createdAt':_0x4e7f4d[_0x3115e1(0x218)][_0x3115e1(0x1a3)],'paidAt':_0x4e7f4d[_0x3115e1(0x218)]['paidAt']};}async[a48_0x23d58a(0x128)](_0x356f0d){const _0x51b04e=a48_0x23d58a,{page:_0x446a89,limit:_0x2d924,shopId:_0x50a0e4,network:_0xef8574,dateFrom:_0x2e1e27,dateTo:_0x25d899,search:_0x397b04}=_0x356f0d,_0x4c4d32=(_0x446a89-0x1)*_0x2d924,_0x3efdde={};_0x50a0e4&&(_0x3efdde[_0x51b04e(0x24c)]=_0x50a0e4);_0xef8574&&(_0x3efdde['network']=_0xef8574);if(_0x2e1e27||_0x25d899){_0x3efdde[_0x51b04e(0x1a3)]={};if(_0x2e1e27){const _0x2fa42b=new Date(_0x2e1e27);_0x2fa42b['setHours'](0x0,0x0,0x0,0x1),_0x3efdde['createdAt']['gte']=_0x2fa42b,console[_0x51b04e(0x17c)](_0x51b04e(0x25c)+_0x2fa42b[_0x51b04e(0x16c)]());}if(_0x25d899){const _0x147289=new Date(_0x25d899);_0x147289['setHours'](0x17,0x3b,0x3b,0x3e7),_0x3efdde['createdAt']['lte']=_0x147289,console['log'](_0x51b04e(0x121)+_0x147289[_0x51b04e(0x16c)]());}}_0x397b04&&(_0x3efdde['OR']=[{'shop':{'name':{'contains':_0x397b04,'mode':'insensitive'}}},{'shop':{'username':{'contains':_0x397b04,'mode':_0x51b04e(0x233)}}},{'notes':{'contains':_0x397b04,'mode':_0x51b04e(0x233)}}]);const [_0x27c339,_0x56b2b4]=await Promise[_0x51b04e(0x1bb)]([database_1[_0x51b04e(0x24a)][_0x51b04e(0x218)][_0x51b04e(0x17d)]({'where':_0x3efdde,'skip':_0x4c4d32,'take':_0x2d924,'orderBy':{'createdAt':_0x51b04e(0x1f5)},'select':{'id':!![],'shopId':!![],'amount':!![],'network':!![],'status':!![],'txid':!![],'notes':!![],'periodFrom':!![],'periodTo':!![],'createdAt':!![],'wallet':!![],'paidAt':!![],'shop':{'select':{'name':!![],'username':!![]}}}}),database_1[_0x51b04e(0x24a)]['payout'][_0x51b04e(0x243)]({'where':_0x3efdde})]);return{'payouts':_0x27c339[_0x51b04e(0x1ff)](_0x574d1f=>({'id':_0x574d1f['id'],'shopId':_0x574d1f[_0x51b04e(0x24c)],'shopName':_0x574d1f[_0x51b04e(0x1c3)]['name'],'shopUsername':_0x574d1f[_0x51b04e(0x1c3)][_0x51b04e(0x152)],'amount':_0x574d1f[_0x51b04e(0x1e3)],'network':_0x574d1f[_0x51b04e(0x228)],'wallet':_0x574d1f[_0x51b04e(0x174)],'status':_0x574d1f[_0x51b04e(0x18a)],'txid':_0x574d1f['txid'],'notes':_0x574d1f[_0x51b04e(0x12f)],'periodFrom':_0x574d1f['periodFrom'],'periodTo':_0x574d1f[_0x51b04e(0x14e)],'createdAt':_0x574d1f[_0x51b04e(0x1a3)],'paidAt':_0x574d1f[_0x51b04e(0x1f6)]})),'pagination':{'page':_0x446a89,'limit':_0x2d924,'total':_0x56b2b4,'totalPages':Math[_0x51b04e(0x1b2)](_0x56b2b4/_0x2d924)}};}async['getPayoutById'](_0x2a8c22){const _0x15ca61=a48_0x23d58a,_0x53318b=await database_1[_0x15ca61(0x24a)][_0x15ca61(0x218)][_0x15ca61(0x23d)]({'where':{'id':_0x2a8c22},'include':{'shop':{'select':{'name':!![],'username':!![]}}}});if(!_0x53318b)return null;return{'id':_0x53318b['id'],'shopId':_0x53318b['shopId'],'shopName':_0x53318b[_0x15ca61(0x1c3)]['name'],'shopUsername':_0x53318b[_0x15ca61(0x1c3)]['username'],'amount':_0x53318b[_0x15ca61(0x1e3)],'network':_0x53318b[_0x15ca61(0x228)],'wallet':_0x53318b['wallet'],'status':_0x53318b[_0x15ca61(0x18a)],'txid':_0x53318b[_0x15ca61(0x194)],'notes':_0x53318b[_0x15ca61(0x12f)],'periodFrom':_0x53318b[_0x15ca61(0x222)],'periodTo':_0x53318b[_0x15ca61(0x14e)],'createdAt':_0x53318b[_0x15ca61(0x1a3)],'paidAt':_0x53318b[_0x15ca61(0x1f6)]};}async['deletePayout'](_0x52f705){const _0x262664=a48_0x23d58a;await database_1[_0x262664(0x24a)]['payout'][_0x262664(0x136)]({'where':{'id':_0x52f705}});}async[a48_0x23d58a(0x240)](_0x1ae23e){const _0x3b6b55=a48_0x23d58a,{page:_0x489918,limit:_0x5881de,status:_0x598077,gateway:_0x609771,shopId:_0x135d0c,dateFrom:_0x1af466,dateTo:_0x11f021,search:_0x29aafe,currency:_0xabd373,sortBy:_0x35893d,sortOrder:_0x2d6d5f}=_0x1ae23e,_0x48a11e=(_0x489918-0x1)*_0x5881de;console[_0x3b6b55(0x17c)]('ðŸ“Š\x20Getting\x20payments\x20with\x20filters:',_0x1ae23e);const _0x4218ca=await database_1['default'][_0x3b6b55(0x163)][_0x3b6b55(0x1fa)]({'by':['gateway'],'_count':{'gateway':!![]}});console[_0x3b6b55(0x17c)](_0x3b6b55(0x269),_0x4218ca[_0x3b6b55(0x1ff)](_0x47bbf7=>_0x47bbf7['gateway']+'\x20('+_0x47bbf7[_0x3b6b55(0x260)]['gateway']+'\x20payments)'));if(_0x609771){const _0x4d57ba=_0x4218ca[_0x3b6b55(0x231)](_0x40f44f=>_0x40f44f[_0x3b6b55(0x149)][_0x3b6b55(0x160)]()===_0x609771[_0x3b6b55(0x160)]());!_0x4d57ba&&_0x609771[_0x3b6b55(0x160)]()!==_0x3b6b55(0x13c)&&console[_0x3b6b55(0x17c)](_0x3b6b55(0x124)+_0x609771+_0x3b6b55(0x204)+_0x4218ca[_0x3b6b55(0x1ff)](_0x3f894c=>_0x3f894c[_0x3b6b55(0x149)])['join'](',\x20'));}const _0x2e0aad={};_0x598077&&(_0x2e0aad[_0x3b6b55(0x18a)]=_0x598077[_0x3b6b55(0x1ee)]());if(!_0x609771)_0x2e0aad[_0x3b6b55(0x149)]={'not':_0x3b6b55(0x13c)};else{if(_0x609771&&(_0x609771[_0x3b6b55(0x160)]()===_0x3b6b55(0x13c)||_0x609771==='0000'))_0x2e0aad[_0x3b6b55(0x149)]=_0x3b6b55(0x13c);else{let _0x5b402b=_0x609771;const _0x5ce6f9=(0x0,gateway_1[_0x3b6b55(0x21b)])(_0x609771);if(_0x5ce6f9)_0x5b402b=_0x5ce6f9,console[_0x3b6b55(0x17c)](_0x3b6b55(0x1a9)+_0x609771+_0x3b6b55(0x1fb)+_0x5b402b+'\x27');else{const _0x3165c0=(0x0,gateway_1[_0x3b6b55(0x1ac)])(_0x609771);if(_0x3165c0){const _0x52785a=(0x0,gateway_1['getGatewayNameById'])(_0x3165c0);_0x52785a&&(_0x5b402b=_0x52785a,console[_0x3b6b55(0x17c)]('ðŸ”„\x20Converted\x20gateway\x20name\x20\x27'+_0x609771+_0x3b6b55(0x271)+_0x3165c0+'\x27\x20->\x20name\x20\x27'+_0x5b402b+'\x27'));}else console['log']('ðŸ”\x20Using\x20gateway\x20\x27'+_0x609771+'\x27\x20as\x20is\x20(not\x20found\x20in\x20mappings)');}const _0x2bee8f=await database_1[_0x3b6b55(0x24a)]['payment'][_0x3b6b55(0x243)]({'where':{'gateway':_0x5b402b['toLowerCase']()},'take':0x1});_0x2bee8f===0x0?(console[_0x3b6b55(0x17c)](_0x3b6b55(0x220)+_0x5b402b+_0x3b6b55(0x115)+_0x609771+_0x3b6b55(0x15c)),_0x2e0aad[_0x3b6b55(0x149)]='NONEXISTENT_GATEWAY_FILTER'):(_0x2e0aad[_0x3b6b55(0x149)]=_0x5b402b[_0x3b6b55(0x160)](),console[_0x3b6b55(0x17c)]('âœ…\x20Using\x20gateway\x20filter:\x20\x27'+_0x5b402b+_0x3b6b55(0x115)+_0x609771+'\x27)'));}}console['log']('ðŸ“Š\x20Gateway\x20filter\x20applied:',_0x2e0aad[_0x3b6b55(0x149)]);_0x135d0c&&(_0x2e0aad[_0x3b6b55(0x24c)]=_0x135d0c);_0xabd373&&(_0x2e0aad[_0x3b6b55(0x170)]=_0xabd373[_0x3b6b55(0x1ee)](),console[_0x3b6b55(0x17c)](_0x3b6b55(0x14a)+_0xabd373[_0x3b6b55(0x1ee)]()));if(_0x1af466||_0x11f021){_0x2e0aad[_0x3b6b55(0x1a3)]={};if(_0x1af466){const _0x1f8e60=new Date(_0x1af466),_0x2f02a9=new Date(Date[_0x3b6b55(0x185)](_0x1f8e60[_0x3b6b55(0x15b)](),_0x1f8e60[_0x3b6b55(0x16e)](),_0x1f8e60[_0x3b6b55(0x22e)](),0x0,0x0,0x0,0x0));_0x2e0aad[_0x3b6b55(0x1a3)][_0x3b6b55(0x22f)]=_0x2f02a9,console[_0x3b6b55(0x17c)](_0x3b6b55(0x250)+_0x2f02a9['toISOString']());}if(_0x11f021){const _0x1eaee3=new Date(_0x11f021),_0x5af043=new Date(Date[_0x3b6b55(0x185)](_0x1eaee3[_0x3b6b55(0x15b)](),_0x1eaee3[_0x3b6b55(0x16e)](),_0x1eaee3['getUTCDate'](),0x17,0x3b,0x3b,0x3e7));_0x2e0aad[_0x3b6b55(0x1a3)][_0x3b6b55(0x143)]=_0x5af043,console[_0x3b6b55(0x17c)]('ðŸ“…\x20Date\x20to\x20filter:\x20'+_0x5af043['toISOString']());}}_0x29aafe&&(_0x2e0aad['OR']=[{'id':{'contains':_0x29aafe,'mode':_0x3b6b55(0x233)}},{'orderId':{'contains':_0x29aafe,'mode':_0x3b6b55(0x233)}},{'gatewayOrderId':{'contains':_0x29aafe,'mode':_0x3b6b55(0x233)}},{'customerEmail':{'contains':_0x29aafe,'mode':_0x3b6b55(0x233)}},{'shop':{'name':{'contains':_0x29aafe,'mode':'insensitive'}}},{'shop':{'username':{'contains':_0x29aafe,'mode':_0x3b6b55(0x233)}}}]);console[_0x3b6b55(0x17c)]('ðŸ“Š\x20Final\x20WHERE\x20conditions:',JSON[_0x3b6b55(0x187)](_0x2e0aad,null,0x2));const _0x6dbfcb=await database_1[_0x3b6b55(0x24a)][_0x3b6b55(0x163)]['count']({'where':_0x2e0aad});console['log'](_0x3b6b55(0x14b)+_0x6dbfcb);let _0x2cfc82={'createdAt':_0x3b6b55(0x1f5)};if(_0x35893d){const _0xefce1f=['amount','createdAt','updatedAt',_0x3b6b55(0x18a),_0x3b6b55(0x149),_0x3b6b55(0x170)],_0x5508be=[_0x3b6b55(0x1f0),_0x3b6b55(0x1f5)];if(_0xefce1f[_0x3b6b55(0x230)](_0x35893d)){const _0x4ea7cc=_0x5508be['includes'](_0x2d6d5f)?_0x2d6d5f:_0x3b6b55(0x1f5);_0x2cfc82={[_0x35893d]:_0x4ea7cc},console[_0x3b6b55(0x17c)](_0x3b6b55(0x11f)+_0x35893d+_0x3b6b55(0x23b)+_0x4ea7cc+_0x3b6b55(0x1ab));}}const [_0x1ce967,_0x5bccca]=await Promise['all']([database_1[_0x3b6b55(0x24a)][_0x3b6b55(0x163)][_0x3b6b55(0x17d)]({'where':_0x2e0aad,'skip':_0x48a11e,'take':_0x5881de,'orderBy':_0x2cfc82,'include':{'shop':{'select':{'name':!![],'username':!![]}}}}),database_1[_0x3b6b55(0x24a)][_0x3b6b55(0x163)][_0x3b6b55(0x243)]({'where':_0x2e0aad})]);let _0x2fc6bb,_0x1eef7d;if(_0x1af466){const _0x5aa46e=new Date(_0x1af466);_0x2fc6bb=new Date(Date['UTC'](_0x5aa46e['getUTCFullYear'](),_0x5aa46e[_0x3b6b55(0x16e)](),_0x5aa46e[_0x3b6b55(0x22e)](),0x0,0x0,0x0,0x0));}else{const _0x25746d=new Date();_0x2fc6bb=new Date(Date[_0x3b6b55(0x185)](_0x25746d[_0x3b6b55(0x15b)](),_0x25746d['getUTCMonth'](),_0x25746d[_0x3b6b55(0x22e)](),0x0,0x0,0x0,0x0));}if(_0x11f021){const _0x940eb0=new Date(_0x11f021);_0x1eef7d=new Date(Date[_0x3b6b55(0x185)](_0x940eb0['getUTCFullYear'](),_0x940eb0[_0x3b6b55(0x16e)](),_0x940eb0['getUTCDate'](),0x17,0x3b,0x3b,0x3e7));}else{if(_0x1af466){const _0x1acc16=new Date(_0x1af466);_0x1eef7d=new Date(Date[_0x3b6b55(0x185)](_0x1acc16['getUTCFullYear'](),_0x1acc16[_0x3b6b55(0x16e)](),_0x1acc16[_0x3b6b55(0x22e)](),0x17,0x3b,0x3b,0x3e7));}else{const _0x1ecfb6=new Date();_0x1eef7d=new Date(Date[_0x3b6b55(0x185)](_0x1ecfb6[_0x3b6b55(0x15b)](),_0x1ecfb6[_0x3b6b55(0x16e)](),_0x1ecfb6[_0x3b6b55(0x22e)](),0x17,0x3b,0x3b,0x3e7));}}const _0x2857be={'status':_0x3b6b55(0x18f),'createdAt':{'gte':_0x2fc6bb,'lte':_0x1eef7d}};_0x609771?_0x2857be['gateway']=_0x2e0aad[_0x3b6b55(0x149)]:_0x2857be[_0x3b6b55(0x149)]={'not':_0x3b6b55(0x13c)};_0x135d0c&&(_0x2857be['shopId']=_0x135d0c);const _0x3996ec=await database_1[_0x3b6b55(0x24a)]['payment'][_0x3b6b55(0x17d)]({'where':_0x2857be,'select':{'amountUSDT':!![],'currency':!![],'amount':!![]}}),_0x331a39={};let _0x2d6662=0x0;return _0x3996ec[_0x3b6b55(0x146)](_0x1b03bb=>{const _0x58e7a8=_0x3b6b55;_0x1b03bb[_0x58e7a8(0x164)]&&(_0x2d6662+=_0x1b03bb['amountUSDT']);if(_0x1b03bb['currency']){const _0x260e48=_0x1b03bb[_0x58e7a8(0x170)]['toUpperCase']();!_0x331a39[_0x260e48]&&(_0x331a39[_0x260e48]=0x0),_0x331a39[_0x260e48]+=_0x1b03bb['amount'];}}),_0x2d6662>0x0&&(_0x331a39['USDT']=_0x2d6662),{'payments':_0x1ce967,'pagination':{'page':_0x489918,'limit':_0x5881de,'total':_0x5bccca,'totalPages':Math[_0x3b6b55(0x1b2)](_0x5bccca/_0x5881de)},'statistics':_0x331a39};}async[a48_0x23d58a(0x272)](_0x466709){const _0x67de5c=a48_0x23d58a,_0xbc4ecd=await database_1[_0x67de5c(0x24a)]['payment'][_0x67de5c(0x23d)]({'where':{'id':_0x466709},'select':{'id':!![],'shopId':!![],'amount':!![],'amountAfterGatewayCommissionUSDT':!![],'currency':!![],'sourceCurrency':!![],'status':!![],'gateway':!![],'orderId':!![],'gatewayOrderId':!![],'gatewayPaymentId':!![],'customerEmail':!![],'customerName':!![],'customerCountry':!![],'customerIp':!![],'customerUa':!![],'externalPaymentUrl':!![],'successUrl':!![],'failUrl':!![],'pendingUrl':!![],'whiteUrl':!![],'expiresAt':!![],'invoiceTotalSum':!![],'qrCode':!![],'qrUrl':!![],'country':!![],'language':!![],'amountIsEditable':!![],'maxPayments':!![],'rapydCustomer':!![],'cardLast4':!![],'paymentMethod':!![],'bankId':!![],'remitterIban':!![],'remitterName':!![],'failureMessage':!![],'usage':!![],'createdAt':!![],'updatedAt':!![],'shop':{'select':{'name':!![],'username':!![]}}}});if(!_0xbc4ecd)return null;return{'id':_0xbc4ecd['id'],'shopId':_0xbc4ecd[_0x67de5c(0x24c)],'gateway':_0xbc4ecd[_0x67de5c(0x149)],'amount':_0xbc4ecd[_0x67de5c(0x1e3)],'currency':_0xbc4ecd['currency'],'status':_0xbc4ecd['status'],'orderId':_0xbc4ecd['orderId'],'gatewayOrderId':_0xbc4ecd[_0x67de5c(0x274)],'customerEmail':_0xbc4ecd[_0x67de5c(0x206)],'customerName':_0xbc4ecd['customerName'],'customerCountry':_0xbc4ecd[_0x67de5c(0x249)],'customerIp':_0xbc4ecd['customerIp'],'customerUa':_0xbc4ecd[_0x67de5c(0x282)],'failureMessage':_0xbc4ecd[_0x67de5c(0x25f)],'externalPaymentUrl':_0xbc4ecd['externalPaymentUrl'],'successUrl':_0xbc4ecd['successUrl'],'failUrl':_0xbc4ecd[_0x67de5c(0x19c)],'pendingUrl':_0xbc4ecd['pendingUrl'],'whiteUrl':_0xbc4ecd['whiteUrl'],'createdAt':_0xbc4ecd[_0x67de5c(0x1a3)],'updatedAt':_0xbc4ecd[_0x67de5c(0x11a)],'shop':_0xbc4ecd['shop']};}async[a48_0x23d58a(0x201)](_0x251f1a,_0x27fb97,_0x16d170,_0x3a7d7a){const _0x592bec=a48_0x23d58a,_0x39bfe0=await database_1[_0x592bec(0x24a)][_0x592bec(0x1d5)](async _0x3802fd=>{const _0x3e7902=_0x592bec,_0x5b10a9=await _0x3802fd[_0x3e7902(0x163)][_0x3e7902(0x23d)]({'where':{'id':_0x251f1a},'include':{'shop':{'select':{'id':!![],'name':!![],'username':!![],'balance':!![]}}}});if(!_0x5b10a9)throw new Error('Payment\x20not\x20found');const _0x3e841e=_0x5b10a9[_0x3e7902(0x18a)],_0x2e46dc=_0x27fb97[_0x3e7902(0x1ee)]();console[_0x3e7902(0x17c)](_0x3e7902(0x123)+_0x251f1a+_0x3e7902(0x135)+_0x3e841e+'\x20->\x20'+_0x2e46dc),console[_0x3e7902(0x17c)](_0x3e7902(0x197)+_0x5b10a9[_0x3e7902(0x1c3)][_0x3e7902(0x180)]+'\x20USDT');const _0x6371a3={'status':_0x2e46dc,'updatedAt':new Date(),'statusChangedBy':_0x3e7902(0x209),'statusChangedAt':new Date()};_0x16d170&&(_0x6371a3['adminNotes']=_0x16d170);_0x2e46dc===_0x3e7902(0x192)&&_0x3a7d7a&&(_0x6371a3[_0x3e7902(0x27d)]=_0x3a7d7a);let _0xf1cccd=0x0,_0x55a4f2=_0x5b10a9['shop'][_0x3e7902(0x180)];if(_0x2e46dc===_0x3e7902(0x18f)&&_0x3e841e!==_0x3e7902(0x18f)){_0x6371a3[_0x3e7902(0x1f6)]=new Date();const _0x36c223=await currencyService_1[_0x3e7902(0x137)]['convertToUSDT'](_0x5b10a9[_0x3e7902(0x1e3)],_0x5b10a9['currency']);_0x6371a3[_0x3e7902(0x164)]=_0x36c223;let _0x3ed570=0x2d;const _0x5e1cb2=await _0x3802fd[_0x3e7902(0x1c3)][_0x3e7902(0x23d)]({'where':{'id':_0x5b10a9[_0x3e7902(0x24c)]},'select':{'gatewaySettings':!![]}});if(_0x5e1cb2?.[_0x3e7902(0x1b0)])try{const _0x283dc0=JSON['parse'](_0x5e1cb2[_0x3e7902(0x1b0)]);for(const [_0x3d265a,_0x231782]of Object[_0x3e7902(0x1f3)](_0x283dc0)){if(_0x3d265a[_0x3e7902(0x160)]()===_0x5b10a9['gateway'][_0x3e7902(0x160)]()){_0x3ed570=_0x231782[_0x3e7902(0x18d)]||0xa;break;}}}catch(_0x5ad15c){console['error'](_0x3e7902(0x24f)+_0x251f1a+':',_0x5ad15c);}let _0x52150f;_0x5b10a9[_0x3e7902(0x11c)]!==null&&_0x5b10a9[_0x3e7902(0x11c)]!==undefined?(_0x52150f=_0x5b10a9[_0x3e7902(0x11c)],console[_0x3e7902(0x17c)]('ðŸ“Š\x20[ADMIN]\x20Using\x20saved\x20amountAfterGatewayCommissionUSDT:\x20'+_0x52150f[_0x3e7902(0x25b)](0x6)+_0x3e7902(0x17a)+_0x251f1a)):(_0x52150f=_0x36c223*(0x1-_0x3ed570/0x64),console['log'](_0x3e7902(0x13f)+_0x251f1a+':\x20'+_0x3ed570+_0x3e7902(0x131)+_0x36c223[_0x3e7902(0x25b)](0x6)+'\x20USDT'),_0x6371a3[_0x3e7902(0x11c)]=_0x52150f,_0x6371a3['gatewayCommissionRate']=_0x3ed570),_0xf1cccd=_0x52150f,_0x55a4f2+=_0x52150f,console[_0x3e7902(0x17c)](_0x3e7902(0x1a6)+_0x251f1a+_0x3e7902(0x205)),console[_0x3e7902(0x17c)]('\x20\x20\x20Full\x20amount:\x20'+_0x36c223[_0x3e7902(0x25b)](0x6)+_0x3e7902(0x24d)),console[_0x3e7902(0x17c)]('\x20\x20\x20Gateway:\x20'+_0x5b10a9[_0x3e7902(0x149)]+',\x20Commission:\x20'+_0x3ed570+'%'),console[_0x3e7902(0x17c)](_0x3e7902(0x127)+_0x52150f[_0x3e7902(0x25b)](0x6)+_0x3e7902(0x112)+_0x3ed570+_0x3e7902(0x22a)),console[_0x3e7902(0x17c)](_0x3e7902(0x252)+_0x52150f['toFixed'](0x6)+'\x20USDT');}else{if(_0x3e841e===_0x3e7902(0x18f)&&_0x2e46dc!==_0x3e7902(0x18f)&&_0x2e46dc!==_0x3e7902(0x192)){if(_0x5b10a9[_0x3e7902(0x164)]){let _0x4997a8=0x2d;const _0x47c82e=await _0x3802fd[_0x3e7902(0x1c3)]['findUnique']({'where':{'id':_0x5b10a9[_0x3e7902(0x24c)]},'select':{'gatewaySettings':!![]}});if(_0x47c82e?.[_0x3e7902(0x1b0)])try{const _0x3f9ce4=JSON[_0x3e7902(0x116)](_0x47c82e[_0x3e7902(0x1b0)]);for(const [_0x28ccdb,_0x519901]of Object[_0x3e7902(0x1f3)](_0x3f9ce4)){if(_0x28ccdb[_0x3e7902(0x160)]()===_0x5b10a9['gateway']['toLowerCase']()){_0x4997a8=_0x519901['commission']||0xa;break;}}}catch(_0x35a254){console[_0x3e7902(0x111)](_0x3e7902(0x24f)+_0x251f1a+':',_0x35a254);}const _0x2f7753=_0x5b10a9[_0x3e7902(0x164)]*(0x1-_0x4997a8/0x64);_0xf1cccd=-_0x2f7753,_0x55a4f2-=_0x2f7753,console[_0x3e7902(0x17c)](_0x3e7902(0x198)+_0x5b10a9[_0x3e7902(0x164)][_0x3e7902(0x25b)](0x6)+_0x3e7902(0x24d)),console['log'](_0x3e7902(0x122)+_0x5b10a9[_0x3e7902(0x149)]+',\x20Commission:\x20'+_0x4997a8+'%'),console[_0x3e7902(0x17c)]('\x20\x20\x20Merchant\x20loses:\x20'+_0x2f7753[_0x3e7902(0x25b)](0x6)+_0x3e7902(0x112)+_0x4997a8+_0x3e7902(0x22a)),console['log'](_0x3e7902(0x119)+_0x2f7753[_0x3e7902(0x25b)](0x6)+'\x20USDT');}}}_0x2e46dc==='CHARGEBACK'&&(console[_0x3e7902(0x17c)](_0x3e7902(0x1a7)),_0x3a7d7a&&_0x3a7d7a>0x0?(_0xf1cccd=-_0x3a7d7a,_0x55a4f2-=_0x3a7d7a,console['log']('ðŸ’¸\x20CHARGEBACK\x20penalty\x20ONLY:\x20-'+_0x3a7d7a[_0x3e7902(0x25b)](0x6)+_0x3e7902(0x270)),console[_0x3e7902(0x17c)]('ðŸ’°\x20Payment\x20amount\x20is\x20NOT\x20deducted\x20(chargeback\x20penalty\x20only)')):console[_0x3e7902(0x17c)](_0x3e7902(0x20f)),_0x6371a3[_0x3e7902(0x27d)]=_0x3a7d7a||0x0);_0x2e46dc===_0x3e7902(0x1b3)&&_0x3e841e===_0x3e7902(0x18f)&&console['log'](_0x3e7902(0x1cf));const _0x66ae0=await _0x3802fd[_0x3e7902(0x163)][_0x3e7902(0x27e)]({'where':{'id':_0x251f1a},'data':_0x6371a3,'include':{'shop':{'select':{'name':!![],'username':!![]}}}});return _0xf1cccd!==0x0&&(await _0x3802fd['shop'][_0x3e7902(0x27e)]({'where':{'id':_0x5b10a9[_0x3e7902(0x24c)]},'data':{'balance':_0x55a4f2}}),console['log'](_0x3e7902(0x15d)+_0x5b10a9['shopId']+_0x3e7902(0x17e)+_0x5b10a9[_0x3e7902(0x1c3)]['balance'][_0x3e7902(0x25b)](0x6)+_0x3e7902(0x23e)+_0x55a4f2[_0x3e7902(0x25b)](0x6)+_0x3e7902(0x15f)+(_0xf1cccd>0x0?'+':'')+_0xf1cccd[_0x3e7902(0x25b)](0x6)+')')),_0x66ae0;});return{'id':_0x39bfe0['id'],'shopId':_0x39bfe0[_0x592bec(0x24c)],'gateway':_0x39bfe0[_0x592bec(0x149)],'amount':_0x39bfe0[_0x592bec(0x1e3)],'currency':_0x39bfe0[_0x592bec(0x170)],'status':_0x39bfe0[_0x592bec(0x18a)],'orderId':_0x39bfe0[_0x592bec(0x1c6)],'gatewayOrderId':_0x39bfe0[_0x592bec(0x274)],'customerEmail':_0x39bfe0[_0x592bec(0x206)],'customerName':_0x39bfe0[_0x592bec(0x256)],'customerCountry':_0x39bfe0[_0x592bec(0x249)],'customerIp':_0x39bfe0[_0x592bec(0x232)],'customerUa':_0x39bfe0[_0x592bec(0x282)],'failureMessage':_0x39bfe0[_0x592bec(0x25f)],'adminNotes':_0x39bfe0['adminNotes'],'chargebackAmount':_0x39bfe0[_0x592bec(0x27d)],'statusChangedBy':_0x39bfe0[_0x592bec(0x153)],'statusChangedAt':_0x39bfe0[_0x592bec(0x18c)],'createdAt':_0x39bfe0['createdAt'],'updatedAt':_0x39bfe0['updatedAt'],'shop':_0x39bfe0['shop']};}async['updateUser'](_0x29ac28,_0x52ee73){const _0x46f122=a48_0x23d58a,_0x56295b=Math[_0x46f122(0x1c5)]()[_0x46f122(0x20a)](0x24)[_0x46f122(0x1a4)](0x2,0x9);console[_0x46f122(0x17c)](_0x46f122(0x262)+_0x56295b+_0x46f122(0x1df)+_0x29ac28);const _0x5d8685={..._0x52ee73};_0x52ee73[_0x46f122(0x276)]&&_0x52ee73[_0x46f122(0x276)][_0x46f122(0x181)]()!==''?(console[_0x46f122(0x17c)](_0x46f122(0x1a1)+_0x56295b+_0x46f122(0x20b)+_0x29ac28),_0x5d8685[_0x46f122(0x276)]=await bcryptjs_1[_0x46f122(0x24a)][_0x46f122(0x283)](_0x52ee73['password'],0xc)):(console[_0x46f122(0x17c)]('ðŸ”\x20['+_0x56295b+_0x46f122(0x16a)),delete _0x5d8685['password']);_0x52ee73[_0x46f122(0x12c)]&&(_0x5d8685[_0x46f122(0x1d7)]=_0x52ee73[_0x46f122(0x12c)],delete _0x5d8685['fullName']);_0x52ee73[_0x46f122(0x190)]&&(_0x5d8685[_0x46f122(0x134)]=_0x52ee73[_0x46f122(0x190)],delete _0x5d8685[_0x46f122(0x190)]);_0x52ee73[_0x46f122(0x216)]&&(_0x5d8685[_0x46f122(0x226)]=_0x52ee73['merchantUrl'],delete _0x5d8685['merchantUrl']);if(_0x52ee73[_0x46f122(0x1cd)]){const _0x16bcb0=_0x52ee73['gateways'][_0x46f122(0x1ff)](_0x4e8aff=>this[_0x46f122(0x208)](_0x4e8aff));console[_0x46f122(0x17c)](_0x46f122(0x21d),_0x52ee73['gateways'],'->',_0x16bcb0),_0x5d8685[_0x46f122(0x155)]=JSON[_0x46f122(0x187)](_0x16bcb0),delete _0x5d8685[_0x46f122(0x1cd)];}_0x52ee73[_0x46f122(0x1b0)]&&(console['log'](_0x46f122(0x139)+_0x56295b+']\x20Gateway\x20settings\x20before\x20saving:',_0x52ee73[_0x46f122(0x1b0)]),_0x5d8685[_0x46f122(0x1b0)]=JSON[_0x46f122(0x187)](_0x52ee73[_0x46f122(0x1b0)]),console['log'](_0x46f122(0x139)+_0x56295b+_0x46f122(0x219),_0x5d8685['gatewaySettings']));_0x52ee73[_0x46f122(0x1cb)]&&(_0x52ee73['wallets'][_0x46f122(0x23c)]!==undefined&&(_0x5d8685[_0x46f122(0x23c)]=_0x52ee73[_0x46f122(0x1cb)][_0x46f122(0x23c)]||null),_0x52ee73['wallets']['usdtTrcWallet']!==undefined&&(_0x5d8685['usdtTrcWallet']=_0x52ee73[_0x46f122(0x1cb)][_0x46f122(0x1ed)]||null),_0x52ee73[_0x46f122(0x1cb)][_0x46f122(0x17f)]!==undefined&&(_0x5d8685[_0x46f122(0x17f)]=_0x52ee73['wallets']['usdtErcWallet']||null),_0x52ee73[_0x46f122(0x1cb)][_0x46f122(0x1a8)]!==undefined&&(_0x5d8685[_0x46f122(0x1a8)]=_0x52ee73[_0x46f122(0x1cb)][_0x46f122(0x1a8)]||null),delete _0x5d8685[_0x46f122(0x1cb)]);const _0x14d327=await database_1[_0x46f122(0x24a)][_0x46f122(0x1c3)][_0x46f122(0x27e)]({'where':{'id':_0x29ac28},'data':_0x5d8685,'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});return console['log'](_0x46f122(0x13a)+_0x56295b+_0x46f122(0x1bc),_0x14d327[_0x46f122(0x1b0)]),{'id':_0x14d327['id'],'fullName':_0x14d327[_0x46f122(0x1d7)],'username':_0x14d327[_0x46f122(0x152)],'telegramId':_0x14d327[_0x46f122(0x134)],'merchantUrl':_0x14d327['shopUrl'],'gateways':_0x14d327[_0x46f122(0x155)]?JSON[_0x46f122(0x116)](_0x14d327['paymentGateways']):null,'gatewaySettings':_0x14d327[_0x46f122(0x1b0)]?JSON[_0x46f122(0x116)](_0x14d327[_0x46f122(0x1b0)]):null,'publicKey':_0x14d327[_0x46f122(0x257)],'wallets':{'usdtPolygonWallet':_0x14d327['usdtPolygonWallet'],'usdtTrcWallet':_0x14d327['usdtTrcWallet'],'usdtErcWallet':_0x14d327['usdtErcWallet'],'usdcPolygonWallet':_0x14d327[_0x46f122(0x1a8)]},'status':_0x14d327[_0x46f122(0x18a)],'createdAt':_0x14d327[_0x46f122(0x1a3)]};}async[a48_0x23d58a(0x1db)](_0x89f3c4){const _0x3da054=a48_0x23d58a,_0x49553c=await database_1['default']['shop'][_0x3da054(0x27e)]({'where':{'id':_0x89f3c4},'data':{'status':_0x3da054(0x1d3)},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});return{'id':_0x49553c['id'],'fullName':_0x49553c[_0x3da054(0x1d7)],'username':_0x49553c['username'],'telegramId':_0x49553c['telegram'],'merchantUrl':_0x49553c[_0x3da054(0x226)],'gateways':_0x49553c['paymentGateways']?JSON[_0x3da054(0x116)](_0x49553c[_0x3da054(0x155)]):null,'gatewaySettings':_0x49553c['gatewaySettings']?JSON[_0x3da054(0x116)](_0x49553c[_0x3da054(0x1b0)]):null,'publicKey':_0x49553c[_0x3da054(0x257)],'wallets':{'usdtPolygonWallet':_0x49553c[_0x3da054(0x23c)],'usdtTrcWallet':_0x49553c[_0x3da054(0x1ed)],'usdtErcWallet':_0x49553c[_0x3da054(0x17f)],'usdcPolygonWallet':_0x49553c['usdcPolygonWallet']},'status':_0x49553c['status'],'createdAt':_0x49553c['createdAt']};}async[a48_0x23d58a(0x248)](_0x1006b0){const _0x225c56=a48_0x23d58a,_0x135e90=await database_1[_0x225c56(0x24a)][_0x225c56(0x1c3)][_0x225c56(0x27e)]({'where':{'id':_0x1006b0},'data':{'status':_0x225c56(0x239)},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});return{'id':_0x135e90['id'],'fullName':_0x135e90[_0x225c56(0x1d7)],'username':_0x135e90['username'],'telegramId':_0x135e90['telegram'],'merchantUrl':_0x135e90[_0x225c56(0x226)],'gateways':_0x135e90[_0x225c56(0x155)]?JSON['parse'](_0x135e90[_0x225c56(0x155)]):null,'gatewaySettings':_0x135e90['gatewaySettings']?JSON[_0x225c56(0x116)](_0x135e90[_0x225c56(0x1b0)]):null,'publicKey':_0x135e90['publicKey'],'wallets':{'usdtPolygonWallet':_0x135e90[_0x225c56(0x23c)],'usdtTrcWallet':_0x135e90[_0x225c56(0x1ed)],'usdtErcWallet':_0x135e90[_0x225c56(0x17f)],'usdcPolygonWallet':_0x135e90[_0x225c56(0x1a8)]},'status':_0x135e90[_0x225c56(0x18a)],'createdAt':_0x135e90[_0x225c56(0x1a3)]};}async[a48_0x23d58a(0x19a)](_0x3269f5){const _0x5e3972=a48_0x23d58a,{page:_0x213641,limit:_0x17f7f9,status:_0x404df7}=_0x3269f5,_0x45905a=(_0x213641-0x1)*_0x17f7f9,_0xc6ac1f={};_0x404df7&&(_0xc6ac1f['status']=_0x404df7[_0x5e3972(0x1ee)]());const [_0xb35b03,_0x226b35]=await Promise[_0x5e3972(0x1bb)]([database_1[_0x5e3972(0x24a)][_0x5e3972(0x1c3)][_0x5e3972(0x17d)]({'where':_0xc6ac1f,'skip':_0x45905a,'take':_0x17f7f9,'orderBy':{'createdAt':_0x5e3972(0x1f5)},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'usdcErcWallet':!![],'status':!![],'createdAt':!![]}}),database_1['default']['shop']['count']({'where':_0xc6ac1f})]);return{'users':_0xb35b03[_0x5e3972(0x1ff)](_0x39ab8=>{const _0x555c30=_0x5e3972,_0x32457b=_0x39ab8['paymentGateways']?JSON[_0x555c30(0x116)](_0x39ab8[_0x555c30(0x155)]):null,_0x5d2b86=_0x32457b?_0x32457b['map'](_0x57b595=>this[_0x555c30(0x281)](_0x57b595)):null;return{'id':_0x39ab8['id'],'fullName':_0x39ab8[_0x555c30(0x1d7)],'username':_0x39ab8[_0x555c30(0x152)],'telegramId':_0x39ab8['telegram'],'merchantUrl':_0x39ab8[_0x555c30(0x226)],'gateways':_0x5d2b86,'gatewaySettings':_0x39ab8[_0x555c30(0x1b0)]?JSON[_0x555c30(0x116)](_0x39ab8[_0x555c30(0x1b0)]):null,'publicKey':_0x39ab8[_0x555c30(0x257)],'wallets':{'usdtPolygonWallet':_0x39ab8['usdtPolygonWallet'],'usdtTrcWallet':_0x39ab8[_0x555c30(0x1ed)],'usdtErcWallet':_0x39ab8[_0x555c30(0x17f)],'usdcPolygonWallet':_0x39ab8[_0x555c30(0x1a8)],'usdcErcWallet':_0x39ab8[_0x555c30(0x1dd)]},'status':_0x39ab8[_0x555c30(0x18a)],'createdAt':_0x39ab8[_0x555c30(0x1a3)]};}),'pagination':{'page':_0x213641,'limit':_0x17f7f9,'total':_0x226b35,'totalPages':Math[_0x5e3972(0x1b2)](_0x226b35/_0x17f7f9)}};}async[a48_0x23d58a(0x261)](_0x468869){const _0xb42d4d=a48_0x23d58a,_0x1034f8=await database_1[_0xb42d4d(0x24a)][_0xb42d4d(0x1c3)][_0xb42d4d(0x23d)]({'where':{'id':_0x468869},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'usdcErcWallet':!![],'status':!![],'createdAt':!![]}});if(!_0x1034f8)return null;const _0x22ec56=_0x1034f8[_0xb42d4d(0x155)]?JSON[_0xb42d4d(0x116)](_0x1034f8['paymentGateways']):null,_0x519586=_0x22ec56?_0x22ec56[_0xb42d4d(0x1ff)](_0x794917=>this[_0xb42d4d(0x281)](_0x794917)):null;return _0x22ec56&&_0x519586&&console[_0xb42d4d(0x17c)]('ðŸ”„\x20Gateway\x20mapping\x20(get):',_0x22ec56,'->',_0x519586),{'id':_0x1034f8['id'],'fullName':_0x1034f8[_0xb42d4d(0x1d7)],'username':_0x1034f8['username'],'telegramId':_0x1034f8[_0xb42d4d(0x134)],'merchantUrl':_0x1034f8['shopUrl'],'gateways':_0x519586,'gatewaySettings':_0x1034f8[_0xb42d4d(0x1b0)]?JSON[_0xb42d4d(0x116)](_0x1034f8['gatewaySettings']):null,'publicKey':_0x1034f8[_0xb42d4d(0x257)],'wallets':{'usdtPolygonWallet':_0x1034f8['usdtPolygonWallet'],'usdtTrcWallet':_0x1034f8[_0xb42d4d(0x1ed)],'usdtErcWallet':_0x1034f8[_0xb42d4d(0x17f)],'usdcPolygonWallet':_0x1034f8[_0xb42d4d(0x1a8)],'usdcErcWallet':_0x1034f8[_0xb42d4d(0x1dd)]},'status':_0x1034f8[_0xb42d4d(0x18a)],'createdAt':_0x1034f8[_0xb42d4d(0x1a3)]};}async[a48_0x23d58a(0x266)](_0x1390f7){const _0x5aab0b=a48_0x23d58a,{fullName:_0xb27f06,username:_0x1a471a,password:_0x725bdd,telegramId:_0x59bdf8,merchantUrl:_0x5523eb,gateways:_0x54ffd1,gatewaySettings:_0x145f0c,wallets:_0x5e79e7}=_0x1390f7,_0x58c045=await database_1[_0x5aab0b(0x24a)][_0x5aab0b(0x1c3)]['findUnique']({'where':{'username':_0x1a471a}});if(_0x58c045)throw new Error(_0x5aab0b(0x1dc));if(_0x59bdf8){const _0x22b2bf=await database_1['default'][_0x5aab0b(0x1c3)][_0x5aab0b(0x23d)]({'where':{'telegram':_0x59bdf8}});if(_0x22b2bf)throw new Error(_0x5aab0b(0x110));}const _0x4a14f1=await bcryptjs_1[_0x5aab0b(0x24a)][_0x5aab0b(0x283)](_0x725bdd,0xc),_0x2f5ad3=_0x5aab0b(0x1e1)+crypto_1['default'][_0x5aab0b(0x118)](0x20)[_0x5aab0b(0x20a)]('hex'),_0x3a070a='sk_'+crypto_1['default'][_0x5aab0b(0x118)](0x20)[_0x5aab0b(0x20a)](_0x5aab0b(0x157)),_0x4976c1=_0x54ffd1?_0x54ffd1[_0x5aab0b(0x1ff)](_0x1012f4=>this[_0x5aab0b(0x208)](_0x1012f4)):null;_0x54ffd1&&_0x4976c1&&console['log']('ðŸ”„\x20Gateway\x20mapping\x20(create):',_0x54ffd1,'->',_0x4976c1);const _0x54c335=await database_1[_0x5aab0b(0x24a)]['shop']['create']({'data':{'name':_0xb27f06,'username':_0x1a471a,'password':_0x4a14f1,'telegram':_0x59bdf8,'shopUrl':_0x5523eb,'paymentGateways':_0x4976c1?JSON[_0x5aab0b(0x187)](_0x4976c1):null,'gatewaySettings':_0x145f0c?JSON[_0x5aab0b(0x187)](_0x145f0c):null,'usdtPolygonWallet':_0x5e79e7?.[_0x5aab0b(0x23c)]||null,'usdtTrcWallet':_0x5e79e7?.[_0x5aab0b(0x1ed)]||null,'usdtErcWallet':_0x5e79e7?.['usdtErcWallet']||null,'usdcPolygonWallet':_0x5e79e7?.[_0x5aab0b(0x1a8)]||null,'publicKey':_0x2f5ad3,'secretKey':_0x3a070a,'status':_0x5aab0b(0x239)},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});return{'id':_0x54c335['id'],'fullName':_0x54c335[_0x5aab0b(0x1d7)],'username':_0x54c335[_0x5aab0b(0x152)],'telegramId':_0x54c335['telegram'],'merchantUrl':_0x54c335[_0x5aab0b(0x226)],'gateways':_0x54c335[_0x5aab0b(0x155)]?JSON[_0x5aab0b(0x116)](_0x54c335[_0x5aab0b(0x155)]):null,'gatewaySettings':_0x54c335[_0x5aab0b(0x1b0)]?JSON['parse'](_0x54c335[_0x5aab0b(0x1b0)]):null,'publicKey':_0x54c335[_0x5aab0b(0x257)],'wallets':{'usdtPolygonWallet':_0x54c335[_0x5aab0b(0x23c)],'usdtTrcWallet':_0x54c335[_0x5aab0b(0x1ed)],'usdtErcWallet':_0x54c335[_0x5aab0b(0x17f)],'usdcPolygonWallet':_0x54c335[_0x5aab0b(0x1a8)]},'status':_0x54c335[_0x5aab0b(0x18a)],'createdAt':_0x54c335[_0x5aab0b(0x1a3)]};}async[a48_0x23d58a(0x22b)](_0x235ecf){const _0x59bee4=a48_0x23d58a;await database_1[_0x59bee4(0x24a)][_0x59bee4(0x1c3)]['delete']({'where':{'id':_0x235ecf}});}[a48_0x23d58a(0x221)](_0x18381b,_0x30b505,_0x56fa09){const _0x3c2c05=a48_0x23d58a,_0x1dd235=new Map(),_0x24c4a3=new Date(_0x30b505);while(_0x24c4a3<=_0x56fa09){const _0x20130f=_0x24c4a3[_0x3c2c05(0x16c)]()['split']('T')[0x0];_0x1dd235[_0x3c2c05(0x178)](_0x20130f,{'revenue':0x0,'count':0x0}),_0x24c4a3[_0x3c2c05(0x237)](_0x24c4a3[_0x3c2c05(0x241)]()+0x1);}for(const _0xc52a88 of _0x18381b){const _0x2191c8=_0xc52a88[_0x3c2c05(0x1a3)][_0x3c2c05(0x16c)]()[_0x3c2c05(0x1a2)]('T')[0x0],_0x13ca4b=_0x1dd235[_0x3c2c05(0x169)](_0x2191c8);_0x13ca4b&&(_0x13ca4b[_0x3c2c05(0x243)]+=0x1,_0xc52a88[_0x3c2c05(0x18a)]===_0x3c2c05(0x18f)&&(_0xc52a88['amountUSDT']?_0x13ca4b[_0x3c2c05(0x189)]+=_0xc52a88[_0x3c2c05(0x164)]:console[_0x3c2c05(0x17c)](_0x3c2c05(0x1c9)+_0xc52a88['id']+_0x3c2c05(0x148))));}const _0xa9ea9f=[],_0x3d70d4=[];for(const [_0x364d01,_0x18f7f5]of _0x1dd235){_0xa9ea9f[_0x3c2c05(0x27c)]({'date':_0x364d01,'amount':Math['round'](_0x18f7f5[_0x3c2c05(0x189)]*0x64)/0x64}),_0x3d70d4[_0x3c2c05(0x27c)]({'date':_0x364d01,'count':_0x18f7f5[_0x3c2c05(0x243)]});}return{'dailyRevenue':_0xa9ea9f,'dailyPayments':_0x3d70d4};}}exports[a48_0x23d58a(0x11d)]=AdminService;