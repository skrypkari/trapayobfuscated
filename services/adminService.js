'use strict';function a36_0x31d4(_0x131d57,_0x44c137){const _0x2bd49a=a36_0x2bd4();return a36_0x31d4=function(_0x31d4e1,_0x2fa420){_0x31d4e1=_0x31d4e1-0xec;let _0x36cc90=_0x2bd49a[_0x31d4e1];return _0x36cc90;},a36_0x31d4(_0x131d57,_0x44c137);}const a36_0x2d55f5=a36_0x31d4;(function(_0x3c1edd,_0x23f179){const _0x5c133d=a36_0x31d4,_0x459c7c=_0x3c1edd();while(!![]){try{const _0x8e59f3=-parseInt(_0x5c133d(0x113))/0x1*(-parseInt(_0x5c133d(0x1a3))/0x2)+parseInt(_0x5c133d(0x131))/0x3*(-parseInt(_0x5c133d(0x173))/0x4)+parseInt(_0x5c133d(0x1b2))/0x5*(parseInt(_0x5c133d(0x1ee))/0x6)+-parseInt(_0x5c133d(0x19a))/0x7*(-parseInt(_0x5c133d(0x11f))/0x8)+parseInt(_0x5c133d(0x1bc))/0x9*(parseInt(_0x5c133d(0x20c))/0xa)+parseInt(_0x5c133d(0x212))/0xb+-parseInt(_0x5c133d(0x178))/0xc;if(_0x8e59f3===_0x23f179)break;else _0x459c7c['push'](_0x459c7c['shift']());}catch(_0x238259){_0x459c7c['push'](_0x459c7c['shift']());}}}(a36_0x2bd4,0x8dfef));function a36_0x2bd4(){const _0x55d53a=['\x20\x20\x20Added\x20to\x20balance:\x20+','paidAt','averageCommissionRate','gte','totalAmountAfterCommissionUSDT','\x20\x20\x20Payout\x20amount:\x20','PENDING','toUpperCase','usdtPolygonWallet','updateUser','getAllUsers','all','getMerchantStatistics','üéØ\x20updateUser\x20called\x20with\x20ID:\x20','wallets','üìä\x20Getting\x20merchant\x20statistics\x20with\x20filters:','thisMonth','\x20\x20\x20Total\x20paid\x20out:\x20','whiteUrl','ACTIVE','customerName','push','generateDailyStatistics','customerEmail','gatewayOrderId','%\x20commission)','commission','createdAt','updatePaymentStatus','custom','findUnique','shop','createPayout','1xXBLLI','‚úÖ\x20Payout\x20created:\x20','trim','üí∞\x20[PAYOUT]\x20Merchant\x20','\x20merchants','summary','turnoverUSDT','asc','desc','\x20USDT\x20(-','adminNotes','REFUND','11464CKKZTd','rapyd','KLYME\x20DE','parse','\x27\x20as\x20is\x20(not\x20found\x20in\x20mappings)','üìä\x20Merchant\x20statistics\x20calculated:','\x20USDT\x20(gross\x20revenue)','\x20\x20\x20Full\x20amount:\x20','updatedAt','\x20\x20\x20Gateway:\x20','updateCustomerData','üìä\x20Sorting\x20payments\x20by\x20','\x27)\x20not\x20found\x20in\x20database,\x20returning\x20empty\x20result','split','\x20\x20\x20Balance:\x20','chargebackAmount','Telegram\x20username\x20already\x20exists','\x20USDT\x20(after\x20','21ReFtRR','commissionUSDT','\x20\x20\x20üíµ\x20Available\x20balance:\x20','paidOutUSDT','usdtTrcWallet','\x20USDT','deleteUser','\x20\x20\x20üí∞\x20Total\x20payments\x20turnover:\x20','create','merchantUrl','pendingUrl','0000','%\x20from\x20','getMonth','üí∞\x20Current\x20shop\x20balance:\x20','\x20\x20\x20üí∏\x20Total\x20payouts\x20(all\x20time):\x20','\x27\x20to\x20name\x20\x27','balance','log','\x20PAID\x20payments','substr','AdminService','\x20no\x20longer\x20PAID:','lte','set','getGatewayNameById','üîÑ\x20REFUND:\x20Payment\x20amount\x20already\x20deducted\x20from\x20balance','getGatewayInternalName','merchantEarningsUSDT','customerUa','\x20\x20\x20Current\x20balance:\x20','\x20\x20\x20üè™\x20Gateway\x20earnings:\x20','Error\x20processing\x20payment\x20','mastercard','amountUSDT','failureMessage','\x20to\x20','üîÑ\x20Updating\x20customer\x20data\x20for\x20payment\x20','\x20\x20\x20üîç\x20Calculated\x20after\x20commission:\x20','reduce','üìä\x20Gateway\x20filter\x20applied:','amountAfterGatewayCommissionUSDT','üí∞\x20Found\x20','30d','getSystemStatistics','\x20USDT\x20(total\x20paid\x20to\x20merchants)','PAID','\x20paid\x20payments\x20for\x20analysis','KLYME\x20EU','map','setDate','\x20\x20\x20ÔøΩüìä\x20Total\x20payments:\x20','\x20USDT\x20(actual\x20balances)','payout','suspendUser','awaitingPayout','pk_','update','telegram','\x20balance\x20updated:','totalPayments','\x20USDT\x20(','\x20\x20\x20ÔøΩ\x20Total\x20payments\x20turnover:\x20','getUserById','random','üìä\x20Getting\x20payments\x20with\x20filters:','322060Vnqodv','test_gateway','\x20\x20\x20üñ•Ô∏è\x20User\x20Agent:\x20','\x20balance\x20updated:\x20','values','21426588GuIGId',']\x20Gateway\x20settings\x20JSON\x20string:','getTime','\x20\x20\x20Transaction\x20hash:\x20','getMerchantsSelection','üîß\x20[','count','Insufficient\x20balance.\x20Available:\x20','gatewayEarnings','publicKey','totalTurnover','toLowerCase','üìä\x20[ADMIN]\x20Calculating\x20commission\x20manually\x20for\x20payment\x20','date','availableBalance','COMPLETED','bcryptjs','\x20order','gateway','dateFrom','üîÑ\x20Admin\x20updating\x20payment\x20','statusChangedBy','\x20->\x20','periodFrom','entries','CoinToPay','not\x20specified','klyme_de','not\x20set','paymentsCount','currency','insensitive','sort','\x20for\x20shop\x20','1799UwLjgG','get','telegramId','\x20USDT)','\x20\x20\x20üìÖ\x20This\x20month:\x20','customerIp','toString','year','usdcPolygonWallet','2056492BgmYWt','notes','network','\x20\x20\x20‚úÖ\x20Actual\x20available\x20balance:\x20','pendingPayout','klyme_gb','paymentGateways','üí∞\x20Creating\x20payout\x20for\x20shop\x20','status','payment','getPaymentById','period','‚ö†Ô∏è\x20Gateway\x20\x27','toISOString','\x27\x20not\x20found.\x20Available\x20gateways:\x20','150595FlIVbl','totalAmountUSDT','orderId','trc20','week','90d','findFirst','\x20USDT\x20for\x20payment\x20','findMany','üìã\x20Getting\x20merchants\x20selection\x20list...','2871IhQqJh','stringify','üîÑ\x20Gateway\x20mapping\x20(get):',':\x20commission\x20=\x20','totalPayout','Open\x20Banking\x202','üîÑ\x20Gateway\x20mapping\x20(create):','deletePayout','\x20USDT,\x20Requested:\x20','shopId','error','periodTo','üí∞\x20Shop\x20','üìä\x20Calculating\x20commission\x20manually\x20for\x20payment\x20','üìä\x20Payout\x20statistics\x20calculated:','‚úÖ\x20Customer\x20data\x20updated\x20for\x20payment\x20','usdtErcWallet',']\x20Password\x20not\x20provided\x20or\x20empty,\x20skipping\x20password\x20update','üìÖ\x20Period:\x20','amount','totalPaidOut','password','CHARGEBACK','dailyRevenue','length','üìä\x20Calculating\x20payout\x20statistics...','month','plisio','\x20active\x20merchants\x20for\x20selection','getMerchantsAwaitingPayout','$transaction','shopUrl','\x20\x20\x20üåê\x20IP:\x20','aggregate','fullName','toFixed','Error\x20parsing\x20gateway\x20settings\x20for\x20payment\x20','üìä\x20Total\x20payments\x20(including\x20failed):\x20','getGatewayDisplayName','../config/database','getPayoutStats','üîÑ\x20Converted\x20gateway\x20name\x20\x27','getAllPayouts','randomBytes','ceil','./currencyService','gateways','\x20USDT\x20(+','\x20\x20\x20‚è≥\x20Pending\x20payout:\x20','üí∏\x20CHARGEBACK:\x20Merchant\x20amount\x20already\x20deducted\x20from\x20balance','18DQjoie','amountAfterCommissionUSDT','polygon_usdc','currencyService','üí∞\x20Payment\x20','totalCommissionRate','Plisio','revenue','erc20','localeCompare','name','merchantEarnings','getFullYear',']\x20Updating\x20password\x20for\x20user\x20','üîê\x20[','_sum','\x27\x20(from\x20\x27','round','__esModule','username','\x20\x20\x20üí≥\x20Total\x20payments:\x20','Payment\x20not\x20found','default','some','crypto','\x20missing\x20amountUSDT,\x20using\x20fallback\x20conversion','statusChangedAt','NONEXISTENT_GATEWAY_FILTER','admin',',\x20Commission:\x20','13580kLDOBJ','join','\x20\x20\x20üí∞\x20Total\x20turnover:\x20','txid','\x20USDT\x20(theoretical\x20net)',']\x20Gateway\x20settings\x20before\x20saving:','11117513RPhfqU','averageCheckUSDT','sk_','‚ö†Ô∏è\x20Payment\x20','includes','üîÑ\x20Converted\x20gateway\x20ID\x20\x27','\x20\x20\x20Subtracted\x20from\x20balance:\x20-','groupBy','\x20\x20\x20üë§\x20Merchant\x20earnings:\x20','turnover','üéØ\x20[','gatewaySettings','convertToUSDT','hex','2020-01-01','cointopay','activateUser','Rapyd','customerCountry','üìä\x20Final\x20WHERE\x20conditions:','\x27\x20->\x20name\x20\x27','üí∏\x20CHARGEBACK\x20penalty:\x20-','delete','polygon','üìä\x20Merchants\x20awaiting\x20payout:\x20','\x20USDT\x20(with\x20commission\x20deducted)'];a36_0x2bd4=function(){return _0x55d53a;};return a36_0x2bd4();}var __importDefault=this&&this['__importDefault']||function(_0x37da17){const _0x25f609=a36_0x31d4;return _0x37da17&&_0x37da17[_0x25f609(0x200)]?_0x37da17:{'default':_0x37da17};};Object['defineProperty'](exports,a36_0x2d55f5(0x200),{'value':!![]}),exports[a36_0x2d55f5(0x146)]=void 0x0;const database_1=__importDefault(require(a36_0x2d55f5(0x1e3))),bcryptjs_1=__importDefault(require(a36_0x2d55f5(0x188))),crypto_1=__importDefault(require(a36_0x2d55f5(0x206))),currencyService_1=require(a36_0x2d55f5(0x1e9)),gateway_1=require('../types/gateway');class AdminService{async[a36_0x2d55f5(0x1e4)](){const _0xe88b75=a36_0x2d55f5;console['log'](_0xe88b75(0x1d5));const _0x3db56f=await database_1[_0xe88b75(0x204)]['shop'][_0xe88b75(0x1dd)]({'_sum':{'balance':!![],'totalPaidOut':!![]},'where':{'status':_0xe88b75(0x105)}}),_0xc5b30c=await this[_0xe88b75(0x1d9)]({'page':0x1,'limit':0x3e8}),_0x549ef2=await database_1[_0xe88b75(0x204)][_0xe88b75(0x1ac)][_0xe88b75(0x17e)]({'where':{'status':_0xe88b75(0x15f),'gateway':{'not':_0xe88b75(0x174)}}}),_0x2cc7c4=new Date(),_0xf6d8bc=new Date(_0x2cc7c4[_0xe88b75(0x1fa)](),_0x2cc7c4[_0xe88b75(0x13e)](),0x1),_0xa5c121=new Date(_0x2cc7c4[_0xe88b75(0x1fa)](),_0x2cc7c4[_0xe88b75(0x13e)]()+0x1,0x0,0x17,0x3b,0x3b,0x3e7),_0x2e6215=await database_1[_0xe88b75(0x204)][_0xe88b75(0x166)][_0xe88b75(0x1dd)]({'_sum':{'amount':!![]},'where':{'createdAt':{'gte':_0xf6d8bc,'lte':_0xa5c121},'status':_0xe88b75(0x187)}}),_0x326cac=_0x3db56f[_0xe88b75(0x1fd)][_0xe88b75(0x1d0)]||0x0,_0xff36dc=_0xc5b30c[_0xe88b75(0x118)][_0xe88b75(0xf6)],_0x82068e=_0x2e6215[_0xe88b75(0x1fd)][_0xe88b75(0x1cf)]||0x0,_0x4e56e1={'totalPayout':Math[_0xe88b75(0x1ff)](_0x326cac*0x64)/0x64,'awaitingPayout':Math[_0xe88b75(0x1ff)](_0xff36dc*0x64)/0x64,'thisMonth':Math['round'](_0x82068e*0x64)/0x64,'availableBalance':Math[_0xe88b75(0x1ff)](_0xff36dc*0x64)/0x64,'totalPayments':_0x549ef2};return console[_0xe88b75(0x143)](_0xe88b75(0x1ca)),console[_0xe88b75(0x143)]('\x20\x20\x20üí∞\x20Total\x20payout:\x20'+_0x4e56e1['totalPayout']+_0xe88b75(0x15e)),console[_0xe88b75(0x143)]('\x20\x20\x20‚è≥\x20Awaiting\x20payout:\x20'+_0x4e56e1[_0xe88b75(0x168)]+_0xe88b75(0xf1)),console[_0xe88b75(0x143)](_0xe88b75(0x133)+_0x4e56e1[_0xe88b75(0x186)]+'\x20USDT\x20(same\x20as\x20awaiting)'),console[_0xe88b75(0x143)](_0xe88b75(0x19e)+_0x4e56e1[_0xe88b75(0x102)]+_0xe88b75(0x136)),console['log'](_0xe88b75(0x202)+_0x4e56e1['totalPayments']+_0xe88b75(0x144)),console[_0xe88b75(0x143)]('\x20\x20\x20üîç\x20Raw\x20balance\x20sum:\x20'+(_0x3db56f['_sum'][_0xe88b75(0x142)]||0x0)[_0xe88b75(0x1df)](0x2)+'\x20USDT\x20(without\x20commission)'),console[_0xe88b75(0x143)]('\x20\x20\x20üìä\x20Commission\x20difference:\x20'+((_0x3db56f[_0xe88b75(0x1fd)]['balance']||0x0)-_0xff36dc)[_0xe88b75(0x1df)](0x2)+_0xe88b75(0x136)),_0x4e56e1;}async[a36_0x2d55f5(0x129)](_0x3f796d,_0xddfb3f){const _0x5ba206=a36_0x2d55f5;console[_0x5ba206(0x143)](_0x5ba206(0x156)+_0x3f796d+':',_0xddfb3f);const _0x44aa90=await database_1['default'][_0x5ba206(0x1ac)]['findUnique']({'where':{'id':_0x3f796d},'select':{'id':!![],'customerEmail':!![],'customerName':!![],'customerCountry':!![],'customerIp':!![],'customerUa':!![]}});if(!_0x44aa90)throw new Error(_0x5ba206(0x203));const _0x53f74c={};_0xddfb3f[_0x5ba206(0x224)]!==undefined&&(_0x53f74c[_0x5ba206(0x224)]=_0xddfb3f[_0x5ba206(0x224)]||null);_0xddfb3f['customerIp']!==undefined&&(_0x53f74c[_0x5ba206(0x19f)]=_0xddfb3f[_0x5ba206(0x19f)]||null);_0xddfb3f[_0x5ba206(0x14e)]!==undefined&&(_0x53f74c[_0x5ba206(0x14e)]=_0xddfb3f['customerUa']||null);const _0x1d40cf=await database_1['default']['payment']['update']({'where':{'id':_0x3f796d},'data':{..._0x53f74c,'updatedAt':new Date()},'select':{'id':!![],'customerEmail':!![],'customerName':!![],'customerCountry':!![],'customerIp':!![],'customerUa':!![],'updatedAt':!![]}});return console[_0x5ba206(0x143)](_0x5ba206(0x1cb)+_0x3f796d),console[_0x5ba206(0x143)]('\x20\x20\x20üåç\x20Country:\x20'+_0x44aa90['customerCountry']+_0x5ba206(0x18e)+_0x1d40cf[_0x5ba206(0x224)]),console[_0x5ba206(0x143)](_0x5ba206(0x1dc)+_0x44aa90[_0x5ba206(0x19f)]+_0x5ba206(0x18e)+_0x1d40cf[_0x5ba206(0x19f)]),console[_0x5ba206(0x143)](_0x5ba206(0x175)+(_0x44aa90['customerUa']?_0x5ba206(0x149):_0x5ba206(0x194))+'\x20->\x20'+(_0x1d40cf[_0x5ba206(0x14e)]?'set':_0x5ba206(0x194))),_0x1d40cf;}async[a36_0x2d55f5(0x15d)](_0x474872){const _0x1128ca=a36_0x2d55f5,_0x3e009e=new Date();let _0x36022a;switch(_0x474872){case'7d':_0x36022a=new Date(_0x3e009e[_0x1128ca(0x17a)]()-0x7*0x18*0x3c*0x3c*0x3e8);break;case _0x1128ca(0x15c):_0x36022a=new Date(_0x3e009e['getTime']()-0x1e*0x18*0x3c*0x3c*0x3e8);break;case _0x1128ca(0x1b7):_0x36022a=new Date(_0x3e009e[_0x1128ca(0x17a)]()-0x5a*0x18*0x3c*0x3c*0x3e8);break;case _0x1128ca(0xfd):const _0x11203f=await database_1[_0x1128ca(0x204)][_0x1128ca(0x1ac)][_0x1128ca(0x1b8)]({'where':{'gateway':{'not':_0x1128ca(0x174)}},'orderBy':{'createdAt':_0x1128ca(0x11a)},'select':{'createdAt':!![]}});_0x36022a=_0x11203f?_0x11203f[_0x1128ca(0x10d)]:new Date(_0x1128ca(0x220)),console[_0x1128ca(0x143)]('üìÖ\x20Period\x20\x27all\x27:\x20Using\x20start\x20date\x20from\x20first\x20payment:\x20'+_0x36022a[_0x1128ca(0x1b0)]());break;default:_0x36022a=new Date(_0x3e009e[_0x1128ca(0x17a)]()-0x1e*0x18*0x3c*0x3c*0x3e8);}const [_0x794e04,_0x50bdbc,_0x4ecef6,_0x3b1cbb,_0x518591,_0x36c2ed]=await Promise[_0x1128ca(0xfd)]([database_1[_0x1128ca(0x204)][_0x1128ca(0x111)]['count'](),database_1[_0x1128ca(0x204)][_0x1128ca(0x111)]['count']({'where':{'status':_0x1128ca(0x105)}}),database_1[_0x1128ca(0x204)]['payment'][_0x1128ca(0x17e)]({'where':{'status':_0x1128ca(0x15f),'createdAt':{'gte':_0x36022a},'gateway':{'not':'test_gateway'}}}),database_1[_0x1128ca(0x204)]['payment'][_0x1128ca(0x1ba)]({'where':{'status':'PAID','createdAt':{'gte':_0x36022a},'gateway':{'not':'test_gateway'}},'select':{'amount':!![],'currency':!![],'amountAfterGatewayCommissionUSDT':!![]}}),database_1['default']['payment']['findMany']({'where':{'gateway':{'not':_0x1128ca(0x174)}},'take':0xa,'orderBy':{'createdAt':_0x1128ca(0x11b)},'include':{'shop':{'select':{'name':!![],'username':!![]}}}}),database_1[_0x1128ca(0x204)][_0x1128ca(0x1ac)]['findMany']({'where':{'createdAt':{'gte':_0x36022a},'gateway':{'not':_0x1128ca(0x174)}},'select':{'amount':!![],'currency':!![],'status':!![],'amountUSDT':!![],'createdAt':!![]}})]);let _0x57812b=0x0,_0x5860cd=0x0;for(const _0x3e9e6d of _0x3b1cbb){const _0x9beda3=await currencyService_1['currencyService'][_0x1128ca(0x21e)](_0x3e9e6d[_0x1128ca(0x1cf)],_0x3e9e6d[_0x1128ca(0x196)]);_0x57812b+=_0x9beda3;if(_0x3e9e6d[_0x1128ca(0x15a)]){const _0x1da6ca=await currencyService_1[_0x1128ca(0x1f1)]['convertToUSDT'](_0x3e9e6d['amount'],_0x3e9e6d[_0x1128ca(0x196)]),_0x50698d=_0x3e9e6d['amountAfterGatewayCommissionUSDT'],_0x36dd53=_0x1da6ca-_0x50698d;_0x5860cd+=_0x36dd53;}}const _0x15e4d8=_0x4ecef6>0x0?_0x57812b/_0x4ecef6:0x0,_0xf7b418=this[_0x1128ca(0x108)](_0x36c2ed,_0x36022a,_0x3e009e),_0x5c5e95=await database_1[_0x1128ca(0x204)][_0x1128ca(0x1ac)][_0x1128ca(0x17e)]({'where':{'createdAt':{'gte':_0x36022a},'gateway':{'not':_0x1128ca(0x174)}}}),_0x129f67=_0x5c5e95>0x0?_0x4ecef6/_0x5c5e95*0x64:0x0;return{'totalShops':_0x794e04,'activeShops':_0x50bdbc,'totalPayments':_0x4ecef6,'successfulPayments':_0x4ecef6,'totalAttempts':_0x5c5e95,'totalRevenue':Math[_0x1128ca(0x1ff)](_0x57812b*0x64)/0x64,'trapayEarnings':Math[_0x1128ca(0x1ff)](_0x5860cd*0x64)/0x64,'averagePaymentAmount':Math[_0x1128ca(0x1ff)](_0x15e4d8*0x64)/0x64,'conversionRate':Math['round'](_0x129f67*0x64)/0x64,'dailyRevenue':_0xf7b418[_0x1128ca(0x1d3)],'dailyPayments':_0xf7b418['dailyPayments'],'recentPayments':_0x518591[_0x1128ca(0x162)](_0x421fdd=>({'id':_0x421fdd['id'],'amount':_0x421fdd['amount'],'currency':_0x421fdd[_0x1128ca(0x196)],'status':_0x421fdd[_0x1128ca(0x1ab)],'gateway':_0x421fdd[_0x1128ca(0x18a)],'shop':_0x421fdd['shop'],'createdAt':_0x421fdd[_0x1128ca(0x10d)]}))};}async[a36_0x2d55f5(0xfe)](_0x627823){const _0x5b2f66=a36_0x2d55f5;console['log'](_0x5b2f66(0x101),_0x627823);let _0x2f05c7,_0x501e74=new Date();if(_0x627823[_0x5b2f66(0x1ae)]===_0x5b2f66(0x10f)&&_0x627823[_0x5b2f66(0x18b)]&&_0x627823['dateTo'])_0x2f05c7=new Date(_0x627823[_0x5b2f66(0x18b)]),_0x501e74=new Date(_0x627823['dateTo']);else{const _0x4727ea=new Date();switch(_0x627823[_0x5b2f66(0x1ae)]){case _0x5b2f66(0x1b6):_0x2f05c7=new Date(_0x4727ea['getTime']()-0x7*0x18*0x3c*0x3c*0x3e8);break;case _0x5b2f66(0x1d6):_0x2f05c7=new Date(_0x4727ea[_0x5b2f66(0x17a)]()-0x1e*0x18*0x3c*0x3c*0x3e8);break;case _0x5b2f66(0x1a1):_0x2f05c7=new Date(_0x4727ea['getTime']()-0x16d*0x18*0x3c*0x3c*0x3e8);break;case _0x5b2f66(0xfd):default:_0x2f05c7=new Date(_0x5b2f66(0x220));break;}}console['log'](_0x5b2f66(0x1ce)+_0x2f05c7[_0x5b2f66(0x1b0)]()+_0x5b2f66(0x155)+_0x501e74['toISOString']());const _0x4382ce={'status':_0x5b2f66(0x15f),'gateway':{'not':_0x5b2f66(0x174)},'paidAt':{'gte':_0x2f05c7,'lte':_0x501e74}};_0x627823['shopId']&&(_0x4382ce['shopId']=_0x627823[_0x5b2f66(0x1c5)]);const _0x29ef88=await database_1[_0x5b2f66(0x204)][_0x5b2f66(0x1ac)][_0x5b2f66(0x1ba)]({'where':_0x4382ce,'include':{'shop':{'select':{'id':!![],'name':!![],'username':!![],'gatewaySettings':!![]}}}});console[_0x5b2f66(0x143)](_0x5b2f66(0x15b)+_0x29ef88[_0x5b2f66(0x1d4)]+_0x5b2f66(0x160));const _0x1d3bb3={'gateway':{'not':'test_gateway'},'createdAt':{'gte':_0x2f05c7,'lte':_0x501e74}};_0x627823[_0x5b2f66(0x1c5)]&&(_0x1d3bb3[_0x5b2f66(0x1c5)]=_0x627823[_0x5b2f66(0x1c5)]);const _0x4bc966=await database_1['default'][_0x5b2f66(0x1ac)][_0x5b2f66(0x17e)]({'where':_0x1d3bb3});console['log'](_0x5b2f66(0x1e1)+_0x4bc966+',\x20successful:\x20'+_0x29ef88[_0x5b2f66(0x1d4)]);let _0xa38d3d=0x0,_0x579e7b=0x0,_0x513fc7=0x0;const _0x2c8fc2={},_0xe8e77a={},_0x38a350={};for(const _0x51f858 of _0x29ef88){try{const _0x21ffe3=await currencyService_1[_0x5b2f66(0x1f1)]['convertToUSDT'](_0x51f858['amount'],_0x51f858[_0x5b2f66(0x196)]);let _0x100806={};if(_0x51f858[_0x5b2f66(0x111)][_0x5b2f66(0x21d)])try{_0x100806=JSON[_0x5b2f66(0x122)](_0x51f858['shop']['gatewaySettings']);}catch(_0x4ad0e1){console[_0x5b2f66(0x1c6)]('Error\x20parsing\x20gateway\x20settings\x20for\x20shop\x20'+_0x51f858[_0x5b2f66(0x1c5)]+':',_0x4ad0e1);}let _0x8faab={},_0x4ddbd8=0xa;for(const [_0x470b4e,_0x34b3a8]of Object[_0x5b2f66(0x190)](_0x100806)){if(_0x470b4e[_0x5b2f66(0x183)]()===_0x51f858[_0x5b2f66(0x18a)][_0x5b2f66(0x183)]()){_0x8faab=_0x34b3a8,_0x4ddbd8=_0x34b3a8[_0x5b2f66(0x10c)]||0xa;break;}}let _0x44f585,_0x69e9e9;_0x51f858[_0x5b2f66(0x15a)]!==null&&_0x51f858[_0x5b2f66(0x15a)]!==undefined?(_0x44f585=_0x51f858[_0x5b2f66(0x15a)],_0x69e9e9=_0x21ffe3-_0x44f585,console[_0x5b2f66(0x143)]('üìä\x20Using\x20saved\x20amountAfterGatewayCommissionUSDT:\x20'+_0x44f585[_0x5b2f66(0x1df)](0x6)+_0x5b2f66(0x1b9)+_0x51f858['id'])):(_0x69e9e9=_0x21ffe3*(_0x4ddbd8/0x64),_0x44f585=_0x21ffe3-_0x69e9e9,console[_0x5b2f66(0x143)](_0x5b2f66(0x1c9)+_0x51f858['id']+':\x20'+_0x4ddbd8+_0x5b2f66(0x13d)+_0x21ffe3[_0x5b2f66(0x1df)](0x6)+_0x5b2f66(0x136)));_0xa38d3d+=_0x21ffe3,_0x579e7b+=_0x44f585,_0x513fc7+=_0x69e9e9;!_0x2c8fc2[_0x51f858[_0x5b2f66(0x18a)]]&&(_0x2c8fc2[_0x51f858['gateway']]={'gateway':_0x51f858[_0x5b2f66(0x18a)],'gatewayDisplayName':this[_0x5b2f66(0x1e2)](_0x51f858[_0x5b2f66(0x18a)]),'paymentsCount':0x0,'turnoverUSDT':0x0,'commissionUSDT':0x0,'merchantEarningsUSDT':0x0,'totalCommissionRate':0x0});_0x2c8fc2[_0x51f858[_0x5b2f66(0x18a)]][_0x5b2f66(0x195)]++,_0x2c8fc2[_0x51f858[_0x5b2f66(0x18a)]][_0x5b2f66(0x119)]+=_0x21ffe3,_0x2c8fc2[_0x51f858[_0x5b2f66(0x18a)]][_0x5b2f66(0x132)]+=_0x69e9e9,_0x2c8fc2[_0x51f858['gateway']][_0x5b2f66(0x14d)]+=_0x44f585,_0x2c8fc2[_0x51f858[_0x5b2f66(0x18a)]][_0x5b2f66(0x1f3)]+=_0x4ddbd8;!_0x627823[_0x5b2f66(0x1c5)]&&(!_0xe8e77a[_0x51f858[_0x5b2f66(0x1c5)]]&&(_0xe8e77a[_0x51f858[_0x5b2f66(0x1c5)]]={'shopId':_0x51f858[_0x5b2f66(0x1c5)],'shopName':_0x51f858[_0x5b2f66(0x111)][_0x5b2f66(0x1f8)],'shopUsername':_0x51f858['shop'][_0x5b2f66(0x201)],'paymentsCount':0x0,'turnoverUSDT':0x0,'commissionUSDT':0x0,'merchantEarningsUSDT':0x0,'paidOutUSDT':0x0,'averageCheckUSDT':0x0}),_0xe8e77a[_0x51f858['shopId']][_0x5b2f66(0x195)]++,_0xe8e77a[_0x51f858[_0x5b2f66(0x1c5)]][_0x5b2f66(0x119)]+=_0x21ffe3,_0xe8e77a[_0x51f858[_0x5b2f66(0x1c5)]][_0x5b2f66(0x132)]+=_0x69e9e9,_0xe8e77a[_0x51f858[_0x5b2f66(0x1c5)]][_0x5b2f66(0x14d)]+=_0x44f585);const _0x55de0a=_0x51f858[_0x5b2f66(0xf3)]['toISOString']()[_0x5b2f66(0x12c)]('T')[0x0];!_0x38a350[_0x55de0a]&&(_0x38a350[_0x55de0a]={'date':_0x55de0a,'turnover':0x0,'merchantEarnings':0x0,'gatewayEarnings':0x0,'paymentsCount':0x0}),_0x38a350[_0x55de0a][_0x5b2f66(0x21b)]+=_0x21ffe3,_0x38a350[_0x55de0a]['merchantEarnings']+=_0x44f585,_0x38a350[_0x55de0a][_0x5b2f66(0x180)]+=_0x69e9e9,_0x38a350[_0x55de0a][_0x5b2f66(0x195)]++;}catch(_0x26e361){console[_0x5b2f66(0x1c6)](_0x5b2f66(0x151)+_0x51f858['id']+':',_0x26e361);}}Object[_0x5b2f66(0x177)](_0x2c8fc2)['forEach'](_0x425e10=>{const _0xd69f6a=_0x5b2f66;_0x425e10[_0xd69f6a(0xf4)]=_0x425e10[_0xd69f6a(0x195)]>0x0?_0x425e10[_0xd69f6a(0x1f3)]/_0x425e10['paymentsCount']:0x0,delete _0x425e10[_0xd69f6a(0x1f3)];}),Object['values'](_0xe8e77a)['forEach'](_0x7cd594=>{const _0x22a076=_0x5b2f66;_0x7cd594[_0x22a076(0x213)]=_0x7cd594[_0x22a076(0x195)]>0x0?_0x7cd594['turnoverUSDT']/_0x7cd594[_0x22a076(0x195)]:0x0;});let _0xa93da2=0x0,_0x1dbee6=0x0;if(_0x627823[_0x5b2f66(0x1c5)]){const _0x41c14d=await database_1[_0x5b2f66(0x204)][_0x5b2f66(0x166)]['findMany']({'where':{'shopId':_0x627823[_0x5b2f66(0x1c5)],'status':_0x5b2f66(0x187),'createdAt':{'gte':_0x2f05c7,'lte':_0x501e74}},'select':{'amount':!![]}});_0xa93da2=_0x41c14d[_0x5b2f66(0x158)]((_0x18908b,_0x33c9cf)=>_0x18908b+_0x33c9cf[_0x5b2f66(0x1cf)],0x0);const _0x14c1dc=await database_1['default'][_0x5b2f66(0x166)][_0x5b2f66(0x1ba)]({'where':{'shopId':_0x627823['shopId'],'status':_0x5b2f66(0xf8),'createdAt':{'gte':_0x2f05c7,'lte':_0x501e74}},'select':{'amount':!![]}});_0x1dbee6=_0x14c1dc[_0x5b2f66(0x158)]((_0x283a0f,_0x29cd69)=>_0x283a0f+_0x29cd69[_0x5b2f66(0x1cf)],0x0);}const _0x56504c=_0x4bc966,_0xb8bb73=_0x29ef88[_0x5b2f66(0x1d4)],_0x5bb4c6=_0xb8bb73>0x0?_0xa38d3d/_0xb8bb73:0x0,_0x504397=_0x56504c>0x0?Math[_0x5b2f66(0x1ff)](_0xb8bb73/_0x56504c*0x2710)/0x64:0x0,_0x36e112=Math[_0x5b2f66(0x1e8)]((_0x501e74[_0x5b2f66(0x17a)]()-_0x2f05c7[_0x5b2f66(0x17a)]())/(0x3e8*0x3c*0x3c*0x18)),_0x29b898={'totalTurnover':Math[_0x5b2f66(0x1ff)](_0xa38d3d*0x64)/0x64,'merchantEarnings':Math[_0x5b2f66(0x1ff)](_0x579e7b*0x64)/0x64,'gatewayEarnings':Math['round'](_0x513fc7*0x64)/0x64,'totalPaidOut':Math[_0x5b2f66(0x1ff)](_0xa93da2*0x64)/0x64,'pendingPayout':Math[_0x5b2f66(0x1ff)](_0x1dbee6*0x64)/0x64,'averageCheck':Math[_0x5b2f66(0x1ff)](_0x5bb4c6*0x64)/0x64,'totalPayments':_0x56504c,'successfulPayments':_0xb8bb73,'conversionRate':_0x504397,'gatewayBreakdown':Object[_0x5b2f66(0x177)](_0x2c8fc2)['map'](_0x49012d=>({..._0x49012d,'turnoverUSDT':Math['round'](_0x49012d[_0x5b2f66(0x119)]*0x64)/0x64,'commissionUSDT':Math[_0x5b2f66(0x1ff)](_0x49012d[_0x5b2f66(0x132)]*0x64)/0x64,'merchantEarningsUSDT':Math[_0x5b2f66(0x1ff)](_0x49012d[_0x5b2f66(0x14d)]*0x64)/0x64,'averageCommissionRate':Math['round'](_0x49012d[_0x5b2f66(0xf4)]*0x64)/0x64})),'merchantBreakdown':_0x627823[_0x5b2f66(0x1c5)]?undefined:Object[_0x5b2f66(0x177)](_0xe8e77a)['map'](_0x4fa8a1=>({..._0x4fa8a1,'turnoverUSDT':Math[_0x5b2f66(0x1ff)](_0x4fa8a1[_0x5b2f66(0x119)]*0x64)/0x64,'commissionUSDT':Math[_0x5b2f66(0x1ff)](_0x4fa8a1[_0x5b2f66(0x132)]*0x64)/0x64,'merchantEarningsUSDT':Math['round'](_0x4fa8a1[_0x5b2f66(0x14d)]*0x64)/0x64,'paidOutUSDT':Math[_0x5b2f66(0x1ff)](_0x4fa8a1[_0x5b2f66(0x134)]*0x64)/0x64,'averageCheckUSDT':Math[_0x5b2f66(0x1ff)](_0x4fa8a1[_0x5b2f66(0x213)]*0x64)/0x64})),'dailyData':Object[_0x5b2f66(0x177)](_0x38a350)[_0x5b2f66(0x162)](_0x1d4dcd=>({..._0x1d4dcd,'turnover':Math[_0x5b2f66(0x1ff)](_0x1d4dcd[_0x5b2f66(0x21b)]*0x64)/0x64,'merchantEarnings':Math[_0x5b2f66(0x1ff)](_0x1d4dcd[_0x5b2f66(0x1f9)]*0x64)/0x64,'gatewayEarnings':Math['round'](_0x1d4dcd[_0x5b2f66(0x180)]*0x64)/0x64}))[_0x5b2f66(0x198)]((_0x529b48,_0x48a439)=>_0x529b48[_0x5b2f66(0x185)][_0x5b2f66(0x1f7)](_0x48a439[_0x5b2f66(0x185)])),'periodInfo':{'from':_0x2f05c7,'to':_0x501e74,'periodType':_0x627823[_0x5b2f66(0x1ae)]||'custom','daysCount':_0x36e112}};return console[_0x5b2f66(0x143)](_0x5b2f66(0x124)),console[_0x5b2f66(0x143)](_0x5b2f66(0x20e)+_0x29b898[_0x5b2f66(0x182)]+_0x5b2f66(0x136)),console[_0x5b2f66(0x143)](_0x5b2f66(0x21a)+_0x29b898[_0x5b2f66(0x1f9)]+_0x5b2f66(0x136)),console[_0x5b2f66(0x143)](_0x5b2f66(0x150)+_0x29b898[_0x5b2f66(0x180)]+_0x5b2f66(0x136)),console[_0x5b2f66(0x143)]('\x20\x20\x20ÔøΩ\x20Total\x20paid\x20out:\x20'+_0x29b898[_0x5b2f66(0x1d0)]+_0x5b2f66(0x136)),console[_0x5b2f66(0x143)](_0x5b2f66(0x1ec)+_0x29b898[_0x5b2f66(0x1a7)]+_0x5b2f66(0x136)),console[_0x5b2f66(0x143)](_0x5b2f66(0x164)+_0x29b898[_0x5b2f66(0x16d)]),_0x29b898;}async[a36_0x2d55f5(0x17c)](){const _0x3eb669=a36_0x2d55f5;console[_0x3eb669(0x143)](_0x3eb669(0x1bb));const _0xcc175c=await database_1[_0x3eb669(0x204)]['shop'][_0x3eb669(0x1ba)]({'where':{'status':_0x3eb669(0x105)},'select':{'id':!![],'username':!![],'name':!![]},'orderBy':{'name':_0x3eb669(0x11a)}});return console[_0x3eb669(0x143)]('üìã\x20Found\x20'+_0xcc175c[_0x3eb669(0x1d4)]+_0x3eb669(0x1d8)),_0xcc175c[_0x3eb669(0x162)](_0x26efee=>({'id':_0x26efee['id'],'username':_0x26efee['username'],'name':_0x26efee[_0x3eb669(0x1f8)]}));}[a36_0x2d55f5(0x1e2)](_0x5d2df9){const _0x28e180=a36_0x2d55f5,_0x5df59c={'test_gateway':'Test\x20Gateway','plisio':_0x28e180(0x1f4),'rapyd':_0x28e180(0x223),'noda':'Noda','cointopay':_0x28e180(0x191),'cointopay2':_0x28e180(0x1c1),'klyme_eu':_0x28e180(0x161),'klyme_gb':'KLYME\x20GB','klyme_de':_0x28e180(0x121),'mastercard':'MasterCard'};return _0x5df59c[_0x5d2df9]||_0x5d2df9;}[a36_0x2d55f5(0x14c)](_0x2c2576){const _0x59ec77=a36_0x2d55f5,_0x32f082={'Test\x20Gateway':_0x59ec77(0x174),'Plisio':_0x59ec77(0x1d7),'Rapyd':_0x59ec77(0x120),'Noda':'noda','CoinToPay':_0x59ec77(0x221),'CoinToPay2':'cointopay2','KLYME\x20EU':'klyme_eu','KLYME\x20GB':_0x59ec77(0x1a8),'KLYME\x20DE':_0x59ec77(0x193),'MasterCard':_0x59ec77(0x152)};return _0x32f082[_0x2c2576]||_0x2c2576[_0x59ec77(0x183)]();}async[a36_0x2d55f5(0x1d9)](_0x23cc66){const _0x24d66a=a36_0x2d55f5,{page:_0x25cd70,limit:_0x78ef04,minAmount:_0x2aee82,search:_0x28e66b}=_0x23cc66,_0x464a9e=(_0x25cd70-0x1)*_0x78ef04;console[_0x24d66a(0x143)]('üìä\x20Getting\x20merchants\x20awaiting\x20payout\x20with\x20filters:',_0x23cc66);const _0x10d16b={'balance':{'gt':0x0},'status':_0x24d66a(0x105)};_0x2aee82&&(_0x10d16b['balance'][_0x24d66a(0xf5)]=_0x2aee82);_0x28e66b&&(_0x10d16b['OR']=[{'name':{'contains':_0x28e66b,'mode':_0x24d66a(0x197)}},{'username':{'contains':_0x28e66b,'mode':_0x24d66a(0x197)}}]);const [_0x5a67b0,_0x2ff68b]=await Promise[_0x24d66a(0xfd)]([database_1[_0x24d66a(0x204)][_0x24d66a(0x111)][_0x24d66a(0x1ba)]({'where':_0x10d16b,'skip':_0x464a9e,'take':_0x78ef04,'orderBy':{'balance':_0x24d66a(0x11b)},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'balance':!![],'totalPaidOut':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'gatewaySettings':!![],'createdAt':!![]}}),database_1[_0x24d66a(0x204)][_0x24d66a(0x111)][_0x24d66a(0x17e)]({'where':_0x10d16b})]);console[_0x24d66a(0x143)](_0x24d66a(0x15b)+_0x5a67b0['length']+'\x20merchants\x20with\x20positive\x20balance');const _0x3e773c=await Promise[_0x24d66a(0xfd)](_0x5a67b0[_0x24d66a(0x162)](async _0x89fa31=>{const _0x52e0d0=_0x24d66a,[_0x41fc49,_0x2ade2a,_0x3c492f]=await Promise['all']([database_1[_0x52e0d0(0x204)]['payment']['count']({'where':{'shopId':_0x89fa31['id'],'status':_0x52e0d0(0x15f),'gateway':{'not':_0x52e0d0(0x174)}}}),database_1[_0x52e0d0(0x204)][_0x52e0d0(0x1ac)][_0x52e0d0(0x1b8)]({'where':{'shopId':_0x89fa31['id'],'status':_0x52e0d0(0x15f),'gateway':{'not':'test_gateway'}},'orderBy':{'paidAt':_0x52e0d0(0x11a)},'select':{'paidAt':!![]}}),database_1[_0x52e0d0(0x204)][_0x52e0d0(0x1ac)][_0x52e0d0(0x219)]({'by':[_0x52e0d0(0x18a)],'where':{'shopId':_0x89fa31['id'],'status':_0x52e0d0(0x15f),'gateway':{'not':_0x52e0d0(0x174)}},'_count':{'id':!![]},'_sum':{'amountUSDT':!![]}})]),_0x4e90d4=new Date(),_0x3aa275=new Date(_0x4e90d4[_0x52e0d0(0x1fa)](),_0x4e90d4[_0x52e0d0(0x13e)](),0x1),_0x54fe78=new Date(_0x4e90d4[_0x52e0d0(0x1fa)](),_0x4e90d4[_0x52e0d0(0x13e)]()+0x1,0x0,0x17,0x3b,0x3b,0x3e7),[_0x5e2ec1,_0x41f0da]=await Promise['all']([database_1[_0x52e0d0(0x204)][_0x52e0d0(0x166)][_0x52e0d0(0x1dd)]({'_sum':{'amount':!![]},'where':{'shopId':_0x89fa31['id'],'status':_0x52e0d0(0x187)}}),database_1[_0x52e0d0(0x204)][_0x52e0d0(0x166)][_0x52e0d0(0x1dd)]({'_sum':{'amount':!![]},'where':{'shopId':_0x89fa31['id'],'status':_0x52e0d0(0x187),'createdAt':{'gte':_0x3aa275,'lte':_0x54fe78}}})]),_0x2f6c6c=_0x5e2ec1[_0x52e0d0(0x1fd)]['amount']||0x0,_0x480ba9=_0x41f0da[_0x52e0d0(0x1fd)][_0x52e0d0(0x1cf)]||0x0,_0x1775e1=await Promise[_0x52e0d0(0xfd)](_0x3c492f[_0x52e0d0(0x162)](async _0x5f067f=>{const _0x34eb04=_0x52e0d0;let _0x2358ea=0xa;if(_0x89fa31[_0x34eb04(0x21d)])try{const _0x1c3661=JSON[_0x34eb04(0x122)](_0x89fa31[_0x34eb04(0x21d)]);for(const [_0x163b2f,_0x110cd1]of Object[_0x34eb04(0x190)](_0x1c3661)){if(_0x163b2f[_0x34eb04(0x183)]()===_0x5f067f['gateway'][_0x34eb04(0x183)]()){_0x2358ea=_0x110cd1['commission']||0xa,console[_0x34eb04(0x143)]('üí∞\x20[PAYOUT]\x20Gateway\x20'+_0x5f067f['gateway']+_0x34eb04(0x199)+_0x89fa31['id']+_0x34eb04(0x1bf)+_0x2358ea+'%');break;}}}catch(_0xec75c){console[_0x34eb04(0x1c6)]('Error\x20parsing\x20gateway\x20settings\x20for\x20shop\x20'+_0x89fa31['id']+':',_0xec75c);}const _0x492bdd=_0x5f067f['_sum']?.[_0x34eb04(0x153)]||0x0,_0x25865e=_0x492bdd*(0x1-_0x2358ea/0x64);return{'gateway':_0x5f067f[_0x34eb04(0x18a)],'count':_0x5f067f['_count']?.['id']||0x0,'amountUSDT':Math[_0x34eb04(0x1ff)](_0x492bdd*0x64)/0x64,'amountAfterCommissionUSDT':Math[_0x34eb04(0x1ff)](_0x25865e*0x64)/0x64,'commission':_0x2358ea};})),_0xda6275=_0x1775e1[_0x52e0d0(0x158)]((_0x469284,_0x533e9f)=>_0x469284+_0x533e9f[_0x52e0d0(0x153)],0x0),_0x16da96=_0x89fa31[_0x52e0d0(0x142)];return console[_0x52e0d0(0x143)](_0x52e0d0(0x116)+_0x89fa31[_0x52e0d0(0x201)]+':'),console[_0x52e0d0(0x143)](_0x52e0d0(0x16f)+_0xda6275[_0x52e0d0(0x1df)](0x2)+_0x52e0d0(0x125)),console[_0x52e0d0(0x143)](_0x52e0d0(0x157)+_0x1775e1['reduce']((_0x3f921a,_0x368598)=>_0x3f921a+_0x368598[_0x52e0d0(0x1ef)],0x0)[_0x52e0d0(0x1df)](0x2)+_0x52e0d0(0x210)),console[_0x52e0d0(0x143)](_0x52e0d0(0x1a6)+_0x16da96[_0x52e0d0(0x1df)](0x2)+'\x20USDT\x20(after\x20payouts)'),{'id':_0x89fa31['id'],'fullName':_0x89fa31[_0x52e0d0(0x1f8)],'username':_0x89fa31[_0x52e0d0(0x201)],'telegramId':_0x89fa31[_0x52e0d0(0x16b)],'merchantUrl':_0x89fa31['shopUrl'],'wallets':{'usdtPolygonWallet':_0x89fa31[_0x52e0d0(0xfa)],'usdtTrcWallet':_0x89fa31[_0x52e0d0(0x135)],'usdtErcWallet':_0x89fa31[_0x52e0d0(0x1cc)],'usdcPolygonWallet':_0x89fa31[_0x52e0d0(0x1a2)]},'totalAmountUSDT':Math[_0x52e0d0(0x1ff)](_0xda6275*0x64)/0x64,'totalAmountAfterCommissionUSDT':Math[_0x52e0d0(0x1ff)](_0x16da96*0x64)/0x64,'totalPayout':Math[_0x52e0d0(0x1ff)](_0x2f6c6c*0x64)/0x64,'thisMonth':Math[_0x52e0d0(0x1ff)](_0x480ba9*0x64)/0x64,'paymentsCount':_0x41fc49,'oldestPaymentDate':_0x2ade2a?.['paidAt']||_0x89fa31[_0x52e0d0(0x10d)],'gatewayBreakdown':_0x1775e1};})),_0x42413e=_0x3e773c[_0x24d66a(0x158)]((_0xf031c0,_0x51acaf)=>_0xf031c0+_0x51acaf[_0x24d66a(0x1b3)],0x0),_0x105f32=_0x3e773c['reduce']((_0x45e47b,_0x1c0634)=>_0x45e47b+_0x1c0634[_0x24d66a(0xf6)],0x0),_0x4f3fde=_0x3e773c[_0x24d66a(0x158)]((_0x369626,_0x3bf435)=>_0x369626+_0x3bf435[_0x24d66a(0x1c0)],0x0),_0x196d53=_0x3e773c[_0x24d66a(0x158)]((_0x24c854,_0x31207f)=>_0x24c854+_0x31207f['thisMonth'],0x0);return console[_0x24d66a(0x143)](_0x24d66a(0xf0)+_0x2ff68b+_0x24d66a(0x117)),console['log'](_0x24d66a(0x138)+Math[_0x24d66a(0x1ff)](_0x42413e*0x64)/0x64+_0x24d66a(0x125)),console['log']('\x20\x20\x20‚úÖ\x20Total\x20available\x20for\x20payout:\x20'+Math[_0x24d66a(0x1ff)](_0x105f32*0x64)/0x64+_0x24d66a(0x165)),console[_0x24d66a(0x143)](_0x24d66a(0x140)+Math[_0x24d66a(0x1ff)](_0x4f3fde*0x64)/0x64+'\x20USDT'),console[_0x24d66a(0x143)]('\x20\x20\x20üìÖ\x20Total\x20payouts\x20(this\x20month):\x20'+Math[_0x24d66a(0x1ff)](_0x196d53*0x64)/0x64+'\x20USDT'),{'merchants':_0x3e773c,'pagination':{'page':_0x25cd70,'limit':_0x78ef04,'total':_0x2ff68b,'totalPages':Math[_0x24d66a(0x1e8)](_0x2ff68b/_0x78ef04)},'summary':{'totalMerchants':_0x2ff68b,'totalAmountUSDT':Math[_0x24d66a(0x1ff)](_0x42413e*0x64)/0x64,'totalAmountAfterCommissionUSDT':Math[_0x24d66a(0x1ff)](_0x105f32*0x64)/0x64,'totalPayout':Math['round'](_0x4f3fde*0x64)/0x64,'thisMonth':Math[_0x24d66a(0x1ff)](_0x196d53*0x64)/0x64}};}async[a36_0x2d55f5(0x112)](_0x536370){const _0x2e8a4c=a36_0x2d55f5,{shopId:_0x549b26,amount:_0x4f7987,network:_0x44891c,wallet:_0x1c1043,notes:_0x40ffcf,txid:_0x5dbc30,periodFrom:_0x3dbe55,periodTo:_0x4e0f74}=_0x536370,_0x5f134d=await database_1[_0x2e8a4c(0x204)]['$transaction'](async _0x145b6a=>{const _0x5d49c3=_0x2e8a4c,_0x10bacb=await _0x145b6a[_0x5d49c3(0x111)][_0x5d49c3(0x110)]({'where':{'id':_0x549b26},'select':{'id':!![],'name':!![],'username':!![],'balance':!![],'totalPaidOut':!![]}});if(!_0x10bacb)throw new Error('Shop\x20not\x20found');console[_0x5d49c3(0x143)](_0x5d49c3(0x1aa)+_0x10bacb[_0x5d49c3(0x201)]+':'),console['log'](_0x5d49c3(0x14f)+_0x10bacb['balance']['toFixed'](0x6)+_0x5d49c3(0x136)),console['log'](_0x5d49c3(0xf7)+_0x4f7987['toFixed'](0x6)+'\x20USDT'),console[_0x5d49c3(0x143)]('\x20\x20\x20Current\x20total\x20paid\x20out:\x20'+_0x10bacb['totalPaidOut'][_0x5d49c3(0x1df)](0x6)+_0x5d49c3(0x136));if(_0x5dbc30)console[_0x5d49c3(0x143)](_0x5d49c3(0x17b)+_0x5dbc30);if(_0x10bacb[_0x5d49c3(0x142)]<_0x4f7987)throw new Error(_0x5d49c3(0x17f)+_0x10bacb[_0x5d49c3(0x142)][_0x5d49c3(0x1df)](0x6)+_0x5d49c3(0x1c4)+_0x4f7987['toFixed'](0x6)+'\x20USDT');let _0x313c1b=_0x1c1043;if(!_0x313c1b){const _0x3d0d4d=await _0x145b6a[_0x5d49c3(0x111)][_0x5d49c3(0x110)]({'where':{'id':_0x549b26},'select':{'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![]}});if(_0x3d0d4d)switch(_0x44891c){case _0x5d49c3(0xef):_0x313c1b=_0x3d0d4d['usdtPolygonWallet']||undefined;break;case _0x5d49c3(0x1b5):_0x313c1b=_0x3d0d4d['usdtTrcWallet']||undefined;break;case _0x5d49c3(0x1f6):_0x313c1b=_0x3d0d4d[_0x5d49c3(0x1cc)]||undefined;break;case _0x5d49c3(0x1f0):_0x313c1b=_0x3d0d4d[_0x5d49c3(0x1a2)]||undefined;break;}}console['log']('üí≥\x20Payout\x20wallet\x20for\x20'+_0x44891c+':\x20'+(_0x313c1b||_0x5d49c3(0x192)));const _0x5e175a=await _0x145b6a[_0x5d49c3(0x166)][_0x5d49c3(0x139)]({'data':{'shopId':_0x549b26,'amount':_0x4f7987,'network':_0x44891c,'status':_0x5d49c3(0x187),'txid':_0x5dbc30,'notes':_0x40ffcf,'periodFrom':_0x3dbe55?new Date(_0x3dbe55):null,'periodTo':_0x4e0f74?new Date(_0x4e0f74):null,'createdAt':new Date(),'paidAt':new Date()}}),_0x2f7861=_0x10bacb[_0x5d49c3(0x142)]-_0x4f7987,_0x33f7cb=_0x10bacb[_0x5d49c3(0x1d0)]+_0x4f7987;return await _0x145b6a[_0x5d49c3(0x111)][_0x5d49c3(0x16a)]({'where':{'id':_0x549b26},'data':{'balance':_0x2f7861,'totalPaidOut':_0x33f7cb}}),console['log'](_0x5d49c3(0x1c8)+_0x10bacb[_0x5d49c3(0x201)]+_0x5d49c3(0x16c)),console[_0x5d49c3(0x143)](_0x5d49c3(0x12d)+_0x10bacb[_0x5d49c3(0x142)][_0x5d49c3(0x1df)](0x6)+_0x5d49c3(0x18e)+_0x2f7861[_0x5d49c3(0x1df)](0x6)+_0x5d49c3(0x11c)+_0x4f7987[_0x5d49c3(0x1df)](0x6)+')'),console[_0x5d49c3(0x143)](_0x5d49c3(0x103)+_0x10bacb[_0x5d49c3(0x1d0)][_0x5d49c3(0x1df)](0x6)+_0x5d49c3(0x18e)+_0x33f7cb[_0x5d49c3(0x1df)](0x6)+_0x5d49c3(0x1eb)+_0x4f7987[_0x5d49c3(0x1df)](0x6)+')'),{'payout':_0x5e175a,'shop':_0x10bacb};});return console[_0x2e8a4c(0x143)](_0x2e8a4c(0x114)+_0x5f134d[_0x2e8a4c(0x166)]['id']+'\x20for\x20shop\x20'+_0x5f134d['shop'][_0x2e8a4c(0x201)]+'\x20('+_0x4f7987+_0x2e8a4c(0x19d)),{'id':_0x5f134d[_0x2e8a4c(0x166)]['id'],'shopId':_0x5f134d[_0x2e8a4c(0x166)][_0x2e8a4c(0x1c5)],'shopName':_0x5f134d[_0x2e8a4c(0x111)][_0x2e8a4c(0x1f8)],'shopUsername':_0x5f134d['shop']['username'],'amount':_0x5f134d[_0x2e8a4c(0x166)][_0x2e8a4c(0x1cf)],'network':_0x5f134d[_0x2e8a4c(0x166)]['network'],'status':_0x5f134d[_0x2e8a4c(0x166)][_0x2e8a4c(0x1ab)],'txid':_0x5f134d[_0x2e8a4c(0x166)][_0x2e8a4c(0x20f)],'notes':_0x5f134d[_0x2e8a4c(0x166)][_0x2e8a4c(0x1a4)],'periodFrom':_0x5f134d[_0x2e8a4c(0x166)][_0x2e8a4c(0x18f)],'periodTo':_0x5f134d[_0x2e8a4c(0x166)][_0x2e8a4c(0x1c7)],'createdAt':_0x5f134d['payout'][_0x2e8a4c(0x10d)],'paidAt':_0x5f134d[_0x2e8a4c(0x166)][_0x2e8a4c(0xf3)]};}async[a36_0x2d55f5(0x1e6)](_0xae50e5){const _0x22812f=a36_0x2d55f5,{page:_0xfdf279,limit:_0x5b40d7,shopId:_0x4327ad,network:_0x47e9f5,dateFrom:_0x2e4e55,dateTo:_0x5f1371,search:_0xf5494c}=_0xae50e5,_0x47bfa8=(_0xfdf279-0x1)*_0x5b40d7,_0x15e7ba={};_0x4327ad&&(_0x15e7ba[_0x22812f(0x1c5)]=_0x4327ad);_0x47e9f5&&(_0x15e7ba['network']=_0x47e9f5);(_0x2e4e55||_0x5f1371)&&(_0x15e7ba['createdAt']={},_0x2e4e55&&(_0x15e7ba[_0x22812f(0x10d)][_0x22812f(0xf5)]=new Date(_0x2e4e55)),_0x5f1371&&(_0x15e7ba[_0x22812f(0x10d)]['lte']=new Date(_0x5f1371)));_0xf5494c&&(_0x15e7ba['OR']=[{'shop':{'name':{'contains':_0xf5494c,'mode':_0x22812f(0x197)}}},{'shop':{'username':{'contains':_0xf5494c,'mode':'insensitive'}}},{'notes':{'contains':_0xf5494c,'mode':'insensitive'}}]);const [_0x5f5d4e,_0x55ca23]=await Promise[_0x22812f(0xfd)]([database_1[_0x22812f(0x204)][_0x22812f(0x166)][_0x22812f(0x1ba)]({'where':_0x15e7ba,'skip':_0x47bfa8,'take':_0x5b40d7,'orderBy':{'createdAt':_0x22812f(0x11b)},'select':{'id':!![],'shopId':!![],'amount':!![],'network':!![],'status':!![],'txid':!![],'notes':!![],'periodFrom':!![],'periodTo':!![],'createdAt':!![],'paidAt':!![],'shop':{'select':{'name':!![],'username':!![]}}}}),database_1[_0x22812f(0x204)]['payout'][_0x22812f(0x17e)]({'where':_0x15e7ba})]);return{'payouts':_0x5f5d4e[_0x22812f(0x162)](_0x3b6cd1=>({'id':_0x3b6cd1['id'],'shopId':_0x3b6cd1[_0x22812f(0x1c5)],'shopName':_0x3b6cd1[_0x22812f(0x111)][_0x22812f(0x1f8)],'shopUsername':_0x3b6cd1['shop'][_0x22812f(0x201)],'amount':_0x3b6cd1[_0x22812f(0x1cf)],'network':_0x3b6cd1[_0x22812f(0x1a5)],'status':_0x3b6cd1[_0x22812f(0x1ab)],'txid':_0x3b6cd1[_0x22812f(0x20f)],'notes':_0x3b6cd1[_0x22812f(0x1a4)],'periodFrom':_0x3b6cd1[_0x22812f(0x18f)],'periodTo':_0x3b6cd1['periodTo'],'createdAt':_0x3b6cd1['createdAt'],'paidAt':_0x3b6cd1['paidAt']})),'pagination':{'page':_0xfdf279,'limit':_0x5b40d7,'total':_0x55ca23,'totalPages':Math[_0x22812f(0x1e8)](_0x55ca23/_0x5b40d7)}};}async['getPayoutById'](_0x18b79d){const _0x2913b9=a36_0x2d55f5,_0x2a4e98=await database_1[_0x2913b9(0x204)][_0x2913b9(0x166)][_0x2913b9(0x110)]({'where':{'id':_0x18b79d},'include':{'shop':{'select':{'name':!![],'username':!![]}}}});if(!_0x2a4e98)return null;return{'id':_0x2a4e98['id'],'shopId':_0x2a4e98[_0x2913b9(0x1c5)],'shopName':_0x2a4e98[_0x2913b9(0x111)][_0x2913b9(0x1f8)],'shopUsername':_0x2a4e98[_0x2913b9(0x111)][_0x2913b9(0x201)],'amount':_0x2a4e98['amount'],'network':_0x2a4e98[_0x2913b9(0x1a5)],'status':_0x2a4e98[_0x2913b9(0x1ab)],'txid':_0x2a4e98[_0x2913b9(0x20f)],'notes':_0x2a4e98[_0x2913b9(0x1a4)],'periodFrom':_0x2a4e98[_0x2913b9(0x18f)],'periodTo':_0x2a4e98[_0x2913b9(0x1c7)],'createdAt':_0x2a4e98['createdAt'],'paidAt':_0x2a4e98[_0x2913b9(0xf3)]};}async[a36_0x2d55f5(0x1c3)](_0x45efdb){const _0x1243bf=a36_0x2d55f5;await database_1['default'][_0x1243bf(0x166)][_0x1243bf(0xee)]({'where':{'id':_0x45efdb}});}async['getAllPayments'](_0x420a83){const _0x276839=a36_0x2d55f5,{page:_0x538204,limit:_0x29c7c0,status:_0x5cc54c,gateway:_0x1024f0,shopId:_0x21b252,dateFrom:_0x309ffd,dateTo:_0x85470c,search:_0x482f1f,currency:_0x2eda89,sortBy:_0x33e8f6,sortOrder:_0x352c78}=_0x420a83,_0x6b247e=(_0x538204-0x1)*_0x29c7c0;console[_0x276839(0x143)](_0x276839(0x172),_0x420a83);const _0x80f1c3=await database_1[_0x276839(0x204)]['payment'][_0x276839(0x219)]({'by':[_0x276839(0x18a)],'_count':{'gateway':!![]}});console[_0x276839(0x143)]('üìä\x20Available\x20gateways\x20in\x20database:',_0x80f1c3[_0x276839(0x162)](_0x33e92f=>_0x33e92f[_0x276839(0x18a)]+'\x20('+_0x33e92f['_count'][_0x276839(0x18a)]+'\x20payments)'));if(_0x1024f0){const _0x40cbf2=_0x80f1c3[_0x276839(0x205)](_0x2c3a68=>_0x2c3a68['gateway'][_0x276839(0x183)]()===_0x1024f0[_0x276839(0x183)]());!_0x40cbf2&&_0x1024f0[_0x276839(0x183)]()!==_0x276839(0x174)&&console[_0x276839(0x143)]('‚ö†Ô∏è\x20Requested\x20gateway\x20\x27'+_0x1024f0+_0x276839(0x1b1)+_0x80f1c3['map'](_0x4f17ad=>_0x4f17ad[_0x276839(0x18a)])[_0x276839(0x20d)](',\x20'));}const _0x1161e1={};_0x5cc54c&&(_0x1161e1[_0x276839(0x1ab)]=_0x5cc54c['toUpperCase']());if(!_0x1024f0)_0x1161e1[_0x276839(0x18a)]={'not':_0x276839(0x174)};else{if(_0x1024f0&&(_0x1024f0['toLowerCase']()==='test_gateway'||_0x1024f0===_0x276839(0x13c)))_0x1161e1['gateway']=_0x276839(0x174);else{let _0x20e5e2=_0x1024f0;const _0x2381ce=(0x0,gateway_1[_0x276839(0x14a)])(_0x1024f0);if(_0x2381ce)_0x20e5e2=_0x2381ce,console[_0x276839(0x143)](_0x276839(0x217)+_0x1024f0+_0x276839(0x141)+_0x20e5e2+'\x27');else{const _0x1b19ab=(0x0,gateway_1['getGatewayIdByName'])(_0x1024f0);if(_0x1b19ab){const _0x1b2285=(0x0,gateway_1[_0x276839(0x14a)])(_0x1b19ab);_0x1b2285&&(_0x20e5e2=_0x1b2285,console[_0x276839(0x143)](_0x276839(0x1e5)+_0x1024f0+'\x27\x20->\x20ID\x20\x27'+_0x1b19ab+_0x276839(0xec)+_0x20e5e2+'\x27'));}else console[_0x276839(0x143)]('üîç\x20Using\x20gateway\x20\x27'+_0x1024f0+_0x276839(0x123));}const _0x113073=await database_1['default'][_0x276839(0x1ac)][_0x276839(0x17e)]({'where':{'gateway':_0x20e5e2[_0x276839(0x183)]()},'take':0x1});_0x113073===0x0?(console[_0x276839(0x143)](_0x276839(0x1af)+_0x20e5e2+_0x276839(0x1fe)+_0x1024f0+_0x276839(0x12b)),_0x1161e1['gateway']=_0x276839(0x209)):(_0x1161e1[_0x276839(0x18a)]=_0x20e5e2[_0x276839(0x183)](),console[_0x276839(0x143)]('‚úÖ\x20Using\x20gateway\x20filter:\x20\x27'+_0x20e5e2+_0x276839(0x1fe)+_0x1024f0+'\x27)'));}}console['log'](_0x276839(0x159),_0x1161e1['gateway']);_0x21b252&&(_0x1161e1['shopId']=_0x21b252);_0x2eda89&&(_0x1161e1[_0x276839(0x196)]=_0x2eda89[_0x276839(0xf9)](),console[_0x276839(0x143)]('üí±\x20Currency\x20filter\x20applied:\x20'+_0x2eda89[_0x276839(0xf9)]()));(_0x309ffd||_0x85470c)&&(_0x1161e1['createdAt']={},_0x309ffd&&(_0x1161e1[_0x276839(0x10d)][_0x276839(0xf5)]=new Date(_0x309ffd)),_0x85470c&&(_0x1161e1[_0x276839(0x10d)][_0x276839(0x148)]=new Date(_0x85470c)));_0x482f1f&&(_0x1161e1['OR']=[{'id':{'contains':_0x482f1f,'mode':_0x276839(0x197)}},{'orderId':{'contains':_0x482f1f,'mode':'insensitive'}},{'gatewayOrderId':{'contains':_0x482f1f,'mode':'insensitive'}},{'customerEmail':{'contains':_0x482f1f,'mode':_0x276839(0x197)}},{'shop':{'name':{'contains':_0x482f1f,'mode':'insensitive'}}},{'shop':{'username':{'contains':_0x482f1f,'mode':'insensitive'}}}]);console['log'](_0x276839(0x225),JSON[_0x276839(0x1bd)](_0x1161e1,null,0x2));let _0x3d6e87={'createdAt':_0x276839(0x11b)};if(_0x33e8f6){const _0x2f7d83=[_0x276839(0x1cf),_0x276839(0x10d),_0x276839(0x127),_0x276839(0x1ab),_0x276839(0x18a),'currency'],_0x1ddb71=[_0x276839(0x11a),_0x276839(0x11b)];if(_0x2f7d83[_0x276839(0x216)](_0x33e8f6)){const _0x540012=_0x1ddb71[_0x276839(0x216)](_0x352c78)?_0x352c78:_0x276839(0x11b);_0x3d6e87={[_0x33e8f6]:_0x540012},console[_0x276839(0x143)](_0x276839(0x12a)+_0x33e8f6+'\x20in\x20'+_0x540012+_0x276839(0x189));}}const [_0x47630a,_0x56fb76]=await Promise['all']([database_1[_0x276839(0x204)][_0x276839(0x1ac)]['findMany']({'where':_0x1161e1,'skip':_0x6b247e,'take':_0x29c7c0,'orderBy':_0x3d6e87,'select':{'id':!![],'shopId':!![],'amount':!![],'amountAfterGatewayCommissionUSDT':!![],'currency':!![],'sourceCurrency':!![],'status':!![],'gateway':!![],'orderId':!![],'gatewayOrderId':!![],'gatewayPaymentId':!![],'customerEmail':!![],'customerName':!![],'customerCountry':!![],'customerIp':!![],'customerUa':!![],'externalPaymentUrl':!![],'successUrl':!![],'failUrl':!![],'pendingUrl':!![],'whiteUrl':!![],'expiresAt':!![],'invoiceTotalSum':!![],'qrCode':!![],'qrUrl':!![],'country':!![],'language':!![],'amountIsEditable':!![],'maxPayments':!![],'rapydCustomer':!![],'cardLast4':!![],'paymentMethod':!![],'bankId':!![],'remitterIban':!![],'remitterName':!![],'failureMessage':!![],'usage':!![],'createdAt':!![],'updatedAt':!![],'shop':{'select':{'name':!![],'username':!![]}}}}),database_1[_0x276839(0x204)][_0x276839(0x1ac)][_0x276839(0x17e)]({'where':_0x1161e1})]);return{'payments':_0x47630a,'pagination':{'page':_0x538204,'limit':_0x29c7c0,'total':_0x56fb76,'totalPages':Math['ceil'](_0x56fb76/_0x29c7c0)}};}async[a36_0x2d55f5(0x1ad)](_0x4df7a8){const _0x18bd25=a36_0x2d55f5,_0x26cd3f=await database_1['default'][_0x18bd25(0x1ac)][_0x18bd25(0x110)]({'where':{'id':_0x4df7a8},'select':{'id':!![],'shopId':!![],'amount':!![],'amountAfterGatewayCommissionUSDT':!![],'currency':!![],'sourceCurrency':!![],'status':!![],'gateway':!![],'orderId':!![],'gatewayOrderId':!![],'gatewayPaymentId':!![],'customerEmail':!![],'customerName':!![],'customerCountry':!![],'customerIp':!![],'customerUa':!![],'externalPaymentUrl':!![],'successUrl':!![],'failUrl':!![],'pendingUrl':!![],'whiteUrl':!![],'expiresAt':!![],'invoiceTotalSum':!![],'qrCode':!![],'qrUrl':!![],'country':!![],'language':!![],'amountIsEditable':!![],'maxPayments':!![],'rapydCustomer':!![],'cardLast4':!![],'paymentMethod':!![],'bankId':!![],'remitterIban':!![],'remitterName':!![],'failureMessage':!![],'usage':!![],'createdAt':!![],'updatedAt':!![],'shop':{'select':{'name':!![],'username':!![]}}}});if(!_0x26cd3f)return null;return{'id':_0x26cd3f['id'],'shopId':_0x26cd3f[_0x18bd25(0x1c5)],'gateway':_0x26cd3f[_0x18bd25(0x18a)],'amount':_0x26cd3f['amount'],'currency':_0x26cd3f[_0x18bd25(0x196)],'status':_0x26cd3f['status'],'orderId':_0x26cd3f[_0x18bd25(0x1b4)],'gatewayOrderId':_0x26cd3f[_0x18bd25(0x10a)],'customerEmail':_0x26cd3f[_0x18bd25(0x109)],'customerName':_0x26cd3f[_0x18bd25(0x106)],'customerCountry':_0x26cd3f['customerCountry'],'customerIp':_0x26cd3f[_0x18bd25(0x19f)],'customerUa':_0x26cd3f[_0x18bd25(0x14e)],'failureMessage':_0x26cd3f[_0x18bd25(0x154)],'externalPaymentUrl':_0x26cd3f['externalPaymentUrl'],'successUrl':_0x26cd3f['successUrl'],'failUrl':_0x26cd3f['failUrl'],'pendingUrl':_0x26cd3f[_0x18bd25(0x13b)],'whiteUrl':_0x26cd3f[_0x18bd25(0x104)],'createdAt':_0x26cd3f[_0x18bd25(0x10d)],'updatedAt':_0x26cd3f['updatedAt'],'shop':_0x26cd3f[_0x18bd25(0x111)]};}async[a36_0x2d55f5(0x10e)](_0x147dbd,_0x541908,_0x1b3eed,_0x4ec825){const _0x4e3f13=a36_0x2d55f5,_0x1f791d=await database_1[_0x4e3f13(0x204)][_0x4e3f13(0x1da)](async _0x549cd9=>{const _0x44c1b8=_0x4e3f13,_0x3a7607=await _0x549cd9[_0x44c1b8(0x1ac)][_0x44c1b8(0x110)]({'where':{'id':_0x147dbd},'include':{'shop':{'select':{'id':!![],'name':!![],'username':!![],'balance':!![]}}}});if(!_0x3a7607)throw new Error(_0x44c1b8(0x203));const _0x117609=_0x3a7607['status'],_0x4dc105=_0x541908['toUpperCase']();console['log'](_0x44c1b8(0x18c)+_0x147dbd+'\x20status:\x20'+_0x117609+_0x44c1b8(0x18e)+_0x4dc105),console[_0x44c1b8(0x143)](_0x44c1b8(0x13f)+_0x3a7607['shop'][_0x44c1b8(0x142)]+_0x44c1b8(0x136));const _0x33d4d9={'status':_0x4dc105,'updatedAt':new Date(),'statusChangedBy':_0x44c1b8(0x20a),'statusChangedAt':new Date()};_0x1b3eed&&(_0x33d4d9[_0x44c1b8(0x11d)]=_0x1b3eed);_0x4dc105===_0x44c1b8(0x1d2)&&_0x4ec825&&(_0x33d4d9[_0x44c1b8(0x12e)]=_0x4ec825);let _0x47c89e=0x0,_0x18602a=_0x3a7607[_0x44c1b8(0x111)]['balance'];if(_0x4dc105===_0x44c1b8(0x15f)&&_0x117609!=='PAID'){_0x33d4d9['paidAt']=new Date();const _0x2fbf4d=await currencyService_1['currencyService']['convertToUSDT'](_0x3a7607[_0x44c1b8(0x1cf)],_0x3a7607[_0x44c1b8(0x196)]);_0x33d4d9[_0x44c1b8(0x153)]=_0x2fbf4d;let _0x5a1846=0xa;const _0x53caac=await _0x549cd9[_0x44c1b8(0x111)][_0x44c1b8(0x110)]({'where':{'id':_0x3a7607[_0x44c1b8(0x1c5)]},'select':{'gatewaySettings':!![]}});if(_0x53caac?.[_0x44c1b8(0x21d)])try{const _0x468101=JSON['parse'](_0x53caac['gatewaySettings']);for(const [_0x3c0a53,_0x1dfc8e]of Object[_0x44c1b8(0x190)](_0x468101)){if(_0x3c0a53['toLowerCase']()===_0x3a7607[_0x44c1b8(0x18a)][_0x44c1b8(0x183)]()){_0x5a1846=_0x1dfc8e[_0x44c1b8(0x10c)]||0xa;break;}}}catch(_0x165c48){console['error'](_0x44c1b8(0x1e0)+_0x147dbd+':',_0x165c48);}let _0x34feb4;_0x3a7607[_0x44c1b8(0x15a)]!==null&&_0x3a7607[_0x44c1b8(0x15a)]!==undefined?(_0x34feb4=_0x3a7607[_0x44c1b8(0x15a)],console[_0x44c1b8(0x143)]('üìä\x20[ADMIN]\x20Using\x20saved\x20amountAfterGatewayCommissionUSDT:\x20'+_0x34feb4[_0x44c1b8(0x1df)](0x6)+_0x44c1b8(0x1b9)+_0x147dbd)):(_0x34feb4=_0x2fbf4d*(0x1-_0x5a1846/0x64),console[_0x44c1b8(0x143)](_0x44c1b8(0x184)+_0x147dbd+':\x20'+_0x5a1846+_0x44c1b8(0x13d)+_0x2fbf4d[_0x44c1b8(0x1df)](0x6)+_0x44c1b8(0x136)),_0x33d4d9[_0x44c1b8(0x15a)]=_0x34feb4),_0x47c89e=_0x34feb4,_0x18602a+=_0x34feb4,console[_0x44c1b8(0x143)](_0x44c1b8(0x1f2)+_0x147dbd+'\x20became\x20PAID:'),console[_0x44c1b8(0x143)](_0x44c1b8(0x126)+_0x2fbf4d[_0x44c1b8(0x1df)](0x6)+_0x44c1b8(0x136)),console[_0x44c1b8(0x143)](_0x44c1b8(0x128)+_0x3a7607[_0x44c1b8(0x18a)]+_0x44c1b8(0x20b)+_0x5a1846+'%'),console['log']('\x20\x20\x20Merchant\x20gets:\x20'+_0x34feb4[_0x44c1b8(0x1df)](0x6)+_0x44c1b8(0x130)+_0x5a1846+_0x44c1b8(0x10b)),console[_0x44c1b8(0x143)](_0x44c1b8(0xf2)+_0x34feb4[_0x44c1b8(0x1df)](0x6)+_0x44c1b8(0x136));}else{if(_0x117609===_0x44c1b8(0x15f)&&_0x4dc105!==_0x44c1b8(0x15f)){if(_0x3a7607[_0x44c1b8(0x153)]){let _0x2bc304=0xa;const _0x16d1ef=await _0x549cd9[_0x44c1b8(0x111)][_0x44c1b8(0x110)]({'where':{'id':_0x3a7607[_0x44c1b8(0x1c5)]},'select':{'gatewaySettings':!![]}});if(_0x16d1ef?.[_0x44c1b8(0x21d)])try{const _0x41a1e4=JSON[_0x44c1b8(0x122)](_0x16d1ef[_0x44c1b8(0x21d)]);for(const [_0x20e96c,_0xb45700]of Object[_0x44c1b8(0x190)](_0x41a1e4)){if(_0x20e96c['toLowerCase']()===_0x3a7607[_0x44c1b8(0x18a)]['toLowerCase']()){_0x2bc304=_0xb45700[_0x44c1b8(0x10c)]||0xa;break;}}}catch(_0x2aadf6){console[_0x44c1b8(0x1c6)](_0x44c1b8(0x1e0)+_0x147dbd+':',_0x2aadf6);}const _0x322c32=_0x3a7607[_0x44c1b8(0x153)]*(0x1-_0x2bc304/0x64);_0x47c89e=-_0x322c32,_0x18602a-=_0x322c32,_0x33d4d9['amountUSDT']=null,_0x33d4d9['amountAfterGatewayCommissionUSDT']=null,console['log']('üí∞\x20Payment\x20'+_0x147dbd+_0x44c1b8(0x147)),console[_0x44c1b8(0x143)](_0x44c1b8(0x126)+_0x3a7607[_0x44c1b8(0x153)][_0x44c1b8(0x1df)](0x6)+_0x44c1b8(0x136)),console[_0x44c1b8(0x143)]('\x20\x20\x20Gateway:\x20'+_0x3a7607['gateway']+_0x44c1b8(0x20b)+_0x2bc304+'%'),console['log']('\x20\x20\x20Merchant\x20loses:\x20'+_0x322c32[_0x44c1b8(0x1df)](0x6)+_0x44c1b8(0x130)+_0x2bc304+_0x44c1b8(0x10b)),console[_0x44c1b8(0x143)](_0x44c1b8(0x218)+_0x322c32[_0x44c1b8(0x1df)](0x6)+_0x44c1b8(0x136));}}}_0x4dc105===_0x44c1b8(0x1d2)&&(_0x117609===_0x44c1b8(0x15f)&&_0x3a7607['amountUSDT']&&console[_0x44c1b8(0x143)](_0x44c1b8(0x1ed)),_0x4ec825&&_0x4ec825>0x0&&(_0x47c89e-=_0x4ec825,_0x18602a-=_0x4ec825,console[_0x44c1b8(0x143)](_0x44c1b8(0xed)+_0x4ec825['toFixed'](0x6)+'\x20USDT\x20from\x20balance')));_0x4dc105===_0x44c1b8(0x11e)&&_0x117609===_0x44c1b8(0x15f)&&console[_0x44c1b8(0x143)](_0x44c1b8(0x14b));const _0x3efb84=await _0x549cd9['payment'][_0x44c1b8(0x16a)]({'where':{'id':_0x147dbd},'data':_0x33d4d9,'include':{'shop':{'select':{'name':!![],'username':!![]}}}});return _0x47c89e!==0x0&&(await _0x549cd9[_0x44c1b8(0x111)][_0x44c1b8(0x16a)]({'where':{'id':_0x3a7607['shopId']},'data':{'balance':_0x18602a}}),console['log'](_0x44c1b8(0x1c8)+_0x3a7607[_0x44c1b8(0x1c5)]+_0x44c1b8(0x176)+_0x3a7607[_0x44c1b8(0x111)][_0x44c1b8(0x142)]['toFixed'](0x6)+'\x20->\x20'+_0x18602a[_0x44c1b8(0x1df)](0x6)+_0x44c1b8(0x16e)+(_0x47c89e>0x0?'+':'')+_0x47c89e[_0x44c1b8(0x1df)](0x6)+')')),_0x3efb84;});return{'id':_0x1f791d['id'],'shopId':_0x1f791d[_0x4e3f13(0x1c5)],'gateway':_0x1f791d[_0x4e3f13(0x18a)],'amount':_0x1f791d[_0x4e3f13(0x1cf)],'currency':_0x1f791d[_0x4e3f13(0x196)],'status':_0x1f791d[_0x4e3f13(0x1ab)],'orderId':_0x1f791d[_0x4e3f13(0x1b4)],'gatewayOrderId':_0x1f791d[_0x4e3f13(0x10a)],'customerEmail':_0x1f791d['customerEmail'],'customerName':_0x1f791d[_0x4e3f13(0x106)],'customerCountry':_0x1f791d[_0x4e3f13(0x224)],'customerIp':_0x1f791d['customerIp'],'customerUa':_0x1f791d['customerUa'],'failureMessage':_0x1f791d[_0x4e3f13(0x154)],'adminNotes':_0x1f791d[_0x4e3f13(0x11d)],'chargebackAmount':_0x1f791d[_0x4e3f13(0x12e)],'statusChangedBy':_0x1f791d[_0x4e3f13(0x18d)],'statusChangedAt':_0x1f791d[_0x4e3f13(0x208)],'createdAt':_0x1f791d['createdAt'],'updatedAt':_0x1f791d[_0x4e3f13(0x127)],'shop':_0x1f791d[_0x4e3f13(0x111)]};}async[a36_0x2d55f5(0xfb)](_0x2da23c,_0x72a2bc){const _0x414fa4=a36_0x2d55f5,_0x225503=Math[_0x414fa4(0x171)]()['toString'](0x24)[_0x414fa4(0x145)](0x2,0x9);console['log'](_0x414fa4(0xff)+_0x225503+',\x20userId:\x20'+_0x2da23c);const _0x14f68b={..._0x72a2bc};_0x72a2bc[_0x414fa4(0x1d1)]&&_0x72a2bc['password'][_0x414fa4(0x115)]()!==''?(console[_0x414fa4(0x143)](_0x414fa4(0x1fc)+_0x225503+_0x414fa4(0x1fb)+_0x2da23c),_0x14f68b[_0x414fa4(0x1d1)]=await bcryptjs_1[_0x414fa4(0x204)]['hash'](_0x72a2bc[_0x414fa4(0x1d1)],0xc)):(console[_0x414fa4(0x143)](_0x414fa4(0x1fc)+_0x225503+_0x414fa4(0x1cd)),delete _0x14f68b[_0x414fa4(0x1d1)]);_0x72a2bc[_0x414fa4(0x1de)]&&(_0x14f68b['name']=_0x72a2bc[_0x414fa4(0x1de)],delete _0x14f68b[_0x414fa4(0x1de)]);_0x72a2bc['telegramId']&&(_0x14f68b['telegram']=_0x72a2bc[_0x414fa4(0x19c)],delete _0x14f68b['telegramId']);_0x72a2bc[_0x414fa4(0x13a)]&&(_0x14f68b[_0x414fa4(0x1db)]=_0x72a2bc[_0x414fa4(0x13a)],delete _0x14f68b[_0x414fa4(0x13a)]);if(_0x72a2bc['gateways']){const _0x3b6c8f=_0x72a2bc['gateways'][_0x414fa4(0x162)](_0x1a1250=>this[_0x414fa4(0x14c)](_0x1a1250));console[_0x414fa4(0x143)]('üîÑ\x20Gateway\x20mapping:',_0x72a2bc[_0x414fa4(0x1ea)],'->',_0x3b6c8f),_0x14f68b['paymentGateways']=JSON[_0x414fa4(0x1bd)](_0x3b6c8f),delete _0x14f68b['gateways'];}_0x72a2bc[_0x414fa4(0x21d)]&&(console[_0x414fa4(0x143)]('üîß\x20['+_0x225503+_0x414fa4(0x211),_0x72a2bc[_0x414fa4(0x21d)]),_0x14f68b[_0x414fa4(0x21d)]=JSON[_0x414fa4(0x1bd)](_0x72a2bc[_0x414fa4(0x21d)]),console['log'](_0x414fa4(0x17d)+_0x225503+_0x414fa4(0x179),_0x14f68b[_0x414fa4(0x21d)]));_0x72a2bc[_0x414fa4(0x100)]&&(_0x72a2bc[_0x414fa4(0x100)][_0x414fa4(0xfa)]!==undefined&&(_0x14f68b['usdtPolygonWallet']=_0x72a2bc[_0x414fa4(0x100)]['usdtPolygonWallet']||null),_0x72a2bc[_0x414fa4(0x100)]['usdtTrcWallet']!==undefined&&(_0x14f68b[_0x414fa4(0x135)]=_0x72a2bc[_0x414fa4(0x100)][_0x414fa4(0x135)]||null),_0x72a2bc['wallets'][_0x414fa4(0x1cc)]!==undefined&&(_0x14f68b[_0x414fa4(0x1cc)]=_0x72a2bc['wallets']['usdtErcWallet']||null),_0x72a2bc[_0x414fa4(0x100)]['usdcPolygonWallet']!==undefined&&(_0x14f68b[_0x414fa4(0x1a2)]=_0x72a2bc['wallets'][_0x414fa4(0x1a2)]||null),delete _0x14f68b[_0x414fa4(0x100)]);const _0x11bcd8=await database_1[_0x414fa4(0x204)][_0x414fa4(0x111)][_0x414fa4(0x16a)]({'where':{'id':_0x2da23c},'data':_0x14f68b,'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});return console[_0x414fa4(0x143)](_0x414fa4(0x21c)+_0x225503+']\x20User\x20updated,\x20gatewaySettings\x20from\x20DB:',_0x11bcd8['gatewaySettings']),{'id':_0x11bcd8['id'],'fullName':_0x11bcd8[_0x414fa4(0x1f8)],'username':_0x11bcd8[_0x414fa4(0x201)],'telegramId':_0x11bcd8[_0x414fa4(0x16b)],'merchantUrl':_0x11bcd8['shopUrl'],'gateways':_0x11bcd8[_0x414fa4(0x1a9)]?JSON[_0x414fa4(0x122)](_0x11bcd8[_0x414fa4(0x1a9)]):null,'gatewaySettings':_0x11bcd8[_0x414fa4(0x21d)]?JSON[_0x414fa4(0x122)](_0x11bcd8[_0x414fa4(0x21d)]):null,'publicKey':_0x11bcd8['publicKey'],'wallets':{'usdtPolygonWallet':_0x11bcd8[_0x414fa4(0xfa)],'usdtTrcWallet':_0x11bcd8[_0x414fa4(0x135)],'usdtErcWallet':_0x11bcd8[_0x414fa4(0x1cc)],'usdcPolygonWallet':_0x11bcd8[_0x414fa4(0x1a2)]},'status':_0x11bcd8['status'],'createdAt':_0x11bcd8[_0x414fa4(0x10d)]};}async[a36_0x2d55f5(0x167)](_0x18d6b0){const _0x32097a=a36_0x2d55f5,_0x27516d=await database_1[_0x32097a(0x204)][_0x32097a(0x111)][_0x32097a(0x16a)]({'where':{'id':_0x18d6b0},'data':{'status':'SUSPENDED'},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});return{'id':_0x27516d['id'],'fullName':_0x27516d[_0x32097a(0x1f8)],'username':_0x27516d[_0x32097a(0x201)],'telegramId':_0x27516d['telegram'],'merchantUrl':_0x27516d['shopUrl'],'gateways':_0x27516d['paymentGateways']?JSON[_0x32097a(0x122)](_0x27516d['paymentGateways']):null,'gatewaySettings':_0x27516d[_0x32097a(0x21d)]?JSON['parse'](_0x27516d[_0x32097a(0x21d)]):null,'publicKey':_0x27516d[_0x32097a(0x181)],'wallets':{'usdtPolygonWallet':_0x27516d[_0x32097a(0xfa)],'usdtTrcWallet':_0x27516d['usdtTrcWallet'],'usdtErcWallet':_0x27516d[_0x32097a(0x1cc)],'usdcPolygonWallet':_0x27516d[_0x32097a(0x1a2)]},'status':_0x27516d[_0x32097a(0x1ab)],'createdAt':_0x27516d[_0x32097a(0x10d)]};}async[a36_0x2d55f5(0x222)](_0x352795){const _0x420667=a36_0x2d55f5,_0x2749aa=await database_1[_0x420667(0x204)][_0x420667(0x111)][_0x420667(0x16a)]({'where':{'id':_0x352795},'data':{'status':_0x420667(0x105)},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});return{'id':_0x2749aa['id'],'fullName':_0x2749aa[_0x420667(0x1f8)],'username':_0x2749aa[_0x420667(0x201)],'telegramId':_0x2749aa['telegram'],'merchantUrl':_0x2749aa[_0x420667(0x1db)],'gateways':_0x2749aa[_0x420667(0x1a9)]?JSON[_0x420667(0x122)](_0x2749aa['paymentGateways']):null,'gatewaySettings':_0x2749aa[_0x420667(0x21d)]?JSON[_0x420667(0x122)](_0x2749aa['gatewaySettings']):null,'publicKey':_0x2749aa['publicKey'],'wallets':{'usdtPolygonWallet':_0x2749aa[_0x420667(0xfa)],'usdtTrcWallet':_0x2749aa[_0x420667(0x135)],'usdtErcWallet':_0x2749aa[_0x420667(0x1cc)],'usdcPolygonWallet':_0x2749aa[_0x420667(0x1a2)]},'status':_0x2749aa[_0x420667(0x1ab)],'createdAt':_0x2749aa[_0x420667(0x10d)]};}async[a36_0x2d55f5(0xfc)](_0x53f264){const _0x1502b1=a36_0x2d55f5,{page:_0x151bd0,limit:_0x196203,status:_0x2ec3ac}=_0x53f264,_0x349fd1=(_0x151bd0-0x1)*_0x196203,_0x45ae0f={};_0x2ec3ac&&(_0x45ae0f[_0x1502b1(0x1ab)]=_0x2ec3ac['toUpperCase']());const [_0x3e4783,_0x2908c1]=await Promise['all']([database_1['default'][_0x1502b1(0x111)]['findMany']({'where':_0x45ae0f,'skip':_0x349fd1,'take':_0x196203,'orderBy':{'createdAt':_0x1502b1(0x11b)},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}}),database_1[_0x1502b1(0x204)][_0x1502b1(0x111)][_0x1502b1(0x17e)]({'where':_0x45ae0f})]);return{'users':_0x3e4783[_0x1502b1(0x162)](_0x4d6e04=>{const _0x1b2c46=_0x1502b1,_0x367bf4=_0x4d6e04[_0x1b2c46(0x1a9)]?JSON[_0x1b2c46(0x122)](_0x4d6e04[_0x1b2c46(0x1a9)]):null,_0x1f7946=_0x367bf4?_0x367bf4[_0x1b2c46(0x162)](_0x4f6930=>this['getGatewayDisplayName'](_0x4f6930)):null;return{'id':_0x4d6e04['id'],'fullName':_0x4d6e04[_0x1b2c46(0x1f8)],'username':_0x4d6e04['username'],'telegramId':_0x4d6e04['telegram'],'merchantUrl':_0x4d6e04['shopUrl'],'gateways':_0x1f7946,'gatewaySettings':_0x4d6e04[_0x1b2c46(0x21d)]?JSON[_0x1b2c46(0x122)](_0x4d6e04[_0x1b2c46(0x21d)]):null,'publicKey':_0x4d6e04[_0x1b2c46(0x181)],'wallets':{'usdtPolygonWallet':_0x4d6e04[_0x1b2c46(0xfa)],'usdtTrcWallet':_0x4d6e04[_0x1b2c46(0x135)],'usdtErcWallet':_0x4d6e04['usdtErcWallet'],'usdcPolygonWallet':_0x4d6e04['usdcPolygonWallet']},'status':_0x4d6e04['status'],'createdAt':_0x4d6e04[_0x1b2c46(0x10d)]};}),'pagination':{'page':_0x151bd0,'limit':_0x196203,'total':_0x2908c1,'totalPages':Math[_0x1502b1(0x1e8)](_0x2908c1/_0x196203)}};}async[a36_0x2d55f5(0x170)](_0x59a8a2){const _0x4fa294=a36_0x2d55f5,_0x500ddc=await database_1[_0x4fa294(0x204)]['shop'][_0x4fa294(0x110)]({'where':{'id':_0x59a8a2},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});if(!_0x500ddc)return null;const _0x33a5a7=_0x500ddc[_0x4fa294(0x1a9)]?JSON['parse'](_0x500ddc['paymentGateways']):null,_0x559928=_0x33a5a7?_0x33a5a7[_0x4fa294(0x162)](_0x18130=>this[_0x4fa294(0x1e2)](_0x18130)):null;return _0x33a5a7&&_0x559928&&console[_0x4fa294(0x143)](_0x4fa294(0x1be),_0x33a5a7,'->',_0x559928),{'id':_0x500ddc['id'],'fullName':_0x500ddc[_0x4fa294(0x1f8)],'username':_0x500ddc[_0x4fa294(0x201)],'telegramId':_0x500ddc['telegram'],'merchantUrl':_0x500ddc['shopUrl'],'gateways':_0x559928,'gatewaySettings':_0x500ddc[_0x4fa294(0x21d)]?JSON[_0x4fa294(0x122)](_0x500ddc[_0x4fa294(0x21d)]):null,'publicKey':_0x500ddc['publicKey'],'wallets':{'usdtPolygonWallet':_0x500ddc[_0x4fa294(0xfa)],'usdtTrcWallet':_0x500ddc[_0x4fa294(0x135)],'usdtErcWallet':_0x500ddc[_0x4fa294(0x1cc)],'usdcPolygonWallet':_0x500ddc[_0x4fa294(0x1a2)]},'status':_0x500ddc[_0x4fa294(0x1ab)],'createdAt':_0x500ddc[_0x4fa294(0x10d)]};}async['createUser'](_0x4eac02){const _0x190c49=a36_0x2d55f5,{fullName:_0x25cc95,username:_0x1fc6c9,password:_0x3dd217,telegramId:_0x47a58f,merchantUrl:_0x595b28,gateways:_0x54d4ac,gatewaySettings:_0x6f35ca,wallets:_0x59f33}=_0x4eac02,_0x44e12b=await database_1[_0x190c49(0x204)][_0x190c49(0x111)]['findUnique']({'where':{'username':_0x1fc6c9}});if(_0x44e12b)throw new Error('Username\x20already\x20exists');if(_0x47a58f){const _0x5a1150=await database_1[_0x190c49(0x204)][_0x190c49(0x111)][_0x190c49(0x110)]({'where':{'telegram':_0x47a58f}});if(_0x5a1150)throw new Error(_0x190c49(0x12f));}const _0x346bfc=await bcryptjs_1[_0x190c49(0x204)]['hash'](_0x3dd217,0xc),_0x5369a3=_0x190c49(0x169)+crypto_1[_0x190c49(0x204)][_0x190c49(0x1e7)](0x20)[_0x190c49(0x1a0)](_0x190c49(0x21f)),_0x1ef818=_0x190c49(0x214)+crypto_1[_0x190c49(0x204)][_0x190c49(0x1e7)](0x20)[_0x190c49(0x1a0)](_0x190c49(0x21f)),_0x87d528=_0x54d4ac?_0x54d4ac[_0x190c49(0x162)](_0x3a8b37=>this[_0x190c49(0x14c)](_0x3a8b37)):null;_0x54d4ac&&_0x87d528&&console['log'](_0x190c49(0x1c2),_0x54d4ac,'->',_0x87d528);const _0x41b886=await database_1[_0x190c49(0x204)][_0x190c49(0x111)][_0x190c49(0x139)]({'data':{'name':_0x25cc95,'username':_0x1fc6c9,'password':_0x346bfc,'telegram':_0x47a58f,'shopUrl':_0x595b28,'paymentGateways':_0x87d528?JSON[_0x190c49(0x1bd)](_0x87d528):null,'gatewaySettings':_0x6f35ca?JSON[_0x190c49(0x1bd)](_0x6f35ca):null,'usdtPolygonWallet':_0x59f33?.[_0x190c49(0xfa)]||null,'usdtTrcWallet':_0x59f33?.['usdtTrcWallet']||null,'usdtErcWallet':_0x59f33?.['usdtErcWallet']||null,'usdcPolygonWallet':_0x59f33?.[_0x190c49(0x1a2)]||null,'publicKey':_0x5369a3,'secretKey':_0x1ef818,'status':_0x190c49(0x105)},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});return{'id':_0x41b886['id'],'fullName':_0x41b886[_0x190c49(0x1f8)],'username':_0x41b886['username'],'telegramId':_0x41b886[_0x190c49(0x16b)],'merchantUrl':_0x41b886[_0x190c49(0x1db)],'gateways':_0x41b886[_0x190c49(0x1a9)]?JSON[_0x190c49(0x122)](_0x41b886[_0x190c49(0x1a9)]):null,'gatewaySettings':_0x41b886[_0x190c49(0x21d)]?JSON['parse'](_0x41b886[_0x190c49(0x21d)]):null,'publicKey':_0x41b886[_0x190c49(0x181)],'wallets':{'usdtPolygonWallet':_0x41b886[_0x190c49(0xfa)],'usdtTrcWallet':_0x41b886[_0x190c49(0x135)],'usdtErcWallet':_0x41b886[_0x190c49(0x1cc)],'usdcPolygonWallet':_0x41b886[_0x190c49(0x1a2)]},'status':_0x41b886[_0x190c49(0x1ab)],'createdAt':_0x41b886[_0x190c49(0x10d)]};}async[a36_0x2d55f5(0x137)](_0x13aae0){const _0x51ff3c=a36_0x2d55f5;await database_1[_0x51ff3c(0x204)][_0x51ff3c(0x111)][_0x51ff3c(0xee)]({'where':{'id':_0x13aae0}});}[a36_0x2d55f5(0x108)](_0x3292a5,_0x40023b,_0x44d623){const _0x5a5473=a36_0x2d55f5,_0xa755a4=new Map(),_0x235f50=new Date(_0x40023b);while(_0x235f50<=_0x44d623){const _0x4f9541=_0x235f50[_0x5a5473(0x1b0)]()[_0x5a5473(0x12c)]('T')[0x0];_0xa755a4[_0x5a5473(0x149)](_0x4f9541,{'revenue':0x0,'count':0x0}),_0x235f50[_0x5a5473(0x163)](_0x235f50['getDate']()+0x1);}for(const _0x44f44d of _0x3292a5){const _0x76dd62=_0x44f44d[_0x5a5473(0x10d)][_0x5a5473(0x1b0)]()['split']('T')[0x0],_0x20ab9f=_0xa755a4[_0x5a5473(0x19b)](_0x76dd62);_0x20ab9f&&(_0x20ab9f[_0x5a5473(0x17e)]+=0x1,_0x44f44d['status']===_0x5a5473(0x15f)&&(_0x44f44d[_0x5a5473(0x153)]?_0x20ab9f[_0x5a5473(0x1f5)]+=_0x44f44d[_0x5a5473(0x153)]:console['log'](_0x5a5473(0x215)+_0x44f44d['id']+_0x5a5473(0x207))));}const _0x56a651=[],_0x58ef5a=[];for(const [_0x6e361,_0x3a81f5]of _0xa755a4){_0x56a651['push']({'date':_0x6e361,'amount':Math[_0x5a5473(0x1ff)](_0x3a81f5[_0x5a5473(0x1f5)]*0x64)/0x64}),_0x58ef5a[_0x5a5473(0x107)]({'date':_0x6e361,'count':_0x3a81f5[_0x5a5473(0x17e)]});}return{'dailyRevenue':_0x56a651,'dailyPayments':_0x58ef5a};}}exports[a36_0x2d55f5(0x146)]=AdminService;