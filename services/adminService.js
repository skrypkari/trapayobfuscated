'use strict';const a53_0x21cb2c=a53_0x584a;function a53_0x584a(_0x213825,_0x2e09bd){_0x213825=_0x213825-0x17a;const _0x363dea=a53_0x363d();let _0x584a44=_0x363dea[_0x213825];return _0x584a44;}(function(_0x2f02a9,_0x687d9a){const _0xd51dfe=a53_0x584a,_0xb87884=_0x2f02a9();while(!![]){try{const _0x1cf286=parseInt(_0xd51dfe(0x355))/0x1+-parseInt(_0xd51dfe(0x32f))/0x2+-parseInt(_0xd51dfe(0x2b0))/0x3*(-parseInt(_0xd51dfe(0x2d9))/0x4)+-parseInt(_0xd51dfe(0x27c))/0x5+parseInt(_0xd51dfe(0x2cf))/0x6*(parseInt(_0xd51dfe(0x311))/0x7)+parseInt(_0xd51dfe(0x2a4))/0x8+parseInt(_0xd51dfe(0x216))/0x9*(parseInt(_0xd51dfe(0x1fe))/0xa);if(_0x1cf286===_0x687d9a)break;else _0xb87884['push'](_0xb87884['shift']());}catch(_0x157761){_0xb87884['push'](_0xb87884['shift']());}}}(a53_0x363d,0x673aa));var __createBinding=this&&this[a53_0x21cb2c(0x266)]||(Object[a53_0x21cb2c(0x1c4)]?function(_0xa4a9ff,_0x18ec26,_0xd3d416,_0x566587){const _0x481e2e=a53_0x21cb2c;if(_0x566587===undefined)_0x566587=_0xd3d416;var _0x237ed4=Object['getOwnPropertyDescriptor'](_0x18ec26,_0xd3d416);(!_0x237ed4||(_0x481e2e(0x2f8)in _0x237ed4?!_0x18ec26[_0x481e2e(0x1e1)]:_0x237ed4[_0x481e2e(0x1ed)]||_0x237ed4[_0x481e2e(0x28d)]))&&(_0x237ed4={'enumerable':!![],'get':function(){return _0x18ec26[_0xd3d416];}}),Object[_0x481e2e(0x208)](_0xa4a9ff,_0x566587,_0x237ed4);}:function(_0x28ba71,_0x3ea9b9,_0xf98cfa,_0x2ee1c1){if(_0x2ee1c1===undefined)_0x2ee1c1=_0xf98cfa;_0x28ba71[_0x2ee1c1]=_0x3ea9b9[_0xf98cfa];}),__setModuleDefault=this&&this['__setModuleDefault']||(Object['create']?function(_0x474216,_0x47735c){const _0x18b65f=a53_0x21cb2c;Object[_0x18b65f(0x208)](_0x474216,'default',{'enumerable':!![],'value':_0x47735c});}:function(_0x2ad9c8,_0x10647b){const _0x19d792=a53_0x21cb2c;_0x2ad9c8[_0x19d792(0x1fa)]=_0x10647b;}),__importStar=this&&this[a53_0x21cb2c(0x229)]||(function(){var _0x1f316a=function(_0x4307b0){const _0x216afb=a53_0x584a;return _0x1f316a=Object[_0x216afb(0x2c6)]||function(_0x5b3b63){const _0x3eebbe=_0x216afb;var _0x39e17c=[];for(var _0x2527c5 in _0x5b3b63)if(Object['prototype']['hasOwnProperty']['call'](_0x5b3b63,_0x2527c5))_0x39e17c[_0x39e17c[_0x3eebbe(0x334)]]=_0x2527c5;return _0x39e17c;},_0x1f316a(_0x4307b0);};return function(_0x2d38c3){const _0x5bbd04=a53_0x584a;if(_0x2d38c3&&_0x2d38c3[_0x5bbd04(0x1e1)])return _0x2d38c3;var _0x3515c3={};if(_0x2d38c3!=null){for(var _0x37fef6=_0x1f316a(_0x2d38c3),_0x4c3727=0x0;_0x4c3727<_0x37fef6[_0x5bbd04(0x334)];_0x4c3727++)if(_0x37fef6[_0x4c3727]!=='default')__createBinding(_0x3515c3,_0x2d38c3,_0x37fef6[_0x4c3727]);}return __setModuleDefault(_0x3515c3,_0x2d38c3),_0x3515c3;};}()),__importDefault=this&&this[a53_0x21cb2c(0x288)]||function(_0x89875e){const _0x5bcbd0=a53_0x21cb2c;return _0x89875e&&_0x89875e[_0x5bcbd0(0x1e1)]?_0x89875e:{'default':_0x89875e};};function a53_0x363d(){const _0x593714=[',\x20chargebacks:\x20','dateTo','âœ…\x20Payout\x20created:\x20',']\x20Updating\x20password\x20for\x20user\x20','week','getOwnPropertyNames','ðŸ“Š\x20Final\x20WHERE\x20conditions:','telegramId','sort','\x27\x20(from\x20\x27','%\x20commission)','status','date','successUrl','294zTitIx','ðŸ’°\x20Payment\x20','ðŸ”\x20Total\x20payments\x20matching\x20filters:\x20','Current\x20password\x20is\x20incorrect','toISOString','\x20\x20\x20Shop\x20totalPaidOut:\x20','USDC','ADMIN_2FA_ENABLED=true','\x20\x20\x20Added\x20to\x20balance:\x20+','\x20USDT,\x20Requested:\x20','148hXCegO','backupCodes','config','Error\x20parsing\x20backup\x20codes:','push',':\x20commission\x20=\x20','last_week','\x20to\x20','\x20\x20\x20âœ…\x20Actual\x20available\x20balance:\x20','\x20USDT\x20(after\x20','thisMonth','toString','InstaXchange','ðŸ“±\x20Telegram\x20notification\x20sent\x20for\x20payout\x20','MaxPara','fullName','cointopay2','txid','ðŸ”„\x20Gateway\x20mapping\x20(create):','averageCommissionRate','\x20status:\x20','balance','TrapaPay','usdtErcWallet','\x20\x20\x20Difference:\x20','currency','amount','periodTo',',\x20Commission:\x20','\x20became\x20PAID:','\x20merchants\x20with\x20rounded\x20balance\x20!=\x200.00\x20(excluding\x20balances\x20that\x20round\x20to\x200.00)','get','amountAfterGatewayCommissionUSDT','REFUND','failUrl','compare','findUnique','\x20\x20\x20Amount\x20increased\x20by\x20','paymentGateways','\x20\x20\x20Current\x20network:\x20','ðŸ“Š\x20Getting\x20merchants\x20awaiting\x20payout\x20with\x20filters:','\x27\x20as\x20is\x20(not\x20found\x20in\x20mappings)','ðŸŽ¯\x20[','paidAt','averageCheckUSDT','amountUSDT','ÐÐµ\x20ÑƒÐºÐ°Ð·Ð°Ð½','\x20has\x20zero\x20or\x20null\x20amountUSDT,\x20skipping...','getMonth','ðŸ’³\x20Final\x20payout\x20wallet\x20for\x20','ðŸ“Š\x20[ADMIN]\x20Calculating\x20commission\x20manually\x20for\x20payment\x20','ðŸ”\x20Selected\x20erc20_usdc\x20wallet:\x20','set','\x20\x20\x20ðŸŒ\x20Country:\x20','cwd','ðŸ”§\x20[','52766zJcPLX','ru-RU','\x20merchants','name','username','gatewaySettings','existsSync','KLYME\x20GB','ðŸ“Š\x20Getting\x20payout\x20reports\x20with\x20filters:','updateUser','hex','\x20USDT,\x20Difference:\x20','round','âŒ\x20Failed\x20to\x20send\x20Telegram\x20notification\x20for\x20payout\x20','custom_',',\x20userId:\x20','\x20\x20\x20ðŸ’¸\x20Total\x20payouts:\x20','\x20USDT,\x20Required:\x20','2FA\x20not\x20set\x20up.\x20Please\x20call\x20setup\x20endpoint\x20first','gatewayCommissionRate','\x20USDT\x20(calculated\x20-\x20payouts\x20-\x20balance)','ðŸ”\x20Admin\x202FA\x20enabled','payment','\x27\x20not\x20found.\x20Available\x20gateways:\x20','updateCustomerData','CoinToPay2','AdminService','ðŸ”\x20Balance\x20check\x20details:','gatewayCommission','\x20USDC\x20to\x20merchant\x20','1338964SHOlVP','ðŸ”Œ\x20Gateway:\x20','writeFileSync','wallet','statusChangedBy','length','2FA\x20token\x20is\x20required','last_month','all_time','\x20\x20\x20ðŸ¤”\x20Difference:\x20','ðŸ’°\x20Current\x20shop\x20balance:\x20','./telegramBotService','Payment\x20not\x20found','setupAdmin2FA','\x20USDT\x20(','MasterCard','getUTCDate','merchantUrl4','sk_','resolve','\x20\x20\x20Merchant\x20gets:\x20','âš ï¸\x20Payment\x20','ðŸ’±\x20Currency\x20filter\x20applied:\x20','setup2FA','UTC','ðŸ“Š\x20[ADMIN]\x20Using\x20saved\x20amountAfterGatewayCommissionUSDT:\x20','gateway','gatewayOrderId','\x20USDT\x20(+','convertToUSDT','\x20\x20\x20ï¿½\x20Total\x20paid\x20out:\x20','../config/database','map','twoFactorEnabled','shop','ðŸ”„\x20Admin\x20updating\x20payment\x20','SUSPENDED','join','85548OZOjdo','ðŸ”\x20[','\x20\x20\x20ðŸ’³\x20Total\x20payments:\x20','Error\x20parsing\x20gateway\x20settings\x20for\x20shop\x20','pendingUrl','customerEmail','ðŸ“Š\x20Calculating\x20commission\x20manually\x20for\x20payment\x20','readFileSync','\x27\x20to\x20name\x20\x27','telegram','\x27)\x20not\x20found\x20in\x20database,\x20returning\x20empty\x20result','CHARGEBACK','ðŸ“Š\x20Getting\x20payments\x20with\x20filters:','getGatewayDisplayName','base32','generateBackupCodes','totalAmountAfterCommissionUSDT','merchantUrl','\x20\x20\x20ðŸ“…\x20Total\x20payouts\x20(this\x20month):\x20','setUTCDate','\x20USDT\x20(-','parse','split','_count','âœ…\x20Payout\x20created\x20in\x20DB:','awaitingPayout','ðŸ“Š\x20Statistics\x20WHERE\x20conditions:','min','failureMessage','\x20\x20\x20âœ…\x20Total\x20net\x20balances:\x20','toDataURL','Error\x20parsing\x20gateway\x20settings\x20for\x20payment\x20','commissionUSDT','count','Payout\x20not\x20found','ðŸ“Š\x20Generated\x20reports\x20for\x20','getMerchantsSelection','ðŸ“Š\x20Getting\x20merchant\x20statistics\x20with\x20filters:','\x20USDT','$transaction','amountAfterCommissionUSDT','ðŸ”\x202FA\x20enabled\x20for\x20shop:\x20','error','getPayoutById','warn','turnover','ADMIN_2FA_ENABLED=false','ðŸ’°\x20[PAYOUT]\x20Merchant\x20','merchantUrl2','plisio','updatedAt','\x20\x20\x20Full\x20amount:\x20','KLYME\x20EU','ADMIN_2FA_SECRET=','Invalid\x202FA\x20token\x20or\x20backup\x20code','\x20\x20\x20Requested\x20(number):\x20','replace','ðŸ”‘\x20Generated\x20','\x20\x20\x20ðŸ’µ\x20Available\x20balance:\x20','pendingPayout','ðŸ“Š\x20Gateway\x20filter\x20applied:','MyXSpend','ðŸ’°\x20Found\x20','ðŸ“…\x20Date\x20to\x20filter:\x20','erc20_usdc','getUTCMonth','randomBytes','totalPayments','password','toLocaleDateString','\x20USDT,\x20merchant:\x20','ðŸ“Š\x20Using\x20saved\x20commission\x20rate\x20for\x20payment\x20','\x20balance\x20updated:','chargebackAmount','\x20\x20\x20Current\x20total\x20paid\x20out:\x20','create','forEach','all','Insufficient\x20balance.\x20Available:\x20','\x20USDT\x20for\x20payment\x20','\x20PAID\x20payments','path','\x27\x20->\x20name\x20\x27','merchantEarnings','adminNotes','payout','shopUrl2','passwordHash','noda','klyme_eu','some','ðŸ”\x20Using\x20gateway\x20\x27','\x20\x20\x20Gateway:\x20','commission','ðŸ”\x202FA\x20setup\x20initiated\x20for\x20shop:\x20','\x20for\x20shop\x20','\x20order','getPayoutStats','.env','customerIp','\x20USDT\x20(theoretical\x20net)','this_week','getUTCDay','TrapaPay\x20Admin\x20(','__esModule','\x20\x20\x20ðŸ–¥ï¸\x20User\x20Agent:\x20','crypto','trim','ðŸ“…\x20Payout\x20date\x20to\x20filter:\x20','getGatewayIdByName','gateways','not\x20provided','ðŸ’°\x20Shop\x20','\x20balance\x20updated:\x20','merchantEarningsUSDT','New\x20password\x20and\x20confirmation\x20do\x20not\x20match','writable','PENDING','ceil','test_gateway','totalPaidOut','setHours','\x20\x20\x20ï¿½\x20Total\x20payments\x20turnover:\x20','\x20USDT\x20-\x20will\x20return\x20to\x20balance','totalAmount','merchantName','lastLoginAt','otpauth_url','reduce','default','../config/config','network','%\x20from\x20','640QCQpZa','ðŸ’°\x20Updating\x20payout\x20',',\x20refunds:\x20','ADMIN_PASSWORD_HASH=','\x20\x20\x20ðŸ’¸\x20Total\x20payouts\x20(all\x20time):\x20','turnoverUSDT','\x20merchants\x20for\x20selection','Merchant\x20not\x20found','âœ…\x20Using\x20wallet\x20from\x20request:\x20','usdcPolygonWallet','defineProperty','ðŸ“Š\x20Available\x20gateways\x20in\x20database:','merchantUsername','shopUrl3','payouts','âœ…\x20Deposited\x20','ðŸ’°\x20[PAYOUT]\x20Gateway\x20','./currencyService',']\x20Gateway\x20settings\x20before\x20saving:','ðŸ“…\x20Date\x20from\x20filter:\x20','twoFactorSecret','rapyd','ðŸ’¸\x20CHARGEBACK:\x20Processing\x20penalty-only\x20deduction','CoinToPay','71838YmYwaz','ðŸ”„\x20Gateway\x20mapping\x20(get):','period','Invalid\x202FA\x20token','\x20with\x20payout\x20history','ðŸ’°\x20Creating\x20payout\x20for\x20shop\x20','createPayout','ðŸ“…\x20Period:\x20','\x20USDT\x20(gross\x20revenue)','enableAdmin2FA','Visa/MasterCard','wallets','ðŸ”\x20Admin\x202FA\x20disabled','createdAt','lte','erc20','\x20\x20\x20ðŸ’°\x20Total\x20payout:\x20','2FA\x20is\x20already\x20enabled','customerName','__importStar','\x20\x20\x20Total\x20paid\x20out:\x20','totalTurnover','getAllPayouts','paidOutUSDT','âš ï¸\x20CHARGEBACK\x20without\x20penalty\x20amount\x20-\x20no\x20balance\x20change','ðŸ“Š\x20Merchants\x20with\x20rounded\x20balance\x20!=\x200.00:\x20','customerCountry','Amer','updatePayout','usdtTrcWallet','shopUrl4','trc20','ðŸ“Š\x20Calculating\x20payout\x20statistics...','\x20USDT\x20(current\x20balance\x20in\x20DB)','Error\x20processing\x20payment\x20','abs','not\x20specified','\x20USDT\x20(same\x20as\x20awaiting)','usdtPolygonWallet','totalAmountUSDT','enable2FA','Username\x20already\x20exists','\x20USDT\x20(already\x20paid\x20out)','Shop\x20not\x20found','entries','COMPLETED','ðŸ”„\x20Gateway\x20mapping:','ðŸ”\x20Admin\x20password\x20changed\x20successfully','USDT','custom','\x20USDT\x20(rounded\x20to\x202\x20decimal\x20places)','currencyService','getSettingsByGatewayId','\x20\x20\x20ðŸŒ\x20IP:\x20','aggregate','paymentsCount','\x20updated\x20successfully','findFirst','notes','New\x20password\x20must\x20be\x20at\x20least\x206\x20characters\x20long','klyme_gb','update','\x20\x20\x20Final\x20payout\x20amount\x20used:\x20','getMerchantStatistics','getPaymentById','admin','\x20->\x20','toLowerCase','Rapyd','âœ…\x20Payout\x20','ACTIVE','AmPay','ðŸ’°\x20Payment\x20amount\x20is\x20NOT\x20deducted\x20(chargeback\x20penalty\x20only)','shopUrl','\x20USDT\x20(total\x20paid\x20to\x20merchants)','periodFrom','usdcErcWallet','getGatewayNameById','shopId','utf8','__createBinding','ðŸ”\x202FA\x20disabled\x20for\x20shop:\x20','PAID','\x20USDT\x20-\x20will\x20deduct\x20from\x20balance','\x20backup\x20codes','\x20\x20\x20â³\x20Awaiting\x20payout:\x20','ðŸ“Š\x20Sorting\x20payments\x20by\x20','log','suspendUser','_sum','gte','startsWith','\x27\x20->\x20ID\x20\x27','getShopWallets','splice','getFullYear','verify',']\x20User\x20updated,\x20gatewaySettings\x20from\x20DB:','../types/gateway','includes','ðŸ”\x20Selected\x20polygon\x20wallet:\x20','values','4207225sElUOO','Sepa','toUpperCase','findMany','totp','getDate','\x20\x20\x20â³\x20Pending\x20payout:\x20','gatewayEarnings','Test\x20Gateway','klyme_de','TrapaPay\x20Admin','hash','__importDefault','generateDailyStatistics','ðŸ“‹\x20Found\x20','âœ…\x20Balance\x20check\x20passed\x20(with\x20tolerance)','âš ï¸\x20Requested\x20gateway\x20\x27','configurable','toFixed','not\x20set','ðŸ”„\x20Updating\x20customer\x20data\x20for\x20payment\x20','updatePaymentStatus','from','ðŸ”„\x20Converted\x20gateway\x20ID\x20\x27','\x20paid\x20payments\x20for\x20analysis','desc','then','getGatewayInternalName','\x20\x20\x20Transaction\x20hash:\x20','getTime','statusChangedAt','pk_','generateSecret','deletePayout','merchantUrl3','Deposit','orderId','qrcode','EXPIRED','getUserById','6274912jHZiiV','\x20payments)',']\x20Password\x20not\x20provided\x20or\x20empty,\x20skipping\x20password\x20update','revenue','\x20\x20\x20Available\x20(raw):\x20','availableBalance','getUTCFullYear','totalCommissionRate','ðŸ“Š\x20Using\x20saved\x20values\x20for\x20payment\x20','getPayoutReports','ADMIN_BACKUP_CODES=','insensitive','14889opnoqX','customerUa','\x20\x20\x20Balance:\x20','\x20\x20\x20Shop\x20balance:\x20','\x20\x20\x20New\x20amount:\x20','stringify','ðŸ“Š\x20Calculated\x20commission\x20rate\x20for\x20payment\x20','activateUser','publicKey','setDate','dateFrom','\x20\x20\x20Subtracted\x20from\x20balance:\x20-','asc','ðŸ’¸\x20CHARGEBACK\x20penalty\x20ONLY:\x20-','ADMIN_2FA_ENABLED=','dailyPayments','\x20\x20\x20ï¿½ðŸ“Š\x20Total\x20payments:\x20'];a53_0x363d=function(){return _0x593714;};return a53_0x363d();}Object[a53_0x21cb2c(0x208)](exports,a53_0x21cb2c(0x1e1),{'value':!![]}),exports[a53_0x21cb2c(0x32b)]=void 0x0;const database_1=__importDefault(require(a53_0x21cb2c(0x34e))),bcryptjs_1=__importDefault(require('bcryptjs')),crypto_1=__importDefault(require(a53_0x21cb2c(0x1e3))),fs_1=__importDefault(require('fs')),path_1=__importDefault(require(a53_0x21cb2c(0x1ca))),speakeasy_1=__importDefault(require('speakeasy')),qrcode_1=__importDefault(require(a53_0x21cb2c(0x2a1))),config_1=require(a53_0x21cb2c(0x1fb)),currencyService_1=require(a53_0x21cb2c(0x20f)),telegramBotService_1=require(a53_0x21cb2c(0x33a)),gateway_1=require(a53_0x21cb2c(0x278));class AdminService{async[a53_0x21cb2c(0x1da)](){const _0x2f990a=a53_0x21cb2c;console[_0x2f990a(0x26d)](_0x2f990a(0x236));const _0x119e81=await database_1['default'][_0x2f990a(0x351)][_0x2f990a(0x24c)]({'_sum':{'balance':!![],'totalPaidOut':!![]}}),_0x15718b=await database_1[_0x2f990a(0x1fa)][_0x2f990a(0x327)]['count']({'where':{'status':_0x2f990a(0x268),'gateway':{'not':'test_gateway'}}}),_0x4751e6=new Date(),_0x3c6d9c=new Date(_0x4751e6[_0x2f990a(0x275)](),_0x4751e6[_0x2f990a(0x309)](),0x1),_0xfa7441=new Date(_0x4751e6['getFullYear'](),_0x4751e6['getMonth']()+0x1,0x0,0x17,0x3b,0x3b,0x3e7),_0x2d879d=await database_1[_0x2f990a(0x1fa)][_0x2f990a(0x1ce)][_0x2f990a(0x24c)]({'_sum':{'amount':!![]},'where':{'createdAt':{'gte':_0x3c6d9c,'lte':_0xfa7441},'status':_0x2f990a(0x243)}}),_0x3a410e=_0x119e81[_0x2f990a(0x26f)][_0x2f990a(0x1f1)]||0x0,_0xf514be=_0x119e81[_0x2f990a(0x26f)]['balance']||0x0,_0x41951f=_0x2d879d[_0x2f990a(0x26f)][_0x2f990a(0x2f3)]||0x0,_0x5c0e1b={'totalPayout':Math[_0x2f990a(0x31d)](_0x3a410e*0x64)/0x64,'awaitingPayout':Math['round'](_0xf514be*0x64)/0x64,'thisMonth':Math['round'](_0x41951f*0x64)/0x64,'availableBalance':Math[_0x2f990a(0x31d)](_0xf514be*0x64)/0x64,'totalPayments':_0x15718b};return console[_0x2f990a(0x26d)]('ðŸ“Š\x20Payout\x20statistics\x20calculated:'),console[_0x2f990a(0x26d)](_0x2f990a(0x226)+_0x5c0e1b['totalPayout']+_0x2f990a(0x260)),console[_0x2f990a(0x26d)](_0x2f990a(0x26b)+_0x5c0e1b[_0x2f990a(0x192)]+'\x20USDT\x20(sum\x20of\x20all\x20merchant\x20balances)'),console[_0x2f990a(0x26d)](_0x2f990a(0x1b3)+_0x5c0e1b[_0x2f990a(0x2a9)]+_0x2f990a(0x23b)),console[_0x2f990a(0x26d)]('\x20\x20\x20ðŸ“…\x20This\x20month:\x20'+_0x5c0e1b[_0x2f990a(0x2e3)]+_0x2f990a(0x19f)),console[_0x2f990a(0x26d)](_0x2f990a(0x17b)+_0x5c0e1b[_0x2f990a(0x1bc)]+_0x2f990a(0x1c9)),_0x5c0e1b;}async[a53_0x21cb2c(0x329)](_0x59096e,_0x10d016){const _0x5c47de=a53_0x21cb2c;console[_0x5c47de(0x26d)](_0x5c47de(0x290)+_0x59096e+':',_0x10d016);const _0x531853=await database_1[_0x5c47de(0x1fa)][_0x5c47de(0x327)][_0x5c47de(0x2fd)]({'where':{'id':_0x59096e},'select':{'id':!![],'customerEmail':!![],'customerName':!![],'customerCountry':!![],'customerIp':!![],'customerUa':!![]}});if(!_0x531853)throw new Error(_0x5c47de(0x33b));const _0x593d6a={};_0x10d016[_0x5c47de(0x230)]!==undefined&&(_0x593d6a['customerCountry']=_0x10d016[_0x5c47de(0x230)]||null);_0x10d016[_0x5c47de(0x1dc)]!==undefined&&(_0x593d6a['customerIp']=_0x10d016[_0x5c47de(0x1dc)]||null);_0x10d016[_0x5c47de(0x2b1)]!==undefined&&(_0x593d6a[_0x5c47de(0x2b1)]=_0x10d016[_0x5c47de(0x2b1)]||null);const _0x63065d=await database_1['default']['payment']['update']({'where':{'id':_0x59096e},'data':{..._0x593d6a,'updatedAt':new Date()},'select':{'id':!![],'customerEmail':!![],'customerName':!![],'customerCountry':!![],'customerIp':!![],'customerUa':!![],'updatedAt':!![]}});return console[_0x5c47de(0x26d)]('âœ…\x20Customer\x20data\x20updated\x20for\x20payment\x20'+_0x59096e),console['log'](_0x5c47de(0x30e)+_0x531853[_0x5c47de(0x230)]+_0x5c47de(0x258)+_0x63065d[_0x5c47de(0x230)]),console[_0x5c47de(0x26d)](_0x5c47de(0x24b)+_0x531853['customerIp']+_0x5c47de(0x258)+_0x63065d[_0x5c47de(0x1dc)]),console[_0x5c47de(0x26d)](_0x5c47de(0x1e2)+(_0x531853['customerUa']?_0x5c47de(0x30d):_0x5c47de(0x28f))+_0x5c47de(0x258)+(_0x63065d['customerUa']?_0x5c47de(0x30d):'not\x20set')),_0x63065d;}async['getSystemStatistics'](_0x11d7ce,_0x283b11){const _0x3bef92=a53_0x21cb2c,_0xd2a0e1=_0x283b11?new Date(_0x283b11):new Date();let _0xd5eacc,_0x33ac0b;if(_0x11d7ce[_0x3bef92(0x271)](_0x3bef92(0x31f))){const _0x2adfa7=_0x11d7ce[_0x3bef92(0x1b1)](_0x3bef92(0x31f),'')['split']('_');if(_0x2adfa7[_0x3bef92(0x334)]===0x2){const _0x3f31d2=new Date(_0x2adfa7[0x0]),_0x2fb575=new Date(_0x2adfa7[0x1]);_0xd5eacc=new Date(Date[_0x3bef92(0x347)](_0x3f31d2[_0x3bef92(0x2aa)](),_0x3f31d2[_0x3bef92(0x1ba)](),_0x3f31d2[_0x3bef92(0x33f)](),0x0,0x0,0x0,0x0)),_0x33ac0b=new Date(Date['UTC'](_0x2fb575[_0x3bef92(0x2aa)](),_0x2fb575[_0x3bef92(0x1ba)](),_0x2fb575[_0x3bef92(0x33f)](),0x17,0x3b,0x3b,0x3e7));}else{const _0x4436c0=new Date(Date[_0x3bef92(0x347)](_0xd2a0e1['getUTCFullYear'](),_0xd2a0e1[_0x3bef92(0x1ba)](),_0xd2a0e1[_0x3bef92(0x33f)]()-0x1e));_0xd5eacc=new Date(Date[_0x3bef92(0x347)](_0x4436c0['getUTCFullYear'](),_0x4436c0[_0x3bef92(0x1ba)](),_0x4436c0[_0x3bef92(0x33f)](),0x0,0x0,0x0,0x0)),_0x33ac0b=new Date(Date[_0x3bef92(0x347)](_0xd2a0e1[_0x3bef92(0x2aa)](),_0xd2a0e1[_0x3bef92(0x1ba)](),_0xd2a0e1['getUTCDate'](),0x17,0x3b,0x3b,0x3e7));}}else{switch(_0x11d7ce['toLowerCase']()){case'today':_0xd5eacc=new Date(Date[_0x3bef92(0x347)](_0xd2a0e1[_0x3bef92(0x2aa)](),_0xd2a0e1[_0x3bef92(0x1ba)](),_0xd2a0e1[_0x3bef92(0x33f)](),0x0,0x0,0x0,0x0)),_0x33ac0b=new Date(Date[_0x3bef92(0x347)](_0xd2a0e1[_0x3bef92(0x2aa)](),_0xd2a0e1[_0x3bef92(0x1ba)](),_0xd2a0e1[_0x3bef92(0x33f)](),0x17,0x3b,0x3b,0x3e7));break;case'yesterday':const _0x282338=new Date(_0xd2a0e1);_0x282338[_0x3bef92(0x18c)](_0x282338['getUTCDate']()-0x1),_0xd5eacc=new Date(Date[_0x3bef92(0x347)](_0x282338['getUTCFullYear'](),_0x282338['getUTCMonth'](),_0x282338[_0x3bef92(0x33f)](),0x0,0x0,0x0,0x0)),_0x33ac0b=new Date(Date[_0x3bef92(0x347)](_0x282338[_0x3bef92(0x2aa)](),_0x282338[_0x3bef92(0x1ba)](),_0x282338[_0x3bef92(0x33f)](),0x17,0x3b,0x3b,0x3e7));break;case _0x3bef92(0x1de):const _0x359e56=_0xd2a0e1[_0x3bef92(0x1df)](),_0x519a83=_0x359e56===0x0?-0x6:0x1-_0x359e56,_0x2ebba4=_0xd2a0e1['getUTCDate']()+_0x519a83;_0xd5eacc=new Date(Date[_0x3bef92(0x347)](_0xd2a0e1[_0x3bef92(0x2aa)](),_0xd2a0e1[_0x3bef92(0x1ba)](),_0x2ebba4,0x0,0x0,0x0,0x0)),_0x33ac0b=new Date(Date[_0x3bef92(0x347)](_0xd2a0e1[_0x3bef92(0x2aa)](),_0xd2a0e1[_0x3bef92(0x1ba)](),_0xd2a0e1['getUTCDate'](),0x17,0x3b,0x3b,0x3e7));break;case _0x3bef92(0x2df):const _0x456e4a=new Date(Date[_0x3bef92(0x347)](_0xd2a0e1[_0x3bef92(0x2aa)](),_0xd2a0e1[_0x3bef92(0x1ba)](),_0xd2a0e1[_0x3bef92(0x33f)]()-0x7)),_0x38f13f=_0x456e4a['getUTCDay'](),_0x16eb3e=_0x38f13f===0x0?-0x6:0x1-_0x38f13f,_0x40b63=_0x456e4a[_0x3bef92(0x33f)]()+_0x16eb3e;_0xd5eacc=new Date(Date[_0x3bef92(0x347)](_0x456e4a[_0x3bef92(0x2aa)](),_0x456e4a['getUTCMonth'](),_0x40b63,0x0,0x0,0x0,0x0)),_0x33ac0b=new Date(Date['UTC'](_0x456e4a[_0x3bef92(0x2aa)](),_0x456e4a[_0x3bef92(0x1ba)](),_0x40b63+0x6,0x17,0x3b,0x3b,0x3e7));break;case'this_month':_0xd5eacc=new Date(Date[_0x3bef92(0x347)](_0xd2a0e1[_0x3bef92(0x2aa)](),_0xd2a0e1[_0x3bef92(0x1ba)](),0x1,0x0,0x0,0x0,0x0)),_0x33ac0b=new Date(Date[_0x3bef92(0x347)](_0xd2a0e1[_0x3bef92(0x2aa)](),_0xd2a0e1[_0x3bef92(0x1ba)](),_0xd2a0e1[_0x3bef92(0x33f)](),0x17,0x3b,0x3b,0x3e7));break;case _0x3bef92(0x336):_0xd5eacc=new Date(Date[_0x3bef92(0x347)](_0xd2a0e1[_0x3bef92(0x2aa)](),_0xd2a0e1[_0x3bef92(0x1ba)]()-0x1,0x1,0x0,0x0,0x0,0x0)),_0x33ac0b=new Date(Date[_0x3bef92(0x347)](_0xd2a0e1[_0x3bef92(0x2aa)](),_0xd2a0e1[_0x3bef92(0x1ba)](),0x0,0x17,0x3b,0x3b,0x3e7));break;case _0x3bef92(0x337):_0xd5eacc=new Date(Date[_0x3bef92(0x347)](0x7e9,0x5,0xe,0x0,0x0,0x0,0x0)),_0x33ac0b=new Date(Date['UTC'](_0xd2a0e1[_0x3bef92(0x2aa)](),_0xd2a0e1[_0x3bef92(0x1ba)](),_0xd2a0e1[_0x3bef92(0x33f)](),0x17,0x3b,0x3b,0x3e7));break;default:_0xd5eacc=new Date(_0xd2a0e1[_0x3bef92(0x299)]()-0x1e*0x18*0x3c*0x3c*0x3e8);const _0x3c2c31=new Date(Date[_0x3bef92(0x347)](_0xd2a0e1[_0x3bef92(0x2aa)](),_0xd2a0e1['getUTCMonth'](),_0xd2a0e1[_0x3bef92(0x33f)]()-0x1e));_0xd5eacc=new Date(Date[_0x3bef92(0x347)](_0x3c2c31[_0x3bef92(0x2aa)](),_0x3c2c31[_0x3bef92(0x1ba)](),_0x3c2c31[_0x3bef92(0x33f)](),0x0,0x0,0x0,0x0)),_0x33ac0b=new Date(Date[_0x3bef92(0x347)](_0xd2a0e1[_0x3bef92(0x2aa)](),_0xd2a0e1['getUTCMonth'](),_0xd2a0e1[_0x3bef92(0x33f)](),0x17,0x3b,0x3b,0x3e7));}const _0x263b6d={'gte':_0xd5eacc,'lte':_0x33ac0b};console[_0x3bef92(0x26d)]('ðŸ“Š\x20Statistics\x20date\x20range:\x20'+_0xd5eacc[_0x3bef92(0x2d3)]()+_0x3bef92(0x2e0)+_0x33ac0b['toISOString']());const [_0x4529fb,_0x5684f5,_0x25bc05,_0x48e1ef,_0x297c90,_0x5daaa0,_0xf57641,_0x698945,_0x296039]=await Promise[_0x3bef92(0x1c6)]([database_1[_0x3bef92(0x1fa)][_0x3bef92(0x351)][_0x3bef92(0x19a)](),database_1[_0x3bef92(0x1fa)][_0x3bef92(0x351)][_0x3bef92(0x19a)]({'where':{'status':_0x3bef92(0x25c)}}),database_1[_0x3bef92(0x1fa)][_0x3bef92(0x327)][_0x3bef92(0x19a)]({'where':{'status':_0x3bef92(0x268),'createdAt':_0x263b6d,'gateway':{'not':_0x3bef92(0x1f0)}}}),database_1['default'][_0x3bef92(0x327)][_0x3bef92(0x19a)]({'where':{'status':_0x3bef92(0x184),'createdAt':_0x263b6d,'gateway':{'not':_0x3bef92(0x1f0)}}}),database_1[_0x3bef92(0x1fa)]['payment']['count']({'where':{'status':_0x3bef92(0x2fa),'createdAt':_0x263b6d,'gateway':{'not':_0x3bef92(0x1f0)}}}),database_1[_0x3bef92(0x1fa)][_0x3bef92(0x327)][_0x3bef92(0x27f)]({'where':{'status':_0x3bef92(0x268),'createdAt':_0x263b6d,'gateway':{'not':_0x3bef92(0x1f0)}},'select':{'amount':!![],'currency':!![],'amountUSDT':!![],'amountAfterGatewayCommissionUSDT':!![],'gateway':!![]}}),database_1[_0x3bef92(0x1fa)]['payment'][_0x3bef92(0x27f)]({'where':{'gateway':{'not':_0x3bef92(0x1f0)}},'take':0xa,'orderBy':{'createdAt':_0x3bef92(0x295)},'include':{'shop':{'select':{'name':!![],'username':!![]}}}}),database_1['default'][_0x3bef92(0x327)][_0x3bef92(0x27f)]({'where':{'createdAt':_0x263b6d,'gateway':{'not':_0x3bef92(0x1f0)}},'select':{'amount':!![],'currency':!![],'status':!![],'amountUSDT':!![],'createdAt':!![]}}),database_1[_0x3bef92(0x1fa)][_0x3bef92(0x327)][_0x3bef92(0x27f)]({'where':{'status':_0x3bef92(0x268),'gateway':{'not':'test_gateway'}},'select':{'amountUSDT':!![],'amountAfterGatewayCommissionUSDT':!![],'gateway':!![]}})]);console['log']('ðŸ“Š\x20Statistics\x20PAID\x20payments\x20count:\x20'+_0x25bc05);let _0xea4f7c=0x0,_0x341433=0x0;for(const _0x12098f of _0x5daaa0){const _0x174930=_0x12098f[_0x3bef92(0x306)]||0x0;_0xea4f7c+=_0x174930;if(_0x12098f['amountAfterGatewayCommissionUSDT']&&_0x12098f[_0x3bef92(0x306)]){const _0x4b004b=_0x12098f['amountUSDT']-_0x12098f[_0x3bef92(0x2f9)];_0x341433+=_0x4b004b;}}const {gatewaySettingsService:_0x57850b}=await Promise['resolve']()[_0x3bef92(0x296)](()=>__importStar(require('./gatewaySettingsService'))),{getGatewayIdByName:_0x493b44}=await Promise[_0x3bef92(0x342)]()[_0x3bef92(0x296)](()=>__importStar(require(_0x3bef92(0x278))));let _0x4693c0=0x0;for(const _0x5493f8 of _0x5daaa0){const _0x235213=_0x493b44(_0x5493f8[_0x3bef92(0x349)]);if(_0x235213){const _0x4be7f8=_0x57850b[_0x3bef92(0x24a)](_0x235213),_0x27a429=_0x4be7f8?.[_0x3bef92(0x32d)]||0x0,_0x21cea2=_0x5493f8['amountUSDT']||0x0,_0x273996=_0x21cea2*(_0x27a429/0x64);_0x4693c0+=_0x273996;}}_0x341433-=_0x4693c0;let _0x1959c7=0x0,_0x568fb2=0x0;for(const _0x4c5390 of _0x296039){if(_0x4c5390['amountAfterGatewayCommissionUSDT']&&_0x4c5390['amountUSDT']){const _0x522e05=_0x4c5390[_0x3bef92(0x306)]-_0x4c5390[_0x3bef92(0x2f9)];_0x1959c7+=_0x522e05;}const _0x2e446b=_0x493b44(_0x4c5390[_0x3bef92(0x349)]);if(_0x2e446b){const _0x2eec4a=_0x57850b[_0x3bef92(0x24a)](_0x2e446b),_0x2d5158=_0x2eec4a?.[_0x3bef92(0x32d)]||0x0,_0x1b802d=_0x4c5390[_0x3bef92(0x306)]||0x0,_0x329385=_0x1b802d*(_0x2d5158/0x64);_0x568fb2+=_0x329385;}}_0x1959c7-=_0x568fb2;const _0x35964b=_0x25bc05>0x0?_0xea4f7c/_0x25bc05:0x0,_0x2b7088=this[_0x3bef92(0x289)](_0x698945,_0xd5eacc,_0x33ac0b),_0x5106d7=await database_1[_0x3bef92(0x1fa)][_0x3bef92(0x327)][_0x3bef92(0x19a)]({'where':{'createdAt':_0x263b6d,'gateway':{'not':_0x3bef92(0x1f0)},'status':{'notIn':['PENDING',_0x3bef92(0x2a2)]}}}),_0x9b25b2=_0x5106d7>0x0?_0x25bc05/_0x5106d7*0x64:0x0;return{'totalShops':_0x4529fb,'activeShops':_0x5684f5,'totalPayments':_0x5106d7,'successfulPayments':_0x25bc05,'totalAttempts':_0x5106d7,'chargebacks':_0x48e1ef,'refunds':_0x297c90,'totalRevenue':Math[_0x3bef92(0x31d)](_0xea4f7c*0x64)/0x64,'trapayEarnings':Math[_0x3bef92(0x31d)](_0x341433*0x64)/0x64,'trapayEarningsAllTime':Math[_0x3bef92(0x31d)](_0x1959c7*0x64)/0x64,'averagePaymentAmount':Math[_0x3bef92(0x31d)](_0x35964b*0x64)/0x64,'conversionRate':Math[_0x3bef92(0x31d)](_0x9b25b2*0x64)/0x64,'dailyRevenue':_0x2b7088['dailyRevenue'],'dailyPayments':_0x2b7088[_0x3bef92(0x2bf)],'recentPayments':_0xf57641[_0x3bef92(0x34f)](_0x3cce53=>({'id':_0x3cce53['id'],'amount':_0x3cce53[_0x3bef92(0x2f3)],'currency':_0x3cce53[_0x3bef92(0x2f2)],'status':_0x3cce53['status'],'gateway':_0x3cce53['gateway'],'shop':_0x3cce53['shop'],'createdAt':_0x3cce53[_0x3bef92(0x223)]}))};}}async[a53_0x21cb2c(0x255)](_0xd0ed1f){const _0x561d6b=a53_0x21cb2c;console[_0x561d6b(0x26d)](_0x561d6b(0x19e),_0xd0ed1f);let _0x353590,_0x2165d2=new Date();if(_0xd0ed1f[_0x561d6b(0x218)]===_0x561d6b(0x247)&&_0xd0ed1f[_0x561d6b(0x2ba)]&&_0xd0ed1f[_0x561d6b(0x2c2)]){const _0x5d45be=new Date(_0xd0ed1f[_0x561d6b(0x2ba)]),_0x15f12a=new Date(_0xd0ed1f[_0x561d6b(0x2c2)]);_0x353590=new Date(Date[_0x561d6b(0x347)](_0x5d45be[_0x561d6b(0x2aa)](),_0x5d45be[_0x561d6b(0x1ba)](),_0x5d45be[_0x561d6b(0x33f)](),0x0,0x0,0x0,0x0)),_0x2165d2=new Date(Date[_0x561d6b(0x347)](_0x15f12a[_0x561d6b(0x2aa)](),_0x15f12a[_0x561d6b(0x1ba)](),_0x15f12a[_0x561d6b(0x33f)](),0x17,0x3b,0x3b,0x3e7));}else{const _0x4d145e=new Date();switch(_0xd0ed1f[_0x561d6b(0x218)]){case _0x561d6b(0x2c5):_0x353590=new Date(_0x4d145e[_0x561d6b(0x299)]()-0x7*0x18*0x3c*0x3c*0x3e8),_0x353590[_0x561d6b(0x1f2)](0x0,0x0,0x0,0x0),_0x2165d2[_0x561d6b(0x1f2)](0x17,0x3b,0x3b,0x3e7);break;case'month':_0x353590=new Date(Date[_0x561d6b(0x347)](_0x4d145e['getUTCFullYear'](),_0x4d145e[_0x561d6b(0x1ba)](),0x1,0x0,0x0,0x0,0x0)),_0x2165d2=new Date(Date[_0x561d6b(0x347)](_0x4d145e[_0x561d6b(0x2aa)](),_0x4d145e['getUTCMonth']()+0x1,0x0,0x17,0x3b,0x3b,0x3e7));break;case'lastMonth':_0x353590=new Date(Date[_0x561d6b(0x347)](_0x4d145e[_0x561d6b(0x2aa)](),_0x4d145e[_0x561d6b(0x1ba)]()-0x1,0x1,0x0,0x0,0x0,0x0)),_0x2165d2=new Date(Date[_0x561d6b(0x347)](_0x4d145e[_0x561d6b(0x2aa)](),_0x4d145e[_0x561d6b(0x1ba)](),0x0,0x17,0x3b,0x3b,0x3e7));break;case'year':_0x353590=new Date(_0x4d145e[_0x561d6b(0x299)]()-0x16d*0x18*0x3c*0x3c*0x3e8),_0x353590[_0x561d6b(0x1f2)](0x0,0x0,0x0,0x0),_0x2165d2[_0x561d6b(0x1f2)](0x17,0x3b,0x3b,0x3e7);break;case _0x561d6b(0x1c6):default:_0x353590=new Date('2020-01-01'),_0x353590[_0x561d6b(0x1f2)](0x0,0x0,0x0,0x0),_0x2165d2[_0x561d6b(0x1f2)](0x17,0x3b,0x3b,0x3e7);break;}}console['log']('ðŸ“…\x20Period:\x20'+_0x353590[_0x561d6b(0x2d3)]()+_0x561d6b(0x2e0)+_0x2165d2[_0x561d6b(0x2d3)]());const _0x19702e={'status':_0x561d6b(0x268),'gateway':{'not':_0x561d6b(0x1f0)},'createdAt':{'gte':_0x353590,'lte':_0x2165d2}};_0xd0ed1f['shopId']&&(_0x19702e['shopId']=_0xd0ed1f[_0x561d6b(0x264)]);const _0x30da2f=await database_1['default'][_0x561d6b(0x327)][_0x561d6b(0x27f)]({'where':_0x19702e,'select':{'id':!![],'amount':!![],'currency':!![],'amountUSDT':!![],'amountAfterGatewayCommissionUSDT':!![],'gatewayCommissionRate':!![],'gateway':!![],'shopId':!![],'paidAt':!![],'shop':{'select':{'id':!![],'name':!![],'username':!![],'gatewaySettings':!![]}}}});console['log'](_0x561d6b(0x1b7)+_0x30da2f[_0x561d6b(0x334)]+_0x561d6b(0x294));const _0x14b55a={'gateway':{'not':_0x561d6b(0x1f0)},'status':{'notIn':[_0x561d6b(0x1ee),_0x561d6b(0x2a2)]},'createdAt':{'gte':_0x353590,'lte':_0x2165d2}};_0xd0ed1f[_0x561d6b(0x264)]&&(_0x14b55a[_0x561d6b(0x264)]=_0xd0ed1f[_0x561d6b(0x264)]);const _0x487ef3=await database_1[_0x561d6b(0x1fa)][_0x561d6b(0x327)][_0x561d6b(0x19a)]({'where':_0x14b55a}),_0x5a0196={..._0x14b55a,'status':_0x561d6b(0x184)},_0x4cd0fa={..._0x14b55a,'status':'REFUND'},[_0x40b209,_0x3bf921]=await Promise[_0x561d6b(0x1c6)]([database_1['default'][_0x561d6b(0x327)][_0x561d6b(0x19a)]({'where':_0x5a0196}),database_1[_0x561d6b(0x1fa)][_0x561d6b(0x327)][_0x561d6b(0x19a)]({'where':_0x4cd0fa})]);console[_0x561d6b(0x26d)]('ðŸ“Š\x20Total\x20payments\x20(including\x20failed):\x20'+_0x487ef3+',\x20successful:\x20'+_0x30da2f[_0x561d6b(0x334)]+_0x561d6b(0x2c1)+_0x40b209+_0x561d6b(0x200)+_0x3bf921);let _0x37e5cc=0x0,_0x4cf137=0x0,_0x5c92ce=0x0;const _0x3eb619={},_0x560185={},_0x367c7b={},_0x4c1e59=new Date(_0x353590);while(_0x4c1e59<=_0x2165d2){const _0x2d5811=_0x4c1e59[_0x561d6b(0x2d3)]()[_0x561d6b(0x18f)]('T')[0x0];_0x367c7b[_0x2d5811]={'date':_0x2d5811,'turnover':0x0,'merchantEarnings':0x0,'gatewayEarnings':0x0,'paymentsCount':0x0},_0x4c1e59[_0x561d6b(0x18c)](_0x4c1e59['getUTCDate']()+0x1);}for(const _0x491670 of _0x30da2f){try{const _0x26ade5=_0x491670[_0x561d6b(0x306)]||0x0;if(_0x26ade5<=0x0){console[_0x561d6b(0x1a5)]('âš ï¸\x20Payment\x20'+_0x491670['id']+_0x561d6b(0x308));continue;}let _0x448185,_0x3d174a;if(_0x491670['amountAfterGatewayCommissionUSDT']!==null&&_0x491670['amountAfterGatewayCommissionUSDT']!==undefined)_0x448185=_0x491670[_0x561d6b(0x2f9)],_0x3d174a=_0x26ade5-_0x448185,console[_0x561d6b(0x26d)](_0x561d6b(0x2ac)+_0x491670['id']+':\x20'+_0x26ade5[_0x561d6b(0x28e)](0x6)+_0x561d6b(0x1bf)+_0x448185[_0x561d6b(0x28e)](0x6)+_0x561d6b(0x19f));else{let _0x1ebd78={};if(_0x491670[_0x561d6b(0x351)][_0x561d6b(0x316)])try{_0x1ebd78=JSON['parse'](_0x491670[_0x561d6b(0x351)][_0x561d6b(0x316)]);}catch(_0x5d06a7){console[_0x561d6b(0x1a3)](_0x561d6b(0x17c)+_0x491670['shopId']+':',_0x5d06a7);}let _0x372f31=0x2d;for(const [_0x102ecc,_0x3633ac]of Object['entries'](_0x1ebd78)){if(_0x102ecc[_0x561d6b(0x259)]()===_0x491670[_0x561d6b(0x349)][_0x561d6b(0x259)]()){_0x372f31=_0x3633ac['commission']||0x2d;break;}}_0x3d174a=_0x26ade5*(_0x372f31/0x64),_0x448185=_0x26ade5-_0x3d174a,console[_0x561d6b(0x26d)](_0x561d6b(0x17f)+_0x491670['id']+':\x20'+_0x372f31+_0x561d6b(0x1fd)+_0x26ade5['toFixed'](0x6)+_0x561d6b(0x19f));}_0x37e5cc+=_0x26ade5,_0x4cf137+=_0x448185,_0x5c92ce+=_0x3d174a;let _0x34a81f;_0x491670['gatewayCommissionRate']!==null&&_0x491670[_0x561d6b(0x324)]!==undefined?(_0x34a81f=_0x491670[_0x561d6b(0x324)],console[_0x561d6b(0x26d)](_0x561d6b(0x1c0)+_0x491670['id']+':\x20'+_0x34a81f+'%')):(_0x34a81f=_0x26ade5>0x0?_0x3d174a/_0x26ade5*0x64:0x0,console[_0x561d6b(0x26d)](_0x561d6b(0x2b6)+_0x491670['id']+':\x20'+_0x34a81f[_0x561d6b(0x28e)](0x2)+'%'));!_0x3eb619[_0x491670[_0x561d6b(0x349)]]&&(_0x3eb619[_0x491670[_0x561d6b(0x349)]]={'gateway':_0x491670[_0x561d6b(0x349)],'gatewayDisplayName':this[_0x561d6b(0x186)](_0x491670[_0x561d6b(0x349)]),'paymentsCount':0x0,'turnoverUSDT':0x0,'commissionUSDT':0x0,'merchantEarningsUSDT':0x0,'totalCommissionRate':0x0});_0x3eb619[_0x491670[_0x561d6b(0x349)]][_0x561d6b(0x24d)]++,_0x3eb619[_0x491670[_0x561d6b(0x349)]][_0x561d6b(0x203)]+=_0x26ade5,_0x3eb619[_0x491670[_0x561d6b(0x349)]]['commissionUSDT']+=_0x3d174a,_0x3eb619[_0x491670['gateway']][_0x561d6b(0x1eb)]+=_0x448185,_0x3eb619[_0x491670[_0x561d6b(0x349)]]['totalCommissionRate']+=_0x34a81f;!_0xd0ed1f[_0x561d6b(0x264)]&&(!_0x560185[_0x491670['shopId']]&&(_0x560185[_0x491670[_0x561d6b(0x264)]]={'shopId':_0x491670[_0x561d6b(0x264)],'shopName':_0x491670[_0x561d6b(0x351)][_0x561d6b(0x314)],'shopUsername':_0x491670[_0x561d6b(0x351)]['username'],'paymentsCount':0x0,'turnoverUSDT':0x0,'commissionUSDT':0x0,'merchantEarningsUSDT':0x0,'paidOutUSDT':0x0,'averageCheckUSDT':0x0}),_0x560185[_0x491670[_0x561d6b(0x264)]][_0x561d6b(0x24d)]++,_0x560185[_0x491670[_0x561d6b(0x264)]][_0x561d6b(0x203)]+=_0x26ade5,_0x560185[_0x491670[_0x561d6b(0x264)]][_0x561d6b(0x199)]+=_0x3d174a,_0x560185[_0x491670[_0x561d6b(0x264)]][_0x561d6b(0x1eb)]+=_0x448185);const _0x4bf6b6=_0x491670[_0x561d6b(0x304)][_0x561d6b(0x2d3)]()[_0x561d6b(0x18f)]('T')[0x0];_0x367c7b[_0x4bf6b6]&&(_0x367c7b[_0x4bf6b6][_0x561d6b(0x1a6)]+=_0x26ade5,_0x367c7b[_0x4bf6b6][_0x561d6b(0x1cc)]+=_0x448185,_0x367c7b[_0x4bf6b6][_0x561d6b(0x283)]+=_0x3d174a,_0x367c7b[_0x4bf6b6][_0x561d6b(0x24d)]++);}catch(_0x5cc054){console[_0x561d6b(0x1a3)](_0x561d6b(0x238)+_0x491670['id']+':',_0x5cc054);}}Object[_0x561d6b(0x27b)](_0x3eb619)['forEach'](_0x18bb38=>{const _0x1f52a9=_0x561d6b;_0x18bb38[_0x1f52a9(0x2ec)]=_0x18bb38[_0x1f52a9(0x24d)]>0x0?_0x18bb38['totalCommissionRate']/_0x18bb38[_0x1f52a9(0x24d)]:0x0,delete _0x18bb38[_0x1f52a9(0x2ab)];}),Object[_0x561d6b(0x27b)](_0x560185)[_0x561d6b(0x1c5)](_0xe5f3f9=>{const _0x2df150=_0x561d6b;_0xe5f3f9[_0x2df150(0x305)]=_0xe5f3f9[_0x2df150(0x24d)]>0x0?_0xe5f3f9[_0x2df150(0x203)]/_0xe5f3f9[_0x2df150(0x24d)]:0x0;});let _0x37d756=0x0,_0x18f713=0x0;if(_0xd0ed1f['shopId']){const _0xdd187c=await database_1[_0x561d6b(0x1fa)][_0x561d6b(0x1ce)]['findMany']({'where':{'shopId':_0xd0ed1f[_0x561d6b(0x264)],'status':_0x561d6b(0x243),'createdAt':{'gte':_0x353590,'lte':_0x2165d2}},'select':{'amount':!![]}});_0x37d756=_0xdd187c[_0x561d6b(0x1f9)]((_0x122678,_0x5b17c9)=>_0x122678+_0x5b17c9[_0x561d6b(0x2f3)],0x0);const _0x2c5b38=await database_1[_0x561d6b(0x1fa)]['payout']['findMany']({'where':{'shopId':_0xd0ed1f['shopId'],'status':_0x561d6b(0x1ee),'createdAt':{'gte':_0x353590,'lte':_0x2165d2}},'select':{'amount':!![]}});_0x18f713=_0x2c5b38[_0x561d6b(0x1f9)]((_0x146ed9,_0x3cf00e)=>_0x146ed9+_0x3cf00e['amount'],0x0);}const _0x574a21=_0x487ef3,_0x1866c1=_0x30da2f[_0x561d6b(0x334)],_0x14dcae=_0x1866c1>0x0?_0x37e5cc/_0x1866c1:0x0,_0x394c4a=_0x574a21>0x0?Math['round'](_0x1866c1/_0x574a21*0x2710)/0x64:0x0,_0x33a422=Math[_0x561d6b(0x1ef)]((_0x2165d2[_0x561d6b(0x299)]()-_0x353590[_0x561d6b(0x299)]())/(0x3e8*0x3c*0x3c*0x18)),_0x157acc={'totalTurnover':Math[_0x561d6b(0x31d)](_0x37e5cc*0x64)/0x64,'merchantEarnings':Math[_0x561d6b(0x31d)](_0x4cf137*0x64)/0x64,'gatewayEarnings':Math[_0x561d6b(0x31d)](_0x5c92ce*0x64)/0x64,'totalPaidOut':Math[_0x561d6b(0x31d)](_0x37d756*0x64)/0x64,'pendingPayout':Math[_0x561d6b(0x31d)](_0x18f713*0x64)/0x64,'averageCheck':Math['round'](_0x14dcae*0x64)/0x64,'totalPayments':_0x574a21,'successfulPayments':_0x1866c1,'conversionRate':_0x394c4a,'chargebacks':_0x40b209,'refunds':_0x3bf921,'gatewayBreakdown':Object[_0x561d6b(0x27b)](_0x3eb619)[_0x561d6b(0x34f)](_0x380564=>({..._0x380564,'turnoverUSDT':Math[_0x561d6b(0x31d)](_0x380564['turnoverUSDT']*0x64)/0x64,'commissionUSDT':Math['round'](_0x380564[_0x561d6b(0x199)]*0x64)/0x64,'merchantEarningsUSDT':Math[_0x561d6b(0x31d)](_0x380564['merchantEarningsUSDT']*0x64)/0x64,'averageCommissionRate':Math[_0x561d6b(0x31d)](_0x380564[_0x561d6b(0x2ec)]*0x64)/0x64})),'merchantBreakdown':_0xd0ed1f[_0x561d6b(0x264)]?undefined:Object['values'](_0x560185)[_0x561d6b(0x34f)](_0x1dbfb8=>({..._0x1dbfb8,'turnoverUSDT':Math[_0x561d6b(0x31d)](_0x1dbfb8[_0x561d6b(0x203)]*0x64)/0x64,'commissionUSDT':Math[_0x561d6b(0x31d)](_0x1dbfb8[_0x561d6b(0x199)]*0x64)/0x64,'merchantEarningsUSDT':Math[_0x561d6b(0x31d)](_0x1dbfb8['merchantEarningsUSDT']*0x64)/0x64,'paidOutUSDT':Math[_0x561d6b(0x31d)](_0x1dbfb8[_0x561d6b(0x22d)]*0x64)/0x64,'averageCheckUSDT':Math[_0x561d6b(0x31d)](_0x1dbfb8[_0x561d6b(0x305)]*0x64)/0x64})),'dailyData':Object[_0x561d6b(0x27b)](_0x367c7b)[_0x561d6b(0x34f)](_0x24d307=>({..._0x24d307,'turnover':Math[_0x561d6b(0x31d)](_0x24d307[_0x561d6b(0x1a6)]*0x64)/0x64,'merchantEarnings':Math['round'](_0x24d307[_0x561d6b(0x1cc)]*0x64)/0x64,'gatewayEarnings':Math[_0x561d6b(0x31d)](_0x24d307[_0x561d6b(0x283)]*0x64)/0x64}))[_0x561d6b(0x2c9)]((_0x3d17c1,_0x50023e)=>_0x3d17c1[_0x561d6b(0x2cd)]['localeCompare'](_0x50023e[_0x561d6b(0x2cd)])),'periodInfo':{'from':_0x353590,'to':_0x2165d2,'periodType':_0xd0ed1f['period']||'custom','daysCount':_0x33a422}};return console[_0x561d6b(0x26d)]('ðŸ“Š\x20Merchant\x20statistics\x20calculated:'),console['log']('\x20\x20\x20ðŸ’°\x20Total\x20turnover:\x20'+_0x157acc[_0x561d6b(0x22b)]+'\x20USDT'),console[_0x561d6b(0x26d)]('\x20\x20\x20ðŸ‘¤\x20Merchant\x20earnings:\x20'+_0x157acc['merchantEarnings']+_0x561d6b(0x19f)),console[_0x561d6b(0x26d)]('\x20\x20\x20ðŸª\x20Gateway\x20earnings:\x20'+_0x157acc[_0x561d6b(0x283)]+_0x561d6b(0x19f)),console[_0x561d6b(0x26d)](_0x561d6b(0x34d)+_0x157acc['totalPaidOut']+_0x561d6b(0x19f)),console[_0x561d6b(0x26d)](_0x561d6b(0x282)+_0x157acc[_0x561d6b(0x1b4)]+_0x561d6b(0x19f)),console['log'](_0x561d6b(0x2c0)+_0x157acc[_0x561d6b(0x1bc)]),_0x157acc;}async[a53_0x21cb2c(0x19d)](_0x5998bb){const _0xa2f7fb=a53_0x21cb2c;console['log']('ðŸ“‹\x20Getting\x20merchants\x20selection\x20list...',{'hasPayoutHistory':_0x5998bb});let _0x3f58c4={};_0x5998bb&&(_0x3f58c4[_0xa2f7fb(0x20c)]={'some':{}});const _0x1a02b5=await database_1[_0xa2f7fb(0x1fa)][_0xa2f7fb(0x351)][_0xa2f7fb(0x27f)]({'where':_0x3f58c4,'select':{'id':!![],'username':!![],'name':!![]},'orderBy':{'name':_0xa2f7fb(0x2bc)}});return console[_0xa2f7fb(0x26d)](_0xa2f7fb(0x28a)+_0x1a02b5[_0xa2f7fb(0x334)]+_0xa2f7fb(0x204)+(_0x5998bb?_0xa2f7fb(0x21a):'')),_0x1a02b5[_0xa2f7fb(0x34f)](_0x4d9613=>({'id':_0x4d9613['id'],'username':_0x4d9613[_0xa2f7fb(0x315)],'name':_0x4d9613[_0xa2f7fb(0x314)]}));}[a53_0x21cb2c(0x186)](_0x5c0da8){const _0x17dfce=a53_0x21cb2c,_0x19b1c7={'test_gateway':_0x17dfce(0x284),'plisio':'Plisio','rapyd':_0x17dfce(0x25a),'noda':'Noda','cointopay':_0x17dfce(0x215),'cointopay2':_0x17dfce(0x32a),'klyme_eu':_0x17dfce(0x1ad),'klyme_gb':_0x17dfce(0x318),'klyme_de':'KLYME\x20DE','mastercard':_0x17dfce(0x33e),'visa/mastercard':_0x17dfce(0x220),'amer':_0x17dfce(0x231),'myxspend':_0x17dfce(0x1b6),'ampay':_0x17dfce(0x25d),'ampay_try':'AmPay\x20TRY','sepa':_0x17dfce(0x27d),'interac':'Interac','onramp':'OnRamp','squirrelpay':'SquirrelPay','maxpara':_0x17dfce(0x2e7),'instaxchange':_0x17dfce(0x2e5),'oxapay':'OxaPay'};return _0x19b1c7[_0x5c0da8]||_0x5c0da8;}[a53_0x21cb2c(0x297)](_0x448e65){const _0x5bfe68=a53_0x21cb2c,_0x4cb787={'Test\x20Gateway':_0x5bfe68(0x1f0),'Plisio':_0x5bfe68(0x1aa),'Rapyd':_0x5bfe68(0x213),'Noda':_0x5bfe68(0x1d1),'CoinToPay':'cointopay','CoinToPay2':_0x5bfe68(0x2e9),'KLYME\x20EU':_0x5bfe68(0x1d2),'KLYME\x20GB':_0x5bfe68(0x252),'KLYME\x20DE':_0x5bfe68(0x285),'MasterCard':'mastercard'};return _0x4cb787[_0x448e65]||_0x448e65[_0x5bfe68(0x259)]();}async['getMerchantsAwaitingPayout'](_0xa2bc85){const _0x5962e2=a53_0x21cb2c,{page:_0x39a63f,limit:_0x4a8296,minAmount:_0x465e37,search:_0x586926}=_0xa2bc85;console[_0x5962e2(0x26d)](_0x5962e2(0x301),_0xa2bc85);let _0x4a922e={};_0x586926&&(_0x4a922e['name']={'contains':_0x586926,'mode':_0x5962e2(0x2af)});const _0x17cc07=await database_1['default'][_0x5962e2(0x351)][_0x5962e2(0x27f)]({'where':_0x4a922e,'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'balance':!![],'totalPaidOut':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'usdcErcWallet':!![],'gatewaySettings':!![],'createdAt':!![]}}),_0x317cf4=_0x17cc07['filter'](_0x9b1dd1=>{const _0x7dc61c=Math['floor'](_0x9b1dd1['balance']*0x64)/0x64;if(_0x465e37&&_0x7dc61c<_0x465e37)return![];return _0x7dc61c!==0x0;});_0x317cf4['sort']((_0x3469ee,_0x543d00)=>_0x543d00[_0x5962e2(0x2ee)]-_0x3469ee['balance']);const _0x5b0a50=_0x317cf4['length'],_0x3706fe=(_0x39a63f-0x1)*_0x4a8296,_0x469f96=_0x317cf4['slice'](_0x3706fe,_0x3706fe+_0x4a8296);console[_0x5962e2(0x26d)]('ðŸ’°\x20Found\x20'+_0x469f96[_0x5962e2(0x334)]+_0x5962e2(0x2f7));const _0x5e41a3=await Promise[_0x5962e2(0x1c6)](_0x469f96['map'](async _0x327446=>{const _0x18d1c8=_0x5962e2,[_0x1468c8,_0x30b943,_0x403c0e]=await Promise[_0x18d1c8(0x1c6)]([database_1['default'][_0x18d1c8(0x327)]['count']({'where':{'shopId':_0x327446['id'],'status':_0x18d1c8(0x268),'gateway':{'not':'test_gateway'}}}),database_1[_0x18d1c8(0x1fa)]['payment'][_0x18d1c8(0x24f)]({'where':{'shopId':_0x327446['id'],'status':_0x18d1c8(0x268),'gateway':{'not':'test_gateway'}},'orderBy':{'paidAt':_0x18d1c8(0x2bc)},'select':{'paidAt':!![]}}),database_1[_0x18d1c8(0x1fa)][_0x18d1c8(0x327)]['groupBy']({'by':[_0x18d1c8(0x349)],'where':{'shopId':_0x327446['id'],'status':'PAID','gateway':{'not':_0x18d1c8(0x1f0)}},'_count':{'id':!![]},'_sum':{'amountUSDT':!![]}})]),_0x4dd970=new Date(),_0x3110e3=new Date(_0x4dd970[_0x18d1c8(0x275)](),_0x4dd970[_0x18d1c8(0x309)](),0x1),_0x260d79=new Date(_0x4dd970[_0x18d1c8(0x275)](),_0x4dd970[_0x18d1c8(0x309)]()+0x1,0x0,0x17,0x3b,0x3b,0x3e7),[_0x138974,_0x216bc0]=await Promise[_0x18d1c8(0x1c6)]([database_1[_0x18d1c8(0x1fa)][_0x18d1c8(0x1ce)][_0x18d1c8(0x24c)]({'_sum':{'amount':!![]},'where':{'shopId':_0x327446['id'],'status':_0x18d1c8(0x243)}}),database_1[_0x18d1c8(0x1fa)][_0x18d1c8(0x1ce)][_0x18d1c8(0x24c)]({'_sum':{'amount':!![]},'where':{'shopId':_0x327446['id'],'status':_0x18d1c8(0x243),'createdAt':{'gte':_0x3110e3,'lte':_0x260d79}}})]),_0x186486=_0x138974[_0x18d1c8(0x26f)][_0x18d1c8(0x2f3)]||0x0,_0x2d9365=_0x216bc0[_0x18d1c8(0x26f)][_0x18d1c8(0x2f3)]||0x0,_0x2fdda9=await Promise[_0x18d1c8(0x1c6)](_0x403c0e[_0x18d1c8(0x34f)](async _0x5bf772=>{const _0x298f84=_0x18d1c8,_0x9d172e=await database_1[_0x298f84(0x1fa)][_0x298f84(0x327)][_0x298f84(0x27f)]({'where':{'shopId':_0x327446['id'],'status':_0x298f84(0x268),'gateway':_0x5bf772['gateway']},'select':{'amountUSDT':!![],'amountAfterGatewayCommissionUSDT':!![],'gatewayCommissionRate':!![]}});let _0xf74840=0x2d;if(_0x327446[_0x298f84(0x316)])try{const _0x53bf71=JSON[_0x298f84(0x18e)](_0x327446[_0x298f84(0x316)]);for(const [_0x2777b0,_0x4922e7]of Object[_0x298f84(0x242)](_0x53bf71)){if(_0x2777b0[_0x298f84(0x259)]()===_0x5bf772[_0x298f84(0x349)]['toLowerCase']()){_0xf74840=_0x4922e7[_0x298f84(0x1d6)]||0xa,console['log'](_0x298f84(0x20e)+_0x5bf772[_0x298f84(0x349)]+'\x20for\x20shop\x20'+_0x327446['id']+_0x298f84(0x2de)+_0xf74840+'%');break;}}}catch(_0x5586d9){console['error']('Error\x20parsing\x20gateway\x20settings\x20for\x20shop\x20'+_0x327446['id']+':',_0x5586d9);}const _0x41989e=_0x5bf772['_sum']?.[_0x298f84(0x306)]||0x0;let _0xc9ba8=0x0;for(const _0x479319 of _0x9d172e){if(_0x479319[_0x298f84(0x2f9)]!==null&&_0x479319[_0x298f84(0x2f9)]!==undefined)_0xc9ba8+=_0x479319['amountAfterGatewayCommissionUSDT'];else{const _0xd9bfa4=_0x479319[_0x298f84(0x306)]||0x0;_0xc9ba8+=_0xd9bfa4*(0x1-_0xf74840/0x64);}}return{'gateway':_0x5bf772[_0x298f84(0x349)],'count':_0x5bf772[_0x298f84(0x190)]?.['id']||0x0,'amountUSDT':Math[_0x298f84(0x31d)](_0x41989e*0x64)/0x64,'amountAfterCommissionUSDT':Math[_0x298f84(0x31d)](_0xc9ba8*0x64)/0x64,'commission':_0xf74840};})),_0x1218fd=_0x2fdda9['reduce']((_0x29f543,_0x187035)=>_0x29f543+_0x187035['amountUSDT'],0x0),_0x3f60f9=_0x2fdda9[_0x18d1c8(0x1f9)]((_0x513b8b,_0x56ed86)=>_0x513b8b+_0x56ed86[_0x18d1c8(0x1a1)],0x0),_0x37c619=_0x327446[_0x18d1c8(0x2ee)];return console[_0x18d1c8(0x26d)](_0x18d1c8(0x1a8)+_0x327446['username']+':'),console[_0x18d1c8(0x26d)](_0x18d1c8(0x1f3)+_0x1218fd[_0x18d1c8(0x28e)](0x2)+_0x18d1c8(0x21e)),console['log']('\x20\x20\x20ðŸ”\x20Calculated\x20after\x20commission:\x20'+_0x3f60f9[_0x18d1c8(0x28e)](0x2)+_0x18d1c8(0x1dd)),console[_0x18d1c8(0x26d)](_0x18d1c8(0x2e1)+_0x37c619[_0x18d1c8(0x28e)](0x2)+_0x18d1c8(0x237)),console[_0x18d1c8(0x26d)](_0x18d1c8(0x321)+_0x186486[_0x18d1c8(0x28e)](0x2)+_0x18d1c8(0x240)),console[_0x18d1c8(0x26d)](_0x18d1c8(0x338)+(_0x3f60f9-_0x186486-_0x37c619)['toFixed'](0x2)+_0x18d1c8(0x325)),{'id':_0x327446['id'],'fullName':_0x327446[_0x18d1c8(0x314)],'username':_0x327446[_0x18d1c8(0x315)],'telegramId':_0x327446[_0x18d1c8(0x182)],'merchantUrl':_0x327446[_0x18d1c8(0x25f)],'wallets':{'usdtPolygonWallet':_0x327446[_0x18d1c8(0x23c)],'usdtTrcWallet':_0x327446[_0x18d1c8(0x233)],'usdtErcWallet':_0x327446['usdtErcWallet'],'usdcPolygonWallet':_0x327446[_0x18d1c8(0x207)],'usdcErcWallet':_0x327446[_0x18d1c8(0x262)]},'totalAmountUSDT':Math[_0x18d1c8(0x31d)](_0x1218fd*0x64)/0x64,'totalAmountAfterCommissionUSDT':Math[_0x18d1c8(0x31d)](_0x3f60f9*0x64)/0x64,'currentBalance':Math['floor'](_0x37c619*0x64)/0x64,'totalPayout':Math[_0x18d1c8(0x31d)](_0x186486*0x64)/0x64,'thisMonth':Math['round'](_0x2d9365*0x64)/0x64,'paymentsCount':_0x1468c8,'oldestPaymentDate':_0x30b943?.['paidAt']||_0x327446[_0x18d1c8(0x223)],'gatewayBreakdown':_0x2fdda9};})),_0x2ab1de=_0x5e41a3[_0x5962e2(0x1f9)]((_0x266819,_0x4e0858)=>_0x266819+_0x4e0858[_0x5962e2(0x23d)],0x0),_0x2ec25c=_0x5e41a3['reduce']((_0x9fcec9,_0x47cbbe)=>_0x9fcec9+_0x47cbbe[_0x5962e2(0x189)],0x0),_0xf5856b=_0x5e41a3[_0x5962e2(0x1f9)]((_0x14afed,_0x45076b)=>_0x14afed+_0x45076b['totalPayout'],0x0),_0x836e72=_0x5e41a3[_0x5962e2(0x1f9)]((_0x5ec631,_0x1a0204)=>_0x5ec631+_0x1a0204[_0x5962e2(0x2e3)],0x0);return console['log'](_0x5962e2(0x22f)+_0x5b0a50+_0x5962e2(0x313)),console[_0x5962e2(0x26d)]('\x20\x20\x20ðŸ’°\x20Total\x20payments\x20turnover:\x20'+Math[_0x5962e2(0x31d)](_0x2ab1de*0x64)/0x64+_0x5962e2(0x21e)),console[_0x5962e2(0x26d)](_0x5962e2(0x196)+Math['round'](_0x2ec25c*0x64)/0x64+_0x5962e2(0x248)),console[_0x5962e2(0x26d)](_0x5962e2(0x202)+Math['round'](_0xf5856b*0x64)/0x64+_0x5962e2(0x19f)),console[_0x5962e2(0x26d)](_0x5962e2(0x18b)+Math['round'](_0x836e72*0x64)/0x64+'\x20USDT'),{'merchants':_0x5e41a3,'pagination':{'page':_0x39a63f,'limit':_0x4a8296,'total':_0x5b0a50,'totalPages':Math['ceil'](_0x5b0a50/_0x4a8296)},'summary':{'totalMerchants':_0x5b0a50,'totalAmountUSDT':Math['round'](_0x2ab1de*0x64)/0x64,'totalAmountAfterCommissionUSDT':Math[_0x5962e2(0x31d)](_0x2ec25c*0x64)/0x64,'totalPayout':Math['round'](_0xf5856b*0x64)/0x64,'thisMonth':Math[_0x5962e2(0x31d)](_0x836e72*0x64)/0x64}};}async[a53_0x21cb2c(0x21c)](_0x5b7235){const _0x47c597=a53_0x21cb2c,{shopId:_0x41f28e,amount:_0x545e94,network:_0x94c43b,wallet:_0x295ceb,notes:_0x128071,txid:_0x290ea0,periodFrom:_0x4b1115,periodTo:_0x3be3a7}=_0x5b7235,_0x185478=await database_1[_0x47c597(0x1fa)][_0x47c597(0x1a0)](async _0x4c77b1=>{const _0x20a4e7=_0x47c597,_0x52e96c=await _0x4c77b1[_0x20a4e7(0x351)][_0x20a4e7(0x2fd)]({'where':{'id':_0x41f28e},'select':{'id':!![],'name':!![],'username':!![],'balance':!![],'totalPaidOut':!![]}});if(!_0x52e96c)throw new Error(_0x20a4e7(0x241));console[_0x20a4e7(0x26d)](_0x20a4e7(0x21b)+_0x52e96c[_0x20a4e7(0x315)]+':'),console['log']('\x20\x20\x20Current\x20balance:\x20'+_0x52e96c[_0x20a4e7(0x2ee)][_0x20a4e7(0x28e)](0x6)+_0x20a4e7(0x19f)),console[_0x20a4e7(0x26d)]('\x20\x20\x20Payout\x20amount:\x20'+_0x545e94['toFixed'](0x6)+_0x20a4e7(0x19f)),console[_0x20a4e7(0x26d)](_0x20a4e7(0x1c3)+_0x52e96c[_0x20a4e7(0x1f1)][_0x20a4e7(0x28e)](0x6)+_0x20a4e7(0x19f));if(_0x290ea0)console['log'](_0x20a4e7(0x298)+_0x290ea0);const _0x4658a0=0.000001,_0x5e6a23=Number(_0x52e96c[_0x20a4e7(0x2ee)]),_0x37d1bf=Number(_0x545e94);console[_0x20a4e7(0x26d)](_0x20a4e7(0x32c)),console[_0x20a4e7(0x26d)](_0x20a4e7(0x2a8)+_0x52e96c[_0x20a4e7(0x2ee)]),console[_0x20a4e7(0x26d)]('\x20\x20\x20Available\x20(number):\x20'+_0x5e6a23),console[_0x20a4e7(0x26d)](_0x20a4e7(0x1b0)+_0x37d1bf),console[_0x20a4e7(0x26d)](_0x20a4e7(0x2f1)+(_0x5e6a23-_0x37d1bf)),console[_0x20a4e7(0x26d)]('\x20\x20\x20Tolerance:\x20'+_0x4658a0);if(_0x5e6a23<_0x37d1bf-_0x4658a0)throw new Error(_0x20a4e7(0x1c7)+_0x5e6a23[_0x20a4e7(0x28e)](0x6)+_0x20a4e7(0x2d8)+_0x37d1bf[_0x20a4e7(0x28e)](0x6)+_0x20a4e7(0x31c)+(_0x5e6a23-_0x37d1bf)[_0x20a4e7(0x28e)](0x8)+'\x20USDT');console[_0x20a4e7(0x26d)](_0x20a4e7(0x28b));const _0xb434d5=Math[_0x20a4e7(0x194)](_0x5e6a23,_0x37d1bf);let _0x44a5da=_0x295ceb;console['log']('ðŸ”\x20Initial\x20wallet\x20from\x20request:\x20'+(_0x295ceb||_0x20a4e7(0x1e8)));if(!_0x44a5da){console[_0x20a4e7(0x26d)]('ðŸ”\x20No\x20wallet\x20provided,\x20looking\x20up\x20from\x20shop\x20settings...');const _0x4039dc=await _0x4c77b1[_0x20a4e7(0x351)][_0x20a4e7(0x2fd)]({'where':{'id':_0x41f28e},'select':{'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'usdcErcWallet':!![]}});console[_0x20a4e7(0x26d)]('ðŸ”\x20Shop\x20wallets:',_0x4039dc);if(_0x4039dc)switch(_0x94c43b){case'polygon':_0x44a5da=_0x4039dc['usdtPolygonWallet']||undefined,console[_0x20a4e7(0x26d)](_0x20a4e7(0x27a)+_0x44a5da);break;case _0x20a4e7(0x235):_0x44a5da=_0x4039dc[_0x20a4e7(0x233)]||undefined,console['log']('ðŸ”\x20Selected\x20trc20\x20wallet:\x20'+_0x44a5da);break;case _0x20a4e7(0x225):_0x44a5da=_0x4039dc[_0x20a4e7(0x2f0)]||undefined,console[_0x20a4e7(0x26d)]('ðŸ”\x20Selected\x20erc20\x20wallet:\x20'+_0x44a5da);break;case'polygon_usdc':_0x44a5da=_0x4039dc['usdcPolygonWallet']||undefined,console['log']('ðŸ”\x20Selected\x20polygon_usdc\x20wallet:\x20'+_0x44a5da);break;case _0x20a4e7(0x1b9):_0x44a5da=_0x4039dc[_0x20a4e7(0x262)]||undefined,console[_0x20a4e7(0x26d)](_0x20a4e7(0x30c)+_0x44a5da);break;}}else console['log'](_0x20a4e7(0x206)+_0x44a5da);console[_0x20a4e7(0x26d)](_0x20a4e7(0x30a)+_0x94c43b+':\x20'+(_0x44a5da||_0x20a4e7(0x23a))),console[_0x20a4e7(0x26d)]('ðŸ”\x20Creating\x20payout\x20with\x20data:',{'shopId':_0x41f28e,'amount':_0xb434d5,'network':_0x94c43b,'wallet':_0x44a5da,'status':'COMPLETED','txid':_0x290ea0,'notes':_0x128071,'periodFrom':_0x4b1115?new Date(_0x4b1115):null,'periodTo':_0x3be3a7?new Date(_0x3be3a7):null});const _0x45ce1=await _0x4c77b1[_0x20a4e7(0x1ce)]['create']({'data':{'shopId':_0x41f28e,'amount':_0xb434d5,'network':_0x94c43b,'wallet':_0x44a5da,'status':_0x20a4e7(0x243),'txid':_0x290ea0,'notes':_0x128071,'periodFrom':_0x4b1115?new Date(_0x4b1115):null,'periodTo':_0x3be3a7?new Date(_0x3be3a7):null,'createdAt':new Date(),'paidAt':new Date()}});console[_0x20a4e7(0x26d)](_0x20a4e7(0x191),{'id':_0x45ce1['id'],'wallet':_0x45ce1[_0x20a4e7(0x332)],'network':_0x45ce1[_0x20a4e7(0x1fc)],'amount':_0x45ce1[_0x20a4e7(0x2f3)]});const _0x20a706=_0x5e6a23-_0xb434d5,_0xc5ac13=Number(_0x52e96c[_0x20a4e7(0x1f1)])+_0xb434d5;return await _0x4c77b1[_0x20a4e7(0x351)]['update']({'where':{'id':_0x41f28e},'data':{'balance':_0x20a706,'totalPaidOut':_0xc5ac13}}),console[_0x20a4e7(0x26d)](_0x20a4e7(0x1e9)+_0x52e96c[_0x20a4e7(0x315)]+_0x20a4e7(0x1c1)),console[_0x20a4e7(0x26d)](_0x20a4e7(0x2b2)+_0x5e6a23[_0x20a4e7(0x28e)](0x6)+_0x20a4e7(0x258)+_0x20a706[_0x20a4e7(0x28e)](0x6)+_0x20a4e7(0x18d)+_0xb434d5[_0x20a4e7(0x28e)](0x6)+')'),console[_0x20a4e7(0x26d)](_0x20a4e7(0x22a)+_0x52e96c[_0x20a4e7(0x1f1)][_0x20a4e7(0x28e)](0x6)+_0x20a4e7(0x258)+_0xc5ac13['toFixed'](0x6)+_0x20a4e7(0x34b)+_0xb434d5[_0x20a4e7(0x28e)](0x6)+')'),console['log'](_0x20a4e7(0x254)+_0xb434d5[_0x20a4e7(0x28e)](0x6)+'\x20USDT'),{'payout':_0x45ce1,'shop':_0x52e96c};});console[_0x47c597(0x26d)](_0x47c597(0x2c3)+_0x185478['payout']['id']+'\x20for\x20shop\x20'+_0x185478[_0x47c597(0x351)][_0x47c597(0x315)]+'\x20('+_0x185478[_0x47c597(0x1ce)][_0x47c597(0x2f3)][_0x47c597(0x28e)](0x6)+'\x20USDT)');try{let _0x97ddea=_0x47c597(0x307);if(_0x185478['payout']['periodFrom']&&_0x185478[_0x47c597(0x1ce)][_0x47c597(0x2f4)]){const _0x36a6a5=new Date(_0x185478[_0x47c597(0x1ce)]['periodFrom'])[_0x47c597(0x1be)](_0x47c597(0x312)),_0x36dc8e=new Date(_0x185478[_0x47c597(0x1ce)][_0x47c597(0x2f4)])[_0x47c597(0x1be)](_0x47c597(0x312));_0x97ddea=_0x36a6a5+'\x20-\x20'+_0x36dc8e;}await telegramBotService_1['telegramBotService']['sendPayoutNotification'](_0x185478['payout'][_0x47c597(0x264)],{'id':_0x185478[_0x47c597(0x1ce)]['id'],'amount':_0x185478['payout'][_0x47c597(0x2f3)],'network':_0x185478[_0x47c597(0x1ce)][_0x47c597(0x1fc)],'wallet':_0x185478[_0x47c597(0x1ce)]['wallet'],'period':_0x97ddea,'createdAt':_0x185478['payout']['createdAt'],'txid':_0x185478[_0x47c597(0x1ce)][_0x47c597(0x2ea)]}),console[_0x47c597(0x26d)](_0x47c597(0x2e6)+_0x185478[_0x47c597(0x1ce)]['id']);}catch(_0x5900d3){console[_0x47c597(0x1a3)](_0x47c597(0x31e)+_0x185478[_0x47c597(0x1ce)]['id']+':',_0x5900d3);}return{'id':_0x185478['payout']['id'],'shopId':_0x185478[_0x47c597(0x1ce)][_0x47c597(0x264)],'shopName':_0x185478[_0x47c597(0x351)][_0x47c597(0x314)],'shopUsername':_0x185478[_0x47c597(0x351)]['username'],'amount':_0x185478['payout'][_0x47c597(0x2f3)],'network':_0x185478[_0x47c597(0x1ce)]['network'],'wallet':_0x185478[_0x47c597(0x1ce)][_0x47c597(0x332)],'status':_0x185478['payout'][_0x47c597(0x2cc)],'txid':_0x185478[_0x47c597(0x1ce)]['txid'],'notes':_0x185478[_0x47c597(0x1ce)][_0x47c597(0x250)],'periodFrom':_0x185478[_0x47c597(0x1ce)]['periodFrom'],'periodTo':_0x185478[_0x47c597(0x1ce)][_0x47c597(0x2f4)],'createdAt':_0x185478[_0x47c597(0x1ce)][_0x47c597(0x223)],'paidAt':_0x185478[_0x47c597(0x1ce)][_0x47c597(0x304)]};}async[a53_0x21cb2c(0x22c)](_0x201aaf){const _0x8fd91d=a53_0x21cb2c,{page:_0x5eff84,limit:_0x8a2452,shopId:_0x28dd80,network:_0x441045,dateFrom:_0x3b4d77,dateTo:_0x166ff7,search:_0x27a769}=_0x201aaf,_0x43782c=(_0x5eff84-0x1)*_0x8a2452,_0x495361={};_0x28dd80&&(_0x495361['shopId']=_0x28dd80);_0x441045&&(_0x495361[_0x8fd91d(0x1fc)]=_0x441045);if(_0x3b4d77||_0x166ff7){_0x495361[_0x8fd91d(0x223)]={};if(_0x3b4d77){const _0x5853e4=new Date(_0x3b4d77);_0x5853e4[_0x8fd91d(0x1f2)](0x0,0x0,0x0,0x1),_0x495361[_0x8fd91d(0x223)][_0x8fd91d(0x270)]=_0x5853e4,console[_0x8fd91d(0x26d)]('ðŸ“…\x20Payout\x20date\x20from\x20filter:\x20'+_0x5853e4[_0x8fd91d(0x2d3)]());}if(_0x166ff7){const _0xf4f03a=new Date(_0x166ff7);_0xf4f03a['setHours'](0x17,0x3b,0x3b,0x3e7),_0x495361[_0x8fd91d(0x223)]['lte']=_0xf4f03a,console[_0x8fd91d(0x26d)](_0x8fd91d(0x1e5)+_0xf4f03a[_0x8fd91d(0x2d3)]());}}_0x27a769&&(_0x495361['OR']=[{'shop':{'name':{'contains':_0x27a769,'mode':'insensitive'}}},{'shop':{'username':{'contains':_0x27a769,'mode':_0x8fd91d(0x2af)}}},{'notes':{'contains':_0x27a769,'mode':_0x8fd91d(0x2af)}}]);const [_0x1a2208,_0x5c203f]=await Promise[_0x8fd91d(0x1c6)]([database_1['default'][_0x8fd91d(0x1ce)]['findMany']({'where':_0x495361,'skip':_0x43782c,'take':_0x8a2452,'orderBy':{'createdAt':_0x8fd91d(0x295)},'select':{'id':!![],'shopId':!![],'amount':!![],'network':!![],'status':!![],'txid':!![],'notes':!![],'periodFrom':!![],'periodTo':!![],'createdAt':!![],'wallet':!![],'paidAt':!![],'shop':{'select':{'name':!![],'username':!![]}}}}),database_1['default'][_0x8fd91d(0x1ce)][_0x8fd91d(0x19a)]({'where':_0x495361})]);return{'payouts':_0x1a2208[_0x8fd91d(0x34f)](_0x9bfc55=>({'id':_0x9bfc55['id'],'shopId':_0x9bfc55['shopId'],'shopName':_0x9bfc55['shop'][_0x8fd91d(0x314)],'shopUsername':_0x9bfc55[_0x8fd91d(0x351)][_0x8fd91d(0x315)],'amount':_0x9bfc55[_0x8fd91d(0x2f3)],'network':_0x9bfc55[_0x8fd91d(0x1fc)],'wallet':_0x9bfc55[_0x8fd91d(0x332)],'status':_0x9bfc55[_0x8fd91d(0x2cc)],'txid':_0x9bfc55['txid'],'notes':_0x9bfc55[_0x8fd91d(0x250)],'periodFrom':_0x9bfc55[_0x8fd91d(0x261)],'periodTo':_0x9bfc55['periodTo'],'createdAt':_0x9bfc55[_0x8fd91d(0x223)],'paidAt':_0x9bfc55[_0x8fd91d(0x304)]})),'pagination':{'page':_0x5eff84,'limit':_0x8a2452,'total':_0x5c203f,'totalPages':Math[_0x8fd91d(0x1ef)](_0x5c203f/_0x8a2452)}};}async[a53_0x21cb2c(0x1a4)](_0x5a7001){const _0x14cbb9=a53_0x21cb2c,_0x51cf11=await database_1[_0x14cbb9(0x1fa)][_0x14cbb9(0x1ce)][_0x14cbb9(0x2fd)]({'where':{'id':_0x5a7001},'include':{'shop':{'select':{'name':!![],'username':!![]}}}});if(!_0x51cf11)return null;return{'id':_0x51cf11['id'],'shopId':_0x51cf11['shopId'],'shopName':_0x51cf11[_0x14cbb9(0x351)][_0x14cbb9(0x314)],'shopUsername':_0x51cf11[_0x14cbb9(0x351)][_0x14cbb9(0x315)],'amount':_0x51cf11[_0x14cbb9(0x2f3)],'network':_0x51cf11[_0x14cbb9(0x1fc)],'wallet':_0x51cf11[_0x14cbb9(0x332)],'status':_0x51cf11['status'],'txid':_0x51cf11[_0x14cbb9(0x2ea)],'notes':_0x51cf11['notes'],'periodFrom':_0x51cf11[_0x14cbb9(0x261)],'periodTo':_0x51cf11[_0x14cbb9(0x2f4)],'createdAt':_0x51cf11[_0x14cbb9(0x223)],'paidAt':_0x51cf11[_0x14cbb9(0x304)]};}async[a53_0x21cb2c(0x29d)](_0x1421c7){const _0x98a27b=a53_0x21cb2c;await database_1[_0x98a27b(0x1fa)][_0x98a27b(0x1ce)]['delete']({'where':{'id':_0x1421c7}});}async[a53_0x21cb2c(0x232)](_0xaa1cf6,_0x256913){const _0x1391ad=a53_0x21cb2c,_0x570488=await database_1[_0x1391ad(0x1fa)][_0x1391ad(0x1a0)](async _0x5be849=>{const _0x198ec8=_0x1391ad,_0x389247=await _0x5be849[_0x198ec8(0x1ce)][_0x198ec8(0x2fd)]({'where':{'id':_0xaa1cf6},'include':{'shop':{'select':{'id':!![],'name':!![],'username':!![],'balance':!![],'totalPaidOut':!![]}}}});if(!_0x389247)throw new Error(_0x198ec8(0x19b));console['log'](_0x198ec8(0x1ff)+_0xaa1cf6+_0x198ec8(0x1d8)+_0x389247[_0x198ec8(0x351)][_0x198ec8(0x315)]+':'),console[_0x198ec8(0x26d)]('\x20\x20\x20Current\x20amount:\x20'+_0x389247[_0x198ec8(0x2f3)][_0x198ec8(0x28e)](0x6)+_0x198ec8(0x19f)),console[_0x198ec8(0x26d)](_0x198ec8(0x300)+_0x389247[_0x198ec8(0x1fc)]),console['log'](_0x198ec8(0x2b3)+_0x389247[_0x198ec8(0x351)][_0x198ec8(0x2ee)][_0x198ec8(0x28e)](0x6)+'\x20USDT'),console['log'](_0x198ec8(0x2d4)+_0x389247['shop'][_0x198ec8(0x1f1)]['toFixed'](0x6)+_0x198ec8(0x19f));let _0xaf864d=0x0;if(_0x256913['amount']!==undefined){const _0x10c913=Number(_0x389247['amount']),_0x3569e9=Number(_0x256913[_0x198ec8(0x2f3)]);_0xaf864d=_0x3569e9-_0x10c913,console[_0x198ec8(0x26d)](_0x198ec8(0x2b4)+_0x3569e9[_0x198ec8(0x28e)](0x6)+'\x20USDT'),console['log']('\x20\x20\x20Amount\x20difference:\x20'+_0xaf864d[_0x198ec8(0x28e)](0x6)+_0x198ec8(0x19f));if(_0xaf864d<0x0)console[_0x198ec8(0x26d)]('\x20\x20\x20Amount\x20decreased\x20by\x20'+Math[_0x198ec8(0x239)](_0xaf864d)[_0x198ec8(0x28e)](0x6)+_0x198ec8(0x1f4));else{if(_0xaf864d>0x0){const _0x335a53=Number(_0x389247['shop'][_0x198ec8(0x2ee)]);console[_0x198ec8(0x26d)](_0x198ec8(0x2fe)+_0xaf864d[_0x198ec8(0x28e)](0x6)+_0x198ec8(0x269));if(_0x335a53<_0xaf864d)throw new Error('Insufficient\x20balance\x20for\x20amount\x20increase.\x20Available:\x20'+_0x335a53[_0x198ec8(0x28e)](0x6)+_0x198ec8(0x322)+_0xaf864d['toFixed'](0x6)+'\x20USDT');}}}const _0x416795={};if(_0x256913[_0x198ec8(0x2f3)]!==undefined)_0x416795[_0x198ec8(0x2f3)]=_0x256913[_0x198ec8(0x2f3)];if(_0x256913[_0x198ec8(0x1fc)]!==undefined)_0x416795[_0x198ec8(0x1fc)]=_0x256913[_0x198ec8(0x1fc)];if(_0x256913[_0x198ec8(0x332)]!==undefined)_0x416795['wallet']=_0x256913[_0x198ec8(0x332)]||null;if(_0x256913[_0x198ec8(0x250)]!==undefined)_0x416795[_0x198ec8(0x250)]=_0x256913[_0x198ec8(0x250)]||null;if(_0x256913['txid']!==undefined)_0x416795['txid']=_0x256913[_0x198ec8(0x2ea)]||null;if(_0x256913[_0x198ec8(0x261)]!==undefined)_0x416795['periodFrom']=_0x256913[_0x198ec8(0x261)]?new Date(_0x256913[_0x198ec8(0x261)]):null;if(_0x256913[_0x198ec8(0x2f4)]!==undefined)_0x416795[_0x198ec8(0x2f4)]=_0x256913['periodTo']?new Date(_0x256913[_0x198ec8(0x2f4)]):null;const _0x10b47f=await _0x5be849[_0x198ec8(0x1ce)][_0x198ec8(0x253)]({'where':{'id':_0xaa1cf6},'data':_0x416795,'include':{'shop':{'select':{'name':!![],'username':!![]}}}});if(_0xaf864d!==0x0){const _0x31dfcc=Number(_0x389247[_0x198ec8(0x351)][_0x198ec8(0x2ee)]),_0x5af3af=Number(_0x389247['shop']['totalPaidOut']),_0x38cdf1=_0x31dfcc-_0xaf864d,_0xe220e3=_0x5af3af+_0xaf864d;await _0x5be849[_0x198ec8(0x351)]['update']({'where':{'id':_0x389247[_0x198ec8(0x264)]},'data':{'balance':_0x38cdf1,'totalPaidOut':_0xe220e3}}),console['log'](_0x198ec8(0x1e9)+_0x389247['shop'][_0x198ec8(0x315)]+_0x198ec8(0x1c1)),console[_0x198ec8(0x26d)](_0x198ec8(0x2b2)+_0x31dfcc[_0x198ec8(0x28e)](0x6)+_0x198ec8(0x258)+_0x38cdf1['toFixed'](0x6)+_0x198ec8(0x19f)),console[_0x198ec8(0x26d)]('\x20\x20\x20Total\x20paid\x20out:\x20'+_0x5af3af['toFixed'](0x6)+_0x198ec8(0x258)+_0xe220e3[_0x198ec8(0x28e)](0x6)+'\x20USDT');}return console[_0x198ec8(0x26d)](_0x198ec8(0x25b)+_0xaa1cf6+_0x198ec8(0x24e)),_0x10b47f;});return{'id':_0x570488['id'],'shopId':_0x570488[_0x1391ad(0x264)],'shopName':_0x570488[_0x1391ad(0x351)]['name'],'shopUsername':_0x570488['shop']['username'],'amount':Number(_0x570488[_0x1391ad(0x2f3)]),'network':_0x570488[_0x1391ad(0x1fc)],'wallet':_0x570488[_0x1391ad(0x332)],'status':_0x570488[_0x1391ad(0x2cc)],'txid':_0x570488['txid'],'notes':_0x570488[_0x1391ad(0x250)],'periodFrom':_0x570488[_0x1391ad(0x261)],'periodTo':_0x570488['periodTo'],'createdAt':_0x570488[_0x1391ad(0x223)],'paidAt':_0x570488[_0x1391ad(0x304)]};}async['getAllPayments'](_0x12b464){const _0x1b570c=a53_0x21cb2c,{page:_0x36605c,limit:_0x1338fb,status:_0x87a22b,gateway:_0x192677,shopId:_0xf00a55,dateFrom:_0x33bc3e,dateTo:_0x30c020,search:_0x2833db,currency:_0x2013f2,sortBy:_0x4e9836,sortOrder:_0x142cda}=_0x12b464,_0x12af64=(_0x36605c-0x1)*_0x1338fb;console[_0x1b570c(0x26d)](_0x1b570c(0x185),_0x12b464);const _0x16b91d=await database_1[_0x1b570c(0x1fa)]['payment']['groupBy']({'by':[_0x1b570c(0x349)],'_count':{'gateway':!![]}});console[_0x1b570c(0x26d)](_0x1b570c(0x209),_0x16b91d[_0x1b570c(0x34f)](_0x5bb487=>_0x5bb487[_0x1b570c(0x349)]+'\x20('+_0x5bb487[_0x1b570c(0x190)][_0x1b570c(0x349)]+_0x1b570c(0x2a5)));if(_0x192677){const _0x335b68=_0x16b91d[_0x1b570c(0x1d3)](_0x5e931a=>_0x5e931a['gateway'][_0x1b570c(0x259)]()===_0x192677[_0x1b570c(0x259)]());!_0x335b68&&_0x192677[_0x1b570c(0x259)]()!==_0x1b570c(0x1f0)&&console['log'](_0x1b570c(0x28c)+_0x192677+_0x1b570c(0x328)+_0x16b91d[_0x1b570c(0x34f)](_0x255cdd=>_0x255cdd[_0x1b570c(0x349)])[_0x1b570c(0x354)](',\x20'));}const _0x452e6e={};_0x87a22b&&(_0x452e6e['status']=_0x87a22b['toUpperCase']());if(!_0x192677)_0x452e6e[_0x1b570c(0x349)]={'not':'test_gateway'};else{if(_0x192677&&(_0x192677[_0x1b570c(0x259)]()===_0x1b570c(0x1f0)||_0x192677==='0000'))_0x452e6e[_0x1b570c(0x349)]=_0x1b570c(0x1f0);else{let _0x988aac=_0x192677;const _0x5b9de0=(0x0,gateway_1[_0x1b570c(0x263)])(_0x192677);if(_0x5b9de0)_0x988aac=_0x5b9de0,console[_0x1b570c(0x26d)](_0x1b570c(0x293)+_0x192677+_0x1b570c(0x181)+_0x988aac+'\x27');else{const _0x6e90ac=(0x0,gateway_1[_0x1b570c(0x1e6)])(_0x192677);if(_0x6e90ac){const _0x325a2c=(0x0,gateway_1[_0x1b570c(0x263)])(_0x6e90ac);_0x325a2c&&(_0x988aac=_0x325a2c,console[_0x1b570c(0x26d)]('ðŸ”„\x20Converted\x20gateway\x20name\x20\x27'+_0x192677+_0x1b570c(0x272)+_0x6e90ac+_0x1b570c(0x1cb)+_0x988aac+'\x27'));}else console[_0x1b570c(0x26d)](_0x1b570c(0x1d4)+_0x192677+_0x1b570c(0x302));}const _0x584a9f=await database_1[_0x1b570c(0x1fa)][_0x1b570c(0x327)][_0x1b570c(0x19a)]({'where':{'gateway':_0x988aac[_0x1b570c(0x259)]()},'take':0x1});_0x584a9f===0x0?(console[_0x1b570c(0x26d)]('âš ï¸\x20Gateway\x20\x27'+_0x988aac+_0x1b570c(0x2ca)+_0x192677+_0x1b570c(0x183)),_0x452e6e['gateway']='NONEXISTENT_GATEWAY_FILTER'):(_0x452e6e['gateway']=_0x988aac['toLowerCase'](),console[_0x1b570c(0x26d)]('âœ…\x20Using\x20gateway\x20filter:\x20\x27'+_0x988aac+'\x27\x20(from\x20\x27'+_0x192677+'\x27)'));}}console[_0x1b570c(0x26d)](_0x1b570c(0x1b5),_0x452e6e[_0x1b570c(0x349)]);_0xf00a55&&(_0x452e6e['shopId']=_0xf00a55);_0x2013f2&&(_0x452e6e[_0x1b570c(0x2f2)]=_0x2013f2['toUpperCase'](),console[_0x1b570c(0x26d)](_0x1b570c(0x345)+_0x2013f2[_0x1b570c(0x27e)]()));if(_0x33bc3e||_0x30c020){_0x452e6e[_0x1b570c(0x223)]={};if(_0x33bc3e){const _0x54c7e9=new Date(_0x33bc3e),_0x26d852=new Date(Date[_0x1b570c(0x347)](_0x54c7e9['getUTCFullYear'](),_0x54c7e9[_0x1b570c(0x1ba)](),_0x54c7e9[_0x1b570c(0x33f)](),0x0,0x0,0x0,0x0));_0x452e6e[_0x1b570c(0x223)]['gte']=_0x26d852,console['log'](_0x1b570c(0x211)+_0x26d852['toISOString']());}if(_0x30c020){const _0x3654fe=new Date(_0x30c020),_0x5da113=new Date(Date[_0x1b570c(0x347)](_0x3654fe[_0x1b570c(0x2aa)](),_0x3654fe[_0x1b570c(0x1ba)](),_0x3654fe[_0x1b570c(0x33f)](),0x17,0x3b,0x3b,0x3e7));_0x452e6e[_0x1b570c(0x223)][_0x1b570c(0x224)]=_0x5da113,console['log'](_0x1b570c(0x1b8)+_0x5da113[_0x1b570c(0x2d3)]());}}_0x2833db&&(_0x452e6e['OR']=[{'id':{'contains':_0x2833db,'mode':_0x1b570c(0x2af)}},{'orderId':{'contains':_0x2833db,'mode':_0x1b570c(0x2af)}},{'gatewayOrderId':{'contains':_0x2833db,'mode':'insensitive'}},{'customerEmail':{'contains':_0x2833db,'mode':_0x1b570c(0x2af)}},{'shop':{'name':{'contains':_0x2833db,'mode':'insensitive'}}},{'shop':{'username':{'contains':_0x2833db,'mode':'insensitive'}}}]);console['log'](_0x1b570c(0x2c7),JSON[_0x1b570c(0x2b5)](_0x452e6e,null,0x2));const _0xeea259=await database_1[_0x1b570c(0x1fa)][_0x1b570c(0x327)][_0x1b570c(0x19a)]({'where':_0x452e6e});console[_0x1b570c(0x26d)](_0x1b570c(0x2d1)+_0xeea259);let _0x48829b={'createdAt':_0x1b570c(0x295)};if(_0x4e9836){const _0x1e9f4c=[_0x1b570c(0x2f3),_0x1b570c(0x223),'updatedAt',_0x1b570c(0x2cc),'gateway',_0x1b570c(0x2f2)],_0x32a5d9=[_0x1b570c(0x2bc),_0x1b570c(0x295)];if(_0x1e9f4c[_0x1b570c(0x279)](_0x4e9836)){const _0x2e1ca5=_0x32a5d9['includes'](_0x142cda)?_0x142cda:_0x1b570c(0x295);_0x48829b={[_0x4e9836]:_0x2e1ca5},console[_0x1b570c(0x26d)](_0x1b570c(0x26c)+_0x4e9836+'\x20in\x20'+_0x2e1ca5+_0x1b570c(0x1d9));}}const [_0x399f1f,_0xb813ce]=await Promise[_0x1b570c(0x1c6)]([database_1[_0x1b570c(0x1fa)]['payment'][_0x1b570c(0x27f)]({'where':_0x452e6e,'skip':_0x12af64,'take':_0x1338fb,'orderBy':_0x48829b,'include':{'shop':{'select':{'name':!![],'username':!![]}}}}),database_1['default']['payment']['count']({'where':_0x452e6e})]);let _0x407cff,_0x565031;if(_0x33bc3e){const _0x528be4=new Date(_0x33bc3e);_0x407cff=new Date(Date[_0x1b570c(0x347)](_0x528be4[_0x1b570c(0x2aa)](),_0x528be4['getUTCMonth'](),_0x528be4['getUTCDate'](),0x0,0x0,0x0,0x0));}else{const _0x42faa7=new Date();_0x407cff=new Date(Date[_0x1b570c(0x347)](_0x42faa7[_0x1b570c(0x2aa)](),_0x42faa7[_0x1b570c(0x1ba)](),_0x42faa7[_0x1b570c(0x33f)](),0x0,0x0,0x0,0x0));}if(_0x30c020){const _0x5b085f=new Date(_0x30c020);_0x565031=new Date(Date['UTC'](_0x5b085f['getUTCFullYear'](),_0x5b085f[_0x1b570c(0x1ba)](),_0x5b085f[_0x1b570c(0x33f)](),0x17,0x3b,0x3b,0x3e7));}else{if(_0x33bc3e){const _0x36ea94=new Date(_0x33bc3e);_0x565031=new Date(Date[_0x1b570c(0x347)](_0x36ea94['getUTCFullYear'](),_0x36ea94[_0x1b570c(0x1ba)](),_0x36ea94['getUTCDate'](),0x17,0x3b,0x3b,0x3e7));}else{const _0x57d478=new Date();_0x565031=new Date(Date['UTC'](_0x57d478[_0x1b570c(0x2aa)](),_0x57d478[_0x1b570c(0x1ba)](),_0x57d478[_0x1b570c(0x33f)](),0x17,0x3b,0x3b,0x3e7));}}const _0x2fd151={};{const _0x24b5c0={'status':_0x87a22b?_0x87a22b[_0x1b570c(0x27e)]():_0x1b570c(0x268),'createdAt':{'gte':_0x407cff,'lte':_0x565031}};_0x192677?_0x24b5c0['gateway']=_0x452e6e[_0x1b570c(0x349)]:_0x24b5c0[_0x1b570c(0x349)]={'not':_0x1b570c(0x1f0)};_0xf00a55&&(_0x24b5c0[_0x1b570c(0x264)]=_0xf00a55);_0x2013f2&&(_0x24b5c0[_0x1b570c(0x2f2)]=_0x2013f2['toUpperCase']());console['log'](_0x1b570c(0x193),JSON['stringify'](_0x24b5c0,null,0x2));const _0x5142cf=await database_1[_0x1b570c(0x1fa)]['payment']['findMany']({'where':_0x24b5c0,'select':{'amountUSDT':!![],'currency':!![],'amount':!![]}});let _0x981be0=0x0;_0x5142cf[_0x1b570c(0x1c5)](_0x377be7=>{const _0x44cd1a=_0x1b570c;_0x377be7['amountUSDT']&&(_0x981be0+=_0x377be7[_0x44cd1a(0x306)]);if(_0x377be7[_0x44cd1a(0x2f2)]){const _0x1128d7=_0x377be7['currency'][_0x44cd1a(0x27e)]();!_0x2fd151[_0x1128d7]&&(_0x2fd151[_0x1128d7]=0x0),_0x2fd151[_0x1128d7]+=_0x377be7[_0x44cd1a(0x2f3)];}}),_0x981be0>0x0&&(_0x2fd151[_0x1b570c(0x246)]=_0x981be0);}return{'payments':_0x399f1f,'pagination':{'page':_0x36605c,'limit':_0x1338fb,'total':_0xb813ce,'totalPages':Math[_0x1b570c(0x1ef)](_0xb813ce/_0x1338fb)},'statistics':_0x2fd151};}async[a53_0x21cb2c(0x256)](_0x514a13){const _0x2e3638=a53_0x21cb2c,_0x2b65cb=await database_1[_0x2e3638(0x1fa)][_0x2e3638(0x327)]['findUnique']({'where':{'id':_0x514a13},'select':{'id':!![],'shopId':!![],'amount':!![],'amountAfterGatewayCommissionUSDT':!![],'currency':!![],'sourceCurrency':!![],'status':!![],'gateway':!![],'orderId':!![],'gatewayOrderId':!![],'gatewayPaymentId':!![],'customerEmail':!![],'customerName':!![],'customerCountry':!![],'customerIp':!![],'customerUa':!![],'externalPaymentUrl':!![],'successUrl':!![],'failUrl':!![],'pendingUrl':!![],'whiteUrl':!![],'expiresAt':!![],'invoiceTotalSum':!![],'qrCode':!![],'qrUrl':!![],'country':!![],'language':!![],'amountIsEditable':!![],'maxPayments':!![],'rapydCustomer':!![],'cardLast4':!![],'paymentMethod':!![],'bankId':!![],'remitterIban':!![],'remitterName':!![],'failureMessage':!![],'usage':!![],'createdAt':!![],'updatedAt':!![],'shop':{'select':{'name':!![],'username':!![]}}}});if(!_0x2b65cb)return null;return{'id':_0x2b65cb['id'],'shopId':_0x2b65cb[_0x2e3638(0x264)],'gateway':_0x2b65cb[_0x2e3638(0x349)],'amount':_0x2b65cb[_0x2e3638(0x2f3)],'currency':_0x2b65cb['currency'],'status':_0x2b65cb[_0x2e3638(0x2cc)],'orderId':_0x2b65cb[_0x2e3638(0x2a0)],'gatewayOrderId':_0x2b65cb[_0x2e3638(0x34a)],'customerEmail':_0x2b65cb[_0x2e3638(0x17e)],'customerName':_0x2b65cb[_0x2e3638(0x228)],'customerCountry':_0x2b65cb['customerCountry'],'customerIp':_0x2b65cb[_0x2e3638(0x1dc)],'customerUa':_0x2b65cb[_0x2e3638(0x2b1)],'failureMessage':_0x2b65cb[_0x2e3638(0x195)],'externalPaymentUrl':_0x2b65cb['externalPaymentUrl'],'successUrl':_0x2b65cb[_0x2e3638(0x2ce)],'failUrl':_0x2b65cb[_0x2e3638(0x2fb)],'pendingUrl':_0x2b65cb[_0x2e3638(0x17d)],'whiteUrl':_0x2b65cb['whiteUrl'],'createdAt':_0x2b65cb[_0x2e3638(0x223)],'updatedAt':_0x2b65cb[_0x2e3638(0x1ab)],'shop':_0x2b65cb[_0x2e3638(0x351)]};}async[a53_0x21cb2c(0x291)](_0x5ee17f,_0x5c90c2,_0x35675b,_0x363ca9){const _0x289e44=a53_0x21cb2c,_0x464004=await database_1[_0x289e44(0x1fa)][_0x289e44(0x1a0)](async _0x545c04=>{const _0x10ff40=_0x289e44,_0x2ba8bf=await _0x545c04[_0x10ff40(0x327)]['findUnique']({'where':{'id':_0x5ee17f},'include':{'shop':{'select':{'id':!![],'name':!![],'username':!![],'balance':!![]}}}});if(!_0x2ba8bf)throw new Error(_0x10ff40(0x33b));const _0x5b9c17=_0x2ba8bf[_0x10ff40(0x2cc)],_0x5b9a73=_0x5c90c2[_0x10ff40(0x27e)]();console[_0x10ff40(0x26d)](_0x10ff40(0x352)+_0x5ee17f+_0x10ff40(0x2ed)+_0x5b9c17+_0x10ff40(0x258)+_0x5b9a73),console['log'](_0x10ff40(0x339)+_0x2ba8bf[_0x10ff40(0x351)][_0x10ff40(0x2ee)]+_0x10ff40(0x19f));const _0x4f7c0f={'status':_0x5b9a73,'updatedAt':new Date(),'statusChangedBy':_0x10ff40(0x257),'statusChangedAt':new Date()};_0x35675b&&(_0x4f7c0f[_0x10ff40(0x1cd)]=_0x35675b);_0x5b9a73===_0x10ff40(0x184)&&_0x363ca9&&(_0x4f7c0f[_0x10ff40(0x1c2)]=_0x363ca9);let _0x57b4b0=0x0,_0x13edae=_0x2ba8bf[_0x10ff40(0x351)][_0x10ff40(0x2ee)];if(_0x5b9a73===_0x10ff40(0x268)&&_0x5b9c17!==_0x10ff40(0x268)){_0x4f7c0f['paidAt']=new Date();const _0x62ace6=await currencyService_1[_0x10ff40(0x249)][_0x10ff40(0x34c)](_0x2ba8bf[_0x10ff40(0x2f3)],_0x2ba8bf[_0x10ff40(0x2f2)]);_0x4f7c0f['amountUSDT']=_0x62ace6;let _0x32035e=0x2d;const _0x2b7ea0=await _0x545c04[_0x10ff40(0x351)][_0x10ff40(0x2fd)]({'where':{'id':_0x2ba8bf[_0x10ff40(0x264)]},'select':{'gatewaySettings':!![]}});if(_0x2b7ea0?.[_0x10ff40(0x316)])try{const _0xbb8c71=JSON['parse'](_0x2b7ea0[_0x10ff40(0x316)]);for(const [_0x2e8919,_0x4ac4e5]of Object['entries'](_0xbb8c71)){if(_0x2e8919[_0x10ff40(0x259)]()===_0x2ba8bf[_0x10ff40(0x349)]['toLowerCase']()){_0x32035e=_0x4ac4e5['commission']||0xa;break;}}}catch(_0x1c6ca8){console['error'](_0x10ff40(0x198)+_0x5ee17f+':',_0x1c6ca8);}let _0x447645;_0x2ba8bf[_0x10ff40(0x2f9)]!==null&&_0x2ba8bf[_0x10ff40(0x2f9)]!==undefined?(_0x447645=_0x2ba8bf[_0x10ff40(0x2f9)],console[_0x10ff40(0x26d)](_0x10ff40(0x348)+_0x447645['toFixed'](0x6)+_0x10ff40(0x1c8)+_0x5ee17f)):(_0x447645=_0x62ace6*(0x1-_0x32035e/0x64),console[_0x10ff40(0x26d)](_0x10ff40(0x30b)+_0x5ee17f+':\x20'+_0x32035e+_0x10ff40(0x1fd)+_0x62ace6[_0x10ff40(0x28e)](0x6)+'\x20USDT'),_0x4f7c0f['amountAfterGatewayCommissionUSDT']=_0x447645,_0x4f7c0f[_0x10ff40(0x324)]=_0x32035e),_0x57b4b0=_0x447645,_0x13edae+=_0x447645,console[_0x10ff40(0x26d)](_0x10ff40(0x2d0)+_0x5ee17f+_0x10ff40(0x2f6)),console['log']('\x20\x20\x20Full\x20amount:\x20'+_0x62ace6[_0x10ff40(0x28e)](0x6)+_0x10ff40(0x19f)),console['log']('\x20\x20\x20Gateway:\x20'+_0x2ba8bf[_0x10ff40(0x349)]+_0x10ff40(0x2f5)+_0x32035e+'%'),console[_0x10ff40(0x26d)](_0x10ff40(0x343)+_0x447645[_0x10ff40(0x28e)](0x6)+_0x10ff40(0x2e2)+_0x32035e+_0x10ff40(0x2cb)),console[_0x10ff40(0x26d)](_0x10ff40(0x2d7)+_0x447645[_0x10ff40(0x28e)](0x6)+_0x10ff40(0x19f));}else{if(_0x5b9c17==='PAID'&&_0x5b9a73!==_0x10ff40(0x268)&&_0x5b9a73!==_0x10ff40(0x184)){if(_0x2ba8bf['amountUSDT']){let _0x3aa22d=0x2d;const _0x522cfc=await _0x545c04[_0x10ff40(0x351)][_0x10ff40(0x2fd)]({'where':{'id':_0x2ba8bf[_0x10ff40(0x264)]},'select':{'gatewaySettings':!![]}});if(_0x522cfc?.['gatewaySettings'])try{const _0x49d541=JSON[_0x10ff40(0x18e)](_0x522cfc['gatewaySettings']);for(const [_0x1d87dd,_0x3541d3]of Object[_0x10ff40(0x242)](_0x49d541)){if(_0x1d87dd[_0x10ff40(0x259)]()===_0x2ba8bf['gateway'][_0x10ff40(0x259)]()){_0x3aa22d=_0x3541d3[_0x10ff40(0x1d6)]||0xa;break;}}}catch(_0x52a01f){console[_0x10ff40(0x1a3)](_0x10ff40(0x198)+_0x5ee17f+':',_0x52a01f);}const _0x40b1b0=_0x2ba8bf[_0x10ff40(0x306)]*(0x1-_0x3aa22d/0x64);_0x57b4b0=-_0x40b1b0,_0x13edae-=_0x40b1b0,console['log'](_0x10ff40(0x1ac)+_0x2ba8bf[_0x10ff40(0x306)][_0x10ff40(0x28e)](0x6)+_0x10ff40(0x19f)),console['log'](_0x10ff40(0x1d5)+_0x2ba8bf[_0x10ff40(0x349)]+_0x10ff40(0x2f5)+_0x3aa22d+'%'),console[_0x10ff40(0x26d)]('\x20\x20\x20Merchant\x20loses:\x20'+_0x40b1b0[_0x10ff40(0x28e)](0x6)+_0x10ff40(0x2e2)+_0x3aa22d+_0x10ff40(0x2cb)),console[_0x10ff40(0x26d)](_0x10ff40(0x2bb)+_0x40b1b0[_0x10ff40(0x28e)](0x6)+_0x10ff40(0x19f));}}}_0x5b9a73==='CHARGEBACK'&&(console[_0x10ff40(0x26d)](_0x10ff40(0x214)),_0x363ca9&&_0x363ca9>0x0?(_0x57b4b0=-_0x363ca9,_0x13edae-=_0x363ca9,console['log'](_0x10ff40(0x2bd)+_0x363ca9[_0x10ff40(0x28e)](0x6)+'\x20USDT\x20from\x20balance'),console[_0x10ff40(0x26d)](_0x10ff40(0x25e))):console[_0x10ff40(0x26d)](_0x10ff40(0x22e)),_0x4f7c0f[_0x10ff40(0x1c2)]=_0x363ca9||0x0);_0x5b9a73===_0x10ff40(0x2fa)&&_0x5b9c17==='PAID'&&console[_0x10ff40(0x26d)]('ðŸ”„\x20REFUND:\x20Payment\x20amount\x20already\x20deducted\x20from\x20balance');const _0x145d9d=await _0x545c04['payment'][_0x10ff40(0x253)]({'where':{'id':_0x5ee17f},'data':_0x4f7c0f,'include':{'shop':{'select':{'name':!![],'username':!![]}}}});return _0x57b4b0!==0x0&&(await _0x545c04[_0x10ff40(0x351)]['update']({'where':{'id':_0x2ba8bf[_0x10ff40(0x264)]},'data':{'balance':_0x13edae}}),console[_0x10ff40(0x26d)]('ðŸ’°\x20Shop\x20'+_0x2ba8bf[_0x10ff40(0x264)]+_0x10ff40(0x1ea)+_0x2ba8bf[_0x10ff40(0x351)][_0x10ff40(0x2ee)]['toFixed'](0x6)+'\x20->\x20'+_0x13edae[_0x10ff40(0x28e)](0x6)+_0x10ff40(0x33d)+(_0x57b4b0>0x0?'+':'')+_0x57b4b0[_0x10ff40(0x28e)](0x6)+')')),_0x145d9d;});return{'id':_0x464004['id'],'shopId':_0x464004[_0x289e44(0x264)],'gateway':_0x464004[_0x289e44(0x349)],'amount':_0x464004[_0x289e44(0x2f3)],'currency':_0x464004[_0x289e44(0x2f2)],'status':_0x464004[_0x289e44(0x2cc)],'orderId':_0x464004['orderId'],'gatewayOrderId':_0x464004[_0x289e44(0x34a)],'customerEmail':_0x464004['customerEmail'],'customerName':_0x464004[_0x289e44(0x228)],'customerCountry':_0x464004[_0x289e44(0x230)],'customerIp':_0x464004[_0x289e44(0x1dc)],'customerUa':_0x464004[_0x289e44(0x2b1)],'failureMessage':_0x464004['failureMessage'],'adminNotes':_0x464004['adminNotes'],'chargebackAmount':_0x464004[_0x289e44(0x1c2)],'statusChangedBy':_0x464004[_0x289e44(0x333)],'statusChangedAt':_0x464004[_0x289e44(0x29a)],'createdAt':_0x464004['createdAt'],'updatedAt':_0x464004[_0x289e44(0x1ab)],'shop':_0x464004[_0x289e44(0x351)]};}async[a53_0x21cb2c(0x31a)](_0x3bb28c,_0x1faff){const _0xea1d50=a53_0x21cb2c,_0x162655=Math['random']()[_0xea1d50(0x2e4)](0x24)['substr'](0x2,0x9);console[_0xea1d50(0x26d)]('ðŸŽ¯\x20updateUser\x20called\x20with\x20ID:\x20'+_0x162655+_0xea1d50(0x320)+_0x3bb28c);const _0x19b868={..._0x1faff};_0x1faff[_0xea1d50(0x1bd)]&&_0x1faff['password'][_0xea1d50(0x1e4)]()!==''?(console[_0xea1d50(0x26d)](_0xea1d50(0x17a)+_0x162655+_0xea1d50(0x2c4)+_0x3bb28c),_0x19b868[_0xea1d50(0x1bd)]=await bcryptjs_1['default'][_0xea1d50(0x287)](_0x1faff['password'],0xc)):(console['log'](_0xea1d50(0x17a)+_0x162655+_0xea1d50(0x2a6)),delete _0x19b868['password']);_0x1faff[_0xea1d50(0x2e8)]&&(_0x19b868['name']=_0x1faff[_0xea1d50(0x2e8)],delete _0x19b868[_0xea1d50(0x2e8)]);_0x1faff[_0xea1d50(0x2c8)]&&(_0x19b868[_0xea1d50(0x182)]=_0x1faff['telegramId'],delete _0x19b868[_0xea1d50(0x2c8)]);_0x1faff[_0xea1d50(0x18a)]!==undefined&&(_0x19b868[_0xea1d50(0x25f)]=_0x1faff[_0xea1d50(0x18a)]||null,delete _0x19b868[_0xea1d50(0x18a)]);_0x1faff[_0xea1d50(0x1a9)]!==undefined&&(_0x19b868[_0xea1d50(0x1cf)]=_0x1faff[_0xea1d50(0x1a9)]||null,delete _0x19b868[_0xea1d50(0x1a9)]);_0x1faff[_0xea1d50(0x29e)]!==undefined&&(_0x19b868['shopUrl3']=_0x1faff[_0xea1d50(0x29e)]||null,delete _0x19b868[_0xea1d50(0x29e)]);_0x1faff[_0xea1d50(0x340)]!==undefined&&(_0x19b868[_0xea1d50(0x234)]=_0x1faff[_0xea1d50(0x340)]||null,delete _0x19b868['merchantUrl4']);if(_0x1faff[_0xea1d50(0x1e7)]){const _0x35be9d=_0x1faff[_0xea1d50(0x1e7)]['map'](_0x50ef23=>this['getGatewayInternalName'](_0x50ef23));console['log'](_0xea1d50(0x244),_0x1faff[_0xea1d50(0x1e7)],'->',_0x35be9d),_0x19b868[_0xea1d50(0x2ff)]=JSON[_0xea1d50(0x2b5)](_0x35be9d),delete _0x19b868[_0xea1d50(0x1e7)];}_0x1faff[_0xea1d50(0x316)]&&(console['log']('ðŸ”§\x20['+_0x162655+_0xea1d50(0x210),_0x1faff['gatewaySettings']),_0x19b868['gatewaySettings']=JSON[_0xea1d50(0x2b5)](_0x1faff['gatewaySettings']),console[_0xea1d50(0x26d)](_0xea1d50(0x310)+_0x162655+']\x20Gateway\x20settings\x20JSON\x20string:',_0x19b868[_0xea1d50(0x316)]));_0x1faff[_0xea1d50(0x221)]&&(_0x1faff[_0xea1d50(0x221)][_0xea1d50(0x23c)]!==undefined&&(_0x19b868[_0xea1d50(0x23c)]=_0x1faff[_0xea1d50(0x221)][_0xea1d50(0x23c)]||null),_0x1faff[_0xea1d50(0x221)][_0xea1d50(0x233)]!==undefined&&(_0x19b868['usdtTrcWallet']=_0x1faff[_0xea1d50(0x221)][_0xea1d50(0x233)]||null),_0x1faff[_0xea1d50(0x221)][_0xea1d50(0x2f0)]!==undefined&&(_0x19b868[_0xea1d50(0x2f0)]=_0x1faff[_0xea1d50(0x221)][_0xea1d50(0x2f0)]||null),_0x1faff[_0xea1d50(0x221)][_0xea1d50(0x207)]!==undefined&&(_0x19b868['usdcPolygonWallet']=_0x1faff[_0xea1d50(0x221)][_0xea1d50(0x207)]||null),delete _0x19b868['wallets']);const _0x4d2360=await database_1['default'][_0xea1d50(0x351)][_0xea1d50(0x253)]({'where':{'id':_0x3bb28c},'data':_0x19b868,'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'shopUrl2':!![],'shopUrl3':!![],'shopUrl4':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});return console[_0xea1d50(0x26d)](_0xea1d50(0x303)+_0x162655+_0xea1d50(0x277),_0x4d2360[_0xea1d50(0x316)]),{'id':_0x4d2360['id'],'fullName':_0x4d2360['name'],'username':_0x4d2360[_0xea1d50(0x315)],'telegramId':_0x4d2360[_0xea1d50(0x182)],'merchantUrl':_0x4d2360[_0xea1d50(0x25f)],'merchantUrl2':_0x4d2360[_0xea1d50(0x1cf)],'merchantUrl3':_0x4d2360['shopUrl3'],'merchantUrl4':_0x4d2360['shopUrl4'],'gateways':_0x4d2360[_0xea1d50(0x2ff)]?JSON[_0xea1d50(0x18e)](_0x4d2360[_0xea1d50(0x2ff)]):null,'gatewaySettings':_0x4d2360[_0xea1d50(0x316)]?JSON[_0xea1d50(0x18e)](_0x4d2360[_0xea1d50(0x316)]):null,'publicKey':_0x4d2360['publicKey'],'wallets':{'usdtPolygonWallet':_0x4d2360['usdtPolygonWallet'],'usdtTrcWallet':_0x4d2360[_0xea1d50(0x233)],'usdtErcWallet':_0x4d2360[_0xea1d50(0x2f0)],'usdcPolygonWallet':_0x4d2360[_0xea1d50(0x207)]},'status':_0x4d2360['status'],'createdAt':_0x4d2360[_0xea1d50(0x223)]};}async[a53_0x21cb2c(0x26e)](_0x18e0f2){const _0x441aa6=a53_0x21cb2c,_0x4c5fa3=await database_1[_0x441aa6(0x1fa)][_0x441aa6(0x351)][_0x441aa6(0x253)]({'where':{'id':_0x18e0f2},'data':{'status':_0x441aa6(0x353)},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'shopUrl2':!![],'shopUrl3':!![],'shopUrl4':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});return{'id':_0x4c5fa3['id'],'fullName':_0x4c5fa3[_0x441aa6(0x314)],'username':_0x4c5fa3['username'],'telegramId':_0x4c5fa3['telegram'],'merchantUrl':_0x4c5fa3[_0x441aa6(0x25f)],'merchantUrl2':_0x4c5fa3[_0x441aa6(0x1cf)],'merchantUrl3':_0x4c5fa3[_0x441aa6(0x20b)],'merchantUrl4':_0x4c5fa3['shopUrl4'],'gateways':_0x4c5fa3[_0x441aa6(0x2ff)]?JSON[_0x441aa6(0x18e)](_0x4c5fa3[_0x441aa6(0x2ff)]):null,'gatewaySettings':_0x4c5fa3['gatewaySettings']?JSON[_0x441aa6(0x18e)](_0x4c5fa3['gatewaySettings']):null,'publicKey':_0x4c5fa3[_0x441aa6(0x2b8)],'wallets':{'usdtPolygonWallet':_0x4c5fa3[_0x441aa6(0x23c)],'usdtTrcWallet':_0x4c5fa3[_0x441aa6(0x233)],'usdtErcWallet':_0x4c5fa3[_0x441aa6(0x2f0)],'usdcPolygonWallet':_0x4c5fa3['usdcPolygonWallet']},'status':_0x4c5fa3[_0x441aa6(0x2cc)],'createdAt':_0x4c5fa3[_0x441aa6(0x223)]};}async[a53_0x21cb2c(0x2b7)](_0x460366){const _0x354eca=a53_0x21cb2c,_0x5afc4e=await database_1['default'][_0x354eca(0x351)]['update']({'where':{'id':_0x460366},'data':{'status':_0x354eca(0x25c)},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'shopUrl2':!![],'shopUrl3':!![],'shopUrl4':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});return{'id':_0x5afc4e['id'],'fullName':_0x5afc4e[_0x354eca(0x314)],'username':_0x5afc4e['username'],'telegramId':_0x5afc4e[_0x354eca(0x182)],'merchantUrl':_0x5afc4e[_0x354eca(0x25f)],'merchantUrl2':_0x5afc4e[_0x354eca(0x1cf)],'merchantUrl3':_0x5afc4e[_0x354eca(0x20b)],'merchantUrl4':_0x5afc4e['shopUrl4'],'gateways':_0x5afc4e[_0x354eca(0x2ff)]?JSON['parse'](_0x5afc4e[_0x354eca(0x2ff)]):null,'gatewaySettings':_0x5afc4e[_0x354eca(0x316)]?JSON[_0x354eca(0x18e)](_0x5afc4e[_0x354eca(0x316)]):null,'publicKey':_0x5afc4e['publicKey'],'wallets':{'usdtPolygonWallet':_0x5afc4e[_0x354eca(0x23c)],'usdtTrcWallet':_0x5afc4e[_0x354eca(0x233)],'usdtErcWallet':_0x5afc4e[_0x354eca(0x2f0)],'usdcPolygonWallet':_0x5afc4e[_0x354eca(0x207)]},'status':_0x5afc4e[_0x354eca(0x2cc)],'createdAt':_0x5afc4e['createdAt']};}async['getAllUsers'](_0x3af1ec){const _0x45d19f=a53_0x21cb2c,{page:_0x3e332b,limit:_0x3b5511,status:_0x1aa501,search:_0x13e3ba}=_0x3af1ec,_0x2fd7b0=(_0x3e332b-0x1)*_0x3b5511,_0x14dcdd={};_0x1aa501&&(_0x14dcdd[_0x45d19f(0x2cc)]=_0x1aa501[_0x45d19f(0x27e)]());_0x13e3ba&&(_0x14dcdd['OR']=[{'name':{'contains':_0x13e3ba,'mode':_0x45d19f(0x2af)}},{'username':{'contains':_0x13e3ba,'mode':_0x45d19f(0x2af)}},{'telegram':{'contains':_0x13e3ba,'mode':_0x45d19f(0x2af)}},{'shopUrl':{'contains':_0x13e3ba,'mode':_0x45d19f(0x2af)}}]);const [_0xfa6ece,_0x257597]=await Promise[_0x45d19f(0x1c6)]([database_1['default'][_0x45d19f(0x351)][_0x45d19f(0x27f)]({'where':_0x14dcdd,'skip':_0x2fd7b0,'take':_0x3b5511,'orderBy':{'createdAt':'desc'},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'shopUrl2':!![],'shopUrl3':!![],'shopUrl4':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'usdcErcWallet':!![],'status':!![],'twoFactorEnabled':!![],'createdAt':!![],'lastLoginAt':!![],'_count':{'select':{'telegramUsers':!![]}}}}),database_1['default'][_0x45d19f(0x351)]['count']({'where':_0x14dcdd})]);return{'users':_0xfa6ece[_0x45d19f(0x34f)](_0x44dc9b=>{const _0x12f8c3=_0x45d19f,_0x241c6c=_0x44dc9b[_0x12f8c3(0x2ff)]?JSON['parse'](_0x44dc9b[_0x12f8c3(0x2ff)]):null,_0x53c7e2=_0x241c6c?_0x241c6c[_0x12f8c3(0x34f)](_0x1157e3=>this[_0x12f8c3(0x186)](_0x1157e3)):null;return{'id':_0x44dc9b['id'],'fullName':_0x44dc9b['name'],'username':_0x44dc9b[_0x12f8c3(0x315)],'telegramId':_0x44dc9b['telegram'],'merchantUrl':_0x44dc9b[_0x12f8c3(0x25f)],'merchantUrl2':_0x44dc9b[_0x12f8c3(0x1cf)],'merchantUrl3':_0x44dc9b[_0x12f8c3(0x20b)],'merchantUrl4':_0x44dc9b[_0x12f8c3(0x234)],'gateways':_0x53c7e2,'gatewaySettings':_0x44dc9b[_0x12f8c3(0x316)]?JSON[_0x12f8c3(0x18e)](_0x44dc9b[_0x12f8c3(0x316)]):null,'publicKey':_0x44dc9b[_0x12f8c3(0x2b8)],'wallets':{'usdtPolygonWallet':_0x44dc9b[_0x12f8c3(0x23c)],'usdtTrcWallet':_0x44dc9b[_0x12f8c3(0x233)],'usdtErcWallet':_0x44dc9b[_0x12f8c3(0x2f0)],'usdcPolygonWallet':_0x44dc9b['usdcPolygonWallet'],'usdcErcWallet':_0x44dc9b[_0x12f8c3(0x262)]},'status':_0x44dc9b[_0x12f8c3(0x2cc)],'twoFactorEnabled':_0x44dc9b['twoFactorEnabled']||![],'telegramUsersCount':_0x44dc9b[_0x12f8c3(0x190)]['telegramUsers'],'createdAt':_0x44dc9b[_0x12f8c3(0x223)],'lastLoginAt':_0x44dc9b[_0x12f8c3(0x1f7)]};}),'pagination':{'page':_0x3e332b,'limit':_0x3b5511,'total':_0x257597,'totalPages':Math[_0x45d19f(0x1ef)](_0x257597/_0x3b5511)}};}async[a53_0x21cb2c(0x2a3)](_0x19352b){const _0x26c5a2=a53_0x21cb2c,_0x5f1767=await database_1['default'][_0x26c5a2(0x351)][_0x26c5a2(0x2fd)]({'where':{'id':_0x19352b},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'shopUrl2':!![],'shopUrl3':!![],'shopUrl4':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'usdcErcWallet':!![],'status':!![],'createdAt':!![]}});if(!_0x5f1767)return null;const _0x3478da=_0x5f1767['paymentGateways']?JSON['parse'](_0x5f1767[_0x26c5a2(0x2ff)]):null,_0x5c597b=_0x3478da?_0x3478da[_0x26c5a2(0x34f)](_0xe43e2d=>this[_0x26c5a2(0x186)](_0xe43e2d)):null;return _0x3478da&&_0x5c597b&&console[_0x26c5a2(0x26d)](_0x26c5a2(0x217),_0x3478da,'->',_0x5c597b),{'id':_0x5f1767['id'],'fullName':_0x5f1767[_0x26c5a2(0x314)],'username':_0x5f1767[_0x26c5a2(0x315)],'telegramId':_0x5f1767[_0x26c5a2(0x182)],'merchantUrl':_0x5f1767[_0x26c5a2(0x25f)],'merchantUrl2':_0x5f1767['shopUrl2'],'merchantUrl3':_0x5f1767['shopUrl3'],'merchantUrl4':_0x5f1767[_0x26c5a2(0x234)],'gateways':_0x5c597b,'gatewaySettings':_0x5f1767[_0x26c5a2(0x316)]?JSON[_0x26c5a2(0x18e)](_0x5f1767[_0x26c5a2(0x316)]):null,'publicKey':_0x5f1767[_0x26c5a2(0x2b8)],'wallets':{'usdtPolygonWallet':_0x5f1767['usdtPolygonWallet'],'usdtTrcWallet':_0x5f1767['usdtTrcWallet'],'usdtErcWallet':_0x5f1767[_0x26c5a2(0x2f0)],'usdcPolygonWallet':_0x5f1767['usdcPolygonWallet'],'usdcErcWallet':_0x5f1767[_0x26c5a2(0x262)]},'status':_0x5f1767[_0x26c5a2(0x2cc)],'createdAt':_0x5f1767[_0x26c5a2(0x223)]};}async['createUser'](_0x1922a8){const _0x420191=a53_0x21cb2c,{fullName:_0x5838aa,username:_0x368032,password:_0xbc8f74,telegramId:_0x47f8e1,merchantUrl:_0x25105f,gateways:_0x19ec6d,gatewaySettings:_0x407a56,wallets:_0x5414af}=_0x1922a8,_0x1db2be=await database_1[_0x420191(0x1fa)][_0x420191(0x351)][_0x420191(0x2fd)]({'where':{'username':_0x368032}});if(_0x1db2be)throw new Error(_0x420191(0x23f));if(_0x47f8e1){const _0x343a7b=await database_1[_0x420191(0x1fa)][_0x420191(0x351)][_0x420191(0x2fd)]({'where':{'telegram':_0x47f8e1}});if(_0x343a7b)throw new Error('Telegram\x20username\x20already\x20exists');}const _0x57ed51=await bcryptjs_1[_0x420191(0x1fa)][_0x420191(0x287)](_0xbc8f74,0xc),_0x240949=_0x420191(0x29b)+crypto_1[_0x420191(0x1fa)][_0x420191(0x1bb)](0x20)[_0x420191(0x2e4)](_0x420191(0x31b)),_0x134b75=_0x420191(0x341)+crypto_1[_0x420191(0x1fa)][_0x420191(0x1bb)](0x20)[_0x420191(0x2e4)](_0x420191(0x31b)),_0x268c9d=_0x19ec6d?_0x19ec6d[_0x420191(0x34f)](_0x39936c=>this[_0x420191(0x297)](_0x39936c)):null;_0x19ec6d&&_0x268c9d&&console[_0x420191(0x26d)](_0x420191(0x2eb),_0x19ec6d,'->',_0x268c9d);const _0x42050a=await database_1[_0x420191(0x1fa)][_0x420191(0x351)][_0x420191(0x1c4)]({'data':{'name':_0x5838aa,'username':_0x368032,'password':_0x57ed51,'telegram':_0x47f8e1,'shopUrl':_0x25105f,'shopUrl2':_0x1922a8['merchantUrl2']||null,'shopUrl3':_0x1922a8[_0x420191(0x29e)]||null,'shopUrl4':_0x1922a8['merchantUrl4']||null,'paymentGateways':_0x268c9d?JSON[_0x420191(0x2b5)](_0x268c9d):null,'gatewaySettings':_0x407a56?JSON[_0x420191(0x2b5)](_0x407a56):null,'usdtPolygonWallet':_0x5414af?.['usdtPolygonWallet']||null,'usdtTrcWallet':_0x5414af?.[_0x420191(0x233)]||null,'usdtErcWallet':_0x5414af?.['usdtErcWallet']||null,'usdcPolygonWallet':_0x5414af?.['usdcPolygonWallet']||null,'publicKey':_0x240949,'secretKey':_0x134b75,'status':_0x420191(0x25c)},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'shopUrl2':!![],'shopUrl3':!![],'shopUrl4':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});return{'id':_0x42050a['id'],'fullName':_0x42050a[_0x420191(0x314)],'username':_0x42050a['username'],'telegramId':_0x42050a[_0x420191(0x182)],'merchantUrl':_0x42050a[_0x420191(0x25f)],'merchantUrl2':_0x42050a[_0x420191(0x1cf)],'merchantUrl3':_0x42050a[_0x420191(0x20b)],'merchantUrl4':_0x42050a[_0x420191(0x234)],'gateways':_0x42050a[_0x420191(0x2ff)]?JSON['parse'](_0x42050a[_0x420191(0x2ff)]):null,'gatewaySettings':_0x42050a['gatewaySettings']?JSON['parse'](_0x42050a[_0x420191(0x316)]):null,'publicKey':_0x42050a[_0x420191(0x2b8)],'wallets':{'usdtPolygonWallet':_0x42050a[_0x420191(0x23c)],'usdtTrcWallet':_0x42050a[_0x420191(0x233)],'usdtErcWallet':_0x42050a[_0x420191(0x2f0)],'usdcPolygonWallet':_0x42050a[_0x420191(0x207)]},'status':_0x42050a[_0x420191(0x2cc)],'createdAt':_0x42050a[_0x420191(0x223)]};}async['deleteUser'](_0x33ea1b,_0x2e884a){const _0x1acd6b=a53_0x21cb2c;if(config_1[_0x1acd6b(0x2db)]['admin']['twoFactorEnabled']){if(!_0x2e884a)throw new Error(_0x1acd6b(0x335));const _0x31c5ac=speakeasy_1['default'][_0x1acd6b(0x280)][_0x1acd6b(0x276)]({'secret':config_1[_0x1acd6b(0x2db)][_0x1acd6b(0x257)]['twoFactorSecret'],'encoding':_0x1acd6b(0x187),'token':_0x2e884a,'window':0x2});if(!_0x31c5ac){let _0xb98acb=![];if(config_1[_0x1acd6b(0x2db)][_0x1acd6b(0x257)][_0x1acd6b(0x2da)]){const _0xd14ed5=JSON['parse'](config_1[_0x1acd6b(0x2db)][_0x1acd6b(0x257)]['backupCodes']);for(let _0x2340da=0x0;_0x2340da<_0xd14ed5[_0x1acd6b(0x334)];_0x2340da++){const _0x48ef9c=await bcryptjs_1[_0x1acd6b(0x1fa)][_0x1acd6b(0x2fc)](_0x2e884a,_0xd14ed5[_0x2340da]);if(_0x48ef9c){_0xb98acb=!![],_0xd14ed5[_0x1acd6b(0x274)](_0x2340da,0x1),config_1[_0x1acd6b(0x2db)][_0x1acd6b(0x257)][_0x1acd6b(0x2da)]=JSON['stringify'](_0xd14ed5);const _0x1b385c=path_1[_0x1acd6b(0x1fa)]['join'](process[_0x1acd6b(0x30f)](),_0x1acd6b(0x1db));if(fs_1[_0x1acd6b(0x1fa)][_0x1acd6b(0x317)](_0x1b385c)){let _0x52d1c8=fs_1[_0x1acd6b(0x1fa)]['readFileSync'](_0x1b385c,_0x1acd6b(0x265));const _0x4f758a=_0x52d1c8['split']('\x0a');for(let _0x281920=0x0;_0x281920<_0x4f758a[_0x1acd6b(0x334)];_0x281920++){if(_0x4f758a[_0x281920][_0x1acd6b(0x271)](_0x1acd6b(0x2ae))){_0x4f758a[_0x281920]=_0x1acd6b(0x2ae)+JSON['stringify'](_0xd14ed5);break;}}fs_1[_0x1acd6b(0x1fa)][_0x1acd6b(0x331)](_0x1b385c,_0x4f758a['join']('\x0a'),_0x1acd6b(0x265));}break;}}}if(!_0xb98acb)throw new Error(_0x1acd6b(0x1af));}}await database_1[_0x1acd6b(0x1fa)]['shop']['delete']({'where':{'id':_0x33ea1b}});}async[a53_0x21cb2c(0x273)](_0x5d6f74){const _0x2f96a0=a53_0x21cb2c,_0x3c51ed=await database_1[_0x2f96a0(0x1fa)]['shop'][_0x2f96a0(0x2fd)]({'where':{'id':_0x5d6f74},'select':{'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'usdcErcWallet':!![]}});if(!_0x3c51ed)throw new Error(_0x2f96a0(0x241));return{'usdtPolygonWallet':_0x3c51ed[_0x2f96a0(0x23c)],'usdtTrcWallet':_0x3c51ed[_0x2f96a0(0x233)],'usdtErcWallet':_0x3c51ed[_0x2f96a0(0x2f0)],'usdcPolygonWallet':_0x3c51ed[_0x2f96a0(0x207)],'usdcErcWallet':_0x3c51ed[_0x2f96a0(0x262)]};}[a53_0x21cb2c(0x188)](_0x3f9371=0x8){const _0x437adb=a53_0x21cb2c,_0x5240df=[];for(let _0x34c92e=0x0;_0x34c92e<_0x3f9371;_0x34c92e++){const _0x57c103=crypto_1[_0x437adb(0x1fa)]['randomBytes'](0x4)['toString'](_0x437adb(0x31b))['toUpperCase']();_0x5240df['push'](_0x57c103);}return _0x5240df;}async[a53_0x21cb2c(0x346)](_0x3dbaa2){const _0x9aadcd=a53_0x21cb2c,_0x300a88=await database_1[_0x9aadcd(0x1fa)]['shop'][_0x9aadcd(0x2fd)]({'where':{'id':_0x3dbaa2},'select':{'id':!![],'name':!![],'username':!![],'twoFactorEnabled':!![]}});if(!_0x300a88)throw new Error(_0x9aadcd(0x241));const _0x56a47c=speakeasy_1[_0x9aadcd(0x1fa)][_0x9aadcd(0x29c)]({'name':'TrapaPay\x20('+_0x300a88['username']+')','issuer':_0x9aadcd(0x2ef),'length':0x20}),_0x5ce029=await qrcode_1['default'][_0x9aadcd(0x197)](_0x56a47c[_0x9aadcd(0x1f8)]),_0x291083=this[_0x9aadcd(0x188)](0x8),_0x902d3e=await Promise['all'](_0x291083[_0x9aadcd(0x34f)](_0x4e639f=>bcryptjs_1['default'][_0x9aadcd(0x287)](_0x4e639f,0xa)));return await database_1['default']['shop'][_0x9aadcd(0x253)]({'where':{'id':_0x3dbaa2},'data':{'twoFactorSecret':_0x56a47c[_0x9aadcd(0x187)],'backupCodes':JSON[_0x9aadcd(0x2b5)](_0x902d3e)}}),console[_0x9aadcd(0x26d)](_0x9aadcd(0x1d7)+_0x300a88[_0x9aadcd(0x315)]),console[_0x9aadcd(0x26d)](_0x9aadcd(0x1b2)+_0x291083[_0x9aadcd(0x334)]+_0x9aadcd(0x26a)),{'secret':_0x56a47c['base32'],'qrCode':_0x5ce029,'manualEntryKey':_0x56a47c[_0x9aadcd(0x187)],'backupCodes':_0x291083};}async[a53_0x21cb2c(0x23e)](_0x2be84d,_0x309cfd){const _0xdcd8f2=a53_0x21cb2c,_0x3cda4e=await database_1[_0xdcd8f2(0x1fa)][_0xdcd8f2(0x351)][_0xdcd8f2(0x2fd)]({'where':{'id':_0x2be84d},'select':{'id':!![],'username':!![],'twoFactorSecret':!![],'twoFactorEnabled':!![]}});if(!_0x3cda4e)throw new Error(_0xdcd8f2(0x241));if(!_0x3cda4e[_0xdcd8f2(0x212)])throw new Error(_0xdcd8f2(0x323));if(_0x3cda4e[_0xdcd8f2(0x350)])throw new Error(_0xdcd8f2(0x227));const _0x20d894=speakeasy_1[_0xdcd8f2(0x1fa)][_0xdcd8f2(0x280)][_0xdcd8f2(0x276)]({'secret':_0x3cda4e['twoFactorSecret'],'encoding':'base32','token':_0x309cfd,'window':0x2});if(!_0x20d894)throw new Error(_0xdcd8f2(0x219));return await database_1[_0xdcd8f2(0x1fa)][_0xdcd8f2(0x351)][_0xdcd8f2(0x253)]({'where':{'id':_0x2be84d},'data':{'twoFactorEnabled':!![]}}),console[_0xdcd8f2(0x26d)](_0xdcd8f2(0x1a2)+_0x3cda4e['username']),{'enabled':!![]};}async['disable2FA'](_0x4b63dc){const _0x546dcf=a53_0x21cb2c,_0x490ee8=await database_1[_0x546dcf(0x1fa)][_0x546dcf(0x351)][_0x546dcf(0x2fd)]({'where':{'id':_0x4b63dc},'select':{'id':!![],'username':!![],'twoFactorEnabled':!![]}});if(!_0x490ee8)throw new Error('Shop\x20not\x20found');await database_1[_0x546dcf(0x1fa)]['shop']['update']({'where':{'id':_0x4b63dc},'data':{'twoFactorEnabled':![],'twoFactorSecret':null,'backupCodes':null}}),console[_0x546dcf(0x26d)](_0x546dcf(0x267)+_0x490ee8[_0x546dcf(0x315)]);}async['changeAdminPassword'](_0xfa5198,_0x1c7c30,_0x27b167,_0x175b90){const _0x31a48c=a53_0x21cb2c;if(_0x1c7c30!==_0x27b167)throw new Error(_0x31a48c(0x1ec));if(_0x1c7c30['length']<0x6)throw new Error(_0x31a48c(0x251));const _0x24fa2a=await bcryptjs_1['default']['compare'](_0xfa5198,config_1[_0x31a48c(0x2db)]['admin']['passwordHash']);if(!_0x24fa2a)throw new Error(_0x31a48c(0x2d2));if(config_1['config'][_0x31a48c(0x257)][_0x31a48c(0x350)]){if(!_0x175b90)throw new Error(_0x31a48c(0x335));const _0x23e0ba=speakeasy_1[_0x31a48c(0x1fa)][_0x31a48c(0x280)]['verify']({'secret':config_1['config'][_0x31a48c(0x257)][_0x31a48c(0x212)],'encoding':_0x31a48c(0x187),'token':_0x175b90,'window':0x2});if(!_0x23e0ba){let _0x55055b=![];if(config_1['config'][_0x31a48c(0x257)][_0x31a48c(0x2da)]){const _0x26a11e=JSON[_0x31a48c(0x18e)](config_1[_0x31a48c(0x2db)][_0x31a48c(0x257)][_0x31a48c(0x2da)]);for(let _0x18bd33=0x0;_0x18bd33<_0x26a11e[_0x31a48c(0x334)];_0x18bd33++){const _0xa3efcb=await bcryptjs_1[_0x31a48c(0x1fa)][_0x31a48c(0x2fc)](_0x175b90,_0x26a11e[_0x18bd33]);if(_0xa3efcb){_0x55055b=!![],_0x26a11e[_0x31a48c(0x274)](_0x18bd33,0x1),config_1['config'][_0x31a48c(0x257)][_0x31a48c(0x2da)]=JSON[_0x31a48c(0x2b5)](_0x26a11e);const _0x4717ad=path_1[_0x31a48c(0x1fa)]['join'](process[_0x31a48c(0x30f)](),_0x31a48c(0x1db));if(fs_1[_0x31a48c(0x1fa)][_0x31a48c(0x317)](_0x4717ad)){let _0xeac0f5=fs_1[_0x31a48c(0x1fa)][_0x31a48c(0x180)](_0x4717ad,'utf8');const _0xf13a14=_0xeac0f5['split']('\x0a');for(let _0x1a8035=0x0;_0x1a8035<_0xf13a14['length'];_0x1a8035++){if(_0xf13a14[_0x1a8035][_0x31a48c(0x271)]('ADMIN_BACKUP_CODES=')){_0xf13a14[_0x1a8035]=_0x31a48c(0x2ae)+JSON[_0x31a48c(0x2b5)](_0x26a11e);break;}}fs_1[_0x31a48c(0x1fa)]['writeFileSync'](_0x4717ad,_0xf13a14[_0x31a48c(0x354)]('\x0a'),'utf8');}break;}}}if(!_0x55055b)throw new Error(_0x31a48c(0x1af));}}const _0x3608ab=await bcryptjs_1[_0x31a48c(0x1fa)][_0x31a48c(0x287)](_0x1c7c30,0xc);config_1[_0x31a48c(0x2db)][_0x31a48c(0x257)][_0x31a48c(0x1d0)]=_0x3608ab;const _0x1e49c5=path_1[_0x31a48c(0x1fa)]['join'](process[_0x31a48c(0x30f)](),'.env');let _0x110b51='';if(fs_1[_0x31a48c(0x1fa)][_0x31a48c(0x317)](_0x1e49c5)){_0x110b51=fs_1[_0x31a48c(0x1fa)][_0x31a48c(0x180)](_0x1e49c5,_0x31a48c(0x265));const _0x24ea93=_0x110b51[_0x31a48c(0x18f)]('\x0a');let _0xa6d15b=![];for(let _0x26fbc1=0x0;_0x26fbc1<_0x24ea93['length'];_0x26fbc1++){if(_0x24ea93[_0x26fbc1][_0x31a48c(0x271)](_0x31a48c(0x201))){_0x24ea93[_0x26fbc1]=_0x31a48c(0x201)+_0x3608ab,_0xa6d15b=!![];break;}}!_0xa6d15b&&_0x24ea93[_0x31a48c(0x2dd)](_0x31a48c(0x201)+_0x3608ab),_0x110b51=_0x24ea93['join']('\x0a'),fs_1[_0x31a48c(0x1fa)]['writeFileSync'](_0x1e49c5,_0x110b51,'utf8');}console[_0x31a48c(0x26d)](_0x31a48c(0x245));}async['get2FASettings'](){const _0x68fb39=a53_0x21cb2c;let _0x20fe19=0x0;if(config_1[_0x68fb39(0x2db)]['admin'][_0x68fb39(0x2da)])try{const _0x2c87e8=JSON['parse'](config_1[_0x68fb39(0x2db)][_0x68fb39(0x257)][_0x68fb39(0x2da)]);_0x20fe19=_0x2c87e8[_0x68fb39(0x334)];}catch(_0x62b36b){console[_0x68fb39(0x1a3)](_0x68fb39(0x2dc),_0x62b36b);}return{'twoFactorEnabled':config_1[_0x68fb39(0x2db)][_0x68fb39(0x257)][_0x68fb39(0x350)],'backupCodesCount':_0x20fe19};}async[a53_0x21cb2c(0x33c)](){const _0x2d6446=a53_0x21cb2c,_0x42cc1b=speakeasy_1[_0x2d6446(0x1fa)]['generateSecret']({'name':_0x2d6446(0x1e0)+config_1[_0x2d6446(0x2db)][_0x2d6446(0x257)][_0x2d6446(0x315)]+')','issuer':_0x2d6446(0x286),'length':0x20}),_0x19a04c=await qrcode_1[_0x2d6446(0x1fa)][_0x2d6446(0x197)](_0x42cc1b[_0x2d6446(0x1f8)]),_0x122edd=[];for(let _0x47ac56=0x0;_0x47ac56<0x8;_0x47ac56++){const _0x568399=crypto_1[_0x2d6446(0x1fa)][_0x2d6446(0x1bb)](0x4)[_0x2d6446(0x2e4)](_0x2d6446(0x31b))['toUpperCase']();_0x122edd[_0x2d6446(0x2dd)](_0x568399);}const _0x2f9880=await Promise[_0x2d6446(0x1c6)](_0x122edd[_0x2d6446(0x34f)](_0x3a53d4=>bcryptjs_1[_0x2d6446(0x1fa)][_0x2d6446(0x287)](_0x3a53d4,0xa)));config_1[_0x2d6446(0x2db)]['admin'][_0x2d6446(0x212)]=_0x42cc1b['base32'],config_1['config'][_0x2d6446(0x257)]['backupCodes']=JSON[_0x2d6446(0x2b5)](_0x2f9880);const _0x18eba4=path_1['default'][_0x2d6446(0x354)](process[_0x2d6446(0x30f)](),_0x2d6446(0x1db));if(fs_1[_0x2d6446(0x1fa)][_0x2d6446(0x317)](_0x18eba4)){let _0xe0318a=fs_1[_0x2d6446(0x1fa)][_0x2d6446(0x180)](_0x18eba4,_0x2d6446(0x265));const _0x3cc951=_0xe0318a[_0x2d6446(0x18f)]('\x0a');let _0x1e9005=![],_0x35f5bc=![];for(let _0xd01b4b=0x0;_0xd01b4b<_0x3cc951[_0x2d6446(0x334)];_0xd01b4b++){_0x3cc951[_0xd01b4b][_0x2d6446(0x271)](_0x2d6446(0x1ae))&&(_0x3cc951[_0xd01b4b]=_0x2d6446(0x1ae)+_0x42cc1b[_0x2d6446(0x187)],_0x1e9005=!![]),_0x3cc951[_0xd01b4b]['startsWith']('ADMIN_BACKUP_CODES=')&&(_0x3cc951[_0xd01b4b]=_0x2d6446(0x2ae)+JSON[_0x2d6446(0x2b5)](_0x2f9880),_0x35f5bc=!![]);}if(!_0x1e9005)_0x3cc951[_0x2d6446(0x2dd)](_0x2d6446(0x1ae)+_0x42cc1b['base32']);if(!_0x35f5bc)_0x3cc951['push'](_0x2d6446(0x2ae)+JSON[_0x2d6446(0x2b5)](_0x2f9880));fs_1[_0x2d6446(0x1fa)][_0x2d6446(0x331)](_0x18eba4,_0x3cc951[_0x2d6446(0x354)]('\x0a'),_0x2d6446(0x265));}return console['log']('ðŸ”\x20Admin\x202FA\x20setup\x20initiated'),console['log']('ðŸ”‘\x20Generated\x20'+_0x122edd['length']+_0x2d6446(0x26a)),{'secret':_0x42cc1b[_0x2d6446(0x187)],'qrCode':_0x19a04c,'manualEntryKey':_0x42cc1b[_0x2d6446(0x187)],'backupCodes':_0x122edd};}async[a53_0x21cb2c(0x21f)](_0x8737d8){const _0x2f2c7f=a53_0x21cb2c;if(!config_1[_0x2f2c7f(0x2db)][_0x2f2c7f(0x257)][_0x2f2c7f(0x212)])throw new Error(_0x2f2c7f(0x323));if(config_1[_0x2f2c7f(0x2db)][_0x2f2c7f(0x257)][_0x2f2c7f(0x350)])throw new Error(_0x2f2c7f(0x227));const _0xf7d2de=speakeasy_1['default'][_0x2f2c7f(0x280)]['verify']({'secret':config_1['config'][_0x2f2c7f(0x257)][_0x2f2c7f(0x212)],'encoding':_0x2f2c7f(0x187),'token':_0x8737d8,'window':0x2});if(!_0xf7d2de)throw new Error(_0x2f2c7f(0x219));config_1['config']['admin'][_0x2f2c7f(0x350)]=!![];const _0xd33bf1=path_1['default'][_0x2f2c7f(0x354)](process[_0x2f2c7f(0x30f)](),_0x2f2c7f(0x1db));if(fs_1[_0x2f2c7f(0x1fa)][_0x2f2c7f(0x317)](_0xd33bf1)){let _0x48f517=fs_1[_0x2f2c7f(0x1fa)][_0x2f2c7f(0x180)](_0xd33bf1,_0x2f2c7f(0x265));const _0x2c2fcd=_0x48f517[_0x2f2c7f(0x18f)]('\x0a');let _0x3c32e8=![];for(let _0xb5ece9=0x0;_0xb5ece9<_0x2c2fcd[_0x2f2c7f(0x334)];_0xb5ece9++){if(_0x2c2fcd[_0xb5ece9][_0x2f2c7f(0x271)](_0x2f2c7f(0x2be))){_0x2c2fcd[_0xb5ece9]=_0x2f2c7f(0x2d6),_0x3c32e8=!![];break;}}if(!_0x3c32e8)_0x2c2fcd['push'](_0x2f2c7f(0x2d6));fs_1[_0x2f2c7f(0x1fa)][_0x2f2c7f(0x331)](_0xd33bf1,_0x2c2fcd[_0x2f2c7f(0x354)]('\x0a'),_0x2f2c7f(0x265));}return console[_0x2f2c7f(0x26d)](_0x2f2c7f(0x326)),{'enabled':!![]};}async['disableAdmin2FA'](){const _0x539b4b=a53_0x21cb2c;config_1[_0x539b4b(0x2db)][_0x539b4b(0x257)][_0x539b4b(0x350)]=![],config_1[_0x539b4b(0x2db)][_0x539b4b(0x257)][_0x539b4b(0x212)]='',config_1[_0x539b4b(0x2db)][_0x539b4b(0x257)]['backupCodes']='';const _0x4cb17e=path_1['default'][_0x539b4b(0x354)](process[_0x539b4b(0x30f)](),_0x539b4b(0x1db));if(fs_1[_0x539b4b(0x1fa)][_0x539b4b(0x317)](_0x4cb17e)){let _0x13e575=fs_1[_0x539b4b(0x1fa)][_0x539b4b(0x180)](_0x4cb17e,_0x539b4b(0x265));const _0x500094=_0x13e575[_0x539b4b(0x18f)]('\x0a');for(let _0xe254cf=0x0;_0xe254cf<_0x500094[_0x539b4b(0x334)];_0xe254cf++){_0x500094[_0xe254cf][_0x539b4b(0x271)](_0x539b4b(0x2be))&&(_0x500094[_0xe254cf]=_0x539b4b(0x1a7)),_0x500094[_0xe254cf][_0x539b4b(0x271)](_0x539b4b(0x1ae))&&(_0x500094[_0xe254cf]=_0x539b4b(0x1ae)),_0x500094[_0xe254cf][_0x539b4b(0x271)](_0x539b4b(0x2ae))&&(_0x500094[_0xe254cf]=_0x539b4b(0x2ae));}fs_1['default'][_0x539b4b(0x331)](_0x4cb17e,_0x500094['join']('\x0a'),_0x539b4b(0x265));}console[_0x539b4b(0x26d)](_0x539b4b(0x222));}['generateDailyStatistics'](_0x491a2a,_0x33442e,_0x259c90){const _0x1bac2e=a53_0x21cb2c,_0x1507a3=new Map(),_0x115c28=new Date(_0x33442e);while(_0x115c28<=_0x259c90){const _0x11864f=_0x115c28[_0x1bac2e(0x2d3)]()[_0x1bac2e(0x18f)]('T')[0x0];_0x1507a3[_0x1bac2e(0x30d)](_0x11864f,{'revenue':0x0,'count':0x0}),_0x115c28[_0x1bac2e(0x2b9)](_0x115c28[_0x1bac2e(0x281)]()+0x1);}for(const _0x334d31 of _0x491a2a){const _0x115eda=_0x334d31[_0x1bac2e(0x223)][_0x1bac2e(0x2d3)]()[_0x1bac2e(0x18f)]('T')[0x0],_0x5b145a=_0x1507a3[_0x1bac2e(0x2f8)](_0x115eda);_0x5b145a&&(_0x5b145a[_0x1bac2e(0x19a)]+=0x1,_0x334d31['status']==='PAID'&&(_0x334d31['amountUSDT']?_0x5b145a[_0x1bac2e(0x2a7)]+=_0x334d31[_0x1bac2e(0x306)]:console[_0x1bac2e(0x26d)](_0x1bac2e(0x344)+_0x334d31['id']+'\x20missing\x20amountUSDT,\x20using\x20fallback\x20conversion')));}const _0x3db8da=[],_0xed866b=[];for(const [_0x49e663,_0x268695]of _0x1507a3){_0x3db8da['push']({'date':_0x49e663,'amount':Math['round'](_0x268695[_0x1bac2e(0x2a7)]*0x64)/0x64}),_0xed866b['push']({'date':_0x49e663,'count':_0x268695['count']});}return{'dailyRevenue':_0x3db8da,'dailyPayments':_0xed866b};}async[a53_0x21cb2c(0x2ad)](_0x4d7088){const _0x13c6ad=a53_0x21cb2c;console[_0x13c6ad(0x26d)](_0x13c6ad(0x319),_0x4d7088);const _0x21f39e=new Date(_0x4d7088[_0x13c6ad(0x261)]),_0x5512ef=new Date(_0x4d7088['periodTo']),_0x41c193=new Date(Date[_0x13c6ad(0x347)](_0x21f39e[_0x13c6ad(0x2aa)](),_0x21f39e[_0x13c6ad(0x1ba)](),_0x21f39e[_0x13c6ad(0x33f)](),0x0,0x0,0x0,0x0)),_0x26ff73=new Date(Date['UTC'](_0x5512ef[_0x13c6ad(0x2aa)](),_0x5512ef[_0x13c6ad(0x1ba)](),_0x5512ef[_0x13c6ad(0x33f)](),0x17,0x3b,0x3b,0x3e7));console[_0x13c6ad(0x26d)](_0x13c6ad(0x21d)+_0x41c193[_0x13c6ad(0x2d3)]()+_0x13c6ad(0x2e0)+_0x26ff73[_0x13c6ad(0x2d3)]()),console[_0x13c6ad(0x26d)](_0x13c6ad(0x330)+_0x4d7088[_0x13c6ad(0x349)]);const _0x4b1643=await database_1[_0x13c6ad(0x1fa)][_0x13c6ad(0x327)][_0x13c6ad(0x27f)]({'where':{'status':_0x13c6ad(0x268),'gateway':_0x4d7088['gateway']['toLowerCase'](),'createdAt':{'gte':_0x41c193,'lte':_0x26ff73}},'select':{'id':!![],'shopId':!![],'amountAfterGatewayCommissionUSDT':!![],'shop':{'select':{'id':!![],'name':!![],'username':!![]}}}});console[_0x13c6ad(0x26d)]('ðŸ’°\x20Found\x20'+_0x4b1643[_0x13c6ad(0x334)]+'\x20paid\x20payments\x20for\x20gateway\x20'+_0x4d7088['gateway']);const _0x18b707=new Map();for(const _0x3f17f7 of _0x4b1643){const _0x42406a=_0x3f17f7[_0x13c6ad(0x2f9)]||0x0;if(_0x42406a<=0x0){console['warn'](_0x13c6ad(0x344)+_0x3f17f7['id']+'\x20has\x20zero\x20or\x20null\x20merchant\x20amount,\x20skipping...');continue;}if(_0x18b707['has'](_0x3f17f7[_0x13c6ad(0x264)])){const _0x45488a=_0x18b707['get'](_0x3f17f7[_0x13c6ad(0x264)]);_0x45488a[_0x13c6ad(0x1f5)]+=_0x42406a;}else _0x18b707[_0x13c6ad(0x30d)](_0x3f17f7['shopId'],{'merchantId':_0x3f17f7[_0x13c6ad(0x351)]['id'],'merchantName':_0x3f17f7[_0x13c6ad(0x351)]['name'],'merchantUsername':_0x3f17f7[_0x13c6ad(0x351)][_0x13c6ad(0x315)],'totalAmount':_0x42406a});}const _0x4f5970=Array[_0x13c6ad(0x292)](_0x18b707[_0x13c6ad(0x27b)]())[_0x13c6ad(0x34f)](_0x25f79a=>({'merchantId':_0x25f79a['merchantId'],'merchantName':_0x25f79a[_0x13c6ad(0x1f6)],'merchantUsername':_0x25f79a[_0x13c6ad(0x20a)],'gateway':_0x4d7088[_0x13c6ad(0x349)],'periodFrom':_0x4d7088['periodFrom'],'periodTo':_0x4d7088[_0x13c6ad(0x2f4)],'totalAmount':Math[_0x13c6ad(0x31d)](_0x25f79a[_0x13c6ad(0x1f5)]*0x64)/0x64}));return _0x4f5970[_0x13c6ad(0x2c9)]((_0x3584b5,_0x17cd4a)=>_0x17cd4a[_0x13c6ad(0x1f5)]-_0x3584b5[_0x13c6ad(0x1f5)]),console[_0x13c6ad(0x26d)](_0x13c6ad(0x19c)+_0x4f5970[_0x13c6ad(0x334)]+'\x20merchants'),_0x4f5970;}async['depositBalance'](_0x428ce9,_0x1c7288,_0x10dcb4){const _0x532a49=a53_0x21cb2c,_0x2c7df8=await database_1[_0x532a49(0x1fa)][_0x532a49(0x351)][_0x532a49(0x2fd)]({'where':{'id':_0x428ce9}});if(!_0x2c7df8)throw new Error(_0x532a49(0x205));await database_1[_0x532a49(0x1fa)][_0x532a49(0x1a0)](async _0x1e28c3=>{const _0x55a803=_0x532a49;await _0x1e28c3['payment']['create']({'data':{'shopId':_0x2c7df8['id'],'amount':_0x1c7288,'amountUSDT':_0x1c7288,'amountAfterGatewayCommissionUSDT':_0x1c7288,'sourceCurrency':_0x55a803(0x2d5),'currency':_0x55a803(0x2d5),'status':'PAID','gateway':_0x55a803(0x29f),'customerName':_0x2c7df8[_0x55a803(0x315)],'customerEmail':'@'+_0x2c7df8[_0x55a803(0x182)],'paymentMethod':'CRYPTO','adminNotes':_0x10dcb4||null,'successUrl':'-','failUrl':'-','paidAt':new Date()}}),await _0x1e28c3[_0x55a803(0x351)][_0x55a803(0x253)]({'where':{'id':_0x2c7df8['id']},'data':{'balance':{'increment':_0x1c7288}}});}),console[_0x532a49(0x26d)](_0x532a49(0x20d)+_0x1c7288+_0x532a49(0x32e)+_0x2c7df8[_0x532a49(0x315)]);}}exports['AdminService']=AdminService;