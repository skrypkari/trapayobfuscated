'use strict';const a38_0x46fb30=a38_0x551e;(function(_0x21ae5e,_0x1d0e33){const _0x2f50ac=a38_0x551e,_0x58ca76=_0x21ae5e();while(!![]){try{const _0x2c533d=parseInt(_0x2f50ac(0x172))/0x1+-parseInt(_0x2f50ac(0x1f4))/0x2*(parseInt(_0x2f50ac(0x1da))/0x3)+parseInt(_0x2f50ac(0x14b))/0x4+parseInt(_0x2f50ac(0x214))/0x5*(parseInt(_0x2f50ac(0x16e))/0x6)+-parseInt(_0x2f50ac(0x1b9))/0x7*(-parseInt(_0x2f50ac(0x13b))/0x8)+parseInt(_0x2f50ac(0x1fe))/0x9+-parseInt(_0x2f50ac(0x20d))/0xa*(parseInt(_0x2f50ac(0x1e8))/0xb);if(_0x2c533d===_0x1d0e33)break;else _0x58ca76['push'](_0x58ca76['shift']());}catch(_0x184a6c){_0x58ca76['push'](_0x58ca76['shift']());}}}(a38_0x3239,0xe9a07));function a38_0x551e(_0x53f8cd,_0x5eec2b){const _0x323984=a38_0x3239();return a38_0x551e=function(_0x551eba,_0x22a40f){_0x551eba=_0x551eba-0x103;let _0x5da179=_0x323984[_0x551eba];return _0x5da179;},a38_0x551e(_0x53f8cd,_0x5eec2b);}var __importDefault=this&&this[a38_0x46fb30(0x1dc)]||function(_0x25eb31){const _0xfc5caf=a38_0x46fb30;return _0x25eb31&&_0x25eb31[_0xfc5caf(0x237)]?_0x25eb31:{'default':_0x25eb31};};Object[a38_0x46fb30(0x16c)](exports,a38_0x46fb30(0x237),{'value':!![]}),exports[a38_0x46fb30(0x213)]=void 0x0;const database_1=__importDefault(require(a38_0x46fb30(0x1d0))),bcryptjs_1=__importDefault(require('bcryptjs')),crypto_1=__importDefault(require(a38_0x46fb30(0x252))),currencyService_1=require(a38_0x46fb30(0x182)),gateway_1=require(a38_0x46fb30(0x174));class AdminService{async[a38_0x46fb30(0x227)](){const _0x1616ce=a38_0x46fb30;console['log']('📊\x20Calculating\x20payout\x20statistics...');const _0x290d5c=await database_1[_0x1616ce(0x201)][_0x1616ce(0x21a)][_0x1616ce(0x1ae)]({'_sum':{'balance':!![],'totalPaidOut':!![]},'where':{'status':_0x1616ce(0x1b3)}}),_0x483965=await database_1[_0x1616ce(0x201)][_0x1616ce(0x200)][_0x1616ce(0x1eb)]({'where':{'status':_0x1616ce(0x1d9),'gateway':{'not':_0x1616ce(0x121)}}}),_0x2ebf6a=new Date(),_0x52d3f3=new Date(_0x2ebf6a[_0x1616ce(0x217)](),_0x2ebf6a[_0x1616ce(0x179)](),0x1),_0x20f69f=new Date(_0x2ebf6a[_0x1616ce(0x217)](),_0x2ebf6a[_0x1616ce(0x179)]()+0x1,0x0,0x17,0x3b,0x3b,0x3e7),_0x22e915=await database_1['default'][_0x1616ce(0x231)]['aggregate']({'_sum':{'amount':!![]},'where':{'createdAt':{'gte':_0x52d3f3,'lte':_0x20f69f},'status':_0x1616ce(0x24f)}}),_0x36312b=_0x290d5c[_0x1616ce(0x1fa)][_0x1616ce(0x22a)]||0x0,_0x1ae607=_0x290d5c[_0x1616ce(0x1fa)][_0x1616ce(0x10d)]||0x0,_0x1b6694=_0x22e915[_0x1616ce(0x1fa)][_0x1616ce(0x1c3)]||0x0,_0x1280b4={'totalPayout':Math[_0x1616ce(0x206)](_0x36312b*0x64)/0x64,'awaitingPayout':Math[_0x1616ce(0x206)](_0x1ae607*0x64)/0x64,'thisMonth':Math[_0x1616ce(0x206)](_0x1b6694*0x64)/0x64,'availableBalance':Math[_0x1616ce(0x206)](_0x1ae607*0x64)/0x64,'totalPayments':_0x483965};return console[_0x1616ce(0x184)](_0x1616ce(0x128)),console[_0x1616ce(0x184)]('\x20\x20\x20💰\x20Total\x20payout:\x20'+_0x1280b4[_0x1616ce(0x249)]+'\x20USDT\x20(total\x20paid\x20to\x20merchants)'),console[_0x1616ce(0x184)](_0x1616ce(0x107)+_0x1280b4[_0x1616ce(0x22b)]+_0x1616ce(0x1fd)),console[_0x1616ce(0x184)](_0x1616ce(0x1c6)+_0x1280b4[_0x1616ce(0x10f)]+_0x1616ce(0x1af)),console['log'](_0x1616ce(0x110)+_0x1280b4['thisMonth']+'\x20USDT'),console[_0x1616ce(0x184)](_0x1616ce(0x1ec)+_0x1280b4[_0x1616ce(0x18a)]+_0x1616ce(0x1ea)),_0x1280b4;}async['updateCustomerData'](_0x38aa36,_0xa5b600){const _0x3c5655=a38_0x46fb30;console[_0x3c5655(0x184)](_0x3c5655(0x1f9)+_0x38aa36+':',_0xa5b600);const _0x418141=await database_1[_0x3c5655(0x201)][_0x3c5655(0x200)][_0x3c5655(0x244)]({'where':{'id':_0x38aa36},'select':{'id':!![],'customerEmail':!![],'customerName':!![],'customerCountry':!![],'customerIp':!![],'customerUa':!![]}});if(!_0x418141)throw new Error(_0x3c5655(0x148));const _0x5ad1cc={};_0xa5b600[_0x3c5655(0x11c)]!==undefined&&(_0x5ad1cc[_0x3c5655(0x11c)]=_0xa5b600[_0x3c5655(0x11c)]||null);_0xa5b600[_0x3c5655(0x1bc)]!==undefined&&(_0x5ad1cc[_0x3c5655(0x1bc)]=_0xa5b600[_0x3c5655(0x1bc)]||null);_0xa5b600[_0x3c5655(0x112)]!==undefined&&(_0x5ad1cc[_0x3c5655(0x112)]=_0xa5b600[_0x3c5655(0x112)]||null);const _0x48aa07=await database_1['default']['payment'][_0x3c5655(0x1ca)]({'where':{'id':_0x38aa36},'data':{..._0x5ad1cc,'updatedAt':new Date()},'select':{'id':!![],'customerEmail':!![],'customerName':!![],'customerCountry':!![],'customerIp':!![],'customerUa':!![],'updatedAt':!![]}});return console[_0x3c5655(0x184)](_0x3c5655(0x194)+_0x38aa36),console[_0x3c5655(0x184)]('\x20\x20\x20🌍\x20Country:\x20'+_0x418141['customerCountry']+'\x20->\x20'+_0x48aa07['customerCountry']),console[_0x3c5655(0x184)](_0x3c5655(0x119)+_0x418141[_0x3c5655(0x1bc)]+_0x3c5655(0x158)+_0x48aa07[_0x3c5655(0x1bc)]),console[_0x3c5655(0x184)](_0x3c5655(0x228)+(_0x418141[_0x3c5655(0x112)]?_0x3c5655(0x24c):'not\x20set')+'\x20->\x20'+(_0x48aa07['customerUa']?_0x3c5655(0x24c):_0x3c5655(0x183))),_0x48aa07;}async[a38_0x46fb30(0x1f2)](_0x56898e){const _0x52dced=a38_0x46fb30,_0x55b784=new Date();let _0x2ec30e;switch(_0x56898e[_0x52dced(0x13d)]()){case'day':_0x2ec30e=new Date(_0x55b784[_0x52dced(0x217)](),_0x55b784[_0x52dced(0x179)](),_0x55b784['getDate'](),0x0,0x0,0x0,0x0);break;case _0x52dced(0x229):const _0x23143e=new Date(_0x55b784);_0x23143e['setDate'](_0x23143e[_0x52dced(0x130)]()-0x1),_0x2ec30e=new Date(_0x23143e[_0x52dced(0x217)](),_0x23143e['getMonth'](),_0x23143e['getDate'](),0x0,0x0,0x0,0x0);break;case'7d':_0x2ec30e=new Date(_0x55b784[_0x52dced(0x173)]()-0x7*0x18*0x3c*0x3c*0x3e8);break;case _0x52dced(0x1ee):_0x2ec30e=new Date(_0x55b784[_0x52dced(0x173)]()-0x1e*0x18*0x3c*0x3c*0x3e8);break;case _0x52dced(0x135):_0x2ec30e=new Date(_0x55b784[_0x52dced(0x173)]()-0x5a*0x18*0x3c*0x3c*0x3e8);break;case _0x52dced(0x22f):const _0xf2eced=await database_1['default'][_0x52dced(0x200)][_0x52dced(0x143)]({'where':{'gateway':{'not':_0x52dced(0x121)}},'orderBy':{'createdAt':_0x52dced(0x178)},'select':{'createdAt':!![]}});_0x2ec30e=_0xf2eced?_0xf2eced[_0x52dced(0x157)]:new Date('2020-01-01');break;default:_0x2ec30e=new Date(_0x55b784[_0x52dced(0x173)]()-0x1e*0x18*0x3c*0x3c*0x3e8);}_0x2ec30e[_0x52dced(0x236)](0x0,0x0,0x0,0x0);let _0x3c8f6f;if(_0x56898e['toLowerCase']()==='yesterday'){const _0x25ef15=new Date(_0x55b784);_0x25ef15['setDate'](_0x25ef15[_0x52dced(0x130)]()-0x1),_0x3c8f6f=new Date(_0x25ef15['getFullYear'](),_0x25ef15['getMonth'](),_0x25ef15[_0x52dced(0x130)](),0x17,0x3b,0x3b,0x3e7);}const _0x388ea0={'gte':_0x2ec30e};_0x3c8f6f&&(_0x388ea0[_0x52dced(0x10c)]=_0x3c8f6f);const [_0x280bb4,_0xa178db,_0xacc0aa,_0xe6fd74,_0x2dbaeb,_0x4e3340]=await Promise[_0x52dced(0x22f)]([database_1[_0x52dced(0x201)]['shop'][_0x52dced(0x1eb)](),database_1['default'][_0x52dced(0x21a)][_0x52dced(0x1eb)]({'where':{'status':'ACTIVE'}}),database_1[_0x52dced(0x201)][_0x52dced(0x200)]['count']({'where':{'status':_0x52dced(0x1d9),'createdAt':_0x388ea0,'gateway':{'not':_0x52dced(0x121)}}}),database_1[_0x52dced(0x201)]['payment'][_0x52dced(0x116)]({'where':{'status':_0x52dced(0x1d9),'createdAt':_0x388ea0,'gateway':{'not':_0x52dced(0x121)}},'select':{'amount':!![],'currency':!![],'amountAfterGatewayCommissionUSDT':!![]}}),database_1[_0x52dced(0x201)][_0x52dced(0x200)]['findMany']({'where':{'gateway':{'not':'test_gateway'}},'take':0xa,'orderBy':{'createdAt':_0x52dced(0x22e)},'include':{'shop':{'select':{'name':!![],'username':!![]}}}}),database_1[_0x52dced(0x201)][_0x52dced(0x200)]['findMany']({'where':{'createdAt':_0x388ea0,'gateway':{'not':_0x52dced(0x121)}},'select':{'amount':!![],'currency':!![],'status':!![],'amountUSDT':!![],'createdAt':!![]}})]);let _0x576e8e=0x0,_0x2750df=0x0;for(const _0x917eec of _0xe6fd74){const _0x35f5f1=await currencyService_1[_0x52dced(0x180)][_0x52dced(0x11e)](_0x917eec[_0x52dced(0x1c3)],_0x917eec[_0x52dced(0x105)]);_0x576e8e+=_0x35f5f1;if(_0x917eec[_0x52dced(0x162)]){const _0x45c046=await currencyService_1[_0x52dced(0x180)][_0x52dced(0x11e)](_0x917eec[_0x52dced(0x1c3)],_0x917eec[_0x52dced(0x105)]),_0x2413b7=_0x917eec[_0x52dced(0x162)],_0x2602c4=_0x45c046-_0x2413b7;_0x2750df+=_0x2602c4;}}const _0x4d5046=_0xacc0aa>0x0?_0x576e8e/_0xacc0aa:0x0,_0xd19e37=this[_0x52dced(0x195)](_0x4e3340,_0x2ec30e,_0x3c8f6f||_0x55b784),_0x2b01d1=await database_1[_0x52dced(0x201)][_0x52dced(0x200)][_0x52dced(0x1eb)]({'where':{'createdAt':_0x388ea0,'gateway':{'not':'test_gateway'}}}),_0x11fec7=_0x2b01d1>0x0?_0xacc0aa/_0x2b01d1*0x64:0x0;return{'totalShops':_0x280bb4,'activeShops':_0xa178db,'totalPayments':_0xacc0aa,'successfulPayments':_0xacc0aa,'totalAttempts':_0x2b01d1,'totalRevenue':Math['round'](_0x576e8e*0x64)/0x64,'trapayEarnings':Math['round'](_0x2750df*0x64)/0x64,'averagePaymentAmount':Math[_0x52dced(0x206)](_0x4d5046*0x64)/0x64,'conversionRate':Math[_0x52dced(0x206)](_0x11fec7*0x64)/0x64,'dailyRevenue':_0xd19e37[_0x52dced(0x1d8)],'dailyPayments':_0xd19e37['dailyPayments'],'recentPayments':_0x2dbaeb['map'](_0x211d28=>({'id':_0x211d28['id'],'amount':_0x211d28['amount'],'currency':_0x211d28[_0x52dced(0x105)],'status':_0x211d28['status'],'gateway':_0x211d28[_0x52dced(0x1a9)],'shop':_0x211d28[_0x52dced(0x21a)],'createdAt':_0x211d28['createdAt']}))};}async[a38_0x46fb30(0x16a)](_0x90972){const _0x4399a7=a38_0x46fb30;console[_0x4399a7(0x184)]('📊\x20Getting\x20merchant\x20statistics\x20with\x20filters:',_0x90972);let _0xbf4229,_0x537767=new Date();if(_0x90972[_0x4399a7(0x168)]===_0x4399a7(0x221)&&_0x90972[_0x4399a7(0x10e)]&&_0x90972['dateTo'])_0xbf4229=new Date(_0x90972[_0x4399a7(0x10e)]),_0x537767=new Date(_0x90972[_0x4399a7(0x1bd)]),_0xbf4229[_0x4399a7(0x236)](0x0,0x0,0x0,0x0),_0x537767[_0x4399a7(0x236)](0x17,0x3b,0x3b,0x3e7);else{const _0x3a5f6a=new Date();switch(_0x90972['period']){case _0x4399a7(0x1e0):_0xbf4229=new Date(_0x3a5f6a[_0x4399a7(0x173)]()-0x7*0x18*0x3c*0x3c*0x3e8);break;case _0x4399a7(0x1a1):_0xbf4229=new Date(_0x3a5f6a[_0x4399a7(0x173)]()-0x1e*0x18*0x3c*0x3c*0x3e8);break;case _0x4399a7(0x20c):_0xbf4229=new Date(_0x3a5f6a[_0x4399a7(0x173)]()-0x16d*0x18*0x3c*0x3c*0x3e8);break;case _0x4399a7(0x22f):default:_0xbf4229=new Date(_0x4399a7(0x23c));break;}_0xbf4229[_0x4399a7(0x236)](0x0,0x0,0x0,0x0),_0x537767[_0x4399a7(0x236)](0x17,0x3b,0x3b,0x3e7);}console[_0x4399a7(0x184)](_0x4399a7(0x19b)+_0xbf4229[_0x4399a7(0x18c)]()+_0x4399a7(0x150)+_0x537767['toISOString']());const _0x230c6f={'status':_0x4399a7(0x1d9),'gateway':{'not':_0x4399a7(0x121)},'paidAt':{'gte':_0xbf4229,'lte':_0x537767}};_0x90972[_0x4399a7(0x14e)]&&(_0x230c6f[_0x4399a7(0x14e)]=_0x90972[_0x4399a7(0x14e)]);const _0x305cca=await database_1[_0x4399a7(0x201)][_0x4399a7(0x200)][_0x4399a7(0x116)]({'where':_0x230c6f,'select':{'id':!![],'amount':!![],'currency':!![],'amountUSDT':!![],'amountAfterGatewayCommissionUSDT':!![],'gatewayCommissionRate':!![],'gateway':!![],'shopId':!![],'paidAt':!![],'shop':{'select':{'id':!![],'name':!![],'username':!![],'gatewaySettings':!![]}}}});console[_0x4399a7(0x184)](_0x4399a7(0x12f)+_0x305cca['length']+_0x4399a7(0x120));const _0x32e023={'gateway':{'not':_0x4399a7(0x121)},'createdAt':{'gte':_0xbf4229,'lte':_0x537767}};_0x90972[_0x4399a7(0x14e)]&&(_0x32e023[_0x4399a7(0x14e)]=_0x90972[_0x4399a7(0x14e)]);const _0xc07671=await database_1[_0x4399a7(0x201)][_0x4399a7(0x200)][_0x4399a7(0x1eb)]({'where':_0x32e023});console[_0x4399a7(0x184)](_0x4399a7(0x123)+_0xc07671+',\x20successful:\x20'+_0x305cca[_0x4399a7(0x127)]);let _0x58d7ce=0x0,_0x20c734=0x0,_0x32eac1=0x0;const _0x1b5c12={},_0x1b807d={},_0x93e1ee={};for(const _0x16a7cf of _0x305cca){try{const _0x3db662=_0x16a7cf[_0x4399a7(0x1a4)]||0x0;if(_0x3db662<=0x0){console[_0x4399a7(0x24e)]('⚠️\x20Payment\x20'+_0x16a7cf['id']+_0x4399a7(0x17e));continue;}let _0xa5abdf,_0x29b272;if(_0x16a7cf[_0x4399a7(0x162)]!==null&&_0x16a7cf[_0x4399a7(0x162)]!==undefined)_0xa5abdf=_0x16a7cf[_0x4399a7(0x162)],_0x29b272=_0x3db662-_0xa5abdf,console[_0x4399a7(0x184)](_0x4399a7(0x16d)+_0x16a7cf['id']+':\x20'+_0x3db662[_0x4399a7(0x245)](0x6)+_0x4399a7(0x166)+_0xa5abdf[_0x4399a7(0x245)](0x6)+_0x4399a7(0x23d));else{let _0x5da4a8={};if(_0x16a7cf['shop']['gatewaySettings'])try{_0x5da4a8=JSON['parse'](_0x16a7cf[_0x4399a7(0x21a)][_0x4399a7(0x218)]);}catch(_0x5b965c){console[_0x4399a7(0x18b)](_0x4399a7(0x146)+_0x16a7cf[_0x4399a7(0x14e)]+':',_0x5b965c);}let _0x4d4568=0x2d;for(const [_0x30e798,_0x668f3e]of Object[_0x4399a7(0x1c5)](_0x5da4a8)){if(_0x30e798['toLowerCase']()===_0x16a7cf[_0x4399a7(0x1a9)][_0x4399a7(0x13d)]()){_0x4d4568=_0x668f3e[_0x4399a7(0x1ed)]||0x2d;break;}}_0x29b272=_0x3db662*(_0x4d4568/0x64),_0xa5abdf=_0x3db662-_0x29b272,console[_0x4399a7(0x184)](_0x4399a7(0x104)+_0x16a7cf['id']+':\x20'+_0x4d4568+_0x4399a7(0x202)+_0x3db662[_0x4399a7(0x245)](0x6)+_0x4399a7(0x23d));}_0x58d7ce+=_0x3db662,_0x20c734+=_0xa5abdf,_0x32eac1+=_0x29b272;let _0x55ecac;_0x16a7cf['gatewayCommissionRate']!==null&&_0x16a7cf[_0x4399a7(0x248)]!==undefined?(_0x55ecac=_0x16a7cf[_0x4399a7(0x248)],console[_0x4399a7(0x184)](_0x4399a7(0x12e)+_0x16a7cf['id']+':\x20'+_0x55ecac+'%')):(_0x55ecac=_0x3db662>0x0?_0x29b272/_0x3db662*0x64:0x0,console['log'](_0x4399a7(0x205)+_0x16a7cf['id']+':\x20'+_0x55ecac['toFixed'](0x2)+'%'));!_0x1b5c12[_0x16a7cf[_0x4399a7(0x1a9)]]&&(_0x1b5c12[_0x16a7cf['gateway']]={'gateway':_0x16a7cf[_0x4399a7(0x1a9)],'gatewayDisplayName':this[_0x4399a7(0x21d)](_0x16a7cf[_0x4399a7(0x1a9)]),'paymentsCount':0x0,'turnoverUSDT':0x0,'commissionUSDT':0x0,'merchantEarningsUSDT':0x0,'totalCommissionRate':0x0});_0x1b5c12[_0x16a7cf[_0x4399a7(0x1a9)]][_0x4399a7(0x1a0)]++,_0x1b5c12[_0x16a7cf[_0x4399a7(0x1a9)]]['turnoverUSDT']+=_0x3db662,_0x1b5c12[_0x16a7cf[_0x4399a7(0x1a9)]][_0x4399a7(0x133)]+=_0x29b272,_0x1b5c12[_0x16a7cf[_0x4399a7(0x1a9)]][_0x4399a7(0x17b)]+=_0xa5abdf,_0x1b5c12[_0x16a7cf[_0x4399a7(0x1a9)]]['totalCommissionRate']+=_0x55ecac;!_0x90972[_0x4399a7(0x14e)]&&(!_0x1b807d[_0x16a7cf['shopId']]&&(_0x1b807d[_0x16a7cf[_0x4399a7(0x14e)]]={'shopId':_0x16a7cf[_0x4399a7(0x14e)],'shopName':_0x16a7cf[_0x4399a7(0x21a)][_0x4399a7(0x1a2)],'shopUsername':_0x16a7cf[_0x4399a7(0x21a)][_0x4399a7(0x160)],'paymentsCount':0x0,'turnoverUSDT':0x0,'commissionUSDT':0x0,'merchantEarningsUSDT':0x0,'paidOutUSDT':0x0,'averageCheckUSDT':0x0}),_0x1b807d[_0x16a7cf[_0x4399a7(0x14e)]]['paymentsCount']++,_0x1b807d[_0x16a7cf[_0x4399a7(0x14e)]]['turnoverUSDT']+=_0x3db662,_0x1b807d[_0x16a7cf[_0x4399a7(0x14e)]]['commissionUSDT']+=_0x29b272,_0x1b807d[_0x16a7cf['shopId']][_0x4399a7(0x17b)]+=_0xa5abdf);const _0x4f1f7f=_0x16a7cf[_0x4399a7(0x1f3)][_0x4399a7(0x18c)]()[_0x4399a7(0x1ad)]('T')[0x0];!_0x93e1ee[_0x4f1f7f]&&(_0x93e1ee[_0x4f1f7f]={'date':_0x4f1f7f,'turnover':0x0,'merchantEarnings':0x0,'gatewayEarnings':0x0,'paymentsCount':0x0}),_0x93e1ee[_0x4f1f7f]['turnover']+=_0x3db662,_0x93e1ee[_0x4f1f7f]['merchantEarnings']+=_0xa5abdf,_0x93e1ee[_0x4f1f7f][_0x4399a7(0x1a3)]+=_0x29b272,_0x93e1ee[_0x4f1f7f][_0x4399a7(0x1a0)]++;}catch(_0x3dba31){console[_0x4399a7(0x18b)](_0x4399a7(0x1d4)+_0x16a7cf['id']+':',_0x3dba31);}}Object['values'](_0x1b5c12)[_0x4399a7(0x134)](_0x2be070=>{const _0x4551e1=_0x4399a7;_0x2be070['averageCommissionRate']=_0x2be070[_0x4551e1(0x1a0)]>0x0?_0x2be070[_0x4551e1(0x19a)]/_0x2be070[_0x4551e1(0x1a0)]:0x0,delete _0x2be070[_0x4551e1(0x19a)];}),Object[_0x4399a7(0x21c)](_0x1b807d)[_0x4399a7(0x134)](_0x3bd836=>{const _0x3a28ff=_0x4399a7;_0x3bd836[_0x3a28ff(0x1a7)]=_0x3bd836['paymentsCount']>0x0?_0x3bd836['turnoverUSDT']/_0x3bd836[_0x3a28ff(0x1a0)]:0x0;});let _0x33af6a=0x0,_0x49c3a6=0x0;if(_0x90972['shopId']){const _0xade24a=await database_1[_0x4399a7(0x201)]['payout'][_0x4399a7(0x116)]({'where':{'shopId':_0x90972[_0x4399a7(0x14e)],'status':_0x4399a7(0x24f),'createdAt':{'gte':_0xbf4229,'lte':_0x537767}},'select':{'amount':!![]}});_0x33af6a=_0xade24a[_0x4399a7(0x1bb)]((_0x57ed7d,_0x32c64f)=>_0x57ed7d+_0x32c64f[_0x4399a7(0x1c3)],0x0);const _0x17b958=await database_1[_0x4399a7(0x201)][_0x4399a7(0x231)][_0x4399a7(0x116)]({'where':{'shopId':_0x90972[_0x4399a7(0x14e)],'status':_0x4399a7(0x1b5),'createdAt':{'gte':_0xbf4229,'lte':_0x537767}},'select':{'amount':!![]}});_0x49c3a6=_0x17b958[_0x4399a7(0x1bb)]((_0x206caa,_0x2ef439)=>_0x206caa+_0x2ef439['amount'],0x0);}const _0x45b7e6=_0xc07671,_0x187356=_0x305cca['length'],_0x3925ec=_0x187356>0x0?_0x58d7ce/_0x187356:0x0,_0x55eff7=_0x45b7e6>0x0?Math[_0x4399a7(0x206)](_0x187356/_0x45b7e6*0x2710)/0x64:0x0,_0x53ebfc=Math['ceil']((_0x537767[_0x4399a7(0x173)]()-_0xbf4229[_0x4399a7(0x173)]())/(0x3e8*0x3c*0x3c*0x18)),_0x31fbf8={'totalTurnover':Math[_0x4399a7(0x206)](_0x58d7ce*0x64)/0x64,'merchantEarnings':Math['round'](_0x20c734*0x64)/0x64,'gatewayEarnings':Math['round'](_0x32eac1*0x64)/0x64,'totalPaidOut':Math[_0x4399a7(0x206)](_0x33af6a*0x64)/0x64,'pendingPayout':Math[_0x4399a7(0x206)](_0x49c3a6*0x64)/0x64,'averageCheck':Math[_0x4399a7(0x206)](_0x3925ec*0x64)/0x64,'totalPayments':_0x45b7e6,'successfulPayments':_0x187356,'conversionRate':_0x55eff7,'gatewayBreakdown':Object[_0x4399a7(0x21c)](_0x1b5c12)[_0x4399a7(0x11f)](_0x15476f=>({..._0x15476f,'turnoverUSDT':Math['round'](_0x15476f[_0x4399a7(0x23f)]*0x64)/0x64,'commissionUSDT':Math[_0x4399a7(0x206)](_0x15476f['commissionUSDT']*0x64)/0x64,'merchantEarningsUSDT':Math['round'](_0x15476f['merchantEarningsUSDT']*0x64)/0x64,'averageCommissionRate':Math[_0x4399a7(0x206)](_0x15476f[_0x4399a7(0x16f)]*0x64)/0x64})),'merchantBreakdown':_0x90972[_0x4399a7(0x14e)]?undefined:Object[_0x4399a7(0x21c)](_0x1b807d)[_0x4399a7(0x11f)](_0xbd8a1=>({..._0xbd8a1,'turnoverUSDT':Math[_0x4399a7(0x206)](_0xbd8a1[_0x4399a7(0x23f)]*0x64)/0x64,'commissionUSDT':Math['round'](_0xbd8a1[_0x4399a7(0x133)]*0x64)/0x64,'merchantEarningsUSDT':Math[_0x4399a7(0x206)](_0xbd8a1[_0x4399a7(0x17b)]*0x64)/0x64,'paidOutUSDT':Math[_0x4399a7(0x206)](_0xbd8a1[_0x4399a7(0x20b)]*0x64)/0x64,'averageCheckUSDT':Math[_0x4399a7(0x206)](_0xbd8a1[_0x4399a7(0x1a7)]*0x64)/0x64})),'dailyData':Object['values'](_0x93e1ee)['map'](_0x38dc1c=>({..._0x38dc1c,'turnover':Math[_0x4399a7(0x206)](_0x38dc1c[_0x4399a7(0x219)]*0x64)/0x64,'merchantEarnings':Math[_0x4399a7(0x206)](_0x38dc1c[_0x4399a7(0x1dd)]*0x64)/0x64,'gatewayEarnings':Math[_0x4399a7(0x206)](_0x38dc1c[_0x4399a7(0x1a3)]*0x64)/0x64}))[_0x4399a7(0x22d)]((_0x1cd526,_0x98e429)=>_0x1cd526[_0x4399a7(0x233)]['localeCompare'](_0x98e429['date'])),'periodInfo':{'from':_0xbf4229,'to':_0x537767,'periodType':_0x90972['period']||_0x4399a7(0x221),'daysCount':_0x53ebfc}};return console['log'](_0x4399a7(0x1e4)),console[_0x4399a7(0x184)](_0x4399a7(0x23a)+_0x31fbf8['totalTurnover']+_0x4399a7(0x23d)),console[_0x4399a7(0x184)](_0x4399a7(0x149)+_0x31fbf8[_0x4399a7(0x1dd)]+'\x20USDT'),console[_0x4399a7(0x184)](_0x4399a7(0x115)+_0x31fbf8[_0x4399a7(0x1a3)]+'\x20USDT'),console['log'](_0x4399a7(0x1d1)+_0x31fbf8[_0x4399a7(0x22a)]+_0x4399a7(0x23d)),console['log'](_0x4399a7(0x1fb)+_0x31fbf8['pendingPayout']+'\x20USDT'),console['log'](_0x4399a7(0x21f)+_0x31fbf8[_0x4399a7(0x18a)]),_0x31fbf8;}async['getMerchantsSelection'](){const _0x3ef52f=a38_0x46fb30;console[_0x3ef52f(0x184)](_0x3ef52f(0x154));const _0xba0111=await database_1[_0x3ef52f(0x201)][_0x3ef52f(0x21a)][_0x3ef52f(0x116)]({'where':{'status':_0x3ef52f(0x1b3)},'select':{'id':!![],'username':!![],'name':!![]},'orderBy':{'name':_0x3ef52f(0x178)}});return console[_0x3ef52f(0x184)](_0x3ef52f(0x243)+_0xba0111[_0x3ef52f(0x127)]+_0x3ef52f(0x1b0)),_0xba0111[_0x3ef52f(0x11f)](_0x2b5b32=>({'id':_0x2b5b32['id'],'username':_0x2b5b32[_0x3ef52f(0x160)],'name':_0x2b5b32[_0x3ef52f(0x1a2)]}));}[a38_0x46fb30(0x21d)](_0x5dbcde){const _0x107716=a38_0x46fb30,_0x2b9259={'test_gateway':_0x107716(0x14a),'plisio':_0x107716(0x1c4),'rapyd':'Rapyd','noda':'Noda','cointopay':_0x107716(0x11b),'cointopay2':_0x107716(0x19f),'klyme_eu':_0x107716(0x175),'klyme_gb':_0x107716(0x1db),'klyme_de':_0x107716(0x15e),'mastercard':'MasterCard'};return _0x2b9259[_0x5dbcde]||_0x5dbcde;}[a38_0x46fb30(0x15d)](_0x18496d){const _0x8ac1a9=a38_0x46fb30,_0x46a7c9={'Test\x20Gateway':'test_gateway','Plisio':_0x8ac1a9(0x153),'Rapyd':_0x8ac1a9(0x1b6),'Noda':_0x8ac1a9(0x161),'CoinToPay':'cointopay','CoinToPay2':_0x8ac1a9(0x238),'KLYME\x20EU':_0x8ac1a9(0x1c7),'KLYME\x20GB':_0x8ac1a9(0x21b),'KLYME\x20DE':'klyme_de','MasterCard':_0x8ac1a9(0x17f)};return _0x46a7c9[_0x18496d]||_0x18496d[_0x8ac1a9(0x13d)]();}async[a38_0x46fb30(0x141)](_0x1b5817){const _0x36ac6f=a38_0x46fb30,{page:_0x5d1b92,limit:_0x32dbb7,minAmount:_0x52a33d,search:_0x15cd68}=_0x1b5817,_0x14d1f0=(_0x5d1b92-0x1)*_0x32dbb7;console[_0x36ac6f(0x184)]('📊\x20Getting\x20merchants\x20awaiting\x20payout\x20with\x20filters:',_0x1b5817);const _0x582ed6={'balance':{'gt':0x0},'status':'ACTIVE'};_0x52a33d&&(_0x582ed6[_0x36ac6f(0x10d)][_0x36ac6f(0x1c1)]=_0x52a33d);_0x15cd68&&(_0x582ed6[_0x36ac6f(0x1a2)]={'contains':_0x15cd68,'mode':_0x36ac6f(0x13e)});const [_0x17a430,_0x1ccf55]=await Promise['all']([database_1[_0x36ac6f(0x201)][_0x36ac6f(0x21a)][_0x36ac6f(0x116)]({'where':_0x582ed6,'skip':_0x14d1f0,'take':_0x32dbb7,'orderBy':{'balance':_0x36ac6f(0x22e)},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'balance':!![],'totalPaidOut':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'usdcErcWallet':!![],'gatewaySettings':!![],'createdAt':!![]}}),database_1[_0x36ac6f(0x201)]['shop'][_0x36ac6f(0x1eb)]({'where':_0x582ed6})]);console['log'](_0x36ac6f(0x12f)+_0x17a430[_0x36ac6f(0x127)]+_0x36ac6f(0x189));const _0x19b7bb=await Promise[_0x36ac6f(0x22f)](_0x17a430['map'](async _0x19bf2b=>{const _0x4e057e=_0x36ac6f,[_0x238578,_0x6ad19,_0x21fa25]=await Promise[_0x4e057e(0x22f)]([database_1[_0x4e057e(0x201)][_0x4e057e(0x200)][_0x4e057e(0x1eb)]({'where':{'shopId':_0x19bf2b['id'],'status':_0x4e057e(0x1d9),'gateway':{'not':_0x4e057e(0x121)}}}),database_1[_0x4e057e(0x201)]['payment'][_0x4e057e(0x143)]({'where':{'shopId':_0x19bf2b['id'],'status':'PAID','gateway':{'not':'test_gateway'}},'orderBy':{'paidAt':_0x4e057e(0x178)},'select':{'paidAt':!![]}}),database_1['default'][_0x4e057e(0x200)][_0x4e057e(0x124)]({'by':[_0x4e057e(0x1a9)],'where':{'shopId':_0x19bf2b['id'],'status':'PAID','gateway':{'not':_0x4e057e(0x121)}},'_count':{'id':!![]},'_sum':{'amountUSDT':!![]}})]),_0x16b912=new Date(),_0x4547b0=new Date(_0x16b912[_0x4e057e(0x217)](),_0x16b912[_0x4e057e(0x179)](),0x1),_0x43aa51=new Date(_0x16b912['getFullYear'](),_0x16b912[_0x4e057e(0x179)]()+0x1,0x0,0x17,0x3b,0x3b,0x3e7),[_0x272e30,_0x51aaca]=await Promise[_0x4e057e(0x22f)]([database_1['default'][_0x4e057e(0x231)][_0x4e057e(0x1ae)]({'_sum':{'amount':!![]},'where':{'shopId':_0x19bf2b['id'],'status':_0x4e057e(0x24f)}}),database_1[_0x4e057e(0x201)]['payout'][_0x4e057e(0x1ae)]({'_sum':{'amount':!![]},'where':{'shopId':_0x19bf2b['id'],'status':'COMPLETED','createdAt':{'gte':_0x4547b0,'lte':_0x43aa51}}})]),_0x55fad5=_0x272e30[_0x4e057e(0x1fa)][_0x4e057e(0x1c3)]||0x0,_0x8e70e3=_0x51aaca[_0x4e057e(0x1fa)][_0x4e057e(0x1c3)]||0x0,_0x24124c=await Promise[_0x4e057e(0x22f)](_0x21fa25[_0x4e057e(0x11f)](async _0x34a4d4=>{const _0x354f63=_0x4e057e;let _0x4254e2=0x2d;if(_0x19bf2b[_0x354f63(0x218)])try{const _0x226195=JSON[_0x354f63(0x198)](_0x19bf2b[_0x354f63(0x218)]);for(const [_0x4c3725,_0x220e2e]of Object[_0x354f63(0x1c5)](_0x226195)){if(_0x4c3725[_0x354f63(0x13d)]()===_0x34a4d4[_0x354f63(0x1a9)][_0x354f63(0x13d)]()){_0x4254e2=_0x220e2e[_0x354f63(0x1ed)]||0xa,console[_0x354f63(0x184)](_0x354f63(0x1a5)+_0x34a4d4['gateway']+'\x20for\x20shop\x20'+_0x19bf2b['id']+_0x354f63(0x1ce)+_0x4254e2+'%');break;}}}catch(_0x5be45a){console[_0x354f63(0x18b)]('Error\x20parsing\x20gateway\x20settings\x20for\x20shop\x20'+_0x19bf2b['id']+':',_0x5be45a);}const _0x4bd38f=_0x34a4d4[_0x354f63(0x1fa)]?.[_0x354f63(0x1a4)]||0x0,_0x676295=_0x4bd38f*(0x1-_0x4254e2/0x64);return{'gateway':_0x34a4d4[_0x354f63(0x1a9)],'count':_0x34a4d4[_0x354f63(0x1cf)]?.['id']||0x0,'amountUSDT':Math[_0x354f63(0x206)](_0x4bd38f*0x64)/0x64,'amountAfterCommissionUSDT':Math[_0x354f63(0x206)](_0x676295*0x64)/0x64,'commission':_0x4254e2};})),_0x5d5c55=_0x24124c[_0x4e057e(0x1bb)]((_0x4b8ac2,_0x264fb7)=>_0x4b8ac2+_0x264fb7[_0x4e057e(0x1a4)],0x0),_0x14ccf2=_0x24124c['reduce']((_0x6e9291,_0x1229f2)=>_0x6e9291+_0x1229f2['amountAfterCommissionUSDT'],0x0),_0x995f83=_0x19bf2b[_0x4e057e(0x10d)];return console[_0x4e057e(0x184)](_0x4e057e(0x18d)+_0x19bf2b['username']+':'),console[_0x4e057e(0x184)](_0x4e057e(0x19e)+_0x5d5c55[_0x4e057e(0x245)](0x2)+_0x4e057e(0x113)),console['log'](_0x4e057e(0x17d)+_0x14ccf2[_0x4e057e(0x245)](0x2)+_0x4e057e(0x11a)),console[_0x4e057e(0x184)](_0x4e057e(0x109)+_0x995f83[_0x4e057e(0x245)](0x2)+'\x20USDT\x20(current\x20balance\x20in\x20DB)'),console[_0x4e057e(0x184)](_0x4e057e(0x1a8)+_0x55fad5[_0x4e057e(0x245)](0x2)+_0x4e057e(0x199)),console[_0x4e057e(0x184)](_0x4e057e(0x186)+(_0x14ccf2-_0x55fad5-_0x995f83)[_0x4e057e(0x245)](0x2)+_0x4e057e(0x203)),{'id':_0x19bf2b['id'],'fullName':_0x19bf2b[_0x4e057e(0x1a2)],'username':_0x19bf2b[_0x4e057e(0x160)],'telegramId':_0x19bf2b[_0x4e057e(0x1c2)],'merchantUrl':_0x19bf2b[_0x4e057e(0x106)],'wallets':{'usdtPolygonWallet':_0x19bf2b[_0x4e057e(0x132)],'usdtTrcWallet':_0x19bf2b['usdtTrcWallet'],'usdtErcWallet':_0x19bf2b[_0x4e057e(0x223)],'usdcPolygonWallet':_0x19bf2b['usdcPolygonWallet'],'usdcErcWallet':_0x19bf2b[_0x4e057e(0x19d)]},'totalAmountUSDT':Math[_0x4e057e(0x206)](_0x5d5c55*0x64)/0x64,'totalAmountAfterCommissionUSDT':Math[_0x4e057e(0x206)](_0x14ccf2*0x64)/0x64,'currentBalance':Math[_0x4e057e(0x206)](_0x995f83*0x64)/0x64,'totalPayout':Math[_0x4e057e(0x206)](_0x55fad5*0x64)/0x64,'thisMonth':Math[_0x4e057e(0x206)](_0x8e70e3*0x64)/0x64,'paymentsCount':_0x238578,'oldestPaymentDate':_0x6ad19?.['paidAt']||_0x19bf2b[_0x4e057e(0x157)],'gatewayBreakdown':_0x24124c};})),_0x18e793=_0x19b7bb['reduce']((_0x27c9f3,_0x294824)=>_0x27c9f3+_0x294824[_0x36ac6f(0x131)],0x0),_0x4c8a4=_0x19b7bb[_0x36ac6f(0x1bb)]((_0xeaec47,_0x10d98a)=>_0xeaec47+_0x10d98a[_0x36ac6f(0x171)],0x0),_0x14ba04=_0x19b7bb[_0x36ac6f(0x1bb)]((_0x5bc59d,_0x331f25)=>_0x5bc59d+_0x331f25[_0x36ac6f(0x249)],0x0),_0x1888e7=_0x19b7bb['reduce']((_0x3681c0,_0x12b314)=>_0x3681c0+_0x12b314[_0x36ac6f(0x215)],0x0);return console[_0x36ac6f(0x184)](_0x36ac6f(0x224)+_0x1ccf55+_0x36ac6f(0x212)),console[_0x36ac6f(0x184)](_0x36ac6f(0x1f1)+Math['round'](_0x18e793*0x64)/0x64+'\x20USDT\x20(gross\x20revenue)'),console[_0x36ac6f(0x184)](_0x36ac6f(0x220)+Math['round'](_0x4c8a4*0x64)/0x64+_0x36ac6f(0x15f)),console[_0x36ac6f(0x184)](_0x36ac6f(0x17c)+Math['round'](_0x14ba04*0x64)/0x64+_0x36ac6f(0x23d)),console[_0x36ac6f(0x184)]('\x20\x20\x20📅\x20Total\x20payouts\x20(this\x20month):\x20'+Math[_0x36ac6f(0x206)](_0x1888e7*0x64)/0x64+_0x36ac6f(0x23d)),{'merchants':_0x19b7bb,'pagination':{'page':_0x5d1b92,'limit':_0x32dbb7,'total':_0x1ccf55,'totalPages':Math['ceil'](_0x1ccf55/_0x32dbb7)},'summary':{'totalMerchants':_0x1ccf55,'totalAmountUSDT':Math[_0x36ac6f(0x206)](_0x18e793*0x64)/0x64,'totalAmountAfterCommissionUSDT':Math['round'](_0x4c8a4*0x64)/0x64,'totalPayout':Math[_0x36ac6f(0x206)](_0x14ba04*0x64)/0x64,'thisMonth':Math['round'](_0x1888e7*0x64)/0x64}};}async[a38_0x46fb30(0x1d7)](_0x240949){const _0x5df4c0=a38_0x46fb30,{shopId:_0x141a79,amount:_0x5b2238,network:_0x250e70,wallet:_0x11b78f,notes:_0x3bb935,txid:_0x210f79,periodFrom:_0x4d3dde,periodTo:_0x1e84f8}=_0x240949,_0x336a25=await database_1[_0x5df4c0(0x201)][_0x5df4c0(0x241)](async _0x54979d=>{const _0x58418b=_0x5df4c0,_0x3f2dee=await _0x54979d[_0x58418b(0x21a)][_0x58418b(0x244)]({'where':{'id':_0x141a79},'select':{'id':!![],'name':!![],'username':!![],'balance':!![],'totalPaidOut':!![]}});if(!_0x3f2dee)throw new Error('Shop\x20not\x20found');console[_0x58418b(0x184)](_0x58418b(0x142)+_0x3f2dee[_0x58418b(0x160)]+':'),console['log'](_0x58418b(0x1b2)+_0x3f2dee[_0x58418b(0x10d)][_0x58418b(0x245)](0x6)+_0x58418b(0x23d)),console[_0x58418b(0x184)](_0x58418b(0x226)+_0x5b2238[_0x58418b(0x245)](0x6)+_0x58418b(0x23d)),console['log'](_0x58418b(0x216)+_0x3f2dee[_0x58418b(0x22a)][_0x58418b(0x245)](0x6)+'\x20USDT');if(_0x210f79)console[_0x58418b(0x184)](_0x58418b(0x1e7)+_0x210f79);if(_0x3f2dee['balance']<_0x5b2238)throw new Error(_0x58418b(0x23e)+_0x3f2dee[_0x58418b(0x10d)][_0x58418b(0x245)](0x6)+_0x58418b(0x10b)+_0x5b2238['toFixed'](0x6)+_0x58418b(0x23d));let _0x394607=_0x11b78f;if(!_0x394607){const _0x4c1508=await _0x54979d[_0x58418b(0x21a)]['findUnique']({'where':{'id':_0x141a79},'select':{'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'usdcErcWallet':!![]}});if(_0x4c1508)switch(_0x250e70){case'polygon':_0x394607=_0x4c1508['usdtPolygonWallet']||undefined;break;case _0x58418b(0x15c):_0x394607=_0x4c1508['usdtTrcWallet']||undefined;break;case _0x58418b(0x136):_0x394607=_0x4c1508[_0x58418b(0x223)]||undefined;break;case'polygon_usdc':_0x394607=_0x4c1508[_0x58418b(0x118)]||undefined;break;case _0x58418b(0x12a):_0x394607=_0x4c1508[_0x58418b(0x19d)]||undefined;break;}}console[_0x58418b(0x184)]('💳\x20Payout\x20wallet\x20for\x20'+_0x250e70+':\x20'+(_0x394607||_0x58418b(0x1fc)));const _0x5b6e1e=await _0x54979d[_0x58418b(0x231)][_0x58418b(0x197)]({'data':{'shopId':_0x141a79,'amount':_0x5b2238,'network':_0x250e70,'status':'COMPLETED','txid':_0x210f79,'notes':_0x3bb935,'periodFrom':_0x4d3dde?new Date(_0x4d3dde):null,'periodTo':_0x1e84f8?new Date(_0x1e84f8):null,'createdAt':new Date(),'paidAt':new Date()}}),_0x1170b9=_0x3f2dee[_0x58418b(0x10d)]-_0x5b2238,_0x4e8f88=_0x3f2dee[_0x58418b(0x22a)]+_0x5b2238;return await _0x54979d['shop'][_0x58418b(0x1ca)]({'where':{'id':_0x141a79},'data':{'balance':_0x1170b9,'totalPaidOut':_0x4e8f88}}),console[_0x58418b(0x184)](_0x58418b(0x122)+_0x3f2dee[_0x58418b(0x160)]+_0x58418b(0x192)),console[_0x58418b(0x184)](_0x58418b(0x170)+_0x3f2dee['balance'][_0x58418b(0x245)](0x6)+_0x58418b(0x158)+_0x1170b9[_0x58418b(0x245)](0x6)+'\x20USDT\x20(-'+_0x5b2238['toFixed'](0x6)+')'),console[_0x58418b(0x184)](_0x58418b(0x230)+_0x3f2dee[_0x58418b(0x22a)][_0x58418b(0x245)](0x6)+_0x58418b(0x158)+_0x4e8f88[_0x58418b(0x245)](0x6)+'\x20USDT\x20(+'+_0x5b2238[_0x58418b(0x245)](0x6)+')'),{'payout':_0x5b6e1e,'shop':_0x3f2dee};});return console[_0x5df4c0(0x184)](_0x5df4c0(0x1cd)+_0x336a25[_0x5df4c0(0x231)]['id']+_0x5df4c0(0x155)+_0x336a25[_0x5df4c0(0x21a)][_0x5df4c0(0x160)]+'\x20('+_0x5b2238+_0x5df4c0(0x187)),{'id':_0x336a25[_0x5df4c0(0x231)]['id'],'shopId':_0x336a25[_0x5df4c0(0x231)][_0x5df4c0(0x14e)],'shopName':_0x336a25['shop'][_0x5df4c0(0x1a2)],'shopUsername':_0x336a25[_0x5df4c0(0x21a)][_0x5df4c0(0x160)],'amount':_0x336a25['payout'][_0x5df4c0(0x1c3)],'network':_0x336a25[_0x5df4c0(0x231)][_0x5df4c0(0x235)],'status':_0x336a25[_0x5df4c0(0x231)][_0x5df4c0(0x19c)],'txid':_0x336a25[_0x5df4c0(0x231)][_0x5df4c0(0x1c9)],'notes':_0x336a25['payout']['notes'],'periodFrom':_0x336a25[_0x5df4c0(0x231)][_0x5df4c0(0x225)],'periodTo':_0x336a25['payout'][_0x5df4c0(0x13f)],'createdAt':_0x336a25[_0x5df4c0(0x231)]['createdAt'],'paidAt':_0x336a25[_0x5df4c0(0x231)][_0x5df4c0(0x1f3)]};}async[a38_0x46fb30(0x139)](_0xa6208e){const _0x341610=a38_0x46fb30,{page:_0x1d2a76,limit:_0x501542,shopId:_0x294b72,network:_0x56f4a7,dateFrom:_0x4ccc6d,dateTo:_0x1eef53,search:_0x1ee5e6}=_0xa6208e,_0x15ebdb=(_0x1d2a76-0x1)*_0x501542,_0x9b58f5={};_0x294b72&&(_0x9b58f5[_0x341610(0x14e)]=_0x294b72);_0x56f4a7&&(_0x9b58f5[_0x341610(0x235)]=_0x56f4a7);(_0x4ccc6d||_0x1eef53)&&(_0x9b58f5[_0x341610(0x157)]={},_0x4ccc6d&&(_0x9b58f5[_0x341610(0x157)][_0x341610(0x1c1)]=new Date(_0x4ccc6d)),_0x1eef53&&(_0x9b58f5[_0x341610(0x157)][_0x341610(0x10c)]=new Date(_0x1eef53)));_0x1ee5e6&&(_0x9b58f5['OR']=[{'shop':{'name':{'contains':_0x1ee5e6,'mode':_0x341610(0x13e)}}},{'shop':{'username':{'contains':_0x1ee5e6,'mode':_0x341610(0x13e)}}},{'notes':{'contains':_0x1ee5e6,'mode':_0x341610(0x13e)}}]);const [_0x529dab,_0x271dc0]=await Promise[_0x341610(0x22f)]([database_1['default'][_0x341610(0x231)][_0x341610(0x116)]({'where':_0x9b58f5,'skip':_0x15ebdb,'take':_0x501542,'orderBy':{'createdAt':_0x341610(0x22e)},'select':{'id':!![],'shopId':!![],'amount':!![],'network':!![],'status':!![],'txid':!![],'notes':!![],'periodFrom':!![],'periodTo':!![],'createdAt':!![],'paidAt':!![],'shop':{'select':{'name':!![],'username':!![]}}}}),database_1[_0x341610(0x201)][_0x341610(0x231)][_0x341610(0x1eb)]({'where':_0x9b58f5})]);return{'payouts':_0x529dab[_0x341610(0x11f)](_0x5ddf56=>({'id':_0x5ddf56['id'],'shopId':_0x5ddf56[_0x341610(0x14e)],'shopName':_0x5ddf56[_0x341610(0x21a)]['name'],'shopUsername':_0x5ddf56['shop'][_0x341610(0x160)],'amount':_0x5ddf56[_0x341610(0x1c3)],'network':_0x5ddf56[_0x341610(0x235)],'status':_0x5ddf56[_0x341610(0x19c)],'txid':_0x5ddf56[_0x341610(0x1c9)],'notes':_0x5ddf56[_0x341610(0x15b)],'periodFrom':_0x5ddf56[_0x341610(0x225)],'periodTo':_0x5ddf56['periodTo'],'createdAt':_0x5ddf56[_0x341610(0x157)],'paidAt':_0x5ddf56['paidAt']})),'pagination':{'page':_0x1d2a76,'limit':_0x501542,'total':_0x271dc0,'totalPages':Math[_0x341610(0x24b)](_0x271dc0/_0x501542)}};}async[a38_0x46fb30(0x222)](_0x3fb2fa){const _0x40a694=a38_0x46fb30,_0x2f0678=await database_1[_0x40a694(0x201)][_0x40a694(0x231)]['findUnique']({'where':{'id':_0x3fb2fa},'include':{'shop':{'select':{'name':!![],'username':!![]}}}});if(!_0x2f0678)return null;return{'id':_0x2f0678['id'],'shopId':_0x2f0678[_0x40a694(0x14e)],'shopName':_0x2f0678['shop'][_0x40a694(0x1a2)],'shopUsername':_0x2f0678[_0x40a694(0x21a)][_0x40a694(0x160)],'amount':_0x2f0678[_0x40a694(0x1c3)],'network':_0x2f0678[_0x40a694(0x235)],'status':_0x2f0678[_0x40a694(0x19c)],'txid':_0x2f0678[_0x40a694(0x1c9)],'notes':_0x2f0678[_0x40a694(0x15b)],'periodFrom':_0x2f0678[_0x40a694(0x225)],'periodTo':_0x2f0678[_0x40a694(0x13f)],'createdAt':_0x2f0678[_0x40a694(0x157)],'paidAt':_0x2f0678[_0x40a694(0x1f3)]};}async[a38_0x46fb30(0x152)](_0x47c946){const _0x3b4898=a38_0x46fb30;await database_1[_0x3b4898(0x201)]['payout']['delete']({'where':{'id':_0x47c946}});}async['getAllPayments'](_0x130157){const _0x53657c=a38_0x46fb30,{page:_0x15cc25,limit:_0x2b8107,status:_0x5c5fcd,gateway:_0x55080f,shopId:_0x4184ed,dateFrom:_0x2dbd26,dateTo:_0x28ab21,search:_0xb43c44,currency:_0x2de938,sortBy:_0x391731,sortOrder:_0x53a899}=_0x130157,_0x43e201=(_0x15cc25-0x1)*_0x2b8107;console['log'](_0x53657c(0x232),_0x130157);const _0x457847=await database_1['default'][_0x53657c(0x200)][_0x53657c(0x124)]({'by':['gateway'],'_count':{'gateway':!![]}});console[_0x53657c(0x184)](_0x53657c(0x242),_0x457847[_0x53657c(0x11f)](_0x1212df=>_0x1212df[_0x53657c(0x1a9)]+'\x20('+_0x1212df['_count'][_0x53657c(0x1a9)]+_0x53657c(0x234)));if(_0x55080f){const _0x39021f=_0x457847['some'](_0x3fddbb=>_0x3fddbb['gateway'][_0x53657c(0x13d)]()===_0x55080f[_0x53657c(0x13d)]());!_0x39021f&&_0x55080f[_0x53657c(0x13d)]()!=='test_gateway'&&console[_0x53657c(0x184)]('⚠️\x20Requested\x20gateway\x20\x27'+_0x55080f+_0x53657c(0x159)+_0x457847[_0x53657c(0x11f)](_0x2f9666=>_0x2f9666['gateway'])[_0x53657c(0x1bf)](',\x20'));}const _0x1ccb85={};_0x5c5fcd&&(_0x1ccb85[_0x53657c(0x19c)]=_0x5c5fcd[_0x53657c(0x20a)]());if(!_0x55080f)_0x1ccb85[_0x53657c(0x1a9)]={'not':_0x53657c(0x121)};else{if(_0x55080f&&(_0x55080f[_0x53657c(0x13d)]()===_0x53657c(0x121)||_0x55080f==='0000'))_0x1ccb85[_0x53657c(0x1a9)]='test_gateway';else{let _0x9b896b=_0x55080f;const _0x14fdcf=(0x0,gateway_1[_0x53657c(0x24a)])(_0x55080f);if(_0x14fdcf)_0x9b896b=_0x14fdcf,console[_0x53657c(0x184)](_0x53657c(0x1ff)+_0x55080f+'\x27\x20to\x20name\x20\x27'+_0x9b896b+'\x27');else{const _0x22ca04=(0x0,gateway_1[_0x53657c(0x108)])(_0x55080f);if(_0x22ca04){const _0x60c31d=(0x0,gateway_1[_0x53657c(0x24a)])(_0x22ca04);_0x60c31d&&(_0x9b896b=_0x60c31d,console[_0x53657c(0x184)](_0x53657c(0x1f8)+_0x55080f+_0x53657c(0x185)+_0x22ca04+_0x53657c(0x1e3)+_0x9b896b+'\x27'));}else console[_0x53657c(0x184)]('🔍\x20Using\x20gateway\x20\x27'+_0x55080f+_0x53657c(0x239));}const _0x379e02=await database_1[_0x53657c(0x201)]['payment'][_0x53657c(0x1eb)]({'where':{'gateway':_0x9b896b[_0x53657c(0x13d)]()},'take':0x1});_0x379e02===0x0?(console[_0x53657c(0x184)]('⚠️\x20Gateway\x20\x27'+_0x9b896b+_0x53657c(0x125)+_0x55080f+_0x53657c(0x1e2)),_0x1ccb85[_0x53657c(0x1a9)]=_0x53657c(0x1d5)):(_0x1ccb85[_0x53657c(0x1a9)]=_0x9b896b[_0x53657c(0x13d)](),console[_0x53657c(0x184)](_0x53657c(0x20f)+_0x9b896b+_0x53657c(0x125)+_0x55080f+'\x27)'));}}console[_0x53657c(0x184)](_0x53657c(0x15a),_0x1ccb85[_0x53657c(0x1a9)]);_0x4184ed&&(_0x1ccb85[_0x53657c(0x14e)]=_0x4184ed);_0x2de938&&(_0x1ccb85['currency']=_0x2de938[_0x53657c(0x20a)](),console[_0x53657c(0x184)](_0x53657c(0x1ba)+_0x2de938[_0x53657c(0x20a)]()));(_0x2dbd26||_0x28ab21)&&(_0x1ccb85[_0x53657c(0x157)]={},_0x2dbd26&&(_0x1ccb85[_0x53657c(0x157)][_0x53657c(0x1c1)]=new Date(_0x2dbd26)),_0x28ab21&&(_0x1ccb85[_0x53657c(0x157)][_0x53657c(0x10c)]=new Date(_0x28ab21)));_0xb43c44&&(_0x1ccb85['OR']=[{'id':{'contains':_0xb43c44,'mode':_0x53657c(0x13e)}},{'orderId':{'contains':_0xb43c44,'mode':_0x53657c(0x13e)}},{'gatewayOrderId':{'contains':_0xb43c44,'mode':_0x53657c(0x13e)}},{'customerEmail':{'contains':_0xb43c44,'mode':_0x53657c(0x13e)}},{'shop':{'name':{'contains':_0xb43c44,'mode':_0x53657c(0x13e)}}},{'shop':{'username':{'contains':_0xb43c44,'mode':'insensitive'}}}]);console[_0x53657c(0x184)](_0x53657c(0x207),JSON[_0x53657c(0x144)](_0x1ccb85,null,0x2));let _0x20f1db={'createdAt':_0x53657c(0x22e)};if(_0x391731){const _0x5e1fc4=[_0x53657c(0x1c3),_0x53657c(0x157),_0x53657c(0x167),_0x53657c(0x19c),_0x53657c(0x1a9),_0x53657c(0x105)],_0x4034ba=[_0x53657c(0x178),_0x53657c(0x22e)];if(_0x5e1fc4['includes'](_0x391731)){const _0x26ab7a=_0x4034ba['includes'](_0x53a899)?_0x53a899:_0x53657c(0x22e);_0x20f1db={[_0x391731]:_0x26ab7a},console[_0x53657c(0x184)](_0x53657c(0x13a)+_0x391731+_0x53657c(0x164)+_0x26ab7a+_0x53657c(0x14f));}}const [_0x16cb03,_0x46664e]=await Promise[_0x53657c(0x22f)]([database_1[_0x53657c(0x201)][_0x53657c(0x200)][_0x53657c(0x116)]({'where':_0x1ccb85,'skip':_0x43e201,'take':_0x2b8107,'orderBy':_0x20f1db,'include':{'shop':{'select':{'name':!![],'username':!![]}}}}),database_1['default']['payment'][_0x53657c(0x1eb)]({'where':_0x1ccb85})]);return{'payments':_0x16cb03,'pagination':{'page':_0x15cc25,'limit':_0x2b8107,'total':_0x46664e,'totalPages':Math[_0x53657c(0x24b)](_0x46664e/_0x2b8107)}};}async[a38_0x46fb30(0x1b8)](_0xc3a9e7){const _0x10d52f=a38_0x46fb30,_0x4a33bb=await database_1['default'][_0x10d52f(0x200)][_0x10d52f(0x244)]({'where':{'id':_0xc3a9e7},'select':{'id':!![],'shopId':!![],'amount':!![],'amountAfterGatewayCommissionUSDT':!![],'currency':!![],'sourceCurrency':!![],'status':!![],'gateway':!![],'orderId':!![],'gatewayOrderId':!![],'gatewayPaymentId':!![],'customerEmail':!![],'customerName':!![],'customerCountry':!![],'customerIp':!![],'customerUa':!![],'externalPaymentUrl':!![],'successUrl':!![],'failUrl':!![],'pendingUrl':!![],'whiteUrl':!![],'expiresAt':!![],'invoiceTotalSum':!![],'qrCode':!![],'qrUrl':!![],'country':!![],'language':!![],'amountIsEditable':!![],'maxPayments':!![],'rapydCustomer':!![],'cardLast4':!![],'paymentMethod':!![],'bankId':!![],'remitterIban':!![],'remitterName':!![],'failureMessage':!![],'usage':!![],'createdAt':!![],'updatedAt':!![],'shop':{'select':{'name':!![],'username':!![]}}}});if(!_0x4a33bb)return null;return{'id':_0x4a33bb['id'],'shopId':_0x4a33bb['shopId'],'gateway':_0x4a33bb[_0x10d52f(0x1a9)],'amount':_0x4a33bb[_0x10d52f(0x1c3)],'currency':_0x4a33bb['currency'],'status':_0x4a33bb['status'],'orderId':_0x4a33bb[_0x10d52f(0x165)],'gatewayOrderId':_0x4a33bb[_0x10d52f(0x1cc)],'customerEmail':_0x4a33bb[_0x10d52f(0x209)],'customerName':_0x4a33bb[_0x10d52f(0x169)],'customerCountry':_0x4a33bb['customerCountry'],'customerIp':_0x4a33bb[_0x10d52f(0x1bc)],'customerUa':_0x4a33bb[_0x10d52f(0x112)],'failureMessage':_0x4a33bb[_0x10d52f(0x12d)],'externalPaymentUrl':_0x4a33bb['externalPaymentUrl'],'successUrl':_0x4a33bb['successUrl'],'failUrl':_0x4a33bb[_0x10d52f(0x12b)],'pendingUrl':_0x4a33bb[_0x10d52f(0x1ac)],'whiteUrl':_0x4a33bb[_0x10d52f(0x145)],'createdAt':_0x4a33bb[_0x10d52f(0x157)],'updatedAt':_0x4a33bb[_0x10d52f(0x167)],'shop':_0x4a33bb[_0x10d52f(0x21a)]};}async[a38_0x46fb30(0x156)](_0x4e3539,_0x4b8aa2,_0x3ad7a4,_0x5ece75){const _0x2149b1=a38_0x46fb30,_0x46e60e=await database_1['default'][_0x2149b1(0x241)](async _0x4cd957=>{const _0x507fe1=_0x2149b1,_0x2d73ad=await _0x4cd957[_0x507fe1(0x200)][_0x507fe1(0x244)]({'where':{'id':_0x4e3539},'include':{'shop':{'select':{'id':!![],'name':!![],'username':!![],'balance':!![]}}}});if(!_0x2d73ad)throw new Error(_0x507fe1(0x148));const _0x41e5dc=_0x2d73ad[_0x507fe1(0x19c)],_0x175d0c=_0x4b8aa2[_0x507fe1(0x20a)]();console[_0x507fe1(0x184)](_0x507fe1(0x10a)+_0x4e3539+_0x507fe1(0x1e6)+_0x41e5dc+_0x507fe1(0x158)+_0x175d0c),console[_0x507fe1(0x184)](_0x507fe1(0x204)+_0x2d73ad[_0x507fe1(0x21a)][_0x507fe1(0x10d)]+_0x507fe1(0x23d));const _0x14af4b={'status':_0x175d0c,'updatedAt':new Date(),'statusChangedBy':_0x507fe1(0x190),'statusChangedAt':new Date()};_0x3ad7a4&&(_0x14af4b[_0x507fe1(0x117)]=_0x3ad7a4);_0x175d0c===_0x507fe1(0x1be)&&_0x5ece75&&(_0x14af4b[_0x507fe1(0x24d)]=_0x5ece75);let _0x1ef33b=0x0,_0x99fce0=_0x2d73ad[_0x507fe1(0x21a)][_0x507fe1(0x10d)];if(_0x175d0c===_0x507fe1(0x1d9)&&_0x41e5dc!==_0x507fe1(0x1d9)){_0x14af4b[_0x507fe1(0x1f3)]=new Date();const _0x3ad0dd=await currencyService_1[_0x507fe1(0x180)][_0x507fe1(0x11e)](_0x2d73ad[_0x507fe1(0x1c3)],_0x2d73ad[_0x507fe1(0x105)]);_0x14af4b[_0x507fe1(0x1a4)]=_0x3ad0dd;let _0x155626=0x2d;const _0x3359b2=await _0x4cd957[_0x507fe1(0x21a)][_0x507fe1(0x244)]({'where':{'id':_0x2d73ad[_0x507fe1(0x14e)]},'select':{'gatewaySettings':!![]}});if(_0x3359b2?.['gatewaySettings'])try{const _0x2a742a=JSON['parse'](_0x3359b2['gatewaySettings']);for(const [_0x1f5f05,_0x58c87c]of Object['entries'](_0x2a742a)){if(_0x1f5f05['toLowerCase']()===_0x2d73ad[_0x507fe1(0x1a9)][_0x507fe1(0x13d)]()){_0x155626=_0x58c87c[_0x507fe1(0x1ed)]||0xa;break;}}}catch(_0x5c5ea9){console['error']('Error\x20parsing\x20gateway\x20settings\x20for\x20payment\x20'+_0x4e3539+':',_0x5c5ea9);}let _0x295928;_0x2d73ad[_0x507fe1(0x162)]!==null&&_0x2d73ad[_0x507fe1(0x162)]!==undefined?(_0x295928=_0x2d73ad[_0x507fe1(0x162)],console[_0x507fe1(0x184)](_0x507fe1(0x111)+_0x295928[_0x507fe1(0x245)](0x6)+_0x507fe1(0x147)+_0x4e3539)):(_0x295928=_0x3ad0dd*(0x1-_0x155626/0x64),console[_0x507fe1(0x184)](_0x507fe1(0x21e)+_0x4e3539+':\x20'+_0x155626+'%\x20from\x20'+_0x3ad0dd['toFixed'](0x6)+_0x507fe1(0x23d)),_0x14af4b[_0x507fe1(0x162)]=_0x295928,_0x14af4b['gatewayCommissionRate']=_0x155626),_0x1ef33b=_0x295928,_0x99fce0+=_0x295928,console['log'](_0x507fe1(0x140)+_0x4e3539+_0x507fe1(0x1a6)),console[_0x507fe1(0x184)]('\x20\x20\x20Full\x20amount:\x20'+_0x3ad0dd[_0x507fe1(0x245)](0x6)+_0x507fe1(0x23d)),console[_0x507fe1(0x184)](_0x507fe1(0x13c)+_0x2d73ad[_0x507fe1(0x1a9)]+_0x507fe1(0x191)+_0x155626+'%'),console[_0x507fe1(0x184)](_0x507fe1(0x1e1)+_0x295928[_0x507fe1(0x245)](0x6)+_0x507fe1(0x251)+_0x155626+'%\x20commission)'),console[_0x507fe1(0x184)](_0x507fe1(0x151)+_0x295928['toFixed'](0x6)+_0x507fe1(0x23d));}else{if(_0x41e5dc==='PAID'&&_0x175d0c!==_0x507fe1(0x1d9)){if(_0x2d73ad[_0x507fe1(0x1a4)]){let _0x5a58ba=0x2d;const _0x42000a=await _0x4cd957[_0x507fe1(0x21a)][_0x507fe1(0x244)]({'where':{'id':_0x2d73ad[_0x507fe1(0x14e)]},'select':{'gatewaySettings':!![]}});if(_0x42000a?.[_0x507fe1(0x218)])try{const _0x3c1139=JSON[_0x507fe1(0x198)](_0x42000a[_0x507fe1(0x218)]);for(const [_0x1439cb,_0x864dd8]of Object['entries'](_0x3c1139)){if(_0x1439cb[_0x507fe1(0x13d)]()===_0x2d73ad[_0x507fe1(0x1a9)]['toLowerCase']()){_0x5a58ba=_0x864dd8['commission']||0xa;break;}}}catch(_0x1fc57f){console[_0x507fe1(0x18b)](_0x507fe1(0x1f0)+_0x4e3539+':',_0x1fc57f);}const _0x25f551=_0x2d73ad['amountUSDT']*(0x1-_0x5a58ba/0x64);_0x1ef33b=-_0x25f551,_0x99fce0-=_0x25f551,_0x14af4b[_0x507fe1(0x1a4)]=null,_0x14af4b[_0x507fe1(0x162)]=null,console[_0x507fe1(0x184)]('💰\x20Payment\x20'+_0x4e3539+_0x507fe1(0x176)),console['log'](_0x507fe1(0x1cb)+_0x2d73ad[_0x507fe1(0x1a4)][_0x507fe1(0x245)](0x6)+_0x507fe1(0x23d)),console[_0x507fe1(0x184)](_0x507fe1(0x13c)+_0x2d73ad[_0x507fe1(0x1a9)]+_0x507fe1(0x191)+_0x5a58ba+'%'),console[_0x507fe1(0x184)](_0x507fe1(0x18f)+_0x25f551['toFixed'](0x6)+_0x507fe1(0x251)+_0x5a58ba+'%\x20commission)'),console[_0x507fe1(0x184)](_0x507fe1(0x1ab)+_0x25f551[_0x507fe1(0x245)](0x6)+_0x507fe1(0x23d));}}}_0x175d0c==='CHARGEBACK'&&(_0x41e5dc===_0x507fe1(0x1d9)&&_0x2d73ad[_0x507fe1(0x1a4)]&&console[_0x507fe1(0x184)](_0x507fe1(0x1c0)),_0x5ece75&&_0x5ece75>0x0&&(_0x1ef33b-=_0x5ece75,_0x99fce0-=_0x5ece75,console[_0x507fe1(0x184)](_0x507fe1(0x14d)+_0x5ece75[_0x507fe1(0x245)](0x6)+'\x20USDT\x20from\x20balance')));_0x175d0c===_0x507fe1(0x1de)&&_0x41e5dc==='PAID'&&console[_0x507fe1(0x184)](_0x507fe1(0x1aa));const _0xc78b66=await _0x4cd957[_0x507fe1(0x200)][_0x507fe1(0x1ca)]({'where':{'id':_0x4e3539},'data':_0x14af4b,'include':{'shop':{'select':{'name':!![],'username':!![]}}}});return _0x1ef33b!==0x0&&(await _0x4cd957[_0x507fe1(0x21a)]['update']({'where':{'id':_0x2d73ad[_0x507fe1(0x14e)]},'data':{'balance':_0x99fce0}}),console['log'](_0x507fe1(0x122)+_0x2d73ad[_0x507fe1(0x14e)]+_0x507fe1(0x126)+_0x2d73ad[_0x507fe1(0x21a)][_0x507fe1(0x10d)][_0x507fe1(0x245)](0x6)+_0x507fe1(0x158)+_0x99fce0[_0x507fe1(0x245)](0x6)+_0x507fe1(0x22c)+(_0x1ef33b>0x0?'+':'')+_0x1ef33b[_0x507fe1(0x245)](0x6)+')')),_0xc78b66;});return{'id':_0x46e60e['id'],'shopId':_0x46e60e[_0x2149b1(0x14e)],'gateway':_0x46e60e[_0x2149b1(0x1a9)],'amount':_0x46e60e[_0x2149b1(0x1c3)],'currency':_0x46e60e['currency'],'status':_0x46e60e[_0x2149b1(0x19c)],'orderId':_0x46e60e[_0x2149b1(0x165)],'gatewayOrderId':_0x46e60e[_0x2149b1(0x1cc)],'customerEmail':_0x46e60e[_0x2149b1(0x209)],'customerName':_0x46e60e[_0x2149b1(0x169)],'customerCountry':_0x46e60e[_0x2149b1(0x11c)],'customerIp':_0x46e60e[_0x2149b1(0x1bc)],'customerUa':_0x46e60e[_0x2149b1(0x112)],'failureMessage':_0x46e60e[_0x2149b1(0x12d)],'adminNotes':_0x46e60e[_0x2149b1(0x117)],'chargebackAmount':_0x46e60e[_0x2149b1(0x24d)],'statusChangedBy':_0x46e60e[_0x2149b1(0x17a)],'statusChangedAt':_0x46e60e[_0x2149b1(0x208)],'createdAt':_0x46e60e[_0x2149b1(0x157)],'updatedAt':_0x46e60e[_0x2149b1(0x167)],'shop':_0x46e60e['shop']};}async[a38_0x46fb30(0x1d2)](_0x557286,_0x419957){const _0xbcab32=a38_0x46fb30,_0x29f428=Math[_0xbcab32(0x137)]()['toString'](0x24)['substr'](0x2,0x9);console['log']('🎯\x20updateUser\x20called\x20with\x20ID:\x20'+_0x29f428+',\x20userId:\x20'+_0x557286);const _0x5bbc62={..._0x419957};_0x419957[_0xbcab32(0x163)]&&_0x419957[_0xbcab32(0x163)]['trim']()!==''?(console[_0xbcab32(0x184)](_0xbcab32(0x129)+_0x29f428+_0xbcab32(0x247)+_0x557286),_0x5bbc62[_0xbcab32(0x163)]=await bcryptjs_1[_0xbcab32(0x201)][_0xbcab32(0x246)](_0x419957[_0xbcab32(0x163)],0xc)):(console[_0xbcab32(0x184)]('🔐\x20['+_0x29f428+']\x20Password\x20not\x20provided\x20or\x20empty,\x20skipping\x20password\x20update'),delete _0x5bbc62[_0xbcab32(0x163)]);_0x419957[_0xbcab32(0x211)]&&(_0x5bbc62[_0xbcab32(0x1a2)]=_0x419957['fullName'],delete _0x5bbc62[_0xbcab32(0x211)]);_0x419957[_0xbcab32(0x1e9)]&&(_0x5bbc62[_0xbcab32(0x1c2)]=_0x419957[_0xbcab32(0x1e9)],delete _0x5bbc62[_0xbcab32(0x1e9)]);_0x419957[_0xbcab32(0x18e)]&&(_0x5bbc62[_0xbcab32(0x106)]=_0x419957[_0xbcab32(0x18e)],delete _0x5bbc62[_0xbcab32(0x18e)]);if(_0x419957[_0xbcab32(0x181)]){const _0x36e867=_0x419957['gateways'][_0xbcab32(0x11f)](_0x2674fc=>this[_0xbcab32(0x15d)](_0x2674fc));console['log'](_0xbcab32(0x1f7),_0x419957[_0xbcab32(0x181)],'->',_0x36e867),_0x5bbc62[_0xbcab32(0x1b7)]=JSON[_0xbcab32(0x144)](_0x36e867),delete _0x5bbc62['gateways'];}_0x419957[_0xbcab32(0x218)]&&(console[_0xbcab32(0x184)]('🔧\x20['+_0x29f428+']\x20Gateway\x20settings\x20before\x20saving:',_0x419957[_0xbcab32(0x218)]),_0x5bbc62[_0xbcab32(0x218)]=JSON[_0xbcab32(0x144)](_0x419957['gatewaySettings']),console[_0xbcab32(0x184)](_0xbcab32(0x196)+_0x29f428+_0xbcab32(0x1b4),_0x5bbc62[_0xbcab32(0x218)]));_0x419957[_0xbcab32(0x138)]&&(_0x419957[_0xbcab32(0x138)][_0xbcab32(0x132)]!==undefined&&(_0x5bbc62['usdtPolygonWallet']=_0x419957[_0xbcab32(0x138)][_0xbcab32(0x132)]||null),_0x419957['wallets'][_0xbcab32(0x12c)]!==undefined&&(_0x5bbc62['usdtTrcWallet']=_0x419957['wallets'][_0xbcab32(0x12c)]||null),_0x419957[_0xbcab32(0x138)]['usdtErcWallet']!==undefined&&(_0x5bbc62['usdtErcWallet']=_0x419957[_0xbcab32(0x138)][_0xbcab32(0x223)]||null),_0x419957['wallets'][_0xbcab32(0x118)]!==undefined&&(_0x5bbc62[_0xbcab32(0x118)]=_0x419957[_0xbcab32(0x138)][_0xbcab32(0x118)]||null),delete _0x5bbc62['wallets']);const _0x3bee07=await database_1['default'][_0xbcab32(0x21a)][_0xbcab32(0x1ca)]({'where':{'id':_0x557286},'data':_0x5bbc62,'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});return console[_0xbcab32(0x184)](_0xbcab32(0x14c)+_0x29f428+_0xbcab32(0x11d),_0x3bee07[_0xbcab32(0x218)]),{'id':_0x3bee07['id'],'fullName':_0x3bee07['name'],'username':_0x3bee07['username'],'telegramId':_0x3bee07[_0xbcab32(0x1c2)],'merchantUrl':_0x3bee07[_0xbcab32(0x106)],'gateways':_0x3bee07[_0xbcab32(0x1b7)]?JSON[_0xbcab32(0x198)](_0x3bee07[_0xbcab32(0x1b7)]):null,'gatewaySettings':_0x3bee07[_0xbcab32(0x218)]?JSON[_0xbcab32(0x198)](_0x3bee07[_0xbcab32(0x218)]):null,'publicKey':_0x3bee07[_0xbcab32(0x16b)],'wallets':{'usdtPolygonWallet':_0x3bee07[_0xbcab32(0x132)],'usdtTrcWallet':_0x3bee07['usdtTrcWallet'],'usdtErcWallet':_0x3bee07[_0xbcab32(0x223)],'usdcPolygonWallet':_0x3bee07[_0xbcab32(0x118)]},'status':_0x3bee07['status'],'createdAt':_0x3bee07[_0xbcab32(0x157)]};}async[a38_0x46fb30(0x1f5)](_0x2d6814){const _0x29f60f=a38_0x46fb30,_0xed6953=await database_1[_0x29f60f(0x201)][_0x29f60f(0x21a)]['update']({'where':{'id':_0x2d6814},'data':{'status':_0x29f60f(0x20e)},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});return{'id':_0xed6953['id'],'fullName':_0xed6953[_0x29f60f(0x1a2)],'username':_0xed6953[_0x29f60f(0x160)],'telegramId':_0xed6953[_0x29f60f(0x1c2)],'merchantUrl':_0xed6953[_0x29f60f(0x106)],'gateways':_0xed6953[_0x29f60f(0x1b7)]?JSON[_0x29f60f(0x198)](_0xed6953['paymentGateways']):null,'gatewaySettings':_0xed6953['gatewaySettings']?JSON[_0x29f60f(0x198)](_0xed6953[_0x29f60f(0x218)]):null,'publicKey':_0xed6953[_0x29f60f(0x16b)],'wallets':{'usdtPolygonWallet':_0xed6953['usdtPolygonWallet'],'usdtTrcWallet':_0xed6953[_0x29f60f(0x12c)],'usdtErcWallet':_0xed6953['usdtErcWallet'],'usdcPolygonWallet':_0xed6953[_0x29f60f(0x118)]},'status':_0xed6953[_0x29f60f(0x19c)],'createdAt':_0xed6953[_0x29f60f(0x157)]};}async[a38_0x46fb30(0x1c8)](_0xec8053){const _0x1b4f72=a38_0x46fb30,_0x3a5de1=await database_1['default']['shop']['update']({'where':{'id':_0xec8053},'data':{'status':_0x1b4f72(0x1b3)},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});return{'id':_0x3a5de1['id'],'fullName':_0x3a5de1[_0x1b4f72(0x1a2)],'username':_0x3a5de1['username'],'telegramId':_0x3a5de1[_0x1b4f72(0x1c2)],'merchantUrl':_0x3a5de1[_0x1b4f72(0x106)],'gateways':_0x3a5de1[_0x1b4f72(0x1b7)]?JSON[_0x1b4f72(0x198)](_0x3a5de1[_0x1b4f72(0x1b7)]):null,'gatewaySettings':_0x3a5de1['gatewaySettings']?JSON[_0x1b4f72(0x198)](_0x3a5de1[_0x1b4f72(0x218)]):null,'publicKey':_0x3a5de1[_0x1b4f72(0x16b)],'wallets':{'usdtPolygonWallet':_0x3a5de1[_0x1b4f72(0x132)],'usdtTrcWallet':_0x3a5de1[_0x1b4f72(0x12c)],'usdtErcWallet':_0x3a5de1['usdtErcWallet'],'usdcPolygonWallet':_0x3a5de1['usdcPolygonWallet']},'status':_0x3a5de1[_0x1b4f72(0x19c)],'createdAt':_0x3a5de1['createdAt']};}async['getAllUsers'](_0x48805f){const _0x51b986=a38_0x46fb30,{page:_0x203098,limit:_0x18e166,status:_0x53e349}=_0x48805f,_0x4d37cd=(_0x203098-0x1)*_0x18e166,_0x710391={};_0x53e349&&(_0x710391['status']=_0x53e349[_0x51b986(0x20a)]());const [_0x3f9df8,_0x8c7212]=await Promise[_0x51b986(0x22f)]([database_1[_0x51b986(0x201)][_0x51b986(0x21a)]['findMany']({'where':_0x710391,'skip':_0x4d37cd,'take':_0x18e166,'orderBy':{'createdAt':'desc'},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}}),database_1[_0x51b986(0x201)][_0x51b986(0x21a)][_0x51b986(0x1eb)]({'where':_0x710391})]);return{'users':_0x3f9df8[_0x51b986(0x11f)](_0x526397=>{const _0x10fc60=_0x51b986,_0x1f625a=_0x526397[_0x10fc60(0x1b7)]?JSON['parse'](_0x526397[_0x10fc60(0x1b7)]):null,_0x2e5846=_0x1f625a?_0x1f625a[_0x10fc60(0x11f)](_0x42e2a7=>this[_0x10fc60(0x21d)](_0x42e2a7)):null;return{'id':_0x526397['id'],'fullName':_0x526397[_0x10fc60(0x1a2)],'username':_0x526397[_0x10fc60(0x160)],'telegramId':_0x526397['telegram'],'merchantUrl':_0x526397[_0x10fc60(0x106)],'gateways':_0x2e5846,'gatewaySettings':_0x526397[_0x10fc60(0x218)]?JSON['parse'](_0x526397['gatewaySettings']):null,'publicKey':_0x526397['publicKey'],'wallets':{'usdtPolygonWallet':_0x526397[_0x10fc60(0x132)],'usdtTrcWallet':_0x526397[_0x10fc60(0x12c)],'usdtErcWallet':_0x526397['usdtErcWallet'],'usdcPolygonWallet':_0x526397[_0x10fc60(0x118)]},'status':_0x526397[_0x10fc60(0x19c)],'createdAt':_0x526397[_0x10fc60(0x157)]};}),'pagination':{'page':_0x203098,'limit':_0x18e166,'total':_0x8c7212,'totalPages':Math[_0x51b986(0x24b)](_0x8c7212/_0x18e166)}};}async['getUserById'](_0x226785){const _0x1c0d56=a38_0x46fb30,_0xeb1e2f=await database_1[_0x1c0d56(0x201)][_0x1c0d56(0x21a)][_0x1c0d56(0x244)]({'where':{'id':_0x226785},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});if(!_0xeb1e2f)return null;const _0x52f85e=_0xeb1e2f[_0x1c0d56(0x1b7)]?JSON[_0x1c0d56(0x198)](_0xeb1e2f[_0x1c0d56(0x1b7)]):null,_0x286dd8=_0x52f85e?_0x52f85e[_0x1c0d56(0x11f)](_0x54e70a=>this[_0x1c0d56(0x21d)](_0x54e70a)):null;return _0x52f85e&&_0x286dd8&&console['log'](_0x1c0d56(0x240),_0x52f85e,'->',_0x286dd8),{'id':_0xeb1e2f['id'],'fullName':_0xeb1e2f[_0x1c0d56(0x1a2)],'username':_0xeb1e2f[_0x1c0d56(0x160)],'telegramId':_0xeb1e2f['telegram'],'merchantUrl':_0xeb1e2f['shopUrl'],'gateways':_0x286dd8,'gatewaySettings':_0xeb1e2f[_0x1c0d56(0x218)]?JSON[_0x1c0d56(0x198)](_0xeb1e2f[_0x1c0d56(0x218)]):null,'publicKey':_0xeb1e2f['publicKey'],'wallets':{'usdtPolygonWallet':_0xeb1e2f[_0x1c0d56(0x132)],'usdtTrcWallet':_0xeb1e2f['usdtTrcWallet'],'usdtErcWallet':_0xeb1e2f[_0x1c0d56(0x223)],'usdcPolygonWallet':_0xeb1e2f['usdcPolygonWallet']},'status':_0xeb1e2f[_0x1c0d56(0x19c)],'createdAt':_0xeb1e2f[_0x1c0d56(0x157)]};}async[a38_0x46fb30(0x193)](_0x3d2f37){const _0x2daf5b=a38_0x46fb30,{fullName:_0x53aa32,username:_0x153e6a,password:_0x56094e,telegramId:_0xb65670,merchantUrl:_0x12c783,gateways:_0x344ac2,gatewaySettings:_0x1215f3,wallets:_0x2784ef}=_0x3d2f37,_0x37e445=await database_1[_0x2daf5b(0x201)][_0x2daf5b(0x21a)][_0x2daf5b(0x244)]({'where':{'username':_0x153e6a}});if(_0x37e445)throw new Error(_0x2daf5b(0x114));if(_0xb65670){const _0x493f9a=await database_1[_0x2daf5b(0x201)][_0x2daf5b(0x21a)][_0x2daf5b(0x244)]({'where':{'telegram':_0xb65670}});if(_0x493f9a)throw new Error(_0x2daf5b(0x1e5));}const _0x4389b6=await bcryptjs_1[_0x2daf5b(0x201)][_0x2daf5b(0x246)](_0x56094e,0xc),_0x25279c=_0x2daf5b(0x250)+crypto_1['default'][_0x2daf5b(0x1d6)](0x20)['toString'](_0x2daf5b(0x1f6)),_0x39be5c=_0x2daf5b(0x1b1)+crypto_1['default'][_0x2daf5b(0x1d6)](0x20)[_0x2daf5b(0x1df)](_0x2daf5b(0x1f6)),_0x4139f1=_0x344ac2?_0x344ac2[_0x2daf5b(0x11f)](_0x4b3aae=>this[_0x2daf5b(0x15d)](_0x4b3aae)):null;_0x344ac2&&_0x4139f1&&console[_0x2daf5b(0x184)](_0x2daf5b(0x1ef),_0x344ac2,'->',_0x4139f1);const _0xf9440d=await database_1[_0x2daf5b(0x201)]['shop'][_0x2daf5b(0x197)]({'data':{'name':_0x53aa32,'username':_0x153e6a,'password':_0x4389b6,'telegram':_0xb65670,'shopUrl':_0x12c783,'paymentGateways':_0x4139f1?JSON['stringify'](_0x4139f1):null,'gatewaySettings':_0x1215f3?JSON[_0x2daf5b(0x144)](_0x1215f3):null,'usdtPolygonWallet':_0x2784ef?.[_0x2daf5b(0x132)]||null,'usdtTrcWallet':_0x2784ef?.['usdtTrcWallet']||null,'usdtErcWallet':_0x2784ef?.[_0x2daf5b(0x223)]||null,'usdcPolygonWallet':_0x2784ef?.[_0x2daf5b(0x118)]||null,'publicKey':_0x25279c,'secretKey':_0x39be5c,'status':_0x2daf5b(0x1b3)},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});return{'id':_0xf9440d['id'],'fullName':_0xf9440d[_0x2daf5b(0x1a2)],'username':_0xf9440d[_0x2daf5b(0x160)],'telegramId':_0xf9440d['telegram'],'merchantUrl':_0xf9440d['shopUrl'],'gateways':_0xf9440d['paymentGateways']?JSON['parse'](_0xf9440d['paymentGateways']):null,'gatewaySettings':_0xf9440d[_0x2daf5b(0x218)]?JSON[_0x2daf5b(0x198)](_0xf9440d['gatewaySettings']):null,'publicKey':_0xf9440d[_0x2daf5b(0x16b)],'wallets':{'usdtPolygonWallet':_0xf9440d[_0x2daf5b(0x132)],'usdtTrcWallet':_0xf9440d[_0x2daf5b(0x12c)],'usdtErcWallet':_0xf9440d[_0x2daf5b(0x223)],'usdcPolygonWallet':_0xf9440d[_0x2daf5b(0x118)]},'status':_0xf9440d[_0x2daf5b(0x19c)],'createdAt':_0xf9440d[_0x2daf5b(0x157)]};}async['deleteUser'](_0x5aa4ba){const _0x1ae2cf=a38_0x46fb30;await database_1[_0x1ae2cf(0x201)][_0x1ae2cf(0x21a)][_0x1ae2cf(0x188)]({'where':{'id':_0x5aa4ba}});}['generateDailyStatistics'](_0x177eed,_0x47a99f,_0xf81dab){const _0x39d512=a38_0x46fb30,_0x231454=new Map(),_0x47c893=new Date(_0x47a99f);while(_0x47c893<=_0xf81dab){const _0x32b3f0=_0x47c893[_0x39d512(0x18c)]()['split']('T')[0x0];_0x231454[_0x39d512(0x24c)](_0x32b3f0,{'revenue':0x0,'count':0x0}),_0x47c893[_0x39d512(0x210)](_0x47c893[_0x39d512(0x130)]()+0x1);}for(const _0xdb4348 of _0x177eed){const _0x372169=_0xdb4348[_0x39d512(0x157)]['toISOString']()['split']('T')[0x0],_0x3c550d=_0x231454['get'](_0x372169);_0x3c550d&&(_0x3c550d[_0x39d512(0x1eb)]+=0x1,_0xdb4348[_0x39d512(0x19c)]==='PAID'&&(_0xdb4348['amountUSDT']?_0x3c550d['revenue']+=_0xdb4348['amountUSDT']:console[_0x39d512(0x184)](_0x39d512(0x103)+_0xdb4348['id']+_0x39d512(0x23b))));}const _0x457016=[],_0x3d613b=[];for(const [_0x1c2c76,_0x2f16a]of _0x231454){_0x457016['push']({'date':_0x1c2c76,'amount':Math[_0x39d512(0x206)](_0x2f16a[_0x39d512(0x1d3)]*0x64)/0x64}),_0x3d613b[_0x39d512(0x177)]({'date':_0x1c2c76,'count':_0x2f16a[_0x39d512(0x1eb)]});}return{'dailyRevenue':_0x457016,'dailyPayments':_0x3d613b};}}function a38_0x3239(){const _0xe61b93=['customerCountry',']\x20User\x20updated,\x20gatewaySettings\x20from\x20DB:','convertToUSDT','map','\x20paid\x20payments\x20for\x20analysis','test_gateway','💰\x20Shop\x20','📊\x20Total\x20payments\x20(including\x20failed):\x20','groupBy','\x27\x20(from\x20\x27','\x20balance\x20updated:\x20','length','📊\x20Payout\x20statistics\x20calculated:','🔐\x20[','erc20_usdc','failUrl','usdtTrcWallet','failureMessage','📊\x20Using\x20saved\x20commission\x20rate\x20for\x20payment\x20','💰\x20Found\x20','getDate','totalAmountUSDT','usdtPolygonWallet','commissionUSDT','forEach','90d','erc20','random','wallets','getAllPayouts','📊\x20Sorting\x20payments\x20by\x20','56ucpJRl','\x20\x20\x20Gateway:\x20','toLowerCase','insensitive','periodTo','💰\x20Payment\x20','getMerchantsAwaitingPayout','💰\x20Creating\x20payout\x20for\x20shop\x20','findFirst','stringify','whiteUrl','Error\x20parsing\x20gateway\x20settings\x20for\x20shop\x20','\x20USDT\x20for\x20payment\x20','Payment\x20not\x20found','\x20\x20\x20👤\x20Merchant\x20earnings:\x20','Test\x20Gateway','3161896ajRiXQ','🎯\x20[','💸\x20CHARGEBACK\x20penalty:\x20-','shopId','\x20order','\x20to\x20','\x20\x20\x20Added\x20to\x20balance:\x20+','deletePayout','plisio','📋\x20Getting\x20merchants\x20selection\x20list...','\x20for\x20shop\x20','updatePaymentStatus','createdAt','\x20->\x20','\x27\x20not\x20found.\x20Available\x20gateways:\x20','📊\x20Gateway\x20filter\x20applied:','notes','trc20','getGatewayInternalName','KLYME\x20DE','\x20USDT\x20(actual\x20balances)','username','noda','amountAfterGatewayCommissionUSDT','password','\x20in\x20','orderId','\x20USDT,\x20merchant:\x20','updatedAt','period','customerName','getMerchantStatistics','publicKey','defineProperty','📊\x20Using\x20saved\x20values\x20for\x20payment\x20','15138xvDlED','averageCommissionRate','\x20\x20\x20Balance:\x20','totalAmountAfterCommissionUSDT','1439907tGQeci','getTime','../types/gateway','KLYME\x20EU','\x20no\x20longer\x20PAID:','push','asc','getMonth','statusChangedBy','merchantEarningsUSDT','\x20\x20\x20💸\x20Total\x20payouts\x20(all\x20time):\x20','\x20\x20\x20🔍\x20Calculated\x20after\x20commission:\x20','\x20has\x20zero\x20or\x20null\x20amountUSDT,\x20skipping...','mastercard','currencyService','gateways','./currencyService','not\x20set','log','\x27\x20->\x20ID\x20\x27','\x20\x20\x20🤔\x20Difference:\x20','\x20USDT)','delete','\x20merchants\x20with\x20positive\x20balance','totalPayments','error','toISOString','💰\x20[PAYOUT]\x20Merchant\x20','merchantUrl','\x20\x20\x20Merchant\x20loses:\x20','admin',',\x20Commission:\x20','\x20balance\x20updated:','createUser','✅\x20Customer\x20data\x20updated\x20for\x20payment\x20','generateDailyStatistics','🔧\x20[','create','parse','\x20USDT\x20(already\x20paid\x20out)','totalCommissionRate','📅\x20Period:\x20','status','usdcErcWallet','\x20\x20\x20�\x20Total\x20payments\x20turnover:\x20','Open\x20Banking\x202','paymentsCount','month','name','gatewayEarnings','amountUSDT','💰\x20[PAYOUT]\x20Gateway\x20','\x20became\x20PAID:','averageCheckUSDT','\x20\x20\x20💸\x20Total\x20payouts:\x20','gateway','🔄\x20REFUND:\x20Payment\x20amount\x20already\x20deducted\x20from\x20balance','\x20\x20\x20Subtracted\x20from\x20balance:\x20-','pendingUrl','split','aggregate','\x20USDT\x20(same\x20as\x20awaiting)','\x20active\x20merchants\x20for\x20selection','sk_','\x20\x20\x20Current\x20balance:\x20','ACTIVE',']\x20Gateway\x20settings\x20JSON\x20string:','PENDING','rapyd','paymentGateways','getPaymentById','785841ogmqGN','💱\x20Currency\x20filter\x20applied:\x20','reduce','customerIp','dateTo','CHARGEBACK','join','💸\x20CHARGEBACK:\x20Merchant\x20amount\x20already\x20deducted\x20from\x20balance','gte','telegram','amount','Plisio','entries','\x20\x20\x20💵\x20Available\x20balance:\x20','klyme_eu','activateUser','txid','update','\x20\x20\x20Full\x20amount:\x20','gatewayOrderId','✅\x20Payout\x20created:\x20',':\x20commission\x20=\x20','_count','../config/database','\x20\x20\x20�\x20Total\x20paid\x20out:\x20','updateUser','revenue','Error\x20processing\x20payment\x20','NONEXISTENT_GATEWAY_FILTER','randomBytes','createPayout','dailyRevenue','PAID','2217gwZdTO','KLYME\x20GB','__importDefault','merchantEarnings','REFUND','toString','week','\x20\x20\x20Merchant\x20gets:\x20','\x27)\x20not\x20found\x20in\x20database,\x20returning\x20empty\x20result','\x27\x20->\x20name\x20\x27','📊\x20Merchant\x20statistics\x20calculated:','Telegram\x20username\x20already\x20exists','\x20status:\x20','\x20\x20\x20Transaction\x20hash:\x20','49138991UlpYFL','telegramId','\x20PAID\x20payments','count','\x20\x20\x20💳\x20Total\x20payments:\x20','commission','30d','🔄\x20Gateway\x20mapping\x20(create):','Error\x20parsing\x20gateway\x20settings\x20for\x20payment\x20','\x20\x20\x20💰\x20Total\x20payments\x20turnover:\x20','getSystemStatistics','paidAt','266niWgUP','suspendUser','hex','🔄\x20Gateway\x20mapping:','🔄\x20Converted\x20gateway\x20name\x20\x27','🔄\x20Updating\x20customer\x20data\x20for\x20payment\x20','_sum','\x20\x20\x20⏳\x20Pending\x20payout:\x20','not\x20specified','\x20USDT\x20(sum\x20of\x20all\x20merchant\x20balances)','8908722CfordQ','🔄\x20Converted\x20gateway\x20ID\x20\x27','payment','default','%\x20from\x20','\x20USDT\x20(calculated\x20-\x20payouts\x20-\x20balance)','💰\x20Current\x20shop\x20balance:\x20','📊\x20Calculated\x20commission\x20rate\x20for\x20payment\x20','round','📊\x20Final\x20WHERE\x20conditions:','statusChangedAt','customerEmail','toUpperCase','paidOutUSDT','year','10ZIWXRv','SUSPENDED','✅\x20Using\x20gateway\x20filter:\x20\x27','setDate','fullName','\x20merchants','AdminService','3005dTCNOH','thisMonth','\x20\x20\x20Current\x20total\x20paid\x20out:\x20','getFullYear','gatewaySettings','turnover','shop','klyme_gb','values','getGatewayDisplayName','📊\x20[ADMIN]\x20Calculating\x20commission\x20manually\x20for\x20payment\x20','\x20\x20\x20�📊\x20Total\x20payments:\x20','\x20\x20\x20✅\x20Total\x20available\x20for\x20payout:\x20','custom','getPayoutById','usdtErcWallet','📊\x20Merchants\x20awaiting\x20payout:\x20','periodFrom','\x20\x20\x20Payout\x20amount:\x20','getPayoutStats','\x20\x20\x20🖥️\x20User\x20Agent:\x20','yesterday','totalPaidOut','awaitingPayout','\x20USDT\x20(','sort','desc','all','\x20\x20\x20Total\x20paid\x20out:\x20','payout','📊\x20Getting\x20payments\x20with\x20filters:','date','\x20payments)','network','setHours','__esModule','cointopay2','\x27\x20as\x20is\x20(not\x20found\x20in\x20mappings)','\x20\x20\x20💰\x20Total\x20turnover:\x20','\x20missing\x20amountUSDT,\x20using\x20fallback\x20conversion','2020-01-01','\x20USDT','Insufficient\x20balance.\x20Available:\x20','turnoverUSDT','🔄\x20Gateway\x20mapping\x20(get):','$transaction','📊\x20Available\x20gateways\x20in\x20database:','📋\x20Found\x20','findUnique','toFixed','hash',']\x20Updating\x20password\x20for\x20user\x20','gatewayCommissionRate','totalPayout','getGatewayNameById','ceil','set','chargebackAmount','warn','COMPLETED','pk_','\x20USDT\x20(after\x20','crypto','⚠️\x20Payment\x20','📊\x20Calculating\x20commission\x20manually\x20for\x20payment\x20','currency','shopUrl','\x20\x20\x20⏳\x20Awaiting\x20payout:\x20','getGatewayIdByName','\x20\x20\x20✅\x20Actual\x20available\x20balance:\x20','🔄\x20Admin\x20updating\x20payment\x20','\x20USDT,\x20Requested:\x20','lte','balance','dateFrom','availableBalance','\x20\x20\x20📅\x20This\x20month:\x20','📊\x20[ADMIN]\x20Using\x20saved\x20amountAfterGatewayCommissionUSDT:\x20','customerUa','\x20USDT\x20(gross\x20revenue)','Username\x20already\x20exists','\x20\x20\x20🏪\x20Gateway\x20earnings:\x20','findMany','adminNotes','usdcPolygonWallet','\x20\x20\x20🌐\x20IP:\x20','\x20USDT\x20(theoretical\x20net)','CoinToPay'];a38_0x3239=function(){return _0xe61b93;};return a38_0x3239();}exports[a38_0x46fb30(0x213)]=AdminService;