'use strict';function a35_0xd54c(){const _0xde0e9e=['usdtPolygonWallet','toUpperCase','merchantPaid','\x20\x20\x20‚è≥\x20Awaiting\x20payout:\x20','shopUrl','string','username','randomBytes','log','wallets','getTime','currencyService','932CvfGsk','updateUser','telegramId','\x20->\x20','totalAmountAfterCommissionUSDT','\x20merchants,\x20','publicKey','customerName','count','\x20\x20\x20üñ•Ô∏è\x20User\x20Agent:\x20','\x20paid\x20payments\x20for\x20analysis','custom','usdtTrcWallet','period','insensitive','üìä\x20Getting\x20merchant\x20statistics\x20with\x20filters:','Error\x20parsing\x20gateway\x20settings\x20for\x20shop\x20','stringify','CHARGEBACK','amountAfterCommissionUSDT','crypto','payment','customerUa','Username\x20already\x20exists','default','commission','update','dateFrom','\x20USDT\x20(paid\x20to\x20merchants)','Error\x20processing\x20payment\x20','amountUSDT','map','status','convertToUSDT','fullName','üìä\x20Merchant\x20statistics\x20calculated:','ACTIVE','commissionUSDT','failUrl','reduce','paidOutUSDT','üìä\x20Getting\x20merchants\x20awaiting\x20payout\x20with\x20filters:','telegram','lte','455TeOpst','5392885xegZtp','üîÑ\x20Updating\x20customer\x20data\x20for\x20payment\x20','gatewaySettings','customerEmail','toISOString','txid','month','amount','gte','getFullYear','totalPayments','findUnique','slice','Payment\x20not\x20found','\x20\x20\x20üíµ\x20Available\x20balance:\x20','COMPLETED','turnover','date','KLYME\x20GB','gateway','90d','../config/database','getMonth','hash','oldestPaymentDate','shopId','createdAt','createPayout','chargebackAmount','getGatewayDisplayName','averageCheckUSDT','failureMessage','toFixed','paymentGateways','test_gateway','split','bcryptjs','activateUser','Rapyd','parse','forEach','PAID','merchantEarningsUSDT','round','findMany','turnoverUSDT','\x20USDT\x20total','toLowerCase','\x20for\x20shop\x20','merchantUrl','currency','totalTurnover','gatewayOrderId','\x20USDT\x20(pending\x20payout)','whiteUrl','getMerchantStatistics','network','merchantEarnings','orderId','statusChangedBy','externalPaymentUrl','üìÖ\x20Period:\x20','error','paymentsCount','\x20USDT\x20(before\x20commission)','deleteUser','totalCommissionRate','pk_','sort','getAllPayments','totalPayout','AdminService','gatewayEarnings','‚úÖ\x20Payout\x20created:\x20','58025jkYCVZ','Shop\x20not\x20found','3cgiewX','updatedAt','usdtErcWallet','customerIp','customerCountry','usdcPolygonWallet','6wHinOh','Telegram\x20username\x20already\x20exists','4959240MACrFf','desc','payout','year','name','‚è≥\x20Payment\x20','gateways','sk_','üìä\x20Calculating\x20payout\x20statistics...','awaitingPayout','getAllUsers','Test\x20Gateway','updatePaymentStatus','\x20payments\x20awaiting\x20payout','pendingUrl','toString','Noda','30d','password','./currencyService','gatewayBreakdown','not\x20set','values','ceil','SUSPENDED','KLYME\x20DE','187194dldLXH','8UXwtKs','averageCommissionRate','\x20USDT','localeCompare','2020-01-01','__importDefault','adminNotes','üìä\x20Merchants\x20awaiting\x20payout:\x20','notes','shop','üí∞\x20Found\x20','\x20\x20\x20üí∞\x20Total\x20turnover:\x20','length','99882WiMEla','periodFrom','348nQVIYq','dateTo','all','paidAt','1883583Vonjlw','\x20paid\x20payments','getPaymentById','periodTo','createUser','\x20\x20\x20üë§\x20Merchant\x20earnings:\x20','availableBalance','defineProperty','week','totalAmountUSDT','filter','\x20\x20\x20üí∞\x20Total\x20payout:\x20','getPayoutStats','\x20\x20\x20üìÖ\x20This\x20month:\x20','deletePayout','__esModule','\x20USDT\x20(paid\x20out)','‚úÖ\x20Payment\x20','\x20to\x20','hex','\x20USDT)','updateCustomerData','includes'];a35_0xd54c=function(){return _0xde0e9e;};return a35_0xd54c();}const a35_0x1a4240=a35_0x4734;(function(_0xb19ac6,_0x572312){const _0x2fdb38=a35_0x4734,_0x3203b1=_0xb19ac6();while(!![]){try{const _0x29c25a=parseInt(_0x2fdb38(0x280))/0x1*(parseInt(_0x2fdb38(0x1d0))/0x2)+-parseInt(_0x2fdb38(0x286))/0x3*(-parseInt(_0x2fdb38(0x207))/0x4)+-parseInt(_0x2fdb38(0x234))/0x5+parseInt(_0x2fdb38(0x1de))/0x6*(parseInt(_0x2fdb38(0x233))/0x7)+parseInt(_0x2fdb38(0x1d1))/0x8*(-parseInt(_0x2fdb38(0x1e4))/0x9)+parseInt(_0x2fdb38(0x288))/0xa+-parseInt(_0x2fdb38(0x27e))/0xb*(-parseInt(_0x2fdb38(0x1e0))/0xc);if(_0x29c25a===_0x572312)break;else _0x3203b1['push'](_0x3203b1['shift']());}catch(_0x28456d){_0x3203b1['push'](_0x3203b1['shift']());}}}(a35_0xd54c,0xb0d7b));var __importDefault=this&&this[a35_0x1a4240(0x1d6)]||function(_0x706342){return _0x706342&&_0x706342['__esModule']?_0x706342:{'default':_0x706342};};Object[a35_0x1a4240(0x1eb)](exports,a35_0x1a4240(0x1f3),{'value':!![]}),exports[a35_0x1a4240(0x27b)]=void 0x0;const database_1=__importDefault(require(a35_0x1a4240(0x249))),bcryptjs_1=__importDefault(require(a35_0x1a4240(0x258))),crypto_1=__importDefault(require(a35_0x1a4240(0x21b))),currencyService_1=require(a35_0x1a4240(0x29b));class AdminService{async[a35_0x1a4240(0x1f0)](){const _0x551517=a35_0x1a4240;console[_0x551517(0x203)](_0x551517(0x290));const _0x35b3b9=await database_1[_0x551517(0x21f)][_0x551517(0x21c)][_0x551517(0x260)]({'where':{'status':_0x551517(0x25d),'paidAt':{'not':null}},'select':{'id':!![],'shopId':!![],'amount':!![],'currency':!![],'merchantPaid':!![],'paidAt':!![],'createdAt':!![],'shop':{'select':{'id':!![],'name':!![],'username':!![],'gatewaySettings':!![]}}}});console['log'](_0x551517(0x1db)+_0x35b3b9[_0x551517(0x1dd)]+_0x551517(0x1e5));let _0x48ffaf=0x0,_0x6cfbea=0x0,_0x3c23ee=0x0;for(const _0x2e94fc of _0x35b3b9){try{const _0xc2ee0a=await currencyService_1[_0x551517(0x206)]['convertToUSDT'](_0x2e94fc[_0x551517(0x23b)],_0x2e94fc['currency']);let _0x2e18f1={};if(_0x2e94fc[_0x551517(0x1da)][_0x551517(0x236)])try{_0x2e18f1=JSON['parse'](_0x2e94fc[_0x551517(0x1da)][_0x551517(0x236)]);}catch(_0x3f96a9){console[_0x551517(0x272)](_0x551517(0x217)+_0x2e94fc[_0x551517(0x24d)]+':',_0x3f96a9);}const _0x199a53=_0x2e18f1[_0x551517(0x220)]||0xa,_0x382cd3=_0xc2ee0a*(0x1-_0x199a53/0x64);_0x2e94fc[_0x551517(0x1fd)]?(_0x48ffaf+=_0x382cd3,console['log'](_0x551517(0x1f5)+_0x2e94fc['id']+':\x20'+_0x382cd3[_0x551517(0x254)](0x2)+_0x551517(0x1f4))):(_0x6cfbea+=_0x382cd3,_0x3c23ee+=_0xc2ee0a,console[_0x551517(0x203)](_0x551517(0x28d)+_0x2e94fc['id']+':\x20'+_0x382cd3[_0x551517(0x254)](0x2)+_0x551517(0x269)));}catch(_0x378f65){console[_0x551517(0x272)]('Error\x20processing\x20payment\x20'+_0x2e94fc['id']+':',_0x378f65);}}const _0x13e7fb=new Date(),_0x18d9ef=new Date(_0x13e7fb[_0x551517(0x23d)](),_0x13e7fb['getMonth'](),0x1),_0x5a4446=new Date(_0x13e7fb[_0x551517(0x23d)](),_0x13e7fb[_0x551517(0x24a)]()+0x1,0x0,0x17,0x3b,0x3b,0x3e7),_0x3662f4=await database_1['default']['payout'][_0x551517(0x260)]({'where':{'createdAt':{'gte':_0x18d9ef,'lte':_0x5a4446},'status':_0x551517(0x243)},'select':{'amount':!![]}}),_0x28ce6a=_0x3662f4[_0x551517(0x22e)]((_0x32db37,_0x1c490f)=>_0x32db37+_0x1c490f[_0x551517(0x23b)],0x0),_0x5ef4c7={'totalPayout':Math['round'](_0x48ffaf*0x64)/0x64,'awaitingPayout':Math[_0x551517(0x25f)](_0x6cfbea*0x64)/0x64,'thisMonth':Math[_0x551517(0x25f)](_0x28ce6a*0x64)/0x64,'availableBalance':Math[_0x551517(0x25f)](_0x3c23ee*0x64)/0x64};return console['log']('üìä\x20Payout\x20statistics\x20calculated:'),console[_0x551517(0x203)](_0x551517(0x1ef)+_0x5ef4c7[_0x551517(0x27a)]+_0x551517(0x223)),console[_0x551517(0x203)](_0x551517(0x1fe)+_0x5ef4c7[_0x551517(0x291)]+'\x20USDT\x20(after\x20commission)'),console[_0x551517(0x203)](_0x551517(0x242)+_0x5ef4c7[_0x551517(0x1ea)]+_0x551517(0x274)),console[_0x551517(0x203)](_0x551517(0x1f1)+_0x5ef4c7['thisMonth']+_0x551517(0x1d3)),_0x5ef4c7;}async[a35_0x1a4240(0x1f9)](_0x31be40,_0x8e7cd2){const _0x5e6329=a35_0x1a4240;console[_0x5e6329(0x203)](_0x5e6329(0x235)+_0x31be40+':',_0x8e7cd2);const _0x43eb65=await database_1[_0x5e6329(0x21f)][_0x5e6329(0x21c)][_0x5e6329(0x23f)]({'where':{'id':_0x31be40},'select':{'id':!![],'customerEmail':!![],'customerName':!![],'customerCountry':!![],'customerIp':!![],'customerUa':!![]}});if(!_0x43eb65)throw new Error(_0x5e6329(0x241));const _0x3b5ccc={};_0x8e7cd2[_0x5e6329(0x284)]!==undefined&&(_0x3b5ccc['customerCountry']=_0x8e7cd2[_0x5e6329(0x284)]||null);_0x8e7cd2[_0x5e6329(0x283)]!==undefined&&(_0x3b5ccc[_0x5e6329(0x283)]=_0x8e7cd2[_0x5e6329(0x283)]||null);_0x8e7cd2[_0x5e6329(0x21d)]!==undefined&&(_0x3b5ccc['customerUa']=_0x8e7cd2[_0x5e6329(0x21d)]||null);const _0x941d62=await database_1[_0x5e6329(0x21f)][_0x5e6329(0x21c)][_0x5e6329(0x221)]({'where':{'id':_0x31be40},'data':{..._0x3b5ccc,'updatedAt':new Date()},'select':{'id':!![],'customerEmail':!![],'customerName':!![],'customerCountry':!![],'customerIp':!![],'customerUa':!![],'updatedAt':!![]}});return console[_0x5e6329(0x203)]('‚úÖ\x20Customer\x20data\x20updated\x20for\x20payment\x20'+_0x31be40),console[_0x5e6329(0x203)]('\x20\x20\x20üåç\x20Country:\x20'+_0x43eb65[_0x5e6329(0x284)]+_0x5e6329(0x20a)+_0x941d62['customerCountry']),console[_0x5e6329(0x203)]('\x20\x20\x20üåê\x20IP:\x20'+_0x43eb65['customerIp']+_0x5e6329(0x20a)+_0x941d62[_0x5e6329(0x283)]),console['log'](_0x5e6329(0x210)+(_0x43eb65['customerUa']?'set':_0x5e6329(0x29d))+_0x5e6329(0x20a)+(_0x941d62[_0x5e6329(0x21d)]?'set':'not\x20set')),_0x941d62;}async['getSystemStatistics'](_0x477dbf){const _0x434c91=a35_0x1a4240,_0x32d7d9=new Date();let _0x3eb686;switch(_0x477dbf){case'7d':_0x3eb686=new Date(_0x32d7d9[_0x434c91(0x205)]()-0x7*0x18*0x3c*0x3c*0x3e8);break;case _0x434c91(0x299):_0x3eb686=new Date(_0x32d7d9['getTime']()-0x1e*0x18*0x3c*0x3c*0x3e8);break;case _0x434c91(0x248):_0x3eb686=new Date(_0x32d7d9[_0x434c91(0x205)]()-0x5a*0x18*0x3c*0x3c*0x3e8);break;default:_0x3eb686=new Date(_0x32d7d9[_0x434c91(0x205)]()-0x1e*0x18*0x3c*0x3c*0x3e8);}const [_0xefac16,_0x5947e1,_0x341934,_0x16118a,_0x56de6f,_0x232a89]=await Promise['all']([database_1[_0x434c91(0x21f)][_0x434c91(0x1da)][_0x434c91(0x20f)](),database_1['default'][_0x434c91(0x1da)][_0x434c91(0x20f)]({'where':{'status':'ACTIVE'}}),database_1[_0x434c91(0x21f)][_0x434c91(0x21c)][_0x434c91(0x20f)]({'where':{'createdAt':{'gte':_0x3eb686},'gateway':{'not':_0x434c91(0x256)}}}),database_1[_0x434c91(0x21f)][_0x434c91(0x21c)][_0x434c91(0x20f)]({'where':{'status':'PAID','createdAt':{'gte':_0x3eb686},'gateway':{'not':_0x434c91(0x256)}}}),database_1[_0x434c91(0x21f)][_0x434c91(0x21c)]['findMany']({'where':{'status':_0x434c91(0x25d),'createdAt':{'gte':_0x3eb686},'gateway':{'not':_0x434c91(0x256)}},'select':{'amount':!![],'currency':!![]}}),database_1[_0x434c91(0x21f)][_0x434c91(0x21c)]['findMany']({'where':{'gateway':{'not':'test_gateway'}},'take':0xa,'orderBy':{'createdAt':_0x434c91(0x289)},'include':{'shop':{'select':{'name':!![],'username':!![]}}}})]);let _0x447d85=0x0;for(const _0x13db8f of _0x56de6f){const _0x381a65=await currencyService_1[_0x434c91(0x206)]['convertToUSDT'](_0x13db8f[_0x434c91(0x23b)],_0x13db8f[_0x434c91(0x266)]);_0x447d85+=_0x381a65;}const _0x4a4da7=_0x341934>0x0?_0x16118a/_0x341934*0x64:0x0;return{'totalShops':_0xefac16,'activeShops':_0x5947e1,'totalPayments':_0x341934,'successfulPayments':_0x16118a,'totalRevenue':Math[_0x434c91(0x25f)](_0x447d85*0x64)/0x64,'conversionRate':Math['round'](_0x4a4da7*0x64)/0x64,'recentPayments':_0x232a89[_0x434c91(0x226)](_0x3b6fb1=>({'id':_0x3b6fb1['id'],'amount':_0x3b6fb1[_0x434c91(0x23b)],'currency':_0x3b6fb1[_0x434c91(0x266)],'status':_0x3b6fb1[_0x434c91(0x227)],'gateway':_0x3b6fb1[_0x434c91(0x247)],'shop':_0x3b6fb1['shop'],'createdAt':_0x3b6fb1[_0x434c91(0x24e)]}))};}async[a35_0x1a4240(0x26b)](_0x446c54){const _0x18f68b=a35_0x1a4240;console[_0x18f68b(0x203)](_0x18f68b(0x216),_0x446c54);let _0x2dea90,_0x52c945=new Date();if(_0x446c54[_0x18f68b(0x214)]===_0x18f68b(0x212)&&_0x446c54[_0x18f68b(0x222)]&&_0x446c54[_0x18f68b(0x1e1)])_0x2dea90=new Date(_0x446c54[_0x18f68b(0x222)]),_0x52c945=new Date(_0x446c54[_0x18f68b(0x1e1)]);else{const _0xaea33d=new Date();switch(_0x446c54['period']){case _0x18f68b(0x1ec):_0x2dea90=new Date(_0xaea33d[_0x18f68b(0x205)]()-0x7*0x18*0x3c*0x3c*0x3e8);break;case _0x18f68b(0x23a):_0x2dea90=new Date(_0xaea33d['getTime']()-0x1e*0x18*0x3c*0x3c*0x3e8);break;case _0x18f68b(0x28b):_0x2dea90=new Date(_0xaea33d['getTime']()-0x16d*0x18*0x3c*0x3c*0x3e8);break;case _0x18f68b(0x1e2):default:_0x2dea90=new Date(_0x18f68b(0x1d5));break;}}console['log'](_0x18f68b(0x271)+_0x2dea90['toISOString']()+_0x18f68b(0x1f6)+_0x52c945['toISOString']());const _0xec9910={'status':_0x18f68b(0x25d),'gateway':{'not':_0x18f68b(0x256)},'paidAt':{'gte':_0x2dea90,'lte':_0x52c945}};_0x446c54['shopId']&&(_0xec9910[_0x18f68b(0x24d)]=_0x446c54[_0x18f68b(0x24d)]);const _0x40aa4f=await database_1['default']['payment'][_0x18f68b(0x260)]({'where':_0xec9910,'include':{'shop':{'select':{'id':!![],'name':!![],'username':!![],'gatewaySettings':!![]}}}});console['log'](_0x18f68b(0x1db)+_0x40aa4f[_0x18f68b(0x1dd)]+_0x18f68b(0x211));let _0x5e8da4=0x0,_0x555840=0x0,_0x2b8ef0=0x0;const _0x7feca3={},_0x3c02aa={},_0x243a1f={};for(const _0x57aba8 of _0x40aa4f){try{const _0x2c5e96=await currencyService_1['currencyService'][_0x18f68b(0x228)](_0x57aba8['amount'],_0x57aba8[_0x18f68b(0x266)]);let _0x5204f8={};if(_0x57aba8[_0x18f68b(0x1da)][_0x18f68b(0x236)])try{_0x5204f8=JSON[_0x18f68b(0x25b)](_0x57aba8['shop'][_0x18f68b(0x236)]);}catch(_0x3aa178){console[_0x18f68b(0x272)](_0x18f68b(0x217)+_0x57aba8[_0x18f68b(0x24d)]+':',_0x3aa178);}const _0x2b93f8=_0x5204f8[_0x18f68b(0x220)]||0xa,_0x105607=_0x2c5e96*(_0x2b93f8/0x64),_0x54b318=_0x2c5e96-_0x105607;_0x5e8da4+=_0x2c5e96,_0x555840+=_0x54b318,_0x2b8ef0+=_0x105607;!_0x7feca3[_0x57aba8[_0x18f68b(0x247)]]&&(_0x7feca3[_0x57aba8['gateway']]={'gateway':_0x57aba8[_0x18f68b(0x247)],'gatewayDisplayName':this[_0x18f68b(0x251)](_0x57aba8[_0x18f68b(0x247)]),'paymentsCount':0x0,'turnoverUSDT':0x0,'commissionUSDT':0x0,'merchantEarningsUSDT':0x0,'totalCommissionRate':0x0});_0x7feca3[_0x57aba8[_0x18f68b(0x247)]][_0x18f68b(0x273)]++,_0x7feca3[_0x57aba8[_0x18f68b(0x247)]]['turnoverUSDT']+=_0x2c5e96,_0x7feca3[_0x57aba8[_0x18f68b(0x247)]][_0x18f68b(0x22c)]+=_0x105607,_0x7feca3[_0x57aba8[_0x18f68b(0x247)]][_0x18f68b(0x25e)]+=_0x54b318,_0x7feca3[_0x57aba8[_0x18f68b(0x247)]]['totalCommissionRate']+=_0x2b93f8;!_0x446c54[_0x18f68b(0x24d)]&&(!_0x3c02aa[_0x57aba8['shopId']]&&(_0x3c02aa[_0x57aba8[_0x18f68b(0x24d)]]={'shopId':_0x57aba8[_0x18f68b(0x24d)],'shopName':_0x57aba8['shop'][_0x18f68b(0x28c)],'shopUsername':_0x57aba8[_0x18f68b(0x1da)]['username'],'paymentsCount':0x0,'turnoverUSDT':0x0,'commissionUSDT':0x0,'merchantEarningsUSDT':0x0,'paidOutUSDT':0x0,'averageCheckUSDT':0x0}),_0x3c02aa[_0x57aba8[_0x18f68b(0x24d)]][_0x18f68b(0x273)]++,_0x3c02aa[_0x57aba8['shopId']][_0x18f68b(0x261)]+=_0x2c5e96,_0x3c02aa[_0x57aba8[_0x18f68b(0x24d)]][_0x18f68b(0x22c)]+=_0x105607,_0x3c02aa[_0x57aba8[_0x18f68b(0x24d)]][_0x18f68b(0x25e)]+=_0x54b318);const _0x45604f=_0x57aba8[_0x18f68b(0x1e3)][_0x18f68b(0x238)]()[_0x18f68b(0x257)]('T')[0x0];!_0x243a1f[_0x45604f]&&(_0x243a1f[_0x45604f]={'date':_0x45604f,'turnover':0x0,'merchantEarnings':0x0,'gatewayEarnings':0x0,'paymentsCount':0x0}),_0x243a1f[_0x45604f]['turnover']+=_0x2c5e96,_0x243a1f[_0x45604f][_0x18f68b(0x26d)]+=_0x54b318,_0x243a1f[_0x45604f][_0x18f68b(0x27c)]+=_0x105607,_0x243a1f[_0x45604f]['paymentsCount']++;}catch(_0x4591d0){console[_0x18f68b(0x272)](_0x18f68b(0x224)+_0x57aba8['id']+':',_0x4591d0);}}Object[_0x18f68b(0x29e)](_0x7feca3)[_0x18f68b(0x25c)](_0x3c7b77=>{const _0x176fad=_0x18f68b;_0x3c7b77['averageCommissionRate']=_0x3c7b77['paymentsCount']>0x0?_0x3c7b77[_0x176fad(0x276)]/_0x3c7b77[_0x176fad(0x273)]:0x0,delete _0x3c7b77['totalCommissionRate'];}),Object[_0x18f68b(0x29e)](_0x3c02aa)[_0x18f68b(0x25c)](_0x2f7990=>{const _0x42290b=_0x18f68b;_0x2f7990[_0x42290b(0x252)]=_0x2f7990[_0x42290b(0x273)]>0x0?_0x2f7990[_0x42290b(0x261)]/_0x2f7990[_0x42290b(0x273)]:0x0;});let _0x2f08f2=0x0;if(_0x446c54[_0x18f68b(0x24d)]){const _0x476529=await database_1[_0x18f68b(0x21f)][_0x18f68b(0x28a)][_0x18f68b(0x260)]({'where':{'shopId':_0x446c54[_0x18f68b(0x24d)],'status':'COMPLETED','createdAt':{'gte':_0x2dea90,'lte':_0x52c945}},'select':{'amount':!![]}});_0x2f08f2=_0x476529['reduce']((_0x1f3d31,_0x57a2c7)=>_0x1f3d31+_0x57a2c7[_0x18f68b(0x23b)],0x0);}const _0x3e91f3=_0x40aa4f[_0x18f68b(0x1dd)],_0x150f3b=_0x40aa4f[_0x18f68b(0x1dd)],_0x3a0a14=_0x3e91f3>0x0?_0x5e8da4/_0x3e91f3:0x0,_0x55c273=0x64,_0x4b42fa=Math[_0x18f68b(0x29f)]((_0x52c945[_0x18f68b(0x205)]()-_0x2dea90[_0x18f68b(0x205)]())/(0x3e8*0x3c*0x3c*0x18)),_0x46953b={'totalTurnover':Math['round'](_0x5e8da4*0x64)/0x64,'merchantEarnings':Math[_0x18f68b(0x25f)](_0x555840*0x64)/0x64,'gatewayEarnings':Math['round'](_0x2b8ef0*0x64)/0x64,'totalPaidOut':Math[_0x18f68b(0x25f)](_0x2f08f2*0x64)/0x64,'averageCheck':Math[_0x18f68b(0x25f)](_0x3a0a14*0x64)/0x64,'totalPayments':_0x3e91f3,'successfulPayments':_0x150f3b,'conversionRate':_0x55c273,'gatewayBreakdown':Object[_0x18f68b(0x29e)](_0x7feca3)['map'](_0x16689f=>({..._0x16689f,'turnoverUSDT':Math['round'](_0x16689f[_0x18f68b(0x261)]*0x64)/0x64,'commissionUSDT':Math[_0x18f68b(0x25f)](_0x16689f['commissionUSDT']*0x64)/0x64,'merchantEarningsUSDT':Math['round'](_0x16689f['merchantEarningsUSDT']*0x64)/0x64,'averageCommissionRate':Math[_0x18f68b(0x25f)](_0x16689f[_0x18f68b(0x1d2)]*0x64)/0x64})),'merchantBreakdown':_0x446c54['shopId']?undefined:Object[_0x18f68b(0x29e)](_0x3c02aa)[_0x18f68b(0x226)](_0x34b12f=>({..._0x34b12f,'turnoverUSDT':Math[_0x18f68b(0x25f)](_0x34b12f['turnoverUSDT']*0x64)/0x64,'commissionUSDT':Math[_0x18f68b(0x25f)](_0x34b12f['commissionUSDT']*0x64)/0x64,'merchantEarningsUSDT':Math[_0x18f68b(0x25f)](_0x34b12f[_0x18f68b(0x25e)]*0x64)/0x64,'paidOutUSDT':Math[_0x18f68b(0x25f)](_0x34b12f[_0x18f68b(0x22f)]*0x64)/0x64,'averageCheckUSDT':Math[_0x18f68b(0x25f)](_0x34b12f[_0x18f68b(0x252)]*0x64)/0x64})),'dailyData':Object[_0x18f68b(0x29e)](_0x243a1f)[_0x18f68b(0x226)](_0x2646c6=>({..._0x2646c6,'turnover':Math['round'](_0x2646c6[_0x18f68b(0x244)]*0x64)/0x64,'merchantEarnings':Math[_0x18f68b(0x25f)](_0x2646c6[_0x18f68b(0x26d)]*0x64)/0x64,'gatewayEarnings':Math['round'](_0x2646c6[_0x18f68b(0x27c)]*0x64)/0x64}))[_0x18f68b(0x278)]((_0x7d0a5,_0x1355e0)=>_0x7d0a5[_0x18f68b(0x245)][_0x18f68b(0x1d4)](_0x1355e0[_0x18f68b(0x245)])),'periodInfo':{'from':_0x2dea90,'to':_0x52c945,'periodType':_0x446c54[_0x18f68b(0x214)]||_0x18f68b(0x212),'daysCount':_0x4b42fa}};return console['log'](_0x18f68b(0x22a)),console['log'](_0x18f68b(0x1dc)+_0x46953b[_0x18f68b(0x267)]+'\x20USDT'),console[_0x18f68b(0x203)](_0x18f68b(0x1e9)+_0x46953b['merchantEarnings']+'\x20USDT'),console[_0x18f68b(0x203)]('\x20\x20\x20üè™\x20Gateway\x20earnings:\x20'+_0x46953b[_0x18f68b(0x27c)]+_0x18f68b(0x1d3)),console[_0x18f68b(0x203)]('\x20\x20\x20üìä\x20Total\x20payments:\x20'+_0x46953b[_0x18f68b(0x23e)]),_0x46953b;}[a35_0x1a4240(0x251)](_0x594442){const _0xb84a8c=a35_0x1a4240,_0x4ee4e6={'test_gateway':_0xb84a8c(0x293),'plisio':'Plisio','rapyd':_0xb84a8c(0x25a),'noda':_0xb84a8c(0x298),'cointopay':'CoinToPay','klyme_eu':'KLYME\x20EU','klyme_gb':_0xb84a8c(0x246),'klyme_de':_0xb84a8c(0x1cf)};return _0x4ee4e6[_0x594442]||_0x594442;}async['getMerchantsAwaitingPayout'](_0x417080){const _0x2a3b59=a35_0x1a4240,{page:_0x1172fe,limit:_0xda00ee,minAmount:_0x320ae2,search:_0x9738fd}=_0x417080,_0x24facb=(_0x1172fe-0x1)*_0xda00ee;console[_0x2a3b59(0x203)](_0x2a3b59(0x230),_0x417080);const _0x55dccb=await database_1[_0x2a3b59(0x21f)][_0x2a3b59(0x21c)][_0x2a3b59(0x260)]({'where':{'status':'PAID','merchantPaid':![],'paidAt':{'not':null}},'include':{'shop':{'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'gatewaySettings':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![]}}}});console[_0x2a3b59(0x203)](_0x2a3b59(0x1db)+_0x55dccb['length']+_0x2a3b59(0x295));const _0x20c05d={};for(const _0x35db07 of _0x55dccb){const _0x2e29a2=_0x35db07[_0x2a3b59(0x24d)];!_0x20c05d[_0x2e29a2]&&(_0x20c05d[_0x2e29a2]={'id':_0x35db07[_0x2a3b59(0x1da)]['id'],'fullName':_0x35db07[_0x2a3b59(0x1da)][_0x2a3b59(0x28c)],'username':_0x35db07['shop'][_0x2a3b59(0x201)],'telegramId':_0x35db07[_0x2a3b59(0x1da)]['telegram'],'merchantUrl':_0x35db07[_0x2a3b59(0x1da)][_0x2a3b59(0x1ff)],'wallets':{'usdtPolygonWallet':_0x35db07[_0x2a3b59(0x1da)][_0x2a3b59(0x1fb)],'usdtTrcWallet':_0x35db07[_0x2a3b59(0x1da)][_0x2a3b59(0x213)],'usdtErcWallet':_0x35db07[_0x2a3b59(0x1da)][_0x2a3b59(0x282)],'usdcPolygonWallet':_0x35db07[_0x2a3b59(0x1da)][_0x2a3b59(0x285)]},'totalAmountUSDT':0x0,'totalAmountAfterCommissionUSDT':0x0,'paymentsCount':0x0,'oldestPaymentDate':_0x35db07['paidAt'],'gatewayBreakdown':{},'gatewaySettings':_0x35db07[_0x2a3b59(0x1da)]['gatewaySettings']});try{const _0x2368ee=await currencyService_1['currencyService'][_0x2a3b59(0x228)](_0x35db07['amount'],_0x35db07[_0x2a3b59(0x266)]);let _0xf7825={};if(_0x35db07['shop'][_0x2a3b59(0x236)])try{_0xf7825=JSON[_0x2a3b59(0x25b)](_0x35db07[_0x2a3b59(0x1da)]['gatewaySettings']);}catch(_0x1818ff){console[_0x2a3b59(0x272)](_0x2a3b59(0x217)+_0x2e29a2+':',_0x1818ff);}const _0x1a9156=_0xf7825[_0x2a3b59(0x220)]||0xa,_0x101d37=_0x2368ee*(0x1-_0x1a9156/0x64);_0x20c05d[_0x2e29a2][_0x2a3b59(0x1ed)]+=_0x2368ee,_0x20c05d[_0x2e29a2][_0x2a3b59(0x20b)]+=_0x101d37,_0x20c05d[_0x2e29a2][_0x2a3b59(0x273)]++,_0x35db07[_0x2a3b59(0x1e3)]<_0x20c05d[_0x2e29a2][_0x2a3b59(0x24c)]&&(_0x20c05d[_0x2e29a2]['oldestPaymentDate']=_0x35db07[_0x2a3b59(0x1e3)]),!_0x20c05d[_0x2e29a2][_0x2a3b59(0x29c)][_0x35db07['gateway']]&&(_0x20c05d[_0x2e29a2][_0x2a3b59(0x29c)][_0x35db07[_0x2a3b59(0x247)]]={'gateway':_0x35db07[_0x2a3b59(0x247)],'count':0x0,'amountUSDT':0x0,'amountAfterCommissionUSDT':0x0,'commission':_0x1a9156}),_0x20c05d[_0x2e29a2]['gatewayBreakdown'][_0x35db07[_0x2a3b59(0x247)]][_0x2a3b59(0x20f)]++,_0x20c05d[_0x2e29a2][_0x2a3b59(0x29c)][_0x35db07[_0x2a3b59(0x247)]][_0x2a3b59(0x225)]+=_0x2368ee,_0x20c05d[_0x2e29a2][_0x2a3b59(0x29c)][_0x35db07[_0x2a3b59(0x247)]]['amountAfterCommissionUSDT']+=_0x101d37;}catch(_0x1c9982){console[_0x2a3b59(0x272)](_0x2a3b59(0x224)+_0x35db07['id']+':',_0x1c9982);}}let _0xe4814c=Object[_0x2a3b59(0x29e)](_0x20c05d)[_0x2a3b59(0x226)](_0x505ab1=>({..._0x505ab1,'totalAmountUSDT':Math[_0x2a3b59(0x25f)](_0x505ab1[_0x2a3b59(0x1ed)]*0x64)/0x64,'totalAmountAfterCommissionUSDT':Math[_0x2a3b59(0x25f)](_0x505ab1[_0x2a3b59(0x20b)]*0x64)/0x64,'gatewayBreakdown':Object[_0x2a3b59(0x29e)](_0x505ab1[_0x2a3b59(0x29c)])[_0x2a3b59(0x226)](_0x17242a=>({..._0x17242a,'amountUSDT':Math['round'](_0x17242a[_0x2a3b59(0x225)]*0x64)/0x64,'amountAfterCommissionUSDT':Math[_0x2a3b59(0x25f)](_0x17242a[_0x2a3b59(0x21a)]*0x64)/0x64}))}));_0x320ae2&&(_0xe4814c=_0xe4814c[_0x2a3b59(0x1ee)](_0x5e5f63=>_0x5e5f63[_0x2a3b59(0x20b)]>=_0x320ae2));if(_0x9738fd){const _0x21e72c=_0x9738fd['toLowerCase']();_0xe4814c=_0xe4814c['filter'](_0x4b57ae=>_0x4b57ae[_0x2a3b59(0x229)]['toLowerCase']()['includes'](_0x21e72c)||_0x4b57ae[_0x2a3b59(0x201)][_0x2a3b59(0x263)]()[_0x2a3b59(0x1fa)](_0x21e72c));}_0xe4814c[_0x2a3b59(0x278)]((_0x313f43,_0x29995f)=>_0x29995f[_0x2a3b59(0x20b)]-_0x313f43[_0x2a3b59(0x20b)]);const _0x1de1e9=_0xe4814c[_0x2a3b59(0x1dd)],_0x28a04a=_0xe4814c[_0x2a3b59(0x240)](_0x24facb,_0x24facb+_0xda00ee),_0x1a7c61=_0xe4814c[_0x2a3b59(0x22e)]((_0x226797,_0x477596)=>_0x226797+_0x477596[_0x2a3b59(0x1ed)],0x0),_0x220110=_0xe4814c[_0x2a3b59(0x22e)]((_0x82d472,_0x552308)=>_0x82d472+_0x552308[_0x2a3b59(0x20b)],0x0);return console[_0x2a3b59(0x203)](_0x2a3b59(0x1d8)+_0x1de1e9+_0x2a3b59(0x20c)+Math[_0x2a3b59(0x25f)](_0x220110*0x64)/0x64+_0x2a3b59(0x262)),{'merchants':_0x28a04a,'pagination':{'page':_0x1172fe,'limit':_0xda00ee,'total':_0x1de1e9,'totalPages':Math[_0x2a3b59(0x29f)](_0x1de1e9/_0xda00ee)},'summary':{'totalMerchants':_0x1de1e9,'totalAmountUSDT':Math['round'](_0x1a7c61*0x64)/0x64,'totalAmountAfterCommissionUSDT':Math[_0x2a3b59(0x25f)](_0x220110*0x64)/0x64}};}async[a35_0x1a4240(0x24f)](_0x350622){const _0x126af1=a35_0x1a4240,{shopId:_0x51ee84,amount:_0x1a1d46,network:_0x20a648,notes:_0x331cd1,periodFrom:_0x213f96,periodTo:_0x47688f}=_0x350622,_0x532ffd=await database_1[_0x126af1(0x21f)][_0x126af1(0x1da)]['findUnique']({'where':{'id':_0x51ee84},'select':{'id':!![],'name':!![],'username':!![]}});if(!_0x532ffd)throw new Error(_0x126af1(0x27f));const _0x274d26=await database_1['default'][_0x126af1(0x28a)]['create']({'data':{'shopId':_0x51ee84,'amount':_0x1a1d46,'network':_0x20a648,'status':'COMPLETED','notes':_0x331cd1,'periodFrom':_0x213f96?new Date(_0x213f96):null,'periodTo':_0x47688f?new Date(_0x47688f):null,'createdAt':new Date(),'paidAt':new Date()}});return console['log'](_0x126af1(0x27d)+_0x274d26['id']+_0x126af1(0x264)+_0x532ffd[_0x126af1(0x201)]+'\x20('+_0x1a1d46+_0x126af1(0x1f8)),{'id':_0x274d26['id'],'shopId':_0x274d26['shopId'],'shopName':_0x532ffd['name'],'shopUsername':_0x532ffd[_0x126af1(0x201)],'amount':_0x274d26[_0x126af1(0x23b)],'network':_0x274d26[_0x126af1(0x26c)],'status':_0x274d26['status'],'txid':_0x274d26[_0x126af1(0x239)],'notes':_0x274d26[_0x126af1(0x1d9)],'periodFrom':_0x274d26[_0x126af1(0x1df)],'periodTo':_0x274d26[_0x126af1(0x1e7)],'createdAt':_0x274d26[_0x126af1(0x24e)],'paidAt':_0x274d26[_0x126af1(0x1e3)]};}async['getAllPayouts'](_0xaa9fae){const _0x3de277=a35_0x1a4240,{page:_0x55eb52,limit:_0x44c18c,shopId:_0x359c3c,network:_0x653320,dateFrom:_0x5c5e1f,dateTo:_0xe75658,search:_0x23f3c2}=_0xaa9fae,_0x288d36=(_0x55eb52-0x1)*_0x44c18c,_0x28ab2a={};_0x359c3c&&(_0x28ab2a['shopId']=_0x359c3c);_0x653320&&(_0x28ab2a['network']=_0x653320);(_0x5c5e1f||_0xe75658)&&(_0x28ab2a[_0x3de277(0x24e)]={},_0x5c5e1f&&(_0x28ab2a['createdAt'][_0x3de277(0x23c)]=new Date(_0x5c5e1f)),_0xe75658&&(_0x28ab2a[_0x3de277(0x24e)][_0x3de277(0x232)]=new Date(_0xe75658)));_0x23f3c2&&(_0x28ab2a['OR']=[{'shop':{'name':{'contains':_0x23f3c2,'mode':_0x3de277(0x215)}}},{'shop':{'username':{'contains':_0x23f3c2,'mode':_0x3de277(0x215)}}},{'notes':{'contains':_0x23f3c2,'mode':'insensitive'}}]);const [_0xe7aaf2,_0x25469e]=await Promise[_0x3de277(0x1e2)]([database_1[_0x3de277(0x21f)][_0x3de277(0x28a)][_0x3de277(0x260)]({'where':_0x28ab2a,'skip':_0x288d36,'take':_0x44c18c,'orderBy':{'createdAt':_0x3de277(0x289)},'include':{'shop':{'select':{'name':!![],'username':!![]}}}}),database_1[_0x3de277(0x21f)][_0x3de277(0x28a)][_0x3de277(0x20f)]({'where':_0x28ab2a})]);return{'payouts':_0xe7aaf2['map'](_0x59afe1=>({'id':_0x59afe1['id'],'shopId':_0x59afe1[_0x3de277(0x24d)],'shopName':_0x59afe1[_0x3de277(0x1da)][_0x3de277(0x28c)],'shopUsername':_0x59afe1['shop'][_0x3de277(0x201)],'amount':_0x59afe1[_0x3de277(0x23b)],'network':_0x59afe1['network'],'status':_0x59afe1['status'],'txid':_0x59afe1[_0x3de277(0x239)],'notes':_0x59afe1['notes'],'periodFrom':_0x59afe1[_0x3de277(0x1df)],'periodTo':_0x59afe1[_0x3de277(0x1e7)],'createdAt':_0x59afe1['createdAt'],'paidAt':_0x59afe1['paidAt']})),'pagination':{'page':_0x55eb52,'limit':_0x44c18c,'total':_0x25469e,'totalPages':Math[_0x3de277(0x29f)](_0x25469e/_0x44c18c)}};}async['getPayoutById'](_0x97b8de){const _0x4e65bf=a35_0x1a4240,_0x422ccd=await database_1[_0x4e65bf(0x21f)][_0x4e65bf(0x28a)]['findUnique']({'where':{'id':_0x97b8de},'include':{'shop':{'select':{'name':!![],'username':!![]}}}});if(!_0x422ccd)return null;return{'id':_0x422ccd['id'],'shopId':_0x422ccd[_0x4e65bf(0x24d)],'shopName':_0x422ccd[_0x4e65bf(0x1da)][_0x4e65bf(0x28c)],'shopUsername':_0x422ccd[_0x4e65bf(0x1da)][_0x4e65bf(0x201)],'amount':_0x422ccd[_0x4e65bf(0x23b)],'network':_0x422ccd[_0x4e65bf(0x26c)],'status':_0x422ccd[_0x4e65bf(0x227)],'txid':_0x422ccd[_0x4e65bf(0x239)],'notes':_0x422ccd['notes'],'periodFrom':_0x422ccd[_0x4e65bf(0x1df)],'periodTo':_0x422ccd[_0x4e65bf(0x1e7)],'createdAt':_0x422ccd[_0x4e65bf(0x24e)],'paidAt':_0x422ccd[_0x4e65bf(0x1e3)]};}async[a35_0x1a4240(0x1f2)](_0x58007d){const _0x24fa8a=a35_0x1a4240;await database_1[_0x24fa8a(0x21f)][_0x24fa8a(0x28a)]['delete']({'where':{'id':_0x58007d}});}async[a35_0x1a4240(0x279)](_0x2dae62){const _0x268ae3=a35_0x1a4240,{page:_0x43d5fc,limit:_0x25e9aa,status:_0x2f3075,gateway:_0x4432a7,shopId:_0x5799e2,dateFrom:_0x43526e,dateTo:_0x19881a,search:_0x59ab48}=_0x2dae62,_0x36c089=(_0x43d5fc-0x1)*_0x25e9aa,_0x2f452c={};_0x2f3075&&(_0x2f452c[_0x268ae3(0x227)]=_0x2f3075['toUpperCase']());_0x4432a7&&(_0x2f452c['gateway']=_0x4432a7[_0x268ae3(0x263)]());_0x2f452c[_0x268ae3(0x247)]=_0x2f452c[_0x268ae3(0x247)]?_0x2f452c['gateway']:{'not':_0x268ae3(0x256)};if(typeof _0x2f452c[_0x268ae3(0x247)]===_0x268ae3(0x200)&&_0x2f452c[_0x268ae3(0x247)]!==_0x268ae3(0x256)){}else{if(typeof _0x2f452c[_0x268ae3(0x247)]===_0x268ae3(0x200)&&_0x2f452c[_0x268ae3(0x247)]==='test_gateway'){}else _0x2f452c[_0x268ae3(0x247)]={'not':_0x268ae3(0x256)};}_0x5799e2&&(_0x2f452c[_0x268ae3(0x24d)]=_0x5799e2);(_0x43526e||_0x19881a)&&(_0x2f452c[_0x268ae3(0x24e)]={},_0x43526e&&(_0x2f452c[_0x268ae3(0x24e)][_0x268ae3(0x23c)]=new Date(_0x43526e)),_0x19881a&&(_0x2f452c[_0x268ae3(0x24e)]['lte']=new Date(_0x19881a)));_0x59ab48&&(_0x2f452c['OR']=[{'orderId':{'contains':_0x59ab48,'mode':'insensitive'}},{'gatewayOrderId':{'contains':_0x59ab48,'mode':_0x268ae3(0x215)}},{'customerEmail':{'contains':_0x59ab48,'mode':_0x268ae3(0x215)}},{'shop':{'name':{'contains':_0x59ab48,'mode':'insensitive'}}},{'shop':{'username':{'contains':_0x59ab48,'mode':_0x268ae3(0x215)}}}]);const [_0xb55db3,_0x1886cd]=await Promise[_0x268ae3(0x1e2)]([database_1['default'][_0x268ae3(0x21c)][_0x268ae3(0x260)]({'where':_0x2f452c,'skip':_0x36c089,'take':_0x25e9aa,'orderBy':{'createdAt':_0x268ae3(0x289)},'include':{'shop':{'select':{'name':!![],'username':!![]}}}}),database_1[_0x268ae3(0x21f)]['payment']['count']({'where':_0x2f452c})]);return{'payments':_0xb55db3[_0x268ae3(0x226)](_0x2ff866=>({'id':_0x2ff866['id'],'shopId':_0x2ff866[_0x268ae3(0x24d)],'gateway':_0x2ff866[_0x268ae3(0x247)],'amount':_0x2ff866['amount'],'currency':_0x2ff866[_0x268ae3(0x266)],'status':_0x2ff866[_0x268ae3(0x227)],'orderId':_0x2ff866[_0x268ae3(0x26e)],'gatewayOrderId':_0x2ff866['gatewayOrderId'],'customerEmail':_0x2ff866[_0x268ae3(0x237)],'customerName':_0x2ff866[_0x268ae3(0x20e)],'customerCountry':_0x2ff866[_0x268ae3(0x284)],'customerIp':_0x2ff866[_0x268ae3(0x283)],'customerUa':_0x2ff866[_0x268ae3(0x21d)],'failureMessage':_0x2ff866[_0x268ae3(0x253)],'createdAt':_0x2ff866[_0x268ae3(0x24e)],'updatedAt':_0x2ff866['updatedAt'],'shop':_0x2ff866[_0x268ae3(0x1da)]})),'pagination':{'page':_0x43d5fc,'limit':_0x25e9aa,'total':_0x1886cd,'totalPages':Math[_0x268ae3(0x29f)](_0x1886cd/_0x25e9aa)}};}async[a35_0x1a4240(0x1e6)](_0x455645){const _0x2381bd=a35_0x1a4240,_0x4c33dc=await database_1['default'][_0x2381bd(0x21c)][_0x2381bd(0x23f)]({'where':{'id':_0x455645},'include':{'shop':{'select':{'name':!![],'username':!![]}}}});if(!_0x4c33dc)return null;return{'id':_0x4c33dc['id'],'shopId':_0x4c33dc[_0x2381bd(0x24d)],'gateway':_0x4c33dc['gateway'],'amount':_0x4c33dc['amount'],'currency':_0x4c33dc['currency'],'status':_0x4c33dc[_0x2381bd(0x227)],'orderId':_0x4c33dc[_0x2381bd(0x26e)],'gatewayOrderId':_0x4c33dc[_0x2381bd(0x268)],'customerEmail':_0x4c33dc[_0x2381bd(0x237)],'customerName':_0x4c33dc[_0x2381bd(0x20e)],'customerCountry':_0x4c33dc['customerCountry'],'customerIp':_0x4c33dc[_0x2381bd(0x283)],'customerUa':_0x4c33dc['customerUa'],'failureMessage':_0x4c33dc[_0x2381bd(0x253)],'externalPaymentUrl':_0x4c33dc[_0x2381bd(0x270)],'successUrl':_0x4c33dc['successUrl'],'failUrl':_0x4c33dc[_0x2381bd(0x22d)],'pendingUrl':_0x4c33dc[_0x2381bd(0x296)],'whiteUrl':_0x4c33dc[_0x2381bd(0x26a)],'createdAt':_0x4c33dc[_0x2381bd(0x24e)],'updatedAt':_0x4c33dc[_0x2381bd(0x281)],'shop':_0x4c33dc[_0x2381bd(0x1da)]};}async[a35_0x1a4240(0x294)](_0x3da13f,_0x192469,_0x26fc1c,_0x2b1e2c){const _0x213e3b=a35_0x1a4240,_0x1fb8e7={'status':_0x192469[_0x213e3b(0x1fc)](),'updatedAt':new Date(),'statusChangedBy':'admin','statusChangedAt':new Date()};_0x26fc1c&&(_0x1fb8e7[_0x213e3b(0x1d7)]=_0x26fc1c);_0x192469[_0x213e3b(0x1fc)]()===_0x213e3b(0x219)&&_0x2b1e2c&&(_0x1fb8e7[_0x213e3b(0x250)]=_0x2b1e2c);_0x192469[_0x213e3b(0x1fc)]()===_0x213e3b(0x25d)&&(_0x1fb8e7[_0x213e3b(0x1e3)]=new Date());const _0x521e90=await database_1[_0x213e3b(0x21f)][_0x213e3b(0x21c)]['update']({'where':{'id':_0x3da13f},'data':_0x1fb8e7,'include':{'shop':{'select':{'name':!![],'username':!![]}}}});return{'id':_0x521e90['id'],'shopId':_0x521e90[_0x213e3b(0x24d)],'gateway':_0x521e90[_0x213e3b(0x247)],'amount':_0x521e90[_0x213e3b(0x23b)],'currency':_0x521e90['currency'],'status':_0x521e90[_0x213e3b(0x227)],'orderId':_0x521e90[_0x213e3b(0x26e)],'gatewayOrderId':_0x521e90[_0x213e3b(0x268)],'customerEmail':_0x521e90[_0x213e3b(0x237)],'customerName':_0x521e90[_0x213e3b(0x20e)],'customerCountry':_0x521e90[_0x213e3b(0x284)],'customerIp':_0x521e90[_0x213e3b(0x283)],'customerUa':_0x521e90[_0x213e3b(0x21d)],'failureMessage':_0x521e90['failureMessage'],'adminNotes':_0x521e90[_0x213e3b(0x1d7)],'chargebackAmount':_0x521e90['chargebackAmount'],'statusChangedBy':_0x521e90[_0x213e3b(0x26f)],'statusChangedAt':_0x521e90['statusChangedAt'],'createdAt':_0x521e90[_0x213e3b(0x24e)],'updatedAt':_0x521e90[_0x213e3b(0x281)],'shop':_0x521e90[_0x213e3b(0x1da)]};}async[a35_0x1a4240(0x208)](_0xebae7d,_0x41b006){const _0xf96347=a35_0x1a4240,_0x4600c2={..._0x41b006};_0x41b006[_0xf96347(0x29a)]&&(_0x4600c2['password']=await bcryptjs_1[_0xf96347(0x21f)][_0xf96347(0x24b)](_0x41b006[_0xf96347(0x29a)],0xc));_0x41b006[_0xf96347(0x229)]&&(_0x4600c2['name']=_0x41b006[_0xf96347(0x229)],delete _0x4600c2[_0xf96347(0x229)]);_0x41b006[_0xf96347(0x209)]&&(_0x4600c2[_0xf96347(0x231)]=_0x41b006[_0xf96347(0x209)],delete _0x4600c2[_0xf96347(0x209)]);_0x41b006[_0xf96347(0x265)]&&(_0x4600c2[_0xf96347(0x1ff)]=_0x41b006[_0xf96347(0x265)],delete _0x4600c2[_0xf96347(0x265)]);_0x41b006[_0xf96347(0x28e)]&&(_0x4600c2['paymentGateways']=JSON[_0xf96347(0x218)](_0x41b006[_0xf96347(0x28e)]),delete _0x4600c2[_0xf96347(0x28e)]);_0x41b006[_0xf96347(0x236)]&&(_0x4600c2['gatewaySettings']=JSON[_0xf96347(0x218)](_0x41b006[_0xf96347(0x236)]),delete _0x4600c2[_0xf96347(0x236)]);_0x41b006[_0xf96347(0x204)]&&(_0x41b006['wallets']['usdtPolygonWallet']!==undefined&&(_0x4600c2[_0xf96347(0x1fb)]=_0x41b006[_0xf96347(0x204)][_0xf96347(0x1fb)]||null),_0x41b006[_0xf96347(0x204)][_0xf96347(0x213)]!==undefined&&(_0x4600c2[_0xf96347(0x213)]=_0x41b006[_0xf96347(0x204)]['usdtTrcWallet']||null),_0x41b006[_0xf96347(0x204)]['usdtErcWallet']!==undefined&&(_0x4600c2['usdtErcWallet']=_0x41b006[_0xf96347(0x204)][_0xf96347(0x282)]||null),_0x41b006[_0xf96347(0x204)][_0xf96347(0x285)]!==undefined&&(_0x4600c2[_0xf96347(0x285)]=_0x41b006[_0xf96347(0x204)][_0xf96347(0x285)]||null),delete _0x4600c2[_0xf96347(0x204)]);const _0x96fabd=await database_1[_0xf96347(0x21f)][_0xf96347(0x1da)][_0xf96347(0x221)]({'where':{'id':_0xebae7d},'data':_0x4600c2,'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});return{'id':_0x96fabd['id'],'fullName':_0x96fabd[_0xf96347(0x28c)],'username':_0x96fabd['username'],'telegramId':_0x96fabd[_0xf96347(0x231)],'merchantUrl':_0x96fabd[_0xf96347(0x1ff)],'gateways':_0x96fabd[_0xf96347(0x255)]?JSON[_0xf96347(0x25b)](_0x96fabd['paymentGateways']):null,'gatewaySettings':_0x96fabd[_0xf96347(0x236)]?JSON['parse'](_0x96fabd[_0xf96347(0x236)]):null,'publicKey':_0x96fabd['publicKey'],'wallets':{'usdtPolygonWallet':_0x96fabd[_0xf96347(0x1fb)],'usdtTrcWallet':_0x96fabd[_0xf96347(0x213)],'usdtErcWallet':_0x96fabd[_0xf96347(0x282)],'usdcPolygonWallet':_0x96fabd[_0xf96347(0x285)]},'status':_0x96fabd['status'],'createdAt':_0x96fabd[_0xf96347(0x24e)]};}async['suspendUser'](_0x1a57a5){const _0x54ce44=a35_0x1a4240,_0x3941c6=await database_1[_0x54ce44(0x21f)][_0x54ce44(0x1da)][_0x54ce44(0x221)]({'where':{'id':_0x1a57a5},'data':{'status':_0x54ce44(0x1ce)},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});return{'id':_0x3941c6['id'],'fullName':_0x3941c6[_0x54ce44(0x28c)],'username':_0x3941c6[_0x54ce44(0x201)],'telegramId':_0x3941c6[_0x54ce44(0x231)],'merchantUrl':_0x3941c6['shopUrl'],'gateways':_0x3941c6[_0x54ce44(0x255)]?JSON[_0x54ce44(0x25b)](_0x3941c6['paymentGateways']):null,'gatewaySettings':_0x3941c6[_0x54ce44(0x236)]?JSON[_0x54ce44(0x25b)](_0x3941c6['gatewaySettings']):null,'publicKey':_0x3941c6[_0x54ce44(0x20d)],'wallets':{'usdtPolygonWallet':_0x3941c6[_0x54ce44(0x1fb)],'usdtTrcWallet':_0x3941c6[_0x54ce44(0x213)],'usdtErcWallet':_0x3941c6[_0x54ce44(0x282)],'usdcPolygonWallet':_0x3941c6['usdcPolygonWallet']},'status':_0x3941c6[_0x54ce44(0x227)],'createdAt':_0x3941c6['createdAt']};}async[a35_0x1a4240(0x259)](_0x30e0be){const _0x4732a3=a35_0x1a4240,_0x535b89=await database_1[_0x4732a3(0x21f)][_0x4732a3(0x1da)][_0x4732a3(0x221)]({'where':{'id':_0x30e0be},'data':{'status':_0x4732a3(0x22b)},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});return{'id':_0x535b89['id'],'fullName':_0x535b89[_0x4732a3(0x28c)],'username':_0x535b89[_0x4732a3(0x201)],'telegramId':_0x535b89[_0x4732a3(0x231)],'merchantUrl':_0x535b89[_0x4732a3(0x1ff)],'gateways':_0x535b89['paymentGateways']?JSON[_0x4732a3(0x25b)](_0x535b89[_0x4732a3(0x255)]):null,'gatewaySettings':_0x535b89[_0x4732a3(0x236)]?JSON['parse'](_0x535b89['gatewaySettings']):null,'publicKey':_0x535b89[_0x4732a3(0x20d)],'wallets':{'usdtPolygonWallet':_0x535b89[_0x4732a3(0x1fb)],'usdtTrcWallet':_0x535b89[_0x4732a3(0x213)],'usdtErcWallet':_0x535b89['usdtErcWallet'],'usdcPolygonWallet':_0x535b89[_0x4732a3(0x285)]},'status':_0x535b89[_0x4732a3(0x227)],'createdAt':_0x535b89[_0x4732a3(0x24e)]};}async[a35_0x1a4240(0x292)](_0x1b039a){const _0x4d28b5=a35_0x1a4240,{page:_0x1d4fc0,limit:_0x5d31a0,status:_0x2f7f6a}=_0x1b039a,_0x2a35a6=(_0x1d4fc0-0x1)*_0x5d31a0,_0x4715c6={};_0x2f7f6a&&(_0x4715c6[_0x4d28b5(0x227)]=_0x2f7f6a[_0x4d28b5(0x1fc)]());const [_0x1a1221,_0x4ccc27]=await Promise[_0x4d28b5(0x1e2)]([database_1[_0x4d28b5(0x21f)][_0x4d28b5(0x1da)][_0x4d28b5(0x260)]({'where':_0x4715c6,'skip':_0x2a35a6,'take':_0x5d31a0,'orderBy':{'createdAt':_0x4d28b5(0x289)},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}}),database_1[_0x4d28b5(0x21f)][_0x4d28b5(0x1da)][_0x4d28b5(0x20f)]({'where':_0x4715c6})]);return{'users':_0x1a1221[_0x4d28b5(0x226)](_0x40fdcb=>({'id':_0x40fdcb['id'],'fullName':_0x40fdcb[_0x4d28b5(0x28c)],'username':_0x40fdcb[_0x4d28b5(0x201)],'telegramId':_0x40fdcb[_0x4d28b5(0x231)],'merchantUrl':_0x40fdcb[_0x4d28b5(0x1ff)],'gateways':_0x40fdcb[_0x4d28b5(0x255)]?JSON[_0x4d28b5(0x25b)](_0x40fdcb[_0x4d28b5(0x255)]):null,'gatewaySettings':_0x40fdcb['gatewaySettings']?JSON[_0x4d28b5(0x25b)](_0x40fdcb[_0x4d28b5(0x236)]):null,'publicKey':_0x40fdcb[_0x4d28b5(0x20d)],'wallets':{'usdtPolygonWallet':_0x40fdcb['usdtPolygonWallet'],'usdtTrcWallet':_0x40fdcb[_0x4d28b5(0x213)],'usdtErcWallet':_0x40fdcb[_0x4d28b5(0x282)],'usdcPolygonWallet':_0x40fdcb[_0x4d28b5(0x285)]},'status':_0x40fdcb['status'],'createdAt':_0x40fdcb[_0x4d28b5(0x24e)]})),'pagination':{'page':_0x1d4fc0,'limit':_0x5d31a0,'total':_0x4ccc27,'totalPages':Math['ceil'](_0x4ccc27/_0x5d31a0)}};}async['getUserById'](_0x5d533f){const _0xc6ba19=a35_0x1a4240,_0x3def73=await database_1['default']['shop'][_0xc6ba19(0x23f)]({'where':{'id':_0x5d533f},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});if(!_0x3def73)return null;return{'id':_0x3def73['id'],'fullName':_0x3def73[_0xc6ba19(0x28c)],'username':_0x3def73[_0xc6ba19(0x201)],'telegramId':_0x3def73[_0xc6ba19(0x231)],'merchantUrl':_0x3def73[_0xc6ba19(0x1ff)],'gateways':_0x3def73[_0xc6ba19(0x255)]?JSON[_0xc6ba19(0x25b)](_0x3def73[_0xc6ba19(0x255)]):null,'gatewaySettings':_0x3def73['gatewaySettings']?JSON[_0xc6ba19(0x25b)](_0x3def73[_0xc6ba19(0x236)]):null,'publicKey':_0x3def73[_0xc6ba19(0x20d)],'wallets':{'usdtPolygonWallet':_0x3def73[_0xc6ba19(0x1fb)],'usdtTrcWallet':_0x3def73[_0xc6ba19(0x213)],'usdtErcWallet':_0x3def73['usdtErcWallet'],'usdcPolygonWallet':_0x3def73[_0xc6ba19(0x285)]},'status':_0x3def73['status'],'createdAt':_0x3def73[_0xc6ba19(0x24e)]};}async[a35_0x1a4240(0x1e8)](_0x57c580){const _0x46385b=a35_0x1a4240,{fullName:_0x3364af,username:_0x16014b,password:_0x35e630,telegramId:_0x1e838d,merchantUrl:_0x1dfecc,gateways:_0x50a311,gatewaySettings:_0x12d2e0,wallets:_0x165449}=_0x57c580,_0x648684=await database_1[_0x46385b(0x21f)][_0x46385b(0x1da)]['findUnique']({'where':{'username':_0x16014b}});if(_0x648684)throw new Error(_0x46385b(0x21e));if(_0x1e838d){const _0xbd45c3=await database_1[_0x46385b(0x21f)]['shop']['findUnique']({'where':{'telegram':_0x1e838d}});if(_0xbd45c3)throw new Error(_0x46385b(0x287));}const _0x4ffd1e=await bcryptjs_1['default']['hash'](_0x35e630,0xc),_0xb712e7=_0x46385b(0x277)+crypto_1[_0x46385b(0x21f)][_0x46385b(0x202)](0x20)[_0x46385b(0x297)](_0x46385b(0x1f7)),_0x2ded33=_0x46385b(0x28f)+crypto_1['default']['randomBytes'](0x20)['toString']('hex'),_0x438a3=await database_1[_0x46385b(0x21f)]['shop']['create']({'data':{'name':_0x3364af,'username':_0x16014b,'password':_0x4ffd1e,'telegram':_0x1e838d,'shopUrl':_0x1dfecc,'paymentGateways':_0x50a311?JSON[_0x46385b(0x218)](_0x50a311):null,'gatewaySettings':_0x12d2e0?JSON[_0x46385b(0x218)](_0x12d2e0):null,'usdtPolygonWallet':_0x165449?.['usdtPolygonWallet']||null,'usdtTrcWallet':_0x165449?.[_0x46385b(0x213)]||null,'usdtErcWallet':_0x165449?.[_0x46385b(0x282)]||null,'usdcPolygonWallet':_0x165449?.[_0x46385b(0x285)]||null,'publicKey':_0xb712e7,'secretKey':_0x2ded33,'status':_0x46385b(0x22b)},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});return{'id':_0x438a3['id'],'fullName':_0x438a3['name'],'username':_0x438a3[_0x46385b(0x201)],'telegramId':_0x438a3[_0x46385b(0x231)],'merchantUrl':_0x438a3[_0x46385b(0x1ff)],'gateways':_0x438a3['paymentGateways']?JSON[_0x46385b(0x25b)](_0x438a3[_0x46385b(0x255)]):null,'gatewaySettings':_0x438a3[_0x46385b(0x236)]?JSON['parse'](_0x438a3[_0x46385b(0x236)]):null,'publicKey':_0x438a3[_0x46385b(0x20d)],'wallets':{'usdtPolygonWallet':_0x438a3[_0x46385b(0x1fb)],'usdtTrcWallet':_0x438a3[_0x46385b(0x213)],'usdtErcWallet':_0x438a3[_0x46385b(0x282)],'usdcPolygonWallet':_0x438a3['usdcPolygonWallet']},'status':_0x438a3[_0x46385b(0x227)],'createdAt':_0x438a3[_0x46385b(0x24e)]};}async[a35_0x1a4240(0x275)](_0x328941){const _0x34598f=a35_0x1a4240;await database_1[_0x34598f(0x21f)][_0x34598f(0x1da)]['delete']({'where':{'id':_0x328941}});}}function a35_0x4734(_0x22906e,_0x574fef){const _0xd54cc6=a35_0xd54c();return a35_0x4734=function(_0x47344b,_0x52e64b){_0x47344b=_0x47344b-0x1ce;let _0x27db87=_0xd54cc6[_0x47344b];return _0x27db87;},a35_0x4734(_0x22906e,_0x574fef);}exports[a35_0x1a4240(0x27b)]=AdminService;