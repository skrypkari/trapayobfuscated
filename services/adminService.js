'use strict';const a35_0x4212b0=a35_0x51d8;(function(_0x4dde45,_0x4a38a9){const _0x5b3bed=a35_0x51d8,_0x297903=_0x4dde45();while(!![]){try{const _0x5a8de4=parseInt(_0x5b3bed(0x2a1))/0x1+parseInt(_0x5b3bed(0x28c))/0x2+parseInt(_0x5b3bed(0x22f))/0x3+-parseInt(_0x5b3bed(0x2f0))/0x4*(parseInt(_0x5b3bed(0x204))/0x5)+parseInt(_0x5b3bed(0x287))/0x6*(parseInt(_0x5b3bed(0x23f))/0x7)+parseInt(_0x5b3bed(0x265))/0x8*(parseInt(_0x5b3bed(0x26c))/0x9)+-parseInt(_0x5b3bed(0x270))/0xa;if(_0x5a8de4===_0x4a38a9)break;else _0x297903['push'](_0x297903['shift']());}catch(_0x3792c7){_0x297903['push'](_0x297903['shift']());}}}(a35_0x2bb7,0x62234));function a35_0x51d8(_0x3fe147,_0x476aee){const _0x2bb74b=a35_0x2bb7();return a35_0x51d8=function(_0x51d8b8,_0x3eefa6){_0x51d8b8=_0x51d8b8-0x1de;let _0x546330=_0x2bb74b[_0x51d8b8];return _0x546330;},a35_0x51d8(_0x3fe147,_0x476aee);}var __importDefault=this&&this['__importDefault']||function(_0xdc618f){const _0xf79cf9=a35_0x51d8;return _0xdc618f&&_0xdc618f[_0xf79cf9(0x26e)]?_0xdc618f:{'default':_0xdc618f};};Object['defineProperty'](exports,'__esModule',{'value':!![]}),exports[a35_0x4212b0(0x214)]=void 0x0;const database_1=__importDefault(require(a35_0x4212b0(0x304))),bcryptjs_1=__importDefault(require('bcryptjs')),crypto_1=__importDefault(require(a35_0x4212b0(0x2c4))),currencyService_1=require(a35_0x4212b0(0x2ec)),gateway_1=require(a35_0x4212b0(0x2c5));function a35_0x2bb7(){const _0x596b76=['REFUND','ceil','chargebackAmount','stringify','\x20USDT\x20(gross\x20revenue)','gateway','Error\x20processing\x20payment\x20','../config/database','push','thisMonth','🔄\x20Gateway\x20mapping:','gatewayOrderId','gte','period','totalPayments','polygon_usdc','convertToUSDT','🔐\x20[','\x20\x20\x20Payout\x20amount:\x20','totalAmountUSDT','setHours','test_gateway','💰\x20Shop\x20','network','shop','\x27\x20as\x20is\x20(not\x20found\x20in\x20mappings)','pendingUrl','getMerchantsAwaitingPayout','PAID','getSystemStatistics','\x20USDT,\x20Requested:\x20','\x20\x20\x20⏳\x20Awaiting\x20payout:\x20','COMPLETED','noda','Payment\x20not\x20found','lte','get','\x20USDT)','💸\x20CHARGEBACK\x20penalty:\x20-','findUnique','usdtTrcWallet','paymentsCount','📊\x20Final\x20WHERE\x20conditions:','dailyPayments','\x20merchants\x20with\x20positive\x20balance','failureMessage','getMerchantsSelection','count','\x20\x20\x20Subtracted\x20from\x20balance:\x20-','date','\x27\x20to\x20name\x20\x27','\x20for\x20shop\x20','cointopay2','merchantEarnings','📊\x20[ADMIN]\x20Using\x20saved\x20amountAfterGatewayCommissionUSDT:\x20','findFirst','updateCustomerData','cointopay','admin','💳\x20Payout\x20wallet\x20for\x20',']\x20User\x20updated,\x20gatewaySettings\x20from\x20DB:','90d','whiteUrl','⚠️\x20Gateway\x20\x27','\x20USDT','payout','dailyRevenue','customerCountry','getAllPayments','\x27\x20(from\x20\x27','availableBalance','name','totalCommissionRate','deleteUser','customerEmail','sort','PENDING','currencyService','📊\x20Getting\x20merchants\x20awaiting\x20payout\x20with\x20filters:','\x27)\x20not\x20found\x20in\x20database,\x20returning\x20empty\x20result','5RJHphQ','findMany','Username\x20already\x20exists','ACTIVE','deletePayout','plisio','\x20paid\x20payments\x20for\x20analysis','activateUser','🔄\x20Converted\x20gateway\x20name\x20\x27','delete','all','\x20\x20\x20💵\x20Available\x20balance:\x20','\x20merchants','\x20\x20\x20🌐\x20IP:\x20','trim','\x20\x20\x20💰\x20Total\x20payments\x20turnover:\x20','AdminService','💰\x20[PAYOUT]\x20Merchant\x20','\x20USDT\x20(actual\x20balances)','📊\x20Getting\x20merchant\x20statistics\x20with\x20filters:','\x20\x20\x20📊\x20Commission\x20difference:\x20','$transaction','wallets','adminNotes','hex','\x20\x20\x20🖥️\x20User\x20Agent:\x20','suspendUser','updatedAt','toString','✅\x20Customer\x20data\x20updated\x20for\x20payment\x20','currency','awaitingPayout','customerName','commission','2020-01-01','🔄\x20Gateway\x20mapping\x20(create):','\x20balance\x20updated:\x20','generateDailyStatistics','🔄\x20Converted\x20gateway\x20ID\x20\x27','\x20USDT\x20from\x20balance','telegramId','🎯\x20[','\x20became\x20PAID:','2205126mrTDWb',',\x20calculated\x20would\x20be:\x20','⚠️\x20[STATISTICS]\x20NO\x20SAVED\x20VALUE\x20-\x20Calculating\x20commission\x20for\x20legacy\x20payment\x20',']\x20Password\x20not\x20provided\x20or\x20empty,\x20skipping\x20password\x20update','orderId','periodTo','not\x20set','klyme_eu','asc','0000','split','shopId','week','rapyd','create','default','581WcTmQN','\x20\x20\x20📅\x20Total\x20payouts\x20(this\x20month):\x20','getDate','📊\x20Getting\x20payments\x20with\x20filters:','\x20\x20\x20Current\x20balance:\x20','\x20\x20\x20💸\x20Total\x20payouts\x20(all\x20time):\x20','\x20\x20\x20Balance:\x20','entries','round','\x20\x20\x20Transaction\x20hash:\x20','🔍\x20[DEBUG]\x20First\x203\x20payments\x20amountAfterGatewayCommissionUSDT\x20values:','\x20payments)','🔧\x20[','getPaymentById','getMerchantStatistics','parse','usdtErcWallet','klyme_de','getFullYear','includes','username','pendingPayout','sk_','paymentGateways','\x20no\x20longer\x20PAID:','dateTo','password','totalAmountAfterCommissionUSDT','reduce','🔥\x20[STATISTICS]\x20Saved\x20value:\x20','custom','%\x20from\x20','summary','\x20USDT\x20(without\x20commission)','\x20balance\x20updated:','customerIp','turnoverUSDT','set','8yGzGYb','txid','\x20missing\x20amountUSDT,\x20using\x20fallback\x20conversion','_sum','⚠️\x20Requested\x20gateway\x20\x27','toISOString','amountAfterCommissionUSDT','2542626nKkvmz','🔄\x20Updating\x20customer\x20data\x20for\x20payment\x20','__esModule',']\x20Gateway\x20settings\x20JSON\x20string:','6484260zFtspA','usdtPolygonWallet','📊\x20Gateway\x20filter\x20applied:','paidAt','toFixed','getGatewayInternalName','%\x20commission)','balance','📊\x20Available\x20gateways\x20in\x20database:','\x20\x20\x20👤\x20Merchant\x20earnings:\x20','pk_','getPayoutStats','💰\x20Creating\x20payout\x20for\x20shop\x20','amount','desc','createdAt','💱\x20Currency\x20filter\x20applied:\x20','📊\x20Merchants\x20awaiting\x20payout:\x20','\x20active\x20merchants\x20for\x20selection','join','\x20->\x20','payment','\x20\x20\x20Gateway:\x20','5556tQzOAT','\x27\x20->\x20ID\x20\x27','notes','averageCheckUSDT','\x20\x20\x20Current\x20total\x20paid\x20out:\x20','251348esjUfD','\x20PAID\x20payments',':\x20commission\x20=\x20','getAllUsers','gatewaySettings','Telegram\x20username\x20already\x20exists','Insufficient\x20balance.\x20Available:\x20','📊\x20Payout\x20statistics\x20calculated:','\x20USDT\x20(+','amountUSDT','Plisio','Error\x20parsing\x20gateway\x20settings\x20for\x20shop\x20','turnover','SUSPENDED','\x20status:\x20','toUpperCase','error','gatewayEarnings','Open\x20Banking\x202',']\x20Gateway\x20settings\x20before\x20saving:','forEach','253649sWcGXr','🎯\x20updateUser\x20called\x20with\x20ID:\x20','values','\x20USDT\x20(after\x20',']\x20Updating\x20password\x20for\x20user\x20','hash','status','📊\x20Merchant\x20statistics\x20calculated:','\x20(gateway:\x20','length','merchantUrl','🔄\x20Admin\x20updating\x20payment\x20','trc20','\x20\x20\x20🌍\x20Country:\x20','\x20to\x20','getGatewayNameById','usdcPolygonWallet','shopUrl','\x20\x20\x20💰\x20Total\x20turnover:\x20','polygon','\x20USDT\x20(gateway:\x20','statusChangedBy','📅\x20Period\x20\x27all\x27:\x20Using\x20start\x20date\x20from\x20first\x20payment:\x20','map','aggregate','paidOutUSDT','MasterCard','🔍\x20Using\x20gateway\x20\x27','revenue','\x20order','getGatewayDisplayName','groupBy','customerUa','updateUser','📅\x20Period:\x20','crypto','../types/gateway','\x20USDT\x20(after\x20payouts)','💰\x20Current\x20shop\x20balance:\x20','📊\x20[ADMIN]\x20Calculating\x20commission\x20manually\x20for\x20payment\x20','erc20','some','\x20\x20\x20Merchant\x20gets:\x20','month','💸\x20CHARGEBACK:\x20Merchant\x20amount\x20already\x20deducted\x20from\x20balance','getPayoutById','\x20\x20\x20Full\x20amount:\x20','commissionUSDT','createPayout','getAllPayouts','💰\x20[PAYOUT]\x20Gateway\x20','periodFrom','\x20\x20\x20Merchant\x20loses:\x20','\x20\x20\x20🔍\x20Raw\x20balance\x20sum:\x20','📊\x20Sorting\x20payments\x20by\x20','telegram','getMonth','amountAfterGatewayCommissionUSDT','CoinToPay','klyme_gb','NONEXISTENT_GATEWAY_FILTER','totalPaidOut','\x20\x20\x20�📊\x20Total\x20payments:\x20','merchantEarningsUSDT','log','mastercard','💰\x20Found\x20','getTime','insensitive','💰\x20Payment\x20','\x20\x20\x20📅\x20This\x20month:\x20','toLowerCase','fullName','successUrl',',\x20successful:\x20','./currencyService','getUserById','\x20\x20\x20🏪\x20Gateway\x20earnings:\x20',',\x20Commission:\x20','1693356nyPDPZ','⚠️\x20Payment\x20','getDay','Shop\x20not\x20found','update','updatePaymentStatus','\x20\x20\x20✅\x20Total\x20available\x20for\x20payout:\x20','publicKey','_count','🔄\x20Gateway\x20mapping\x20(get):','Error\x20parsing\x20gateway\x20settings\x20for\x20payment\x20','gateways','\x20\x20\x20�\x20Total\x20payments\x20turnover:\x20'];a35_0x2bb7=function(){return _0x596b76;};return a35_0x2bb7();}class AdminService{async[a35_0x4212b0(0x27b)](){const _0x4229ae=a35_0x4212b0;console[_0x4229ae(0x2e1)]('📊\x20Calculating\x20payout\x20statistics...');const _0x5c0f50=await database_1[_0x4229ae(0x23e)]['shop'][_0x4229ae(0x2b9)]({'_sum':{'balance':!![],'totalPaidOut':!![]},'where':{'status':'ACTIVE'}}),_0x27a602=await this['getMerchantsAwaitingPayout']({'page':0x1,'limit':0x3e8}),_0x45fef4=await database_1[_0x4229ae(0x23e)][_0x4229ae(0x285)][_0x4229ae(0x1e3)]({'where':{'status':_0x4229ae(0x319),'gateway':{'not':'test_gateway'}}}),_0x3e59ca=new Date(),_0x20b757=new Date(_0x3e59ca[_0x4229ae(0x251)](),_0x3e59ca['getMonth'](),0x1),_0x152bbb=new Date(_0x3e59ca['getFullYear'](),_0x3e59ca[_0x4229ae(0x2d9)]()+0x1,0x0,0x17,0x3b,0x3b,0x3e7),_0x2d1520=await database_1[_0x4229ae(0x23e)][_0x4229ae(0x1f5)][_0x4229ae(0x2b9)]({'_sum':{'amount':!![]},'where':{'createdAt':{'gte':_0x20b757,'lte':_0x152bbb},'status':_0x4229ae(0x31d)}}),_0xc5f66=_0x5c0f50[_0x4229ae(0x268)][_0x4229ae(0x2de)]||0x0,_0x1eff4b=_0x27a602[_0x4229ae(0x25f)]['totalAmountAfterCommissionUSDT'],_0x219444=_0x2d1520[_0x4229ae(0x268)][_0x4229ae(0x27d)]||0x0,_0xbd5394={'totalPayout':Math[_0x4229ae(0x247)](_0xc5f66*0x64)/0x64,'awaitingPayout':Math['round'](_0x1eff4b*0x64)/0x64,'thisMonth':Math['round'](_0x219444*0x64)/0x64,'availableBalance':Math['round'](_0x1eff4b*0x64)/0x64,'totalPayments':_0x45fef4};return console[_0x4229ae(0x2e1)](_0x4229ae(0x293)),console[_0x4229ae(0x2e1)]('\x20\x20\x20💰\x20Total\x20payout:\x20'+_0xbd5394['totalPayout']+'\x20USDT\x20(total\x20paid\x20to\x20merchants)'),console[_0x4229ae(0x2e1)](_0x4229ae(0x31c)+_0xbd5394[_0x4229ae(0x223)]+'\x20USDT\x20(with\x20commission\x20deducted)'),console[_0x4229ae(0x2e1)](_0x4229ae(0x20f)+_0xbd5394[_0x4229ae(0x1fa)]+'\x20USDT\x20(same\x20as\x20awaiting)'),console[_0x4229ae(0x2e1)](_0x4229ae(0x2e7)+_0xbd5394[_0x4229ae(0x306)]+_0x4229ae(0x1f4)),console[_0x4229ae(0x2e1)]('\x20\x20\x20💳\x20Total\x20payments:\x20'+_0xbd5394[_0x4229ae(0x30b)]+_0x4229ae(0x28d)),console[_0x4229ae(0x2e1)](_0x4229ae(0x2d6)+(_0x5c0f50[_0x4229ae(0x268)][_0x4229ae(0x277)]||0x0)['toFixed'](0x2)+_0x4229ae(0x260)),console[_0x4229ae(0x2e1)](_0x4229ae(0x218)+((_0x5c0f50[_0x4229ae(0x268)][_0x4229ae(0x277)]||0x0)-_0x1eff4b)[_0x4229ae(0x274)](0x2)+_0x4229ae(0x1f4)),_0xbd5394;}async[a35_0x4212b0(0x1ec)](_0x12566e,_0xe407c3){const _0x530116=a35_0x4212b0;console[_0x530116(0x2e1)](_0x530116(0x26d)+_0x12566e+':',_0xe407c3);const _0x3fe082=await database_1[_0x530116(0x23e)][_0x530116(0x285)][_0x530116(0x324)]({'where':{'id':_0x12566e},'select':{'id':!![],'customerEmail':!![],'customerName':!![],'customerCountry':!![],'customerIp':!![],'customerUa':!![]}});if(!_0x3fe082)throw new Error(_0x530116(0x31f));const _0x3ecfc2={};_0xe407c3[_0x530116(0x1f7)]!==undefined&&(_0x3ecfc2[_0x530116(0x1f7)]=_0xe407c3[_0x530116(0x1f7)]||null);_0xe407c3[_0x530116(0x262)]!==undefined&&(_0x3ecfc2[_0x530116(0x262)]=_0xe407c3[_0x530116(0x262)]||null);_0xe407c3['customerUa']!==undefined&&(_0x3ecfc2[_0x530116(0x2c1)]=_0xe407c3[_0x530116(0x2c1)]||null);const _0x1ae730=await database_1[_0x530116(0x23e)][_0x530116(0x285)][_0x530116(0x2f4)]({'where':{'id':_0x12566e},'data':{..._0x3ecfc2,'updatedAt':new Date()},'select':{'id':!![],'customerEmail':!![],'customerName':!![],'customerCountry':!![],'customerIp':!![],'customerUa':!![],'updatedAt':!![]}});return console[_0x530116(0x2e1)](_0x530116(0x221)+_0x12566e),console[_0x530116(0x2e1)](_0x530116(0x2ae)+_0x3fe082['customerCountry']+_0x530116(0x284)+_0x1ae730[_0x530116(0x1f7)]),console[_0x530116(0x2e1)](_0x530116(0x211)+_0x3fe082['customerIp']+_0x530116(0x284)+_0x1ae730['customerIp']),console[_0x530116(0x2e1)](_0x530116(0x21d)+(_0x3fe082['customerUa']?_0x530116(0x264):_0x530116(0x235))+'\x20->\x20'+(_0x1ae730['customerUa']?_0x530116(0x264):_0x530116(0x235))),_0x1ae730;}async[a35_0x4212b0(0x31a)](_0xc4812a){const _0x43d293=a35_0x4212b0,_0x53490b=new Date();let _0x5f319b;switch(_0xc4812a){case'7d':_0x5f319b=new Date(_0x53490b[_0x43d293(0x2e4)]()-0x7*0x18*0x3c*0x3c*0x3e8);break;case'30d':_0x5f319b=new Date(_0x53490b[_0x43d293(0x2e4)]()-0x1e*0x18*0x3c*0x3c*0x3e8);break;case _0x43d293(0x1f1):_0x5f319b=new Date(_0x53490b['getTime']()-0x5a*0x18*0x3c*0x3c*0x3e8);break;case _0x43d293(0x20e):const _0x5f19c0=await database_1['default'][_0x43d293(0x285)][_0x43d293(0x1eb)]({'where':{'gateway':{'not':_0x43d293(0x312)}},'orderBy':{'createdAt':_0x43d293(0x237)},'select':{'createdAt':!![]}});_0x5f319b=_0x5f19c0?_0x5f19c0[_0x43d293(0x27f)]:new Date(_0x43d293(0x226)),console[_0x43d293(0x2e1)](_0x43d293(0x2b7)+_0x5f319b['toISOString']());break;default:_0x5f319b=new Date(_0x53490b['getTime']()-0x1e*0x18*0x3c*0x3c*0x3e8);}const [_0x5daa13,_0x2b43a0,_0x5e19c4,_0x3002c6,_0x501edd,_0x141095,_0x279748]=await Promise[_0x43d293(0x20e)]([database_1['default'][_0x43d293(0x315)][_0x43d293(0x1e3)](),database_1[_0x43d293(0x23e)][_0x43d293(0x315)]['count']({'where':{'status':_0x43d293(0x207)}}),database_1[_0x43d293(0x23e)][_0x43d293(0x285)][_0x43d293(0x1e3)]({'where':{'createdAt':{'gte':_0x5f319b},'gateway':{'not':_0x43d293(0x312)}}}),database_1[_0x43d293(0x23e)][_0x43d293(0x285)][_0x43d293(0x1e3)]({'where':{'status':'PAID','createdAt':{'gte':_0x5f319b},'gateway':{'not':_0x43d293(0x312)}}}),database_1['default']['payment'][_0x43d293(0x205)]({'where':{'status':'PAID','createdAt':{'gte':_0x5f319b},'gateway':{'not':_0x43d293(0x312)}},'select':{'amount':!![],'currency':!![]}}),database_1[_0x43d293(0x23e)]['payment'][_0x43d293(0x205)]({'where':{'gateway':{'not':_0x43d293(0x312)}},'take':0xa,'orderBy':{'createdAt':_0x43d293(0x27e)},'include':{'shop':{'select':{'name':!![],'username':!![]}}}}),database_1[_0x43d293(0x23e)][_0x43d293(0x285)]['findMany']({'where':{'createdAt':{'gte':_0x5f319b},'gateway':{'not':_0x43d293(0x312)}},'select':{'amount':!![],'currency':!![],'status':!![],'amountUSDT':!![],'createdAt':!![]}})]);let _0x5ab6b3=0x0;for(const _0x4cb2eb of _0x501edd){const _0x222607=await currencyService_1[_0x43d293(0x201)]['convertToUSDT'](_0x4cb2eb[_0x43d293(0x27d)],_0x4cb2eb[_0x43d293(0x222)]);_0x5ab6b3+=_0x222607;}const _0x1c25f1=this[_0x43d293(0x229)](_0x279748,_0x5f319b,_0x53490b),_0x257a06=_0x5e19c4>0x0?_0x3002c6/_0x5e19c4*0x64:0x0;return{'totalShops':_0x5daa13,'activeShops':_0x2b43a0,'totalPayments':_0x5e19c4,'successfulPayments':_0x3002c6,'totalRevenue':Math[_0x43d293(0x247)](_0x5ab6b3*0x64)/0x64,'conversionRate':Math['round'](_0x257a06*0x64)/0x64,'dailyRevenue':_0x1c25f1[_0x43d293(0x1f6)],'dailyPayments':_0x1c25f1[_0x43d293(0x1df)],'recentPayments':_0x141095[_0x43d293(0x2b8)](_0x2058bd=>({'id':_0x2058bd['id'],'amount':_0x2058bd[_0x43d293(0x27d)],'currency':_0x2058bd[_0x43d293(0x222)],'status':_0x2058bd[_0x43d293(0x2a7)],'gateway':_0x2058bd[_0x43d293(0x302)],'shop':_0x2058bd['shop'],'createdAt':_0x2058bd[_0x43d293(0x27f)]}))};}async[a35_0x4212b0(0x24d)](_0x2d1219){const _0x17820f=a35_0x4212b0;console[_0x17820f(0x2e1)](_0x17820f(0x217),_0x2d1219);let _0x5a1e6e,_0x5324ea=new Date();if(_0x2d1219['period']===_0x17820f(0x25d)&&_0x2d1219['dateFrom']&&_0x2d1219[_0x17820f(0x258)])_0x5a1e6e=new Date(_0x2d1219['dateFrom']),_0x5324ea=new Date(_0x2d1219['dateTo']);else{const _0x4c86d4=new Date();switch(_0x2d1219['period']){case _0x17820f(0x23b):const _0x3cea65=_0x4c86d4[_0x17820f(0x2f2)](),_0x318912=_0x3cea65===0x0?0x6:_0x3cea65-0x1;_0x5a1e6e=new Date(_0x4c86d4[_0x17820f(0x2e4)]()-_0x318912*0x18*0x3c*0x3c*0x3e8),_0x5a1e6e[_0x17820f(0x311)](0x0,0x0,0x0,0x0);break;case _0x17820f(0x2cc):_0x5a1e6e=new Date(_0x4c86d4[_0x17820f(0x251)](),_0x4c86d4[_0x17820f(0x2d9)](),0x1);break;case'year':_0x5a1e6e=new Date(_0x4c86d4[_0x17820f(0x251)](),0x0,0x1);break;case _0x17820f(0x20e):default:_0x5a1e6e=new Date(_0x17820f(0x226));break;}}console[_0x17820f(0x2e1)](_0x17820f(0x2c3)+_0x5a1e6e[_0x17820f(0x26a)]()+_0x17820f(0x2af)+_0x5324ea[_0x17820f(0x26a)]());const _0x303211={'status':_0x17820f(0x319),'gateway':{'not':_0x17820f(0x312)},'paidAt':{'gte':_0x5a1e6e,'lte':_0x5324ea}};_0x2d1219[_0x17820f(0x23a)]&&(_0x303211[_0x17820f(0x23a)]=_0x2d1219[_0x17820f(0x23a)]);const _0x3e8065=await database_1['default'][_0x17820f(0x285)][_0x17820f(0x205)]({'where':_0x303211,'include':{'shop':{'select':{'id':!![],'name':!![],'username':!![],'gatewaySettings':!![]}}}});console[_0x17820f(0x2e1)](_0x17820f(0x2e3)+_0x3e8065[_0x17820f(0x2aa)]+_0x17820f(0x20a)),console[_0x17820f(0x2e1)](_0x17820f(0x249),_0x3e8065['slice'](0x0,0x3)[_0x17820f(0x2b8)](_0x47e821=>({'id':_0x47e821['id'],'gateway':_0x47e821[_0x17820f(0x302)],'amountUSDT':_0x47e821[_0x17820f(0x295)],'amountAfterGatewayCommissionUSDT':_0x47e821[_0x17820f(0x2da)]})));const _0x1c8dc8={'gateway':{'not':_0x17820f(0x312)},'createdAt':{'gte':_0x5a1e6e,'lte':_0x5324ea}};_0x2d1219[_0x17820f(0x23a)]&&(_0x1c8dc8['shopId']=_0x2d1219[_0x17820f(0x23a)]);const _0x454265=await database_1[_0x17820f(0x23e)][_0x17820f(0x285)][_0x17820f(0x1e3)]({'where':_0x1c8dc8});console[_0x17820f(0x2e1)]('📊\x20Total\x20payments\x20(including\x20failed):\x20'+_0x454265+_0x17820f(0x2eb)+_0x3e8065[_0x17820f(0x2aa)]);let _0x5c42c4=0x0,_0x3ccb72=0x0,_0x400011=0x0;const _0x235277={},_0x1d1343={},_0x3e57ee={};for(const _0x29aa01 of _0x3e8065){try{const _0x5ef3ed=await currencyService_1[_0x17820f(0x201)]['convertToUSDT'](_0x29aa01[_0x17820f(0x27d)],_0x29aa01['currency']);let _0x2755d3={};if(_0x29aa01[_0x17820f(0x315)][_0x17820f(0x290)])try{_0x2755d3=JSON['parse'](_0x29aa01[_0x17820f(0x315)]['gatewaySettings']);}catch(_0x3fb49c){console['error'](_0x17820f(0x297)+_0x29aa01[_0x17820f(0x23a)]+':',_0x3fb49c);}let _0x15645e={},_0x256401=0xa;for(const [_0x15b24b,_0x6c8f72]of Object[_0x17820f(0x246)](_0x2755d3)){if(_0x15b24b[_0x17820f(0x2e8)]()===_0x29aa01[_0x17820f(0x302)][_0x17820f(0x2e8)]()){_0x15645e=_0x6c8f72,_0x256401=_0x6c8f72[_0x17820f(0x225)]||0xa;break;}}let _0x4da4e5,_0x38b473;_0x29aa01[_0x17820f(0x2da)]!==null&&_0x29aa01[_0x17820f(0x2da)]!==undefined?(_0x4da4e5=_0x29aa01[_0x17820f(0x2da)],_0x38b473=_0x5ef3ed-_0x4da4e5,console[_0x17820f(0x2e1)]('�\x20[STATISTICS]\x20Using\x20saved\x20historical\x20commission:\x20'+_0x4da4e5['toFixed'](0x6)+'\x20USDT\x20for\x20payment\x20'+_0x29aa01['id']+_0x17820f(0x2a9)+_0x29aa01[_0x17820f(0x302)]+')'),console[_0x17820f(0x2e1)](_0x17820f(0x25c)+_0x29aa01['amountAfterGatewayCommissionUSDT']+_0x17820f(0x230)+(_0x5ef3ed*(0x1-_0x256401/0x64))['toFixed'](0x6))):(_0x38b473=_0x5ef3ed*(_0x256401/0x64),_0x4da4e5=_0x5ef3ed-_0x38b473,console[_0x17820f(0x2e1)](_0x17820f(0x231)+_0x29aa01['id']+':\x20'+_0x256401+_0x17820f(0x25e)+_0x5ef3ed[_0x17820f(0x274)](0x6)+_0x17820f(0x2b5)+_0x29aa01[_0x17820f(0x302)]+')'));_0x5c42c4+=_0x5ef3ed,_0x3ccb72+=_0x4da4e5,_0x400011+=_0x38b473;!_0x235277[_0x29aa01[_0x17820f(0x302)]]&&(_0x235277[_0x29aa01[_0x17820f(0x302)]]={'gateway':_0x29aa01[_0x17820f(0x302)],'gatewayDisplayName':this[_0x17820f(0x2bf)](_0x29aa01[_0x17820f(0x302)]),'paymentsCount':0x0,'turnoverUSDT':0x0,'commissionUSDT':0x0,'merchantEarningsUSDT':0x0,'totalCommissionRate':0x0});_0x235277[_0x29aa01[_0x17820f(0x302)]][_0x17820f(0x326)]++,_0x235277[_0x29aa01[_0x17820f(0x302)]][_0x17820f(0x263)]+=_0x5ef3ed,_0x235277[_0x29aa01[_0x17820f(0x302)]][_0x17820f(0x2d0)]+=_0x38b473,_0x235277[_0x29aa01[_0x17820f(0x302)]]['merchantEarningsUSDT']+=_0x4da4e5,_0x235277[_0x29aa01[_0x17820f(0x302)]][_0x17820f(0x1fc)]+=_0x256401;!_0x2d1219[_0x17820f(0x23a)]&&(!_0x1d1343[_0x29aa01[_0x17820f(0x23a)]]&&(_0x1d1343[_0x29aa01[_0x17820f(0x23a)]]={'shopId':_0x29aa01[_0x17820f(0x23a)],'shopName':_0x29aa01[_0x17820f(0x315)][_0x17820f(0x1fb)],'shopUsername':_0x29aa01[_0x17820f(0x315)][_0x17820f(0x253)],'paymentsCount':0x0,'turnoverUSDT':0x0,'commissionUSDT':0x0,'merchantEarningsUSDT':0x0,'paidOutUSDT':0x0,'averageCheckUSDT':0x0}),_0x1d1343[_0x29aa01[_0x17820f(0x23a)]][_0x17820f(0x326)]++,_0x1d1343[_0x29aa01['shopId']][_0x17820f(0x263)]+=_0x5ef3ed,_0x1d1343[_0x29aa01[_0x17820f(0x23a)]][_0x17820f(0x2d0)]+=_0x38b473,_0x1d1343[_0x29aa01[_0x17820f(0x23a)]][_0x17820f(0x2e0)]+=_0x4da4e5);const _0x28cf5f=_0x29aa01[_0x17820f(0x273)][_0x17820f(0x26a)]()['split']('T')[0x0];!_0x3e57ee[_0x28cf5f]&&(_0x3e57ee[_0x28cf5f]={'date':_0x28cf5f,'turnover':0x0,'merchantEarnings':0x0,'gatewayEarnings':0x0,'paymentsCount':0x0}),_0x3e57ee[_0x28cf5f][_0x17820f(0x298)]+=_0x5ef3ed,_0x3e57ee[_0x28cf5f][_0x17820f(0x1e9)]+=_0x4da4e5,_0x3e57ee[_0x28cf5f]['gatewayEarnings']+=_0x38b473,_0x3e57ee[_0x28cf5f]['paymentsCount']++;}catch(_0x51d814){console['error'](_0x17820f(0x303)+_0x29aa01['id']+':',_0x51d814);}}Object['values'](_0x235277)[_0x17820f(0x2a0)](_0x2b0d06=>{const _0x1ff6c0=_0x17820f;_0x2b0d06['averageCommissionRate']=_0x2b0d06[_0x1ff6c0(0x326)]>0x0?_0x2b0d06[_0x1ff6c0(0x1fc)]/_0x2b0d06[_0x1ff6c0(0x326)]:0x0,delete _0x2b0d06['totalCommissionRate'];}),Object[_0x17820f(0x2a3)](_0x1d1343)[_0x17820f(0x2a0)](_0x333cc2=>{const _0x2d078f=_0x17820f;_0x333cc2[_0x2d078f(0x28a)]=_0x333cc2[_0x2d078f(0x326)]>0x0?_0x333cc2['turnoverUSDT']/_0x333cc2[_0x2d078f(0x326)]:0x0;});let _0x4ef87c=0x0,_0x4ba330=0x0;if(_0x2d1219[_0x17820f(0x23a)]){const _0x46b6ae=await database_1[_0x17820f(0x23e)][_0x17820f(0x1f5)][_0x17820f(0x205)]({'where':{'shopId':_0x2d1219['shopId'],'status':_0x17820f(0x31d),'createdAt':{'gte':_0x5a1e6e,'lte':_0x5324ea}},'select':{'amount':!![]}});_0x4ef87c=_0x46b6ae[_0x17820f(0x25b)]((_0x97774c,_0x43de14)=>_0x97774c+_0x43de14[_0x17820f(0x27d)],0x0);const _0x1a64ea=await database_1[_0x17820f(0x23e)]['payout'][_0x17820f(0x205)]({'where':{'shopId':_0x2d1219[_0x17820f(0x23a)],'status':_0x17820f(0x200),'createdAt':{'gte':_0x5a1e6e,'lte':_0x5324ea}},'select':{'amount':!![]}});_0x4ba330=_0x1a64ea[_0x17820f(0x25b)]((_0x4c4aad,_0x1918ad)=>_0x4c4aad+_0x1918ad['amount'],0x0);}const _0x2c3260=_0x454265,_0x1e41de=_0x3e8065[_0x17820f(0x2aa)],_0x3bac35=_0x1e41de>0x0?_0x5c42c4/_0x1e41de:0x0,_0x4ba844=_0x2c3260>0x0?Math['round'](_0x1e41de/_0x2c3260*0x2710)/0x64:0x0,_0x2bd807=Math[_0x17820f(0x2fe)]((_0x5324ea['getTime']()-_0x5a1e6e[_0x17820f(0x2e4)]())/(0x3e8*0x3c*0x3c*0x18)),_0x805673={'totalTurnover':Math[_0x17820f(0x247)](_0x5c42c4*0x64)/0x64,'merchantEarnings':Math[_0x17820f(0x247)](_0x3ccb72*0x64)/0x64,'gatewayEarnings':Math['round'](_0x400011*0x64)/0x64,'totalPaidOut':Math[_0x17820f(0x247)](_0x4ef87c*0x64)/0x64,'pendingPayout':Math[_0x17820f(0x247)](_0x4ba330*0x64)/0x64,'averageCheck':Math[_0x17820f(0x247)](_0x3bac35*0x64)/0x64,'totalPayments':_0x2c3260,'successfulPayments':_0x1e41de,'conversionRate':_0x4ba844,'gatewayBreakdown':Object[_0x17820f(0x2a3)](_0x235277)[_0x17820f(0x2b8)](_0x2eece1=>({..._0x2eece1,'turnoverUSDT':Math[_0x17820f(0x247)](_0x2eece1[_0x17820f(0x263)]*0x64)/0x64,'commissionUSDT':Math['round'](_0x2eece1[_0x17820f(0x2d0)]*0x64)/0x64,'merchantEarningsUSDT':Math[_0x17820f(0x247)](_0x2eece1[_0x17820f(0x2e0)]*0x64)/0x64,'averageCommissionRate':Math[_0x17820f(0x247)](_0x2eece1['averageCommissionRate']*0x64)/0x64})),'merchantBreakdown':_0x2d1219['shopId']?undefined:Object[_0x17820f(0x2a3)](_0x1d1343)[_0x17820f(0x2b8)](_0x40f569=>({..._0x40f569,'turnoverUSDT':Math[_0x17820f(0x247)](_0x40f569[_0x17820f(0x263)]*0x64)/0x64,'commissionUSDT':Math[_0x17820f(0x247)](_0x40f569['commissionUSDT']*0x64)/0x64,'merchantEarningsUSDT':Math[_0x17820f(0x247)](_0x40f569[_0x17820f(0x2e0)]*0x64)/0x64,'paidOutUSDT':Math[_0x17820f(0x247)](_0x40f569[_0x17820f(0x2ba)]*0x64)/0x64,'averageCheckUSDT':Math[_0x17820f(0x247)](_0x40f569[_0x17820f(0x28a)]*0x64)/0x64})),'dailyData':Object[_0x17820f(0x2a3)](_0x3e57ee)['map'](_0x2aab13=>({..._0x2aab13,'turnover':Math[_0x17820f(0x247)](_0x2aab13['turnover']*0x64)/0x64,'merchantEarnings':Math['round'](_0x2aab13[_0x17820f(0x1e9)]*0x64)/0x64,'gatewayEarnings':Math[_0x17820f(0x247)](_0x2aab13[_0x17820f(0x29d)]*0x64)/0x64}))[_0x17820f(0x1ff)]((_0x2e2cb7,_0x4525b3)=>_0x2e2cb7[_0x17820f(0x1e5)]['localeCompare'](_0x4525b3['date'])),'periodInfo':{'from':_0x5a1e6e,'to':_0x5324ea,'periodType':_0x2d1219[_0x17820f(0x30a)]||'custom','daysCount':_0x2bd807}};return console[_0x17820f(0x2e1)](_0x17820f(0x2a8)),console[_0x17820f(0x2e1)](_0x17820f(0x2b3)+_0x805673['totalTurnover']+'\x20USDT'),console[_0x17820f(0x2e1)](_0x17820f(0x279)+_0x805673[_0x17820f(0x1e9)]+_0x17820f(0x1f4)),console['log'](_0x17820f(0x2ee)+_0x805673[_0x17820f(0x29d)]+_0x17820f(0x1f4)),console[_0x17820f(0x2e1)]('\x20\x20\x20�\x20Total\x20paid\x20out:\x20'+_0x805673[_0x17820f(0x2de)]+_0x17820f(0x1f4)),console[_0x17820f(0x2e1)]('\x20\x20\x20⏳\x20Pending\x20payout:\x20'+_0x805673[_0x17820f(0x254)]+_0x17820f(0x1f4)),console[_0x17820f(0x2e1)](_0x17820f(0x2df)+_0x805673[_0x17820f(0x30b)]),_0x805673;}async[a35_0x4212b0(0x1e2)](){const _0x1b4b67=a35_0x4212b0;console['log']('📋\x20Getting\x20merchants\x20selection\x20list...');const _0x3eae51=await database_1['default'][_0x1b4b67(0x315)][_0x1b4b67(0x205)]({'where':{'status':'ACTIVE'},'select':{'id':!![],'username':!![],'name':!![]},'orderBy':{'name':'asc'}});return console[_0x1b4b67(0x2e1)]('📋\x20Found\x20'+_0x3eae51['length']+_0x1b4b67(0x282)),_0x3eae51[_0x1b4b67(0x2b8)](_0x651fbd=>({'id':_0x651fbd['id'],'username':_0x651fbd[_0x1b4b67(0x253)],'name':_0x651fbd['name']}));}[a35_0x4212b0(0x2bf)](_0x3ef744){const _0x5262a9=a35_0x4212b0,_0x2a7d2e={'test_gateway':'Test\x20Gateway','plisio':_0x5262a9(0x296),'rapyd':'Rapyd','noda':'Noda','cointopay':_0x5262a9(0x2db),'cointopay2':_0x5262a9(0x29e),'klyme_eu':'KLYME\x20EU','klyme_gb':'KLYME\x20GB','klyme_de':'KLYME\x20DE','mastercard':_0x5262a9(0x2bb)};return _0x2a7d2e[_0x3ef744]||_0x3ef744;}[a35_0x4212b0(0x275)](_0x4139e8){const _0x3f518e=a35_0x4212b0,_0x1693a2={'Test\x20Gateway':_0x3f518e(0x312),'Plisio':_0x3f518e(0x209),'Rapyd':_0x3f518e(0x23c),'Noda':_0x3f518e(0x31e),'CoinToPay':_0x3f518e(0x1ed),'CoinToPay2':_0x3f518e(0x1e8),'KLYME\x20EU':_0x3f518e(0x236),'KLYME\x20GB':_0x3f518e(0x2dc),'KLYME\x20DE':_0x3f518e(0x250),'MasterCard':_0x3f518e(0x2e2)};return _0x1693a2[_0x4139e8]||_0x4139e8['toLowerCase']();}async[a35_0x4212b0(0x318)](_0xf6548c){const _0x2d6ff1=a35_0x4212b0,{page:_0x3b7f43,limit:_0x333ab0,minAmount:_0x1b8909,search:_0x29526c}=_0xf6548c,_0x31365b=(_0x3b7f43-0x1)*_0x333ab0;console['log'](_0x2d6ff1(0x202),_0xf6548c);const _0x5a1aa4={'balance':{'gt':0x0},'status':_0x2d6ff1(0x207)};_0x1b8909&&(_0x5a1aa4[_0x2d6ff1(0x277)][_0x2d6ff1(0x309)]=_0x1b8909);_0x29526c&&(_0x5a1aa4['OR']=[{'name':{'contains':_0x29526c,'mode':_0x2d6ff1(0x2e5)}},{'username':{'contains':_0x29526c,'mode':_0x2d6ff1(0x2e5)}}]);const [_0x36e889,_0x5556b6]=await Promise[_0x2d6ff1(0x20e)]([database_1[_0x2d6ff1(0x23e)]['shop'][_0x2d6ff1(0x205)]({'where':_0x5a1aa4,'skip':_0x31365b,'take':_0x333ab0,'orderBy':{'balance':_0x2d6ff1(0x27e)},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'balance':!![],'totalPaidOut':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'gatewaySettings':!![],'createdAt':!![]}}),database_1['default'][_0x2d6ff1(0x315)]['count']({'where':_0x5a1aa4})]);console[_0x2d6ff1(0x2e1)](_0x2d6ff1(0x2e3)+_0x36e889[_0x2d6ff1(0x2aa)]+_0x2d6ff1(0x1e0));const _0x16b28c=await Promise['all'](_0x36e889[_0x2d6ff1(0x2b8)](async _0x208248=>{const _0x40670c=_0x2d6ff1,[_0xe8da10,_0x1963e7,_0x5b2023]=await Promise[_0x40670c(0x20e)]([database_1[_0x40670c(0x23e)][_0x40670c(0x285)][_0x40670c(0x1e3)]({'where':{'shopId':_0x208248['id'],'status':_0x40670c(0x319),'gateway':{'not':'test_gateway'}}}),database_1[_0x40670c(0x23e)][_0x40670c(0x285)][_0x40670c(0x1eb)]({'where':{'shopId':_0x208248['id'],'status':_0x40670c(0x319),'gateway':{'not':_0x40670c(0x312)}},'orderBy':{'paidAt':'asc'},'select':{'paidAt':!![]}}),database_1[_0x40670c(0x23e)]['payment'][_0x40670c(0x2c0)]({'by':[_0x40670c(0x302)],'where':{'shopId':_0x208248['id'],'status':_0x40670c(0x319),'gateway':{'not':_0x40670c(0x312)}},'_count':{'id':!![]},'_sum':{'amountUSDT':!![]}})]),_0x310bba=new Date(),_0x3bbd28=new Date(_0x310bba['getFullYear'](),_0x310bba[_0x40670c(0x2d9)](),0x1),_0x5cb074=new Date(_0x310bba['getFullYear'](),_0x310bba[_0x40670c(0x2d9)]()+0x1,0x0,0x17,0x3b,0x3b,0x3e7),[_0x531ae9,_0x41cf5c]=await Promise['all']([database_1[_0x40670c(0x23e)]['payout'][_0x40670c(0x2b9)]({'_sum':{'amount':!![]},'where':{'shopId':_0x208248['id'],'status':_0x40670c(0x31d)}}),database_1[_0x40670c(0x23e)][_0x40670c(0x1f5)]['aggregate']({'_sum':{'amount':!![]},'where':{'shopId':_0x208248['id'],'status':_0x40670c(0x31d),'createdAt':{'gte':_0x3bbd28,'lte':_0x5cb074}}})]),_0x406fc7=_0x531ae9['_sum'][_0x40670c(0x27d)]||0x0,_0x54929c=_0x41cf5c[_0x40670c(0x268)][_0x40670c(0x27d)]||0x0,_0x42a255=await Promise[_0x40670c(0x20e)](_0x5b2023[_0x40670c(0x2b8)](async _0x7e6d35=>{const _0x40183b=_0x40670c;let _0x34db75=0xa;if(_0x208248[_0x40183b(0x290)])try{const _0xaafb40=JSON[_0x40183b(0x24e)](_0x208248['gatewaySettings']);for(const [_0x47e9a5,_0xce0142]of Object[_0x40183b(0x246)](_0xaafb40)){if(_0x47e9a5['toLowerCase']()===_0x7e6d35[_0x40183b(0x302)]['toLowerCase']()){_0x34db75=_0xce0142['commission']||0xa,console[_0x40183b(0x2e1)](_0x40183b(0x2d3)+_0x7e6d35[_0x40183b(0x302)]+_0x40183b(0x1e7)+_0x208248['id']+_0x40183b(0x28e)+_0x34db75+'%');break;}}}catch(_0x16059c){console[_0x40183b(0x29c)](_0x40183b(0x297)+_0x208248['id']+':',_0x16059c);}const _0x1cf30b=_0x7e6d35[_0x40183b(0x268)]?.[_0x40183b(0x295)]||0x0,_0xb6550e=_0x1cf30b*(0x1-_0x34db75/0x64);return{'gateway':_0x7e6d35[_0x40183b(0x302)],'count':_0x7e6d35['_count']?.['id']||0x0,'amountUSDT':Math[_0x40183b(0x247)](_0x1cf30b*0x64)/0x64,'amountAfterCommissionUSDT':Math[_0x40183b(0x247)](_0xb6550e*0x64)/0x64,'commission':_0x34db75};})),_0x1db6a7=_0x42a255[_0x40670c(0x25b)]((_0x1d774b,_0x381baf)=>_0x1d774b+_0x381baf[_0x40670c(0x295)],0x0),_0x52176d=_0x208248[_0x40670c(0x277)];return console[_0x40670c(0x2e1)](_0x40670c(0x215)+_0x208248[_0x40670c(0x253)]+':'),console[_0x40670c(0x2e1)](_0x40670c(0x2fc)+_0x1db6a7['toFixed'](0x2)+_0x40670c(0x301)),console[_0x40670c(0x2e1)]('\x20\x20\x20🔍\x20Calculated\x20after\x20commission:\x20'+_0x42a255[_0x40670c(0x25b)]((_0x3cdf66,_0x1650c9)=>_0x3cdf66+_0x1650c9[_0x40670c(0x26b)],0x0)[_0x40670c(0x274)](0x2)+'\x20USDT\x20(theoretical\x20net)'),console[_0x40670c(0x2e1)]('\x20\x20\x20✅\x20Actual\x20available\x20balance:\x20'+_0x52176d[_0x40670c(0x274)](0x2)+_0x40670c(0x2c6)),{'id':_0x208248['id'],'fullName':_0x208248['name'],'username':_0x208248[_0x40670c(0x253)],'telegramId':_0x208248[_0x40670c(0x2d8)],'merchantUrl':_0x208248[_0x40670c(0x2b2)],'wallets':{'usdtPolygonWallet':_0x208248['usdtPolygonWallet'],'usdtTrcWallet':_0x208248[_0x40670c(0x325)],'usdtErcWallet':_0x208248[_0x40670c(0x24f)],'usdcPolygonWallet':_0x208248[_0x40670c(0x2b1)]},'totalAmountUSDT':Math[_0x40670c(0x247)](_0x1db6a7*0x64)/0x64,'totalAmountAfterCommissionUSDT':Math[_0x40670c(0x247)](_0x52176d*0x64)/0x64,'totalPayout':Math['round'](_0x406fc7*0x64)/0x64,'thisMonth':Math[_0x40670c(0x247)](_0x54929c*0x64)/0x64,'paymentsCount':_0xe8da10,'oldestPaymentDate':_0x1963e7?.[_0x40670c(0x273)]||_0x208248[_0x40670c(0x27f)],'gatewayBreakdown':_0x42a255};})),_0x19e8ca=_0x16b28c['reduce']((_0x514d95,_0x480c00)=>_0x514d95+_0x480c00[_0x2d6ff1(0x310)],0x0),_0x4f4f30=_0x16b28c['reduce']((_0x5ed5c0,_0x46ec60)=>_0x5ed5c0+_0x46ec60[_0x2d6ff1(0x25a)],0x0),_0x30ca23=_0x16b28c['reduce']((_0x55206a,_0x5a0c3b)=>_0x55206a+_0x5a0c3b['totalPayout'],0x0),_0xf3793e=_0x16b28c[_0x2d6ff1(0x25b)]((_0x218fd1,_0x37fcf9)=>_0x218fd1+_0x37fcf9[_0x2d6ff1(0x306)],0x0);return console[_0x2d6ff1(0x2e1)](_0x2d6ff1(0x281)+_0x5556b6+_0x2d6ff1(0x210)),console[_0x2d6ff1(0x2e1)](_0x2d6ff1(0x213)+Math[_0x2d6ff1(0x247)](_0x19e8ca*0x64)/0x64+_0x2d6ff1(0x301)),console[_0x2d6ff1(0x2e1)](_0x2d6ff1(0x2f6)+Math[_0x2d6ff1(0x247)](_0x4f4f30*0x64)/0x64+_0x2d6ff1(0x216)),console[_0x2d6ff1(0x2e1)](_0x2d6ff1(0x244)+Math[_0x2d6ff1(0x247)](_0x30ca23*0x64)/0x64+'\x20USDT'),console[_0x2d6ff1(0x2e1)](_0x2d6ff1(0x240)+Math[_0x2d6ff1(0x247)](_0xf3793e*0x64)/0x64+_0x2d6ff1(0x1f4)),{'merchants':_0x16b28c,'pagination':{'page':_0x3b7f43,'limit':_0x333ab0,'total':_0x5556b6,'totalPages':Math[_0x2d6ff1(0x2fe)](_0x5556b6/_0x333ab0)},'summary':{'totalMerchants':_0x5556b6,'totalAmountUSDT':Math[_0x2d6ff1(0x247)](_0x19e8ca*0x64)/0x64,'totalAmountAfterCommissionUSDT':Math[_0x2d6ff1(0x247)](_0x4f4f30*0x64)/0x64,'totalPayout':Math[_0x2d6ff1(0x247)](_0x30ca23*0x64)/0x64,'thisMonth':Math[_0x2d6ff1(0x247)](_0xf3793e*0x64)/0x64}};}async[a35_0x4212b0(0x2d1)](_0x10d652){const _0x39fa47=a35_0x4212b0,{shopId:_0x5685bd,amount:_0x320b05,network:_0x9a7cd0,wallet:_0x3e1e7e,notes:_0x189535,txid:_0x4a3c24,periodFrom:_0x253fcc,periodTo:_0x235dab}=_0x10d652,_0x33a287=await database_1['default'][_0x39fa47(0x219)](async _0xeb534a=>{const _0x3c7941=_0x39fa47,_0x14f9f2=await _0xeb534a[_0x3c7941(0x315)][_0x3c7941(0x324)]({'where':{'id':_0x5685bd},'select':{'id':!![],'name':!![],'username':!![],'balance':!![],'totalPaidOut':!![]}});if(!_0x14f9f2)throw new Error(_0x3c7941(0x2f3));console['log'](_0x3c7941(0x27c)+_0x14f9f2['username']+':'),console[_0x3c7941(0x2e1)](_0x3c7941(0x243)+_0x14f9f2[_0x3c7941(0x277)][_0x3c7941(0x274)](0x6)+'\x20USDT'),console[_0x3c7941(0x2e1)](_0x3c7941(0x30f)+_0x320b05[_0x3c7941(0x274)](0x6)+_0x3c7941(0x1f4)),console[_0x3c7941(0x2e1)](_0x3c7941(0x28b)+_0x14f9f2[_0x3c7941(0x2de)]['toFixed'](0x6)+'\x20USDT');if(_0x4a3c24)console[_0x3c7941(0x2e1)](_0x3c7941(0x248)+_0x4a3c24);if(_0x14f9f2[_0x3c7941(0x277)]<_0x320b05)throw new Error(_0x3c7941(0x292)+_0x14f9f2['balance'][_0x3c7941(0x274)](0x6)+_0x3c7941(0x31b)+_0x320b05[_0x3c7941(0x274)](0x6)+_0x3c7941(0x1f4));let _0x5ac525=_0x3e1e7e;if(!_0x5ac525){const _0x15d452=await _0xeb534a[_0x3c7941(0x315)][_0x3c7941(0x324)]({'where':{'id':_0x5685bd},'select':{'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![]}});if(_0x15d452)switch(_0x9a7cd0){case _0x3c7941(0x2b4):_0x5ac525=_0x15d452[_0x3c7941(0x271)]||undefined;break;case _0x3c7941(0x2ad):_0x5ac525=_0x15d452[_0x3c7941(0x325)]||undefined;break;case _0x3c7941(0x2c9):_0x5ac525=_0x15d452['usdtErcWallet']||undefined;break;case _0x3c7941(0x30c):_0x5ac525=_0x15d452[_0x3c7941(0x2b1)]||undefined;break;}}console[_0x3c7941(0x2e1)](_0x3c7941(0x1ef)+_0x9a7cd0+':\x20'+(_0x5ac525||'not\x20specified'));const _0x278df0=await _0xeb534a[_0x3c7941(0x1f5)]['create']({'data':{'shopId':_0x5685bd,'amount':_0x320b05,'network':_0x9a7cd0,'status':_0x3c7941(0x31d),'txid':_0x4a3c24,'notes':_0x189535,'periodFrom':_0x253fcc?new Date(_0x253fcc):null,'periodTo':_0x235dab?new Date(_0x235dab):null,'createdAt':new Date(),'paidAt':new Date()}}),_0x487d0f=_0x14f9f2[_0x3c7941(0x277)]-_0x320b05,_0x3ff6e2=_0x14f9f2[_0x3c7941(0x2de)]+_0x320b05;return await _0xeb534a[_0x3c7941(0x315)][_0x3c7941(0x2f4)]({'where':{'id':_0x5685bd},'data':{'balance':_0x487d0f,'totalPaidOut':_0x3ff6e2}}),console['log']('💰\x20Shop\x20'+_0x14f9f2['username']+_0x3c7941(0x261)),console[_0x3c7941(0x2e1)](_0x3c7941(0x245)+_0x14f9f2[_0x3c7941(0x277)]['toFixed'](0x6)+_0x3c7941(0x284)+_0x487d0f[_0x3c7941(0x274)](0x6)+'\x20USDT\x20(-'+_0x320b05[_0x3c7941(0x274)](0x6)+')'),console[_0x3c7941(0x2e1)]('\x20\x20\x20Total\x20paid\x20out:\x20'+_0x14f9f2[_0x3c7941(0x2de)][_0x3c7941(0x274)](0x6)+'\x20->\x20'+_0x3ff6e2[_0x3c7941(0x274)](0x6)+_0x3c7941(0x294)+_0x320b05[_0x3c7941(0x274)](0x6)+')'),{'payout':_0x278df0,'shop':_0x14f9f2};});return console[_0x39fa47(0x2e1)]('✅\x20Payout\x20created:\x20'+_0x33a287[_0x39fa47(0x1f5)]['id']+_0x39fa47(0x1e7)+_0x33a287['shop'][_0x39fa47(0x253)]+'\x20('+_0x320b05+_0x39fa47(0x322)),{'id':_0x33a287[_0x39fa47(0x1f5)]['id'],'shopId':_0x33a287[_0x39fa47(0x1f5)]['shopId'],'shopName':_0x33a287['shop'][_0x39fa47(0x1fb)],'shopUsername':_0x33a287[_0x39fa47(0x315)][_0x39fa47(0x253)],'amount':_0x33a287[_0x39fa47(0x1f5)][_0x39fa47(0x27d)],'network':_0x33a287['payout'][_0x39fa47(0x314)],'status':_0x33a287[_0x39fa47(0x1f5)][_0x39fa47(0x2a7)],'txid':_0x33a287['payout'][_0x39fa47(0x266)],'notes':_0x33a287[_0x39fa47(0x1f5)][_0x39fa47(0x289)],'periodFrom':_0x33a287[_0x39fa47(0x1f5)][_0x39fa47(0x2d4)],'periodTo':_0x33a287[_0x39fa47(0x1f5)][_0x39fa47(0x234)],'createdAt':_0x33a287[_0x39fa47(0x1f5)][_0x39fa47(0x27f)],'paidAt':_0x33a287[_0x39fa47(0x1f5)][_0x39fa47(0x273)]};}async[a35_0x4212b0(0x2d2)](_0x618220){const _0x14a0fc=a35_0x4212b0,{page:_0x42641e,limit:_0x2d79e6,shopId:_0x382024,network:_0x11dc22,dateFrom:_0x46b522,dateTo:_0x25dc33,search:_0xb2a53b}=_0x618220,_0x40536d=(_0x42641e-0x1)*_0x2d79e6,_0x2706a0={};_0x382024&&(_0x2706a0[_0x14a0fc(0x23a)]=_0x382024);_0x11dc22&&(_0x2706a0['network']=_0x11dc22);(_0x46b522||_0x25dc33)&&(_0x2706a0['createdAt']={},_0x46b522&&(_0x2706a0[_0x14a0fc(0x27f)]['gte']=new Date(_0x46b522)),_0x25dc33&&(_0x2706a0[_0x14a0fc(0x27f)][_0x14a0fc(0x320)]=new Date(_0x25dc33)));_0xb2a53b&&(_0x2706a0['OR']=[{'shop':{'name':{'contains':_0xb2a53b,'mode':'insensitive'}}},{'shop':{'username':{'contains':_0xb2a53b,'mode':_0x14a0fc(0x2e5)}}},{'notes':{'contains':_0xb2a53b,'mode':_0x14a0fc(0x2e5)}}]);const [_0x6e5ffd,_0x329af8]=await Promise[_0x14a0fc(0x20e)]([database_1[_0x14a0fc(0x23e)][_0x14a0fc(0x1f5)]['findMany']({'where':_0x2706a0,'skip':_0x40536d,'take':_0x2d79e6,'orderBy':{'createdAt':_0x14a0fc(0x27e)},'select':{'id':!![],'shopId':!![],'amount':!![],'network':!![],'status':!![],'txid':!![],'notes':!![],'periodFrom':!![],'periodTo':!![],'createdAt':!![],'paidAt':!![],'shop':{'select':{'name':!![],'username':!![]}}}}),database_1[_0x14a0fc(0x23e)][_0x14a0fc(0x1f5)][_0x14a0fc(0x1e3)]({'where':_0x2706a0})]);return{'payouts':_0x6e5ffd[_0x14a0fc(0x2b8)](_0x55dd28=>({'id':_0x55dd28['id'],'shopId':_0x55dd28['shopId'],'shopName':_0x55dd28['shop']['name'],'shopUsername':_0x55dd28[_0x14a0fc(0x315)][_0x14a0fc(0x253)],'amount':_0x55dd28[_0x14a0fc(0x27d)],'network':_0x55dd28[_0x14a0fc(0x314)],'status':_0x55dd28[_0x14a0fc(0x2a7)],'txid':_0x55dd28[_0x14a0fc(0x266)],'notes':_0x55dd28['notes'],'periodFrom':_0x55dd28[_0x14a0fc(0x2d4)],'periodTo':_0x55dd28[_0x14a0fc(0x234)],'createdAt':_0x55dd28[_0x14a0fc(0x27f)],'paidAt':_0x55dd28[_0x14a0fc(0x273)]})),'pagination':{'page':_0x42641e,'limit':_0x2d79e6,'total':_0x329af8,'totalPages':Math['ceil'](_0x329af8/_0x2d79e6)}};}async[a35_0x4212b0(0x2ce)](_0x223d24){const _0x4456aa=a35_0x4212b0,_0x25d7b8=await database_1[_0x4456aa(0x23e)][_0x4456aa(0x1f5)][_0x4456aa(0x324)]({'where':{'id':_0x223d24},'include':{'shop':{'select':{'name':!![],'username':!![]}}}});if(!_0x25d7b8)return null;return{'id':_0x25d7b8['id'],'shopId':_0x25d7b8[_0x4456aa(0x23a)],'shopName':_0x25d7b8['shop']['name'],'shopUsername':_0x25d7b8['shop'][_0x4456aa(0x253)],'amount':_0x25d7b8['amount'],'network':_0x25d7b8[_0x4456aa(0x314)],'status':_0x25d7b8[_0x4456aa(0x2a7)],'txid':_0x25d7b8['txid'],'notes':_0x25d7b8[_0x4456aa(0x289)],'periodFrom':_0x25d7b8[_0x4456aa(0x2d4)],'periodTo':_0x25d7b8[_0x4456aa(0x234)],'createdAt':_0x25d7b8[_0x4456aa(0x27f)],'paidAt':_0x25d7b8[_0x4456aa(0x273)]};}async[a35_0x4212b0(0x208)](_0x130cd2){const _0x5c92a8=a35_0x4212b0;await database_1[_0x5c92a8(0x23e)][_0x5c92a8(0x1f5)][_0x5c92a8(0x20d)]({'where':{'id':_0x130cd2}});}async[a35_0x4212b0(0x1f8)](_0x106c34){const _0x1391fd=a35_0x4212b0,{page:_0x33caf7,limit:_0x305281,status:_0x4680cf,gateway:_0xae5c95,shopId:_0xf66422,dateFrom:_0x4da14d,dateTo:_0x2513ef,search:_0x4fc875,currency:_0x240977,sortBy:_0x5767f9,sortOrder:_0x287a62}=_0x106c34,_0x2b89e3=(_0x33caf7-0x1)*_0x305281;console[_0x1391fd(0x2e1)](_0x1391fd(0x242),_0x106c34);const _0x2d47c2=await database_1[_0x1391fd(0x23e)][_0x1391fd(0x285)][_0x1391fd(0x2c0)]({'by':[_0x1391fd(0x302)],'_count':{'gateway':!![]}});console['log'](_0x1391fd(0x278),_0x2d47c2[_0x1391fd(0x2b8)](_0x42d23b=>_0x42d23b[_0x1391fd(0x302)]+'\x20('+_0x42d23b[_0x1391fd(0x2f8)][_0x1391fd(0x302)]+_0x1391fd(0x24a)));if(_0xae5c95){const _0x4588a3=_0x2d47c2[_0x1391fd(0x2ca)](_0x17d94b=>_0x17d94b['gateway'][_0x1391fd(0x2e8)]()===_0xae5c95[_0x1391fd(0x2e8)]());!_0x4588a3&&_0xae5c95[_0x1391fd(0x2e8)]()!=='test_gateway'&&console[_0x1391fd(0x2e1)](_0x1391fd(0x269)+_0xae5c95+'\x27\x20not\x20found.\x20Available\x20gateways:\x20'+_0x2d47c2[_0x1391fd(0x2b8)](_0x293412=>_0x293412['gateway'])[_0x1391fd(0x283)](',\x20'));}const _0x58dae0={};_0x4680cf&&(_0x58dae0[_0x1391fd(0x2a7)]=_0x4680cf['toUpperCase']());if(!_0xae5c95)_0x58dae0[_0x1391fd(0x302)]={'not':'test_gateway'};else{if(_0xae5c95&&(_0xae5c95[_0x1391fd(0x2e8)]()===_0x1391fd(0x312)||_0xae5c95===_0x1391fd(0x238)))_0x58dae0[_0x1391fd(0x302)]=_0x1391fd(0x312);else{let _0x10520f=_0xae5c95;const _0x5d8996=(0x0,gateway_1[_0x1391fd(0x2b0)])(_0xae5c95);if(_0x5d8996)_0x10520f=_0x5d8996,console[_0x1391fd(0x2e1)](_0x1391fd(0x22a)+_0xae5c95+_0x1391fd(0x1e6)+_0x10520f+'\x27');else{const _0x47f5a0=(0x0,gateway_1['getGatewayIdByName'])(_0xae5c95);if(_0x47f5a0){const _0xc917cd=(0x0,gateway_1['getGatewayNameById'])(_0x47f5a0);_0xc917cd&&(_0x10520f=_0xc917cd,console[_0x1391fd(0x2e1)](_0x1391fd(0x20c)+_0xae5c95+_0x1391fd(0x288)+_0x47f5a0+'\x27\x20->\x20name\x20\x27'+_0x10520f+'\x27'));}else console[_0x1391fd(0x2e1)](_0x1391fd(0x2bc)+_0xae5c95+_0x1391fd(0x316));}const _0x3a58ec=await database_1['default'][_0x1391fd(0x285)][_0x1391fd(0x1e3)]({'where':{'gateway':_0x10520f['toLowerCase']()},'take':0x1});_0x3a58ec===0x0?(console[_0x1391fd(0x2e1)](_0x1391fd(0x1f3)+_0x10520f+_0x1391fd(0x1f9)+_0xae5c95+_0x1391fd(0x203)),_0x58dae0['gateway']=_0x1391fd(0x2dd)):(_0x58dae0[_0x1391fd(0x302)]=_0x10520f[_0x1391fd(0x2e8)](),console[_0x1391fd(0x2e1)]('✅\x20Using\x20gateway\x20filter:\x20\x27'+_0x10520f+_0x1391fd(0x1f9)+_0xae5c95+'\x27)'));}}console[_0x1391fd(0x2e1)](_0x1391fd(0x272),_0x58dae0[_0x1391fd(0x302)]);_0xf66422&&(_0x58dae0['shopId']=_0xf66422);_0x240977&&(_0x58dae0[_0x1391fd(0x222)]=_0x240977[_0x1391fd(0x29b)](),console[_0x1391fd(0x2e1)](_0x1391fd(0x280)+_0x240977[_0x1391fd(0x29b)]()));(_0x4da14d||_0x2513ef)&&(_0x58dae0[_0x1391fd(0x27f)]={},_0x4da14d&&(_0x58dae0[_0x1391fd(0x27f)]['gte']=new Date(_0x4da14d)),_0x2513ef&&(_0x58dae0[_0x1391fd(0x27f)][_0x1391fd(0x320)]=new Date(_0x2513ef)));_0x4fc875&&(_0x58dae0['OR']=[{'id':{'contains':_0x4fc875,'mode':_0x1391fd(0x2e5)}},{'orderId':{'contains':_0x4fc875,'mode':'insensitive'}},{'gatewayOrderId':{'contains':_0x4fc875,'mode':_0x1391fd(0x2e5)}},{'customerEmail':{'contains':_0x4fc875,'mode':_0x1391fd(0x2e5)}},{'shop':{'name':{'contains':_0x4fc875,'mode':_0x1391fd(0x2e5)}}},{'shop':{'username':{'contains':_0x4fc875,'mode':_0x1391fd(0x2e5)}}}]);console['log'](_0x1391fd(0x1de),JSON[_0x1391fd(0x300)](_0x58dae0,null,0x2));let _0x31e0e7={'createdAt':_0x1391fd(0x27e)};if(_0x5767f9){const _0x41dc54=[_0x1391fd(0x27d),_0x1391fd(0x27f),_0x1391fd(0x21f),_0x1391fd(0x2a7),_0x1391fd(0x302),_0x1391fd(0x222)],_0x34e1fd=[_0x1391fd(0x237),_0x1391fd(0x27e)];if(_0x41dc54[_0x1391fd(0x252)](_0x5767f9)){const _0x263fec=_0x34e1fd[_0x1391fd(0x252)](_0x287a62)?_0x287a62:_0x1391fd(0x27e);_0x31e0e7={[_0x5767f9]:_0x263fec},console[_0x1391fd(0x2e1)](_0x1391fd(0x2d7)+_0x5767f9+'\x20in\x20'+_0x263fec+_0x1391fd(0x2be));}}const [_0x1e0b00,_0x5e7bb9]=await Promise[_0x1391fd(0x20e)]([database_1['default'][_0x1391fd(0x285)][_0x1391fd(0x205)]({'where':_0x58dae0,'skip':_0x2b89e3,'take':_0x305281,'orderBy':_0x31e0e7,'include':{'shop':{'select':{'name':!![],'username':!![]}}}}),database_1[_0x1391fd(0x23e)][_0x1391fd(0x285)][_0x1391fd(0x1e3)]({'where':_0x58dae0})]);return{'payments':_0x1e0b00,'pagination':{'page':_0x33caf7,'limit':_0x305281,'total':_0x5e7bb9,'totalPages':Math[_0x1391fd(0x2fe)](_0x5e7bb9/_0x305281)}};}async[a35_0x4212b0(0x24c)](_0x2d093c){const _0x410b85=a35_0x4212b0,_0x53b021=await database_1[_0x410b85(0x23e)]['payment'][_0x410b85(0x324)]({'where':{'id':_0x2d093c},'include':{'shop':{'select':{'name':!![],'username':!![]}}}});if(!_0x53b021)return null;return{'id':_0x53b021['id'],'shopId':_0x53b021[_0x410b85(0x23a)],'gateway':_0x53b021[_0x410b85(0x302)],'amount':_0x53b021[_0x410b85(0x27d)],'currency':_0x53b021['currency'],'status':_0x53b021[_0x410b85(0x2a7)],'orderId':_0x53b021[_0x410b85(0x233)],'gatewayOrderId':_0x53b021[_0x410b85(0x308)],'customerEmail':_0x53b021[_0x410b85(0x1fe)],'customerName':_0x53b021[_0x410b85(0x224)],'customerCountry':_0x53b021[_0x410b85(0x1f7)],'customerIp':_0x53b021['customerIp'],'customerUa':_0x53b021['customerUa'],'failureMessage':_0x53b021['failureMessage'],'externalPaymentUrl':_0x53b021['externalPaymentUrl'],'successUrl':_0x53b021[_0x410b85(0x2ea)],'failUrl':_0x53b021['failUrl'],'pendingUrl':_0x53b021[_0x410b85(0x317)],'whiteUrl':_0x53b021[_0x410b85(0x1f2)],'createdAt':_0x53b021[_0x410b85(0x27f)],'updatedAt':_0x53b021['updatedAt'],'shop':_0x53b021[_0x410b85(0x315)]};}async[a35_0x4212b0(0x2f5)](_0x5363c0,_0x2ef1cb,_0x2e32e1,_0x3f661b){const _0x29e5fe=a35_0x4212b0,_0x7c9b63=await database_1[_0x29e5fe(0x23e)]['$transaction'](async _0x554e92=>{const _0x331460=_0x29e5fe,_0x4aeb9e=await _0x554e92[_0x331460(0x285)][_0x331460(0x324)]({'where':{'id':_0x5363c0},'include':{'shop':{'select':{'id':!![],'name':!![],'username':!![],'balance':!![]}}}});if(!_0x4aeb9e)throw new Error(_0x331460(0x31f));const _0x37cffb=_0x4aeb9e[_0x331460(0x2a7)],_0x5baa2c=_0x2ef1cb[_0x331460(0x29b)]();console['log'](_0x331460(0x2ac)+_0x5363c0+_0x331460(0x29a)+_0x37cffb+_0x331460(0x284)+_0x5baa2c),console[_0x331460(0x2e1)](_0x331460(0x2c7)+_0x4aeb9e[_0x331460(0x315)][_0x331460(0x277)]+'\x20USDT');const _0x354147={'status':_0x5baa2c,'updatedAt':new Date(),'statusChangedBy':_0x331460(0x1ee),'statusChangedAt':new Date()};_0x2e32e1&&(_0x354147[_0x331460(0x21b)]=_0x2e32e1);_0x5baa2c==='CHARGEBACK'&&_0x3f661b&&(_0x354147[_0x331460(0x2ff)]=_0x3f661b);let _0x6a6d37=0x0,_0x474b7b=_0x4aeb9e[_0x331460(0x315)][_0x331460(0x277)];if(_0x5baa2c===_0x331460(0x319)&&_0x37cffb!==_0x331460(0x319)){_0x354147[_0x331460(0x273)]=new Date();const _0x2a80d6=await currencyService_1[_0x331460(0x201)][_0x331460(0x30d)](_0x4aeb9e[_0x331460(0x27d)],_0x4aeb9e[_0x331460(0x222)]);_0x354147[_0x331460(0x295)]=_0x2a80d6;let _0x55f3f8=0xa;const _0xb8fbe3=await _0x554e92['shop'][_0x331460(0x324)]({'where':{'id':_0x4aeb9e[_0x331460(0x23a)]},'select':{'gatewaySettings':!![]}});if(_0xb8fbe3?.[_0x331460(0x290)])try{const _0x16af57=JSON['parse'](_0xb8fbe3[_0x331460(0x290)]);for(const [_0x20262b,_0x31ea2c]of Object[_0x331460(0x246)](_0x16af57)){if(_0x20262b[_0x331460(0x2e8)]()===_0x4aeb9e[_0x331460(0x302)]['toLowerCase']()){_0x55f3f8=_0x31ea2c['commission']||0xa;break;}}}catch(_0x3e582d){console['error'](_0x331460(0x2fa)+_0x5363c0+':',_0x3e582d);}let _0x561d9f;_0x4aeb9e[_0x331460(0x2da)]!==null&&_0x4aeb9e[_0x331460(0x2da)]!==undefined?(_0x561d9f=_0x4aeb9e['amountAfterGatewayCommissionUSDT'],console[_0x331460(0x2e1)](_0x331460(0x1ea)+_0x561d9f[_0x331460(0x274)](0x6)+'\x20USDT\x20for\x20payment\x20'+_0x5363c0)):(_0x561d9f=_0x2a80d6*(0x1-_0x55f3f8/0x64),console[_0x331460(0x2e1)](_0x331460(0x2c8)+_0x5363c0+':\x20'+_0x55f3f8+'%\x20from\x20'+_0x2a80d6['toFixed'](0x6)+_0x331460(0x1f4)),_0x354147[_0x331460(0x2da)]=_0x561d9f),_0x6a6d37=_0x561d9f,_0x474b7b+=_0x561d9f,console[_0x331460(0x2e1)](_0x331460(0x2e6)+_0x5363c0+_0x331460(0x22e)),console[_0x331460(0x2e1)](_0x331460(0x2cf)+_0x2a80d6['toFixed'](0x6)+_0x331460(0x1f4)),console['log'](_0x331460(0x286)+_0x4aeb9e[_0x331460(0x302)]+_0x331460(0x2ef)+_0x55f3f8+'%'),console[_0x331460(0x2e1)](_0x331460(0x2cb)+_0x561d9f['toFixed'](0x6)+_0x331460(0x2a4)+_0x55f3f8+_0x331460(0x276)),console['log']('\x20\x20\x20Added\x20to\x20balance:\x20+'+_0x561d9f[_0x331460(0x274)](0x6)+'\x20USDT');}else{if(_0x37cffb===_0x331460(0x319)&&_0x5baa2c!=='PAID'){if(_0x4aeb9e['amountUSDT']){let _0x5c7f15=0xa;const _0x5b1774=await _0x554e92[_0x331460(0x315)][_0x331460(0x324)]({'where':{'id':_0x4aeb9e[_0x331460(0x23a)]},'select':{'gatewaySettings':!![]}});if(_0x5b1774?.[_0x331460(0x290)])try{const _0x5aabf9=JSON['parse'](_0x5b1774[_0x331460(0x290)]);for(const [_0x4e7f37,_0x466fd7]of Object[_0x331460(0x246)](_0x5aabf9)){if(_0x4e7f37[_0x331460(0x2e8)]()===_0x4aeb9e[_0x331460(0x302)][_0x331460(0x2e8)]()){_0x5c7f15=_0x466fd7['commission']||0xa;break;}}}catch(_0x492811){console['error'](_0x331460(0x2fa)+_0x5363c0+':',_0x492811);}const _0x492d1b=_0x4aeb9e[_0x331460(0x295)]*(0x1-_0x5c7f15/0x64);_0x6a6d37=-_0x492d1b,_0x474b7b-=_0x492d1b,_0x354147['amountUSDT']=null,_0x354147['amountAfterGatewayCommissionUSDT']=null,console['log'](_0x331460(0x2e6)+_0x5363c0+_0x331460(0x257)),console[_0x331460(0x2e1)](_0x331460(0x2cf)+_0x4aeb9e['amountUSDT'][_0x331460(0x274)](0x6)+_0x331460(0x1f4)),console[_0x331460(0x2e1)](_0x331460(0x286)+_0x4aeb9e['gateway']+',\x20Commission:\x20'+_0x5c7f15+'%'),console['log'](_0x331460(0x2d5)+_0x492d1b['toFixed'](0x6)+_0x331460(0x2a4)+_0x5c7f15+_0x331460(0x276)),console[_0x331460(0x2e1)](_0x331460(0x1e4)+_0x492d1b[_0x331460(0x274)](0x6)+_0x331460(0x1f4));}}}_0x5baa2c==='CHARGEBACK'&&(_0x37cffb===_0x331460(0x319)&&_0x4aeb9e[_0x331460(0x295)]&&console[_0x331460(0x2e1)](_0x331460(0x2cd)),_0x3f661b&&_0x3f661b>0x0&&(_0x6a6d37-=_0x3f661b,_0x474b7b-=_0x3f661b,console[_0x331460(0x2e1)](_0x331460(0x323)+_0x3f661b[_0x331460(0x274)](0x6)+_0x331460(0x22b))));_0x5baa2c===_0x331460(0x2fd)&&_0x37cffb===_0x331460(0x319)&&console[_0x331460(0x2e1)]('🔄\x20REFUND:\x20Payment\x20amount\x20already\x20deducted\x20from\x20balance');const _0x4038b0=await _0x554e92[_0x331460(0x285)][_0x331460(0x2f4)]({'where':{'id':_0x5363c0},'data':_0x354147,'include':{'shop':{'select':{'name':!![],'username':!![]}}}});return _0x6a6d37!==0x0&&(await _0x554e92[_0x331460(0x315)]['update']({'where':{'id':_0x4aeb9e[_0x331460(0x23a)]},'data':{'balance':_0x474b7b}}),console['log'](_0x331460(0x313)+_0x4aeb9e[_0x331460(0x23a)]+_0x331460(0x228)+_0x4aeb9e[_0x331460(0x315)][_0x331460(0x277)]['toFixed'](0x6)+_0x331460(0x284)+_0x474b7b[_0x331460(0x274)](0x6)+'\x20USDT\x20('+(_0x6a6d37>0x0?'+':'')+_0x6a6d37['toFixed'](0x6)+')')),_0x4038b0;});return{'id':_0x7c9b63['id'],'shopId':_0x7c9b63[_0x29e5fe(0x23a)],'gateway':_0x7c9b63[_0x29e5fe(0x302)],'amount':_0x7c9b63['amount'],'currency':_0x7c9b63[_0x29e5fe(0x222)],'status':_0x7c9b63['status'],'orderId':_0x7c9b63[_0x29e5fe(0x233)],'gatewayOrderId':_0x7c9b63[_0x29e5fe(0x308)],'customerEmail':_0x7c9b63[_0x29e5fe(0x1fe)],'customerName':_0x7c9b63[_0x29e5fe(0x224)],'customerCountry':_0x7c9b63[_0x29e5fe(0x1f7)],'customerIp':_0x7c9b63[_0x29e5fe(0x262)],'customerUa':_0x7c9b63[_0x29e5fe(0x2c1)],'failureMessage':_0x7c9b63[_0x29e5fe(0x1e1)],'adminNotes':_0x7c9b63[_0x29e5fe(0x21b)],'chargebackAmount':_0x7c9b63[_0x29e5fe(0x2ff)],'statusChangedBy':_0x7c9b63[_0x29e5fe(0x2b6)],'statusChangedAt':_0x7c9b63['statusChangedAt'],'createdAt':_0x7c9b63[_0x29e5fe(0x27f)],'updatedAt':_0x7c9b63[_0x29e5fe(0x21f)],'shop':_0x7c9b63[_0x29e5fe(0x315)]};}async[a35_0x4212b0(0x2c2)](_0x278940,_0x573644){const _0x2336cc=a35_0x4212b0,_0x3b5311=Math['random']()[_0x2336cc(0x220)](0x24)['substr'](0x2,0x9);console[_0x2336cc(0x2e1)](_0x2336cc(0x2a2)+_0x3b5311+',\x20userId:\x20'+_0x278940);const _0x1c3bc2={..._0x573644};_0x573644[_0x2336cc(0x259)]&&_0x573644[_0x2336cc(0x259)][_0x2336cc(0x212)]()!==''?(console[_0x2336cc(0x2e1)](_0x2336cc(0x30e)+_0x3b5311+_0x2336cc(0x2a5)+_0x278940),_0x1c3bc2[_0x2336cc(0x259)]=await bcryptjs_1['default'][_0x2336cc(0x2a6)](_0x573644[_0x2336cc(0x259)],0xc)):(console[_0x2336cc(0x2e1)](_0x2336cc(0x30e)+_0x3b5311+_0x2336cc(0x232)),delete _0x1c3bc2[_0x2336cc(0x259)]);_0x573644[_0x2336cc(0x2e9)]&&(_0x1c3bc2[_0x2336cc(0x1fb)]=_0x573644[_0x2336cc(0x2e9)],delete _0x1c3bc2[_0x2336cc(0x2e9)]);_0x573644[_0x2336cc(0x22c)]&&(_0x1c3bc2[_0x2336cc(0x2d8)]=_0x573644[_0x2336cc(0x22c)],delete _0x1c3bc2['telegramId']);_0x573644[_0x2336cc(0x2ab)]&&(_0x1c3bc2['shopUrl']=_0x573644['merchantUrl'],delete _0x1c3bc2[_0x2336cc(0x2ab)]);if(_0x573644[_0x2336cc(0x2fb)]){const _0x13aac1=_0x573644[_0x2336cc(0x2fb)][_0x2336cc(0x2b8)](_0x234f90=>this['getGatewayInternalName'](_0x234f90));console[_0x2336cc(0x2e1)](_0x2336cc(0x307),_0x573644['gateways'],'->',_0x13aac1),_0x1c3bc2['paymentGateways']=JSON['stringify'](_0x13aac1),delete _0x1c3bc2['gateways'];}_0x573644[_0x2336cc(0x290)]&&(console[_0x2336cc(0x2e1)](_0x2336cc(0x24b)+_0x3b5311+_0x2336cc(0x29f),_0x573644['gatewaySettings']),_0x1c3bc2['gatewaySettings']=JSON[_0x2336cc(0x300)](_0x573644[_0x2336cc(0x290)]),console[_0x2336cc(0x2e1)](_0x2336cc(0x24b)+_0x3b5311+_0x2336cc(0x26f),_0x1c3bc2[_0x2336cc(0x290)]));_0x573644[_0x2336cc(0x21a)]&&(_0x573644[_0x2336cc(0x21a)]['usdtPolygonWallet']!==undefined&&(_0x1c3bc2[_0x2336cc(0x271)]=_0x573644['wallets'][_0x2336cc(0x271)]||null),_0x573644['wallets'][_0x2336cc(0x325)]!==undefined&&(_0x1c3bc2[_0x2336cc(0x325)]=_0x573644[_0x2336cc(0x21a)][_0x2336cc(0x325)]||null),_0x573644[_0x2336cc(0x21a)][_0x2336cc(0x24f)]!==undefined&&(_0x1c3bc2[_0x2336cc(0x24f)]=_0x573644['wallets']['usdtErcWallet']||null),_0x573644[_0x2336cc(0x21a)][_0x2336cc(0x2b1)]!==undefined&&(_0x1c3bc2['usdcPolygonWallet']=_0x573644[_0x2336cc(0x21a)][_0x2336cc(0x2b1)]||null),delete _0x1c3bc2['wallets']);const _0x216e91=await database_1[_0x2336cc(0x23e)][_0x2336cc(0x315)]['update']({'where':{'id':_0x278940},'data':_0x1c3bc2,'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});return console[_0x2336cc(0x2e1)](_0x2336cc(0x22d)+_0x3b5311+_0x2336cc(0x1f0),_0x216e91[_0x2336cc(0x290)]),{'id':_0x216e91['id'],'fullName':_0x216e91[_0x2336cc(0x1fb)],'username':_0x216e91[_0x2336cc(0x253)],'telegramId':_0x216e91[_0x2336cc(0x2d8)],'merchantUrl':_0x216e91['shopUrl'],'gateways':_0x216e91[_0x2336cc(0x256)]?JSON[_0x2336cc(0x24e)](_0x216e91[_0x2336cc(0x256)]):null,'gatewaySettings':_0x216e91[_0x2336cc(0x290)]?JSON[_0x2336cc(0x24e)](_0x216e91[_0x2336cc(0x290)]):null,'publicKey':_0x216e91[_0x2336cc(0x2f7)],'wallets':{'usdtPolygonWallet':_0x216e91[_0x2336cc(0x271)],'usdtTrcWallet':_0x216e91[_0x2336cc(0x325)],'usdtErcWallet':_0x216e91[_0x2336cc(0x24f)],'usdcPolygonWallet':_0x216e91[_0x2336cc(0x2b1)]},'status':_0x216e91[_0x2336cc(0x2a7)],'createdAt':_0x216e91[_0x2336cc(0x27f)]};}async[a35_0x4212b0(0x21e)](_0x2e253d){const _0xb37756=a35_0x4212b0,_0x3fbac3=await database_1[_0xb37756(0x23e)][_0xb37756(0x315)][_0xb37756(0x2f4)]({'where':{'id':_0x2e253d},'data':{'status':_0xb37756(0x299)},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});return{'id':_0x3fbac3['id'],'fullName':_0x3fbac3[_0xb37756(0x1fb)],'username':_0x3fbac3[_0xb37756(0x253)],'telegramId':_0x3fbac3[_0xb37756(0x2d8)],'merchantUrl':_0x3fbac3['shopUrl'],'gateways':_0x3fbac3[_0xb37756(0x256)]?JSON[_0xb37756(0x24e)](_0x3fbac3[_0xb37756(0x256)]):null,'gatewaySettings':_0x3fbac3[_0xb37756(0x290)]?JSON[_0xb37756(0x24e)](_0x3fbac3['gatewaySettings']):null,'publicKey':_0x3fbac3[_0xb37756(0x2f7)],'wallets':{'usdtPolygonWallet':_0x3fbac3[_0xb37756(0x271)],'usdtTrcWallet':_0x3fbac3[_0xb37756(0x325)],'usdtErcWallet':_0x3fbac3[_0xb37756(0x24f)],'usdcPolygonWallet':_0x3fbac3['usdcPolygonWallet']},'status':_0x3fbac3[_0xb37756(0x2a7)],'createdAt':_0x3fbac3['createdAt']};}async[a35_0x4212b0(0x20b)](_0x40ad5b){const _0x5b91dd=a35_0x4212b0,_0x527fb0=await database_1[_0x5b91dd(0x23e)][_0x5b91dd(0x315)]['update']({'where':{'id':_0x40ad5b},'data':{'status':_0x5b91dd(0x207)},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});return{'id':_0x527fb0['id'],'fullName':_0x527fb0[_0x5b91dd(0x1fb)],'username':_0x527fb0[_0x5b91dd(0x253)],'telegramId':_0x527fb0[_0x5b91dd(0x2d8)],'merchantUrl':_0x527fb0[_0x5b91dd(0x2b2)],'gateways':_0x527fb0[_0x5b91dd(0x256)]?JSON['parse'](_0x527fb0[_0x5b91dd(0x256)]):null,'gatewaySettings':_0x527fb0[_0x5b91dd(0x290)]?JSON[_0x5b91dd(0x24e)](_0x527fb0[_0x5b91dd(0x290)]):null,'publicKey':_0x527fb0[_0x5b91dd(0x2f7)],'wallets':{'usdtPolygonWallet':_0x527fb0[_0x5b91dd(0x271)],'usdtTrcWallet':_0x527fb0[_0x5b91dd(0x325)],'usdtErcWallet':_0x527fb0[_0x5b91dd(0x24f)],'usdcPolygonWallet':_0x527fb0[_0x5b91dd(0x2b1)]},'status':_0x527fb0[_0x5b91dd(0x2a7)],'createdAt':_0x527fb0[_0x5b91dd(0x27f)]};}async[a35_0x4212b0(0x28f)](_0x597e4a){const _0xa33a74=a35_0x4212b0,{page:_0x34415e,limit:_0x4cf349,status:_0x3c5fa4}=_0x597e4a,_0x45fc8f=(_0x34415e-0x1)*_0x4cf349,_0x10e64a={};_0x3c5fa4&&(_0x10e64a['status']=_0x3c5fa4['toUpperCase']());const [_0x9b6f7c,_0x167c73]=await Promise[_0xa33a74(0x20e)]([database_1['default'][_0xa33a74(0x315)][_0xa33a74(0x205)]({'where':_0x10e64a,'skip':_0x45fc8f,'take':_0x4cf349,'orderBy':{'createdAt':_0xa33a74(0x27e)},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}}),database_1[_0xa33a74(0x23e)][_0xa33a74(0x315)][_0xa33a74(0x1e3)]({'where':_0x10e64a})]);return{'users':_0x9b6f7c[_0xa33a74(0x2b8)](_0x2093fe=>{const _0x1c923d=_0xa33a74,_0x539400=_0x2093fe['paymentGateways']?JSON['parse'](_0x2093fe[_0x1c923d(0x256)]):null,_0x5808b4=_0x539400?_0x539400[_0x1c923d(0x2b8)](_0x3e4c6d=>this[_0x1c923d(0x2bf)](_0x3e4c6d)):null;return{'id':_0x2093fe['id'],'fullName':_0x2093fe['name'],'username':_0x2093fe[_0x1c923d(0x253)],'telegramId':_0x2093fe[_0x1c923d(0x2d8)],'merchantUrl':_0x2093fe[_0x1c923d(0x2b2)],'gateways':_0x5808b4,'gatewaySettings':_0x2093fe[_0x1c923d(0x290)]?JSON[_0x1c923d(0x24e)](_0x2093fe[_0x1c923d(0x290)]):null,'publicKey':_0x2093fe[_0x1c923d(0x2f7)],'wallets':{'usdtPolygonWallet':_0x2093fe[_0x1c923d(0x271)],'usdtTrcWallet':_0x2093fe[_0x1c923d(0x325)],'usdtErcWallet':_0x2093fe[_0x1c923d(0x24f)],'usdcPolygonWallet':_0x2093fe[_0x1c923d(0x2b1)]},'status':_0x2093fe[_0x1c923d(0x2a7)],'createdAt':_0x2093fe[_0x1c923d(0x27f)]};}),'pagination':{'page':_0x34415e,'limit':_0x4cf349,'total':_0x167c73,'totalPages':Math[_0xa33a74(0x2fe)](_0x167c73/_0x4cf349)}};}async[a35_0x4212b0(0x2ed)](_0x27341b){const _0x302572=a35_0x4212b0,_0x189a52=await database_1[_0x302572(0x23e)]['shop'][_0x302572(0x324)]({'where':{'id':_0x27341b},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});if(!_0x189a52)return null;const _0x54a002=_0x189a52['paymentGateways']?JSON[_0x302572(0x24e)](_0x189a52[_0x302572(0x256)]):null,_0x1e6917=_0x54a002?_0x54a002[_0x302572(0x2b8)](_0x568061=>this[_0x302572(0x2bf)](_0x568061)):null;return _0x54a002&&_0x1e6917&&console[_0x302572(0x2e1)](_0x302572(0x2f9),_0x54a002,'->',_0x1e6917),{'id':_0x189a52['id'],'fullName':_0x189a52['name'],'username':_0x189a52['username'],'telegramId':_0x189a52[_0x302572(0x2d8)],'merchantUrl':_0x189a52['shopUrl'],'gateways':_0x1e6917,'gatewaySettings':_0x189a52[_0x302572(0x290)]?JSON[_0x302572(0x24e)](_0x189a52[_0x302572(0x290)]):null,'publicKey':_0x189a52[_0x302572(0x2f7)],'wallets':{'usdtPolygonWallet':_0x189a52[_0x302572(0x271)],'usdtTrcWallet':_0x189a52[_0x302572(0x325)],'usdtErcWallet':_0x189a52[_0x302572(0x24f)],'usdcPolygonWallet':_0x189a52[_0x302572(0x2b1)]},'status':_0x189a52['status'],'createdAt':_0x189a52['createdAt']};}async['createUser'](_0x2a7d21){const _0x379a3b=a35_0x4212b0,{fullName:_0x24f3b9,username:_0x5bfeb1,password:_0x1e5e28,telegramId:_0x98d3f4,merchantUrl:_0x5190ed,gateways:_0x2d68e6,gatewaySettings:_0x4e83cf,wallets:_0x17a4f4}=_0x2a7d21,_0x3f47b5=await database_1[_0x379a3b(0x23e)]['shop'][_0x379a3b(0x324)]({'where':{'username':_0x5bfeb1}});if(_0x3f47b5)throw new Error(_0x379a3b(0x206));if(_0x98d3f4){const _0x17fb0f=await database_1[_0x379a3b(0x23e)]['shop'][_0x379a3b(0x324)]({'where':{'telegram':_0x98d3f4}});if(_0x17fb0f)throw new Error(_0x379a3b(0x291));}const _0x1802d=await bcryptjs_1['default']['hash'](_0x1e5e28,0xc),_0xef1360=_0x379a3b(0x27a)+crypto_1[_0x379a3b(0x23e)]['randomBytes'](0x20)[_0x379a3b(0x220)](_0x379a3b(0x21c)),_0x1f2e95=_0x379a3b(0x255)+crypto_1[_0x379a3b(0x23e)]['randomBytes'](0x20)[_0x379a3b(0x220)](_0x379a3b(0x21c)),_0x74aa2b=_0x2d68e6?_0x2d68e6[_0x379a3b(0x2b8)](_0x5f31a6=>this['getGatewayInternalName'](_0x5f31a6)):null;_0x2d68e6&&_0x74aa2b&&console[_0x379a3b(0x2e1)](_0x379a3b(0x227),_0x2d68e6,'->',_0x74aa2b);const _0xf17591=await database_1[_0x379a3b(0x23e)][_0x379a3b(0x315)][_0x379a3b(0x23d)]({'data':{'name':_0x24f3b9,'username':_0x5bfeb1,'password':_0x1802d,'telegram':_0x98d3f4,'shopUrl':_0x5190ed,'paymentGateways':_0x74aa2b?JSON[_0x379a3b(0x300)](_0x74aa2b):null,'gatewaySettings':_0x4e83cf?JSON[_0x379a3b(0x300)](_0x4e83cf):null,'usdtPolygonWallet':_0x17a4f4?.[_0x379a3b(0x271)]||null,'usdtTrcWallet':_0x17a4f4?.[_0x379a3b(0x325)]||null,'usdtErcWallet':_0x17a4f4?.['usdtErcWallet']||null,'usdcPolygonWallet':_0x17a4f4?.[_0x379a3b(0x2b1)]||null,'publicKey':_0xef1360,'secretKey':_0x1f2e95,'status':_0x379a3b(0x207)},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});return{'id':_0xf17591['id'],'fullName':_0xf17591[_0x379a3b(0x1fb)],'username':_0xf17591[_0x379a3b(0x253)],'telegramId':_0xf17591['telegram'],'merchantUrl':_0xf17591[_0x379a3b(0x2b2)],'gateways':_0xf17591['paymentGateways']?JSON[_0x379a3b(0x24e)](_0xf17591[_0x379a3b(0x256)]):null,'gatewaySettings':_0xf17591[_0x379a3b(0x290)]?JSON[_0x379a3b(0x24e)](_0xf17591[_0x379a3b(0x290)]):null,'publicKey':_0xf17591['publicKey'],'wallets':{'usdtPolygonWallet':_0xf17591[_0x379a3b(0x271)],'usdtTrcWallet':_0xf17591[_0x379a3b(0x325)],'usdtErcWallet':_0xf17591[_0x379a3b(0x24f)],'usdcPolygonWallet':_0xf17591['usdcPolygonWallet']},'status':_0xf17591[_0x379a3b(0x2a7)],'createdAt':_0xf17591[_0x379a3b(0x27f)]};}async[a35_0x4212b0(0x1fd)](_0x4ac911){const _0x599e14=a35_0x4212b0;await database_1[_0x599e14(0x23e)][_0x599e14(0x315)][_0x599e14(0x20d)]({'where':{'id':_0x4ac911}});}[a35_0x4212b0(0x229)](_0x5be202,_0x86958f,_0x293344){const _0x4b8c63=a35_0x4212b0,_0x26e76b=new Map(),_0x361f65=new Date(_0x86958f);while(_0x361f65<=_0x293344){const _0x56fbf3=_0x361f65[_0x4b8c63(0x26a)]()[_0x4b8c63(0x239)]('T')[0x0];_0x26e76b[_0x4b8c63(0x264)](_0x56fbf3,{'revenue':0x0,'count':0x0}),_0x361f65['setDate'](_0x361f65[_0x4b8c63(0x241)]()+0x1);}for(const _0x341f7e of _0x5be202){const _0x353684=_0x341f7e[_0x4b8c63(0x27f)][_0x4b8c63(0x26a)]()[_0x4b8c63(0x239)]('T')[0x0],_0x4439cc=_0x26e76b[_0x4b8c63(0x321)](_0x353684);_0x4439cc&&(_0x4439cc[_0x4b8c63(0x1e3)]+=0x1,_0x341f7e[_0x4b8c63(0x2a7)]===_0x4b8c63(0x319)&&(_0x341f7e[_0x4b8c63(0x295)]?_0x4439cc[_0x4b8c63(0x2bd)]+=_0x341f7e['amountUSDT']:console[_0x4b8c63(0x2e1)](_0x4b8c63(0x2f1)+_0x341f7e['id']+_0x4b8c63(0x267))));}const _0x43ba96=[],_0x5392a8=[];for(const [_0x24f9a2,_0x19ba9f]of _0x26e76b){_0x43ba96[_0x4b8c63(0x305)]({'date':_0x24f9a2,'amount':Math[_0x4b8c63(0x247)](_0x19ba9f['revenue']*0x64)/0x64}),_0x5392a8[_0x4b8c63(0x305)]({'date':_0x24f9a2,'count':_0x19ba9f[_0x4b8c63(0x1e3)]});}return{'dailyRevenue':_0x43ba96,'dailyPayments':_0x5392a8};}}exports[a35_0x4212b0(0x214)]=AdminService;