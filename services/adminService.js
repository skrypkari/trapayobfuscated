'use strict';const a40_0x270d1f=a40_0x31c5;(function(_0x4d516a,_0x3847c8){const _0x182ce3=a40_0x31c5,_0x4fdda4=_0x4d516a();while(!![]){try{const _0x29ac0e=-parseInt(_0x182ce3(0x249))/0x1+-parseInt(_0x182ce3(0x304))/0x2*(-parseInt(_0x182ce3(0x2f8))/0x3)+-parseInt(_0x182ce3(0x2ee))/0x4*(parseInt(_0x182ce3(0x277))/0x5)+-parseInt(_0x182ce3(0x224))/0x6+parseInt(_0x182ce3(0x32a))/0x7+-parseInt(_0x182ce3(0x27f))/0x8*(parseInt(_0x182ce3(0x25e))/0x9)+-parseInt(_0x182ce3(0x245))/0xa*(-parseInt(_0x182ce3(0x230))/0xb);if(_0x29ac0e===_0x3847c8)break;else _0x4fdda4['push'](_0x4fdda4['shift']());}catch(_0x46069e){_0x4fdda4['push'](_0x4fdda4['shift']());}}}(a40_0x1718,0xbdd5b));var __importDefault=this&&this[a40_0x270d1f(0x30c)]||function(_0x14a23f){return _0x14a23f&&_0x14a23f['__esModule']?_0x14a23f:{'default':_0x14a23f};};Object[a40_0x270d1f(0x1f5)](exports,a40_0x270d1f(0x2ca),{'value':!![]}),exports[a40_0x270d1f(0x31e)]=void 0x0;function a40_0x1718(){const _0x7f2f79=[',\x20Commission:\x20','groupBy','💰\x20Found\x20','turnoverUSDT','telegram','\x20balance\x20updated:\x20','__esModule','\x27\x20(from\x20\x27','Telegram\x20username\x20already\x20exists','getSystemStatistics','notes','push','day','year','\x20\x20\x20Gateway:\x20','KLYME\x20EU','statusChangedAt','\x20USDT,\x20Difference:\x20','totalAmountAfterCommissionUSDT','date','txid','forEach','gatewaySettings','month','CoinToPay','availableBalance','getUserById','chargebackAmount','merchantEarningsUSDT','📊\x20Calculated\x20commission\x20rate\x20for\x20payment\x20','📋\x20Found\x20','dailyPayments','💱\x20Currency\x20filter\x20applied:\x20','\x20\x20\x20🌍\x20Country:\x20','usdtErcWallet','admin','custom','⚠️\x20Gateway\x20\x27','setDate','asc','stringify','getMonth','4oLpTzP','💰\x20[PAYOUT]\x20Merchant\x20','wallets','📊\x20Using\x20saved\x20commission\x20rate\x20for\x20payment\x20','yesterday','balance','Error\x20processing\x20payment\x20','\x20USDT\x20(','gatewayEarnings','generateDailyStatistics','1211601bRWihY','toISOString','\x20\x20\x20Merchant\x20loses:\x20','💸\x20CHARGEBACK:\x20Processing\x20penalty-only\x20deduction','Error\x20parsing\x20gateway\x20settings\x20for\x20shop\x20','hex','substr','paymentGateways','polygon_usdc','updatedAt','findUnique','revenue','2BafRne','get','\x20\x20\x20Available\x20(number):\x20','orderId','\x20\x20\x20💸\x20Total\x20payouts\x20(all\x20time):\x20','polygon','customerName','📊\x20[ADMIN]\x20Using\x20saved\x20amountAfterGatewayCommissionUSDT:\x20','__importDefault','🔄\x20Gateway\x20mapping\x20(create):','Error\x20parsing\x20gateway\x20settings\x20for\x20payment\x20','failUrl','\x20\x20\x20🌐\x20IP:\x20','customerIp','\x20\x20\x20💰\x20Total\x20payout:\x20','erc20','🔄\x20REFUND:\x20Payment\x20amount\x20already\x20deducted\x20from\x20balance','\x20for\x20shop\x20','💰\x20[PAYOUT]\x20Gateway\x20','currency','updatePaymentStatus','totalPayments','getMerchantsAwaitingPayout','\x20\x20\x20Balance:\x20','externalPaymentUrl','amountAfterGatewayCommissionUSDT','AdminService','_sum','values','shopId','\x20\x20\x20📅\x20This\x20month:\x20','name','findMany','totalPaidOut','klyme_de','all','averageCheckUSDT','\x20status:\x20','3497599igOhqX','commission','amount','gatewayCommissionRate','createdAt','\x20\x20\x20💰\x20Total\x20payments\x20turnover:\x20','📊\x20Using\x20saved\x20values\x20for\x20payment\x20','set','%\x20from\x20','\x20PAID\x20payments','toString','\x20\x20\x20Available\x20(raw):\x20','week','Insufficient\x20balance.\x20Available:\x20','🔄\x20Converted\x20gateway\x20name\x20\x27','📊\x20Final\x20WHERE\x20conditions:','\x20USDT\x20(calculated\x20-\x20payouts\x20-\x20balance)','gateways','getPayoutById','\x20payments)','CHARGEBACK','getTime','\x27\x20->\x20ID\x20\x27','$transaction','default','bcryptjs','Test\x20Gateway','amountUSDT','defineProperty','periodTo','aggregate','setHours','network','gte','hash','getFullYear','toLowerCase','parse','entries','💰\x20Payment\x20',']\x20Password\x20not\x20provided\x20or\x20empty,\x20skipping\x20password\x20update','../types/gateway','⚠️\x20Requested\x20gateway\x20\x27','\x20\x20\x20💰\x20Total\x20turnover:\x20','getMerchantStatistics','round','shop','📊\x20Available\x20gateways\x20in\x20database:','customerEmail','\x20USDT\x20for\x20payment\x20','cointopay','erc20_usdc','💰\x20Payment\x20amount\x20is\x20NOT\x20deducted\x20(chargeback\x20penalty\x20only)','\x20\x20\x20Transaction\x20hash:\x20','📊\x20Getting\x20merchant\x20statistics\x20with\x20filters:','Rapyd','usdtTrcWallet','MasterCard','klyme_gb','merchantUrl','\x20missing\x20amountUSDT,\x20using\x20fallback\x20conversion','deleteUser','Payment\x20not\x20found','\x20USDT\x20(+','klyme_eu','split','length','error','../config/database','\x20\x20\x20Final\x20payout\x20amount\x20used:\x20','thisMonth','noda','\x20\x20\x20💸\x20Total\x20payouts:\x20','totalCommissionRate','status','7588158PiAlrg','usdcErcWallet','PENDING','not\x20specified','\x20active\x20merchants\x20for\x20selection','KLYME\x20GB',']\x20User\x20updated,\x20gatewaySettings\x20from\x20DB:','sort','\x20\x20\x20�\x20Total\x20payments\x20turnover:\x20','fullName','\x20->\x20','paidAt','11VTrgcv','getDate','warn','🔄\x20Admin\x20updating\x20payment\x20','includes','payout','Noda','not\x20set','periodFrom','whiteUrl','totalTurnover','💰\x20Shop\x20','\x20\x20\x20✅\x20Total\x20available\x20for\x20payout:\x20','\x20USDT\x20(same\x20as\x20awaiting)','\x20\x20\x20💵\x20Available\x20balance:\x20','usdcPolygonWallet','\x20\x20\x20Difference:\x20','Username\x20already\x20exists','getGatewayNameById','dateFrom','getGatewayDisplayName','46007890JSLldg','Open\x20Banking\x202','gateway','telegramId','598312CMnOVX','merchantEarnings','\x27\x20not\x20found.\x20Available\x20gateways:\x20','📊\x20Getting\x20merchants\x20awaiting\x20payout\x20with\x20filters:','toFixed','📊\x20[ADMIN]\x20Calculating\x20commission\x20manually\x20for\x20payment\x20','desc','convertToUSDT','🎯\x20updateUser\x20called\x20with\x20ID:\x20','usdtPolygonWallet','\x20USDT\x20(gross\x20revenue)','\x20USDT,\x20merchant:\x20','getAllPayouts','trc20','customerUa',',\x20userId:\x20','\x20balance\x20updated:',':\x20commission\x20=\x20','🔐\x20[','trim','\x20merchants','13334697kGZIPI','getAllPayments','\x20became\x20PAID:','🔍\x20Balance\x20check\x20details:','\x20USDT\x20from\x20balance','🔄\x20Updating\x20customer\x20data\x20for\x20payment\x20','💰\x20Current\x20shop\x20balance:\x20','crypto','turnover','\x20in\x20','\x20\x20\x20✅\x20Actual\x20available\x20balance:\x20','📊\x20Calculating\x20commission\x20manually\x20for\x20payment\x20','📊\x20Total\x20payments\x20(including\x20failed):\x20','paymentsCount','payment','\x20\x20\x20🔍\x20Calculated\x20after\x20commission:\x20','dateTo','mastercard','🔧\x20[',']\x20Updating\x20password\x20for\x20user\x20','some','localeCompare','failureMessage','averageCommissionRate','🎯\x20[','6910560ERQPmd','\x20USDT\x20(total\x20paid\x20to\x20merchants)','\x20\x20\x20Current\x20total\x20paid\x20out:\x20','🔄\x20Gateway\x20mapping\x20(get):','toUpperCase','awaitingPayout','deletePayout','test_gateway','8JYXzjj','paidOutUSDT','🔄\x20Converted\x20gateway\x20ID\x20\x27','\x20has\x20zero\x20or\x20null\x20amountUSDT,\x20skipping...','\x20\x20\x20Current\x20balance:\x20','ceil','shopUrl','successUrl','count','cointopay2','getGatewayInternalName','gatewayOrderId','publicKey','\x20\x20\x20Added\x20to\x20balance:\x20+','\x20paid\x20payments\x20for\x20analysis','COMPLETED','\x20\x20\x20Total\x20paid\x20out:\x20','\x20USDT','\x20\x20\x20Subtracted\x20from\x20balance:\x20-','create','min','\x27\x20as\x20is\x20(not\x20found\x20in\x20mappings)','\x20USDT\x20(after\x20','getAllUsers','\x20\x20\x20Tolerance:\x20','✅\x20Payout\x20created:\x20','\x20\x20\x20⏳\x20Pending\x20payout:\x20','insensitive','password','📊\x20Sorting\x20payments\x20by\x20','reduce','\x20\x20\x20Requested\x20(number):\x20','username','2020-01-01','plisio','\x20\x20\x20📅\x20Total\x20payouts\x20(this\x20month):\x20',']\x20Gateway\x20settings\x20before\x20saving:','📊\x20Getting\x20payments\x20with\x20filters:','log','90d',']\x20Gateway\x20settings\x20JSON\x20string:','\x20USDT\x20(sum\x20of\x20all\x20merchant\x20balances)','updateUser','pendingPayout','totalPayout','\x20\x20\x20🏪\x20Gateway\x20earnings:\x20','activateUser','REFUND','customerCountry','📊\x20Payout\x20statistics\x20calculated:','ACTIVE','\x20order','PAID','\x20merchants\x20with\x20positive\x20balance','KLYME\x20DE','delete','update','\x20\x20\x20⏳\x20Awaiting\x20payout:\x20','period','currencyService','📊\x20Gateway\x20filter\x20applied:','randomBytes','getMerchantsSelection','Shop\x20not\x20found','\x20\x20\x20Full\x20amount:\x20','commissionUSDT','\x20USDT)','lte','map'];a40_0x1718=function(){return _0x7f2f79;};return a40_0x1718();}const database_1=__importDefault(require(a40_0x270d1f(0x21d))),bcryptjs_1=__importDefault(require(a40_0x270d1f(0x1f2))),crypto_1=__importDefault(require(a40_0x270d1f(0x265))),currencyService_1=require('./currencyService'),gateway_1=require(a40_0x270d1f(0x202));function a40_0x31c5(_0x35a67b,_0x33cdb9){const _0x1718bd=a40_0x1718();return a40_0x31c5=function(_0x31c564,_0x27bb9a){_0x31c564=_0x31c564-0x1e2;let _0x330b28=_0x1718bd[_0x31c564];return _0x330b28;},a40_0x31c5(_0x35a67b,_0x33cdb9);}class AdminService{async['getPayoutStats'](){const _0x5bb4f0=a40_0x270d1f;console[_0x5bb4f0(0x2a5)]('📊\x20Calculating\x20payout\x20statistics...');const _0x452a97=await database_1['default'][_0x5bb4f0(0x207)][_0x5bb4f0(0x1f7)]({'_sum':{'balance':!![],'totalPaidOut':!![]},'where':{'status':_0x5bb4f0(0x2b1)}}),_0x78ac66=await database_1[_0x5bb4f0(0x1f1)][_0x5bb4f0(0x26c)][_0x5bb4f0(0x287)]({'where':{'status':_0x5bb4f0(0x2b3),'gateway':{'not':_0x5bb4f0(0x27e)}}}),_0x2d6d80=new Date(),_0x15605b=new Date(_0x2d6d80['getFullYear'](),_0x2d6d80[_0x5bb4f0(0x2ed)](),0x1),_0x2381bd=new Date(_0x2d6d80[_0x5bb4f0(0x1fc)](),_0x2d6d80[_0x5bb4f0(0x2ed)]()+0x1,0x0,0x17,0x3b,0x3b,0x3e7),_0x3bc4d2=await database_1[_0x5bb4f0(0x1f1)][_0x5bb4f0(0x235)][_0x5bb4f0(0x1f7)]({'_sum':{'amount':!![]},'where':{'createdAt':{'gte':_0x15605b,'lte':_0x2381bd},'status':_0x5bb4f0(0x28e)}}),_0x82845c=_0x452a97[_0x5bb4f0(0x31f)][_0x5bb4f0(0x325)]||0x0,_0x29aeca=_0x452a97[_0x5bb4f0(0x31f)][_0x5bb4f0(0x2f3)]||0x0,_0x54adf4=_0x3bc4d2[_0x5bb4f0(0x31f)][_0x5bb4f0(0x32c)]||0x0,_0x67d99a={'totalPayout':Math[_0x5bb4f0(0x206)](_0x82845c*0x64)/0x64,'awaitingPayout':Math[_0x5bb4f0(0x206)](_0x29aeca*0x64)/0x64,'thisMonth':Math[_0x5bb4f0(0x206)](_0x54adf4*0x64)/0x64,'availableBalance':Math[_0x5bb4f0(0x206)](_0x29aeca*0x64)/0x64,'totalPayments':_0x78ac66};return console[_0x5bb4f0(0x2a5)](_0x5bb4f0(0x2b0)),console[_0x5bb4f0(0x2a5)](_0x5bb4f0(0x312)+_0x67d99a[_0x5bb4f0(0x2ab)]+_0x5bb4f0(0x278)),console[_0x5bb4f0(0x2a5)](_0x5bb4f0(0x2b8)+_0x67d99a[_0x5bb4f0(0x27c)]+_0x5bb4f0(0x2a8)),console[_0x5bb4f0(0x2a5)](_0x5bb4f0(0x23e)+_0x67d99a[_0x5bb4f0(0x2dd)]+_0x5bb4f0(0x23d)),console[_0x5bb4f0(0x2a5)](_0x5bb4f0(0x322)+_0x67d99a[_0x5bb4f0(0x21f)]+'\x20USDT'),console[_0x5bb4f0(0x2a5)]('\x20\x20\x20💳\x20Total\x20payments:\x20'+_0x67d99a['totalPayments']+_0x5bb4f0(0x1e2)),_0x67d99a;}async['updateCustomerData'](_0x5802de,_0x154309){const _0x3332b5=a40_0x270d1f;console[_0x3332b5(0x2a5)](_0x3332b5(0x263)+_0x5802de+':',_0x154309);const _0x2b809f=await database_1[_0x3332b5(0x1f1)]['payment'][_0x3332b5(0x302)]({'where':{'id':_0x5802de},'select':{'id':!![],'customerEmail':!![],'customerName':!![],'customerCountry':!![],'customerIp':!![],'customerUa':!![]}});if(!_0x2b809f)throw new Error(_0x3332b5(0x217));const _0x4b7a24={};_0x154309[_0x3332b5(0x2af)]!==undefined&&(_0x4b7a24['customerCountry']=_0x154309[_0x3332b5(0x2af)]||null);_0x154309[_0x3332b5(0x311)]!==undefined&&(_0x4b7a24[_0x3332b5(0x311)]=_0x154309['customerIp']||null);_0x154309['customerUa']!==undefined&&(_0x4b7a24[_0x3332b5(0x257)]=_0x154309['customerUa']||null);const _0xaf83c1=await database_1[_0x3332b5(0x1f1)][_0x3332b5(0x26c)][_0x3332b5(0x2b7)]({'where':{'id':_0x5802de},'data':{..._0x4b7a24,'updatedAt':new Date()},'select':{'id':!![],'customerEmail':!![],'customerName':!![],'customerCountry':!![],'customerIp':!![],'customerUa':!![],'updatedAt':!![]}});return console[_0x3332b5(0x2a5)]('✅\x20Customer\x20data\x20updated\x20for\x20payment\x20'+_0x5802de),console[_0x3332b5(0x2a5)](_0x3332b5(0x2e5)+_0x2b809f['customerCountry']+'\x20->\x20'+_0xaf83c1['customerCountry']),console[_0x3332b5(0x2a5)](_0x3332b5(0x310)+_0x2b809f[_0x3332b5(0x311)]+_0x3332b5(0x22e)+_0xaf83c1[_0x3332b5(0x311)]),console[_0x3332b5(0x2a5)]('\x20\x20\x20🖥️\x20User\x20Agent:\x20'+(_0x2b809f[_0x3332b5(0x257)]?_0x3332b5(0x331):_0x3332b5(0x237))+'\x20->\x20'+(_0xaf83c1['customerUa']?_0x3332b5(0x331):_0x3332b5(0x237))),_0xaf83c1;}async[a40_0x270d1f(0x2cd)](_0x308ca1){const _0x1ac10d=a40_0x270d1f,_0xe8b3fd=new Date();let _0x5eea35;switch(_0x308ca1[_0x1ac10d(0x1fd)]()){case _0x1ac10d(0x2d0):_0x5eea35=new Date(_0xe8b3fd[_0x1ac10d(0x1fc)](),_0xe8b3fd[_0x1ac10d(0x2ed)](),_0xe8b3fd[_0x1ac10d(0x231)](),0x0,0x0,0x0,0x0);break;case _0x1ac10d(0x2f2):const _0x55d257=new Date(_0xe8b3fd);_0x55d257[_0x1ac10d(0x2ea)](_0x55d257[_0x1ac10d(0x231)]()-0x1),_0x5eea35=new Date(_0x55d257[_0x1ac10d(0x1fc)](),_0x55d257[_0x1ac10d(0x2ed)](),_0x55d257[_0x1ac10d(0x231)](),0x0,0x0,0x0,0x0);break;case'7d':_0x5eea35=new Date(_0xe8b3fd[_0x1ac10d(0x1ee)]()-0x7*0x18*0x3c*0x3c*0x3e8);break;case'30d':_0x5eea35=new Date(_0xe8b3fd[_0x1ac10d(0x1ee)]()-0x1e*0x18*0x3c*0x3c*0x3e8);break;case _0x1ac10d(0x2a6):_0x5eea35=new Date(_0xe8b3fd['getTime']()-0x5a*0x18*0x3c*0x3c*0x3e8);break;case _0x1ac10d(0x327):const _0x480746=await database_1['default'][_0x1ac10d(0x26c)]['findFirst']({'where':{'gateway':{'not':_0x1ac10d(0x27e)}},'orderBy':{'createdAt':'asc'},'select':{'createdAt':!![]}});_0x5eea35=_0x480746?_0x480746[_0x1ac10d(0x32e)]:new Date(_0x1ac10d(0x2a0));break;default:_0x5eea35=new Date(_0xe8b3fd[_0x1ac10d(0x1ee)]()-0x1e*0x18*0x3c*0x3c*0x3e8);}_0x5eea35[_0x1ac10d(0x1f8)](0x0,0x0,0x0,0x0);let _0x141c44;if(_0x308ca1[_0x1ac10d(0x1fd)]()===_0x1ac10d(0x2f2)){const _0x580022=new Date(_0xe8b3fd);_0x580022[_0x1ac10d(0x2ea)](_0x580022[_0x1ac10d(0x231)]()-0x1),_0x141c44=new Date(_0x580022['getFullYear'](),_0x580022[_0x1ac10d(0x2ed)](),_0x580022['getDate'](),0x17,0x3b,0x3b,0x3e7);}const _0x94c2c4={'gte':_0x5eea35};_0x141c44&&(_0x94c2c4[_0x1ac10d(0x2c2)]=_0x141c44);const [_0x2d3c5f,_0x111895,_0x31ad24,_0x36c837,_0x223fd5,_0x1bd080]=await Promise['all']([database_1['default'][_0x1ac10d(0x207)]['count'](),database_1[_0x1ac10d(0x1f1)][_0x1ac10d(0x207)][_0x1ac10d(0x287)]({'where':{'status':'ACTIVE'}}),database_1[_0x1ac10d(0x1f1)][_0x1ac10d(0x26c)][_0x1ac10d(0x287)]({'where':{'status':_0x1ac10d(0x2b3),'createdAt':_0x94c2c4,'gateway':{'not':'test_gateway'}}}),database_1[_0x1ac10d(0x1f1)]['payment'][_0x1ac10d(0x324)]({'where':{'status':_0x1ac10d(0x2b3),'createdAt':_0x94c2c4,'gateway':{'not':'test_gateway'}},'select':{'amount':!![],'currency':!![],'amountAfterGatewayCommissionUSDT':!![]}}),database_1[_0x1ac10d(0x1f1)][_0x1ac10d(0x26c)][_0x1ac10d(0x324)]({'where':{'gateway':{'not':'test_gateway'}},'take':0xa,'orderBy':{'createdAt':_0x1ac10d(0x24f)},'include':{'shop':{'select':{'name':!![],'username':!![]}}}}),database_1[_0x1ac10d(0x1f1)][_0x1ac10d(0x26c)][_0x1ac10d(0x324)]({'where':{'createdAt':_0x94c2c4,'gateway':{'not':_0x1ac10d(0x27e)}},'select':{'amount':!![],'currency':!![],'status':!![],'amountUSDT':!![],'createdAt':!![]}})]);let _0x1ec1ad=0x0,_0x3dbb7b=0x0;for(const _0x2b4b06 of _0x36c837){const _0x56130e=await currencyService_1[_0x1ac10d(0x2ba)][_0x1ac10d(0x250)](_0x2b4b06[_0x1ac10d(0x32c)],_0x2b4b06[_0x1ac10d(0x317)]);_0x1ec1ad+=_0x56130e;if(_0x2b4b06[_0x1ac10d(0x31d)]){const _0x35471c=await currencyService_1[_0x1ac10d(0x2ba)][_0x1ac10d(0x250)](_0x2b4b06[_0x1ac10d(0x32c)],_0x2b4b06['currency']),_0x28319e=_0x2b4b06[_0x1ac10d(0x31d)],_0x416445=_0x35471c-_0x28319e;_0x3dbb7b+=_0x416445;}}const _0x50bb84=_0x31ad24>0x0?_0x1ec1ad/_0x31ad24:0x0,_0x2c49e3=this[_0x1ac10d(0x2f7)](_0x1bd080,_0x5eea35,_0x141c44||_0xe8b3fd),_0x57c2aa=await database_1[_0x1ac10d(0x1f1)]['payment'][_0x1ac10d(0x287)]({'where':{'createdAt':_0x94c2c4,'gateway':{'not':_0x1ac10d(0x27e)}}}),_0x5a79c5=_0x57c2aa>0x0?_0x31ad24/_0x57c2aa*0x64:0x0;return{'totalShops':_0x2d3c5f,'activeShops':_0x111895,'totalPayments':_0x31ad24,'successfulPayments':_0x31ad24,'totalAttempts':_0x57c2aa,'totalRevenue':Math[_0x1ac10d(0x206)](_0x1ec1ad*0x64)/0x64,'trapayEarnings':Math[_0x1ac10d(0x206)](_0x3dbb7b*0x64)/0x64,'averagePaymentAmount':Math[_0x1ac10d(0x206)](_0x50bb84*0x64)/0x64,'conversionRate':Math[_0x1ac10d(0x206)](_0x5a79c5*0x64)/0x64,'dailyRevenue':_0x2c49e3['dailyRevenue'],'dailyPayments':_0x2c49e3[_0x1ac10d(0x2e3)],'recentPayments':_0x223fd5[_0x1ac10d(0x2c3)](_0x349d8c=>({'id':_0x349d8c['id'],'amount':_0x349d8c[_0x1ac10d(0x32c)],'currency':_0x349d8c[_0x1ac10d(0x317)],'status':_0x349d8c['status'],'gateway':_0x349d8c[_0x1ac10d(0x247)],'shop':_0x349d8c[_0x1ac10d(0x207)],'createdAt':_0x349d8c[_0x1ac10d(0x32e)]}))};}async[a40_0x270d1f(0x205)](_0x2cdf06){const _0x45c3f6=a40_0x270d1f;console[_0x45c3f6(0x2a5)](_0x45c3f6(0x20f),_0x2cdf06);let _0x13a3fe,_0x3b5ff7=new Date();if(_0x2cdf06[_0x45c3f6(0x2b9)]===_0x45c3f6(0x2e8)&&_0x2cdf06['dateFrom']&&_0x2cdf06[_0x45c3f6(0x26e)])_0x13a3fe=new Date(_0x2cdf06[_0x45c3f6(0x243)]),_0x3b5ff7=new Date(_0x2cdf06[_0x45c3f6(0x26e)]),_0x13a3fe[_0x45c3f6(0x1f8)](0x0,0x0,0x0,0x0),_0x3b5ff7[_0x45c3f6(0x1f8)](0x17,0x3b,0x3b,0x3e7);else{const _0x2d75d6=new Date();switch(_0x2cdf06[_0x45c3f6(0x2b9)]){case _0x45c3f6(0x1e5):_0x13a3fe=new Date(_0x2d75d6[_0x45c3f6(0x1ee)]()-0x7*0x18*0x3c*0x3c*0x3e8);break;case _0x45c3f6(0x2db):_0x13a3fe=new Date(_0x2d75d6[_0x45c3f6(0x1ee)]()-0x1e*0x18*0x3c*0x3c*0x3e8);break;case _0x45c3f6(0x2d1):_0x13a3fe=new Date(_0x2d75d6[_0x45c3f6(0x1ee)]()-0x16d*0x18*0x3c*0x3c*0x3e8);break;case'all':default:_0x13a3fe=new Date(_0x45c3f6(0x2a0));break;}_0x13a3fe['setHours'](0x0,0x0,0x0,0x0),_0x3b5ff7[_0x45c3f6(0x1f8)](0x17,0x3b,0x3b,0x3e7);}console[_0x45c3f6(0x2a5)]('📅\x20Period:\x20'+_0x13a3fe[_0x45c3f6(0x2f9)]()+'\x20to\x20'+_0x3b5ff7[_0x45c3f6(0x2f9)]());const _0x4b5d3f={'status':_0x45c3f6(0x2b3),'gateway':{'not':'test_gateway'},'paidAt':{'gte':_0x13a3fe,'lte':_0x3b5ff7}};_0x2cdf06['shopId']&&(_0x4b5d3f[_0x45c3f6(0x321)]=_0x2cdf06['shopId']);const _0x29ffd5=await database_1[_0x45c3f6(0x1f1)][_0x45c3f6(0x26c)][_0x45c3f6(0x324)]({'where':_0x4b5d3f,'select':{'id':!![],'amount':!![],'currency':!![],'amountUSDT':!![],'amountAfterGatewayCommissionUSDT':!![],'gatewayCommissionRate':!![],'gateway':!![],'shopId':!![],'paidAt':!![],'shop':{'select':{'id':!![],'name':!![],'username':!![],'gatewaySettings':!![]}}}});console[_0x45c3f6(0x2a5)](_0x45c3f6(0x2c6)+_0x29ffd5[_0x45c3f6(0x21b)]+_0x45c3f6(0x28d));const _0xcafc54={'gateway':{'not':_0x45c3f6(0x27e)},'createdAt':{'gte':_0x13a3fe,'lte':_0x3b5ff7}};_0x2cdf06['shopId']&&(_0xcafc54[_0x45c3f6(0x321)]=_0x2cdf06[_0x45c3f6(0x321)]);const _0x2b236c=await database_1['default'][_0x45c3f6(0x26c)][_0x45c3f6(0x287)]({'where':_0xcafc54});console[_0x45c3f6(0x2a5)](_0x45c3f6(0x26a)+_0x2b236c+',\x20successful:\x20'+_0x29ffd5[_0x45c3f6(0x21b)]);let _0x3ba62c=0x0,_0x3f6677=0x0,_0x3ee5ac=0x0;const _0x41a4c3={},_0x559b56={},_0x2838e4={};for(const _0x2d5a5c of _0x29ffd5){try{const _0x424bc7=_0x2d5a5c[_0x45c3f6(0x1f4)]||0x0;if(_0x424bc7<=0x0){console[_0x45c3f6(0x232)]('⚠️\x20Payment\x20'+_0x2d5a5c['id']+_0x45c3f6(0x282));continue;}let _0x5a41a4,_0x44d127;if(_0x2d5a5c[_0x45c3f6(0x31d)]!==null&&_0x2d5a5c['amountAfterGatewayCommissionUSDT']!==undefined)_0x5a41a4=_0x2d5a5c[_0x45c3f6(0x31d)],_0x44d127=_0x424bc7-_0x5a41a4,console[_0x45c3f6(0x2a5)](_0x45c3f6(0x330)+_0x2d5a5c['id']+':\x20'+_0x424bc7['toFixed'](0x6)+_0x45c3f6(0x254)+_0x5a41a4[_0x45c3f6(0x24d)](0x6)+'\x20USDT');else{let _0x1e5b21={};if(_0x2d5a5c[_0x45c3f6(0x207)]['gatewaySettings'])try{_0x1e5b21=JSON[_0x45c3f6(0x1fe)](_0x2d5a5c[_0x45c3f6(0x207)][_0x45c3f6(0x2da)]);}catch(_0xa257da){console[_0x45c3f6(0x21c)](_0x45c3f6(0x2fc)+_0x2d5a5c[_0x45c3f6(0x321)]+':',_0xa257da);}let _0x315c18=0x2d;for(const [_0x445af3,_0x3a6859]of Object[_0x45c3f6(0x1ff)](_0x1e5b21)){if(_0x445af3[_0x45c3f6(0x1fd)]()===_0x2d5a5c[_0x45c3f6(0x247)][_0x45c3f6(0x1fd)]()){_0x315c18=_0x3a6859[_0x45c3f6(0x32b)]||0x2d;break;}}_0x44d127=_0x424bc7*(_0x315c18/0x64),_0x5a41a4=_0x424bc7-_0x44d127,console[_0x45c3f6(0x2a5)](_0x45c3f6(0x269)+_0x2d5a5c['id']+':\x20'+_0x315c18+_0x45c3f6(0x332)+_0x424bc7[_0x45c3f6(0x24d)](0x6)+_0x45c3f6(0x290));}_0x3ba62c+=_0x424bc7,_0x3f6677+=_0x5a41a4,_0x3ee5ac+=_0x44d127;let _0x352d74;_0x2d5a5c[_0x45c3f6(0x32d)]!==null&&_0x2d5a5c[_0x45c3f6(0x32d)]!==undefined?(_0x352d74=_0x2d5a5c[_0x45c3f6(0x32d)],console['log'](_0x45c3f6(0x2f1)+_0x2d5a5c['id']+':\x20'+_0x352d74+'%')):(_0x352d74=_0x424bc7>0x0?_0x44d127/_0x424bc7*0x64:0x0,console[_0x45c3f6(0x2a5)](_0x45c3f6(0x2e1)+_0x2d5a5c['id']+':\x20'+_0x352d74['toFixed'](0x2)+'%'));!_0x41a4c3[_0x2d5a5c[_0x45c3f6(0x247)]]&&(_0x41a4c3[_0x2d5a5c[_0x45c3f6(0x247)]]={'gateway':_0x2d5a5c['gateway'],'gatewayDisplayName':this[_0x45c3f6(0x244)](_0x2d5a5c[_0x45c3f6(0x247)]),'paymentsCount':0x0,'turnoverUSDT':0x0,'commissionUSDT':0x0,'merchantEarningsUSDT':0x0,'totalCommissionRate':0x0});_0x41a4c3[_0x2d5a5c['gateway']][_0x45c3f6(0x26b)]++,_0x41a4c3[_0x2d5a5c[_0x45c3f6(0x247)]][_0x45c3f6(0x2c7)]+=_0x424bc7,_0x41a4c3[_0x2d5a5c[_0x45c3f6(0x247)]][_0x45c3f6(0x2c0)]+=_0x44d127,_0x41a4c3[_0x2d5a5c[_0x45c3f6(0x247)]]['merchantEarningsUSDT']+=_0x5a41a4,_0x41a4c3[_0x2d5a5c[_0x45c3f6(0x247)]][_0x45c3f6(0x222)]+=_0x352d74;!_0x2cdf06[_0x45c3f6(0x321)]&&(!_0x559b56[_0x2d5a5c['shopId']]&&(_0x559b56[_0x2d5a5c[_0x45c3f6(0x321)]]={'shopId':_0x2d5a5c[_0x45c3f6(0x321)],'shopName':_0x2d5a5c[_0x45c3f6(0x207)][_0x45c3f6(0x323)],'shopUsername':_0x2d5a5c[_0x45c3f6(0x207)]['username'],'paymentsCount':0x0,'turnoverUSDT':0x0,'commissionUSDT':0x0,'merchantEarningsUSDT':0x0,'paidOutUSDT':0x0,'averageCheckUSDT':0x0}),_0x559b56[_0x2d5a5c[_0x45c3f6(0x321)]][_0x45c3f6(0x26b)]++,_0x559b56[_0x2d5a5c[_0x45c3f6(0x321)]][_0x45c3f6(0x2c7)]+=_0x424bc7,_0x559b56[_0x2d5a5c[_0x45c3f6(0x321)]][_0x45c3f6(0x2c0)]+=_0x44d127,_0x559b56[_0x2d5a5c[_0x45c3f6(0x321)]][_0x45c3f6(0x2e0)]+=_0x5a41a4);const _0x31ed59=_0x2d5a5c[_0x45c3f6(0x22f)][_0x45c3f6(0x2f9)]()['split']('T')[0x0];!_0x2838e4[_0x31ed59]&&(_0x2838e4[_0x31ed59]={'date':_0x31ed59,'turnover':0x0,'merchantEarnings':0x0,'gatewayEarnings':0x0,'paymentsCount':0x0}),_0x2838e4[_0x31ed59]['turnover']+=_0x424bc7,_0x2838e4[_0x31ed59][_0x45c3f6(0x24a)]+=_0x5a41a4,_0x2838e4[_0x31ed59]['gatewayEarnings']+=_0x44d127,_0x2838e4[_0x31ed59][_0x45c3f6(0x26b)]++;}catch(_0x580b8d){console[_0x45c3f6(0x21c)](_0x45c3f6(0x2f4)+_0x2d5a5c['id']+':',_0x580b8d);}}Object['values'](_0x41a4c3)[_0x45c3f6(0x2d9)](_0x4bd4df=>{const _0x40d2c7=_0x45c3f6;_0x4bd4df[_0x40d2c7(0x275)]=_0x4bd4df['paymentsCount']>0x0?_0x4bd4df['totalCommissionRate']/_0x4bd4df[_0x40d2c7(0x26b)]:0x0,delete _0x4bd4df[_0x40d2c7(0x222)];}),Object[_0x45c3f6(0x320)](_0x559b56)[_0x45c3f6(0x2d9)](_0x23b6e8=>{const _0x17e43b=_0x45c3f6;_0x23b6e8[_0x17e43b(0x328)]=_0x23b6e8['paymentsCount']>0x0?_0x23b6e8[_0x17e43b(0x2c7)]/_0x23b6e8[_0x17e43b(0x26b)]:0x0;});let _0x5ace72=0x0,_0x317c75=0x0;if(_0x2cdf06[_0x45c3f6(0x321)]){const _0x1178c2=await database_1[_0x45c3f6(0x1f1)][_0x45c3f6(0x235)]['findMany']({'where':{'shopId':_0x2cdf06[_0x45c3f6(0x321)],'status':_0x45c3f6(0x28e),'createdAt':{'gte':_0x13a3fe,'lte':_0x3b5ff7}},'select':{'amount':!![]}});_0x5ace72=_0x1178c2[_0x45c3f6(0x29d)]((_0x5b9f5c,_0x3ece93)=>_0x5b9f5c+_0x3ece93[_0x45c3f6(0x32c)],0x0);const _0x5130ea=await database_1['default'][_0x45c3f6(0x235)][_0x45c3f6(0x324)]({'where':{'shopId':_0x2cdf06[_0x45c3f6(0x321)],'status':_0x45c3f6(0x226),'createdAt':{'gte':_0x13a3fe,'lte':_0x3b5ff7}},'select':{'amount':!![]}});_0x317c75=_0x5130ea[_0x45c3f6(0x29d)]((_0x567453,_0x617a95)=>_0x567453+_0x617a95[_0x45c3f6(0x32c)],0x0);}const _0x13a651=_0x2b236c,_0x11bac6=_0x29ffd5[_0x45c3f6(0x21b)],_0x51a467=_0x11bac6>0x0?_0x3ba62c/_0x11bac6:0x0,_0x41539e=_0x13a651>0x0?Math[_0x45c3f6(0x206)](_0x11bac6/_0x13a651*0x2710)/0x64:0x0,_0x2330c6=Math[_0x45c3f6(0x284)]((_0x3b5ff7['getTime']()-_0x13a3fe['getTime']())/(0x3e8*0x3c*0x3c*0x18)),_0x526e32={'totalTurnover':Math[_0x45c3f6(0x206)](_0x3ba62c*0x64)/0x64,'merchantEarnings':Math[_0x45c3f6(0x206)](_0x3f6677*0x64)/0x64,'gatewayEarnings':Math[_0x45c3f6(0x206)](_0x3ee5ac*0x64)/0x64,'totalPaidOut':Math[_0x45c3f6(0x206)](_0x5ace72*0x64)/0x64,'pendingPayout':Math['round'](_0x317c75*0x64)/0x64,'averageCheck':Math[_0x45c3f6(0x206)](_0x51a467*0x64)/0x64,'totalPayments':_0x13a651,'successfulPayments':_0x11bac6,'conversionRate':_0x41539e,'gatewayBreakdown':Object['values'](_0x41a4c3)['map'](_0x4fe0cc=>({..._0x4fe0cc,'turnoverUSDT':Math[_0x45c3f6(0x206)](_0x4fe0cc['turnoverUSDT']*0x64)/0x64,'commissionUSDT':Math[_0x45c3f6(0x206)](_0x4fe0cc[_0x45c3f6(0x2c0)]*0x64)/0x64,'merchantEarningsUSDT':Math[_0x45c3f6(0x206)](_0x4fe0cc[_0x45c3f6(0x2e0)]*0x64)/0x64,'averageCommissionRate':Math['round'](_0x4fe0cc['averageCommissionRate']*0x64)/0x64})),'merchantBreakdown':_0x2cdf06[_0x45c3f6(0x321)]?undefined:Object[_0x45c3f6(0x320)](_0x559b56)[_0x45c3f6(0x2c3)](_0x25ee8f=>({..._0x25ee8f,'turnoverUSDT':Math['round'](_0x25ee8f[_0x45c3f6(0x2c7)]*0x64)/0x64,'commissionUSDT':Math['round'](_0x25ee8f[_0x45c3f6(0x2c0)]*0x64)/0x64,'merchantEarningsUSDT':Math[_0x45c3f6(0x206)](_0x25ee8f[_0x45c3f6(0x2e0)]*0x64)/0x64,'paidOutUSDT':Math[_0x45c3f6(0x206)](_0x25ee8f[_0x45c3f6(0x280)]*0x64)/0x64,'averageCheckUSDT':Math[_0x45c3f6(0x206)](_0x25ee8f[_0x45c3f6(0x328)]*0x64)/0x64})),'dailyData':Object[_0x45c3f6(0x320)](_0x2838e4)[_0x45c3f6(0x2c3)](_0x46d174=>({..._0x46d174,'turnover':Math[_0x45c3f6(0x206)](_0x46d174[_0x45c3f6(0x266)]*0x64)/0x64,'merchantEarnings':Math['round'](_0x46d174[_0x45c3f6(0x24a)]*0x64)/0x64,'gatewayEarnings':Math[_0x45c3f6(0x206)](_0x46d174[_0x45c3f6(0x2f6)]*0x64)/0x64}))[_0x45c3f6(0x22b)]((_0x5d3887,_0x37e7ef)=>_0x5d3887[_0x45c3f6(0x2d7)][_0x45c3f6(0x273)](_0x37e7ef[_0x45c3f6(0x2d7)])),'periodInfo':{'from':_0x13a3fe,'to':_0x3b5ff7,'periodType':_0x2cdf06[_0x45c3f6(0x2b9)]||_0x45c3f6(0x2e8),'daysCount':_0x2330c6}};return console['log']('📊\x20Merchant\x20statistics\x20calculated:'),console['log'](_0x45c3f6(0x204)+_0x526e32[_0x45c3f6(0x23a)]+'\x20USDT'),console['log']('\x20\x20\x20👤\x20Merchant\x20earnings:\x20'+_0x526e32[_0x45c3f6(0x24a)]+'\x20USDT'),console[_0x45c3f6(0x2a5)](_0x45c3f6(0x2ac)+_0x526e32['gatewayEarnings']+_0x45c3f6(0x290)),console[_0x45c3f6(0x2a5)]('\x20\x20\x20�\x20Total\x20paid\x20out:\x20'+_0x526e32['totalPaidOut']+_0x45c3f6(0x290)),console[_0x45c3f6(0x2a5)](_0x45c3f6(0x299)+_0x526e32[_0x45c3f6(0x2aa)]+_0x45c3f6(0x290)),console[_0x45c3f6(0x2a5)]('\x20\x20\x20�📊\x20Total\x20payments:\x20'+_0x526e32[_0x45c3f6(0x319)]),_0x526e32;}async[a40_0x270d1f(0x2bd)](){const _0x2473e2=a40_0x270d1f;console['log']('📋\x20Getting\x20merchants\x20selection\x20list...');const _0x40fed7=await database_1['default'][_0x2473e2(0x207)][_0x2473e2(0x324)]({'where':{'status':'ACTIVE'},'select':{'id':!![],'username':!![],'name':!![]},'orderBy':{'name':_0x2473e2(0x2eb)}});return console[_0x2473e2(0x2a5)](_0x2473e2(0x2e2)+_0x40fed7[_0x2473e2(0x21b)]+_0x2473e2(0x228)),_0x40fed7[_0x2473e2(0x2c3)](_0x11da5f=>({'id':_0x11da5f['id'],'username':_0x11da5f[_0x2473e2(0x29f)],'name':_0x11da5f[_0x2473e2(0x323)]}));}[a40_0x270d1f(0x244)](_0x1f00e2){const _0x469017=a40_0x270d1f,_0x55fa87={'test_gateway':_0x469017(0x1f3),'plisio':'Plisio','rapyd':_0x469017(0x210),'noda':_0x469017(0x236),'cointopay':_0x469017(0x2dc),'cointopay2':_0x469017(0x246),'klyme_eu':_0x469017(0x2d3),'klyme_gb':_0x469017(0x229),'klyme_de':_0x469017(0x2b5),'mastercard':_0x469017(0x212)};return _0x55fa87[_0x1f00e2]||_0x1f00e2;}[a40_0x270d1f(0x289)](_0x3f2ee9){const _0x2cfb0d=a40_0x270d1f,_0x42e753={'Test\x20Gateway':_0x2cfb0d(0x27e),'Plisio':_0x2cfb0d(0x2a1),'Rapyd':'rapyd','Noda':_0x2cfb0d(0x220),'CoinToPay':_0x2cfb0d(0x20b),'CoinToPay2':_0x2cfb0d(0x288),'KLYME\x20EU':_0x2cfb0d(0x219),'KLYME\x20GB':_0x2cfb0d(0x213),'KLYME\x20DE':_0x2cfb0d(0x326),'MasterCard':_0x2cfb0d(0x26f)};return _0x42e753[_0x3f2ee9]||_0x3f2ee9[_0x2cfb0d(0x1fd)]();}async[a40_0x270d1f(0x31a)](_0xc61ea7){const _0xd4d7d1=a40_0x270d1f,{page:_0x3c0f00,limit:_0x3071c6,minAmount:_0x22744b,search:_0x14a332}=_0xc61ea7,_0x44c805=(_0x3c0f00-0x1)*_0x3071c6;console[_0xd4d7d1(0x2a5)](_0xd4d7d1(0x24c),_0xc61ea7);const _0x339b4c={'balance':{'gt':0x0},'status':'ACTIVE'};_0x22744b&&(_0x339b4c[_0xd4d7d1(0x2f3)]['gte']=_0x22744b);_0x14a332&&(_0x339b4c[_0xd4d7d1(0x323)]={'contains':_0x14a332,'mode':_0xd4d7d1(0x29a)});const [_0x31e76e,_0x1b2684]=await Promise[_0xd4d7d1(0x327)]([database_1['default'][_0xd4d7d1(0x207)][_0xd4d7d1(0x324)]({'where':_0x339b4c,'skip':_0x44c805,'take':_0x3071c6,'orderBy':{'balance':_0xd4d7d1(0x24f)},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'balance':!![],'totalPaidOut':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'usdcErcWallet':!![],'gatewaySettings':!![],'createdAt':!![]}}),database_1[_0xd4d7d1(0x1f1)][_0xd4d7d1(0x207)][_0xd4d7d1(0x287)]({'where':_0x339b4c})]);console[_0xd4d7d1(0x2a5)]('💰\x20Found\x20'+_0x31e76e[_0xd4d7d1(0x21b)]+_0xd4d7d1(0x2b4));const _0x3361ed=await Promise[_0xd4d7d1(0x327)](_0x31e76e[_0xd4d7d1(0x2c3)](async _0x451f37=>{const _0x499d2d=_0xd4d7d1,[_0x340264,_0x322cc6,_0x1a8a65]=await Promise[_0x499d2d(0x327)]([database_1['default'][_0x499d2d(0x26c)][_0x499d2d(0x287)]({'where':{'shopId':_0x451f37['id'],'status':'PAID','gateway':{'not':_0x499d2d(0x27e)}}}),database_1[_0x499d2d(0x1f1)][_0x499d2d(0x26c)]['findFirst']({'where':{'shopId':_0x451f37['id'],'status':_0x499d2d(0x2b3),'gateway':{'not':_0x499d2d(0x27e)}},'orderBy':{'paidAt':_0x499d2d(0x2eb)},'select':{'paidAt':!![]}}),database_1[_0x499d2d(0x1f1)]['payment']['groupBy']({'by':[_0x499d2d(0x247)],'where':{'shopId':_0x451f37['id'],'status':_0x499d2d(0x2b3),'gateway':{'not':'test_gateway'}},'_count':{'id':!![]},'_sum':{'amountUSDT':!![]}})]),_0x4cabf9=new Date(),_0x30fdf1=new Date(_0x4cabf9[_0x499d2d(0x1fc)](),_0x4cabf9[_0x499d2d(0x2ed)](),0x1),_0x408dc6=new Date(_0x4cabf9[_0x499d2d(0x1fc)](),_0x4cabf9['getMonth']()+0x1,0x0,0x17,0x3b,0x3b,0x3e7),[_0x2119e8,_0x478c8a]=await Promise[_0x499d2d(0x327)]([database_1['default'][_0x499d2d(0x235)][_0x499d2d(0x1f7)]({'_sum':{'amount':!![]},'where':{'shopId':_0x451f37['id'],'status':_0x499d2d(0x28e)}}),database_1[_0x499d2d(0x1f1)]['payout'][_0x499d2d(0x1f7)]({'_sum':{'amount':!![]},'where':{'shopId':_0x451f37['id'],'status':'COMPLETED','createdAt':{'gte':_0x30fdf1,'lte':_0x408dc6}}})]),_0x1e5dc5=_0x2119e8[_0x499d2d(0x31f)][_0x499d2d(0x32c)]||0x0,_0xa5f8db=_0x478c8a[_0x499d2d(0x31f)][_0x499d2d(0x32c)]||0x0,_0x26220a=await Promise['all'](_0x1a8a65[_0x499d2d(0x2c3)](async _0x30fb18=>{const _0x3b5d81=_0x499d2d;let _0x2af099=0x2d;if(_0x451f37['gatewaySettings'])try{const _0x525f1b=JSON['parse'](_0x451f37[_0x3b5d81(0x2da)]);for(const [_0x3d1d37,_0x5cb171]of Object[_0x3b5d81(0x1ff)](_0x525f1b)){if(_0x3d1d37[_0x3b5d81(0x1fd)]()===_0x30fb18['gateway'][_0x3b5d81(0x1fd)]()){_0x2af099=_0x5cb171['commission']||0xa,console[_0x3b5d81(0x2a5)](_0x3b5d81(0x316)+_0x30fb18[_0x3b5d81(0x247)]+_0x3b5d81(0x315)+_0x451f37['id']+_0x3b5d81(0x25a)+_0x2af099+'%');break;}}}catch(_0x2e758f){console['error'](_0x3b5d81(0x2fc)+_0x451f37['id']+':',_0x2e758f);}const _0x33582e=_0x30fb18[_0x3b5d81(0x31f)]?.[_0x3b5d81(0x1f4)]||0x0,_0x4a3cc7=_0x33582e*(0x1-_0x2af099/0x64);return{'gateway':_0x30fb18[_0x3b5d81(0x247)],'count':_0x30fb18['_count']?.['id']||0x0,'amountUSDT':Math['round'](_0x33582e*0x64)/0x64,'amountAfterCommissionUSDT':Math['round'](_0x4a3cc7*0x64)/0x64,'commission':_0x2af099};})),_0x3f8c16=_0x26220a['reduce']((_0x1c08ae,_0x51ba71)=>_0x1c08ae+_0x51ba71[_0x499d2d(0x1f4)],0x0),_0x562734=_0x26220a[_0x499d2d(0x29d)]((_0x55d5a3,_0x5816ca)=>_0x55d5a3+_0x5816ca['amountAfterCommissionUSDT'],0x0),_0x83d941=_0x451f37['balance'];return console[_0x499d2d(0x2a5)](_0x499d2d(0x2ef)+_0x451f37[_0x499d2d(0x29f)]+':'),console[_0x499d2d(0x2a5)](_0x499d2d(0x22c)+_0x3f8c16[_0x499d2d(0x24d)](0x2)+'\x20USDT\x20(gross\x20revenue)'),console[_0x499d2d(0x2a5)](_0x499d2d(0x26d)+_0x562734[_0x499d2d(0x24d)](0x2)+'\x20USDT\x20(theoretical\x20net)'),console[_0x499d2d(0x2a5)](_0x499d2d(0x268)+_0x83d941[_0x499d2d(0x24d)](0x2)+'\x20USDT\x20(current\x20balance\x20in\x20DB)'),console[_0x499d2d(0x2a5)](_0x499d2d(0x221)+_0x1e5dc5[_0x499d2d(0x24d)](0x2)+'\x20USDT\x20(already\x20paid\x20out)'),console['log']('\x20\x20\x20🤔\x20Difference:\x20'+(_0x562734-_0x1e5dc5-_0x83d941)[_0x499d2d(0x24d)](0x2)+_0x499d2d(0x1e9)),{'id':_0x451f37['id'],'fullName':_0x451f37[_0x499d2d(0x323)],'username':_0x451f37[_0x499d2d(0x29f)],'telegramId':_0x451f37[_0x499d2d(0x2c8)],'merchantUrl':_0x451f37['shopUrl'],'wallets':{'usdtPolygonWallet':_0x451f37[_0x499d2d(0x252)],'usdtTrcWallet':_0x451f37[_0x499d2d(0x211)],'usdtErcWallet':_0x451f37[_0x499d2d(0x2e6)],'usdcPolygonWallet':_0x451f37[_0x499d2d(0x23f)],'usdcErcWallet':_0x451f37['usdcErcWallet']},'totalAmountUSDT':Math[_0x499d2d(0x206)](_0x3f8c16*0x64)/0x64,'totalAmountAfterCommissionUSDT':Math[_0x499d2d(0x206)](_0x562734*0x64)/0x64,'currentBalance':Math[_0x499d2d(0x206)](_0x83d941*0x64)/0x64,'totalPayout':Math['round'](_0x1e5dc5*0x64)/0x64,'thisMonth':Math['round'](_0xa5f8db*0x64)/0x64,'paymentsCount':_0x340264,'oldestPaymentDate':_0x322cc6?.['paidAt']||_0x451f37[_0x499d2d(0x32e)],'gatewayBreakdown':_0x26220a};})),_0x2e75f0=_0x3361ed[_0xd4d7d1(0x29d)]((_0x312adf,_0xc44291)=>_0x312adf+_0xc44291['totalAmountUSDT'],0x0),_0x16ae7e=_0x3361ed[_0xd4d7d1(0x29d)]((_0x3acb5b,_0x1ef411)=>_0x3acb5b+_0x1ef411[_0xd4d7d1(0x2d6)],0x0),_0x17328c=_0x3361ed[_0xd4d7d1(0x29d)]((_0x5c919f,_0x310ab5)=>_0x5c919f+_0x310ab5['totalPayout'],0x0),_0x18d94b=_0x3361ed[_0xd4d7d1(0x29d)]((_0x10924d,_0x52c683)=>_0x10924d+_0x52c683[_0xd4d7d1(0x21f)],0x0);return console[_0xd4d7d1(0x2a5)]('📊\x20Merchants\x20awaiting\x20payout:\x20'+_0x1b2684+_0xd4d7d1(0x25d)),console['log'](_0xd4d7d1(0x32f)+Math[_0xd4d7d1(0x206)](_0x2e75f0*0x64)/0x64+_0xd4d7d1(0x253)),console[_0xd4d7d1(0x2a5)](_0xd4d7d1(0x23c)+Math['round'](_0x16ae7e*0x64)/0x64+'\x20USDT\x20(actual\x20balances)'),console[_0xd4d7d1(0x2a5)](_0xd4d7d1(0x308)+Math[_0xd4d7d1(0x206)](_0x17328c*0x64)/0x64+'\x20USDT'),console['log'](_0xd4d7d1(0x2a2)+Math[_0xd4d7d1(0x206)](_0x18d94b*0x64)/0x64+_0xd4d7d1(0x290)),{'merchants':_0x3361ed,'pagination':{'page':_0x3c0f00,'limit':_0x3071c6,'total':_0x1b2684,'totalPages':Math[_0xd4d7d1(0x284)](_0x1b2684/_0x3071c6)},'summary':{'totalMerchants':_0x1b2684,'totalAmountUSDT':Math[_0xd4d7d1(0x206)](_0x2e75f0*0x64)/0x64,'totalAmountAfterCommissionUSDT':Math[_0xd4d7d1(0x206)](_0x16ae7e*0x64)/0x64,'totalPayout':Math['round'](_0x17328c*0x64)/0x64,'thisMonth':Math[_0xd4d7d1(0x206)](_0x18d94b*0x64)/0x64}};}async['createPayout'](_0x23e272){const _0x420d71=a40_0x270d1f,{shopId:_0x415492,amount:_0x1bb0d2,network:_0xd53996,wallet:_0x2ed955,notes:_0x2b9b97,txid:_0x27b3cd,periodFrom:_0x290745,periodTo:_0x3ceb9f}=_0x23e272,_0x16699a=await database_1[_0x420d71(0x1f1)][_0x420d71(0x1f0)](async _0x1a3ae9=>{const _0x53b207=_0x420d71,_0x2938b3=await _0x1a3ae9[_0x53b207(0x207)]['findUnique']({'where':{'id':_0x415492},'select':{'id':!![],'name':!![],'username':!![],'balance':!![],'totalPaidOut':!![]}});if(!_0x2938b3)throw new Error(_0x53b207(0x2be));console[_0x53b207(0x2a5)]('💰\x20Creating\x20payout\x20for\x20shop\x20'+_0x2938b3[_0x53b207(0x29f)]+':'),console[_0x53b207(0x2a5)](_0x53b207(0x283)+_0x2938b3['balance'][_0x53b207(0x24d)](0x6)+_0x53b207(0x290)),console[_0x53b207(0x2a5)]('\x20\x20\x20Payout\x20amount:\x20'+_0x1bb0d2[_0x53b207(0x24d)](0x6)+_0x53b207(0x290)),console['log'](_0x53b207(0x279)+_0x2938b3[_0x53b207(0x325)]['toFixed'](0x6)+'\x20USDT');if(_0x27b3cd)console[_0x53b207(0x2a5)](_0x53b207(0x20e)+_0x27b3cd);const _0x5de911=0.000001,_0x1a37e4=Number(_0x2938b3[_0x53b207(0x2f3)]),_0x25cc39=Number(_0x1bb0d2);console[_0x53b207(0x2a5)](_0x53b207(0x261)),console[_0x53b207(0x2a5)](_0x53b207(0x1e4)+_0x2938b3[_0x53b207(0x2f3)]),console['log'](_0x53b207(0x306)+_0x1a37e4),console[_0x53b207(0x2a5)](_0x53b207(0x29e)+_0x25cc39),console[_0x53b207(0x2a5)](_0x53b207(0x240)+(_0x1a37e4-_0x25cc39)),console[_0x53b207(0x2a5)](_0x53b207(0x297)+_0x5de911);if(_0x1a37e4<_0x25cc39-_0x5de911)throw new Error(_0x53b207(0x1e6)+_0x1a37e4[_0x53b207(0x24d)](0x6)+'\x20USDT,\x20Requested:\x20'+_0x25cc39[_0x53b207(0x24d)](0x6)+_0x53b207(0x2d5)+(_0x1a37e4-_0x25cc39)[_0x53b207(0x24d)](0x8)+'\x20USDT');console[_0x53b207(0x2a5)]('✅\x20Balance\x20check\x20passed\x20(with\x20tolerance)');const _0x517aa2=Math[_0x53b207(0x293)](_0x1a37e4,_0x25cc39);let _0x1a71db=_0x2ed955;if(!_0x1a71db){const _0x4f98bc=await _0x1a3ae9[_0x53b207(0x207)]['findUnique']({'where':{'id':_0x415492},'select':{'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'usdcErcWallet':!![]}});if(_0x4f98bc)switch(_0xd53996){case _0x53b207(0x309):_0x1a71db=_0x4f98bc[_0x53b207(0x252)]||undefined;break;case _0x53b207(0x256):_0x1a71db=_0x4f98bc[_0x53b207(0x211)]||undefined;break;case _0x53b207(0x313):_0x1a71db=_0x4f98bc[_0x53b207(0x2e6)]||undefined;break;case _0x53b207(0x300):_0x1a71db=_0x4f98bc[_0x53b207(0x23f)]||undefined;break;case _0x53b207(0x20c):_0x1a71db=_0x4f98bc[_0x53b207(0x225)]||undefined;break;}}console[_0x53b207(0x2a5)]('💳\x20Payout\x20wallet\x20for\x20'+_0xd53996+':\x20'+(_0x1a71db||_0x53b207(0x227)));const _0x3e8877=await _0x1a3ae9[_0x53b207(0x235)][_0x53b207(0x292)]({'data':{'shopId':_0x415492,'amount':_0x517aa2,'network':_0xd53996,'status':'COMPLETED','txid':_0x27b3cd,'notes':_0x2b9b97,'periodFrom':_0x290745?new Date(_0x290745):null,'periodTo':_0x3ceb9f?new Date(_0x3ceb9f):null,'createdAt':new Date(),'paidAt':new Date()}}),_0x5449b4=_0x1a37e4-_0x517aa2,_0x304ad6=Number(_0x2938b3[_0x53b207(0x325)])+_0x517aa2;return await _0x1a3ae9[_0x53b207(0x207)][_0x53b207(0x2b7)]({'where':{'id':_0x415492},'data':{'balance':_0x5449b4,'totalPaidOut':_0x304ad6}}),console[_0x53b207(0x2a5)](_0x53b207(0x23b)+_0x2938b3[_0x53b207(0x29f)]+_0x53b207(0x259)),console[_0x53b207(0x2a5)](_0x53b207(0x31b)+_0x1a37e4[_0x53b207(0x24d)](0x6)+'\x20->\x20'+_0x5449b4['toFixed'](0x6)+'\x20USDT\x20(-'+_0x517aa2['toFixed'](0x6)+')'),console[_0x53b207(0x2a5)](_0x53b207(0x28f)+_0x2938b3['totalPaidOut'][_0x53b207(0x24d)](0x6)+_0x53b207(0x22e)+_0x304ad6[_0x53b207(0x24d)](0x6)+_0x53b207(0x218)+_0x517aa2[_0x53b207(0x24d)](0x6)+')'),console[_0x53b207(0x2a5)](_0x53b207(0x21e)+_0x517aa2[_0x53b207(0x24d)](0x6)+_0x53b207(0x290)),{'payout':_0x3e8877,'shop':_0x2938b3};});return console[_0x420d71(0x2a5)](_0x420d71(0x298)+_0x16699a[_0x420d71(0x235)]['id']+_0x420d71(0x315)+_0x16699a[_0x420d71(0x207)][_0x420d71(0x29f)]+'\x20('+_0x16699a[_0x420d71(0x235)][_0x420d71(0x32c)][_0x420d71(0x24d)](0x6)+_0x420d71(0x2c1)),{'id':_0x16699a[_0x420d71(0x235)]['id'],'shopId':_0x16699a[_0x420d71(0x235)][_0x420d71(0x321)],'shopName':_0x16699a[_0x420d71(0x207)][_0x420d71(0x323)],'shopUsername':_0x16699a[_0x420d71(0x207)]['username'],'amount':_0x16699a[_0x420d71(0x235)][_0x420d71(0x32c)],'network':_0x16699a[_0x420d71(0x235)][_0x420d71(0x1f9)],'status':_0x16699a['payout'][_0x420d71(0x223)],'txid':_0x16699a['payout'][_0x420d71(0x2d8)],'notes':_0x16699a[_0x420d71(0x235)][_0x420d71(0x2ce)],'periodFrom':_0x16699a[_0x420d71(0x235)][_0x420d71(0x238)],'periodTo':_0x16699a['payout']['periodTo'],'createdAt':_0x16699a['payout'][_0x420d71(0x32e)],'paidAt':_0x16699a[_0x420d71(0x235)]['paidAt']};}async[a40_0x270d1f(0x255)](_0xdac7eb){const _0x423c96=a40_0x270d1f,{page:_0x3a44cf,limit:_0x165c15,shopId:_0x504680,network:_0x524f5c,dateFrom:_0x3e5916,dateTo:_0x10f135,search:_0x3ecb8e}=_0xdac7eb,_0x3f08e8=(_0x3a44cf-0x1)*_0x165c15,_0x2068b0={};_0x504680&&(_0x2068b0[_0x423c96(0x321)]=_0x504680);_0x524f5c&&(_0x2068b0[_0x423c96(0x1f9)]=_0x524f5c);(_0x3e5916||_0x10f135)&&(_0x2068b0[_0x423c96(0x32e)]={},_0x3e5916&&(_0x2068b0[_0x423c96(0x32e)][_0x423c96(0x1fa)]=new Date(_0x3e5916)),_0x10f135&&(_0x2068b0['createdAt'][_0x423c96(0x2c2)]=new Date(_0x10f135)));_0x3ecb8e&&(_0x2068b0['OR']=[{'shop':{'name':{'contains':_0x3ecb8e,'mode':_0x423c96(0x29a)}}},{'shop':{'username':{'contains':_0x3ecb8e,'mode':_0x423c96(0x29a)}}},{'notes':{'contains':_0x3ecb8e,'mode':'insensitive'}}]);const [_0x3e4980,_0x18b9a8]=await Promise[_0x423c96(0x327)]([database_1[_0x423c96(0x1f1)][_0x423c96(0x235)]['findMany']({'where':_0x2068b0,'skip':_0x3f08e8,'take':_0x165c15,'orderBy':{'createdAt':_0x423c96(0x24f)},'select':{'id':!![],'shopId':!![],'amount':!![],'network':!![],'status':!![],'txid':!![],'notes':!![],'periodFrom':!![],'periodTo':!![],'createdAt':!![],'paidAt':!![],'shop':{'select':{'name':!![],'username':!![]}}}}),database_1[_0x423c96(0x1f1)][_0x423c96(0x235)][_0x423c96(0x287)]({'where':_0x2068b0})]);return{'payouts':_0x3e4980[_0x423c96(0x2c3)](_0x54088b=>({'id':_0x54088b['id'],'shopId':_0x54088b[_0x423c96(0x321)],'shopName':_0x54088b['shop'][_0x423c96(0x323)],'shopUsername':_0x54088b[_0x423c96(0x207)][_0x423c96(0x29f)],'amount':_0x54088b[_0x423c96(0x32c)],'network':_0x54088b[_0x423c96(0x1f9)],'status':_0x54088b[_0x423c96(0x223)],'txid':_0x54088b['txid'],'notes':_0x54088b['notes'],'periodFrom':_0x54088b[_0x423c96(0x238)],'periodTo':_0x54088b[_0x423c96(0x1f6)],'createdAt':_0x54088b[_0x423c96(0x32e)],'paidAt':_0x54088b['paidAt']})),'pagination':{'page':_0x3a44cf,'limit':_0x165c15,'total':_0x18b9a8,'totalPages':Math['ceil'](_0x18b9a8/_0x165c15)}};}async[a40_0x270d1f(0x1eb)](_0x2479f4){const _0x3b8c9d=a40_0x270d1f,_0x363d26=await database_1[_0x3b8c9d(0x1f1)]['payout'][_0x3b8c9d(0x302)]({'where':{'id':_0x2479f4},'include':{'shop':{'select':{'name':!![],'username':!![]}}}});if(!_0x363d26)return null;return{'id':_0x363d26['id'],'shopId':_0x363d26[_0x3b8c9d(0x321)],'shopName':_0x363d26['shop'][_0x3b8c9d(0x323)],'shopUsername':_0x363d26[_0x3b8c9d(0x207)][_0x3b8c9d(0x29f)],'amount':_0x363d26[_0x3b8c9d(0x32c)],'network':_0x363d26[_0x3b8c9d(0x1f9)],'status':_0x363d26[_0x3b8c9d(0x223)],'txid':_0x363d26[_0x3b8c9d(0x2d8)],'notes':_0x363d26['notes'],'periodFrom':_0x363d26['periodFrom'],'periodTo':_0x363d26[_0x3b8c9d(0x1f6)],'createdAt':_0x363d26[_0x3b8c9d(0x32e)],'paidAt':_0x363d26[_0x3b8c9d(0x22f)]};}async[a40_0x270d1f(0x27d)](_0x1931d5){const _0x437c75=a40_0x270d1f;await database_1[_0x437c75(0x1f1)][_0x437c75(0x235)]['delete']({'where':{'id':_0x1931d5}});}async[a40_0x270d1f(0x25f)](_0x2e0989){const _0x50763a=a40_0x270d1f,{page:_0x249ab6,limit:_0x4616a8,status:_0x4f4706,gateway:_0x40edf4,shopId:_0x3d769a,dateFrom:_0x3815d6,dateTo:_0x12ea8d,search:_0x277c57,currency:_0x184824,sortBy:_0x36373d,sortOrder:_0x294e28}=_0x2e0989,_0x3f49ec=(_0x249ab6-0x1)*_0x4616a8;console[_0x50763a(0x2a5)](_0x50763a(0x2a4),_0x2e0989);const _0x439fea=await database_1[_0x50763a(0x1f1)][_0x50763a(0x26c)][_0x50763a(0x2c5)]({'by':[_0x50763a(0x247)],'_count':{'gateway':!![]}});console[_0x50763a(0x2a5)](_0x50763a(0x208),_0x439fea[_0x50763a(0x2c3)](_0x2e356f=>_0x2e356f[_0x50763a(0x247)]+'\x20('+_0x2e356f['_count'][_0x50763a(0x247)]+_0x50763a(0x1ec)));if(_0x40edf4){const _0x58c9c9=_0x439fea[_0x50763a(0x272)](_0x2db2f3=>_0x2db2f3[_0x50763a(0x247)][_0x50763a(0x1fd)]()===_0x40edf4[_0x50763a(0x1fd)]());!_0x58c9c9&&_0x40edf4['toLowerCase']()!==_0x50763a(0x27e)&&console[_0x50763a(0x2a5)](_0x50763a(0x203)+_0x40edf4+_0x50763a(0x24b)+_0x439fea[_0x50763a(0x2c3)](_0x38e44a=>_0x38e44a['gateway'])['join'](',\x20'));}const _0xc1eb3c={};_0x4f4706&&(_0xc1eb3c[_0x50763a(0x223)]=_0x4f4706[_0x50763a(0x27b)]());if(!_0x40edf4)_0xc1eb3c['gateway']={'not':_0x50763a(0x27e)};else{if(_0x40edf4&&(_0x40edf4[_0x50763a(0x1fd)]()==='test_gateway'||_0x40edf4==='0000'))_0xc1eb3c[_0x50763a(0x247)]=_0x50763a(0x27e);else{let _0x562a12=_0x40edf4;const _0x589f2c=(0x0,gateway_1[_0x50763a(0x242)])(_0x40edf4);if(_0x589f2c)_0x562a12=_0x589f2c,console[_0x50763a(0x2a5)](_0x50763a(0x281)+_0x40edf4+'\x27\x20to\x20name\x20\x27'+_0x562a12+'\x27');else{const _0x5339b0=(0x0,gateway_1['getGatewayIdByName'])(_0x40edf4);if(_0x5339b0){const _0x3986fb=(0x0,gateway_1[_0x50763a(0x242)])(_0x5339b0);_0x3986fb&&(_0x562a12=_0x3986fb,console['log'](_0x50763a(0x1e7)+_0x40edf4+_0x50763a(0x1ef)+_0x5339b0+'\x27\x20->\x20name\x20\x27'+_0x562a12+'\x27'));}else console[_0x50763a(0x2a5)]('🔍\x20Using\x20gateway\x20\x27'+_0x40edf4+_0x50763a(0x294));}const _0x5ac1b5=await database_1[_0x50763a(0x1f1)]['payment'][_0x50763a(0x287)]({'where':{'gateway':_0x562a12[_0x50763a(0x1fd)]()},'take':0x1});_0x5ac1b5===0x0?(console[_0x50763a(0x2a5)](_0x50763a(0x2e9)+_0x562a12+_0x50763a(0x2cb)+_0x40edf4+'\x27)\x20not\x20found\x20in\x20database,\x20returning\x20empty\x20result'),_0xc1eb3c[_0x50763a(0x247)]='NONEXISTENT_GATEWAY_FILTER'):(_0xc1eb3c[_0x50763a(0x247)]=_0x562a12['toLowerCase'](),console[_0x50763a(0x2a5)]('✅\x20Using\x20gateway\x20filter:\x20\x27'+_0x562a12+_0x50763a(0x2cb)+_0x40edf4+'\x27)'));}}console['log'](_0x50763a(0x2bb),_0xc1eb3c[_0x50763a(0x247)]);_0x3d769a&&(_0xc1eb3c[_0x50763a(0x321)]=_0x3d769a);_0x184824&&(_0xc1eb3c[_0x50763a(0x317)]=_0x184824[_0x50763a(0x27b)](),console[_0x50763a(0x2a5)](_0x50763a(0x2e4)+_0x184824['toUpperCase']()));(_0x3815d6||_0x12ea8d)&&(_0xc1eb3c[_0x50763a(0x32e)]={},_0x3815d6&&(_0xc1eb3c[_0x50763a(0x32e)][_0x50763a(0x1fa)]=new Date(_0x3815d6)),_0x12ea8d&&(_0xc1eb3c[_0x50763a(0x32e)]['lte']=new Date(_0x12ea8d)));_0x277c57&&(_0xc1eb3c['OR']=[{'id':{'contains':_0x277c57,'mode':_0x50763a(0x29a)}},{'orderId':{'contains':_0x277c57,'mode':'insensitive'}},{'gatewayOrderId':{'contains':_0x277c57,'mode':_0x50763a(0x29a)}},{'customerEmail':{'contains':_0x277c57,'mode':'insensitive'}},{'shop':{'name':{'contains':_0x277c57,'mode':_0x50763a(0x29a)}}},{'shop':{'username':{'contains':_0x277c57,'mode':'insensitive'}}}]);console[_0x50763a(0x2a5)](_0x50763a(0x1e8),JSON[_0x50763a(0x2ec)](_0xc1eb3c,null,0x2));let _0x42d284={'createdAt':'desc'};if(_0x36373d){const _0x354589=[_0x50763a(0x32c),_0x50763a(0x32e),'updatedAt',_0x50763a(0x223),_0x50763a(0x247),'currency'],_0x45654c=[_0x50763a(0x2eb),_0x50763a(0x24f)];if(_0x354589[_0x50763a(0x234)](_0x36373d)){const _0x4c7184=_0x45654c[_0x50763a(0x234)](_0x294e28)?_0x294e28:_0x50763a(0x24f);_0x42d284={[_0x36373d]:_0x4c7184},console[_0x50763a(0x2a5)](_0x50763a(0x29c)+_0x36373d+_0x50763a(0x267)+_0x4c7184+_0x50763a(0x2b2));}}const [_0x39ca81,_0x9002fc]=await Promise['all']([database_1[_0x50763a(0x1f1)][_0x50763a(0x26c)][_0x50763a(0x324)]({'where':_0xc1eb3c,'skip':_0x3f49ec,'take':_0x4616a8,'orderBy':_0x42d284,'include':{'shop':{'select':{'name':!![],'username':!![]}}}}),database_1[_0x50763a(0x1f1)][_0x50763a(0x26c)][_0x50763a(0x287)]({'where':_0xc1eb3c})]);return{'payments':_0x39ca81,'pagination':{'page':_0x249ab6,'limit':_0x4616a8,'total':_0x9002fc,'totalPages':Math[_0x50763a(0x284)](_0x9002fc/_0x4616a8)}};}async['getPaymentById'](_0x3a7f91){const _0x3f7377=a40_0x270d1f,_0x38839e=await database_1['default']['payment'][_0x3f7377(0x302)]({'where':{'id':_0x3a7f91},'select':{'id':!![],'shopId':!![],'amount':!![],'amountAfterGatewayCommissionUSDT':!![],'currency':!![],'sourceCurrency':!![],'status':!![],'gateway':!![],'orderId':!![],'gatewayOrderId':!![],'gatewayPaymentId':!![],'customerEmail':!![],'customerName':!![],'customerCountry':!![],'customerIp':!![],'customerUa':!![],'externalPaymentUrl':!![],'successUrl':!![],'failUrl':!![],'pendingUrl':!![],'whiteUrl':!![],'expiresAt':!![],'invoiceTotalSum':!![],'qrCode':!![],'qrUrl':!![],'country':!![],'language':!![],'amountIsEditable':!![],'maxPayments':!![],'rapydCustomer':!![],'cardLast4':!![],'paymentMethod':!![],'bankId':!![],'remitterIban':!![],'remitterName':!![],'failureMessage':!![],'usage':!![],'createdAt':!![],'updatedAt':!![],'shop':{'select':{'name':!![],'username':!![]}}}});if(!_0x38839e)return null;return{'id':_0x38839e['id'],'shopId':_0x38839e['shopId'],'gateway':_0x38839e[_0x3f7377(0x247)],'amount':_0x38839e[_0x3f7377(0x32c)],'currency':_0x38839e[_0x3f7377(0x317)],'status':_0x38839e[_0x3f7377(0x223)],'orderId':_0x38839e[_0x3f7377(0x307)],'gatewayOrderId':_0x38839e[_0x3f7377(0x28a)],'customerEmail':_0x38839e[_0x3f7377(0x209)],'customerName':_0x38839e[_0x3f7377(0x30a)],'customerCountry':_0x38839e[_0x3f7377(0x2af)],'customerIp':_0x38839e[_0x3f7377(0x311)],'customerUa':_0x38839e[_0x3f7377(0x257)],'failureMessage':_0x38839e[_0x3f7377(0x274)],'externalPaymentUrl':_0x38839e[_0x3f7377(0x31c)],'successUrl':_0x38839e[_0x3f7377(0x286)],'failUrl':_0x38839e[_0x3f7377(0x30f)],'pendingUrl':_0x38839e['pendingUrl'],'whiteUrl':_0x38839e[_0x3f7377(0x239)],'createdAt':_0x38839e[_0x3f7377(0x32e)],'updatedAt':_0x38839e['updatedAt'],'shop':_0x38839e[_0x3f7377(0x207)]};}async[a40_0x270d1f(0x318)](_0x4a212d,_0x25856c,_0x338a91,_0x1eedba){const _0xad1096=a40_0x270d1f,_0x324668=await database_1[_0xad1096(0x1f1)]['$transaction'](async _0x574dad=>{const _0x214e5f=_0xad1096,_0x1c6440=await _0x574dad[_0x214e5f(0x26c)]['findUnique']({'where':{'id':_0x4a212d},'include':{'shop':{'select':{'id':!![],'name':!![],'username':!![],'balance':!![]}}}});if(!_0x1c6440)throw new Error(_0x214e5f(0x217));const _0x34319e=_0x1c6440[_0x214e5f(0x223)],_0x2cdb80=_0x25856c['toUpperCase']();console[_0x214e5f(0x2a5)](_0x214e5f(0x233)+_0x4a212d+_0x214e5f(0x329)+_0x34319e+'\x20->\x20'+_0x2cdb80),console['log'](_0x214e5f(0x264)+_0x1c6440[_0x214e5f(0x207)][_0x214e5f(0x2f3)]+_0x214e5f(0x290));const _0x4e6d05={'status':_0x2cdb80,'updatedAt':new Date(),'statusChangedBy':_0x214e5f(0x2e7),'statusChangedAt':new Date()};_0x338a91&&(_0x4e6d05['adminNotes']=_0x338a91);_0x2cdb80==='CHARGEBACK'&&_0x1eedba&&(_0x4e6d05[_0x214e5f(0x2df)]=_0x1eedba);let _0x199b6d=0x0,_0x38cd24=_0x1c6440[_0x214e5f(0x207)][_0x214e5f(0x2f3)];if(_0x2cdb80===_0x214e5f(0x2b3)&&_0x34319e!==_0x214e5f(0x2b3)){_0x4e6d05[_0x214e5f(0x22f)]=new Date();const _0x35ad5b=await currencyService_1['currencyService'][_0x214e5f(0x250)](_0x1c6440[_0x214e5f(0x32c)],_0x1c6440['currency']);_0x4e6d05['amountUSDT']=_0x35ad5b;let _0x8661c8=0x2d;const _0x47035e=await _0x574dad[_0x214e5f(0x207)][_0x214e5f(0x302)]({'where':{'id':_0x1c6440[_0x214e5f(0x321)]},'select':{'gatewaySettings':!![]}});if(_0x47035e?.[_0x214e5f(0x2da)])try{const _0xa4c3f8=JSON[_0x214e5f(0x1fe)](_0x47035e[_0x214e5f(0x2da)]);for(const [_0x719059,_0xb6dad6]of Object[_0x214e5f(0x1ff)](_0xa4c3f8)){if(_0x719059[_0x214e5f(0x1fd)]()===_0x1c6440[_0x214e5f(0x247)][_0x214e5f(0x1fd)]()){_0x8661c8=_0xb6dad6[_0x214e5f(0x32b)]||0xa;break;}}}catch(_0x4e6bee){console[_0x214e5f(0x21c)](_0x214e5f(0x30e)+_0x4a212d+':',_0x4e6bee);}let _0x4f813f;_0x1c6440['amountAfterGatewayCommissionUSDT']!==null&&_0x1c6440['amountAfterGatewayCommissionUSDT']!==undefined?(_0x4f813f=_0x1c6440[_0x214e5f(0x31d)],console['log'](_0x214e5f(0x30b)+_0x4f813f[_0x214e5f(0x24d)](0x6)+_0x214e5f(0x20a)+_0x4a212d)):(_0x4f813f=_0x35ad5b*(0x1-_0x8661c8/0x64),console['log'](_0x214e5f(0x24e)+_0x4a212d+':\x20'+_0x8661c8+_0x214e5f(0x332)+_0x35ad5b[_0x214e5f(0x24d)](0x6)+_0x214e5f(0x290)),_0x4e6d05[_0x214e5f(0x31d)]=_0x4f813f,_0x4e6d05[_0x214e5f(0x32d)]=_0x8661c8),_0x199b6d=_0x4f813f,_0x38cd24+=_0x4f813f,console[_0x214e5f(0x2a5)](_0x214e5f(0x200)+_0x4a212d+_0x214e5f(0x260)),console[_0x214e5f(0x2a5)](_0x214e5f(0x2bf)+_0x35ad5b['toFixed'](0x6)+'\x20USDT'),console[_0x214e5f(0x2a5)]('\x20\x20\x20Gateway:\x20'+_0x1c6440[_0x214e5f(0x247)]+_0x214e5f(0x2c4)+_0x8661c8+'%'),console['log']('\x20\x20\x20Merchant\x20gets:\x20'+_0x4f813f[_0x214e5f(0x24d)](0x6)+_0x214e5f(0x295)+_0x8661c8+'%\x20commission)'),console['log'](_0x214e5f(0x28c)+_0x4f813f[_0x214e5f(0x24d)](0x6)+_0x214e5f(0x290));}else{if(_0x34319e==='PAID'&&_0x2cdb80!==_0x214e5f(0x2b3)&&_0x2cdb80!==_0x214e5f(0x1ed)){if(_0x1c6440[_0x214e5f(0x1f4)]){let _0x5afd2c=0x2d;const _0x4086ee=await _0x574dad[_0x214e5f(0x207)][_0x214e5f(0x302)]({'where':{'id':_0x1c6440[_0x214e5f(0x321)]},'select':{'gatewaySettings':!![]}});if(_0x4086ee?.[_0x214e5f(0x2da)])try{const _0x466c26=JSON['parse'](_0x4086ee[_0x214e5f(0x2da)]);for(const [_0xa599ce,_0x5d3d9d]of Object[_0x214e5f(0x1ff)](_0x466c26)){if(_0xa599ce['toLowerCase']()===_0x1c6440[_0x214e5f(0x247)][_0x214e5f(0x1fd)]()){_0x5afd2c=_0x5d3d9d[_0x214e5f(0x32b)]||0xa;break;}}}catch(_0x2d54fb){console[_0x214e5f(0x21c)](_0x214e5f(0x30e)+_0x4a212d+':',_0x2d54fb);}const _0x40c884=_0x1c6440[_0x214e5f(0x1f4)]*(0x1-_0x5afd2c/0x64);_0x199b6d=-_0x40c884,_0x38cd24-=_0x40c884,console[_0x214e5f(0x2a5)](_0x214e5f(0x2bf)+_0x1c6440[_0x214e5f(0x1f4)][_0x214e5f(0x24d)](0x6)+'\x20USDT'),console[_0x214e5f(0x2a5)](_0x214e5f(0x2d2)+_0x1c6440[_0x214e5f(0x247)]+_0x214e5f(0x2c4)+_0x5afd2c+'%'),console[_0x214e5f(0x2a5)](_0x214e5f(0x2fa)+_0x40c884[_0x214e5f(0x24d)](0x6)+'\x20USDT\x20(after\x20'+_0x5afd2c+'%\x20commission)'),console['log'](_0x214e5f(0x291)+_0x40c884['toFixed'](0x6)+_0x214e5f(0x290));}}}_0x2cdb80===_0x214e5f(0x1ed)&&(console['log'](_0x214e5f(0x2fb)),_0x1eedba&&_0x1eedba>0x0?(_0x199b6d=-_0x1eedba,_0x38cd24-=_0x1eedba,console['log']('💸\x20CHARGEBACK\x20penalty\x20ONLY:\x20-'+_0x1eedba['toFixed'](0x6)+_0x214e5f(0x262)),console[_0x214e5f(0x2a5)](_0x214e5f(0x20d))):console['log']('⚠️\x20CHARGEBACK\x20without\x20penalty\x20amount\x20-\x20no\x20balance\x20change'),_0x4e6d05[_0x214e5f(0x2df)]=_0x1eedba||0x0);_0x2cdb80===_0x214e5f(0x2ae)&&_0x34319e==='PAID'&&console[_0x214e5f(0x2a5)](_0x214e5f(0x314));const _0x4b949d=await _0x574dad[_0x214e5f(0x26c)][_0x214e5f(0x2b7)]({'where':{'id':_0x4a212d},'data':_0x4e6d05,'include':{'shop':{'select':{'name':!![],'username':!![]}}}});return _0x199b6d!==0x0&&(await _0x574dad['shop'][_0x214e5f(0x2b7)]({'where':{'id':_0x1c6440[_0x214e5f(0x321)]},'data':{'balance':_0x38cd24}}),console[_0x214e5f(0x2a5)](_0x214e5f(0x23b)+_0x1c6440[_0x214e5f(0x321)]+_0x214e5f(0x2c9)+_0x1c6440[_0x214e5f(0x207)][_0x214e5f(0x2f3)][_0x214e5f(0x24d)](0x6)+_0x214e5f(0x22e)+_0x38cd24['toFixed'](0x6)+_0x214e5f(0x2f5)+(_0x199b6d>0x0?'+':'')+_0x199b6d[_0x214e5f(0x24d)](0x6)+')')),_0x4b949d;});return{'id':_0x324668['id'],'shopId':_0x324668[_0xad1096(0x321)],'gateway':_0x324668[_0xad1096(0x247)],'amount':_0x324668[_0xad1096(0x32c)],'currency':_0x324668[_0xad1096(0x317)],'status':_0x324668[_0xad1096(0x223)],'orderId':_0x324668[_0xad1096(0x307)],'gatewayOrderId':_0x324668[_0xad1096(0x28a)],'customerEmail':_0x324668[_0xad1096(0x209)],'customerName':_0x324668[_0xad1096(0x30a)],'customerCountry':_0x324668[_0xad1096(0x2af)],'customerIp':_0x324668['customerIp'],'customerUa':_0x324668['customerUa'],'failureMessage':_0x324668['failureMessage'],'adminNotes':_0x324668['adminNotes'],'chargebackAmount':_0x324668['chargebackAmount'],'statusChangedBy':_0x324668['statusChangedBy'],'statusChangedAt':_0x324668[_0xad1096(0x2d4)],'createdAt':_0x324668[_0xad1096(0x32e)],'updatedAt':_0x324668[_0xad1096(0x301)],'shop':_0x324668['shop']};}async[a40_0x270d1f(0x2a9)](_0x198b38,_0x1ec455){const _0x33c120=a40_0x270d1f,_0x242944=Math['random']()['toString'](0x24)[_0x33c120(0x2fe)](0x2,0x9);console[_0x33c120(0x2a5)](_0x33c120(0x251)+_0x242944+_0x33c120(0x258)+_0x198b38);const _0x353a50={..._0x1ec455};_0x1ec455[_0x33c120(0x29b)]&&_0x1ec455[_0x33c120(0x29b)][_0x33c120(0x25c)]()!==''?(console[_0x33c120(0x2a5)](_0x33c120(0x25b)+_0x242944+_0x33c120(0x271)+_0x198b38),_0x353a50[_0x33c120(0x29b)]=await bcryptjs_1[_0x33c120(0x1f1)][_0x33c120(0x1fb)](_0x1ec455['password'],0xc)):(console[_0x33c120(0x2a5)](_0x33c120(0x25b)+_0x242944+_0x33c120(0x201)),delete _0x353a50[_0x33c120(0x29b)]);_0x1ec455[_0x33c120(0x22d)]&&(_0x353a50[_0x33c120(0x323)]=_0x1ec455[_0x33c120(0x22d)],delete _0x353a50['fullName']);_0x1ec455[_0x33c120(0x248)]&&(_0x353a50[_0x33c120(0x2c8)]=_0x1ec455['telegramId'],delete _0x353a50['telegramId']);_0x1ec455[_0x33c120(0x214)]&&(_0x353a50[_0x33c120(0x285)]=_0x1ec455[_0x33c120(0x214)],delete _0x353a50[_0x33c120(0x214)]);if(_0x1ec455[_0x33c120(0x1ea)]){const _0x233ace=_0x1ec455[_0x33c120(0x1ea)][_0x33c120(0x2c3)](_0x335963=>this[_0x33c120(0x289)](_0x335963));console[_0x33c120(0x2a5)]('🔄\x20Gateway\x20mapping:',_0x1ec455[_0x33c120(0x1ea)],'->',_0x233ace),_0x353a50[_0x33c120(0x2ff)]=JSON[_0x33c120(0x2ec)](_0x233ace),delete _0x353a50[_0x33c120(0x1ea)];}_0x1ec455[_0x33c120(0x2da)]&&(console['log']('🔧\x20['+_0x242944+_0x33c120(0x2a3),_0x1ec455[_0x33c120(0x2da)]),_0x353a50[_0x33c120(0x2da)]=JSON['stringify'](_0x1ec455[_0x33c120(0x2da)]),console[_0x33c120(0x2a5)](_0x33c120(0x270)+_0x242944+_0x33c120(0x2a7),_0x353a50[_0x33c120(0x2da)]));_0x1ec455['wallets']&&(_0x1ec455[_0x33c120(0x2f0)][_0x33c120(0x252)]!==undefined&&(_0x353a50[_0x33c120(0x252)]=_0x1ec455['wallets'][_0x33c120(0x252)]||null),_0x1ec455['wallets']['usdtTrcWallet']!==undefined&&(_0x353a50[_0x33c120(0x211)]=_0x1ec455[_0x33c120(0x2f0)][_0x33c120(0x211)]||null),_0x1ec455[_0x33c120(0x2f0)][_0x33c120(0x2e6)]!==undefined&&(_0x353a50[_0x33c120(0x2e6)]=_0x1ec455[_0x33c120(0x2f0)][_0x33c120(0x2e6)]||null),_0x1ec455[_0x33c120(0x2f0)]['usdcPolygonWallet']!==undefined&&(_0x353a50[_0x33c120(0x23f)]=_0x1ec455['wallets'][_0x33c120(0x23f)]||null),delete _0x353a50[_0x33c120(0x2f0)]);const _0x2a4852=await database_1['default']['shop'][_0x33c120(0x2b7)]({'where':{'id':_0x198b38},'data':_0x353a50,'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});return console['log'](_0x33c120(0x276)+_0x242944+_0x33c120(0x22a),_0x2a4852[_0x33c120(0x2da)]),{'id':_0x2a4852['id'],'fullName':_0x2a4852[_0x33c120(0x323)],'username':_0x2a4852[_0x33c120(0x29f)],'telegramId':_0x2a4852['telegram'],'merchantUrl':_0x2a4852[_0x33c120(0x285)],'gateways':_0x2a4852[_0x33c120(0x2ff)]?JSON[_0x33c120(0x1fe)](_0x2a4852[_0x33c120(0x2ff)]):null,'gatewaySettings':_0x2a4852[_0x33c120(0x2da)]?JSON[_0x33c120(0x1fe)](_0x2a4852[_0x33c120(0x2da)]):null,'publicKey':_0x2a4852['publicKey'],'wallets':{'usdtPolygonWallet':_0x2a4852[_0x33c120(0x252)],'usdtTrcWallet':_0x2a4852['usdtTrcWallet'],'usdtErcWallet':_0x2a4852['usdtErcWallet'],'usdcPolygonWallet':_0x2a4852[_0x33c120(0x23f)]},'status':_0x2a4852[_0x33c120(0x223)],'createdAt':_0x2a4852[_0x33c120(0x32e)]};}async['suspendUser'](_0x14c330){const _0x5a45e5=a40_0x270d1f,_0x2153c3=await database_1['default'][_0x5a45e5(0x207)][_0x5a45e5(0x2b7)]({'where':{'id':_0x14c330},'data':{'status':'SUSPENDED'},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});return{'id':_0x2153c3['id'],'fullName':_0x2153c3[_0x5a45e5(0x323)],'username':_0x2153c3[_0x5a45e5(0x29f)],'telegramId':_0x2153c3[_0x5a45e5(0x2c8)],'merchantUrl':_0x2153c3[_0x5a45e5(0x285)],'gateways':_0x2153c3['paymentGateways']?JSON[_0x5a45e5(0x1fe)](_0x2153c3['paymentGateways']):null,'gatewaySettings':_0x2153c3[_0x5a45e5(0x2da)]?JSON[_0x5a45e5(0x1fe)](_0x2153c3[_0x5a45e5(0x2da)]):null,'publicKey':_0x2153c3[_0x5a45e5(0x28b)],'wallets':{'usdtPolygonWallet':_0x2153c3[_0x5a45e5(0x252)],'usdtTrcWallet':_0x2153c3[_0x5a45e5(0x211)],'usdtErcWallet':_0x2153c3[_0x5a45e5(0x2e6)],'usdcPolygonWallet':_0x2153c3[_0x5a45e5(0x23f)]},'status':_0x2153c3[_0x5a45e5(0x223)],'createdAt':_0x2153c3['createdAt']};}async[a40_0x270d1f(0x2ad)](_0x45b2ec){const _0x590b42=a40_0x270d1f,_0x1aa4fa=await database_1['default']['shop'][_0x590b42(0x2b7)]({'where':{'id':_0x45b2ec},'data':{'status':_0x590b42(0x2b1)},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});return{'id':_0x1aa4fa['id'],'fullName':_0x1aa4fa[_0x590b42(0x323)],'username':_0x1aa4fa['username'],'telegramId':_0x1aa4fa[_0x590b42(0x2c8)],'merchantUrl':_0x1aa4fa[_0x590b42(0x285)],'gateways':_0x1aa4fa[_0x590b42(0x2ff)]?JSON[_0x590b42(0x1fe)](_0x1aa4fa[_0x590b42(0x2ff)]):null,'gatewaySettings':_0x1aa4fa[_0x590b42(0x2da)]?JSON[_0x590b42(0x1fe)](_0x1aa4fa[_0x590b42(0x2da)]):null,'publicKey':_0x1aa4fa['publicKey'],'wallets':{'usdtPolygonWallet':_0x1aa4fa['usdtPolygonWallet'],'usdtTrcWallet':_0x1aa4fa[_0x590b42(0x211)],'usdtErcWallet':_0x1aa4fa['usdtErcWallet'],'usdcPolygonWallet':_0x1aa4fa[_0x590b42(0x23f)]},'status':_0x1aa4fa[_0x590b42(0x223)],'createdAt':_0x1aa4fa[_0x590b42(0x32e)]};}async[a40_0x270d1f(0x296)](_0x40ba2a){const _0x51f80e=a40_0x270d1f,{page:_0x2ecdcc,limit:_0x4a78d8,status:_0x3e1d66}=_0x40ba2a,_0x2c4e4c=(_0x2ecdcc-0x1)*_0x4a78d8,_0x3c925f={};_0x3e1d66&&(_0x3c925f[_0x51f80e(0x223)]=_0x3e1d66[_0x51f80e(0x27b)]());const [_0x1a0aa5,_0x4c8006]=await Promise[_0x51f80e(0x327)]([database_1['default'][_0x51f80e(0x207)][_0x51f80e(0x324)]({'where':_0x3c925f,'skip':_0x2c4e4c,'take':_0x4a78d8,'orderBy':{'createdAt':_0x51f80e(0x24f)},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}}),database_1[_0x51f80e(0x1f1)][_0x51f80e(0x207)][_0x51f80e(0x287)]({'where':_0x3c925f})]);return{'users':_0x1a0aa5['map'](_0x41562e=>{const _0xba8323=_0x51f80e,_0x301ee9=_0x41562e[_0xba8323(0x2ff)]?JSON['parse'](_0x41562e[_0xba8323(0x2ff)]):null,_0x4caf37=_0x301ee9?_0x301ee9[_0xba8323(0x2c3)](_0x5969d4=>this[_0xba8323(0x244)](_0x5969d4)):null;return{'id':_0x41562e['id'],'fullName':_0x41562e[_0xba8323(0x323)],'username':_0x41562e['username'],'telegramId':_0x41562e[_0xba8323(0x2c8)],'merchantUrl':_0x41562e[_0xba8323(0x285)],'gateways':_0x4caf37,'gatewaySettings':_0x41562e['gatewaySettings']?JSON[_0xba8323(0x1fe)](_0x41562e[_0xba8323(0x2da)]):null,'publicKey':_0x41562e[_0xba8323(0x28b)],'wallets':{'usdtPolygonWallet':_0x41562e[_0xba8323(0x252)],'usdtTrcWallet':_0x41562e[_0xba8323(0x211)],'usdtErcWallet':_0x41562e[_0xba8323(0x2e6)],'usdcPolygonWallet':_0x41562e[_0xba8323(0x23f)]},'status':_0x41562e[_0xba8323(0x223)],'createdAt':_0x41562e[_0xba8323(0x32e)]};}),'pagination':{'page':_0x2ecdcc,'limit':_0x4a78d8,'total':_0x4c8006,'totalPages':Math[_0x51f80e(0x284)](_0x4c8006/_0x4a78d8)}};}async[a40_0x270d1f(0x2de)](_0x30d839){const _0x332ca0=a40_0x270d1f,_0x1149dd=await database_1[_0x332ca0(0x1f1)][_0x332ca0(0x207)][_0x332ca0(0x302)]({'where':{'id':_0x30d839},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});if(!_0x1149dd)return null;const _0x39cdf9=_0x1149dd[_0x332ca0(0x2ff)]?JSON['parse'](_0x1149dd[_0x332ca0(0x2ff)]):null,_0x36a858=_0x39cdf9?_0x39cdf9['map'](_0x257246=>this['getGatewayDisplayName'](_0x257246)):null;return _0x39cdf9&&_0x36a858&&console['log'](_0x332ca0(0x27a),_0x39cdf9,'->',_0x36a858),{'id':_0x1149dd['id'],'fullName':_0x1149dd['name'],'username':_0x1149dd[_0x332ca0(0x29f)],'telegramId':_0x1149dd[_0x332ca0(0x2c8)],'merchantUrl':_0x1149dd['shopUrl'],'gateways':_0x36a858,'gatewaySettings':_0x1149dd[_0x332ca0(0x2da)]?JSON[_0x332ca0(0x1fe)](_0x1149dd[_0x332ca0(0x2da)]):null,'publicKey':_0x1149dd[_0x332ca0(0x28b)],'wallets':{'usdtPolygonWallet':_0x1149dd['usdtPolygonWallet'],'usdtTrcWallet':_0x1149dd['usdtTrcWallet'],'usdtErcWallet':_0x1149dd['usdtErcWallet'],'usdcPolygonWallet':_0x1149dd[_0x332ca0(0x23f)]},'status':_0x1149dd[_0x332ca0(0x223)],'createdAt':_0x1149dd[_0x332ca0(0x32e)]};}async['createUser'](_0x405f9e){const _0x5f44f3=a40_0x270d1f,{fullName:_0x2990b4,username:_0x41e445,password:_0x4efd36,telegramId:_0x50c2c5,merchantUrl:_0xbcf9c2,gateways:_0x25c29d,gatewaySettings:_0x4b9ed9,wallets:_0x48d316}=_0x405f9e,_0x1d8b60=await database_1[_0x5f44f3(0x1f1)][_0x5f44f3(0x207)][_0x5f44f3(0x302)]({'where':{'username':_0x41e445}});if(_0x1d8b60)throw new Error(_0x5f44f3(0x241));if(_0x50c2c5){const _0x86b8ab=await database_1['default'][_0x5f44f3(0x207)]['findUnique']({'where':{'telegram':_0x50c2c5}});if(_0x86b8ab)throw new Error(_0x5f44f3(0x2cc));}const _0x244bb4=await bcryptjs_1['default'][_0x5f44f3(0x1fb)](_0x4efd36,0xc),_0x436bdf='pk_'+crypto_1[_0x5f44f3(0x1f1)][_0x5f44f3(0x2bc)](0x20)[_0x5f44f3(0x1e3)]('hex'),_0x2152e9='sk_'+crypto_1[_0x5f44f3(0x1f1)][_0x5f44f3(0x2bc)](0x20)['toString'](_0x5f44f3(0x2fd)),_0x59f6dd=_0x25c29d?_0x25c29d[_0x5f44f3(0x2c3)](_0x9decfe=>this[_0x5f44f3(0x289)](_0x9decfe)):null;_0x25c29d&&_0x59f6dd&&console[_0x5f44f3(0x2a5)](_0x5f44f3(0x30d),_0x25c29d,'->',_0x59f6dd);const _0x296599=await database_1[_0x5f44f3(0x1f1)][_0x5f44f3(0x207)]['create']({'data':{'name':_0x2990b4,'username':_0x41e445,'password':_0x244bb4,'telegram':_0x50c2c5,'shopUrl':_0xbcf9c2,'paymentGateways':_0x59f6dd?JSON[_0x5f44f3(0x2ec)](_0x59f6dd):null,'gatewaySettings':_0x4b9ed9?JSON[_0x5f44f3(0x2ec)](_0x4b9ed9):null,'usdtPolygonWallet':_0x48d316?.[_0x5f44f3(0x252)]||null,'usdtTrcWallet':_0x48d316?.[_0x5f44f3(0x211)]||null,'usdtErcWallet':_0x48d316?.['usdtErcWallet']||null,'usdcPolygonWallet':_0x48d316?.[_0x5f44f3(0x23f)]||null,'publicKey':_0x436bdf,'secretKey':_0x2152e9,'status':_0x5f44f3(0x2b1)},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});return{'id':_0x296599['id'],'fullName':_0x296599[_0x5f44f3(0x323)],'username':_0x296599[_0x5f44f3(0x29f)],'telegramId':_0x296599[_0x5f44f3(0x2c8)],'merchantUrl':_0x296599[_0x5f44f3(0x285)],'gateways':_0x296599[_0x5f44f3(0x2ff)]?JSON['parse'](_0x296599[_0x5f44f3(0x2ff)]):null,'gatewaySettings':_0x296599['gatewaySettings']?JSON['parse'](_0x296599[_0x5f44f3(0x2da)]):null,'publicKey':_0x296599[_0x5f44f3(0x28b)],'wallets':{'usdtPolygonWallet':_0x296599[_0x5f44f3(0x252)],'usdtTrcWallet':_0x296599['usdtTrcWallet'],'usdtErcWallet':_0x296599[_0x5f44f3(0x2e6)],'usdcPolygonWallet':_0x296599[_0x5f44f3(0x23f)]},'status':_0x296599[_0x5f44f3(0x223)],'createdAt':_0x296599[_0x5f44f3(0x32e)]};}async[a40_0x270d1f(0x216)](_0x2289b8){const _0x4e9283=a40_0x270d1f;await database_1[_0x4e9283(0x1f1)][_0x4e9283(0x207)][_0x4e9283(0x2b6)]({'where':{'id':_0x2289b8}});}[a40_0x270d1f(0x2f7)](_0x29c029,_0x5ec565,_0x1e7527){const _0x44e863=a40_0x270d1f,_0x26c3e2=new Map(),_0x34af97=new Date(_0x5ec565);while(_0x34af97<=_0x1e7527){const _0x1783ab=_0x34af97[_0x44e863(0x2f9)]()['split']('T')[0x0];_0x26c3e2[_0x44e863(0x331)](_0x1783ab,{'revenue':0x0,'count':0x0}),_0x34af97[_0x44e863(0x2ea)](_0x34af97[_0x44e863(0x231)]()+0x1);}for(const _0x304a81 of _0x29c029){const _0x3f2eee=_0x304a81[_0x44e863(0x32e)][_0x44e863(0x2f9)]()[_0x44e863(0x21a)]('T')[0x0],_0x4ee1a1=_0x26c3e2[_0x44e863(0x305)](_0x3f2eee);_0x4ee1a1&&(_0x4ee1a1[_0x44e863(0x287)]+=0x1,_0x304a81['status']===_0x44e863(0x2b3)&&(_0x304a81[_0x44e863(0x1f4)]?_0x4ee1a1[_0x44e863(0x303)]+=_0x304a81[_0x44e863(0x1f4)]:console[_0x44e863(0x2a5)]('⚠️\x20Payment\x20'+_0x304a81['id']+_0x44e863(0x215))));}const _0x5671a6=[],_0x439323=[];for(const [_0x24766a,_0x4cdca7]of _0x26c3e2){_0x5671a6[_0x44e863(0x2cf)]({'date':_0x24766a,'amount':Math[_0x44e863(0x206)](_0x4cdca7[_0x44e863(0x303)]*0x64)/0x64}),_0x439323[_0x44e863(0x2cf)]({'date':_0x24766a,'count':_0x4cdca7['count']});}return{'dailyRevenue':_0x5671a6,'dailyPayments':_0x439323};}}exports['AdminService']=AdminService;