'use strict';const a38_0xb6c9ae=a38_0x5edc;(function(_0x5a3722,_0x127369){const _0x532930=a38_0x5edc,_0x5d4ed6=_0x5a3722();while(!![]){try{const _0x3677d6=-parseInt(_0x532930(0x1c7))/0x1*(parseInt(_0x532930(0x2cb))/0x2)+parseInt(_0x532930(0x2b0))/0x3*(parseInt(_0x532930(0x1d2))/0x4)+-parseInt(_0x532930(0x1ef))/0x5+parseInt(_0x532930(0x23c))/0x6*(parseInt(_0x532930(0x26c))/0x7)+-parseInt(_0x532930(0x252))/0x8+-parseInt(_0x532930(0x1ab))/0x9*(-parseInt(_0x532930(0x1d3))/0xa)+parseInt(_0x532930(0x218))/0xb;if(_0x3677d6===_0x127369)break;else _0x5d4ed6['push'](_0x5d4ed6['shift']());}catch(_0x49ce92){_0x5d4ed6['push'](_0x5d4ed6['shift']());}}}(a38_0x4777,0xe9b96));var __importDefault=this&&this[a38_0xb6c9ae(0x1e9)]||function(_0x442e32){const _0x118d0a=a38_0xb6c9ae;return _0x442e32&&_0x442e32[_0x118d0a(0x1b3)]?_0x442e32:{'default':_0x442e32};};Object[a38_0xb6c9ae(0x232)](exports,'__esModule',{'value':!![]}),exports[a38_0xb6c9ae(0x273)]=void 0x0;const database_1=__importDefault(require(a38_0xb6c9ae(0x28b))),bcryptjs_1=__importDefault(require(a38_0xb6c9ae(0x222))),crypto_1=__importDefault(require('crypto')),currencyService_1=require(a38_0xb6c9ae(0x1d6)),gateway_1=require('../types/gateway');class AdminService{async[a38_0xb6c9ae(0x2d1)](){const _0x2cc182=a38_0xb6c9ae;console[_0x2cc182(0x2a2)]('📊\x20Calculating\x20payout\x20statistics...');const _0x374615=await database_1['default'][_0x2cc182(0x21b)][_0x2cc182(0x239)]({'_sum':{'balance':!![],'totalPaidOut':!![]},'where':{'status':_0x2cc182(0x26b)}}),_0x5bec44=await database_1[_0x2cc182(0x1ed)][_0x2cc182(0x283)][_0x2cc182(0x261)]({'where':{'status':_0x2cc182(0x253),'gateway':{'not':'test_gateway'}}}),_0x16c821=new Date(),_0x11cd81=new Date(_0x16c821[_0x2cc182(0x204)](),_0x16c821[_0x2cc182(0x1a2)](),0x1),_0x5ea5c4=new Date(_0x16c821['getFullYear'](),_0x16c821[_0x2cc182(0x1a2)]()+0x1,0x0,0x17,0x3b,0x3b,0x3e7),_0xa1e888=await database_1[_0x2cc182(0x1ed)]['payout'][_0x2cc182(0x239)]({'_sum':{'amount':!![]},'where':{'createdAt':{'gte':_0x11cd81,'lte':_0x5ea5c4},'status':_0x2cc182(0x25b)}}),_0x1b6f59=_0x374615[_0x2cc182(0x2c3)][_0x2cc182(0x2a8)]||0x0,_0x398b4c=_0x374615[_0x2cc182(0x2c3)]['balance']||0x0,_0x56cc15=_0xa1e888[_0x2cc182(0x2c3)][_0x2cc182(0x247)]||0x0,_0x52c782={'totalPayout':Math['round'](_0x1b6f59*0x64)/0x64,'awaitingPayout':Math['round'](_0x398b4c*0x64)/0x64,'thisMonth':Math[_0x2cc182(0x277)](_0x56cc15*0x64)/0x64,'availableBalance':Math['round'](_0x398b4c*0x64)/0x64,'totalPayments':_0x5bec44};return console['log'](_0x2cc182(0x24c)),console['log'](_0x2cc182(0x263)+_0x52c782['totalPayout']+'\x20USDT\x20(total\x20paid\x20to\x20merchants)'),console[_0x2cc182(0x2a2)](_0x2cc182(0x1d9)+_0x52c782['awaitingPayout']+'\x20USDT\x20(sum\x20of\x20all\x20merchant\x20balances)'),console[_0x2cc182(0x2a2)](_0x2cc182(0x20c)+_0x52c782[_0x2cc182(0x206)]+_0x2cc182(0x251)),console[_0x2cc182(0x2a2)](_0x2cc182(0x2ce)+_0x52c782[_0x2cc182(0x255)]+_0x2cc182(0x27c)),console[_0x2cc182(0x2a2)]('\x20\x20\x20💳\x20Total\x20payments:\x20'+_0x52c782[_0x2cc182(0x26f)]+'\x20PAID\x20payments'),_0x52c782;}async[a38_0xb6c9ae(0x227)](_0x4d860e,_0xd5f2b3){const _0x549df1=a38_0xb6c9ae;console[_0x549df1(0x2a2)](_0x549df1(0x1fc)+_0x4d860e+':',_0xd5f2b3);const _0x5e0682=await database_1[_0x549df1(0x1ed)][_0x549df1(0x283)][_0x549df1(0x2ab)]({'where':{'id':_0x4d860e},'select':{'id':!![],'customerEmail':!![],'customerName':!![],'customerCountry':!![],'customerIp':!![],'customerUa':!![]}});if(!_0x5e0682)throw new Error(_0x549df1(0x1d4));const _0x3eebc6={};_0xd5f2b3[_0x549df1(0x1a3)]!==undefined&&(_0x3eebc6[_0x549df1(0x1a3)]=_0xd5f2b3[_0x549df1(0x1a3)]||null);_0xd5f2b3[_0x549df1(0x2cc)]!==undefined&&(_0x3eebc6['customerIp']=_0xd5f2b3['customerIp']||null);_0xd5f2b3[_0x549df1(0x242)]!==undefined&&(_0x3eebc6[_0x549df1(0x242)]=_0xd5f2b3[_0x549df1(0x242)]||null);const _0x507506=await database_1[_0x549df1(0x1ed)][_0x549df1(0x283)][_0x549df1(0x22c)]({'where':{'id':_0x4d860e},'data':{..._0x3eebc6,'updatedAt':new Date()},'select':{'id':!![],'customerEmail':!![],'customerName':!![],'customerCountry':!![],'customerIp':!![],'customerUa':!![],'updatedAt':!![]}});return console[_0x549df1(0x2a2)](_0x549df1(0x1e4)+_0x4d860e),console[_0x549df1(0x2a2)](_0x549df1(0x284)+_0x5e0682[_0x549df1(0x1a3)]+_0x549df1(0x2c7)+_0x507506[_0x549df1(0x1a3)]),console[_0x549df1(0x2a2)](_0x549df1(0x299)+_0x5e0682[_0x549df1(0x2cc)]+'\x20->\x20'+_0x507506['customerIp']),console['log'](_0x549df1(0x1b4)+(_0x5e0682[_0x549df1(0x242)]?_0x549df1(0x28f):_0x549df1(0x198))+_0x549df1(0x2c7)+(_0x507506[_0x549df1(0x242)]?'set':'not\x20set')),_0x507506;}async[a38_0xb6c9ae(0x1f4)](_0x301d8e){const _0x252594=a38_0xb6c9ae,_0x196ac1=new Date();let _0x12e2fc;switch(_0x301d8e[_0x252594(0x2b6)]()){case _0x252594(0x1ee):_0x12e2fc=new Date(_0x196ac1[_0x252594(0x204)](),_0x196ac1[_0x252594(0x1a2)](),_0x196ac1[_0x252594(0x1fa)](),0x0,0x0,0x0,0x0);break;case _0x252594(0x1e1):const _0x3d2225=new Date(_0x196ac1);_0x3d2225['setDate'](_0x3d2225['getDate']()-0x1),_0x12e2fc=new Date(_0x3d2225[_0x252594(0x204)](),_0x3d2225[_0x252594(0x1a2)](),_0x3d2225[_0x252594(0x1fa)](),0x0,0x0,0x0,0x0);break;case'7d':_0x12e2fc=new Date(_0x196ac1['getTime']()-0x7*0x18*0x3c*0x3c*0x3e8);break;case _0x252594(0x1c8):_0x12e2fc=new Date(_0x196ac1['getTime']()-0x1e*0x18*0x3c*0x3c*0x3e8);break;case _0x252594(0x201):_0x12e2fc=new Date(_0x196ac1[_0x252594(0x221)]()-0x5a*0x18*0x3c*0x3c*0x3e8);break;case _0x252594(0x28c):const _0x55055b=await database_1[_0x252594(0x1ed)]['payment'][_0x252594(0x286)]({'where':{'gateway':{'not':_0x252594(0x1fd)}},'orderBy':{'createdAt':'asc'},'select':{'createdAt':!![]}});_0x12e2fc=_0x55055b?_0x55055b[_0x252594(0x25c)]:new Date(_0x252594(0x213));break;default:_0x12e2fc=new Date(_0x196ac1[_0x252594(0x221)]()-0x1e*0x18*0x3c*0x3c*0x3e8);}_0x12e2fc[_0x252594(0x26a)](0x0,0x0,0x0,0x0);let _0x72e1a0;if(_0x301d8e[_0x252594(0x2b6)]()===_0x252594(0x1e1)){const _0x2ae6a8=new Date(_0x196ac1);_0x2ae6a8[_0x252594(0x2ae)](_0x2ae6a8[_0x252594(0x1fa)]()-0x1),_0x72e1a0=new Date(_0x2ae6a8[_0x252594(0x204)](),_0x2ae6a8[_0x252594(0x1a2)](),_0x2ae6a8[_0x252594(0x1fa)](),0x17,0x3b,0x3b,0x3e7);}const _0x491a47={'gte':_0x12e2fc};_0x72e1a0&&(_0x491a47['lte']=_0x72e1a0);const [_0x167621,_0x54d5b4,_0x49bba3,_0x4369f3,_0x10d22a,_0x4758d4]=await Promise['all']([database_1[_0x252594(0x1ed)]['shop'][_0x252594(0x261)](),database_1['default'][_0x252594(0x21b)][_0x252594(0x261)]({'where':{'status':_0x252594(0x26b)}}),database_1[_0x252594(0x1ed)][_0x252594(0x283)][_0x252594(0x261)]({'where':{'status':'PAID','createdAt':_0x491a47,'gateway':{'not':'test_gateway'}}}),database_1[_0x252594(0x1ed)]['payment'][_0x252594(0x1bb)]({'where':{'status':_0x252594(0x253),'createdAt':_0x491a47,'gateway':{'not':'test_gateway'}},'select':{'amount':!![],'currency':!![],'amountAfterGatewayCommissionUSDT':!![]}}),database_1[_0x252594(0x1ed)][_0x252594(0x283)]['findMany']({'where':{'gateway':{'not':_0x252594(0x1fd)}},'take':0xa,'orderBy':{'createdAt':_0x252594(0x25f)},'include':{'shop':{'select':{'name':!![],'username':!![]}}}}),database_1['default']['payment'][_0x252594(0x1bb)]({'where':{'createdAt':_0x491a47,'gateway':{'not':_0x252594(0x1fd)}},'select':{'amount':!![],'currency':!![],'status':!![],'amountUSDT':!![],'createdAt':!![]}})]);let _0x12e24f=0x0,_0x16cdf0=0x0;for(const _0x41a19e of _0x4369f3){const _0x5c635e=await currencyService_1['currencyService']['convertToUSDT'](_0x41a19e['amount'],_0x41a19e[_0x252594(0x225)]);_0x12e24f+=_0x5c635e;if(_0x41a19e[_0x252594(0x1dc)]){const _0x534a4a=await currencyService_1[_0x252594(0x1a7)][_0x252594(0x1b9)](_0x41a19e[_0x252594(0x247)],_0x41a19e[_0x252594(0x225)]),_0x5767e9=_0x41a19e['amountAfterGatewayCommissionUSDT'],_0x5d0e3f=_0x534a4a-_0x5767e9;_0x16cdf0+=_0x5d0e3f;}}const _0x5d0d23=_0x49bba3>0x0?_0x12e24f/_0x49bba3:0x0,_0x450b31=this['generateDailyStatistics'](_0x4758d4,_0x12e2fc,_0x72e1a0||_0x196ac1),_0x497d7a=await database_1[_0x252594(0x1ed)]['payment'][_0x252594(0x261)]({'where':{'createdAt':_0x491a47,'gateway':{'not':_0x252594(0x1fd)}}}),_0x3d3e97=_0x497d7a>0x0?_0x49bba3/_0x497d7a*0x64:0x0;return{'totalShops':_0x167621,'activeShops':_0x54d5b4,'totalPayments':_0x49bba3,'successfulPayments':_0x49bba3,'totalAttempts':_0x497d7a,'totalRevenue':Math['round'](_0x12e24f*0x64)/0x64,'trapayEarnings':Math[_0x252594(0x277)](_0x16cdf0*0x64)/0x64,'averagePaymentAmount':Math[_0x252594(0x277)](_0x5d0d23*0x64)/0x64,'conversionRate':Math[_0x252594(0x277)](_0x3d3e97*0x64)/0x64,'dailyRevenue':_0x450b31[_0x252594(0x296)],'dailyPayments':_0x450b31[_0x252594(0x290)],'recentPayments':_0x10d22a['map'](_0x23a4f6=>({'id':_0x23a4f6['id'],'amount':_0x23a4f6[_0x252594(0x247)],'currency':_0x23a4f6[_0x252594(0x225)],'status':_0x23a4f6[_0x252594(0x2a9)],'gateway':_0x23a4f6['gateway'],'shop':_0x23a4f6[_0x252594(0x21b)],'createdAt':_0x23a4f6[_0x252594(0x25c)]}))};}async[a38_0xb6c9ae(0x1ad)](_0x2a31ed){const _0x1d52b4=a38_0xb6c9ae;console[_0x1d52b4(0x2a2)]('📊\x20Getting\x20merchant\x20statistics\x20with\x20filters:',_0x2a31ed);let _0x2b2dc3,_0x4eb896=new Date();if(_0x2a31ed['period']===_0x1d52b4(0x2c8)&&_0x2a31ed[_0x1d52b4(0x2a4)]&&_0x2a31ed[_0x1d52b4(0x29f)])_0x2b2dc3=new Date(_0x2a31ed[_0x1d52b4(0x2a4)]),_0x4eb896=new Date(_0x2a31ed[_0x1d52b4(0x29f)]),_0x2b2dc3[_0x1d52b4(0x26a)](0x0,0x0,0x0,0x0),_0x4eb896[_0x1d52b4(0x26a)](0x17,0x3b,0x3b,0x3e7);else{const _0x43982d=new Date();switch(_0x2a31ed[_0x1d52b4(0x245)]){case _0x1d52b4(0x2ba):_0x2b2dc3=new Date(_0x43982d[_0x1d52b4(0x221)]()-0x7*0x18*0x3c*0x3c*0x3e8);break;case _0x1d52b4(0x20b):_0x2b2dc3=new Date(_0x43982d[_0x1d52b4(0x221)]()-0x1e*0x18*0x3c*0x3c*0x3e8);break;case _0x1d52b4(0x28d):_0x2b2dc3=new Date(_0x43982d[_0x1d52b4(0x221)]()-0x16d*0x18*0x3c*0x3c*0x3e8);break;case _0x1d52b4(0x28c):default:_0x2b2dc3=new Date('2020-01-01');break;}_0x2b2dc3[_0x1d52b4(0x26a)](0x0,0x0,0x0,0x0),_0x4eb896[_0x1d52b4(0x26a)](0x17,0x3b,0x3b,0x3e7);}console['log']('📅\x20Period:\x20'+_0x2b2dc3['toISOString']()+_0x1d52b4(0x1e3)+_0x4eb896[_0x1d52b4(0x238)]());const _0x356f42={'status':_0x1d52b4(0x253),'gateway':{'not':'test_gateway'},'paidAt':{'gte':_0x2b2dc3,'lte':_0x4eb896}};_0x2a31ed[_0x1d52b4(0x1ea)]&&(_0x356f42[_0x1d52b4(0x1ea)]=_0x2a31ed['shopId']);const _0x19c294=await database_1[_0x1d52b4(0x1ed)][_0x1d52b4(0x283)][_0x1d52b4(0x1bb)]({'where':_0x356f42,'select':{'id':!![],'amount':!![],'currency':!![],'amountUSDT':!![],'amountAfterGatewayCommissionUSDT':!![],'gatewayCommissionRate':!![],'gateway':!![],'shopId':!![],'paidAt':!![],'shop':{'select':{'id':!![],'name':!![],'username':!![],'gatewaySettings':!![]}}}});console[_0x1d52b4(0x2a2)]('💰\x20Found\x20'+_0x19c294[_0x1d52b4(0x293)]+'\x20paid\x20payments\x20for\x20analysis');const _0x11321d={'gateway':{'not':_0x1d52b4(0x1fd)},'createdAt':{'gte':_0x2b2dc3,'lte':_0x4eb896}};_0x2a31ed['shopId']&&(_0x11321d[_0x1d52b4(0x1ea)]=_0x2a31ed['shopId']);const _0x22d690=await database_1[_0x1d52b4(0x1ed)]['payment']['count']({'where':_0x11321d});console[_0x1d52b4(0x2a2)](_0x1d52b4(0x278)+_0x22d690+_0x1d52b4(0x2b9)+_0x19c294[_0x1d52b4(0x293)]);let _0x14ee69=0x0,_0xa64132=0x0,_0x5cae07=0x0;const _0x2fee02={},_0x3dfb0d={},_0x354fe5={};for(const _0x21b1a6 of _0x19c294){try{const _0x412b2c=_0x21b1a6[_0x1d52b4(0x1f8)]||0x0;if(_0x412b2c<=0x0){console[_0x1d52b4(0x270)](_0x1d52b4(0x1b6)+_0x21b1a6['id']+'\x20has\x20zero\x20or\x20null\x20amountUSDT,\x20skipping...');continue;}let _0xe1321c,_0x1a46c8;if(_0x21b1a6['amountAfterGatewayCommissionUSDT']!==null&&_0x21b1a6[_0x1d52b4(0x1dc)]!==undefined)_0xe1321c=_0x21b1a6[_0x1d52b4(0x1dc)],_0x1a46c8=_0x412b2c-_0xe1321c,console['log'](_0x1d52b4(0x24e)+_0x21b1a6['id']+':\x20'+_0x412b2c[_0x1d52b4(0x2d6)](0x6)+_0x1d52b4(0x1cf)+_0xe1321c[_0x1d52b4(0x2d6)](0x6)+_0x1d52b4(0x27c));else{let _0x5273e6={};if(_0x21b1a6['shop'][_0x1d52b4(0x2ca)])try{_0x5273e6=JSON[_0x1d52b4(0x25e)](_0x21b1a6[_0x1d52b4(0x21b)][_0x1d52b4(0x2ca)]);}catch(_0x27cddc){console[_0x1d52b4(0x199)](_0x1d52b4(0x2a0)+_0x21b1a6[_0x1d52b4(0x1ea)]+':',_0x27cddc);}let _0x5278ee=0x2d;for(const [_0x53e90b,_0x4b4939]of Object[_0x1d52b4(0x1a0)](_0x5273e6)){if(_0x53e90b[_0x1d52b4(0x2b6)]()===_0x21b1a6['gateway']['toLowerCase']()){_0x5278ee=_0x4b4939[_0x1d52b4(0x24d)]||0x2d;break;}}_0x1a46c8=_0x412b2c*(_0x5278ee/0x64),_0xe1321c=_0x412b2c-_0x1a46c8,console[_0x1d52b4(0x2a2)](_0x1d52b4(0x1fb)+_0x21b1a6['id']+':\x20'+_0x5278ee+'%\x20from\x20'+_0x412b2c[_0x1d52b4(0x2d6)](0x6)+_0x1d52b4(0x27c));}_0x14ee69+=_0x412b2c,_0xa64132+=_0xe1321c,_0x5cae07+=_0x1a46c8;let _0x4c15df;_0x21b1a6[_0x1d52b4(0x266)]!==null&&_0x21b1a6[_0x1d52b4(0x266)]!==undefined?(_0x4c15df=_0x21b1a6[_0x1d52b4(0x266)],console[_0x1d52b4(0x2a2)](_0x1d52b4(0x257)+_0x21b1a6['id']+':\x20'+_0x4c15df+'%')):(_0x4c15df=_0x412b2c>0x0?_0x1a46c8/_0x412b2c*0x64:0x0,console[_0x1d52b4(0x2a2)]('📊\x20Calculated\x20commission\x20rate\x20for\x20payment\x20'+_0x21b1a6['id']+':\x20'+_0x4c15df[_0x1d52b4(0x2d6)](0x2)+'%'));!_0x2fee02[_0x21b1a6[_0x1d52b4(0x229)]]&&(_0x2fee02[_0x21b1a6[_0x1d52b4(0x229)]]={'gateway':_0x21b1a6[_0x1d52b4(0x229)],'gatewayDisplayName':this['getGatewayDisplayName'](_0x21b1a6[_0x1d52b4(0x229)]),'paymentsCount':0x0,'turnoverUSDT':0x0,'commissionUSDT':0x0,'merchantEarningsUSDT':0x0,'totalCommissionRate':0x0});_0x2fee02[_0x21b1a6[_0x1d52b4(0x229)]][_0x1d52b4(0x1cd)]++,_0x2fee02[_0x21b1a6[_0x1d52b4(0x229)]]['turnoverUSDT']+=_0x412b2c,_0x2fee02[_0x21b1a6[_0x1d52b4(0x229)]][_0x1d52b4(0x27f)]+=_0x1a46c8,_0x2fee02[_0x21b1a6['gateway']][_0x1d52b4(0x254)]+=_0xe1321c,_0x2fee02[_0x21b1a6[_0x1d52b4(0x229)]][_0x1d52b4(0x1f0)]+=_0x4c15df;!_0x2a31ed['shopId']&&(!_0x3dfb0d[_0x21b1a6[_0x1d52b4(0x1ea)]]&&(_0x3dfb0d[_0x21b1a6[_0x1d52b4(0x1ea)]]={'shopId':_0x21b1a6['shopId'],'shopName':_0x21b1a6['shop'][_0x1d52b4(0x23a)],'shopUsername':_0x21b1a6[_0x1d52b4(0x21b)][_0x1d52b4(0x1dd)],'paymentsCount':0x0,'turnoverUSDT':0x0,'commissionUSDT':0x0,'merchantEarningsUSDT':0x0,'paidOutUSDT':0x0,'averageCheckUSDT':0x0}),_0x3dfb0d[_0x21b1a6['shopId']][_0x1d52b4(0x1cd)]++,_0x3dfb0d[_0x21b1a6[_0x1d52b4(0x1ea)]][_0x1d52b4(0x2c4)]+=_0x412b2c,_0x3dfb0d[_0x21b1a6[_0x1d52b4(0x1ea)]]['commissionUSDT']+=_0x1a46c8,_0x3dfb0d[_0x21b1a6[_0x1d52b4(0x1ea)]][_0x1d52b4(0x254)]+=_0xe1321c);const _0x127d75=_0x21b1a6[_0x1d52b4(0x26e)][_0x1d52b4(0x238)]()[_0x1d52b4(0x27d)]('T')[0x0];!_0x354fe5[_0x127d75]&&(_0x354fe5[_0x127d75]={'date':_0x127d75,'turnover':0x0,'merchantEarnings':0x0,'gatewayEarnings':0x0,'paymentsCount':0x0}),_0x354fe5[_0x127d75]['turnover']+=_0x412b2c,_0x354fe5[_0x127d75]['merchantEarnings']+=_0xe1321c,_0x354fe5[_0x127d75][_0x1d52b4(0x1c5)]+=_0x1a46c8,_0x354fe5[_0x127d75][_0x1d52b4(0x1cd)]++;}catch(_0x3963da){console[_0x1d52b4(0x199)](_0x1d52b4(0x1de)+_0x21b1a6['id']+':',_0x3963da);}}Object['values'](_0x2fee02)['forEach'](_0x4f486c=>{const _0x3c3888=_0x1d52b4;_0x4f486c[_0x3c3888(0x2a3)]=_0x4f486c['paymentsCount']>0x0?_0x4f486c[_0x3c3888(0x1f0)]/_0x4f486c[_0x3c3888(0x1cd)]:0x0,delete _0x4f486c['totalCommissionRate'];}),Object[_0x1d52b4(0x241)](_0x3dfb0d)[_0x1d52b4(0x1a5)](_0x4a0e1c=>{const _0x133189=_0x1d52b4;_0x4a0e1c[_0x133189(0x215)]=_0x4a0e1c[_0x133189(0x1cd)]>0x0?_0x4a0e1c[_0x133189(0x2c4)]/_0x4a0e1c[_0x133189(0x1cd)]:0x0;});let _0x39c608=0x0,_0x543fb0=0x0;if(_0x2a31ed[_0x1d52b4(0x1ea)]){const _0x3ee178=await database_1[_0x1d52b4(0x1ed)][_0x1d52b4(0x2c1)][_0x1d52b4(0x1bb)]({'where':{'shopId':_0x2a31ed[_0x1d52b4(0x1ea)],'status':_0x1d52b4(0x25b),'createdAt':{'gte':_0x2b2dc3,'lte':_0x4eb896}},'select':{'amount':!![]}});_0x39c608=_0x3ee178[_0x1d52b4(0x2b2)]((_0x571fd3,_0x44cfa7)=>_0x571fd3+_0x44cfa7[_0x1d52b4(0x247)],0x0);const _0x446d65=await database_1['default']['payout'][_0x1d52b4(0x1bb)]({'where':{'shopId':_0x2a31ed[_0x1d52b4(0x1ea)],'status':'PENDING','createdAt':{'gte':_0x2b2dc3,'lte':_0x4eb896}},'select':{'amount':!![]}});_0x543fb0=_0x446d65[_0x1d52b4(0x2b2)]((_0x593673,_0xf9e46f)=>_0x593673+_0xf9e46f[_0x1d52b4(0x247)],0x0);}const _0x430ed6=_0x22d690,_0x3af6b4=_0x19c294[_0x1d52b4(0x293)],_0x23ba1b=_0x3af6b4>0x0?_0x14ee69/_0x3af6b4:0x0,_0x524486=_0x430ed6>0x0?Math[_0x1d52b4(0x277)](_0x3af6b4/_0x430ed6*0x2710)/0x64:0x0,_0x4b75da=Math['ceil']((_0x4eb896['getTime']()-_0x2b2dc3[_0x1d52b4(0x221)]())/(0x3e8*0x3c*0x3c*0x18)),_0x1cd7bf={'totalTurnover':Math['round'](_0x14ee69*0x64)/0x64,'merchantEarnings':Math[_0x1d52b4(0x277)](_0xa64132*0x64)/0x64,'gatewayEarnings':Math[_0x1d52b4(0x277)](_0x5cae07*0x64)/0x64,'totalPaidOut':Math[_0x1d52b4(0x277)](_0x39c608*0x64)/0x64,'pendingPayout':Math[_0x1d52b4(0x277)](_0x543fb0*0x64)/0x64,'averageCheck':Math[_0x1d52b4(0x277)](_0x23ba1b*0x64)/0x64,'totalPayments':_0x430ed6,'successfulPayments':_0x3af6b4,'conversionRate':_0x524486,'gatewayBreakdown':Object['values'](_0x2fee02)[_0x1d52b4(0x289)](_0x5b9a0e=>({..._0x5b9a0e,'turnoverUSDT':Math['round'](_0x5b9a0e['turnoverUSDT']*0x64)/0x64,'commissionUSDT':Math[_0x1d52b4(0x277)](_0x5b9a0e[_0x1d52b4(0x27f)]*0x64)/0x64,'merchantEarningsUSDT':Math[_0x1d52b4(0x277)](_0x5b9a0e[_0x1d52b4(0x254)]*0x64)/0x64,'averageCommissionRate':Math['round'](_0x5b9a0e[_0x1d52b4(0x2a3)]*0x64)/0x64})),'merchantBreakdown':_0x2a31ed[_0x1d52b4(0x1ea)]?undefined:Object[_0x1d52b4(0x241)](_0x3dfb0d)['map'](_0x407a85=>({..._0x407a85,'turnoverUSDT':Math[_0x1d52b4(0x277)](_0x407a85['turnoverUSDT']*0x64)/0x64,'commissionUSDT':Math[_0x1d52b4(0x277)](_0x407a85[_0x1d52b4(0x27f)]*0x64)/0x64,'merchantEarningsUSDT':Math[_0x1d52b4(0x277)](_0x407a85[_0x1d52b4(0x254)]*0x64)/0x64,'paidOutUSDT':Math['round'](_0x407a85[_0x1d52b4(0x1d1)]*0x64)/0x64,'averageCheckUSDT':Math[_0x1d52b4(0x277)](_0x407a85['averageCheckUSDT']*0x64)/0x64})),'dailyData':Object['values'](_0x354fe5)['map'](_0x28b4cb=>({..._0x28b4cb,'turnover':Math['round'](_0x28b4cb[_0x1d52b4(0x236)]*0x64)/0x64,'merchantEarnings':Math['round'](_0x28b4cb[_0x1d52b4(0x2a1)]*0x64)/0x64,'gatewayEarnings':Math[_0x1d52b4(0x277)](_0x28b4cb[_0x1d52b4(0x1c5)]*0x64)/0x64}))[_0x1d52b4(0x19a)]((_0x2b3dd4,_0x3029ac)=>_0x2b3dd4[_0x1d52b4(0x208)]['localeCompare'](_0x3029ac[_0x1d52b4(0x208)])),'periodInfo':{'from':_0x2b2dc3,'to':_0x4eb896,'periodType':_0x2a31ed[_0x1d52b4(0x245)]||'custom','daysCount':_0x4b75da}};return console['log']('📊\x20Merchant\x20statistics\x20calculated:'),console[_0x1d52b4(0x2a2)](_0x1d52b4(0x1bf)+_0x1cd7bf[_0x1d52b4(0x2d4)]+_0x1d52b4(0x27c)),console['log'](_0x1d52b4(0x21f)+_0x1cd7bf[_0x1d52b4(0x2a1)]+_0x1d52b4(0x27c)),console[_0x1d52b4(0x2a2)](_0x1d52b4(0x1f3)+_0x1cd7bf[_0x1d52b4(0x1c5)]+'\x20USDT'),console['log'](_0x1d52b4(0x297)+_0x1cd7bf[_0x1d52b4(0x2a8)]+_0x1d52b4(0x27c)),console[_0x1d52b4(0x2a2)](_0x1d52b4(0x22e)+_0x1cd7bf['pendingPayout']+_0x1d52b4(0x27c)),console[_0x1d52b4(0x2a2)](_0x1d52b4(0x1e2)+_0x1cd7bf[_0x1d52b4(0x26f)]),_0x1cd7bf;}async[a38_0xb6c9ae(0x23e)](){const _0x39f74c=a38_0xb6c9ae;console['log'](_0x39f74c(0x21e));const _0x4a0071=await database_1['default'][_0x39f74c(0x21b)][_0x39f74c(0x1bb)]({'where':{'status':_0x39f74c(0x26b)},'select':{'id':!![],'username':!![],'name':!![]},'orderBy':{'name':_0x39f74c(0x240)}});return console[_0x39f74c(0x2a2)](_0x39f74c(0x272)+_0x4a0071[_0x39f74c(0x293)]+_0x39f74c(0x248)),_0x4a0071[_0x39f74c(0x289)](_0x1f0e49=>({'id':_0x1f0e49['id'],'username':_0x1f0e49[_0x39f74c(0x1dd)],'name':_0x1f0e49['name']}));}[a38_0xb6c9ae(0x2c9)](_0x458f32){const _0x4e4b17=a38_0xb6c9ae,_0x24ca5e={'test_gateway':_0x4e4b17(0x21a),'plisio':_0x4e4b17(0x234),'rapyd':'Rapyd','noda':_0x4e4b17(0x1a6),'cointopay':'CoinToPay','cointopay2':_0x4e4b17(0x1c9),'klyme_eu':'KLYME\x20EU','klyme_gb':_0x4e4b17(0x22a),'klyme_de':_0x4e4b17(0x2bd),'mastercard':_0x4e4b17(0x246)};return _0x24ca5e[_0x458f32]||_0x458f32;}[a38_0xb6c9ae(0x29d)](_0x3d98ab){const _0x3ca0a9=a38_0xb6c9ae,_0x3d4126={'Test\x20Gateway':_0x3ca0a9(0x1fd),'Plisio':_0x3ca0a9(0x228),'Rapyd':_0x3ca0a9(0x1bc),'Noda':_0x3ca0a9(0x22d),'CoinToPay':_0x3ca0a9(0x1c3),'CoinToPay2':'cointopay2','KLYME\x20EU':_0x3ca0a9(0x1a4),'KLYME\x20GB':_0x3ca0a9(0x24a),'KLYME\x20DE':_0x3ca0a9(0x1ae),'MasterCard':_0x3ca0a9(0x27b)};return _0x3d4126[_0x3d98ab]||_0x3d98ab['toLowerCase']();}async[a38_0xb6c9ae(0x285)](_0x61bbab){const _0x4cfc03=a38_0xb6c9ae,{page:_0x2364b3,limit:_0x5b5be8,minAmount:_0x15ff4e,search:_0x4268a3}=_0x61bbab,_0x122bdd=(_0x2364b3-0x1)*_0x5b5be8;console['log']('📊\x20Getting\x20merchants\x20awaiting\x20payout\x20with\x20filters:',_0x61bbab);const _0x3f692a={'balance':{'gt':0x0},'status':_0x4cfc03(0x26b)};_0x15ff4e&&(_0x3f692a[_0x4cfc03(0x21d)][_0x4cfc03(0x1f5)]=_0x15ff4e);_0x4268a3&&(_0x3f692a['name']={'contains':_0x4268a3,'mode':'insensitive'});const [_0x5a5b6c,_0x5ee2df]=await Promise[_0x4cfc03(0x28c)]([database_1[_0x4cfc03(0x1ed)][_0x4cfc03(0x21b)][_0x4cfc03(0x1bb)]({'where':_0x3f692a,'skip':_0x122bdd,'take':_0x5b5be8,'orderBy':{'balance':_0x4cfc03(0x25f)},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'balance':!![],'totalPaidOut':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'usdcErcWallet':!![],'gatewaySettings':!![],'createdAt':!![]}}),database_1[_0x4cfc03(0x1ed)][_0x4cfc03(0x21b)]['count']({'where':_0x3f692a})]);console[_0x4cfc03(0x2a2)](_0x4cfc03(0x2ad)+_0x5a5b6c['length']+'\x20merchants\x20with\x20positive\x20balance');const _0x93d35f=await Promise[_0x4cfc03(0x28c)](_0x5a5b6c['map'](async _0x3324c6=>{const _0x3572b2=_0x4cfc03,[_0x514d44,_0x3a4396,_0x4bd679]=await Promise[_0x3572b2(0x28c)]([database_1[_0x3572b2(0x1ed)][_0x3572b2(0x283)][_0x3572b2(0x261)]({'where':{'shopId':_0x3324c6['id'],'status':_0x3572b2(0x253),'gateway':{'not':_0x3572b2(0x1fd)}}}),database_1[_0x3572b2(0x1ed)][_0x3572b2(0x283)][_0x3572b2(0x286)]({'where':{'shopId':_0x3324c6['id'],'status':_0x3572b2(0x253),'gateway':{'not':_0x3572b2(0x1fd)}},'orderBy':{'paidAt':_0x3572b2(0x240)},'select':{'paidAt':!![]}}),database_1[_0x3572b2(0x1ed)]['payment'][_0x3572b2(0x20e)]({'by':[_0x3572b2(0x229)],'where':{'shopId':_0x3324c6['id'],'status':_0x3572b2(0x253),'gateway':{'not':'test_gateway'}},'_count':{'id':!![]},'_sum':{'amountUSDT':!![]}})]),_0x4afd0d=new Date(),_0x39a9f0=new Date(_0x4afd0d['getFullYear'](),_0x4afd0d[_0x3572b2(0x1a2)](),0x1),_0x39c52b=new Date(_0x4afd0d[_0x3572b2(0x204)](),_0x4afd0d[_0x3572b2(0x1a2)]()+0x1,0x0,0x17,0x3b,0x3b,0x3e7),[_0x5d2c39,_0x586d10]=await Promise['all']([database_1['default'][_0x3572b2(0x2c1)][_0x3572b2(0x239)]({'_sum':{'amount':!![]},'where':{'shopId':_0x3324c6['id'],'status':'COMPLETED'}}),database_1[_0x3572b2(0x1ed)][_0x3572b2(0x2c1)][_0x3572b2(0x239)]({'_sum':{'amount':!![]},'where':{'shopId':_0x3324c6['id'],'status':_0x3572b2(0x25b),'createdAt':{'gte':_0x39a9f0,'lte':_0x39c52b}}})]),_0x44f4b5=_0x5d2c39['_sum'][_0x3572b2(0x247)]||0x0,_0x4da441=_0x586d10[_0x3572b2(0x2c3)]['amount']||0x0,_0x3be65e=await Promise[_0x3572b2(0x28c)](_0x4bd679['map'](async _0x471e03=>{const _0x4769f8=_0x3572b2;let _0x37b371=0x2d;if(_0x3324c6[_0x4769f8(0x2ca)])try{const _0x38d20f=JSON[_0x4769f8(0x25e)](_0x3324c6[_0x4769f8(0x2ca)]);for(const [_0x4c9668,_0x4dc404]of Object['entries'](_0x38d20f)){if(_0x4c9668[_0x4769f8(0x2b6)]()===_0x471e03[_0x4769f8(0x229)][_0x4769f8(0x2b6)]()){_0x37b371=_0x4dc404['commission']||0xa,console[_0x4769f8(0x2a2)](_0x4769f8(0x1d8)+_0x471e03['gateway']+_0x4769f8(0x1db)+_0x3324c6['id']+_0x4769f8(0x1d7)+_0x37b371+'%');break;}}}catch(_0xd387de){console['error']('Error\x20parsing\x20gateway\x20settings\x20for\x20shop\x20'+_0x3324c6['id']+':',_0xd387de);}const _0x134399=_0x471e03['_sum']?.[_0x4769f8(0x1f8)]||0x0,_0x330363=_0x134399*(0x1-_0x37b371/0x64);return{'gateway':_0x471e03['gateway'],'count':_0x471e03[_0x4769f8(0x2bc)]?.['id']||0x0,'amountUSDT':Math['round'](_0x134399*0x64)/0x64,'amountAfterCommissionUSDT':Math[_0x4769f8(0x277)](_0x330363*0x64)/0x64,'commission':_0x37b371};})),_0x1de750=_0x3be65e['reduce']((_0x1787c4,_0x3800ad)=>_0x1787c4+_0x3800ad[_0x3572b2(0x1f8)],0x0),_0x41ba3c=_0x3be65e[_0x3572b2(0x2b2)]((_0x319672,_0x4f03b2)=>_0x319672+_0x4f03b2['amountAfterCommissionUSDT'],0x0),_0x8f8425=_0x3324c6[_0x3572b2(0x21d)];return console[_0x3572b2(0x2a2)](_0x3572b2(0x1ce)+_0x3324c6[_0x3572b2(0x1dd)]+':'),console['log']('\x20\x20\x20�\x20Total\x20payments\x20turnover:\x20'+_0x1de750['toFixed'](0x2)+'\x20USDT\x20(gross\x20revenue)'),console[_0x3572b2(0x2a2)](_0x3572b2(0x235)+_0x41ba3c[_0x3572b2(0x2d6)](0x2)+_0x3572b2(0x237)),console[_0x3572b2(0x2a2)]('\x20\x20\x20✅\x20Actual\x20available\x20balance:\x20'+_0x8f8425[_0x3572b2(0x2d6)](0x2)+'\x20USDT\x20(current\x20balance\x20in\x20DB)'),console[_0x3572b2(0x2a2)](_0x3572b2(0x2b4)+_0x44f4b5[_0x3572b2(0x2d6)](0x2)+_0x3572b2(0x2d5)),console['log'](_0x3572b2(0x1c2)+(_0x41ba3c-_0x44f4b5-_0x8f8425)['toFixed'](0x2)+'\x20USDT\x20(calculated\x20-\x20payouts\x20-\x20balance)'),{'id':_0x3324c6['id'],'fullName':_0x3324c6[_0x3572b2(0x23a)],'username':_0x3324c6[_0x3572b2(0x1dd)],'telegramId':_0x3324c6[_0x3572b2(0x20d)],'merchantUrl':_0x3324c6[_0x3572b2(0x29c)],'wallets':{'usdtPolygonWallet':_0x3324c6['usdtPolygonWallet'],'usdtTrcWallet':_0x3324c6[_0x3572b2(0x1e7)],'usdtErcWallet':_0x3324c6[_0x3572b2(0x24b)],'usdcPolygonWallet':_0x3324c6['usdcPolygonWallet'],'usdcErcWallet':_0x3324c6[_0x3572b2(0x1cc)]},'totalAmountUSDT':Math[_0x3572b2(0x277)](_0x1de750*0x64)/0x64,'totalAmountAfterCommissionUSDT':Math[_0x3572b2(0x277)](_0x41ba3c*0x64)/0x64,'currentBalance':Math[_0x3572b2(0x277)](_0x8f8425*0x64)/0x64,'totalPayout':Math[_0x3572b2(0x277)](_0x44f4b5*0x64)/0x64,'thisMonth':Math[_0x3572b2(0x277)](_0x4da441*0x64)/0x64,'paymentsCount':_0x514d44,'oldestPaymentDate':_0x3a4396?.[_0x3572b2(0x26e)]||_0x3324c6[_0x3572b2(0x25c)],'gatewayBreakdown':_0x3be65e};})),_0xda4eac=_0x93d35f[_0x4cfc03(0x2b2)]((_0x29fd3c,_0x291b39)=>_0x29fd3c+_0x291b39[_0x4cfc03(0x249)],0x0),_0x7eaf7d=_0x93d35f['reduce']((_0x37d203,_0x181523)=>_0x37d203+_0x181523[_0x4cfc03(0x1c1)],0x0),_0x59e47e=_0x93d35f['reduce']((_0x236b31,_0xfcacd6)=>_0x236b31+_0xfcacd6[_0x4cfc03(0x264)],0x0),_0x2f4fdd=_0x93d35f[_0x4cfc03(0x2b2)]((_0x5bbb07,_0x359f95)=>_0x5bbb07+_0x359f95['thisMonth'],0x0);return console['log'](_0x4cfc03(0x1ec)+_0x5ee2df+_0x4cfc03(0x230)),console[_0x4cfc03(0x2a2)](_0x4cfc03(0x1b8)+Math[_0x4cfc03(0x277)](_0xda4eac*0x64)/0x64+_0x4cfc03(0x22f)),console['log'](_0x4cfc03(0x2b7)+Math[_0x4cfc03(0x277)](_0x7eaf7d*0x64)/0x64+_0x4cfc03(0x1a1)),console[_0x4cfc03(0x2a2)](_0x4cfc03(0x2c2)+Math[_0x4cfc03(0x277)](_0x59e47e*0x64)/0x64+_0x4cfc03(0x27c)),console[_0x4cfc03(0x2a2)](_0x4cfc03(0x1f9)+Math[_0x4cfc03(0x277)](_0x2f4fdd*0x64)/0x64+_0x4cfc03(0x27c)),{'merchants':_0x93d35f,'pagination':{'page':_0x2364b3,'limit':_0x5b5be8,'total':_0x5ee2df,'totalPages':Math[_0x4cfc03(0x1fe)](_0x5ee2df/_0x5b5be8)},'summary':{'totalMerchants':_0x5ee2df,'totalAmountUSDT':Math[_0x4cfc03(0x277)](_0xda4eac*0x64)/0x64,'totalAmountAfterCommissionUSDT':Math['round'](_0x7eaf7d*0x64)/0x64,'totalPayout':Math[_0x4cfc03(0x277)](_0x59e47e*0x64)/0x64,'thisMonth':Math[_0x4cfc03(0x277)](_0x2f4fdd*0x64)/0x64}};}async['createPayout'](_0xa2a64b){const _0x3affc9=a38_0xb6c9ae,{shopId:_0x3f133,amount:_0x3991a2,network:_0x2185b6,wallet:_0x24b74d,notes:_0x2fb4d3,txid:_0x194564,periodFrom:_0x1a5499,periodTo:_0x3e77ad}=_0xa2a64b,_0x1fc740=await database_1[_0x3affc9(0x1ed)][_0x3affc9(0x2b5)](async _0xd9f3fd=>{const _0x4b57ee=_0x3affc9,_0x140cec=await _0xd9f3fd['shop'][_0x4b57ee(0x2ab)]({'where':{'id':_0x3f133},'select':{'id':!![],'name':!![],'username':!![],'balance':!![],'totalPaidOut':!![]}});if(!_0x140cec)throw new Error(_0x4b57ee(0x2d7));console['log']('💰\x20Creating\x20payout\x20for\x20shop\x20'+_0x140cec['username']+':'),console[_0x4b57ee(0x2a2)](_0x4b57ee(0x2ac)+_0x140cec[_0x4b57ee(0x21d)][_0x4b57ee(0x2d6)](0x6)+_0x4b57ee(0x27c)),console[_0x4b57ee(0x2a2)](_0x4b57ee(0x291)+_0x3991a2[_0x4b57ee(0x2d6)](0x6)+_0x4b57ee(0x27c)),console[_0x4b57ee(0x2a2)](_0x4b57ee(0x224)+_0x140cec['totalPaidOut']['toFixed'](0x6)+_0x4b57ee(0x27c));if(_0x194564)console[_0x4b57ee(0x2a2)]('\x20\x20\x20Transaction\x20hash:\x20'+_0x194564);if(_0x140cec[_0x4b57ee(0x21d)]<_0x3991a2)throw new Error('Insufficient\x20balance.\x20Available:\x20'+_0x140cec[_0x4b57ee(0x21d)][_0x4b57ee(0x2d6)](0x6)+'\x20USDT,\x20Requested:\x20'+_0x3991a2['toFixed'](0x6)+_0x4b57ee(0x27c));let _0x50f3e0=_0x24b74d;if(!_0x50f3e0){const _0x26502e=await _0xd9f3fd[_0x4b57ee(0x21b)][_0x4b57ee(0x2ab)]({'where':{'id':_0x3f133},'select':{'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'usdcErcWallet':!![]}});if(_0x26502e)switch(_0x2185b6){case _0x4b57ee(0x259):_0x50f3e0=_0x26502e[_0x4b57ee(0x19b)]||undefined;break;case _0x4b57ee(0x2b1):_0x50f3e0=_0x26502e[_0x4b57ee(0x1e7)]||undefined;break;case _0x4b57ee(0x288):_0x50f3e0=_0x26502e['usdtErcWallet']||undefined;break;case _0x4b57ee(0x271):_0x50f3e0=_0x26502e[_0x4b57ee(0x298)]||undefined;break;case _0x4b57ee(0x2bb):_0x50f3e0=_0x26502e['usdcErcWallet']||undefined;break;}}console[_0x4b57ee(0x2a2)](_0x4b57ee(0x262)+_0x2185b6+':\x20'+(_0x50f3e0||_0x4b57ee(0x207)));const _0x1fad37=await _0xd9f3fd[_0x4b57ee(0x2c1)]['create']({'data':{'shopId':_0x3f133,'amount':_0x3991a2,'network':_0x2185b6,'status':'COMPLETED','txid':_0x194564,'notes':_0x2fb4d3,'periodFrom':_0x1a5499?new Date(_0x1a5499):null,'periodTo':_0x3e77ad?new Date(_0x3e77ad):null,'createdAt':new Date(),'paidAt':new Date()}}),_0x1f74d=_0x140cec[_0x4b57ee(0x21d)]-_0x3991a2,_0x5a6b19=_0x140cec[_0x4b57ee(0x2a8)]+_0x3991a2;return await _0xd9f3fd[_0x4b57ee(0x21b)][_0x4b57ee(0x22c)]({'where':{'id':_0x3f133},'data':{'balance':_0x1f74d,'totalPaidOut':_0x5a6b19}}),console['log'](_0x4b57ee(0x214)+_0x140cec['username']+'\x20balance\x20updated:'),console[_0x4b57ee(0x2a2)]('\x20\x20\x20Balance:\x20'+_0x140cec[_0x4b57ee(0x21d)][_0x4b57ee(0x2d6)](0x6)+'\x20->\x20'+_0x1f74d[_0x4b57ee(0x2d6)](0x6)+_0x4b57ee(0x1eb)+_0x3991a2[_0x4b57ee(0x2d6)](0x6)+')'),console['log'](_0x4b57ee(0x287)+_0x140cec[_0x4b57ee(0x2a8)][_0x4b57ee(0x2d6)](0x6)+_0x4b57ee(0x2c7)+_0x5a6b19['toFixed'](0x6)+_0x4b57ee(0x1c4)+_0x3991a2[_0x4b57ee(0x2d6)](0x6)+')'),{'payout':_0x1fad37,'shop':_0x140cec};});return console['log'](_0x3affc9(0x275)+_0x1fc740[_0x3affc9(0x2c1)]['id']+_0x3affc9(0x1db)+_0x1fc740[_0x3affc9(0x21b)][_0x3affc9(0x1dd)]+'\x20('+_0x3991a2+'\x20USDT)'),{'id':_0x1fc740[_0x3affc9(0x2c1)]['id'],'shopId':_0x1fc740[_0x3affc9(0x2c1)][_0x3affc9(0x1ea)],'shopName':_0x1fc740[_0x3affc9(0x21b)]['name'],'shopUsername':_0x1fc740['shop'][_0x3affc9(0x1dd)],'amount':_0x1fc740[_0x3affc9(0x2c1)][_0x3affc9(0x247)],'network':_0x1fc740[_0x3affc9(0x2c1)][_0x3affc9(0x243)],'status':_0x1fc740[_0x3affc9(0x2c1)][_0x3affc9(0x2a9)],'txid':_0x1fc740[_0x3affc9(0x2c1)][_0x3affc9(0x2b3)],'notes':_0x1fc740[_0x3affc9(0x2c1)]['notes'],'periodFrom':_0x1fc740['payout']['periodFrom'],'periodTo':_0x1fc740[_0x3affc9(0x2c1)][_0x3affc9(0x22b)],'createdAt':_0x1fc740[_0x3affc9(0x2c1)]['createdAt'],'paidAt':_0x1fc740[_0x3affc9(0x2c1)][_0x3affc9(0x26e)]};}async[a38_0xb6c9ae(0x20f)](_0x402c18){const _0x31050b=a38_0xb6c9ae,{page:_0x3f562e,limit:_0x2d8b18,shopId:_0x1043cf,network:_0x2f162a,dateFrom:_0x4036e8,dateTo:_0xd0d38d,search:_0x115867}=_0x402c18,_0x4a1b41=(_0x3f562e-0x1)*_0x2d8b18,_0x47408f={};_0x1043cf&&(_0x47408f['shopId']=_0x1043cf);_0x2f162a&&(_0x47408f[_0x31050b(0x243)]=_0x2f162a);(_0x4036e8||_0xd0d38d)&&(_0x47408f[_0x31050b(0x25c)]={},_0x4036e8&&(_0x47408f[_0x31050b(0x25c)]['gte']=new Date(_0x4036e8)),_0xd0d38d&&(_0x47408f['createdAt']['lte']=new Date(_0xd0d38d)));_0x115867&&(_0x47408f['OR']=[{'shop':{'name':{'contains':_0x115867,'mode':_0x31050b(0x209)}}},{'shop':{'username':{'contains':_0x115867,'mode':_0x31050b(0x209)}}},{'notes':{'contains':_0x115867,'mode':_0x31050b(0x209)}}]);const [_0x49a6fe,_0xde5335]=await Promise['all']([database_1[_0x31050b(0x1ed)][_0x31050b(0x2c1)][_0x31050b(0x1bb)]({'where':_0x47408f,'skip':_0x4a1b41,'take':_0x2d8b18,'orderBy':{'createdAt':_0x31050b(0x25f)},'select':{'id':!![],'shopId':!![],'amount':!![],'network':!![],'status':!![],'txid':!![],'notes':!![],'periodFrom':!![],'periodTo':!![],'createdAt':!![],'paidAt':!![],'shop':{'select':{'name':!![],'username':!![]}}}}),database_1[_0x31050b(0x1ed)][_0x31050b(0x2c1)][_0x31050b(0x261)]({'where':_0x47408f})]);return{'payouts':_0x49a6fe[_0x31050b(0x289)](_0x46529d=>({'id':_0x46529d['id'],'shopId':_0x46529d[_0x31050b(0x1ea)],'shopName':_0x46529d[_0x31050b(0x21b)]['name'],'shopUsername':_0x46529d[_0x31050b(0x21b)][_0x31050b(0x1dd)],'amount':_0x46529d['amount'],'network':_0x46529d[_0x31050b(0x243)],'status':_0x46529d[_0x31050b(0x2a9)],'txid':_0x46529d[_0x31050b(0x2b3)],'notes':_0x46529d[_0x31050b(0x244)],'periodFrom':_0x46529d[_0x31050b(0x233)],'periodTo':_0x46529d['periodTo'],'createdAt':_0x46529d[_0x31050b(0x25c)],'paidAt':_0x46529d[_0x31050b(0x26e)]})),'pagination':{'page':_0x3f562e,'limit':_0x2d8b18,'total':_0xde5335,'totalPages':Math['ceil'](_0xde5335/_0x2d8b18)}};}async[a38_0xb6c9ae(0x2c5)](_0x2a2636){const _0x4d9b02=a38_0xb6c9ae,_0x382af3=await database_1['default']['payout'][_0x4d9b02(0x2ab)]({'where':{'id':_0x2a2636},'include':{'shop':{'select':{'name':!![],'username':!![]}}}});if(!_0x382af3)return null;return{'id':_0x382af3['id'],'shopId':_0x382af3[_0x4d9b02(0x1ea)],'shopName':_0x382af3['shop'][_0x4d9b02(0x23a)],'shopUsername':_0x382af3[_0x4d9b02(0x21b)][_0x4d9b02(0x1dd)],'amount':_0x382af3[_0x4d9b02(0x247)],'network':_0x382af3[_0x4d9b02(0x243)],'status':_0x382af3[_0x4d9b02(0x2a9)],'txid':_0x382af3['txid'],'notes':_0x382af3['notes'],'periodFrom':_0x382af3['periodFrom'],'periodTo':_0x382af3[_0x4d9b02(0x22b)],'createdAt':_0x382af3[_0x4d9b02(0x25c)],'paidAt':_0x382af3[_0x4d9b02(0x26e)]};}async[a38_0xb6c9ae(0x29a)](_0x2ec708){const _0x596c6e=a38_0xb6c9ae;await database_1[_0x596c6e(0x1ed)][_0x596c6e(0x2c1)][_0x596c6e(0x24f)]({'where':{'id':_0x2ec708}});}async[a38_0xb6c9ae(0x274)](_0x15dec8){const _0x3feb46=a38_0xb6c9ae,{page:_0xae35a9,limit:_0x5c1cdb,status:_0x24ac39,gateway:_0x47d739,shopId:_0x1317de,dateFrom:_0x290a18,dateTo:_0x31a5f5,search:_0x3c5817,currency:_0x1de471,sortBy:_0xbb89fe,sortOrder:_0x278385}=_0x15dec8,_0x32aed4=(_0xae35a9-0x1)*_0x5c1cdb;console[_0x3feb46(0x2a2)]('📊\x20Getting\x20payments\x20with\x20filters:',_0x15dec8);const _0x4bd9f0=await database_1[_0x3feb46(0x1ed)][_0x3feb46(0x283)]['groupBy']({'by':[_0x3feb46(0x229)],'_count':{'gateway':!![]}});console[_0x3feb46(0x2a2)](_0x3feb46(0x1b7),_0x4bd9f0[_0x3feb46(0x289)](_0x27041f=>_0x27041f['gateway']+'\x20('+_0x27041f[_0x3feb46(0x2bc)][_0x3feb46(0x229)]+'\x20payments)'));if(_0x47d739){const _0x51e2b8=_0x4bd9f0['some'](_0x22c18f=>_0x22c18f[_0x3feb46(0x229)]['toLowerCase']()===_0x47d739[_0x3feb46(0x2b6)]());!_0x51e2b8&&_0x47d739['toLowerCase']()!==_0x3feb46(0x1fd)&&console[_0x3feb46(0x2a2)](_0x3feb46(0x2bf)+_0x47d739+'\x27\x20not\x20found.\x20Available\x20gateways:\x20'+_0x4bd9f0['map'](_0x4a7762=>_0x4a7762[_0x3feb46(0x229)])[_0x3feb46(0x2cd)](',\x20'));}const _0x52ec64={};_0x24ac39&&(_0x52ec64[_0x3feb46(0x2a9)]=_0x24ac39[_0x3feb46(0x1f1)]());if(!_0x47d739)_0x52ec64[_0x3feb46(0x229)]={'not':'test_gateway'};else{if(_0x47d739&&(_0x47d739[_0x3feb46(0x2b6)]()==='test_gateway'||_0x47d739===_0x3feb46(0x203)))_0x52ec64[_0x3feb46(0x229)]='test_gateway';else{let _0x38e226=_0x47d739;const _0xd7bbfd=(0x0,gateway_1[_0x3feb46(0x25a)])(_0x47d739);if(_0xd7bbfd)_0x38e226=_0xd7bbfd,console[_0x3feb46(0x2a2)](_0x3feb46(0x282)+_0x47d739+_0x3feb46(0x1df)+_0x38e226+'\x27');else{const _0x11a67f=(0x0,gateway_1['getGatewayIdByName'])(_0x47d739);if(_0x11a67f){const _0x59ca1b=(0x0,gateway_1[_0x3feb46(0x25a)])(_0x11a67f);_0x59ca1b&&(_0x38e226=_0x59ca1b,console['log'](_0x3feb46(0x1e8)+_0x47d739+'\x27\x20->\x20ID\x20\x27'+_0x11a67f+_0x3feb46(0x1e5)+_0x38e226+'\x27'));}else console['log']('🔍\x20Using\x20gateway\x20\x27'+_0x47d739+_0x3feb46(0x1ba));}const _0x2c5fc3=await database_1['default'][_0x3feb46(0x283)][_0x3feb46(0x261)]({'where':{'gateway':_0x38e226[_0x3feb46(0x2b6)]()},'take':0x1});_0x2c5fc3===0x0?(console[_0x3feb46(0x2a2)]('⚠️\x20Gateway\x20\x27'+_0x38e226+'\x27\x20(from\x20\x27'+_0x47d739+'\x27)\x20not\x20found\x20in\x20database,\x20returning\x20empty\x20result'),_0x52ec64[_0x3feb46(0x229)]=_0x3feb46(0x1f2)):(_0x52ec64[_0x3feb46(0x229)]=_0x38e226[_0x3feb46(0x2b6)](),console[_0x3feb46(0x2a2)](_0x3feb46(0x20a)+_0x38e226+_0x3feb46(0x211)+_0x47d739+'\x27)'));}}console[_0x3feb46(0x2a2)](_0x3feb46(0x2c6),_0x52ec64[_0x3feb46(0x229)]);_0x1317de&&(_0x52ec64[_0x3feb46(0x1ea)]=_0x1317de);_0x1de471&&(_0x52ec64[_0x3feb46(0x225)]=_0x1de471[_0x3feb46(0x1f1)](),console[_0x3feb46(0x2a2)](_0x3feb46(0x1ca)+_0x1de471[_0x3feb46(0x1f1)]()));(_0x290a18||_0x31a5f5)&&(_0x52ec64[_0x3feb46(0x25c)]={},_0x290a18&&(_0x52ec64[_0x3feb46(0x25c)][_0x3feb46(0x1f5)]=new Date(_0x290a18)),_0x31a5f5&&(_0x52ec64[_0x3feb46(0x25c)]['lte']=new Date(_0x31a5f5)));_0x3c5817&&(_0x52ec64['OR']=[{'id':{'contains':_0x3c5817,'mode':_0x3feb46(0x209)}},{'orderId':{'contains':_0x3c5817,'mode':'insensitive'}},{'gatewayOrderId':{'contains':_0x3c5817,'mode':_0x3feb46(0x209)}},{'customerEmail':{'contains':_0x3c5817,'mode':_0x3feb46(0x209)}},{'shop':{'name':{'contains':_0x3c5817,'mode':_0x3feb46(0x209)}}},{'shop':{'username':{'contains':_0x3c5817,'mode':_0x3feb46(0x209)}}}]);console[_0x3feb46(0x2a2)](_0x3feb46(0x25d),JSON[_0x3feb46(0x219)](_0x52ec64,null,0x2));let _0x1fed0c={'createdAt':_0x3feb46(0x25f)};if(_0xbb89fe){const _0x216369=[_0x3feb46(0x247),_0x3feb46(0x25c),'updatedAt',_0x3feb46(0x2a9),_0x3feb46(0x229),_0x3feb46(0x225)],_0x2950e4=[_0x3feb46(0x240),'desc'];if(_0x216369['includes'](_0xbb89fe)){const _0x56b2a6=_0x2950e4['includes'](_0x278385)?_0x278385:_0x3feb46(0x25f);_0x1fed0c={[_0xbb89fe]:_0x56b2a6},console[_0x3feb46(0x2a2)]('📊\x20Sorting\x20payments\x20by\x20'+_0xbb89fe+_0x3feb46(0x217)+_0x56b2a6+_0x3feb46(0x2aa));}}const [_0x1879e1,_0x15840a]=await Promise[_0x3feb46(0x28c)]([database_1['default']['payment'][_0x3feb46(0x1bb)]({'where':_0x52ec64,'skip':_0x32aed4,'take':_0x5c1cdb,'orderBy':_0x1fed0c,'include':{'shop':{'select':{'name':!![],'username':!![]}}}}),database_1[_0x3feb46(0x1ed)][_0x3feb46(0x283)][_0x3feb46(0x261)]({'where':_0x52ec64})]);return{'payments':_0x1879e1,'pagination':{'page':_0xae35a9,'limit':_0x5c1cdb,'total':_0x15840a,'totalPages':Math[_0x3feb46(0x1fe)](_0x15840a/_0x5c1cdb)}};}async['getPaymentById'](_0x5c0816){const _0x2f25d8=a38_0xb6c9ae,_0x835bfa=await database_1[_0x2f25d8(0x1ed)][_0x2f25d8(0x283)][_0x2f25d8(0x2ab)]({'where':{'id':_0x5c0816},'select':{'id':!![],'shopId':!![],'amount':!![],'amountAfterGatewayCommissionUSDT':!![],'currency':!![],'sourceCurrency':!![],'status':!![],'gateway':!![],'orderId':!![],'gatewayOrderId':!![],'gatewayPaymentId':!![],'customerEmail':!![],'customerName':!![],'customerCountry':!![],'customerIp':!![],'customerUa':!![],'externalPaymentUrl':!![],'successUrl':!![],'failUrl':!![],'pendingUrl':!![],'whiteUrl':!![],'expiresAt':!![],'invoiceTotalSum':!![],'qrCode':!![],'qrUrl':!![],'country':!![],'language':!![],'amountIsEditable':!![],'maxPayments':!![],'rapydCustomer':!![],'cardLast4':!![],'paymentMethod':!![],'bankId':!![],'remitterIban':!![],'remitterName':!![],'failureMessage':!![],'usage':!![],'createdAt':!![],'updatedAt':!![],'shop':{'select':{'name':!![],'username':!![]}}}});if(!_0x835bfa)return null;return{'id':_0x835bfa['id'],'shopId':_0x835bfa[_0x2f25d8(0x1ea)],'gateway':_0x835bfa[_0x2f25d8(0x229)],'amount':_0x835bfa[_0x2f25d8(0x247)],'currency':_0x835bfa['currency'],'status':_0x835bfa['status'],'orderId':_0x835bfa[_0x2f25d8(0x29e)],'gatewayOrderId':_0x835bfa[_0x2f25d8(0x280)],'customerEmail':_0x835bfa[_0x2f25d8(0x1d0)],'customerName':_0x835bfa[_0x2f25d8(0x2d3)],'customerCountry':_0x835bfa['customerCountry'],'customerIp':_0x835bfa[_0x2f25d8(0x2cc)],'customerUa':_0x835bfa[_0x2f25d8(0x242)],'failureMessage':_0x835bfa[_0x2f25d8(0x1cb)],'externalPaymentUrl':_0x835bfa[_0x2f25d8(0x281)],'successUrl':_0x835bfa[_0x2f25d8(0x1be)],'failUrl':_0x835bfa[_0x2f25d8(0x1b2)],'pendingUrl':_0x835bfa['pendingUrl'],'whiteUrl':_0x835bfa[_0x2f25d8(0x256)],'createdAt':_0x835bfa[_0x2f25d8(0x25c)],'updatedAt':_0x835bfa[_0x2f25d8(0x212)],'shop':_0x835bfa['shop']};}async[a38_0xb6c9ae(0x27e)](_0x268d2d,_0x22b075,_0x365baa,_0x470904){const _0x52fa35=a38_0xb6c9ae,_0xa2467d=await database_1[_0x52fa35(0x1ed)][_0x52fa35(0x2b5)](async _0xbddd66=>{const _0x323f14=_0x52fa35,_0x3cd795=await _0xbddd66[_0x323f14(0x283)]['findUnique']({'where':{'id':_0x268d2d},'include':{'shop':{'select':{'id':!![],'name':!![],'username':!![],'balance':!![]}}}});if(!_0x3cd795)throw new Error(_0x323f14(0x1d4));const _0x3b1ffb=_0x3cd795[_0x323f14(0x2a9)],_0x55260c=_0x22b075['toUpperCase']();console['log'](_0x323f14(0x200)+_0x268d2d+_0x323f14(0x1ac)+_0x3b1ffb+_0x323f14(0x2c7)+_0x55260c),console[_0x323f14(0x2a2)]('💰\x20Current\x20shop\x20balance:\x20'+_0x3cd795[_0x323f14(0x21b)][_0x323f14(0x21d)]+_0x323f14(0x27c));const _0x568ea={'status':_0x55260c,'updatedAt':new Date(),'statusChangedBy':_0x323f14(0x250),'statusChangedAt':new Date()};_0x365baa&&(_0x568ea[_0x323f14(0x1a9)]=_0x365baa);_0x55260c===_0x323f14(0x1c0)&&_0x470904&&(_0x568ea[_0x323f14(0x216)]=_0x470904);let _0x211c6f=0x0,_0x371d7f=_0x3cd795[_0x323f14(0x21b)]['balance'];if(_0x55260c===_0x323f14(0x253)&&_0x3b1ffb!==_0x323f14(0x253)){_0x568ea[_0x323f14(0x26e)]=new Date();const _0x1f7de2=await currencyService_1[_0x323f14(0x1a7)]['convertToUSDT'](_0x3cd795['amount'],_0x3cd795[_0x323f14(0x225)]);_0x568ea[_0x323f14(0x1f8)]=_0x1f7de2;let _0x2f8192=0x2d;const _0x384d0f=await _0xbddd66['shop']['findUnique']({'where':{'id':_0x3cd795[_0x323f14(0x1ea)]},'select':{'gatewaySettings':!![]}});if(_0x384d0f?.[_0x323f14(0x2ca)])try{const _0x377cce=JSON['parse'](_0x384d0f['gatewaySettings']);for(const [_0xb8e5b7,_0x2bc5b3]of Object[_0x323f14(0x1a0)](_0x377cce)){if(_0xb8e5b7['toLowerCase']()===_0x3cd795['gateway']['toLowerCase']()){_0x2f8192=_0x2bc5b3[_0x323f14(0x24d)]||0xa;break;}}}catch(_0x269a58){console[_0x323f14(0x199)]('Error\x20parsing\x20gateway\x20settings\x20for\x20payment\x20'+_0x268d2d+':',_0x269a58);}let _0x362ace;_0x3cd795[_0x323f14(0x1dc)]!==null&&_0x3cd795[_0x323f14(0x1dc)]!==undefined?(_0x362ace=_0x3cd795[_0x323f14(0x1dc)],console[_0x323f14(0x2a2)](_0x323f14(0x28a)+_0x362ace[_0x323f14(0x2d6)](0x6)+_0x323f14(0x2a6)+_0x268d2d)):(_0x362ace=_0x1f7de2*(0x1-_0x2f8192/0x64),console['log']('📊\x20[ADMIN]\x20Calculating\x20commission\x20manually\x20for\x20payment\x20'+_0x268d2d+':\x20'+_0x2f8192+_0x323f14(0x1da)+_0x1f7de2[_0x323f14(0x2d6)](0x6)+_0x323f14(0x27c)),_0x568ea[_0x323f14(0x1dc)]=_0x362ace,_0x568ea[_0x323f14(0x266)]=_0x2f8192),_0x211c6f=_0x362ace,_0x371d7f+=_0x362ace,console[_0x323f14(0x2a2)](_0x323f14(0x210)+_0x268d2d+_0x323f14(0x276)),console[_0x323f14(0x2a2)](_0x323f14(0x27a)+_0x1f7de2[_0x323f14(0x2d6)](0x6)+_0x323f14(0x27c)),console[_0x323f14(0x2a2)](_0x323f14(0x19d)+_0x3cd795[_0x323f14(0x229)]+_0x323f14(0x19c)+_0x2f8192+'%'),console[_0x323f14(0x2a2)](_0x323f14(0x26d)+_0x362ace['toFixed'](0x6)+_0x323f14(0x265)+_0x2f8192+'%\x20commission)'),console[_0x323f14(0x2a2)](_0x323f14(0x2a7)+_0x362ace[_0x323f14(0x2d6)](0x6)+_0x323f14(0x27c));}else{if(_0x3b1ffb===_0x323f14(0x253)&&_0x55260c!==_0x323f14(0x253)&&_0x55260c!==_0x323f14(0x1c0)){if(_0x3cd795[_0x323f14(0x1f8)]){let _0xbfc80b=0x2d;const _0x159913=await _0xbddd66['shop'][_0x323f14(0x2ab)]({'where':{'id':_0x3cd795[_0x323f14(0x1ea)]},'select':{'gatewaySettings':!![]}});if(_0x159913?.[_0x323f14(0x2ca)])try{const _0xdf3b44=JSON[_0x323f14(0x25e)](_0x159913[_0x323f14(0x2ca)]);for(const [_0x5a3ebe,_0x5d18e6]of Object['entries'](_0xdf3b44)){if(_0x5a3ebe[_0x323f14(0x2b6)]()===_0x3cd795[_0x323f14(0x229)][_0x323f14(0x2b6)]()){_0xbfc80b=_0x5d18e6['commission']||0xa;break;}}}catch(_0x523389){console[_0x323f14(0x199)](_0x323f14(0x294)+_0x268d2d+':',_0x523389);}const _0x4a6994=_0x3cd795[_0x323f14(0x1f8)]*(0x1-_0xbfc80b/0x64);_0x211c6f=-_0x4a6994,_0x371d7f-=_0x4a6994,console[_0x323f14(0x2a2)](_0x323f14(0x27a)+_0x3cd795[_0x323f14(0x1f8)][_0x323f14(0x2d6)](0x6)+_0x323f14(0x27c)),console[_0x323f14(0x2a2)](_0x323f14(0x19d)+_0x3cd795[_0x323f14(0x229)]+',\x20Commission:\x20'+_0xbfc80b+'%'),console['log'](_0x323f14(0x226)+_0x4a6994[_0x323f14(0x2d6)](0x6)+'\x20USDT\x20(after\x20'+_0xbfc80b+'%\x20commission)'),console['log'](_0x323f14(0x2c0)+_0x4a6994['toFixed'](0x6)+_0x323f14(0x27c));}}}_0x55260c===_0x323f14(0x1c0)&&(console[_0x323f14(0x2a2)](_0x323f14(0x295)),_0x470904&&_0x470904>0x0?(_0x211c6f=-_0x470904,_0x371d7f-=_0x470904,console[_0x323f14(0x2a2)]('💸\x20CHARGEBACK\x20penalty\x20ONLY:\x20-'+_0x470904[_0x323f14(0x2d6)](0x6)+_0x323f14(0x28e)),console['log']('💰\x20Payment\x20amount\x20is\x20NOT\x20deducted\x20(chargeback\x20penalty\x20only)')):console[_0x323f14(0x2a2)](_0x323f14(0x2af)),_0x568ea[_0x323f14(0x216)]=_0x470904||0x0);_0x55260c===_0x323f14(0x2d2)&&_0x3b1ffb===_0x323f14(0x253)&&console[_0x323f14(0x2a2)](_0x323f14(0x1aa));const _0xe5b82a=await _0xbddd66[_0x323f14(0x283)][_0x323f14(0x22c)]({'where':{'id':_0x268d2d},'data':_0x568ea,'include':{'shop':{'select':{'name':!![],'username':!![]}}}});return _0x211c6f!==0x0&&(await _0xbddd66['shop'][_0x323f14(0x22c)]({'where':{'id':_0x3cd795[_0x323f14(0x1ea)]},'data':{'balance':_0x371d7f}}),console[_0x323f14(0x2a2)](_0x323f14(0x214)+_0x3cd795[_0x323f14(0x1ea)]+'\x20balance\x20updated:\x20'+_0x3cd795[_0x323f14(0x21b)]['balance'][_0x323f14(0x2d6)](0x6)+_0x323f14(0x2c7)+_0x371d7f['toFixed'](0x6)+'\x20USDT\x20('+(_0x211c6f>0x0?'+':'')+_0x211c6f[_0x323f14(0x2d6)](0x6)+')')),_0xe5b82a;});return{'id':_0xa2467d['id'],'shopId':_0xa2467d['shopId'],'gateway':_0xa2467d['gateway'],'amount':_0xa2467d['amount'],'currency':_0xa2467d[_0x52fa35(0x225)],'status':_0xa2467d[_0x52fa35(0x2a9)],'orderId':_0xa2467d['orderId'],'gatewayOrderId':_0xa2467d[_0x52fa35(0x280)],'customerEmail':_0xa2467d['customerEmail'],'customerName':_0xa2467d[_0x52fa35(0x2d3)],'customerCountry':_0xa2467d['customerCountry'],'customerIp':_0xa2467d['customerIp'],'customerUa':_0xa2467d[_0x52fa35(0x242)],'failureMessage':_0xa2467d[_0x52fa35(0x1cb)],'adminNotes':_0xa2467d[_0x52fa35(0x1a9)],'chargebackAmount':_0xa2467d[_0x52fa35(0x216)],'statusChangedBy':_0xa2467d[_0x52fa35(0x1f7)],'statusChangedAt':_0xa2467d[_0x52fa35(0x19f)],'createdAt':_0xa2467d[_0x52fa35(0x25c)],'updatedAt':_0xa2467d[_0x52fa35(0x212)],'shop':_0xa2467d[_0x52fa35(0x21b)]};}async[a38_0xb6c9ae(0x29b)](_0x61f9,_0x38fa67){const _0xfd258d=a38_0xb6c9ae,_0x27d3ca=Math['random']()['toString'](0x24)['substr'](0x2,0x9);console[_0xfd258d(0x2a2)](_0xfd258d(0x2cf)+_0x27d3ca+',\x20userId:\x20'+_0x61f9);const _0x379c04={..._0x38fa67};_0x38fa67[_0xfd258d(0x223)]&&_0x38fa67[_0xfd258d(0x223)][_0xfd258d(0x1e6)]()!==''?(console[_0xfd258d(0x2a2)](_0xfd258d(0x2d0)+_0x27d3ca+_0xfd258d(0x19e)+_0x61f9),_0x379c04[_0xfd258d(0x223)]=await bcryptjs_1['default']['hash'](_0x38fa67['password'],0xc)):(console[_0xfd258d(0x2a2)](_0xfd258d(0x2d0)+_0x27d3ca+_0xfd258d(0x23d)),delete _0x379c04['password']);_0x38fa67[_0xfd258d(0x23b)]&&(_0x379c04['name']=_0x38fa67['fullName'],delete _0x379c04[_0xfd258d(0x23b)]);_0x38fa67[_0xfd258d(0x1d5)]&&(_0x379c04[_0xfd258d(0x20d)]=_0x38fa67[_0xfd258d(0x1d5)],delete _0x379c04[_0xfd258d(0x1d5)]);_0x38fa67['merchantUrl']&&(_0x379c04['shopUrl']=_0x38fa67[_0xfd258d(0x231)],delete _0x379c04[_0xfd258d(0x231)]);if(_0x38fa67[_0xfd258d(0x202)]){const _0x5daf96=_0x38fa67[_0xfd258d(0x202)][_0xfd258d(0x289)](_0x119771=>this[_0xfd258d(0x29d)](_0x119771));console[_0xfd258d(0x2a2)]('🔄\x20Gateway\x20mapping:',_0x38fa67[_0xfd258d(0x202)],'->',_0x5daf96),_0x379c04['paymentGateways']=JSON[_0xfd258d(0x219)](_0x5daf96),delete _0x379c04[_0xfd258d(0x202)];}_0x38fa67[_0xfd258d(0x2ca)]&&(console[_0xfd258d(0x2a2)](_0xfd258d(0x23f)+_0x27d3ca+_0xfd258d(0x260),_0x38fa67[_0xfd258d(0x2ca)]),_0x379c04[_0xfd258d(0x2ca)]=JSON[_0xfd258d(0x219)](_0x38fa67[_0xfd258d(0x2ca)]),console['log'](_0xfd258d(0x23f)+_0x27d3ca+']\x20Gateway\x20settings\x20JSON\x20string:',_0x379c04[_0xfd258d(0x2ca)]));_0x38fa67['wallets']&&(_0x38fa67[_0xfd258d(0x268)][_0xfd258d(0x19b)]!==undefined&&(_0x379c04[_0xfd258d(0x19b)]=_0x38fa67[_0xfd258d(0x268)][_0xfd258d(0x19b)]||null),_0x38fa67['wallets'][_0xfd258d(0x1e7)]!==undefined&&(_0x379c04[_0xfd258d(0x1e7)]=_0x38fa67[_0xfd258d(0x268)][_0xfd258d(0x1e7)]||null),_0x38fa67[_0xfd258d(0x268)][_0xfd258d(0x24b)]!==undefined&&(_0x379c04['usdtErcWallet']=_0x38fa67['wallets'][_0xfd258d(0x24b)]||null),_0x38fa67[_0xfd258d(0x268)][_0xfd258d(0x298)]!==undefined&&(_0x379c04[_0xfd258d(0x298)]=_0x38fa67[_0xfd258d(0x268)][_0xfd258d(0x298)]||null),delete _0x379c04[_0xfd258d(0x268)]);const _0x183410=await database_1[_0xfd258d(0x1ed)][_0xfd258d(0x21b)][_0xfd258d(0x22c)]({'where':{'id':_0x61f9},'data':_0x379c04,'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});return console[_0xfd258d(0x2a2)](_0xfd258d(0x1ff)+_0x27d3ca+_0xfd258d(0x1af),_0x183410[_0xfd258d(0x2ca)]),{'id':_0x183410['id'],'fullName':_0x183410[_0xfd258d(0x23a)],'username':_0x183410[_0xfd258d(0x1dd)],'telegramId':_0x183410[_0xfd258d(0x20d)],'merchantUrl':_0x183410[_0xfd258d(0x29c)],'gateways':_0x183410[_0xfd258d(0x1a8)]?JSON[_0xfd258d(0x25e)](_0x183410['paymentGateways']):null,'gatewaySettings':_0x183410['gatewaySettings']?JSON[_0xfd258d(0x25e)](_0x183410[_0xfd258d(0x2ca)]):null,'publicKey':_0x183410[_0xfd258d(0x205)],'wallets':{'usdtPolygonWallet':_0x183410[_0xfd258d(0x19b)],'usdtTrcWallet':_0x183410[_0xfd258d(0x1e7)],'usdtErcWallet':_0x183410[_0xfd258d(0x24b)],'usdcPolygonWallet':_0x183410[_0xfd258d(0x298)]},'status':_0x183410['status'],'createdAt':_0x183410['createdAt']};}async['suspendUser'](_0x4a7001){const _0x51a6ec=a38_0xb6c9ae,_0x561c2a=await database_1['default']['shop']['update']({'where':{'id':_0x4a7001},'data':{'status':_0x51a6ec(0x267)},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});return{'id':_0x561c2a['id'],'fullName':_0x561c2a[_0x51a6ec(0x23a)],'username':_0x561c2a[_0x51a6ec(0x1dd)],'telegramId':_0x561c2a[_0x51a6ec(0x20d)],'merchantUrl':_0x561c2a[_0x51a6ec(0x29c)],'gateways':_0x561c2a[_0x51a6ec(0x1a8)]?JSON[_0x51a6ec(0x25e)](_0x561c2a[_0x51a6ec(0x1a8)]):null,'gatewaySettings':_0x561c2a[_0x51a6ec(0x2ca)]?JSON[_0x51a6ec(0x25e)](_0x561c2a[_0x51a6ec(0x2ca)]):null,'publicKey':_0x561c2a[_0x51a6ec(0x205)],'wallets':{'usdtPolygonWallet':_0x561c2a[_0x51a6ec(0x19b)],'usdtTrcWallet':_0x561c2a[_0x51a6ec(0x1e7)],'usdtErcWallet':_0x561c2a[_0x51a6ec(0x24b)],'usdcPolygonWallet':_0x561c2a['usdcPolygonWallet']},'status':_0x561c2a[_0x51a6ec(0x2a9)],'createdAt':_0x561c2a[_0x51a6ec(0x25c)]};}async[a38_0xb6c9ae(0x279)](_0x194fe3){const _0x174030=a38_0xb6c9ae,_0x212449=await database_1[_0x174030(0x1ed)][_0x174030(0x21b)][_0x174030(0x22c)]({'where':{'id':_0x194fe3},'data':{'status':_0x174030(0x26b)},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});return{'id':_0x212449['id'],'fullName':_0x212449[_0x174030(0x23a)],'username':_0x212449[_0x174030(0x1dd)],'telegramId':_0x212449[_0x174030(0x20d)],'merchantUrl':_0x212449[_0x174030(0x29c)],'gateways':_0x212449[_0x174030(0x1a8)]?JSON[_0x174030(0x25e)](_0x212449[_0x174030(0x1a8)]):null,'gatewaySettings':_0x212449[_0x174030(0x2ca)]?JSON['parse'](_0x212449['gatewaySettings']):null,'publicKey':_0x212449[_0x174030(0x205)],'wallets':{'usdtPolygonWallet':_0x212449[_0x174030(0x19b)],'usdtTrcWallet':_0x212449[_0x174030(0x1e7)],'usdtErcWallet':_0x212449['usdtErcWallet'],'usdcPolygonWallet':_0x212449[_0x174030(0x298)]},'status':_0x212449[_0x174030(0x2a9)],'createdAt':_0x212449[_0x174030(0x25c)]};}async['getAllUsers'](_0x125e45){const _0x45f472=a38_0xb6c9ae,{page:_0x12e348,limit:_0x13b28e,status:_0x354b42}=_0x125e45,_0x404ae7=(_0x12e348-0x1)*_0x13b28e,_0x656180={};_0x354b42&&(_0x656180[_0x45f472(0x2a9)]=_0x354b42['toUpperCase']());const [_0x3d58e5,_0x56199c]=await Promise[_0x45f472(0x28c)]([database_1[_0x45f472(0x1ed)][_0x45f472(0x21b)][_0x45f472(0x1bb)]({'where':_0x656180,'skip':_0x404ae7,'take':_0x13b28e,'orderBy':{'createdAt':_0x45f472(0x25f)},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}}),database_1[_0x45f472(0x1ed)][_0x45f472(0x21b)][_0x45f472(0x261)]({'where':_0x656180})]);return{'users':_0x3d58e5[_0x45f472(0x289)](_0xa4c97a=>{const _0xa7eaa1=_0x45f472,_0x1bf39b=_0xa4c97a[_0xa7eaa1(0x1a8)]?JSON['parse'](_0xa4c97a[_0xa7eaa1(0x1a8)]):null,_0x4b6ed=_0x1bf39b?_0x1bf39b[_0xa7eaa1(0x289)](_0x4f1621=>this[_0xa7eaa1(0x2c9)](_0x4f1621)):null;return{'id':_0xa4c97a['id'],'fullName':_0xa4c97a[_0xa7eaa1(0x23a)],'username':_0xa4c97a[_0xa7eaa1(0x1dd)],'telegramId':_0xa4c97a['telegram'],'merchantUrl':_0xa4c97a[_0xa7eaa1(0x29c)],'gateways':_0x4b6ed,'gatewaySettings':_0xa4c97a[_0xa7eaa1(0x2ca)]?JSON[_0xa7eaa1(0x25e)](_0xa4c97a[_0xa7eaa1(0x2ca)]):null,'publicKey':_0xa4c97a['publicKey'],'wallets':{'usdtPolygonWallet':_0xa4c97a['usdtPolygonWallet'],'usdtTrcWallet':_0xa4c97a['usdtTrcWallet'],'usdtErcWallet':_0xa4c97a[_0xa7eaa1(0x24b)],'usdcPolygonWallet':_0xa4c97a['usdcPolygonWallet']},'status':_0xa4c97a[_0xa7eaa1(0x2a9)],'createdAt':_0xa4c97a['createdAt']};}),'pagination':{'page':_0x12e348,'limit':_0x13b28e,'total':_0x56199c,'totalPages':Math[_0x45f472(0x1fe)](_0x56199c/_0x13b28e)}};}async[a38_0xb6c9ae(0x1f6)](_0x255526){const _0xa62434=a38_0xb6c9ae,_0x45ef9a=await database_1[_0xa62434(0x1ed)][_0xa62434(0x21b)][_0xa62434(0x2ab)]({'where':{'id':_0x255526},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});if(!_0x45ef9a)return null;const _0x4643a8=_0x45ef9a[_0xa62434(0x1a8)]?JSON[_0xa62434(0x25e)](_0x45ef9a[_0xa62434(0x1a8)]):null,_0x305258=_0x4643a8?_0x4643a8['map'](_0x382c6e=>this[_0xa62434(0x2c9)](_0x382c6e)):null;return _0x4643a8&&_0x305258&&console[_0xa62434(0x2a2)](_0xa62434(0x292),_0x4643a8,'->',_0x305258),{'id':_0x45ef9a['id'],'fullName':_0x45ef9a[_0xa62434(0x23a)],'username':_0x45ef9a['username'],'telegramId':_0x45ef9a['telegram'],'merchantUrl':_0x45ef9a['shopUrl'],'gateways':_0x305258,'gatewaySettings':_0x45ef9a['gatewaySettings']?JSON[_0xa62434(0x25e)](_0x45ef9a[_0xa62434(0x2ca)]):null,'publicKey':_0x45ef9a[_0xa62434(0x205)],'wallets':{'usdtPolygonWallet':_0x45ef9a[_0xa62434(0x19b)],'usdtTrcWallet':_0x45ef9a[_0xa62434(0x1e7)],'usdtErcWallet':_0x45ef9a[_0xa62434(0x24b)],'usdcPolygonWallet':_0x45ef9a[_0xa62434(0x298)]},'status':_0x45ef9a[_0xa62434(0x2a9)],'createdAt':_0x45ef9a['createdAt']};}async[a38_0xb6c9ae(0x1c6)](_0x1a3520){const _0x3b4afa=a38_0xb6c9ae,{fullName:_0x1a6bfa,username:_0x576783,password:_0x4c67e6,telegramId:_0xae0888,merchantUrl:_0x47595c,gateways:_0x1ccfda,gatewaySettings:_0x50b3b5,wallets:_0x1139b7}=_0x1a3520,_0x592aa6=await database_1['default']['shop']['findUnique']({'where':{'username':_0x576783}});if(_0x592aa6)throw new Error(_0x3b4afa(0x269));if(_0xae0888){const _0x154cee=await database_1['default']['shop'][_0x3b4afa(0x2ab)]({'where':{'telegram':_0xae0888}});if(_0x154cee)throw new Error(_0x3b4afa(0x1b0));}const _0xd09ca0=await bcryptjs_1['default'][_0x3b4afa(0x1bd)](_0x4c67e6,0xc),_0x403dfe='pk_'+crypto_1[_0x3b4afa(0x1ed)][_0x3b4afa(0x1b5)](0x20)[_0x3b4afa(0x1b1)](_0x3b4afa(0x2b8)),_0x381c09=_0x3b4afa(0x258)+crypto_1[_0x3b4afa(0x1ed)][_0x3b4afa(0x1b5)](0x20)[_0x3b4afa(0x1b1)](_0x3b4afa(0x2b8)),_0x52288e=_0x1ccfda?_0x1ccfda[_0x3b4afa(0x289)](_0xe84b73=>this[_0x3b4afa(0x29d)](_0xe84b73)):null;_0x1ccfda&&_0x52288e&&console[_0x3b4afa(0x2a2)](_0x3b4afa(0x2a5),_0x1ccfda,'->',_0x52288e);const _0x2f81a8=await database_1[_0x3b4afa(0x1ed)][_0x3b4afa(0x21b)]['create']({'data':{'name':_0x1a6bfa,'username':_0x576783,'password':_0xd09ca0,'telegram':_0xae0888,'shopUrl':_0x47595c,'paymentGateways':_0x52288e?JSON['stringify'](_0x52288e):null,'gatewaySettings':_0x50b3b5?JSON[_0x3b4afa(0x219)](_0x50b3b5):null,'usdtPolygonWallet':_0x1139b7?.[_0x3b4afa(0x19b)]||null,'usdtTrcWallet':_0x1139b7?.[_0x3b4afa(0x1e7)]||null,'usdtErcWallet':_0x1139b7?.[_0x3b4afa(0x24b)]||null,'usdcPolygonWallet':_0x1139b7?.[_0x3b4afa(0x298)]||null,'publicKey':_0x403dfe,'secretKey':_0x381c09,'status':'ACTIVE'},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});return{'id':_0x2f81a8['id'],'fullName':_0x2f81a8[_0x3b4afa(0x23a)],'username':_0x2f81a8[_0x3b4afa(0x1dd)],'telegramId':_0x2f81a8[_0x3b4afa(0x20d)],'merchantUrl':_0x2f81a8[_0x3b4afa(0x29c)],'gateways':_0x2f81a8[_0x3b4afa(0x1a8)]?JSON[_0x3b4afa(0x25e)](_0x2f81a8[_0x3b4afa(0x1a8)]):null,'gatewaySettings':_0x2f81a8[_0x3b4afa(0x2ca)]?JSON[_0x3b4afa(0x25e)](_0x2f81a8[_0x3b4afa(0x2ca)]):null,'publicKey':_0x2f81a8[_0x3b4afa(0x205)],'wallets':{'usdtPolygonWallet':_0x2f81a8[_0x3b4afa(0x19b)],'usdtTrcWallet':_0x2f81a8[_0x3b4afa(0x1e7)],'usdtErcWallet':_0x2f81a8[_0x3b4afa(0x24b)],'usdcPolygonWallet':_0x2f81a8['usdcPolygonWallet']},'status':_0x2f81a8[_0x3b4afa(0x2a9)],'createdAt':_0x2f81a8[_0x3b4afa(0x25c)]};}async['deleteUser'](_0xead3f3){const _0xebfcb3=a38_0xb6c9ae;await database_1['default'][_0xebfcb3(0x21b)]['delete']({'where':{'id':_0xead3f3}});}[a38_0xb6c9ae(0x1e0)](_0x4efd8e,_0x37fff8,_0x2a627f){const _0x21e3f8=a38_0xb6c9ae,_0x4ece20=new Map(),_0x1c6e68=new Date(_0x37fff8);while(_0x1c6e68<=_0x2a627f){const _0x490ddf=_0x1c6e68[_0x21e3f8(0x238)]()[_0x21e3f8(0x27d)]('T')[0x0];_0x4ece20[_0x21e3f8(0x28f)](_0x490ddf,{'revenue':0x0,'count':0x0}),_0x1c6e68[_0x21e3f8(0x2ae)](_0x1c6e68[_0x21e3f8(0x1fa)]()+0x1);}for(const _0x190c90 of _0x4efd8e){const _0x2edb30=_0x190c90[_0x21e3f8(0x25c)][_0x21e3f8(0x238)]()[_0x21e3f8(0x27d)]('T')[0x0],_0x4f2989=_0x4ece20['get'](_0x2edb30);_0x4f2989&&(_0x4f2989[_0x21e3f8(0x261)]+=0x1,_0x190c90[_0x21e3f8(0x2a9)]===_0x21e3f8(0x253)&&(_0x190c90['amountUSDT']?_0x4f2989[_0x21e3f8(0x21c)]+=_0x190c90[_0x21e3f8(0x1f8)]:console[_0x21e3f8(0x2a2)]('⚠️\x20Payment\x20'+_0x190c90['id']+_0x21e3f8(0x2be))));}const _0x14c229=[],_0x581c1f=[];for(const [_0x53a4d2,_0x17deb7]of _0x4ece20){_0x14c229[_0x21e3f8(0x220)]({'date':_0x53a4d2,'amount':Math[_0x21e3f8(0x277)](_0x17deb7[_0x21e3f8(0x21c)]*0x64)/0x64}),_0x581c1f[_0x21e3f8(0x220)]({'date':_0x53a4d2,'count':_0x17deb7[_0x21e3f8(0x261)]});}return{'dailyRevenue':_0x14c229,'dailyPayments':_0x581c1f};}}function a38_0x5edc(_0x1e30d1,_0x529f85){const _0x477721=a38_0x4777();return a38_0x5edc=function(_0x5edc40,_0x34da7e){_0x5edc40=_0x5edc40-0x198;let _0xeb876e=_0x477721[_0x5edc40];return _0xeb876e;},a38_0x5edc(_0x1e30d1,_0x529f85);}function a38_0x4777(){const _0x1850ab=['map','📊\x20[ADMIN]\x20Using\x20saved\x20amountAfterGatewayCommissionUSDT:\x20','../config/database','all','year','\x20USDT\x20from\x20balance','set','dailyPayments','\x20\x20\x20Payout\x20amount:\x20','🔄\x20Gateway\x20mapping\x20(get):','length','Error\x20parsing\x20gateway\x20settings\x20for\x20payment\x20','💸\x20CHARGEBACK:\x20Processing\x20penalty-only\x20deduction','dailyRevenue','\x20\x20\x20�\x20Total\x20paid\x20out:\x20','usdcPolygonWallet','\x20\x20\x20🌐\x20IP:\x20','deletePayout','updateUser','shopUrl','getGatewayInternalName','orderId','dateTo','Error\x20parsing\x20gateway\x20settings\x20for\x20shop\x20','merchantEarnings','log','averageCommissionRate','dateFrom','🔄\x20Gateway\x20mapping\x20(create):','\x20USDT\x20for\x20payment\x20','\x20\x20\x20Added\x20to\x20balance:\x20+','totalPaidOut','status','\x20order','findUnique','\x20\x20\x20Current\x20balance:\x20','💰\x20Found\x20','setDate','⚠️\x20CHARGEBACK\x20without\x20penalty\x20amount\x20-\x20no\x20balance\x20change','9purgRs','trc20','reduce','txid','\x20\x20\x20💸\x20Total\x20payouts:\x20','$transaction','toLowerCase','\x20\x20\x20✅\x20Total\x20available\x20for\x20payout:\x20','hex',',\x20successful:\x20','week','erc20_usdc','_count','KLYME\x20DE','\x20missing\x20amountUSDT,\x20using\x20fallback\x20conversion','⚠️\x20Requested\x20gateway\x20\x27','\x20\x20\x20Subtracted\x20from\x20balance:\x20-','payout','\x20\x20\x20💸\x20Total\x20payouts\x20(all\x20time):\x20','_sum','turnoverUSDT','getPayoutById','📊\x20Gateway\x20filter\x20applied:','\x20->\x20','custom','getGatewayDisplayName','gatewaySettings','448854XxVZGA','customerIp','join','\x20\x20\x20📅\x20This\x20month:\x20','🎯\x20updateUser\x20called\x20with\x20ID:\x20','🔐\x20[','getPayoutStats','REFUND','customerName','totalTurnover','\x20USDT\x20(already\x20paid\x20out)','toFixed','Shop\x20not\x20found','not\x20set','error','sort','usdtPolygonWallet',',\x20Commission:\x20','\x20\x20\x20Gateway:\x20',']\x20Updating\x20password\x20for\x20user\x20','statusChangedAt','entries','\x20USDT\x20(actual\x20balances)','getMonth','customerCountry','klyme_eu','forEach','Noda','currencyService','paymentGateways','adminNotes','🔄\x20REFUND:\x20Payment\x20amount\x20already\x20deducted\x20from\x20balance','333rCdNWW','\x20status:\x20','getMerchantStatistics','klyme_de',']\x20User\x20updated,\x20gatewaySettings\x20from\x20DB:','Telegram\x20username\x20already\x20exists','toString','failUrl','__esModule','\x20\x20\x20🖥️\x20User\x20Agent:\x20','randomBytes','⚠️\x20Payment\x20','📊\x20Available\x20gateways\x20in\x20database:','\x20\x20\x20💰\x20Total\x20payments\x20turnover:\x20','convertToUSDT','\x27\x20as\x20is\x20(not\x20found\x20in\x20mappings)','findMany','rapyd','hash','successUrl','\x20\x20\x20💰\x20Total\x20turnover:\x20','CHARGEBACK','totalAmountAfterCommissionUSDT','\x20\x20\x20🤔\x20Difference:\x20','cointopay','\x20USDT\x20(+','gatewayEarnings','createUser','5cquwWS','30d','Open\x20Banking\x202','💱\x20Currency\x20filter\x20applied:\x20','failureMessage','usdcErcWallet','paymentsCount','💰\x20[PAYOUT]\x20Merchant\x20','\x20USDT,\x20merchant:\x20','customerEmail','paidOutUSDT','2273212RxtVXQ','9830beGmnc','Payment\x20not\x20found','telegramId','./currencyService',':\x20commission\x20=\x20','💰\x20[PAYOUT]\x20Gateway\x20','\x20\x20\x20⏳\x20Awaiting\x20payout:\x20','%\x20from\x20','\x20for\x20shop\x20','amountAfterGatewayCommissionUSDT','username','Error\x20processing\x20payment\x20','\x27\x20to\x20name\x20\x27','generateDailyStatistics','yesterday','\x20\x20\x20�📊\x20Total\x20payments:\x20','\x20to\x20','✅\x20Customer\x20data\x20updated\x20for\x20payment\x20','\x27\x20->\x20name\x20\x27','trim','usdtTrcWallet','🔄\x20Converted\x20gateway\x20name\x20\x27','__importDefault','shopId','\x20USDT\x20(-','📊\x20Merchants\x20awaiting\x20payout:\x20','default','day','8820870OcVojR','totalCommissionRate','toUpperCase','NONEXISTENT_GATEWAY_FILTER','\x20\x20\x20🏪\x20Gateway\x20earnings:\x20','getSystemStatistics','gte','getUserById','statusChangedBy','amountUSDT','\x20\x20\x20📅\x20Total\x20payouts\x20(this\x20month):\x20','getDate','📊\x20Calculating\x20commission\x20manually\x20for\x20payment\x20','🔄\x20Updating\x20customer\x20data\x20for\x20payment\x20','test_gateway','ceil','🎯\x20[','🔄\x20Admin\x20updating\x20payment\x20','90d','gateways','0000','getFullYear','publicKey','availableBalance','not\x20specified','date','insensitive','✅\x20Using\x20gateway\x20filter:\x20\x27','month','\x20\x20\x20💵\x20Available\x20balance:\x20','telegram','groupBy','getAllPayouts','💰\x20Payment\x20','\x27\x20(from\x20\x27','updatedAt','2020-01-01','💰\x20Shop\x20','averageCheckUSDT','chargebackAmount','\x20in\x20','21078530FlwYBQ','stringify','Test\x20Gateway','shop','revenue','balance','📋\x20Getting\x20merchants\x20selection\x20list...','\x20\x20\x20👤\x20Merchant\x20earnings:\x20','push','getTime','bcryptjs','password','\x20\x20\x20Current\x20total\x20paid\x20out:\x20','currency','\x20\x20\x20Merchant\x20loses:\x20','updateCustomerData','plisio','gateway','KLYME\x20GB','periodTo','update','noda','\x20\x20\x20⏳\x20Pending\x20payout:\x20','\x20USDT\x20(gross\x20revenue)','\x20merchants','merchantUrl','defineProperty','periodFrom','Plisio','\x20\x20\x20🔍\x20Calculated\x20after\x20commission:\x20','turnover','\x20USDT\x20(theoretical\x20net)','toISOString','aggregate','name','fullName','657966pmEeAE',']\x20Password\x20not\x20provided\x20or\x20empty,\x20skipping\x20password\x20update','getMerchantsSelection','🔧\x20[','asc','values','customerUa','network','notes','period','MasterCard','amount','\x20active\x20merchants\x20for\x20selection','totalAmountUSDT','klyme_gb','usdtErcWallet','📊\x20Payout\x20statistics\x20calculated:','commission','📊\x20Using\x20saved\x20values\x20for\x20payment\x20','delete','admin','\x20USDT\x20(same\x20as\x20awaiting)','2897376hgYVzO','PAID','merchantEarningsUSDT','thisMonth','whiteUrl','📊\x20Using\x20saved\x20commission\x20rate\x20for\x20payment\x20','sk_','polygon','getGatewayNameById','COMPLETED','createdAt','📊\x20Final\x20WHERE\x20conditions:','parse','desc',']\x20Gateway\x20settings\x20before\x20saving:','count','💳\x20Payout\x20wallet\x20for\x20','\x20\x20\x20💰\x20Total\x20payout:\x20','totalPayout','\x20USDT\x20(after\x20','gatewayCommissionRate','SUSPENDED','wallets','Username\x20already\x20exists','setHours','ACTIVE','35cSqFEd','\x20\x20\x20Merchant\x20gets:\x20','paidAt','totalPayments','warn','polygon_usdc','📋\x20Found\x20','AdminService','getAllPayments','✅\x20Payout\x20created:\x20','\x20became\x20PAID:','round','📊\x20Total\x20payments\x20(including\x20failed):\x20','activateUser','\x20\x20\x20Full\x20amount:\x20','mastercard','\x20USDT','split','updatePaymentStatus','commissionUSDT','gatewayOrderId','externalPaymentUrl','🔄\x20Converted\x20gateway\x20ID\x20\x27','payment','\x20\x20\x20🌍\x20Country:\x20','getMerchantsAwaitingPayout','findFirst','\x20\x20\x20Total\x20paid\x20out:\x20','erc20'];a38_0x4777=function(){return _0x1850ab;};return a38_0x4777();}exports[a38_0xb6c9ae(0x273)]=AdminService;