'use strict';const a36_0x259f83=a36_0x3fba;function a36_0x47e3(){const _0x191d7a=['🔄\x20Updating\x20customer\x20data\x20for\x20payment\x20','\x20\x20\x20💰\x20Total\x20payout:\x20','💸\x20CHARGEBACK:\x20Merchant\x20amount\x20already\x20deducted\x20from\x20balance','usdtTrcWallet','\x20\x20\x20🌐\x20IP:\x20','parse','⚠️\x20Payment\x20','\x20USDT\x20(gross\x20revenue)','customerCountry','90d','🔐\x20[','CHARGEBACK','\x20to\x20','📊\x20[ADMIN]\x20Using\x20saved\x20amountAfterGatewayCommissionUSDT:\x20','🎯\x20[','shopId','getGatewayIdByName','sort','\x20\x20\x20✅\x20Actual\x20available\x20balance:\x20','updatedAt','commission','\x20->\x20','\x27\x20->\x20name\x20\x27','PAID','updateCustomerData','💳\x20Payout\x20wallet\x20for\x20','findUnique',',\x20Commission:\x20','setDate','1838718JZJVEo','\x20balance\x20updated:\x20','Shop\x20not\x20found','log','getMonth','crypto','gte','\x20missing\x20amountUSDT,\x20using\x20fallback\x20conversion','values','📊\x20Getting\x20merchants\x20awaiting\x20payout\x20with\x20filters:','update','periodTo','successUrl','aggregate','📊\x20[ADMIN]\x20Calculating\x20commission\x20manually\x20for\x20payment\x20','createdAt','📊\x20Calculating\x20payout\x20statistics...','currencyService','💰\x20[PAYOUT]\x20Merchant\x20','\x20\x20\x20🌍\x20Country:\x20','Error\x20parsing\x20gateway\x20settings\x20for\x20payment\x20','amountUSDT','🔄\x20Gateway\x20mapping:','updatePaymentStatus','orderId','272164BOYmdV','Rapyd','105888MIrWoC','pk_','\x20USDT\x20(after\x20payouts)','asc','getMerchantsAwaitingPayout','telegramId','\x20\x20\x20Transaction\x20hash:\x20','push','ceil','periodFrom','\x20\x20\x20💳\x20Total\x20payments:\x20','entries','Open\x20Banking\x202','admin','getTime','\x27\x20to\x20name\x20\x27','🔄\x20Gateway\x20mapping\x20(create):','hash','paymentGateways','generateDailyStatistics','revenue','klyme_eu','REFUND','name','💰\x20Found\x20','🔧\x20[','failUrl','\x20payments)','dailyRevenue','commissionUSDT','paymentsCount','\x20\x20\x20📊\x20Commission\x20difference:\x20',']\x20Updating\x20password\x20for\x20user\x20','toString','__importDefault','payment','split','COMPLETED','3nDBJgB','💰\x20Shop\x20','trc20','💸\x20CHARGEBACK\x20penalty:\x20-','activateUser','password','cointopay2','convertToUSDT','statusChangedAt','customerName','klyme_de','averageCommissionRate','\x20USDT\x20(total\x20paid\x20to\x20merchants)','not\x20set','Error\x20parsing\x20gateway\x20settings\x20for\x20shop\x20','currency','balance','round','671DbXWJq','📊\x20Calculating\x20commission\x20manually\x20for\x20payment\x20','mastercard','adminNotes','gatewaySettings','statusChangedBy','Plisio','\x27)\x20not\x20found\x20in\x20database,\x20returning\x20empty\x20result','username','fullName','\x27\x20(from\x20\x27','getGatewayDisplayName','totalPaidOut','publicKey','toLowerCase','🔍\x20Using\x20gateway\x20\x27','\x20USDT','bcryptjs','📅\x20Period:\x20','usdtErcWallet','\x20in\x20','insensitive','cointopay','\x20\x20\x20Added\x20to\x20balance:\x20+','reduce','CoinToPay','merchantEarnings','../types/gateway','amount','15YKTJGl','getGatewayNameById','\x20\x20\x20💰\x20Total\x20payments\x20turnover:\x20','notes','totalCommissionRate','📊\x20Available\x20gateways\x20in\x20database:','NONEXISTENT_GATEWAY_FILTER','toISOString','usdtPolygonWallet','📊\x20Getting\x20payments\x20with\x20filters:','💰\x20Current\x20shop\x20balance:\x20','%\x20from\x20','period','\x20USDT)','getUserById','ACTIVE','findFirst','pendingPayout',']\x20User\x20updated,\x20gatewaySettings\x20from\x20DB:','txid','💰\x20[PAYOUT]\x20Gateway\x20','amountAfterGatewayCommissionUSDT','\x20USDT\x20from\x20balance','payout','\x20USDT\x20(with\x20commission\x20deducted)','7vhegdG','includes','amountAfterCommissionUSDT','polygon','dailyPayments','$transaction','findMany','merchantUrl','__esModule','getFullYear','2020-01-01',']\x20Password\x20not\x20provided\x20or\x20empty,\x20skipping\x20password\x20update','\x20\x20\x20💰\x20Total\x20turnover:\x20','test_gateway','delete','SUSPENDED','status','\x20\x20\x20Merchant\x20gets:\x20','\x20USDT\x20(actual\x20balances)','\x20\x20\x20⏳\x20Pending\x20payout:\x20','default','month','gatewayEarnings','stringify','trim','suspendUser','totalPayout','desc','customerEmail','usdcPolygonWallet','_sum','createUser','_count','getGatewayInternalName','\x20\x20\x20Subtracted\x20from\x20balance:\x20-','random','\x20\x20\x20�\x20Total\x20payments\x20turnover:\x20','\x20became\x20PAID:','shopUrl','localeCompare','\x20\x20\x20Merchant\x20loses:\x20','\x20status:\x20','length','telegram','184170kcnRFT','getPayoutById','\x20for\x20shop\x20','\x20USDT\x20(theoretical\x20net)','\x20\x20\x20🔍\x20Calculated\x20after\x20commission:\x20',']\x20Gateway\x20settings\x20before\x20saving:','count','averageCheckUSDT','groupBy','\x20\x20\x20Gateway:\x20','customerIp','Test\x20Gateway','\x20\x20\x20💸\x20Total\x20payouts\x20(all\x20time):\x20','customerUa','\x20\x20\x20Current\x20balance:\x20','🔄\x20REFUND:\x20Payment\x20amount\x20already\x20deducted\x20from\x20balance','day','paidOutUSDT','📊\x20Sorting\x20payments\x20by\x20','createPayout','\x20\x20\x20Total\x20paid\x20out:\x20','\x20\x20\x20📅\x20This\x20month:\x20','map','KLYME\x20GB','18690JLEwGq','\x20\x20\x20✅\x20Total\x20available\x20for\x20payout:\x20','merchantEarningsUSDT','all','externalPaymentUrl',':\x20commission\x20=\x20','\x20\x20\x20🔍\x20Raw\x20balance\x20sum:\x20',',\x20successful:\x20','\x27\x20->\x20ID\x20\x27','wallets','\x20\x20\x20Full\x20amount:\x20','randomBytes','totalTurnover','getPayoutStats','hex','not\x20specified','sk_','\x20active\x20merchants\x20for\x20selection','\x20merchants','Payment\x20not\x20found','getMerchantsSelection','toFixed','\x20paid\x20payments\x20for\x20analysis','🔄\x20Gateway\x20mapping\x20(get):','awaitingPayout','gatewayOrderId','turnoverUSDT','94066VmNEAw','getAllUsers','🔄\x20Converted\x20gateway\x20name\x20\x27','\x20\x20\x20Balance:\x20','AdminService','chargebackAmount','week','\x20USDT\x20(','KLYME\x20EU','0000',',\x20userId:\x20','getDate','network','\x20USDT\x20(after\x20','\x20\x20\x20💵\x20Available\x20balance:\x20','\x20USDT,\x20Requested:\x20','setHours','availableBalance','date','create','gateway','getAllPayouts','totalAmountAfterCommissionUSDT','updateUser','toUpperCase','📊\x20Merchants\x20awaiting\x20payout:\x20','\x20PAID\x20payments','turnover','\x20\x20\x20�\x20Total\x20paid\x20out:\x20','./currencyService','getSystemStatistics','💱\x20Currency\x20filter\x20applied:\x20','\x20\x20\x20🖥️\x20User\x20Agent:\x20','forEach','custom','polygon_usdc','totalPayments','DAY','error','set','1492016CCDsdj','\x20USDT\x20(same\x20as\x20awaiting)','💰\x20Payment\x20','thisMonth','📊\x20Getting\x20merchant\x20statistics\x20with\x20filters:','paidAt','gateways','shop','💰\x20Creating\x20payout\x20for\x20shop\x20','some','dateFrom','%\x20commission)','🔄\x20Converted\x20gateway\x20ID\x20\x27','📊\x20Total\x20payments\x20(including\x20failed):\x20','dateTo','deleteUser'];a36_0x47e3=function(){return _0x191d7a;};return a36_0x47e3();}(function(_0x306131,_0x1d6cfb){const _0x37d4be=a36_0x3fba,_0xd05b7e=_0x306131();while(!![]){try{const _0x3b0792=parseInt(_0x37d4be(0x1bd))/0x1+parseInt(_0x37d4be(0x18a))/0x2*(-parseInt(_0x37d4be(0x253))/0x3)+parseInt(_0x37d4be(0x22b))/0x4+-parseInt(_0x37d4be(0x145))/0x5*(parseInt(_0x37d4be(0x22d))/0x6)+-parseInt(_0x37d4be(0x15e))/0x7*(-parseInt(_0x37d4be(0x1e5))/0x8)+-parseInt(_0x37d4be(0x212))/0x9+parseInt(_0x37d4be(0x1a2))/0xa*(parseInt(_0x37d4be(0x128))/0xb);if(_0x3b0792===_0x1d6cfb)break;else _0xd05b7e['push'](_0xd05b7e['shift']());}catch(_0x51d3b9){_0xd05b7e['push'](_0xd05b7e['shift']());}}}(a36_0x47e3,0x1ba87));var __importDefault=this&&this[a36_0x259f83(0x24f)]||function(_0x4a8308){const _0x2d45f7=a36_0x259f83;return _0x4a8308&&_0x4a8308[_0x2d45f7(0x166)]?_0x4a8308:{'default':_0x4a8308};};Object['defineProperty'](exports,a36_0x259f83(0x166),{'value':!![]}),exports['AdminService']=void 0x0;const database_1=__importDefault(require('../config/database')),bcryptjs_1=__importDefault(require(a36_0x259f83(0x139))),crypto_1=__importDefault(require(a36_0x259f83(0x217))),currencyService_1=require(a36_0x259f83(0x1da)),gateway_1=require(a36_0x259f83(0x143));function a36_0x3fba(_0x1f6de3,_0x3d6538){const _0x47e3b5=a36_0x47e3();return a36_0x3fba=function(_0x3fbab1,_0x3a530e){_0x3fbab1=_0x3fbab1-0x11c;let _0x1aff39=_0x47e3b5[_0x3fbab1];return _0x1aff39;},a36_0x3fba(_0x1f6de3,_0x3d6538);}class AdminService{async[a36_0x259f83(0x1af)](){const _0x2c1e82=a36_0x259f83;console[_0x2c1e82(0x215)](_0x2c1e82(0x222));const _0x40cc93=await database_1[_0x2c1e82(0x172)][_0x2c1e82(0x1ec)]['aggregate']({'_sum':{'balance':!![],'totalPaidOut':!![]},'where':{'status':_0x2c1e82(0x154)}}),_0x30d813=await this[_0x2c1e82(0x231)]({'page':0x1,'limit':0x3e8}),_0x42cff3=await database_1[_0x2c1e82(0x172)][_0x2c1e82(0x250)][_0x2c1e82(0x190)]({'where':{'status':_0x2c1e82(0x20c),'gateway':{'not':_0x2c1e82(0x16b)}}}),_0x30a739=new Date(),_0x5028a8=new Date(_0x30a739[_0x2c1e82(0x167)](),_0x30a739[_0x2c1e82(0x216)](),0x1),_0x31a513=new Date(_0x30a739[_0x2c1e82(0x167)](),_0x30a739[_0x2c1e82(0x216)]()+0x1,0x0,0x17,0x3b,0x3b,0x3e7),_0x9d9b7c=await database_1[_0x2c1e82(0x172)][_0x2c1e82(0x15c)]['aggregate']({'_sum':{'amount':!![]},'where':{'createdAt':{'gte':_0x5028a8,'lte':_0x31a513},'status':'COMPLETED'}}),_0x4ea57b=_0x40cc93['_sum'][_0x2c1e82(0x134)]||0x0,_0x5e44f6=_0x30d813['summary'][_0x2c1e82(0x1d3)],_0x10bce6=_0x9d9b7c[_0x2c1e82(0x17c)]['amount']||0x0,_0x1ed84f={'totalPayout':Math[_0x2c1e82(0x127)](_0x4ea57b*0x64)/0x64,'awaitingPayout':Math[_0x2c1e82(0x127)](_0x5e44f6*0x64)/0x64,'thisMonth':Math[_0x2c1e82(0x127)](_0x10bce6*0x64)/0x64,'availableBalance':Math[_0x2c1e82(0x127)](_0x5e44f6*0x64)/0x64,'totalPayments':_0x42cff3};return console[_0x2c1e82(0x215)]('📊\x20Payout\x20statistics\x20calculated:'),console[_0x2c1e82(0x215)](_0x2c1e82(0x1f6)+_0x1ed84f[_0x2c1e82(0x178)]+_0x2c1e82(0x122)),console[_0x2c1e82(0x215)]('\x20\x20\x20⏳\x20Awaiting\x20payout:\x20'+_0x1ed84f[_0x2c1e82(0x1ba)]+_0x2c1e82(0x15d)),console[_0x2c1e82(0x215)](_0x2c1e82(0x1cb)+_0x1ed84f[_0x2c1e82(0x1ce)]+_0x2c1e82(0x1e6)),console[_0x2c1e82(0x215)](_0x2c1e82(0x19f)+_0x1ed84f[_0x2c1e82(0x1e8)]+_0x2c1e82(0x138)),console[_0x2c1e82(0x215)](_0x2c1e82(0x237)+_0x1ed84f['totalPayments']+_0x2c1e82(0x1d7)),console['log'](_0x2c1e82(0x1a8)+(_0x40cc93[_0x2c1e82(0x17c)]['balance']||0x0)['toFixed'](0x2)+'\x20USDT\x20(without\x20commission)'),console[_0x2c1e82(0x215)](_0x2c1e82(0x24c)+((_0x40cc93[_0x2c1e82(0x17c)][_0x2c1e82(0x126)]||0x0)-_0x5e44f6)[_0x2c1e82(0x1b7)](0x2)+'\x20USDT'),_0x1ed84f;}async[a36_0x259f83(0x20d)](_0x465e57,_0x43b9d5){const _0x423a9c=a36_0x259f83;console[_0x423a9c(0x215)](_0x423a9c(0x1f5)+_0x465e57+':',_0x43b9d5);const _0x22c68b=await database_1['default']['payment'][_0x423a9c(0x20f)]({'where':{'id':_0x465e57},'select':{'id':!![],'customerEmail':!![],'customerName':!![],'customerCountry':!![],'customerIp':!![],'customerUa':!![]}});if(!_0x22c68b)throw new Error('Payment\x20not\x20found');const _0x1bdf17={};_0x43b9d5[_0x423a9c(0x1fd)]!==undefined&&(_0x1bdf17['customerCountry']=_0x43b9d5[_0x423a9c(0x1fd)]||null);_0x43b9d5['customerIp']!==undefined&&(_0x1bdf17[_0x423a9c(0x194)]=_0x43b9d5[_0x423a9c(0x194)]||null);_0x43b9d5[_0x423a9c(0x197)]!==undefined&&(_0x1bdf17['customerUa']=_0x43b9d5[_0x423a9c(0x197)]||null);const _0x7d9dfc=await database_1[_0x423a9c(0x172)][_0x423a9c(0x250)][_0x423a9c(0x21c)]({'where':{'id':_0x465e57},'data':{..._0x1bdf17,'updatedAt':new Date()},'select':{'id':!![],'customerEmail':!![],'customerName':!![],'customerCountry':!![],'customerIp':!![],'customerUa':!![],'updatedAt':!![]}});return console[_0x423a9c(0x215)]('✅\x20Customer\x20data\x20updated\x20for\x20payment\x20'+_0x465e57),console[_0x423a9c(0x215)](_0x423a9c(0x225)+_0x22c68b[_0x423a9c(0x1fd)]+'\x20->\x20'+_0x7d9dfc[_0x423a9c(0x1fd)]),console['log'](_0x423a9c(0x1f9)+_0x22c68b[_0x423a9c(0x194)]+_0x423a9c(0x20a)+_0x7d9dfc[_0x423a9c(0x194)]),console[_0x423a9c(0x215)](_0x423a9c(0x1dd)+(_0x22c68b['customerUa']?_0x423a9c(0x1e4):_0x423a9c(0x123))+_0x423a9c(0x20a)+(_0x7d9dfc[_0x423a9c(0x197)]?_0x423a9c(0x1e4):_0x423a9c(0x123))),_0x7d9dfc;}async[a36_0x259f83(0x1db)](_0x542618){const _0x2adb71=a36_0x259f83,_0x1aa322=new Date();let _0x21ba88;switch(_0x542618[_0x2adb71(0x136)]()){case _0x2adb71(0x19a):case _0x2adb71(0x1e2):_0x21ba88=new Date(_0x1aa322[_0x2adb71(0x167)](),_0x1aa322[_0x2adb71(0x216)](),_0x1aa322[_0x2adb71(0x1c8)](),0x0,0x0,0x0,0x0);break;case'7d':_0x21ba88=new Date(_0x1aa322[_0x2adb71(0x23b)]()-0x7*0x18*0x3c*0x3c*0x3e8);break;case'30d':_0x21ba88=new Date(_0x1aa322['getTime']()-0x1e*0x18*0x3c*0x3c*0x3e8);break;case _0x2adb71(0x1fe):_0x21ba88=new Date(_0x1aa322[_0x2adb71(0x23b)]()-0x5a*0x18*0x3c*0x3c*0x3e8);break;case'all':const _0x39674e=await database_1['default'][_0x2adb71(0x250)][_0x2adb71(0x155)]({'where':{'gateway':{'not':'test_gateway'}},'orderBy':{'createdAt':'asc'},'select':{'createdAt':!![]}});_0x21ba88=_0x39674e?_0x39674e[_0x2adb71(0x221)]:new Date(_0x2adb71(0x168));break;default:_0x21ba88=new Date(_0x1aa322['getTime']()-0x1e*0x18*0x3c*0x3c*0x3e8);}_0x21ba88[_0x2adb71(0x1cd)](0x0,0x0,0x0,0x0);const [_0x12f7f8,_0x429cb9,_0x3551c1,_0x528f85,_0x276c91,_0x15df18]=await Promise[_0x2adb71(0x1a5)]([database_1[_0x2adb71(0x172)][_0x2adb71(0x1ec)]['count'](),database_1[_0x2adb71(0x172)][_0x2adb71(0x1ec)]['count']({'where':{'status':_0x2adb71(0x154)}}),database_1[_0x2adb71(0x172)][_0x2adb71(0x250)][_0x2adb71(0x190)]({'where':{'status':_0x2adb71(0x20c),'createdAt':{'gte':_0x21ba88},'gateway':{'not':_0x2adb71(0x16b)}}}),database_1['default']['payment'][_0x2adb71(0x164)]({'where':{'status':_0x2adb71(0x20c),'createdAt':{'gte':_0x21ba88},'gateway':{'not':_0x2adb71(0x16b)}},'select':{'amount':!![],'currency':!![],'amountAfterGatewayCommissionUSDT':!![]}}),database_1['default'][_0x2adb71(0x250)][_0x2adb71(0x164)]({'where':{'gateway':{'not':_0x2adb71(0x16b)}},'take':0xa,'orderBy':{'createdAt':_0x2adb71(0x179)},'include':{'shop':{'select':{'name':!![],'username':!![]}}}}),database_1[_0x2adb71(0x172)][_0x2adb71(0x250)][_0x2adb71(0x164)]({'where':{'createdAt':{'gte':_0x21ba88},'gateway':{'not':'test_gateway'}},'select':{'amount':!![],'currency':!![],'status':!![],'amountUSDT':!![],'createdAt':!![]}})]);let _0x33b2e3=0x0,_0x9e39=0x0;for(const _0x40174a of _0x528f85){const _0x1fd341=await currencyService_1[_0x2adb71(0x223)]['convertToUSDT'](_0x40174a['amount'],_0x40174a[_0x2adb71(0x125)]);_0x33b2e3+=_0x1fd341;if(_0x40174a[_0x2adb71(0x15a)]){const _0xc4cec7=await currencyService_1[_0x2adb71(0x223)][_0x2adb71(0x11d)](_0x40174a[_0x2adb71(0x144)],_0x40174a[_0x2adb71(0x125)]),_0x591a56=_0x40174a[_0x2adb71(0x15a)],_0x27e38b=_0xc4cec7-_0x591a56;_0x9e39+=_0x27e38b;}}const _0x3ca57f=_0x3551c1>0x0?_0x33b2e3/_0x3551c1:0x0,_0x5cae54=this[_0x2adb71(0x240)](_0x15df18,_0x21ba88,_0x1aa322),_0x49ca4b=await database_1[_0x2adb71(0x172)][_0x2adb71(0x250)][_0x2adb71(0x190)]({'where':{'createdAt':{'gte':_0x21ba88},'gateway':{'not':_0x2adb71(0x16b)}}}),_0x4cbac8=_0x49ca4b>0x0?_0x3551c1/_0x49ca4b*0x64:0x0;return{'totalShops':_0x12f7f8,'activeShops':_0x429cb9,'totalPayments':_0x3551c1,'successfulPayments':_0x3551c1,'totalAttempts':_0x49ca4b,'totalRevenue':Math[_0x2adb71(0x127)](_0x33b2e3*0x64)/0x64,'trapayEarnings':Math[_0x2adb71(0x127)](_0x9e39*0x64)/0x64,'averagePaymentAmount':Math['round'](_0x3ca57f*0x64)/0x64,'conversionRate':Math[_0x2adb71(0x127)](_0x4cbac8*0x64)/0x64,'dailyRevenue':_0x5cae54[_0x2adb71(0x249)],'dailyPayments':_0x5cae54[_0x2adb71(0x162)],'recentPayments':_0x276c91[_0x2adb71(0x1a0)](_0x1b620f=>({'id':_0x1b620f['id'],'amount':_0x1b620f['amount'],'currency':_0x1b620f[_0x2adb71(0x125)],'status':_0x1b620f[_0x2adb71(0x16e)],'gateway':_0x1b620f[_0x2adb71(0x1d1)],'shop':_0x1b620f['shop'],'createdAt':_0x1b620f[_0x2adb71(0x221)]}))};}async['getMerchantStatistics'](_0x3078d5){const _0x2f66ff=a36_0x259f83;console['log'](_0x2f66ff(0x1e9),_0x3078d5);let _0x290460,_0x18c959=new Date();if(_0x3078d5[_0x2f66ff(0x151)]===_0x2f66ff(0x1df)&&_0x3078d5[_0x2f66ff(0x1ef)]&&_0x3078d5['dateTo'])_0x290460=new Date(_0x3078d5[_0x2f66ff(0x1ef)]),_0x18c959=new Date(_0x3078d5[_0x2f66ff(0x1f3)]),_0x290460[_0x2f66ff(0x1cd)](0x0,0x0,0x0,0x0),_0x18c959['setHours'](0xb,0x3b,0x3b,0x3e7);else{const _0x112ca9=new Date();switch(_0x3078d5[_0x2f66ff(0x151)]){case _0x2f66ff(0x1c3):_0x290460=new Date(_0x112ca9[_0x2f66ff(0x23b)]()-0x7*0x18*0x3c*0x3c*0x3e8);break;case _0x2f66ff(0x173):_0x290460=new Date(_0x112ca9['getTime']()-0x1e*0x18*0x3c*0x3c*0x3e8);break;case'year':_0x290460=new Date(_0x112ca9[_0x2f66ff(0x23b)]()-0x16d*0x18*0x3c*0x3c*0x3e8);break;case _0x2f66ff(0x1a5):default:_0x290460=new Date(_0x2f66ff(0x168));break;}_0x290460['setHours'](0x0,0x0,0x0,0x0),_0x18c959[_0x2f66ff(0x1cd)](0xb,0x3b,0x3b,0x3e7);}console['log'](_0x2f66ff(0x13a)+_0x290460[_0x2f66ff(0x14c)]()+_0x2f66ff(0x201)+_0x18c959[_0x2f66ff(0x14c)]());const _0x2dbaef={'status':_0x2f66ff(0x20c),'gateway':{'not':_0x2f66ff(0x16b)},'paidAt':{'gte':_0x290460,'lte':_0x18c959}};_0x3078d5['shopId']&&(_0x2dbaef[_0x2f66ff(0x204)]=_0x3078d5[_0x2f66ff(0x204)]);const _0x493604=await database_1['default']['payment'][_0x2f66ff(0x164)]({'where':_0x2dbaef,'include':{'shop':{'select':{'id':!![],'name':!![],'username':!![],'gatewaySettings':!![]}}}});console['log']('💰\x20Found\x20'+_0x493604[_0x2f66ff(0x188)]+_0x2f66ff(0x1b8));const _0x40e0b7={'gateway':{'not':_0x2f66ff(0x16b)},'createdAt':{'gte':_0x290460,'lte':_0x18c959}};_0x3078d5[_0x2f66ff(0x204)]&&(_0x40e0b7[_0x2f66ff(0x204)]=_0x3078d5[_0x2f66ff(0x204)]);const _0x4aae54=await database_1[_0x2f66ff(0x172)][_0x2f66ff(0x250)][_0x2f66ff(0x190)]({'where':_0x40e0b7});console[_0x2f66ff(0x215)](_0x2f66ff(0x1f2)+_0x4aae54+_0x2f66ff(0x1a9)+_0x493604['length']);let _0x1787bb=0x0,_0x25c93b=0x0,_0x425f67=0x0;const _0x1c9e98={},_0x457649={},_0x1022cb={};for(const _0xa5d0ad of _0x493604){try{const _0x5f544e=await currencyService_1[_0x2f66ff(0x223)][_0x2f66ff(0x11d)](_0xa5d0ad[_0x2f66ff(0x144)],_0xa5d0ad[_0x2f66ff(0x125)]);let _0x59a389={};if(_0xa5d0ad[_0x2f66ff(0x1ec)][_0x2f66ff(0x12c)])try{_0x59a389=JSON[_0x2f66ff(0x1fa)](_0xa5d0ad[_0x2f66ff(0x1ec)]['gatewaySettings']);}catch(_0x1facbb){console[_0x2f66ff(0x1e3)](_0x2f66ff(0x124)+_0xa5d0ad[_0x2f66ff(0x204)]+':',_0x1facbb);}let _0x1c30c2={},_0x2c7591=0xa;for(const [_0x55ff77,_0x58af67]of Object['entries'](_0x59a389)){if(_0x55ff77[_0x2f66ff(0x136)]()===_0xa5d0ad[_0x2f66ff(0x1d1)]['toLowerCase']()){_0x1c30c2=_0x58af67,_0x2c7591=_0x58af67[_0x2f66ff(0x209)]||0xa;break;}}let _0x19e0a9,_0x28f2f5;_0xa5d0ad[_0x2f66ff(0x15a)]!==null&&_0xa5d0ad['amountAfterGatewayCommissionUSDT']!==undefined?(_0x19e0a9=_0xa5d0ad[_0x2f66ff(0x15a)],_0x28f2f5=_0x5f544e-_0x19e0a9,console[_0x2f66ff(0x215)]('📊\x20Using\x20saved\x20amountAfterGatewayCommissionUSDT:\x20'+_0x19e0a9[_0x2f66ff(0x1b7)](0x6)+'\x20USDT\x20for\x20payment\x20'+_0xa5d0ad['id'])):(_0x28f2f5=_0x5f544e*(_0x2c7591/0x64),_0x19e0a9=_0x5f544e-_0x28f2f5,console[_0x2f66ff(0x215)](_0x2f66ff(0x129)+_0xa5d0ad['id']+':\x20'+_0x2c7591+_0x2f66ff(0x150)+_0x5f544e['toFixed'](0x6)+_0x2f66ff(0x138)));_0x1787bb+=_0x5f544e,_0x25c93b+=_0x19e0a9,_0x425f67+=_0x28f2f5;!_0x1c9e98[_0xa5d0ad['gateway']]&&(_0x1c9e98[_0xa5d0ad['gateway']]={'gateway':_0xa5d0ad[_0x2f66ff(0x1d1)],'gatewayDisplayName':this[_0x2f66ff(0x133)](_0xa5d0ad['gateway']),'paymentsCount':0x0,'turnoverUSDT':0x0,'commissionUSDT':0x0,'merchantEarningsUSDT':0x0,'totalCommissionRate':0x0});_0x1c9e98[_0xa5d0ad[_0x2f66ff(0x1d1)]]['paymentsCount']++,_0x1c9e98[_0xa5d0ad[_0x2f66ff(0x1d1)]][_0x2f66ff(0x1bc)]+=_0x5f544e,_0x1c9e98[_0xa5d0ad[_0x2f66ff(0x1d1)]][_0x2f66ff(0x24a)]+=_0x28f2f5,_0x1c9e98[_0xa5d0ad[_0x2f66ff(0x1d1)]]['merchantEarningsUSDT']+=_0x19e0a9,_0x1c9e98[_0xa5d0ad[_0x2f66ff(0x1d1)]]['totalCommissionRate']+=_0x2c7591;!_0x3078d5[_0x2f66ff(0x204)]&&(!_0x457649[_0xa5d0ad['shopId']]&&(_0x457649[_0xa5d0ad[_0x2f66ff(0x204)]]={'shopId':_0xa5d0ad['shopId'],'shopName':_0xa5d0ad[_0x2f66ff(0x1ec)][_0x2f66ff(0x244)],'shopUsername':_0xa5d0ad[_0x2f66ff(0x1ec)][_0x2f66ff(0x130)],'paymentsCount':0x0,'turnoverUSDT':0x0,'commissionUSDT':0x0,'merchantEarningsUSDT':0x0,'paidOutUSDT':0x0,'averageCheckUSDT':0x0}),_0x457649[_0xa5d0ad[_0x2f66ff(0x204)]]['paymentsCount']++,_0x457649[_0xa5d0ad['shopId']][_0x2f66ff(0x1bc)]+=_0x5f544e,_0x457649[_0xa5d0ad[_0x2f66ff(0x204)]][_0x2f66ff(0x24a)]+=_0x28f2f5,_0x457649[_0xa5d0ad['shopId']][_0x2f66ff(0x1a4)]+=_0x19e0a9);const _0x9aaf57=_0xa5d0ad[_0x2f66ff(0x1ea)][_0x2f66ff(0x14c)]()[_0x2f66ff(0x251)]('T')[0x0];!_0x1022cb[_0x9aaf57]&&(_0x1022cb[_0x9aaf57]={'date':_0x9aaf57,'turnover':0x0,'merchantEarnings':0x0,'gatewayEarnings':0x0,'paymentsCount':0x0}),_0x1022cb[_0x9aaf57][_0x2f66ff(0x1d8)]+=_0x5f544e,_0x1022cb[_0x9aaf57][_0x2f66ff(0x142)]+=_0x19e0a9,_0x1022cb[_0x9aaf57]['gatewayEarnings']+=_0x28f2f5,_0x1022cb[_0x9aaf57][_0x2f66ff(0x24b)]++;}catch(_0xd90627){console[_0x2f66ff(0x1e3)]('Error\x20processing\x20payment\x20'+_0xa5d0ad['id']+':',_0xd90627);}}Object['values'](_0x1c9e98)[_0x2f66ff(0x1de)](_0x47b292=>{const _0x3c7b1d=_0x2f66ff;_0x47b292[_0x3c7b1d(0x121)]=_0x47b292[_0x3c7b1d(0x24b)]>0x0?_0x47b292[_0x3c7b1d(0x149)]/_0x47b292[_0x3c7b1d(0x24b)]:0x0,delete _0x47b292[_0x3c7b1d(0x149)];}),Object[_0x2f66ff(0x21a)](_0x457649)[_0x2f66ff(0x1de)](_0x44bab7=>{const _0x2563a7=_0x2f66ff;_0x44bab7[_0x2563a7(0x191)]=_0x44bab7[_0x2563a7(0x24b)]>0x0?_0x44bab7[_0x2563a7(0x1bc)]/_0x44bab7[_0x2563a7(0x24b)]:0x0;});let _0x56930a=0x0,_0x35420f=0x0;if(_0x3078d5[_0x2f66ff(0x204)]){const _0x1e657b=await database_1[_0x2f66ff(0x172)]['payout'][_0x2f66ff(0x164)]({'where':{'shopId':_0x3078d5[_0x2f66ff(0x204)],'status':'COMPLETED','createdAt':{'gte':_0x290460,'lte':_0x18c959}},'select':{'amount':!![]}});_0x56930a=_0x1e657b[_0x2f66ff(0x140)]((_0xfe244c,_0x41da23)=>_0xfe244c+_0x41da23['amount'],0x0);const _0x605cf8=await database_1[_0x2f66ff(0x172)][_0x2f66ff(0x15c)][_0x2f66ff(0x164)]({'where':{'shopId':_0x3078d5[_0x2f66ff(0x204)],'status':'PENDING','createdAt':{'gte':_0x290460,'lte':_0x18c959}},'select':{'amount':!![]}});_0x35420f=_0x605cf8[_0x2f66ff(0x140)]((_0x4da51d,_0x38b772)=>_0x4da51d+_0x38b772['amount'],0x0);}const _0x3cf517=_0x4aae54,_0x7bc9ba=_0x493604['length'],_0x4a7f89=_0x7bc9ba>0x0?_0x1787bb/_0x7bc9ba:0x0,_0x87abc3=_0x3cf517>0x0?Math[_0x2f66ff(0x127)](_0x7bc9ba/_0x3cf517*0x2710)/0x64:0x0,_0xb78405=Math['ceil']((_0x18c959['getTime']()-_0x290460[_0x2f66ff(0x23b)]())/(0x3e8*0x3c*0x3c*0x18)),_0x3862ad={'totalTurnover':Math[_0x2f66ff(0x127)](_0x1787bb*0x64)/0x64,'merchantEarnings':Math[_0x2f66ff(0x127)](_0x25c93b*0x64)/0x64,'gatewayEarnings':Math['round'](_0x425f67*0x64)/0x64,'totalPaidOut':Math['round'](_0x56930a*0x64)/0x64,'pendingPayout':Math['round'](_0x35420f*0x64)/0x64,'averageCheck':Math[_0x2f66ff(0x127)](_0x4a7f89*0x64)/0x64,'totalPayments':_0x3cf517,'successfulPayments':_0x7bc9ba,'conversionRate':_0x87abc3,'gatewayBreakdown':Object[_0x2f66ff(0x21a)](_0x1c9e98)[_0x2f66ff(0x1a0)](_0x382451=>({..._0x382451,'turnoverUSDT':Math[_0x2f66ff(0x127)](_0x382451[_0x2f66ff(0x1bc)]*0x64)/0x64,'commissionUSDT':Math['round'](_0x382451[_0x2f66ff(0x24a)]*0x64)/0x64,'merchantEarningsUSDT':Math['round'](_0x382451[_0x2f66ff(0x1a4)]*0x64)/0x64,'averageCommissionRate':Math[_0x2f66ff(0x127)](_0x382451[_0x2f66ff(0x121)]*0x64)/0x64})),'merchantBreakdown':_0x3078d5[_0x2f66ff(0x204)]?undefined:Object['values'](_0x457649)[_0x2f66ff(0x1a0)](_0x3f76fc=>({..._0x3f76fc,'turnoverUSDT':Math[_0x2f66ff(0x127)](_0x3f76fc[_0x2f66ff(0x1bc)]*0x64)/0x64,'commissionUSDT':Math[_0x2f66ff(0x127)](_0x3f76fc[_0x2f66ff(0x24a)]*0x64)/0x64,'merchantEarningsUSDT':Math[_0x2f66ff(0x127)](_0x3f76fc[_0x2f66ff(0x1a4)]*0x64)/0x64,'paidOutUSDT':Math[_0x2f66ff(0x127)](_0x3f76fc[_0x2f66ff(0x19b)]*0x64)/0x64,'averageCheckUSDT':Math[_0x2f66ff(0x127)](_0x3f76fc[_0x2f66ff(0x191)]*0x64)/0x64})),'dailyData':Object[_0x2f66ff(0x21a)](_0x1022cb)['map'](_0x56c48=>({..._0x56c48,'turnover':Math[_0x2f66ff(0x127)](_0x56c48[_0x2f66ff(0x1d8)]*0x64)/0x64,'merchantEarnings':Math[_0x2f66ff(0x127)](_0x56c48[_0x2f66ff(0x142)]*0x64)/0x64,'gatewayEarnings':Math[_0x2f66ff(0x127)](_0x56c48[_0x2f66ff(0x174)]*0x64)/0x64}))[_0x2f66ff(0x206)]((_0x486360,_0x8fbbb8)=>_0x486360[_0x2f66ff(0x1cf)][_0x2f66ff(0x185)](_0x8fbbb8[_0x2f66ff(0x1cf)])),'periodInfo':{'from':_0x290460,'to':_0x18c959,'periodType':_0x3078d5[_0x2f66ff(0x151)]||'custom','daysCount':_0xb78405}};return console['log']('📊\x20Merchant\x20statistics\x20calculated:'),console[_0x2f66ff(0x215)](_0x2f66ff(0x16a)+_0x3862ad[_0x2f66ff(0x1ae)]+_0x2f66ff(0x138)),console[_0x2f66ff(0x215)]('\x20\x20\x20👤\x20Merchant\x20earnings:\x20'+_0x3862ad[_0x2f66ff(0x142)]+_0x2f66ff(0x138)),console[_0x2f66ff(0x215)]('\x20\x20\x20🏪\x20Gateway\x20earnings:\x20'+_0x3862ad[_0x2f66ff(0x174)]+'\x20USDT'),console[_0x2f66ff(0x215)](_0x2f66ff(0x1d9)+_0x3862ad[_0x2f66ff(0x134)]+_0x2f66ff(0x138)),console[_0x2f66ff(0x215)](_0x2f66ff(0x171)+_0x3862ad[_0x2f66ff(0x156)]+_0x2f66ff(0x138)),console[_0x2f66ff(0x215)]('\x20\x20\x20�📊\x20Total\x20payments:\x20'+_0x3862ad[_0x2f66ff(0x1e1)]),_0x3862ad;}async[a36_0x259f83(0x1b6)](){const _0x38786e=a36_0x259f83;console[_0x38786e(0x215)]('📋\x20Getting\x20merchants\x20selection\x20list...');const _0x1eb6d9=await database_1[_0x38786e(0x172)][_0x38786e(0x1ec)]['findMany']({'where':{'status':_0x38786e(0x154)},'select':{'id':!![],'username':!![],'name':!![]},'orderBy':{'name':'asc'}});return console[_0x38786e(0x215)]('📋\x20Found\x20'+_0x1eb6d9[_0x38786e(0x188)]+_0x38786e(0x1b3)),_0x1eb6d9['map'](_0x295734=>({'id':_0x295734['id'],'username':_0x295734[_0x38786e(0x130)],'name':_0x295734[_0x38786e(0x244)]}));}[a36_0x259f83(0x133)](_0x412587){const _0x233c01=a36_0x259f83,_0x15c2cb={'test_gateway':_0x233c01(0x195),'plisio':_0x233c01(0x12e),'rapyd':_0x233c01(0x22c),'noda':'Noda','cointopay':_0x233c01(0x141),'cointopay2':_0x233c01(0x239),'klyme_eu':_0x233c01(0x1c5),'klyme_gb':_0x233c01(0x1a1),'klyme_de':'KLYME\x20DE','mastercard':'MasterCard'};return _0x15c2cb[_0x412587]||_0x412587;}[a36_0x259f83(0x17f)](_0x5efb9e){const _0x227fd8=a36_0x259f83,_0x4cf3a9={'Test\x20Gateway':'test_gateway','Plisio':'plisio','Rapyd':'rapyd','Noda':'noda','CoinToPay':_0x227fd8(0x13e),'CoinToPay2':_0x227fd8(0x11c),'KLYME\x20EU':_0x227fd8(0x242),'KLYME\x20GB':'klyme_gb','KLYME\x20DE':_0x227fd8(0x120),'MasterCard':_0x227fd8(0x12a)};return _0x4cf3a9[_0x5efb9e]||_0x5efb9e[_0x227fd8(0x136)]();}async['getMerchantsAwaitingPayout'](_0x549ccb){const _0x5480d6=a36_0x259f83,{page:_0x1ce732,limit:_0x3b05f4,minAmount:_0x1394d5,search:_0x4050d7}=_0x549ccb,_0x4dd2d3=(_0x1ce732-0x1)*_0x3b05f4;console['log'](_0x5480d6(0x21b),_0x549ccb);const _0x335d2b={'balance':{'gt':0x0},'status':_0x5480d6(0x154)};_0x1394d5&&(_0x335d2b[_0x5480d6(0x126)][_0x5480d6(0x218)]=_0x1394d5);_0x4050d7&&(_0x335d2b[_0x5480d6(0x244)]={'contains':_0x4050d7,'mode':_0x5480d6(0x13d)});const [_0x210bb4,_0x3f9ad6]=await Promise[_0x5480d6(0x1a5)]([database_1[_0x5480d6(0x172)][_0x5480d6(0x1ec)][_0x5480d6(0x164)]({'where':_0x335d2b,'skip':_0x4dd2d3,'take':_0x3b05f4,'orderBy':{'balance':_0x5480d6(0x179)},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'balance':!![],'totalPaidOut':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'gatewaySettings':!![],'createdAt':!![]}}),database_1[_0x5480d6(0x172)]['shop']['count']({'where':_0x335d2b})]);console[_0x5480d6(0x215)](_0x5480d6(0x245)+_0x210bb4[_0x5480d6(0x188)]+'\x20merchants\x20with\x20positive\x20balance');const _0x1f56fa=await Promise[_0x5480d6(0x1a5)](_0x210bb4[_0x5480d6(0x1a0)](async _0x540d1d=>{const _0x2b20b6=_0x5480d6,[_0x1688ce,_0x27630f,_0x503429]=await Promise['all']([database_1['default'][_0x2b20b6(0x250)][_0x2b20b6(0x190)]({'where':{'shopId':_0x540d1d['id'],'status':'PAID','gateway':{'not':_0x2b20b6(0x16b)}}}),database_1[_0x2b20b6(0x172)][_0x2b20b6(0x250)][_0x2b20b6(0x155)]({'where':{'shopId':_0x540d1d['id'],'status':_0x2b20b6(0x20c),'gateway':{'not':_0x2b20b6(0x16b)}},'orderBy':{'paidAt':_0x2b20b6(0x230)},'select':{'paidAt':!![]}}),database_1[_0x2b20b6(0x172)][_0x2b20b6(0x250)][_0x2b20b6(0x192)]({'by':[_0x2b20b6(0x1d1)],'where':{'shopId':_0x540d1d['id'],'status':'PAID','gateway':{'not':_0x2b20b6(0x16b)}},'_count':{'id':!![]},'_sum':{'amountUSDT':!![]}})]),_0x291573=new Date(),_0x3e0388=new Date(_0x291573['getFullYear'](),_0x291573['getMonth'](),0x1),_0xc7fecd=new Date(_0x291573[_0x2b20b6(0x167)](),_0x291573[_0x2b20b6(0x216)]()+0x1,0x0,0x17,0x3b,0x3b,0x3e7),[_0x1667a7,_0x47bcb0]=await Promise[_0x2b20b6(0x1a5)]([database_1['default']['payout'][_0x2b20b6(0x21f)]({'_sum':{'amount':!![]},'where':{'shopId':_0x540d1d['id'],'status':_0x2b20b6(0x252)}}),database_1[_0x2b20b6(0x172)]['payout']['aggregate']({'_sum':{'amount':!![]},'where':{'shopId':_0x540d1d['id'],'status':_0x2b20b6(0x252),'createdAt':{'gte':_0x3e0388,'lte':_0xc7fecd}}})]),_0x3f152c=_0x1667a7[_0x2b20b6(0x17c)][_0x2b20b6(0x144)]||0x0,_0x26e735=_0x47bcb0[_0x2b20b6(0x17c)][_0x2b20b6(0x144)]||0x0,_0x21617d=await Promise[_0x2b20b6(0x1a5)](_0x503429[_0x2b20b6(0x1a0)](async _0x2ac163=>{const _0xe9eaba=_0x2b20b6;let _0x5affd7=0xa;if(_0x540d1d[_0xe9eaba(0x12c)])try{const _0x56bb65=JSON[_0xe9eaba(0x1fa)](_0x540d1d[_0xe9eaba(0x12c)]);for(const [_0x581eb2,_0x199cf9]of Object[_0xe9eaba(0x238)](_0x56bb65)){if(_0x581eb2[_0xe9eaba(0x136)]()===_0x2ac163[_0xe9eaba(0x1d1)][_0xe9eaba(0x136)]()){_0x5affd7=_0x199cf9['commission']||0xa,console[_0xe9eaba(0x215)](_0xe9eaba(0x159)+_0x2ac163[_0xe9eaba(0x1d1)]+_0xe9eaba(0x18c)+_0x540d1d['id']+_0xe9eaba(0x1a7)+_0x5affd7+'%');break;}}}catch(_0x3bf8da){console[_0xe9eaba(0x1e3)]('Error\x20parsing\x20gateway\x20settings\x20for\x20shop\x20'+_0x540d1d['id']+':',_0x3bf8da);}const _0x5eea11=_0x2ac163[_0xe9eaba(0x17c)]?.[_0xe9eaba(0x227)]||0x0,_0x4fa27c=_0x5eea11*(0x1-_0x5affd7/0x64);return{'gateway':_0x2ac163[_0xe9eaba(0x1d1)],'count':_0x2ac163[_0xe9eaba(0x17e)]?.['id']||0x0,'amountUSDT':Math[_0xe9eaba(0x127)](_0x5eea11*0x64)/0x64,'amountAfterCommissionUSDT':Math[_0xe9eaba(0x127)](_0x4fa27c*0x64)/0x64,'commission':_0x5affd7};})),_0x10c336=_0x21617d['reduce']((_0x5a50d4,_0x576c1e)=>_0x5a50d4+_0x576c1e['amountUSDT'],0x0),_0x573585=_0x540d1d[_0x2b20b6(0x126)];return console['log'](_0x2b20b6(0x224)+_0x540d1d[_0x2b20b6(0x130)]+':'),console[_0x2b20b6(0x215)](_0x2b20b6(0x182)+_0x10c336[_0x2b20b6(0x1b7)](0x2)+_0x2b20b6(0x1fc)),console[_0x2b20b6(0x215)](_0x2b20b6(0x18e)+_0x21617d[_0x2b20b6(0x140)]((_0x44dd86,_0x5d5a66)=>_0x44dd86+_0x5d5a66[_0x2b20b6(0x160)],0x0)[_0x2b20b6(0x1b7)](0x2)+_0x2b20b6(0x18d)),console['log'](_0x2b20b6(0x207)+_0x573585[_0x2b20b6(0x1b7)](0x2)+_0x2b20b6(0x22f)),{'id':_0x540d1d['id'],'fullName':_0x540d1d['name'],'username':_0x540d1d[_0x2b20b6(0x130)],'telegramId':_0x540d1d['telegram'],'merchantUrl':_0x540d1d[_0x2b20b6(0x184)],'wallets':{'usdtPolygonWallet':_0x540d1d['usdtPolygonWallet'],'usdtTrcWallet':_0x540d1d[_0x2b20b6(0x1f8)],'usdtErcWallet':_0x540d1d[_0x2b20b6(0x13b)],'usdcPolygonWallet':_0x540d1d[_0x2b20b6(0x17b)]},'totalAmountUSDT':Math[_0x2b20b6(0x127)](_0x10c336*0x64)/0x64,'totalAmountAfterCommissionUSDT':Math[_0x2b20b6(0x127)](_0x573585*0x64)/0x64,'totalPayout':Math[_0x2b20b6(0x127)](_0x3f152c*0x64)/0x64,'thisMonth':Math[_0x2b20b6(0x127)](_0x26e735*0x64)/0x64,'paymentsCount':_0x1688ce,'oldestPaymentDate':_0x27630f?.[_0x2b20b6(0x1ea)]||_0x540d1d[_0x2b20b6(0x221)],'gatewayBreakdown':_0x21617d};})),_0x122054=_0x1f56fa[_0x5480d6(0x140)]((_0x17c0f1,_0x4ab916)=>_0x17c0f1+_0x4ab916['totalAmountUSDT'],0x0),_0x4b2da3=_0x1f56fa[_0x5480d6(0x140)]((_0x554e47,_0x3b70ee)=>_0x554e47+_0x3b70ee[_0x5480d6(0x1d3)],0x0),_0x2bb848=_0x1f56fa[_0x5480d6(0x140)]((_0x113444,_0x158675)=>_0x113444+_0x158675['totalPayout'],0x0),_0x1919e1=_0x1f56fa['reduce']((_0x1a87f0,_0x32fca4)=>_0x1a87f0+_0x32fca4['thisMonth'],0x0);return console[_0x5480d6(0x215)](_0x5480d6(0x1d6)+_0x3f9ad6+_0x5480d6(0x1b4)),console['log'](_0x5480d6(0x147)+Math['round'](_0x122054*0x64)/0x64+'\x20USDT\x20(gross\x20revenue)'),console[_0x5480d6(0x215)](_0x5480d6(0x1a3)+Math[_0x5480d6(0x127)](_0x4b2da3*0x64)/0x64+_0x5480d6(0x170)),console['log'](_0x5480d6(0x196)+Math[_0x5480d6(0x127)](_0x2bb848*0x64)/0x64+_0x5480d6(0x138)),console[_0x5480d6(0x215)]('\x20\x20\x20📅\x20Total\x20payouts\x20(this\x20month):\x20'+Math[_0x5480d6(0x127)](_0x1919e1*0x64)/0x64+_0x5480d6(0x138)),{'merchants':_0x1f56fa,'pagination':{'page':_0x1ce732,'limit':_0x3b05f4,'total':_0x3f9ad6,'totalPages':Math[_0x5480d6(0x235)](_0x3f9ad6/_0x3b05f4)},'summary':{'totalMerchants':_0x3f9ad6,'totalAmountUSDT':Math[_0x5480d6(0x127)](_0x122054*0x64)/0x64,'totalAmountAfterCommissionUSDT':Math[_0x5480d6(0x127)](_0x4b2da3*0x64)/0x64,'totalPayout':Math[_0x5480d6(0x127)](_0x2bb848*0x64)/0x64,'thisMonth':Math[_0x5480d6(0x127)](_0x1919e1*0x64)/0x64}};}async[a36_0x259f83(0x19d)](_0x1d1e6f){const _0x351b6f=a36_0x259f83,{shopId:_0x582bf3,amount:_0x27d3df,network:_0x2ff597,wallet:_0x70ee2f,notes:_0x59c43b,txid:_0x1424e8,periodFrom:_0x509aa7,periodTo:_0xc6d04d}=_0x1d1e6f,_0x5f2a66=await database_1[_0x351b6f(0x172)][_0x351b6f(0x163)](async _0x250eb3=>{const _0x578afa=_0x351b6f,_0x248c1f=await _0x250eb3[_0x578afa(0x1ec)][_0x578afa(0x20f)]({'where':{'id':_0x582bf3},'select':{'id':!![],'name':!![],'username':!![],'balance':!![],'totalPaidOut':!![]}});if(!_0x248c1f)throw new Error(_0x578afa(0x214));console['log'](_0x578afa(0x1ed)+_0x248c1f[_0x578afa(0x130)]+':'),console[_0x578afa(0x215)](_0x578afa(0x198)+_0x248c1f[_0x578afa(0x126)][_0x578afa(0x1b7)](0x6)+_0x578afa(0x138)),console[_0x578afa(0x215)]('\x20\x20\x20Payout\x20amount:\x20'+_0x27d3df['toFixed'](0x6)+_0x578afa(0x138)),console['log']('\x20\x20\x20Current\x20total\x20paid\x20out:\x20'+_0x248c1f[_0x578afa(0x134)]['toFixed'](0x6)+_0x578afa(0x138));if(_0x1424e8)console[_0x578afa(0x215)](_0x578afa(0x233)+_0x1424e8);if(_0x248c1f[_0x578afa(0x126)]<_0x27d3df)throw new Error('Insufficient\x20balance.\x20Available:\x20'+_0x248c1f['balance']['toFixed'](0x6)+_0x578afa(0x1cc)+_0x27d3df[_0x578afa(0x1b7)](0x6)+_0x578afa(0x138));let _0x283ebb=_0x70ee2f;if(!_0x283ebb){const _0x242d89=await _0x250eb3[_0x578afa(0x1ec)][_0x578afa(0x20f)]({'where':{'id':_0x582bf3},'select':{'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![]}});if(_0x242d89)switch(_0x2ff597){case _0x578afa(0x161):_0x283ebb=_0x242d89[_0x578afa(0x14d)]||undefined;break;case _0x578afa(0x255):_0x283ebb=_0x242d89[_0x578afa(0x1f8)]||undefined;break;case'erc20':_0x283ebb=_0x242d89[_0x578afa(0x13b)]||undefined;break;case _0x578afa(0x1e0):_0x283ebb=_0x242d89[_0x578afa(0x17b)]||undefined;break;}}console[_0x578afa(0x215)](_0x578afa(0x20e)+_0x2ff597+':\x20'+(_0x283ebb||_0x578afa(0x1b1)));const _0x283f2f=await _0x250eb3['payout'][_0x578afa(0x1d0)]({'data':{'shopId':_0x582bf3,'amount':_0x27d3df,'network':_0x2ff597,'status':'COMPLETED','txid':_0x1424e8,'notes':_0x59c43b,'periodFrom':_0x509aa7?new Date(_0x509aa7):null,'periodTo':_0xc6d04d?new Date(_0xc6d04d):null,'createdAt':new Date(),'paidAt':new Date()}}),_0x33c3f9=_0x248c1f['balance']-_0x27d3df,_0x3de119=_0x248c1f[_0x578afa(0x134)]+_0x27d3df;return await _0x250eb3[_0x578afa(0x1ec)][_0x578afa(0x21c)]({'where':{'id':_0x582bf3},'data':{'balance':_0x33c3f9,'totalPaidOut':_0x3de119}}),console[_0x578afa(0x215)](_0x578afa(0x254)+_0x248c1f[_0x578afa(0x130)]+'\x20balance\x20updated:'),console[_0x578afa(0x215)](_0x578afa(0x1c0)+_0x248c1f[_0x578afa(0x126)][_0x578afa(0x1b7)](0x6)+_0x578afa(0x20a)+_0x33c3f9[_0x578afa(0x1b7)](0x6)+'\x20USDT\x20(-'+_0x27d3df[_0x578afa(0x1b7)](0x6)+')'),console['log'](_0x578afa(0x19e)+_0x248c1f[_0x578afa(0x134)]['toFixed'](0x6)+'\x20->\x20'+_0x3de119[_0x578afa(0x1b7)](0x6)+'\x20USDT\x20(+'+_0x27d3df['toFixed'](0x6)+')'),{'payout':_0x283f2f,'shop':_0x248c1f};});return console[_0x351b6f(0x215)]('✅\x20Payout\x20created:\x20'+_0x5f2a66[_0x351b6f(0x15c)]['id']+_0x351b6f(0x18c)+_0x5f2a66[_0x351b6f(0x1ec)][_0x351b6f(0x130)]+'\x20('+_0x27d3df+_0x351b6f(0x152)),{'id':_0x5f2a66[_0x351b6f(0x15c)]['id'],'shopId':_0x5f2a66[_0x351b6f(0x15c)][_0x351b6f(0x204)],'shopName':_0x5f2a66[_0x351b6f(0x1ec)][_0x351b6f(0x244)],'shopUsername':_0x5f2a66[_0x351b6f(0x1ec)][_0x351b6f(0x130)],'amount':_0x5f2a66[_0x351b6f(0x15c)]['amount'],'network':_0x5f2a66[_0x351b6f(0x15c)][_0x351b6f(0x1c9)],'status':_0x5f2a66[_0x351b6f(0x15c)][_0x351b6f(0x16e)],'txid':_0x5f2a66[_0x351b6f(0x15c)][_0x351b6f(0x158)],'notes':_0x5f2a66[_0x351b6f(0x15c)]['notes'],'periodFrom':_0x5f2a66[_0x351b6f(0x15c)][_0x351b6f(0x236)],'periodTo':_0x5f2a66['payout'][_0x351b6f(0x21d)],'createdAt':_0x5f2a66['payout'][_0x351b6f(0x221)],'paidAt':_0x5f2a66[_0x351b6f(0x15c)]['paidAt']};}async[a36_0x259f83(0x1d2)](_0x1f2e2b){const _0x536521=a36_0x259f83,{page:_0x23cb8b,limit:_0x53bcc7,shopId:_0x423c3a,network:_0xea6f08,dateFrom:_0x3f1abb,dateTo:_0x10f6d0,search:_0x519aa2}=_0x1f2e2b,_0x36fa14=(_0x23cb8b-0x1)*_0x53bcc7,_0x2b2101={};_0x423c3a&&(_0x2b2101[_0x536521(0x204)]=_0x423c3a);_0xea6f08&&(_0x2b2101[_0x536521(0x1c9)]=_0xea6f08);(_0x3f1abb||_0x10f6d0)&&(_0x2b2101[_0x536521(0x221)]={},_0x3f1abb&&(_0x2b2101['createdAt'][_0x536521(0x218)]=new Date(_0x3f1abb)),_0x10f6d0&&(_0x2b2101[_0x536521(0x221)]['lte']=new Date(_0x10f6d0)));_0x519aa2&&(_0x2b2101['OR']=[{'shop':{'name':{'contains':_0x519aa2,'mode':_0x536521(0x13d)}}},{'shop':{'username':{'contains':_0x519aa2,'mode':_0x536521(0x13d)}}},{'notes':{'contains':_0x519aa2,'mode':'insensitive'}}]);const [_0x31435d,_0x45c391]=await Promise[_0x536521(0x1a5)]([database_1[_0x536521(0x172)][_0x536521(0x15c)][_0x536521(0x164)]({'where':_0x2b2101,'skip':_0x36fa14,'take':_0x53bcc7,'orderBy':{'createdAt':'desc'},'select':{'id':!![],'shopId':!![],'amount':!![],'network':!![],'status':!![],'txid':!![],'notes':!![],'periodFrom':!![],'periodTo':!![],'createdAt':!![],'paidAt':!![],'shop':{'select':{'name':!![],'username':!![]}}}}),database_1['default'][_0x536521(0x15c)][_0x536521(0x190)]({'where':_0x2b2101})]);return{'payouts':_0x31435d['map'](_0x26ef57=>({'id':_0x26ef57['id'],'shopId':_0x26ef57[_0x536521(0x204)],'shopName':_0x26ef57[_0x536521(0x1ec)][_0x536521(0x244)],'shopUsername':_0x26ef57[_0x536521(0x1ec)]['username'],'amount':_0x26ef57[_0x536521(0x144)],'network':_0x26ef57[_0x536521(0x1c9)],'status':_0x26ef57[_0x536521(0x16e)],'txid':_0x26ef57[_0x536521(0x158)],'notes':_0x26ef57[_0x536521(0x148)],'periodFrom':_0x26ef57[_0x536521(0x236)],'periodTo':_0x26ef57['periodTo'],'createdAt':_0x26ef57[_0x536521(0x221)],'paidAt':_0x26ef57[_0x536521(0x1ea)]})),'pagination':{'page':_0x23cb8b,'limit':_0x53bcc7,'total':_0x45c391,'totalPages':Math['ceil'](_0x45c391/_0x53bcc7)}};}async[a36_0x259f83(0x18b)](_0x11b889){const _0x14e9bc=a36_0x259f83,_0x46baf1=await database_1[_0x14e9bc(0x172)][_0x14e9bc(0x15c)][_0x14e9bc(0x20f)]({'where':{'id':_0x11b889},'include':{'shop':{'select':{'name':!![],'username':!![]}}}});if(!_0x46baf1)return null;return{'id':_0x46baf1['id'],'shopId':_0x46baf1[_0x14e9bc(0x204)],'shopName':_0x46baf1[_0x14e9bc(0x1ec)][_0x14e9bc(0x244)],'shopUsername':_0x46baf1[_0x14e9bc(0x1ec)][_0x14e9bc(0x130)],'amount':_0x46baf1['amount'],'network':_0x46baf1['network'],'status':_0x46baf1[_0x14e9bc(0x16e)],'txid':_0x46baf1[_0x14e9bc(0x158)],'notes':_0x46baf1[_0x14e9bc(0x148)],'periodFrom':_0x46baf1[_0x14e9bc(0x236)],'periodTo':_0x46baf1[_0x14e9bc(0x21d)],'createdAt':_0x46baf1[_0x14e9bc(0x221)],'paidAt':_0x46baf1[_0x14e9bc(0x1ea)]};}async['deletePayout'](_0xc5113d){const _0x20d660=a36_0x259f83;await database_1[_0x20d660(0x172)][_0x20d660(0x15c)][_0x20d660(0x16c)]({'where':{'id':_0xc5113d}});}async['getAllPayments'](_0x134edc){const _0x1b5fc2=a36_0x259f83,{page:_0x163080,limit:_0x1ba139,status:_0x556e65,gateway:_0x389e7c,shopId:_0x2428f7,dateFrom:_0x7e0688,dateTo:_0xc2ad17,search:_0x21e9da,currency:_0x41133c,sortBy:_0x1471de,sortOrder:_0x3ae852}=_0x134edc,_0x4956d1=(_0x163080-0x1)*_0x1ba139;console[_0x1b5fc2(0x215)](_0x1b5fc2(0x14e),_0x134edc);const _0x100d28=await database_1[_0x1b5fc2(0x172)][_0x1b5fc2(0x250)]['groupBy']({'by':[_0x1b5fc2(0x1d1)],'_count':{'gateway':!![]}});console['log'](_0x1b5fc2(0x14a),_0x100d28['map'](_0xd0dfcd=>_0xd0dfcd[_0x1b5fc2(0x1d1)]+'\x20('+_0xd0dfcd[_0x1b5fc2(0x17e)][_0x1b5fc2(0x1d1)]+_0x1b5fc2(0x248)));if(_0x389e7c){const _0x2ca33d=_0x100d28[_0x1b5fc2(0x1ee)](_0x2a976c=>_0x2a976c[_0x1b5fc2(0x1d1)][_0x1b5fc2(0x136)]()===_0x389e7c[_0x1b5fc2(0x136)]());!_0x2ca33d&&_0x389e7c[_0x1b5fc2(0x136)]()!==_0x1b5fc2(0x16b)&&console[_0x1b5fc2(0x215)]('⚠️\x20Requested\x20gateway\x20\x27'+_0x389e7c+'\x27\x20not\x20found.\x20Available\x20gateways:\x20'+_0x100d28[_0x1b5fc2(0x1a0)](_0x3a5ad4=>_0x3a5ad4[_0x1b5fc2(0x1d1)])['join'](',\x20'));}const _0x4bf1db={};_0x556e65&&(_0x4bf1db[_0x1b5fc2(0x16e)]=_0x556e65[_0x1b5fc2(0x1d5)]());if(!_0x389e7c)_0x4bf1db[_0x1b5fc2(0x1d1)]={'not':_0x1b5fc2(0x16b)};else{if(_0x389e7c&&(_0x389e7c[_0x1b5fc2(0x136)]()===_0x1b5fc2(0x16b)||_0x389e7c===_0x1b5fc2(0x1c6)))_0x4bf1db['gateway']=_0x1b5fc2(0x16b);else{let _0x128dd4=_0x389e7c;const _0x12611b=(0x0,gateway_1[_0x1b5fc2(0x146)])(_0x389e7c);if(_0x12611b)_0x128dd4=_0x12611b,console[_0x1b5fc2(0x215)](_0x1b5fc2(0x1f1)+_0x389e7c+_0x1b5fc2(0x23c)+_0x128dd4+'\x27');else{const _0x402b9b=(0x0,gateway_1[_0x1b5fc2(0x205)])(_0x389e7c);if(_0x402b9b){const _0x1a5071=(0x0,gateway_1[_0x1b5fc2(0x146)])(_0x402b9b);_0x1a5071&&(_0x128dd4=_0x1a5071,console[_0x1b5fc2(0x215)](_0x1b5fc2(0x1bf)+_0x389e7c+_0x1b5fc2(0x1aa)+_0x402b9b+_0x1b5fc2(0x20b)+_0x128dd4+'\x27'));}else console['log'](_0x1b5fc2(0x137)+_0x389e7c+'\x27\x20as\x20is\x20(not\x20found\x20in\x20mappings)');}const _0x2dae3e=await database_1[_0x1b5fc2(0x172)][_0x1b5fc2(0x250)][_0x1b5fc2(0x190)]({'where':{'gateway':_0x128dd4[_0x1b5fc2(0x136)]()},'take':0x1});_0x2dae3e===0x0?(console[_0x1b5fc2(0x215)]('⚠️\x20Gateway\x20\x27'+_0x128dd4+'\x27\x20(from\x20\x27'+_0x389e7c+_0x1b5fc2(0x12f)),_0x4bf1db[_0x1b5fc2(0x1d1)]=_0x1b5fc2(0x14b)):(_0x4bf1db[_0x1b5fc2(0x1d1)]=_0x128dd4['toLowerCase'](),console[_0x1b5fc2(0x215)]('✅\x20Using\x20gateway\x20filter:\x20\x27'+_0x128dd4+_0x1b5fc2(0x132)+_0x389e7c+'\x27)'));}}console['log']('📊\x20Gateway\x20filter\x20applied:',_0x4bf1db['gateway']);_0x2428f7&&(_0x4bf1db['shopId']=_0x2428f7);_0x41133c&&(_0x4bf1db[_0x1b5fc2(0x125)]=_0x41133c['toUpperCase'](),console[_0x1b5fc2(0x215)](_0x1b5fc2(0x1dc)+_0x41133c[_0x1b5fc2(0x1d5)]()));(_0x7e0688||_0xc2ad17)&&(_0x4bf1db[_0x1b5fc2(0x221)]={},_0x7e0688&&(_0x4bf1db[_0x1b5fc2(0x221)][_0x1b5fc2(0x218)]=new Date(_0x7e0688)),_0xc2ad17&&(_0x4bf1db['createdAt']['lte']=new Date(_0xc2ad17)));_0x21e9da&&(_0x4bf1db['OR']=[{'id':{'contains':_0x21e9da,'mode':_0x1b5fc2(0x13d)}},{'orderId':{'contains':_0x21e9da,'mode':_0x1b5fc2(0x13d)}},{'gatewayOrderId':{'contains':_0x21e9da,'mode':'insensitive'}},{'customerEmail':{'contains':_0x21e9da,'mode':_0x1b5fc2(0x13d)}},{'shop':{'name':{'contains':_0x21e9da,'mode':_0x1b5fc2(0x13d)}}},{'shop':{'username':{'contains':_0x21e9da,'mode':'insensitive'}}}]);console[_0x1b5fc2(0x215)]('📊\x20Final\x20WHERE\x20conditions:',JSON[_0x1b5fc2(0x175)](_0x4bf1db,null,0x2));let _0x4bb352={'createdAt':_0x1b5fc2(0x179)};if(_0x1471de){const _0x400205=['amount','createdAt',_0x1b5fc2(0x208),_0x1b5fc2(0x16e),_0x1b5fc2(0x1d1),_0x1b5fc2(0x125)],_0x303628=['asc',_0x1b5fc2(0x179)];if(_0x400205[_0x1b5fc2(0x15f)](_0x1471de)){const _0x123080=_0x303628[_0x1b5fc2(0x15f)](_0x3ae852)?_0x3ae852:_0x1b5fc2(0x179);_0x4bb352={[_0x1471de]:_0x123080},console[_0x1b5fc2(0x215)](_0x1b5fc2(0x19c)+_0x1471de+_0x1b5fc2(0x13c)+_0x123080+'\x20order');}}const [_0x4a7d6c,_0x50c57b]=await Promise[_0x1b5fc2(0x1a5)]([database_1['default']['payment'][_0x1b5fc2(0x164)]({'where':_0x4bf1db,'skip':_0x4956d1,'take':_0x1ba139,'orderBy':_0x4bb352,'select':{'id':!![],'shopId':!![],'amount':!![],'amountAfterGatewayCommissionUSDT':!![],'currency':!![],'sourceCurrency':!![],'status':!![],'gateway':!![],'orderId':!![],'gatewayOrderId':!![],'gatewayPaymentId':!![],'customerEmail':!![],'customerName':!![],'customerCountry':!![],'customerIp':!![],'customerUa':!![],'externalPaymentUrl':!![],'successUrl':!![],'failUrl':!![],'pendingUrl':!![],'whiteUrl':!![],'expiresAt':!![],'invoiceTotalSum':!![],'qrCode':!![],'qrUrl':!![],'country':!![],'language':!![],'amountIsEditable':!![],'maxPayments':!![],'rapydCustomer':!![],'cardLast4':!![],'paymentMethod':!![],'bankId':!![],'remitterIban':!![],'remitterName':!![],'failureMessage':!![],'usage':!![],'createdAt':!![],'updatedAt':!![],'shop':{'select':{'name':!![],'username':!![]}}}}),database_1['default']['payment'][_0x1b5fc2(0x190)]({'where':_0x4bf1db})]);return{'payments':_0x4a7d6c,'pagination':{'page':_0x163080,'limit':_0x1ba139,'total':_0x50c57b,'totalPages':Math[_0x1b5fc2(0x235)](_0x50c57b/_0x1ba139)}};}async['getPaymentById'](_0x4f0313){const _0x36d997=a36_0x259f83,_0x4db77c=await database_1[_0x36d997(0x172)][_0x36d997(0x250)][_0x36d997(0x20f)]({'where':{'id':_0x4f0313},'select':{'id':!![],'shopId':!![],'amount':!![],'amountAfterGatewayCommissionUSDT':!![],'currency':!![],'sourceCurrency':!![],'status':!![],'gateway':!![],'orderId':!![],'gatewayOrderId':!![],'gatewayPaymentId':!![],'customerEmail':!![],'customerName':!![],'customerCountry':!![],'customerIp':!![],'customerUa':!![],'externalPaymentUrl':!![],'successUrl':!![],'failUrl':!![],'pendingUrl':!![],'whiteUrl':!![],'expiresAt':!![],'invoiceTotalSum':!![],'qrCode':!![],'qrUrl':!![],'country':!![],'language':!![],'amountIsEditable':!![],'maxPayments':!![],'rapydCustomer':!![],'cardLast4':!![],'paymentMethod':!![],'bankId':!![],'remitterIban':!![],'remitterName':!![],'failureMessage':!![],'usage':!![],'createdAt':!![],'updatedAt':!![],'shop':{'select':{'name':!![],'username':!![]}}}});if(!_0x4db77c)return null;return{'id':_0x4db77c['id'],'shopId':_0x4db77c['shopId'],'gateway':_0x4db77c['gateway'],'amount':_0x4db77c[_0x36d997(0x144)],'currency':_0x4db77c['currency'],'status':_0x4db77c[_0x36d997(0x16e)],'orderId':_0x4db77c['orderId'],'gatewayOrderId':_0x4db77c[_0x36d997(0x1bb)],'customerEmail':_0x4db77c[_0x36d997(0x17a)],'customerName':_0x4db77c[_0x36d997(0x11f)],'customerCountry':_0x4db77c[_0x36d997(0x1fd)],'customerIp':_0x4db77c[_0x36d997(0x194)],'customerUa':_0x4db77c['customerUa'],'failureMessage':_0x4db77c['failureMessage'],'externalPaymentUrl':_0x4db77c[_0x36d997(0x1a6)],'successUrl':_0x4db77c[_0x36d997(0x21e)],'failUrl':_0x4db77c[_0x36d997(0x247)],'pendingUrl':_0x4db77c['pendingUrl'],'whiteUrl':_0x4db77c['whiteUrl'],'createdAt':_0x4db77c['createdAt'],'updatedAt':_0x4db77c['updatedAt'],'shop':_0x4db77c['shop']};}async[a36_0x259f83(0x229)](_0x4db65c,_0x508760,_0x3b13ff,_0x301390){const _0x5bae1f=a36_0x259f83,_0x137b51=await database_1[_0x5bae1f(0x172)][_0x5bae1f(0x163)](async _0xae5034=>{const _0x402017=_0x5bae1f,_0x2f72d0=await _0xae5034['payment'][_0x402017(0x20f)]({'where':{'id':_0x4db65c},'include':{'shop':{'select':{'id':!![],'name':!![],'username':!![],'balance':!![]}}}});if(!_0x2f72d0)throw new Error(_0x402017(0x1b5));const _0x3fff8d=_0x2f72d0[_0x402017(0x16e)],_0x52e86d=_0x508760['toUpperCase']();console[_0x402017(0x215)]('🔄\x20Admin\x20updating\x20payment\x20'+_0x4db65c+_0x402017(0x187)+_0x3fff8d+'\x20->\x20'+_0x52e86d),console[_0x402017(0x215)](_0x402017(0x14f)+_0x2f72d0[_0x402017(0x1ec)][_0x402017(0x126)]+_0x402017(0x138));const _0x51ca38={'status':_0x52e86d,'updatedAt':new Date(),'statusChangedBy':_0x402017(0x23a),'statusChangedAt':new Date()};_0x3b13ff&&(_0x51ca38[_0x402017(0x12b)]=_0x3b13ff);_0x52e86d==='CHARGEBACK'&&_0x301390&&(_0x51ca38[_0x402017(0x1c2)]=_0x301390);let _0x3ff73a=0x0,_0x345e27=_0x2f72d0['shop'][_0x402017(0x126)];if(_0x52e86d===_0x402017(0x20c)&&_0x3fff8d!==_0x402017(0x20c)){_0x51ca38[_0x402017(0x1ea)]=new Date();const _0x5bcfdd=await currencyService_1[_0x402017(0x223)][_0x402017(0x11d)](_0x2f72d0[_0x402017(0x144)],_0x2f72d0[_0x402017(0x125)]);_0x51ca38[_0x402017(0x227)]=_0x5bcfdd;let _0xf7feed=0xa;const _0x23d0a0=await _0xae5034[_0x402017(0x1ec)][_0x402017(0x20f)]({'where':{'id':_0x2f72d0[_0x402017(0x204)]},'select':{'gatewaySettings':!![]}});if(_0x23d0a0?.[_0x402017(0x12c)])try{const _0x242011=JSON[_0x402017(0x1fa)](_0x23d0a0[_0x402017(0x12c)]);for(const [_0x4bff9f,_0x1999fb]of Object[_0x402017(0x238)](_0x242011)){if(_0x4bff9f['toLowerCase']()===_0x2f72d0['gateway'][_0x402017(0x136)]()){_0xf7feed=_0x1999fb[_0x402017(0x209)]||0xa;break;}}}catch(_0x397bfd){console[_0x402017(0x1e3)]('Error\x20parsing\x20gateway\x20settings\x20for\x20payment\x20'+_0x4db65c+':',_0x397bfd);}let _0x440ead;_0x2f72d0[_0x402017(0x15a)]!==null&&_0x2f72d0[_0x402017(0x15a)]!==undefined?(_0x440ead=_0x2f72d0[_0x402017(0x15a)],console[_0x402017(0x215)](_0x402017(0x202)+_0x440ead[_0x402017(0x1b7)](0x6)+'\x20USDT\x20for\x20payment\x20'+_0x4db65c)):(_0x440ead=_0x5bcfdd*(0x1-_0xf7feed/0x64),console[_0x402017(0x215)](_0x402017(0x220)+_0x4db65c+':\x20'+_0xf7feed+_0x402017(0x150)+_0x5bcfdd[_0x402017(0x1b7)](0x6)+_0x402017(0x138)),_0x51ca38['amountAfterGatewayCommissionUSDT']=_0x440ead),_0x3ff73a=_0x440ead,_0x345e27+=_0x440ead,console[_0x402017(0x215)](_0x402017(0x1e7)+_0x4db65c+_0x402017(0x183)),console['log'](_0x402017(0x1ac)+_0x5bcfdd['toFixed'](0x6)+_0x402017(0x138)),console[_0x402017(0x215)](_0x402017(0x193)+_0x2f72d0[_0x402017(0x1d1)]+_0x402017(0x210)+_0xf7feed+'%'),console[_0x402017(0x215)](_0x402017(0x16f)+_0x440ead[_0x402017(0x1b7)](0x6)+_0x402017(0x1ca)+_0xf7feed+_0x402017(0x1f0)),console['log'](_0x402017(0x13f)+_0x440ead[_0x402017(0x1b7)](0x6)+'\x20USDT');}else{if(_0x3fff8d===_0x402017(0x20c)&&_0x52e86d!==_0x402017(0x20c)){if(_0x2f72d0[_0x402017(0x227)]){let _0x4ed521=0xa;const _0x453eb0=await _0xae5034[_0x402017(0x1ec)]['findUnique']({'where':{'id':_0x2f72d0['shopId']},'select':{'gatewaySettings':!![]}});if(_0x453eb0?.['gatewaySettings'])try{const _0x55b8a4=JSON[_0x402017(0x1fa)](_0x453eb0[_0x402017(0x12c)]);for(const [_0x141f99,_0x568542]of Object[_0x402017(0x238)](_0x55b8a4)){if(_0x141f99['toLowerCase']()===_0x2f72d0[_0x402017(0x1d1)]['toLowerCase']()){_0x4ed521=_0x568542[_0x402017(0x209)]||0xa;break;}}}catch(_0xd13dde){console[_0x402017(0x1e3)](_0x402017(0x226)+_0x4db65c+':',_0xd13dde);}const _0x259e78=_0x2f72d0[_0x402017(0x227)]*(0x1-_0x4ed521/0x64);_0x3ff73a=-_0x259e78,_0x345e27-=_0x259e78,_0x51ca38[_0x402017(0x227)]=null,_0x51ca38[_0x402017(0x15a)]=null,console[_0x402017(0x215)](_0x402017(0x1e7)+_0x4db65c+'\x20no\x20longer\x20PAID:'),console['log']('\x20\x20\x20Full\x20amount:\x20'+_0x2f72d0[_0x402017(0x227)][_0x402017(0x1b7)](0x6)+'\x20USDT'),console[_0x402017(0x215)](_0x402017(0x193)+_0x2f72d0[_0x402017(0x1d1)]+_0x402017(0x210)+_0x4ed521+'%'),console[_0x402017(0x215)](_0x402017(0x186)+_0x259e78['toFixed'](0x6)+_0x402017(0x1ca)+_0x4ed521+_0x402017(0x1f0)),console['log'](_0x402017(0x180)+_0x259e78[_0x402017(0x1b7)](0x6)+_0x402017(0x138));}}}_0x52e86d===_0x402017(0x200)&&(_0x3fff8d===_0x402017(0x20c)&&_0x2f72d0[_0x402017(0x227)]&&console['log'](_0x402017(0x1f7)),_0x301390&&_0x301390>0x0&&(_0x3ff73a-=_0x301390,_0x345e27-=_0x301390,console['log'](_0x402017(0x256)+_0x301390[_0x402017(0x1b7)](0x6)+_0x402017(0x15b))));_0x52e86d===_0x402017(0x243)&&_0x3fff8d===_0x402017(0x20c)&&console[_0x402017(0x215)](_0x402017(0x199));const _0x12663d=await _0xae5034[_0x402017(0x250)][_0x402017(0x21c)]({'where':{'id':_0x4db65c},'data':_0x51ca38,'include':{'shop':{'select':{'name':!![],'username':!![]}}}});return _0x3ff73a!==0x0&&(await _0xae5034[_0x402017(0x1ec)][_0x402017(0x21c)]({'where':{'id':_0x2f72d0[_0x402017(0x204)]},'data':{'balance':_0x345e27}}),console['log'](_0x402017(0x254)+_0x2f72d0[_0x402017(0x204)]+_0x402017(0x213)+_0x2f72d0['shop']['balance'][_0x402017(0x1b7)](0x6)+'\x20->\x20'+_0x345e27[_0x402017(0x1b7)](0x6)+_0x402017(0x1c4)+(_0x3ff73a>0x0?'+':'')+_0x3ff73a['toFixed'](0x6)+')')),_0x12663d;});return{'id':_0x137b51['id'],'shopId':_0x137b51[_0x5bae1f(0x204)],'gateway':_0x137b51[_0x5bae1f(0x1d1)],'amount':_0x137b51[_0x5bae1f(0x144)],'currency':_0x137b51[_0x5bae1f(0x125)],'status':_0x137b51[_0x5bae1f(0x16e)],'orderId':_0x137b51[_0x5bae1f(0x22a)],'gatewayOrderId':_0x137b51[_0x5bae1f(0x1bb)],'customerEmail':_0x137b51[_0x5bae1f(0x17a)],'customerName':_0x137b51[_0x5bae1f(0x11f)],'customerCountry':_0x137b51[_0x5bae1f(0x1fd)],'customerIp':_0x137b51[_0x5bae1f(0x194)],'customerUa':_0x137b51[_0x5bae1f(0x197)],'failureMessage':_0x137b51['failureMessage'],'adminNotes':_0x137b51['adminNotes'],'chargebackAmount':_0x137b51[_0x5bae1f(0x1c2)],'statusChangedBy':_0x137b51[_0x5bae1f(0x12d)],'statusChangedAt':_0x137b51[_0x5bae1f(0x11e)],'createdAt':_0x137b51[_0x5bae1f(0x221)],'updatedAt':_0x137b51[_0x5bae1f(0x208)],'shop':_0x137b51[_0x5bae1f(0x1ec)]};}async[a36_0x259f83(0x1d4)](_0x129576,_0x16527b){const _0x529370=a36_0x259f83,_0x327ddc=Math[_0x529370(0x181)]()['toString'](0x24)['substr'](0x2,0x9);console[_0x529370(0x215)]('🎯\x20updateUser\x20called\x20with\x20ID:\x20'+_0x327ddc+_0x529370(0x1c7)+_0x129576);const _0x511054={..._0x16527b};_0x16527b['password']&&_0x16527b['password'][_0x529370(0x176)]()!==''?(console[_0x529370(0x215)](_0x529370(0x1ff)+_0x327ddc+_0x529370(0x24d)+_0x129576),_0x511054[_0x529370(0x258)]=await bcryptjs_1[_0x529370(0x172)]['hash'](_0x16527b['password'],0xc)):(console[_0x529370(0x215)]('🔐\x20['+_0x327ddc+_0x529370(0x169)),delete _0x511054[_0x529370(0x258)]);_0x16527b[_0x529370(0x131)]&&(_0x511054['name']=_0x16527b[_0x529370(0x131)],delete _0x511054[_0x529370(0x131)]);_0x16527b[_0x529370(0x232)]&&(_0x511054['telegram']=_0x16527b[_0x529370(0x232)],delete _0x511054[_0x529370(0x232)]);_0x16527b['merchantUrl']&&(_0x511054[_0x529370(0x184)]=_0x16527b[_0x529370(0x165)],delete _0x511054[_0x529370(0x165)]);if(_0x16527b[_0x529370(0x1eb)]){const _0x21ada4=_0x16527b['gateways'][_0x529370(0x1a0)](_0x85989b=>this['getGatewayInternalName'](_0x85989b));console[_0x529370(0x215)](_0x529370(0x228),_0x16527b[_0x529370(0x1eb)],'->',_0x21ada4),_0x511054['paymentGateways']=JSON[_0x529370(0x175)](_0x21ada4),delete _0x511054['gateways'];}_0x16527b[_0x529370(0x12c)]&&(console[_0x529370(0x215)](_0x529370(0x246)+_0x327ddc+_0x529370(0x18f),_0x16527b[_0x529370(0x12c)]),_0x511054[_0x529370(0x12c)]=JSON['stringify'](_0x16527b['gatewaySettings']),console['log'](_0x529370(0x246)+_0x327ddc+']\x20Gateway\x20settings\x20JSON\x20string:',_0x511054[_0x529370(0x12c)]));_0x16527b['wallets']&&(_0x16527b['wallets'][_0x529370(0x14d)]!==undefined&&(_0x511054[_0x529370(0x14d)]=_0x16527b[_0x529370(0x1ab)][_0x529370(0x14d)]||null),_0x16527b['wallets'][_0x529370(0x1f8)]!==undefined&&(_0x511054[_0x529370(0x1f8)]=_0x16527b[_0x529370(0x1ab)][_0x529370(0x1f8)]||null),_0x16527b[_0x529370(0x1ab)]['usdtErcWallet']!==undefined&&(_0x511054[_0x529370(0x13b)]=_0x16527b[_0x529370(0x1ab)][_0x529370(0x13b)]||null),_0x16527b[_0x529370(0x1ab)][_0x529370(0x17b)]!==undefined&&(_0x511054[_0x529370(0x17b)]=_0x16527b['wallets'][_0x529370(0x17b)]||null),delete _0x511054[_0x529370(0x1ab)]);const _0x3793fa=await database_1[_0x529370(0x172)][_0x529370(0x1ec)][_0x529370(0x21c)]({'where':{'id':_0x129576},'data':_0x511054,'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});return console[_0x529370(0x215)](_0x529370(0x203)+_0x327ddc+_0x529370(0x157),_0x3793fa[_0x529370(0x12c)]),{'id':_0x3793fa['id'],'fullName':_0x3793fa[_0x529370(0x244)],'username':_0x3793fa[_0x529370(0x130)],'telegramId':_0x3793fa[_0x529370(0x189)],'merchantUrl':_0x3793fa[_0x529370(0x184)],'gateways':_0x3793fa[_0x529370(0x23f)]?JSON['parse'](_0x3793fa[_0x529370(0x23f)]):null,'gatewaySettings':_0x3793fa[_0x529370(0x12c)]?JSON[_0x529370(0x1fa)](_0x3793fa[_0x529370(0x12c)]):null,'publicKey':_0x3793fa[_0x529370(0x135)],'wallets':{'usdtPolygonWallet':_0x3793fa[_0x529370(0x14d)],'usdtTrcWallet':_0x3793fa[_0x529370(0x1f8)],'usdtErcWallet':_0x3793fa[_0x529370(0x13b)],'usdcPolygonWallet':_0x3793fa[_0x529370(0x17b)]},'status':_0x3793fa[_0x529370(0x16e)],'createdAt':_0x3793fa[_0x529370(0x221)]};}async[a36_0x259f83(0x177)](_0x46706d){const _0x3a71f0=a36_0x259f83,_0x3a18aa=await database_1[_0x3a71f0(0x172)]['shop'][_0x3a71f0(0x21c)]({'where':{'id':_0x46706d},'data':{'status':_0x3a71f0(0x16d)},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});return{'id':_0x3a18aa['id'],'fullName':_0x3a18aa[_0x3a71f0(0x244)],'username':_0x3a18aa[_0x3a71f0(0x130)],'telegramId':_0x3a18aa[_0x3a71f0(0x189)],'merchantUrl':_0x3a18aa[_0x3a71f0(0x184)],'gateways':_0x3a18aa[_0x3a71f0(0x23f)]?JSON[_0x3a71f0(0x1fa)](_0x3a18aa[_0x3a71f0(0x23f)]):null,'gatewaySettings':_0x3a18aa[_0x3a71f0(0x12c)]?JSON[_0x3a71f0(0x1fa)](_0x3a18aa[_0x3a71f0(0x12c)]):null,'publicKey':_0x3a18aa['publicKey'],'wallets':{'usdtPolygonWallet':_0x3a18aa[_0x3a71f0(0x14d)],'usdtTrcWallet':_0x3a18aa[_0x3a71f0(0x1f8)],'usdtErcWallet':_0x3a18aa['usdtErcWallet'],'usdcPolygonWallet':_0x3a18aa['usdcPolygonWallet']},'status':_0x3a18aa[_0x3a71f0(0x16e)],'createdAt':_0x3a18aa[_0x3a71f0(0x221)]};}async[a36_0x259f83(0x257)](_0x4226e7){const _0x13f132=a36_0x259f83,_0x2e410d=await database_1[_0x13f132(0x172)]['shop'][_0x13f132(0x21c)]({'where':{'id':_0x4226e7},'data':{'status':_0x13f132(0x154)},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});return{'id':_0x2e410d['id'],'fullName':_0x2e410d['name'],'username':_0x2e410d[_0x13f132(0x130)],'telegramId':_0x2e410d[_0x13f132(0x189)],'merchantUrl':_0x2e410d[_0x13f132(0x184)],'gateways':_0x2e410d[_0x13f132(0x23f)]?JSON['parse'](_0x2e410d[_0x13f132(0x23f)]):null,'gatewaySettings':_0x2e410d[_0x13f132(0x12c)]?JSON[_0x13f132(0x1fa)](_0x2e410d[_0x13f132(0x12c)]):null,'publicKey':_0x2e410d[_0x13f132(0x135)],'wallets':{'usdtPolygonWallet':_0x2e410d[_0x13f132(0x14d)],'usdtTrcWallet':_0x2e410d[_0x13f132(0x1f8)],'usdtErcWallet':_0x2e410d[_0x13f132(0x13b)],'usdcPolygonWallet':_0x2e410d[_0x13f132(0x17b)]},'status':_0x2e410d['status'],'createdAt':_0x2e410d[_0x13f132(0x221)]};}async[a36_0x259f83(0x1be)](_0x390ac9){const _0x478274=a36_0x259f83,{page:_0xe4476d,limit:_0x322e52,status:_0x5063ef}=_0x390ac9,_0x56de18=(_0xe4476d-0x1)*_0x322e52,_0x3264a6={};_0x5063ef&&(_0x3264a6[_0x478274(0x16e)]=_0x5063ef['toUpperCase']());const [_0xa245a,_0x3d72ba]=await Promise['all']([database_1['default'][_0x478274(0x1ec)][_0x478274(0x164)]({'where':_0x3264a6,'skip':_0x56de18,'take':_0x322e52,'orderBy':{'createdAt':_0x478274(0x179)},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}}),database_1['default']['shop'][_0x478274(0x190)]({'where':_0x3264a6})]);return{'users':_0xa245a[_0x478274(0x1a0)](_0x5d765c=>{const _0x3b7606=_0x478274,_0x1cabd6=_0x5d765c[_0x3b7606(0x23f)]?JSON[_0x3b7606(0x1fa)](_0x5d765c[_0x3b7606(0x23f)]):null,_0x1a2a57=_0x1cabd6?_0x1cabd6[_0x3b7606(0x1a0)](_0x2a58de=>this[_0x3b7606(0x133)](_0x2a58de)):null;return{'id':_0x5d765c['id'],'fullName':_0x5d765c[_0x3b7606(0x244)],'username':_0x5d765c[_0x3b7606(0x130)],'telegramId':_0x5d765c[_0x3b7606(0x189)],'merchantUrl':_0x5d765c[_0x3b7606(0x184)],'gateways':_0x1a2a57,'gatewaySettings':_0x5d765c[_0x3b7606(0x12c)]?JSON[_0x3b7606(0x1fa)](_0x5d765c[_0x3b7606(0x12c)]):null,'publicKey':_0x5d765c[_0x3b7606(0x135)],'wallets':{'usdtPolygonWallet':_0x5d765c['usdtPolygonWallet'],'usdtTrcWallet':_0x5d765c[_0x3b7606(0x1f8)],'usdtErcWallet':_0x5d765c['usdtErcWallet'],'usdcPolygonWallet':_0x5d765c[_0x3b7606(0x17b)]},'status':_0x5d765c[_0x3b7606(0x16e)],'createdAt':_0x5d765c[_0x3b7606(0x221)]};}),'pagination':{'page':_0xe4476d,'limit':_0x322e52,'total':_0x3d72ba,'totalPages':Math['ceil'](_0x3d72ba/_0x322e52)}};}async[a36_0x259f83(0x153)](_0x400943){const _0x2a2139=a36_0x259f83,_0x2462fb=await database_1[_0x2a2139(0x172)]['shop']['findUnique']({'where':{'id':_0x400943},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});if(!_0x2462fb)return null;const _0x5780b7=_0x2462fb[_0x2a2139(0x23f)]?JSON[_0x2a2139(0x1fa)](_0x2462fb['paymentGateways']):null,_0xf67419=_0x5780b7?_0x5780b7[_0x2a2139(0x1a0)](_0xd3653a=>this[_0x2a2139(0x133)](_0xd3653a)):null;return _0x5780b7&&_0xf67419&&console['log'](_0x2a2139(0x1b9),_0x5780b7,'->',_0xf67419),{'id':_0x2462fb['id'],'fullName':_0x2462fb['name'],'username':_0x2462fb[_0x2a2139(0x130)],'telegramId':_0x2462fb[_0x2a2139(0x189)],'merchantUrl':_0x2462fb[_0x2a2139(0x184)],'gateways':_0xf67419,'gatewaySettings':_0x2462fb[_0x2a2139(0x12c)]?JSON[_0x2a2139(0x1fa)](_0x2462fb[_0x2a2139(0x12c)]):null,'publicKey':_0x2462fb[_0x2a2139(0x135)],'wallets':{'usdtPolygonWallet':_0x2462fb[_0x2a2139(0x14d)],'usdtTrcWallet':_0x2462fb[_0x2a2139(0x1f8)],'usdtErcWallet':_0x2462fb['usdtErcWallet'],'usdcPolygonWallet':_0x2462fb[_0x2a2139(0x17b)]},'status':_0x2462fb[_0x2a2139(0x16e)],'createdAt':_0x2462fb['createdAt']};}async[a36_0x259f83(0x17d)](_0x55be14){const _0x2aaed9=a36_0x259f83,{fullName:_0xfeb292,username:_0x3690c5,password:_0x4b72e8,telegramId:_0x3d41b5,merchantUrl:_0x6e4a92,gateways:_0xecedfb,gatewaySettings:_0x163d1b,wallets:_0x224eed}=_0x55be14,_0x3b18e1=await database_1[_0x2aaed9(0x172)]['shop'][_0x2aaed9(0x20f)]({'where':{'username':_0x3690c5}});if(_0x3b18e1)throw new Error('Username\x20already\x20exists');if(_0x3d41b5){const _0x11b010=await database_1['default']['shop'][_0x2aaed9(0x20f)]({'where':{'telegram':_0x3d41b5}});if(_0x11b010)throw new Error('Telegram\x20username\x20already\x20exists');}const _0x16cd3c=await bcryptjs_1[_0x2aaed9(0x172)][_0x2aaed9(0x23e)](_0x4b72e8,0xc),_0x53c7c5=_0x2aaed9(0x22e)+crypto_1[_0x2aaed9(0x172)][_0x2aaed9(0x1ad)](0x20)['toString'](_0x2aaed9(0x1b0)),_0xd2343d=_0x2aaed9(0x1b2)+crypto_1[_0x2aaed9(0x172)]['randomBytes'](0x20)[_0x2aaed9(0x24e)]('hex'),_0x1bd53e=_0xecedfb?_0xecedfb[_0x2aaed9(0x1a0)](_0x22c0a7=>this[_0x2aaed9(0x17f)](_0x22c0a7)):null;_0xecedfb&&_0x1bd53e&&console[_0x2aaed9(0x215)](_0x2aaed9(0x23d),_0xecedfb,'->',_0x1bd53e);const _0x496862=await database_1[_0x2aaed9(0x172)][_0x2aaed9(0x1ec)][_0x2aaed9(0x1d0)]({'data':{'name':_0xfeb292,'username':_0x3690c5,'password':_0x16cd3c,'telegram':_0x3d41b5,'shopUrl':_0x6e4a92,'paymentGateways':_0x1bd53e?JSON['stringify'](_0x1bd53e):null,'gatewaySettings':_0x163d1b?JSON['stringify'](_0x163d1b):null,'usdtPolygonWallet':_0x224eed?.[_0x2aaed9(0x14d)]||null,'usdtTrcWallet':_0x224eed?.[_0x2aaed9(0x1f8)]||null,'usdtErcWallet':_0x224eed?.[_0x2aaed9(0x13b)]||null,'usdcPolygonWallet':_0x224eed?.[_0x2aaed9(0x17b)]||null,'publicKey':_0x53c7c5,'secretKey':_0xd2343d,'status':'ACTIVE'},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});return{'id':_0x496862['id'],'fullName':_0x496862[_0x2aaed9(0x244)],'username':_0x496862[_0x2aaed9(0x130)],'telegramId':_0x496862['telegram'],'merchantUrl':_0x496862[_0x2aaed9(0x184)],'gateways':_0x496862[_0x2aaed9(0x23f)]?JSON[_0x2aaed9(0x1fa)](_0x496862[_0x2aaed9(0x23f)]):null,'gatewaySettings':_0x496862[_0x2aaed9(0x12c)]?JSON[_0x2aaed9(0x1fa)](_0x496862['gatewaySettings']):null,'publicKey':_0x496862[_0x2aaed9(0x135)],'wallets':{'usdtPolygonWallet':_0x496862[_0x2aaed9(0x14d)],'usdtTrcWallet':_0x496862[_0x2aaed9(0x1f8)],'usdtErcWallet':_0x496862[_0x2aaed9(0x13b)],'usdcPolygonWallet':_0x496862[_0x2aaed9(0x17b)]},'status':_0x496862[_0x2aaed9(0x16e)],'createdAt':_0x496862[_0x2aaed9(0x221)]};}async[a36_0x259f83(0x1f4)](_0x28bbcb){const _0x3be729=a36_0x259f83;await database_1[_0x3be729(0x172)][_0x3be729(0x1ec)][_0x3be729(0x16c)]({'where':{'id':_0x28bbcb}});}['generateDailyStatistics'](_0x19768f,_0x14a25e,_0x438796){const _0x3e7472=a36_0x259f83,_0x16dea6=new Map(),_0x546218=new Date(_0x14a25e);while(_0x546218<=_0x438796){const _0x221438=_0x546218[_0x3e7472(0x14c)]()[_0x3e7472(0x251)]('T')[0x0];_0x16dea6[_0x3e7472(0x1e4)](_0x221438,{'revenue':0x0,'count':0x0}),_0x546218[_0x3e7472(0x211)](_0x546218[_0x3e7472(0x1c8)]()+0x1);}for(const _0x573028 of _0x19768f){const _0x19747c=_0x573028[_0x3e7472(0x221)][_0x3e7472(0x14c)]()[_0x3e7472(0x251)]('T')[0x0],_0x12ecd2=_0x16dea6['get'](_0x19747c);_0x12ecd2&&(_0x12ecd2[_0x3e7472(0x190)]+=0x1,_0x573028['status']===_0x3e7472(0x20c)&&(_0x573028[_0x3e7472(0x227)]?_0x12ecd2[_0x3e7472(0x241)]+=_0x573028[_0x3e7472(0x227)]:console['log'](_0x3e7472(0x1fb)+_0x573028['id']+_0x3e7472(0x219))));}const _0x2b05c5=[],_0x2d4ad8=[];for(const [_0x3fc681,_0x1debe8]of _0x16dea6){_0x2b05c5[_0x3e7472(0x234)]({'date':_0x3fc681,'amount':Math['round'](_0x1debe8[_0x3e7472(0x241)]*0x64)/0x64}),_0x2d4ad8[_0x3e7472(0x234)]({'date':_0x3fc681,'count':_0x1debe8['count']});}return{'dailyRevenue':_0x2b05c5,'dailyPayments':_0x2d4ad8};}}exports[a36_0x259f83(0x1c1)]=AdminService;