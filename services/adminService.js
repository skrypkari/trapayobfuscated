'use strict';function a36_0x15ba(){const _0x9e1d36=['🔄\x20REFUND:\x20Payment\x20amount\x20already\x20deducted\x20from\x20balance','plisio','publicKey','\x20\x20\x20✅\x20Total\x20available\x20for\x20payout:\x20','asc','convertToUSDT','usdtTrcWallet','polygon_usdc','bcryptjs','1017945pDLTLB',',\x20Commission:\x20','\x20\x20\x20📅\x20This\x20month:\x20','\x20\x20\x20🏪\x20Gateway\x20earnings:\x20','stringify','random','thisMonth','deleteUser','revenue','\x20\x20\x20Gateway:\x20','\x20\x20\x20⏳\x20Pending\x20payout:\x20','getGatewayInternalName','🔧\x20[','📊\x20Merchants\x20awaiting\x20payout:\x20','paymentGateways','\x20to\x20','✅\x20Using\x20gateway\x20filter:\x20\x27','📊\x20Available\x20gateways\x20in\x20database:','30d','trc20','20CMBEuS','periodFrom','💰\x20Found\x20','\x20->\x20','whiteUrl','ceil','crypto','\x20USDT\x20from\x20balance','week','\x20\x20\x20Added\x20to\x20balance:\x20+','merchantEarnings','commissionUSDT','🔐\x20[','\x20\x20\x20Balance:\x20','erc20','getTime','\x20PAID\x20payments','PENDING','commission','\x20\x20\x20🔍\x20Raw\x20balance\x20sum:\x20','pendingUrl','\x20\x20\x20�📊\x20Total\x20payments:\x20','not\x20specified','parse','length','gateways','\x20for\x20shop\x20','\x20\x20\x20Transaction\x20hash:\x20','⚠️\x20Payment\x20','periodTo','failureMessage','admin','cointopay','gatewayOrderId','reduce','test_gateway','\x20\x20\x20💵\x20Available\x20balance:\x20','shop','gatewaySettings','customerName','wallets','💰\x20[PAYOUT]\x20Merchant\x20','\x20USDT,\x20Requested:\x20','\x20USDT\x20(','turnoverUSDT','updatedAt','📊\x20Payout\x20statistics\x20calculated:','amountUSDT','sort','toUpperCase','adminNotes','💱\x20Currency\x20filter\x20applied:\x20','\x20payments)','302556HAGqsK','noda','Open\x20Banking\x202','log','includes','SUSPENDED','amountAfterCommissionUSDT','\x27\x20as\x20is\x20(not\x20found\x20in\x20mappings)','KLYME\x20EU','externalPaymentUrl','all','\x20balance\x20updated:','updateUser','chargebackAmount','936144FnRTyB','🔄\x20Updating\x20customer\x20data\x20for\x20payment\x20','🎯\x20[','\x20order','totalPayments','telegramId','\x20\x20\x20💳\x20Total\x20payments:\x20','../types/gateway','7hnoLLS','📊\x20Getting\x20merchants\x20awaiting\x20payout\x20with\x20filters:','count','orderId','paymentsCount','ACTIVE','\x20paid\x20payments\x20for\x20analysis','username','🔄\x20Admin\x20updating\x20payment\x20','📊\x20Getting\x20merchant\x20statistics\x20with\x20filters:','\x20no\x20longer\x20PAID:','status','summary','✅\x20Payout\x20created:\x20','usdtErcWallet','insensitive','usdcPolygonWallet','dailyPayments','rapyd','\x27\x20->\x20ID\x20\x27','\x20USDT\x20(total\x20paid\x20to\x20merchants)','default','failUrl','__esModule','paidOutUSDT','totalPaidOut','toLowerCase','getAllPayments','../config/database','join','\x20USDT\x20(same\x20as\x20awaiting)','availableBalance','🔄\x20Converted\x20gateway\x20name\x20\x27','shopId','customerCountry','push','klyme_gb','\x20\x20\x20👤\x20Merchant\x20earnings:\x20','./currencyService','getDate','\x20merchants\x20with\x20positive\x20balance','deletePayout','\x20\x20\x20🌍\x20Country:\x20','📊\x20Getting\x20payments\x20with\x20filters:','Error\x20parsing\x20gateway\x20settings\x20for\x20shop\x20','date','\x20USDT)','COMPLETED','\x20\x20\x20Current\x20balance:\x20','getMerchantsSelection','getAllUsers','📊\x20Gateway\x20filter\x20applied:','customerUa','\x20USDT\x20(after\x20','_count','payout','\x20\x20\x20Payout\x20amount:\x20','📊\x20Sorting\x20payments\x20by\x20','Username\x20already\x20exists','47786yatNUm','\x20\x20\x20Current\x20total\x20paid\x20out:\x20','some','averageCheckUSDT','Error\x20processing\x20payment\x20','payment','findUnique','hex','\x20USDT\x20(gross\x20revenue)','📊\x20Merchant\x20statistics\x20calculated:','Noda','getPayoutStats','💰\x20Current\x20shop\x20balance:\x20','PAID','gte','\x20\x20\x20Merchant\x20loses:\x20','getAllPayouts','paidAt','%\x20commission)',',\x20successful:\x20','cointopay2','\x20\x20\x20📊\x20Commission\x20difference:\x20','month','desc','\x20\x20\x20🔍\x20Calculated\x20after\x20commission:\x20','dateFrom',']\x20Gateway\x20settings\x20before\x20saving:','Error\x20parsing\x20gateway\x20settings\x20for\x20payment\x20','getPayoutById','error','usdtPolygonWallet','🔍\x20Using\x20gateway\x20\x27','🔄\x20Gateway\x20mapping\x20(get):','getFullYear','📊\x20Calculating\x20commission\x20manually\x20for\x20payment\x20','password','map','getMerchantsAwaitingPayout','createUser','AdminService','txid','\x20USDT\x20(theoretical\x20net)','\x27\x20(from\x20\x27','2020-01-01','totalAmountUSDT','gateway','totalCommissionRate','createdAt','lte','dailyRevenue','groupBy','\x20in\x20','create','\x20USDT','🎯\x20updateUser\x20called\x20with\x20ID:\x20','merchantUrl','aggregate','round','792iaatgV','729875rdJTuh','\x20merchants','randomBytes','getGatewayNameById','telegram',']\x20Gateway\x20settings\x20JSON\x20string:','not\x20set','_sum','network','shopUrl','\x20USDT\x20(actual\x20balances)','amountAfterGatewayCommissionUSDT','balance','entries','\x20\x20\x20💰\x20Total\x20payout:\x20','⚠️\x20Requested\x20gateway\x20\x27','💸\x20CHARGEBACK\x20penalty:\x20-','split','$transaction','💰\x20[PAYOUT]\x20Gateway\x20','\x27)\x20not\x20found\x20in\x20database,\x20returning\x20empty\x20result','hash','amount','\x20USDT\x20for\x20payment\x20','currency','\x20\x20\x20💸\x20Total\x20payouts\x20(all\x20time):\x20','setDate','toISOString','successUrl','📊\x20Final\x20WHERE\x20conditions:','gatewayEarnings','Insufficient\x20balance.\x20Available:\x20','fullName','get','custom','REFUND','update','totalPayout','\x20\x20\x20⏳\x20Awaiting\x20payout:\x20','7296512lObVxs','💰\x20Shop\x20','\x20\x20\x20📅\x20Total\x20payouts\x20(this\x20month):\x20','dateTo',']\x20User\x20updated,\x20gatewaySettings\x20from\x20DB:','customerIp','📊\x20[ADMIN]\x20Calculating\x20commission\x20manually\x20for\x20payment\x20','findFirst','currencyService','\x20\x20\x20Subtracted\x20from\x20balance:\x20-','forEach','\x20\x20\x20Merchant\x20gets:\x20','\x20USDT\x20(-','30mQIXmp','🔄\x20Converted\x20gateway\x20ID\x20\x27','averageCommissionRate','💳\x20Payout\x20wallet\x20for\x20','pk_','Plisio','period','\x27\x20->\x20name\x20\x27','\x20\x20\x20💰\x20Total\x20payments\x20turnover:\x20','generateDailyStatistics','customerEmail','getMonth','pendingPayout','turnover',':\x20commission\x20=\x20','getGatewayDisplayName','values','name','totalAmountAfterCommissionUSDT','toFixed','notes','✅\x20Customer\x20data\x20updated\x20for\x20payment\x20','substr','updateCustomerData','10bVxGvV','trim','findMany','\x20\x20\x20✅\x20Actual\x20available\x20balance:\x20','1513692icuRln','📋\x20Found\x20','year',',\x20userId:\x20','set','toString','createPayout','KLYME\x20DE','merchantEarningsUSDT','getMerchantStatistics'];a36_0x15ba=function(){return _0x9e1d36;};return a36_0x15ba();}const a36_0x2aa225=a36_0x234d;(function(_0x272524,_0x485c6f){const _0x49653e=a36_0x234d,_0x40670b=_0x272524();while(!![]){try{const _0x3db5a6=parseInt(_0x49653e(0x252))/0x1*(parseInt(_0x49653e(0x1a0))/0x2)+parseInt(_0x49653e(0x22b))/0x3+-parseInt(_0x49653e(0x295))/0x4+-parseInt(_0x49653e(0x1db))/0x5*(-parseInt(_0x49653e(0x20f))/0x6)+-parseInt(_0x49653e(0x29d))/0x7*(-parseInt(_0x49653e(0x202))/0x8)+-parseInt(_0x49653e(0x23e))/0x9*(parseInt(_0x49653e(0x227))/0xa)+parseInt(_0x49653e(0x1da))/0xb*(-parseInt(_0x49653e(0x287))/0xc);if(_0x3db5a6===_0x485c6f)break;else _0x40670b['push'](_0x40670b['shift']());}catch(_0x5576c0){_0x40670b['push'](_0x40670b['shift']());}}}(a36_0x15ba,0x70c3e));var __importDefault=this&&this['__importDefault']||function(_0xcf30f2){const _0x5bd8a3=a36_0x234d;return _0xcf30f2&&_0xcf30f2[_0x5bd8a3(0x2b4)]?_0xcf30f2:{'default':_0xcf30f2};};Object['defineProperty'](exports,a36_0x2aa225(0x2b4),{'value':!![]}),exports[a36_0x2aa225(0x1c7)]=void 0x0;const database_1=__importDefault(require(a36_0x2aa225(0x181))),bcryptjs_1=__importDefault(require(a36_0x2aa225(0x23d))),crypto_1=__importDefault(require(a36_0x2aa225(0x258))),currencyService_1=require(a36_0x2aa225(0x18b)),gateway_1=require(a36_0x2aa225(0x29c));class AdminService{async[a36_0x2aa225(0x1ab)](){const _0x4d7239=a36_0x2aa225;console['log']('📊\x20Calculating\x20payout\x20statistics...');const _0x3658a0=await database_1[_0x4d7239(0x2b2)][_0x4d7239(0x277)]['aggregate']({'_sum':{'balance':!![],'totalPaidOut':!![]},'where':{'status':_0x4d7239(0x2a2)}}),_0x240698=await this[_0x4d7239(0x1c5)]({'page':0x1,'limit':0x3e8}),_0x1e6e1c=await database_1[_0x4d7239(0x2b2)][_0x4d7239(0x1a5)]['count']({'where':{'status':_0x4d7239(0x1ad),'gateway':{'not':_0x4d7239(0x275)}}}),_0x3d0f70=new Date(),_0x5d3f70=new Date(_0x3d0f70['getFullYear'](),_0x3d0f70[_0x4d7239(0x21a)](),0x1),_0x4b8228=new Date(_0x3d0f70[_0x4d7239(0x1c1)](),_0x3d0f70[_0x4d7239(0x21a)]()+0x1,0x0,0x17,0x3b,0x3b,0x3e7),_0x23a492=await database_1['default'][_0x4d7239(0x19c)][_0x4d7239(0x1d8)]({'_sum':{'amount':!![]},'where':{'createdAt':{'gte':_0x5d3f70,'lte':_0x4b8228},'status':'COMPLETED'}}),_0x912452=_0x3658a0[_0x4d7239(0x1e2)][_0x4d7239(0x17e)]||0x0,_0x1421d0=_0x240698[_0x4d7239(0x2a9)][_0x4d7239(0x221)],_0x49cabf=_0x23a492[_0x4d7239(0x1e2)]['amount']||0x0,_0x31a787={'totalPayout':Math[_0x4d7239(0x1d9)](_0x912452*0x64)/0x64,'awaitingPayout':Math['round'](_0x1421d0*0x64)/0x64,'thisMonth':Math[_0x4d7239(0x1d9)](_0x49cabf*0x64)/0x64,'availableBalance':Math[_0x4d7239(0x1d9)](_0x1421d0*0x64)/0x64,'totalPayments':_0x1e6e1c};return console[_0x4d7239(0x28a)](_0x4d7239(0x280)),console[_0x4d7239(0x28a)](_0x4d7239(0x1e9)+_0x31a787[_0x4d7239(0x200)]+_0x4d7239(0x2b1)),console[_0x4d7239(0x28a)](_0x4d7239(0x201)+_0x31a787['awaitingPayout']+'\x20USDT\x20(with\x20commission\x20deducted)'),console[_0x4d7239(0x28a)](_0x4d7239(0x276)+_0x31a787[_0x4d7239(0x184)]+_0x4d7239(0x183)),console['log'](_0x4d7239(0x240)+_0x31a787[_0x4d7239(0x244)]+_0x4d7239(0x1d5)),console[_0x4d7239(0x28a)](_0x4d7239(0x29b)+_0x31a787[_0x4d7239(0x299)]+_0x4d7239(0x262)),console[_0x4d7239(0x28a)](_0x4d7239(0x265)+(_0x3658a0[_0x4d7239(0x1e2)]['balance']||0x0)['toFixed'](0x2)+'\x20USDT\x20(without\x20commission)'),console[_0x4d7239(0x28a)](_0x4d7239(0x1b5)+((_0x3658a0[_0x4d7239(0x1e2)][_0x4d7239(0x1e7)]||0x0)-_0x1421d0)[_0x4d7239(0x222)](0x2)+'\x20USDT'),_0x31a787;}async[a36_0x2aa225(0x226)](_0x3ee60e,_0x5c64f1){const _0x47d287=a36_0x2aa225;console['log'](_0x47d287(0x296)+_0x3ee60e+':',_0x5c64f1);const _0x356f99=await database_1['default'][_0x47d287(0x1a5)][_0x47d287(0x1a6)]({'where':{'id':_0x3ee60e},'select':{'id':!![],'customerEmail':!![],'customerName':!![],'customerCountry':!![],'customerIp':!![],'customerUa':!![]}});if(!_0x356f99)throw new Error('Payment\x20not\x20found');const _0x324869={};_0x5c64f1[_0x47d287(0x187)]!==undefined&&(_0x324869[_0x47d287(0x187)]=_0x5c64f1[_0x47d287(0x187)]||null);_0x5c64f1[_0x47d287(0x207)]!==undefined&&(_0x324869[_0x47d287(0x207)]=_0x5c64f1[_0x47d287(0x207)]||null);_0x5c64f1[_0x47d287(0x199)]!==undefined&&(_0x324869[_0x47d287(0x199)]=_0x5c64f1['customerUa']||null);const _0x1bb9dc=await database_1['default'][_0x47d287(0x1a5)][_0x47d287(0x1ff)]({'where':{'id':_0x3ee60e},'data':{..._0x324869,'updatedAt':new Date()},'select':{'id':!![],'customerEmail':!![],'customerName':!![],'customerCountry':!![],'customerIp':!![],'customerUa':!![],'updatedAt':!![]}});return console[_0x47d287(0x28a)](_0x47d287(0x224)+_0x3ee60e),console[_0x47d287(0x28a)](_0x47d287(0x18f)+_0x356f99[_0x47d287(0x187)]+_0x47d287(0x255)+_0x1bb9dc[_0x47d287(0x187)]),console[_0x47d287(0x28a)]('\x20\x20\x20🌐\x20IP:\x20'+_0x356f99[_0x47d287(0x207)]+_0x47d287(0x255)+_0x1bb9dc[_0x47d287(0x207)]),console['log']('\x20\x20\x20🖥️\x20User\x20Agent:\x20'+(_0x356f99[_0x47d287(0x199)]?_0x47d287(0x22f):_0x47d287(0x1e1))+'\x20->\x20'+(_0x1bb9dc['customerUa']?_0x47d287(0x22f):_0x47d287(0x1e1))),_0x1bb9dc;}async['getSystemStatistics'](_0x5ae687){const _0x4bd789=a36_0x2aa225,_0x1d2aae=new Date();let _0x565608;switch(_0x5ae687){case'7d':_0x565608=new Date(_0x1d2aae['getTime']()-0x7*0x18*0x3c*0x3c*0x3e8);break;case _0x4bd789(0x250):_0x565608=new Date(_0x1d2aae['getTime']()-0x1e*0x18*0x3c*0x3c*0x3e8);break;case'90d':_0x565608=new Date(_0x1d2aae[_0x4bd789(0x261)]()-0x5a*0x18*0x3c*0x3c*0x3e8);break;case'all':const _0x21c101=await database_1[_0x4bd789(0x2b2)][_0x4bd789(0x1a5)]['findFirst']({'where':{'gateway':{'not':'test_gateway'}},'orderBy':{'createdAt':_0x4bd789(0x239)},'select':{'createdAt':!![]}});_0x565608=_0x21c101?_0x21c101[_0x4bd789(0x1cf)]:new Date(_0x4bd789(0x1cb)),console[_0x4bd789(0x28a)]('📅\x20Period\x20\x27all\x27:\x20Using\x20start\x20date\x20from\x20first\x20payment:\x20'+_0x565608['toISOString']());break;default:_0x565608=new Date(_0x1d2aae['getTime']()-0x1e*0x18*0x3c*0x3c*0x3e8);}const [_0x768d11,_0x163651,_0xb0ed09,_0x22bf76,_0x57a1de,_0x4b6b6f]=await Promise[_0x4bd789(0x291)]([database_1['default'][_0x4bd789(0x277)][_0x4bd789(0x29f)](),database_1['default'][_0x4bd789(0x277)]['count']({'where':{'status':_0x4bd789(0x2a2)}}),database_1[_0x4bd789(0x2b2)][_0x4bd789(0x1a5)][_0x4bd789(0x29f)]({'where':{'status':_0x4bd789(0x1ad),'createdAt':{'gte':_0x565608},'gateway':{'not':_0x4bd789(0x275)}}}),database_1['default']['payment'][_0x4bd789(0x229)]({'where':{'status':_0x4bd789(0x1ad),'createdAt':{'gte':_0x565608},'gateway':{'not':_0x4bd789(0x275)}},'select':{'amount':!![],'currency':!![],'amountAfterGatewayCommissionUSDT':!![]}}),database_1[_0x4bd789(0x2b2)][_0x4bd789(0x1a5)][_0x4bd789(0x229)]({'where':{'gateway':{'not':_0x4bd789(0x275)}},'take':0xa,'orderBy':{'createdAt':_0x4bd789(0x1b7)},'include':{'shop':{'select':{'name':!![],'username':!![]}}}}),database_1[_0x4bd789(0x2b2)][_0x4bd789(0x1a5)]['findMany']({'where':{'createdAt':{'gte':_0x565608},'gateway':{'not':'test_gateway'}},'select':{'amount':!![],'currency':!![],'status':!![],'amountUSDT':!![],'createdAt':!![]}})]);let _0xfbe722=0x0,_0x25154e=0x0;for(const _0x32892a of _0x22bf76){const _0x162057=await currencyService_1['currencyService'][_0x4bd789(0x23a)](_0x32892a[_0x4bd789(0x1f1)],_0x32892a[_0x4bd789(0x1f3)]);_0xfbe722+=_0x162057;if(_0x32892a['amountAfterGatewayCommissionUSDT']){const _0x20f11a=await currencyService_1[_0x4bd789(0x20a)][_0x4bd789(0x23a)](_0x32892a[_0x4bd789(0x1f1)],_0x32892a['currency']),_0x46ffff=_0x32892a[_0x4bd789(0x1e6)],_0x3e55b7=_0x20f11a-_0x46ffff;_0x25154e+=_0x3e55b7;}}const _0x50e338=_0xb0ed09>0x0?_0xfbe722/_0xb0ed09:0x0,_0x6334d0=this[_0x4bd789(0x218)](_0x4b6b6f,_0x565608,_0x1d2aae),_0x522507=await database_1[_0x4bd789(0x2b2)][_0x4bd789(0x1a5)][_0x4bd789(0x29f)]({'where':{'createdAt':{'gte':_0x565608},'gateway':{'not':_0x4bd789(0x275)}}}),_0x529c2b=_0x522507>0x0?_0xb0ed09/_0x522507*0x64:0x0;return{'totalShops':_0x768d11,'activeShops':_0x163651,'totalPayments':_0xb0ed09,'successfulPayments':_0xb0ed09,'totalAttempts':_0x522507,'totalRevenue':Math[_0x4bd789(0x1d9)](_0xfbe722*0x64)/0x64,'trapayEarnings':Math[_0x4bd789(0x1d9)](_0x25154e*0x64)/0x64,'averagePaymentAmount':Math[_0x4bd789(0x1d9)](_0x50e338*0x64)/0x64,'conversionRate':Math[_0x4bd789(0x1d9)](_0x529c2b*0x64)/0x64,'dailyRevenue':_0x6334d0[_0x4bd789(0x1d1)],'dailyPayments':_0x6334d0[_0x4bd789(0x2ae)],'recentPayments':_0x57a1de[_0x4bd789(0x1c4)](_0x19346a=>({'id':_0x19346a['id'],'amount':_0x19346a[_0x4bd789(0x1f1)],'currency':_0x19346a[_0x4bd789(0x1f3)],'status':_0x19346a['status'],'gateway':_0x19346a[_0x4bd789(0x1cd)],'shop':_0x19346a['shop'],'createdAt':_0x19346a[_0x4bd789(0x1cf)]}))};}async[a36_0x2aa225(0x234)](_0x2995c6){const _0x4b0632=a36_0x2aa225;console['log'](_0x4b0632(0x2a6),_0x2995c6);let _0x23e7a5,_0x373db0=new Date();if(_0x2995c6[_0x4b0632(0x215)]===_0x4b0632(0x1fd)&&_0x2995c6[_0x4b0632(0x1b9)]&&_0x2995c6[_0x4b0632(0x205)])_0x23e7a5=new Date(_0x2995c6[_0x4b0632(0x1b9)]),_0x373db0=new Date(_0x2995c6[_0x4b0632(0x205)]);else{const _0xfdacff=new Date();switch(_0x2995c6['period']){case _0x4b0632(0x25a):_0x23e7a5=new Date(_0xfdacff['getTime']()-0x7*0x18*0x3c*0x3c*0x3e8);break;case _0x4b0632(0x1b6):_0x23e7a5=new Date(_0xfdacff[_0x4b0632(0x261)]()-0x1e*0x18*0x3c*0x3c*0x3e8);break;case _0x4b0632(0x22d):_0x23e7a5=new Date(_0xfdacff[_0x4b0632(0x261)]()-0x16d*0x18*0x3c*0x3c*0x3e8);break;case _0x4b0632(0x291):default:_0x23e7a5=new Date(_0x4b0632(0x1cb));break;}}console[_0x4b0632(0x28a)]('📅\x20Period:\x20'+_0x23e7a5[_0x4b0632(0x1f6)]()+_0x4b0632(0x24d)+_0x373db0[_0x4b0632(0x1f6)]());const _0x405773={'status':_0x4b0632(0x1ad),'gateway':{'not':_0x4b0632(0x275)},'paidAt':{'gte':_0x23e7a5,'lte':_0x373db0}};_0x2995c6[_0x4b0632(0x186)]&&(_0x405773[_0x4b0632(0x186)]=_0x2995c6[_0x4b0632(0x186)]);const _0x4581f4=await database_1['default'][_0x4b0632(0x1a5)][_0x4b0632(0x229)]({'where':_0x405773,'include':{'shop':{'select':{'id':!![],'name':!![],'username':!![],'gatewaySettings':!![]}}}});console[_0x4b0632(0x28a)](_0x4b0632(0x254)+_0x4581f4['length']+_0x4b0632(0x2a3));const _0x2ac6ac={'gateway':{'not':'test_gateway'},'createdAt':{'gte':_0x23e7a5,'lte':_0x373db0}};_0x2995c6[_0x4b0632(0x186)]&&(_0x2ac6ac[_0x4b0632(0x186)]=_0x2995c6[_0x4b0632(0x186)]);const _0x23bc24=await database_1[_0x4b0632(0x2b2)][_0x4b0632(0x1a5)][_0x4b0632(0x29f)]({'where':_0x2ac6ac});console[_0x4b0632(0x28a)]('📊\x20Total\x20payments\x20(including\x20failed):\x20'+_0x23bc24+_0x4b0632(0x1b3)+_0x4581f4[_0x4b0632(0x26a)]);let _0xfa82d5=0x0,_0x178b97=0x0,_0x2b6741=0x0;const _0x2890b6={},_0x541847={},_0x507a56={};for(const _0x3c336a of _0x4581f4){try{const _0x2ae385=await currencyService_1[_0x4b0632(0x20a)][_0x4b0632(0x23a)](_0x3c336a['amount'],_0x3c336a['currency']);let _0x136f68={};if(_0x3c336a[_0x4b0632(0x277)][_0x4b0632(0x278)])try{_0x136f68=JSON[_0x4b0632(0x269)](_0x3c336a[_0x4b0632(0x277)]['gatewaySettings']);}catch(_0x50555b){console['error'](_0x4b0632(0x191)+_0x3c336a[_0x4b0632(0x186)]+':',_0x50555b);}let _0x483fa1={},_0x6461fc=0xa;for(const [_0x691d5c,_0x18555b]of Object[_0x4b0632(0x1e8)](_0x136f68)){if(_0x691d5c[_0x4b0632(0x17f)]()===_0x3c336a[_0x4b0632(0x1cd)][_0x4b0632(0x17f)]()){_0x483fa1=_0x18555b,_0x6461fc=_0x18555b[_0x4b0632(0x264)]||0xa;break;}}let _0x37ce21,_0x46c85d;_0x3c336a[_0x4b0632(0x1e6)]!==null&&_0x3c336a[_0x4b0632(0x1e6)]!==undefined?(_0x37ce21=_0x3c336a[_0x4b0632(0x1e6)],_0x46c85d=_0x2ae385-_0x37ce21,console[_0x4b0632(0x28a)]('📊\x20Using\x20saved\x20amountAfterGatewayCommissionUSDT:\x20'+_0x37ce21[_0x4b0632(0x222)](0x6)+_0x4b0632(0x1f2)+_0x3c336a['id'])):(_0x46c85d=_0x2ae385*(_0x6461fc/0x64),_0x37ce21=_0x2ae385-_0x46c85d,console['log'](_0x4b0632(0x1c2)+_0x3c336a['id']+':\x20'+_0x6461fc+'%\x20from\x20'+_0x2ae385[_0x4b0632(0x222)](0x6)+_0x4b0632(0x1d5)));_0xfa82d5+=_0x2ae385,_0x178b97+=_0x37ce21,_0x2b6741+=_0x46c85d;!_0x2890b6[_0x3c336a[_0x4b0632(0x1cd)]]&&(_0x2890b6[_0x3c336a['gateway']]={'gateway':_0x3c336a[_0x4b0632(0x1cd)],'gatewayDisplayName':this[_0x4b0632(0x21e)](_0x3c336a[_0x4b0632(0x1cd)]),'paymentsCount':0x0,'turnoverUSDT':0x0,'commissionUSDT':0x0,'merchantEarningsUSDT':0x0,'totalCommissionRate':0x0});_0x2890b6[_0x3c336a[_0x4b0632(0x1cd)]][_0x4b0632(0x2a1)]++,_0x2890b6[_0x3c336a[_0x4b0632(0x1cd)]][_0x4b0632(0x27e)]+=_0x2ae385,_0x2890b6[_0x3c336a[_0x4b0632(0x1cd)]]['commissionUSDT']+=_0x46c85d,_0x2890b6[_0x3c336a['gateway']][_0x4b0632(0x233)]+=_0x37ce21,_0x2890b6[_0x3c336a[_0x4b0632(0x1cd)]]['totalCommissionRate']+=_0x6461fc;!_0x2995c6['shopId']&&(!_0x541847[_0x3c336a[_0x4b0632(0x186)]]&&(_0x541847[_0x3c336a['shopId']]={'shopId':_0x3c336a[_0x4b0632(0x186)],'shopName':_0x3c336a[_0x4b0632(0x277)][_0x4b0632(0x220)],'shopUsername':_0x3c336a[_0x4b0632(0x277)][_0x4b0632(0x2a4)],'paymentsCount':0x0,'turnoverUSDT':0x0,'commissionUSDT':0x0,'merchantEarningsUSDT':0x0,'paidOutUSDT':0x0,'averageCheckUSDT':0x0}),_0x541847[_0x3c336a[_0x4b0632(0x186)]][_0x4b0632(0x2a1)]++,_0x541847[_0x3c336a['shopId']][_0x4b0632(0x27e)]+=_0x2ae385,_0x541847[_0x3c336a['shopId']]['commissionUSDT']+=_0x46c85d,_0x541847[_0x3c336a[_0x4b0632(0x186)]]['merchantEarningsUSDT']+=_0x37ce21);const _0x2a53ae=_0x3c336a[_0x4b0632(0x1b1)][_0x4b0632(0x1f6)]()[_0x4b0632(0x1ec)]('T')[0x0];!_0x507a56[_0x2a53ae]&&(_0x507a56[_0x2a53ae]={'date':_0x2a53ae,'turnover':0x0,'merchantEarnings':0x0,'gatewayEarnings':0x0,'paymentsCount':0x0}),_0x507a56[_0x2a53ae][_0x4b0632(0x21c)]+=_0x2ae385,_0x507a56[_0x2a53ae][_0x4b0632(0x25c)]+=_0x37ce21,_0x507a56[_0x2a53ae][_0x4b0632(0x1f9)]+=_0x46c85d,_0x507a56[_0x2a53ae][_0x4b0632(0x2a1)]++;}catch(_0x27f878){console[_0x4b0632(0x1bd)](_0x4b0632(0x1a4)+_0x3c336a['id']+':',_0x27f878);}}Object[_0x4b0632(0x21f)](_0x2890b6)['forEach'](_0x45bfbb=>{const _0x19b11e=_0x4b0632;_0x45bfbb[_0x19b11e(0x211)]=_0x45bfbb[_0x19b11e(0x2a1)]>0x0?_0x45bfbb['totalCommissionRate']/_0x45bfbb['paymentsCount']:0x0,delete _0x45bfbb[_0x19b11e(0x1ce)];}),Object[_0x4b0632(0x21f)](_0x541847)[_0x4b0632(0x20c)](_0x4dd8eb=>{const _0x2aa710=_0x4b0632;_0x4dd8eb[_0x2aa710(0x1a3)]=_0x4dd8eb[_0x2aa710(0x2a1)]>0x0?_0x4dd8eb[_0x2aa710(0x27e)]/_0x4dd8eb[_0x2aa710(0x2a1)]:0x0;});let _0x5250a5=0x0,_0x442b37=0x0;if(_0x2995c6[_0x4b0632(0x186)]){const _0x4bf978=await database_1[_0x4b0632(0x2b2)]['payout'][_0x4b0632(0x229)]({'where':{'shopId':_0x2995c6[_0x4b0632(0x186)],'status':_0x4b0632(0x194),'createdAt':{'gte':_0x23e7a5,'lte':_0x373db0}},'select':{'amount':!![]}});_0x5250a5=_0x4bf978['reduce']((_0x1d2a9c,_0x3b65c0)=>_0x1d2a9c+_0x3b65c0['amount'],0x0);const _0x2dcd52=await database_1[_0x4b0632(0x2b2)]['payout'][_0x4b0632(0x229)]({'where':{'shopId':_0x2995c6['shopId'],'status':_0x4b0632(0x263),'createdAt':{'gte':_0x23e7a5,'lte':_0x373db0}},'select':{'amount':!![]}});_0x442b37=_0x2dcd52[_0x4b0632(0x274)]((_0x49586a,_0x47a380)=>_0x49586a+_0x47a380[_0x4b0632(0x1f1)],0x0);}const _0x30502=_0x23bc24,_0xe22975=_0x4581f4[_0x4b0632(0x26a)],_0x492399=_0xe22975>0x0?_0xfa82d5/_0xe22975:0x0,_0x162ccd=_0x30502>0x0?Math[_0x4b0632(0x1d9)](_0xe22975/_0x30502*0x2710)/0x64:0x0,_0x2f36b9=Math['ceil']((_0x373db0[_0x4b0632(0x261)]()-_0x23e7a5[_0x4b0632(0x261)]())/(0x3e8*0x3c*0x3c*0x18)),_0x2b76fa={'totalTurnover':Math['round'](_0xfa82d5*0x64)/0x64,'merchantEarnings':Math[_0x4b0632(0x1d9)](_0x178b97*0x64)/0x64,'gatewayEarnings':Math[_0x4b0632(0x1d9)](_0x2b6741*0x64)/0x64,'totalPaidOut':Math['round'](_0x5250a5*0x64)/0x64,'pendingPayout':Math[_0x4b0632(0x1d9)](_0x442b37*0x64)/0x64,'averageCheck':Math[_0x4b0632(0x1d9)](_0x492399*0x64)/0x64,'totalPayments':_0x30502,'successfulPayments':_0xe22975,'conversionRate':_0x162ccd,'gatewayBreakdown':Object[_0x4b0632(0x21f)](_0x2890b6)[_0x4b0632(0x1c4)](_0x192240=>({..._0x192240,'turnoverUSDT':Math[_0x4b0632(0x1d9)](_0x192240[_0x4b0632(0x27e)]*0x64)/0x64,'commissionUSDT':Math[_0x4b0632(0x1d9)](_0x192240[_0x4b0632(0x25d)]*0x64)/0x64,'merchantEarningsUSDT':Math['round'](_0x192240[_0x4b0632(0x233)]*0x64)/0x64,'averageCommissionRate':Math[_0x4b0632(0x1d9)](_0x192240['averageCommissionRate']*0x64)/0x64})),'merchantBreakdown':_0x2995c6[_0x4b0632(0x186)]?undefined:Object[_0x4b0632(0x21f)](_0x541847)[_0x4b0632(0x1c4)](_0x83bc12=>({..._0x83bc12,'turnoverUSDT':Math[_0x4b0632(0x1d9)](_0x83bc12[_0x4b0632(0x27e)]*0x64)/0x64,'commissionUSDT':Math[_0x4b0632(0x1d9)](_0x83bc12[_0x4b0632(0x25d)]*0x64)/0x64,'merchantEarningsUSDT':Math[_0x4b0632(0x1d9)](_0x83bc12[_0x4b0632(0x233)]*0x64)/0x64,'paidOutUSDT':Math[_0x4b0632(0x1d9)](_0x83bc12[_0x4b0632(0x17d)]*0x64)/0x64,'averageCheckUSDT':Math[_0x4b0632(0x1d9)](_0x83bc12[_0x4b0632(0x1a3)]*0x64)/0x64})),'dailyData':Object[_0x4b0632(0x21f)](_0x507a56)[_0x4b0632(0x1c4)](_0x10c065=>({..._0x10c065,'turnover':Math[_0x4b0632(0x1d9)](_0x10c065[_0x4b0632(0x21c)]*0x64)/0x64,'merchantEarnings':Math[_0x4b0632(0x1d9)](_0x10c065[_0x4b0632(0x25c)]*0x64)/0x64,'gatewayEarnings':Math['round'](_0x10c065['gatewayEarnings']*0x64)/0x64}))[_0x4b0632(0x282)]((_0x31dd9a,_0xdce344)=>_0x31dd9a[_0x4b0632(0x192)]['localeCompare'](_0xdce344['date'])),'periodInfo':{'from':_0x23e7a5,'to':_0x373db0,'periodType':_0x2995c6[_0x4b0632(0x215)]||_0x4b0632(0x1fd),'daysCount':_0x2f36b9}};return console['log'](_0x4b0632(0x1a9)),console['log']('\x20\x20\x20💰\x20Total\x20turnover:\x20'+_0x2b76fa['totalTurnover']+_0x4b0632(0x1d5)),console[_0x4b0632(0x28a)](_0x4b0632(0x18a)+_0x2b76fa[_0x4b0632(0x25c)]+_0x4b0632(0x1d5)),console['log'](_0x4b0632(0x241)+_0x2b76fa[_0x4b0632(0x1f9)]+'\x20USDT'),console['log']('\x20\x20\x20�\x20Total\x20paid\x20out:\x20'+_0x2b76fa[_0x4b0632(0x17e)]+_0x4b0632(0x1d5)),console['log'](_0x4b0632(0x248)+_0x2b76fa[_0x4b0632(0x21b)]+_0x4b0632(0x1d5)),console[_0x4b0632(0x28a)](_0x4b0632(0x267)+_0x2b76fa[_0x4b0632(0x299)]),_0x2b76fa;}async[a36_0x2aa225(0x196)](){const _0x594fe6=a36_0x2aa225;console[_0x594fe6(0x28a)]('📋\x20Getting\x20merchants\x20selection\x20list...');const _0x378f20=await database_1[_0x594fe6(0x2b2)][_0x594fe6(0x277)][_0x594fe6(0x229)]({'where':{'status':_0x594fe6(0x2a2)},'select':{'id':!![],'username':!![],'name':!![]},'orderBy':{'name':'asc'}});return console[_0x594fe6(0x28a)](_0x594fe6(0x22c)+_0x378f20[_0x594fe6(0x26a)]+'\x20active\x20merchants\x20for\x20selection'),_0x378f20['map'](_0x5cc747=>({'id':_0x5cc747['id'],'username':_0x5cc747['username'],'name':_0x5cc747['name']}));}[a36_0x2aa225(0x21e)](_0xc6288a){const _0x1d8154=a36_0x2aa225,_0x14da22={'test_gateway':'Test\x20Gateway','plisio':_0x1d8154(0x214),'rapyd':'Rapyd','noda':_0x1d8154(0x1aa),'cointopay':'CoinToPay','cointopay2':_0x1d8154(0x289),'klyme_eu':_0x1d8154(0x28f),'klyme_gb':'KLYME\x20GB','klyme_de':_0x1d8154(0x232),'mastercard':'MasterCard'};return _0x14da22[_0xc6288a]||_0xc6288a;}[a36_0x2aa225(0x249)](_0xda9268){const _0xdee507=a36_0x2aa225,_0x46402d={'Test\x20Gateway':_0xdee507(0x275),'Plisio':_0xdee507(0x236),'Rapyd':_0xdee507(0x2af),'Noda':_0xdee507(0x288),'CoinToPay':_0xdee507(0x272),'CoinToPay2':_0xdee507(0x1b4),'KLYME\x20EU':'klyme_eu','KLYME\x20GB':_0xdee507(0x189),'KLYME\x20DE':'klyme_de','MasterCard':'mastercard'};return _0x46402d[_0xda9268]||_0xda9268[_0xdee507(0x17f)]();}async[a36_0x2aa225(0x1c5)](_0x2c4d73){const _0x1e4a19=a36_0x2aa225,{page:_0x2fa54d,limit:_0x1f8ff4,minAmount:_0x2655af,search:_0x23ebbd}=_0x2c4d73,_0x2c3f7b=(_0x2fa54d-0x1)*_0x1f8ff4;console[_0x1e4a19(0x28a)](_0x1e4a19(0x29e),_0x2c4d73);const _0x4c7455={'balance':{'gt':0x0},'status':_0x1e4a19(0x2a2)};_0x2655af&&(_0x4c7455[_0x1e4a19(0x1e7)][_0x1e4a19(0x1ae)]=_0x2655af);_0x23ebbd&&(_0x4c7455['OR']=[{'name':{'contains':_0x23ebbd,'mode':_0x1e4a19(0x2ac)}},{'username':{'contains':_0x23ebbd,'mode':_0x1e4a19(0x2ac)}}]);const [_0x160c42,_0x122277]=await Promise[_0x1e4a19(0x291)]([database_1['default'][_0x1e4a19(0x277)][_0x1e4a19(0x229)]({'where':_0x4c7455,'skip':_0x2c3f7b,'take':_0x1f8ff4,'orderBy':{'balance':_0x1e4a19(0x1b7)},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'balance':!![],'totalPaidOut':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'gatewaySettings':!![],'createdAt':!![]}}),database_1[_0x1e4a19(0x2b2)][_0x1e4a19(0x277)]['count']({'where':_0x4c7455})]);console[_0x1e4a19(0x28a)](_0x1e4a19(0x254)+_0x160c42[_0x1e4a19(0x26a)]+_0x1e4a19(0x18d));const _0x419d56=await Promise[_0x1e4a19(0x291)](_0x160c42[_0x1e4a19(0x1c4)](async _0x13c9f5=>{const _0x447a9d=_0x1e4a19,[_0x2e913a,_0x473340,_0x6498a2]=await Promise[_0x447a9d(0x291)]([database_1[_0x447a9d(0x2b2)][_0x447a9d(0x1a5)][_0x447a9d(0x29f)]({'where':{'shopId':_0x13c9f5['id'],'status':_0x447a9d(0x1ad),'gateway':{'not':_0x447a9d(0x275)}}}),database_1[_0x447a9d(0x2b2)]['payment'][_0x447a9d(0x209)]({'where':{'shopId':_0x13c9f5['id'],'status':_0x447a9d(0x1ad),'gateway':{'not':_0x447a9d(0x275)}},'orderBy':{'paidAt':_0x447a9d(0x239)},'select':{'paidAt':!![]}}),database_1[_0x447a9d(0x2b2)]['payment'][_0x447a9d(0x1d2)]({'by':[_0x447a9d(0x1cd)],'where':{'shopId':_0x13c9f5['id'],'status':'PAID','gateway':{'not':_0x447a9d(0x275)}},'_count':{'id':!![]},'_sum':{'amountUSDT':!![]}})]),_0x2583bb=new Date(),_0x3558a9=new Date(_0x2583bb[_0x447a9d(0x1c1)](),_0x2583bb[_0x447a9d(0x21a)](),0x1),_0x34c2fd=new Date(_0x2583bb['getFullYear'](),_0x2583bb[_0x447a9d(0x21a)]()+0x1,0x0,0x17,0x3b,0x3b,0x3e7),[_0x476d10,_0x25e60d]=await Promise['all']([database_1['default']['payout'][_0x447a9d(0x1d8)]({'_sum':{'amount':!![]},'where':{'shopId':_0x13c9f5['id'],'status':'COMPLETED'}}),database_1[_0x447a9d(0x2b2)][_0x447a9d(0x19c)][_0x447a9d(0x1d8)]({'_sum':{'amount':!![]},'where':{'shopId':_0x13c9f5['id'],'status':_0x447a9d(0x194),'createdAt':{'gte':_0x3558a9,'lte':_0x34c2fd}}})]),_0x1b3bf9=_0x476d10[_0x447a9d(0x1e2)][_0x447a9d(0x1f1)]||0x0,_0x33ca3c=_0x25e60d[_0x447a9d(0x1e2)][_0x447a9d(0x1f1)]||0x0,_0x16778d=await Promise[_0x447a9d(0x291)](_0x6498a2['map'](async _0x270ffe=>{const _0x1ebd22=_0x447a9d;let _0x290679=0xa;if(_0x13c9f5[_0x1ebd22(0x278)])try{const _0xde4e77=JSON[_0x1ebd22(0x269)](_0x13c9f5[_0x1ebd22(0x278)]);for(const [_0x1d4a29,_0x595ce8]of Object[_0x1ebd22(0x1e8)](_0xde4e77)){if(_0x1d4a29[_0x1ebd22(0x17f)]()===_0x270ffe['gateway'][_0x1ebd22(0x17f)]()){_0x290679=_0x595ce8[_0x1ebd22(0x264)]||0xa,console[_0x1ebd22(0x28a)](_0x1ebd22(0x1ee)+_0x270ffe[_0x1ebd22(0x1cd)]+'\x20for\x20shop\x20'+_0x13c9f5['id']+_0x1ebd22(0x21d)+_0x290679+'%');break;}}}catch(_0x5ce867){console[_0x1ebd22(0x1bd)](_0x1ebd22(0x191)+_0x13c9f5['id']+':',_0x5ce867);}const _0xb80bbf=_0x270ffe[_0x1ebd22(0x1e2)]?.[_0x1ebd22(0x281)]||0x0,_0x736311=_0xb80bbf*(0x1-_0x290679/0x64);return{'gateway':_0x270ffe[_0x1ebd22(0x1cd)],'count':_0x270ffe['_count']?.['id']||0x0,'amountUSDT':Math[_0x1ebd22(0x1d9)](_0xb80bbf*0x64)/0x64,'amountAfterCommissionUSDT':Math[_0x1ebd22(0x1d9)](_0x736311*0x64)/0x64,'commission':_0x290679};})),_0x437601=_0x16778d[_0x447a9d(0x274)]((_0x20228a,_0x514454)=>_0x20228a+_0x514454[_0x447a9d(0x281)],0x0),_0x1b9450=_0x13c9f5[_0x447a9d(0x1e7)];return console[_0x447a9d(0x28a)](_0x447a9d(0x27b)+_0x13c9f5[_0x447a9d(0x2a4)]+':'),console[_0x447a9d(0x28a)]('\x20\x20\x20�\x20Total\x20payments\x20turnover:\x20'+_0x437601['toFixed'](0x2)+'\x20USDT\x20(gross\x20revenue)'),console['log'](_0x447a9d(0x1b8)+_0x16778d['reduce']((_0x9bd4a0,_0x43664d)=>_0x9bd4a0+_0x43664d[_0x447a9d(0x28d)],0x0)[_0x447a9d(0x222)](0x2)+_0x447a9d(0x1c9)),console[_0x447a9d(0x28a)](_0x447a9d(0x22a)+_0x1b9450[_0x447a9d(0x222)](0x2)+'\x20USDT\x20(after\x20payouts)'),{'id':_0x13c9f5['id'],'fullName':_0x13c9f5[_0x447a9d(0x220)],'username':_0x13c9f5[_0x447a9d(0x2a4)],'telegramId':_0x13c9f5[_0x447a9d(0x1df)],'merchantUrl':_0x13c9f5[_0x447a9d(0x1e4)],'wallets':{'usdtPolygonWallet':_0x13c9f5[_0x447a9d(0x1be)],'usdtTrcWallet':_0x13c9f5['usdtTrcWallet'],'usdtErcWallet':_0x13c9f5[_0x447a9d(0x2ab)],'usdcPolygonWallet':_0x13c9f5[_0x447a9d(0x2ad)]},'totalAmountUSDT':Math['round'](_0x437601*0x64)/0x64,'totalAmountAfterCommissionUSDT':Math[_0x447a9d(0x1d9)](_0x1b9450*0x64)/0x64,'totalPayout':Math[_0x447a9d(0x1d9)](_0x1b3bf9*0x64)/0x64,'thisMonth':Math[_0x447a9d(0x1d9)](_0x33ca3c*0x64)/0x64,'paymentsCount':_0x2e913a,'oldestPaymentDate':_0x473340?.['paidAt']||_0x13c9f5[_0x447a9d(0x1cf)],'gatewayBreakdown':_0x16778d};})),_0xee00b9=_0x419d56['reduce']((_0x57ae8b,_0x4efb4e)=>_0x57ae8b+_0x4efb4e[_0x1e4a19(0x1cc)],0x0),_0x377995=_0x419d56[_0x1e4a19(0x274)]((_0x139859,_0x5e2206)=>_0x139859+_0x5e2206[_0x1e4a19(0x221)],0x0),_0x2f8a4e=_0x419d56[_0x1e4a19(0x274)]((_0x11f5d1,_0x4279ba)=>_0x11f5d1+_0x4279ba[_0x1e4a19(0x200)],0x0),_0x5d2151=_0x419d56[_0x1e4a19(0x274)]((_0x34d3fc,_0x586432)=>_0x34d3fc+_0x586432[_0x1e4a19(0x244)],0x0);return console[_0x1e4a19(0x28a)](_0x1e4a19(0x24b)+_0x122277+_0x1e4a19(0x1dc)),console[_0x1e4a19(0x28a)](_0x1e4a19(0x217)+Math[_0x1e4a19(0x1d9)](_0xee00b9*0x64)/0x64+_0x1e4a19(0x1a8)),console['log'](_0x1e4a19(0x238)+Math[_0x1e4a19(0x1d9)](_0x377995*0x64)/0x64+_0x1e4a19(0x1e5)),console[_0x1e4a19(0x28a)](_0x1e4a19(0x1f4)+Math[_0x1e4a19(0x1d9)](_0x2f8a4e*0x64)/0x64+_0x1e4a19(0x1d5)),console[_0x1e4a19(0x28a)](_0x1e4a19(0x204)+Math[_0x1e4a19(0x1d9)](_0x5d2151*0x64)/0x64+'\x20USDT'),{'merchants':_0x419d56,'pagination':{'page':_0x2fa54d,'limit':_0x1f8ff4,'total':_0x122277,'totalPages':Math[_0x1e4a19(0x257)](_0x122277/_0x1f8ff4)},'summary':{'totalMerchants':_0x122277,'totalAmountUSDT':Math[_0x1e4a19(0x1d9)](_0xee00b9*0x64)/0x64,'totalAmountAfterCommissionUSDT':Math[_0x1e4a19(0x1d9)](_0x377995*0x64)/0x64,'totalPayout':Math['round'](_0x2f8a4e*0x64)/0x64,'thisMonth':Math[_0x1e4a19(0x1d9)](_0x5d2151*0x64)/0x64}};}async[a36_0x2aa225(0x231)](_0x384e0e){const _0x1a002e=a36_0x2aa225,{shopId:_0x6c20cb,amount:_0xeb247b,network:_0x40552d,wallet:_0x33ed98,notes:_0xb58f6d,txid:_0x33eb03,periodFrom:_0x8b4546,periodTo:_0x5d5393}=_0x384e0e,_0x2aa827=await database_1[_0x1a002e(0x2b2)][_0x1a002e(0x1ed)](async _0x5a3e78=>{const _0x4c99a0=_0x1a002e,_0x5ded7c=await _0x5a3e78['shop'][_0x4c99a0(0x1a6)]({'where':{'id':_0x6c20cb},'select':{'id':!![],'name':!![],'username':!![],'balance':!![],'totalPaidOut':!![]}});if(!_0x5ded7c)throw new Error('Shop\x20not\x20found');console['log']('💰\x20Creating\x20payout\x20for\x20shop\x20'+_0x5ded7c['username']+':'),console[_0x4c99a0(0x28a)](_0x4c99a0(0x195)+_0x5ded7c[_0x4c99a0(0x1e7)][_0x4c99a0(0x222)](0x6)+_0x4c99a0(0x1d5)),console[_0x4c99a0(0x28a)](_0x4c99a0(0x19d)+_0xeb247b['toFixed'](0x6)+_0x4c99a0(0x1d5)),console[_0x4c99a0(0x28a)](_0x4c99a0(0x1a1)+_0x5ded7c[_0x4c99a0(0x17e)][_0x4c99a0(0x222)](0x6)+_0x4c99a0(0x1d5));if(_0x33eb03)console['log'](_0x4c99a0(0x26d)+_0x33eb03);if(_0x5ded7c['balance']<_0xeb247b)throw new Error(_0x4c99a0(0x1fa)+_0x5ded7c['balance'][_0x4c99a0(0x222)](0x6)+_0x4c99a0(0x27c)+_0xeb247b[_0x4c99a0(0x222)](0x6)+_0x4c99a0(0x1d5));let _0x4460dd=_0x33ed98;if(!_0x4460dd){const _0x5f0a9c=await _0x5a3e78[_0x4c99a0(0x277)][_0x4c99a0(0x1a6)]({'where':{'id':_0x6c20cb},'select':{'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![]}});if(_0x5f0a9c)switch(_0x40552d){case'polygon':_0x4460dd=_0x5f0a9c[_0x4c99a0(0x1be)]||undefined;break;case _0x4c99a0(0x251):_0x4460dd=_0x5f0a9c[_0x4c99a0(0x23b)]||undefined;break;case _0x4c99a0(0x260):_0x4460dd=_0x5f0a9c[_0x4c99a0(0x2ab)]||undefined;break;case _0x4c99a0(0x23c):_0x4460dd=_0x5f0a9c[_0x4c99a0(0x2ad)]||undefined;break;}}console[_0x4c99a0(0x28a)](_0x4c99a0(0x212)+_0x40552d+':\x20'+(_0x4460dd||_0x4c99a0(0x268)));const _0x5918dc=await _0x5a3e78[_0x4c99a0(0x19c)]['create']({'data':{'shopId':_0x6c20cb,'amount':_0xeb247b,'network':_0x40552d,'status':_0x4c99a0(0x194),'txid':_0x33eb03,'notes':_0xb58f6d,'periodFrom':_0x8b4546?new Date(_0x8b4546):null,'periodTo':_0x5d5393?new Date(_0x5d5393):null,'createdAt':new Date(),'paidAt':new Date()}}),_0x2feb79=_0x5ded7c[_0x4c99a0(0x1e7)]-_0xeb247b,_0x38b72a=_0x5ded7c[_0x4c99a0(0x17e)]+_0xeb247b;return await _0x5a3e78[_0x4c99a0(0x277)]['update']({'where':{'id':_0x6c20cb},'data':{'balance':_0x2feb79,'totalPaidOut':_0x38b72a}}),console['log'](_0x4c99a0(0x203)+_0x5ded7c[_0x4c99a0(0x2a4)]+_0x4c99a0(0x292)),console[_0x4c99a0(0x28a)](_0x4c99a0(0x25f)+_0x5ded7c[_0x4c99a0(0x1e7)][_0x4c99a0(0x222)](0x6)+'\x20->\x20'+_0x2feb79['toFixed'](0x6)+_0x4c99a0(0x20e)+_0xeb247b[_0x4c99a0(0x222)](0x6)+')'),console[_0x4c99a0(0x28a)]('\x20\x20\x20Total\x20paid\x20out:\x20'+_0x5ded7c[_0x4c99a0(0x17e)]['toFixed'](0x6)+_0x4c99a0(0x255)+_0x38b72a[_0x4c99a0(0x222)](0x6)+'\x20USDT\x20(+'+_0xeb247b[_0x4c99a0(0x222)](0x6)+')'),{'payout':_0x5918dc,'shop':_0x5ded7c};});return console[_0x1a002e(0x28a)](_0x1a002e(0x2aa)+_0x2aa827[_0x1a002e(0x19c)]['id']+_0x1a002e(0x26c)+_0x2aa827['shop']['username']+'\x20('+_0xeb247b+_0x1a002e(0x193)),{'id':_0x2aa827[_0x1a002e(0x19c)]['id'],'shopId':_0x2aa827[_0x1a002e(0x19c)][_0x1a002e(0x186)],'shopName':_0x2aa827[_0x1a002e(0x277)][_0x1a002e(0x220)],'shopUsername':_0x2aa827[_0x1a002e(0x277)][_0x1a002e(0x2a4)],'amount':_0x2aa827[_0x1a002e(0x19c)]['amount'],'network':_0x2aa827[_0x1a002e(0x19c)][_0x1a002e(0x1e3)],'status':_0x2aa827[_0x1a002e(0x19c)][_0x1a002e(0x2a8)],'txid':_0x2aa827[_0x1a002e(0x19c)][_0x1a002e(0x1c8)],'notes':_0x2aa827[_0x1a002e(0x19c)]['notes'],'periodFrom':_0x2aa827[_0x1a002e(0x19c)][_0x1a002e(0x253)],'periodTo':_0x2aa827[_0x1a002e(0x19c)]['periodTo'],'createdAt':_0x2aa827[_0x1a002e(0x19c)]['createdAt'],'paidAt':_0x2aa827['payout'][_0x1a002e(0x1b1)]};}async[a36_0x2aa225(0x1b0)](_0x3b3534){const _0x390c4c=a36_0x2aa225,{page:_0x504034,limit:_0xd1015e,shopId:_0x488ee3,network:_0x259dac,dateFrom:_0x169f89,dateTo:_0x10acc3,search:_0x41e321}=_0x3b3534,_0x2d4eb5=(_0x504034-0x1)*_0xd1015e,_0x417a63={};_0x488ee3&&(_0x417a63[_0x390c4c(0x186)]=_0x488ee3);_0x259dac&&(_0x417a63[_0x390c4c(0x1e3)]=_0x259dac);(_0x169f89||_0x10acc3)&&(_0x417a63[_0x390c4c(0x1cf)]={},_0x169f89&&(_0x417a63[_0x390c4c(0x1cf)]['gte']=new Date(_0x169f89)),_0x10acc3&&(_0x417a63[_0x390c4c(0x1cf)][_0x390c4c(0x1d0)]=new Date(_0x10acc3)));_0x41e321&&(_0x417a63['OR']=[{'shop':{'name':{'contains':_0x41e321,'mode':_0x390c4c(0x2ac)}}},{'shop':{'username':{'contains':_0x41e321,'mode':'insensitive'}}},{'notes':{'contains':_0x41e321,'mode':'insensitive'}}]);const [_0xc14bb6,_0x379908]=await Promise[_0x390c4c(0x291)]([database_1['default'][_0x390c4c(0x19c)][_0x390c4c(0x229)]({'where':_0x417a63,'skip':_0x2d4eb5,'take':_0xd1015e,'orderBy':{'createdAt':_0x390c4c(0x1b7)},'select':{'id':!![],'shopId':!![],'amount':!![],'network':!![],'status':!![],'txid':!![],'notes':!![],'periodFrom':!![],'periodTo':!![],'createdAt':!![],'paidAt':!![],'shop':{'select':{'name':!![],'username':!![]}}}}),database_1[_0x390c4c(0x2b2)][_0x390c4c(0x19c)]['count']({'where':_0x417a63})]);return{'payouts':_0xc14bb6[_0x390c4c(0x1c4)](_0x5b2c10=>({'id':_0x5b2c10['id'],'shopId':_0x5b2c10[_0x390c4c(0x186)],'shopName':_0x5b2c10[_0x390c4c(0x277)][_0x390c4c(0x220)],'shopUsername':_0x5b2c10[_0x390c4c(0x277)][_0x390c4c(0x2a4)],'amount':_0x5b2c10[_0x390c4c(0x1f1)],'network':_0x5b2c10[_0x390c4c(0x1e3)],'status':_0x5b2c10['status'],'txid':_0x5b2c10[_0x390c4c(0x1c8)],'notes':_0x5b2c10[_0x390c4c(0x223)],'periodFrom':_0x5b2c10['periodFrom'],'periodTo':_0x5b2c10['periodTo'],'createdAt':_0x5b2c10['createdAt'],'paidAt':_0x5b2c10[_0x390c4c(0x1b1)]})),'pagination':{'page':_0x504034,'limit':_0xd1015e,'total':_0x379908,'totalPages':Math[_0x390c4c(0x257)](_0x379908/_0xd1015e)}};}async[a36_0x2aa225(0x1bc)](_0x1bbe9b){const _0x381ceb=a36_0x2aa225,_0x3510dd=await database_1[_0x381ceb(0x2b2)][_0x381ceb(0x19c)]['findUnique']({'where':{'id':_0x1bbe9b},'include':{'shop':{'select':{'name':!![],'username':!![]}}}});if(!_0x3510dd)return null;return{'id':_0x3510dd['id'],'shopId':_0x3510dd[_0x381ceb(0x186)],'shopName':_0x3510dd['shop']['name'],'shopUsername':_0x3510dd[_0x381ceb(0x277)]['username'],'amount':_0x3510dd[_0x381ceb(0x1f1)],'network':_0x3510dd[_0x381ceb(0x1e3)],'status':_0x3510dd['status'],'txid':_0x3510dd[_0x381ceb(0x1c8)],'notes':_0x3510dd['notes'],'periodFrom':_0x3510dd[_0x381ceb(0x253)],'periodTo':_0x3510dd[_0x381ceb(0x26f)],'createdAt':_0x3510dd[_0x381ceb(0x1cf)],'paidAt':_0x3510dd['paidAt']};}async[a36_0x2aa225(0x18e)](_0x48cae8){await database_1['default']['payout']['delete']({'where':{'id':_0x48cae8}});}async[a36_0x2aa225(0x180)](_0x4b5431){const _0x3e7362=a36_0x2aa225,{page:_0x1876e8,limit:_0x596631,status:_0x38fda3,gateway:_0x810e1a,shopId:_0x2af085,dateFrom:_0x354b5f,dateTo:_0x11ea15,search:_0x2158d8,currency:_0x18b82,sortBy:_0x5e30db,sortOrder:_0x41ba59}=_0x4b5431,_0x58fe20=(_0x1876e8-0x1)*_0x596631;console[_0x3e7362(0x28a)](_0x3e7362(0x190),_0x4b5431);const _0x417737=await database_1[_0x3e7362(0x2b2)][_0x3e7362(0x1a5)]['groupBy']({'by':['gateway'],'_count':{'gateway':!![]}});console[_0x3e7362(0x28a)](_0x3e7362(0x24f),_0x417737['map'](_0x405ac4=>_0x405ac4[_0x3e7362(0x1cd)]+'\x20('+_0x405ac4[_0x3e7362(0x19b)][_0x3e7362(0x1cd)]+_0x3e7362(0x286)));if(_0x810e1a){const _0x27ba5c=_0x417737[_0x3e7362(0x1a2)](_0x506718=>_0x506718['gateway']['toLowerCase']()===_0x810e1a[_0x3e7362(0x17f)]());!_0x27ba5c&&_0x810e1a['toLowerCase']()!==_0x3e7362(0x275)&&console[_0x3e7362(0x28a)](_0x3e7362(0x1ea)+_0x810e1a+'\x27\x20not\x20found.\x20Available\x20gateways:\x20'+_0x417737[_0x3e7362(0x1c4)](_0x38050=>_0x38050[_0x3e7362(0x1cd)])[_0x3e7362(0x182)](',\x20'));}const _0x3d2e44={};_0x38fda3&&(_0x3d2e44['status']=_0x38fda3[_0x3e7362(0x283)]());if(!_0x810e1a)_0x3d2e44[_0x3e7362(0x1cd)]={'not':'test_gateway'};else{if(_0x810e1a&&(_0x810e1a[_0x3e7362(0x17f)]()===_0x3e7362(0x275)||_0x810e1a==='0000'))_0x3d2e44[_0x3e7362(0x1cd)]=_0x3e7362(0x275);else{let _0x1f7c71=_0x810e1a;const _0x3ee49e=(0x0,gateway_1[_0x3e7362(0x1de)])(_0x810e1a);if(_0x3ee49e)_0x1f7c71=_0x3ee49e,console['log'](_0x3e7362(0x210)+_0x810e1a+'\x27\x20to\x20name\x20\x27'+_0x1f7c71+'\x27');else{const _0x7aef03=(0x0,gateway_1['getGatewayIdByName'])(_0x810e1a);if(_0x7aef03){const _0x15940e=(0x0,gateway_1[_0x3e7362(0x1de)])(_0x7aef03);_0x15940e&&(_0x1f7c71=_0x15940e,console['log'](_0x3e7362(0x185)+_0x810e1a+_0x3e7362(0x2b0)+_0x7aef03+_0x3e7362(0x216)+_0x1f7c71+'\x27'));}else console[_0x3e7362(0x28a)](_0x3e7362(0x1bf)+_0x810e1a+_0x3e7362(0x28e));}const _0x197797=await database_1[_0x3e7362(0x2b2)][_0x3e7362(0x1a5)][_0x3e7362(0x29f)]({'where':{'gateway':_0x1f7c71[_0x3e7362(0x17f)]()},'take':0x1});_0x197797===0x0?(console[_0x3e7362(0x28a)]('⚠️\x20Gateway\x20\x27'+_0x1f7c71+_0x3e7362(0x1ca)+_0x810e1a+_0x3e7362(0x1ef)),_0x3d2e44[_0x3e7362(0x1cd)]='NONEXISTENT_GATEWAY_FILTER'):(_0x3d2e44[_0x3e7362(0x1cd)]=_0x1f7c71['toLowerCase'](),console[_0x3e7362(0x28a)](_0x3e7362(0x24e)+_0x1f7c71+'\x27\x20(from\x20\x27'+_0x810e1a+'\x27)'));}}console[_0x3e7362(0x28a)](_0x3e7362(0x198),_0x3d2e44[_0x3e7362(0x1cd)]);_0x2af085&&(_0x3d2e44[_0x3e7362(0x186)]=_0x2af085);_0x18b82&&(_0x3d2e44[_0x3e7362(0x1f3)]=_0x18b82[_0x3e7362(0x283)](),console[_0x3e7362(0x28a)](_0x3e7362(0x285)+_0x18b82[_0x3e7362(0x283)]()));(_0x354b5f||_0x11ea15)&&(_0x3d2e44['createdAt']={},_0x354b5f&&(_0x3d2e44['createdAt'][_0x3e7362(0x1ae)]=new Date(_0x354b5f)),_0x11ea15&&(_0x3d2e44[_0x3e7362(0x1cf)][_0x3e7362(0x1d0)]=new Date(_0x11ea15)));_0x2158d8&&(_0x3d2e44['OR']=[{'id':{'contains':_0x2158d8,'mode':_0x3e7362(0x2ac)}},{'orderId':{'contains':_0x2158d8,'mode':_0x3e7362(0x2ac)}},{'gatewayOrderId':{'contains':_0x2158d8,'mode':_0x3e7362(0x2ac)}},{'customerEmail':{'contains':_0x2158d8,'mode':'insensitive'}},{'shop':{'name':{'contains':_0x2158d8,'mode':_0x3e7362(0x2ac)}}},{'shop':{'username':{'contains':_0x2158d8,'mode':_0x3e7362(0x2ac)}}}]);console['log'](_0x3e7362(0x1f8),JSON[_0x3e7362(0x242)](_0x3d2e44,null,0x2));let _0x36033d={'createdAt':'desc'};if(_0x5e30db){const _0x39a75e=[_0x3e7362(0x1f1),_0x3e7362(0x1cf),_0x3e7362(0x27f),_0x3e7362(0x2a8),_0x3e7362(0x1cd),_0x3e7362(0x1f3)],_0x38e1a1=[_0x3e7362(0x239),_0x3e7362(0x1b7)];if(_0x39a75e[_0x3e7362(0x28b)](_0x5e30db)){const _0x524439=_0x38e1a1[_0x3e7362(0x28b)](_0x41ba59)?_0x41ba59:_0x3e7362(0x1b7);_0x36033d={[_0x5e30db]:_0x524439},console[_0x3e7362(0x28a)](_0x3e7362(0x19e)+_0x5e30db+_0x3e7362(0x1d3)+_0x524439+_0x3e7362(0x298));}}const [_0x3adc55,_0x220349]=await Promise[_0x3e7362(0x291)]([database_1[_0x3e7362(0x2b2)][_0x3e7362(0x1a5)][_0x3e7362(0x229)]({'where':_0x3d2e44,'skip':_0x58fe20,'take':_0x596631,'orderBy':_0x36033d,'select':{'id':!![],'shopId':!![],'amount':!![],'amountAfterGatewayCommissionUSDT':!![],'currency':!![],'sourceCurrency':!![],'status':!![],'gateway':!![],'orderId':!![],'gatewayOrderId':!![],'gatewayPaymentId':!![],'customerEmail':!![],'customerName':!![],'customerCountry':!![],'customerIp':!![],'customerUa':!![],'externalPaymentUrl':!![],'successUrl':!![],'failUrl':!![],'pendingUrl':!![],'whiteUrl':!![],'expiresAt':!![],'invoiceTotalSum':!![],'qrCode':!![],'qrUrl':!![],'country':!![],'language':!![],'amountIsEditable':!![],'maxPayments':!![],'rapydCustomer':!![],'cardLast4':!![],'paymentMethod':!![],'bankId':!![],'remitterIban':!![],'remitterName':!![],'failureMessage':!![],'usage':!![],'createdAt':!![],'updatedAt':!![],'shop':{'select':{'name':!![],'username':!![]}}}}),database_1[_0x3e7362(0x2b2)][_0x3e7362(0x1a5)][_0x3e7362(0x29f)]({'where':_0x3d2e44})]);return{'payments':_0x3adc55,'pagination':{'page':_0x1876e8,'limit':_0x596631,'total':_0x220349,'totalPages':Math['ceil'](_0x220349/_0x596631)}};}async['getPaymentById'](_0x581586){const _0x25ea3e=a36_0x2aa225,_0x17c69a=await database_1[_0x25ea3e(0x2b2)][_0x25ea3e(0x1a5)][_0x25ea3e(0x1a6)]({'where':{'id':_0x581586},'select':{'id':!![],'shopId':!![],'amount':!![],'amountAfterGatewayCommissionUSDT':!![],'currency':!![],'sourceCurrency':!![],'status':!![],'gateway':!![],'orderId':!![],'gatewayOrderId':!![],'gatewayPaymentId':!![],'customerEmail':!![],'customerName':!![],'customerCountry':!![],'customerIp':!![],'customerUa':!![],'externalPaymentUrl':!![],'successUrl':!![],'failUrl':!![],'pendingUrl':!![],'whiteUrl':!![],'expiresAt':!![],'invoiceTotalSum':!![],'qrCode':!![],'qrUrl':!![],'country':!![],'language':!![],'amountIsEditable':!![],'maxPayments':!![],'rapydCustomer':!![],'cardLast4':!![],'paymentMethod':!![],'bankId':!![],'remitterIban':!![],'remitterName':!![],'failureMessage':!![],'usage':!![],'createdAt':!![],'updatedAt':!![],'shop':{'select':{'name':!![],'username':!![]}}}});if(!_0x17c69a)return null;return{'id':_0x17c69a['id'],'shopId':_0x17c69a[_0x25ea3e(0x186)],'gateway':_0x17c69a[_0x25ea3e(0x1cd)],'amount':_0x17c69a[_0x25ea3e(0x1f1)],'currency':_0x17c69a[_0x25ea3e(0x1f3)],'status':_0x17c69a[_0x25ea3e(0x2a8)],'orderId':_0x17c69a['orderId'],'gatewayOrderId':_0x17c69a['gatewayOrderId'],'customerEmail':_0x17c69a[_0x25ea3e(0x219)],'customerName':_0x17c69a[_0x25ea3e(0x279)],'customerCountry':_0x17c69a[_0x25ea3e(0x187)],'customerIp':_0x17c69a[_0x25ea3e(0x207)],'customerUa':_0x17c69a['customerUa'],'failureMessage':_0x17c69a[_0x25ea3e(0x270)],'externalPaymentUrl':_0x17c69a[_0x25ea3e(0x290)],'successUrl':_0x17c69a[_0x25ea3e(0x1f7)],'failUrl':_0x17c69a[_0x25ea3e(0x2b3)],'pendingUrl':_0x17c69a[_0x25ea3e(0x266)],'whiteUrl':_0x17c69a[_0x25ea3e(0x256)],'createdAt':_0x17c69a[_0x25ea3e(0x1cf)],'updatedAt':_0x17c69a[_0x25ea3e(0x27f)],'shop':_0x17c69a[_0x25ea3e(0x277)]};}async['updatePaymentStatus'](_0x5b8ba5,_0x40ff49,_0x2436ca,_0x2c2ab5){const _0x19f886=a36_0x2aa225,_0x41bd84=await database_1['default']['$transaction'](async _0x4a4738=>{const _0x5d664c=a36_0x234d,_0x274d09=await _0x4a4738['payment'][_0x5d664c(0x1a6)]({'where':{'id':_0x5b8ba5},'include':{'shop':{'select':{'id':!![],'name':!![],'username':!![],'balance':!![]}}}});if(!_0x274d09)throw new Error('Payment\x20not\x20found');const _0x15b8bc=_0x274d09['status'],_0x643d7c=_0x40ff49[_0x5d664c(0x283)]();console[_0x5d664c(0x28a)](_0x5d664c(0x2a5)+_0x5b8ba5+'\x20status:\x20'+_0x15b8bc+'\x20->\x20'+_0x643d7c),console[_0x5d664c(0x28a)](_0x5d664c(0x1ac)+_0x274d09[_0x5d664c(0x277)]['balance']+'\x20USDT');const _0x48695e={'status':_0x643d7c,'updatedAt':new Date(),'statusChangedBy':_0x5d664c(0x271),'statusChangedAt':new Date()};_0x2436ca&&(_0x48695e[_0x5d664c(0x284)]=_0x2436ca);_0x643d7c==='CHARGEBACK'&&_0x2c2ab5&&(_0x48695e[_0x5d664c(0x294)]=_0x2c2ab5);let _0x244be0=0x0,_0x1e27ac=_0x274d09[_0x5d664c(0x277)][_0x5d664c(0x1e7)];if(_0x643d7c==='PAID'&&_0x15b8bc!=='PAID'){_0x48695e[_0x5d664c(0x1b1)]=new Date();const _0x1b1683=await currencyService_1['currencyService'][_0x5d664c(0x23a)](_0x274d09['amount'],_0x274d09[_0x5d664c(0x1f3)]);_0x48695e['amountUSDT']=_0x1b1683;let _0x31d766=0xa;const _0x2a43da=await _0x4a4738[_0x5d664c(0x277)][_0x5d664c(0x1a6)]({'where':{'id':_0x274d09[_0x5d664c(0x186)]},'select':{'gatewaySettings':!![]}});if(_0x2a43da?.['gatewaySettings'])try{const _0x37879f=JSON[_0x5d664c(0x269)](_0x2a43da[_0x5d664c(0x278)]);for(const [_0x53fccd,_0x523b6a]of Object[_0x5d664c(0x1e8)](_0x37879f)){if(_0x53fccd['toLowerCase']()===_0x274d09[_0x5d664c(0x1cd)][_0x5d664c(0x17f)]()){_0x31d766=_0x523b6a[_0x5d664c(0x264)]||0xa;break;}}}catch(_0x594639){console[_0x5d664c(0x1bd)](_0x5d664c(0x1bb)+_0x5b8ba5+':',_0x594639);}let _0x35e1d3;_0x274d09['amountAfterGatewayCommissionUSDT']!==null&&_0x274d09[_0x5d664c(0x1e6)]!==undefined?(_0x35e1d3=_0x274d09[_0x5d664c(0x1e6)],console[_0x5d664c(0x28a)]('📊\x20[ADMIN]\x20Using\x20saved\x20amountAfterGatewayCommissionUSDT:\x20'+_0x35e1d3[_0x5d664c(0x222)](0x6)+_0x5d664c(0x1f2)+_0x5b8ba5)):(_0x35e1d3=_0x1b1683*(0x1-_0x31d766/0x64),console['log'](_0x5d664c(0x208)+_0x5b8ba5+':\x20'+_0x31d766+'%\x20from\x20'+_0x1b1683[_0x5d664c(0x222)](0x6)+_0x5d664c(0x1d5)),_0x48695e[_0x5d664c(0x1e6)]=_0x35e1d3),_0x244be0=_0x35e1d3,_0x1e27ac+=_0x35e1d3,console[_0x5d664c(0x28a)]('💰\x20Payment\x20'+_0x5b8ba5+'\x20became\x20PAID:'),console[_0x5d664c(0x28a)]('\x20\x20\x20Full\x20amount:\x20'+_0x1b1683[_0x5d664c(0x222)](0x6)+_0x5d664c(0x1d5)),console[_0x5d664c(0x28a)](_0x5d664c(0x247)+_0x274d09['gateway']+_0x5d664c(0x23f)+_0x31d766+'%'),console[_0x5d664c(0x28a)](_0x5d664c(0x20d)+_0x35e1d3[_0x5d664c(0x222)](0x6)+'\x20USDT\x20(after\x20'+_0x31d766+_0x5d664c(0x1b2)),console[_0x5d664c(0x28a)](_0x5d664c(0x25b)+_0x35e1d3[_0x5d664c(0x222)](0x6)+_0x5d664c(0x1d5));}else{if(_0x15b8bc==='PAID'&&_0x643d7c!=='PAID'){if(_0x274d09['amountUSDT']){let _0x4cc742=0xa;const _0x31beef=await _0x4a4738['shop'][_0x5d664c(0x1a6)]({'where':{'id':_0x274d09['shopId']},'select':{'gatewaySettings':!![]}});if(_0x31beef?.[_0x5d664c(0x278)])try{const _0x58c8b8=JSON[_0x5d664c(0x269)](_0x31beef['gatewaySettings']);for(const [_0x45ab87,_0x447454]of Object['entries'](_0x58c8b8)){if(_0x45ab87[_0x5d664c(0x17f)]()===_0x274d09['gateway'][_0x5d664c(0x17f)]()){_0x4cc742=_0x447454[_0x5d664c(0x264)]||0xa;break;}}}catch(_0x1f7995){console[_0x5d664c(0x1bd)](_0x5d664c(0x1bb)+_0x5b8ba5+':',_0x1f7995);}const _0x1814ba=_0x274d09[_0x5d664c(0x281)]*(0x1-_0x4cc742/0x64);_0x244be0=-_0x1814ba,_0x1e27ac-=_0x1814ba,_0x48695e[_0x5d664c(0x281)]=null,_0x48695e[_0x5d664c(0x1e6)]=null,console[_0x5d664c(0x28a)]('💰\x20Payment\x20'+_0x5b8ba5+_0x5d664c(0x2a7)),console[_0x5d664c(0x28a)]('\x20\x20\x20Full\x20amount:\x20'+_0x274d09[_0x5d664c(0x281)][_0x5d664c(0x222)](0x6)+_0x5d664c(0x1d5)),console['log'](_0x5d664c(0x247)+_0x274d09[_0x5d664c(0x1cd)]+',\x20Commission:\x20'+_0x4cc742+'%'),console[_0x5d664c(0x28a)](_0x5d664c(0x1af)+_0x1814ba['toFixed'](0x6)+_0x5d664c(0x19a)+_0x4cc742+_0x5d664c(0x1b2)),console[_0x5d664c(0x28a)](_0x5d664c(0x20b)+_0x1814ba[_0x5d664c(0x222)](0x6)+_0x5d664c(0x1d5));}}}_0x643d7c==='CHARGEBACK'&&(_0x15b8bc==='PAID'&&_0x274d09[_0x5d664c(0x281)]&&console['log']('💸\x20CHARGEBACK:\x20Merchant\x20amount\x20already\x20deducted\x20from\x20balance'),_0x2c2ab5&&_0x2c2ab5>0x0&&(_0x244be0-=_0x2c2ab5,_0x1e27ac-=_0x2c2ab5,console['log'](_0x5d664c(0x1eb)+_0x2c2ab5[_0x5d664c(0x222)](0x6)+_0x5d664c(0x259))));_0x643d7c===_0x5d664c(0x1fe)&&_0x15b8bc==='PAID'&&console[_0x5d664c(0x28a)](_0x5d664c(0x235));const _0x21b302=await _0x4a4738[_0x5d664c(0x1a5)][_0x5d664c(0x1ff)]({'where':{'id':_0x5b8ba5},'data':_0x48695e,'include':{'shop':{'select':{'name':!![],'username':!![]}}}});return _0x244be0!==0x0&&(await _0x4a4738['shop']['update']({'where':{'id':_0x274d09['shopId']},'data':{'balance':_0x1e27ac}}),console['log'](_0x5d664c(0x203)+_0x274d09[_0x5d664c(0x186)]+'\x20balance\x20updated:\x20'+_0x274d09['shop'][_0x5d664c(0x1e7)]['toFixed'](0x6)+_0x5d664c(0x255)+_0x1e27ac[_0x5d664c(0x222)](0x6)+_0x5d664c(0x27d)+(_0x244be0>0x0?'+':'')+_0x244be0[_0x5d664c(0x222)](0x6)+')')),_0x21b302;});return{'id':_0x41bd84['id'],'shopId':_0x41bd84[_0x19f886(0x186)],'gateway':_0x41bd84['gateway'],'amount':_0x41bd84[_0x19f886(0x1f1)],'currency':_0x41bd84[_0x19f886(0x1f3)],'status':_0x41bd84[_0x19f886(0x2a8)],'orderId':_0x41bd84[_0x19f886(0x2a0)],'gatewayOrderId':_0x41bd84[_0x19f886(0x273)],'customerEmail':_0x41bd84[_0x19f886(0x219)],'customerName':_0x41bd84[_0x19f886(0x279)],'customerCountry':_0x41bd84[_0x19f886(0x187)],'customerIp':_0x41bd84[_0x19f886(0x207)],'customerUa':_0x41bd84['customerUa'],'failureMessage':_0x41bd84[_0x19f886(0x270)],'adminNotes':_0x41bd84[_0x19f886(0x284)],'chargebackAmount':_0x41bd84['chargebackAmount'],'statusChangedBy':_0x41bd84['statusChangedBy'],'statusChangedAt':_0x41bd84['statusChangedAt'],'createdAt':_0x41bd84['createdAt'],'updatedAt':_0x41bd84['updatedAt'],'shop':_0x41bd84['shop']};}async[a36_0x2aa225(0x293)](_0x218f90,_0xe5caea){const _0x3d7264=a36_0x2aa225,_0x414e29=Math[_0x3d7264(0x243)]()[_0x3d7264(0x230)](0x24)[_0x3d7264(0x225)](0x2,0x9);console[_0x3d7264(0x28a)](_0x3d7264(0x1d6)+_0x414e29+_0x3d7264(0x22e)+_0x218f90);const _0x3898ec={..._0xe5caea};_0xe5caea[_0x3d7264(0x1c3)]&&_0xe5caea['password'][_0x3d7264(0x228)]()!==''?(console[_0x3d7264(0x28a)](_0x3d7264(0x25e)+_0x414e29+']\x20Updating\x20password\x20for\x20user\x20'+_0x218f90),_0x3898ec['password']=await bcryptjs_1[_0x3d7264(0x2b2)]['hash'](_0xe5caea[_0x3d7264(0x1c3)],0xc)):(console[_0x3d7264(0x28a)](_0x3d7264(0x25e)+_0x414e29+']\x20Password\x20not\x20provided\x20or\x20empty,\x20skipping\x20password\x20update'),delete _0x3898ec[_0x3d7264(0x1c3)]);_0xe5caea['fullName']&&(_0x3898ec[_0x3d7264(0x220)]=_0xe5caea[_0x3d7264(0x1fb)],delete _0x3898ec[_0x3d7264(0x1fb)]);_0xe5caea['telegramId']&&(_0x3898ec[_0x3d7264(0x1df)]=_0xe5caea[_0x3d7264(0x29a)],delete _0x3898ec['telegramId']);_0xe5caea['merchantUrl']&&(_0x3898ec[_0x3d7264(0x1e4)]=_0xe5caea[_0x3d7264(0x1d7)],delete _0x3898ec[_0x3d7264(0x1d7)]);if(_0xe5caea[_0x3d7264(0x26b)]){const _0x2d078d=_0xe5caea[_0x3d7264(0x26b)][_0x3d7264(0x1c4)](_0x4f307a=>this[_0x3d7264(0x249)](_0x4f307a));console[_0x3d7264(0x28a)]('🔄\x20Gateway\x20mapping:',_0xe5caea[_0x3d7264(0x26b)],'->',_0x2d078d),_0x3898ec[_0x3d7264(0x24c)]=JSON[_0x3d7264(0x242)](_0x2d078d),delete _0x3898ec[_0x3d7264(0x26b)];}_0xe5caea['gatewaySettings']&&(console[_0x3d7264(0x28a)](_0x3d7264(0x24a)+_0x414e29+_0x3d7264(0x1ba),_0xe5caea[_0x3d7264(0x278)]),_0x3898ec[_0x3d7264(0x278)]=JSON[_0x3d7264(0x242)](_0xe5caea[_0x3d7264(0x278)]),console[_0x3d7264(0x28a)](_0x3d7264(0x24a)+_0x414e29+_0x3d7264(0x1e0),_0x3898ec['gatewaySettings']));_0xe5caea['wallets']&&(_0xe5caea[_0x3d7264(0x27a)][_0x3d7264(0x1be)]!==undefined&&(_0x3898ec[_0x3d7264(0x1be)]=_0xe5caea[_0x3d7264(0x27a)]['usdtPolygonWallet']||null),_0xe5caea[_0x3d7264(0x27a)][_0x3d7264(0x23b)]!==undefined&&(_0x3898ec[_0x3d7264(0x23b)]=_0xe5caea['wallets'][_0x3d7264(0x23b)]||null),_0xe5caea[_0x3d7264(0x27a)][_0x3d7264(0x2ab)]!==undefined&&(_0x3898ec['usdtErcWallet']=_0xe5caea['wallets']['usdtErcWallet']||null),_0xe5caea['wallets'][_0x3d7264(0x2ad)]!==undefined&&(_0x3898ec['usdcPolygonWallet']=_0xe5caea[_0x3d7264(0x27a)]['usdcPolygonWallet']||null),delete _0x3898ec['wallets']);const _0x3cf5d8=await database_1['default'][_0x3d7264(0x277)][_0x3d7264(0x1ff)]({'where':{'id':_0x218f90},'data':_0x3898ec,'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});return console[_0x3d7264(0x28a)](_0x3d7264(0x297)+_0x414e29+_0x3d7264(0x206),_0x3cf5d8[_0x3d7264(0x278)]),{'id':_0x3cf5d8['id'],'fullName':_0x3cf5d8[_0x3d7264(0x220)],'username':_0x3cf5d8[_0x3d7264(0x2a4)],'telegramId':_0x3cf5d8[_0x3d7264(0x1df)],'merchantUrl':_0x3cf5d8[_0x3d7264(0x1e4)],'gateways':_0x3cf5d8['paymentGateways']?JSON[_0x3d7264(0x269)](_0x3cf5d8['paymentGateways']):null,'gatewaySettings':_0x3cf5d8[_0x3d7264(0x278)]?JSON[_0x3d7264(0x269)](_0x3cf5d8[_0x3d7264(0x278)]):null,'publicKey':_0x3cf5d8[_0x3d7264(0x237)],'wallets':{'usdtPolygonWallet':_0x3cf5d8[_0x3d7264(0x1be)],'usdtTrcWallet':_0x3cf5d8[_0x3d7264(0x23b)],'usdtErcWallet':_0x3cf5d8[_0x3d7264(0x2ab)],'usdcPolygonWallet':_0x3cf5d8['usdcPolygonWallet']},'status':_0x3cf5d8['status'],'createdAt':_0x3cf5d8[_0x3d7264(0x1cf)]};}async['suspendUser'](_0x41a64b){const _0x4861da=a36_0x2aa225,_0x3c40d9=await database_1[_0x4861da(0x2b2)][_0x4861da(0x277)][_0x4861da(0x1ff)]({'where':{'id':_0x41a64b},'data':{'status':_0x4861da(0x28c)},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});return{'id':_0x3c40d9['id'],'fullName':_0x3c40d9[_0x4861da(0x220)],'username':_0x3c40d9[_0x4861da(0x2a4)],'telegramId':_0x3c40d9['telegram'],'merchantUrl':_0x3c40d9[_0x4861da(0x1e4)],'gateways':_0x3c40d9[_0x4861da(0x24c)]?JSON[_0x4861da(0x269)](_0x3c40d9['paymentGateways']):null,'gatewaySettings':_0x3c40d9[_0x4861da(0x278)]?JSON[_0x4861da(0x269)](_0x3c40d9['gatewaySettings']):null,'publicKey':_0x3c40d9[_0x4861da(0x237)],'wallets':{'usdtPolygonWallet':_0x3c40d9[_0x4861da(0x1be)],'usdtTrcWallet':_0x3c40d9[_0x4861da(0x23b)],'usdtErcWallet':_0x3c40d9[_0x4861da(0x2ab)],'usdcPolygonWallet':_0x3c40d9[_0x4861da(0x2ad)]},'status':_0x3c40d9['status'],'createdAt':_0x3c40d9[_0x4861da(0x1cf)]};}async['activateUser'](_0x513638){const _0x2db1f3=a36_0x2aa225,_0x470e17=await database_1[_0x2db1f3(0x2b2)][_0x2db1f3(0x277)][_0x2db1f3(0x1ff)]({'where':{'id':_0x513638},'data':{'status':'ACTIVE'},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});return{'id':_0x470e17['id'],'fullName':_0x470e17[_0x2db1f3(0x220)],'username':_0x470e17[_0x2db1f3(0x2a4)],'telegramId':_0x470e17[_0x2db1f3(0x1df)],'merchantUrl':_0x470e17[_0x2db1f3(0x1e4)],'gateways':_0x470e17[_0x2db1f3(0x24c)]?JSON[_0x2db1f3(0x269)](_0x470e17[_0x2db1f3(0x24c)]):null,'gatewaySettings':_0x470e17[_0x2db1f3(0x278)]?JSON[_0x2db1f3(0x269)](_0x470e17[_0x2db1f3(0x278)]):null,'publicKey':_0x470e17[_0x2db1f3(0x237)],'wallets':{'usdtPolygonWallet':_0x470e17[_0x2db1f3(0x1be)],'usdtTrcWallet':_0x470e17[_0x2db1f3(0x23b)],'usdtErcWallet':_0x470e17[_0x2db1f3(0x2ab)],'usdcPolygonWallet':_0x470e17[_0x2db1f3(0x2ad)]},'status':_0x470e17[_0x2db1f3(0x2a8)],'createdAt':_0x470e17[_0x2db1f3(0x1cf)]};}async[a36_0x2aa225(0x197)](_0x2da408){const _0x26c0db=a36_0x2aa225,{page:_0xba3571,limit:_0x1a4af3,status:_0x236e6b}=_0x2da408,_0x26c9b1=(_0xba3571-0x1)*_0x1a4af3,_0x3cb2e7={};_0x236e6b&&(_0x3cb2e7[_0x26c0db(0x2a8)]=_0x236e6b[_0x26c0db(0x283)]());const [_0x442807,_0x5f0cd5]=await Promise[_0x26c0db(0x291)]([database_1[_0x26c0db(0x2b2)][_0x26c0db(0x277)][_0x26c0db(0x229)]({'where':_0x3cb2e7,'skip':_0x26c9b1,'take':_0x1a4af3,'orderBy':{'createdAt':_0x26c0db(0x1b7)},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}}),database_1[_0x26c0db(0x2b2)][_0x26c0db(0x277)][_0x26c0db(0x29f)]({'where':_0x3cb2e7})]);return{'users':_0x442807[_0x26c0db(0x1c4)](_0x7baf2d=>{const _0x1e3ab1=_0x26c0db,_0xb4f317=_0x7baf2d['paymentGateways']?JSON[_0x1e3ab1(0x269)](_0x7baf2d['paymentGateways']):null,_0x5b1731=_0xb4f317?_0xb4f317['map'](_0x41105d=>this[_0x1e3ab1(0x21e)](_0x41105d)):null;return{'id':_0x7baf2d['id'],'fullName':_0x7baf2d[_0x1e3ab1(0x220)],'username':_0x7baf2d[_0x1e3ab1(0x2a4)],'telegramId':_0x7baf2d[_0x1e3ab1(0x1df)],'merchantUrl':_0x7baf2d[_0x1e3ab1(0x1e4)],'gateways':_0x5b1731,'gatewaySettings':_0x7baf2d[_0x1e3ab1(0x278)]?JSON[_0x1e3ab1(0x269)](_0x7baf2d[_0x1e3ab1(0x278)]):null,'publicKey':_0x7baf2d[_0x1e3ab1(0x237)],'wallets':{'usdtPolygonWallet':_0x7baf2d['usdtPolygonWallet'],'usdtTrcWallet':_0x7baf2d[_0x1e3ab1(0x23b)],'usdtErcWallet':_0x7baf2d[_0x1e3ab1(0x2ab)],'usdcPolygonWallet':_0x7baf2d['usdcPolygonWallet']},'status':_0x7baf2d['status'],'createdAt':_0x7baf2d['createdAt']};}),'pagination':{'page':_0xba3571,'limit':_0x1a4af3,'total':_0x5f0cd5,'totalPages':Math[_0x26c0db(0x257)](_0x5f0cd5/_0x1a4af3)}};}async['getUserById'](_0x3fe0d3){const _0x571265=a36_0x2aa225,_0x291450=await database_1[_0x571265(0x2b2)][_0x571265(0x277)][_0x571265(0x1a6)]({'where':{'id':_0x3fe0d3},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});if(!_0x291450)return null;const _0x211352=_0x291450['paymentGateways']?JSON[_0x571265(0x269)](_0x291450['paymentGateways']):null,_0x38709b=_0x211352?_0x211352[_0x571265(0x1c4)](_0xc7e94=>this['getGatewayDisplayName'](_0xc7e94)):null;return _0x211352&&_0x38709b&&console[_0x571265(0x28a)](_0x571265(0x1c0),_0x211352,'->',_0x38709b),{'id':_0x291450['id'],'fullName':_0x291450[_0x571265(0x220)],'username':_0x291450[_0x571265(0x2a4)],'telegramId':_0x291450[_0x571265(0x1df)],'merchantUrl':_0x291450[_0x571265(0x1e4)],'gateways':_0x38709b,'gatewaySettings':_0x291450[_0x571265(0x278)]?JSON[_0x571265(0x269)](_0x291450[_0x571265(0x278)]):null,'publicKey':_0x291450[_0x571265(0x237)],'wallets':{'usdtPolygonWallet':_0x291450[_0x571265(0x1be)],'usdtTrcWallet':_0x291450[_0x571265(0x23b)],'usdtErcWallet':_0x291450[_0x571265(0x2ab)],'usdcPolygonWallet':_0x291450[_0x571265(0x2ad)]},'status':_0x291450[_0x571265(0x2a8)],'createdAt':_0x291450[_0x571265(0x1cf)]};}async[a36_0x2aa225(0x1c6)](_0x2aa134){const _0x47924a=a36_0x2aa225,{fullName:_0x2a2c67,username:_0x5c2b0e,password:_0xe50090,telegramId:_0x5e2c36,merchantUrl:_0x2f1696,gateways:_0x3d8627,gatewaySettings:_0x10b9ec,wallets:_0x5988db}=_0x2aa134,_0x18973c=await database_1['default'][_0x47924a(0x277)]['findUnique']({'where':{'username':_0x5c2b0e}});if(_0x18973c)throw new Error(_0x47924a(0x19f));if(_0x5e2c36){const _0x3309ad=await database_1[_0x47924a(0x2b2)][_0x47924a(0x277)][_0x47924a(0x1a6)]({'where':{'telegram':_0x5e2c36}});if(_0x3309ad)throw new Error('Telegram\x20username\x20already\x20exists');}const _0x5587df=await bcryptjs_1['default'][_0x47924a(0x1f0)](_0xe50090,0xc),_0x2010b0=_0x47924a(0x213)+crypto_1[_0x47924a(0x2b2)][_0x47924a(0x1dd)](0x20)[_0x47924a(0x230)](_0x47924a(0x1a7)),_0x594bcb='sk_'+crypto_1[_0x47924a(0x2b2)][_0x47924a(0x1dd)](0x20)[_0x47924a(0x230)]('hex'),_0x477a70=_0x3d8627?_0x3d8627[_0x47924a(0x1c4)](_0x1301f3=>this[_0x47924a(0x249)](_0x1301f3)):null;_0x3d8627&&_0x477a70&&console[_0x47924a(0x28a)]('🔄\x20Gateway\x20mapping\x20(create):',_0x3d8627,'->',_0x477a70);const _0x2627b9=await database_1[_0x47924a(0x2b2)][_0x47924a(0x277)][_0x47924a(0x1d4)]({'data':{'name':_0x2a2c67,'username':_0x5c2b0e,'password':_0x5587df,'telegram':_0x5e2c36,'shopUrl':_0x2f1696,'paymentGateways':_0x477a70?JSON[_0x47924a(0x242)](_0x477a70):null,'gatewaySettings':_0x10b9ec?JSON[_0x47924a(0x242)](_0x10b9ec):null,'usdtPolygonWallet':_0x5988db?.['usdtPolygonWallet']||null,'usdtTrcWallet':_0x5988db?.['usdtTrcWallet']||null,'usdtErcWallet':_0x5988db?.[_0x47924a(0x2ab)]||null,'usdcPolygonWallet':_0x5988db?.[_0x47924a(0x2ad)]||null,'publicKey':_0x2010b0,'secretKey':_0x594bcb,'status':_0x47924a(0x2a2)},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});return{'id':_0x2627b9['id'],'fullName':_0x2627b9[_0x47924a(0x220)],'username':_0x2627b9['username'],'telegramId':_0x2627b9[_0x47924a(0x1df)],'merchantUrl':_0x2627b9[_0x47924a(0x1e4)],'gateways':_0x2627b9[_0x47924a(0x24c)]?JSON['parse'](_0x2627b9['paymentGateways']):null,'gatewaySettings':_0x2627b9[_0x47924a(0x278)]?JSON['parse'](_0x2627b9['gatewaySettings']):null,'publicKey':_0x2627b9['publicKey'],'wallets':{'usdtPolygonWallet':_0x2627b9[_0x47924a(0x1be)],'usdtTrcWallet':_0x2627b9[_0x47924a(0x23b)],'usdtErcWallet':_0x2627b9[_0x47924a(0x2ab)],'usdcPolygonWallet':_0x2627b9[_0x47924a(0x2ad)]},'status':_0x2627b9[_0x47924a(0x2a8)],'createdAt':_0x2627b9[_0x47924a(0x1cf)]};}async[a36_0x2aa225(0x245)](_0x56bf47){const _0x155bb8=a36_0x2aa225;await database_1[_0x155bb8(0x2b2)][_0x155bb8(0x277)]['delete']({'where':{'id':_0x56bf47}});}[a36_0x2aa225(0x218)](_0x3ef8ee,_0xcd3f3b,_0x1ddfb2){const _0x53702a=a36_0x2aa225,_0x1b5382=new Map(),_0x64c0c3=new Date(_0xcd3f3b);while(_0x64c0c3<=_0x1ddfb2){const _0x1800a5=_0x64c0c3[_0x53702a(0x1f6)]()['split']('T')[0x0];_0x1b5382['set'](_0x1800a5,{'revenue':0x0,'count':0x0}),_0x64c0c3[_0x53702a(0x1f5)](_0x64c0c3[_0x53702a(0x18c)]()+0x1);}for(const _0x39c708 of _0x3ef8ee){const _0x518565=_0x39c708[_0x53702a(0x1cf)][_0x53702a(0x1f6)]()[_0x53702a(0x1ec)]('T')[0x0],_0x3aac5b=_0x1b5382[_0x53702a(0x1fc)](_0x518565);_0x3aac5b&&(_0x3aac5b[_0x53702a(0x29f)]+=0x1,_0x39c708[_0x53702a(0x2a8)]==='PAID'&&(_0x39c708['amountUSDT']?_0x3aac5b[_0x53702a(0x246)]+=_0x39c708[_0x53702a(0x281)]:console[_0x53702a(0x28a)](_0x53702a(0x26e)+_0x39c708['id']+'\x20missing\x20amountUSDT,\x20using\x20fallback\x20conversion')));}const _0x36b931=[],_0x39753e=[];for(const [_0x66305a,_0x420e6e]of _0x1b5382){_0x36b931[_0x53702a(0x188)]({'date':_0x66305a,'amount':Math[_0x53702a(0x1d9)](_0x420e6e[_0x53702a(0x246)]*0x64)/0x64}),_0x39753e[_0x53702a(0x188)]({'date':_0x66305a,'count':_0x420e6e[_0x53702a(0x29f)]});}return{'dailyRevenue':_0x36b931,'dailyPayments':_0x39753e};}}function a36_0x234d(_0x57f3ab,_0x42c243){const _0x15ba8=a36_0x15ba();return a36_0x234d=function(_0x234d42,_0x3c5c26){_0x234d42=_0x234d42-0x17d;let _0x35f512=_0x15ba8[_0x234d42];return _0x35f512;},a36_0x234d(_0x57f3ab,_0x42c243);}exports[a36_0x2aa225(0x1c7)]=AdminService;