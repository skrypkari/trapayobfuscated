'use strict';const a38_0x25a63d=a38_0x18b4;(function(_0x219a20,_0x4d4218){const _0x4e620e=a38_0x18b4,_0x4773a8=_0x219a20();while(!![]){try{const _0x29ee09=-parseInt(_0x4e620e(0x225))/0x1+-parseInt(_0x4e620e(0x23a))/0x2+-parseInt(_0x4e620e(0x161))/0x3*(parseInt(_0x4e620e(0x1cc))/0x4)+-parseInt(_0x4e620e(0x220))/0x5+-parseInt(_0x4e620e(0x16e))/0x6+parseInt(_0x4e620e(0x20d))/0x7+-parseInt(_0x4e620e(0x1d3))/0x8*(-parseInt(_0x4e620e(0x17c))/0x9);if(_0x29ee09===_0x4d4218)break;else _0x4773a8['push'](_0x4773a8['shift']());}catch(_0x3c9343){_0x4773a8['push'](_0x4773a8['shift']());}}}(a38_0x285a,0xeb58d));var __importDefault=this&&this['__importDefault']||function(_0x1e27f1){const _0x51b9cc=a38_0x18b4;return _0x1e27f1&&_0x1e27f1[_0x51b9cc(0x14d)]?_0x1e27f1:{'default':_0x1e27f1};};Object[a38_0x25a63d(0x12d)](exports,a38_0x25a63d(0x14d),{'value':!![]}),exports[a38_0x25a63d(0x231)]=void 0x0;function a38_0x18b4(_0x559df6,_0x1ed17a){const _0x285a07=a38_0x285a();return a38_0x18b4=function(_0x18b4b7,_0x189462){_0x18b4b7=_0x18b4b7-0x122;let _0x59261c=_0x285a07[_0x18b4b7];return _0x59261c;},a38_0x18b4(_0x559df6,_0x1ed17a);}function a38_0x285a(){const _0x5976fc=['\x20\x20\x20Subtracted\x20from\x20balance:\x20-','usdcErcWallet','crypto','30d','sort','lte','usdcPolygonWallet','setDate','aggregate','desc','\x20\x20\x20💰\x20Total\x20payments\x20turnover:\x20','\x20\x20\x20Transaction\x20hash:\x20','updatedAt','50242293iFQOXu','getUserById',',\x20successful:\x20','turnoverUSDT','delete','admin','map','setHours','username','getGatewayDisplayName','\x20\x20\x20📅\x20This\x20month:\x20','\x20\x20\x20�\x20Total\x20paid\x20out:\x20','\x20\x20\x20🖥️\x20User\x20Agent:\x20','totalTurnover','\x20PAID\x20payments','\x20\x20\x20💸\x20Total\x20payouts\x20(all\x20time):\x20','\x20USDT\x20(gross\x20revenue)','📊\x20Using\x20saved\x20commission\x20rate\x20for\x20payment\x20','\x20\x20\x20�\x20Total\x20payments\x20turnover:\x20','\x20active\x20merchants\x20for\x20selection','parse','commission','\x20balance\x20updated:','successUrl','fullName','adminNotes','\x20\x20\x20✅\x20Actual\x20available\x20balance:\x20','round','COMPLETED','📊\x20Getting\x20merchant\x20statistics\x20with\x20filters:','gatewayCommissionRate','amountAfterCommissionUSDT','\x20USDT','values','getDate','yesterday','create','randomBytes','📊\x20Calculating\x20commission\x20manually\x20for\x20payment\x20','wallets','\x20\x20\x20⏳\x20Awaiting\x20payout:\x20','\x20order','\x20\x20\x20🌍\x20Country:\x20','pk_','🔍\x20Using\x20gateway\x20\x27','\x20\x20\x20👤\x20Merchant\x20earnings:\x20','dateFrom','orderId','⚠️\x20Payment\x20','Error\x20parsing\x20gateway\x20settings\x20for\x20payment\x20','📊\x20Sorting\x20payments\x20by\x20','merchantEarnings','\x20status:\x20','90d','\x20\x20\x20⏳\x20Pending\x20payout:\x20','🔧\x20[','\x20paid\x20payments\x20for\x20analysis','gte','./currencyService',',\x20Commission:\x20','periodFrom','convertToUSDT','availableBalance','🔄\x20Gateway\x20mapping:','merchantEarningsUSDT','$transaction',']\x20Password\x20not\x20provided\x20or\x20empty,\x20skipping\x20password\x20update','\x20USDT\x20(current\x20balance\x20in\x20DB)','Test\x20Gateway','amount','asc','commissionUSDT','sk_','customerUa','notes','\x20\x20\x20🔍\x20Calculated\x20after\x20commission:\x20','⚠️\x20Gateway\x20\x27','insensitive','cointopay2','customerCountry','292YCUmVi','CoinToPay',':\x20commission\x20=\x20','createUser','_sum','gatewayEarnings','paymentGateways','8Yklozx','getMerchantsSelection','custom','week','dailyRevenue','month','password','🔄\x20REFUND:\x20Payment\x20amount\x20already\x20deducted\x20from\x20balance','\x20\x20\x20💵\x20Available\x20balance:\x20','default',']\x20User\x20updated,\x20gatewaySettings\x20from\x20DB:','2020-01-01','Error\x20parsing\x20gateway\x20settings\x20for\x20shop\x20','awaitingPayout','\x20became\x20PAID:','\x20has\x20zero\x20or\x20null\x20amountUSDT,\x20skipping...','shop','groupBy','deleteUser','📊\x20[ADMIN]\x20Using\x20saved\x20amountAfterGatewayCommissionUSDT:\x20','getGatewayIdByName','erc20','\x20\x20\x20Merchant\x20gets:\x20','revenue','%\x20from\x20','\x20\x20\x20🤔\x20Difference:\x20','💳\x20Payout\x20wallet\x20for\x20','klyme_de','toISOString','gateways','\x20balance\x20updated:\x20','\x20USDT\x20(after\x20','0000','\x20USDT\x20(','💸\x20CHARGEBACK:\x20Merchant\x20amount\x20already\x20deducted\x20from\x20balance','currencyService','toFixed','\x20for\x20shop\x20','Payment\x20not\x20found','../config/database','entries','trc20','generateDailyStatistics','🎯\x20updateUser\x20called\x20with\x20ID:\x20','\x20\x20\x20Payout\x20amount:\x20','hash','averageCheckUSDT','localeCompare','\x20USDT\x20(+','dateTo','\x20merchants\x20with\x20positive\x20balance','💱\x20Currency\x20filter\x20applied:\x20','✅\x20Payout\x20created:\x20','klyme_eu','toUpperCase','getGatewayInternalName','💰\x20[PAYOUT]\x20Merchant\x20','amountAfterGatewayCommissionUSDT','3252193ZsPkgp','updateCustomerData','📊\x20Merchants\x20awaiting\x20payout:\x20','totalPaidOut','\x20USDT\x20(-','📊\x20Merchant\x20statistics\x20calculated:','klyme_gb','count','getGatewayNameById','length','suspendUser','\x27\x20->\x20name\x20\x27','getPayoutById','name','getFullYear','all','stringify','\x20\x20\x20Full\x20amount:\x20','toLowerCase','7489925JLBSQE','Username\x20already\x20exists','publicKey','polygon','Open\x20Banking\x202','662834rlBnCV','reduce','MasterCard','shopId','trim','externalPaymentUrl','\x20USDT\x20(theoretical\x20net)','not\x20specified','\x27\x20as\x20is\x20(not\x20found\x20in\x20mappings)','📋\x20Getting\x20merchants\x20selection\x20list...','getTime',']\x20Updating\x20password\x20for\x20user\x20','AdminService','\x20\x20\x20💰\x20Total\x20turnover:\x20','period','paidAt','getPayoutStats','day','💰\x20Found\x20','hex','⚠️\x20Requested\x20gateway\x20\x27','1779168QmpuoD','📊\x20Total\x20payments\x20(including\x20failed):\x20','usdtTrcWallet','totalCommissionRate','ACTIVE','balance','activateUser','telegram','🎯\x20[','totalAmountAfterCommissionUSDT','\x20\x20\x20🌐\x20IP:\x20','chargebackAmount','bcryptjs','\x27\x20(from\x20\x27','amountUSDT','💰\x20[PAYOUT]\x20Gateway\x20','findMany','customerIp','payment','createdAt','Error\x20processing\x20payment\x20','NONEXISTENT_GATEWAY_FILTER','gateway','usdtErcWallet','plisio','warn','statusChangedBy','txid','📅\x20Period:\x20','toString','💰\x20Creating\x20payout\x20for\x20shop\x20','totalAmountUSDT','🔄\x20Updating\x20customer\x20data\x20for\x20payment\x20','🔄\x20Converted\x20gateway\x20name\x20\x27','thisMonth','forEach','🔐\x20[','findFirst','join','🔄\x20Converted\x20gateway\x20ID\x20\x27','test_gateway','\x20\x20\x20Gateway:\x20','totalPayments','failUrl','\x20USDT\x20for\x20payment\x20','📊\x20Using\x20saved\x20values\x20for\x20payment\x20','turnover','defineProperty','cointopay','payout','\x20\x20\x20Current\x20total\x20paid\x20out:\x20','\x20\x20\x20Current\x20balance:\x20','KLYME\x20GB','updatePaymentStatus','error','\x20USDT,\x20Requested:\x20','set','getAllUsers','📊\x20Available\x20gateways\x20in\x20database:',']\x20Gateway\x20settings\x20before\x20saving:','telegramId','gatewaySettings','rapyd','Plisio','customerEmail','whiteUrl','REFUND','%\x20commission)','getMonth','\x27)\x20not\x20found\x20in\x20database,\x20returning\x20empty\x20result','\x20merchants','\x20in\x20','findUnique','Telegram\x20username\x20already\x20exists','PAID','split','customerName','\x20USDT,\x20merchant:\x20','Rapyd','__esModule','shopUrl','ceil','\x20\x20\x20Total\x20paid\x20out:\x20','log','network','currency','includes','📊\x20Payout\x20statistics\x20calculated:','\x27\x20not\x20found.\x20Available\x20gateways:\x20','\x20USDT\x20(calculated\x20-\x20payouts\x20-\x20balance)','status','failureMessage','date','dailyPayments','updateUser','merchantUrl','\x20USDT\x20from\x20balance','../types/gateway','💰\x20Payment\x20','78783wTZMBx','paymentsCount','totalPayout','\x20->\x20','update','periodTo','usdtPolygonWallet','\x20\x20\x20✅\x20Total\x20available\x20for\x20payout:\x20','getSystemStatistics','\x20missing\x20amountUSDT,\x20using\x20fallback\x20conversion','📊\x20Calculated\x20commission\x20rate\x20for\x20payment\x20','not\x20set','📋\x20Found\x20','693834LjTiRo'];a38_0x285a=function(){return _0x5976fc;};return a38_0x285a();}const database_1=__importDefault(require(a38_0x25a63d(0x1fa))),bcryptjs_1=__importDefault(require(a38_0x25a63d(0x246))),crypto_1=__importDefault(require(a38_0x25a63d(0x171))),currencyService_1=require(a38_0x25a63d(0x1b6)),gateway_1=require(a38_0x25a63d(0x15f));class AdminService{async[a38_0x25a63d(0x235)](){const _0x1a03c4=a38_0x25a63d;console[_0x1a03c4(0x151)]('📊\x20Calculating\x20payout\x20statistics...');const _0x3392be=await database_1[_0x1a03c4(0x1dc)]['shop'][_0x1a03c4(0x177)]({'_sum':{'balance':!![],'totalPaidOut':!![]},'where':{'status':_0x1a03c4(0x23e)}}),_0x1441cd=await database_1[_0x1a03c4(0x1dc)]['payment'][_0x1a03c4(0x214)]({'where':{'status':'PAID','gateway':{'not':'test_gateway'}}}),_0xe4708f=new Date(),_0xd3c0da=new Date(_0xe4708f[_0x1a03c4(0x21b)](),_0xe4708f[_0x1a03c4(0x142)](),0x1),_0x3922b5=new Date(_0xe4708f[_0x1a03c4(0x21b)](),_0xe4708f[_0x1a03c4(0x142)]()+0x1,0x0,0x17,0x3b,0x3b,0x3e7),_0x305819=await database_1['default']['payout'][_0x1a03c4(0x177)]({'_sum':{'amount':!![]},'where':{'createdAt':{'gte':_0xd3c0da,'lte':_0x3922b5},'status':'COMPLETED'}}),_0x557915=_0x3392be[_0x1a03c4(0x1d0)][_0x1a03c4(0x210)]||0x0,_0x2bf29c=_0x3392be['_sum'][_0x1a03c4(0x23f)]||0x0,_0x23010d=_0x305819[_0x1a03c4(0x1d0)]['amount']||0x0,_0x5342d8={'totalPayout':Math['round'](_0x557915*0x64)/0x64,'awaitingPayout':Math[_0x1a03c4(0x197)](_0x2bf29c*0x64)/0x64,'thisMonth':Math['round'](_0x23010d*0x64)/0x64,'availableBalance':Math[_0x1a03c4(0x197)](_0x2bf29c*0x64)/0x64,'totalPayments':_0x1441cd};return console['log'](_0x1a03c4(0x155)),console[_0x1a03c4(0x151)]('\x20\x20\x20💰\x20Total\x20payout:\x20'+_0x5342d8['totalPayout']+'\x20USDT\x20(total\x20paid\x20to\x20merchants)'),console[_0x1a03c4(0x151)](_0x1a03c4(0x1a4)+_0x5342d8[_0x1a03c4(0x1e0)]+'\x20USDT\x20(sum\x20of\x20all\x20merchant\x20balances)'),console[_0x1a03c4(0x151)](_0x1a03c4(0x1db)+_0x5342d8[_0x1a03c4(0x1ba)]+'\x20USDT\x20(same\x20as\x20awaiting)'),console['log'](_0x1a03c4(0x186)+_0x5342d8[_0x1a03c4(0x25c)]+_0x1a03c4(0x19c)),console[_0x1a03c4(0x151)]('\x20\x20\x20💳\x20Total\x20payments:\x20'+_0x5342d8[_0x1a03c4(0x128)]+_0x1a03c4(0x18a)),_0x5342d8;}async[a38_0x25a63d(0x20e)](_0x8cd9d3,_0x4c1164){const _0x1c6296=a38_0x25a63d;console[_0x1c6296(0x151)](_0x1c6296(0x25a)+_0x8cd9d3+':',_0x4c1164);const _0x210aa5=await database_1[_0x1c6296(0x1dc)]['payment'][_0x1c6296(0x146)]({'where':{'id':_0x8cd9d3},'select':{'id':!![],'customerEmail':!![],'customerName':!![],'customerCountry':!![],'customerIp':!![],'customerUa':!![]}});if(!_0x210aa5)throw new Error(_0x1c6296(0x1f9));const _0x3ee08a={};_0x4c1164[_0x1c6296(0x1cb)]!==undefined&&(_0x3ee08a['customerCountry']=_0x4c1164[_0x1c6296(0x1cb)]||null);_0x4c1164[_0x1c6296(0x24b)]!==undefined&&(_0x3ee08a[_0x1c6296(0x24b)]=_0x4c1164[_0x1c6296(0x24b)]||null);_0x4c1164[_0x1c6296(0x1c5)]!==undefined&&(_0x3ee08a[_0x1c6296(0x1c5)]=_0x4c1164[_0x1c6296(0x1c5)]||null);const _0x2365c7=await database_1[_0x1c6296(0x1dc)][_0x1c6296(0x24c)][_0x1c6296(0x165)]({'where':{'id':_0x8cd9d3},'data':{..._0x3ee08a,'updatedAt':new Date()},'select':{'id':!![],'customerEmail':!![],'customerName':!![],'customerCountry':!![],'customerIp':!![],'customerUa':!![],'updatedAt':!![]}});return console[_0x1c6296(0x151)]('✅\x20Customer\x20data\x20updated\x20for\x20payment\x20'+_0x8cd9d3),console[_0x1c6296(0x151)](_0x1c6296(0x1a6)+_0x210aa5[_0x1c6296(0x1cb)]+_0x1c6296(0x164)+_0x2365c7['customerCountry']),console[_0x1c6296(0x151)](_0x1c6296(0x244)+_0x210aa5[_0x1c6296(0x24b)]+_0x1c6296(0x164)+_0x2365c7['customerIp']),console[_0x1c6296(0x151)](_0x1c6296(0x188)+(_0x210aa5[_0x1c6296(0x1c5)]?_0x1c6296(0x136):_0x1c6296(0x16c))+_0x1c6296(0x164)+(_0x2365c7[_0x1c6296(0x1c5)]?_0x1c6296(0x136):'not\x20set')),_0x2365c7;}async[a38_0x25a63d(0x169)](_0x58156c){const _0x4d27ec=a38_0x25a63d,_0x72ada2=new Date();let _0x1080fc;switch(_0x58156c[_0x4d27ec(0x21f)]()){case _0x4d27ec(0x236):_0x1080fc=new Date(_0x72ada2[_0x4d27ec(0x21b)](),_0x72ada2[_0x4d27ec(0x142)](),_0x72ada2[_0x4d27ec(0x19e)](),0x0,0x0,0x0,0x0);break;case'yesterday':const _0x317b0f=new Date(_0x72ada2);_0x317b0f[_0x4d27ec(0x176)](_0x317b0f[_0x4d27ec(0x19e)]()-0x1),_0x1080fc=new Date(_0x317b0f[_0x4d27ec(0x21b)](),_0x317b0f[_0x4d27ec(0x142)](),_0x317b0f[_0x4d27ec(0x19e)](),0x0,0x0,0x0,0x0);break;case'7d':_0x1080fc=new Date(_0x72ada2[_0x4d27ec(0x22f)]()-0x7*0x18*0x3c*0x3c*0x3e8);break;case _0x4d27ec(0x172):_0x1080fc=new Date(_0x72ada2[_0x4d27ec(0x22f)]()-0x1e*0x18*0x3c*0x3c*0x3e8);break;case _0x4d27ec(0x1b1):_0x1080fc=new Date(_0x72ada2['getTime']()-0x5a*0x18*0x3c*0x3c*0x3e8);break;case _0x4d27ec(0x21c):const _0x136e7c=await database_1[_0x4d27ec(0x1dc)]['payment'][_0x4d27ec(0x123)]({'where':{'gateway':{'not':_0x4d27ec(0x126)}},'orderBy':{'createdAt':_0x4d27ec(0x1c2)},'select':{'createdAt':!![]}});_0x1080fc=_0x136e7c?_0x136e7c[_0x4d27ec(0x24d)]:new Date(_0x4d27ec(0x1de));break;default:_0x1080fc=new Date(_0x72ada2[_0x4d27ec(0x22f)]()-0x1e*0x18*0x3c*0x3c*0x3e8);}_0x1080fc[_0x4d27ec(0x183)](0x0,0x0,0x0,0x0);let _0x5ddd3c;if(_0x58156c[_0x4d27ec(0x21f)]()===_0x4d27ec(0x19f)){const _0x519ef0=new Date(_0x72ada2);_0x519ef0[_0x4d27ec(0x176)](_0x519ef0[_0x4d27ec(0x19e)]()-0x1),_0x5ddd3c=new Date(_0x519ef0[_0x4d27ec(0x21b)](),_0x519ef0['getMonth'](),_0x519ef0[_0x4d27ec(0x19e)](),0x17,0x3b,0x3b,0x3e7);}const _0x2d14fe={'gte':_0x1080fc};_0x5ddd3c&&(_0x2d14fe[_0x4d27ec(0x174)]=_0x5ddd3c);const [_0x9ed4e5,_0x47b0c0,_0x266c68,_0x5b37ce,_0x2c60a3,_0x37b4d6]=await Promise[_0x4d27ec(0x21c)]([database_1['default']['shop']['count'](),database_1[_0x4d27ec(0x1dc)]['shop'][_0x4d27ec(0x214)]({'where':{'status':'ACTIVE'}}),database_1[_0x4d27ec(0x1dc)][_0x4d27ec(0x24c)]['count']({'where':{'status':'PAID','createdAt':_0x2d14fe,'gateway':{'not':_0x4d27ec(0x126)}}}),database_1[_0x4d27ec(0x1dc)][_0x4d27ec(0x24c)][_0x4d27ec(0x24a)]({'where':{'status':_0x4d27ec(0x148),'createdAt':_0x2d14fe,'gateway':{'not':_0x4d27ec(0x126)}},'select':{'amount':!![],'currency':!![],'amountAfterGatewayCommissionUSDT':!![]}}),database_1['default'][_0x4d27ec(0x24c)][_0x4d27ec(0x24a)]({'where':{'gateway':{'not':_0x4d27ec(0x126)}},'take':0xa,'orderBy':{'createdAt':_0x4d27ec(0x178)},'include':{'shop':{'select':{'name':!![],'username':!![]}}}}),database_1[_0x4d27ec(0x1dc)][_0x4d27ec(0x24c)][_0x4d27ec(0x24a)]({'where':{'createdAt':_0x2d14fe,'gateway':{'not':_0x4d27ec(0x126)}},'select':{'amount':!![],'currency':!![],'status':!![],'amountUSDT':!![],'createdAt':!![]}})]);let _0xd88cf1=0x0,_0x2401cb=0x0;for(const _0x52f622 of _0x5b37ce){const _0x3e3e86=await currencyService_1['currencyService']['convertToUSDT'](_0x52f622['amount'],_0x52f622['currency']);_0xd88cf1+=_0x3e3e86;if(_0x52f622[_0x4d27ec(0x20c)]){const _0xdb9bd2=await currencyService_1[_0x4d27ec(0x1f6)][_0x4d27ec(0x1b9)](_0x52f622[_0x4d27ec(0x1c1)],_0x52f622[_0x4d27ec(0x153)]),_0x5a8253=_0x52f622['amountAfterGatewayCommissionUSDT'],_0x468aba=_0xdb9bd2-_0x5a8253;_0x2401cb+=_0x468aba;}}const _0x4206ec=_0x266c68>0x0?_0xd88cf1/_0x266c68:0x0,_0x20c38c=this[_0x4d27ec(0x1fd)](_0x37b4d6,_0x1080fc,_0x5ddd3c||_0x72ada2),_0x2d119b=await database_1['default'][_0x4d27ec(0x24c)][_0x4d27ec(0x214)]({'where':{'createdAt':_0x2d14fe,'gateway':{'not':'test_gateway'}}}),_0x1c38ff=_0x2d119b>0x0?_0x266c68/_0x2d119b*0x64:0x0;return{'totalShops':_0x9ed4e5,'activeShops':_0x47b0c0,'totalPayments':_0x266c68,'successfulPayments':_0x266c68,'totalAttempts':_0x2d119b,'totalRevenue':Math[_0x4d27ec(0x197)](_0xd88cf1*0x64)/0x64,'trapayEarnings':Math[_0x4d27ec(0x197)](_0x2401cb*0x64)/0x64,'averagePaymentAmount':Math[_0x4d27ec(0x197)](_0x4206ec*0x64)/0x64,'conversionRate':Math[_0x4d27ec(0x197)](_0x1c38ff*0x64)/0x64,'dailyRevenue':_0x20c38c[_0x4d27ec(0x1d7)],'dailyPayments':_0x20c38c[_0x4d27ec(0x15b)],'recentPayments':_0x2c60a3[_0x4d27ec(0x182)](_0xd9c661=>({'id':_0xd9c661['id'],'amount':_0xd9c661[_0x4d27ec(0x1c1)],'currency':_0xd9c661[_0x4d27ec(0x153)],'status':_0xd9c661['status'],'gateway':_0xd9c661[_0x4d27ec(0x250)],'shop':_0xd9c661['shop'],'createdAt':_0xd9c661['createdAt']}))};}async['getMerchantStatistics'](_0x364c8f){const _0x3f3ff3=a38_0x25a63d;console[_0x3f3ff3(0x151)](_0x3f3ff3(0x199),_0x364c8f);let _0x4a5a22,_0x22330a=new Date();if(_0x364c8f['period']===_0x3f3ff3(0x1d5)&&_0x364c8f[_0x3f3ff3(0x1aa)]&&_0x364c8f[_0x3f3ff3(0x204)])_0x4a5a22=new Date(_0x364c8f[_0x3f3ff3(0x1aa)]),_0x22330a=new Date(_0x364c8f[_0x3f3ff3(0x204)]),_0x4a5a22['setHours'](0x0,0x0,0x0,0x0),_0x22330a[_0x3f3ff3(0x183)](0x17,0x3b,0x3b,0x3e7);else{const _0x24d9d9=new Date();switch(_0x364c8f['period']){case _0x3f3ff3(0x1d6):_0x4a5a22=new Date(_0x24d9d9['getTime']()-0x7*0x18*0x3c*0x3c*0x3e8);break;case _0x3f3ff3(0x1d8):_0x4a5a22=new Date(_0x24d9d9['getTime']()-0x1e*0x18*0x3c*0x3c*0x3e8);break;case'year':_0x4a5a22=new Date(_0x24d9d9[_0x3f3ff3(0x22f)]()-0x16d*0x18*0x3c*0x3c*0x3e8);break;case _0x3f3ff3(0x21c):default:_0x4a5a22=new Date(_0x3f3ff3(0x1de));break;}_0x4a5a22[_0x3f3ff3(0x183)](0x0,0x0,0x0,0x0),_0x22330a[_0x3f3ff3(0x183)](0x17,0x3b,0x3b,0x3e7);}console['log'](_0x3f3ff3(0x256)+_0x4a5a22[_0x3f3ff3(0x1ef)]()+'\x20to\x20'+_0x22330a[_0x3f3ff3(0x1ef)]());const _0x47fbda={'status':_0x3f3ff3(0x148),'gateway':{'not':_0x3f3ff3(0x126)},'paidAt':{'gte':_0x4a5a22,'lte':_0x22330a}};_0x364c8f[_0x3f3ff3(0x228)]&&(_0x47fbda[_0x3f3ff3(0x228)]=_0x364c8f['shopId']);const _0x23ece6=await database_1[_0x3f3ff3(0x1dc)][_0x3f3ff3(0x24c)][_0x3f3ff3(0x24a)]({'where':_0x47fbda,'select':{'id':!![],'amount':!![],'currency':!![],'amountUSDT':!![],'amountAfterGatewayCommissionUSDT':!![],'gatewayCommissionRate':!![],'gateway':!![],'shopId':!![],'paidAt':!![],'shop':{'select':{'id':!![],'name':!![],'username':!![],'gatewaySettings':!![]}}}});console[_0x3f3ff3(0x151)]('💰\x20Found\x20'+_0x23ece6[_0x3f3ff3(0x216)]+_0x3f3ff3(0x1b4));const _0x4b1e54={'gateway':{'not':_0x3f3ff3(0x126)},'createdAt':{'gte':_0x4a5a22,'lte':_0x22330a}};_0x364c8f['shopId']&&(_0x4b1e54[_0x3f3ff3(0x228)]=_0x364c8f[_0x3f3ff3(0x228)]);const _0x5ddc35=await database_1[_0x3f3ff3(0x1dc)][_0x3f3ff3(0x24c)]['count']({'where':_0x4b1e54});console['log'](_0x3f3ff3(0x23b)+_0x5ddc35+_0x3f3ff3(0x17e)+_0x23ece6[_0x3f3ff3(0x216)]);let _0x314a75=0x0,_0x7e4f53=0x0,_0x234cdb=0x0;const _0x1dbf03={},_0xc4d77b={},_0x2df5fc={};for(const _0x508d1f of _0x23ece6){try{const _0x192ad5=_0x508d1f[_0x3f3ff3(0x248)]||0x0;if(_0x192ad5<=0x0){console[_0x3f3ff3(0x253)](_0x3f3ff3(0x1ac)+_0x508d1f['id']+_0x3f3ff3(0x1e2));continue;}let _0x5b556f,_0x140538;if(_0x508d1f[_0x3f3ff3(0x20c)]!==null&&_0x508d1f[_0x3f3ff3(0x20c)]!==undefined)_0x5b556f=_0x508d1f[_0x3f3ff3(0x20c)],_0x140538=_0x192ad5-_0x5b556f,console[_0x3f3ff3(0x151)](_0x3f3ff3(0x12b)+_0x508d1f['id']+':\x20'+_0x192ad5['toFixed'](0x6)+_0x3f3ff3(0x14b)+_0x5b556f['toFixed'](0x6)+_0x3f3ff3(0x19c));else{let _0x4e0ecb={};if(_0x508d1f[_0x3f3ff3(0x1e3)][_0x3f3ff3(0x13b)])try{_0x4e0ecb=JSON[_0x3f3ff3(0x190)](_0x508d1f[_0x3f3ff3(0x1e3)][_0x3f3ff3(0x13b)]);}catch(_0xace660){console[_0x3f3ff3(0x134)](_0x3f3ff3(0x1df)+_0x508d1f[_0x3f3ff3(0x228)]+':',_0xace660);}let _0x263247=0x2d;for(const [_0x1b7979,_0xaf7991]of Object[_0x3f3ff3(0x1fb)](_0x4e0ecb)){if(_0x1b7979[_0x3f3ff3(0x21f)]()===_0x508d1f[_0x3f3ff3(0x250)][_0x3f3ff3(0x21f)]()){_0x263247=_0xaf7991['commission']||0x2d;break;}}_0x140538=_0x192ad5*(_0x263247/0x64),_0x5b556f=_0x192ad5-_0x140538,console[_0x3f3ff3(0x151)](_0x3f3ff3(0x1a2)+_0x508d1f['id']+':\x20'+_0x263247+_0x3f3ff3(0x1eb)+_0x192ad5[_0x3f3ff3(0x1f7)](0x6)+_0x3f3ff3(0x19c));}_0x314a75+=_0x192ad5,_0x7e4f53+=_0x5b556f,_0x234cdb+=_0x140538;let _0x316b58;_0x508d1f['gatewayCommissionRate']!==null&&_0x508d1f[_0x3f3ff3(0x19a)]!==undefined?(_0x316b58=_0x508d1f['gatewayCommissionRate'],console[_0x3f3ff3(0x151)](_0x3f3ff3(0x18d)+_0x508d1f['id']+':\x20'+_0x316b58+'%')):(_0x316b58=_0x192ad5>0x0?_0x140538/_0x192ad5*0x64:0x0,console[_0x3f3ff3(0x151)](_0x3f3ff3(0x16b)+_0x508d1f['id']+':\x20'+_0x316b58[_0x3f3ff3(0x1f7)](0x2)+'%'));!_0x1dbf03[_0x508d1f[_0x3f3ff3(0x250)]]&&(_0x1dbf03[_0x508d1f[_0x3f3ff3(0x250)]]={'gateway':_0x508d1f['gateway'],'gatewayDisplayName':this['getGatewayDisplayName'](_0x508d1f['gateway']),'paymentsCount':0x0,'turnoverUSDT':0x0,'commissionUSDT':0x0,'merchantEarningsUSDT':0x0,'totalCommissionRate':0x0});_0x1dbf03[_0x508d1f['gateway']][_0x3f3ff3(0x162)]++,_0x1dbf03[_0x508d1f[_0x3f3ff3(0x250)]][_0x3f3ff3(0x17f)]+=_0x192ad5,_0x1dbf03[_0x508d1f['gateway']]['commissionUSDT']+=_0x140538,_0x1dbf03[_0x508d1f[_0x3f3ff3(0x250)]]['merchantEarningsUSDT']+=_0x5b556f,_0x1dbf03[_0x508d1f[_0x3f3ff3(0x250)]]['totalCommissionRate']+=_0x316b58;!_0x364c8f[_0x3f3ff3(0x228)]&&(!_0xc4d77b[_0x508d1f[_0x3f3ff3(0x228)]]&&(_0xc4d77b[_0x508d1f[_0x3f3ff3(0x228)]]={'shopId':_0x508d1f['shopId'],'shopName':_0x508d1f['shop'][_0x3f3ff3(0x21a)],'shopUsername':_0x508d1f['shop']['username'],'paymentsCount':0x0,'turnoverUSDT':0x0,'commissionUSDT':0x0,'merchantEarningsUSDT':0x0,'paidOutUSDT':0x0,'averageCheckUSDT':0x0}),_0xc4d77b[_0x508d1f[_0x3f3ff3(0x228)]][_0x3f3ff3(0x162)]++,_0xc4d77b[_0x508d1f[_0x3f3ff3(0x228)]]['turnoverUSDT']+=_0x192ad5,_0xc4d77b[_0x508d1f[_0x3f3ff3(0x228)]][_0x3f3ff3(0x1c3)]+=_0x140538,_0xc4d77b[_0x508d1f[_0x3f3ff3(0x228)]]['merchantEarningsUSDT']+=_0x5b556f);const _0x177d17=_0x508d1f['paidAt']['toISOString']()[_0x3f3ff3(0x149)]('T')[0x0];!_0x2df5fc[_0x177d17]&&(_0x2df5fc[_0x177d17]={'date':_0x177d17,'turnover':0x0,'merchantEarnings':0x0,'gatewayEarnings':0x0,'paymentsCount':0x0}),_0x2df5fc[_0x177d17][_0x3f3ff3(0x12c)]+=_0x192ad5,_0x2df5fc[_0x177d17][_0x3f3ff3(0x1af)]+=_0x5b556f,_0x2df5fc[_0x177d17][_0x3f3ff3(0x1d1)]+=_0x140538,_0x2df5fc[_0x177d17][_0x3f3ff3(0x162)]++;}catch(_0x313fc4){console[_0x3f3ff3(0x134)](_0x3f3ff3(0x24e)+_0x508d1f['id']+':',_0x313fc4);}}Object['values'](_0x1dbf03)['forEach'](_0x5e82c9=>{const _0x21f0d8=_0x3f3ff3;_0x5e82c9['averageCommissionRate']=_0x5e82c9[_0x21f0d8(0x162)]>0x0?_0x5e82c9[_0x21f0d8(0x23d)]/_0x5e82c9['paymentsCount']:0x0,delete _0x5e82c9[_0x21f0d8(0x23d)];}),Object[_0x3f3ff3(0x19d)](_0xc4d77b)[_0x3f3ff3(0x25d)](_0x57f89e=>{const _0x297c09=_0x3f3ff3;_0x57f89e[_0x297c09(0x201)]=_0x57f89e['paymentsCount']>0x0?_0x57f89e['turnoverUSDT']/_0x57f89e[_0x297c09(0x162)]:0x0;});let _0x41917b=0x0,_0x4f68ce=0x0;if(_0x364c8f[_0x3f3ff3(0x228)]){const _0x928488=await database_1['default']['payout']['findMany']({'where':{'shopId':_0x364c8f[_0x3f3ff3(0x228)],'status':'COMPLETED','createdAt':{'gte':_0x4a5a22,'lte':_0x22330a}},'select':{'amount':!![]}});_0x41917b=_0x928488[_0x3f3ff3(0x226)]((_0x2bbd2b,_0x3d4bf6)=>_0x2bbd2b+_0x3d4bf6[_0x3f3ff3(0x1c1)],0x0);const _0x5afad9=await database_1[_0x3f3ff3(0x1dc)][_0x3f3ff3(0x12f)][_0x3f3ff3(0x24a)]({'where':{'shopId':_0x364c8f[_0x3f3ff3(0x228)],'status':'PENDING','createdAt':{'gte':_0x4a5a22,'lte':_0x22330a}},'select':{'amount':!![]}});_0x4f68ce=_0x5afad9[_0x3f3ff3(0x226)]((_0x1823f0,_0x465588)=>_0x1823f0+_0x465588[_0x3f3ff3(0x1c1)],0x0);}const _0x28a7fa=_0x5ddc35,_0x534a75=_0x23ece6['length'],_0x4949c2=_0x534a75>0x0?_0x314a75/_0x534a75:0x0,_0x12dee2=_0x28a7fa>0x0?Math[_0x3f3ff3(0x197)](_0x534a75/_0x28a7fa*0x2710)/0x64:0x0,_0x4bb68c=Math[_0x3f3ff3(0x14f)]((_0x22330a[_0x3f3ff3(0x22f)]()-_0x4a5a22[_0x3f3ff3(0x22f)]())/(0x3e8*0x3c*0x3c*0x18)),_0x4750f2={'totalTurnover':Math[_0x3f3ff3(0x197)](_0x314a75*0x64)/0x64,'merchantEarnings':Math['round'](_0x7e4f53*0x64)/0x64,'gatewayEarnings':Math[_0x3f3ff3(0x197)](_0x234cdb*0x64)/0x64,'totalPaidOut':Math[_0x3f3ff3(0x197)](_0x41917b*0x64)/0x64,'pendingPayout':Math[_0x3f3ff3(0x197)](_0x4f68ce*0x64)/0x64,'averageCheck':Math[_0x3f3ff3(0x197)](_0x4949c2*0x64)/0x64,'totalPayments':_0x28a7fa,'successfulPayments':_0x534a75,'conversionRate':_0x12dee2,'gatewayBreakdown':Object['values'](_0x1dbf03)[_0x3f3ff3(0x182)](_0x11a7ef=>({..._0x11a7ef,'turnoverUSDT':Math['round'](_0x11a7ef[_0x3f3ff3(0x17f)]*0x64)/0x64,'commissionUSDT':Math[_0x3f3ff3(0x197)](_0x11a7ef['commissionUSDT']*0x64)/0x64,'merchantEarningsUSDT':Math[_0x3f3ff3(0x197)](_0x11a7ef[_0x3f3ff3(0x1bc)]*0x64)/0x64,'averageCommissionRate':Math[_0x3f3ff3(0x197)](_0x11a7ef['averageCommissionRate']*0x64)/0x64})),'merchantBreakdown':_0x364c8f[_0x3f3ff3(0x228)]?undefined:Object['values'](_0xc4d77b)['map'](_0x594f6d=>({..._0x594f6d,'turnoverUSDT':Math[_0x3f3ff3(0x197)](_0x594f6d['turnoverUSDT']*0x64)/0x64,'commissionUSDT':Math[_0x3f3ff3(0x197)](_0x594f6d[_0x3f3ff3(0x1c3)]*0x64)/0x64,'merchantEarningsUSDT':Math[_0x3f3ff3(0x197)](_0x594f6d['merchantEarningsUSDT']*0x64)/0x64,'paidOutUSDT':Math[_0x3f3ff3(0x197)](_0x594f6d['paidOutUSDT']*0x64)/0x64,'averageCheckUSDT':Math['round'](_0x594f6d[_0x3f3ff3(0x201)]*0x64)/0x64})),'dailyData':Object[_0x3f3ff3(0x19d)](_0x2df5fc)['map'](_0x5a1a4e=>({..._0x5a1a4e,'turnover':Math[_0x3f3ff3(0x197)](_0x5a1a4e['turnover']*0x64)/0x64,'merchantEarnings':Math['round'](_0x5a1a4e[_0x3f3ff3(0x1af)]*0x64)/0x64,'gatewayEarnings':Math[_0x3f3ff3(0x197)](_0x5a1a4e[_0x3f3ff3(0x1d1)]*0x64)/0x64}))[_0x3f3ff3(0x173)]((_0x2f8d5b,_0x488d54)=>_0x2f8d5b[_0x3f3ff3(0x15a)][_0x3f3ff3(0x202)](_0x488d54[_0x3f3ff3(0x15a)])),'periodInfo':{'from':_0x4a5a22,'to':_0x22330a,'periodType':_0x364c8f[_0x3f3ff3(0x233)]||_0x3f3ff3(0x1d5),'daysCount':_0x4bb68c}};return console[_0x3f3ff3(0x151)](_0x3f3ff3(0x212)),console[_0x3f3ff3(0x151)](_0x3f3ff3(0x232)+_0x4750f2[_0x3f3ff3(0x189)]+'\x20USDT'),console[_0x3f3ff3(0x151)](_0x3f3ff3(0x1a9)+_0x4750f2[_0x3f3ff3(0x1af)]+'\x20USDT'),console[_0x3f3ff3(0x151)]('\x20\x20\x20🏪\x20Gateway\x20earnings:\x20'+_0x4750f2['gatewayEarnings']+'\x20USDT'),console[_0x3f3ff3(0x151)](_0x3f3ff3(0x187)+_0x4750f2['totalPaidOut']+_0x3f3ff3(0x19c)),console[_0x3f3ff3(0x151)](_0x3f3ff3(0x1b2)+_0x4750f2['pendingPayout']+_0x3f3ff3(0x19c)),console[_0x3f3ff3(0x151)]('\x20\x20\x20�📊\x20Total\x20payments:\x20'+_0x4750f2[_0x3f3ff3(0x128)]),_0x4750f2;}async[a38_0x25a63d(0x1d4)](){const _0x18214=a38_0x25a63d;console[_0x18214(0x151)](_0x18214(0x22e));const _0x4fa5d5=await database_1[_0x18214(0x1dc)][_0x18214(0x1e3)][_0x18214(0x24a)]({'where':{'status':_0x18214(0x23e)},'select':{'id':!![],'username':!![],'name':!![]},'orderBy':{'name':_0x18214(0x1c2)}});return console['log'](_0x18214(0x16d)+_0x4fa5d5[_0x18214(0x216)]+_0x18214(0x18f)),_0x4fa5d5[_0x18214(0x182)](_0xadff67=>({'id':_0xadff67['id'],'username':_0xadff67[_0x18214(0x184)],'name':_0xadff67[_0x18214(0x21a)]}));}[a38_0x25a63d(0x185)](_0x3c4954){const _0x3fcd=a38_0x25a63d,_0x456983={'test_gateway':_0x3fcd(0x1c0),'plisio':_0x3fcd(0x13d),'rapyd':_0x3fcd(0x14c),'noda':'Noda','cointopay':_0x3fcd(0x1cd),'cointopay2':_0x3fcd(0x224),'klyme_eu':'KLYME\x20EU','klyme_gb':_0x3fcd(0x132),'klyme_de':'KLYME\x20DE','mastercard':_0x3fcd(0x227)};return _0x456983[_0x3c4954]||_0x3c4954;}['getGatewayInternalName'](_0x3bcb19){const _0x3e325b=a38_0x25a63d,_0x50afde={'Test\x20Gateway':_0x3e325b(0x126),'Plisio':_0x3e325b(0x252),'Rapyd':_0x3e325b(0x13c),'Noda':'noda','CoinToPay':_0x3e325b(0x12e),'CoinToPay2':_0x3e325b(0x1ca),'KLYME\x20EU':_0x3e325b(0x208),'KLYME\x20GB':_0x3e325b(0x213),'KLYME\x20DE':_0x3e325b(0x1ee),'MasterCard':'mastercard'};return _0x50afde[_0x3bcb19]||_0x3bcb19['toLowerCase']();}async['getMerchantsAwaitingPayout'](_0x3cc7a4){const _0xf7053=a38_0x25a63d,{page:_0x370a90,limit:_0x131bb1,minAmount:_0x2c6a9b,search:_0x570f32}=_0x3cc7a4,_0x38aedf=(_0x370a90-0x1)*_0x131bb1;console['log']('📊\x20Getting\x20merchants\x20awaiting\x20payout\x20with\x20filters:',_0x3cc7a4);const _0xe12ead={'balance':{'gt':0x0},'status':_0xf7053(0x23e)};_0x2c6a9b&&(_0xe12ead['balance'][_0xf7053(0x1b5)]=_0x2c6a9b);_0x570f32&&(_0xe12ead['name']={'contains':_0x570f32,'mode':_0xf7053(0x1c9)});const [_0x2e4466,_0x35f478]=await Promise[_0xf7053(0x21c)]([database_1['default'][_0xf7053(0x1e3)][_0xf7053(0x24a)]({'where':_0xe12ead,'skip':_0x38aedf,'take':_0x131bb1,'orderBy':{'balance':_0xf7053(0x178)},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'balance':!![],'totalPaidOut':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'usdcErcWallet':!![],'gatewaySettings':!![],'createdAt':!![]}}),database_1[_0xf7053(0x1dc)][_0xf7053(0x1e3)][_0xf7053(0x214)]({'where':_0xe12ead})]);console[_0xf7053(0x151)](_0xf7053(0x237)+_0x2e4466['length']+_0xf7053(0x205));const _0x3b5fc1=await Promise[_0xf7053(0x21c)](_0x2e4466[_0xf7053(0x182)](async _0x19bf4b=>{const _0x4d9992=_0xf7053,[_0x48ae33,_0x382794,_0x2e603a]=await Promise['all']([database_1[_0x4d9992(0x1dc)][_0x4d9992(0x24c)][_0x4d9992(0x214)]({'where':{'shopId':_0x19bf4b['id'],'status':_0x4d9992(0x148),'gateway':{'not':_0x4d9992(0x126)}}}),database_1['default'][_0x4d9992(0x24c)]['findFirst']({'where':{'shopId':_0x19bf4b['id'],'status':_0x4d9992(0x148),'gateway':{'not':_0x4d9992(0x126)}},'orderBy':{'paidAt':'asc'},'select':{'paidAt':!![]}}),database_1[_0x4d9992(0x1dc)][_0x4d9992(0x24c)][_0x4d9992(0x1e4)]({'by':[_0x4d9992(0x250)],'where':{'shopId':_0x19bf4b['id'],'status':_0x4d9992(0x148),'gateway':{'not':'test_gateway'}},'_count':{'id':!![]},'_sum':{'amountUSDT':!![]}})]),_0xd06f6e=new Date(),_0x5934ba=new Date(_0xd06f6e[_0x4d9992(0x21b)](),_0xd06f6e[_0x4d9992(0x142)](),0x1),_0x697568=new Date(_0xd06f6e[_0x4d9992(0x21b)](),_0xd06f6e['getMonth']()+0x1,0x0,0x17,0x3b,0x3b,0x3e7),[_0x5c1dbd,_0xaf9ef8]=await Promise[_0x4d9992(0x21c)]([database_1[_0x4d9992(0x1dc)][_0x4d9992(0x12f)]['aggregate']({'_sum':{'amount':!![]},'where':{'shopId':_0x19bf4b['id'],'status':_0x4d9992(0x198)}}),database_1[_0x4d9992(0x1dc)]['payout']['aggregate']({'_sum':{'amount':!![]},'where':{'shopId':_0x19bf4b['id'],'status':_0x4d9992(0x198),'createdAt':{'gte':_0x5934ba,'lte':_0x697568}}})]),_0xb0beca=_0x5c1dbd[_0x4d9992(0x1d0)]['amount']||0x0,_0x37c51a=_0xaf9ef8[_0x4d9992(0x1d0)][_0x4d9992(0x1c1)]||0x0,_0x217ca4=await Promise[_0x4d9992(0x21c)](_0x2e603a[_0x4d9992(0x182)](async _0x106696=>{const _0x431b40=_0x4d9992;let _0x17f41f=0x2d;if(_0x19bf4b[_0x431b40(0x13b)])try{const _0x568df2=JSON[_0x431b40(0x190)](_0x19bf4b[_0x431b40(0x13b)]);for(const [_0x2fd9d7,_0x3c14c9]of Object[_0x431b40(0x1fb)](_0x568df2)){if(_0x2fd9d7[_0x431b40(0x21f)]()===_0x106696['gateway'][_0x431b40(0x21f)]()){_0x17f41f=_0x3c14c9[_0x431b40(0x191)]||0xa,console[_0x431b40(0x151)](_0x431b40(0x249)+_0x106696['gateway']+_0x431b40(0x1f8)+_0x19bf4b['id']+_0x431b40(0x1ce)+_0x17f41f+'%');break;}}}catch(_0x53021e){console[_0x431b40(0x134)](_0x431b40(0x1df)+_0x19bf4b['id']+':',_0x53021e);}const _0x47d1bf=_0x106696[_0x431b40(0x1d0)]?.[_0x431b40(0x248)]||0x0,_0x36ee8c=_0x47d1bf*(0x1-_0x17f41f/0x64);return{'gateway':_0x106696[_0x431b40(0x250)],'count':_0x106696['_count']?.['id']||0x0,'amountUSDT':Math[_0x431b40(0x197)](_0x47d1bf*0x64)/0x64,'amountAfterCommissionUSDT':Math[_0x431b40(0x197)](_0x36ee8c*0x64)/0x64,'commission':_0x17f41f};})),_0x20bdce=_0x217ca4[_0x4d9992(0x226)]((_0xedb100,_0x3c6731)=>_0xedb100+_0x3c6731['amountUSDT'],0x0),_0x5c2382=_0x217ca4[_0x4d9992(0x226)]((_0x48da9a,_0x2e7870)=>_0x48da9a+_0x2e7870[_0x4d9992(0x19b)],0x0),_0x5e5115=_0x19bf4b['balance'];return console[_0x4d9992(0x151)](_0x4d9992(0x20b)+_0x19bf4b[_0x4d9992(0x184)]+':'),console[_0x4d9992(0x151)](_0x4d9992(0x18e)+_0x20bdce['toFixed'](0x2)+_0x4d9992(0x18c)),console['log'](_0x4d9992(0x1c7)+_0x5c2382[_0x4d9992(0x1f7)](0x2)+_0x4d9992(0x22b)),console[_0x4d9992(0x151)](_0x4d9992(0x196)+_0x5e5115[_0x4d9992(0x1f7)](0x2)+_0x4d9992(0x1bf)),console['log']('\x20\x20\x20💸\x20Total\x20payouts:\x20'+_0xb0beca[_0x4d9992(0x1f7)](0x2)+'\x20USDT\x20(already\x20paid\x20out)'),console[_0x4d9992(0x151)](_0x4d9992(0x1ec)+(_0x5c2382-_0xb0beca-_0x5e5115)['toFixed'](0x2)+_0x4d9992(0x157)),{'id':_0x19bf4b['id'],'fullName':_0x19bf4b[_0x4d9992(0x21a)],'username':_0x19bf4b['username'],'telegramId':_0x19bf4b['telegram'],'merchantUrl':_0x19bf4b['shopUrl'],'wallets':{'usdtPolygonWallet':_0x19bf4b['usdtPolygonWallet'],'usdtTrcWallet':_0x19bf4b[_0x4d9992(0x23c)],'usdtErcWallet':_0x19bf4b[_0x4d9992(0x251)],'usdcPolygonWallet':_0x19bf4b['usdcPolygonWallet'],'usdcErcWallet':_0x19bf4b[_0x4d9992(0x170)]},'totalAmountUSDT':Math[_0x4d9992(0x197)](_0x20bdce*0x64)/0x64,'totalAmountAfterCommissionUSDT':Math['round'](_0x5c2382*0x64)/0x64,'currentBalance':Math['round'](_0x5e5115*0x64)/0x64,'totalPayout':Math['round'](_0xb0beca*0x64)/0x64,'thisMonth':Math[_0x4d9992(0x197)](_0x37c51a*0x64)/0x64,'paymentsCount':_0x48ae33,'oldestPaymentDate':_0x382794?.[_0x4d9992(0x234)]||_0x19bf4b[_0x4d9992(0x24d)],'gatewayBreakdown':_0x217ca4};})),_0x3cfc2d=_0x3b5fc1[_0xf7053(0x226)]((_0x1ea53c,_0x15ccdf)=>_0x1ea53c+_0x15ccdf[_0xf7053(0x259)],0x0),_0x32923c=_0x3b5fc1['reduce']((_0x5d0f57,_0x23cac1)=>_0x5d0f57+_0x23cac1[_0xf7053(0x243)],0x0),_0x24112b=_0x3b5fc1[_0xf7053(0x226)]((_0x4be454,_0x3292dc)=>_0x4be454+_0x3292dc[_0xf7053(0x163)],0x0),_0x232d63=_0x3b5fc1[_0xf7053(0x226)]((_0x48f57e,_0x17cc91)=>_0x48f57e+_0x17cc91['thisMonth'],0x0);return console[_0xf7053(0x151)](_0xf7053(0x20f)+_0x35f478+_0xf7053(0x144)),console['log'](_0xf7053(0x179)+Math['round'](_0x3cfc2d*0x64)/0x64+_0xf7053(0x18c)),console[_0xf7053(0x151)](_0xf7053(0x168)+Math['round'](_0x32923c*0x64)/0x64+'\x20USDT\x20(actual\x20balances)'),console[_0xf7053(0x151)](_0xf7053(0x18b)+Math[_0xf7053(0x197)](_0x24112b*0x64)/0x64+_0xf7053(0x19c)),console['log']('\x20\x20\x20📅\x20Total\x20payouts\x20(this\x20month):\x20'+Math[_0xf7053(0x197)](_0x232d63*0x64)/0x64+_0xf7053(0x19c)),{'merchants':_0x3b5fc1,'pagination':{'page':_0x370a90,'limit':_0x131bb1,'total':_0x35f478,'totalPages':Math[_0xf7053(0x14f)](_0x35f478/_0x131bb1)},'summary':{'totalMerchants':_0x35f478,'totalAmountUSDT':Math['round'](_0x3cfc2d*0x64)/0x64,'totalAmountAfterCommissionUSDT':Math[_0xf7053(0x197)](_0x32923c*0x64)/0x64,'totalPayout':Math[_0xf7053(0x197)](_0x24112b*0x64)/0x64,'thisMonth':Math[_0xf7053(0x197)](_0x232d63*0x64)/0x64}};}async['createPayout'](_0x5e6286){const _0x4660b6=a38_0x25a63d,{shopId:_0x4aa239,amount:_0x40dedc,network:_0x1ef160,wallet:_0x354e3c,notes:_0x47369f,txid:_0x4bbb94,periodFrom:_0x1681db,periodTo:_0x1f0210}=_0x5e6286,_0x2a20af=await database_1[_0x4660b6(0x1dc)][_0x4660b6(0x1bd)](async _0x1811d1=>{const _0x502726=_0x4660b6,_0x2b56ca=await _0x1811d1[_0x502726(0x1e3)][_0x502726(0x146)]({'where':{'id':_0x4aa239},'select':{'id':!![],'name':!![],'username':!![],'balance':!![],'totalPaidOut':!![]}});if(!_0x2b56ca)throw new Error('Shop\x20not\x20found');console[_0x502726(0x151)](_0x502726(0x258)+_0x2b56ca[_0x502726(0x184)]+':'),console[_0x502726(0x151)](_0x502726(0x131)+_0x2b56ca[_0x502726(0x23f)][_0x502726(0x1f7)](0x6)+_0x502726(0x19c)),console[_0x502726(0x151)](_0x502726(0x1ff)+_0x40dedc[_0x502726(0x1f7)](0x6)+_0x502726(0x19c)),console[_0x502726(0x151)](_0x502726(0x130)+_0x2b56ca[_0x502726(0x210)][_0x502726(0x1f7)](0x6)+_0x502726(0x19c));if(_0x4bbb94)console[_0x502726(0x151)](_0x502726(0x17a)+_0x4bbb94);if(_0x2b56ca['balance']<_0x40dedc)throw new Error('Insufficient\x20balance.\x20Available:\x20'+_0x2b56ca[_0x502726(0x23f)][_0x502726(0x1f7)](0x6)+_0x502726(0x135)+_0x40dedc[_0x502726(0x1f7)](0x6)+_0x502726(0x19c));let _0x31a602=_0x354e3c;if(!_0x31a602){const _0x5abf51=await _0x1811d1['shop'][_0x502726(0x146)]({'where':{'id':_0x4aa239},'select':{'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'usdcErcWallet':!![]}});if(_0x5abf51)switch(_0x1ef160){case _0x502726(0x223):_0x31a602=_0x5abf51[_0x502726(0x167)]||undefined;break;case _0x502726(0x1fc):_0x31a602=_0x5abf51[_0x502726(0x23c)]||undefined;break;case _0x502726(0x1e8):_0x31a602=_0x5abf51[_0x502726(0x251)]||undefined;break;case'polygon_usdc':_0x31a602=_0x5abf51[_0x502726(0x175)]||undefined;break;case'erc20_usdc':_0x31a602=_0x5abf51[_0x502726(0x170)]||undefined;break;}}console[_0x502726(0x151)](_0x502726(0x1ed)+_0x1ef160+':\x20'+(_0x31a602||_0x502726(0x22c)));const _0x433d0b=await _0x1811d1[_0x502726(0x12f)]['create']({'data':{'shopId':_0x4aa239,'amount':_0x40dedc,'network':_0x1ef160,'status':_0x502726(0x198),'txid':_0x4bbb94,'notes':_0x47369f,'periodFrom':_0x1681db?new Date(_0x1681db):null,'periodTo':_0x1f0210?new Date(_0x1f0210):null,'createdAt':new Date(),'paidAt':new Date()}}),_0x2c827f=_0x2b56ca[_0x502726(0x23f)]-_0x40dedc,_0x71b8bf=_0x2b56ca['totalPaidOut']+_0x40dedc;return await _0x1811d1[_0x502726(0x1e3)][_0x502726(0x165)]({'where':{'id':_0x4aa239},'data':{'balance':_0x2c827f,'totalPaidOut':_0x71b8bf}}),console[_0x502726(0x151)]('💰\x20Shop\x20'+_0x2b56ca[_0x502726(0x184)]+_0x502726(0x192)),console['log']('\x20\x20\x20Balance:\x20'+_0x2b56ca[_0x502726(0x23f)][_0x502726(0x1f7)](0x6)+_0x502726(0x164)+_0x2c827f[_0x502726(0x1f7)](0x6)+_0x502726(0x211)+_0x40dedc[_0x502726(0x1f7)](0x6)+')'),console[_0x502726(0x151)](_0x502726(0x150)+_0x2b56ca[_0x502726(0x210)]['toFixed'](0x6)+'\x20->\x20'+_0x71b8bf['toFixed'](0x6)+_0x502726(0x203)+_0x40dedc['toFixed'](0x6)+')'),{'payout':_0x433d0b,'shop':_0x2b56ca};});return console[_0x4660b6(0x151)](_0x4660b6(0x207)+_0x2a20af[_0x4660b6(0x12f)]['id']+'\x20for\x20shop\x20'+_0x2a20af[_0x4660b6(0x1e3)]['username']+'\x20('+_0x40dedc+'\x20USDT)'),{'id':_0x2a20af[_0x4660b6(0x12f)]['id'],'shopId':_0x2a20af[_0x4660b6(0x12f)][_0x4660b6(0x228)],'shopName':_0x2a20af[_0x4660b6(0x1e3)][_0x4660b6(0x21a)],'shopUsername':_0x2a20af[_0x4660b6(0x1e3)][_0x4660b6(0x184)],'amount':_0x2a20af['payout'][_0x4660b6(0x1c1)],'network':_0x2a20af['payout']['network'],'status':_0x2a20af[_0x4660b6(0x12f)]['status'],'txid':_0x2a20af[_0x4660b6(0x12f)][_0x4660b6(0x255)],'notes':_0x2a20af[_0x4660b6(0x12f)][_0x4660b6(0x1c6)],'periodFrom':_0x2a20af['payout']['periodFrom'],'periodTo':_0x2a20af[_0x4660b6(0x12f)][_0x4660b6(0x166)],'createdAt':_0x2a20af[_0x4660b6(0x12f)][_0x4660b6(0x24d)],'paidAt':_0x2a20af['payout'][_0x4660b6(0x234)]};}async['getAllPayouts'](_0x3a0b81){const _0x225edc=a38_0x25a63d,{page:_0x3cbde0,limit:_0xb5621c,shopId:_0x2f85ed,network:_0x20fac9,dateFrom:_0x146a2f,dateTo:_0x456cff,search:_0x3b4118}=_0x3a0b81,_0x4a8eaa=(_0x3cbde0-0x1)*_0xb5621c,_0x49f823={};_0x2f85ed&&(_0x49f823[_0x225edc(0x228)]=_0x2f85ed);_0x20fac9&&(_0x49f823[_0x225edc(0x152)]=_0x20fac9);(_0x146a2f||_0x456cff)&&(_0x49f823[_0x225edc(0x24d)]={},_0x146a2f&&(_0x49f823['createdAt']['gte']=new Date(_0x146a2f)),_0x456cff&&(_0x49f823[_0x225edc(0x24d)][_0x225edc(0x174)]=new Date(_0x456cff)));_0x3b4118&&(_0x49f823['OR']=[{'shop':{'name':{'contains':_0x3b4118,'mode':_0x225edc(0x1c9)}}},{'shop':{'username':{'contains':_0x3b4118,'mode':_0x225edc(0x1c9)}}},{'notes':{'contains':_0x3b4118,'mode':'insensitive'}}]);const [_0x252606,_0x21144d]=await Promise[_0x225edc(0x21c)]([database_1['default'][_0x225edc(0x12f)][_0x225edc(0x24a)]({'where':_0x49f823,'skip':_0x4a8eaa,'take':_0xb5621c,'orderBy':{'createdAt':_0x225edc(0x178)},'select':{'id':!![],'shopId':!![],'amount':!![],'network':!![],'status':!![],'txid':!![],'notes':!![],'periodFrom':!![],'periodTo':!![],'createdAt':!![],'paidAt':!![],'shop':{'select':{'name':!![],'username':!![]}}}}),database_1[_0x225edc(0x1dc)][_0x225edc(0x12f)][_0x225edc(0x214)]({'where':_0x49f823})]);return{'payouts':_0x252606[_0x225edc(0x182)](_0x58213b=>({'id':_0x58213b['id'],'shopId':_0x58213b[_0x225edc(0x228)],'shopName':_0x58213b['shop']['name'],'shopUsername':_0x58213b[_0x225edc(0x1e3)]['username'],'amount':_0x58213b['amount'],'network':_0x58213b[_0x225edc(0x152)],'status':_0x58213b[_0x225edc(0x158)],'txid':_0x58213b[_0x225edc(0x255)],'notes':_0x58213b[_0x225edc(0x1c6)],'periodFrom':_0x58213b[_0x225edc(0x1b8)],'periodTo':_0x58213b[_0x225edc(0x166)],'createdAt':_0x58213b[_0x225edc(0x24d)],'paidAt':_0x58213b[_0x225edc(0x234)]})),'pagination':{'page':_0x3cbde0,'limit':_0xb5621c,'total':_0x21144d,'totalPages':Math[_0x225edc(0x14f)](_0x21144d/_0xb5621c)}};}async[a38_0x25a63d(0x219)](_0x5c54d5){const _0xa30b36=a38_0x25a63d,_0x47184d=await database_1[_0xa30b36(0x1dc)]['payout'][_0xa30b36(0x146)]({'where':{'id':_0x5c54d5},'include':{'shop':{'select':{'name':!![],'username':!![]}}}});if(!_0x47184d)return null;return{'id':_0x47184d['id'],'shopId':_0x47184d[_0xa30b36(0x228)],'shopName':_0x47184d['shop']['name'],'shopUsername':_0x47184d[_0xa30b36(0x1e3)][_0xa30b36(0x184)],'amount':_0x47184d[_0xa30b36(0x1c1)],'network':_0x47184d[_0xa30b36(0x152)],'status':_0x47184d[_0xa30b36(0x158)],'txid':_0x47184d['txid'],'notes':_0x47184d[_0xa30b36(0x1c6)],'periodFrom':_0x47184d[_0xa30b36(0x1b8)],'periodTo':_0x47184d['periodTo'],'createdAt':_0x47184d['createdAt'],'paidAt':_0x47184d[_0xa30b36(0x234)]};}async['deletePayout'](_0x1594a7){const _0x51bd5d=a38_0x25a63d;await database_1[_0x51bd5d(0x1dc)][_0x51bd5d(0x12f)]['delete']({'where':{'id':_0x1594a7}});}async['getAllPayments'](_0x207d2b){const _0x867391=a38_0x25a63d,{page:_0x1d0d9d,limit:_0x4cd4de,status:_0x4d7e2e,gateway:_0xea8df1,shopId:_0x5f3153,dateFrom:_0x3802f7,dateTo:_0x32914c,search:_0x1f2c6a,currency:_0x58cd65,sortBy:_0x54754f,sortOrder:_0x5e6bfe}=_0x207d2b,_0x34f86b=(_0x1d0d9d-0x1)*_0x4cd4de;console[_0x867391(0x151)]('📊\x20Getting\x20payments\x20with\x20filters:',_0x207d2b);const _0x4198be=await database_1[_0x867391(0x1dc)]['payment'][_0x867391(0x1e4)]({'by':['gateway'],'_count':{'gateway':!![]}});console[_0x867391(0x151)](_0x867391(0x138),_0x4198be[_0x867391(0x182)](_0x3e7ca2=>_0x3e7ca2[_0x867391(0x250)]+'\x20('+_0x3e7ca2['_count'][_0x867391(0x250)]+'\x20payments)'));if(_0xea8df1){const _0x3b2fd7=_0x4198be['some'](_0x19d85d=>_0x19d85d[_0x867391(0x250)][_0x867391(0x21f)]()===_0xea8df1[_0x867391(0x21f)]());!_0x3b2fd7&&_0xea8df1['toLowerCase']()!==_0x867391(0x126)&&console['log'](_0x867391(0x239)+_0xea8df1+_0x867391(0x156)+_0x4198be[_0x867391(0x182)](_0x59a024=>_0x59a024[_0x867391(0x250)])[_0x867391(0x124)](',\x20'));}const _0x19fd9d={};_0x4d7e2e&&(_0x19fd9d[_0x867391(0x158)]=_0x4d7e2e[_0x867391(0x209)]());if(!_0xea8df1)_0x19fd9d[_0x867391(0x250)]={'not':_0x867391(0x126)};else{if(_0xea8df1&&(_0xea8df1[_0x867391(0x21f)]()==='test_gateway'||_0xea8df1===_0x867391(0x1f3)))_0x19fd9d[_0x867391(0x250)]=_0x867391(0x126);else{let _0x2bf25c=_0xea8df1;const _0x3359ca=(0x0,gateway_1[_0x867391(0x215)])(_0xea8df1);if(_0x3359ca)_0x2bf25c=_0x3359ca,console['log'](_0x867391(0x125)+_0xea8df1+'\x27\x20to\x20name\x20\x27'+_0x2bf25c+'\x27');else{const _0x1c7a6f=(0x0,gateway_1[_0x867391(0x1e7)])(_0xea8df1);if(_0x1c7a6f){const _0xa88135=(0x0,gateway_1[_0x867391(0x215)])(_0x1c7a6f);_0xa88135&&(_0x2bf25c=_0xa88135,console[_0x867391(0x151)](_0x867391(0x25b)+_0xea8df1+'\x27\x20->\x20ID\x20\x27'+_0x1c7a6f+_0x867391(0x218)+_0x2bf25c+'\x27'));}else console[_0x867391(0x151)](_0x867391(0x1a8)+_0xea8df1+_0x867391(0x22d));}const _0x519f81=await database_1[_0x867391(0x1dc)][_0x867391(0x24c)]['count']({'where':{'gateway':_0x2bf25c[_0x867391(0x21f)]()},'take':0x1});_0x519f81===0x0?(console[_0x867391(0x151)](_0x867391(0x1c8)+_0x2bf25c+_0x867391(0x247)+_0xea8df1+_0x867391(0x143)),_0x19fd9d[_0x867391(0x250)]=_0x867391(0x24f)):(_0x19fd9d[_0x867391(0x250)]=_0x2bf25c[_0x867391(0x21f)](),console[_0x867391(0x151)]('✅\x20Using\x20gateway\x20filter:\x20\x27'+_0x2bf25c+_0x867391(0x247)+_0xea8df1+'\x27)'));}}console['log']('📊\x20Gateway\x20filter\x20applied:',_0x19fd9d[_0x867391(0x250)]);_0x5f3153&&(_0x19fd9d['shopId']=_0x5f3153);_0x58cd65&&(_0x19fd9d[_0x867391(0x153)]=_0x58cd65['toUpperCase'](),console['log'](_0x867391(0x206)+_0x58cd65[_0x867391(0x209)]()));(_0x3802f7||_0x32914c)&&(_0x19fd9d[_0x867391(0x24d)]={},_0x3802f7&&(_0x19fd9d['createdAt']['gte']=new Date(_0x3802f7)),_0x32914c&&(_0x19fd9d['createdAt'][_0x867391(0x174)]=new Date(_0x32914c)));_0x1f2c6a&&(_0x19fd9d['OR']=[{'id':{'contains':_0x1f2c6a,'mode':_0x867391(0x1c9)}},{'orderId':{'contains':_0x1f2c6a,'mode':'insensitive'}},{'gatewayOrderId':{'contains':_0x1f2c6a,'mode':_0x867391(0x1c9)}},{'customerEmail':{'contains':_0x1f2c6a,'mode':_0x867391(0x1c9)}},{'shop':{'name':{'contains':_0x1f2c6a,'mode':'insensitive'}}},{'shop':{'username':{'contains':_0x1f2c6a,'mode':_0x867391(0x1c9)}}}]);console[_0x867391(0x151)]('📊\x20Final\x20WHERE\x20conditions:',JSON[_0x867391(0x21d)](_0x19fd9d,null,0x2));let _0x155771={'createdAt':_0x867391(0x178)};if(_0x54754f){const _0x4522c2=[_0x867391(0x1c1),_0x867391(0x24d),'updatedAt',_0x867391(0x158),_0x867391(0x250),_0x867391(0x153)],_0x375ebc=[_0x867391(0x1c2),_0x867391(0x178)];if(_0x4522c2['includes'](_0x54754f)){const _0x2a27a1=_0x375ebc[_0x867391(0x154)](_0x5e6bfe)?_0x5e6bfe:_0x867391(0x178);_0x155771={[_0x54754f]:_0x2a27a1},console[_0x867391(0x151)](_0x867391(0x1ae)+_0x54754f+_0x867391(0x145)+_0x2a27a1+_0x867391(0x1a5));}}const [_0x3cd980,_0x3d318f]=await Promise[_0x867391(0x21c)]([database_1['default'][_0x867391(0x24c)][_0x867391(0x24a)]({'where':_0x19fd9d,'skip':_0x34f86b,'take':_0x4cd4de,'orderBy':_0x155771,'include':{'shop':{'select':{'name':!![],'username':!![]}}}}),database_1[_0x867391(0x1dc)]['payment'][_0x867391(0x214)]({'where':_0x19fd9d})]);return{'payments':_0x3cd980,'pagination':{'page':_0x1d0d9d,'limit':_0x4cd4de,'total':_0x3d318f,'totalPages':Math[_0x867391(0x14f)](_0x3d318f/_0x4cd4de)}};}async['getPaymentById'](_0x355d18){const _0xbf47c2=a38_0x25a63d,_0x402f3b=await database_1['default'][_0xbf47c2(0x24c)]['findUnique']({'where':{'id':_0x355d18},'select':{'id':!![],'shopId':!![],'amount':!![],'amountAfterGatewayCommissionUSDT':!![],'currency':!![],'sourceCurrency':!![],'status':!![],'gateway':!![],'orderId':!![],'gatewayOrderId':!![],'gatewayPaymentId':!![],'customerEmail':!![],'customerName':!![],'customerCountry':!![],'customerIp':!![],'customerUa':!![],'externalPaymentUrl':!![],'successUrl':!![],'failUrl':!![],'pendingUrl':!![],'whiteUrl':!![],'expiresAt':!![],'invoiceTotalSum':!![],'qrCode':!![],'qrUrl':!![],'country':!![],'language':!![],'amountIsEditable':!![],'maxPayments':!![],'rapydCustomer':!![],'cardLast4':!![],'paymentMethod':!![],'bankId':!![],'remitterIban':!![],'remitterName':!![],'failureMessage':!![],'usage':!![],'createdAt':!![],'updatedAt':!![],'shop':{'select':{'name':!![],'username':!![]}}}});if(!_0x402f3b)return null;return{'id':_0x402f3b['id'],'shopId':_0x402f3b['shopId'],'gateway':_0x402f3b[_0xbf47c2(0x250)],'amount':_0x402f3b['amount'],'currency':_0x402f3b[_0xbf47c2(0x153)],'status':_0x402f3b[_0xbf47c2(0x158)],'orderId':_0x402f3b[_0xbf47c2(0x1ab)],'gatewayOrderId':_0x402f3b['gatewayOrderId'],'customerEmail':_0x402f3b[_0xbf47c2(0x13e)],'customerName':_0x402f3b[_0xbf47c2(0x14a)],'customerCountry':_0x402f3b[_0xbf47c2(0x1cb)],'customerIp':_0x402f3b[_0xbf47c2(0x24b)],'customerUa':_0x402f3b['customerUa'],'failureMessage':_0x402f3b[_0xbf47c2(0x159)],'externalPaymentUrl':_0x402f3b[_0xbf47c2(0x22a)],'successUrl':_0x402f3b[_0xbf47c2(0x193)],'failUrl':_0x402f3b[_0xbf47c2(0x129)],'pendingUrl':_0x402f3b['pendingUrl'],'whiteUrl':_0x402f3b[_0xbf47c2(0x13f)],'createdAt':_0x402f3b[_0xbf47c2(0x24d)],'updatedAt':_0x402f3b[_0xbf47c2(0x17b)],'shop':_0x402f3b['shop']};}async[a38_0x25a63d(0x133)](_0x524118,_0x14ff10,_0x27b050,_0x2e79e5){const _0x29453e=a38_0x25a63d,_0x3d10c4=await database_1['default'][_0x29453e(0x1bd)](async _0x3a6b7a=>{const _0x35f181=_0x29453e,_0x4f4c9a=await _0x3a6b7a[_0x35f181(0x24c)]['findUnique']({'where':{'id':_0x524118},'include':{'shop':{'select':{'id':!![],'name':!![],'username':!![],'balance':!![]}}}});if(!_0x4f4c9a)throw new Error(_0x35f181(0x1f9));const _0x17643c=_0x4f4c9a[_0x35f181(0x158)],_0x508a2a=_0x14ff10['toUpperCase']();console['log']('🔄\x20Admin\x20updating\x20payment\x20'+_0x524118+_0x35f181(0x1b0)+_0x17643c+'\x20->\x20'+_0x508a2a),console[_0x35f181(0x151)]('💰\x20Current\x20shop\x20balance:\x20'+_0x4f4c9a['shop']['balance']+_0x35f181(0x19c));const _0x4956ff={'status':_0x508a2a,'updatedAt':new Date(),'statusChangedBy':_0x35f181(0x181),'statusChangedAt':new Date()};_0x27b050&&(_0x4956ff[_0x35f181(0x195)]=_0x27b050);_0x508a2a==='CHARGEBACK'&&_0x2e79e5&&(_0x4956ff[_0x35f181(0x245)]=_0x2e79e5);let _0x29427e=0x0,_0x1c829a=_0x4f4c9a[_0x35f181(0x1e3)]['balance'];if(_0x508a2a===_0x35f181(0x148)&&_0x17643c!==_0x35f181(0x148)){_0x4956ff['paidAt']=new Date();const _0x120756=await currencyService_1[_0x35f181(0x1f6)][_0x35f181(0x1b9)](_0x4f4c9a['amount'],_0x4f4c9a['currency']);_0x4956ff['amountUSDT']=_0x120756;let _0x2001ab=0x2d;const _0x5d666f=await _0x3a6b7a[_0x35f181(0x1e3)][_0x35f181(0x146)]({'where':{'id':_0x4f4c9a[_0x35f181(0x228)]},'select':{'gatewaySettings':!![]}});if(_0x5d666f?.[_0x35f181(0x13b)])try{const _0x488be2=JSON[_0x35f181(0x190)](_0x5d666f[_0x35f181(0x13b)]);for(const [_0x2de677,_0x1fb286]of Object[_0x35f181(0x1fb)](_0x488be2)){if(_0x2de677['toLowerCase']()===_0x4f4c9a[_0x35f181(0x250)][_0x35f181(0x21f)]()){_0x2001ab=_0x1fb286['commission']||0xa;break;}}}catch(_0x37a6c5){console['error'](_0x35f181(0x1ad)+_0x524118+':',_0x37a6c5);}let _0x163abc;_0x4f4c9a[_0x35f181(0x20c)]!==null&&_0x4f4c9a[_0x35f181(0x20c)]!==undefined?(_0x163abc=_0x4f4c9a['amountAfterGatewayCommissionUSDT'],console[_0x35f181(0x151)](_0x35f181(0x1e6)+_0x163abc[_0x35f181(0x1f7)](0x6)+_0x35f181(0x12a)+_0x524118)):(_0x163abc=_0x120756*(0x1-_0x2001ab/0x64),console['log']('📊\x20[ADMIN]\x20Calculating\x20commission\x20manually\x20for\x20payment\x20'+_0x524118+':\x20'+_0x2001ab+_0x35f181(0x1eb)+_0x120756[_0x35f181(0x1f7)](0x6)+_0x35f181(0x19c)),_0x4956ff[_0x35f181(0x20c)]=_0x163abc,_0x4956ff[_0x35f181(0x19a)]=_0x2001ab),_0x29427e=_0x163abc,_0x1c829a+=_0x163abc,console['log'](_0x35f181(0x160)+_0x524118+_0x35f181(0x1e1)),console[_0x35f181(0x151)](_0x35f181(0x21e)+_0x120756['toFixed'](0x6)+_0x35f181(0x19c)),console[_0x35f181(0x151)](_0x35f181(0x127)+_0x4f4c9a[_0x35f181(0x250)]+_0x35f181(0x1b7)+_0x2001ab+'%'),console['log'](_0x35f181(0x1e9)+_0x163abc[_0x35f181(0x1f7)](0x6)+_0x35f181(0x1f2)+_0x2001ab+_0x35f181(0x141)),console['log']('\x20\x20\x20Added\x20to\x20balance:\x20+'+_0x163abc['toFixed'](0x6)+_0x35f181(0x19c));}else{if(_0x17643c===_0x35f181(0x148)&&_0x508a2a!==_0x35f181(0x148)){if(_0x4f4c9a[_0x35f181(0x248)]){let _0x4f25fb=0x2d;const _0x330647=await _0x3a6b7a[_0x35f181(0x1e3)][_0x35f181(0x146)]({'where':{'id':_0x4f4c9a['shopId']},'select':{'gatewaySettings':!![]}});if(_0x330647?.['gatewaySettings'])try{const _0x16610d=JSON[_0x35f181(0x190)](_0x330647['gatewaySettings']);for(const [_0x412896,_0x519178]of Object[_0x35f181(0x1fb)](_0x16610d)){if(_0x412896['toLowerCase']()===_0x4f4c9a[_0x35f181(0x250)]['toLowerCase']()){_0x4f25fb=_0x519178[_0x35f181(0x191)]||0xa;break;}}}catch(_0x46faba){console[_0x35f181(0x134)](_0x35f181(0x1ad)+_0x524118+':',_0x46faba);}const _0x284dc8=_0x4f4c9a[_0x35f181(0x248)]*(0x1-_0x4f25fb/0x64);_0x29427e=-_0x284dc8,_0x1c829a-=_0x284dc8,_0x4956ff[_0x35f181(0x248)]=null,_0x4956ff[_0x35f181(0x20c)]=null,console[_0x35f181(0x151)]('💰\x20Payment\x20'+_0x524118+'\x20no\x20longer\x20PAID:'),console[_0x35f181(0x151)]('\x20\x20\x20Full\x20amount:\x20'+_0x4f4c9a['amountUSDT']['toFixed'](0x6)+_0x35f181(0x19c)),console['log'](_0x35f181(0x127)+_0x4f4c9a[_0x35f181(0x250)]+_0x35f181(0x1b7)+_0x4f25fb+'%'),console['log']('\x20\x20\x20Merchant\x20loses:\x20'+_0x284dc8[_0x35f181(0x1f7)](0x6)+_0x35f181(0x1f2)+_0x4f25fb+'%\x20commission)'),console[_0x35f181(0x151)](_0x35f181(0x16f)+_0x284dc8[_0x35f181(0x1f7)](0x6)+_0x35f181(0x19c));}}}_0x508a2a==='CHARGEBACK'&&(_0x17643c===_0x35f181(0x148)&&_0x4f4c9a[_0x35f181(0x248)]&&console[_0x35f181(0x151)](_0x35f181(0x1f5)),_0x2e79e5&&_0x2e79e5>0x0&&(_0x29427e-=_0x2e79e5,_0x1c829a-=_0x2e79e5,console[_0x35f181(0x151)]('💸\x20CHARGEBACK\x20penalty:\x20-'+_0x2e79e5[_0x35f181(0x1f7)](0x6)+_0x35f181(0x15e))));_0x508a2a===_0x35f181(0x140)&&_0x17643c===_0x35f181(0x148)&&console[_0x35f181(0x151)](_0x35f181(0x1da));const _0x4596c2=await _0x3a6b7a[_0x35f181(0x24c)][_0x35f181(0x165)]({'where':{'id':_0x524118},'data':_0x4956ff,'include':{'shop':{'select':{'name':!![],'username':!![]}}}});return _0x29427e!==0x0&&(await _0x3a6b7a[_0x35f181(0x1e3)][_0x35f181(0x165)]({'where':{'id':_0x4f4c9a[_0x35f181(0x228)]},'data':{'balance':_0x1c829a}}),console[_0x35f181(0x151)]('💰\x20Shop\x20'+_0x4f4c9a[_0x35f181(0x228)]+_0x35f181(0x1f1)+_0x4f4c9a[_0x35f181(0x1e3)][_0x35f181(0x23f)][_0x35f181(0x1f7)](0x6)+'\x20->\x20'+_0x1c829a['toFixed'](0x6)+_0x35f181(0x1f4)+(_0x29427e>0x0?'+':'')+_0x29427e['toFixed'](0x6)+')')),_0x4596c2;});return{'id':_0x3d10c4['id'],'shopId':_0x3d10c4['shopId'],'gateway':_0x3d10c4[_0x29453e(0x250)],'amount':_0x3d10c4[_0x29453e(0x1c1)],'currency':_0x3d10c4[_0x29453e(0x153)],'status':_0x3d10c4[_0x29453e(0x158)],'orderId':_0x3d10c4['orderId'],'gatewayOrderId':_0x3d10c4['gatewayOrderId'],'customerEmail':_0x3d10c4[_0x29453e(0x13e)],'customerName':_0x3d10c4[_0x29453e(0x14a)],'customerCountry':_0x3d10c4[_0x29453e(0x1cb)],'customerIp':_0x3d10c4[_0x29453e(0x24b)],'customerUa':_0x3d10c4[_0x29453e(0x1c5)],'failureMessage':_0x3d10c4[_0x29453e(0x159)],'adminNotes':_0x3d10c4[_0x29453e(0x195)],'chargebackAmount':_0x3d10c4[_0x29453e(0x245)],'statusChangedBy':_0x3d10c4[_0x29453e(0x254)],'statusChangedAt':_0x3d10c4['statusChangedAt'],'createdAt':_0x3d10c4['createdAt'],'updatedAt':_0x3d10c4[_0x29453e(0x17b)],'shop':_0x3d10c4[_0x29453e(0x1e3)]};}async[a38_0x25a63d(0x15c)](_0x232a85,_0x38c41e){const _0x5ab41f=a38_0x25a63d,_0x494925=Math['random']()[_0x5ab41f(0x257)](0x24)['substr'](0x2,0x9);console[_0x5ab41f(0x151)](_0x5ab41f(0x1fe)+_0x494925+',\x20userId:\x20'+_0x232a85);const _0x407e0b={..._0x38c41e};_0x38c41e['password']&&_0x38c41e[_0x5ab41f(0x1d9)][_0x5ab41f(0x229)]()!==''?(console[_0x5ab41f(0x151)](_0x5ab41f(0x122)+_0x494925+_0x5ab41f(0x230)+_0x232a85),_0x407e0b[_0x5ab41f(0x1d9)]=await bcryptjs_1[_0x5ab41f(0x1dc)]['hash'](_0x38c41e[_0x5ab41f(0x1d9)],0xc)):(console[_0x5ab41f(0x151)](_0x5ab41f(0x122)+_0x494925+_0x5ab41f(0x1be)),delete _0x407e0b[_0x5ab41f(0x1d9)]);_0x38c41e[_0x5ab41f(0x194)]&&(_0x407e0b[_0x5ab41f(0x21a)]=_0x38c41e['fullName'],delete _0x407e0b[_0x5ab41f(0x194)]);_0x38c41e['telegramId']&&(_0x407e0b['telegram']=_0x38c41e[_0x5ab41f(0x13a)],delete _0x407e0b[_0x5ab41f(0x13a)]);_0x38c41e[_0x5ab41f(0x15d)]&&(_0x407e0b[_0x5ab41f(0x14e)]=_0x38c41e['merchantUrl'],delete _0x407e0b[_0x5ab41f(0x15d)]);if(_0x38c41e[_0x5ab41f(0x1f0)]){const _0x58703f=_0x38c41e[_0x5ab41f(0x1f0)][_0x5ab41f(0x182)](_0x5bef9f=>this[_0x5ab41f(0x20a)](_0x5bef9f));console[_0x5ab41f(0x151)](_0x5ab41f(0x1bb),_0x38c41e[_0x5ab41f(0x1f0)],'->',_0x58703f),_0x407e0b[_0x5ab41f(0x1d2)]=JSON['stringify'](_0x58703f),delete _0x407e0b['gateways'];}_0x38c41e[_0x5ab41f(0x13b)]&&(console[_0x5ab41f(0x151)](_0x5ab41f(0x1b3)+_0x494925+_0x5ab41f(0x139),_0x38c41e[_0x5ab41f(0x13b)]),_0x407e0b[_0x5ab41f(0x13b)]=JSON['stringify'](_0x38c41e[_0x5ab41f(0x13b)]),console[_0x5ab41f(0x151)](_0x5ab41f(0x1b3)+_0x494925+']\x20Gateway\x20settings\x20JSON\x20string:',_0x407e0b[_0x5ab41f(0x13b)]));_0x38c41e[_0x5ab41f(0x1a3)]&&(_0x38c41e['wallets'][_0x5ab41f(0x167)]!==undefined&&(_0x407e0b['usdtPolygonWallet']=_0x38c41e[_0x5ab41f(0x1a3)][_0x5ab41f(0x167)]||null),_0x38c41e[_0x5ab41f(0x1a3)][_0x5ab41f(0x23c)]!==undefined&&(_0x407e0b[_0x5ab41f(0x23c)]=_0x38c41e[_0x5ab41f(0x1a3)]['usdtTrcWallet']||null),_0x38c41e[_0x5ab41f(0x1a3)][_0x5ab41f(0x251)]!==undefined&&(_0x407e0b[_0x5ab41f(0x251)]=_0x38c41e[_0x5ab41f(0x1a3)]['usdtErcWallet']||null),_0x38c41e[_0x5ab41f(0x1a3)][_0x5ab41f(0x175)]!==undefined&&(_0x407e0b[_0x5ab41f(0x175)]=_0x38c41e[_0x5ab41f(0x1a3)][_0x5ab41f(0x175)]||null),delete _0x407e0b['wallets']);const _0x20f7fc=await database_1[_0x5ab41f(0x1dc)]['shop']['update']({'where':{'id':_0x232a85},'data':_0x407e0b,'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});return console[_0x5ab41f(0x151)](_0x5ab41f(0x242)+_0x494925+_0x5ab41f(0x1dd),_0x20f7fc[_0x5ab41f(0x13b)]),{'id':_0x20f7fc['id'],'fullName':_0x20f7fc[_0x5ab41f(0x21a)],'username':_0x20f7fc[_0x5ab41f(0x184)],'telegramId':_0x20f7fc[_0x5ab41f(0x241)],'merchantUrl':_0x20f7fc[_0x5ab41f(0x14e)],'gateways':_0x20f7fc[_0x5ab41f(0x1d2)]?JSON['parse'](_0x20f7fc['paymentGateways']):null,'gatewaySettings':_0x20f7fc[_0x5ab41f(0x13b)]?JSON[_0x5ab41f(0x190)](_0x20f7fc[_0x5ab41f(0x13b)]):null,'publicKey':_0x20f7fc['publicKey'],'wallets':{'usdtPolygonWallet':_0x20f7fc[_0x5ab41f(0x167)],'usdtTrcWallet':_0x20f7fc[_0x5ab41f(0x23c)],'usdtErcWallet':_0x20f7fc[_0x5ab41f(0x251)],'usdcPolygonWallet':_0x20f7fc[_0x5ab41f(0x175)]},'status':_0x20f7fc[_0x5ab41f(0x158)],'createdAt':_0x20f7fc[_0x5ab41f(0x24d)]};}async[a38_0x25a63d(0x217)](_0x3ca72a){const _0x56196=a38_0x25a63d,_0x20543a=await database_1[_0x56196(0x1dc)][_0x56196(0x1e3)][_0x56196(0x165)]({'where':{'id':_0x3ca72a},'data':{'status':'SUSPENDED'},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});return{'id':_0x20543a['id'],'fullName':_0x20543a['name'],'username':_0x20543a['username'],'telegramId':_0x20543a[_0x56196(0x241)],'merchantUrl':_0x20543a['shopUrl'],'gateways':_0x20543a[_0x56196(0x1d2)]?JSON[_0x56196(0x190)](_0x20543a['paymentGateways']):null,'gatewaySettings':_0x20543a['gatewaySettings']?JSON[_0x56196(0x190)](_0x20543a['gatewaySettings']):null,'publicKey':_0x20543a[_0x56196(0x222)],'wallets':{'usdtPolygonWallet':_0x20543a[_0x56196(0x167)],'usdtTrcWallet':_0x20543a[_0x56196(0x23c)],'usdtErcWallet':_0x20543a[_0x56196(0x251)],'usdcPolygonWallet':_0x20543a[_0x56196(0x175)]},'status':_0x20543a[_0x56196(0x158)],'createdAt':_0x20543a['createdAt']};}async[a38_0x25a63d(0x240)](_0x1febbf){const _0x29664e=a38_0x25a63d,_0x5636ee=await database_1[_0x29664e(0x1dc)][_0x29664e(0x1e3)][_0x29664e(0x165)]({'where':{'id':_0x1febbf},'data':{'status':'ACTIVE'},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});return{'id':_0x5636ee['id'],'fullName':_0x5636ee[_0x29664e(0x21a)],'username':_0x5636ee[_0x29664e(0x184)],'telegramId':_0x5636ee[_0x29664e(0x241)],'merchantUrl':_0x5636ee[_0x29664e(0x14e)],'gateways':_0x5636ee[_0x29664e(0x1d2)]?JSON['parse'](_0x5636ee['paymentGateways']):null,'gatewaySettings':_0x5636ee[_0x29664e(0x13b)]?JSON[_0x29664e(0x190)](_0x5636ee['gatewaySettings']):null,'publicKey':_0x5636ee['publicKey'],'wallets':{'usdtPolygonWallet':_0x5636ee[_0x29664e(0x167)],'usdtTrcWallet':_0x5636ee[_0x29664e(0x23c)],'usdtErcWallet':_0x5636ee[_0x29664e(0x251)],'usdcPolygonWallet':_0x5636ee[_0x29664e(0x175)]},'status':_0x5636ee[_0x29664e(0x158)],'createdAt':_0x5636ee[_0x29664e(0x24d)]};}async[a38_0x25a63d(0x137)](_0x16b228){const _0x46ecfc=a38_0x25a63d,{page:_0x58adf2,limit:_0x454f47,status:_0x1bb6c0}=_0x16b228,_0x2b3f76=(_0x58adf2-0x1)*_0x454f47,_0x2c3890={};_0x1bb6c0&&(_0x2c3890['status']=_0x1bb6c0[_0x46ecfc(0x209)]());const [_0x3ca65d,_0x45c0fe]=await Promise[_0x46ecfc(0x21c)]([database_1['default'][_0x46ecfc(0x1e3)][_0x46ecfc(0x24a)]({'where':_0x2c3890,'skip':_0x2b3f76,'take':_0x454f47,'orderBy':{'createdAt':_0x46ecfc(0x178)},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}}),database_1[_0x46ecfc(0x1dc)]['shop'][_0x46ecfc(0x214)]({'where':_0x2c3890})]);return{'users':_0x3ca65d[_0x46ecfc(0x182)](_0x27aa40=>{const _0x54803a=_0x46ecfc,_0x13e32b=_0x27aa40['paymentGateways']?JSON[_0x54803a(0x190)](_0x27aa40[_0x54803a(0x1d2)]):null,_0x42b991=_0x13e32b?_0x13e32b[_0x54803a(0x182)](_0x1ffb33=>this[_0x54803a(0x185)](_0x1ffb33)):null;return{'id':_0x27aa40['id'],'fullName':_0x27aa40[_0x54803a(0x21a)],'username':_0x27aa40[_0x54803a(0x184)],'telegramId':_0x27aa40[_0x54803a(0x241)],'merchantUrl':_0x27aa40[_0x54803a(0x14e)],'gateways':_0x42b991,'gatewaySettings':_0x27aa40[_0x54803a(0x13b)]?JSON[_0x54803a(0x190)](_0x27aa40[_0x54803a(0x13b)]):null,'publicKey':_0x27aa40['publicKey'],'wallets':{'usdtPolygonWallet':_0x27aa40[_0x54803a(0x167)],'usdtTrcWallet':_0x27aa40[_0x54803a(0x23c)],'usdtErcWallet':_0x27aa40[_0x54803a(0x251)],'usdcPolygonWallet':_0x27aa40[_0x54803a(0x175)]},'status':_0x27aa40[_0x54803a(0x158)],'createdAt':_0x27aa40[_0x54803a(0x24d)]};}),'pagination':{'page':_0x58adf2,'limit':_0x454f47,'total':_0x45c0fe,'totalPages':Math[_0x46ecfc(0x14f)](_0x45c0fe/_0x454f47)}};}async[a38_0x25a63d(0x17d)](_0x5ea4fe){const _0x240f98=a38_0x25a63d,_0x1ea99b=await database_1[_0x240f98(0x1dc)]['shop'][_0x240f98(0x146)]({'where':{'id':_0x5ea4fe},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});if(!_0x1ea99b)return null;const _0x47de52=_0x1ea99b[_0x240f98(0x1d2)]?JSON['parse'](_0x1ea99b[_0x240f98(0x1d2)]):null,_0x37e9ec=_0x47de52?_0x47de52[_0x240f98(0x182)](_0x5c0ac=>this[_0x240f98(0x185)](_0x5c0ac)):null;return _0x47de52&&_0x37e9ec&&console[_0x240f98(0x151)]('🔄\x20Gateway\x20mapping\x20(get):',_0x47de52,'->',_0x37e9ec),{'id':_0x1ea99b['id'],'fullName':_0x1ea99b['name'],'username':_0x1ea99b['username'],'telegramId':_0x1ea99b[_0x240f98(0x241)],'merchantUrl':_0x1ea99b[_0x240f98(0x14e)],'gateways':_0x37e9ec,'gatewaySettings':_0x1ea99b[_0x240f98(0x13b)]?JSON['parse'](_0x1ea99b[_0x240f98(0x13b)]):null,'publicKey':_0x1ea99b[_0x240f98(0x222)],'wallets':{'usdtPolygonWallet':_0x1ea99b['usdtPolygonWallet'],'usdtTrcWallet':_0x1ea99b['usdtTrcWallet'],'usdtErcWallet':_0x1ea99b[_0x240f98(0x251)],'usdcPolygonWallet':_0x1ea99b['usdcPolygonWallet']},'status':_0x1ea99b['status'],'createdAt':_0x1ea99b[_0x240f98(0x24d)]};}async[a38_0x25a63d(0x1cf)](_0x12d14c){const _0x312ffe=a38_0x25a63d,{fullName:_0x2c6b30,username:_0x593c9a,password:_0x1f867c,telegramId:_0x1aa891,merchantUrl:_0xaca5f6,gateways:_0x4d52cf,gatewaySettings:_0x4fc2fa,wallets:_0x5e31cc}=_0x12d14c,_0x1159b8=await database_1[_0x312ffe(0x1dc)][_0x312ffe(0x1e3)][_0x312ffe(0x146)]({'where':{'username':_0x593c9a}});if(_0x1159b8)throw new Error(_0x312ffe(0x221));if(_0x1aa891){const _0x2cb130=await database_1['default']['shop']['findUnique']({'where':{'telegram':_0x1aa891}});if(_0x2cb130)throw new Error(_0x312ffe(0x147));}const _0x553d37=await bcryptjs_1[_0x312ffe(0x1dc)][_0x312ffe(0x200)](_0x1f867c,0xc),_0x3fce07=_0x312ffe(0x1a7)+crypto_1[_0x312ffe(0x1dc)][_0x312ffe(0x1a1)](0x20)[_0x312ffe(0x257)](_0x312ffe(0x238)),_0x4ac14f=_0x312ffe(0x1c4)+crypto_1[_0x312ffe(0x1dc)]['randomBytes'](0x20)[_0x312ffe(0x257)]('hex'),_0x572cdb=_0x4d52cf?_0x4d52cf[_0x312ffe(0x182)](_0x1f4462=>this['getGatewayInternalName'](_0x1f4462)):null;_0x4d52cf&&_0x572cdb&&console[_0x312ffe(0x151)]('🔄\x20Gateway\x20mapping\x20(create):',_0x4d52cf,'->',_0x572cdb);const _0x26dc98=await database_1[_0x312ffe(0x1dc)]['shop'][_0x312ffe(0x1a0)]({'data':{'name':_0x2c6b30,'username':_0x593c9a,'password':_0x553d37,'telegram':_0x1aa891,'shopUrl':_0xaca5f6,'paymentGateways':_0x572cdb?JSON['stringify'](_0x572cdb):null,'gatewaySettings':_0x4fc2fa?JSON['stringify'](_0x4fc2fa):null,'usdtPolygonWallet':_0x5e31cc?.['usdtPolygonWallet']||null,'usdtTrcWallet':_0x5e31cc?.[_0x312ffe(0x23c)]||null,'usdtErcWallet':_0x5e31cc?.[_0x312ffe(0x251)]||null,'usdcPolygonWallet':_0x5e31cc?.['usdcPolygonWallet']||null,'publicKey':_0x3fce07,'secretKey':_0x4ac14f,'status':_0x312ffe(0x23e)},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});return{'id':_0x26dc98['id'],'fullName':_0x26dc98['name'],'username':_0x26dc98[_0x312ffe(0x184)],'telegramId':_0x26dc98[_0x312ffe(0x241)],'merchantUrl':_0x26dc98[_0x312ffe(0x14e)],'gateways':_0x26dc98[_0x312ffe(0x1d2)]?JSON[_0x312ffe(0x190)](_0x26dc98[_0x312ffe(0x1d2)]):null,'gatewaySettings':_0x26dc98['gatewaySettings']?JSON['parse'](_0x26dc98[_0x312ffe(0x13b)]):null,'publicKey':_0x26dc98['publicKey'],'wallets':{'usdtPolygonWallet':_0x26dc98[_0x312ffe(0x167)],'usdtTrcWallet':_0x26dc98[_0x312ffe(0x23c)],'usdtErcWallet':_0x26dc98[_0x312ffe(0x251)],'usdcPolygonWallet':_0x26dc98[_0x312ffe(0x175)]},'status':_0x26dc98[_0x312ffe(0x158)],'createdAt':_0x26dc98['createdAt']};}async[a38_0x25a63d(0x1e5)](_0x32f137){const _0x4d830d=a38_0x25a63d;await database_1['default']['shop'][_0x4d830d(0x180)]({'where':{'id':_0x32f137}});}['generateDailyStatistics'](_0x356d2d,_0x3307cb,_0x166234){const _0x96919=a38_0x25a63d,_0x4a049c=new Map(),_0xb67338=new Date(_0x3307cb);while(_0xb67338<=_0x166234){const _0x262142=_0xb67338['toISOString']()[_0x96919(0x149)]('T')[0x0];_0x4a049c[_0x96919(0x136)](_0x262142,{'revenue':0x0,'count':0x0}),_0xb67338[_0x96919(0x176)](_0xb67338[_0x96919(0x19e)]()+0x1);}for(const _0x4cad13 of _0x356d2d){const _0x469349=_0x4cad13['createdAt'][_0x96919(0x1ef)]()[_0x96919(0x149)]('T')[0x0],_0x18ecd2=_0x4a049c['get'](_0x469349);_0x18ecd2&&(_0x18ecd2['count']+=0x1,_0x4cad13[_0x96919(0x158)]===_0x96919(0x148)&&(_0x4cad13['amountUSDT']?_0x18ecd2['revenue']+=_0x4cad13['amountUSDT']:console[_0x96919(0x151)](_0x96919(0x1ac)+_0x4cad13['id']+_0x96919(0x16a))));}const _0xe9835b=[],_0x100b5d=[];for(const [_0x158a85,_0x1dede2]of _0x4a049c){_0xe9835b['push']({'date':_0x158a85,'amount':Math[_0x96919(0x197)](_0x1dede2[_0x96919(0x1ea)]*0x64)/0x64}),_0x100b5d['push']({'date':_0x158a85,'count':_0x1dede2[_0x96919(0x214)]});}return{'dailyRevenue':_0xe9835b,'dailyPayments':_0x100b5d};}}exports['AdminService']=AdminService;