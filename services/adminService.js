'use strict';const a36_0x378885=a36_0x21a0;(function(_0x4f1901,_0x56ace1){const _0x1391e9=a36_0x21a0,_0x4f94ac=_0x4f1901();while(!![]){try{const _0x13a1a2=-parseInt(_0x1391e9(0x162))/0x1+-parseInt(_0x1391e9(0x1c1))/0x2*(-parseInt(_0x1391e9(0xc2))/0x3)+parseInt(_0x1391e9(0x140))/0x4+-parseInt(_0x1391e9(0x126))/0x5*(parseInt(_0x1391e9(0x1a9))/0x6)+parseInt(_0x1391e9(0xd3))/0x7*(parseInt(_0x1391e9(0x1f3))/0x8)+parseInt(_0x1391e9(0x15e))/0x9+-parseInt(_0x1391e9(0x1ac))/0xa*(parseInt(_0x1391e9(0x13b))/0xb);if(_0x13a1a2===_0x56ace1)break;else _0x4f94ac['push'](_0x4f94ac['shift']());}catch(_0x280c9e){_0x4f94ac['push'](_0x4f94ac['shift']());}}}(a36_0x4959,0x476ca));var __importDefault=this&&this[a36_0x378885(0xc6)]||function(_0x5943a9){const _0x30c817=a36_0x378885;return _0x5943a9&&_0x5943a9[_0x30c817(0x147)]?_0x5943a9:{'default':_0x5943a9};};Object[a36_0x378885(0x18e)](exports,a36_0x378885(0x147),{'value':!![]}),exports['AdminService']=void 0x0;function a36_0x4959(){const _0x4b6ae9=['\x20\x20\x20💸\x20Total\x20payouts\x20(all\x20time):\x20','getAllPayments','💰\x20Current\x20shop\x20balance:\x20','suspendUser','\x20\x20\x20📅\x20This\x20month:\x20','deleteUser','plisio','periodTo','publicKey','getDate',',\x20successful:\x20','getGatewayDisplayName','Test\x20Gateway','set','📊\x20[ADMIN]\x20Calculating\x20commission\x20manually\x20for\x20payment\x20','\x20\x20\x20Balance:\x20','getTime','\x20\x20\x20⏳\x20Awaiting\x20payout:\x20','🔄\x20Converted\x20gateway\x20name\x20\x27','toISOString','\x20USDT','custom','telegram','\x20\x20\x20💰\x20Total\x20payments\x20turnover:\x20','bcryptjs','sort','🔄\x20REFUND:\x20Payment\x20amount\x20already\x20deducted\x20from\x20balance','🔧\x20[','customerCountry','✅\x20Using\x20gateway\x20filter:\x20\x27','📊\x20Getting\x20payments\x20with\x20filters:',']\x20Gateway\x20settings\x20before\x20saving:','toFixed','updatedAt','defineProperty','klyme_gb','\x20USDT\x20(+','periodFrom','amount',']\x20Updating\x20password\x20for\x20user\x20','activateUser','📊\x20Getting\x20merchants\x20awaiting\x20payout\x20with\x20filters:','\x20balance\x20updated:\x20','📊\x20Final\x20WHERE\x20conditions:','\x27\x20not\x20found.\x20Available\x20gateways:\x20','\x20USDT\x20(after\x20payouts)','balance','dateTo','gateways','availableBalance','MasterCard','Insufficient\x20balance.\x20Available:\x20','mastercard','🔄\x20Admin\x20updating\x20payment\x20','length','notes','customerIp','period','\x27\x20to\x20name\x20\x27','shopUrl','adminNotes','123306JJMwnN','📊\x20Merchant\x20statistics\x20calculated:','2020-01-01','140DgWVTA','randomBytes','\x20\x20\x20💳\x20Total\x20payments:\x20','📊\x20Payout\x20statistics\x20calculated:','findMany','delete','getUserById','admin','%\x20commission)','commission','Noda','month','setDate','thisMonth','getPayoutStats','\x27\x20->\x20name\x20\x27','findUnique','usdcPolygonWallet','usdtTrcWallet','💰\x20[PAYOUT]\x20Gateway\x20','klyme_de','8orbxwQ','stringify','fullName','\x27\x20->\x20ID\x20\x27','amountAfterGatewayCommissionUSDT',',\x20userId:\x20','📊\x20Getting\x20merchant\x20statistics\x20with\x20filters:','getMerchantsAwaitingPayout','📅\x20Period\x20\x27all\x27:\x20Using\x20start\x20date\x20from\x20first\x20payment:\x20','merchantEarningsUSDT','Payment\x20not\x20found','pk_','📊\x20Total\x20payments\x20(including\x20failed):\x20','Error\x20parsing\x20gateway\x20settings\x20for\x20payment\x20','🔄\x20Gateway\x20mapping\x20(create):','desc','amountUSDT','\x20order','findFirst','KLYME\x20GB','gateway','totalPaidOut','\x20\x20\x20Merchant\x20loses:\x20','log','merchantUrl','get','\x20USDT\x20(after\x20','crypto','turnover','toUpperCase','date','revenue','error','CoinToPay','🎯\x20[','\x20\x20\x20🌐\x20IP:\x20','\x20\x20\x20📊\x20Commission\x20difference:\x20','failureMessage','./currencyService','currency','getGatewayNameById','ceil','amountAfterCommissionUSDT','💰\x20[PAYOUT]\x20Merchant\x20','$transaction','\x27)\x20not\x20found\x20in\x20database,\x20returning\x20empty\x20result','KLYME\x20EU','sk_','getGatewayIdByName','network','64QlREbI','password','../types/gateway','shopId','join','\x20\x20\x20✅\x20Actual\x20available\x20balance:\x20','💳\x20Payout\x20wallet\x20for\x20','txid','11649NCnikr','forEach','status','groupBy','__importDefault','commissionUSDT','\x20\x20\x20📅\x20Total\x20payouts\x20(this\x20month):\x20',']\x20User\x20updated,\x20gatewaySettings\x20from\x20DB:','name','📊\x20[ADMIN]\x20Using\x20saved\x20amountAfterGatewayCommissionUSDT:\x20','ACTIVE','\x20\x20\x20🔍\x20Raw\x20balance\x20sum:\x20','customerEmail','\x27\x20(from\x20\x27','Error\x20processing\x20payment\x20','COMPLETED','🔍\x20Using\x20gateway\x20\x27','292243kyxNGh','getPaymentById','📊\x20Using\x20saved\x20amountAfterGatewayCommissionUSDT:\x20','usdtErcWallet','💱\x20Currency\x20filter\x20applied:\x20','SUSPENDED','values','count','totalCommissionRate','telegramId','gatewayOrderId','\x20no\x20longer\x20PAID:','customerName','📋\x20Found\x20','whiteUrl','\x20\x20\x20Transaction\x20hash:\x20','\x20\x20\x20Total\x20paid\x20out:\x20','\x20\x20\x20💰\x20Total\x20payout:\x20','aggregate','30d','\x20\x20\x20✅\x20Total\x20available\x20for\x20payout:\x20','💰\x20Payment\x20','📊\x20Gateway\x20filter\x20applied:','📊\x20Sorting\x20payments\x20by\x20','some','CHARGEBACK','gatewayEarnings','\x20\x20\x20Full\x20amount:\x20','Rapyd','not\x20set','Error\x20parsing\x20gateway\x20settings\x20for\x20shop\x20','rapyd','💸\x20CHARGEBACK:\x20Merchant\x20amount\x20already\x20deducted\x20from\x20balance','\x20\x20\x20Added\x20to\x20balance:\x20+','merchantEarnings','username','getMonth','paymentsCount','\x20USDT\x20(-','split','\x20active\x20merchants\x20for\x20selection','_sum','🔄\x20Updating\x20customer\x20data\x20for\x20payment\x20','💰\x20Shop\x20','paymentGateways','\x20->\x20','lte','test_gateway','🔐\x20[',']\x20Password\x20not\x20provided\x20or\x20empty,\x20skipping\x20password\x20update','KLYME\x20DE','\x20\x20\x20Current\x20total\x20paid\x20out:\x20','averageCheckUSDT','insensitive','payout','totalPayout','default','shop','getPayoutById','entries','REFUND','getAllPayouts','AdminService','push','Telegram\x20username\x20already\x20exists','\x20\x20\x20Current\x20balance:\x20',':\x20commission\x20=\x20','getFullYear','toLowerCase','\x20for\x20shop\x20','totalPayments','update','\x20\x20\x20Gateway:\x20','deletePayout','../config/database','usdtPolygonWallet','erc20','_count',',\x20Commission:\x20','createUser','\x20USDT\x20for\x20payment\x20','convertToUSDT','turnoverUSDT','65GOhtuH','gte','hex','trc20','totalAmountAfterCommissionUSDT','parse','year','\x20USDT)','\x20\x20\x20🖥️\x20User\x20Agent:\x20','not\x20specified','toString','Shop\x20not\x20found','week','gatewaySettings','🎯\x20updateUser\x20called\x20with\x20ID:\x20','payment','averageCommissionRate','\x20USDT\x20(theoretical\x20net)','pendingPayout','updateCustomerData',']\x20Gateway\x20settings\x20JSON\x20string:','73403dEKtBw','⚠️\x20Payment\x20','all','\x20USDT\x20(gross\x20revenue)','wallets','2267096ZnKipi','externalPaymentUrl','Username\x20already\x20exists','reduce','📅\x20Period:\x20','getMerchantStatistics','%\x20from\x20','__esModule','customerUa','⚠️\x20Requested\x20gateway\x20\x27','\x20missing\x20amountUSDT,\x20using\x20fallback\x20conversion','0000','\x27\x20as\x20is\x20(not\x20found\x20in\x20mappings)','\x20balance\x20updated:','\x20\x20\x20🏪\x20Gateway\x20earnings:\x20','PAID','updateUser','includes','\x20in\x20','getMerchantsSelection','chargebackAmount','currencyService','\x20\x20\x20💰\x20Total\x20turnover:\x20','cointopay','\x20\x20\x20�📊\x20Total\x20payments:\x20','round','getGatewayInternalName','🔄\x20Gateway\x20mapping\x20(get):','pendingUrl','dailyRevenue','60102FWjKhw','hash','\x20USDT\x20(actual\x20balances)','🔄\x20Converted\x20gateway\x20ID\x20\x27','269837pknvor','asc','\x20\x20\x20⏳\x20Pending\x20payout:\x20','orderId','paidAt','📊\x20Calculating\x20payout\x20statistics...','🔄\x20Gateway\x20mapping:','map','\x20became\x20PAID:','createdAt'];a36_0x4959=function(){return _0x4b6ae9;};return a36_0x4959();}const database_1=__importDefault(require(a36_0x378885(0x11d))),bcryptjs_1=__importDefault(require(a36_0x378885(0x184))),crypto_1=__importDefault(require(a36_0x378885(0x1dc))),currencyService_1=require(a36_0x378885(0x1e7)),gateway_1=require(a36_0x378885(0x1f5));function a36_0x21a0(_0x2f9e3c,_0x3ea686){const _0x4959dd=a36_0x4959();return a36_0x21a0=function(_0x21a09d,_0x36cfec){_0x21a09d=_0x21a09d-0xc2;let _0x1bb294=_0x4959dd[_0x21a09d];return _0x1bb294;},a36_0x21a0(_0x2f9e3c,_0x3ea686);}class AdminService{async[a36_0x378885(0x1ba)](){const _0x4104f1=a36_0x378885;console[_0x4104f1(0x1d8)](_0x4104f1(0x167));const _0x365188=await database_1['default'][_0x4104f1(0x10c)][_0x4104f1(0xe5)]({'_sum':{'balance':!![],'totalPaidOut':!![]},'where':{'status':_0x4104f1(0xcc)}}),_0x578c54=await this[_0x4104f1(0x1c8)]({'page':0x1,'limit':0x3e8}),_0x280df5=await database_1[_0x4104f1(0x10b)][_0x4104f1(0x135)]['count']({'where':{'status':'PAID','gateway':{'not':_0x4104f1(0x102)}}}),_0x5ac64b=new Date(),_0x16abb7=new Date(_0x5ac64b[_0x4104f1(0x116)](),_0x5ac64b[_0x4104f1(0xf7)](),0x1),_0x18ee10=new Date(_0x5ac64b[_0x4104f1(0x116)](),_0x5ac64b[_0x4104f1(0xf7)]()+0x1,0x0,0x17,0x3b,0x3b,0x3e7),_0x121c9f=await database_1[_0x4104f1(0x10b)][_0x4104f1(0x109)]['aggregate']({'_sum':{'amount':!![]},'where':{'createdAt':{'gte':_0x16abb7,'lte':_0x18ee10},'status':_0x4104f1(0xd1)}}),_0x48d6b7=_0x365188[_0x4104f1(0xfc)][_0x4104f1(0x1d6)]||0x0,_0x4caed1=_0x578c54['summary'][_0x4104f1(0x12a)],_0x2fc946=_0x121c9f[_0x4104f1(0xfc)]['amount']||0x0,_0x512987={'totalPayout':Math[_0x4104f1(0x159)](_0x48d6b7*0x64)/0x64,'awaitingPayout':Math['round'](_0x4caed1*0x64)/0x64,'thisMonth':Math[_0x4104f1(0x159)](_0x2fc946*0x64)/0x64,'availableBalance':Math[_0x4104f1(0x159)](_0x4caed1*0x64)/0x64,'totalPayments':_0x280df5};return console[_0x4104f1(0x1d8)](_0x4104f1(0x1af)),console['log'](_0x4104f1(0xe4)+_0x512987[_0x4104f1(0x10a)]+'\x20USDT\x20(total\x20paid\x20to\x20merchants)'),console[_0x4104f1(0x1d8)](_0x4104f1(0x17d)+_0x512987['awaitingPayout']+'\x20USDT\x20(with\x20commission\x20deducted)'),console['log']('\x20\x20\x20💵\x20Available\x20balance:\x20'+_0x512987[_0x4104f1(0x19d)]+'\x20USDT\x20(same\x20as\x20awaiting)'),console[_0x4104f1(0x1d8)](_0x4104f1(0x170)+_0x512987['thisMonth']+'\x20USDT'),console[_0x4104f1(0x1d8)](_0x4104f1(0x1ae)+_0x512987[_0x4104f1(0x119)]+'\x20PAID\x20payments'),console['log'](_0x4104f1(0xcd)+(_0x365188[_0x4104f1(0xfc)][_0x4104f1(0x19a)]||0x0)[_0x4104f1(0x18c)](0x2)+'\x20USDT\x20(without\x20commission)'),console[_0x4104f1(0x1d8)](_0x4104f1(0x1e5)+((_0x365188[_0x4104f1(0xfc)][_0x4104f1(0x19a)]||0x0)-_0x4caed1)[_0x4104f1(0x18c)](0x2)+_0x4104f1(0x180)),_0x512987;}async[a36_0x378885(0x139)](_0x7a8d77,_0x5d7451){const _0x1087b2=a36_0x378885;console[_0x1087b2(0x1d8)](_0x1087b2(0xfd)+_0x7a8d77+':',_0x5d7451);const _0x337e56=await database_1['default'][_0x1087b2(0x135)][_0x1087b2(0x1bc)]({'where':{'id':_0x7a8d77},'select':{'id':!![],'customerEmail':!![],'customerName':!![],'customerCountry':!![],'customerIp':!![],'customerUa':!![]}});if(!_0x337e56)throw new Error(_0x1087b2(0x1cb));const _0x3850cb={};_0x5d7451[_0x1087b2(0x188)]!==undefined&&(_0x3850cb[_0x1087b2(0x188)]=_0x5d7451[_0x1087b2(0x188)]||null);_0x5d7451[_0x1087b2(0x1a4)]!==undefined&&(_0x3850cb[_0x1087b2(0x1a4)]=_0x5d7451[_0x1087b2(0x1a4)]||null);_0x5d7451[_0x1087b2(0x148)]!==undefined&&(_0x3850cb['customerUa']=_0x5d7451[_0x1087b2(0x148)]||null);const _0x5c7d99=await database_1[_0x1087b2(0x10b)][_0x1087b2(0x135)][_0x1087b2(0x11a)]({'where':{'id':_0x7a8d77},'data':{..._0x3850cb,'updatedAt':new Date()},'select':{'id':!![],'customerEmail':!![],'customerName':!![],'customerCountry':!![],'customerIp':!![],'customerUa':!![],'updatedAt':!![]}});return console[_0x1087b2(0x1d8)]('✅\x20Customer\x20data\x20updated\x20for\x20payment\x20'+_0x7a8d77),console[_0x1087b2(0x1d8)]('\x20\x20\x20🌍\x20Country:\x20'+_0x337e56[_0x1087b2(0x188)]+'\x20->\x20'+_0x5c7d99[_0x1087b2(0x188)]),console[_0x1087b2(0x1d8)](_0x1087b2(0x1e4)+_0x337e56['customerIp']+_0x1087b2(0x100)+_0x5c7d99[_0x1087b2(0x1a4)]),console[_0x1087b2(0x1d8)](_0x1087b2(0x12e)+(_0x337e56[_0x1087b2(0x148)]?'set':_0x1087b2(0xf0))+_0x1087b2(0x100)+(_0x5c7d99['customerUa']?_0x1087b2(0x179):'not\x20set')),_0x5c7d99;}async['getSystemStatistics'](_0x1f043c){const _0x1ef886=a36_0x378885,_0x2ae4a8=new Date();let _0x16b8a0;switch(_0x1f043c){case'7d':_0x16b8a0=new Date(_0x2ae4a8['getTime']()-0x7*0x18*0x3c*0x3c*0x3e8);break;case _0x1ef886(0xe6):_0x16b8a0=new Date(_0x2ae4a8['getTime']()-0x1e*0x18*0x3c*0x3c*0x3e8);break;case'90d':_0x16b8a0=new Date(_0x2ae4a8[_0x1ef886(0x17c)]()-0x5a*0x18*0x3c*0x3c*0x3e8);break;case _0x1ef886(0x13d):const _0x447ad5=await database_1['default'][_0x1ef886(0x135)]['findFirst']({'where':{'gateway':{'not':_0x1ef886(0x102)}},'orderBy':{'createdAt':'asc'},'select':{'createdAt':!![]}});_0x16b8a0=_0x447ad5?_0x447ad5[_0x1ef886(0x16b)]:new Date(_0x1ef886(0x1ab)),console['log'](_0x1ef886(0x1c9)+_0x16b8a0[_0x1ef886(0x17f)]());break;default:_0x16b8a0=new Date(_0x2ae4a8[_0x1ef886(0x17c)]()-0x1e*0x18*0x3c*0x3c*0x3e8);}const [_0x5634ae,_0x3ba0b7,_0x458897,_0x2052a2,_0x139034,_0x7c9321]=await Promise[_0x1ef886(0x13d)]([database_1[_0x1ef886(0x10b)]['shop'][_0x1ef886(0xda)](),database_1[_0x1ef886(0x10b)][_0x1ef886(0x10c)][_0x1ef886(0xda)]({'where':{'status':_0x1ef886(0xcc)}}),database_1[_0x1ef886(0x10b)][_0x1ef886(0x135)]['count']({'where':{'status':_0x1ef886(0x14f),'createdAt':{'gte':_0x16b8a0},'gateway':{'not':_0x1ef886(0x102)}}}),database_1[_0x1ef886(0x10b)]['payment'][_0x1ef886(0x1b0)]({'where':{'status':'PAID','createdAt':{'gte':_0x16b8a0},'gateway':{'not':'test_gateway'}},'select':{'amount':!![],'currency':!![],'amountAfterGatewayCommissionUSDT':!![]}}),database_1[_0x1ef886(0x10b)][_0x1ef886(0x135)][_0x1ef886(0x1b0)]({'where':{'gateway':{'not':_0x1ef886(0x102)}},'take':0xa,'orderBy':{'createdAt':_0x1ef886(0x1d0)},'include':{'shop':{'select':{'name':!![],'username':!![]}}}}),database_1[_0x1ef886(0x10b)]['payment'][_0x1ef886(0x1b0)]({'where':{'createdAt':{'gte':_0x16b8a0},'gateway':{'not':'test_gateway'}},'select':{'amount':!![],'currency':!![],'status':!![],'amountUSDT':!![],'createdAt':!![]}})]);let _0x4446ca=0x0,_0x18729d=0x0;for(const _0x162267 of _0x2052a2){const _0x21bbc8=await currencyService_1[_0x1ef886(0x155)][_0x1ef886(0x124)](_0x162267['amount'],_0x162267['currency']);_0x4446ca+=_0x21bbc8;if(_0x162267['amountAfterGatewayCommissionUSDT']){const _0x43708b=await currencyService_1[_0x1ef886(0x155)]['convertToUSDT'](_0x162267['amount'],_0x162267[_0x1ef886(0x1e8)]),_0x1c21c8=_0x162267[_0x1ef886(0x1c5)],_0x582fb1=_0x43708b-_0x1c21c8;_0x18729d+=_0x582fb1;}}const _0x1ea213=_0x458897>0x0?_0x4446ca/_0x458897:0x0,_0x3b5886=this['generateDailyStatistics'](_0x7c9321,_0x16b8a0,_0x2ae4a8),_0x544be2=await database_1['default'][_0x1ef886(0x135)][_0x1ef886(0xda)]({'where':{'createdAt':{'gte':_0x16b8a0},'gateway':{'not':'test_gateway'}}}),_0x3d6ec5=_0x544be2>0x0?_0x458897/_0x544be2*0x64:0x0;return{'totalShops':_0x5634ae,'activeShops':_0x3ba0b7,'totalPayments':_0x458897,'successfulPayments':_0x458897,'totalAttempts':_0x544be2,'totalRevenue':Math[_0x1ef886(0x159)](_0x4446ca*0x64)/0x64,'trapayEarnings':Math[_0x1ef886(0x159)](_0x18729d*0x64)/0x64,'averagePaymentAmount':Math['round'](_0x1ea213*0x64)/0x64,'conversionRate':Math[_0x1ef886(0x159)](_0x3d6ec5*0x64)/0x64,'dailyRevenue':_0x3b5886[_0x1ef886(0x15d)],'dailyPayments':_0x3b5886['dailyPayments'],'recentPayments':_0x139034[_0x1ef886(0x169)](_0x1ad6d2=>({'id':_0x1ad6d2['id'],'amount':_0x1ad6d2[_0x1ef886(0x192)],'currency':_0x1ad6d2[_0x1ef886(0x1e8)],'status':_0x1ad6d2[_0x1ef886(0xc4)],'gateway':_0x1ad6d2[_0x1ef886(0x1d5)],'shop':_0x1ad6d2[_0x1ef886(0x10c)],'createdAt':_0x1ad6d2[_0x1ef886(0x16b)]}))};}async[a36_0x378885(0x145)](_0x46e1e9){const _0x2ec3fa=a36_0x378885;console['log'](_0x2ec3fa(0x1c7),_0x46e1e9);let _0x54e095,_0x104a1d=new Date();if(_0x46e1e9[_0x2ec3fa(0x1a5)]===_0x2ec3fa(0x181)&&_0x46e1e9['dateFrom']&&_0x46e1e9[_0x2ec3fa(0x19b)])_0x54e095=new Date(_0x46e1e9['dateFrom']),_0x104a1d=new Date(_0x46e1e9[_0x2ec3fa(0x19b)]);else{const _0x19c27e=new Date();switch(_0x46e1e9['period']){case _0x2ec3fa(0x132):_0x54e095=new Date(_0x19c27e[_0x2ec3fa(0x17c)]()-0x7*0x18*0x3c*0x3c*0x3e8);break;case _0x2ec3fa(0x1b7):_0x54e095=new Date(_0x19c27e[_0x2ec3fa(0x17c)]()-0x1e*0x18*0x3c*0x3c*0x3e8);break;case _0x2ec3fa(0x12c):_0x54e095=new Date(_0x19c27e['getTime']()-0x16d*0x18*0x3c*0x3c*0x3e8);break;case _0x2ec3fa(0x13d):default:_0x54e095=new Date(_0x2ec3fa(0x1ab));break;}}console[_0x2ec3fa(0x1d8)](_0x2ec3fa(0x144)+_0x54e095[_0x2ec3fa(0x17f)]()+'\x20to\x20'+_0x104a1d[_0x2ec3fa(0x17f)]());const _0x1ca7ea={'status':'PAID','gateway':{'not':_0x2ec3fa(0x102)},'paidAt':{'gte':_0x54e095,'lte':_0x104a1d}};_0x46e1e9[_0x2ec3fa(0x1f6)]&&(_0x1ca7ea[_0x2ec3fa(0x1f6)]=_0x46e1e9['shopId']);const _0x4805db=await database_1[_0x2ec3fa(0x10b)][_0x2ec3fa(0x135)][_0x2ec3fa(0x1b0)]({'where':_0x1ca7ea,'include':{'shop':{'select':{'id':!![],'name':!![],'username':!![],'gatewaySettings':!![]}}}});console[_0x2ec3fa(0x1d8)]('💰\x20Found\x20'+_0x4805db[_0x2ec3fa(0x1a2)]+'\x20paid\x20payments\x20for\x20analysis');const _0x37fcdf={'gateway':{'not':'test_gateway'},'createdAt':{'gte':_0x54e095,'lte':_0x104a1d}};_0x46e1e9[_0x2ec3fa(0x1f6)]&&(_0x37fcdf['shopId']=_0x46e1e9[_0x2ec3fa(0x1f6)]);const _0x26b451=await database_1[_0x2ec3fa(0x10b)][_0x2ec3fa(0x135)][_0x2ec3fa(0xda)]({'where':_0x37fcdf});console['log'](_0x2ec3fa(0x1cd)+_0x26b451+_0x2ec3fa(0x176)+_0x4805db[_0x2ec3fa(0x1a2)]);let _0x10aacc=0x0,_0x31061c=0x0,_0x4068ad=0x0;const _0x9dea4={},_0x7d35d8={},_0x38a4f6={};for(const _0x4a1290 of _0x4805db){try{const _0x156598=await currencyService_1[_0x2ec3fa(0x155)][_0x2ec3fa(0x124)](_0x4a1290['amount'],_0x4a1290[_0x2ec3fa(0x1e8)]);let _0x2969cf={};if(_0x4a1290['shop'][_0x2ec3fa(0x133)])try{_0x2969cf=JSON[_0x2ec3fa(0x12b)](_0x4a1290['shop'][_0x2ec3fa(0x133)]);}catch(_0x4142f8){console['error']('Error\x20parsing\x20gateway\x20settings\x20for\x20shop\x20'+_0x4a1290[_0x2ec3fa(0x1f6)]+':',_0x4142f8);}let _0x157cf1={},_0x14b826=0xa;for(const [_0x23914f,_0x2b4779]of Object[_0x2ec3fa(0x10e)](_0x2969cf)){if(_0x23914f[_0x2ec3fa(0x117)]()===_0x4a1290[_0x2ec3fa(0x1d5)][_0x2ec3fa(0x117)]()){_0x157cf1=_0x2b4779,_0x14b826=_0x2b4779[_0x2ec3fa(0x1b5)]||0xa;break;}}let _0x18094a,_0x647cc3;_0x4a1290['amountAfterGatewayCommissionUSDT']!==null&&_0x4a1290['amountAfterGatewayCommissionUSDT']!==undefined?(_0x18094a=_0x4a1290[_0x2ec3fa(0x1c5)],_0x647cc3=_0x156598-_0x18094a,console[_0x2ec3fa(0x1d8)](_0x2ec3fa(0xd5)+_0x18094a[_0x2ec3fa(0x18c)](0x6)+_0x2ec3fa(0x123)+_0x4a1290['id'])):(_0x647cc3=_0x156598*(_0x14b826/0x64),_0x18094a=_0x156598-_0x647cc3,console['log']('📊\x20Calculating\x20commission\x20manually\x20for\x20payment\x20'+_0x4a1290['id']+':\x20'+_0x14b826+_0x2ec3fa(0x146)+_0x156598[_0x2ec3fa(0x18c)](0x6)+_0x2ec3fa(0x180)));_0x10aacc+=_0x156598,_0x31061c+=_0x18094a,_0x4068ad+=_0x647cc3;!_0x9dea4[_0x4a1290[_0x2ec3fa(0x1d5)]]&&(_0x9dea4[_0x4a1290['gateway']]={'gateway':_0x4a1290['gateway'],'gatewayDisplayName':this[_0x2ec3fa(0x177)](_0x4a1290[_0x2ec3fa(0x1d5)]),'paymentsCount':0x0,'turnoverUSDT':0x0,'commissionUSDT':0x0,'merchantEarningsUSDT':0x0,'totalCommissionRate':0x0});_0x9dea4[_0x4a1290[_0x2ec3fa(0x1d5)]][_0x2ec3fa(0xf8)]++,_0x9dea4[_0x4a1290['gateway']][_0x2ec3fa(0x125)]+=_0x156598,_0x9dea4[_0x4a1290['gateway']]['commissionUSDT']+=_0x647cc3,_0x9dea4[_0x4a1290[_0x2ec3fa(0x1d5)]][_0x2ec3fa(0x1ca)]+=_0x18094a,_0x9dea4[_0x4a1290[_0x2ec3fa(0x1d5)]]['totalCommissionRate']+=_0x14b826;!_0x46e1e9[_0x2ec3fa(0x1f6)]&&(!_0x7d35d8[_0x4a1290[_0x2ec3fa(0x1f6)]]&&(_0x7d35d8[_0x4a1290[_0x2ec3fa(0x1f6)]]={'shopId':_0x4a1290[_0x2ec3fa(0x1f6)],'shopName':_0x4a1290['shop'][_0x2ec3fa(0xca)],'shopUsername':_0x4a1290[_0x2ec3fa(0x10c)][_0x2ec3fa(0xf6)],'paymentsCount':0x0,'turnoverUSDT':0x0,'commissionUSDT':0x0,'merchantEarningsUSDT':0x0,'paidOutUSDT':0x0,'averageCheckUSDT':0x0}),_0x7d35d8[_0x4a1290[_0x2ec3fa(0x1f6)]][_0x2ec3fa(0xf8)]++,_0x7d35d8[_0x4a1290[_0x2ec3fa(0x1f6)]][_0x2ec3fa(0x125)]+=_0x156598,_0x7d35d8[_0x4a1290[_0x2ec3fa(0x1f6)]][_0x2ec3fa(0xc7)]+=_0x647cc3,_0x7d35d8[_0x4a1290[_0x2ec3fa(0x1f6)]][_0x2ec3fa(0x1ca)]+=_0x18094a);const _0x4762aa=_0x4a1290[_0x2ec3fa(0x166)][_0x2ec3fa(0x17f)]()[_0x2ec3fa(0xfa)]('T')[0x0];!_0x38a4f6[_0x4762aa]&&(_0x38a4f6[_0x4762aa]={'date':_0x4762aa,'turnover':0x0,'merchantEarnings':0x0,'gatewayEarnings':0x0,'paymentsCount':0x0}),_0x38a4f6[_0x4762aa][_0x2ec3fa(0x1dd)]+=_0x156598,_0x38a4f6[_0x4762aa][_0x2ec3fa(0xf5)]+=_0x18094a,_0x38a4f6[_0x4762aa]['gatewayEarnings']+=_0x647cc3,_0x38a4f6[_0x4762aa][_0x2ec3fa(0xf8)]++;}catch(_0x1842cc){console[_0x2ec3fa(0x1e1)](_0x2ec3fa(0xd0)+_0x4a1290['id']+':',_0x1842cc);}}Object[_0x2ec3fa(0xd9)](_0x9dea4)['forEach'](_0x1c69d6=>{const _0x4ec9b4=_0x2ec3fa;_0x1c69d6[_0x4ec9b4(0x136)]=_0x1c69d6[_0x4ec9b4(0xf8)]>0x0?_0x1c69d6[_0x4ec9b4(0xdb)]/_0x1c69d6[_0x4ec9b4(0xf8)]:0x0,delete _0x1c69d6['totalCommissionRate'];}),Object['values'](_0x7d35d8)[_0x2ec3fa(0xc3)](_0x345eea=>{const _0x81a93b=_0x2ec3fa;_0x345eea['averageCheckUSDT']=_0x345eea[_0x81a93b(0xf8)]>0x0?_0x345eea[_0x81a93b(0x125)]/_0x345eea[_0x81a93b(0xf8)]:0x0;});let _0x538f4f=0x0,_0x3f4952=0x0;if(_0x46e1e9[_0x2ec3fa(0x1f6)]){const _0x38d3a3=await database_1[_0x2ec3fa(0x10b)][_0x2ec3fa(0x109)]['findMany']({'where':{'shopId':_0x46e1e9[_0x2ec3fa(0x1f6)],'status':_0x2ec3fa(0xd1),'createdAt':{'gte':_0x54e095,'lte':_0x104a1d}},'select':{'amount':!![]}});_0x538f4f=_0x38d3a3[_0x2ec3fa(0x143)]((_0x38ddc2,_0x133513)=>_0x38ddc2+_0x133513[_0x2ec3fa(0x192)],0x0);const _0x184a4e=await database_1[_0x2ec3fa(0x10b)][_0x2ec3fa(0x109)][_0x2ec3fa(0x1b0)]({'where':{'shopId':_0x46e1e9[_0x2ec3fa(0x1f6)],'status':'PENDING','createdAt':{'gte':_0x54e095,'lte':_0x104a1d}},'select':{'amount':!![]}});_0x3f4952=_0x184a4e[_0x2ec3fa(0x143)]((_0x5fb985,_0x384b59)=>_0x5fb985+_0x384b59[_0x2ec3fa(0x192)],0x0);}const _0x147cd1=_0x26b451,_0x13cd86=_0x4805db['length'],_0x406697=_0x13cd86>0x0?_0x10aacc/_0x13cd86:0x0,_0x4afc30=_0x147cd1>0x0?Math[_0x2ec3fa(0x159)](_0x13cd86/_0x147cd1*0x2710)/0x64:0x0,_0x17cd6e=Math[_0x2ec3fa(0x1ea)]((_0x104a1d['getTime']()-_0x54e095[_0x2ec3fa(0x17c)]())/(0x3e8*0x3c*0x3c*0x18)),_0x4532c8={'totalTurnover':Math['round'](_0x10aacc*0x64)/0x64,'merchantEarnings':Math[_0x2ec3fa(0x159)](_0x31061c*0x64)/0x64,'gatewayEarnings':Math[_0x2ec3fa(0x159)](_0x4068ad*0x64)/0x64,'totalPaidOut':Math[_0x2ec3fa(0x159)](_0x538f4f*0x64)/0x64,'pendingPayout':Math[_0x2ec3fa(0x159)](_0x3f4952*0x64)/0x64,'averageCheck':Math['round'](_0x406697*0x64)/0x64,'totalPayments':_0x147cd1,'successfulPayments':_0x13cd86,'conversionRate':_0x4afc30,'gatewayBreakdown':Object[_0x2ec3fa(0xd9)](_0x9dea4)[_0x2ec3fa(0x169)](_0x15f4ee=>({..._0x15f4ee,'turnoverUSDT':Math[_0x2ec3fa(0x159)](_0x15f4ee[_0x2ec3fa(0x125)]*0x64)/0x64,'commissionUSDT':Math[_0x2ec3fa(0x159)](_0x15f4ee[_0x2ec3fa(0xc7)]*0x64)/0x64,'merchantEarningsUSDT':Math[_0x2ec3fa(0x159)](_0x15f4ee[_0x2ec3fa(0x1ca)]*0x64)/0x64,'averageCommissionRate':Math['round'](_0x15f4ee[_0x2ec3fa(0x136)]*0x64)/0x64})),'merchantBreakdown':_0x46e1e9['shopId']?undefined:Object[_0x2ec3fa(0xd9)](_0x7d35d8)[_0x2ec3fa(0x169)](_0x5c5e77=>({..._0x5c5e77,'turnoverUSDT':Math[_0x2ec3fa(0x159)](_0x5c5e77['turnoverUSDT']*0x64)/0x64,'commissionUSDT':Math[_0x2ec3fa(0x159)](_0x5c5e77['commissionUSDT']*0x64)/0x64,'merchantEarningsUSDT':Math[_0x2ec3fa(0x159)](_0x5c5e77['merchantEarningsUSDT']*0x64)/0x64,'paidOutUSDT':Math[_0x2ec3fa(0x159)](_0x5c5e77['paidOutUSDT']*0x64)/0x64,'averageCheckUSDT':Math['round'](_0x5c5e77[_0x2ec3fa(0x107)]*0x64)/0x64})),'dailyData':Object[_0x2ec3fa(0xd9)](_0x38a4f6)[_0x2ec3fa(0x169)](_0x33e765=>({..._0x33e765,'turnover':Math['round'](_0x33e765[_0x2ec3fa(0x1dd)]*0x64)/0x64,'merchantEarnings':Math[_0x2ec3fa(0x159)](_0x33e765['merchantEarnings']*0x64)/0x64,'gatewayEarnings':Math[_0x2ec3fa(0x159)](_0x33e765[_0x2ec3fa(0xed)]*0x64)/0x64}))[_0x2ec3fa(0x185)]((_0x3b1986,_0x44554f)=>_0x3b1986['date']['localeCompare'](_0x44554f[_0x2ec3fa(0x1df)])),'periodInfo':{'from':_0x54e095,'to':_0x104a1d,'periodType':_0x46e1e9[_0x2ec3fa(0x1a5)]||_0x2ec3fa(0x181),'daysCount':_0x17cd6e}};return console['log'](_0x2ec3fa(0x1aa)),console[_0x2ec3fa(0x1d8)](_0x2ec3fa(0x156)+_0x4532c8['totalTurnover']+_0x2ec3fa(0x180)),console[_0x2ec3fa(0x1d8)]('\x20\x20\x20👤\x20Merchant\x20earnings:\x20'+_0x4532c8[_0x2ec3fa(0xf5)]+_0x2ec3fa(0x180)),console['log'](_0x2ec3fa(0x14e)+_0x4532c8[_0x2ec3fa(0xed)]+'\x20USDT'),console['log']('\x20\x20\x20�\x20Total\x20paid\x20out:\x20'+_0x4532c8[_0x2ec3fa(0x1d6)]+_0x2ec3fa(0x180)),console[_0x2ec3fa(0x1d8)](_0x2ec3fa(0x164)+_0x4532c8[_0x2ec3fa(0x138)]+_0x2ec3fa(0x180)),console['log'](_0x2ec3fa(0x158)+_0x4532c8[_0x2ec3fa(0x119)]),_0x4532c8;}async[a36_0x378885(0x153)](){const _0xa04e7b=a36_0x378885;console[_0xa04e7b(0x1d8)]('📋\x20Getting\x20merchants\x20selection\x20list...');const _0x476a6d=await database_1[_0xa04e7b(0x10b)][_0xa04e7b(0x10c)]['findMany']({'where':{'status':_0xa04e7b(0xcc)},'select':{'id':!![],'username':!![],'name':!![]},'orderBy':{'name':_0xa04e7b(0x163)}});return console['log'](_0xa04e7b(0xe0)+_0x476a6d[_0xa04e7b(0x1a2)]+_0xa04e7b(0xfb)),_0x476a6d[_0xa04e7b(0x169)](_0x11ce3f=>({'id':_0x11ce3f['id'],'username':_0x11ce3f['username'],'name':_0x11ce3f[_0xa04e7b(0xca)]}));}[a36_0x378885(0x177)](_0x251b2e){const _0x4fa6ba=a36_0x378885,_0x201f25={'test_gateway':_0x4fa6ba(0x178),'plisio':'Plisio','rapyd':_0x4fa6ba(0xef),'noda':_0x4fa6ba(0x1b6),'cointopay':_0x4fa6ba(0x1e2),'cointopay2':'Open\x20Banking\x202','klyme_eu':_0x4fa6ba(0x1ef),'klyme_gb':_0x4fa6ba(0x1d4),'klyme_de':_0x4fa6ba(0x105),'mastercard':_0x4fa6ba(0x19e)};return _0x201f25[_0x251b2e]||_0x251b2e;}[a36_0x378885(0x15a)](_0x5957c8){const _0x5584ec=a36_0x378885,_0x98b234={'Test\x20Gateway':_0x5584ec(0x102),'Plisio':_0x5584ec(0x172),'Rapyd':_0x5584ec(0xf2),'Noda':'noda','CoinToPay':_0x5584ec(0x157),'CoinToPay2':'cointopay2','KLYME\x20EU':'klyme_eu','KLYME\x20GB':_0x5584ec(0x18f),'KLYME\x20DE':_0x5584ec(0x1c0),'MasterCard':_0x5584ec(0x1a0)};return _0x98b234[_0x5957c8]||_0x5957c8[_0x5584ec(0x117)]();}async[a36_0x378885(0x1c8)](_0x4aee64){const _0x142606=a36_0x378885,{page:_0x5df655,limit:_0x4117c7,minAmount:_0x5d63d2,search:_0x2bae21}=_0x4aee64,_0x468ca5=(_0x5df655-0x1)*_0x4117c7;console[_0x142606(0x1d8)](_0x142606(0x195),_0x4aee64);const _0x54f084={'balance':{'gt':0x0},'status':_0x142606(0xcc)};_0x5d63d2&&(_0x54f084[_0x142606(0x19a)][_0x142606(0x127)]=_0x5d63d2);_0x2bae21&&(_0x54f084['OR']=[{'name':{'contains':_0x2bae21,'mode':_0x142606(0x108)}},{'username':{'contains':_0x2bae21,'mode':_0x142606(0x108)}}]);const [_0x5e72f1,_0x97d478]=await Promise[_0x142606(0x13d)]([database_1['default'][_0x142606(0x10c)][_0x142606(0x1b0)]({'where':_0x54f084,'skip':_0x468ca5,'take':_0x4117c7,'orderBy':{'balance':_0x142606(0x1d0)},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'balance':!![],'totalPaidOut':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'gatewaySettings':!![],'createdAt':!![]}}),database_1[_0x142606(0x10b)][_0x142606(0x10c)][_0x142606(0xda)]({'where':_0x54f084})]);console['log']('💰\x20Found\x20'+_0x5e72f1[_0x142606(0x1a2)]+'\x20merchants\x20with\x20positive\x20balance');const _0x5b91a9=await Promise[_0x142606(0x13d)](_0x5e72f1[_0x142606(0x169)](async _0x6551e9=>{const _0x4099e9=_0x142606,[_0x1859b3,_0x46b009,_0x4a2a8b]=await Promise[_0x4099e9(0x13d)]([database_1[_0x4099e9(0x10b)]['payment']['count']({'where':{'shopId':_0x6551e9['id'],'status':'PAID','gateway':{'not':'test_gateway'}}}),database_1[_0x4099e9(0x10b)][_0x4099e9(0x135)][_0x4099e9(0x1d3)]({'where':{'shopId':_0x6551e9['id'],'status':_0x4099e9(0x14f),'gateway':{'not':_0x4099e9(0x102)}},'orderBy':{'paidAt':'asc'},'select':{'paidAt':!![]}}),database_1[_0x4099e9(0x10b)]['payment'][_0x4099e9(0xc5)]({'by':[_0x4099e9(0x1d5)],'where':{'shopId':_0x6551e9['id'],'status':_0x4099e9(0x14f),'gateway':{'not':_0x4099e9(0x102)}},'_count':{'id':!![]},'_sum':{'amountUSDT':!![]}})]),_0x596495=new Date(),_0x22341a=new Date(_0x596495[_0x4099e9(0x116)](),_0x596495[_0x4099e9(0xf7)](),0x1),_0x3fd404=new Date(_0x596495['getFullYear'](),_0x596495[_0x4099e9(0xf7)]()+0x1,0x0,0x17,0x3b,0x3b,0x3e7),[_0x54fd6a,_0x22ca2c]=await Promise[_0x4099e9(0x13d)]([database_1[_0x4099e9(0x10b)][_0x4099e9(0x109)][_0x4099e9(0xe5)]({'_sum':{'amount':!![]},'where':{'shopId':_0x6551e9['id'],'status':_0x4099e9(0xd1)}}),database_1['default'][_0x4099e9(0x109)][_0x4099e9(0xe5)]({'_sum':{'amount':!![]},'where':{'shopId':_0x6551e9['id'],'status':_0x4099e9(0xd1),'createdAt':{'gte':_0x22341a,'lte':_0x3fd404}}})]),_0x1df2a6=_0x54fd6a[_0x4099e9(0xfc)][_0x4099e9(0x192)]||0x0,_0x28b4bf=_0x22ca2c[_0x4099e9(0xfc)][_0x4099e9(0x192)]||0x0,_0x2ab393=await Promise['all'](_0x4a2a8b[_0x4099e9(0x169)](async _0x475c82=>{const _0x294096=_0x4099e9;let _0x362a35=0xa;if(_0x6551e9['gatewaySettings'])try{const _0x5759df=JSON[_0x294096(0x12b)](_0x6551e9[_0x294096(0x133)]);for(const [_0x375076,_0x2939f6]of Object[_0x294096(0x10e)](_0x5759df)){if(_0x375076[_0x294096(0x117)]()===_0x475c82[_0x294096(0x1d5)][_0x294096(0x117)]()){_0x362a35=_0x2939f6['commission']||0xa,console[_0x294096(0x1d8)](_0x294096(0x1bf)+_0x475c82[_0x294096(0x1d5)]+_0x294096(0x118)+_0x6551e9['id']+_0x294096(0x115)+_0x362a35+'%');break;}}}catch(_0x1a5c4b){console['error'](_0x294096(0xf1)+_0x6551e9['id']+':',_0x1a5c4b);}const _0x4b0510=_0x475c82[_0x294096(0xfc)]?.[_0x294096(0x1d1)]||0x0,_0x31982f=_0x4b0510*(0x1-_0x362a35/0x64);return{'gateway':_0x475c82[_0x294096(0x1d5)],'count':_0x475c82['_count']?.['id']||0x0,'amountUSDT':Math['round'](_0x4b0510*0x64)/0x64,'amountAfterCommissionUSDT':Math[_0x294096(0x159)](_0x31982f*0x64)/0x64,'commission':_0x362a35};})),_0x58dcf3=_0x2ab393[_0x4099e9(0x143)]((_0x17ea53,_0x5be870)=>_0x17ea53+_0x5be870['amountUSDT'],0x0),_0x2cabde=_0x6551e9[_0x4099e9(0x19a)];return console[_0x4099e9(0x1d8)](_0x4099e9(0x1ec)+_0x6551e9[_0x4099e9(0xf6)]+':'),console[_0x4099e9(0x1d8)]('\x20\x20\x20�\x20Total\x20payments\x20turnover:\x20'+_0x58dcf3[_0x4099e9(0x18c)](0x2)+_0x4099e9(0x13e)),console[_0x4099e9(0x1d8)]('\x20\x20\x20🔍\x20Calculated\x20after\x20commission:\x20'+_0x2ab393['reduce']((_0x498b9c,_0x589b62)=>_0x498b9c+_0x589b62[_0x4099e9(0x1eb)],0x0)[_0x4099e9(0x18c)](0x2)+_0x4099e9(0x137)),console['log'](_0x4099e9(0x1f8)+_0x2cabde[_0x4099e9(0x18c)](0x2)+_0x4099e9(0x199)),{'id':_0x6551e9['id'],'fullName':_0x6551e9[_0x4099e9(0xca)],'username':_0x6551e9[_0x4099e9(0xf6)],'telegramId':_0x6551e9[_0x4099e9(0x182)],'merchantUrl':_0x6551e9[_0x4099e9(0x1a7)],'wallets':{'usdtPolygonWallet':_0x6551e9[_0x4099e9(0x11e)],'usdtTrcWallet':_0x6551e9[_0x4099e9(0x1be)],'usdtErcWallet':_0x6551e9[_0x4099e9(0xd6)],'usdcPolygonWallet':_0x6551e9[_0x4099e9(0x1bd)]},'totalAmountUSDT':Math[_0x4099e9(0x159)](_0x58dcf3*0x64)/0x64,'totalAmountAfterCommissionUSDT':Math['round'](_0x2cabde*0x64)/0x64,'totalPayout':Math['round'](_0x1df2a6*0x64)/0x64,'thisMonth':Math[_0x4099e9(0x159)](_0x28b4bf*0x64)/0x64,'paymentsCount':_0x1859b3,'oldestPaymentDate':_0x46b009?.[_0x4099e9(0x166)]||_0x6551e9[_0x4099e9(0x16b)],'gatewayBreakdown':_0x2ab393};})),_0x4808f9=_0x5b91a9[_0x142606(0x143)]((_0x172bde,_0x44a391)=>_0x172bde+_0x44a391['totalAmountUSDT'],0x0),_0x51e86e=_0x5b91a9[_0x142606(0x143)]((_0x180f1e,_0x2553fc)=>_0x180f1e+_0x2553fc[_0x142606(0x12a)],0x0),_0x4a0f18=_0x5b91a9[_0x142606(0x143)]((_0x328637,_0x4e12f3)=>_0x328637+_0x4e12f3[_0x142606(0x10a)],0x0),_0xdf35e9=_0x5b91a9[_0x142606(0x143)]((_0x421f08,_0x2c9ca8)=>_0x421f08+_0x2c9ca8[_0x142606(0x1b9)],0x0);return console[_0x142606(0x1d8)]('📊\x20Merchants\x20awaiting\x20payout:\x20'+_0x97d478+'\x20merchants'),console[_0x142606(0x1d8)](_0x142606(0x183)+Math[_0x142606(0x159)](_0x4808f9*0x64)/0x64+_0x142606(0x13e)),console[_0x142606(0x1d8)](_0x142606(0xe7)+Math[_0x142606(0x159)](_0x51e86e*0x64)/0x64+_0x142606(0x160)),console['log'](_0x142606(0x16c)+Math[_0x142606(0x159)](_0x4a0f18*0x64)/0x64+'\x20USDT'),console['log'](_0x142606(0xc8)+Math[_0x142606(0x159)](_0xdf35e9*0x64)/0x64+_0x142606(0x180)),{'merchants':_0x5b91a9,'pagination':{'page':_0x5df655,'limit':_0x4117c7,'total':_0x97d478,'totalPages':Math[_0x142606(0x1ea)](_0x97d478/_0x4117c7)},'summary':{'totalMerchants':_0x97d478,'totalAmountUSDT':Math['round'](_0x4808f9*0x64)/0x64,'totalAmountAfterCommissionUSDT':Math[_0x142606(0x159)](_0x51e86e*0x64)/0x64,'totalPayout':Math[_0x142606(0x159)](_0x4a0f18*0x64)/0x64,'thisMonth':Math[_0x142606(0x159)](_0xdf35e9*0x64)/0x64}};}async['createPayout'](_0x4ce34f){const _0x14e11e=a36_0x378885,{shopId:_0x371f02,amount:_0x4ccb22,network:_0x53f277,wallet:_0x11bf95,notes:_0x4090e9,txid:_0x443b8c,periodFrom:_0x2675cb,periodTo:_0x23b4e0}=_0x4ce34f,_0x567c50=await database_1['default'][_0x14e11e(0x1ed)](async _0x35b900=>{const _0x30c9e7=_0x14e11e,_0x240f28=await _0x35b900[_0x30c9e7(0x10c)][_0x30c9e7(0x1bc)]({'where':{'id':_0x371f02},'select':{'id':!![],'name':!![],'username':!![],'balance':!![],'totalPaidOut':!![]}});if(!_0x240f28)throw new Error(_0x30c9e7(0x131));console[_0x30c9e7(0x1d8)]('💰\x20Creating\x20payout\x20for\x20shop\x20'+_0x240f28['username']+':'),console[_0x30c9e7(0x1d8)](_0x30c9e7(0x114)+_0x240f28['balance'][_0x30c9e7(0x18c)](0x6)+_0x30c9e7(0x180)),console['log']('\x20\x20\x20Payout\x20amount:\x20'+_0x4ccb22['toFixed'](0x6)+'\x20USDT'),console['log'](_0x30c9e7(0x106)+_0x240f28[_0x30c9e7(0x1d6)]['toFixed'](0x6)+_0x30c9e7(0x180));if(_0x443b8c)console[_0x30c9e7(0x1d8)](_0x30c9e7(0xe2)+_0x443b8c);if(_0x240f28[_0x30c9e7(0x19a)]<_0x4ccb22)throw new Error(_0x30c9e7(0x19f)+_0x240f28[_0x30c9e7(0x19a)][_0x30c9e7(0x18c)](0x6)+'\x20USDT,\x20Requested:\x20'+_0x4ccb22[_0x30c9e7(0x18c)](0x6)+_0x30c9e7(0x180));let _0x915fdf=_0x11bf95;if(!_0x915fdf){const _0x5bebbb=await _0x35b900[_0x30c9e7(0x10c)][_0x30c9e7(0x1bc)]({'where':{'id':_0x371f02},'select':{'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![]}});if(_0x5bebbb)switch(_0x53f277){case'polygon':_0x915fdf=_0x5bebbb[_0x30c9e7(0x11e)]||undefined;break;case _0x30c9e7(0x129):_0x915fdf=_0x5bebbb['usdtTrcWallet']||undefined;break;case _0x30c9e7(0x11f):_0x915fdf=_0x5bebbb[_0x30c9e7(0xd6)]||undefined;break;case'polygon_usdc':_0x915fdf=_0x5bebbb[_0x30c9e7(0x1bd)]||undefined;break;}}console[_0x30c9e7(0x1d8)](_0x30c9e7(0x1f9)+_0x53f277+':\x20'+(_0x915fdf||_0x30c9e7(0x12f)));const _0x2b7c03=await _0x35b900[_0x30c9e7(0x109)]['create']({'data':{'shopId':_0x371f02,'amount':_0x4ccb22,'network':_0x53f277,'status':_0x30c9e7(0xd1),'txid':_0x443b8c,'notes':_0x4090e9,'periodFrom':_0x2675cb?new Date(_0x2675cb):null,'periodTo':_0x23b4e0?new Date(_0x23b4e0):null,'createdAt':new Date(),'paidAt':new Date()}}),_0x5983c2=_0x240f28[_0x30c9e7(0x19a)]-_0x4ccb22,_0x30a7e5=_0x240f28[_0x30c9e7(0x1d6)]+_0x4ccb22;return await _0x35b900[_0x30c9e7(0x10c)][_0x30c9e7(0x11a)]({'where':{'id':_0x371f02},'data':{'balance':_0x5983c2,'totalPaidOut':_0x30a7e5}}),console[_0x30c9e7(0x1d8)](_0x30c9e7(0xfe)+_0x240f28[_0x30c9e7(0xf6)]+_0x30c9e7(0x14d)),console[_0x30c9e7(0x1d8)](_0x30c9e7(0x17b)+_0x240f28['balance'][_0x30c9e7(0x18c)](0x6)+_0x30c9e7(0x100)+_0x5983c2[_0x30c9e7(0x18c)](0x6)+_0x30c9e7(0xf9)+_0x4ccb22[_0x30c9e7(0x18c)](0x6)+')'),console[_0x30c9e7(0x1d8)](_0x30c9e7(0xe3)+_0x240f28[_0x30c9e7(0x1d6)][_0x30c9e7(0x18c)](0x6)+_0x30c9e7(0x100)+_0x30a7e5[_0x30c9e7(0x18c)](0x6)+_0x30c9e7(0x190)+_0x4ccb22['toFixed'](0x6)+')'),{'payout':_0x2b7c03,'shop':_0x240f28};});return console[_0x14e11e(0x1d8)]('✅\x20Payout\x20created:\x20'+_0x567c50[_0x14e11e(0x109)]['id']+_0x14e11e(0x118)+_0x567c50['shop']['username']+'\x20('+_0x4ccb22+_0x14e11e(0x12d)),{'id':_0x567c50[_0x14e11e(0x109)]['id'],'shopId':_0x567c50[_0x14e11e(0x109)][_0x14e11e(0x1f6)],'shopName':_0x567c50['shop'][_0x14e11e(0xca)],'shopUsername':_0x567c50[_0x14e11e(0x10c)][_0x14e11e(0xf6)],'amount':_0x567c50[_0x14e11e(0x109)][_0x14e11e(0x192)],'network':_0x567c50[_0x14e11e(0x109)][_0x14e11e(0x1f2)],'status':_0x567c50[_0x14e11e(0x109)][_0x14e11e(0xc4)],'txid':_0x567c50[_0x14e11e(0x109)][_0x14e11e(0x1fa)],'notes':_0x567c50[_0x14e11e(0x109)]['notes'],'periodFrom':_0x567c50[_0x14e11e(0x109)]['periodFrom'],'periodTo':_0x567c50[_0x14e11e(0x109)][_0x14e11e(0x173)],'createdAt':_0x567c50['payout']['createdAt'],'paidAt':_0x567c50[_0x14e11e(0x109)][_0x14e11e(0x166)]};}async[a36_0x378885(0x110)](_0x3c70ed){const _0x5ec1f0=a36_0x378885,{page:_0x5704be,limit:_0x1c9739,shopId:_0xd8dfa8,network:_0x102209,dateFrom:_0x181550,dateTo:_0x5afc04,search:_0x1440cb}=_0x3c70ed,_0x50e714=(_0x5704be-0x1)*_0x1c9739,_0x500148={};_0xd8dfa8&&(_0x500148[_0x5ec1f0(0x1f6)]=_0xd8dfa8);_0x102209&&(_0x500148[_0x5ec1f0(0x1f2)]=_0x102209);(_0x181550||_0x5afc04)&&(_0x500148[_0x5ec1f0(0x16b)]={},_0x181550&&(_0x500148[_0x5ec1f0(0x16b)][_0x5ec1f0(0x127)]=new Date(_0x181550)),_0x5afc04&&(_0x500148[_0x5ec1f0(0x16b)][_0x5ec1f0(0x101)]=new Date(_0x5afc04)));_0x1440cb&&(_0x500148['OR']=[{'shop':{'name':{'contains':_0x1440cb,'mode':'insensitive'}}},{'shop':{'username':{'contains':_0x1440cb,'mode':_0x5ec1f0(0x108)}}},{'notes':{'contains':_0x1440cb,'mode':_0x5ec1f0(0x108)}}]);const [_0x2b55e3,_0x235082]=await Promise[_0x5ec1f0(0x13d)]([database_1['default'][_0x5ec1f0(0x109)][_0x5ec1f0(0x1b0)]({'where':_0x500148,'skip':_0x50e714,'take':_0x1c9739,'orderBy':{'createdAt':'desc'},'select':{'id':!![],'shopId':!![],'amount':!![],'network':!![],'status':!![],'txid':!![],'notes':!![],'periodFrom':!![],'periodTo':!![],'createdAt':!![],'paidAt':!![],'shop':{'select':{'name':!![],'username':!![]}}}}),database_1['default']['payout'][_0x5ec1f0(0xda)]({'where':_0x500148})]);return{'payouts':_0x2b55e3['map'](_0x364206=>({'id':_0x364206['id'],'shopId':_0x364206[_0x5ec1f0(0x1f6)],'shopName':_0x364206['shop'][_0x5ec1f0(0xca)],'shopUsername':_0x364206[_0x5ec1f0(0x10c)][_0x5ec1f0(0xf6)],'amount':_0x364206[_0x5ec1f0(0x192)],'network':_0x364206[_0x5ec1f0(0x1f2)],'status':_0x364206['status'],'txid':_0x364206[_0x5ec1f0(0x1fa)],'notes':_0x364206[_0x5ec1f0(0x1a3)],'periodFrom':_0x364206[_0x5ec1f0(0x191)],'periodTo':_0x364206['periodTo'],'createdAt':_0x364206[_0x5ec1f0(0x16b)],'paidAt':_0x364206[_0x5ec1f0(0x166)]})),'pagination':{'page':_0x5704be,'limit':_0x1c9739,'total':_0x235082,'totalPages':Math[_0x5ec1f0(0x1ea)](_0x235082/_0x1c9739)}};}async[a36_0x378885(0x10d)](_0x1c29cb){const _0x255597=a36_0x378885,_0x56362=await database_1[_0x255597(0x10b)][_0x255597(0x109)][_0x255597(0x1bc)]({'where':{'id':_0x1c29cb},'include':{'shop':{'select':{'name':!![],'username':!![]}}}});if(!_0x56362)return null;return{'id':_0x56362['id'],'shopId':_0x56362[_0x255597(0x1f6)],'shopName':_0x56362[_0x255597(0x10c)][_0x255597(0xca)],'shopUsername':_0x56362[_0x255597(0x10c)][_0x255597(0xf6)],'amount':_0x56362[_0x255597(0x192)],'network':_0x56362[_0x255597(0x1f2)],'status':_0x56362['status'],'txid':_0x56362[_0x255597(0x1fa)],'notes':_0x56362[_0x255597(0x1a3)],'periodFrom':_0x56362[_0x255597(0x191)],'periodTo':_0x56362[_0x255597(0x173)],'createdAt':_0x56362[_0x255597(0x16b)],'paidAt':_0x56362['paidAt']};}async[a36_0x378885(0x11c)](_0x2addb8){const _0x4b67e7=a36_0x378885;await database_1[_0x4b67e7(0x10b)][_0x4b67e7(0x109)][_0x4b67e7(0x1b1)]({'where':{'id':_0x2addb8}});}async[a36_0x378885(0x16d)](_0x38da94){const _0x5c6252=a36_0x378885,{page:_0x18e934,limit:_0x5d05a9,status:_0x347618,gateway:_0x2c724a,shopId:_0x3446e1,dateFrom:_0x245063,dateTo:_0xd70742,search:_0x89315d,currency:_0x5ee926,sortBy:_0x1a9b67,sortOrder:_0x133f28}=_0x38da94,_0x4d3deb=(_0x18e934-0x1)*_0x5d05a9;console[_0x5c6252(0x1d8)](_0x5c6252(0x18a),_0x38da94);const _0xea73da=await database_1[_0x5c6252(0x10b)]['payment'][_0x5c6252(0xc5)]({'by':[_0x5c6252(0x1d5)],'_count':{'gateway':!![]}});console[_0x5c6252(0x1d8)]('📊\x20Available\x20gateways\x20in\x20database:',_0xea73da['map'](_0x47dc4e=>_0x47dc4e[_0x5c6252(0x1d5)]+'\x20('+_0x47dc4e[_0x5c6252(0x120)][_0x5c6252(0x1d5)]+'\x20payments)'));if(_0x2c724a){const _0x27bba0=_0xea73da[_0x5c6252(0xeb)](_0x2f5027=>_0x2f5027[_0x5c6252(0x1d5)][_0x5c6252(0x117)]()===_0x2c724a[_0x5c6252(0x117)]());!_0x27bba0&&_0x2c724a['toLowerCase']()!==_0x5c6252(0x102)&&console[_0x5c6252(0x1d8)](_0x5c6252(0x149)+_0x2c724a+_0x5c6252(0x198)+_0xea73da[_0x5c6252(0x169)](_0x38aa4c=>_0x38aa4c['gateway'])[_0x5c6252(0x1f7)](',\x20'));}const _0x34d20d={};_0x347618&&(_0x34d20d[_0x5c6252(0xc4)]=_0x347618['toUpperCase']());if(!_0x2c724a)_0x34d20d[_0x5c6252(0x1d5)]={'not':'test_gateway'};else{if(_0x2c724a&&(_0x2c724a[_0x5c6252(0x117)]()===_0x5c6252(0x102)||_0x2c724a===_0x5c6252(0x14b)))_0x34d20d[_0x5c6252(0x1d5)]=_0x5c6252(0x102);else{let _0x9a85c2=_0x2c724a;const _0x14513a=(0x0,gateway_1['getGatewayNameById'])(_0x2c724a);if(_0x14513a)_0x9a85c2=_0x14513a,console[_0x5c6252(0x1d8)](_0x5c6252(0x161)+_0x2c724a+_0x5c6252(0x1a6)+_0x9a85c2+'\x27');else{const _0x5a6c06=(0x0,gateway_1[_0x5c6252(0x1f1)])(_0x2c724a);if(_0x5a6c06){const _0xd2f065=(0x0,gateway_1[_0x5c6252(0x1e9)])(_0x5a6c06);_0xd2f065&&(_0x9a85c2=_0xd2f065,console[_0x5c6252(0x1d8)](_0x5c6252(0x17e)+_0x2c724a+_0x5c6252(0x1c4)+_0x5a6c06+_0x5c6252(0x1bb)+_0x9a85c2+'\x27'));}else console[_0x5c6252(0x1d8)](_0x5c6252(0xd2)+_0x2c724a+_0x5c6252(0x14c));}const _0x2e6681=await database_1[_0x5c6252(0x10b)][_0x5c6252(0x135)][_0x5c6252(0xda)]({'where':{'gateway':_0x9a85c2[_0x5c6252(0x117)]()},'take':0x1});_0x2e6681===0x0?(console[_0x5c6252(0x1d8)]('⚠️\x20Gateway\x20\x27'+_0x9a85c2+_0x5c6252(0xcf)+_0x2c724a+_0x5c6252(0x1ee)),_0x34d20d['gateway']='NONEXISTENT_GATEWAY_FILTER'):(_0x34d20d[_0x5c6252(0x1d5)]=_0x9a85c2[_0x5c6252(0x117)](),console[_0x5c6252(0x1d8)](_0x5c6252(0x189)+_0x9a85c2+_0x5c6252(0xcf)+_0x2c724a+'\x27)'));}}console[_0x5c6252(0x1d8)](_0x5c6252(0xe9),_0x34d20d[_0x5c6252(0x1d5)]);_0x3446e1&&(_0x34d20d[_0x5c6252(0x1f6)]=_0x3446e1);_0x5ee926&&(_0x34d20d[_0x5c6252(0x1e8)]=_0x5ee926[_0x5c6252(0x1de)](),console['log'](_0x5c6252(0xd7)+_0x5ee926['toUpperCase']()));(_0x245063||_0xd70742)&&(_0x34d20d[_0x5c6252(0x16b)]={},_0x245063&&(_0x34d20d[_0x5c6252(0x16b)][_0x5c6252(0x127)]=new Date(_0x245063)),_0xd70742&&(_0x34d20d[_0x5c6252(0x16b)]['lte']=new Date(_0xd70742)));_0x89315d&&(_0x34d20d['OR']=[{'id':{'contains':_0x89315d,'mode':_0x5c6252(0x108)}},{'orderId':{'contains':_0x89315d,'mode':'insensitive'}},{'gatewayOrderId':{'contains':_0x89315d,'mode':_0x5c6252(0x108)}},{'customerEmail':{'contains':_0x89315d,'mode':_0x5c6252(0x108)}},{'shop':{'name':{'contains':_0x89315d,'mode':_0x5c6252(0x108)}}},{'shop':{'username':{'contains':_0x89315d,'mode':_0x5c6252(0x108)}}}]);console[_0x5c6252(0x1d8)](_0x5c6252(0x197),JSON[_0x5c6252(0x1c2)](_0x34d20d,null,0x2));let _0x1a0cde={'createdAt':_0x5c6252(0x1d0)};if(_0x1a9b67){const _0x20143b=['amount',_0x5c6252(0x16b),_0x5c6252(0x18d),_0x5c6252(0xc4),_0x5c6252(0x1d5),_0x5c6252(0x1e8)],_0x4e3e53=[_0x5c6252(0x163),'desc'];if(_0x20143b[_0x5c6252(0x151)](_0x1a9b67)){const _0x45e7e8=_0x4e3e53['includes'](_0x133f28)?_0x133f28:_0x5c6252(0x1d0);_0x1a0cde={[_0x1a9b67]:_0x45e7e8},console[_0x5c6252(0x1d8)](_0x5c6252(0xea)+_0x1a9b67+_0x5c6252(0x152)+_0x45e7e8+_0x5c6252(0x1d2));}}const [_0x1373b9,_0x5c9b79]=await Promise[_0x5c6252(0x13d)]([database_1[_0x5c6252(0x10b)][_0x5c6252(0x135)]['findMany']({'where':_0x34d20d,'skip':_0x4d3deb,'take':_0x5d05a9,'orderBy':_0x1a0cde,'select':{'id':!![],'shopId':!![],'amount':!![],'amountAfterGatewayCommissionUSDT':!![],'currency':!![],'sourceCurrency':!![],'status':!![],'gateway':!![],'orderId':!![],'gatewayOrderId':!![],'gatewayPaymentId':!![],'customerEmail':!![],'customerName':!![],'customerCountry':!![],'customerIp':!![],'customerUa':!![],'externalPaymentUrl':!![],'successUrl':!![],'failUrl':!![],'pendingUrl':!![],'whiteUrl':!![],'expiresAt':!![],'invoiceTotalSum':!![],'qrCode':!![],'qrUrl':!![],'country':!![],'language':!![],'amountIsEditable':!![],'maxPayments':!![],'rapydCustomer':!![],'cardLast4':!![],'paymentMethod':!![],'bankId':!![],'remitterIban':!![],'remitterName':!![],'failureMessage':!![],'usage':!![],'createdAt':!![],'updatedAt':!![],'shop':{'select':{'name':!![],'username':!![]}}}}),database_1['default'][_0x5c6252(0x135)][_0x5c6252(0xda)]({'where':_0x34d20d})]);return{'payments':_0x1373b9,'pagination':{'page':_0x18e934,'limit':_0x5d05a9,'total':_0x5c9b79,'totalPages':Math['ceil'](_0x5c9b79/_0x5d05a9)}};}async[a36_0x378885(0xd4)](_0xab83ae){const _0x427d4b=a36_0x378885,_0x12a08b=await database_1[_0x427d4b(0x10b)]['payment'][_0x427d4b(0x1bc)]({'where':{'id':_0xab83ae},'select':{'id':!![],'shopId':!![],'amount':!![],'amountAfterGatewayCommissionUSDT':!![],'currency':!![],'sourceCurrency':!![],'status':!![],'gateway':!![],'orderId':!![],'gatewayOrderId':!![],'gatewayPaymentId':!![],'customerEmail':!![],'customerName':!![],'customerCountry':!![],'customerIp':!![],'customerUa':!![],'externalPaymentUrl':!![],'successUrl':!![],'failUrl':!![],'pendingUrl':!![],'whiteUrl':!![],'expiresAt':!![],'invoiceTotalSum':!![],'qrCode':!![],'qrUrl':!![],'country':!![],'language':!![],'amountIsEditable':!![],'maxPayments':!![],'rapydCustomer':!![],'cardLast4':!![],'paymentMethod':!![],'bankId':!![],'remitterIban':!![],'remitterName':!![],'failureMessage':!![],'usage':!![],'createdAt':!![],'updatedAt':!![],'shop':{'select':{'name':!![],'username':!![]}}}});if(!_0x12a08b)return null;return{'id':_0x12a08b['id'],'shopId':_0x12a08b['shopId'],'gateway':_0x12a08b['gateway'],'amount':_0x12a08b[_0x427d4b(0x192)],'currency':_0x12a08b[_0x427d4b(0x1e8)],'status':_0x12a08b[_0x427d4b(0xc4)],'orderId':_0x12a08b[_0x427d4b(0x165)],'gatewayOrderId':_0x12a08b[_0x427d4b(0xdd)],'customerEmail':_0x12a08b['customerEmail'],'customerName':_0x12a08b[_0x427d4b(0xdf)],'customerCountry':_0x12a08b[_0x427d4b(0x188)],'customerIp':_0x12a08b[_0x427d4b(0x1a4)],'customerUa':_0x12a08b[_0x427d4b(0x148)],'failureMessage':_0x12a08b['failureMessage'],'externalPaymentUrl':_0x12a08b[_0x427d4b(0x141)],'successUrl':_0x12a08b['successUrl'],'failUrl':_0x12a08b['failUrl'],'pendingUrl':_0x12a08b[_0x427d4b(0x15c)],'whiteUrl':_0x12a08b[_0x427d4b(0xe1)],'createdAt':_0x12a08b[_0x427d4b(0x16b)],'updatedAt':_0x12a08b[_0x427d4b(0x18d)],'shop':_0x12a08b[_0x427d4b(0x10c)]};}async['updatePaymentStatus'](_0x55db4c,_0x4767b7,_0x576424,_0x2e1e85){const _0x353d71=a36_0x378885,_0x4de40a=await database_1[_0x353d71(0x10b)][_0x353d71(0x1ed)](async _0x1237ba=>{const _0x5e9e28=_0x353d71,_0x149647=await _0x1237ba[_0x5e9e28(0x135)][_0x5e9e28(0x1bc)]({'where':{'id':_0x55db4c},'include':{'shop':{'select':{'id':!![],'name':!![],'username':!![],'balance':!![]}}}});if(!_0x149647)throw new Error(_0x5e9e28(0x1cb));const _0xc5c678=_0x149647[_0x5e9e28(0xc4)],_0x5c0a45=_0x4767b7[_0x5e9e28(0x1de)]();console['log'](_0x5e9e28(0x1a1)+_0x55db4c+'\x20status:\x20'+_0xc5c678+'\x20->\x20'+_0x5c0a45),console[_0x5e9e28(0x1d8)](_0x5e9e28(0x16e)+_0x149647[_0x5e9e28(0x10c)][_0x5e9e28(0x19a)]+_0x5e9e28(0x180));const _0x28c390={'status':_0x5c0a45,'updatedAt':new Date(),'statusChangedBy':_0x5e9e28(0x1b3),'statusChangedAt':new Date()};_0x576424&&(_0x28c390[_0x5e9e28(0x1a8)]=_0x576424);_0x5c0a45===_0x5e9e28(0xec)&&_0x2e1e85&&(_0x28c390[_0x5e9e28(0x154)]=_0x2e1e85);let _0x2e655b=0x0,_0x2206bb=_0x149647[_0x5e9e28(0x10c)]['balance'];if(_0x5c0a45==='PAID'&&_0xc5c678!==_0x5e9e28(0x14f)){_0x28c390[_0x5e9e28(0x166)]=new Date();const _0x30d6d0=await currencyService_1[_0x5e9e28(0x155)]['convertToUSDT'](_0x149647[_0x5e9e28(0x192)],_0x149647[_0x5e9e28(0x1e8)]);_0x28c390[_0x5e9e28(0x1d1)]=_0x30d6d0;let _0x315137=0xa;const _0x51cbfc=await _0x1237ba[_0x5e9e28(0x10c)]['findUnique']({'where':{'id':_0x149647[_0x5e9e28(0x1f6)]},'select':{'gatewaySettings':!![]}});if(_0x51cbfc?.['gatewaySettings'])try{const _0x44b136=JSON['parse'](_0x51cbfc[_0x5e9e28(0x133)]);for(const [_0x5782ae,_0x28246f]of Object[_0x5e9e28(0x10e)](_0x44b136)){if(_0x5782ae['toLowerCase']()===_0x149647[_0x5e9e28(0x1d5)][_0x5e9e28(0x117)]()){_0x315137=_0x28246f[_0x5e9e28(0x1b5)]||0xa;break;}}}catch(_0x6441a){console[_0x5e9e28(0x1e1)](_0x5e9e28(0x1ce)+_0x55db4c+':',_0x6441a);}let _0x4fa0c8;_0x149647[_0x5e9e28(0x1c5)]!==null&&_0x149647['amountAfterGatewayCommissionUSDT']!==undefined?(_0x4fa0c8=_0x149647[_0x5e9e28(0x1c5)],console[_0x5e9e28(0x1d8)](_0x5e9e28(0xcb)+_0x4fa0c8[_0x5e9e28(0x18c)](0x6)+'\x20USDT\x20for\x20payment\x20'+_0x55db4c)):(_0x4fa0c8=_0x30d6d0*(0x1-_0x315137/0x64),console[_0x5e9e28(0x1d8)](_0x5e9e28(0x17a)+_0x55db4c+':\x20'+_0x315137+_0x5e9e28(0x146)+_0x30d6d0[_0x5e9e28(0x18c)](0x6)+_0x5e9e28(0x180)),_0x28c390[_0x5e9e28(0x1c5)]=_0x4fa0c8),_0x2e655b=_0x4fa0c8,_0x2206bb+=_0x4fa0c8,console[_0x5e9e28(0x1d8)](_0x5e9e28(0xe8)+_0x55db4c+_0x5e9e28(0x16a)),console[_0x5e9e28(0x1d8)](_0x5e9e28(0xee)+_0x30d6d0[_0x5e9e28(0x18c)](0x6)+_0x5e9e28(0x180)),console[_0x5e9e28(0x1d8)](_0x5e9e28(0x11b)+_0x149647[_0x5e9e28(0x1d5)]+_0x5e9e28(0x121)+_0x315137+'%'),console[_0x5e9e28(0x1d8)]('\x20\x20\x20Merchant\x20gets:\x20'+_0x4fa0c8[_0x5e9e28(0x18c)](0x6)+_0x5e9e28(0x1db)+_0x315137+'%\x20commission)'),console[_0x5e9e28(0x1d8)](_0x5e9e28(0xf4)+_0x4fa0c8[_0x5e9e28(0x18c)](0x6)+_0x5e9e28(0x180));}else{if(_0xc5c678===_0x5e9e28(0x14f)&&_0x5c0a45!==_0x5e9e28(0x14f)){if(_0x149647['amountUSDT']){let _0x10c13b=0xa;const _0x56d2fc=await _0x1237ba[_0x5e9e28(0x10c)][_0x5e9e28(0x1bc)]({'where':{'id':_0x149647['shopId']},'select':{'gatewaySettings':!![]}});if(_0x56d2fc?.[_0x5e9e28(0x133)])try{const _0x1c3aaf=JSON[_0x5e9e28(0x12b)](_0x56d2fc[_0x5e9e28(0x133)]);for(const [_0x21b591,_0x6b076e]of Object[_0x5e9e28(0x10e)](_0x1c3aaf)){if(_0x21b591['toLowerCase']()===_0x149647[_0x5e9e28(0x1d5)][_0x5e9e28(0x117)]()){_0x10c13b=_0x6b076e[_0x5e9e28(0x1b5)]||0xa;break;}}}catch(_0x107dc9){console[_0x5e9e28(0x1e1)](_0x5e9e28(0x1ce)+_0x55db4c+':',_0x107dc9);}const _0x3290b0=_0x149647['amountUSDT']*(0x1-_0x10c13b/0x64);_0x2e655b=-_0x3290b0,_0x2206bb-=_0x3290b0,_0x28c390[_0x5e9e28(0x1d1)]=null,_0x28c390[_0x5e9e28(0x1c5)]=null,console[_0x5e9e28(0x1d8)](_0x5e9e28(0xe8)+_0x55db4c+_0x5e9e28(0xde)),console[_0x5e9e28(0x1d8)](_0x5e9e28(0xee)+_0x149647[_0x5e9e28(0x1d1)][_0x5e9e28(0x18c)](0x6)+_0x5e9e28(0x180)),console['log'](_0x5e9e28(0x11b)+_0x149647[_0x5e9e28(0x1d5)]+_0x5e9e28(0x121)+_0x10c13b+'%'),console['log'](_0x5e9e28(0x1d7)+_0x3290b0[_0x5e9e28(0x18c)](0x6)+_0x5e9e28(0x1db)+_0x10c13b+_0x5e9e28(0x1b4)),console[_0x5e9e28(0x1d8)]('\x20\x20\x20Subtracted\x20from\x20balance:\x20-'+_0x3290b0[_0x5e9e28(0x18c)](0x6)+_0x5e9e28(0x180));}}}_0x5c0a45===_0x5e9e28(0xec)&&(_0xc5c678==='PAID'&&_0x149647[_0x5e9e28(0x1d1)]&&console[_0x5e9e28(0x1d8)](_0x5e9e28(0xf3)),_0x2e1e85&&_0x2e1e85>0x0&&(_0x2e655b-=_0x2e1e85,_0x2206bb-=_0x2e1e85,console[_0x5e9e28(0x1d8)]('💸\x20CHARGEBACK\x20penalty:\x20-'+_0x2e1e85[_0x5e9e28(0x18c)](0x6)+'\x20USDT\x20from\x20balance')));_0x5c0a45===_0x5e9e28(0x10f)&&_0xc5c678==='PAID'&&console[_0x5e9e28(0x1d8)](_0x5e9e28(0x186));const _0xce1057=await _0x1237ba[_0x5e9e28(0x135)]['update']({'where':{'id':_0x55db4c},'data':_0x28c390,'include':{'shop':{'select':{'name':!![],'username':!![]}}}});return _0x2e655b!==0x0&&(await _0x1237ba['shop']['update']({'where':{'id':_0x149647[_0x5e9e28(0x1f6)]},'data':{'balance':_0x2206bb}}),console['log']('💰\x20Shop\x20'+_0x149647['shopId']+_0x5e9e28(0x196)+_0x149647[_0x5e9e28(0x10c)]['balance'][_0x5e9e28(0x18c)](0x6)+_0x5e9e28(0x100)+_0x2206bb[_0x5e9e28(0x18c)](0x6)+'\x20USDT\x20('+(_0x2e655b>0x0?'+':'')+_0x2e655b[_0x5e9e28(0x18c)](0x6)+')')),_0xce1057;});return{'id':_0x4de40a['id'],'shopId':_0x4de40a[_0x353d71(0x1f6)],'gateway':_0x4de40a['gateway'],'amount':_0x4de40a[_0x353d71(0x192)],'currency':_0x4de40a[_0x353d71(0x1e8)],'status':_0x4de40a[_0x353d71(0xc4)],'orderId':_0x4de40a[_0x353d71(0x165)],'gatewayOrderId':_0x4de40a[_0x353d71(0xdd)],'customerEmail':_0x4de40a[_0x353d71(0xce)],'customerName':_0x4de40a[_0x353d71(0xdf)],'customerCountry':_0x4de40a['customerCountry'],'customerIp':_0x4de40a[_0x353d71(0x1a4)],'customerUa':_0x4de40a['customerUa'],'failureMessage':_0x4de40a[_0x353d71(0x1e6)],'adminNotes':_0x4de40a[_0x353d71(0x1a8)],'chargebackAmount':_0x4de40a['chargebackAmount'],'statusChangedBy':_0x4de40a['statusChangedBy'],'statusChangedAt':_0x4de40a['statusChangedAt'],'createdAt':_0x4de40a['createdAt'],'updatedAt':_0x4de40a[_0x353d71(0x18d)],'shop':_0x4de40a['shop']};}async[a36_0x378885(0x150)](_0x23d2ea,_0x116890){const _0x5d7b07=a36_0x378885,_0x4c6e44=Math['random']()[_0x5d7b07(0x130)](0x24)['substr'](0x2,0x9);console[_0x5d7b07(0x1d8)](_0x5d7b07(0x134)+_0x4c6e44+_0x5d7b07(0x1c6)+_0x23d2ea);const _0x284842={..._0x116890};_0x116890[_0x5d7b07(0x1f4)]&&_0x116890['password']['trim']()!==''?(console[_0x5d7b07(0x1d8)](_0x5d7b07(0x103)+_0x4c6e44+_0x5d7b07(0x193)+_0x23d2ea),_0x284842['password']=await bcryptjs_1['default'][_0x5d7b07(0x15f)](_0x116890['password'],0xc)):(console[_0x5d7b07(0x1d8)](_0x5d7b07(0x103)+_0x4c6e44+_0x5d7b07(0x104)),delete _0x284842[_0x5d7b07(0x1f4)]);_0x116890['fullName']&&(_0x284842[_0x5d7b07(0xca)]=_0x116890[_0x5d7b07(0x1c3)],delete _0x284842[_0x5d7b07(0x1c3)]);_0x116890[_0x5d7b07(0xdc)]&&(_0x284842[_0x5d7b07(0x182)]=_0x116890[_0x5d7b07(0xdc)],delete _0x284842['telegramId']);_0x116890[_0x5d7b07(0x1d9)]&&(_0x284842[_0x5d7b07(0x1a7)]=_0x116890['merchantUrl'],delete _0x284842[_0x5d7b07(0x1d9)]);if(_0x116890[_0x5d7b07(0x19c)]){const _0x5b9d72=_0x116890[_0x5d7b07(0x19c)][_0x5d7b07(0x169)](_0x149fea=>this[_0x5d7b07(0x15a)](_0x149fea));console[_0x5d7b07(0x1d8)](_0x5d7b07(0x168),_0x116890[_0x5d7b07(0x19c)],'->',_0x5b9d72),_0x284842[_0x5d7b07(0xff)]=JSON['stringify'](_0x5b9d72),delete _0x284842['gateways'];}_0x116890[_0x5d7b07(0x133)]&&(console['log'](_0x5d7b07(0x187)+_0x4c6e44+_0x5d7b07(0x18b),_0x116890[_0x5d7b07(0x133)]),_0x284842[_0x5d7b07(0x133)]=JSON[_0x5d7b07(0x1c2)](_0x116890[_0x5d7b07(0x133)]),console[_0x5d7b07(0x1d8)](_0x5d7b07(0x187)+_0x4c6e44+_0x5d7b07(0x13a),_0x284842[_0x5d7b07(0x133)]));_0x116890[_0x5d7b07(0x13f)]&&(_0x116890[_0x5d7b07(0x13f)]['usdtPolygonWallet']!==undefined&&(_0x284842[_0x5d7b07(0x11e)]=_0x116890[_0x5d7b07(0x13f)][_0x5d7b07(0x11e)]||null),_0x116890['wallets']['usdtTrcWallet']!==undefined&&(_0x284842[_0x5d7b07(0x1be)]=_0x116890[_0x5d7b07(0x13f)][_0x5d7b07(0x1be)]||null),_0x116890[_0x5d7b07(0x13f)][_0x5d7b07(0xd6)]!==undefined&&(_0x284842['usdtErcWallet']=_0x116890[_0x5d7b07(0x13f)][_0x5d7b07(0xd6)]||null),_0x116890[_0x5d7b07(0x13f)][_0x5d7b07(0x1bd)]!==undefined&&(_0x284842[_0x5d7b07(0x1bd)]=_0x116890[_0x5d7b07(0x13f)]['usdcPolygonWallet']||null),delete _0x284842[_0x5d7b07(0x13f)]);const _0x482385=await database_1[_0x5d7b07(0x10b)][_0x5d7b07(0x10c)][_0x5d7b07(0x11a)]({'where':{'id':_0x23d2ea},'data':_0x284842,'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});return console[_0x5d7b07(0x1d8)](_0x5d7b07(0x1e3)+_0x4c6e44+_0x5d7b07(0xc9),_0x482385[_0x5d7b07(0x133)]),{'id':_0x482385['id'],'fullName':_0x482385[_0x5d7b07(0xca)],'username':_0x482385[_0x5d7b07(0xf6)],'telegramId':_0x482385[_0x5d7b07(0x182)],'merchantUrl':_0x482385['shopUrl'],'gateways':_0x482385[_0x5d7b07(0xff)]?JSON[_0x5d7b07(0x12b)](_0x482385[_0x5d7b07(0xff)]):null,'gatewaySettings':_0x482385[_0x5d7b07(0x133)]?JSON[_0x5d7b07(0x12b)](_0x482385['gatewaySettings']):null,'publicKey':_0x482385[_0x5d7b07(0x174)],'wallets':{'usdtPolygonWallet':_0x482385[_0x5d7b07(0x11e)],'usdtTrcWallet':_0x482385['usdtTrcWallet'],'usdtErcWallet':_0x482385[_0x5d7b07(0xd6)],'usdcPolygonWallet':_0x482385['usdcPolygonWallet']},'status':_0x482385[_0x5d7b07(0xc4)],'createdAt':_0x482385[_0x5d7b07(0x16b)]};}async[a36_0x378885(0x16f)](_0xcf780b){const _0x55476f=a36_0x378885,_0x3d07dd=await database_1[_0x55476f(0x10b)]['shop'][_0x55476f(0x11a)]({'where':{'id':_0xcf780b},'data':{'status':_0x55476f(0xd8)},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});return{'id':_0x3d07dd['id'],'fullName':_0x3d07dd[_0x55476f(0xca)],'username':_0x3d07dd[_0x55476f(0xf6)],'telegramId':_0x3d07dd[_0x55476f(0x182)],'merchantUrl':_0x3d07dd[_0x55476f(0x1a7)],'gateways':_0x3d07dd[_0x55476f(0xff)]?JSON[_0x55476f(0x12b)](_0x3d07dd['paymentGateways']):null,'gatewaySettings':_0x3d07dd[_0x55476f(0x133)]?JSON[_0x55476f(0x12b)](_0x3d07dd[_0x55476f(0x133)]):null,'publicKey':_0x3d07dd[_0x55476f(0x174)],'wallets':{'usdtPolygonWallet':_0x3d07dd[_0x55476f(0x11e)],'usdtTrcWallet':_0x3d07dd[_0x55476f(0x1be)],'usdtErcWallet':_0x3d07dd['usdtErcWallet'],'usdcPolygonWallet':_0x3d07dd[_0x55476f(0x1bd)]},'status':_0x3d07dd[_0x55476f(0xc4)],'createdAt':_0x3d07dd['createdAt']};}async[a36_0x378885(0x194)](_0x427c10){const _0x233414=a36_0x378885,_0x1af6ac=await database_1[_0x233414(0x10b)][_0x233414(0x10c)][_0x233414(0x11a)]({'where':{'id':_0x427c10},'data':{'status':_0x233414(0xcc)},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});return{'id':_0x1af6ac['id'],'fullName':_0x1af6ac[_0x233414(0xca)],'username':_0x1af6ac['username'],'telegramId':_0x1af6ac[_0x233414(0x182)],'merchantUrl':_0x1af6ac[_0x233414(0x1a7)],'gateways':_0x1af6ac[_0x233414(0xff)]?JSON[_0x233414(0x12b)](_0x1af6ac[_0x233414(0xff)]):null,'gatewaySettings':_0x1af6ac[_0x233414(0x133)]?JSON[_0x233414(0x12b)](_0x1af6ac['gatewaySettings']):null,'publicKey':_0x1af6ac[_0x233414(0x174)],'wallets':{'usdtPolygonWallet':_0x1af6ac[_0x233414(0x11e)],'usdtTrcWallet':_0x1af6ac['usdtTrcWallet'],'usdtErcWallet':_0x1af6ac[_0x233414(0xd6)],'usdcPolygonWallet':_0x1af6ac[_0x233414(0x1bd)]},'status':_0x1af6ac[_0x233414(0xc4)],'createdAt':_0x1af6ac['createdAt']};}async['getAllUsers'](_0x3f31ef){const _0x1c7e75=a36_0x378885,{page:_0x56795e,limit:_0x17cd8d,status:_0x28fca4}=_0x3f31ef,_0x1e4be9=(_0x56795e-0x1)*_0x17cd8d,_0x3f4637={};_0x28fca4&&(_0x3f4637[_0x1c7e75(0xc4)]=_0x28fca4[_0x1c7e75(0x1de)]());const [_0x574a31,_0x1feacf]=await Promise[_0x1c7e75(0x13d)]([database_1[_0x1c7e75(0x10b)]['shop'][_0x1c7e75(0x1b0)]({'where':_0x3f4637,'skip':_0x1e4be9,'take':_0x17cd8d,'orderBy':{'createdAt':_0x1c7e75(0x1d0)},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}}),database_1[_0x1c7e75(0x10b)][_0x1c7e75(0x10c)]['count']({'where':_0x3f4637})]);return{'users':_0x574a31['map'](_0x1539bb=>{const _0x4d6b29=_0x1c7e75,_0x5db4c3=_0x1539bb[_0x4d6b29(0xff)]?JSON[_0x4d6b29(0x12b)](_0x1539bb[_0x4d6b29(0xff)]):null,_0x33ae1c=_0x5db4c3?_0x5db4c3[_0x4d6b29(0x169)](_0x4217cd=>this[_0x4d6b29(0x177)](_0x4217cd)):null;return{'id':_0x1539bb['id'],'fullName':_0x1539bb[_0x4d6b29(0xca)],'username':_0x1539bb[_0x4d6b29(0xf6)],'telegramId':_0x1539bb[_0x4d6b29(0x182)],'merchantUrl':_0x1539bb[_0x4d6b29(0x1a7)],'gateways':_0x33ae1c,'gatewaySettings':_0x1539bb[_0x4d6b29(0x133)]?JSON[_0x4d6b29(0x12b)](_0x1539bb[_0x4d6b29(0x133)]):null,'publicKey':_0x1539bb[_0x4d6b29(0x174)],'wallets':{'usdtPolygonWallet':_0x1539bb[_0x4d6b29(0x11e)],'usdtTrcWallet':_0x1539bb[_0x4d6b29(0x1be)],'usdtErcWallet':_0x1539bb[_0x4d6b29(0xd6)],'usdcPolygonWallet':_0x1539bb['usdcPolygonWallet']},'status':_0x1539bb[_0x4d6b29(0xc4)],'createdAt':_0x1539bb[_0x4d6b29(0x16b)]};}),'pagination':{'page':_0x56795e,'limit':_0x17cd8d,'total':_0x1feacf,'totalPages':Math['ceil'](_0x1feacf/_0x17cd8d)}};}async[a36_0x378885(0x1b2)](_0x2a5bf1){const _0x48ed15=a36_0x378885,_0x3aa787=await database_1[_0x48ed15(0x10b)][_0x48ed15(0x10c)][_0x48ed15(0x1bc)]({'where':{'id':_0x2a5bf1},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});if(!_0x3aa787)return null;const _0x33da85=_0x3aa787[_0x48ed15(0xff)]?JSON[_0x48ed15(0x12b)](_0x3aa787['paymentGateways']):null,_0x524dd0=_0x33da85?_0x33da85[_0x48ed15(0x169)](_0x415c0b=>this[_0x48ed15(0x177)](_0x415c0b)):null;return _0x33da85&&_0x524dd0&&console[_0x48ed15(0x1d8)](_0x48ed15(0x15b),_0x33da85,'->',_0x524dd0),{'id':_0x3aa787['id'],'fullName':_0x3aa787[_0x48ed15(0xca)],'username':_0x3aa787[_0x48ed15(0xf6)],'telegramId':_0x3aa787[_0x48ed15(0x182)],'merchantUrl':_0x3aa787[_0x48ed15(0x1a7)],'gateways':_0x524dd0,'gatewaySettings':_0x3aa787[_0x48ed15(0x133)]?JSON[_0x48ed15(0x12b)](_0x3aa787[_0x48ed15(0x133)]):null,'publicKey':_0x3aa787[_0x48ed15(0x174)],'wallets':{'usdtPolygonWallet':_0x3aa787[_0x48ed15(0x11e)],'usdtTrcWallet':_0x3aa787[_0x48ed15(0x1be)],'usdtErcWallet':_0x3aa787[_0x48ed15(0xd6)],'usdcPolygonWallet':_0x3aa787['usdcPolygonWallet']},'status':_0x3aa787[_0x48ed15(0xc4)],'createdAt':_0x3aa787['createdAt']};}async[a36_0x378885(0x122)](_0x11bb75){const _0x55029d=a36_0x378885,{fullName:_0x2469c4,username:_0x1fa360,password:_0xe6ea5f,telegramId:_0x43d838,merchantUrl:_0x668307,gateways:_0x1eaf2b,gatewaySettings:_0x2ac2fa,wallets:_0xe6bf19}=_0x11bb75,_0x279437=await database_1[_0x55029d(0x10b)][_0x55029d(0x10c)][_0x55029d(0x1bc)]({'where':{'username':_0x1fa360}});if(_0x279437)throw new Error(_0x55029d(0x142));if(_0x43d838){const _0x5d1610=await database_1[_0x55029d(0x10b)][_0x55029d(0x10c)][_0x55029d(0x1bc)]({'where':{'telegram':_0x43d838}});if(_0x5d1610)throw new Error(_0x55029d(0x113));}const _0x5b77bf=await bcryptjs_1['default'][_0x55029d(0x15f)](_0xe6ea5f,0xc),_0x8ae13c=_0x55029d(0x1cc)+crypto_1[_0x55029d(0x10b)]['randomBytes'](0x20)[_0x55029d(0x130)]('hex'),_0x4d73c2=_0x55029d(0x1f0)+crypto_1[_0x55029d(0x10b)][_0x55029d(0x1ad)](0x20)['toString'](_0x55029d(0x128)),_0x40b7ac=_0x1eaf2b?_0x1eaf2b[_0x55029d(0x169)](_0x9298ee=>this[_0x55029d(0x15a)](_0x9298ee)):null;_0x1eaf2b&&_0x40b7ac&&console['log'](_0x55029d(0x1cf),_0x1eaf2b,'->',_0x40b7ac);const _0x338487=await database_1[_0x55029d(0x10b)]['shop']['create']({'data':{'name':_0x2469c4,'username':_0x1fa360,'password':_0x5b77bf,'telegram':_0x43d838,'shopUrl':_0x668307,'paymentGateways':_0x40b7ac?JSON['stringify'](_0x40b7ac):null,'gatewaySettings':_0x2ac2fa?JSON['stringify'](_0x2ac2fa):null,'usdtPolygonWallet':_0xe6bf19?.[_0x55029d(0x11e)]||null,'usdtTrcWallet':_0xe6bf19?.[_0x55029d(0x1be)]||null,'usdtErcWallet':_0xe6bf19?.[_0x55029d(0xd6)]||null,'usdcPolygonWallet':_0xe6bf19?.[_0x55029d(0x1bd)]||null,'publicKey':_0x8ae13c,'secretKey':_0x4d73c2,'status':_0x55029d(0xcc)},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});return{'id':_0x338487['id'],'fullName':_0x338487[_0x55029d(0xca)],'username':_0x338487[_0x55029d(0xf6)],'telegramId':_0x338487[_0x55029d(0x182)],'merchantUrl':_0x338487[_0x55029d(0x1a7)],'gateways':_0x338487['paymentGateways']?JSON[_0x55029d(0x12b)](_0x338487[_0x55029d(0xff)]):null,'gatewaySettings':_0x338487[_0x55029d(0x133)]?JSON[_0x55029d(0x12b)](_0x338487[_0x55029d(0x133)]):null,'publicKey':_0x338487[_0x55029d(0x174)],'wallets':{'usdtPolygonWallet':_0x338487['usdtPolygonWallet'],'usdtTrcWallet':_0x338487['usdtTrcWallet'],'usdtErcWallet':_0x338487[_0x55029d(0xd6)],'usdcPolygonWallet':_0x338487[_0x55029d(0x1bd)]},'status':_0x338487[_0x55029d(0xc4)],'createdAt':_0x338487['createdAt']};}async[a36_0x378885(0x171)](_0x50c1a5){const _0x45efe3=a36_0x378885;await database_1[_0x45efe3(0x10b)][_0x45efe3(0x10c)][_0x45efe3(0x1b1)]({'where':{'id':_0x50c1a5}});}['generateDailyStatistics'](_0x53a3d6,_0x9bb631,_0xf2e883){const _0x129e8e=a36_0x378885,_0x9cb52=new Map(),_0x22505c=new Date(_0x9bb631);while(_0x22505c<=_0xf2e883){const _0x5b2a34=_0x22505c[_0x129e8e(0x17f)]()[_0x129e8e(0xfa)]('T')[0x0];_0x9cb52[_0x129e8e(0x179)](_0x5b2a34,{'revenue':0x0,'count':0x0}),_0x22505c[_0x129e8e(0x1b8)](_0x22505c[_0x129e8e(0x175)]()+0x1);}for(const _0x11c3f5 of _0x53a3d6){const _0x1574d0=_0x11c3f5[_0x129e8e(0x16b)][_0x129e8e(0x17f)]()[_0x129e8e(0xfa)]('T')[0x0],_0x55d34e=_0x9cb52[_0x129e8e(0x1da)](_0x1574d0);_0x55d34e&&(_0x55d34e['count']+=0x1,_0x11c3f5['status']===_0x129e8e(0x14f)&&(_0x11c3f5[_0x129e8e(0x1d1)]?_0x55d34e[_0x129e8e(0x1e0)]+=_0x11c3f5[_0x129e8e(0x1d1)]:console[_0x129e8e(0x1d8)](_0x129e8e(0x13c)+_0x11c3f5['id']+_0x129e8e(0x14a))));}const _0x2c25c1=[],_0x26de84=[];for(const [_0x597440,_0x49b527]of _0x9cb52){_0x2c25c1[_0x129e8e(0x112)]({'date':_0x597440,'amount':Math[_0x129e8e(0x159)](_0x49b527['revenue']*0x64)/0x64}),_0x26de84[_0x129e8e(0x112)]({'date':_0x597440,'count':_0x49b527[_0x129e8e(0xda)]});}return{'dailyRevenue':_0x2c25c1,'dailyPayments':_0x26de84};}}exports[a36_0x378885(0x111)]=AdminService;