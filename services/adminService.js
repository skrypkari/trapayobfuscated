'use strict';const a33_0x63dd0a=a33_0xc89b;(function(_0x2272fb,_0x3a43e2){const _0x10d78c=a33_0xc89b,_0x5c7017=_0x2272fb();while(!![]){try{const _0x348786=-parseInt(_0x10d78c(0xec))/0x1*(parseInt(_0x10d78c(0xf5))/0x2)+-parseInt(_0x10d78c(0xd2))/0x3+parseInt(_0x10d78c(0x116))/0x4*(-parseInt(_0x10d78c(0xc3))/0x5)+-parseInt(_0x10d78c(0xd4))/0x6*(parseInt(_0x10d78c(0x84))/0x7)+-parseInt(_0x10d78c(0x11c))/0x8*(-parseInt(_0x10d78c(0xa7))/0x9)+-parseInt(_0x10d78c(0xce))/0xa+parseInt(_0x10d78c(0x10a))/0xb*(parseInt(_0x10d78c(0xe9))/0xc);if(_0x348786===_0x3a43e2)break;else _0x5c7017['push'](_0x5c7017['shift']());}catch(_0x5e5313){_0x5c7017['push'](_0x5c7017['shift']());}}}(a33_0x557b,0xb7281));function a33_0xc89b(_0x5ed990,_0x569fd3){const _0x557b7c=a33_0x557b();return a33_0xc89b=function(_0xc89b5c,_0x13e7ca){_0xc89b5c=_0xc89b5c-0x6e;let _0x285d8d=_0x557b7c[_0xc89b5c];return _0x285d8d;},a33_0xc89b(_0x5ed990,_0x569fd3);}var __importDefault=this&&this['__importDefault']||function(_0x2180b1){const _0x33d82e=a33_0xc89b;return _0x2180b1&&_0x2180b1[_0x33d82e(0xac)]?_0x2180b1:{'default':_0x2180b1};};Object[a33_0x63dd0a(0x134)](exports,a33_0x63dd0a(0xac),{'value':!![]}),exports[a33_0x63dd0a(0x82)]=void 0x0;const database_1=__importDefault(require(a33_0x63dd0a(0xe4))),currencyService_1=require(a33_0x63dd0a(0x12c)),userService_1=require(a33_0x63dd0a(0xf7)),telegramBotService_1=require('./telegramBotService'),gateway_1=require(a33_0x63dd0a(0xf9));class AdminService{constructor(){const _0x511cf1=a33_0x63dd0a;this[_0x511cf1(0xe8)]=new userService_1[(_0x511cf1(0xa5))]();}[a33_0x63dd0a(0x12d)](_0x174488){const _0x4ed0f2=a33_0x63dd0a;switch(_0x174488){case'7d':return 0x7;case _0x4ed0f2(0x141):return 0x1e;case _0x4ed0f2(0x8d):return 0x5a;case'1y':return 0x16d;default:return 0x1e;}}['generateDateRange'](_0x1a86de,_0x333583){const _0x3e6e2e=a33_0x63dd0a,_0x5152ce=[],_0x11eb41=new Date(_0x1a86de);while(_0x11eb41<=_0x333583){_0x5152ce[_0x3e6e2e(0x10c)](_0x11eb41['toISOString']()[_0x3e6e2e(0x143)]('T')[0x0]),_0x11eb41['setDate'](_0x11eb41[_0x3e6e2e(0xa8)]()+0x1);}return _0x5152ce;}[a33_0x63dd0a(0xaf)](_0x516ad2,_0x5526b1){const _0x2ae68b=a33_0x63dd0a;if(!_0x516ad2['gatewaySettings'])return{'commission':0x0,'payoutDelay':0x0};try{const _0x39d047=JSON[_0x2ae68b(0xf4)](_0x516ad2[_0x2ae68b(0x80)]),_0x343475=_0x5526b1['charAt'](0x0)['toUpperCase']()+_0x5526b1[_0x2ae68b(0x99)](0x1)['toLowerCase']();if(_0x39d047&&_0x39d047[_0x343475])return{'commission':_0x39d047[_0x343475]['commission']||0x0,'payoutDelay':_0x39d047[_0x343475][_0x2ae68b(0x13a)]||0x0};}catch(_0x5ee66a){console['error'](_0x2ae68b(0xfb),_0x5ee66a);}return{'commission':0x0,'payoutDelay':0x0};}[a33_0x63dd0a(0x8b)](_0x32d00f){const _0x4e6f77=a33_0x63dd0a;if(_0x32d00f[_0x4e6f77(0xb2)]!==_0x4e6f77(0x10d)||_0x32d00f[_0x4e6f77(0xf6)]||!_0x32d00f[_0x4e6f77(0x130)])return![];const _0x3c3027=this[_0x4e6f77(0xaf)](_0x32d00f[_0x4e6f77(0x13c)],_0x32d00f[_0x4e6f77(0xe1)]),_0x8ee547=_0x3c3027[_0x4e6f77(0x13a)]*0x18*0x3c*0x3c*0x3e8,_0x3ea1fe=new Date(_0x32d00f[_0x4e6f77(0x130)]['getTime']()+_0x8ee547);return new Date()>_0x3ea1fe;}['calculateAmountAfterCommission'](_0x224e52,_0x410e17){return _0x224e52*(0x1-_0x410e17/0x64);}[a33_0x63dd0a(0xfd)](_0xa7e902){const _0x2285c6=a33_0x63dd0a;switch(_0xa7e902['status']){case _0x2285c6(0x10d):return _0xa7e902[_0x2285c6(0xd7)];case _0x2285c6(0xe6):return-(_0xa7e902[_0x2285c6(0x128)]||0x0);case _0x2285c6(0xe2):return 0x0;default:return 0x0;}}async[a33_0x63dd0a(0x79)](_0x4b4311){const _0x526996=a33_0x63dd0a,{shopId:_0x44d685,amount:_0x2bb70c,network:_0x40616b,notes:_0x4de447}=_0x4b4311;console[_0x526996(0xfa)]('üí∏\x20Creating\x20payout\x20for\x20shop\x20'+_0x44d685+':\x20'+_0x2bb70c+_0x526996(0xa1)+_0x40616b);const _0x5c3474=await database_1[_0x526996(0x119)][_0x526996(0x13c)][_0x526996(0x125)]({'where':{'id':_0x44d685},'select':{'id':!![],'name':!![],'username':!![],'status':!![]}});if(!_0x5c3474)throw new Error(_0x526996(0x6f));if(_0x5c3474[_0x526996(0xb2)]!==_0x526996(0x89))throw new Error('Shop\x20is\x20not\x20active');const _0x24ea1e=await database_1[_0x526996(0x119)][_0x526996(0x12a)][_0x526996(0x108)]({'data':{'shopId':_0x44d685,'amount':_0x2bb70c,'network':_0x40616b,'status':_0x526996(0xcb),'notes':_0x4de447||null,'paidAt':new Date()},'include':{'shop':{'select':{'name':!![],'username':!![]}}}});await this[_0x526996(0x9a)](_0x44d685,_0x2bb70c);try{await telegramBotService_1['telegramBotService'][_0x526996(0x120)](_0x44d685,_0x24ea1e,_0x526996(0x81));}catch(_0x2226ce){console[_0x526996(0x98)](_0x526996(0x8e),_0x2226ce);}return console[_0x526996(0xfa)]('‚úÖ\x20Payout\x20created\x20successfully:\x20'+_0x24ea1e['id']),{'id':_0x24ea1e['id'],'shopId':_0x24ea1e[_0x526996(0xe0)],'shopName':_0x24ea1e[_0x526996(0x13c)]['name'],'shopUsername':_0x24ea1e[_0x526996(0x13c)][_0x526996(0x9d)],'amount':_0x24ea1e['amount'],'network':_0x24ea1e[_0x526996(0x77)],'status':_0x24ea1e['status'],'txid':_0x24ea1e[_0x526996(0x73)],'notes':_0x24ea1e[_0x526996(0xd0)],'createdAt':_0x24ea1e[_0x526996(0xf3)],'paidAt':_0x24ea1e[_0x526996(0x130)]};}async[a33_0x63dd0a(0x9a)](_0x526f38,_0x5b5145){const _0x28ec72=a33_0x63dd0a;console[_0x28ec72(0xfa)]('üîÑ\x20Marking\x20payments\x20as\x20paid\x20out\x20for\x20shop\x20'+_0x526f38+_0x28ec72(0x92)+_0x5b5145+'\x20USDT');const _0x49e3f4=await database_1[_0x28ec72(0x119)][_0x28ec72(0xdb)][_0x28ec72(0xbc)]({'where':{'shopId':_0x526f38,'status':_0x28ec72(0x10d),'merchantPaid':![],'paidAt':{'not':null}},'select':{'id':!![],'amount':!![],'currency':!![],'gateway':!![],'paidAt':!![],'shop':{'select':{'gatewaySettings':!![]}}},'orderBy':{'paidAt':'asc'}});let _0x2f4bed=_0x5b5145;const _0x138718=[];for(const _0x47428e of _0x49e3f4){const _0x4963b5={..._0x47428e,'status':'PAID','merchantPaid':![],'shop':{'gatewaySettings':_0x47428e[_0x28ec72(0x13c)][_0x28ec72(0x80)]}};if(!this[_0x28ec72(0x8b)](_0x4963b5))continue;const _0x598196=await currencyService_1[_0x28ec72(0x12f)][_0x28ec72(0x112)](_0x47428e[_0x28ec72(0xd7)],_0x47428e['currency']),_0x3a1ce0=this['getGatewaySettings'](_0x47428e[_0x28ec72(0x13c)],_0x47428e['gateway']),_0x11ee4c=this['calculateAmountAfterCommission'](_0x598196,_0x3a1ce0[_0x28ec72(0xa2)]);if(_0x11ee4c<=_0x2f4bed){_0x138718[_0x28ec72(0x10c)](_0x47428e['id']),_0x2f4bed-=_0x11ee4c;if(_0x2f4bed<=0.01)break;}}_0x138718['length']>0x0&&(await database_1[_0x28ec72(0x119)][_0x28ec72(0xdb)][_0x28ec72(0x110)]({'where':{'id':{'in':_0x138718}},'data':{'merchantPaid':!![]}}),console['log'](_0x28ec72(0xd3)+_0x138718['length']+_0x28ec72(0x122)));}async[a33_0x63dd0a(0x72)](_0x26589a){const _0x1d232b=a33_0x63dd0a,{page:_0x27beb9,limit:_0x4bf572,shopId:_0x3409cb,network:_0x3c29fc,dateFrom:_0x2f781d,dateTo:_0x59dc5a,search:_0x5f1403}=_0x26589a,_0x5824b9=(_0x27beb9-0x1)*_0x4bf572;console[_0x1d232b(0xfa)]('üìã\x20Getting\x20payouts\x20with\x20filters:',_0x26589a);const _0x4cb1e6={};_0x3409cb&&(_0x4cb1e6[_0x1d232b(0xe0)]=_0x3409cb);_0x3c29fc&&(_0x4cb1e6[_0x1d232b(0x77)]=_0x3c29fc);(_0x2f781d||_0x59dc5a)&&(_0x4cb1e6[_0x1d232b(0xf3)]={},_0x2f781d&&(_0x4cb1e6[_0x1d232b(0xf3)][_0x1d232b(0xe5)]=new Date(_0x2f781d)),_0x59dc5a&&(_0x4cb1e6[_0x1d232b(0xf3)][_0x1d232b(0x106)]=new Date(_0x59dc5a)));_0x5f1403&&(_0x4cb1e6['OR']=[{'txid':{'contains':_0x5f1403,'mode':'insensitive'}},{'notes':{'contains':_0x5f1403,'mode':_0x1d232b(0xeb)}},{'shop':{'name':{'contains':_0x5f1403,'mode':'insensitive'}}},{'shop':{'username':{'contains':_0x5f1403,'mode':'insensitive'}}}]);const [_0xfda664,_0x2e5303]=await Promise[_0x1d232b(0x136)]([database_1[_0x1d232b(0x119)]['payout']['findMany']({'where':_0x4cb1e6,'skip':_0x5824b9,'take':_0x4bf572,'orderBy':{'createdAt':_0x1d232b(0x132)},'include':{'shop':{'select':{'name':!![],'username':!![]}}}}),database_1['default'][_0x1d232b(0x12a)]['count']({'where':_0x4cb1e6})]);console[_0x1d232b(0xfa)](_0x1d232b(0xa6)+_0xfda664[_0x1d232b(0x87)]+_0x1d232b(0x129)+_0x2e5303+_0x1d232b(0xa4));const _0x16d415=_0xfda664[_0x1d232b(0xea)](_0x52feb1=>({'id':_0x52feb1['id'],'shopId':_0x52feb1[_0x1d232b(0xe0)],'shopName':_0x52feb1['shop']['name'],'shopUsername':_0x52feb1[_0x1d232b(0x13c)][_0x1d232b(0x9d)],'amount':_0x52feb1[_0x1d232b(0xd7)],'network':_0x52feb1[_0x1d232b(0x77)],'status':_0x52feb1[_0x1d232b(0xb2)],'txid':_0x52feb1[_0x1d232b(0x73)],'notes':_0x52feb1[_0x1d232b(0xd0)],'createdAt':_0x52feb1['createdAt'],'paidAt':_0x52feb1[_0x1d232b(0x130)]}));return{'payouts':_0x16d415,'pagination':{'page':_0x27beb9,'limit':_0x4bf572,'total':_0x2e5303,'totalPages':Math[_0x1d232b(0xab)](_0x2e5303/_0x4bf572)}};}async[a33_0x63dd0a(0x104)](_0x341cbe){const _0x231a49=a33_0x63dd0a;console['log']('üîç\x20Getting\x20payout\x20by\x20ID:\x20'+_0x341cbe);const _0x2a12ef=await database_1[_0x231a49(0x119)]['payout'][_0x231a49(0x125)]({'where':{'id':_0x341cbe},'include':{'shop':{'select':{'name':!![],'username':!![]}}}});if(!_0x2a12ef)return console[_0x231a49(0xfa)](_0x231a49(0xff)+_0x341cbe),null;return console['log']('‚úÖ\x20Found\x20payout:\x20'+_0x2a12ef['amount']+'\x20USDT\x20via\x20'+_0x2a12ef[_0x231a49(0x77)]),{'id':_0x2a12ef['id'],'shopId':_0x2a12ef[_0x231a49(0xe0)],'shopName':_0x2a12ef['shop'][_0x231a49(0xc5)],'shopUsername':_0x2a12ef[_0x231a49(0x13c)][_0x231a49(0x9d)],'amount':_0x2a12ef[_0x231a49(0xd7)],'network':_0x2a12ef['network'],'status':_0x2a12ef[_0x231a49(0xb2)],'txid':_0x2a12ef[_0x231a49(0x73)],'notes':_0x2a12ef['notes'],'createdAt':_0x2a12ef[_0x231a49(0xf3)],'paidAt':_0x2a12ef[_0x231a49(0x130)]};}async[a33_0x63dd0a(0x13b)](_0x9c445a){const _0x180f65=a33_0x63dd0a;console[_0x180f65(0xfa)](_0x180f65(0xbe)+_0x9c445a);const _0x4c7aa8=await database_1[_0x180f65(0x119)]['payout'][_0x180f65(0x125)]({'where':{'id':_0x9c445a},'select':{'id':!![],'shopId':!![],'amount':!![]}});if(!_0x4c7aa8)throw new Error('Payout\x20not\x20found');await database_1[_0x180f65(0x119)][_0x180f65(0x12a)]['delete']({'where':{'id':_0x9c445a}}),console[_0x180f65(0xfa)]('‚úÖ\x20Payout\x20'+_0x9c445a+_0x180f65(0xc8));}async['getMerchantsAwaitingPayout'](_0x261d48){const _0x1cc157=a33_0x63dd0a,{page:_0x50f8d3,limit:_0x18b987,minAmount:_0x1aa60e,search:_0x5ef242}=_0x261d48;console['log'](_0x1cc157(0x13f),_0x261d48);const _0x3b9c3f=await database_1[_0x1cc157(0x119)]['payment'][_0x1cc157(0xbc)]({'where':{'status':'PAID','merchantPaid':![],'paidAt':{'not':null}},'select':{'id':!![],'shopId':!![],'amount':!![],'currency':!![],'gateway':!![],'paidAt':!![],'createdAt':!![],'shop':{'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'gatewaySettings':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![]}}}});console[_0x1cc157(0xfa)](_0x1cc157(0xa9)+_0x3b9c3f['length']+_0x1cc157(0x126));const _0x50e596=new Map();for(const _0x1d8e5e of _0x3b9c3f){const _0x175ed2={..._0x1d8e5e,'status':_0x1cc157(0x10d),'merchantPaid':![],'shop':{'gatewaySettings':_0x1d8e5e[_0x1cc157(0x13c)][_0x1cc157(0x80)]}},_0x20fc20=this[_0x1cc157(0x8b)](_0x175ed2);if(!_0x20fc20)continue;const _0x92f0ee=await currencyService_1[_0x1cc157(0x12f)][_0x1cc157(0x112)](_0x1d8e5e[_0x1cc157(0xd7)],_0x1d8e5e[_0x1cc157(0xb0)]),_0x3a5360=this[_0x1cc157(0xaf)](_0x1d8e5e[_0x1cc157(0x13c)],_0x1d8e5e[_0x1cc157(0xe1)]),_0x59d74c=this['calculateAmountAfterCommission'](_0x92f0ee,_0x3a5360['commission']),_0x15fa0b=_0x1d8e5e[_0x1cc157(0xe0)];!_0x50e596['has'](_0x15fa0b)&&_0x50e596[_0x1cc157(0x138)](_0x15fa0b,{'shop':_0x1d8e5e[_0x1cc157(0x13c)],'payments':[]}),_0x50e596['get'](_0x15fa0b)[_0x1cc157(0xb6)][_0x1cc157(0x10c)]({'id':_0x1d8e5e['id'],'amount':_0x1d8e5e[_0x1cc157(0xd7)],'currency':_0x1d8e5e[_0x1cc157(0xb0)],'gateway':_0x1d8e5e['gateway'],'paidAt':_0x1d8e5e['paidAt'],'createdAt':_0x1d8e5e['createdAt'],'amountUSDT':_0x92f0ee,'commission':_0x3a5360[_0x1cc157(0xa2)],'amountAfterCommissionUSDT':_0x59d74c,'isEligible':!![]});}console[_0x1cc157(0xfa)](_0x1cc157(0x123)+_0x50e596[_0x1cc157(0x145)]+'\x20merchants\x20with\x20eligible\x20PAID\x20payments');const _0x5d1894=[];for(const [_0x46e0f6,_0x14a987]of _0x50e596){const {shop:_0x3d3684,payments:_0x529060}=_0x14a987,_0x12601d=_0x529060['reduce']((_0x36545a,_0x2b1397)=>_0x36545a+_0x2b1397[_0x1cc157(0xb5)],0x0),_0x595a64=_0x529060[_0x1cc157(0x103)]((_0x580568,_0x1e57f7)=>_0x580568+_0x1e57f7[_0x1cc157(0x7a)],0x0);if(_0x1aa60e&&_0x595a64<_0x1aa60e)continue;if(_0x5ef242){const _0x45ae49=_0x5ef242['toLowerCase'](),_0x1d564a=_0x3d3684['name']['toLowerCase']()[_0x1cc157(0x10f)](_0x45ae49)||_0x3d3684['username']['toLowerCase']()[_0x1cc157(0x10f)](_0x45ae49)||_0x3d3684[_0x1cc157(0xcf)]&&_0x3d3684[_0x1cc157(0xcf)]['toLowerCase']()[_0x1cc157(0x10f)](_0x45ae49);if(!_0x1d564a)continue;}const _0x2ad0e0=new Map();for(const _0x5a47ba of _0x529060){const _0x12455f=_0x5a47ba[_0x1cc157(0xe1)];!_0x2ad0e0['has'](_0x12455f)&&_0x2ad0e0[_0x1cc157(0x138)](_0x12455f,{'count':0x0,'amountUSDT':0x0,'amountAfterCommissionUSDT':0x0,'commission':_0x5a47ba[_0x1cc157(0xa2)]});const _0x502b75=_0x2ad0e0[_0x1cc157(0x10e)](_0x12455f);_0x502b75[_0x1cc157(0x88)]++,_0x502b75[_0x1cc157(0xb5)]+=_0x5a47ba[_0x1cc157(0xb5)],_0x502b75[_0x1cc157(0x7a)]+=_0x5a47ba['amountAfterCommissionUSDT'];}const _0x1549cd=Array[_0x1cc157(0x131)](_0x2ad0e0[_0x1cc157(0x135)]())['map'](([_0x50e5d2,_0x117ed3])=>({'gateway':_0x50e5d2[_0x1cc157(0xc7)](0x0)[_0x1cc157(0xa3)]()+_0x50e5d2[_0x1cc157(0x99)](0x1),'count':_0x117ed3[_0x1cc157(0x88)],'amountUSDT':Math[_0x1cc157(0xfe)](_0x117ed3[_0x1cc157(0xb5)]*0x64)/0x64,'amountAfterCommissionUSDT':Math[_0x1cc157(0xfe)](_0x117ed3[_0x1cc157(0x7a)]*0x64)/0x64,'commission':_0x117ed3['commission']})),_0x23702f=_0x529060[_0x1cc157(0x103)]((_0x2c830c,_0xdb366b)=>{const _0x30ae19=_0x1cc157;return _0xdb366b[_0x30ae19(0x130)]<_0x2c830c?_0xdb366b['paidAt']:_0x2c830c;},_0x529060[0x0]['paidAt']);_0x5d1894[_0x1cc157(0x10c)]({'id':_0x3d3684['id'],'fullName':_0x3d3684[_0x1cc157(0xc5)],'username':_0x3d3684['username'],'telegramId':_0x3d3684[_0x1cc157(0xcf)],'merchantUrl':_0x3d3684[_0x1cc157(0xda)],'wallets':{'usdtPolygonWallet':_0x3d3684[_0x1cc157(0xd8)],'usdtTrcWallet':_0x3d3684[_0x1cc157(0xf0)],'usdtErcWallet':_0x3d3684[_0x1cc157(0x113)],'usdcPolygonWallet':_0x3d3684[_0x1cc157(0x86)]},'totalAmountUSDT':Math['round'](_0x12601d*0x64)/0x64,'totalAmountAfterCommissionUSDT':Math[_0x1cc157(0xfe)](_0x595a64*0x64)/0x64,'paymentsCount':_0x529060[_0x1cc157(0x87)],'oldestPaymentDate':_0x23702f,'gatewayBreakdown':_0x1549cd});}_0x5d1894[_0x1cc157(0x90)]((_0x3b144d,_0x43b280)=>_0x43b280[_0x1cc157(0xf2)]-_0x3b144d['totalAmountAfterCommissionUSDT']);const _0x5a76b1=_0x5d1894[_0x1cc157(0x87)],_0x413f25=_0x5d1894[_0x1cc157(0x103)]((_0x5dbb44,_0x2ff916)=>_0x5dbb44+_0x2ff916[_0x1cc157(0x11b)],0x0),_0x1d1211=_0x5d1894[_0x1cc157(0x103)]((_0x227749,_0x1ebea3)=>_0x227749+_0x1ebea3['totalAmountAfterCommissionUSDT'],0x0),_0x348333=(_0x50f8d3-0x1)*_0x18b987,_0x3cd6bd=_0x5d1894[_0x1cc157(0x99)](_0x348333,_0x348333+_0x18b987);return console[_0x1cc157(0xfa)](_0x1cc157(0xde)+_0x3cd6bd[_0x1cc157(0x87)]+_0x1cc157(0xdf)+_0x5a76b1+'\x20total'),console[_0x1cc157(0xfa)]('üí∞\x20Total\x20amount:\x20'+_0x413f25[_0x1cc157(0x13e)](0x2)+_0x1cc157(0xdc)+_0x1d1211[_0x1cc157(0x13e)](0x2)+_0x1cc157(0xd6)),{'merchants':_0x3cd6bd,'pagination':{'page':_0x50f8d3,'limit':_0x18b987,'total':_0x5a76b1,'totalPages':Math['ceil'](_0x5a76b1/_0x18b987)},'summary':{'totalMerchants':_0x5a76b1,'totalAmountUSDT':Math[_0x1cc157(0xfe)](_0x413f25*0x64)/0x64,'totalAmountAfterCommissionUSDT':Math[_0x1cc157(0xfe)](_0x1d1211*0x64)/0x64}};}async[a33_0x63dd0a(0x142)](){const _0x1d1870=a33_0x63dd0a;console[_0x1d1870(0xfa)](_0x1d1870(0xa0));const _0x125336=await database_1[_0x1d1870(0x119)][_0x1d1870(0xdb)][_0x1d1870(0xbc)]({'where':{'status':{'in':['PAID',_0x1d1870(0xe2),'CHARGEBACK']}},'select':{'id':!![],'shopId':!![],'amount':!![],'currency':!![],'status':!![],'gateway':!![],'paidAt':!![],'merchantPaid':!![],'createdAt':!![],'chargebackAmount':!![],'shop':{'select':{'gatewaySettings':!![]}}}});console['log'](_0x1d1870(0xa9)+_0x125336[_0x1d1870(0x87)]+_0x1d1870(0xb3));const _0x1565d6=new Date(),_0x363d18=new Date(_0x1565d6[_0x1d1870(0xcc)](),_0x1565d6[_0x1d1870(0xee)](),0x1),_0x57771e=new Date(_0x1565d6['getFullYear'](),_0x1565d6['getMonth']()+0x1,0x0,0x17,0x3b,0x3b,0x3e7);let _0x488531=0x0,_0x5b05e5=0x0,_0x441a51=0x0,_0x5304e8=0x0;for(const _0x1e5f3b of _0x125336){const _0x57b396=this['calculateEffectiveAmount'](_0x1e5f3b);if(_0x57b396===0x0)continue;let _0x55b7f4,_0xd7a6cf;if(_0x1e5f3b[_0x1d1870(0xb2)]===_0x1d1870(0xe6))_0x55b7f4=Math[_0x1d1870(0x124)](_0x57b396),_0xd7a6cf=-_0x55b7f4;else{_0x55b7f4=await currencyService_1[_0x1d1870(0x12f)][_0x1d1870(0x112)](_0x1e5f3b[_0x1d1870(0xd7)],_0x1e5f3b[_0x1d1870(0xb0)]);const _0x17d139=this[_0x1d1870(0xaf)](_0x1e5f3b[_0x1d1870(0x13c)],_0x1e5f3b[_0x1d1870(0xe1)]);_0xd7a6cf=this['calculateAmountAfterCommission'](_0x55b7f4,_0x17d139[_0x1d1870(0xa2)]);}_0x1e5f3b[_0x1d1870(0xf6)]&&(_0x488531+=_0xd7a6cf,_0x1e5f3b[_0x1d1870(0x130)]&&_0x1e5f3b[_0x1d1870(0x130)]>=_0x363d18&&_0x1e5f3b['paidAt']<=_0x57771e&&(_0x441a51+=_0xd7a6cf)),_0x1e5f3b[_0x1d1870(0xb2)]===_0x1d1870(0x10d)&&this['isEligibleForPayout'](_0x1e5f3b)&&(_0x5b05e5+=_0xd7a6cf,_0x5304e8+=_0x55b7f4);}const _0x2976d0={'totalPayout':Math['round'](_0x488531*0x64)/0x64,'awaitingPayout':Math[_0x1d1870(0xfe)](_0x5b05e5*0x64)/0x64,'thisMonth':Math['round'](_0x441a51*0x64)/0x64,'availableBalance':Math[_0x1d1870(0xfe)](_0x5304e8*0x64)/0x64};return console['log'](_0x1d1870(0x95)),console[_0x1d1870(0xfa)](_0x1d1870(0x11e)+_0x2976d0[_0x1d1870(0x11d)]+_0x1d1870(0x107)),console['log'](_0x1d1870(0x114)+_0x2976d0[_0x1d1870(0x85)]+_0x1d1870(0x105)),console['log'](_0x1d1870(0x7e)+_0x2976d0['thisMonth']+_0x1d1870(0x101)),console[_0x1d1870(0xfa)](_0x1d1870(0x139)+_0x2976d0[_0x1d1870(0x11a)]+'\x20USDT'),_0x2976d0;}async[a33_0x63dd0a(0x83)](_0xc3ab0c){const _0x3d9776=a33_0x63dd0a,_0x43748a=this[_0x3d9776(0x12d)](_0xc3ab0c),_0x546087=new Date();_0x546087[_0x3d9776(0xfc)](_0x546087['getDate']()-_0x43748a),console[_0x3d9776(0xfa)](_0x3d9776(0xf8)+_0xc3ab0c+'\x20('+_0x43748a+_0x3d9776(0x12b));const _0x52a966=await database_1[_0x3d9776(0x119)][_0x3d9776(0x13c)][_0x3d9776(0x88)]({'where':{'status':_0x3d9776(0x89)}}),_0x45d704=await database_1['default']['payment']['count'](),_0x4469f3=await database_1[_0x3d9776(0x119)][_0x3d9776(0xdb)][_0x3d9776(0xbc)]({'where':{'status':{'in':['PAID',_0x3d9776(0xe2),_0x3d9776(0xe6)]}},'select':{'amount':!![],'currency':!![],'status':!![],'chargebackAmount':!![],'createdAt':!![]}});console['log'](_0x3d9776(0xa9)+_0x4469f3[_0x3d9776(0x87)]+_0x3d9776(0x93));const _0x3a4f29=await Promise[_0x3d9776(0x136)](_0x4469f3['map'](async _0x2476fb=>{const _0x5a96ca=_0x3d9776,_0x9f99f6=this[_0x5a96ca(0xfd)](_0x2476fb);if(_0x9f99f6===0x0)return{'amount':0x0,'createdAt':_0x2476fb['createdAt']};let _0x1ca599;return _0x2476fb[_0x5a96ca(0xb2)]===_0x5a96ca(0xe6)?_0x1ca599=-Math[_0x5a96ca(0x124)](_0x9f99f6):_0x1ca599=await currencyService_1[_0x5a96ca(0x12f)][_0x5a96ca(0x112)](_0x2476fb[_0x5a96ca(0xd7)],_0x2476fb['currency']),{'amount':_0x1ca599,'createdAt':_0x2476fb[_0x5a96ca(0xf3)]};})),_0x55b8e9=_0x3a4f29[_0x3d9776(0x103)]((_0x5c2820,_0x18d005)=>_0x5c2820+_0x18d005[_0x3d9776(0xd7)],0x0),_0x48a962=_0x45d704>0x0?_0x55b8e9/_0x45d704:0x0;console['log'](_0x3d9776(0x70)+_0x55b8e9[_0x3d9776(0x13e)](0x2)+_0x3d9776(0x107)),console[_0x3d9776(0xfa)]('üìà\x20Average\x20payment:\x20'+_0x48a962[_0x3d9776(0x13e)](0x2)+'\x20USDT');const _0x36dea4=await database_1[_0x3d9776(0x119)][_0x3d9776(0x9e)]`
      SELECT 
        DATE(created_at) as date,
        array_agg(
          json_build_object(
            'amount', amount,
            'currency', currency,
            'status', status,
            'chargeback_amount', chargeback_amount
          )
        ) as payments
      FROM payments 
      WHERE created_at >= ${_0x546087}
        AND status IN ('PAID', 'REFUND', 'CHARGEBACK')
      GROUP BY DATE(created_at)
      ORDER BY date ASC
    `;console[_0x3d9776(0xfa)](_0x3d9776(0x9b)+_0x36dea4[_0x3d9776(0x87)]+'\x20days');const _0x4bd415=await Promise['all'](_0x36dea4['map'](async _0x328584=>{const _0x115b30=_0x3d9776,_0x3b1bdf=await Promise[_0x115b30(0x136)](_0x328584[_0x115b30(0xb6)][_0x115b30(0xea)](async _0x56230f=>{const _0x13d4d0=_0x115b30,_0x40b82d=this[_0x13d4d0(0xfd)](_0x56230f);if(_0x40b82d===0x0)return 0x0;return _0x56230f[_0x13d4d0(0xb2)]===_0x13d4d0(0xe6)?-Math[_0x13d4d0(0x124)](_0x40b82d):await currencyService_1[_0x13d4d0(0x12f)][_0x13d4d0(0x112)](_0x56230f[_0x13d4d0(0xd7)],_0x56230f[_0x13d4d0(0xb0)]);})),_0x2e0d34=_0x3b1bdf[_0x115b30(0x103)]((_0x39d8c2,_0x3a28bd)=>_0x39d8c2+_0x3a28bd,0x0);return{'date':_0x328584['date'][_0x115b30(0xc6)]()['split']('T')[0x0],'amount':_0x2e0d34};})),_0x141869=this[_0x3d9776(0x140)](_0x546087,new Date()),_0x6f7ad6=new Map(_0x4bd415['map'](_0xd2070a=>[_0xd2070a[_0x3d9776(0x133)],_0xd2070a[_0x3d9776(0xd7)]])),_0xfbee58=_0x141869['map'](_0x42bf72=>({'date':_0x42bf72,'amount':_0x6f7ad6[_0x3d9776(0x10e)](_0x42bf72)||0x0}));return console[_0x3d9776(0xfa)]('‚úÖ\x20Admin\x20statistics\x20generated\x20successfully'),console[_0x3d9776(0xfa)](_0x3d9776(0x71)+_0x52a966),console[_0x3d9776(0xfa)](_0x3d9776(0xc4)+_0x45d704),console[_0x3d9776(0xfa)](_0x3d9776(0xba)+_0xfbee58[_0x3d9776(0x87)]),{'totalRevenue':Math['round'](_0x55b8e9*0x64)/0x64,'totalUsers':_0x52a966,'totalPayments':_0x45d704,'averagePayment':Math[_0x3d9776(0xfe)](_0x48a962*0x64)/0x64,'dailyRevenue':_0xfbee58};}async[a33_0x63dd0a(0x100)](_0x568692){const _0x4c0445=a33_0x63dd0a,{page:_0x3cd23a,limit:_0x2a32e7,status:_0x452d45,gateway:_0x1b2cb0,shopId:_0x1ae277,dateFrom:_0x85d5fa,dateTo:_0x2e21af,search:_0x11c5a2}=_0x568692,_0x5dee51=(_0x3cd23a-0x1)*_0x2a32e7;console[_0x4c0445(0xfa)](_0x4c0445(0x8f),_0x568692);const _0x51c5fe={};_0x452d45&&(_0x51c5fe[_0x4c0445(0xb2)]=_0x452d45['toUpperCase']());if(_0x1b2cb0){if((0x0,gateway_1[_0x4c0445(0x97)])(_0x1b2cb0)){const _0x2eb4c4=(0x0,gateway_1['getGatewayNameById'])(_0x1b2cb0);_0x2eb4c4&&(_0x51c5fe[_0x4c0445(0xe1)]=_0x2eb4c4);}else _0x51c5fe[_0x4c0445(0xe1)]=_0x1b2cb0[_0x4c0445(0x78)]();}_0x1ae277&&(_0x51c5fe['shopId']=_0x1ae277);(_0x85d5fa||_0x2e21af)&&(_0x51c5fe[_0x4c0445(0xf3)]={},_0x85d5fa&&(_0x51c5fe['createdAt'][_0x4c0445(0xe5)]=new Date(_0x85d5fa)),_0x2e21af&&(_0x51c5fe[_0x4c0445(0xf3)][_0x4c0445(0x106)]=new Date(_0x2e21af)));_0x11c5a2&&(_0x51c5fe['OR']=[{'orderId':{'contains':_0x11c5a2,'mode':_0x4c0445(0xeb)}},{'gatewayOrderId':{'contains':_0x11c5a2,'mode':_0x4c0445(0xeb)}},{'gatewayPaymentId':{'contains':_0x11c5a2,'mode':_0x4c0445(0xeb)}},{'customerEmail':{'contains':_0x11c5a2,'mode':'insensitive'}},{'customerName':{'contains':_0x11c5a2,'mode':_0x4c0445(0xeb)}},{'shop':{'name':{'contains':_0x11c5a2,'mode':'insensitive'}}},{'shop':{'username':{'contains':_0x11c5a2,'mode':_0x4c0445(0xeb)}}}]);const [_0x5767de,_0x4f5295]=await Promise[_0x4c0445(0x136)]([database_1['default'][_0x4c0445(0xdb)][_0x4c0445(0xbc)]({'where':_0x51c5fe,'skip':_0x5dee51,'take':_0x2a32e7,'orderBy':{'createdAt':_0x4c0445(0x132)},'include':{'shop':{'select':{'id':!![],'name':!![],'username':!![]}}}}),database_1[_0x4c0445(0x119)]['payment']['count']({'where':_0x51c5fe})]);console[_0x4c0445(0xfa)](_0x4c0445(0xa6)+_0x5767de['length']+_0x4c0445(0x8c)+_0x4f5295+_0x4c0445(0xa4));const _0x19fc03=_0x5767de[_0x4c0445(0xea)](_0x42b485=>({'id':_0x42b485['id'],'shopId':_0x42b485[_0x4c0445(0xe0)],'shopName':_0x42b485[_0x4c0445(0x13c)][_0x4c0445(0xc5)],'shopUsername':_0x42b485[_0x4c0445(0x13c)][_0x4c0445(0x9d)],'gateway':_0x42b485['gateway'],'orderId':_0x42b485[_0x4c0445(0x75)],'gatewayOrderId':_0x42b485[_0x4c0445(0xdd)],'amount':_0x42b485[_0x4c0445(0xd7)],'currency':_0x42b485[_0x4c0445(0xb0)],'sourceCurrency':_0x42b485['sourceCurrency'],'status':_0x42b485[_0x4c0445(0xb2)],'usage':_0x42b485[_0x4c0445(0xb9)],'externalPaymentUrl':_0x42b485[_0x4c0445(0x76)],'gatewayPaymentId':_0x42b485[_0x4c0445(0xaa)],'customerEmail':_0x42b485['customerEmail'],'customerName':_0x42b485['customerName'],'cardLast4':_0x42b485[_0x4c0445(0x11f)],'paymentMethod':_0x42b485[_0x4c0445(0xbd)],'bankId':_0x42b485[_0x4c0445(0xae)],'remitterIban':_0x42b485[_0x4c0445(0xc9)],'remitterName':_0x42b485['remitterName'],'chargebackAmount':_0x42b485['chargebackAmount'],'adminNotes':_0x42b485[_0x4c0445(0xb8)],'statusChangedBy':_0x42b485['statusChangedBy'],'statusChangedAt':_0x42b485[_0x4c0445(0x7d)],'createdAt':_0x42b485[_0x4c0445(0xf3)],'updatedAt':_0x42b485[_0x4c0445(0xed)],'expiresAt':_0x42b485[_0x4c0445(0xc2)]}));return{'payments':_0x19fc03,'pagination':{'page':_0x3cd23a,'limit':_0x2a32e7,'total':_0x4f5295,'totalPages':Math[_0x4c0445(0xab)](_0x4f5295/_0x2a32e7)}};}async[a33_0x63dd0a(0x137)](_0x234b60){const _0x26404f=a33_0x63dd0a;console[_0x26404f(0xfa)]('üîç\x20Getting\x20payment\x20by\x20ID:\x20'+_0x234b60);const _0x108dec=await database_1[_0x26404f(0x119)]['payment']['findUnique']({'where':{'id':_0x234b60},'include':{'shop':{'select':{'id':!![],'name':!![],'username':!![]}},'webhookLogs':{'orderBy':{'createdAt':'desc'},'take':0xa,'select':{'id':!![],'event':!![],'statusCode':!![],'retryCount':!![],'createdAt':!![]}}}});if(!_0x108dec)return console[_0x26404f(0xfa)](_0x26404f(0x111)+_0x234b60),null;return console[_0x26404f(0xfa)](_0x26404f(0xd1)+_0x108dec['orderId']+'\x20('+_0x108dec[_0x26404f(0xb2)]+')'),{'id':_0x108dec['id'],'shopId':_0x108dec[_0x26404f(0xe0)],'shopName':_0x108dec[_0x26404f(0x13c)][_0x26404f(0xc5)],'shopUsername':_0x108dec[_0x26404f(0x13c)][_0x26404f(0x9d)],'gateway':_0x108dec[_0x26404f(0xe1)],'orderId':_0x108dec[_0x26404f(0x75)],'gatewayOrderId':_0x108dec[_0x26404f(0xdd)],'amount':_0x108dec[_0x26404f(0xd7)],'currency':_0x108dec[_0x26404f(0xb0)],'sourceCurrency':_0x108dec[_0x26404f(0x7c)],'status':_0x108dec[_0x26404f(0xb2)],'usage':_0x108dec['usage'],'externalPaymentUrl':_0x108dec['externalPaymentUrl'],'gatewayPaymentId':_0x108dec[_0x26404f(0xaa)],'customerEmail':_0x108dec[_0x26404f(0xf1)],'customerName':_0x108dec['customerName'],'cardLast4':_0x108dec['cardLast4'],'paymentMethod':_0x108dec['paymentMethod'],'bankId':_0x108dec[_0x26404f(0xae)],'remitterIban':_0x108dec[_0x26404f(0xc9)],'remitterName':_0x108dec['remitterName'],'chargebackAmount':_0x108dec[_0x26404f(0x128)],'adminNotes':_0x108dec[_0x26404f(0xb8)],'statusChangedBy':_0x108dec[_0x26404f(0x121)],'statusChangedAt':_0x108dec[_0x26404f(0x7d)],'createdAt':_0x108dec[_0x26404f(0xf3)],'updatedAt':_0x108dec[_0x26404f(0xed)],'expiresAt':_0x108dec[_0x26404f(0xc2)],'webhookLogs':_0x108dec['webhookLogs']};}async[a33_0x63dd0a(0xc1)](_0x192ae1,_0x2dad98,_0x5acefa,_0x4af8da){const _0x445a34=a33_0x63dd0a;console[_0x445a34(0xfa)](_0x445a34(0xcd)+_0x192ae1+_0x445a34(0x74)+_0x2dad98);const _0x32e559=[_0x445a34(0x96),_0x445a34(0x10d),_0x445a34(0xbf),_0x445a34(0x9c),_0x445a34(0xe2),'CHARGEBACK'];if(!_0x32e559[_0x445a34(0x10f)](_0x2dad98[_0x445a34(0xa3)]()))throw new Error(_0x445a34(0xb7)+_0x32e559[_0x445a34(0xc0)](',\x20'));const _0x10e17c=await database_1[_0x445a34(0x119)]['payment'][_0x445a34(0x125)]({'where':{'id':_0x192ae1},'select':{'id':!![],'status':!![],'orderId':!![]}});if(!_0x10e17c)throw new Error(_0x445a34(0x6e));if(_0x2dad98[_0x445a34(0xa3)]()===_0x445a34(0xe6)){if(!_0x4af8da||_0x4af8da<=0x0)throw new Error(_0x445a34(0x117));console['log']('üí∏\x20Chargeback\x20amount:\x20'+_0x4af8da+_0x445a34(0x118));}const _0x44d658={'status':_0x2dad98['toUpperCase'](),'updatedAt':new Date(),'statusChangedBy':_0x445a34(0x9f),'statusChangedAt':new Date()};_0x5acefa&&(_0x44d658[_0x445a34(0xb8)]=_0x5acefa);_0x2dad98[_0x445a34(0xa3)]()===_0x445a34(0xe6)&&_0x4af8da&&(_0x44d658['chargebackAmount']=_0x4af8da);const _0x48a1a4=await database_1['default'][_0x445a34(0xdb)][_0x445a34(0x91)]({'where':{'id':_0x192ae1},'data':_0x44d658,'include':{'shop':{'select':{'id':!![],'name':!![],'username':!![]}}}});return await database_1[_0x445a34(0x119)][_0x445a34(0x7f)][_0x445a34(0x108)]({'data':{'paymentId':_0x192ae1,'shopId':_0x48a1a4[_0x445a34(0xe0)],'event':'admin_status_update','statusCode':0xc8,'responseBody':JSON[_0x445a34(0xad)]({'oldStatus':_0x10e17c[_0x445a34(0xb2)],'newStatus':_0x2dad98[_0x445a34(0xa3)](),'notes':_0x5acefa||null,'chargebackAmount':_0x4af8da||null,'updatedBy':'admin','timestamp':new Date()[_0x445a34(0xc6)]()})}}),console[_0x445a34(0xfa)](_0x445a34(0x109)+_0x10e17c[_0x445a34(0x75)]+_0x445a34(0xd5)+_0x10e17c['status']+_0x445a34(0x13d)+_0x2dad98[_0x445a34(0xa3)]()),_0x2dad98['toUpperCase']()===_0x445a34(0xe6)&&console[_0x445a34(0xfa)](_0x445a34(0x94)+_0x4af8da+_0x445a34(0x144)),{'id':_0x48a1a4['id'],'shopId':_0x48a1a4[_0x445a34(0xe0)],'shopName':_0x48a1a4[_0x445a34(0x13c)]['name'],'shopUsername':_0x48a1a4[_0x445a34(0x13c)][_0x445a34(0x9d)],'gateway':_0x48a1a4[_0x445a34(0xe1)],'orderId':_0x48a1a4['orderId'],'gatewayOrderId':_0x48a1a4['gatewayOrderId'],'amount':_0x48a1a4[_0x445a34(0xd7)],'currency':_0x48a1a4['currency'],'sourceCurrency':_0x48a1a4['sourceCurrency'],'status':_0x48a1a4[_0x445a34(0xb2)],'usage':_0x48a1a4[_0x445a34(0xb9)],'externalPaymentUrl':_0x48a1a4[_0x445a34(0x76)],'gatewayPaymentId':_0x48a1a4[_0x445a34(0xaa)],'customerEmail':_0x48a1a4[_0x445a34(0xf1)],'customerName':_0x48a1a4[_0x445a34(0xd9)],'cardLast4':_0x48a1a4[_0x445a34(0x11f)],'paymentMethod':_0x48a1a4[_0x445a34(0xbd)],'bankId':_0x48a1a4['bankId'],'remitterIban':_0x48a1a4['remitterIban'],'remitterName':_0x48a1a4[_0x445a34(0x7b)],'chargebackAmount':_0x48a1a4[_0x445a34(0x128)],'adminNotes':_0x48a1a4[_0x445a34(0xb8)],'statusChangedBy':_0x48a1a4[_0x445a34(0x121)],'statusChangedAt':_0x48a1a4['statusChangedAt'],'createdAt':_0x48a1a4[_0x445a34(0xf3)],'updatedAt':_0x48a1a4['updatedAt'],'expiresAt':_0x48a1a4['expiresAt']};}async[a33_0x63dd0a(0x146)](_0x495040){const _0x593aea=a33_0x63dd0a,{page:_0xf68a6c,limit:_0x12587a,status:_0x50b180}=_0x495040,_0x163014=(_0xf68a6c-0x1)*_0x12587a,_0xac2fee={};_0x50b180&&(_0xac2fee['status']=_0x50b180[_0x593aea(0xa3)]());console[_0x593aea(0xfa)]('üìã\x20Getting\x20users\x20with\x20filters:',{'page':_0xf68a6c,'limit':_0x12587a,'status':_0x50b180,'where':_0xac2fee});const [_0x441a79,_0x47b962]=await Promise['all']([database_1[_0x593aea(0x119)][_0x593aea(0x13c)][_0x593aea(0xbc)]({'where':_0xac2fee,'skip':_0x163014,'take':_0x12587a,'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]},'orderBy':{'createdAt':'desc'}}),database_1[_0x593aea(0x119)]['shop'][_0x593aea(0x88)]({'where':_0xac2fee})]);console[_0x593aea(0xfa)](_0x593aea(0xa6)+_0x441a79[_0x593aea(0x87)]+_0x593aea(0x115)+_0x47b962+_0x593aea(0xa4));const _0x4a99fe=_0x441a79[_0x593aea(0xea)](_0x25d74d=>({'id':_0x25d74d['id'],'fullName':_0x25d74d[_0x593aea(0xc5)],'username':_0x25d74d['username'],'telegramId':_0x25d74d[_0x593aea(0xcf)],'merchantUrl':_0x25d74d[_0x593aea(0xda)],'gateways':_0x25d74d[_0x593aea(0xb1)]?JSON['parse'](_0x25d74d[_0x593aea(0xb1)]):null,'gatewaySettings':_0x25d74d[_0x593aea(0x80)]?JSON[_0x593aea(0xf4)](_0x25d74d[_0x593aea(0x80)]):null,'publicKey':_0x25d74d['publicKey'],'wallets':{'usdtPolygonWallet':_0x25d74d[_0x593aea(0xd8)],'usdtTrcWallet':_0x25d74d[_0x593aea(0xf0)],'usdtErcWallet':_0x25d74d[_0x593aea(0x113)],'usdcPolygonWallet':_0x25d74d[_0x593aea(0x86)]},'status':_0x25d74d[_0x593aea(0xb2)],'createdAt':_0x25d74d[_0x593aea(0xf3)]}));return{'users':_0x4a99fe,'pagination':{'page':_0xf68a6c,'limit':_0x12587a,'total':_0x47b962,'totalPages':Math[_0x593aea(0xab)](_0x47b962/_0x12587a)}};}async[a33_0x63dd0a(0xca)](_0x3cf5eb){const _0x376128=a33_0x63dd0a;return await this[_0x376128(0xe8)][_0x376128(0xca)](_0x3cf5eb);}async[a33_0x63dd0a(0x127)](_0x216886){const _0xb580f7=a33_0x63dd0a;return await this[_0xb580f7(0xe8)][_0xb580f7(0x127)](_0x216886);}async[a33_0x63dd0a(0x10b)](_0x515ebb,_0x45383e){const _0x5a9347=a33_0x63dd0a;return await this[_0x5a9347(0xe8)][_0x5a9347(0x10b)](_0x515ebb,_0x45383e);}async[a33_0x63dd0a(0xe3)](_0x4390c5){const _0x1e68a2=a33_0x63dd0a;return await this[_0x1e68a2(0xe8)][_0x1e68a2(0xe3)](_0x4390c5);}async['suspendUser'](_0x2f0d4d){const _0x87db7b=a33_0x63dd0a;console[_0x87db7b(0xfa)]('üö´\x20Suspending\x20user:\x20'+_0x2f0d4d);const _0x52b5a5=await database_1[_0x87db7b(0x119)]['shop'][_0x87db7b(0x125)]({'where':{'id':_0x2f0d4d},'select':{'id':!![],'username':!![],'status':!![]}});if(!_0x52b5a5)throw new Error(_0x87db7b(0xe7));if(_0x52b5a5['status']===_0x87db7b(0x12e))throw new Error('User\x20is\x20already\x20suspended');const _0x33df84=await this[_0x87db7b(0xe8)][_0x87db7b(0x10b)](_0x2f0d4d,{'status':_0x87db7b(0x12e)});return console['log'](_0x87db7b(0x8a)+_0x52b5a5['username']+'\x20suspended\x20successfully'),_0x33df84;}async[a33_0x63dd0a(0xbb)](_0x4d00f2){const _0x3f6132=a33_0x63dd0a;console[_0x3f6132(0xfa)](_0x3f6132(0xb4)+_0x4d00f2);const _0x21aebf=await database_1[_0x3f6132(0x119)][_0x3f6132(0x13c)][_0x3f6132(0x125)]({'where':{'id':_0x4d00f2},'select':{'id':!![],'username':!![],'status':!![]}});if(!_0x21aebf)throw new Error(_0x3f6132(0xe7));if(_0x21aebf[_0x3f6132(0xb2)]===_0x3f6132(0x89))throw new Error(_0x3f6132(0xef));const _0x277d17=await this[_0x3f6132(0xe8)][_0x3f6132(0x10b)](_0x4d00f2,{'status':_0x3f6132(0x89)});return console['log'](_0x3f6132(0x8a)+_0x21aebf[_0x3f6132(0x9d)]+_0x3f6132(0x102)),_0x277d17;}}function a33_0x557b(){const _0x2b6e95=['toUpperCase','\x20total','UserService','üìä\x20Found\x20','171yVULRt','getDate','üí∞\x20Found\x20','gatewayPaymentId','ceil','__esModule','stringify','bankId','getGatewaySettings','currency','paymentGateways','status','\x20payments\x20for\x20analysis\x20(PAID/REFUND/CHARGEBACK)','‚úÖ\x20Activating\x20user:\x20','amountUSDT','payments','Invalid\x20status.\x20Valid\x20statuses:\x20','adminNotes','usage','üìä\x20Daily\x20revenue\x20entries:\x20','activateUser','findMany','paymentMethod','üóëÔ∏è\x20Deleting\x20payout:\x20','EXPIRED','join','updatePaymentStatus','expiresAt','505WeBzkd','üí≥\x20Total\x20payments:\x20','name','toISOString','charAt','\x20deleted\x20successfully','remitterIban','getUserById','COMPLETED','getFullYear','üîÑ\x20Admin\x20updating\x20payment\x20','12479160MnbZIS','telegram','notes','‚úÖ\x20Found\x20payment:\x20','2727768XrOTCT','‚úÖ\x20Marked\x20','120NWKFaw','\x20status\x20updated\x20from\x20','\x20USDT\x20after\x20commission)','amount','usdtPolygonWallet','customerName','shopUrl','payment','\x20USDT\x20(','gatewayOrderId','‚úÖ\x20Returning\x20','\x20merchants\x20out\x20of\x20','shopId','gateway','REFUND','deleteUser','../config/database','gte','CHARGEBACK','User\x20not\x20found','userService','74125752pjitik','map','insensitive','16829SeYiLU','updatedAt','getMonth','User\x20is\x20already\x20active','usdtTrcWallet','customerEmail','totalAmountAfterCommissionUSDT','createdAt','parse','162wdDlJU','merchantPaid','./userService','üìä\x20Generating\x20admin\x20statistics\x20for\x20period:\x20','../types/gateway','log','Error\x20parsing\x20gateway\x20settings:','setDate','calculateEffectiveAmount','round','‚ùå\x20Payout\x20not\x20found:\x20','getAllPayments','\x20USDT','\x20activated\x20successfully','reduce','getPayoutById','\x20USDT\x20(—Ç–æ–ª—å–∫–æ\x20PAID\x20–ø–ª–∞—Ç–µ–∂–∏)','lte','\x20USDT\x20(–≤–∫–ª—é—á–∞—è\x20—à—Ç—Ä–∞—Ñ—ã\x20chargeback)','create','‚úÖ\x20Payment\x20','11WskBCP','updateUser','push','PAID','get','includes','updateMany','‚ùå\x20Payment\x20not\x20found:\x20','convertToUSDT','usdtErcWallet','‚è≥\x20Awaiting\x20Payout:\x20','\x20users\x20out\x20of\x20','48076sHhsZO','Chargeback\x20amount\x20is\x20required\x20and\x20must\x20be\x20positive\x20(amount\x20in\x20USDT)','\x20USDT\x20(penalty\x20amount)','default','availableBalance','totalAmountUSDT','261736jefvlC','totalPayout','üí∏\x20Total\x20Payout:\x20','cardLast4','sendPayoutNotification','statusChangedBy','\x20payments\x20as\x20paid\x20out','üè™\x20Found\x20','abs','findUnique','\x20eligible\x20PAID\x20payments\x20for\x20payout\x20analysis','createUser','chargebackAmount','\x20payouts\x20out\x20of\x20','payout','\x20days)','./currencyService','getPeriodDays','SUSPENDED','currencyService','paidAt','from','desc','date','defineProperty','entries','all','getPaymentById','set','üí∞\x20Available\x20Balance:\x20','payoutDelay','deletePayout','shop','\x20to\x20','toFixed','üìã\x20Getting\x20merchants\x20awaiting\x20payout\x20with\x20filters:','generateDateRange','30d','getPayoutStats','split','\x20USDT\x20(will\x20be\x20deducted\x20from\x20merchant\x20balance)','size','getAllUsers','Payment\x20not\x20found','Shop\x20not\x20found','üíµ\x20Total\x20revenue:\x20','üë•\x20Total\x20users:\x20','getAllPayouts','txid','\x20status\x20to:\x20','orderId','externalPaymentUrl','network','toLowerCase','createPayout','amountAfterCommissionUSDT','remitterName','sourceCurrency','statusChangedAt','üìÖ\x20This\x20Month:\x20','webhookLog','gatewaySettings','completed','AdminService','getSystemStatistics','460012Ipctmw','awaitingPayout','usdcPolygonWallet','length','count','ACTIVE','‚úÖ\x20User\x20','isEligibleForPayout','\x20payments\x20out\x20of\x20','90d','Failed\x20to\x20send\x20Telegram\x20payout\x20notification:','üìã\x20Getting\x20payments\x20with\x20filters:','sort','update',',\x20amount:\x20','\x20payments\x20for\x20revenue\x20calculation\x20(PAID/REFUND/CHARGEBACK)','üí∏\x20Chargeback\x20penalty:\x20','‚úÖ\x20Payout\x20statistics\x20calculated:','PENDING','isValidGatewayId','error','slice','markPaymentsAsPaidOut','üìÖ\x20Processing\x20daily\x20stats\x20for\x20','FAILED','username','$queryRaw','admin','üìä\x20Calculating\x20admin\x20payout\x20statistics...','\x20USDT\x20via\x20','commission'];a33_0x557b=function(){return _0x2b6e95;};return a33_0x557b();}exports[a33_0x63dd0a(0x82)]=AdminService;