'use strict';const a36_0x4a566d=a36_0x3a40;(function(_0x2c390e,_0x38015b){const _0x2c5786=a36_0x3a40,_0x77fed1=_0x2c390e();while(!![]){try{const _0x683645=parseInt(_0x2c5786(0x144))/0x1*(-parseInt(_0x2c5786(0x152))/0x2)+parseInt(_0x2c5786(0x7e))/0x3*(parseInt(_0x2c5786(0x128))/0x4)+-parseInt(_0x2c5786(0xbb))/0x5*(parseInt(_0x2c5786(0xff))/0x6)+parseInt(_0x2c5786(0xef))/0x7+parseInt(_0x2c5786(0x115))/0x8*(parseInt(_0x2c5786(0x11c))/0x9)+-parseInt(_0x2c5786(0x93))/0xa+parseInt(_0x2c5786(0x172))/0xb*(parseInt(_0x2c5786(0x17b))/0xc);if(_0x683645===_0x38015b)break;else _0x77fed1['push'](_0x77fed1['shift']());}catch(_0x31e429){_0x77fed1['push'](_0x77fed1['shift']());}}}(a36_0x533e,0x57e9a));function a36_0x3a40(_0x4e7220,_0x5683d6){const _0x533ece=a36_0x533e();return a36_0x3a40=function(_0x3a4020,_0x40a3f8){_0x3a4020=_0x3a4020-0x78;let _0x1f0394=_0x533ece[_0x3a4020];return _0x1f0394;},a36_0x3a40(_0x4e7220,_0x5683d6);}var __importDefault=this&&this[a36_0x4a566d(0x7b)]||function(_0x3b917a){const _0x4b3beb=a36_0x4a566d;return _0x3b917a&&_0x3b917a[_0x4b3beb(0x9a)]?_0x3b917a:{'default':_0x3b917a};};function a36_0x533e(){const _0x16813f=['statusChangedAt','totalCommissionRate','usdtTrcWallet','getTime','2148858xikTUB','\x20->\x20','findUnique','Insufficient\x20balance.\x20Available:\x20','getDate','🔄\x20Admin\x20updating\x20payment\x20','\x20\x20\x20👤\x20Merchant\x20earnings:\x20','map','hex','🔧\x20[','💰\x20Payment\x20','commission','payout','\x20order','klyme_de','\x20to\x20','findFirst','Open\x20Banking\x202',']\x20Gateway\x20settings\x20before\x20saving:','📊\x20Available\x20gateways\x20in\x20database:',',\x20Commission:\x20','periodTo','248NeCHKO','shopUrl','randomBytes','✅\x20Customer\x20data\x20updated\x20for\x20payment\x20','COMPLETED','findMany','gatewayEarnings','99828zHVFfa','ACTIVE','Error\x20parsing\x20gateway\x20settings\x20for\x20shop\x20','\x20\x20\x20Current\x20total\x20paid\x20out:\x20','📊\x20Sorting\x20payments\x20by\x20','rapyd','usdtPolygonWallet','notes','\x27\x20as\x20is\x20(not\x20found\x20in\x20mappings)','📋\x20Getting\x20merchants\x20selection\x20list...','\x20\x20\x20�📊\x20Total\x20payments:\x20','totalPayments','1915820pOGoDh','pk_','2020-01-01','currencyService','📊\x20Final\x20WHERE\x20conditions:',',\x20successful:\x20','setHours','\x27\x20->\x20ID\x20\x27','thisMonth','payment','\x20USDT\x20(after\x20payouts)','updatedAt','customerIp','\x20USDT','polygon_usdc','createUser','defineProperty','\x27\x20not\x20found.\x20Available\x20gateways:\x20','\x20\x20\x20⏳\x20Awaiting\x20payout:\x20','averageCheckUSDT','\x20USDT\x20(-','random','currency','🎯\x20updateUser\x20called\x20with\x20ID:\x20','\x20USDT\x20(gross\x20revenue)','\x20became\x20PAID:','📊\x20Gateway\x20filter\x20applied:','⚠️\x20Requested\x20gateway\x20\x27','83YsRnrU','substr','commissionUSDT','forEach','💰\x20Creating\x20payout\x20for\x20shop\x20','generateDailyStatistics','dailyPayments','adminNotes','balance','dateTo','getMerchantStatistics',',\x20userId:\x20','🎯\x20[','suspendUser','3346lnxJpB','convertToUSDT','\x20USDT\x20(','values','paymentGateways','setDate','deleteUser','getMonth','toFixed','customerEmail','updateCustomerData','gatewayOrderId','\x20\x20\x20Payout\x20amount:\x20','\x20\x20\x20Merchant\x20gets:\x20','Error\x20processing\x20payment\x20','totalPaidOut','\x20\x20\x20📅\x20Total\x20payouts\x20(this\x20month):\x20','$transaction','includes','hash','📊\x20Payout\x20statistics\x20calculated:','parse','merchantEarnings','amount','toLowerCase','log',']\x20User\x20updated,\x20gatewaySettings\x20from\x20DB:','externalPaymentUrl','set','\x20no\x20longer\x20PAID:','\x20USDT\x20(actual\x20balances)','shopId','16709BspmCv','failureMessage','publicKey','getPayoutStats','\x20\x20\x20Gateway:\x20','📋\x20Found\x20','\x20for\x20shop\x20','\x20\x20\x20✅\x20Total\x20available\x20for\x20payout:\x20','\x20\x20\x20🏪\x20Gateway\x20earnings:\x20','3120wTsJXz','💰\x20Found\x20','split','paidAt','stringify','AdminService','round','aggregate','\x20USDT\x20from\x20balance','_sum','amountAfterGatewayCommissionUSDT','KLYME\x20EU','💳\x20Payout\x20wallet\x20for\x20','getSystemStatistics','⚠️\x20Payment\x20','📊\x20Calculating\x20commission\x20manually\x20for\x20payment\x20','REFUND','\x20\x20\x20💸\x20Total\x20payouts\x20(all\x20time):\x20','getGatewayNameById','\x20\x20\x20🌍\x20Country:\x20','gateways','wallets','📊\x20Getting\x20merchants\x20awaiting\x20payout\x20with\x20filters:','orderId','PAID','entries','\x20\x20\x20�\x20Total\x20paid\x20out:\x20','username','not\x20specified','\x20\x20\x20💵\x20Available\x20balance:\x20','🔄\x20Gateway\x20mapping:','name','📊\x20Using\x20saved\x20amountAfterGatewayCommissionUSDT:\x20','🔄\x20Converted\x20gateway\x20name\x20\x27','\x20merchants','Shop\x20not\x20found','fullName','\x20status:\x20','\x20USDT)','💰\x20[PAYOUT]\x20Gateway\x20','status','Username\x20already\x20exists','plisio','telegram','MasterCard','CoinToPay','\x20USDT\x20(theoretical\x20net)','averageCommissionRate','year','%\x20from\x20','💸\x20CHARGEBACK\x20penalty:\x20-','💰\x20Current\x20shop\x20balance:\x20','Rapyd','__importDefault','totalAmountUSDT','getPaymentById','3ovKLkd','trim',']\x20Gateway\x20settings\x20JSON\x20string:','createdAt','error','desc','\x20\x20\x20Total\x20paid\x20out:\x20','chargebackAmount','Error\x20parsing\x20gateway\x20settings\x20for\x20payment\x20','custom','toString','groupBy','30d','getPayoutById','\x20PAID\x20payments','not\x20set','date','Payment\x20not\x20found','\x20\x20\x20💰\x20Total\x20payments\x20turnover:\x20','delete','Plisio','6928860zrQCsy','📊\x20[ADMIN]\x20Using\x20saved\x20amountAfterGatewayCommissionUSDT:\x20','txid','📊\x20Total\x20payments\x20(including\x20failed):\x20','📊\x20[ADMIN]\x20Calculating\x20commission\x20manually\x20for\x20payment\x20','reduce','getUserById','__esModule','getMerchantsAwaitingPayout','pendingUrl','klyme_gb','length','lte','mastercard','KLYME\x20DE','KLYME\x20GB','insensitive','merchantUrl','telegramId','./currencyService','CHARGEBACK','activateUser','some','🔐\x20[','toUpperCase','gateway','usdcPolygonWallet','Noda','\x20\x20\x20📅\x20This\x20month:\x20','pendingPayout','shop','\x20\x20\x20Current\x20balance:\x20','ceil','amountAfterCommissionUSDT','getGatewayIdByName','📊\x20Merchant\x20statistics\x20calculated:','turnover','\x20USDT,\x20Requested:\x20','📊\x20Getting\x20payments\x20with\x20filters:','awaitingPayout','5KMzoNl','totalPayout','update','gte','getFullYear','getGatewayInternalName','asc','whiteUrl','\x20\x20\x20🔍\x20Raw\x20balance\x20sum:\x20','%\x20commission)','crypto','join','customerUa','bcryptjs','🔍\x20Using\x20gateway\x20\x27','customerCountry','_count','\x20balance\x20updated:','\x20\x20\x20🖥️\x20User\x20Agent:\x20','updatePaymentStatus','💰\x20Shop\x20','dateFrom','gatewaySettings','\x20paid\x20payments\x20for\x20analysis','password','toISOString','📊\x20Getting\x20merchant\x20statistics\x20with\x20filters:','getAllUsers','\x27\x20to\x20name\x20\x27','failUrl','\x20\x20\x20�\x20Total\x20payments\x20turnover:\x20','count','\x20\x20\x20Full\x20amount:\x20','\x20USDT\x20for\x20payment\x20','usdtErcWallet','all','🔄\x20Converted\x20gateway\x20ID\x20\x27','polygon','create','noda','dailyRevenue','revenue','period','periodFrom','paymentsCount','\x27\x20(from\x20\x27','default','merchantEarningsUSDT','push','statusChangedBy',']\x20Password\x20not\x20provided\x20or\x20empty,\x20skipping\x20password\x20update','\x20\x20\x20⏳\x20Pending\x20payout:\x20','2325617nvVSrV','amountUSDT','turnoverUSDT','\x20USDT\x20(after\x20','test_gateway','getGatewayDisplayName','network','createPayout','\x20\x20\x20💰\x20Total\x20turnover:\x20','\x20\x20\x20📊\x20Commission\x20difference:\x20','\x20\x20\x20🔍\x20Calculated\x20after\x20commission:\x20','\x20active\x20merchants\x20for\x20selection'];a36_0x533e=function(){return _0x16813f;};return a36_0x533e();}Object[a36_0x4a566d(0x138)](exports,a36_0x4a566d(0x9a),{'value':!![]}),exports[a36_0x4a566d(0x180)]=void 0x0;const database_1=__importDefault(require('../config/database')),bcryptjs_1=__importDefault(require(a36_0x4a566d(0xc8))),crypto_1=__importDefault(require(a36_0x4a566d(0xc5))),currencyService_1=require(a36_0x4a566d(0xa6)),gateway_1=require('../types/gateway');class AdminService{async[a36_0x4a566d(0x175)](){const _0x552713=a36_0x4a566d;console[_0x552713(0x16b)]('📊\x20Calculating\x20payout\x20statistics...');const _0x5f55b3=await database_1[_0x552713(0xe9)][_0x552713(0xb1)]['aggregate']({'_sum':{'balance':!![],'totalPaidOut':!![]},'where':{'status':_0x552713(0x11d)}}),_0x2f18bc=await this[_0x552713(0x9b)]({'page':0x1,'limit':0x3e8}),_0x13ec2f=await database_1[_0x552713(0xe9)][_0x552713(0x131)][_0x552713(0xda)]({'where':{'status':_0x552713(0x193),'gateway':{'not':'test_gateway'}}}),_0x54d34f=new Date(),_0x5a9c00=new Date(_0x54d34f['getFullYear'](),_0x54d34f[_0x552713(0x159)](),0x1),_0x2c1e62=new Date(_0x54d34f[_0x552713(0xbf)](),_0x54d34f[_0x552713(0x159)]()+0x1,0x0,0x17,0x3b,0x3b,0x3e7),_0x3338bf=await database_1[_0x552713(0xe9)][_0x552713(0x10b)]['aggregate']({'_sum':{'amount':!![]},'where':{'createdAt':{'gte':_0x5a9c00,'lte':_0x2c1e62},'status':_0x552713(0x119)}}),_0x3de397=_0x5f55b3[_0x552713(0x184)]['totalPaidOut']||0x0,_0x4eadd9=_0x2f18bc['summary']['totalAmountAfterCommissionUSDT'],_0x39a29b=_0x3338bf[_0x552713(0x184)]['amount']||0x0,_0x3ec6a7={'totalPayout':Math[_0x552713(0x181)](_0x3de397*0x64)/0x64,'awaitingPayout':Math[_0x552713(0x181)](_0x4eadd9*0x64)/0x64,'thisMonth':Math[_0x552713(0x181)](_0x39a29b*0x64)/0x64,'availableBalance':Math[_0x552713(0x181)](_0x4eadd9*0x64)/0x64,'totalPayments':_0x13ec2f};return console[_0x552713(0x16b)](_0x552713(0x166)),console[_0x552713(0x16b)]('\x20\x20\x20💰\x20Total\x20payout:\x20'+_0x3ec6a7[_0x552713(0xbc)]+'\x20USDT\x20(total\x20paid\x20to\x20merchants)'),console['log'](_0x552713(0x13a)+_0x3ec6a7[_0x552713(0xba)]+'\x20USDT\x20(with\x20commission\x20deducted)'),console[_0x552713(0x16b)](_0x552713(0x198)+_0x3ec6a7['availableBalance']+'\x20USDT\x20(same\x20as\x20awaiting)'),console[_0x552713(0x16b)](_0x552713(0xaf)+_0x3ec6a7[_0x552713(0x130)]+_0x552713(0x135)),console['log']('\x20\x20\x20💳\x20Total\x20payments:\x20'+_0x3ec6a7[_0x552713(0x127)]+_0x552713(0x8c)),console[_0x552713(0x16b)](_0x552713(0xc3)+(_0x5f55b3[_0x552713(0x184)][_0x552713(0x14c)]||0x0)[_0x552713(0x15a)](0x2)+'\x20USDT\x20(without\x20commission)'),console[_0x552713(0x16b)](_0x552713(0xf8)+((_0x5f55b3[_0x552713(0x184)][_0x552713(0x14c)]||0x0)-_0x4eadd9)['toFixed'](0x2)+_0x552713(0x135)),_0x3ec6a7;}async[a36_0x4a566d(0x15c)](_0x11c3c0,_0x1e6137){const _0x2dfdd7=a36_0x4a566d;console['log']('🔄\x20Updating\x20customer\x20data\x20for\x20payment\x20'+_0x11c3c0+':',_0x1e6137);const _0x3d884c=await database_1[_0x2dfdd7(0xe9)][_0x2dfdd7(0x131)][_0x2dfdd7(0x101)]({'where':{'id':_0x11c3c0},'select':{'id':!![],'customerEmail':!![],'customerName':!![],'customerCountry':!![],'customerIp':!![],'customerUa':!![]}});if(!_0x3d884c)throw new Error(_0x2dfdd7(0x8f));const _0x113cf6={};_0x1e6137['customerCountry']!==undefined&&(_0x113cf6[_0x2dfdd7(0xca)]=_0x1e6137['customerCountry']||null);_0x1e6137[_0x2dfdd7(0x134)]!==undefined&&(_0x113cf6[_0x2dfdd7(0x134)]=_0x1e6137[_0x2dfdd7(0x134)]||null);_0x1e6137[_0x2dfdd7(0xc7)]!==undefined&&(_0x113cf6[_0x2dfdd7(0xc7)]=_0x1e6137[_0x2dfdd7(0xc7)]||null);const _0x5979e9=await database_1[_0x2dfdd7(0xe9)]['payment'][_0x2dfdd7(0xbd)]({'where':{'id':_0x11c3c0},'data':{..._0x113cf6,'updatedAt':new Date()},'select':{'id':!![],'customerEmail':!![],'customerName':!![],'customerCountry':!![],'customerIp':!![],'customerUa':!![],'updatedAt':!![]}});return console['log'](_0x2dfdd7(0x118)+_0x11c3c0),console[_0x2dfdd7(0x16b)](_0x2dfdd7(0x18e)+_0x3d884c['customerCountry']+_0x2dfdd7(0x100)+_0x5979e9[_0x2dfdd7(0xca)]),console[_0x2dfdd7(0x16b)]('\x20\x20\x20🌐\x20IP:\x20'+_0x3d884c[_0x2dfdd7(0x134)]+'\x20->\x20'+_0x5979e9[_0x2dfdd7(0x134)]),console['log'](_0x2dfdd7(0xcd)+(_0x3d884c[_0x2dfdd7(0xc7)]?_0x2dfdd7(0x16e):'not\x20set')+_0x2dfdd7(0x100)+(_0x5979e9[_0x2dfdd7(0xc7)]?_0x2dfdd7(0x16e):_0x2dfdd7(0x8d))),_0x5979e9;}async[a36_0x4a566d(0x188)](_0x51a40f){const _0x3f2aa8=a36_0x4a566d,_0x4647dd=new Date();let _0x58f509;switch(_0x51a40f[_0x3f2aa8(0x16a)]()){case'day':case'DAY':_0x58f509=new Date(_0x4647dd[_0x3f2aa8(0xbf)](),_0x4647dd[_0x3f2aa8(0x159)](),_0x4647dd[_0x3f2aa8(0x103)](),0x0,0x0,0x0,0x0);break;case'7d':_0x58f509=new Date(_0x4647dd[_0x3f2aa8(0xfe)]()-0x7*0x18*0x3c*0x3c*0x3e8);break;case _0x3f2aa8(0x8a):_0x58f509=new Date(_0x4647dd[_0x3f2aa8(0xfe)]()-0x1e*0x18*0x3c*0x3c*0x3e8);break;case'90d':_0x58f509=new Date(_0x4647dd[_0x3f2aa8(0xfe)]()-0x5a*0x18*0x3c*0x3c*0x3e8);break;case'all':const _0x23c0e1=await database_1[_0x3f2aa8(0xe9)][_0x3f2aa8(0x131)][_0x3f2aa8(0x10f)]({'where':{'gateway':{'not':_0x3f2aa8(0xf3)}},'orderBy':{'createdAt':_0x3f2aa8(0xc1)},'select':{'createdAt':!![]}});_0x58f509=_0x23c0e1?_0x23c0e1[_0x3f2aa8(0x81)]:new Date(_0x3f2aa8(0x12a));break;default:_0x58f509=new Date(_0x4647dd[_0x3f2aa8(0xfe)]()-0x1e*0x18*0x3c*0x3c*0x3e8);}_0x58f509[_0x3f2aa8(0x12e)](0x0,0x0,0x0,0x0);const [_0x47a976,_0x317947,_0x3edf0d,_0x5264f2,_0x530daa,_0x5b18e3]=await Promise[_0x3f2aa8(0xde)]([database_1['default'][_0x3f2aa8(0xb1)]['count'](),database_1[_0x3f2aa8(0xe9)][_0x3f2aa8(0xb1)][_0x3f2aa8(0xda)]({'where':{'status':_0x3f2aa8(0x11d)}}),database_1[_0x3f2aa8(0xe9)][_0x3f2aa8(0x131)][_0x3f2aa8(0xda)]({'where':{'status':_0x3f2aa8(0x193),'createdAt':{'gte':_0x58f509},'gateway':{'not':_0x3f2aa8(0xf3)}}}),database_1['default'][_0x3f2aa8(0x131)][_0x3f2aa8(0x11a)]({'where':{'status':'PAID','createdAt':{'gte':_0x58f509},'gateway':{'not':_0x3f2aa8(0xf3)}},'select':{'amount':!![],'currency':!![],'amountAfterGatewayCommissionUSDT':!![]}}),database_1[_0x3f2aa8(0xe9)][_0x3f2aa8(0x131)]['findMany']({'where':{'gateway':{'not':_0x3f2aa8(0xf3)}},'take':0xa,'orderBy':{'createdAt':_0x3f2aa8(0x83)},'include':{'shop':{'select':{'name':!![],'username':!![]}}}}),database_1['default'][_0x3f2aa8(0x131)][_0x3f2aa8(0x11a)]({'where':{'createdAt':{'gte':_0x58f509},'gateway':{'not':_0x3f2aa8(0xf3)}},'select':{'amount':!![],'currency':!![],'status':!![],'amountUSDT':!![],'createdAt':!![]}})]);let _0x4d5313=0x0,_0x3eadef=0x0;for(const _0x5cb141 of _0x5264f2){const _0x18f963=await currencyService_1[_0x3f2aa8(0x12b)][_0x3f2aa8(0x153)](_0x5cb141[_0x3f2aa8(0x169)],_0x5cb141[_0x3f2aa8(0x13e)]);_0x4d5313+=_0x18f963;if(_0x5cb141['amountAfterGatewayCommissionUSDT']){const _0x527bfa=await currencyService_1[_0x3f2aa8(0x12b)][_0x3f2aa8(0x153)](_0x5cb141[_0x3f2aa8(0x169)],_0x5cb141[_0x3f2aa8(0x13e)]),_0xac37ea=_0x5cb141[_0x3f2aa8(0x185)],_0x344954=_0x527bfa-_0xac37ea;_0x3eadef+=_0x344954;}}const _0x22b2a7=_0x3edf0d>0x0?_0x4d5313/_0x3edf0d:0x0,_0x327d2e=this[_0x3f2aa8(0x149)](_0x5b18e3,_0x58f509,_0x4647dd),_0x539f49=await database_1['default']['payment']['count']({'where':{'createdAt':{'gte':_0x58f509},'gateway':{'not':_0x3f2aa8(0xf3)}}}),_0x10a7ce=_0x539f49>0x0?_0x3edf0d/_0x539f49*0x64:0x0;return{'totalShops':_0x47a976,'activeShops':_0x317947,'totalPayments':_0x3edf0d,'successfulPayments':_0x3edf0d,'totalAttempts':_0x539f49,'totalRevenue':Math[_0x3f2aa8(0x181)](_0x4d5313*0x64)/0x64,'trapayEarnings':Math['round'](_0x3eadef*0x64)/0x64,'averagePaymentAmount':Math[_0x3f2aa8(0x181)](_0x22b2a7*0x64)/0x64,'conversionRate':Math[_0x3f2aa8(0x181)](_0x10a7ce*0x64)/0x64,'dailyRevenue':_0x327d2e[_0x3f2aa8(0xe3)],'dailyPayments':_0x327d2e[_0x3f2aa8(0x14a)],'recentPayments':_0x530daa[_0x3f2aa8(0x106)](_0x2f4f5b=>({'id':_0x2f4f5b['id'],'amount':_0x2f4f5b['amount'],'currency':_0x2f4f5b[_0x3f2aa8(0x13e)],'status':_0x2f4f5b['status'],'gateway':_0x2f4f5b[_0x3f2aa8(0xac)],'shop':_0x2f4f5b['shop'],'createdAt':_0x2f4f5b['createdAt']}))};}async[a36_0x4a566d(0x14e)](_0x3e39c0){const _0x7f0111=a36_0x4a566d;console[_0x7f0111(0x16b)](_0x7f0111(0xd5),_0x3e39c0);let _0x2a7fe0,_0x502f86=new Date();if(_0x3e39c0['period']===_0x7f0111(0x87)&&_0x3e39c0[_0x7f0111(0xd0)]&&_0x3e39c0[_0x7f0111(0x14d)])_0x2a7fe0=new Date(_0x3e39c0[_0x7f0111(0xd0)]),_0x502f86=new Date(_0x3e39c0[_0x7f0111(0x14d)]),_0x2a7fe0['setHours'](0x0,0x0,0x0,0x0),_0x502f86['setHours'](0x17,0x3b,0x3b,0x3e7);else{const _0x10e1bb=new Date();switch(_0x3e39c0[_0x7f0111(0xe5)]){case'week':_0x2a7fe0=new Date(_0x10e1bb[_0x7f0111(0xfe)]()-0x7*0x18*0x3c*0x3c*0x3e8);break;case'month':_0x2a7fe0=new Date(_0x10e1bb['getTime']()-0x1e*0x18*0x3c*0x3c*0x3e8);break;case _0x7f0111(0x1ab):_0x2a7fe0=new Date(_0x10e1bb[_0x7f0111(0xfe)]()-0x16d*0x18*0x3c*0x3c*0x3e8);break;case _0x7f0111(0xde):default:_0x2a7fe0=new Date(_0x7f0111(0x12a));break;}_0x2a7fe0[_0x7f0111(0x12e)](0x0,0x0,0x0,0x0),_0x502f86[_0x7f0111(0x12e)](0x17,0x3b,0x3b,0x3e7);}console['log']('📅\x20Period:\x20'+_0x2a7fe0[_0x7f0111(0xd4)]()+_0x7f0111(0x10e)+_0x502f86[_0x7f0111(0xd4)]());const _0x5de53f={'status':_0x7f0111(0x193),'gateway':{'not':_0x7f0111(0xf3)},'paidAt':{'gte':_0x2a7fe0,'lte':_0x502f86}};_0x3e39c0[_0x7f0111(0x171)]&&(_0x5de53f['shopId']=_0x3e39c0[_0x7f0111(0x171)]);const _0x582454=await database_1[_0x7f0111(0xe9)][_0x7f0111(0x131)][_0x7f0111(0x11a)]({'where':_0x5de53f,'include':{'shop':{'select':{'id':!![],'name':!![],'username':!![],'gatewaySettings':!![]}}}});console['log'](_0x7f0111(0x17c)+_0x582454[_0x7f0111(0x9e)]+_0x7f0111(0xd2));const _0x3743a0={'gateway':{'not':_0x7f0111(0xf3)},'createdAt':{'gte':_0x2a7fe0,'lte':_0x502f86}};_0x3e39c0[_0x7f0111(0x171)]&&(_0x3743a0[_0x7f0111(0x171)]=_0x3e39c0['shopId']);const _0x3cd440=await database_1[_0x7f0111(0xe9)][_0x7f0111(0x131)][_0x7f0111(0xda)]({'where':_0x3743a0});console[_0x7f0111(0x16b)](_0x7f0111(0x96)+_0x3cd440+_0x7f0111(0x12d)+_0x582454['length']);let _0x5f5731=0x0,_0x22515d=0x0,_0x533265=0x0;const _0x3e8dd={},_0x4a6d3b={},_0x5bdc00={};for(const _0x55a360 of _0x582454){try{const _0x539f2c=await currencyService_1['currencyService'][_0x7f0111(0x153)](_0x55a360['amount'],_0x55a360[_0x7f0111(0x13e)]);let _0x46a403={};if(_0x55a360[_0x7f0111(0xb1)][_0x7f0111(0xd1)])try{_0x46a403=JSON[_0x7f0111(0x167)](_0x55a360[_0x7f0111(0xb1)][_0x7f0111(0xd1)]);}catch(_0x32a6a0){console[_0x7f0111(0x82)](_0x7f0111(0x11e)+_0x55a360[_0x7f0111(0x171)]+':',_0x32a6a0);}let _0x2566e7={},_0x581b50=0x2d;for(const [_0x501ee9,_0x13e00c]of Object['entries'](_0x46a403)){if(_0x501ee9['toLowerCase']()===_0x55a360[_0x7f0111(0xac)][_0x7f0111(0x16a)]()){_0x2566e7=_0x13e00c,_0x581b50=_0x13e00c[_0x7f0111(0x10a)]||0xa;break;}}let _0x1bf91f,_0x4f39ff;_0x55a360[_0x7f0111(0x185)]!==null&&_0x55a360[_0x7f0111(0x185)]!==undefined?(_0x1bf91f=_0x55a360[_0x7f0111(0x185)],_0x4f39ff=_0x539f2c-_0x1bf91f,console[_0x7f0111(0x16b)](_0x7f0111(0x19b)+_0x1bf91f[_0x7f0111(0x15a)](0x6)+_0x7f0111(0xdc)+_0x55a360['id'])):(_0x4f39ff=_0x539f2c*(_0x581b50/0x64),_0x1bf91f=_0x539f2c-_0x4f39ff,console[_0x7f0111(0x16b)](_0x7f0111(0x18a)+_0x55a360['id']+':\x20'+_0x581b50+_0x7f0111(0x1ac)+_0x539f2c['toFixed'](0x6)+_0x7f0111(0x135)));_0x5f5731+=_0x539f2c,_0x22515d+=_0x1bf91f,_0x533265+=_0x4f39ff;!_0x3e8dd[_0x55a360['gateway']]&&(_0x3e8dd[_0x55a360['gateway']]={'gateway':_0x55a360[_0x7f0111(0xac)],'gatewayDisplayName':this['getGatewayDisplayName'](_0x55a360[_0x7f0111(0xac)]),'paymentsCount':0x0,'turnoverUSDT':0x0,'commissionUSDT':0x0,'merchantEarningsUSDT':0x0,'totalCommissionRate':0x0});_0x3e8dd[_0x55a360[_0x7f0111(0xac)]][_0x7f0111(0xe7)]++,_0x3e8dd[_0x55a360['gateway']][_0x7f0111(0xf1)]+=_0x539f2c,_0x3e8dd[_0x55a360[_0x7f0111(0xac)]]['commissionUSDT']+=_0x4f39ff,_0x3e8dd[_0x55a360[_0x7f0111(0xac)]][_0x7f0111(0xea)]+=_0x1bf91f,_0x3e8dd[_0x55a360[_0x7f0111(0xac)]][_0x7f0111(0xfc)]+=_0x581b50;!_0x3e39c0[_0x7f0111(0x171)]&&(!_0x4a6d3b[_0x55a360['shopId']]&&(_0x4a6d3b[_0x55a360['shopId']]={'shopId':_0x55a360[_0x7f0111(0x171)],'shopName':_0x55a360['shop']['name'],'shopUsername':_0x55a360['shop']['username'],'paymentsCount':0x0,'turnoverUSDT':0x0,'commissionUSDT':0x0,'merchantEarningsUSDT':0x0,'paidOutUSDT':0x0,'averageCheckUSDT':0x0}),_0x4a6d3b[_0x55a360[_0x7f0111(0x171)]]['paymentsCount']++,_0x4a6d3b[_0x55a360[_0x7f0111(0x171)]]['turnoverUSDT']+=_0x539f2c,_0x4a6d3b[_0x55a360[_0x7f0111(0x171)]][_0x7f0111(0x146)]+=_0x4f39ff,_0x4a6d3b[_0x55a360[_0x7f0111(0x171)]]['merchantEarningsUSDT']+=_0x1bf91f);const _0x2813d8=_0x55a360[_0x7f0111(0x17e)][_0x7f0111(0xd4)]()[_0x7f0111(0x17d)]('T')[0x0];!_0x5bdc00[_0x2813d8]&&(_0x5bdc00[_0x2813d8]={'date':_0x2813d8,'turnover':0x0,'merchantEarnings':0x0,'gatewayEarnings':0x0,'paymentsCount':0x0}),_0x5bdc00[_0x2813d8][_0x7f0111(0xb7)]+=_0x539f2c,_0x5bdc00[_0x2813d8][_0x7f0111(0x168)]+=_0x1bf91f,_0x5bdc00[_0x2813d8]['gatewayEarnings']+=_0x4f39ff,_0x5bdc00[_0x2813d8][_0x7f0111(0xe7)]++;}catch(_0x2394b5){console['error'](_0x7f0111(0x160)+_0x55a360['id']+':',_0x2394b5);}}Object[_0x7f0111(0x155)](_0x3e8dd)[_0x7f0111(0x147)](_0x15e159=>{const _0x583cdb=_0x7f0111;_0x15e159[_0x583cdb(0x1aa)]=_0x15e159[_0x583cdb(0xe7)]>0x0?_0x15e159['totalCommissionRate']/_0x15e159[_0x583cdb(0xe7)]:0x0,delete _0x15e159[_0x583cdb(0xfc)];}),Object[_0x7f0111(0x155)](_0x4a6d3b)[_0x7f0111(0x147)](_0x3e5518=>{const _0x444cc7=_0x7f0111;_0x3e5518[_0x444cc7(0x13b)]=_0x3e5518[_0x444cc7(0xe7)]>0x0?_0x3e5518[_0x444cc7(0xf1)]/_0x3e5518[_0x444cc7(0xe7)]:0x0;});let _0x163d64=0x0,_0x36be01=0x0;if(_0x3e39c0['shopId']){const _0x5bd12d=await database_1['default'][_0x7f0111(0x10b)][_0x7f0111(0x11a)]({'where':{'shopId':_0x3e39c0['shopId'],'status':_0x7f0111(0x119),'createdAt':{'gte':_0x2a7fe0,'lte':_0x502f86}},'select':{'amount':!![]}});_0x163d64=_0x5bd12d['reduce']((_0x18e9b3,_0xbfc440)=>_0x18e9b3+_0xbfc440[_0x7f0111(0x169)],0x0);const _0xc2427a=await database_1[_0x7f0111(0xe9)][_0x7f0111(0x10b)][_0x7f0111(0x11a)]({'where':{'shopId':_0x3e39c0[_0x7f0111(0x171)],'status':'PENDING','createdAt':{'gte':_0x2a7fe0,'lte':_0x502f86}},'select':{'amount':!![]}});_0x36be01=_0xc2427a['reduce']((_0x185a45,_0x72d884)=>_0x185a45+_0x72d884[_0x7f0111(0x169)],0x0);}const _0x405b41=_0x3cd440,_0xdeb8c8=_0x582454['length'],_0x11ef09=_0xdeb8c8>0x0?_0x5f5731/_0xdeb8c8:0x0,_0x20b827=_0x405b41>0x0?Math[_0x7f0111(0x181)](_0xdeb8c8/_0x405b41*0x2710)/0x64:0x0,_0x3409cb=Math['ceil']((_0x502f86[_0x7f0111(0xfe)]()-_0x2a7fe0[_0x7f0111(0xfe)]())/(0x3e8*0x3c*0x3c*0x18)),_0x571bcd={'totalTurnover':Math['round'](_0x5f5731*0x64)/0x64,'merchantEarnings':Math[_0x7f0111(0x181)](_0x22515d*0x64)/0x64,'gatewayEarnings':Math['round'](_0x533265*0x64)/0x64,'totalPaidOut':Math[_0x7f0111(0x181)](_0x163d64*0x64)/0x64,'pendingPayout':Math['round'](_0x36be01*0x64)/0x64,'averageCheck':Math[_0x7f0111(0x181)](_0x11ef09*0x64)/0x64,'totalPayments':_0x405b41,'successfulPayments':_0xdeb8c8,'conversionRate':_0x20b827,'gatewayBreakdown':Object[_0x7f0111(0x155)](_0x3e8dd)[_0x7f0111(0x106)](_0x4e271b=>({..._0x4e271b,'turnoverUSDT':Math[_0x7f0111(0x181)](_0x4e271b[_0x7f0111(0xf1)]*0x64)/0x64,'commissionUSDT':Math[_0x7f0111(0x181)](_0x4e271b[_0x7f0111(0x146)]*0x64)/0x64,'merchantEarningsUSDT':Math[_0x7f0111(0x181)](_0x4e271b['merchantEarningsUSDT']*0x64)/0x64,'averageCommissionRate':Math['round'](_0x4e271b[_0x7f0111(0x1aa)]*0x64)/0x64})),'merchantBreakdown':_0x3e39c0[_0x7f0111(0x171)]?undefined:Object[_0x7f0111(0x155)](_0x4a6d3b)[_0x7f0111(0x106)](_0x5a774c=>({..._0x5a774c,'turnoverUSDT':Math[_0x7f0111(0x181)](_0x5a774c[_0x7f0111(0xf1)]*0x64)/0x64,'commissionUSDT':Math[_0x7f0111(0x181)](_0x5a774c[_0x7f0111(0x146)]*0x64)/0x64,'merchantEarningsUSDT':Math[_0x7f0111(0x181)](_0x5a774c[_0x7f0111(0xea)]*0x64)/0x64,'paidOutUSDT':Math[_0x7f0111(0x181)](_0x5a774c['paidOutUSDT']*0x64)/0x64,'averageCheckUSDT':Math['round'](_0x5a774c[_0x7f0111(0x13b)]*0x64)/0x64})),'dailyData':Object[_0x7f0111(0x155)](_0x5bdc00)[_0x7f0111(0x106)](_0x3fb11a=>({..._0x3fb11a,'turnover':Math[_0x7f0111(0x181)](_0x3fb11a[_0x7f0111(0xb7)]*0x64)/0x64,'merchantEarnings':Math[_0x7f0111(0x181)](_0x3fb11a[_0x7f0111(0x168)]*0x64)/0x64,'gatewayEarnings':Math[_0x7f0111(0x181)](_0x3fb11a[_0x7f0111(0x11b)]*0x64)/0x64}))['sort']((_0x11bee9,_0x15a4e2)=>_0x11bee9[_0x7f0111(0x8e)]['localeCompare'](_0x15a4e2[_0x7f0111(0x8e)])),'periodInfo':{'from':_0x2a7fe0,'to':_0x502f86,'periodType':_0x3e39c0['period']||_0x7f0111(0x87),'daysCount':_0x3409cb}};return console[_0x7f0111(0x16b)](_0x7f0111(0xb6)),console[_0x7f0111(0x16b)](_0x7f0111(0xf7)+_0x571bcd['totalTurnover']+_0x7f0111(0x135)),console['log'](_0x7f0111(0x105)+_0x571bcd[_0x7f0111(0x168)]+_0x7f0111(0x135)),console['log'](_0x7f0111(0x17a)+_0x571bcd[_0x7f0111(0x11b)]+_0x7f0111(0x135)),console[_0x7f0111(0x16b)](_0x7f0111(0x195)+_0x571bcd[_0x7f0111(0x161)]+_0x7f0111(0x135)),console[_0x7f0111(0x16b)](_0x7f0111(0xee)+_0x571bcd[_0x7f0111(0xb0)]+'\x20USDT'),console[_0x7f0111(0x16b)](_0x7f0111(0x126)+_0x571bcd[_0x7f0111(0x127)]),_0x571bcd;}async['getMerchantsSelection'](){const _0x2bfba7=a36_0x4a566d;console[_0x2bfba7(0x16b)](_0x2bfba7(0x125));const _0x5df807=await database_1[_0x2bfba7(0xe9)][_0x2bfba7(0xb1)][_0x2bfba7(0x11a)]({'where':{'status':_0x2bfba7(0x11d)},'select':{'id':!![],'username':!![],'name':!![]},'orderBy':{'name':_0x2bfba7(0xc1)}});return console[_0x2bfba7(0x16b)](_0x2bfba7(0x177)+_0x5df807[_0x2bfba7(0x9e)]+_0x2bfba7(0xfa)),_0x5df807[_0x2bfba7(0x106)](_0x52191c=>({'id':_0x52191c['id'],'username':_0x52191c['username'],'name':_0x52191c[_0x2bfba7(0x19a)]}));}[a36_0x4a566d(0xf4)](_0x18dcb0){const _0x24cbed=a36_0x4a566d,_0x177eac={'test_gateway':'Test\x20Gateway','plisio':_0x24cbed(0x92),'rapyd':_0x24cbed(0x7a),'noda':_0x24cbed(0xae),'cointopay':_0x24cbed(0x1a8),'cointopay2':_0x24cbed(0x110),'klyme_eu':_0x24cbed(0x186),'klyme_gb':_0x24cbed(0xa2),'klyme_de':_0x24cbed(0xa1),'mastercard':_0x24cbed(0x1a7)};return _0x177eac[_0x18dcb0]||_0x18dcb0;}[a36_0x4a566d(0xc0)](_0x38601e){const _0x194332=a36_0x4a566d,_0x302ca4={'Test\x20Gateway':_0x194332(0xf3),'Plisio':_0x194332(0x1a5),'Rapyd':_0x194332(0x121),'Noda':_0x194332(0xe2),'CoinToPay':'cointopay','CoinToPay2':'cointopay2','KLYME\x20EU':'klyme_eu','KLYME\x20GB':_0x194332(0x9d),'KLYME\x20DE':_0x194332(0x10d),'MasterCard':_0x194332(0xa0)};return _0x302ca4[_0x38601e]||_0x38601e[_0x194332(0x16a)]();}async[a36_0x4a566d(0x9b)](_0x3729a9){const _0x22c32f=a36_0x4a566d,{page:_0x48ea20,limit:_0x2e2f47,minAmount:_0x5e9a97,search:_0x4a4a05}=_0x3729a9,_0x446878=(_0x48ea20-0x1)*_0x2e2f47;console[_0x22c32f(0x16b)](_0x22c32f(0x191),_0x3729a9);const _0x25005c={'balance':{'gt':0x0},'status':'ACTIVE'};_0x5e9a97&&(_0x25005c[_0x22c32f(0x14c)][_0x22c32f(0xbe)]=_0x5e9a97);_0x4a4a05&&(_0x25005c[_0x22c32f(0x19a)]={'contains':_0x4a4a05,'mode':_0x22c32f(0xa3)});const [_0x18282b,_0x31606c]=await Promise[_0x22c32f(0xde)]([database_1[_0x22c32f(0xe9)][_0x22c32f(0xb1)][_0x22c32f(0x11a)]({'where':_0x25005c,'skip':_0x446878,'take':_0x2e2f47,'orderBy':{'balance':_0x22c32f(0x83)},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'balance':!![],'totalPaidOut':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'gatewaySettings':!![],'createdAt':!![]}}),database_1[_0x22c32f(0xe9)][_0x22c32f(0xb1)][_0x22c32f(0xda)]({'where':_0x25005c})]);console[_0x22c32f(0x16b)](_0x22c32f(0x17c)+_0x18282b[_0x22c32f(0x9e)]+'\x20merchants\x20with\x20positive\x20balance');const _0x44ec88=await Promise['all'](_0x18282b['map'](async _0x57640f=>{const _0x3697b4=_0x22c32f,[_0x30613f,_0x1efc80,_0x589b6b]=await Promise[_0x3697b4(0xde)]([database_1[_0x3697b4(0xe9)][_0x3697b4(0x131)][_0x3697b4(0xda)]({'where':{'shopId':_0x57640f['id'],'status':_0x3697b4(0x193),'gateway':{'not':_0x3697b4(0xf3)}}}),database_1[_0x3697b4(0xe9)]['payment'][_0x3697b4(0x10f)]({'where':{'shopId':_0x57640f['id'],'status':_0x3697b4(0x193),'gateway':{'not':'test_gateway'}},'orderBy':{'paidAt':_0x3697b4(0xc1)},'select':{'paidAt':!![]}}),database_1['default'][_0x3697b4(0x131)][_0x3697b4(0x89)]({'by':['gateway'],'where':{'shopId':_0x57640f['id'],'status':'PAID','gateway':{'not':_0x3697b4(0xf3)}},'_count':{'id':!![]},'_sum':{'amountUSDT':!![]}})]),_0x3268bf=new Date(),_0x5d5478=new Date(_0x3268bf['getFullYear'](),_0x3268bf['getMonth'](),0x1),_0x2a96db=new Date(_0x3268bf['getFullYear'](),_0x3268bf[_0x3697b4(0x159)]()+0x1,0x0,0x17,0x3b,0x3b,0x3e7),[_0x2507be,_0x2a539f]=await Promise[_0x3697b4(0xde)]([database_1['default']['payout'][_0x3697b4(0x182)]({'_sum':{'amount':!![]},'where':{'shopId':_0x57640f['id'],'status':_0x3697b4(0x119)}}),database_1['default']['payout'][_0x3697b4(0x182)]({'_sum':{'amount':!![]},'where':{'shopId':_0x57640f['id'],'status':_0x3697b4(0x119),'createdAt':{'gte':_0x5d5478,'lte':_0x2a96db}}})]),_0x3f7a48=_0x2507be[_0x3697b4(0x184)][_0x3697b4(0x169)]||0x0,_0x5d5eb3=_0x2a539f[_0x3697b4(0x184)]['amount']||0x0,_0x51284c=await Promise[_0x3697b4(0xde)](_0x589b6b[_0x3697b4(0x106)](async _0x2752e5=>{const _0x49b5b6=_0x3697b4;let _0x443759=0x2d;if(_0x57640f[_0x49b5b6(0xd1)])try{const _0x114470=JSON[_0x49b5b6(0x167)](_0x57640f[_0x49b5b6(0xd1)]);for(const [_0x3f6262,_0x205efb]of Object[_0x49b5b6(0x194)](_0x114470)){if(_0x3f6262[_0x49b5b6(0x16a)]()===_0x2752e5[_0x49b5b6(0xac)][_0x49b5b6(0x16a)]()){_0x443759=_0x205efb[_0x49b5b6(0x10a)]||0xa,console['log'](_0x49b5b6(0x1a2)+_0x2752e5[_0x49b5b6(0xac)]+'\x20for\x20shop\x20'+_0x57640f['id']+':\x20commission\x20=\x20'+_0x443759+'%');break;}}}catch(_0x3d5b69){console['error'](_0x49b5b6(0x11e)+_0x57640f['id']+':',_0x3d5b69);}const _0xb72cc3=_0x2752e5[_0x49b5b6(0x184)]?.[_0x49b5b6(0xf0)]||0x0,_0x8f272=_0xb72cc3*(0x1-_0x443759/0x64);return{'gateway':_0x2752e5['gateway'],'count':_0x2752e5[_0x49b5b6(0xcb)]?.['id']||0x0,'amountUSDT':Math[_0x49b5b6(0x181)](_0xb72cc3*0x64)/0x64,'amountAfterCommissionUSDT':Math[_0x49b5b6(0x181)](_0x8f272*0x64)/0x64,'commission':_0x443759};})),_0x32c9d4=_0x51284c['reduce']((_0x31e090,_0x5e3443)=>_0x31e090+_0x5e3443[_0x3697b4(0xf0)],0x0),_0x3fa774=_0x57640f[_0x3697b4(0x14c)];return console[_0x3697b4(0x16b)]('💰\x20[PAYOUT]\x20Merchant\x20'+_0x57640f[_0x3697b4(0x196)]+':'),console[_0x3697b4(0x16b)](_0x3697b4(0xd9)+_0x32c9d4[_0x3697b4(0x15a)](0x2)+'\x20USDT\x20(gross\x20revenue)'),console['log'](_0x3697b4(0xf9)+_0x51284c[_0x3697b4(0x98)]((_0x117f4a,_0x1cd419)=>_0x117f4a+_0x1cd419[_0x3697b4(0xb4)],0x0)[_0x3697b4(0x15a)](0x2)+_0x3697b4(0x1a9)),console['log']('\x20\x20\x20✅\x20Actual\x20available\x20balance:\x20'+_0x3fa774[_0x3697b4(0x15a)](0x2)+_0x3697b4(0x132)),{'id':_0x57640f['id'],'fullName':_0x57640f[_0x3697b4(0x19a)],'username':_0x57640f[_0x3697b4(0x196)],'telegramId':_0x57640f[_0x3697b4(0x1a6)],'merchantUrl':_0x57640f[_0x3697b4(0x116)],'wallets':{'usdtPolygonWallet':_0x57640f['usdtPolygonWallet'],'usdtTrcWallet':_0x57640f['usdtTrcWallet'],'usdtErcWallet':_0x57640f[_0x3697b4(0xdd)],'usdcPolygonWallet':_0x57640f['usdcPolygonWallet']},'totalAmountUSDT':Math['round'](_0x32c9d4*0x64)/0x64,'totalAmountAfterCommissionUSDT':Math['round'](_0x3fa774*0x64)/0x64,'totalPayout':Math[_0x3697b4(0x181)](_0x3f7a48*0x64)/0x64,'thisMonth':Math[_0x3697b4(0x181)](_0x5d5eb3*0x64)/0x64,'paymentsCount':_0x30613f,'oldestPaymentDate':_0x1efc80?.['paidAt']||_0x57640f['createdAt'],'gatewayBreakdown':_0x51284c};})),_0xcb2af6=_0x44ec88[_0x22c32f(0x98)]((_0x163640,_0x50e199)=>_0x163640+_0x50e199[_0x22c32f(0x7c)],0x0),_0x5a8812=_0x44ec88[_0x22c32f(0x98)]((_0x50c33f,_0x3eef5d)=>_0x50c33f+_0x3eef5d['totalAmountAfterCommissionUSDT'],0x0),_0x2847fd=_0x44ec88['reduce']((_0x3eb9d5,_0x1d1890)=>_0x3eb9d5+_0x1d1890['totalPayout'],0x0),_0x1c8ce2=_0x44ec88['reduce']((_0x46ca83,_0x165f70)=>_0x46ca83+_0x165f70['thisMonth'],0x0);return console[_0x22c32f(0x16b)]('📊\x20Merchants\x20awaiting\x20payout:\x20'+_0x31606c+_0x22c32f(0x19d)),console[_0x22c32f(0x16b)](_0x22c32f(0x90)+Math[_0x22c32f(0x181)](_0xcb2af6*0x64)/0x64+_0x22c32f(0x140)),console[_0x22c32f(0x16b)](_0x22c32f(0x179)+Math[_0x22c32f(0x181)](_0x5a8812*0x64)/0x64+_0x22c32f(0x170)),console[_0x22c32f(0x16b)](_0x22c32f(0x18c)+Math[_0x22c32f(0x181)](_0x2847fd*0x64)/0x64+_0x22c32f(0x135)),console[_0x22c32f(0x16b)](_0x22c32f(0x162)+Math[_0x22c32f(0x181)](_0x1c8ce2*0x64)/0x64+_0x22c32f(0x135)),{'merchants':_0x44ec88,'pagination':{'page':_0x48ea20,'limit':_0x2e2f47,'total':_0x31606c,'totalPages':Math[_0x22c32f(0xb3)](_0x31606c/_0x2e2f47)},'summary':{'totalMerchants':_0x31606c,'totalAmountUSDT':Math[_0x22c32f(0x181)](_0xcb2af6*0x64)/0x64,'totalAmountAfterCommissionUSDT':Math['round'](_0x5a8812*0x64)/0x64,'totalPayout':Math[_0x22c32f(0x181)](_0x2847fd*0x64)/0x64,'thisMonth':Math[_0x22c32f(0x181)](_0x1c8ce2*0x64)/0x64}};}async[a36_0x4a566d(0xf6)](_0xa4b24a){const _0x23b815=a36_0x4a566d,{shopId:_0x379a97,amount:_0x4a17dc,network:_0x6d5951,wallet:_0x2054fb,notes:_0x41716f,txid:_0x126f31,periodFrom:_0x557b66,periodTo:_0x4b9e3a}=_0xa4b24a,_0xd54850=await database_1[_0x23b815(0xe9)][_0x23b815(0x163)](async _0x2117f1=>{const _0x5d19a0=_0x23b815,_0x2d8654=await _0x2117f1[_0x5d19a0(0xb1)]['findUnique']({'where':{'id':_0x379a97},'select':{'id':!![],'name':!![],'username':!![],'balance':!![],'totalPaidOut':!![]}});if(!_0x2d8654)throw new Error(_0x5d19a0(0x19e));console['log'](_0x5d19a0(0x148)+_0x2d8654['username']+':'),console['log'](_0x5d19a0(0xb2)+_0x2d8654[_0x5d19a0(0x14c)][_0x5d19a0(0x15a)](0x6)+'\x20USDT'),console[_0x5d19a0(0x16b)](_0x5d19a0(0x15e)+_0x4a17dc[_0x5d19a0(0x15a)](0x6)+'\x20USDT'),console[_0x5d19a0(0x16b)](_0x5d19a0(0x11f)+_0x2d8654['totalPaidOut'][_0x5d19a0(0x15a)](0x6)+_0x5d19a0(0x135));if(_0x126f31)console[_0x5d19a0(0x16b)]('\x20\x20\x20Transaction\x20hash:\x20'+_0x126f31);if(_0x2d8654[_0x5d19a0(0x14c)]<_0x4a17dc)throw new Error(_0x5d19a0(0x102)+_0x2d8654[_0x5d19a0(0x14c)][_0x5d19a0(0x15a)](0x6)+_0x5d19a0(0xb8)+_0x4a17dc[_0x5d19a0(0x15a)](0x6)+_0x5d19a0(0x135));let _0x441c96=_0x2054fb;if(!_0x441c96){const _0x35755c=await _0x2117f1[_0x5d19a0(0xb1)][_0x5d19a0(0x101)]({'where':{'id':_0x379a97},'select':{'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![]}});if(_0x35755c)switch(_0x6d5951){case _0x5d19a0(0xe0):_0x441c96=_0x35755c[_0x5d19a0(0x122)]||undefined;break;case'trc20':_0x441c96=_0x35755c[_0x5d19a0(0xfd)]||undefined;break;case'erc20':_0x441c96=_0x35755c[_0x5d19a0(0xdd)]||undefined;break;case _0x5d19a0(0x136):_0x441c96=_0x35755c[_0x5d19a0(0xad)]||undefined;break;}}console[_0x5d19a0(0x16b)](_0x5d19a0(0x187)+_0x6d5951+':\x20'+(_0x441c96||_0x5d19a0(0x197)));const _0x56de96=await _0x2117f1['payout'][_0x5d19a0(0xe1)]({'data':{'shopId':_0x379a97,'amount':_0x4a17dc,'network':_0x6d5951,'status':_0x5d19a0(0x119),'txid':_0x126f31,'notes':_0x41716f,'periodFrom':_0x557b66?new Date(_0x557b66):null,'periodTo':_0x4b9e3a?new Date(_0x4b9e3a):null,'createdAt':new Date(),'paidAt':new Date()}}),_0xa057d5=_0x2d8654['balance']-_0x4a17dc,_0x5d6a28=_0x2d8654[_0x5d19a0(0x161)]+_0x4a17dc;return await _0x2117f1[_0x5d19a0(0xb1)]['update']({'where':{'id':_0x379a97},'data':{'balance':_0xa057d5,'totalPaidOut':_0x5d6a28}}),console[_0x5d19a0(0x16b)](_0x5d19a0(0xcf)+_0x2d8654[_0x5d19a0(0x196)]+_0x5d19a0(0xcc)),console[_0x5d19a0(0x16b)]('\x20\x20\x20Balance:\x20'+_0x2d8654[_0x5d19a0(0x14c)][_0x5d19a0(0x15a)](0x6)+'\x20->\x20'+_0xa057d5[_0x5d19a0(0x15a)](0x6)+_0x5d19a0(0x13c)+_0x4a17dc[_0x5d19a0(0x15a)](0x6)+')'),console[_0x5d19a0(0x16b)](_0x5d19a0(0x84)+_0x2d8654[_0x5d19a0(0x161)][_0x5d19a0(0x15a)](0x6)+'\x20->\x20'+_0x5d6a28[_0x5d19a0(0x15a)](0x6)+'\x20USDT\x20(+'+_0x4a17dc['toFixed'](0x6)+')'),{'payout':_0x56de96,'shop':_0x2d8654};});return console[_0x23b815(0x16b)]('✅\x20Payout\x20created:\x20'+_0xd54850[_0x23b815(0x10b)]['id']+_0x23b815(0x178)+_0xd54850[_0x23b815(0xb1)]['username']+'\x20('+_0x4a17dc+_0x23b815(0x1a1)),{'id':_0xd54850[_0x23b815(0x10b)]['id'],'shopId':_0xd54850['payout'][_0x23b815(0x171)],'shopName':_0xd54850[_0x23b815(0xb1)][_0x23b815(0x19a)],'shopUsername':_0xd54850[_0x23b815(0xb1)][_0x23b815(0x196)],'amount':_0xd54850['payout'][_0x23b815(0x169)],'network':_0xd54850[_0x23b815(0x10b)]['network'],'status':_0xd54850['payout']['status'],'txid':_0xd54850[_0x23b815(0x10b)][_0x23b815(0x95)],'notes':_0xd54850[_0x23b815(0x10b)][_0x23b815(0x123)],'periodFrom':_0xd54850['payout'][_0x23b815(0xe6)],'periodTo':_0xd54850[_0x23b815(0x10b)][_0x23b815(0x114)],'createdAt':_0xd54850['payout']['createdAt'],'paidAt':_0xd54850[_0x23b815(0x10b)][_0x23b815(0x17e)]};}async['getAllPayouts'](_0x11c754){const _0x2319bd=a36_0x4a566d,{page:_0xc338e9,limit:_0x305449,shopId:_0x572a80,network:_0x394324,dateFrom:_0x1a3eed,dateTo:_0x131763,search:_0x288a33}=_0x11c754,_0x2a47df=(_0xc338e9-0x1)*_0x305449,_0x2a7a46={};_0x572a80&&(_0x2a7a46[_0x2319bd(0x171)]=_0x572a80);_0x394324&&(_0x2a7a46[_0x2319bd(0xf5)]=_0x394324);(_0x1a3eed||_0x131763)&&(_0x2a7a46[_0x2319bd(0x81)]={},_0x1a3eed&&(_0x2a7a46[_0x2319bd(0x81)][_0x2319bd(0xbe)]=new Date(_0x1a3eed)),_0x131763&&(_0x2a7a46['createdAt'][_0x2319bd(0x9f)]=new Date(_0x131763)));_0x288a33&&(_0x2a7a46['OR']=[{'shop':{'name':{'contains':_0x288a33,'mode':_0x2319bd(0xa3)}}},{'shop':{'username':{'contains':_0x288a33,'mode':_0x2319bd(0xa3)}}},{'notes':{'contains':_0x288a33,'mode':_0x2319bd(0xa3)}}]);const [_0x1139ef,_0x8f9bfc]=await Promise[_0x2319bd(0xde)]([database_1[_0x2319bd(0xe9)]['payout'][_0x2319bd(0x11a)]({'where':_0x2a7a46,'skip':_0x2a47df,'take':_0x305449,'orderBy':{'createdAt':_0x2319bd(0x83)},'select':{'id':!![],'shopId':!![],'amount':!![],'network':!![],'status':!![],'txid':!![],'notes':!![],'periodFrom':!![],'periodTo':!![],'createdAt':!![],'paidAt':!![],'shop':{'select':{'name':!![],'username':!![]}}}}),database_1[_0x2319bd(0xe9)]['payout'][_0x2319bd(0xda)]({'where':_0x2a7a46})]);return{'payouts':_0x1139ef['map'](_0x4c859e=>({'id':_0x4c859e['id'],'shopId':_0x4c859e['shopId'],'shopName':_0x4c859e['shop'][_0x2319bd(0x19a)],'shopUsername':_0x4c859e[_0x2319bd(0xb1)][_0x2319bd(0x196)],'amount':_0x4c859e['amount'],'network':_0x4c859e['network'],'status':_0x4c859e[_0x2319bd(0x1a3)],'txid':_0x4c859e['txid'],'notes':_0x4c859e['notes'],'periodFrom':_0x4c859e[_0x2319bd(0xe6)],'periodTo':_0x4c859e['periodTo'],'createdAt':_0x4c859e[_0x2319bd(0x81)],'paidAt':_0x4c859e['paidAt']})),'pagination':{'page':_0xc338e9,'limit':_0x305449,'total':_0x8f9bfc,'totalPages':Math[_0x2319bd(0xb3)](_0x8f9bfc/_0x305449)}};}async[a36_0x4a566d(0x8b)](_0x25aa26){const _0x45ebe9=a36_0x4a566d,_0x3f3608=await database_1['default'][_0x45ebe9(0x10b)][_0x45ebe9(0x101)]({'where':{'id':_0x25aa26},'include':{'shop':{'select':{'name':!![],'username':!![]}}}});if(!_0x3f3608)return null;return{'id':_0x3f3608['id'],'shopId':_0x3f3608['shopId'],'shopName':_0x3f3608[_0x45ebe9(0xb1)][_0x45ebe9(0x19a)],'shopUsername':_0x3f3608[_0x45ebe9(0xb1)][_0x45ebe9(0x196)],'amount':_0x3f3608[_0x45ebe9(0x169)],'network':_0x3f3608['network'],'status':_0x3f3608[_0x45ebe9(0x1a3)],'txid':_0x3f3608[_0x45ebe9(0x95)],'notes':_0x3f3608[_0x45ebe9(0x123)],'periodFrom':_0x3f3608[_0x45ebe9(0xe6)],'periodTo':_0x3f3608[_0x45ebe9(0x114)],'createdAt':_0x3f3608[_0x45ebe9(0x81)],'paidAt':_0x3f3608[_0x45ebe9(0x17e)]};}async['deletePayout'](_0x2bb183){const _0x437965=a36_0x4a566d;await database_1[_0x437965(0xe9)]['payout'][_0x437965(0x91)]({'where':{'id':_0x2bb183}});}async['getAllPayments'](_0x401b3e){const _0x530b1d=a36_0x4a566d,{page:_0x2d899d,limit:_0x23a863,status:_0x5f4557,gateway:_0x52558f,shopId:_0x5be46d,dateFrom:_0x5bb1d8,dateTo:_0x5da62e,search:_0x3cbf11,currency:_0x73eb6b,sortBy:_0x1cb06a,sortOrder:_0x33aed9}=_0x401b3e,_0x49a47f=(_0x2d899d-0x1)*_0x23a863;console[_0x530b1d(0x16b)](_0x530b1d(0xb9),_0x401b3e);const _0x108d51=await database_1[_0x530b1d(0xe9)]['payment'][_0x530b1d(0x89)]({'by':[_0x530b1d(0xac)],'_count':{'gateway':!![]}});console['log'](_0x530b1d(0x112),_0x108d51['map'](_0x208ceb=>_0x208ceb[_0x530b1d(0xac)]+'\x20('+_0x208ceb[_0x530b1d(0xcb)]['gateway']+'\x20payments)'));if(_0x52558f){const _0x193146=_0x108d51[_0x530b1d(0xa9)](_0x5e490b=>_0x5e490b[_0x530b1d(0xac)][_0x530b1d(0x16a)]()===_0x52558f[_0x530b1d(0x16a)]());!_0x193146&&_0x52558f[_0x530b1d(0x16a)]()!=='test_gateway'&&console['log'](_0x530b1d(0x143)+_0x52558f+_0x530b1d(0x139)+_0x108d51[_0x530b1d(0x106)](_0x43a007=>_0x43a007[_0x530b1d(0xac)])[_0x530b1d(0xc6)](',\x20'));}const _0x3c3c7b={};_0x5f4557&&(_0x3c3c7b[_0x530b1d(0x1a3)]=_0x5f4557[_0x530b1d(0xab)]());if(!_0x52558f)_0x3c3c7b['gateway']={'not':_0x530b1d(0xf3)};else{if(_0x52558f&&(_0x52558f[_0x530b1d(0x16a)]()===_0x530b1d(0xf3)||_0x52558f==='0000'))_0x3c3c7b[_0x530b1d(0xac)]=_0x530b1d(0xf3);else{let _0x2487a7=_0x52558f;const _0x5bd387=(0x0,gateway_1[_0x530b1d(0x18d)])(_0x52558f);if(_0x5bd387)_0x2487a7=_0x5bd387,console[_0x530b1d(0x16b)](_0x530b1d(0xdf)+_0x52558f+_0x530b1d(0xd7)+_0x2487a7+'\x27');else{const _0x2e20ed=(0x0,gateway_1[_0x530b1d(0xb5)])(_0x52558f);if(_0x2e20ed){const _0x14e9f2=(0x0,gateway_1['getGatewayNameById'])(_0x2e20ed);_0x14e9f2&&(_0x2487a7=_0x14e9f2,console['log'](_0x530b1d(0x19c)+_0x52558f+_0x530b1d(0x12f)+_0x2e20ed+'\x27\x20->\x20name\x20\x27'+_0x2487a7+'\x27'));}else console[_0x530b1d(0x16b)](_0x530b1d(0xc9)+_0x52558f+_0x530b1d(0x124));}const _0x1e6b34=await database_1[_0x530b1d(0xe9)][_0x530b1d(0x131)][_0x530b1d(0xda)]({'where':{'gateway':_0x2487a7[_0x530b1d(0x16a)]()},'take':0x1});_0x1e6b34===0x0?(console['log']('⚠️\x20Gateway\x20\x27'+_0x2487a7+_0x530b1d(0xe8)+_0x52558f+'\x27)\x20not\x20found\x20in\x20database,\x20returning\x20empty\x20result'),_0x3c3c7b[_0x530b1d(0xac)]='NONEXISTENT_GATEWAY_FILTER'):(_0x3c3c7b['gateway']=_0x2487a7[_0x530b1d(0x16a)](),console['log']('✅\x20Using\x20gateway\x20filter:\x20\x27'+_0x2487a7+_0x530b1d(0xe8)+_0x52558f+'\x27)'));}}console[_0x530b1d(0x16b)](_0x530b1d(0x142),_0x3c3c7b[_0x530b1d(0xac)]);_0x5be46d&&(_0x3c3c7b['shopId']=_0x5be46d);_0x73eb6b&&(_0x3c3c7b[_0x530b1d(0x13e)]=_0x73eb6b[_0x530b1d(0xab)](),console['log']('💱\x20Currency\x20filter\x20applied:\x20'+_0x73eb6b[_0x530b1d(0xab)]()));(_0x5bb1d8||_0x5da62e)&&(_0x3c3c7b['createdAt']={},_0x5bb1d8&&(_0x3c3c7b[_0x530b1d(0x81)]['gte']=new Date(_0x5bb1d8)),_0x5da62e&&(_0x3c3c7b['createdAt'][_0x530b1d(0x9f)]=new Date(_0x5da62e)));_0x3cbf11&&(_0x3c3c7b['OR']=[{'id':{'contains':_0x3cbf11,'mode':'insensitive'}},{'orderId':{'contains':_0x3cbf11,'mode':'insensitive'}},{'gatewayOrderId':{'contains':_0x3cbf11,'mode':_0x530b1d(0xa3)}},{'customerEmail':{'contains':_0x3cbf11,'mode':_0x530b1d(0xa3)}},{'shop':{'name':{'contains':_0x3cbf11,'mode':_0x530b1d(0xa3)}}},{'shop':{'username':{'contains':_0x3cbf11,'mode':_0x530b1d(0xa3)}}}]);console[_0x530b1d(0x16b)](_0x530b1d(0x12c),JSON[_0x530b1d(0x17f)](_0x3c3c7b,null,0x2));let _0x166b8b={'createdAt':'desc'};if(_0x1cb06a){const _0x55f54a=[_0x530b1d(0x169),_0x530b1d(0x81),_0x530b1d(0x133),_0x530b1d(0x1a3),_0x530b1d(0xac),'currency'],_0x256e48=[_0x530b1d(0xc1),'desc'];if(_0x55f54a['includes'](_0x1cb06a)){const _0x34cf40=_0x256e48[_0x530b1d(0x164)](_0x33aed9)?_0x33aed9:_0x530b1d(0x83);_0x166b8b={[_0x1cb06a]:_0x34cf40},console[_0x530b1d(0x16b)](_0x530b1d(0x120)+_0x1cb06a+'\x20in\x20'+_0x34cf40+_0x530b1d(0x10c));}}const [_0x123217,_0x327322]=await Promise['all']([database_1[_0x530b1d(0xe9)][_0x530b1d(0x131)][_0x530b1d(0x11a)]({'where':_0x3c3c7b,'skip':_0x49a47f,'take':_0x23a863,'orderBy':_0x166b8b,'select':{'id':!![],'shopId':!![],'amount':!![],'amountAfterGatewayCommissionUSDT':!![],'currency':!![],'sourceCurrency':!![],'status':!![],'gateway':!![],'orderId':!![],'gatewayOrderId':!![],'gatewayPaymentId':!![],'customerEmail':!![],'customerName':!![],'customerCountry':!![],'customerIp':!![],'customerUa':!![],'externalPaymentUrl':!![],'successUrl':!![],'failUrl':!![],'pendingUrl':!![],'whiteUrl':!![],'expiresAt':!![],'invoiceTotalSum':!![],'qrCode':!![],'qrUrl':!![],'country':!![],'language':!![],'amountIsEditable':!![],'maxPayments':!![],'rapydCustomer':!![],'cardLast4':!![],'paymentMethod':!![],'bankId':!![],'remitterIban':!![],'remitterName':!![],'failureMessage':!![],'usage':!![],'createdAt':!![],'updatedAt':!![],'shop':{'select':{'name':!![],'username':!![]}}}}),database_1[_0x530b1d(0xe9)][_0x530b1d(0x131)][_0x530b1d(0xda)]({'where':_0x3c3c7b})]);return{'payments':_0x123217,'pagination':{'page':_0x2d899d,'limit':_0x23a863,'total':_0x327322,'totalPages':Math[_0x530b1d(0xb3)](_0x327322/_0x23a863)}};}async[a36_0x4a566d(0x7d)](_0x480736){const _0x1c597=a36_0x4a566d,_0x44430d=await database_1[_0x1c597(0xe9)][_0x1c597(0x131)][_0x1c597(0x101)]({'where':{'id':_0x480736},'select':{'id':!![],'shopId':!![],'amount':!![],'amountAfterGatewayCommissionUSDT':!![],'currency':!![],'sourceCurrency':!![],'status':!![],'gateway':!![],'orderId':!![],'gatewayOrderId':!![],'gatewayPaymentId':!![],'customerEmail':!![],'customerName':!![],'customerCountry':!![],'customerIp':!![],'customerUa':!![],'externalPaymentUrl':!![],'successUrl':!![],'failUrl':!![],'pendingUrl':!![],'whiteUrl':!![],'expiresAt':!![],'invoiceTotalSum':!![],'qrCode':!![],'qrUrl':!![],'country':!![],'language':!![],'amountIsEditable':!![],'maxPayments':!![],'rapydCustomer':!![],'cardLast4':!![],'paymentMethod':!![],'bankId':!![],'remitterIban':!![],'remitterName':!![],'failureMessage':!![],'usage':!![],'createdAt':!![],'updatedAt':!![],'shop':{'select':{'name':!![],'username':!![]}}}});if(!_0x44430d)return null;return{'id':_0x44430d['id'],'shopId':_0x44430d['shopId'],'gateway':_0x44430d[_0x1c597(0xac)],'amount':_0x44430d[_0x1c597(0x169)],'currency':_0x44430d[_0x1c597(0x13e)],'status':_0x44430d['status'],'orderId':_0x44430d[_0x1c597(0x192)],'gatewayOrderId':_0x44430d[_0x1c597(0x15d)],'customerEmail':_0x44430d[_0x1c597(0x15b)],'customerName':_0x44430d['customerName'],'customerCountry':_0x44430d[_0x1c597(0xca)],'customerIp':_0x44430d[_0x1c597(0x134)],'customerUa':_0x44430d[_0x1c597(0xc7)],'failureMessage':_0x44430d[_0x1c597(0x173)],'externalPaymentUrl':_0x44430d[_0x1c597(0x16d)],'successUrl':_0x44430d['successUrl'],'failUrl':_0x44430d[_0x1c597(0xd8)],'pendingUrl':_0x44430d[_0x1c597(0x9c)],'whiteUrl':_0x44430d[_0x1c597(0xc2)],'createdAt':_0x44430d[_0x1c597(0x81)],'updatedAt':_0x44430d[_0x1c597(0x133)],'shop':_0x44430d[_0x1c597(0xb1)]};}async[a36_0x4a566d(0xce)](_0x78dec3,_0x20e1df,_0x3c699c,_0x35387d){const _0x458b4b=a36_0x4a566d,_0xd0273=await database_1[_0x458b4b(0xe9)][_0x458b4b(0x163)](async _0x19246f=>{const _0x1f0fd9=_0x458b4b,_0x2344c7=await _0x19246f[_0x1f0fd9(0x131)][_0x1f0fd9(0x101)]({'where':{'id':_0x78dec3},'include':{'shop':{'select':{'id':!![],'name':!![],'username':!![],'balance':!![]}}}});if(!_0x2344c7)throw new Error(_0x1f0fd9(0x8f));const _0x5ec6f3=_0x2344c7[_0x1f0fd9(0x1a3)],_0x16d962=_0x20e1df[_0x1f0fd9(0xab)]();console[_0x1f0fd9(0x16b)](_0x1f0fd9(0x104)+_0x78dec3+_0x1f0fd9(0x1a0)+_0x5ec6f3+_0x1f0fd9(0x100)+_0x16d962),console[_0x1f0fd9(0x16b)](_0x1f0fd9(0x79)+_0x2344c7[_0x1f0fd9(0xb1)][_0x1f0fd9(0x14c)]+'\x20USDT');const _0x1f630d={'status':_0x16d962,'updatedAt':new Date(),'statusChangedBy':'admin','statusChangedAt':new Date()};_0x3c699c&&(_0x1f630d[_0x1f0fd9(0x14b)]=_0x3c699c);_0x16d962===_0x1f0fd9(0xa7)&&_0x35387d&&(_0x1f630d[_0x1f0fd9(0x85)]=_0x35387d);let _0x5dd413=0x0,_0x3931e8=_0x2344c7[_0x1f0fd9(0xb1)][_0x1f0fd9(0x14c)];if(_0x16d962===_0x1f0fd9(0x193)&&_0x5ec6f3!=='PAID'){_0x1f630d[_0x1f0fd9(0x17e)]=new Date();const _0x312c95=await currencyService_1[_0x1f0fd9(0x12b)][_0x1f0fd9(0x153)](_0x2344c7['amount'],_0x2344c7['currency']);_0x1f630d[_0x1f0fd9(0xf0)]=_0x312c95;let _0x23ff85=0x2d;const _0x598d5b=await _0x19246f[_0x1f0fd9(0xb1)][_0x1f0fd9(0x101)]({'where':{'id':_0x2344c7['shopId']},'select':{'gatewaySettings':!![]}});if(_0x598d5b?.[_0x1f0fd9(0xd1)])try{const _0x970a79=JSON[_0x1f0fd9(0x167)](_0x598d5b['gatewaySettings']);for(const [_0x4f4698,_0x15eef2]of Object[_0x1f0fd9(0x194)](_0x970a79)){if(_0x4f4698[_0x1f0fd9(0x16a)]()===_0x2344c7[_0x1f0fd9(0xac)][_0x1f0fd9(0x16a)]()){_0x23ff85=_0x15eef2[_0x1f0fd9(0x10a)]||0xa;break;}}}catch(_0xe8a969){console[_0x1f0fd9(0x82)](_0x1f0fd9(0x86)+_0x78dec3+':',_0xe8a969);}let _0x5e067a;_0x2344c7[_0x1f0fd9(0x185)]!==null&&_0x2344c7[_0x1f0fd9(0x185)]!==undefined?(_0x5e067a=_0x2344c7[_0x1f0fd9(0x185)],console[_0x1f0fd9(0x16b)](_0x1f0fd9(0x94)+_0x5e067a[_0x1f0fd9(0x15a)](0x6)+'\x20USDT\x20for\x20payment\x20'+_0x78dec3)):(_0x5e067a=_0x312c95*(0x1-_0x23ff85/0x64),console['log'](_0x1f0fd9(0x97)+_0x78dec3+':\x20'+_0x23ff85+_0x1f0fd9(0x1ac)+_0x312c95[_0x1f0fd9(0x15a)](0x6)+_0x1f0fd9(0x135)),_0x1f630d[_0x1f0fd9(0x185)]=_0x5e067a),_0x5dd413=_0x5e067a,_0x3931e8+=_0x5e067a,console[_0x1f0fd9(0x16b)](_0x1f0fd9(0x109)+_0x78dec3+_0x1f0fd9(0x141)),console[_0x1f0fd9(0x16b)](_0x1f0fd9(0xdb)+_0x312c95[_0x1f0fd9(0x15a)](0x6)+'\x20USDT'),console[_0x1f0fd9(0x16b)](_0x1f0fd9(0x176)+_0x2344c7[_0x1f0fd9(0xac)]+_0x1f0fd9(0x113)+_0x23ff85+'%'),console[_0x1f0fd9(0x16b)](_0x1f0fd9(0x15f)+_0x5e067a[_0x1f0fd9(0x15a)](0x6)+_0x1f0fd9(0xf2)+_0x23ff85+'%\x20commission)'),console[_0x1f0fd9(0x16b)]('\x20\x20\x20Added\x20to\x20balance:\x20+'+_0x5e067a[_0x1f0fd9(0x15a)](0x6)+'\x20USDT');}else{if(_0x5ec6f3===_0x1f0fd9(0x193)&&_0x16d962!==_0x1f0fd9(0x193)){if(_0x2344c7[_0x1f0fd9(0xf0)]){let _0x519658=0x2d;const _0x3b0c2c=await _0x19246f[_0x1f0fd9(0xb1)][_0x1f0fd9(0x101)]({'where':{'id':_0x2344c7[_0x1f0fd9(0x171)]},'select':{'gatewaySettings':!![]}});if(_0x3b0c2c?.['gatewaySettings'])try{const _0x11b221=JSON[_0x1f0fd9(0x167)](_0x3b0c2c[_0x1f0fd9(0xd1)]);for(const [_0x59c2cf,_0x430011]of Object[_0x1f0fd9(0x194)](_0x11b221)){if(_0x59c2cf[_0x1f0fd9(0x16a)]()===_0x2344c7[_0x1f0fd9(0xac)]['toLowerCase']()){_0x519658=_0x430011[_0x1f0fd9(0x10a)]||0xa;break;}}}catch(_0x1375e8){console[_0x1f0fd9(0x82)](_0x1f0fd9(0x86)+_0x78dec3+':',_0x1375e8);}const _0x146382=_0x2344c7['amountUSDT']*(0x1-_0x519658/0x64);_0x5dd413=-_0x146382,_0x3931e8-=_0x146382,_0x1f630d[_0x1f0fd9(0xf0)]=null,_0x1f630d['amountAfterGatewayCommissionUSDT']=null,console['log'](_0x1f0fd9(0x109)+_0x78dec3+_0x1f0fd9(0x16f)),console[_0x1f0fd9(0x16b)](_0x1f0fd9(0xdb)+_0x2344c7['amountUSDT'][_0x1f0fd9(0x15a)](0x6)+_0x1f0fd9(0x135)),console[_0x1f0fd9(0x16b)](_0x1f0fd9(0x176)+_0x2344c7[_0x1f0fd9(0xac)]+',\x20Commission:\x20'+_0x519658+'%'),console[_0x1f0fd9(0x16b)]('\x20\x20\x20Merchant\x20loses:\x20'+_0x146382[_0x1f0fd9(0x15a)](0x6)+_0x1f0fd9(0xf2)+_0x519658+_0x1f0fd9(0xc4)),console[_0x1f0fd9(0x16b)]('\x20\x20\x20Subtracted\x20from\x20balance:\x20-'+_0x146382['toFixed'](0x6)+_0x1f0fd9(0x135));}}}_0x16d962===_0x1f0fd9(0xa7)&&(_0x5ec6f3==='PAID'&&_0x2344c7[_0x1f0fd9(0xf0)]&&console['log']('💸\x20CHARGEBACK:\x20Merchant\x20amount\x20already\x20deducted\x20from\x20balance'),_0x35387d&&_0x35387d>0x0&&(_0x5dd413-=_0x35387d,_0x3931e8-=_0x35387d,console['log'](_0x1f0fd9(0x78)+_0x35387d['toFixed'](0x6)+_0x1f0fd9(0x183))));_0x16d962===_0x1f0fd9(0x18b)&&_0x5ec6f3==='PAID'&&console['log']('🔄\x20REFUND:\x20Payment\x20amount\x20already\x20deducted\x20from\x20balance');const _0x2a7e29=await _0x19246f['payment'][_0x1f0fd9(0xbd)]({'where':{'id':_0x78dec3},'data':_0x1f630d,'include':{'shop':{'select':{'name':!![],'username':!![]}}}});return _0x5dd413!==0x0&&(await _0x19246f[_0x1f0fd9(0xb1)]['update']({'where':{'id':_0x2344c7[_0x1f0fd9(0x171)]},'data':{'balance':_0x3931e8}}),console[_0x1f0fd9(0x16b)]('💰\x20Shop\x20'+_0x2344c7[_0x1f0fd9(0x171)]+'\x20balance\x20updated:\x20'+_0x2344c7['shop'][_0x1f0fd9(0x14c)][_0x1f0fd9(0x15a)](0x6)+_0x1f0fd9(0x100)+_0x3931e8[_0x1f0fd9(0x15a)](0x6)+_0x1f0fd9(0x154)+(_0x5dd413>0x0?'+':'')+_0x5dd413[_0x1f0fd9(0x15a)](0x6)+')')),_0x2a7e29;});return{'id':_0xd0273['id'],'shopId':_0xd0273[_0x458b4b(0x171)],'gateway':_0xd0273['gateway'],'amount':_0xd0273['amount'],'currency':_0xd0273[_0x458b4b(0x13e)],'status':_0xd0273[_0x458b4b(0x1a3)],'orderId':_0xd0273[_0x458b4b(0x192)],'gatewayOrderId':_0xd0273[_0x458b4b(0x15d)],'customerEmail':_0xd0273[_0x458b4b(0x15b)],'customerName':_0xd0273['customerName'],'customerCountry':_0xd0273['customerCountry'],'customerIp':_0xd0273['customerIp'],'customerUa':_0xd0273[_0x458b4b(0xc7)],'failureMessage':_0xd0273[_0x458b4b(0x173)],'adminNotes':_0xd0273['adminNotes'],'chargebackAmount':_0xd0273['chargebackAmount'],'statusChangedBy':_0xd0273[_0x458b4b(0xec)],'statusChangedAt':_0xd0273[_0x458b4b(0xfb)],'createdAt':_0xd0273[_0x458b4b(0x81)],'updatedAt':_0xd0273['updatedAt'],'shop':_0xd0273['shop']};}async['updateUser'](_0x3647c3,_0x3d009d){const _0x29581b=a36_0x4a566d,_0x31d9c2=Math[_0x29581b(0x13d)]()['toString'](0x24)[_0x29581b(0x145)](0x2,0x9);console['log'](_0x29581b(0x13f)+_0x31d9c2+_0x29581b(0x14f)+_0x3647c3);const _0x584846={..._0x3d009d};_0x3d009d[_0x29581b(0xd3)]&&_0x3d009d['password'][_0x29581b(0x7f)]()!==''?(console[_0x29581b(0x16b)](_0x29581b(0xaa)+_0x31d9c2+']\x20Updating\x20password\x20for\x20user\x20'+_0x3647c3),_0x584846[_0x29581b(0xd3)]=await bcryptjs_1[_0x29581b(0xe9)]['hash'](_0x3d009d[_0x29581b(0xd3)],0xc)):(console[_0x29581b(0x16b)](_0x29581b(0xaa)+_0x31d9c2+_0x29581b(0xed)),delete _0x584846['password']);_0x3d009d[_0x29581b(0x19f)]&&(_0x584846[_0x29581b(0x19a)]=_0x3d009d[_0x29581b(0x19f)],delete _0x584846[_0x29581b(0x19f)]);_0x3d009d[_0x29581b(0xa5)]&&(_0x584846[_0x29581b(0x1a6)]=_0x3d009d[_0x29581b(0xa5)],delete _0x584846[_0x29581b(0xa5)]);_0x3d009d[_0x29581b(0xa4)]&&(_0x584846[_0x29581b(0x116)]=_0x3d009d['merchantUrl'],delete _0x584846[_0x29581b(0xa4)]);if(_0x3d009d[_0x29581b(0x18f)]){const _0x4d7f62=_0x3d009d[_0x29581b(0x18f)][_0x29581b(0x106)](_0x555cb8=>this[_0x29581b(0xc0)](_0x555cb8));console[_0x29581b(0x16b)](_0x29581b(0x199),_0x3d009d[_0x29581b(0x18f)],'->',_0x4d7f62),_0x584846[_0x29581b(0x156)]=JSON[_0x29581b(0x17f)](_0x4d7f62),delete _0x584846[_0x29581b(0x18f)];}_0x3d009d[_0x29581b(0xd1)]&&(console[_0x29581b(0x16b)](_0x29581b(0x108)+_0x31d9c2+_0x29581b(0x111),_0x3d009d[_0x29581b(0xd1)]),_0x584846[_0x29581b(0xd1)]=JSON[_0x29581b(0x17f)](_0x3d009d[_0x29581b(0xd1)]),console[_0x29581b(0x16b)](_0x29581b(0x108)+_0x31d9c2+_0x29581b(0x80),_0x584846['gatewaySettings']));_0x3d009d[_0x29581b(0x190)]&&(_0x3d009d[_0x29581b(0x190)][_0x29581b(0x122)]!==undefined&&(_0x584846['usdtPolygonWallet']=_0x3d009d['wallets'][_0x29581b(0x122)]||null),_0x3d009d['wallets'][_0x29581b(0xfd)]!==undefined&&(_0x584846[_0x29581b(0xfd)]=_0x3d009d['wallets'][_0x29581b(0xfd)]||null),_0x3d009d['wallets'][_0x29581b(0xdd)]!==undefined&&(_0x584846['usdtErcWallet']=_0x3d009d[_0x29581b(0x190)][_0x29581b(0xdd)]||null),_0x3d009d[_0x29581b(0x190)][_0x29581b(0xad)]!==undefined&&(_0x584846[_0x29581b(0xad)]=_0x3d009d[_0x29581b(0x190)]['usdcPolygonWallet']||null),delete _0x584846[_0x29581b(0x190)]);const _0x3bac31=await database_1['default']['shop']['update']({'where':{'id':_0x3647c3},'data':_0x584846,'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});return console[_0x29581b(0x16b)](_0x29581b(0x150)+_0x31d9c2+_0x29581b(0x16c),_0x3bac31[_0x29581b(0xd1)]),{'id':_0x3bac31['id'],'fullName':_0x3bac31['name'],'username':_0x3bac31[_0x29581b(0x196)],'telegramId':_0x3bac31[_0x29581b(0x1a6)],'merchantUrl':_0x3bac31[_0x29581b(0x116)],'gateways':_0x3bac31[_0x29581b(0x156)]?JSON[_0x29581b(0x167)](_0x3bac31[_0x29581b(0x156)]):null,'gatewaySettings':_0x3bac31[_0x29581b(0xd1)]?JSON[_0x29581b(0x167)](_0x3bac31[_0x29581b(0xd1)]):null,'publicKey':_0x3bac31[_0x29581b(0x174)],'wallets':{'usdtPolygonWallet':_0x3bac31[_0x29581b(0x122)],'usdtTrcWallet':_0x3bac31[_0x29581b(0xfd)],'usdtErcWallet':_0x3bac31[_0x29581b(0xdd)],'usdcPolygonWallet':_0x3bac31[_0x29581b(0xad)]},'status':_0x3bac31['status'],'createdAt':_0x3bac31['createdAt']};}async[a36_0x4a566d(0x151)](_0x2ea34e){const _0x38e565=a36_0x4a566d,_0xe4dd10=await database_1[_0x38e565(0xe9)][_0x38e565(0xb1)][_0x38e565(0xbd)]({'where':{'id':_0x2ea34e},'data':{'status':'SUSPENDED'},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});return{'id':_0xe4dd10['id'],'fullName':_0xe4dd10['name'],'username':_0xe4dd10[_0x38e565(0x196)],'telegramId':_0xe4dd10[_0x38e565(0x1a6)],'merchantUrl':_0xe4dd10['shopUrl'],'gateways':_0xe4dd10[_0x38e565(0x156)]?JSON['parse'](_0xe4dd10['paymentGateways']):null,'gatewaySettings':_0xe4dd10['gatewaySettings']?JSON[_0x38e565(0x167)](_0xe4dd10['gatewaySettings']):null,'publicKey':_0xe4dd10[_0x38e565(0x174)],'wallets':{'usdtPolygonWallet':_0xe4dd10['usdtPolygonWallet'],'usdtTrcWallet':_0xe4dd10['usdtTrcWallet'],'usdtErcWallet':_0xe4dd10[_0x38e565(0xdd)],'usdcPolygonWallet':_0xe4dd10[_0x38e565(0xad)]},'status':_0xe4dd10[_0x38e565(0x1a3)],'createdAt':_0xe4dd10[_0x38e565(0x81)]};}async[a36_0x4a566d(0xa8)](_0x24af41){const _0x23bad9=a36_0x4a566d,_0x1651bb=await database_1[_0x23bad9(0xe9)]['shop'][_0x23bad9(0xbd)]({'where':{'id':_0x24af41},'data':{'status':_0x23bad9(0x11d)},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});return{'id':_0x1651bb['id'],'fullName':_0x1651bb['name'],'username':_0x1651bb[_0x23bad9(0x196)],'telegramId':_0x1651bb[_0x23bad9(0x1a6)],'merchantUrl':_0x1651bb[_0x23bad9(0x116)],'gateways':_0x1651bb['paymentGateways']?JSON[_0x23bad9(0x167)](_0x1651bb[_0x23bad9(0x156)]):null,'gatewaySettings':_0x1651bb[_0x23bad9(0xd1)]?JSON['parse'](_0x1651bb[_0x23bad9(0xd1)]):null,'publicKey':_0x1651bb['publicKey'],'wallets':{'usdtPolygonWallet':_0x1651bb['usdtPolygonWallet'],'usdtTrcWallet':_0x1651bb[_0x23bad9(0xfd)],'usdtErcWallet':_0x1651bb[_0x23bad9(0xdd)],'usdcPolygonWallet':_0x1651bb[_0x23bad9(0xad)]},'status':_0x1651bb[_0x23bad9(0x1a3)],'createdAt':_0x1651bb['createdAt']};}async[a36_0x4a566d(0xd6)](_0x11d74d){const _0x25a318=a36_0x4a566d,{page:_0x439378,limit:_0xc7ea74,status:_0x57c63e}=_0x11d74d,_0x2ebf14=(_0x439378-0x1)*_0xc7ea74,_0x3015ca={};_0x57c63e&&(_0x3015ca[_0x25a318(0x1a3)]=_0x57c63e['toUpperCase']());const [_0x3cd344,_0x14074b]=await Promise[_0x25a318(0xde)]([database_1['default'][_0x25a318(0xb1)]['findMany']({'where':_0x3015ca,'skip':_0x2ebf14,'take':_0xc7ea74,'orderBy':{'createdAt':_0x25a318(0x83)},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}}),database_1[_0x25a318(0xe9)][_0x25a318(0xb1)][_0x25a318(0xda)]({'where':_0x3015ca})]);return{'users':_0x3cd344['map'](_0x4ee8fa=>{const _0x400cc2=_0x25a318,_0x375d77=_0x4ee8fa[_0x400cc2(0x156)]?JSON['parse'](_0x4ee8fa[_0x400cc2(0x156)]):null,_0x5e9da8=_0x375d77?_0x375d77[_0x400cc2(0x106)](_0x569ada=>this[_0x400cc2(0xf4)](_0x569ada)):null;return{'id':_0x4ee8fa['id'],'fullName':_0x4ee8fa[_0x400cc2(0x19a)],'username':_0x4ee8fa['username'],'telegramId':_0x4ee8fa[_0x400cc2(0x1a6)],'merchantUrl':_0x4ee8fa[_0x400cc2(0x116)],'gateways':_0x5e9da8,'gatewaySettings':_0x4ee8fa[_0x400cc2(0xd1)]?JSON[_0x400cc2(0x167)](_0x4ee8fa[_0x400cc2(0xd1)]):null,'publicKey':_0x4ee8fa['publicKey'],'wallets':{'usdtPolygonWallet':_0x4ee8fa['usdtPolygonWallet'],'usdtTrcWallet':_0x4ee8fa[_0x400cc2(0xfd)],'usdtErcWallet':_0x4ee8fa[_0x400cc2(0xdd)],'usdcPolygonWallet':_0x4ee8fa[_0x400cc2(0xad)]},'status':_0x4ee8fa['status'],'createdAt':_0x4ee8fa['createdAt']};}),'pagination':{'page':_0x439378,'limit':_0xc7ea74,'total':_0x14074b,'totalPages':Math['ceil'](_0x14074b/_0xc7ea74)}};}async[a36_0x4a566d(0x99)](_0x2c9659){const _0x1d3962=a36_0x4a566d,_0x291784=await database_1[_0x1d3962(0xe9)]['shop'][_0x1d3962(0x101)]({'where':{'id':_0x2c9659},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});if(!_0x291784)return null;const _0x2f8226=_0x291784[_0x1d3962(0x156)]?JSON[_0x1d3962(0x167)](_0x291784[_0x1d3962(0x156)]):null,_0x23db44=_0x2f8226?_0x2f8226[_0x1d3962(0x106)](_0x1fff1e=>this['getGatewayDisplayName'](_0x1fff1e)):null;return _0x2f8226&&_0x23db44&&console['log']('🔄\x20Gateway\x20mapping\x20(get):',_0x2f8226,'->',_0x23db44),{'id':_0x291784['id'],'fullName':_0x291784['name'],'username':_0x291784['username'],'telegramId':_0x291784[_0x1d3962(0x1a6)],'merchantUrl':_0x291784[_0x1d3962(0x116)],'gateways':_0x23db44,'gatewaySettings':_0x291784[_0x1d3962(0xd1)]?JSON['parse'](_0x291784['gatewaySettings']):null,'publicKey':_0x291784[_0x1d3962(0x174)],'wallets':{'usdtPolygonWallet':_0x291784[_0x1d3962(0x122)],'usdtTrcWallet':_0x291784[_0x1d3962(0xfd)],'usdtErcWallet':_0x291784['usdtErcWallet'],'usdcPolygonWallet':_0x291784[_0x1d3962(0xad)]},'status':_0x291784[_0x1d3962(0x1a3)],'createdAt':_0x291784['createdAt']};}async[a36_0x4a566d(0x137)](_0x36ecd1){const _0x180f13=a36_0x4a566d,{fullName:_0x2dd067,username:_0x17a7e0,password:_0x921ecd,telegramId:_0x10e91e,merchantUrl:_0x41ef51,gateways:_0x139793,gatewaySettings:_0x4e9a5e,wallets:_0x40b898}=_0x36ecd1,_0x5b30d3=await database_1[_0x180f13(0xe9)][_0x180f13(0xb1)][_0x180f13(0x101)]({'where':{'username':_0x17a7e0}});if(_0x5b30d3)throw new Error(_0x180f13(0x1a4));if(_0x10e91e){const _0x3ff8f5=await database_1[_0x180f13(0xe9)][_0x180f13(0xb1)][_0x180f13(0x101)]({'where':{'telegram':_0x10e91e}});if(_0x3ff8f5)throw new Error('Telegram\x20username\x20already\x20exists');}const _0x23a466=await bcryptjs_1[_0x180f13(0xe9)][_0x180f13(0x165)](_0x921ecd,0xc),_0x5c9ce6=_0x180f13(0x129)+crypto_1['default'][_0x180f13(0x117)](0x20)['toString'](_0x180f13(0x107)),_0x497bab='sk_'+crypto_1['default'][_0x180f13(0x117)](0x20)[_0x180f13(0x88)](_0x180f13(0x107)),_0x11c715=_0x139793?_0x139793[_0x180f13(0x106)](_0x7b6092=>this[_0x180f13(0xc0)](_0x7b6092)):null;_0x139793&&_0x11c715&&console[_0x180f13(0x16b)]('🔄\x20Gateway\x20mapping\x20(create):',_0x139793,'->',_0x11c715);const _0x477e23=await database_1[_0x180f13(0xe9)][_0x180f13(0xb1)]['create']({'data':{'name':_0x2dd067,'username':_0x17a7e0,'password':_0x23a466,'telegram':_0x10e91e,'shopUrl':_0x41ef51,'paymentGateways':_0x11c715?JSON[_0x180f13(0x17f)](_0x11c715):null,'gatewaySettings':_0x4e9a5e?JSON[_0x180f13(0x17f)](_0x4e9a5e):null,'usdtPolygonWallet':_0x40b898?.[_0x180f13(0x122)]||null,'usdtTrcWallet':_0x40b898?.[_0x180f13(0xfd)]||null,'usdtErcWallet':_0x40b898?.[_0x180f13(0xdd)]||null,'usdcPolygonWallet':_0x40b898?.[_0x180f13(0xad)]||null,'publicKey':_0x5c9ce6,'secretKey':_0x497bab,'status':_0x180f13(0x11d)},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});return{'id':_0x477e23['id'],'fullName':_0x477e23[_0x180f13(0x19a)],'username':_0x477e23['username'],'telegramId':_0x477e23[_0x180f13(0x1a6)],'merchantUrl':_0x477e23[_0x180f13(0x116)],'gateways':_0x477e23[_0x180f13(0x156)]?JSON['parse'](_0x477e23[_0x180f13(0x156)]):null,'gatewaySettings':_0x477e23['gatewaySettings']?JSON[_0x180f13(0x167)](_0x477e23[_0x180f13(0xd1)]):null,'publicKey':_0x477e23[_0x180f13(0x174)],'wallets':{'usdtPolygonWallet':_0x477e23['usdtPolygonWallet'],'usdtTrcWallet':_0x477e23['usdtTrcWallet'],'usdtErcWallet':_0x477e23[_0x180f13(0xdd)],'usdcPolygonWallet':_0x477e23[_0x180f13(0xad)]},'status':_0x477e23[_0x180f13(0x1a3)],'createdAt':_0x477e23[_0x180f13(0x81)]};}async[a36_0x4a566d(0x158)](_0x1b8547){const _0x2f632b=a36_0x4a566d;await database_1[_0x2f632b(0xe9)]['shop'][_0x2f632b(0x91)]({'where':{'id':_0x1b8547}});}[a36_0x4a566d(0x149)](_0x23fc67,_0xf31863,_0x49e16e){const _0x1d2a92=a36_0x4a566d,_0x5914b5=new Map(),_0x398b6c=new Date(_0xf31863);while(_0x398b6c<=_0x49e16e){const _0x3a731c=_0x398b6c[_0x1d2a92(0xd4)]()[_0x1d2a92(0x17d)]('T')[0x0];_0x5914b5[_0x1d2a92(0x16e)](_0x3a731c,{'revenue':0x0,'count':0x0}),_0x398b6c[_0x1d2a92(0x157)](_0x398b6c[_0x1d2a92(0x103)]()+0x1);}for(const _0x1dd09e of _0x23fc67){const _0x188146=_0x1dd09e[_0x1d2a92(0x81)][_0x1d2a92(0xd4)]()[_0x1d2a92(0x17d)]('T')[0x0],_0xea135b=_0x5914b5['get'](_0x188146);_0xea135b&&(_0xea135b[_0x1d2a92(0xda)]+=0x1,_0x1dd09e[_0x1d2a92(0x1a3)]==='PAID'&&(_0x1dd09e[_0x1d2a92(0xf0)]?_0xea135b[_0x1d2a92(0xe4)]+=_0x1dd09e[_0x1d2a92(0xf0)]:console[_0x1d2a92(0x16b)](_0x1d2a92(0x189)+_0x1dd09e['id']+'\x20missing\x20amountUSDT,\x20using\x20fallback\x20conversion')));}const _0x472e6e=[],_0x48c679=[];for(const [_0x1b9458,_0x30f22d]of _0x5914b5){_0x472e6e[_0x1d2a92(0xeb)]({'date':_0x1b9458,'amount':Math['round'](_0x30f22d['revenue']*0x64)/0x64}),_0x48c679[_0x1d2a92(0xeb)]({'date':_0x1b9458,'count':_0x30f22d[_0x1d2a92(0xda)]});}return{'dailyRevenue':_0x472e6e,'dailyPayments':_0x48c679};}}exports[a36_0x4a566d(0x180)]=AdminService;