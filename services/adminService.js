'use strict';const a36_0x69dc61=a36_0x1540;(function(_0x45f852,_0x48b76b){const _0x5777f3=a36_0x1540,_0x33965c=_0x45f852();while(!![]){try{const _0x40d087=parseInt(_0x5777f3(0x153))/0x1+-parseInt(_0x5777f3(0x167))/0x2+-parseInt(_0x5777f3(0x19a))/0x3*(parseInt(_0x5777f3(0x116))/0x4)+-parseInt(_0x5777f3(0x1c4))/0x5+parseInt(_0x5777f3(0x10e))/0x6*(parseInt(_0x5777f3(0x1c2))/0x7)+parseInt(_0x5777f3(0x143))/0x8*(parseInt(_0x5777f3(0x1ea))/0x9)+-parseInt(_0x5777f3(0x110))/0xa*(-parseInt(_0x5777f3(0x1d9))/0xb);if(_0x40d087===_0x48b76b)break;else _0x33965c['push'](_0x33965c['shift']());}catch(_0x4a1e1d){_0x33965c['push'](_0x33965c['shift']());}}}(a36_0x364c,0x47340));var __importDefault=this&&this[a36_0x69dc61(0x1b8)]||function(_0x542779){const _0x391902=a36_0x69dc61;return _0x542779&&_0x542779[_0x391902(0x1cc)]?_0x542779:{'default':_0x542779};};Object['defineProperty'](exports,a36_0x69dc61(0x1cc),{'value':!![]}),exports[a36_0x69dc61(0x117)]=void 0x0;function a36_0x1540(_0x910da2,_0x2f4fb1){const _0x364c22=a36_0x364c();return a36_0x1540=function(_0x154055,_0x1207f1){_0x154055=_0x154055-0x100;let _0x5a3572=_0x364c22[_0x154055];return _0x5a3572;},a36_0x1540(_0x910da2,_0x2f4fb1);}function a36_0x364c(){const _0x2e2113=['🔐\x20[','\x20\x20\x20📅\x20Total\x20payouts\x20(this\x20month):\x20','📊\x20Merchants\x20awaiting\x20payout:\x20','\x20USDT\x20(total\x20paid\x20to\x20merchants)','failUrl','toString','split','telegramId','desc','currency','awaitingPayout','🎯\x20updateUser\x20called\x20with\x20ID:\x20','getGatewayDisplayName','gatewayOrderId','📅\x20Period\x20\x27all\x27:\x20Using\x20start\x20date\x20from\x20first\x20payment:\x20','📊\x20Sorting\x20payments\x20by\x20','2020-01-01','update','\x20\x20\x20💸\x20Total\x20payouts\x20(all\x20time):\x20','💰\x20Payment\x20','\x20PAID\x20payments','💰\x20[PAYOUT]\x20Gateway\x20','payment','\x20payments)','entries','amount','\x20\x20\x20📅\x20This\x20month:\x20','getGatewayNameById','status','setDate','CHARGEBACK','\x20USDT\x20(+',']\x20Gateway\x20settings\x20JSON\x20string:','statusChangedAt','month','\x20USDT\x20(','orderId','shop','cointopay2','Rapyd','name','periodFrom','revenue','findUnique','🔄\x20Converted\x20gateway\x20name\x20\x27',']\x20Updating\x20password\x20for\x20user\x20','_count','substr','\x20USDT\x20from\x20balance','shopUrl','getSystemStatistics','lte','KLYME\x20GB','114ATcpSU','\x20\x20\x20Merchant\x20loses:\x20','192980sIvlLJ','\x20\x20\x20⏳\x20Pending\x20payout:\x20','all','\x20USDT\x20for\x20payment\x20','📊\x20Total\x20payments\x20(including\x20failed):\x20','toISOString','2428IKrvpq','AdminService','wallets','\x20missing\x20amountUSDT,\x20using\x20fallback\x20conversion','totalCommissionRate','%\x20from\x20','paymentsCount','txid','externalPaymentUrl','\x20USDT\x20(gross\x20revenue)','🔍\x20Using\x20gateway\x20\x27','\x20\x20\x20Subtracted\x20from\x20balance:\x20-','📊\x20Gateway\x20filter\x20applied:','\x20merchants','\x20USDT,\x20Requested:\x20','🔄\x20Gateway\x20mapping:','gateway','whiteUrl','\x20\x20\x20Payout\x20amount:\x20','✅\x20Payout\x20created:\x20','⚠️\x20Gateway\x20\x27','turnoverUSDT','notes','totalAmountUSDT','REFUND','\x20active\x20merchants\x20for\x20selection','default','delete','\x20merchants\x20with\x20positive\x20balance','push','💸\x20CHARGEBACK:\x20Merchant\x20amount\x20already\x20deducted\x20from\x20balance','failureMessage','length','customerUa','set','\x20in\x20','dateFrom',']\x20Password\x20not\x20provided\x20or\x20empty,\x20skipping\x20password\x20update','\x20USDT\x20(after\x20payouts)','summary','thisMonth','randomBytes','\x20balance\x20updated:','Error\x20parsing\x20gateway\x20settings\x20for\x20shop\x20','totalPaidOut','24jGEYnG','💰\x20Shop\x20','\x27\x20(from\x20\x27','create','getAllPayments','createUser','pendingUrl','🔄\x20Admin\x20updating\x20payment\x20','getGatewayIdByName','💰\x20[PAYOUT]\x20Merchant\x20','toLowerCase','📊\x20Getting\x20payments\x20with\x20filters:','📊\x20Merchant\x20statistics\x20calculated:','📅\x20Period:\x20','updatedAt','\x27)\x20not\x20found\x20in\x20database,\x20returning\x20empty\x20result','193561inXlTQ','🔄\x20REFUND:\x20Payment\x20amount\x20already\x20deducted\x20from\x20balance','findMany','\x20no\x20longer\x20PAID:','\x20paid\x20payments\x20for\x20analysis','round','shopId',':\x20commission\x20=\x20','\x20\x20\x20⏳\x20Awaiting\x20payout:\x20','Open\x20Banking\x202','toUpperCase','findFirst','\x20\x20\x20📊\x20Commission\x20difference:\x20','hex','../types/gateway','Error\x20parsing\x20gateway\x20settings\x20for\x20payment\x20','\x20\x20\x20Transaction\x20hash:\x20','📋\x20Getting\x20merchants\x20selection\x20list...','localeCompare','\x20\x20\x20🏪\x20Gateway\x20earnings:\x20','879046TNYaZK','\x20\x20\x20Merchant\x20gets:\x20','getPaymentById','💰\x20Creating\x20payout\x20for\x20shop\x20','totalTurnover','✅\x20Using\x20gateway\x20filter:\x20\x27','\x20->\x20','\x20\x20\x20Gateway:\x20','includes','period','Test\x20Gateway','currencyService','fullName','KLYME\x20EU','💸\x20CHARGEBACK\x20penalty:\x20-','sort','asc','ACTIVE','⚠️\x20Payment\x20','week','\x20USDT','sk_','totalAmountAfterCommissionUSDT','pendingPayout','hash','averageCommissionRate','\x20for\x20shop\x20','Telegram\x20username\x20already\x20exists','network','count','not\x20set','klyme_de','0000','🔄\x20Updating\x20customer\x20data\x20for\x20payment\x20','💱\x20Currency\x20filter\x20applied:\x20',',\x20Commission:\x20','\x20\x20\x20Current\x20total\x20paid\x20out:\x20','$transaction','klyme_eu','\x20\x20\x20✅\x20Actual\x20available\x20balance:\x20','amountUSDT','✅\x20Customer\x20data\x20updated\x20for\x20payment\x20','\x20\x20\x20🖥️\x20User\x20Agent:\x20','\x20\x20\x20�\x20Total\x20paid\x20out:\x20','customerEmail','aggregate','createPayout','Noda','getDate','\x20\x20\x20👤\x20Merchant\x20earnings:\x20','\x20order','453OQFOwM','./currencyService','ceil','\x20USDT\x20(without\x20commission)','activateUser','pk_','📋\x20Found\x20','admin','30d','usdtErcWallet','createdAt','📊\x20Available\x20gateways\x20in\x20database:','getMonth','gte','\x27\x20to\x20name\x20\x27','\x20\x20\x20Full\x20amount:\x20','amountAfterGatewayCommissionUSDT','getMerchantStatistics','CoinToPay','\x20\x20\x20🔍\x20Raw\x20balance\x20sum:\x20','getMerchantsSelection','SUSPENDED','cointopay','periodTo','groupBy','get',']\x20Gateway\x20settings\x20before\x20saving:','../config/database','PAID','amountAfterCommissionUSDT','__importDefault','password','telegram','🔄\x20Gateway\x20mapping\x20(get):','📊\x20Payout\x20statistics\x20calculated:','gatewaySettings','paymentGateways','username','customerCountry','plisio','87941zTrubu','getUserById','914625wInvIw','publicKey','commission','date','\x27\x20->\x20name\x20\x27','commissionUSDT','payout','parse','__esModule','\x27\x20->\x20ID\x20\x27','NONEXISTENT_GATEWAY_FILTER','values','balance','Plisio','\x20\x20\x20Total\x20paid\x20out:\x20','customerName',',\x20userId:\x20','gatewayEarnings','getAllUsers','statusChangedBy','noda','231GyDdOA','insensitive','map','toFixed','random','🔄\x20Converted\x20gateway\x20ID\x20\x27','\x20USDT\x20(after\x20','📊\x20Final\x20WHERE\x20conditions:','🔄\x20Gateway\x20mapping\x20(create):','_sum','\x20\x20\x20💰\x20Total\x20payments\x20turnover:\x20','stringify','test_gateway','reduce','custom','\x20\x20\x20Current\x20balance:\x20','\x20\x20\x20💵\x20Available\x20balance:\x20','504711LXKPiE','\x27\x20not\x20found.\x20Available\x20gateways:\x20','%\x20commission)','COMPLETED','📊\x20Calculating\x20commission\x20manually\x20for\x20payment\x20',']\x20User\x20updated,\x20gatewaySettings\x20from\x20DB:','totalPayments','getTime','usdtPolygonWallet','⚠️\x20Requested\x20gateway\x20\x27','getFullYear','📊\x20Getting\x20merchants\x20awaiting\x20payout\x20with\x20filters:','erc20','error','paidAt','\x20\x20\x20🔍\x20Calculated\x20after\x20commission:\x20','customerIp','merchantEarningsUSDT','getGatewayInternalName','KLYME\x20DE','getMerchantsAwaitingPayout','gateways','averageCheckUSDT','convertToUSDT','\x20\x20\x20✅\x20Total\x20available\x20for\x20payout:\x20','merchantUrl','💰\x20Found\x20','merchantEarnings','Payment\x20not\x20found','successUrl','getPayoutById','\x20\x20\x20Balance:\x20','generateDailyStatistics','usdcPolygonWallet','crypto','mastercard','usdtTrcWallet','💰\x20Current\x20shop\x20balance:\x20','\x20\x20\x20💰\x20Total\x20payout:\x20','log','\x20\x20\x20�\x20Total\x20payments\x20turnover:\x20','adminNotes','\x20\x20\x20💳\x20Total\x20payments:\x20','getAllPayouts','\x20USDT\x20(same\x20as\x20awaiting)','🔧\x20[','suspendUser','\x20\x20\x20💰\x20Total\x20turnover:\x20'];a36_0x364c=function(){return _0x2e2113;};return a36_0x364c();}const database_1=__importDefault(require(a36_0x69dc61(0x1b5))),bcryptjs_1=__importDefault(require('bcryptjs')),crypto_1=__importDefault(require(a36_0x69dc61(0x20c))),currencyService_1=require(a36_0x69dc61(0x19b)),gateway_1=require(a36_0x69dc61(0x161));class AdminService{async['getPayoutStats'](){const _0x2c69e3=a36_0x69dc61;console['log']('📊\x20Calculating\x20payout\x20statistics...');const _0x42bc64=await database_1[_0x2c69e3(0x130)][_0x2c69e3(0x23f)]['aggregate']({'_sum':{'balance':!![],'totalPaidOut':!![]},'where':{'status':'ACTIVE'}}),_0x2a0e96=await this[_0x2c69e3(0x1fe)]({'page':0x1,'limit':0x3e8}),_0x269179=await database_1[_0x2c69e3(0x130)][_0x2c69e3(0x230)][_0x2c69e3(0x184)]({'where':{'status':_0x2c69e3(0x1b6),'gateway':{'not':'test_gateway'}}}),_0x264c41=new Date(),_0x4e4377=new Date(_0x264c41['getFullYear'](),_0x264c41['getMonth'](),0x1),_0x8451e0=new Date(_0x264c41[_0x2c69e3(0x1f4)](),_0x264c41[_0x2c69e3(0x1a6)]()+0x1,0x0,0x17,0x3b,0x3b,0x3e7),_0x43a9c3=await database_1[_0x2c69e3(0x130)][_0x2c69e3(0x1ca)][_0x2c69e3(0x194)]({'_sum':{'amount':!![]},'where':{'createdAt':{'gte':_0x4e4377,'lte':_0x8451e0},'status':_0x2c69e3(0x1ed)}}),_0x2fb536=_0x42bc64[_0x2c69e3(0x1e2)][_0x2c69e3(0x142)]||0x0,_0x27d15a=_0x2a0e96[_0x2c69e3(0x13d)][_0x2c69e3(0x17d)],_0x22b4b4=_0x43a9c3['_sum'][_0x2c69e3(0x233)]||0x0,_0x1a94f8={'totalPayout':Math[_0x2c69e3(0x158)](_0x2fb536*0x64)/0x64,'awaitingPayout':Math['round'](_0x27d15a*0x64)/0x64,'thisMonth':Math[_0x2c69e3(0x158)](_0x22b4b4*0x64)/0x64,'availableBalance':Math['round'](_0x27d15a*0x64)/0x64,'totalPayments':_0x269179};return console['log'](_0x2c69e3(0x1bc)),console[_0x2c69e3(0x211)](_0x2c69e3(0x210)+_0x1a94f8['totalPayout']+_0x2c69e3(0x21d)),console[_0x2c69e3(0x211)](_0x2c69e3(0x15b)+_0x1a94f8[_0x2c69e3(0x224)]+'\x20USDT\x20(with\x20commission\x20deducted)'),console[_0x2c69e3(0x211)](_0x2c69e3(0x1e9)+_0x1a94f8['availableBalance']+_0x2c69e3(0x216)),console[_0x2c69e3(0x211)](_0x2c69e3(0x234)+_0x1a94f8['thisMonth']+_0x2c69e3(0x17b)),console[_0x2c69e3(0x211)](_0x2c69e3(0x214)+_0x1a94f8[_0x2c69e3(0x1f0)]+_0x2c69e3(0x22e)),console[_0x2c69e3(0x211)](_0x2c69e3(0x1ad)+(_0x42bc64[_0x2c69e3(0x1e2)][_0x2c69e3(0x1d0)]||0x0)[_0x2c69e3(0x1dc)](0x2)+_0x2c69e3(0x19d)),console[_0x2c69e3(0x211)](_0x2c69e3(0x15f)+((_0x42bc64[_0x2c69e3(0x1e2)][_0x2c69e3(0x1d0)]||0x0)-_0x27d15a)[_0x2c69e3(0x1dc)](0x2)+_0x2c69e3(0x17b)),_0x1a94f8;}async['updateCustomerData'](_0x497193,_0x336d00){const _0x2b1ced=a36_0x69dc61;console['log'](_0x2b1ced(0x188)+_0x497193+':',_0x336d00);const _0x348a2b=await database_1['default']['payment'][_0x2b1ced(0x104)]({'where':{'id':_0x497193},'select':{'id':!![],'customerEmail':!![],'customerName':!![],'customerCountry':!![],'customerIp':!![],'customerUa':!![]}});if(!_0x348a2b)throw new Error(_0x2b1ced(0x206));const _0x11a933={};_0x336d00[_0x2b1ced(0x1c0)]!==undefined&&(_0x11a933[_0x2b1ced(0x1c0)]=_0x336d00['customerCountry']||null);_0x336d00['customerIp']!==undefined&&(_0x11a933[_0x2b1ced(0x1fa)]=_0x336d00[_0x2b1ced(0x1fa)]||null);_0x336d00[_0x2b1ced(0x137)]!==undefined&&(_0x11a933[_0x2b1ced(0x137)]=_0x336d00['customerUa']||null);const _0x4f1368=await database_1['default'][_0x2b1ced(0x230)][_0x2b1ced(0x22b)]({'where':{'id':_0x497193},'data':{..._0x11a933,'updatedAt':new Date()},'select':{'id':!![],'customerEmail':!![],'customerName':!![],'customerCountry':!![],'customerIp':!![],'customerUa':!![],'updatedAt':!![]}});return console[_0x2b1ced(0x211)](_0x2b1ced(0x190)+_0x497193),console[_0x2b1ced(0x211)]('\x20\x20\x20🌍\x20Country:\x20'+_0x348a2b[_0x2b1ced(0x1c0)]+'\x20->\x20'+_0x4f1368[_0x2b1ced(0x1c0)]),console[_0x2b1ced(0x211)]('\x20\x20\x20🌐\x20IP:\x20'+_0x348a2b[_0x2b1ced(0x1fa)]+'\x20->\x20'+_0x4f1368[_0x2b1ced(0x1fa)]),console[_0x2b1ced(0x211)](_0x2b1ced(0x191)+(_0x348a2b[_0x2b1ced(0x137)]?'set':'not\x20set')+_0x2b1ced(0x16d)+(_0x4f1368[_0x2b1ced(0x137)]?'set':_0x2b1ced(0x185))),_0x4f1368;}async[a36_0x69dc61(0x10b)](_0x4d003c){const _0x5b9b8b=a36_0x69dc61,_0x578483=new Date();let _0x46c018;switch(_0x4d003c){case'7d':_0x46c018=new Date(_0x578483[_0x5b9b8b(0x1f1)]()-0x7*0x18*0x3c*0x3c*0x3e8);break;case _0x5b9b8b(0x1a2):_0x46c018=new Date(_0x578483['getTime']()-0x1e*0x18*0x3c*0x3c*0x3e8);break;case'90d':_0x46c018=new Date(_0x578483['getTime']()-0x5a*0x18*0x3c*0x3c*0x3e8);break;case'all':const _0x59da37=await database_1[_0x5b9b8b(0x130)][_0x5b9b8b(0x230)]['findFirst']({'where':{'gateway':{'not':_0x5b9b8b(0x1e5)}},'orderBy':{'createdAt':_0x5b9b8b(0x177)},'select':{'createdAt':!![]}});_0x46c018=_0x59da37?_0x59da37['createdAt']:new Date(_0x5b9b8b(0x22a)),console[_0x5b9b8b(0x211)](_0x5b9b8b(0x228)+_0x46c018[_0x5b9b8b(0x115)]());break;default:_0x46c018=new Date(_0x578483[_0x5b9b8b(0x1f1)]()-0x1e*0x18*0x3c*0x3c*0x3e8);}const [_0x3a2f14,_0x3c7057,_0x321b35,_0x173022,_0x34efa0,_0x1c9549]=await Promise['all']([database_1[_0x5b9b8b(0x130)][_0x5b9b8b(0x23f)]['count'](),database_1[_0x5b9b8b(0x130)][_0x5b9b8b(0x23f)][_0x5b9b8b(0x184)]({'where':{'status':'ACTIVE'}}),database_1['default'][_0x5b9b8b(0x230)]['count']({'where':{'status':'PAID','createdAt':{'gte':_0x46c018},'gateway':{'not':'test_gateway'}}}),database_1[_0x5b9b8b(0x130)][_0x5b9b8b(0x230)][_0x5b9b8b(0x155)]({'where':{'status':_0x5b9b8b(0x1b6),'createdAt':{'gte':_0x46c018},'gateway':{'not':_0x5b9b8b(0x1e5)}},'select':{'amount':!![],'currency':!![],'amountAfterGatewayCommissionUSDT':!![]}}),database_1[_0x5b9b8b(0x130)]['payment']['findMany']({'where':{'gateway':{'not':_0x5b9b8b(0x1e5)}},'take':0xa,'orderBy':{'createdAt':_0x5b9b8b(0x222)},'include':{'shop':{'select':{'name':!![],'username':!![]}}}}),database_1['default'][_0x5b9b8b(0x230)]['findMany']({'where':{'createdAt':{'gte':_0x46c018},'gateway':{'not':'test_gateway'}},'select':{'amount':!![],'currency':!![],'status':!![],'amountUSDT':!![],'createdAt':!![]}})]);let _0x15dd9c=0x0,_0x2dd72a=0x0;for(const _0xbf7fc5 of _0x173022){const _0xf23309=await currencyService_1[_0x5b9b8b(0x172)][_0x5b9b8b(0x201)](_0xbf7fc5[_0x5b9b8b(0x233)],_0xbf7fc5[_0x5b9b8b(0x223)]);_0x15dd9c+=_0xf23309;if(_0xbf7fc5['amountAfterGatewayCommissionUSDT']){const _0x5a0728=await currencyService_1[_0x5b9b8b(0x172)][_0x5b9b8b(0x201)](_0xbf7fc5[_0x5b9b8b(0x233)],_0xbf7fc5[_0x5b9b8b(0x223)]),_0x5dddbe=_0xbf7fc5[_0x5b9b8b(0x1aa)],_0xf1abae=_0x5a0728-_0x5dddbe;_0x2dd72a+=_0xf1abae;}}const _0x48bce5=_0x321b35>0x0?_0x15dd9c/_0x321b35:0x0,_0x1d6ffc=this[_0x5b9b8b(0x20a)](_0x1c9549,_0x46c018,_0x578483),_0x15a2e0=await database_1[_0x5b9b8b(0x130)]['payment'][_0x5b9b8b(0x184)]({'where':{'createdAt':{'gte':_0x46c018},'gateway':{'not':_0x5b9b8b(0x1e5)}}}),_0x100d3f=_0x15a2e0>0x0?_0x321b35/_0x15a2e0*0x64:0x0;return{'totalShops':_0x3a2f14,'activeShops':_0x3c7057,'totalPayments':_0x321b35,'successfulPayments':_0x321b35,'totalAttempts':_0x15a2e0,'totalRevenue':Math[_0x5b9b8b(0x158)](_0x15dd9c*0x64)/0x64,'trapayEarnings':Math['round'](_0x2dd72a*0x64)/0x64,'averagePaymentAmount':Math[_0x5b9b8b(0x158)](_0x48bce5*0x64)/0x64,'conversionRate':Math[_0x5b9b8b(0x158)](_0x100d3f*0x64)/0x64,'dailyRevenue':_0x1d6ffc['dailyRevenue'],'dailyPayments':_0x1d6ffc['dailyPayments'],'recentPayments':_0x34efa0[_0x5b9b8b(0x1db)](_0x254217=>({'id':_0x254217['id'],'amount':_0x254217[_0x5b9b8b(0x233)],'currency':_0x254217[_0x5b9b8b(0x223)],'status':_0x254217[_0x5b9b8b(0x236)],'gateway':_0x254217[_0x5b9b8b(0x126)],'shop':_0x254217['shop'],'createdAt':_0x254217['createdAt']}))};}async[a36_0x69dc61(0x1ab)](_0x5df9e7){const _0x53191f=a36_0x69dc61;console[_0x53191f(0x211)]('📊\x20Getting\x20merchant\x20statistics\x20with\x20filters:',_0x5df9e7);let _0x2a7b2e,_0x4df9f0=new Date();if(_0x5df9e7[_0x53191f(0x170)]===_0x53191f(0x1e7)&&_0x5df9e7[_0x53191f(0x13a)]&&_0x5df9e7['dateTo'])_0x2a7b2e=new Date(_0x5df9e7['dateFrom']),_0x4df9f0=new Date(_0x5df9e7['dateTo']);else{const _0x37b952=new Date();switch(_0x5df9e7[_0x53191f(0x170)]){case _0x53191f(0x17a):_0x2a7b2e=new Date(_0x37b952[_0x53191f(0x1f1)]()-0x7*0x18*0x3c*0x3c*0x3e8);break;case _0x53191f(0x23c):_0x2a7b2e=new Date(_0x37b952[_0x53191f(0x1f1)]()-0x1e*0x18*0x3c*0x3c*0x3e8);break;case'year':_0x2a7b2e=new Date(_0x37b952[_0x53191f(0x1f1)]()-0x16d*0x18*0x3c*0x3c*0x3e8);break;case _0x53191f(0x112):default:_0x2a7b2e=new Date(_0x53191f(0x22a));break;}}console['log'](_0x53191f(0x150)+_0x2a7b2e[_0x53191f(0x115)]()+'\x20to\x20'+_0x4df9f0[_0x53191f(0x115)]());const _0x30c1cc={'status':'PAID','gateway':{'not':_0x53191f(0x1e5)},'paidAt':{'gte':_0x2a7b2e,'lte':_0x4df9f0}};_0x5df9e7[_0x53191f(0x159)]&&(_0x30c1cc['shopId']=_0x5df9e7[_0x53191f(0x159)]);const _0x319ece=await database_1[_0x53191f(0x130)][_0x53191f(0x230)]['findMany']({'where':_0x30c1cc,'include':{'shop':{'select':{'id':!![],'name':!![],'username':!![],'gatewaySettings':!![]}}}});console['log'](_0x53191f(0x204)+_0x319ece[_0x53191f(0x136)]+_0x53191f(0x157));const _0x5228ab={'gateway':{'not':_0x53191f(0x1e5)},'createdAt':{'gte':_0x2a7b2e,'lte':_0x4df9f0}};_0x5df9e7[_0x53191f(0x159)]&&(_0x5228ab[_0x53191f(0x159)]=_0x5df9e7[_0x53191f(0x159)]);const _0x59afdd=await database_1['default']['payment'][_0x53191f(0x184)]({'where':_0x5228ab});console[_0x53191f(0x211)](_0x53191f(0x114)+_0x59afdd+',\x20successful:\x20'+_0x319ece[_0x53191f(0x136)]);let _0x1db7d4=0x0,_0x1a320b=0x0,_0x2a6e0a=0x0;const _0x1c752a={},_0x46d063={},_0x38d5f2={};for(const _0x36d0e7 of _0x319ece){try{const _0x48d48f=await currencyService_1[_0x53191f(0x172)]['convertToUSDT'](_0x36d0e7[_0x53191f(0x233)],_0x36d0e7[_0x53191f(0x223)]);let _0x1072df={};if(_0x36d0e7[_0x53191f(0x23f)][_0x53191f(0x1bd)])try{_0x1072df=JSON[_0x53191f(0x1cb)](_0x36d0e7['shop']['gatewaySettings']);}catch(_0x19c824){console[_0x53191f(0x1f7)](_0x53191f(0x141)+_0x36d0e7[_0x53191f(0x159)]+':',_0x19c824);}let _0x1b5230={},_0x2e6f9b=0xa;for(const [_0x4cb4e1,_0x2dca4e]of Object[_0x53191f(0x232)](_0x1072df)){if(_0x4cb4e1['toLowerCase']()===_0x36d0e7['gateway']['toLowerCase']()){_0x1b5230=_0x2dca4e,_0x2e6f9b=_0x2dca4e[_0x53191f(0x1c6)]||0xa;break;}}let _0x2eb7bd,_0xb458f9;_0x36d0e7[_0x53191f(0x1aa)]!==null&&_0x36d0e7[_0x53191f(0x1aa)]!==undefined?(_0x2eb7bd=_0x36d0e7[_0x53191f(0x1aa)],_0xb458f9=_0x48d48f-_0x2eb7bd,console[_0x53191f(0x211)]('📊\x20Using\x20saved\x20amountAfterGatewayCommissionUSDT:\x20'+_0x2eb7bd['toFixed'](0x6)+_0x53191f(0x113)+_0x36d0e7['id'])):(_0xb458f9=_0x48d48f*(_0x2e6f9b/0x64),_0x2eb7bd=_0x48d48f-_0xb458f9,console['log'](_0x53191f(0x1ee)+_0x36d0e7['id']+':\x20'+_0x2e6f9b+_0x53191f(0x11b)+_0x48d48f[_0x53191f(0x1dc)](0x6)+'\x20USDT'));_0x1db7d4+=_0x48d48f,_0x1a320b+=_0x2eb7bd,_0x2a6e0a+=_0xb458f9;!_0x1c752a[_0x36d0e7['gateway']]&&(_0x1c752a[_0x36d0e7[_0x53191f(0x126)]]={'gateway':_0x36d0e7[_0x53191f(0x126)],'gatewayDisplayName':this['getGatewayDisplayName'](_0x36d0e7[_0x53191f(0x126)]),'paymentsCount':0x0,'turnoverUSDT':0x0,'commissionUSDT':0x0,'merchantEarningsUSDT':0x0,'totalCommissionRate':0x0});_0x1c752a[_0x36d0e7[_0x53191f(0x126)]][_0x53191f(0x11c)]++,_0x1c752a[_0x36d0e7[_0x53191f(0x126)]][_0x53191f(0x12b)]+=_0x48d48f,_0x1c752a[_0x36d0e7[_0x53191f(0x126)]][_0x53191f(0x1c9)]+=_0xb458f9,_0x1c752a[_0x36d0e7[_0x53191f(0x126)]][_0x53191f(0x1fb)]+=_0x2eb7bd,_0x1c752a[_0x36d0e7[_0x53191f(0x126)]][_0x53191f(0x11a)]+=_0x2e6f9b;!_0x5df9e7[_0x53191f(0x159)]&&(!_0x46d063[_0x36d0e7[_0x53191f(0x159)]]&&(_0x46d063[_0x36d0e7[_0x53191f(0x159)]]={'shopId':_0x36d0e7[_0x53191f(0x159)],'shopName':_0x36d0e7[_0x53191f(0x23f)][_0x53191f(0x101)],'shopUsername':_0x36d0e7[_0x53191f(0x23f)][_0x53191f(0x1bf)],'paymentsCount':0x0,'turnoverUSDT':0x0,'commissionUSDT':0x0,'merchantEarningsUSDT':0x0,'paidOutUSDT':0x0,'averageCheckUSDT':0x0}),_0x46d063[_0x36d0e7[_0x53191f(0x159)]]['paymentsCount']++,_0x46d063[_0x36d0e7[_0x53191f(0x159)]]['turnoverUSDT']+=_0x48d48f,_0x46d063[_0x36d0e7[_0x53191f(0x159)]][_0x53191f(0x1c9)]+=_0xb458f9,_0x46d063[_0x36d0e7[_0x53191f(0x159)]]['merchantEarningsUSDT']+=_0x2eb7bd);const _0x3175e7=_0x36d0e7[_0x53191f(0x1f8)][_0x53191f(0x115)]()[_0x53191f(0x220)]('T')[0x0];!_0x38d5f2[_0x3175e7]&&(_0x38d5f2[_0x3175e7]={'date':_0x3175e7,'turnover':0x0,'merchantEarnings':0x0,'gatewayEarnings':0x0,'paymentsCount':0x0}),_0x38d5f2[_0x3175e7]['turnover']+=_0x48d48f,_0x38d5f2[_0x3175e7]['merchantEarnings']+=_0x2eb7bd,_0x38d5f2[_0x3175e7][_0x53191f(0x1d5)]+=_0xb458f9,_0x38d5f2[_0x3175e7][_0x53191f(0x11c)]++;}catch(_0x151dab){console[_0x53191f(0x1f7)]('Error\x20processing\x20payment\x20'+_0x36d0e7['id']+':',_0x151dab);}}Object['values'](_0x1c752a)['forEach'](_0x42f726=>{const _0x12ce49=_0x53191f;_0x42f726[_0x12ce49(0x180)]=_0x42f726[_0x12ce49(0x11c)]>0x0?_0x42f726['totalCommissionRate']/_0x42f726[_0x12ce49(0x11c)]:0x0,delete _0x42f726[_0x12ce49(0x11a)];}),Object[_0x53191f(0x1cf)](_0x46d063)['forEach'](_0x531c61=>{const _0x50f9a9=_0x53191f;_0x531c61[_0x50f9a9(0x200)]=_0x531c61[_0x50f9a9(0x11c)]>0x0?_0x531c61['turnoverUSDT']/_0x531c61[_0x50f9a9(0x11c)]:0x0;});let _0x157819=0x0,_0x1b5ae7=0x0;if(_0x5df9e7[_0x53191f(0x159)]){const _0x5ece49=await database_1[_0x53191f(0x130)][_0x53191f(0x1ca)][_0x53191f(0x155)]({'where':{'shopId':_0x5df9e7['shopId'],'status':_0x53191f(0x1ed),'createdAt':{'gte':_0x2a7b2e,'lte':_0x4df9f0}},'select':{'amount':!![]}});_0x157819=_0x5ece49[_0x53191f(0x1e6)]((_0x10087d,_0x2fa7fd)=>_0x10087d+_0x2fa7fd[_0x53191f(0x233)],0x0);const _0x2ec820=await database_1['default'][_0x53191f(0x1ca)][_0x53191f(0x155)]({'where':{'shopId':_0x5df9e7[_0x53191f(0x159)],'status':'PENDING','createdAt':{'gte':_0x2a7b2e,'lte':_0x4df9f0}},'select':{'amount':!![]}});_0x1b5ae7=_0x2ec820[_0x53191f(0x1e6)]((_0x377b27,_0x3efec7)=>_0x377b27+_0x3efec7[_0x53191f(0x233)],0x0);}const _0x4706f7=_0x59afdd,_0x66991=_0x319ece[_0x53191f(0x136)],_0x160c01=_0x66991>0x0?_0x1db7d4/_0x66991:0x0,_0x1153f8=_0x4706f7>0x0?Math[_0x53191f(0x158)](_0x66991/_0x4706f7*0x2710)/0x64:0x0,_0x3f93a2=Math[_0x53191f(0x19c)]((_0x4df9f0['getTime']()-_0x2a7b2e['getTime']())/(0x3e8*0x3c*0x3c*0x18)),_0x2ed777={'totalTurnover':Math[_0x53191f(0x158)](_0x1db7d4*0x64)/0x64,'merchantEarnings':Math['round'](_0x1a320b*0x64)/0x64,'gatewayEarnings':Math[_0x53191f(0x158)](_0x2a6e0a*0x64)/0x64,'totalPaidOut':Math[_0x53191f(0x158)](_0x157819*0x64)/0x64,'pendingPayout':Math[_0x53191f(0x158)](_0x1b5ae7*0x64)/0x64,'averageCheck':Math[_0x53191f(0x158)](_0x160c01*0x64)/0x64,'totalPayments':_0x4706f7,'successfulPayments':_0x66991,'conversionRate':_0x1153f8,'gatewayBreakdown':Object[_0x53191f(0x1cf)](_0x1c752a)[_0x53191f(0x1db)](_0x3e3a84=>({..._0x3e3a84,'turnoverUSDT':Math[_0x53191f(0x158)](_0x3e3a84[_0x53191f(0x12b)]*0x64)/0x64,'commissionUSDT':Math['round'](_0x3e3a84['commissionUSDT']*0x64)/0x64,'merchantEarningsUSDT':Math[_0x53191f(0x158)](_0x3e3a84['merchantEarningsUSDT']*0x64)/0x64,'averageCommissionRate':Math[_0x53191f(0x158)](_0x3e3a84[_0x53191f(0x180)]*0x64)/0x64})),'merchantBreakdown':_0x5df9e7['shopId']?undefined:Object[_0x53191f(0x1cf)](_0x46d063)[_0x53191f(0x1db)](_0x4f137c=>({..._0x4f137c,'turnoverUSDT':Math[_0x53191f(0x158)](_0x4f137c[_0x53191f(0x12b)]*0x64)/0x64,'commissionUSDT':Math[_0x53191f(0x158)](_0x4f137c[_0x53191f(0x1c9)]*0x64)/0x64,'merchantEarningsUSDT':Math[_0x53191f(0x158)](_0x4f137c[_0x53191f(0x1fb)]*0x64)/0x64,'paidOutUSDT':Math[_0x53191f(0x158)](_0x4f137c['paidOutUSDT']*0x64)/0x64,'averageCheckUSDT':Math[_0x53191f(0x158)](_0x4f137c[_0x53191f(0x200)]*0x64)/0x64})),'dailyData':Object[_0x53191f(0x1cf)](_0x38d5f2)['map'](_0xcf5e91=>({..._0xcf5e91,'turnover':Math[_0x53191f(0x158)](_0xcf5e91['turnover']*0x64)/0x64,'merchantEarnings':Math[_0x53191f(0x158)](_0xcf5e91[_0x53191f(0x205)]*0x64)/0x64,'gatewayEarnings':Math[_0x53191f(0x158)](_0xcf5e91[_0x53191f(0x1d5)]*0x64)/0x64}))[_0x53191f(0x176)]((_0x3a91ce,_0x18dcee)=>_0x3a91ce[_0x53191f(0x1c7)][_0x53191f(0x165)](_0x18dcee[_0x53191f(0x1c7)])),'periodInfo':{'from':_0x2a7b2e,'to':_0x4df9f0,'periodType':_0x5df9e7[_0x53191f(0x170)]||_0x53191f(0x1e7),'daysCount':_0x3f93a2}};return console[_0x53191f(0x211)](_0x53191f(0x14f)),console[_0x53191f(0x211)](_0x53191f(0x219)+_0x2ed777[_0x53191f(0x16b)]+_0x53191f(0x17b)),console[_0x53191f(0x211)](_0x53191f(0x198)+_0x2ed777[_0x53191f(0x205)]+_0x53191f(0x17b)),console['log'](_0x53191f(0x166)+_0x2ed777[_0x53191f(0x1d5)]+_0x53191f(0x17b)),console[_0x53191f(0x211)](_0x53191f(0x192)+_0x2ed777['totalPaidOut']+_0x53191f(0x17b)),console['log'](_0x53191f(0x111)+_0x2ed777[_0x53191f(0x17e)]+'\x20USDT'),console[_0x53191f(0x211)]('\x20\x20\x20�📊\x20Total\x20payments:\x20'+_0x2ed777[_0x53191f(0x1f0)]),_0x2ed777;}async[a36_0x69dc61(0x1ae)](){const _0x3d963e=a36_0x69dc61;console['log'](_0x3d963e(0x164));const _0x173f24=await database_1[_0x3d963e(0x130)][_0x3d963e(0x23f)][_0x3d963e(0x155)]({'where':{'status':_0x3d963e(0x178)},'select':{'id':!![],'username':!![],'name':!![]},'orderBy':{'name':_0x3d963e(0x177)}});return console[_0x3d963e(0x211)](_0x3d963e(0x1a0)+_0x173f24[_0x3d963e(0x136)]+_0x3d963e(0x12f)),_0x173f24[_0x3d963e(0x1db)](_0x3296cc=>({'id':_0x3296cc['id'],'username':_0x3296cc[_0x3d963e(0x1bf)],'name':_0x3296cc[_0x3d963e(0x101)]}));}['getGatewayDisplayName'](_0x2d6a14){const _0x12a8af=a36_0x69dc61,_0x2bfcb6={'test_gateway':_0x12a8af(0x171),'plisio':_0x12a8af(0x1d1),'rapyd':_0x12a8af(0x100),'noda':_0x12a8af(0x196),'cointopay':_0x12a8af(0x1ac),'cointopay2':_0x12a8af(0x15c),'klyme_eu':_0x12a8af(0x174),'klyme_gb':_0x12a8af(0x10d),'klyme_de':_0x12a8af(0x1fd),'mastercard':'MasterCard'};return _0x2bfcb6[_0x2d6a14]||_0x2d6a14;}['getGatewayInternalName'](_0x59bf3b){const _0x53d109=a36_0x69dc61,_0x5e654f={'Test\x20Gateway':_0x53d109(0x1e5),'Plisio':_0x53d109(0x1c1),'Rapyd':'rapyd','Noda':_0x53d109(0x1d8),'CoinToPay':_0x53d109(0x1b0),'CoinToPay2':_0x53d109(0x240),'KLYME\x20EU':_0x53d109(0x18d),'KLYME\x20GB':'klyme_gb','KLYME\x20DE':_0x53d109(0x186),'MasterCard':_0x53d109(0x20d)};return _0x5e654f[_0x59bf3b]||_0x59bf3b[_0x53d109(0x14d)]();}async[a36_0x69dc61(0x1fe)](_0x59b2a9){const _0x301b0b=a36_0x69dc61,{page:_0x3fdfe9,limit:_0x159a11,minAmount:_0x43d2d9,search:_0x53c9ed}=_0x59b2a9,_0x1b78f2=(_0x3fdfe9-0x1)*_0x159a11;console[_0x301b0b(0x211)](_0x301b0b(0x1f5),_0x59b2a9);const _0x31b91f={'balance':{'gt':0x0},'status':_0x301b0b(0x178)};_0x43d2d9&&(_0x31b91f['balance'][_0x301b0b(0x1a7)]=_0x43d2d9);_0x53c9ed&&(_0x31b91f['OR']=[{'name':{'contains':_0x53c9ed,'mode':_0x301b0b(0x1da)}},{'username':{'contains':_0x53c9ed,'mode':_0x301b0b(0x1da)}}]);const [_0x5e12b3,_0x503a0f]=await Promise[_0x301b0b(0x112)]([database_1[_0x301b0b(0x130)]['shop'][_0x301b0b(0x155)]({'where':_0x31b91f,'skip':_0x1b78f2,'take':_0x159a11,'orderBy':{'balance':_0x301b0b(0x222)},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'balance':!![],'totalPaidOut':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'gatewaySettings':!![],'createdAt':!![]}}),database_1[_0x301b0b(0x130)][_0x301b0b(0x23f)]['count']({'where':_0x31b91f})]);console[_0x301b0b(0x211)]('💰\x20Found\x20'+_0x5e12b3[_0x301b0b(0x136)]+_0x301b0b(0x132));const _0x514c66=await Promise['all'](_0x5e12b3['map'](async _0x57353c=>{const _0x499ca0=_0x301b0b,[_0x22719c,_0x4e8b2e,_0x37bea0]=await Promise[_0x499ca0(0x112)]([database_1['default'][_0x499ca0(0x230)][_0x499ca0(0x184)]({'where':{'shopId':_0x57353c['id'],'status':_0x499ca0(0x1b6),'gateway':{'not':_0x499ca0(0x1e5)}}}),database_1[_0x499ca0(0x130)][_0x499ca0(0x230)][_0x499ca0(0x15e)]({'where':{'shopId':_0x57353c['id'],'status':_0x499ca0(0x1b6),'gateway':{'not':_0x499ca0(0x1e5)}},'orderBy':{'paidAt':'asc'},'select':{'paidAt':!![]}}),database_1['default'][_0x499ca0(0x230)][_0x499ca0(0x1b2)]({'by':[_0x499ca0(0x126)],'where':{'shopId':_0x57353c['id'],'status':_0x499ca0(0x1b6),'gateway':{'not':_0x499ca0(0x1e5)}},'_count':{'id':!![]},'_sum':{'amountUSDT':!![]}})]),_0x582179=new Date(),_0x40e637=new Date(_0x582179[_0x499ca0(0x1f4)](),_0x582179['getMonth'](),0x1),_0x4ca6a0=new Date(_0x582179['getFullYear'](),_0x582179[_0x499ca0(0x1a6)]()+0x1,0x0,0x17,0x3b,0x3b,0x3e7),[_0x339154,_0x3623fb]=await Promise[_0x499ca0(0x112)]([database_1[_0x499ca0(0x130)][_0x499ca0(0x1ca)][_0x499ca0(0x194)]({'_sum':{'amount':!![]},'where':{'shopId':_0x57353c['id'],'status':'COMPLETED'}}),database_1[_0x499ca0(0x130)]['payout']['aggregate']({'_sum':{'amount':!![]},'where':{'shopId':_0x57353c['id'],'status':_0x499ca0(0x1ed),'createdAt':{'gte':_0x40e637,'lte':_0x4ca6a0}}})]),_0x43e515=_0x339154[_0x499ca0(0x1e2)][_0x499ca0(0x233)]||0x0,_0x50d599=_0x3623fb[_0x499ca0(0x1e2)][_0x499ca0(0x233)]||0x0,_0x3bc415=await Promise['all'](_0x37bea0[_0x499ca0(0x1db)](async _0x5122b2=>{const _0xd2e166=_0x499ca0;let _0x4f7d27=0xa;if(_0x57353c[_0xd2e166(0x1bd)])try{const _0x328296=JSON[_0xd2e166(0x1cb)](_0x57353c[_0xd2e166(0x1bd)]);for(const [_0xe8ce48,_0x31cfba]of Object[_0xd2e166(0x232)](_0x328296)){if(_0xe8ce48[_0xd2e166(0x14d)]()===_0x5122b2['gateway'][_0xd2e166(0x14d)]()){_0x4f7d27=_0x31cfba[_0xd2e166(0x1c6)]||0xa,console['log'](_0xd2e166(0x22f)+_0x5122b2[_0xd2e166(0x126)]+_0xd2e166(0x181)+_0x57353c['id']+_0xd2e166(0x15a)+_0x4f7d27+'%');break;}}}catch(_0x597d35){console[_0xd2e166(0x1f7)](_0xd2e166(0x141)+_0x57353c['id']+':',_0x597d35);}const _0x2c8ab7=_0x5122b2[_0xd2e166(0x1e2)]?.[_0xd2e166(0x18f)]||0x0,_0x1e65f0=_0x2c8ab7*(0x1-_0x4f7d27/0x64);return{'gateway':_0x5122b2[_0xd2e166(0x126)],'count':_0x5122b2[_0xd2e166(0x107)]?.['id']||0x0,'amountUSDT':Math[_0xd2e166(0x158)](_0x2c8ab7*0x64)/0x64,'amountAfterCommissionUSDT':Math[_0xd2e166(0x158)](_0x1e65f0*0x64)/0x64,'commission':_0x4f7d27};})),_0x29c10b=_0x3bc415[_0x499ca0(0x1e6)]((_0x4e708c,_0x263c61)=>_0x4e708c+_0x263c61[_0x499ca0(0x18f)],0x0),_0x2b9399=_0x57353c[_0x499ca0(0x1d0)];return console[_0x499ca0(0x211)](_0x499ca0(0x14c)+_0x57353c[_0x499ca0(0x1bf)]+':'),console[_0x499ca0(0x211)](_0x499ca0(0x212)+_0x29c10b[_0x499ca0(0x1dc)](0x2)+'\x20USDT\x20(gross\x20revenue)'),console[_0x499ca0(0x211)](_0x499ca0(0x1f9)+_0x3bc415[_0x499ca0(0x1e6)]((_0x2a6d4d,_0x40f1ad)=>_0x2a6d4d+_0x40f1ad[_0x499ca0(0x1b7)],0x0)[_0x499ca0(0x1dc)](0x2)+'\x20USDT\x20(theoretical\x20net)'),console[_0x499ca0(0x211)](_0x499ca0(0x18e)+_0x2b9399['toFixed'](0x2)+_0x499ca0(0x13c)),{'id':_0x57353c['id'],'fullName':_0x57353c[_0x499ca0(0x101)],'username':_0x57353c[_0x499ca0(0x1bf)],'telegramId':_0x57353c[_0x499ca0(0x1ba)],'merchantUrl':_0x57353c[_0x499ca0(0x10a)],'wallets':{'usdtPolygonWallet':_0x57353c[_0x499ca0(0x1f2)],'usdtTrcWallet':_0x57353c['usdtTrcWallet'],'usdtErcWallet':_0x57353c[_0x499ca0(0x1a3)],'usdcPolygonWallet':_0x57353c['usdcPolygonWallet']},'totalAmountUSDT':Math[_0x499ca0(0x158)](_0x29c10b*0x64)/0x64,'totalAmountAfterCommissionUSDT':Math['round'](_0x2b9399*0x64)/0x64,'totalPayout':Math[_0x499ca0(0x158)](_0x43e515*0x64)/0x64,'thisMonth':Math['round'](_0x50d599*0x64)/0x64,'paymentsCount':_0x22719c,'oldestPaymentDate':_0x4e8b2e?.['paidAt']||_0x57353c[_0x499ca0(0x1a4)],'gatewayBreakdown':_0x3bc415};})),_0x5c50d6=_0x514c66[_0x301b0b(0x1e6)]((_0x5986f0,_0x3d687e)=>_0x5986f0+_0x3d687e[_0x301b0b(0x12d)],0x0),_0x3c80e7=_0x514c66['reduce']((_0x38bbe0,_0x245074)=>_0x38bbe0+_0x245074[_0x301b0b(0x17d)],0x0),_0x49bf53=_0x514c66['reduce']((_0x3fa207,_0x4fb57a)=>_0x3fa207+_0x4fb57a['totalPayout'],0x0),_0x2a446e=_0x514c66[_0x301b0b(0x1e6)]((_0xfd7886,_0x1559e7)=>_0xfd7886+_0x1559e7[_0x301b0b(0x13e)],0x0);return console[_0x301b0b(0x211)](_0x301b0b(0x21c)+_0x503a0f+_0x301b0b(0x123)),console[_0x301b0b(0x211)](_0x301b0b(0x1e3)+Math[_0x301b0b(0x158)](_0x5c50d6*0x64)/0x64+_0x301b0b(0x11f)),console[_0x301b0b(0x211)](_0x301b0b(0x202)+Math[_0x301b0b(0x158)](_0x3c80e7*0x64)/0x64+'\x20USDT\x20(actual\x20balances)'),console['log'](_0x301b0b(0x22c)+Math[_0x301b0b(0x158)](_0x49bf53*0x64)/0x64+'\x20USDT'),console[_0x301b0b(0x211)](_0x301b0b(0x21b)+Math[_0x301b0b(0x158)](_0x2a446e*0x64)/0x64+_0x301b0b(0x17b)),{'merchants':_0x514c66,'pagination':{'page':_0x3fdfe9,'limit':_0x159a11,'total':_0x503a0f,'totalPages':Math[_0x301b0b(0x19c)](_0x503a0f/_0x159a11)},'summary':{'totalMerchants':_0x503a0f,'totalAmountUSDT':Math[_0x301b0b(0x158)](_0x5c50d6*0x64)/0x64,'totalAmountAfterCommissionUSDT':Math[_0x301b0b(0x158)](_0x3c80e7*0x64)/0x64,'totalPayout':Math['round'](_0x49bf53*0x64)/0x64,'thisMonth':Math[_0x301b0b(0x158)](_0x2a446e*0x64)/0x64}};}async[a36_0x69dc61(0x195)](_0x135a03){const _0x1e2208=a36_0x69dc61,{shopId:_0x4bfc8f,amount:_0x4c530e,network:_0x429dcc,wallet:_0x29ee19,notes:_0x111a3c,txid:_0x56ece9,periodFrom:_0x5ace6f,periodTo:_0x350e89}=_0x135a03,_0x2e577b=await database_1['default'][_0x1e2208(0x18c)](async _0x585559=>{const _0x1ebf09=_0x1e2208,_0x44bdda=await _0x585559[_0x1ebf09(0x23f)][_0x1ebf09(0x104)]({'where':{'id':_0x4bfc8f},'select':{'id':!![],'name':!![],'username':!![],'balance':!![],'totalPaidOut':!![]}});if(!_0x44bdda)throw new Error('Shop\x20not\x20found');console['log'](_0x1ebf09(0x16a)+_0x44bdda[_0x1ebf09(0x1bf)]+':'),console[_0x1ebf09(0x211)](_0x1ebf09(0x1e8)+_0x44bdda[_0x1ebf09(0x1d0)][_0x1ebf09(0x1dc)](0x6)+_0x1ebf09(0x17b)),console['log'](_0x1ebf09(0x128)+_0x4c530e[_0x1ebf09(0x1dc)](0x6)+_0x1ebf09(0x17b)),console[_0x1ebf09(0x211)](_0x1ebf09(0x18b)+_0x44bdda['totalPaidOut']['toFixed'](0x6)+_0x1ebf09(0x17b));if(_0x56ece9)console['log'](_0x1ebf09(0x163)+_0x56ece9);if(_0x44bdda[_0x1ebf09(0x1d0)]<_0x4c530e)throw new Error('Insufficient\x20balance.\x20Available:\x20'+_0x44bdda['balance'][_0x1ebf09(0x1dc)](0x6)+_0x1ebf09(0x124)+_0x4c530e[_0x1ebf09(0x1dc)](0x6)+_0x1ebf09(0x17b));let _0x4abfcc=_0x29ee19;if(!_0x4abfcc){const _0x4143de=await _0x585559['shop'][_0x1ebf09(0x104)]({'where':{'id':_0x4bfc8f},'select':{'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![]}});if(_0x4143de)switch(_0x429dcc){case'polygon':_0x4abfcc=_0x4143de['usdtPolygonWallet']||undefined;break;case'trc20':_0x4abfcc=_0x4143de[_0x1ebf09(0x20e)]||undefined;break;case _0x1ebf09(0x1f6):_0x4abfcc=_0x4143de[_0x1ebf09(0x1a3)]||undefined;break;case'polygon_usdc':_0x4abfcc=_0x4143de['usdcPolygonWallet']||undefined;break;}}console[_0x1ebf09(0x211)]('💳\x20Payout\x20wallet\x20for\x20'+_0x429dcc+':\x20'+(_0x4abfcc||'not\x20specified'));const _0xde2141=await _0x585559[_0x1ebf09(0x1ca)][_0x1ebf09(0x146)]({'data':{'shopId':_0x4bfc8f,'amount':_0x4c530e,'network':_0x429dcc,'status':_0x1ebf09(0x1ed),'txid':_0x56ece9,'notes':_0x111a3c,'periodFrom':_0x5ace6f?new Date(_0x5ace6f):null,'periodTo':_0x350e89?new Date(_0x350e89):null,'createdAt':new Date(),'paidAt':new Date()}}),_0x365daa=_0x44bdda[_0x1ebf09(0x1d0)]-_0x4c530e,_0x5296e8=_0x44bdda[_0x1ebf09(0x142)]+_0x4c530e;return await _0x585559[_0x1ebf09(0x23f)][_0x1ebf09(0x22b)]({'where':{'id':_0x4bfc8f},'data':{'balance':_0x365daa,'totalPaidOut':_0x5296e8}}),console[_0x1ebf09(0x211)](_0x1ebf09(0x144)+_0x44bdda['username']+_0x1ebf09(0x140)),console['log'](_0x1ebf09(0x209)+_0x44bdda[_0x1ebf09(0x1d0)]['toFixed'](0x6)+'\x20->\x20'+_0x365daa[_0x1ebf09(0x1dc)](0x6)+'\x20USDT\x20(-'+_0x4c530e[_0x1ebf09(0x1dc)](0x6)+')'),console['log'](_0x1ebf09(0x1d2)+_0x44bdda[_0x1ebf09(0x142)][_0x1ebf09(0x1dc)](0x6)+_0x1ebf09(0x16d)+_0x5296e8[_0x1ebf09(0x1dc)](0x6)+_0x1ebf09(0x239)+_0x4c530e['toFixed'](0x6)+')'),{'payout':_0xde2141,'shop':_0x44bdda};});return console[_0x1e2208(0x211)](_0x1e2208(0x129)+_0x2e577b[_0x1e2208(0x1ca)]['id']+_0x1e2208(0x181)+_0x2e577b[_0x1e2208(0x23f)][_0x1e2208(0x1bf)]+'\x20('+_0x4c530e+'\x20USDT)'),{'id':_0x2e577b[_0x1e2208(0x1ca)]['id'],'shopId':_0x2e577b[_0x1e2208(0x1ca)][_0x1e2208(0x159)],'shopName':_0x2e577b[_0x1e2208(0x23f)][_0x1e2208(0x101)],'shopUsername':_0x2e577b[_0x1e2208(0x23f)][_0x1e2208(0x1bf)],'amount':_0x2e577b[_0x1e2208(0x1ca)]['amount'],'network':_0x2e577b[_0x1e2208(0x1ca)][_0x1e2208(0x183)],'status':_0x2e577b[_0x1e2208(0x1ca)][_0x1e2208(0x236)],'txid':_0x2e577b[_0x1e2208(0x1ca)]['txid'],'notes':_0x2e577b['payout'][_0x1e2208(0x12c)],'periodFrom':_0x2e577b[_0x1e2208(0x1ca)]['periodFrom'],'periodTo':_0x2e577b['payout'][_0x1e2208(0x1b1)],'createdAt':_0x2e577b['payout']['createdAt'],'paidAt':_0x2e577b['payout'][_0x1e2208(0x1f8)]};}async[a36_0x69dc61(0x215)](_0xd2ad85){const _0x44b349=a36_0x69dc61,{page:_0x46d173,limit:_0x902fb7,shopId:_0x32ba0f,network:_0x2bb7dd,dateFrom:_0x1d643d,dateTo:_0x4a7386,search:_0x494cf8}=_0xd2ad85,_0x3ec9d6=(_0x46d173-0x1)*_0x902fb7,_0x1fe233={};_0x32ba0f&&(_0x1fe233[_0x44b349(0x159)]=_0x32ba0f);_0x2bb7dd&&(_0x1fe233[_0x44b349(0x183)]=_0x2bb7dd);(_0x1d643d||_0x4a7386)&&(_0x1fe233[_0x44b349(0x1a4)]={},_0x1d643d&&(_0x1fe233[_0x44b349(0x1a4)]['gte']=new Date(_0x1d643d)),_0x4a7386&&(_0x1fe233[_0x44b349(0x1a4)][_0x44b349(0x10c)]=new Date(_0x4a7386)));_0x494cf8&&(_0x1fe233['OR']=[{'shop':{'name':{'contains':_0x494cf8,'mode':_0x44b349(0x1da)}}},{'shop':{'username':{'contains':_0x494cf8,'mode':_0x44b349(0x1da)}}},{'notes':{'contains':_0x494cf8,'mode':_0x44b349(0x1da)}}]);const [_0x1b8ae6,_0x6059e3]=await Promise[_0x44b349(0x112)]([database_1[_0x44b349(0x130)][_0x44b349(0x1ca)]['findMany']({'where':_0x1fe233,'skip':_0x3ec9d6,'take':_0x902fb7,'orderBy':{'createdAt':_0x44b349(0x222)},'select':{'id':!![],'shopId':!![],'amount':!![],'network':!![],'status':!![],'txid':!![],'notes':!![],'periodFrom':!![],'periodTo':!![],'createdAt':!![],'paidAt':!![],'shop':{'select':{'name':!![],'username':!![]}}}}),database_1[_0x44b349(0x130)][_0x44b349(0x1ca)][_0x44b349(0x184)]({'where':_0x1fe233})]);return{'payouts':_0x1b8ae6[_0x44b349(0x1db)](_0x53f8a7=>({'id':_0x53f8a7['id'],'shopId':_0x53f8a7[_0x44b349(0x159)],'shopName':_0x53f8a7[_0x44b349(0x23f)]['name'],'shopUsername':_0x53f8a7[_0x44b349(0x23f)][_0x44b349(0x1bf)],'amount':_0x53f8a7['amount'],'network':_0x53f8a7[_0x44b349(0x183)],'status':_0x53f8a7[_0x44b349(0x236)],'txid':_0x53f8a7[_0x44b349(0x11d)],'notes':_0x53f8a7['notes'],'periodFrom':_0x53f8a7[_0x44b349(0x102)],'periodTo':_0x53f8a7[_0x44b349(0x1b1)],'createdAt':_0x53f8a7['createdAt'],'paidAt':_0x53f8a7['paidAt']})),'pagination':{'page':_0x46d173,'limit':_0x902fb7,'total':_0x6059e3,'totalPages':Math['ceil'](_0x6059e3/_0x902fb7)}};}async[a36_0x69dc61(0x208)](_0x7f119d){const _0x7be25e=a36_0x69dc61,_0x3a8313=await database_1['default'][_0x7be25e(0x1ca)][_0x7be25e(0x104)]({'where':{'id':_0x7f119d},'include':{'shop':{'select':{'name':!![],'username':!![]}}}});if(!_0x3a8313)return null;return{'id':_0x3a8313['id'],'shopId':_0x3a8313[_0x7be25e(0x159)],'shopName':_0x3a8313[_0x7be25e(0x23f)][_0x7be25e(0x101)],'shopUsername':_0x3a8313[_0x7be25e(0x23f)][_0x7be25e(0x1bf)],'amount':_0x3a8313[_0x7be25e(0x233)],'network':_0x3a8313['network'],'status':_0x3a8313[_0x7be25e(0x236)],'txid':_0x3a8313[_0x7be25e(0x11d)],'notes':_0x3a8313[_0x7be25e(0x12c)],'periodFrom':_0x3a8313['periodFrom'],'periodTo':_0x3a8313[_0x7be25e(0x1b1)],'createdAt':_0x3a8313['createdAt'],'paidAt':_0x3a8313['paidAt']};}async['deletePayout'](_0x5374c7){const _0x5779f5=a36_0x69dc61;await database_1[_0x5779f5(0x130)]['payout'][_0x5779f5(0x131)]({'where':{'id':_0x5374c7}});}async[a36_0x69dc61(0x147)](_0x4582cf){const _0x4e45ce=a36_0x69dc61,{page:_0x536e1e,limit:_0x2e8ebf,status:_0x1305cf,gateway:_0x5b1749,shopId:_0x220f86,dateFrom:_0x4bae48,dateTo:_0x286174,search:_0x141649,currency:_0x712bbf,sortBy:_0x28592e,sortOrder:_0xd5813c}=_0x4582cf,_0x900fa8=(_0x536e1e-0x1)*_0x2e8ebf;console['log'](_0x4e45ce(0x14e),_0x4582cf);const _0x4db44c=await database_1[_0x4e45ce(0x130)][_0x4e45ce(0x230)][_0x4e45ce(0x1b2)]({'by':['gateway'],'_count':{'gateway':!![]}});console['log'](_0x4e45ce(0x1a5),_0x4db44c['map'](_0x4078ba=>_0x4078ba['gateway']+'\x20('+_0x4078ba[_0x4e45ce(0x107)][_0x4e45ce(0x126)]+_0x4e45ce(0x231)));if(_0x5b1749){const _0x13f7fb=_0x4db44c['some'](_0x13305d=>_0x13305d[_0x4e45ce(0x126)][_0x4e45ce(0x14d)]()===_0x5b1749['toLowerCase']());!_0x13f7fb&&_0x5b1749['toLowerCase']()!==_0x4e45ce(0x1e5)&&console[_0x4e45ce(0x211)](_0x4e45ce(0x1f3)+_0x5b1749+_0x4e45ce(0x1eb)+_0x4db44c[_0x4e45ce(0x1db)](_0x3255d7=>_0x3255d7[_0x4e45ce(0x126)])['join'](',\x20'));}const _0x36049c={};_0x1305cf&&(_0x36049c[_0x4e45ce(0x236)]=_0x1305cf[_0x4e45ce(0x15d)]());if(!_0x5b1749)_0x36049c[_0x4e45ce(0x126)]={'not':_0x4e45ce(0x1e5)};else{if(_0x5b1749&&(_0x5b1749[_0x4e45ce(0x14d)]()===_0x4e45ce(0x1e5)||_0x5b1749===_0x4e45ce(0x187)))_0x36049c[_0x4e45ce(0x126)]=_0x4e45ce(0x1e5);else{let _0x271b16=_0x5b1749;const _0x14c516=(0x0,gateway_1[_0x4e45ce(0x235)])(_0x5b1749);if(_0x14c516)_0x271b16=_0x14c516,console['log'](_0x4e45ce(0x1de)+_0x5b1749+_0x4e45ce(0x1a8)+_0x271b16+'\x27');else{const _0x3201bc=(0x0,gateway_1[_0x4e45ce(0x14b)])(_0x5b1749);if(_0x3201bc){const _0x229988=(0x0,gateway_1[_0x4e45ce(0x235)])(_0x3201bc);_0x229988&&(_0x271b16=_0x229988,console[_0x4e45ce(0x211)](_0x4e45ce(0x105)+_0x5b1749+_0x4e45ce(0x1cd)+_0x3201bc+_0x4e45ce(0x1c8)+_0x271b16+'\x27'));}else console[_0x4e45ce(0x211)](_0x4e45ce(0x120)+_0x5b1749+'\x27\x20as\x20is\x20(not\x20found\x20in\x20mappings)');}const _0x309343=await database_1[_0x4e45ce(0x130)][_0x4e45ce(0x230)][_0x4e45ce(0x184)]({'where':{'gateway':_0x271b16['toLowerCase']()},'take':0x1});_0x309343===0x0?(console[_0x4e45ce(0x211)](_0x4e45ce(0x12a)+_0x271b16+_0x4e45ce(0x145)+_0x5b1749+_0x4e45ce(0x152)),_0x36049c['gateway']=_0x4e45ce(0x1ce)):(_0x36049c[_0x4e45ce(0x126)]=_0x271b16[_0x4e45ce(0x14d)](),console['log'](_0x4e45ce(0x16c)+_0x271b16+_0x4e45ce(0x145)+_0x5b1749+'\x27)'));}}console[_0x4e45ce(0x211)](_0x4e45ce(0x122),_0x36049c['gateway']);_0x220f86&&(_0x36049c['shopId']=_0x220f86);_0x712bbf&&(_0x36049c[_0x4e45ce(0x223)]=_0x712bbf[_0x4e45ce(0x15d)](),console[_0x4e45ce(0x211)](_0x4e45ce(0x189)+_0x712bbf[_0x4e45ce(0x15d)]()));(_0x4bae48||_0x286174)&&(_0x36049c['createdAt']={},_0x4bae48&&(_0x36049c['createdAt'][_0x4e45ce(0x1a7)]=new Date(_0x4bae48)),_0x286174&&(_0x36049c['createdAt']['lte']=new Date(_0x286174)));_0x141649&&(_0x36049c['OR']=[{'id':{'contains':_0x141649,'mode':_0x4e45ce(0x1da)}},{'orderId':{'contains':_0x141649,'mode':_0x4e45ce(0x1da)}},{'gatewayOrderId':{'contains':_0x141649,'mode':_0x4e45ce(0x1da)}},{'customerEmail':{'contains':_0x141649,'mode':_0x4e45ce(0x1da)}},{'shop':{'name':{'contains':_0x141649,'mode':'insensitive'}}},{'shop':{'username':{'contains':_0x141649,'mode':_0x4e45ce(0x1da)}}}]);console['log'](_0x4e45ce(0x1e0),JSON[_0x4e45ce(0x1e4)](_0x36049c,null,0x2));let _0xaf07c8={'createdAt':'desc'};if(_0x28592e){const _0x2a1f55=['amount',_0x4e45ce(0x1a4),_0x4e45ce(0x151),_0x4e45ce(0x236),_0x4e45ce(0x126),'currency'],_0x27296d=['asc',_0x4e45ce(0x222)];if(_0x2a1f55[_0x4e45ce(0x16f)](_0x28592e)){const _0x201906=_0x27296d[_0x4e45ce(0x16f)](_0xd5813c)?_0xd5813c:_0x4e45ce(0x222);_0xaf07c8={[_0x28592e]:_0x201906},console[_0x4e45ce(0x211)](_0x4e45ce(0x229)+_0x28592e+_0x4e45ce(0x139)+_0x201906+_0x4e45ce(0x199));}}const [_0x965a97,_0xbeae85]=await Promise['all']([database_1[_0x4e45ce(0x130)][_0x4e45ce(0x230)][_0x4e45ce(0x155)]({'where':_0x36049c,'skip':_0x900fa8,'take':_0x2e8ebf,'orderBy':_0xaf07c8,'select':{'id':!![],'shopId':!![],'amount':!![],'amountAfterGatewayCommissionUSDT':!![],'currency':!![],'sourceCurrency':!![],'status':!![],'gateway':!![],'orderId':!![],'gatewayOrderId':!![],'gatewayPaymentId':!![],'customerEmail':!![],'customerName':!![],'customerCountry':!![],'customerIp':!![],'customerUa':!![],'externalPaymentUrl':!![],'successUrl':!![],'failUrl':!![],'pendingUrl':!![],'whiteUrl':!![],'expiresAt':!![],'invoiceTotalSum':!![],'qrCode':!![],'qrUrl':!![],'country':!![],'language':!![],'amountIsEditable':!![],'maxPayments':!![],'rapydCustomer':!![],'cardLast4':!![],'paymentMethod':!![],'bankId':!![],'remitterIban':!![],'remitterName':!![],'failureMessage':!![],'usage':!![],'createdAt':!![],'updatedAt':!![],'shop':{'select':{'name':!![],'username':!![]}}}}),database_1['default'][_0x4e45ce(0x230)]['count']({'where':_0x36049c})]);return{'payments':_0x965a97,'pagination':{'page':_0x536e1e,'limit':_0x2e8ebf,'total':_0xbeae85,'totalPages':Math[_0x4e45ce(0x19c)](_0xbeae85/_0x2e8ebf)}};}async[a36_0x69dc61(0x169)](_0x2cbb5e){const _0x324f98=a36_0x69dc61,_0x1ba0b3=await database_1[_0x324f98(0x130)][_0x324f98(0x230)][_0x324f98(0x104)]({'where':{'id':_0x2cbb5e},'select':{'id':!![],'shopId':!![],'amount':!![],'amountAfterGatewayCommissionUSDT':!![],'currency':!![],'sourceCurrency':!![],'status':!![],'gateway':!![],'orderId':!![],'gatewayOrderId':!![],'gatewayPaymentId':!![],'customerEmail':!![],'customerName':!![],'customerCountry':!![],'customerIp':!![],'customerUa':!![],'externalPaymentUrl':!![],'successUrl':!![],'failUrl':!![],'pendingUrl':!![],'whiteUrl':!![],'expiresAt':!![],'invoiceTotalSum':!![],'qrCode':!![],'qrUrl':!![],'country':!![],'language':!![],'amountIsEditable':!![],'maxPayments':!![],'rapydCustomer':!![],'cardLast4':!![],'paymentMethod':!![],'bankId':!![],'remitterIban':!![],'remitterName':!![],'failureMessage':!![],'usage':!![],'createdAt':!![],'updatedAt':!![],'shop':{'select':{'name':!![],'username':!![]}}}});if(!_0x1ba0b3)return null;return{'id':_0x1ba0b3['id'],'shopId':_0x1ba0b3[_0x324f98(0x159)],'gateway':_0x1ba0b3['gateway'],'amount':_0x1ba0b3[_0x324f98(0x233)],'currency':_0x1ba0b3[_0x324f98(0x223)],'status':_0x1ba0b3[_0x324f98(0x236)],'orderId':_0x1ba0b3[_0x324f98(0x23e)],'gatewayOrderId':_0x1ba0b3[_0x324f98(0x227)],'customerEmail':_0x1ba0b3[_0x324f98(0x193)],'customerName':_0x1ba0b3[_0x324f98(0x1d3)],'customerCountry':_0x1ba0b3[_0x324f98(0x1c0)],'customerIp':_0x1ba0b3[_0x324f98(0x1fa)],'customerUa':_0x1ba0b3[_0x324f98(0x137)],'failureMessage':_0x1ba0b3[_0x324f98(0x135)],'externalPaymentUrl':_0x1ba0b3[_0x324f98(0x11e)],'successUrl':_0x1ba0b3[_0x324f98(0x207)],'failUrl':_0x1ba0b3[_0x324f98(0x21e)],'pendingUrl':_0x1ba0b3[_0x324f98(0x149)],'whiteUrl':_0x1ba0b3[_0x324f98(0x127)],'createdAt':_0x1ba0b3[_0x324f98(0x1a4)],'updatedAt':_0x1ba0b3[_0x324f98(0x151)],'shop':_0x1ba0b3[_0x324f98(0x23f)]};}async['updatePaymentStatus'](_0x2153e3,_0x1ff28f,_0x2f7af9,_0x353cca){const _0x79be78=a36_0x69dc61,_0x2f18cc=await database_1['default'][_0x79be78(0x18c)](async _0x4c517c=>{const _0x41c32d=_0x79be78,_0x3dfdf0=await _0x4c517c['payment'][_0x41c32d(0x104)]({'where':{'id':_0x2153e3},'include':{'shop':{'select':{'id':!![],'name':!![],'username':!![],'balance':!![]}}}});if(!_0x3dfdf0)throw new Error('Payment\x20not\x20found');const _0x3219fe=_0x3dfdf0[_0x41c32d(0x236)],_0x469385=_0x1ff28f[_0x41c32d(0x15d)]();console['log'](_0x41c32d(0x14a)+_0x2153e3+'\x20status:\x20'+_0x3219fe+_0x41c32d(0x16d)+_0x469385),console[_0x41c32d(0x211)](_0x41c32d(0x20f)+_0x3dfdf0[_0x41c32d(0x23f)][_0x41c32d(0x1d0)]+'\x20USDT');const _0x22b89e={'status':_0x469385,'updatedAt':new Date(),'statusChangedBy':_0x41c32d(0x1a1),'statusChangedAt':new Date()};_0x2f7af9&&(_0x22b89e[_0x41c32d(0x213)]=_0x2f7af9);_0x469385===_0x41c32d(0x238)&&_0x353cca&&(_0x22b89e['chargebackAmount']=_0x353cca);let _0x104b9=0x0,_0x44512a=_0x3dfdf0['shop'][_0x41c32d(0x1d0)];if(_0x469385==='PAID'&&_0x3219fe!==_0x41c32d(0x1b6)){_0x22b89e['paidAt']=new Date();const _0x2a86f0=await currencyService_1[_0x41c32d(0x172)]['convertToUSDT'](_0x3dfdf0[_0x41c32d(0x233)],_0x3dfdf0['currency']);_0x22b89e[_0x41c32d(0x18f)]=_0x2a86f0;let _0x1f6f39=0xa;const _0x1ca559=await _0x4c517c[_0x41c32d(0x23f)][_0x41c32d(0x104)]({'where':{'id':_0x3dfdf0[_0x41c32d(0x159)]},'select':{'gatewaySettings':!![]}});if(_0x1ca559?.[_0x41c32d(0x1bd)])try{const _0x89bd54=JSON['parse'](_0x1ca559['gatewaySettings']);for(const [_0x358c45,_0x4d4120]of Object[_0x41c32d(0x232)](_0x89bd54)){if(_0x358c45['toLowerCase']()===_0x3dfdf0['gateway']['toLowerCase']()){_0x1f6f39=_0x4d4120[_0x41c32d(0x1c6)]||0xa;break;}}}catch(_0x48369a){console[_0x41c32d(0x1f7)](_0x41c32d(0x162)+_0x2153e3+':',_0x48369a);}let _0x369598;_0x3dfdf0[_0x41c32d(0x1aa)]!==null&&_0x3dfdf0[_0x41c32d(0x1aa)]!==undefined?(_0x369598=_0x3dfdf0[_0x41c32d(0x1aa)],console['log']('📊\x20[ADMIN]\x20Using\x20saved\x20amountAfterGatewayCommissionUSDT:\x20'+_0x369598['toFixed'](0x6)+'\x20USDT\x20for\x20payment\x20'+_0x2153e3)):(_0x369598=_0x2a86f0*(0x1-_0x1f6f39/0x64),console[_0x41c32d(0x211)]('📊\x20[ADMIN]\x20Calculating\x20commission\x20manually\x20for\x20payment\x20'+_0x2153e3+':\x20'+_0x1f6f39+_0x41c32d(0x11b)+_0x2a86f0[_0x41c32d(0x1dc)](0x6)+_0x41c32d(0x17b)),_0x22b89e[_0x41c32d(0x1aa)]=_0x369598),_0x104b9=_0x369598,_0x44512a+=_0x369598,console['log'](_0x41c32d(0x22d)+_0x2153e3+'\x20became\x20PAID:'),console[_0x41c32d(0x211)]('\x20\x20\x20Full\x20amount:\x20'+_0x2a86f0[_0x41c32d(0x1dc)](0x6)+_0x41c32d(0x17b)),console[_0x41c32d(0x211)](_0x41c32d(0x16e)+_0x3dfdf0[_0x41c32d(0x126)]+_0x41c32d(0x18a)+_0x1f6f39+'%'),console['log'](_0x41c32d(0x168)+_0x369598[_0x41c32d(0x1dc)](0x6)+_0x41c32d(0x1df)+_0x1f6f39+_0x41c32d(0x1ec)),console['log']('\x20\x20\x20Added\x20to\x20balance:\x20+'+_0x369598[_0x41c32d(0x1dc)](0x6)+_0x41c32d(0x17b));}else{if(_0x3219fe===_0x41c32d(0x1b6)&&_0x469385!==_0x41c32d(0x1b6)){if(_0x3dfdf0[_0x41c32d(0x18f)]){let _0x23b1c9=0xa;const _0x32ac46=await _0x4c517c[_0x41c32d(0x23f)]['findUnique']({'where':{'id':_0x3dfdf0[_0x41c32d(0x159)]},'select':{'gatewaySettings':!![]}});if(_0x32ac46?.['gatewaySettings'])try{const _0x4f8786=JSON[_0x41c32d(0x1cb)](_0x32ac46[_0x41c32d(0x1bd)]);for(const [_0x402be0,_0x2d51a3]of Object['entries'](_0x4f8786)){if(_0x402be0[_0x41c32d(0x14d)]()===_0x3dfdf0[_0x41c32d(0x126)][_0x41c32d(0x14d)]()){_0x23b1c9=_0x2d51a3['commission']||0xa;break;}}}catch(_0x49207f){console[_0x41c32d(0x1f7)](_0x41c32d(0x162)+_0x2153e3+':',_0x49207f);}const _0x3874e3=_0x3dfdf0[_0x41c32d(0x18f)]*(0x1-_0x23b1c9/0x64);_0x104b9=-_0x3874e3,_0x44512a-=_0x3874e3,_0x22b89e[_0x41c32d(0x18f)]=null,_0x22b89e[_0x41c32d(0x1aa)]=null,console[_0x41c32d(0x211)](_0x41c32d(0x22d)+_0x2153e3+_0x41c32d(0x156)),console[_0x41c32d(0x211)](_0x41c32d(0x1a9)+_0x3dfdf0[_0x41c32d(0x18f)][_0x41c32d(0x1dc)](0x6)+'\x20USDT'),console[_0x41c32d(0x211)](_0x41c32d(0x16e)+_0x3dfdf0[_0x41c32d(0x126)]+_0x41c32d(0x18a)+_0x23b1c9+'%'),console[_0x41c32d(0x211)](_0x41c32d(0x10f)+_0x3874e3[_0x41c32d(0x1dc)](0x6)+_0x41c32d(0x1df)+_0x23b1c9+'%\x20commission)'),console[_0x41c32d(0x211)](_0x41c32d(0x121)+_0x3874e3[_0x41c32d(0x1dc)](0x6)+_0x41c32d(0x17b));}}}_0x469385==='CHARGEBACK'&&(_0x3219fe===_0x41c32d(0x1b6)&&_0x3dfdf0[_0x41c32d(0x18f)]&&console[_0x41c32d(0x211)](_0x41c32d(0x134)),_0x353cca&&_0x353cca>0x0&&(_0x104b9-=_0x353cca,_0x44512a-=_0x353cca,console[_0x41c32d(0x211)](_0x41c32d(0x175)+_0x353cca[_0x41c32d(0x1dc)](0x6)+_0x41c32d(0x109))));_0x469385===_0x41c32d(0x12e)&&_0x3219fe==='PAID'&&console[_0x41c32d(0x211)](_0x41c32d(0x154));const _0x42dd8c=await _0x4c517c[_0x41c32d(0x230)]['update']({'where':{'id':_0x2153e3},'data':_0x22b89e,'include':{'shop':{'select':{'name':!![],'username':!![]}}}});return _0x104b9!==0x0&&(await _0x4c517c['shop'][_0x41c32d(0x22b)]({'where':{'id':_0x3dfdf0[_0x41c32d(0x159)]},'data':{'balance':_0x44512a}}),console['log'](_0x41c32d(0x144)+_0x3dfdf0[_0x41c32d(0x159)]+'\x20balance\x20updated:\x20'+_0x3dfdf0[_0x41c32d(0x23f)]['balance'][_0x41c32d(0x1dc)](0x6)+_0x41c32d(0x16d)+_0x44512a['toFixed'](0x6)+_0x41c32d(0x23d)+(_0x104b9>0x0?'+':'')+_0x104b9[_0x41c32d(0x1dc)](0x6)+')')),_0x42dd8c;});return{'id':_0x2f18cc['id'],'shopId':_0x2f18cc[_0x79be78(0x159)],'gateway':_0x2f18cc[_0x79be78(0x126)],'amount':_0x2f18cc[_0x79be78(0x233)],'currency':_0x2f18cc[_0x79be78(0x223)],'status':_0x2f18cc[_0x79be78(0x236)],'orderId':_0x2f18cc[_0x79be78(0x23e)],'gatewayOrderId':_0x2f18cc[_0x79be78(0x227)],'customerEmail':_0x2f18cc[_0x79be78(0x193)],'customerName':_0x2f18cc[_0x79be78(0x1d3)],'customerCountry':_0x2f18cc[_0x79be78(0x1c0)],'customerIp':_0x2f18cc[_0x79be78(0x1fa)],'customerUa':_0x2f18cc[_0x79be78(0x137)],'failureMessage':_0x2f18cc[_0x79be78(0x135)],'adminNotes':_0x2f18cc[_0x79be78(0x213)],'chargebackAmount':_0x2f18cc['chargebackAmount'],'statusChangedBy':_0x2f18cc[_0x79be78(0x1d7)],'statusChangedAt':_0x2f18cc[_0x79be78(0x23b)],'createdAt':_0x2f18cc[_0x79be78(0x1a4)],'updatedAt':_0x2f18cc[_0x79be78(0x151)],'shop':_0x2f18cc[_0x79be78(0x23f)]};}async['updateUser'](_0x1b4738,_0x6372ee){const _0x3fc939=a36_0x69dc61,_0x4500c4=Math[_0x3fc939(0x1dd)]()[_0x3fc939(0x21f)](0x24)[_0x3fc939(0x108)](0x2,0x9);console[_0x3fc939(0x211)](_0x3fc939(0x225)+_0x4500c4+_0x3fc939(0x1d4)+_0x1b4738);const _0x555fe9={..._0x6372ee};_0x6372ee['password']&&_0x6372ee[_0x3fc939(0x1b9)]['trim']()!==''?(console[_0x3fc939(0x211)](_0x3fc939(0x21a)+_0x4500c4+_0x3fc939(0x106)+_0x1b4738),_0x555fe9[_0x3fc939(0x1b9)]=await bcryptjs_1[_0x3fc939(0x130)][_0x3fc939(0x17f)](_0x6372ee['password'],0xc)):(console[_0x3fc939(0x211)](_0x3fc939(0x21a)+_0x4500c4+_0x3fc939(0x13b)),delete _0x555fe9[_0x3fc939(0x1b9)]);_0x6372ee[_0x3fc939(0x173)]&&(_0x555fe9[_0x3fc939(0x101)]=_0x6372ee['fullName'],delete _0x555fe9[_0x3fc939(0x173)]);_0x6372ee[_0x3fc939(0x221)]&&(_0x555fe9[_0x3fc939(0x1ba)]=_0x6372ee[_0x3fc939(0x221)],delete _0x555fe9[_0x3fc939(0x221)]);_0x6372ee[_0x3fc939(0x203)]&&(_0x555fe9[_0x3fc939(0x10a)]=_0x6372ee[_0x3fc939(0x203)],delete _0x555fe9[_0x3fc939(0x203)]);if(_0x6372ee['gateways']){const _0xc02bf8=_0x6372ee[_0x3fc939(0x1ff)]['map'](_0x506883=>this[_0x3fc939(0x1fc)](_0x506883));console[_0x3fc939(0x211)](_0x3fc939(0x125),_0x6372ee[_0x3fc939(0x1ff)],'->',_0xc02bf8),_0x555fe9[_0x3fc939(0x1be)]=JSON[_0x3fc939(0x1e4)](_0xc02bf8),delete _0x555fe9[_0x3fc939(0x1ff)];}_0x6372ee['gatewaySettings']&&(console[_0x3fc939(0x211)](_0x3fc939(0x217)+_0x4500c4+_0x3fc939(0x1b4),_0x6372ee['gatewaySettings']),_0x555fe9[_0x3fc939(0x1bd)]=JSON['stringify'](_0x6372ee[_0x3fc939(0x1bd)]),console['log'](_0x3fc939(0x217)+_0x4500c4+_0x3fc939(0x23a),_0x555fe9[_0x3fc939(0x1bd)]));_0x6372ee[_0x3fc939(0x118)]&&(_0x6372ee[_0x3fc939(0x118)][_0x3fc939(0x1f2)]!==undefined&&(_0x555fe9[_0x3fc939(0x1f2)]=_0x6372ee[_0x3fc939(0x118)][_0x3fc939(0x1f2)]||null),_0x6372ee[_0x3fc939(0x118)][_0x3fc939(0x20e)]!==undefined&&(_0x555fe9['usdtTrcWallet']=_0x6372ee['wallets']['usdtTrcWallet']||null),_0x6372ee[_0x3fc939(0x118)][_0x3fc939(0x1a3)]!==undefined&&(_0x555fe9['usdtErcWallet']=_0x6372ee[_0x3fc939(0x118)]['usdtErcWallet']||null),_0x6372ee[_0x3fc939(0x118)][_0x3fc939(0x20b)]!==undefined&&(_0x555fe9[_0x3fc939(0x20b)]=_0x6372ee[_0x3fc939(0x118)][_0x3fc939(0x20b)]||null),delete _0x555fe9['wallets']);const _0x820e81=await database_1['default'][_0x3fc939(0x23f)][_0x3fc939(0x22b)]({'where':{'id':_0x1b4738},'data':_0x555fe9,'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});return console[_0x3fc939(0x211)]('🎯\x20['+_0x4500c4+_0x3fc939(0x1ef),_0x820e81[_0x3fc939(0x1bd)]),{'id':_0x820e81['id'],'fullName':_0x820e81[_0x3fc939(0x101)],'username':_0x820e81[_0x3fc939(0x1bf)],'telegramId':_0x820e81[_0x3fc939(0x1ba)],'merchantUrl':_0x820e81['shopUrl'],'gateways':_0x820e81[_0x3fc939(0x1be)]?JSON[_0x3fc939(0x1cb)](_0x820e81[_0x3fc939(0x1be)]):null,'gatewaySettings':_0x820e81[_0x3fc939(0x1bd)]?JSON[_0x3fc939(0x1cb)](_0x820e81[_0x3fc939(0x1bd)]):null,'publicKey':_0x820e81['publicKey'],'wallets':{'usdtPolygonWallet':_0x820e81[_0x3fc939(0x1f2)],'usdtTrcWallet':_0x820e81[_0x3fc939(0x20e)],'usdtErcWallet':_0x820e81[_0x3fc939(0x1a3)],'usdcPolygonWallet':_0x820e81[_0x3fc939(0x20b)]},'status':_0x820e81[_0x3fc939(0x236)],'createdAt':_0x820e81[_0x3fc939(0x1a4)]};}async[a36_0x69dc61(0x218)](_0x3089e8){const _0x43b3ea=a36_0x69dc61,_0x16e27e=await database_1[_0x43b3ea(0x130)]['shop'][_0x43b3ea(0x22b)]({'where':{'id':_0x3089e8},'data':{'status':_0x43b3ea(0x1af)},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});return{'id':_0x16e27e['id'],'fullName':_0x16e27e[_0x43b3ea(0x101)],'username':_0x16e27e[_0x43b3ea(0x1bf)],'telegramId':_0x16e27e[_0x43b3ea(0x1ba)],'merchantUrl':_0x16e27e['shopUrl'],'gateways':_0x16e27e[_0x43b3ea(0x1be)]?JSON['parse'](_0x16e27e[_0x43b3ea(0x1be)]):null,'gatewaySettings':_0x16e27e['gatewaySettings']?JSON[_0x43b3ea(0x1cb)](_0x16e27e['gatewaySettings']):null,'publicKey':_0x16e27e[_0x43b3ea(0x1c5)],'wallets':{'usdtPolygonWallet':_0x16e27e[_0x43b3ea(0x1f2)],'usdtTrcWallet':_0x16e27e[_0x43b3ea(0x20e)],'usdtErcWallet':_0x16e27e[_0x43b3ea(0x1a3)],'usdcPolygonWallet':_0x16e27e[_0x43b3ea(0x20b)]},'status':_0x16e27e[_0x43b3ea(0x236)],'createdAt':_0x16e27e[_0x43b3ea(0x1a4)]};}async[a36_0x69dc61(0x19e)](_0x47c9ca){const _0x3d223d=a36_0x69dc61,_0x501513=await database_1[_0x3d223d(0x130)][_0x3d223d(0x23f)]['update']({'where':{'id':_0x47c9ca},'data':{'status':'ACTIVE'},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});return{'id':_0x501513['id'],'fullName':_0x501513[_0x3d223d(0x101)],'username':_0x501513[_0x3d223d(0x1bf)],'telegramId':_0x501513[_0x3d223d(0x1ba)],'merchantUrl':_0x501513[_0x3d223d(0x10a)],'gateways':_0x501513['paymentGateways']?JSON[_0x3d223d(0x1cb)](_0x501513[_0x3d223d(0x1be)]):null,'gatewaySettings':_0x501513[_0x3d223d(0x1bd)]?JSON[_0x3d223d(0x1cb)](_0x501513['gatewaySettings']):null,'publicKey':_0x501513[_0x3d223d(0x1c5)],'wallets':{'usdtPolygonWallet':_0x501513[_0x3d223d(0x1f2)],'usdtTrcWallet':_0x501513[_0x3d223d(0x20e)],'usdtErcWallet':_0x501513[_0x3d223d(0x1a3)],'usdcPolygonWallet':_0x501513[_0x3d223d(0x20b)]},'status':_0x501513[_0x3d223d(0x236)],'createdAt':_0x501513[_0x3d223d(0x1a4)]};}async[a36_0x69dc61(0x1d6)](_0x53dcb9){const _0x4530b1=a36_0x69dc61,{page:_0x1164b2,limit:_0x4ae4bf,status:_0x450f5c}=_0x53dcb9,_0x45287b=(_0x1164b2-0x1)*_0x4ae4bf,_0x232915={};_0x450f5c&&(_0x232915[_0x4530b1(0x236)]=_0x450f5c[_0x4530b1(0x15d)]());const [_0x1a405e,_0x5c3a6a]=await Promise[_0x4530b1(0x112)]([database_1[_0x4530b1(0x130)][_0x4530b1(0x23f)]['findMany']({'where':_0x232915,'skip':_0x45287b,'take':_0x4ae4bf,'orderBy':{'createdAt':_0x4530b1(0x222)},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}}),database_1[_0x4530b1(0x130)]['shop'][_0x4530b1(0x184)]({'where':_0x232915})]);return{'users':_0x1a405e[_0x4530b1(0x1db)](_0x5b6fb7=>{const _0x57d193=_0x4530b1,_0x129eab=_0x5b6fb7[_0x57d193(0x1be)]?JSON[_0x57d193(0x1cb)](_0x5b6fb7[_0x57d193(0x1be)]):null,_0x5c665e=_0x129eab?_0x129eab[_0x57d193(0x1db)](_0x1a81cf=>this[_0x57d193(0x226)](_0x1a81cf)):null;return{'id':_0x5b6fb7['id'],'fullName':_0x5b6fb7[_0x57d193(0x101)],'username':_0x5b6fb7[_0x57d193(0x1bf)],'telegramId':_0x5b6fb7[_0x57d193(0x1ba)],'merchantUrl':_0x5b6fb7[_0x57d193(0x10a)],'gateways':_0x5c665e,'gatewaySettings':_0x5b6fb7['gatewaySettings']?JSON[_0x57d193(0x1cb)](_0x5b6fb7[_0x57d193(0x1bd)]):null,'publicKey':_0x5b6fb7[_0x57d193(0x1c5)],'wallets':{'usdtPolygonWallet':_0x5b6fb7['usdtPolygonWallet'],'usdtTrcWallet':_0x5b6fb7[_0x57d193(0x20e)],'usdtErcWallet':_0x5b6fb7['usdtErcWallet'],'usdcPolygonWallet':_0x5b6fb7[_0x57d193(0x20b)]},'status':_0x5b6fb7['status'],'createdAt':_0x5b6fb7['createdAt']};}),'pagination':{'page':_0x1164b2,'limit':_0x4ae4bf,'total':_0x5c3a6a,'totalPages':Math[_0x4530b1(0x19c)](_0x5c3a6a/_0x4ae4bf)}};}async[a36_0x69dc61(0x1c3)](_0x563e50){const _0x2c60f4=a36_0x69dc61,_0x466303=await database_1[_0x2c60f4(0x130)][_0x2c60f4(0x23f)][_0x2c60f4(0x104)]({'where':{'id':_0x563e50},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});if(!_0x466303)return null;const _0x4266d3=_0x466303[_0x2c60f4(0x1be)]?JSON['parse'](_0x466303[_0x2c60f4(0x1be)]):null,_0xc8d545=_0x4266d3?_0x4266d3[_0x2c60f4(0x1db)](_0x55efea=>this['getGatewayDisplayName'](_0x55efea)):null;return _0x4266d3&&_0xc8d545&&console[_0x2c60f4(0x211)](_0x2c60f4(0x1bb),_0x4266d3,'->',_0xc8d545),{'id':_0x466303['id'],'fullName':_0x466303[_0x2c60f4(0x101)],'username':_0x466303[_0x2c60f4(0x1bf)],'telegramId':_0x466303[_0x2c60f4(0x1ba)],'merchantUrl':_0x466303[_0x2c60f4(0x10a)],'gateways':_0xc8d545,'gatewaySettings':_0x466303[_0x2c60f4(0x1bd)]?JSON[_0x2c60f4(0x1cb)](_0x466303[_0x2c60f4(0x1bd)]):null,'publicKey':_0x466303[_0x2c60f4(0x1c5)],'wallets':{'usdtPolygonWallet':_0x466303[_0x2c60f4(0x1f2)],'usdtTrcWallet':_0x466303[_0x2c60f4(0x20e)],'usdtErcWallet':_0x466303[_0x2c60f4(0x1a3)],'usdcPolygonWallet':_0x466303[_0x2c60f4(0x20b)]},'status':_0x466303[_0x2c60f4(0x236)],'createdAt':_0x466303[_0x2c60f4(0x1a4)]};}async[a36_0x69dc61(0x148)](_0x166161){const _0x5d1bb2=a36_0x69dc61,{fullName:_0x59c58d,username:_0x3b4559,password:_0xd01204,telegramId:_0x2cf586,merchantUrl:_0x5ba13d,gateways:_0x42dda0,gatewaySettings:_0x9fbea1,wallets:_0x2e698d}=_0x166161,_0x5f7130=await database_1['default']['shop']['findUnique']({'where':{'username':_0x3b4559}});if(_0x5f7130)throw new Error('Username\x20already\x20exists');if(_0x2cf586){const _0x1e8ae3=await database_1[_0x5d1bb2(0x130)][_0x5d1bb2(0x23f)]['findUnique']({'where':{'telegram':_0x2cf586}});if(_0x1e8ae3)throw new Error(_0x5d1bb2(0x182));}const _0x1a9e5e=await bcryptjs_1[_0x5d1bb2(0x130)][_0x5d1bb2(0x17f)](_0xd01204,0xc),_0x3a0d60=_0x5d1bb2(0x19f)+crypto_1[_0x5d1bb2(0x130)][_0x5d1bb2(0x13f)](0x20)['toString']('hex'),_0x5737cb=_0x5d1bb2(0x17c)+crypto_1[_0x5d1bb2(0x130)][_0x5d1bb2(0x13f)](0x20)[_0x5d1bb2(0x21f)](_0x5d1bb2(0x160)),_0x2128a2=_0x42dda0?_0x42dda0[_0x5d1bb2(0x1db)](_0x1c8287=>this['getGatewayInternalName'](_0x1c8287)):null;_0x42dda0&&_0x2128a2&&console[_0x5d1bb2(0x211)](_0x5d1bb2(0x1e1),_0x42dda0,'->',_0x2128a2);const _0x4887af=await database_1[_0x5d1bb2(0x130)][_0x5d1bb2(0x23f)][_0x5d1bb2(0x146)]({'data':{'name':_0x59c58d,'username':_0x3b4559,'password':_0x1a9e5e,'telegram':_0x2cf586,'shopUrl':_0x5ba13d,'paymentGateways':_0x2128a2?JSON[_0x5d1bb2(0x1e4)](_0x2128a2):null,'gatewaySettings':_0x9fbea1?JSON[_0x5d1bb2(0x1e4)](_0x9fbea1):null,'usdtPolygonWallet':_0x2e698d?.['usdtPolygonWallet']||null,'usdtTrcWallet':_0x2e698d?.[_0x5d1bb2(0x20e)]||null,'usdtErcWallet':_0x2e698d?.[_0x5d1bb2(0x1a3)]||null,'usdcPolygonWallet':_0x2e698d?.['usdcPolygonWallet']||null,'publicKey':_0x3a0d60,'secretKey':_0x5737cb,'status':_0x5d1bb2(0x178)},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});return{'id':_0x4887af['id'],'fullName':_0x4887af[_0x5d1bb2(0x101)],'username':_0x4887af[_0x5d1bb2(0x1bf)],'telegramId':_0x4887af[_0x5d1bb2(0x1ba)],'merchantUrl':_0x4887af[_0x5d1bb2(0x10a)],'gateways':_0x4887af[_0x5d1bb2(0x1be)]?JSON['parse'](_0x4887af['paymentGateways']):null,'gatewaySettings':_0x4887af[_0x5d1bb2(0x1bd)]?JSON[_0x5d1bb2(0x1cb)](_0x4887af[_0x5d1bb2(0x1bd)]):null,'publicKey':_0x4887af['publicKey'],'wallets':{'usdtPolygonWallet':_0x4887af[_0x5d1bb2(0x1f2)],'usdtTrcWallet':_0x4887af[_0x5d1bb2(0x20e)],'usdtErcWallet':_0x4887af[_0x5d1bb2(0x1a3)],'usdcPolygonWallet':_0x4887af[_0x5d1bb2(0x20b)]},'status':_0x4887af[_0x5d1bb2(0x236)],'createdAt':_0x4887af[_0x5d1bb2(0x1a4)]};}async['deleteUser'](_0x49dbe1){const _0x31086c=a36_0x69dc61;await database_1[_0x31086c(0x130)]['shop'][_0x31086c(0x131)]({'where':{'id':_0x49dbe1}});}[a36_0x69dc61(0x20a)](_0x1174f2,_0x4ef5d3,_0x4a3fb3){const _0x1b0c6f=a36_0x69dc61,_0x1f58ea=new Map(),_0x1d38de=new Date(_0x4ef5d3);while(_0x1d38de<=_0x4a3fb3){const _0xffe59b=_0x1d38de[_0x1b0c6f(0x115)]()[_0x1b0c6f(0x220)]('T')[0x0];_0x1f58ea[_0x1b0c6f(0x138)](_0xffe59b,{'revenue':0x0,'count':0x0}),_0x1d38de[_0x1b0c6f(0x237)](_0x1d38de[_0x1b0c6f(0x197)]()+0x1);}for(const _0x1e378f of _0x1174f2){const _0x53deca=_0x1e378f[_0x1b0c6f(0x1a4)][_0x1b0c6f(0x115)]()[_0x1b0c6f(0x220)]('T')[0x0],_0x44fbaf=_0x1f58ea[_0x1b0c6f(0x1b3)](_0x53deca);_0x44fbaf&&(_0x44fbaf[_0x1b0c6f(0x184)]+=0x1,_0x1e378f[_0x1b0c6f(0x236)]===_0x1b0c6f(0x1b6)&&(_0x1e378f[_0x1b0c6f(0x18f)]?_0x44fbaf['revenue']+=_0x1e378f['amountUSDT']:console[_0x1b0c6f(0x211)](_0x1b0c6f(0x179)+_0x1e378f['id']+_0x1b0c6f(0x119))));}const _0x14b5e3=[],_0x37af32=[];for(const [_0x154953,_0x529850]of _0x1f58ea){_0x14b5e3[_0x1b0c6f(0x133)]({'date':_0x154953,'amount':Math[_0x1b0c6f(0x158)](_0x529850[_0x1b0c6f(0x103)]*0x64)/0x64}),_0x37af32[_0x1b0c6f(0x133)]({'date':_0x154953,'count':_0x529850[_0x1b0c6f(0x184)]});}return{'dailyRevenue':_0x14b5e3,'dailyPayments':_0x37af32};}}exports['AdminService']=AdminService;