'use strict';const a51_0x526b4c=a51_0x4bce;(function(_0xc1d31c,_0x72b2b2){const _0x5200d8=a51_0x4bce,_0x502673=_0xc1d31c();while(!![]){try{const _0x3c6f62=-parseInt(_0x5200d8(0x12a))/0x1*(-parseInt(_0x5200d8(0x15b))/0x2)+-parseInt(_0x5200d8(0x16b))/0x3+parseInt(_0x5200d8(0x1bc))/0x4+-parseInt(_0x5200d8(0x192))/0x5*(-parseInt(_0x5200d8(0x17a))/0x6)+parseInt(_0x5200d8(0x167))/0x7*(parseInt(_0x5200d8(0x17d))/0x8)+parseInt(_0x5200d8(0x145))/0x9+-parseInt(_0x5200d8(0x1ab))/0xa;if(_0x3c6f62===_0x72b2b2)break;else _0x502673['push'](_0x502673['shift']());}catch(_0x549ecb){_0x502673['push'](_0x502673['shift']());}}}(a51_0xfd21,0xb9417));var __createBinding=this&&this['__createBinding']||(Object[a51_0x526b4c(0x1be)]?function(_0x350860,_0x2cf15e,_0x18945c,_0x3f8ec0){const _0xa133e8=a51_0x526b4c;if(_0x3f8ec0===undefined)_0x3f8ec0=_0x18945c;var _0x3f4f56=Object[_0xa133e8(0x18b)](_0x2cf15e,_0x18945c);(!_0x3f4f56||(_0xa133e8(0x146)in _0x3f4f56?!_0x2cf15e[_0xa133e8(0x14a)]:_0x3f4f56['writable']||_0x3f4f56[_0xa133e8(0x19f)]))&&(_0x3f4f56={'enumerable':!![],'get':function(){return _0x2cf15e[_0x18945c];}}),Object[_0xa133e8(0x1af)](_0x350860,_0x3f8ec0,_0x3f4f56);}:function(_0x3c46e7,_0x555f9e,_0x22ce02,_0x200074){if(_0x200074===undefined)_0x200074=_0x22ce02;_0x3c46e7[_0x200074]=_0x555f9e[_0x22ce02];}),__setModuleDefault=this&&this[a51_0x526b4c(0x143)]||(Object[a51_0x526b4c(0x1be)]?function(_0x145f9c,_0xc1fa37){const _0xb72677=a51_0x526b4c;Object[_0xb72677(0x1af)](_0x145f9c,_0xb72677(0x149),{'enumerable':!![],'value':_0xc1fa37});}:function(_0x84f283,_0x514073){const _0x540568=a51_0x526b4c;_0x84f283[_0x540568(0x149)]=_0x514073;}),__importStar=this&&this['__importStar']||(function(){var _0x5426bb=function(_0x53c1f2){const _0x388ff7=a51_0x4bce;return _0x5426bb=Object[_0x388ff7(0x13e)]||function(_0x41a7c9){const _0xfcee5c=_0x388ff7;var _0x506326=[];for(var _0x2b6eaf in _0x41a7c9)if(Object[_0xfcee5c(0x141)][_0xfcee5c(0x140)][_0xfcee5c(0x130)](_0x41a7c9,_0x2b6eaf))_0x506326[_0x506326[_0xfcee5c(0x163)]]=_0x2b6eaf;return _0x506326;},_0x5426bb(_0x53c1f2);};return function(_0x24cc9e){const _0x2691f7=a51_0x4bce;if(_0x24cc9e&&_0x24cc9e['__esModule'])return _0x24cc9e;var _0x453582={};if(_0x24cc9e!=null){for(var _0x49fd41=_0x5426bb(_0x24cc9e),_0x28bc25=0x0;_0x28bc25<_0x49fd41['length'];_0x28bc25++)if(_0x49fd41[_0x28bc25]!==_0x2691f7(0x149))__createBinding(_0x453582,_0x24cc9e,_0x49fd41[_0x28bc25]);}return __setModuleDefault(_0x453582,_0x24cc9e),_0x453582;};}()),__importDefault=this&&this[a51_0x526b4c(0x191)]||function(_0x3a05be){const _0x19d248=a51_0x526b4c;return _0x3a05be&&_0x3a05be[_0x19d248(0x14a)]?_0x3a05be:{'default':_0x3a05be};};Object['defineProperty'](exports,a51_0x526b4c(0x14a),{'value':!![]}),exports['rapydStatusService']=exports['RapydStatusService']=void 0x0;function a51_0xfd21(){const _0x4c10bc=['schedulePaymentChecks','STATUS_UPDATE','\x20marked\x20as\x20paid\x20at:\x20','paymentTimers','checkSinglePayment','schedule_created','✅\x20[DEBUG]\x20Successfully\x20scheduled\x202\x20checks\x20for\x20payment\x20','1719780EYrtyM','/status-service','create','📈\x20[CHECK]\x20Payment\x20link\x20counter\x20updated\x20for\x20payment\x20','60\x20minutes','\x20is\x20not\x20a\x20Rapyd\x20payment\x20(gateway:\x20','\x20status\x20from\x20','4090avHPRd','currency','📡\x20[WEBHOOK]\x20Sending\x20','\x20has\x20no\x20gatewayPaymentId,\x20skipping','./paymentLinkService','size','call','\x20active\x20timers','clearPaymentTimers','logWhiteDomainError','sendPaymentStatusNotification','30\x20minutes','📊\x20[CHECK]\x20Payment\x20','push','⚠️\x20[CHECK]\x20Payment\x20','resolve','\x20\x20\x20-\x20Status:\x20','🔍\x20[CHECK]\x20Checking\x20Rapyd\x20payment\x20','❌\x20[TELEGRAM]\x20Failed\x20to\x20send\x20notification\x20for\x20payment\x20','forEach','getOwnPropertyNames','🔕\x20[WEBHOOK]\x20No\x20webhook\x20configured\x20for\x20shop\x20','hasOwnProperty','prototype','values','__setModuleDefault','\x20\x20\x20-\x20Amount:\x20','8844660aDLfPS','get','\x20not\x20found\x20in\x20database','\x20to\x20','default','__esModule','🌐\x20[MANUAL]\x20Manual\x20check\x20requested\x20for\x20payment\x20','RapydService','rapydService','logRapydError','PENDING','\x20not\x20enabled\x20for\x20shop\x20','\x20updated\x20successfully','🌐\x20[60MIN]\x20Final\x20check\x20completed\x20for\x20payment\x20','🧹\x20[DEBUG]\x20Clearing\x20','status_check_no_change','shopId','createdAt','gateway','delete','final_check','logRapydStatus','70WDTzDU','then','📊\x20[DEBUG]\x20Total\x20active\x20payment\x20timers:\x20','\x20\x20\x20-\x20paymentId:\x20','gatewayPaymentId','🔕\x20[WEBHOOK]\x20Event\x20','\x20has\x20no\x20gatewayPaymentId','\x20status\x20unchanged\x20(','length','shutdown','\x20is\x20valid\x20for\x20checking,\x20proceeding...','clear','1605891fpVLvf','\x20\x20\x20-\x20ShopId:\x20','PAID','message','2787888ZnUukm','rapyd','transactionId','status','paidAt','🆔\x20[CHECK]\x20Transaction\x20ID:\x20','payment','./gateways/rapydService','first_check','failureMessage','sendShopWebhook','💰\x20[CHECK]\x20Payment\x20','getPaymentTimerInfo','✅\x20[SHUTDOWN]\x20RapydStatusService\x20stopped','includes','193770QlFlKl','checkPaymentStatus','adminNotes','8cxNdMl','paymentId','❌\x20[CHECK]\x20Error\x20checking\x20payment\x20','../config/database','checkPaymentById','update','❌\x20[WEBHOOK]\x20Failed\x20to\x20send\x20webhook\x20for\x20payment\x20','✅\x20[WEBHOOK]\x20Webhook\x20payload\x20prepared\x20for\x20shop\x20','not\x20paid','\x20\x20\x20-\x20Gateway:\x20','timers','webhookUrl','✅\x20[CHECK]\x20Payment\x20','paymentMethodType','getOwnPropertyDescriptor','🔄\x20[CHECK]\x20Updating\x20payment\x20','📊\x20[RAPYD_STATUS]\x20Payment\x20status\x20update:','logWhiteDomainRequest','checkSinglePaymentById','❌\x20[CHECK]\x20Failed\x20to\x20update\x20payment\x20link\x20counter\x20for\x20payment\x20','__importDefault','115VjPjOT','\x20webhook\x20to\x20','📱\x20[TELEGRAM]\x20Payment\x20','findUnique','🌐\x20[DEBUG]\x20schedulePaymentChecks\x20called\x20with:','loggerService','settings','\x20status:\x20','webhookEvents','getServiceStats','shop','🧹\x20[CHECK]\x20Payment\x20','amount','configurable','\x20\x20\x20-\x20gatewayPaymentId:\x20','🌐\x20RapydStatusService\x20initialized','🛑\x20[SHUTDOWN]\x20Stopping\x20RapydStatusService...','paymentDetails','stringify','\x20\x20\x20-\x20GatewayPaymentId:\x20','payment.','log','status_check','error','set','8399300gWpDIW','❌\x20[CHECK]\x20Payment\x20','toLowerCase','rapydStatusService','defineProperty','🔍\x20[CHECK]\x20Starting\x20check\x20for\x20payment\x20ID:\x20','❌\x20[60MIN]\x20Failed\x20final\x20check\x20for\x20payment\x20','✅\x20[DEBUG]\x20Cleared\x20timers\x20for\x20payment\x20','toISOString',',\x20timers\x20cleared'];a51_0xfd21=function(){return _0x4c10bc;};return a51_0xfd21();}function a51_0x4bce(_0x366114,_0xc520e5){const _0xfd218c=a51_0xfd21();return a51_0x4bce=function(_0x4bcec0,_0x2d6064){_0x4bcec0=_0x4bcec0-0x129;let _0x72154a=_0xfd218c[_0x4bcec0];return _0x72154a;},a51_0x4bce(_0x366114,_0xc520e5);}const rapydService_1=require(a51_0x526b4c(0x172)),database_1=__importDefault(require(a51_0x526b4c(0x180))),loggerService_1=require('./loggerService');class RapydStatusService{constructor(){const _0x123a30=a51_0x526b4c;this[_0x123a30(0x1b8)]=new Map(),this[_0x123a30(0x14d)]=new rapydService_1[(_0x123a30(0x14c))](),console['log'](_0x123a30(0x1a1));}[a51_0x526b4c(0x1b5)](_0x534f19,_0xe354ed){const _0x2e8295=a51_0x526b4c;console[_0x2e8295(0x1a7)](_0x2e8295(0x196)),console[_0x2e8295(0x1a7)](_0x2e8295(0x15e)+_0x534f19),console[_0x2e8295(0x1a7)](_0x2e8295(0x1a0)+_0xe354ed),this[_0x2e8295(0x132)](_0x534f19);const _0x4e514d=[],_0x28f27e=new Date(),_0x4cdebe=setTimeout(async()=>{const _0x4c9894=_0x2e8295;try{console[_0x4c9894(0x1a7)]('🌐\x20[30MIN]\x20Starting\x20first\x20check\x20for\x20payment\x20'+_0x534f19),await this[_0x4c9894(0x18f)](_0x534f19);}catch(_0x372405){console['error']('❌\x20[30MIN]\x20Failed\x20first\x20check\x20for\x20payment\x20'+_0x534f19+':',_0x372405),this[_0x4c9894(0x14e)](_0x534f19,_0xe354ed,_0x372405,_0x4c9894(0x173));}},0x1e*0x3c*0x3e8);_0x4e514d[_0x2e8295(0x137)](_0x4cdebe);const _0x37ea25=setTimeout(async()=>{const _0x519662=_0x2e8295;try{console['log']('🌐\x20[60MIN]\x20Starting\x20final\x20check\x20for\x20payment\x20'+_0x534f19),await this[_0x519662(0x18f)](_0x534f19),this['clearPaymentTimers'](_0x534f19),console[_0x519662(0x1a7)](_0x519662(0x152)+_0x534f19+_0x519662(0x1b4));}catch(_0x528834){console['error'](_0x519662(0x1b1)+_0x534f19+':',_0x528834),this[_0x519662(0x14e)](_0x534f19,_0xe354ed,_0x528834,_0x519662(0x159)),this[_0x519662(0x132)](_0x534f19);}},0x3c*0x3c*0x3e8);_0x4e514d[_0x2e8295(0x137)](_0x37ea25),this[_0x2e8295(0x1b8)][_0x2e8295(0x1aa)](_0x534f19,{'timers':_0x4e514d,'paymentId':_0x534f19,'gatewayPaymentId':_0xe354ed,'createdAt':_0x28f27e}),console['log'](_0x2e8295(0x1bb)+_0x534f19+'\x20(30min,\x2060min)'),console['log'](_0x2e8295(0x15d)+this['paymentTimers']['size']),this[_0x2e8295(0x15a)](_0x534f19,_0xe354ed,_0x2e8295(0x14f),_0x2e8295(0x14f),_0x2e8295(0x1ba),{'checks_scheduled':0x2,'first_check_in':_0x2e8295(0x135),'final_check_in':_0x2e8295(0x1c0),'created_at':_0x28f27e['toISOString']()});}[a51_0x526b4c(0x132)](_0x503ca9){const _0x5c926a=a51_0x526b4c,_0x5eea5e=this[_0x5c926a(0x1b8)][_0x5c926a(0x146)](_0x503ca9);_0x5eea5e&&(console[_0x5c926a(0x1a7)](_0x5c926a(0x153)+_0x5eea5e[_0x5c926a(0x187)][_0x5c926a(0x163)]+'\x20timers\x20for\x20payment\x20'+_0x503ca9),_0x5eea5e[_0x5c926a(0x187)][_0x5c926a(0x13d)](_0x344782=>clearTimeout(_0x344782)),this['paymentTimers'][_0x5c926a(0x158)](_0x503ca9),console['log'](_0x5c926a(0x1b2)+_0x503ca9));}async[a51_0x526b4c(0x181)](_0x5adae2){const _0x4dfd81=a51_0x526b4c;console['log'](_0x4dfd81(0x14b)+_0x5adae2),await this[_0x4dfd81(0x18f)](_0x5adae2);}async[a51_0x526b4c(0x18f)](_0x4df2b1){const _0x1eb2be=a51_0x526b4c;console[_0x1eb2be(0x1a7)](_0x1eb2be(0x1b0)+_0x4df2b1);const _0x425488=await database_1[_0x1eb2be(0x149)]['payment'][_0x1eb2be(0x195)]({'where':{'id':_0x4df2b1},'select':{'id':!![],'gatewayPaymentId':!![],'amount':!![],'currency':!![],'status':!![],'shopId':!![],'createdAt':!![],'gateway':!![],'shop':{'select':{'id':!![],'name':!![],'settings':{'select':{'webhookUrl':!![],'webhookEvents':!![]}}}}}});if(!_0x425488){console[_0x1eb2be(0x1a7)](_0x1eb2be(0x1ac)+_0x4df2b1+_0x1eb2be(0x147));return;}console[_0x1eb2be(0x1a7)](_0x1eb2be(0x136)+_0x4df2b1+'\x20found:'),console['log'](_0x1eb2be(0x186)+_0x425488[_0x1eb2be(0x157)]),console[_0x1eb2be(0x1a7)](_0x1eb2be(0x13a)+_0x425488[_0x1eb2be(0x16e)]),console[_0x1eb2be(0x1a7)](_0x1eb2be(0x1a5)+_0x425488[_0x1eb2be(0x15f)]),console['log'](_0x1eb2be(0x144)+_0x425488[_0x1eb2be(0x19e)]+'\x20'+_0x425488[_0x1eb2be(0x12b)]),console[_0x1eb2be(0x1a7)](_0x1eb2be(0x168)+_0x425488[_0x1eb2be(0x155)]);if(_0x425488[_0x1eb2be(0x157)]!==_0x1eb2be(0x16c)){console['log']('⚠️\x20[CHECK]\x20Payment\x20'+_0x4df2b1+_0x1eb2be(0x1c1)+_0x425488['gateway']+')');return;}if(_0x425488[_0x1eb2be(0x16e)]!=='PENDING'){console[_0x1eb2be(0x1a7)](_0x1eb2be(0x138)+_0x4df2b1+'\x20status\x20is\x20'+_0x425488[_0x1eb2be(0x16e)]+',\x20stopping\x20checks'),this['clearPaymentTimers'](_0x4df2b1);return;}if(!_0x425488[_0x1eb2be(0x15f)]){console['log'](_0x1eb2be(0x138)+_0x4df2b1+_0x1eb2be(0x161));return;}console['log'](_0x1eb2be(0x189)+_0x4df2b1+_0x1eb2be(0x165)),await this[_0x1eb2be(0x1b9)](_0x425488);}async[a51_0x526b4c(0x1b9)](_0x47694c){const _0xd793e0=a51_0x526b4c;if(!_0x47694c[_0xd793e0(0x15f)]){console['log'](_0xd793e0(0x138)+_0x47694c['id']+_0xd793e0(0x12d));return;}console[_0xd793e0(0x1a7)](_0xd793e0(0x13b)+_0x47694c['id']+'\x20('+_0x47694c[_0xd793e0(0x15f)]+')');try{const _0x1f9a4b=await this[_0xd793e0(0x14d)][_0xd793e0(0x17b)](_0x47694c['gatewayPaymentId']);console['log'](_0xd793e0(0x136)+_0x47694c['id']+_0xd793e0(0x199)+_0x1f9a4b[_0xd793e0(0x16e)]);_0x1f9a4b[_0xd793e0(0x1a3)]&&console[_0xd793e0(0x1a7)](_0xd793e0(0x136)+_0x47694c['id']+'\x20details:',{'transactionId':_0x1f9a4b['paymentDetails'][_0xd793e0(0x16d)],'paymentMethod':_0x1f9a4b[_0xd793e0(0x1a3)][_0xd793e0(0x18a)],'createdAt':_0x1f9a4b[_0xd793e0(0x1a3)][_0xd793e0(0x156)],'paidAt':_0x1f9a4b[_0xd793e0(0x1a3)][_0xd793e0(0x16f)]||_0xd793e0(0x185)});if(_0x1f9a4b['status']!==_0x47694c['status']){console[_0xd793e0(0x1a7)](_0xd793e0(0x18c)+_0x47694c['id']+_0xd793e0(0x129)+_0x47694c[_0xd793e0(0x16e)]+_0xd793e0(0x148)+_0x1f9a4b['status']),this['logRapydStatus'](_0x47694c['id'],_0x47694c[_0xd793e0(0x15f)],_0x47694c['status'],_0x1f9a4b[_0xd793e0(0x16e)],_0xd793e0(0x1a8),{'paymentDetails':_0x1f9a4b[_0xd793e0(0x1a3)],'amount':_0x1f9a4b['amount'],'currency':_0x1f9a4b[_0xd793e0(0x12b)],'shopId':_0x47694c[_0xd793e0(0x155)],'checkTimestamp':new Date()[_0xd793e0(0x1b3)]()});const _0x5d58ce={'status':_0x1f9a4b[_0xd793e0(0x16e)],'updatedAt':new Date()};_0x1f9a4b['status']===_0xd793e0(0x169)&&_0x47694c[_0xd793e0(0x16e)]!==_0xd793e0(0x169)&&(_0x5d58ce[_0xd793e0(0x16f)]=new Date(),console['log'](_0xd793e0(0x176)+_0x47694c['id']+_0xd793e0(0x1b7)+_0x5d58ce['paidAt'][_0xd793e0(0x1b3)]()));if(_0x1f9a4b[_0xd793e0(0x1a3)]){const _0x5fcf02=_0x1f9a4b['paymentDetails'];_0x5fcf02[_0xd793e0(0x16d)]&&console[_0xd793e0(0x1a7)](_0xd793e0(0x170)+_0x5fcf02[_0xd793e0(0x16d)]);if(_0x5fcf02[_0xd793e0(0x174)]){const _0x28d570=_0x47694c[_0xd793e0(0x17c)]||'',_0x3aaf28='Failure:\x20'+_0x5fcf02[_0xd793e0(0x174)];_0x5d58ce[_0xd793e0(0x17c)]=_0x28d570?_0x28d570+'\x0a\x0a'+_0x3aaf28:_0x3aaf28,console[_0xd793e0(0x1a7)]('❌\x20[CHECK]\x20Saved\x20failure\x20message\x20to\x20admin\x20notes:\x20'+_0x5fcf02['failureMessage']);}_0x5fcf02[_0xd793e0(0x16f)]&&console[_0xd793e0(0x1a7)]('✅\x20[CHECK]\x20Payment\x20confirmed\x20at:\x20'+new Date(_0x5fcf02['paidAt']*0x3e8)[_0xd793e0(0x1b3)]());}await database_1['default'][_0xd793e0(0x171)][_0xd793e0(0x182)]({'where':{'id':_0x47694c['id']},'data':_0x5d58ce}),await database_1[_0xd793e0(0x149)]['webhookLog'][_0xd793e0(0x1be)]({'data':{'paymentId':_0x47694c['id'],'shopId':_0x47694c[_0xd793e0(0x155)],'event':'rapyd_status_check_'+_0x1f9a4b[_0xd793e0(0x16e)][_0xd793e0(0x1ad)](),'statusCode':0xc8,'responseBody':JSON[_0xd793e0(0x1a4)]({'oldStatus':_0x47694c[_0xd793e0(0x16e)],'newStatus':_0x1f9a4b[_0xd793e0(0x16e)],'paymentDetails':_0x1f9a4b[_0xd793e0(0x1a3)],'checkedAt':new Date()[_0xd793e0(0x1b3)]()})}}),await this[_0xd793e0(0x175)](_0x47694c,_0x1f9a4b[_0xd793e0(0x16e)]),await this[_0xd793e0(0x134)](_0x47694c,_0x1f9a4b['status']);if(_0x1f9a4b['status']===_0xd793e0(0x169)&&_0x47694c[_0xd793e0(0x16e)]!==_0xd793e0(0x169))try{const {PaymentLinkService:_0x523f02}=await Promise[_0xd793e0(0x139)]()[_0xd793e0(0x15c)](()=>__importStar(require(_0xd793e0(0x12e)))),_0x8f7f6f=new _0x523f02();await _0x8f7f6f['handleSuccessfulPayment'](_0x47694c['id']),console[_0xd793e0(0x1a7)](_0xd793e0(0x1bf)+_0x47694c['id']);}catch(_0x58b070){console['error'](_0xd793e0(0x190)+_0x47694c['id']+':',_0x58b070);}_0x1f9a4b['status']!=='PENDING'&&(console[_0xd793e0(0x1a7)](_0xd793e0(0x19d)+_0x47694c['id']+'\x20status\x20changed\x20to\x20'+_0x1f9a4b[_0xd793e0(0x16e)]+',\x20clearing\x20timers'),this[_0xd793e0(0x132)](_0x47694c['id'])),console['log'](_0xd793e0(0x189)+_0x47694c['id']+_0xd793e0(0x151));}else console['log']('📊\x20[CHECK]\x20Payment\x20'+_0x47694c['id']+_0xd793e0(0x162)+_0x1f9a4b['status']+')'),this['logRapydStatus'](_0x47694c['id'],_0x47694c[_0xd793e0(0x15f)],_0x47694c[_0xd793e0(0x16e)],_0x1f9a4b[_0xd793e0(0x16e)],_0xd793e0(0x154),{'paymentDetails':_0x1f9a4b[_0xd793e0(0x1a3)],'amount':_0x1f9a4b['amount'],'currency':_0x1f9a4b['currency'],'shopId':_0x47694c[_0xd793e0(0x155)],'checkTimestamp':new Date()[_0xd793e0(0x1b3)]()});}catch(_0x7f2d71){console['error'](_0xd793e0(0x17f)+_0x47694c['id']+':',_0x7f2d71),this[_0xd793e0(0x14e)](_0x47694c['id'],_0x47694c['gatewayPaymentId'],_0x7f2d71,'status_check',{'shopId':_0x47694c['shopId'],'amount':_0x47694c[_0xd793e0(0x19e)],'currency':_0x47694c['currency'],'checkTimestamp':new Date()[_0xd793e0(0x1b3)]()});}}async[a51_0x526b4c(0x175)](_0x4f0ae2,_0x541fb1){const _0x574b62=a51_0x526b4c;if(!_0x4f0ae2[_0x574b62(0x19c)]?.[_0x574b62(0x198)]?.[_0x574b62(0x188)]||!_0x4f0ae2[_0x574b62(0x19c)]?.[_0x574b62(0x198)]?.['webhookEvents']){console[_0x574b62(0x1a7)](_0x574b62(0x13f)+_0x4f0ae2[_0x574b62(0x155)]);return;}try{const _0x156118=JSON['parse'](_0x4f0ae2['shop']['settings'][_0x574b62(0x19a)]),_0x25d242=_0x574b62(0x1a6)+_0x541fb1[_0x574b62(0x1ad)]();if(!_0x156118[_0x574b62(0x179)](_0x25d242)){console['log'](_0x574b62(0x160)+_0x25d242+_0x574b62(0x150)+_0x4f0ae2[_0x574b62(0x155)]);return;}console[_0x574b62(0x1a7)](_0x574b62(0x12c)+_0x25d242+_0x574b62(0x193)+_0x4f0ae2[_0x574b62(0x19c)][_0x574b62(0x198)][_0x574b62(0x188)]);const _0x60f355={'event':_0x25d242,'payment':{'id':_0x4f0ae2['id'],'status':_0x541fb1,'amount':_0x4f0ae2[_0x574b62(0x19e)],'currency':_0x4f0ae2[_0x574b62(0x12b)],'gateway':_0x4f0ae2['gateway'],'gatewayPaymentId':_0x4f0ae2['gatewayPaymentId'],'createdAt':_0x4f0ae2[_0x574b62(0x156)],'updatedAt':new Date()}};console['log'](_0x574b62(0x184)+_0x4f0ae2[_0x574b62(0x155)]);}catch(_0x2dd374){console[_0x574b62(0x1a9)](_0x574b62(0x183)+_0x4f0ae2['id']+':',_0x2dd374);}}async['sendPaymentStatusNotification'](_0x311aad,_0x219b16){const _0x2085b6=a51_0x526b4c;try{console[_0x2085b6(0x1a7)](_0x2085b6(0x194)+_0x311aad['id']+'\x20status\x20changed:\x20'+_0x311aad['status']+'\x20→\x20'+_0x219b16);}catch(_0x23ae39){console[_0x2085b6(0x1a9)](_0x2085b6(0x13c)+_0x311aad['id']+':',_0x23ae39);}}[a51_0x526b4c(0x15a)](_0x5840d0,_0x1e44bf,_0x21f6e3,_0x1168a6,_0xc44445,_0x25d60a){const _0x5ba656=a51_0x526b4c,_0x7ec706={'paymentId':_0x5840d0,'gatewayPaymentId':_0x1e44bf,'oldStatus':_0x21f6e3,'newStatus':_0x1168a6,'action':_0xc44445,'timestamp':new Date()[_0x5ba656(0x1b3)](),..._0x25d60a};console[_0x5ba656(0x1a7)](_0x5ba656(0x18d),_0x7ec706),loggerService_1[_0x5ba656(0x197)][_0x5ba656(0x18e)](_0x5ba656(0x16c),_0x5ba656(0x1bd),_0x5ba656(0x1b6),_0x7ec706);}[a51_0x526b4c(0x14e)](_0x13ece8,_0x31ca06,_0x4dc77e,_0x40983e,_0xc897ac){const _0x219f68=a51_0x526b4c,_0xae9bdb={'paymentId':_0x13ece8,'gatewayPaymentId':_0x31ca06,'action':_0x40983e,'error':_0x4dc77e instanceof Error?_0x4dc77e[_0x219f68(0x16a)]:String(_0x4dc77e),'timestamp':new Date()['toISOString'](),..._0xc897ac};console[_0x219f68(0x1a9)]('❌\x20[RAPYD_ERROR]\x20Payment\x20error:',_0xae9bdb),loggerService_1['loggerService'][_0x219f68(0x133)](_0x219f68(0x16c),_0x219f68(0x1bd),_0x40983e+':\x20'+_0xae9bdb[_0x219f68(0x1a9)]);}[a51_0x526b4c(0x177)](_0x5087fe){const _0x491e87=a51_0x526b4c,_0x59050e=this[_0x491e87(0x1b8)]['get'](_0x5087fe);if(!_0x59050e)return{'hasTimers':![],'message':'No\x20active\x20timers\x20for\x20this\x20payment'};return{'hasTimers':!![],'paymentId':_0x59050e[_0x491e87(0x17e)],'gatewayPaymentId':_0x59050e[_0x491e87(0x15f)],'createdAt':_0x59050e[_0x491e87(0x156)],'activeTimers':_0x59050e[_0x491e87(0x187)][_0x491e87(0x163)],'message':_0x59050e['timers']['length']+_0x491e87(0x131)};}[a51_0x526b4c(0x19b)](){const _0x7e0f5a=a51_0x526b4c;return{'activeTimers':this[_0x7e0f5a(0x1b8)][_0x7e0f5a(0x12f)],'totalChecksScheduled':Array['from'](this[_0x7e0f5a(0x1b8)][_0x7e0f5a(0x142)]())['reduce']((_0x21d5e2,_0x2abc0c)=>_0x21d5e2+_0x2abc0c[_0x7e0f5a(0x187)][_0x7e0f5a(0x163)],0x0)};}[a51_0x526b4c(0x164)](){const _0x251b23=a51_0x526b4c;console[_0x251b23(0x1a7)](_0x251b23(0x1a2));for(const [_0x2d961e,_0x36fd89]of this['paymentTimers']){_0x36fd89[_0x251b23(0x187)][_0x251b23(0x13d)](_0x1c0317=>clearTimeout(_0x1c0317)),console[_0x251b23(0x1a7)]('🧹\x20[SHUTDOWN]\x20Cleared\x20timers\x20for\x20payment\x20'+_0x2d961e);}this[_0x251b23(0x1b8)][_0x251b23(0x166)](),console[_0x251b23(0x1a7)](_0x251b23(0x178));}}exports['RapydStatusService']=RapydStatusService,exports[a51_0x526b4c(0x1ae)]=new RapydStatusService();