'use strict';const a52_0x3c8239=a52_0x18d6;(function(_0x38445e,_0x9b65fc){const _0x57a4a0=a52_0x18d6,_0x319c67=_0x38445e();while(!![]){try{const _0x302c2c=parseInt(_0x57a4a0(0x1c5))/0x1+parseInt(_0x57a4a0(0x1f0))/0x2*(parseInt(_0x57a4a0(0x201))/0x3)+parseInt(_0x57a4a0(0x1f8))/0x4*(-parseInt(_0x57a4a0(0x179))/0x5)+parseInt(_0x57a4a0(0x1d8))/0x6*(parseInt(_0x57a4a0(0x1bf))/0x7)+parseInt(_0x57a4a0(0x20d))/0x8*(-parseInt(_0x57a4a0(0x191))/0x9)+-parseInt(_0x57a4a0(0x195))/0xa+-parseInt(_0x57a4a0(0x209))/0xb;if(_0x302c2c===_0x9b65fc)break;else _0x319c67['push'](_0x319c67['shift']());}catch(_0x50ae47){_0x319c67['push'](_0x319c67['shift']());}}}(a52_0xa06e,0xab7ed));function a52_0x18d6(_0xdffd17,_0x1d5868){_0xdffd17=_0xdffd17-0x15c;const _0xa06e19=a52_0xa06e();let _0x18d6cc=_0xa06e19[_0xdffd17];return _0x18d6cc;}var __importDefault=this&&this[a52_0x3c8239(0x1e7)]||function(_0x1d73df){const _0x5b1851=a52_0x3c8239;return _0x1d73df&&_0x1d73df[_0x5b1851(0x1d7)]?_0x1d73df:{'default':_0x1d73df};};Object[a52_0x3c8239(0x1b2)](exports,a52_0x3c8239(0x1d7),{'value':!![]}),exports[a52_0x3c8239(0x1d1)]=exports['AdminBotService']=void 0x0;function a52_0xa06e(){const _0x13ff78=['\x0a\x0a_Ready\x20to\x20send?_','âš ï¸\x20Chargebacks\x20\x5c-\x20','timestamp','setupBotHandlers','ðŸ“…\x20Today','version','FAILED','warn','preview','âœ…\x20Active','ðŸ“†\x20Last\x20Month','join','UTC','âœ…\x20Successful\x20Payments\x20\x5c-\x20','isAdmin','EXPIRED','CHARGEBACK','ðŸ”\x20*Debug\x20Information*\x0a\x0a','onText','defineProperty','Markdown','dirname','startsWith','âœ…\x20Admin\x20IDs\x20updated:','loadConfig','ðŸ‘¥\x20Total\x20Merchants:\x20','ðŸ›‘\x20Admin\x20Telegram\x20bot\x20stopped','âœ…\x20Delivered:\x20','ðŸ“†\x20Yesterday','filter','saveConfig','initializeBot','7MsHuiS','âŒ\x20Broadcast\x20cancelled','from','back_to_main','answerCallbackQuery','file_id','710725AlKVIv','ðŸ“‹\x20Admins:\x20`','MarkdownV2','ðŸ¤–\x20Bot\x20Status:\x20','error','cmd_broadcast','message_id','ðŸ“…\x20All\x20Time','âœ…\x20*Broadcast\x20Complete*\x0a\x0a','broadcast_cancel','ðŸ“…\x20Last\x20Month','toString','adminBotService','ðŸ“Š\x20*Statistics*\x0a\x0aSelect\x20period:','toISOString','ðŸ”™\x20Back','ðŸ“…\x20Yesterday','stringify','__esModule','2695206uoJxRI','log','ðŸ’µ\x20Earned\x20\x5c-\x20','â°\x20Timestamp:\x20','ðŸ“¢\x20*Create\x20Broadcast*\x0a\x0aPlease\x20enter\x20the\x20message\x20text\x20you\x20want\x20to\x20send\x20to\x20all\x20merchants:','stats_last_month','âŒ\x20Failed\x20to\x20initialize\x20Admin\x20Telegram\x20bot:','replace','â¬…ï¸\x20Back','node-telegram-bot-api','handleBroadcast','length','payment','existsSync','bot','__importDefault','writeFileSync','chat','telegramId','\x20-\x20','padStart','âŒ\x20Merchant\x20bot\x20token\x20not\x20configured','ðŸ“¤\x20Sending\x20broadcast...','toFixed','2732702DtXBom','set','â›”ï¸\x20Access\x20Denied\x0a\x0a','floor','cwd','amountAfterGatewayCommissionUSDT','stats_all_time','broadcast_send','28nZkkiC','handleStatistics','â›”ï¸\x20Access\x20Denied','âŒ\x20Cancel','findMany','parse','cmd_statistics','ðŸ“Š\x20*Statistics:\x20','adminIds','3CsCnJp','ðŸ“ˆ\x20Statistics','ðŸ†”\x20Your\x20ID:\x20`','data','Error\x20handling\x20/debug\x20command:','ðŸ“¤\x20Sending\x20broadcast\x20to\x20','includes','sendPhoto','3921951WPuCXd','Failed\x20to\x20send\x20to\x20','getBotInfo','sendMessage','16SyPzPb','broadcastSessions','*\x0a\x0a','getUTCMonth','â±\x20Uptime:\x20','editMessageText','text','step','status','âŒ\x20Inactive','PAID','ðŸ“†\x20This\x20Month','adminCount','forEach','uptime','stats_this_month','0.0','ðŸ‘¥\x20Admin\x20Count:\x20','Error\x20saving\x20admin\x20bot\x20config:','ðŸ“†\x20All\x20Time','\x20USDT\x0a','delete','AdminBotService','caption','getUTCDate','Error\x20getting\x20statistics:','cmd_debug','awaiting_text','telegramUser','Failed\x20to\x20download\x20photo:','ðŸ“¤\x20Sent:\x20','716455GzaPsF','ðŸ“…\x20This\x20Month','updateAdminIds','âŒ\x20No\x20message\x20to\x20send','getFileLink','config','ðŸ”§\x20Debug','admins','get','getUTCFullYear','ðŸ’¬\x20Create\x20Broadcast','Error\x20sending\x20broadcast:','botToken','âŒ\x20Error\x20sending\x20broadcast','arrayBuffer','TELEGRAM_ADMIN_BOT_TOKEN\x20not\x20found\x20in\x20environment\x20variables','ðŸ”\x20*TRAPAY\x20Admin\x20Bot*\x0a\x0aâœ…\x20You\x20are\x20authorized\x20as\x20admin.','botActive','stats_','adminBotConfig.json','yourId','readFileSync','ðŸ“ˆ\x20Conversion\x20\x5c-\x20','âœ…\x20Admin\x20Telegram\x20bot\x20initialized\x20successfully','502641uPdnTx','default','../config/database','message','3525560abdqky','stopPolling','\x20merchants...','REFUND','ðŸ”„\x20Refunds\x20\x5c-\x20','stats_today','Error\x20handling\x20debug\x20command:','photoFileId','ðŸ“¢\x20*Broadcast\x20Preview*\x0a\x0a','stats_yesterday'];a52_0xa06e=function(){return _0x13ff78;};return a52_0xa06e();}const node_telegram_bot_api_1=__importDefault(require(a52_0x3c8239(0x1e1))),fs_1=__importDefault(require('fs')),path_1=__importDefault(require('path')),CONFIG_PATH=path_1[a52_0x3c8239(0x192)]['join'](process[a52_0x3c8239(0x1f4)](),a52_0x3c8239(0x204),a52_0x3c8239(0x18c));class AdminBotService{constructor(){const _0x16f3b8=a52_0x3c8239;this['bot']=null,this[_0x16f3b8(0x20e)]=new Map(),this['botToken']=process.env.TELEGRAM_ADMIN_BOT_TOKEN||'',this[_0x16f3b8(0x17e)]=this[_0x16f3b8(0x1b7)](),this['botToken']?this[_0x16f3b8(0x1be)]():console[_0x16f3b8(0x1a6)](_0x16f3b8(0x188));}[a52_0x3c8239(0x1b7)](){const _0x588cac=a52_0x3c8239;try{if(fs_1[_0x588cac(0x192)][_0x588cac(0x1e5)](CONFIG_PATH)){const _0x49072f=fs_1[_0x588cac(0x192)][_0x588cac(0x18e)](CONFIG_PATH,'utf-8');return JSON[_0x588cac(0x1fd)](_0x49072f);}}catch(_0x3600c4){console[_0x588cac(0x1c9)]('Error\x20loading\x20admin\x20bot\x20config:',_0x3600c4);}return{'adminIds':[]};}[a52_0x3c8239(0x1bd)](){const _0x40b7bb=a52_0x3c8239;try{const _0x2341d8=path_1['default'][_0x40b7bb(0x1b4)](CONFIG_PATH);!fs_1[_0x40b7bb(0x192)][_0x40b7bb(0x1e5)](_0x2341d8)&&fs_1[_0x40b7bb(0x192)]['mkdirSync'](_0x2341d8,{'recursive':!![]}),fs_1['default'][_0x40b7bb(0x1e8)](CONFIG_PATH,JSON[_0x40b7bb(0x1d6)](this[_0x40b7bb(0x17e)],null,0x2));}catch(_0x44b838){console[_0x40b7bb(0x1c9)](_0x40b7bb(0x16c),_0x44b838);}}[a52_0x3c8239(0x1ad)](_0x291d06){const _0x59924e=a52_0x3c8239;return this[_0x59924e(0x17e)][_0x59924e(0x200)][_0x59924e(0x207)](_0x291d06);}[a52_0x3c8239(0x1be)](){const _0x2c1f32=a52_0x3c8239;try{this['bot']=new node_telegram_bot_api_1[(_0x2c1f32(0x192))](this[_0x2c1f32(0x185)],{'polling':!![]}),this['setupBotHandlers'](),console['log'](_0x2c1f32(0x190));}catch(_0x5a8c57){console[_0x2c1f32(0x1c9)](_0x2c1f32(0x1de),_0x5a8c57);}}[a52_0x3c8239(0x1a2)](){const _0x48709c=a52_0x3c8239;if(!this['bot'])return;this[_0x48709c(0x1e6)]['onText'](/\/start/,async _0x3ebf9d=>{const _0x596a63=_0x48709c,_0x3a1d8c=_0x3ebf9d[_0x596a63(0x1e9)]['id'],_0x5dc9d8=_0x3ebf9d[_0x596a63(0x1c1)]?.['id'][_0x596a63(0x1d0)]();if(!_0x5dc9d8)return;if(this['isAdmin'](_0x5dc9d8)){const _0x411746={'inline_keyboard':[[{'text':_0x596a63(0x202),'callback_data':_0x596a63(0x1fe)}],[{'text':_0x596a63(0x183),'callback_data':_0x596a63(0x1ca)}],[{'text':_0x596a63(0x17f),'callback_data':_0x596a63(0x174)}]]};await this[_0x596a63(0x1e6)]?.[_0x596a63(0x20c)](_0x3a1d8c,_0x596a63(0x189),{'parse_mode':_0x596a63(0x1b3),'reply_markup':_0x411746});}else await this[_0x596a63(0x1e6)]?.[_0x596a63(0x20c)](_0x3a1d8c,_0x596a63(0x1f2)+'You\x20are\x20not\x20authorized\x20to\x20use\x20this\x20bot.\x0a'+'Contact\x20system\x20administrator.',{'parse_mode':'Markdown'});}),this[_0x48709c(0x1e6)][_0x48709c(0x1b1)](/\/debug/,async _0xf371b8=>{const _0x2c6da3=_0x48709c,_0xbd49c5=_0xf371b8[_0x2c6da3(0x1e9)]['id'],_0x164d86=_0xf371b8['from']?.['id'][_0x2c6da3(0x1d0)]();if(!_0x164d86)return;if(!this[_0x2c6da3(0x1ad)](_0x164d86)){await this['bot']?.[_0x2c6da3(0x20c)](_0xbd49c5,_0x2c6da3(0x1fa));return;}try{const _0x1e389f={'botActive':!!this['bot'],'adminCount':this['config'][_0x2c6da3(0x200)][_0x2c6da3(0x1e3)],'admins':this[_0x2c6da3(0x17e)][_0x2c6da3(0x200)],'yourId':_0x164d86,'timestamp':new Date()['toISOString'](),'nodeVersion':process['version'],'uptime':process[_0x2c6da3(0x168)]()};let _0x50107b=_0x2c6da3(0x1b0);_0x50107b+=_0x2c6da3(0x1c8)+(_0x1e389f[_0x2c6da3(0x18a)]?_0x2c6da3(0x1a8):_0x2c6da3(0x163))+'\x0a',_0x50107b+=_0x2c6da3(0x16b)+_0x1e389f[_0x2c6da3(0x166)]+'\x0a',_0x50107b+=_0x2c6da3(0x1c6)+_0x1e389f[_0x2c6da3(0x180)][_0x2c6da3(0x1aa)](',\x20')+'`\x0a',_0x50107b+='ðŸ†”\x20Your\x20ID:\x20`'+_0x1e389f[_0x2c6da3(0x18d)]+'`\x0a',_0x50107b+=_0x2c6da3(0x1db)+_0x1e389f[_0x2c6da3(0x1a1)]+'\x0a',_0x50107b+='ðŸ“¦\x20Node:\x20'+_0x1e389f['nodeVersion']+'\x0a',_0x50107b+='â±\x20Uptime:\x20'+Math[_0x2c6da3(0x1f3)](_0x1e389f[_0x2c6da3(0x168)])+'s',await this['bot']?.[_0x2c6da3(0x20c)](_0xbd49c5,_0x50107b,{'parse_mode':_0x2c6da3(0x1b3)});}catch(_0x294e4b){console['error'](_0x2c6da3(0x205),_0x294e4b),await this[_0x2c6da3(0x1e6)]?.[_0x2c6da3(0x20c)](_0xbd49c5,'âŒ\x20Error\x20getting\x20debug\x20information');}}),this[_0x48709c(0x1e6)][_0x48709c(0x1b1)](/\/statistics/,async _0x468100=>{const _0x18f5fb=_0x48709c,_0xbae8f1=_0x468100[_0x18f5fb(0x1e9)]['id'],_0x36696f=_0x468100[_0x18f5fb(0x1c1)]?.['id'][_0x18f5fb(0x1d0)]();if(!_0x36696f)return;if(!this[_0x18f5fb(0x1ad)](_0x36696f)){await this['bot']?.['sendMessage'](_0xbae8f1,'â›”ï¸\x20Access\x20Denied');return;}const _0x5c4fb9={'inline_keyboard':[[{'text':_0x18f5fb(0x1a3),'callback_data':_0x18f5fb(0x19a)}],[{'text':_0x18f5fb(0x1d5),'callback_data':'stats_yesterday'}],[{'text':'ðŸ“…\x20This\x20Month','callback_data':_0x18f5fb(0x169)}],[{'text':_0x18f5fb(0x1cf),'callback_data':_0x18f5fb(0x1dd)}],[{'text':'ðŸ“…\x20All\x20Time','callback_data':_0x18f5fb(0x1f6)}]]};await this[_0x18f5fb(0x1e6)]?.['sendMessage'](_0xbae8f1,_0x18f5fb(0x1d2),{'parse_mode':'Markdown','reply_markup':_0x5c4fb9});}),this[_0x48709c(0x1e6)]['on']('callback_query',async _0x355497=>{const _0x53bd2b=_0x48709c,_0x3325d4=_0x355497[_0x53bd2b(0x194)]?.['chat']['id'],_0x30b1d7=_0x355497[_0x53bd2b(0x1c1)]?.['id'][_0x53bd2b(0x1d0)](),_0x1a8f31=_0x355497[_0x53bd2b(0x204)];if(!_0x3325d4||!_0x30b1d7||!_0x1a8f31)return;if(!this[_0x53bd2b(0x1ad)](_0x30b1d7)){await this[_0x53bd2b(0x1e6)]?.[_0x53bd2b(0x1c3)](_0x355497['id'],{'text':_0x53bd2b(0x1fa)});return;}if(_0x1a8f31===_0x53bd2b(0x1fe)){const _0x1e3913={'inline_keyboard':[[{'text':_0x53bd2b(0x1a3),'callback_data':'stats_today'}],[{'text':_0x53bd2b(0x1d5),'callback_data':'stats_yesterday'}],[{'text':_0x53bd2b(0x17a),'callback_data':_0x53bd2b(0x169)}],[{'text':'ðŸ“…\x20Last\x20Month','callback_data':_0x53bd2b(0x1dd)}],[{'text':_0x53bd2b(0x1cc),'callback_data':'stats_all_time'}],[{'text':_0x53bd2b(0x1d4),'callback_data':_0x53bd2b(0x1c2)}]]};await this['bot']?.[_0x53bd2b(0x15f)](_0x53bd2b(0x1d2),{'chat_id':_0x3325d4,'message_id':_0x355497['message']?.['message_id'],'parse_mode':_0x53bd2b(0x1b3),'reply_markup':_0x1e3913}),await this[_0x53bd2b(0x1e6)]?.[_0x53bd2b(0x1c3)](_0x355497['id']);}else{if(_0x1a8f31===_0x53bd2b(0x174))try{const _0x409071={'botActive':!!this[_0x53bd2b(0x1e6)],'adminCount':this[_0x53bd2b(0x17e)][_0x53bd2b(0x200)][_0x53bd2b(0x1e3)],'admins':this[_0x53bd2b(0x17e)][_0x53bd2b(0x200)],'yourId':_0x30b1d7,'timestamp':new Date()[_0x53bd2b(0x1d3)](),'nodeVersion':process[_0x53bd2b(0x1a4)],'uptime':process[_0x53bd2b(0x168)]()};let _0x15a85f=_0x53bd2b(0x1b0);_0x15a85f+='ðŸ¤–\x20Bot\x20Status:\x20'+(_0x409071[_0x53bd2b(0x18a)]?_0x53bd2b(0x1a8):'âŒ\x20Inactive')+'\x0a',_0x15a85f+=_0x53bd2b(0x16b)+_0x409071['adminCount']+'\x0a',_0x15a85f+=_0x53bd2b(0x1c6)+_0x409071[_0x53bd2b(0x180)][_0x53bd2b(0x1aa)](',\x20')+'`\x0a',_0x15a85f+=_0x53bd2b(0x203)+_0x409071[_0x53bd2b(0x18d)]+'`\x0a',_0x15a85f+=_0x53bd2b(0x1db)+_0x409071[_0x53bd2b(0x1a1)]+'\x0a',_0x15a85f+='ðŸ“¦\x20Node:\x20'+_0x409071['nodeVersion']+'\x0a',_0x15a85f+=_0x53bd2b(0x15e)+Math[_0x53bd2b(0x1f3)](_0x409071[_0x53bd2b(0x168)])+'s';const _0x5830ec={'inline_keyboard':[[{'text':_0x53bd2b(0x1e0),'callback_data':_0x53bd2b(0x1c2)}]]};await this[_0x53bd2b(0x1e6)]?.['editMessageText'](_0x15a85f,{'chat_id':_0x3325d4,'message_id':_0x355497[_0x53bd2b(0x194)]?.['message_id'],'parse_mode':_0x53bd2b(0x1b3),'reply_markup':_0x5830ec}),await this[_0x53bd2b(0x1e6)]?.['answerCallbackQuery'](_0x355497['id']);}catch(_0x70d545){console['error'](_0x53bd2b(0x19b),_0x70d545),await this['bot']?.['answerCallbackQuery'](_0x355497['id'],{'text':'âŒ\x20Error\x20getting\x20debug\x20information'});}else{if(_0x1a8f31==='cmd_broadcast')this[_0x53bd2b(0x20e)][_0x53bd2b(0x1f1)](_0x3325d4,{'step':_0x53bd2b(0x175)}),await this[_0x53bd2b(0x1e6)]?.['editMessageText'](_0x53bd2b(0x1dc),{'chat_id':_0x3325d4,'message_id':_0x355497[_0x53bd2b(0x194)]?.['message_id'],'parse_mode':_0x53bd2b(0x1b3)}),await this[_0x53bd2b(0x1e6)]?.[_0x53bd2b(0x1c3)](_0x355497['id']);else{if(_0x1a8f31===_0x53bd2b(0x1ce))this['broadcastSessions'][_0x53bd2b(0x16f)](_0x3325d4),await this[_0x53bd2b(0x1e6)]?.[_0x53bd2b(0x20c)](_0x3325d4,_0x53bd2b(0x1c0)),await this[_0x53bd2b(0x1e6)]?.['answerCallbackQuery'](_0x355497['id']);else{if(_0x1a8f31===_0x53bd2b(0x1f7)){const _0x1e08fa=this[_0x53bd2b(0x20e)]['get'](_0x3325d4);if(!_0x1e08fa||!_0x1e08fa[_0x53bd2b(0x160)]&&!_0x1e08fa[_0x53bd2b(0x19c)]){await this['bot']?.[_0x53bd2b(0x1c3)](_0x355497['id'],{'text':_0x53bd2b(0x17c)});return;}await this[_0x53bd2b(0x1e6)]?.[_0x53bd2b(0x1c3)](_0x355497['id'],{'text':_0x53bd2b(0x1ee)}),await this[_0x53bd2b(0x1e2)](_0x3325d4,_0x1e08fa[_0x53bd2b(0x160)]||'',_0x1e08fa[_0x53bd2b(0x19c)]),this[_0x53bd2b(0x20e)]['delete'](_0x3325d4);}else{if(_0x1a8f31[_0x53bd2b(0x1b5)](_0x53bd2b(0x18b)))await this[_0x53bd2b(0x1f9)](_0x3325d4,_0x1a8f31,_0x355497[_0x53bd2b(0x194)]?.['message_id']),await this[_0x53bd2b(0x1e6)]?.[_0x53bd2b(0x1c3)](_0x355497['id']);else{if(_0x1a8f31===_0x53bd2b(0x1c2)){const _0x5cd70e={'inline_keyboard':[[{'text':'ðŸ“ˆ\x20Statistics','callback_data':_0x53bd2b(0x1fe)}],[{'text':_0x53bd2b(0x183),'callback_data':_0x53bd2b(0x1ca)}],[{'text':_0x53bd2b(0x17f),'callback_data':_0x53bd2b(0x174)}]]};await this[_0x53bd2b(0x1e6)]?.['editMessageText']('ðŸ”\x20*TRAPAY\x20Admin\x20Bot*\x0a\x0aâœ…\x20You\x20are\x20authorized\x20as\x20admin.',{'chat_id':_0x3325d4,'message_id':_0x355497[_0x53bd2b(0x194)]?.[_0x53bd2b(0x1cb)],'parse_mode':_0x53bd2b(0x1b3),'reply_markup':_0x5cd70e}),await this[_0x53bd2b(0x1e6)]?.[_0x53bd2b(0x1c3)](_0x355497['id']);}else{if(_0x1a8f31==='back_to_stats_menu'){const _0x281a95={'inline_keyboard':[[{'text':'ï¿½\x20Today','callback_data':'stats_today'}],[{'text':_0x53bd2b(0x1bb),'callback_data':_0x53bd2b(0x19e)}],[{'text':_0x53bd2b(0x165),'callback_data':_0x53bd2b(0x169)}],[{'text':_0x53bd2b(0x1a9),'callback_data':'stats_last_month'}],[{'text':_0x53bd2b(0x16d),'callback_data':_0x53bd2b(0x1f6)}],[{'text':_0x53bd2b(0x1e0),'callback_data':_0x53bd2b(0x1c2)}]]};await this['bot']?.[_0x53bd2b(0x15f)](_0x53bd2b(0x1d2),{'chat_id':_0x3325d4,'message_id':_0x355497[_0x53bd2b(0x194)]?.[_0x53bd2b(0x1cb)],'parse_mode':_0x53bd2b(0x1b3),'reply_markup':_0x281a95}),await this[_0x53bd2b(0x1e6)]?.[_0x53bd2b(0x1c3)](_0x355497['id']);}}}}}}}}}),this[_0x48709c(0x1e6)]['on']('message',async _0x7356df=>{const _0x156f3c=_0x48709c,_0x429ecb=_0x7356df[_0x156f3c(0x1e9)]['id'],_0x4162a9=_0x7356df[_0x156f3c(0x1c1)]?.['id'][_0x156f3c(0x1d0)](),_0x1dd7cb=_0x7356df[_0x156f3c(0x160)]||_0x7356df[_0x156f3c(0x171)],_0x403447=_0x7356df['photo'];if(!_0x4162a9)return;if(!this[_0x156f3c(0x1ad)](_0x4162a9))return;if(_0x1dd7cb&&_0x1dd7cb[_0x156f3c(0x1b5)]('/'))return;const _0x3ca48f=this['broadcastSessions'][_0x156f3c(0x181)](_0x429ecb);if(!_0x3ca48f)return;if(_0x3ca48f[_0x156f3c(0x161)]===_0x156f3c(0x175)){if(!_0x1dd7cb&&!_0x403447)return;_0x3ca48f[_0x156f3c(0x160)]=_0x1dd7cb||'';_0x403447&&_0x403447[_0x156f3c(0x1e3)]>0x0&&(_0x3ca48f['photoFileId']=_0x403447[_0x403447[_0x156f3c(0x1e3)]-0x1][_0x156f3c(0x1c4)]);_0x3ca48f['step']=_0x156f3c(0x1a7);const _0x545069={'inline_keyboard':[[{'text':_0x156f3c(0x1fb),'callback_data':_0x156f3c(0x1ce)},{'text':'ðŸ“¤\x20Send','callback_data':'broadcast_send'}]]};_0x3ca48f[_0x156f3c(0x19c)]?await this[_0x156f3c(0x1e6)]?.['sendPhoto'](_0x429ecb,_0x3ca48f[_0x156f3c(0x19c)],{'caption':_0x156f3c(0x19d)+_0x3ca48f[_0x156f3c(0x160)]+_0x156f3c(0x19f),'parse_mode':_0x156f3c(0x1b3),'reply_markup':_0x545069}):await this[_0x156f3c(0x1e6)]?.[_0x156f3c(0x20c)](_0x429ecb,'ðŸ“¢\x20*Broadcast\x20Preview*\x0a\x0a'+_0x3ca48f[_0x156f3c(0x160)]+_0x156f3c(0x19f),{'parse_mode':'Markdown','reply_markup':_0x545069});}}),this['bot']['on'](_0x48709c(0x1c9),_0x1096c6=>{const _0x393409=_0x48709c;console[_0x393409(0x1c9)]('Admin\x20Telegram\x20bot\x20error:',_0x1096c6);});}async['handleBroadcast'](_0x1f23e9,_0x5c1dc4,_0x4c7889){const _0x4d00a1=a52_0x3c8239;try{const _0x46d29b=require(_0x4d00a1(0x193))[_0x4d00a1(0x192)],_0x181005=require('node-telegram-bot-api'),_0x4a00fa=process.env.TELEGRAM_BOT_TOKEN;if(!_0x4a00fa){await this[_0x4d00a1(0x1e6)]?.['sendMessage'](_0x1f23e9,_0x4d00a1(0x1ed));return;}const _0x2442ec=new _0x181005(_0x4a00fa),_0x3fbe99=await _0x46d29b[_0x4d00a1(0x176)]['findMany']({'where':{'shopId':{'not':null},'isVerified':!![]},'select':{'telegramId':!![]}}),_0x1d9d5d=_0x3fbe99[_0x4d00a1(0x1e3)];let _0x45e709=0x0,_0x4d8d87=0x0,_0x3bb208=0x0;await this['bot']?.[_0x4d00a1(0x20c)](_0x1f23e9,_0x4d00a1(0x206)+_0x1d9d5d+_0x4d00a1(0x197));let _0x20d7e6=null;if(_0x4c7889&&this['bot'])try{const _0x223211=await this['bot'][_0x4d00a1(0x17d)](_0x4c7889),_0x1cbf04=await fetch(_0x223211);_0x20d7e6=Buffer[_0x4d00a1(0x1c1)](await _0x1cbf04[_0x4d00a1(0x187)]());}catch(_0x106a5e){console[_0x4d00a1(0x1c9)](_0x4d00a1(0x177),_0x106a5e),await this[_0x4d00a1(0x1e6)]?.['sendMessage'](_0x1f23e9,'âŒ\x20Failed\x20to\x20download\x20photo');return;}for(const _0x3d36c4 of _0x3fbe99){try{_0x20d7e6?await _0x2442ec[_0x4d00a1(0x208)](_0x3d36c4[_0x4d00a1(0x1ea)],_0x20d7e6,{'caption':_0x5c1dc4,'parse_mode':_0x4d00a1(0x1b3)}):await _0x2442ec[_0x4d00a1(0x20c)](_0x3d36c4[_0x4d00a1(0x1ea)],_0x5c1dc4,{'parse_mode':_0x4d00a1(0x1b3)}),_0x45e709++,_0x4d8d87++,await new Promise(_0x55dfde=>setTimeout(_0x55dfde,0x64));}catch(_0xb92f22){_0x45e709++,_0x3bb208++,console[_0x4d00a1(0x1c9)](_0x4d00a1(0x20a)+_0x3d36c4[_0x4d00a1(0x1ea)]+':',_0xb92f22[_0x4d00a1(0x194)]);}}const _0x3be5e1=_0x4d00a1(0x1cd)+(_0x4d00a1(0x1b8)+_0x1d9d5d+'\x0a')+(_0x4d00a1(0x178)+_0x45e709+'\x0a')+(_0x4d00a1(0x1ba)+_0x4d8d87+'\x0a')+('âŒ\x20Not\x20Delivered:\x20'+_0x3bb208);await this[_0x4d00a1(0x1e6)]?.[_0x4d00a1(0x20c)](_0x1f23e9,_0x3be5e1,{'parse_mode':_0x4d00a1(0x1b3)});}catch(_0x3be9da){console[_0x4d00a1(0x1c9)](_0x4d00a1(0x184),_0x3be9da),await this['bot']?.[_0x4d00a1(0x20c)](_0x1f23e9,_0x4d00a1(0x186));}}async[a52_0x3c8239(0x1f9)](_0x2ea165,_0x203ccc,_0x1da6ae){const _0x229ac9=a52_0x3c8239;try{const _0x342511=require(_0x229ac9(0x193))[_0x229ac9(0x192)],_0x404ffc=new Date();let _0x3b1516,_0xbd13f0,_0x279206;switch(_0x203ccc){case _0x229ac9(0x19a):{const _0xfcee32=new Date(Date['UTC'](_0x404ffc[_0x229ac9(0x182)](),_0x404ffc[_0x229ac9(0x15d)](),_0x404ffc[_0x229ac9(0x172)]()));_0x3b1516=_0xfcee32,_0xbd13f0=new Date(Date[_0x229ac9(0x1ab)](_0x404ffc[_0x229ac9(0x182)](),_0x404ffc[_0x229ac9(0x15d)](),_0x404ffc[_0x229ac9(0x172)](),0x17,0x3b,0x3b,0x3e7)),_0x279206=_0xfcee32[_0x229ac9(0x172)]()[_0x229ac9(0x1d0)]()[_0x229ac9(0x1ec)](0x2,'0')+'.'+(_0xfcee32['getUTCMonth']()+0x1)[_0x229ac9(0x1d0)]()['padStart'](0x2,'0')+'.'+_0xfcee32[_0x229ac9(0x182)]();break;}case _0x229ac9(0x19e):{const _0x10e34e=new Date(Date[_0x229ac9(0x1ab)](_0x404ffc[_0x229ac9(0x182)](),_0x404ffc[_0x229ac9(0x15d)](),_0x404ffc['getUTCDate']()-0x1));_0x3b1516=_0x10e34e,_0xbd13f0=new Date(Date[_0x229ac9(0x1ab)](_0x404ffc[_0x229ac9(0x182)](),_0x404ffc[_0x229ac9(0x15d)](),_0x404ffc[_0x229ac9(0x172)]()-0x1,0x17,0x3b,0x3b,0x3e7)),_0x279206=_0x10e34e[_0x229ac9(0x172)]()['toString']()[_0x229ac9(0x1ec)](0x2,'0')+'.'+(_0x10e34e['getUTCMonth']()+0x1)[_0x229ac9(0x1d0)]()['padStart'](0x2,'0')+'.'+_0x10e34e[_0x229ac9(0x182)]();break;}case _0x229ac9(0x169):{const _0x44734c=new Date(Date[_0x229ac9(0x1ab)](_0x404ffc['getUTCFullYear'](),_0x404ffc['getUTCMonth'](),0x1));_0x3b1516=_0x44734c,_0xbd13f0=new Date(Date[_0x229ac9(0x1ab)](_0x404ffc['getUTCFullYear'](),_0x404ffc[_0x229ac9(0x15d)]()+0x1,0x0,0x17,0x3b,0x3b,0x3e7));const _0x72c69c=new Date(Date[_0x229ac9(0x1ab)](_0x404ffc[_0x229ac9(0x182)](),_0x404ffc[_0x229ac9(0x15d)]()+0x1,0x0));_0x279206=_0x44734c['getUTCDate']()[_0x229ac9(0x1d0)]()[_0x229ac9(0x1ec)](0x2,'0')+'.'+(_0x44734c[_0x229ac9(0x15d)]()+0x1)['toString']()[_0x229ac9(0x1ec)](0x2,'0')+'.'+_0x44734c['getUTCFullYear']()+_0x229ac9(0x1eb)+_0x72c69c['getUTCDate']()[_0x229ac9(0x1d0)]()[_0x229ac9(0x1ec)](0x2,'0')+'.'+(_0x72c69c[_0x229ac9(0x15d)]()+0x1)[_0x229ac9(0x1d0)]()[_0x229ac9(0x1ec)](0x2,'0')+'.'+_0x72c69c[_0x229ac9(0x182)]();break;}case _0x229ac9(0x1dd):{const _0x1e7694=new Date(Date[_0x229ac9(0x1ab)](_0x404ffc['getUTCFullYear'](),_0x404ffc['getUTCMonth']()-0x1,0x1));_0x3b1516=_0x1e7694,_0xbd13f0=new Date(Date[_0x229ac9(0x1ab)](_0x404ffc[_0x229ac9(0x182)](),_0x404ffc[_0x229ac9(0x15d)](),0x0,0x17,0x3b,0x3b,0x3e7));const _0x259faf=new Date(Date[_0x229ac9(0x1ab)](_0x404ffc['getUTCFullYear'](),_0x404ffc[_0x229ac9(0x15d)](),0x0));_0x279206=_0x1e7694[_0x229ac9(0x172)]()['toString']()['padStart'](0x2,'0')+'.'+(_0x1e7694[_0x229ac9(0x15d)]()+0x1)[_0x229ac9(0x1d0)]()[_0x229ac9(0x1ec)](0x2,'0')+'.'+_0x1e7694[_0x229ac9(0x182)]()+_0x229ac9(0x1eb)+_0x259faf['getUTCDate']()[_0x229ac9(0x1d0)]()['padStart'](0x2,'0')+'.'+(_0x259faf[_0x229ac9(0x15d)]()+0x1)[_0x229ac9(0x1d0)]()[_0x229ac9(0x1ec)](0x2,'0')+'.'+_0x259faf['getUTCFullYear']();break;}case _0x229ac9(0x1f6):{_0x3b1516=new Date(0x0),_0xbd13f0=_0x404ffc,_0x279206='All\x20Time';break;}default:return;}const _0x335548=await _0x342511[_0x229ac9(0x1e4)][_0x229ac9(0x1fc)]({'where':{'createdAt':{'gte':_0x3b1516,'lte':_0xbd13f0}},'select':{'status':!![],'amountUSDT':!![],'amountAfterGatewayCommissionUSDT':!![]}});let _0x4edadb=0x0,_0x24c433=0x0,_0xb1045d=0x0,_0x3c286e=0x0,_0x3b4895=0x0,_0x30de23=0x0;_0x335548[_0x229ac9(0x167)](_0x37caeb=>{const _0x197c16=_0x229ac9,_0x6b68d6=_0x37caeb['amountUSDT']||0x0,_0x4f0f5d=_0x37caeb[_0x197c16(0x1f5)]||0x0;if(_0x37caeb[_0x197c16(0x162)]===_0x197c16(0x164))_0x4edadb+=_0x6b68d6,_0x24c433+=_0x6b68d6-_0x4f0f5d,_0xb1045d++;else{if(_0x37caeb[_0x197c16(0x162)]===_0x197c16(0x1a5)||_0x37caeb[_0x197c16(0x162)]===_0x197c16(0x1ae))_0x3c286e++;else{if(_0x37caeb[_0x197c16(0x162)]===_0x197c16(0x1af))_0x3b4895++,_0x4edadb+=_0x6b68d6;else _0x37caeb[_0x197c16(0x162)]===_0x197c16(0x198)&&(_0x30de23++,_0x4edadb+=_0x6b68d6);}}});const _0x4eeb3f=_0xb1045d+_0x3c286e,_0x4e0489=_0x4eeb3f>0x0?(_0xb1045d/_0x4eeb3f*0x64)['toFixed'](0x1):_0x229ac9(0x16a),_0x2a5c7c=_0x279206['replace'](/\./g,'\x5c.')['replace'](/\-/g,'\x5c-'),_0x227d6b=_0x4edadb[_0x229ac9(0x1ef)](0x2)['replace'](/\./g,'\x5c.'),_0x168979=_0x24c433[_0x229ac9(0x1ef)](0x2)[_0x229ac9(0x1df)](/\./g,'\x5c.'),_0x3ccde7=_0x4e0489[_0x229ac9(0x1df)](/\./g,'\x5c.'),_0x260c5b=_0x229ac9(0x1ff)+_0x2a5c7c+_0x229ac9(0x15c)+('ðŸ’°\x20Turnover\x20\x5c-\x20'+_0x227d6b+_0x229ac9(0x16e))+(_0x229ac9(0x1da)+_0x168979+'\x20USDT\x0a')+(_0x229ac9(0x1ac)+_0xb1045d+'\x0a')+('âŒ\x20Failed\x20Payments\x20\x5c-\x20'+_0x3c286e+'\x0a')+(_0x229ac9(0x18f)+_0x3ccde7+'%\x0a')+(_0x229ac9(0x1a0)+_0x3b4895+'\x0a')+(_0x229ac9(0x199)+_0x30de23),_0x300bed={'inline_keyboard':[[{'text':'â¬…ï¸\x20Back','callback_data':'back_to_stats_menu'}]]};_0x1da6ae?await this['bot']?.[_0x229ac9(0x15f)](_0x260c5b,{'chat_id':_0x2ea165,'message_id':_0x1da6ae,'parse_mode':_0x229ac9(0x1c7),'reply_markup':_0x300bed}):await this[_0x229ac9(0x1e6)]?.['sendMessage'](_0x2ea165,_0x260c5b,{'parse_mode':_0x229ac9(0x1c7),'reply_markup':_0x300bed});}catch(_0x28b0db){console['error'](_0x229ac9(0x173),_0x28b0db),await this[_0x229ac9(0x1e6)]?.['sendMessage'](_0x2ea165,'âŒ\x20Error\x20getting\x20statistics');}}[a52_0x3c8239(0x17b)](_0x1f11a1){const _0x35b813=a52_0x3c8239;this[_0x35b813(0x17e)]['adminIds']=_0x1f11a1[_0x35b813(0x1bc)](_0x8900cd=>_0x8900cd&&_0x8900cd['trim']()),this[_0x35b813(0x1bd)](),console['log'](_0x35b813(0x1b6),this[_0x35b813(0x17e)]['adminIds']);}['getAdminIds'](){const _0x1f7bd3=a52_0x3c8239;return[...this[_0x1f7bd3(0x17e)][_0x1f7bd3(0x200)]];}[a52_0x3c8239(0x20b)](){const _0x109c4a=a52_0x3c8239;return{'isActive':!!this[_0x109c4a(0x1e6)],'adminCount':this[_0x109c4a(0x17e)][_0x109c4a(0x200)]['length']};}['stopBot'](){const _0x286ea2=a52_0x3c8239;this['bot']&&(this['bot'][_0x286ea2(0x196)](),this['bot']=null,console[_0x286ea2(0x1d9)](_0x286ea2(0x1b9)));}}exports[a52_0x3c8239(0x170)]=AdminBotService,exports[a52_0x3c8239(0x1d1)]=new AdminBotService();