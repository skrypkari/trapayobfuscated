'use strict';const a52_0x213984=a52_0x30f8;(function(_0x44037a,_0x2659fa){const _0x41542c=a52_0x30f8,_0x37120c=_0x44037a();while(!![]){try{const _0x38bb0b=parseInt(_0x41542c(0x1fd))/0x1+-parseInt(_0x41542c(0x218))/0x2+parseInt(_0x41542c(0x295))/0x3+-parseInt(_0x41542c(0x29d))/0x4+-parseInt(_0x41542c(0x247))/0x5*(-parseInt(_0x41542c(0x280))/0x6)+parseInt(_0x41542c(0x205))/0x7+parseInt(_0x41542c(0x229))/0x8*(parseInt(_0x41542c(0x214))/0x9);if(_0x38bb0b===_0x2659fa)break;else _0x37120c['push'](_0x37120c['shift']());}catch(_0x489cb7){_0x37120c['push'](_0x37120c['shift']());}}}(a52_0x2c87,0xe48b9));function a52_0x30f8(_0x597034,_0x4a77cb){_0x597034=_0x597034-0x1eb;const _0x2c8778=a52_0x2c87();let _0x30f865=_0x2c8778[_0x597034];return _0x30f865;}var __importDefault=this&&this[a52_0x213984(0x251)]||function(_0x53d8ca){return _0x53d8ca&&_0x53d8ca['__esModule']?_0x53d8ca:{'default':_0x53d8ca};};Object[a52_0x213984(0x1f3)](exports,a52_0x213984(0x21a),{'value':!![]}),exports[a52_0x213984(0x27f)]=exports[a52_0x213984(0x28d)]=void 0x0;const node_telegram_bot_api_1=__importDefault(require('node-telegram-bot-api')),fs_1=__importDefault(require('fs')),path_1=__importDefault(require(a52_0x213984(0x235))),CONFIG_PATH=path_1[a52_0x213984(0x24c)][a52_0x213984(0x1fe)](process['cwd'](),a52_0x213984(0x24d),a52_0x213984(0x287));class AdminBotService{constructor(){const _0x5927f2=a52_0x213984;this[_0x5927f2(0x252)]=null,this[_0x5927f2(0x292)]=new Map(),this[_0x5927f2(0x238)]=process.env.TELEGRAM_ADMIN_BOT_TOKEN||'',this[_0x5927f2(0x260)]=this[_0x5927f2(0x222)](),this['botToken']?this[_0x5927f2(0x22c)]():console['warn']('TELEGRAM_ADMIN_BOT_TOKEN\x20not\x20found\x20in\x20environment\x20variables');}['loadConfig'](){const _0x4a1dbb=a52_0x213984;try{if(fs_1[_0x4a1dbb(0x24c)][_0x4a1dbb(0x283)](CONFIG_PATH)){const _0x170203=fs_1[_0x4a1dbb(0x24c)][_0x4a1dbb(0x29c)](CONFIG_PATH,_0x4a1dbb(0x250));return JSON[_0x4a1dbb(0x232)](_0x170203);}}catch(_0x448ba4){console[_0x4a1dbb(0x27a)](_0x4a1dbb(0x26b),_0x448ba4);}return{'adminIds':[]};}[a52_0x213984(0x27e)](){const _0x287fa7=a52_0x213984;try{const _0x4b54bd=path_1[_0x287fa7(0x24c)][_0x287fa7(0x20c)](CONFIG_PATH);!fs_1[_0x287fa7(0x24c)][_0x287fa7(0x283)](_0x4b54bd)&&fs_1[_0x287fa7(0x24c)][_0x287fa7(0x215)](_0x4b54bd,{'recursive':!![]}),fs_1[_0x287fa7(0x24c)]['writeFileSync'](CONFIG_PATH,JSON[_0x287fa7(0x26c)](this['config'],null,0x2));}catch(_0x9a023){console[_0x287fa7(0x27a)](_0x287fa7(0x230),_0x9a023);}}['isAdmin'](_0x5ea72f){const _0x3ccc81=a52_0x213984;return this[_0x3ccc81(0x260)]['adminIds'][_0x3ccc81(0x243)](_0x5ea72f);}[a52_0x213984(0x22c)](){const _0x555589=a52_0x213984;try{this[_0x555589(0x252)]=new node_telegram_bot_api_1[(_0x555589(0x24c))](this[_0x555589(0x238)],{'polling':!![]}),this['setupBotHandlers'](),console[_0x555589(0x28e)](_0x555589(0x26a));}catch(_0x1cb034){console[_0x555589(0x27a)](_0x555589(0x28b),_0x1cb034);}}['setupBotHandlers'](){const _0x31080c=a52_0x213984;if(!this[_0x31080c(0x252)])return;this[_0x31080c(0x252)][_0x31080c(0x20e)](/\/start/,async _0x2ca437=>{const _0x482d59=_0x31080c,_0x23d74c=_0x2ca437['chat']['id'],_0x19ce24=_0x2ca437[_0x482d59(0x249)]?.['id'][_0x482d59(0x210)]();if(!_0x19ce24)return;if(this[_0x482d59(0x22e)](_0x19ce24)){const _0x408051={'inline_keyboard':[[{'text':_0x482d59(0x293),'callback_data':_0x482d59(0x257)}],[{'text':_0x482d59(0x20f),'callback_data':_0x482d59(0x263)}],[{'text':'ğŸ”§\x20Debug','callback_data':_0x482d59(0x26d)}]]};await this[_0x482d59(0x252)]?.[_0x482d59(0x1f1)](_0x23d74c,_0x482d59(0x233),{'parse_mode':_0x482d59(0x255),'reply_markup':_0x408051});}else await this[_0x482d59(0x252)]?.[_0x482d59(0x1f1)](_0x23d74c,_0x482d59(0x213)+_0x482d59(0x209)+_0x482d59(0x29b),{'parse_mode':_0x482d59(0x255)});}),this['bot'][_0x31080c(0x20e)](/\/debug/,async _0x2de5a3=>{const _0x2677d0=_0x31080c,_0x4745c9=_0x2de5a3[_0x2677d0(0x244)]['id'],_0x1977b9=_0x2de5a3['from']?.['id'][_0x2677d0(0x210)]();if(!_0x1977b9)return;if(!this['isAdmin'](_0x1977b9)){await this[_0x2677d0(0x252)]?.['sendMessage'](_0x4745c9,_0x2677d0(0x265));return;}try{const _0xa2d23={'botActive':!!this[_0x2677d0(0x252)],'adminCount':this[_0x2677d0(0x260)]['adminIds'][_0x2677d0(0x1f6)],'admins':this[_0x2677d0(0x260)][_0x2677d0(0x267)],'yourId':_0x1977b9,'timestamp':new Date()['toISOString'](),'nodeVersion':process[_0x2677d0(0x266)],'uptime':process[_0x2677d0(0x20d)]()};let _0x3b1fc6=_0x2677d0(0x212);_0x3b1fc6+=_0x2677d0(0x275)+(_0xa2d23['botActive']?_0x2677d0(0x231):_0x2677d0(0x1eb))+'\x0a',_0x3b1fc6+=_0x2677d0(0x216)+_0xa2d23[_0x2677d0(0x272)]+'\x0a',_0x3b1fc6+=_0x2677d0(0x27b)+_0xa2d23['admins']['join'](',\x20')+'`\x0a',_0x3b1fc6+=_0x2677d0(0x221)+_0xa2d23[_0x2677d0(0x204)]+'`\x0a',_0x3b1fc6+=_0x2677d0(0x226)+_0xa2d23[_0x2677d0(0x21d)]+'\x0a',_0x3b1fc6+=_0x2677d0(0x227)+_0xa2d23[_0x2677d0(0x223)]+'\x0a',_0x3b1fc6+='â±\x20Uptime:\x20'+Math[_0x2677d0(0x21b)](_0xa2d23['uptime'])+'s',await this[_0x2677d0(0x252)]?.[_0x2677d0(0x1f1)](_0x4745c9,_0x3b1fc6,{'parse_mode':_0x2677d0(0x255)});}catch(_0x2565b9){console[_0x2677d0(0x27a)](_0x2677d0(0x29a),_0x2565b9),await this[_0x2677d0(0x252)]?.[_0x2677d0(0x1f1)](_0x4745c9,_0x2677d0(0x264));}}),this['bot']['onText'](/\/statistics/,async _0x20b8e4=>{const _0x5e5a9f=_0x31080c,_0x3a7737=_0x20b8e4['chat']['id'],_0x3c9250=_0x20b8e4['from']?.['id'][_0x5e5a9f(0x210)]();if(!_0x3c9250)return;if(!this[_0x5e5a9f(0x22e)](_0x3c9250)){await this[_0x5e5a9f(0x252)]?.[_0x5e5a9f(0x1f1)](_0x3a7737,_0x5e5a9f(0x265));return;}const _0x2497f8={'inline_keyboard':[[{'text':_0x5e5a9f(0x228),'callback_data':_0x5e5a9f(0x296)}],[{'text':_0x5e5a9f(0x237),'callback_data':'stats_yesterday'}],[{'text':_0x5e5a9f(0x285),'callback_data':'stats_this_month'}],[{'text':_0x5e5a9f(0x276),'callback_data':_0x5e5a9f(0x23c)}],[{'text':'ğŸ“…\x20All\x20Time','callback_data':_0x5e5a9f(0x207)}]]};await this[_0x5e5a9f(0x252)]?.[_0x5e5a9f(0x1f1)](_0x3a7737,_0x5e5a9f(0x25a),{'parse_mode':'Markdown','reply_markup':_0x2497f8});}),this[_0x31080c(0x252)]['on'](_0x31080c(0x273),async _0x3f4ee5=>{const _0x36e97b=_0x31080c,_0x195e71=_0x3f4ee5['message']?.[_0x36e97b(0x244)]['id'],_0x47ca3b=_0x3f4ee5[_0x36e97b(0x249)]?.['id']['toString'](),_0x4a9eb0=_0x3f4ee5[_0x36e97b(0x24d)];if(!_0x195e71||!_0x47ca3b||!_0x4a9eb0)return;if(!this[_0x36e97b(0x22e)](_0x47ca3b)){await this['bot']?.[_0x36e97b(0x288)](_0x3f4ee5['id'],{'text':_0x36e97b(0x265)});return;}if(_0x4a9eb0==='cmd_statistics'){const _0x4056e5={'inline_keyboard':[[{'text':_0x36e97b(0x228),'callback_data':'stats_today'}],[{'text':'ğŸ“…\x20Yesterday','callback_data':_0x36e97b(0x1f8)}],[{'text':_0x36e97b(0x285),'callback_data':_0x36e97b(0x201)}],[{'text':_0x36e97b(0x276),'callback_data':_0x36e97b(0x23c)}],[{'text':'ğŸ“…\x20All\x20Time','callback_data':'stats_all_time'}],[{'text':_0x36e97b(0x211),'callback_data':'back_to_main'}]]};await this['bot']?.[_0x36e97b(0x1f4)](_0x36e97b(0x25a),{'chat_id':_0x195e71,'message_id':_0x3f4ee5[_0x36e97b(0x269)]?.['message_id'],'parse_mode':_0x36e97b(0x255),'reply_markup':_0x4056e5}),await this[_0x36e97b(0x252)]?.[_0x36e97b(0x288)](_0x3f4ee5['id']);}else{if(_0x4a9eb0===_0x36e97b(0x26d))try{const _0x4de61a={'botActive':!!this['bot'],'adminCount':this['config'][_0x36e97b(0x267)][_0x36e97b(0x1f6)],'admins':this['config'][_0x36e97b(0x267)],'yourId':_0x47ca3b,'timestamp':new Date()[_0x36e97b(0x299)](),'nodeVersion':process['version'],'uptime':process[_0x36e97b(0x20d)]()};let _0x29aba6='ğŸ”\x20*Debug\x20Information*\x0a\x0a';_0x29aba6+=_0x36e97b(0x275)+(_0x4de61a[_0x36e97b(0x239)]?'âœ…\x20Active':_0x36e97b(0x1eb))+'\x0a',_0x29aba6+='ğŸ‘¥\x20Admin\x20Count:\x20'+_0x4de61a['adminCount']+'\x0a',_0x29aba6+=_0x36e97b(0x27b)+_0x4de61a[_0x36e97b(0x24f)]['join'](',\x20')+'`\x0a',_0x29aba6+=_0x36e97b(0x221)+_0x4de61a[_0x36e97b(0x204)]+'`\x0a',_0x29aba6+=_0x36e97b(0x226)+_0x4de61a[_0x36e97b(0x21d)]+'\x0a',_0x29aba6+=_0x36e97b(0x227)+_0x4de61a[_0x36e97b(0x223)]+'\x0a',_0x29aba6+=_0x36e97b(0x25c)+Math['floor'](_0x4de61a[_0x36e97b(0x20d)])+'s';const _0x12484f={'inline_keyboard':[[{'text':_0x36e97b(0x24a),'callback_data':'back_to_main'}]]};await this[_0x36e97b(0x252)]?.['editMessageText'](_0x29aba6,{'chat_id':_0x195e71,'message_id':_0x3f4ee5[_0x36e97b(0x269)]?.[_0x36e97b(0x245)],'parse_mode':_0x36e97b(0x255),'reply_markup':_0x12484f}),await this[_0x36e97b(0x252)]?.[_0x36e97b(0x288)](_0x3f4ee5['id']);}catch(_0x2d33bf){console[_0x36e97b(0x27a)]('Error\x20handling\x20debug\x20command:',_0x2d33bf),await this['bot']?.['answerCallbackQuery'](_0x3f4ee5['id'],{'text':_0x36e97b(0x264)});}else{if(_0x4a9eb0===_0x36e97b(0x263))this[_0x36e97b(0x292)][_0x36e97b(0x25d)](_0x195e71,{'step':_0x36e97b(0x241)}),await this[_0x36e97b(0x252)]?.[_0x36e97b(0x1f4)](_0x36e97b(0x22d),{'chat_id':_0x195e71,'message_id':_0x3f4ee5[_0x36e97b(0x269)]?.[_0x36e97b(0x245)],'parse_mode':'Markdown'}),await this[_0x36e97b(0x252)]?.[_0x36e97b(0x288)](_0x3f4ee5['id']);else{if(_0x4a9eb0===_0x36e97b(0x27c))this[_0x36e97b(0x292)][_0x36e97b(0x29e)](_0x195e71),await this[_0x36e97b(0x252)]?.[_0x36e97b(0x1f1)](_0x195e71,'âŒ\x20Broadcast\x20cancelled'),await this[_0x36e97b(0x252)]?.['answerCallbackQuery'](_0x3f4ee5['id']);else{if(_0x4a9eb0===_0x36e97b(0x23a)){const _0x1cbb32=this['broadcastSessions'][_0x36e97b(0x1ec)](_0x195e71);if(!_0x1cbb32||!_0x1cbb32['text']&&!_0x1cbb32[_0x36e97b(0x290)]){await this[_0x36e97b(0x252)]?.['answerCallbackQuery'](_0x3f4ee5['id'],{'text':_0x36e97b(0x23b)});return;}await this[_0x36e97b(0x252)]?.['answerCallbackQuery'](_0x3f4ee5['id'],{'text':_0x36e97b(0x279)}),await this[_0x36e97b(0x298)](_0x195e71,_0x1cbb32[_0x36e97b(0x297)]||'',_0x1cbb32[_0x36e97b(0x290)]),this['broadcastSessions'][_0x36e97b(0x29e)](_0x195e71);}else{if(_0x4a9eb0[_0x36e97b(0x281)]('stats_'))await this['handleStatistics'](_0x195e71,_0x4a9eb0,_0x3f4ee5[_0x36e97b(0x269)]?.[_0x36e97b(0x245)]),await this[_0x36e97b(0x252)]?.['answerCallbackQuery'](_0x3f4ee5['id']);else{if(_0x4a9eb0===_0x36e97b(0x291)){const _0x1cd24c={'inline_keyboard':[[{'text':_0x36e97b(0x293),'callback_data':_0x36e97b(0x257)}],[{'text':_0x36e97b(0x20f),'callback_data':_0x36e97b(0x263)}],[{'text':_0x36e97b(0x21f),'callback_data':'cmd_debug'}]]};await this[_0x36e97b(0x252)]?.['editMessageText'](_0x36e97b(0x233),{'chat_id':_0x195e71,'message_id':_0x3f4ee5[_0x36e97b(0x269)]?.['message_id'],'parse_mode':_0x36e97b(0x255),'reply_markup':_0x1cd24c}),await this[_0x36e97b(0x252)]?.[_0x36e97b(0x288)](_0x3f4ee5['id']);}else{if(_0x4a9eb0==='back_to_stats_menu'){const _0x2124da={'inline_keyboard':[[{'text':_0x36e97b(0x26e),'callback_data':_0x36e97b(0x296)}],[{'text':_0x36e97b(0x1f2),'callback_data':_0x36e97b(0x1f8)}],[{'text':_0x36e97b(0x1ee),'callback_data':_0x36e97b(0x201)}],[{'text':_0x36e97b(0x28c),'callback_data':_0x36e97b(0x23c)}],[{'text':'ğŸ“†\x20All\x20Time','callback_data':_0x36e97b(0x207)}],[{'text':_0x36e97b(0x24a),'callback_data':_0x36e97b(0x291)}]]};await this[_0x36e97b(0x252)]?.[_0x36e97b(0x1f4)](_0x36e97b(0x25a),{'chat_id':_0x195e71,'message_id':_0x3f4ee5['message']?.[_0x36e97b(0x245)],'parse_mode':'Markdown','reply_markup':_0x2124da}),await this[_0x36e97b(0x252)]?.[_0x36e97b(0x288)](_0x3f4ee5['id']);}}}}}}}}}),this['bot']['on']('message',async _0x57dc22=>{const _0x49aefc=_0x31080c,_0x1d9deb=_0x57dc22[_0x49aefc(0x244)]['id'],_0x4f8a01=_0x57dc22[_0x49aefc(0x249)]?.['id'][_0x49aefc(0x210)](),_0x2514b4=_0x57dc22[_0x49aefc(0x297)]||_0x57dc22['caption'],_0x58f504=_0x57dc22['photo'];if(!_0x4f8a01)return;if(!this[_0x49aefc(0x22e)](_0x4f8a01))return;if(_0x2514b4&&_0x2514b4['startsWith']('/'))return;const _0x1759e0=this[_0x49aefc(0x292)][_0x49aefc(0x1ec)](_0x1d9deb);if(!_0x1759e0)return;if(_0x1759e0[_0x49aefc(0x21e)]===_0x49aefc(0x241)){if(!_0x2514b4&&!_0x58f504)return;_0x1759e0[_0x49aefc(0x297)]=_0x2514b4||'';_0x58f504&&_0x58f504[_0x49aefc(0x1f6)]>0x0&&(_0x1759e0['photoFileId']=_0x58f504[_0x58f504[_0x49aefc(0x1f6)]-0x1][_0x49aefc(0x22f)]);_0x1759e0[_0x49aefc(0x21e)]='preview';const _0x10adcb={'inline_keyboard':[[{'text':_0x49aefc(0x254),'callback_data':'broadcast_cancel'},{'text':_0x49aefc(0x284),'callback_data':_0x49aefc(0x23a)}]]};_0x1759e0[_0x49aefc(0x290)]?await this[_0x49aefc(0x252)]?.['sendPhoto'](_0x1d9deb,_0x1759e0['photoFileId'],{'caption':'ğŸ“¢\x20*Broadcast\x20Preview*\x0a\x0a'+_0x1759e0['text']+_0x49aefc(0x268),'parse_mode':_0x49aefc(0x255),'reply_markup':_0x10adcb}):await this['bot']?.[_0x49aefc(0x1f1)](_0x1d9deb,_0x49aefc(0x219)+_0x1759e0['text']+_0x49aefc(0x268),{'parse_mode':_0x49aefc(0x255),'reply_markup':_0x10adcb});}}),this[_0x31080c(0x252)]['on'](_0x31080c(0x27a),_0x5c3ff=>{const _0x3f0a89=_0x31080c;console[_0x3f0a89(0x27a)](_0x3f0a89(0x200),_0x5c3ff);});}async['handleBroadcast'](_0x5491f4,_0x7cfe24,_0x5cfd43){const _0xe4e92c=a52_0x213984;try{const _0x354a65=require('../config/database')[_0xe4e92c(0x24c)],_0x2caa1c=require(_0xe4e92c(0x208)),_0x29f86e=process.env.TELEGRAM_BOT_TOKEN;if(!_0x29f86e){await this['bot']?.[_0xe4e92c(0x1f1)](_0x5491f4,_0xe4e92c(0x20b));return;}const _0x4fd86a=new _0x2caa1c(_0x29f86e),_0x1e6b34=await _0x354a65[_0xe4e92c(0x224)][_0xe4e92c(0x1fa)]({'where':{'shopId':{'not':null},'isVerified':!![]},'select':{'telegramId':!![]}}),_0x2b6007=_0x1e6b34[_0xe4e92c(0x1f6)];let _0x53a59f=0x0,_0x29acb7=0x0,_0x426236=0x0;await this[_0xe4e92c(0x252)]?.['sendMessage'](_0x5491f4,_0xe4e92c(0x274)+_0x2b6007+_0xe4e92c(0x236));let _0x5e3665=null;if(_0x5cfd43&&this[_0xe4e92c(0x252)])try{const _0x51f594=await this['bot'][_0xe4e92c(0x1f5)](_0x5cfd43),_0x35abbf=await fetch(_0x51f594);_0x5e3665=Buffer[_0xe4e92c(0x249)](await _0x35abbf[_0xe4e92c(0x23f)]());}catch(_0x5bc99b){console[_0xe4e92c(0x27a)](_0xe4e92c(0x258),_0x5bc99b),await this[_0xe4e92c(0x252)]?.['sendMessage'](_0x5491f4,_0xe4e92c(0x25e));return;}for(const _0xb13cfb of _0x1e6b34){try{_0x5e3665?await _0x4fd86a[_0xe4e92c(0x286)](_0xb13cfb[_0xe4e92c(0x24b)],_0x5e3665,{'caption':_0x7cfe24,'parse_mode':_0xe4e92c(0x255)}):await _0x4fd86a[_0xe4e92c(0x1f1)](_0xb13cfb[_0xe4e92c(0x24b)],_0x7cfe24,{'parse_mode':_0xe4e92c(0x255)}),_0x53a59f++,_0x29acb7++,await new Promise(_0x31ca79=>setTimeout(_0x31ca79,0x64));}catch(_0x25cda7){_0x53a59f++,_0x426236++,console[_0xe4e92c(0x27a)](_0xe4e92c(0x220)+_0xb13cfb[_0xe4e92c(0x24b)]+':',_0x25cda7[_0xe4e92c(0x269)]);}}const _0x2a8525='âœ…\x20*Broadcast\x20Complete*\x0a\x0a'+(_0xe4e92c(0x1ef)+_0x2b6007+'\x0a')+(_0xe4e92c(0x277)+_0x53a59f+'\x0a')+(_0xe4e92c(0x1f9)+_0x29acb7+'\x0a')+(_0xe4e92c(0x28f)+_0x426236);await this[_0xe4e92c(0x252)]?.['sendMessage'](_0x5491f4,_0x2a8525,{'parse_mode':_0xe4e92c(0x255)});}catch(_0x33497b){console[_0xe4e92c(0x27a)]('Error\x20sending\x20broadcast:',_0x33497b),await this[_0xe4e92c(0x252)]?.['sendMessage'](_0x5491f4,_0xe4e92c(0x1fc));}}async[a52_0x213984(0x240)](_0x5e786d,_0x5dc26b,_0x27979b){const _0x1d8b93=a52_0x213984;try{const _0x5122f9=require(_0x1d8b93(0x271))['default'],_0x47c0a4=new Date();let _0x4bcb6c,_0x194be5,_0x5bc096;switch(_0x5dc26b){case'stats_today':{const _0x3a5602=new Date(Date[_0x1d8b93(0x270)](_0x47c0a4[_0x1d8b93(0x1ed)](),_0x47c0a4[_0x1d8b93(0x242)](),_0x47c0a4['getUTCDate']()));_0x4bcb6c=_0x3a5602,_0x194be5=new Date(Date[_0x1d8b93(0x270)](_0x47c0a4[_0x1d8b93(0x1ed)](),_0x47c0a4[_0x1d8b93(0x242)](),_0x47c0a4[_0x1d8b93(0x23d)](),0x17,0x3b,0x3b,0x3e7)),_0x5bc096=_0x3a5602[_0x1d8b93(0x23d)]()['toString']()[_0x1d8b93(0x22a)](0x2,'0')+'.'+(_0x3a5602[_0x1d8b93(0x242)]()+0x1)[_0x1d8b93(0x210)]()[_0x1d8b93(0x22a)](0x2,'0')+'.'+_0x3a5602[_0x1d8b93(0x1ed)]();break;}case _0x1d8b93(0x1f8):{const _0x233c21=new Date(Date['UTC'](_0x47c0a4['getUTCFullYear'](),_0x47c0a4[_0x1d8b93(0x242)](),_0x47c0a4[_0x1d8b93(0x23d)]()-0x1));_0x4bcb6c=_0x233c21,_0x194be5=new Date(Date[_0x1d8b93(0x270)](_0x47c0a4['getUTCFullYear'](),_0x47c0a4[_0x1d8b93(0x242)](),_0x47c0a4[_0x1d8b93(0x23d)]()-0x1,0x17,0x3b,0x3b,0x3e7)),_0x5bc096=_0x233c21[_0x1d8b93(0x23d)]()[_0x1d8b93(0x210)]()['padStart'](0x2,'0')+'.'+(_0x233c21[_0x1d8b93(0x242)]()+0x1)[_0x1d8b93(0x210)]()[_0x1d8b93(0x22a)](0x2,'0')+'.'+_0x233c21[_0x1d8b93(0x1ed)]();break;}case _0x1d8b93(0x201):{const _0x59dd2f=new Date(Date['UTC'](_0x47c0a4[_0x1d8b93(0x1ed)](),_0x47c0a4['getUTCMonth'](),0x1));_0x4bcb6c=_0x59dd2f,_0x194be5=new Date(Date[_0x1d8b93(0x270)](_0x47c0a4['getUTCFullYear'](),_0x47c0a4[_0x1d8b93(0x242)]()+0x1,0x0,0x17,0x3b,0x3b,0x3e7));const _0x1b31f7=new Date(Date[_0x1d8b93(0x270)](_0x47c0a4[_0x1d8b93(0x1ed)](),_0x47c0a4[_0x1d8b93(0x242)]()+0x1,0x0));_0x5bc096=_0x59dd2f[_0x1d8b93(0x23d)]()[_0x1d8b93(0x210)]()[_0x1d8b93(0x22a)](0x2,'0')+'.'+(_0x59dd2f['getUTCMonth']()+0x1)[_0x1d8b93(0x210)]()[_0x1d8b93(0x22a)](0x2,'0')+'.'+_0x59dd2f['getUTCFullYear']()+'\x20-\x20'+_0x1b31f7[_0x1d8b93(0x23d)]()[_0x1d8b93(0x210)]()[_0x1d8b93(0x22a)](0x2,'0')+'.'+(_0x1b31f7[_0x1d8b93(0x242)]()+0x1)['toString']()[_0x1d8b93(0x22a)](0x2,'0')+'.'+_0x1b31f7[_0x1d8b93(0x1ed)]();break;}case _0x1d8b93(0x23c):{const _0x24ae8e=new Date(Date[_0x1d8b93(0x270)](_0x47c0a4[_0x1d8b93(0x1ed)](),_0x47c0a4[_0x1d8b93(0x242)]()-0x1,0x1));_0x4bcb6c=_0x24ae8e,_0x194be5=new Date(Date[_0x1d8b93(0x270)](_0x47c0a4['getUTCFullYear'](),_0x47c0a4[_0x1d8b93(0x242)](),0x0,0x17,0x3b,0x3b,0x3e7));const _0x2eba23=new Date(Date[_0x1d8b93(0x270)](_0x47c0a4[_0x1d8b93(0x1ed)](),_0x47c0a4[_0x1d8b93(0x242)](),0x0));_0x5bc096=_0x24ae8e['getUTCDate']()[_0x1d8b93(0x210)]()[_0x1d8b93(0x22a)](0x2,'0')+'.'+(_0x24ae8e['getUTCMonth']()+0x1)[_0x1d8b93(0x210)]()[_0x1d8b93(0x22a)](0x2,'0')+'.'+_0x24ae8e[_0x1d8b93(0x1ed)]()+_0x1d8b93(0x248)+_0x2eba23[_0x1d8b93(0x23d)]()[_0x1d8b93(0x210)]()['padStart'](0x2,'0')+'.'+(_0x2eba23[_0x1d8b93(0x242)]()+0x1)[_0x1d8b93(0x210)]()[_0x1d8b93(0x22a)](0x2,'0')+'.'+_0x2eba23['getUTCFullYear']();break;}case _0x1d8b93(0x207):{_0x4bcb6c=new Date(0x0),_0x194be5=_0x47c0a4,_0x5bc096=_0x1d8b93(0x20a);break;}default:return;}const _0x1c2f7a=await _0x5122f9[_0x1d8b93(0x1fb)][_0x1d8b93(0x1fa)]({'where':{'createdAt':{'gte':_0x4bcb6c,'lte':_0x194be5}},'select':{'status':!![],'amountUSDT':!![],'amountAfterGatewayCommissionUSDT':!![]}});let _0x36fb71=0x0,_0x14e136=0x0,_0x2ddf6f=0x0,_0x1bc156=0x0,_0x305cb9=0x0,_0x364a06=0x0;_0x1c2f7a[_0x1d8b93(0x27d)](_0x1af304=>{const _0x29ac67=_0x1d8b93,_0x3eb044=_0x1af304[_0x29ac67(0x203)]||0x0,_0x4263a4=_0x1af304[_0x29ac67(0x246)]||0x0;if(_0x1af304['status']==='PAID')_0x36fb71+=_0x3eb044,_0x14e136+=_0x3eb044-_0x4263a4,_0x2ddf6f++;else{if(_0x1af304[_0x29ac67(0x26f)]==='FAILED'||_0x1af304[_0x29ac67(0x26f)]===_0x29ac67(0x23e))_0x1bc156++;else{if(_0x1af304[_0x29ac67(0x26f)]===_0x29ac67(0x22b))_0x305cb9++,_0x36fb71+=_0x3eb044;else _0x1af304[_0x29ac67(0x26f)]===_0x29ac67(0x259)&&(_0x364a06++,_0x36fb71+=_0x3eb044);}}});const _0x549772=_0x2ddf6f+_0x1bc156,_0x33304c=_0x549772>0x0?(_0x2ddf6f/_0x549772*0x64)[_0x1d8b93(0x24e)](0x1):'0.0',_0x5b3475=_0x5bc096[_0x1d8b93(0x1ff)](/\./g,'\x5c.')[_0x1d8b93(0x1ff)](/\-/g,'\x5c-'),_0x26f88a=_0x36fb71[_0x1d8b93(0x24e)](0x2)['replace'](/\./g,'\x5c.'),_0x39a967=_0x14e136[_0x1d8b93(0x24e)](0x2)[_0x1d8b93(0x1ff)](/\./g,'\x5c.'),_0x346e3c=_0x33304c['replace'](/\./g,'\x5c.'),_0x5227e5='ğŸ“Š\x20*Statistics:\x20'+_0x5b3475+_0x1d8b93(0x206)+(_0x1d8b93(0x234)+_0x26f88a+_0x1d8b93(0x1f7))+('ğŸ’µ\x20Earned\x20\x5c-\x20'+_0x39a967+_0x1d8b93(0x1f7))+(_0x1d8b93(0x282)+_0x2ddf6f+'\x0a')+('âŒ\x20Failed\x20Payments\x20\x5c-\x20'+_0x1bc156+'\x0a')+(_0x1d8b93(0x217)+_0x346e3c+'%\x0a')+('âš ï¸\x20Chargebacks\x20\x5c-\x20'+_0x305cb9+'\x0a')+(_0x1d8b93(0x261)+_0x364a06),_0x57601a={'inline_keyboard':[[{'text':_0x1d8b93(0x24a),'callback_data':_0x1d8b93(0x278)}]]};_0x27979b?await this['bot']?.['editMessageText'](_0x5227e5,{'chat_id':_0x5e786d,'message_id':_0x27979b,'parse_mode':_0x1d8b93(0x202),'reply_markup':_0x57601a}):await this['bot']?.[_0x1d8b93(0x1f1)](_0x5e786d,_0x5227e5,{'parse_mode':'MarkdownV2','reply_markup':_0x57601a});}catch(_0x79c18f){console[_0x1d8b93(0x27a)](_0x1d8b93(0x294),_0x79c18f),await this[_0x1d8b93(0x252)]?.[_0x1d8b93(0x1f1)](_0x5e786d,_0x1d8b93(0x225));}}[a52_0x213984(0x28a)](_0x25d722){const _0x5ccb43=a52_0x213984;this[_0x5ccb43(0x260)][_0x5ccb43(0x267)]=_0x25d722[_0x5ccb43(0x21c)](_0x4558e1=>_0x4558e1&&_0x4558e1[_0x5ccb43(0x25f)]()),this[_0x5ccb43(0x27e)](),console[_0x5ccb43(0x28e)](_0x5ccb43(0x289),this[_0x5ccb43(0x260)][_0x5ccb43(0x267)]);}[a52_0x213984(0x25b)](){const _0x2397ff=a52_0x213984;return[...this['config'][_0x2397ff(0x267)]];}[a52_0x213984(0x262)](){const _0xc65f6=a52_0x213984;return{'isActive':!!this[_0xc65f6(0x252)],'adminCount':this[_0xc65f6(0x260)][_0xc65f6(0x267)][_0xc65f6(0x1f6)]};}[a52_0x213984(0x253)](){const _0x2b03cd=a52_0x213984;this[_0x2b03cd(0x252)]&&(this[_0x2b03cd(0x252)][_0x2b03cd(0x256)](),this[_0x2b03cd(0x252)]=null,console[_0x2b03cd(0x28e)](_0x2b03cd(0x1f0)));}}function a52_0x2c87(){const _0x20cce8=['stopPolling','cmd_statistics','Failed\x20to\x20download\x20photo:','REFUND','ğŸ“Š\x20*Statistics*\x0a\x0aSelect\x20period:','getAdminIds','â±\x20Uptime:\x20','set','âŒ\x20Failed\x20to\x20download\x20photo','trim','config','ğŸ”„\x20Refunds\x20\x5c-\x20','getBotInfo','cmd_broadcast','âŒ\x20Error\x20getting\x20debug\x20information','â›”ï¸\x20Access\x20Denied','version','adminIds','\x0a\x0a_Ready\x20to\x20send?_','message','âœ…\x20Admin\x20Telegram\x20bot\x20initialized\x20successfully','Error\x20loading\x20admin\x20bot\x20config:','stringify','cmd_debug','ï¿½\x20Today','status','UTC','../config/database','adminCount','callback_query','ğŸ“¤\x20Sending\x20broadcast\x20to\x20','ğŸ¤–\x20Bot\x20Status:\x20','ğŸ“…\x20Last\x20Month','ğŸ“¤\x20Sent:\x20','back_to_stats_menu','ğŸ“¤\x20Sending\x20broadcast...','error','ğŸ“‹\x20Admins:\x20`','broadcast_cancel','forEach','saveConfig','adminBotService','18MAuWLl','startsWith','âœ…\x20Successful\x20Payments\x20\x5c-\x20','existsSync','ğŸ“¤\x20Send','ğŸ“…\x20This\x20Month','sendPhoto','adminBotConfig.json','answerCallbackQuery','âœ…\x20Admin\x20IDs\x20updated:','updateAdminIds','âŒ\x20Failed\x20to\x20initialize\x20Admin\x20Telegram\x20bot:','ğŸ“†\x20Last\x20Month','AdminBotService','log','âŒ\x20Not\x20Delivered:\x20','photoFileId','back_to_main','broadcastSessions','ğŸ“ˆ\x20Statistics','Error\x20getting\x20statistics:','1485984mbQmbr','stats_today','text','handleBroadcast','toISOString','Error\x20handling\x20/debug\x20command:','Contact\x20system\x20administrator.','readFileSync','6694836xuCZCG','delete','âŒ\x20Inactive','get','getUTCFullYear','ğŸ“†\x20This\x20Month','ğŸ‘¥\x20Total\x20Merchants:\x20','ğŸ›‘\x20Admin\x20Telegram\x20bot\x20stopped','sendMessage','ğŸ“†\x20Yesterday','defineProperty','editMessageText','getFileLink','length','\x20USDT\x0a','stats_yesterday','âœ…\x20Delivered:\x20','findMany','payment','âŒ\x20Error\x20sending\x20broadcast','1199761dhhEuc','join','replace','Admin\x20Telegram\x20bot\x20error:','stats_this_month','MarkdownV2','amountUSDT','yourId','1500926mGdNfl','*\x0a\x0a','stats_all_time','node-telegram-bot-api','You\x20are\x20not\x20authorized\x20to\x20use\x20this\x20bot.\x0a','All\x20Time','âŒ\x20Merchant\x20bot\x20token\x20not\x20configured','dirname','uptime','onText','ğŸ’¬\x20Create\x20Broadcast','toString','ğŸ”™\x20Back','ğŸ”\x20*Debug\x20Information*\x0a\x0a','â›”ï¸\x20Access\x20Denied\x0a\x0a','9WLqfas','mkdirSync','ğŸ‘¥\x20Admin\x20Count:\x20','ğŸ“ˆ\x20Conversion\x20\x5c-\x20','2595640xSmztD','ğŸ“¢\x20*Broadcast\x20Preview*\x0a\x0a','__esModule','floor','filter','timestamp','step','ğŸ”§\x20Debug','Failed\x20to\x20send\x20to\x20','ğŸ†”\x20Your\x20ID:\x20`','loadConfig','nodeVersion','telegramUser','âŒ\x20Error\x20getting\x20statistics','â°\x20Timestamp:\x20','ğŸ“¦\x20Node:\x20','ğŸ“…\x20Today','3190984rTEoOH','padStart','CHARGEBACK','initializeBot','ğŸ“¢\x20*Create\x20Broadcast*\x0a\x0aPlease\x20enter\x20the\x20message\x20text\x20you\x20want\x20to\x20send\x20to\x20all\x20merchants:','isAdmin','file_id','Error\x20saving\x20admin\x20bot\x20config:','âœ…\x20Active','parse','ğŸ”\x20*TRAPAY\x20Admin\x20Bot*\x0a\x0aâœ…\x20You\x20are\x20authorized\x20as\x20admin.','ğŸ’°\x20Turnover\x20\x5c-\x20','path','\x20merchants...','ğŸ“…\x20Yesterday','botToken','botActive','broadcast_send','âŒ\x20No\x20message\x20to\x20send','stats_last_month','getUTCDate','EXPIRED','arrayBuffer','handleStatistics','awaiting_text','getUTCMonth','includes','chat','message_id','amountAfterGatewayCommissionUSDT','2665450zaekEu','\x20-\x20','from','â¬…ï¸\x20Back','telegramId','default','data','toFixed','admins','utf-8','__importDefault','bot','stopBot','âŒ\x20Cancel','Markdown'];a52_0x2c87=function(){return _0x20cce8;};return a52_0x2c87();}exports['AdminBotService']=AdminBotService,exports[a52_0x213984(0x27f)]=new AdminBotService();