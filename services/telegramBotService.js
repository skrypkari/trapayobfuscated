'use strict';const a54_0x4f7fdb=a54_0xfe13;function a54_0x3ff2(){const _0xab7ed2=['✅\x20Welcome\x20back!\x0a\x0a','531108YDXNhS','shopSettings','sendLoginNotification','log','includes','🔔\x20You\x20will\x20now\x20receive\x20notifications\x20about:\x0a','first_name','🔗\x20TXID:\x20`','📧\x20Email:\x20`','API\x20key\x20must\x20start\x20with\x20`pk\x5c_`\x20or\x20`sk\x5c_`.','✅\x20You\x20have\x20been\x20successfully\x20disconnected\x20from\x20shop\x20*','\x20parts:\x20','ipAddress','getBotInfo','defineProperty','❌\x20Error\x20getting\x20debug\x20information.','Example:\x0a','You\x20sent\x20','Failed\x20login\x20attempt','•\x20Payouts\x0a\x0a','💸\x20Penalty\x20amount:\x20*','handleSingleLineVerification','warn','shop','📅\x20Time:\x20','✅\x20Login\x20notification\x20sent\x20for\x20shop\x20','timestamp','method','../types/gateway','chat\x20not\x20found','❌\x20Shop\x20with\x20username\x20`','🆔\x20Payout\x20ID:\x20`','../config/database','toLocaleString','success','findFirst','toString','✅\x20Telegram\x20user\x20','Payment\x20is\x20being\x20processed','from','❌\x20Invalid\x20username\x20format:\x20`','❌\x20Invalid\x20format.\x20Please\x20send\x20exactly\x202\x20parts\x20separated\x20by\x20space:\x0a\x0a','1062063etDvoN','Error\x20sending\x20shop\x20notification:','stopBot','\x20USDT*\x0a','polling_error','status','botUsername','You\x20are\x20already\x20connected\x20to\x20shop:\x20*','Use\x20/start\x20to\x20begin.','getGatewayDisplayNameForTelegram','telegramUser','📝\x20Notes:\x20',':\x20username=\x22','Failed\x20to\x20send\x20API\x20error\x20notification:','update','Username:\x20`','user\x20is\x20deactivated','To\x20receive\x20payment\x20notifications,\x20send\x20your\x20credentials\x20in\x20one\x20line:\x0a\x0a','•\x20New\x20payments\x0a','🤖\x20Welcome\x20to\x20TRAPAY\x20notification\x20system!\x0a\x0a','❌\x20API\x20key\x20does\x20not\x20match\x20shop\x20`','sk_','📱\x20Shop:\x20*','notificationApiError','❌\x20Error:\x20`','pk_','customerName','name','entries','\x20disconnected\x20from\x20shop\x20','requestId','endpoint','Error\x20handling\x20/debug\x20command:','❌\x20Another\x20Telegram\x20account\x20is\x20already\x20connected\x20to\x20shop\x20`','\x20marked\x20as\x20unverified\x20due\x20to\x20delivery\x20failure','✅\x20Telegram\x20bot\x20@','isVerified','Username\x20must\x20contain\x20only\x20letters,\x20numbers\x20and\x20underscore\x20(3-50\x20characters).','Payout\x20completed','txid','shopId','💻\x20Browser:\x20`','*.\x0a\x0a','unknown\x20shop','text','split','📊\x20*Connection\x20Status*\x0a\x0a','Failed\x20to\x20send\x20login\x20notification:','sendApiErrorNotification','findUnique','🏪\x20Gateway:\x20`','`\x0a\x0a','❌\x20An\x20error\x20occurred.\x20Please\x20try\x20again\x20later.','\x0a⚠️\x20If\x20this\x20wasn\x27t\x20you,\x20change\x20your\x20password\x20immediately!','Expected\x20key\x20format:\x20`pk_...`\x20or\x20`sk_...`','✅\x20You\x20have\x20been\x20successfully\x20connected\x20to\x20the\x20notification\x20system!\x0a\x0a','message','Available\x20usernames:\x0a','❗️\x20Make\x20sure\x20to\x20separate\x20username\x20and\x20API\x20key\x20with\x20a\x20space!','New\x20payment\x20created','✅\x20You\x20are\x20already\x20connected\x20to\x20shop\x20*','\x22,\x20apiKey=\x22','❌\x20Shop\x20`','Error\x20handling\x20/disconnect\x20command:','join','test','5089tSILRc','chargebackAmount','🆔\x20Request\x20ID:\x20`','`.\x0a\x0a','Payment\x20expired','\x0aCheck\x20spelling\x20and\x20try\x20again.','\x20via\x20single-line\x20input','🏦\x20Method:\x20`','forEach','🔍\x20*Debug\x20Information*\x0a\x0a','username','error','📝\x20Order\x20ID:\x20`','🏪\x20Available\x20shops\x20in\x20system:\x0a','amount','❌\x20Failed\x20to\x20send\x20notification\x20to\x20Telegram\x20user\x20','Commands:\x0a','statusCode','telegramId','chargeback','startsWith','trapay_bot','errorMessage','❌\x20You\x20are\x20not\x20connected\x20to\x20a\x20shop.\x0a\x0a','8474625Jmfjjz','2168yoNIdX','User\x20','1053196gqJluw','telegramBotService','gateway','`\x20not\x20found.\x0a\x0a','\x22\x20->\x20display\x20\x22','*\x0a\x0a','...`\x0a\x0a','•\x20Important\x20events\x0a\x0a','env','✅\x20API\x20error\x20notification\x20sent\x20for\x20shop\x20','\x20\x20\x20Username:\x20`','initializeBot','\x20\x20\x20Status:\x20','botToken','...','Payment\x20chargeback','...\x22','❌\x20Please\x20use\x20/start\x20command\x20first','29qQBBmp','en-US','📅\x20Date:\x20','customerEmail','updatedAt','💰\x20Amount:\x20*','`\x20(','__esModule','⏳\x20The\x20payment\x20is\x20currently\x20being\x20processed\x20by\x20the\x20gateway.\x0a','🔄\x20Processing\x20single-line\x20verification\x20for\x20user\x20','adminNotes','createdAt','length','findMany','onText','❌\x20Failed\x20to\x20initialize\x20Telegram\x20bot:','Check\x20the\x20key\x20and\x20try\x20again.\x0a\x0a','\x0a👤\x20*Customer\x20Information:*\x0a','👤\x20Username:\x20`','📛\x20Name:\x20`','bot','toLocaleDateString','Disconnect\x20the\x20previous\x20account\x20first\x20or\x20contact\x20administrator.','1724450AMuKrb','/status\x20-\x20check\x20connection\x20status\x0a','📅\x20Connection\x20date:\x20','/disconnect\x20-\x20disconnect\x20from\x20notifications','`\x20is\x20inactive.\x0a\x0a','TelegramBotService','sendPaymentNotification','blocked','Markdown','secretKey','orderId','default','trim','Error\x20handling\x20/start\x20command:','failed','TELEGRAM_BOT_TOKEN\x20not\x20found\x20in\x20environment\x20variables','❌\x20You\x20are\x20not\x20registered\x20in\x20the\x20system.\x0a\x0a','📱\x20Login\x20notifications\x20disabled\x20for\x20shop\x20','substring','sendMessage','23882VYdgFE','setupBotHandlers','❌\x20Invalid\x20API\x20key\x20format.\x0a\x0a','Successful\x20login','•\x20Payment\x20status\x20changes\x0a','node-telegram-bot-api','•\x20`','Telegram\x20bot\x20polling\x20error:','Payment\x20successfully\x20paid','__importDefault','Use\x20/status\x20to\x20check\x20status\x20or\x20/disconnect\x20to\x20disconnect.','\x20\x20\x20Public\x20Key:\x20`','userAgent','Contact\x20administrator.','📱\x20Your\x20Telegram\x20ID:\x20`','ACTIVE','notificationLogin','`appple\x20pk_aa6450d3f57afbefbb0f3f5be5ce6cca13037536afc5ccf14c81a6cbc7a07de5`\x0a\x0a','Telegram\x20bot\x20not\x20initialized,\x20cannot\x20send\x20notification','create','processing','Payment\x20failed','New\x20payout\x20created','Telegram\x20bot\x20error:','🔔\x20You\x20receive\x20notifications\x20about:\x0a','sendCustomNotification','map','✅\x20Notification\x20sent\x20to\x20Telegram\x20user\x20','chat','publicKey','📝\x20Format:\x20`username\x20api_key`\x0a\x0a','\x20(@','💸\x20Amount:\x20*','sendShopNotification','sendPayoutNotification','🔔\x20Notifications\x20are\x20active\x0a\x0a'];a54_0x3ff2=function(){return _0xab7ed2;};return a54_0x3ff2();}(function(_0x351840,_0x2585d3){const _0x462bac=a54_0xfe13,_0xc890cd=_0x351840();while(!![]){try{const _0x4e0ffe=-parseInt(_0x462bac(0x1de))/0x1*(-parseInt(_0x462bac(0x209))/0x2)+-parseInt(_0x462bac(0x258))/0x3+-parseInt(_0x462bac(0x1cc))/0x4+-parseInt(_0x462bac(0x1f5))/0x5+parseInt(_0x462bac(0x22e))/0x6+-parseInt(_0x462bac(0x1b1))/0x7*(parseInt(_0x462bac(0x1ca))/0x8)+parseInt(_0x462bac(0x1c9))/0x9;if(_0x4e0ffe===_0x2585d3)break;else _0xc890cd['push'](_0xc890cd['shift']());}catch(_0x2fe9ca){_0xc890cd['push'](_0xc890cd['shift']());}}}(a54_0x3ff2,0x35075));var __importDefault=this&&this[a54_0x4f7fdb(0x212)]||function(_0x5b93f5){return _0x5b93f5&&_0x5b93f5['__esModule']?_0x5b93f5:{'default':_0x5b93f5};};Object[a54_0x4f7fdb(0x23c)](exports,a54_0x4f7fdb(0x1e5),{'value':!![]}),exports[a54_0x4f7fdb(0x1cd)]=exports[a54_0x4f7fdb(0x1fa)]=void 0x0;const node_telegram_bot_api_1=__importDefault(require(a54_0x4f7fdb(0x20e))),database_1=__importDefault(require(a54_0x4f7fdb(0x24e))),gateway_1=require(a54_0x4f7fdb(0x24a));class TelegramBotService{constructor(){const _0x4a3fb7=a54_0x4f7fdb;this[_0x4a3fb7(0x1f2)]=null,this[_0x4a3fb7(0x1d9)]=process[_0x4a3fb7(0x1d4)]['TELEGRAM_BOT_TOKEN']||'',this[_0x4a3fb7(0x25e)]=process['env']['TELEGRAM_BOT_USERNAME']||_0x4a3fb7(0x1c6),this[_0x4a3fb7(0x1d9)]?this['initializeBot']():console[_0x4a3fb7(0x244)](_0x4a3fb7(0x204));}[a54_0x4f7fdb(0x1d7)](){const _0x1b7458=a54_0x4f7fdb;try{this[_0x1b7458(0x1f2)]=new node_telegram_bot_api_1[(_0x1b7458(0x200))](this[_0x1b7458(0x1d9)],{'polling':!![]}),this[_0x1b7458(0x20a)](),console[_0x1b7458(0x231)](_0x1b7458(0x27b)+this[_0x1b7458(0x25e)]+'\x20initialized\x20successfully');}catch(_0x56229e){console['error'](_0x1b7458(0x1ed),_0x56229e);}}[a54_0x4f7fdb(0x20a)](){const _0x1f4200=a54_0x4f7fdb;if(!this[_0x1f4200(0x1f2)])return;this[_0x1f4200(0x1f2)][_0x1f4200(0x1ec)](/\/start/,async _0xede859=>{const _0x48d17f=_0x1f4200,_0x3be7e6=_0xede859[_0x48d17f(0x225)]['id'],_0x210d37=_0xede859[_0x48d17f(0x255)]?.['id'][_0x48d17f(0x252)](),_0x4ce582=_0xede859[_0x48d17f(0x255)]?.['username'],_0x304458=_0xede859[_0x48d17f(0x255)]?.[_0x48d17f(0x234)],_0x4489c4=_0xede859['from']?.['last_name'];if(!_0x210d37)return;try{let _0x24cc82=await database_1[_0x48d17f(0x200)][_0x48d17f(0x262)][_0x48d17f(0x1a0)]({'where':{'telegramId':_0x210d37},'include':{'shop':!![]}});!_0x24cc82?(_0x24cc82=await database_1['default'][_0x48d17f(0x262)][_0x48d17f(0x21c)]({'data':{'telegramId':_0x210d37,'username':_0x4ce582,'firstName':_0x304458,'lastName':_0x4489c4,'isVerified':![],'shopId':null},'include':{'shop':!![]}}),console['log']('📱\x20Created\x20new\x20Telegram\x20user:\x20'+_0x210d37+_0x48d17f(0x228)+_0x4ce582+')')):_0x24cc82=await database_1[_0x48d17f(0x200)][_0x48d17f(0x262)][_0x48d17f(0x266)]({'where':{'telegramId':_0x210d37},'data':{'username':_0x4ce582,'firstName':_0x304458,'lastName':_0x4489c4},'include':{'shop':!![]}}),_0x24cc82[_0x48d17f(0x27c)]&&_0x24cc82[_0x48d17f(0x280)]&&_0x24cc82[_0x48d17f(0x245)]?await this[_0x48d17f(0x1f2)]?.[_0x48d17f(0x208)](_0x3be7e6,_0x48d17f(0x22d)+(_0x48d17f(0x25f)+_0x24cc82[_0x48d17f(0x245)][_0x48d17f(0x273)]+'*\x0a')+(_0x48d17f(0x267)+_0x24cc82[_0x48d17f(0x245)]['username']+_0x48d17f(0x1a2))+_0x48d17f(0x221)+_0x48d17f(0x26a)+_0x48d17f(0x20d)+_0x48d17f(0x241)+_0x48d17f(0x1c1)+_0x48d17f(0x1f6)+_0x48d17f(0x1f8),{'parse_mode':_0x48d17f(0x1fd)}):(_0x24cc82[_0x48d17f(0x280)]&&!_0x24cc82['isVerified']&&(await database_1[_0x48d17f(0x200)][_0x48d17f(0x262)][_0x48d17f(0x266)]({'where':{'telegramId':_0x210d37},'data':{'shopId':null,'isVerified':![]}}),console['log']('🔄\x20Reset\x20incomplete\x20verification\x20for\x20user\x20'+_0x210d37)),await this[_0x48d17f(0x1f2)]?.[_0x48d17f(0x208)](_0x3be7e6,_0x48d17f(0x26b)+_0x48d17f(0x269)+_0x48d17f(0x227)+_0x48d17f(0x23e)+'`appple\x20pk_aa6450d3f57afbefbb0f3f5be5ce6cca13037536afc5ccf14c81a6cbc7a07de5`\x0a\x0a'+_0x48d17f(0x1a9),{'parse_mode':_0x48d17f(0x1fd)}));}catch(_0x5b25b7){console[_0x48d17f(0x1bc)](_0x48d17f(0x202),_0x5b25b7),await this[_0x48d17f(0x1f2)]?.[_0x48d17f(0x208)](_0x3be7e6,_0x48d17f(0x1a3));}}),this[_0x1f4200(0x1f2)][_0x1f4200(0x1ec)](/\/disconnect/,async _0x360d2f=>{const _0x328bb5=_0x1f4200,_0x4c5681=_0x360d2f['chat']['id'],_0x196923=_0x360d2f[_0x328bb5(0x255)]?.['id']['toString']();if(!_0x196923)return;try{const _0x801c7e=await database_1[_0x328bb5(0x200)][_0x328bb5(0x262)]['findUnique']({'where':{'telegramId':_0x196923},'include':{'shop':!![]}});if(!_0x801c7e||!_0x801c7e[_0x328bb5(0x27c)]||!_0x801c7e['shopId']){await this[_0x328bb5(0x1f2)]?.[_0x328bb5(0x208)](_0x4c5681,'❌\x20You\x20are\x20not\x20connected\x20to\x20the\x20notification\x20system.');return;}const _0x486063=_0x801c7e['shop']?.[_0x328bb5(0x273)]||_0x328bb5(0x283);await database_1[_0x328bb5(0x200)][_0x328bb5(0x262)][_0x328bb5(0x266)]({'where':{'telegramId':_0x196923},'data':{'shopId':null,'isVerified':![]}}),console[_0x328bb5(0x231)]('🔌\x20User\x20'+_0x196923+_0x328bb5(0x275)+_0x801c7e['shopId']),await this[_0x328bb5(0x1f2)]?.[_0x328bb5(0x208)](_0x4c5681,_0x328bb5(0x238)+_0x486063+'*.\x0a\x0a'+'To\x20reconnect,\x20use\x20the\x20/start\x20command',{'parse_mode':_0x328bb5(0x1fd)});}catch(_0x41f9b5){console[_0x328bb5(0x1bc)](_0x328bb5(0x1ae),_0x41f9b5),await this['bot']?.[_0x328bb5(0x208)](_0x4c5681,_0x328bb5(0x1a3));}}),this[_0x1f4200(0x1f2)]['onText'](/\/status/,async _0xb7519e=>{const _0x389b62=_0x1f4200,_0x18bd45=_0xb7519e[_0x389b62(0x225)]['id'],_0x39c003=_0xb7519e['from']?.['id']['toString']();if(!_0x39c003)return;try{const _0x5e9f8d=await database_1[_0x389b62(0x200)][_0x389b62(0x262)]['findUnique']({'where':{'telegramId':_0x39c003},'include':{'shop':!![]}});if(!_0x5e9f8d){await this[_0x389b62(0x1f2)]?.[_0x389b62(0x208)](_0x18bd45,_0x389b62(0x205)+_0x389b62(0x260));return;}if(!_0x5e9f8d[_0x389b62(0x27c)]||!_0x5e9f8d[_0x389b62(0x280)]||!_0x5e9f8d[_0x389b62(0x245)]){await this[_0x389b62(0x1f2)]?.[_0x389b62(0x208)](_0x18bd45,_0x389b62(0x1c8)+'Use\x20/start\x20to\x20connect.');return;}await this[_0x389b62(0x1f2)]?.[_0x389b62(0x208)](_0x18bd45,_0x389b62(0x19d)+('✅\x20Connected\x20to\x20shop:\x20*'+_0x5e9f8d[_0x389b62(0x245)][_0x389b62(0x273)]+'*\x0a')+(_0x389b62(0x1f0)+_0x5e9f8d[_0x389b62(0x245)][_0x389b62(0x1bb)]+'`\x0a')+(_0x389b62(0x1f7)+_0x5e9f8d[_0x389b62(0x1e2)][_0x389b62(0x1f3)](_0x389b62(0x1df))+'\x0a\x0a')+_0x389b62(0x22c)+_0x389b62(0x1c1)+_0x389b62(0x1f8),{'parse_mode':_0x389b62(0x1fd)});}catch(_0x8c775b){console['error']('Error\x20handling\x20/status\x20command:',_0x8c775b),await this[_0x389b62(0x1f2)]?.[_0x389b62(0x208)](_0x18bd45,_0x389b62(0x1a3));}}),this['bot'][_0x1f4200(0x1ec)](/\/debug/,async _0x264cf8=>{const _0xa56329=_0x1f4200,_0x1e8289=_0x264cf8['chat']['id'],_0x4dee97=_0x264cf8['from']?.['id'][_0xa56329(0x252)]();if(!_0x4dee97)return;try{const _0x27fd8b=await database_1['default']['shop'][_0xa56329(0x1eb)]({'select':{'id':!![],'name':!![],'username':!![],'status':!![],'publicKey':!![]},'take':0xa});let _0x2d7b88=_0xa56329(0x1ba);_0x2d7b88+=_0xa56329(0x217)+_0x4dee97+_0xa56329(0x1a2),_0x2d7b88+=_0xa56329(0x1be),_0x27fd8b[_0xa56329(0x1b9)]((_0x134275,_0x3d42a9)=>{const _0x3c9eb9=_0xa56329;_0x2d7b88+=_0x3d42a9+0x1+'.\x20*'+_0x134275[_0x3c9eb9(0x273)]+'*\x0a',_0x2d7b88+=_0x3c9eb9(0x1d6)+_0x134275['username']+'`\x0a',_0x2d7b88+=_0x3c9eb9(0x1d8)+_0x134275['status']+'\x0a',_0x2d7b88+=_0x3c9eb9(0x214)+_0x134275[_0x3c9eb9(0x226)][_0x3c9eb9(0x207)](0x0,0xf)+_0x3c9eb9(0x1d2);}),await this['bot']?.[_0xa56329(0x208)](_0x1e8289,_0x2d7b88,{'parse_mode':_0xa56329(0x1fd)});}catch(_0x40e619){console[_0xa56329(0x1bc)](_0xa56329(0x278),_0x40e619),await this[_0xa56329(0x1f2)]?.[_0xa56329(0x208)](_0x1e8289,_0xa56329(0x23d));}}),this[_0x1f4200(0x1f2)]['on'](_0x1f4200(0x1a7),async _0x35d760=>{const _0x1477e8=_0x1f4200;if(_0x35d760[_0x1477e8(0x284)]?.[_0x1477e8(0x1c5)]('/'))return;const _0x5b97fe=_0x35d760['chat']['id'],_0x257810=_0x35d760[_0x1477e8(0x255)]?.['id']['toString'](),_0x1862ae=_0x35d760['text']?.[_0x1477e8(0x201)]();if(!_0x257810||!_0x1862ae)return;try{const _0x123120=await database_1[_0x1477e8(0x200)]['telegramUser'][_0x1477e8(0x1a0)]({'where':{'telegramId':_0x257810},'include':{'shop':!![]}});if(!_0x123120){await this[_0x1477e8(0x1f2)]?.[_0x1477e8(0x208)](_0x5b97fe,_0x1477e8(0x1dd));return;}if(_0x123120[_0x1477e8(0x27c)]&&_0x123120[_0x1477e8(0x280)]&&_0x123120[_0x1477e8(0x245)]){await this[_0x1477e8(0x1f2)]?.[_0x1477e8(0x208)](_0x5b97fe,_0x1477e8(0x1ab)+_0x123120[_0x1477e8(0x245)]['name']+_0x1477e8(0x282)+_0x1477e8(0x213),{'parse_mode':_0x1477e8(0x1fd)});return;}const _0x440554=_0x1862ae[_0x1477e8(0x285)](/\s+/);if(_0x440554[_0x1477e8(0x1ea)]!==0x2){await this['bot']?.[_0x1477e8(0x208)](_0x5b97fe,_0x1477e8(0x257)+_0x1477e8(0x227)+'Example:\x0a'+_0x1477e8(0x21a)+(_0x1477e8(0x23f)+_0x440554[_0x1477e8(0x1ea)]+_0x1477e8(0x239)+_0x440554[_0x1477e8(0x223)](_0x337112=>'`'+_0x337112+'`')[_0x1477e8(0x1af)](',\x20')),{'parse_mode':_0x1477e8(0x1fd)});return;}const [_0x4bb7ca,_0xa21047]=_0x440554;console[_0x1477e8(0x231)](_0x1477e8(0x1e7)+_0x257810+_0x1477e8(0x264)+_0x4bb7ca+'\x22,\x20apiKey=\x22'+_0xa21047[_0x1477e8(0x207)](0x0,0xa)+_0x1477e8(0x1dc)),await this[_0x1477e8(0x243)](_0x5b97fe,_0x257810,_0x4bb7ca,_0xa21047);}catch(_0x570f2d){console[_0x1477e8(0x1bc)]('Error\x20handling\x20message:',_0x570f2d),await this[_0x1477e8(0x1f2)]?.[_0x1477e8(0x208)](_0x5b97fe,'❌\x20An\x20error\x20occurred.\x20Please\x20try\x20again\x20later.');}}),this[_0x1f4200(0x1f2)]['on'](_0x1f4200(0x1bc),_0x554703=>{const _0x48b350=_0x1f4200;console[_0x48b350(0x1bc)](_0x48b350(0x220),_0x554703);}),this[_0x1f4200(0x1f2)]['on'](_0x1f4200(0x25c),_0x5449f7=>{const _0x6a7696=_0x1f4200;console['error'](_0x6a7696(0x210),_0x5449f7);});}async[a54_0x4f7fdb(0x243)](_0x1d4ca2,_0x46d505,_0x2b1023,_0x28dc83){const _0x5f1e0c=a54_0x4f7fdb;try{console[_0x5f1e0c(0x231)]('🔄\x20Processing\x20single-line\x20verification\x20for\x20user\x20'+_0x46d505+_0x5f1e0c(0x264)+_0x2b1023+_0x5f1e0c(0x1ac)+_0x28dc83[_0x5f1e0c(0x207)](0x0,0xa)+_0x5f1e0c(0x1dc));if(!_0x2b1023||_0x2b1023['length']<0x3||_0x2b1023[_0x5f1e0c(0x1ea)]>0x32||!/^[a-zA-Z0-9_]+$/[_0x5f1e0c(0x1b0)](_0x2b1023)){await this[_0x5f1e0c(0x1f2)]?.[_0x5f1e0c(0x208)](_0x1d4ca2,_0x5f1e0c(0x256)+_0x2b1023+'`\x0a\x0a'+_0x5f1e0c(0x27d),{'parse_mode':'Markdown'});return;}if(!_0x28dc83||!_0x28dc83['startsWith'](_0x5f1e0c(0x271))&&!_0x28dc83[_0x5f1e0c(0x1c5)](_0x5f1e0c(0x26d))){await this[_0x5f1e0c(0x1f2)]?.[_0x5f1e0c(0x208)](_0x1d4ca2,_0x5f1e0c(0x20b)+_0x5f1e0c(0x237),{'parse_mode':_0x5f1e0c(0x1fd)});return;}const _0x3cecf1=await database_1[_0x5f1e0c(0x200)][_0x5f1e0c(0x245)][_0x5f1e0c(0x1a0)]({'where':{'username':_0x2b1023},'select':{'id':!![],'name':!![],'username':!![],'status':!![],'publicKey':!![],'secretKey':!![]}});if(!_0x3cecf1){const _0x3448cd=await database_1[_0x5f1e0c(0x200)][_0x5f1e0c(0x245)][_0x5f1e0c(0x1eb)]({'select':{'username':!![],'name':!![]},'take':0x5});let _0xac413c=_0x5f1e0c(0x24c)+_0x2b1023+_0x5f1e0c(0x1cf);_0x3448cd[_0x5f1e0c(0x1ea)]>0x0?(_0xac413c+=_0x5f1e0c(0x1a8),_0x3448cd[_0x5f1e0c(0x1b9)](_0x1ff716=>{const _0x63fc35=_0x5f1e0c;_0xac413c+=_0x63fc35(0x20f)+_0x1ff716['username']+_0x63fc35(0x1e4)+_0x1ff716[_0x63fc35(0x273)]+')\x0a';}),_0xac413c+=_0x5f1e0c(0x1b6)):_0xac413c+='Check\x20spelling\x20and\x20try\x20again.';await this[_0x5f1e0c(0x1f2)]?.['sendMessage'](_0x1d4ca2,_0xac413c,{'parse_mode':'Markdown'});return;}if(_0x3cecf1[_0x5f1e0c(0x25d)]!==_0x5f1e0c(0x218)){await this['bot']?.[_0x5f1e0c(0x208)](_0x1d4ca2,_0x5f1e0c(0x1ad)+_0x2b1023+_0x5f1e0c(0x1f9)+_0x5f1e0c(0x216),{'parse_mode':_0x5f1e0c(0x1fd)});return;}if(_0x3cecf1[_0x5f1e0c(0x226)]!==_0x28dc83&&_0x3cecf1[_0x5f1e0c(0x1fe)]!==_0x28dc83){await this[_0x5f1e0c(0x1f2)]?.[_0x5f1e0c(0x208)](_0x1d4ca2,_0x5f1e0c(0x26c)+_0x2b1023+_0x5f1e0c(0x1b4)+_0x5f1e0c(0x1ee)+_0x5f1e0c(0x1a5),{'parse_mode':_0x5f1e0c(0x1fd)});return;}const _0xc8b82e=await database_1[_0x5f1e0c(0x200)][_0x5f1e0c(0x262)][_0x5f1e0c(0x251)]({'where':{'shopId':_0x3cecf1['id'],'isVerified':!![],'telegramId':{'not':_0x46d505}}});if(_0xc8b82e){await this[_0x5f1e0c(0x1f2)]?.['sendMessage'](_0x1d4ca2,_0x5f1e0c(0x279)+_0x2b1023+_0x5f1e0c(0x1b4)+_0x5f1e0c(0x1f4),{'parse_mode':_0x5f1e0c(0x1fd)});return;}await database_1['default'][_0x5f1e0c(0x262)]['update']({'where':{'telegramId':_0x46d505},'data':{'shopId':_0x3cecf1['id'],'isVerified':!![]}}),await this[_0x5f1e0c(0x1f2)]?.[_0x5f1e0c(0x208)](_0x1d4ca2,'🎉\x20*Congratulations!*\x0a\x0a'+_0x5f1e0c(0x1a6)+(_0x5f1e0c(0x26e)+_0x3cecf1[_0x5f1e0c(0x273)]+'*\x0a')+(_0x5f1e0c(0x1f0)+_0x3cecf1['username']+'`\x0a\x0a')+_0x5f1e0c(0x233)+_0x5f1e0c(0x26a)+_0x5f1e0c(0x20d)+'•\x20Payouts\x0a'+_0x5f1e0c(0x1d3)+_0x5f1e0c(0x1c1)+_0x5f1e0c(0x1f6)+'/disconnect\x20-\x20disconnect\x20from\x20notifications',{'parse_mode':_0x5f1e0c(0x1fd)}),console['log'](_0x5f1e0c(0x253)+_0x46d505+'\x20verified\x20for\x20shop\x20'+_0x3cecf1[_0x5f1e0c(0x1bb)]+_0x5f1e0c(0x1b7));}catch(_0x349410){console[_0x5f1e0c(0x1bc)]('Error\x20in\x20handleSingleLineVerification:',_0x349410),await this[_0x5f1e0c(0x1f2)]?.['sendMessage'](_0x1d4ca2,'❌\x20An\x20error\x20occurred\x20while\x20verifying\x20data.');}}async[a54_0x4f7fdb(0x22a)](_0x17616a,_0x16805b,_0x33b487){const _0x428265=a54_0x4f7fdb;if(!this[_0x428265(0x1f2)]){console[_0x428265(0x244)](_0x428265(0x21b));return;}try{const _0x1c0a33=await database_1[_0x428265(0x200)]['telegramUser']['findMany']({'where':{'shopId':_0x17616a,'isVerified':!![]}});if(_0x1c0a33['length']===0x0){console[_0x428265(0x231)]('No\x20verified\x20Telegram\x20users\x20found\x20for\x20shop\x20'+_0x17616a);return;}const _0x11f54d=_0x1c0a33[_0x428265(0x223)](async _0x5c98df=>{const _0xe9cc20=_0x428265;try{await this[_0xe9cc20(0x1f2)]?.[_0xe9cc20(0x208)](_0x5c98df[_0xe9cc20(0x1c3)],_0x16805b,_0x33b487),console[_0xe9cc20(0x231)](_0xe9cc20(0x224)+_0x5c98df['telegramId']);}catch(_0x419ff9){console[_0xe9cc20(0x1bc)](_0xe9cc20(0x1c0)+_0x5c98df[_0xe9cc20(0x1c3)]+':',_0x419ff9),_0x419ff9 instanceof Error&&(_0x419ff9['message']['includes'](_0xe9cc20(0x1fc))||_0x419ff9['message']['includes'](_0xe9cc20(0x24b))||_0x419ff9[_0xe9cc20(0x1a7)][_0xe9cc20(0x232)](_0xe9cc20(0x268)))&&(await database_1[_0xe9cc20(0x200)][_0xe9cc20(0x262)][_0xe9cc20(0x266)]({'where':{'id':_0x5c98df['id']},'data':{'isVerified':![]}}),console['log'](_0xe9cc20(0x1cb)+_0x5c98df[_0xe9cc20(0x1c3)]+_0xe9cc20(0x27a)));}});await Promise['allSettled'](_0x11f54d);}catch(_0x1cadaa){console['error'](_0x428265(0x259),_0x1cadaa);}}async[a54_0x4f7fdb(0x1fb)](_0x3a5159,_0x4f7917,_0x581624){const _0x517c1a=a54_0x4f7fdb,_0x25a7c5={'created':'🆕','paid':'✅','failed':'❌','expired':'⏰','refund':'🔄','chargeback':'⚠️','processing':'⚙️'},_0x3bb8a8={'created':_0x517c1a(0x1aa),'paid':_0x517c1a(0x211),'failed':_0x517c1a(0x21e),'expired':_0x517c1a(0x1b5),'refund':'Payment\x20refund','chargeback':_0x517c1a(0x1db),'processing':_0x517c1a(0x254)},_0x23b9ff=_0x25a7c5[_0x581624],_0x3d1428=_0x3bb8a8[_0x581624],_0x446123=(0x0,gateway_1[_0x517c1a(0x261)])(_0x4f7917[_0x517c1a(0x1ce)]);console[_0x517c1a(0x231)]('📱\x20Telegram\x20notification:\x20gateway\x20\x22'+_0x4f7917[_0x517c1a(0x1ce)]+_0x517c1a(0x1d0)+_0x446123+'\x22');let _0x4d750a=_0x23b9ff+'\x20*'+_0x3d1428+'*\x0a\x0a'+(_0x517c1a(0x1e3)+_0x4f7917[_0x517c1a(0x1bf)]+'\x20'+_0x4f7917['currency']+'*\x0a')+(_0x517c1a(0x1bd)+(_0x4f7917[_0x517c1a(0x1ff)]||_0x4f7917['id'])+'`\x0a')+('🆔\x20Payment\x20ID:\x20`'+_0x4f7917['id']+'`\x0a')+(_0x517c1a(0x1a1)+_0x446123+'`\x0a')+('📅\x20Date:\x20'+new Date(_0x4f7917[_0x517c1a(0x1e9)])[_0x517c1a(0x24f)]('en-US')+'\x0a');(_0x4f7917[_0x517c1a(0x272)]||_0x4f7917['customerEmail'])&&(_0x4d750a+=_0x517c1a(0x1ef),_0x4f7917[_0x517c1a(0x272)]&&(_0x4d750a+=_0x517c1a(0x1f1)+_0x4f7917['customerName']+'`\x0a'),_0x4f7917[_0x517c1a(0x1e1)]&&(_0x4d750a+=_0x517c1a(0x236)+_0x4f7917[_0x517c1a(0x1e1)]+'`\x0a')),_0x581624===_0x517c1a(0x1c4)&&_0x4f7917[_0x517c1a(0x1b2)]&&(_0x4d750a+=_0x517c1a(0x242)+_0x4f7917['chargebackAmount']+_0x517c1a(0x25b)),_0x581624===_0x517c1a(0x21d)&&(_0x4d750a+=_0x517c1a(0x1e6)),_0x4f7917[_0x517c1a(0x1e8)]&&(_0x4d750a+=_0x517c1a(0x263)+_0x4f7917[_0x517c1a(0x1e8)]+'\x0a'),await this['sendShopNotification'](_0x3a5159,_0x4d750a,{'parse_mode':_0x517c1a(0x1fd)});}async[a54_0x4f7fdb(0x22b)](_0x37b494,_0x40c51e,_0x3595d9){const _0x308ac7=a54_0x4f7fdb,_0xf8da2b={'created':'📤','completed':'✅','rejected':'❌'},_0x2b98aa={'created':_0x308ac7(0x21f),'completed':_0x308ac7(0x27e),'rejected':'Payout\x20rejected'},_0x96ec13=_0xf8da2b[_0x3595d9],_0x59c83d=_0x2b98aa[_0x3595d9],_0x6c0ed8=_0x96ec13+'\x20*'+_0x59c83d+'*\x0a\x0a'+(_0x308ac7(0x229)+_0x40c51e['amount']+'\x20USD*\x0a')+(_0x308ac7(0x1b8)+_0x40c51e[_0x308ac7(0x249)]+'`\x0a')+(_0x308ac7(0x24d)+_0x40c51e['id']+'`\x0a')+(_0x308ac7(0x1e0)+new Date(_0x40c51e['createdAt'])[_0x308ac7(0x24f)](_0x308ac7(0x1df))+'\x0a')+(_0x40c51e[_0x308ac7(0x27f)]?_0x308ac7(0x235)+_0x40c51e[_0x308ac7(0x27f)]+'`':'');await this[_0x308ac7(0x22a)](_0x37b494,_0x6c0ed8,{'parse_mode':_0x308ac7(0x1fd)});}async[a54_0x4f7fdb(0x230)](_0x3416fa,_0x261353){const _0x318713=a54_0x4f7fdb;try{const _0x29d6bf=await database_1['default'][_0x318713(0x22f)][_0x318713(0x1a0)]({'where':{'shopId':_0x3416fa},'select':{'notificationLogin':!![]}});if(!_0x29d6bf?.[_0x318713(0x219)]){console[_0x318713(0x231)](_0x318713(0x206)+_0x3416fa);return;}const _0x44a86e=_0x261353[_0x318713(0x250)]?'🔐':'🚨',_0x14938e=_0x261353[_0x318713(0x250)]?_0x318713(0x20c):_0x318713(0x240);let _0x2754fe=_0x44a86e+'\x20*'+_0x14938e+_0x318713(0x1d1)+(_0x318713(0x1f0)+_0x261353[_0x318713(0x1bb)]+'`\x0a')+('📅\x20Time:\x20'+_0x261353[_0x318713(0x248)][_0x318713(0x24f)](_0x318713(0x1df))+'\x0a');_0x261353[_0x318713(0x23a)]&&(_0x2754fe+='🌐\x20IP\x20address:\x20`'+_0x261353[_0x318713(0x23a)]+'`\x0a');if(_0x261353[_0x318713(0x215)]){const _0x15dbc9=_0x261353[_0x318713(0x215)][_0x318713(0x1ea)]>0x32?_0x261353[_0x318713(0x215)]['substring'](0x0,0x32)+_0x318713(0x1da):_0x261353[_0x318713(0x215)];_0x2754fe+=_0x318713(0x281)+_0x15dbc9+'`\x0a';}!_0x261353['success']&&(_0x2754fe+=_0x318713(0x1a4)),await this[_0x318713(0x22a)](_0x3416fa,_0x2754fe,{'parse_mode':_0x318713(0x1fd)}),console[_0x318713(0x231)](_0x318713(0x247)+_0x3416fa+':\x20'+(_0x261353[_0x318713(0x250)]?'success':_0x318713(0x203)));}catch(_0x44f994){console['error'](_0x318713(0x19e),_0x44f994);}}async[a54_0x4f7fdb(0x19f)](_0x51fa84,_0x25837d){const _0x15033c=a54_0x4f7fdb;try{const _0x51fa2d=await database_1['default'][_0x15033c(0x22f)]['findUnique']({'where':{'shopId':_0x51fa84},'select':{'notificationApiError':!![]}});if(!_0x51fa2d?.[_0x15033c(0x26f)]){console[_0x15033c(0x231)]('📱\x20API\x20error\x20notifications\x20disabled\x20for\x20shop\x20'+_0x51fa84);return;}let _0x2bea7d='🚨\x20*API\x20Error*\x0a\x0a'+('🔗\x20Endpoint:\x20`'+_0x25837d['method']+'\x20'+_0x25837d[_0x15033c(0x277)]+'`\x0a')+(_0x15033c(0x246)+_0x25837d[_0x15033c(0x248)][_0x15033c(0x24f)](_0x15033c(0x1df))+'\x0a');_0x25837d[_0x15033c(0x1c2)]&&(_0x2bea7d+='📊\x20Error\x20code:\x20`'+_0x25837d[_0x15033c(0x1c2)]+'`\x0a'),_0x2bea7d+=_0x15033c(0x270)+_0x25837d[_0x15033c(0x1c7)]+'`\x0a',_0x25837d[_0x15033c(0x276)]&&(_0x2bea7d+=_0x15033c(0x1b3)+_0x25837d[_0x15033c(0x276)]+'`\x0a'),_0x2bea7d+='\x0a💡\x20Check\x20your\x20request\x20or\x20contact\x20support.',await this['sendShopNotification'](_0x51fa84,_0x2bea7d,{'parse_mode':_0x15033c(0x1fd)}),console[_0x15033c(0x231)](_0x15033c(0x1d5)+_0x51fa84+':\x20'+_0x25837d[_0x15033c(0x277)]);}catch(_0x2822b1){console[_0x15033c(0x1bc)](_0x15033c(0x265),_0x2822b1);}}async[a54_0x4f7fdb(0x222)](_0x5dbbae,_0x4c3ec0,_0x2d55d1){const _0x311837=a54_0x4f7fdb;let _0x3652c7='🔔\x20*'+_0x4c3ec0+_0x311837(0x1d1);for(const [_0x173350,_0x1b2505]of Object[_0x311837(0x274)](_0x2d55d1)){_0x1b2505!==null&&_0x1b2505!==undefined&&(_0x3652c7+=_0x173350+':\x20`'+_0x1b2505+'`\x0a');}await this[_0x311837(0x22a)](_0x5dbbae,_0x3652c7,{'parse_mode':'Markdown'});}[a54_0x4f7fdb(0x23b)](){const _0x3c2934=a54_0x4f7fdb;return{'isActive':!!this[_0x3c2934(0x1f2)],'username':this[_0x3c2934(0x25e)]};}[a54_0x4f7fdb(0x25a)](){const _0x3c7e61=a54_0x4f7fdb;this[_0x3c7e61(0x1f2)]&&(this[_0x3c7e61(0x1f2)]['stopPolling'](),this['bot']=null,console[_0x3c7e61(0x231)]('🛑\x20Telegram\x20bot\x20stopped'));}}function a54_0xfe13(_0x37807f,_0x507016){const _0x3ff275=a54_0x3ff2();return a54_0xfe13=function(_0xfe1362,_0x427b75){_0xfe1362=_0xfe1362-0x19d;let _0xd992c0=_0x3ff275[_0xfe1362];return _0xd992c0;},a54_0xfe13(_0x37807f,_0x507016);}exports['TelegramBotService']=TelegramBotService,exports[a54_0x4f7fdb(0x1cd)]=new TelegramBotService();