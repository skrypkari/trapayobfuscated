'use strict';const a58_0x3c17cc=a58_0x1d25;(function(_0x19f3ca,_0x365f3e){const _0xbac81=a58_0x1d25,_0xbe9359=_0x19f3ca();while(!![]){try{const _0x5567f7=parseInt(_0xbac81(0x126))/0x1+parseInt(_0xbac81(0x19c))/0x2*(parseInt(_0xbac81(0x12f))/0x3)+-parseInt(_0xbac81(0x189))/0x4+parseInt(_0xbac81(0x16d))/0x5+parseInt(_0xbac81(0xea))/0x6+parseInt(_0xbac81(0x106))/0x7+-parseInt(_0xbac81(0x161))/0x8;if(_0x5567f7===_0x365f3e)break;else _0xbe9359['push'](_0xbe9359['shift']());}catch(_0x174e26){_0xbe9359['push'](_0xbe9359['shift']());}}}(a58_0x2a7b,0x8c15d));var __importDefault=this&&this[a58_0x3c17cc(0x19a)]||function(_0x2c7282){const _0x1db342=a58_0x3c17cc;return _0x2c7282&&_0x2c7282[_0x1db342(0x19e)]?_0x2c7282:{'default':_0x2c7282};};function a58_0x1d25(_0x32dc2a,_0x5b0cb2){const _0x2a7b16=a58_0x2a7b();return a58_0x1d25=function(_0x1d25fe,_0x1aac9f){_0x1d25fe=_0x1d25fe-0xbd;let _0x5547d2=_0x2a7b16[_0x1d25fe];return _0x5547d2;},a58_0x1d25(_0x32dc2a,_0x5b0cb2);}Object[a58_0x3c17cc(0xf4)](exports,'__esModule',{'value':!![]}),exports['telegramBotService']=exports['TelegramBotService']=void 0x0;const node_telegram_bot_api_1=__importDefault(require('node-telegram-bot-api')),database_1=__importDefault(require(a58_0x3c17cc(0x1a1))),gateway_1=require(a58_0x3c17cc(0x14a));class TelegramBotService{constructor(){const _0x1b61ae=a58_0x3c17cc;this[_0x1b61ae(0xca)]=null,this[_0x1b61ae(0xf7)]=process[_0x1b61ae(0x15f)]['TELEGRAM_BOT_TOKEN']||'',this[_0x1b61ae(0x13c)]=process[_0x1b61ae(0x15f)][_0x1b61ae(0xec)]||_0x1b61ae(0x108),this[_0x1b61ae(0xf7)]?this[_0x1b61ae(0xd9)]():console[_0x1b61ae(0xf9)]('TELEGRAM_BOT_TOKEN\x20not\x20found\x20in\x20environment\x20variables');}[a58_0x3c17cc(0xd9)](){const _0xc47d93=a58_0x3c17cc;try{this[_0xc47d93(0xca)]=new node_telegram_bot_api_1[(_0xc47d93(0xce))](this[_0xc47d93(0xf7)],{'polling':!![]}),this[_0xc47d93(0x139)](),console['log'](_0xc47d93(0x188)+this[_0xc47d93(0x13c)]+'\x20initialized\x20successfully');}catch(_0x2048f1){console[_0xc47d93(0x10b)](_0xc47d93(0x155),_0x2048f1);}}[a58_0x3c17cc(0x139)](){const _0x49e405=a58_0x3c17cc;if(!this[_0x49e405(0xca)])return;this['bot']['onText'](/\/start/,async _0x225a36=>{const _0x39b405=_0x49e405,_0x3a3d3=_0x225a36[_0x39b405(0x152)]['id'],_0x4a50f7=_0x225a36[_0x39b405(0x162)]?.['id'][_0x39b405(0xcd)](),_0x2c8cc5=_0x225a36[_0x39b405(0x162)]?.[_0x39b405(0xe3)],_0x311fd8=_0x225a36['from']?.[_0x39b405(0x122)],_0x12ca7a=_0x225a36[_0x39b405(0x162)]?.['last_name'];if(!_0x4a50f7)return;try{let _0x25e862=await database_1[_0x39b405(0xce)][_0x39b405(0x121)][_0x39b405(0x13e)]({'where':{'telegramId':_0x4a50f7},'include':{'shop':!![]}});!_0x25e862?(_0x25e862=await database_1[_0x39b405(0xce)][_0x39b405(0x121)]['create']({'data':{'telegramId':_0x4a50f7,'username':_0x2c8cc5,'firstName':_0x311fd8,'lastName':_0x12ca7a,'isVerified':![],'shopId':null},'include':{'shop':!![]}}),console['log'](_0x39b405(0xd2)+_0x4a50f7+_0x39b405(0xbd)+_0x2c8cc5+')')):_0x25e862=await database_1['default'][_0x39b405(0x121)]['update']({'where':{'telegramId':_0x4a50f7},'data':{'username':_0x2c8cc5,'firstName':_0x311fd8,'lastName':_0x12ca7a},'include':{'shop':!![]}}),_0x25e862[_0x39b405(0x12b)]&&_0x25e862['shopId']&&_0x25e862[_0x39b405(0x16b)]?await this[_0x39b405(0xca)]?.[_0x39b405(0x16c)](_0x3a3d3,_0x39b405(0x13a)+(_0x39b405(0x12e)+_0x25e862['shop'][_0x39b405(0xf1)]+'*\x0a')+('Username:\x20`'+_0x25e862['shop']['username']+_0x39b405(0x199))+_0x39b405(0x113)+'•\x20New\x20payments\x0a'+_0x39b405(0x184)+_0x39b405(0x112)+_0x39b405(0x158)+_0x39b405(0x186)+_0x39b405(0x195),{'parse_mode':_0x39b405(0x179)}):(_0x25e862['shopId']&&!_0x25e862[_0x39b405(0x12b)]&&(await database_1[_0x39b405(0xce)]['telegramUser']['update']({'where':{'telegramId':_0x4a50f7},'data':{'shopId':null,'isVerified':![]}}),console[_0x39b405(0xe9)]('🔄\x20Reset\x20incomplete\x20verification\x20for\x20user\x20'+_0x4a50f7)),await this[_0x39b405(0xca)]?.[_0x39b405(0x16c)](_0x3a3d3,_0x39b405(0xc6)+'To\x20receive\x20payment\x20notifications,\x20send\x20your\x20credentials\x20in\x20one\x20line:\x0a\x0a'+'📝\x20Format:\x20`username\x20api_key`\x0a\x0a'+_0x39b405(0x166)+'`appple\x20pk_aa6450d3f57afbefbb0f3f5be5ce6cca13037536afc5ccf14c81a6cbc7a07de5`\x0a\x0a'+_0x39b405(0xcc),{'parse_mode':_0x39b405(0x179)}));}catch(_0x14394a){console[_0x39b405(0x10b)](_0x39b405(0xe8),_0x14394a),await this['bot']?.[_0x39b405(0x16c)](_0x3a3d3,'❌\x20An\x20error\x20occurred.\x20Please\x20try\x20again\x20later.');}}),this[_0x49e405(0xca)][_0x49e405(0x13d)](/\/disconnect/,async _0x3a215c=>{const _0x2005bf=_0x49e405,_0x4cbeb8=_0x3a215c['chat']['id'],_0x514d3a=_0x3a215c[_0x2005bf(0x162)]?.['id'][_0x2005bf(0xcd)]();if(!_0x514d3a)return;try{const _0x1e6805=await database_1['default'][_0x2005bf(0x121)][_0x2005bf(0x13e)]({'where':{'telegramId':_0x514d3a},'include':{'shop':!![]}});if(!_0x1e6805||!_0x1e6805[_0x2005bf(0x12b)]||!_0x1e6805['shopId']){await this['bot']?.['sendMessage'](_0x4cbeb8,_0x2005bf(0x11c));return;}const _0x4e4246=_0x1e6805[_0x2005bf(0x16b)]?.[_0x2005bf(0xf1)]||_0x2005bf(0x17f);await database_1[_0x2005bf(0xce)]['telegramUser'][_0x2005bf(0x144)]({'where':{'telegramId':_0x514d3a},'data':{'shopId':null,'isVerified':![]}}),console[_0x2005bf(0xe9)]('🔌\x20User\x20'+_0x514d3a+_0x2005bf(0x12c)+_0x1e6805[_0x2005bf(0x182)]),await this[_0x2005bf(0xca)]?.[_0x2005bf(0x16c)](_0x4cbeb8,_0x2005bf(0xe7)+_0x4e4246+_0x2005bf(0x145)+_0x2005bf(0x151),{'parse_mode':_0x2005bf(0x179)});}catch(_0x383985){console['error'](_0x2005bf(0x16f),_0x383985),await this['bot']?.[_0x2005bf(0x16c)](_0x4cbeb8,_0x2005bf(0xe2));}}),this[_0x49e405(0xca)][_0x49e405(0x13d)](/\/status/,async _0x576277=>{const _0x301839=_0x49e405,_0x37b471=_0x576277['chat']['id'],_0x1c896c=_0x576277[_0x301839(0x162)]?.['id'][_0x301839(0xcd)]();if(!_0x1c896c)return;try{const _0x5c932e=await database_1['default'][_0x301839(0x121)]['findUnique']({'where':{'telegramId':_0x1c896c},'include':{'shop':!![]}});if(!_0x5c932e){await this[_0x301839(0xca)]?.[_0x301839(0x16c)](_0x37b471,_0x301839(0x177)+_0x301839(0x18e));return;}if(!_0x5c932e[_0x301839(0x12b)]||!_0x5c932e[_0x301839(0x182)]||!_0x5c932e[_0x301839(0x16b)]){await this[_0x301839(0xca)]?.[_0x301839(0x16c)](_0x37b471,_0x301839(0x171)+_0x301839(0xf3));return;}await this['bot']?.[_0x301839(0x16c)](_0x37b471,_0x301839(0xeb)+(_0x301839(0xd8)+_0x5c932e[_0x301839(0x16b)][_0x301839(0xf1)]+'*\x0a')+('👤\x20Username:\x20`'+_0x5c932e['shop']['username']+'`\x0a')+('📅\x20Connection\x20date:\x20'+_0x5c932e[_0x301839(0x143)][_0x301839(0x16e)]('en-US')+'\x0a\x0a')+_0x301839(0xde)+_0x301839(0x158)+'/disconnect\x20-\x20disconnect\x20from\x20notifications',{'parse_mode':_0x301839(0x179)});}catch(_0x217773){console[_0x301839(0x10b)](_0x301839(0x141),_0x217773),await this[_0x301839(0xca)]?.[_0x301839(0x16c)](_0x37b471,_0x301839(0xe2));}}),this['bot'][_0x49e405(0x13d)](/\/debug/,async _0x481577=>{const _0x39f934=_0x49e405,_0x1083d9=_0x481577[_0x39f934(0x152)]['id'],_0x34580b=_0x481577[_0x39f934(0x162)]?.['id'][_0x39f934(0xcd)]();if(!_0x34580b)return;try{const _0x17b5ca=await database_1[_0x39f934(0xce)][_0x39f934(0x16b)][_0x39f934(0x170)]({'select':{'id':!![],'name':!![],'username':!![],'status':!![],'publicKey':!![]},'take':0xa});let _0x59bfae=_0x39f934(0x128);_0x59bfae+='📱\x20Your\x20Telegram\x20ID:\x20`'+_0x34580b+'`\x0a\x0a',_0x59bfae+=_0x39f934(0x185),_0x17b5ca[_0x39f934(0x110)]((_0x1ccdb2,_0xc5642)=>{const _0x1a5534=_0x39f934;_0x59bfae+=_0xc5642+0x1+'.\x20*'+_0x1ccdb2['name']+'*\x0a',_0x59bfae+=_0x1a5534(0xd0)+_0x1ccdb2[_0x1a5534(0xe3)]+'`\x0a',_0x59bfae+='\x20\x20\x20Status:\x20'+_0x1ccdb2['status']+'\x0a',_0x59bfae+=_0x1a5534(0xc8)+_0x1ccdb2['publicKey']['substring'](0x0,0xf)+_0x1a5534(0xf0);}),await this[_0x39f934(0xca)]?.[_0x39f934(0x16c)](_0x1083d9,_0x59bfae,{'parse_mode':_0x39f934(0x179)});}catch(_0x20cdff){console[_0x39f934(0x10b)](_0x39f934(0x165),_0x20cdff),await this[_0x39f934(0xca)]?.[_0x39f934(0x16c)](_0x1083d9,_0x39f934(0x10d));}}),this['bot']['on']('message',async _0x3e9de7=>{const _0x342df7=_0x49e405;if(_0x3e9de7['text']?.['startsWith']('/'))return;const _0x39ef52=_0x3e9de7[_0x342df7(0x152)]['id'],_0x545f22=_0x3e9de7['from']?.['id']['toString'](),_0x34be64=_0x3e9de7[_0x342df7(0xbe)]?.[_0x342df7(0xdd)]();if(!_0x545f22||!_0x34be64)return;try{const _0x524d6e=await database_1['default']['telegramUser'][_0x342df7(0x13e)]({'where':{'telegramId':_0x545f22},'include':{'shop':!![]}});if(!_0x524d6e){await this[_0x342df7(0xca)]?.[_0x342df7(0x16c)](_0x39ef52,_0x342df7(0x107));return;}if(_0x524d6e[_0x342df7(0x12b)]&&_0x524d6e[_0x342df7(0x182)]&&_0x524d6e['shop']){await this[_0x342df7(0xca)]?.[_0x342df7(0x16c)](_0x39ef52,'✅\x20You\x20are\x20already\x20connected\x20to\x20shop\x20*'+_0x524d6e['shop'][_0x342df7(0xf1)]+'*.\x0a\x0a'+_0x342df7(0x1a2),{'parse_mode':_0x342df7(0x179)});return;}const _0x4ff168=_0x34be64['split'](/\s+/);if(_0x4ff168[_0x342df7(0x10f)]!==0x2){await this[_0x342df7(0xca)]?.[_0x342df7(0x16c)](_0x39ef52,_0x342df7(0xfc)+_0x342df7(0x15b)+_0x342df7(0x166)+_0x342df7(0x10e)+(_0x342df7(0x132)+_0x4ff168[_0x342df7(0x10f)]+_0x342df7(0x111)+_0x4ff168[_0x342df7(0x17d)](_0x126036=>'`'+_0x126036+'`')[_0x342df7(0x14e)](',\x20')),{'parse_mode':'Markdown'});return;}const [_0x48396b,_0x374cfe]=_0x4ff168;console[_0x342df7(0xe9)]('🔄\x20Processing\x20single-line\x20verification\x20for\x20user\x20'+_0x545f22+_0x342df7(0xed)+_0x48396b+_0x342df7(0xd7)+_0x374cfe['substring'](0x0,0xa)+_0x342df7(0x138)),await this['handleSingleLineVerification'](_0x39ef52,_0x545f22,_0x48396b,_0x374cfe);}catch(_0x52d606){console[_0x342df7(0x10b)](_0x342df7(0x175),_0x52d606),await this[_0x342df7(0xca)]?.['sendMessage'](_0x39ef52,_0x342df7(0xe2));}}),this[_0x49e405(0xca)]['on'](_0x49e405(0x10b),_0x3cb0b8=>{const _0x40f06b=_0x49e405;console[_0x40f06b(0x10b)](_0x40f06b(0xd4),_0x3cb0b8);}),this[_0x49e405(0xca)]['on'](_0x49e405(0x183),_0x2f16a5=>{const _0x2c7ad0=_0x49e405;console[_0x2c7ad0(0x10b)](_0x2c7ad0(0x15a),_0x2f16a5);});}async[a58_0x3c17cc(0x16a)](_0x46513d,_0x327622,_0x4c0cea,_0x457e16){const _0x288b39=a58_0x3c17cc;try{console[_0x288b39(0xe9)]('🔄\x20Processing\x20single-line\x20verification\x20for\x20user\x20'+_0x327622+_0x288b39(0xed)+_0x4c0cea+'\x22,\x20apiKey=\x22'+_0x457e16[_0x288b39(0x1a0)](0x0,0xa)+'...\x22');if(!_0x4c0cea||_0x4c0cea['length']<0x3||_0x4c0cea[_0x288b39(0x10f)]>0x32||!/^[a-zA-Z0-9_]+$/[_0x288b39(0x17c)](_0x4c0cea)){await this[_0x288b39(0xca)]?.['sendMessage'](_0x46513d,_0x288b39(0x14b)+_0x4c0cea+_0x288b39(0x199)+_0x288b39(0x12d),{'parse_mode':_0x288b39(0x179)});return;}if(!_0x457e16||!_0x457e16[_0x288b39(0x137)](_0x288b39(0x150))&&!_0x457e16['startsWith'](_0x288b39(0x133))){await this['bot']?.[_0x288b39(0x16c)](_0x46513d,'❌\x20Invalid\x20API\x20key\x20format.\x0a\x0a'+_0x288b39(0x153),{'parse_mode':_0x288b39(0x179)});return;}const _0x130384=await database_1[_0x288b39(0xce)][_0x288b39(0x16b)]['findUnique']({'where':{'username':_0x4c0cea},'select':{'id':!![],'name':!![],'username':!![],'status':!![],'publicKey':!![],'secretKey':!![]}});if(!_0x130384){const _0x113f8a=await database_1[_0x288b39(0xce)][_0x288b39(0x16b)]['findMany']({'select':{'username':!![],'name':!![]},'take':0x5});let _0x25368=_0x288b39(0x15c)+_0x4c0cea+_0x288b39(0x116);_0x113f8a['length']>0x0?(_0x25368+='Available\x20usernames:\x0a',_0x113f8a[_0x288b39(0x110)](_0x48c2a1=>{const _0x56a54f=_0x288b39;_0x25368+='•\x20`'+_0x48c2a1[_0x56a54f(0xe3)]+_0x56a54f(0x10a)+_0x48c2a1['name']+')\x0a';}),_0x25368+=_0x288b39(0x13b)):_0x25368+=_0x288b39(0x130);await this[_0x288b39(0xca)]?.[_0x288b39(0x16c)](_0x46513d,_0x25368,{'parse_mode':'Markdown'});return;}if(_0x130384['status']!==_0x288b39(0x18f)){await this[_0x288b39(0xca)]?.[_0x288b39(0x16c)](_0x46513d,'❌\x20Shop\x20`'+_0x4c0cea+_0x288b39(0xfd)+_0x288b39(0x168),{'parse_mode':_0x288b39(0x179)});return;}if(_0x130384[_0x288b39(0xd6)]!==_0x457e16&&_0x130384['secretKey']!==_0x457e16){await this[_0x288b39(0xca)]?.['sendMessage'](_0x46513d,_0x288b39(0x164)+_0x4c0cea+_0x288b39(0x135)+_0x288b39(0xd5)+'Expected\x20key\x20format:\x20`pk_...`\x20or\x20`sk_...`',{'parse_mode':_0x288b39(0x179)});return;}const _0x3067e4=await database_1[_0x288b39(0xce)][_0x288b39(0x121)]['findFirst']({'where':{'shopId':_0x130384['id'],'isVerified':!![],'telegramId':{'not':_0x327622}}});if(_0x3067e4){await this['bot']?.[_0x288b39(0x16c)](_0x46513d,_0x288b39(0xda)+_0x4c0cea+'`.\x0a\x0a'+_0x288b39(0x129),{'parse_mode':_0x288b39(0x179)});return;}await database_1[_0x288b39(0xce)][_0x288b39(0x121)]['update']({'where':{'telegramId':_0x327622},'data':{'shopId':_0x130384['id'],'isVerified':!![]}}),await this[_0x288b39(0xca)]?.[_0x288b39(0x16c)](_0x46513d,_0x288b39(0x159)+'✅\x20You\x20have\x20been\x20successfully\x20connected\x20to\x20the\x20notification\x20system!\x0a\x0a'+(_0x288b39(0x163)+_0x130384[_0x288b39(0xf1)]+'*\x0a')+(_0x288b39(0x196)+_0x130384[_0x288b39(0xe3)]+_0x288b39(0x199))+_0x288b39(0x14c)+'•\x20New\x20payments\x0a'+_0x288b39(0x184)+_0x288b39(0x190)+_0x288b39(0xff)+_0x288b39(0x158)+_0x288b39(0x186)+_0x288b39(0x195),{'parse_mode':_0x288b39(0x179)}),console['log']('✅\x20Telegram\x20user\x20'+_0x327622+_0x288b39(0x102)+_0x130384[_0x288b39(0xe3)]+_0x288b39(0x11d));}catch(_0x591fbb){console['error'](_0x288b39(0x148),_0x591fbb),await this[_0x288b39(0xca)]?.['sendMessage'](_0x46513d,'❌\x20An\x20error\x20occurred\x20while\x20verifying\x20data.');}}async['sendShopNotification'](_0xdd714,_0x1f75e0,_0x280701){const _0x52fae9=a58_0x3c17cc;if(!this[_0x52fae9(0xca)]){console['warn'](_0x52fae9(0x131));return;}try{const _0x34fc0a=await database_1[_0x52fae9(0xce)][_0x52fae9(0x121)][_0x52fae9(0x170)]({'where':{'shopId':_0xdd714,'isVerified':!![]}});if(_0x34fc0a[_0x52fae9(0x10f)]===0x0){console[_0x52fae9(0xe9)](_0x52fae9(0x18c)+_0xdd714);return;}const _0x449811=_0x34fc0a[_0x52fae9(0x17d)](async _0x223cd5=>{const _0x5ef4b1=_0x52fae9;try{await this['bot']?.[_0x5ef4b1(0x16c)](_0x223cd5[_0x5ef4b1(0x10c)],_0x1f75e0,_0x280701),console[_0x5ef4b1(0xe9)](_0x5ef4b1(0xd1)+_0x223cd5[_0x5ef4b1(0x10c)]);}catch(_0x403020){console[_0x5ef4b1(0x10b)](_0x5ef4b1(0x174)+_0x223cd5['telegramId']+':',_0x403020),_0x403020 instanceof Error&&(_0x403020['message'][_0x5ef4b1(0x117)](_0x5ef4b1(0xd3))||_0x403020[_0x5ef4b1(0xfa)]['includes'](_0x5ef4b1(0x140))||_0x403020[_0x5ef4b1(0xfa)][_0x5ef4b1(0x117)](_0x5ef4b1(0x101)))&&(await database_1[_0x5ef4b1(0xce)][_0x5ef4b1(0x121)][_0x5ef4b1(0x144)]({'where':{'id':_0x223cd5['id']},'data':{'isVerified':![]}}),console[_0x5ef4b1(0xe9)](_0x5ef4b1(0x118)+_0x223cd5[_0x5ef4b1(0x10c)]+_0x5ef4b1(0x19d)));}});await Promise[_0x52fae9(0x114)](_0x449811);}catch(_0xd95e9d){console[_0x52fae9(0x10b)](_0x52fae9(0x157),_0xd95e9d);}}async[a58_0x3c17cc(0x149)](_0x311dd0,_0x2b6a64,_0x8e396){const _0x535125=a58_0x3c17cc,_0x44cabd={'created':'🆕','paid':'✅','failed':'❌','expired':'⏰','refund':'🔄','chargeback':'⚠️','processing':'⚙️'},_0x20411b={'created':'New\x20payment\x20created','paid':_0x535125(0x147),'failed':'Payment\x20failed','expired':_0x535125(0x15d),'refund':_0x535125(0x127),'chargeback':_0x535125(0x181),'processing':_0x535125(0x146)},_0x41b47a=_0x44cabd[_0x8e396],_0x3cb3bf=_0x20411b[_0x8e396],_0x2a0a2d=(0x0,gateway_1[_0x535125(0xe1)])(_0x2b6a64[_0x535125(0x169)]);console[_0x535125(0xe9)]('📱\x20Telegram\x20notification:\x20gateway\x20\x22'+_0x2b6a64['gateway']+_0x535125(0xfe)+_0x2a0a2d+'\x22');let _0x4a9ec6=_0x41b47a+'\x20*'+_0x3cb3bf+_0x535125(0x18d)+(_0x535125(0xf8)+_0x2b6a64['amount']+'\x20'+_0x2b6a64[_0x535125(0x13f)]+'*\x0a')+('📝\x20Order\x20ID:\x20`'+(_0x2b6a64[_0x535125(0x100)]||_0x2b6a64['id'])+'`\x0a')+(_0x535125(0xbf)+_0x2b6a64['id']+'`\x0a')+(_0x535125(0x12a)+_0x2a0a2d+'`\x0a')+(_0x535125(0x11f)+new Date(_0x2b6a64[_0x535125(0x178)])[_0x535125(0x109)](_0x535125(0x176))+'\x0a');if(_0x2b6a64[_0x535125(0x193)]||_0x2b6a64[_0x535125(0xcb)]||_0x2b6a64[_0x535125(0xe4)]||_0x2b6a64[_0x535125(0x119)]||_0x2b6a64[_0x535125(0xee)]){_0x4a9ec6+=_0x535125(0x136);_0x2b6a64['customerName']&&(_0x4a9ec6+=_0x535125(0xcf)+_0x2b6a64[_0x535125(0x193)]+'`\x0a');_0x2b6a64[_0x535125(0xcb)]&&(_0x4a9ec6+=_0x535125(0x173)+_0x2b6a64[_0x535125(0xcb)]+'`\x0a');_0x2b6a64[_0x535125(0xe4)]&&(_0x4a9ec6+=_0x535125(0x18b)+_0x2b6a64[_0x535125(0xe4)]+'`\x0a');_0x2b6a64[_0x535125(0x119)]&&(_0x4a9ec6+=_0x535125(0xc0)+_0x2b6a64[_0x535125(0x119)]+'`\x0a');if(_0x2b6a64[_0x535125(0xee)]){const _0x53022e=_0x2b6a64[_0x535125(0xee)][_0x535125(0x10f)]>0x32?_0x2b6a64['customerUa'][_0x535125(0x1a0)](0x0,0x32)+_0x535125(0x142):_0x2b6a64['customerUa'];_0x4a9ec6+=_0x535125(0x104)+_0x53022e+'`\x0a';}}_0x8e396===_0x535125(0xe5)&&_0x2b6a64[_0x535125(0x160)]&&(_0x4a9ec6+=_0x535125(0x120)+_0x2b6a64[_0x535125(0x160)]+_0x535125(0x124)),_0x8e396===_0x535125(0xc7)&&(_0x4a9ec6+=_0x535125(0x103)),_0x2b6a64[_0x535125(0x191)]&&(_0x4a9ec6+=_0x535125(0xe0)+_0x2b6a64[_0x535125(0x191)]+'\x0a'),await this['sendShopNotification'](_0x311dd0,_0x4a9ec6,{'parse_mode':_0x535125(0x179)});}async[a58_0x3c17cc(0x172)](_0x3ddac0,_0x2cf40e,_0x4f2074){const _0xae41d0=a58_0x3c17cc,_0xeb8150={'created':'📤','completed':'✅','rejected':'❌'},_0x5bcd1a={'created':_0xae41d0(0xdf),'completed':_0xae41d0(0x187),'rejected':_0xae41d0(0x105)},_0x2eb58b=_0xeb8150[_0x4f2074],_0x393066=_0x5bcd1a[_0x4f2074],_0x1e86e5=_0x2eb58b+'\x20*'+_0x393066+'*\x0a\x0a'+(_0xae41d0(0xf2)+_0x2cf40e[_0xae41d0(0x11b)]+_0xae41d0(0xc1))+(_0xae41d0(0x15e)+_0x2cf40e['method']+'`\x0a')+(_0xae41d0(0xfb)+_0x2cf40e['id']+'`\x0a')+(_0xae41d0(0x11f)+new Date(_0x2cf40e[_0xae41d0(0x178)])[_0xae41d0(0x109)]('en-US')+'\x0a')+(_0x2cf40e['txid']?_0xae41d0(0xc4)+_0x2cf40e[_0xae41d0(0x11a)]+'`':'');await this['sendShopNotification'](_0x3ddac0,_0x1e86e5,{'parse_mode':_0xae41d0(0x179)});}async[a58_0x3c17cc(0x198)](_0xe7a7eb,_0x24ae7f){const _0xda733e=a58_0x3c17cc;try{const _0x5c9615=await database_1[_0xda733e(0xce)][_0xda733e(0x156)]['findUnique']({'where':{'shopId':_0xe7a7eb},'select':{'notificationLogin':!![]}});if(!_0x5c9615?.[_0xda733e(0x154)]){console[_0xda733e(0xe9)](_0xda733e(0x19f)+_0xe7a7eb);return;}const _0x19b99b=_0x24ae7f['success']?'🔐':'🚨',_0x35d84c=_0x24ae7f[_0xda733e(0x180)]?_0xda733e(0x192):_0xda733e(0x17b);let _0x6d37ba=_0x19b99b+'\x20*'+_0x35d84c+_0xda733e(0x18d)+(_0xda733e(0x196)+_0x24ae7f['username']+'`\x0a')+('📅\x20Time:\x20'+_0x24ae7f[_0xda733e(0xf6)][_0xda733e(0x109)]('en-US')+'\x0a');_0x24ae7f[_0xda733e(0x197)]&&(_0x6d37ba+='🌐\x20IP\x20address:\x20`'+_0x24ae7f[_0xda733e(0x197)]+'`\x0a');if(_0x24ae7f[_0xda733e(0x123)]){const _0x42dacf=_0x24ae7f['userAgent']['length']>0x32?_0x24ae7f[_0xda733e(0x123)][_0xda733e(0x1a0)](0x0,0x32)+'...':_0x24ae7f[_0xda733e(0x123)];_0x6d37ba+='💻\x20Browser:\x20`'+_0x42dacf+'`\x0a';}!_0x24ae7f[_0xda733e(0x180)]&&(_0x6d37ba+='\x0a⚠️\x20If\x20this\x20wasn\x27t\x20you,\x20change\x20your\x20password\x20immediately!'),await this[_0xda733e(0x17e)](_0xe7a7eb,_0x6d37ba,{'parse_mode':_0xda733e(0x179)}),console[_0xda733e(0xe9)](_0xda733e(0xef)+_0xe7a7eb+':\x20'+(_0x24ae7f['success']?_0xda733e(0x180):_0xda733e(0xe6)));}catch(_0x100d43){console['error']('Failed\x20to\x20send\x20login\x20notification:',_0x100d43);}}async[a58_0x3c17cc(0x194)](_0x28724d,_0x9b0e40){const _0x17ea19=a58_0x3c17cc;try{const _0x4faaaf=await database_1[_0x17ea19(0xce)][_0x17ea19(0x156)][_0x17ea19(0x13e)]({'where':{'shopId':_0x28724d},'select':{'notificationApiError':!![]}});if(!_0x4faaaf?.[_0x17ea19(0x19b)]){console['log']('📱\x20API\x20error\x20notifications\x20disabled\x20for\x20shop\x20'+_0x28724d);return;}let _0x24f6c1=_0x17ea19(0xc3)+(_0x17ea19(0xc5)+_0x9b0e40['method']+'\x20'+_0x9b0e40[_0x17ea19(0xf5)]+'`\x0a')+('📅\x20Time:\x20'+_0x9b0e40[_0x17ea19(0xf6)][_0x17ea19(0x109)](_0x17ea19(0x176))+'\x0a');_0x9b0e40[_0x17ea19(0xdc)]&&(_0x24f6c1+='📊\x20Error\x20code:\x20`'+_0x9b0e40[_0x17ea19(0xdc)]+'`\x0a'),_0x24f6c1+='❌\x20Error:\x20`'+_0x9b0e40[_0x17ea19(0x167)]+'`\x0a',_0x9b0e40[_0x17ea19(0x125)]&&(_0x24f6c1+=_0x17ea19(0x115)+_0x9b0e40[_0x17ea19(0x125)]+'`\x0a'),_0x24f6c1+=_0x17ea19(0xc2),await this[_0x17ea19(0x17e)](_0x28724d,_0x24f6c1,{'parse_mode':_0x17ea19(0x179)}),console[_0x17ea19(0xe9)]('✅\x20API\x20error\x20notification\x20sent\x20for\x20shop\x20'+_0x28724d+':\x20'+_0x9b0e40[_0x17ea19(0xf5)]);}catch(_0x53b172){console[_0x17ea19(0x10b)](_0x17ea19(0xc9),_0x53b172);}}async[a58_0x3c17cc(0x17a)](_0x48dcbe,_0x51db81,_0x260c5d){const _0x502bcb=a58_0x3c17cc;let _0x2d3347=_0x502bcb(0xdb)+_0x51db81+_0x502bcb(0x18d);for(const [_0x54b02d,_0x2411ad]of Object['entries'](_0x260c5d)){_0x2411ad!==null&&_0x2411ad!==undefined&&(_0x2d3347+=_0x54b02d+_0x502bcb(0x11e)+_0x2411ad+'`\x0a');}await this[_0x502bcb(0x17e)](_0x48dcbe,_0x2d3347,{'parse_mode':_0x502bcb(0x179)});}['getBotInfo'](){const _0x272c0f=a58_0x3c17cc;return{'isActive':!!this['bot'],'username':this[_0x272c0f(0x13c)]};}[a58_0x3c17cc(0x18a)](){const _0x32019c=a58_0x3c17cc;this[_0x32019c(0xca)]&&(this[_0x32019c(0xca)][_0x32019c(0x14d)](),this[_0x32019c(0xca)]=null,console[_0x32019c(0xe9)](_0x32019c(0x14f)));}}function a58_0x2a7b(){const _0x3654d7=['🔗\x20Endpoint:\x20`','🤖\x20Welcome\x20to\x20TRAPAY\x20notification\x20system!\x0a\x0a','processing','\x20\x20\x20Public\x20Key:\x20`','Failed\x20to\x20send\x20API\x20error\x20notification:','bot','customerEmail','❗️\x20Make\x20sure\x20to\x20separate\x20username\x20and\x20API\x20key\x20with\x20a\x20space!','toString','default','📛\x20Name:\x20`','\x20\x20\x20Username:\x20`','✅\x20Notification\x20sent\x20to\x20Telegram\x20user\x20','📱\x20Created\x20new\x20Telegram\x20user:\x20','blocked','Telegram\x20bot\x20error:','Check\x20the\x20key\x20and\x20try\x20again.\x0a\x0a','publicKey','\x22,\x20apiKey=\x22','✅\x20Connected\x20to\x20shop:\x20*','initializeBot','❌\x20Another\x20Telegram\x20account\x20is\x20already\x20connected\x20to\x20shop\x20`','🔔\x20*','statusCode','trim','🔔\x20Notifications\x20are\x20active\x0a\x0a','New\x20payout\x20created','📝\x20Notes:\x20','getGatewayDisplayNameForTelegram','❌\x20An\x20error\x20occurred.\x20Please\x20try\x20again\x20later.','username','remitterIban','chargeback','failed','✅\x20You\x20have\x20been\x20successfully\x20disconnected\x20from\x20shop\x20*','Error\x20handling\x20/start\x20command:','log','3013206gqZXwr','📊\x20*Connection\x20Status*\x0a\x0a','TELEGRAM_BOT_USERNAME',':\x20username=\x22','customerUa','✅\x20Login\x20notification\x20sent\x20for\x20shop\x20','...`\x0a\x0a','name','💸\x20Amount:\x20*','Use\x20/start\x20to\x20connect.','defineProperty','endpoint','timestamp','botToken','💰\x20Amount:\x20*','warn','message','🆔\x20Payout\x20ID:\x20`','❌\x20Invalid\x20format.\x20Please\x20send\x20exactly\x202\x20parts\x20separated\x20by\x20space:\x0a\x0a','`\x20is\x20inactive.\x0a\x0a','\x22\x20->\x20display\x20\x22','•\x20Important\x20events\x0a\x0a','orderId','user\x20is\x20deactivated','\x20verified\x20for\x20shop\x20','⏳\x20The\x20payment\x20is\x20currently\x20being\x20processed\x20by\x20the\x20gateway.\x0a','💻\x20Browser:\x20`','Payout\x20rejected','2560495iBHanB','❌\x20Please\x20use\x20/start\x20command\x20first','trapay_bot','toLocaleString','`\x20(','error','telegramId','❌\x20Error\x20getting\x20debug\x20information.','`appple\x20pk_aa6450d3f57afbefbb0f3f5be5ce6cca13037536afc5ccf14c81a6cbc7a07de5`\x0a\x0a','length','forEach','\x20parts:\x20','•\x20Payouts\x0a\x0a','🔔\x20You\x20receive\x20notifications\x20about:\x0a','allSettled','🆔\x20Request\x20ID:\x20`','`\x20not\x20found.\x0a\x0a','includes','User\x20','customerIp','txid','amount','❌\x20You\x20are\x20not\x20connected\x20to\x20the\x20notification\x20system.','\x20via\x20single-line\x20input',':\x20`','📅\x20Date:\x20','💸\x20Penalty\x20amount:\x20*','telegramUser','first_name','userAgent','\x20USDT*\x0a','requestId','770945EturAj','Payment\x20refund','🔍\x20*Debug\x20Information*\x0a\x0a','Disconnect\x20the\x20previous\x20account\x20first\x20or\x20contact\x20administrator.','🏪\x20Gateway:\x20`','isVerified','\x20disconnected\x20from\x20shop\x20','Username\x20must\x20contain\x20only\x20letters,\x20numbers\x20and\x20underscore\x20(3-50\x20characters).','You\x20are\x20already\x20connected\x20to\x20shop:\x20*','770037oJPXbC','Check\x20spelling\x20and\x20try\x20again.','Telegram\x20bot\x20not\x20initialized,\x20cannot\x20send\x20notification','You\x20sent\x20','sk_','TelegramBotService','`.\x0a\x0a','\x0a👤\x20*Customer\x20Information:*\x0a','startsWith','...\x22','setupBotHandlers','✅\x20Welcome\x20back!\x0a\x0a','\x0aCheck\x20spelling\x20and\x20try\x20again.','botUsername','onText','findUnique','currency','chat\x20not\x20found','Error\x20handling\x20/status\x20command:','...','updatedAt','update','*.\x0a\x0a','Payment\x20is\x20being\x20processed','Payment\x20successfully\x20paid','Error\x20in\x20handleSingleLineVerification:','sendPaymentNotification','../types/gateway','❌\x20Invalid\x20username\x20format:\x20`','🔔\x20You\x20will\x20now\x20receive\x20notifications\x20about:\x0a','stopPolling','join','🛑\x20Telegram\x20bot\x20stopped','pk_','To\x20reconnect,\x20use\x20the\x20/start\x20command','chat','API\x20key\x20must\x20start\x20with\x20`pk\x5c_`\x20or\x20`sk\x5c_`.','notificationLogin','❌\x20Failed\x20to\x20initialize\x20Telegram\x20bot:','shopSettings','Error\x20sending\x20shop\x20notification:','Commands:\x0a','🎉\x20*Congratulations!*\x0a\x0a','Telegram\x20bot\x20polling\x20error:','📝\x20Format:\x20`username\x20api_key`\x0a\x0a','❌\x20Shop\x20with\x20username\x20`','Payment\x20expired','🏦\x20Method:\x20`','env','chargebackAmount','11676080aJwhmp','from','📱\x20Shop:\x20*','❌\x20API\x20key\x20does\x20not\x20match\x20shop\x20`','Error\x20handling\x20/debug\x20command:','Example:\x0a','errorMessage','Contact\x20administrator.','gateway','handleSingleLineVerification','shop','sendMessage','4694755tzrfUb','toLocaleDateString','Error\x20handling\x20/disconnect\x20command:','findMany','❌\x20You\x20are\x20not\x20connected\x20to\x20a\x20shop.\x0a\x0a','sendPayoutNotification','📧\x20Email:\x20`','❌\x20Failed\x20to\x20send\x20notification\x20to\x20Telegram\x20user\x20','Error\x20handling\x20message:','en-US','❌\x20You\x20are\x20not\x20registered\x20in\x20the\x20system.\x0a\x0a','createdAt','Markdown','sendCustomNotification','Failed\x20login\x20attempt','test','map','sendShopNotification','unknown\x20shop','success','Payment\x20chargeback','shopId','polling_error','•\x20Payment\x20status\x20changes\x0a','🏪\x20Available\x20shops\x20in\x20system:\x0a','/status\x20-\x20check\x20connection\x20status\x0a','Payout\x20completed','✅\x20Telegram\x20bot\x20@','4231764HFUubY','stopBot','🏦\x20IBAN:\x20`','No\x20verified\x20Telegram\x20users\x20found\x20for\x20shop\x20','*\x0a\x0a','Use\x20/start\x20to\x20begin.','ACTIVE','•\x20Payouts\x0a','adminNotes','Successful\x20login','customerName','sendApiErrorNotification','/disconnect\x20-\x20disconnect\x20from\x20notifications','👤\x20Username:\x20`','ipAddress','sendLoginNotification','`\x0a\x0a','__importDefault','notificationApiError','4sFHVLo','\x20marked\x20as\x20unverified\x20due\x20to\x20delivery\x20failure','__esModule','📱\x20Login\x20notifications\x20disabled\x20for\x20shop\x20','substring','../config/database','Use\x20/status\x20to\x20check\x20status\x20or\x20/disconnect\x20to\x20disconnect.','\x20(@','text','🆔\x20Payment\x20ID:\x20`','🌐\x20IP:\x20`','\x20USD*\x0a','\x0a💡\x20Check\x20your\x20request\x20or\x20contact\x20support.','🚨\x20*API\x20Error*\x0a\x0a','🔗\x20TXID:\x20`'];a58_0x2a7b=function(){return _0x3654d7;};return a58_0x2a7b();}exports[a58_0x3c17cc(0x134)]=TelegramBotService,exports['telegramBotService']=new TelegramBotService();