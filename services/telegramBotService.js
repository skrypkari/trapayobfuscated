'use strict';const a54_0x57fce0=a54_0x5583;function a54_0x5583(_0x56f89e,_0x5d976b){const _0x14408c=a54_0x1440();return a54_0x5583=function(_0x5583f2,_0xe4a1c8){_0x5583f2=_0x5583f2-0x152;let _0x202d00=_0x14408c[_0x5583f2];return _0x202d00;},a54_0x5583(_0x56f89e,_0x5d976b);}function a54_0x1440(){const _0x3fc323=['method','map','📊\x20Error\x20code:\x20`','username','\x22,\x20apiKey=\x22','\x20via\x20single-line\x20input','Failed\x20to\x20send\x20login\x20notification:','telegramBotService','secretKey','toLocaleDateString','split','Use\x20/status\x20to\x20check\x20status\x20or\x20/disconnect\x20to\x20disconnect.','\x20(@','•\x20New\x20payments\x0a','endpoint','findMany','•\x20Payouts\x0a','chat\x20not\x20found','trim','❌\x20An\x20error\x20occurred\x20while\x20verifying\x20data.','Failed\x20to\x20send\x20API\x20error\x20notification:','💸\x20Amount:\x20*','error',':\x20username=\x22','getBotInfo','❌\x20Failed\x20to\x20send\x20notification\x20to\x20Telegram\x20user\x20','adminNotes','name','Error\x20handling\x20/start\x20command:','\x0a⚠️\x20If\x20this\x20wasn\x27t\x20you,\x20change\x20your\x20password\x20immediately!','❌\x20API\x20key\x20does\x20not\x20match\x20shop\x20`','👤\x20Username:\x20`','...','*.\x0a\x0a','🔗\x20TXID:\x20`','🤖\x20Welcome\x20to\x20TRAPAY\x20notification\x20system!\x0a\x0a','Error\x20handling\x20/debug\x20command:','polling_error','❌\x20Please\x20use\x20/start\x20command\x20first','Payment\x20chargeback','💰\x20Amount:\x20*','txid','24759DDsrQB','29456EYPwrQ','1518350RXjjsY','shopSettings','chat','en-US','Error\x20in\x20handleSingleLineVerification:','log','\x20\x20\x20Username:\x20`','✅\x20Telegram\x20user\x20','❌\x20Shop\x20with\x20username\x20`','Error\x20handling\x20/status\x20command:','\x0a👤\x20*Customer\x20Information:*\x0a','Check\x20spelling\x20and\x20try\x20again.','ACTIVE','📅\x20Date:\x20','`.\x0a\x0a','New\x20payment\x20created','Payment\x20failed','🔍\x20*Debug\x20Information*\x0a\x0a','amount','📱\x20Shop:\x20*','New\x20payout\x20created','../types/gateway','✅\x20You\x20have\x20been\x20successfully\x20connected\x20to\x20the\x20notification\x20system!\x0a\x0a','Payment\x20expired','You\x20are\x20already\x20connected\x20to\x20shop:\x20*','TelegramBotService','API\x20key\x20must\x20start\x20with\x20`pk\x5c_`\x20or\x20`sk\x5c_`.','❌\x20You\x20are\x20not\x20registered\x20in\x20the\x20system.\x0a\x0a','🎉\x20*Congratulations!*\x0a\x0a','•\x20`','startsWith','❗️\x20Make\x20sure\x20to\x20separate\x20username\x20and\x20API\x20key\x20with\x20a\x20space!','\x20USDT*\x0a','notificationApiError','•\x20Important\x20events\x0a\x0a','botUsername','❌\x20An\x20error\x20occurred.\x20Please\x20try\x20again\x20later.','Telegram\x20bot\x20error:','join','Contact\x20administrator.','User\x20','*\x0a\x0a','❌\x20Another\x20Telegram\x20account\x20is\x20already\x20connected\x20to\x20shop\x20`','handleSingleLineVerification','processing','/disconnect\x20-\x20disconnect\x20from\x20notifications','Username:\x20`','sendShopNotification','📱\x20Login\x20notifications\x20disabled\x20for\x20shop\x20','shopId','first_name','Telegram\x20bot\x20not\x20initialized,\x20cannot\x20send\x20notification','chargebackAmount','unknown\x20shop','Markdown','default','🆔\x20Request\x20ID:\x20`','last_name','Payout\x20rejected','42yCirsm','orderId','\x20parts:\x20','Error\x20handling\x20message:','Use\x20/start\x20to\x20connect.','Username\x20must\x20contain\x20only\x20letters,\x20numbers\x20and\x20underscore\x20(3-50\x20characters).','userAgent','🌐\x20IP\x20address:\x20`','setupBotHandlers','TELEGRAM_BOT_TOKEN\x20not\x20found\x20in\x20environment\x20variables','💻\x20Browser:\x20`','/status\x20-\x20check\x20connection\x20status\x0a','update','toString','findUnique','gateway','warn','sendPaymentNotification','📧\x20Email:\x20`','`appple\x20pk_aa6450d3f57afbefbb0f3f5be5ce6cca13037536afc5ccf14c81a6cbc7a07de5`\x0a\x0a','initializeBot','📝\x20Notes:\x20','node-telegram-bot-api','onText','•\x20Payment\x20status\x20changes\x0a','bot','Failed\x20login\x20attempt','status','../config/database','🔄\x20Processing\x20single-line\x20verification\x20for\x20user\x20','✅\x20Welcome\x20back!\x0a\x0a','publicKey','sendLoginNotification','create','telegramId','❌\x20Invalid\x20API\x20key\x20format.\x0a\x0a','success','📝\x20Format:\x20`username\x20api_key`\x0a\x0a','8piADLY','Example:\x0a','🔔\x20*','414bHAUDB','test','Payout\x20completed','isVerified','__importDefault','To\x20reconnect,\x20use\x20the\x20/start\x20command','•\x20Payouts\x0a\x0a','Error\x20sending\x20shop\x20notification:','🏪\x20Available\x20shops\x20in\x20system:\x0a','timestamp','...`\x0a\x0a','⏳\x20The\x20payment\x20is\x20currently\x20being\x20processed\x20by\x20the\x20gateway.\x0a','__esModule','📝\x20Order\x20ID:\x20`','sendMessage','📱\x20Created\x20new\x20Telegram\x20user:\x20','❌\x20You\x20are\x20not\x20connected\x20to\x20the\x20notification\x20system.','from','createdAt','❌\x20Invalid\x20username\x20format:\x20`','notificationLogin','186EstRjN','sendApiErrorNotification','Successful\x20login','9302PAuscr','telegramUser','Available\x20usernames:\x0a','allSettled','text','🔗\x20Endpoint:\x20`','📱\x20API\x20error\x20notifications\x20disabled\x20for\x20shop\x20','Error\x20handling\x20/disconnect\x20command:','requestId','✅\x20Connected\x20to\x20shop:\x20*','❌\x20Invalid\x20format.\x20Please\x20send\x20exactly\x202\x20parts\x20separated\x20by\x20space:\x0a\x0a','🔔\x20You\x20receive\x20notifications\x20about:\x0a','message','toLocaleString','currency','408490pPRLLC','🆔\x20Payout\x20ID:\x20`','customerEmail','Disconnect\x20the\x20previous\x20account\x20first\x20or\x20contact\x20administrator.','1793280xesTYk','ipAddress','Use\x20/start\x20to\x20begin.','\x20USD*\x0a','Payment\x20is\x20being\x20processed','📱\x20Your\x20Telegram\x20ID:\x20`','shop','customerName','🏪\x20Gateway:\x20`',':\x20`','env','🚨\x20*API\x20Error*\x0a\x0a','🔔\x20You\x20will\x20now\x20receive\x20notifications\x20about:\x0a','length','Telegram\x20bot\x20polling\x20error:','stopPolling','❌\x20Shop\x20`','\x20marked\x20as\x20unverified\x20due\x20to\x20delivery\x20failure','sk_','🆔\x20Payment\x20ID:\x20`','includes','`\x0a\x0a','📊\x20*Connection\x20Status*\x0a\x0a','🏦\x20Method:\x20`','Payment\x20successfully\x20paid','substring','🔔\x20Notifications\x20are\x20active\x0a\x0a','🔌\x20User\x20','📅\x20Time:\x20','forEach','📛\x20Name:\x20`','statusCode','TELEGRAM_BOT_USERNAME','pk_','errorMessage','chargeback','\x20disconnected\x20from\x20shop\x20','Commands:\x0a','user\x20is\x20deactivated','✅\x20You\x20have\x20been\x20successfully\x20disconnected\x20from\x20shop\x20*'];a54_0x1440=function(){return _0x3fc323;};return a54_0x1440();}(function(_0x4c824d,_0x26d0c5){const _0x3f4ecb=a54_0x5583,_0xacec3b=_0x4c824d();while(!![]){try{const _0xbfc58a=parseInt(_0x3f4ecb(0x1ad))/0x1+-parseInt(_0x3f4ecb(0x22a))/0x2*(parseInt(_0x3f4ecb(0x1e9))/0x3)+parseInt(_0x3f4ecb(0x20f))/0x4*(parseInt(_0x3f4ecb(0x156))/0x5)+parseInt(_0x3f4ecb(0x227))/0x6*(parseInt(_0x3f4ecb(0x1ac))/0x7)+-parseInt(_0x3f4ecb(0x15a))/0x8+parseInt(_0x3f4ecb(0x212))/0x9+parseInt(_0x3f4ecb(0x1ae))/0xa;if(_0xbfc58a===_0x26d0c5)break;else _0xacec3b['push'](_0xacec3b['shift']());}catch(_0x56d837){_0xacec3b['push'](_0xacec3b['shift']());}}}(a54_0x1440,0x284f2));var __importDefault=this&&this[a54_0x57fce0(0x216)]||function(_0x281572){return _0x281572&&_0x281572['__esModule']?_0x281572:{'default':_0x281572};};Object['defineProperty'](exports,a54_0x57fce0(0x21e),{'value':!![]}),exports[a54_0x57fce0(0x189)]=exports[a54_0x57fce0(0x1c7)]=void 0x0;const node_telegram_bot_api_1=__importDefault(require(a54_0x57fce0(0x1ff))),database_1=__importDefault(require(a54_0x57fce0(0x205))),gateway_1=require(a54_0x57fce0(0x1c3));class TelegramBotService{constructor(){const _0x19a764=a54_0x57fce0;this[_0x19a764(0x202)]=null,this['botToken']=process[_0x19a764(0x164)]['TELEGRAM_BOT_TOKEN']||'',this[_0x19a764(0x1d1)]=process[_0x19a764(0x164)][_0x19a764(0x17a)]||'trapay_bot',this['botToken']?this[_0x19a764(0x1fd)]():console['warn'](_0x19a764(0x1f2));}['initializeBot'](){const _0x2f1735=a54_0x57fce0;try{this[_0x2f1735(0x202)]=new node_telegram_bot_api_1[(_0x2f1735(0x1e5))](this['botToken'],{'polling':!![]}),this[_0x2f1735(0x1f1)](),console['log']('✅\x20Telegram\x20bot\x20@'+this[_0x2f1735(0x1d1)]+'\x20initialized\x20successfully');}catch(_0x4a787a){console[_0x2f1735(0x198)]('❌\x20Failed\x20to\x20initialize\x20Telegram\x20bot:',_0x4a787a);}}[a54_0x57fce0(0x1f1)](){const _0x4fb951=a54_0x57fce0;if(!this['bot'])return;this[_0x4fb951(0x202)][_0x4fb951(0x200)](/\/start/,async _0x325bd1=>{const _0x272f4c=_0x4fb951,_0x1d3cee=_0x325bd1[_0x272f4c(0x1b0)]['id'],_0x46f169=_0x325bd1[_0x272f4c(0x223)]?.['id'][_0x272f4c(0x1f6)](),_0x44d885=_0x325bd1[_0x272f4c(0x223)]?.[_0x272f4c(0x185)],_0x56c930=_0x325bd1[_0x272f4c(0x223)]?.[_0x272f4c(0x1e0)],_0x4fd8e0=_0x325bd1['from']?.[_0x272f4c(0x1e7)];if(!_0x46f169)return;try{let _0x18bb04=await database_1[_0x272f4c(0x1e5)][_0x272f4c(0x22b)][_0x272f4c(0x1f7)]({'where':{'telegramId':_0x46f169},'include':{'shop':!![]}});!_0x18bb04?(_0x18bb04=await database_1[_0x272f4c(0x1e5)][_0x272f4c(0x22b)][_0x272f4c(0x20a)]({'data':{'telegramId':_0x46f169,'username':_0x44d885,'firstName':_0x56c930,'lastName':_0x4fd8e0,'isVerified':![],'shopId':null},'include':{'shop':!![]}}),console[_0x272f4c(0x1b3)](_0x272f4c(0x221)+_0x46f169+_0x272f4c(0x18e)+_0x44d885+')')):_0x18bb04=await database_1[_0x272f4c(0x1e5)][_0x272f4c(0x22b)][_0x272f4c(0x1f5)]({'where':{'telegramId':_0x46f169},'data':{'username':_0x44d885,'firstName':_0x56c930,'lastName':_0x4fd8e0},'include':{'shop':!![]}}),_0x18bb04[_0x272f4c(0x215)]&&_0x18bb04[_0x272f4c(0x1df)]&&_0x18bb04[_0x272f4c(0x160)]?await this[_0x272f4c(0x202)]?.['sendMessage'](_0x1d3cee,_0x272f4c(0x207)+(_0x272f4c(0x1c6)+_0x18bb04[_0x272f4c(0x160)][_0x272f4c(0x19d)]+'*\x0a')+(_0x272f4c(0x1dc)+_0x18bb04['shop']['username']+_0x272f4c(0x16f))+_0x272f4c(0x152)+_0x272f4c(0x18f)+_0x272f4c(0x201)+_0x272f4c(0x218)+_0x272f4c(0x17f)+_0x272f4c(0x1f4)+'/disconnect\x20-\x20disconnect\x20from\x20notifications',{'parse_mode':_0x272f4c(0x1e4)}):(_0x18bb04[_0x272f4c(0x1df)]&&!_0x18bb04[_0x272f4c(0x215)]&&(await database_1[_0x272f4c(0x1e5)]['telegramUser'][_0x272f4c(0x1f5)]({'where':{'telegramId':_0x46f169},'data':{'shopId':null,'isVerified':![]}}),console['log']('🔄\x20Reset\x20incomplete\x20verification\x20for\x20user\x20'+_0x46f169)),await this[_0x272f4c(0x202)]?.[_0x272f4c(0x220)](_0x1d3cee,_0x272f4c(0x1a5)+'To\x20receive\x20payment\x20notifications,\x20send\x20your\x20credentials\x20in\x20one\x20line:\x0a\x0a'+_0x272f4c(0x20e)+'Example:\x0a'+_0x272f4c(0x1fc)+_0x272f4c(0x1cd),{'parse_mode':'Markdown'}));}catch(_0x1545c1){console[_0x272f4c(0x198)](_0x272f4c(0x19e),_0x1545c1),await this[_0x272f4c(0x202)]?.[_0x272f4c(0x220)](_0x1d3cee,'❌\x20An\x20error\x20occurred.\x20Please\x20try\x20again\x20later.');}}),this['bot'][_0x4fb951(0x200)](/\/disconnect/,async _0x4fb7e2=>{const _0xdfa455=_0x4fb951,_0x1e7bf2=_0x4fb7e2[_0xdfa455(0x1b0)]['id'],_0x1bf1c5=_0x4fb7e2[_0xdfa455(0x223)]?.['id'][_0xdfa455(0x1f6)]();if(!_0x1bf1c5)return;try{const _0x456b75=await database_1[_0xdfa455(0x1e5)]['telegramUser'][_0xdfa455(0x1f7)]({'where':{'telegramId':_0x1bf1c5},'include':{'shop':!![]}});if(!_0x456b75||!_0x456b75['isVerified']||!_0x456b75[_0xdfa455(0x1df)]){await this[_0xdfa455(0x202)]?.[_0xdfa455(0x220)](_0x1e7bf2,_0xdfa455(0x222));return;}const _0x3a06a2=_0x456b75[_0xdfa455(0x160)]?.[_0xdfa455(0x19d)]||_0xdfa455(0x1e3);await database_1[_0xdfa455(0x1e5)][_0xdfa455(0x22b)][_0xdfa455(0x1f5)]({'where':{'telegramId':_0x1bf1c5},'data':{'shopId':null,'isVerified':![]}}),console[_0xdfa455(0x1b3)](_0xdfa455(0x175)+_0x1bf1c5+_0xdfa455(0x17e)+_0x456b75['shopId']),await this[_0xdfa455(0x202)]?.['sendMessage'](_0x1e7bf2,_0xdfa455(0x181)+_0x3a06a2+_0xdfa455(0x1a3)+_0xdfa455(0x217),{'parse_mode':_0xdfa455(0x1e4)});}catch(_0x504c48){console['error'](_0xdfa455(0x231),_0x504c48),await this[_0xdfa455(0x202)]?.[_0xdfa455(0x220)](_0x1e7bf2,_0xdfa455(0x1d2));}}),this[_0x4fb951(0x202)][_0x4fb951(0x200)](/\/status/,async _0x261323=>{const _0x48f003=_0x4fb951,_0x389bdf=_0x261323[_0x48f003(0x1b0)]['id'],_0x1f92d9=_0x261323['from']?.['id'][_0x48f003(0x1f6)]();if(!_0x1f92d9)return;try{const _0x3d7695=await database_1[_0x48f003(0x1e5)][_0x48f003(0x22b)]['findUnique']({'where':{'telegramId':_0x1f92d9},'include':{'shop':!![]}});if(!_0x3d7695){await this[_0x48f003(0x202)]?.[_0x48f003(0x220)](_0x389bdf,_0x48f003(0x1c9)+_0x48f003(0x15c));return;}if(!_0x3d7695[_0x48f003(0x215)]||!_0x3d7695[_0x48f003(0x1df)]||!_0x3d7695[_0x48f003(0x160)]){await this[_0x48f003(0x202)]?.[_0x48f003(0x220)](_0x389bdf,'❌\x20You\x20are\x20not\x20connected\x20to\x20a\x20shop.\x0a\x0a'+_0x48f003(0x1ed));return;}await this['bot']?.['sendMessage'](_0x389bdf,_0x48f003(0x170)+(_0x48f003(0x233)+_0x3d7695[_0x48f003(0x160)][_0x48f003(0x19d)]+'*\x0a')+(_0x48f003(0x1a1)+_0x3d7695[_0x48f003(0x160)]['username']+'`\x0a')+('📅\x20Connection\x20date:\x20'+_0x3d7695['updatedAt'][_0x48f003(0x18b)](_0x48f003(0x1b1))+'\x0a\x0a')+_0x48f003(0x174)+'Commands:\x0a'+_0x48f003(0x1db),{'parse_mode':_0x48f003(0x1e4)});}catch(_0x108853){console['error'](_0x48f003(0x1b7),_0x108853),await this[_0x48f003(0x202)]?.['sendMessage'](_0x389bdf,_0x48f003(0x1d2));}}),this[_0x4fb951(0x202)][_0x4fb951(0x200)](/\/debug/,async _0x54cca1=>{const _0xf628b2=_0x4fb951,_0x2ad84b=_0x54cca1[_0xf628b2(0x1b0)]['id'],_0x2600fd=_0x54cca1['from']?.['id'][_0xf628b2(0x1f6)]();if(!_0x2600fd)return;try{const _0xe5d04f=await database_1[_0xf628b2(0x1e5)][_0xf628b2(0x160)]['findMany']({'select':{'id':!![],'name':!![],'username':!![],'status':!![],'publicKey':!![]},'take':0xa});let _0xccc081=_0xf628b2(0x1bf);_0xccc081+=_0xf628b2(0x15f)+_0x2600fd+'`\x0a\x0a',_0xccc081+=_0xf628b2(0x21a),_0xe5d04f['forEach']((_0x3ba94a,_0x12c65c)=>{const _0x5b1e8a=_0xf628b2;_0xccc081+=_0x12c65c+0x1+'.\x20*'+_0x3ba94a[_0x5b1e8a(0x19d)]+'*\x0a',_0xccc081+=_0x5b1e8a(0x1b4)+_0x3ba94a[_0x5b1e8a(0x185)]+'`\x0a',_0xccc081+='\x20\x20\x20Status:\x20'+_0x3ba94a[_0x5b1e8a(0x204)]+'\x0a',_0xccc081+='\x20\x20\x20Public\x20Key:\x20`'+_0x3ba94a[_0x5b1e8a(0x208)][_0x5b1e8a(0x173)](0x0,0xf)+_0x5b1e8a(0x21c);}),await this[_0xf628b2(0x202)]?.[_0xf628b2(0x220)](_0x2ad84b,_0xccc081,{'parse_mode':_0xf628b2(0x1e4)});}catch(_0x46f76b){console['error'](_0xf628b2(0x1a6),_0x46f76b),await this['bot']?.['sendMessage'](_0x2ad84b,'❌\x20Error\x20getting\x20debug\x20information.');}}),this[_0x4fb951(0x202)]['on'](_0x4fb951(0x153),async _0x48ab70=>{const _0x14e821=_0x4fb951;if(_0x48ab70[_0x14e821(0x22e)]?.[_0x14e821(0x1cc)]('/'))return;const _0x8f35e7=_0x48ab70['chat']['id'],_0x185bc5=_0x48ab70[_0x14e821(0x223)]?.['id'][_0x14e821(0x1f6)](),_0x11c3c8=_0x48ab70['text']?.[_0x14e821(0x194)]();if(!_0x185bc5||!_0x11c3c8)return;try{const _0x159dcf=await database_1['default']['telegramUser'][_0x14e821(0x1f7)]({'where':{'telegramId':_0x185bc5},'include':{'shop':!![]}});if(!_0x159dcf){await this[_0x14e821(0x202)]?.[_0x14e821(0x220)](_0x8f35e7,_0x14e821(0x1a8));return;}if(_0x159dcf[_0x14e821(0x215)]&&_0x159dcf[_0x14e821(0x1df)]&&_0x159dcf[_0x14e821(0x160)]){await this[_0x14e821(0x202)]?.[_0x14e821(0x220)](_0x8f35e7,'✅\x20You\x20are\x20already\x20connected\x20to\x20shop\x20*'+_0x159dcf['shop'][_0x14e821(0x19d)]+_0x14e821(0x1a3)+_0x14e821(0x18d),{'parse_mode':_0x14e821(0x1e4)});return;}const _0x146c05=_0x11c3c8[_0x14e821(0x18c)](/\s+/);if(_0x146c05[_0x14e821(0x167)]!==0x2){await this[_0x14e821(0x202)]?.[_0x14e821(0x220)](_0x8f35e7,_0x14e821(0x234)+_0x14e821(0x20e)+_0x14e821(0x210)+'`appple\x20pk_aa6450d3f57afbefbb0f3f5be5ce6cca13037536afc5ccf14c81a6cbc7a07de5`\x0a\x0a'+('You\x20sent\x20'+_0x146c05[_0x14e821(0x167)]+_0x14e821(0x1eb)+_0x146c05[_0x14e821(0x183)](_0x1e2598=>'`'+_0x1e2598+'`')[_0x14e821(0x1d4)](',\x20')),{'parse_mode':_0x14e821(0x1e4)});return;}const [_0x216dfc,_0x472d61]=_0x146c05;console['log'](_0x14e821(0x206)+_0x185bc5+_0x14e821(0x199)+_0x216dfc+_0x14e821(0x186)+_0x472d61['substring'](0x0,0xa)+'...\x22'),await this[_0x14e821(0x1d9)](_0x8f35e7,_0x185bc5,_0x216dfc,_0x472d61);}catch(_0x474218){console[_0x14e821(0x198)](_0x14e821(0x1ec),_0x474218),await this[_0x14e821(0x202)]?.['sendMessage'](_0x8f35e7,_0x14e821(0x1d2));}}),this[_0x4fb951(0x202)]['on'](_0x4fb951(0x198),_0x45db79=>{const _0x246d27=_0x4fb951;console[_0x246d27(0x198)](_0x246d27(0x1d3),_0x45db79);}),this[_0x4fb951(0x202)]['on'](_0x4fb951(0x1a7),_0x1df7d7=>{const _0x43f28e=_0x4fb951;console[_0x43f28e(0x198)](_0x43f28e(0x168),_0x1df7d7);});}async[a54_0x57fce0(0x1d9)](_0x4b2d0e,_0x5cc4db,_0x36e7e1,_0x448b1b){const _0x1ba01c=a54_0x57fce0;try{console[_0x1ba01c(0x1b3)](_0x1ba01c(0x206)+_0x5cc4db+':\x20username=\x22'+_0x36e7e1+'\x22,\x20apiKey=\x22'+_0x448b1b['substring'](0x0,0xa)+'...\x22');if(!_0x36e7e1||_0x36e7e1['length']<0x3||_0x36e7e1['length']>0x32||!/^[a-zA-Z0-9_]+$/[_0x1ba01c(0x213)](_0x36e7e1)){await this[_0x1ba01c(0x202)]?.[_0x1ba01c(0x220)](_0x4b2d0e,_0x1ba01c(0x225)+_0x36e7e1+'`\x0a\x0a'+_0x1ba01c(0x1ee),{'parse_mode':'Markdown'});return;}if(!_0x448b1b||!_0x448b1b[_0x1ba01c(0x1cc)](_0x1ba01c(0x17b))&&!_0x448b1b['startsWith'](_0x1ba01c(0x16c))){await this['bot']?.[_0x1ba01c(0x220)](_0x4b2d0e,_0x1ba01c(0x20c)+_0x1ba01c(0x1c8),{'parse_mode':_0x1ba01c(0x1e4)});return;}const _0x5124f1=await database_1['default'][_0x1ba01c(0x160)][_0x1ba01c(0x1f7)]({'where':{'username':_0x36e7e1},'select':{'id':!![],'name':!![],'username':!![],'status':!![],'publicKey':!![],'secretKey':!![]}});if(!_0x5124f1){const _0x21286b=await database_1['default'][_0x1ba01c(0x160)][_0x1ba01c(0x191)]({'select':{'username':!![],'name':!![]},'take':0x5});let _0x975e5e=_0x1ba01c(0x1b6)+_0x36e7e1+'`\x20not\x20found.\x0a\x0a';_0x21286b[_0x1ba01c(0x167)]>0x0?(_0x975e5e+=_0x1ba01c(0x22c),_0x21286b[_0x1ba01c(0x177)](_0x30a82b=>{const _0x206f7f=_0x1ba01c;_0x975e5e+=_0x206f7f(0x1cb)+_0x30a82b[_0x206f7f(0x185)]+'`\x20('+_0x30a82b[_0x206f7f(0x19d)]+')\x0a';}),_0x975e5e+='\x0aCheck\x20spelling\x20and\x20try\x20again.'):_0x975e5e+=_0x1ba01c(0x1b9);await this[_0x1ba01c(0x202)]?.[_0x1ba01c(0x220)](_0x4b2d0e,_0x975e5e,{'parse_mode':'Markdown'});return;}if(_0x5124f1[_0x1ba01c(0x204)]!==_0x1ba01c(0x1ba)){await this['bot']?.[_0x1ba01c(0x220)](_0x4b2d0e,_0x1ba01c(0x16a)+_0x36e7e1+'`\x20is\x20inactive.\x0a\x0a'+_0x1ba01c(0x1d5),{'parse_mode':_0x1ba01c(0x1e4)});return;}if(_0x5124f1[_0x1ba01c(0x208)]!==_0x448b1b&&_0x5124f1[_0x1ba01c(0x18a)]!==_0x448b1b){await this[_0x1ba01c(0x202)]?.[_0x1ba01c(0x220)](_0x4b2d0e,_0x1ba01c(0x1a0)+_0x36e7e1+_0x1ba01c(0x1bc)+'Check\x20the\x20key\x20and\x20try\x20again.\x0a\x0a'+'Expected\x20key\x20format:\x20`pk_...`\x20or\x20`sk_...`',{'parse_mode':_0x1ba01c(0x1e4)});return;}const _0x54710a=await database_1[_0x1ba01c(0x1e5)][_0x1ba01c(0x22b)]['findFirst']({'where':{'shopId':_0x5124f1['id'],'isVerified':!![],'telegramId':{'not':_0x5cc4db}}});if(_0x54710a){await this[_0x1ba01c(0x202)]?.[_0x1ba01c(0x220)](_0x4b2d0e,_0x1ba01c(0x1d8)+_0x36e7e1+_0x1ba01c(0x1bc)+_0x1ba01c(0x159),{'parse_mode':_0x1ba01c(0x1e4)});return;}await database_1[_0x1ba01c(0x1e5)][_0x1ba01c(0x22b)][_0x1ba01c(0x1f5)]({'where':{'telegramId':_0x5cc4db},'data':{'shopId':_0x5124f1['id'],'isVerified':!![]}}),await this[_0x1ba01c(0x202)]?.[_0x1ba01c(0x220)](_0x4b2d0e,_0x1ba01c(0x1ca)+_0x1ba01c(0x1c4)+(_0x1ba01c(0x1c1)+_0x5124f1['name']+'*\x0a')+(_0x1ba01c(0x1a1)+_0x5124f1['username']+'`\x0a\x0a')+_0x1ba01c(0x166)+_0x1ba01c(0x18f)+_0x1ba01c(0x201)+_0x1ba01c(0x192)+_0x1ba01c(0x1d0)+_0x1ba01c(0x17f)+_0x1ba01c(0x1f4)+'/disconnect\x20-\x20disconnect\x20from\x20notifications',{'parse_mode':_0x1ba01c(0x1e4)}),console['log'](_0x1ba01c(0x1b5)+_0x5cc4db+'\x20verified\x20for\x20shop\x20'+_0x5124f1[_0x1ba01c(0x185)]+_0x1ba01c(0x187));}catch(_0x237bfa){console['error'](_0x1ba01c(0x1b2),_0x237bfa),await this[_0x1ba01c(0x202)]?.['sendMessage'](_0x4b2d0e,_0x1ba01c(0x195));}}async[a54_0x57fce0(0x1dd)](_0x3a4663,_0x8848bb,_0x29ebb6){const _0x4af95f=a54_0x57fce0;if(!this[_0x4af95f(0x202)]){console[_0x4af95f(0x1f9)](_0x4af95f(0x1e1));return;}try{const _0x2fbbfc=await database_1[_0x4af95f(0x1e5)][_0x4af95f(0x22b)][_0x4af95f(0x191)]({'where':{'shopId':_0x3a4663,'isVerified':!![]}});if(_0x2fbbfc['length']===0x0){console['log']('No\x20verified\x20Telegram\x20users\x20found\x20for\x20shop\x20'+_0x3a4663);return;}const _0x171711=_0x2fbbfc[_0x4af95f(0x183)](async _0x1f7fae=>{const _0x2514af=_0x4af95f;try{await this['bot']?.['sendMessage'](_0x1f7fae[_0x2514af(0x20b)],_0x8848bb,_0x29ebb6),console['log']('✅\x20Notification\x20sent\x20to\x20Telegram\x20user\x20'+_0x1f7fae['telegramId']);}catch(_0x500070){console['error'](_0x2514af(0x19b)+_0x1f7fae[_0x2514af(0x20b)]+':',_0x500070),_0x500070 instanceof Error&&(_0x500070[_0x2514af(0x153)][_0x2514af(0x16e)]('blocked')||_0x500070[_0x2514af(0x153)][_0x2514af(0x16e)](_0x2514af(0x193))||_0x500070['message'][_0x2514af(0x16e)](_0x2514af(0x180)))&&(await database_1[_0x2514af(0x1e5)]['telegramUser'][_0x2514af(0x1f5)]({'where':{'id':_0x1f7fae['id']},'data':{'isVerified':![]}}),console[_0x2514af(0x1b3)](_0x2514af(0x1d6)+_0x1f7fae[_0x2514af(0x20b)]+_0x2514af(0x16b)));}});await Promise[_0x4af95f(0x22d)](_0x171711);}catch(_0x374ab2){console['error'](_0x4af95f(0x219),_0x374ab2);}}async[a54_0x57fce0(0x1fa)](_0x245c93,_0x20aad7,_0x5e9ddf){const _0x47556d=a54_0x57fce0,_0x2cffd5={'created':'🆕','paid':'✅','failed':'❌','expired':'⏰','refund':'🔄','chargeback':'⚠️','processing':'⚙️'},_0x4ddcaf={'created':_0x47556d(0x1bd),'paid':_0x47556d(0x172),'failed':_0x47556d(0x1be),'expired':_0x47556d(0x1c5),'refund':'Payment\x20refund','chargeback':_0x47556d(0x1a9),'processing':_0x47556d(0x15e)},_0x2a5501=_0x2cffd5[_0x5e9ddf],_0x1e71bc=_0x4ddcaf[_0x5e9ddf],_0x1c5e76=(0x0,gateway_1['getGatewayDisplayNameForTelegram'])(_0x20aad7[_0x47556d(0x1f8)]);console[_0x47556d(0x1b3)]('📱\x20Telegram\x20notification:\x20gateway\x20\x22'+_0x20aad7[_0x47556d(0x1f8)]+'\x22\x20->\x20display\x20\x22'+_0x1c5e76+'\x22');let _0x88c4be=_0x2a5501+'\x20*'+_0x1e71bc+_0x47556d(0x1d7)+(_0x47556d(0x1aa)+_0x20aad7[_0x47556d(0x1c0)]+'\x20'+_0x20aad7[_0x47556d(0x155)]+'*\x0a')+(_0x47556d(0x21f)+(_0x20aad7[_0x47556d(0x1ea)]||_0x20aad7['id'])+'`\x0a')+(_0x47556d(0x16d)+_0x20aad7['id']+'`\x0a')+(_0x47556d(0x162)+_0x1c5e76+'`\x0a')+(_0x47556d(0x1bb)+new Date(_0x20aad7[_0x47556d(0x224)])['toLocaleString']('en-US')+'\x0a');(_0x20aad7[_0x47556d(0x161)]||_0x20aad7[_0x47556d(0x158)])&&(_0x88c4be+=_0x47556d(0x1b8),_0x20aad7[_0x47556d(0x161)]&&(_0x88c4be+=_0x47556d(0x178)+_0x20aad7[_0x47556d(0x161)]+'`\x0a'),_0x20aad7[_0x47556d(0x158)]&&(_0x88c4be+=_0x47556d(0x1fb)+_0x20aad7['customerEmail']+'`\x0a')),_0x5e9ddf===_0x47556d(0x17d)&&_0x20aad7[_0x47556d(0x1e2)]&&(_0x88c4be+='💸\x20Penalty\x20amount:\x20*'+_0x20aad7[_0x47556d(0x1e2)]+_0x47556d(0x1ce)),_0x5e9ddf===_0x47556d(0x1da)&&(_0x88c4be+=_0x47556d(0x21d)),_0x20aad7[_0x47556d(0x19c)]&&(_0x88c4be+=_0x47556d(0x1fe)+_0x20aad7[_0x47556d(0x19c)]+'\x0a'),await this[_0x47556d(0x1dd)](_0x245c93,_0x88c4be,{'parse_mode':'Markdown'});}async['sendPayoutNotification'](_0x5837c9,_0x3f9288,_0x5d4d3a){const _0x2896a1=a54_0x57fce0,_0x59e2f9={'created':'📤','completed':'✅','rejected':'❌'},_0x24f788={'created':_0x2896a1(0x1c2),'completed':_0x2896a1(0x214),'rejected':_0x2896a1(0x1e8)},_0x3ad07d=_0x59e2f9[_0x5d4d3a],_0xf2f6d1=_0x24f788[_0x5d4d3a],_0x18c1e5=_0x3ad07d+'\x20*'+_0xf2f6d1+_0x2896a1(0x1d7)+(_0x2896a1(0x197)+_0x3f9288[_0x2896a1(0x1c0)]+_0x2896a1(0x15d))+(_0x2896a1(0x171)+_0x3f9288[_0x2896a1(0x182)]+'`\x0a')+(_0x2896a1(0x157)+_0x3f9288['id']+'`\x0a')+(_0x2896a1(0x1bb)+new Date(_0x3f9288[_0x2896a1(0x224)])[_0x2896a1(0x154)](_0x2896a1(0x1b1))+'\x0a')+(_0x3f9288[_0x2896a1(0x1ab)]?_0x2896a1(0x1a4)+_0x3f9288[_0x2896a1(0x1ab)]+'`':'');await this[_0x2896a1(0x1dd)](_0x5837c9,_0x18c1e5,{'parse_mode':'Markdown'});}async[a54_0x57fce0(0x209)](_0x17b8b0,_0x37aa81){const _0x43d22a=a54_0x57fce0;try{const _0x3d1637=await database_1['default'][_0x43d22a(0x1af)][_0x43d22a(0x1f7)]({'where':{'shopId':_0x17b8b0},'select':{'notificationLogin':!![]}});if(!_0x3d1637?.[_0x43d22a(0x226)]){console[_0x43d22a(0x1b3)](_0x43d22a(0x1de)+_0x17b8b0);return;}const _0x271100=_0x37aa81[_0x43d22a(0x20d)]?'🔐':'🚨',_0x750007=_0x37aa81[_0x43d22a(0x20d)]?_0x43d22a(0x229):_0x43d22a(0x203);let _0x39076f=_0x271100+'\x20*'+_0x750007+'*\x0a\x0a'+(_0x43d22a(0x1a1)+_0x37aa81[_0x43d22a(0x185)]+'`\x0a')+('📅\x20Time:\x20'+_0x37aa81[_0x43d22a(0x21b)][_0x43d22a(0x154)]('en-US')+'\x0a');_0x37aa81[_0x43d22a(0x15b)]&&(_0x39076f+=_0x43d22a(0x1f0)+_0x37aa81[_0x43d22a(0x15b)]+'`\x0a');if(_0x37aa81['userAgent']){const _0x134407=_0x37aa81[_0x43d22a(0x1ef)][_0x43d22a(0x167)]>0x32?_0x37aa81['userAgent'][_0x43d22a(0x173)](0x0,0x32)+_0x43d22a(0x1a2):_0x37aa81[_0x43d22a(0x1ef)];_0x39076f+=_0x43d22a(0x1f3)+_0x134407+'`\x0a';}!_0x37aa81['success']&&(_0x39076f+=_0x43d22a(0x19f)),await this[_0x43d22a(0x1dd)](_0x17b8b0,_0x39076f,{'parse_mode':_0x43d22a(0x1e4)}),console['log']('✅\x20Login\x20notification\x20sent\x20for\x20shop\x20'+_0x17b8b0+':\x20'+(_0x37aa81[_0x43d22a(0x20d)]?_0x43d22a(0x20d):'failed'));}catch(_0x533797){console[_0x43d22a(0x198)](_0x43d22a(0x188),_0x533797);}}async[a54_0x57fce0(0x228)](_0x19e3a2,_0x371f43){const _0x202420=a54_0x57fce0;try{const _0x14702a=await database_1[_0x202420(0x1e5)][_0x202420(0x1af)]['findUnique']({'where':{'shopId':_0x19e3a2},'select':{'notificationApiError':!![]}});if(!_0x14702a?.[_0x202420(0x1cf)]){console[_0x202420(0x1b3)](_0x202420(0x230)+_0x19e3a2);return;}let _0x51367f=_0x202420(0x165)+(_0x202420(0x22f)+_0x371f43['method']+'\x20'+_0x371f43[_0x202420(0x190)]+'`\x0a')+(_0x202420(0x176)+_0x371f43[_0x202420(0x21b)][_0x202420(0x154)]('en-US')+'\x0a');_0x371f43[_0x202420(0x179)]&&(_0x51367f+=_0x202420(0x184)+_0x371f43['statusCode']+'`\x0a'),_0x51367f+='❌\x20Error:\x20`'+_0x371f43[_0x202420(0x17c)]+'`\x0a',_0x371f43[_0x202420(0x232)]&&(_0x51367f+=_0x202420(0x1e6)+_0x371f43[_0x202420(0x232)]+'`\x0a'),_0x51367f+='\x0a💡\x20Check\x20your\x20request\x20or\x20contact\x20support.',await this[_0x202420(0x1dd)](_0x19e3a2,_0x51367f,{'parse_mode':_0x202420(0x1e4)}),console[_0x202420(0x1b3)]('✅\x20API\x20error\x20notification\x20sent\x20for\x20shop\x20'+_0x19e3a2+':\x20'+_0x371f43[_0x202420(0x190)]);}catch(_0x3f1c1a){console['error'](_0x202420(0x196),_0x3f1c1a);}}async['sendCustomNotification'](_0x541ad5,_0x3f13ac,_0x406606){const _0x3de592=a54_0x57fce0;let _0x3ecd4c=_0x3de592(0x211)+_0x3f13ac+'*\x0a\x0a';for(const [_0x16cee0,_0x29ceb3]of Object['entries'](_0x406606)){_0x29ceb3!==null&&_0x29ceb3!==undefined&&(_0x3ecd4c+=_0x16cee0+_0x3de592(0x163)+_0x29ceb3+'`\x0a');}await this[_0x3de592(0x1dd)](_0x541ad5,_0x3ecd4c,{'parse_mode':_0x3de592(0x1e4)});}[a54_0x57fce0(0x19a)](){const _0x306f6d=a54_0x57fce0;return{'isActive':!!this[_0x306f6d(0x202)],'username':this['botUsername']};}['stopBot'](){const _0x4f4a88=a54_0x57fce0;this['bot']&&(this[_0x4f4a88(0x202)][_0x4f4a88(0x169)](),this[_0x4f4a88(0x202)]=null,console['log']('🛑\x20Telegram\x20bot\x20stopped'));}}exports['TelegramBotService']=TelegramBotService,exports[a54_0x57fce0(0x189)]=new TelegramBotService();