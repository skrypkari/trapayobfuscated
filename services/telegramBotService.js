'use strict';const a54_0x5ae8a3=a54_0x32f8;(function(_0x2d4708,_0x38aacb){const _0x4c1661=a54_0x32f8,_0x3118fd=_0x2d4708();while(!![]){try{const _0x4fb31f=-parseInt(_0x4c1661(0x1c7))/0x1+-parseInt(_0x4c1661(0x15c))/0x2+-parseInt(_0x4c1661(0x20b))/0x3+-parseInt(_0x4c1661(0x204))/0x4*(-parseInt(_0x4c1661(0x1a3))/0x5)+-parseInt(_0x4c1661(0x213))/0x6+parseInt(_0x4c1661(0x185))/0x7+parseInt(_0x4c1661(0x1f4))/0x8*(parseInt(_0x4c1661(0x18e))/0x9);if(_0x4fb31f===_0x38aacb)break;else _0x3118fd['push'](_0x3118fd['shift']());}catch(_0x2b8a4b){_0x3118fd['push'](_0x3118fd['shift']());}}}(a54_0x50ed,0x34761));var __importDefault=this&&this[a54_0x5ae8a3(0x201)]||function(_0x46e197){const _0x13da68=a54_0x5ae8a3;return _0x46e197&&_0x46e197[_0x13da68(0x1a9)]?_0x46e197:{'default':_0x46e197};};Object['defineProperty'](exports,a54_0x5ae8a3(0x1a9),{'value':!![]}),exports[a54_0x5ae8a3(0x1b5)]=exports[a54_0x5ae8a3(0x15f)]=void 0x0;function a54_0x50ed(){const _0x10464e=['en-US','username','🤖\x20Welcome\x20to\x20TRAPAY\x20notification\x20system!\x0a\x0a','🔗\x20Endpoint:\x20`','orderId','last_name','💸\x20Penalty\x20amount:\x20*','findFirst','errorMessage','❌\x20You\x20are\x20not\x20registered\x20in\x20the\x20system.\x0a\x0a','update','❌\x20Shop\x20with\x20username\x20`','🔄\x20Processing\x20single-line\x20verification\x20for\x20user\x20','user\x20is\x20deactivated','onText','\x20USDT*\x0a','❌\x20Failed\x20to\x20initialize\x20Telegram\x20bot:','...`\x0a\x0a','timestamp','📱\x20Login\x20notifications\x20disabled\x20for\x20shop\x20','node-telegram-bot-api','.\x20*','📱\x20Telegram\x20notification:\x20gateway\x20\x22','userAgent','25624guqYBs','\x20(@','📱\x20API\x20error\x20notifications\x20disabled\x20for\x20shop\x20','\x22\x20->\x20display\x20\x22','TELEGRAM_BOT_TOKEN','ipAddress','🔗\x20TXID:\x20`','stopPolling','User\x20','✅\x20You\x20are\x20already\x20connected\x20to\x20shop\x20*','*\x0a\x0a','❌\x20Failed\x20to\x20send\x20notification\x20to\x20Telegram\x20user\x20','sk_','__importDefault','❌\x20Invalid\x20username\x20format:\x20`','adminNotes','440SiMIEZ',':\x20username=\x22','Error\x20handling\x20/start\x20command:','✅\x20You\x20have\x20been\x20successfully\x20connected\x20to\x20the\x20notification\x20system!\x0a\x0a','...','Example:\x0a','gateway','496635IBOgHi','✅\x20Notification\x20sent\x20to\x20Telegram\x20user\x20','create','sendShopNotification','Username\x20must\x20contain\x20only\x20letters,\x20numbers\x20and\x20underscore\x20(3-50\x20characters).','substring','❌\x20An\x20error\x20occurred\x20while\x20verifying\x20data.','🔄\x20Reset\x20incomplete\x20verification\x20for\x20user\x20','1210686YXobQh','•\x20New\x20payments\x0a','\x0a⚠️\x20If\x20this\x20wasn\x27t\x20you,\x20change\x20your\x20password\x20immediately!','sendMessage','\x20\x20\x20Public\x20Key:\x20`','sendPayoutNotification','status','statusCode','•\x20Payouts\x0a','\x0a💡\x20Check\x20your\x20request\x20or\x20contact\x20support.','initializeBot','📱\x20Shop:\x20*','map','Telegram\x20bot\x20polling\x20error:','processing','trapay_bot','🌐\x20IP\x20address:\x20`','To\x20reconnect,\x20use\x20the\x20/start\x20command','❌\x20You\x20are\x20not\x20connected\x20to\x20a\x20shop.\x0a\x0a','../config/database','text','currency','API\x20key\x20must\x20start\x20with\x20`pk\x5c_`\x20or\x20`sk\x5c_`.','Telegram\x20bot\x20not\x20initialized,\x20cannot\x20send\x20notification','📱\x20Your\x20Telegram\x20ID:\x20`','👤\x20Username:\x20`','✅\x20Telegram\x20bot\x20@','✅\x20Login\x20notification\x20sent\x20for\x20shop\x20','Available\x20usernames:\x0a','../types/gateway','`\x20(','/disconnect\x20-\x20disconnect\x20from\x20notifications','\x20disconnected\x20from\x20shop\x20','🔔\x20*','762656tMlZao','📝\x20Notes:\x20','Expected\x20key\x20format:\x20`pk_...`\x20or\x20`sk_...`','TelegramBotService','method','name','❌\x20Invalid\x20format.\x20Please\x20send\x20exactly\x202\x20parts\x20separated\x20by\x20space:\x0a\x0a','TELEGRAM_BOT_USERNAME','chargebackAmount','chat\x20not\x20found','•\x20`','Error\x20sending\x20shop\x20notification:','\x20via\x20single-line\x20input','join','Payment\x20failed','setupBotHandlers','`.\x0a\x0a','📅\x20Time:\x20','❌\x20You\x20are\x20not\x20connected\x20to\x20the\x20notification\x20system.','•\x20Payouts\x0a\x0a','⏳\x20The\x20payment\x20is\x20currently\x20being\x20processed\x20by\x20the\x20gateway.\x0a','warn','botUsername','amount','No\x20verified\x20Telegram\x20users\x20found\x20for\x20shop\x20','Payout\x20rejected','🔔\x20You\x20will\x20now\x20receive\x20notifications\x20about:\x0a','ACTIVE','bot','/status\x20-\x20check\x20connection\x20status\x0a','New\x20payout\x20created','customerName','`\x0a\x0a','findMany','•\x20Payment\x20status\x20changes\x0a','❌\x20An\x20error\x20occurred.\x20Please\x20try\x20again\x20later.','💸\x20Amount:\x20*','txid','shopSettings','endpoint','Check\x20the\x20key\x20and\x20try\x20again.\x0a\x0a','2975917wDQTWc','Use\x20/status\x20to\x20check\x20status\x20or\x20/disconnect\x20to\x20disconnect.','\x20\x20\x20Username:\x20`','error','handleSingleLineVerification','Error\x20handling\x20/disconnect\x20command:','secretKey','blocked','polling_error','1980fxUbyD','Payment\x20expired','\x22,\x20apiKey=\x22','forEach','Payout\x20completed','...\x22','telegramId','sendApiErrorNotification','❗️\x20Make\x20sure\x20to\x20separate\x20username\x20and\x20API\x20key\x20with\x20a\x20space!','telegramUser','includes','success','📅\x20Date:\x20','*.\x0a\x0a','entries','🔍\x20*Debug\x20Information*\x0a\x0a','🔌\x20User\x20','startsWith','🎉\x20*Congratulations!*\x0a\x0a','botToken','chat','5685iJKCFr','📛\x20Name:\x20`','📝\x20Format:\x20`username\x20api_key`\x0a\x0a','`\x20not\x20found.\x0a\x0a','requestId','🔔\x20You\x20receive\x20notifications\x20about:\x0a','__esModule','TELEGRAM_BOT_TOKEN\x20not\x20found\x20in\x20environment\x20variables','❌\x20API\x20key\x20does\x20not\x20match\x20shop\x20`','log','toLocaleString','default','toString','Failed\x20login\x20attempt','shopId','updatedAt','length','Failed\x20to\x20send\x20API\x20error\x20notification:','telegramBotService','findUnique','notificationLogin','`appple\x20pk_aa6450d3f57afbefbb0f3f5be5ce6cca13037536afc5ccf14c81a6cbc7a07de5`\x0a\x0a','customerEmail','❌\x20Error\x20getting\x20debug\x20information.','✅\x20Telegram\x20user\x20','env','New\x20payment\x20created','message','Markdown','pk_','•\x20Important\x20events\x0a\x0a','❌\x20Another\x20Telegram\x20account\x20is\x20already\x20connected\x20to\x20shop\x20`','isVerified','`\x20is\x20inactive.\x0a\x0a',':\x20`','sendCustomNotification','291326bPEvQx','toLocaleDateString','🆔\x20Payout\x20ID:\x20`','❌\x20Invalid\x20API\x20key\x20format.\x0a\x0a','✅\x20Welcome\x20back!\x0a\x0a','You\x20are\x20already\x20connected\x20to\x20shop:\x20*','Failed\x20to\x20send\x20login\x20notification:','🛑\x20Telegram\x20bot\x20stopped','\x0aCheck\x20spelling\x20and\x20try\x20again.','📊\x20Error\x20code:\x20`','from','shop','Error\x20handling\x20/debug\x20command:','publicKey','Error\x20handling\x20message:','getBotInfo','Use\x20/start\x20to\x20connect.','Payment\x20successfully\x20paid','✅\x20API\x20error\x20notification\x20sent\x20for\x20shop\x20','Commands:\x0a','Disconnect\x20the\x20previous\x20account\x20first\x20or\x20contact\x20administrator.'];a54_0x50ed=function(){return _0x10464e;};return a54_0x50ed();}function a54_0x32f8(_0x39685e,_0x552204){const _0x50ed1c=a54_0x50ed();return a54_0x32f8=function(_0x32f81e,_0x164778){_0x32f81e=_0x32f81e-0x15c;let _0x768d8b=_0x50ed1c[_0x32f81e];return _0x768d8b;},a54_0x32f8(_0x39685e,_0x552204);}const node_telegram_bot_api_1=__importDefault(require(a54_0x5ae8a3(0x1f0))),database_1=__importDefault(require(a54_0x5ae8a3(0x226))),gateway_1=require(a54_0x5ae8a3(0x230));class TelegramBotService{constructor(){const _0x2ecc23=a54_0x5ae8a3;this[_0x2ecc23(0x178)]=null,this['botToken']=process[_0x2ecc23(0x1bc)][_0x2ecc23(0x1f8)]||'',this[_0x2ecc23(0x172)]=process[_0x2ecc23(0x1bc)][_0x2ecc23(0x163)]||_0x2ecc23(0x222),this[_0x2ecc23(0x1a1)]?this[_0x2ecc23(0x21d)]():console['warn'](_0x2ecc23(0x1aa));}[a54_0x5ae8a3(0x21d)](){const _0x48c8ca=a54_0x5ae8a3;try{this[_0x48c8ca(0x178)]=new node_telegram_bot_api_1[(_0x48c8ca(0x1ae))](this['botToken'],{'polling':!![]}),this[_0x48c8ca(0x16b)](),console[_0x48c8ca(0x1ac)](_0x48c8ca(0x22d)+this[_0x48c8ca(0x172)]+'\x20initialized\x20successfully');}catch(_0x5702f3){console[_0x48c8ca(0x188)](_0x48c8ca(0x1ec),_0x5702f3);}}[a54_0x5ae8a3(0x16b)](){const _0x5e7345=a54_0x5ae8a3;if(!this[_0x5e7345(0x178)])return;this[_0x5e7345(0x178)][_0x5e7345(0x1ea)](/\/start/,async _0x731975=>{const _0x5e9bec=_0x5e7345,_0x392c79=_0x731975[_0x5e9bec(0x1a2)]['id'],_0x3602a3=_0x731975['from']?.['id'][_0x5e9bec(0x1af)](),_0x40e021=_0x731975[_0x5e9bec(0x1d1)]?.['username'],_0x598d92=_0x731975[_0x5e9bec(0x1d1)]?.['first_name'],_0x12c4e6=_0x731975[_0x5e9bec(0x1d1)]?.[_0x5e9bec(0x1e1)];if(!_0x3602a3)return;try{let _0x2225a7=await database_1[_0x5e9bec(0x1ae)][_0x5e9bec(0x197)]['findUnique']({'where':{'telegramId':_0x3602a3},'include':{'shop':!![]}});!_0x2225a7?(_0x2225a7=await database_1['default']['telegramUser'][_0x5e9bec(0x20d)]({'data':{'telegramId':_0x3602a3,'username':_0x40e021,'firstName':_0x598d92,'lastName':_0x12c4e6,'isVerified':![],'shopId':null},'include':{'shop':!![]}}),console[_0x5e9bec(0x1ac)]('📱\x20Created\x20new\x20Telegram\x20user:\x20'+_0x3602a3+_0x5e9bec(0x1f5)+_0x40e021+')')):_0x2225a7=await database_1[_0x5e9bec(0x1ae)][_0x5e9bec(0x197)]['update']({'where':{'telegramId':_0x3602a3},'data':{'username':_0x40e021,'firstName':_0x598d92,'lastName':_0x12c4e6},'include':{'shop':!![]}}),_0x2225a7[_0x5e9bec(0x1c3)]&&_0x2225a7['shopId']&&_0x2225a7['shop']?await this[_0x5e9bec(0x178)]?.[_0x5e9bec(0x216)](_0x392c79,_0x5e9bec(0x1cb)+(_0x5e9bec(0x1cc)+_0x2225a7[_0x5e9bec(0x1d2)]['name']+'*\x0a')+('Username:\x20`'+_0x2225a7[_0x5e9bec(0x1d2)][_0x5e9bec(0x1dd)]+_0x5e9bec(0x17c))+_0x5e9bec(0x1a8)+_0x5e9bec(0x214)+_0x5e9bec(0x17e)+_0x5e9bec(0x16f)+_0x5e9bec(0x1da)+_0x5e9bec(0x179)+'/disconnect\x20-\x20disconnect\x20from\x20notifications',{'parse_mode':_0x5e9bec(0x1bf)}):(_0x2225a7[_0x5e9bec(0x1b1)]&&!_0x2225a7[_0x5e9bec(0x1c3)]&&(await database_1['default'][_0x5e9bec(0x197)]['update']({'where':{'telegramId':_0x3602a3},'data':{'shopId':null,'isVerified':![]}}),console['log'](_0x5e9bec(0x212)+_0x3602a3)),await this[_0x5e9bec(0x178)]?.['sendMessage'](_0x392c79,_0x5e9bec(0x1de)+'To\x20receive\x20payment\x20notifications,\x20send\x20your\x20credentials\x20in\x20one\x20line:\x0a\x0a'+_0x5e9bec(0x1a5)+_0x5e9bec(0x209)+_0x5e9bec(0x1b8)+_0x5e9bec(0x196),{'parse_mode':_0x5e9bec(0x1bf)}));}catch(_0x4fec7b){console[_0x5e9bec(0x188)](_0x5e9bec(0x206),_0x4fec7b),await this[_0x5e9bec(0x178)]?.['sendMessage'](_0x392c79,_0x5e9bec(0x17f));}}),this[_0x5e7345(0x178)][_0x5e7345(0x1ea)](/\/disconnect/,async _0x510536=>{const _0x338efb=_0x5e7345,_0xed9eff=_0x510536[_0x338efb(0x1a2)]['id'],_0x52fc8f=_0x510536[_0x338efb(0x1d1)]?.['id'][_0x338efb(0x1af)]();if(!_0x52fc8f)return;try{const _0x2089fa=await database_1[_0x338efb(0x1ae)][_0x338efb(0x197)][_0x338efb(0x1b6)]({'where':{'telegramId':_0x52fc8f},'include':{'shop':!![]}});if(!_0x2089fa||!_0x2089fa[_0x338efb(0x1c3)]||!_0x2089fa[_0x338efb(0x1b1)]){await this[_0x338efb(0x178)]?.[_0x338efb(0x216)](_0xed9eff,_0x338efb(0x16e));return;}const _0x59145c=_0x2089fa[_0x338efb(0x1d2)]?.[_0x338efb(0x161)]||'unknown\x20shop';await database_1['default'][_0x338efb(0x197)][_0x338efb(0x1e6)]({'where':{'telegramId':_0x52fc8f},'data':{'shopId':null,'isVerified':![]}}),console[_0x338efb(0x1ac)](_0x338efb(0x19e)+_0x52fc8f+_0x338efb(0x233)+_0x2089fa[_0x338efb(0x1b1)]),await this[_0x338efb(0x178)]?.[_0x338efb(0x216)](_0xed9eff,'✅\x20You\x20have\x20been\x20successfully\x20disconnected\x20from\x20shop\x20*'+_0x59145c+_0x338efb(0x19b)+_0x338efb(0x224),{'parse_mode':_0x338efb(0x1bf)});}catch(_0x35120d){console[_0x338efb(0x188)](_0x338efb(0x18a),_0x35120d),await this['bot']?.[_0x338efb(0x216)](_0xed9eff,_0x338efb(0x17f));}}),this[_0x5e7345(0x178)]['onText'](/\/status/,async _0x4ba2a3=>{const _0x1d8234=_0x5e7345,_0x14d2da=_0x4ba2a3[_0x1d8234(0x1a2)]['id'],_0x450996=_0x4ba2a3['from']?.['id'][_0x1d8234(0x1af)]();if(!_0x450996)return;try{const _0x320f77=await database_1['default'][_0x1d8234(0x197)]['findUnique']({'where':{'telegramId':_0x450996},'include':{'shop':!![]}});if(!_0x320f77){await this[_0x1d8234(0x178)]?.[_0x1d8234(0x216)](_0x14d2da,_0x1d8234(0x1e5)+'Use\x20/start\x20to\x20begin.');return;}if(!_0x320f77[_0x1d8234(0x1c3)]||!_0x320f77[_0x1d8234(0x1b1)]||!_0x320f77[_0x1d8234(0x1d2)]){await this['bot']?.['sendMessage'](_0x14d2da,_0x1d8234(0x225)+_0x1d8234(0x1d7));return;}await this[_0x1d8234(0x178)]?.[_0x1d8234(0x216)](_0x14d2da,'📊\x20*Connection\x20Status*\x0a\x0a'+('✅\x20Connected\x20to\x20shop:\x20*'+_0x320f77[_0x1d8234(0x1d2)][_0x1d8234(0x161)]+'*\x0a')+(_0x1d8234(0x22c)+_0x320f77[_0x1d8234(0x1d2)][_0x1d8234(0x1dd)]+'`\x0a')+('📅\x20Connection\x20date:\x20'+_0x320f77[_0x1d8234(0x1b2)][_0x1d8234(0x1c8)](_0x1d8234(0x1dc))+'\x0a\x0a')+'🔔\x20Notifications\x20are\x20active\x0a\x0a'+_0x1d8234(0x1da)+_0x1d8234(0x232),{'parse_mode':_0x1d8234(0x1bf)});}catch(_0x55fd12){console['error']('Error\x20handling\x20/status\x20command:',_0x55fd12),await this[_0x1d8234(0x178)]?.[_0x1d8234(0x216)](_0x14d2da,_0x1d8234(0x17f));}}),this['bot'][_0x5e7345(0x1ea)](/\/debug/,async _0x527e6b=>{const _0x31c77c=_0x5e7345,_0x5dfd9a=_0x527e6b['chat']['id'],_0x212566=_0x527e6b[_0x31c77c(0x1d1)]?.['id'][_0x31c77c(0x1af)]();if(!_0x212566)return;try{const _0x321a26=await database_1[_0x31c77c(0x1ae)][_0x31c77c(0x1d2)][_0x31c77c(0x17d)]({'select':{'id':!![],'name':!![],'username':!![],'status':!![],'publicKey':!![]},'take':0xa});let _0x579ab7=_0x31c77c(0x19d);_0x579ab7+=_0x31c77c(0x22b)+_0x212566+_0x31c77c(0x17c),_0x579ab7+='🏪\x20Available\x20shops\x20in\x20system:\x0a',_0x321a26['forEach']((_0xea9692,_0x1620ec)=>{const _0x4f8253=_0x31c77c;_0x579ab7+=_0x1620ec+0x1+_0x4f8253(0x1f1)+_0xea9692[_0x4f8253(0x161)]+'*\x0a',_0x579ab7+=_0x4f8253(0x187)+_0xea9692[_0x4f8253(0x1dd)]+'`\x0a',_0x579ab7+='\x20\x20\x20Status:\x20'+_0xea9692[_0x4f8253(0x219)]+'\x0a',_0x579ab7+=_0x4f8253(0x217)+_0xea9692[_0x4f8253(0x1d4)][_0x4f8253(0x210)](0x0,0xf)+_0x4f8253(0x1ed);}),await this['bot']?.['sendMessage'](_0x5dfd9a,_0x579ab7,{'parse_mode':'Markdown'});}catch(_0x4bc363){console[_0x31c77c(0x188)](_0x31c77c(0x1d3),_0x4bc363),await this[_0x31c77c(0x178)]?.[_0x31c77c(0x216)](_0x5dfd9a,_0x31c77c(0x1ba));}}),this['bot']['on']('message',async _0x291afc=>{const _0x3bd87e=_0x5e7345;if(_0x291afc['text']?.[_0x3bd87e(0x19f)]('/'))return;const _0x328231=_0x291afc[_0x3bd87e(0x1a2)]['id'],_0x3494a1=_0x291afc[_0x3bd87e(0x1d1)]?.['id'][_0x3bd87e(0x1af)](),_0x22af34=_0x291afc[_0x3bd87e(0x227)]?.['trim']();if(!_0x3494a1||!_0x22af34)return;try{const _0x17250e=await database_1[_0x3bd87e(0x1ae)][_0x3bd87e(0x197)][_0x3bd87e(0x1b6)]({'where':{'telegramId':_0x3494a1},'include':{'shop':!![]}});if(!_0x17250e){await this[_0x3bd87e(0x178)]?.[_0x3bd87e(0x216)](_0x328231,'❌\x20Please\x20use\x20/start\x20command\x20first');return;}if(_0x17250e[_0x3bd87e(0x1c3)]&&_0x17250e[_0x3bd87e(0x1b1)]&&_0x17250e['shop']){await this[_0x3bd87e(0x178)]?.[_0x3bd87e(0x216)](_0x328231,_0x3bd87e(0x1fd)+_0x17250e[_0x3bd87e(0x1d2)][_0x3bd87e(0x161)]+_0x3bd87e(0x19b)+_0x3bd87e(0x186),{'parse_mode':_0x3bd87e(0x1bf)});return;}const _0x156f50=_0x22af34['split'](/\s+/);if(_0x156f50[_0x3bd87e(0x1b3)]!==0x2){await this[_0x3bd87e(0x178)]?.[_0x3bd87e(0x216)](_0x328231,_0x3bd87e(0x162)+'📝\x20Format:\x20`username\x20api_key`\x0a\x0a'+_0x3bd87e(0x209)+_0x3bd87e(0x1b8)+('You\x20sent\x20'+_0x156f50[_0x3bd87e(0x1b3)]+'\x20parts:\x20'+_0x156f50[_0x3bd87e(0x21f)](_0x5e2727=>'`'+_0x5e2727+'`')[_0x3bd87e(0x169)](',\x20')),{'parse_mode':_0x3bd87e(0x1bf)});return;}const [_0x4a059c,_0x20b2cb]=_0x156f50;console[_0x3bd87e(0x1ac)](_0x3bd87e(0x1e8)+_0x3494a1+_0x3bd87e(0x205)+_0x4a059c+_0x3bd87e(0x190)+_0x20b2cb[_0x3bd87e(0x210)](0x0,0xa)+_0x3bd87e(0x193)),await this[_0x3bd87e(0x189)](_0x328231,_0x3494a1,_0x4a059c,_0x20b2cb);}catch(_0x98af2c){console['error'](_0x3bd87e(0x1d5),_0x98af2c),await this['bot']?.[_0x3bd87e(0x216)](_0x328231,_0x3bd87e(0x17f));}}),this[_0x5e7345(0x178)]['on'](_0x5e7345(0x188),_0x4f44af=>{const _0x5b6b67=_0x5e7345;console[_0x5b6b67(0x188)]('Telegram\x20bot\x20error:',_0x4f44af);}),this[_0x5e7345(0x178)]['on'](_0x5e7345(0x18d),_0xec3ce3=>{const _0x2920bc=_0x5e7345;console[_0x2920bc(0x188)](_0x2920bc(0x220),_0xec3ce3);});}async[a54_0x5ae8a3(0x189)](_0x1b4e7e,_0x32fa4c,_0x50fe3a,_0x574368){const _0x402458=a54_0x5ae8a3;try{console[_0x402458(0x1ac)](_0x402458(0x1e8)+_0x32fa4c+_0x402458(0x205)+_0x50fe3a+_0x402458(0x190)+_0x574368[_0x402458(0x210)](0x0,0xa)+_0x402458(0x193));if(!_0x50fe3a||_0x50fe3a[_0x402458(0x1b3)]<0x3||_0x50fe3a[_0x402458(0x1b3)]>0x32||!/^[a-zA-Z0-9_]+$/['test'](_0x50fe3a)){await this[_0x402458(0x178)]?.[_0x402458(0x216)](_0x1b4e7e,_0x402458(0x202)+_0x50fe3a+'`\x0a\x0a'+_0x402458(0x20f),{'parse_mode':_0x402458(0x1bf)});return;}if(!_0x574368||!_0x574368['startsWith'](_0x402458(0x1c0))&&!_0x574368[_0x402458(0x19f)](_0x402458(0x200))){await this[_0x402458(0x178)]?.[_0x402458(0x216)](_0x1b4e7e,_0x402458(0x1ca)+_0x402458(0x229),{'parse_mode':_0x402458(0x1bf)});return;}const _0xbcabeb=await database_1[_0x402458(0x1ae)][_0x402458(0x1d2)][_0x402458(0x1b6)]({'where':{'username':_0x50fe3a},'select':{'id':!![],'name':!![],'username':!![],'status':!![],'publicKey':!![],'secretKey':!![]}});if(!_0xbcabeb){const _0x3e5873=await database_1['default'][_0x402458(0x1d2)][_0x402458(0x17d)]({'select':{'username':!![],'name':!![]},'take':0x5});let _0x4fbc2c=_0x402458(0x1e7)+_0x50fe3a+_0x402458(0x1a6);_0x3e5873['length']>0x0?(_0x4fbc2c+=_0x402458(0x22f),_0x3e5873[_0x402458(0x191)](_0x36b07d=>{const _0x56d716=_0x402458;_0x4fbc2c+=_0x56d716(0x166)+_0x36b07d[_0x56d716(0x1dd)]+_0x56d716(0x231)+_0x36b07d[_0x56d716(0x161)]+')\x0a';}),_0x4fbc2c+=_0x402458(0x1cf)):_0x4fbc2c+='Check\x20spelling\x20and\x20try\x20again.';await this[_0x402458(0x178)]?.[_0x402458(0x216)](_0x1b4e7e,_0x4fbc2c,{'parse_mode':_0x402458(0x1bf)});return;}if(_0xbcabeb[_0x402458(0x219)]!==_0x402458(0x177)){await this[_0x402458(0x178)]?.[_0x402458(0x216)](_0x1b4e7e,'❌\x20Shop\x20`'+_0x50fe3a+_0x402458(0x1c4)+'Contact\x20administrator.',{'parse_mode':'Markdown'});return;}if(_0xbcabeb['publicKey']!==_0x574368&&_0xbcabeb[_0x402458(0x18b)]!==_0x574368){await this['bot']?.[_0x402458(0x216)](_0x1b4e7e,_0x402458(0x1ab)+_0x50fe3a+_0x402458(0x16c)+_0x402458(0x184)+_0x402458(0x15e),{'parse_mode':_0x402458(0x1bf)});return;}const _0x16ac43=await database_1[_0x402458(0x1ae)][_0x402458(0x197)][_0x402458(0x1e3)]({'where':{'shopId':_0xbcabeb['id'],'isVerified':!![],'telegramId':{'not':_0x32fa4c}}});if(_0x16ac43){await this['bot']?.[_0x402458(0x216)](_0x1b4e7e,_0x402458(0x1c2)+_0x50fe3a+_0x402458(0x16c)+_0x402458(0x1db),{'parse_mode':_0x402458(0x1bf)});return;}await database_1[_0x402458(0x1ae)][_0x402458(0x197)][_0x402458(0x1e6)]({'where':{'telegramId':_0x32fa4c},'data':{'shopId':_0xbcabeb['id'],'isVerified':!![]}}),await this[_0x402458(0x178)]?.[_0x402458(0x216)](_0x1b4e7e,_0x402458(0x1a0)+_0x402458(0x207)+(_0x402458(0x21e)+_0xbcabeb[_0x402458(0x161)]+'*\x0a')+(_0x402458(0x22c)+_0xbcabeb[_0x402458(0x1dd)]+_0x402458(0x17c))+_0x402458(0x176)+_0x402458(0x214)+_0x402458(0x17e)+_0x402458(0x21b)+_0x402458(0x1c1)+_0x402458(0x1da)+_0x402458(0x179)+_0x402458(0x232),{'parse_mode':_0x402458(0x1bf)}),console[_0x402458(0x1ac)](_0x402458(0x1bb)+_0x32fa4c+'\x20verified\x20for\x20shop\x20'+_0xbcabeb['username']+_0x402458(0x168));}catch(_0x4f06a1){console['error']('Error\x20in\x20handleSingleLineVerification:',_0x4f06a1),await this[_0x402458(0x178)]?.[_0x402458(0x216)](_0x1b4e7e,_0x402458(0x211));}}async[a54_0x5ae8a3(0x20e)](_0x309ab1,_0x2d4dcf,_0x40caf9){const _0x2558ef=a54_0x5ae8a3;if(!this[_0x2558ef(0x178)]){console[_0x2558ef(0x171)](_0x2558ef(0x22a));return;}try{const _0x2842f8=await database_1[_0x2558ef(0x1ae)]['telegramUser'][_0x2558ef(0x17d)]({'where':{'shopId':_0x309ab1,'isVerified':!![]}});if(_0x2842f8['length']===0x0){console['log'](_0x2558ef(0x174)+_0x309ab1);return;}const _0x528829=_0x2842f8[_0x2558ef(0x21f)](async _0x30bb78=>{const _0x13e119=_0x2558ef;try{await this[_0x13e119(0x178)]?.['sendMessage'](_0x30bb78[_0x13e119(0x194)],_0x2d4dcf,_0x40caf9),console[_0x13e119(0x1ac)](_0x13e119(0x20c)+_0x30bb78['telegramId']);}catch(_0x307b0e){console[_0x13e119(0x188)](_0x13e119(0x1ff)+_0x30bb78[_0x13e119(0x194)]+':',_0x307b0e),_0x307b0e instanceof Error&&(_0x307b0e['message'][_0x13e119(0x198)](_0x13e119(0x18c))||_0x307b0e['message'][_0x13e119(0x198)](_0x13e119(0x165))||_0x307b0e[_0x13e119(0x1be)][_0x13e119(0x198)](_0x13e119(0x1e9)))&&(await database_1[_0x13e119(0x1ae)][_0x13e119(0x197)][_0x13e119(0x1e6)]({'where':{'id':_0x30bb78['id']},'data':{'isVerified':![]}}),console[_0x13e119(0x1ac)](_0x13e119(0x1fc)+_0x30bb78[_0x13e119(0x194)]+'\x20marked\x20as\x20unverified\x20due\x20to\x20delivery\x20failure'));}});await Promise['allSettled'](_0x528829);}catch(_0x5d888f){console[_0x2558ef(0x188)](_0x2558ef(0x167),_0x5d888f);}}async['sendPaymentNotification'](_0x406ace,_0x3b1e1c,_0x7b19ce){const _0x2b8439=a54_0x5ae8a3,_0x264fb6={'created':'🆕','paid':'✅','failed':'❌','expired':'⏰','refund':'🔄','chargeback':'⚠️','processing':'⚙️'},_0xafc9af={'created':_0x2b8439(0x1bd),'paid':_0x2b8439(0x1d8),'failed':_0x2b8439(0x16a),'expired':_0x2b8439(0x18f),'refund':'Payment\x20refund','chargeback':'Payment\x20chargeback','processing':'Payment\x20is\x20being\x20processed'},_0x5a60d8=_0x264fb6[_0x7b19ce],_0x12864b=_0xafc9af[_0x7b19ce],_0x13e66e=(0x0,gateway_1['getGatewayDisplayNameForTelegram'])(_0x3b1e1c[_0x2b8439(0x20a)]);console['log'](_0x2b8439(0x1f2)+_0x3b1e1c['gateway']+_0x2b8439(0x1f7)+_0x13e66e+'\x22');let _0x18aa80=_0x5a60d8+'\x20*'+_0x12864b+_0x2b8439(0x1fe)+('💰\x20Amount:\x20*'+_0x3b1e1c[_0x2b8439(0x173)]+'\x20'+_0x3b1e1c[_0x2b8439(0x228)]+'*\x0a')+('📝\x20Order\x20ID:\x20`'+(_0x3b1e1c[_0x2b8439(0x1e0)]||_0x3b1e1c['id'])+'`\x0a')+('🆔\x20Payment\x20ID:\x20`'+_0x3b1e1c['id']+'`\x0a')+('🏪\x20Gateway:\x20`'+_0x13e66e+'`\x0a')+(_0x2b8439(0x19a)+new Date(_0x3b1e1c['createdAt'])['toLocaleString'](_0x2b8439(0x1dc))+'\x0a');(_0x3b1e1c[_0x2b8439(0x17b)]||_0x3b1e1c[_0x2b8439(0x1b9)])&&(_0x18aa80+='\x0a👤\x20*Customer\x20Information:*\x0a',_0x3b1e1c[_0x2b8439(0x17b)]&&(_0x18aa80+=_0x2b8439(0x1a4)+_0x3b1e1c[_0x2b8439(0x17b)]+'`\x0a'),_0x3b1e1c[_0x2b8439(0x1b9)]&&(_0x18aa80+='📧\x20Email:\x20`'+_0x3b1e1c[_0x2b8439(0x1b9)]+'`\x0a')),_0x7b19ce==='chargeback'&&_0x3b1e1c[_0x2b8439(0x164)]&&(_0x18aa80+=_0x2b8439(0x1e2)+_0x3b1e1c[_0x2b8439(0x164)]+_0x2b8439(0x1eb)),_0x7b19ce===_0x2b8439(0x221)&&(_0x18aa80+=_0x2b8439(0x170)),_0x3b1e1c[_0x2b8439(0x203)]&&(_0x18aa80+=_0x2b8439(0x15d)+_0x3b1e1c[_0x2b8439(0x203)]+'\x0a'),await this['sendShopNotification'](_0x406ace,_0x18aa80,{'parse_mode':'Markdown'});}async[a54_0x5ae8a3(0x218)](_0x29ffa2,_0x40fac4,_0x5d115b){const _0x4dc45c=a54_0x5ae8a3,_0xd715f={'created':'📤','completed':'✅','rejected':'❌'},_0x14646d={'created':_0x4dc45c(0x17a),'completed':_0x4dc45c(0x192),'rejected':_0x4dc45c(0x175)},_0xaee1e4=_0xd715f[_0x5d115b],_0x564e75=_0x14646d[_0x5d115b],_0x37277e=_0xaee1e4+'\x20*'+_0x564e75+_0x4dc45c(0x1fe)+(_0x4dc45c(0x180)+_0x40fac4[_0x4dc45c(0x173)]+'\x20USD*\x0a')+('🏦\x20Method:\x20`'+_0x40fac4[_0x4dc45c(0x160)]+'`\x0a')+(_0x4dc45c(0x1c9)+_0x40fac4['id']+'`\x0a')+(_0x4dc45c(0x19a)+new Date(_0x40fac4['createdAt'])[_0x4dc45c(0x1ad)]('en-US')+'\x0a')+(_0x40fac4[_0x4dc45c(0x181)]?_0x4dc45c(0x1fa)+_0x40fac4[_0x4dc45c(0x181)]+'`':'');await this['sendShopNotification'](_0x29ffa2,_0x37277e,{'parse_mode':_0x4dc45c(0x1bf)});}async['sendLoginNotification'](_0x386f8f,_0x2e6448){const _0x278e3c=a54_0x5ae8a3;try{const _0xda8ce8=await database_1[_0x278e3c(0x1ae)][_0x278e3c(0x182)][_0x278e3c(0x1b6)]({'where':{'shopId':_0x386f8f},'select':{'notificationLogin':!![]}});if(!_0xda8ce8?.[_0x278e3c(0x1b7)]){console[_0x278e3c(0x1ac)](_0x278e3c(0x1ef)+_0x386f8f);return;}const _0x25faaf=_0x2e6448['success']?'🔐':'🚨',_0x5817cd=_0x2e6448[_0x278e3c(0x199)]?'Successful\x20login':_0x278e3c(0x1b0);let _0x3b5e47=_0x25faaf+'\x20*'+_0x5817cd+_0x278e3c(0x1fe)+(_0x278e3c(0x22c)+_0x2e6448[_0x278e3c(0x1dd)]+'`\x0a')+('📅\x20Time:\x20'+_0x2e6448['timestamp'][_0x278e3c(0x1ad)]('en-US')+'\x0a');_0x2e6448[_0x278e3c(0x1f9)]&&(_0x3b5e47+=_0x278e3c(0x223)+_0x2e6448['ipAddress']+'`\x0a');if(_0x2e6448['userAgent']){const _0xbe2990=_0x2e6448[_0x278e3c(0x1f3)][_0x278e3c(0x1b3)]>0x32?_0x2e6448[_0x278e3c(0x1f3)]['substring'](0x0,0x32)+_0x278e3c(0x208):_0x2e6448[_0x278e3c(0x1f3)];_0x3b5e47+='💻\x20Browser:\x20`'+_0xbe2990+'`\x0a';}!_0x2e6448['success']&&(_0x3b5e47+=_0x278e3c(0x215)),await this['sendShopNotification'](_0x386f8f,_0x3b5e47,{'parse_mode':'Markdown'}),console[_0x278e3c(0x1ac)](_0x278e3c(0x22e)+_0x386f8f+':\x20'+(_0x2e6448[_0x278e3c(0x199)]?_0x278e3c(0x199):'failed'));}catch(_0x236282){console[_0x278e3c(0x188)](_0x278e3c(0x1cd),_0x236282);}}async[a54_0x5ae8a3(0x195)](_0x331507,_0x537df5){const _0x56f35e=a54_0x5ae8a3;try{const _0x2a6155=await database_1[_0x56f35e(0x1ae)][_0x56f35e(0x182)]['findUnique']({'where':{'shopId':_0x331507},'select':{'notificationApiError':!![]}});if(!_0x2a6155?.['notificationApiError']){console[_0x56f35e(0x1ac)](_0x56f35e(0x1f6)+_0x331507);return;}let _0xe29a14='🚨\x20*API\x20Error*\x0a\x0a'+(_0x56f35e(0x1df)+_0x537df5['method']+'\x20'+_0x537df5[_0x56f35e(0x183)]+'`\x0a')+(_0x56f35e(0x16d)+_0x537df5[_0x56f35e(0x1ee)][_0x56f35e(0x1ad)]('en-US')+'\x0a');_0x537df5[_0x56f35e(0x21a)]&&(_0xe29a14+=_0x56f35e(0x1d0)+_0x537df5[_0x56f35e(0x21a)]+'`\x0a'),_0xe29a14+='❌\x20Error:\x20`'+_0x537df5[_0x56f35e(0x1e4)]+'`\x0a',_0x537df5[_0x56f35e(0x1a7)]&&(_0xe29a14+='🆔\x20Request\x20ID:\x20`'+_0x537df5[_0x56f35e(0x1a7)]+'`\x0a'),_0xe29a14+=_0x56f35e(0x21c),await this[_0x56f35e(0x20e)](_0x331507,_0xe29a14,{'parse_mode':_0x56f35e(0x1bf)}),console['log'](_0x56f35e(0x1d9)+_0x331507+':\x20'+_0x537df5['endpoint']);}catch(_0x2757f1){console['error'](_0x56f35e(0x1b4),_0x2757f1);}}async[a54_0x5ae8a3(0x1c6)](_0xef7ebd,_0xeae6ee,_0x3eb0f8){const _0x4dd0a4=a54_0x5ae8a3;let _0x22e7d9=_0x4dd0a4(0x234)+_0xeae6ee+_0x4dd0a4(0x1fe);for(const [_0x45ee04,_0x474e38]of Object[_0x4dd0a4(0x19c)](_0x3eb0f8)){_0x474e38!==null&&_0x474e38!==undefined&&(_0x22e7d9+=_0x45ee04+_0x4dd0a4(0x1c5)+_0x474e38+'`\x0a');}await this[_0x4dd0a4(0x20e)](_0xef7ebd,_0x22e7d9,{'parse_mode':'Markdown'});}[a54_0x5ae8a3(0x1d6)](){const _0x12a8d6=a54_0x5ae8a3;return{'isActive':!!this['bot'],'username':this[_0x12a8d6(0x172)]};}['stopBot'](){const _0x174ac1=a54_0x5ae8a3;this[_0x174ac1(0x178)]&&(this[_0x174ac1(0x178)][_0x174ac1(0x1fb)](),this[_0x174ac1(0x178)]=null,console[_0x174ac1(0x1ac)](_0x174ac1(0x1ce)));}}exports[a54_0x5ae8a3(0x15f)]=TelegramBotService,exports[a54_0x5ae8a3(0x1b5)]=new TelegramBotService();