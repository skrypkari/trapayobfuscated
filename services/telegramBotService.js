'use strict';const a49_0x5d613a=a49_0x45e9;function a49_0x45e9(_0x5238c0,_0x1146da){const _0x77d2c2=a49_0x77d2();return a49_0x45e9=function(_0x45e91b,_0x2ba0cc){_0x45e91b=_0x45e91b-0x11f;let _0x5c81ae=_0x77d2c2[_0x45e91b];return _0x5c81ae;},a49_0x45e9(_0x5238c0,_0x1146da);}(function(_0x3bd19e,_0x580394){const _0x3fb2e0=a49_0x45e9,_0x3196da=_0x3bd19e();while(!![]){try{const _0x46454d=parseInt(_0x3fb2e0(0x1ab))/0x1+parseInt(_0x3fb2e0(0x1bc))/0x2*(parseInt(_0x3fb2e0(0x1a9))/0x3)+parseInt(_0x3fb2e0(0x202))/0x4+-parseInt(_0x3fb2e0(0x1e6))/0x5*(parseInt(_0x3fb2e0(0x1e1))/0x6)+parseInt(_0x3fb2e0(0x165))/0x7*(parseInt(_0x3fb2e0(0x147))/0x8)+-parseInt(_0x3fb2e0(0x19f))/0x9+-parseInt(_0x3fb2e0(0x188))/0xa;if(_0x46454d===_0x580394)break;else _0x3196da['push'](_0x3196da['shift']());}catch(_0xd95230){_0x3196da['push'](_0x3196da['shift']());}}}(a49_0x77d2,0xb2fc6));var __importDefault=this&&this[a49_0x5d613a(0x1b7)]||function(_0x56511c){return _0x56511c&&_0x56511c['__esModule']?_0x56511c:{'default':_0x56511c};};Object[a49_0x5d613a(0x1df)](exports,a49_0x5d613a(0x163),{'value':!![]}),exports[a49_0x5d613a(0x19c)]=exports[a49_0x5d613a(0x1dd)]=void 0x0;const node_telegram_bot_api_1=__importDefault(require(a49_0x5d613a(0x158))),database_1=__importDefault(require(a49_0x5d613a(0x15f))),gateway_1=require('../types/gateway');class TelegramBotService{constructor(){const _0x46a190=a49_0x5d613a;this[_0x46a190(0x16d)]=null,this[_0x46a190(0x133)]=process[_0x46a190(0x164)][_0x46a190(0x166)]||'',this['botUsername']=process[_0x46a190(0x164)][_0x46a190(0x190)]||_0x46a190(0x1d2),this[_0x46a190(0x133)]?this[_0x46a190(0x1c4)]():console['warn'](_0x46a190(0x141));}[a49_0x5d613a(0x1c4)](){const _0x17d53c=a49_0x5d613a;try{this[_0x17d53c(0x16d)]=new node_telegram_bot_api_1['default'](this[_0x17d53c(0x133)],{'polling':!![]}),this[_0x17d53c(0x142)](),console[_0x17d53c(0x167)]('✅\x20Telegram\x20bot\x20@'+this[_0x17d53c(0x124)]+'\x20initialized\x20successfully');}catch(_0x2ea6c1){console['error'](_0x17d53c(0x1d4),_0x2ea6c1);}}[a49_0x5d613a(0x142)](){const _0x4e6c19=a49_0x5d613a;if(!this[_0x4e6c19(0x16d)])return;this[_0x4e6c19(0x16d)][_0x4e6c19(0x16f)](/\/start/,async _0x314c27=>{const _0x3c1f41=_0x4e6c19,_0x162e2d=_0x314c27[_0x3c1f41(0x1c6)]['id'],_0x23c08b=_0x314c27['from']?.['id'][_0x3c1f41(0x1a2)](),_0x4e054e=_0x314c27['from']?.[_0x3c1f41(0x1c5)],_0x1add5e=_0x314c27[_0x3c1f41(0x14d)]?.[_0x3c1f41(0x1ba)],_0x3371f3=_0x314c27[_0x3c1f41(0x14d)]?.[_0x3c1f41(0x153)];if(!_0x23c08b)return;try{let _0x1583d5=await database_1[_0x3c1f41(0x140)]['telegramUser'][_0x3c1f41(0x18b)]({'where':{'telegramId':_0x23c08b},'include':{'shop':!![]}});!_0x1583d5?(_0x1583d5=await database_1[_0x3c1f41(0x140)][_0x3c1f41(0x18f)][_0x3c1f41(0x185)]({'data':{'telegramId':_0x23c08b,'username':_0x4e054e,'firstName':_0x1add5e,'lastName':_0x3371f3,'isVerified':![],'shopId':null},'include':{'shop':!![]}}),console['log']('📱\x20Created\x20new\x20Telegram\x20user:\x20'+_0x23c08b+'\x20(@'+_0x4e054e+')')):_0x1583d5=await database_1[_0x3c1f41(0x140)][_0x3c1f41(0x18f)][_0x3c1f41(0x1d1)]({'where':{'telegramId':_0x23c08b},'data':{'username':_0x4e054e,'firstName':_0x1add5e,'lastName':_0x3371f3},'include':{'shop':!![]}}),_0x1583d5[_0x3c1f41(0x1ce)]&&_0x1583d5[_0x3c1f41(0x128)]&&_0x1583d5[_0x3c1f41(0x14e)]?await this[_0x3c1f41(0x16d)]?.[_0x3c1f41(0x126)](_0x162e2d,_0x3c1f41(0x162)+(_0x3c1f41(0x14b)+_0x1583d5['shop']['name']+'*\x0a')+(_0x3c1f41(0x1af)+_0x1583d5[_0x3c1f41(0x14e)][_0x3c1f41(0x1c5)]+_0x3c1f41(0x180))+_0x3c1f41(0x1a5)+_0x3c1f41(0x160)+_0x3c1f41(0x1de)+_0x3c1f41(0x1ff)+_0x3c1f41(0x198)+'/status\x20-\x20check\x20connection\x20status\x0a'+_0x3c1f41(0x1da),{'parse_mode':_0x3c1f41(0x1ef)}):(_0x1583d5[_0x3c1f41(0x128)]&&!_0x1583d5[_0x3c1f41(0x1ce)]&&(await database_1[_0x3c1f41(0x140)][_0x3c1f41(0x18f)][_0x3c1f41(0x1d1)]({'where':{'telegramId':_0x23c08b},'data':{'shopId':null,'isVerified':![]}}),console[_0x3c1f41(0x167)](_0x3c1f41(0x1d6)+_0x23c08b)),await this[_0x3c1f41(0x16d)]?.[_0x3c1f41(0x126)](_0x162e2d,_0x3c1f41(0x1f2)+_0x3c1f41(0x168)+_0x3c1f41(0x19e)+_0x3c1f41(0x1ad)+_0x3c1f41(0x191)+_0x3c1f41(0x14a),{'parse_mode':_0x3c1f41(0x1ef)}));}catch(_0x445b7e){console[_0x3c1f41(0x19a)]('Error\x20handling\x20/start\x20command:',_0x445b7e),await this[_0x3c1f41(0x16d)]?.[_0x3c1f41(0x126)](_0x162e2d,_0x3c1f41(0x1fd));}}),this[_0x4e6c19(0x16d)]['onText'](/\/disconnect/,async _0x396f08=>{const _0x224472=_0x4e6c19,_0x21e91a=_0x396f08[_0x224472(0x1c6)]['id'],_0x3f60ef=_0x396f08[_0x224472(0x14d)]?.['id'][_0x224472(0x1a2)]();if(!_0x3f60ef)return;try{const _0x517e82=await database_1[_0x224472(0x140)][_0x224472(0x18f)][_0x224472(0x18b)]({'where':{'telegramId':_0x3f60ef},'include':{'shop':!![]}});if(!_0x517e82||!_0x517e82[_0x224472(0x1ce)]||!_0x517e82['shopId']){await this[_0x224472(0x16d)]?.[_0x224472(0x126)](_0x21e91a,_0x224472(0x12b));return;}const _0x2fd459=_0x517e82[_0x224472(0x14e)]?.['name']||_0x224472(0x186);await database_1[_0x224472(0x140)][_0x224472(0x18f)]['update']({'where':{'telegramId':_0x3f60ef},'data':{'shopId':null,'isVerified':![]}}),console['log'](_0x224472(0x19d)+_0x3f60ef+'\x20disconnected\x20from\x20shop\x20'+_0x517e82['shopId']),await this[_0x224472(0x16d)]?.['sendMessage'](_0x21e91a,_0x224472(0x135)+_0x2fd459+_0x224472(0x1f6)+_0x224472(0x161),{'parse_mode':'Markdown'});}catch(_0x176368){console[_0x224472(0x19a)](_0x224472(0x184),_0x176368),await this[_0x224472(0x16d)]?.[_0x224472(0x126)](_0x21e91a,_0x224472(0x1fd));}}),this[_0x4e6c19(0x16d)][_0x4e6c19(0x16f)](/\/status/,async _0x2b6bb4=>{const _0x18764c=_0x4e6c19,_0x5b4c4c=_0x2b6bb4[_0x18764c(0x1c6)]['id'],_0x1c1831=_0x2b6bb4[_0x18764c(0x14d)]?.['id'][_0x18764c(0x1a2)]();if(!_0x1c1831)return;try{const _0x1bd5c7=await database_1[_0x18764c(0x140)][_0x18764c(0x18f)][_0x18764c(0x18b)]({'where':{'telegramId':_0x1c1831},'include':{'shop':!![]}});if(!_0x1bd5c7){await this['bot']?.[_0x18764c(0x126)](_0x5b4c4c,'❌\x20You\x20are\x20not\x20registered\x20in\x20the\x20system.\x0a\x0a'+'Use\x20/start\x20to\x20begin.');return;}if(!_0x1bd5c7[_0x18764c(0x1ce)]||!_0x1bd5c7['shopId']||!_0x1bd5c7[_0x18764c(0x14e)]){await this['bot']?.[_0x18764c(0x126)](_0x5b4c4c,_0x18764c(0x1b9)+_0x18764c(0x12a));return;}await this[_0x18764c(0x16d)]?.[_0x18764c(0x126)](_0x5b4c4c,'📊\x20*Connection\x20Status*\x0a\x0a'+(_0x18764c(0x1c9)+_0x1bd5c7[_0x18764c(0x14e)][_0x18764c(0x170)]+'*\x0a')+(_0x18764c(0x1b1)+_0x1bd5c7[_0x18764c(0x14e)][_0x18764c(0x1c5)]+'`\x0a')+('📅\x20Connection\x20date:\x20'+_0x1bd5c7[_0x18764c(0x200)]['toLocaleDateString'](_0x18764c(0x1ac))+'\x0a\x0a')+_0x18764c(0x189)+_0x18764c(0x198)+_0x18764c(0x1da),{'parse_mode':_0x18764c(0x1ef)});}catch(_0x48a9ac){console[_0x18764c(0x19a)](_0x18764c(0x173),_0x48a9ac),await this[_0x18764c(0x16d)]?.[_0x18764c(0x126)](_0x5b4c4c,_0x18764c(0x1fd));}}),this['bot'][_0x4e6c19(0x16f)](/\/debug/,async _0x35c08f=>{const _0x397e15=_0x4e6c19,_0x232a10=_0x35c08f[_0x397e15(0x1c6)]['id'],_0x1e662b=_0x35c08f[_0x397e15(0x14d)]?.['id'][_0x397e15(0x1a2)]();if(!_0x1e662b)return;try{const _0x39a32a=await database_1['default'][_0x397e15(0x14e)]['findMany']({'select':{'id':!![],'name':!![],'username':!![],'status':!![],'publicKey':!![]},'take':0xa});let _0x53750c=_0x397e15(0x17f);_0x53750c+=_0x397e15(0x178)+_0x1e662b+_0x397e15(0x180),_0x53750c+=_0x397e15(0x122),_0x39a32a[_0x397e15(0x13e)]((_0x391ec4,_0x47f253)=>{const _0x2fec90=_0x397e15;_0x53750c+=_0x47f253+0x1+_0x2fec90(0x15c)+_0x391ec4[_0x2fec90(0x170)]+'*\x0a',_0x53750c+=_0x2fec90(0x1bd)+_0x391ec4[_0x2fec90(0x1c5)]+'`\x0a',_0x53750c+=_0x2fec90(0x1e2)+_0x391ec4['status']+'\x0a',_0x53750c+=_0x2fec90(0x16e)+_0x391ec4['publicKey'][_0x2fec90(0x1e0)](0x0,0xf)+_0x2fec90(0x136);}),await this['bot']?.[_0x397e15(0x126)](_0x232a10,_0x53750c,{'parse_mode':_0x397e15(0x1ef)});}catch(_0xf89ad0){console[_0x397e15(0x19a)](_0x397e15(0x17c),_0xf89ad0),await this[_0x397e15(0x16d)]?.[_0x397e15(0x126)](_0x232a10,'❌\x20Error\x20getting\x20debug\x20information.');}}),this[_0x4e6c19(0x16d)]['on'](_0x4e6c19(0x12f),async _0x986d89=>{const _0x65a478=_0x4e6c19;if(_0x986d89[_0x65a478(0x1a8)]?.[_0x65a478(0x1b0)]('/'))return;const _0x1c8a8b=_0x986d89['chat']['id'],_0x874a55=_0x986d89[_0x65a478(0x14d)]?.['id'][_0x65a478(0x1a2)](),_0x36d9da=_0x986d89[_0x65a478(0x1a8)]?.[_0x65a478(0x15e)]();if(!_0x874a55||!_0x36d9da)return;try{const _0x211716=await database_1[_0x65a478(0x140)][_0x65a478(0x18f)][_0x65a478(0x18b)]({'where':{'telegramId':_0x874a55},'include':{'shop':!![]}});if(!_0x211716){await this[_0x65a478(0x16d)]?.[_0x65a478(0x126)](_0x1c8a8b,_0x65a478(0x18c));return;}if(_0x211716[_0x65a478(0x1ce)]&&_0x211716[_0x65a478(0x128)]&&_0x211716[_0x65a478(0x14e)]){await this[_0x65a478(0x16d)]?.[_0x65a478(0x126)](_0x1c8a8b,'✅\x20You\x20are\x20already\x20connected\x20to\x20shop\x20*'+_0x211716['shop']['name']+_0x65a478(0x1f6)+_0x65a478(0x201),{'parse_mode':_0x65a478(0x1ef)});return;}const _0x3e364d=_0x36d9da[_0x65a478(0x195)](/\s+/);if(_0x3e364d['length']!==0x2){await this['bot']?.[_0x65a478(0x126)](_0x1c8a8b,_0x65a478(0x1cd)+_0x65a478(0x19e)+_0x65a478(0x1ad)+'`appple\x20pk_aa6450d3f57afbefbb0f3f5be5ce6cca13037536afc5ccf14c81a6cbc7a07de5`\x0a\x0a'+('You\x20sent\x20'+_0x3e364d[_0x65a478(0x1fa)]+_0x65a478(0x1ec)+_0x3e364d[_0x65a478(0x1e5)](_0x4a260b=>'`'+_0x4a260b+'`')[_0x65a478(0x13a)](',\x20')),{'parse_mode':_0x65a478(0x1ef)});return;}const [_0x532854,_0x36f050]=_0x3e364d;console['log']('🔄\x20Processing\x20single-line\x20verification\x20for\x20user\x20'+_0x874a55+_0x65a478(0x169)+_0x532854+_0x65a478(0x17d)+_0x36f050[_0x65a478(0x1e0)](0x0,0xa)+_0x65a478(0x1a1)),await this['handleSingleLineVerification'](_0x1c8a8b,_0x874a55,_0x532854,_0x36f050);}catch(_0x4e2cf2){console['error'](_0x65a478(0x17b),_0x4e2cf2),await this[_0x65a478(0x16d)]?.[_0x65a478(0x126)](_0x1c8a8b,_0x65a478(0x1fd));}}),this[_0x4e6c19(0x16d)]['on'](_0x4e6c19(0x19a),_0x1d1ad5=>{const _0x3f07d9=_0x4e6c19;console[_0x3f07d9(0x19a)](_0x3f07d9(0x139),_0x1d1ad5);}),this['bot']['on'](_0x4e6c19(0x16c),_0x334fab=>{const _0x4effe5=_0x4e6c19;console[_0x4effe5(0x19a)](_0x4effe5(0x134),_0x334fab);});}async['handleSingleLineVerification'](_0x3156c5,_0x34152f,_0x357df5,_0x5d3323){const _0x12b389=a49_0x5d613a;try{console[_0x12b389(0x167)](_0x12b389(0x145)+_0x34152f+_0x12b389(0x169)+_0x357df5+_0x12b389(0x17d)+_0x5d3323[_0x12b389(0x1e0)](0x0,0xa)+_0x12b389(0x1a1));if(!_0x357df5||_0x357df5[_0x12b389(0x1fa)]<0x3||_0x357df5[_0x12b389(0x1fa)]>0x32||!/^[a-zA-Z0-9_]+$/[_0x12b389(0x137)](_0x357df5)){await this[_0x12b389(0x16d)]?.[_0x12b389(0x126)](_0x3156c5,_0x12b389(0x13b)+_0x357df5+'`\x0a\x0a'+_0x12b389(0x1fb),{'parse_mode':_0x12b389(0x1ef)});return;}if(!_0x5d3323||!_0x5d3323[_0x12b389(0x1b0)]('pk_')&&!_0x5d3323[_0x12b389(0x1b0)](_0x12b389(0x1ea))){await this[_0x12b389(0x16d)]?.[_0x12b389(0x126)](_0x3156c5,_0x12b389(0x1cb)+_0x12b389(0x182),{'parse_mode':'Markdown'});return;}const _0x4c941b=await database_1['default'][_0x12b389(0x14e)]['findUnique']({'where':{'username':_0x357df5},'select':{'id':!![],'name':!![],'username':!![],'status':!![],'publicKey':!![],'secretKey':!![]}});if(!_0x4c941b){const _0x517b5c=await database_1['default'][_0x12b389(0x14e)][_0x12b389(0x14f)]({'select':{'username':!![],'name':!![]},'take':0x5});let _0x23c874='❌\x20Shop\x20with\x20username\x20`'+_0x357df5+'`\x20not\x20found.\x0a\x0a';_0x517b5c[_0x12b389(0x1fa)]>0x0?(_0x23c874+=_0x12b389(0x179),_0x517b5c[_0x12b389(0x13e)](_0x296633=>{const _0xceeac=_0x12b389;_0x23c874+=_0xceeac(0x1a6)+_0x296633['username']+'`\x20('+_0x296633[_0xceeac(0x170)]+')\x0a';}),_0x23c874+=_0x12b389(0x152)):_0x23c874+=_0x12b389(0x1c8);await this['bot']?.[_0x12b389(0x126)](_0x3156c5,_0x23c874,{'parse_mode':_0x12b389(0x1ef)});return;}if(_0x4c941b[_0x12b389(0x1ca)]!==_0x12b389(0x1d7)){await this[_0x12b389(0x16d)]?.['sendMessage'](_0x3156c5,_0x12b389(0x1db)+_0x357df5+'`\x20is\x20inactive.\x0a\x0a'+_0x12b389(0x1f9),{'parse_mode':_0x12b389(0x1ef)});return;}if(_0x4c941b[_0x12b389(0x1cc)]!==_0x5d3323&&_0x4c941b[_0x12b389(0x130)]!==_0x5d3323){await this[_0x12b389(0x16d)]?.[_0x12b389(0x126)](_0x3156c5,_0x12b389(0x13f)+_0x357df5+_0x12b389(0x156)+'Check\x20the\x20key\x20and\x20try\x20again.\x0a\x0a'+_0x12b389(0x12d),{'parse_mode':_0x12b389(0x1ef)});return;}const _0xc6fa7d=await database_1[_0x12b389(0x140)][_0x12b389(0x18f)]['findFirst']({'where':{'shopId':_0x4c941b['id'],'isVerified':!![],'telegramId':{'not':_0x34152f}}});if(_0xc6fa7d){await this[_0x12b389(0x16d)]?.[_0x12b389(0x126)](_0x3156c5,_0x12b389(0x1a3)+_0x357df5+'`.\x0a\x0a'+_0x12b389(0x1e9),{'parse_mode':'Markdown'});return;}await database_1[_0x12b389(0x140)]['telegramUser'][_0x12b389(0x1d1)]({'where':{'telegramId':_0x34152f},'data':{'shopId':_0x4c941b['id'],'isVerified':!![]}}),await this[_0x12b389(0x16d)]?.[_0x12b389(0x126)](_0x3156c5,_0x12b389(0x1c1)+_0x12b389(0x13c)+(_0x12b389(0x18d)+_0x4c941b['name']+'*\x0a')+('👤\x20Username:\x20`'+_0x4c941b[_0x12b389(0x1c5)]+_0x12b389(0x180))+_0x12b389(0x1eb)+_0x12b389(0x160)+_0x12b389(0x1de)+_0x12b389(0x1fe)+'•\x20Important\x20events\x0a\x0a'+'Commands:\x0a'+_0x12b389(0x150)+'/disconnect\x20-\x20disconnect\x20from\x20notifications',{'parse_mode':_0x12b389(0x1ef)}),console[_0x12b389(0x167)](_0x12b389(0x1cf)+_0x34152f+'\x20verified\x20for\x20shop\x20'+_0x4c941b[_0x12b389(0x1c5)]+_0x12b389(0x129));}catch(_0x590606){console[_0x12b389(0x19a)](_0x12b389(0x1d0),_0x590606),await this['bot']?.[_0x12b389(0x126)](_0x3156c5,_0x12b389(0x1d9));}}async[a49_0x5d613a(0x127)](_0x409432,_0x14ff83,_0x312860){const _0x2a49e1=a49_0x5d613a;if(!this['bot']){console[_0x2a49e1(0x11f)]('Telegram\x20bot\x20not\x20initialized,\x20cannot\x20send\x20notification');return;}try{const _0x1be9d1=await database_1[_0x2a49e1(0x140)][_0x2a49e1(0x18f)]['findMany']({'where':{'shopId':_0x409432,'isVerified':!![]}});if(_0x1be9d1[_0x2a49e1(0x1fa)]===0x0){console[_0x2a49e1(0x167)](_0x2a49e1(0x192)+_0x409432);return;}const _0x3f1b96=_0x1be9d1[_0x2a49e1(0x1e5)](async _0x1e966a=>{const _0x149ca9=_0x2a49e1;try{await this[_0x149ca9(0x16d)]?.[_0x149ca9(0x126)](_0x1e966a[_0x149ca9(0x148)],_0x14ff83,_0x312860),console[_0x149ca9(0x167)](_0x149ca9(0x125)+_0x1e966a[_0x149ca9(0x148)]);}catch(_0x11220c){console[_0x149ca9(0x19a)]('❌\x20Failed\x20to\x20send\x20notification\x20to\x20Telegram\x20user\x20'+_0x1e966a[_0x149ca9(0x148)]+':',_0x11220c),_0x11220c instanceof Error&&(_0x11220c[_0x149ca9(0x12f)][_0x149ca9(0x174)](_0x149ca9(0x1e8))||_0x11220c[_0x149ca9(0x12f)][_0x149ca9(0x174)](_0x149ca9(0x1d3))||_0x11220c[_0x149ca9(0x12f)][_0x149ca9(0x174)](_0x149ca9(0x1b8)))&&(await database_1[_0x149ca9(0x140)]['telegramUser'][_0x149ca9(0x1d1)]({'where':{'id':_0x1e966a['id']},'data':{'isVerified':![]}}),console[_0x149ca9(0x167)]('User\x20'+_0x1e966a[_0x149ca9(0x148)]+'\x20marked\x20as\x20unverified\x20due\x20to\x20delivery\x20failure'));}});await Promise[_0x2a49e1(0x187)](_0x3f1b96);}catch(_0x366300){console[_0x2a49e1(0x19a)](_0x2a49e1(0x1b5),_0x366300);}}async['sendPaymentNotification'](_0x24fd1f,_0x47da00,_0x16f756){const _0x203e47=a49_0x5d613a,_0x19b864={'created':'🆕','paid':'✅','failed':'❌','expired':'⏰','refund':'🔄','chargeback':'⚠️','processing':'⚙️'},_0x4d039f={'created':_0x203e47(0x132),'paid':_0x203e47(0x143),'failed':_0x203e47(0x15d),'expired':_0x203e47(0x1bb),'refund':_0x203e47(0x123),'chargeback':'Payment\x20chargeback','processing':_0x203e47(0x146)},_0x34f761=_0x19b864[_0x16f756],_0x1acc0f=_0x4d039f[_0x16f756],_0x382d3a=(0x0,gateway_1[_0x203e47(0x1b4)])(_0x47da00[_0x203e47(0x194)]);console[_0x203e47(0x167)](_0x203e47(0x121)+_0x47da00['gateway']+_0x203e47(0x16a)+_0x382d3a+'\x22');let _0x483cdd=_0x34f761+'\x20*'+_0x1acc0f+_0x203e47(0x120)+(_0x203e47(0x15b)+_0x47da00[_0x203e47(0x1d5)]+'\x20'+_0x47da00['currency']+'*\x0a')+(_0x203e47(0x196)+(_0x47da00[_0x203e47(0x138)]||_0x47da00['id'])+'`\x0a')+(_0x203e47(0x1ee)+_0x47da00['id']+'`\x0a')+(_0x203e47(0x171)+_0x382d3a+'`\x0a')+(_0x203e47(0x1bf)+new Date(_0x47da00['createdAt'])[_0x203e47(0x12e)](_0x203e47(0x1ac))+'\x0a');(_0x47da00[_0x203e47(0x1d8)]||_0x47da00[_0x203e47(0x1c2)])&&(_0x483cdd+='\x0a👤\x20*Customer\x20Information:*\x0a',_0x47da00[_0x203e47(0x1d8)]&&(_0x483cdd+=_0x203e47(0x1ae)+_0x47da00[_0x203e47(0x1d8)]+'`\x0a'),_0x47da00[_0x203e47(0x1c2)]&&(_0x483cdd+='📧\x20Email:\x20`'+_0x47da00[_0x203e47(0x1c2)]+'`\x0a')),_0x16f756===_0x203e47(0x177)&&_0x47da00[_0x203e47(0x193)]&&(_0x483cdd+=_0x203e47(0x159)+_0x47da00[_0x203e47(0x193)]+_0x203e47(0x176)),_0x16f756===_0x203e47(0x151)&&(_0x483cdd+=_0x203e47(0x1a4)),_0x47da00[_0x203e47(0x199)]&&(_0x483cdd+='📝\x20Notes:\x20'+_0x47da00[_0x203e47(0x199)]+'\x0a'),await this[_0x203e47(0x127)](_0x24fd1f,_0x483cdd,{'parse_mode':'Markdown'});}async[a49_0x5d613a(0x154)](_0x252091,_0x2277c4,_0x3c9256){const _0x472d95=a49_0x5d613a,_0x35525a={'created':'📤','completed':'✅','rejected':'❌'},_0x1084ac={'created':_0x472d95(0x17e),'completed':_0x472d95(0x1e7),'rejected':_0x472d95(0x1aa)},_0x275a74=_0x35525a[_0x3c9256],_0x83693c=_0x1084ac[_0x3c9256],_0x39f017=_0x275a74+'\x20*'+_0x83693c+_0x472d95(0x120)+('💸\x20Amount:\x20*'+_0x2277c4[_0x472d95(0x1d5)]+_0x472d95(0x157))+(_0x472d95(0x14c)+_0x2277c4[_0x472d95(0x1b2)]+'`\x0a')+(_0x472d95(0x1f7)+_0x2277c4['id']+'`\x0a')+(_0x472d95(0x1bf)+new Date(_0x2277c4[_0x472d95(0x175)])['toLocaleString'](_0x472d95(0x1ac))+'\x0a')+(_0x2277c4[_0x472d95(0x197)]?_0x472d95(0x172)+_0x2277c4[_0x472d95(0x197)]+'`':'');await this[_0x472d95(0x127)](_0x252091,_0x39f017,{'parse_mode':'Markdown'});}async[a49_0x5d613a(0x1f1)](_0x2d356b,_0x606bf1){const _0x12ed29=a49_0x5d613a;try{const _0x533cad=await database_1[_0x12ed29(0x140)]['shopSettings']['findUnique']({'where':{'shopId':_0x2d356b},'select':{'notificationLogin':!![]}});if(!_0x533cad?.[_0x12ed29(0x1c0)]){console[_0x12ed29(0x167)]('📱\x20Login\x20notifications\x20disabled\x20for\x20shop\x20'+_0x2d356b);return;}const _0x448cfc=_0x606bf1[_0x12ed29(0x1f4)]?'🔐':'🚨',_0x30d8cd=_0x606bf1[_0x12ed29(0x1f4)]?_0x12ed29(0x1f0):_0x12ed29(0x1c3);let _0x15096c=_0x448cfc+'\x20*'+_0x30d8cd+_0x12ed29(0x120)+(_0x12ed29(0x1b1)+_0x606bf1[_0x12ed29(0x1c5)]+'`\x0a')+('📅\x20Time:\x20'+_0x606bf1[_0x12ed29(0x16b)][_0x12ed29(0x12e)]('en-US')+'\x0a');_0x606bf1[_0x12ed29(0x1b6)]&&(_0x15096c+=_0x12ed29(0x1f5)+_0x606bf1['ipAddress']+'`\x0a');if(_0x606bf1[_0x12ed29(0x1b3)]){const _0x41e02e=_0x606bf1['userAgent'][_0x12ed29(0x1fa)]>0x32?_0x606bf1[_0x12ed29(0x1b3)]['substring'](0x0,0x32)+_0x12ed29(0x19b):_0x606bf1[_0x12ed29(0x1b3)];_0x15096c+=_0x12ed29(0x181)+_0x41e02e+'`\x0a';}!_0x606bf1['success']&&(_0x15096c+=_0x12ed29(0x13d)),await this[_0x12ed29(0x127)](_0x2d356b,_0x15096c,{'parse_mode':_0x12ed29(0x1ef)}),console['log'](_0x12ed29(0x183)+_0x2d356b+':\x20'+(_0x606bf1[_0x12ed29(0x1f4)]?_0x12ed29(0x1f4):_0x12ed29(0x12c)));}catch(_0x2c0275){console['error'](_0x12ed29(0x1f8),_0x2c0275);}}async[a49_0x5d613a(0x17a)](_0x5f4476,_0x5b1324){const _0x3a443f=a49_0x5d613a;try{const _0x2ad347=await database_1[_0x3a443f(0x140)][_0x3a443f(0x1c7)]['findUnique']({'where':{'shopId':_0x5f4476},'select':{'notificationApiError':!![]}});if(!_0x2ad347?.[_0x3a443f(0x1f3)]){console[_0x3a443f(0x167)]('📱\x20API\x20error\x20notifications\x20disabled\x20for\x20shop\x20'+_0x5f4476);return;}let _0x43464e='🚨\x20*API\x20Error*\x0a\x0a'+(_0x3a443f(0x131)+_0x5b1324[_0x3a443f(0x1b2)]+'\x20'+_0x5b1324[_0x3a443f(0x149)]+'`\x0a')+(_0x3a443f(0x1fc)+_0x5b1324[_0x3a443f(0x16b)][_0x3a443f(0x12e)](_0x3a443f(0x1ac))+'\x0a');_0x5b1324[_0x3a443f(0x1dc)]&&(_0x43464e+=_0x3a443f(0x1e3)+_0x5b1324['statusCode']+'`\x0a'),_0x43464e+='❌\x20Error:\x20`'+_0x5b1324[_0x3a443f(0x1e4)]+'`\x0a',_0x5b1324[_0x3a443f(0x1ed)]&&(_0x43464e+=_0x3a443f(0x1a0)+_0x5b1324[_0x3a443f(0x1ed)]+'`\x0a'),_0x43464e+=_0x3a443f(0x18e),await this[_0x3a443f(0x127)](_0x5f4476,_0x43464e,{'parse_mode':'Markdown'}),console[_0x3a443f(0x167)](_0x3a443f(0x1be)+_0x5f4476+':\x20'+_0x5b1324[_0x3a443f(0x149)]);}catch(_0x21f37c){console['error'](_0x3a443f(0x155),_0x21f37c);}}async['sendCustomNotification'](_0x4eb118,_0x24b27c,_0x32787d){const _0x4b4452=a49_0x5d613a;let _0x43f5bc=_0x4b4452(0x15a)+_0x24b27c+_0x4b4452(0x120);for(const [_0x763335,_0x49c2b3]of Object[_0x4b4452(0x18a)](_0x32787d)){_0x49c2b3!==null&&_0x49c2b3!==undefined&&(_0x43f5bc+=_0x763335+':\x20`'+_0x49c2b3+'`\x0a');}await this[_0x4b4452(0x127)](_0x4eb118,_0x43f5bc,{'parse_mode':'Markdown'});}[a49_0x5d613a(0x144)](){const _0x46fd94=a49_0x5d613a;return{'isActive':!!this[_0x46fd94(0x16d)],'username':this[_0x46fd94(0x124)]};}[a49_0x5d613a(0x1a7)](){const _0x2a8122=a49_0x5d613a;this[_0x2a8122(0x16d)]&&(this[_0x2a8122(0x16d)]['stopPolling'](),this[_0x2a8122(0x16d)]=null,console[_0x2a8122(0x167)]('🛑\x20Telegram\x20bot\x20stopped'));}}function a49_0x77d2(){const _0x470f3b=['❌\x20API\x20key\x20does\x20not\x20match\x20shop\x20`','default','TELEGRAM_BOT_TOKEN\x20not\x20found\x20in\x20environment\x20variables','setupBotHandlers','Payment\x20successfully\x20paid','getBotInfo','🔄\x20Processing\x20single-line\x20verification\x20for\x20user\x20','Payment\x20is\x20being\x20processed','97784FrCEzK','telegramId','endpoint','❗️\x20Make\x20sure\x20to\x20separate\x20username\x20and\x20API\x20key\x20with\x20a\x20space!','You\x20are\x20already\x20connected\x20to\x20shop:\x20*','🏦\x20Method:\x20`','from','shop','findMany','/status\x20-\x20check\x20connection\x20status\x0a','processing','\x0aCheck\x20spelling\x20and\x20try\x20again.','last_name','sendPayoutNotification','Failed\x20to\x20send\x20API\x20error\x20notification:','`.\x0a\x0a','\x20USD*\x0a','node-telegram-bot-api','💸\x20Penalty\x20amount:\x20*','🔔\x20*','💰\x20Amount:\x20*','.\x20*','Payment\x20failed','trim','../config/database','•\x20New\x20payments\x0a','To\x20reconnect,\x20use\x20the\x20/start\x20command','✅\x20Welcome\x20back!\x0a\x0a','__esModule','env','756KnLroN','TELEGRAM_BOT_TOKEN','log','To\x20receive\x20payment\x20notifications,\x20send\x20your\x20credentials\x20in\x20one\x20line:\x0a\x0a',':\x20username=\x22','\x22\x20->\x20display\x20\x22','timestamp','polling_error','bot','\x20\x20\x20Public\x20Key:\x20`','onText','name','🏪\x20Gateway:\x20`','🔗\x20TXID:\x20`','Error\x20handling\x20/status\x20command:','includes','createdAt','\x20USDT*\x0a','chargeback','📱\x20Your\x20Telegram\x20ID:\x20`','Available\x20usernames:\x0a','sendApiErrorNotification','Error\x20handling\x20message:','Error\x20handling\x20/debug\x20command:','\x22,\x20apiKey=\x22','New\x20payout\x20created','🔍\x20*Debug\x20Information*\x0a\x0a','`\x0a\x0a','💻\x20Browser:\x20`','API\x20key\x20must\x20start\x20with\x20`pk\x5c_`\x20or\x20`sk\x5c_`.','✅\x20Login\x20notification\x20sent\x20for\x20shop\x20','Error\x20handling\x20/disconnect\x20command:','create','unknown\x20shop','allSettled','35608200MDLmpf','🔔\x20Notifications\x20are\x20active\x0a\x0a','entries','findUnique','❌\x20Please\x20use\x20/start\x20command\x20first','📱\x20Shop:\x20*','\x0a💡\x20Check\x20your\x20request\x20or\x20contact\x20support.','telegramUser','TELEGRAM_BOT_USERNAME','`appple\x20pk_aa6450d3f57afbefbb0f3f5be5ce6cca13037536afc5ccf14c81a6cbc7a07de5`\x0a\x0a','No\x20verified\x20Telegram\x20users\x20found\x20for\x20shop\x20','chargebackAmount','gateway','split','📝\x20Order\x20ID:\x20`','txid','Commands:\x0a','adminNotes','error','...','telegramBotService','🔌\x20User\x20','📝\x20Format:\x20`username\x20api_key`\x0a\x0a','257463xnICFL','🆔\x20Request\x20ID:\x20`','...\x22','toString','❌\x20Another\x20Telegram\x20account\x20is\x20already\x20connected\x20to\x20shop\x20`','⏳\x20The\x20payment\x20is\x20currently\x20being\x20processed\x20by\x20the\x20gateway.\x0a','🔔\x20You\x20receive\x20notifications\x20about:\x0a','•\x20`','stopBot','text','66531DlszEO','Payout\x20rejected','1222942HycmCJ','en-US','Example:\x0a','📛\x20Name:\x20`','Username:\x20`','startsWith','👤\x20Username:\x20`','method','userAgent','getGatewayDisplayNameForTelegram','Error\x20sending\x20shop\x20notification:','ipAddress','__importDefault','user\x20is\x20deactivated','❌\x20You\x20are\x20not\x20connected\x20to\x20a\x20shop.\x0a\x0a','first_name','Payment\x20expired','94jFWdtr','\x20\x20\x20Username:\x20`','✅\x20API\x20error\x20notification\x20sent\x20for\x20shop\x20','📅\x20Date:\x20','notificationLogin','🎉\x20*Congratulations!*\x0a\x0a','customerEmail','Failed\x20login\x20attempt','initializeBot','username','chat','shopSettings','Check\x20spelling\x20and\x20try\x20again.','✅\x20Connected\x20to\x20shop:\x20*','status','❌\x20Invalid\x20API\x20key\x20format.\x0a\x0a','publicKey','❌\x20Invalid\x20format.\x20Please\x20send\x20exactly\x202\x20parts\x20separated\x20by\x20space:\x0a\x0a','isVerified','✅\x20Telegram\x20user\x20','Error\x20in\x20handleSingleLineVerification:','update','trapay_bot','chat\x20not\x20found','❌\x20Failed\x20to\x20initialize\x20Telegram\x20bot:','amount','🔄\x20Reset\x20incomplete\x20verification\x20for\x20user\x20','ACTIVE','customerName','❌\x20An\x20error\x20occurred\x20while\x20verifying\x20data.','/disconnect\x20-\x20disconnect\x20from\x20notifications','❌\x20Shop\x20`','statusCode','TelegramBotService','•\x20Payment\x20status\x20changes\x0a','defineProperty','substring','1044786AUFAOh','\x20\x20\x20Status:\x20','📊\x20Error\x20code:\x20`','errorMessage','map','5DErHgx','Payout\x20completed','blocked','Disconnect\x20the\x20previous\x20account\x20first\x20or\x20contact\x20administrator.','sk_','🔔\x20You\x20will\x20now\x20receive\x20notifications\x20about:\x0a','\x20parts:\x20','requestId','🆔\x20Payment\x20ID:\x20`','Markdown','Successful\x20login','sendLoginNotification','🤖\x20Welcome\x20to\x20TRAPAY\x20notification\x20system!\x0a\x0a','notificationApiError','success','🌐\x20IP\x20address:\x20`','*.\x0a\x0a','🆔\x20Payout\x20ID:\x20`','Failed\x20to\x20send\x20login\x20notification:','Contact\x20administrator.','length','Username\x20must\x20contain\x20only\x20letters,\x20numbers\x20and\x20underscore\x20(3-50\x20characters).','📅\x20Time:\x20','❌\x20An\x20error\x20occurred.\x20Please\x20try\x20again\x20later.','•\x20Payouts\x0a','•\x20Payouts\x0a\x0a','updatedAt','Use\x20/status\x20to\x20check\x20status\x20or\x20/disconnect\x20to\x20disconnect.','3645356IzQFZd','warn','*\x0a\x0a','📱\x20Telegram\x20notification:\x20gateway\x20\x22','🏪\x20Available\x20shops\x20in\x20system:\x0a','Payment\x20refund','botUsername','✅\x20Notification\x20sent\x20to\x20Telegram\x20user\x20','sendMessage','sendShopNotification','shopId','\x20via\x20single-line\x20input','Use\x20/start\x20to\x20connect.','❌\x20You\x20are\x20not\x20connected\x20to\x20the\x20notification\x20system.','failed','Expected\x20key\x20format:\x20`pk_...`\x20or\x20`sk_...`','toLocaleString','message','secretKey','🔗\x20Endpoint:\x20`','New\x20payment\x20created','botToken','Telegram\x20bot\x20polling\x20error:','✅\x20You\x20have\x20been\x20successfully\x20disconnected\x20from\x20shop\x20*','...`\x0a\x0a','test','orderId','Telegram\x20bot\x20error:','join','❌\x20Invalid\x20username\x20format:\x20`','✅\x20You\x20have\x20been\x20successfully\x20connected\x20to\x20the\x20notification\x20system!\x0a\x0a','\x0a⚠️\x20If\x20this\x20wasn\x27t\x20you,\x20change\x20your\x20password\x20immediately!','forEach'];a49_0x77d2=function(){return _0x470f3b;};return a49_0x77d2();}exports['TelegramBotService']=TelegramBotService,exports[a49_0x5d613a(0x19c)]=new TelegramBotService();