'use strict';const a87_0x22bfde=a87_0x35a0;(function(_0x2db3d8,_0x290846){const _0xb07bdb=a87_0x35a0,_0x16f8b2=_0x2db3d8();while(!![]){try{const _0x4c6eab=parseInt(_0xb07bdb(0xb3))/0x1+parseInt(_0xb07bdb(0xd6))/0x2*(parseInt(_0xb07bdb(0x196))/0x3)+-parseInt(_0xb07bdb(0x1df))/0x4*(-parseInt(_0xb07bdb(0x9d))/0x5)+parseInt(_0xb07bdb(0xd9))/0x6+parseInt(_0xb07bdb(0x1d9))/0x7+-parseInt(_0xb07bdb(0x81))/0x8+-parseInt(_0xb07bdb(0x12b))/0x9;if(_0x4c6eab===_0x290846)break;else _0x16f8b2['push'](_0x16f8b2['shift']());}catch(_0x550bac){_0x16f8b2['push'](_0x16f8b2['shift']());}}}(a87_0xfa9a,0x27951));var __importDefault=this&&this[a87_0x22bfde(0x1b5)]||function(_0x27b327){const _0x324729=a87_0x22bfde;return _0x27b327&&_0x27b327[_0x324729(0x13d)]?_0x27b327:{'default':_0x27b327};};function a87_0xfa9a(){const _0x18e461=['pl_view_list','totalPaidOut','balance','‚ùå\x20Error:\x20`','üåç\x20Country:\x20','Make\x20sure\x20you\x20have\x20the\x20correct\x20username\x20from\x20your\x20account.','üì±\x20No\x20active\x20Telegram\x20users\x20found','N/A','ACTIVE','‚úÖ\x20Telegram\x20bot\x20@','INR','‚ùå\x20An\x20error\x20occurred.\x20Please\x20try\x20again\x20later.','/payouts\x20-\x20view\x20recent\x20payouts\x0a','\x20USDT*\x0a','GBP','success','üìä\x20Error\x20code:\x20`','\x20USDC','üë§\x20Account:\x20https://app.trapay.uk/login\x0a','cmd_contacts','üì±\x20Login\x20notifications\x20disabled\x20for\x20shop\x20','reduce','Step\x204/4:\x20Enter\x20amount\x0a\x0a','Successful\x20login','`\x0a\x0a','filter','üì±\x20Sending\x20notification\x20to\x20all\x20connected\x20users:\x20','delete','Use\x20/status\x20to\x20check\x20status\x20or\x20/disconnect\x20to\x20disconnect.','sendShopFile','0.0','üéâ\x20*Congratulations!*\x0a\x0a','botUsername','üì±\x20Your\x20Telegram\x20ID:\x20`','adminNotes','‚ùå\x20You\x20are\x20not\x20connected\x20to\x20a\x20shop.\x0a\x0aUse\x20/start\x20to\x20connect.',':\x20username=\x22','3012yjFdRa','getGatewayCurrencies','Error\x20handling\x20/contacts\x20command:','üîî\x20You\x20will\x20now\x20receive\x20notifications\x20about:\x0a','Failed\x20login\x20attempt','../types/gateway','numeric','defineProperty','üîå\x20User\x20','üíµ\x20Earned\x20-\x20','PLN','cmd_payouts','all','paymentLinkSessions','‚Ä¢\x20Active\x20payment\x20links\x0a','‚ùå\x20Close','AED','toLocaleDateString','‚Ä¢\x20Payment\x20status\x20changes\x0a','https://app.trapay.uk','‚úÖ\x20You\x20have\x20been\x20successfully\x20disconnected\x20from\x20shop\x20*','GATEWAY_ID_MAP','üåê\x20Website:\x20https://trapay.uk/\x0a','...\x22','‚ùå\x20You\x20are\x20not\x20connected\x20to\x20a\x20shop.\x0a\x0a','Contact\x20administrator.','toUpperCase','cmd_statistics','/disconnect\x20-\x20disconnect\x20from\x20notifications','.jpeg','count','__importDefault','botToken','‚ùå\x20Shop\x20not\x20found.','image/png','üìÖ\x20Time:\x20','statusCode','showPaymentLinksList','TRY','Error\x20handling\x20/debug\x20command:','getDate','üìù\x20Order\x20ID:\x20`','JPY','length','setupBotHandlers','status','Error\x20in\x20payment\x20link\x20flow:','default','üíª\x20Browser:\x20`','üí¨\x20Support:\x20https://t.me/trapay\x5c_sales','‚ùå\x20Error\x20sending\x20file\x20to\x20user\x20','‚úÖ\x20File\x20sent\x20to\x20','Step\x203/4:\x20Select\x20currency','split','desc','message_id','üí∏\x20*Payouts*\x0a\x0a','üìã\x20View\x20Payment\x20Links','chargebackAmount','sendMessage','üåê\x20IP:\x20`','cmd_disconnect','amount','NOK','Example:\x0a','Please\x20send\x20the\x20amount\x20in\x20','‚Ä¢\x20New\x20payments\x0a','974771KjUtKW','Use\x20/start\x20to\x20connect\x20to\x20a\x20shop.','pl_','üìã\x20*Payment\x20Links*\x20\x5c(Page\x20','message','unknown\x20shop','284YXCNXj','‚ùå\x20You\x20are\x20not\x20connected\x20to\x20the\x20notification\x20system.','first_name','‚úÖ\x20Connected\x20to\x20shop:\x20*','/link/','API\x20key\x20must\x20start\x20with\x20`pk\x5c_`\x20or\x20`sk\x5c_`.','‚ùå\x20Cancelled.','üí∏\x20Payouts','txid','createdAt','‚ùå\x20Maximum\x20number\x20of\x20connected\x20accounts\x20(5)\x20reached\x20for\x20shop\x20`','Error\x20handling\x20callback\x20query:','‚ùå\x20An\x20error\x20occurred\x20while\x20verifying\x20data.','cmd_payment_links','customerIp','pl_curr_','\x20via\x20single-line\x20input','üõë\x20Telegram\x20bot\x20stopped','period','üîó\x20*Payment\x20Links*\x0a\x0aChoose\x20an\x20action:','from','bot','\x20USDC\x0a','\x20marked\x20as\x20unverified\x20due\x20to\x20delivery\x20failure','‚úÖ\x20Successful\x20payments\x20-\x20','AUD','sendNotificationToAll','üîå\x20Disconnect','\x20\x20\x20Name:\x20*','üì±\x20Notification\x20sent\x20to\x20','sendDocument','\x20\x20\x20[LINK](','update','setDate','shopId','toFixed','User\x20','customerName','callback_query','‚úÖ\x20Login\x20notification\x20sent\x20for\x20shop\x20','pk_','findMany','gateway','USDT','substring','remitterIban','üí∞\x20Amount:\x20','üîÑ\x20Type:\x20',')\x0a\x0a','‚úÖ\x20Direct\x20message\x20sent\x20to\x20chat\x20','‚ùå\x20Failed\x20to\x20send\x20message\x20to\x20user\x20','sendShopNotification','Copy\x20and\x20share\x20this\x20link\x20with\x20your\x20customers\x5c!','üì±\x20Created\x20new\x20Telegram\x20user:\x20','1842552OvGcut','‚Ä¢\x20Total\x20revenue\x0a','pl_gw_','‚ùå\x20No\x20verified\x20Telegram\x20users\x20found\x20for\x20shop\x20ID:\x20','‚ùå\x20Unknown\x20command','onText','Payment\x20expired','üìÖ\x20Date:\x20','USDC','You\x20sent\x20','endpoint','\x0aüë§\x20*Customer\x20Information:*\x0a','‚Ä¢\x20Payouts','CAD','üîó\x20Payment\x20Links','map','üìÖ\x20Connection\x20date:\x20','üìä\x20*Statistics*\x0a\x0a','pl_type_multi','Step\x202/4:\x20Select\x20link\x20type','customerUa','DOGE','includes','‚ùå\x20Invalid\x20API\x20key\x20format.\x0a\x0a','entries','\x20\x20\x20Gateway:\x20','‚Ä¢\x20Last\x205\x20payouts\x0a','`\x20not\x20found.\x0a\x0a','3140PwWWsO','Error\x20handling\x20/status\x20command:','en-US','‚úÖ\x20File\x20sent\x20to\x20chat\x20','processing','\x20verified\x20for\x20shop\x20','\x22\x20->\x20display\x20\x22','network','MarkdownV2','‚ùå\x20You\x20are\x20not\x20connected\x20to\x20any\x20shop.\x0a\x0a','üìä\x20*Today\x27s\x20Statistics\x20|\x20','chargeback','Payment\x20chargeback','üìû\x20Contacts','New\x20payment\x20created','Error\x20handling\x20/start\x20command:','handlePaymentLinkFlow','.jpg','üè™\x20Gateway:\x20`','‚ùå\x20Shop\x20with\x20username\x20`','üîî\x20*','trim','107466feDTqP','stopPolling','create','failed','Telegram\x20bot\x20polling\x20error:','data','push','NZD','step','isVerified','findUnique','Markdown','Telegram\x20bot\x20not\x20initialized,\x20cannot\x20send\x20notification','üìù\x20Format:\x20`username\x20api_key`\x0a\x0a','üì¢\x20Telegram\x20channel:\x20https://t.me/trapay\x5c_news\x0a','\x0aüí°\x20Check\x20your\x20request\x20or\x20contact\x20support.','‚ùå\x20An\x20error\x20occurred\x20while\x20loading\x20payment\x20links.','replace','Telegram\x20bot\x20error:','find','\x20\x20\x20Username:\x20`','No\x20verified\x20Telegram\x20users\x20found\x20for\x20shop\x20','Unknown','chat','üìä\x20Status','editMessageText','üí∞\x20*Amount:*\x20','Disconnect\x20one\x20of\x20the\x20existing\x20accounts\x20first.','.png','‚ùå\x20Failed\x20to\x20send\x20notification\x20to\x20all\x20users:','requestId','\x20\x5c|\x20Type:\x20','geo','.pdf','üîó\x20Link:\x20','194qxphKl','‚úÖ\x20*Payment\x20Link\x20Created\x20Successfully\x5c!*\x0a\x0a','answerCallbackQuery','1728810BzOMhZ','Payment\x20is\x20being\x20processed',':\x20`','get','Please\x20check\x20the\x20spelling\x20and\x20try\x20again.\x0a\x0a','REFUND','LTC','Error\x20handling\x20message:','‚ùå\x20Error\x20getting\x20debug\x20information.','log','userAgent','payment','wallet','error','‚ùå\x20Shop\x20`','üë§\x20Username:\x20`','sendCustomNotification','parse','Error\x20handling\x20/disconnect\x20command:','Payment\x20failed','Use\x20/start\x20to\x20connect.','üÜî\x20Request\x20ID:\x20`','\x5c)\x0a\x0a','pl_page_','telegramUser','üí≥\x20*Wallet:*\x20`','CHARGEBACK','telegramBotService','‚ùå\x20Failed\x20to\x20send\x20notification\x20to\x20Telegram\x20user\x20','/payment\x5c_links\x20-\x20manage\x20payment\x20links\x0a','Not\x20specified','ETH','‚Ä¢\x20Quick\x20create\x20new\x20link\x0a','type','commission','*.\x0a\x0a','‚Ä¢\x20Payouts\x0a','‚ùå\x20Invalid\x20amount.\x20Please\x20enter\x20a\x20valid\x20number\x20greater\x20than\x200.','‚úÖ\x20Notification\x20sent\x20to\x20Telegram\x20user\x20','set','application/octet-stream','üö®\x20*API\x20Error*\x0a\x0a','2-digit','‚ùå\x20Cancel','USD','‚ôæÔ∏è\x20Multi\x20Use','‚úÖ\x20You\x20are\x20already\x20connected\x20to\x20shop\x20*','‚ùå\x20Error\x20sending\x20file\x20to\x20chat:','üí∞\x20Total\x20earned:\x20','*\x0a\x0a','`\x20is\x20inactive.\x0a\x0a','customerEmail','sendPayoutNotification','üè¶\x20Gateway:\x20','‚ùå\x20Failed\x20to\x20initialize\x20Telegram\x20bot:','\x20\x20\x20Status:\x20','Error\x20handling\x20/payment_links\x20command:','sendApiErrorNotification','‚ùå\x20Invalid\x20format.\x20Please\x20send\x20exactly\x202\x20parts\x20separated\x20by\x20space:\x0a\x0a','shopSettings','image/jpeg','üì±\x20API\x20error\x20notifications\x20disabled\x20for\x20shop\x20','/statistics\x20-\x20view\x20your\x20statistics\x0a','orderId','sendDirectMessage','CHF','publicKey','‚ùå\x20Shop\x20not\x20found.\x20Please\x20start\x20over\x20with\x20/start','‚ùå\x20Telegram\x20bot\x20not\x20initialized','‚¨ÖÔ∏è\x20Previous','endsWith','üîî\x20Notifications\x20are\x20active\x0a\x0a','‚úÖ\x20Welcome\x20back!\x0a\x0a','ü§ñ\x20Welcome\x20to\x20TRAPAY\x20notification\x20system!\x0a\x0a','`.\x0a\x0a','Username:\x20`','FAILED','üìã\x20*Payment\x20Links*\x0a\x0aNo\x20payment\x20links\x20found\x5c.\x0a\x0aCreate\x20your\x20first\x20payment\x20link\x5c!','currency','üåê\x20*Network:*\x20','To\x20receive\x20payment\x20notifications,\x20send\x20your\x20credentials\x20in\x20one\x20line:\x0a\x0a','username','2559438yfTdVy','application/pdf','\x0a‚ö†Ô∏è\x20If\x20this\x20wasn\x27t\x20you,\x20change\x20your\x20password\x20immediately!','‚ûï\x20Create\x20New\x20Link','toString','forEach','user\x20is\x20deactivated','‚Ä¢\x20Transaction\x20status\x0a','blocked','‚úÖ\x20API\x20error\x20notification\x20sent\x20for\x20shop\x20','handleSingleLineVerification','Error\x20in\x20handleSingleLineVerification:','initializeBot','This\x20feature\x20will\x20show:\x0a','pl_type_','payout','‚ùå\x20Failed\x20payments\x20-\x20','...','__esModule','To\x20reconnect,\x20use\x20the\x20/start\x20command','timestamp','üí∏\x20Penalty\x20amount:\x20*','TRX','‚Ä¢\x20Gateway\x20performance','keys','üîî\x20Notifications\x20are\x20active','allSettled','sendPaymentNotification','‚ùå\x20Please\x20use\x20/start\x20command\x20first','PENDING','üîÑ\x20Processing\x20single-line\x20verification\x20for\x20user\x20','paymentLink','\x20disconnected\x20from\x20shop\x20','shop','üåê\x20IP\x20address:\x20`','name','\x20(@','Coming\x20soon...\x0a\x0a','EUR','üì±\x20Telegram\x20notification:\x20gateway\x20\x22','‚è±Ô∏è\x20*Period:*\x20','sk_','ipAddress','‚úÖ\x20You\x20have\x20been\x20successfully\x20connected\x20to\x20the\x20notification\x20system!\x0a\x0a','cmd_status','üÜî\x20Payment\x20ID:\x20`','COMPLETED','slice','\x20parts:\x20','Payment\x20successfully\x20paid','\x20initialized\x20successfully','Gateway\x20-\x20','Payment\x20refund','startsWith','\x20(e.g.,\x20100)','chat\x20not\x20found','`appple\x20pk_aa6450d3f57afbefbb0f3f5be5ce6cca13037536afc5ccf14c81a6cbc7a07de5`\x0a\x0a','‚ùå\x20No\x20gateways\x20configured.\x20Please\x20configure\x20gateways\x20in\x20the\x20admin\x20panel\x20first.','Multi\x20Use','telegramId','SINGLE','pl_cancel','toLocaleString','üìä\x20*Connection\x20Status*\x0a\x0a','pl_create_new','updatedAt','Next\x20‚û°Ô∏è','üîó\x20*Payment\x20Links*\x0a\x0a','paymentGateways','Error\x20sending\x20shop\x20notification:'];a87_0xfa9a=function(){return _0x18e461;};return a87_0xfa9a();}function a87_0x35a0(_0x1ebc25,_0x436bd){_0x1ebc25=_0x1ebc25-0x78;const _0xfa9af=a87_0xfa9a();let _0x35a0e4=_0xfa9af[_0x1ebc25];return _0x35a0e4;}Object[a87_0x22bfde(0x19d)](exports,'__esModule',{'value':!![]}),exports[a87_0x22bfde(0xf4)]=exports['TelegramBotService']=void 0x0;const node_telegram_bot_api_1=__importDefault(require('node-telegram-bot-api')),database_1=__importDefault(require('../config/database')),gateway_1=require(a87_0x22bfde(0x19b));class TelegramBotService{constructor(){const _0x3ce02d=a87_0x22bfde;this[_0x3ce02d(0x1f4)]=null,this[_0x3ce02d(0x1a3)]=new Map(),this[_0x3ce02d(0x1b6)]=process.env.TELEGRAM_BOT_TOKEN||'',this['botUsername']=process.env.TELEGRAM_BOT_USERNAME||'trapay_bot',this[_0x3ce02d(0x1b6)]?this['initializeBot']():console['warn']('TELEGRAM_BOT_TOKEN\x20not\x20found\x20in\x20environment\x20variables');}[a87_0x22bfde(0x137)](){const _0x316f70=a87_0x22bfde;try{this['bot']=new node_telegram_bot_api_1[(_0x316f70(0x1c5))](this['botToken'],{'polling':!![]}),this[_0x316f70(0x1c2)](),console[_0x316f70(0xe2)](_0x316f70(0x17a)+this[_0x316f70(0x191)]+_0x316f70(0x15d));}catch(_0x1e60d6){console[_0x316f70(0xe6)](_0x316f70(0x10f),_0x1e60d6);}}[a87_0x22bfde(0x1c2)](){const _0x1ecbdf=a87_0x22bfde;if(!this[_0x1ecbdf(0x1f4)])return;this[_0x1ecbdf(0x1f4)]['onText'](/\/start/,async _0x52f5b0=>{const _0x138ec8=_0x1ecbdf,_0x7c600c=_0x52f5b0[_0x138ec8(0xca)]['id'],_0xbaacb=_0x52f5b0[_0x138ec8(0x1f3)]?.['id']['toString'](),_0x475465=_0x52f5b0['from']?.['username'],_0x3bafa1=_0x52f5b0[_0x138ec8(0x1f3)]?.[_0x138ec8(0x1e1)],_0x525904=_0x52f5b0[_0x138ec8(0x1f3)]?.['last_name'];if(!_0xbaacb)return;try{let _0x3c4cb1=await database_1[_0x138ec8(0x1c5)]['telegramUser']['findUnique']({'where':{'telegramId':_0xbaacb},'include':{'shop':!![]}});!_0x3c4cb1?(_0x3c4cb1=await database_1[_0x138ec8(0x1c5)][_0x138ec8(0xf1)]['create']({'data':{'telegramId':_0xbaacb,'username':_0x475465,'firstName':_0x3bafa1,'lastName':_0x525904,'isVerified':![],'shopId':null},'include':{'shop':!![]}}),console[_0x138ec8(0xe2)](_0x138ec8(0x80)+_0xbaacb+_0x138ec8(0x14f)+_0x475465+')')):_0x3c4cb1=await database_1[_0x138ec8(0x1c5)][_0x138ec8(0xf1)]['update']({'where':{'telegramId':_0xbaacb},'data':{'username':_0x475465,'firstName':_0x3bafa1,'lastName':_0x525904},'include':{'shop':!![]}}),_0x3c4cb1[_0x138ec8(0xbc)]&&_0x3c4cb1[_0x138ec8(0x201)]&&_0x3c4cb1[_0x138ec8(0x14c)]?await this['bot']?.[_0x138ec8(0x1d1)](_0x7c600c,_0x138ec8(0x121)+('You\x20are\x20already\x20connected\x20to\x20shop:\x20*'+_0x3c4cb1[_0x138ec8(0x14c)][_0x138ec8(0x14e)]+'*\x0a')+(_0x138ec8(0x124)+_0x3c4cb1['shop'][_0x138ec8(0x12a)]+_0x138ec8(0x189))+'üîî\x20You\x20receive\x20notifications\x20about:\x0a'+_0x138ec8(0x1d8)+_0x138ec8(0x1a8)+_0x138ec8(0x8d),{'parse_mode':_0x138ec8(0xbe),'reply_markup':{'inline_keyboard':[[{'text':'üìä\x20Statistics','callback_data':'cmd_statistics'},{'text':'üí∏\x20Payouts','callback_data':_0x138ec8(0x1a1)}],[{'text':_0x138ec8(0x8f),'callback_data':_0x138ec8(0x1ec)},{'text':_0x138ec8(0xcb),'callback_data':'cmd_status'}],[{'text':_0x138ec8(0xaa),'callback_data':'cmd_contacts'},{'text':_0x138ec8(0x1fa),'callback_data':_0x138ec8(0x1d3)}]]}}):(_0x3c4cb1[_0x138ec8(0x201)]&&!_0x3c4cb1['isVerified']&&(await database_1[_0x138ec8(0x1c5)]['telegramUser'][_0x138ec8(0x1ff)]({'where':{'telegramId':_0xbaacb},'data':{'shopId':null,'isVerified':![]}}),console[_0x138ec8(0xe2)]('üîÑ\x20Reset\x20incomplete\x20verification\x20for\x20user\x20'+_0xbaacb)),await this[_0x138ec8(0x1f4)]?.[_0x138ec8(0x1d1)](_0x7c600c,_0x138ec8(0x122)+_0x138ec8(0x129)+_0x138ec8(0xc0)+_0x138ec8(0x1d6)+_0x138ec8(0x163)+'‚ùóÔ∏è\x20Make\x20sure\x20to\x20separate\x20username\x20and\x20API\x20key\x20with\x20a\x20space!',{'parse_mode':_0x138ec8(0xbe)}));}catch(_0x297983){console[_0x138ec8(0xe6)](_0x138ec8(0xac),_0x297983),await this['bot']?.[_0x138ec8(0x1d1)](_0x7c600c,_0x138ec8(0x17c));}}),this[_0x1ecbdf(0x1f4)][_0x1ecbdf(0x86)](/\/disconnect/,async _0x4f31a1=>{const _0x18a82f=_0x1ecbdf,_0x5f2eef=_0x4f31a1['chat']['id'],_0x1a1dc1=_0x4f31a1[_0x18a82f(0x1f3)]?.['id']['toString']();if(!_0x1a1dc1)return;try{const _0x460585=await database_1[_0x18a82f(0x1c5)][_0x18a82f(0xf1)][_0x18a82f(0xbd)]({'where':{'telegramId':_0x1a1dc1},'include':{'shop':!![]}});if(!_0x460585||!_0x460585[_0x18a82f(0xbc)]||!_0x460585[_0x18a82f(0x201)]){await this[_0x18a82f(0x1f4)]?.[_0x18a82f(0x1d1)](_0x5f2eef,_0x18a82f(0x1e0));return;}const _0x46764e=_0x460585['shop']?.[_0x18a82f(0x14e)]||_0x18a82f(0x1de);await database_1[_0x18a82f(0x1c5)][_0x18a82f(0xf1)]['update']({'where':{'telegramId':_0x1a1dc1},'data':{'shopId':null,'isVerified':![]}}),console[_0x18a82f(0xe2)](_0x18a82f(0x19e)+_0x1a1dc1+_0x18a82f(0x14b)+_0x460585[_0x18a82f(0x201)]),await this[_0x18a82f(0x1f4)]?.[_0x18a82f(0x1d1)](_0x5f2eef,_0x18a82f(0x1aa)+_0x46764e+_0x18a82f(0xfc)+_0x18a82f(0x13e),{'parse_mode':_0x18a82f(0xbe)});}catch(_0x136b34){console[_0x18a82f(0xe6)](_0x18a82f(0xeb),_0x136b34),await this[_0x18a82f(0x1f4)]?.[_0x18a82f(0x1d1)](_0x5f2eef,_0x18a82f(0x17c));}}),this[_0x1ecbdf(0x1f4)]['onText'](/\/status/,async _0x3bb521=>{const _0xea79e1=_0x1ecbdf,_0x42b310=_0x3bb521[_0xea79e1(0xca)]['id'],_0xd1ce44=_0x3bb521[_0xea79e1(0x1f3)]?.['id'][_0xea79e1(0x12f)]();if(!_0xd1ce44)return;try{const _0x386b46=await database_1[_0xea79e1(0x1c5)][_0xea79e1(0xf1)][_0xea79e1(0xbd)]({'where':{'telegramId':_0xd1ce44},'include':{'shop':!![]}});if(!_0x386b46){await this[_0xea79e1(0x1f4)]?.[_0xea79e1(0x1d1)](_0x42b310,'‚ùå\x20You\x20are\x20not\x20registered\x20in\x20the\x20system.\x0a\x0a'+'Use\x20/start\x20to\x20begin.');return;}if(!_0x386b46[_0xea79e1(0xbc)]||!_0x386b46[_0xea79e1(0x201)]||!_0x386b46[_0xea79e1(0x14c)]){await this[_0xea79e1(0x1f4)]?.[_0xea79e1(0x1d1)](_0x42b310,'‚ùå\x20You\x20are\x20not\x20connected\x20to\x20a\x20shop.\x0a\x0a'+'Use\x20/start\x20to\x20connect.');return;}await this[_0xea79e1(0x1f4)]?.['sendMessage'](_0x42b310,'üìä\x20*Connection\x20Status*\x0a\x0a'+('‚úÖ\x20Connected\x20to\x20shop:\x20*'+_0x386b46['shop']['name']+'*\x0a')+(_0xea79e1(0xe8)+_0x386b46[_0xea79e1(0x14c)][_0xea79e1(0x12a)]+'`\x0a')+(_0xea79e1(0x91)+_0x386b46[_0xea79e1(0x16c)]['toLocaleDateString']('en-US')+'\x0a\x0a')+_0xea79e1(0x120)+'üì±\x20Available\x20Commands:\x0a'+_0xea79e1(0x117)+_0xea79e1(0x17d)+_0xea79e1(0xf6)+'/contacts\x20-\x20support\x20contacts\x0a'+_0xea79e1(0x1b2),{'parse_mode':_0xea79e1(0xbe)});}catch(_0x19ed17){console[_0xea79e1(0xe6)](_0xea79e1(0x9e),_0x19ed17),await this[_0xea79e1(0x1f4)]?.[_0xea79e1(0x1d1)](_0x42b310,_0xea79e1(0x17c));}}),this[_0x1ecbdf(0x1f4)][_0x1ecbdf(0x86)](/\/statistics/,async _0x2b7411=>{const _0x1260b1=_0x1ecbdf,_0x2d248e=_0x2b7411[_0x1260b1(0xca)]['id'],_0xa46f3a=_0x2b7411[_0x1260b1(0x1f3)]?.['id'][_0x1260b1(0x12f)]();if(!_0xa46f3a)return;try{const _0x2fe4f8=await database_1['default'][_0x1260b1(0xf1)][_0x1260b1(0xbd)]({'where':{'telegramId':_0xa46f3a},'include':{'shop':!![]}});if(!_0x2fe4f8?.[_0x1260b1(0xbc)]||!_0x2fe4f8[_0x1260b1(0x201)]){await this['bot']?.[_0x1260b1(0x1d1)](_0x2d248e,'‚ùå\x20You\x20are\x20not\x20connected\x20to\x20a\x20shop.\x0a\x0a'+_0x1260b1(0xed));return;}await this['bot']?.[_0x1260b1(0x1d1)](_0x2d248e,_0x1260b1(0x92)+_0x1260b1(0x150)+_0x1260b1(0x138)+_0x1260b1(0x82)+'‚Ä¢\x20Payment\x20count\x0a'+'‚Ä¢\x20Success\x20rate\x0a'+_0x1260b1(0x142),{'parse_mode':_0x1260b1(0xbe)});}catch(_0x1dd090){console['error']('Error\x20handling\x20/statistics\x20command:',_0x1dd090),await this['bot']?.[_0x1260b1(0x1d1)](_0x2d248e,_0x1260b1(0x17c));}}),this[_0x1ecbdf(0x1f4)][_0x1ecbdf(0x86)](/\/payouts/,async _0x5df593=>{const _0x22e4b7=_0x1ecbdf,_0x506f90=_0x5df593['chat']['id'],_0x475430=_0x5df593[_0x22e4b7(0x1f3)]?.['id']['toString']();if(!_0x475430)return;try{const _0x3524be=await database_1[_0x22e4b7(0x1c5)]['telegramUser'][_0x22e4b7(0xbd)]({'where':{'telegramId':_0x475430},'include':{'shop':!![]}});if(!_0x3524be?.[_0x22e4b7(0xbc)]||!_0x3524be[_0x22e4b7(0x201)]){await this[_0x22e4b7(0x1f4)]?.[_0x22e4b7(0x1d1)](_0x506f90,_0x22e4b7(0x1ae)+_0x22e4b7(0xed));return;}await this[_0x22e4b7(0x1f4)]?.[_0x22e4b7(0x1d1)](_0x506f90,'üí∏\x20*Recent\x20Payouts*\x0a\x0a'+_0x22e4b7(0x150)+_0x22e4b7(0x138)+_0x22e4b7(0x9b)+'‚Ä¢\x20Amount\x20and\x20network\x0a'+_0x22e4b7(0x132)+'‚Ä¢\x20Dates\x20and\x20TX\x20IDs',{'parse_mode':'Markdown'});}catch(_0x18b612){console['error']('Error\x20handling\x20/payouts\x20command:',_0x18b612),await this[_0x22e4b7(0x1f4)]?.[_0x22e4b7(0x1d1)](_0x506f90,_0x22e4b7(0x17c));}}),this[_0x1ecbdf(0x1f4)]['onText'](/\/payment_links/,async _0x5d8bee=>{const _0x5e24fa=_0x1ecbdf,_0x5c1746=_0x5d8bee[_0x5e24fa(0xca)]['id'],_0x264f17=_0x5d8bee[_0x5e24fa(0x1f3)]?.['id'][_0x5e24fa(0x12f)]();if(!_0x264f17)return;try{const _0x328d6c=await database_1['default'][_0x5e24fa(0xf1)][_0x5e24fa(0xbd)]({'where':{'telegramId':_0x264f17},'include':{'shop':!![]}});if(!_0x328d6c?.[_0x5e24fa(0xbc)]||!_0x328d6c[_0x5e24fa(0x201)]){await this[_0x5e24fa(0x1f4)]?.[_0x5e24fa(0x1d1)](_0x5c1746,'‚ùå\x20You\x20are\x20not\x20connected\x20to\x20a\x20shop.\x0a\x0a'+_0x5e24fa(0xed));return;}await this['bot']?.[_0x5e24fa(0x1d1)](_0x5c1746,_0x5e24fa(0x16e)+_0x5e24fa(0x150)+_0x5e24fa(0x138)+_0x5e24fa(0x1a4)+'‚Ä¢\x20Usage\x20statistics\x0a'+_0x5e24fa(0xf9)+'‚Ä¢\x20Share\x20link\x20directly',{'parse_mode':_0x5e24fa(0xbe)});}catch(_0x28631a){console['error'](_0x5e24fa(0x111),_0x28631a),await this['bot']?.[_0x5e24fa(0x1d1)](_0x5c1746,_0x5e24fa(0x17c));}}),this[_0x1ecbdf(0x1f4)][_0x1ecbdf(0x86)](/\/contacts/,async _0x2c5f92=>{const _0x3068f7=_0x1ecbdf,_0x1593a4=_0x2c5f92[_0x3068f7(0xca)]['id'];try{await this[_0x3068f7(0x1f4)]?.[_0x3068f7(0x1d1)](_0x1593a4,'üìû\x20*Contacts*\x0a\x0a'+_0x3068f7(0x1ac)+_0x3068f7(0x183)+_0x3068f7(0xc1)+_0x3068f7(0x1c7),{'parse_mode':_0x3068f7(0xbe)});}catch(_0x1c89fb){console[_0x3068f7(0xe6)](_0x3068f7(0x198),_0x1c89fb),await this[_0x3068f7(0x1f4)]?.[_0x3068f7(0x1d1)](_0x1593a4,_0x3068f7(0x17c));}}),this[_0x1ecbdf(0x1f4)]['on'](_0x1ecbdf(0x205),async _0x4cb287=>{const _0x436ca0=_0x1ecbdf,_0x57c8bd=_0x4cb287[_0x436ca0(0x1dd)],_0xc68d51=_0x57c8bd?.[_0x436ca0(0xca)]['id'],_0x504a3d=_0x4cb287[_0x436ca0(0x1f3)]['id'][_0x436ca0(0x12f)](),_0x23381c=_0x4cb287[_0x436ca0(0xb8)];if(!_0xc68d51||!_0x23381c)return;try{await this[_0x436ca0(0x1f4)]?.[_0x436ca0(0xd8)](_0x4cb287['id']);const _0x4633d8=await database_1[_0x436ca0(0x1c5)][_0x436ca0(0xf1)]['findUnique']({'where':{'telegramId':_0x504a3d},'include':{'shop':!![]}});if(!_0x4633d8?.[_0x436ca0(0xbc)]||!_0x4633d8[_0x436ca0(0x201)]){await this[_0x436ca0(0x1f4)]?.[_0x436ca0(0x1d1)](_0xc68d51,_0x436ca0(0x194));return;}switch(_0x23381c){case _0x436ca0(0x1b1):const _0x1e0e7f=new Date();_0x1e0e7f['setHours'](0x0,0x0,0x0,0x0);const _0x45de01=new Date(_0x1e0e7f);_0x45de01[_0x436ca0(0x200)](_0x45de01[_0x436ca0(0x1be)]()+0x1);const _0x40a5f4=await database_1[_0x436ca0(0x1c5)][_0x436ca0(0xe4)]['findMany']({'where':{'shopId':_0x4633d8[_0x436ca0(0x201)],'createdAt':{'gte':_0x1e0e7f,'lt':_0x45de01}}}),_0x5dd6ad=_0x40a5f4[_0x436ca0(0x18a)](_0x5d5cb2=>_0x5d5cb2[_0x436ca0(0x1c3)]==='PAID'),_0x266063=_0x40a5f4['filter'](_0x4a28f7=>_0x4a28f7['status']===_0x436ca0(0x125)),_0x42d058=_0x40a5f4[_0x436ca0(0x18a)](_0xd494e1=>_0xd494e1[_0x436ca0(0x1c3)]===_0x436ca0(0xf3))[_0x436ca0(0x1c1)],_0x4e477d=_0x40a5f4[_0x436ca0(0x18a)](_0x4521d7=>_0x4521d7[_0x436ca0(0x1c3)]===_0x436ca0(0xde))['length'],_0x48905b=_0x5dd6ad[_0x436ca0(0x186)]((_0x491765,_0x1d2ad2)=>_0x491765+(_0x1d2ad2[_0x436ca0(0x1d4)]||0x0),0x0),_0x29381c=_0x5dd6ad[_0x436ca0(0x186)]((_0x368149,_0x21ad8f)=>_0x368149+(_0x21ad8f[_0x436ca0(0xfb)]||0x0),0x0),_0x4b5b4d=_0x5dd6ad[_0x436ca0(0x1c1)]+_0x266063[_0x436ca0(0x1c1)]>0x0?(_0x5dd6ad['length']/(_0x5dd6ad[_0x436ca0(0x1c1)]+_0x266063['length'])*0x64)[_0x436ca0(0x202)](0x1):_0x436ca0(0x18f),_0x30239e=new Date()['toLocaleDateString']('en-GB',{'day':_0x436ca0(0x103),'month':_0x436ca0(0x103),'year':_0x436ca0(0x19c)});await this['bot']?.[_0x436ca0(0x1d1)](_0xc68d51,_0x436ca0(0xa7)+_0x30239e+_0x436ca0(0x10a)+('üí∞\x20Turnover\x20-\x20'+_0x48905b[_0x436ca0(0x202)](0x2)+_0x436ca0(0x1f5))+(_0x436ca0(0x19f)+_0x29381c[_0x436ca0(0x202)](0x2)+_0x436ca0(0x1f5))+(_0x436ca0(0x1f7)+_0x5dd6ad[_0x436ca0(0x1c1)]+'\x0a')+(_0x436ca0(0x13b)+_0x266063[_0x436ca0(0x1c1)]+'\x0a')+('üìà\x20Conversion\x20-\x20'+_0x4b5b4d+'%\x0a')+('‚ö†Ô∏è\x20Chargebacks\x20-\x20'+_0x42d058+'\x0a')+('‚Ü©Ô∏è\x20Refunds\x20-\x20'+_0x4e477d),{'parse_mode':_0x436ca0(0xbe)});break;case _0x436ca0(0x1a1):const _0x16c0d0=await database_1[_0x436ca0(0x1c5)][_0x436ca0(0x13a)][_0x436ca0(0x208)]({'where':{'shopId':_0x4633d8['shopId']},'orderBy':{'createdAt':'desc'}}),_0x984ced=_0x16c0d0[_0x436ca0(0x18a)](_0x253b4f=>_0x253b4f[_0x436ca0(0x1c3)]===_0x436ca0(0x148))[_0x436ca0(0x186)]((_0x1170bc,_0x5361df)=>_0x1170bc+_0x5361df['amount'],0x0),_0x411273=_0x16c0d0['filter'](_0x337689=>_0x337689['status']===_0x436ca0(0x159))[_0x436ca0(0x186)]((_0x4bf844,_0x18fd58)=>_0x4bf844+_0x18fd58[_0x436ca0(0x1d4)],0x0),_0x43866e=(_0x4633d8['shop']?.[_0x436ca0(0x173)]||0x0)+(_0x4633d8[_0x436ca0(0x14c)]?.[_0x436ca0(0x172)]||0x0);await this[_0x436ca0(0x1f4)]?.[_0x436ca0(0x1d1)](_0xc68d51,_0x436ca0(0x1ce)+('‚è≥\x20Pending\x20payouts:\x20'+_0x984ced[_0x436ca0(0x202)](0x2)+_0x436ca0(0x1f5))+('‚úÖ\x20Paid\x20out:\x20'+_0x411273['toFixed'](0x2)+_0x436ca0(0x1f5))+(_0x436ca0(0x109)+_0x43866e[_0x436ca0(0x202)](0x2)+_0x436ca0(0x182)),{'parse_mode':_0x436ca0(0xbe)});break;case _0x436ca0(0x1ec):await this[_0x436ca0(0x1f4)]?.['sendMessage'](_0xc68d51,_0x436ca0(0x1f2),{'parse_mode':'Markdown','reply_markup':{'inline_keyboard':[[{'text':_0x436ca0(0x1cf),'callback_data':_0x436ca0(0x171)}],[{'text':'‚ûï\x20Create\x20New\x20Link','callback_data':_0x436ca0(0x16b)}],[{'text':'‚ùå\x20Cancel','callback_data':_0x436ca0(0x168)}]]}});break;case'cmd_status':await this[_0x436ca0(0x1f4)]?.[_0x436ca0(0x1d1)](_0xc68d51,_0x436ca0(0x16a)+(_0x436ca0(0x1e2)+(_0x4633d8[_0x436ca0(0x14c)]?.['name']||_0x436ca0(0xc9))+'*\x0a')+(_0x436ca0(0xe8)+(_0x4633d8['shop']?.[_0x436ca0(0x12a)]||_0x436ca0(0xc9))+'`\x0a')+(_0x436ca0(0x91)+_0x4633d8[_0x436ca0(0x16c)][_0x436ca0(0x1a7)](_0x436ca0(0x9f))+'\x0a\x0a')+_0x436ca0(0x144),{'parse_mode':_0x436ca0(0xbe)});break;case _0x436ca0(0x184):await this[_0x436ca0(0x1f4)]?.[_0x436ca0(0x1d1)](_0xc68d51,'üìû\x20*Contacts*\x0a\x0a'+_0x436ca0(0x1ac)+_0x436ca0(0x183)+_0x436ca0(0xc1)+_0x436ca0(0x1c7),{'parse_mode':_0x436ca0(0xbe)});break;case _0x436ca0(0x1d3):await database_1[_0x436ca0(0x1c5)][_0x436ca0(0xf1)][_0x436ca0(0x1ff)]({'where':{'telegramId':_0x504a3d},'data':{'shopId':null,'isVerified':![]}}),await this['bot']?.[_0x436ca0(0x1d1)](_0xc68d51,_0x436ca0(0x1aa)+(_0x4633d8[_0x436ca0(0x14c)]?.['name']||'Unknown')+_0x436ca0(0xfc)+_0x436ca0(0x13e),{'parse_mode':_0x436ca0(0xbe)});break;default:_0x23381c[_0x436ca0(0x160)](_0x436ca0(0x1db))?await this[_0x436ca0(0xad)](_0xc68d51,_0x504a3d,_0x23381c,_0x4cb287['message']?.[_0x436ca0(0x1cd)]):await this[_0x436ca0(0x1f4)]?.[_0x436ca0(0x1d1)](_0xc68d51,_0x436ca0(0x85));}}catch(_0x50487e){console[_0x436ca0(0xe6)](_0x436ca0(0x1ea),_0x50487e),await this[_0x436ca0(0x1f4)]?.[_0x436ca0(0x1d1)](_0xc68d51,_0x436ca0(0x17c));}}),this[_0x1ecbdf(0x1f4)][_0x1ecbdf(0x86)](/\/debug/,async _0x56b188=>{const _0x1af8e3=_0x1ecbdf,_0x51f9a2=_0x56b188['chat']['id'],_0x4696bd=_0x56b188['from']?.['id'][_0x1af8e3(0x12f)]();if(!_0x4696bd)return;try{const _0x3f9c61=await database_1[_0x1af8e3(0x1c5)][_0x1af8e3(0xf1)][_0x1af8e3(0xbd)]({'where':{'telegramId':_0x4696bd},'include':{'shop':!![]}});let _0x24feab='üîç\x20*Debug\x20Information*\x0a\x0a';_0x24feab+=_0x1af8e3(0x192)+_0x4696bd+'`\x0a\x0a',_0x3f9c61?.[_0x1af8e3(0xbc)]&&_0x3f9c61[_0x1af8e3(0x14c)]?(_0x24feab+='üè™\x20Your\x20connected\x20shop:\x0a',_0x24feab+=_0x1af8e3(0x1fb)+_0x3f9c61[_0x1af8e3(0x14c)][_0x1af8e3(0x14e)]+'*\x0a',_0x24feab+=_0x1af8e3(0xc7)+_0x3f9c61[_0x1af8e3(0x14c)][_0x1af8e3(0x12a)]+'`\x0a',_0x24feab+=_0x1af8e3(0x110)+_0x3f9c61[_0x1af8e3(0x14c)][_0x1af8e3(0x1c3)]+'\x0a\x0a'):_0x24feab+=_0x1af8e3(0xa6),_0x24feab+=_0x1af8e3(0x1da),await this[_0x1af8e3(0x1f4)]?.[_0x1af8e3(0x1d1)](_0x51f9a2,_0x24feab,{'parse_mode':_0x1af8e3(0xbe)});}catch(_0x331219){console['error'](_0x1af8e3(0x1bd),_0x331219),await this[_0x1af8e3(0x1f4)]?.[_0x1af8e3(0x1d1)](_0x51f9a2,_0x1af8e3(0xe1));}}),this['bot']['on']('message',async _0x37f162=>{const _0x22173e=_0x1ecbdf;if(_0x37f162['text']?.[_0x22173e(0x160)]('/'))return;const _0x22034f=_0x37f162['chat']['id'],_0x2b8d5c=_0x37f162[_0x22173e(0x1f3)]?.['id'][_0x22173e(0x12f)](),_0x3ac5ed=_0x37f162['text']?.[_0x22173e(0xb2)]();if(!_0x2b8d5c||!_0x3ac5ed)return;try{const _0xd6bc48=this[_0x22173e(0x1a3)][_0x22173e(0xdc)](_0x2b8d5c);if(_0xd6bc48&&_0xd6bc48[_0x22173e(0xbb)]===_0x22173e(0x1d4)){const _0x2f1411=parseFloat(_0x3ac5ed);if(isNaN(_0x2f1411)||_0x2f1411<=0x0){await this[_0x22173e(0x1f4)]?.[_0x22173e(0x1d1)](_0x22034f,_0x22173e(0xfe));return;}const _0x4a1421=await database_1[_0x22173e(0x1c5)][_0x22173e(0xf1)]['findUnique']({'where':{'telegramId':_0x2b8d5c},'include':{'shop':!![]}});if(!_0x4a1421?.['shopId']){await this[_0x22173e(0x1f4)]?.['sendMessage'](_0x22034f,_0x22173e(0x11c)),this[_0x22173e(0x1a3)][_0x22173e(0x18c)](_0x2b8d5c);return;}const _0x2bfb97={'shopId':_0x4a1421[_0x22173e(0x201)],'gateway':_0xd6bc48['gateway'],'amount':_0x2f1411,'currency':_0xd6bc48[_0x22173e(0x127)],'type':_0xd6bc48[_0x22173e(0xfa)],'status':'ACTIVE'},_0x648a8f=await database_1[_0x22173e(0x1c5)][_0x22173e(0x14a)][_0x22173e(0xb5)]({'data':_0x2bfb97});this[_0x22173e(0x1a3)][_0x22173e(0x18c)](_0x2b8d5c);const _0x538668=(process.env.FRONTEND_URL||_0x22173e(0x1a9))+'/link/'+_0x648a8f['id'],_0x547697=_0x538668[_0x22173e(0xc4)](/\./g,'\x5c.')['replace'](/-/g,'\x5c-')[_0x22173e(0xc4)](/\//g,'\x5c/');await this['bot']?.['sendMessage'](_0x22034f,_0x22173e(0xd7)+(_0x22173e(0xd5)+_0x547697+'\x0a')+(_0x22173e(0x79)+_0x2f1411+'\x20'+_0xd6bc48[_0x22173e(0x127)]+'\x0a')+(_0x22173e(0x10e)+_0xd6bc48[_0x22173e(0x209)]+'\x0a')+(_0x22173e(0x7a)+(_0xd6bc48['type']===_0x22173e(0x167)?'Single\x20Use':_0x22173e(0x165))+'\x0a\x0a')+_0x22173e(0x7f),{'parse_mode':'MarkdownV2'});return;}const _0x290a31=await database_1[_0x22173e(0x1c5)][_0x22173e(0xf1)]['findUnique']({'where':{'telegramId':_0x2b8d5c},'include':{'shop':!![]}});if(!_0x290a31){await this['bot']?.[_0x22173e(0x1d1)](_0x22034f,_0x22173e(0x147));return;}if(_0x290a31['isVerified']&&_0x290a31['shopId']&&_0x290a31[_0x22173e(0x14c)]){await this['bot']?.[_0x22173e(0x1d1)](_0x22034f,_0x22173e(0x107)+_0x290a31[_0x22173e(0x14c)][_0x22173e(0x14e)]+'*.\x0a\x0a'+_0x22173e(0x18d),{'parse_mode':_0x22173e(0xbe)});return;}const _0x2972c8=_0x3ac5ed['split'](/\s+/);if(_0x2972c8[_0x22173e(0x1c1)]!==0x2){await this[_0x22173e(0x1f4)]?.[_0x22173e(0x1d1)](_0x22034f,_0x22173e(0x113)+_0x22173e(0xc0)+'Example:\x0a'+_0x22173e(0x163)+(_0x22173e(0x8a)+_0x2972c8['length']+_0x22173e(0x15b)+_0x2972c8[_0x22173e(0x90)](_0x314d06=>'`'+_0x314d06+'`')['join'](',\x20')),{'parse_mode':_0x22173e(0xbe)});return;}const [_0x842b94,_0x56a378]=_0x2972c8;console[_0x22173e(0xe2)](_0x22173e(0x149)+_0x2b8d5c+_0x22173e(0x195)+_0x842b94+'\x22,\x20apiKey=\x22'+_0x56a378['substring'](0x0,0xa)+_0x22173e(0x1ad)),await this[_0x22173e(0x135)](_0x22034f,_0x2b8d5c,_0x842b94,_0x56a378);}catch(_0x2fb018){console[_0x22173e(0xe6)](_0x22173e(0xe0),_0x2fb018),await this[_0x22173e(0x1f4)]?.[_0x22173e(0x1d1)](_0x22034f,'‚ùå\x20An\x20error\x20occurred.\x20Please\x20try\x20again\x20later.');}}),this[_0x1ecbdf(0x1f4)]['on']('error',_0x2126e0=>{const _0x329d7f=_0x1ecbdf;console[_0x329d7f(0xe6)](_0x329d7f(0xc5),_0x2126e0);}),this['bot']['on']('polling_error',_0x56e7f2=>{const _0x557709=_0x1ecbdf;console[_0x557709(0xe6)](_0x557709(0xb7),_0x56e7f2);});}async[a87_0x22bfde(0x135)](_0x1aa8ef,_0x2cd93,_0x1bac51,_0x2dcfec){const _0x2ab0ef=a87_0x22bfde;try{console[_0x2ab0ef(0xe2)](_0x2ab0ef(0x149)+_0x2cd93+_0x2ab0ef(0x195)+_0x1bac51+'\x22,\x20apiKey=\x22'+_0x2dcfec[_0x2ab0ef(0x20b)](0x0,0xa)+_0x2ab0ef(0x1ad));if(!_0x1bac51||_0x1bac51[_0x2ab0ef(0x1c1)]<0x3||_0x1bac51[_0x2ab0ef(0x1c1)]>0x32||!/^[a-zA-Z0-9_]+$/['test'](_0x1bac51)){await this[_0x2ab0ef(0x1f4)]?.[_0x2ab0ef(0x1d1)](_0x1aa8ef,'‚ùå\x20Invalid\x20username\x20format:\x20`'+_0x1bac51+_0x2ab0ef(0x189)+'Username\x20must\x20contain\x20only\x20letters,\x20numbers\x20and\x20underscore\x20(3-50\x20characters).',{'parse_mode':_0x2ab0ef(0xbe)});return;}if(!_0x2dcfec||!_0x2dcfec['startsWith'](_0x2ab0ef(0x207))&&!_0x2dcfec[_0x2ab0ef(0x160)](_0x2ab0ef(0x154))){await this[_0x2ab0ef(0x1f4)]?.[_0x2ab0ef(0x1d1)](_0x1aa8ef,_0x2ab0ef(0x98)+_0x2ab0ef(0x1e4),{'parse_mode':_0x2ab0ef(0xbe)});return;}const _0x590dbc=await database_1[_0x2ab0ef(0x1c5)][_0x2ab0ef(0x14c)][_0x2ab0ef(0xbd)]({'where':{'username':_0x1bac51},'select':{'id':!![],'name':!![],'username':!![],'status':!![],'publicKey':!![],'secretKey':!![]}});if(!_0x590dbc){const _0x437e04=_0x2ab0ef(0xb0)+_0x1bac51+_0x2ab0ef(0x9c)+_0x2ab0ef(0xdd)+_0x2ab0ef(0x176);await this[_0x2ab0ef(0x1f4)]?.['sendMessage'](_0x1aa8ef,_0x437e04,{'parse_mode':'Markdown'});return;}if(_0x590dbc[_0x2ab0ef(0x1c3)]!==_0x2ab0ef(0x179)){await this[_0x2ab0ef(0x1f4)]?.[_0x2ab0ef(0x1d1)](_0x1aa8ef,_0x2ab0ef(0xe7)+_0x1bac51+_0x2ab0ef(0x10b)+_0x2ab0ef(0x1af),{'parse_mode':_0x2ab0ef(0xbe)});return;}if(_0x590dbc[_0x2ab0ef(0x11b)]!==_0x2dcfec&&_0x590dbc['secretKey']!==_0x2dcfec){await this[_0x2ab0ef(0x1f4)]?.[_0x2ab0ef(0x1d1)](_0x1aa8ef,'‚ùå\x20API\x20key\x20does\x20not\x20match\x20shop\x20`'+_0x1bac51+'`.\x0a\x0a'+'Check\x20the\x20key\x20and\x20try\x20again.\x0a\x0a'+'Expected\x20key\x20format:\x20`pk_...`\x20or\x20`sk_...`',{'parse_mode':_0x2ab0ef(0xbe)});return;}const _0x2595c9=await database_1['default'][_0x2ab0ef(0xf1)]['count']({'where':{'shopId':_0x590dbc['id'],'isVerified':!![]}});if(_0x2595c9>=0x5){await this[_0x2ab0ef(0x1f4)]?.[_0x2ab0ef(0x1d1)](_0x1aa8ef,_0x2ab0ef(0x1e9)+_0x1bac51+_0x2ab0ef(0x123)+_0x2ab0ef(0xce),{'parse_mode':_0x2ab0ef(0xbe)});return;}await database_1['default'][_0x2ab0ef(0xf1)][_0x2ab0ef(0x1ff)]({'where':{'telegramId':_0x2cd93},'data':{'shopId':_0x590dbc['id'],'isVerified':!![]}}),await this[_0x2ab0ef(0x1f4)]?.[_0x2ab0ef(0x1d1)](_0x1aa8ef,_0x2ab0ef(0x190)+_0x2ab0ef(0x156)+('üì±\x20Shop:\x20*'+_0x590dbc[_0x2ab0ef(0x14e)]+'*\x0a')+(_0x2ab0ef(0xe8)+_0x590dbc[_0x2ab0ef(0x12a)]+_0x2ab0ef(0x189))+_0x2ab0ef(0x199)+'‚Ä¢\x20New\x20payments\x0a'+_0x2ab0ef(0x1a8)+_0x2ab0ef(0xfd)+'‚Ä¢\x20Important\x20events',{'parse_mode':_0x2ab0ef(0xbe),'reply_markup':{'inline_keyboard':[[{'text':'üìä\x20Statistics','callback_data':'cmd_statistics'},{'text':_0x2ab0ef(0x1e6),'callback_data':'cmd_payouts'}],[{'text':_0x2ab0ef(0x8f),'callback_data':_0x2ab0ef(0x1ec)},{'text':'üìä\x20Status','callback_data':_0x2ab0ef(0x157)}],[{'text':'üìû\x20Contacts','callback_data':'cmd_contacts'},{'text':_0x2ab0ef(0x1fa),'callback_data':_0x2ab0ef(0x1d3)}]]}}),console['log']('‚úÖ\x20Telegram\x20user\x20'+_0x2cd93+_0x2ab0ef(0xa2)+_0x590dbc[_0x2ab0ef(0x12a)]+_0x2ab0ef(0x1ef));}catch(_0x3fee85){console[_0x2ab0ef(0xe6)](_0x2ab0ef(0x136),_0x3fee85),await this[_0x2ab0ef(0x1f4)]?.[_0x2ab0ef(0x1d1)](_0x1aa8ef,_0x2ab0ef(0x1eb));}}async[a87_0x22bfde(0x7e)](_0x328029,_0x58b420,_0x2e4a45){const _0x45f611=a87_0x22bfde;if(!this['bot']){console['warn'](_0x45f611(0xbf));return;}try{const _0x21c6bd=await database_1[_0x45f611(0x1c5)][_0x45f611(0xf1)][_0x45f611(0x208)]({'where':{'shopId':_0x328029,'isVerified':!![]}});if(_0x21c6bd['length']===0x0){console[_0x45f611(0xe2)](_0x45f611(0xc8)+_0x328029);return;}const _0x27727b=_0x21c6bd[_0x45f611(0x90)](async _0x32f29a=>{const _0x179704=_0x45f611;try{await this[_0x179704(0x1f4)]?.[_0x179704(0x1d1)](_0x32f29a[_0x179704(0x166)],_0x58b420,_0x2e4a45),console[_0x179704(0xe2)](_0x179704(0xff)+_0x32f29a[_0x179704(0x166)]);}catch(_0x185845){console[_0x179704(0xe6)](_0x179704(0xf5)+_0x32f29a[_0x179704(0x166)]+':',_0x185845),_0x185845 instanceof Error&&(_0x185845[_0x179704(0x1dd)][_0x179704(0x97)](_0x179704(0x133))||_0x185845['message']['includes'](_0x179704(0x162))||_0x185845[_0x179704(0x1dd)][_0x179704(0x97)](_0x179704(0x131)))&&(await database_1[_0x179704(0x1c5)][_0x179704(0xf1)][_0x179704(0x1ff)]({'where':{'id':_0x32f29a['id']},'data':{'isVerified':![]}}),console[_0x179704(0xe2)](_0x179704(0x203)+_0x32f29a[_0x179704(0x166)]+_0x179704(0x1f6)));}});await Promise[_0x45f611(0x145)](_0x27727b);}catch(_0x11f38a){console['error'](_0x45f611(0x170),_0x11f38a);}}async[a87_0x22bfde(0x146)](_0x7bdd2c,_0x3b6abc,_0xf56528){const _0x16a559=a87_0x22bfde,_0x343fac={'created':'üÜï','paid':'‚úÖ','failed':'‚ùå','expired':'‚è∞','refund':'üîÑ','chargeback':'‚ö†Ô∏è','processing':'‚öôÔ∏è'},_0x428679={'created':_0x16a559(0xab),'paid':_0x16a559(0x15c),'failed':_0x16a559(0xec),'expired':_0x16a559(0x87),'refund':_0x16a559(0x15f),'chargeback':_0x16a559(0xa9),'processing':_0x16a559(0xda)},_0x3df61b=_0x343fac[_0xf56528],_0x136797=_0x428679[_0xf56528],_0xef7afc=(0x0,gateway_1['getGatewayDisplayNameForTelegram'])(_0x3b6abc['gateway']);console[_0x16a559(0xe2)](_0x16a559(0x152)+_0x3b6abc['gateway']+_0x16a559(0xa3)+_0xef7afc+'\x22');let _0x3ed1bb=_0x3df61b+'\x20*'+_0x136797+'*\x0a\x0a'+('üí∞\x20Amount:\x20*'+_0x3b6abc[_0x16a559(0x1d4)]+'\x20'+_0x3b6abc[_0x16a559(0x127)]+'*\x0a')+(_0x16a559(0x1bf)+(_0x3b6abc[_0x16a559(0x118)]||_0x3b6abc['id'])+'`\x0a')+(_0x16a559(0x158)+_0x3b6abc['id']+'`\x0a')+(_0x16a559(0xaf)+_0xef7afc+'`\x0a')+(_0x16a559(0x88)+new Date(_0x3b6abc[_0x16a559(0x1e8)])['toLocaleString'](_0x16a559(0x9f))+'\x0a');if(_0x3b6abc[_0x16a559(0x204)]||_0x3b6abc[_0x16a559(0x10c)]||_0x3b6abc[_0x16a559(0x78)]||_0x3b6abc[_0x16a559(0x1ed)]||_0x3b6abc[_0x16a559(0x95)]){_0x3ed1bb+=_0x16a559(0x8c);_0x3b6abc[_0x16a559(0x204)]&&(_0x3ed1bb+='üìõ\x20Name:\x20`'+_0x3b6abc['customerName']+'`\x0a');_0x3b6abc['customerEmail']&&(_0x3ed1bb+='üìß\x20Email:\x20`'+_0x3b6abc[_0x16a559(0x10c)]+'`\x0a');_0x3b6abc[_0x16a559(0x78)]&&(_0x3ed1bb+='üè¶\x20IBAN:\x20`'+_0x3b6abc[_0x16a559(0x78)]+'`\x0a');_0x3b6abc[_0x16a559(0x1ed)]&&(_0x3ed1bb+=_0x16a559(0x1d2)+_0x3b6abc[_0x16a559(0x1ed)]+'`\x0a');if(_0x3b6abc[_0x16a559(0x95)]){const _0x31f8d2=_0x3b6abc[_0x16a559(0x95)][_0x16a559(0x1c1)]>0x32?_0x3b6abc[_0x16a559(0x95)]['substring'](0x0,0x32)+_0x16a559(0x13c):_0x3b6abc['customerUa'];_0x3ed1bb+=_0x16a559(0x1c6)+_0x31f8d2+'`\x0a';}}_0xf56528===_0x16a559(0xa8)&&_0x3b6abc[_0x16a559(0x1d0)]&&(_0x3ed1bb+=_0x16a559(0x140)+_0x3b6abc[_0x16a559(0x1d0)]+_0x16a559(0x17e)),_0xf56528===_0x16a559(0xa1)&&(_0x3ed1bb+='‚è≥\x20The\x20payment\x20is\x20currently\x20being\x20processed\x20by\x20the\x20gateway.\x0a'),_0x3b6abc[_0x16a559(0x193)]&&(_0x3ed1bb+='üìù\x20Notes:\x20'+_0x3b6abc['adminNotes']+'\x0a'),await this[_0x16a559(0x7e)](_0x7bdd2c,_0x3ed1bb,{'parse_mode':_0x16a559(0xbe)});}async[a87_0x22bfde(0x10d)](_0x1be0c0,_0x277438){const _0x520d6=a87_0x22bfde,_0x1e3140=new Date(_0x277438[_0x520d6(0x1e8)])[_0x520d6(0x169)](_0x520d6(0x9f),{'year':_0x520d6(0x19c),'month':'2-digit','day':_0x520d6(0x103),'hour':_0x520d6(0x103),'minute':'2-digit','second':_0x520d6(0x103)}),_0x1c7cbc='üí∏\x20*New\x20Payout*\x0a\x0a'+('üìÖ\x20*Payout\x20Date:*\x20'+_0x1e3140+'\x0a')+(_0x520d6(0xcd)+_0x277438[_0x520d6(0x1d4)]+'\x20USD\x0a')+(_0x520d6(0x153)+(_0x277438[_0x520d6(0x1f1)]||_0x520d6(0xf7))+'\x0a')+(_0x520d6(0x128)+(_0x277438[_0x520d6(0xa4)]||'Not\x20specified')+'\x0a')+(_0x520d6(0xf2)+(_0x277438[_0x520d6(0xe5)]||_0x520d6(0xf7))+'`\x0a')+(_0x277438['txid']?'üîó\x20*Transaction\x20Link:*\x20`'+_0x277438[_0x520d6(0x1e7)]+'`':'üîó\x20*Transaction\x20Link:*\x20Pending');await this[_0x520d6(0x7e)](_0x1be0c0,_0x1c7cbc,{'parse_mode':'Markdown'});}async['sendLoginNotification'](_0x19e18a,_0x5867b1){const _0x15ae1a=a87_0x22bfde;try{const _0x45cd57=await database_1[_0x15ae1a(0x1c5)][_0x15ae1a(0x114)][_0x15ae1a(0xbd)]({'where':{'shopId':_0x19e18a},'select':{'notificationLogin':!![]}});if(!_0x45cd57?.['notificationLogin']){console[_0x15ae1a(0xe2)](_0x15ae1a(0x185)+_0x19e18a);return;}const _0x71437c=_0x5867b1[_0x15ae1a(0x180)]?'üîê':'üö®',_0x290717=_0x5867b1[_0x15ae1a(0x180)]?_0x15ae1a(0x188):_0x15ae1a(0x19a);let _0x4403b1=_0x71437c+'\x20*'+_0x290717+_0x15ae1a(0x10a)+(_0x15ae1a(0xe8)+_0x5867b1[_0x15ae1a(0x12a)]+'`\x0a')+(_0x15ae1a(0x1b9)+_0x5867b1[_0x15ae1a(0x13f)]['toLocaleString']('en-US')+'\x0a');_0x5867b1[_0x15ae1a(0x155)]&&(_0x4403b1+=_0x15ae1a(0x14d)+_0x5867b1[_0x15ae1a(0x155)]+'`\x0a');_0x5867b1[_0x15ae1a(0xd3)]&&(_0x4403b1+=_0x15ae1a(0x175)+_0x5867b1[_0x15ae1a(0xd3)]+'\x0a');if(_0x5867b1['userAgent']){const _0x457699=_0x5867b1[_0x15ae1a(0xe3)][_0x15ae1a(0x1c1)]>0x32?_0x5867b1[_0x15ae1a(0xe3)][_0x15ae1a(0x20b)](0x0,0x32)+'...':_0x5867b1[_0x15ae1a(0xe3)];_0x4403b1+='üíª\x20Browser:\x20`'+_0x457699+'`\x0a';}!_0x5867b1[_0x15ae1a(0x180)]&&(_0x4403b1+=_0x15ae1a(0x12d)),await this[_0x15ae1a(0x7e)](_0x19e18a,_0x4403b1,{'parse_mode':_0x15ae1a(0xbe)}),console['log'](_0x15ae1a(0x206)+_0x19e18a+':\x20'+(_0x5867b1[_0x15ae1a(0x180)]?_0x15ae1a(0x180):_0x15ae1a(0xb6)));}catch(_0x5cd9c2){console[_0x15ae1a(0xe6)]('Failed\x20to\x20send\x20login\x20notification:',_0x5cd9c2);}}async[a87_0x22bfde(0x112)](_0x10efc7,_0x9aab8e){const _0x18aa65=a87_0x22bfde;try{const _0x22693f=await database_1[_0x18aa65(0x1c5)][_0x18aa65(0x114)]['findUnique']({'where':{'shopId':_0x10efc7},'select':{'notificationApiError':!![]}});if(!_0x22693f?.['notificationApiError']){console[_0x18aa65(0xe2)](_0x18aa65(0x116)+_0x10efc7);return;}let _0x2f3214=_0x18aa65(0x102)+('üîó\x20Endpoint:\x20`'+_0x9aab8e['method']+'\x20'+_0x9aab8e['endpoint']+'`\x0a')+(_0x18aa65(0x1b9)+_0x9aab8e[_0x18aa65(0x13f)][_0x18aa65(0x169)](_0x18aa65(0x9f))+'\x0a');_0x9aab8e[_0x18aa65(0x1ba)]&&(_0x2f3214+=_0x18aa65(0x181)+_0x9aab8e['statusCode']+'`\x0a'),_0x2f3214+=_0x18aa65(0x174)+_0x9aab8e['errorMessage']+'`\x0a',_0x9aab8e[_0x18aa65(0xd1)]&&(_0x2f3214+=_0x18aa65(0xee)+_0x9aab8e[_0x18aa65(0xd1)]+'`\x0a'),_0x2f3214+=_0x18aa65(0xc2),await this[_0x18aa65(0x7e)](_0x10efc7,_0x2f3214,{'parse_mode':_0x18aa65(0xbe)}),console[_0x18aa65(0xe2)](_0x18aa65(0x134)+_0x10efc7+':\x20'+_0x9aab8e[_0x18aa65(0x8b)]);}catch(_0x982dee){console[_0x18aa65(0xe6)]('Failed\x20to\x20send\x20API\x20error\x20notification:',_0x982dee);}}async[a87_0x22bfde(0xe9)](_0x5f2955,_0x1b4047,_0x287060){const _0x391ae8=a87_0x22bfde;let _0x367220=_0x391ae8(0xb1)+_0x1b4047+_0x391ae8(0x10a);for(const [_0x14f83c,_0x4383b5]of Object[_0x391ae8(0x99)](_0x287060)){_0x4383b5!==null&&_0x4383b5!==undefined&&(_0x367220+=_0x14f83c+_0x391ae8(0xdb)+_0x4383b5+'`\x0a');}await this[_0x391ae8(0x7e)](_0x5f2955,_0x367220,{'parse_mode':'Markdown'});}async[a87_0x22bfde(0x1f9)](_0x3a14e8){const _0x422bd8=a87_0x22bfde;try{console[_0x422bd8(0xe2)](_0x422bd8(0x18b)+_0x3a14e8['substring'](0x0,0x32)+'...');const _0x59c696=await database_1[_0x422bd8(0x1c5)][_0x422bd8(0xf1)][_0x422bd8(0x208)]({'select':{'telegramId':!![]}});if(_0x59c696[_0x422bd8(0x1c1)]===0x0){console[_0x422bd8(0xe2)](_0x422bd8(0x177));return;}for(const _0x258bcc of _0x59c696){try{await this[_0x422bd8(0x1f4)]?.['sendMessage'](_0x258bcc[_0x422bd8(0x166)],_0x3a14e8,{'parse_mode':_0x422bd8(0xbe)});}catch(_0x5d2203){console[_0x422bd8(0xe6)](_0x422bd8(0x7d)+_0x258bcc[_0x422bd8(0x166)]+':',_0x5d2203);}}console[_0x422bd8(0xe2)](_0x422bd8(0x1fc)+_0x59c696['length']+'\x20users');}catch(_0xb5ba9d){console[_0x422bd8(0xe6)](_0x422bd8(0xd0),_0xb5ba9d);}}['getBotInfo'](){const _0x44867e=a87_0x22bfde;return{'isActive':!!this['bot'],'username':this[_0x44867e(0x191)]};}async[a87_0x22bfde(0x18e)](_0xdb0a69,_0x20357,_0x3a3857,_0x4d4218){const _0x48f974=a87_0x22bfde;try{if(!this[_0x48f974(0x1f4)])return console['error'](_0x48f974(0x11d)),![];const _0x118096=await database_1[_0x48f974(0x1c5)][_0x48f974(0xf1)][_0x48f974(0x208)]({'where':{'shopId':_0xdb0a69,'isVerified':!![]},'select':{'telegramId':!![]}});if(_0x118096[_0x48f974(0x1c1)]===0x0)return console[_0x48f974(0xe6)](_0x48f974(0x84)+_0xdb0a69),![];let _0xc5cd77=0x0;for(const _0x54bc4a of _0x118096){try{await this['bot']['sendDocument'](_0x54bc4a[_0x48f974(0x166)],_0x20357,{},{'filename':_0x3a3857,'contentType':_0x3a3857[_0x48f974(0x11f)](_0x48f974(0xcf))?_0x48f974(0x1b8):_0x3a3857[_0x48f974(0x11f)]('.jpg')||_0x3a3857[_0x48f974(0x11f)](_0x48f974(0x1b3))?_0x48f974(0x115):_0x3a3857[_0x48f974(0x11f)](_0x48f974(0xd4))?_0x48f974(0x12c):_0x48f974(0x101)}),_0x4d4218&&await this[_0x48f974(0x1f4)][_0x48f974(0x1d1)](_0x54bc4a[_0x48f974(0x166)],_0x4d4218),_0xc5cd77++;}catch(_0x5eef23){console['error'](_0x48f974(0x1c8)+_0x54bc4a['telegramId']+':',_0x5eef23);}}return console['log'](_0x48f974(0x1c9)+_0xc5cd77+'/'+_0x118096[_0x48f974(0x1c1)]+'\x20users\x20of\x20shop\x20'+_0xdb0a69+':\x20'+_0x3a3857),_0xc5cd77>0x0;}catch(_0x599b72){return console[_0x48f974(0xe6)]('‚ùå\x20Error\x20sending\x20file\x20to\x20shop:',_0x599b72),![];}}async[a87_0x22bfde(0x119)](_0x519768,_0x27d153){const _0x457c80=a87_0x22bfde;try{if(!this['bot'])return console[_0x457c80(0xe6)](_0x457c80(0x11d)),![];return await this[_0x457c80(0x1f4)][_0x457c80(0x1d1)](_0x519768,_0x27d153),console['log'](_0x457c80(0x7c)+_0x519768),!![];}catch(_0x2449e7){return console['error']('‚ùå\x20Error\x20sending\x20direct\x20message:',_0x2449e7),![];}}async['sendDirectFile'](_0x15447a,_0x16f3c6,_0x3ed2a1,_0x13a481){const _0x3fd2ff=a87_0x22bfde;try{if(!this[_0x3fd2ff(0x1f4)])return console[_0x3fd2ff(0xe6)](_0x3fd2ff(0x11d)),![];return await this[_0x3fd2ff(0x1f4)][_0x3fd2ff(0x1fd)](_0x15447a,_0x16f3c6,{},{'filename':_0x3ed2a1,'contentType':_0x3ed2a1['endsWith']('.png')?_0x3fd2ff(0x1b8):_0x3ed2a1[_0x3fd2ff(0x11f)](_0x3fd2ff(0xae))||_0x3ed2a1[_0x3fd2ff(0x11f)](_0x3fd2ff(0x1b3))?_0x3fd2ff(0x115):_0x3ed2a1[_0x3fd2ff(0x11f)](_0x3fd2ff(0xd4))?_0x3fd2ff(0x12c):_0x3fd2ff(0x101)}),_0x13a481&&await this[_0x3fd2ff(0x1f4)][_0x3fd2ff(0x1d1)](_0x15447a,_0x13a481),console['log'](_0x3fd2ff(0xa0)+_0x15447a+':\x20'+_0x3ed2a1),!![];}catch(_0x2cd5fc){return console['error'](_0x3fd2ff(0x108),_0x2cd5fc),![];}}async[a87_0x22bfde(0xad)](_0x27596d,_0x4e1246,_0x539da0,_0x95ff5a){const _0x32c7f0=a87_0x22bfde,_0x313b15=this[_0x32c7f0(0x1a3)]['get'](_0x4e1246)||{};try{if(_0x539da0===_0x32c7f0(0x168)){this['paymentLinkSessions'][_0x32c7f0(0x18c)](_0x4e1246),await this[_0x32c7f0(0x1f4)]?.[_0x32c7f0(0xcc)](_0x32c7f0(0x1e5),{'chat_id':_0x27596d,'message_id':_0x95ff5a});return;}if(_0x539da0==='pl_view_list'){await this[_0x32c7f0(0x1bb)](_0x27596d,_0x4e1246,_0x95ff5a,0x1);return;}if(_0x539da0[_0x32c7f0(0x160)]('pl_page_')){const _0x34105c=parseInt(_0x539da0['replace'](_0x32c7f0(0xf0),''));await this[_0x32c7f0(0x1bb)](_0x27596d,_0x4e1246,_0x95ff5a,_0x34105c);return;}if(_0x539da0==='pl_create_new'){const _0x34831a=await database_1['default']['telegramUser']['findUnique']({'where':{'telegramId':_0x4e1246},'include':{'shop':!![]}});if(!_0x34831a?.['shop']?.[_0x32c7f0(0x16f)]){await this[_0x32c7f0(0x1f4)]?.[_0x32c7f0(0xcc)](_0x32c7f0(0x164),{'chat_id':_0x27596d,'message_id':_0x95ff5a});return;}let _0x4ba6e2;try{_0x4ba6e2=JSON[_0x32c7f0(0xea)](_0x34831a[_0x32c7f0(0x14c)][_0x32c7f0(0x16f)]);}catch{_0x4ba6e2=_0x34831a[_0x32c7f0(0x14c)]['paymentGateways'][_0x32c7f0(0x1cb)](',')[_0x32c7f0(0x18a)](_0xc43ff=>_0xc43ff[_0x32c7f0(0xb2)]());}if(_0x4ba6e2[_0x32c7f0(0x1c1)]===0x0){await this[_0x32c7f0(0x1f4)]?.[_0x32c7f0(0xcc)]('‚ùå\x20No\x20active\x20gateways\x20found.\x20Please\x20enable\x20at\x20least\x20one\x20gateway\x20in\x20the\x20admin\x20panel.',{'chat_id':_0x27596d,'message_id':_0x95ff5a});return;}this[_0x32c7f0(0x1a3)][_0x32c7f0(0x100)](_0x4e1246,{'step':'gateway'});const _0x57d422=_0x4ba6e2[_0x32c7f0(0x90)](_0x153f33=>{const _0x271c94=_0x32c7f0,_0x4d4401=Object[_0x271c94(0x143)](gateway_1[_0x271c94(0x1ab)])[_0x271c94(0xc6)](_0x2e5e28=>gateway_1[_0x271c94(0x1ab)][_0x2e5e28]===_0x153f33)||_0x153f33;return[{'text':_0x271c94(0x15e)+_0x4d4401,'callback_data':_0x271c94(0x83)+_0x4d4401}];});await this[_0x32c7f0(0x1f4)]?.['editMessageText']('üîó\x20*Create\x20Payment\x20Link*\x0a\x0aStep\x201/4:\x20Select\x20gateway',{'chat_id':_0x27596d,'message_id':_0x95ff5a,'parse_mode':'Markdown','reply_markup':{'inline_keyboard':[..._0x57d422,[{'text':_0x32c7f0(0x104),'callback_data':_0x32c7f0(0x168)}]]}});return;}if(_0x539da0[_0x32c7f0(0x160)](_0x32c7f0(0x83))){const _0x15c08d=_0x539da0[_0x32c7f0(0xc4)](_0x32c7f0(0x83),'');_0x313b15[_0x32c7f0(0x209)]=_0x15c08d,_0x313b15[_0x32c7f0(0xbb)]=_0x32c7f0(0xfa),this[_0x32c7f0(0x1a3)][_0x32c7f0(0x100)](_0x4e1246,_0x313b15),await this[_0x32c7f0(0x1f4)]?.[_0x32c7f0(0xcc)]('üîó\x20*Create\x20Payment\x20Link*\x0a\x0a'+_0x32c7f0(0x94),{'chat_id':_0x27596d,'message_id':_0x95ff5a,'parse_mode':_0x32c7f0(0xbe),'reply_markup':{'inline_keyboard':[[{'text':'üîÇ\x20Single\x20Use','callback_data':'pl_type_single'}],[{'text':_0x32c7f0(0x106),'callback_data':_0x32c7f0(0x93)}],[{'text':'‚ùå\x20Cancel','callback_data':'pl_cancel'}]]}});return;}if(_0x539da0['startsWith'](_0x32c7f0(0x139))){const _0x37ea68=_0x539da0[_0x32c7f0(0xc4)]('pl_type_','')[_0x32c7f0(0x1b0)]();_0x313b15[_0x32c7f0(0xfa)]=_0x37ea68,_0x313b15[_0x32c7f0(0xbb)]=_0x32c7f0(0x127),this[_0x32c7f0(0x1a3)][_0x32c7f0(0x100)](_0x4e1246,_0x313b15);const _0x1e51be=this[_0x32c7f0(0x197)](_0x313b15[_0x32c7f0(0x209)]),_0x406145=_0x1e51be[_0x32c7f0(0x15a)](0x0,0x14)[_0x32c7f0(0x90)](_0x555ce2=>[{'text':_0x555ce2,'callback_data':_0x32c7f0(0x1ee)+_0x555ce2}]);await this[_0x32c7f0(0x1f4)]?.['editMessageText']('üîó\x20*Create\x20Payment\x20Link*\x0a\x0a'+_0x32c7f0(0x1ca),{'chat_id':_0x27596d,'message_id':_0x95ff5a,'parse_mode':_0x32c7f0(0xbe),'reply_markup':{'inline_keyboard':[..._0x406145,[{'text':_0x32c7f0(0x104),'callback_data':_0x32c7f0(0x168)}]]}});return;}if(_0x539da0['startsWith'](_0x32c7f0(0x1ee))){const _0x4acd4c=_0x539da0[_0x32c7f0(0xc4)](_0x32c7f0(0x1ee),'');_0x313b15[_0x32c7f0(0x127)]=_0x4acd4c,_0x313b15[_0x32c7f0(0xbb)]=_0x32c7f0(0x1d4),this[_0x32c7f0(0x1a3)][_0x32c7f0(0x100)](_0x4e1246,_0x313b15),await this['bot']?.['editMessageText']('üîó\x20*Create\x20Payment\x20Link*\x0a\x0a'+_0x32c7f0(0x187)+(_0x32c7f0(0x1d7)+_0x4acd4c+_0x32c7f0(0x161)),{'chat_id':_0x27596d,'message_id':_0x95ff5a,'parse_mode':_0x32c7f0(0xbe)});return;}}catch(_0x549637){console[_0x32c7f0(0xe6)](_0x32c7f0(0x1c4),_0x549637),await this['bot']?.[_0x32c7f0(0x1d1)](_0x27596d,'‚ùå\x20An\x20error\x20occurred.\x20Please\x20try\x20again.'),this[_0x32c7f0(0x1a3)]['delete'](_0x4e1246);}}async[a87_0x22bfde(0x1bb)](_0x4f21b0,_0x557ca3,_0x281fc6,_0x29104d=0x1){const _0x57be6e=a87_0x22bfde;try{const _0x222678=await database_1[_0x57be6e(0x1c5)][_0x57be6e(0xf1)][_0x57be6e(0xbd)]({'where':{'telegramId':_0x557ca3},'include':{'shop':!![]}});if(!_0x222678?.['shopId']){await this[_0x57be6e(0x1f4)]?.[_0x57be6e(0x1d1)](_0x4f21b0,_0x57be6e(0x1b7));return;}const _0x13581d=0x5,_0x310afc=(_0x29104d-0x1)*_0x13581d,[_0x340ed8,_0xa792de]=await Promise[_0x57be6e(0x1a2)]([database_1[_0x57be6e(0x1c5)]['paymentLink'][_0x57be6e(0x208)]({'where':{'shopId':_0x222678[_0x57be6e(0x201)]},'orderBy':{'createdAt':_0x57be6e(0x1cc)},'take':_0x13581d,'skip':_0x310afc}),database_1['default']['paymentLink'][_0x57be6e(0x1b4)]({'where':{'shopId':_0x222678[_0x57be6e(0x201)]}})]),_0x208bad=Math['ceil'](_0xa792de/_0x13581d);if(_0x340ed8[_0x57be6e(0x1c1)]===0x0){const _0x17e577=_0x57be6e(0x126);_0x281fc6?await this[_0x57be6e(0x1f4)]?.[_0x57be6e(0xcc)](_0x17e577,{'chat_id':_0x4f21b0,'message_id':_0x281fc6,'parse_mode':_0x57be6e(0xa5),'reply_markup':{'inline_keyboard':[[{'text':'‚ûï\x20Create\x20New\x20Link','callback_data':_0x57be6e(0x16b)}]]}}):await this[_0x57be6e(0x1f4)]?.[_0x57be6e(0x1d1)](_0x4f21b0,_0x17e577,{'parse_mode':'MarkdownV2','reply_markup':{'inline_keyboard':[[{'text':_0x57be6e(0x12e),'callback_data':_0x57be6e(0x16b)}]]}});return;}let _0x333eb6=_0x57be6e(0x1dc)+_0x29104d+'/'+_0x208bad+_0x57be6e(0xef);_0x340ed8[_0x57be6e(0x130)]((_0x1bf6aa,_0x4d5fab)=>{const _0x6740a2=_0x57be6e,_0x38f762=_0x310afc+_0x4d5fab+0x1,_0x50af98=_0x1bf6aa[_0x6740a2(0x1d4)]?_0x1bf6aa['amount']+'\x20'+_0x1bf6aa['currency']:_0x6740a2(0x178),_0x21f4e2=_0x1bf6aa['status']===_0x6740a2(0x179)?'‚úÖ':'‚ùå',_0x3c7979=(process.env.FRONTEND_URL||_0x6740a2(0x1a9))+_0x6740a2(0x1e3)+_0x1bf6aa['id'],_0x4dc260=_0x3c7979[_0x6740a2(0xc4)](/\./g,'\x5c.')[_0x6740a2(0xc4)](/-/g,'\x5c-')[_0x6740a2(0xc4)](/\//g,'\x5c/');_0x333eb6+=_0x38f762+'\x5c.\x20'+_0x21f4e2+'\x20*'+_0x50af98+'*\x0a',_0x333eb6+=_0x6740a2(0x9a)+_0x1bf6aa[_0x6740a2(0x209)]+_0x6740a2(0xd2)+_0x1bf6aa[_0x6740a2(0xfa)]+'\x0a',_0x333eb6+=_0x6740a2(0x1fe)+_0x4dc260+_0x6740a2(0x7b);});const _0x310d23=[];_0x29104d>0x1&&_0x310d23['push']({'text':_0x57be6e(0x11e),'callback_data':_0x57be6e(0xf0)+(_0x29104d-0x1)});_0x29104d<_0x208bad&&_0x310d23[_0x57be6e(0xb9)]({'text':_0x57be6e(0x16d),'callback_data':_0x57be6e(0xf0)+(_0x29104d+0x1)});const _0x1aa592=[];_0x310d23[_0x57be6e(0x1c1)]>0x0&&_0x1aa592[_0x57be6e(0xb9)](_0x310d23),_0x1aa592[_0x57be6e(0xb9)]([{'text':_0x57be6e(0x12e),'callback_data':_0x57be6e(0x16b)}]),_0x1aa592[_0x57be6e(0xb9)]([{'text':_0x57be6e(0x1a5),'callback_data':_0x57be6e(0x168)}]),_0x281fc6?await this['bot']?.['editMessageText'](_0x333eb6,{'chat_id':_0x4f21b0,'message_id':_0x281fc6,'parse_mode':_0x57be6e(0xa5),'reply_markup':{'inline_keyboard':_0x1aa592}}):await this[_0x57be6e(0x1f4)]?.[_0x57be6e(0x1d1)](_0x4f21b0,_0x333eb6,{'parse_mode':'MarkdownV2','reply_markup':{'inline_keyboard':_0x1aa592}});}catch(_0x570db8){console[_0x57be6e(0xe6)]('Error\x20showing\x20payment\x20links\x20list:',_0x570db8),await this[_0x57be6e(0x1f4)]?.[_0x57be6e(0x1d1)](_0x4f21b0,_0x57be6e(0xc3));}}[a87_0x22bfde(0x197)](_0x16d36f){const _0x2c2493=a87_0x22bfde,_0x5aef94={'1000':[_0x2c2493(0x151),'GBP',_0x2c2493(0x105)],'0001':['USD',_0x2c2493(0x151),_0x2c2493(0x17f),_0x2c2493(0x8e),_0x2c2493(0x1f8)],'0010':['USD',_0x2c2493(0x151),_0x2c2493(0x17f),_0x2c2493(0x8e),'AUD'],'1111':[_0x2c2493(0x151)],'0000':[_0x2c2493(0x151),_0x2c2493(0x105),_0x2c2493(0x1f8),_0x2c2493(0x8e),'GBP',_0x2c2493(0x1d5),_0x2c2493(0x1c0)],'1110':['EUR',_0x2c2493(0x105),_0x2c2493(0x17f)],'2000':[_0x2c2493(0x151)],'2001':[_0x2c2493(0x151)],'2010':['EUR'],'2011':[_0x2c2493(0x8e)],'2002':[_0x2c2493(0x1bc)],'3000':[_0x2c2493(0x1bc),_0x2c2493(0x1a6),_0x2c2493(0x151),'USD',_0x2c2493(0x1f8),_0x2c2493(0x1a0),_0x2c2493(0xba),_0x2c2493(0x8e),_0x2c2493(0x17f),'ARS',_0x2c2493(0x17b)],'3001':[_0x2c2493(0x105),_0x2c2493(0x151)],'3002':['EUR',_0x2c2493(0x105),_0x2c2493(0x1a6),_0x2c2493(0x17f),_0x2c2493(0x1f8),_0x2c2493(0x8e),_0x2c2493(0x11a),_0x2c2493(0x1c0)],'3004':[_0x2c2493(0x20a),'BTC',_0x2c2493(0xf8),_0x2c2493(0x89),'BNB',_0x2c2493(0x96),'POL',_0x2c2493(0xdf),'SOL',_0x2c2493(0x141)]};return _0x5aef94[_0x16d36f]||['USD'];}['stopBot'](){const _0x296ae6=a87_0x22bfde;this[_0x296ae6(0x1f4)]&&(this[_0x296ae6(0x1f4)][_0x296ae6(0xb4)](),this['bot']=null,console[_0x296ae6(0xe2)](_0x296ae6(0x1f0)));}}exports['TelegramBotService']=TelegramBotService,exports['telegramBotService']=new TelegramBotService();