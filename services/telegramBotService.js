'use strict';function a74_0x4c1c(){const _0xda26f3=['sendCustomNotification','\x22\x20->\x20display\x20\x22','üîó\x20*Transaction\x20Link:*\x20`','üì±\x20Notification\x20sent\x20to\x20','isVerified','üìù\x20Format:\x20`username\x20api_key`\x0a\x0a','‚ùå\x20API\x20key\x20does\x20not\x20match\x20shop\x20`','name','`\x0a\x0a','telegramId','Username\x20must\x20contain\x20only\x20letters,\x20numbers\x20and\x20underscore\x20(3-50\x20characters).','‚ùå\x20Error\x20getting\x20debug\x20information.','68278DuUGsK','Use\x20/start\x20to\x20connect.','‚ùå\x20Invalid\x20username\x20format:\x20`','‚ùå\x20Invalid\x20format.\x20Please\x20send\x20exactly\x202\x20parts\x20separated\x20by\x20space:\x0a\x0a','‚úÖ\x20Telegram\x20user\x20','toLocaleDateString','findMany','handleSingleLineVerification','chat','Username:\x20`','application/pdf','chargebackAmount','‚Ä¢\x20New\x20payments\x0a','No\x20verified\x20Telegram\x20users\x20found\x20for\x20shop\x20','wallet','/status\x20-\x20check\x20connection\x20status\x0a','üåê\x20*Network:*\x20','TELEGRAM_BOT_TOKEN','üìß\x20Email:\x20`','toString','adminNotes',':\x20`','user\x20is\x20deactivated','blocked','‚úÖ\x20Direct\x20message\x20sent\x20to\x20chat\x20','18nfwQLe','Check\x20the\x20key\x20and\x20try\x20again.\x0a\x0a','1000296QHqgwA','updatedAt','Error\x20handling\x20/start\x20command:','network','...','node-telegram-bot-api','userAgent','notificationLogin','‚ùå\x20Please\x20use\x20/start\x20command\x20first','../config/database','‚Ä¢\x20Payouts\x0a\x0a','‚ùå\x20Error\x20sending\x20file\x20to\x20user\x20','substring','includes','shopSettings','Markdown','\x0a‚ö†Ô∏è\x20If\x20this\x20wasn\x27t\x20you,\x20change\x20your\x20password\x20immediately!','\x20marked\x20as\x20unverified\x20due\x20to\x20delivery\x20failure','chat\x20not\x20found','‚úÖ\x20File\x20sent\x20to\x20','üí∏\x20Penalty\x20amount:\x20*','findFirst','‚ùå\x20No\x20verified\x20Telegram\x20users\x20found\x20for\x20shop\x20ID:\x20','Payment\x20chargeback','TelegramBotService','ACTIVE','\x20\x20\x20Name:\x20*','length','üë§\x20Username:\x20`','first_name','üîÑ\x20Reset\x20incomplete\x20verification\x20for\x20user\x20','shop','üîó\x20Endpoint:\x20`','‚ùå\x20Error:\x20`','üì±\x20Created\x20new\x20Telegram\x20user:\x20','Error\x20sending\x20shop\x20notification:','__importDefault','Successful\x20login','Failed\x20to\x20send\x20API\x20error\x20notification:','Use\x20/start\x20to\x20begin.','Expected\x20key\x20format:\x20`pk_...`\x20or\x20`sk_...`','numeric','botToken','To\x20receive\x20payment\x20notifications,\x20send\x20your\x20credentials\x20in\x20one\x20line:\x0a\x0a','Not\x20specified','‚ùå\x20You\x20are\x20not\x20registered\x20in\x20the\x20system.\x0a\x0a','telegramBotService','/disconnect\x20-\x20disconnect\x20from\x20notifications','amount','sendMessage','findUnique','798136TsVeYA','endsWith','Payment\x20expired','map','‚ùå\x20Error\x20sending\x20file\x20to\x20chat:','You\x20are\x20already\x20connected\x20to\x20shop:\x20*','Commands:\x0a','allSettled','customerUa','customerName','__esModule','Error\x20handling\x20message:','‚úÖ\x20API\x20error\x20notification\x20sent\x20for\x20shop\x20','sendDocument','üîî\x20*','test','‚ùå\x20Failed\x20to\x20send\x20notification\x20to\x20Telegram\x20user\x20','update','\x0aüë§\x20*Customer\x20Information:*\x0a','üìõ\x20Name:\x20`','üö®\x20*API\x20Error*\x0a\x0a','Use\x20/status\x20to\x20check\x20status\x20or\x20/disconnect\x20to\x20disconnect.','‚úÖ\x20Connected\x20to\x20shop:\x20*','New\x20payment\x20created','warn','\x20via\x20single-line\x20input','create','‚úÖ\x20You\x20have\x20been\x20successfully\x20disconnected\x20from\x20shop\x20*','‚ùå\x20Telegram\x20bot\x20not\x20initialized','shopId','\x20users\x20of\x20shop\x20','‚ùå\x20Shop\x20with\x20username\x20`','üí≥\x20*Wallet:*\x20`','.pdf','‚ùå\x20Error\x20sending\x20direct\x20message:','2-digit','endpoint','‚ùóÔ∏è\x20Make\x20sure\x20to\x20separate\x20username\x20and\x20API\x20key\x20with\x20a\x20space!','üîî\x20Notifications\x20are\x20active\x0a\x0a','548800dNLqyj','üîç\x20*Debug\x20Information*\x0a\x0a','üîî\x20You\x20will\x20now\x20receive\x20notifications\x20about:\x0a','üì±\x20Sending\x20notification\x20to\x20all\x20connected\x20users:\x20','processing','*.\x0a\x0a','\x22,\x20apiKey=\x22','orderId','Telegram\x20bot\x20error:','‚ùå\x20Error\x20sending\x20file\x20to\x20shop:','sendShopFile','failed','default','`\x20is\x20inactive.\x0a\x0a','‚úÖ\x20Login\x20notification\x20sent\x20for\x20shop\x20','getGatewayDisplayNameForTelegram','stopBot','\x20disconnected\x20from\x20shop\x20','üì±\x20API\x20error\x20notifications\x20disabled\x20for\x20shop\x20','publicKey',':\x20username=\x22','4aevUtP','üì±\x20Your\x20Telegram\x20ID:\x20`','üì±\x20No\x20active\x20Telegram\x20users\x20found','üåç\x20Country:\x20','success','üì±\x20Login\x20notifications\x20disabled\x20for\x20shop\x20','ü§ñ\x20Welcome\x20to\x20TRAPAY\x20notification\x20system!\x0a\x0a','ipAddress','startsWith','‚Ä¢\x20Payouts\x0a','sendPaymentNotification','üì±\x20Telegram\x20notification:\x20gateway\x20\x22','message','üîó\x20*Transaction\x20Link:*\x20Pending','Make\x20sure\x20you\x20have\x20the\x20correct\x20username\x20from\x20your\x20account.','Payment\x20refund','from','sendNotificationToAll','‚ùå\x20Failed\x20to\x20send\x20message\x20to\x20user\x20','entries','‚ùå\x20An\x20error\x20occurred\x20while\x20verifying\x20data.','üÜî\x20Payment\x20ID:\x20`','image/png','customerEmail','Payment\x20failed','‚úÖ\x20You\x20have\x20been\x20successfully\x20connected\x20to\x20the\x20notification\x20system!\x0a\x0a','`.\x0a\x0a','polling_error','*\x0a\x0a','.png','API\x20key\x20must\x20start\x20with\x20`pk\x5c_`\x20or\x20`sk\x5c_`.','üìù\x20Order\x20ID:\x20`','setupBotHandlers','To\x20reconnect,\x20use\x20the\x20/start\x20command','‚úÖ\x20Notification\x20sent\x20to\x20Telegram\x20user\x20','telegramUser','4BYPgiE','timestamp','\x20verified\x20for\x20shop\x20','115485HzoKOK','üìÖ\x20Connection\x20date:\x20','statusCode','üîÑ\x20Processing\x20single-line\x20verification\x20for\x20user\x20','üåê\x20IP\x20address:\x20`','currency','üí∞\x20*Amount:*\x20','‚ùå\x20You\x20are\x20not\x20connected\x20to\x20the\x20notification\x20system.','.jpeg','application/octet-stream','status','\x20\x20\x20Status:\x20','requestId','en-US','username','1031996vMJOSM','errorMessage','üõë\x20Telegram\x20bot\x20stopped','chargeback','‚Ä¢\x20Payment\x20status\x20changes\x0a','‚ùå\x20Shop\x20`','env','Error\x20in\x20handleSingleLineVerification:','üè™\x20Your\x20connected\x20shop:\x0a','log','bot','image/jpeg','‚ùå\x20An\x20error\x20occurred.\x20Please\x20try\x20again\x20later.','sendShopNotification','unknown\x20shop','‚ùå\x20Invalid\x20API\x20key\x20format.\x0a\x0a','Please\x20check\x20the\x20spelling\x20and\x20try\x20again.\x0a\x0a','\x20USD\x0a','‚ùå\x20Failed\x20to\x20send\x20notification\x20to\x20all\x20users:','‚ùå\x20Failed\x20to\x20initialize\x20Telegram\x20bot:','‚ùå\x20You\x20are\x20not\x20connected\x20to\x20a\x20shop.\x0a\x0a','geo','`\x20not\x20found.\x0a\x0a','üåê\x20IP:\x20`','trim','3183840SlQWxn','error','customerIp','notificationApiError','üì±\x20Shop:\x20*','üìÖ\x20*Payout\x20Date:*\x20','txid','üíª\x20Browser:\x20`','onText','.jpg','toLocaleString','botUsername','initializeBot','`appple\x20pk_aa6450d3f57afbefbb0f3f5be5ce6cca13037536afc5ccf14c81a6cbc7a07de5`\x0a\x0a','sendApiErrorNotification','Example:\x0a','text','...\x22','‚ùå\x20Another\x20Telegram\x20account\x20is\x20already\x20connected\x20to\x20shop\x20`','Telegram\x20bot\x20polling\x20error:','Failed\x20login\x20attempt','sendPayoutNotification','defineProperty','Telegram\x20bot\x20not\x20initialized,\x20cannot\x20send\x20notification','remitterIban','üìÖ\x20Time:\x20','Payment\x20successfully\x20paid','Error\x20handling\x20/debug\x20command:','getBotInfo','sk_','‚úÖ\x20File\x20sent\x20to\x20chat\x20'];a74_0x4c1c=function(){return _0xda26f3;};return a74_0x4c1c();}const a74_0x4c6229=a74_0x4776;(function(_0x16959a,_0x507d43){const _0x537ae7=a74_0x4776,_0x5c3c59=_0x16959a();while(!![]){try{const _0x40903f=-parseInt(_0x537ae7(0x218))/0x1*(parseInt(_0x537ae7(0x16a))/0x2)+parseInt(_0x537ae7(0x21b))/0x3*(parseInt(_0x537ae7(0x1f4))/0x4)+parseInt(_0x537ae7(0x1df))/0x5+-parseInt(_0x537ae7(0x185))/0x6+parseInt(_0x537ae7(0x22a))/0x7+parseInt(_0x537ae7(0x1b8))/0x8*(-parseInt(_0x537ae7(0x183))/0x9)+parseInt(_0x537ae7(0x243))/0xa;if(_0x40903f===_0x507d43)break;else _0x5c3c59['push'](_0x5c3c59['shift']());}catch(_0x2a55f6){_0x5c3c59['push'](_0x5c3c59['shift']());}}}(a74_0x4c1c,0x1b29d));var __importDefault=this&&this[a74_0x4c6229(0x1a9)]||function(_0xe85c40){return _0xe85c40&&_0xe85c40['__esModule']?_0xe85c40:{'default':_0xe85c40};};Object[a74_0x4c6229(0x155)](exports,a74_0x4c6229(0x1c2),{'value':!![]}),exports['telegramBotService']=exports[a74_0x4c6229(0x19d)]=void 0x0;function a74_0x4776(_0x2f3008,_0x3e76b0){_0x2f3008=_0x2f3008-0x140;const _0x4c1c7f=a74_0x4c1c();let _0x4776ba=_0x4c1c7f[_0x2f3008];return _0x4776ba;}const node_telegram_bot_api_1=__importDefault(require(a74_0x4c6229(0x18a))),database_1=__importDefault(require(a74_0x4c6229(0x18e))),gateway_1=require('../types/gateway');class TelegramBotService{constructor(){const _0x53cfda=a74_0x4c6229;this[_0x53cfda(0x234)]=null,this[_0x53cfda(0x1af)]=process[_0x53cfda(0x230)][_0x53cfda(0x17b)]||'',this[_0x53cfda(0x14a)]=process['env']['TELEGRAM_BOT_USERNAME']||'trapay_bot',this[_0x53cfda(0x1af)]?this[_0x53cfda(0x14b)]():console[_0x53cfda(0x1d0)]('TELEGRAM_BOT_TOKEN\x20not\x20found\x20in\x20environment\x20variables');}[a74_0x4c6229(0x14b)](){const _0xaeafb8=a74_0x4c6229;try{this[_0xaeafb8(0x234)]=new node_telegram_bot_api_1[(_0xaeafb8(0x1eb))](this[_0xaeafb8(0x1af)],{'polling':!![]}),this[_0xaeafb8(0x214)](),console['log']('‚úÖ\x20Telegram\x20bot\x20@'+this[_0xaeafb8(0x14a)]+'\x20initialized\x20successfully');}catch(_0x37226d){console[_0xaeafb8(0x140)](_0xaeafb8(0x23d),_0x37226d);}}[a74_0x4c6229(0x214)](){const _0xd96e12=a74_0x4c6229;if(!this[_0xd96e12(0x234)])return;this['bot'][_0xd96e12(0x147)](/\/start/,async _0x10241c=>{const _0x2d329b=_0xd96e12,_0x21b4c5=_0x10241c[_0x2d329b(0x172)]['id'],_0x3bfce1=_0x10241c[_0x2d329b(0x204)]?.['id'][_0x2d329b(0x17d)](),_0x366cae=_0x10241c[_0x2d329b(0x204)]?.[_0x2d329b(0x229)],_0xf66195=_0x10241c[_0x2d329b(0x204)]?.[_0x2d329b(0x1a2)],_0x58758d=_0x10241c['from']?.['last_name'];if(!_0x3bfce1)return;try{let _0x50a2c7=await database_1[_0x2d329b(0x1eb)][_0x2d329b(0x217)][_0x2d329b(0x1b7)]({'where':{'telegramId':_0x3bfce1},'include':{'shop':!![]}});!_0x50a2c7?(_0x50a2c7=await database_1[_0x2d329b(0x1eb)][_0x2d329b(0x217)][_0x2d329b(0x1d2)]({'data':{'telegramId':_0x3bfce1,'username':_0x366cae,'firstName':_0xf66195,'lastName':_0x58758d,'isVerified':![],'shopId':null},'include':{'shop':!![]}}),console[_0x2d329b(0x233)](_0x2d329b(0x1a7)+_0x3bfce1+'\x20(@'+_0x366cae+')')):_0x50a2c7=await database_1[_0x2d329b(0x1eb)][_0x2d329b(0x217)][_0x2d329b(0x1c9)]({'where':{'telegramId':_0x3bfce1},'data':{'username':_0x366cae,'firstName':_0xf66195,'lastName':_0x58758d},'include':{'shop':!![]}}),_0x50a2c7[_0x2d329b(0x162)]&&_0x50a2c7[_0x2d329b(0x1d5)]&&_0x50a2c7[_0x2d329b(0x1a4)]?await this['bot']?.[_0x2d329b(0x1b6)](_0x21b4c5,'‚úÖ\x20Welcome\x20back!\x0a\x0a'+(_0x2d329b(0x1bd)+_0x50a2c7[_0x2d329b(0x1a4)][_0x2d329b(0x165)]+'*\x0a')+(_0x2d329b(0x173)+_0x50a2c7['shop'][_0x2d329b(0x229)]+'`\x0a\x0a')+'üîî\x20You\x20receive\x20notifications\x20about:\x0a'+_0x2d329b(0x176)+_0x2d329b(0x22e)+_0x2d329b(0x18f)+_0x2d329b(0x1be)+'/status\x20-\x20check\x20connection\x20status\x0a'+_0x2d329b(0x1b4),{'parse_mode':_0x2d329b(0x194)}):(_0x50a2c7[_0x2d329b(0x1d5)]&&!_0x50a2c7[_0x2d329b(0x162)]&&(await database_1[_0x2d329b(0x1eb)][_0x2d329b(0x217)][_0x2d329b(0x1c9)]({'where':{'telegramId':_0x3bfce1},'data':{'shopId':null,'isVerified':![]}}),console[_0x2d329b(0x233)](_0x2d329b(0x1a3)+_0x3bfce1)),await this[_0x2d329b(0x234)]?.[_0x2d329b(0x1b6)](_0x21b4c5,_0x2d329b(0x1fa)+_0x2d329b(0x1b0)+_0x2d329b(0x163)+_0x2d329b(0x14e)+'`appple\x20pk_aa6450d3f57afbefbb0f3f5be5ce6cca13037536afc5ccf14c81a6cbc7a07de5`\x0a\x0a'+_0x2d329b(0x1dd),{'parse_mode':'Markdown'}));}catch(_0x4d0ad6){console['error'](_0x2d329b(0x187),_0x4d0ad6),await this['bot']?.[_0x2d329b(0x1b6)](_0x21b4c5,_0x2d329b(0x236));}}),this[_0xd96e12(0x234)][_0xd96e12(0x147)](/\/disconnect/,async _0x34ccf9=>{const _0x107921=_0xd96e12,_0x2e233a=_0x34ccf9[_0x107921(0x172)]['id'],_0x118025=_0x34ccf9[_0x107921(0x204)]?.['id'][_0x107921(0x17d)]();if(!_0x118025)return;try{const _0x5ed6ae=await database_1['default'][_0x107921(0x217)]['findUnique']({'where':{'telegramId':_0x118025},'include':{'shop':!![]}});if(!_0x5ed6ae||!_0x5ed6ae[_0x107921(0x162)]||!_0x5ed6ae['shopId']){await this[_0x107921(0x234)]?.['sendMessage'](_0x2e233a,_0x107921(0x222));return;}const _0x3c2f5a=_0x5ed6ae[_0x107921(0x1a4)]?.[_0x107921(0x165)]||_0x107921(0x238);await database_1[_0x107921(0x1eb)][_0x107921(0x217)]['update']({'where':{'telegramId':_0x118025},'data':{'shopId':null,'isVerified':![]}}),console[_0x107921(0x233)]('üîå\x20User\x20'+_0x118025+_0x107921(0x1f0)+_0x5ed6ae['shopId']),await this[_0x107921(0x234)]?.[_0x107921(0x1b6)](_0x2e233a,_0x107921(0x1d3)+_0x3c2f5a+_0x107921(0x1e4)+_0x107921(0x215),{'parse_mode':_0x107921(0x194)});}catch(_0x26b7d7){console[_0x107921(0x140)]('Error\x20handling\x20/disconnect\x20command:',_0x26b7d7),await this['bot']?.[_0x107921(0x1b6)](_0x2e233a,'‚ùå\x20An\x20error\x20occurred.\x20Please\x20try\x20again\x20later.');}}),this[_0xd96e12(0x234)][_0xd96e12(0x147)](/\/status/,async _0x1a161b=>{const _0x154f13=_0xd96e12,_0x2ed18d=_0x1a161b['chat']['id'],_0x46ee7b=_0x1a161b[_0x154f13(0x204)]?.['id'][_0x154f13(0x17d)]();if(!_0x46ee7b)return;try{const _0x53320f=await database_1[_0x154f13(0x1eb)][_0x154f13(0x217)][_0x154f13(0x1b7)]({'where':{'telegramId':_0x46ee7b},'include':{'shop':!![]}});if(!_0x53320f){await this['bot']?.[_0x154f13(0x1b6)](_0x2ed18d,_0x154f13(0x1b2)+_0x154f13(0x1ac));return;}if(!_0x53320f['isVerified']||!_0x53320f[_0x154f13(0x1d5)]||!_0x53320f['shop']){await this[_0x154f13(0x234)]?.[_0x154f13(0x1b6)](_0x2ed18d,_0x154f13(0x23e)+_0x154f13(0x16b));return;}await this[_0x154f13(0x234)]?.['sendMessage'](_0x2ed18d,'üìä\x20*Connection\x20Status*\x0a\x0a'+(_0x154f13(0x1ce)+_0x53320f[_0x154f13(0x1a4)][_0x154f13(0x165)]+'*\x0a')+(_0x154f13(0x1a1)+_0x53320f[_0x154f13(0x1a4)][_0x154f13(0x229)]+'`\x0a')+(_0x154f13(0x21c)+_0x53320f[_0x154f13(0x186)][_0x154f13(0x16f)](_0x154f13(0x228))+'\x0a\x0a')+_0x154f13(0x1de)+_0x154f13(0x1be)+_0x154f13(0x1b4),{'parse_mode':'Markdown'});}catch(_0x1b9cde){console[_0x154f13(0x140)]('Error\x20handling\x20/status\x20command:',_0x1b9cde),await this[_0x154f13(0x234)]?.['sendMessage'](_0x2ed18d,_0x154f13(0x236));}}),this[_0xd96e12(0x234)][_0xd96e12(0x147)](/\/debug/,async _0x43f5ad=>{const _0x195890=_0xd96e12,_0x346429=_0x43f5ad[_0x195890(0x172)]['id'],_0x460c1e=_0x43f5ad[_0x195890(0x204)]?.['id'][_0x195890(0x17d)]();if(!_0x460c1e)return;try{const _0x35ea1f=await database_1[_0x195890(0x1eb)][_0x195890(0x217)]['findUnique']({'where':{'telegramId':_0x460c1e},'include':{'shop':!![]}});let _0x5787a4=_0x195890(0x1e0);_0x5787a4+=_0x195890(0x1f5)+_0x460c1e+_0x195890(0x166),_0x35ea1f?.[_0x195890(0x162)]&&_0x35ea1f['shop']?(_0x5787a4+=_0x195890(0x232),_0x5787a4+=_0x195890(0x19f)+_0x35ea1f[_0x195890(0x1a4)]['name']+'*\x0a',_0x5787a4+='\x20\x20\x20Username:\x20`'+_0x35ea1f['shop'][_0x195890(0x229)]+'`\x0a',_0x5787a4+=_0x195890(0x226)+_0x35ea1f[_0x195890(0x1a4)][_0x195890(0x225)]+'\x0a\x0a'):_0x5787a4+='‚ùå\x20You\x20are\x20not\x20connected\x20to\x20any\x20shop.\x0a\x0a',_0x5787a4+='Use\x20/start\x20to\x20connect\x20to\x20a\x20shop.',await this[_0x195890(0x234)]?.[_0x195890(0x1b6)](_0x346429,_0x5787a4,{'parse_mode':_0x195890(0x194)});}catch(_0x334af4){console[_0x195890(0x140)](_0x195890(0x15a),_0x334af4),await this[_0x195890(0x234)]?.[_0x195890(0x1b6)](_0x346429,_0x195890(0x169));}}),this[_0xd96e12(0x234)]['on']('message',async _0x26faaa=>{const _0x31db6e=_0xd96e12;if(_0x26faaa[_0x31db6e(0x14f)]?.[_0x31db6e(0x1fc)]('/'))return;const _0x3c8ced=_0x26faaa[_0x31db6e(0x172)]['id'],_0x305fa7=_0x26faaa[_0x31db6e(0x204)]?.['id'][_0x31db6e(0x17d)](),_0xf7d42=_0x26faaa[_0x31db6e(0x14f)]?.[_0x31db6e(0x242)]();if(!_0x305fa7||!_0xf7d42)return;try{const _0xe660fe=await database_1['default'][_0x31db6e(0x217)][_0x31db6e(0x1b7)]({'where':{'telegramId':_0x305fa7},'include':{'shop':!![]}});if(!_0xe660fe){await this['bot']?.[_0x31db6e(0x1b6)](_0x3c8ced,_0x31db6e(0x18d));return;}if(_0xe660fe[_0x31db6e(0x162)]&&_0xe660fe['shopId']&&_0xe660fe['shop']){await this[_0x31db6e(0x234)]?.[_0x31db6e(0x1b6)](_0x3c8ced,'‚úÖ\x20You\x20are\x20already\x20connected\x20to\x20shop\x20*'+_0xe660fe[_0x31db6e(0x1a4)]['name']+_0x31db6e(0x1e4)+_0x31db6e(0x1cd),{'parse_mode':_0x31db6e(0x194)});return;}const _0x3379ea=_0xf7d42['split'](/\s+/);if(_0x3379ea['length']!==0x2){await this[_0x31db6e(0x234)]?.[_0x31db6e(0x1b6)](_0x3c8ced,_0x31db6e(0x16d)+'üìù\x20Format:\x20`username\x20api_key`\x0a\x0a'+_0x31db6e(0x14e)+_0x31db6e(0x14c)+('You\x20sent\x20'+_0x3379ea[_0x31db6e(0x1a0)]+'\x20parts:\x20'+_0x3379ea[_0x31db6e(0x1bb)](_0x1fdc46=>'`'+_0x1fdc46+'`')['join'](',\x20')),{'parse_mode':_0x31db6e(0x194)});return;}const [_0x4a5a6f,_0x4d17c7]=_0x3379ea;console['log'](_0x31db6e(0x21e)+_0x305fa7+_0x31db6e(0x1f3)+_0x4a5a6f+_0x31db6e(0x1e5)+_0x4d17c7[_0x31db6e(0x191)](0x0,0xa)+'...\x22'),await this[_0x31db6e(0x171)](_0x3c8ced,_0x305fa7,_0x4a5a6f,_0x4d17c7);}catch(_0x74c6be){console[_0x31db6e(0x140)](_0x31db6e(0x1c3),_0x74c6be),await this[_0x31db6e(0x234)]?.[_0x31db6e(0x1b6)](_0x3c8ced,_0x31db6e(0x236));}}),this[_0xd96e12(0x234)]['on'](_0xd96e12(0x140),_0x52262c=>{const _0x234c9f=_0xd96e12;console['error'](_0x234c9f(0x1e7),_0x52262c);}),this[_0xd96e12(0x234)]['on'](_0xd96e12(0x20f),_0x43bb17=>{const _0x1fb003=_0xd96e12;console[_0x1fb003(0x140)](_0x1fb003(0x152),_0x43bb17);});}async['handleSingleLineVerification'](_0x5a5906,_0x26d8ee,_0x18e462,_0x39aefc){const _0x1708f5=a74_0x4c6229;try{console[_0x1708f5(0x233)](_0x1708f5(0x21e)+_0x26d8ee+':\x20username=\x22'+_0x18e462+'\x22,\x20apiKey=\x22'+_0x39aefc[_0x1708f5(0x191)](0x0,0xa)+_0x1708f5(0x150));if(!_0x18e462||_0x18e462['length']<0x3||_0x18e462[_0x1708f5(0x1a0)]>0x32||!/^[a-zA-Z0-9_]+$/[_0x1708f5(0x1c7)](_0x18e462)){await this['bot']?.[_0x1708f5(0x1b6)](_0x5a5906,_0x1708f5(0x16c)+_0x18e462+_0x1708f5(0x166)+_0x1708f5(0x168),{'parse_mode':_0x1708f5(0x194)});return;}if(!_0x39aefc||!_0x39aefc['startsWith']('pk_')&&!_0x39aefc[_0x1708f5(0x1fc)](_0x1708f5(0x15c))){await this['bot']?.[_0x1708f5(0x1b6)](_0x5a5906,_0x1708f5(0x239)+_0x1708f5(0x212),{'parse_mode':_0x1708f5(0x194)});return;}const _0x364c14=await database_1['default'][_0x1708f5(0x1a4)]['findUnique']({'where':{'username':_0x18e462},'select':{'id':!![],'name':!![],'username':!![],'status':!![],'publicKey':!![],'secretKey':!![]}});if(!_0x364c14){const _0x2d9924=_0x1708f5(0x1d7)+_0x18e462+_0x1708f5(0x240)+_0x1708f5(0x23a)+_0x1708f5(0x202);await this['bot']?.[_0x1708f5(0x1b6)](_0x5a5906,_0x2d9924,{'parse_mode':_0x1708f5(0x194)});return;}if(_0x364c14['status']!==_0x1708f5(0x19e)){await this[_0x1708f5(0x234)]?.[_0x1708f5(0x1b6)](_0x5a5906,_0x1708f5(0x22f)+_0x18e462+_0x1708f5(0x1ec)+'Contact\x20administrator.',{'parse_mode':_0x1708f5(0x194)});return;}if(_0x364c14[_0x1708f5(0x1f2)]!==_0x39aefc&&_0x364c14['secretKey']!==_0x39aefc){await this[_0x1708f5(0x234)]?.[_0x1708f5(0x1b6)](_0x5a5906,_0x1708f5(0x164)+_0x18e462+'`.\x0a\x0a'+_0x1708f5(0x184)+_0x1708f5(0x1ad),{'parse_mode':_0x1708f5(0x194)});return;}const _0x472b79=await database_1[_0x1708f5(0x1eb)]['telegramUser'][_0x1708f5(0x19a)]({'where':{'shopId':_0x364c14['id'],'isVerified':!![],'telegramId':{'not':_0x26d8ee}}});if(_0x472b79){await this[_0x1708f5(0x234)]?.[_0x1708f5(0x1b6)](_0x5a5906,_0x1708f5(0x151)+_0x18e462+_0x1708f5(0x20e)+'Disconnect\x20the\x20previous\x20account\x20first\x20or\x20contact\x20administrator.',{'parse_mode':_0x1708f5(0x194)});return;}await database_1[_0x1708f5(0x1eb)][_0x1708f5(0x217)][_0x1708f5(0x1c9)]({'where':{'telegramId':_0x26d8ee},'data':{'shopId':_0x364c14['id'],'isVerified':!![]}}),await this['bot']?.['sendMessage'](_0x5a5906,'üéâ\x20*Congratulations!*\x0a\x0a'+_0x1708f5(0x20d)+(_0x1708f5(0x143)+_0x364c14[_0x1708f5(0x165)]+'*\x0a')+(_0x1708f5(0x1a1)+_0x364c14[_0x1708f5(0x229)]+'`\x0a\x0a')+_0x1708f5(0x1e1)+'‚Ä¢\x20New\x20payments\x0a'+_0x1708f5(0x22e)+_0x1708f5(0x1fd)+'‚Ä¢\x20Important\x20events\x0a\x0a'+_0x1708f5(0x1be)+_0x1708f5(0x179)+_0x1708f5(0x1b4),{'parse_mode':_0x1708f5(0x194)}),console[_0x1708f5(0x233)](_0x1708f5(0x16e)+_0x26d8ee+_0x1708f5(0x21a)+_0x364c14[_0x1708f5(0x229)]+_0x1708f5(0x1d1));}catch(_0x132868){console[_0x1708f5(0x140)](_0x1708f5(0x231),_0x132868),await this['bot']?.['sendMessage'](_0x5a5906,_0x1708f5(0x208));}}async[a74_0x4c6229(0x237)](_0x30f07b,_0x2a1a11,_0x1adda2){const _0x376d9e=a74_0x4c6229;if(!this['bot']){console[_0x376d9e(0x1d0)](_0x376d9e(0x156));return;}try{const _0xb96603=await database_1['default'][_0x376d9e(0x217)][_0x376d9e(0x170)]({'where':{'shopId':_0x30f07b,'isVerified':!![]}});if(_0xb96603[_0x376d9e(0x1a0)]===0x0){console[_0x376d9e(0x233)](_0x376d9e(0x177)+_0x30f07b);return;}const _0x285ff8=_0xb96603[_0x376d9e(0x1bb)](async _0x83155c=>{const _0x54e456=_0x376d9e;try{await this[_0x54e456(0x234)]?.[_0x54e456(0x1b6)](_0x83155c[_0x54e456(0x167)],_0x2a1a11,_0x1adda2),console['log'](_0x54e456(0x216)+_0x83155c[_0x54e456(0x167)]);}catch(_0x178751){console[_0x54e456(0x140)](_0x54e456(0x1c8)+_0x83155c['telegramId']+':',_0x178751),_0x178751 instanceof Error&&(_0x178751[_0x54e456(0x200)][_0x54e456(0x192)](_0x54e456(0x181))||_0x178751[_0x54e456(0x200)][_0x54e456(0x192)](_0x54e456(0x197))||_0x178751['message'][_0x54e456(0x192)](_0x54e456(0x180)))&&(await database_1[_0x54e456(0x1eb)][_0x54e456(0x217)][_0x54e456(0x1c9)]({'where':{'id':_0x83155c['id']},'data':{'isVerified':![]}}),console[_0x54e456(0x233)]('User\x20'+_0x83155c[_0x54e456(0x167)]+_0x54e456(0x196)));}});await Promise[_0x376d9e(0x1bf)](_0x285ff8);}catch(_0x218ba6){console['error'](_0x376d9e(0x1a8),_0x218ba6);}}async[a74_0x4c6229(0x1fe)](_0x5f2afa,_0x3719b2,_0x1d8f03){const _0x7f17f7=a74_0x4c6229,_0x340583={'created':'üÜï','paid':'‚úÖ','failed':'‚ùå','expired':'‚è∞','refund':'üîÑ','chargeback':'‚ö†Ô∏è','processing':'‚öôÔ∏è'},_0x2bf895={'created':_0x7f17f7(0x1cf),'paid':_0x7f17f7(0x159),'failed':_0x7f17f7(0x20c),'expired':_0x7f17f7(0x1ba),'refund':_0x7f17f7(0x203),'chargeback':_0x7f17f7(0x19c),'processing':'Payment\x20is\x20being\x20processed'},_0x1e24b6=_0x340583[_0x1d8f03],_0x7f6114=_0x2bf895[_0x1d8f03],_0x4a16c2=(0x0,gateway_1[_0x7f17f7(0x1ee)])(_0x3719b2['gateway']);console[_0x7f17f7(0x233)](_0x7f17f7(0x1ff)+_0x3719b2['gateway']+_0x7f17f7(0x15f)+_0x4a16c2+'\x22');let _0x4b1fc1=_0x1e24b6+'\x20*'+_0x7f6114+_0x7f17f7(0x210)+('üí∞\x20Amount:\x20*'+_0x3719b2[_0x7f17f7(0x1b5)]+'\x20'+_0x3719b2[_0x7f17f7(0x220)]+'*\x0a')+(_0x7f17f7(0x213)+(_0x3719b2[_0x7f17f7(0x1e6)]||_0x3719b2['id'])+'`\x0a')+(_0x7f17f7(0x209)+_0x3719b2['id']+'`\x0a')+('üè™\x20Gateway:\x20`'+_0x4a16c2+'`\x0a')+('üìÖ\x20Date:\x20'+new Date(_0x3719b2['createdAt'])[_0x7f17f7(0x149)](_0x7f17f7(0x228))+'\x0a');if(_0x3719b2[_0x7f17f7(0x1c1)]||_0x3719b2[_0x7f17f7(0x20b)]||_0x3719b2[_0x7f17f7(0x157)]||_0x3719b2[_0x7f17f7(0x141)]||_0x3719b2['customerUa']){_0x4b1fc1+=_0x7f17f7(0x1ca);_0x3719b2[_0x7f17f7(0x1c1)]&&(_0x4b1fc1+=_0x7f17f7(0x1cb)+_0x3719b2[_0x7f17f7(0x1c1)]+'`\x0a');_0x3719b2[_0x7f17f7(0x20b)]&&(_0x4b1fc1+=_0x7f17f7(0x17c)+_0x3719b2['customerEmail']+'`\x0a');_0x3719b2[_0x7f17f7(0x157)]&&(_0x4b1fc1+='üè¶\x20IBAN:\x20`'+_0x3719b2['remitterIban']+'`\x0a');_0x3719b2[_0x7f17f7(0x141)]&&(_0x4b1fc1+=_0x7f17f7(0x241)+_0x3719b2[_0x7f17f7(0x141)]+'`\x0a');if(_0x3719b2[_0x7f17f7(0x1c0)]){const _0x336240=_0x3719b2[_0x7f17f7(0x1c0)][_0x7f17f7(0x1a0)]>0x32?_0x3719b2['customerUa'][_0x7f17f7(0x191)](0x0,0x32)+_0x7f17f7(0x189):_0x3719b2[_0x7f17f7(0x1c0)];_0x4b1fc1+=_0x7f17f7(0x146)+_0x336240+'`\x0a';}}_0x1d8f03===_0x7f17f7(0x22d)&&_0x3719b2['chargebackAmount']&&(_0x4b1fc1+=_0x7f17f7(0x199)+_0x3719b2[_0x7f17f7(0x175)]+'\x20USDT*\x0a'),_0x1d8f03===_0x7f17f7(0x1e3)&&(_0x4b1fc1+='‚è≥\x20The\x20payment\x20is\x20currently\x20being\x20processed\x20by\x20the\x20gateway.\x0a'),_0x3719b2[_0x7f17f7(0x17e)]&&(_0x4b1fc1+='üìù\x20Notes:\x20'+_0x3719b2[_0x7f17f7(0x17e)]+'\x0a'),await this[_0x7f17f7(0x237)](_0x5f2afa,_0x4b1fc1,{'parse_mode':'Markdown'});}async[a74_0x4c6229(0x154)](_0x1afbb4,_0x5c2c1f){const _0x5f0ccd=a74_0x4c6229,_0x4eff83=new Date(_0x5c2c1f['createdAt'])[_0x5f0ccd(0x149)]('en-US',{'year':_0x5f0ccd(0x1ae),'month':_0x5f0ccd(0x1db),'day':_0x5f0ccd(0x1db),'hour':_0x5f0ccd(0x1db),'minute':_0x5f0ccd(0x1db),'second':_0x5f0ccd(0x1db)}),_0x34eb8d='üí∏\x20*New\x20Payout*\x0a\x0a'+(_0x5f0ccd(0x144)+_0x4eff83+'\x0a')+(_0x5f0ccd(0x221)+_0x5c2c1f['amount']+_0x5f0ccd(0x23b))+('‚è±Ô∏è\x20*Period:*\x20'+(_0x5c2c1f['period']||_0x5f0ccd(0x1b1))+'\x0a')+(_0x5f0ccd(0x17a)+(_0x5c2c1f[_0x5f0ccd(0x188)]||_0x5f0ccd(0x1b1))+'\x0a')+(_0x5f0ccd(0x1d8)+(_0x5c2c1f[_0x5f0ccd(0x178)]||_0x5f0ccd(0x1b1))+'`\x0a')+(_0x5c2c1f[_0x5f0ccd(0x145)]?_0x5f0ccd(0x160)+_0x5c2c1f[_0x5f0ccd(0x145)]+'`':_0x5f0ccd(0x201));await this[_0x5f0ccd(0x237)](_0x1afbb4,_0x34eb8d,{'parse_mode':_0x5f0ccd(0x194)});}async['sendLoginNotification'](_0x5b5579,_0x2242e4){const _0x5abc60=a74_0x4c6229;try{const _0x4f970f=await database_1['default'][_0x5abc60(0x193)][_0x5abc60(0x1b7)]({'where':{'shopId':_0x5b5579},'select':{'notificationLogin':!![]}});if(!_0x4f970f?.[_0x5abc60(0x18c)]){console[_0x5abc60(0x233)](_0x5abc60(0x1f9)+_0x5b5579);return;}const _0x1af1a8=_0x2242e4['success']?'üîê':'üö®',_0x45b9ce=_0x2242e4[_0x5abc60(0x1f8)]?_0x5abc60(0x1aa):_0x5abc60(0x153);let _0x2be0d8=_0x1af1a8+'\x20*'+_0x45b9ce+'*\x0a\x0a'+(_0x5abc60(0x1a1)+_0x2242e4[_0x5abc60(0x229)]+'`\x0a')+('üìÖ\x20Time:\x20'+_0x2242e4['timestamp'][_0x5abc60(0x149)](_0x5abc60(0x228))+'\x0a');_0x2242e4[_0x5abc60(0x1fb)]&&(_0x2be0d8+=_0x5abc60(0x21f)+_0x2242e4[_0x5abc60(0x1fb)]+'`\x0a');_0x2242e4['geo']&&(_0x2be0d8+=_0x5abc60(0x1f7)+_0x2242e4[_0x5abc60(0x23f)]+'\x0a');if(_0x2242e4[_0x5abc60(0x18b)]){const _0x5d74d6=_0x2242e4[_0x5abc60(0x18b)][_0x5abc60(0x1a0)]>0x32?_0x2242e4[_0x5abc60(0x18b)][_0x5abc60(0x191)](0x0,0x32)+_0x5abc60(0x189):_0x2242e4[_0x5abc60(0x18b)];_0x2be0d8+='üíª\x20Browser:\x20`'+_0x5d74d6+'`\x0a';}!_0x2242e4[_0x5abc60(0x1f8)]&&(_0x2be0d8+=_0x5abc60(0x195)),await this['sendShopNotification'](_0x5b5579,_0x2be0d8,{'parse_mode':_0x5abc60(0x194)}),console[_0x5abc60(0x233)](_0x5abc60(0x1ed)+_0x5b5579+':\x20'+(_0x2242e4[_0x5abc60(0x1f8)]?'success':_0x5abc60(0x1ea)));}catch(_0x209bfe){console[_0x5abc60(0x140)]('Failed\x20to\x20send\x20login\x20notification:',_0x209bfe);}}async[a74_0x4c6229(0x14d)](_0x44eb27,_0x24c772){const _0x54d6e8=a74_0x4c6229;try{const _0x488033=await database_1[_0x54d6e8(0x1eb)][_0x54d6e8(0x193)][_0x54d6e8(0x1b7)]({'where':{'shopId':_0x44eb27},'select':{'notificationApiError':!![]}});if(!_0x488033?.[_0x54d6e8(0x142)]){console[_0x54d6e8(0x233)](_0x54d6e8(0x1f1)+_0x44eb27);return;}let _0x292ec5=_0x54d6e8(0x1cc)+(_0x54d6e8(0x1a5)+_0x24c772['method']+'\x20'+_0x24c772[_0x54d6e8(0x1dc)]+'`\x0a')+(_0x54d6e8(0x158)+_0x24c772[_0x54d6e8(0x219)][_0x54d6e8(0x149)]('en-US')+'\x0a');_0x24c772['statusCode']&&(_0x292ec5+='üìä\x20Error\x20code:\x20`'+_0x24c772[_0x54d6e8(0x21d)]+'`\x0a'),_0x292ec5+=_0x54d6e8(0x1a6)+_0x24c772[_0x54d6e8(0x22b)]+'`\x0a',_0x24c772[_0x54d6e8(0x227)]&&(_0x292ec5+='üÜî\x20Request\x20ID:\x20`'+_0x24c772[_0x54d6e8(0x227)]+'`\x0a'),_0x292ec5+='\x0aüí°\x20Check\x20your\x20request\x20or\x20contact\x20support.',await this[_0x54d6e8(0x237)](_0x44eb27,_0x292ec5,{'parse_mode':_0x54d6e8(0x194)}),console[_0x54d6e8(0x233)](_0x54d6e8(0x1c4)+_0x44eb27+':\x20'+_0x24c772[_0x54d6e8(0x1dc)]);}catch(_0x3d694d){console['error'](_0x54d6e8(0x1ab),_0x3d694d);}}async[a74_0x4c6229(0x15e)](_0x49671a,_0xe4e601,_0x5701f2){const _0x35ed04=a74_0x4c6229;let _0x42bd94=_0x35ed04(0x1c6)+_0xe4e601+'*\x0a\x0a';for(const [_0x926f83,_0x445785]of Object[_0x35ed04(0x207)](_0x5701f2)){_0x445785!==null&&_0x445785!==undefined&&(_0x42bd94+=_0x926f83+_0x35ed04(0x17f)+_0x445785+'`\x0a');}await this[_0x35ed04(0x237)](_0x49671a,_0x42bd94,{'parse_mode':_0x35ed04(0x194)});}async[a74_0x4c6229(0x205)](_0x134e8f){const _0x351d0c=a74_0x4c6229;try{console[_0x351d0c(0x233)](_0x351d0c(0x1e2)+_0x134e8f['substring'](0x0,0x32)+_0x351d0c(0x189));const _0x188219=await database_1[_0x351d0c(0x1eb)][_0x351d0c(0x217)][_0x351d0c(0x170)]({'select':{'telegramId':!![]}});if(_0x188219['length']===0x0){console[_0x351d0c(0x233)](_0x351d0c(0x1f6));return;}for(const _0x377252 of _0x188219){try{await this['bot']?.[_0x351d0c(0x1b6)](_0x377252[_0x351d0c(0x167)],_0x134e8f,{'parse_mode':_0x351d0c(0x194)});}catch(_0x6aa788){console['error'](_0x351d0c(0x206)+_0x377252[_0x351d0c(0x167)]+':',_0x6aa788);}}console[_0x351d0c(0x233)](_0x351d0c(0x161)+_0x188219[_0x351d0c(0x1a0)]+'\x20users');}catch(_0x517f90){console[_0x351d0c(0x140)](_0x351d0c(0x23c),_0x517f90);}}[a74_0x4c6229(0x15b)](){const _0xd17c77=a74_0x4c6229;return{'isActive':!!this[_0xd17c77(0x234)],'username':this[_0xd17c77(0x14a)]};}async[a74_0x4c6229(0x1e9)](_0x2b4545,_0x3c5828,_0x559775,_0x1e9a21){const _0x30b88a=a74_0x4c6229;try{if(!this[_0x30b88a(0x234)])return console[_0x30b88a(0x140)]('‚ùå\x20Telegram\x20bot\x20not\x20initialized'),![];const _0x23540b=await database_1[_0x30b88a(0x1eb)][_0x30b88a(0x217)][_0x30b88a(0x170)]({'where':{'shopId':_0x2b4545,'isVerified':!![]},'select':{'telegramId':!![]}});if(_0x23540b['length']===0x0)return console[_0x30b88a(0x140)](_0x30b88a(0x19b)+_0x2b4545),![];let _0x24c4ff=0x0;for(const _0x4db560 of _0x23540b){try{await this[_0x30b88a(0x234)]['sendDocument'](_0x4db560[_0x30b88a(0x167)],_0x3c5828,{},{'filename':_0x559775,'contentType':_0x559775[_0x30b88a(0x1b9)](_0x30b88a(0x211))?_0x30b88a(0x20a):_0x559775[_0x30b88a(0x1b9)](_0x30b88a(0x148))||_0x559775[_0x30b88a(0x1b9)](_0x30b88a(0x223))?'image/jpeg':_0x559775['endsWith']('.pdf')?_0x30b88a(0x174):'application/octet-stream'}),_0x1e9a21&&await this[_0x30b88a(0x234)][_0x30b88a(0x1b6)](_0x4db560['telegramId'],_0x1e9a21),_0x24c4ff++;}catch(_0x5923b4){console[_0x30b88a(0x140)](_0x30b88a(0x190)+_0x4db560[_0x30b88a(0x167)]+':',_0x5923b4);}}return console[_0x30b88a(0x233)](_0x30b88a(0x198)+_0x24c4ff+'/'+_0x23540b['length']+_0x30b88a(0x1d6)+_0x2b4545+':\x20'+_0x559775),_0x24c4ff>0x0;}catch(_0x385ab3){return console[_0x30b88a(0x140)](_0x30b88a(0x1e8),_0x385ab3),![];}}async['sendDirectMessage'](_0x31bcc7,_0x2de3b5){const _0x25341c=a74_0x4c6229;try{if(!this[_0x25341c(0x234)])return console[_0x25341c(0x140)](_0x25341c(0x1d4)),![];return await this[_0x25341c(0x234)][_0x25341c(0x1b6)](_0x31bcc7,_0x2de3b5),console[_0x25341c(0x233)](_0x25341c(0x182)+_0x31bcc7),!![];}catch(_0x4126f8){return console['error'](_0x25341c(0x1da),_0x4126f8),![];}}async['sendDirectFile'](_0x2bb197,_0x6c19e5,_0xb19f91,_0x4b9e07){const _0x1ec753=a74_0x4c6229;try{if(!this['bot'])return console[_0x1ec753(0x140)]('‚ùå\x20Telegram\x20bot\x20not\x20initialized'),![];return await this['bot'][_0x1ec753(0x1c5)](_0x2bb197,_0x6c19e5,{},{'filename':_0xb19f91,'contentType':_0xb19f91[_0x1ec753(0x1b9)]('.png')?'image/png':_0xb19f91[_0x1ec753(0x1b9)](_0x1ec753(0x148))||_0xb19f91['endsWith'](_0x1ec753(0x223))?_0x1ec753(0x235):_0xb19f91['endsWith'](_0x1ec753(0x1d9))?'application/pdf':_0x1ec753(0x224)}),_0x4b9e07&&await this['bot'][_0x1ec753(0x1b6)](_0x2bb197,_0x4b9e07),console[_0x1ec753(0x233)](_0x1ec753(0x15d)+_0x2bb197+':\x20'+_0xb19f91),!![];}catch(_0x37337f){return console[_0x1ec753(0x140)](_0x1ec753(0x1bc),_0x37337f),![];}}[a74_0x4c6229(0x1ef)](){const _0x12a8a1=a74_0x4c6229;this['bot']&&(this[_0x12a8a1(0x234)]['stopPolling'](),this[_0x12a8a1(0x234)]=null,console[_0x12a8a1(0x233)](_0x12a8a1(0x22c)));}}exports[a74_0x4c6229(0x19d)]=TelegramBotService,exports[a74_0x4c6229(0x1b3)]=new TelegramBotService();