'use strict';function a55_0x30e8(){const _0x5a1ced=['API\x20key\x20must\x20start\x20with\x20`pk\x5c_`\x20or\x20`sk\x5c_`.','TelegramBotService','polling_error','📅\x20Date:\x20','\x20\x20\x20Username:\x20`','🏦\x20IBAN:\x20`','🏦\x20Method:\x20`','`.\x0a\x0a','message','toLocaleString','🤖\x20Welcome\x20to\x20TRAPAY\x20notification\x20system!\x0a\x0a','Payment\x20is\x20being\x20processed','entries','Payment\x20chargeback','❌\x20Failed\x20to\x20initialize\x20Telegram\x20bot:','customerName','substring','endpoint','env','/status\x20-\x20check\x20connection\x20status\x0a','length','📱\x20Shop:\x20*','❌\x20You\x20are\x20not\x20registered\x20in\x20the\x20system.\x0a\x0a','username','join','🆔\x20Payment\x20ID:\x20`','chargebackAmount','Telegram\x20bot\x20error:','\x22\x20->\x20display\x20\x22','❌\x20API\x20key\x20does\x20not\x20match\x20shop\x20`','first_name','__importDefault','🔔\x20Notifications\x20are\x20active\x0a\x0a','❗️\x20Make\x20sure\x20to\x20separate\x20username\x20and\x20API\x20key\x20with\x20a\x20space!','telegramUser','🏪\x20Gateway:\x20`','Commands:\x0a','✅\x20You\x20are\x20already\x20connected\x20to\x20shop\x20*','🎉\x20*Congratulations!*\x0a\x0a','`\x0a\x0a','4354272xjqwpB','📧\x20Email:\x20`','19131678NulXiI','•\x20New\x20payments\x0a','Disconnect\x20the\x20previous\x20account\x20first\x20or\x20contact\x20administrator.','💻\x20Browser:\x20`','../config/database','✅\x20Login\x20notification\x20sent\x20for\x20shop\x20','from','shopSettings','shop','✅\x20You\x20have\x20been\x20successfully\x20disconnected\x20from\x20shop\x20*','Payment\x20expired','setupBotHandlers','Error\x20handling\x20message:','__esModule','includes','•\x20Payouts\x0a','log','•\x20Payment\x20status\x20changes\x0a','requestId','❌\x20Invalid\x20format.\x20Please\x20send\x20exactly\x202\x20parts\x20separated\x20by\x20space:\x0a\x0a','statusCode','🔗\x20TXID:\x20`','method','blocked','•\x20Payouts\x0a\x0a','Check\x20the\x20key\x20and\x20try\x20again.\x0a\x0a','secretKey','Error\x20handling\x20/status\x20command:','customerIp','Failed\x20to\x20send\x20login\x20notification:','Available\x20usernames:\x0a','findUnique','❌\x20Another\x20Telegram\x20account\x20is\x20already\x20connected\x20to\x20shop\x20`','16CVkTBU','sendLoginNotification','toString','error','...`\x0a\x0a','*.\x0a\x0a','onText','forEach','✅\x20Telegram\x20user\x20','889959WZUUmq','✅\x20You\x20have\x20been\x20successfully\x20connected\x20to\x20the\x20notification\x20system!\x0a\x0a','sendMessage','User\x20','\x20via\x20single-line\x20input','Payout\x20completed','gateway','💸\x20Amount:\x20*','📛\x20Name:\x20`','telegramId','customerUa','`\x20(','⏳\x20The\x20payment\x20is\x20currently\x20being\x20processed\x20by\x20the\x20gateway.\x0a','Payment\x20successfully\x20paid','✅\x20Connected\x20to\x20shop:\x20*','failed','sendShopNotification','allSettled','1191035DEQmiL','Use\x20/start\x20to\x20begin.','defineProperty','*\x0a\x0a','\x20verified\x20for\x20shop\x20','\x20(@','adminNotes','📱\x20Created\x20new\x20Telegram\x20user:\x20','default','Error\x20handling\x20/disconnect\x20command:','notificationLogin','chat\x20not\x20found','updatedAt','name','text','ACTIVE','errorMessage','📊\x20Error\x20code:\x20`','...\x22','sendPayoutNotification','telegramBotService','Example:\x0a','publicKey','🌐\x20IP\x20address:\x20`','❌\x20An\x20error\x20occurred.\x20Please\x20try\x20again\x20later.','No\x20verified\x20Telegram\x20users\x20found\x20for\x20shop\x20','🛑\x20Telegram\x20bot\x20stopped','✅\x20Telegram\x20bot\x20@','Username\x20must\x20contain\x20only\x20letters,\x20numbers\x20and\x20underscore\x20(3-50\x20characters).','\x0aCheck\x20spelling\x20and\x20try\x20again.','📱\x20Your\x20Telegram\x20ID:\x20`','✅\x20Welcome\x20back!\x0a\x0a','❌\x20Shop\x20`','handleSingleLineVerification','Payment\x20failed','bot','\x22,\x20apiKey=\x22','getBotInfo','🔔\x20You\x20will\x20now\x20receive\x20notifications\x20about:\x0a','•\x20Important\x20events\x0a\x0a','/disconnect\x20-\x20disconnect\x20from\x20notifications','sendCustomNotification','currency','📝\x20Notes:\x20','📝\x20Format:\x20`username\x20api_key`\x0a\x0a','You\x20sent\x20','\x0a⚠️\x20If\x20this\x20wasn\x27t\x20you,\x20change\x20your\x20password\x20immediately!','sendApiErrorNotification','135868qXCFvP','ipAddress','To\x20reconnect,\x20use\x20the\x20/start\x20command','Failed\x20to\x20send\x20API\x20error\x20notification:','4mkeYsi','findMany','findFirst','\x20marked\x20as\x20unverified\x20due\x20to\x20delivery\x20failure','stopBot','botUsername','createdAt','New\x20payment\x20created','❌\x20Invalid\x20API\x20key\x20format.\x0a\x0a','❌\x20Error\x20getting\x20debug\x20information.','Payment\x20refund','`\x20is\x20inactive.\x0a\x0a','timestamp','✅\x20Notification\x20sent\x20to\x20Telegram\x20user\x20','Use\x20/start\x20to\x20connect.','7363688yydxKC','Contact\x20administrator.','Markdown','chargeback','map','success','warn','sk_','unknown\x20shop','user\x20is\x20deactivated','\x20\x20\x20Status:\x20','userAgent','\x20USD*\x0a','🆔\x20Request\x20ID:\x20`','🔄\x20Processing\x20single-line\x20verification\x20for\x20user\x20','📱\x20Telegram\x20notification:\x20gateway\x20\x22','Error\x20handling\x20/debug\x20command:','Telegram\x20bot\x20polling\x20error:','Error\x20handling\x20/start\x20command:','👤\x20Username:\x20`','📅\x20Connection\x20date:\x20','remitterIban','customerEmail','\x20USDT*\x0a','TELEGRAM_BOT_TOKEN',':\x20username=\x22','❌\x20An\x20error\x20occurred\x20while\x20verifying\x20data.','botToken','🔌\x20User\x20','🔍\x20*Debug\x20Information*\x0a\x0a','💰\x20Amount:\x20*','❌\x20Invalid\x20username\x20format:\x20`','...','❌\x20Failed\x20to\x20send\x20notification\x20to\x20Telegram\x20user\x20','amount','🔔\x20*','update','txid','startsWith','📅\x20Time:\x20','pk_','TELEGRAM_BOT_USERNAME','`appple\x20pk_aa6450d3f57afbefbb0f3f5be5ce6cca13037536afc5ccf14c81a6cbc7a07de5`\x0a\x0a','chat','status','last_name','stopPolling','split','create','📱\x20Login\x20notifications\x20disabled\x20for\x20shop\x20','New\x20payout\x20created','1728600LbCPkY','shopId','✅\x20API\x20error\x20notification\x20sent\x20for\x20shop\x20','.\x20*','en-US','Username:\x20`','•\x20`','notificationApiError','isVerified','📊\x20*Connection\x20Status*\x0a\x0a'];a55_0x30e8=function(){return _0x5a1ced;};return a55_0x30e8();}const a55_0x4977a9=a55_0x1cd6;(function(_0x2794d3,_0x2ef2ec){const _0x4317c1=a55_0x1cd6,_0x43df1f=_0x2794d3();while(!![]){try{const _0x1eb0a5=-parseInt(_0x4317c1(0x13a))/0x1*(parseInt(_0x4317c1(0x13e))/0x2)+parseInt(_0x4317c1(0x180))/0x3+parseInt(_0x4317c1(0x1d5))/0x4*(parseInt(_0x4317c1(0x1f0))/0x5)+parseInt(_0x4317c1(0x1b2))/0x6+parseInt(_0x4317c1(0x1de))/0x7+parseInt(_0x4317c1(0x14d))/0x8+-parseInt(_0x4317c1(0x1b4))/0x9;if(_0x1eb0a5===_0x2ef2ec)break;else _0x43df1f['push'](_0x43df1f['shift']());}catch(_0x4ce851){_0x43df1f['push'](_0x43df1f['shift']());}}}(a55_0x30e8,0xdce9c));var __importDefault=this&&this[a55_0x4977a9(0x1a9)]||function(_0x3dcd14){const _0x478939=a55_0x4977a9;return _0x3dcd14&&_0x3dcd14[_0x478939(0x1c1)]?_0x3dcd14:{'default':_0x3dcd14};};Object[a55_0x4977a9(0x1f2)](exports,a55_0x4977a9(0x1c1),{'value':!![]}),exports[a55_0x4977a9(0x11e)]=exports[a55_0x4977a9(0x18b)]=void 0x0;const node_telegram_bot_api_1=__importDefault(require('node-telegram-bot-api')),database_1=__importDefault(require(a55_0x4977a9(0x1b8))),gateway_1=require('../types/gateway');class TelegramBotService{constructor(){const _0x89dc94=a55_0x4977a9;this[_0x89dc94(0x12d)]=null,this['botToken']=process[_0x89dc94(0x19c)][_0x89dc94(0x165)]||'',this[_0x89dc94(0x143)]=process[_0x89dc94(0x19c)][_0x89dc94(0x176)]||'trapay_bot',this[_0x89dc94(0x168)]?this['initializeBot']():console['warn']('TELEGRAM_BOT_TOKEN\x20not\x20found\x20in\x20environment\x20variables');}['initializeBot'](){const _0x24b509=a55_0x4977a9;try{this[_0x24b509(0x12d)]=new node_telegram_bot_api_1[(_0x24b509(0x1f8))](this[_0x24b509(0x168)],{'polling':!![]}),this[_0x24b509(0x1bf)](),console[_0x24b509(0x1c4)](_0x24b509(0x125)+this[_0x24b509(0x143)]+'\x20initialized\x20successfully');}catch(_0x2e3ab1){console[_0x24b509(0x1d8)](_0x24b509(0x198),_0x2e3ab1);}}['setupBotHandlers'](){const _0x3db50e=a55_0x4977a9;if(!this[_0x3db50e(0x12d)])return;this[_0x3db50e(0x12d)][_0x3db50e(0x1db)](/\/start/,async _0x3f37b1=>{const _0xac9857=_0x3db50e,_0x6f41f2=_0x3f37b1[_0xac9857(0x178)]['id'],_0xf9cceb=_0x3f37b1[_0xac9857(0x1ba)]?.['id'][_0xac9857(0x1d7)](),_0x52aa62=_0x3f37b1['from']?.[_0xac9857(0x1a1)],_0x402e1c=_0x3f37b1['from']?.[_0xac9857(0x1a8)],_0xb82531=_0x3f37b1[_0xac9857(0x1ba)]?.[_0xac9857(0x17a)];if(!_0xf9cceb)return;try{let _0x283f4c=await database_1[_0xac9857(0x1f8)][_0xac9857(0x1ac)][_0xac9857(0x1d3)]({'where':{'telegramId':_0xf9cceb},'include':{'shop':!![]}});!_0x283f4c?(_0x283f4c=await database_1['default'][_0xac9857(0x1ac)][_0xac9857(0x17d)]({'data':{'telegramId':_0xf9cceb,'username':_0x52aa62,'firstName':_0x402e1c,'lastName':_0xb82531,'isVerified':![],'shopId':null},'include':{'shop':!![]}}),console[_0xac9857(0x1c4)](_0xac9857(0x1f7)+_0xf9cceb+_0xac9857(0x1f5)+_0x52aa62+')')):_0x283f4c=await database_1[_0xac9857(0x1f8)][_0xac9857(0x1ac)][_0xac9857(0x171)]({'where':{'telegramId':_0xf9cceb},'data':{'username':_0x52aa62,'firstName':_0x402e1c,'lastName':_0xb82531},'include':{'shop':!![]}}),_0x283f4c[_0xac9857(0x188)]&&_0x283f4c[_0xac9857(0x181)]&&_0x283f4c[_0xac9857(0x1bc)]?await this['bot']?.[_0xac9857(0x1e0)](_0x6f41f2,_0xac9857(0x129)+('You\x20are\x20already\x20connected\x20to\x20shop:\x20*'+_0x283f4c[_0xac9857(0x1bc)][_0xac9857(0x117)]+'*\x0a')+(_0xac9857(0x185)+_0x283f4c['shop'][_0xac9857(0x1a1)]+_0xac9857(0x1b1))+'🔔\x20You\x20receive\x20notifications\x20about:\x0a'+_0xac9857(0x1b5)+'•\x20Payment\x20status\x20changes\x0a'+_0xac9857(0x1cc)+_0xac9857(0x1ae)+_0xac9857(0x19d)+'/disconnect\x20-\x20disconnect\x20from\x20notifications',{'parse_mode':_0xac9857(0x14f)}):(_0x283f4c['shopId']&&!_0x283f4c['isVerified']&&(await database_1[_0xac9857(0x1f8)][_0xac9857(0x1ac)]['update']({'where':{'telegramId':_0xf9cceb},'data':{'shopId':null,'isVerified':![]}}),console[_0xac9857(0x1c4)]('🔄\x20Reset\x20incomplete\x20verification\x20for\x20user\x20'+_0xf9cceb)),await this[_0xac9857(0x12d)]?.[_0xac9857(0x1e0)](_0x6f41f2,_0xac9857(0x194)+'To\x20receive\x20payment\x20notifications,\x20send\x20your\x20credentials\x20in\x20one\x20line:\x0a\x0a'+'📝\x20Format:\x20`username\x20api_key`\x0a\x0a'+_0xac9857(0x11f)+'`appple\x20pk_aa6450d3f57afbefbb0f3f5be5ce6cca13037536afc5ccf14c81a6cbc7a07de5`\x0a\x0a'+_0xac9857(0x1ab),{'parse_mode':_0xac9857(0x14f)}));}catch(_0x20a5af){console[_0xac9857(0x1d8)](_0xac9857(0x15f),_0x20a5af),await this[_0xac9857(0x12d)]?.[_0xac9857(0x1e0)](_0x6f41f2,_0xac9857(0x122));}}),this[_0x3db50e(0x12d)][_0x3db50e(0x1db)](/\/disconnect/,async _0x3ca59b=>{const _0x266d6c=_0x3db50e,_0x4ab0ac=_0x3ca59b[_0x266d6c(0x178)]['id'],_0x275e3a=_0x3ca59b[_0x266d6c(0x1ba)]?.['id'][_0x266d6c(0x1d7)]();if(!_0x275e3a)return;try{const _0x42c3c5=await database_1[_0x266d6c(0x1f8)][_0x266d6c(0x1ac)][_0x266d6c(0x1d3)]({'where':{'telegramId':_0x275e3a},'include':{'shop':!![]}});if(!_0x42c3c5||!_0x42c3c5[_0x266d6c(0x188)]||!_0x42c3c5[_0x266d6c(0x181)]){await this[_0x266d6c(0x12d)]?.['sendMessage'](_0x4ab0ac,'❌\x20You\x20are\x20not\x20connected\x20to\x20the\x20notification\x20system.');return;}const _0x45bc5e=_0x42c3c5['shop']?.[_0x266d6c(0x117)]||_0x266d6c(0x155);await database_1['default'][_0x266d6c(0x1ac)][_0x266d6c(0x171)]({'where':{'telegramId':_0x275e3a},'data':{'shopId':null,'isVerified':![]}}),console['log'](_0x266d6c(0x169)+_0x275e3a+'\x20disconnected\x20from\x20shop\x20'+_0x42c3c5[_0x266d6c(0x181)]),await this[_0x266d6c(0x12d)]?.[_0x266d6c(0x1e0)](_0x4ab0ac,_0x266d6c(0x1bd)+_0x45bc5e+_0x266d6c(0x1da)+_0x266d6c(0x13c),{'parse_mode':_0x266d6c(0x14f)});}catch(_0x5e539c){console[_0x266d6c(0x1d8)](_0x266d6c(0x1f9),_0x5e539c),await this[_0x266d6c(0x12d)]?.[_0x266d6c(0x1e0)](_0x4ab0ac,_0x266d6c(0x122));}}),this[_0x3db50e(0x12d)]['onText'](/\/status/,async _0x4de825=>{const _0x42794=_0x3db50e,_0x5db1ce=_0x4de825[_0x42794(0x178)]['id'],_0x3fe514=_0x4de825[_0x42794(0x1ba)]?.['id']['toString']();if(!_0x3fe514)return;try{const _0x409c5f=await database_1[_0x42794(0x1f8)][_0x42794(0x1ac)]['findUnique']({'where':{'telegramId':_0x3fe514},'include':{'shop':!![]}});if(!_0x409c5f){await this[_0x42794(0x12d)]?.[_0x42794(0x1e0)](_0x5db1ce,_0x42794(0x1a0)+_0x42794(0x1f1));return;}if(!_0x409c5f[_0x42794(0x188)]||!_0x409c5f['shopId']||!_0x409c5f[_0x42794(0x1bc)]){await this[_0x42794(0x12d)]?.[_0x42794(0x1e0)](_0x5db1ce,'❌\x20You\x20are\x20not\x20connected\x20to\x20a\x20shop.\x0a\x0a'+_0x42794(0x14c));return;}await this[_0x42794(0x12d)]?.['sendMessage'](_0x5db1ce,_0x42794(0x189)+(_0x42794(0x1ec)+_0x409c5f[_0x42794(0x1bc)][_0x42794(0x117)]+'*\x0a')+('👤\x20Username:\x20`'+_0x409c5f[_0x42794(0x1bc)][_0x42794(0x1a1)]+'`\x0a')+(_0x42794(0x161)+_0x409c5f[_0x42794(0x116)]['toLocaleDateString'](_0x42794(0x184))+'\x0a\x0a')+_0x42794(0x1aa)+_0x42794(0x1ae)+_0x42794(0x132),{'parse_mode':_0x42794(0x14f)});}catch(_0x4f0315){console[_0x42794(0x1d8)](_0x42794(0x1cf),_0x4f0315),await this['bot']?.[_0x42794(0x1e0)](_0x5db1ce,_0x42794(0x122));}}),this['bot']['onText'](/\/debug/,async _0x2a7459=>{const _0x23b1fc=_0x3db50e,_0x42ef72=_0x2a7459[_0x23b1fc(0x178)]['id'],_0x12eca8=_0x2a7459[_0x23b1fc(0x1ba)]?.['id']['toString']();if(!_0x12eca8)return;try{const _0x59acbd=await database_1['default'][_0x23b1fc(0x1bc)][_0x23b1fc(0x13f)]({'select':{'id':!![],'name':!![],'username':!![],'status':!![],'publicKey':!![]},'take':0xa});let _0xd849d=_0x23b1fc(0x16a);_0xd849d+=_0x23b1fc(0x128)+_0x12eca8+_0x23b1fc(0x1b1),_0xd849d+='🏪\x20Available\x20shops\x20in\x20system:\x0a',_0x59acbd[_0x23b1fc(0x1dc)]((_0x2ea6e5,_0xae89da)=>{const _0x235f2b=_0x23b1fc;_0xd849d+=_0xae89da+0x1+_0x235f2b(0x183)+_0x2ea6e5['name']+'*\x0a',_0xd849d+=_0x235f2b(0x18e)+_0x2ea6e5[_0x235f2b(0x1a1)]+'`\x0a',_0xd849d+=_0x235f2b(0x157)+_0x2ea6e5[_0x235f2b(0x179)]+'\x0a',_0xd849d+='\x20\x20\x20Public\x20Key:\x20`'+_0x2ea6e5[_0x235f2b(0x120)][_0x235f2b(0x19a)](0x0,0xf)+_0x235f2b(0x1d9);}),await this[_0x23b1fc(0x12d)]?.[_0x23b1fc(0x1e0)](_0x42ef72,_0xd849d,{'parse_mode':_0x23b1fc(0x14f)});}catch(_0x4085b8){console[_0x23b1fc(0x1d8)](_0x23b1fc(0x15d),_0x4085b8),await this['bot']?.[_0x23b1fc(0x1e0)](_0x42ef72,_0x23b1fc(0x147));}}),this['bot']['on']('message',async _0x28f486=>{const _0x2a78bf=_0x3db50e;if(_0x28f486[_0x2a78bf(0x118)]?.['startsWith']('/'))return;const _0x5c879c=_0x28f486[_0x2a78bf(0x178)]['id'],_0x50c3fe=_0x28f486[_0x2a78bf(0x1ba)]?.['id']['toString'](),_0x373669=_0x28f486[_0x2a78bf(0x118)]?.['trim']();if(!_0x50c3fe||!_0x373669)return;try{const _0x2e5957=await database_1['default']['telegramUser'][_0x2a78bf(0x1d3)]({'where':{'telegramId':_0x50c3fe},'include':{'shop':!![]}});if(!_0x2e5957){await this['bot']?.['sendMessage'](_0x5c879c,'❌\x20Please\x20use\x20/start\x20command\x20first');return;}if(_0x2e5957[_0x2a78bf(0x188)]&&_0x2e5957[_0x2a78bf(0x181)]&&_0x2e5957[_0x2a78bf(0x1bc)]){await this[_0x2a78bf(0x12d)]?.[_0x2a78bf(0x1e0)](_0x5c879c,_0x2a78bf(0x1af)+_0x2e5957[_0x2a78bf(0x1bc)][_0x2a78bf(0x117)]+'*.\x0a\x0a'+'Use\x20/status\x20to\x20check\x20status\x20or\x20/disconnect\x20to\x20disconnect.',{'parse_mode':_0x2a78bf(0x14f)});return;}const _0x4348b6=_0x373669[_0x2a78bf(0x17c)](/\s+/);if(_0x4348b6['length']!==0x2){await this[_0x2a78bf(0x12d)]?.[_0x2a78bf(0x1e0)](_0x5c879c,_0x2a78bf(0x1c7)+_0x2a78bf(0x136)+_0x2a78bf(0x11f)+_0x2a78bf(0x177)+(_0x2a78bf(0x137)+_0x4348b6[_0x2a78bf(0x19e)]+'\x20parts:\x20'+_0x4348b6[_0x2a78bf(0x151)](_0x1b3dfd=>'`'+_0x1b3dfd+'`')[_0x2a78bf(0x1a2)](',\x20')),{'parse_mode':_0x2a78bf(0x14f)});return;}const [_0x12b167,_0x441e04]=_0x4348b6;console['log'](_0x2a78bf(0x15b)+_0x50c3fe+_0x2a78bf(0x166)+_0x12b167+_0x2a78bf(0x12e)+_0x441e04[_0x2a78bf(0x19a)](0x0,0xa)+_0x2a78bf(0x11c)),await this[_0x2a78bf(0x12b)](_0x5c879c,_0x50c3fe,_0x12b167,_0x441e04);}catch(_0x24eff8){console['error'](_0x2a78bf(0x1c0),_0x24eff8),await this[_0x2a78bf(0x12d)]?.[_0x2a78bf(0x1e0)](_0x5c879c,_0x2a78bf(0x122));}}),this[_0x3db50e(0x12d)]['on'](_0x3db50e(0x1d8),_0x56b6b8=>{const _0x2e0141=_0x3db50e;console[_0x2e0141(0x1d8)](_0x2e0141(0x1a5),_0x56b6b8);}),this['bot']['on'](_0x3db50e(0x18c),_0x2600dc=>{const _0x33a8bd=_0x3db50e;console[_0x33a8bd(0x1d8)](_0x33a8bd(0x15e),_0x2600dc);});}async[a55_0x4977a9(0x12b)](_0x487b9c,_0x4a1144,_0x369580,_0x483d32){const _0x2d8554=a55_0x4977a9;try{console['log'](_0x2d8554(0x15b)+_0x4a1144+':\x20username=\x22'+_0x369580+'\x22,\x20apiKey=\x22'+_0x483d32[_0x2d8554(0x19a)](0x0,0xa)+_0x2d8554(0x11c));if(!_0x369580||_0x369580[_0x2d8554(0x19e)]<0x3||_0x369580[_0x2d8554(0x19e)]>0x32||!/^[a-zA-Z0-9_]+$/['test'](_0x369580)){await this['bot']?.[_0x2d8554(0x1e0)](_0x487b9c,_0x2d8554(0x16c)+_0x369580+'`\x0a\x0a'+_0x2d8554(0x126),{'parse_mode':_0x2d8554(0x14f)});return;}if(!_0x483d32||!_0x483d32[_0x2d8554(0x173)](_0x2d8554(0x175))&&!_0x483d32[_0x2d8554(0x173)](_0x2d8554(0x154))){await this['bot']?.['sendMessage'](_0x487b9c,_0x2d8554(0x146)+_0x2d8554(0x18a),{'parse_mode':_0x2d8554(0x14f)});return;}const _0x4c9fc3=await database_1[_0x2d8554(0x1f8)][_0x2d8554(0x1bc)][_0x2d8554(0x1d3)]({'where':{'username':_0x369580},'select':{'id':!![],'name':!![],'username':!![],'status':!![],'publicKey':!![],'secretKey':!![]}});if(!_0x4c9fc3){const _0x20bdd5=await database_1['default'][_0x2d8554(0x1bc)]['findMany']({'select':{'username':!![],'name':!![]},'take':0x5});let _0x57c34a='❌\x20Shop\x20with\x20username\x20`'+_0x369580+'`\x20not\x20found.\x0a\x0a';_0x20bdd5[_0x2d8554(0x19e)]>0x0?(_0x57c34a+=_0x2d8554(0x1d2),_0x20bdd5[_0x2d8554(0x1dc)](_0x48a873=>{const _0xd0b21c=_0x2d8554;_0x57c34a+=_0xd0b21c(0x186)+_0x48a873[_0xd0b21c(0x1a1)]+_0xd0b21c(0x1e9)+_0x48a873[_0xd0b21c(0x117)]+')\x0a';}),_0x57c34a+=_0x2d8554(0x127)):_0x57c34a+='Check\x20spelling\x20and\x20try\x20again.';await this[_0x2d8554(0x12d)]?.[_0x2d8554(0x1e0)](_0x487b9c,_0x57c34a,{'parse_mode':_0x2d8554(0x14f)});return;}if(_0x4c9fc3['status']!==_0x2d8554(0x119)){await this[_0x2d8554(0x12d)]?.['sendMessage'](_0x487b9c,_0x2d8554(0x12a)+_0x369580+_0x2d8554(0x149)+_0x2d8554(0x14e),{'parse_mode':_0x2d8554(0x14f)});return;}if(_0x4c9fc3[_0x2d8554(0x120)]!==_0x483d32&&_0x4c9fc3[_0x2d8554(0x1ce)]!==_0x483d32){await this[_0x2d8554(0x12d)]?.['sendMessage'](_0x487b9c,_0x2d8554(0x1a7)+_0x369580+'`.\x0a\x0a'+_0x2d8554(0x1cd)+'Expected\x20key\x20format:\x20`pk_...`\x20or\x20`sk_...`',{'parse_mode':_0x2d8554(0x14f)});return;}const _0x521533=await database_1['default']['telegramUser'][_0x2d8554(0x140)]({'where':{'shopId':_0x4c9fc3['id'],'isVerified':!![],'telegramId':{'not':_0x4a1144}}});if(_0x521533){await this[_0x2d8554(0x12d)]?.[_0x2d8554(0x1e0)](_0x487b9c,_0x2d8554(0x1d4)+_0x369580+_0x2d8554(0x191)+_0x2d8554(0x1b6),{'parse_mode':_0x2d8554(0x14f)});return;}await database_1[_0x2d8554(0x1f8)][_0x2d8554(0x1ac)][_0x2d8554(0x171)]({'where':{'telegramId':_0x4a1144},'data':{'shopId':_0x4c9fc3['id'],'isVerified':!![]}}),await this[_0x2d8554(0x12d)]?.[_0x2d8554(0x1e0)](_0x487b9c,_0x2d8554(0x1b0)+_0x2d8554(0x1df)+(_0x2d8554(0x19f)+_0x4c9fc3[_0x2d8554(0x117)]+'*\x0a')+(_0x2d8554(0x160)+_0x4c9fc3[_0x2d8554(0x1a1)]+_0x2d8554(0x1b1))+_0x2d8554(0x130)+_0x2d8554(0x1b5)+_0x2d8554(0x1c5)+_0x2d8554(0x1c3)+_0x2d8554(0x131)+_0x2d8554(0x1ae)+_0x2d8554(0x19d)+_0x2d8554(0x132),{'parse_mode':_0x2d8554(0x14f)}),console[_0x2d8554(0x1c4)](_0x2d8554(0x1dd)+_0x4a1144+_0x2d8554(0x1f4)+_0x4c9fc3['username']+_0x2d8554(0x1e2));}catch(_0x2b619a){console[_0x2d8554(0x1d8)]('Error\x20in\x20handleSingleLineVerification:',_0x2b619a),await this['bot']?.['sendMessage'](_0x487b9c,_0x2d8554(0x167));}}async['sendShopNotification'](_0x1af653,_0x16daac,_0x19ecb0){const _0x5ce7fa=a55_0x4977a9;if(!this[_0x5ce7fa(0x12d)]){console[_0x5ce7fa(0x153)]('Telegram\x20bot\x20not\x20initialized,\x20cannot\x20send\x20notification');return;}try{const _0x256089=await database_1[_0x5ce7fa(0x1f8)][_0x5ce7fa(0x1ac)][_0x5ce7fa(0x13f)]({'where':{'shopId':_0x1af653,'isVerified':!![]}});if(_0x256089['length']===0x0){console[_0x5ce7fa(0x1c4)](_0x5ce7fa(0x123)+_0x1af653);return;}const _0x475f04=_0x256089[_0x5ce7fa(0x151)](async _0x4a7f81=>{const _0x2b58ac=_0x5ce7fa;try{await this[_0x2b58ac(0x12d)]?.[_0x2b58ac(0x1e0)](_0x4a7f81[_0x2b58ac(0x1e7)],_0x16daac,_0x19ecb0),console[_0x2b58ac(0x1c4)](_0x2b58ac(0x14b)+_0x4a7f81['telegramId']);}catch(_0x185dc1){console[_0x2b58ac(0x1d8)](_0x2b58ac(0x16e)+_0x4a7f81[_0x2b58ac(0x1e7)]+':',_0x185dc1),_0x185dc1 instanceof Error&&(_0x185dc1['message']['includes'](_0x2b58ac(0x1cb))||_0x185dc1[_0x2b58ac(0x192)][_0x2b58ac(0x1c2)](_0x2b58ac(0x115))||_0x185dc1['message']['includes'](_0x2b58ac(0x156)))&&(await database_1[_0x2b58ac(0x1f8)][_0x2b58ac(0x1ac)][_0x2b58ac(0x171)]({'where':{'id':_0x4a7f81['id']},'data':{'isVerified':![]}}),console[_0x2b58ac(0x1c4)](_0x2b58ac(0x1e1)+_0x4a7f81[_0x2b58ac(0x1e7)]+_0x2b58ac(0x141)));}});await Promise[_0x5ce7fa(0x1ef)](_0x475f04);}catch(_0x5cd962){console[_0x5ce7fa(0x1d8)]('Error\x20sending\x20shop\x20notification:',_0x5cd962);}}async['sendPaymentNotification'](_0x57c7da,_0x4b2437,_0x278ed4){const _0x44c40d=a55_0x4977a9,_0x352fea={'created':'🆕','paid':'✅','failed':'❌','expired':'⏰','refund':'🔄','chargeback':'⚠️','processing':'⚙️'},_0x48a538={'created':_0x44c40d(0x145),'paid':_0x44c40d(0x1eb),'failed':_0x44c40d(0x12c),'expired':_0x44c40d(0x1be),'refund':_0x44c40d(0x148),'chargeback':_0x44c40d(0x197),'processing':_0x44c40d(0x195)},_0x27de52=_0x352fea[_0x278ed4],_0x2c7f82=_0x48a538[_0x278ed4],_0x38f50a=(0x0,gateway_1['getGatewayDisplayNameForTelegram'])(_0x4b2437[_0x44c40d(0x1e4)]);console['log'](_0x44c40d(0x15c)+_0x4b2437['gateway']+_0x44c40d(0x1a6)+_0x38f50a+'\x22');let _0x436d12=_0x27de52+'\x20*'+_0x2c7f82+_0x44c40d(0x1f3)+(_0x44c40d(0x16b)+_0x4b2437[_0x44c40d(0x16f)]+'\x20'+_0x4b2437[_0x44c40d(0x134)]+'*\x0a')+('📝\x20Order\x20ID:\x20`'+(_0x4b2437['orderId']||_0x4b2437['id'])+'`\x0a')+(_0x44c40d(0x1a3)+_0x4b2437['id']+'`\x0a')+(_0x44c40d(0x1ad)+_0x38f50a+'`\x0a')+('📅\x20Date:\x20'+new Date(_0x4b2437[_0x44c40d(0x144)])[_0x44c40d(0x193)](_0x44c40d(0x184))+'\x0a');if(_0x4b2437[_0x44c40d(0x199)]||_0x4b2437[_0x44c40d(0x163)]||_0x4b2437[_0x44c40d(0x162)]||_0x4b2437[_0x44c40d(0x1d0)]||_0x4b2437[_0x44c40d(0x1e8)]){_0x436d12+='\x0a👤\x20*Customer\x20Information:*\x0a';_0x4b2437[_0x44c40d(0x199)]&&(_0x436d12+=_0x44c40d(0x1e6)+_0x4b2437['customerName']+'`\x0a');_0x4b2437['customerEmail']&&(_0x436d12+=_0x44c40d(0x1b3)+_0x4b2437[_0x44c40d(0x163)]+'`\x0a');_0x4b2437[_0x44c40d(0x162)]&&(_0x436d12+=_0x44c40d(0x18f)+_0x4b2437[_0x44c40d(0x162)]+'`\x0a');_0x4b2437['customerIp']&&(_0x436d12+='🌐\x20IP:\x20`'+_0x4b2437['customerIp']+'`\x0a');if(_0x4b2437[_0x44c40d(0x1e8)]){const _0x21ad0c=_0x4b2437[_0x44c40d(0x1e8)]['length']>0x32?_0x4b2437['customerUa'][_0x44c40d(0x19a)](0x0,0x32)+_0x44c40d(0x16d):_0x4b2437['customerUa'];_0x436d12+=_0x44c40d(0x1b7)+_0x21ad0c+'`\x0a';}}_0x278ed4===_0x44c40d(0x150)&&_0x4b2437[_0x44c40d(0x1a4)]&&(_0x436d12+='💸\x20Penalty\x20amount:\x20*'+_0x4b2437[_0x44c40d(0x1a4)]+_0x44c40d(0x164)),_0x278ed4==='processing'&&(_0x436d12+=_0x44c40d(0x1ea)),_0x4b2437[_0x44c40d(0x1f6)]&&(_0x436d12+=_0x44c40d(0x135)+_0x4b2437[_0x44c40d(0x1f6)]+'\x0a'),await this[_0x44c40d(0x1ee)](_0x57c7da,_0x436d12,{'parse_mode':'Markdown'});}async[a55_0x4977a9(0x11d)](_0x668d19,_0x26617c,_0xed4be2){const _0x139f32=a55_0x4977a9,_0x1ce9a5={'created':'📤','completed':'✅','rejected':'❌'},_0x286790={'created':_0x139f32(0x17f),'completed':_0x139f32(0x1e3),'rejected':'Payout\x20rejected'},_0x2e572d=_0x1ce9a5[_0xed4be2],_0x37c908=_0x286790[_0xed4be2],_0x22fc3c=_0x2e572d+'\x20*'+_0x37c908+_0x139f32(0x1f3)+(_0x139f32(0x1e5)+_0x26617c['amount']+_0x139f32(0x159))+(_0x139f32(0x190)+_0x26617c['method']+'`\x0a')+('🆔\x20Payout\x20ID:\x20`'+_0x26617c['id']+'`\x0a')+(_0x139f32(0x18d)+new Date(_0x26617c[_0x139f32(0x144)])[_0x139f32(0x193)](_0x139f32(0x184))+'\x0a')+(_0x26617c['txid']?_0x139f32(0x1c9)+_0x26617c[_0x139f32(0x172)]+'`':'');await this[_0x139f32(0x1ee)](_0x668d19,_0x22fc3c,{'parse_mode':_0x139f32(0x14f)});}async[a55_0x4977a9(0x1d6)](_0x2186fb,_0x687bde){const _0x3eca54=a55_0x4977a9;try{const _0x24f2ca=await database_1['default'][_0x3eca54(0x1bb)]['findUnique']({'where':{'shopId':_0x2186fb},'select':{'notificationLogin':!![]}});if(!_0x24f2ca?.[_0x3eca54(0x1fa)]){console['log'](_0x3eca54(0x17e)+_0x2186fb);return;}const _0x1edb25=_0x687bde[_0x3eca54(0x152)]?'🔐':'🚨',_0x20f945=_0x687bde['success']?'Successful\x20login':'Failed\x20login\x20attempt';let _0x3f5cf9=_0x1edb25+'\x20*'+_0x20f945+_0x3eca54(0x1f3)+(_0x3eca54(0x160)+_0x687bde['username']+'`\x0a')+(_0x3eca54(0x174)+_0x687bde[_0x3eca54(0x14a)][_0x3eca54(0x193)]('en-US')+'\x0a');_0x687bde[_0x3eca54(0x13b)]&&(_0x3f5cf9+=_0x3eca54(0x121)+_0x687bde[_0x3eca54(0x13b)]+'`\x0a');if(_0x687bde[_0x3eca54(0x158)]){const _0x4b34f0=_0x687bde[_0x3eca54(0x158)][_0x3eca54(0x19e)]>0x32?_0x687bde[_0x3eca54(0x158)][_0x3eca54(0x19a)](0x0,0x32)+'...':_0x687bde[_0x3eca54(0x158)];_0x3f5cf9+=_0x3eca54(0x1b7)+_0x4b34f0+'`\x0a';}!_0x687bde['success']&&(_0x3f5cf9+=_0x3eca54(0x138)),await this[_0x3eca54(0x1ee)](_0x2186fb,_0x3f5cf9,{'parse_mode':'Markdown'}),console['log'](_0x3eca54(0x1b9)+_0x2186fb+':\x20'+(_0x687bde[_0x3eca54(0x152)]?_0x3eca54(0x152):_0x3eca54(0x1ed)));}catch(_0x2640fa){console[_0x3eca54(0x1d8)](_0x3eca54(0x1d1),_0x2640fa);}}async[a55_0x4977a9(0x139)](_0x1b4acc,_0x42b936){const _0x10b578=a55_0x4977a9;try{const _0x12a645=await database_1[_0x10b578(0x1f8)][_0x10b578(0x1bb)]['findUnique']({'where':{'shopId':_0x1b4acc},'select':{'notificationApiError':!![]}});if(!_0x12a645?.[_0x10b578(0x187)]){console[_0x10b578(0x1c4)]('📱\x20API\x20error\x20notifications\x20disabled\x20for\x20shop\x20'+_0x1b4acc);return;}let _0x54c408='🚨\x20*API\x20Error*\x0a\x0a'+('🔗\x20Endpoint:\x20`'+_0x42b936[_0x10b578(0x1ca)]+'\x20'+_0x42b936['endpoint']+'`\x0a')+(_0x10b578(0x174)+_0x42b936['timestamp']['toLocaleString']('en-US')+'\x0a');_0x42b936[_0x10b578(0x1c8)]&&(_0x54c408+=_0x10b578(0x11b)+_0x42b936['statusCode']+'`\x0a'),_0x54c408+='❌\x20Error:\x20`'+_0x42b936[_0x10b578(0x11a)]+'`\x0a',_0x42b936['requestId']&&(_0x54c408+=_0x10b578(0x15a)+_0x42b936[_0x10b578(0x1c6)]+'`\x0a'),_0x54c408+='\x0a💡\x20Check\x20your\x20request\x20or\x20contact\x20support.',await this[_0x10b578(0x1ee)](_0x1b4acc,_0x54c408,{'parse_mode':_0x10b578(0x14f)}),console[_0x10b578(0x1c4)](_0x10b578(0x182)+_0x1b4acc+':\x20'+_0x42b936[_0x10b578(0x19b)]);}catch(_0x24628c){console['error'](_0x10b578(0x13d),_0x24628c);}}async[a55_0x4977a9(0x133)](_0x213e54,_0x5d448a,_0x4a6bad){const _0x44c2f5=a55_0x4977a9;let _0x1a2c8f=_0x44c2f5(0x170)+_0x5d448a+'*\x0a\x0a';for(const [_0x1aa526,_0x134b76]of Object[_0x44c2f5(0x196)](_0x4a6bad)){_0x134b76!==null&&_0x134b76!==undefined&&(_0x1a2c8f+=_0x1aa526+':\x20`'+_0x134b76+'`\x0a');}await this[_0x44c2f5(0x1ee)](_0x213e54,_0x1a2c8f,{'parse_mode':_0x44c2f5(0x14f)});}[a55_0x4977a9(0x12f)](){const _0x3bc362=a55_0x4977a9;return{'isActive':!!this[_0x3bc362(0x12d)],'username':this['botUsername']};}[a55_0x4977a9(0x142)](){const _0x2e594d=a55_0x4977a9;this[_0x2e594d(0x12d)]&&(this[_0x2e594d(0x12d)][_0x2e594d(0x17b)](),this[_0x2e594d(0x12d)]=null,console[_0x2e594d(0x1c4)](_0x2e594d(0x124)));}}function a55_0x1cd6(_0x1454aa,_0x119f86){const _0x30e8ca=a55_0x30e8();return a55_0x1cd6=function(_0x1cd64f,_0x4c1f02){_0x1cd64f=_0x1cd64f-0x115;let _0x24ce63=_0x30e8ca[_0x1cd64f];return _0x24ce63;},a55_0x1cd6(_0x1454aa,_0x119f86);}exports[a55_0x4977a9(0x18b)]=TelegramBotService,exports[a55_0x4977a9(0x11e)]=new TelegramBotService();