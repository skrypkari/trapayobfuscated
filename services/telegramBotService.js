'use strict';function a54_0x2b50(){const _0x93bd37=['defineProperty','•\x20Payouts\x0a\x0a','statusCode','Telegram\x20bot\x20not\x20initialized,\x20cannot\x20send\x20notification','failed','Error\x20sending\x20shop\x20notification:','Use\x20/start\x20to\x20connect.','📝\x20Format:\x20`username\x20api_key`\x0a\x0a','endpoint','🔗\x20TXID:\x20`','log','✅\x20You\x20have\x20been\x20successfully\x20connected\x20to\x20the\x20notification\x20system!\x0a\x0a','.\x20*','818864jnFIFI','\x20parts:\x20','\x20\x20\x20Username:\x20`','join','Example:\x0a','adminNotes','📱\x20Telegram\x20notification:\x20gateway\x20\x22','\x0a💡\x20Check\x20your\x20request\x20or\x20contact\x20support.','env','telegramBotService','714056VttvTO','📅\x20Time:\x20','8BuRWqP','sendApiErrorNotification','New\x20payout\x20created','🔌\x20User\x20','update','../types/gateway','TELEGRAM_BOT_USERNAME','substring','🚨\x20*API\x20Error*\x0a\x0a','🆔\x20Payout\x20ID:\x20`','\x20disconnected\x20from\x20shop\x20','node-telegram-bot-api','\x20\x20\x20Status:\x20',':\x20username=\x22','👤\x20Username:\x20`','\x20USDT*\x0a','length','trim','*\x0a\x0a','📱\x20API\x20error\x20notifications\x20disabled\x20for\x20shop\x20','✅\x20Welcome\x20back!\x0a\x0a','❌\x20An\x20error\x20occurred.\x20Please\x20try\x20again\x20later.','`\x0a\x0a','📅\x20Connection\x20date:\x20','forEach','💸\x20Penalty\x20amount:\x20*','allSettled','📧\x20Email:\x20`','`\x20not\x20found.\x0a\x0a','pk_','updatedAt','...','shopId','setupBotHandlers','txid','stopPolling','Commands:\x0a','⏳\x20The\x20payment\x20is\x20currently\x20being\x20processed\x20by\x20the\x20gateway.\x0a','Available\x20usernames:\x0a',':\x20`','📊\x20*Connection\x20Status*\x0a\x0a','__esModule','findUnique','Expected\x20key\x20format:\x20`pk_...`\x20or\x20`sk_...`','💸\x20Amount:\x20*','polling_error','6gMhQpJ','🆔\x20Request\x20ID:\x20`','notificationLogin','🛑\x20Telegram\x20bot\x20stopped','method','findFirst','5550597ZfaSlV','handleSingleLineVerification','/status\x20-\x20check\x20connection\x20status\x0a','chargebackAmount','💻\x20Browser:\x20`','❌\x20Shop\x20with\x20username\x20`','🤖\x20Welcome\x20to\x20TRAPAY\x20notification\x20system!\x0a\x0a','✅\x20Telegram\x20user\x20','sendPaymentNotification','error','❌\x20Error:\x20`','5xMSlHu','startsWith','sendShopNotification','`.\x0a\x0a','bot','split','createdAt','25023VJZJvs','❌\x20Invalid\x20API\x20key\x20format.\x0a\x0a','✅\x20You\x20have\x20been\x20successfully\x20disconnected\x20from\x20shop\x20*','Markdown','•\x20Important\x20events\x0a\x0a','Contact\x20administrator.','Error\x20in\x20handleSingleLineVerification:','`appple\x20pk_aa6450d3f57afbefbb0f3f5be5ce6cca13037536afc5ccf14c81a6cbc7a07de5`\x0a\x0a','🌐\x20IP\x20address:\x20`','*.\x0a\x0a','Payment\x20chargeback','•\x20Payment\x20status\x20changes\x0a','message','en-US','../config/database','✅\x20Notification\x20sent\x20to\x20Telegram\x20user\x20','toString','Failed\x20login\x20attempt','\x20marked\x20as\x20unverified\x20due\x20to\x20delivery\x20failure','errorMessage','❌\x20Invalid\x20format.\x20Please\x20send\x20exactly\x202\x20parts\x20separated\x20by\x20space:\x0a\x0a','botUsername','5611188CWPKdZ','✅\x20Connected\x20to\x20shop:\x20*','📅\x20Date:\x20','Failed\x20to\x20send\x20API\x20error\x20notification:','sk_','findMany','🔔\x20*','status','sendMessage','❌\x20Error\x20getting\x20debug\x20information.','__importDefault','isVerified','getGatewayDisplayNameForTelegram','🔗\x20Endpoint:\x20`','customerName','Payout\x20completed','name','❗️\x20Make\x20sure\x20to\x20separate\x20username\x20and\x20API\x20key\x20with\x20a\x20space!','default','test','📝\x20Order\x20ID:\x20`','userAgent','✅\x20API\x20error\x20notification\x20sent\x20for\x20shop\x20','New\x20payment\x20created','\x22,\x20apiKey=\x22','onText','...`\x0a\x0a','`\x20(','\x0aCheck\x20spelling\x20and\x20try\x20again.','Disconnect\x20the\x20previous\x20account\x20first\x20or\x20contact\x20administrator.','shop','gateway','❌\x20Shop\x20`','No\x20verified\x20Telegram\x20users\x20found\x20for\x20shop\x20','Payout\x20rejected','Payment\x20is\x20being\x20processed','chat','customerEmail','\x20verified\x20for\x20shop\x20','TelegramBotService','includes','❌\x20You\x20are\x20not\x20registered\x20in\x20the\x20system.\x0a\x0a','unknown\x20shop','To\x20receive\x20payment\x20notifications,\x20send\x20your\x20credentials\x20in\x20one\x20line:\x0a\x0a','telegramUser','Error\x20handling\x20/status\x20command:','TELEGRAM_BOT_TOKEN','ipAddress','timestamp','\x0a⚠️\x20If\x20this\x20wasn\x27t\x20you,\x20change\x20your\x20password\x20immediately!','text','You\x20sent\x20','🏦\x20Method:\x20`','🎉\x20*Congratulations!*\x0a\x0a','stopBot','shopSettings','requestId','user\x20is\x20deactivated','🔔\x20You\x20receive\x20notifications\x20about:\x0a','📊\x20Error\x20code:\x20`','success','last_name','User\x20','warn','toLocaleString','currency','map','🔄\x20Processing\x20single-line\x20verification\x20for\x20user\x20','publicKey','/disconnect\x20-\x20disconnect\x20from\x20notifications','\x20initialized\x20successfully','📝\x20Notes:\x20','\x0a👤\x20*Customer\x20Information:*\x0a','❌\x20Failed\x20to\x20send\x20notification\x20to\x20Telegram\x20user\x20','botToken','\x22\x20->\x20display\x20\x22','sendPayoutNotification','5550790yslDGX','794181oDYZOx','`\x20is\x20inactive.\x0a\x0a','🏪\x20Available\x20shops\x20in\x20system:\x0a','•\x20New\x20payments\x0a','chat\x20not\x20found','📱\x20Created\x20new\x20Telegram\x20user:\x20','\x20\x20\x20Public\x20Key:\x20`','chargeback','from','❌\x20Please\x20use\x20/start\x20command\x20first','✅\x20Login\x20notification\x20sent\x20for\x20shop\x20','telegramId','TELEGRAM_BOT_TOKEN\x20not\x20found\x20in\x20environment\x20variables','Use\x20/start\x20to\x20begin.','\x20(@','❌\x20Invalid\x20username\x20format:\x20`','...\x22','Error\x20handling\x20/start\x20command:','username'];a54_0x2b50=function(){return _0x93bd37;};return a54_0x2b50();}const a54_0x3781e3=a54_0x3192;(function(_0x399a12,_0x16e438){const _0x305853=a54_0x3192,_0x2ec030=_0x399a12();while(!![]){try{const _0xc4fdd=parseInt(_0x305853(0x101))/0x1*(parseInt(_0x305853(0xe9))/0x2)+parseInt(_0x305853(0x165))/0x3+-parseInt(_0x305853(0xaf))/0x4+parseInt(_0x305853(0xfa))/0x5*(-parseInt(_0x305853(0x117))/0x6)+parseInt(_0x305853(0xb9))/0x7+-parseInt(_0x305853(0xbb))/0x8*(-parseInt(_0x305853(0xef))/0x9)+parseInt(_0x305853(0x164))/0xa;if(_0xc4fdd===_0x16e438)break;else _0x2ec030['push'](_0x2ec030['shift']());}catch(_0x312ef2){_0x2ec030['push'](_0x2ec030['shift']());}}}(a54_0x2b50,0x73a66));var __importDefault=this&&this[a54_0x3781e3(0x121)]||function(_0x3b0b85){const _0x572629=a54_0x3781e3;return _0x3b0b85&&_0x3b0b85[_0x572629(0xe4)]?_0x3b0b85:{'default':_0x3b0b85};};function a54_0x3192(_0x11b0e7,_0x4352db){const _0x2b5085=a54_0x2b50();return a54_0x3192=function(_0x319215,_0x133e5e){_0x319215=_0x319215-0x99;let _0x3188f6=_0x2b5085[_0x319215];return _0x3188f6;},a54_0x3192(_0x11b0e7,_0x4352db);}Object[a54_0x3781e3(0xa2)](exports,a54_0x3781e3(0xe4),{'value':!![]}),exports[a54_0x3781e3(0xb8)]=exports[a54_0x3781e3(0x13e)]=void 0x0;const node_telegram_bot_api_1=__importDefault(require(a54_0x3781e3(0xc6))),database_1=__importDefault(require(a54_0x3781e3(0x10f))),gateway_1=require(a54_0x3781e3(0xc0));class TelegramBotService{constructor(){const _0x3dc0a9=a54_0x3781e3;this[_0x3dc0a9(0xfe)]=null,this[_0x3dc0a9(0x161)]=process[_0x3dc0a9(0xb7)][_0x3dc0a9(0x145)]||'',this['botUsername']=process[_0x3dc0a9(0xb7)][_0x3dc0a9(0xc1)]||'trapay_bot',this[_0x3dc0a9(0x161)]?this['initializeBot']():console[_0x3dc0a9(0x156)](_0x3dc0a9(0x9b));}['initializeBot'](){const _0x27746c=a54_0x3781e3;try{this[_0x27746c(0xfe)]=new node_telegram_bot_api_1['default'](this[_0x27746c(0x161)],{'polling':!![]}),this['setupBotHandlers'](),console['log']('✅\x20Telegram\x20bot\x20@'+this[_0x27746c(0x116)]+_0x27746c(0x15d));}catch(_0x57fc0b){console['error']('❌\x20Failed\x20to\x20initialize\x20Telegram\x20bot:',_0x57fc0b);}}[a54_0x3781e3(0xdc)](){const _0x171268=a54_0x3781e3;if(!this['bot'])return;this['bot'][_0x171268(0x130)](/\/start/,async _0x180ae0=>{const _0x53016d=_0x171268,_0x2bc637=_0x180ae0[_0x53016d(0x13b)]['id'],_0x28b0ce=_0x180ae0[_0x53016d(0x16d)]?.['id'][_0x53016d(0x111)](),_0x22dbca=_0x180ae0['from']?.[_0x53016d(0xa1)],_0x317af4=_0x180ae0['from']?.['first_name'],_0x528dbf=_0x180ae0['from']?.[_0x53016d(0x154)];if(!_0x28b0ce)return;try{let _0xaed3e2=await database_1[_0x53016d(0x129)]['telegramUser'][_0x53016d(0xe5)]({'where':{'telegramId':_0x28b0ce},'include':{'shop':!![]}});!_0xaed3e2?(_0xaed3e2=await database_1[_0x53016d(0x129)][_0x53016d(0x143)]['create']({'data':{'telegramId':_0x28b0ce,'username':_0x22dbca,'firstName':_0x317af4,'lastName':_0x528dbf,'isVerified':![],'shopId':null},'include':{'shop':!![]}}),console[_0x53016d(0xac)](_0x53016d(0x16a)+_0x28b0ce+_0x53016d(0x9d)+_0x22dbca+')')):_0xaed3e2=await database_1[_0x53016d(0x129)][_0x53016d(0x143)][_0x53016d(0xbf)]({'where':{'telegramId':_0x28b0ce},'data':{'username':_0x22dbca,'firstName':_0x317af4,'lastName':_0x528dbf},'include':{'shop':!![]}}),_0xaed3e2[_0x53016d(0x122)]&&_0xaed3e2['shopId']&&_0xaed3e2['shop']?await this[_0x53016d(0xfe)]?.[_0x53016d(0x11f)](_0x2bc637,_0x53016d(0xcf)+('You\x20are\x20already\x20connected\x20to\x20shop:\x20*'+_0xaed3e2[_0x53016d(0x135)][_0x53016d(0x127)]+'*\x0a')+('Username:\x20`'+_0xaed3e2['shop']['username']+_0x53016d(0xd1))+_0x53016d(0x151)+_0x53016d(0x168)+_0x53016d(0x10c)+_0x53016d(0xa3)+_0x53016d(0xdf)+_0x53016d(0xf1)+_0x53016d(0x15c),{'parse_mode':_0x53016d(0x104)}):(_0xaed3e2[_0x53016d(0xdb)]&&!_0xaed3e2[_0x53016d(0x122)]&&(await database_1[_0x53016d(0x129)][_0x53016d(0x143)][_0x53016d(0xbf)]({'where':{'telegramId':_0x28b0ce},'data':{'shopId':null,'isVerified':![]}}),console['log']('🔄\x20Reset\x20incomplete\x20verification\x20for\x20user\x20'+_0x28b0ce)),await this[_0x53016d(0xfe)]?.['sendMessage'](_0x2bc637,_0x53016d(0xf5)+_0x53016d(0x142)+_0x53016d(0xa9)+'Example:\x0a'+_0x53016d(0x108)+_0x53016d(0x128),{'parse_mode':_0x53016d(0x104)}));}catch(_0x1c86c2){console[_0x53016d(0xf8)](_0x53016d(0xa0),_0x1c86c2),await this[_0x53016d(0xfe)]?.['sendMessage'](_0x2bc637,_0x53016d(0xd0));}}),this[_0x171268(0xfe)][_0x171268(0x130)](/\/disconnect/,async _0x3b5b4e=>{const _0x4612fc=_0x171268,_0x20b2ea=_0x3b5b4e['chat']['id'],_0x51ec7b=_0x3b5b4e[_0x4612fc(0x16d)]?.['id']['toString']();if(!_0x51ec7b)return;try{const _0x49688d=await database_1[_0x4612fc(0x129)][_0x4612fc(0x143)][_0x4612fc(0xe5)]({'where':{'telegramId':_0x51ec7b},'include':{'shop':!![]}});if(!_0x49688d||!_0x49688d[_0x4612fc(0x122)]||!_0x49688d[_0x4612fc(0xdb)]){await this[_0x4612fc(0xfe)]?.[_0x4612fc(0x11f)](_0x20b2ea,'❌\x20You\x20are\x20not\x20connected\x20to\x20the\x20notification\x20system.');return;}const _0x59b298=_0x49688d[_0x4612fc(0x135)]?.[_0x4612fc(0x127)]||_0x4612fc(0x141);await database_1[_0x4612fc(0x129)]['telegramUser'][_0x4612fc(0xbf)]({'where':{'telegramId':_0x51ec7b},'data':{'shopId':null,'isVerified':![]}}),console[_0x4612fc(0xac)](_0x4612fc(0xbe)+_0x51ec7b+_0x4612fc(0xc5)+_0x49688d[_0x4612fc(0xdb)]),await this[_0x4612fc(0xfe)]?.[_0x4612fc(0x11f)](_0x20b2ea,_0x4612fc(0x103)+_0x59b298+_0x4612fc(0x10a)+'To\x20reconnect,\x20use\x20the\x20/start\x20command',{'parse_mode':_0x4612fc(0x104)});}catch(_0x1f72b4){console[_0x4612fc(0xf8)]('Error\x20handling\x20/disconnect\x20command:',_0x1f72b4),await this['bot']?.['sendMessage'](_0x20b2ea,_0x4612fc(0xd0));}}),this[_0x171268(0xfe)]['onText'](/\/status/,async _0x16bcd9=>{const _0x59ad81=_0x171268,_0x323bad=_0x16bcd9[_0x59ad81(0x13b)]['id'],_0x48c1a4=_0x16bcd9[_0x59ad81(0x16d)]?.['id']['toString']();if(!_0x48c1a4)return;try{const _0x390bdb=await database_1[_0x59ad81(0x129)][_0x59ad81(0x143)][_0x59ad81(0xe5)]({'where':{'telegramId':_0x48c1a4},'include':{'shop':!![]}});if(!_0x390bdb){await this[_0x59ad81(0xfe)]?.[_0x59ad81(0x11f)](_0x323bad,_0x59ad81(0x140)+_0x59ad81(0x9c));return;}if(!_0x390bdb[_0x59ad81(0x122)]||!_0x390bdb[_0x59ad81(0xdb)]||!_0x390bdb[_0x59ad81(0x135)]){await this['bot']?.[_0x59ad81(0x11f)](_0x323bad,'❌\x20You\x20are\x20not\x20connected\x20to\x20a\x20shop.\x0a\x0a'+_0x59ad81(0xa8));return;}await this[_0x59ad81(0xfe)]?.['sendMessage'](_0x323bad,_0x59ad81(0xe3)+(_0x59ad81(0x118)+_0x390bdb['shop'][_0x59ad81(0x127)]+'*\x0a')+(_0x59ad81(0xc9)+_0x390bdb[_0x59ad81(0x135)][_0x59ad81(0xa1)]+'`\x0a')+(_0x59ad81(0xd2)+_0x390bdb[_0x59ad81(0xd9)]['toLocaleDateString'](_0x59ad81(0x10e))+'\x0a\x0a')+'🔔\x20Notifications\x20are\x20active\x0a\x0a'+_0x59ad81(0xdf)+'/disconnect\x20-\x20disconnect\x20from\x20notifications',{'parse_mode':_0x59ad81(0x104)});}catch(_0x236ebe){console[_0x59ad81(0xf8)](_0x59ad81(0x144),_0x236ebe),await this[_0x59ad81(0xfe)]?.[_0x59ad81(0x11f)](_0x323bad,_0x59ad81(0xd0));}}),this[_0x171268(0xfe)][_0x171268(0x130)](/\/debug/,async _0x2e608f=>{const _0x28f55a=_0x171268,_0x2f6896=_0x2e608f[_0x28f55a(0x13b)]['id'],_0x2edd98=_0x2e608f['from']?.['id'][_0x28f55a(0x111)]();if(!_0x2edd98)return;try{const _0x3b9d57=await database_1[_0x28f55a(0x129)][_0x28f55a(0x135)][_0x28f55a(0x11c)]({'select':{'id':!![],'name':!![],'username':!![],'status':!![],'publicKey':!![]},'take':0xa});let _0x78b09c='🔍\x20*Debug\x20Information*\x0a\x0a';_0x78b09c+='📱\x20Your\x20Telegram\x20ID:\x20`'+_0x2edd98+_0x28f55a(0xd1),_0x78b09c+=_0x28f55a(0x167),_0x3b9d57[_0x28f55a(0xd3)]((_0x553594,_0x2af833)=>{const _0x7f3856=_0x28f55a;_0x78b09c+=_0x2af833+0x1+_0x7f3856(0xae)+_0x553594['name']+'*\x0a',_0x78b09c+=_0x7f3856(0xb1)+_0x553594['username']+'`\x0a',_0x78b09c+=_0x7f3856(0xc7)+_0x553594[_0x7f3856(0x11e)]+'\x0a',_0x78b09c+=_0x7f3856(0x16b)+_0x553594[_0x7f3856(0x15b)][_0x7f3856(0xc2)](0x0,0xf)+_0x7f3856(0x131);}),await this[_0x28f55a(0xfe)]?.[_0x28f55a(0x11f)](_0x2f6896,_0x78b09c,{'parse_mode':_0x28f55a(0x104)});}catch(_0x6a8d6a){console[_0x28f55a(0xf8)]('Error\x20handling\x20/debug\x20command:',_0x6a8d6a),await this[_0x28f55a(0xfe)]?.[_0x28f55a(0x11f)](_0x2f6896,_0x28f55a(0x120));}}),this[_0x171268(0xfe)]['on']('message',async _0x3a6b01=>{const _0x335643=_0x171268;if(_0x3a6b01[_0x335643(0x149)]?.[_0x335643(0xfb)]('/'))return;const _0x2cbf50=_0x3a6b01[_0x335643(0x13b)]['id'],_0x55a956=_0x3a6b01[_0x335643(0x16d)]?.['id'][_0x335643(0x111)](),_0x52e523=_0x3a6b01[_0x335643(0x149)]?.[_0x335643(0xcc)]();if(!_0x55a956||!_0x52e523)return;try{const _0x3b7eb3=await database_1['default'][_0x335643(0x143)][_0x335643(0xe5)]({'where':{'telegramId':_0x55a956},'include':{'shop':!![]}});if(!_0x3b7eb3){await this['bot']?.['sendMessage'](_0x2cbf50,_0x335643(0x16e));return;}if(_0x3b7eb3[_0x335643(0x122)]&&_0x3b7eb3['shopId']&&_0x3b7eb3[_0x335643(0x135)]){await this[_0x335643(0xfe)]?.['sendMessage'](_0x2cbf50,'✅\x20You\x20are\x20already\x20connected\x20to\x20shop\x20*'+_0x3b7eb3[_0x335643(0x135)]['name']+_0x335643(0x10a)+'Use\x20/status\x20to\x20check\x20status\x20or\x20/disconnect\x20to\x20disconnect.',{'parse_mode':_0x335643(0x104)});return;}const _0x4bce12=_0x52e523[_0x335643(0xff)](/\s+/);if(_0x4bce12[_0x335643(0xcb)]!==0x2){await this[_0x335643(0xfe)]?.[_0x335643(0x11f)](_0x2cbf50,_0x335643(0x115)+'📝\x20Format:\x20`username\x20api_key`\x0a\x0a'+_0x335643(0xb3)+_0x335643(0x108)+(_0x335643(0x14a)+_0x4bce12[_0x335643(0xcb)]+_0x335643(0xb0)+_0x4bce12[_0x335643(0x159)](_0x927de0=>'`'+_0x927de0+'`')[_0x335643(0xb2)](',\x20')),{'parse_mode':_0x335643(0x104)});return;}const [_0x1b29c6,_0x166c16]=_0x4bce12;console[_0x335643(0xac)](_0x335643(0x15a)+_0x55a956+_0x335643(0xc8)+_0x1b29c6+_0x335643(0x12f)+_0x166c16[_0x335643(0xc2)](0x0,0xa)+_0x335643(0x9f)),await this['handleSingleLineVerification'](_0x2cbf50,_0x55a956,_0x1b29c6,_0x166c16);}catch(_0x4a12c8){console['error']('Error\x20handling\x20message:',_0x4a12c8),await this['bot']?.[_0x335643(0x11f)](_0x2cbf50,_0x335643(0xd0));}}),this[_0x171268(0xfe)]['on']('error',_0x36f76f=>{const _0x1ad0c1=_0x171268;console[_0x1ad0c1(0xf8)]('Telegram\x20bot\x20error:',_0x36f76f);}),this[_0x171268(0xfe)]['on'](_0x171268(0xe8),_0x588103=>{const _0x421f8d=_0x171268;console[_0x421f8d(0xf8)]('Telegram\x20bot\x20polling\x20error:',_0x588103);});}async[a54_0x3781e3(0xf0)](_0x569aab,_0x334d9e,_0x28636f,_0x185395){const _0x58f93b=a54_0x3781e3;try{console[_0x58f93b(0xac)](_0x58f93b(0x15a)+_0x334d9e+_0x58f93b(0xc8)+_0x28636f+_0x58f93b(0x12f)+_0x185395[_0x58f93b(0xc2)](0x0,0xa)+'...\x22');if(!_0x28636f||_0x28636f[_0x58f93b(0xcb)]<0x3||_0x28636f[_0x58f93b(0xcb)]>0x32||!/^[a-zA-Z0-9_]+$/[_0x58f93b(0x12a)](_0x28636f)){await this[_0x58f93b(0xfe)]?.[_0x58f93b(0x11f)](_0x569aab,_0x58f93b(0x9e)+_0x28636f+_0x58f93b(0xd1)+'Username\x20must\x20contain\x20only\x20letters,\x20numbers\x20and\x20underscore\x20(3-50\x20characters).',{'parse_mode':'Markdown'});return;}if(!_0x185395||!_0x185395[_0x58f93b(0xfb)](_0x58f93b(0xd8))&&!_0x185395['startsWith'](_0x58f93b(0x11b))){await this[_0x58f93b(0xfe)]?.[_0x58f93b(0x11f)](_0x569aab,_0x58f93b(0x102)+'API\x20key\x20must\x20start\x20with\x20`pk\x5c_`\x20or\x20`sk\x5c_`.',{'parse_mode':'Markdown'});return;}const _0x425bb3=await database_1[_0x58f93b(0x129)][_0x58f93b(0x135)][_0x58f93b(0xe5)]({'where':{'username':_0x28636f},'select':{'id':!![],'name':!![],'username':!![],'status':!![],'publicKey':!![],'secretKey':!![]}});if(!_0x425bb3){const _0x4ea87b=await database_1[_0x58f93b(0x129)]['shop'][_0x58f93b(0x11c)]({'select':{'username':!![],'name':!![]},'take':0x5});let _0x144ec1=_0x58f93b(0xf4)+_0x28636f+_0x58f93b(0xd7);_0x4ea87b[_0x58f93b(0xcb)]>0x0?(_0x144ec1+=_0x58f93b(0xe1),_0x4ea87b[_0x58f93b(0xd3)](_0x1f9450=>{const _0x3a8c6c=_0x58f93b;_0x144ec1+='•\x20`'+_0x1f9450[_0x3a8c6c(0xa1)]+_0x3a8c6c(0x132)+_0x1f9450[_0x3a8c6c(0x127)]+')\x0a';}),_0x144ec1+=_0x58f93b(0x133)):_0x144ec1+='Check\x20spelling\x20and\x20try\x20again.';await this[_0x58f93b(0xfe)]?.[_0x58f93b(0x11f)](_0x569aab,_0x144ec1,{'parse_mode':_0x58f93b(0x104)});return;}if(_0x425bb3[_0x58f93b(0x11e)]!=='ACTIVE'){await this[_0x58f93b(0xfe)]?.[_0x58f93b(0x11f)](_0x569aab,_0x58f93b(0x137)+_0x28636f+_0x58f93b(0x166)+_0x58f93b(0x106),{'parse_mode':_0x58f93b(0x104)});return;}if(_0x425bb3[_0x58f93b(0x15b)]!==_0x185395&&_0x425bb3['secretKey']!==_0x185395){await this['bot']?.[_0x58f93b(0x11f)](_0x569aab,'❌\x20API\x20key\x20does\x20not\x20match\x20shop\x20`'+_0x28636f+_0x58f93b(0xfd)+'Check\x20the\x20key\x20and\x20try\x20again.\x0a\x0a'+_0x58f93b(0xe6),{'parse_mode':'Markdown'});return;}const _0x580779=await database_1[_0x58f93b(0x129)][_0x58f93b(0x143)][_0x58f93b(0xee)]({'where':{'shopId':_0x425bb3['id'],'isVerified':!![],'telegramId':{'not':_0x334d9e}}});if(_0x580779){await this[_0x58f93b(0xfe)]?.[_0x58f93b(0x11f)](_0x569aab,'❌\x20Another\x20Telegram\x20account\x20is\x20already\x20connected\x20to\x20shop\x20`'+_0x28636f+_0x58f93b(0xfd)+_0x58f93b(0x134),{'parse_mode':_0x58f93b(0x104)});return;}await database_1['default'][_0x58f93b(0x143)]['update']({'where':{'telegramId':_0x334d9e},'data':{'shopId':_0x425bb3['id'],'isVerified':!![]}}),await this[_0x58f93b(0xfe)]?.[_0x58f93b(0x11f)](_0x569aab,_0x58f93b(0x14c)+_0x58f93b(0xad)+('📱\x20Shop:\x20*'+_0x425bb3[_0x58f93b(0x127)]+'*\x0a')+(_0x58f93b(0xc9)+_0x425bb3[_0x58f93b(0xa1)]+_0x58f93b(0xd1))+'🔔\x20You\x20will\x20now\x20receive\x20notifications\x20about:\x0a'+'•\x20New\x20payments\x0a'+_0x58f93b(0x10c)+'•\x20Payouts\x0a'+_0x58f93b(0x105)+_0x58f93b(0xdf)+_0x58f93b(0xf1)+_0x58f93b(0x15c),{'parse_mode':_0x58f93b(0x104)}),console['log'](_0x58f93b(0xf6)+_0x334d9e+_0x58f93b(0x13d)+_0x425bb3[_0x58f93b(0xa1)]+'\x20via\x20single-line\x20input');}catch(_0x4229f9){console[_0x58f93b(0xf8)](_0x58f93b(0x107),_0x4229f9),await this[_0x58f93b(0xfe)]?.[_0x58f93b(0x11f)](_0x569aab,'❌\x20An\x20error\x20occurred\x20while\x20verifying\x20data.');}}async['sendShopNotification'](_0x344272,_0x8b4a0,_0x4bc51a){const _0x375e21=a54_0x3781e3;if(!this['bot']){console['warn'](_0x375e21(0xa5));return;}try{const _0x2ce9ac=await database_1['default'][_0x375e21(0x143)]['findMany']({'where':{'shopId':_0x344272,'isVerified':!![]}});if(_0x2ce9ac[_0x375e21(0xcb)]===0x0){console[_0x375e21(0xac)](_0x375e21(0x138)+_0x344272);return;}const _0x4c74b6=_0x2ce9ac[_0x375e21(0x159)](async _0x46e2ea=>{const _0x5c988d=_0x375e21;try{await this[_0x5c988d(0xfe)]?.['sendMessage'](_0x46e2ea['telegramId'],_0x8b4a0,_0x4bc51a),console[_0x5c988d(0xac)](_0x5c988d(0x110)+_0x46e2ea[_0x5c988d(0x9a)]);}catch(_0x438eb7){console[_0x5c988d(0xf8)](_0x5c988d(0x160)+_0x46e2ea[_0x5c988d(0x9a)]+':',_0x438eb7),_0x438eb7 instanceof Error&&(_0x438eb7['message'][_0x5c988d(0x13f)]('blocked')||_0x438eb7['message'][_0x5c988d(0x13f)](_0x5c988d(0x169))||_0x438eb7[_0x5c988d(0x10d)][_0x5c988d(0x13f)](_0x5c988d(0x150)))&&(await database_1[_0x5c988d(0x129)]['telegramUser']['update']({'where':{'id':_0x46e2ea['id']},'data':{'isVerified':![]}}),console[_0x5c988d(0xac)](_0x5c988d(0x155)+_0x46e2ea[_0x5c988d(0x9a)]+_0x5c988d(0x113)));}});await Promise[_0x375e21(0xd5)](_0x4c74b6);}catch(_0x6c1014){console[_0x375e21(0xf8)](_0x375e21(0xa7),_0x6c1014);}}async[a54_0x3781e3(0xf7)](_0x37ebc7,_0x35e445,_0x402e2b){const _0x85eecc=a54_0x3781e3,_0x4260c8={'created':'🆕','paid':'✅','failed':'❌','expired':'⏰','refund':'🔄','chargeback':'⚠️','processing':'⚙️'},_0x47eca5={'created':_0x85eecc(0x12e),'paid':'Payment\x20successfully\x20paid','failed':'Payment\x20failed','expired':'Payment\x20expired','refund':'Payment\x20refund','chargeback':_0x85eecc(0x10b),'processing':_0x85eecc(0x13a)},_0x390f79=_0x4260c8[_0x402e2b],_0x47be31=_0x47eca5[_0x402e2b],_0x26a748=(0x0,gateway_1[_0x85eecc(0x123)])(_0x35e445['gateway']);console[_0x85eecc(0xac)](_0x85eecc(0xb5)+_0x35e445[_0x85eecc(0x136)]+_0x85eecc(0x162)+_0x26a748+'\x22');let _0x340a62=_0x390f79+'\x20*'+_0x47be31+'*\x0a\x0a'+('💰\x20Amount:\x20*'+_0x35e445['amount']+'\x20'+_0x35e445[_0x85eecc(0x158)]+'*\x0a')+(_0x85eecc(0x12b)+(_0x35e445['orderId']||_0x35e445['id'])+'`\x0a')+('🆔\x20Payment\x20ID:\x20`'+_0x35e445['id']+'`\x0a')+('🏪\x20Gateway:\x20`'+_0x26a748+'`\x0a')+(_0x85eecc(0x119)+new Date(_0x35e445[_0x85eecc(0x100)])['toLocaleString'](_0x85eecc(0x10e))+'\x0a');(_0x35e445[_0x85eecc(0x125)]||_0x35e445[_0x85eecc(0x13c)])&&(_0x340a62+=_0x85eecc(0x15f),_0x35e445[_0x85eecc(0x125)]&&(_0x340a62+='📛\x20Name:\x20`'+_0x35e445['customerName']+'`\x0a'),_0x35e445['customerEmail']&&(_0x340a62+=_0x85eecc(0xd6)+_0x35e445[_0x85eecc(0x13c)]+'`\x0a')),_0x402e2b===_0x85eecc(0x16c)&&_0x35e445[_0x85eecc(0xf2)]&&(_0x340a62+=_0x85eecc(0xd4)+_0x35e445[_0x85eecc(0xf2)]+_0x85eecc(0xca)),_0x402e2b==='processing'&&(_0x340a62+=_0x85eecc(0xe0)),_0x35e445[_0x85eecc(0xb4)]&&(_0x340a62+=_0x85eecc(0x15e)+_0x35e445[_0x85eecc(0xb4)]+'\x0a'),await this[_0x85eecc(0xfc)](_0x37ebc7,_0x340a62,{'parse_mode':'Markdown'});}async[a54_0x3781e3(0x163)](_0x2a42f5,_0x411aaa,_0x291d91){const _0xeddd75=a54_0x3781e3,_0x5a40a7={'created':'📤','completed':'✅','rejected':'❌'},_0x4e28f4={'created':_0xeddd75(0xbd),'completed':_0xeddd75(0x126),'rejected':_0xeddd75(0x139)},_0x767c6e=_0x5a40a7[_0x291d91],_0xd9ffe2=_0x4e28f4[_0x291d91],_0xc89720=_0x767c6e+'\x20*'+_0xd9ffe2+_0xeddd75(0xcd)+(_0xeddd75(0xe7)+_0x411aaa['amount']+'\x20USD*\x0a')+(_0xeddd75(0x14b)+_0x411aaa[_0xeddd75(0xed)]+'`\x0a')+(_0xeddd75(0xc4)+_0x411aaa['id']+'`\x0a')+(_0xeddd75(0x119)+new Date(_0x411aaa[_0xeddd75(0x100)])[_0xeddd75(0x157)]('en-US')+'\x0a')+(_0x411aaa['txid']?_0xeddd75(0xab)+_0x411aaa[_0xeddd75(0xdd)]+'`':'');await this[_0xeddd75(0xfc)](_0x2a42f5,_0xc89720,{'parse_mode':_0xeddd75(0x104)});}async['sendLoginNotification'](_0x85deac,_0x19096b){const _0x4c4948=a54_0x3781e3;try{const _0xd998a9=await database_1[_0x4c4948(0x129)][_0x4c4948(0x14e)][_0x4c4948(0xe5)]({'where':{'shopId':_0x85deac},'select':{'notificationLogin':!![]}});if(!_0xd998a9?.[_0x4c4948(0xeb)]){console[_0x4c4948(0xac)]('📱\x20Login\x20notifications\x20disabled\x20for\x20shop\x20'+_0x85deac);return;}const _0x2fd872=_0x19096b['success']?'🔐':'🚨',_0x31c562=_0x19096b['success']?'Successful\x20login':_0x4c4948(0x112);let _0x1aab0e=_0x2fd872+'\x20*'+_0x31c562+_0x4c4948(0xcd)+('👤\x20Username:\x20`'+_0x19096b[_0x4c4948(0xa1)]+'`\x0a')+(_0x4c4948(0xba)+_0x19096b[_0x4c4948(0x147)][_0x4c4948(0x157)](_0x4c4948(0x10e))+'\x0a');_0x19096b[_0x4c4948(0x146)]&&(_0x1aab0e+=_0x4c4948(0x109)+_0x19096b['ipAddress']+'`\x0a');if(_0x19096b[_0x4c4948(0x12c)]){const _0x1357a5=_0x19096b[_0x4c4948(0x12c)][_0x4c4948(0xcb)]>0x32?_0x19096b[_0x4c4948(0x12c)][_0x4c4948(0xc2)](0x0,0x32)+_0x4c4948(0xda):_0x19096b[_0x4c4948(0x12c)];_0x1aab0e+=_0x4c4948(0xf3)+_0x1357a5+'`\x0a';}!_0x19096b[_0x4c4948(0x153)]&&(_0x1aab0e+=_0x4c4948(0x148)),await this['sendShopNotification'](_0x85deac,_0x1aab0e,{'parse_mode':_0x4c4948(0x104)}),console[_0x4c4948(0xac)](_0x4c4948(0x99)+_0x85deac+':\x20'+(_0x19096b[_0x4c4948(0x153)]?_0x4c4948(0x153):_0x4c4948(0xa6)));}catch(_0x11be8a){console[_0x4c4948(0xf8)]('Failed\x20to\x20send\x20login\x20notification:',_0x11be8a);}}async[a54_0x3781e3(0xbc)](_0x2b0092,_0x13ad80){const _0x3655e8=a54_0x3781e3;try{const _0x54c12c=await database_1[_0x3655e8(0x129)][_0x3655e8(0x14e)][_0x3655e8(0xe5)]({'where':{'shopId':_0x2b0092},'select':{'notificationApiError':!![]}});if(!_0x54c12c?.['notificationApiError']){console[_0x3655e8(0xac)](_0x3655e8(0xce)+_0x2b0092);return;}let _0x45a165=_0x3655e8(0xc3)+(_0x3655e8(0x124)+_0x13ad80[_0x3655e8(0xed)]+'\x20'+_0x13ad80[_0x3655e8(0xaa)]+'`\x0a')+(_0x3655e8(0xba)+_0x13ad80[_0x3655e8(0x147)][_0x3655e8(0x157)](_0x3655e8(0x10e))+'\x0a');_0x13ad80[_0x3655e8(0xa4)]&&(_0x45a165+=_0x3655e8(0x152)+_0x13ad80[_0x3655e8(0xa4)]+'`\x0a'),_0x45a165+=_0x3655e8(0xf9)+_0x13ad80[_0x3655e8(0x114)]+'`\x0a',_0x13ad80[_0x3655e8(0x14f)]&&(_0x45a165+=_0x3655e8(0xea)+_0x13ad80['requestId']+'`\x0a'),_0x45a165+=_0x3655e8(0xb6),await this['sendShopNotification'](_0x2b0092,_0x45a165,{'parse_mode':_0x3655e8(0x104)}),console['log'](_0x3655e8(0x12d)+_0x2b0092+':\x20'+_0x13ad80['endpoint']);}catch(_0x361cf9){console[_0x3655e8(0xf8)](_0x3655e8(0x11a),_0x361cf9);}}async['sendCustomNotification'](_0x205a6c,_0x353daa,_0x39b1d8){const _0x3fbe9a=a54_0x3781e3;let _0x32ff98=_0x3fbe9a(0x11d)+_0x353daa+_0x3fbe9a(0xcd);for(const [_0x3a5d45,_0x109e3d]of Object['entries'](_0x39b1d8)){_0x109e3d!==null&&_0x109e3d!==undefined&&(_0x32ff98+=_0x3a5d45+_0x3fbe9a(0xe2)+_0x109e3d+'`\x0a');}await this[_0x3fbe9a(0xfc)](_0x205a6c,_0x32ff98,{'parse_mode':_0x3fbe9a(0x104)});}['getBotInfo'](){const _0x56d1cc=a54_0x3781e3;return{'isActive':!!this[_0x56d1cc(0xfe)],'username':this[_0x56d1cc(0x116)]};}[a54_0x3781e3(0x14d)](){const _0x3bc427=a54_0x3781e3;this['bot']&&(this[_0x3bc427(0xfe)][_0x3bc427(0xde)](),this['bot']=null,console[_0x3bc427(0xac)](_0x3bc427(0xec)));}}exports[a54_0x3781e3(0x13e)]=TelegramBotService,exports[a54_0x3781e3(0xb8)]=new TelegramBotService();