'use strict';const a54_0x4f8bbe=a54_0x4da2;(function(_0x4f9161,_0x2fd5c5){const _0x43cf51=a54_0x4da2,_0x19d869=_0x4f9161();while(!![]){try{const _0x3402c1=parseInt(_0x43cf51(0x1a8))/0x1*(-parseInt(_0x43cf51(0x1fe))/0x2)+-parseInt(_0x43cf51(0x14f))/0x3+parseInt(_0x43cf51(0x1ec))/0x4*(parseInt(_0x43cf51(0x176))/0x5)+parseInt(_0x43cf51(0x163))/0x6*(parseInt(_0x43cf51(0x19a))/0x7)+parseInt(_0x43cf51(0x200))/0x8*(-parseInt(_0x43cf51(0x210))/0x9)+parseInt(_0x43cf51(0x197))/0xa+-parseInt(_0x43cf51(0x1d4))/0xb*(-parseInt(_0x43cf51(0x15e))/0xc);if(_0x3402c1===_0x2fd5c5)break;else _0x19d869['push'](_0x19d869['shift']());}catch(_0x21c2c5){_0x19d869['push'](_0x19d869['shift']());}}}(a54_0x3e95,0x8351a));var __importDefault=this&&this[a54_0x4f8bbe(0x1d6)]||function(_0x5d58d2){return _0x5d58d2&&_0x5d58d2['__esModule']?_0x5d58d2:{'default':_0x5d58d2};};Object[a54_0x4f8bbe(0x152)](exports,a54_0x4f8bbe(0x146),{'value':!![]}),exports[a54_0x4f8bbe(0x1c3)]=exports[a54_0x4f8bbe(0x17c)]=void 0x0;const node_telegram_bot_api_1=__importDefault(require(a54_0x4f8bbe(0x14e))),database_1=__importDefault(require(a54_0x4f8bbe(0x18f))),gateway_1=require(a54_0x4f8bbe(0x1d3));class TelegramBotService{constructor(){const _0x211e83=a54_0x4f8bbe;this[_0x211e83(0x204)]=null,this[_0x211e83(0x168)]=process[_0x211e83(0x157)][_0x211e83(0x1ab)]||'',this[_0x211e83(0x1dd)]=process[_0x211e83(0x157)][_0x211e83(0x1f7)]||'trapay_bot',this[_0x211e83(0x168)]?this[_0x211e83(0x1cf)]():console['warn'](_0x211e83(0x18b));}[a54_0x4f8bbe(0x1cf)](){const _0x355982=a54_0x4f8bbe;try{this[_0x355982(0x204)]=new node_telegram_bot_api_1[(_0x355982(0x14a))](this[_0x355982(0x168)],{'polling':!![]}),this[_0x355982(0x147)](),console[_0x355982(0x192)](_0x355982(0x1ef)+this[_0x355982(0x1dd)]+_0x355982(0x170));}catch(_0x3fd6b7){console[_0x355982(0x1d5)](_0x355982(0x1e1),_0x3fd6b7);}}['setupBotHandlers'](){const _0x37c68f=a54_0x4f8bbe;if(!this[_0x37c68f(0x204)])return;this['bot'][_0x37c68f(0x1a2)](/\/start/,async _0x5de125=>{const _0x4e4df3=_0x37c68f,_0x41d842=_0x5de125[_0x4e4df3(0x179)]['id'],_0x312976=_0x5de125[_0x4e4df3(0x1a7)]?.['id'][_0x4e4df3(0x21a)](),_0x517179=_0x5de125[_0x4e4df3(0x1a7)]?.[_0x4e4df3(0x212)],_0x163d3b=_0x5de125[_0x4e4df3(0x1a7)]?.[_0x4e4df3(0x1b9)],_0x4e05f6=_0x5de125[_0x4e4df3(0x1a7)]?.['last_name'];if(!_0x312976)return;try{let _0xacc390=await database_1['default'][_0x4e4df3(0x1a3)][_0x4e4df3(0x1f0)]({'where':{'telegramId':_0x312976},'include':{'shop':!![]}});!_0xacc390?(_0xacc390=await database_1[_0x4e4df3(0x14a)]['telegramUser'][_0x4e4df3(0x20c)]({'data':{'telegramId':_0x312976,'username':_0x517179,'firstName':_0x163d3b,'lastName':_0x4e05f6,'isVerified':![],'shopId':null},'include':{'shop':!![]}}),console[_0x4e4df3(0x192)](_0x4e4df3(0x1c9)+_0x312976+_0x4e4df3(0x14d)+_0x517179+')')):_0xacc390=await database_1['default']['telegramUser'][_0x4e4df3(0x1ee)]({'where':{'telegramId':_0x312976},'data':{'username':_0x517179,'firstName':_0x163d3b,'lastName':_0x4e05f6},'include':{'shop':!![]}}),_0xacc390['isVerified']&&_0xacc390['shopId']&&_0xacc390[_0x4e4df3(0x15d)]?await this['bot']?.['sendMessage'](_0x41d842,_0x4e4df3(0x144)+(_0x4e4df3(0x1ad)+_0xacc390['shop'][_0x4e4df3(0x1d8)]+'*\x0a')+('Username:\x20`'+_0xacc390[_0x4e4df3(0x15d)][_0x4e4df3(0x212)]+_0x4e4df3(0x1f5))+_0x4e4df3(0x159)+_0x4e4df3(0x217)+_0x4e4df3(0x187)+_0x4e4df3(0x1ce)+_0x4e4df3(0x198)+_0x4e4df3(0x1ff)+_0x4e4df3(0x174),{'parse_mode':'Markdown'}):(_0xacc390['shopId']&&!_0xacc390[_0x4e4df3(0x1f2)]&&(await database_1[_0x4e4df3(0x14a)]['telegramUser'][_0x4e4df3(0x1ee)]({'where':{'telegramId':_0x312976},'data':{'shopId':null,'isVerified':![]}}),console['log']('🔄\x20Reset\x20incomplete\x20verification\x20for\x20user\x20'+_0x312976)),await this[_0x4e4df3(0x204)]?.[_0x4e4df3(0x1cb)](_0x41d842,'🤖\x20Welcome\x20to\x20TRAPAY\x20notification\x20system!\x0a\x0a'+_0x4e4df3(0x16e)+_0x4e4df3(0x184)+_0x4e4df3(0x17d)+_0x4e4df3(0x1cd)+_0x4e4df3(0x164),{'parse_mode':_0x4e4df3(0x160)}));}catch(_0x3958ac){console['error'](_0x4e4df3(0x219),_0x3958ac),await this[_0x4e4df3(0x204)]?.[_0x4e4df3(0x1cb)](_0x41d842,_0x4e4df3(0x216));}}),this[_0x37c68f(0x204)][_0x37c68f(0x1a2)](/\/disconnect/,async _0x202c7b=>{const _0x105c85=_0x37c68f,_0x184755=_0x202c7b[_0x105c85(0x179)]['id'],_0x324b97=_0x202c7b[_0x105c85(0x1a7)]?.['id']['toString']();if(!_0x324b97)return;try{const _0x1043c5=await database_1[_0x105c85(0x14a)]['telegramUser']['findUnique']({'where':{'telegramId':_0x324b97},'include':{'shop':!![]}});if(!_0x1043c5||!_0x1043c5[_0x105c85(0x1f2)]||!_0x1043c5[_0x105c85(0x143)]){await this[_0x105c85(0x204)]?.[_0x105c85(0x1cb)](_0x184755,_0x105c85(0x1a9));return;}const _0x21b85e=_0x1043c5['shop']?.[_0x105c85(0x1d8)]||_0x105c85(0x19b);await database_1[_0x105c85(0x14a)][_0x105c85(0x1a3)][_0x105c85(0x1ee)]({'where':{'telegramId':_0x324b97},'data':{'shopId':null,'isVerified':![]}}),console['log'](_0x105c85(0x145)+_0x324b97+_0x105c85(0x20d)+_0x1043c5[_0x105c85(0x143)]),await this[_0x105c85(0x204)]?.['sendMessage'](_0x184755,'✅\x20You\x20have\x20been\x20successfully\x20disconnected\x20from\x20shop\x20*'+_0x21b85e+_0x105c85(0x1ae)+_0x105c85(0x214),{'parse_mode':_0x105c85(0x160)});}catch(_0x14fccc){console[_0x105c85(0x1d5)](_0x105c85(0x18e),_0x14fccc),await this[_0x105c85(0x204)]?.[_0x105c85(0x1cb)](_0x184755,_0x105c85(0x216));}}),this[_0x37c68f(0x204)][_0x37c68f(0x1a2)](/\/status/,async _0x5a42bb=>{const _0x267b7a=_0x37c68f,_0x5154a7=_0x5a42bb[_0x267b7a(0x179)]['id'],_0x940d7f=_0x5a42bb[_0x267b7a(0x1a7)]?.['id']['toString']();if(!_0x940d7f)return;try{const _0xeb2a0=await database_1['default'][_0x267b7a(0x1a3)][_0x267b7a(0x1f0)]({'where':{'telegramId':_0x940d7f},'include':{'shop':!![]}});if(!_0xeb2a0){await this['bot']?.[_0x267b7a(0x1cb)](_0x5154a7,'❌\x20You\x20are\x20not\x20registered\x20in\x20the\x20system.\x0a\x0a'+_0x267b7a(0x177));return;}if(!_0xeb2a0[_0x267b7a(0x1f2)]||!_0xeb2a0[_0x267b7a(0x143)]||!_0xeb2a0[_0x267b7a(0x15d)]){await this[_0x267b7a(0x204)]?.[_0x267b7a(0x1cb)](_0x5154a7,_0x267b7a(0x1e3)+_0x267b7a(0x186));return;}await this[_0x267b7a(0x204)]?.[_0x267b7a(0x1cb)](_0x5154a7,_0x267b7a(0x14c)+(_0x267b7a(0x1c0)+_0xeb2a0[_0x267b7a(0x15d)][_0x267b7a(0x1d8)]+'*\x0a')+(_0x267b7a(0x151)+_0xeb2a0[_0x267b7a(0x15d)][_0x267b7a(0x212)]+'`\x0a')+('📅\x20Connection\x20date:\x20'+_0xeb2a0[_0x267b7a(0x1f4)]['toLocaleDateString'](_0x267b7a(0x209))+'\x0a\x0a')+'🔔\x20Notifications\x20are\x20active\x0a\x0a'+'Commands:\x0a'+_0x267b7a(0x174),{'parse_mode':_0x267b7a(0x160)});}catch(_0x258631){console[_0x267b7a(0x1d5)](_0x267b7a(0x153),_0x258631),await this['bot']?.[_0x267b7a(0x1cb)](_0x5154a7,_0x267b7a(0x216));}}),this[_0x37c68f(0x204)][_0x37c68f(0x1a2)](/\/debug/,async _0x58599a=>{const _0x393b67=_0x37c68f,_0x38b1e4=_0x58599a[_0x393b67(0x179)]['id'],_0x416585=_0x58599a[_0x393b67(0x1a7)]?.['id'][_0x393b67(0x21a)]();if(!_0x416585)return;try{const _0x55d7ec=await database_1[_0x393b67(0x14a)]['shop'][_0x393b67(0x166)]({'select':{'id':!![],'name':!![],'username':!![],'status':!![],'publicKey':!![]},'take':0xa});let _0xf05d03='🔍\x20*Debug\x20Information*\x0a\x0a';_0xf05d03+=_0x393b67(0x142)+_0x416585+_0x393b67(0x1f5),_0xf05d03+=_0x393b67(0x20e),_0x55d7ec[_0x393b67(0x148)]((_0x2c2e58,_0x110e57)=>{const _0x180fc3=_0x393b67;_0xf05d03+=_0x110e57+0x1+_0x180fc3(0x19d)+_0x2c2e58[_0x180fc3(0x1d8)]+'*\x0a',_0xf05d03+=_0x180fc3(0x1bb)+_0x2c2e58['username']+'`\x0a',_0xf05d03+=_0x180fc3(0x155)+_0x2c2e58[_0x180fc3(0x16c)]+'\x0a',_0xf05d03+=_0x180fc3(0x1ca)+_0x2c2e58[_0x180fc3(0x1fd)][_0x180fc3(0x21f)](0x0,0xf)+_0x180fc3(0x162);}),await this[_0x393b67(0x204)]?.['sendMessage'](_0x38b1e4,_0xf05d03,{'parse_mode':'Markdown'});}catch(_0x55214e){console[_0x393b67(0x1d5)]('Error\x20handling\x20/debug\x20command:',_0x55214e),await this[_0x393b67(0x204)]?.[_0x393b67(0x1cb)](_0x38b1e4,_0x393b67(0x201));}}),this[_0x37c68f(0x204)]['on'](_0x37c68f(0x1bf),async _0x4f927b=>{const _0x772641=_0x37c68f;if(_0x4f927b[_0x772641(0x18a)]?.[_0x772641(0x1b1)]('/'))return;const _0x4455b4=_0x4f927b['chat']['id'],_0x52c2c5=_0x4f927b['from']?.['id'][_0x772641(0x21a)](),_0x331a1b=_0x4f927b[_0x772641(0x18a)]?.['trim']();if(!_0x52c2c5||!_0x331a1b)return;try{const _0x111102=await database_1[_0x772641(0x14a)][_0x772641(0x1a3)][_0x772641(0x1f0)]({'where':{'telegramId':_0x52c2c5},'include':{'shop':!![]}});if(!_0x111102){await this[_0x772641(0x204)]?.[_0x772641(0x1cb)](_0x4455b4,'❌\x20Please\x20use\x20/start\x20command\x20first');return;}if(_0x111102['isVerified']&&_0x111102['shopId']&&_0x111102[_0x772641(0x15d)]){await this[_0x772641(0x204)]?.[_0x772641(0x1cb)](_0x4455b4,'✅\x20You\x20are\x20already\x20connected\x20to\x20shop\x20*'+_0x111102[_0x772641(0x15d)][_0x772641(0x1d8)]+_0x772641(0x1ae)+'Use\x20/status\x20to\x20check\x20status\x20or\x20/disconnect\x20to\x20disconnect.',{'parse_mode':'Markdown'});return;}const _0xf97bdf=_0x331a1b['split'](/\s+/);if(_0xf97bdf['length']!==0x2){await this[_0x772641(0x204)]?.[_0x772641(0x1cb)](_0x4455b4,'❌\x20Invalid\x20format.\x20Please\x20send\x20exactly\x202\x20parts\x20separated\x20by\x20space:\x0a\x0a'+'📝\x20Format:\x20`username\x20api_key`\x0a\x0a'+_0x772641(0x17d)+_0x772641(0x1cd)+(_0x772641(0x1d9)+_0xf97bdf[_0x772641(0x1ba)]+_0x772641(0x1f6)+_0xf97bdf[_0x772641(0x21e)](_0x2c012a=>'`'+_0x2c012a+'`')[_0x772641(0x1be)](',\x20')),{'parse_mode':_0x772641(0x160)});return;}const [_0x365c77,_0x5572aa]=_0xf97bdf;console[_0x772641(0x192)](_0x772641(0x1da)+_0x52c2c5+':\x20username=\x22'+_0x365c77+'\x22,\x20apiKey=\x22'+_0x5572aa[_0x772641(0x21f)](0x0,0xa)+_0x772641(0x1e9)),await this[_0x772641(0x20f)](_0x4455b4,_0x52c2c5,_0x365c77,_0x5572aa);}catch(_0x30f435){console[_0x772641(0x1d5)](_0x772641(0x1fb),_0x30f435),await this[_0x772641(0x204)]?.[_0x772641(0x1cb)](_0x4455b4,_0x772641(0x216));}}),this[_0x37c68f(0x204)]['on'](_0x37c68f(0x1d5),_0x20f734=>{const _0x4a497f=_0x37c68f;console[_0x4a497f(0x1d5)](_0x4a497f(0x189),_0x20f734);}),this[_0x37c68f(0x204)]['on'](_0x37c68f(0x1a0),_0x902a09=>{const _0x11d8c1=_0x37c68f;console['error'](_0x11d8c1(0x191),_0x902a09);});}async['handleSingleLineVerification'](_0x557f0b,_0x5e12ab,_0x279be7,_0xc9bf11){const _0x25f72a=a54_0x4f8bbe;try{console[_0x25f72a(0x192)](_0x25f72a(0x1da)+_0x5e12ab+_0x25f72a(0x196)+_0x279be7+'\x22,\x20apiKey=\x22'+_0xc9bf11[_0x25f72a(0x21f)](0x0,0xa)+_0x25f72a(0x1e9));if(!_0x279be7||_0x279be7[_0x25f72a(0x1ba)]<0x3||_0x279be7[_0x25f72a(0x1ba)]>0x32||!/^[a-zA-Z0-9_]+$/[_0x25f72a(0x1a1)](_0x279be7)){await this['bot']?.[_0x25f72a(0x1cb)](_0x557f0b,_0x25f72a(0x150)+_0x279be7+_0x25f72a(0x1f5)+_0x25f72a(0x19e),{'parse_mode':_0x25f72a(0x160)});return;}if(!_0xc9bf11||!_0xc9bf11['startsWith'](_0x25f72a(0x15b))&&!_0xc9bf11['startsWith']('sk_')){await this[_0x25f72a(0x204)]?.[_0x25f72a(0x1cb)](_0x557f0b,_0x25f72a(0x15a)+_0x25f72a(0x18d),{'parse_mode':'Markdown'});return;}const _0x20dd19=await database_1['default'][_0x25f72a(0x15d)][_0x25f72a(0x1f0)]({'where':{'username':_0x279be7},'select':{'id':!![],'name':!![],'username':!![],'status':!![],'publicKey':!![],'secretKey':!![]}});if(!_0x20dd19){const _0x5dbbd1=await database_1['default'][_0x25f72a(0x15d)][_0x25f72a(0x166)]({'select':{'username':!![],'name':!![]},'take':0x5});let _0x34625a=_0x25f72a(0x1e5)+_0x279be7+_0x25f72a(0x1b5);_0x5dbbd1[_0x25f72a(0x1ba)]>0x0?(_0x34625a+='Available\x20usernames:\x0a',_0x5dbbd1[_0x25f72a(0x148)](_0x4d4cb5=>{const _0x1221b9=_0x25f72a;_0x34625a+=_0x1221b9(0x208)+_0x4d4cb5['username']+_0x1221b9(0x1b4)+_0x4d4cb5['name']+')\x0a';}),_0x34625a+='\x0aCheck\x20spelling\x20and\x20try\x20again.'):_0x34625a+=_0x25f72a(0x1eb);await this['bot']?.[_0x25f72a(0x1cb)](_0x557f0b,_0x34625a,{'parse_mode':_0x25f72a(0x160)});return;}if(_0x20dd19[_0x25f72a(0x16c)]!==_0x25f72a(0x18c)){await this[_0x25f72a(0x204)]?.[_0x25f72a(0x1cb)](_0x557f0b,_0x25f72a(0x215)+_0x279be7+_0x25f72a(0x193)+_0x25f72a(0x1ea),{'parse_mode':'Markdown'});return;}if(_0x20dd19[_0x25f72a(0x1fd)]!==_0xc9bf11&&_0x20dd19[_0x25f72a(0x141)]!==_0xc9bf11){await this[_0x25f72a(0x204)]?.[_0x25f72a(0x1cb)](_0x557f0b,'❌\x20API\x20key\x20does\x20not\x20match\x20shop\x20`'+_0x279be7+_0x25f72a(0x20b)+'Check\x20the\x20key\x20and\x20try\x20again.\x0a\x0a'+'Expected\x20key\x20format:\x20`pk_...`\x20or\x20`sk_...`',{'parse_mode':'Markdown'});return;}const _0x4ff671=await database_1['default']['telegramUser'][_0x25f72a(0x154)]({'where':{'shopId':_0x20dd19['id'],'isVerified':!![],'telegramId':{'not':_0x5e12ab}}});if(_0x4ff671){await this[_0x25f72a(0x204)]?.['sendMessage'](_0x557f0b,_0x25f72a(0x20a)+_0x279be7+_0x25f72a(0x20b)+'Disconnect\x20the\x20previous\x20account\x20first\x20or\x20contact\x20administrator.',{'parse_mode':'Markdown'});return;}await database_1[_0x25f72a(0x14a)][_0x25f72a(0x1a3)][_0x25f72a(0x1ee)]({'where':{'telegramId':_0x5e12ab},'data':{'shopId':_0x20dd19['id'],'isVerified':!![]}}),await this[_0x25f72a(0x204)]?.['sendMessage'](_0x557f0b,_0x25f72a(0x1bd)+_0x25f72a(0x14b)+('📱\x20Shop:\x20*'+_0x20dd19[_0x25f72a(0x1d8)]+'*\x0a')+('👤\x20Username:\x20`'+_0x20dd19['username']+_0x25f72a(0x1f5))+'🔔\x20You\x20will\x20now\x20receive\x20notifications\x20about:\x0a'+_0x25f72a(0x217)+_0x25f72a(0x187)+_0x25f72a(0x1c4)+_0x25f72a(0x1c6)+_0x25f72a(0x198)+'/status\x20-\x20check\x20connection\x20status\x0a'+_0x25f72a(0x174),{'parse_mode':'Markdown'}),console[_0x25f72a(0x192)](_0x25f72a(0x188)+_0x5e12ab+_0x25f72a(0x19f)+_0x20dd19[_0x25f72a(0x212)]+_0x25f72a(0x1d1));}catch(_0x3e1352){console['error'](_0x25f72a(0x1b8),_0x3e1352),await this['bot']?.[_0x25f72a(0x1cb)](_0x557f0b,_0x25f72a(0x1fa));}}async['sendShopNotification'](_0xade7f3,_0x5a40d2,_0x3bc46b){const _0x2414e=a54_0x4f8bbe;if(!this[_0x2414e(0x204)]){console[_0x2414e(0x1de)]('Telegram\x20bot\x20not\x20initialized,\x20cannot\x20send\x20notification');return;}try{const _0x57a000=await database_1[_0x2414e(0x14a)][_0x2414e(0x1a3)][_0x2414e(0x166)]({'where':{'shopId':_0xade7f3,'isVerified':!![]}});if(_0x57a000['length']===0x0){console[_0x2414e(0x192)](_0x2414e(0x190)+_0xade7f3);return;}const _0x5eb948=_0x57a000[_0x2414e(0x21e)](async _0x4e9ebf=>{const _0x3ad458=_0x2414e;try{await this[_0x3ad458(0x204)]?.[_0x3ad458(0x1cb)](_0x4e9ebf[_0x3ad458(0x1c8)],_0x5a40d2,_0x3bc46b),console['log'](_0x3ad458(0x156)+_0x4e9ebf[_0x3ad458(0x1c8)]);}catch(_0x322632){console['error'](_0x3ad458(0x207)+_0x4e9ebf[_0x3ad458(0x1c8)]+':',_0x322632),_0x322632 instanceof Error&&(_0x322632[_0x3ad458(0x1bf)][_0x3ad458(0x218)]('blocked')||_0x322632[_0x3ad458(0x1bf)]['includes'](_0x3ad458(0x158))||_0x322632[_0x3ad458(0x1bf)]['includes'](_0x3ad458(0x1f8)))&&(await database_1[_0x3ad458(0x14a)]['telegramUser'][_0x3ad458(0x1ee)]({'where':{'id':_0x4e9ebf['id']},'data':{'isVerified':![]}}),console[_0x3ad458(0x192)](_0x3ad458(0x1c2)+_0x4e9ebf['telegramId']+_0x3ad458(0x178)));}});await Promise[_0x2414e(0x1c1)](_0x5eb948);}catch(_0x27e7d5){console[_0x2414e(0x1d5)](_0x2414e(0x1dc),_0x27e7d5);}}async[a54_0x4f8bbe(0x183)](_0x27f05d,_0x385970,_0x5a5c9a){const _0x4207cc=a54_0x4f8bbe,_0x2ae025={'created':'🆕','paid':'✅','failed':'❌','expired':'⏰','refund':'🔄','chargeback':'⚠️','processing':'⚙️'},_0x23b444={'created':_0x4207cc(0x1db),'paid':_0x4207cc(0x199),'failed':'Payment\x20failed','expired':_0x4207cc(0x21b),'refund':_0x4207cc(0x181),'chargeback':'Payment\x20chargeback','processing':_0x4207cc(0x161)},_0x51b963=_0x2ae025[_0x5a5c9a],_0x218a6c=_0x23b444[_0x5a5c9a],_0x5cc2ef=(0x0,gateway_1[_0x4207cc(0x1d0)])(_0x385970[_0x4207cc(0x1d2)]);console['log']('📱\x20Telegram\x20notification:\x20gateway\x20\x22'+_0x385970[_0x4207cc(0x1d2)]+_0x4207cc(0x1bc)+_0x5cc2ef+'\x22');let _0x4f46f9=_0x51b963+'\x20*'+_0x218a6c+_0x4207cc(0x173)+(_0x4207cc(0x213)+_0x385970[_0x4207cc(0x16a)]+'\x20'+_0x385970[_0x4207cc(0x206)]+'*\x0a')+(_0x4207cc(0x211)+(_0x385970['orderId']||_0x385970['id'])+'`\x0a')+('🆔\x20Payment\x20ID:\x20`'+_0x385970['id']+'`\x0a')+('🏪\x20Gateway:\x20`'+_0x5cc2ef+'`\x0a')+(_0x4207cc(0x1e7)+new Date(_0x385970[_0x4207cc(0x17b)])[_0x4207cc(0x1fc)](_0x4207cc(0x209))+'\x0a');(_0x385970['customerName']||_0x385970[_0x4207cc(0x16b)])&&(_0x4f46f9+='\x0a👤\x20*Customer\x20Information:*\x0a',_0x385970[_0x4207cc(0x205)]&&(_0x4f46f9+=_0x4207cc(0x1e6)+_0x385970['customerName']+'`\x0a'),_0x385970['customerEmail']&&(_0x4f46f9+=_0x4207cc(0x1a4)+_0x385970[_0x4207cc(0x16b)]+'`\x0a')),_0x5a5c9a===_0x4207cc(0x194)&&_0x385970[_0x4207cc(0x172)]&&(_0x4f46f9+='💸\x20Penalty\x20amount:\x20*'+_0x385970[_0x4207cc(0x172)]+_0x4207cc(0x17e)),_0x5a5c9a==='processing'&&(_0x4f46f9+=_0x4207cc(0x1e4)),_0x385970[_0x4207cc(0x1f9)]&&(_0x4f46f9+='📝\x20Notes:\x20'+_0x385970[_0x4207cc(0x1f9)]+'\x0a'),await this[_0x4207cc(0x16d)](_0x27f05d,_0x4f46f9,{'parse_mode':_0x4207cc(0x160)});}async[a54_0x4f8bbe(0x15c)](_0xecfeca,_0x4317e4,_0x4a55e7){const _0x3a9663=a54_0x4f8bbe,_0x5a0629={'created':'📤','completed':'✅','rejected':'❌'},_0x270c1b={'created':_0x3a9663(0x185),'completed':_0x3a9663(0x195),'rejected':_0x3a9663(0x16f)},_0x42e3d8=_0x5a0629[_0x4a55e7],_0x57ba84=_0x270c1b[_0x4a55e7],_0x4da789=_0x42e3d8+'\x20*'+_0x57ba84+_0x3a9663(0x173)+(_0x3a9663(0x1a6)+_0x4317e4[_0x3a9663(0x16a)]+_0x3a9663(0x1b2))+(_0x3a9663(0x1e8)+_0x4317e4[_0x3a9663(0x1b3)]+'`\x0a')+(_0x3a9663(0x175)+_0x4317e4['id']+'`\x0a')+(_0x3a9663(0x1e7)+new Date(_0x4317e4['createdAt'])[_0x3a9663(0x1fc)](_0x3a9663(0x209))+'\x0a')+(_0x4317e4[_0x3a9663(0x1e0)]?_0x3a9663(0x171)+_0x4317e4['txid']+'`':'');await this[_0x3a9663(0x16d)](_0xecfeca,_0x4da789,{'parse_mode':'Markdown'});}async[a54_0x4f8bbe(0x202)](_0x44c9b2,_0x5c11cc){const _0x19a4d7=a54_0x4f8bbe;try{const _0x528baf=await database_1[_0x19a4d7(0x14a)][_0x19a4d7(0x203)][_0x19a4d7(0x1f0)]({'where':{'shopId':_0x44c9b2},'select':{'notificationLogin':!![]}});if(!_0x528baf?.[_0x19a4d7(0x1af)]){console[_0x19a4d7(0x192)](_0x19a4d7(0x1c7)+_0x44c9b2);return;}const _0x19a0bf=_0x5c11cc[_0x19a4d7(0x1df)]?'🔐':'🚨',_0x381622=_0x5c11cc[_0x19a4d7(0x1df)]?_0x19a4d7(0x1ac):_0x19a4d7(0x21c);let _0x4d0f4b=_0x19a0bf+'\x20*'+_0x381622+'*\x0a\x0a'+(_0x19a4d7(0x151)+_0x5c11cc[_0x19a4d7(0x212)]+'`\x0a')+(_0x19a4d7(0x1f1)+_0x5c11cc['timestamp'][_0x19a4d7(0x1fc)](_0x19a4d7(0x209))+'\x0a');_0x5c11cc[_0x19a4d7(0x140)]&&(_0x4d0f4b+=_0x19a4d7(0x169)+_0x5c11cc['ipAddress']+'`\x0a');if(_0x5c11cc['userAgent']){const _0x2935bf=_0x5c11cc[_0x19a4d7(0x149)]['length']>0x32?_0x5c11cc[_0x19a4d7(0x149)]['substring'](0x0,0x32)+_0x19a4d7(0x19c):_0x5c11cc['userAgent'];_0x4d0f4b+='💻\x20Browser:\x20`'+_0x2935bf+'`\x0a';}!_0x5c11cc[_0x19a4d7(0x1df)]&&(_0x4d0f4b+=_0x19a4d7(0x1b7)),await this[_0x19a4d7(0x16d)](_0x44c9b2,_0x4d0f4b,{'parse_mode':_0x19a4d7(0x160)}),console[_0x19a4d7(0x192)](_0x19a4d7(0x1ed)+_0x44c9b2+':\x20'+(_0x5c11cc[_0x19a4d7(0x1df)]?_0x19a4d7(0x1df):'failed'));}catch(_0x2d526e){console[_0x19a4d7(0x1d5)](_0x19a4d7(0x15f),_0x2d526e);}}async['sendApiErrorNotification'](_0x59a95f,_0x70c76e){const _0x39fb36=a54_0x4f8bbe;try{const _0x3cd102=await database_1[_0x39fb36(0x14a)]['shopSettings'][_0x39fb36(0x1f0)]({'where':{'shopId':_0x59a95f},'select':{'notificationApiError':!![]}});if(!_0x3cd102?.['notificationApiError']){console[_0x39fb36(0x192)]('📱\x20API\x20error\x20notifications\x20disabled\x20for\x20shop\x20'+_0x59a95f);return;}let _0x50d7d7='🚨\x20*API\x20Error*\x0a\x0a'+(_0x39fb36(0x167)+_0x70c76e[_0x39fb36(0x1b3)]+'\x20'+_0x70c76e['endpoint']+'`\x0a')+(_0x39fb36(0x1f1)+_0x70c76e['timestamp']['toLocaleString'](_0x39fb36(0x209))+'\x0a');_0x70c76e['statusCode']&&(_0x50d7d7+=_0x39fb36(0x1f3)+_0x70c76e[_0x39fb36(0x1a5)]+'`\x0a'),_0x50d7d7+=_0x39fb36(0x1c5)+_0x70c76e[_0x39fb36(0x17a)]+'`\x0a',_0x70c76e[_0x39fb36(0x1d7)]&&(_0x50d7d7+='🆔\x20Request\x20ID:\x20`'+_0x70c76e['requestId']+'`\x0a'),_0x50d7d7+='\x0a💡\x20Check\x20your\x20request\x20or\x20contact\x20support.',await this['sendShopNotification'](_0x59a95f,_0x50d7d7,{'parse_mode':'Markdown'}),console[_0x39fb36(0x192)](_0x39fb36(0x1b6)+_0x59a95f+':\x20'+_0x70c76e[_0x39fb36(0x180)]);}catch(_0x261cbe){console[_0x39fb36(0x1d5)](_0x39fb36(0x21d),_0x261cbe);}}async[a54_0x4f8bbe(0x182)](_0x2207b8,_0x2e3094,_0x1af670){const _0x506265=a54_0x4f8bbe;let _0x4d338f=_0x506265(0x1e2)+_0x2e3094+_0x506265(0x173);for(const [_0xd916c9,_0xca0bb4]of Object['entries'](_0x1af670)){_0xca0bb4!==null&&_0xca0bb4!==undefined&&(_0x4d338f+=_0xd916c9+_0x506265(0x1cc)+_0xca0bb4+'`\x0a');}await this[_0x506265(0x16d)](_0x2207b8,_0x4d338f,{'parse_mode':'Markdown'});}[a54_0x4f8bbe(0x1b0)](){const _0x23de53=a54_0x4f8bbe;return{'isActive':!!this[_0x23de53(0x204)],'username':this['botUsername']};}[a54_0x4f8bbe(0x17f)](){const _0x21a380=a54_0x4f8bbe;this['bot']&&(this['bot'][_0x21a380(0x165)](),this[_0x21a380(0x204)]=null,console[_0x21a380(0x192)](_0x21a380(0x1aa)));}}exports[a54_0x4f8bbe(0x17c)]=TelegramBotService,exports[a54_0x4f8bbe(0x1c3)]=new TelegramBotService();function a54_0x4da2(_0x31419b,_0x216840){const _0x3e954e=a54_0x3e95();return a54_0x4da2=function(_0x4da2bf,_0x228294){_0x4da2bf=_0x4da2bf-0x140;let _0x35bf80=_0x3e954e[_0x4da2bf];return _0x35bf80;},a54_0x4da2(_0x31419b,_0x216840);}function a54_0x3e95(){const _0x40b2ae=['sendCustomNotification','sendPaymentNotification','📝\x20Format:\x20`username\x20api_key`\x0a\x0a','New\x20payout\x20created','Use\x20/start\x20to\x20connect.','•\x20Payment\x20status\x20changes\x0a','✅\x20Telegram\x20user\x20','Telegram\x20bot\x20error:','text','TELEGRAM_BOT_TOKEN\x20not\x20found\x20in\x20environment\x20variables','ACTIVE','API\x20key\x20must\x20start\x20with\x20`pk\x5c_`\x20or\x20`sk\x5c_`.','Error\x20handling\x20/disconnect\x20command:','../config/database','No\x20verified\x20Telegram\x20users\x20found\x20for\x20shop\x20','Telegram\x20bot\x20polling\x20error:','log','`\x20is\x20inactive.\x0a\x0a','chargeback','Payout\x20completed',':\x20username=\x22','3717040IdavNh','Commands:\x0a','Payment\x20successfully\x20paid','7yFdSTq','unknown\x20shop','...','.\x20*','Username\x20must\x20contain\x20only\x20letters,\x20numbers\x20and\x20underscore\x20(3-50\x20characters).','\x20verified\x20for\x20shop\x20','polling_error','test','onText','telegramUser','📧\x20Email:\x20`','statusCode','💸\x20Amount:\x20*','from','3ZFEIaj','❌\x20You\x20are\x20not\x20connected\x20to\x20the\x20notification\x20system.','🛑\x20Telegram\x20bot\x20stopped','TELEGRAM_BOT_TOKEN','Successful\x20login','You\x20are\x20already\x20connected\x20to\x20shop:\x20*','*.\x0a\x0a','notificationLogin','getBotInfo','startsWith','\x20USD*\x0a','method','`\x20(','`\x20not\x20found.\x0a\x0a','✅\x20API\x20error\x20notification\x20sent\x20for\x20shop\x20','\x0a⚠️\x20If\x20this\x20wasn\x27t\x20you,\x20change\x20your\x20password\x20immediately!','Error\x20in\x20handleSingleLineVerification:','first_name','length','\x20\x20\x20Username:\x20`','\x22\x20->\x20display\x20\x22','🎉\x20*Congratulations!*\x0a\x0a','join','message','✅\x20Connected\x20to\x20shop:\x20*','allSettled','User\x20','telegramBotService','•\x20Payouts\x0a','❌\x20Error:\x20`','•\x20Important\x20events\x0a\x0a','📱\x20Login\x20notifications\x20disabled\x20for\x20shop\x20','telegramId','📱\x20Created\x20new\x20Telegram\x20user:\x20','\x20\x20\x20Public\x20Key:\x20`','sendMessage',':\x20`','`appple\x20pk_aa6450d3f57afbefbb0f3f5be5ce6cca13037536afc5ccf14c81a6cbc7a07de5`\x0a\x0a','•\x20Payouts\x0a\x0a','initializeBot','getGatewayDisplayNameForTelegram','\x20via\x20single-line\x20input','gateway','../types/gateway','5764924NbIFQz','error','__importDefault','requestId','name','You\x20sent\x20','🔄\x20Processing\x20single-line\x20verification\x20for\x20user\x20','New\x20payment\x20created','Error\x20sending\x20shop\x20notification:','botUsername','warn','success','txid','❌\x20Failed\x20to\x20initialize\x20Telegram\x20bot:','🔔\x20*','❌\x20You\x20are\x20not\x20connected\x20to\x20a\x20shop.\x0a\x0a','⏳\x20The\x20payment\x20is\x20currently\x20being\x20processed\x20by\x20the\x20gateway.\x0a','❌\x20Shop\x20with\x20username\x20`','📛\x20Name:\x20`','📅\x20Date:\x20','🏦\x20Method:\x20`','...\x22','Contact\x20administrator.','Check\x20spelling\x20and\x20try\x20again.','765688Hnmpcb','✅\x20Login\x20notification\x20sent\x20for\x20shop\x20','update','✅\x20Telegram\x20bot\x20@','findUnique','📅\x20Time:\x20','isVerified','📊\x20Error\x20code:\x20`','updatedAt','`\x0a\x0a','\x20parts:\x20','TELEGRAM_BOT_USERNAME','user\x20is\x20deactivated','adminNotes','❌\x20An\x20error\x20occurred\x20while\x20verifying\x20data.','Error\x20handling\x20message:','toLocaleString','publicKey','322054pBJUzx','/status\x20-\x20check\x20connection\x20status\x0a','88OjigwU','❌\x20Error\x20getting\x20debug\x20information.','sendLoginNotification','shopSettings','bot','customerName','currency','❌\x20Failed\x20to\x20send\x20notification\x20to\x20Telegram\x20user\x20','•\x20`','en-US','❌\x20Another\x20Telegram\x20account\x20is\x20already\x20connected\x20to\x20shop\x20`','`.\x0a\x0a','create','\x20disconnected\x20from\x20shop\x20','🏪\x20Available\x20shops\x20in\x20system:\x0a','handleSingleLineVerification','453717VHliPo','📝\x20Order\x20ID:\x20`','username','💰\x20Amount:\x20*','To\x20reconnect,\x20use\x20the\x20/start\x20command','❌\x20Shop\x20`','❌\x20An\x20error\x20occurred.\x20Please\x20try\x20again\x20later.','•\x20New\x20payments\x0a','includes','Error\x20handling\x20/start\x20command:','toString','Payment\x20expired','Failed\x20login\x20attempt','Failed\x20to\x20send\x20API\x20error\x20notification:','map','substring','ipAddress','secretKey','📱\x20Your\x20Telegram\x20ID:\x20`','shopId','✅\x20Welcome\x20back!\x0a\x0a','🔌\x20User\x20','__esModule','setupBotHandlers','forEach','userAgent','default','✅\x20You\x20have\x20been\x20successfully\x20connected\x20to\x20the\x20notification\x20system!\x0a\x0a','📊\x20*Connection\x20Status*\x0a\x0a','\x20(@','node-telegram-bot-api','859989gffzZa','❌\x20Invalid\x20username\x20format:\x20`','👤\x20Username:\x20`','defineProperty','Error\x20handling\x20/status\x20command:','findFirst','\x20\x20\x20Status:\x20','✅\x20Notification\x20sent\x20to\x20Telegram\x20user\x20','env','chat\x20not\x20found','🔔\x20You\x20receive\x20notifications\x20about:\x0a','❌\x20Invalid\x20API\x20key\x20format.\x0a\x0a','pk_','sendPayoutNotification','shop','12PWvKKL','Failed\x20to\x20send\x20login\x20notification:','Markdown','Payment\x20is\x20being\x20processed','...`\x0a\x0a','4649754WjOlIt','❗️\x20Make\x20sure\x20to\x20separate\x20username\x20and\x20API\x20key\x20with\x20a\x20space!','stopPolling','findMany','🔗\x20Endpoint:\x20`','botToken','🌐\x20IP\x20address:\x20`','amount','customerEmail','status','sendShopNotification','To\x20receive\x20payment\x20notifications,\x20send\x20your\x20credentials\x20in\x20one\x20line:\x0a\x0a','Payout\x20rejected','\x20initialized\x20successfully','🔗\x20TXID:\x20`','chargebackAmount','*\x0a\x0a','/disconnect\x20-\x20disconnect\x20from\x20notifications','🆔\x20Payout\x20ID:\x20`','5IKgGau','Use\x20/start\x20to\x20begin.','\x20marked\x20as\x20unverified\x20due\x20to\x20delivery\x20failure','chat','errorMessage','createdAt','TelegramBotService','Example:\x0a','\x20USDT*\x0a','stopBot','endpoint','Payment\x20refund'];a54_0x3e95=function(){return _0x40b2ae;};return a54_0x3e95();}