'use strict';const a66_0x4a6504=a66_0x6930;function a66_0x6930(_0x54e5ef,_0x3323ab){const _0x532503=a66_0x5325();return a66_0x6930=function(_0x69307a,_0x3b5758){_0x69307a=_0x69307a-0x125;let _0x3a439b=_0x532503[_0x69307a];return _0x3a439b;},a66_0x6930(_0x54e5ef,_0x3323ab);}(function(_0xadb3f2,_0x4f1cb4){const _0x363fea=a66_0x6930,_0x2d154b=_0xadb3f2();while(!![]){try{const _0xcf6730=parseInt(_0x363fea(0x157))/0x1*(-parseInt(_0x363fea(0x1ac))/0x2)+-parseInt(_0x363fea(0x176))/0x3+-parseInt(_0x363fea(0x19b))/0x4*(parseInt(_0x363fea(0x178))/0x5)+parseInt(_0x363fea(0x1bb))/0x6*(-parseInt(_0x363fea(0x186))/0x7)+-parseInt(_0x363fea(0x1aa))/0x8+parseInt(_0x363fea(0x16a))/0x9+-parseInt(_0x363fea(0x218))/0xa*(-parseInt(_0x363fea(0x161))/0xb);if(_0xcf6730===_0x4f1cb4)break;else _0x2d154b['push'](_0x2d154b['shift']());}catch(_0x33c7ee){_0x2d154b['push'](_0x2d154b['shift']());}}}(a66_0x5325,0xc2250));var __importDefault=this&&this['__importDefault']||function(_0x5438f8){const _0x4d8632=a66_0x6930;return _0x5438f8&&_0x5438f8[_0x4d8632(0x1b5)]?_0x5438f8:{'default':_0x5438f8};};Object[a66_0x4a6504(0x19f)](exports,a66_0x4a6504(0x1b5),{'value':!![]}),exports[a66_0x4a6504(0x1ae)]=exports[a66_0x4a6504(0x1d4)]=void 0x0;const node_telegram_bot_api_1=__importDefault(require(a66_0x4a6504(0x12b))),database_1=__importDefault(require(a66_0x4a6504(0x15f))),gateway_1=require(a66_0x4a6504(0x1cd));class TelegramBotService{constructor(){const _0x344ea6=a66_0x4a6504;this[_0x344ea6(0x1dc)]=null,this[_0x344ea6(0x194)]=process['env'][_0x344ea6(0x14d)]||'',this[_0x344ea6(0x216)]=process[_0x344ea6(0x1c4)][_0x344ea6(0x1a9)]||_0x344ea6(0x1e8),this[_0x344ea6(0x194)]?this[_0x344ea6(0x173)]():console[_0x344ea6(0x160)](_0x344ea6(0x16d));}[a66_0x4a6504(0x173)](){const _0x3b5e27=a66_0x4a6504;try{this[_0x3b5e27(0x1dc)]=new node_telegram_bot_api_1[(_0x3b5e27(0x19c))](this[_0x3b5e27(0x194)],{'polling':!![]}),this[_0x3b5e27(0x199)](),console[_0x3b5e27(0x165)](_0x3b5e27(0x14a)+this[_0x3b5e27(0x216)]+'\x20initialized\x20successfully');}catch(_0x22bcd4){console[_0x3b5e27(0x1b6)](_0x3b5e27(0x15a),_0x22bcd4);}}[a66_0x4a6504(0x199)](){const _0x3ffb98=a66_0x4a6504;if(!this[_0x3ffb98(0x1dc)])return;this[_0x3ffb98(0x1dc)][_0x3ffb98(0x15e)](/\/start/,async _0x56bdbb=>{const _0x27268f=_0x3ffb98,_0x59abd0=_0x56bdbb[_0x27268f(0x140)]['id'],_0x55cad3=_0x56bdbb['from']?.['id'][_0x27268f(0x1b8)](),_0x159ed6=_0x56bdbb[_0x27268f(0x18b)]?.[_0x27268f(0x193)],_0x481f93=_0x56bdbb[_0x27268f(0x18b)]?.['first_name'],_0x2e1f6c=_0x56bdbb[_0x27268f(0x18b)]?.[_0x27268f(0x1b2)];if(!_0x55cad3)return;try{let _0xfc69b2=await database_1[_0x27268f(0x19c)][_0x27268f(0x1bf)][_0x27268f(0x1f7)]({'where':{'telegramId':_0x55cad3},'include':{'shop':!![]}});!_0xfc69b2?(_0xfc69b2=await database_1[_0x27268f(0x19c)][_0x27268f(0x1bf)]['create']({'data':{'telegramId':_0x55cad3,'username':_0x159ed6,'firstName':_0x481f93,'lastName':_0x2e1f6c,'isVerified':![],'shopId':null},'include':{'shop':!![]}}),console[_0x27268f(0x165)](_0x27268f(0x1fb)+_0x55cad3+_0x27268f(0x175)+_0x159ed6+')')):_0xfc69b2=await database_1[_0x27268f(0x19c)][_0x27268f(0x1bf)]['update']({'where':{'telegramId':_0x55cad3},'data':{'username':_0x159ed6,'firstName':_0x481f93,'lastName':_0x2e1f6c},'include':{'shop':!![]}}),_0xfc69b2[_0x27268f(0x205)]&&_0xfc69b2['shopId']&&_0xfc69b2[_0x27268f(0x1e7)]?await this[_0x27268f(0x1dc)]?.[_0x27268f(0x1ef)](_0x59abd0,'✅\x20Welcome\x20back!\x0a\x0a'+(_0x27268f(0x155)+_0xfc69b2[_0x27268f(0x1e7)]['name']+'*\x0a')+(_0x27268f(0x1d6)+_0xfc69b2[_0x27268f(0x1e7)]['username']+'`\x0a\x0a')+_0x27268f(0x172)+_0x27268f(0x1c6)+_0x27268f(0x129)+'•\x20Payouts\x0a\x0a'+_0x27268f(0x16f)+_0x27268f(0x209)+_0x27268f(0x167),{'parse_mode':_0x27268f(0x215)}):(_0xfc69b2[_0x27268f(0x12f)]&&!_0xfc69b2[_0x27268f(0x205)]&&(await database_1[_0x27268f(0x19c)][_0x27268f(0x1bf)][_0x27268f(0x170)]({'where':{'telegramId':_0x55cad3},'data':{'shopId':null,'isVerified':![]}}),console[_0x27268f(0x165)](_0x27268f(0x127)+_0x55cad3)),await this['bot']?.[_0x27268f(0x1ef)](_0x59abd0,'🤖\x20Welcome\x20to\x20TRAPAY\x20notification\x20system!\x0a\x0a'+_0x27268f(0x12c)+_0x27268f(0x20b)+_0x27268f(0x1b9)+'`appple\x20pk_aa6450d3f57afbefbb0f3f5be5ce6cca13037536afc5ccf14c81a6cbc7a07de5`\x0a\x0a'+_0x27268f(0x1de),{'parse_mode':_0x27268f(0x215)}));}catch(_0xd0c7da){console[_0x27268f(0x1b6)]('Error\x20handling\x20/start\x20command:',_0xd0c7da),await this['bot']?.['sendMessage'](_0x59abd0,'❌\x20An\x20error\x20occurred.\x20Please\x20try\x20again\x20later.');}}),this['bot'][_0x3ffb98(0x15e)](/\/disconnect/,async _0x59594c=>{const _0x2a7a49=_0x3ffb98,_0x26915b=_0x59594c['chat']['id'],_0x42f269=_0x59594c[_0x2a7a49(0x18b)]?.['id'][_0x2a7a49(0x1b8)]();if(!_0x42f269)return;try{const _0x368763=await database_1[_0x2a7a49(0x19c)][_0x2a7a49(0x1bf)][_0x2a7a49(0x1f7)]({'where':{'telegramId':_0x42f269},'include':{'shop':!![]}});if(!_0x368763||!_0x368763[_0x2a7a49(0x205)]||!_0x368763[_0x2a7a49(0x12f)]){await this[_0x2a7a49(0x1dc)]?.['sendMessage'](_0x26915b,_0x2a7a49(0x181));return;}const _0xc3e465=_0x368763[_0x2a7a49(0x1e7)]?.['name']||_0x2a7a49(0x195);await database_1[_0x2a7a49(0x19c)]['telegramUser'][_0x2a7a49(0x170)]({'where':{'telegramId':_0x42f269},'data':{'shopId':null,'isVerified':![]}}),console['log']('🔌\x20User\x20'+_0x42f269+_0x2a7a49(0x1f0)+_0x368763['shopId']),await this[_0x2a7a49(0x1dc)]?.[_0x2a7a49(0x1ef)](_0x26915b,_0x2a7a49(0x164)+_0xc3e465+_0x2a7a49(0x1dd)+_0x2a7a49(0x156),{'parse_mode':'Markdown'});}catch(_0x4b4dfd){console[_0x2a7a49(0x1b6)](_0x2a7a49(0x203),_0x4b4dfd),await this['bot']?.[_0x2a7a49(0x1ef)](_0x26915b,_0x2a7a49(0x17c));}}),this[_0x3ffb98(0x1dc)][_0x3ffb98(0x15e)](/\/status/,async _0x981843=>{const _0x35d31b=_0x3ffb98,_0x10373d=_0x981843[_0x35d31b(0x140)]['id'],_0x57ecf3=_0x981843['from']?.['id'][_0x35d31b(0x1b8)]();if(!_0x57ecf3)return;try{const _0x1c3549=await database_1[_0x35d31b(0x19c)][_0x35d31b(0x1bf)]['findUnique']({'where':{'telegramId':_0x57ecf3},'include':{'shop':!![]}});if(!_0x1c3549){await this[_0x35d31b(0x1dc)]?.['sendMessage'](_0x10373d,_0x35d31b(0x1d0)+_0x35d31b(0x1c9));return;}if(!_0x1c3549[_0x35d31b(0x205)]||!_0x1c3549[_0x35d31b(0x12f)]||!_0x1c3549[_0x35d31b(0x1e7)]){await this[_0x35d31b(0x1dc)]?.[_0x35d31b(0x1ef)](_0x10373d,_0x35d31b(0x1a2)+_0x35d31b(0x19d));return;}await this[_0x35d31b(0x1dc)]?.[_0x35d31b(0x1ef)](_0x10373d,'📊\x20*Connection\x20Status*\x0a\x0a'+(_0x35d31b(0x185)+_0x1c3549[_0x35d31b(0x1e7)][_0x35d31b(0x179)]+'*\x0a')+(_0x35d31b(0x196)+_0x1c3549[_0x35d31b(0x1e7)][_0x35d31b(0x193)]+'`\x0a')+('📅\x20Connection\x20date:\x20'+_0x1c3549[_0x35d31b(0x128)][_0x35d31b(0x148)](_0x35d31b(0x1af))+'\x0a\x0a')+_0x35d31b(0x1ad)+_0x35d31b(0x16f)+'/disconnect\x20-\x20disconnect\x20from\x20notifications',{'parse_mode':_0x35d31b(0x215)});}catch(_0xf02982){console[_0x35d31b(0x1b6)]('Error\x20handling\x20/status\x20command:',_0xf02982),await this[_0x35d31b(0x1dc)]?.[_0x35d31b(0x1ef)](_0x10373d,_0x35d31b(0x17c));}}),this[_0x3ffb98(0x1dc)]['onText'](/\/debug/,async _0x4964d4=>{const _0x4286e7=_0x3ffb98,_0x4e5f25=_0x4964d4['chat']['id'],_0x1dfc77=_0x4964d4[_0x4286e7(0x18b)]?.['id']['toString']();if(!_0x1dfc77)return;try{const _0x4d8415=await database_1[_0x4286e7(0x19c)][_0x4286e7(0x1bf)][_0x4286e7(0x1f7)]({'where':{'telegramId':_0x1dfc77},'include':{'shop':!![]}});let _0xec0c61=_0x4286e7(0x198);_0xec0c61+=_0x4286e7(0x1d3)+_0x1dfc77+_0x4286e7(0x149),_0x4d8415?.['isVerified']&&_0x4d8415[_0x4286e7(0x1e7)]?(_0xec0c61+=_0x4286e7(0x1ee),_0xec0c61+=_0x4286e7(0x12e)+_0x4d8415[_0x4286e7(0x1e7)][_0x4286e7(0x179)]+'*\x0a',_0xec0c61+='\x20\x20\x20Username:\x20`'+_0x4d8415[_0x4286e7(0x1e7)]['username']+'`\x0a',_0xec0c61+=_0x4286e7(0x1f5)+_0x4d8415[_0x4286e7(0x1e7)][_0x4286e7(0x13a)]+'\x0a\x0a'):_0xec0c61+=_0x4286e7(0x168),_0xec0c61+=_0x4286e7(0x182),await this[_0x4286e7(0x1dc)]?.[_0x4286e7(0x1ef)](_0x4e5f25,_0xec0c61,{'parse_mode':_0x4286e7(0x215)});}catch(_0x3d2420){console[_0x4286e7(0x1b6)]('Error\x20handling\x20/debug\x20command:',_0x3d2420),await this[_0x4286e7(0x1dc)]?.[_0x4286e7(0x1ef)](_0x4e5f25,_0x4286e7(0x1f6));}}),this[_0x3ffb98(0x1dc)]['on'](_0x3ffb98(0x1b7),async _0x802bee=>{const _0x81cf31=_0x3ffb98;if(_0x802bee[_0x81cf31(0x1d5)]?.[_0x81cf31(0x131)]('/'))return;const _0x383521=_0x802bee[_0x81cf31(0x140)]['id'],_0x210129=_0x802bee['from']?.['id'][_0x81cf31(0x1b8)](),_0x30cc56=_0x802bee[_0x81cf31(0x1d5)]?.['trim']();if(!_0x210129||!_0x30cc56)return;try{const _0x133c9d=await database_1[_0x81cf31(0x19c)][_0x81cf31(0x1bf)]['findUnique']({'where':{'telegramId':_0x210129},'include':{'shop':!![]}});if(!_0x133c9d){await this['bot']?.[_0x81cf31(0x1ef)](_0x383521,_0x81cf31(0x139));return;}if(_0x133c9d[_0x81cf31(0x205)]&&_0x133c9d['shopId']&&_0x133c9d[_0x81cf31(0x1e7)]){await this[_0x81cf31(0x1dc)]?.[_0x81cf31(0x1ef)](_0x383521,'✅\x20You\x20are\x20already\x20connected\x20to\x20shop\x20*'+_0x133c9d[_0x81cf31(0x1e7)][_0x81cf31(0x179)]+_0x81cf31(0x1dd)+'Use\x20/status\x20to\x20check\x20status\x20or\x20/disconnect\x20to\x20disconnect.',{'parse_mode':_0x81cf31(0x215)});return;}const _0x5dd92d=_0x30cc56['split'](/\s+/);if(_0x5dd92d['length']!==0x2){await this[_0x81cf31(0x1dc)]?.[_0x81cf31(0x1ef)](_0x383521,_0x81cf31(0x1d1)+'📝\x20Format:\x20`username\x20api_key`\x0a\x0a'+_0x81cf31(0x1b9)+_0x81cf31(0x1eb)+(_0x81cf31(0x207)+_0x5dd92d[_0x81cf31(0x145)]+_0x81cf31(0x144)+_0x5dd92d['map'](_0x485169=>'`'+_0x485169+'`')[_0x81cf31(0x1e1)](',\x20')),{'parse_mode':_0x81cf31(0x215)});return;}const [_0x3681ad,_0x442e73]=_0x5dd92d;console['log']('🔄\x20Processing\x20single-line\x20verification\x20for\x20user\x20'+_0x210129+_0x81cf31(0x152)+_0x3681ad+'\x22,\x20apiKey=\x22'+_0x442e73[_0x81cf31(0x134)](0x0,0xa)+_0x81cf31(0x1f8)),await this[_0x81cf31(0x1cc)](_0x383521,_0x210129,_0x3681ad,_0x442e73);}catch(_0x53e965){console[_0x81cf31(0x1b6)](_0x81cf31(0x19e),_0x53e965),await this['bot']?.[_0x81cf31(0x1ef)](_0x383521,_0x81cf31(0x17c));}}),this['bot']['on']('error',_0x6ec174=>{const _0x4b3ad1=_0x3ffb98;console[_0x4b3ad1(0x1b6)]('Telegram\x20bot\x20error:',_0x6ec174);}),this[_0x3ffb98(0x1dc)]['on'](_0x3ffb98(0x1bc),_0x2904c3=>{const _0x440730=_0x3ffb98;console[_0x440730(0x1b6)](_0x440730(0x1bd),_0x2904c3);});}async[a66_0x4a6504(0x1cc)](_0x592c9b,_0x419e17,_0x380650,_0x5aeb39){const _0x42654d=a66_0x4a6504;try{console[_0x42654d(0x165)](_0x42654d(0x1a4)+_0x419e17+_0x42654d(0x152)+_0x380650+_0x42654d(0x137)+_0x5aeb39[_0x42654d(0x134)](0x0,0xa)+'...\x22');if(!_0x380650||_0x380650['length']<0x3||_0x380650['length']>0x32||!/^[a-zA-Z0-9_]+$/['test'](_0x380650)){await this[_0x42654d(0x1dc)]?.[_0x42654d(0x1ef)](_0x592c9b,_0x42654d(0x1e0)+_0x380650+_0x42654d(0x149)+'Username\x20must\x20contain\x20only\x20letters,\x20numbers\x20and\x20underscore\x20(3-50\x20characters).',{'parse_mode':'Markdown'});return;}if(!_0x5aeb39||!_0x5aeb39['startsWith'](_0x42654d(0x133))&&!_0x5aeb39[_0x42654d(0x131)](_0x42654d(0x17a))){await this[_0x42654d(0x1dc)]?.[_0x42654d(0x1ef)](_0x592c9b,'❌\x20Invalid\x20API\x20key\x20format.\x0a\x0a'+_0x42654d(0x20a),{'parse_mode':_0x42654d(0x215)});return;}const _0x169d98=await database_1['default']['shop'][_0x42654d(0x1f7)]({'where':{'username':_0x380650},'select':{'id':!![],'name':!![],'username':!![],'status':!![],'publicKey':!![],'secretKey':!![]}});if(!_0x169d98){const _0x22355e=_0x42654d(0x1f3)+_0x380650+_0x42654d(0x1a1)+_0x42654d(0x1c5)+_0x42654d(0x1e6);await this[_0x42654d(0x1dc)]?.[_0x42654d(0x1ef)](_0x592c9b,_0x22355e,{'parse_mode':'Markdown'});return;}if(_0x169d98['status']!==_0x42654d(0x1e2)){await this['bot']?.[_0x42654d(0x1ef)](_0x592c9b,_0x42654d(0x1db)+_0x380650+_0x42654d(0x20e)+_0x42654d(0x1b4),{'parse_mode':_0x42654d(0x215)});return;}if(_0x169d98[_0x42654d(0x163)]!==_0x5aeb39&&_0x169d98[_0x42654d(0x12a)]!==_0x5aeb39){await this[_0x42654d(0x1dc)]?.[_0x42654d(0x1ef)](_0x592c9b,_0x42654d(0x17e)+_0x380650+'`.\x0a\x0a'+_0x42654d(0x17b)+'Expected\x20key\x20format:\x20`pk_...`\x20or\x20`sk_...`',{'parse_mode':_0x42654d(0x215)});return;}const _0x53da7e=await database_1[_0x42654d(0x19c)][_0x42654d(0x1bf)][_0x42654d(0x20c)]({'where':{'shopId':_0x169d98['id'],'isVerified':!![],'telegramId':{'not':_0x419e17}}});if(_0x53da7e){await this[_0x42654d(0x1dc)]?.[_0x42654d(0x1ef)](_0x592c9b,'❌\x20Another\x20Telegram\x20account\x20is\x20already\x20connected\x20to\x20shop\x20`'+_0x380650+_0x42654d(0x208)+_0x42654d(0x1e3),{'parse_mode':_0x42654d(0x215)});return;}await database_1['default'][_0x42654d(0x1bf)][_0x42654d(0x170)]({'where':{'telegramId':_0x419e17},'data':{'shopId':_0x169d98['id'],'isVerified':!![]}}),await this[_0x42654d(0x1dc)]?.[_0x42654d(0x1ef)](_0x592c9b,_0x42654d(0x206)+'✅\x20You\x20have\x20been\x20successfully\x20connected\x20to\x20the\x20notification\x20system!\x0a\x0a'+(_0x42654d(0x201)+_0x169d98[_0x42654d(0x179)]+'*\x0a')+(_0x42654d(0x196)+_0x169d98['username']+_0x42654d(0x149))+_0x42654d(0x1d9)+_0x42654d(0x1c6)+_0x42654d(0x129)+'•\x20Payouts\x0a'+'•\x20Important\x20events\x0a\x0a'+_0x42654d(0x16f)+_0x42654d(0x209)+_0x42654d(0x167),{'parse_mode':'Markdown'}),console['log'](_0x42654d(0x1d8)+_0x419e17+'\x20verified\x20for\x20shop\x20'+_0x169d98[_0x42654d(0x193)]+'\x20via\x20single-line\x20input');}catch(_0x778ddb){console[_0x42654d(0x1b6)](_0x42654d(0x1c8),_0x778ddb),await this['bot']?.[_0x42654d(0x1ef)](_0x592c9b,_0x42654d(0x17f));}}async['sendShopNotification'](_0x32c862,_0x44ab99,_0x18f89a){const _0x23873f=a66_0x4a6504;if(!this[_0x23873f(0x1dc)]){console[_0x23873f(0x160)]('Telegram\x20bot\x20not\x20initialized,\x20cannot\x20send\x20notification');return;}try{const _0xfa6541=await database_1[_0x23873f(0x19c)][_0x23873f(0x1bf)][_0x23873f(0x13e)]({'where':{'shopId':_0x32c862,'isVerified':!![]}});if(_0xfa6541[_0x23873f(0x145)]===0x0){console['log'](_0x23873f(0x125)+_0x32c862);return;}const _0x53e917=_0xfa6541[_0x23873f(0x138)](async _0x5edcb8=>{const _0x15bb0c=_0x23873f;try{await this[_0x15bb0c(0x1dc)]?.['sendMessage'](_0x5edcb8[_0x15bb0c(0x184)],_0x44ab99,_0x18f89a),console[_0x15bb0c(0x165)](_0x15bb0c(0x1fc)+_0x5edcb8[_0x15bb0c(0x184)]);}catch(_0x259183){console[_0x15bb0c(0x1b6)](_0x15bb0c(0x210)+_0x5edcb8[_0x15bb0c(0x184)]+':',_0x259183),_0x259183 instanceof Error&&(_0x259183['message'][_0x15bb0c(0x1f4)](_0x15bb0c(0x18d))||_0x259183[_0x15bb0c(0x1b7)][_0x15bb0c(0x1f4)]('chat\x20not\x20found')||_0x259183[_0x15bb0c(0x1b7)]['includes'](_0x15bb0c(0x14e)))&&(await database_1[_0x15bb0c(0x19c)][_0x15bb0c(0x1bf)]['update']({'where':{'id':_0x5edcb8['id']},'data':{'isVerified':![]}}),console[_0x15bb0c(0x165)](_0x15bb0c(0x183)+_0x5edcb8[_0x15bb0c(0x184)]+_0x15bb0c(0x189)));}});await Promise[_0x23873f(0x1c3)](_0x53e917);}catch(_0x4908a8){console[_0x23873f(0x1b6)](_0x23873f(0x1ec),_0x4908a8);}}async[a66_0x4a6504(0x151)](_0x22f85b,_0x530efb,_0x1c3dfd){const _0x158461=a66_0x4a6504,_0x295926={'created':'🆕','paid':'✅','failed':'❌','expired':'⏰','refund':'🔄','chargeback':'⚠️','processing':'⚙️'},_0x138cda={'created':_0x158461(0x217),'paid':_0x158461(0x150),'failed':_0x158461(0x135),'expired':_0x158461(0x1f2),'refund':_0x158461(0x146),'chargeback':'Payment\x20chargeback','processing':_0x158461(0x1ce)},_0x4d4527=_0x295926[_0x1c3dfd],_0x5f31ab=_0x138cda[_0x1c3dfd],_0x587a58=(0x0,gateway_1[_0x158461(0x166)])(_0x530efb[_0x158461(0x202)]);console[_0x158461(0x165)](_0x158461(0x20f)+_0x530efb[_0x158461(0x202)]+'\x22\x20->\x20display\x20\x22'+_0x587a58+'\x22');let _0x6b0d29=_0x4d4527+'\x20*'+_0x5f31ab+_0x158461(0x180)+(_0x158461(0x1cb)+_0x530efb[_0x158461(0x1f9)]+'\x20'+_0x530efb['currency']+'*\x0a')+(_0x158461(0x1be)+(_0x530efb['orderId']||_0x530efb['id'])+'`\x0a')+('🆔\x20Payment\x20ID:\x20`'+_0x530efb['id']+'`\x0a')+(_0x158461(0x1cf)+_0x587a58+'`\x0a')+(_0x158461(0x16b)+new Date(_0x530efb[_0x158461(0x1a8)])[_0x158461(0x143)](_0x158461(0x1af))+'\x0a');if(_0x530efb[_0x158461(0x13b)]||_0x530efb[_0x158461(0x158)]||_0x530efb[_0x158461(0x212)]||_0x530efb[_0x158461(0x1e9)]||_0x530efb[_0x158461(0x1da)]){_0x6b0d29+=_0x158461(0x192);_0x530efb[_0x158461(0x13b)]&&(_0x6b0d29+='📛\x20Name:\x20`'+_0x530efb[_0x158461(0x13b)]+'`\x0a');_0x530efb['customerEmail']&&(_0x6b0d29+='📧\x20Email:\x20`'+_0x530efb[_0x158461(0x158)]+'`\x0a');_0x530efb[_0x158461(0x212)]&&(_0x6b0d29+=_0x158461(0x16e)+_0x530efb[_0x158461(0x212)]+'`\x0a');_0x530efb[_0x158461(0x1e9)]&&(_0x6b0d29+=_0x158461(0x200)+_0x530efb['customerIp']+'`\x0a');if(_0x530efb[_0x158461(0x1da)]){const _0x508afa=_0x530efb['customerUa'][_0x158461(0x145)]>0x32?_0x530efb[_0x158461(0x1da)][_0x158461(0x134)](0x0,0x32)+_0x158461(0x20d):_0x530efb[_0x158461(0x1da)];_0x6b0d29+=_0x158461(0x204)+_0x508afa+'`\x0a';}}_0x1c3dfd===_0x158461(0x153)&&_0x530efb[_0x158461(0x15c)]&&(_0x6b0d29+=_0x158461(0x1c1)+_0x530efb[_0x158461(0x15c)]+_0x158461(0x190)),_0x1c3dfd==='processing'&&(_0x6b0d29+=_0x158461(0x1d7)),_0x530efb[_0x158461(0x142)]&&(_0x6b0d29+=_0x158461(0x132)+_0x530efb[_0x158461(0x142)]+'\x0a'),await this[_0x158461(0x14f)](_0x22f85b,_0x6b0d29,{'parse_mode':'Markdown'});}async[a66_0x4a6504(0x219)](_0x3d6dd1,_0x561dde,_0x32b4b4){const _0x36d2bb=a66_0x4a6504,_0x3b3b86={'created':'📤','completed':'✅','rejected':'❌'},_0x545628={'created':_0x36d2bb(0x162),'completed':_0x36d2bb(0x15b),'rejected':_0x36d2bb(0x1fa)},_0x5f40c8=_0x3b3b86[_0x32b4b4],_0x2bbd19=_0x545628[_0x32b4b4],_0x3d925b=_0x5f40c8+'\x20*'+_0x2bbd19+_0x36d2bb(0x180)+('💸\x20Amount:\x20*'+_0x561dde['amount']+_0x36d2bb(0x14c))+(_0x36d2bb(0x1a7)+_0x561dde[_0x36d2bb(0x1ca)]+'`\x0a')+(_0x36d2bb(0x177)+_0x561dde['id']+'`\x0a')+('📅\x20Date:\x20'+new Date(_0x561dde['createdAt'])[_0x36d2bb(0x143)]('en-US')+'\x0a')+(_0x561dde['txid']?_0x36d2bb(0x1c7)+_0x561dde[_0x36d2bb(0x18f)]+'`':'');await this[_0x36d2bb(0x14f)](_0x3d6dd1,_0x3d925b,{'parse_mode':_0x36d2bb(0x215)});}async[a66_0x4a6504(0x159)](_0x2b99dc,_0x1ef9a5){const _0xa85ec2=a66_0x4a6504;try{const _0x2dc9d0=await database_1[_0xa85ec2(0x19c)][_0xa85ec2(0x211)]['findUnique']({'where':{'shopId':_0x2b99dc},'select':{'notificationLogin':!![]}});if(!_0x2dc9d0?.[_0xa85ec2(0x1f1)]){console[_0xa85ec2(0x165)]('📱\x20Login\x20notifications\x20disabled\x20for\x20shop\x20'+_0x2b99dc);return;}const _0x7314d7=_0x1ef9a5[_0xa85ec2(0x13d)]?'🔐':'🚨',_0x554e50=_0x1ef9a5[_0xa85ec2(0x13d)]?_0xa85ec2(0x16c):'Failed\x20login\x20attempt';let _0x5d2922=_0x7314d7+'\x20*'+_0x554e50+_0xa85ec2(0x180)+('👤\x20Username:\x20`'+_0x1ef9a5[_0xa85ec2(0x193)]+'`\x0a')+(_0xa85ec2(0x1fd)+_0x1ef9a5[_0xa85ec2(0x188)][_0xa85ec2(0x143)](_0xa85ec2(0x1af))+'\x0a');_0x1ef9a5['ipAddress']&&(_0x5d2922+=_0xa85ec2(0x1b1)+_0x1ef9a5['ipAddress']+'`\x0a');if(_0x1ef9a5[_0xa85ec2(0x1b0)]){const _0x1552cf=_0x1ef9a5[_0xa85ec2(0x1b0)]['length']>0x32?_0x1ef9a5[_0xa85ec2(0x1b0)][_0xa85ec2(0x134)](0x0,0x32)+'...':_0x1ef9a5['userAgent'];_0x5d2922+=_0xa85ec2(0x204)+_0x1552cf+'`\x0a';}!_0x1ef9a5[_0xa85ec2(0x13d)]&&(_0x5d2922+='\x0a⚠️\x20If\x20this\x20wasn\x27t\x20you,\x20change\x20your\x20password\x20immediately!'),await this[_0xa85ec2(0x14f)](_0x2b99dc,_0x5d2922,{'parse_mode':_0xa85ec2(0x215)}),console[_0xa85ec2(0x165)](_0xa85ec2(0x213)+_0x2b99dc+':\x20'+(_0x1ef9a5[_0xa85ec2(0x13d)]?_0xa85ec2(0x13d):_0xa85ec2(0x18c)));}catch(_0x3e603c){console[_0xa85ec2(0x1b6)](_0xa85ec2(0x154),_0x3e603c);}}async['sendApiErrorNotification'](_0x32bd97,_0x57ad46){const _0xca07a7=a66_0x4a6504;try{const _0x45284c=await database_1[_0xca07a7(0x19c)][_0xca07a7(0x211)][_0xca07a7(0x1f7)]({'where':{'shopId':_0x32bd97},'select':{'notificationApiError':!![]}});if(!_0x45284c?.['notificationApiError']){console[_0xca07a7(0x165)]('📱\x20API\x20error\x20notifications\x20disabled\x20for\x20shop\x20'+_0x32bd97);return;}let _0x49193e=_0xca07a7(0x1ff)+('🔗\x20Endpoint:\x20`'+_0x57ad46[_0xca07a7(0x1ca)]+'\x20'+_0x57ad46[_0xca07a7(0x136)]+'`\x0a')+('📅\x20Time:\x20'+_0x57ad46[_0xca07a7(0x188)][_0xca07a7(0x143)](_0xca07a7(0x1af))+'\x0a');_0x57ad46['statusCode']&&(_0x49193e+=_0xca07a7(0x1df)+_0x57ad46[_0xca07a7(0x14b)]+'`\x0a'),_0x49193e+=_0xca07a7(0x1ba)+_0x57ad46['errorMessage']+'`\x0a',_0x57ad46['requestId']&&(_0x49193e+=_0xca07a7(0x169)+_0x57ad46[_0xca07a7(0x1a3)]+'`\x0a'),_0x49193e+='\x0a💡\x20Check\x20your\x20request\x20or\x20contact\x20support.',await this[_0xca07a7(0x14f)](_0x32bd97,_0x49193e,{'parse_mode':_0xca07a7(0x215)}),console['log'](_0xca07a7(0x12d)+_0x32bd97+':\x20'+_0x57ad46[_0xca07a7(0x136)]);}catch(_0x3cc386){console['error'](_0xca07a7(0x130),_0x3cc386);}}async[a66_0x4a6504(0x187)](_0x3831b4,_0x4395ee,_0x28f2de){const _0x1ccbd6=a66_0x4a6504;let _0x22eb9e=_0x1ccbd6(0x171)+_0x4395ee+'*\x0a\x0a';for(const [_0x2192da,_0x562d8d]of Object['entries'](_0x28f2de)){_0x562d8d!==null&&_0x562d8d!==undefined&&(_0x22eb9e+=_0x2192da+':\x20`'+_0x562d8d+'`\x0a');}await this[_0x1ccbd6(0x14f)](_0x3831b4,_0x22eb9e,{'parse_mode':_0x1ccbd6(0x215)});}async[a66_0x4a6504(0x1e4)](_0x9d7cc8){const _0x2179ff=a66_0x4a6504;try{console[_0x2179ff(0x165)](_0x2179ff(0x1a5)+_0x9d7cc8[_0x2179ff(0x134)](0x0,0x32)+_0x2179ff(0x20d));const _0x58bb32=await database_1['default'][_0x2179ff(0x1bf)][_0x2179ff(0x13e)]({'select':{'telegramId':!![]}});if(_0x58bb32['length']===0x0){console[_0x2179ff(0x165)]('📱\x20No\x20active\x20Telegram\x20users\x20found');return;}for(const _0x11053d of _0x58bb32){try{await this[_0x2179ff(0x1dc)]?.[_0x2179ff(0x1ef)](_0x11053d[_0x2179ff(0x184)],_0x9d7cc8,{'parse_mode':'Markdown'});}catch(_0x20d3ec){console[_0x2179ff(0x1b6)](_0x2179ff(0x1e5)+_0x11053d['telegramId']+':',_0x20d3ec);}}console[_0x2179ff(0x165)]('📱\x20Notification\x20sent\x20to\x20'+_0x58bb32[_0x2179ff(0x145)]+_0x2179ff(0x1d2));}catch(_0x20ac2f){console[_0x2179ff(0x1b6)](_0x2179ff(0x18a),_0x20ac2f);}}[a66_0x4a6504(0x214)](){const _0x5e020a=a66_0x4a6504;return{'isActive':!!this[_0x5e020a(0x1dc)],'username':this['botUsername']};}async[a66_0x4a6504(0x19a)](_0x584d18,_0x56c3aa,_0x2cb999,_0xf9a953){const _0x45cb2e=a66_0x4a6504;try{if(!this['bot'])return console['error'](_0x45cb2e(0x1c2)),![];const _0x5931d1=await database_1[_0x45cb2e(0x19c)][_0x45cb2e(0x1bf)][_0x45cb2e(0x13e)]({'where':{'shopId':_0x584d18,'isVerified':!![]},'select':{'telegramId':!![]}});if(_0x5931d1[_0x45cb2e(0x145)]===0x0)return console[_0x45cb2e(0x1b6)]('❌\x20No\x20verified\x20Telegram\x20users\x20found\x20for\x20shop\x20ID:\x20'+_0x584d18),![];let _0x4449b6=0x0;for(const _0x5b7968 of _0x5931d1){try{await this[_0x45cb2e(0x1dc)][_0x45cb2e(0x1fe)](_0x5b7968[_0x45cb2e(0x184)],_0x56c3aa,{},{'filename':_0x2cb999,'contentType':_0x2cb999[_0x45cb2e(0x1a6)](_0x45cb2e(0x1ed))?_0x45cb2e(0x17d):_0x2cb999['endsWith']('.jpg')||_0x2cb999[_0x45cb2e(0x1a6)](_0x45cb2e(0x174))?_0x45cb2e(0x15d):_0x2cb999['endsWith']('.pdf')?'application/pdf':_0x45cb2e(0x191)}),_0xf9a953&&await this[_0x45cb2e(0x1dc)]['sendMessage'](_0x5b7968['telegramId'],_0xf9a953),_0x4449b6++;}catch(_0x562c3a){console[_0x45cb2e(0x1b6)](_0x45cb2e(0x126)+_0x5b7968[_0x45cb2e(0x184)]+':',_0x562c3a);}}return console[_0x45cb2e(0x165)](_0x45cb2e(0x1a0)+_0x4449b6+'/'+_0x5931d1[_0x45cb2e(0x145)]+_0x45cb2e(0x141)+_0x584d18+':\x20'+_0x2cb999),_0x4449b6>0x0;}catch(_0x2b2a94){return console['error'](_0x45cb2e(0x197),_0x2b2a94),![];}}async[a66_0x4a6504(0x18e)](_0x2365f7,_0x291e80){const _0xe9431c=a66_0x4a6504;try{if(!this[_0xe9431c(0x1dc)])return console[_0xe9431c(0x1b6)](_0xe9431c(0x1c2)),![];return await this[_0xe9431c(0x1dc)]['sendMessage'](_0x2365f7,_0x291e80),console[_0xe9431c(0x165)](_0xe9431c(0x1ab)+_0x2365f7),!![];}catch(_0xabbb44){return console['error'](_0xe9431c(0x147),_0xabbb44),![];}}async['sendDirectFile'](_0x56147e,_0x440e08,_0x24a049,_0x57324d){const _0x50df23=a66_0x4a6504;try{if(!this[_0x50df23(0x1dc)])return console[_0x50df23(0x1b6)]('❌\x20Telegram\x20bot\x20not\x20initialized'),![];return await this['bot'][_0x50df23(0x1fe)](_0x56147e,_0x440e08,{},{'filename':_0x24a049,'contentType':_0x24a049[_0x50df23(0x1a6)]('.png')?_0x50df23(0x17d):_0x24a049['endsWith'](_0x50df23(0x13f))||_0x24a049['endsWith'](_0x50df23(0x174))?_0x50df23(0x15d):_0x24a049[_0x50df23(0x1a6)]('.pdf')?_0x50df23(0x1ea):'application/octet-stream'}),_0x57324d&&await this[_0x50df23(0x1dc)]['sendMessage'](_0x56147e,_0x57324d),console[_0x50df23(0x165)]('✅\x20File\x20sent\x20to\x20chat\x20'+_0x56147e+':\x20'+_0x24a049),!![];}catch(_0x59bb18){return console[_0x50df23(0x1b6)](_0x50df23(0x13c),_0x59bb18),![];}}['stopBot'](){const _0x4548cf=a66_0x4a6504;this['bot']&&(this[_0x4548cf(0x1dc)][_0x4548cf(0x1c0)](),this[_0x4548cf(0x1dc)]=null,console[_0x4548cf(0x165)](_0x4548cf(0x1b3)));}}exports[a66_0x4a6504(0x1d4)]=TelegramBotService,exports[a66_0x4a6504(0x1ae)]=new TelegramBotService();function a66_0x5325(){const _0x2782dc=['`\x0a\x0a','✅\x20Telegram\x20bot\x20@','statusCode','\x20USD*\x0a','TELEGRAM_BOT_TOKEN','user\x20is\x20deactivated','sendShopNotification','Payment\x20successfully\x20paid','sendPaymentNotification',':\x20username=\x22','chargeback','Failed\x20to\x20send\x20login\x20notification:','You\x20are\x20already\x20connected\x20to\x20shop:\x20*','To\x20reconnect,\x20use\x20the\x20/start\x20command','5051UWxyat','customerEmail','sendLoginNotification','❌\x20Failed\x20to\x20initialize\x20Telegram\x20bot:','Payout\x20completed','chargebackAmount','image/jpeg','onText','../config/database','warn','6908aHWrwR','New\x20payout\x20created','publicKey','✅\x20You\x20have\x20been\x20successfully\x20disconnected\x20from\x20shop\x20*','log','getGatewayDisplayNameForTelegram','/disconnect\x20-\x20disconnect\x20from\x20notifications','❌\x20You\x20are\x20not\x20connected\x20to\x20any\x20shop.\x0a\x0a','🆔\x20Request\x20ID:\x20`','13825512bpNbbU','📅\x20Date:\x20','Successful\x20login','TELEGRAM_BOT_TOKEN\x20not\x20found\x20in\x20environment\x20variables','🏦\x20IBAN:\x20`','Commands:\x0a','update','🔔\x20*','🔔\x20You\x20receive\x20notifications\x20about:\x0a','initializeBot','.jpeg','\x20(@','3312498jHPEIt','🆔\x20Payout\x20ID:\x20`','5rFxbOo','name','sk_','Check\x20the\x20key\x20and\x20try\x20again.\x0a\x0a','❌\x20An\x20error\x20occurred.\x20Please\x20try\x20again\x20later.','image/png','❌\x20API\x20key\x20does\x20not\x20match\x20shop\x20`','❌\x20An\x20error\x20occurred\x20while\x20verifying\x20data.','*\x0a\x0a','❌\x20You\x20are\x20not\x20connected\x20to\x20the\x20notification\x20system.','Use\x20/start\x20to\x20connect\x20to\x20a\x20shop.','User\x20','telegramId','✅\x20Connected\x20to\x20shop:\x20*','7PZhGMJ','sendCustomNotification','timestamp','\x20marked\x20as\x20unverified\x20due\x20to\x20delivery\x20failure','❌\x20Failed\x20to\x20send\x20notification\x20to\x20all\x20users:','from','failed','blocked','sendDirectMessage','txid','\x20USDT*\x0a','application/octet-stream','\x0a👤\x20*Customer\x20Information:*\x0a','username','botToken','unknown\x20shop','👤\x20Username:\x20`','❌\x20Error\x20sending\x20file\x20to\x20shop:','🔍\x20*Debug\x20Information*\x0a\x0a','setupBotHandlers','sendShopFile','2671768Cafgdp','default','Use\x20/start\x20to\x20connect.','Error\x20handling\x20message:','defineProperty','✅\x20File\x20sent\x20to\x20','`\x20not\x20found.\x0a\x0a','❌\x20You\x20are\x20not\x20connected\x20to\x20a\x20shop.\x0a\x0a','requestId','🔄\x20Processing\x20single-line\x20verification\x20for\x20user\x20','📱\x20Sending\x20notification\x20to\x20all\x20connected\x20users:\x20','endsWith','🏦\x20Method:\x20`','createdAt','TELEGRAM_BOT_USERNAME','3924832aLnjLS','✅\x20Direct\x20message\x20sent\x20to\x20chat\x20','262vMzTHx','🔔\x20Notifications\x20are\x20active\x0a\x0a','telegramBotService','en-US','userAgent','🌐\x20IP\x20address:\x20`','last_name','🛑\x20Telegram\x20bot\x20stopped','Contact\x20administrator.','__esModule','error','message','toString','Example:\x0a','❌\x20Error:\x20`','6941346facXPH','polling_error','Telegram\x20bot\x20polling\x20error:','📝\x20Order\x20ID:\x20`','telegramUser','stopPolling','💸\x20Penalty\x20amount:\x20*','❌\x20Telegram\x20bot\x20not\x20initialized','allSettled','env','Please\x20check\x20the\x20spelling\x20and\x20try\x20again.\x0a\x0a','•\x20New\x20payments\x0a','🔗\x20TXID:\x20`','Error\x20in\x20handleSingleLineVerification:','Use\x20/start\x20to\x20begin.','method','💰\x20Amount:\x20*','handleSingleLineVerification','../types/gateway','Payment\x20is\x20being\x20processed','🏪\x20Gateway:\x20`','❌\x20You\x20are\x20not\x20registered\x20in\x20the\x20system.\x0a\x0a','❌\x20Invalid\x20format.\x20Please\x20send\x20exactly\x202\x20parts\x20separated\x20by\x20space:\x0a\x0a','\x20users','📱\x20Your\x20Telegram\x20ID:\x20`','TelegramBotService','text','Username:\x20`','⏳\x20The\x20payment\x20is\x20currently\x20being\x20processed\x20by\x20the\x20gateway.\x0a','✅\x20Telegram\x20user\x20','🔔\x20You\x20will\x20now\x20receive\x20notifications\x20about:\x0a','customerUa','❌\x20Shop\x20`','bot','*.\x0a\x0a','❗️\x20Make\x20sure\x20to\x20separate\x20username\x20and\x20API\x20key\x20with\x20a\x20space!','📊\x20Error\x20code:\x20`','❌\x20Invalid\x20username\x20format:\x20`','join','ACTIVE','Disconnect\x20the\x20previous\x20account\x20first\x20or\x20contact\x20administrator.','sendNotificationToAll','❌\x20Failed\x20to\x20send\x20message\x20to\x20user\x20','Make\x20sure\x20you\x20have\x20the\x20correct\x20username\x20from\x20your\x20account.','shop','trapay_bot','customerIp','application/pdf','`appple\x20pk_aa6450d3f57afbefbb0f3f5be5ce6cca13037536afc5ccf14c81a6cbc7a07de5`\x0a\x0a','Error\x20sending\x20shop\x20notification:','.png','🏪\x20Your\x20connected\x20shop:\x0a','sendMessage','\x20disconnected\x20from\x20shop\x20','notificationLogin','Payment\x20expired','❌\x20Shop\x20with\x20username\x20`','includes','\x20\x20\x20Status:\x20','❌\x20Error\x20getting\x20debug\x20information.','findUnique','...\x22','amount','Payout\x20rejected','📱\x20Created\x20new\x20Telegram\x20user:\x20','✅\x20Notification\x20sent\x20to\x20Telegram\x20user\x20','📅\x20Time:\x20','sendDocument','🚨\x20*API\x20Error*\x0a\x0a','🌐\x20IP:\x20`','📱\x20Shop:\x20*','gateway','Error\x20handling\x20/disconnect\x20command:','💻\x20Browser:\x20`','isVerified','🎉\x20*Congratulations!*\x0a\x0a','You\x20sent\x20','`.\x0a\x0a','/status\x20-\x20check\x20connection\x20status\x0a','API\x20key\x20must\x20start\x20with\x20`pk\x5c_`\x20or\x20`sk\x5c_`.','📝\x20Format:\x20`username\x20api_key`\x0a\x0a','findFirst','...','`\x20is\x20inactive.\x0a\x0a','📱\x20Telegram\x20notification:\x20gateway\x20\x22','❌\x20Failed\x20to\x20send\x20notification\x20to\x20Telegram\x20user\x20','shopSettings','remitterIban','✅\x20Login\x20notification\x20sent\x20for\x20shop\x20','getBotInfo','Markdown','botUsername','New\x20payment\x20created','53190yzScet','sendPayoutNotification','No\x20verified\x20Telegram\x20users\x20found\x20for\x20shop\x20','❌\x20Error\x20sending\x20file\x20to\x20user\x20','🔄\x20Reset\x20incomplete\x20verification\x20for\x20user\x20','updatedAt','•\x20Payment\x20status\x20changes\x0a','secretKey','node-telegram-bot-api','To\x20receive\x20payment\x20notifications,\x20send\x20your\x20credentials\x20in\x20one\x20line:\x0a\x0a','✅\x20API\x20error\x20notification\x20sent\x20for\x20shop\x20','\x20\x20\x20Name:\x20*','shopId','Failed\x20to\x20send\x20API\x20error\x20notification:','startsWith','📝\x20Notes:\x20','pk_','substring','Payment\x20failed','endpoint','\x22,\x20apiKey=\x22','map','❌\x20Please\x20use\x20/start\x20command\x20first','status','customerName','❌\x20Error\x20sending\x20file\x20to\x20chat:','success','findMany','.jpg','chat','\x20users\x20of\x20shop\x20','adminNotes','toLocaleString','\x20parts:\x20','length','Payment\x20refund','❌\x20Error\x20sending\x20direct\x20message:','toLocaleDateString'];a66_0x5325=function(){return _0x2782dc;};return a66_0x5325();}