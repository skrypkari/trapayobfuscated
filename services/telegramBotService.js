'use strict';const a87_0xd41bac=a87_0x3985;(function(_0x507d64,_0x18567b){const _0x163146=a87_0x3985,_0x6781cf=_0x507d64();while(!![]){try{const _0x248048=parseInt(_0x163146(0x21d))/0x1+parseInt(_0x163146(0x232))/0x2+-parseInt(_0x163146(0x165))/0x3+-parseInt(_0x163146(0x188))/0x4+parseInt(_0x163146(0x18f))/0x5*(parseInt(_0x163146(0x26c))/0x6)+-parseInt(_0x163146(0x27c))/0x7*(-parseInt(_0x163146(0x1cc))/0x8)+-parseInt(_0x163146(0x25a))/0x9;if(_0x248048===_0x18567b)break;else _0x6781cf['push'](_0x6781cf['shift']());}catch(_0x539c1d){_0x6781cf['push'](_0x6781cf['shift']());}}}(a87_0x5060,0x71fcd));var __importDefault=this&&this[a87_0xd41bac(0x1a9)]||function(_0x1b8d82){const _0xf78f72=a87_0xd41bac;return _0x1b8d82&&_0x1b8d82[_0xf78f72(0x1a2)]?_0x1b8d82:{'default':_0x1b8d82};};function a87_0x3985(_0xa14677,_0xe31a71){_0xa14677=_0xa14677-0x107;const _0x50602c=a87_0x5060();let _0x398558=_0x50602c[_0xa14677];return _0x398558;}Object[a87_0xd41bac(0x179)](exports,a87_0xd41bac(0x1a2),{'value':!![]}),exports[a87_0xd41bac(0x16a)]=exports['TelegramBotService']=void 0x0;const node_telegram_bot_api_1=__importDefault(require(a87_0xd41bac(0x133))),database_1=__importDefault(require(a87_0xd41bac(0x237))),gateway_1=require(a87_0xd41bac(0x261));function a87_0x5060(){const _0x390e5b=['CHF','PLN','â€¢\x20Payment\x20count\x0a','paymentLink','âŒ\x20You\x20are\x20not\x20connected\x20to\x20any\x20shop.\x0a\x0a','__importDefault','â³\x20The\x20payment\x20is\x20currently\x20being\x20processed\x20by\x20the\x20gateway.\x0a','âŒ\x20No\x20gateways\x20configured.\x20Please\x20configure\x20gateways\x20in\x20the\x20admin\x20panel\x20first.','â—ï¸\x20Make\x20sure\x20to\x20separate\x20username\x20and\x20API\x20key\x20with\x20a\x20space!','entries','DOGE','âœ…\x20Connected\x20to\x20shop:\x20*','sendMessage','reduce','test','â€¢\x20New\x20payments\x0a','Username\x20must\x20contain\x20only\x20letters,\x20numbers\x20and\x20underscore\x20(3-50\x20characters).','success','To\x20reconnect,\x20use\x20the\x20/start\x20command','log','cmd_status','ðŸŒ\x20IP:\x20`','ðŸŒ\x20*Network:*\x20','â±ï¸\x20*Period:*\x20','errorMessage','ðŸ’°\x20Total\x20earned:\x20','pl_type_single','ðŸ’¬\x20Support:\x20https://t.me/trapay\x5c_sales','ðŸ’»\x20Browser:\x20`','create',':\x20username=\x22','pl_create_new','cmd_statistics','âŒ\x20Shop\x20not\x20found.','sendPayoutNotification','â€¢\x20Amount\x20and\x20network\x0a','Username:\x20`','âœ…\x20Paid\x20out:\x20','âŒ\x20You\x20are\x20not\x20connected\x20to\x20a\x20shop.\x0a\x0a','requestId','624872UvyQSF','updatedAt','PAID','.pdf','orderId','ðŸ”„\x20Reset\x20incomplete\x20verification\x20for\x20user\x20','\x20USDT*\x0a','all','ðŸ”„\x20Processing\x20single-line\x20verification\x20for\x20user\x20','sendLoginNotification','â€¢\x20Last\x205\x20payouts\x0a','sendPaymentNotification','ðŸŒ\x20Country:\x20','ðŸ”—\x20*Transaction\x20Link:*\x20`','Use\x20/start\x20to\x20connect.','\x20\x5c|\x20Type:\x20','answerCallbackQuery','error','âœ…\x20File\x20sent\x20to\x20chat\x20','sendShopNotification','status','Error\x20handling\x20/contacts\x20command:','âž•\x20Create\x20New\x20Link','ðŸ“§\x20Email:\x20`','BNB','âŒ\x20You\x20are\x20not\x20connected\x20to\x20a\x20shop.\x0a\x0aUse\x20/start\x20to\x20connect.','âŒ\x20An\x20error\x20occurred\x20while\x20loading\x20payment\x20links.','Coming\x20soon...\x0a\x0a','TelegramBotService','ðŸ”—\x20*Payment\x20Links*\x0a\x0a','...\x22','ðŸ“±\x20No\x20active\x20Telegram\x20users\x20found','push','This\x20feature\x20will\x20show:\x0a','ðŸ¦\x20Gateway:\x20','\x20\x20\x20[LINK](','CAD','âŒ\x20Error:\x20`','username','Error\x20handling\x20/status\x20command:',':\x20`','setupBotHandlers','ðŸ‘¤\x20Username:\x20`','isVerified','ðŸ“Š\x20Statistics','Error\x20in\x20payment\x20link\x20flow:','shop','network','image/png','Telegram\x20bot\x20error:','\x20marked\x20as\x20unverified\x20due\x20to\x20delivery\x20failure','trim','Payment\x20chargeback','ðŸ‘¤\x20Account:\x20https://app.trapay.uk/login\x0a','â€¢\x20Gateway\x20performance','API\x20key\x20must\x20start\x20with\x20`pk\x5c_`\x20or\x20`sk\x5c_`.','endsWith','commission','Step\x202/4:\x20Select\x20link\x20type','ðŸ“Š\x20Error\x20code:\x20`','createdAt','processing','\x20USD\x0a','length','GBP','name','application/pdf','Error\x20in\x20handleSingleLineVerification:','âŒ\x20Close','pl_cancel','Disconnect\x20one\x20of\x20the\x20existing\x20accounts\x20first.','totalPaidOut','ðŸ“±\x20Sending\x20notification\x20to\x20all\x20connected\x20users:\x20','ðŸ”—\x20*Create\x20Payment\x20Link*\x0a\x0a','Error\x20handling\x20/start\x20command:','ðŸ“ˆ\x20Conversion\x20-\x20','ðŸ“\x20Order\x20ID:\x20`','toFixed','handleSingleLineVerification','\x20USDC\x0a','en-US','220269qJztsp','filter','You\x20sent\x20','âŒ\x20An\x20error\x20occurred.\x20Please\x20try\x20again\x20later.','Not\x20specified','substring','telegramUser','ðŸ“±\x20Created\x20new\x20Telegram\x20user:\x20','type','sendDocument','\x20verified\x20for\x20shop\x20','user\x20is\x20deactivated','get','ðŸ””\x20You\x20will\x20now\x20receive\x20notifications\x20about:\x0a','â€¢\x20Transaction\x20status\x0a','`.\x0a\x0a','â¬…ï¸\x20Previous','count','â€¢\x20Total\x20revenue\x0a','Telegram\x20bot\x20polling\x20error:','ðŸ’µ\x20Earned\x20-\x20','255190sHbnLr','`\x0a\x0a','Use\x20/status\x20to\x20check\x20status\x20or\x20/disconnect\x20to\x20disconnect.','Error\x20handling\x20/payment_links\x20command:','âœ…\x20Successful\x20payments\x20-\x20','../config/database','`\x20is\x20inactive.\x0a\x0a','Use\x20/start\x20to\x20connect\x20to\x20a\x20shop.','Example:\x0a','EUR','ðŸ”Œ\x20User\x20','sendApiErrorNotification','GATEWAY_ID_MAP','âŒ\x20Failed\x20to\x20send\x20message\x20to\x20user\x20','.jpg','getGatewayCurrencies','âŒ\x20You\x20are\x20not\x20registered\x20in\x20the\x20system.\x0a\x0a','userAgent','Multi\x20Use','â€¢\x20Usage\x20statistics\x0a','Error\x20handling\x20/payouts\x20command:','Failed\x20to\x20send\x20login\x20notification:','âŒ\x20Invalid\x20API\x20key\x20format.\x0a\x0a','Markdown','stopBot','handlePaymentLinkFlow','cmd_payment_links','slice','User\x20','âš ï¸\x20Chargebacks\x20-\x20','ðŸ“›\x20Name:\x20`','Single\x20Use','amount','TRY','ðŸ“…\x20Time:\x20','ðŸ“‹\x20View\x20Payment\x20Links','ðŸ“±\x20Telegram\x20notification:\x20gateway\x20\x22','ðŸ“…\x20*Payout\x20Date:*\x20','message','pk_','8252532gLoqwP','âœ…\x20Notification\x20sent\x20to\x20Telegram\x20user\x20','pl_type_','Payment\x20failed','FAILED','wallet','adminNotes','../types/gateway','âœ…\x20You\x20have\x20been\x20successfully\x20disconnected\x20from\x20shop\x20*','getGatewayNameById','showPaymentLinksList','âŒ\x20Error\x20sending\x20file\x20to\x20user\x20','Unknown','polling_error','initializeBot','set','sendNotificationToAll','`appple\x20pk_aa6450d3f57afbefbb0f3f5be5ce6cca13037536afc5ccf14c81a6cbc7a07de5`\x0a\x0a','396nFWpmv','toString','\x5c)\x0a\x0a','Use\x20/start\x20to\x20begin.','default','/disconnect\x20-\x20disconnect\x20from\x20notifications','from','2-digit','ðŸ”\x20*Debug\x20Information*\x0a\x0a','toLocaleDateString','.png','âœ…\x20Login\x20notification\x20sent\x20for\x20shop\x20','failed','ðŸ”—\x20Endpoint:\x20`','ðŸ“Š\x20*Connection\x20Status*\x0a\x0a','Error\x20handling\x20/disconnect\x20command:','56uctxsr','ARS','shopId','timestamp','âŒ\x20Cancel','\x22\x20->\x20display\x20\x22','getDate','NZD','currency','cmd_contacts','âœ…\x20You\x20have\x20been\x20successfully\x20connected\x20to\x20the\x20notification\x20system!\x0a\x0a','botToken','geo','ðŸ“‹\x20*Payment\x20Links*\x20\x5c(Page\x20','ðŸª\x20Gateway:\x20`','botUsername','\x20\x20\x20Status:\x20','âŒ\x20Shop\x20with\x20username\x20`','trapay_bot','ðŸ”—\x20Payment\x20Links','AUD','âœ…\x20Telegram\x20bot\x20@','\x20(e.g.,\x20100)','customerEmail','callback_query','\x20via\x20single-line\x20input','ðŸ”Œ\x20Disconnect','sendShopFile','desc','ðŸ“±\x20Notification\x20sent\x20to\x20','\x22,\x20apiKey=\x22','\x20users\x20of\x20shop\x20','ðŸª\x20Your\x20connected\x20shop:\x0a','period','ðŸŒ\x20Website:\x20https://trapay.uk/\x0a','ðŸ””\x20You\x20receive\x20notifications\x20about:\x0a','getGatewayDisplayNameForTelegram','Expected\x20key\x20format:\x20`pk_...`\x20or\x20`sk_...`','...','AED','USD','â™¾ï¸\x20Multi\x20Use','*.\x0a\x0a','https://app.trapay.uk','findUnique','To\x20receive\x20payment\x20notifications,\x20send\x20your\x20credentials\x20in\x20one\x20line:\x0a\x0a','notificationLogin','bot','ðŸ””\x20Notifications\x20are\x20active','â€¢\x20Payment\x20status\x20changes\x0a','Failed\x20to\x20send\x20API\x20error\x20notification:','step','ðŸ“±\x20API\x20error\x20notifications\x20disabled\x20for\x20shop\x20','\x0aâš ï¸\x20If\x20this\x20wasn\x27t\x20you,\x20change\x20your\x20password\x20immediately!','findMany','\x20\x20\x20Gateway:\x20','âŒ\x20Error\x20sending\x20file\x20to\x20shop:','USDT','ðŸ“¢\x20Telegram\x20channel:\x20https://t.me/trapay\x5c_news\x0a',')\x0a\x0a','\x20\x20\x20Name:\x20*','text','split','ðŸ“Š\x20Status','Error\x20handling\x20/statistics\x20command:','ðŸ“ž\x20Contacts','âœ…\x20API\x20error\x20notification\x20sent\x20for\x20shop\x20','âŒ\x20You\x20are\x20not\x20connected\x20to\x20the\x20notification\x20system.','Next\x20âž¡ï¸','JPY','paymentLinkSessions','Payment\x20is\x20being\x20processed','Error\x20handling\x20/debug\x20command:','âŒ\x20Failed\x20to\x20initialize\x20Telegram\x20bot:','ðŸ’°\x20Amount:\x20','setHours','sendCustomNotification','ACTIVE','/payouts\x20-\x20view\x20recent\x20payouts\x0a','Error\x20handling\x20message:','N/A','â€¢\x20Payouts\x0a','âœ…\x20File\x20sent\x20to\x20','en-GB','node-telegram-bot-api','pl_','âŒ\x20API\x20key\x20does\x20not\x20match\x20shop\x20`','chat','ðŸ’°\x20*Amount:*\x20','\x20users','sendDirectFile','replace','SINGLE','âŒ\x20No\x20active\x20gateways\x20found.\x20Please\x20enable\x20at\x20least\x20one\x20gateway\x20in\x20the\x20admin\x20panel.','editMessageText','telegramId','POL','ðŸ“\x20Notes:\x20','publicKey','*\x0a\x0a','\x20(@','âŒ\x20Error\x20sending\x20file\x20to\x20chat:','ðŸ“±\x20Login\x20notifications\x20disabled\x20for\x20shop\x20','âŒ\x20Maximum\x20number\x20of\x20connected\x20accounts\x20(5)\x20reached\x20for\x20shop\x20`','isValidGatewayId','notificationApiError','âœ…\x20Welcome\x20back!\x0a\x0a','âŒ\x20Invalid\x20username\x20format:\x20`','â€¢\x20Success\x20rate\x0a','paymentGateways','update','pl_gw_','ðŸ’³\x20*Wallet:*\x20`','ETH','application/octet-stream','TRX','chat\x20not\x20found','\x5c.\x20','map','pl_page_','last_name','/payment\x5c_links\x20-\x20manage\x20payment\x20links\x0a','setDate','PENDING','ðŸ†”\x20Payment\x20ID:\x20`','statusCode','New\x20payment\x20created','customerUa','forEach','âŒ\x20Telegram\x20bot\x20not\x20initialized','Telegram\x20bot\x20not\x20initialized,\x20cannot\x20send\x20notification','ðŸ’¸\x20*Payouts*\x0a\x0a','Please\x20check\x20the\x20spelling\x20and\x20try\x20again.\x0a\x0a','first_name','433164CbxFrr','cmd_payouts','gateway','blocked','shopSettings','telegramBotService','ðŸ””\x20Notifications\x20are\x20active\x0a\x0a','ðŸ“\x20Format:\x20`username\x20api_key`\x0a\x0a','â€¢\x20Dates\x20and\x20TX\x20IDs','includes','MarkdownV2','onText','âŒ\x20Cancelled.','ðŸ”—\x20*Transaction\x20Link:*\x20Pending','NOK','SOL','âŒ\x20Failed\x20to\x20send\x20notification\x20to\x20all\x20users:','data','âŒ\x20Failed\x20payments\x20-\x20','warn','defineProperty','â€¢\x20Payouts','customerName','ðŸ“ž\x20*Contacts*\x0a\x0a','Make\x20sure\x20you\x20have\x20the\x20correct\x20username\x20from\x20your\x20account.','pl_view_list','ðŸ”—\x20*Payment\x20Links*\x0a\x0aChoose\x20an\x20action:','\x0aðŸ’¡\x20Check\x20your\x20request\x20or\x20contact\x20support.','Error\x20showing\x20payment\x20links\x20list:','No\x20verified\x20Telegram\x20users\x20found\x20for\x20shop\x20','ðŸ“±\x20Your\x20Telegram\x20ID:\x20`','Gateway\x20-\x20','ðŸ’°\x20Turnover\x20-\x20','\x20\x20\x20Username:\x20`','toUpperCase','1081460LdSlWL','startsWith','/link/','pl_curr_','TELEGRAM_BOT_TOKEN\x20not\x20found\x20in\x20environment\x20variables','remitterIban','ðŸ“Š\x20*Statistics*\x0a\x0a','62565aApCQp','toLocaleString','ðŸ¤–\x20Welcome\x20to\x20TRAPAY\x20notification\x20system!\x0a\x0a','chargebackAmount','.jpeg','Payment\x20successfully\x20paid','â€¢\x20Important\x20events','ðŸŽ‰\x20*Congratulations!*\x0a\x0a','Copy\x20and\x20share\x20this\x20link\x20with\x20your\x20customers\x5c!','numeric','find','sk_','Please\x20send\x20the\x20amount\x20in\x20','chargeback','sendDirectMessage','cmd_disconnect','ðŸ›‘\x20Telegram\x20bot\x20stopped','delete','endpoint','__esModule','Failed\x20login\x20attempt'];a87_0x5060=function(){return _0x390e5b;};return a87_0x5060();}class TelegramBotService{constructor(){const _0x4f974d=a87_0xd41bac;this[_0x4f974d(0x10e)]=null,this[_0x4f974d(0x125)]=new Map(),this['botToken']=process.env.TELEGRAM_BOT_TOKEN||'',this[_0x4f974d(0x28b)]=process.env.TELEGRAM_BOT_USERNAME||_0x4f974d(0x28e),this[_0x4f974d(0x287)]?this[_0x4f974d(0x268)]():console[_0x4f974d(0x178)](_0x4f974d(0x18c));}[a87_0xd41bac(0x268)](){const _0x3ca861=a87_0xd41bac;try{this[_0x3ca861(0x10e)]=new node_telegram_bot_api_1[(_0x3ca861(0x270))](this[_0x3ca861(0x287)],{'polling':!![]}),this[_0x3ca861(0x1f5)](),console[_0x3ca861(0x1b7)](_0x3ca861(0x291)+this[_0x3ca861(0x28b)]+'\x20initialized\x20successfully');}catch(_0x428790){console['error'](_0x3ca861(0x128),_0x428790);}}['setupBotHandlers'](){const _0x405326=a87_0xd41bac;if(!this[_0x405326(0x10e)])return;this[_0x405326(0x10e)][_0x405326(0x170)](/\/start/,async _0x1a43c9=>{const _0x5bcc1f=_0x405326,_0x1da6f6=_0x1a43c9[_0x5bcc1f(0x136)]['id'],_0x2c6a40=_0x1a43c9[_0x5bcc1f(0x272)]?.['id'][_0x5bcc1f(0x26d)](),_0x3d1a2d=_0x1a43c9[_0x5bcc1f(0x272)]?.[_0x5bcc1f(0x1f2)],_0x4abec1=_0x1a43c9[_0x5bcc1f(0x272)]?.[_0x5bcc1f(0x164)],_0x5220ea=_0x1a43c9['from']?.[_0x5bcc1f(0x157)];if(!_0x2c6a40)return;try{let _0x591a8f=await database_1[_0x5bcc1f(0x270)][_0x5bcc1f(0x223)][_0x5bcc1f(0x10b)]({'where':{'telegramId':_0x2c6a40},'include':{'shop':!![]}});!_0x591a8f?(_0x591a8f=await database_1[_0x5bcc1f(0x270)]['telegramUser']['create']({'data':{'telegramId':_0x2c6a40,'username':_0x3d1a2d,'firstName':_0x4abec1,'lastName':_0x5220ea,'isVerified':![],'shopId':null},'include':{'shop':!![]}}),console[_0x5bcc1f(0x1b7)](_0x5bcc1f(0x224)+_0x2c6a40+_0x5bcc1f(0x143)+_0x3d1a2d+')')):_0x591a8f=await database_1[_0x5bcc1f(0x270)][_0x5bcc1f(0x223)][_0x5bcc1f(0x14d)]({'where':{'telegramId':_0x2c6a40},'data':{'username':_0x3d1a2d,'firstName':_0x4abec1,'lastName':_0x5220ea},'include':{'shop':!![]}}),_0x591a8f[_0x5bcc1f(0x1f7)]&&_0x591a8f[_0x5bcc1f(0x27e)]&&_0x591a8f[_0x5bcc1f(0x1fa)]?await this[_0x5bcc1f(0x10e)]?.[_0x5bcc1f(0x1b0)](_0x1da6f6,_0x5bcc1f(0x149)+('You\x20are\x20already\x20connected\x20to\x20shop:\x20*'+_0x591a8f[_0x5bcc1f(0x1fa)]['name']+'*\x0a')+(_0x5bcc1f(0x1c8)+_0x591a8f[_0x5bcc1f(0x1fa)][_0x5bcc1f(0x1f2)]+_0x5bcc1f(0x233))+_0x5bcc1f(0x29f)+'â€¢\x20New\x20payments\x0a'+_0x5bcc1f(0x110)+_0x5bcc1f(0x17a),{'parse_mode':'Markdown','reply_markup':{'inline_keyboard':[[{'text':_0x5bcc1f(0x1f8),'callback_data':'cmd_statistics'},{'text':'ðŸ’¸\x20Payouts','callback_data':_0x5bcc1f(0x166)}],[{'text':_0x5bcc1f(0x28f),'callback_data':_0x5bcc1f(0x24c)},{'text':'ðŸ“Š\x20Status','callback_data':_0x5bcc1f(0x1b8)}],[{'text':_0x5bcc1f(0x120),'callback_data':'cmd_contacts'},{'text':_0x5bcc1f(0x296),'callback_data':_0x5bcc1f(0x19e)}]]}}):(_0x591a8f[_0x5bcc1f(0x27e)]&&!_0x591a8f['isVerified']&&(await database_1[_0x5bcc1f(0x270)][_0x5bcc1f(0x223)][_0x5bcc1f(0x14d)]({'where':{'telegramId':_0x2c6a40},'data':{'shopId':null,'isVerified':![]}}),console[_0x5bcc1f(0x1b7)](_0x5bcc1f(0x1d1)+_0x2c6a40)),await this[_0x5bcc1f(0x10e)]?.[_0x5bcc1f(0x1b0)](_0x1da6f6,_0x5bcc1f(0x191)+_0x5bcc1f(0x10c)+_0x5bcc1f(0x16c)+_0x5bcc1f(0x23a)+_0x5bcc1f(0x26b)+_0x5bcc1f(0x1ac),{'parse_mode':'Markdown'}));}catch(_0x1060cc){console[_0x5bcc1f(0x1dd)](_0x5bcc1f(0x216),_0x1060cc),await this['bot']?.[_0x5bcc1f(0x1b0)](_0x1da6f6,_0x5bcc1f(0x220));}}),this[_0x405326(0x10e)]['onText'](/\/disconnect/,async _0x49888c=>{const _0xadd21c=_0x405326,_0x2e9611=_0x49888c[_0xadd21c(0x136)]['id'],_0x29089a=_0x49888c['from']?.['id'][_0xadd21c(0x26d)]();if(!_0x29089a)return;try{const _0xbe7dbf=await database_1[_0xadd21c(0x270)][_0xadd21c(0x223)][_0xadd21c(0x10b)]({'where':{'telegramId':_0x29089a},'include':{'shop':!![]}});if(!_0xbe7dbf||!_0xbe7dbf[_0xadd21c(0x1f7)]||!_0xbe7dbf[_0xadd21c(0x27e)]){await this['bot']?.['sendMessage'](_0x2e9611,_0xadd21c(0x122));return;}const _0x124337=_0xbe7dbf[_0xadd21c(0x1fa)]?.['name']||'unknown\x20shop';await database_1[_0xadd21c(0x270)][_0xadd21c(0x223)][_0xadd21c(0x14d)]({'where':{'telegramId':_0x29089a},'data':{'shopId':null,'isVerified':![]}}),console[_0xadd21c(0x1b7)](_0xadd21c(0x23c)+_0x29089a+'\x20disconnected\x20from\x20shop\x20'+_0xbe7dbf[_0xadd21c(0x27e)]),await this['bot']?.[_0xadd21c(0x1b0)](_0x2e9611,_0xadd21c(0x262)+_0x124337+'*.\x0a\x0a'+_0xadd21c(0x1b6),{'parse_mode':_0xadd21c(0x249)});}catch(_0x5daa48){console['error'](_0xadd21c(0x27b),_0x5daa48),await this[_0xadd21c(0x10e)]?.[_0xadd21c(0x1b0)](_0x2e9611,'âŒ\x20An\x20error\x20occurred.\x20Please\x20try\x20again\x20later.');}}),this[_0x405326(0x10e)][_0x405326(0x170)](/\/status/,async _0x49c141=>{const _0x37264c=_0x405326,_0x35eb1b=_0x49c141[_0x37264c(0x136)]['id'],_0x49a9ac=_0x49c141['from']?.['id'][_0x37264c(0x26d)]();if(!_0x49a9ac)return;try{const _0x2be083=await database_1[_0x37264c(0x270)][_0x37264c(0x223)][_0x37264c(0x10b)]({'where':{'telegramId':_0x49a9ac},'include':{'shop':!![]}});if(!_0x2be083){await this[_0x37264c(0x10e)]?.['sendMessage'](_0x35eb1b,_0x37264c(0x242)+_0x37264c(0x26f));return;}if(!_0x2be083[_0x37264c(0x1f7)]||!_0x2be083[_0x37264c(0x27e)]||!_0x2be083[_0x37264c(0x1fa)]){await this[_0x37264c(0x10e)]?.['sendMessage'](_0x35eb1b,_0x37264c(0x1ca)+_0x37264c(0x1da));return;}await this['bot']?.[_0x37264c(0x1b0)](_0x35eb1b,_0x37264c(0x27a)+(_0x37264c(0x1af)+_0x2be083[_0x37264c(0x1fa)]['name']+'*\x0a')+('ðŸ‘¤\x20Username:\x20`'+_0x2be083[_0x37264c(0x1fa)]['username']+'`\x0a')+('ðŸ“…\x20Connection\x20date:\x20'+_0x2be083[_0x37264c(0x1cd)][_0x37264c(0x275)](_0x37264c(0x21c))+'\x0a\x0a')+_0x37264c(0x16b)+'ðŸ“±\x20Available\x20Commands:\x0a'+'/statistics\x20-\x20view\x20your\x20statistics\x0a'+_0x37264c(0x12d)+_0x37264c(0x158)+'/contacts\x20-\x20support\x20contacts\x0a'+_0x37264c(0x271),{'parse_mode':_0x37264c(0x249)});}catch(_0x13c60b){console[_0x37264c(0x1dd)](_0x37264c(0x1f3),_0x13c60b),await this[_0x37264c(0x10e)]?.[_0x37264c(0x1b0)](_0x35eb1b,_0x37264c(0x220));}}),this[_0x405326(0x10e)]['onText'](/\/statistics/,async _0x4e19ff=>{const _0x374b9c=_0x405326,_0x1847fc=_0x4e19ff[_0x374b9c(0x136)]['id'],_0x403b0a=_0x4e19ff[_0x374b9c(0x272)]?.['id'][_0x374b9c(0x26d)]();if(!_0x403b0a)return;try{const _0x32bc2f=await database_1[_0x374b9c(0x270)][_0x374b9c(0x223)][_0x374b9c(0x10b)]({'where':{'telegramId':_0x403b0a},'include':{'shop':!![]}});if(!_0x32bc2f?.[_0x374b9c(0x1f7)]||!_0x32bc2f[_0x374b9c(0x27e)]){await this[_0x374b9c(0x10e)]?.[_0x374b9c(0x1b0)](_0x1847fc,'âŒ\x20You\x20are\x20not\x20connected\x20to\x20a\x20shop.\x0a\x0a'+'Use\x20/start\x20to\x20connect.');return;}await this[_0x374b9c(0x10e)]?.[_0x374b9c(0x1b0)](_0x1847fc,_0x374b9c(0x18e)+_0x374b9c(0x1e7)+_0x374b9c(0x1ed)+_0x374b9c(0x22f)+_0x374b9c(0x1a6)+_0x374b9c(0x14b)+_0x374b9c(0x202),{'parse_mode':_0x374b9c(0x249)});}catch(_0x2019d8){console[_0x374b9c(0x1dd)](_0x374b9c(0x11f),_0x2019d8),await this[_0x374b9c(0x10e)]?.['sendMessage'](_0x1847fc,_0x374b9c(0x220));}}),this[_0x405326(0x10e)][_0x405326(0x170)](/\/payouts/,async _0x3553cb=>{const _0x1a7f1a=_0x405326,_0x567e50=_0x3553cb[_0x1a7f1a(0x136)]['id'],_0x423818=_0x3553cb[_0x1a7f1a(0x272)]?.['id'][_0x1a7f1a(0x26d)]();if(!_0x423818)return;try{const _0x5b0c41=await database_1['default']['telegramUser'][_0x1a7f1a(0x10b)]({'where':{'telegramId':_0x423818},'include':{'shop':!![]}});if(!_0x5b0c41?.[_0x1a7f1a(0x1f7)]||!_0x5b0c41[_0x1a7f1a(0x27e)]){await this['bot']?.[_0x1a7f1a(0x1b0)](_0x567e50,'âŒ\x20You\x20are\x20not\x20connected\x20to\x20a\x20shop.\x0a\x0a'+'Use\x20/start\x20to\x20connect.');return;}await this[_0x1a7f1a(0x10e)]?.[_0x1a7f1a(0x1b0)](_0x567e50,'ðŸ’¸\x20*Recent\x20Payouts*\x0a\x0a'+_0x1a7f1a(0x1e7)+_0x1a7f1a(0x1ed)+_0x1a7f1a(0x1d6)+_0x1a7f1a(0x1c7)+_0x1a7f1a(0x22b)+_0x1a7f1a(0x16d),{'parse_mode':_0x1a7f1a(0x249)});}catch(_0x392c76){console['error'](_0x1a7f1a(0x246),_0x392c76),await this['bot']?.[_0x1a7f1a(0x1b0)](_0x567e50,'âŒ\x20An\x20error\x20occurred.\x20Please\x20try\x20again\x20later.');}}),this['bot'][_0x405326(0x170)](/\/payment_links/,async _0x52dca7=>{const _0x31da8f=_0x405326,_0x3f0bec=_0x52dca7[_0x31da8f(0x136)]['id'],_0x4c21e7=_0x52dca7[_0x31da8f(0x272)]?.['id'][_0x31da8f(0x26d)]();if(!_0x4c21e7)return;try{const _0x243e8f=await database_1[_0x31da8f(0x270)][_0x31da8f(0x223)][_0x31da8f(0x10b)]({'where':{'telegramId':_0x4c21e7},'include':{'shop':!![]}});if(!_0x243e8f?.[_0x31da8f(0x1f7)]||!_0x243e8f[_0x31da8f(0x27e)]){await this[_0x31da8f(0x10e)]?.[_0x31da8f(0x1b0)](_0x3f0bec,_0x31da8f(0x1ca)+_0x31da8f(0x1da));return;}await this[_0x31da8f(0x10e)]?.['sendMessage'](_0x3f0bec,_0x31da8f(0x1e9)+_0x31da8f(0x1e7)+_0x31da8f(0x1ed)+'â€¢\x20Active\x20payment\x20links\x0a'+_0x31da8f(0x245)+'â€¢\x20Quick\x20create\x20new\x20link\x0a'+'â€¢\x20Share\x20link\x20directly',{'parse_mode':'Markdown'});}catch(_0x480d82){console['error'](_0x31da8f(0x235),_0x480d82),await this['bot']?.[_0x31da8f(0x1b0)](_0x3f0bec,_0x31da8f(0x220));}}),this[_0x405326(0x10e)][_0x405326(0x170)](/\/contacts/,async _0xc3dbe9=>{const _0x110f66=_0x405326,_0x3ee277=_0xc3dbe9[_0x110f66(0x136)]['id'];try{await this[_0x110f66(0x10e)]?.[_0x110f66(0x1b0)](_0x3ee277,'ðŸ“ž\x20*Contacts*\x0a\x0a'+_0x110f66(0x29e)+_0x110f66(0x201)+'ðŸ“¢\x20Telegram\x20channel:\x20https://t.me/trapay\x5c_news\x0a'+_0x110f66(0x1bf),{'parse_mode':_0x110f66(0x249)});}catch(_0x5f4d26){console['error'](_0x110f66(0x1e1),_0x5f4d26),await this[_0x110f66(0x10e)]?.[_0x110f66(0x1b0)](_0x3ee277,_0x110f66(0x220));}}),this[_0x405326(0x10e)]['on'](_0x405326(0x294),async _0x3d525b=>{const _0x12200a=_0x405326,_0x4b45b8=_0x3d525b['message'],_0x24a10c=_0x4b45b8?.[_0x12200a(0x136)]['id'],_0x96e42f=_0x3d525b[_0x12200a(0x272)]['id'][_0x12200a(0x26d)](),_0x232907=_0x3d525b[_0x12200a(0x176)];if(!_0x24a10c||!_0x232907)return;try{await this[_0x12200a(0x10e)]?.[_0x12200a(0x1dc)](_0x3d525b['id']);const _0x350304=await database_1[_0x12200a(0x270)][_0x12200a(0x223)]['findUnique']({'where':{'telegramId':_0x96e42f},'include':{'shop':!![]}});if(!_0x350304?.[_0x12200a(0x1f7)]||!_0x350304[_0x12200a(0x27e)]){await this[_0x12200a(0x10e)]?.[_0x12200a(0x1b0)](_0x24a10c,_0x12200a(0x1e5));return;}switch(_0x232907){case'cmd_statistics':const _0x2093ae=new Date();_0x2093ae[_0x12200a(0x12a)](0x0,0x0,0x0,0x0);const _0x41e195=new Date(_0x2093ae);_0x41e195[_0x12200a(0x159)](_0x41e195[_0x12200a(0x282)]()+0x1);const _0x444dc3=await database_1[_0x12200a(0x270)]['payment'][_0x12200a(0x115)]({'where':{'shopId':_0x350304['shopId'],'createdAt':{'gte':_0x2093ae,'lt':_0x41e195}}}),_0x5cbc60=_0x444dc3[_0x12200a(0x21e)](_0x336514=>_0x336514[_0x12200a(0x1e0)]===_0x12200a(0x1ce)),_0x5e5a91=_0x444dc3[_0x12200a(0x21e)](_0xb286eb=>_0xb286eb[_0x12200a(0x1e0)]===_0x12200a(0x25e)),_0x523fe9=_0x444dc3['filter'](_0x363431=>_0x363431[_0x12200a(0x1e0)]==='CHARGEBACK')[_0x12200a(0x20b)],_0x4ceb54=_0x444dc3['filter'](_0xcf1e8=>_0xcf1e8[_0x12200a(0x1e0)]==='REFUND')[_0x12200a(0x20b)],_0x3dbdeb=_0x5cbc60[_0x12200a(0x1b1)]((_0x42f780,_0x511f8d)=>_0x42f780+(_0x511f8d[_0x12200a(0x252)]||0x0),0x0),_0x3a230b=_0x5cbc60['reduce']((_0x4081f5,_0x3704bb)=>_0x4081f5+(_0x3704bb[_0x12200a(0x205)]||0x0),0x0),_0x56f170=_0x5cbc60['length']+_0x5e5a91[_0x12200a(0x20b)]>0x0?(_0x5cbc60[_0x12200a(0x20b)]/(_0x5cbc60[_0x12200a(0x20b)]+_0x5e5a91[_0x12200a(0x20b)])*0x64)[_0x12200a(0x219)](0x1):'0.0',_0x2f62b6=new Date()['toLocaleDateString'](_0x12200a(0x132),{'day':'2-digit','month':_0x12200a(0x273),'year':_0x12200a(0x198)});await this[_0x12200a(0x10e)]?.[_0x12200a(0x1b0)](_0x24a10c,'ðŸ“Š\x20*Today\x27s\x20Statistics\x20|\x20'+_0x2f62b6+_0x12200a(0x142)+(_0x12200a(0x185)+_0x3dbdeb[_0x12200a(0x219)](0x2)+_0x12200a(0x21b))+(_0x12200a(0x231)+_0x3a230b[_0x12200a(0x219)](0x2)+_0x12200a(0x21b))+(_0x12200a(0x236)+_0x5cbc60['length']+'\x0a')+(_0x12200a(0x177)+_0x5e5a91[_0x12200a(0x20b)]+'\x0a')+(_0x12200a(0x217)+_0x56f170+'%\x0a')+(_0x12200a(0x24f)+_0x523fe9+'\x0a')+('â†©ï¸\x20Refunds\x20-\x20'+_0x4ceb54),{'parse_mode':_0x12200a(0x249)});break;case _0x12200a(0x166):const _0x508af7=await database_1[_0x12200a(0x270)]['payout'][_0x12200a(0x115)]({'where':{'shopId':_0x350304[_0x12200a(0x27e)]},'orderBy':{'createdAt':_0x12200a(0x298)}}),_0x5730ee=_0x508af7['filter'](_0x43abec=>_0x43abec[_0x12200a(0x1e0)]===_0x12200a(0x15a))[_0x12200a(0x1b1)]((_0x4b2628,_0x5c4de1)=>_0x4b2628+_0x5c4de1[_0x12200a(0x252)],0x0),_0x466a01=_0x508af7[_0x12200a(0x21e)](_0xc06b84=>_0xc06b84[_0x12200a(0x1e0)]==='COMPLETED')[_0x12200a(0x1b1)]((_0x8bb7ea,_0x1964f3)=>_0x8bb7ea+_0x1964f3[_0x12200a(0x252)],0x0),_0x55d633=(_0x350304['shop']?.['balance']||0x0)+(_0x350304['shop']?.[_0x12200a(0x213)]||0x0);await this['bot']?.[_0x12200a(0x1b0)](_0x24a10c,_0x12200a(0x162)+('â³\x20Pending\x20payouts:\x20'+_0x5730ee['toFixed'](0x2)+_0x12200a(0x21b))+(_0x12200a(0x1c9)+_0x466a01[_0x12200a(0x219)](0x2)+_0x12200a(0x21b))+(_0x12200a(0x1bd)+_0x55d633[_0x12200a(0x219)](0x2)+'\x20USDC'),{'parse_mode':_0x12200a(0x249)});break;case'cmd_payment_links':await this[_0x12200a(0x10e)]?.[_0x12200a(0x1b0)](_0x24a10c,_0x12200a(0x17f),{'parse_mode':'Markdown','reply_markup':{'inline_keyboard':[[{'text':_0x12200a(0x255),'callback_data':_0x12200a(0x17e)}],[{'text':_0x12200a(0x1e2),'callback_data':_0x12200a(0x1c3)}],[{'text':_0x12200a(0x280),'callback_data':_0x12200a(0x211)}]]}});break;case _0x12200a(0x1b8):await this['bot']?.[_0x12200a(0x1b0)](_0x24a10c,_0x12200a(0x27a)+(_0x12200a(0x1af)+(_0x350304['shop']?.[_0x12200a(0x20d)]||_0x12200a(0x266))+'*\x0a')+(_0x12200a(0x1f6)+(_0x350304[_0x12200a(0x1fa)]?.[_0x12200a(0x1f2)]||_0x12200a(0x266))+'`\x0a')+('ðŸ“…\x20Connection\x20date:\x20'+_0x350304[_0x12200a(0x1cd)][_0x12200a(0x275)](_0x12200a(0x21c))+'\x0a\x0a')+_0x12200a(0x10f),{'parse_mode':_0x12200a(0x249)});break;case _0x12200a(0x285):await this[_0x12200a(0x10e)]?.[_0x12200a(0x1b0)](_0x24a10c,_0x12200a(0x17c)+'ðŸŒ\x20Website:\x20https://trapay.uk/\x0a'+_0x12200a(0x201)+_0x12200a(0x119)+_0x12200a(0x1bf),{'parse_mode':_0x12200a(0x249)});break;case _0x12200a(0x19e):await database_1[_0x12200a(0x270)][_0x12200a(0x223)]['update']({'where':{'telegramId':_0x96e42f},'data':{'shopId':null,'isVerified':![]}}),await this[_0x12200a(0x10e)]?.[_0x12200a(0x1b0)](_0x24a10c,_0x12200a(0x262)+(_0x350304['shop']?.[_0x12200a(0x20d)]||'Unknown')+_0x12200a(0x109)+_0x12200a(0x1b6),{'parse_mode':_0x12200a(0x249)});break;default:_0x232907[_0x12200a(0x189)](_0x12200a(0x134))?await this['handlePaymentLinkFlow'](_0x24a10c,_0x96e42f,_0x232907,_0x3d525b[_0x12200a(0x258)]?.['message_id']):await this[_0x12200a(0x10e)]?.['sendMessage'](_0x24a10c,'âŒ\x20Unknown\x20command');}}catch(_0x18e1c2){console[_0x12200a(0x1dd)]('Error\x20handling\x20callback\x20query:',_0x18e1c2),await this[_0x12200a(0x10e)]?.[_0x12200a(0x1b0)](_0x24a10c,_0x12200a(0x220));}}),this[_0x405326(0x10e)][_0x405326(0x170)](/\/debug/,async _0x370753=>{const _0x3d8d4e=_0x405326,_0x29e9a0=_0x370753['chat']['id'],_0x2fb42e=_0x370753[_0x3d8d4e(0x272)]?.['id'][_0x3d8d4e(0x26d)]();if(!_0x2fb42e)return;try{const _0x253906=await database_1[_0x3d8d4e(0x270)][_0x3d8d4e(0x223)][_0x3d8d4e(0x10b)]({'where':{'telegramId':_0x2fb42e},'include':{'shop':!![]}});let _0x51b489=_0x3d8d4e(0x274);_0x51b489+=_0x3d8d4e(0x183)+_0x2fb42e+_0x3d8d4e(0x233),_0x253906?.[_0x3d8d4e(0x1f7)]&&_0x253906['shop']?(_0x51b489+=_0x3d8d4e(0x29c),_0x51b489+=_0x3d8d4e(0x11b)+_0x253906[_0x3d8d4e(0x1fa)][_0x3d8d4e(0x20d)]+'*\x0a',_0x51b489+=_0x3d8d4e(0x186)+_0x253906[_0x3d8d4e(0x1fa)][_0x3d8d4e(0x1f2)]+'`\x0a',_0x51b489+=_0x3d8d4e(0x28c)+_0x253906[_0x3d8d4e(0x1fa)]['status']+'\x0a\x0a'):_0x51b489+=_0x3d8d4e(0x1a8),_0x51b489+=_0x3d8d4e(0x239),await this[_0x3d8d4e(0x10e)]?.['sendMessage'](_0x29e9a0,_0x51b489,{'parse_mode':_0x3d8d4e(0x249)});}catch(_0x447b21){console[_0x3d8d4e(0x1dd)](_0x3d8d4e(0x127),_0x447b21),await this['bot']?.[_0x3d8d4e(0x1b0)](_0x29e9a0,'âŒ\x20Error\x20getting\x20debug\x20information.');}}),this[_0x405326(0x10e)]['on']('message',async _0x383c4d=>{const _0x492c05=_0x405326;if(_0x383c4d['text']?.[_0x492c05(0x189)]('/'))return;const _0x28ba86=_0x383c4d[_0x492c05(0x136)]['id'],_0x5b899a=_0x383c4d[_0x492c05(0x272)]?.['id'][_0x492c05(0x26d)](),_0x5275bf=_0x383c4d[_0x492c05(0x11c)]?.[_0x492c05(0x1ff)]();if(!_0x5b899a||!_0x5275bf)return;try{const _0x5fffb6=this[_0x492c05(0x125)]['get'](_0x5b899a);if(_0x5fffb6&&_0x5fffb6[_0x492c05(0x112)]==='amount'){const _0x1689e5=parseFloat(_0x5275bf);if(isNaN(_0x1689e5)||_0x1689e5<=0x0){await this[_0x492c05(0x10e)]?.[_0x492c05(0x1b0)](_0x28ba86,'âŒ\x20Invalid\x20amount.\x20Please\x20enter\x20a\x20valid\x20number\x20greater\x20than\x200.');return;}const _0x902507=await database_1[_0x492c05(0x270)][_0x492c05(0x223)][_0x492c05(0x10b)]({'where':{'telegramId':_0x5b899a},'include':{'shop':!![]}});if(!_0x902507?.[_0x492c05(0x27e)]){await this[_0x492c05(0x10e)]?.[_0x492c05(0x1b0)](_0x28ba86,'âŒ\x20Shop\x20not\x20found.\x20Please\x20start\x20over\x20with\x20/start'),this['paymentLinkSessions'][_0x492c05(0x1a0)](_0x5b899a);return;}const _0x4ea6ac=(0x0,gateway_1[_0x492c05(0x147)])(_0x5fffb6[_0x492c05(0x167)])?(0x0,gateway_1[_0x492c05(0x263)])(_0x5fffb6[_0x492c05(0x167)]):_0x5fffb6[_0x492c05(0x167)],_0x5f4aa3={'shopId':_0x902507[_0x492c05(0x27e)],'gateway':_0x4ea6ac,'amount':_0x1689e5,'currency':_0x5fffb6[_0x492c05(0x284)],'type':_0x5fffb6[_0x492c05(0x225)],'status':'ACTIVE'},_0x4f69a2=await database_1['default'][_0x492c05(0x1a7)][_0x492c05(0x1c1)]({'data':_0x5f4aa3});this[_0x492c05(0x125)][_0x492c05(0x1a0)](_0x5b899a);const _0x41e40b=(process.env.FRONTEND_URL||'https://app.trapay.uk')+_0x492c05(0x18a)+_0x4f69a2['id'],_0x1e5e78=_0x41e40b[_0x492c05(0x13a)](/\./g,'\x5c.')[_0x492c05(0x13a)](/-/g,'\x5c-')[_0x492c05(0x13a)](/\//g,'\x5c/');await this[_0x492c05(0x10e)]?.['sendMessage'](_0x28ba86,'âœ…\x20*Payment\x20Link\x20Created\x20Successfully\x5c!*\x0a\x0a'+('ðŸ”—\x20Link:\x20'+_0x1e5e78+'\x0a')+(_0x492c05(0x129)+_0x1689e5+'\x20'+_0x5fffb6[_0x492c05(0x284)]+'\x0a')+(_0x492c05(0x1ee)+_0x5fffb6['gateway']+'\x0a')+('ðŸ”„\x20Type:\x20'+(_0x5fffb6[_0x492c05(0x225)]===_0x492c05(0x13b)?_0x492c05(0x251):_0x492c05(0x244))+'\x0a\x0a')+_0x492c05(0x197),{'parse_mode':_0x492c05(0x16f)});return;}const _0x50bd55=await database_1['default'][_0x492c05(0x223)]['findUnique']({'where':{'telegramId':_0x5b899a},'include':{'shop':!![]}});if(!_0x50bd55){await this[_0x492c05(0x10e)]?.['sendMessage'](_0x28ba86,'âŒ\x20Please\x20use\x20/start\x20command\x20first');return;}if(_0x50bd55[_0x492c05(0x1f7)]&&_0x50bd55[_0x492c05(0x27e)]&&_0x50bd55[_0x492c05(0x1fa)]){await this['bot']?.[_0x492c05(0x1b0)](_0x28ba86,'âœ…\x20You\x20are\x20already\x20connected\x20to\x20shop\x20*'+_0x50bd55[_0x492c05(0x1fa)][_0x492c05(0x20d)]+'*.\x0a\x0a'+_0x492c05(0x234),{'parse_mode':_0x492c05(0x249)});return;}const _0x48061b=_0x5275bf[_0x492c05(0x11d)](/\s+/);if(_0x48061b[_0x492c05(0x20b)]!==0x2){await this[_0x492c05(0x10e)]?.['sendMessage'](_0x28ba86,'âŒ\x20Invalid\x20format.\x20Please\x20send\x20exactly\x202\x20parts\x20separated\x20by\x20space:\x0a\x0a'+_0x492c05(0x16c)+_0x492c05(0x23a)+_0x492c05(0x26b)+(_0x492c05(0x21f)+_0x48061b[_0x492c05(0x20b)]+'\x20parts:\x20'+_0x48061b['map'](_0x2a5444=>'`'+_0x2a5444+'`')['join'](',\x20')),{'parse_mode':_0x492c05(0x249)});return;}const [_0x1c3903,_0x548bd1]=_0x48061b;console[_0x492c05(0x1b7)](_0x492c05(0x1d4)+_0x5b899a+_0x492c05(0x1c2)+_0x1c3903+_0x492c05(0x29a)+_0x548bd1[_0x492c05(0x222)](0x0,0xa)+'...\x22'),await this[_0x492c05(0x21a)](_0x28ba86,_0x5b899a,_0x1c3903,_0x548bd1);}catch(_0x3c2b67){console[_0x492c05(0x1dd)](_0x492c05(0x12e),_0x3c2b67),await this[_0x492c05(0x10e)]?.['sendMessage'](_0x28ba86,_0x492c05(0x220));}}),this[_0x405326(0x10e)]['on'](_0x405326(0x1dd),_0x5e0b7e=>{const _0x4cde95=_0x405326;console[_0x4cde95(0x1dd)](_0x4cde95(0x1fd),_0x5e0b7e);}),this['bot']['on'](_0x405326(0x267),_0x5ba82f=>{const _0x4e6fb1=_0x405326;console[_0x4e6fb1(0x1dd)](_0x4e6fb1(0x230),_0x5ba82f);});}async[a87_0xd41bac(0x21a)](_0xc69a25,_0x28bd6d,_0x318dbf,_0x52dab7){const _0x3b018a=a87_0xd41bac;try{console[_0x3b018a(0x1b7)](_0x3b018a(0x1d4)+_0x28bd6d+':\x20username=\x22'+_0x318dbf+_0x3b018a(0x29a)+_0x52dab7[_0x3b018a(0x222)](0x0,0xa)+_0x3b018a(0x1ea));if(!_0x318dbf||_0x318dbf[_0x3b018a(0x20b)]<0x3||_0x318dbf['length']>0x32||!/^[a-zA-Z0-9_]+$/[_0x3b018a(0x1b2)](_0x318dbf)){await this['bot']?.[_0x3b018a(0x1b0)](_0xc69a25,_0x3b018a(0x14a)+_0x318dbf+_0x3b018a(0x233)+_0x3b018a(0x1b4),{'parse_mode':'Markdown'});return;}if(!_0x52dab7||!_0x52dab7[_0x3b018a(0x189)](_0x3b018a(0x259))&&!_0x52dab7['startsWith'](_0x3b018a(0x19a))){await this[_0x3b018a(0x10e)]?.[_0x3b018a(0x1b0)](_0xc69a25,_0x3b018a(0x248)+_0x3b018a(0x203),{'parse_mode':_0x3b018a(0x249)});return;}const _0x2c3091=await database_1[_0x3b018a(0x270)][_0x3b018a(0x1fa)]['findUnique']({'where':{'username':_0x318dbf},'select':{'id':!![],'name':!![],'username':!![],'status':!![],'publicKey':!![],'secretKey':!![]}});if(!_0x2c3091){const _0x4bcc40=_0x3b018a(0x28d)+_0x318dbf+'`\x20not\x20found.\x0a\x0a'+_0x3b018a(0x163)+_0x3b018a(0x17d);await this[_0x3b018a(0x10e)]?.[_0x3b018a(0x1b0)](_0xc69a25,_0x4bcc40,{'parse_mode':'Markdown'});return;}if(_0x2c3091[_0x3b018a(0x1e0)]!==_0x3b018a(0x12c)){await this['bot']?.['sendMessage'](_0xc69a25,'âŒ\x20Shop\x20`'+_0x318dbf+_0x3b018a(0x238)+'Contact\x20administrator.',{'parse_mode':_0x3b018a(0x249)});return;}if(_0x2c3091[_0x3b018a(0x141)]!==_0x52dab7&&_0x2c3091['secretKey']!==_0x52dab7){await this[_0x3b018a(0x10e)]?.[_0x3b018a(0x1b0)](_0xc69a25,_0x3b018a(0x135)+_0x318dbf+'`.\x0a\x0a'+'Check\x20the\x20key\x20and\x20try\x20again.\x0a\x0a'+_0x3b018a(0x2a1),{'parse_mode':'Markdown'});return;}const _0x289461=await database_1[_0x3b018a(0x270)][_0x3b018a(0x223)][_0x3b018a(0x22e)]({'where':{'shopId':_0x2c3091['id'],'isVerified':!![]}});if(_0x289461>=0x5){await this['bot']?.[_0x3b018a(0x1b0)](_0xc69a25,_0x3b018a(0x146)+_0x318dbf+_0x3b018a(0x22c)+_0x3b018a(0x212),{'parse_mode':_0x3b018a(0x249)});return;}await database_1[_0x3b018a(0x270)][_0x3b018a(0x223)][_0x3b018a(0x14d)]({'where':{'telegramId':_0x28bd6d},'data':{'shopId':_0x2c3091['id'],'isVerified':!![]}}),await this[_0x3b018a(0x10e)]?.[_0x3b018a(0x1b0)](_0xc69a25,_0x3b018a(0x196)+_0x3b018a(0x286)+('ðŸ“±\x20Shop:\x20*'+_0x2c3091[_0x3b018a(0x20d)]+'*\x0a')+(_0x3b018a(0x1f6)+_0x2c3091[_0x3b018a(0x1f2)]+'`\x0a\x0a')+_0x3b018a(0x22a)+_0x3b018a(0x1b3)+_0x3b018a(0x110)+_0x3b018a(0x130)+_0x3b018a(0x195),{'parse_mode':_0x3b018a(0x249),'reply_markup':{'inline_keyboard':[[{'text':_0x3b018a(0x1f8),'callback_data':_0x3b018a(0x1c4)},{'text':'ðŸ’¸\x20Payouts','callback_data':_0x3b018a(0x166)}],[{'text':_0x3b018a(0x28f),'callback_data':_0x3b018a(0x24c)},{'text':_0x3b018a(0x11e),'callback_data':_0x3b018a(0x1b8)}],[{'text':_0x3b018a(0x120),'callback_data':'cmd_contacts'},{'text':_0x3b018a(0x296),'callback_data':_0x3b018a(0x19e)}]]}}),console[_0x3b018a(0x1b7)]('âœ…\x20Telegram\x20user\x20'+_0x28bd6d+_0x3b018a(0x227)+_0x2c3091['username']+_0x3b018a(0x295));}catch(_0x1ec138){console['error'](_0x3b018a(0x20f),_0x1ec138),await this[_0x3b018a(0x10e)]?.[_0x3b018a(0x1b0)](_0xc69a25,'âŒ\x20An\x20error\x20occurred\x20while\x20verifying\x20data.');}}async['sendShopNotification'](_0x363bad,_0x15896b,_0x2af966){const _0x5968dd=a87_0xd41bac;if(!this['bot']){console[_0x5968dd(0x178)](_0x5968dd(0x161));return;}try{const _0x4b84cb=await database_1[_0x5968dd(0x270)][_0x5968dd(0x223)][_0x5968dd(0x115)]({'where':{'shopId':_0x363bad,'isVerified':!![]}});if(_0x4b84cb[_0x5968dd(0x20b)]===0x0){console[_0x5968dd(0x1b7)](_0x5968dd(0x182)+_0x363bad);return;}const _0x78f971=_0x4b84cb[_0x5968dd(0x155)](async _0x3c70cb=>{const _0x41a097=_0x5968dd;try{await this[_0x41a097(0x10e)]?.[_0x41a097(0x1b0)](_0x3c70cb[_0x41a097(0x13e)],_0x15896b,_0x2af966),console['log'](_0x41a097(0x25b)+_0x3c70cb['telegramId']);}catch(_0x9c4592){console[_0x41a097(0x1dd)]('âŒ\x20Failed\x20to\x20send\x20notification\x20to\x20Telegram\x20user\x20'+_0x3c70cb[_0x41a097(0x13e)]+':',_0x9c4592),_0x9c4592 instanceof Error&&(_0x9c4592[_0x41a097(0x258)][_0x41a097(0x16e)](_0x41a097(0x168))||_0x9c4592[_0x41a097(0x258)][_0x41a097(0x16e)](_0x41a097(0x153))||_0x9c4592['message'][_0x41a097(0x16e)](_0x41a097(0x228)))&&(await database_1[_0x41a097(0x270)][_0x41a097(0x223)][_0x41a097(0x14d)]({'where':{'id':_0x3c70cb['id']},'data':{'isVerified':![]}}),console['log'](_0x41a097(0x24e)+_0x3c70cb[_0x41a097(0x13e)]+_0x41a097(0x1fe)));}});await Promise['allSettled'](_0x78f971);}catch(_0x108c85){console['error']('Error\x20sending\x20shop\x20notification:',_0x108c85);}}async[a87_0xd41bac(0x1d7)](_0x45e250,_0xeac229,_0x2603ca){const _0x5c1ff2=a87_0xd41bac,_0x18d390={'created':'ðŸ†•','paid':'âœ…','failed':'âŒ','expired':'â°','refund':'ðŸ”„','chargeback':'âš ï¸','processing':'âš™ï¸'},_0x5697f7={'created':_0x5c1ff2(0x15d),'paid':_0x5c1ff2(0x194),'failed':_0x5c1ff2(0x25d),'expired':'Payment\x20expired','refund':'Payment\x20refund','chargeback':_0x5c1ff2(0x200),'processing':_0x5c1ff2(0x126)},_0x4d4c09=_0x18d390[_0x2603ca],_0x5f1b0a=_0x5697f7[_0x2603ca],_0x5a5d4a=(0x0,gateway_1[_0x5c1ff2(0x2a0)])(_0xeac229['gateway']);console[_0x5c1ff2(0x1b7)](_0x5c1ff2(0x256)+_0xeac229[_0x5c1ff2(0x167)]+_0x5c1ff2(0x281)+_0x5a5d4a+'\x22');let _0x2c2184=_0x4d4c09+'\x20*'+_0x5f1b0a+_0x5c1ff2(0x142)+('ðŸ’°\x20Amount:\x20*'+_0xeac229[_0x5c1ff2(0x252)]+'\x20'+_0xeac229[_0x5c1ff2(0x284)]+'*\x0a')+(_0x5c1ff2(0x218)+(_0xeac229[_0x5c1ff2(0x1d0)]||_0xeac229['id'])+'`\x0a')+(_0x5c1ff2(0x15b)+_0xeac229['id']+'`\x0a')+(_0x5c1ff2(0x28a)+_0x5a5d4a+'`\x0a')+('ðŸ“…\x20Date:\x20'+new Date(_0xeac229[_0x5c1ff2(0x208)])[_0x5c1ff2(0x190)](_0x5c1ff2(0x21c))+'\x0a');if(_0xeac229[_0x5c1ff2(0x17b)]||_0xeac229[_0x5c1ff2(0x293)]||_0xeac229['remitterIban']||_0xeac229['customerIp']||_0xeac229[_0x5c1ff2(0x15e)]){_0x2c2184+='\x0aðŸ‘¤\x20*Customer\x20Information:*\x0a';_0xeac229['customerName']&&(_0x2c2184+=_0x5c1ff2(0x250)+_0xeac229['customerName']+'`\x0a');_0xeac229[_0x5c1ff2(0x293)]&&(_0x2c2184+=_0x5c1ff2(0x1e3)+_0xeac229[_0x5c1ff2(0x293)]+'`\x0a');_0xeac229[_0x5c1ff2(0x18d)]&&(_0x2c2184+='ðŸ¦\x20IBAN:\x20`'+_0xeac229['remitterIban']+'`\x0a');_0xeac229['customerIp']&&(_0x2c2184+=_0x5c1ff2(0x1b9)+_0xeac229['customerIp']+'`\x0a');if(_0xeac229[_0x5c1ff2(0x15e)]){const _0x2d05cf=_0xeac229[_0x5c1ff2(0x15e)][_0x5c1ff2(0x20b)]>0x32?_0xeac229[_0x5c1ff2(0x15e)]['substring'](0x0,0x32)+_0x5c1ff2(0x2a2):_0xeac229[_0x5c1ff2(0x15e)];_0x2c2184+=_0x5c1ff2(0x1c0)+_0x2d05cf+'`\x0a';}}_0x2603ca===_0x5c1ff2(0x19c)&&_0xeac229['chargebackAmount']&&(_0x2c2184+='ðŸ’¸\x20Penalty\x20amount:\x20*'+_0xeac229[_0x5c1ff2(0x192)]+_0x5c1ff2(0x1d2)),_0x2603ca===_0x5c1ff2(0x209)&&(_0x2c2184+=_0x5c1ff2(0x1aa)),_0xeac229['adminNotes']&&(_0x2c2184+=_0x5c1ff2(0x140)+_0xeac229[_0x5c1ff2(0x260)]+'\x0a'),await this[_0x5c1ff2(0x1df)](_0x45e250,_0x2c2184,{'parse_mode':'Markdown'});}async[a87_0xd41bac(0x1c6)](_0x2f543c,_0x970fa8){const _0x5c0eb0=a87_0xd41bac,_0x19f3f9=new Date(_0x970fa8[_0x5c0eb0(0x208)])['toLocaleString'](_0x5c0eb0(0x21c),{'year':_0x5c0eb0(0x198),'month':_0x5c0eb0(0x273),'day':_0x5c0eb0(0x273),'hour':_0x5c0eb0(0x273),'minute':_0x5c0eb0(0x273),'second':_0x5c0eb0(0x273)}),_0x5abcdb='ðŸ’¸\x20*New\x20Payout*\x0a\x0a'+(_0x5c0eb0(0x257)+_0x19f3f9+'\x0a')+(_0x5c0eb0(0x137)+_0x970fa8[_0x5c0eb0(0x252)]+_0x5c0eb0(0x20a))+(_0x5c0eb0(0x1bb)+(_0x970fa8[_0x5c0eb0(0x29d)]||_0x5c0eb0(0x221))+'\x0a')+(_0x5c0eb0(0x1ba)+(_0x970fa8[_0x5c0eb0(0x1fb)]||'Not\x20specified')+'\x0a')+(_0x5c0eb0(0x14f)+(_0x970fa8[_0x5c0eb0(0x25f)]||_0x5c0eb0(0x221))+'`\x0a')+(_0x970fa8['txid']?_0x5c0eb0(0x1d9)+_0x970fa8['txid']+'`':_0x5c0eb0(0x172));await this[_0x5c0eb0(0x1df)](_0x2f543c,_0x5abcdb,{'parse_mode':'Markdown'});}async[a87_0xd41bac(0x1d5)](_0x443836,_0xd6b3fe){const _0x3f7b04=a87_0xd41bac;try{const _0x3d8e0e=await database_1[_0x3f7b04(0x270)]['shopSettings']['findUnique']({'where':{'shopId':_0x443836},'select':{'notificationLogin':!![]}});if(!_0x3d8e0e?.[_0x3f7b04(0x10d)]){console[_0x3f7b04(0x1b7)](_0x3f7b04(0x145)+_0x443836);return;}const _0x511a45=_0xd6b3fe[_0x3f7b04(0x1b5)]?'ðŸ”':'ðŸš¨',_0x190106=_0xd6b3fe[_0x3f7b04(0x1b5)]?'Successful\x20login':_0x3f7b04(0x1a3);let _0x1508d6=_0x511a45+'\x20*'+_0x190106+'*\x0a\x0a'+('ðŸ‘¤\x20Username:\x20`'+_0xd6b3fe['username']+'`\x0a')+(_0x3f7b04(0x254)+_0xd6b3fe[_0x3f7b04(0x27f)][_0x3f7b04(0x190)](_0x3f7b04(0x21c))+'\x0a');_0xd6b3fe['ipAddress']&&(_0x1508d6+='ðŸŒ\x20IP\x20address:\x20`'+_0xd6b3fe['ipAddress']+'`\x0a');_0xd6b3fe[_0x3f7b04(0x288)]&&(_0x1508d6+=_0x3f7b04(0x1d8)+_0xd6b3fe[_0x3f7b04(0x288)]+'\x0a');if(_0xd6b3fe[_0x3f7b04(0x243)]){const _0x2690c3=_0xd6b3fe['userAgent'][_0x3f7b04(0x20b)]>0x32?_0xd6b3fe[_0x3f7b04(0x243)][_0x3f7b04(0x222)](0x0,0x32)+_0x3f7b04(0x2a2):_0xd6b3fe[_0x3f7b04(0x243)];_0x1508d6+='ðŸ’»\x20Browser:\x20`'+_0x2690c3+'`\x0a';}!_0xd6b3fe[_0x3f7b04(0x1b5)]&&(_0x1508d6+=_0x3f7b04(0x114)),await this[_0x3f7b04(0x1df)](_0x443836,_0x1508d6,{'parse_mode':_0x3f7b04(0x249)}),console[_0x3f7b04(0x1b7)](_0x3f7b04(0x277)+_0x443836+':\x20'+(_0xd6b3fe[_0x3f7b04(0x1b5)]?_0x3f7b04(0x1b5):_0x3f7b04(0x278)));}catch(_0x2e1844){console[_0x3f7b04(0x1dd)](_0x3f7b04(0x247),_0x2e1844);}}async[a87_0xd41bac(0x23d)](_0x228bc6,_0x41b677){const _0x486e46=a87_0xd41bac;try{const _0x4f396a=await database_1[_0x486e46(0x270)][_0x486e46(0x169)][_0x486e46(0x10b)]({'where':{'shopId':_0x228bc6},'select':{'notificationApiError':!![]}});if(!_0x4f396a?.[_0x486e46(0x148)]){console[_0x486e46(0x1b7)](_0x486e46(0x113)+_0x228bc6);return;}let _0x52e04c='ðŸš¨\x20*API\x20Error*\x0a\x0a'+(_0x486e46(0x279)+_0x41b677['method']+'\x20'+_0x41b677[_0x486e46(0x1a1)]+'`\x0a')+(_0x486e46(0x254)+_0x41b677['timestamp'][_0x486e46(0x190)](_0x486e46(0x21c))+'\x0a');_0x41b677[_0x486e46(0x15c)]&&(_0x52e04c+=_0x486e46(0x207)+_0x41b677[_0x486e46(0x15c)]+'`\x0a'),_0x52e04c+=_0x486e46(0x1f1)+_0x41b677[_0x486e46(0x1bc)]+'`\x0a',_0x41b677[_0x486e46(0x1cb)]&&(_0x52e04c+='ðŸ†”\x20Request\x20ID:\x20`'+_0x41b677[_0x486e46(0x1cb)]+'`\x0a'),_0x52e04c+=_0x486e46(0x180),await this[_0x486e46(0x1df)](_0x228bc6,_0x52e04c,{'parse_mode':_0x486e46(0x249)}),console['log'](_0x486e46(0x121)+_0x228bc6+':\x20'+_0x41b677['endpoint']);}catch(_0x1d039a){console['error'](_0x486e46(0x111),_0x1d039a);}}async[a87_0xd41bac(0x12b)](_0x4a03c3,_0x230964,_0x50dccb){const _0x6b0564=a87_0xd41bac;let _0x4728b7='ðŸ””\x20*'+_0x230964+_0x6b0564(0x142);for(const [_0x3d3b32,_0x47ea13]of Object[_0x6b0564(0x1ad)](_0x50dccb)){_0x47ea13!==null&&_0x47ea13!==undefined&&(_0x4728b7+=_0x3d3b32+_0x6b0564(0x1f4)+_0x47ea13+'`\x0a');}await this[_0x6b0564(0x1df)](_0x4a03c3,_0x4728b7,{'parse_mode':_0x6b0564(0x249)});}async[a87_0xd41bac(0x26a)](_0x48f6e7){const _0x344d93=a87_0xd41bac;try{console[_0x344d93(0x1b7)](_0x344d93(0x214)+_0x48f6e7[_0x344d93(0x222)](0x0,0x32)+_0x344d93(0x2a2));const _0x1a20bd=await database_1[_0x344d93(0x270)]['telegramUser'][_0x344d93(0x115)]({'select':{'telegramId':!![]}});if(_0x1a20bd[_0x344d93(0x20b)]===0x0){console['log'](_0x344d93(0x1eb));return;}for(const _0x57cbe6 of _0x1a20bd){try{await this[_0x344d93(0x10e)]?.[_0x344d93(0x1b0)](_0x57cbe6[_0x344d93(0x13e)],_0x48f6e7,{'parse_mode':_0x344d93(0x249)});}catch(_0xf1210a){console['error'](_0x344d93(0x23f)+_0x57cbe6[_0x344d93(0x13e)]+':',_0xf1210a);}}console[_0x344d93(0x1b7)](_0x344d93(0x299)+_0x1a20bd[_0x344d93(0x20b)]+_0x344d93(0x138));}catch(_0x3dd849){console['error'](_0x344d93(0x175),_0x3dd849);}}['getBotInfo'](){const _0x1f1ccf=a87_0xd41bac;return{'isActive':!!this[_0x1f1ccf(0x10e)],'username':this[_0x1f1ccf(0x28b)]};}async[a87_0xd41bac(0x297)](_0x1a64d9,_0x519556,_0x45484d,_0x3a7976){const _0x326350=a87_0xd41bac;try{if(!this[_0x326350(0x10e)])return console[_0x326350(0x1dd)](_0x326350(0x160)),![];const _0x48f6e2=await database_1[_0x326350(0x270)][_0x326350(0x223)][_0x326350(0x115)]({'where':{'shopId':_0x1a64d9,'isVerified':!![]},'select':{'telegramId':!![]}});if(_0x48f6e2[_0x326350(0x20b)]===0x0)return console[_0x326350(0x1dd)]('âŒ\x20No\x20verified\x20Telegram\x20users\x20found\x20for\x20shop\x20ID:\x20'+_0x1a64d9),![];let _0x3120b6=0x0;for(const _0x58ec0c of _0x48f6e2){try{await this['bot'][_0x326350(0x226)](_0x58ec0c[_0x326350(0x13e)],_0x519556,{},{'filename':_0x45484d,'contentType':_0x45484d[_0x326350(0x204)](_0x326350(0x276))?_0x326350(0x1fc):_0x45484d[_0x326350(0x204)](_0x326350(0x240))||_0x45484d[_0x326350(0x204)](_0x326350(0x193))?'image/jpeg':_0x45484d[_0x326350(0x204)](_0x326350(0x1cf))?_0x326350(0x20e):_0x326350(0x151)}),_0x3a7976&&await this['bot']['sendMessage'](_0x58ec0c['telegramId'],_0x3a7976),_0x3120b6++;}catch(_0x138643){console[_0x326350(0x1dd)](_0x326350(0x265)+_0x58ec0c[_0x326350(0x13e)]+':',_0x138643);}}return console['log'](_0x326350(0x131)+_0x3120b6+'/'+_0x48f6e2[_0x326350(0x20b)]+_0x326350(0x29b)+_0x1a64d9+':\x20'+_0x45484d),_0x3120b6>0x0;}catch(_0x95a504){return console['error'](_0x326350(0x117),_0x95a504),![];}}async[a87_0xd41bac(0x19d)](_0x2edbb1,_0x25dd8b){const _0x35f7c1=a87_0xd41bac;try{if(!this[_0x35f7c1(0x10e)])return console[_0x35f7c1(0x1dd)]('âŒ\x20Telegram\x20bot\x20not\x20initialized'),![];return await this[_0x35f7c1(0x10e)][_0x35f7c1(0x1b0)](_0x2edbb1,_0x25dd8b),console[_0x35f7c1(0x1b7)]('âœ…\x20Direct\x20message\x20sent\x20to\x20chat\x20'+_0x2edbb1),!![];}catch(_0x3f8f3f){return console[_0x35f7c1(0x1dd)]('âŒ\x20Error\x20sending\x20direct\x20message:',_0x3f8f3f),![];}}async[a87_0xd41bac(0x139)](_0x3a8db5,_0x2fca03,_0x3afd98,_0x3d2f21){const _0xc251ce=a87_0xd41bac;try{if(!this[_0xc251ce(0x10e)])return console['error']('âŒ\x20Telegram\x20bot\x20not\x20initialized'),![];return await this[_0xc251ce(0x10e)][_0xc251ce(0x226)](_0x3a8db5,_0x2fca03,{},{'filename':_0x3afd98,'contentType':_0x3afd98['endsWith'](_0xc251ce(0x276))?_0xc251ce(0x1fc):_0x3afd98[_0xc251ce(0x204)](_0xc251ce(0x240))||_0x3afd98[_0xc251ce(0x204)]('.jpeg')?'image/jpeg':_0x3afd98[_0xc251ce(0x204)](_0xc251ce(0x1cf))?_0xc251ce(0x20e):'application/octet-stream'}),_0x3d2f21&&await this[_0xc251ce(0x10e)][_0xc251ce(0x1b0)](_0x3a8db5,_0x3d2f21),console[_0xc251ce(0x1b7)](_0xc251ce(0x1de)+_0x3a8db5+':\x20'+_0x3afd98),!![];}catch(_0x5786e2){return console[_0xc251ce(0x1dd)](_0xc251ce(0x144),_0x5786e2),![];}}async[a87_0xd41bac(0x24b)](_0x2530da,_0x1d19d9,_0x13cd32,_0x4907ba){const _0x347c5c=a87_0xd41bac,_0x17a7e4=this[_0x347c5c(0x125)][_0x347c5c(0x229)](_0x1d19d9)||{};try{if(_0x13cd32===_0x347c5c(0x211)){this[_0x347c5c(0x125)]['delete'](_0x1d19d9),await this['bot']?.[_0x347c5c(0x13d)](_0x347c5c(0x171),{'chat_id':_0x2530da,'message_id':_0x4907ba});return;}if(_0x13cd32===_0x347c5c(0x17e)){await this[_0x347c5c(0x264)](_0x2530da,_0x1d19d9,_0x4907ba,0x1);return;}if(_0x13cd32['startsWith'](_0x347c5c(0x156))){const _0x2d8e70=parseInt(_0x13cd32[_0x347c5c(0x13a)](_0x347c5c(0x156),''));await this[_0x347c5c(0x264)](_0x2530da,_0x1d19d9,_0x4907ba,_0x2d8e70);return;}if(_0x13cd32==='pl_create_new'){const _0x216cfd=await database_1[_0x347c5c(0x270)][_0x347c5c(0x223)][_0x347c5c(0x10b)]({'where':{'telegramId':_0x1d19d9},'include':{'shop':!![]}});if(!_0x216cfd?.['shop']?.['paymentGateways']){await this['bot']?.[_0x347c5c(0x13d)](_0x347c5c(0x1ab),{'chat_id':_0x2530da,'message_id':_0x4907ba});return;}let _0x477028;try{_0x477028=JSON['parse'](_0x216cfd['shop'][_0x347c5c(0x14c)]);}catch{_0x477028=_0x216cfd[_0x347c5c(0x1fa)][_0x347c5c(0x14c)][_0x347c5c(0x11d)](',')['filter'](_0x1fb829=>_0x1fb829[_0x347c5c(0x1ff)]());}if(_0x477028[_0x347c5c(0x20b)]===0x0){await this[_0x347c5c(0x10e)]?.['editMessageText'](_0x347c5c(0x13c),{'chat_id':_0x2530da,'message_id':_0x4907ba});return;}this[_0x347c5c(0x125)]['set'](_0x1d19d9,{'step':'gateway'});const _0x2f7971=_0x477028[_0x347c5c(0x155)](_0x5b7a6e=>{const _0x35cc6c=_0x347c5c,_0x2dbe64=Object['keys'](gateway_1[_0x35cc6c(0x23e)])[_0x35cc6c(0x199)](_0x3b72c3=>gateway_1[_0x35cc6c(0x23e)][_0x3b72c3]===_0x5b7a6e)||_0x5b7a6e;return[{'text':_0x35cc6c(0x184)+_0x2dbe64,'callback_data':_0x35cc6c(0x14e)+_0x2dbe64}];});await this[_0x347c5c(0x10e)]?.['editMessageText']('ðŸ”—\x20*Create\x20Payment\x20Link*\x0a\x0aStep\x201/4:\x20Select\x20gateway',{'chat_id':_0x2530da,'message_id':_0x4907ba,'parse_mode':'Markdown','reply_markup':{'inline_keyboard':[..._0x2f7971,[{'text':_0x347c5c(0x280),'callback_data':'pl_cancel'}]]}});return;}if(_0x13cd32['startsWith'](_0x347c5c(0x14e))){const _0x7390fc=_0x13cd32[_0x347c5c(0x13a)](_0x347c5c(0x14e),'');_0x17a7e4['gateway']=_0x7390fc,_0x17a7e4[_0x347c5c(0x112)]='type',this[_0x347c5c(0x125)][_0x347c5c(0x269)](_0x1d19d9,_0x17a7e4),await this[_0x347c5c(0x10e)]?.[_0x347c5c(0x13d)](_0x347c5c(0x215)+_0x347c5c(0x206),{'chat_id':_0x2530da,'message_id':_0x4907ba,'parse_mode':_0x347c5c(0x249),'reply_markup':{'inline_keyboard':[[{'text':'ðŸ”‚\x20Single\x20Use','callback_data':_0x347c5c(0x1be)}],[{'text':_0x347c5c(0x108),'callback_data':'pl_type_multi'}],[{'text':_0x347c5c(0x280),'callback_data':_0x347c5c(0x211)}]]}});return;}if(_0x13cd32[_0x347c5c(0x189)]('pl_type_')){const _0x890755=_0x13cd32[_0x347c5c(0x13a)](_0x347c5c(0x25c),'')[_0x347c5c(0x187)]();_0x17a7e4[_0x347c5c(0x225)]=_0x890755,_0x17a7e4[_0x347c5c(0x112)]=_0x347c5c(0x284),this[_0x347c5c(0x125)]['set'](_0x1d19d9,_0x17a7e4);const _0x8f4034=this[_0x347c5c(0x241)](_0x17a7e4[_0x347c5c(0x167)]),_0x1f7bee=_0x8f4034[_0x347c5c(0x24d)](0x0,0x14)[_0x347c5c(0x155)](_0xe0a0a=>[{'text':_0xe0a0a,'callback_data':_0x347c5c(0x18b)+_0xe0a0a}]);await this['bot']?.[_0x347c5c(0x13d)](_0x347c5c(0x215)+'Step\x203/4:\x20Select\x20currency',{'chat_id':_0x2530da,'message_id':_0x4907ba,'parse_mode':_0x347c5c(0x249),'reply_markup':{'inline_keyboard':[..._0x1f7bee,[{'text':_0x347c5c(0x280),'callback_data':_0x347c5c(0x211)}]]}});return;}if(_0x13cd32[_0x347c5c(0x189)](_0x347c5c(0x18b))){const _0x4dc9cb=_0x13cd32[_0x347c5c(0x13a)]('pl_curr_','');_0x17a7e4[_0x347c5c(0x284)]=_0x4dc9cb,_0x17a7e4['step']=_0x347c5c(0x252),this[_0x347c5c(0x125)]['set'](_0x1d19d9,_0x17a7e4),await this[_0x347c5c(0x10e)]?.['editMessageText']('ðŸ”—\x20*Create\x20Payment\x20Link*\x0a\x0a'+'Step\x204/4:\x20Enter\x20amount\x0a\x0a'+(_0x347c5c(0x19b)+_0x4dc9cb+_0x347c5c(0x292)),{'chat_id':_0x2530da,'message_id':_0x4907ba,'parse_mode':'Markdown'});return;}}catch(_0x1a3d2c){console[_0x347c5c(0x1dd)](_0x347c5c(0x1f9),_0x1a3d2c),await this[_0x347c5c(0x10e)]?.[_0x347c5c(0x1b0)](_0x2530da,'âŒ\x20An\x20error\x20occurred.\x20Please\x20try\x20again.'),this[_0x347c5c(0x125)][_0x347c5c(0x1a0)](_0x1d19d9);}}async[a87_0xd41bac(0x264)](_0x47fc0c,_0x5e6f45,_0xa39420,_0xc586b4=0x1){const _0x2e2ae3=a87_0xd41bac;try{const _0x2ba4e2=await database_1[_0x2e2ae3(0x270)][_0x2e2ae3(0x223)][_0x2e2ae3(0x10b)]({'where':{'telegramId':_0x5e6f45},'include':{'shop':!![]}});if(!_0x2ba4e2?.[_0x2e2ae3(0x27e)]){await this[_0x2e2ae3(0x10e)]?.[_0x2e2ae3(0x1b0)](_0x47fc0c,_0x2e2ae3(0x1c5));return;}const _0x35af04=0x5,_0x36e971=(_0xc586b4-0x1)*_0x35af04,[_0x13c420,_0x5c30bd]=await Promise[_0x2e2ae3(0x1d3)]([database_1['default']['paymentLink'][_0x2e2ae3(0x115)]({'where':{'shopId':_0x2ba4e2['shopId']},'orderBy':{'createdAt':_0x2e2ae3(0x298)},'take':_0x35af04,'skip':_0x36e971}),database_1[_0x2e2ae3(0x270)][_0x2e2ae3(0x1a7)][_0x2e2ae3(0x22e)]({'where':{'shopId':_0x2ba4e2['shopId']}})]),_0x435ee2=Math['ceil'](_0x5c30bd/_0x35af04);if(_0x13c420['length']===0x0){const _0x257a18='ðŸ“‹\x20*Payment\x20Links*\x0a\x0aNo\x20payment\x20links\x20found\x5c.\x0a\x0aCreate\x20your\x20first\x20payment\x20link\x5c!';_0xa39420?await this[_0x2e2ae3(0x10e)]?.[_0x2e2ae3(0x13d)](_0x257a18,{'chat_id':_0x47fc0c,'message_id':_0xa39420,'parse_mode':_0x2e2ae3(0x16f),'reply_markup':{'inline_keyboard':[[{'text':_0x2e2ae3(0x1e2),'callback_data':_0x2e2ae3(0x1c3)}]]}}):await this[_0x2e2ae3(0x10e)]?.[_0x2e2ae3(0x1b0)](_0x47fc0c,_0x257a18,{'parse_mode':_0x2e2ae3(0x16f),'reply_markup':{'inline_keyboard':[[{'text':'âž•\x20Create\x20New\x20Link','callback_data':'pl_create_new'}]]}});return;}let _0x506b2c=_0x2e2ae3(0x289)+_0xc586b4+'/'+_0x435ee2+_0x2e2ae3(0x26e);_0x13c420[_0x2e2ae3(0x15f)]((_0x1729cb,_0x50a87a)=>{const _0x2bff2a=_0x2e2ae3,_0x252297=_0x36e971+_0x50a87a+0x1,_0x1d00c0=_0x1729cb[_0x2bff2a(0x252)]?_0x1729cb[_0x2bff2a(0x252)]+'\x20'+_0x1729cb[_0x2bff2a(0x284)]:_0x2bff2a(0x12f),_0x820b9f=_0x1729cb[_0x2bff2a(0x1e0)]==='ACTIVE'?'âœ…':'âŒ',_0x57f85c=(process.env.FRONTEND_URL||_0x2bff2a(0x10a))+'/link/'+_0x1729cb['id'],_0x59a755=_0x57f85c[_0x2bff2a(0x13a)](/\./g,'\x5c.')[_0x2bff2a(0x13a)](/-/g,'\x5c-')['replace'](/\//g,'\x5c/');_0x506b2c+=_0x252297+_0x2bff2a(0x154)+_0x820b9f+'\x20*'+_0x1d00c0+'*\x0a',_0x506b2c+=_0x2bff2a(0x116)+_0x1729cb[_0x2bff2a(0x167)]+_0x2bff2a(0x1db)+_0x1729cb[_0x2bff2a(0x225)]+'\x0a',_0x506b2c+=_0x2bff2a(0x1ef)+_0x59a755+_0x2bff2a(0x11a);});const _0x51d36d=[];_0xc586b4>0x1&&_0x51d36d['push']({'text':_0x2e2ae3(0x22d),'callback_data':'pl_page_'+(_0xc586b4-0x1)});_0xc586b4<_0x435ee2&&_0x51d36d[_0x2e2ae3(0x1ec)]({'text':_0x2e2ae3(0x123),'callback_data':_0x2e2ae3(0x156)+(_0xc586b4+0x1)});const _0x4cb582=[];_0x51d36d[_0x2e2ae3(0x20b)]>0x0&&_0x4cb582[_0x2e2ae3(0x1ec)](_0x51d36d),_0x4cb582[_0x2e2ae3(0x1ec)]([{'text':_0x2e2ae3(0x1e2),'callback_data':'pl_create_new'}]),_0x4cb582[_0x2e2ae3(0x1ec)]([{'text':_0x2e2ae3(0x210),'callback_data':_0x2e2ae3(0x211)}]),_0xa39420?await this[_0x2e2ae3(0x10e)]?.[_0x2e2ae3(0x13d)](_0x506b2c,{'chat_id':_0x47fc0c,'message_id':_0xa39420,'parse_mode':_0x2e2ae3(0x16f),'reply_markup':{'inline_keyboard':_0x4cb582}}):await this[_0x2e2ae3(0x10e)]?.[_0x2e2ae3(0x1b0)](_0x47fc0c,_0x506b2c,{'parse_mode':_0x2e2ae3(0x16f),'reply_markup':{'inline_keyboard':_0x4cb582}});}catch(_0x17c4c8){console[_0x2e2ae3(0x1dd)](_0x2e2ae3(0x181),_0x17c4c8),await this[_0x2e2ae3(0x10e)]?.[_0x2e2ae3(0x1b0)](_0x47fc0c,_0x2e2ae3(0x1e6));}}[a87_0xd41bac(0x241)](_0x3553c4){const _0x5c33dd=a87_0xd41bac,_0x5ed58b={'1000':[_0x5c33dd(0x23b),_0x5c33dd(0x20c),_0x5c33dd(0x107)],'0001':[_0x5c33dd(0x107),_0x5c33dd(0x23b),_0x5c33dd(0x20c),_0x5c33dd(0x1f0),_0x5c33dd(0x290)],'0010':['USD','EUR','GBP',_0x5c33dd(0x1f0),_0x5c33dd(0x290)],'1111':[_0x5c33dd(0x23b)],'0000':['EUR','USD',_0x5c33dd(0x290),_0x5c33dd(0x1f0),_0x5c33dd(0x20c),_0x5c33dd(0x173),'JPY'],'1110':[_0x5c33dd(0x23b),_0x5c33dd(0x107),_0x5c33dd(0x20c)],'2000':[_0x5c33dd(0x23b)],'2001':['EUR'],'2010':[_0x5c33dd(0x23b)],'2011':[_0x5c33dd(0x1f0)],'2002':[_0x5c33dd(0x253)],'3000':['TRY',_0x5c33dd(0x2a3),_0x5c33dd(0x23b),_0x5c33dd(0x107),_0x5c33dd(0x290),_0x5c33dd(0x1a5),_0x5c33dd(0x283),'CAD',_0x5c33dd(0x20c),_0x5c33dd(0x27d),'INR'],'3001':[_0x5c33dd(0x107),'EUR'],'3002':[_0x5c33dd(0x23b),_0x5c33dd(0x107),_0x5c33dd(0x2a3),_0x5c33dd(0x20c),'AUD',_0x5c33dd(0x1f0),_0x5c33dd(0x1a4),_0x5c33dd(0x124)],'3004':[_0x5c33dd(0x118),'BTC',_0x5c33dd(0x150),'USDC',_0x5c33dd(0x1e4),_0x5c33dd(0x1ae),_0x5c33dd(0x13f),'LTC',_0x5c33dd(0x174),_0x5c33dd(0x152)]};return _0x5ed58b[_0x3553c4]||[_0x5c33dd(0x107)];}[a87_0xd41bac(0x24a)](){const _0x1b529c=a87_0xd41bac;this['bot']&&(this[_0x1b529c(0x10e)]['stopPolling'](),this[_0x1b529c(0x10e)]=null,console[_0x1b529c(0x1b7)](_0x1b529c(0x19f)));}}exports[a87_0xd41bac(0x1e8)]=TelegramBotService,exports[a87_0xd41bac(0x16a)]=new TelegramBotService();