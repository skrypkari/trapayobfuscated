'use strict';function a49_0x740b(){const _0x5d069c=['sk_','.\x20*','forEach','üõë\x20Telegram\x20bot\x20stopped','secretKey','TELEGRAM_BOT_TOKEN','\x22\x20->\x20display\x20\x22','env','timestamp','Failed\x20to\x20send\x20API\x20error\x20notification:','entries','Error\x20handling\x20/status\x20command:','allSettled','pk_','Use\x20/start\x20to\x20begin.','...','findFirst','sendLoginNotification','üè™\x20Available\x20shops\x20in\x20system:\x0a','blocked','stopBot','Payment\x20chargeback','2249312ClOBWx','‚ùå\x20Invalid\x20username\x20format:\x20`','üí∏\x20Penalty\x20amount:\x20*','failed','Check\x20the\x20key\x20and\x20try\x20again.\x0a\x0a','üìä\x20Error\x20code:\x20`','onText','from','266704yXOeTv','TelegramBotService','‚ùå\x20Invalid\x20API\x20key\x20format.\x0a\x0a','endpoint','substring','TELEGRAM_BOT_TOKEN\x20not\x20found\x20in\x20environment\x20variables','chat','/disconnect\x20-\x20disconnect\x20from\x20notifications','botToken','No\x20verified\x20Telegram\x20users\x20found\x20for\x20shop\x20','\x0a‚ö†Ô∏è\x20If\x20this\x20wasn\x27t\x20you,\x20change\x20your\x20password\x20immediately!','üì±\x20Telegram\x20notification:\x20gateway\x20\x22','en-US','polling_error','User\x20','üí∏\x20Amount:\x20*','‚úÖ\x20You\x20have\x20been\x20successfully\x20connected\x20to\x20the\x20notification\x20system!\x0a\x0a','default','userAgent','1614LCASDp','üîî\x20You\x20will\x20now\x20receive\x20notifications\x20about:\x0a','telegramId','‚ùå\x20Failed\x20to\x20initialize\x20Telegram\x20bot:','shop','üì±\x20API\x20error\x20notifications\x20disabled\x20for\x20shop\x20','‚úÖ\x20API\x20error\x20notification\x20sent\x20for\x20shop\x20','customerName','‚úÖ\x20You\x20are\x20already\x20connected\x20to\x20shop\x20*','ACTIVE','Error\x20in\x20handleSingleLineVerification:','chargebackAmount','New\x20payout\x20created','trim','toString','...\x22','create','üí∞\x20Amount:\x20*','map','orderId','\x20disconnected\x20from\x20shop\x20','adminNotes','Payment\x20is\x20being\x20processed','üîî\x20Notifications\x20are\x20active\x0a\x0a','Expected\x20key\x20format:\x20`pk_...`\x20or\x20`sk_...`','‚ùå\x20You\x20are\x20not\x20connected\x20to\x20a\x20shop.\x0a\x0a','first_name','üîå\x20User\x20','\x20via\x20single-line\x20input','errorMessage','`\x20not\x20found.\x0a\x0a','message','\x20USDT*\x0a','‚úÖ\x20Notification\x20sent\x20to\x20Telegram\x20user\x20','Failed\x20login\x20attempt','sendShopNotification','üè™\x20Gateway:\x20`','üö®\x20*API\x20Error*\x0a\x0a','txid','You\x20are\x20already\x20connected\x20to\x20shop:\x20*','‚ùå\x20API\x20key\x20does\x20not\x20match\x20shop\x20`','statusCode','\x20\x20\x20Username:\x20`','‚úÖ\x20Login\x20notification\x20sent\x20for\x20shop\x20','../types/gateway','method','üë§\x20Username:\x20`','*.\x0a\x0a','notificationApiError','Error\x20sending\x20shop\x20notification:','3218633obyIyw','üÜî\x20Payment\x20ID:\x20`','join','`.\x0a\x0a','Payment\x20expired','üìù\x20Notes:\x20','ipAddress','‚ùå\x20You\x20are\x20not\x20registered\x20in\x20the\x20system.\x0a\x0a','üì±\x20Your\x20Telegram\x20ID:\x20`','setupBotHandlers','‚ùå\x20Please\x20use\x20/start\x20command\x20first','\x0aüí°\x20Check\x20your\x20request\x20or\x20contact\x20support.','ü§ñ\x20Welcome\x20to\x20TRAPAY\x20notification\x20system!\x0a\x0a','üîî\x20You\x20receive\x20notifications\x20about:\x0a','üîó\x20TXID:\x20`','/status\x20-\x20check\x20connection\x20status\x0a','shopSettings','text','Successful\x20login','chargeback','\x20parts:\x20','bot','__esModule','telegramBotService','error','Payment\x20successfully\x20paid','split','user\x20is\x20deactivated','174027JKEBMr','startsWith','update','‚ùå\x20An\x20error\x20occurred\x20while\x20verifying\x20data.','last_name','toLocaleDateString','name','`\x0a\x0a','sendMessage','üìä\x20*Connection\x20Status*\x0a\x0a','‚úÖ\x20Welcome\x20back!\x0a\x0a','\x20\x20\x20Public\x20Key:\x20`','‚ùå\x20Another\x20Telegram\x20account\x20is\x20already\x20connected\x20to\x20shop\x20`','üîî\x20*','\x22,\x20apiKey=\x22','Disconnect\x20the\x20previous\x20account\x20first\x20or\x20contact\x20administrator.','\x0aüë§\x20*Customer\x20Information:*\x0a','requestId','updatedAt','currency','501300woFFGr','amount','üìÖ\x20Date:\x20','‚Ä¢\x20`','TELEGRAM_BOT_USERNAME','You\x20sent\x20','initializeBot','*\x0a\x0a','`appple\x20pk_aa6450d3f57afbefbb0f3f5be5ce6cca13037536afc5ccf14c81a6cbc7a07de5`\x0a\x0a','defineProperty','‚ùóÔ∏è\x20Make\x20sure\x20to\x20separate\x20username\x20and\x20API\x20key\x20with\x20a\x20space!','toLocaleString','‚Ä¢\x20Payouts\x0a\x0a','Use\x20/start\x20to\x20connect.','‚úÖ\x20You\x20have\x20been\x20successfully\x20disconnected\x20from\x20shop\x20*','`\x20(','üéâ\x20*Congratulations!*\x0a\x0a','node-telegram-bot-api','Telegram\x20bot\x20not\x20initialized,\x20cannot\x20send\x20notification','processing','Telegram\x20bot\x20error:','Telegram\x20bot\x20polling\x20error:','üìÖ\x20Connection\x20date:\x20','4nALELr','includes','üì±\x20Created\x20new\x20Telegram\x20user:\x20','‚ùå\x20Failed\x20to\x20send\x20notification\x20to\x20Telegram\x20user\x20','‚ùå\x20Invalid\x20format.\x20Please\x20send\x20exactly\x202\x20parts\x20separated\x20by\x20space:\x0a\x0a','‚ùå\x20An\x20error\x20occurred.\x20Please\x20try\x20again\x20later.','publicKey','7CdVaRC','username','sendCustomNotification','trapay_bot','customerEmail','üìù\x20Order\x20ID:\x20`','üè¶\x20Method:\x20`','‚Ä¢\x20Important\x20events\x0a\x0a','üåê\x20IP\x20address:\x20`','Failed\x20to\x20send\x20login\x20notification:','Username\x20must\x20contain\x20only\x20letters,\x20numbers\x20and\x20underscore\x20(3-50\x20characters).','Available\x20usernames:\x0a','To\x20receive\x20payment\x20notifications,\x20send\x20your\x20credentials\x20in\x20one\x20line:\x0a\x0a','‚Ä¢\x20Payment\x20status\x20changes\x0a','Payment\x20failed','gateway','Payout\x20rejected','Payment\x20refund','\x20initialized\x20successfully','success',':\x20`','createdAt','isVerified','notificationLogin','sendPayoutNotification','stopPolling','botUsername','üìù\x20Format:\x20`username\x20api_key`\x0a\x0a','Error\x20handling\x20/disconnect\x20command:','log','‚ùå\x20You\x20are\x20not\x20connected\x20to\x20the\x20notification\x20system.','findMany','shopId','New\x20payment\x20created','450910nHOzMl','getBotInfo','unknown\x20shop','6475JVWMzs','findUnique','üîÑ\x20Processing\x20single-line\x20verification\x20for\x20user\x20','54sOzeWa','handleSingleLineVerification','length','üîç\x20*Debug\x20Information*\x0a\x0a','Markdown','üìß\x20Email:\x20`','telegramUser','üìÖ\x20Time:\x20','\x20\x20\x20Status:\x20','Payout\x20completed'];a49_0x740b=function(){return _0x5d069c;};return a49_0x740b();}const a49_0x1c8d17=a49_0x22c6;(function(_0x4fec2b,_0x22bc3b){const _0x1d4968=a49_0x22c6,_0x19eb10=_0x4fec2b();while(!![]){try{const _0x5d1b2b=-parseInt(_0x1d4968(0x1e1))/0x1*(-parseInt(_0x1d4968(0x20c))/0x2)+-parseInt(_0x1d4968(0x1f5))/0x3+parseInt(_0x1d4968(0x180))/0x4+parseInt(_0x1d4968(0x155))/0x5*(-parseInt(_0x1d4968(0x193))/0x6)+-parseInt(_0x1d4968(0x213))/0x7*(-parseInt(_0x1d4968(0x178))/0x8)+-parseInt(_0x1d4968(0x158))/0x9*(parseInt(_0x1d4968(0x152))/0xa)+parseInt(_0x1d4968(0x1c5))/0xb;if(_0x5d1b2b===_0x22bc3b)break;else _0x19eb10['push'](_0x19eb10['shift']());}catch(_0x1ef58c){_0x19eb10['push'](_0x19eb10['shift']());}}}(a49_0x740b,0x31700));var __importDefault=this&&this['__importDefault']||function(_0x49be27){return _0x49be27&&_0x49be27['__esModule']?_0x49be27:{'default':_0x49be27};};Object[a49_0x1c8d17(0x1fe)](exports,a49_0x1c8d17(0x1db),{'value':!![]}),exports[a49_0x1c8d17(0x1dc)]=exports[a49_0x1c8d17(0x181)]=void 0x0;const node_telegram_bot_api_1=__importDefault(require(a49_0x1c8d17(0x206))),database_1=__importDefault(require('../config/database')),gateway_1=require(a49_0x1c8d17(0x1bf));class TelegramBotService{constructor(){const _0x5af454=a49_0x1c8d17;this[_0x5af454(0x1da)]=null,this['botToken']=process[_0x5af454(0x169)][_0x5af454(0x167)]||'',this['botUsername']=process[_0x5af454(0x169)][_0x5af454(0x1f9)]||_0x5af454(0x133),this[_0x5af454(0x188)]?this[_0x5af454(0x1fb)]():console['warn'](_0x5af454(0x185));}[a49_0x1c8d17(0x1fb)](){const _0xf7cba9=a49_0x1c8d17;try{this[_0xf7cba9(0x1da)]=new node_telegram_bot_api_1[(_0xf7cba9(0x191))](this[_0xf7cba9(0x188)],{'polling':!![]}),this[_0xf7cba9(0x1ce)](),console[_0xf7cba9(0x14d)]('‚úÖ\x20Telegram\x20bot\x20@'+this[_0xf7cba9(0x14a)]+_0xf7cba9(0x142));}catch(_0x426647){console['error'](_0xf7cba9(0x196),_0x426647);}}[a49_0x1c8d17(0x1ce)](){const _0x12c8ae=a49_0x1c8d17;if(!this[_0x12c8ae(0x1da)])return;this[_0x12c8ae(0x1da)][_0x12c8ae(0x17e)](/\/start/,async _0x575fba=>{const _0x15e2dc=_0x12c8ae,_0x45aa80=_0x575fba[_0x15e2dc(0x186)]['id'],_0x32fda3=_0x575fba[_0x15e2dc(0x17f)]?.['id'][_0x15e2dc(0x1a1)](),_0x3ac2f9=_0x575fba[_0x15e2dc(0x17f)]?.['username'],_0x5050e4=_0x575fba['from']?.[_0x15e2dc(0x1ad)],_0x5521bc=_0x575fba[_0x15e2dc(0x17f)]?.[_0x15e2dc(0x1e5)];if(!_0x32fda3)return;try{let _0x54ec3c=await database_1[_0x15e2dc(0x191)]['telegramUser'][_0x15e2dc(0x156)]({'where':{'telegramId':_0x32fda3},'include':{'shop':!![]}});!_0x54ec3c?(_0x54ec3c=await database_1[_0x15e2dc(0x191)][_0x15e2dc(0x15e)][_0x15e2dc(0x1a3)]({'data':{'telegramId':_0x32fda3,'username':_0x3ac2f9,'firstName':_0x5050e4,'lastName':_0x5521bc,'isVerified':![],'shopId':null},'include':{'shop':!![]}}),console[_0x15e2dc(0x14d)](_0x15e2dc(0x20e)+_0x32fda3+'\x20(@'+_0x3ac2f9+')')):_0x54ec3c=await database_1[_0x15e2dc(0x191)][_0x15e2dc(0x15e)][_0x15e2dc(0x1e3)]({'where':{'telegramId':_0x32fda3},'data':{'username':_0x3ac2f9,'firstName':_0x5050e4,'lastName':_0x5521bc},'include':{'shop':!![]}}),_0x54ec3c[_0x15e2dc(0x146)]&&_0x54ec3c[_0x15e2dc(0x150)]&&_0x54ec3c[_0x15e2dc(0x197)]?await this[_0x15e2dc(0x1da)]?.[_0x15e2dc(0x1e9)](_0x45aa80,_0x15e2dc(0x1eb)+(_0x15e2dc(0x1ba)+_0x54ec3c[_0x15e2dc(0x197)]['name']+'*\x0a')+('Username:\x20`'+_0x54ec3c[_0x15e2dc(0x197)][_0x15e2dc(0x214)]+'`\x0a\x0a')+_0x15e2dc(0x1d2)+'‚Ä¢\x20New\x20payments\x0a'+_0x15e2dc(0x13d)+_0x15e2dc(0x201)+'Commands:\x0a'+_0x15e2dc(0x1d4)+_0x15e2dc(0x187),{'parse_mode':_0x15e2dc(0x15c)}):(_0x54ec3c[_0x15e2dc(0x150)]&&!_0x54ec3c[_0x15e2dc(0x146)]&&(await database_1[_0x15e2dc(0x191)][_0x15e2dc(0x15e)]['update']({'where':{'telegramId':_0x32fda3},'data':{'shopId':null,'isVerified':![]}}),console[_0x15e2dc(0x14d)]('üîÑ\x20Reset\x20incomplete\x20verification\x20for\x20user\x20'+_0x32fda3)),await this['bot']?.[_0x15e2dc(0x1e9)](_0x45aa80,_0x15e2dc(0x1d1)+_0x15e2dc(0x13c)+'üìù\x20Format:\x20`username\x20api_key`\x0a\x0a'+'Example:\x0a'+_0x15e2dc(0x1fd)+_0x15e2dc(0x1ff),{'parse_mode':_0x15e2dc(0x15c)}));}catch(_0x1bedf4){console[_0x15e2dc(0x1dd)]('Error\x20handling\x20/start\x20command:',_0x1bedf4),await this[_0x15e2dc(0x1da)]?.[_0x15e2dc(0x1e9)](_0x45aa80,'‚ùå\x20An\x20error\x20occurred.\x20Please\x20try\x20again\x20later.');}}),this[_0x12c8ae(0x1da)][_0x12c8ae(0x17e)](/\/disconnect/,async _0x1236f3=>{const _0x1f9b6f=_0x12c8ae,_0x124600=_0x1236f3['chat']['id'],_0x52afde=_0x1236f3[_0x1f9b6f(0x17f)]?.['id'][_0x1f9b6f(0x1a1)]();if(!_0x52afde)return;try{const _0x24120e=await database_1[_0x1f9b6f(0x191)][_0x1f9b6f(0x15e)]['findUnique']({'where':{'telegramId':_0x52afde},'include':{'shop':!![]}});if(!_0x24120e||!_0x24120e[_0x1f9b6f(0x146)]||!_0x24120e[_0x1f9b6f(0x150)]){await this[_0x1f9b6f(0x1da)]?.[_0x1f9b6f(0x1e9)](_0x124600,_0x1f9b6f(0x14e));return;}const _0x12a195=_0x24120e[_0x1f9b6f(0x197)]?.[_0x1f9b6f(0x1e7)]||_0x1f9b6f(0x154);await database_1[_0x1f9b6f(0x191)][_0x1f9b6f(0x15e)]['update']({'where':{'telegramId':_0x52afde},'data':{'shopId':null,'isVerified':![]}}),console[_0x1f9b6f(0x14d)](_0x1f9b6f(0x1ae)+_0x52afde+_0x1f9b6f(0x1a7)+_0x24120e[_0x1f9b6f(0x150)]),await this[_0x1f9b6f(0x1da)]?.['sendMessage'](_0x124600,_0x1f9b6f(0x203)+_0x12a195+_0x1f9b6f(0x1c2)+'To\x20reconnect,\x20use\x20the\x20/start\x20command',{'parse_mode':_0x1f9b6f(0x15c)});}catch(_0x3d481d){console[_0x1f9b6f(0x1dd)](_0x1f9b6f(0x14c),_0x3d481d),await this[_0x1f9b6f(0x1da)]?.['sendMessage'](_0x124600,_0x1f9b6f(0x211));}}),this[_0x12c8ae(0x1da)][_0x12c8ae(0x17e)](/\/status/,async _0x409d38=>{const _0x198bd2=_0x12c8ae,_0x3b65bb=_0x409d38[_0x198bd2(0x186)]['id'],_0x5e5a9f=_0x409d38[_0x198bd2(0x17f)]?.['id'][_0x198bd2(0x1a1)]();if(!_0x5e5a9f)return;try{const _0x208f29=await database_1[_0x198bd2(0x191)][_0x198bd2(0x15e)][_0x198bd2(0x156)]({'where':{'telegramId':_0x5e5a9f},'include':{'shop':!![]}});if(!_0x208f29){await this[_0x198bd2(0x1da)]?.[_0x198bd2(0x1e9)](_0x3b65bb,_0x198bd2(0x1cc)+_0x198bd2(0x170));return;}if(!_0x208f29[_0x198bd2(0x146)]||!_0x208f29[_0x198bd2(0x150)]||!_0x208f29['shop']){await this[_0x198bd2(0x1da)]?.[_0x198bd2(0x1e9)](_0x3b65bb,_0x198bd2(0x1ac)+_0x198bd2(0x202));return;}await this[_0x198bd2(0x1da)]?.[_0x198bd2(0x1e9)](_0x3b65bb,_0x198bd2(0x1ea)+('‚úÖ\x20Connected\x20to\x20shop:\x20*'+_0x208f29[_0x198bd2(0x197)]['name']+'*\x0a')+(_0x198bd2(0x1c1)+_0x208f29[_0x198bd2(0x197)][_0x198bd2(0x214)]+'`\x0a')+(_0x198bd2(0x20b)+_0x208f29[_0x198bd2(0x1f3)][_0x198bd2(0x1e6)](_0x198bd2(0x18c))+'\x0a\x0a')+_0x198bd2(0x1aa)+'Commands:\x0a'+_0x198bd2(0x187),{'parse_mode':_0x198bd2(0x15c)});}catch(_0x3bc6ac){console[_0x198bd2(0x1dd)](_0x198bd2(0x16d),_0x3bc6ac),await this[_0x198bd2(0x1da)]?.['sendMessage'](_0x3b65bb,'‚ùå\x20An\x20error\x20occurred.\x20Please\x20try\x20again\x20later.');}}),this['bot']['onText'](/\/debug/,async _0xf15485=>{const _0x26539b=_0x12c8ae,_0x4ceb9f=_0xf15485[_0x26539b(0x186)]['id'],_0xd8ba52=_0xf15485['from']?.['id'][_0x26539b(0x1a1)]();if(!_0xd8ba52)return;try{const _0x33f086=await database_1[_0x26539b(0x191)][_0x26539b(0x197)][_0x26539b(0x14f)]({'select':{'id':!![],'name':!![],'username':!![],'status':!![],'publicKey':!![]},'take':0xa});let _0x2c39e2=_0x26539b(0x15b);_0x2c39e2+=_0x26539b(0x1cd)+_0xd8ba52+'`\x0a\x0a',_0x2c39e2+=_0x26539b(0x174),_0x33f086[_0x26539b(0x164)]((_0x5e9269,_0x1655e4)=>{const _0x47c85a=_0x26539b;_0x2c39e2+=_0x1655e4+0x1+_0x47c85a(0x163)+_0x5e9269[_0x47c85a(0x1e7)]+'*\x0a',_0x2c39e2+=_0x47c85a(0x1bd)+_0x5e9269['username']+'`\x0a',_0x2c39e2+=_0x47c85a(0x160)+_0x5e9269['status']+'\x0a',_0x2c39e2+=_0x47c85a(0x1ec)+_0x5e9269[_0x47c85a(0x212)][_0x47c85a(0x184)](0x0,0xf)+'...`\x0a\x0a';}),await this[_0x26539b(0x1da)]?.['sendMessage'](_0x4ceb9f,_0x2c39e2,{'parse_mode':_0x26539b(0x15c)});}catch(_0x1ff40a){console['error']('Error\x20handling\x20/debug\x20command:',_0x1ff40a),await this[_0x26539b(0x1da)]?.['sendMessage'](_0x4ceb9f,'‚ùå\x20Error\x20getting\x20debug\x20information.');}}),this[_0x12c8ae(0x1da)]['on'](_0x12c8ae(0x1b2),async _0x47810d=>{const _0x7fa3b1=_0x12c8ae;if(_0x47810d['text']?.[_0x7fa3b1(0x1e2)]('/'))return;const _0x428ee3=_0x47810d[_0x7fa3b1(0x186)]['id'],_0x8fda2e=_0x47810d[_0x7fa3b1(0x17f)]?.['id']['toString'](),_0x19e3d7=_0x47810d[_0x7fa3b1(0x1d6)]?.[_0x7fa3b1(0x1a0)]();if(!_0x8fda2e||!_0x19e3d7)return;try{const _0x190869=await database_1[_0x7fa3b1(0x191)][_0x7fa3b1(0x15e)][_0x7fa3b1(0x156)]({'where':{'telegramId':_0x8fda2e},'include':{'shop':!![]}});if(!_0x190869){await this[_0x7fa3b1(0x1da)]?.[_0x7fa3b1(0x1e9)](_0x428ee3,_0x7fa3b1(0x1cf));return;}if(_0x190869[_0x7fa3b1(0x146)]&&_0x190869['shopId']&&_0x190869[_0x7fa3b1(0x197)]){await this[_0x7fa3b1(0x1da)]?.[_0x7fa3b1(0x1e9)](_0x428ee3,_0x7fa3b1(0x19b)+_0x190869[_0x7fa3b1(0x197)][_0x7fa3b1(0x1e7)]+_0x7fa3b1(0x1c2)+'Use\x20/status\x20to\x20check\x20status\x20or\x20/disconnect\x20to\x20disconnect.',{'parse_mode':_0x7fa3b1(0x15c)});return;}const _0x1efd77=_0x19e3d7[_0x7fa3b1(0x1df)](/\s+/);if(_0x1efd77[_0x7fa3b1(0x15a)]!==0x2){await this['bot']?.[_0x7fa3b1(0x1e9)](_0x428ee3,_0x7fa3b1(0x210)+_0x7fa3b1(0x14b)+'Example:\x0a'+_0x7fa3b1(0x1fd)+(_0x7fa3b1(0x1fa)+_0x1efd77[_0x7fa3b1(0x15a)]+_0x7fa3b1(0x1d9)+_0x1efd77['map'](_0x5122d2=>'`'+_0x5122d2+'`')[_0x7fa3b1(0x1c7)](',\x20')),{'parse_mode':_0x7fa3b1(0x15c)});return;}const [_0x2d418f,_0x5e5d2a]=_0x1efd77;console[_0x7fa3b1(0x14d)](_0x7fa3b1(0x157)+_0x8fda2e+':\x20username=\x22'+_0x2d418f+'\x22,\x20apiKey=\x22'+_0x5e5d2a[_0x7fa3b1(0x184)](0x0,0xa)+'...\x22'),await this[_0x7fa3b1(0x159)](_0x428ee3,_0x8fda2e,_0x2d418f,_0x5e5d2a);}catch(_0x52e4e7){console[_0x7fa3b1(0x1dd)]('Error\x20handling\x20message:',_0x52e4e7),await this['bot']?.[_0x7fa3b1(0x1e9)](_0x428ee3,_0x7fa3b1(0x211));}}),this[_0x12c8ae(0x1da)]['on'](_0x12c8ae(0x1dd),_0x39378b=>{const _0xafdb92=_0x12c8ae;console['error'](_0xafdb92(0x209),_0x39378b);}),this['bot']['on'](_0x12c8ae(0x18d),_0x245c8d=>{const _0x1d2d46=_0x12c8ae;console[_0x1d2d46(0x1dd)](_0x1d2d46(0x20a),_0x245c8d);});}async[a49_0x1c8d17(0x159)](_0x2b00af,_0x30bd69,_0x5a5627,_0x4eb423){const _0x39893b=a49_0x1c8d17;try{console[_0x39893b(0x14d)](_0x39893b(0x157)+_0x30bd69+':\x20username=\x22'+_0x5a5627+_0x39893b(0x1ef)+_0x4eb423['substring'](0x0,0xa)+_0x39893b(0x1a2));if(!_0x5a5627||_0x5a5627['length']<0x3||_0x5a5627[_0x39893b(0x15a)]>0x32||!/^[a-zA-Z0-9_]+$/['test'](_0x5a5627)){await this['bot']?.[_0x39893b(0x1e9)](_0x2b00af,_0x39893b(0x179)+_0x5a5627+_0x39893b(0x1e8)+_0x39893b(0x13a),{'parse_mode':_0x39893b(0x15c)});return;}if(!_0x4eb423||!_0x4eb423['startsWith'](_0x39893b(0x16f))&&!_0x4eb423['startsWith'](_0x39893b(0x162))){await this[_0x39893b(0x1da)]?.['sendMessage'](_0x2b00af,_0x39893b(0x182)+'API\x20key\x20must\x20start\x20with\x20`pk\x5c_`\x20or\x20`sk\x5c_`.',{'parse_mode':_0x39893b(0x15c)});return;}const _0x4fc871=await database_1[_0x39893b(0x191)][_0x39893b(0x197)][_0x39893b(0x156)]({'where':{'username':_0x5a5627},'select':{'id':!![],'name':!![],'username':!![],'status':!![],'publicKey':!![],'secretKey':!![]}});if(!_0x4fc871){const _0x1c5d1f=await database_1[_0x39893b(0x191)][_0x39893b(0x197)][_0x39893b(0x14f)]({'select':{'username':!![],'name':!![]},'take':0x5});let _0x443690='‚ùå\x20Shop\x20with\x20username\x20`'+_0x5a5627+_0x39893b(0x1b1);_0x1c5d1f[_0x39893b(0x15a)]>0x0?(_0x443690+=_0x39893b(0x13b),_0x1c5d1f['forEach'](_0x14c9b7=>{const _0x3bfc66=_0x39893b;_0x443690+=_0x3bfc66(0x1f8)+_0x14c9b7[_0x3bfc66(0x214)]+_0x3bfc66(0x204)+_0x14c9b7[_0x3bfc66(0x1e7)]+')\x0a';}),_0x443690+='\x0aCheck\x20spelling\x20and\x20try\x20again.'):_0x443690+='Check\x20spelling\x20and\x20try\x20again.';await this[_0x39893b(0x1da)]?.[_0x39893b(0x1e9)](_0x2b00af,_0x443690,{'parse_mode':_0x39893b(0x15c)});return;}if(_0x4fc871['status']!==_0x39893b(0x19c)){await this['bot']?.[_0x39893b(0x1e9)](_0x2b00af,'‚ùå\x20Shop\x20`'+_0x5a5627+'`\x20is\x20inactive.\x0a\x0a'+'Contact\x20administrator.',{'parse_mode':_0x39893b(0x15c)});return;}if(_0x4fc871[_0x39893b(0x212)]!==_0x4eb423&&_0x4fc871[_0x39893b(0x166)]!==_0x4eb423){await this['bot']?.[_0x39893b(0x1e9)](_0x2b00af,_0x39893b(0x1bb)+_0x5a5627+_0x39893b(0x1c8)+_0x39893b(0x17c)+_0x39893b(0x1ab),{'parse_mode':_0x39893b(0x15c)});return;}const _0x5be85b=await database_1[_0x39893b(0x191)][_0x39893b(0x15e)][_0x39893b(0x172)]({'where':{'shopId':_0x4fc871['id'],'isVerified':!![],'telegramId':{'not':_0x30bd69}}});if(_0x5be85b){await this[_0x39893b(0x1da)]?.[_0x39893b(0x1e9)](_0x2b00af,_0x39893b(0x1ed)+_0x5a5627+_0x39893b(0x1c8)+_0x39893b(0x1f0),{'parse_mode':_0x39893b(0x15c)});return;}await database_1[_0x39893b(0x191)][_0x39893b(0x15e)][_0x39893b(0x1e3)]({'where':{'telegramId':_0x30bd69},'data':{'shopId':_0x4fc871['id'],'isVerified':!![]}}),await this[_0x39893b(0x1da)]?.['sendMessage'](_0x2b00af,_0x39893b(0x205)+_0x39893b(0x190)+('üì±\x20Shop:\x20*'+_0x4fc871[_0x39893b(0x1e7)]+'*\x0a')+(_0x39893b(0x1c1)+_0x4fc871[_0x39893b(0x214)]+'`\x0a\x0a')+_0x39893b(0x194)+'‚Ä¢\x20New\x20payments\x0a'+'‚Ä¢\x20Payment\x20status\x20changes\x0a'+'‚Ä¢\x20Payouts\x0a'+_0x39893b(0x137)+'Commands:\x0a'+_0x39893b(0x1d4)+_0x39893b(0x187),{'parse_mode':'Markdown'}),console[_0x39893b(0x14d)]('‚úÖ\x20Telegram\x20user\x20'+_0x30bd69+'\x20verified\x20for\x20shop\x20'+_0x4fc871[_0x39893b(0x214)]+_0x39893b(0x1af));}catch(_0x4622c0){console[_0x39893b(0x1dd)](_0x39893b(0x19d),_0x4622c0),await this[_0x39893b(0x1da)]?.[_0x39893b(0x1e9)](_0x2b00af,_0x39893b(0x1e4));}}async[a49_0x1c8d17(0x1b6)](_0x5b5b5b,_0x3a91f4,_0x2e0bd0){const _0x1db9a9=a49_0x1c8d17;if(!this[_0x1db9a9(0x1da)]){console['warn'](_0x1db9a9(0x207));return;}try{const _0x4b4455=await database_1[_0x1db9a9(0x191)][_0x1db9a9(0x15e)][_0x1db9a9(0x14f)]({'where':{'shopId':_0x5b5b5b,'isVerified':!![]}});if(_0x4b4455[_0x1db9a9(0x15a)]===0x0){console[_0x1db9a9(0x14d)](_0x1db9a9(0x189)+_0x5b5b5b);return;}const _0x3c9621=_0x4b4455[_0x1db9a9(0x1a5)](async _0x1f93c0=>{const _0x9053a8=_0x1db9a9;try{await this[_0x9053a8(0x1da)]?.['sendMessage'](_0x1f93c0[_0x9053a8(0x195)],_0x3a91f4,_0x2e0bd0),console[_0x9053a8(0x14d)](_0x9053a8(0x1b4)+_0x1f93c0[_0x9053a8(0x195)]);}catch(_0x46cf84){console[_0x9053a8(0x1dd)](_0x9053a8(0x20f)+_0x1f93c0[_0x9053a8(0x195)]+':',_0x46cf84),_0x46cf84 instanceof Error&&(_0x46cf84[_0x9053a8(0x1b2)][_0x9053a8(0x20d)](_0x9053a8(0x175))||_0x46cf84[_0x9053a8(0x1b2)][_0x9053a8(0x20d)]('chat\x20not\x20found')||_0x46cf84[_0x9053a8(0x1b2)][_0x9053a8(0x20d)](_0x9053a8(0x1e0)))&&(await database_1[_0x9053a8(0x191)]['telegramUser'][_0x9053a8(0x1e3)]({'where':{'id':_0x1f93c0['id']},'data':{'isVerified':![]}}),console[_0x9053a8(0x14d)](_0x9053a8(0x18e)+_0x1f93c0[_0x9053a8(0x195)]+'\x20marked\x20as\x20unverified\x20due\x20to\x20delivery\x20failure'));}});await Promise[_0x1db9a9(0x16e)](_0x3c9621);}catch(_0x339364){console['error'](_0x1db9a9(0x1c4),_0x339364);}}async['sendPaymentNotification'](_0x2237d0,_0x1e03e0,_0x243039){const _0x312aa9=a49_0x1c8d17,_0x38c444={'created':'üÜï','paid':'‚úÖ','failed':'‚ùå','expired':'‚è∞','refund':'üîÑ','chargeback':'‚ö†Ô∏è','processing':'‚öôÔ∏è'},_0x4913ea={'created':_0x312aa9(0x151),'paid':_0x312aa9(0x1de),'failed':_0x312aa9(0x13e),'expired':_0x312aa9(0x1c9),'refund':_0x312aa9(0x141),'chargeback':_0x312aa9(0x177),'processing':_0x312aa9(0x1a9)},_0x3e0621=_0x38c444[_0x243039],_0x595c03=_0x4913ea[_0x243039],_0x139365=(0x0,gateway_1['getGatewayDisplayNameForTelegram'])(_0x1e03e0[_0x312aa9(0x13f)]);console[_0x312aa9(0x14d)](_0x312aa9(0x18b)+_0x1e03e0['gateway']+_0x312aa9(0x168)+_0x139365+'\x22');let _0x47b20f=_0x3e0621+'\x20*'+_0x595c03+_0x312aa9(0x1fc)+(_0x312aa9(0x1a4)+_0x1e03e0[_0x312aa9(0x1f6)]+'\x20'+_0x1e03e0[_0x312aa9(0x1f4)]+'*\x0a')+(_0x312aa9(0x135)+(_0x1e03e0[_0x312aa9(0x1a6)]||_0x1e03e0['id'])+'`\x0a')+(_0x312aa9(0x1c6)+_0x1e03e0['id']+'`\x0a')+(_0x312aa9(0x1b7)+_0x139365+'`\x0a')+(_0x312aa9(0x1f7)+new Date(_0x1e03e0['createdAt'])[_0x312aa9(0x200)](_0x312aa9(0x18c))+'\x0a');(_0x1e03e0['customerName']||_0x1e03e0[_0x312aa9(0x134)])&&(_0x47b20f+=_0x312aa9(0x1f1),_0x1e03e0[_0x312aa9(0x19a)]&&(_0x47b20f+='üìõ\x20Name:\x20`'+_0x1e03e0[_0x312aa9(0x19a)]+'`\x0a'),_0x1e03e0[_0x312aa9(0x134)]&&(_0x47b20f+=_0x312aa9(0x15d)+_0x1e03e0[_0x312aa9(0x134)]+'`\x0a')),_0x243039===_0x312aa9(0x1d8)&&_0x1e03e0[_0x312aa9(0x19e)]&&(_0x47b20f+=_0x312aa9(0x17a)+_0x1e03e0[_0x312aa9(0x19e)]+_0x312aa9(0x1b3)),_0x243039===_0x312aa9(0x208)&&(_0x47b20f+='‚è≥\x20The\x20payment\x20is\x20currently\x20being\x20processed\x20by\x20the\x20gateway.\x0a'),_0x1e03e0[_0x312aa9(0x1a8)]&&(_0x47b20f+=_0x312aa9(0x1ca)+_0x1e03e0[_0x312aa9(0x1a8)]+'\x0a'),await this[_0x312aa9(0x1b6)](_0x2237d0,_0x47b20f,{'parse_mode':'Markdown'});}async[a49_0x1c8d17(0x148)](_0x503211,_0x54cbe1,_0x35123a){const _0xc8164d=a49_0x1c8d17,_0x59ad20={'created':'üì§','completed':'‚úÖ','rejected':'‚ùå'},_0x433388={'created':_0xc8164d(0x19f),'completed':_0xc8164d(0x161),'rejected':_0xc8164d(0x140)},_0x545f1e=_0x59ad20[_0x35123a],_0x1f87ae=_0x433388[_0x35123a],_0xb64955=_0x545f1e+'\x20*'+_0x1f87ae+'*\x0a\x0a'+(_0xc8164d(0x18f)+_0x54cbe1[_0xc8164d(0x1f6)]+'\x20USD*\x0a')+(_0xc8164d(0x136)+_0x54cbe1[_0xc8164d(0x1c0)]+'`\x0a')+('üÜî\x20Payout\x20ID:\x20`'+_0x54cbe1['id']+'`\x0a')+(_0xc8164d(0x1f7)+new Date(_0x54cbe1[_0xc8164d(0x145)])[_0xc8164d(0x200)](_0xc8164d(0x18c))+'\x0a')+(_0x54cbe1[_0xc8164d(0x1b9)]?_0xc8164d(0x1d3)+_0x54cbe1[_0xc8164d(0x1b9)]+'`':'');await this['sendShopNotification'](_0x503211,_0xb64955,{'parse_mode':_0xc8164d(0x15c)});}async[a49_0x1c8d17(0x173)](_0x44ad34,_0x27661b){const _0x343ff6=a49_0x1c8d17;try{const _0x969a7=await database_1[_0x343ff6(0x191)]['shopSettings'][_0x343ff6(0x156)]({'where':{'shopId':_0x44ad34},'select':{'notificationLogin':!![]}});if(!_0x969a7?.[_0x343ff6(0x147)]){console[_0x343ff6(0x14d)]('üì±\x20Login\x20notifications\x20disabled\x20for\x20shop\x20'+_0x44ad34);return;}const _0x2b9bb9=_0x27661b[_0x343ff6(0x143)]?'üîê':'üö®',_0x215369=_0x27661b[_0x343ff6(0x143)]?_0x343ff6(0x1d7):_0x343ff6(0x1b5);let _0x5c4cff=_0x2b9bb9+'\x20*'+_0x215369+_0x343ff6(0x1fc)+('üë§\x20Username:\x20`'+_0x27661b['username']+'`\x0a')+(_0x343ff6(0x15f)+_0x27661b[_0x343ff6(0x16a)][_0x343ff6(0x200)](_0x343ff6(0x18c))+'\x0a');_0x27661b[_0x343ff6(0x1cb)]&&(_0x5c4cff+=_0x343ff6(0x138)+_0x27661b[_0x343ff6(0x1cb)]+'`\x0a');if(_0x27661b['userAgent']){const _0x55d8fc=_0x27661b[_0x343ff6(0x192)]['length']>0x32?_0x27661b[_0x343ff6(0x192)][_0x343ff6(0x184)](0x0,0x32)+_0x343ff6(0x171):_0x27661b[_0x343ff6(0x192)];_0x5c4cff+='üíª\x20Browser:\x20`'+_0x55d8fc+'`\x0a';}!_0x27661b[_0x343ff6(0x143)]&&(_0x5c4cff+=_0x343ff6(0x18a)),await this[_0x343ff6(0x1b6)](_0x44ad34,_0x5c4cff,{'parse_mode':_0x343ff6(0x15c)}),console[_0x343ff6(0x14d)](_0x343ff6(0x1be)+_0x44ad34+':\x20'+(_0x27661b[_0x343ff6(0x143)]?_0x343ff6(0x143):_0x343ff6(0x17b)));}catch(_0x423481){console[_0x343ff6(0x1dd)](_0x343ff6(0x139),_0x423481);}}async['sendApiErrorNotification'](_0x23eb19,_0x1924e1){const _0x36bb1b=a49_0x1c8d17;try{const _0x415b96=await database_1[_0x36bb1b(0x191)][_0x36bb1b(0x1d5)]['findUnique']({'where':{'shopId':_0x23eb19},'select':{'notificationApiError':!![]}});if(!_0x415b96?.[_0x36bb1b(0x1c3)]){console[_0x36bb1b(0x14d)](_0x36bb1b(0x198)+_0x23eb19);return;}let _0x5d09f7=_0x36bb1b(0x1b8)+('üîó\x20Endpoint:\x20`'+_0x1924e1[_0x36bb1b(0x1c0)]+'\x20'+_0x1924e1[_0x36bb1b(0x183)]+'`\x0a')+(_0x36bb1b(0x15f)+_0x1924e1[_0x36bb1b(0x16a)][_0x36bb1b(0x200)](_0x36bb1b(0x18c))+'\x0a');_0x1924e1[_0x36bb1b(0x1bc)]&&(_0x5d09f7+=_0x36bb1b(0x17d)+_0x1924e1[_0x36bb1b(0x1bc)]+'`\x0a'),_0x5d09f7+='‚ùå\x20Error:\x20`'+_0x1924e1[_0x36bb1b(0x1b0)]+'`\x0a',_0x1924e1[_0x36bb1b(0x1f2)]&&(_0x5d09f7+='üÜî\x20Request\x20ID:\x20`'+_0x1924e1[_0x36bb1b(0x1f2)]+'`\x0a'),_0x5d09f7+=_0x36bb1b(0x1d0),await this[_0x36bb1b(0x1b6)](_0x23eb19,_0x5d09f7,{'parse_mode':_0x36bb1b(0x15c)}),console[_0x36bb1b(0x14d)](_0x36bb1b(0x199)+_0x23eb19+':\x20'+_0x1924e1[_0x36bb1b(0x183)]);}catch(_0x329707){console[_0x36bb1b(0x1dd)](_0x36bb1b(0x16b),_0x329707);}}async[a49_0x1c8d17(0x215)](_0x2f5c61,_0x423f9d,_0x34d45d){const _0x30e811=a49_0x1c8d17;let _0x426b27=_0x30e811(0x1ee)+_0x423f9d+_0x30e811(0x1fc);for(const [_0x3f4027,_0x455bf6]of Object[_0x30e811(0x16c)](_0x34d45d)){_0x455bf6!==null&&_0x455bf6!==undefined&&(_0x426b27+=_0x3f4027+_0x30e811(0x144)+_0x455bf6+'`\x0a');}await this['sendShopNotification'](_0x2f5c61,_0x426b27,{'parse_mode':_0x30e811(0x15c)});}[a49_0x1c8d17(0x153)](){const _0x272e19=a49_0x1c8d17;return{'isActive':!!this[_0x272e19(0x1da)],'username':this[_0x272e19(0x14a)]};}[a49_0x1c8d17(0x176)](){const _0x573e1e=a49_0x1c8d17;this['bot']&&(this[_0x573e1e(0x1da)][_0x573e1e(0x149)](),this['bot']=null,console[_0x573e1e(0x14d)](_0x573e1e(0x165)));}}function a49_0x22c6(_0x2bdaaa,_0x466ebd){const _0x740b12=a49_0x740b();return a49_0x22c6=function(_0x22c615,_0x4a5cf5){_0x22c615=_0x22c615-0x133;let _0x391161=_0x740b12[_0x22c615];return _0x391161;},a49_0x22c6(_0x2bdaaa,_0x466ebd);}exports[a49_0x1c8d17(0x181)]=TelegramBotService,exports[a49_0x1c8d17(0x1dc)]=new TelegramBotService();