'use strict';const a58_0x13e0b2=a58_0x278d;(function(_0x5f1cf3,_0x527f29){const _0x39d003=a58_0x278d,_0x1679e0=_0x5f1cf3();while(!![]){try{const _0xd05276=-parseInt(_0x39d003(0x289))/0x1+-parseInt(_0x39d003(0x28a))/0x2*(parseInt(_0x39d003(0x246))/0x3)+-parseInt(_0x39d003(0x1e2))/0x4+parseInt(_0x39d003(0x1f7))/0x5*(-parseInt(_0x39d003(0x21f))/0x6)+parseInt(_0x39d003(0x1f9))/0x7+-parseInt(_0x39d003(0x278))/0x8+parseInt(_0x39d003(0x250))/0x9*(parseInt(_0x39d003(0x1fc))/0xa);if(_0xd05276===_0x527f29)break;else _0x1679e0['push'](_0x1679e0['shift']());}catch(_0x18d77b){_0x1679e0['push'](_0x1679e0['shift']());}}}(a58_0x5a40,0xb282a));var __importDefault=this&&this[a58_0x13e0b2(0x24e)]||function(_0x13d7bc){const _0x1300d8=a58_0x13e0b2;return _0x13d7bc&&_0x13d7bc[_0x1300d8(0x20c)]?_0x13d7bc:{'default':_0x13d7bc};};function a58_0x5a40(){const _0x1e24c0=['...\x22','chargeback','🔗\x20TXID:\x20`','Use\x20/status\x20to\x20check\x20status\x20or\x20/disconnect\x20to\x20disconnect.','✅\x20Notification\x20sent\x20to\x20Telegram\x20user\x20','⏳\x20The\x20payment\x20is\x20currently\x20being\x20processed\x20by\x20the\x20gateway.\x0a','../config/database','botToken','pk_','__esModule','•\x20Important\x20events\x0a\x0a','📝\x20Notes:\x20','🔔\x20*','shopSettings','📛\x20Name:\x20`','Failed\x20login\x20attempt','🔄\x20Processing\x20single-line\x20verification\x20for\x20user\x20','/status\x20-\x20check\x20connection\x20status\x0a','❌\x20Error\x20getting\x20debug\x20information.','TELEGRAM_BOT_TOKEN','findMany','...`\x0a\x0a','`appple\x20pk_aa6450d3f57afbefbb0f3f5be5ce6cca13037536afc5ccf14c81a6cbc7a07de5`\x0a\x0a','sk_','error','findUnique','toLocaleString','\x20(@','6yOVZLa','node-telegram-bot-api','defineProperty','✅\x20Telegram\x20user\x20','gateway','❌\x20You\x20are\x20not\x20registered\x20in\x20the\x20system.\x0a\x0a','method','Available\x20usernames:\x0a','toString','Failed\x20to\x20send\x20login\x20notification:','bot','🔔\x20Notifications\x20are\x20active\x0a\x0a','env','TELEGRAM_BOT_USERNAME','Payment\x20failed','ACTIVE','❌\x20Shop\x20with\x20username\x20`','🔗\x20Endpoint:\x20`','`\x20not\x20found.\x0a\x0a','📅\x20Time:\x20','•\x20Payouts\x0a','`\x20is\x20inactive.\x0a\x0a','telegramUser','\x20\x20\x20Username:\x20`','.\x20*','update','\x20parts:\x20','Payment\x20is\x20being\x20processed','*\x0a\x0a','❌\x20Invalid\x20username\x20format:\x20`','TelegramBotService','telegramBotService','❌\x20Invalid\x20format.\x20Please\x20send\x20exactly\x202\x20parts\x20separated\x20by\x20space:\x0a\x0a','map','Payout\x20rejected','notificationLogin','Payout\x20completed','Username\x20must\x20contain\x20only\x20letters,\x20numbers\x20and\x20underscore\x20(3-50\x20characters).','❌\x20An\x20error\x20occurred\x20while\x20verifying\x20data.','763989TGDwUC','join','telegramId','Error\x20in\x20handleSingleLineVerification:','\x20USDT*\x0a','success','🤖\x20Welcome\x20to\x20TRAPAY\x20notification\x20system!\x0a\x0a','Use\x20/start\x20to\x20begin.','__importDefault','ipAddress','43479TYbrMg','💻\x20Browser:\x20`','substring','\x0aCheck\x20spelling\x20and\x20try\x20again.','❌\x20Failed\x20to\x20initialize\x20Telegram\x20bot:','❌\x20An\x20error\x20occurred.\x20Please\x20try\x20again\x20later.','chat','🏪\x20Gateway:\x20`','secretKey','Markdown','📧\x20Email:\x20`','sendLoginNotification','statusCode','text','\x20\x20\x20Status:\x20','\x22,\x20apiKey=\x22','❌\x20Another\x20Telegram\x20account\x20is\x20already\x20connected\x20to\x20shop\x20`','endpoint','\x20\x20\x20Public\x20Key:\x20`','processing','initializeBot','*.\x0a\x0a','startsWith','userAgent','\x0a⚠️\x20If\x20this\x20wasn\x27t\x20you,\x20change\x20your\x20password\x20immediately!','❌\x20Please\x20use\x20/start\x20command\x20first','allSettled','•\x20New\x20payments\x0a','chargebackAmount','New\x20payment\x20created','handleSingleLineVerification','unknown\x20shop','Use\x20/start\x20to\x20connect.','❗️\x20Make\x20sure\x20to\x20separate\x20username\x20and\x20API\x20key\x20with\x20a\x20space!','To\x20reconnect,\x20use\x20the\x20/start\x20command','createdAt','🆔\x20Payout\x20ID:\x20`',':\x20username=\x22','sendMessage','username','9431136JVWjrt','currency','errorMessage',':\x20`','from','name','customerIp','customerName','✅\x20You\x20are\x20already\x20connected\x20to\x20shop\x20*','💰\x20Amount:\x20*','stopBot','🏪\x20Available\x20shops\x20in\x20system:\x0a','Disconnect\x20the\x20previous\x20account\x20first\x20or\x20contact\x20administrator.','Commands:\x0a','•\x20Payouts\x0a\x0a','Successful\x20login','onText','549037yoVJNu','2KsbLsX','📱\x20Created\x20new\x20Telegram\x20user:\x20','🔔\x20You\x20will\x20now\x20receive\x20notifications\x20about:\x0a','🆔\x20Request\x20ID:\x20`','💸\x20Amount:\x20*','\x20disconnected\x20from\x20shop\x20','Check\x20spelling\x20and\x20try\x20again.','message','forEach','en-US','getBotInfo','✅\x20Connected\x20to\x20shop:\x20*','adminNotes','❌\x20Shop\x20`','\x20via\x20single-line\x20input','\x20USD*\x0a','length','warn','/disconnect\x20-\x20disconnect\x20from\x20notifications','Username:\x20`','stopPolling','🔔\x20You\x20receive\x20notifications\x20about:\x0a','isVerified','`\x0a\x0a','user\x20is\x20deactivated','📱\x20Your\x20Telegram\x20ID:\x20`','Telegram\x20bot\x20not\x20initialized,\x20cannot\x20send\x20notification','🌐\x20IP\x20address:\x20`','remitterIban','✅\x20Telegram\x20bot\x20@','log','split','•\x20Payment\x20status\x20changes\x0a','../types/gateway','Error\x20handling\x20/status\x20command:','publicKey','requestId','\x0a👤\x20*Customer\x20Information:*\x0a','txid','\x20initialized\x20successfully','Failed\x20to\x20send\x20API\x20error\x20notification:','shop','📊\x20Error\x20code:\x20`','sendShopNotification','status','botUsername','📅\x20Date:\x20','setupBotHandlers','📝\x20Format:\x20`username\x20api_key`\x0a\x0a','polling_error','shopId','📱\x20Login\x20notifications\x20disabled\x20for\x20shop\x20','amount','\x20marked\x20as\x20unverified\x20due\x20to\x20delivery\x20failure','customerUa','\x0a💡\x20Check\x20your\x20request\x20or\x20contact\x20support.','Payment\x20successfully\x20paid','3391576NTJnaG','📝\x20Order\x20ID:\x20`','🛑\x20Telegram\x20bot\x20stopped','Error\x20handling\x20message:','User\x20','To\x20receive\x20payment\x20notifications,\x20send\x20your\x20credentials\x20in\x20one\x20line:\x0a\x0a','getGatewayDisplayNameForTelegram','test','sendCustomNotification','...','✅\x20Login\x20notification\x20sent\x20for\x20shop\x20','•\x20`','No\x20verified\x20Telegram\x20users\x20found\x20for\x20shop\x20','👤\x20Username:\x20`','📊\x20*Connection\x20Status*\x0a\x0a','New\x20payout\x20created','✅\x20You\x20have\x20been\x20successfully\x20connected\x20to\x20the\x20notification\x20system!\x0a\x0a','Example:\x0a','first_name','includes','📱\x20API\x20error\x20notifications\x20disabled\x20for\x20shop\x20','3603070CpbefG','default','10159184vQCeYE','`.\x0a\x0a','sendApiErrorNotification','5860BSJDUj','orderId','entries','Telegram\x20bot\x20polling\x20error:','Error\x20handling\x20/debug\x20command:','🆔\x20Payment\x20ID:\x20`','✅\x20Welcome\x20back!\x0a\x0a'];a58_0x5a40=function(){return _0x1e24c0;};return a58_0x5a40();}Object[a58_0x13e0b2(0x221)](exports,'__esModule',{'value':!![]}),exports['telegramBotService']=exports['TelegramBotService']=void 0x0;const node_telegram_bot_api_1=__importDefault(require(a58_0x13e0b2(0x220))),database_1=__importDefault(require(a58_0x13e0b2(0x209))),gateway_1=require(a58_0x13e0b2(0x1ca));class TelegramBotService{constructor(){const _0x1451f8=a58_0x13e0b2;this['bot']=null,this[_0x1451f8(0x20a)]=process[_0x1451f8(0x22b)][_0x1451f8(0x216)]||'',this[_0x1451f8(0x1d6)]=process['env'][_0x1451f8(0x22c)]||'trapay_bot',this[_0x1451f8(0x20a)]?this[_0x1451f8(0x264)]():console[_0x1451f8(0x29b)]('TELEGRAM_BOT_TOKEN\x20not\x20found\x20in\x20environment\x20variables');}['initializeBot'](){const _0x177f45=a58_0x13e0b2;try{this[_0x177f45(0x229)]=new node_telegram_bot_api_1[(_0x177f45(0x1f8))](this[_0x177f45(0x20a)],{'polling':!![]}),this['setupBotHandlers'](),console[_0x177f45(0x2a8)](_0x177f45(0x2a7)+this[_0x177f45(0x1d6)]+_0x177f45(0x1d0));}catch(_0x38b946){console[_0x177f45(0x21b)](_0x177f45(0x254),_0x38b946);}}[a58_0x13e0b2(0x1d8)](){const _0x2ce0d8=a58_0x13e0b2;if(!this[_0x2ce0d8(0x229)])return;this[_0x2ce0d8(0x229)]['onText'](/\/start/,async _0x366669=>{const _0x478b08=_0x2ce0d8,_0x29ea87=_0x366669[_0x478b08(0x256)]['id'],_0x3cf9d6=_0x366669[_0x478b08(0x27c)]?.['id'][_0x478b08(0x227)](),_0x211ec9=_0x366669[_0x478b08(0x27c)]?.[_0x478b08(0x277)],_0x3ce1b4=_0x366669[_0x478b08(0x27c)]?.[_0x478b08(0x1f4)],_0x27eafa=_0x366669[_0x478b08(0x27c)]?.['last_name'];if(!_0x3cf9d6)return;try{let _0x52b123=await database_1[_0x478b08(0x1f8)][_0x478b08(0x235)]['findUnique']({'where':{'telegramId':_0x3cf9d6},'include':{'shop':!![]}});!_0x52b123?(_0x52b123=await database_1[_0x478b08(0x1f8)]['telegramUser']['create']({'data':{'telegramId':_0x3cf9d6,'username':_0x211ec9,'firstName':_0x3ce1b4,'lastName':_0x27eafa,'isVerified':![],'shopId':null},'include':{'shop':!![]}}),console[_0x478b08(0x2a8)](_0x478b08(0x28b)+_0x3cf9d6+_0x478b08(0x21e)+_0x211ec9+')')):_0x52b123=await database_1[_0x478b08(0x1f8)][_0x478b08(0x235)][_0x478b08(0x238)]({'where':{'telegramId':_0x3cf9d6},'data':{'username':_0x211ec9,'firstName':_0x3ce1b4,'lastName':_0x27eafa},'include':{'shop':!![]}}),_0x52b123[_0x478b08(0x2a0)]&&_0x52b123['shopId']&&_0x52b123[_0x478b08(0x1d2)]?await this[_0x478b08(0x229)]?.[_0x478b08(0x276)](_0x29ea87,_0x478b08(0x202)+('You\x20are\x20already\x20connected\x20to\x20shop:\x20*'+_0x52b123[_0x478b08(0x1d2)][_0x478b08(0x27d)]+'*\x0a')+(_0x478b08(0x29d)+_0x52b123[_0x478b08(0x1d2)]['username']+_0x478b08(0x2a1))+_0x478b08(0x29f)+'•\x20New\x20payments\x0a'+_0x478b08(0x1c9)+_0x478b08(0x286)+_0x478b08(0x285)+_0x478b08(0x214)+'/disconnect\x20-\x20disconnect\x20from\x20notifications',{'parse_mode':_0x478b08(0x259)}):(_0x52b123[_0x478b08(0x1db)]&&!_0x52b123[_0x478b08(0x2a0)]&&(await database_1[_0x478b08(0x1f8)]['telegramUser'][_0x478b08(0x238)]({'where':{'telegramId':_0x3cf9d6},'data':{'shopId':null,'isVerified':![]}}),console['log']('🔄\x20Reset\x20incomplete\x20verification\x20for\x20user\x20'+_0x3cf9d6)),await this[_0x478b08(0x229)]?.[_0x478b08(0x276)](_0x29ea87,_0x478b08(0x24c)+_0x478b08(0x1e7)+_0x478b08(0x1d9)+_0x478b08(0x1f3)+_0x478b08(0x219)+_0x478b08(0x271),{'parse_mode':_0x478b08(0x259)}));}catch(_0x2257bf){console['error']('Error\x20handling\x20/start\x20command:',_0x2257bf),await this['bot']?.[_0x478b08(0x276)](_0x29ea87,_0x478b08(0x255));}}),this[_0x2ce0d8(0x229)][_0x2ce0d8(0x288)](/\/disconnect/,async _0x2b5bd0=>{const _0x472f28=_0x2ce0d8,_0xab1a11=_0x2b5bd0['chat']['id'],_0x538640=_0x2b5bd0[_0x472f28(0x27c)]?.['id']['toString']();if(!_0x538640)return;try{const _0x542dbb=await database_1[_0x472f28(0x1f8)][_0x472f28(0x235)][_0x472f28(0x21c)]({'where':{'telegramId':_0x538640},'include':{'shop':!![]}});if(!_0x542dbb||!_0x542dbb['isVerified']||!_0x542dbb[_0x472f28(0x1db)]){await this['bot']?.[_0x472f28(0x276)](_0xab1a11,'❌\x20You\x20are\x20not\x20connected\x20to\x20the\x20notification\x20system.');return;}const _0x592a6e=_0x542dbb['shop']?.[_0x472f28(0x27d)]||_0x472f28(0x26f);await database_1[_0x472f28(0x1f8)][_0x472f28(0x235)][_0x472f28(0x238)]({'where':{'telegramId':_0x538640},'data':{'shopId':null,'isVerified':![]}}),console[_0x472f28(0x2a8)]('🔌\x20User\x20'+_0x538640+_0x472f28(0x28f)+_0x542dbb[_0x472f28(0x1db)]),await this[_0x472f28(0x229)]?.[_0x472f28(0x276)](_0xab1a11,'✅\x20You\x20have\x20been\x20successfully\x20disconnected\x20from\x20shop\x20*'+_0x592a6e+_0x472f28(0x265)+_0x472f28(0x272),{'parse_mode':'Markdown'});}catch(_0x402eed){console[_0x472f28(0x21b)]('Error\x20handling\x20/disconnect\x20command:',_0x402eed),await this[_0x472f28(0x229)]?.['sendMessage'](_0xab1a11,'❌\x20An\x20error\x20occurred.\x20Please\x20try\x20again\x20later.');}}),this[_0x2ce0d8(0x229)][_0x2ce0d8(0x288)](/\/status/,async _0x2c1bae=>{const _0x4e5bf8=_0x2ce0d8,_0x63090a=_0x2c1bae[_0x4e5bf8(0x256)]['id'],_0x2027a0=_0x2c1bae['from']?.['id'][_0x4e5bf8(0x227)]();if(!_0x2027a0)return;try{const _0x1cca5d=await database_1['default'][_0x4e5bf8(0x235)][_0x4e5bf8(0x21c)]({'where':{'telegramId':_0x2027a0},'include':{'shop':!![]}});if(!_0x1cca5d){await this[_0x4e5bf8(0x229)]?.[_0x4e5bf8(0x276)](_0x63090a,_0x4e5bf8(0x224)+_0x4e5bf8(0x24d));return;}if(!_0x1cca5d['isVerified']||!_0x1cca5d[_0x4e5bf8(0x1db)]||!_0x1cca5d[_0x4e5bf8(0x1d2)]){await this[_0x4e5bf8(0x229)]?.[_0x4e5bf8(0x276)](_0x63090a,'❌\x20You\x20are\x20not\x20connected\x20to\x20a\x20shop.\x0a\x0a'+_0x4e5bf8(0x270));return;}await this[_0x4e5bf8(0x229)]?.[_0x4e5bf8(0x276)](_0x63090a,_0x4e5bf8(0x1f0)+(_0x4e5bf8(0x295)+_0x1cca5d['shop'][_0x4e5bf8(0x27d)]+'*\x0a')+(_0x4e5bf8(0x1ef)+_0x1cca5d[_0x4e5bf8(0x1d2)][_0x4e5bf8(0x277)]+'`\x0a')+('📅\x20Connection\x20date:\x20'+_0x1cca5d['updatedAt']['toLocaleDateString'](_0x4e5bf8(0x293))+'\x0a\x0a')+_0x4e5bf8(0x22a)+_0x4e5bf8(0x285)+_0x4e5bf8(0x29c),{'parse_mode':_0x4e5bf8(0x259)});}catch(_0x57a1cd){console[_0x4e5bf8(0x21b)](_0x4e5bf8(0x1cb),_0x57a1cd),await this[_0x4e5bf8(0x229)]?.[_0x4e5bf8(0x276)](_0x63090a,'❌\x20An\x20error\x20occurred.\x20Please\x20try\x20again\x20later.');}}),this[_0x2ce0d8(0x229)][_0x2ce0d8(0x288)](/\/debug/,async _0xde1463=>{const _0x3d2e1b=_0x2ce0d8,_0x23fbdf=_0xde1463[_0x3d2e1b(0x256)]['id'],_0x174a7c=_0xde1463[_0x3d2e1b(0x27c)]?.['id']['toString']();if(!_0x174a7c)return;try{const _0x4eb1c8=await database_1[_0x3d2e1b(0x1f8)][_0x3d2e1b(0x1d2)][_0x3d2e1b(0x217)]({'select':{'id':!![],'name':!![],'username':!![],'status':!![],'publicKey':!![]},'take':0xa});let _0x573998='🔍\x20*Debug\x20Information*\x0a\x0a';_0x573998+=_0x3d2e1b(0x2a3)+_0x174a7c+_0x3d2e1b(0x2a1),_0x573998+=_0x3d2e1b(0x283),_0x4eb1c8[_0x3d2e1b(0x292)]((_0x3bf714,_0x2bacd0)=>{const _0x26f884=_0x3d2e1b;_0x573998+=_0x2bacd0+0x1+_0x26f884(0x237)+_0x3bf714[_0x26f884(0x27d)]+'*\x0a',_0x573998+=_0x26f884(0x236)+_0x3bf714[_0x26f884(0x277)]+'`\x0a',_0x573998+=_0x26f884(0x25e)+_0x3bf714[_0x26f884(0x1d5)]+'\x0a',_0x573998+=_0x26f884(0x262)+_0x3bf714[_0x26f884(0x1cc)][_0x26f884(0x252)](0x0,0xf)+_0x26f884(0x218);}),await this[_0x3d2e1b(0x229)]?.[_0x3d2e1b(0x276)](_0x23fbdf,_0x573998,{'parse_mode':_0x3d2e1b(0x259)});}catch(_0x4b1436){console[_0x3d2e1b(0x21b)](_0x3d2e1b(0x200),_0x4b1436),await this[_0x3d2e1b(0x229)]?.[_0x3d2e1b(0x276)](_0x23fbdf,_0x3d2e1b(0x215));}}),this[_0x2ce0d8(0x229)]['on'](_0x2ce0d8(0x291),async _0x47f6c0=>{const _0x4e22e8=_0x2ce0d8;if(_0x47f6c0[_0x4e22e8(0x25d)]?.[_0x4e22e8(0x266)]('/'))return;const _0x100593=_0x47f6c0[_0x4e22e8(0x256)]['id'],_0x5b9628=_0x47f6c0[_0x4e22e8(0x27c)]?.['id'][_0x4e22e8(0x227)](),_0x5bbabd=_0x47f6c0['text']?.['trim']();if(!_0x5b9628||!_0x5bbabd)return;try{const _0x3e4f09=await database_1[_0x4e22e8(0x1f8)]['telegramUser'][_0x4e22e8(0x21c)]({'where':{'telegramId':_0x5b9628},'include':{'shop':!![]}});if(!_0x3e4f09){await this[_0x4e22e8(0x229)]?.[_0x4e22e8(0x276)](_0x100593,_0x4e22e8(0x269));return;}if(_0x3e4f09[_0x4e22e8(0x2a0)]&&_0x3e4f09[_0x4e22e8(0x1db)]&&_0x3e4f09['shop']){await this['bot']?.[_0x4e22e8(0x276)](_0x100593,_0x4e22e8(0x280)+_0x3e4f09['shop'][_0x4e22e8(0x27d)]+_0x4e22e8(0x265)+_0x4e22e8(0x206),{'parse_mode':'Markdown'});return;}const _0x2fd3ee=_0x5bbabd[_0x4e22e8(0x1c8)](/\s+/);if(_0x2fd3ee[_0x4e22e8(0x29a)]!==0x2){await this['bot']?.[_0x4e22e8(0x276)](_0x100593,_0x4e22e8(0x23f)+'📝\x20Format:\x20`username\x20api_key`\x0a\x0a'+'Example:\x0a'+_0x4e22e8(0x219)+('You\x20sent\x20'+_0x2fd3ee[_0x4e22e8(0x29a)]+_0x4e22e8(0x239)+_0x2fd3ee[_0x4e22e8(0x240)](_0x5e6896=>'`'+_0x5e6896+'`')[_0x4e22e8(0x247)](',\x20')),{'parse_mode':'Markdown'});return;}const [_0x42654b,_0x3ea1fb]=_0x2fd3ee;console[_0x4e22e8(0x2a8)](_0x4e22e8(0x213)+_0x5b9628+_0x4e22e8(0x275)+_0x42654b+_0x4e22e8(0x25f)+_0x3ea1fb['substring'](0x0,0xa)+_0x4e22e8(0x203)),await this[_0x4e22e8(0x26e)](_0x100593,_0x5b9628,_0x42654b,_0x3ea1fb);}catch(_0x33f228){console[_0x4e22e8(0x21b)](_0x4e22e8(0x1e5),_0x33f228),await this[_0x4e22e8(0x229)]?.[_0x4e22e8(0x276)](_0x100593,'❌\x20An\x20error\x20occurred.\x20Please\x20try\x20again\x20later.');}}),this[_0x2ce0d8(0x229)]['on'](_0x2ce0d8(0x21b),_0x3409ab=>{const _0x24074f=_0x2ce0d8;console[_0x24074f(0x21b)]('Telegram\x20bot\x20error:',_0x3409ab);}),this[_0x2ce0d8(0x229)]['on'](_0x2ce0d8(0x1da),_0x54b8c2=>{const _0x10b37e=_0x2ce0d8;console[_0x10b37e(0x21b)](_0x10b37e(0x1ff),_0x54b8c2);});}async[a58_0x13e0b2(0x26e)](_0x343357,_0x50113f,_0x374a2a,_0x5bdbaa){const _0x5d9db6=a58_0x13e0b2;try{console[_0x5d9db6(0x2a8)](_0x5d9db6(0x213)+_0x50113f+_0x5d9db6(0x275)+_0x374a2a+_0x5d9db6(0x25f)+_0x5bdbaa['substring'](0x0,0xa)+_0x5d9db6(0x203));if(!_0x374a2a||_0x374a2a['length']<0x3||_0x374a2a['length']>0x32||!/^[a-zA-Z0-9_]+$/[_0x5d9db6(0x1e9)](_0x374a2a)){await this[_0x5d9db6(0x229)]?.[_0x5d9db6(0x276)](_0x343357,_0x5d9db6(0x23c)+_0x374a2a+_0x5d9db6(0x2a1)+_0x5d9db6(0x244),{'parse_mode':'Markdown'});return;}if(!_0x5bdbaa||!_0x5bdbaa[_0x5d9db6(0x266)](_0x5d9db6(0x20b))&&!_0x5bdbaa[_0x5d9db6(0x266)](_0x5d9db6(0x21a))){await this[_0x5d9db6(0x229)]?.['sendMessage'](_0x343357,'❌\x20Invalid\x20API\x20key\x20format.\x0a\x0a'+'API\x20key\x20must\x20start\x20with\x20`pk\x5c_`\x20or\x20`sk\x5c_`.',{'parse_mode':_0x5d9db6(0x259)});return;}const _0xf356f9=await database_1[_0x5d9db6(0x1f8)][_0x5d9db6(0x1d2)]['findUnique']({'where':{'username':_0x374a2a},'select':{'id':!![],'name':!![],'username':!![],'status':!![],'publicKey':!![],'secretKey':!![]}});if(!_0xf356f9){const _0x2373db=await database_1[_0x5d9db6(0x1f8)][_0x5d9db6(0x1d2)]['findMany']({'select':{'username':!![],'name':!![]},'take':0x5});let _0x18e2c0=_0x5d9db6(0x22f)+_0x374a2a+_0x5d9db6(0x231);_0x2373db[_0x5d9db6(0x29a)]>0x0?(_0x18e2c0+=_0x5d9db6(0x226),_0x2373db['forEach'](_0x457e89=>{const _0x1a5c51=_0x5d9db6;_0x18e2c0+=_0x1a5c51(0x1ed)+_0x457e89[_0x1a5c51(0x277)]+'`\x20('+_0x457e89[_0x1a5c51(0x27d)]+')\x0a';}),_0x18e2c0+=_0x5d9db6(0x253)):_0x18e2c0+=_0x5d9db6(0x290);await this[_0x5d9db6(0x229)]?.[_0x5d9db6(0x276)](_0x343357,_0x18e2c0,{'parse_mode':_0x5d9db6(0x259)});return;}if(_0xf356f9[_0x5d9db6(0x1d5)]!==_0x5d9db6(0x22e)){await this[_0x5d9db6(0x229)]?.[_0x5d9db6(0x276)](_0x343357,_0x5d9db6(0x297)+_0x374a2a+_0x5d9db6(0x234)+'Contact\x20administrator.',{'parse_mode':_0x5d9db6(0x259)});return;}if(_0xf356f9[_0x5d9db6(0x1cc)]!==_0x5bdbaa&&_0xf356f9[_0x5d9db6(0x258)]!==_0x5bdbaa){await this[_0x5d9db6(0x229)]?.[_0x5d9db6(0x276)](_0x343357,'❌\x20API\x20key\x20does\x20not\x20match\x20shop\x20`'+_0x374a2a+_0x5d9db6(0x1fa)+'Check\x20the\x20key\x20and\x20try\x20again.\x0a\x0a'+'Expected\x20key\x20format:\x20`pk_...`\x20or\x20`sk_...`',{'parse_mode':_0x5d9db6(0x259)});return;}const _0x3a28df=await database_1[_0x5d9db6(0x1f8)][_0x5d9db6(0x235)]['findFirst']({'where':{'shopId':_0xf356f9['id'],'isVerified':!![],'telegramId':{'not':_0x50113f}}});if(_0x3a28df){await this[_0x5d9db6(0x229)]?.['sendMessage'](_0x343357,_0x5d9db6(0x260)+_0x374a2a+_0x5d9db6(0x1fa)+_0x5d9db6(0x284),{'parse_mode':_0x5d9db6(0x259)});return;}await database_1[_0x5d9db6(0x1f8)][_0x5d9db6(0x235)][_0x5d9db6(0x238)]({'where':{'telegramId':_0x50113f},'data':{'shopId':_0xf356f9['id'],'isVerified':!![]}}),await this[_0x5d9db6(0x229)]?.['sendMessage'](_0x343357,'🎉\x20*Congratulations!*\x0a\x0a'+_0x5d9db6(0x1f2)+('📱\x20Shop:\x20*'+_0xf356f9['name']+'*\x0a')+(_0x5d9db6(0x1ef)+_0xf356f9[_0x5d9db6(0x277)]+'`\x0a\x0a')+_0x5d9db6(0x28c)+_0x5d9db6(0x26b)+_0x5d9db6(0x1c9)+_0x5d9db6(0x233)+_0x5d9db6(0x20d)+_0x5d9db6(0x285)+'/status\x20-\x20check\x20connection\x20status\x0a'+_0x5d9db6(0x29c),{'parse_mode':_0x5d9db6(0x259)}),console['log'](_0x5d9db6(0x222)+_0x50113f+'\x20verified\x20for\x20shop\x20'+_0xf356f9[_0x5d9db6(0x277)]+_0x5d9db6(0x298));}catch(_0x196efe){console[_0x5d9db6(0x21b)](_0x5d9db6(0x249),_0x196efe),await this[_0x5d9db6(0x229)]?.[_0x5d9db6(0x276)](_0x343357,_0x5d9db6(0x245));}}async[a58_0x13e0b2(0x1d4)](_0xb03f15,_0xf6d96,_0x7bd7c3){const _0x281aaf=a58_0x13e0b2;if(!this[_0x281aaf(0x229)]){console[_0x281aaf(0x29b)](_0x281aaf(0x2a4));return;}try{const _0xd16279=await database_1[_0x281aaf(0x1f8)]['telegramUser']['findMany']({'where':{'shopId':_0xb03f15,'isVerified':!![]}});if(_0xd16279[_0x281aaf(0x29a)]===0x0){console[_0x281aaf(0x2a8)](_0x281aaf(0x1ee)+_0xb03f15);return;}const _0x4ac241=_0xd16279['map'](async _0x1690ea=>{const _0x17da26=_0x281aaf;try{await this['bot']?.[_0x17da26(0x276)](_0x1690ea[_0x17da26(0x248)],_0xf6d96,_0x7bd7c3),console['log'](_0x17da26(0x207)+_0x1690ea[_0x17da26(0x248)]);}catch(_0x950b02){console[_0x17da26(0x21b)]('❌\x20Failed\x20to\x20send\x20notification\x20to\x20Telegram\x20user\x20'+_0x1690ea[_0x17da26(0x248)]+':',_0x950b02),_0x950b02 instanceof Error&&(_0x950b02['message'][_0x17da26(0x1f5)]('blocked')||_0x950b02[_0x17da26(0x291)][_0x17da26(0x1f5)]('chat\x20not\x20found')||_0x950b02[_0x17da26(0x291)][_0x17da26(0x1f5)](_0x17da26(0x2a2)))&&(await database_1[_0x17da26(0x1f8)][_0x17da26(0x235)][_0x17da26(0x238)]({'where':{'id':_0x1690ea['id']},'data':{'isVerified':![]}}),console['log'](_0x17da26(0x1e6)+_0x1690ea[_0x17da26(0x248)]+_0x17da26(0x1de)));}});await Promise[_0x281aaf(0x26a)](_0x4ac241);}catch(_0x181d30){console['error']('Error\x20sending\x20shop\x20notification:',_0x181d30);}}async['sendPaymentNotification'](_0x231594,_0x395759,_0x177ef5){const _0x5bc466=a58_0x13e0b2,_0x2066e0={'created':'🆕','paid':'✅','failed':'❌','expired':'⏰','refund':'🔄','chargeback':'⚠️','processing':'⚙️'},_0x226188={'created':_0x5bc466(0x26d),'paid':_0x5bc466(0x1e1),'failed':_0x5bc466(0x22d),'expired':'Payment\x20expired','refund':'Payment\x20refund','chargeback':'Payment\x20chargeback','processing':_0x5bc466(0x23a)},_0x1d2f75=_0x2066e0[_0x177ef5],_0x246178=_0x226188[_0x177ef5],_0x43518b=(0x0,gateway_1[_0x5bc466(0x1e8)])(_0x395759[_0x5bc466(0x223)]);console[_0x5bc466(0x2a8)]('📱\x20Telegram\x20notification:\x20gateway\x20\x22'+_0x395759['gateway']+'\x22\x20->\x20display\x20\x22'+_0x43518b+'\x22');let _0x196a15=_0x1d2f75+'\x20*'+_0x246178+_0x5bc466(0x23b)+(_0x5bc466(0x281)+_0x395759[_0x5bc466(0x1dd)]+'\x20'+_0x395759[_0x5bc466(0x279)]+'*\x0a')+(_0x5bc466(0x1e3)+(_0x395759[_0x5bc466(0x1fd)]||_0x395759['id'])+'`\x0a')+(_0x5bc466(0x201)+_0x395759['id']+'`\x0a')+(_0x5bc466(0x257)+_0x43518b+'`\x0a')+('📅\x20Date:\x20'+new Date(_0x395759[_0x5bc466(0x273)])[_0x5bc466(0x21d)](_0x5bc466(0x293))+'\x0a');if(_0x395759[_0x5bc466(0x27f)]||_0x395759['customerEmail']||_0x395759[_0x5bc466(0x2a6)]||_0x395759[_0x5bc466(0x27e)]||_0x395759['customerUa']){_0x196a15+=_0x5bc466(0x1ce);_0x395759['customerName']&&(_0x196a15+=_0x5bc466(0x211)+_0x395759[_0x5bc466(0x27f)]+'`\x0a');_0x395759['customerEmail']&&(_0x196a15+=_0x5bc466(0x25a)+_0x395759['customerEmail']+'`\x0a');_0x395759[_0x5bc466(0x2a6)]&&(_0x196a15+='🏦\x20IBAN:\x20`'+_0x395759[_0x5bc466(0x2a6)]+'`\x0a');_0x395759[_0x5bc466(0x27e)]&&(_0x196a15+='🌐\x20IP:\x20`'+_0x395759[_0x5bc466(0x27e)]+'`\x0a');if(_0x395759['customerUa']){const _0x273fad=_0x395759[_0x5bc466(0x1df)][_0x5bc466(0x29a)]>0x32?_0x395759[_0x5bc466(0x1df)][_0x5bc466(0x252)](0x0,0x32)+_0x5bc466(0x1eb):_0x395759[_0x5bc466(0x1df)];_0x196a15+=_0x5bc466(0x251)+_0x273fad+'`\x0a';}}_0x177ef5===_0x5bc466(0x204)&&_0x395759[_0x5bc466(0x26c)]&&(_0x196a15+='💸\x20Penalty\x20amount:\x20*'+_0x395759['chargebackAmount']+_0x5bc466(0x24a)),_0x177ef5===_0x5bc466(0x263)&&(_0x196a15+=_0x5bc466(0x208)),_0x395759['adminNotes']&&(_0x196a15+=_0x5bc466(0x20e)+_0x395759[_0x5bc466(0x296)]+'\x0a'),await this[_0x5bc466(0x1d4)](_0x231594,_0x196a15,{'parse_mode':_0x5bc466(0x259)});}async['sendPayoutNotification'](_0x3c92f5,_0x1a8342,_0x3f8c50){const _0xf2df0a=a58_0x13e0b2,_0x2d7ae9={'created':'📤','completed':'✅','rejected':'❌'},_0xc3aba1={'created':_0xf2df0a(0x1f1),'completed':_0xf2df0a(0x243),'rejected':_0xf2df0a(0x241)},_0x132501=_0x2d7ae9[_0x3f8c50],_0x3b0eea=_0xc3aba1[_0x3f8c50],_0x262299=_0x132501+'\x20*'+_0x3b0eea+'*\x0a\x0a'+(_0xf2df0a(0x28e)+_0x1a8342[_0xf2df0a(0x1dd)]+_0xf2df0a(0x299))+('🏦\x20Method:\x20`'+_0x1a8342[_0xf2df0a(0x225)]+'`\x0a')+(_0xf2df0a(0x274)+_0x1a8342['id']+'`\x0a')+(_0xf2df0a(0x1d7)+new Date(_0x1a8342[_0xf2df0a(0x273)])[_0xf2df0a(0x21d)](_0xf2df0a(0x293))+'\x0a')+(_0x1a8342[_0xf2df0a(0x1cf)]?_0xf2df0a(0x205)+_0x1a8342[_0xf2df0a(0x1cf)]+'`':'');await this[_0xf2df0a(0x1d4)](_0x3c92f5,_0x262299,{'parse_mode':'Markdown'});}async[a58_0x13e0b2(0x25b)](_0x4a9761,_0x36d857){const _0x2d4b68=a58_0x13e0b2;try{const _0xa8e3ce=await database_1[_0x2d4b68(0x1f8)][_0x2d4b68(0x210)]['findUnique']({'where':{'shopId':_0x4a9761},'select':{'notificationLogin':!![]}});if(!_0xa8e3ce?.[_0x2d4b68(0x242)]){console[_0x2d4b68(0x2a8)](_0x2d4b68(0x1dc)+_0x4a9761);return;}const _0x576ad6=_0x36d857[_0x2d4b68(0x24b)]?'🔐':'🚨',_0x1faea6=_0x36d857['success']?_0x2d4b68(0x287):_0x2d4b68(0x212);let _0x55bfbd=_0x576ad6+'\x20*'+_0x1faea6+_0x2d4b68(0x23b)+(_0x2d4b68(0x1ef)+_0x36d857[_0x2d4b68(0x277)]+'`\x0a')+('📅\x20Time:\x20'+_0x36d857['timestamp'][_0x2d4b68(0x21d)](_0x2d4b68(0x293))+'\x0a');_0x36d857[_0x2d4b68(0x24f)]&&(_0x55bfbd+=_0x2d4b68(0x2a5)+_0x36d857[_0x2d4b68(0x24f)]+'`\x0a');if(_0x36d857[_0x2d4b68(0x267)]){const _0xf731df=_0x36d857[_0x2d4b68(0x267)][_0x2d4b68(0x29a)]>0x32?_0x36d857[_0x2d4b68(0x267)][_0x2d4b68(0x252)](0x0,0x32)+_0x2d4b68(0x1eb):_0x36d857[_0x2d4b68(0x267)];_0x55bfbd+=_0x2d4b68(0x251)+_0xf731df+'`\x0a';}!_0x36d857['success']&&(_0x55bfbd+=_0x2d4b68(0x268)),await this[_0x2d4b68(0x1d4)](_0x4a9761,_0x55bfbd,{'parse_mode':'Markdown'}),console[_0x2d4b68(0x2a8)](_0x2d4b68(0x1ec)+_0x4a9761+':\x20'+(_0x36d857['success']?_0x2d4b68(0x24b):'failed'));}catch(_0x5a7b98){console[_0x2d4b68(0x21b)](_0x2d4b68(0x228),_0x5a7b98);}}async[a58_0x13e0b2(0x1fb)](_0x3bcc0a,_0x24825a){const _0x4ae7d0=a58_0x13e0b2;try{const _0x386a2a=await database_1[_0x4ae7d0(0x1f8)][_0x4ae7d0(0x210)]['findUnique']({'where':{'shopId':_0x3bcc0a},'select':{'notificationApiError':!![]}});if(!_0x386a2a?.['notificationApiError']){console['log'](_0x4ae7d0(0x1f6)+_0x3bcc0a);return;}let _0x31f53c='🚨\x20*API\x20Error*\x0a\x0a'+(_0x4ae7d0(0x230)+_0x24825a['method']+'\x20'+_0x24825a[_0x4ae7d0(0x261)]+'`\x0a')+(_0x4ae7d0(0x232)+_0x24825a['timestamp'][_0x4ae7d0(0x21d)](_0x4ae7d0(0x293))+'\x0a');_0x24825a['statusCode']&&(_0x31f53c+=_0x4ae7d0(0x1d3)+_0x24825a[_0x4ae7d0(0x25c)]+'`\x0a'),_0x31f53c+='❌\x20Error:\x20`'+_0x24825a[_0x4ae7d0(0x27a)]+'`\x0a',_0x24825a[_0x4ae7d0(0x1cd)]&&(_0x31f53c+=_0x4ae7d0(0x28d)+_0x24825a['requestId']+'`\x0a'),_0x31f53c+=_0x4ae7d0(0x1e0),await this[_0x4ae7d0(0x1d4)](_0x3bcc0a,_0x31f53c,{'parse_mode':_0x4ae7d0(0x259)}),console[_0x4ae7d0(0x2a8)]('✅\x20API\x20error\x20notification\x20sent\x20for\x20shop\x20'+_0x3bcc0a+':\x20'+_0x24825a[_0x4ae7d0(0x261)]);}catch(_0x2e31f6){console['error'](_0x4ae7d0(0x1d1),_0x2e31f6);}}async[a58_0x13e0b2(0x1ea)](_0x2e4163,_0x387a44,_0x517f83){const _0x5201c=a58_0x13e0b2;let _0xfd25a2=_0x5201c(0x20f)+_0x387a44+_0x5201c(0x23b);for(const [_0x2f7ba9,_0x4d0f0e]of Object[_0x5201c(0x1fe)](_0x517f83)){_0x4d0f0e!==null&&_0x4d0f0e!==undefined&&(_0xfd25a2+=_0x2f7ba9+_0x5201c(0x27b)+_0x4d0f0e+'`\x0a');}await this[_0x5201c(0x1d4)](_0x2e4163,_0xfd25a2,{'parse_mode':_0x5201c(0x259)});}[a58_0x13e0b2(0x294)](){const _0x294dac=a58_0x13e0b2;return{'isActive':!!this[_0x294dac(0x229)],'username':this['botUsername']};}[a58_0x13e0b2(0x282)](){const _0x213edf=a58_0x13e0b2;this['bot']&&(this[_0x213edf(0x229)][_0x213edf(0x29e)](),this['bot']=null,console[_0x213edf(0x2a8)](_0x213edf(0x1e4)));}}function a58_0x278d(_0x4a9e93,_0x422e51){const _0x5a4085=a58_0x5a40();return a58_0x278d=function(_0x278de4,_0x421ec5){_0x278de4=_0x278de4-0x1c8;let _0x2817b6=_0x5a4085[_0x278de4];return _0x2817b6;},a58_0x278d(_0x4a9e93,_0x422e51);}exports[a58_0x13e0b2(0x23d)]=TelegramBotService,exports[a58_0x13e0b2(0x23e)]=new TelegramBotService();