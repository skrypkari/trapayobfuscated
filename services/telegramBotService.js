'use strict';function a54_0x373c(_0xb35a44,_0x30954f){const _0x378275=a54_0x3782();return a54_0x373c=function(_0x373c21,_0x453c5c){_0x373c21=_0x373c21-0xf1;let _0x304e8f=_0x378275[_0x373c21];return _0x304e8f;},a54_0x373c(_0xb35a44,_0x30954f);}const a54_0x3e506b=a54_0x373c;function a54_0x3782(){const _0xe70a95=['🏪\x20Gateway:\x20`','API\x20key\x20must\x20start\x20with\x20`pk\x5c_`\x20or\x20`sk\x5c_`.','Payment\x20failed','🔗\x20TXID:\x20`','\x20\x20\x20Status:\x20','❌\x20Another\x20Telegram\x20account\x20is\x20already\x20connected\x20to\x20shop\x20`','join','`\x20(','📱\x20Login\x20notifications\x20disabled\x20for\x20shop\x20','notificationApiError','gateway','../config/database','shop','\x20marked\x20as\x20unverified\x20due\x20to\x20delivery\x20failure','botToken','✅\x20You\x20have\x20been\x20successfully\x20disconnected\x20from\x20shop\x20*','`\x0a\x0a','❌\x20Shop\x20with\x20username\x20`',':\x20`','📛\x20Name:\x20`','pk_','❌\x20API\x20key\x20does\x20not\x20match\x20shop\x20`','chargebackAmount','substring','❌\x20Shop\x20`','currency','Successful\x20login','onText','•\x20New\x20payments\x0a','sendPaymentNotification',':\x20username=\x22','❌\x20Failed\x20to\x20initialize\x20Telegram\x20bot:','requestId','TelegramBotService','default','startsWith','first_name','New\x20payout\x20created','Error\x20handling\x20/start\x20command:','TELEGRAM_BOT_USERNAME','\x20disconnected\x20from\x20shop\x20','from','toLocaleString','method','🤖\x20Welcome\x20to\x20TRAPAY\x20notification\x20system!\x0a\x0a','❌\x20Failed\x20to\x20send\x20notification\x20to\x20Telegram\x20user\x20','endpoint','ipAddress','chargeback','failed','update','getBotInfo','📊\x20*Connection\x20Status*\x0a\x0a','notificationLogin','env','telegramBotService','sendPayoutNotification','Payment\x20expired','findMany','name','/status\x20-\x20check\x20connection\x20status\x0a','userAgent','New\x20payment\x20created','📱\x20Your\x20Telegram\x20ID:\x20`','text','To\x20reconnect,\x20use\x20the\x20/start\x20command','chat','✅\x20API\x20error\x20notification\x20sent\x20for\x20shop\x20','🚨\x20*API\x20Error*\x0a\x0a','Expected\x20key\x20format:\x20`pk_...`\x20or\x20`sk_...`','status','Error\x20handling\x20/disconnect\x20command:','ACTIVE','💸\x20Amount:\x20*','TELEGRAM_BOT_TOKEN\x20not\x20found\x20in\x20environment\x20variables','length','*.\x0a\x0a','❌\x20An\x20error\x20occurred.\x20Please\x20try\x20again\x20later.','Use\x20/status\x20to\x20check\x20status\x20or\x20/disconnect\x20to\x20disconnect.','❌\x20An\x20error\x20occurred\x20while\x20verifying\x20data.','Failed\x20login\x20attempt','blocked','customerName','txid','🔗\x20Endpoint:\x20`','sendApiErrorNotification','213024ZdaNZz','updatedAt','__importDefault','Disconnect\x20the\x20previous\x20account\x20first\x20or\x20contact\x20administrator.','...`\x0a\x0a','Payout\x20completed','✅\x20You\x20are\x20already\x20connected\x20to\x20shop\x20*','❌\x20Please\x20use\x20/start\x20command\x20first','TELEGRAM_BOT_TOKEN','setupBotHandlers','isVerified','20530ETAuTo','sendShopNotification','publicKey','1882869EEDQMy','📱\x20Created\x20new\x20Telegram\x20user:\x20','warn','en-US','map','❌\x20Invalid\x20username\x20format:\x20`','__esModule','🏦\x20Method:\x20`','timestamp','Payout\x20rejected','getGatewayDisplayNameForTelegram','📅\x20Connection\x20date:\x20','Markdown','Error\x20handling\x20/debug\x20command:','message','unknown\x20shop','split','entries','Error\x20in\x20handleSingleLineVerification:','🔔\x20Notifications\x20are\x20active\x0a\x0a','/disconnect\x20-\x20disconnect\x20from\x20notifications','...\x22','allSettled','\x20USD*\x0a','Telegram\x20bot\x20error:','❌\x20You\x20are\x20not\x20connected\x20to\x20a\x20shop.\x0a\x0a','polling_error','1398965sEpMyC','forEach','\x20parts:\x20','8YEmYgs','Use\x20/start\x20to\x20connect.','❌\x20Invalid\x20format.\x20Please\x20send\x20exactly\x202\x20parts\x20separated\x20by\x20space:\x0a\x0a','📅\x20Date:\x20','⏳\x20The\x20payment\x20is\x20currently\x20being\x20processed\x20by\x20the\x20gateway.\x0a','username','📊\x20Error\x20code:\x20`','❌\x20Error\x20getting\x20debug\x20information.','Username:\x20`','.\x20*','\x22\x20->\x20display\x20\x22','sk_','orderId','\x0a👤\x20*Customer\x20Information:*\x0a','../types/gateway','✅\x20Welcome\x20back!\x0a\x0a','toLocaleDateString','🔄\x20Processing\x20single-line\x20verification\x20for\x20user\x20','stopBot','3087vTnqwC','Telegram\x20bot\x20polling\x20error:','handleSingleLineVerification','last_name','✅\x20Telegram\x20user\x20','includes','205782uCDpbt','success','node-telegram-bot-api','🛑\x20Telegram\x20bot\x20stopped','168ZJDzjf','❌\x20Error:\x20`','shopId','✅\x20Telegram\x20bot\x20@','sendCustomNotification','You\x20sent\x20','Failed\x20to\x20send\x20API\x20error\x20notification:','findUnique','amount','...','Error\x20sending\x20shop\x20notification:','statusCode','\x22,\x20apiKey=\x22','📧\x20Email:\x20`','sendMessage','processing','defineProperty','1431558etNrWt','initializeBot','🔔\x20*','bot','Use\x20/start\x20to\x20begin.','`\x20not\x20found.\x0a\x0a','shopSettings','📅\x20Time:\x20','👤\x20Username:\x20`','Payment\x20chargeback','`.\x0a\x0a','Failed\x20to\x20send\x20login\x20notification:','🔔\x20You\x20will\x20now\x20receive\x20notifications\x20about:\x0a','`\x20is\x20inactive.\x0a\x0a','📝\x20Order\x20ID:\x20`','💸\x20Penalty\x20amount:\x20*','create','📱\x20API\x20error\x20notifications\x20disabled\x20for\x20shop\x20','Commands:\x0a','Check\x20spelling\x20and\x20try\x20again.','`appple\x20pk_aa6450d3f57afbefbb0f3f5be5ce6cca13037536afc5ccf14c81a6cbc7a07de5`\x0a\x0a','User\x20','🆔\x20Request\x20ID:\x20`','\x20(@','log','botUsername','toString','📱\x20Shop:\x20*','createdAt','•\x20`','•\x20Payment\x20status\x20changes\x0a','sendLoginNotification','trim','chat\x20not\x20found','📝\x20Format:\x20`username\x20api_key`\x0a\x0a','•\x20Payouts\x0a\x0a','telegramUser','❌\x20Invalid\x20API\x20key\x20format.\x0a\x0a','🔌\x20User\x20','error','No\x20verified\x20Telegram\x20users\x20found\x20for\x20shop\x20','\x20USDT*\x0a','\x0aCheck\x20spelling\x20and\x20try\x20again.','adminNotes','telegramId','\x20\x20\x20Username:\x20`'];a54_0x3782=function(){return _0xe70a95;};return a54_0x3782();}(function(_0xe2c7f1,_0x1f67cf){const _0x1909d3=a54_0x373c,_0x5c86b5=_0xe2c7f1();while(!![]){try{const _0x465514=parseInt(_0x1909d3(0x1b4))/0x1+parseInt(_0x1909d3(0x17a))/0x2+parseInt(_0x1909d3(0x17d))/0x3+-parseInt(_0x1909d3(0x19b))/0x4*(parseInt(_0x1909d3(0x198))/0x5)+-parseInt(_0x1909d3(0x16f))/0x6+-parseInt(_0x1909d3(0x1ae))/0x7*(-parseInt(_0x1909d3(0x1b8))/0x8)+parseInt(_0x1909d3(0x1c9))/0x9;if(_0x465514===_0x1f67cf)break;else _0x5c86b5['push'](_0x5c86b5['shift']());}catch(_0x39f6cc){_0x5c86b5['push'](_0x5c86b5['shift']());}}}(a54_0x3782,0x65c87));var __importDefault=this&&this[a54_0x3e506b(0x171)]||function(_0x21f33c){return _0x21f33c&&_0x21f33c['__esModule']?_0x21f33c:{'default':_0x21f33c};};Object[a54_0x3e506b(0x1c8)](exports,a54_0x3e506b(0x183),{'value':!![]}),exports[a54_0x3e506b(0x150)]=exports[a54_0x3e506b(0x13a)]=void 0x0;const node_telegram_bot_api_1=__importDefault(require(a54_0x3e506b(0x1b6))),database_1=__importDefault(require(a54_0x3e506b(0x124))),gateway_1=require(a54_0x3e506b(0x1a9));class TelegramBotService{constructor(){const _0x2f9993=a54_0x3e506b;this[_0x2f9993(0x1cc)]=null,this[_0x2f9993(0x127)]=process[_0x2f9993(0x14f)][_0x2f9993(0x177)]||'',this[_0x2f9993(0x104)]=process[_0x2f9993(0x14f)][_0x2f9993(0x140)]||'trapay_bot',this['botToken']?this[_0x2f9993(0x1ca)]():console[_0x2f9993(0x17f)](_0x2f9993(0x163));}['initializeBot'](){const _0x3ff67=a54_0x3e506b;try{this['bot']=new node_telegram_bot_api_1[(_0x3ff67(0x13b))](this[_0x3ff67(0x127)],{'polling':!![]}),this[_0x3ff67(0x178)](),console[_0x3ff67(0x103)](_0x3ff67(0x1bb)+this[_0x3ff67(0x104)]+'\x20initialized\x20successfully');}catch(_0x43cdf3){console[_0x3ff67(0x112)](_0x3ff67(0x138),_0x43cdf3);}}[a54_0x3e506b(0x178)](){const _0xe2b82e=a54_0x3e506b;if(!this[_0xe2b82e(0x1cc)])return;this[_0xe2b82e(0x1cc)][_0xe2b82e(0x134)](/\/start/,async _0x23e26b=>{const _0x1fa934=_0xe2b82e,_0x1f212d=_0x23e26b['chat']['id'],_0x146b7d=_0x23e26b['from']?.['id'][_0x1fa934(0x105)](),_0x5eca5f=_0x23e26b['from']?.[_0x1fa934(0x1a0)],_0x2aa6d9=_0x23e26b['from']?.[_0x1fa934(0x13d)],_0x3a92ea=_0x23e26b[_0x1fa934(0x142)]?.[_0x1fa934(0x1b1)];if(!_0x146b7d)return;try{let _0x7a701c=await database_1[_0x1fa934(0x13b)][_0x1fa934(0x10f)][_0x1fa934(0x1bf)]({'where':{'telegramId':_0x146b7d},'include':{'shop':!![]}});!_0x7a701c?(_0x7a701c=await database_1['default'][_0x1fa934(0x10f)][_0x1fa934(0xfb)]({'data':{'telegramId':_0x146b7d,'username':_0x5eca5f,'firstName':_0x2aa6d9,'lastName':_0x3a92ea,'isVerified':![],'shopId':null},'include':{'shop':!![]}}),console[_0x1fa934(0x103)](_0x1fa934(0x17e)+_0x146b7d+_0x1fa934(0x102)+_0x5eca5f+')')):_0x7a701c=await database_1['default'][_0x1fa934(0x10f)][_0x1fa934(0x14b)]({'where':{'telegramId':_0x146b7d},'data':{'username':_0x5eca5f,'firstName':_0x2aa6d9,'lastName':_0x3a92ea},'include':{'shop':!![]}}),_0x7a701c[_0x1fa934(0x179)]&&_0x7a701c[_0x1fa934(0x1ba)]&&_0x7a701c[_0x1fa934(0x125)]?await this[_0x1fa934(0x1cc)]?.['sendMessage'](_0x1f212d,_0x1fa934(0x1aa)+('You\x20are\x20already\x20connected\x20to\x20shop:\x20*'+_0x7a701c[_0x1fa934(0x125)][_0x1fa934(0x154)]+'*\x0a')+(_0x1fa934(0x1a3)+_0x7a701c[_0x1fa934(0x125)]['username']+'`\x0a\x0a')+'🔔\x20You\x20receive\x20notifications\x20about:\x0a'+_0x1fa934(0x135)+_0x1fa934(0x109)+_0x1fa934(0x10e)+'Commands:\x0a'+_0x1fa934(0x155)+'/disconnect\x20-\x20disconnect\x20from\x20notifications',{'parse_mode':_0x1fa934(0x189)}):(_0x7a701c['shopId']&&!_0x7a701c[_0x1fa934(0x179)]&&(await database_1[_0x1fa934(0x13b)][_0x1fa934(0x10f)][_0x1fa934(0x14b)]({'where':{'telegramId':_0x146b7d},'data':{'shopId':null,'isVerified':![]}}),console['log']('🔄\x20Reset\x20incomplete\x20verification\x20for\x20user\x20'+_0x146b7d)),await this['bot']?.['sendMessage'](_0x1f212d,_0x1fa934(0x145)+'To\x20receive\x20payment\x20notifications,\x20send\x20your\x20credentials\x20in\x20one\x20line:\x0a\x0a'+_0x1fa934(0x10d)+'Example:\x0a'+_0x1fa934(0xff)+'❗️\x20Make\x20sure\x20to\x20separate\x20username\x20and\x20API\x20key\x20with\x20a\x20space!',{'parse_mode':'Markdown'}));}catch(_0x348b03){console[_0x1fa934(0x112)](_0x1fa934(0x13f),_0x348b03),await this['bot']?.[_0x1fa934(0x1c6)](_0x1f212d,_0x1fa934(0x166));}}),this[_0xe2b82e(0x1cc)][_0xe2b82e(0x134)](/\/disconnect/,async _0x2a3389=>{const _0x20b3c1=_0xe2b82e,_0x41a311=_0x2a3389[_0x20b3c1(0x15b)]['id'],_0x3af8c7=_0x2a3389[_0x20b3c1(0x142)]?.['id'][_0x20b3c1(0x105)]();if(!_0x3af8c7)return;try{const _0x10bc62=await database_1[_0x20b3c1(0x13b)][_0x20b3c1(0x10f)]['findUnique']({'where':{'telegramId':_0x3af8c7},'include':{'shop':!![]}});if(!_0x10bc62||!_0x10bc62[_0x20b3c1(0x179)]||!_0x10bc62[_0x20b3c1(0x1ba)]){await this[_0x20b3c1(0x1cc)]?.[_0x20b3c1(0x1c6)](_0x41a311,'❌\x20You\x20are\x20not\x20connected\x20to\x20the\x20notification\x20system.');return;}const _0x400c88=_0x10bc62[_0x20b3c1(0x125)]?.[_0x20b3c1(0x154)]||_0x20b3c1(0x18c);await database_1[_0x20b3c1(0x13b)][_0x20b3c1(0x10f)][_0x20b3c1(0x14b)]({'where':{'telegramId':_0x3af8c7},'data':{'shopId':null,'isVerified':![]}}),console[_0x20b3c1(0x103)](_0x20b3c1(0x111)+_0x3af8c7+_0x20b3c1(0x141)+_0x10bc62['shopId']),await this['bot']?.[_0x20b3c1(0x1c6)](_0x41a311,_0x20b3c1(0x128)+_0x400c88+'*.\x0a\x0a'+_0x20b3c1(0x15a),{'parse_mode':_0x20b3c1(0x189)});}catch(_0x1f1a6f){console['error'](_0x20b3c1(0x160),_0x1f1a6f),await this[_0x20b3c1(0x1cc)]?.[_0x20b3c1(0x1c6)](_0x41a311,_0x20b3c1(0x166));}}),this[_0xe2b82e(0x1cc)][_0xe2b82e(0x134)](/\/status/,async _0x3eb45a=>{const _0x347d45=_0xe2b82e,_0x4058b6=_0x3eb45a[_0x347d45(0x15b)]['id'],_0x122165=_0x3eb45a['from']?.['id'][_0x347d45(0x105)]();if(!_0x122165)return;try{const _0x4d34e4=await database_1[_0x347d45(0x13b)][_0x347d45(0x10f)]['findUnique']({'where':{'telegramId':_0x122165},'include':{'shop':!![]}});if(!_0x4d34e4){await this[_0x347d45(0x1cc)]?.[_0x347d45(0x1c6)](_0x4058b6,'❌\x20You\x20are\x20not\x20registered\x20in\x20the\x20system.\x0a\x0a'+_0x347d45(0x1cd));return;}if(!_0x4d34e4[_0x347d45(0x179)]||!_0x4d34e4[_0x347d45(0x1ba)]||!_0x4d34e4[_0x347d45(0x125)]){await this[_0x347d45(0x1cc)]?.[_0x347d45(0x1c6)](_0x4058b6,_0x347d45(0x196)+_0x347d45(0x19c));return;}await this['bot']?.[_0x347d45(0x1c6)](_0x4058b6,_0x347d45(0x14d)+('✅\x20Connected\x20to\x20shop:\x20*'+_0x4d34e4[_0x347d45(0x125)][_0x347d45(0x154)]+'*\x0a')+(_0x347d45(0xf3)+_0x4d34e4[_0x347d45(0x125)][_0x347d45(0x1a0)]+'`\x0a')+(_0x347d45(0x188)+_0x4d34e4[_0x347d45(0x170)][_0x347d45(0x1ab)](_0x347d45(0x180))+'\x0a\x0a')+_0x347d45(0x190)+_0x347d45(0xfd)+_0x347d45(0x191),{'parse_mode':'Markdown'});}catch(_0x4f43cf){console[_0x347d45(0x112)]('Error\x20handling\x20/status\x20command:',_0x4f43cf),await this[_0x347d45(0x1cc)]?.['sendMessage'](_0x4058b6,'❌\x20An\x20error\x20occurred.\x20Please\x20try\x20again\x20later.');}}),this['bot']['onText'](/\/debug/,async _0x114110=>{const _0x47777f=_0xe2b82e,_0x5bb6da=_0x114110[_0x47777f(0x15b)]['id'],_0x5a1bff=_0x114110['from']?.['id'][_0x47777f(0x105)]();if(!_0x5a1bff)return;try{const _0x58ff0f=await database_1['default'][_0x47777f(0x125)]['findMany']({'select':{'id':!![],'name':!![],'username':!![],'status':!![],'publicKey':!![]},'take':0xa});let _0xae954b='🔍\x20*Debug\x20Information*\x0a\x0a';_0xae954b+=_0x47777f(0x158)+_0x5a1bff+_0x47777f(0x129),_0xae954b+='🏪\x20Available\x20shops\x20in\x20system:\x0a',_0x58ff0f[_0x47777f(0x199)]((_0x15667a,_0xe82772)=>{const _0x31b313=_0x47777f;_0xae954b+=_0xe82772+0x1+_0x31b313(0x1a4)+_0x15667a[_0x31b313(0x154)]+'*\x0a',_0xae954b+=_0x31b313(0x118)+_0x15667a[_0x31b313(0x1a0)]+'`\x0a',_0xae954b+=_0x31b313(0x11d)+_0x15667a[_0x31b313(0x15f)]+'\x0a',_0xae954b+='\x20\x20\x20Public\x20Key:\x20`'+_0x15667a[_0x31b313(0x17c)][_0x31b313(0x130)](0x0,0xf)+_0x31b313(0x173);}),await this['bot']?.['sendMessage'](_0x5bb6da,_0xae954b,{'parse_mode':'Markdown'});}catch(_0x1b44e9){console[_0x47777f(0x112)](_0x47777f(0x18a),_0x1b44e9),await this[_0x47777f(0x1cc)]?.['sendMessage'](_0x5bb6da,_0x47777f(0x1a2));}}),this[_0xe2b82e(0x1cc)]['on'](_0xe2b82e(0x18b),async _0x230ce7=>{const _0x10e44a=_0xe2b82e;if(_0x230ce7[_0x10e44a(0x159)]?.[_0x10e44a(0x13c)]('/'))return;const _0x63858d=_0x230ce7[_0x10e44a(0x15b)]['id'],_0x21273e=_0x230ce7['from']?.['id'][_0x10e44a(0x105)](),_0x3425b0=_0x230ce7[_0x10e44a(0x159)]?.[_0x10e44a(0x10b)]();if(!_0x21273e||!_0x3425b0)return;try{const _0x14c766=await database_1['default'][_0x10e44a(0x10f)][_0x10e44a(0x1bf)]({'where':{'telegramId':_0x21273e},'include':{'shop':!![]}});if(!_0x14c766){await this[_0x10e44a(0x1cc)]?.[_0x10e44a(0x1c6)](_0x63858d,_0x10e44a(0x176));return;}if(_0x14c766[_0x10e44a(0x179)]&&_0x14c766[_0x10e44a(0x1ba)]&&_0x14c766['shop']){await this[_0x10e44a(0x1cc)]?.[_0x10e44a(0x1c6)](_0x63858d,_0x10e44a(0x175)+_0x14c766[_0x10e44a(0x125)]['name']+_0x10e44a(0x165)+_0x10e44a(0x167),{'parse_mode':_0x10e44a(0x189)});return;}const _0x2ef609=_0x3425b0[_0x10e44a(0x18d)](/\s+/);if(_0x2ef609[_0x10e44a(0x164)]!==0x2){await this[_0x10e44a(0x1cc)]?.[_0x10e44a(0x1c6)](_0x63858d,_0x10e44a(0x19d)+_0x10e44a(0x10d)+'Example:\x0a'+'`appple\x20pk_aa6450d3f57afbefbb0f3f5be5ce6cca13037536afc5ccf14c81a6cbc7a07de5`\x0a\x0a'+(_0x10e44a(0x1bd)+_0x2ef609[_0x10e44a(0x164)]+_0x10e44a(0x19a)+_0x2ef609[_0x10e44a(0x181)](_0xbbb8a3=>'`'+_0xbbb8a3+'`')[_0x10e44a(0x11f)](',\x20')),{'parse_mode':_0x10e44a(0x189)});return;}const [_0x23285c,_0x244c7a]=_0x2ef609;console[_0x10e44a(0x103)]('🔄\x20Processing\x20single-line\x20verification\x20for\x20user\x20'+_0x21273e+_0x10e44a(0x137)+_0x23285c+_0x10e44a(0x1c4)+_0x244c7a['substring'](0x0,0xa)+_0x10e44a(0x192)),await this[_0x10e44a(0x1b0)](_0x63858d,_0x21273e,_0x23285c,_0x244c7a);}catch(_0xc390e5){console['error']('Error\x20handling\x20message:',_0xc390e5),await this[_0x10e44a(0x1cc)]?.[_0x10e44a(0x1c6)](_0x63858d,_0x10e44a(0x166));}}),this[_0xe2b82e(0x1cc)]['on'](_0xe2b82e(0x112),_0x32d8f5=>{const _0x5a9305=_0xe2b82e;console[_0x5a9305(0x112)](_0x5a9305(0x195),_0x32d8f5);}),this[_0xe2b82e(0x1cc)]['on'](_0xe2b82e(0x197),_0x2d110b=>{const _0xd52a41=_0xe2b82e;console[_0xd52a41(0x112)](_0xd52a41(0x1af),_0x2d110b);});}async[a54_0x3e506b(0x1b0)](_0x344b11,_0x19646a,_0x4c82fb,_0x152499){const _0xc40063=a54_0x3e506b;try{console['log'](_0xc40063(0x1ac)+_0x19646a+_0xc40063(0x137)+_0x4c82fb+_0xc40063(0x1c4)+_0x152499[_0xc40063(0x130)](0x0,0xa)+_0xc40063(0x192));if(!_0x4c82fb||_0x4c82fb['length']<0x3||_0x4c82fb[_0xc40063(0x164)]>0x32||!/^[a-zA-Z0-9_]+$/['test'](_0x4c82fb)){await this['bot']?.['sendMessage'](_0x344b11,_0xc40063(0x182)+_0x4c82fb+_0xc40063(0x129)+'Username\x20must\x20contain\x20only\x20letters,\x20numbers\x20and\x20underscore\x20(3-50\x20characters).',{'parse_mode':_0xc40063(0x189)});return;}if(!_0x152499||!_0x152499[_0xc40063(0x13c)](_0xc40063(0x12d))&&!_0x152499['startsWith'](_0xc40063(0x1a6))){await this['bot']?.[_0xc40063(0x1c6)](_0x344b11,_0xc40063(0x110)+_0xc40063(0x11a),{'parse_mode':_0xc40063(0x189)});return;}const _0x4ec66b=await database_1['default'][_0xc40063(0x125)][_0xc40063(0x1bf)]({'where':{'username':_0x4c82fb},'select':{'id':!![],'name':!![],'username':!![],'status':!![],'publicKey':!![],'secretKey':!![]}});if(!_0x4ec66b){const _0x45a57d=await database_1[_0xc40063(0x13b)][_0xc40063(0x125)][_0xc40063(0x153)]({'select':{'username':!![],'name':!![]},'take':0x5});let _0x3cee95=_0xc40063(0x12a)+_0x4c82fb+_0xc40063(0x1ce);_0x45a57d[_0xc40063(0x164)]>0x0?(_0x3cee95+='Available\x20usernames:\x0a',_0x45a57d[_0xc40063(0x199)](_0x46ab80=>{const _0x10b825=_0xc40063;_0x3cee95+=_0x10b825(0x108)+_0x46ab80[_0x10b825(0x1a0)]+_0x10b825(0x120)+_0x46ab80['name']+')\x0a';}),_0x3cee95+=_0xc40063(0x115)):_0x3cee95+=_0xc40063(0xfe);await this[_0xc40063(0x1cc)]?.[_0xc40063(0x1c6)](_0x344b11,_0x3cee95,{'parse_mode':_0xc40063(0x189)});return;}if(_0x4ec66b['status']!==_0xc40063(0x161)){await this[_0xc40063(0x1cc)]?.[_0xc40063(0x1c6)](_0x344b11,_0xc40063(0x131)+_0x4c82fb+_0xc40063(0xf8)+'Contact\x20administrator.',{'parse_mode':'Markdown'});return;}if(_0x4ec66b[_0xc40063(0x17c)]!==_0x152499&&_0x4ec66b['secretKey']!==_0x152499){await this[_0xc40063(0x1cc)]?.[_0xc40063(0x1c6)](_0x344b11,_0xc40063(0x12e)+_0x4c82fb+_0xc40063(0xf5)+'Check\x20the\x20key\x20and\x20try\x20again.\x0a\x0a'+_0xc40063(0x15e),{'parse_mode':_0xc40063(0x189)});return;}const _0x27dd09=await database_1[_0xc40063(0x13b)][_0xc40063(0x10f)]['findFirst']({'where':{'shopId':_0x4ec66b['id'],'isVerified':!![],'telegramId':{'not':_0x19646a}}});if(_0x27dd09){await this[_0xc40063(0x1cc)]?.[_0xc40063(0x1c6)](_0x344b11,_0xc40063(0x11e)+_0x4c82fb+'`.\x0a\x0a'+_0xc40063(0x172),{'parse_mode':_0xc40063(0x189)});return;}await database_1[_0xc40063(0x13b)][_0xc40063(0x10f)][_0xc40063(0x14b)]({'where':{'telegramId':_0x19646a},'data':{'shopId':_0x4ec66b['id'],'isVerified':!![]}}),await this['bot']?.[_0xc40063(0x1c6)](_0x344b11,'🎉\x20*Congratulations!*\x0a\x0a'+'✅\x20You\x20have\x20been\x20successfully\x20connected\x20to\x20the\x20notification\x20system!\x0a\x0a'+(_0xc40063(0x106)+_0x4ec66b[_0xc40063(0x154)]+'*\x0a')+(_0xc40063(0xf3)+_0x4ec66b[_0xc40063(0x1a0)]+_0xc40063(0x129))+_0xc40063(0xf7)+_0xc40063(0x135)+_0xc40063(0x109)+'•\x20Payouts\x0a'+'•\x20Important\x20events\x0a\x0a'+_0xc40063(0xfd)+_0xc40063(0x155)+_0xc40063(0x191),{'parse_mode':'Markdown'}),console['log'](_0xc40063(0x1b2)+_0x19646a+'\x20verified\x20for\x20shop\x20'+_0x4ec66b[_0xc40063(0x1a0)]+'\x20via\x20single-line\x20input');}catch(_0x5439fe){console['error'](_0xc40063(0x18f),_0x5439fe),await this[_0xc40063(0x1cc)]?.[_0xc40063(0x1c6)](_0x344b11,_0xc40063(0x168));}}async[a54_0x3e506b(0x17b)](_0xc9e2a7,_0x46a3b6,_0x2a0c4b){const _0xaddd22=a54_0x3e506b;if(!this[_0xaddd22(0x1cc)]){console['warn']('Telegram\x20bot\x20not\x20initialized,\x20cannot\x20send\x20notification');return;}try{const _0x94ad0=await database_1[_0xaddd22(0x13b)][_0xaddd22(0x10f)][_0xaddd22(0x153)]({'where':{'shopId':_0xc9e2a7,'isVerified':!![]}});if(_0x94ad0[_0xaddd22(0x164)]===0x0){console[_0xaddd22(0x103)](_0xaddd22(0x113)+_0xc9e2a7);return;}const _0x56eb3e=_0x94ad0['map'](async _0x344d83=>{const _0x10605b=_0xaddd22;try{await this[_0x10605b(0x1cc)]?.[_0x10605b(0x1c6)](_0x344d83[_0x10605b(0x117)],_0x46a3b6,_0x2a0c4b),console[_0x10605b(0x103)]('✅\x20Notification\x20sent\x20to\x20Telegram\x20user\x20'+_0x344d83['telegramId']);}catch(_0x4e4561){console[_0x10605b(0x112)](_0x10605b(0x146)+_0x344d83[_0x10605b(0x117)]+':',_0x4e4561),_0x4e4561 instanceof Error&&(_0x4e4561[_0x10605b(0x18b)][_0x10605b(0x1b3)](_0x10605b(0x16a))||_0x4e4561['message'][_0x10605b(0x1b3)](_0x10605b(0x10c))||_0x4e4561[_0x10605b(0x18b)]['includes']('user\x20is\x20deactivated'))&&(await database_1['default']['telegramUser']['update']({'where':{'id':_0x344d83['id']},'data':{'isVerified':![]}}),console[_0x10605b(0x103)](_0x10605b(0x100)+_0x344d83['telegramId']+_0x10605b(0x126)));}});await Promise[_0xaddd22(0x193)](_0x56eb3e);}catch(_0x59b96e){console[_0xaddd22(0x112)](_0xaddd22(0x1c2),_0x59b96e);}}async[a54_0x3e506b(0x136)](_0x1f9bec,_0x19ddfe,_0xf7a39b){const _0x3eb451=a54_0x3e506b,_0x575f86={'created':'🆕','paid':'✅','failed':'❌','expired':'⏰','refund':'🔄','chargeback':'⚠️','processing':'⚙️'},_0x13360f={'created':_0x3eb451(0x157),'paid':'Payment\x20successfully\x20paid','failed':_0x3eb451(0x11b),'expired':_0x3eb451(0x152),'refund':'Payment\x20refund','chargeback':_0x3eb451(0xf4),'processing':'Payment\x20is\x20being\x20processed'},_0xdaf857=_0x575f86[_0xf7a39b],_0xbdc36f=_0x13360f[_0xf7a39b],_0x411a30=(0x0,gateway_1[_0x3eb451(0x187)])(_0x19ddfe[_0x3eb451(0x123)]);console[_0x3eb451(0x103)]('📱\x20Telegram\x20notification:\x20gateway\x20\x22'+_0x19ddfe[_0x3eb451(0x123)]+_0x3eb451(0x1a5)+_0x411a30+'\x22');let _0x1a97d0=_0xdaf857+'\x20*'+_0xbdc36f+'*\x0a\x0a'+('💰\x20Amount:\x20*'+_0x19ddfe[_0x3eb451(0x1c0)]+'\x20'+_0x19ddfe[_0x3eb451(0x132)]+'*\x0a')+(_0x3eb451(0xf9)+(_0x19ddfe[_0x3eb451(0x1a7)]||_0x19ddfe['id'])+'`\x0a')+('🆔\x20Payment\x20ID:\x20`'+_0x19ddfe['id']+'`\x0a')+(_0x3eb451(0x119)+_0x411a30+'`\x0a')+(_0x3eb451(0x19e)+new Date(_0x19ddfe[_0x3eb451(0x107)])[_0x3eb451(0x143)]('en-US')+'\x0a');(_0x19ddfe[_0x3eb451(0x16b)]||_0x19ddfe['customerEmail'])&&(_0x1a97d0+=_0x3eb451(0x1a8),_0x19ddfe[_0x3eb451(0x16b)]&&(_0x1a97d0+=_0x3eb451(0x12c)+_0x19ddfe[_0x3eb451(0x16b)]+'`\x0a'),_0x19ddfe['customerEmail']&&(_0x1a97d0+=_0x3eb451(0x1c5)+_0x19ddfe['customerEmail']+'`\x0a')),_0xf7a39b===_0x3eb451(0x149)&&_0x19ddfe[_0x3eb451(0x12f)]&&(_0x1a97d0+=_0x3eb451(0xfa)+_0x19ddfe[_0x3eb451(0x12f)]+_0x3eb451(0x114)),_0xf7a39b===_0x3eb451(0x1c7)&&(_0x1a97d0+=_0x3eb451(0x19f)),_0x19ddfe['adminNotes']&&(_0x1a97d0+='📝\x20Notes:\x20'+_0x19ddfe[_0x3eb451(0x116)]+'\x0a'),await this[_0x3eb451(0x17b)](_0x1f9bec,_0x1a97d0,{'parse_mode':_0x3eb451(0x189)});}async[a54_0x3e506b(0x151)](_0x24abd6,_0x81438d,_0x26fb52){const _0x1b19a0=a54_0x3e506b,_0x51cbf3={'created':'📤','completed':'✅','rejected':'❌'},_0x35b0d2={'created':_0x1b19a0(0x13e),'completed':_0x1b19a0(0x174),'rejected':_0x1b19a0(0x186)},_0x17009e=_0x51cbf3[_0x26fb52],_0x4b1593=_0x35b0d2[_0x26fb52],_0x3bf4f7=_0x17009e+'\x20*'+_0x4b1593+'*\x0a\x0a'+(_0x1b19a0(0x162)+_0x81438d[_0x1b19a0(0x1c0)]+_0x1b19a0(0x194))+(_0x1b19a0(0x184)+_0x81438d[_0x1b19a0(0x144)]+'`\x0a')+('🆔\x20Payout\x20ID:\x20`'+_0x81438d['id']+'`\x0a')+(_0x1b19a0(0x19e)+new Date(_0x81438d['createdAt'])[_0x1b19a0(0x143)](_0x1b19a0(0x180))+'\x0a')+(_0x81438d['txid']?_0x1b19a0(0x11c)+_0x81438d[_0x1b19a0(0x16c)]+'`':'');await this[_0x1b19a0(0x17b)](_0x24abd6,_0x3bf4f7,{'parse_mode':_0x1b19a0(0x189)});}async[a54_0x3e506b(0x10a)](_0x1af4b3,_0x2dfd4c){const _0x1af352=a54_0x3e506b;try{const _0x5c7f45=await database_1[_0x1af352(0x13b)][_0x1af352(0xf1)]['findUnique']({'where':{'shopId':_0x1af4b3},'select':{'notificationLogin':!![]}});if(!_0x5c7f45?.[_0x1af352(0x14e)]){console[_0x1af352(0x103)](_0x1af352(0x121)+_0x1af4b3);return;}const _0x372b0e=_0x2dfd4c[_0x1af352(0x1b5)]?'🔐':'🚨',_0x2bb6e4=_0x2dfd4c[_0x1af352(0x1b5)]?_0x1af352(0x133):_0x1af352(0x169);let _0x5a1c1f=_0x372b0e+'\x20*'+_0x2bb6e4+'*\x0a\x0a'+(_0x1af352(0xf3)+_0x2dfd4c[_0x1af352(0x1a0)]+'`\x0a')+(_0x1af352(0xf2)+_0x2dfd4c[_0x1af352(0x185)][_0x1af352(0x143)](_0x1af352(0x180))+'\x0a');_0x2dfd4c[_0x1af352(0x148)]&&(_0x5a1c1f+='🌐\x20IP\x20address:\x20`'+_0x2dfd4c[_0x1af352(0x148)]+'`\x0a');if(_0x2dfd4c[_0x1af352(0x156)]){const _0x13274b=_0x2dfd4c['userAgent'][_0x1af352(0x164)]>0x32?_0x2dfd4c['userAgent']['substring'](0x0,0x32)+_0x1af352(0x1c1):_0x2dfd4c[_0x1af352(0x156)];_0x5a1c1f+='💻\x20Browser:\x20`'+_0x13274b+'`\x0a';}!_0x2dfd4c[_0x1af352(0x1b5)]&&(_0x5a1c1f+='\x0a⚠️\x20If\x20this\x20wasn\x27t\x20you,\x20change\x20your\x20password\x20immediately!'),await this[_0x1af352(0x17b)](_0x1af4b3,_0x5a1c1f,{'parse_mode':'Markdown'}),console[_0x1af352(0x103)]('✅\x20Login\x20notification\x20sent\x20for\x20shop\x20'+_0x1af4b3+':\x20'+(_0x2dfd4c[_0x1af352(0x1b5)]?_0x1af352(0x1b5):_0x1af352(0x14a)));}catch(_0xcaec01){console[_0x1af352(0x112)](_0x1af352(0xf6),_0xcaec01);}}async[a54_0x3e506b(0x16e)](_0x2ab2c1,_0x4cc05c){const _0xab2a68=a54_0x3e506b;try{const _0x14cb41=await database_1[_0xab2a68(0x13b)][_0xab2a68(0xf1)][_0xab2a68(0x1bf)]({'where':{'shopId':_0x2ab2c1},'select':{'notificationApiError':!![]}});if(!_0x14cb41?.[_0xab2a68(0x122)]){console[_0xab2a68(0x103)](_0xab2a68(0xfc)+_0x2ab2c1);return;}let _0x54709c=_0xab2a68(0x15d)+(_0xab2a68(0x16d)+_0x4cc05c[_0xab2a68(0x144)]+'\x20'+_0x4cc05c[_0xab2a68(0x147)]+'`\x0a')+(_0xab2a68(0xf2)+_0x4cc05c[_0xab2a68(0x185)][_0xab2a68(0x143)](_0xab2a68(0x180))+'\x0a');_0x4cc05c['statusCode']&&(_0x54709c+=_0xab2a68(0x1a1)+_0x4cc05c[_0xab2a68(0x1c3)]+'`\x0a'),_0x54709c+=_0xab2a68(0x1b9)+_0x4cc05c['errorMessage']+'`\x0a',_0x4cc05c[_0xab2a68(0x139)]&&(_0x54709c+=_0xab2a68(0x101)+_0x4cc05c['requestId']+'`\x0a'),_0x54709c+='\x0a💡\x20Check\x20your\x20request\x20or\x20contact\x20support.',await this[_0xab2a68(0x17b)](_0x2ab2c1,_0x54709c,{'parse_mode':_0xab2a68(0x189)}),console['log'](_0xab2a68(0x15c)+_0x2ab2c1+':\x20'+_0x4cc05c[_0xab2a68(0x147)]);}catch(_0x159f89){console[_0xab2a68(0x112)](_0xab2a68(0x1be),_0x159f89);}}async[a54_0x3e506b(0x1bc)](_0x2feb9b,_0x49cc4f,_0x604b7e){const _0x3c7e14=a54_0x3e506b;let _0x33383e=_0x3c7e14(0x1cb)+_0x49cc4f+'*\x0a\x0a';for(const [_0x2be79d,_0x3a4109]of Object[_0x3c7e14(0x18e)](_0x604b7e)){_0x3a4109!==null&&_0x3a4109!==undefined&&(_0x33383e+=_0x2be79d+_0x3c7e14(0x12b)+_0x3a4109+'`\x0a');}await this[_0x3c7e14(0x17b)](_0x2feb9b,_0x33383e,{'parse_mode':_0x3c7e14(0x189)});}[a54_0x3e506b(0x14c)](){const _0x555563=a54_0x3e506b;return{'isActive':!!this[_0x555563(0x1cc)],'username':this[_0x555563(0x104)]};}[a54_0x3e506b(0x1ad)](){const _0x50ec4b=a54_0x3e506b;this[_0x50ec4b(0x1cc)]&&(this[_0x50ec4b(0x1cc)]['stopPolling'](),this['bot']=null,console[_0x50ec4b(0x103)](_0x50ec4b(0x1b7)));}}exports[a54_0x3e506b(0x13a)]=TelegramBotService,exports['telegramBotService']=new TelegramBotService();