'use strict';const a53_0x1858a0=a53_0x4653;(function(_0x541647,_0x453f68){const _0x146b36=a53_0x4653,_0x5decd7=_0x541647();while(!![]){try{const _0x5a9786=parseInt(_0x146b36(0x104))/0x1+parseInt(_0x146b36(0xc4))/0x2*(-parseInt(_0x146b36(0x101))/0x3)+parseInt(_0x146b36(0x129))/0x4+parseInt(_0x146b36(0x17e))/0x5+-parseInt(_0x146b36(0xf1))/0x6+-parseInt(_0x146b36(0x184))/0x7+parseInt(_0x146b36(0x127))/0x8;if(_0x5a9786===_0x453f68)break;else _0x5decd7['push'](_0x5decd7['shift']());}catch(_0x20cda6){_0x5decd7['push'](_0x5decd7['shift']());}}}(a53_0x9a90,0xf4180));function a53_0x9a90(){const _0x4fa22f=['amount','🛑\x20Telegram\x20bot\x20stopped','Commands:\x0a','✅\x20API\x20error\x20notification\x20sent\x20for\x20shop\x20','📱\x20Login\x20notifications\x20disabled\x20for\x20shop\x20','create','toLocaleDateString','/status\x20-\x20check\x20connection\x20status\x0a','unknown\x20shop','orderId','default','📊\x20*Connection\x20Status*\x0a\x0a','entries','❌\x20Invalid\x20API\x20key\x20format.\x0a\x0a','API\x20key\x20must\x20start\x20with\x20`pk\x5c_`\x20or\x20`sk\x5c_`.','🔍\x20*Debug\x20Information*\x0a\x0a','Error\x20sending\x20shop\x20notification:','Expected\x20key\x20format:\x20`pk_...`\x20or\x20`sk_...`','\x22\x20->\x20display\x20\x22','findMany','en-US','Payment\x20expired','chargebackAmount','error','•\x20`','❌\x20You\x20are\x20not\x20registered\x20in\x20the\x20system.\x0a\x0a','\x22,\x20apiKey=\x22','timestamp','../types/gateway','defineProperty','botToken','Telegram\x20bot\x20error:','📅\x20Connection\x20date:\x20','🏦\x20Method:\x20`','❌\x20You\x20are\x20not\x20connected\x20to\x20the\x20notification\x20system.','❗️\x20Make\x20sure\x20to\x20separate\x20username\x20and\x20API\x20key\x20with\x20a\x20space!','•\x20New\x20payments\x0a','Use\x20/start\x20to\x20begin.','warn','You\x20sent\x20','failed','\x20\x20\x20Username:\x20`','stopBot','customerEmail','`.\x0a\x0a','📝\x20Format:\x20`username\x20api_key`\x0a\x0a','Error\x20handling\x20message:','📛\x20Name:\x20`','log','startsWith','•\x20Important\x20events\x0a\x0a','•\x20Payouts\x0a','\x20\x20\x20Status:\x20','telegramUser','\x20USDT*\x0a','👤\x20Username:\x20`','shop','success','chargeback','sendShopNotification','...\x22','✅\x20You\x20are\x20already\x20connected\x20to\x20shop\x20*','Payment\x20chargeback','processing','Use\x20/start\x20to\x20connect.','📧\x20Email:\x20`','\x20initialized\x20successfully','📱\x20Telegram\x20notification:\x20gateway\x20\x22','__importDefault','✅\x20You\x20have\x20been\x20successfully\x20disconnected\x20from\x20shop\x20*','🆔\x20Request\x20ID:\x20`','substring','6983570vrNbBS','telegramBotService','📝\x20Notes:\x20','`\x0a\x0a','status','🚨\x20*API\x20Error*\x0a\x0a','425075muqJFU','customerName','✅\x20Welcome\x20back!\x0a\x0a','📊\x20Error\x20code:\x20`','shopSettings','❌\x20Failed\x20to\x20send\x20notification\x20to\x20Telegram\x20user\x20','❌\x20Invalid\x20format.\x20Please\x20send\x20exactly\x202\x20parts\x20separated\x20by\x20space:\x0a\x0a','🎉\x20*Congratulations!*\x0a\x0a','📱\x20API\x20error\x20notifications\x20disabled\x20for\x20shop\x20','Error\x20handling\x20/start\x20command:','map','../config/database','Failed\x20to\x20send\x20login\x20notification:','New\x20payout\x20created','adminNotes','❌\x20Please\x20use\x20/start\x20command\x20first','allSettled','name','2012dveJlz','findUnique','\x20via\x20single-line\x20input','Disconnect\x20the\x20previous\x20account\x20first\x20or\x20contact\x20administrator.','✅\x20Telegram\x20bot\x20@','No\x20verified\x20Telegram\x20users\x20found\x20for\x20shop\x20','first_name','txid','`appple\x20pk_aa6450d3f57afbefbb0f3f5be5ce6cca13037536afc5ccf14c81a6cbc7a07de5`\x0a\x0a','split','\x20\x20\x20Public\x20Key:\x20`','...','🏪\x20Gateway:\x20`','Use\x20/status\x20to\x20check\x20status\x20or\x20/disconnect\x20to\x20disconnect.','chat\x20not\x20found','TelegramBotService','chat','createdAt','Check\x20spelling\x20and\x20try\x20again.','•\x20Payouts\x0a\x0a','❌\x20An\x20error\x20occurred\x20while\x20verifying\x20data.','test','🔗\x20TXID:\x20`','__esModule','\x20USD*\x0a','secretKey','join','🔗\x20Endpoint:\x20`','errorMessage','userAgent','env','notificationLogin','length','💸\x20Amount:\x20*','updatedAt','setupBotHandlers','endpoint','Error\x20handling\x20/disconnect\x20command:','Telegram\x20bot\x20not\x20initialized,\x20cannot\x20send\x20notification','Payment\x20failed','message','TELEGRAM_BOT_TOKEN','sendPayoutNotification','ACTIVE','*.\x0a\x0a','5421630vbctZP','To\x20reconnect,\x20use\x20the\x20/start\x20command','from','Example:\x0a','publicKey','🔔\x20*','❌\x20Shop\x20with\x20username\x20`','includes','username','📅\x20Date:\x20','TELEGRAM_BOT_TOKEN\x20not\x20found\x20in\x20environment\x20variables','toString','*\x0a\x0a','shopId','sendPaymentNotification','⏳\x20The\x20payment\x20is\x20currently\x20being\x20processed\x20by\x20the\x20gateway.\x0a','1593WKEHpa','sendMessage','/disconnect\x20-\x20disconnect\x20from\x20notifications','71238RPnmSw','✅\x20Connected\x20to\x20shop:\x20*','bot','📱\x20Shop:\x20*','New\x20payment\x20created','✅\x20Notification\x20sent\x20to\x20Telegram\x20user\x20','🆔\x20Payout\x20ID:\x20`','\x20parts:\x20','❌\x20Failed\x20to\x20initialize\x20Telegram\x20bot:','Username:\x20`','method','Markdown','text','sendLoginNotification','❌\x20Shop\x20`','botUsername','toLocaleString','🔌\x20User\x20','Payment\x20successfully\x20paid','forEach','onText','Contact\x20administrator.','getGatewayDisplayNameForTelegram','isVerified','`\x20(','Error\x20handling\x20/status\x20command:','handleSingleLineVerification','📱\x20Created\x20new\x20Telegram\x20user:\x20','Available\x20usernames:\x0a','ipAddress','findFirst','`\x20is\x20inactive.\x0a\x0a','❌\x20Error\x20getting\x20debug\x20information.','📅\x20Time:\x20','❌\x20An\x20error\x20occurred.\x20Please\x20try\x20again\x20later.','4104512OBIjbM','Payout\x20rejected','2069232bGQtNI','requestId',':\x20username=\x22','initializeBot','...`\x0a\x0a','Failed\x20login\x20attempt','telegramId','update',':\x20`','🤖\x20Welcome\x20to\x20TRAPAY\x20notification\x20system!\x0a\x0a','Successful\x20login','🔄\x20Processing\x20single-line\x20verification\x20for\x20user\x20','📱\x20Your\x20Telegram\x20ID:\x20`'];a53_0x9a90=function(){return _0x4fa22f;};return a53_0x9a90();}var __importDefault=this&&this[a53_0x1858a0(0x17a)]||function(_0x4bdba5){const _0x29f5d7=a53_0x1858a0;return _0x4bdba5&&_0x4bdba5[_0x29f5d7(0xdb)]?_0x4bdba5:{'default':_0x4bdba5};};Object[a53_0x1858a0(0x153)](exports,a53_0x1858a0(0xdb),{'value':!![]}),exports['telegramBotService']=exports[a53_0x1858a0(0xd3)]=void 0x0;const node_telegram_bot_api_1=__importDefault(require('node-telegram-bot-api')),database_1=__importDefault(require(a53_0x1858a0(0xbd))),gateway_1=require(a53_0x1858a0(0x152));class TelegramBotService{constructor(){const _0x59bd62=a53_0x1858a0;this['bot']=null,this[_0x59bd62(0x154)]=process[_0x59bd62(0xe2)][_0x59bd62(0xed)]||'',this[_0x59bd62(0x113)]=process[_0x59bd62(0xe2)]['TELEGRAM_BOT_USERNAME']||'trapay_bot',this['botToken']?this[_0x59bd62(0x12c)]():console[_0x59bd62(0x15c)](_0x59bd62(0xfb));}[a53_0x1858a0(0x12c)](){const _0x28d542=a53_0x1858a0;try{this[_0x28d542(0x106)]=new node_telegram_bot_api_1['default'](this[_0x28d542(0x154)],{'polling':!![]}),this[_0x28d542(0xe7)](),console[_0x28d542(0x166)](_0x28d542(0xc8)+this[_0x28d542(0x113)]+_0x28d542(0x178));}catch(_0x13e399){console[_0x28d542(0x14d)](_0x28d542(0x10c),_0x13e399);}}[a53_0x1858a0(0xe7)](){const _0x480759=a53_0x1858a0;if(!this[_0x480759(0x106)])return;this['bot']['onText'](/\/start/,async _0x3c687e=>{const _0x4dfa9f=_0x480759,_0x4643f9=_0x3c687e[_0x4dfa9f(0xd4)]['id'],_0x3841d5=_0x3c687e[_0x4dfa9f(0xf3)]?.['id'][_0x4dfa9f(0xfc)](),_0x3bafe0=_0x3c687e['from']?.[_0x4dfa9f(0xf9)],_0x57059b=_0x3c687e[_0x4dfa9f(0xf3)]?.[_0x4dfa9f(0xca)],_0x3eb69f=_0x3c687e[_0x4dfa9f(0xf3)]?.['last_name'];if(!_0x3841d5)return;try{let _0x423628=await database_1[_0x4dfa9f(0x140)][_0x4dfa9f(0x16b)]['findUnique']({'where':{'telegramId':_0x3841d5},'include':{'shop':!![]}});!_0x423628?(_0x423628=await database_1[_0x4dfa9f(0x140)][_0x4dfa9f(0x16b)][_0x4dfa9f(0x13b)]({'data':{'telegramId':_0x3841d5,'username':_0x3bafe0,'firstName':_0x57059b,'lastName':_0x3eb69f,'isVerified':![],'shopId':null},'include':{'shop':!![]}}),console[_0x4dfa9f(0x166)](_0x4dfa9f(0x11f)+_0x3841d5+'\x20(@'+_0x3bafe0+')')):_0x423628=await database_1[_0x4dfa9f(0x140)][_0x4dfa9f(0x16b)][_0x4dfa9f(0x130)]({'where':{'telegramId':_0x3841d5},'data':{'username':_0x3bafe0,'firstName':_0x57059b,'lastName':_0x3eb69f},'include':{'shop':!![]}}),_0x423628['isVerified']&&_0x423628[_0x4dfa9f(0xfe)]&&_0x423628[_0x4dfa9f(0x16e)]?await this['bot']?.['sendMessage'](_0x4643f9,_0x4dfa9f(0x186)+('You\x20are\x20already\x20connected\x20to\x20shop:\x20*'+_0x423628[_0x4dfa9f(0x16e)][_0x4dfa9f(0xc3)]+'*\x0a')+(_0x4dfa9f(0x10d)+_0x423628['shop'][_0x4dfa9f(0xf9)]+_0x4dfa9f(0x181))+'🔔\x20You\x20receive\x20notifications\x20about:\x0a'+_0x4dfa9f(0x15a)+'•\x20Payment\x20status\x20changes\x0a'+_0x4dfa9f(0xd7)+'Commands:\x0a'+'/status\x20-\x20check\x20connection\x20status\x0a'+_0x4dfa9f(0x103),{'parse_mode':_0x4dfa9f(0x10f)}):(_0x423628['shopId']&&!_0x423628[_0x4dfa9f(0x11b)]&&(await database_1[_0x4dfa9f(0x140)][_0x4dfa9f(0x16b)][_0x4dfa9f(0x130)]({'where':{'telegramId':_0x3841d5},'data':{'shopId':null,'isVerified':![]}}),console[_0x4dfa9f(0x166)]('🔄\x20Reset\x20incomplete\x20verification\x20for\x20user\x20'+_0x3841d5)),await this[_0x4dfa9f(0x106)]?.[_0x4dfa9f(0x102)](_0x4643f9,_0x4dfa9f(0x132)+'To\x20receive\x20payment\x20notifications,\x20send\x20your\x20credentials\x20in\x20one\x20line:\x0a\x0a'+_0x4dfa9f(0x163)+_0x4dfa9f(0xf4)+_0x4dfa9f(0xcc)+_0x4dfa9f(0x159),{'parse_mode':'Markdown'}));}catch(_0xb5681a){console[_0x4dfa9f(0x14d)](_0x4dfa9f(0xbb),_0xb5681a),await this['bot']?.[_0x4dfa9f(0x102)](_0x4643f9,_0x4dfa9f(0x126));}}),this[_0x480759(0x106)]['onText'](/\/disconnect/,async _0x54313f=>{const _0x1b1e4d=_0x480759,_0x394056=_0x54313f['chat']['id'],_0x18b749=_0x54313f[_0x1b1e4d(0xf3)]?.['id']['toString']();if(!_0x18b749)return;try{const _0x3be3ab=await database_1[_0x1b1e4d(0x140)][_0x1b1e4d(0x16b)][_0x1b1e4d(0xc5)]({'where':{'telegramId':_0x18b749},'include':{'shop':!![]}});if(!_0x3be3ab||!_0x3be3ab[_0x1b1e4d(0x11b)]||!_0x3be3ab[_0x1b1e4d(0xfe)]){await this[_0x1b1e4d(0x106)]?.[_0x1b1e4d(0x102)](_0x394056,_0x1b1e4d(0x158));return;}const _0x1a09d3=_0x3be3ab[_0x1b1e4d(0x16e)]?.[_0x1b1e4d(0xc3)]||_0x1b1e4d(0x13e);await database_1[_0x1b1e4d(0x140)][_0x1b1e4d(0x16b)][_0x1b1e4d(0x130)]({'where':{'telegramId':_0x18b749},'data':{'shopId':null,'isVerified':![]}}),console[_0x1b1e4d(0x166)](_0x1b1e4d(0x115)+_0x18b749+'\x20disconnected\x20from\x20shop\x20'+_0x3be3ab['shopId']),await this[_0x1b1e4d(0x106)]?.[_0x1b1e4d(0x102)](_0x394056,_0x1b1e4d(0x17b)+_0x1a09d3+_0x1b1e4d(0xf0)+_0x1b1e4d(0xf2),{'parse_mode':_0x1b1e4d(0x10f)});}catch(_0x54224c){console[_0x1b1e4d(0x14d)](_0x1b1e4d(0xe9),_0x54224c),await this[_0x1b1e4d(0x106)]?.[_0x1b1e4d(0x102)](_0x394056,_0x1b1e4d(0x126));}}),this[_0x480759(0x106)]['onText'](/\/status/,async _0x5e99f4=>{const _0x443143=_0x480759,_0xf330be=_0x5e99f4[_0x443143(0xd4)]['id'],_0x1a94f3=_0x5e99f4[_0x443143(0xf3)]?.['id'][_0x443143(0xfc)]();if(!_0x1a94f3)return;try{const _0x5e6ae2=await database_1['default'][_0x443143(0x16b)][_0x443143(0xc5)]({'where':{'telegramId':_0x1a94f3},'include':{'shop':!![]}});if(!_0x5e6ae2){await this['bot']?.[_0x443143(0x102)](_0xf330be,_0x443143(0x14f)+_0x443143(0x15b));return;}if(!_0x5e6ae2[_0x443143(0x11b)]||!_0x5e6ae2['shopId']||!_0x5e6ae2[_0x443143(0x16e)]){await this['bot']?.['sendMessage'](_0xf330be,'❌\x20You\x20are\x20not\x20connected\x20to\x20a\x20shop.\x0a\x0a'+_0x443143(0x176));return;}await this['bot']?.[_0x443143(0x102)](_0xf330be,_0x443143(0x141)+(_0x443143(0x105)+_0x5e6ae2[_0x443143(0x16e)]['name']+'*\x0a')+(_0x443143(0x16d)+_0x5e6ae2[_0x443143(0x16e)][_0x443143(0xf9)]+'`\x0a')+(_0x443143(0x156)+_0x5e6ae2[_0x443143(0xe6)][_0x443143(0x13c)]('en-US')+'\x0a\x0a')+'🔔\x20Notifications\x20are\x20active\x0a\x0a'+_0x443143(0x138)+_0x443143(0x103),{'parse_mode':_0x443143(0x10f)});}catch(_0x519ade){console['error'](_0x443143(0x11d),_0x519ade),await this[_0x443143(0x106)]?.[_0x443143(0x102)](_0xf330be,_0x443143(0x126));}}),this['bot'][_0x480759(0x118)](/\/debug/,async _0x6cc840=>{const _0x55b5c0=_0x480759,_0x4c104c=_0x6cc840[_0x55b5c0(0xd4)]['id'],_0x3b1cc7=_0x6cc840[_0x55b5c0(0xf3)]?.['id']['toString']();if(!_0x3b1cc7)return;try{const _0x30c32f=await database_1[_0x55b5c0(0x140)][_0x55b5c0(0x16e)][_0x55b5c0(0x149)]({'select':{'id':!![],'name':!![],'username':!![],'status':!![],'publicKey':!![]},'take':0xa});let _0x211602=_0x55b5c0(0x145);_0x211602+=_0x55b5c0(0x135)+_0x3b1cc7+_0x55b5c0(0x181),_0x211602+='🏪\x20Available\x20shops\x20in\x20system:\x0a',_0x30c32f[_0x55b5c0(0x117)]((_0x5d6804,_0x4135da)=>{const _0x3be5d9=_0x55b5c0;_0x211602+=_0x4135da+0x1+'.\x20*'+_0x5d6804[_0x3be5d9(0xc3)]+'*\x0a',_0x211602+=_0x3be5d9(0x15f)+_0x5d6804[_0x3be5d9(0xf9)]+'`\x0a',_0x211602+=_0x3be5d9(0x16a)+_0x5d6804[_0x3be5d9(0x182)]+'\x0a',_0x211602+=_0x3be5d9(0xce)+_0x5d6804[_0x3be5d9(0xf5)]['substring'](0x0,0xf)+_0x3be5d9(0x12d);}),await this['bot']?.[_0x55b5c0(0x102)](_0x4c104c,_0x211602,{'parse_mode':_0x55b5c0(0x10f)});}catch(_0x1baa30){console[_0x55b5c0(0x14d)]('Error\x20handling\x20/debug\x20command:',_0x1baa30),await this[_0x55b5c0(0x106)]?.[_0x55b5c0(0x102)](_0x4c104c,_0x55b5c0(0x124));}}),this[_0x480759(0x106)]['on'](_0x480759(0xec),async _0x1be972=>{const _0x53f024=_0x480759;if(_0x1be972[_0x53f024(0x110)]?.['startsWith']('/'))return;const _0x17e82a=_0x1be972[_0x53f024(0xd4)]['id'],_0x366e17=_0x1be972['from']?.['id'][_0x53f024(0xfc)](),_0x5c5e09=_0x1be972['text']?.['trim']();if(!_0x366e17||!_0x5c5e09)return;try{const _0x1de50e=await database_1['default'][_0x53f024(0x16b)][_0x53f024(0xc5)]({'where':{'telegramId':_0x366e17},'include':{'shop':!![]}});if(!_0x1de50e){await this[_0x53f024(0x106)]?.['sendMessage'](_0x17e82a,_0x53f024(0xc1));return;}if(_0x1de50e[_0x53f024(0x11b)]&&_0x1de50e[_0x53f024(0xfe)]&&_0x1de50e[_0x53f024(0x16e)]){await this[_0x53f024(0x106)]?.[_0x53f024(0x102)](_0x17e82a,_0x53f024(0x173)+_0x1de50e['shop'][_0x53f024(0xc3)]+_0x53f024(0xf0)+_0x53f024(0xd1),{'parse_mode':_0x53f024(0x10f)});return;}const _0xeb7687=_0x5c5e09[_0x53f024(0xcd)](/\s+/);if(_0xeb7687[_0x53f024(0xe4)]!==0x2){await this[_0x53f024(0x106)]?.['sendMessage'](_0x17e82a,_0x53f024(0xb8)+'📝\x20Format:\x20`username\x20api_key`\x0a\x0a'+_0x53f024(0xf4)+_0x53f024(0xcc)+(_0x53f024(0x15d)+_0xeb7687[_0x53f024(0xe4)]+_0x53f024(0x10b)+_0xeb7687[_0x53f024(0xbc)](_0x28d282=>'`'+_0x28d282+'`')[_0x53f024(0xde)](',\x20')),{'parse_mode':'Markdown'});return;}const [_0xb35f3c,_0x3bc71d]=_0xeb7687;console[_0x53f024(0x166)]('🔄\x20Processing\x20single-line\x20verification\x20for\x20user\x20'+_0x366e17+_0x53f024(0x12b)+_0xb35f3c+_0x53f024(0x150)+_0x3bc71d['substring'](0x0,0xa)+_0x53f024(0x172)),await this[_0x53f024(0x11e)](_0x17e82a,_0x366e17,_0xb35f3c,_0x3bc71d);}catch(_0x47db13){console['error'](_0x53f024(0x164),_0x47db13),await this[_0x53f024(0x106)]?.[_0x53f024(0x102)](_0x17e82a,_0x53f024(0x126));}}),this[_0x480759(0x106)]['on']('error',_0x3dc489=>{const _0x266f72=_0x480759;console[_0x266f72(0x14d)](_0x266f72(0x155),_0x3dc489);}),this[_0x480759(0x106)]['on']('polling_error',_0xc8e569=>{console['error']('Telegram\x20bot\x20polling\x20error:',_0xc8e569);});}async[a53_0x1858a0(0x11e)](_0x58b7ca,_0x211f53,_0x4d93c2,_0x426936){const _0x54fe95=a53_0x1858a0;try{console[_0x54fe95(0x166)](_0x54fe95(0x134)+_0x211f53+':\x20username=\x22'+_0x4d93c2+_0x54fe95(0x150)+_0x426936[_0x54fe95(0x17d)](0x0,0xa)+_0x54fe95(0x172));if(!_0x4d93c2||_0x4d93c2['length']<0x3||_0x4d93c2[_0x54fe95(0xe4)]>0x32||!/^[a-zA-Z0-9_]+$/[_0x54fe95(0xd9)](_0x4d93c2)){await this[_0x54fe95(0x106)]?.[_0x54fe95(0x102)](_0x58b7ca,'❌\x20Invalid\x20username\x20format:\x20`'+_0x4d93c2+_0x54fe95(0x181)+'Username\x20must\x20contain\x20only\x20letters,\x20numbers\x20and\x20underscore\x20(3-50\x20characters).',{'parse_mode':_0x54fe95(0x10f)});return;}if(!_0x426936||!_0x426936[_0x54fe95(0x167)]('pk_')&&!_0x426936[_0x54fe95(0x167)]('sk_')){await this['bot']?.['sendMessage'](_0x58b7ca,_0x54fe95(0x143)+_0x54fe95(0x144),{'parse_mode':_0x54fe95(0x10f)});return;}const _0x22ab35=await database_1['default'][_0x54fe95(0x16e)][_0x54fe95(0xc5)]({'where':{'username':_0x4d93c2},'select':{'id':!![],'name':!![],'username':!![],'status':!![],'publicKey':!![],'secretKey':!![]}});if(!_0x22ab35){const _0x20ffe2=await database_1['default']['shop'][_0x54fe95(0x149)]({'select':{'username':!![],'name':!![]},'take':0x5});let _0x2812b6=_0x54fe95(0xf7)+_0x4d93c2+'`\x20not\x20found.\x0a\x0a';_0x20ffe2[_0x54fe95(0xe4)]>0x0?(_0x2812b6+=_0x54fe95(0x120),_0x20ffe2['forEach'](_0x363dae=>{const _0x44da94=_0x54fe95;_0x2812b6+=_0x44da94(0x14e)+_0x363dae[_0x44da94(0xf9)]+_0x44da94(0x11c)+_0x363dae['name']+')\x0a';}),_0x2812b6+='\x0aCheck\x20spelling\x20and\x20try\x20again.'):_0x2812b6+=_0x54fe95(0xd6);await this[_0x54fe95(0x106)]?.['sendMessage'](_0x58b7ca,_0x2812b6,{'parse_mode':_0x54fe95(0x10f)});return;}if(_0x22ab35[_0x54fe95(0x182)]!==_0x54fe95(0xef)){await this[_0x54fe95(0x106)]?.[_0x54fe95(0x102)](_0x58b7ca,_0x54fe95(0x112)+_0x4d93c2+_0x54fe95(0x123)+_0x54fe95(0x119),{'parse_mode':_0x54fe95(0x10f)});return;}if(_0x22ab35[_0x54fe95(0xf5)]!==_0x426936&&_0x22ab35[_0x54fe95(0xdd)]!==_0x426936){await this[_0x54fe95(0x106)]?.[_0x54fe95(0x102)](_0x58b7ca,'❌\x20API\x20key\x20does\x20not\x20match\x20shop\x20`'+_0x4d93c2+_0x54fe95(0x162)+'Check\x20the\x20key\x20and\x20try\x20again.\x0a\x0a'+_0x54fe95(0x147),{'parse_mode':_0x54fe95(0x10f)});return;}const _0x592bc5=await database_1[_0x54fe95(0x140)]['telegramUser'][_0x54fe95(0x122)]({'where':{'shopId':_0x22ab35['id'],'isVerified':!![],'telegramId':{'not':_0x211f53}}});if(_0x592bc5){await this[_0x54fe95(0x106)]?.[_0x54fe95(0x102)](_0x58b7ca,'❌\x20Another\x20Telegram\x20account\x20is\x20already\x20connected\x20to\x20shop\x20`'+_0x4d93c2+_0x54fe95(0x162)+_0x54fe95(0xc7),{'parse_mode':'Markdown'});return;}await database_1[_0x54fe95(0x140)]['telegramUser'][_0x54fe95(0x130)]({'where':{'telegramId':_0x211f53},'data':{'shopId':_0x22ab35['id'],'isVerified':!![]}}),await this[_0x54fe95(0x106)]?.[_0x54fe95(0x102)](_0x58b7ca,_0x54fe95(0xb9)+'✅\x20You\x20have\x20been\x20successfully\x20connected\x20to\x20the\x20notification\x20system!\x0a\x0a'+(_0x54fe95(0x107)+_0x22ab35[_0x54fe95(0xc3)]+'*\x0a')+(_0x54fe95(0x16d)+_0x22ab35[_0x54fe95(0xf9)]+_0x54fe95(0x181))+'🔔\x20You\x20will\x20now\x20receive\x20notifications\x20about:\x0a'+_0x54fe95(0x15a)+'•\x20Payment\x20status\x20changes\x0a'+_0x54fe95(0x169)+_0x54fe95(0x168)+'Commands:\x0a'+_0x54fe95(0x13d)+_0x54fe95(0x103),{'parse_mode':_0x54fe95(0x10f)}),console[_0x54fe95(0x166)]('✅\x20Telegram\x20user\x20'+_0x211f53+'\x20verified\x20for\x20shop\x20'+_0x22ab35[_0x54fe95(0xf9)]+_0x54fe95(0xc6));}catch(_0x25ca93){console['error']('Error\x20in\x20handleSingleLineVerification:',_0x25ca93),await this[_0x54fe95(0x106)]?.[_0x54fe95(0x102)](_0x58b7ca,_0x54fe95(0xd8));}}async[a53_0x1858a0(0x171)](_0x15803f,_0x2bfd64,_0x11104c){const _0x4f9e1c=a53_0x1858a0;if(!this[_0x4f9e1c(0x106)]){console[_0x4f9e1c(0x15c)](_0x4f9e1c(0xea));return;}try{const _0x2b7500=await database_1['default'][_0x4f9e1c(0x16b)][_0x4f9e1c(0x149)]({'where':{'shopId':_0x15803f,'isVerified':!![]}});if(_0x2b7500[_0x4f9e1c(0xe4)]===0x0){console[_0x4f9e1c(0x166)](_0x4f9e1c(0xc9)+_0x15803f);return;}const _0x3a0d50=_0x2b7500['map'](async _0x216cb7=>{const _0x437fb8=_0x4f9e1c;try{await this['bot']?.[_0x437fb8(0x102)](_0x216cb7['telegramId'],_0x2bfd64,_0x11104c),console[_0x437fb8(0x166)](_0x437fb8(0x109)+_0x216cb7['telegramId']);}catch(_0x17f7fa){console[_0x437fb8(0x14d)](_0x437fb8(0xb7)+_0x216cb7[_0x437fb8(0x12f)]+':',_0x17f7fa),_0x17f7fa instanceof Error&&(_0x17f7fa[_0x437fb8(0xec)]['includes']('blocked')||_0x17f7fa[_0x437fb8(0xec)][_0x437fb8(0xf8)](_0x437fb8(0xd2))||_0x17f7fa['message']['includes']('user\x20is\x20deactivated'))&&(await database_1[_0x437fb8(0x140)]['telegramUser'][_0x437fb8(0x130)]({'where':{'id':_0x216cb7['id']},'data':{'isVerified':![]}}),console[_0x437fb8(0x166)]('User\x20'+_0x216cb7[_0x437fb8(0x12f)]+'\x20marked\x20as\x20unverified\x20due\x20to\x20delivery\x20failure'));}});await Promise[_0x4f9e1c(0xc2)](_0x3a0d50);}catch(_0xe2706a){console[_0x4f9e1c(0x14d)](_0x4f9e1c(0x146),_0xe2706a);}}async[a53_0x1858a0(0xff)](_0x4f4a89,_0x38855c,_0x5f507f){const _0x26dc17=a53_0x1858a0,_0x554c8f={'created':'🆕','paid':'✅','failed':'❌','expired':'⏰','refund':'🔄','chargeback':'⚠️','processing':'⚙️'},_0x182670={'created':_0x26dc17(0x108),'paid':_0x26dc17(0x116),'failed':_0x26dc17(0xeb),'expired':_0x26dc17(0x14b),'refund':'Payment\x20refund','chargeback':_0x26dc17(0x174),'processing':'Payment\x20is\x20being\x20processed'},_0xa2681f=_0x554c8f[_0x5f507f],_0x266bc6=_0x182670[_0x5f507f],_0x1dbf14=(0x0,gateway_1[_0x26dc17(0x11a)])(_0x38855c['gateway']);console['log'](_0x26dc17(0x179)+_0x38855c['gateway']+_0x26dc17(0x148)+_0x1dbf14+'\x22');let _0x426cee=_0xa2681f+'\x20*'+_0x266bc6+_0x26dc17(0xfd)+('💰\x20Amount:\x20*'+_0x38855c[_0x26dc17(0x136)]+'\x20'+_0x38855c['currency']+'*\x0a')+('📝\x20Order\x20ID:\x20`'+(_0x38855c[_0x26dc17(0x13f)]||_0x38855c['id'])+'`\x0a')+('🆔\x20Payment\x20ID:\x20`'+_0x38855c['id']+'`\x0a')+(_0x26dc17(0xd0)+_0x1dbf14+'`\x0a')+(_0x26dc17(0xfa)+new Date(_0x38855c[_0x26dc17(0xd5)])[_0x26dc17(0x114)](_0x26dc17(0x14a))+'\x0a');(_0x38855c[_0x26dc17(0x185)]||_0x38855c[_0x26dc17(0x161)])&&(_0x426cee+='\x0a👤\x20*Customer\x20Information:*\x0a',_0x38855c['customerName']&&(_0x426cee+=_0x26dc17(0x165)+_0x38855c[_0x26dc17(0x185)]+'`\x0a'),_0x38855c[_0x26dc17(0x161)]&&(_0x426cee+=_0x26dc17(0x177)+_0x38855c[_0x26dc17(0x161)]+'`\x0a')),_0x5f507f===_0x26dc17(0x170)&&_0x38855c['chargebackAmount']&&(_0x426cee+='💸\x20Penalty\x20amount:\x20*'+_0x38855c[_0x26dc17(0x14c)]+_0x26dc17(0x16c)),_0x5f507f===_0x26dc17(0x175)&&(_0x426cee+=_0x26dc17(0x100)),_0x38855c[_0x26dc17(0xc0)]&&(_0x426cee+=_0x26dc17(0x180)+_0x38855c[_0x26dc17(0xc0)]+'\x0a'),await this['sendShopNotification'](_0x4f4a89,_0x426cee,{'parse_mode':_0x26dc17(0x10f)});}async[a53_0x1858a0(0xee)](_0x1a0d20,_0x5f372c,_0x496e66){const _0x2408b5=a53_0x1858a0,_0x1cd921={'created':'📤','completed':'✅','rejected':'❌'},_0xdc1be2={'created':_0x2408b5(0xbf),'completed':'Payout\x20completed','rejected':_0x2408b5(0x128)},_0x19f457=_0x1cd921[_0x496e66],_0x341ac1=_0xdc1be2[_0x496e66],_0x106dea=_0x19f457+'\x20*'+_0x341ac1+_0x2408b5(0xfd)+(_0x2408b5(0xe5)+_0x5f372c[_0x2408b5(0x136)]+_0x2408b5(0xdc))+(_0x2408b5(0x157)+_0x5f372c['method']+'`\x0a')+(_0x2408b5(0x10a)+_0x5f372c['id']+'`\x0a')+(_0x2408b5(0xfa)+new Date(_0x5f372c['createdAt'])['toLocaleString'](_0x2408b5(0x14a))+'\x0a')+(_0x5f372c[_0x2408b5(0xcb)]?_0x2408b5(0xda)+_0x5f372c[_0x2408b5(0xcb)]+'`':'');await this['sendShopNotification'](_0x1a0d20,_0x106dea,{'parse_mode':_0x2408b5(0x10f)});}async[a53_0x1858a0(0x111)](_0x35aa9d,_0x3259a6){const _0xa3770f=a53_0x1858a0;try{const _0x3daa70=await database_1[_0xa3770f(0x140)][_0xa3770f(0x188)][_0xa3770f(0xc5)]({'where':{'shopId':_0x35aa9d},'select':{'notificationLogin':!![]}});if(!_0x3daa70?.[_0xa3770f(0xe3)]){console[_0xa3770f(0x166)](_0xa3770f(0x13a)+_0x35aa9d);return;}const _0x5ce2a3=_0x3259a6[_0xa3770f(0x16f)]?'🔐':'🚨',_0x3b490f=_0x3259a6[_0xa3770f(0x16f)]?_0xa3770f(0x133):_0xa3770f(0x12e);let _0x3dc3fa=_0x5ce2a3+'\x20*'+_0x3b490f+_0xa3770f(0xfd)+(_0xa3770f(0x16d)+_0x3259a6[_0xa3770f(0xf9)]+'`\x0a')+(_0xa3770f(0x125)+_0x3259a6[_0xa3770f(0x151)]['toLocaleString'](_0xa3770f(0x14a))+'\x0a');_0x3259a6[_0xa3770f(0x121)]&&(_0x3dc3fa+='🌐\x20IP\x20address:\x20`'+_0x3259a6[_0xa3770f(0x121)]+'`\x0a');if(_0x3259a6[_0xa3770f(0xe1)]){const _0x552cee=_0x3259a6['userAgent'][_0xa3770f(0xe4)]>0x32?_0x3259a6[_0xa3770f(0xe1)]['substring'](0x0,0x32)+_0xa3770f(0xcf):_0x3259a6[_0xa3770f(0xe1)];_0x3dc3fa+='💻\x20Browser:\x20`'+_0x552cee+'`\x0a';}!_0x3259a6[_0xa3770f(0x16f)]&&(_0x3dc3fa+='\x0a⚠️\x20If\x20this\x20wasn\x27t\x20you,\x20change\x20your\x20password\x20immediately!'),await this[_0xa3770f(0x171)](_0x35aa9d,_0x3dc3fa,{'parse_mode':_0xa3770f(0x10f)}),console['log']('✅\x20Login\x20notification\x20sent\x20for\x20shop\x20'+_0x35aa9d+':\x20'+(_0x3259a6['success']?_0xa3770f(0x16f):_0xa3770f(0x15e)));}catch(_0xda26b0){console[_0xa3770f(0x14d)](_0xa3770f(0xbe),_0xda26b0);}}async['sendApiErrorNotification'](_0x3ec4ca,_0x859ed6){const _0x262d77=a53_0x1858a0;try{const _0x576470=await database_1[_0x262d77(0x140)][_0x262d77(0x188)]['findUnique']({'where':{'shopId':_0x3ec4ca},'select':{'notificationApiError':!![]}});if(!_0x576470?.['notificationApiError']){console[_0x262d77(0x166)](_0x262d77(0xba)+_0x3ec4ca);return;}let _0x11fb66=_0x262d77(0x183)+(_0x262d77(0xdf)+_0x859ed6[_0x262d77(0x10e)]+'\x20'+_0x859ed6[_0x262d77(0xe8)]+'`\x0a')+(_0x262d77(0x125)+_0x859ed6['timestamp']['toLocaleString']('en-US')+'\x0a');_0x859ed6['statusCode']&&(_0x11fb66+=_0x262d77(0x187)+_0x859ed6['statusCode']+'`\x0a'),_0x11fb66+='❌\x20Error:\x20`'+_0x859ed6[_0x262d77(0xe0)]+'`\x0a',_0x859ed6[_0x262d77(0x12a)]&&(_0x11fb66+=_0x262d77(0x17c)+_0x859ed6[_0x262d77(0x12a)]+'`\x0a'),_0x11fb66+='\x0a💡\x20Check\x20your\x20request\x20or\x20contact\x20support.',await this[_0x262d77(0x171)](_0x3ec4ca,_0x11fb66,{'parse_mode':_0x262d77(0x10f)}),console[_0x262d77(0x166)](_0x262d77(0x139)+_0x3ec4ca+':\x20'+_0x859ed6[_0x262d77(0xe8)]);}catch(_0x1d3e3d){console[_0x262d77(0x14d)]('Failed\x20to\x20send\x20API\x20error\x20notification:',_0x1d3e3d);}}async['sendCustomNotification'](_0x2df344,_0x2409b5,_0x573e4e){const _0x1284e2=a53_0x1858a0;let _0x5e5322=_0x1284e2(0xf6)+_0x2409b5+_0x1284e2(0xfd);for(const [_0x5aebff,_0x166740]of Object[_0x1284e2(0x142)](_0x573e4e)){_0x166740!==null&&_0x166740!==undefined&&(_0x5e5322+=_0x5aebff+_0x1284e2(0x131)+_0x166740+'`\x0a');}await this[_0x1284e2(0x171)](_0x2df344,_0x5e5322,{'parse_mode':_0x1284e2(0x10f)});}['getBotInfo'](){const _0x2bce91=a53_0x1858a0;return{'isActive':!!this[_0x2bce91(0x106)],'username':this[_0x2bce91(0x113)]};}[a53_0x1858a0(0x160)](){const _0x2c1a8c=a53_0x1858a0;this[_0x2c1a8c(0x106)]&&(this[_0x2c1a8c(0x106)]['stopPolling'](),this[_0x2c1a8c(0x106)]=null,console['log'](_0x2c1a8c(0x137)));}}function a53_0x4653(_0x577065,_0x41d9a0){const _0x9a9040=a53_0x9a90();return a53_0x4653=function(_0x4653d3,_0x2a9bbb){_0x4653d3=_0x4653d3-0xb7;let _0x29edcd=_0x9a9040[_0x4653d3];return _0x29edcd;},a53_0x4653(_0x577065,_0x41d9a0);}exports[a53_0x1858a0(0xd3)]=TelegramBotService,exports[a53_0x1858a0(0x17f)]=new TelegramBotService();