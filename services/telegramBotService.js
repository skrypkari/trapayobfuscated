'use strict';const a58_0x11f76b=a58_0x90fb;(function(_0x5ce3f6,_0x3facfb){const _0x1e84db=a58_0x90fb,_0x270773=_0x5ce3f6();while(!![]){try{const _0x40d4fd=-parseInt(_0x1e84db(0x227))/0x1+-parseInt(_0x1e84db(0x19a))/0x2*(-parseInt(_0x1e84db(0x229))/0x3)+-parseInt(_0x1e84db(0x21f))/0x4+parseInt(_0x1e84db(0x1e9))/0x5*(-parseInt(_0x1e84db(0x1a1))/0x6)+parseInt(_0x1e84db(0x253))/0x7+parseInt(_0x1e84db(0x249))/0x8*(parseInt(_0x1e84db(0x231))/0x9)+-parseInt(_0x1e84db(0x183))/0xa*(parseInt(_0x1e84db(0x24c))/0xb);if(_0x40d4fd===_0x3facfb)break;else _0x270773['push'](_0x270773['shift']());}catch(_0x20b86c){_0x270773['push'](_0x270773['shift']());}}}(a58_0x1a17,0x962b3));function a58_0x1a17(){const _0xe592ff=['Username\x20must\x20contain\x20only\x20letters,\x20numbers\x20and\x20underscore\x20(3-50\x20characters).','🌐\x20IP\x20address:\x20`','update','__importDefault','`\x20is\x20inactive.\x0a\x0a','failed','chargebackAmount','txid','Disconnect\x20the\x20previous\x20account\x20first\x20or\x20contact\x20administrator.','amount','\x0a👤\x20*Customer\x20Information:*\x0a','currency','✅\x20You\x20have\x20been\x20successfully\x20disconnected\x20from\x20shop\x20*','length','\x20USD*\x0a','env','💸\x20Penalty\x20amount:\x20*','🔌\x20User\x20','🔄\x20Reset\x20incomplete\x20verification\x20for\x20user\x20','❌\x20Shop\x20`','telegramUser','Use\x20/start\x20to\x20begin.','✅\x20Telegram\x20user\x20','🎉\x20*Congratulations!*\x0a\x0a','processing','trapay_bot','To\x20receive\x20payment\x20notifications,\x20send\x20your\x20credentials\x20in\x20one\x20line:\x0a\x0a','remitterIban','shopSettings','method','`appple\x20pk_aa6450d3f57afbefbb0f3f5be5ce6cca13037536afc5ccf14c81a6cbc7a07de5`\x0a\x0a','`\x20not\x20found.\x0a\x0a','username','Error\x20handling\x20/status\x20command:','6305KaWwFJ','TELEGRAM_BOT_TOKEN','substring','blocked','ipAddress','❌\x20Another\x20Telegram\x20account\x20is\x20already\x20connected\x20to\x20shop\x20`','Payment\x20expired','💸\x20Amount:\x20*','📱\x20Login\x20notifications\x20disabled\x20for\x20shop\x20','📝\x20Notes:\x20','Error\x20sending\x20shop\x20notification:','chat','❌\x20An\x20error\x20occurred.\x20Please\x20try\x20again\x20later.','•\x20`','🏪\x20Available\x20shops\x20in\x20system:\x0a',':\x20username=\x22','includes','chat\x20not\x20found','No\x20verified\x20Telegram\x20users\x20found\x20for\x20shop\x20','startsWith','text','Use\x20/start\x20to\x20connect.','To\x20reconnect,\x20use\x20the\x20/start\x20command','timestamp','errorMessage','❌\x20Invalid\x20format.\x20Please\x20send\x20exactly\x202\x20parts\x20separated\x20by\x20space:\x0a\x0a','API\x20key\x20must\x20start\x20with\x20`pk\x5c_`\x20or\x20`sk\x5c_`.','❌\x20Please\x20use\x20/start\x20command\x20first','📅\x20Connection\x20date:\x20','❗️\x20Make\x20sure\x20to\x20separate\x20username\x20and\x20API\x20key\x20with\x20a\x20space!','📱\x20Created\x20new\x20Telegram\x20user:\x20','❌\x20You\x20are\x20not\x20connected\x20to\x20the\x20notification\x20system.','__esModule','first_name','•\x20Payouts\x0a','sendShopNotification','getBotInfo','•\x20Important\x20events\x0a\x0a','Error\x20handling\x20/start\x20command:','sendPaymentNotification','notificationLogin','Telegram\x20bot\x20polling\x20error:','toString','🏪\x20Gateway:\x20`','`.\x0a\x0a','⏳\x20The\x20payment\x20is\x20currently\x20being\x20processed\x20by\x20the\x20gateway.\x0a','📛\x20Name:\x20`','Example:\x0a','Telegram\x20bot\x20not\x20initialized,\x20cannot\x20send\x20notification','toLocaleString','notificationApiError','customerIp','\x20marked\x20as\x20unverified\x20due\x20to\x20delivery\x20failure','Payment\x20refund','4041528NXbiWf','🔄\x20Processing\x20single-line\x20verification\x20for\x20user\x20','✅\x20API\x20error\x20notification\x20sent\x20for\x20shop\x20','isVerified','onText','.\x20*','🌐\x20IP:\x20`','message','331481HmoxGd','telegramBotService','15UyCmIf','Telegram\x20bot\x20error:','❌\x20Shop\x20with\x20username\x20`','Commands:\x0a','handleSingleLineVerification','createdAt','✅\x20Welcome\x20back!\x0a\x0a','❌\x20You\x20are\x20not\x20registered\x20in\x20the\x20system.\x0a\x0a','9518913bmfbbb','botUsername','botToken','stopBot','🛑\x20Telegram\x20bot\x20stopped','from','📝\x20Format:\x20`username\x20api_key`\x0a\x0a','customerName','\x22,\x20apiKey=\x22','New\x20payout\x20created','status','Check\x20spelling\x20and\x20try\x20again.','•\x20New\x20payments\x0a','\x22\x20->\x20display\x20\x22','👤\x20Username:\x20`','\x20USDT*\x0a','🚨\x20*API\x20Error*\x0a\x0a','adminNotes','bot','\x20\x20\x20Public\x20Key:\x20`','❌\x20An\x20error\x20occurred\x20while\x20verifying\x20data.','map','TELEGRAM_BOT_USERNAME','log','8yUFFYm','default','\x20\x20\x20Status:\x20','715rdWfpS','customerEmail','Error\x20handling\x20message:','❌\x20Failed\x20to\x20send\x20notification\x20to\x20Telegram\x20user\x20','requestId','\x20verified\x20for\x20shop\x20','✅\x20Telegram\x20bot\x20@','65100bvIhgM','❌\x20Invalid\x20username\x20format:\x20`','allSettled','sk_','findUnique','user\x20is\x20deactivated','📊\x20*Connection\x20Status*\x0a\x0a','\x20\x20\x20Username:\x20`','pk_','•\x20Payment\x20status\x20changes\x0a','...`\x0a\x0a','\x0aCheck\x20spelling\x20and\x20try\x20again.','\x20via\x20single-line\x20input','9670GIrlkD','sendMessage','shopId','telegramId','💻\x20Browser:\x20`','setupBotHandlers','warn','🔗\x20TXID:\x20`','/status\x20-\x20check\x20connection\x20status\x0a','Payment\x20failed','test','🏦\x20IBAN:\x20`','✅\x20You\x20are\x20already\x20connected\x20to\x20shop\x20*','Failed\x20login\x20attempt','📱\x20Your\x20Telegram\x20ID:\x20`','Available\x20usernames:\x0a','Check\x20the\x20key\x20and\x20try\x20again.\x0a\x0a','Markdown','error','stopPolling','Username:\x20`','Payout\x20rejected','node-telegram-bot-api','402830savRwZ','New\x20payment\x20created','✅\x20Notification\x20sent\x20to\x20Telegram\x20user\x20','chargeback','🔔\x20*','endpoint','📝\x20Order\x20ID:\x20`','258qgMrJE','`\x0a\x0a','shop','name','split','...\x22','statusCode','/disconnect\x20-\x20disconnect\x20from\x20notifications','🔗\x20Endpoint:\x20`','*\x0a\x0a','success','forEach','Failed\x20to\x20send\x20API\x20error\x20notification:','Use\x20/status\x20to\x20check\x20status\x20or\x20/disconnect\x20to\x20disconnect.','You\x20sent\x20','entries','gateway','TelegramBotService','\x0a💡\x20Check\x20your\x20request\x20or\x20contact\x20support.','customerUa','✅\x20Connected\x20to\x20shop:\x20*','findMany','🔔\x20Notifications\x20are\x20active\x0a\x0a','TELEGRAM_BOT_TOKEN\x20not\x20found\x20in\x20environment\x20variables','❌\x20Error\x20getting\x20debug\x20information.','📅\x20Date:\x20','Payment\x20successfully\x20paid','🔔\x20You\x20will\x20now\x20receive\x20notifications\x20about:\x0a','updatedAt','\x20(@','📊\x20Error\x20code:\x20`','findFirst','en-US','getGatewayDisplayNameForTelegram','Contact\x20administrator.','sendLoginNotification','userAgent','join'];a58_0x1a17=function(){return _0xe592ff;};return a58_0x1a17();}var __importDefault=this&&this[a58_0x11f76b(0x1ca)]||function(_0x35f36f){const _0x4f900b=a58_0x11f76b;return _0x35f36f&&_0x35f36f[_0x4f900b(0x209)]?_0x35f36f:{'default':_0x35f36f};};function a58_0x90fb(_0x29f953,_0x592b05){const _0x1a1748=a58_0x1a17();return a58_0x90fb=function(_0x90fb01,_0x578c1e){_0x90fb01=_0x90fb01-0x182;let _0x2d3625=_0x1a1748[_0x90fb01];return _0x2d3625;},a58_0x90fb(_0x29f953,_0x592b05);}Object['defineProperty'](exports,'__esModule',{'value':!![]}),exports[a58_0x11f76b(0x228)]=exports[a58_0x11f76b(0x1b2)]=void 0x0;const node_telegram_bot_api_1=__importDefault(require(a58_0x11f76b(0x199))),database_1=__importDefault(require('../config/database')),gateway_1=require('../types/gateway');class TelegramBotService{constructor(){const _0x5d66e5=a58_0x11f76b;this['bot']=null,this[_0x5d66e5(0x233)]=process[_0x5d66e5(0x1d6)][_0x5d66e5(0x1ea)]||'',this['botUsername']=process['env'][_0x5d66e5(0x247)]||_0x5d66e5(0x1e0),this[_0x5d66e5(0x233)]?this['initializeBot']():console[_0x5d66e5(0x189)](_0x5d66e5(0x1b8));}['initializeBot'](){const _0x4fb7d9=a58_0x11f76b;try{this[_0x4fb7d9(0x243)]=new node_telegram_bot_api_1[(_0x4fb7d9(0x24a))](this[_0x4fb7d9(0x233)],{'polling':!![]}),this[_0x4fb7d9(0x188)](),console['log'](_0x4fb7d9(0x252)+this[_0x4fb7d9(0x232)]+'\x20initialized\x20successfully');}catch(_0x278ea9){console[_0x4fb7d9(0x195)]('❌\x20Failed\x20to\x20initialize\x20Telegram\x20bot:',_0x278ea9);}}[a58_0x11f76b(0x188)](){const _0x32b231=a58_0x11f76b;if(!this['bot'])return;this[_0x32b231(0x243)][_0x32b231(0x223)](/\/start/,async _0x341ff3=>{const _0x1d8855=_0x32b231,_0x438a89=_0x341ff3[_0x1d8855(0x1f4)]['id'],_0x29f4c3=_0x341ff3[_0x1d8855(0x236)]?.['id']['toString'](),_0x2cf5f7=_0x341ff3['from']?.[_0x1d8855(0x1e7)],_0x5a3e39=_0x341ff3['from']?.[_0x1d8855(0x20a)],_0x246967=_0x341ff3[_0x1d8855(0x236)]?.['last_name'];if(!_0x29f4c3)return;try{let _0x1234dc=await database_1['default'][_0x1d8855(0x1db)][_0x1d8855(0x257)]({'where':{'telegramId':_0x29f4c3},'include':{'shop':!![]}});!_0x1234dc?(_0x1234dc=await database_1['default']['telegramUser']['create']({'data':{'telegramId':_0x29f4c3,'username':_0x2cf5f7,'firstName':_0x5a3e39,'lastName':_0x246967,'isVerified':![],'shopId':null},'include':{'shop':!![]}}),console[_0x1d8855(0x248)](_0x1d8855(0x207)+_0x29f4c3+_0x1d8855(0x1be)+_0x2cf5f7+')')):_0x1234dc=await database_1[_0x1d8855(0x24a)]['telegramUser'][_0x1d8855(0x1c9)]({'where':{'telegramId':_0x29f4c3},'data':{'username':_0x2cf5f7,'firstName':_0x5a3e39,'lastName':_0x246967},'include':{'shop':!![]}}),_0x1234dc['isVerified']&&_0x1234dc['shopId']&&_0x1234dc[_0x1d8855(0x1a3)]?await this['bot']?.['sendMessage'](_0x438a89,_0x1d8855(0x22f)+('You\x20are\x20already\x20connected\x20to\x20shop:\x20*'+_0x1234dc[_0x1d8855(0x1a3)][_0x1d8855(0x1a4)]+'*\x0a')+(_0x1d8855(0x197)+_0x1234dc[_0x1d8855(0x1a3)][_0x1d8855(0x1e7)]+_0x1d8855(0x1a2))+'🔔\x20You\x20receive\x20notifications\x20about:\x0a'+_0x1d8855(0x23d)+'•\x20Payment\x20status\x20changes\x0a'+'•\x20Payouts\x0a\x0a'+_0x1d8855(0x22c)+'/status\x20-\x20check\x20connection\x20status\x0a'+_0x1d8855(0x1a8),{'parse_mode':'Markdown'}):(_0x1234dc[_0x1d8855(0x185)]&&!_0x1234dc['isVerified']&&(await database_1[_0x1d8855(0x24a)][_0x1d8855(0x1db)]['update']({'where':{'telegramId':_0x29f4c3},'data':{'shopId':null,'isVerified':![]}}),console['log'](_0x1d8855(0x1d9)+_0x29f4c3)),await this[_0x1d8855(0x243)]?.[_0x1d8855(0x184)](_0x438a89,'🤖\x20Welcome\x20to\x20TRAPAY\x20notification\x20system!\x0a\x0a'+_0x1d8855(0x1e1)+_0x1d8855(0x237)+_0x1d8855(0x218)+_0x1d8855(0x1e5)+_0x1d8855(0x206),{'parse_mode':_0x1d8855(0x194)}));}catch(_0x310afd){console[_0x1d8855(0x195)](_0x1d8855(0x20f),_0x310afd),await this[_0x1d8855(0x243)]?.[_0x1d8855(0x184)](_0x438a89,_0x1d8855(0x1f5));}}),this[_0x32b231(0x243)][_0x32b231(0x223)](/\/disconnect/,async _0x32fd17=>{const _0x225a7d=_0x32b231,_0x14f5db=_0x32fd17[_0x225a7d(0x1f4)]['id'],_0x7ff27b=_0x32fd17['from']?.['id'][_0x225a7d(0x213)]();if(!_0x7ff27b)return;try{const _0x36a089=await database_1[_0x225a7d(0x24a)][_0x225a7d(0x1db)][_0x225a7d(0x257)]({'where':{'telegramId':_0x7ff27b},'include':{'shop':!![]}});if(!_0x36a089||!_0x36a089[_0x225a7d(0x222)]||!_0x36a089['shopId']){await this[_0x225a7d(0x243)]?.[_0x225a7d(0x184)](_0x14f5db,_0x225a7d(0x208));return;}const _0x27ec21=_0x36a089[_0x225a7d(0x1a3)]?.[_0x225a7d(0x1a4)]||'unknown\x20shop';await database_1[_0x225a7d(0x24a)][_0x225a7d(0x1db)][_0x225a7d(0x1c9)]({'where':{'telegramId':_0x7ff27b},'data':{'shopId':null,'isVerified':![]}}),console[_0x225a7d(0x248)](_0x225a7d(0x1d8)+_0x7ff27b+'\x20disconnected\x20from\x20shop\x20'+_0x36a089['shopId']),await this['bot']?.['sendMessage'](_0x14f5db,_0x225a7d(0x1d3)+_0x27ec21+'*.\x0a\x0a'+_0x225a7d(0x1ff),{'parse_mode':'Markdown'});}catch(_0x43ce5d){console[_0x225a7d(0x195)]('Error\x20handling\x20/disconnect\x20command:',_0x43ce5d),await this[_0x225a7d(0x243)]?.[_0x225a7d(0x184)](_0x14f5db,_0x225a7d(0x1f5));}}),this[_0x32b231(0x243)][_0x32b231(0x223)](/\/status/,async _0x39223b=>{const _0xeb8e9d=_0x32b231,_0x279a52=_0x39223b[_0xeb8e9d(0x1f4)]['id'],_0x132a7f=_0x39223b['from']?.['id'][_0xeb8e9d(0x213)]();if(!_0x132a7f)return;try{const _0x727f9d=await database_1[_0xeb8e9d(0x24a)]['telegramUser'][_0xeb8e9d(0x257)]({'where':{'telegramId':_0x132a7f},'include':{'shop':!![]}});if(!_0x727f9d){await this['bot']?.[_0xeb8e9d(0x184)](_0x279a52,_0xeb8e9d(0x230)+_0xeb8e9d(0x1dc));return;}if(!_0x727f9d[_0xeb8e9d(0x222)]||!_0x727f9d['shopId']||!_0x727f9d[_0xeb8e9d(0x1a3)]){await this[_0xeb8e9d(0x243)]?.[_0xeb8e9d(0x184)](_0x279a52,'❌\x20You\x20are\x20not\x20connected\x20to\x20a\x20shop.\x0a\x0a'+_0xeb8e9d(0x1fe));return;}await this['bot']?.['sendMessage'](_0x279a52,_0xeb8e9d(0x259)+(_0xeb8e9d(0x1b5)+_0x727f9d[_0xeb8e9d(0x1a3)][_0xeb8e9d(0x1a4)]+'*\x0a')+(_0xeb8e9d(0x23f)+_0x727f9d['shop'][_0xeb8e9d(0x1e7)]+'`\x0a')+(_0xeb8e9d(0x205)+_0x727f9d[_0xeb8e9d(0x1bd)]['toLocaleDateString'](_0xeb8e9d(0x1c1))+'\x0a\x0a')+_0xeb8e9d(0x1b7)+_0xeb8e9d(0x22c)+'/disconnect\x20-\x20disconnect\x20from\x20notifications',{'parse_mode':_0xeb8e9d(0x194)});}catch(_0x1fecc1){console[_0xeb8e9d(0x195)](_0xeb8e9d(0x1e8),_0x1fecc1),await this[_0xeb8e9d(0x243)]?.[_0xeb8e9d(0x184)](_0x279a52,_0xeb8e9d(0x1f5));}}),this[_0x32b231(0x243)][_0x32b231(0x223)](/\/debug/,async _0x583c01=>{const _0x2ce6a5=_0x32b231,_0x42317b=_0x583c01[_0x2ce6a5(0x1f4)]['id'],_0x380df3=_0x583c01[_0x2ce6a5(0x236)]?.['id'][_0x2ce6a5(0x213)]();if(!_0x380df3)return;try{const _0xc9f885=await database_1[_0x2ce6a5(0x24a)]['shop'][_0x2ce6a5(0x1b6)]({'select':{'id':!![],'name':!![],'username':!![],'status':!![],'publicKey':!![]},'take':0xa});let _0x359a21='🔍\x20*Debug\x20Information*\x0a\x0a';_0x359a21+=_0x2ce6a5(0x191)+_0x380df3+_0x2ce6a5(0x1a2),_0x359a21+=_0x2ce6a5(0x1f7),_0xc9f885['forEach']((_0x41e92b,_0xb17d76)=>{const _0x3f7134=_0x2ce6a5;_0x359a21+=_0xb17d76+0x1+_0x3f7134(0x224)+_0x41e92b['name']+'*\x0a',_0x359a21+=_0x3f7134(0x25a)+_0x41e92b[_0x3f7134(0x1e7)]+'`\x0a',_0x359a21+=_0x3f7134(0x24b)+_0x41e92b[_0x3f7134(0x23b)]+'\x0a',_0x359a21+=_0x3f7134(0x244)+_0x41e92b['publicKey'][_0x3f7134(0x1eb)](0x0,0xf)+_0x3f7134(0x25d);}),await this[_0x2ce6a5(0x243)]?.[_0x2ce6a5(0x184)](_0x42317b,_0x359a21,{'parse_mode':_0x2ce6a5(0x194)});}catch(_0x46a25b){console[_0x2ce6a5(0x195)]('Error\x20handling\x20/debug\x20command:',_0x46a25b),await this[_0x2ce6a5(0x243)]?.[_0x2ce6a5(0x184)](_0x42317b,_0x2ce6a5(0x1b9));}}),this['bot']['on']('message',async _0x2638fc=>{const _0x1f9ae8=_0x32b231;if(_0x2638fc[_0x1f9ae8(0x1fd)]?.[_0x1f9ae8(0x1fc)]('/'))return;const _0x17ca7b=_0x2638fc[_0x1f9ae8(0x1f4)]['id'],_0x5d0837=_0x2638fc['from']?.['id'][_0x1f9ae8(0x213)](),_0x49f419=_0x2638fc[_0x1f9ae8(0x1fd)]?.['trim']();if(!_0x5d0837||!_0x49f419)return;try{const _0x2089d3=await database_1['default'][_0x1f9ae8(0x1db)]['findUnique']({'where':{'telegramId':_0x5d0837},'include':{'shop':!![]}});if(!_0x2089d3){await this[_0x1f9ae8(0x243)]?.[_0x1f9ae8(0x184)](_0x17ca7b,_0x1f9ae8(0x204));return;}if(_0x2089d3[_0x1f9ae8(0x222)]&&_0x2089d3[_0x1f9ae8(0x185)]&&_0x2089d3[_0x1f9ae8(0x1a3)]){await this['bot']?.['sendMessage'](_0x17ca7b,_0x1f9ae8(0x18f)+_0x2089d3[_0x1f9ae8(0x1a3)][_0x1f9ae8(0x1a4)]+'*.\x0a\x0a'+_0x1f9ae8(0x1ae),{'parse_mode':_0x1f9ae8(0x194)});return;}const _0x26ffa5=_0x49f419[_0x1f9ae8(0x1a5)](/\s+/);if(_0x26ffa5[_0x1f9ae8(0x1d4)]!==0x2){await this[_0x1f9ae8(0x243)]?.[_0x1f9ae8(0x184)](_0x17ca7b,_0x1f9ae8(0x202)+'📝\x20Format:\x20`username\x20api_key`\x0a\x0a'+'Example:\x0a'+_0x1f9ae8(0x1e5)+(_0x1f9ae8(0x1af)+_0x26ffa5[_0x1f9ae8(0x1d4)]+'\x20parts:\x20'+_0x26ffa5[_0x1f9ae8(0x246)](_0x2d96f3=>'`'+_0x2d96f3+'`')[_0x1f9ae8(0x1c6)](',\x20')),{'parse_mode':_0x1f9ae8(0x194)});return;}const [_0x1d5f84,_0x3ebf49]=_0x26ffa5;console['log'](_0x1f9ae8(0x220)+_0x5d0837+_0x1f9ae8(0x1f8)+_0x1d5f84+'\x22,\x20apiKey=\x22'+_0x3ebf49[_0x1f9ae8(0x1eb)](0x0,0xa)+_0x1f9ae8(0x1a6)),await this[_0x1f9ae8(0x22d)](_0x17ca7b,_0x5d0837,_0x1d5f84,_0x3ebf49);}catch(_0x2da787){console[_0x1f9ae8(0x195)](_0x1f9ae8(0x24e),_0x2da787),await this['bot']?.[_0x1f9ae8(0x184)](_0x17ca7b,_0x1f9ae8(0x1f5));}}),this[_0x32b231(0x243)]['on']('error',_0x2f3fd4=>{const _0x32deb8=_0x32b231;console['error'](_0x32deb8(0x22a),_0x2f3fd4);}),this[_0x32b231(0x243)]['on']('polling_error',_0x49da9f=>{const _0x2e0c88=_0x32b231;console[_0x2e0c88(0x195)](_0x2e0c88(0x212),_0x49da9f);});}async[a58_0x11f76b(0x22d)](_0x50e4cb,_0x361330,_0x5bc81a,_0x416374){const _0x4517ce=a58_0x11f76b;try{console['log']('🔄\x20Processing\x20single-line\x20verification\x20for\x20user\x20'+_0x361330+':\x20username=\x22'+_0x5bc81a+_0x4517ce(0x239)+_0x416374[_0x4517ce(0x1eb)](0x0,0xa)+_0x4517ce(0x1a6));if(!_0x5bc81a||_0x5bc81a[_0x4517ce(0x1d4)]<0x3||_0x5bc81a[_0x4517ce(0x1d4)]>0x32||!/^[a-zA-Z0-9_]+$/[_0x4517ce(0x18d)](_0x5bc81a)){await this['bot']?.[_0x4517ce(0x184)](_0x50e4cb,_0x4517ce(0x254)+_0x5bc81a+'`\x0a\x0a'+_0x4517ce(0x1c7),{'parse_mode':'Markdown'});return;}if(!_0x416374||!_0x416374[_0x4517ce(0x1fc)](_0x4517ce(0x25b))&&!_0x416374[_0x4517ce(0x1fc)](_0x4517ce(0x256))){await this[_0x4517ce(0x243)]?.['sendMessage'](_0x50e4cb,'❌\x20Invalid\x20API\x20key\x20format.\x0a\x0a'+_0x4517ce(0x203),{'parse_mode':_0x4517ce(0x194)});return;}const _0x58385d=await database_1[_0x4517ce(0x24a)]['shop'][_0x4517ce(0x257)]({'where':{'username':_0x5bc81a},'select':{'id':!![],'name':!![],'username':!![],'status':!![],'publicKey':!![],'secretKey':!![]}});if(!_0x58385d){const _0x487d90=await database_1[_0x4517ce(0x24a)]['shop'][_0x4517ce(0x1b6)]({'select':{'username':!![],'name':!![]},'take':0x5});let _0x50eb36=_0x4517ce(0x22b)+_0x5bc81a+_0x4517ce(0x1e6);_0x487d90['length']>0x0?(_0x50eb36+=_0x4517ce(0x192),_0x487d90[_0x4517ce(0x1ac)](_0x12bd3c=>{const _0x32d468=_0x4517ce;_0x50eb36+=_0x32d468(0x1f6)+_0x12bd3c['username']+'`\x20('+_0x12bd3c['name']+')\x0a';}),_0x50eb36+=_0x4517ce(0x25e)):_0x50eb36+=_0x4517ce(0x23c);await this[_0x4517ce(0x243)]?.[_0x4517ce(0x184)](_0x50e4cb,_0x50eb36,{'parse_mode':'Markdown'});return;}if(_0x58385d[_0x4517ce(0x23b)]!=='ACTIVE'){await this[_0x4517ce(0x243)]?.[_0x4517ce(0x184)](_0x50e4cb,_0x4517ce(0x1da)+_0x5bc81a+_0x4517ce(0x1cb)+_0x4517ce(0x1c3),{'parse_mode':_0x4517ce(0x194)});return;}if(_0x58385d['publicKey']!==_0x416374&&_0x58385d['secretKey']!==_0x416374){await this[_0x4517ce(0x243)]?.['sendMessage'](_0x50e4cb,'❌\x20API\x20key\x20does\x20not\x20match\x20shop\x20`'+_0x5bc81a+_0x4517ce(0x215)+_0x4517ce(0x193)+'Expected\x20key\x20format:\x20`pk_...`\x20or\x20`sk_...`',{'parse_mode':'Markdown'});return;}const _0xf46860=await database_1[_0x4517ce(0x24a)]['telegramUser'][_0x4517ce(0x1c0)]({'where':{'shopId':_0x58385d['id'],'isVerified':!![],'telegramId':{'not':_0x361330}}});if(_0xf46860){await this['bot']?.[_0x4517ce(0x184)](_0x50e4cb,_0x4517ce(0x1ee)+_0x5bc81a+_0x4517ce(0x215)+_0x4517ce(0x1cf),{'parse_mode':_0x4517ce(0x194)});return;}await database_1[_0x4517ce(0x24a)][_0x4517ce(0x1db)][_0x4517ce(0x1c9)]({'where':{'telegramId':_0x361330},'data':{'shopId':_0x58385d['id'],'isVerified':!![]}}),await this[_0x4517ce(0x243)]?.[_0x4517ce(0x184)](_0x50e4cb,_0x4517ce(0x1de)+'✅\x20You\x20have\x20been\x20successfully\x20connected\x20to\x20the\x20notification\x20system!\x0a\x0a'+('📱\x20Shop:\x20*'+_0x58385d[_0x4517ce(0x1a4)]+'*\x0a')+(_0x4517ce(0x23f)+_0x58385d['username']+_0x4517ce(0x1a2))+_0x4517ce(0x1bc)+_0x4517ce(0x23d)+_0x4517ce(0x25c)+_0x4517ce(0x20b)+_0x4517ce(0x20e)+_0x4517ce(0x22c)+_0x4517ce(0x18b)+'/disconnect\x20-\x20disconnect\x20from\x20notifications',{'parse_mode':'Markdown'}),console[_0x4517ce(0x248)](_0x4517ce(0x1dd)+_0x361330+_0x4517ce(0x251)+_0x58385d[_0x4517ce(0x1e7)]+_0x4517ce(0x182));}catch(_0x42ba2c){console[_0x4517ce(0x195)]('Error\x20in\x20handleSingleLineVerification:',_0x42ba2c),await this[_0x4517ce(0x243)]?.[_0x4517ce(0x184)](_0x50e4cb,_0x4517ce(0x245));}}async[a58_0x11f76b(0x20c)](_0x4aeaa9,_0x4c2d59,_0xa69e61){const _0x5ca65b=a58_0x11f76b;if(!this[_0x5ca65b(0x243)]){console[_0x5ca65b(0x189)](_0x5ca65b(0x219));return;}try{const _0x5b13a0=await database_1['default'][_0x5ca65b(0x1db)][_0x5ca65b(0x1b6)]({'where':{'shopId':_0x4aeaa9,'isVerified':!![]}});if(_0x5b13a0[_0x5ca65b(0x1d4)]===0x0){console['log'](_0x5ca65b(0x1fb)+_0x4aeaa9);return;}const _0x567f67=_0x5b13a0[_0x5ca65b(0x246)](async _0x2e8bbc=>{const _0x351e44=_0x5ca65b;try{await this['bot']?.[_0x351e44(0x184)](_0x2e8bbc[_0x351e44(0x186)],_0x4c2d59,_0xa69e61),console[_0x351e44(0x248)](_0x351e44(0x19c)+_0x2e8bbc['telegramId']);}catch(_0x20d58c){console[_0x351e44(0x195)](_0x351e44(0x24f)+_0x2e8bbc['telegramId']+':',_0x20d58c),_0x20d58c instanceof Error&&(_0x20d58c[_0x351e44(0x226)][_0x351e44(0x1f9)](_0x351e44(0x1ec))||_0x20d58c[_0x351e44(0x226)][_0x351e44(0x1f9)](_0x351e44(0x1fa))||_0x20d58c[_0x351e44(0x226)][_0x351e44(0x1f9)](_0x351e44(0x258)))&&(await database_1[_0x351e44(0x24a)][_0x351e44(0x1db)][_0x351e44(0x1c9)]({'where':{'id':_0x2e8bbc['id']},'data':{'isVerified':![]}}),console[_0x351e44(0x248)]('User\x20'+_0x2e8bbc[_0x351e44(0x186)]+_0x351e44(0x21d)));}});await Promise[_0x5ca65b(0x255)](_0x567f67);}catch(_0x48b455){console['error'](_0x5ca65b(0x1f3),_0x48b455);}}async[a58_0x11f76b(0x210)](_0x280b1f,_0x19e48e,_0x24cac8){const _0x2af514=a58_0x11f76b,_0x373852={'created':'🆕','paid':'✅','failed':'❌','expired':'⏰','refund':'🔄','chargeback':'⚠️','processing':'⚙️'},_0x20d502={'created':_0x2af514(0x19b),'paid':_0x2af514(0x1bb),'failed':_0x2af514(0x18c),'expired':_0x2af514(0x1ef),'refund':_0x2af514(0x21e),'chargeback':'Payment\x20chargeback','processing':'Payment\x20is\x20being\x20processed'},_0x21a516=_0x373852[_0x24cac8],_0x353bb6=_0x20d502[_0x24cac8],_0x8defbd=(0x0,gateway_1[_0x2af514(0x1c2)])(_0x19e48e[_0x2af514(0x1b1)]);console[_0x2af514(0x248)]('📱\x20Telegram\x20notification:\x20gateway\x20\x22'+_0x19e48e['gateway']+_0x2af514(0x23e)+_0x8defbd+'\x22');let _0x68a237=_0x21a516+'\x20*'+_0x353bb6+_0x2af514(0x1aa)+('💰\x20Amount:\x20*'+_0x19e48e[_0x2af514(0x1d0)]+'\x20'+_0x19e48e[_0x2af514(0x1d2)]+'*\x0a')+(_0x2af514(0x1a0)+(_0x19e48e['orderId']||_0x19e48e['id'])+'`\x0a')+('🆔\x20Payment\x20ID:\x20`'+_0x19e48e['id']+'`\x0a')+(_0x2af514(0x214)+_0x8defbd+'`\x0a')+(_0x2af514(0x1ba)+new Date(_0x19e48e['createdAt'])[_0x2af514(0x21a)](_0x2af514(0x1c1))+'\x0a');if(_0x19e48e[_0x2af514(0x238)]||_0x19e48e[_0x2af514(0x24d)]||_0x19e48e[_0x2af514(0x1e2)]||_0x19e48e[_0x2af514(0x21c)]||_0x19e48e[_0x2af514(0x1b4)]){_0x68a237+=_0x2af514(0x1d1);_0x19e48e[_0x2af514(0x238)]&&(_0x68a237+=_0x2af514(0x217)+_0x19e48e[_0x2af514(0x238)]+'`\x0a');_0x19e48e[_0x2af514(0x24d)]&&(_0x68a237+='📧\x20Email:\x20`'+_0x19e48e[_0x2af514(0x24d)]+'`\x0a');_0x19e48e['remitterIban']&&(_0x68a237+=_0x2af514(0x18e)+_0x19e48e[_0x2af514(0x1e2)]+'`\x0a');_0x19e48e[_0x2af514(0x21c)]&&(_0x68a237+=_0x2af514(0x225)+_0x19e48e[_0x2af514(0x21c)]+'`\x0a');if(_0x19e48e[_0x2af514(0x1b4)]){const _0x2fe3bc=_0x19e48e[_0x2af514(0x1b4)][_0x2af514(0x1d4)]>0x32?_0x19e48e[_0x2af514(0x1b4)][_0x2af514(0x1eb)](0x0,0x32)+'...':_0x19e48e[_0x2af514(0x1b4)];_0x68a237+=_0x2af514(0x187)+_0x2fe3bc+'`\x0a';}}_0x24cac8===_0x2af514(0x19d)&&_0x19e48e[_0x2af514(0x1cd)]&&(_0x68a237+=_0x2af514(0x1d7)+_0x19e48e[_0x2af514(0x1cd)]+_0x2af514(0x240)),_0x24cac8===_0x2af514(0x1df)&&(_0x68a237+=_0x2af514(0x216)),_0x19e48e[_0x2af514(0x242)]&&(_0x68a237+=_0x2af514(0x1f2)+_0x19e48e['adminNotes']+'\x0a'),await this[_0x2af514(0x20c)](_0x280b1f,_0x68a237,{'parse_mode':'Markdown'});}async['sendPayoutNotification'](_0x313288,_0x211839,_0x140874){const _0x4f1cf6=a58_0x11f76b,_0x50b57b={'created':'📤','completed':'✅','rejected':'❌'},_0x3191d1={'created':_0x4f1cf6(0x23a),'completed':'Payout\x20completed','rejected':_0x4f1cf6(0x198)},_0x218ab6=_0x50b57b[_0x140874],_0xf4714a=_0x3191d1[_0x140874],_0x3035f5=_0x218ab6+'\x20*'+_0xf4714a+_0x4f1cf6(0x1aa)+(_0x4f1cf6(0x1f0)+_0x211839[_0x4f1cf6(0x1d0)]+_0x4f1cf6(0x1d5))+('🏦\x20Method:\x20`'+_0x211839['method']+'`\x0a')+('🆔\x20Payout\x20ID:\x20`'+_0x211839['id']+'`\x0a')+(_0x4f1cf6(0x1ba)+new Date(_0x211839[_0x4f1cf6(0x22e)])['toLocaleString'](_0x4f1cf6(0x1c1))+'\x0a')+(_0x211839[_0x4f1cf6(0x1ce)]?_0x4f1cf6(0x18a)+_0x211839[_0x4f1cf6(0x1ce)]+'`':'');await this[_0x4f1cf6(0x20c)](_0x313288,_0x3035f5,{'parse_mode':_0x4f1cf6(0x194)});}async[a58_0x11f76b(0x1c4)](_0x23fd1d,_0x2af5e0){const _0x1efc51=a58_0x11f76b;try{const _0x2a3c06=await database_1['default'][_0x1efc51(0x1e3)][_0x1efc51(0x257)]({'where':{'shopId':_0x23fd1d},'select':{'notificationLogin':!![]}});if(!_0x2a3c06?.[_0x1efc51(0x211)]){console[_0x1efc51(0x248)](_0x1efc51(0x1f1)+_0x23fd1d);return;}const _0x2a2883=_0x2af5e0['success']?'🔐':'🚨',_0x3e9a95=_0x2af5e0[_0x1efc51(0x1ab)]?'Successful\x20login':_0x1efc51(0x190);let _0x5e3d15=_0x2a2883+'\x20*'+_0x3e9a95+_0x1efc51(0x1aa)+(_0x1efc51(0x23f)+_0x2af5e0[_0x1efc51(0x1e7)]+'`\x0a')+('📅\x20Time:\x20'+_0x2af5e0['timestamp'][_0x1efc51(0x21a)](_0x1efc51(0x1c1))+'\x0a');_0x2af5e0[_0x1efc51(0x1ed)]&&(_0x5e3d15+=_0x1efc51(0x1c8)+_0x2af5e0[_0x1efc51(0x1ed)]+'`\x0a');if(_0x2af5e0['userAgent']){const _0x1fc62e=_0x2af5e0[_0x1efc51(0x1c5)][_0x1efc51(0x1d4)]>0x32?_0x2af5e0[_0x1efc51(0x1c5)][_0x1efc51(0x1eb)](0x0,0x32)+'...':_0x2af5e0[_0x1efc51(0x1c5)];_0x5e3d15+='💻\x20Browser:\x20`'+_0x1fc62e+'`\x0a';}!_0x2af5e0[_0x1efc51(0x1ab)]&&(_0x5e3d15+='\x0a⚠️\x20If\x20this\x20wasn\x27t\x20you,\x20change\x20your\x20password\x20immediately!'),await this[_0x1efc51(0x20c)](_0x23fd1d,_0x5e3d15,{'parse_mode':_0x1efc51(0x194)}),console['log']('✅\x20Login\x20notification\x20sent\x20for\x20shop\x20'+_0x23fd1d+':\x20'+(_0x2af5e0['success']?_0x1efc51(0x1ab):_0x1efc51(0x1cc)));}catch(_0xe23110){console[_0x1efc51(0x195)]('Failed\x20to\x20send\x20login\x20notification:',_0xe23110);}}async['sendApiErrorNotification'](_0xfa72e,_0x2a2499){const _0xa8af11=a58_0x11f76b;try{const _0x126e4e=await database_1[_0xa8af11(0x24a)][_0xa8af11(0x1e3)][_0xa8af11(0x257)]({'where':{'shopId':_0xfa72e},'select':{'notificationApiError':!![]}});if(!_0x126e4e?.[_0xa8af11(0x21b)]){console[_0xa8af11(0x248)]('📱\x20API\x20error\x20notifications\x20disabled\x20for\x20shop\x20'+_0xfa72e);return;}let _0x1f9e32=_0xa8af11(0x241)+(_0xa8af11(0x1a9)+_0x2a2499[_0xa8af11(0x1e4)]+'\x20'+_0x2a2499[_0xa8af11(0x19f)]+'`\x0a')+('📅\x20Time:\x20'+_0x2a2499[_0xa8af11(0x200)][_0xa8af11(0x21a)](_0xa8af11(0x1c1))+'\x0a');_0x2a2499[_0xa8af11(0x1a7)]&&(_0x1f9e32+=_0xa8af11(0x1bf)+_0x2a2499[_0xa8af11(0x1a7)]+'`\x0a'),_0x1f9e32+='❌\x20Error:\x20`'+_0x2a2499[_0xa8af11(0x201)]+'`\x0a',_0x2a2499['requestId']&&(_0x1f9e32+='🆔\x20Request\x20ID:\x20`'+_0x2a2499[_0xa8af11(0x250)]+'`\x0a'),_0x1f9e32+=_0xa8af11(0x1b3),await this[_0xa8af11(0x20c)](_0xfa72e,_0x1f9e32,{'parse_mode':_0xa8af11(0x194)}),console[_0xa8af11(0x248)](_0xa8af11(0x221)+_0xfa72e+':\x20'+_0x2a2499[_0xa8af11(0x19f)]);}catch(_0x2f3237){console[_0xa8af11(0x195)](_0xa8af11(0x1ad),_0x2f3237);}}async['sendCustomNotification'](_0x4d11bf,_0x58d0d2,_0x31e9f3){const _0x175e6a=a58_0x11f76b;let _0x115ea5=_0x175e6a(0x19e)+_0x58d0d2+_0x175e6a(0x1aa);for(const [_0x5f3c98,_0x18d92d]of Object[_0x175e6a(0x1b0)](_0x31e9f3)){_0x18d92d!==null&&_0x18d92d!==undefined&&(_0x115ea5+=_0x5f3c98+':\x20`'+_0x18d92d+'`\x0a');}await this[_0x175e6a(0x20c)](_0x4d11bf,_0x115ea5,{'parse_mode':_0x175e6a(0x194)});}[a58_0x11f76b(0x20d)](){const _0x38f9e5=a58_0x11f76b;return{'isActive':!!this[_0x38f9e5(0x243)],'username':this[_0x38f9e5(0x232)]};}[a58_0x11f76b(0x234)](){const _0x5be510=a58_0x11f76b;this[_0x5be510(0x243)]&&(this[_0x5be510(0x243)][_0x5be510(0x196)](),this[_0x5be510(0x243)]=null,console[_0x5be510(0x248)](_0x5be510(0x235)));}}exports[a58_0x11f76b(0x1b2)]=TelegramBotService,exports['telegramBotService']=new TelegramBotService();