'use strict';const a54_0x102cc0=a54_0x2229;(function(_0x21d528,_0x598ca2){const _0x33b2c8=a54_0x2229,_0x4ff440=_0x21d528();while(!![]){try{const _0x49587d=-parseInt(_0x33b2c8(0x184))/0x1+-parseInt(_0x33b2c8(0x131))/0x2+parseInt(_0x33b2c8(0x151))/0x3+parseInt(_0x33b2c8(0xf3))/0x4+parseInt(_0x33b2c8(0x148))/0x5+parseInt(_0x33b2c8(0x1aa))/0x6*(parseInt(_0x33b2c8(0x1a1))/0x7)+-parseInt(_0x33b2c8(0x162))/0x8;if(_0x49587d===_0x598ca2)break;else _0x4ff440['push'](_0x4ff440['shift']());}catch(_0xb35f9f){_0x4ff440['push'](_0x4ff440['shift']());}}}(a54_0xa290,0x48e37));function a54_0x2229(_0x527a8d,_0x29767c){const _0xa2908f=a54_0xa290();return a54_0x2229=function(_0x222979,_0xcc5c4f){_0x222979=_0x222979-0xd8;let _0x20c9d5=_0xa2908f[_0x222979];return _0x20c9d5;},a54_0x2229(_0x527a8d,_0x29767c);}var __importDefault=this&&this[a54_0x102cc0(0x17b)]||function(_0x3822fb){const _0x3a79b1=a54_0x102cc0;return _0x3822fb&&_0x3822fb[_0x3a79b1(0xfd)]?_0x3822fb:{'default':_0x3822fb};};function a54_0xa290(){const _0x5ec9d8=['🛑\x20Telegram\x20bot\x20stopped','sendShopNotification','map','statusCode','📊\x20*Connection\x20Status*\x0a\x0a','🌐\x20IP:\x20`','blocked','timestamp','startsWith','✅\x20Telegram\x20bot\x20@','endpoint','📱\x20Your\x20Telegram\x20ID:\x20`','amount','Failed\x20login\x20attempt','Error\x20handling\x20/start\x20command:','telegramId','create','findFirst','🆔\x20Payment\x20ID:\x20`','✅\x20You\x20are\x20already\x20connected\x20to\x20shop\x20*','•\x20Payment\x20status\x20changes\x0a','Check\x20spelling\x20and\x20try\x20again.','❌\x20An\x20error\x20occurred\x20while\x20verifying\x20data.','❌\x20You\x20are\x20not\x20connected\x20to\x20a\x20shop.\x0a\x0a','findUnique','polling_error','Use\x20/start\x20to\x20connect.','1631196gTKXCm','findMany',':\x20username=\x22','❌\x20Failed\x20to\x20send\x20notification\x20to\x20Telegram\x20user\x20','botToken','📧\x20Email:\x20`','telegramUser','trapay_bot','en-US','bot','__esModule','sk_','\x20marked\x20as\x20unverified\x20due\x20to\x20delivery\x20failure','ipAddress','text','Payment\x20expired','\x20USDT*\x0a','📱\x20Telegram\x20notification:\x20gateway\x20\x22','❌\x20Failed\x20to\x20initialize\x20Telegram\x20bot:','Error\x20in\x20handleSingleLineVerification:','forEach','\x20USD*\x0a','Commands:\x0a','TELEGRAM_BOT_TOKEN','You\x20are\x20already\x20connected\x20to\x20shop:\x20*','trim','❌\x20Invalid\x20API\x20key\x20format.\x0a\x0a','onText','✅\x20Connected\x20to\x20shop:\x20*','`\x20is\x20inactive.\x0a\x0a','...\x22','🔄\x20Processing\x20single-line\x20verification\x20for\x20user\x20','txid','sendApiErrorNotification','Payout\x20completed','•\x20`','Payout\x20rejected','includes','adminNotes','❌\x20Shop\x20with\x20username\x20`','❌\x20An\x20error\x20occurred.\x20Please\x20try\x20again\x20later.','processing','To\x20receive\x20payment\x20notifications,\x20send\x20your\x20credentials\x20in\x20one\x20line:\x0a\x0a','stopPolling','\x20\x20\x20Username:\x20`','\x0aCheck\x20spelling\x20and\x20try\x20again.','../types/gateway','customerUa','❌\x20Invalid\x20format.\x20Please\x20send\x20exactly\x202\x20parts\x20separated\x20by\x20space:\x0a\x0a','\x20initialized\x20successfully','/status\x20-\x20check\x20connection\x20status\x0a','unknown\x20shop','toLocaleString','Available\x20usernames:\x0a','customerName','✅\x20Welcome\x20back!\x0a\x0a','❌\x20Invalid\x20username\x20format:\x20`','Check\x20the\x20key\x20and\x20try\x20again.\x0a\x0a','•\x20Payouts\x0a\x0a','Disconnect\x20the\x20previous\x20account\x20first\x20or\x20contact\x20administrator.','❗️\x20Make\x20sure\x20to\x20separate\x20username\x20and\x20API\x20key\x20with\x20a\x20space!','isVerified','369400FmXnGq','`\x0a\x0a','getBotInfo','Example:\x0a','shopId','default','Username\x20must\x20contain\x20only\x20letters,\x20numbers\x20and\x20underscore\x20(3-50\x20characters).','Error\x20sending\x20shop\x20notification:','🏪\x20Gateway:\x20`','❌\x20You\x20are\x20not\x20connected\x20to\x20the\x20notification\x20system.','Payment\x20successfully\x20paid','Markdown','📅\x20Date:\x20','TelegramBotService','❌\x20API\x20key\x20does\x20not\x20match\x20shop\x20`','from','✅\x20Login\x20notification\x20sent\x20for\x20shop\x20','handleSingleLineVerification','🏦\x20Method:\x20`','defineProperty','\x20via\x20single-line\x20input','📱\x20Created\x20new\x20Telegram\x20user:\x20','🌐\x20IP\x20address:\x20`','2017960jBTbNE','Failed\x20to\x20send\x20login\x20notification:','🔔\x20Notifications\x20are\x20active\x0a\x0a','📱\x20Login\x20notifications\x20disabled\x20for\x20shop\x20','🎉\x20*Congratulations!*\x0a\x0a','length','username','👤\x20Username:\x20`','🔌\x20User\x20','1604370JFsanj','No\x20verified\x20Telegram\x20users\x20found\x20for\x20shop\x20','📱\x20API\x20error\x20notifications\x20disabled\x20for\x20shop\x20','`\x20(','🔔\x20You\x20will\x20now\x20receive\x20notifications\x20about:\x0a','Error\x20handling\x20message:','error','📛\x20Name:\x20`','🆔\x20Payout\x20ID:\x20`','🔗\x20TXID:\x20`','botUsername','publicKey','orderId','success','\x0a⚠️\x20If\x20this\x20wasn\x27t\x20you,\x20change\x20your\x20password\x20immediately!','❌\x20You\x20are\x20not\x20registered\x20in\x20the\x20system.\x0a\x0a','📅\x20Time:\x20','6506280UMRWyz','📱\x20Shop:\x20*','API\x20key\x20must\x20start\x20with\x20`pk\x5c_`\x20or\x20`sk\x5c_`.','✅\x20Telegram\x20user\x20','env','🔔\x20You\x20receive\x20notifications\x20about:\x0a','Telegram\x20bot\x20error:','notificationApiError','`appple\x20pk_aa6450d3f57afbefbb0f3f5be5ce6cca13037536afc5ccf14c81a6cbc7a07de5`\x0a\x0a','•\x20Payouts\x0a','✅\x20API\x20error\x20notification\x20sent\x20for\x20shop\x20','Telegram\x20bot\x20not\x20initialized,\x20cannot\x20send\x20notification','📝\x20Format:\x20`username\x20api_key`\x0a\x0a','💻\x20Browser:\x20`','•\x20New\x20payments\x0a','💸\x20Penalty\x20amount:\x20*','✅\x20You\x20have\x20been\x20successfully\x20connected\x20to\x20the\x20notification\x20system!\x0a\x0a','customerIp','join','User\x20','../config/database','telegramBotService','🚨\x20*API\x20Error*\x0a\x0a','errorMessage','❌\x20Error\x20getting\x20debug\x20information.','__importDefault','Payment\x20failed','setupBotHandlers','update','substring','secretKey','allSettled','gateway','❌\x20Error:\x20`','246611PHGhHt','Expected\x20key\x20format:\x20`pk_...`\x20or\x20`sk_...`','chat','shopSettings','method','Username:\x20`','requestId','🏦\x20IBAN:\x20`','log','sendCustomNotification','pk_','name','node-telegram-bot-api','notificationLogin','Error\x20handling\x20/disconnect\x20command:','TELEGRAM_BOT_TOKEN\x20not\x20found\x20in\x20environment\x20variables','sendPaymentNotification','createdAt','currency','Use\x20/start\x20to\x20begin.','/disconnect\x20-\x20disconnect\x20from\x20notifications','.\x20*','chargebackAmount','message','Contact\x20administrator.','Payment\x20is\x20being\x20processed','remitterIban','status','last_name','1378762OWhCGP','userAgent','toString','sendMessage','...','Successful\x20login','📝\x20Order\x20ID:\x20`','❌\x20Another\x20Telegram\x20account\x20is\x20already\x20connected\x20to\x20shop\x20`','❌\x20Shop\x20`','6QQOhQC','\x20\x20\x20Status:\x20','✅\x20Notification\x20sent\x20to\x20Telegram\x20user\x20','getGatewayDisplayNameForTelegram','entries','You\x20sent\x20','chargeback','\x22,\x20apiKey=\x22','customerEmail','✅\x20You\x20have\x20been\x20successfully\x20disconnected\x20from\x20shop\x20*','split','\x20disconnected\x20from\x20shop\x20','*\x0a\x0a','shop'];a54_0xa290=function(){return _0x5ec9d8;};return a54_0xa290();}Object[a54_0x102cc0(0x144)](exports,'__esModule',{'value':!![]}),exports[a54_0x102cc0(0x177)]=exports[a54_0x102cc0(0x13e)]=void 0x0;const node_telegram_bot_api_1=__importDefault(require(a54_0x102cc0(0x190))),database_1=__importDefault(require(a54_0x102cc0(0x176))),gateway_1=require(a54_0x102cc0(0x121));class TelegramBotService{constructor(){const _0x1bd72d=a54_0x102cc0;this['bot']=null,this[_0x1bd72d(0xf7)]=process['env'][_0x1bd72d(0x10a)]||'',this[_0x1bd72d(0x15b)]=process[_0x1bd72d(0x166)]['TELEGRAM_BOT_USERNAME']||_0x1bd72d(0xfa),this['botToken']?this['initializeBot']():console['warn'](_0x1bd72d(0x193));}['initializeBot'](){const _0x40dd29=a54_0x102cc0;try{this[_0x40dd29(0xfc)]=new node_telegram_bot_api_1[(_0x40dd29(0x136))](this['botToken'],{'polling':!![]}),this[_0x40dd29(0x17d)](),console['log'](_0x40dd29(0xe1)+this[_0x40dd29(0x15b)]+_0x40dd29(0x124));}catch(_0x56889d){console['error'](_0x40dd29(0x105),_0x56889d);}}[a54_0x102cc0(0x17d)](){const _0x255905=a54_0x102cc0;if(!this['bot'])return;this[_0x255905(0xfc)]['onText'](/\/start/,async _0x43c080=>{const _0x5b0e78=_0x255905,_0xed1d6d=_0x43c080['chat']['id'],_0x34fb39=_0x43c080[_0x5b0e78(0x140)]?.['id'][_0x5b0e78(0x1a3)](),_0x5e2d1e=_0x43c080['from']?.[_0x5b0e78(0x14e)],_0x1ee4ba=_0x43c080['from']?.['first_name'],_0x3aa1fc=_0x43c080[_0x5b0e78(0x140)]?.[_0x5b0e78(0x1a0)];if(!_0x34fb39)return;try{let _0x133cef=await database_1['default'][_0x5b0e78(0xf9)][_0x5b0e78(0xf0)]({'where':{'telegramId':_0x34fb39},'include':{'shop':!![]}});!_0x133cef?(_0x133cef=await database_1[_0x5b0e78(0x136)][_0x5b0e78(0xf9)][_0x5b0e78(0xe8)]({'data':{'telegramId':_0x34fb39,'username':_0x5e2d1e,'firstName':_0x1ee4ba,'lastName':_0x3aa1fc,'isVerified':![],'shopId':null},'include':{'shop':!![]}}),console[_0x5b0e78(0x18c)](_0x5b0e78(0x146)+_0x34fb39+'\x20(@'+_0x5e2d1e+')')):_0x133cef=await database_1[_0x5b0e78(0x136)]['telegramUser'][_0x5b0e78(0x17e)]({'where':{'telegramId':_0x34fb39},'data':{'username':_0x5e2d1e,'firstName':_0x1ee4ba,'lastName':_0x3aa1fc},'include':{'shop':!![]}}),_0x133cef[_0x5b0e78(0x130)]&&_0x133cef[_0x5b0e78(0x135)]&&_0x133cef[_0x5b0e78(0x1b7)]?await this[_0x5b0e78(0xfc)]?.['sendMessage'](_0xed1d6d,_0x5b0e78(0x12a)+(_0x5b0e78(0x10b)+_0x133cef[_0x5b0e78(0x1b7)][_0x5b0e78(0x18f)]+'*\x0a')+(_0x5b0e78(0x189)+_0x133cef[_0x5b0e78(0x1b7)]['username']+'`\x0a\x0a')+_0x5b0e78(0x167)+_0x5b0e78(0x170)+_0x5b0e78(0xec)+_0x5b0e78(0x12d)+_0x5b0e78(0x109)+_0x5b0e78(0x125)+_0x5b0e78(0x198),{'parse_mode':_0x5b0e78(0x13c)}):(_0x133cef[_0x5b0e78(0x135)]&&!_0x133cef['isVerified']&&(await database_1[_0x5b0e78(0x136)]['telegramUser'][_0x5b0e78(0x17e)]({'where':{'telegramId':_0x34fb39},'data':{'shopId':null,'isVerified':![]}}),console[_0x5b0e78(0x18c)]('🔄\x20Reset\x20incomplete\x20verification\x20for\x20user\x20'+_0x34fb39)),await this[_0x5b0e78(0xfc)]?.[_0x5b0e78(0x1a4)](_0xed1d6d,'🤖\x20Welcome\x20to\x20TRAPAY\x20notification\x20system!\x0a\x0a'+_0x5b0e78(0x11d)+_0x5b0e78(0x16e)+_0x5b0e78(0x134)+_0x5b0e78(0x16a)+_0x5b0e78(0x12f),{'parse_mode':_0x5b0e78(0x13c)}));}catch(_0x1f9aea){console[_0x5b0e78(0x157)](_0x5b0e78(0xe6),_0x1f9aea),await this[_0x5b0e78(0xfc)]?.['sendMessage'](_0xed1d6d,_0x5b0e78(0x11b));}}),this[_0x255905(0xfc)][_0x255905(0x10e)](/\/disconnect/,async _0x4dab38=>{const _0x228bbe=_0x255905,_0x48ef30=_0x4dab38[_0x228bbe(0x186)]['id'],_0x4c8c26=_0x4dab38[_0x228bbe(0x140)]?.['id'][_0x228bbe(0x1a3)]();if(!_0x4c8c26)return;try{const _0x319c01=await database_1[_0x228bbe(0x136)]['telegramUser'][_0x228bbe(0xf0)]({'where':{'telegramId':_0x4c8c26},'include':{'shop':!![]}});if(!_0x319c01||!_0x319c01['isVerified']||!_0x319c01[_0x228bbe(0x135)]){await this['bot']?.[_0x228bbe(0x1a4)](_0x48ef30,_0x228bbe(0x13a));return;}const _0xa9726e=_0x319c01[_0x228bbe(0x1b7)]?.[_0x228bbe(0x18f)]||_0x228bbe(0x126);await database_1[_0x228bbe(0x136)]['telegramUser'][_0x228bbe(0x17e)]({'where':{'telegramId':_0x4c8c26},'data':{'shopId':null,'isVerified':![]}}),console[_0x228bbe(0x18c)](_0x228bbe(0x150)+_0x4c8c26+_0x228bbe(0x1b5)+_0x319c01[_0x228bbe(0x135)]),await this[_0x228bbe(0xfc)]?.[_0x228bbe(0x1a4)](_0x48ef30,_0x228bbe(0x1b3)+_0xa9726e+'*.\x0a\x0a'+'To\x20reconnect,\x20use\x20the\x20/start\x20command',{'parse_mode':_0x228bbe(0x13c)});}catch(_0x384ec6){console['error'](_0x228bbe(0x192),_0x384ec6),await this[_0x228bbe(0xfc)]?.[_0x228bbe(0x1a4)](_0x48ef30,_0x228bbe(0x11b));}}),this['bot'][_0x255905(0x10e)](/\/status/,async _0x1b26b1=>{const _0x5d941f=_0x255905,_0x3b5885=_0x1b26b1['chat']['id'],_0x409e5a=_0x1b26b1[_0x5d941f(0x140)]?.['id']['toString']();if(!_0x409e5a)return;try{const _0x4761eb=await database_1[_0x5d941f(0x136)][_0x5d941f(0xf9)][_0x5d941f(0xf0)]({'where':{'telegramId':_0x409e5a},'include':{'shop':!![]}});if(!_0x4761eb){await this[_0x5d941f(0xfc)]?.[_0x5d941f(0x1a4)](_0x3b5885,_0x5d941f(0x160)+_0x5d941f(0x197));return;}if(!_0x4761eb['isVerified']||!_0x4761eb[_0x5d941f(0x135)]||!_0x4761eb[_0x5d941f(0x1b7)]){await this['bot']?.[_0x5d941f(0x1a4)](_0x3b5885,_0x5d941f(0xef)+_0x5d941f(0xf2));return;}await this['bot']?.['sendMessage'](_0x3b5885,_0x5d941f(0xdc)+(_0x5d941f(0x10f)+_0x4761eb[_0x5d941f(0x1b7)][_0x5d941f(0x18f)]+'*\x0a')+(_0x5d941f(0x14f)+_0x4761eb['shop'][_0x5d941f(0x14e)]+'`\x0a')+('📅\x20Connection\x20date:\x20'+_0x4761eb['updatedAt']['toLocaleDateString'](_0x5d941f(0xfb))+'\x0a\x0a')+_0x5d941f(0x14a)+_0x5d941f(0x109)+_0x5d941f(0x198),{'parse_mode':_0x5d941f(0x13c)});}catch(_0x5a3824){console['error']('Error\x20handling\x20/status\x20command:',_0x5a3824),await this[_0x5d941f(0xfc)]?.['sendMessage'](_0x3b5885,_0x5d941f(0x11b));}}),this['bot'][_0x255905(0x10e)](/\/debug/,async _0x5cd464=>{const _0x21e231=_0x255905,_0x5c9e50=_0x5cd464['chat']['id'],_0x2435c9=_0x5cd464['from']?.['id'][_0x21e231(0x1a3)]();if(!_0x2435c9)return;try{const _0x19826f=await database_1[_0x21e231(0x136)][_0x21e231(0x1b7)][_0x21e231(0xf4)]({'select':{'id':!![],'name':!![],'username':!![],'status':!![],'publicKey':!![]},'take':0xa});let _0x49fc72='🔍\x20*Debug\x20Information*\x0a\x0a';_0x49fc72+=_0x21e231(0xe3)+_0x2435c9+_0x21e231(0x132),_0x49fc72+='🏪\x20Available\x20shops\x20in\x20system:\x0a',_0x19826f['forEach']((_0xf253ff,_0x29c29c)=>{const _0x20d25e=_0x21e231;_0x49fc72+=_0x29c29c+0x1+_0x20d25e(0x199)+_0xf253ff[_0x20d25e(0x18f)]+'*\x0a',_0x49fc72+=_0x20d25e(0x11f)+_0xf253ff[_0x20d25e(0x14e)]+'`\x0a',_0x49fc72+=_0x20d25e(0x1ab)+_0xf253ff[_0x20d25e(0x19f)]+'\x0a',_0x49fc72+='\x20\x20\x20Public\x20Key:\x20`'+_0xf253ff[_0x20d25e(0x15c)][_0x20d25e(0x17f)](0x0,0xf)+'...`\x0a\x0a';}),await this[_0x21e231(0xfc)]?.[_0x21e231(0x1a4)](_0x5c9e50,_0x49fc72,{'parse_mode':'Markdown'});}catch(_0x462d26){console[_0x21e231(0x157)]('Error\x20handling\x20/debug\x20command:',_0x462d26),await this[_0x21e231(0xfc)]?.[_0x21e231(0x1a4)](_0x5c9e50,_0x21e231(0x17a));}}),this[_0x255905(0xfc)]['on'](_0x255905(0x19b),async _0x1b4c24=>{const _0x37300d=_0x255905;if(_0x1b4c24['text']?.[_0x37300d(0xe0)]('/'))return;const _0x489829=_0x1b4c24['chat']['id'],_0x3ae922=_0x1b4c24[_0x37300d(0x140)]?.['id'][_0x37300d(0x1a3)](),_0x5174eb=_0x1b4c24[_0x37300d(0x101)]?.[_0x37300d(0x10c)]();if(!_0x3ae922||!_0x5174eb)return;try{const _0x417b12=await database_1[_0x37300d(0x136)][_0x37300d(0xf9)]['findUnique']({'where':{'telegramId':_0x3ae922},'include':{'shop':!![]}});if(!_0x417b12){await this[_0x37300d(0xfc)]?.['sendMessage'](_0x489829,'❌\x20Please\x20use\x20/start\x20command\x20first');return;}if(_0x417b12[_0x37300d(0x130)]&&_0x417b12[_0x37300d(0x135)]&&_0x417b12['shop']){await this[_0x37300d(0xfc)]?.[_0x37300d(0x1a4)](_0x489829,_0x37300d(0xeb)+_0x417b12[_0x37300d(0x1b7)]['name']+'*.\x0a\x0a'+'Use\x20/status\x20to\x20check\x20status\x20or\x20/disconnect\x20to\x20disconnect.',{'parse_mode':_0x37300d(0x13c)});return;}const _0x371dae=_0x5174eb[_0x37300d(0x1b4)](/\s+/);if(_0x371dae[_0x37300d(0x14d)]!==0x2){await this[_0x37300d(0xfc)]?.[_0x37300d(0x1a4)](_0x489829,_0x37300d(0x123)+_0x37300d(0x16e)+'Example:\x0a'+_0x37300d(0x16a)+(_0x37300d(0x1af)+_0x371dae[_0x37300d(0x14d)]+'\x20parts:\x20'+_0x371dae[_0x37300d(0xda)](_0xa83cc4=>'`'+_0xa83cc4+'`')[_0x37300d(0x174)](',\x20')),{'parse_mode':_0x37300d(0x13c)});return;}const [_0x1de7d2,_0x2700bf]=_0x371dae;console[_0x37300d(0x18c)](_0x37300d(0x112)+_0x3ae922+_0x37300d(0xf5)+_0x1de7d2+_0x37300d(0x1b1)+_0x2700bf['substring'](0x0,0xa)+'...\x22'),await this[_0x37300d(0x142)](_0x489829,_0x3ae922,_0x1de7d2,_0x2700bf);}catch(_0x5b1461){console[_0x37300d(0x157)](_0x37300d(0x156),_0x5b1461),await this['bot']?.[_0x37300d(0x1a4)](_0x489829,_0x37300d(0x11b));}}),this['bot']['on'](_0x255905(0x157),_0x5dbdf1=>{const _0x3a9879=_0x255905;console[_0x3a9879(0x157)](_0x3a9879(0x168),_0x5dbdf1);}),this[_0x255905(0xfc)]['on'](_0x255905(0xf1),_0x35d427=>{const _0x251bc6=_0x255905;console[_0x251bc6(0x157)]('Telegram\x20bot\x20polling\x20error:',_0x35d427);});}async[a54_0x102cc0(0x142)](_0x5e8d4c,_0x8505de,_0x120db9,_0xb76d34){const _0x2de3d0=a54_0x102cc0;try{console[_0x2de3d0(0x18c)](_0x2de3d0(0x112)+_0x8505de+_0x2de3d0(0xf5)+_0x120db9+_0x2de3d0(0x1b1)+_0xb76d34[_0x2de3d0(0x17f)](0x0,0xa)+_0x2de3d0(0x111));if(!_0x120db9||_0x120db9[_0x2de3d0(0x14d)]<0x3||_0x120db9['length']>0x32||!/^[a-zA-Z0-9_]+$/['test'](_0x120db9)){await this[_0x2de3d0(0xfc)]?.['sendMessage'](_0x5e8d4c,_0x2de3d0(0x12b)+_0x120db9+_0x2de3d0(0x132)+_0x2de3d0(0x137),{'parse_mode':'Markdown'});return;}if(!_0xb76d34||!_0xb76d34[_0x2de3d0(0xe0)](_0x2de3d0(0x18e))&&!_0xb76d34[_0x2de3d0(0xe0)](_0x2de3d0(0xfe))){await this[_0x2de3d0(0xfc)]?.[_0x2de3d0(0x1a4)](_0x5e8d4c,_0x2de3d0(0x10d)+_0x2de3d0(0x164),{'parse_mode':_0x2de3d0(0x13c)});return;}const _0x49d4af=await database_1[_0x2de3d0(0x136)][_0x2de3d0(0x1b7)][_0x2de3d0(0xf0)]({'where':{'username':_0x120db9},'select':{'id':!![],'name':!![],'username':!![],'status':!![],'publicKey':!![],'secretKey':!![]}});if(!_0x49d4af){const _0x332c0a=await database_1[_0x2de3d0(0x136)]['shop'][_0x2de3d0(0xf4)]({'select':{'username':!![],'name':!![]},'take':0x5});let _0x58e4e0=_0x2de3d0(0x11a)+_0x120db9+'`\x20not\x20found.\x0a\x0a';_0x332c0a[_0x2de3d0(0x14d)]>0x0?(_0x58e4e0+=_0x2de3d0(0x128),_0x332c0a[_0x2de3d0(0x107)](_0x42cfbe=>{const _0x487785=_0x2de3d0;_0x58e4e0+=_0x487785(0x116)+_0x42cfbe[_0x487785(0x14e)]+_0x487785(0x154)+_0x42cfbe[_0x487785(0x18f)]+')\x0a';}),_0x58e4e0+=_0x2de3d0(0x120)):_0x58e4e0+=_0x2de3d0(0xed);await this[_0x2de3d0(0xfc)]?.['sendMessage'](_0x5e8d4c,_0x58e4e0,{'parse_mode':_0x2de3d0(0x13c)});return;}if(_0x49d4af[_0x2de3d0(0x19f)]!=='ACTIVE'){await this['bot']?.[_0x2de3d0(0x1a4)](_0x5e8d4c,_0x2de3d0(0x1a9)+_0x120db9+_0x2de3d0(0x110)+_0x2de3d0(0x19c),{'parse_mode':'Markdown'});return;}if(_0x49d4af[_0x2de3d0(0x15c)]!==_0xb76d34&&_0x49d4af[_0x2de3d0(0x180)]!==_0xb76d34){await this[_0x2de3d0(0xfc)]?.[_0x2de3d0(0x1a4)](_0x5e8d4c,_0x2de3d0(0x13f)+_0x120db9+'`.\x0a\x0a'+_0x2de3d0(0x12c)+_0x2de3d0(0x185),{'parse_mode':_0x2de3d0(0x13c)});return;}const _0x1fadc5=await database_1[_0x2de3d0(0x136)][_0x2de3d0(0xf9)][_0x2de3d0(0xe9)]({'where':{'shopId':_0x49d4af['id'],'isVerified':!![],'telegramId':{'not':_0x8505de}}});if(_0x1fadc5){await this[_0x2de3d0(0xfc)]?.['sendMessage'](_0x5e8d4c,_0x2de3d0(0x1a8)+_0x120db9+'`.\x0a\x0a'+_0x2de3d0(0x12e),{'parse_mode':'Markdown'});return;}await database_1[_0x2de3d0(0x136)]['telegramUser'][_0x2de3d0(0x17e)]({'where':{'telegramId':_0x8505de},'data':{'shopId':_0x49d4af['id'],'isVerified':!![]}}),await this['bot']?.[_0x2de3d0(0x1a4)](_0x5e8d4c,_0x2de3d0(0x14c)+_0x2de3d0(0x172)+(_0x2de3d0(0x163)+_0x49d4af[_0x2de3d0(0x18f)]+'*\x0a')+(_0x2de3d0(0x14f)+_0x49d4af[_0x2de3d0(0x14e)]+_0x2de3d0(0x132))+_0x2de3d0(0x155)+_0x2de3d0(0x170)+_0x2de3d0(0xec)+_0x2de3d0(0x16b)+'•\x20Important\x20events\x0a\x0a'+_0x2de3d0(0x109)+_0x2de3d0(0x125)+_0x2de3d0(0x198),{'parse_mode':'Markdown'}),console[_0x2de3d0(0x18c)](_0x2de3d0(0x165)+_0x8505de+'\x20verified\x20for\x20shop\x20'+_0x49d4af['username']+_0x2de3d0(0x145));}catch(_0x58f6df){console['error'](_0x2de3d0(0x106),_0x58f6df),await this['bot']?.[_0x2de3d0(0x1a4)](_0x5e8d4c,_0x2de3d0(0xee));}}async[a54_0x102cc0(0xd9)](_0x3eed86,_0x2d97cd,_0x1478f2){const _0x3264c4=a54_0x102cc0;if(!this[_0x3264c4(0xfc)]){console['warn'](_0x3264c4(0x16d));return;}try{const _0x5d678f=await database_1[_0x3264c4(0x136)]['telegramUser'][_0x3264c4(0xf4)]({'where':{'shopId':_0x3eed86,'isVerified':!![]}});if(_0x5d678f[_0x3264c4(0x14d)]===0x0){console['log'](_0x3264c4(0x152)+_0x3eed86);return;}const _0x38b84a=_0x5d678f[_0x3264c4(0xda)](async _0x5d7c2b=>{const _0x1aa533=_0x3264c4;try{await this[_0x1aa533(0xfc)]?.[_0x1aa533(0x1a4)](_0x5d7c2b[_0x1aa533(0xe7)],_0x2d97cd,_0x1478f2),console[_0x1aa533(0x18c)](_0x1aa533(0x1ac)+_0x5d7c2b[_0x1aa533(0xe7)]);}catch(_0x25990c){console[_0x1aa533(0x157)](_0x1aa533(0xf6)+_0x5d7c2b[_0x1aa533(0xe7)]+':',_0x25990c),_0x25990c instanceof Error&&(_0x25990c[_0x1aa533(0x19b)]['includes'](_0x1aa533(0xde))||_0x25990c[_0x1aa533(0x19b)][_0x1aa533(0x118)]('chat\x20not\x20found')||_0x25990c['message'][_0x1aa533(0x118)]('user\x20is\x20deactivated'))&&(await database_1['default'][_0x1aa533(0xf9)][_0x1aa533(0x17e)]({'where':{'id':_0x5d7c2b['id']},'data':{'isVerified':![]}}),console[_0x1aa533(0x18c)](_0x1aa533(0x175)+_0x5d7c2b[_0x1aa533(0xe7)]+_0x1aa533(0xff)));}});await Promise[_0x3264c4(0x181)](_0x38b84a);}catch(_0x5c38a5){console[_0x3264c4(0x157)](_0x3264c4(0x138),_0x5c38a5);}}async[a54_0x102cc0(0x194)](_0x12c3d4,_0x1f5642,_0x12a0dc){const _0xba91ff=a54_0x102cc0,_0x56af1e={'created':'🆕','paid':'✅','failed':'❌','expired':'⏰','refund':'🔄','chargeback':'⚠️','processing':'⚙️'},_0x441b5b={'created':'New\x20payment\x20created','paid':_0xba91ff(0x13b),'failed':_0xba91ff(0x17c),'expired':_0xba91ff(0x102),'refund':'Payment\x20refund','chargeback':'Payment\x20chargeback','processing':_0xba91ff(0x19d)},_0x5305ee=_0x56af1e[_0x12a0dc],_0x13e633=_0x441b5b[_0x12a0dc],_0x3e5438=(0x0,gateway_1[_0xba91ff(0x1ad)])(_0x1f5642['gateway']);console[_0xba91ff(0x18c)](_0xba91ff(0x104)+_0x1f5642[_0xba91ff(0x182)]+'\x22\x20->\x20display\x20\x22'+_0x3e5438+'\x22');let _0x433fad=_0x5305ee+'\x20*'+_0x13e633+_0xba91ff(0x1b6)+('💰\x20Amount:\x20*'+_0x1f5642[_0xba91ff(0xe4)]+'\x20'+_0x1f5642[_0xba91ff(0x196)]+'*\x0a')+(_0xba91ff(0x1a7)+(_0x1f5642[_0xba91ff(0x15d)]||_0x1f5642['id'])+'`\x0a')+(_0xba91ff(0xea)+_0x1f5642['id']+'`\x0a')+(_0xba91ff(0x139)+_0x3e5438+'`\x0a')+(_0xba91ff(0x13d)+new Date(_0x1f5642[_0xba91ff(0x195)])[_0xba91ff(0x127)](_0xba91ff(0xfb))+'\x0a');if(_0x1f5642[_0xba91ff(0x129)]||_0x1f5642[_0xba91ff(0x1b2)]||_0x1f5642[_0xba91ff(0x19e)]||_0x1f5642[_0xba91ff(0x173)]||_0x1f5642[_0xba91ff(0x122)]){_0x433fad+='\x0a👤\x20*Customer\x20Information:*\x0a';_0x1f5642['customerName']&&(_0x433fad+=_0xba91ff(0x158)+_0x1f5642[_0xba91ff(0x129)]+'`\x0a');_0x1f5642[_0xba91ff(0x1b2)]&&(_0x433fad+=_0xba91ff(0xf8)+_0x1f5642[_0xba91ff(0x1b2)]+'`\x0a');_0x1f5642[_0xba91ff(0x19e)]&&(_0x433fad+=_0xba91ff(0x18b)+_0x1f5642[_0xba91ff(0x19e)]+'`\x0a');_0x1f5642[_0xba91ff(0x173)]&&(_0x433fad+=_0xba91ff(0xdd)+_0x1f5642[_0xba91ff(0x173)]+'`\x0a');if(_0x1f5642[_0xba91ff(0x122)]){const _0x4df1ab=_0x1f5642[_0xba91ff(0x122)][_0xba91ff(0x14d)]>0x32?_0x1f5642[_0xba91ff(0x122)]['substring'](0x0,0x32)+'...':_0x1f5642['customerUa'];_0x433fad+=_0xba91ff(0x16f)+_0x4df1ab+'`\x0a';}}_0x12a0dc===_0xba91ff(0x1b0)&&_0x1f5642[_0xba91ff(0x19a)]&&(_0x433fad+=_0xba91ff(0x171)+_0x1f5642[_0xba91ff(0x19a)]+_0xba91ff(0x103)),_0x12a0dc===_0xba91ff(0x11c)&&(_0x433fad+='⏳\x20The\x20payment\x20is\x20currently\x20being\x20processed\x20by\x20the\x20gateway.\x0a'),_0x1f5642[_0xba91ff(0x119)]&&(_0x433fad+='📝\x20Notes:\x20'+_0x1f5642['adminNotes']+'\x0a'),await this['sendShopNotification'](_0x12c3d4,_0x433fad,{'parse_mode':'Markdown'});}async['sendPayoutNotification'](_0x587a4c,_0x14647a,_0x5dd6cd){const _0x2765ac=a54_0x102cc0,_0x1088ce={'created':'📤','completed':'✅','rejected':'❌'},_0x28af58={'created':'New\x20payout\x20created','completed':_0x2765ac(0x115),'rejected':_0x2765ac(0x117)},_0x5b374f=_0x1088ce[_0x5dd6cd],_0x3475e5=_0x28af58[_0x5dd6cd],_0x1978a9=_0x5b374f+'\x20*'+_0x3475e5+'*\x0a\x0a'+('💸\x20Amount:\x20*'+_0x14647a['amount']+_0x2765ac(0x108))+(_0x2765ac(0x143)+_0x14647a[_0x2765ac(0x188)]+'`\x0a')+(_0x2765ac(0x159)+_0x14647a['id']+'`\x0a')+(_0x2765ac(0x13d)+new Date(_0x14647a['createdAt'])['toLocaleString'](_0x2765ac(0xfb))+'\x0a')+(_0x14647a[_0x2765ac(0x113)]?_0x2765ac(0x15a)+_0x14647a[_0x2765ac(0x113)]+'`':'');await this[_0x2765ac(0xd9)](_0x587a4c,_0x1978a9,{'parse_mode':_0x2765ac(0x13c)});}async['sendLoginNotification'](_0x190ed1,_0x48646b){const _0x3b3582=a54_0x102cc0;try{const _0x3949b4=await database_1['default'][_0x3b3582(0x187)][_0x3b3582(0xf0)]({'where':{'shopId':_0x190ed1},'select':{'notificationLogin':!![]}});if(!_0x3949b4?.[_0x3b3582(0x191)]){console[_0x3b3582(0x18c)](_0x3b3582(0x14b)+_0x190ed1);return;}const _0x5797b8=_0x48646b[_0x3b3582(0x15e)]?'🔐':'🚨',_0x2a502d=_0x48646b[_0x3b3582(0x15e)]?_0x3b3582(0x1a6):_0x3b3582(0xe5);let _0x49cbc2=_0x5797b8+'\x20*'+_0x2a502d+'*\x0a\x0a'+(_0x3b3582(0x14f)+_0x48646b[_0x3b3582(0x14e)]+'`\x0a')+('📅\x20Time:\x20'+_0x48646b[_0x3b3582(0xdf)][_0x3b3582(0x127)](_0x3b3582(0xfb))+'\x0a');_0x48646b[_0x3b3582(0x100)]&&(_0x49cbc2+=_0x3b3582(0x147)+_0x48646b[_0x3b3582(0x100)]+'`\x0a');if(_0x48646b[_0x3b3582(0x1a2)]){const _0x4ded23=_0x48646b[_0x3b3582(0x1a2)]['length']>0x32?_0x48646b[_0x3b3582(0x1a2)][_0x3b3582(0x17f)](0x0,0x32)+_0x3b3582(0x1a5):_0x48646b['userAgent'];_0x49cbc2+=_0x3b3582(0x16f)+_0x4ded23+'`\x0a';}!_0x48646b['success']&&(_0x49cbc2+=_0x3b3582(0x15f)),await this[_0x3b3582(0xd9)](_0x190ed1,_0x49cbc2,{'parse_mode':_0x3b3582(0x13c)}),console['log'](_0x3b3582(0x141)+_0x190ed1+':\x20'+(_0x48646b[_0x3b3582(0x15e)]?'success':'failed'));}catch(_0x16c56f){console['error'](_0x3b3582(0x149),_0x16c56f);}}async[a54_0x102cc0(0x114)](_0x59fe8e,_0x175ed7){const _0x466257=a54_0x102cc0;try{const _0x409ea3=await database_1[_0x466257(0x136)][_0x466257(0x187)][_0x466257(0xf0)]({'where':{'shopId':_0x59fe8e},'select':{'notificationApiError':!![]}});if(!_0x409ea3?.[_0x466257(0x169)]){console[_0x466257(0x18c)](_0x466257(0x153)+_0x59fe8e);return;}let _0x5edb2c=_0x466257(0x178)+('🔗\x20Endpoint:\x20`'+_0x175ed7[_0x466257(0x188)]+'\x20'+_0x175ed7[_0x466257(0xe2)]+'`\x0a')+(_0x466257(0x161)+_0x175ed7[_0x466257(0xdf)][_0x466257(0x127)](_0x466257(0xfb))+'\x0a');_0x175ed7[_0x466257(0xdb)]&&(_0x5edb2c+='📊\x20Error\x20code:\x20`'+_0x175ed7['statusCode']+'`\x0a'),_0x5edb2c+=_0x466257(0x183)+_0x175ed7[_0x466257(0x179)]+'`\x0a',_0x175ed7[_0x466257(0x18a)]&&(_0x5edb2c+='🆔\x20Request\x20ID:\x20`'+_0x175ed7[_0x466257(0x18a)]+'`\x0a'),_0x5edb2c+='\x0a💡\x20Check\x20your\x20request\x20or\x20contact\x20support.',await this[_0x466257(0xd9)](_0x59fe8e,_0x5edb2c,{'parse_mode':_0x466257(0x13c)}),console['log'](_0x466257(0x16c)+_0x59fe8e+':\x20'+_0x175ed7[_0x466257(0xe2)]);}catch(_0xd96404){console['error']('Failed\x20to\x20send\x20API\x20error\x20notification:',_0xd96404);}}async[a54_0x102cc0(0x18d)](_0x3f2224,_0x9244f0,_0x1ae026){const _0x2614d6=a54_0x102cc0;let _0x140063='🔔\x20*'+_0x9244f0+_0x2614d6(0x1b6);for(const [_0x1e28ff,_0x48aa76]of Object[_0x2614d6(0x1ae)](_0x1ae026)){_0x48aa76!==null&&_0x48aa76!==undefined&&(_0x140063+=_0x1e28ff+':\x20`'+_0x48aa76+'`\x0a');}await this[_0x2614d6(0xd9)](_0x3f2224,_0x140063,{'parse_mode':_0x2614d6(0x13c)});}[a54_0x102cc0(0x133)](){return{'isActive':!!this['bot'],'username':this['botUsername']};}['stopBot'](){const _0x1df52b=a54_0x102cc0;this[_0x1df52b(0xfc)]&&(this[_0x1df52b(0xfc)][_0x1df52b(0x11e)](),this[_0x1df52b(0xfc)]=null,console[_0x1df52b(0x18c)](_0x1df52b(0xd8)));}}exports[a54_0x102cc0(0x13e)]=TelegramBotService,exports[a54_0x102cc0(0x177)]=new TelegramBotService();