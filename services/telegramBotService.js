'use strict';const a59_0x28f36b=a59_0x5623;function a59_0x5623(_0x4c3f5a,_0x190db2){const _0x36022d=a59_0x3602();return a59_0x5623=function(_0x56236e,_0x3d9a2f){_0x56236e=_0x56236e-0x149;let _0x478a68=_0x36022d[_0x56236e];return _0x478a68;},a59_0x5623(_0x4c3f5a,_0x190db2);}(function(_0x35e6c7,_0x49d46b){const _0x4922b1=a59_0x5623,_0x22741f=_0x35e6c7();while(!![]){try{const _0x47aab8=-parseInt(_0x4922b1(0x1d9))/0x1+-parseInt(_0x4922b1(0x224))/0x2*(parseInt(_0x4922b1(0x22b))/0x3)+parseInt(_0x4922b1(0x1a1))/0x4+parseInt(_0x4922b1(0x163))/0x5+-parseInt(_0x4922b1(0x204))/0x6+parseInt(_0x4922b1(0x215))/0x7+-parseInt(_0x4922b1(0x169))/0x8*(-parseInt(_0x4922b1(0x200))/0x9);if(_0x47aab8===_0x49d46b)break;else _0x22741f['push'](_0x22741f['shift']());}catch(_0x48470d){_0x22741f['push'](_0x22741f['shift']());}}}(a59_0x3602,0x8e193));var __importDefault=this&&this['__importDefault']||function(_0x14934c){return _0x14934c&&_0x14934c['__esModule']?_0x14934c:{'default':_0x14934c};};Object['defineProperty'](exports,a59_0x28f36b(0x217),{'value':!![]}),exports[a59_0x28f36b(0x18a)]=exports[a59_0x28f36b(0x22d)]=void 0x0;const node_telegram_bot_api_1=__importDefault(require('node-telegram-bot-api')),database_1=__importDefault(require(a59_0x28f36b(0x218))),gateway_1=require(a59_0x28f36b(0x182));class TelegramBotService{constructor(){const _0x5c3d08=a59_0x28f36b;this['bot']=null,this[_0x5c3d08(0x1ae)]=process[_0x5c3d08(0x179)][_0x5c3d08(0x159)]||'',this[_0x5c3d08(0x1b1)]=process[_0x5c3d08(0x179)][_0x5c3d08(0x191)]||'trapay_bot',this[_0x5c3d08(0x1ae)]?this[_0x5c3d08(0x1f6)]():console[_0x5c3d08(0x1aa)](_0x5c3d08(0x1f5));}[a59_0x28f36b(0x1f6)](){const _0x2d2378=a59_0x28f36b;try{this[_0x2d2378(0x1a0)]=new node_telegram_bot_api_1['default'](this[_0x2d2378(0x1ae)],{'polling':!![]}),this['setupBotHandlers'](),console[_0x2d2378(0x170)](_0x2d2378(0x1ab)+this['botUsername']+_0x2d2378(0x1e4));}catch(_0x3d27de){console['error'](_0x2d2378(0x1eb),_0x3d27de);}}['setupBotHandlers'](){const _0x984a27=a59_0x28f36b;if(!this[_0x984a27(0x1a0)])return;this['bot'][_0x984a27(0x1cc)](/\/start/,async _0x470d72=>{const _0x57df57=_0x984a27,_0x39c0b8=_0x470d72[_0x57df57(0x19e)]['id'],_0x10f13a=_0x470d72[_0x57df57(0x16d)]?.['id'][_0x57df57(0x1fe)](),_0x16ce62=_0x470d72['from']?.[_0x57df57(0x185)],_0x183a9e=_0x470d72[_0x57df57(0x16d)]?.[_0x57df57(0x18e)],_0x5f20ee=_0x470d72['from']?.[_0x57df57(0x15c)];if(!_0x10f13a)return;try{let _0x3a4eff=await database_1['default'][_0x57df57(0x1b2)]['findUnique']({'where':{'telegramId':_0x10f13a},'include':{'shop':!![]}});!_0x3a4eff?(_0x3a4eff=await database_1[_0x57df57(0x21a)][_0x57df57(0x1b2)][_0x57df57(0x181)]({'data':{'telegramId':_0x10f13a,'username':_0x16ce62,'firstName':_0x183a9e,'lastName':_0x5f20ee,'isVerified':![],'shopId':null},'include':{'shop':!![]}}),console[_0x57df57(0x170)]('📱\x20Created\x20new\x20Telegram\x20user:\x20'+_0x10f13a+_0x57df57(0x15e)+_0x16ce62+')')):_0x3a4eff=await database_1[_0x57df57(0x21a)][_0x57df57(0x1b2)][_0x57df57(0x1fb)]({'where':{'telegramId':_0x10f13a},'data':{'username':_0x16ce62,'firstName':_0x183a9e,'lastName':_0x5f20ee},'include':{'shop':!![]}}),_0x3a4eff[_0x57df57(0x21d)]&&_0x3a4eff[_0x57df57(0x21f)]&&_0x3a4eff['shop']?await this[_0x57df57(0x1a0)]?.['sendMessage'](_0x39c0b8,_0x57df57(0x1af)+(_0x57df57(0x213)+_0x3a4eff[_0x57df57(0x21c)][_0x57df57(0x1ec)]+'*\x0a')+(_0x57df57(0x16c)+_0x3a4eff[_0x57df57(0x21c)][_0x57df57(0x185)]+'`\x0a\x0a')+_0x57df57(0x1b5)+_0x57df57(0x1ca)+'•\x20Payment\x20status\x20changes\x0a'+_0x57df57(0x17c)+'Commands:\x0a'+_0x57df57(0x21e)+_0x57df57(0x1cf),{'parse_mode':_0x57df57(0x199)}):(_0x3a4eff[_0x57df57(0x21f)]&&!_0x3a4eff['isVerified']&&(await database_1['default'][_0x57df57(0x1b2)]['update']({'where':{'telegramId':_0x10f13a},'data':{'shopId':null,'isVerified':![]}}),console[_0x57df57(0x170)](_0x57df57(0x190)+_0x10f13a)),await this[_0x57df57(0x1a0)]?.['sendMessage'](_0x39c0b8,_0x57df57(0x1dd)+_0x57df57(0x150)+_0x57df57(0x203)+'Example:\x0a'+_0x57df57(0x1f4)+_0x57df57(0x176),{'parse_mode':'Markdown'}));}catch(_0x426835){console[_0x57df57(0x1e8)](_0x57df57(0x1ed),_0x426835),await this[_0x57df57(0x1a0)]?.['sendMessage'](_0x39c0b8,_0x57df57(0x1be));}}),this[_0x984a27(0x1a0)][_0x984a27(0x1cc)](/\/disconnect/,async _0x1ab9f5=>{const _0x32d6f9=_0x984a27,_0x58d5ba=_0x1ab9f5[_0x32d6f9(0x19e)]['id'],_0x485778=_0x1ab9f5[_0x32d6f9(0x16d)]?.['id'][_0x32d6f9(0x1fe)]();if(!_0x485778)return;try{const _0x4407f3=await database_1[_0x32d6f9(0x21a)][_0x32d6f9(0x1b2)][_0x32d6f9(0x173)]({'where':{'telegramId':_0x485778},'include':{'shop':!![]}});if(!_0x4407f3||!_0x4407f3[_0x32d6f9(0x21d)]||!_0x4407f3[_0x32d6f9(0x21f)]){await this[_0x32d6f9(0x1a0)]?.[_0x32d6f9(0x195)](_0x58d5ba,'❌\x20You\x20are\x20not\x20connected\x20to\x20the\x20notification\x20system.');return;}const _0x55e974=_0x4407f3[_0x32d6f9(0x21c)]?.[_0x32d6f9(0x1ec)]||_0x32d6f9(0x1a5);await database_1[_0x32d6f9(0x21a)][_0x32d6f9(0x1b2)][_0x32d6f9(0x1fb)]({'where':{'telegramId':_0x485778},'data':{'shopId':null,'isVerified':![]}}),console[_0x32d6f9(0x170)](_0x32d6f9(0x1e6)+_0x485778+_0x32d6f9(0x1b0)+_0x4407f3[_0x32d6f9(0x21f)]),await this[_0x32d6f9(0x1a0)]?.[_0x32d6f9(0x195)](_0x58d5ba,_0x32d6f9(0x201)+_0x55e974+'*.\x0a\x0a'+'To\x20reconnect,\x20use\x20the\x20/start\x20command',{'parse_mode':'Markdown'});}catch(_0x2e36eb){console[_0x32d6f9(0x1e8)](_0x32d6f9(0x226),_0x2e36eb),await this[_0x32d6f9(0x1a0)]?.[_0x32d6f9(0x195)](_0x58d5ba,_0x32d6f9(0x1be));}}),this['bot'][_0x984a27(0x1cc)](/\/status/,async _0x522f21=>{const _0x565ad2=_0x984a27,_0x32b31e=_0x522f21[_0x565ad2(0x19e)]['id'],_0x43436d=_0x522f21[_0x565ad2(0x16d)]?.['id'][_0x565ad2(0x1fe)]();if(!_0x43436d)return;try{const _0x1ce1d9=await database_1[_0x565ad2(0x21a)][_0x565ad2(0x1b2)][_0x565ad2(0x173)]({'where':{'telegramId':_0x43436d},'include':{'shop':!![]}});if(!_0x1ce1d9){await this[_0x565ad2(0x1a0)]?.[_0x565ad2(0x195)](_0x32b31e,_0x565ad2(0x174)+_0x565ad2(0x208));return;}if(!_0x1ce1d9[_0x565ad2(0x21d)]||!_0x1ce1d9[_0x565ad2(0x21f)]||!_0x1ce1d9[_0x565ad2(0x21c)]){await this[_0x565ad2(0x1a0)]?.['sendMessage'](_0x32b31e,_0x565ad2(0x166)+'Use\x20/start\x20to\x20connect.');return;}await this[_0x565ad2(0x1a0)]?.[_0x565ad2(0x195)](_0x32b31e,_0x565ad2(0x1f1)+(_0x565ad2(0x1f3)+_0x1ce1d9[_0x565ad2(0x21c)]['name']+'*\x0a')+(_0x565ad2(0x1dc)+_0x1ce1d9['shop'][_0x565ad2(0x185)]+'`\x0a')+(_0x565ad2(0x1ef)+_0x1ce1d9[_0x565ad2(0x1bc)][_0x565ad2(0x14b)](_0x565ad2(0x1c5))+'\x0a\x0a')+_0x565ad2(0x17d)+'Commands:\x0a'+'/disconnect\x20-\x20disconnect\x20from\x20notifications',{'parse_mode':_0x565ad2(0x199)});}catch(_0xa05373){console[_0x565ad2(0x1e8)](_0x565ad2(0x227),_0xa05373),await this[_0x565ad2(0x1a0)]?.[_0x565ad2(0x195)](_0x32b31e,'❌\x20An\x20error\x20occurred.\x20Please\x20try\x20again\x20later.');}}),this['bot']['onText'](/\/debug/,async _0x5c1a26=>{const _0x4eb974=_0x984a27,_0x2919f8=_0x5c1a26[_0x4eb974(0x19e)]['id'],_0x21264f=_0x5c1a26[_0x4eb974(0x16d)]?.['id'][_0x4eb974(0x1fe)]();if(!_0x21264f)return;try{const _0x51711b=await database_1['default'][_0x4eb974(0x21c)][_0x4eb974(0x1a2)]({'select':{'id':!![],'name':!![],'username':!![],'status':!![],'publicKey':!![]},'take':0xa});let _0x502407=_0x4eb974(0x167);_0x502407+=_0x4eb974(0x18f)+_0x21264f+_0x4eb974(0x16a),_0x502407+=_0x4eb974(0x165),_0x51711b['forEach']((_0x3c5ae7,_0x2d3651)=>{const _0x3a21e4=_0x4eb974;_0x502407+=_0x2d3651+0x1+'.\x20*'+_0x3c5ae7[_0x3a21e4(0x1ec)]+'*\x0a',_0x502407+=_0x3a21e4(0x16e)+_0x3c5ae7['username']+'`\x0a',_0x502407+=_0x3a21e4(0x212)+_0x3c5ae7[_0x3a21e4(0x1b7)]+'\x0a',_0x502407+='\x20\x20\x20Public\x20Key:\x20`'+_0x3c5ae7[_0x3a21e4(0x1e3)][_0x3a21e4(0x194)](0x0,0xf)+'...`\x0a\x0a';}),await this[_0x4eb974(0x1a0)]?.[_0x4eb974(0x195)](_0x2919f8,_0x502407,{'parse_mode':_0x4eb974(0x199)});}catch(_0x4a93bf){console[_0x4eb974(0x1e8)](_0x4eb974(0x1d7),_0x4a93bf),await this[_0x4eb974(0x1a0)]?.['sendMessage'](_0x2919f8,_0x4eb974(0x1bb));}}),this[_0x984a27(0x1a0)]['on']('message',async _0xb5846f=>{const _0x48edd9=_0x984a27;if(_0xb5846f[_0x48edd9(0x1fd)]?.[_0x48edd9(0x1d8)]('/'))return;const _0x152d87=_0xb5846f['chat']['id'],_0x3391ee=_0xb5846f[_0x48edd9(0x16d)]?.['id'][_0x48edd9(0x1fe)](),_0x3c2165=_0xb5846f[_0x48edd9(0x1fd)]?.[_0x48edd9(0x202)]();if(!_0x3391ee||!_0x3c2165)return;try{const _0xc4b860=await database_1['default']['telegramUser'][_0x48edd9(0x173)]({'where':{'telegramId':_0x3391ee},'include':{'shop':!![]}});if(!_0xc4b860){await this['bot']?.[_0x48edd9(0x195)](_0x152d87,_0x48edd9(0x17a));return;}if(_0xc4b860[_0x48edd9(0x21d)]&&_0xc4b860['shopId']&&_0xc4b860[_0x48edd9(0x21c)]){await this[_0x48edd9(0x1a0)]?.[_0x48edd9(0x195)](_0x152d87,'✅\x20You\x20are\x20already\x20connected\x20to\x20shop\x20*'+_0xc4b860[_0x48edd9(0x21c)][_0x48edd9(0x1ec)]+'*.\x0a\x0a'+_0x48edd9(0x1ee),{'parse_mode':_0x48edd9(0x199)});return;}const _0x38aee7=_0x3c2165['split'](/\s+/);if(_0x38aee7[_0x48edd9(0x20d)]!==0x2){await this[_0x48edd9(0x1a0)]?.['sendMessage'](_0x152d87,'❌\x20Invalid\x20format.\x20Please\x20send\x20exactly\x202\x20parts\x20separated\x20by\x20space:\x0a\x0a'+_0x48edd9(0x203)+_0x48edd9(0x1d6)+_0x48edd9(0x1f4)+('You\x20sent\x20'+_0x38aee7[_0x48edd9(0x20d)]+'\x20parts:\x20'+_0x38aee7[_0x48edd9(0x16b)](_0x329b73=>'`'+_0x329b73+'`')[_0x48edd9(0x1b9)](',\x20')),{'parse_mode':_0x48edd9(0x199)});return;}const [_0x1aa94f,_0x31d6d7]=_0x38aee7;console[_0x48edd9(0x170)]('🔄\x20Processing\x20single-line\x20verification\x20for\x20user\x20'+_0x3391ee+':\x20username=\x22'+_0x1aa94f+_0x48edd9(0x221)+_0x31d6d7[_0x48edd9(0x194)](0x0,0xa)+_0x48edd9(0x196)),await this[_0x48edd9(0x14a)](_0x152d87,_0x3391ee,_0x1aa94f,_0x31d6d7);}catch(_0x12f526){console[_0x48edd9(0x1e8)](_0x48edd9(0x205),_0x12f526),await this[_0x48edd9(0x1a0)]?.[_0x48edd9(0x195)](_0x152d87,_0x48edd9(0x1be));}}),this[_0x984a27(0x1a0)]['on']('error',_0x37839b=>{const _0x1bc58d=_0x984a27;console[_0x1bc58d(0x1e8)](_0x1bc58d(0x1f8),_0x37839b);}),this['bot']['on'](_0x984a27(0x1c8),_0x45d74f=>{const _0x2730fd=_0x984a27;console[_0x2730fd(0x1e8)](_0x2730fd(0x1c3),_0x45d74f);});}async[a59_0x28f36b(0x14a)](_0x545773,_0x46b720,_0x206fe3,_0x4ca19a){const _0x59db7e=a59_0x28f36b;try{console[_0x59db7e(0x170)](_0x59db7e(0x18b)+_0x46b720+_0x59db7e(0x156)+_0x206fe3+_0x59db7e(0x221)+_0x4ca19a[_0x59db7e(0x194)](0x0,0xa)+_0x59db7e(0x196));if(!_0x206fe3||_0x206fe3['length']<0x3||_0x206fe3[_0x59db7e(0x20d)]>0x32||!/^[a-zA-Z0-9_]+$/[_0x59db7e(0x192)](_0x206fe3)){await this[_0x59db7e(0x1a0)]?.[_0x59db7e(0x195)](_0x545773,_0x59db7e(0x18c)+_0x206fe3+_0x59db7e(0x16a)+_0x59db7e(0x184),{'parse_mode':_0x59db7e(0x199)});return;}if(!_0x4ca19a||!_0x4ca19a[_0x59db7e(0x1d8)](_0x59db7e(0x188))&&!_0x4ca19a[_0x59db7e(0x1d8)](_0x59db7e(0x14f))){await this[_0x59db7e(0x1a0)]?.[_0x59db7e(0x195)](_0x545773,'❌\x20Invalid\x20API\x20key\x20format.\x0a\x0a'+_0x59db7e(0x175),{'parse_mode':'Markdown'});return;}const _0x5e676b=await database_1[_0x59db7e(0x21a)][_0x59db7e(0x21c)][_0x59db7e(0x173)]({'where':{'username':_0x206fe3},'select':{'id':!![],'name':!![],'username':!![],'status':!![],'publicKey':!![],'secretKey':!![]}});if(!_0x5e676b){const _0x31b966=await database_1[_0x59db7e(0x21a)][_0x59db7e(0x21c)]['findMany']({'select':{'username':!![],'name':!![]},'take':0x5});let _0x3f9875=_0x59db7e(0x219)+_0x206fe3+_0x59db7e(0x198);_0x31b966[_0x59db7e(0x20d)]>0x0?(_0x3f9875+=_0x59db7e(0x1ac),_0x31b966[_0x59db7e(0x18d)](_0x1d5873=>{const _0x597456=_0x59db7e;_0x3f9875+=_0x597456(0x1f7)+_0x1d5873[_0x597456(0x185)]+_0x597456(0x1c4)+_0x1d5873[_0x597456(0x1ec)]+')\x0a';}),_0x3f9875+=_0x59db7e(0x153)):_0x3f9875+=_0x59db7e(0x177);await this[_0x59db7e(0x1a0)]?.['sendMessage'](_0x545773,_0x3f9875,{'parse_mode':'Markdown'});return;}if(_0x5e676b[_0x59db7e(0x1b7)]!=='ACTIVE'){await this[_0x59db7e(0x1a0)]?.['sendMessage'](_0x545773,'❌\x20Shop\x20`'+_0x206fe3+'`\x20is\x20inactive.\x0a\x0a'+'Contact\x20administrator.',{'parse_mode':_0x59db7e(0x199)});return;}if(_0x5e676b[_0x59db7e(0x1e3)]!==_0x4ca19a&&_0x5e676b['secretKey']!==_0x4ca19a){await this[_0x59db7e(0x1a0)]?.['sendMessage'](_0x545773,_0x59db7e(0x1d0)+_0x206fe3+_0x59db7e(0x22a)+_0x59db7e(0x1a8)+_0x59db7e(0x1d5),{'parse_mode':'Markdown'});return;}const _0x15baae=await database_1[_0x59db7e(0x21a)][_0x59db7e(0x1b2)][_0x59db7e(0x1d3)]({'where':{'shopId':_0x5e676b['id'],'isVerified':!![],'telegramId':{'not':_0x46b720}}});if(_0x15baae){await this[_0x59db7e(0x1a0)]?.[_0x59db7e(0x195)](_0x545773,'❌\x20Another\x20Telegram\x20account\x20is\x20already\x20connected\x20to\x20shop\x20`'+_0x206fe3+'`.\x0a\x0a'+_0x59db7e(0x1ba),{'parse_mode':'Markdown'});return;}await database_1['default'][_0x59db7e(0x1b2)][_0x59db7e(0x1fb)]({'where':{'telegramId':_0x46b720},'data':{'shopId':_0x5e676b['id'],'isVerified':!![]}}),await this[_0x59db7e(0x1a0)]?.[_0x59db7e(0x195)](_0x545773,_0x59db7e(0x193)+_0x59db7e(0x1f2)+(_0x59db7e(0x161)+_0x5e676b[_0x59db7e(0x1ec)]+'*\x0a')+('👤\x20Username:\x20`'+_0x5e676b[_0x59db7e(0x185)]+_0x59db7e(0x16a))+_0x59db7e(0x209)+_0x59db7e(0x1ca)+_0x59db7e(0x1cd)+_0x59db7e(0x15a)+_0x59db7e(0x1f0)+'Commands:\x0a'+_0x59db7e(0x21e)+_0x59db7e(0x1cf),{'parse_mode':_0x59db7e(0x199)}),console[_0x59db7e(0x170)](_0x59db7e(0x183)+_0x46b720+_0x59db7e(0x22c)+_0x5e676b[_0x59db7e(0x185)]+_0x59db7e(0x15d));}catch(_0x983f08){console[_0x59db7e(0x1e8)](_0x59db7e(0x1a3),_0x983f08),await this['bot']?.['sendMessage'](_0x545773,_0x59db7e(0x1ce));}}async[a59_0x28f36b(0x152)](_0x362a9a,_0x2bd76e,_0x42ab67){const _0x58733b=a59_0x28f36b;if(!this[_0x58733b(0x1a0)]){console[_0x58733b(0x1aa)]('Telegram\x20bot\x20not\x20initialized,\x20cannot\x20send\x20notification');return;}try{const _0x1c2f7b=await database_1[_0x58733b(0x21a)][_0x58733b(0x1b2)][_0x58733b(0x1a2)]({'where':{'shopId':_0x362a9a,'isVerified':!![]}});if(_0x1c2f7b[_0x58733b(0x20d)]===0x0){console[_0x58733b(0x170)](_0x58733b(0x1cb)+_0x362a9a);return;}const _0x40adc5=_0x1c2f7b[_0x58733b(0x16b)](async _0x3f73ba=>{const _0x2db5aa=_0x58733b;try{await this[_0x2db5aa(0x1a0)]?.[_0x2db5aa(0x195)](_0x3f73ba[_0x2db5aa(0x168)],_0x2bd76e,_0x42ab67),console[_0x2db5aa(0x170)](_0x2db5aa(0x164)+_0x3f73ba[_0x2db5aa(0x168)]);}catch(_0x17af1e){console[_0x2db5aa(0x1e8)](_0x2db5aa(0x14d)+_0x3f73ba[_0x2db5aa(0x168)]+':',_0x17af1e),_0x17af1e instanceof Error&&(_0x17af1e['message'][_0x2db5aa(0x1c1)]('blocked')||_0x17af1e[_0x2db5aa(0x19b)][_0x2db5aa(0x1c1)](_0x2db5aa(0x1e5))||_0x17af1e[_0x2db5aa(0x19b)][_0x2db5aa(0x1c1)](_0x2db5aa(0x1ea)))&&(await database_1['default']['telegramUser'][_0x2db5aa(0x1fb)]({'where':{'id':_0x3f73ba['id']},'data':{'isVerified':![]}}),console['log'](_0x2db5aa(0x19d)+_0x3f73ba['telegramId']+_0x2db5aa(0x1e9)));}});await Promise[_0x58733b(0x197)](_0x40adc5);}catch(_0x16b694){console[_0x58733b(0x1e8)](_0x58733b(0x1ff),_0x16b694);}}async[a59_0x28f36b(0x1f9)](_0x2aa125,_0x4252c2,_0x246358){const _0x3beb6e=a59_0x28f36b,_0x334b77={'created':'🆕','paid':'✅','failed':'❌','expired':'⏰','refund':'🔄','chargeback':'⚠️','processing':'⚙️'},_0x392488={'created':_0x3beb6e(0x172),'paid':_0x3beb6e(0x1de),'failed':_0x3beb6e(0x207),'expired':_0x3beb6e(0x17f),'refund':_0x3beb6e(0x157),'chargeback':_0x3beb6e(0x1b3),'processing':_0x3beb6e(0x211)},_0xba80b2=_0x334b77[_0x246358],_0x386f58=_0x392488[_0x246358],_0x545997=(0x0,gateway_1['getGatewayDisplayNameForTelegram'])(_0x4252c2['gateway']);console[_0x3beb6e(0x170)]('📱\x20Telegram\x20notification:\x20gateway\x20\x22'+_0x4252c2['gateway']+_0x3beb6e(0x222)+_0x545997+'\x22');let _0x2547b4=_0xba80b2+'\x20*'+_0x386f58+_0x3beb6e(0x1c0)+(_0x3beb6e(0x1df)+_0x4252c2[_0x3beb6e(0x1c7)]+'\x20'+_0x4252c2[_0x3beb6e(0x229)]+'*\x0a')+('📝\x20Order\x20ID:\x20`'+(_0x4252c2[_0x3beb6e(0x1fc)]||_0x4252c2['id'])+'`\x0a')+('🆔\x20Payment\x20ID:\x20`'+_0x4252c2['id']+'`\x0a')+('🏪\x20Gateway:\x20`'+_0x545997+'`\x0a')+(_0x3beb6e(0x21b)+new Date(_0x4252c2[_0x3beb6e(0x1a9)])['toLocaleString']('en-US')+'\x0a');if(_0x4252c2[_0x3beb6e(0x1b8)]||_0x4252c2[_0x3beb6e(0x151)]||_0x4252c2['remitterIban']||_0x4252c2[_0x3beb6e(0x1b6)]||_0x4252c2[_0x3beb6e(0x162)]){_0x2547b4+=_0x3beb6e(0x1ad);_0x4252c2[_0x3beb6e(0x1b8)]&&(_0x2547b4+=_0x3beb6e(0x1a4)+_0x4252c2['customerName']+'`\x0a');_0x4252c2[_0x3beb6e(0x151)]&&(_0x2547b4+='📧\x20Email:\x20`'+_0x4252c2[_0x3beb6e(0x151)]+'`\x0a');_0x4252c2[_0x3beb6e(0x189)]&&(_0x2547b4+=_0x3beb6e(0x1d4)+_0x4252c2[_0x3beb6e(0x189)]+'`\x0a');_0x4252c2[_0x3beb6e(0x1b6)]&&(_0x2547b4+=_0x3beb6e(0x1c2)+_0x4252c2['customerIp']+'`\x0a');if(_0x4252c2[_0x3beb6e(0x162)]){const _0x59a3e2=_0x4252c2[_0x3beb6e(0x162)][_0x3beb6e(0x20d)]>0x32?_0x4252c2[_0x3beb6e(0x162)][_0x3beb6e(0x194)](0x0,0x32)+_0x3beb6e(0x214):_0x4252c2['customerUa'];_0x2547b4+=_0x3beb6e(0x20b)+_0x59a3e2+'`\x0a';}}_0x246358===_0x3beb6e(0x160)&&_0x4252c2[_0x3beb6e(0x155)]&&(_0x2547b4+='💸\x20Penalty\x20amount:\x20*'+_0x4252c2['chargebackAmount']+_0x3beb6e(0x20c)),_0x246358===_0x3beb6e(0x15f)&&(_0x2547b4+=_0x3beb6e(0x20f)),_0x4252c2[_0x3beb6e(0x1c9)]&&(_0x2547b4+=_0x3beb6e(0x16f)+_0x4252c2['adminNotes']+'\x0a'),await this['sendShopNotification'](_0x2aa125,_0x2547b4,{'parse_mode':_0x3beb6e(0x199)});}async['sendPayoutNotification'](_0x3f5913,_0xc6c73f,_0x1535fd){const _0x2fbc7c=a59_0x28f36b,_0x3c40d9={'created':'📤','completed':'✅','rejected':'❌'},_0x115440={'created':_0x2fbc7c(0x20e),'completed':_0x2fbc7c(0x1e2),'rejected':_0x2fbc7c(0x228)},_0x2aacf8=_0x3c40d9[_0x1535fd],_0x1e7ca2=_0x115440[_0x1535fd],_0x4b1611=_0x2aacf8+'\x20*'+_0x1e7ca2+'*\x0a\x0a'+(_0x2fbc7c(0x15b)+_0xc6c73f[_0x2fbc7c(0x1c7)]+_0x2fbc7c(0x149))+('🏦\x20Method:\x20`'+_0xc6c73f[_0x2fbc7c(0x1a7)]+'`\x0a')+(_0x2fbc7c(0x19a)+_0xc6c73f['id']+'`\x0a')+(_0x2fbc7c(0x21b)+new Date(_0xc6c73f[_0x2fbc7c(0x1a9)])['toLocaleString']('en-US')+'\x0a')+(_0xc6c73f[_0x2fbc7c(0x1b4)]?_0x2fbc7c(0x19f)+_0xc6c73f[_0x2fbc7c(0x1b4)]+'`':'');await this[_0x2fbc7c(0x152)](_0x3f5913,_0x4b1611,{'parse_mode':_0x2fbc7c(0x199)});}async['sendLoginNotification'](_0x21d3a7,_0x3c267b){const _0x33ca97=a59_0x28f36b;try{const _0x37b323=await database_1['default'][_0x33ca97(0x14e)][_0x33ca97(0x173)]({'where':{'shopId':_0x21d3a7},'select':{'notificationLogin':!![]}});if(!_0x37b323?.[_0x33ca97(0x186)]){console[_0x33ca97(0x170)](_0x33ca97(0x1bd)+_0x21d3a7);return;}const _0x1b1243=_0x3c267b[_0x33ca97(0x1d1)]?'🔐':'🚨',_0xcf48a7=_0x3c267b[_0x33ca97(0x1d1)]?_0x33ca97(0x17b):_0x33ca97(0x220);let _0x3a35de=_0x1b1243+'\x20*'+_0xcf48a7+_0x33ca97(0x1c0)+(_0x33ca97(0x1dc)+_0x3c267b[_0x33ca97(0x185)]+'`\x0a')+('📅\x20Time:\x20'+_0x3c267b[_0x33ca97(0x171)][_0x33ca97(0x14c)](_0x33ca97(0x1c5))+'\x0a');_0x3c267b[_0x33ca97(0x187)]&&(_0x3a35de+=_0x33ca97(0x1a6)+_0x3c267b[_0x33ca97(0x187)]+'`\x0a');if(_0x3c267b[_0x33ca97(0x19c)]){const _0x16d163=_0x3c267b[_0x33ca97(0x19c)][_0x33ca97(0x20d)]>0x32?_0x3c267b[_0x33ca97(0x19c)][_0x33ca97(0x194)](0x0,0x32)+_0x33ca97(0x214):_0x3c267b['userAgent'];_0x3a35de+='💻\x20Browser:\x20`'+_0x16d163+'`\x0a';}!_0x3c267b[_0x33ca97(0x1d1)]&&(_0x3a35de+=_0x33ca97(0x225)),await this[_0x33ca97(0x152)](_0x21d3a7,_0x3a35de,{'parse_mode':'Markdown'}),console['log'](_0x33ca97(0x216)+_0x21d3a7+':\x20'+(_0x3c267b['success']?'success':_0x33ca97(0x1e1)));}catch(_0x3751eb){console['error'](_0x33ca97(0x1e0),_0x3751eb);}}async[a59_0x28f36b(0x154)](_0x5c6cbe,_0x951be4){const _0x5e491d=a59_0x28f36b;try{const _0x266573=await database_1['default'][_0x5e491d(0x14e)][_0x5e491d(0x173)]({'where':{'shopId':_0x5c6cbe},'select':{'notificationApiError':!![]}});if(!_0x266573?.[_0x5e491d(0x1db)]){console[_0x5e491d(0x170)](_0x5e491d(0x178)+_0x5c6cbe);return;}let _0x1008ff=_0x5e491d(0x20a)+(_0x5e491d(0x210)+_0x951be4['method']+'\x20'+_0x951be4['endpoint']+'`\x0a')+(_0x5e491d(0x1da)+_0x951be4[_0x5e491d(0x171)][_0x5e491d(0x14c)](_0x5e491d(0x1c5))+'\x0a');_0x951be4[_0x5e491d(0x17e)]&&(_0x1008ff+=_0x5e491d(0x1c6)+_0x951be4[_0x5e491d(0x17e)]+'`\x0a'),_0x1008ff+=_0x5e491d(0x22e)+_0x951be4['errorMessage']+'`\x0a',_0x951be4[_0x5e491d(0x1d2)]&&(_0x1008ff+=_0x5e491d(0x1bf)+_0x951be4[_0x5e491d(0x1d2)]+'`\x0a'),_0x1008ff+='\x0a💡\x20Check\x20your\x20request\x20or\x20contact\x20support.',await this[_0x5e491d(0x152)](_0x5c6cbe,_0x1008ff,{'parse_mode':'Markdown'}),console[_0x5e491d(0x170)]('✅\x20API\x20error\x20notification\x20sent\x20for\x20shop\x20'+_0x5c6cbe+':\x20'+_0x951be4['endpoint']);}catch(_0x277be1){console[_0x5e491d(0x1e8)](_0x5e491d(0x206),_0x277be1);}}async[a59_0x28f36b(0x1fa)](_0x5d30d4,_0x191711,_0xa80dda){const _0x1e28ab=a59_0x28f36b;let _0x325fb6=_0x1e28ab(0x180)+_0x191711+_0x1e28ab(0x1c0);for(const [_0xac46a5,_0x64ac15]of Object[_0x1e28ab(0x1e7)](_0xa80dda)){_0x64ac15!==null&&_0x64ac15!==undefined&&(_0x325fb6+=_0xac46a5+':\x20`'+_0x64ac15+'`\x0a');}await this[_0x1e28ab(0x152)](_0x5d30d4,_0x325fb6,{'parse_mode':_0x1e28ab(0x199)});}['getBotInfo'](){const _0x334e8b=a59_0x28f36b;return{'isActive':!!this[_0x334e8b(0x1a0)],'username':this[_0x334e8b(0x1b1)]};}[a59_0x28f36b(0x158)](){const _0x12ba2d=a59_0x28f36b;this['bot']&&(this['bot'][_0x12ba2d(0x223)](),this[_0x12ba2d(0x1a0)]=null,console[_0x12ba2d(0x170)]('🛑\x20Telegram\x20bot\x20stopped'));}}exports[a59_0x28f36b(0x22d)]=TelegramBotService,exports[a59_0x28f36b(0x18a)]=new TelegramBotService();function a59_0x3602(){const _0xf84fb5=['❌\x20Shop\x20with\x20username\x20`','default','📅\x20Date:\x20','shop','isVerified','/status\x20-\x20check\x20connection\x20status\x0a','shopId','Failed\x20login\x20attempt','\x22,\x20apiKey=\x22','\x22\x20->\x20display\x20\x22','stopPolling','1155734XbqqhS','\x0a⚠️\x20If\x20this\x20wasn\x27t\x20you,\x20change\x20your\x20password\x20immediately!','Error\x20handling\x20/disconnect\x20command:','Error\x20handling\x20/status\x20command:','Payout\x20rejected','currency','`.\x0a\x0a','3VpKVQz','\x20verified\x20for\x20shop\x20','TelegramBotService','❌\x20Error:\x20`','\x20USD*\x0a','handleSingleLineVerification','toLocaleDateString','toLocaleString','❌\x20Failed\x20to\x20send\x20notification\x20to\x20Telegram\x20user\x20','shopSettings','sk_','To\x20receive\x20payment\x20notifications,\x20send\x20your\x20credentials\x20in\x20one\x20line:\x0a\x0a','customerEmail','sendShopNotification','\x0aCheck\x20spelling\x20and\x20try\x20again.','sendApiErrorNotification','chargebackAmount',':\x20username=\x22','Payment\x20refund','stopBot','TELEGRAM_BOT_TOKEN','•\x20Payouts\x0a','💸\x20Amount:\x20*','last_name','\x20via\x20single-line\x20input','\x20(@','processing','chargeback','📱\x20Shop:\x20*','customerUa','1760635zzIxxS','✅\x20Notification\x20sent\x20to\x20Telegram\x20user\x20','🏪\x20Available\x20shops\x20in\x20system:\x0a','❌\x20You\x20are\x20not\x20connected\x20to\x20a\x20shop.\x0a\x0a','🔍\x20*Debug\x20Information*\x0a\x0a','telegramId','65536PEDnym','`\x0a\x0a','map','Username:\x20`','from','\x20\x20\x20Username:\x20`','📝\x20Notes:\x20','log','timestamp','New\x20payment\x20created','findUnique','❌\x20You\x20are\x20not\x20registered\x20in\x20the\x20system.\x0a\x0a','API\x20key\x20must\x20start\x20with\x20`pk\x5c_`\x20or\x20`sk\x5c_`.','❗️\x20Make\x20sure\x20to\x20separate\x20username\x20and\x20API\x20key\x20with\x20a\x20space!','Check\x20spelling\x20and\x20try\x20again.','📱\x20API\x20error\x20notifications\x20disabled\x20for\x20shop\x20','env','❌\x20Please\x20use\x20/start\x20command\x20first','Successful\x20login','•\x20Payouts\x0a\x0a','🔔\x20Notifications\x20are\x20active\x0a\x0a','statusCode','Payment\x20expired','🔔\x20*','create','../types/gateway','✅\x20Telegram\x20user\x20','Username\x20must\x20contain\x20only\x20letters,\x20numbers\x20and\x20underscore\x20(3-50\x20characters).','username','notificationLogin','ipAddress','pk_','remitterIban','telegramBotService','🔄\x20Processing\x20single-line\x20verification\x20for\x20user\x20','❌\x20Invalid\x20username\x20format:\x20`','forEach','first_name','📱\x20Your\x20Telegram\x20ID:\x20`','🔄\x20Reset\x20incomplete\x20verification\x20for\x20user\x20','TELEGRAM_BOT_USERNAME','test','🎉\x20*Congratulations!*\x0a\x0a','substring','sendMessage','...\x22','allSettled','`\x20not\x20found.\x0a\x0a','Markdown','🆔\x20Payout\x20ID:\x20`','message','userAgent','User\x20','chat','🔗\x20TXID:\x20`','bot','1408664MXZZNJ','findMany','Error\x20in\x20handleSingleLineVerification:','📛\x20Name:\x20`','unknown\x20shop','🌐\x20IP\x20address:\x20`','method','Check\x20the\x20key\x20and\x20try\x20again.\x0a\x0a','createdAt','warn','✅\x20Telegram\x20bot\x20@','Available\x20usernames:\x0a','\x0a👤\x20*Customer\x20Information:*\x0a','botToken','✅\x20Welcome\x20back!\x0a\x0a','\x20disconnected\x20from\x20shop\x20','botUsername','telegramUser','Payment\x20chargeback','txid','🔔\x20You\x20receive\x20notifications\x20about:\x0a','customerIp','status','customerName','join','Disconnect\x20the\x20previous\x20account\x20first\x20or\x20contact\x20administrator.','❌\x20Error\x20getting\x20debug\x20information.','updatedAt','📱\x20Login\x20notifications\x20disabled\x20for\x20shop\x20','❌\x20An\x20error\x20occurred.\x20Please\x20try\x20again\x20later.','🆔\x20Request\x20ID:\x20`','*\x0a\x0a','includes','🌐\x20IP:\x20`','Telegram\x20bot\x20polling\x20error:','`\x20(','en-US','📊\x20Error\x20code:\x20`','amount','polling_error','adminNotes','•\x20New\x20payments\x0a','No\x20verified\x20Telegram\x20users\x20found\x20for\x20shop\x20','onText','•\x20Payment\x20status\x20changes\x0a','❌\x20An\x20error\x20occurred\x20while\x20verifying\x20data.','/disconnect\x20-\x20disconnect\x20from\x20notifications','❌\x20API\x20key\x20does\x20not\x20match\x20shop\x20`','success','requestId','findFirst','🏦\x20IBAN:\x20`','Expected\x20key\x20format:\x20`pk_...`\x20or\x20`sk_...`','Example:\x0a','Error\x20handling\x20/debug\x20command:','startsWith','453519gJYgIP','📅\x20Time:\x20','notificationApiError','👤\x20Username:\x20`','🤖\x20Welcome\x20to\x20TRAPAY\x20notification\x20system!\x0a\x0a','Payment\x20successfully\x20paid','💰\x20Amount:\x20*','Failed\x20to\x20send\x20login\x20notification:','failed','Payout\x20completed','publicKey','\x20initialized\x20successfully','chat\x20not\x20found','🔌\x20User\x20','entries','error','\x20marked\x20as\x20unverified\x20due\x20to\x20delivery\x20failure','user\x20is\x20deactivated','❌\x20Failed\x20to\x20initialize\x20Telegram\x20bot:','name','Error\x20handling\x20/start\x20command:','Use\x20/status\x20to\x20check\x20status\x20or\x20/disconnect\x20to\x20disconnect.','📅\x20Connection\x20date:\x20','•\x20Important\x20events\x0a\x0a','📊\x20*Connection\x20Status*\x0a\x0a','✅\x20You\x20have\x20been\x20successfully\x20connected\x20to\x20the\x20notification\x20system!\x0a\x0a','✅\x20Connected\x20to\x20shop:\x20*','`appple\x20pk_aa6450d3f57afbefbb0f3f5be5ce6cca13037536afc5ccf14c81a6cbc7a07de5`\x0a\x0a','TELEGRAM_BOT_TOKEN\x20not\x20found\x20in\x20environment\x20variables','initializeBot','•\x20`','Telegram\x20bot\x20error:','sendPaymentNotification','sendCustomNotification','update','orderId','text','toString','Error\x20sending\x20shop\x20notification:','927BMmiWc','✅\x20You\x20have\x20been\x20successfully\x20disconnected\x20from\x20shop\x20*','trim','📝\x20Format:\x20`username\x20api_key`\x0a\x0a','2483934tgvsBC','Error\x20handling\x20message:','Failed\x20to\x20send\x20API\x20error\x20notification:','Payment\x20failed','Use\x20/start\x20to\x20begin.','🔔\x20You\x20will\x20now\x20receive\x20notifications\x20about:\x0a','🚨\x20*API\x20Error*\x0a\x0a','💻\x20Browser:\x20`','\x20USDT*\x0a','length','New\x20payout\x20created','⏳\x20The\x20payment\x20is\x20currently\x20being\x20processed\x20by\x20the\x20gateway.\x0a','🔗\x20Endpoint:\x20`','Payment\x20is\x20being\x20processed','\x20\x20\x20Status:\x20','You\x20are\x20already\x20connected\x20to\x20shop:\x20*','...','3355387EcZVlP','✅\x20Login\x20notification\x20sent\x20for\x20shop\x20','__esModule','../config/database'];a59_0x3602=function(){return _0xf84fb5;};return a59_0x3602();}