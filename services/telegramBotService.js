'use strict';const a59_0x40e192=a59_0x52fb;(function(_0x3b275f,_0x3c0b75){const _0xe875df=a59_0x52fb,_0x3d5306=_0x3b275f();while(!![]){try{const _0x4188e0=-parseInt(_0xe875df(0x1a5))/0x1*(-parseInt(_0xe875df(0x235))/0x2)+-parseInt(_0xe875df(0x199))/0x3+parseInt(_0xe875df(0x1a9))/0x4+parseInt(_0xe875df(0x1d4))/0x5*(-parseInt(_0xe875df(0x257))/0x6)+parseInt(_0xe875df(0x1d3))/0x7*(parseInt(_0xe875df(0x24f))/0x8)+-parseInt(_0xe875df(0x24b))/0x9*(parseInt(_0xe875df(0x1f1))/0xa)+-parseInt(_0xe875df(0x17c))/0xb;if(_0x4188e0===_0x3c0b75)break;else _0x3d5306['push'](_0x3d5306['shift']());}catch(_0x42ea08){_0x3d5306['push'](_0x3d5306['shift']());}}}(a59_0x4f7b,0xc25e9));function a59_0x4f7b(){const _0x28956c=['❌\x20An\x20error\x20occurred\x20while\x20verifying\x20data.','❌\x20You\x20are\x20not\x20connected\x20to\x20the\x20notification\x20system.','success','📝\x20Notes:\x20','telegramUser','🔗\x20TXID:\x20`','🆔\x20Request\x20ID:\x20`','7238550LdzoxA','❌\x20Shop\x20with\x20username\x20`','🔄\x20Processing\x20single-line\x20verification\x20for\x20user\x20','✅\x20Welcome\x20back!\x0a\x0a','💸\x20Penalty\x20amount:\x20*','/disconnect\x20-\x20disconnect\x20from\x20notifications','blocked','gateway','errorMessage','...\x22','New\x20payment\x20created','Payment\x20chargeback','chargeback','create','Check\x20spelling\x20and\x20try\x20again.','✅\x20Connected\x20to\x20shop:\x20*','Failed\x20to\x20send\x20login\x20notification:','📅\x20Time:\x20','❌\x20Error\x20getting\x20debug\x20information.','❌\x20Please\x20use\x20/start\x20command\x20first','`\x0a\x0a','status','User\x20','botToken','allSettled','•\x20Payment\x20status\x20changes\x0a','username','🌐\x20IP\x20address:\x20`','.\x20*','1606581HKixyQ','🔌\x20User\x20','sendPaymentNotification','No\x20verified\x20Telegram\x20users\x20found\x20for\x20shop\x20','❌\x20Another\x20Telegram\x20account\x20is\x20already\x20connected\x20to\x20shop\x20`','🔔\x20You\x20will\x20now\x20receive\x20notifications\x20about:\x0a','en-US','test','unknown\x20shop','\x0aCheck\x20spelling\x20and\x20try\x20again.','userAgent','Error\x20handling\x20message:','361299AxAEEs','message','map','shop','1882504gfQMeX','🔍\x20*Debug\x20Information*\x0a\x0a','❌\x20An\x20error\x20occurred.\x20Please\x20try\x20again\x20later.','user\x20is\x20deactivated','📱\x20API\x20error\x20notifications\x20disabled\x20for\x20shop\x20','Payment\x20successfully\x20paid','sendPayoutNotification','📅\x20Connection\x20date:\x20','findMany','•\x20New\x20payments\x0a','Commands:\x0a','•\x20`','\x0a⚠️\x20If\x20this\x20wasn\x27t\x20you,\x20change\x20your\x20password\x20immediately!','publicKey','TELEGRAM_BOT_TOKEN\x20not\x20found\x20in\x20environment\x20variables','sk_','\x20via\x20single-line\x20input','../config/database','📱\x20Your\x20Telegram\x20ID:\x20`','__esModule','Error\x20sending\x20shop\x20notification:','💰\x20Amount:\x20*','\x20USDT*\x0a','🔗\x20Endpoint:\x20`','Payment\x20refund',':\x20`','🏪\x20Gateway:\x20`','Error\x20in\x20handleSingleLineVerification:','...`\x0a\x0a','Use\x20/status\x20to\x20check\x20status\x20or\x20/disconnect\x20to\x20disconnect.','TelegramBotService','\x20\x20\x20Public\x20Key:\x20`','chat\x20not\x20found','telegramId','env','secretKey','*.\x0a\x0a','txid','Telegram\x20bot\x20error:','Error\x20handling\x20/start\x20command:','endpoint','📊\x20Error\x20code:\x20`','1970423cfvtXP','5FPXoBm','❌\x20Failed\x20to\x20initialize\x20Telegram\x20bot:','Contact\x20administrator.','`\x20is\x20inactive.\x0a\x0a','botUsername','Successful\x20login','\x20initialized\x20successfully','ipAddress','You\x20sent\x20','Payout\x20completed','pk_','✅\x20Notification\x20sent\x20to\x20Telegram\x20user\x20','Use\x20/start\x20to\x20connect.','requestId','📱\x20Login\x20notifications\x20disabled\x20for\x20shop\x20','✅\x20Telegram\x20bot\x20@','getBotInfo','Use\x20/start\x20to\x20begin.','telegramBotService','🔔\x20Notifications\x20are\x20active\x0a\x0a','\x22,\x20apiKey=\x22','findFirst','toLocaleString','Payment\x20expired','🎉\x20*Congratulations!*\x0a\x0a','Payment\x20failed','Failed\x20to\x20send\x20API\x20error\x20notification:','stopBot','❌\x20Invalid\x20API\x20key\x20format.\x0a\x0a','230SLuFTZ','❌\x20Invalid\x20username\x20format:\x20`','📧\x20Email:\x20`','processing','Available\x20usernames:\x0a','👤\x20Username:\x20`','\x20(@','To\x20reconnect,\x20use\x20the\x20/start\x20command','\x20\x20\x20Username:\x20`','customerName','adminNotes','setupBotHandlers','log','chat','\x22\x20->\x20display\x20\x22','✅\x20You\x20are\x20already\x20connected\x20to\x20shop\x20*','🔔\x20You\x20receive\x20notifications\x20about:\x0a','substring','TELEGRAM_BOT_USERNAME','__importDefault','bot','🌐\x20IP:\x20`','entries','New\x20payout\x20created','statusCode','🔔\x20*','❌\x20You\x20are\x20not\x20registered\x20in\x20the\x20system.\x0a\x0a','❌\x20Invalid\x20format.\x20Please\x20send\x20exactly\x202\x20parts\x20separated\x20by\x20space:\x0a\x0a','\x20USD*\x0a','You\x20are\x20already\x20connected\x20to\x20shop:\x20*','handleSingleLineVerification','❌\x20API\x20key\x20does\x20not\x20match\x20shop\x20`','customerIp','createdAt','📱\x20Created\x20new\x20Telegram\x20user:\x20','customerUa','sendCustomNotification','📝\x20Format:\x20`username\x20api_key`\x0a\x0a','\x20\x20\x20Status:\x20','amount','`\x20(','notificationLogin','orderId','remitterIban','startsWith','update','name','❌\x20Failed\x20to\x20send\x20notification\x20to\x20Telegram\x20user\x20','🆔\x20Payment\x20ID:\x20`','shopSettings','📅\x20Date:\x20','•\x20Payouts\x0a','🆔\x20Payout\x20ID:\x20`','Error\x20handling\x20/status\x20command:','\x20parts:\x20','sendLoginNotification','🤖\x20Welcome\x20to\x20TRAPAY\x20notification\x20system!\x0a\x0a','🏦\x20Method:\x20`','failed','method','Disconnect\x20the\x20previous\x20account\x20first\x20or\x20contact\x20administrator.','timestamp','💻\x20Browser:\x20`','•\x20Important\x20events\x0a\x0a','Error\x20handling\x20/debug\x20command:','error','📛\x20Name:\x20`','✅\x20You\x20have\x20been\x20successfully\x20connected\x20to\x20the\x20notification\x20system!\x0a\x0a','8jIxiKO','shopId','🚨\x20*API\x20Error*\x0a\x0a','\x20disconnected\x20from\x20shop\x20','Example:\x0a','includes','forEach','API\x20key\x20must\x20start\x20with\x20`pk\x5c_`\x20or\x20`sk\x5c_`.','isVerified','../types/gateway','Username:\x20`','customerEmail','⏳\x20The\x20payment\x20is\x20currently\x20being\x20processed\x20by\x20the\x20gateway.\x0a','📱\x20Telegram\x20notification:\x20gateway\x20\x22','onText','length','initializeBot','sendMessage','sendShopNotification','chargebackAmount','polling_error',':\x20username=\x22','29853nRsbzE','split','TELEGRAM_BOT_TOKEN','from','40tyaeKd','toString','findUnique','trim','last_name','📱\x20Shop:\x20*','/status\x20-\x20check\x20connection\x20status\x0a','warn','7543572JSIGvD','`appple\x20pk_aa6450d3f57afbefbb0f3f5be5ce6cca13037536afc5ccf14c81a6cbc7a07de5`\x0a\x0a','✅\x20API\x20error\x20notification\x20sent\x20for\x20shop\x20','🏪\x20Available\x20shops\x20in\x20system:\x0a','*\x0a\x0a','Markdown','trapay_bot','default','text'];a59_0x4f7b=function(){return _0x28956c;};return a59_0x4f7b();}function a59_0x52fb(_0x5ddd50,_0x243192){const _0x4f7bd3=a59_0x4f7b();return a59_0x52fb=function(_0x52fbc7,_0x2c246f){_0x52fbc7=_0x52fbc7-0x16e;let _0x251209=_0x4f7bd3[_0x52fbc7];return _0x251209;},a59_0x52fb(_0x5ddd50,_0x243192);}var __importDefault=this&&this[a59_0x40e192(0x204)]||function(_0x4d87bb){const _0x46914f=a59_0x40e192;return _0x4d87bb&&_0x4d87bb[_0x46914f(0x1bc)]?_0x4d87bb:{'default':_0x4d87bb};};Object['defineProperty'](exports,'__esModule',{'value':!![]}),exports['telegramBotService']=exports[a59_0x40e192(0x1c7)]=void 0x0;const node_telegram_bot_api_1=__importDefault(require('node-telegram-bot-api')),database_1=__importDefault(require(a59_0x40e192(0x1ba))),gateway_1=require(a59_0x40e192(0x23e));class TelegramBotService{constructor(){const _0x3b9f71=a59_0x40e192;this[_0x3b9f71(0x205)]=null,this[_0x3b9f71(0x193)]=process[_0x3b9f71(0x1cb)][_0x3b9f71(0x24d)]||'',this[_0x3b9f71(0x1d8)]=process[_0x3b9f71(0x1cb)][_0x3b9f71(0x203)]||_0x3b9f71(0x172),this[_0x3b9f71(0x193)]?this[_0x3b9f71(0x245)]():console['warn'](_0x3b9f71(0x1b7));}[a59_0x40e192(0x245)](){const _0x40bdd8=a59_0x40e192;try{this[_0x40bdd8(0x205)]=new node_telegram_bot_api_1[(_0x40bdd8(0x173))](this[_0x40bdd8(0x193)],{'polling':!![]}),this['setupBotHandlers'](),console[_0x40bdd8(0x1fd)](_0x40bdd8(0x1e3)+this[_0x40bdd8(0x1d8)]+_0x40bdd8(0x1da));}catch(_0x8ca0c0){console[_0x40bdd8(0x232)](_0x40bdd8(0x1d5),_0x8ca0c0);}}[a59_0x40e192(0x1fc)](){const _0x1757b2=a59_0x40e192;if(!this[_0x1757b2(0x205)])return;this['bot']['onText'](/\/start/,async _0x352680=>{const _0x1b7806=_0x1757b2,_0x123dad=_0x352680[_0x1b7806(0x1fe)]['id'],_0x33a159=_0x352680[_0x1b7806(0x24e)]?.['id'][_0x1b7806(0x250)](),_0x297f98=_0x352680[_0x1b7806(0x24e)]?.[_0x1b7806(0x196)],_0x1dc020=_0x352680[_0x1b7806(0x24e)]?.['first_name'],_0x423855=_0x352680[_0x1b7806(0x24e)]?.[_0x1b7806(0x253)];if(!_0x33a159)return;try{let _0xa2f6b7=await database_1[_0x1b7806(0x173)][_0x1b7806(0x179)][_0x1b7806(0x251)]({'where':{'telegramId':_0x33a159},'include':{'shop':!![]}});!_0xa2f6b7?(_0xa2f6b7=await database_1['default']['telegramUser'][_0x1b7806(0x189)]({'data':{'telegramId':_0x33a159,'username':_0x297f98,'firstName':_0x1dc020,'lastName':_0x423855,'isVerified':![],'shopId':null},'include':{'shop':!![]}}),console[_0x1b7806(0x1fd)](_0x1b7806(0x213)+_0x33a159+_0x1b7806(0x1f7)+_0x297f98+')')):_0xa2f6b7=await database_1[_0x1b7806(0x173)][_0x1b7806(0x179)][_0x1b7806(0x21e)]({'where':{'telegramId':_0x33a159},'data':{'username':_0x297f98,'firstName':_0x1dc020,'lastName':_0x423855},'include':{'shop':!![]}}),_0xa2f6b7['isVerified']&&_0xa2f6b7[_0x1b7806(0x236)]&&_0xa2f6b7[_0x1b7806(0x1a8)]?await this[_0x1b7806(0x205)]?.['sendMessage'](_0x123dad,_0x1b7806(0x17f)+(_0x1b7806(0x20e)+_0xa2f6b7[_0x1b7806(0x1a8)][_0x1b7806(0x21f)]+'*\x0a')+(_0x1b7806(0x23f)+_0xa2f6b7[_0x1b7806(0x1a8)][_0x1b7806(0x196)]+_0x1b7806(0x190))+_0x1b7806(0x201)+'•\x20New\x20payments\x0a'+_0x1b7806(0x195)+'•\x20Payouts\x0a\x0a'+_0x1b7806(0x1b3)+_0x1b7806(0x255)+_0x1b7806(0x181),{'parse_mode':'Markdown'}):(_0xa2f6b7[_0x1b7806(0x236)]&&!_0xa2f6b7['isVerified']&&(await database_1[_0x1b7806(0x173)][_0x1b7806(0x179)]['update']({'where':{'telegramId':_0x33a159},'data':{'shopId':null,'isVerified':![]}}),console[_0x1b7806(0x1fd)]('🔄\x20Reset\x20incomplete\x20verification\x20for\x20user\x20'+_0x33a159)),await this[_0x1b7806(0x205)]?.[_0x1b7806(0x246)](_0x123dad,_0x1b7806(0x229)+'To\x20receive\x20payment\x20notifications,\x20send\x20your\x20credentials\x20in\x20one\x20line:\x0a\x0a'+_0x1b7806(0x216)+_0x1b7806(0x239)+_0x1b7806(0x258)+'❗️\x20Make\x20sure\x20to\x20separate\x20username\x20and\x20API\x20key\x20with\x20a\x20space!',{'parse_mode':_0x1b7806(0x171)}));}catch(_0x18d76f){console['error'](_0x1b7806(0x1d0),_0x18d76f),await this['bot']?.[_0x1b7806(0x246)](_0x123dad,_0x1b7806(0x1ab));}}),this[_0x1757b2(0x205)]['onText'](/\/disconnect/,async _0xef554=>{const _0x2c377a=_0x1757b2,_0x26867f=_0xef554[_0x2c377a(0x1fe)]['id'],_0x21c866=_0xef554[_0x2c377a(0x24e)]?.['id'][_0x2c377a(0x250)]();if(!_0x21c866)return;try{const _0x1a0952=await database_1[_0x2c377a(0x173)][_0x2c377a(0x179)]['findUnique']({'where':{'telegramId':_0x21c866},'include':{'shop':!![]}});if(!_0x1a0952||!_0x1a0952['isVerified']||!_0x1a0952['shopId']){await this[_0x2c377a(0x205)]?.[_0x2c377a(0x246)](_0x26867f,_0x2c377a(0x176));return;}const _0x3ac6c5=_0x1a0952[_0x2c377a(0x1a8)]?.[_0x2c377a(0x21f)]||_0x2c377a(0x1a1);await database_1['default'][_0x2c377a(0x179)]['update']({'where':{'telegramId':_0x21c866},'data':{'shopId':null,'isVerified':![]}}),console[_0x2c377a(0x1fd)](_0x2c377a(0x19a)+_0x21c866+_0x2c377a(0x238)+_0x1a0952[_0x2c377a(0x236)]),await this[_0x2c377a(0x205)]?.[_0x2c377a(0x246)](_0x26867f,'✅\x20You\x20have\x20been\x20successfully\x20disconnected\x20from\x20shop\x20*'+_0x3ac6c5+_0x2c377a(0x1cd)+_0x2c377a(0x1f8),{'parse_mode':'Markdown'});}catch(_0x15bf5e){console[_0x2c377a(0x232)]('Error\x20handling\x20/disconnect\x20command:',_0x15bf5e),await this[_0x2c377a(0x205)]?.['sendMessage'](_0x26867f,'❌\x20An\x20error\x20occurred.\x20Please\x20try\x20again\x20later.');}}),this[_0x1757b2(0x205)]['onText'](/\/status/,async _0x1fe953=>{const _0x4a3db7=_0x1757b2,_0x54745d=_0x1fe953[_0x4a3db7(0x1fe)]['id'],_0x54bc72=_0x1fe953[_0x4a3db7(0x24e)]?.['id'][_0x4a3db7(0x250)]();if(!_0x54bc72)return;try{const _0x3a8de2=await database_1[_0x4a3db7(0x173)][_0x4a3db7(0x179)][_0x4a3db7(0x251)]({'where':{'telegramId':_0x54bc72},'include':{'shop':!![]}});if(!_0x3a8de2){await this['bot']?.[_0x4a3db7(0x246)](_0x54745d,_0x4a3db7(0x20b)+_0x4a3db7(0x1e5));return;}if(!_0x3a8de2['isVerified']||!_0x3a8de2['shopId']||!_0x3a8de2[_0x4a3db7(0x1a8)]){await this[_0x4a3db7(0x205)]?.['sendMessage'](_0x54745d,'❌\x20You\x20are\x20not\x20connected\x20to\x20a\x20shop.\x0a\x0a'+_0x4a3db7(0x1e0));return;}await this['bot']?.[_0x4a3db7(0x246)](_0x54745d,'📊\x20*Connection\x20Status*\x0a\x0a'+(_0x4a3db7(0x18b)+_0x3a8de2['shop'][_0x4a3db7(0x21f)]+'*\x0a')+('👤\x20Username:\x20`'+_0x3a8de2[_0x4a3db7(0x1a8)][_0x4a3db7(0x196)]+'`\x0a')+(_0x4a3db7(0x1b0)+_0x3a8de2['updatedAt']['toLocaleDateString'](_0x4a3db7(0x19f))+'\x0a\x0a')+_0x4a3db7(0x1e7)+_0x4a3db7(0x1b3)+_0x4a3db7(0x181),{'parse_mode':'Markdown'});}catch(_0x5405e5){console[_0x4a3db7(0x232)](_0x4a3db7(0x226),_0x5405e5),await this[_0x4a3db7(0x205)]?.['sendMessage'](_0x54745d,_0x4a3db7(0x1ab));}}),this[_0x1757b2(0x205)][_0x1757b2(0x243)](/\/debug/,async _0x1e7baf=>{const _0x158342=_0x1757b2,_0x376a32=_0x1e7baf[_0x158342(0x1fe)]['id'],_0x1124e5=_0x1e7baf[_0x158342(0x24e)]?.['id'][_0x158342(0x250)]();if(!_0x1124e5)return;try{const _0x4551d2=await database_1[_0x158342(0x173)][_0x158342(0x1a8)]['findMany']({'select':{'id':!![],'name':!![],'username':!![],'status':!![],'publicKey':!![]},'take':0xa});let _0x8551f9=_0x158342(0x1aa);_0x8551f9+=_0x158342(0x1bb)+_0x1124e5+_0x158342(0x190),_0x8551f9+=_0x158342(0x16f),_0x4551d2[_0x158342(0x23b)]((_0x4f331b,_0x159cc4)=>{const _0x167cf0=_0x158342;_0x8551f9+=_0x159cc4+0x1+_0x167cf0(0x198)+_0x4f331b[_0x167cf0(0x21f)]+'*\x0a',_0x8551f9+=_0x167cf0(0x1f9)+_0x4f331b[_0x167cf0(0x196)]+'`\x0a',_0x8551f9+=_0x167cf0(0x217)+_0x4f331b[_0x167cf0(0x191)]+'\x0a',_0x8551f9+=_0x167cf0(0x1c8)+_0x4f331b['publicKey'][_0x167cf0(0x202)](0x0,0xf)+_0x167cf0(0x1c5);}),await this[_0x158342(0x205)]?.[_0x158342(0x246)](_0x376a32,_0x8551f9,{'parse_mode':_0x158342(0x171)});}catch(_0x4669f9){console[_0x158342(0x232)](_0x158342(0x231),_0x4669f9),await this[_0x158342(0x205)]?.[_0x158342(0x246)](_0x376a32,_0x158342(0x18e));}}),this[_0x1757b2(0x205)]['on'](_0x1757b2(0x1a6),async _0x2960dd=>{const _0x836472=_0x1757b2;if(_0x2960dd['text']?.[_0x836472(0x21d)]('/'))return;const _0x33647c=_0x2960dd['chat']['id'],_0x235a94=_0x2960dd[_0x836472(0x24e)]?.['id'][_0x836472(0x250)](),_0x11dd74=_0x2960dd[_0x836472(0x174)]?.[_0x836472(0x252)]();if(!_0x235a94||!_0x11dd74)return;try{const _0x2b15b5=await database_1[_0x836472(0x173)]['telegramUser']['findUnique']({'where':{'telegramId':_0x235a94},'include':{'shop':!![]}});if(!_0x2b15b5){await this['bot']?.[_0x836472(0x246)](_0x33647c,_0x836472(0x18f));return;}if(_0x2b15b5[_0x836472(0x23d)]&&_0x2b15b5['shopId']&&_0x2b15b5[_0x836472(0x1a8)]){await this[_0x836472(0x205)]?.['sendMessage'](_0x33647c,_0x836472(0x200)+_0x2b15b5['shop'][_0x836472(0x21f)]+_0x836472(0x1cd)+_0x836472(0x1c6),{'parse_mode':_0x836472(0x171)});return;}const _0xef3355=_0x11dd74[_0x836472(0x24c)](/\s+/);if(_0xef3355[_0x836472(0x244)]!==0x2){await this['bot']?.['sendMessage'](_0x33647c,_0x836472(0x20c)+'📝\x20Format:\x20`username\x20api_key`\x0a\x0a'+_0x836472(0x239)+_0x836472(0x258)+(_0x836472(0x1dc)+_0xef3355[_0x836472(0x244)]+_0x836472(0x227)+_0xef3355[_0x836472(0x1a7)](_0x1ffda6=>'`'+_0x1ffda6+'`')['join'](',\x20')),{'parse_mode':'Markdown'});return;}const [_0x212c01,_0x4dc3d5]=_0xef3355;console[_0x836472(0x1fd)](_0x836472(0x17e)+_0x235a94+_0x836472(0x24a)+_0x212c01+_0x836472(0x1e8)+_0x4dc3d5[_0x836472(0x202)](0x0,0xa)+_0x836472(0x185)),await this[_0x836472(0x20f)](_0x33647c,_0x235a94,_0x212c01,_0x4dc3d5);}catch(_0x57d675){console[_0x836472(0x232)](_0x836472(0x1a4),_0x57d675),await this['bot']?.['sendMessage'](_0x33647c,'❌\x20An\x20error\x20occurred.\x20Please\x20try\x20again\x20later.');}}),this[_0x1757b2(0x205)]['on']('error',_0x4e2600=>{const _0x2001f8=_0x1757b2;console[_0x2001f8(0x232)](_0x2001f8(0x1cf),_0x4e2600);}),this[_0x1757b2(0x205)]['on'](_0x1757b2(0x249),_0x370119=>{const _0x521866=_0x1757b2;console[_0x521866(0x232)]('Telegram\x20bot\x20polling\x20error:',_0x370119);});}async[a59_0x40e192(0x20f)](_0x26d36c,_0x56a291,_0x1c5702,_0x340b84){const _0x5f1b26=a59_0x40e192;try{console[_0x5f1b26(0x1fd)](_0x5f1b26(0x17e)+_0x56a291+_0x5f1b26(0x24a)+_0x1c5702+_0x5f1b26(0x1e8)+_0x340b84[_0x5f1b26(0x202)](0x0,0xa)+_0x5f1b26(0x185));if(!_0x1c5702||_0x1c5702[_0x5f1b26(0x244)]<0x3||_0x1c5702['length']>0x32||!/^[a-zA-Z0-9_]+$/[_0x5f1b26(0x1a0)](_0x1c5702)){await this[_0x5f1b26(0x205)]?.[_0x5f1b26(0x246)](_0x26d36c,_0x5f1b26(0x1f2)+_0x1c5702+_0x5f1b26(0x190)+'Username\x20must\x20contain\x20only\x20letters,\x20numbers\x20and\x20underscore\x20(3-50\x20characters).',{'parse_mode':_0x5f1b26(0x171)});return;}if(!_0x340b84||!_0x340b84[_0x5f1b26(0x21d)](_0x5f1b26(0x1de))&&!_0x340b84[_0x5f1b26(0x21d)](_0x5f1b26(0x1b8))){await this[_0x5f1b26(0x205)]?.[_0x5f1b26(0x246)](_0x26d36c,_0x5f1b26(0x1f0)+_0x5f1b26(0x23c),{'parse_mode':_0x5f1b26(0x171)});return;}const _0x3383ec=await database_1[_0x5f1b26(0x173)]['shop'][_0x5f1b26(0x251)]({'where':{'username':_0x1c5702},'select':{'id':!![],'name':!![],'username':!![],'status':!![],'publicKey':!![],'secretKey':!![]}});if(!_0x3383ec){const _0x317e88=await database_1['default']['shop']['findMany']({'select':{'username':!![],'name':!![]},'take':0x5});let _0x333a73=_0x5f1b26(0x17d)+_0x1c5702+'`\x20not\x20found.\x0a\x0a';_0x317e88[_0x5f1b26(0x244)]>0x0?(_0x333a73+=_0x5f1b26(0x1f5),_0x317e88['forEach'](_0x553bd7=>{const _0x222d3=_0x5f1b26;_0x333a73+=_0x222d3(0x1b4)+_0x553bd7[_0x222d3(0x196)]+_0x222d3(0x219)+_0x553bd7[_0x222d3(0x21f)]+')\x0a';}),_0x333a73+=_0x5f1b26(0x1a2)):_0x333a73+=_0x5f1b26(0x18a);await this['bot']?.['sendMessage'](_0x26d36c,_0x333a73,{'parse_mode':_0x5f1b26(0x171)});return;}if(_0x3383ec[_0x5f1b26(0x191)]!=='ACTIVE'){await this[_0x5f1b26(0x205)]?.[_0x5f1b26(0x246)](_0x26d36c,'❌\x20Shop\x20`'+_0x1c5702+_0x5f1b26(0x1d7)+_0x5f1b26(0x1d6),{'parse_mode':_0x5f1b26(0x171)});return;}if(_0x3383ec[_0x5f1b26(0x1b6)]!==_0x340b84&&_0x3383ec[_0x5f1b26(0x1cc)]!==_0x340b84){await this['bot']?.['sendMessage'](_0x26d36c,_0x5f1b26(0x210)+_0x1c5702+'`.\x0a\x0a'+'Check\x20the\x20key\x20and\x20try\x20again.\x0a\x0a'+'Expected\x20key\x20format:\x20`pk_...`\x20or\x20`sk_...`',{'parse_mode':_0x5f1b26(0x171)});return;}const _0x25ea7d=await database_1[_0x5f1b26(0x173)][_0x5f1b26(0x179)][_0x5f1b26(0x1e9)]({'where':{'shopId':_0x3383ec['id'],'isVerified':!![],'telegramId':{'not':_0x56a291}}});if(_0x25ea7d){await this[_0x5f1b26(0x205)]?.[_0x5f1b26(0x246)](_0x26d36c,_0x5f1b26(0x19d)+_0x1c5702+'`.\x0a\x0a'+_0x5f1b26(0x22d),{'parse_mode':_0x5f1b26(0x171)});return;}await database_1['default']['telegramUser']['update']({'where':{'telegramId':_0x56a291},'data':{'shopId':_0x3383ec['id'],'isVerified':!![]}}),await this[_0x5f1b26(0x205)]?.[_0x5f1b26(0x246)](_0x26d36c,_0x5f1b26(0x1ec)+_0x5f1b26(0x234)+(_0x5f1b26(0x254)+_0x3383ec['name']+'*\x0a')+('👤\x20Username:\x20`'+_0x3383ec['username']+_0x5f1b26(0x190))+_0x5f1b26(0x19e)+_0x5f1b26(0x1b2)+'•\x20Payment\x20status\x20changes\x0a'+_0x5f1b26(0x224)+_0x5f1b26(0x230)+_0x5f1b26(0x1b3)+_0x5f1b26(0x255)+_0x5f1b26(0x181),{'parse_mode':_0x5f1b26(0x171)}),console[_0x5f1b26(0x1fd)]('✅\x20Telegram\x20user\x20'+_0x56a291+'\x20verified\x20for\x20shop\x20'+_0x3383ec['username']+_0x5f1b26(0x1b9));}catch(_0x1d2c55){console['error'](_0x5f1b26(0x1c4),_0x1d2c55),await this[_0x5f1b26(0x205)]?.['sendMessage'](_0x26d36c,_0x5f1b26(0x175));}}async[a59_0x40e192(0x247)](_0x553c87,_0x23fc5e,_0x53a5aa){const _0x1bf66c=a59_0x40e192;if(!this[_0x1bf66c(0x205)]){console[_0x1bf66c(0x256)]('Telegram\x20bot\x20not\x20initialized,\x20cannot\x20send\x20notification');return;}try{const _0x4a6ffe=await database_1[_0x1bf66c(0x173)][_0x1bf66c(0x179)][_0x1bf66c(0x1b1)]({'where':{'shopId':_0x553c87,'isVerified':!![]}});if(_0x4a6ffe[_0x1bf66c(0x244)]===0x0){console['log'](_0x1bf66c(0x19c)+_0x553c87);return;}const _0x4202c3=_0x4a6ffe['map'](async _0x81124c=>{const _0x4456d7=_0x1bf66c;try{await this[_0x4456d7(0x205)]?.[_0x4456d7(0x246)](_0x81124c[_0x4456d7(0x1ca)],_0x23fc5e,_0x53a5aa),console[_0x4456d7(0x1fd)](_0x4456d7(0x1df)+_0x81124c[_0x4456d7(0x1ca)]);}catch(_0x1781ad){console['error'](_0x4456d7(0x220)+_0x81124c[_0x4456d7(0x1ca)]+':',_0x1781ad),_0x1781ad instanceof Error&&(_0x1781ad[_0x4456d7(0x1a6)][_0x4456d7(0x23a)](_0x4456d7(0x182))||_0x1781ad[_0x4456d7(0x1a6)][_0x4456d7(0x23a)](_0x4456d7(0x1c9))||_0x1781ad[_0x4456d7(0x1a6)]['includes'](_0x4456d7(0x1ac)))&&(await database_1[_0x4456d7(0x173)][_0x4456d7(0x179)][_0x4456d7(0x21e)]({'where':{'id':_0x81124c['id']},'data':{'isVerified':![]}}),console['log'](_0x4456d7(0x192)+_0x81124c['telegramId']+'\x20marked\x20as\x20unverified\x20due\x20to\x20delivery\x20failure'));}});await Promise[_0x1bf66c(0x194)](_0x4202c3);}catch(_0x1135f8){console[_0x1bf66c(0x232)](_0x1bf66c(0x1bd),_0x1135f8);}}async[a59_0x40e192(0x19b)](_0x4630b9,_0x4d9cfa,_0x79915d){const _0x2ba105=a59_0x40e192,_0x5db980={'created':'🆕','paid':'✅','failed':'❌','expired':'⏰','refund':'🔄','chargeback':'⚠️','processing':'⚙️'},_0x3f2675={'created':_0x2ba105(0x186),'paid':_0x2ba105(0x1ae),'failed':_0x2ba105(0x1ed),'expired':_0x2ba105(0x1eb),'refund':_0x2ba105(0x1c1),'chargeback':_0x2ba105(0x187),'processing':'Payment\x20is\x20being\x20processed'},_0x3a0345=_0x5db980[_0x79915d],_0x44c4b1=_0x3f2675[_0x79915d],_0x3ba6b0=(0x0,gateway_1['getGatewayDisplayNameForTelegram'])(_0x4d9cfa[_0x2ba105(0x183)]);console[_0x2ba105(0x1fd)](_0x2ba105(0x242)+_0x4d9cfa[_0x2ba105(0x183)]+_0x2ba105(0x1ff)+_0x3ba6b0+'\x22');let _0x1488e8=_0x3a0345+'\x20*'+_0x44c4b1+'*\x0a\x0a'+(_0x2ba105(0x1be)+_0x4d9cfa['amount']+'\x20'+_0x4d9cfa['currency']+'*\x0a')+('📝\x20Order\x20ID:\x20`'+(_0x4d9cfa[_0x2ba105(0x21b)]||_0x4d9cfa['id'])+'`\x0a')+(_0x2ba105(0x221)+_0x4d9cfa['id']+'`\x0a')+(_0x2ba105(0x1c3)+_0x3ba6b0+'`\x0a')+('📅\x20Date:\x20'+new Date(_0x4d9cfa['createdAt'])[_0x2ba105(0x1ea)](_0x2ba105(0x19f))+'\x0a');if(_0x4d9cfa['customerName']||_0x4d9cfa[_0x2ba105(0x240)]||_0x4d9cfa[_0x2ba105(0x21c)]||_0x4d9cfa['customerIp']||_0x4d9cfa[_0x2ba105(0x214)]){_0x1488e8+='\x0a👤\x20*Customer\x20Information:*\x0a';_0x4d9cfa[_0x2ba105(0x1fa)]&&(_0x1488e8+=_0x2ba105(0x233)+_0x4d9cfa['customerName']+'`\x0a');_0x4d9cfa[_0x2ba105(0x240)]&&(_0x1488e8+=_0x2ba105(0x1f3)+_0x4d9cfa['customerEmail']+'`\x0a');_0x4d9cfa[_0x2ba105(0x21c)]&&(_0x1488e8+='🏦\x20IBAN:\x20`'+_0x4d9cfa['remitterIban']+'`\x0a');_0x4d9cfa[_0x2ba105(0x211)]&&(_0x1488e8+=_0x2ba105(0x206)+_0x4d9cfa[_0x2ba105(0x211)]+'`\x0a');if(_0x4d9cfa[_0x2ba105(0x214)]){const _0x5223cb=_0x4d9cfa[_0x2ba105(0x214)][_0x2ba105(0x244)]>0x32?_0x4d9cfa[_0x2ba105(0x214)][_0x2ba105(0x202)](0x0,0x32)+'...':_0x4d9cfa[_0x2ba105(0x214)];_0x1488e8+=_0x2ba105(0x22f)+_0x5223cb+'`\x0a';}}_0x79915d===_0x2ba105(0x188)&&_0x4d9cfa[_0x2ba105(0x248)]&&(_0x1488e8+=_0x2ba105(0x180)+_0x4d9cfa[_0x2ba105(0x248)]+_0x2ba105(0x1bf)),_0x79915d===_0x2ba105(0x1f4)&&(_0x1488e8+=_0x2ba105(0x241)),_0x4d9cfa['adminNotes']&&(_0x1488e8+=_0x2ba105(0x178)+_0x4d9cfa[_0x2ba105(0x1fb)]+'\x0a'),await this['sendShopNotification'](_0x4630b9,_0x1488e8,{'parse_mode':_0x2ba105(0x171)});}async[a59_0x40e192(0x1af)](_0x5def9e,_0x13b92b,_0x45c60b){const _0x3db52e=a59_0x40e192,_0xce08ca={'created':'📤','completed':'✅','rejected':'❌'},_0x28f85f={'created':_0x3db52e(0x208),'completed':_0x3db52e(0x1dd),'rejected':'Payout\x20rejected'},_0x3f3514=_0xce08ca[_0x45c60b],_0x4078ef=_0x28f85f[_0x45c60b],_0x15965f=_0x3f3514+'\x20*'+_0x4078ef+'*\x0a\x0a'+('💸\x20Amount:\x20*'+_0x13b92b[_0x3db52e(0x218)]+_0x3db52e(0x20d))+(_0x3db52e(0x22a)+_0x13b92b[_0x3db52e(0x22c)]+'`\x0a')+(_0x3db52e(0x225)+_0x13b92b['id']+'`\x0a')+(_0x3db52e(0x223)+new Date(_0x13b92b[_0x3db52e(0x212)])[_0x3db52e(0x1ea)](_0x3db52e(0x19f))+'\x0a')+(_0x13b92b[_0x3db52e(0x1ce)]?_0x3db52e(0x17a)+_0x13b92b[_0x3db52e(0x1ce)]+'`':'');await this[_0x3db52e(0x247)](_0x5def9e,_0x15965f,{'parse_mode':'Markdown'});}async[a59_0x40e192(0x228)](_0x4c3177,_0x199001){const _0x478548=a59_0x40e192;try{const _0x3de15e=await database_1[_0x478548(0x173)][_0x478548(0x222)][_0x478548(0x251)]({'where':{'shopId':_0x4c3177},'select':{'notificationLogin':!![]}});if(!_0x3de15e?.[_0x478548(0x21a)]){console[_0x478548(0x1fd)](_0x478548(0x1e2)+_0x4c3177);return;}const _0x47a331=_0x199001[_0x478548(0x177)]?'🔐':'🚨',_0xf22ee=_0x199001[_0x478548(0x177)]?_0x478548(0x1d9):'Failed\x20login\x20attempt';let _0x160753=_0x47a331+'\x20*'+_0xf22ee+'*\x0a\x0a'+(_0x478548(0x1f6)+_0x199001[_0x478548(0x196)]+'`\x0a')+(_0x478548(0x18d)+_0x199001['timestamp'][_0x478548(0x1ea)](_0x478548(0x19f))+'\x0a');_0x199001[_0x478548(0x1db)]&&(_0x160753+=_0x478548(0x197)+_0x199001[_0x478548(0x1db)]+'`\x0a');if(_0x199001[_0x478548(0x1a3)]){const _0x353c5e=_0x199001[_0x478548(0x1a3)]['length']>0x32?_0x199001[_0x478548(0x1a3)][_0x478548(0x202)](0x0,0x32)+'...':_0x199001[_0x478548(0x1a3)];_0x160753+=_0x478548(0x22f)+_0x353c5e+'`\x0a';}!_0x199001[_0x478548(0x177)]&&(_0x160753+=_0x478548(0x1b5)),await this[_0x478548(0x247)](_0x4c3177,_0x160753,{'parse_mode':_0x478548(0x171)}),console[_0x478548(0x1fd)]('✅\x20Login\x20notification\x20sent\x20for\x20shop\x20'+_0x4c3177+':\x20'+(_0x199001['success']?_0x478548(0x177):_0x478548(0x22b)));}catch(_0x3548ef){console['error'](_0x478548(0x18c),_0x3548ef);}}async['sendApiErrorNotification'](_0x501f25,_0x2f2f3d){const _0x11160b=a59_0x40e192;try{const _0xcc0bd4=await database_1['default'][_0x11160b(0x222)]['findUnique']({'where':{'shopId':_0x501f25},'select':{'notificationApiError':!![]}});if(!_0xcc0bd4?.['notificationApiError']){console[_0x11160b(0x1fd)](_0x11160b(0x1ad)+_0x501f25);return;}let _0xa53a5c=_0x11160b(0x237)+(_0x11160b(0x1c0)+_0x2f2f3d[_0x11160b(0x22c)]+'\x20'+_0x2f2f3d['endpoint']+'`\x0a')+(_0x11160b(0x18d)+_0x2f2f3d[_0x11160b(0x22e)][_0x11160b(0x1ea)]('en-US')+'\x0a');_0x2f2f3d[_0x11160b(0x209)]&&(_0xa53a5c+=_0x11160b(0x1d2)+_0x2f2f3d[_0x11160b(0x209)]+'`\x0a'),_0xa53a5c+='❌\x20Error:\x20`'+_0x2f2f3d[_0x11160b(0x184)]+'`\x0a',_0x2f2f3d[_0x11160b(0x1e1)]&&(_0xa53a5c+=_0x11160b(0x17b)+_0x2f2f3d['requestId']+'`\x0a'),_0xa53a5c+='\x0a💡\x20Check\x20your\x20request\x20or\x20contact\x20support.',await this[_0x11160b(0x247)](_0x501f25,_0xa53a5c,{'parse_mode':_0x11160b(0x171)}),console[_0x11160b(0x1fd)](_0x11160b(0x16e)+_0x501f25+':\x20'+_0x2f2f3d[_0x11160b(0x1d1)]);}catch(_0x584d43){console[_0x11160b(0x232)](_0x11160b(0x1ee),_0x584d43);}}async[a59_0x40e192(0x215)](_0x4c5cd6,_0x27da8d,_0x5a7180){const _0x1fb852=a59_0x40e192;let _0x309849=_0x1fb852(0x20a)+_0x27da8d+_0x1fb852(0x170);for(const [_0x207a85,_0x3bb281]of Object[_0x1fb852(0x207)](_0x5a7180)){_0x3bb281!==null&&_0x3bb281!==undefined&&(_0x309849+=_0x207a85+_0x1fb852(0x1c2)+_0x3bb281+'`\x0a');}await this[_0x1fb852(0x247)](_0x4c5cd6,_0x309849,{'parse_mode':'Markdown'});}[a59_0x40e192(0x1e4)](){const _0x5ac240=a59_0x40e192;return{'isActive':!!this[_0x5ac240(0x205)],'username':this['botUsername']};}[a59_0x40e192(0x1ef)](){const _0x539fd3=a59_0x40e192;this[_0x539fd3(0x205)]&&(this[_0x539fd3(0x205)]['stopPolling'](),this['bot']=null,console[_0x539fd3(0x1fd)]('🛑\x20Telegram\x20bot\x20stopped'));}}exports[a59_0x40e192(0x1c7)]=TelegramBotService,exports[a59_0x40e192(0x1e6)]=new TelegramBotService();