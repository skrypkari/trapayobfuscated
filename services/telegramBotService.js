'use strict';const a52_0x54d1dc=a52_0xf317;(function(_0x319eaf,_0x1a54cb){const _0x33eecb=a52_0xf317,_0x4bedfb=_0x319eaf();while(!![]){try{const _0x4dd08e=-parseInt(_0x33eecb(0x139))/0x1*(-parseInt(_0x33eecb(0x15c))/0x2)+-parseInt(_0x33eecb(0x196))/0x3+parseInt(_0x33eecb(0x128))/0x4+parseInt(_0x33eecb(0x19b))/0x5*(-parseInt(_0x33eecb(0x114))/0x6)+-parseInt(_0x33eecb(0x1ab))/0x7*(parseInt(_0x33eecb(0x1a7))/0x8)+-parseInt(_0x33eecb(0x1cc))/0x9*(-parseInt(_0x33eecb(0x195))/0xa)+-parseInt(_0x33eecb(0x14d))/0xb*(-parseInt(_0x33eecb(0xf4))/0xc);if(_0x4dd08e===_0x1a54cb)break;else _0x4bedfb['push'](_0x4bedfb['shift']());}catch(_0x16a1ba){_0x4bedfb['push'](_0x4bedfb['shift']());}}}(a52_0x1ba5,0x5d103));function a52_0x1ba5(){const _0x53dbbd=['username','3960RTnbCa','shop','\x20via\x20single-line\x20input','sendApiErrorNotification','ACTIVE','join','❌\x20Invalid\x20API\x20key\x20format.\x0a\x0a','`.\x0a\x0a','chat\x20not\x20found','findMany','🔔\x20You\x20receive\x20notifications\x20about:\x0a','createdAt','../config/database','chargebackAmount','text','update','❌\x20Error:\x20`','\x20(@','error','from','ipAddress','You\x20are\x20already\x20connected\x20to\x20shop:\x20*','sendCustomNotification','✅\x20You\x20have\x20been\x20successfully\x20disconnected\x20from\x20shop\x20*','toLocaleDateString','✅\x20Notification\x20sent\x20to\x20Telegram\x20user\x20','📊\x20*Connection\x20Status*\x0a\x0a','statusCode','\x0a⚠️\x20If\x20this\x20wasn\x27t\x20you,\x20change\x20your\x20password\x20immediately!','📱\x20Created\x20new\x20Telegram\x20user:\x20','✅\x20Connected\x20to\x20shop:\x20*','❌\x20Please\x20use\x20/start\x20command\x20first','26802WwnzAu','map','setupBotHandlers','📱\x20Login\x20notifications\x20disabled\x20for\x20shop\x20','stopPolling','Disconnect\x20the\x20previous\x20account\x20first\x20or\x20contact\x20administrator.','New\x20payment\x20created','telegramUser','🔗\x20TXID:\x20`','sendLoginNotification','findFirst','\x0a👤\x20*Customer\x20Information:*\x0a','❌\x20Failed\x20to\x20send\x20notification\x20to\x20Telegram\x20user\x20','message','•\x20Payouts\x0a',':\x20username=\x22','TELEGRAM_BOT_TOKEN','\x22,\x20apiKey=\x22','\x20\x20\x20Username:\x20`','Payout\x20completed','281960apUNqo','defineProperty','🔄\x20Reset\x20incomplete\x20verification\x20for\x20user\x20','`\x20is\x20inactive.\x0a\x0a','Failed\x20login\x20attempt','TelegramBotService','To\x20receive\x20payment\x20notifications,\x20send\x20your\x20credentials\x20in\x20one\x20line:\x0a\x0a','Username\x20must\x20contain\x20only\x20letters,\x20numbers\x20and\x20underscore\x20(3-50\x20characters).','...\x22','endpoint','txid','🔍\x20*Debug\x20Information*\x0a\x0a','first_name','startsWith','customerEmail','•\x20New\x20payments\x0a','Error\x20sending\x20shop\x20notification:','8TtqoIq','sendMessage','\x20verified\x20for\x20shop\x20','method','No\x20verified\x20Telegram\x20users\x20found\x20for\x20shop\x20','Check\x20spelling\x20and\x20try\x20again.','❌\x20An\x20error\x20occurred.\x20Please\x20try\x20again\x20later.','New\x20payout\x20created','✅\x20Login\x20notification\x20sent\x20for\x20shop\x20','env','requestId','Commands:\x0a','🔔\x20Notifications\x20are\x20active\x0a\x0a','sk_','🤖\x20Welcome\x20to\x20TRAPAY\x20notification\x20system!\x0a\x0a','initializeBot','bot','❌\x20Error\x20getting\x20debug\x20information.','entries','🔄\x20Processing\x20single-line\x20verification\x20for\x20user\x20','10967mwkiUy','findUnique','\x0aCheck\x20spelling\x20and\x20try\x20again.','Use\x20/status\x20to\x20check\x20status\x20or\x20/disconnect\x20to\x20disconnect.','failed','TELEGRAM_BOT_USERNAME','success','💰\x20Amount:\x20*','✅\x20Welcome\x20back!\x0a\x0a','✅\x20API\x20error\x20notification\x20sent\x20for\x20shop\x20','*.\x0a\x0a','\x22\x20->\x20display\x20\x22','❌\x20You\x20are\x20not\x20registered\x20in\x20the\x20system.\x0a\x0a','stopBot','warn','64882bCxKle','allSettled','📅\x20Connection\x20date:\x20','🎉\x20*Congratulations!*\x0a\x0a','\x20disconnected\x20from\x20shop\x20','telegramId',':\x20`','/status\x20-\x20check\x20connection\x20status\x0a','Payment\x20is\x20being\x20processed','❌\x20You\x20are\x20not\x20connected\x20to\x20a\x20shop.\x0a\x0a','Expected\x20key\x20format:\x20`pk_...`\x20or\x20`sk_...`','timestamp','🆔\x20Payout\x20ID:\x20`','...`\x0a\x0a','botUsername','Error\x20handling\x20/status\x20command:','🔌\x20User\x20','Markdown','isVerified','userAgent','Payment\x20chargeback','getBotInfo','sendShopNotification','handleSingleLineVerification','🔔\x20You\x20will\x20now\x20receive\x20notifications\x20about:\x0a','user\x20is\x20deactivated','✅\x20Telegram\x20user\x20','📛\x20Name:\x20`','\x20USD*\x0a','default','❗️\x20Make\x20sure\x20to\x20separate\x20username\x20and\x20API\x20key\x20with\x20a\x20space!','log','📅\x20Time:\x20','sendPaymentNotification','botToken','*\x0a\x0a','🏪\x20Gateway:\x20`','...','📱\x20Your\x20Telegram\x20ID:\x20`','📅\x20Date:\x20','🔔\x20*','Available\x20usernames:\x0a','🚨\x20*API\x20Error*\x0a\x0a','🏦\x20Method:\x20`','👤\x20Username:\x20`','Error\x20in\x20handleSingleLineVerification:','customerName','Payment\x20failed','substring','\x0a💡\x20Check\x20your\x20request\x20or\x20contact\x20support.','telegramBotService','💸\x20Penalty\x20amount:\x20*','currency','forEach','Payout\x20rejected','includes','\x20marked\x20as\x20unverified\x20due\x20to\x20delivery\x20failure','3893210jgCmmn','1194267DaBlRH','🏪\x20Available\x20shops\x20in\x20system:\x0a','orderId','shopId','secretKey','15KFgokp','toString','notificationLogin','🛑\x20Telegram\x20bot\x20stopped','`appple\x20pk_aa6450d3f57afbefbb0f3f5be5ce6cca13037536afc5ccf14c81a6cbc7a07de5`\x0a\x0a','name','❌\x20Invalid\x20username\x20format:\x20`','❌\x20Shop\x20with\x20username\x20`','/disconnect\x20-\x20disconnect\x20from\x20notifications','✅\x20You\x20are\x20already\x20connected\x20to\x20shop\x20*','shopSettings','gateway','8VGBGYw','node-telegram-bot-api','adminNotes','\x20\x20\x20Status:\x20','1789704mwvfjL','chat','Telegram\x20bot\x20not\x20initialized,\x20cannot\x20send\x20notification','🆔\x20Request\x20ID:\x20`','Check\x20the\x20key\x20and\x20try\x20again.\x0a\x0a','__importDefault','status','../types/gateway','Example:\x0a','Error\x20handling\x20/start\x20command:','TELEGRAM_BOT_TOKEN\x20not\x20found\x20in\x20environment\x20variables','en-US','Telegram\x20bot\x20error:','onText','📝\x20Notes:\x20','toLocaleString','`\x0a\x0a','⏳\x20The\x20payment\x20is\x20currently\x20being\x20processed\x20by\x20the\x20gateway.\x0a','amount','create','API\x20key\x20must\x20start\x20with\x20`pk\x5c_`\x20or\x20`sk\x5c_`.','pk_','trapay_bot','\x20parts:\x20','❌\x20Invalid\x20format.\x20Please\x20send\x20exactly\x202\x20parts\x20separated\x20by\x20space:\x0a\x0a','🌐\x20IP\x20address:\x20`','updatedAt','❌\x20API\x20key\x20does\x20not\x20match\x20shop\x20`','\x20USDT*\x0a','💸\x20Amount:\x20*','length','__esModule','•\x20Payment\x20status\x20changes\x0a','9XYnfzo','•\x20Payouts\x0a\x0a','getGatewayDisplayNameForTelegram','sendPayoutNotification'];a52_0x1ba5=function(){return _0x53dbbd;};return a52_0x1ba5();}function a52_0xf317(_0x22161e,_0x27fc32){const _0x1ba5b5=a52_0x1ba5();return a52_0xf317=function(_0xf3170b,_0x3bfcfd){_0xf3170b=_0xf3170b-0xf0;let _0x13cbc3=_0x1ba5b5[_0xf3170b];return _0x13cbc3;},a52_0xf317(_0x22161e,_0x27fc32);}var __importDefault=this&&this[a52_0x54d1dc(0x1b0)]||function(_0x2a8829){const _0x250046=a52_0x54d1dc;return _0x2a8829&&_0x2a8829[_0x250046(0x1ca)]?_0x2a8829:{'default':_0x2a8829};};Object[a52_0x54d1dc(0x129)](exports,a52_0x54d1dc(0x1ca),{'value':!![]}),exports['telegramBotService']=exports[a52_0x54d1dc(0x12d)]=void 0x0;const node_telegram_bot_api_1=__importDefault(require(a52_0x54d1dc(0x1a8))),database_1=__importDefault(require(a52_0x54d1dc(0x100))),gateway_1=require(a52_0x54d1dc(0x1b2));class TelegramBotService{constructor(){const _0xc0084d=a52_0x54d1dc;this[_0xc0084d(0x149)]=null,this[_0xc0084d(0x17e)]=process[_0xc0084d(0x142)][_0xc0084d(0x124)]||'',this[_0xc0084d(0x16a)]=process[_0xc0084d(0x142)][_0xc0084d(0x152)]||_0xc0084d(0x1c1),this[_0xc0084d(0x17e)]?this[_0xc0084d(0x148)]():console[_0xc0084d(0x15b)](_0xc0084d(0x1b5));}[a52_0x54d1dc(0x148)](){const _0x30c877=a52_0x54d1dc;try{this[_0x30c877(0x149)]=new node_telegram_bot_api_1['default'](this[_0x30c877(0x17e)],{'polling':!![]}),this[_0x30c877(0x116)](),console[_0x30c877(0x17b)]('✅\x20Telegram\x20bot\x20@'+this[_0x30c877(0x16a)]+'\x20initialized\x20successfully');}catch(_0x4c7951){console['error']('❌\x20Failed\x20to\x20initialize\x20Telegram\x20bot:',_0x4c7951);}}[a52_0x54d1dc(0x116)](){const _0x3dab9f=a52_0x54d1dc;if(!this[_0x3dab9f(0x149)])return;this[_0x3dab9f(0x149)][_0x3dab9f(0x1b8)](/\/start/,async _0x831279=>{const _0x50fdbc=_0x3dab9f,_0x54606c=_0x831279[_0x50fdbc(0x1ac)]['id'],_0x5cb83a=_0x831279[_0x50fdbc(0x107)]?.['id'][_0x50fdbc(0x19c)](),_0x2b5ba8=_0x831279[_0x50fdbc(0x107)]?.['username'],_0x20f2bd=_0x831279[_0x50fdbc(0x107)]?.[_0x50fdbc(0x134)],_0x58e95b=_0x831279[_0x50fdbc(0x107)]?.['last_name'];if(!_0x5cb83a)return;try{let _0x3780d5=await database_1[_0x50fdbc(0x179)]['telegramUser'][_0x50fdbc(0x14e)]({'where':{'telegramId':_0x5cb83a},'include':{'shop':!![]}});!_0x3780d5?(_0x3780d5=await database_1[_0x50fdbc(0x179)][_0x50fdbc(0x11b)][_0x50fdbc(0x1be)]({'data':{'telegramId':_0x5cb83a,'username':_0x2b5ba8,'firstName':_0x20f2bd,'lastName':_0x58e95b,'isVerified':![],'shopId':null},'include':{'shop':!![]}}),console[_0x50fdbc(0x17b)](_0x50fdbc(0x111)+_0x5cb83a+_0x50fdbc(0x105)+_0x2b5ba8+')')):_0x3780d5=await database_1['default'][_0x50fdbc(0x11b)]['update']({'where':{'telegramId':_0x5cb83a},'data':{'username':_0x2b5ba8,'firstName':_0x20f2bd,'lastName':_0x58e95b},'include':{'shop':!![]}}),_0x3780d5[_0x50fdbc(0x16e)]&&_0x3780d5[_0x50fdbc(0x199)]&&_0x3780d5[_0x50fdbc(0xf5)]?await this[_0x50fdbc(0x149)]?.['sendMessage'](_0x54606c,_0x50fdbc(0x155)+(_0x50fdbc(0x109)+_0x3780d5[_0x50fdbc(0xf5)][_0x50fdbc(0x1a0)]+'*\x0a')+('Username:\x20`'+_0x3780d5[_0x50fdbc(0xf5)]['username']+_0x50fdbc(0x1bb))+_0x50fdbc(0xfe)+_0x50fdbc(0x137)+_0x50fdbc(0x1cb)+_0x50fdbc(0xf0)+_0x50fdbc(0x144)+_0x50fdbc(0x163)+_0x50fdbc(0x1a3),{'parse_mode':_0x50fdbc(0x16d)}):(_0x3780d5['shopId']&&!_0x3780d5[_0x50fdbc(0x16e)]&&(await database_1[_0x50fdbc(0x179)][_0x50fdbc(0x11b)][_0x50fdbc(0x103)]({'where':{'telegramId':_0x5cb83a},'data':{'shopId':null,'isVerified':![]}}),console[_0x50fdbc(0x17b)](_0x50fdbc(0x12a)+_0x5cb83a)),await this[_0x50fdbc(0x149)]?.['sendMessage'](_0x54606c,_0x50fdbc(0x147)+_0x50fdbc(0x12e)+'📝\x20Format:\x20`username\x20api_key`\x0a\x0a'+'Example:\x0a'+_0x50fdbc(0x19f)+_0x50fdbc(0x17a),{'parse_mode':_0x50fdbc(0x16d)}));}catch(_0x401df0){console[_0x50fdbc(0x106)](_0x50fdbc(0x1b4),_0x401df0),await this[_0x50fdbc(0x149)]?.[_0x50fdbc(0x13a)](_0x54606c,_0x50fdbc(0x13f));}}),this[_0x3dab9f(0x149)][_0x3dab9f(0x1b8)](/\/disconnect/,async _0x1c22ad=>{const _0x50e186=_0x3dab9f,_0x47ce87=_0x1c22ad[_0x50e186(0x1ac)]['id'],_0x50296c=_0x1c22ad[_0x50e186(0x107)]?.['id'][_0x50e186(0x19c)]();if(!_0x50296c)return;try{const _0x2c6bf7=await database_1[_0x50e186(0x179)][_0x50e186(0x11b)][_0x50e186(0x14e)]({'where':{'telegramId':_0x50296c},'include':{'shop':!![]}});if(!_0x2c6bf7||!_0x2c6bf7['isVerified']||!_0x2c6bf7[_0x50e186(0x199)]){await this[_0x50e186(0x149)]?.[_0x50e186(0x13a)](_0x47ce87,'❌\x20You\x20are\x20not\x20connected\x20to\x20the\x20notification\x20system.');return;}const _0x7e7811=_0x2c6bf7['shop']?.[_0x50e186(0x1a0)]||'unknown\x20shop';await database_1[_0x50e186(0x179)][_0x50e186(0x11b)]['update']({'where':{'telegramId':_0x50296c},'data':{'shopId':null,'isVerified':![]}}),console[_0x50e186(0x17b)](_0x50e186(0x16c)+_0x50296c+_0x50e186(0x160)+_0x2c6bf7[_0x50e186(0x199)]),await this[_0x50e186(0x149)]?.['sendMessage'](_0x47ce87,_0x50e186(0x10b)+_0x7e7811+_0x50e186(0x157)+'To\x20reconnect,\x20use\x20the\x20/start\x20command',{'parse_mode':_0x50e186(0x16d)});}catch(_0x398e66){console[_0x50e186(0x106)]('Error\x20handling\x20/disconnect\x20command:',_0x398e66),await this['bot']?.[_0x50e186(0x13a)](_0x47ce87,_0x50e186(0x13f));}}),this['bot'][_0x3dab9f(0x1b8)](/\/status/,async _0x75e4a=>{const _0x8ca134=_0x3dab9f,_0x19964e=_0x75e4a['chat']['id'],_0x1ed284=_0x75e4a['from']?.['id']['toString']();if(!_0x1ed284)return;try{const _0x1afe3f=await database_1[_0x8ca134(0x179)][_0x8ca134(0x11b)][_0x8ca134(0x14e)]({'where':{'telegramId':_0x1ed284},'include':{'shop':!![]}});if(!_0x1afe3f){await this[_0x8ca134(0x149)]?.[_0x8ca134(0x13a)](_0x19964e,_0x8ca134(0x159)+'Use\x20/start\x20to\x20begin.');return;}if(!_0x1afe3f[_0x8ca134(0x16e)]||!_0x1afe3f[_0x8ca134(0x199)]||!_0x1afe3f[_0x8ca134(0xf5)]){await this[_0x8ca134(0x149)]?.['sendMessage'](_0x19964e,_0x8ca134(0x165)+'Use\x20/start\x20to\x20connect.');return;}await this[_0x8ca134(0x149)]?.[_0x8ca134(0x13a)](_0x19964e,_0x8ca134(0x10e)+(_0x8ca134(0x112)+_0x1afe3f[_0x8ca134(0xf5)][_0x8ca134(0x1a0)]+'*\x0a')+(_0x8ca134(0x188)+_0x1afe3f['shop'][_0x8ca134(0xf3)]+'`\x0a')+(_0x8ca134(0x15e)+_0x1afe3f[_0x8ca134(0x1c5)][_0x8ca134(0x10c)](_0x8ca134(0x1b6))+'\x0a\x0a')+_0x8ca134(0x145)+_0x8ca134(0x144)+'/disconnect\x20-\x20disconnect\x20from\x20notifications',{'parse_mode':'Markdown'});}catch(_0x358085){console[_0x8ca134(0x106)](_0x8ca134(0x16b),_0x358085),await this[_0x8ca134(0x149)]?.[_0x8ca134(0x13a)](_0x19964e,_0x8ca134(0x13f));}}),this[_0x3dab9f(0x149)]['onText'](/\/debug/,async _0x51bb76=>{const _0x19f676=_0x3dab9f,_0x141947=_0x51bb76[_0x19f676(0x1ac)]['id'],_0x1934cb=_0x51bb76['from']?.['id'][_0x19f676(0x19c)]();if(!_0x1934cb)return;try{const _0x1a4d37=await database_1[_0x19f676(0x179)][_0x19f676(0xf5)]['findMany']({'select':{'id':!![],'name':!![],'username':!![],'status':!![],'publicKey':!![]},'take':0xa});let _0x59ab27=_0x19f676(0x133);_0x59ab27+=_0x19f676(0x182)+_0x1934cb+_0x19f676(0x1bb),_0x59ab27+=_0x19f676(0x197),_0x1a4d37[_0x19f676(0x191)]((_0x4c75f3,_0x371d37)=>{const _0x57763d=_0x19f676;_0x59ab27+=_0x371d37+0x1+'.\x20*'+_0x4c75f3[_0x57763d(0x1a0)]+'*\x0a',_0x59ab27+=_0x57763d(0x126)+_0x4c75f3[_0x57763d(0xf3)]+'`\x0a',_0x59ab27+=_0x57763d(0x1aa)+_0x4c75f3[_0x57763d(0x1b1)]+'\x0a',_0x59ab27+='\x20\x20\x20Public\x20Key:\x20`'+_0x4c75f3['publicKey'][_0x57763d(0x18c)](0x0,0xf)+_0x57763d(0x169);}),await this['bot']?.[_0x19f676(0x13a)](_0x141947,_0x59ab27,{'parse_mode':_0x19f676(0x16d)});}catch(_0x34cfe5){console['error']('Error\x20handling\x20/debug\x20command:',_0x34cfe5),await this['bot']?.[_0x19f676(0x13a)](_0x141947,_0x19f676(0x14a));}}),this['bot']['on'](_0x3dab9f(0x121),async _0x4b2df6=>{const _0x327da9=_0x3dab9f;if(_0x4b2df6[_0x327da9(0x102)]?.[_0x327da9(0x135)]('/'))return;const _0x561ae9=_0x4b2df6[_0x327da9(0x1ac)]['id'],_0x2fb479=_0x4b2df6[_0x327da9(0x107)]?.['id']['toString'](),_0x5a6b16=_0x4b2df6[_0x327da9(0x102)]?.['trim']();if(!_0x2fb479||!_0x5a6b16)return;try{const _0x175e42=await database_1['default'][_0x327da9(0x11b)][_0x327da9(0x14e)]({'where':{'telegramId':_0x2fb479},'include':{'shop':!![]}});if(!_0x175e42){await this[_0x327da9(0x149)]?.[_0x327da9(0x13a)](_0x561ae9,_0x327da9(0x113));return;}if(_0x175e42['isVerified']&&_0x175e42[_0x327da9(0x199)]&&_0x175e42[_0x327da9(0xf5)]){await this['bot']?.[_0x327da9(0x13a)](_0x561ae9,_0x327da9(0x1a4)+_0x175e42['shop'][_0x327da9(0x1a0)]+'*.\x0a\x0a'+_0x327da9(0x150),{'parse_mode':_0x327da9(0x16d)});return;}const _0x4c8423=_0x5a6b16['split'](/\s+/);if(_0x4c8423[_0x327da9(0x1c9)]!==0x2){await this[_0x327da9(0x149)]?.['sendMessage'](_0x561ae9,_0x327da9(0x1c3)+'📝\x20Format:\x20`username\x20api_key`\x0a\x0a'+_0x327da9(0x1b3)+_0x327da9(0x19f)+('You\x20sent\x20'+_0x4c8423[_0x327da9(0x1c9)]+_0x327da9(0x1c2)+_0x4c8423['map'](_0x411ec0=>'`'+_0x411ec0+'`')[_0x327da9(0xf9)](',\x20')),{'parse_mode':'Markdown'});return;}const [_0x27f753,_0x3ef07f]=_0x4c8423;console[_0x327da9(0x17b)]('🔄\x20Processing\x20single-line\x20verification\x20for\x20user\x20'+_0x2fb479+':\x20username=\x22'+_0x27f753+_0x327da9(0x125)+_0x3ef07f[_0x327da9(0x18c)](0x0,0xa)+_0x327da9(0x130)),await this[_0x327da9(0x173)](_0x561ae9,_0x2fb479,_0x27f753,_0x3ef07f);}catch(_0x31e0e8){console[_0x327da9(0x106)]('Error\x20handling\x20message:',_0x31e0e8),await this[_0x327da9(0x149)]?.['sendMessage'](_0x561ae9,_0x327da9(0x13f));}}),this[_0x3dab9f(0x149)]['on']('error',_0x2a030d=>{const _0x4227f3=_0x3dab9f;console[_0x4227f3(0x106)](_0x4227f3(0x1b7),_0x2a030d);}),this['bot']['on']('polling_error',_0x2fd1f1=>{const _0x296fbe=_0x3dab9f;console[_0x296fbe(0x106)]('Telegram\x20bot\x20polling\x20error:',_0x2fd1f1);});}async[a52_0x54d1dc(0x173)](_0x2c78e9,_0x15c52a,_0x5d6df2,_0x52ea06){const _0x53b465=a52_0x54d1dc;try{console[_0x53b465(0x17b)](_0x53b465(0x14c)+_0x15c52a+_0x53b465(0x123)+_0x5d6df2+_0x53b465(0x125)+_0x52ea06[_0x53b465(0x18c)](0x0,0xa)+_0x53b465(0x130));if(!_0x5d6df2||_0x5d6df2[_0x53b465(0x1c9)]<0x3||_0x5d6df2[_0x53b465(0x1c9)]>0x32||!/^[a-zA-Z0-9_]+$/['test'](_0x5d6df2)){await this[_0x53b465(0x149)]?.[_0x53b465(0x13a)](_0x2c78e9,_0x53b465(0x1a1)+_0x5d6df2+_0x53b465(0x1bb)+_0x53b465(0x12f),{'parse_mode':_0x53b465(0x16d)});return;}if(!_0x52ea06||!_0x52ea06[_0x53b465(0x135)](_0x53b465(0x1c0))&&!_0x52ea06[_0x53b465(0x135)](_0x53b465(0x146))){await this[_0x53b465(0x149)]?.['sendMessage'](_0x2c78e9,_0x53b465(0xfa)+_0x53b465(0x1bf),{'parse_mode':_0x53b465(0x16d)});return;}const _0x44d2bd=await database_1[_0x53b465(0x179)]['shop']['findUnique']({'where':{'username':_0x5d6df2},'select':{'id':!![],'name':!![],'username':!![],'status':!![],'publicKey':!![],'secretKey':!![]}});if(!_0x44d2bd){const _0x2abcd5=await database_1[_0x53b465(0x179)][_0x53b465(0xf5)][_0x53b465(0xfd)]({'select':{'username':!![],'name':!![]},'take':0x5});let _0x5de504=_0x53b465(0x1a2)+_0x5d6df2+'`\x20not\x20found.\x0a\x0a';_0x2abcd5[_0x53b465(0x1c9)]>0x0?(_0x5de504+=_0x53b465(0x185),_0x2abcd5[_0x53b465(0x191)](_0x1b31e8=>{const _0x44e7ff=_0x53b465;_0x5de504+='•\x20`'+_0x1b31e8[_0x44e7ff(0xf3)]+'`\x20('+_0x1b31e8[_0x44e7ff(0x1a0)]+')\x0a';}),_0x5de504+=_0x53b465(0x14f)):_0x5de504+=_0x53b465(0x13e);await this['bot']?.['sendMessage'](_0x2c78e9,_0x5de504,{'parse_mode':_0x53b465(0x16d)});return;}if(_0x44d2bd[_0x53b465(0x1b1)]!==_0x53b465(0xf8)){await this[_0x53b465(0x149)]?.[_0x53b465(0x13a)](_0x2c78e9,'❌\x20Shop\x20`'+_0x5d6df2+_0x53b465(0x12b)+'Contact\x20administrator.',{'parse_mode':_0x53b465(0x16d)});return;}if(_0x44d2bd['publicKey']!==_0x52ea06&&_0x44d2bd[_0x53b465(0x19a)]!==_0x52ea06){await this[_0x53b465(0x149)]?.[_0x53b465(0x13a)](_0x2c78e9,_0x53b465(0x1c6)+_0x5d6df2+_0x53b465(0xfb)+_0x53b465(0x1af)+_0x53b465(0x166),{'parse_mode':_0x53b465(0x16d)});return;}const _0x37c442=await database_1['default']['telegramUser'][_0x53b465(0x11e)]({'where':{'shopId':_0x44d2bd['id'],'isVerified':!![],'telegramId':{'not':_0x15c52a}}});if(_0x37c442){await this[_0x53b465(0x149)]?.[_0x53b465(0x13a)](_0x2c78e9,'❌\x20Another\x20Telegram\x20account\x20is\x20already\x20connected\x20to\x20shop\x20`'+_0x5d6df2+'`.\x0a\x0a'+_0x53b465(0x119),{'parse_mode':_0x53b465(0x16d)});return;}await database_1['default'][_0x53b465(0x11b)][_0x53b465(0x103)]({'where':{'telegramId':_0x15c52a},'data':{'shopId':_0x44d2bd['id'],'isVerified':!![]}}),await this[_0x53b465(0x149)]?.[_0x53b465(0x13a)](_0x2c78e9,_0x53b465(0x15f)+'✅\x20You\x20have\x20been\x20successfully\x20connected\x20to\x20the\x20notification\x20system!\x0a\x0a'+('📱\x20Shop:\x20*'+_0x44d2bd[_0x53b465(0x1a0)]+'*\x0a')+(_0x53b465(0x188)+_0x44d2bd[_0x53b465(0xf3)]+_0x53b465(0x1bb))+_0x53b465(0x174)+_0x53b465(0x137)+'•\x20Payment\x20status\x20changes\x0a'+_0x53b465(0x122)+'•\x20Important\x20events\x0a\x0a'+_0x53b465(0x144)+'/status\x20-\x20check\x20connection\x20status\x0a'+_0x53b465(0x1a3),{'parse_mode':'Markdown'}),console[_0x53b465(0x17b)](_0x53b465(0x176)+_0x15c52a+_0x53b465(0x13b)+_0x44d2bd['username']+_0x53b465(0xf6));}catch(_0x44c00e){console['error'](_0x53b465(0x189),_0x44c00e),await this[_0x53b465(0x149)]?.[_0x53b465(0x13a)](_0x2c78e9,'❌\x20An\x20error\x20occurred\x20while\x20verifying\x20data.');}}async[a52_0x54d1dc(0x172)](_0x3adec0,_0x5ab243,_0x5a94a4){const _0x775682=a52_0x54d1dc;if(!this['bot']){console[_0x775682(0x15b)](_0x775682(0x1ad));return;}try{const _0x5b7b8e=await database_1[_0x775682(0x179)]['telegramUser'][_0x775682(0xfd)]({'where':{'shopId':_0x3adec0,'isVerified':!![]}});if(_0x5b7b8e['length']===0x0){console[_0x775682(0x17b)](_0x775682(0x13d)+_0x3adec0);return;}const _0x4f748c=_0x5b7b8e[_0x775682(0x115)](async _0x5c7946=>{const _0x255152=_0x775682;try{await this[_0x255152(0x149)]?.[_0x255152(0x13a)](_0x5c7946[_0x255152(0x161)],_0x5ab243,_0x5a94a4),console[_0x255152(0x17b)](_0x255152(0x10d)+_0x5c7946['telegramId']);}catch(_0x16eb5a){console['error'](_0x255152(0x120)+_0x5c7946['telegramId']+':',_0x16eb5a),_0x16eb5a instanceof Error&&(_0x16eb5a[_0x255152(0x121)][_0x255152(0x193)]('blocked')||_0x16eb5a[_0x255152(0x121)][_0x255152(0x193)](_0x255152(0xfc))||_0x16eb5a[_0x255152(0x121)][_0x255152(0x193)](_0x255152(0x175)))&&(await database_1[_0x255152(0x179)][_0x255152(0x11b)][_0x255152(0x103)]({'where':{'id':_0x5c7946['id']},'data':{'isVerified':![]}}),console[_0x255152(0x17b)]('User\x20'+_0x5c7946[_0x255152(0x161)]+_0x255152(0x194)));}});await Promise[_0x775682(0x15d)](_0x4f748c);}catch(_0x4761d2){console[_0x775682(0x106)](_0x775682(0x138),_0x4761d2);}}async[a52_0x54d1dc(0x17d)](_0x247e53,_0x13f273,_0x2e51d6){const _0x1fb0f1=a52_0x54d1dc,_0xb9d48={'created':'🆕','paid':'✅','failed':'❌','expired':'⏰','refund':'🔄','chargeback':'⚠️','processing':'⚙️'},_0x1ded80={'created':_0x1fb0f1(0x11a),'paid':'Payment\x20successfully\x20paid','failed':_0x1fb0f1(0x18b),'expired':'Payment\x20expired','refund':'Payment\x20refund','chargeback':_0x1fb0f1(0x170),'processing':_0x1fb0f1(0x164)},_0x514171=_0xb9d48[_0x2e51d6],_0x508ec8=_0x1ded80[_0x2e51d6],_0x53953f=(0x0,gateway_1[_0x1fb0f1(0xf1)])(_0x13f273[_0x1fb0f1(0x1a6)]);console[_0x1fb0f1(0x17b)]('📱\x20Telegram\x20notification:\x20gateway\x20\x22'+_0x13f273[_0x1fb0f1(0x1a6)]+_0x1fb0f1(0x158)+_0x53953f+'\x22');let _0x4b8354=_0x514171+'\x20*'+_0x508ec8+'*\x0a\x0a'+(_0x1fb0f1(0x154)+_0x13f273[_0x1fb0f1(0x1bd)]+'\x20'+_0x13f273[_0x1fb0f1(0x190)]+'*\x0a')+('📝\x20Order\x20ID:\x20`'+(_0x13f273[_0x1fb0f1(0x198)]||_0x13f273['id'])+'`\x0a')+('🆔\x20Payment\x20ID:\x20`'+_0x13f273['id']+'`\x0a')+(_0x1fb0f1(0x180)+_0x53953f+'`\x0a')+(_0x1fb0f1(0x183)+new Date(_0x13f273['createdAt'])[_0x1fb0f1(0x1ba)](_0x1fb0f1(0x1b6))+'\x0a');(_0x13f273[_0x1fb0f1(0x18a)]||_0x13f273[_0x1fb0f1(0x136)])&&(_0x4b8354+=_0x1fb0f1(0x11f),_0x13f273[_0x1fb0f1(0x18a)]&&(_0x4b8354+=_0x1fb0f1(0x177)+_0x13f273[_0x1fb0f1(0x18a)]+'`\x0a'),_0x13f273[_0x1fb0f1(0x136)]&&(_0x4b8354+='📧\x20Email:\x20`'+_0x13f273[_0x1fb0f1(0x136)]+'`\x0a')),_0x2e51d6==='chargeback'&&_0x13f273[_0x1fb0f1(0x101)]&&(_0x4b8354+=_0x1fb0f1(0x18f)+_0x13f273[_0x1fb0f1(0x101)]+_0x1fb0f1(0x1c7)),_0x2e51d6==='processing'&&(_0x4b8354+=_0x1fb0f1(0x1bc)),_0x13f273[_0x1fb0f1(0x1a9)]&&(_0x4b8354+=_0x1fb0f1(0x1b9)+_0x13f273[_0x1fb0f1(0x1a9)]+'\x0a'),await this[_0x1fb0f1(0x172)](_0x247e53,_0x4b8354,{'parse_mode':_0x1fb0f1(0x16d)});}async[a52_0x54d1dc(0xf2)](_0x79820d,_0x16736b,_0x14dace){const _0x5c6f83=a52_0x54d1dc,_0x4fb9ee={'created':'📤','completed':'✅','rejected':'❌'},_0x3a78a9={'created':_0x5c6f83(0x140),'completed':_0x5c6f83(0x127),'rejected':_0x5c6f83(0x192)},_0x3d6ad4=_0x4fb9ee[_0x14dace],_0x13ea0e=_0x3a78a9[_0x14dace],_0x5454ac=_0x3d6ad4+'\x20*'+_0x13ea0e+_0x5c6f83(0x17f)+(_0x5c6f83(0x1c8)+_0x16736b['amount']+_0x5c6f83(0x178))+(_0x5c6f83(0x187)+_0x16736b['method']+'`\x0a')+(_0x5c6f83(0x168)+_0x16736b['id']+'`\x0a')+(_0x5c6f83(0x183)+new Date(_0x16736b[_0x5c6f83(0xff)])[_0x5c6f83(0x1ba)](_0x5c6f83(0x1b6))+'\x0a')+(_0x16736b[_0x5c6f83(0x132)]?_0x5c6f83(0x11c)+_0x16736b['txid']+'`':'');await this[_0x5c6f83(0x172)](_0x79820d,_0x5454ac,{'parse_mode':_0x5c6f83(0x16d)});}async[a52_0x54d1dc(0x11d)](_0x326322,_0x5bf5fc){const _0x401de2=a52_0x54d1dc;try{const _0x13bcea=await database_1['default'][_0x401de2(0x1a5)][_0x401de2(0x14e)]({'where':{'shopId':_0x326322},'select':{'notificationLogin':!![]}});if(!_0x13bcea?.[_0x401de2(0x19d)]){console[_0x401de2(0x17b)](_0x401de2(0x117)+_0x326322);return;}const _0x5a3566=_0x5bf5fc[_0x401de2(0x153)]?'🔐':'🚨',_0x372880=_0x5bf5fc[_0x401de2(0x153)]?'Successful\x20login':_0x401de2(0x12c);let _0x428284=_0x5a3566+'\x20*'+_0x372880+_0x401de2(0x17f)+(_0x401de2(0x188)+_0x5bf5fc[_0x401de2(0xf3)]+'`\x0a')+(_0x401de2(0x17c)+_0x5bf5fc[_0x401de2(0x167)][_0x401de2(0x1ba)](_0x401de2(0x1b6))+'\x0a');_0x5bf5fc[_0x401de2(0x108)]&&(_0x428284+=_0x401de2(0x1c4)+_0x5bf5fc[_0x401de2(0x108)]+'`\x0a');if(_0x5bf5fc[_0x401de2(0x16f)]){const _0x3df864=_0x5bf5fc[_0x401de2(0x16f)][_0x401de2(0x1c9)]>0x32?_0x5bf5fc[_0x401de2(0x16f)][_0x401de2(0x18c)](0x0,0x32)+_0x401de2(0x181):_0x5bf5fc[_0x401de2(0x16f)];_0x428284+='💻\x20Browser:\x20`'+_0x3df864+'`\x0a';}!_0x5bf5fc['success']&&(_0x428284+=_0x401de2(0x110)),await this['sendShopNotification'](_0x326322,_0x428284,{'parse_mode':_0x401de2(0x16d)}),console[_0x401de2(0x17b)](_0x401de2(0x141)+_0x326322+':\x20'+(_0x5bf5fc[_0x401de2(0x153)]?_0x401de2(0x153):_0x401de2(0x151)));}catch(_0x928fda){console[_0x401de2(0x106)]('Failed\x20to\x20send\x20login\x20notification:',_0x928fda);}}async[a52_0x54d1dc(0xf7)](_0x3e1f9b,_0x3bef0d){const _0x21d211=a52_0x54d1dc;try{const _0x5b8ca8=await database_1[_0x21d211(0x179)][_0x21d211(0x1a5)][_0x21d211(0x14e)]({'where':{'shopId':_0x3e1f9b},'select':{'notificationApiError':!![]}});if(!_0x5b8ca8?.['notificationApiError']){console[_0x21d211(0x17b)]('📱\x20API\x20error\x20notifications\x20disabled\x20for\x20shop\x20'+_0x3e1f9b);return;}let _0x2faaee=_0x21d211(0x186)+('🔗\x20Endpoint:\x20`'+_0x3bef0d[_0x21d211(0x13c)]+'\x20'+_0x3bef0d['endpoint']+'`\x0a')+(_0x21d211(0x17c)+_0x3bef0d[_0x21d211(0x167)]['toLocaleString'](_0x21d211(0x1b6))+'\x0a');_0x3bef0d['statusCode']&&(_0x2faaee+='📊\x20Error\x20code:\x20`'+_0x3bef0d[_0x21d211(0x10f)]+'`\x0a'),_0x2faaee+=_0x21d211(0x104)+_0x3bef0d['errorMessage']+'`\x0a',_0x3bef0d[_0x21d211(0x143)]&&(_0x2faaee+=_0x21d211(0x1ae)+_0x3bef0d[_0x21d211(0x143)]+'`\x0a'),_0x2faaee+=_0x21d211(0x18d),await this['sendShopNotification'](_0x3e1f9b,_0x2faaee,{'parse_mode':'Markdown'}),console[_0x21d211(0x17b)](_0x21d211(0x156)+_0x3e1f9b+':\x20'+_0x3bef0d[_0x21d211(0x131)]);}catch(_0x313683){console[_0x21d211(0x106)]('Failed\x20to\x20send\x20API\x20error\x20notification:',_0x313683);}}async[a52_0x54d1dc(0x10a)](_0x101086,_0x17c9ef,_0x30fcd){const _0x4cb465=a52_0x54d1dc;let _0x28340c=_0x4cb465(0x184)+_0x17c9ef+_0x4cb465(0x17f);for(const [_0x27fc50,_0x3ad22a]of Object[_0x4cb465(0x14b)](_0x30fcd)){_0x3ad22a!==null&&_0x3ad22a!==undefined&&(_0x28340c+=_0x27fc50+_0x4cb465(0x162)+_0x3ad22a+'`\x0a');}await this['sendShopNotification'](_0x101086,_0x28340c,{'parse_mode':_0x4cb465(0x16d)});}[a52_0x54d1dc(0x171)](){const _0x160275=a52_0x54d1dc;return{'isActive':!!this[_0x160275(0x149)],'username':this[_0x160275(0x16a)]};}[a52_0x54d1dc(0x15a)](){const _0x571a0e=a52_0x54d1dc;this['bot']&&(this['bot'][_0x571a0e(0x118)](),this[_0x571a0e(0x149)]=null,console[_0x571a0e(0x17b)](_0x571a0e(0x19e)));}}exports[a52_0x54d1dc(0x12d)]=TelegramBotService,exports[a52_0x54d1dc(0x18e)]=new TelegramBotService();