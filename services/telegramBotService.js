'use strict';const a54_0x29f3de=a54_0x1475;(function(_0x548350,_0x426eda){const _0x446d73=a54_0x1475,_0x666953=_0x548350();while(!![]){try{const _0x1ca65c=-parseInt(_0x446d73(0xed))/0x1*(parseInt(_0x446d73(0xea))/0x2)+-parseInt(_0x446d73(0x199))/0x3*(-parseInt(_0x446d73(0xeb))/0x4)+-parseInt(_0x446d73(0x146))/0x5+-parseInt(_0x446d73(0x11c))/0x6+-parseInt(_0x446d73(0x19b))/0x7*(-parseInt(_0x446d73(0x109))/0x8)+-parseInt(_0x446d73(0x170))/0x9+parseInt(_0x446d73(0xf3))/0xa*(parseInt(_0x446d73(0xd6))/0xb);if(_0x1ca65c===_0x426eda)break;else _0x666953['push'](_0x666953['shift']());}catch(_0x18502b){_0x666953['push'](_0x666953['shift']());}}}(a54_0xb5d4,0x4224f));var __importDefault=this&&this[a54_0x29f3de(0x150)]||function(_0x540be1){return _0x540be1&&_0x540be1['__esModule']?_0x540be1:{'default':_0x540be1};};Object[a54_0x29f3de(0x12e)](exports,a54_0x29f3de(0x186),{'value':!![]}),exports['telegramBotService']=exports[a54_0x29f3de(0xd8)]=void 0x0;const node_telegram_bot_api_1=__importDefault(require(a54_0x29f3de(0x11a))),database_1=__importDefault(require(a54_0x29f3de(0xf8))),gateway_1=require(a54_0x29f3de(0x157));class TelegramBotService{constructor(){const _0x24201f=a54_0x29f3de;this[_0x24201f(0x147)]=null,this[_0x24201f(0x159)]=process[_0x24201f(0x197)][_0x24201f(0x1ca)]||'',this[_0x24201f(0x1c7)]=process[_0x24201f(0x197)][_0x24201f(0x15e)]||_0x24201f(0x102),this['botToken']?this['initializeBot']():console[_0x24201f(0xe2)](_0x24201f(0x155));}[a54_0x29f3de(0x10a)](){const _0x31affd=a54_0x29f3de;try{this[_0x31affd(0x147)]=new node_telegram_bot_api_1[(_0x31affd(0x1c0))](this[_0x31affd(0x159)],{'polling':!![]}),this[_0x31affd(0x1a5)](),console[_0x31affd(0x1c1)]('✅\x20Telegram\x20bot\x20@'+this[_0x31affd(0x1c7)]+_0x31affd(0x148));}catch(_0xcec08f){console['error'](_0x31affd(0x18e),_0xcec08f);}}['setupBotHandlers'](){const _0x457e89=a54_0x29f3de;if(!this['bot'])return;this[_0x457e89(0x147)][_0x457e89(0x1ce)](/\/start/,async _0x4fcc46=>{const _0x4dbce5=_0x457e89,_0x16e4d0=_0x4fcc46['chat']['id'],_0x27b4d3=_0x4fcc46['from']?.['id']['toString'](),_0x151c47=_0x4fcc46[_0x4dbce5(0x117)]?.[_0x4dbce5(0xf6)],_0x50874d=_0x4fcc46[_0x4dbce5(0x117)]?.[_0x4dbce5(0x115)],_0x3a8aec=_0x4fcc46['from']?.[_0x4dbce5(0xf1)];if(!_0x27b4d3)return;try{let _0x4511ba=await database_1[_0x4dbce5(0x1c0)][_0x4dbce5(0x16a)]['findUnique']({'where':{'telegramId':_0x27b4d3},'include':{'shop':!![]}});!_0x4511ba?(_0x4511ba=await database_1[_0x4dbce5(0x1c0)][_0x4dbce5(0x16a)][_0x4dbce5(0x194)]({'data':{'telegramId':_0x27b4d3,'username':_0x151c47,'firstName':_0x50874d,'lastName':_0x3a8aec,'isVerified':![],'shopId':null},'include':{'shop':!![]}}),console[_0x4dbce5(0x1c1)](_0x4dbce5(0x174)+_0x27b4d3+_0x4dbce5(0x13c)+_0x151c47+')')):_0x4511ba=await database_1[_0x4dbce5(0x1c0)]['telegramUser'][_0x4dbce5(0x1bb)]({'where':{'telegramId':_0x27b4d3},'data':{'username':_0x151c47,'firstName':_0x50874d,'lastName':_0x3a8aec},'include':{'shop':!![]}}),_0x4511ba['isVerified']&&_0x4511ba['shopId']&&_0x4511ba[_0x4dbce5(0x10b)]?await this[_0x4dbce5(0x147)]?.[_0x4dbce5(0x161)](_0x16e4d0,_0x4dbce5(0x1d6)+(_0x4dbce5(0xdd)+_0x4511ba['shop']['name']+'*\x0a')+(_0x4dbce5(0x164)+_0x4511ba[_0x4dbce5(0x10b)][_0x4dbce5(0xf6)]+_0x4dbce5(0x12b))+_0x4dbce5(0x19c)+'•\x20New\x20payments\x0a'+_0x4dbce5(0x19d)+'•\x20Payouts\x0a\x0a'+_0x4dbce5(0x104)+_0x4dbce5(0x1c8)+_0x4dbce5(0x13a),{'parse_mode':_0x4dbce5(0x151)}):(_0x4511ba[_0x4dbce5(0x168)]&&!_0x4511ba[_0x4dbce5(0x121)]&&(await database_1[_0x4dbce5(0x1c0)]['telegramUser'][_0x4dbce5(0x1bb)]({'where':{'telegramId':_0x27b4d3},'data':{'shopId':null,'isVerified':![]}}),console[_0x4dbce5(0x1c1)](_0x4dbce5(0x173)+_0x27b4d3)),await this[_0x4dbce5(0x147)]?.[_0x4dbce5(0x161)](_0x16e4d0,_0x4dbce5(0x113)+'To\x20receive\x20payment\x20notifications,\x20send\x20your\x20credentials\x20in\x20one\x20line:\x0a\x0a'+_0x4dbce5(0x172)+_0x4dbce5(0x175)+_0x4dbce5(0x13b)+'❗️\x20Make\x20sure\x20to\x20separate\x20username\x20and\x20API\x20key\x20with\x20a\x20space!',{'parse_mode':'Markdown'}));}catch(_0x2a502e){console['error'](_0x4dbce5(0x1b0),_0x2a502e),await this[_0x4dbce5(0x147)]?.[_0x4dbce5(0x161)](_0x16e4d0,_0x4dbce5(0x10c));}}),this[_0x457e89(0x147)][_0x457e89(0x1ce)](/\/disconnect/,async _0x53e258=>{const _0x3da456=_0x457e89,_0x3050e2=_0x53e258[_0x3da456(0x1c5)]['id'],_0x214bf9=_0x53e258[_0x3da456(0x117)]?.['id'][_0x3da456(0x166)]();if(!_0x214bf9)return;try{const _0x225873=await database_1[_0x3da456(0x1c0)]['telegramUser'][_0x3da456(0x184)]({'where':{'telegramId':_0x214bf9},'include':{'shop':!![]}});if(!_0x225873||!_0x225873[_0x3da456(0x121)]||!_0x225873['shopId']){await this[_0x3da456(0x147)]?.[_0x3da456(0x161)](_0x3050e2,_0x3da456(0x15b));return;}const _0x28f167=_0x225873['shop']?.[_0x3da456(0x10f)]||_0x3da456(0xfc);await database_1[_0x3da456(0x1c0)][_0x3da456(0x16a)][_0x3da456(0x1bb)]({'where':{'telegramId':_0x214bf9},'data':{'shopId':null,'isVerified':![]}}),console['log'](_0x3da456(0x1ac)+_0x214bf9+'\x20disconnected\x20from\x20shop\x20'+_0x225873[_0x3da456(0x168)]),await this[_0x3da456(0x147)]?.[_0x3da456(0x161)](_0x3050e2,_0x3da456(0x16c)+_0x28f167+_0x3da456(0x16e)+_0x3da456(0x12d),{'parse_mode':_0x3da456(0x151)});}catch(_0x5c4490){console[_0x3da456(0xd9)]('Error\x20handling\x20/disconnect\x20command:',_0x5c4490),await this[_0x3da456(0x147)]?.[_0x3da456(0x161)](_0x3050e2,_0x3da456(0x10c));}}),this[_0x457e89(0x147)][_0x457e89(0x1ce)](/\/status/,async _0x57db55=>{const _0x6209aa=_0x457e89,_0x296def=_0x57db55[_0x6209aa(0x1c5)]['id'],_0x9dde29=_0x57db55[_0x6209aa(0x117)]?.['id']['toString']();if(!_0x9dde29)return;try{const _0x14efdd=await database_1[_0x6209aa(0x1c0)][_0x6209aa(0x16a)]['findUnique']({'where':{'telegramId':_0x9dde29},'include':{'shop':!![]}});if(!_0x14efdd){await this['bot']?.['sendMessage'](_0x296def,_0x6209aa(0x14e)+_0x6209aa(0x119));return;}if(!_0x14efdd[_0x6209aa(0x121)]||!_0x14efdd['shopId']||!_0x14efdd[_0x6209aa(0x10b)]){await this[_0x6209aa(0x147)]?.[_0x6209aa(0x161)](_0x296def,_0x6209aa(0x1ae)+_0x6209aa(0x16d));return;}await this[_0x6209aa(0x147)]?.['sendMessage'](_0x296def,_0x6209aa(0x162)+(_0x6209aa(0x15c)+_0x14efdd[_0x6209aa(0x10b)][_0x6209aa(0x10f)]+'*\x0a')+(_0x6209aa(0x130)+_0x14efdd[_0x6209aa(0x10b)][_0x6209aa(0xf6)]+'`\x0a')+('📅\x20Connection\x20date:\x20'+_0x14efdd[_0x6209aa(0xe0)][_0x6209aa(0xe8)](_0x6209aa(0xec))+'\x0a\x0a')+_0x6209aa(0x1cf)+_0x6209aa(0x104)+_0x6209aa(0x13a),{'parse_mode':'Markdown'});}catch(_0x28a3a6){console[_0x6209aa(0xd9)](_0x6209aa(0xee),_0x28a3a6),await this[_0x6209aa(0x147)]?.[_0x6209aa(0x161)](_0x296def,_0x6209aa(0x10c));}}),this[_0x457e89(0x147)][_0x457e89(0x1ce)](/\/debug/,async _0x3451b1=>{const _0xd1880c=_0x457e89,_0x10de05=_0x3451b1[_0xd1880c(0x1c5)]['id'],_0xb98f03=_0x3451b1[_0xd1880c(0x117)]?.['id']['toString']();if(!_0xb98f03)return;try{const _0x15a95b=await database_1[_0xd1880c(0x1c0)][_0xd1880c(0x10b)][_0xd1880c(0x11f)]({'select':{'id':!![],'name':!![],'username':!![],'status':!![],'publicKey':!![]},'take':0xa});let _0x4965bb=_0xd1880c(0x17e);_0x4965bb+=_0xd1880c(0x16f)+_0xb98f03+_0xd1880c(0x12b),_0x4965bb+='🏪\x20Available\x20shops\x20in\x20system:\x0a',_0x15a95b[_0xd1880c(0x17c)]((_0x5b9e9c,_0x4f7e0e)=>{const _0xa71583=_0xd1880c;_0x4965bb+=_0x4f7e0e+0x1+'.\x20*'+_0x5b9e9c[_0xa71583(0x10f)]+'*\x0a',_0x4965bb+=_0xa71583(0x1af)+_0x5b9e9c[_0xa71583(0xf6)]+'`\x0a',_0x4965bb+=_0xa71583(0x165)+_0x5b9e9c['status']+'\x0a',_0x4965bb+='\x20\x20\x20Public\x20Key:\x20`'+_0x5b9e9c[_0xa71583(0x15d)][_0xa71583(0x163)](0x0,0xf)+_0xa71583(0x134);}),await this[_0xd1880c(0x147)]?.[_0xd1880c(0x161)](_0x10de05,_0x4965bb,{'parse_mode':_0xd1880c(0x151)});}catch(_0x2d9783){console[_0xd1880c(0xd9)]('Error\x20handling\x20/debug\x20command:',_0x2d9783),await this[_0xd1880c(0x147)]?.[_0xd1880c(0x161)](_0x10de05,'❌\x20Error\x20getting\x20debug\x20information.');}}),this[_0x457e89(0x147)]['on']('message',async _0x561988=>{const _0x5bdd2c=_0x457e89;if(_0x561988['text']?.[_0x5bdd2c(0x17d)]('/'))return;const _0x1af1b2=_0x561988['chat']['id'],_0x57ea27=_0x561988[_0x5bdd2c(0x117)]?.['id'][_0x5bdd2c(0x166)](),_0xe89e65=_0x561988['text']?.[_0x5bdd2c(0x1a1)]();if(!_0x57ea27||!_0xe89e65)return;try{const _0x440c0f=await database_1[_0x5bdd2c(0x1c0)]['telegramUser'][_0x5bdd2c(0x184)]({'where':{'telegramId':_0x57ea27},'include':{'shop':!![]}});if(!_0x440c0f){await this[_0x5bdd2c(0x147)]?.[_0x5bdd2c(0x161)](_0x1af1b2,_0x5bdd2c(0x19f));return;}if(_0x440c0f[_0x5bdd2c(0x121)]&&_0x440c0f[_0x5bdd2c(0x168)]&&_0x440c0f[_0x5bdd2c(0x10b)]){await this['bot']?.['sendMessage'](_0x1af1b2,_0x5bdd2c(0x190)+_0x440c0f[_0x5bdd2c(0x10b)][_0x5bdd2c(0x10f)]+_0x5bdd2c(0x16e)+_0x5bdd2c(0xe1),{'parse_mode':_0x5bdd2c(0x151)});return;}const _0x312c21=_0xe89e65[_0x5bdd2c(0x1a2)](/\s+/);if(_0x312c21['length']!==0x2){await this[_0x5bdd2c(0x147)]?.[_0x5bdd2c(0x161)](_0x1af1b2,_0x5bdd2c(0x145)+_0x5bdd2c(0x172)+_0x5bdd2c(0x175)+_0x5bdd2c(0x13b)+(_0x5bdd2c(0x127)+_0x312c21[_0x5bdd2c(0x171)]+'\x20parts:\x20'+_0x312c21[_0x5bdd2c(0x1b1)](_0x1b9bc7=>'`'+_0x1b9bc7+'`')[_0x5bdd2c(0xf4)](',\x20')),{'parse_mode':_0x5bdd2c(0x151)});return;}const [_0x150f4c,_0x24c377]=_0x312c21;console['log'](_0x5bdd2c(0x154)+_0x57ea27+_0x5bdd2c(0xdb)+_0x150f4c+_0x5bdd2c(0x14f)+_0x24c377['substring'](0x0,0xa)+_0x5bdd2c(0x182)),await this[_0x5bdd2c(0x1bf)](_0x1af1b2,_0x57ea27,_0x150f4c,_0x24c377);}catch(_0x233130){console[_0x5bdd2c(0xd9)]('Error\x20handling\x20message:',_0x233130),await this[_0x5bdd2c(0x147)]?.[_0x5bdd2c(0x161)](_0x1af1b2,_0x5bdd2c(0x10c));}}),this[_0x457e89(0x147)]['on'](_0x457e89(0xd9),_0x1f03ac=>{const _0x3a9780=_0x457e89;console[_0x3a9780(0xd9)](_0x3a9780(0x10d),_0x1f03ac);}),this[_0x457e89(0x147)]['on'](_0x457e89(0xfb),_0x381ae1=>{const _0x2e2c1f=_0x457e89;console[_0x2e2c1f(0xd9)](_0x2e2c1f(0xff),_0x381ae1);});}async[a54_0x29f3de(0x1bf)](_0x117d9a,_0x517750,_0x2e47fd,_0x34e0a2){const _0x1b177e=a54_0x29f3de;try{console[_0x1b177e(0x1c1)]('🔄\x20Processing\x20single-line\x20verification\x20for\x20user\x20'+_0x517750+_0x1b177e(0xdb)+_0x2e47fd+_0x1b177e(0x14f)+_0x34e0a2['substring'](0x0,0xa)+_0x1b177e(0x182));if(!_0x2e47fd||_0x2e47fd[_0x1b177e(0x171)]<0x3||_0x2e47fd[_0x1b177e(0x171)]>0x32||!/^[a-zA-Z0-9_]+$/['test'](_0x2e47fd)){await this[_0x1b177e(0x147)]?.['sendMessage'](_0x117d9a,_0x1b177e(0x1b2)+_0x2e47fd+'`\x0a\x0a'+_0x1b177e(0x1a7),{'parse_mode':_0x1b177e(0x151)});return;}if(!_0x34e0a2||!_0x34e0a2[_0x1b177e(0x17d)]('pk_')&&!_0x34e0a2[_0x1b177e(0x17d)](_0x1b177e(0x189))){await this['bot']?.[_0x1b177e(0x161)](_0x117d9a,_0x1b177e(0x114)+_0x1b177e(0x133),{'parse_mode':_0x1b177e(0x151)});return;}const _0x569b94=await database_1['default'][_0x1b177e(0x10b)][_0x1b177e(0x184)]({'where':{'username':_0x2e47fd},'select':{'id':!![],'name':!![],'username':!![],'status':!![],'publicKey':!![],'secretKey':!![]}});if(!_0x569b94){const _0x575b61=await database_1[_0x1b177e(0x1c0)][_0x1b177e(0x10b)][_0x1b177e(0x11f)]({'select':{'username':!![],'name':!![]},'take':0x5});let _0x14c9d3=_0x1b177e(0x1b5)+_0x2e47fd+_0x1b177e(0xef);_0x575b61[_0x1b177e(0x171)]>0x0?(_0x14c9d3+=_0x1b177e(0x158),_0x575b61['forEach'](_0x153964=>{const _0x15dc56=_0x1b177e;_0x14c9d3+=_0x15dc56(0x18c)+_0x153964['username']+_0x15dc56(0x1c6)+_0x153964['name']+')\x0a';}),_0x14c9d3+=_0x1b177e(0x17a)):_0x14c9d3+=_0x1b177e(0x143);await this[_0x1b177e(0x147)]?.[_0x1b177e(0x161)](_0x117d9a,_0x14c9d3,{'parse_mode':'Markdown'});return;}if(_0x569b94[_0x1b177e(0x12c)]!==_0x1b177e(0xd3)){const _0x25f7b9=_0x569b94[_0x1b177e(0x12c)]===_0x1b177e(0x100)?_0x1b177e(0x1d1)+_0x2e47fd+_0x1b177e(0x1c2)+_0x1b177e(0x176)+'Contact\x20administrator\x20to\x20restore\x20full\x20access.':_0x1b177e(0xf2)+_0x2e47fd+_0x1b177e(0x131)+'Contact\x20administrator.';await this[_0x1b177e(0x147)]?.[_0x1b177e(0x161)](_0x117d9a,_0x25f7b9,{'parse_mode':'Markdown'});return;}if(_0x569b94[_0x1b177e(0x15d)]!==_0x34e0a2&&_0x569b94[_0x1b177e(0x13f)]!==_0x34e0a2){await this[_0x1b177e(0x147)]?.[_0x1b177e(0x161)](_0x117d9a,_0x1b177e(0x122)+_0x2e47fd+'`.\x0a\x0a'+_0x1b177e(0x1c4)+_0x1b177e(0xd7),{'parse_mode':'Markdown'});return;}const _0x1148ae=await database_1[_0x1b177e(0x1c0)][_0x1b177e(0x16a)][_0x1b177e(0x1b3)]({'where':{'shopId':_0x569b94['id'],'isVerified':!![],'telegramId':{'not':_0x517750}}});if(_0x1148ae){await this[_0x1b177e(0x147)]?.['sendMessage'](_0x117d9a,_0x1b177e(0x136)+_0x2e47fd+_0x1b177e(0x1cc)+_0x1b177e(0xfa),{'parse_mode':_0x1b177e(0x151)});return;}await database_1[_0x1b177e(0x1c0)][_0x1b177e(0x16a)][_0x1b177e(0x1bb)]({'where':{'telegramId':_0x517750},'data':{'shopId':_0x569b94['id'],'isVerified':!![]}}),await this['bot']?.[_0x1b177e(0x161)](_0x117d9a,_0x1b177e(0x135)+_0x1b177e(0x18f)+(_0x1b177e(0x19e)+_0x569b94[_0x1b177e(0x10f)]+'*\x0a')+(_0x1b177e(0x130)+_0x569b94[_0x1b177e(0xf6)]+_0x1b177e(0x12b))+_0x1b177e(0x179)+_0x1b177e(0x105)+_0x1b177e(0x19d)+'•\x20Payouts\x0a'+_0x1b177e(0x167)+_0x1b177e(0x104)+'/status\x20-\x20check\x20connection\x20status\x0a'+_0x1b177e(0x13a),{'parse_mode':_0x1b177e(0x151)}),console[_0x1b177e(0x1c1)](_0x1b177e(0x160)+_0x517750+_0x1b177e(0x1be)+_0x569b94[_0x1b177e(0xf6)]+'\x20via\x20single-line\x20input');}catch(_0x3d7977){console['error'](_0x1b177e(0x123),_0x3d7977),await this[_0x1b177e(0x147)]?.[_0x1b177e(0x161)](_0x117d9a,_0x1b177e(0x17b));}}async['sendShopNotification'](_0x4d1211,_0x40a5a0,_0x2b64cc){const _0x4564ad=a54_0x29f3de;if(!this[_0x4564ad(0x147)]){console[_0x4564ad(0xe2)](_0x4564ad(0x187));return;}try{const _0x164bd7=await database_1[_0x4564ad(0x1c0)][_0x4564ad(0x16a)]['findMany']({'where':{'shopId':_0x4d1211,'isVerified':!![]}});if(_0x164bd7[_0x4564ad(0x171)]===0x0){console[_0x4564ad(0x1c1)](_0x4564ad(0xdc)+_0x4d1211);return;}const _0x484568=_0x164bd7['map'](async _0x3c7cbc=>{const _0x347ce0=_0x4564ad;try{await this[_0x347ce0(0x147)]?.['sendMessage'](_0x3c7cbc['telegramId'],_0x40a5a0,_0x2b64cc),console['log'](_0x347ce0(0x125)+_0x3c7cbc[_0x347ce0(0x103)]);}catch(_0x40e676){console[_0x347ce0(0xd9)](_0x347ce0(0x142)+_0x3c7cbc[_0x347ce0(0x103)]+':',_0x40e676),_0x40e676 instanceof Error&&(_0x40e676[_0x347ce0(0x112)][_0x347ce0(0x188)](_0x347ce0(0x111))||_0x40e676['message'][_0x347ce0(0x188)](_0x347ce0(0xf0))||_0x40e676[_0x347ce0(0x112)]['includes'](_0x347ce0(0x156)))&&(await database_1[_0x347ce0(0x1c0)][_0x347ce0(0x16a)][_0x347ce0(0x1bb)]({'where':{'id':_0x3c7cbc['id']},'data':{'isVerified':![]}}),console[_0x347ce0(0x1c1)]('User\x20'+_0x3c7cbc['telegramId']+_0x347ce0(0x13e)));}});await Promise[_0x4564ad(0x185)](_0x484568);}catch(_0x3195e5){console[_0x4564ad(0xd9)](_0x4564ad(0x1d4),_0x3195e5);}}async['sendPaymentNotification'](_0x477cce,_0x36c50c,_0x3841c0){const _0x5b0152=a54_0x29f3de,_0x1beb30={'created':'🆕','paid':'✅','failed':'❌','expired':'⏰','refund':'🔄','chargeback':'⚠️','processing':'⚙️'},_0x902913={'created':_0x5b0152(0xe9),'paid':'Payment\x20successfully\x20paid','failed':_0x5b0152(0xe6),'expired':_0x5b0152(0x181),'refund':_0x5b0152(0x14c),'chargeback':_0x5b0152(0x1a6),'processing':_0x5b0152(0x152)},_0x3f90b9=_0x1beb30[_0x3841c0],_0x313078=_0x902913[_0x3841c0],_0x42aac7=(0x0,gateway_1[_0x5b0152(0x101)])(_0x36c50c['gateway']);console[_0x5b0152(0x1c1)](_0x5b0152(0x14a)+_0x36c50c[_0x5b0152(0xda)]+_0x5b0152(0x196)+_0x42aac7+'\x22');let _0x430ddc=_0x3f90b9+'\x20*'+_0x313078+_0x5b0152(0xd5)+('💰\x20Amount:\x20*'+_0x36c50c['amount']+'\x20'+_0x36c50c[_0x5b0152(0x14d)]+'*\x0a')+(_0x5b0152(0x1c3)+(_0x36c50c[_0x5b0152(0x11b)]||_0x36c50c['id'])+'`\x0a')+(_0x5b0152(0x108)+_0x36c50c['id']+'`\x0a')+(_0x5b0152(0x140)+_0x42aac7+'`\x0a')+('📅\x20Date:\x20'+new Date(_0x36c50c['createdAt'])['toLocaleString']('en-US')+'\x0a');(_0x36c50c['customerName']||_0x36c50c['customerEmail']||_0x36c50c[_0x5b0152(0x1bc)]||_0x36c50c[_0x5b0152(0x12f)])&&(_0x430ddc+='\x0a👤\x20*Customer\x20Information:*\x0a',_0x36c50c[_0x5b0152(0x144)]&&(_0x430ddc+=_0x5b0152(0x1d5)+_0x36c50c[_0x5b0152(0x144)]+'`\x0a'),_0x36c50c['customerEmail']&&(_0x430ddc+=_0x5b0152(0xe4)+_0x36c50c[_0x5b0152(0x128)]+'`\x0a'),_0x36c50c[_0x5b0152(0x1bc)]&&(_0x430ddc+=_0x5b0152(0x126)+_0x36c50c[_0x5b0152(0x1bc)]+'`\x0a'),_0x36c50c[_0x5b0152(0x12f)]&&(_0x430ddc+='🗺️\x20Country:\x20`'+_0x36c50c['customerCountry']+'`\x0a'));if(_0x36c50c['gateway']==='cointopay'&&_0x36c50c[_0x5b0152(0x1cd)]){_0x430ddc+='\x0a🪙\x20*CoinToPay\x20Details:*\x0a',_0x430ddc+=_0x5b0152(0xdf)+_0x36c50c[_0x5b0152(0x1cd)]+'`\x0a';_0x36c50c[_0x5b0152(0x18b)]&&(_0x430ddc+=_0x5b0152(0x18a)+_0x36c50c[_0x5b0152(0x18b)]+'`\x0a');if(_0x36c50c[_0x5b0152(0x1bc)]&&_0x36c50c[_0x5b0152(0x12f)])_0x430ddc+=_0x5b0152(0x139)+_0x36c50c['customerCountry']+'`\x20(IP:\x20`'+_0x36c50c[_0x5b0152(0x1bc)]+_0x5b0152(0x10e);else{if(_0x36c50c[_0x5b0152(0x1bc)])_0x430ddc+=_0x5b0152(0x126)+_0x36c50c[_0x5b0152(0x1bc)]+'`\x0a';else _0x36c50c[_0x5b0152(0x12f)]&&(_0x430ddc+=_0x5b0152(0x110)+_0x36c50c[_0x5b0152(0x12f)]+'`\x0a');}}else(_0x36c50c[_0x5b0152(0x138)]||_0x36c50c[_0x5b0152(0xfe)]||_0x36c50c['bankId']||_0x36c50c['remitterIban'])&&(_0x430ddc+=_0x5b0152(0x1a0),_0x36c50c[_0x5b0152(0x138)]&&(_0x430ddc+=_0x5b0152(0x1c9)+_0x36c50c[_0x5b0152(0x138)]+'`\x0a'),_0x36c50c[_0x5b0152(0xfe)]&&(_0x430ddc+='💳\x20Card:\x20`****'+_0x36c50c['cardLast4']+'`\x0a'),_0x36c50c[_0x5b0152(0x129)]&&(_0x430ddc+=_0x5b0152(0x149)+_0x36c50c[_0x5b0152(0x129)]+'`\x0a'),_0x36c50c[_0x5b0152(0x1cd)]&&(_0x430ddc+=_0x5b0152(0xdf)+_0x36c50c[_0x5b0152(0x1cd)]+'`\x0a'),_0x36c50c['remitterName']&&(_0x430ddc+=_0x5b0152(0x11e)+_0x36c50c['remitterName']+'`\x0a'));_0x3841c0===_0x5b0152(0x1d3)&&_0x36c50c[_0x5b0152(0x1b4)]&&(_0x430ddc+='💸\x20Penalty\x20amount:\x20*'+_0x36c50c[_0x5b0152(0x1b4)]+_0x5b0152(0x1cb)),_0x3841c0===_0x5b0152(0x107)&&(_0x430ddc+=_0x5b0152(0xde)),_0x36c50c[_0x5b0152(0x1aa)]&&(_0x430ddc+=_0x5b0152(0x178)+_0x36c50c[_0x5b0152(0x1aa)]+'\x0a'),await this[_0x5b0152(0x16b)](_0x477cce,_0x430ddc,{'parse_mode':_0x5b0152(0x151)});}async[a54_0x29f3de(0x198)](_0x3c4ce3,_0x2b0d12,_0x4448dc){const _0x423283=a54_0x29f3de,_0x16e20c={'created':'📤','completed':'✅','rejected':'❌'},_0x1fdbf0={'created':_0x423283(0x15f),'completed':_0x423283(0x12a),'rejected':_0x423283(0x1a8)},_0x342981=_0x16e20c[_0x4448dc],_0x351205=_0x1fdbf0[_0x4448dc],_0x86a835=_0x342981+'\x20*'+_0x351205+_0x423283(0xd5)+(_0x423283(0x191)+_0x2b0d12['amount']+_0x423283(0x1d2))+(_0x423283(0x177)+_0x2b0d12['method']+'`\x0a')+('🆔\x20Payout\x20ID:\x20`'+_0x2b0d12['id']+'`\x0a')+(_0x423283(0x183)+new Date(_0x2b0d12[_0x423283(0x180)])['toLocaleString']('en-US')+'\x0a')+(_0x2b0d12[_0x423283(0x195)]?'🔗\x20TXID:\x20`'+_0x2b0d12[_0x423283(0x195)]+'`':'');await this[_0x423283(0x16b)](_0x3c4ce3,_0x86a835,{'parse_mode':_0x423283(0x151)});}async[a54_0x29f3de(0x11d)](_0x166dd2,_0x5d72dc){const _0x37cf5c=a54_0x29f3de;try{const _0x3c9385=await database_1[_0x37cf5c(0x1c0)][_0x37cf5c(0x1ad)][_0x37cf5c(0x184)]({'where':{'shopId':_0x166dd2},'select':{'notificationLogin':!![]}});if(!_0x3c9385?.[_0x37cf5c(0x1b9)]){console[_0x37cf5c(0x1c1)](_0x37cf5c(0x193)+_0x166dd2);return;}const _0x4f2db7=_0x5d72dc[_0x37cf5c(0x132)]?'🔐':'🚨',_0x40dd29=_0x5d72dc[_0x37cf5c(0x132)]?_0x37cf5c(0x137):_0x37cf5c(0xe3);let _0x294aca=_0x4f2db7+'\x20*'+_0x40dd29+'*\x0a\x0a'+('👤\x20Username:\x20`'+_0x5d72dc[_0x37cf5c(0xf6)]+'`\x0a')+(_0x37cf5c(0x1d0)+_0x5d72dc['timestamp']['toLocaleString']('en-US')+'\x0a');_0x5d72dc[_0x37cf5c(0x118)]&&(_0x294aca+=_0x37cf5c(0x1a3)+_0x5d72dc[_0x37cf5c(0x118)]+'`\x0a');if(_0x5d72dc[_0x37cf5c(0xfd)]){const _0x439fcf=_0x5d72dc[_0x37cf5c(0xfd)]['length']>0x32?_0x5d72dc[_0x37cf5c(0xfd)][_0x37cf5c(0x163)](0x0,0x32)+'...':_0x5d72dc['userAgent'];_0x294aca+=_0x37cf5c(0x1bd)+_0x439fcf+'`\x0a';}!_0x5d72dc['success']&&(_0x294aca+=_0x37cf5c(0xd4)),await this['sendShopNotification'](_0x166dd2,_0x294aca,{'parse_mode':_0x37cf5c(0x151)}),console['log'](_0x37cf5c(0x153)+_0x166dd2+':\x20'+(_0x5d72dc[_0x37cf5c(0x132)]?_0x37cf5c(0x132):_0x37cf5c(0xe7)));}catch(_0x57947c){console[_0x37cf5c(0xd9)](_0x37cf5c(0x17f),_0x57947c);}}async[a54_0x29f3de(0x1ba)](_0x7fb029,_0x1fff34){const _0x1175df=a54_0x29f3de;try{const _0x32ac36=await database_1[_0x1175df(0x1c0)][_0x1175df(0x1ad)][_0x1175df(0x184)]({'where':{'shopId':_0x7fb029},'select':{'notificationApiError':!![]}});if(!_0x32ac36?.[_0x1175df(0x120)]){console[_0x1175df(0x1c1)]('📱\x20API\x20error\x20notifications\x20disabled\x20for\x20shop\x20'+_0x7fb029);return;}let _0x4ae49e=_0x1175df(0x141)+(_0x1175df(0xf7)+_0x1fff34[_0x1175df(0x116)]+'\x20'+_0x1fff34['endpoint']+'`\x0a')+(_0x1175df(0x1d0)+_0x1fff34['timestamp'][_0x1175df(0x18d)]('en-US')+'\x0a');_0x1fff34[_0x1175df(0x13d)]&&(_0x4ae49e+=_0x1175df(0x1b8)+_0x1fff34[_0x1175df(0x13d)]+'`\x0a'),_0x4ae49e+=_0x1175df(0x192)+_0x1fff34[_0x1175df(0x19a)]+'`\x0a',_0x1fff34[_0x1175df(0xe5)]&&(_0x4ae49e+=_0x1175df(0x1a4)+_0x1fff34[_0x1175df(0xe5)]+'`\x0a'),_0x4ae49e+='\x0a💡\x20Check\x20your\x20request\x20or\x20contact\x20support.',await this[_0x1175df(0x16b)](_0x7fb029,_0x4ae49e,{'parse_mode':'Markdown'}),console[_0x1175df(0x1c1)](_0x1175df(0x15a)+_0x7fb029+':\x20'+_0x1fff34[_0x1175df(0x1ab)]);}catch(_0x2b8c4f){console['error'](_0x1175df(0x1a9),_0x2b8c4f);}}async[a54_0x29f3de(0x169)](_0x26bcb9,_0x2fd351,_0x2e9ba6){const _0x158537=a54_0x29f3de;let _0x580212=_0x158537(0x14b)+_0x2fd351+_0x158537(0xd5);for(const [_0x2da30f,_0x3ff827]of Object[_0x158537(0x1b6)](_0x2e9ba6)){_0x3ff827!==null&&_0x3ff827!==undefined&&(_0x580212+=_0x2da30f+_0x158537(0x106)+_0x3ff827+'`\x0a');}await this['sendShopNotification'](_0x26bcb9,_0x580212,{'parse_mode':_0x158537(0x151)});}[a54_0x29f3de(0x124)](){const _0x21e3ee=a54_0x29f3de;return{'isActive':!!this[_0x21e3ee(0x147)],'username':this[_0x21e3ee(0x1c7)]};}[a54_0x29f3de(0xf9)](){const _0x4461b4=a54_0x29f3de;this['bot']&&(this[_0x4461b4(0x147)]['stopPolling'](),this[_0x4461b4(0x147)]=null,console[_0x4461b4(0x1c1)](_0x4461b4(0x1b7)));}}function a54_0xb5d4(){const _0x53a2b8=['🌐\x20IP:\x20`','You\x20sent\x20','customerEmail','bankId','Payout\x20completed','`\x0a\x0a','status','To\x20reconnect,\x20use\x20the\x20/start\x20command','defineProperty','customerCountry','👤\x20Username:\x20`','`\x20is\x20inactive.\x0a\x0a','success','API\x20key\x20must\x20start\x20with\x20`pk\x5c_`\x20or\x20`sk\x5c_`.','...`\x0a\x0a','🎉\x20*Congratulations!*\x0a\x0a','❌\x20Another\x20Telegram\x20account\x20is\x20already\x20connected\x20to\x20shop\x20`','Successful\x20login','paymentMethod','🌍\x20From:\x20`','/disconnect\x20-\x20disconnect\x20from\x20notifications','`appple\x20pk_aa6450d3f57afbefbb0f3f5be5ce6cca13037536afc5ccf14c81a6cbc7a07de5`\x0a\x0a','\x20(@','statusCode','\x20marked\x20as\x20unverified\x20due\x20to\x20delivery\x20failure','secretKey','🏪\x20Gateway:\x20`','🚨\x20*API\x20Error*\x0a\x0a','❌\x20Failed\x20to\x20send\x20notification\x20to\x20Telegram\x20user\x20','Check\x20spelling\x20and\x20try\x20again.','customerName','❌\x20Invalid\x20format.\x20Please\x20send\x20exactly\x202\x20parts\x20separated\x20by\x20space:\x0a\x0a','632720YfuUVt','bot','\x20initialized\x20successfully','🏦\x20Bank\x20ID:\x20`','📱\x20Telegram\x20notification:\x20gateway\x20\x22','🔔\x20*','Payment\x20refund','currency','❌\x20You\x20are\x20not\x20registered\x20in\x20the\x20system.\x0a\x0a','\x22,\x20apiKey=\x22','__importDefault','Markdown','Payment\x20is\x20being\x20processed','✅\x20Login\x20notification\x20sent\x20for\x20shop\x20','🔄\x20Processing\x20single-line\x20verification\x20for\x20user\x20','TELEGRAM_BOT_TOKEN\x20not\x20found\x20in\x20environment\x20variables','user\x20is\x20deactivated','../types/gateway','Available\x20usernames:\x0a','botToken','✅\x20API\x20error\x20notification\x20sent\x20for\x20shop\x20','❌\x20You\x20are\x20not\x20connected\x20to\x20the\x20notification\x20system.','✅\x20Connected\x20to\x20shop:\x20*','publicKey','TELEGRAM_BOT_USERNAME','New\x20payout\x20created','✅\x20Telegram\x20user\x20','sendMessage','📊\x20*Connection\x20Status*\x0a\x0a','substring','Username:\x20`','\x20\x20\x20Status:\x20','toString','•\x20Important\x20events\x0a\x0a','shopId','sendCustomNotification','telegramUser','sendShopNotification','✅\x20You\x20have\x20been\x20successfully\x20disconnected\x20from\x20shop\x20*','Use\x20/start\x20to\x20connect.','*.\x0a\x0a','📱\x20Your\x20Telegram\x20ID:\x20`','4295790kiQmok','length','📝\x20Format:\x20`username\x20api_key`\x0a\x0a','🔄\x20Reset\x20incomplete\x20verification\x20for\x20user\x20','📱\x20Created\x20new\x20Telegram\x20user:\x20','Example:\x0a','Your\x20account\x20is\x20temporarily\x20suspended.\x20You\x20can\x20view\x20your\x20dashboard\x20but\x20cannot\x20process\x20new\x20payments.\x0a\x0a','🏦\x20Method:\x20`','📝\x20Notes:\x20','🔔\x20You\x20will\x20now\x20receive\x20notifications\x20about:\x0a','\x0aCheck\x20spelling\x20and\x20try\x20again.','❌\x20An\x20error\x20occurred\x20while\x20verifying\x20data.','forEach','startsWith','🔍\x20*Debug\x20Information*\x0a\x0a','Failed\x20to\x20send\x20login\x20notification:','createdAt','Payment\x20expired','...\x22','📅\x20Date:\x20','findUnique','allSettled','__esModule','Telegram\x20bot\x20not\x20initialized,\x20cannot\x20send\x20notification','includes','sk_','👤\x20Sender:\x20`','remitterName','•\x20`','toLocaleString','❌\x20Failed\x20to\x20initialize\x20Telegram\x20bot:','✅\x20You\x20have\x20been\x20successfully\x20connected\x20to\x20the\x20notification\x20system!\x0a\x0a','✅\x20You\x20are\x20already\x20connected\x20to\x20shop\x20*','💸\x20Amount:\x20*','❌\x20Error:\x20`','📱\x20Login\x20notifications\x20disabled\x20for\x20shop\x20','create','txid','\x22\x20->\x20display\x20\x22','env','sendPayoutNotification','189432hEiIub','errorMessage','103341bCzgvz','🔔\x20You\x20receive\x20notifications\x20about:\x0a','•\x20Payment\x20status\x20changes\x0a','📱\x20Shop:\x20*','❌\x20Please\x20use\x20/start\x20command\x20first','\x0a💳\x20*Payment\x20Details:*\x0a','trim','split','🌐\x20IP\x20address:\x20`','🆔\x20Request\x20ID:\x20`','setupBotHandlers','Payment\x20chargeback','Username\x20must\x20contain\x20only\x20letters,\x20numbers\x20and\x20underscore\x20(3-50\x20characters).','Payout\x20rejected','Failed\x20to\x20send\x20API\x20error\x20notification:','adminNotes','endpoint','🔌\x20User\x20','shopSettings','❌\x20You\x20are\x20not\x20connected\x20to\x20a\x20shop.\x0a\x0a','\x20\x20\x20Username:\x20`','Error\x20handling\x20/start\x20command:','map','❌\x20Invalid\x20username\x20format:\x20`','findFirst','chargebackAmount','❌\x20Shop\x20with\x20username\x20`','entries','🛑\x20Telegram\x20bot\x20stopped','📊\x20Error\x20code:\x20`','notificationLogin','sendApiErrorNotification','update','customerIp','💻\x20Browser:\x20`','\x20verified\x20for\x20shop\x20','handleSingleLineVerification','default','log','`\x20is\x20suspended.\x0a\x0a','📝\x20Order\x20ID:\x20`','Check\x20the\x20key\x20and\x20try\x20again.\x0a\x0a','chat','`\x20(','botUsername','/status\x20-\x20check\x20connection\x20status\x0a','💰\x20Method:\x20`','TELEGRAM_BOT_TOKEN','\x20USDT*\x0a','`.\x0a\x0a','remitterIban','onText','🔔\x20Notifications\x20are\x20active\x0a\x0a','📅\x20Time:\x20','⚠️\x20Shop\x20`','\x20USD*\x0a','chargeback','Error\x20sending\x20shop\x20notification:','📛\x20Name:\x20`','✅\x20Welcome\x20back!\x0a\x0a','ACTIVE','\x0a⚠️\x20If\x20this\x20wasn\x27t\x20you,\x20change\x20your\x20password\x20immediately!','*\x0a\x0a','1111561ZNXNOk','Expected\x20key\x20format:\x20`pk_...`\x20or\x20`sk_...`','TelegramBotService','error','gateway',':\x20username=\x22','No\x20verified\x20Telegram\x20users\x20found\x20for\x20shop\x20','You\x20are\x20already\x20connected\x20to\x20shop:\x20*','⏳\x20The\x20payment\x20is\x20currently\x20being\x20processed\x20by\x20the\x20gateway.\x0a','🏦\x20IBAN:\x20`','updatedAt','Use\x20/status\x20to\x20check\x20status\x20or\x20/disconnect\x20to\x20disconnect.','warn','Failed\x20login\x20attempt','📧\x20Email:\x20`','requestId','Payment\x20failed','failed','toLocaleDateString','New\x20payment\x20created','30YMSjRB','16CtTxsb','en-US','17551BVphcZ','Error\x20handling\x20/status\x20command:','`\x20not\x20found.\x0a\x0a','chat\x20not\x20found','last_name','❌\x20Shop\x20`','100iHbYMp','join','telegramBotService','username','🔗\x20Endpoint:\x20`','../config/database','stopBot','Disconnect\x20the\x20previous\x20account\x20first\x20or\x20contact\x20administrator.','polling_error','unknown\x20shop','userAgent','cardLast4','Telegram\x20bot\x20polling\x20error:','SUSPENDED','getGatewayDisplayNameForTelegram','trapay_bot','telegramId','Commands:\x0a','•\x20New\x20payments\x0a',':\x20`','processing','🆔\x20Payment\x20ID:\x20`','96mocybS','initializeBot','shop','❌\x20An\x20error\x20occurred.\x20Please\x20try\x20again\x20later.','Telegram\x20bot\x20error:','`)\x0a','name','🗺️\x20Country:\x20`','blocked','message','🤖\x20Welcome\x20to\x20TRAPAY\x20notification\x20system!\x0a\x0a','❌\x20Invalid\x20API\x20key\x20format.\x0a\x0a','first_name','method','from','ipAddress','Use\x20/start\x20to\x20begin.','node-telegram-bot-api','orderId','1813176iJtdxR','sendLoginNotification','👤\x20Remitter:\x20`','findMany','notificationApiError','isVerified','❌\x20API\x20key\x20does\x20not\x20match\x20shop\x20`','Error\x20in\x20handleSingleLineVerification:','getBotInfo','✅\x20Notification\x20sent\x20to\x20Telegram\x20user\x20'];a54_0xb5d4=function(){return _0x53a2b8;};return a54_0xb5d4();}function a54_0x1475(_0x4cc415,_0x5bd176){const _0xb5d4e2=a54_0xb5d4();return a54_0x1475=function(_0x147531,_0x35a770){_0x147531=_0x147531-0xd3;let _0x1e079c=_0xb5d4e2[_0x147531];return _0x1e079c;},a54_0x1475(_0x4cc415,_0x5bd176);}exports['TelegramBotService']=TelegramBotService,exports[a54_0x29f3de(0xf5)]=new TelegramBotService();