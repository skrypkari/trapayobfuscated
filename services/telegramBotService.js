'use strict';const a54_0x4fb4a0=a54_0x2ddf;(function(_0x242fd9,_0x3ba6eb){const _0x237a6e=a54_0x2ddf,_0x3b0cb6=_0x242fd9();while(!![]){try{const _0x1cc0ba=parseInt(_0x237a6e(0xfe))/0x1*(-parseInt(_0x237a6e(0x122))/0x2)+parseInt(_0x237a6e(0x116))/0x3*(parseInt(_0x237a6e(0xdf))/0x4)+parseInt(_0x237a6e(0x14b))/0x5+parseInt(_0x237a6e(0xb4))/0x6*(parseInt(_0x237a6e(0xef))/0x7)+parseInt(_0x237a6e(0xeb))/0x8*(-parseInt(_0x237a6e(0xce))/0x9)+-parseInt(_0x237a6e(0xe7))/0xa*(-parseInt(_0x237a6e(0x151))/0xb)+-parseInt(_0x237a6e(0x148))/0xc;if(_0x1cc0ba===_0x3ba6eb)break;else _0x3b0cb6['push'](_0x3b0cb6['shift']());}catch(_0x89babb){_0x3b0cb6['push'](_0x3b0cb6['shift']());}}}(a54_0xcac3,0xa9e4d));var __importDefault=this&&this[a54_0x4fb4a0(0xd9)]||function(_0x33b275){const _0x55a58f=a54_0x4fb4a0;return _0x33b275&&_0x33b275[_0x55a58f(0x153)]?_0x33b275:{'default':_0x33b275};};function a54_0x2ddf(_0x192925,_0x291138){const _0xcac3b4=a54_0xcac3();return a54_0x2ddf=function(_0x2ddf89,_0x34a883){_0x2ddf89=_0x2ddf89-0x99;let _0x225638=_0xcac3b4[_0x2ddf89];return _0x225638;},a54_0x2ddf(_0x192925,_0x291138);}Object['defineProperty'](exports,a54_0x4fb4a0(0x153),{'value':!![]}),exports[a54_0x4fb4a0(0xac)]=exports['TelegramBotService']=void 0x0;const node_telegram_bot_api_1=__importDefault(require(a54_0x4fb4a0(0xcb))),database_1=__importDefault(require('../config/database')),gateway_1=require(a54_0x4fb4a0(0xbc));class TelegramBotService{constructor(){const _0xeb69d3=a54_0x4fb4a0;this['bot']=null,this[_0xeb69d3(0x14a)]=process[_0xeb69d3(0xb5)][_0xeb69d3(0x14d)]||'',this[_0xeb69d3(0x15c)]=process[_0xeb69d3(0xb5)][_0xeb69d3(0x106)]||'trapay_bot',this[_0xeb69d3(0x14a)]?this[_0xeb69d3(0x171)]():console[_0xeb69d3(0xc6)](_0xeb69d3(0x103));}[a54_0x4fb4a0(0x171)](){const _0xa193cc=a54_0x4fb4a0;try{this[_0xa193cc(0x169)]=new node_telegram_bot_api_1[(_0xa193cc(0x13c))](this[_0xa193cc(0x14a)],{'polling':!![]}),this['setupBotHandlers'](),console[_0xa193cc(0xea)]('✅\x20Telegram\x20bot\x20@'+this[_0xa193cc(0x15c)]+_0xa193cc(0x160));}catch(_0x20ce27){console[_0xa193cc(0xbe)]('❌\x20Failed\x20to\x20initialize\x20Telegram\x20bot:',_0x20ce27);}}[a54_0x4fb4a0(0x119)](){const _0x3c0b3f=a54_0x4fb4a0;if(!this['bot'])return;this[_0x3c0b3f(0x169)][_0x3c0b3f(0xf5)](/\/start/,async _0x1868d5=>{const _0x52ef6b=_0x3c0b3f,_0x1b78d2=_0x1868d5[_0x52ef6b(0xb8)]['id'],_0x3ba661=_0x1868d5[_0x52ef6b(0xa4)]?.['id'][_0x52ef6b(0xa0)](),_0x3e6e47=_0x1868d5[_0x52ef6b(0xa4)]?.[_0x52ef6b(0xe6)],_0x448366=_0x1868d5[_0x52ef6b(0xa4)]?.[_0x52ef6b(0x17e)],_0x13e25d=_0x1868d5[_0x52ef6b(0xa4)]?.[_0x52ef6b(0x11a)];if(!_0x3ba661)return;try{let _0x54cf91=await database_1[_0x52ef6b(0x13c)][_0x52ef6b(0xff)]['findUnique']({'where':{'telegramId':_0x3ba661},'include':{'shop':!![]}});!_0x54cf91?(_0x54cf91=await database_1[_0x52ef6b(0x13c)][_0x52ef6b(0xff)][_0x52ef6b(0x152)]({'data':{'telegramId':_0x3ba661,'username':_0x3e6e47,'firstName':_0x448366,'lastName':_0x13e25d,'isVerified':![],'shopId':null},'include':{'shop':!![]}}),console[_0x52ef6b(0xea)]('📱\x20Created\x20new\x20Telegram\x20user:\x20'+_0x3ba661+_0x52ef6b(0xba)+_0x3e6e47+')')):_0x54cf91=await database_1[_0x52ef6b(0x13c)][_0x52ef6b(0xff)][_0x52ef6b(0x99)]({'where':{'telegramId':_0x3ba661},'data':{'username':_0x3e6e47,'firstName':_0x448366,'lastName':_0x13e25d},'include':{'shop':!![]}}),_0x54cf91[_0x52ef6b(0x130)]&&_0x54cf91[_0x52ef6b(0x142)]&&_0x54cf91[_0x52ef6b(0x164)]?await this['bot']?.['sendMessage'](_0x1b78d2,_0x52ef6b(0xb2)+(_0x52ef6b(0xe9)+_0x54cf91['shop']['name']+'*\x0a')+(_0x52ef6b(0x115)+_0x54cf91['shop'][_0x52ef6b(0xe6)]+'`\x0a\x0a')+_0x52ef6b(0xb7)+_0x52ef6b(0x13f)+_0x52ef6b(0x12d)+_0x52ef6b(0x134)+'Commands:\x0a'+_0x52ef6b(0x108)+_0x52ef6b(0xcc),{'parse_mode':_0x52ef6b(0xc2)}):(_0x54cf91[_0x52ef6b(0x142)]&&!_0x54cf91[_0x52ef6b(0x130)]&&(await database_1[_0x52ef6b(0x13c)]['telegramUser'][_0x52ef6b(0x99)]({'where':{'telegramId':_0x3ba661},'data':{'shopId':null,'isVerified':![]}}),console['log'](_0x52ef6b(0x107)+_0x3ba661)),await this['bot']?.[_0x52ef6b(0x105)](_0x1b78d2,'🤖\x20Welcome\x20to\x20TRAPAY\x20notification\x20system!\x0a\x0a'+'To\x20receive\x20payment\x20notifications,\x20send\x20your\x20credentials\x20in\x20one\x20line:\x0a\x0a'+_0x52ef6b(0x137)+_0x52ef6b(0x16d)+_0x52ef6b(0x168)+_0x52ef6b(0xee),{'parse_mode':_0x52ef6b(0xc2)}));}catch(_0x20eea4){console[_0x52ef6b(0xbe)](_0x52ef6b(0xc1),_0x20eea4),await this[_0x52ef6b(0x169)]?.[_0x52ef6b(0x105)](_0x1b78d2,_0x52ef6b(0x126));}}),this[_0x3c0b3f(0x169)][_0x3c0b3f(0xf5)](/\/disconnect/,async _0x5bd469=>{const _0x52bf1f=_0x3c0b3f,_0x5d564e=_0x5bd469[_0x52bf1f(0xb8)]['id'],_0x28b661=_0x5bd469[_0x52bf1f(0xa4)]?.['id']['toString']();if(!_0x28b661)return;try{const _0x38e67a=await database_1[_0x52bf1f(0x13c)][_0x52bf1f(0xff)][_0x52bf1f(0x10c)]({'where':{'telegramId':_0x28b661},'include':{'shop':!![]}});if(!_0x38e67a||!_0x38e67a[_0x52bf1f(0x130)]||!_0x38e67a[_0x52bf1f(0x142)]){await this[_0x52bf1f(0x169)]?.['sendMessage'](_0x5d564e,'❌\x20You\x20are\x20not\x20connected\x20to\x20the\x20notification\x20system.');return;}const _0x46aac4=_0x38e67a[_0x52bf1f(0x164)]?.['name']||_0x52bf1f(0x123);await database_1['default'][_0x52bf1f(0xff)][_0x52bf1f(0x99)]({'where':{'telegramId':_0x28b661},'data':{'shopId':null,'isVerified':![]}}),console['log']('🔌\x20User\x20'+_0x28b661+_0x52bf1f(0xe3)+_0x38e67a[_0x52bf1f(0x142)]),await this['bot']?.['sendMessage'](_0x5d564e,_0x52bf1f(0xf4)+_0x46aac4+'*.\x0a\x0a'+_0x52bf1f(0xcf),{'parse_mode':_0x52bf1f(0xc2)});}catch(_0x1895bb){console['error'](_0x52bf1f(0x111),_0x1895bb),await this[_0x52bf1f(0x169)]?.[_0x52bf1f(0x105)](_0x5d564e,_0x52bf1f(0x126));}}),this[_0x3c0b3f(0x169)][_0x3c0b3f(0xf5)](/\/status/,async _0x2004e2=>{const _0x56876a=_0x3c0b3f,_0x566e49=_0x2004e2[_0x56876a(0xb8)]['id'],_0x28ec11=_0x2004e2['from']?.['id'][_0x56876a(0xa0)]();if(!_0x28ec11)return;try{const _0x64c456=await database_1[_0x56876a(0x13c)]['telegramUser']['findUnique']({'where':{'telegramId':_0x28ec11},'include':{'shop':!![]}});if(!_0x64c456){await this[_0x56876a(0x169)]?.[_0x56876a(0x105)](_0x566e49,_0x56876a(0x145)+_0x56876a(0x17d));return;}if(!_0x64c456['isVerified']||!_0x64c456['shopId']||!_0x64c456[_0x56876a(0x164)]){await this[_0x56876a(0x169)]?.[_0x56876a(0x105)](_0x566e49,'❌\x20You\x20are\x20not\x20connected\x20to\x20a\x20shop.\x0a\x0a'+_0x56876a(0x9d));return;}await this['bot']?.['sendMessage'](_0x566e49,_0x56876a(0x118)+(_0x56876a(0x158)+_0x64c456[_0x56876a(0x164)][_0x56876a(0x154)]+'*\x0a')+(_0x56876a(0xbd)+_0x64c456[_0x56876a(0x164)]['username']+'`\x0a')+(_0x56876a(0x10a)+_0x64c456[_0x56876a(0x161)][_0x56876a(0xa9)](_0x56876a(0x9f))+'\x0a\x0a')+_0x56876a(0xa3)+'Commands:\x0a'+_0x56876a(0xcc),{'parse_mode':'Markdown'});}catch(_0x37c28c){console[_0x56876a(0xbe)](_0x56876a(0x13e),_0x37c28c),await this[_0x56876a(0x169)]?.['sendMessage'](_0x566e49,'❌\x20An\x20error\x20occurred.\x20Please\x20try\x20again\x20later.');}}),this[_0x3c0b3f(0x169)]['onText'](/\/debug/,async _0x433210=>{const _0x334dda=_0x3c0b3f,_0x227103=_0x433210[_0x334dda(0xb8)]['id'],_0x52402b=_0x433210[_0x334dda(0xa4)]?.['id'][_0x334dda(0xa0)]();if(!_0x52402b)return;try{const _0x206df0=await database_1[_0x334dda(0x13c)][_0x334dda(0x164)][_0x334dda(0x135)]({'select':{'id':!![],'name':!![],'username':!![],'status':!![],'publicKey':!![]},'take':0xa});let _0x44524f=_0x334dda(0xf7);_0x44524f+='📱\x20Your\x20Telegram\x20ID:\x20`'+_0x52402b+_0x334dda(0x167),_0x44524f+=_0x334dda(0x9c),_0x206df0[_0x334dda(0x166)]((_0x3ff9b5,_0x260fc3)=>{const _0x57d635=_0x334dda;_0x44524f+=_0x260fc3+0x1+_0x57d635(0x16a)+_0x3ff9b5['name']+'*\x0a',_0x44524f+=_0x57d635(0xaf)+_0x3ff9b5[_0x57d635(0xe6)]+'`\x0a',_0x44524f+='\x20\x20\x20Status:\x20'+_0x3ff9b5[_0x57d635(0xc0)]+'\x0a',_0x44524f+='\x20\x20\x20Public\x20Key:\x20`'+_0x3ff9b5[_0x57d635(0x17a)][_0x57d635(0xb6)](0x0,0xf)+_0x57d635(0xd0);}),await this[_0x334dda(0x169)]?.['sendMessage'](_0x227103,_0x44524f,{'parse_mode':_0x334dda(0xc2)});}catch(_0x45bbd3){console[_0x334dda(0xbe)](_0x334dda(0x179),_0x45bbd3),await this['bot']?.[_0x334dda(0x105)](_0x227103,_0x334dda(0xbb));}}),this[_0x3c0b3f(0x169)]['on'](_0x3c0b3f(0xf3),async _0x10299f=>{const _0x1fcf53=_0x3c0b3f;if(_0x10299f['text']?.['startsWith']('/'))return;const _0x4440d9=_0x10299f[_0x1fcf53(0xb8)]['id'],_0x673a27=_0x10299f[_0x1fcf53(0xa4)]?.['id'][_0x1fcf53(0xa0)](),_0x4d032e=_0x10299f[_0x1fcf53(0xde)]?.[_0x1fcf53(0x11c)]();if(!_0x673a27||!_0x4d032e)return;try{const _0x364292=await database_1[_0x1fcf53(0x13c)]['telegramUser']['findUnique']({'where':{'telegramId':_0x673a27},'include':{'shop':!![]}});if(!_0x364292){await this[_0x1fcf53(0x169)]?.[_0x1fcf53(0x105)](_0x4440d9,_0x1fcf53(0x14e));return;}if(_0x364292[_0x1fcf53(0x130)]&&_0x364292[_0x1fcf53(0x142)]&&_0x364292['shop']){await this[_0x1fcf53(0x169)]?.[_0x1fcf53(0x105)](_0x4440d9,'✅\x20You\x20are\x20already\x20connected\x20to\x20shop\x20*'+_0x364292[_0x1fcf53(0x164)][_0x1fcf53(0x154)]+_0x1fcf53(0x177)+_0x1fcf53(0xd8),{'parse_mode':'Markdown'});return;}const _0x16fcd4=_0x4d032e[_0x1fcf53(0xd7)](/\s+/);if(_0x16fcd4[_0x1fcf53(0x10f)]!==0x2){await this[_0x1fcf53(0x169)]?.[_0x1fcf53(0x105)](_0x4440d9,_0x1fcf53(0x9b)+'📝\x20Format:\x20`username\x20api_key`\x0a\x0a'+'Example:\x0a'+'`appple\x20pk_aa6450d3f57afbefbb0f3f5be5ce6cca13037536afc5ccf14c81a6cbc7a07de5`\x0a\x0a'+(_0x1fcf53(0x178)+_0x16fcd4[_0x1fcf53(0x10f)]+_0x1fcf53(0xa7)+_0x16fcd4[_0x1fcf53(0xc4)](_0x3b1cc8=>'`'+_0x3b1cc8+'`')['join'](',\x20')),{'parse_mode':_0x1fcf53(0xc2)});return;}const [_0x19cdb0,_0x44790b]=_0x16fcd4;console['log'](_0x1fcf53(0xe5)+_0x673a27+_0x1fcf53(0x165)+_0x19cdb0+_0x1fcf53(0x11e)+_0x44790b[_0x1fcf53(0xb6)](0x0,0xa)+_0x1fcf53(0xd3)),await this['handleSingleLineVerification'](_0x4440d9,_0x673a27,_0x19cdb0,_0x44790b);}catch(_0x18cb9b){console[_0x1fcf53(0xbe)](_0x1fcf53(0x13b),_0x18cb9b),await this[_0x1fcf53(0x169)]?.[_0x1fcf53(0x105)](_0x4440d9,_0x1fcf53(0x126));}}),this[_0x3c0b3f(0x169)]['on'](_0x3c0b3f(0xbe),_0x4e2e54=>{const _0x37e244=_0x3c0b3f;console[_0x37e244(0xbe)](_0x37e244(0xaa),_0x4e2e54);}),this[_0x3c0b3f(0x169)]['on'](_0x3c0b3f(0xf9),_0x491dba=>{const _0x45a2d2=_0x3c0b3f;console[_0x45a2d2(0xbe)](_0x45a2d2(0x15a),_0x491dba);});}async['handleSingleLineVerification'](_0x3f5366,_0x1b2970,_0x3450e6,_0x545226){const _0xed9710=a54_0x4fb4a0;try{console[_0xed9710(0xea)](_0xed9710(0xe5)+_0x1b2970+_0xed9710(0x165)+_0x3450e6+_0xed9710(0x11e)+_0x545226[_0xed9710(0xb6)](0x0,0xa)+_0xed9710(0xd3));if(!_0x3450e6||_0x3450e6[_0xed9710(0x10f)]<0x3||_0x3450e6[_0xed9710(0x10f)]>0x32||!/^[a-zA-Z0-9_]+$/['test'](_0x3450e6)){await this[_0xed9710(0x169)]?.[_0xed9710(0x105)](_0x3f5366,_0xed9710(0xb9)+_0x3450e6+_0xed9710(0x167)+_0xed9710(0x141),{'parse_mode':_0xed9710(0xc2)});return;}if(!_0x545226||!_0x545226[_0xed9710(0x102)](_0xed9710(0x149))&&!_0x545226[_0xed9710(0x102)](_0xed9710(0x10b))){await this[_0xed9710(0x169)]?.['sendMessage'](_0x3f5366,_0xed9710(0x146)+_0xed9710(0x11b),{'parse_mode':_0xed9710(0xc2)});return;}const _0xf422b8=await database_1['default'][_0xed9710(0x164)]['findUnique']({'where':{'username':_0x3450e6},'select':{'id':!![],'name':!![],'username':!![],'status':!![],'publicKey':!![],'secretKey':!![]}});if(!_0xf422b8){const _0x4197e0=await database_1[_0xed9710(0x13c)][_0xed9710(0x164)][_0xed9710(0x135)]({'select':{'username':!![],'name':!![]},'take':0x5});let _0x5ed4a8='❌\x20Shop\x20with\x20username\x20`'+_0x3450e6+_0xed9710(0x13d);_0x4197e0[_0xed9710(0x10f)]>0x0?(_0x5ed4a8+=_0xed9710(0x138),_0x4197e0[_0xed9710(0x166)](_0x4127e5=>{const _0x8f9b63=_0xed9710;_0x5ed4a8+=_0x8f9b63(0xae)+_0x4127e5[_0x8f9b63(0xe6)]+_0x8f9b63(0x127)+_0x4127e5[_0x8f9b63(0x154)]+')\x0a';}),_0x5ed4a8+=_0xed9710(0xcd)):_0x5ed4a8+=_0xed9710(0xab);await this[_0xed9710(0x169)]?.['sendMessage'](_0x3f5366,_0x5ed4a8,{'parse_mode':_0xed9710(0xc2)});return;}if(_0xf422b8[_0xed9710(0xc0)]!=='ACTIVE'){await this[_0xed9710(0x169)]?.['sendMessage'](_0x3f5366,_0xed9710(0xd2)+_0x3450e6+_0xed9710(0x12a)+'Contact\x20administrator.',{'parse_mode':_0xed9710(0xc2)});return;}if(_0xf422b8[_0xed9710(0x17a)]!==_0x545226&&_0xf422b8[_0xed9710(0x17c)]!==_0x545226){await this[_0xed9710(0x169)]?.['sendMessage'](_0x3f5366,'❌\x20API\x20key\x20does\x20not\x20match\x20shop\x20`'+_0x3450e6+_0xed9710(0xd1)+_0xed9710(0x112)+'Expected\x20key\x20format:\x20`pk_...`\x20or\x20`sk_...`',{'parse_mode':_0xed9710(0xc2)});return;}const _0x16e68d=await database_1['default'][_0xed9710(0xff)][_0xed9710(0xdc)]({'where':{'shopId':_0xf422b8['id'],'isVerified':!![],'telegramId':{'not':_0x1b2970}}});if(_0x16e68d){await this[_0xed9710(0x169)]?.[_0xed9710(0x105)](_0x3f5366,'❌\x20Another\x20Telegram\x20account\x20is\x20already\x20connected\x20to\x20shop\x20`'+_0x3450e6+_0xed9710(0xd1)+_0xed9710(0x9a),{'parse_mode':_0xed9710(0xc2)});return;}await database_1['default'][_0xed9710(0xff)][_0xed9710(0x99)]({'where':{'telegramId':_0x1b2970},'data':{'shopId':_0xf422b8['id'],'isVerified':!![]}}),await this[_0xed9710(0x169)]?.['sendMessage'](_0x3f5366,_0xed9710(0xe0)+'✅\x20You\x20have\x20been\x20successfully\x20connected\x20to\x20the\x20notification\x20system!\x0a\x0a'+(_0xed9710(0xa1)+_0xf422b8['name']+'*\x0a')+(_0xed9710(0xbd)+_0xf422b8[_0xed9710(0xe6)]+_0xed9710(0x167))+_0xed9710(0x10e)+'•\x20New\x20payments\x0a'+'•\x20Payment\x20status\x20changes\x0a'+_0xed9710(0x128)+_0xed9710(0x156)+'Commands:\x0a'+_0xed9710(0x108)+'/disconnect\x20-\x20disconnect\x20from\x20notifications',{'parse_mode':_0xed9710(0xc2)}),console['log'](_0xed9710(0xa5)+_0x1b2970+_0xed9710(0x155)+_0xf422b8['username']+_0xed9710(0x150));}catch(_0x23912e){console[_0xed9710(0xbe)](_0xed9710(0x159),_0x23912e),await this['bot']?.['sendMessage'](_0x3f5366,_0xed9710(0xd5));}}async[a54_0x4fb4a0(0x17b)](_0x2f91bc,_0x51fef2,_0xec1349){const _0x1711cf=a54_0x4fb4a0;if(!this[_0x1711cf(0x169)]){console[_0x1711cf(0xc6)]('Telegram\x20bot\x20not\x20initialized,\x20cannot\x20send\x20notification');return;}try{const _0x3362eb=await database_1[_0x1711cf(0x13c)]['telegramUser'][_0x1711cf(0x135)]({'where':{'shopId':_0x2f91bc,'isVerified':!![]}});if(_0x3362eb['length']===0x0){console[_0x1711cf(0xea)]('No\x20verified\x20Telegram\x20users\x20found\x20for\x20shop\x20'+_0x2f91bc);return;}const _0x15f31d=_0x3362eb[_0x1711cf(0xc4)](async _0x1d2e01=>{const _0x10b13f=_0x1711cf;try{await this[_0x10b13f(0x169)]?.[_0x10b13f(0x105)](_0x1d2e01['telegramId'],_0x51fef2,_0xec1349),console[_0x10b13f(0xea)](_0x10b13f(0x124)+_0x1d2e01[_0x10b13f(0xe1)]);}catch(_0x5f132b){console[_0x10b13f(0xbe)](_0x10b13f(0x139)+_0x1d2e01[_0x10b13f(0xe1)]+':',_0x5f132b),_0x5f132b instanceof Error&&(_0x5f132b[_0x10b13f(0xf3)][_0x10b13f(0x16e)](_0x10b13f(0xdd))||_0x5f132b[_0x10b13f(0xf3)][_0x10b13f(0x16e)](_0x10b13f(0x147))||_0x5f132b['message'][_0x10b13f(0x16e)]('user\x20is\x20deactivated'))&&(await database_1['default'][_0x10b13f(0xff)][_0x10b13f(0x99)]({'where':{'id':_0x1d2e01['id']},'data':{'isVerified':![]}}),console[_0x10b13f(0xea)](_0x10b13f(0xfb)+_0x1d2e01[_0x10b13f(0xe1)]+'\x20marked\x20as\x20unverified\x20due\x20to\x20delivery\x20failure'));}});await Promise[_0x1711cf(0xe2)](_0x15f31d);}catch(_0x37a942){console[_0x1711cf(0xbe)](_0x1711cf(0x113),_0x37a942);}}async[a54_0x4fb4a0(0xf0)](_0x5ebcfa,_0x584fd3,_0x1a269e){const _0x3f3c2a=a54_0x4fb4a0,_0x2b6236={'created':'🆕','paid':'✅','failed':'❌','expired':'⏰','refund':'🔄','chargeback':'⚠️','processing':'⚙️'},_0x3246e8={'created':_0x3f3c2a(0xf2),'paid':'Payment\x20successfully\x20paid','failed':_0x3f3c2a(0x144),'expired':'Payment\x20expired','refund':_0x3f3c2a(0xec),'chargeback':_0x3f3c2a(0x131),'processing':_0x3f3c2a(0x162)},_0x577ca3=_0x2b6236[_0x1a269e],_0x144d60=_0x3246e8[_0x1a269e],_0x1d9e09=(0x0,gateway_1[_0x3f3c2a(0x12e)])(_0x584fd3[_0x3f3c2a(0x15d)]);console[_0x3f3c2a(0xea)](_0x3f3c2a(0x136)+_0x584fd3[_0x3f3c2a(0x15d)]+'\x22\x20->\x20display\x20\x22'+_0x1d9e09+'\x22');let _0x159dd1=_0x577ca3+'\x20*'+_0x144d60+_0x3f3c2a(0x15e)+(_0x3f3c2a(0x174)+_0x584fd3['amount']+'\x20'+_0x584fd3['currency']+'*\x0a')+(_0x3f3c2a(0xc5)+(_0x584fd3[_0x3f3c2a(0x173)]||_0x584fd3['id'])+'`\x0a')+(_0x3f3c2a(0x16c)+_0x584fd3['id']+'`\x0a')+('🏪\x20Gateway:\x20`'+_0x1d9e09+'`\x0a')+(_0x3f3c2a(0x100)+new Date(_0x584fd3[_0x3f3c2a(0x15b)])[_0x3f3c2a(0x104)](_0x3f3c2a(0x9f))+'\x0a');if(_0x584fd3[_0x3f3c2a(0x121)]||_0x584fd3[_0x3f3c2a(0xbf)]||_0x584fd3['remitterIban']||_0x584fd3[_0x3f3c2a(0xda)]||_0x584fd3[_0x3f3c2a(0x114)]){_0x159dd1+=_0x3f3c2a(0xb1);_0x584fd3[_0x3f3c2a(0x121)]&&(_0x159dd1+=_0x3f3c2a(0x175)+_0x584fd3[_0x3f3c2a(0x121)]+'`\x0a');_0x584fd3[_0x3f3c2a(0xbf)]&&(_0x159dd1+='📧\x20Email:\x20`'+_0x584fd3[_0x3f3c2a(0xbf)]+'`\x0a');_0x584fd3[_0x3f3c2a(0x14f)]&&(_0x159dd1+=_0x3f3c2a(0xb0)+_0x584fd3[_0x3f3c2a(0x14f)]+'`\x0a');_0x584fd3[_0x3f3c2a(0xda)]&&(_0x159dd1+='🌐\x20IP:\x20`'+_0x584fd3[_0x3f3c2a(0xda)]+'`\x0a');if(_0x584fd3[_0x3f3c2a(0x114)]){const _0x442069=_0x584fd3[_0x3f3c2a(0x114)][_0x3f3c2a(0x10f)]>0x32?_0x584fd3[_0x3f3c2a(0x114)][_0x3f3c2a(0xb6)](0x0,0x32)+_0x3f3c2a(0x125):_0x584fd3[_0x3f3c2a(0x114)];_0x159dd1+=_0x3f3c2a(0x170)+_0x442069+'`\x0a';}}_0x1a269e===_0x3f3c2a(0xd4)&&_0x584fd3[_0x3f3c2a(0xc9)]&&(_0x159dd1+='💸\x20Penalty\x20amount:\x20*'+_0x584fd3[_0x3f3c2a(0xc9)]+'\x20USDT*\x0a'),_0x1a269e===_0x3f3c2a(0xc3)&&(_0x159dd1+=_0x3f3c2a(0xc7)),_0x584fd3[_0x3f3c2a(0x16b)]&&(_0x159dd1+=_0x3f3c2a(0xf6)+_0x584fd3[_0x3f3c2a(0x16b)]+'\x0a'),await this[_0x3f3c2a(0x17b)](_0x5ebcfa,_0x159dd1,{'parse_mode':'Markdown'});}async['sendPayoutNotification'](_0x1e420d,_0x5426ed,_0x571d13){const _0x30b4d1=a54_0x4fb4a0,_0x4c5462={'created':'📤','completed':'✅','rejected':'❌'},_0x339ba4={'created':_0x30b4d1(0x132),'completed':_0x30b4d1(0xc8),'rejected':_0x30b4d1(0x14c)},_0x286da1=_0x4c5462[_0x571d13],_0xbfc798=_0x339ba4[_0x571d13],_0x3bf7cd=_0x286da1+'\x20*'+_0xbfc798+'*\x0a\x0a'+('💸\x20Amount:\x20*'+_0x5426ed[_0x30b4d1(0x176)]+'\x20USD*\x0a')+(_0x30b4d1(0x9e)+_0x5426ed[_0x30b4d1(0x110)]+'`\x0a')+(_0x30b4d1(0x117)+_0x5426ed['id']+'`\x0a')+(_0x30b4d1(0x100)+new Date(_0x5426ed[_0x30b4d1(0x15b)])[_0x30b4d1(0x104)](_0x30b4d1(0x9f))+'\x0a')+(_0x5426ed['txid']?_0x30b4d1(0x13a)+_0x5426ed[_0x30b4d1(0xfd)]+'`':'');await this[_0x30b4d1(0x17b)](_0x1e420d,_0x3bf7cd,{'parse_mode':_0x30b4d1(0xc2)});}async['sendLoginNotification'](_0x5432c,_0x469941){const _0x5c0206=a54_0x4fb4a0;try{const _0x454851=await database_1[_0x5c0206(0x13c)][_0x5c0206(0x11f)]['findUnique']({'where':{'shopId':_0x5432c},'select':{'notificationLogin':!![]}});if(!_0x454851?.[_0x5c0206(0xe8)]){console[_0x5c0206(0xea)](_0x5c0206(0x157)+_0x5432c);return;}const _0x180013=_0x469941[_0x5c0206(0x16f)]?'🔐':'🚨',_0x24c9c9=_0x469941[_0x5c0206(0x16f)]?'Successful\x20login':_0x5c0206(0x133);let _0x56d935=_0x180013+'\x20*'+_0x24c9c9+_0x5c0206(0x15e)+(_0x5c0206(0xbd)+_0x469941[_0x5c0206(0xe6)]+'`\x0a')+(_0x5c0206(0x120)+_0x469941[_0x5c0206(0xd6)][_0x5c0206(0x104)](_0x5c0206(0x9f))+'\x0a');_0x469941[_0x5c0206(0x140)]&&(_0x56d935+=_0x5c0206(0xf8)+_0x469941[_0x5c0206(0x140)]+'`\x0a');if(_0x469941[_0x5c0206(0x12c)]){const _0x1ecc40=_0x469941[_0x5c0206(0x12c)][_0x5c0206(0x10f)]>0x32?_0x469941[_0x5c0206(0x12c)][_0x5c0206(0xb6)](0x0,0x32)+_0x5c0206(0x125):_0x469941[_0x5c0206(0x12c)];_0x56d935+='💻\x20Browser:\x20`'+_0x1ecc40+'`\x0a';}!_0x469941[_0x5c0206(0x16f)]&&(_0x56d935+=_0x5c0206(0xfa)),await this[_0x5c0206(0x17b)](_0x5432c,_0x56d935,{'parse_mode':_0x5c0206(0xc2)}),console[_0x5c0206(0xea)](_0x5c0206(0xe4)+_0x5432c+':\x20'+(_0x469941['success']?'success':_0x5c0206(0x11d)));}catch(_0x4b4e98){console[_0x5c0206(0xbe)](_0x5c0206(0xf1),_0x4b4e98);}}async[a54_0x4fb4a0(0x15f)](_0x3b6213,_0x495e44){const _0x4f118c=a54_0x4fb4a0;try{const _0x480cc5=await database_1['default'][_0x4f118c(0x11f)]['findUnique']({'where':{'shopId':_0x3b6213},'select':{'notificationApiError':!![]}});if(!_0x480cc5?.[_0x4f118c(0xb3)]){console['log'](_0x4f118c(0x163)+_0x3b6213);return;}let _0x434ced=_0x4f118c(0xa6)+(_0x4f118c(0x10d)+_0x495e44[_0x4f118c(0x110)]+'\x20'+_0x495e44[_0x4f118c(0xad)]+'`\x0a')+(_0x4f118c(0x120)+_0x495e44[_0x4f118c(0xd6)]['toLocaleString'](_0x4f118c(0x9f))+'\x0a');_0x495e44['statusCode']&&(_0x434ced+=_0x4f118c(0x12b)+_0x495e44[_0x4f118c(0x101)]+'`\x0a'),_0x434ced+=_0x4f118c(0xa2)+_0x495e44[_0x4f118c(0x129)]+'`\x0a',_0x495e44[_0x4f118c(0xa8)]&&(_0x434ced+=_0x4f118c(0x143)+_0x495e44[_0x4f118c(0xa8)]+'`\x0a'),_0x434ced+=_0x4f118c(0x172),await this[_0x4f118c(0x17b)](_0x3b6213,_0x434ced,{'parse_mode':_0x4f118c(0xc2)}),console[_0x4f118c(0xea)]('✅\x20API\x20error\x20notification\x20sent\x20for\x20shop\x20'+_0x3b6213+':\x20'+_0x495e44[_0x4f118c(0xad)]);}catch(_0x38095d){console[_0x4f118c(0xbe)](_0x4f118c(0xfc),_0x38095d);}}async['sendCustomNotification'](_0x26be18,_0x2423b6,_0x266d6d){const _0x4dba88=a54_0x4fb4a0;let _0xc10414='🔔\x20*'+_0x2423b6+_0x4dba88(0x15e);for(const [_0x187950,_0x1908f7]of Object[_0x4dba88(0x109)](_0x266d6d)){_0x1908f7!==null&&_0x1908f7!==undefined&&(_0xc10414+=_0x187950+':\x20`'+_0x1908f7+'`\x0a');}await this[_0x4dba88(0x17b)](_0x26be18,_0xc10414,{'parse_mode':'Markdown'});}['getBotInfo'](){const _0x213756=a54_0x4fb4a0;return{'isActive':!!this[_0x213756(0x169)],'username':this[_0x213756(0x15c)]};}[a54_0x4fb4a0(0xed)](){const _0x5b2015=a54_0x4fb4a0;this[_0x5b2015(0x169)]&&(this[_0x5b2015(0x169)][_0x5b2015(0xca)](),this[_0x5b2015(0x169)]=null,console[_0x5b2015(0xea)](_0x5b2015(0x12f)));}}function a54_0xcac3(){const _0x25ecf3=['Use\x20/status\x20to\x20check\x20status\x20or\x20/disconnect\x20to\x20disconnect.','__importDefault','customerIp','TelegramBotService','findFirst','blocked','text','4EQbPji','🎉\x20*Congratulations!*\x0a\x0a','telegramId','allSettled','\x20disconnected\x20from\x20shop\x20','✅\x20Login\x20notification\x20sent\x20for\x20shop\x20','🔄\x20Processing\x20single-line\x20verification\x20for\x20user\x20','username','10RYijwB','notificationLogin','You\x20are\x20already\x20connected\x20to\x20shop:\x20*','log','3690752ErGmbX','Payment\x20refund','stopBot','❗️\x20Make\x20sure\x20to\x20separate\x20username\x20and\x20API\x20key\x20with\x20a\x20space!','868rKeMoL','sendPaymentNotification','Failed\x20to\x20send\x20login\x20notification:','New\x20payment\x20created','message','✅\x20You\x20have\x20been\x20successfully\x20disconnected\x20from\x20shop\x20*','onText','📝\x20Notes:\x20','🔍\x20*Debug\x20Information*\x0a\x0a','🌐\x20IP\x20address:\x20`','polling_error','\x0a⚠️\x20If\x20this\x20wasn\x27t\x20you,\x20change\x20your\x20password\x20immediately!','User\x20','Failed\x20to\x20send\x20API\x20error\x20notification:','txid','58QFhFqA','telegramUser','📅\x20Date:\x20','statusCode','startsWith','TELEGRAM_BOT_TOKEN\x20not\x20found\x20in\x20environment\x20variables','toLocaleString','sendMessage','TELEGRAM_BOT_USERNAME','🔄\x20Reset\x20incomplete\x20verification\x20for\x20user\x20','/status\x20-\x20check\x20connection\x20status\x0a','entries','📅\x20Connection\x20date:\x20','sk_','findUnique','🔗\x20Endpoint:\x20`','🔔\x20You\x20will\x20now\x20receive\x20notifications\x20about:\x0a','length','method','Error\x20handling\x20/disconnect\x20command:','Check\x20the\x20key\x20and\x20try\x20again.\x0a\x0a','Error\x20sending\x20shop\x20notification:','customerUa','Username:\x20`','3674226lhOFxH','🆔\x20Payout\x20ID:\x20`','📊\x20*Connection\x20Status*\x0a\x0a','setupBotHandlers','last_name','API\x20key\x20must\x20start\x20with\x20`pk\x5c_`\x20or\x20`sk\x5c_`.','trim','failed','\x22,\x20apiKey=\x22','shopSettings','📅\x20Time:\x20','customerName','40398IfisZO','unknown\x20shop','✅\x20Notification\x20sent\x20to\x20Telegram\x20user\x20','...','❌\x20An\x20error\x20occurred.\x20Please\x20try\x20again\x20later.','`\x20(','•\x20Payouts\x0a','errorMessage','`\x20is\x20inactive.\x0a\x0a','📊\x20Error\x20code:\x20`','userAgent','•\x20Payment\x20status\x20changes\x0a','getGatewayDisplayNameForTelegram','🛑\x20Telegram\x20bot\x20stopped','isVerified','Payment\x20chargeback','New\x20payout\x20created','Failed\x20login\x20attempt','•\x20Payouts\x0a\x0a','findMany','📱\x20Telegram\x20notification:\x20gateway\x20\x22','📝\x20Format:\x20`username\x20api_key`\x0a\x0a','Available\x20usernames:\x0a','❌\x20Failed\x20to\x20send\x20notification\x20to\x20Telegram\x20user\x20','🔗\x20TXID:\x20`','Error\x20handling\x20message:','default','`\x20not\x20found.\x0a\x0a','Error\x20handling\x20/status\x20command:','•\x20New\x20payments\x0a','ipAddress','Username\x20must\x20contain\x20only\x20letters,\x20numbers\x20and\x20underscore\x20(3-50\x20characters).','shopId','🆔\x20Request\x20ID:\x20`','Payment\x20failed','❌\x20You\x20are\x20not\x20registered\x20in\x20the\x20system.\x0a\x0a','❌\x20Invalid\x20API\x20key\x20format.\x0a\x0a','chat\x20not\x20found','4505796jxGieg','pk_','botToken','1355655cpbyzv','Payout\x20rejected','TELEGRAM_BOT_TOKEN','❌\x20Please\x20use\x20/start\x20command\x20first','remitterIban','\x20via\x20single-line\x20input','1020283ICXsbB','create','__esModule','name','\x20verified\x20for\x20shop\x20','•\x20Important\x20events\x0a\x0a','📱\x20Login\x20notifications\x20disabled\x20for\x20shop\x20','✅\x20Connected\x20to\x20shop:\x20*','Error\x20in\x20handleSingleLineVerification:','Telegram\x20bot\x20polling\x20error:','createdAt','botUsername','gateway','*\x0a\x0a','sendApiErrorNotification','\x20initialized\x20successfully','updatedAt','Payment\x20is\x20being\x20processed','📱\x20API\x20error\x20notifications\x20disabled\x20for\x20shop\x20','shop',':\x20username=\x22','forEach','`\x0a\x0a','`appple\x20pk_aa6450d3f57afbefbb0f3f5be5ce6cca13037536afc5ccf14c81a6cbc7a07de5`\x0a\x0a','bot','.\x20*','adminNotes','🆔\x20Payment\x20ID:\x20`','Example:\x0a','includes','success','💻\x20Browser:\x20`','initializeBot','\x0a💡\x20Check\x20your\x20request\x20or\x20contact\x20support.','orderId','💰\x20Amount:\x20*','📛\x20Name:\x20`','amount','*.\x0a\x0a','You\x20sent\x20','Error\x20handling\x20/debug\x20command:','publicKey','sendShopNotification','secretKey','Use\x20/start\x20to\x20begin.','first_name','update','Disconnect\x20the\x20previous\x20account\x20first\x20or\x20contact\x20administrator.','❌\x20Invalid\x20format.\x20Please\x20send\x20exactly\x202\x20parts\x20separated\x20by\x20space:\x0a\x0a','🏪\x20Available\x20shops\x20in\x20system:\x0a','Use\x20/start\x20to\x20connect.','🏦\x20Method:\x20`','en-US','toString','📱\x20Shop:\x20*','❌\x20Error:\x20`','🔔\x20Notifications\x20are\x20active\x0a\x0a','from','✅\x20Telegram\x20user\x20','🚨\x20*API\x20Error*\x0a\x0a','\x20parts:\x20','requestId','toLocaleDateString','Telegram\x20bot\x20error:','Check\x20spelling\x20and\x20try\x20again.','telegramBotService','endpoint','•\x20`','\x20\x20\x20Username:\x20`','🏦\x20IBAN:\x20`','\x0a👤\x20*Customer\x20Information:*\x0a','✅\x20Welcome\x20back!\x0a\x0a','notificationApiError','53982eXnxdU','env','substring','🔔\x20You\x20receive\x20notifications\x20about:\x0a','chat','❌\x20Invalid\x20username\x20format:\x20`','\x20(@','❌\x20Error\x20getting\x20debug\x20information.','../types/gateway','👤\x20Username:\x20`','error','customerEmail','status','Error\x20handling\x20/start\x20command:','Markdown','processing','map','📝\x20Order\x20ID:\x20`','warn','⏳\x20The\x20payment\x20is\x20currently\x20being\x20processed\x20by\x20the\x20gateway.\x0a','Payout\x20completed','chargebackAmount','stopPolling','node-telegram-bot-api','/disconnect\x20-\x20disconnect\x20from\x20notifications','\x0aCheck\x20spelling\x20and\x20try\x20again.','9lMdUoD','To\x20reconnect,\x20use\x20the\x20/start\x20command','...`\x0a\x0a','`.\x0a\x0a','❌\x20Shop\x20`','...\x22','chargeback','❌\x20An\x20error\x20occurred\x20while\x20verifying\x20data.','timestamp','split'];a54_0xcac3=function(){return _0x25ecf3;};return a54_0xcac3();}exports[a54_0x4fb4a0(0xdb)]=TelegramBotService,exports[a54_0x4fb4a0(0xac)]=new TelegramBotService();