'use strict';const a54_0xfe576f=a54_0xf3e8;(function(_0x3cd5e9,_0x13a7c3){const _0x2b9c5b=a54_0xf3e8,_0x278657=_0x3cd5e9();while(!![]){try{const _0x1ccb35=-parseInt(_0x2b9c5b(0x176))/0x1*(parseInt(_0x2b9c5b(0x1c1))/0x2)+-parseInt(_0x2b9c5b(0x181))/0x3+parseInt(_0x2b9c5b(0x19c))/0x4+parseInt(_0x2b9c5b(0x1e6))/0x5*(parseInt(_0x2b9c5b(0x1b7))/0x6)+-parseInt(_0x2b9c5b(0x191))/0x7+parseInt(_0x2b9c5b(0x1c7))/0x8*(parseInt(_0x2b9c5b(0x21b))/0x9)+-parseInt(_0x2b9c5b(0x1a2))/0xa;if(_0x1ccb35===_0x13a7c3)break;else _0x278657['push'](_0x278657['shift']());}catch(_0x5cc9aa){_0x278657['push'](_0x278657['shift']());}}}(a54_0xdda6,0x1afc0));var __importDefault=this&&this[a54_0xfe576f(0x1fc)]||function(_0x11910a){return _0x11910a&&_0x11910a['__esModule']?_0x11910a:{'default':_0x11910a};};Object['defineProperty'](exports,a54_0xfe576f(0x20e),{'value':!![]}),exports[a54_0xfe576f(0x1ca)]=exports[a54_0xfe576f(0x192)]=void 0x0;const node_telegram_bot_api_1=__importDefault(require(a54_0xfe576f(0x205))),database_1=__importDefault(require(a54_0xfe576f(0x1b6))),gateway_1=require(a54_0xfe576f(0x21a));function a54_0xf3e8(_0x492389,_0x23b53f){const _0xdda6ba=a54_0xdda6();return a54_0xf3e8=function(_0xf3e8b,_0x41dea9){_0xf3e8b=_0xf3e8b-0x144;let _0x18c2a9=_0xdda6ba[_0xf3e8b];return _0x18c2a9;},a54_0xf3e8(_0x492389,_0x23b53f);}class TelegramBotService{constructor(){const _0x35abb7=a54_0xfe576f;this[_0x35abb7(0x1d7)]=null,this[_0x35abb7(0x173)]=process[_0x35abb7(0x151)][_0x35abb7(0x1a3)]||'',this['botUsername']=process[_0x35abb7(0x151)][_0x35abb7(0x1da)]||_0x35abb7(0x19f),this['botToken']?this[_0x35abb7(0x18f)]():console[_0x35abb7(0x146)](_0x35abb7(0x144));}[a54_0xfe576f(0x18f)](){const _0x5821c0=a54_0xfe576f;try{this[_0x5821c0(0x1d7)]=new node_telegram_bot_api_1['default'](this[_0x5821c0(0x173)],{'polling':!![]}),this[_0x5821c0(0x1fa)](),console[_0x5821c0(0x152)](_0x5821c0(0x199)+this[_0x5821c0(0x1e3)]+_0x5821c0(0x1db));}catch(_0x5ca416){console['error'](_0x5821c0(0x188),_0x5ca416);}}['setupBotHandlers'](){const _0x3348ef=a54_0xfe576f;if(!this['bot'])return;this[_0x3348ef(0x1d7)][_0x3348ef(0x1c6)](/\/start/,async _0x3010f1=>{const _0x59c51f=_0x3348ef,_0x381b60=_0x3010f1[_0x59c51f(0x1d3)]['id'],_0x36a3f8=_0x3010f1[_0x59c51f(0x1e0)]?.['id'][_0x59c51f(0x1fe)](),_0x29658f=_0x3010f1[_0x59c51f(0x1e0)]?.[_0x59c51f(0x1a6)],_0x58ae46=_0x3010f1[_0x59c51f(0x1e0)]?.[_0x59c51f(0x1ea)],_0x2a277d=_0x3010f1[_0x59c51f(0x1e0)]?.[_0x59c51f(0x177)];if(!_0x36a3f8)return;try{let _0x46e0ed=await database_1[_0x59c51f(0x166)]['telegramUser'][_0x59c51f(0x1cb)]({'where':{'telegramId':_0x36a3f8},'include':{'shop':!![]}});!_0x46e0ed?(_0x46e0ed=await database_1[_0x59c51f(0x166)][_0x59c51f(0x20d)][_0x59c51f(0x16c)]({'data':{'telegramId':_0x36a3f8,'username':_0x29658f,'firstName':_0x58ae46,'lastName':_0x2a277d,'isVerified':![],'shopId':null},'include':{'shop':!![]}}),console['log']('📱\x20Created\x20new\x20Telegram\x20user:\x20'+_0x36a3f8+_0x59c51f(0x145)+_0x29658f+')')):_0x46e0ed=await database_1['default'][_0x59c51f(0x20d)][_0x59c51f(0x1f2)]({'where':{'telegramId':_0x36a3f8},'data':{'username':_0x29658f,'firstName':_0x58ae46,'lastName':_0x2a277d},'include':{'shop':!![]}}),_0x46e0ed[_0x59c51f(0x218)]&&_0x46e0ed[_0x59c51f(0x204)]&&_0x46e0ed[_0x59c51f(0x1ef)]?await this[_0x59c51f(0x1d7)]?.['sendMessage'](_0x381b60,_0x59c51f(0x1f0)+(_0x59c51f(0x178)+_0x46e0ed[_0x59c51f(0x1ef)][_0x59c51f(0x1e5)]+'*\x0a')+(_0x59c51f(0x1d0)+_0x46e0ed['shop'][_0x59c51f(0x1a6)]+_0x59c51f(0x217))+_0x59c51f(0x1cc)+'•\x20New\x20payments\x0a'+_0x59c51f(0x190)+_0x59c51f(0x172)+_0x59c51f(0x207)+'/status\x20-\x20check\x20connection\x20status\x0a'+_0x59c51f(0x212),{'parse_mode':_0x59c51f(0x149)}):(_0x46e0ed[_0x59c51f(0x204)]&&!_0x46e0ed[_0x59c51f(0x218)]&&(await database_1[_0x59c51f(0x166)]['telegramUser'][_0x59c51f(0x1f2)]({'where':{'telegramId':_0x36a3f8},'data':{'shopId':null,'isVerified':![]}}),console['log'](_0x59c51f(0x1a5)+_0x36a3f8)),await this[_0x59c51f(0x1d7)]?.[_0x59c51f(0x1bc)](_0x381b60,_0x59c51f(0x1cf)+'To\x20receive\x20payment\x20notifications,\x20send\x20your\x20credentials\x20in\x20one\x20line:\x0a\x0a'+_0x59c51f(0x1b0)+_0x59c51f(0x1ba)+_0x59c51f(0x222)+_0x59c51f(0x1f4),{'parse_mode':_0x59c51f(0x149)}));}catch(_0x366c55){console[_0x59c51f(0x20f)](_0x59c51f(0x206),_0x366c55),await this[_0x59c51f(0x1d7)]?.['sendMessage'](_0x381b60,_0x59c51f(0x165));}}),this['bot'][_0x3348ef(0x1c6)](/\/disconnect/,async _0x58c42a=>{const _0xbb57eb=_0x3348ef,_0x53d8fb=_0x58c42a['chat']['id'],_0x5b25e7=_0x58c42a['from']?.['id'][_0xbb57eb(0x1fe)]();if(!_0x5b25e7)return;try{const _0x3e5dd4=await database_1[_0xbb57eb(0x166)][_0xbb57eb(0x20d)]['findUnique']({'where':{'telegramId':_0x5b25e7},'include':{'shop':!![]}});if(!_0x3e5dd4||!_0x3e5dd4[_0xbb57eb(0x218)]||!_0x3e5dd4[_0xbb57eb(0x204)]){await this[_0xbb57eb(0x1d7)]?.[_0xbb57eb(0x1bc)](_0x53d8fb,_0xbb57eb(0x197));return;}const _0x3cf93f=_0x3e5dd4[_0xbb57eb(0x1ef)]?.[_0xbb57eb(0x1e5)]||_0xbb57eb(0x1e9);await database_1['default'][_0xbb57eb(0x20d)]['update']({'where':{'telegramId':_0x5b25e7},'data':{'shopId':null,'isVerified':![]}}),console[_0xbb57eb(0x152)](_0xbb57eb(0x174)+_0x5b25e7+_0xbb57eb(0x183)+_0x3e5dd4[_0xbb57eb(0x204)]),await this[_0xbb57eb(0x1d7)]?.[_0xbb57eb(0x1bc)](_0x53d8fb,_0xbb57eb(0x16a)+_0x3cf93f+_0xbb57eb(0x223)+_0xbb57eb(0x1cd),{'parse_mode':'Markdown'});}catch(_0x196eae){console['error']('Error\x20handling\x20/disconnect\x20command:',_0x196eae),await this[_0xbb57eb(0x1d7)]?.[_0xbb57eb(0x1bc)](_0x53d8fb,'❌\x20An\x20error\x20occurred.\x20Please\x20try\x20again\x20later.');}}),this[_0x3348ef(0x1d7)][_0x3348ef(0x1c6)](/\/status/,async _0x1af7d6=>{const _0x1ae1d1=_0x3348ef,_0x92f9bd=_0x1af7d6[_0x1ae1d1(0x1d3)]['id'],_0x657e84=_0x1af7d6[_0x1ae1d1(0x1e0)]?.['id']['toString']();if(!_0x657e84)return;try{const _0x126a69=await database_1[_0x1ae1d1(0x166)]['telegramUser'][_0x1ae1d1(0x1cb)]({'where':{'telegramId':_0x657e84},'include':{'shop':!![]}});if(!_0x126a69){await this[_0x1ae1d1(0x1d7)]?.[_0x1ae1d1(0x1bc)](_0x92f9bd,'❌\x20You\x20are\x20not\x20registered\x20in\x20the\x20system.\x0a\x0a'+_0x1ae1d1(0x1a0));return;}if(!_0x126a69[_0x1ae1d1(0x218)]||!_0x126a69[_0x1ae1d1(0x204)]||!_0x126a69[_0x1ae1d1(0x1ef)]){await this[_0x1ae1d1(0x1d7)]?.[_0x1ae1d1(0x1bc)](_0x92f9bd,'❌\x20You\x20are\x20not\x20connected\x20to\x20a\x20shop.\x0a\x0a'+'Use\x20/start\x20to\x20connect.');return;}await this[_0x1ae1d1(0x1d7)]?.[_0x1ae1d1(0x1bc)](_0x92f9bd,'📊\x20*Connection\x20Status*\x0a\x0a'+(_0x1ae1d1(0x1a4)+_0x126a69['shop'][_0x1ae1d1(0x1e5)]+'*\x0a')+(_0x1ae1d1(0x187)+_0x126a69[_0x1ae1d1(0x1ef)][_0x1ae1d1(0x1a6)]+'`\x0a')+(_0x1ae1d1(0x19a)+_0x126a69['updatedAt']['toLocaleDateString'](_0x1ae1d1(0x163))+'\x0a\x0a')+_0x1ae1d1(0x148)+'Commands:\x0a'+_0x1ae1d1(0x212),{'parse_mode':_0x1ae1d1(0x149)});}catch(_0x5e53ef){console[_0x1ae1d1(0x20f)](_0x1ae1d1(0x18c),_0x5e53ef),await this[_0x1ae1d1(0x1d7)]?.[_0x1ae1d1(0x1bc)](_0x92f9bd,_0x1ae1d1(0x165));}}),this[_0x3348ef(0x1d7)]['onText'](/\/debug/,async _0x5d0b2d=>{const _0x49c19c=_0x3348ef,_0x4ecd20=_0x5d0b2d[_0x49c19c(0x1d3)]['id'],_0x22b826=_0x5d0b2d[_0x49c19c(0x1e0)]?.['id'][_0x49c19c(0x1fe)]();if(!_0x22b826)return;try{const _0x3adfca=await database_1[_0x49c19c(0x166)][_0x49c19c(0x1ef)][_0x49c19c(0x194)]({'select':{'id':!![],'name':!![],'username':!![],'status':!![],'publicKey':!![]},'take':0xa});let _0x2138bd=_0x49c19c(0x160);_0x2138bd+='📱\x20Your\x20Telegram\x20ID:\x20`'+_0x22b826+_0x49c19c(0x217),_0x2138bd+=_0x49c19c(0x180),_0x3adfca[_0x49c19c(0x158)]((_0x1aecf9,_0x37932f)=>{const _0x136404=_0x49c19c;_0x2138bd+=_0x37932f+0x1+_0x136404(0x1d5)+_0x1aecf9[_0x136404(0x1e5)]+'*\x0a',_0x2138bd+=_0x136404(0x1c2)+_0x1aecf9['username']+'`\x0a',_0x2138bd+=_0x136404(0x1ee)+_0x1aecf9['status']+'\x0a',_0x2138bd+=_0x136404(0x1dd)+_0x1aecf9[_0x136404(0x195)][_0x136404(0x1fb)](0x0,0xf)+_0x136404(0x1e1);}),await this[_0x49c19c(0x1d7)]?.[_0x49c19c(0x1bc)](_0x4ecd20,_0x2138bd,{'parse_mode':_0x49c19c(0x149)});}catch(_0x238e9b){console[_0x49c19c(0x20f)](_0x49c19c(0x14b),_0x238e9b),await this['bot']?.[_0x49c19c(0x1bc)](_0x4ecd20,'❌\x20Error\x20getting\x20debug\x20information.');}}),this[_0x3348ef(0x1d7)]['on'](_0x3348ef(0x182),async _0xc545e=>{const _0x2f9be0=_0x3348ef;if(_0xc545e['text']?.[_0x2f9be0(0x20c)]('/'))return;const _0x195bc8=_0xc545e[_0x2f9be0(0x1d3)]['id'],_0x14706c=_0xc545e['from']?.['id'][_0x2f9be0(0x1fe)](),_0x3b65ad=_0xc545e[_0x2f9be0(0x20a)]?.[_0x2f9be0(0x17b)]();if(!_0x14706c||!_0x3b65ad)return;try{const _0x51dcc7=await database_1['default'][_0x2f9be0(0x20d)]['findUnique']({'where':{'telegramId':_0x14706c},'include':{'shop':!![]}});if(!_0x51dcc7){await this[_0x2f9be0(0x1d7)]?.[_0x2f9be0(0x1bc)](_0x195bc8,'❌\x20Please\x20use\x20/start\x20command\x20first');return;}if(_0x51dcc7[_0x2f9be0(0x218)]&&_0x51dcc7[_0x2f9be0(0x204)]&&_0x51dcc7[_0x2f9be0(0x1ef)]){await this[_0x2f9be0(0x1d7)]?.[_0x2f9be0(0x1bc)](_0x195bc8,_0x2f9be0(0x1b3)+_0x51dcc7[_0x2f9be0(0x1ef)]['name']+_0x2f9be0(0x223)+_0x2f9be0(0x1f7),{'parse_mode':_0x2f9be0(0x149)});return;}const _0x521f1e=_0x3b65ad[_0x2f9be0(0x17e)](/\s+/);if(_0x521f1e[_0x2f9be0(0x1bd)]!==0x2){await this[_0x2f9be0(0x1d7)]?.[_0x2f9be0(0x1bc)](_0x195bc8,_0x2f9be0(0x18e)+_0x2f9be0(0x1b0)+'Example:\x0a'+_0x2f9be0(0x222)+(_0x2f9be0(0x1bf)+_0x521f1e[_0x2f9be0(0x1bd)]+_0x2f9be0(0x1dc)+_0x521f1e['map'](_0x358881=>'`'+_0x358881+'`')[_0x2f9be0(0x1ab)](',\x20')),{'parse_mode':_0x2f9be0(0x149)});return;}const [_0x4b2dfe,_0x5794ba]=_0x521f1e;console['log'](_0x2f9be0(0x1fd)+_0x14706c+_0x2f9be0(0x17c)+_0x4b2dfe+'\x22,\x20apiKey=\x22'+_0x5794ba[_0x2f9be0(0x1fb)](0x0,0xa)+_0x2f9be0(0x1d9)),await this['handleSingleLineVerification'](_0x195bc8,_0x14706c,_0x4b2dfe,_0x5794ba);}catch(_0x24f762){console['error'](_0x2f9be0(0x224),_0x24f762),await this[_0x2f9be0(0x1d7)]?.[_0x2f9be0(0x1bc)](_0x195bc8,_0x2f9be0(0x165));}}),this[_0x3348ef(0x1d7)]['on'](_0x3348ef(0x20f),_0x10ded3=>{const _0x5473d7=_0x3348ef;console[_0x5473d7(0x20f)](_0x5473d7(0x14c),_0x10ded3);}),this['bot']['on'](_0x3348ef(0x1a9),_0x23f43f=>{const _0x4ee7c1=_0x3348ef;console[_0x4ee7c1(0x20f)](_0x4ee7c1(0x15d),_0x23f43f);});}async[a54_0xfe576f(0x171)](_0x82132f,_0x2eb63f,_0x4ea84b,_0x536d0c){const _0x2d3153=a54_0xfe576f;try{console[_0x2d3153(0x152)](_0x2d3153(0x1fd)+_0x2eb63f+_0x2d3153(0x17c)+_0x4ea84b+_0x2d3153(0x1ad)+_0x536d0c[_0x2d3153(0x1fb)](0x0,0xa)+_0x2d3153(0x1d9));if(!_0x4ea84b||_0x4ea84b[_0x2d3153(0x1bd)]<0x3||_0x4ea84b['length']>0x32||!/^[a-zA-Z0-9_]+$/[_0x2d3153(0x16b)](_0x4ea84b)){await this[_0x2d3153(0x1d7)]?.['sendMessage'](_0x82132f,'❌\x20Invalid\x20username\x20format:\x20`'+_0x4ea84b+'`\x0a\x0a'+_0x2d3153(0x1f5),{'parse_mode':_0x2d3153(0x149)});return;}if(!_0x536d0c||!_0x536d0c['startsWith']('pk_')&&!_0x536d0c[_0x2d3153(0x20c)](_0x2d3153(0x1d6))){await this[_0x2d3153(0x1d7)]?.['sendMessage'](_0x82132f,_0x2d3153(0x226)+_0x2d3153(0x214),{'parse_mode':_0x2d3153(0x149)});return;}const _0x397b06=await database_1[_0x2d3153(0x166)]['shop'][_0x2d3153(0x1cb)]({'where':{'username':_0x4ea84b},'select':{'id':!![],'name':!![],'username':!![],'status':!![],'publicKey':!![],'secretKey':!![]}});if(!_0x397b06){const _0x52e1a8=await database_1[_0x2d3153(0x166)][_0x2d3153(0x1ef)][_0x2d3153(0x194)]({'select':{'username':!![],'name':!![]},'take':0x5});let _0x4f922f=_0x2d3153(0x225)+_0x4ea84b+_0x2d3153(0x185);_0x52e1a8[_0x2d3153(0x1bd)]>0x0?(_0x4f922f+=_0x2d3153(0x167),_0x52e1a8[_0x2d3153(0x158)](_0x599255=>{const _0x123065=_0x2d3153;_0x4f922f+=_0x123065(0x1bb)+_0x599255['username']+_0x123065(0x196)+_0x599255[_0x123065(0x1e5)]+')\x0a';}),_0x4f922f+='\x0aCheck\x20spelling\x20and\x20try\x20again.'):_0x4f922f+='Check\x20spelling\x20and\x20try\x20again.';await this[_0x2d3153(0x1d7)]?.[_0x2d3153(0x1bc)](_0x82132f,_0x4f922f,{'parse_mode':_0x2d3153(0x149)});return;}if(_0x397b06[_0x2d3153(0x154)]!==_0x2d3153(0x1b4)){await this['bot']?.[_0x2d3153(0x1bc)](_0x82132f,'❌\x20Shop\x20`'+_0x4ea84b+_0x2d3153(0x14a)+'Contact\x20administrator.',{'parse_mode':_0x2d3153(0x149)});return;}if(_0x397b06[_0x2d3153(0x195)]!==_0x536d0c&&_0x397b06[_0x2d3153(0x156)]!==_0x536d0c){await this[_0x2d3153(0x1d7)]?.['sendMessage'](_0x82132f,_0x2d3153(0x1eb)+_0x4ea84b+_0x2d3153(0x198)+_0x2d3153(0x201)+'Expected\x20key\x20format:\x20`pk_...`\x20or\x20`sk_...`',{'parse_mode':_0x2d3153(0x149)});return;}const _0x7d798d=await database_1[_0x2d3153(0x166)]['telegramUser']['findFirst']({'where':{'shopId':_0x397b06['id'],'isVerified':!![],'telegramId':{'not':_0x2eb63f}}});if(_0x7d798d){await this['bot']?.[_0x2d3153(0x1bc)](_0x82132f,_0x2d3153(0x228)+_0x4ea84b+'`.\x0a\x0a'+_0x2d3153(0x215),{'parse_mode':_0x2d3153(0x149)});return;}await database_1[_0x2d3153(0x166)][_0x2d3153(0x20d)]['update']({'where':{'telegramId':_0x2eb63f},'data':{'shopId':_0x397b06['id'],'isVerified':!![]}}),await this[_0x2d3153(0x1d7)]?.[_0x2d3153(0x1bc)](_0x82132f,_0x2d3153(0x211)+_0x2d3153(0x1b1)+(_0x2d3153(0x1c8)+_0x397b06[_0x2d3153(0x1e5)]+'*\x0a')+(_0x2d3153(0x187)+_0x397b06[_0x2d3153(0x1a6)]+_0x2d3153(0x217))+_0x2d3153(0x1ec)+_0x2d3153(0x16d)+_0x2d3153(0x190)+_0x2d3153(0x1f6)+_0x2d3153(0x20b)+'Commands:\x0a'+_0x2d3153(0x14f)+_0x2d3153(0x212),{'parse_mode':_0x2d3153(0x149)}),console[_0x2d3153(0x152)]('✅\x20Telegram\x20user\x20'+_0x2eb63f+_0x2d3153(0x1e2)+_0x397b06[_0x2d3153(0x1a6)]+_0x2d3153(0x157));}catch(_0x537a4f){console[_0x2d3153(0x20f)](_0x2d3153(0x1e4),_0x537a4f),await this[_0x2d3153(0x1d7)]?.[_0x2d3153(0x1bc)](_0x82132f,_0x2d3153(0x1c3));}}async[a54_0xfe576f(0x1f8)](_0x24780b,_0x3f126d,_0x1931da){const _0x29d6b5=a54_0xfe576f;if(!this['bot']){console['warn'](_0x29d6b5(0x18b));return;}try{const _0x3e54e4=await database_1[_0x29d6b5(0x166)]['telegramUser']['findMany']({'where':{'shopId':_0x24780b,'isVerified':!![]}});if(_0x3e54e4['length']===0x0){console[_0x29d6b5(0x152)](_0x29d6b5(0x1aa)+_0x24780b);return;}const _0x22c699=_0x3e54e4['map'](async _0x5b3d73=>{const _0x19df89=_0x29d6b5;try{await this['bot']?.['sendMessage'](_0x5b3d73[_0x19df89(0x1de)],_0x3f126d,_0x1931da),console[_0x19df89(0x152)]('✅\x20Notification\x20sent\x20to\x20Telegram\x20user\x20'+_0x5b3d73[_0x19df89(0x1de)]);}catch(_0x44fc4f){console[_0x19df89(0x20f)](_0x19df89(0x14e)+_0x5b3d73[_0x19df89(0x1de)]+':',_0x44fc4f),_0x44fc4f instanceof Error&&(_0x44fc4f[_0x19df89(0x182)][_0x19df89(0x227)](_0x19df89(0x189))||_0x44fc4f['message']['includes'](_0x19df89(0x164))||_0x44fc4f[_0x19df89(0x182)][_0x19df89(0x227)](_0x19df89(0x1f9)))&&(await database_1['default'][_0x19df89(0x20d)][_0x19df89(0x1f2)]({'where':{'id':_0x5b3d73['id']},'data':{'isVerified':![]}}),console[_0x19df89(0x152)]('User\x20'+_0x5b3d73[_0x19df89(0x1de)]+_0x19df89(0x15b)));}});await Promise[_0x29d6b5(0x168)](_0x22c699);}catch(_0x59cdd9){console[_0x29d6b5(0x20f)](_0x29d6b5(0x1d1),_0x59cdd9);}}async[a54_0xfe576f(0x147)](_0x41b35a,_0x514976,_0x559d9e){const _0x38ff4c=a54_0xfe576f,_0x1a357f={'created':'🆕','paid':'✅','failed':'❌','expired':'⏰','refund':'🔄','chargeback':'⚠️','processing':'⚙️'},_0x13bef2={'created':'New\x20payment\x20created','paid':_0x38ff4c(0x150),'failed':_0x38ff4c(0x1ac),'expired':_0x38ff4c(0x202),'refund':_0x38ff4c(0x1c4),'chargeback':_0x38ff4c(0x162),'processing':_0x38ff4c(0x1c5)},_0x287470=_0x1a357f[_0x559d9e],_0x489517=_0x13bef2[_0x559d9e],_0x46d6d3=(0x0,gateway_1['getGatewayDisplayNameForTelegram'])(_0x514976[_0x38ff4c(0x15a)]);console['log'](_0x38ff4c(0x193)+_0x514976['gateway']+_0x38ff4c(0x179)+_0x46d6d3+'\x22');let _0x51b5ee=_0x287470+'\x20*'+_0x489517+_0x38ff4c(0x153)+(_0x38ff4c(0x213)+_0x514976['amount']+'\x20'+_0x514976[_0x38ff4c(0x221)]+'*\x0a')+('📝\x20Order\x20ID:\x20`'+(_0x514976['orderId']||_0x514976['id'])+'`\x0a')+(_0x38ff4c(0x1e8)+_0x514976['id']+'`\x0a')+('🏪\x20Gateway:\x20`'+_0x46d6d3+'`\x0a')+('📅\x20Date:\x20'+new Date(_0x514976[_0x38ff4c(0x1df)])[_0x38ff4c(0x169)](_0x38ff4c(0x163))+'\x0a');(_0x514976[_0x38ff4c(0x155)]||_0x514976[_0x38ff4c(0x184)])&&(_0x51b5ee+='\x0a👤\x20*Customer\x20Information:*\x0a',_0x514976[_0x38ff4c(0x155)]&&(_0x51b5ee+=_0x38ff4c(0x1ff)+_0x514976[_0x38ff4c(0x155)]+'`\x0a'),_0x514976[_0x38ff4c(0x184)]&&(_0x51b5ee+=_0x38ff4c(0x170)+_0x514976[_0x38ff4c(0x184)]+'`\x0a')),_0x559d9e===_0x38ff4c(0x1b9)&&_0x514976[_0x38ff4c(0x18d)]&&(_0x51b5ee+='💸\x20Penalty\x20amount:\x20*'+_0x514976['chargebackAmount']+_0x38ff4c(0x200)),_0x559d9e===_0x38ff4c(0x219)&&(_0x51b5ee+=_0x38ff4c(0x17d)),_0x514976[_0x38ff4c(0x186)]&&(_0x51b5ee+='📝\x20Notes:\x20'+_0x514976[_0x38ff4c(0x186)]+'\x0a'),await this[_0x38ff4c(0x1f8)](_0x41b35a,_0x51b5ee,{'parse_mode':_0x38ff4c(0x149)});}async[a54_0xfe576f(0x1b5)](_0x121688,_0x3ce07c,_0xd035b5){const _0x251577=a54_0xfe576f,_0x18fce9={'created':'📤','completed':'✅','rejected':'❌'},_0x46fda4={'created':'New\x20payout\x20created','completed':_0x251577(0x14d),'rejected':_0x251577(0x1d8)},_0x10b4bc=_0x18fce9[_0xd035b5],_0x3f7e9b=_0x46fda4[_0xd035b5],_0x1c939d=_0x10b4bc+'\x20*'+_0x3f7e9b+_0x251577(0x153)+(_0x251577(0x1ae)+_0x3ce07c[_0x251577(0x1c0)]+'\x20USD*\x0a')+(_0x251577(0x1b2)+_0x3ce07c[_0x251577(0x209)]+'`\x0a')+(_0x251577(0x210)+_0x3ce07c['id']+'`\x0a')+(_0x251577(0x21f)+new Date(_0x3ce07c[_0x251577(0x1df)])[_0x251577(0x169)](_0x251577(0x163))+'\x0a')+(_0x3ce07c[_0x251577(0x1be)]?_0x251577(0x16f)+_0x3ce07c[_0x251577(0x1be)]+'`':'');await this[_0x251577(0x1f8)](_0x121688,_0x1c939d,{'parse_mode':_0x251577(0x149)});}async[a54_0xfe576f(0x21d)](_0x33e1fe,_0x3a3608){const _0x3b10a9=a54_0xfe576f;try{const _0x4ebfcb=await database_1[_0x3b10a9(0x166)][_0x3b10a9(0x21c)]['findUnique']({'where':{'shopId':_0x33e1fe},'select':{'notificationLogin':!![]}});if(!_0x4ebfcb?.[_0x3b10a9(0x19d)]){console[_0x3b10a9(0x152)](_0x3b10a9(0x17f)+_0x33e1fe);return;}const _0x442816=_0x3a3608[_0x3b10a9(0x1af)]?'🔐':'🚨',_0x548324=_0x3a3608[_0x3b10a9(0x1af)]?_0x3b10a9(0x16e):_0x3b10a9(0x1a1);let _0x3d96d2=_0x442816+'\x20*'+_0x548324+_0x3b10a9(0x153)+(_0x3b10a9(0x187)+_0x3a3608['username']+'`\x0a')+(_0x3b10a9(0x1a8)+_0x3a3608[_0x3b10a9(0x203)]['toLocaleString'](_0x3b10a9(0x163))+'\x0a');_0x3a3608[_0x3b10a9(0x19b)]&&(_0x3d96d2+=_0x3b10a9(0x15f)+_0x3a3608[_0x3b10a9(0x19b)]+'`\x0a');if(_0x3a3608[_0x3b10a9(0x21e)]){const _0x309af8=_0x3a3608['userAgent']['length']>0x32?_0x3a3608['userAgent'][_0x3b10a9(0x1fb)](0x0,0x32)+_0x3b10a9(0x1d2):_0x3a3608[_0x3b10a9(0x21e)];_0x3d96d2+=_0x3b10a9(0x1d4)+_0x309af8+'`\x0a';}!_0x3a3608[_0x3b10a9(0x1af)]&&(_0x3d96d2+=_0x3b10a9(0x15c)),await this[_0x3b10a9(0x1f8)](_0x33e1fe,_0x3d96d2,{'parse_mode':'Markdown'}),console[_0x3b10a9(0x152)](_0x3b10a9(0x1ed)+_0x33e1fe+':\x20'+(_0x3a3608[_0x3b10a9(0x1af)]?_0x3b10a9(0x1af):_0x3b10a9(0x1b8)));}catch(_0x2ebc9c){console[_0x3b10a9(0x20f)](_0x3b10a9(0x1e7),_0x2ebc9c);}}async[a54_0xfe576f(0x17a)](_0x2ad87e,_0x657798){const _0x28d523=a54_0xfe576f;try{const _0x5a8cf7=await database_1[_0x28d523(0x166)]['shopSettings'][_0x28d523(0x1cb)]({'where':{'shopId':_0x2ad87e},'select':{'notificationApiError':!![]}});if(!_0x5a8cf7?.['notificationApiError']){console[_0x28d523(0x152)](_0x28d523(0x1f1)+_0x2ad87e);return;}let _0x29a846=_0x28d523(0x19e)+(_0x28d523(0x1ce)+_0x657798[_0x28d523(0x209)]+'\x20'+_0x657798[_0x28d523(0x161)]+'`\x0a')+(_0x28d523(0x1a8)+_0x657798['timestamp'][_0x28d523(0x169)](_0x28d523(0x163))+'\x0a');_0x657798['statusCode']&&(_0x29a846+=_0x28d523(0x18a)+_0x657798[_0x28d523(0x208)]+'`\x0a'),_0x29a846+=_0x28d523(0x159)+_0x657798['errorMessage']+'`\x0a',_0x657798['requestId']&&(_0x29a846+='🆔\x20Request\x20ID:\x20`'+_0x657798[_0x28d523(0x1a7)]+'`\x0a'),_0x29a846+=_0x28d523(0x220),await this[_0x28d523(0x1f8)](_0x2ad87e,_0x29a846,{'parse_mode':_0x28d523(0x149)}),console['log'](_0x28d523(0x1c9)+_0x2ad87e+':\x20'+_0x657798['endpoint']);}catch(_0x1ca6cf){console[_0x28d523(0x20f)](_0x28d523(0x216),_0x1ca6cf);}}async['sendCustomNotification'](_0x31347c,_0x4cd5ee,_0xcbba5f){const _0x389903=a54_0xfe576f;let _0x1b673a='🔔\x20*'+_0x4cd5ee+_0x389903(0x153);for(const [_0x39f332,_0x48b62c]of Object['entries'](_0xcbba5f)){_0x48b62c!==null&&_0x48b62c!==undefined&&(_0x1b673a+=_0x39f332+':\x20`'+_0x48b62c+'`\x0a');}await this[_0x389903(0x1f8)](_0x31347c,_0x1b673a,{'parse_mode':'Markdown'});}[a54_0xfe576f(0x15e)](){const _0x2774f9=a54_0xfe576f;return{'isActive':!!this[_0x2774f9(0x1d7)],'username':this[_0x2774f9(0x1e3)]};}['stopBot'](){const _0x4ff351=a54_0xfe576f;this[_0x4ff351(0x1d7)]&&(this[_0x4ff351(0x1d7)][_0x4ff351(0x175)](),this[_0x4ff351(0x1d7)]=null,console[_0x4ff351(0x152)](_0x4ff351(0x1f3)));}}function a54_0xdda6(){const _0x3912fb=['secretKey','\x20via\x20single-line\x20input','forEach','❌\x20Error:\x20`','gateway','\x20marked\x20as\x20unverified\x20due\x20to\x20delivery\x20failure','\x0a⚠️\x20If\x20this\x20wasn\x27t\x20you,\x20change\x20your\x20password\x20immediately!','Telegram\x20bot\x20polling\x20error:','getBotInfo','🌐\x20IP\x20address:\x20`','🔍\x20*Debug\x20Information*\x0a\x0a','endpoint','Payment\x20chargeback','en-US','chat\x20not\x20found','❌\x20An\x20error\x20occurred.\x20Please\x20try\x20again\x20later.','default','Available\x20usernames:\x0a','allSettled','toLocaleString','✅\x20You\x20have\x20been\x20successfully\x20disconnected\x20from\x20shop\x20*','test','create','•\x20New\x20payments\x0a','Successful\x20login','🔗\x20TXID:\x20`','📧\x20Email:\x20`','handleSingleLineVerification','•\x20Payouts\x0a\x0a','botToken','🔌\x20User\x20','stopPolling','2011VcaKjH','last_name','You\x20are\x20already\x20connected\x20to\x20shop:\x20*','\x22\x20->\x20display\x20\x22','sendApiErrorNotification','trim',':\x20username=\x22','⏳\x20The\x20payment\x20is\x20currently\x20being\x20processed\x20by\x20the\x20gateway.\x0a','split','📱\x20Login\x20notifications\x20disabled\x20for\x20shop\x20','🏪\x20Available\x20shops\x20in\x20system:\x0a','351369cHYqmc','message','\x20disconnected\x20from\x20shop\x20','customerEmail','`\x20not\x20found.\x0a\x0a','adminNotes','👤\x20Username:\x20`','❌\x20Failed\x20to\x20initialize\x20Telegram\x20bot:','blocked','📊\x20Error\x20code:\x20`','Telegram\x20bot\x20not\x20initialized,\x20cannot\x20send\x20notification','Error\x20handling\x20/status\x20command:','chargebackAmount','❌\x20Invalid\x20format.\x20Please\x20send\x20exactly\x202\x20parts\x20separated\x20by\x20space:\x0a\x0a','initializeBot','•\x20Payment\x20status\x20changes\x0a','264817FnNaQh','TelegramBotService','📱\x20Telegram\x20notification:\x20gateway\x20\x22','findMany','publicKey','`\x20(','❌\x20You\x20are\x20not\x20connected\x20to\x20the\x20notification\x20system.','`.\x0a\x0a','✅\x20Telegram\x20bot\x20@','📅\x20Connection\x20date:\x20','ipAddress','248928JJAhcX','notificationLogin','🚨\x20*API\x20Error*\x0a\x0a','trapay_bot','Use\x20/start\x20to\x20begin.','Failed\x20login\x20attempt','976680djvwFg','TELEGRAM_BOT_TOKEN','✅\x20Connected\x20to\x20shop:\x20*','🔄\x20Reset\x20incomplete\x20verification\x20for\x20user\x20','username','requestId','📅\x20Time:\x20','polling_error','No\x20verified\x20Telegram\x20users\x20found\x20for\x20shop\x20','join','Payment\x20failed','\x22,\x20apiKey=\x22','💸\x20Amount:\x20*','success','📝\x20Format:\x20`username\x20api_key`\x0a\x0a','✅\x20You\x20have\x20been\x20successfully\x20connected\x20to\x20the\x20notification\x20system!\x0a\x0a','🏦\x20Method:\x20`','✅\x20You\x20are\x20already\x20connected\x20to\x20shop\x20*','ACTIVE','sendPayoutNotification','../config/database','201588svfCuP','failed','chargeback','Example:\x0a','•\x20`','sendMessage','length','txid','You\x20sent\x20','amount','4RqcpGT','\x20\x20\x20Username:\x20`','❌\x20An\x20error\x20occurred\x20while\x20verifying\x20data.','Payment\x20refund','Payment\x20is\x20being\x20processed','onText','16MlSrqk','📱\x20Shop:\x20*','✅\x20API\x20error\x20notification\x20sent\x20for\x20shop\x20','telegramBotService','findUnique','🔔\x20You\x20receive\x20notifications\x20about:\x0a','To\x20reconnect,\x20use\x20the\x20/start\x20command','🔗\x20Endpoint:\x20`','🤖\x20Welcome\x20to\x20TRAPAY\x20notification\x20system!\x0a\x0a','Username:\x20`','Error\x20sending\x20shop\x20notification:','...','chat','💻\x20Browser:\x20`','.\x20*','sk_','bot','Payout\x20rejected','...\x22','TELEGRAM_BOT_USERNAME','\x20initialized\x20successfully','\x20parts:\x20','\x20\x20\x20Public\x20Key:\x20`','telegramId','createdAt','from','...`\x0a\x0a','\x20verified\x20for\x20shop\x20','botUsername','Error\x20in\x20handleSingleLineVerification:','name','25AOAdxH','Failed\x20to\x20send\x20login\x20notification:','🆔\x20Payment\x20ID:\x20`','unknown\x20shop','first_name','❌\x20API\x20key\x20does\x20not\x20match\x20shop\x20`','🔔\x20You\x20will\x20now\x20receive\x20notifications\x20about:\x0a','✅\x20Login\x20notification\x20sent\x20for\x20shop\x20','\x20\x20\x20Status:\x20','shop','✅\x20Welcome\x20back!\x0a\x0a','📱\x20API\x20error\x20notifications\x20disabled\x20for\x20shop\x20','update','🛑\x20Telegram\x20bot\x20stopped','❗️\x20Make\x20sure\x20to\x20separate\x20username\x20and\x20API\x20key\x20with\x20a\x20space!','Username\x20must\x20contain\x20only\x20letters,\x20numbers\x20and\x20underscore\x20(3-50\x20characters).','•\x20Payouts\x0a','Use\x20/status\x20to\x20check\x20status\x20or\x20/disconnect\x20to\x20disconnect.','sendShopNotification','user\x20is\x20deactivated','setupBotHandlers','substring','__importDefault','🔄\x20Processing\x20single-line\x20verification\x20for\x20user\x20','toString','📛\x20Name:\x20`','\x20USDT*\x0a','Check\x20the\x20key\x20and\x20try\x20again.\x0a\x0a','Payment\x20expired','timestamp','shopId','node-telegram-bot-api','Error\x20handling\x20/start\x20command:','Commands:\x0a','statusCode','method','text','•\x20Important\x20events\x0a\x0a','startsWith','telegramUser','__esModule','error','🆔\x20Payout\x20ID:\x20`','🎉\x20*Congratulations!*\x0a\x0a','/disconnect\x20-\x20disconnect\x20from\x20notifications','💰\x20Amount:\x20*','API\x20key\x20must\x20start\x20with\x20`pk\x5c_`\x20or\x20`sk\x5c_`.','Disconnect\x20the\x20previous\x20account\x20first\x20or\x20contact\x20administrator.','Failed\x20to\x20send\x20API\x20error\x20notification:','`\x0a\x0a','isVerified','processing','../types/gateway','616275cLygib','shopSettings','sendLoginNotification','userAgent','📅\x20Date:\x20','\x0a💡\x20Check\x20your\x20request\x20or\x20contact\x20support.','currency','`appple\x20pk_aa6450d3f57afbefbb0f3f5be5ce6cca13037536afc5ccf14c81a6cbc7a07de5`\x0a\x0a','*.\x0a\x0a','Error\x20handling\x20message:','❌\x20Shop\x20with\x20username\x20`','❌\x20Invalid\x20API\x20key\x20format.\x0a\x0a','includes','❌\x20Another\x20Telegram\x20account\x20is\x20already\x20connected\x20to\x20shop\x20`','TELEGRAM_BOT_TOKEN\x20not\x20found\x20in\x20environment\x20variables','\x20(@','warn','sendPaymentNotification','🔔\x20Notifications\x20are\x20active\x0a\x0a','Markdown','`\x20is\x20inactive.\x0a\x0a','Error\x20handling\x20/debug\x20command:','Telegram\x20bot\x20error:','Payout\x20completed','❌\x20Failed\x20to\x20send\x20notification\x20to\x20Telegram\x20user\x20','/status\x20-\x20check\x20connection\x20status\x0a','Payment\x20successfully\x20paid','env','log','*\x0a\x0a','status','customerName'];a54_0xdda6=function(){return _0x3912fb;};return a54_0xdda6();}exports[a54_0xfe576f(0x192)]=TelegramBotService,exports[a54_0xfe576f(0x1ca)]=new TelegramBotService();