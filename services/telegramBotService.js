'use strict';const a53_0x40cc24=a53_0xd1f5;(function(_0x5a9e6b,_0x3ad556){const _0x2222fc=a53_0xd1f5,_0x300d88=_0x5a9e6b();while(!![]){try{const _0x4eb1c5=-parseInt(_0x2222fc(0x226))/0x1*(parseInt(_0x2222fc(0x218))/0x2)+parseInt(_0x2222fc(0x248))/0x3+parseInt(_0x2222fc(0x254))/0x4+-parseInt(_0x2222fc(0x2a6))/0x5+-parseInt(_0x2222fc(0x1e8))/0x6*(-parseInt(_0x2222fc(0x258))/0x7)+parseInt(_0x2222fc(0x1fb))/0x8*(parseInt(_0x2222fc(0x1fa))/0x9)+-parseInt(_0x2222fc(0x214))/0xa*(parseInt(_0x2222fc(0x28b))/0xb);if(_0x4eb1c5===_0x3ad556)break;else _0x300d88['push'](_0x300d88['shift']());}catch(_0x5a3bb5){_0x300d88['push'](_0x300d88['shift']());}}}(a53_0xf339,0x3269b));function a53_0xf339(){const _0x3dea3f=['📱\x20Your\x20Telegram\x20ID:\x20`','Commands:\x0a','📅\x20Time:\x20','entries','currency','\x0a👤\x20*Customer\x20Information:*\x0a','...','text','\x0a⚠️\x20If\x20this\x20wasn\x27t\x20you,\x20change\x20your\x20password\x20immediately!','test','Error\x20in\x20handleSingleLineVerification:','Failed\x20to\x20send\x20API\x20error\x20notification:','🔔\x20*','botToken','🆔\x20Payout\x20ID:\x20`','notificationApiError','shopId','📱\x20Created\x20new\x20Telegram\x20user:\x20','📱\x20Telegram\x20notification:\x20gateway\x20\x22','success','defineProperty','24LCeLot','chargeback','../types/gateway','__esModule','initializeBot','\x0aCheck\x20spelling\x20and\x20try\x20again.','\x20USDT*\x0a','📅\x20Connection\x20date:\x20','toLocaleString','•\x20`','Use\x20/start\x20to\x20connect.','telegramId','update','warn','🎉\x20*Congratulations!*\x0a\x0a','🤖\x20Welcome\x20to\x20TRAPAY\x20notification\x20system!\x0a\x0a','API\x20key\x20must\x20start\x20with\x20`pk\x5c_`\x20or\x20`sk\x5c_`.','Error\x20handling\x20message:','63bMGRYs','96328eCIrMr','sendMessage','✅\x20Login\x20notification\x20sent\x20for\x20shop\x20','sk_','requestId','../config/database','startsWith','userAgent','Payout\x20completed','Failed\x20to\x20send\x20login\x20notification:','chat','node-telegram-bot-api','🚨\x20*API\x20Error*\x0a\x0a','errorMessage','New\x20payout\x20created','status','🆔\x20Request\x20ID:\x20`','💸\x20Penalty\x20amount:\x20*','🔄\x20Reset\x20incomplete\x20verification\x20for\x20user\x20','split','📊\x20Error\x20code:\x20`',':\x20`','polling_error','updatedAt','❌\x20Please\x20use\x20/start\x20command\x20first','445190hHPLAU','findUnique','ACTIVE','User\x20','19878FfCmzf','🔍\x20*Debug\x20Information*\x0a\x0a','adminNotes','user\x20is\x20deactivated','Payment\x20chargeback','endpoint','🏦\x20Method:\x20`','en-US','Successful\x20login','setupBotHandlers','❌\x20Failed\x20to\x20initialize\x20Telegram\x20bot:','publicKey','Payment\x20is\x20being\x20processed','`.\x0a\x0a','19xujOWX','✅\x20You\x20have\x20been\x20successfully\x20connected\x20to\x20the\x20notification\x20system!\x0a\x0a','getGatewayDisplayNameForTelegram','`\x0a\x0a','substring','💻\x20Browser:\x20`','sendLoginNotification','length','❗️\x20Make\x20sure\x20to\x20separate\x20username\x20and\x20API\x20key\x20with\x20a\x20space!','__importDefault','Disconnect\x20the\x20previous\x20account\x20first\x20or\x20contact\x20administrator.','secretKey','findMany','📝\x20Format:\x20`username\x20api_key`\x0a\x0a','\x20\x20\x20Status:\x20','createdAt','map','TELEGRAM_BOT_TOKEN\x20not\x20found\x20in\x20environment\x20variables','...\x22','Error\x20handling\x20/disconnect\x20command:','Payment\x20expired','TELEGRAM_BOT_USERNAME','name','*\x0a\x0a','handleSingleLineVerification','first_name','toString','Telegram\x20bot\x20polling\x20error:','👤\x20Username:\x20`','unknown\x20shop','\x22,\x20apiKey=\x22','🔌\x20User\x20','sendShopNotification','Check\x20spelling\x20and\x20try\x20again.','895050wCOijc','Payment\x20successfully\x20paid','TELEGRAM_BOT_TOKEN','💸\x20Amount:\x20*','processing','allSettled','telegramUser','Telegram\x20bot\x20not\x20initialized,\x20cannot\x20send\x20notification','You\x20sent\x20','includes','/disconnect\x20-\x20disconnect\x20from\x20notifications','`\x20(','870756rdHlUX','❌\x20Error:\x20`','statusCode','Markdown','295953retpAJ','error','bot','Error\x20handling\x20/debug\x20command:','chargebackAmount','Use\x20/start\x20to\x20begin.','getBotInfo','🏪\x20Gateway:\x20`','sendPayoutNotification','timestamp','❌\x20You\x20are\x20not\x20connected\x20to\x20the\x20notification\x20system.','from','method','default','•\x20New\x20payments\x0a','🔗\x20TXID:\x20`','customerEmail','❌\x20An\x20error\x20occurred.\x20Please\x20try\x20again\x20later.','orderId','message','log','⏳\x20The\x20payment\x20is\x20currently\x20being\x20processed\x20by\x20the\x20gateway.\x0a','/status\x20-\x20check\x20connection\x20status\x0a','isVerified',':\x20username=\x22','📅\x20Date:\x20','blocked','🔔\x20You\x20will\x20now\x20receive\x20notifications\x20about:\x0a','\x20(@','Failed\x20login\x20attempt','You\x20are\x20already\x20connected\x20to\x20shop:\x20*','\x0a💡\x20Check\x20your\x20request\x20or\x20contact\x20support.','•\x20Payment\x20status\x20changes\x0a','Error\x20sending\x20shop\x20notification:','📧\x20Email:\x20`','❌\x20You\x20are\x20not\x20connected\x20to\x20a\x20shop.\x0a\x0a','txid','\x22\x20->\x20display\x20\x22','failed','`\x20not\x20found.\x0a\x0a','✅\x20Connected\x20to\x20shop:\x20*','•\x20Important\x20events\x0a\x0a','❌\x20API\x20key\x20does\x20not\x20match\x20shop\x20`','New\x20payment\x20created','username','join','❌\x20Invalid\x20username\x20format:\x20`','toLocaleDateString','shopSettings','Username:\x20`','*.\x0a\x0a','11IxPzxy','🔄\x20Processing\x20single-line\x20verification\x20for\x20user\x20','📱\x20Shop:\x20*','trapay_bot','stopBot','📝\x20Order\x20ID:\x20`','findFirst','🏪\x20Available\x20shops\x20in\x20system:\x0a','🛑\x20Telegram\x20bot\x20stopped','.\x20*','shop','telegramBotService','📛\x20Name:\x20`','\x20marked\x20as\x20unverified\x20due\x20to\x20delivery\x20failure','❌\x20Failed\x20to\x20send\x20notification\x20to\x20Telegram\x20user\x20','chat\x20not\x20found','❌\x20Shop\x20`','✅\x20You\x20have\x20been\x20successfully\x20disconnected\x20from\x20shop\x20*','...`\x0a\x0a','•\x20Payouts\x0a\x0a','env','gateway','✅\x20Notification\x20sent\x20to\x20Telegram\x20user\x20','❌\x20Invalid\x20API\x20key\x20format.\x0a\x0a','📱\x20Login\x20notifications\x20disabled\x20for\x20shop\x20','🆔\x20Payment\x20ID:\x20`','Error\x20handling\x20/status\x20command:','1647955BEygbp','sendPaymentNotification','Available\x20usernames:\x0a','To\x20receive\x20payment\x20notifications,\x20send\x20your\x20credentials\x20in\x20one\x20line:\x0a\x0a','❌\x20Shop\x20with\x20username\x20`','create','Contact\x20administrator.','Telegram\x20bot\x20error:','\x20parts:\x20','❌\x20Error\x20getting\x20debug\x20information.','onText','Check\x20the\x20key\x20and\x20try\x20again.\x0a\x0a','💰\x20Amount:\x20*','sendCustomNotification','customerName','Expected\x20key\x20format:\x20`pk_...`\x20or\x20`sk_...`','botUsername','✅\x20Telegram\x20user\x20'];a53_0xf339=function(){return _0x3dea3f;};return a53_0xf339();}var __importDefault=this&&this[a53_0x40cc24(0x22f)]||function(_0x21e71e){const _0x343942=a53_0x40cc24;return _0x21e71e&&_0x21e71e[_0x343942(0x1eb)]?_0x21e71e:{'default':_0x21e71e};};Object[a53_0x40cc24(0x1e7)](exports,a53_0x40cc24(0x1eb),{'value':!![]}),exports['telegramBotService']=exports['TelegramBotService']=void 0x0;const node_telegram_bot_api_1=__importDefault(require(a53_0x40cc24(0x206))),database_1=__importDefault(require(a53_0x40cc24(0x200))),gateway_1=require(a53_0x40cc24(0x1ea));function a53_0xd1f5(_0x4960ba,_0x445c75){const _0xf33916=a53_0xf339();return a53_0xd1f5=function(_0xd1f5e6,_0x1979a5){_0xd1f5e6=_0xd1f5e6-0x1df;let _0x37c098=_0xf33916[_0xd1f5e6];return _0x37c098;},a53_0xd1f5(_0x4960ba,_0x445c75);}class TelegramBotService{constructor(){const _0x257d83=a53_0x40cc24;this[_0x257d83(0x25a)]=null,this[_0x257d83(0x1e0)]=process[_0x257d83(0x29f)][_0x257d83(0x24a)]||'',this[_0x257d83(0x2b6)]=process[_0x257d83(0x29f)][_0x257d83(0x23b)]||_0x257d83(0x28e),this[_0x257d83(0x1e0)]?this['initializeBot']():console[_0x257d83(0x1f5)](_0x257d83(0x237));}[a53_0x40cc24(0x1ec)](){const _0x58368e=a53_0x40cc24;try{this[_0x58368e(0x25a)]=new node_telegram_bot_api_1[(_0x58368e(0x265))](this[_0x58368e(0x1e0)],{'polling':!![]}),this['setupBotHandlers'](),console[_0x58368e(0x26c)]('✅\x20Telegram\x20bot\x20@'+this['botUsername']+'\x20initialized\x20successfully');}catch(_0x2aa871){console[_0x58368e(0x259)](_0x58368e(0x222),_0x2aa871);}}[a53_0x40cc24(0x221)](){const _0x58d9ef=a53_0x40cc24;if(!this[_0x58d9ef(0x25a)])return;this['bot'][_0x58d9ef(0x2b0)](/\/start/,async _0x55f0f0=>{const _0x335418=_0x58d9ef,_0x4377d9=_0x55f0f0[_0x335418(0x205)]['id'],_0x15f89d=_0x55f0f0[_0x335418(0x263)]?.['id'][_0x335418(0x240)](),_0x18977a=_0x55f0f0[_0x335418(0x263)]?.[_0x335418(0x284)],_0x482cce=_0x55f0f0[_0x335418(0x263)]?.[_0x335418(0x23f)],_0x583bf2=_0x55f0f0['from']?.['last_name'];if(!_0x15f89d)return;try{let _0x48669c=await database_1[_0x335418(0x265)][_0x335418(0x24e)][_0x335418(0x215)]({'where':{'telegramId':_0x15f89d},'include':{'shop':!![]}});!_0x48669c?(_0x48669c=await database_1['default'][_0x335418(0x24e)][_0x335418(0x2ab)]({'data':{'telegramId':_0x15f89d,'username':_0x18977a,'firstName':_0x482cce,'lastName':_0x583bf2,'isVerified':![],'shopId':null},'include':{'shop':!![]}}),console['log'](_0x335418(0x1e4)+_0x15f89d+_0x335418(0x274)+_0x18977a+')')):_0x48669c=await database_1[_0x335418(0x265)][_0x335418(0x24e)]['update']({'where':{'telegramId':_0x15f89d},'data':{'username':_0x18977a,'firstName':_0x482cce,'lastName':_0x583bf2},'include':{'shop':!![]}}),_0x48669c[_0x335418(0x26f)]&&_0x48669c['shopId']&&_0x48669c['shop']?await this[_0x335418(0x25a)]?.['sendMessage'](_0x4377d9,'✅\x20Welcome\x20back!\x0a\x0a'+(_0x335418(0x276)+_0x48669c[_0x335418(0x295)][_0x335418(0x23c)]+'*\x0a')+(_0x335418(0x289)+_0x48669c[_0x335418(0x295)]['username']+_0x335418(0x229))+'🔔\x20You\x20receive\x20notifications\x20about:\x0a'+_0x335418(0x266)+'•\x20Payment\x20status\x20changes\x0a'+_0x335418(0x29e)+_0x335418(0x2b9)+'/status\x20-\x20check\x20connection\x20status\x0a'+_0x335418(0x252),{'parse_mode':'Markdown'}):(_0x48669c[_0x335418(0x1e3)]&&!_0x48669c[_0x335418(0x26f)]&&(await database_1[_0x335418(0x265)][_0x335418(0x24e)][_0x335418(0x1f4)]({'where':{'telegramId':_0x15f89d},'data':{'shopId':null,'isVerified':![]}}),console[_0x335418(0x26c)](_0x335418(0x20d)+_0x15f89d)),await this['bot']?.[_0x335418(0x1fc)](_0x4377d9,_0x335418(0x1f7)+_0x335418(0x2a9)+_0x335418(0x233)+'Example:\x0a'+'`appple\x20pk_aa6450d3f57afbefbb0f3f5be5ce6cca13037536afc5ccf14c81a6cbc7a07de5`\x0a\x0a'+_0x335418(0x22e),{'parse_mode':'Markdown'}));}catch(_0x3e65f9){console[_0x335418(0x259)]('Error\x20handling\x20/start\x20command:',_0x3e65f9),await this[_0x335418(0x25a)]?.[_0x335418(0x1fc)](_0x4377d9,_0x335418(0x269));}}),this[_0x58d9ef(0x25a)][_0x58d9ef(0x2b0)](/\/disconnect/,async _0x493e9b=>{const _0x41f927=_0x58d9ef,_0x2dc1ae=_0x493e9b['chat']['id'],_0x3e09c9=_0x493e9b[_0x41f927(0x263)]?.['id'][_0x41f927(0x240)]();if(!_0x3e09c9)return;try{const _0x11f1c4=await database_1[_0x41f927(0x265)][_0x41f927(0x24e)]['findUnique']({'where':{'telegramId':_0x3e09c9},'include':{'shop':!![]}});if(!_0x11f1c4||!_0x11f1c4[_0x41f927(0x26f)]||!_0x11f1c4[_0x41f927(0x1e3)]){await this[_0x41f927(0x25a)]?.[_0x41f927(0x1fc)](_0x2dc1ae,_0x41f927(0x262));return;}const _0x338744=_0x11f1c4[_0x41f927(0x295)]?.[_0x41f927(0x23c)]||_0x41f927(0x243);await database_1['default'][_0x41f927(0x24e)][_0x41f927(0x1f4)]({'where':{'telegramId':_0x3e09c9},'data':{'shopId':null,'isVerified':![]}}),console[_0x41f927(0x26c)](_0x41f927(0x245)+_0x3e09c9+'\x20disconnected\x20from\x20shop\x20'+_0x11f1c4[_0x41f927(0x1e3)]),await this['bot']?.[_0x41f927(0x1fc)](_0x2dc1ae,_0x41f927(0x29c)+_0x338744+_0x41f927(0x28a)+'To\x20reconnect,\x20use\x20the\x20/start\x20command',{'parse_mode':'Markdown'});}catch(_0xc99d9a){console['error'](_0x41f927(0x239),_0xc99d9a),await this[_0x41f927(0x25a)]?.[_0x41f927(0x1fc)](_0x2dc1ae,_0x41f927(0x269));}}),this[_0x58d9ef(0x25a)][_0x58d9ef(0x2b0)](/\/status/,async _0x5e0016=>{const _0x2d1071=_0x58d9ef,_0x1d7833=_0x5e0016['chat']['id'],_0x42c73b=_0x5e0016['from']?.['id'][_0x2d1071(0x240)]();if(!_0x42c73b)return;try{const _0x3c794a=await database_1['default'][_0x2d1071(0x24e)][_0x2d1071(0x215)]({'where':{'telegramId':_0x42c73b},'include':{'shop':!![]}});if(!_0x3c794a){await this['bot']?.[_0x2d1071(0x1fc)](_0x1d7833,'❌\x20You\x20are\x20not\x20registered\x20in\x20the\x20system.\x0a\x0a'+_0x2d1071(0x25d));return;}if(!_0x3c794a['isVerified']||!_0x3c794a[_0x2d1071(0x1e3)]||!_0x3c794a[_0x2d1071(0x295)]){await this[_0x2d1071(0x25a)]?.[_0x2d1071(0x1fc)](_0x1d7833,_0x2d1071(0x27b)+_0x2d1071(0x1f2));return;}await this[_0x2d1071(0x25a)]?.[_0x2d1071(0x1fc)](_0x1d7833,'📊\x20*Connection\x20Status*\x0a\x0a'+(_0x2d1071(0x280)+_0x3c794a['shop'][_0x2d1071(0x23c)]+'*\x0a')+(_0x2d1071(0x242)+_0x3c794a[_0x2d1071(0x295)][_0x2d1071(0x284)]+'`\x0a')+(_0x2d1071(0x1ef)+_0x3c794a[_0x2d1071(0x212)][_0x2d1071(0x287)](_0x2d1071(0x21f))+'\x0a\x0a')+'🔔\x20Notifications\x20are\x20active\x0a\x0a'+_0x2d1071(0x2b9)+_0x2d1071(0x252),{'parse_mode':_0x2d1071(0x257)});}catch(_0x1cf6ef){console['error'](_0x2d1071(0x2a5),_0x1cf6ef),await this[_0x2d1071(0x25a)]?.[_0x2d1071(0x1fc)](_0x1d7833,_0x2d1071(0x269));}}),this[_0x58d9ef(0x25a)]['onText'](/\/debug/,async _0x410d81=>{const _0x398051=_0x58d9ef,_0x117b51=_0x410d81['chat']['id'],_0x543323=_0x410d81['from']?.['id'][_0x398051(0x240)]();if(!_0x543323)return;try{const _0x415ea5=await database_1[_0x398051(0x265)][_0x398051(0x295)]['findMany']({'select':{'id':!![],'name':!![],'username':!![],'status':!![],'publicKey':!![]},'take':0xa});let _0x30fc02=_0x398051(0x219);_0x30fc02+=_0x398051(0x2b8)+_0x543323+'`\x0a\x0a',_0x30fc02+=_0x398051(0x292),_0x415ea5['forEach']((_0x3d674f,_0x48c01c)=>{const _0x4fc9c3=_0x398051;_0x30fc02+=_0x48c01c+0x1+_0x4fc9c3(0x294)+_0x3d674f['name']+'*\x0a',_0x30fc02+='\x20\x20\x20Username:\x20`'+_0x3d674f[_0x4fc9c3(0x284)]+'`\x0a',_0x30fc02+=_0x4fc9c3(0x234)+_0x3d674f[_0x4fc9c3(0x20a)]+'\x0a',_0x30fc02+='\x20\x20\x20Public\x20Key:\x20`'+_0x3d674f['publicKey'][_0x4fc9c3(0x22a)](0x0,0xf)+_0x4fc9c3(0x29d);}),await this[_0x398051(0x25a)]?.[_0x398051(0x1fc)](_0x117b51,_0x30fc02,{'parse_mode':_0x398051(0x257)});}catch(_0x1d4a61){console['error'](_0x398051(0x25b),_0x1d4a61),await this[_0x398051(0x25a)]?.[_0x398051(0x1fc)](_0x117b51,_0x398051(0x2af));}}),this[_0x58d9ef(0x25a)]['on'](_0x58d9ef(0x26b),async _0x1e17f7=>{const _0x5856d9=_0x58d9ef;if(_0x1e17f7[_0x5856d9(0x2bf)]?.[_0x5856d9(0x201)]('/'))return;const _0x58c530=_0x1e17f7[_0x5856d9(0x205)]['id'],_0x45da84=_0x1e17f7[_0x5856d9(0x263)]?.['id']['toString'](),_0x7b22a5=_0x1e17f7[_0x5856d9(0x2bf)]?.['trim']();if(!_0x45da84||!_0x7b22a5)return;try{const _0x455461=await database_1[_0x5856d9(0x265)]['telegramUser'][_0x5856d9(0x215)]({'where':{'telegramId':_0x45da84},'include':{'shop':!![]}});if(!_0x455461){await this[_0x5856d9(0x25a)]?.[_0x5856d9(0x1fc)](_0x58c530,_0x5856d9(0x213));return;}if(_0x455461[_0x5856d9(0x26f)]&&_0x455461[_0x5856d9(0x1e3)]&&_0x455461[_0x5856d9(0x295)]){await this[_0x5856d9(0x25a)]?.['sendMessage'](_0x58c530,'✅\x20You\x20are\x20already\x20connected\x20to\x20shop\x20*'+_0x455461[_0x5856d9(0x295)]['name']+'*.\x0a\x0a'+'Use\x20/status\x20to\x20check\x20status\x20or\x20/disconnect\x20to\x20disconnect.',{'parse_mode':'Markdown'});return;}const _0x117bad=_0x7b22a5[_0x5856d9(0x20e)](/\s+/);if(_0x117bad[_0x5856d9(0x22d)]!==0x2){await this[_0x5856d9(0x25a)]?.['sendMessage'](_0x58c530,'❌\x20Invalid\x20format.\x20Please\x20send\x20exactly\x202\x20parts\x20separated\x20by\x20space:\x0a\x0a'+_0x5856d9(0x233)+'Example:\x0a'+'`appple\x20pk_aa6450d3f57afbefbb0f3f5be5ce6cca13037536afc5ccf14c81a6cbc7a07de5`\x0a\x0a'+(_0x5856d9(0x250)+_0x117bad['length']+_0x5856d9(0x2ae)+_0x117bad['map'](_0x88b20b=>'`'+_0x88b20b+'`')[_0x5856d9(0x285)](',\x20')),{'parse_mode':'Markdown'});return;}const [_0x34d454,_0x5c70c8]=_0x117bad;console[_0x5856d9(0x26c)](_0x5856d9(0x28c)+_0x45da84+_0x5856d9(0x270)+_0x34d454+_0x5856d9(0x244)+_0x5c70c8[_0x5856d9(0x22a)](0x0,0xa)+_0x5856d9(0x238)),await this[_0x5856d9(0x23e)](_0x58c530,_0x45da84,_0x34d454,_0x5c70c8);}catch(_0x11d3f6){console[_0x5856d9(0x259)](_0x5856d9(0x1f9),_0x11d3f6),await this[_0x5856d9(0x25a)]?.[_0x5856d9(0x1fc)](_0x58c530,_0x5856d9(0x269));}}),this[_0x58d9ef(0x25a)]['on']('error',_0x18e2be=>{const _0x55f31a=_0x58d9ef;console['error'](_0x55f31a(0x2ad),_0x18e2be);}),this[_0x58d9ef(0x25a)]['on'](_0x58d9ef(0x211),_0x4c68a7=>{const _0x230f63=_0x58d9ef;console[_0x230f63(0x259)](_0x230f63(0x241),_0x4c68a7);});}async[a53_0x40cc24(0x23e)](_0x561d13,_0x4ad18d,_0x3d025b,_0x19d998){const _0x3f0d3a=a53_0x40cc24;try{console[_0x3f0d3a(0x26c)]('🔄\x20Processing\x20single-line\x20verification\x20for\x20user\x20'+_0x4ad18d+_0x3f0d3a(0x270)+_0x3d025b+_0x3f0d3a(0x244)+_0x19d998[_0x3f0d3a(0x22a)](0x0,0xa)+_0x3f0d3a(0x238));if(!_0x3d025b||_0x3d025b[_0x3f0d3a(0x22d)]<0x3||_0x3d025b['length']>0x32||!/^[a-zA-Z0-9_]+$/[_0x3f0d3a(0x2c1)](_0x3d025b)){await this[_0x3f0d3a(0x25a)]?.[_0x3f0d3a(0x1fc)](_0x561d13,_0x3f0d3a(0x286)+_0x3d025b+'`\x0a\x0a'+'Username\x20must\x20contain\x20only\x20letters,\x20numbers\x20and\x20underscore\x20(3-50\x20characters).',{'parse_mode':_0x3f0d3a(0x257)});return;}if(!_0x19d998||!_0x19d998[_0x3f0d3a(0x201)]('pk_')&&!_0x19d998['startsWith'](_0x3f0d3a(0x1fe))){await this[_0x3f0d3a(0x25a)]?.[_0x3f0d3a(0x1fc)](_0x561d13,_0x3f0d3a(0x2a2)+_0x3f0d3a(0x1f8),{'parse_mode':_0x3f0d3a(0x257)});return;}const _0x2a9c6b=await database_1[_0x3f0d3a(0x265)][_0x3f0d3a(0x295)][_0x3f0d3a(0x215)]({'where':{'username':_0x3d025b},'select':{'id':!![],'name':!![],'username':!![],'status':!![],'publicKey':!![],'secretKey':!![]}});if(!_0x2a9c6b){const _0x37738e=await database_1[_0x3f0d3a(0x265)][_0x3f0d3a(0x295)][_0x3f0d3a(0x232)]({'select':{'username':!![],'name':!![]},'take':0x5});let _0x1a4293=_0x3f0d3a(0x2aa)+_0x3d025b+_0x3f0d3a(0x27f);_0x37738e[_0x3f0d3a(0x22d)]>0x0?(_0x1a4293+=_0x3f0d3a(0x2a8),_0x37738e['forEach'](_0x21416c=>{const _0xb952cc=_0x3f0d3a;_0x1a4293+=_0xb952cc(0x1f1)+_0x21416c[_0xb952cc(0x284)]+_0xb952cc(0x253)+_0x21416c[_0xb952cc(0x23c)]+')\x0a';}),_0x1a4293+=_0x3f0d3a(0x1ed)):_0x1a4293+=_0x3f0d3a(0x247);await this[_0x3f0d3a(0x25a)]?.[_0x3f0d3a(0x1fc)](_0x561d13,_0x1a4293,{'parse_mode':_0x3f0d3a(0x257)});return;}if(_0x2a9c6b[_0x3f0d3a(0x20a)]!==_0x3f0d3a(0x216)){await this[_0x3f0d3a(0x25a)]?.[_0x3f0d3a(0x1fc)](_0x561d13,_0x3f0d3a(0x29b)+_0x3d025b+'`\x20is\x20inactive.\x0a\x0a'+_0x3f0d3a(0x2ac),{'parse_mode':_0x3f0d3a(0x257)});return;}if(_0x2a9c6b[_0x3f0d3a(0x223)]!==_0x19d998&&_0x2a9c6b[_0x3f0d3a(0x231)]!==_0x19d998){await this['bot']?.[_0x3f0d3a(0x1fc)](_0x561d13,_0x3f0d3a(0x282)+_0x3d025b+_0x3f0d3a(0x225)+_0x3f0d3a(0x2b1)+_0x3f0d3a(0x2b5),{'parse_mode':'Markdown'});return;}const _0x5b23c6=await database_1[_0x3f0d3a(0x265)][_0x3f0d3a(0x24e)][_0x3f0d3a(0x291)]({'where':{'shopId':_0x2a9c6b['id'],'isVerified':!![],'telegramId':{'not':_0x4ad18d}}});if(_0x5b23c6){await this[_0x3f0d3a(0x25a)]?.[_0x3f0d3a(0x1fc)](_0x561d13,'❌\x20Another\x20Telegram\x20account\x20is\x20already\x20connected\x20to\x20shop\x20`'+_0x3d025b+'`.\x0a\x0a'+_0x3f0d3a(0x230),{'parse_mode':_0x3f0d3a(0x257)});return;}await database_1[_0x3f0d3a(0x265)][_0x3f0d3a(0x24e)][_0x3f0d3a(0x1f4)]({'where':{'telegramId':_0x4ad18d},'data':{'shopId':_0x2a9c6b['id'],'isVerified':!![]}}),await this['bot']?.[_0x3f0d3a(0x1fc)](_0x561d13,_0x3f0d3a(0x1f6)+_0x3f0d3a(0x227)+(_0x3f0d3a(0x28d)+_0x2a9c6b[_0x3f0d3a(0x23c)]+'*\x0a')+(_0x3f0d3a(0x242)+_0x2a9c6b[_0x3f0d3a(0x284)]+'`\x0a\x0a')+_0x3f0d3a(0x273)+'•\x20New\x20payments\x0a'+_0x3f0d3a(0x278)+'•\x20Payouts\x0a'+_0x3f0d3a(0x281)+_0x3f0d3a(0x2b9)+_0x3f0d3a(0x26e)+_0x3f0d3a(0x252),{'parse_mode':'Markdown'}),console[_0x3f0d3a(0x26c)](_0x3f0d3a(0x2b7)+_0x4ad18d+'\x20verified\x20for\x20shop\x20'+_0x2a9c6b['username']+'\x20via\x20single-line\x20input');}catch(_0x3b90a9){console[_0x3f0d3a(0x259)](_0x3f0d3a(0x2c2),_0x3b90a9),await this['bot']?.['sendMessage'](_0x561d13,'❌\x20An\x20error\x20occurred\x20while\x20verifying\x20data.');}}async[a53_0x40cc24(0x246)](_0x1fb38a,_0x3d89db,_0x400d24){const _0x52de3f=a53_0x40cc24;if(!this[_0x52de3f(0x25a)]){console['warn'](_0x52de3f(0x24f));return;}try{const _0x428ff0=await database_1[_0x52de3f(0x265)]['telegramUser'][_0x52de3f(0x232)]({'where':{'shopId':_0x1fb38a,'isVerified':!![]}});if(_0x428ff0[_0x52de3f(0x22d)]===0x0){console[_0x52de3f(0x26c)]('No\x20verified\x20Telegram\x20users\x20found\x20for\x20shop\x20'+_0x1fb38a);return;}const _0xd4b063=_0x428ff0[_0x52de3f(0x236)](async _0x201aff=>{const _0x5b39f2=_0x52de3f;try{await this[_0x5b39f2(0x25a)]?.['sendMessage'](_0x201aff[_0x5b39f2(0x1f3)],_0x3d89db,_0x400d24),console[_0x5b39f2(0x26c)](_0x5b39f2(0x2a1)+_0x201aff[_0x5b39f2(0x1f3)]);}catch(_0x3fe971){console[_0x5b39f2(0x259)](_0x5b39f2(0x299)+_0x201aff[_0x5b39f2(0x1f3)]+':',_0x3fe971),_0x3fe971 instanceof Error&&(_0x3fe971['message'][_0x5b39f2(0x251)](_0x5b39f2(0x272))||_0x3fe971[_0x5b39f2(0x26b)][_0x5b39f2(0x251)](_0x5b39f2(0x29a))||_0x3fe971['message'][_0x5b39f2(0x251)](_0x5b39f2(0x21b)))&&(await database_1[_0x5b39f2(0x265)][_0x5b39f2(0x24e)][_0x5b39f2(0x1f4)]({'where':{'id':_0x201aff['id']},'data':{'isVerified':![]}}),console[_0x5b39f2(0x26c)](_0x5b39f2(0x217)+_0x201aff[_0x5b39f2(0x1f3)]+_0x5b39f2(0x298)));}});await Promise[_0x52de3f(0x24d)](_0xd4b063);}catch(_0x257d14){console['error'](_0x52de3f(0x279),_0x257d14);}}async[a53_0x40cc24(0x2a7)](_0x5c341d,_0x2d44b5,_0x250925){const _0x2df1d9=a53_0x40cc24,_0x1ec906={'created':'🆕','paid':'✅','failed':'❌','expired':'⏰','refund':'🔄','chargeback':'⚠️','processing':'⚙️'},_0x1d0ab9={'created':_0x2df1d9(0x283),'paid':_0x2df1d9(0x249),'failed':'Payment\x20failed','expired':_0x2df1d9(0x23a),'refund':'Payment\x20refund','chargeback':_0x2df1d9(0x21c),'processing':_0x2df1d9(0x224)},_0x76e808=_0x1ec906[_0x250925],_0x1f839c=_0x1d0ab9[_0x250925],_0x4b6c61=(0x0,gateway_1[_0x2df1d9(0x228)])(_0x2d44b5[_0x2df1d9(0x2a0)]);console[_0x2df1d9(0x26c)](_0x2df1d9(0x1e5)+_0x2d44b5[_0x2df1d9(0x2a0)]+_0x2df1d9(0x27d)+_0x4b6c61+'\x22');let _0x3527a0=_0x76e808+'\x20*'+_0x1f839c+_0x2df1d9(0x23d)+(_0x2df1d9(0x2b2)+_0x2d44b5['amount']+'\x20'+_0x2d44b5[_0x2df1d9(0x2bc)]+'*\x0a')+(_0x2df1d9(0x290)+(_0x2d44b5[_0x2df1d9(0x26a)]||_0x2d44b5['id'])+'`\x0a')+(_0x2df1d9(0x2a4)+_0x2d44b5['id']+'`\x0a')+(_0x2df1d9(0x25f)+_0x4b6c61+'`\x0a')+(_0x2df1d9(0x271)+new Date(_0x2d44b5['createdAt'])[_0x2df1d9(0x1f0)](_0x2df1d9(0x21f))+'\x0a');(_0x2d44b5[_0x2df1d9(0x2b4)]||_0x2d44b5[_0x2df1d9(0x268)])&&(_0x3527a0+=_0x2df1d9(0x2bd),_0x2d44b5[_0x2df1d9(0x2b4)]&&(_0x3527a0+=_0x2df1d9(0x297)+_0x2d44b5[_0x2df1d9(0x2b4)]+'`\x0a'),_0x2d44b5[_0x2df1d9(0x268)]&&(_0x3527a0+=_0x2df1d9(0x27a)+_0x2d44b5[_0x2df1d9(0x268)]+'`\x0a')),_0x250925===_0x2df1d9(0x1e9)&&_0x2d44b5[_0x2df1d9(0x25c)]&&(_0x3527a0+=_0x2df1d9(0x20c)+_0x2d44b5[_0x2df1d9(0x25c)]+_0x2df1d9(0x1ee)),_0x250925===_0x2df1d9(0x24c)&&(_0x3527a0+=_0x2df1d9(0x26d)),_0x2d44b5[_0x2df1d9(0x21a)]&&(_0x3527a0+='📝\x20Notes:\x20'+_0x2d44b5[_0x2df1d9(0x21a)]+'\x0a'),await this[_0x2df1d9(0x246)](_0x5c341d,_0x3527a0,{'parse_mode':_0x2df1d9(0x257)});}async[a53_0x40cc24(0x260)](_0x1be84a,_0x17a323,_0x5ca6db){const _0x217994=a53_0x40cc24,_0x85d893={'created':'📤','completed':'✅','rejected':'❌'},_0x674654={'created':_0x217994(0x209),'completed':_0x217994(0x203),'rejected':'Payout\x20rejected'},_0x340286=_0x85d893[_0x5ca6db],_0x18ca67=_0x674654[_0x5ca6db],_0x10e26a=_0x340286+'\x20*'+_0x18ca67+_0x217994(0x23d)+(_0x217994(0x24b)+_0x17a323['amount']+'\x20USD*\x0a')+(_0x217994(0x21e)+_0x17a323[_0x217994(0x264)]+'`\x0a')+(_0x217994(0x1e1)+_0x17a323['id']+'`\x0a')+(_0x217994(0x271)+new Date(_0x17a323[_0x217994(0x235)])[_0x217994(0x1f0)](_0x217994(0x21f))+'\x0a')+(_0x17a323['txid']?_0x217994(0x267)+_0x17a323[_0x217994(0x27c)]+'`':'');await this[_0x217994(0x246)](_0x1be84a,_0x10e26a,{'parse_mode':_0x217994(0x257)});}async[a53_0x40cc24(0x22c)](_0x5d4585,_0x52a5dd){const _0x4ec65b=a53_0x40cc24;try{const _0x3955f6=await database_1[_0x4ec65b(0x265)][_0x4ec65b(0x288)][_0x4ec65b(0x215)]({'where':{'shopId':_0x5d4585},'select':{'notificationLogin':!![]}});if(!_0x3955f6?.['notificationLogin']){console['log'](_0x4ec65b(0x2a3)+_0x5d4585);return;}const _0x18a966=_0x52a5dd['success']?'🔐':'🚨',_0x5f711c=_0x52a5dd[_0x4ec65b(0x1e6)]?_0x4ec65b(0x220):_0x4ec65b(0x275);let _0x14b02b=_0x18a966+'\x20*'+_0x5f711c+_0x4ec65b(0x23d)+('👤\x20Username:\x20`'+_0x52a5dd[_0x4ec65b(0x284)]+'`\x0a')+(_0x4ec65b(0x2ba)+_0x52a5dd[_0x4ec65b(0x261)][_0x4ec65b(0x1f0)](_0x4ec65b(0x21f))+'\x0a');_0x52a5dd['ipAddress']&&(_0x14b02b+='🌐\x20IP\x20address:\x20`'+_0x52a5dd['ipAddress']+'`\x0a');if(_0x52a5dd[_0x4ec65b(0x202)]){const _0x153347=_0x52a5dd[_0x4ec65b(0x202)][_0x4ec65b(0x22d)]>0x32?_0x52a5dd[_0x4ec65b(0x202)]['substring'](0x0,0x32)+_0x4ec65b(0x2be):_0x52a5dd[_0x4ec65b(0x202)];_0x14b02b+=_0x4ec65b(0x22b)+_0x153347+'`\x0a';}!_0x52a5dd[_0x4ec65b(0x1e6)]&&(_0x14b02b+=_0x4ec65b(0x2c0)),await this['sendShopNotification'](_0x5d4585,_0x14b02b,{'parse_mode':_0x4ec65b(0x257)}),console[_0x4ec65b(0x26c)](_0x4ec65b(0x1fd)+_0x5d4585+':\x20'+(_0x52a5dd['success']?_0x4ec65b(0x1e6):_0x4ec65b(0x27e)));}catch(_0x356fc9){console[_0x4ec65b(0x259)](_0x4ec65b(0x204),_0x356fc9);}}async['sendApiErrorNotification'](_0x34f810,_0x317fde){const _0x290090=a53_0x40cc24;try{const _0x58100a=await database_1[_0x290090(0x265)][_0x290090(0x288)][_0x290090(0x215)]({'where':{'shopId':_0x34f810},'select':{'notificationApiError':!![]}});if(!_0x58100a?.[_0x290090(0x1e2)]){console[_0x290090(0x26c)]('📱\x20API\x20error\x20notifications\x20disabled\x20for\x20shop\x20'+_0x34f810);return;}let _0x5569fe=_0x290090(0x207)+('🔗\x20Endpoint:\x20`'+_0x317fde[_0x290090(0x264)]+'\x20'+_0x317fde['endpoint']+'`\x0a')+(_0x290090(0x2ba)+_0x317fde[_0x290090(0x261)][_0x290090(0x1f0)](_0x290090(0x21f))+'\x0a');_0x317fde['statusCode']&&(_0x5569fe+=_0x290090(0x20f)+_0x317fde[_0x290090(0x256)]+'`\x0a'),_0x5569fe+=_0x290090(0x255)+_0x317fde[_0x290090(0x208)]+'`\x0a',_0x317fde['requestId']&&(_0x5569fe+=_0x290090(0x20b)+_0x317fde[_0x290090(0x1ff)]+'`\x0a'),_0x5569fe+=_0x290090(0x277),await this[_0x290090(0x246)](_0x34f810,_0x5569fe,{'parse_mode':_0x290090(0x257)}),console[_0x290090(0x26c)]('✅\x20API\x20error\x20notification\x20sent\x20for\x20shop\x20'+_0x34f810+':\x20'+_0x317fde[_0x290090(0x21d)]);}catch(_0x12f2e8){console[_0x290090(0x259)](_0x290090(0x2c3),_0x12f2e8);}}async[a53_0x40cc24(0x2b3)](_0x44ee7d,_0x2ff70f,_0x43a448){const _0x4da372=a53_0x40cc24;let _0x1b18ae=_0x4da372(0x1df)+_0x2ff70f+_0x4da372(0x23d);for(const [_0x439641,_0x1d3ca3]of Object[_0x4da372(0x2bb)](_0x43a448)){_0x1d3ca3!==null&&_0x1d3ca3!==undefined&&(_0x1b18ae+=_0x439641+_0x4da372(0x210)+_0x1d3ca3+'`\x0a');}await this[_0x4da372(0x246)](_0x44ee7d,_0x1b18ae,{'parse_mode':'Markdown'});}[a53_0x40cc24(0x25e)](){return{'isActive':!!this['bot'],'username':this['botUsername']};}[a53_0x40cc24(0x28f)](){const _0x34aa5e=a53_0x40cc24;this[_0x34aa5e(0x25a)]&&(this[_0x34aa5e(0x25a)]['stopPolling'](),this[_0x34aa5e(0x25a)]=null,console[_0x34aa5e(0x26c)](_0x34aa5e(0x293)));}}exports['TelegramBotService']=TelegramBotService,exports[a53_0x40cc24(0x296)]=new TelegramBotService();