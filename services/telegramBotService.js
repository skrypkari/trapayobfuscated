'use strict';const a57_0x5f09f3=a57_0x43a3;(function(_0x174def,_0x5b7fbe){const _0x3643c7=a57_0x43a3,_0x131f5f=_0x174def();while(!![]){try{const _0x3c9106=-parseInt(_0x3643c7(0xf6))/0x1*(parseInt(_0x3643c7(0xfc))/0x2)+-parseInt(_0x3643c7(0x111))/0x3*(-parseInt(_0x3643c7(0xde))/0x4)+-parseInt(_0x3643c7(0x94))/0x5*(-parseInt(_0x3643c7(0x141))/0x6)+parseInt(_0x3643c7(0xbf))/0x7*(-parseInt(_0x3643c7(0x88))/0x8)+parseInt(_0x3643c7(0x14f))/0x9+-parseInt(_0x3643c7(0x155))/0xa+parseInt(_0x3643c7(0x76))/0xb;if(_0x3c9106===_0x5b7fbe)break;else _0x131f5f['push'](_0x131f5f['shift']());}catch(_0x33cb51){_0x131f5f['push'](_0x131f5f['shift']());}}}(a57_0xd091,0x57c12));function a57_0x43a3(_0x4e82b6,_0x5f32bc){const _0xd09109=a57_0xd091();return a57_0x43a3=function(_0x43a33e,_0x2e502a){_0x43a33e=_0x43a33e-0x6b;let _0x598c7d=_0xd09109[_0x43a33e];return _0x598c7d;},a57_0x43a3(_0x4e82b6,_0x5f32bc);}var __importDefault=this&&this[a57_0x5f09f3(0x9f)]||function(_0x4f2a78){const _0x35ed18=a57_0x5f09f3;return _0x4f2a78&&_0x4f2a78[_0x35ed18(0x143)]?_0x4f2a78:{'default':_0x4f2a78};};Object[a57_0x5f09f3(0xd0)](exports,a57_0x5f09f3(0x143),{'value':!![]}),exports['telegramBotService']=exports['TelegramBotService']=void 0x0;function a57_0xd091(){const _0x1475f3=['unknown\x20shop','143604XXFzGP','🔔\x20You\x20receive\x20notifications\x20about:\x0a','🎉\x20*Congratulations!*\x0a\x0a','✅\x20API\x20error\x20notification\x20sent\x20for\x20shop\x20','📝\x20Notes:\x20','💰\x20Amount:\x20*','shopId','substring','❌\x20Another\x20Telegram\x20account\x20is\x20already\x20connected\x20to\x20shop\x20`','bot','❌\x20You\x20are\x20not\x20connected\x20to\x20a\x20shop.\x0a\x0a','`\x20not\x20found.\x0a\x0a','✅\x20Login\x20notification\x20sent\x20for\x20shop\x20','\x20parts:\x20','\x20\x20\x20Username:\x20`','🔄\x20Reset\x20incomplete\x20verification\x20for\x20user\x20','updatedAt','📊\x20Error\x20code:\x20`','📱\x20API\x20error\x20notifications\x20disabled\x20for\x20shop\x20','TELEGRAM_BOT_USERNAME','🔌\x20User\x20','3CGAPOF','sendShopNotification','errorMessage','text','log','🌐\x20IP\x20address:\x20`','Payment\x20is\x20being\x20processed','📅\x20Date:\x20','customerEmail','userAgent','update','customerUa','ACTIVE','method','sendLoginNotification','telegramBotService','notificationApiError','Markdown','Error\x20handling\x20/debug\x20command:','polling_error','You\x20sent\x20','🚨\x20*API\x20Error*\x0a\x0a','Check\x20the\x20key\x20and\x20try\x20again.\x0a\x0a','🆔\x20Payment\x20ID:\x20`','blocked','../config/database','📊\x20*Connection\x20Status*\x0a\x0a','📱\x20Your\x20Telegram\x20ID:\x20`','...','*\x0a\x0a','createdAt','❌\x20Failed\x20to\x20initialize\x20Telegram\x20bot:','`\x0a\x0a','forEach','\x20disconnected\x20from\x20shop\x20','TELEGRAM_BOT_TOKEN','👤\x20Username:\x20`','customerIp','gateway','initializeBot','ipAddress','Contact\x20administrator.','name','orderId','API\x20key\x20must\x20start\x20with\x20`pk\x5c_`\x20or\x20`sk\x5c_`.','`\x20(','handleSingleLineVerification','🏦\x20IBAN:\x20`','66gfrXUs','Commands:\x0a','__esModule','Telegram\x20bot\x20not\x20initialized,\x20cannot\x20send\x20notification','`appple\x20pk_aa6450d3f57afbefbb0f3f5be5ce6cca13037536afc5ccf14c81a6cbc7a07de5`\x0a\x0a','customerName','🔔\x20Notifications\x20are\x20active\x0a\x0a',':\x20username=\x22','\x20initialized\x20successfully','You\x20are\x20already\x20connected\x20to\x20shop:\x20*','timestamp','chat\x20not\x20found','botToken','New\x20payout\x20created','3051945UTkxfb','env','✅\x20Connected\x20to\x20shop:\x20*','Successful\x20login','\x22,\x20apiKey=\x22','❌\x20Please\x20use\x20/start\x20command\x20first','6407560gpJFXy','📧\x20Email:\x20`','📱\x20Telegram\x20notification:\x20gateway\x20\x22','onText','Error\x20handling\x20/status\x20command:','sendPaymentNotification','join','\x0a👤\x20*Customer\x20Information:*\x0a','Telegram\x20bot\x20polling\x20error:','❌\x20Error:\x20`','statusCode','...`\x0a\x0a','❌\x20Invalid\x20API\x20key\x20format.\x0a\x0a','toLocaleString','Payment\x20expired','❗️\x20Make\x20sure\x20to\x20separate\x20username\x20and\x20API\x20key\x20with\x20a\x20space!','5066336aERDas','\x20(@','first_name','📝\x20Order\x20ID:\x20`','botUsername','shopSettings','✅\x20Telegram\x20user\x20','map','🆔\x20Request\x20ID:\x20`','findFirst','username','\x20USD*\x0a','trim','Error\x20in\x20handleSingleLineVerification:','currency','User\x20','node-telegram-bot-api','endpoint','360QEAizR','❌\x20An\x20error\x20occurred\x20while\x20verifying\x20data.','default','Payout\x20rejected','...\x22','findMany','processing','Use\x20/start\x20to\x20connect.','amount','requestId','sendCustomNotification','shop','165715OOIKQw','sk_','chat','/disconnect\x20-\x20disconnect\x20from\x20notifications','from','✅\x20Telegram\x20bot\x20@','warn','❌\x20Failed\x20to\x20send\x20notification\x20to\x20Telegram\x20user\x20','❌\x20An\x20error\x20occurred.\x20Please\x20try\x20again\x20later.','Payment\x20chargeback','pk_','__importDefault','*.\x0a\x0a','🏪\x20Available\x20shops\x20in\x20system:\x0a','notificationLogin','Telegram\x20bot\x20error:','✅\x20Welcome\x20back!\x0a\x0a','\x20marked\x20as\x20unverified\x20due\x20to\x20delivery\x20failure','Payment\x20failed','Payment\x20successfully\x20paid','📱\x20Login\x20notifications\x20disabled\x20for\x20shop\x20','TelegramBotService','sendMessage','success','Error\x20handling\x20/disconnect\x20command:','•\x20`','🏦\x20Method:\x20`','⏳\x20The\x20payment\x20is\x20currently\x20being\x20processed\x20by\x20the\x20gateway.\x0a','secretKey','🔗\x20Endpoint:\x20`','Username:\x20`','allSettled','\x22\x20->\x20display\x20\x22','🔔\x20You\x20will\x20now\x20receive\x20notifications\x20about:\x0a','No\x20verified\x20Telegram\x20users\x20found\x20for\x20shop\x20','\x20\x20\x20Status:\x20','chargeback','stopBot','💸\x20Amount:\x20*','status','✅\x20You\x20have\x20been\x20successfully\x20disconnected\x20from\x20shop\x20*','../types/gateway','includes','64197MsJSXL','last_name','•\x20Payouts\x0a\x0a','en-US','❌\x20Shop\x20with\x20username\x20`','publicKey','txid','🏪\x20Gateway:\x20`','🤖\x20Welcome\x20to\x20TRAPAY\x20notification\x20system!\x0a\x0a','Error\x20sending\x20shop\x20notification:','stopPolling','✅\x20You\x20have\x20been\x20successfully\x20connected\x20to\x20the\x20notification\x20system!\x0a\x0a','sendPayoutNotification','📅\x20Time:\x20','❌\x20You\x20are\x20not\x20registered\x20in\x20the\x20system.\x0a\x0a','telegramId','•\x20New\x20payments\x0a','defineProperty','startsWith','create','❌\x20Invalid\x20username\x20format:\x20`','Failed\x20to\x20send\x20API\x20error\x20notification:','`.\x0a\x0a','Username\x20must\x20contain\x20only\x20letters,\x20numbers\x20and\x20underscore\x20(3-50\x20characters).','📝\x20Format:\x20`username\x20api_key`\x0a\x0a','Expected\x20key\x20format:\x20`pk_...`\x20or\x20`sk_...`','sendApiErrorNotification','isVerified','length','failed','findUnique','1281764etZAXr','\x20USDT*\x0a','📛\x20Name:\x20`','Example:\x0a','error','Use\x20/status\x20to\x20check\x20status\x20or\x20/disconnect\x20to\x20disconnect.','✅\x20Notification\x20sent\x20to\x20Telegram\x20user\x20','chargebackAmount','split',':\x20`','🆔\x20Payout\x20ID:\x20`','❌\x20API\x20key\x20does\x20not\x20match\x20shop\x20`','❌\x20You\x20are\x20not\x20connected\x20to\x20the\x20notification\x20system.','❌\x20Error\x20getting\x20debug\x20information.','toString','•\x20Payment\x20status\x20changes\x0a','🛑\x20Telegram\x20bot\x20stopped','\x0a⚠️\x20If\x20this\x20wasn\x27t\x20you,\x20change\x20your\x20password\x20immediately!','message','user\x20is\x20deactivated','remitterIban','\x0aCheck\x20spelling\x20and\x20try\x20again.','❌\x20Shop\x20`','Failed\x20login\x20attempt','1CTUWaH','🔗\x20TXID:\x20`','setupBotHandlers','•\x20Payouts\x0a','telegramUser'];a57_0xd091=function(){return _0x1475f3;};return a57_0xd091();}const node_telegram_bot_api_1=__importDefault(require(a57_0x5f09f3(0x86))),database_1=__importDefault(require(a57_0x5f09f3(0x12a))),gateway_1=require(a57_0x5f09f3(0xbd));class TelegramBotService{constructor(){const _0x42690f=a57_0x5f09f3;this[_0x42690f(0x105)]=null,this[_0x42690f(0x14d)]=process[_0x42690f(0x150)][_0x42690f(0x134)]||'',this[_0x42690f(0x7a)]=process[_0x42690f(0x150)][_0x42690f(0x10f)]||'trapay_bot',this[_0x42690f(0x14d)]?this[_0x42690f(0x138)]():console['warn']('TELEGRAM_BOT_TOKEN\x20not\x20found\x20in\x20environment\x20variables');}[a57_0x5f09f3(0x138)](){const _0x3263b1=a57_0x5f09f3;try{this[_0x3263b1(0x105)]=new node_telegram_bot_api_1['default'](this[_0x3263b1(0x14d)],{'polling':!![]}),this[_0x3263b1(0xf8)](),console[_0x3263b1(0x115)](_0x3263b1(0x99)+this[_0x3263b1(0x7a)]+_0x3263b1(0x149));}catch(_0x281508){console['error'](_0x3263b1(0x130),_0x281508);}}['setupBotHandlers'](){const _0x201d15=a57_0x5f09f3;if(!this[_0x201d15(0x105)])return;this[_0x201d15(0x105)][_0x201d15(0x158)](/\/start/,async _0x419d27=>{const _0x1f3263=_0x201d15,_0x3d7647=_0x419d27[_0x1f3263(0x96)]['id'],_0x593c4c=_0x419d27[_0x1f3263(0x98)]?.['id'][_0x1f3263(0xec)](),_0x3ddeed=_0x419d27[_0x1f3263(0x98)]?.[_0x1f3263(0x80)],_0xf65db7=_0x419d27[_0x1f3263(0x98)]?.[_0x1f3263(0x78)],_0x16b798=_0x419d27[_0x1f3263(0x98)]?.[_0x1f3263(0xc0)];if(!_0x593c4c)return;try{let _0x5ee931=await database_1['default'][_0x1f3263(0xfa)][_0x1f3263(0xdd)]({'where':{'telegramId':_0x593c4c},'include':{'shop':!![]}});!_0x5ee931?(_0x5ee931=await database_1['default'][_0x1f3263(0xfa)][_0x1f3263(0xd2)]({'data':{'telegramId':_0x593c4c,'username':_0x3ddeed,'firstName':_0xf65db7,'lastName':_0x16b798,'isVerified':![],'shopId':null},'include':{'shop':!![]}}),console[_0x1f3263(0x115)]('📱\x20Created\x20new\x20Telegram\x20user:\x20'+_0x593c4c+_0x1f3263(0x77)+_0x3ddeed+')')):_0x5ee931=await database_1[_0x1f3263(0x8a)][_0x1f3263(0xfa)][_0x1f3263(0x11b)]({'where':{'telegramId':_0x593c4c},'data':{'username':_0x3ddeed,'firstName':_0xf65db7,'lastName':_0x16b798},'include':{'shop':!![]}}),_0x5ee931[_0x1f3263(0xda)]&&_0x5ee931[_0x1f3263(0x102)]&&_0x5ee931[_0x1f3263(0x93)]?await this[_0x1f3263(0x105)]?.['sendMessage'](_0x3d7647,_0x1f3263(0xa4)+(_0x1f3263(0x14a)+_0x5ee931[_0x1f3263(0x93)][_0x1f3263(0x13b)]+'*\x0a')+(_0x1f3263(0xb2)+_0x5ee931['shop']['username']+'`\x0a\x0a')+_0x1f3263(0xfd)+_0x1f3263(0xcf)+'•\x20Payment\x20status\x20changes\x0a'+_0x1f3263(0xc1)+'Commands:\x0a'+'/status\x20-\x20check\x20connection\x20status\x0a'+_0x1f3263(0x97),{'parse_mode':_0x1f3263(0x122)}):(_0x5ee931['shopId']&&!_0x5ee931[_0x1f3263(0xda)]&&(await database_1[_0x1f3263(0x8a)][_0x1f3263(0xfa)]['update']({'where':{'telegramId':_0x593c4c},'data':{'shopId':null,'isVerified':![]}}),console['log'](_0x1f3263(0x10b)+_0x593c4c)),await this['bot']?.[_0x1f3263(0xaa)](_0x3d7647,_0x1f3263(0xc7)+'To\x20receive\x20payment\x20notifications,\x20send\x20your\x20credentials\x20in\x20one\x20line:\x0a\x0a'+_0x1f3263(0xd7)+_0x1f3263(0xe1)+_0x1f3263(0x145)+_0x1f3263(0x75),{'parse_mode':_0x1f3263(0x122)}));}catch(_0x5cad5a){console['error']('Error\x20handling\x20/start\x20command:',_0x5cad5a),await this[_0x1f3263(0x105)]?.[_0x1f3263(0xaa)](_0x3d7647,_0x1f3263(0x9c));}}),this[_0x201d15(0x105)][_0x201d15(0x158)](/\/disconnect/,async _0xbbe372=>{const _0x1f3269=_0x201d15,_0x367a9d=_0xbbe372[_0x1f3269(0x96)]['id'],_0x424339=_0xbbe372[_0x1f3269(0x98)]?.['id'][_0x1f3269(0xec)]();if(!_0x424339)return;try{const _0x2c220e=await database_1[_0x1f3269(0x8a)][_0x1f3269(0xfa)]['findUnique']({'where':{'telegramId':_0x424339},'include':{'shop':!![]}});if(!_0x2c220e||!_0x2c220e[_0x1f3269(0xda)]||!_0x2c220e[_0x1f3269(0x102)]){await this[_0x1f3269(0x105)]?.[_0x1f3269(0xaa)](_0x367a9d,_0x1f3269(0xea));return;}const _0x2fe4b0=_0x2c220e[_0x1f3269(0x93)]?.[_0x1f3269(0x13b)]||_0x1f3269(0xfb);await database_1[_0x1f3269(0x8a)][_0x1f3269(0xfa)][_0x1f3269(0x11b)]({'where':{'telegramId':_0x424339},'data':{'shopId':null,'isVerified':![]}}),console[_0x1f3269(0x115)](_0x1f3269(0x110)+_0x424339+_0x1f3269(0x133)+_0x2c220e[_0x1f3269(0x102)]),await this[_0x1f3269(0x105)]?.[_0x1f3269(0xaa)](_0x367a9d,_0x1f3269(0xbc)+_0x2fe4b0+_0x1f3269(0xa0)+'To\x20reconnect,\x20use\x20the\x20/start\x20command',{'parse_mode':_0x1f3269(0x122)});}catch(_0x36b2d5){console['error'](_0x1f3269(0xac),_0x36b2d5),await this[_0x1f3269(0x105)]?.['sendMessage'](_0x367a9d,_0x1f3269(0x9c));}}),this[_0x201d15(0x105)]['onText'](/\/status/,async _0x4e3219=>{const _0xe0e256=_0x201d15,_0x470f87=_0x4e3219[_0xe0e256(0x96)]['id'],_0x187eba=_0x4e3219[_0xe0e256(0x98)]?.['id'][_0xe0e256(0xec)]();if(!_0x187eba)return;try{const _0x3fd6c0=await database_1[_0xe0e256(0x8a)]['telegramUser'][_0xe0e256(0xdd)]({'where':{'telegramId':_0x187eba},'include':{'shop':!![]}});if(!_0x3fd6c0){await this[_0xe0e256(0x105)]?.[_0xe0e256(0xaa)](_0x470f87,_0xe0e256(0xcd)+'Use\x20/start\x20to\x20begin.');return;}if(!_0x3fd6c0[_0xe0e256(0xda)]||!_0x3fd6c0[_0xe0e256(0x102)]||!_0x3fd6c0[_0xe0e256(0x93)]){await this['bot']?.[_0xe0e256(0xaa)](_0x470f87,_0xe0e256(0x106)+_0xe0e256(0x8f));return;}await this[_0xe0e256(0x105)]?.[_0xe0e256(0xaa)](_0x470f87,_0xe0e256(0x12b)+(_0xe0e256(0x151)+_0x3fd6c0[_0xe0e256(0x93)]['name']+'*\x0a')+('👤\x20Username:\x20`'+_0x3fd6c0[_0xe0e256(0x93)][_0xe0e256(0x80)]+'`\x0a')+('📅\x20Connection\x20date:\x20'+_0x3fd6c0[_0xe0e256(0x10c)]['toLocaleDateString']('en-US')+'\x0a\x0a')+_0xe0e256(0x147)+_0xe0e256(0x142)+_0xe0e256(0x97),{'parse_mode':_0xe0e256(0x122)});}catch(_0x178d1d){console[_0xe0e256(0xe2)](_0xe0e256(0x159),_0x178d1d),await this['bot']?.['sendMessage'](_0x470f87,_0xe0e256(0x9c));}}),this[_0x201d15(0x105)][_0x201d15(0x158)](/\/debug/,async _0x39f3e9=>{const _0x4e15b9=_0x201d15,_0x5a3033=_0x39f3e9[_0x4e15b9(0x96)]['id'],_0x3a2e48=_0x39f3e9[_0x4e15b9(0x98)]?.['id'][_0x4e15b9(0xec)]();if(!_0x3a2e48)return;try{const _0x163932=await database_1['default'][_0x4e15b9(0x93)]['findMany']({'select':{'id':!![],'name':!![],'username':!![],'status':!![],'publicKey':!![]},'take':0xa});let _0x3bfe6f='🔍\x20*Debug\x20Information*\x0a\x0a';_0x3bfe6f+=_0x4e15b9(0x12c)+_0x3a2e48+_0x4e15b9(0x131),_0x3bfe6f+=_0x4e15b9(0xa1),_0x163932['forEach']((_0x13268a,_0x42bb9c)=>{const _0xc455fd=_0x4e15b9;_0x3bfe6f+=_0x42bb9c+0x1+'.\x20*'+_0x13268a[_0xc455fd(0x13b)]+'*\x0a',_0x3bfe6f+=_0xc455fd(0x10a)+_0x13268a[_0xc455fd(0x80)]+'`\x0a',_0x3bfe6f+=_0xc455fd(0xb7)+_0x13268a[_0xc455fd(0xbb)]+'\x0a',_0x3bfe6f+='\x20\x20\x20Public\x20Key:\x20`'+_0x13268a['publicKey'][_0xc455fd(0x103)](0x0,0xf)+_0xc455fd(0x71);}),await this[_0x4e15b9(0x105)]?.['sendMessage'](_0x5a3033,_0x3bfe6f,{'parse_mode':_0x4e15b9(0x122)});}catch(_0x4acdf9){console[_0x4e15b9(0xe2)](_0x4e15b9(0x123),_0x4acdf9),await this[_0x4e15b9(0x105)]?.['sendMessage'](_0x5a3033,_0x4e15b9(0xeb));}}),this[_0x201d15(0x105)]['on'](_0x201d15(0xf0),async _0x29565a=>{const _0xc7c780=_0x201d15;if(_0x29565a['text']?.[_0xc7c780(0xd1)]('/'))return;const _0x491900=_0x29565a[_0xc7c780(0x96)]['id'],_0x3aba24=_0x29565a[_0xc7c780(0x98)]?.['id'][_0xc7c780(0xec)](),_0x138646=_0x29565a[_0xc7c780(0x114)]?.[_0xc7c780(0x82)]();if(!_0x3aba24||!_0x138646)return;try{const _0x31cb5d=await database_1[_0xc7c780(0x8a)][_0xc7c780(0xfa)][_0xc7c780(0xdd)]({'where':{'telegramId':_0x3aba24},'include':{'shop':!![]}});if(!_0x31cb5d){await this[_0xc7c780(0x105)]?.['sendMessage'](_0x491900,_0xc7c780(0x154));return;}if(_0x31cb5d[_0xc7c780(0xda)]&&_0x31cb5d['shopId']&&_0x31cb5d['shop']){await this['bot']?.[_0xc7c780(0xaa)](_0x491900,'✅\x20You\x20are\x20already\x20connected\x20to\x20shop\x20*'+_0x31cb5d['shop'][_0xc7c780(0x13b)]+_0xc7c780(0xa0)+_0xc7c780(0xe3),{'parse_mode':_0xc7c780(0x122)});return;}const _0x46d791=_0x138646[_0xc7c780(0xe6)](/\s+/);if(_0x46d791['length']!==0x2){await this[_0xc7c780(0x105)]?.[_0xc7c780(0xaa)](_0x491900,'❌\x20Invalid\x20format.\x20Please\x20send\x20exactly\x202\x20parts\x20separated\x20by\x20space:\x0a\x0a'+'📝\x20Format:\x20`username\x20api_key`\x0a\x0a'+_0xc7c780(0xe1)+_0xc7c780(0x145)+(_0xc7c780(0x125)+_0x46d791[_0xc7c780(0xdb)]+_0xc7c780(0x109)+_0x46d791[_0xc7c780(0x7d)](_0x226d3c=>'`'+_0x226d3c+'`')[_0xc7c780(0x6c)](',\x20')),{'parse_mode':'Markdown'});return;}const [_0x552939,_0x57c257]=_0x46d791;console[_0xc7c780(0x115)]('🔄\x20Processing\x20single-line\x20verification\x20for\x20user\x20'+_0x3aba24+_0xc7c780(0x148)+_0x552939+'\x22,\x20apiKey=\x22'+_0x57c257['substring'](0x0,0xa)+_0xc7c780(0x8c)),await this[_0xc7c780(0x13f)](_0x491900,_0x3aba24,_0x552939,_0x57c257);}catch(_0x540788){console[_0xc7c780(0xe2)]('Error\x20handling\x20message:',_0x540788),await this['bot']?.[_0xc7c780(0xaa)](_0x491900,_0xc7c780(0x9c));}}),this['bot']['on']('error',_0x49e24e=>{const _0x55ac96=_0x201d15;console[_0x55ac96(0xe2)](_0x55ac96(0xa3),_0x49e24e);}),this[_0x201d15(0x105)]['on'](_0x201d15(0x124),_0x1e6cbe=>{const _0x2bd64a=_0x201d15;console['error'](_0x2bd64a(0x6e),_0x1e6cbe);});}async[a57_0x5f09f3(0x13f)](_0x31465f,_0x50b023,_0x2596f4,_0xc7f70b){const _0x2c3471=a57_0x5f09f3;try{console['log']('🔄\x20Processing\x20single-line\x20verification\x20for\x20user\x20'+_0x50b023+':\x20username=\x22'+_0x2596f4+_0x2c3471(0x153)+_0xc7f70b[_0x2c3471(0x103)](0x0,0xa)+_0x2c3471(0x8c));if(!_0x2596f4||_0x2596f4[_0x2c3471(0xdb)]<0x3||_0x2596f4[_0x2c3471(0xdb)]>0x32||!/^[a-zA-Z0-9_]+$/['test'](_0x2596f4)){await this[_0x2c3471(0x105)]?.[_0x2c3471(0xaa)](_0x31465f,_0x2c3471(0xd3)+_0x2596f4+_0x2c3471(0x131)+_0x2c3471(0xd6),{'parse_mode':_0x2c3471(0x122)});return;}if(!_0xc7f70b||!_0xc7f70b['startsWith'](_0x2c3471(0x9e))&&!_0xc7f70b['startsWith'](_0x2c3471(0x95))){await this[_0x2c3471(0x105)]?.[_0x2c3471(0xaa)](_0x31465f,_0x2c3471(0x72)+_0x2c3471(0x13d),{'parse_mode':_0x2c3471(0x122)});return;}const _0x453b5f=await database_1[_0x2c3471(0x8a)][_0x2c3471(0x93)]['findUnique']({'where':{'username':_0x2596f4},'select':{'id':!![],'name':!![],'username':!![],'status':!![],'publicKey':!![],'secretKey':!![]}});if(!_0x453b5f){const _0x3cc551=await database_1[_0x2c3471(0x8a)]['shop'][_0x2c3471(0x8d)]({'select':{'username':!![],'name':!![]},'take':0x5});let _0x1fd477=_0x2c3471(0xc3)+_0x2596f4+_0x2c3471(0x107);_0x3cc551[_0x2c3471(0xdb)]>0x0?(_0x1fd477+='Available\x20usernames:\x0a',_0x3cc551[_0x2c3471(0x132)](_0x22a018=>{const _0x41253a=_0x2c3471;_0x1fd477+=_0x41253a(0xad)+_0x22a018['username']+_0x41253a(0x13e)+_0x22a018['name']+')\x0a';}),_0x1fd477+=_0x2c3471(0xf3)):_0x1fd477+='Check\x20spelling\x20and\x20try\x20again.';await this[_0x2c3471(0x105)]?.['sendMessage'](_0x31465f,_0x1fd477,{'parse_mode':_0x2c3471(0x122)});return;}if(_0x453b5f[_0x2c3471(0xbb)]!==_0x2c3471(0x11d)){await this[_0x2c3471(0x105)]?.[_0x2c3471(0xaa)](_0x31465f,_0x2c3471(0xf4)+_0x2596f4+'`\x20is\x20inactive.\x0a\x0a'+_0x2c3471(0x13a),{'parse_mode':_0x2c3471(0x122)});return;}if(_0x453b5f[_0x2c3471(0xc4)]!==_0xc7f70b&&_0x453b5f[_0x2c3471(0xb0)]!==_0xc7f70b){await this['bot']?.[_0x2c3471(0xaa)](_0x31465f,_0x2c3471(0xe9)+_0x2596f4+_0x2c3471(0xd5)+_0x2c3471(0x127)+_0x2c3471(0xd8),{'parse_mode':'Markdown'});return;}const _0x15cc4d=await database_1[_0x2c3471(0x8a)]['telegramUser'][_0x2c3471(0x7f)]({'where':{'shopId':_0x453b5f['id'],'isVerified':!![],'telegramId':{'not':_0x50b023}}});if(_0x15cc4d){await this[_0x2c3471(0x105)]?.[_0x2c3471(0xaa)](_0x31465f,_0x2c3471(0x104)+_0x2596f4+'`.\x0a\x0a'+'Disconnect\x20the\x20previous\x20account\x20first\x20or\x20contact\x20administrator.',{'parse_mode':'Markdown'});return;}await database_1[_0x2c3471(0x8a)]['telegramUser'][_0x2c3471(0x11b)]({'where':{'telegramId':_0x50b023},'data':{'shopId':_0x453b5f['id'],'isVerified':!![]}}),await this['bot']?.['sendMessage'](_0x31465f,_0x2c3471(0xfe)+_0x2c3471(0xca)+('📱\x20Shop:\x20*'+_0x453b5f[_0x2c3471(0x13b)]+'*\x0a')+(_0x2c3471(0x135)+_0x453b5f[_0x2c3471(0x80)]+'`\x0a\x0a')+_0x2c3471(0xb5)+_0x2c3471(0xcf)+_0x2c3471(0xed)+_0x2c3471(0xf9)+'•\x20Important\x20events\x0a\x0a'+_0x2c3471(0x142)+'/status\x20-\x20check\x20connection\x20status\x0a'+'/disconnect\x20-\x20disconnect\x20from\x20notifications',{'parse_mode':_0x2c3471(0x122)}),console[_0x2c3471(0x115)](_0x2c3471(0x7c)+_0x50b023+'\x20verified\x20for\x20shop\x20'+_0x453b5f[_0x2c3471(0x80)]+'\x20via\x20single-line\x20input');}catch(_0x35ca17){console['error'](_0x2c3471(0x83),_0x35ca17),await this[_0x2c3471(0x105)]?.['sendMessage'](_0x31465f,_0x2c3471(0x89));}}async['sendShopNotification'](_0x3802da,_0x30fd15,_0x12b1f0){const _0x5e22ac=a57_0x5f09f3;if(!this['bot']){console[_0x5e22ac(0x9a)](_0x5e22ac(0x144));return;}try{const _0x53f1dc=await database_1[_0x5e22ac(0x8a)]['telegramUser'][_0x5e22ac(0x8d)]({'where':{'shopId':_0x3802da,'isVerified':!![]}});if(_0x53f1dc[_0x5e22ac(0xdb)]===0x0){console[_0x5e22ac(0x115)](_0x5e22ac(0xb6)+_0x3802da);return;}const _0x304c66=_0x53f1dc['map'](async _0x502b78=>{const _0x1684fa=_0x5e22ac;try{await this[_0x1684fa(0x105)]?.[_0x1684fa(0xaa)](_0x502b78[_0x1684fa(0xce)],_0x30fd15,_0x12b1f0),console[_0x1684fa(0x115)](_0x1684fa(0xe4)+_0x502b78['telegramId']);}catch(_0x172c94){console[_0x1684fa(0xe2)](_0x1684fa(0x9b)+_0x502b78['telegramId']+':',_0x172c94),_0x172c94 instanceof Error&&(_0x172c94[_0x1684fa(0xf0)][_0x1684fa(0xbe)](_0x1684fa(0x129))||_0x172c94[_0x1684fa(0xf0)][_0x1684fa(0xbe)](_0x1684fa(0x14c))||_0x172c94[_0x1684fa(0xf0)]['includes'](_0x1684fa(0xf1)))&&(await database_1[_0x1684fa(0x8a)][_0x1684fa(0xfa)][_0x1684fa(0x11b)]({'where':{'id':_0x502b78['id']},'data':{'isVerified':![]}}),console[_0x1684fa(0x115)](_0x1684fa(0x85)+_0x502b78[_0x1684fa(0xce)]+_0x1684fa(0xa5)));}});await Promise[_0x5e22ac(0xb3)](_0x304c66);}catch(_0x307f1a){console[_0x5e22ac(0xe2)](_0x5e22ac(0xc8),_0x307f1a);}}async[a57_0x5f09f3(0x6b)](_0xb2448c,_0x17725b,_0x49498f){const _0x36521d=a57_0x5f09f3,_0x535782={'created':'🆕','paid':'✅','failed':'❌','expired':'⏰','refund':'🔄','chargeback':'⚠️','processing':'⚙️'},_0x5af1df={'created':'New\x20payment\x20created','paid':_0x36521d(0xa7),'failed':_0x36521d(0xa6),'expired':_0x36521d(0x74),'refund':'Payment\x20refund','chargeback':_0x36521d(0x9d),'processing':_0x36521d(0x117)},_0x57402a=_0x535782[_0x49498f],_0x583af4=_0x5af1df[_0x49498f],_0x4f1f4e=(0x0,gateway_1['getGatewayDisplayNameForTelegram'])(_0x17725b[_0x36521d(0x137)]);console[_0x36521d(0x115)](_0x36521d(0x157)+_0x17725b[_0x36521d(0x137)]+_0x36521d(0xb4)+_0x4f1f4e+'\x22');let _0x7b4763=_0x57402a+'\x20*'+_0x583af4+_0x36521d(0x12e)+(_0x36521d(0x101)+_0x17725b['amount']+'\x20'+_0x17725b[_0x36521d(0x84)]+'*\x0a')+(_0x36521d(0x79)+(_0x17725b[_0x36521d(0x13c)]||_0x17725b['id'])+'`\x0a')+(_0x36521d(0x128)+_0x17725b['id']+'`\x0a')+(_0x36521d(0xc6)+_0x4f1f4e+'`\x0a')+('📅\x20Date:\x20'+new Date(_0x17725b['createdAt'])[_0x36521d(0x73)](_0x36521d(0xc2))+'\x0a');if(_0x17725b[_0x36521d(0x146)]||_0x17725b['customerEmail']||_0x17725b[_0x36521d(0xf2)]||_0x17725b[_0x36521d(0x136)]||_0x17725b[_0x36521d(0x11c)]){_0x7b4763+=_0x36521d(0x6d);_0x17725b[_0x36521d(0x146)]&&(_0x7b4763+=_0x36521d(0xe0)+_0x17725b['customerName']+'`\x0a');_0x17725b[_0x36521d(0x119)]&&(_0x7b4763+=_0x36521d(0x156)+_0x17725b[_0x36521d(0x119)]+'`\x0a');_0x17725b[_0x36521d(0xf2)]&&(_0x7b4763+=_0x36521d(0x140)+_0x17725b[_0x36521d(0xf2)]+'`\x0a');_0x17725b[_0x36521d(0x136)]&&(_0x7b4763+='🌐\x20IP:\x20`'+_0x17725b[_0x36521d(0x136)]+'`\x0a');if(_0x17725b['customerUa']){const _0x57d1d4=_0x17725b[_0x36521d(0x11c)][_0x36521d(0xdb)]>0x32?_0x17725b[_0x36521d(0x11c)][_0x36521d(0x103)](0x0,0x32)+_0x36521d(0x12d):_0x17725b[_0x36521d(0x11c)];_0x7b4763+='💻\x20Browser:\x20`'+_0x57d1d4+'`\x0a';}}_0x49498f===_0x36521d(0xb8)&&_0x17725b[_0x36521d(0xe5)]&&(_0x7b4763+='💸\x20Penalty\x20amount:\x20*'+_0x17725b[_0x36521d(0xe5)]+_0x36521d(0xdf)),_0x49498f===_0x36521d(0x8e)&&(_0x7b4763+=_0x36521d(0xaf)),_0x17725b['adminNotes']&&(_0x7b4763+=_0x36521d(0x100)+_0x17725b['adminNotes']+'\x0a'),await this['sendShopNotification'](_0xb2448c,_0x7b4763,{'parse_mode':'Markdown'});}async[a57_0x5f09f3(0xcb)](_0x16ef32,_0x53854b,_0x1e3726){const _0x14dbc9=a57_0x5f09f3,_0x2d80d5={'created':'📤','completed':'✅','rejected':'❌'},_0x1c557a={'created':_0x14dbc9(0x14e),'completed':'Payout\x20completed','rejected':_0x14dbc9(0x8b)},_0x42122b=_0x2d80d5[_0x1e3726],_0x1c57cf=_0x1c557a[_0x1e3726],_0x50bb2d=_0x42122b+'\x20*'+_0x1c57cf+'*\x0a\x0a'+(_0x14dbc9(0xba)+_0x53854b[_0x14dbc9(0x90)]+_0x14dbc9(0x81))+(_0x14dbc9(0xae)+_0x53854b['method']+'`\x0a')+(_0x14dbc9(0xe8)+_0x53854b['id']+'`\x0a')+(_0x14dbc9(0x118)+new Date(_0x53854b[_0x14dbc9(0x12f)])[_0x14dbc9(0x73)]('en-US')+'\x0a')+(_0x53854b[_0x14dbc9(0xc5)]?_0x14dbc9(0xf7)+_0x53854b[_0x14dbc9(0xc5)]+'`':'');await this[_0x14dbc9(0x112)](_0x16ef32,_0x50bb2d,{'parse_mode':_0x14dbc9(0x122)});}async[a57_0x5f09f3(0x11f)](_0x2988bd,_0x22c14f){const _0x19e8ec=a57_0x5f09f3;try{const _0x4fa690=await database_1[_0x19e8ec(0x8a)][_0x19e8ec(0x7b)][_0x19e8ec(0xdd)]({'where':{'shopId':_0x2988bd},'select':{'notificationLogin':!![]}});if(!_0x4fa690?.[_0x19e8ec(0xa2)]){console[_0x19e8ec(0x115)](_0x19e8ec(0xa8)+_0x2988bd);return;}const _0x4b5cf2=_0x22c14f['success']?'🔐':'🚨',_0x2a925c=_0x22c14f[_0x19e8ec(0xab)]?_0x19e8ec(0x152):_0x19e8ec(0xf5);let _0x5484b2=_0x4b5cf2+'\x20*'+_0x2a925c+'*\x0a\x0a'+(_0x19e8ec(0x135)+_0x22c14f[_0x19e8ec(0x80)]+'`\x0a')+(_0x19e8ec(0xcc)+_0x22c14f[_0x19e8ec(0x14b)][_0x19e8ec(0x73)](_0x19e8ec(0xc2))+'\x0a');_0x22c14f[_0x19e8ec(0x139)]&&(_0x5484b2+=_0x19e8ec(0x116)+_0x22c14f[_0x19e8ec(0x139)]+'`\x0a');if(_0x22c14f['userAgent']){const _0x47c5c8=_0x22c14f[_0x19e8ec(0x11a)][_0x19e8ec(0xdb)]>0x32?_0x22c14f[_0x19e8ec(0x11a)][_0x19e8ec(0x103)](0x0,0x32)+'...':_0x22c14f['userAgent'];_0x5484b2+='💻\x20Browser:\x20`'+_0x47c5c8+'`\x0a';}!_0x22c14f[_0x19e8ec(0xab)]&&(_0x5484b2+=_0x19e8ec(0xef)),await this['sendShopNotification'](_0x2988bd,_0x5484b2,{'parse_mode':_0x19e8ec(0x122)}),console[_0x19e8ec(0x115)](_0x19e8ec(0x108)+_0x2988bd+':\x20'+(_0x22c14f['success']?_0x19e8ec(0xab):_0x19e8ec(0xdc)));}catch(_0x3d5cf5){console['error']('Failed\x20to\x20send\x20login\x20notification:',_0x3d5cf5);}}async[a57_0x5f09f3(0xd9)](_0x56a62b,_0x46f51c){const _0x476d53=a57_0x5f09f3;try{const _0x498f57=await database_1[_0x476d53(0x8a)]['shopSettings'][_0x476d53(0xdd)]({'where':{'shopId':_0x56a62b},'select':{'notificationApiError':!![]}});if(!_0x498f57?.[_0x476d53(0x121)]){console[_0x476d53(0x115)](_0x476d53(0x10e)+_0x56a62b);return;}let _0x5a71ca=_0x476d53(0x126)+(_0x476d53(0xb1)+_0x46f51c[_0x476d53(0x11e)]+'\x20'+_0x46f51c[_0x476d53(0x87)]+'`\x0a')+('📅\x20Time:\x20'+_0x46f51c['timestamp'][_0x476d53(0x73)]('en-US')+'\x0a');_0x46f51c[_0x476d53(0x70)]&&(_0x5a71ca+=_0x476d53(0x10d)+_0x46f51c[_0x476d53(0x70)]+'`\x0a'),_0x5a71ca+=_0x476d53(0x6f)+_0x46f51c[_0x476d53(0x113)]+'`\x0a',_0x46f51c[_0x476d53(0x91)]&&(_0x5a71ca+=_0x476d53(0x7e)+_0x46f51c[_0x476d53(0x91)]+'`\x0a'),_0x5a71ca+='\x0a💡\x20Check\x20your\x20request\x20or\x20contact\x20support.',await this['sendShopNotification'](_0x56a62b,_0x5a71ca,{'parse_mode':_0x476d53(0x122)}),console[_0x476d53(0x115)](_0x476d53(0xff)+_0x56a62b+':\x20'+_0x46f51c[_0x476d53(0x87)]);}catch(_0x125fa4){console[_0x476d53(0xe2)](_0x476d53(0xd4),_0x125fa4);}}async[a57_0x5f09f3(0x92)](_0x56cf78,_0x418efd,_0x24d819){const _0xa0d6fc=a57_0x5f09f3;let _0x54b631='🔔\x20*'+_0x418efd+_0xa0d6fc(0x12e);for(const [_0x4beaf0,_0x42a49b]of Object['entries'](_0x24d819)){_0x42a49b!==null&&_0x42a49b!==undefined&&(_0x54b631+=_0x4beaf0+_0xa0d6fc(0xe7)+_0x42a49b+'`\x0a');}await this[_0xa0d6fc(0x112)](_0x56cf78,_0x54b631,{'parse_mode':'Markdown'});}['getBotInfo'](){const _0x433b25=a57_0x5f09f3;return{'isActive':!!this[_0x433b25(0x105)],'username':this[_0x433b25(0x7a)]};}[a57_0x5f09f3(0xb9)](){const _0xe550bd=a57_0x5f09f3;this[_0xe550bd(0x105)]&&(this[_0xe550bd(0x105)][_0xe550bd(0xc9)](),this[_0xe550bd(0x105)]=null,console['log'](_0xe550bd(0xee)));}}exports[a57_0x5f09f3(0xa9)]=TelegramBotService,exports[a57_0x5f09f3(0x120)]=new TelegramBotService();