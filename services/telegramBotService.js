'use strict';const a59_0x2a5718=a59_0x4085;function a59_0x586e(){const _0x25c6c5=['`\x20is\x20inactive.\x0a\x0a','createdAt','findFirst','userAgent','defineProperty','trapay_bot','📛\x20Name:\x20`','Use\x20/start\x20to\x20connect.','❗️\x20Make\x20sure\x20to\x20separate\x20username\x20and\x20API\x20key\x20with\x20a\x20space!','Example:\x0a','Payment\x20refund','\x20parts:\x20','Payout\x20completed','🔍\x20*Debug\x20Information*\x0a\x0a','../config/database','❌\x20Shop\x20`','onText','\x20disconnected\x20from\x20shop\x20','🚨\x20*API\x20Error*\x0a\x0a','12JOnygp','🏪\x20Available\x20shops\x20in\x20system:\x0a','3326660gIfiHB','includes','__esModule','475275LorINx','Commands:\x0a','join','method','getGatewayDisplayNameForTelegram','Payment\x20chargeback','trim','secretKey','❌\x20Shop\x20with\x20username\x20`','40tFSGDI','📊\x20*Connection\x20Status*\x0a\x0a','❌\x20You\x20are\x20not\x20registered\x20in\x20the\x20system.\x0a\x0a','🤖\x20Welcome\x20to\x20TRAPAY\x20notification\x20system!\x0a\x0a','\x20\x20\x20Status:\x20','blocked','Error\x20sending\x20shop\x20notification:','❌\x20You\x20are\x20not\x20connected\x20to\x20a\x20shop.\x0a\x0a','getBotInfo','🔔\x20You\x20receive\x20notifications\x20about:\x0a','TELEGRAM_BOT_TOKEN','📱\x20Telegram\x20notification:\x20gateway\x20\x22','env','`\x20not\x20found.\x0a\x0a','\x0a👤\x20*Customer\x20Information:*\x0a','\x20via\x20single-line\x20input','❌\x20Failed\x20to\x20send\x20notification\x20to\x20Telegram\x20user\x20','`\x0a\x0a','substring','*\x0a\x0a','publicKey','🔔\x20You\x20will\x20now\x20receive\x20notifications\x20about:\x0a','`.\x0a\x0a',':\x20`','bot','shopId','2135217KRSSkL','\x22\x20->\x20display\x20\x22','❌\x20An\x20error\x20occurred\x20while\x20verifying\x20data.','149182kfVWeT','✅\x20Login\x20notification\x20sent\x20for\x20shop\x20','chat','\x22,\x20apiKey=\x22','🏦\x20IBAN:\x20`','Telegram\x20bot\x20error:','✅\x20Welcome\x20back!\x0a\x0a','Payment\x20expired','\x20\x20\x20Public\x20Key:\x20`','•\x20Payment\x20status\x20changes\x0a','gateway','toString','🌐\x20IP\x20address:\x20`','error','📱\x20Your\x20Telegram\x20ID:\x20`','length','🔗\x20Endpoint:\x20`','user\x20is\x20deactivated','sendApiErrorNotification','telegramId','You\x20sent\x20','first_name','../types/gateway','en-US','adminNotes','amount','User\x20','1jpuTWs','•\x20New\x20payments\x0a','remitterIban','✅\x20API\x20error\x20notification\x20sent\x20for\x20shop\x20','customerName','initializeBot','...`\x0a\x0a','*.\x0a\x0a','No\x20verified\x20Telegram\x20users\x20found\x20for\x20shop\x20','ACTIVE','🔄\x20Processing\x20single-line\x20verification\x20for\x20user\x20','2579606DhWttm','🆔\x20Payout\x20ID:\x20`','customerUa','🎉\x20*Congratulations!*\x0a\x0a','Telegram\x20bot\x20not\x20initialized,\x20cannot\x20send\x20notification','\x20(@','You\x20are\x20already\x20connected\x20to\x20shop:\x20*','Failed\x20to\x20send\x20login\x20notification:','TELEGRAM_BOT_USERNAME','\x0a⚠️\x20If\x20this\x20wasn\x27t\x20you,\x20change\x20your\x20password\x20immediately!','map','📅\x20Date:\x20','/disconnect\x20-\x20disconnect\x20from\x20notifications','🌐\x20IP:\x20`','orderId','\x20initialized\x20successfully','9LALQTa','🆔\x20Request\x20ID:\x20`','📅\x20Connection\x20date:\x20','Username:\x20`','\x20\x20\x20Username:\x20`','notificationLogin','last_name','stopBot','❌\x20Failed\x20to\x20initialize\x20Telegram\x20bot:','📝\x20Format:\x20`username\x20api_key`\x0a\x0a','log','chat\x20not\x20found','❌\x20Please\x20use\x20/start\x20command\x20first','currency','sendMessage','text','warn','telegramBotService','customerEmail','Failed\x20login\x20attempt','split','endpoint','❌\x20Invalid\x20format.\x20Please\x20send\x20exactly\x202\x20parts\x20separated\x20by\x20space:\x0a\x0a','8oMMYlr','processing','\x20marked\x20as\x20unverified\x20due\x20to\x20delivery\x20failure','shop','❌\x20An\x20error\x20occurred.\x20Please\x20try\x20again\x20later.','sendCustomNotification','API\x20key\x20must\x20start\x20with\x20`pk\x5c_`\x20or\x20`sk\x5c_`.','✅\x20Telegram\x20user\x20','Payment\x20successfully\x20paid','\x0aCheck\x20spelling\x20and\x20try\x20again.','.\x20*','telegramUser','Markdown','`\x20(','txid','toLocaleString','🔔\x20*','📧\x20Email:\x20`','🔔\x20Notifications\x20are\x20active\x0a\x0a','unknown\x20shop','message','⏳\x20The\x20payment\x20is\x20currently\x20being\x20processed\x20by\x20the\x20gateway.\x0a','Error\x20handling\x20/start\x20command:','Check\x20spelling\x20and\x20try\x20again.','✅\x20You\x20have\x20been\x20successfully\x20connected\x20to\x20the\x20notification\x20system!\x0a\x0a','✅\x20Notification\x20sent\x20to\x20Telegram\x20user\x20','❌\x20Invalid\x20API\x20key\x20format.\x0a\x0a','To\x20receive\x20payment\x20notifications,\x20send\x20your\x20credentials\x20in\x20one\x20line:\x0a\x0a','Payment\x20is\x20being\x20processed','`appple\x20pk_aa6450d3f57afbefbb0f3f5be5ce6cca13037536afc5ccf14c81a6cbc7a07de5`\x0a\x0a','\x0a💡\x20Check\x20your\x20request\x20or\x20contact\x20support.',':\x20username=\x22','node-telegram-bot-api','🆔\x20Payment\x20ID:\x20`','•\x20`','Error\x20in\x20handleSingleLineVerification:','New\x20payout\x20created','👤\x20Username:\x20`','name','handleSingleLineVerification','\x20USD*\x0a','✅\x20Connected\x20to\x20shop:\x20*','17407Zheqti','findUnique','📱\x20Created\x20new\x20Telegram\x20user:\x20','toLocaleDateString','💻\x20Browser:\x20`','findMany','✅\x20Telegram\x20bot\x20@','failed','username','timestamp','sendShopNotification','success','updatedAt','✅\x20You\x20are\x20already\x20connected\x20to\x20shop\x20*','status','botUsername','Error\x20handling\x20/status\x20command:','forEach','Check\x20the\x20key\x20and\x20try\x20again.\x0a\x0a','❌\x20Invalid\x20username\x20format:\x20`','Contact\x20administrator.','📱\x20API\x20error\x20notifications\x20disabled\x20for\x20shop\x20','...','notificationApiError','🏪\x20Gateway:\x20`','create','requestId','🔌\x20User\x20','update','Failed\x20to\x20send\x20API\x20error\x20notification:','customerIp','Error\x20handling\x20message:','❌\x20Error\x20getting\x20debug\x20information.','sendPaymentNotification','botToken','sk_','statusCode','isVerified','Username\x20must\x20contain\x20only\x20letters,\x20numbers\x20and\x20underscore\x20(3-50\x20characters).','from','28260jCZaJk','New\x20payment\x20created','Expected\x20key\x20format:\x20`pk_...`\x20or\x20`sk_...`','default','setupBotHandlers','9382872pgozve','startsWith','📊\x20Error\x20code:\x20`','📱\x20Login\x20notifications\x20disabled\x20for\x20shop\x20','To\x20reconnect,\x20use\x20the\x20/start\x20command','stopPolling'];a59_0x586e=function(){return _0x25c6c5;};return a59_0x586e();}(function(_0x5c072e,_0x26a735){const _0x23cc9f=a59_0x4085,_0x363682=_0x5c072e();while(!![]){try{const _0x20df1c=-parseInt(_0x23cc9f(0x26a))/0x1*(-parseInt(_0x23cc9f(0x275))/0x2)+parseInt(_0x23cc9f(0x229))/0x3*(parseInt(_0x23cc9f(0x29c))/0x4)+-parseInt(_0x23cc9f(0x226))/0x5*(-parseInt(_0x23cc9f(0x224))/0x6)+-parseInt(_0x23cc9f(0x24c))/0x7+-parseInt(_0x23cc9f(0x20b))/0x8*(-parseInt(_0x23cc9f(0x285))/0x9)+parseInt(_0x23cc9f(0x232))/0xa*(parseInt(_0x23cc9f(0x24f))/0xb)+parseInt(_0x23cc9f(0x206))/0xc*(-parseInt(_0x23cc9f(0x1de))/0xd);if(_0x20df1c===_0x26a735)break;else _0x363682['push'](_0x363682['shift']());}catch(_0x206bbb){_0x363682['push'](_0x363682['shift']());}}}(a59_0x586e,0xac600));function a59_0x4085(_0x156b49,_0x30e6b8){const _0x586e0e=a59_0x586e();return a59_0x4085=function(_0x40855b,_0xf12639){_0x40855b=_0x40855b-0x1ca;let _0x315cf1=_0x586e0e[_0x40855b];return _0x315cf1;},a59_0x4085(_0x156b49,_0x30e6b8);}var __importDefault=this&&this['__importDefault']||function(_0x2b37e7){return _0x2b37e7&&_0x2b37e7['__esModule']?_0x2b37e7:{'default':_0x2b37e7};};Object[a59_0x2a5718(0x215)](exports,a59_0x2a5718(0x228),{'value':!![]}),exports[a59_0x2a5718(0x296)]=exports['TelegramBotService']=void 0x0;const node_telegram_bot_api_1=__importDefault(require(a59_0x2a5718(0x1d4))),database_1=__importDefault(require(a59_0x2a5718(0x21f))),gateway_1=require(a59_0x2a5718(0x265));class TelegramBotService{constructor(){const _0x446a43=a59_0x2a5718;this['bot']=null,this['botToken']=process[_0x446a43(0x23e)][_0x446a43(0x23c)]||'',this['botUsername']=process['env'][_0x446a43(0x27d)]||_0x446a43(0x216),this[_0x446a43(0x200)]?this[_0x446a43(0x26f)]():console[_0x446a43(0x295)]('TELEGRAM_BOT_TOKEN\x20not\x20found\x20in\x20environment\x20variables');}[a59_0x2a5718(0x26f)](){const _0x4df4ea=a59_0x2a5718;try{this[_0x4df4ea(0x24a)]=new node_telegram_bot_api_1['default'](this[_0x4df4ea(0x200)],{'polling':!![]}),this[_0x4df4ea(0x20a)](),console[_0x4df4ea(0x28f)](_0x4df4ea(0x1e4)+this[_0x4df4ea(0x1ed)]+_0x4df4ea(0x284));}catch(_0x21672a){console[_0x4df4ea(0x25c)](_0x4df4ea(0x28d),_0x21672a);}}[a59_0x2a5718(0x20a)](){const _0x24d187=a59_0x2a5718;if(!this[_0x24d187(0x24a)])return;this[_0x24d187(0x24a)][_0x24d187(0x221)](/\/start/,async _0x27b623=>{const _0x5f548e=_0x24d187,_0x8c39e8=_0x27b623[_0x5f548e(0x251)]['id'],_0x5955d2=_0x27b623[_0x5f548e(0x205)]?.['id']['toString'](),_0x4a3cc6=_0x27b623['from']?.['username'],_0x5ebd25=_0x27b623['from']?.[_0x5f548e(0x264)],_0x18ee60=_0x27b623['from']?.[_0x5f548e(0x28b)];if(!_0x5955d2)return;try{let _0x4a4c83=await database_1[_0x5f548e(0x209)]['telegramUser']['findUnique']({'where':{'telegramId':_0x5955d2},'include':{'shop':!![]}});!_0x4a4c83?(_0x4a4c83=await database_1[_0x5f548e(0x209)][_0x5f548e(0x2a7)][_0x5f548e(0x1f7)]({'data':{'telegramId':_0x5955d2,'username':_0x4a3cc6,'firstName':_0x5ebd25,'lastName':_0x18ee60,'isVerified':![],'shopId':null},'include':{'shop':!![]}}),console[_0x5f548e(0x28f)](_0x5f548e(0x1e0)+_0x5955d2+_0x5f548e(0x27a)+_0x4a3cc6+')')):_0x4a4c83=await database_1['default'][_0x5f548e(0x2a7)][_0x5f548e(0x1fa)]({'where':{'telegramId':_0x5955d2},'data':{'username':_0x4a3cc6,'firstName':_0x5ebd25,'lastName':_0x18ee60},'include':{'shop':!![]}}),_0x4a4c83[_0x5f548e(0x203)]&&_0x4a4c83[_0x5f548e(0x24b)]&&_0x4a4c83['shop']?await this[_0x5f548e(0x24a)]?.[_0x5f548e(0x293)](_0x8c39e8,_0x5f548e(0x255)+(_0x5f548e(0x27b)+_0x4a4c83['shop'][_0x5f548e(0x1da)]+'*\x0a')+(_0x5f548e(0x288)+_0x4a4c83[_0x5f548e(0x29f)]['username']+_0x5f548e(0x243))+_0x5f548e(0x23b)+_0x5f548e(0x26b)+_0x5f548e(0x258)+'•\x20Payouts\x0a\x0a'+'Commands:\x0a'+'/status\x20-\x20check\x20connection\x20status\x0a'+_0x5f548e(0x281),{'parse_mode':'Markdown'}):(_0x4a4c83[_0x5f548e(0x24b)]&&!_0x4a4c83[_0x5f548e(0x203)]&&(await database_1[_0x5f548e(0x209)][_0x5f548e(0x2a7)][_0x5f548e(0x1fa)]({'where':{'telegramId':_0x5955d2},'data':{'shopId':null,'isVerified':![]}}),console[_0x5f548e(0x28f)]('🔄\x20Reset\x20incomplete\x20verification\x20for\x20user\x20'+_0x5955d2)),await this[_0x5f548e(0x24a)]?.[_0x5f548e(0x293)](_0x8c39e8,_0x5f548e(0x235)+_0x5f548e(0x1cf)+_0x5f548e(0x28e)+_0x5f548e(0x21a)+_0x5f548e(0x1d1)+_0x5f548e(0x219),{'parse_mode':_0x5f548e(0x2a8)}));}catch(_0x46e6ef){console[_0x5f548e(0x25c)](_0x5f548e(0x1ca),_0x46e6ef),await this[_0x5f548e(0x24a)]?.[_0x5f548e(0x293)](_0x8c39e8,_0x5f548e(0x2a0));}}),this[_0x24d187(0x24a)][_0x24d187(0x221)](/\/disconnect/,async _0x3d3142=>{const _0x1b99be=_0x24d187,_0x38bb5d=_0x3d3142['chat']['id'],_0x456d20=_0x3d3142['from']?.['id']['toString']();if(!_0x456d20)return;try{const _0x2bf4dd=await database_1[_0x1b99be(0x209)]['telegramUser'][_0x1b99be(0x1df)]({'where':{'telegramId':_0x456d20},'include':{'shop':!![]}});if(!_0x2bf4dd||!_0x2bf4dd['isVerified']||!_0x2bf4dd[_0x1b99be(0x24b)]){await this['bot']?.['sendMessage'](_0x38bb5d,'❌\x20You\x20are\x20not\x20connected\x20to\x20the\x20notification\x20system.');return;}const _0x360dec=_0x2bf4dd[_0x1b99be(0x29f)]?.[_0x1b99be(0x1da)]||_0x1b99be(0x2af);await database_1[_0x1b99be(0x209)][_0x1b99be(0x2a7)][_0x1b99be(0x1fa)]({'where':{'telegramId':_0x456d20},'data':{'shopId':null,'isVerified':![]}}),console[_0x1b99be(0x28f)](_0x1b99be(0x1f9)+_0x456d20+_0x1b99be(0x222)+_0x2bf4dd[_0x1b99be(0x24b)]),await this[_0x1b99be(0x24a)]?.['sendMessage'](_0x38bb5d,'✅\x20You\x20have\x20been\x20successfully\x20disconnected\x20from\x20shop\x20*'+_0x360dec+'*.\x0a\x0a'+_0x1b99be(0x20f),{'parse_mode':_0x1b99be(0x2a8)});}catch(_0x4453dd){console[_0x1b99be(0x25c)]('Error\x20handling\x20/disconnect\x20command:',_0x4453dd),await this[_0x1b99be(0x24a)]?.['sendMessage'](_0x38bb5d,_0x1b99be(0x2a0));}}),this['bot'][_0x24d187(0x221)](/\/status/,async _0x2e59dd=>{const _0x4a0382=_0x24d187,_0x47c945=_0x2e59dd[_0x4a0382(0x251)]['id'],_0x27640d=_0x2e59dd['from']?.['id'][_0x4a0382(0x25a)]();if(!_0x27640d)return;try{const _0x508c3c=await database_1[_0x4a0382(0x209)]['telegramUser'][_0x4a0382(0x1df)]({'where':{'telegramId':_0x27640d},'include':{'shop':!![]}});if(!_0x508c3c){await this[_0x4a0382(0x24a)]?.[_0x4a0382(0x293)](_0x47c945,_0x4a0382(0x234)+'Use\x20/start\x20to\x20begin.');return;}if(!_0x508c3c[_0x4a0382(0x203)]||!_0x508c3c[_0x4a0382(0x24b)]||!_0x508c3c[_0x4a0382(0x29f)]){await this[_0x4a0382(0x24a)]?.[_0x4a0382(0x293)](_0x47c945,_0x4a0382(0x239)+_0x4a0382(0x218));return;}await this[_0x4a0382(0x24a)]?.[_0x4a0382(0x293)](_0x47c945,_0x4a0382(0x233)+(_0x4a0382(0x1dd)+_0x508c3c['shop'][_0x4a0382(0x1da)]+'*\x0a')+(_0x4a0382(0x1d9)+_0x508c3c[_0x4a0382(0x29f)]['username']+'`\x0a')+(_0x4a0382(0x287)+_0x508c3c[_0x4a0382(0x1ea)][_0x4a0382(0x1e1)](_0x4a0382(0x266))+'\x0a\x0a')+_0x4a0382(0x2ae)+_0x4a0382(0x22a)+_0x4a0382(0x281),{'parse_mode':_0x4a0382(0x2a8)});}catch(_0x3b1203){console[_0x4a0382(0x25c)](_0x4a0382(0x1ee),_0x3b1203),await this[_0x4a0382(0x24a)]?.[_0x4a0382(0x293)](_0x47c945,_0x4a0382(0x2a0));}}),this[_0x24d187(0x24a)][_0x24d187(0x221)](/\/debug/,async _0x28deab=>{const _0x47c8f9=_0x24d187,_0x15d77b=_0x28deab[_0x47c8f9(0x251)]['id'],_0xc2be41=_0x28deab['from']?.['id'][_0x47c8f9(0x25a)]();if(!_0xc2be41)return;try{const _0x47a8bf=await database_1[_0x47c8f9(0x209)][_0x47c8f9(0x29f)][_0x47c8f9(0x1e3)]({'select':{'id':!![],'name':!![],'username':!![],'status':!![],'publicKey':!![]},'take':0xa});let _0x324adb=_0x47c8f9(0x21e);_0x324adb+=_0x47c8f9(0x25d)+_0xc2be41+_0x47c8f9(0x243),_0x324adb+=_0x47c8f9(0x225),_0x47a8bf['forEach']((_0x26dcd5,_0x2d03e0)=>{const _0x47e2cb=_0x47c8f9;_0x324adb+=_0x2d03e0+0x1+_0x47e2cb(0x2a6)+_0x26dcd5[_0x47e2cb(0x1da)]+'*\x0a',_0x324adb+=_0x47e2cb(0x289)+_0x26dcd5[_0x47e2cb(0x1e6)]+'`\x0a',_0x324adb+=_0x47e2cb(0x236)+_0x26dcd5[_0x47e2cb(0x1ec)]+'\x0a',_0x324adb+=_0x47e2cb(0x257)+_0x26dcd5[_0x47e2cb(0x246)]['substring'](0x0,0xf)+_0x47e2cb(0x270);}),await this[_0x47c8f9(0x24a)]?.['sendMessage'](_0x15d77b,_0x324adb,{'parse_mode':_0x47c8f9(0x2a8)});}catch(_0x54820b){console['error']('Error\x20handling\x20/debug\x20command:',_0x54820b),await this['bot']?.[_0x47c8f9(0x293)](_0x15d77b,_0x47c8f9(0x1fe));}}),this[_0x24d187(0x24a)]['on'](_0x24d187(0x2b0),async _0x221450=>{const _0x46c8c4=_0x24d187;if(_0x221450[_0x46c8c4(0x294)]?.[_0x46c8c4(0x20c)]('/'))return;const _0x566eea=_0x221450['chat']['id'],_0x2ec27d=_0x221450['from']?.['id'][_0x46c8c4(0x25a)](),_0xbbf50c=_0x221450[_0x46c8c4(0x294)]?.[_0x46c8c4(0x22f)]();if(!_0x2ec27d||!_0xbbf50c)return;try{const _0x159eaa=await database_1['default'][_0x46c8c4(0x2a7)][_0x46c8c4(0x1df)]({'where':{'telegramId':_0x2ec27d},'include':{'shop':!![]}});if(!_0x159eaa){await this['bot']?.[_0x46c8c4(0x293)](_0x566eea,_0x46c8c4(0x291));return;}if(_0x159eaa['isVerified']&&_0x159eaa[_0x46c8c4(0x24b)]&&_0x159eaa[_0x46c8c4(0x29f)]){await this[_0x46c8c4(0x24a)]?.[_0x46c8c4(0x293)](_0x566eea,_0x46c8c4(0x1eb)+_0x159eaa[_0x46c8c4(0x29f)][_0x46c8c4(0x1da)]+_0x46c8c4(0x271)+'Use\x20/status\x20to\x20check\x20status\x20or\x20/disconnect\x20to\x20disconnect.',{'parse_mode':_0x46c8c4(0x2a8)});return;}const _0x2cff3d=_0xbbf50c[_0x46c8c4(0x299)](/\s+/);if(_0x2cff3d['length']!==0x2){await this[_0x46c8c4(0x24a)]?.[_0x46c8c4(0x293)](_0x566eea,_0x46c8c4(0x29b)+_0x46c8c4(0x28e)+_0x46c8c4(0x21a)+_0x46c8c4(0x1d1)+(_0x46c8c4(0x263)+_0x2cff3d[_0x46c8c4(0x25e)]+_0x46c8c4(0x21c)+_0x2cff3d[_0x46c8c4(0x27f)](_0x4f95c6=>'`'+_0x4f95c6+'`')[_0x46c8c4(0x22b)](',\x20')),{'parse_mode':'Markdown'});return;}const [_0xcd08c6,_0x4bc440]=_0x2cff3d;console[_0x46c8c4(0x28f)]('🔄\x20Processing\x20single-line\x20verification\x20for\x20user\x20'+_0x2ec27d+_0x46c8c4(0x1d3)+_0xcd08c6+'\x22,\x20apiKey=\x22'+_0x4bc440[_0x46c8c4(0x244)](0x0,0xa)+'...\x22'),await this[_0x46c8c4(0x1db)](_0x566eea,_0x2ec27d,_0xcd08c6,_0x4bc440);}catch(_0x28505f){console[_0x46c8c4(0x25c)](_0x46c8c4(0x1fd),_0x28505f),await this[_0x46c8c4(0x24a)]?.[_0x46c8c4(0x293)](_0x566eea,_0x46c8c4(0x2a0));}}),this['bot']['on'](_0x24d187(0x25c),_0x2ea5c3=>{const _0x5755b3=_0x24d187;console['error'](_0x5755b3(0x254),_0x2ea5c3);}),this[_0x24d187(0x24a)]['on']('polling_error',_0x1ce359=>{console['error']('Telegram\x20bot\x20polling\x20error:',_0x1ce359);});}async[a59_0x2a5718(0x1db)](_0x5a7a35,_0x312edf,_0x5ed76c,_0x5805c5){const _0x29f737=a59_0x2a5718;try{console['log'](_0x29f737(0x274)+_0x312edf+_0x29f737(0x1d3)+_0x5ed76c+_0x29f737(0x252)+_0x5805c5[_0x29f737(0x244)](0x0,0xa)+'...\x22');if(!_0x5ed76c||_0x5ed76c[_0x29f737(0x25e)]<0x3||_0x5ed76c['length']>0x32||!/^[a-zA-Z0-9_]+$/['test'](_0x5ed76c)){await this['bot']?.[_0x29f737(0x293)](_0x5a7a35,_0x29f737(0x1f1)+_0x5ed76c+'`\x0a\x0a'+_0x29f737(0x204),{'parse_mode':'Markdown'});return;}if(!_0x5805c5||!_0x5805c5[_0x29f737(0x20c)]('pk_')&&!_0x5805c5['startsWith'](_0x29f737(0x201))){await this[_0x29f737(0x24a)]?.['sendMessage'](_0x5a7a35,_0x29f737(0x1ce)+_0x29f737(0x2a2),{'parse_mode':_0x29f737(0x2a8)});return;}const _0x57a005=await database_1[_0x29f737(0x209)][_0x29f737(0x29f)][_0x29f737(0x1df)]({'where':{'username':_0x5ed76c},'select':{'id':!![],'name':!![],'username':!![],'status':!![],'publicKey':!![],'secretKey':!![]}});if(!_0x57a005){const _0x361bec=await database_1[_0x29f737(0x209)]['shop'][_0x29f737(0x1e3)]({'select':{'username':!![],'name':!![]},'take':0x5});let _0x277b69=_0x29f737(0x231)+_0x5ed76c+_0x29f737(0x23f);_0x361bec[_0x29f737(0x25e)]>0x0?(_0x277b69+='Available\x20usernames:\x0a',_0x361bec[_0x29f737(0x1ef)](_0x13a3b3=>{const _0xdf726=_0x29f737;_0x277b69+=_0xdf726(0x1d6)+_0x13a3b3['username']+_0xdf726(0x2a9)+_0x13a3b3[_0xdf726(0x1da)]+')\x0a';}),_0x277b69+=_0x29f737(0x2a5)):_0x277b69+=_0x29f737(0x1cb);await this[_0x29f737(0x24a)]?.[_0x29f737(0x293)](_0x5a7a35,_0x277b69,{'parse_mode':_0x29f737(0x2a8)});return;}if(_0x57a005['status']!==_0x29f737(0x273)){await this['bot']?.[_0x29f737(0x293)](_0x5a7a35,_0x29f737(0x220)+_0x5ed76c+_0x29f737(0x211)+_0x29f737(0x1f2),{'parse_mode':_0x29f737(0x2a8)});return;}if(_0x57a005['publicKey']!==_0x5805c5&&_0x57a005[_0x29f737(0x230)]!==_0x5805c5){await this[_0x29f737(0x24a)]?.[_0x29f737(0x293)](_0x5a7a35,'❌\x20API\x20key\x20does\x20not\x20match\x20shop\x20`'+_0x5ed76c+'`.\x0a\x0a'+_0x29f737(0x1f0)+_0x29f737(0x208),{'parse_mode':_0x29f737(0x2a8)});return;}const _0x3b1ed1=await database_1[_0x29f737(0x209)][_0x29f737(0x2a7)][_0x29f737(0x213)]({'where':{'shopId':_0x57a005['id'],'isVerified':!![],'telegramId':{'not':_0x312edf}}});if(_0x3b1ed1){await this[_0x29f737(0x24a)]?.[_0x29f737(0x293)](_0x5a7a35,'❌\x20Another\x20Telegram\x20account\x20is\x20already\x20connected\x20to\x20shop\x20`'+_0x5ed76c+_0x29f737(0x248)+'Disconnect\x20the\x20previous\x20account\x20first\x20or\x20contact\x20administrator.',{'parse_mode':_0x29f737(0x2a8)});return;}await database_1['default'][_0x29f737(0x2a7)][_0x29f737(0x1fa)]({'where':{'telegramId':_0x312edf},'data':{'shopId':_0x57a005['id'],'isVerified':!![]}}),await this[_0x29f737(0x24a)]?.['sendMessage'](_0x5a7a35,_0x29f737(0x278)+_0x29f737(0x1cc)+('📱\x20Shop:\x20*'+_0x57a005['name']+'*\x0a')+('👤\x20Username:\x20`'+_0x57a005[_0x29f737(0x1e6)]+'`\x0a\x0a')+_0x29f737(0x247)+'•\x20New\x20payments\x0a'+_0x29f737(0x258)+'•\x20Payouts\x0a'+'•\x20Important\x20events\x0a\x0a'+_0x29f737(0x22a)+'/status\x20-\x20check\x20connection\x20status\x0a'+_0x29f737(0x281),{'parse_mode':_0x29f737(0x2a8)}),console[_0x29f737(0x28f)](_0x29f737(0x2a3)+_0x312edf+'\x20verified\x20for\x20shop\x20'+_0x57a005[_0x29f737(0x1e6)]+_0x29f737(0x241));}catch(_0x8af92d){console['error'](_0x29f737(0x1d7),_0x8af92d),await this[_0x29f737(0x24a)]?.[_0x29f737(0x293)](_0x5a7a35,_0x29f737(0x24e));}}async[a59_0x2a5718(0x1e8)](_0x4253d2,_0x2a36bc,_0x5b75fa){const _0x587396=a59_0x2a5718;if(!this['bot']){console[_0x587396(0x295)](_0x587396(0x279));return;}try{const _0x1167c1=await database_1[_0x587396(0x209)]['telegramUser'][_0x587396(0x1e3)]({'where':{'shopId':_0x4253d2,'isVerified':!![]}});if(_0x1167c1[_0x587396(0x25e)]===0x0){console[_0x587396(0x28f)](_0x587396(0x272)+_0x4253d2);return;}const _0xbfb826=_0x1167c1[_0x587396(0x27f)](async _0x1fb425=>{const _0x13b5c5=_0x587396;try{await this[_0x13b5c5(0x24a)]?.[_0x13b5c5(0x293)](_0x1fb425[_0x13b5c5(0x262)],_0x2a36bc,_0x5b75fa),console['log'](_0x13b5c5(0x1cd)+_0x1fb425['telegramId']);}catch(_0x1ee2e1){console['error'](_0x13b5c5(0x242)+_0x1fb425[_0x13b5c5(0x262)]+':',_0x1ee2e1),_0x1ee2e1 instanceof Error&&(_0x1ee2e1[_0x13b5c5(0x2b0)][_0x13b5c5(0x227)](_0x13b5c5(0x237))||_0x1ee2e1[_0x13b5c5(0x2b0)][_0x13b5c5(0x227)](_0x13b5c5(0x290))||_0x1ee2e1[_0x13b5c5(0x2b0)][_0x13b5c5(0x227)](_0x13b5c5(0x260)))&&(await database_1[_0x13b5c5(0x209)][_0x13b5c5(0x2a7)][_0x13b5c5(0x1fa)]({'where':{'id':_0x1fb425['id']},'data':{'isVerified':![]}}),console[_0x13b5c5(0x28f)](_0x13b5c5(0x269)+_0x1fb425[_0x13b5c5(0x262)]+_0x13b5c5(0x29e)));}});await Promise['allSettled'](_0xbfb826);}catch(_0x490c2f){console[_0x587396(0x25c)](_0x587396(0x238),_0x490c2f);}}async[a59_0x2a5718(0x1ff)](_0x1d11d8,_0x40c04e,_0x4a558e){const _0x238b01=a59_0x2a5718,_0x21e0b2={'created':'🆕','paid':'✅','failed':'❌','expired':'⏰','refund':'🔄','chargeback':'⚠️','processing':'⚙️'},_0x5797e8={'created':_0x238b01(0x207),'paid':_0x238b01(0x2a4),'failed':'Payment\x20failed','expired':_0x238b01(0x256),'refund':_0x238b01(0x21b),'chargeback':_0x238b01(0x22e),'processing':_0x238b01(0x1d0)},_0x5883af=_0x21e0b2[_0x4a558e],_0x4e9a2a=_0x5797e8[_0x4a558e],_0x4bf0b8=(0x0,gateway_1[_0x238b01(0x22d)])(_0x40c04e['gateway']);console[_0x238b01(0x28f)](_0x238b01(0x23d)+_0x40c04e[_0x238b01(0x259)]+_0x238b01(0x24d)+_0x4bf0b8+'\x22');let _0x3fdaed=_0x5883af+'\x20*'+_0x4e9a2a+'*\x0a\x0a'+('💰\x20Amount:\x20*'+_0x40c04e[_0x238b01(0x268)]+'\x20'+_0x40c04e[_0x238b01(0x292)]+'*\x0a')+('📝\x20Order\x20ID:\x20`'+(_0x40c04e[_0x238b01(0x283)]||_0x40c04e['id'])+'`\x0a')+(_0x238b01(0x1d5)+_0x40c04e['id']+'`\x0a')+(_0x238b01(0x1f6)+_0x4bf0b8+'`\x0a')+(_0x238b01(0x280)+new Date(_0x40c04e[_0x238b01(0x212)])[_0x238b01(0x2ab)](_0x238b01(0x266))+'\x0a');if(_0x40c04e[_0x238b01(0x26e)]||_0x40c04e[_0x238b01(0x297)]||_0x40c04e[_0x238b01(0x26c)]||_0x40c04e[_0x238b01(0x1fc)]||_0x40c04e['customerUa']){_0x3fdaed+=_0x238b01(0x240);_0x40c04e[_0x238b01(0x26e)]&&(_0x3fdaed+=_0x238b01(0x217)+_0x40c04e[_0x238b01(0x26e)]+'`\x0a');_0x40c04e['customerEmail']&&(_0x3fdaed+=_0x238b01(0x2ad)+_0x40c04e[_0x238b01(0x297)]+'`\x0a');_0x40c04e[_0x238b01(0x26c)]&&(_0x3fdaed+=_0x238b01(0x253)+_0x40c04e[_0x238b01(0x26c)]+'`\x0a');_0x40c04e['customerIp']&&(_0x3fdaed+=_0x238b01(0x282)+_0x40c04e[_0x238b01(0x1fc)]+'`\x0a');if(_0x40c04e[_0x238b01(0x277)]){const _0x2e7169=_0x40c04e['customerUa']['length']>0x32?_0x40c04e[_0x238b01(0x277)][_0x238b01(0x244)](0x0,0x32)+_0x238b01(0x1f4):_0x40c04e[_0x238b01(0x277)];_0x3fdaed+=_0x238b01(0x1e2)+_0x2e7169+'`\x0a';}}_0x4a558e==='chargeback'&&_0x40c04e['chargebackAmount']&&(_0x3fdaed+='💸\x20Penalty\x20amount:\x20*'+_0x40c04e['chargebackAmount']+'\x20USDT*\x0a'),_0x4a558e===_0x238b01(0x29d)&&(_0x3fdaed+=_0x238b01(0x2b1)),_0x40c04e[_0x238b01(0x267)]&&(_0x3fdaed+='📝\x20Notes:\x20'+_0x40c04e[_0x238b01(0x267)]+'\x0a'),await this[_0x238b01(0x1e8)](_0x1d11d8,_0x3fdaed,{'parse_mode':_0x238b01(0x2a8)});}async['sendPayoutNotification'](_0x53e08c,_0x532324,_0x6699a4){const _0xad765e=a59_0x2a5718,_0x528a47={'created':'📤','completed':'✅','rejected':'❌'},_0x3fe654={'created':_0xad765e(0x1d8),'completed':_0xad765e(0x21d),'rejected':'Payout\x20rejected'},_0x2a082d=_0x528a47[_0x6699a4],_0x162b76=_0x3fe654[_0x6699a4],_0x2fb0e9=_0x2a082d+'\x20*'+_0x162b76+_0xad765e(0x245)+('💸\x20Amount:\x20*'+_0x532324[_0xad765e(0x268)]+_0xad765e(0x1dc))+('🏦\x20Method:\x20`'+_0x532324[_0xad765e(0x22c)]+'`\x0a')+(_0xad765e(0x276)+_0x532324['id']+'`\x0a')+(_0xad765e(0x280)+new Date(_0x532324[_0xad765e(0x212)])[_0xad765e(0x2ab)]('en-US')+'\x0a')+(_0x532324[_0xad765e(0x2aa)]?'🔗\x20TXID:\x20`'+_0x532324[_0xad765e(0x2aa)]+'`':'');await this[_0xad765e(0x1e8)](_0x53e08c,_0x2fb0e9,{'parse_mode':_0xad765e(0x2a8)});}async['sendLoginNotification'](_0xb33ef3,_0x2d733b){const _0x73d262=a59_0x2a5718;try{const _0x50bf81=await database_1[_0x73d262(0x209)]['shopSettings'][_0x73d262(0x1df)]({'where':{'shopId':_0xb33ef3},'select':{'notificationLogin':!![]}});if(!_0x50bf81?.[_0x73d262(0x28a)]){console[_0x73d262(0x28f)](_0x73d262(0x20e)+_0xb33ef3);return;}const _0x290981=_0x2d733b[_0x73d262(0x1e9)]?'🔐':'🚨',_0x48ebd0=_0x2d733b['success']?'Successful\x20login':_0x73d262(0x298);let _0x4cb3c8=_0x290981+'\x20*'+_0x48ebd0+_0x73d262(0x245)+('👤\x20Username:\x20`'+_0x2d733b[_0x73d262(0x1e6)]+'`\x0a')+('📅\x20Time:\x20'+_0x2d733b[_0x73d262(0x1e7)][_0x73d262(0x2ab)](_0x73d262(0x266))+'\x0a');_0x2d733b['ipAddress']&&(_0x4cb3c8+=_0x73d262(0x25b)+_0x2d733b['ipAddress']+'`\x0a');if(_0x2d733b[_0x73d262(0x214)]){const _0x369998=_0x2d733b[_0x73d262(0x214)]['length']>0x32?_0x2d733b[_0x73d262(0x214)]['substring'](0x0,0x32)+_0x73d262(0x1f4):_0x2d733b['userAgent'];_0x4cb3c8+='💻\x20Browser:\x20`'+_0x369998+'`\x0a';}!_0x2d733b[_0x73d262(0x1e9)]&&(_0x4cb3c8+=_0x73d262(0x27e)),await this[_0x73d262(0x1e8)](_0xb33ef3,_0x4cb3c8,{'parse_mode':_0x73d262(0x2a8)}),console['log'](_0x73d262(0x250)+_0xb33ef3+':\x20'+(_0x2d733b[_0x73d262(0x1e9)]?'success':_0x73d262(0x1e5)));}catch(_0x5c9061){console[_0x73d262(0x25c)](_0x73d262(0x27c),_0x5c9061);}}async[a59_0x2a5718(0x261)](_0x4e54bb,_0x4bf3b1){const _0x323a00=a59_0x2a5718;try{const _0xd61263=await database_1[_0x323a00(0x209)]['shopSettings'][_0x323a00(0x1df)]({'where':{'shopId':_0x4e54bb},'select':{'notificationApiError':!![]}});if(!_0xd61263?.[_0x323a00(0x1f5)]){console[_0x323a00(0x28f)](_0x323a00(0x1f3)+_0x4e54bb);return;}let _0x13cc59=_0x323a00(0x223)+(_0x323a00(0x25f)+_0x4bf3b1['method']+'\x20'+_0x4bf3b1[_0x323a00(0x29a)]+'`\x0a')+('📅\x20Time:\x20'+_0x4bf3b1[_0x323a00(0x1e7)][_0x323a00(0x2ab)](_0x323a00(0x266))+'\x0a');_0x4bf3b1['statusCode']&&(_0x13cc59+=_0x323a00(0x20d)+_0x4bf3b1[_0x323a00(0x202)]+'`\x0a'),_0x13cc59+='❌\x20Error:\x20`'+_0x4bf3b1['errorMessage']+'`\x0a',_0x4bf3b1['requestId']&&(_0x13cc59+=_0x323a00(0x286)+_0x4bf3b1[_0x323a00(0x1f8)]+'`\x0a'),_0x13cc59+=_0x323a00(0x1d2),await this[_0x323a00(0x1e8)](_0x4e54bb,_0x13cc59,{'parse_mode':_0x323a00(0x2a8)}),console[_0x323a00(0x28f)](_0x323a00(0x26d)+_0x4e54bb+':\x20'+_0x4bf3b1[_0x323a00(0x29a)]);}catch(_0x4e7f93){console[_0x323a00(0x25c)](_0x323a00(0x1fb),_0x4e7f93);}}async[a59_0x2a5718(0x2a1)](_0x2de7b3,_0x11d556,_0x4f5b58){const _0x511994=a59_0x2a5718;let _0x2e5c13=_0x511994(0x2ac)+_0x11d556+_0x511994(0x245);for(const [_0x4a382e,_0x1419e0]of Object['entries'](_0x4f5b58)){_0x1419e0!==null&&_0x1419e0!==undefined&&(_0x2e5c13+=_0x4a382e+_0x511994(0x249)+_0x1419e0+'`\x0a');}await this[_0x511994(0x1e8)](_0x2de7b3,_0x2e5c13,{'parse_mode':_0x511994(0x2a8)});}[a59_0x2a5718(0x23a)](){const _0x10f0eb=a59_0x2a5718;return{'isActive':!!this[_0x10f0eb(0x24a)],'username':this[_0x10f0eb(0x1ed)]};}[a59_0x2a5718(0x28c)](){const _0x2000a8=a59_0x2a5718;this[_0x2000a8(0x24a)]&&(this['bot'][_0x2000a8(0x210)](),this[_0x2000a8(0x24a)]=null,console[_0x2000a8(0x28f)]('🛑\x20Telegram\x20bot\x20stopped'));}}exports['TelegramBotService']=TelegramBotService,exports[a59_0x2a5718(0x296)]=new TelegramBotService();