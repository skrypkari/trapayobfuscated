'use strict';function a87_0x88bb(){const _0x4d8557=['txid','botUsername','Multi\x20Use','parse','Please\x20check\x20the\x20spelling\x20and\x20try\x20again.\x0a\x0a','âŒ\x20You\x20are\x20not\x20connected\x20to\x20a\x20shop.\x0a\x0a','getUTCFullYear','âœ…\x20File\x20sent\x20to\x20','\x20verified\x20for\x20shop\x20','type','\x20\x5c|\x20Type:\x20','\x20initialized\x20successfully','stats_yesterday','âŒ\x20Telegram\x20bot\x20not\x20initialized','ðŸ“‹\x20*Payment\x20Links*\x0a\x0aNo\x20payment\x20links\x20found\x5c.\x0a\x0aCreate\x20your\x20first\x20payment\x20link\x5c!','`.\x0a\x0a','Error\x20in\x20payment\x20link\x20flow:','PENDING','âœ…\x20Direct\x20message\x20sent\x20to\x20chat\x20','âœ…\x20Successful\x20Payments\x20\x5c-\x20','\x20USDC','Error\x20handling\x20/debug\x20command:','ðŸ“±\x20Notification\x20sent\x20to\x20','from','âœ…\x20File\x20sent\x20to\x20chat\x20','âŒ\x20Maximum\x20number\x20of\x20connected\x20accounts\x20(5)\x20reached\x20for\x20shop\x20`','Coming\x20soon...\x0a\x0a','updatedAt','step','\x22,\x20apiKey=\x22','cmd_disconnect','delete','sendDocument','Check\x20the\x20key\x20and\x20try\x20again.\x0a\x0a','âŒ\x20Invalid\x20API\x20key\x20format.\x0a\x0a','â€¢\x20Quick\x20create\x20new\x20link\x0a','getBotInfo','.pdf','push','ðŸ’³\x20*Wallet:*\x20`','paymentGateways','ðŸ“±\x20Sending\x20notification\x20to\x20all\x20connected\x20users:\x20','Error\x20handling\x20/statistics\x20command:','ðŸ“\x20Order\x20ID:\x20`','chargeback','onText','LTC','stats_today','allSettled','âœ…\x20*Payment\x20Link\x20Created\x20Successfully\x5c!*\x0a\x0a','polling_error','1624635xHOcVv','âŒ\x20Shop\x20with\x20username\x20`','cmd_status','\x20users','Not\x20specified','`\x0a\x0a','âŒ\x20No\x20gateways\x20configured.\x20Please\x20configure\x20gateways\x20in\x20the\x20admin\x20panel\x20first.','ðŸ†”\x20Payment\x20ID:\x20`','Error\x20handling\x20/status\x20command:','telegramId','sendDirectFile','warn','`appple\x20pk_aa6450d3f57afbefbb0f3f5be5ce6cca13037536afc5ccf14c81a6cbc7a07de5`\x0a\x0a','âŒ\x20Invalid\x20amount.\x20Please\x20enter\x20a\x20valid\x20number\x20greater\x20than\x200.','node-telegram-bot-api','âŒ\x20API\x20key\x20does\x20not\x20match\x20shop\x20`','filter','Unknown','ðŸ””\x20Notifications\x20are\x20active\x0a\x0a','ðŸ”„\x20Reset\x20incomplete\x20verification\x20for\x20user\x20','GBP','length','padStart','ðŸ“Š\x20*Statistics*\x0a\x0aSelect\x20period:','all','â¬…ï¸\x20Previous','pl_type_multi','payment','\x20disconnected\x20from\x20shop\x20','EXPIRED','findMany','1545610YdYojC','SINGLE','â€¢\x20Important\x20events','ðŸ”—\x20*Payment\x20Links*\x0a\x0a','3503095XowUDQ','Username:\x20`','\x22\x20->\x20display\x20\x22','userAgent','Error\x20handling\x20/payouts\x20command:','âŒ\x20Unknown\x20command','Use\x20/start\x20to\x20connect\x20to\x20a\x20shop.','\x20\x20\x20[LINK](','4zVAoMM','Please\x20send\x20the\x20amount\x20in\x20','en-US','name','customerEmail','pl_page_','publicKey','âœ…\x20Notification\x20sent\x20to\x20Telegram\x20user\x20','âŒ\x20Failed\x20to\x20send\x20message\x20to\x20user\x20','user\x20is\x20deactivated','âœ…\x20You\x20are\x20already\x20connected\x20to\x20shop\x20*','ðŸ›‘\x20Telegram\x20bot\x20stopped','stats_last_month','\x20\x20\x20Gateway:\x20','Successful\x20login','UTC','substring','sendApiErrorNotification','â€¢\x20Transaction\x20status\x0a','balance','error','â€¢\x20Payment\x20status\x20changes\x0a','ðŸ“…\x20*Payout\x20Date:*\x20','âŒ\x20No\x20active\x20gateways\x20found.\x20Please\x20enable\x20at\x20least\x20one\x20gateway\x20in\x20the\x20admin\x20panel.','sendPaymentNotification','/payment\x5c_links\x20-\x20manage\x20payment\x20links\x0a','â³\x20Pending\x20payouts:\x20','../types/gateway','âŒ\x20Error\x20getting\x20debug\x20information.','ðŸ’°\x20Amount:\x20','.jpg','CHF','.png','EUR','replace','stats_this_month','â€¢\x20Payouts\x0a','ðŸ“\x20Format:\x20`username\x20api_key`\x0a\x0a','âŒ\x20Shop\x20`','ðŸ“…\x20Last\x20Month','TRY','âŒ\x20Error\x20getting\x20statistics','ðŸŒ\x20IP:\x20`','No\x20verified\x20Telegram\x20users\x20found\x20for\x20shop\x20','You\x20sent\x20','`\x20is\x20inactive.\x0a\x0a','cmd_payouts','get','Telegram\x20bot\x20not\x20initialized,\x20cannot\x20send\x20notification','handleSingleLineVerification','sendLoginNotification','ðŸ’¸\x20Payouts','â™¾ï¸\x20Multi\x20Use','Payment\x20is\x20being\x20processed','text','getGatewayDisplayNameForTelegram','Payment\x20expired','ðŸ¦\x20IBAN:\x20`','Single\x20Use','âŒ\x20An\x20error\x20occurred\x20while\x20loading\x20payment\x20links.','This\x20feature\x20will\x20show:\x0a','âŒ\x20You\x20are\x20not\x20connected\x20to\x20the\x20notification\x20system.','API\x20key\x20must\x20start\x20with\x20`pk\x5c_`\x20or\x20`sk\x5c_`.','period','setupBotHandlers','CHARGEBACK','sendMessage','To\x20receive\x20payment\x20notifications,\x20send\x20your\x20credentials\x20in\x20one\x20line:\x0a\x0a','ðŸ“ž\x20*Contacts*\x0a\x0a','reduce','ðŸ‘¤\x20Username:\x20`','back_to_stats_menu','âŒ\x20You\x20are\x20not\x20connected\x20to\x20a\x20shop.\x0a\x0aUse\x20/start\x20to\x20connect.','pl_gw_','default','Next\x20âž¡ï¸','âŒ\x20Close','timestamp','notificationApiError','SOL','handlePaymentLinkFlow','getGatewayNameById','ETH','editMessageText','Step\x203/4:\x20Select\x20currency','stopBot','stats_all_time','ðŸ”‚\x20Single\x20Use','cmd_contacts','blocked','ðŸ”—\x20*Transaction\x20Link:*\x20Pending',':\x20`','create','amount','username','getGatewayCurrencies','\x0aðŸ‘¤\x20*Customer\x20Information:*\x0a','\x20USDT\x0a','\x20\x20\x20Name:\x20*','customerUa','pl_curr_','ðŸ’¸\x20Penalty\x20amount:\x20*','../config/database','amountUSDT','\x20users\x20of\x20shop\x20','ðŸ”\x20*Debug\x20Information*\x0a\x0a','/statistics\x20-\x20view\x20your\x20statistics\x0a','Gateway\x20-\x20','ðŸ‘¤\x20Account:\x20https://app.trapay.uk/login\x0a','initializeBot','AUD','9300225NbzgWK','Error\x20handling\x20/disconnect\x20command:','pl_type_','ðŸ”—\x20*Create\x20Payment\x20Link*\x0a\x0a','telegramUser','ðŸ“±\x20API\x20error\x20notifications\x20disabled\x20for\x20shop\x20','ðŸ“¢\x20Telegram\x20channel:\x20https://t.me/trapay\x5c_news\x0a','TELEGRAM_BOT_TOKEN\x20not\x20found\x20in\x20environment\x20variables','*\x0a\x0a','ðŸ””\x20*','Telegram\x20bot\x20polling\x20error:','ðŸ”—\x20*Payment\x20Links*\x0a\x0aChoose\x20an\x20action:','Error\x20handling\x20callback\x20query:','POL','Payment\x20failed','telegramBotService','totalPaidOut','paymentLinkSessions','8qaULop','ðŸ“Š\x20Status','Failed\x20to\x20send\x20login\x20notification:','ðŸ“§\x20Email:\x20`','chargebackAmount','Payment\x20successfully\x20paid','image/jpeg','NOK','ðŸª\x20Your\x20connected\x20shop:\x0a','USDT','â€¢\x20Active\x20payment\x20links\x0a','PAID','ðŸ“…\x20This\x20Month','FAILED','COMPLETED','ipAddress','âŒ\x20An\x20error\x20occurred.\x20Please\x20try\x20again.','ðŸ“Š\x20*Connection\x20Status*\x0a\x0a','test','keys','log','CAD','User\x20','showPaymentLinksList','ðŸ“…\x20All\x20Time','ðŸ“±\x20Shop:\x20*','\x0aâš ï¸\x20If\x20this\x20wasn\x27t\x20you,\x20change\x20your\x20password\x20immediately!','ðŸ¦\x20Gateway:\x20','ðŸ“…\x20Today','sk_','âŒ\x20An\x20error\x20occurred\x20while\x20verifying\x20data.','Markdown','geo','ðŸ’°\x20*Amount:*\x20','\x20USDC\x0a','ðŸ”—\x20*Create\x20Payment\x20Link*\x0a\x0aStep\x201/4:\x20Select\x20gateway','ðŸ“Š\x20Error\x20code:\x20`','Username\x20must\x20contain\x20only\x20letters,\x20numbers\x20and\x20underscore\x20(3-50\x20characters).','ðŸš¨\x20*API\x20Error*\x0a\x0a','\x20-\x20','message_id','sendShopFile','chat\x20not\x20found','startsWith','ðŸ“ž\x20Contacts','toString','split','âŒ\x20Error\x20sending\x20file\x20to\x20chat:','âŒ\x20Error\x20sending\x20file\x20to\x20shop:','âŒ\x20You\x20are\x20not\x20connected\x20to\x20any\x20shop.\x0a\x0a','â³\x20The\x20payment\x20is\x20currently\x20being\x20processed\x20by\x20the\x20gateway.\x0a','Error\x20handling\x20message:','âŒ\x20Shop\x20not\x20found.\x20Please\x20start\x20over\x20with\x20/start','âœ…\x20You\x20have\x20been\x20successfully\x20disconnected\x20from\x20shop\x20*','234198wJLcHT','Error\x20in\x20handleSingleLineVerification:','â€¢\x20New\x20payments\x0a','ðŸ¤–\x20Welcome\x20to\x20TRAPAY\x20notification\x20system!\x0a\x0a','notificationLogin','You\x20are\x20already\x20connected\x20to\x20shop:\x20*','endpoint','sendShopNotification','callback_query','ðŸ“Š\x20*Statistics:\x20','\x20\x20\x20Username:\x20`','statusCode','includes','pl_cancel','ðŸ’»\x20Browser:\x20`','toLocaleString','âŒ\x20No\x20verified\x20Telegram\x20users\x20found\x20for\x20shop\x20ID:\x20','ðŸ“…\x20Time:\x20','ðŸ””\x20You\x20will\x20now\x20receive\x20notifications\x20about:\x0a','Use\x20/start\x20to\x20begin.','USD','â—ï¸\x20Make\x20sure\x20to\x20separate\x20username\x20and\x20API\x20key\x20with\x20a\x20space!','\x20via\x20single-line\x20input','ðŸ“…\x20Connection\x20date:\x20','...','Use\x20/start\x20to\x20connect.','`\x20not\x20found.\x0a\x0a','Use\x20/status\x20to\x20check\x20status\x20or\x20/disconnect\x20to\x20disconnect.','set','To\x20reconnect,\x20use\x20the\x20/start\x20command','âœ…\x20Connected\x20to\x20shop:\x20*','entries','âŒ\x20Invalid\x20format.\x20Please\x20send\x20exactly\x202\x20parts\x20separated\x20by\x20space:\x0a\x0a','ACTIVE','toFixed','ðŸ”„\x20Refunds\x20\x5c-\x20','unknown\x20shop','wallet','cmd_statistics','â€¢\x20Share\x20link\x20directly','success','2-digit','BTC','Error\x20showing\x20payment\x20links\x20list:','âœ…\x20Telegram\x20user\x20','ðŸ””\x20Notifications\x20are\x20active','*.\x0a\x0a','.jpeg','application/octet-stream','/disconnect\x20-\x20disconnect\x20from\x20notifications','cmd_payment_links','NZD','toLocaleDateString','pl_type_single','Example:\x0a','ðŸ”—\x20*Transaction\x20Link:*\x20`','/payouts\x20-\x20view\x20recent\x20payouts\x0a','âž•\x20Create\x20New\x20Link','processing','REFUND','ðŸ“‹\x20*Payment\x20Links*\x20\x5c(Page\x20','âŒ\x20Error\x20sending\x20file\x20to\x20user\x20','âŒ\x20An\x20error\x20occurred.\x20Please\x20try\x20again\x20later.','customerIp','âŒ\x20Cancelled.','ðŸ“Š\x20Statistics','\x20(e.g.,\x20100)','adminNotes','currency','ðŸ”—\x20Payment\x20Links','\x20USD\x0a','â¬…ï¸\x20Back','ðŸ“±\x20Your\x20Telegram\x20ID:\x20`','shop','ðŸ””\x20You\x20receive\x20notifications\x20about:\x0a','2mGYgcO','/link/','isValidGatewayId','ceil','endsWith','requestId','gateway','__esModule','ðŸ“‹\x20View\x20Payment\x20Links','9qtFIKy','GATEWAY_ID_MAP','ðŸ”„\x20Processing\x20single-line\x20verification\x20for\x20user\x20','sendPayoutNotification','orderId','trim','Error\x20handling\x20/contacts\x20command:','âŒ\x20Cancel','â€¢\x20Last\x205\x20payouts\x0a','ðŸ”—\x20Link:\x20','ðŸª\x20Gateway:\x20`','â€¢\x20Amount\x20and\x20network\x0a','DOGE','pl_create_new','BNB','Disconnect\x20one\x20of\x20the\x20existing\x20accounts\x20first.','status','shopId','TelegramBotService','ðŸ“±\x20Created\x20new\x20Telegram\x20user:\x20','âš ï¸\x20Chargebacks\x20\x5c-\x20','N/A','â±ï¸\x20*Period:*\x20','getUTCMonth','ðŸ“±\x20No\x20active\x20Telegram\x20users\x20found','ðŸ”Œ\x20Disconnect','\x20\x20\x20Status:\x20','shopSettings','trapay_bot','map','0.0','AED','image/png','customerName','526462cixjxX','âœ…\x20Telegram\x20bot\x20@','Make\x20sure\x20you\x20have\x20the\x20correct\x20username\x20from\x20your\x20account.','toUpperCase','createdAt','remitterIban','data','ðŸ’¬\x20Support:\x20https://t.me/trapay\x5c_sales','1060591pSKjRb','application/pdf','update','isVerified','ðŸŒ\x20Website:\x20https://trapay.uk/\x0a','Error\x20handling\x20/payment_links\x20command:','\x5c)\x0a\x0a','bot','New\x20payment\x20created','getUTCDate','ðŸ“›\x20Name:\x20`','chat','ðŸ’µ\x20Earned\x20\x5c-\x20','handleMerchantStatistics','PLN','âŒ\x20Failed\x20to\x20initialize\x20Telegram\x20bot:','ðŸŽ‰\x20*Congratulations!*\x0a\x0a','Payment\x20refund','ARS','message','forEach','MarkdownV2','ðŸ“±\x20Telegram\x20notification:\x20gateway\x20\x22','Telegram\x20bot\x20error:','âœ…\x20You\x20have\x20been\x20successfully\x20connected\x20to\x20the\x20notification\x20system!\x0a\x0a','âœ…\x20Paid\x20out:\x20','âœ…\x20Welcome\x20back!\x0a\x0a','paymentLink','Error\x20getting\x20merchant\x20statistics:','ðŸ“…\x20Yesterday','secretKey',':\x20username=\x22','findUnique'];a87_0x88bb=function(){return _0x4d8557;};return a87_0x88bb();}const a87_0x60daa8=a87_0x2625;(function(_0x2eb8f8,_0x128b9b){const _0x2861c1=a87_0x2625,_0xfd6fe6=_0x2eb8f8();while(!![]){try{const _0x3086dc=parseInt(_0x2861c1(0x172))/0x1*(-parseInt(_0x2861c1(0x19d))/0x2)+-parseInt(_0x2861c1(0x1f9))/0x3+parseInt(_0x2861c1(0x224))/0x4*(parseInt(_0x2861c1(0x21c))/0x5)+-parseInt(_0x2861c1(0x127))/0x6+parseInt(_0x2861c1(0x1a5))/0x7*(parseInt(_0x2861c1(0xf1))/0x8)+-parseInt(_0x2861c1(0x17b))/0x9*(parseInt(_0x2861c1(0x218))/0xa)+parseInt(_0x2861c1(0x293))/0xb;if(_0x3086dc===_0x128b9b)break;else _0xfd6fe6['push'](_0xfd6fe6['shift']());}catch(_0x591c0f){_0xfd6fe6['push'](_0xfd6fe6['shift']());}}}(a87_0x88bb,0x6a726));var __importDefault=this&&this['__importDefault']||function(_0x40f59a){const _0x25c959=a87_0x2625;return _0x40f59a&&_0x40f59a[_0x25c959(0x179)]?_0x40f59a:{'default':_0x40f59a};};Object['defineProperty'](exports,'__esModule',{'value':!![]}),exports['telegramBotService']=exports[a87_0x60daa8(0x18d)]=void 0x0;const node_telegram_bot_api_1=__importDefault(require(a87_0x60daa8(0x207))),database_1=__importDefault(require(a87_0x60daa8(0x28a))),gateway_1=require(a87_0x60daa8(0x23f));class TelegramBotService{constructor(){const _0x2a7e3d=a87_0x60daa8;this['bot']=null,this[_0x2a7e3d(0xf0)]=new Map(),this['botToken']=process.env.TELEGRAM_BOT_TOKEN||'',this['botUsername']=process.env.TELEGRAM_BOT_USERNAME||_0x2a7e3d(0x197),this['botToken']?this[_0x2a7e3d(0x291)]():console[_0x2a7e3d(0x204)](_0x2a7e3d(0xe6));}[a87_0x60daa8(0x291)](){const _0xe15c5f=a87_0x60daa8;try{this[_0xe15c5f(0x1ac)]=new node_telegram_bot_api_1[(_0xe15c5f(0x26e))](this['botToken'],{'polling':!![]}),this[_0xe15c5f(0x264)](),console['log'](_0xe15c5f(0x19e)+this[_0xe15c5f(0x1c7)]+_0xe15c5f(0x1d1));}catch(_0x328f2d){console[_0xe15c5f(0x238)](_0xe15c5f(0x1b4),_0x328f2d);}}['setupBotHandlers'](){const _0x48a0f8=a87_0x60daa8;if(!this[_0x48a0f8(0x1ac)])return;this[_0x48a0f8(0x1ac)][_0x48a0f8(0x1f3)](/\/start/,async _0x52e978=>{const _0x4552ae=_0x48a0f8,_0x4cead7=_0x52e978[_0x4552ae(0x1b0)]['id'],_0x493077=_0x52e978[_0x4552ae(0x1dd)]?.['id']['toString'](),_0x3c64ae=_0x52e978[_0x4552ae(0x1dd)]?.[_0x4552ae(0x282)],_0x27cbba=_0x52e978[_0x4552ae(0x1dd)]?.['first_name'],_0x38810e=_0x52e978[_0x4552ae(0x1dd)]?.['last_name'];if(!_0x493077)return;try{let _0x57042d=await database_1[_0x4552ae(0x26e)]['telegramUser'][_0x4552ae(0x1c5)]({'where':{'telegramId':_0x493077},'include':{'shop':!![]}});!_0x57042d?(_0x57042d=await database_1['default'][_0x4552ae(0xe3)][_0x4552ae(0x280)]({'data':{'telegramId':_0x493077,'username':_0x3c64ae,'firstName':_0x27cbba,'lastName':_0x38810e,'isVerified':![],'shopId':null},'include':{'shop':!![]}}),console[_0x4552ae(0x105)](_0x4552ae(0x18e)+_0x493077+'\x20(@'+_0x3c64ae+')')):_0x57042d=await database_1[_0x4552ae(0x26e)]['telegramUser']['update']({'where':{'telegramId':_0x493077},'data':{'username':_0x3c64ae,'firstName':_0x27cbba,'lastName':_0x38810e},'include':{'shop':!![]}}),_0x57042d['isVerified']&&_0x57042d[_0x4552ae(0x18c)]&&_0x57042d[_0x4552ae(0x170)]?await this[_0x4552ae(0x1ac)]?.['sendMessage'](_0x4cead7,_0x4552ae(0x1bf)+(_0x4552ae(0x12c)+_0x57042d[_0x4552ae(0x170)][_0x4552ae(0x227)]+'*\x0a')+(_0x4552ae(0x21d)+_0x57042d[_0x4552ae(0x170)][_0x4552ae(0x282)]+_0x4552ae(0x1fe))+_0x4552ae(0x171)+_0x4552ae(0x129)+_0x4552ae(0x239)+'â€¢\x20Payouts',{'parse_mode':_0x4552ae(0x110),'reply_markup':{'inline_keyboard':[[{'text':_0x4552ae(0x168),'callback_data':_0x4552ae(0x14d)},{'text':_0x4552ae(0x257),'callback_data':_0x4552ae(0x252)}],[{'text':_0x4552ae(0x16c),'callback_data':'cmd_payment_links'},{'text':_0x4552ae(0xf2),'callback_data':_0x4552ae(0x1fb)}],[{'text':_0x4552ae(0x11d),'callback_data':_0x4552ae(0x27c)},{'text':_0x4552ae(0x194),'callback_data':'cmd_disconnect'}]]}}):(_0x57042d[_0x4552ae(0x18c)]&&!_0x57042d[_0x4552ae(0x1a8)]&&(await database_1[_0x4552ae(0x26e)][_0x4552ae(0xe3)][_0x4552ae(0x1a7)]({'where':{'telegramId':_0x493077},'data':{'shopId':null,'isVerified':![]}}),console[_0x4552ae(0x105)](_0x4552ae(0x20c)+_0x493077)),await this['bot']?.[_0x4552ae(0x266)](_0x4cead7,_0x4552ae(0x12a)+_0x4552ae(0x267)+_0x4552ae(0x249)+_0x4552ae(0x15d)+_0x4552ae(0x205)+_0x4552ae(0x13c),{'parse_mode':_0x4552ae(0x110)}));}catch(_0x1eaf80){console['error']('Error\x20handling\x20/start\x20command:',_0x1eaf80),await this[_0x4552ae(0x1ac)]?.[_0x4552ae(0x266)](_0x4cead7,'âŒ\x20An\x20error\x20occurred.\x20Please\x20try\x20again\x20later.');}}),this['bot'][_0x48a0f8(0x1f3)](/\/disconnect/,async _0x53fc45=>{const _0x2d7d3e=_0x48a0f8,_0x53ee39=_0x53fc45['chat']['id'],_0x20146d=_0x53fc45[_0x2d7d3e(0x1dd)]?.['id'][_0x2d7d3e(0x11e)]();if(!_0x20146d)return;try{const _0xade6fb=await database_1[_0x2d7d3e(0x26e)][_0x2d7d3e(0xe3)][_0x2d7d3e(0x1c5)]({'where':{'telegramId':_0x20146d},'include':{'shop':!![]}});if(!_0xade6fb||!_0xade6fb[_0x2d7d3e(0x1a8)]||!_0xade6fb[_0x2d7d3e(0x18c)]){await this[_0x2d7d3e(0x1ac)]?.[_0x2d7d3e(0x266)](_0x53ee39,_0x2d7d3e(0x261));return;}const _0xed6153=_0xade6fb['shop']?.['name']||_0x2d7d3e(0x14b);await database_1['default'][_0x2d7d3e(0xe3)]['update']({'where':{'telegramId':_0x20146d},'data':{'shopId':null,'isVerified':![]}}),console['log']('ðŸ”Œ\x20User\x20'+_0x20146d+_0x2d7d3e(0x215)+_0xade6fb[_0x2d7d3e(0x18c)]),await this[_0x2d7d3e(0x1ac)]?.[_0x2d7d3e(0x266)](_0x53ee39,_0x2d7d3e(0x126)+_0xed6153+_0x2d7d3e(0x155)+'To\x20reconnect,\x20use\x20the\x20/start\x20command',{'parse_mode':_0x2d7d3e(0x110)});}catch(_0x173ff4){console[_0x2d7d3e(0x238)](_0x2d7d3e(0xe0),_0x173ff4),await this[_0x2d7d3e(0x1ac)]?.[_0x2d7d3e(0x266)](_0x53ee39,'âŒ\x20An\x20error\x20occurred.\x20Please\x20try\x20again\x20later.');}}),this[_0x48a0f8(0x1ac)]['onText'](/\/status/,async _0x28692e=>{const _0x1d6f53=_0x48a0f8,_0x162f64=_0x28692e[_0x1d6f53(0x1b0)]['id'],_0x28f0d1=_0x28692e['from']?.['id'][_0x1d6f53(0x11e)]();if(!_0x28f0d1)return;try{const _0x585a62=await database_1[_0x1d6f53(0x26e)][_0x1d6f53(0xe3)][_0x1d6f53(0x1c5)]({'where':{'telegramId':_0x28f0d1},'include':{'shop':!![]}});if(!_0x585a62){await this[_0x1d6f53(0x1ac)]?.[_0x1d6f53(0x266)](_0x162f64,'âŒ\x20You\x20are\x20not\x20registered\x20in\x20the\x20system.\x0a\x0a'+_0x1d6f53(0x13a));return;}if(!_0x585a62[_0x1d6f53(0x1a8)]||!_0x585a62[_0x1d6f53(0x18c)]||!_0x585a62[_0x1d6f53(0x170)]){await this[_0x1d6f53(0x1ac)]?.[_0x1d6f53(0x266)](_0x162f64,_0x1d6f53(0x1cb)+_0x1d6f53(0x140));return;}await this['bot']?.[_0x1d6f53(0x266)](_0x162f64,_0x1d6f53(0x102)+(_0x1d6f53(0x145)+_0x585a62[_0x1d6f53(0x170)][_0x1d6f53(0x227)]+'*\x0a')+(_0x1d6f53(0x26a)+_0x585a62[_0x1d6f53(0x170)][_0x1d6f53(0x282)]+'`\x0a')+(_0x1d6f53(0x13e)+_0x585a62[_0x1d6f53(0x1e1)][_0x1d6f53(0x15b)](_0x1d6f53(0x226))+'\x0a\x0a')+_0x1d6f53(0x20b)+'ðŸ“±\x20Available\x20Commands:\x0a'+_0x1d6f53(0x28e)+_0x1d6f53(0x15f)+_0x1d6f53(0x23d)+'/contacts\x20-\x20support\x20contacts\x0a'+_0x1d6f53(0x158),{'parse_mode':'Markdown'});}catch(_0x4dbe66){console['error'](_0x1d6f53(0x201),_0x4dbe66),await this['bot']?.['sendMessage'](_0x162f64,_0x1d6f53(0x165));}}),this[_0x48a0f8(0x1ac)][_0x48a0f8(0x1f3)](/\/statistics/,async _0x491461=>{const _0x45943b=_0x48a0f8,_0x1712f8=_0x491461[_0x45943b(0x1b0)]['id'],_0x401dc0=_0x491461[_0x45943b(0x1dd)]?.['id']['toString']();if(!_0x401dc0)return;try{const _0x3ffc48=await database_1['default'][_0x45943b(0xe3)][_0x45943b(0x1c5)]({'where':{'telegramId':_0x401dc0},'include':{'shop':!![]}});if(!_0x3ffc48?.[_0x45943b(0x1a8)]||!_0x3ffc48[_0x45943b(0x18c)]){await this['bot']?.['sendMessage'](_0x1712f8,_0x45943b(0x1cb)+_0x45943b(0x140));return;}const _0x251f1e={'inline_keyboard':[[{'text':_0x45943b(0x10d),'callback_data':_0x45943b(0x1f5)}],[{'text':_0x45943b(0x1c2),'callback_data':_0x45943b(0x1d2)}],[{'text':_0x45943b(0xfd),'callback_data':_0x45943b(0x247)}],[{'text':_0x45943b(0x24b),'callback_data':_0x45943b(0x230)}],[{'text':'ðŸ“…\x20All\x20Time','callback_data':_0x45943b(0x27a)}]]};await this[_0x45943b(0x1ac)]?.[_0x45943b(0x266)](_0x1712f8,_0x45943b(0x210),{'parse_mode':_0x45943b(0x110),'reply_markup':_0x251f1e});}catch(_0x4b68f1){console[_0x45943b(0x238)](_0x45943b(0x1f0),_0x4b68f1),await this[_0x45943b(0x1ac)]?.[_0x45943b(0x266)](_0x1712f8,_0x45943b(0x165));}}),this[_0x48a0f8(0x1ac)][_0x48a0f8(0x1f3)](/\/payouts/,async _0x52dce3=>{const _0x12def9=_0x48a0f8,_0x300a3e=_0x52dce3[_0x12def9(0x1b0)]['id'],_0x391c59=_0x52dce3['from']?.['id'][_0x12def9(0x11e)]();if(!_0x391c59)return;try{const _0x406915=await database_1[_0x12def9(0x26e)][_0x12def9(0xe3)][_0x12def9(0x1c5)]({'where':{'telegramId':_0x391c59},'include':{'shop':!![]}});if(!_0x406915?.[_0x12def9(0x1a8)]||!_0x406915[_0x12def9(0x18c)]){await this[_0x12def9(0x1ac)]?.[_0x12def9(0x266)](_0x300a3e,'âŒ\x20You\x20are\x20not\x20connected\x20to\x20a\x20shop.\x0a\x0a'+_0x12def9(0x140));return;}await this[_0x12def9(0x1ac)]?.['sendMessage'](_0x300a3e,'ðŸ’¸\x20*Recent\x20Payouts*\x0a\x0a'+_0x12def9(0x1e0)+_0x12def9(0x260)+_0x12def9(0x183)+_0x12def9(0x186)+_0x12def9(0x236)+'â€¢\x20Dates\x20and\x20TX\x20IDs',{'parse_mode':'Markdown'});}catch(_0x43a926){console['error'](_0x12def9(0x220),_0x43a926),await this[_0x12def9(0x1ac)]?.[_0x12def9(0x266)](_0x300a3e,_0x12def9(0x165));}}),this[_0x48a0f8(0x1ac)][_0x48a0f8(0x1f3)](/\/payment_links/,async _0x2064f7=>{const _0x2228dd=_0x48a0f8,_0x5c5a19=_0x2064f7[_0x2228dd(0x1b0)]['id'],_0x23ce2a=_0x2064f7[_0x2228dd(0x1dd)]?.['id'][_0x2228dd(0x11e)]();if(!_0x23ce2a)return;try{const _0x1a5385=await database_1[_0x2228dd(0x26e)][_0x2228dd(0xe3)][_0x2228dd(0x1c5)]({'where':{'telegramId':_0x23ce2a},'include':{'shop':!![]}});if(!_0x1a5385?.[_0x2228dd(0x1a8)]||!_0x1a5385[_0x2228dd(0x18c)]){await this[_0x2228dd(0x1ac)]?.[_0x2228dd(0x266)](_0x5c5a19,_0x2228dd(0x1cb)+_0x2228dd(0x140));return;}await this[_0x2228dd(0x1ac)]?.[_0x2228dd(0x266)](_0x5c5a19,_0x2228dd(0x21b)+_0x2228dd(0x1e0)+_0x2228dd(0x260)+_0x2228dd(0xfb)+'â€¢\x20Usage\x20statistics\x0a'+_0x2228dd(0x1e9)+_0x2228dd(0x14e),{'parse_mode':_0x2228dd(0x110)});}catch(_0x3757ed){console[_0x2228dd(0x238)](_0x2228dd(0x1aa),_0x3757ed),await this['bot']?.['sendMessage'](_0x5c5a19,_0x2228dd(0x165));}}),this[_0x48a0f8(0x1ac)][_0x48a0f8(0x1f3)](/\/contacts/,async _0x1b9390=>{const _0x3d227e=_0x48a0f8,_0x2ba5ad=_0x1b9390[_0x3d227e(0x1b0)]['id'];try{await this[_0x3d227e(0x1ac)]?.[_0x3d227e(0x266)](_0x2ba5ad,'ðŸ“ž\x20*Contacts*\x0a\x0a'+_0x3d227e(0x1a9)+_0x3d227e(0x290)+_0x3d227e(0xe5)+_0x3d227e(0x1a4),{'parse_mode':_0x3d227e(0x110)});}catch(_0x2969c9){console[_0x3d227e(0x238)](_0x3d227e(0x181),_0x2969c9),await this[_0x3d227e(0x1ac)]?.[_0x3d227e(0x266)](_0x2ba5ad,_0x3d227e(0x165));}}),this['bot']['on'](_0x48a0f8(0x12f),async _0x1a6c3c=>{const _0x20f186=_0x48a0f8,_0x527df1=_0x1a6c3c[_0x20f186(0x1b8)],_0x5d385f=_0x527df1?.[_0x20f186(0x1b0)]['id'],_0x53b493=_0x1a6c3c[_0x20f186(0x1dd)]['id']['toString'](),_0x18c08b=_0x1a6c3c[_0x20f186(0x1a3)];if(!_0x5d385f||!_0x18c08b)return;try{await this[_0x20f186(0x1ac)]?.['answerCallbackQuery'](_0x1a6c3c['id']);const _0x3ffcbc=await database_1[_0x20f186(0x26e)]['telegramUser'][_0x20f186(0x1c5)]({'where':{'telegramId':_0x53b493},'include':{'shop':!![]}});if(!_0x3ffcbc?.[_0x20f186(0x1a8)]||!_0x3ffcbc['shopId']){await this[_0x20f186(0x1ac)]?.[_0x20f186(0x266)](_0x5d385f,_0x20f186(0x26c));return;}switch(_0x18c08b){case _0x20f186(0x14d):const _0x818816={'inline_keyboard':[[{'text':_0x20f186(0x10d),'callback_data':'stats_today'}],[{'text':'ðŸ“…\x20Yesterday','callback_data':_0x20f186(0x1d2)}],[{'text':_0x20f186(0xfd),'callback_data':_0x20f186(0x247)}],[{'text':_0x20f186(0x24b),'callback_data':_0x20f186(0x230)}],[{'text':_0x20f186(0x109),'callback_data':_0x20f186(0x27a)}]]};await this[_0x20f186(0x1ac)]?.[_0x20f186(0x266)](_0x5d385f,_0x20f186(0x210),{'parse_mode':'Markdown','reply_markup':_0x818816});break;case _0x20f186(0x1f5):case _0x20f186(0x1d2):case _0x20f186(0x247):case _0x20f186(0x230):case'stats_all_time':await this[_0x20f186(0x1b2)](_0x5d385f,_0x3ffcbc[_0x20f186(0x18c)],_0x18c08b,_0x527df1?.[_0x20f186(0x119)]);break;case _0x20f186(0x26b):const _0x203852={'inline_keyboard':[[{'text':_0x20f186(0x10d),'callback_data':_0x20f186(0x1f5)}],[{'text':'ðŸ“…\x20Yesterday','callback_data':_0x20f186(0x1d2)}],[{'text':'ðŸ“…\x20This\x20Month','callback_data':_0x20f186(0x247)}],[{'text':_0x20f186(0x24b),'callback_data':_0x20f186(0x230)}],[{'text':_0x20f186(0x109),'callback_data':_0x20f186(0x27a)}]]};_0x527df1?.['message_id']?await this[_0x20f186(0x1ac)]?.[_0x20f186(0x277)](_0x20f186(0x210),{'chat_id':_0x5d385f,'message_id':_0x527df1[_0x20f186(0x119)],'parse_mode':_0x20f186(0x110),'reply_markup':_0x203852}):await this[_0x20f186(0x1ac)]?.[_0x20f186(0x266)](_0x5d385f,_0x20f186(0x210),{'parse_mode':_0x20f186(0x110),'reply_markup':_0x203852});break;case'cmd_payouts':const _0x1508ec=await database_1[_0x20f186(0x26e)]['payout'][_0x20f186(0x217)]({'where':{'shopId':_0x3ffcbc[_0x20f186(0x18c)]},'orderBy':{'createdAt':'desc'}}),_0x2acf8a=_0x1508ec[_0x20f186(0x209)](_0x4bd339=>_0x4bd339[_0x20f186(0x18b)]===_0x20f186(0x1d7))[_0x20f186(0x269)]((_0x133918,_0x1b5368)=>_0x133918+_0x1b5368['amount'],0x0),_0x4f9e3f=_0x1508ec[_0x20f186(0x209)](_0x14df10=>_0x14df10[_0x20f186(0x18b)]===_0x20f186(0xff))[_0x20f186(0x269)]((_0x5b5452,_0x430f7d)=>_0x5b5452+_0x430f7d['amount'],0x0),_0x16827e=(_0x3ffcbc['shop']?.[_0x20f186(0x237)]||0x0)+(_0x3ffcbc[_0x20f186(0x170)]?.[_0x20f186(0xef)]||0x0);await this[_0x20f186(0x1ac)]?.[_0x20f186(0x266)](_0x5d385f,'ðŸ’¸\x20*Payouts*\x0a\x0a'+(_0x20f186(0x23e)+_0x2acf8a['toFixed'](0x2)+_0x20f186(0x113))+(_0x20f186(0x1be)+_0x4f9e3f[_0x20f186(0x149)](0x2)+_0x20f186(0x113))+('ðŸ’°\x20Total\x20earned:\x20'+_0x16827e[_0x20f186(0x149)](0x2)+_0x20f186(0x1da)),{'parse_mode':_0x20f186(0x110)});break;case _0x20f186(0x159):await this[_0x20f186(0x1ac)]?.['sendMessage'](_0x5d385f,_0x20f186(0xea),{'parse_mode':_0x20f186(0x110),'reply_markup':{'inline_keyboard':[[{'text':_0x20f186(0x17a),'callback_data':'pl_view_list'}],[{'text':_0x20f186(0x160),'callback_data':_0x20f186(0x188)}],[{'text':_0x20f186(0x182),'callback_data':_0x20f186(0x134)}]]}});break;case _0x20f186(0x1fb):await this['bot']?.[_0x20f186(0x266)](_0x5d385f,_0x20f186(0x102)+('âœ…\x20Connected\x20to\x20shop:\x20*'+(_0x3ffcbc[_0x20f186(0x170)]?.[_0x20f186(0x227)]||'Unknown')+'*\x0a')+(_0x20f186(0x26a)+(_0x3ffcbc[_0x20f186(0x170)]?.['username']||_0x20f186(0x20a))+'`\x0a')+(_0x20f186(0x13e)+_0x3ffcbc[_0x20f186(0x1e1)][_0x20f186(0x15b)]('en-US')+'\x0a\x0a')+_0x20f186(0x154),{'parse_mode':'Markdown'});break;case _0x20f186(0x27c):await this[_0x20f186(0x1ac)]?.[_0x20f186(0x266)](_0x5d385f,_0x20f186(0x268)+'ðŸŒ\x20Website:\x20https://trapay.uk/\x0a'+_0x20f186(0x290)+_0x20f186(0xe5)+_0x20f186(0x1a4),{'parse_mode':_0x20f186(0x110)});break;case _0x20f186(0x1e4):await database_1[_0x20f186(0x26e)][_0x20f186(0xe3)][_0x20f186(0x1a7)]({'where':{'telegramId':_0x53b493},'data':{'shopId':null,'isVerified':![]}}),await this[_0x20f186(0x1ac)]?.[_0x20f186(0x266)](_0x5d385f,_0x20f186(0x126)+(_0x3ffcbc[_0x20f186(0x170)]?.[_0x20f186(0x227)]||'Unknown')+_0x20f186(0x155)+_0x20f186(0x144),{'parse_mode':'Markdown'});break;default:_0x18c08b['startsWith']('pl_')?await this[_0x20f186(0x274)](_0x5d385f,_0x53b493,_0x18c08b,_0x1a6c3c[_0x20f186(0x1b8)]?.[_0x20f186(0x119)]):await this[_0x20f186(0x1ac)]?.[_0x20f186(0x266)](_0x5d385f,_0x20f186(0x221));}}catch(_0x37779f){console[_0x20f186(0x238)](_0x20f186(0xeb),_0x37779f),await this[_0x20f186(0x1ac)]?.[_0x20f186(0x266)](_0x5d385f,'âŒ\x20An\x20error\x20occurred.\x20Please\x20try\x20again\x20later.');}}),this[_0x48a0f8(0x1ac)][_0x48a0f8(0x1f3)](/\/debug/,async _0x18132c=>{const _0x13b46e=_0x48a0f8,_0x1d05bc=_0x18132c[_0x13b46e(0x1b0)]['id'],_0x2af911=_0x18132c[_0x13b46e(0x1dd)]?.['id'][_0x13b46e(0x11e)]();if(!_0x2af911)return;try{const _0x269655=await database_1[_0x13b46e(0x26e)][_0x13b46e(0xe3)][_0x13b46e(0x1c5)]({'where':{'telegramId':_0x2af911},'include':{'shop':!![]}});let _0x5bf4d4=_0x13b46e(0x28d);_0x5bf4d4+=_0x13b46e(0x16f)+_0x2af911+_0x13b46e(0x1fe),_0x269655?.[_0x13b46e(0x1a8)]&&_0x269655[_0x13b46e(0x170)]?(_0x5bf4d4+=_0x13b46e(0xf9),_0x5bf4d4+=_0x13b46e(0x286)+_0x269655[_0x13b46e(0x170)][_0x13b46e(0x227)]+'*\x0a',_0x5bf4d4+=_0x13b46e(0x131)+_0x269655[_0x13b46e(0x170)][_0x13b46e(0x282)]+'`\x0a',_0x5bf4d4+=_0x13b46e(0x195)+_0x269655[_0x13b46e(0x170)][_0x13b46e(0x18b)]+'\x0a\x0a'):_0x5bf4d4+=_0x13b46e(0x122),_0x5bf4d4+=_0x13b46e(0x222),await this[_0x13b46e(0x1ac)]?.[_0x13b46e(0x266)](_0x1d05bc,_0x5bf4d4,{'parse_mode':_0x13b46e(0x110)});}catch(_0x33be1f){console[_0x13b46e(0x238)](_0x13b46e(0x1db),_0x33be1f),await this[_0x13b46e(0x1ac)]?.['sendMessage'](_0x1d05bc,_0x13b46e(0x240));}}),this['bot']['on']('message',async _0x24f01d=>{const _0x16b8c7=_0x48a0f8;if(_0x24f01d[_0x16b8c7(0x25a)]?.[_0x16b8c7(0x11c)]('/'))return;const _0x30cb60=_0x24f01d[_0x16b8c7(0x1b0)]['id'],_0xbe633b=_0x24f01d[_0x16b8c7(0x1dd)]?.['id'][_0x16b8c7(0x11e)](),_0x29dbba=_0x24f01d[_0x16b8c7(0x25a)]?.[_0x16b8c7(0x180)]();if(!_0xbe633b||!_0x29dbba)return;try{const _0xec0245=this[_0x16b8c7(0xf0)]['get'](_0xbe633b);if(_0xec0245&&_0xec0245[_0x16b8c7(0x1e2)]===_0x16b8c7(0x281)){const _0x16ce0b=parseFloat(_0x29dbba);if(isNaN(_0x16ce0b)||_0x16ce0b<=0x0){await this['bot']?.[_0x16b8c7(0x266)](_0x30cb60,_0x16b8c7(0x206));return;}const _0x100d1a=await database_1['default'][_0x16b8c7(0xe3)][_0x16b8c7(0x1c5)]({'where':{'telegramId':_0xbe633b},'include':{'shop':!![]}});if(!_0x100d1a?.[_0x16b8c7(0x18c)]){await this[_0x16b8c7(0x1ac)]?.['sendMessage'](_0x30cb60,_0x16b8c7(0x125)),this['paymentLinkSessions'][_0x16b8c7(0x1e5)](_0xbe633b);return;}const _0x1b81bd=(0x0,gateway_1[_0x16b8c7(0x174)])(_0xec0245['gateway'])?(0x0,gateway_1[_0x16b8c7(0x275)])(_0xec0245[_0x16b8c7(0x178)]):_0xec0245['gateway'],_0x463216={'shopId':_0x100d1a[_0x16b8c7(0x18c)],'gateway':_0x1b81bd,'amount':_0x16ce0b,'currency':_0xec0245['currency'],'type':_0xec0245[_0x16b8c7(0x1cf)],'status':'ACTIVE'},_0x8927e0=await database_1[_0x16b8c7(0x26e)][_0x16b8c7(0x1c0)][_0x16b8c7(0x280)]({'data':_0x463216});this[_0x16b8c7(0xf0)]['delete'](_0xbe633b);const _0x1f85e5=(process.env.FRONTEND_URL||'https://app.trapay.uk')+_0x16b8c7(0x173)+_0x8927e0['id'],_0x181d48=_0x1f85e5[_0x16b8c7(0x246)](/\./g,'\x5c.')[_0x16b8c7(0x246)](/-/g,'\x5c-')['replace'](/\//g,'\x5c/');await this[_0x16b8c7(0x1ac)]?.[_0x16b8c7(0x266)](_0x30cb60,_0x16b8c7(0x1f7)+(_0x16b8c7(0x184)+_0x181d48+'\x0a')+(_0x16b8c7(0x241)+_0x16ce0b+'\x20'+_0xec0245[_0x16b8c7(0x16b)]+'\x0a')+(_0x16b8c7(0x10c)+_0xec0245[_0x16b8c7(0x178)]+'\x0a')+('ðŸ”„\x20Type:\x20'+(_0xec0245[_0x16b8c7(0x1cf)]===_0x16b8c7(0x219)?_0x16b8c7(0x25e):_0x16b8c7(0x1c8))+'\x0a\x0a')+'Copy\x20and\x20share\x20this\x20link\x20with\x20your\x20customers\x5c!',{'parse_mode':_0x16b8c7(0x1ba)});return;}const _0x2c6eca=await database_1[_0x16b8c7(0x26e)]['telegramUser'][_0x16b8c7(0x1c5)]({'where':{'telegramId':_0xbe633b},'include':{'shop':!![]}});if(!_0x2c6eca){await this[_0x16b8c7(0x1ac)]?.[_0x16b8c7(0x266)](_0x30cb60,'âŒ\x20Please\x20use\x20/start\x20command\x20first');return;}if(_0x2c6eca[_0x16b8c7(0x1a8)]&&_0x2c6eca[_0x16b8c7(0x18c)]&&_0x2c6eca[_0x16b8c7(0x170)]){await this[_0x16b8c7(0x1ac)]?.[_0x16b8c7(0x266)](_0x30cb60,_0x16b8c7(0x22e)+_0x2c6eca[_0x16b8c7(0x170)][_0x16b8c7(0x227)]+_0x16b8c7(0x155)+_0x16b8c7(0x142),{'parse_mode':_0x16b8c7(0x110)});return;}const _0x2aab95=_0x29dbba[_0x16b8c7(0x11f)](/\s+/);if(_0x2aab95['length']!==0x2){await this[_0x16b8c7(0x1ac)]?.[_0x16b8c7(0x266)](_0x30cb60,_0x16b8c7(0x147)+_0x16b8c7(0x249)+_0x16b8c7(0x15d)+_0x16b8c7(0x205)+(_0x16b8c7(0x250)+_0x2aab95[_0x16b8c7(0x20e)]+'\x20parts:\x20'+_0x2aab95[_0x16b8c7(0x198)](_0x3341b3=>'`'+_0x3341b3+'`')['join'](',\x20')),{'parse_mode':_0x16b8c7(0x110)});return;}const [_0x3ff471,_0x33a4da]=_0x2aab95;console[_0x16b8c7(0x105)](_0x16b8c7(0x17d)+_0xbe633b+':\x20username=\x22'+_0x3ff471+_0x16b8c7(0x1e3)+_0x33a4da[_0x16b8c7(0x234)](0x0,0xa)+'...\x22'),await this[_0x16b8c7(0x255)](_0x30cb60,_0xbe633b,_0x3ff471,_0x33a4da);}catch(_0x37e442){console[_0x16b8c7(0x238)](_0x16b8c7(0x124),_0x37e442),await this[_0x16b8c7(0x1ac)]?.[_0x16b8c7(0x266)](_0x30cb60,'âŒ\x20An\x20error\x20occurred.\x20Please\x20try\x20again\x20later.');}}),this[_0x48a0f8(0x1ac)]['on'](_0x48a0f8(0x238),_0x1da4c5=>{const _0x1b0dd6=_0x48a0f8;console[_0x1b0dd6(0x238)](_0x1b0dd6(0x1bc),_0x1da4c5);}),this[_0x48a0f8(0x1ac)]['on'](_0x48a0f8(0x1f8),_0x35c5f6=>{const _0xec59cc=_0x48a0f8;console['error'](_0xec59cc(0xe9),_0x35c5f6);});}async[a87_0x60daa8(0x255)](_0x347f69,_0x5a8a17,_0x44f243,_0x25469b){const _0x4d75d4=a87_0x60daa8;try{console[_0x4d75d4(0x105)](_0x4d75d4(0x17d)+_0x5a8a17+_0x4d75d4(0x1c4)+_0x44f243+'\x22,\x20apiKey=\x22'+_0x25469b[_0x4d75d4(0x234)](0x0,0xa)+'...\x22');if(!_0x44f243||_0x44f243[_0x4d75d4(0x20e)]<0x3||_0x44f243[_0x4d75d4(0x20e)]>0x32||!/^[a-zA-Z0-9_]+$/[_0x4d75d4(0x103)](_0x44f243)){await this[_0x4d75d4(0x1ac)]?.['sendMessage'](_0x347f69,'âŒ\x20Invalid\x20username\x20format:\x20`'+_0x44f243+_0x4d75d4(0x1fe)+_0x4d75d4(0x116),{'parse_mode':_0x4d75d4(0x110)});return;}if(!_0x25469b||!_0x25469b[_0x4d75d4(0x11c)]('pk_')&&!_0x25469b[_0x4d75d4(0x11c)](_0x4d75d4(0x10e))){await this['bot']?.[_0x4d75d4(0x266)](_0x347f69,_0x4d75d4(0x1e8)+_0x4d75d4(0x262),{'parse_mode':_0x4d75d4(0x110)});return;}const _0x29d57c=await database_1[_0x4d75d4(0x26e)][_0x4d75d4(0x170)][_0x4d75d4(0x1c5)]({'where':{'username':_0x44f243},'select':{'id':!![],'name':!![],'username':!![],'status':!![],'publicKey':!![],'secretKey':!![]}});if(!_0x29d57c){const _0x450a84=_0x4d75d4(0x1fa)+_0x44f243+_0x4d75d4(0x141)+_0x4d75d4(0x1ca)+_0x4d75d4(0x19f);await this[_0x4d75d4(0x1ac)]?.[_0x4d75d4(0x266)](_0x347f69,_0x450a84,{'parse_mode':_0x4d75d4(0x110)});return;}if(_0x29d57c[_0x4d75d4(0x18b)]!==_0x4d75d4(0x148)){await this[_0x4d75d4(0x1ac)]?.[_0x4d75d4(0x266)](_0x347f69,_0x4d75d4(0x24a)+_0x44f243+_0x4d75d4(0x251)+'Contact\x20administrator.',{'parse_mode':_0x4d75d4(0x110)});return;}if(_0x29d57c[_0x4d75d4(0x22a)]!==_0x25469b&&_0x29d57c[_0x4d75d4(0x1c3)]!==_0x25469b){await this[_0x4d75d4(0x1ac)]?.['sendMessage'](_0x347f69,_0x4d75d4(0x208)+_0x44f243+_0x4d75d4(0x1d5)+_0x4d75d4(0x1e7)+'Expected\x20key\x20format:\x20`pk_...`\x20or\x20`sk_...`',{'parse_mode':_0x4d75d4(0x110)});return;}const _0x181fc7=await database_1['default'][_0x4d75d4(0xe3)]['count']({'where':{'shopId':_0x29d57c['id'],'isVerified':!![]}});if(_0x181fc7>=0x5){await this['bot']?.[_0x4d75d4(0x266)](_0x347f69,_0x4d75d4(0x1df)+_0x44f243+'`.\x0a\x0a'+_0x4d75d4(0x18a),{'parse_mode':_0x4d75d4(0x110)});return;}await database_1[_0x4d75d4(0x26e)][_0x4d75d4(0xe3)]['update']({'where':{'telegramId':_0x5a8a17},'data':{'shopId':_0x29d57c['id'],'isVerified':!![]}}),await this['bot']?.[_0x4d75d4(0x266)](_0x347f69,_0x4d75d4(0x1b5)+_0x4d75d4(0x1bd)+(_0x4d75d4(0x10a)+_0x29d57c['name']+'*\x0a')+(_0x4d75d4(0x26a)+_0x29d57c[_0x4d75d4(0x282)]+_0x4d75d4(0x1fe))+_0x4d75d4(0x139)+_0x4d75d4(0x129)+'â€¢\x20Payment\x20status\x20changes\x0a'+_0x4d75d4(0x248)+_0x4d75d4(0x21a),{'parse_mode':_0x4d75d4(0x110),'reply_markup':{'inline_keyboard':[[{'text':_0x4d75d4(0x168),'callback_data':_0x4d75d4(0x14d)},{'text':_0x4d75d4(0x257),'callback_data':_0x4d75d4(0x252)}],[{'text':'ðŸ”—\x20Payment\x20Links','callback_data':_0x4d75d4(0x159)},{'text':_0x4d75d4(0xf2),'callback_data':'cmd_status'}],[{'text':'ðŸ“ž\x20Contacts','callback_data':'cmd_contacts'},{'text':_0x4d75d4(0x194),'callback_data':_0x4d75d4(0x1e4)}]]}}),console['log'](_0x4d75d4(0x153)+_0x5a8a17+_0x4d75d4(0x1ce)+_0x29d57c[_0x4d75d4(0x282)]+_0x4d75d4(0x13d));}catch(_0x2ec27c){console[_0x4d75d4(0x238)](_0x4d75d4(0x128),_0x2ec27c),await this['bot']?.[_0x4d75d4(0x266)](_0x347f69,_0x4d75d4(0x10f));}}async[a87_0x60daa8(0x12e)](_0x588fe0,_0x1fc3e8,_0x2e6f16){const _0x130eb3=a87_0x60daa8;if(!this[_0x130eb3(0x1ac)]){console[_0x130eb3(0x204)](_0x130eb3(0x254));return;}try{const _0xd97940=await database_1[_0x130eb3(0x26e)]['telegramUser'][_0x130eb3(0x217)]({'where':{'shopId':_0x588fe0,'isVerified':!![]}});if(_0xd97940[_0x130eb3(0x20e)]===0x0){console['log'](_0x130eb3(0x24f)+_0x588fe0);return;}const _0x90dc2b=_0xd97940[_0x130eb3(0x198)](async _0x200746=>{const _0x58091b=_0x130eb3;try{await this[_0x58091b(0x1ac)]?.[_0x58091b(0x266)](_0x200746[_0x58091b(0x202)],_0x1fc3e8,_0x2e6f16),console[_0x58091b(0x105)](_0x58091b(0x22b)+_0x200746['telegramId']);}catch(_0x6ba6c8){console[_0x58091b(0x238)]('âŒ\x20Failed\x20to\x20send\x20notification\x20to\x20Telegram\x20user\x20'+_0x200746[_0x58091b(0x202)]+':',_0x6ba6c8),_0x6ba6c8 instanceof Error&&(_0x6ba6c8['message'][_0x58091b(0x133)](_0x58091b(0x27d))||_0x6ba6c8[_0x58091b(0x1b8)]['includes'](_0x58091b(0x11b))||_0x6ba6c8[_0x58091b(0x1b8)]['includes'](_0x58091b(0x22d)))&&(await database_1[_0x58091b(0x26e)][_0x58091b(0xe3)][_0x58091b(0x1a7)]({'where':{'id':_0x200746['id']},'data':{'isVerified':![]}}),console[_0x58091b(0x105)](_0x58091b(0x107)+_0x200746[_0x58091b(0x202)]+'\x20marked\x20as\x20unverified\x20due\x20to\x20delivery\x20failure'));}});await Promise[_0x130eb3(0x1f6)](_0x90dc2b);}catch(_0x4ed1cf){console[_0x130eb3(0x238)]('Error\x20sending\x20shop\x20notification:',_0x4ed1cf);}}async[a87_0x60daa8(0x23c)](_0x401495,_0x2d2775,_0x2d3ca2){const _0x597dfe=a87_0x60daa8,_0x5eb4fb={'created':'ðŸ†•','paid':'âœ…','failed':'âŒ','expired':'â°','refund':'ðŸ”„','chargeback':'âš ï¸','processing':'âš™ï¸'},_0x4e1ede={'created':_0x597dfe(0x1ad),'paid':_0x597dfe(0xf6),'failed':_0x597dfe(0xed),'expired':_0x597dfe(0x25c),'refund':_0x597dfe(0x1b6),'chargeback':'Payment\x20chargeback','processing':_0x597dfe(0x259)},_0x223882=_0x5eb4fb[_0x2d3ca2],_0x1ef641=_0x4e1ede[_0x2d3ca2],_0x6e94fd=(0x0,gateway_1[_0x597dfe(0x25b)])(_0x2d2775[_0x597dfe(0x178)]);console[_0x597dfe(0x105)](_0x597dfe(0x1bb)+_0x2d2775[_0x597dfe(0x178)]+_0x597dfe(0x21e)+_0x6e94fd+'\x22');let _0xc5ef26=_0x223882+'\x20*'+_0x1ef641+'*\x0a\x0a'+('ðŸ’°\x20Amount:\x20*'+_0x2d2775['amount']+'\x20'+_0x2d2775[_0x597dfe(0x16b)]+'*\x0a')+(_0x597dfe(0x1f1)+(_0x2d2775[_0x597dfe(0x17f)]||_0x2d2775['id'])+'`\x0a')+(_0x597dfe(0x200)+_0x2d2775['id']+'`\x0a')+(_0x597dfe(0x185)+_0x6e94fd+'`\x0a')+('ðŸ“…\x20Date:\x20'+new Date(_0x2d2775[_0x597dfe(0x1a1)])[_0x597dfe(0x136)](_0x597dfe(0x226))+'\x0a');if(_0x2d2775[_0x597dfe(0x19c)]||_0x2d2775['customerEmail']||_0x2d2775[_0x597dfe(0x1a2)]||_0x2d2775[_0x597dfe(0x166)]||_0x2d2775[_0x597dfe(0x287)]){_0xc5ef26+=_0x597dfe(0x284);_0x2d2775['customerName']&&(_0xc5ef26+=_0x597dfe(0x1af)+_0x2d2775[_0x597dfe(0x19c)]+'`\x0a');_0x2d2775[_0x597dfe(0x228)]&&(_0xc5ef26+=_0x597dfe(0xf4)+_0x2d2775[_0x597dfe(0x228)]+'`\x0a');_0x2d2775[_0x597dfe(0x1a2)]&&(_0xc5ef26+=_0x597dfe(0x25d)+_0x2d2775['remitterIban']+'`\x0a');_0x2d2775['customerIp']&&(_0xc5ef26+=_0x597dfe(0x24e)+_0x2d2775['customerIp']+'`\x0a');if(_0x2d2775[_0x597dfe(0x287)]){const _0x197a58=_0x2d2775[_0x597dfe(0x287)]['length']>0x32?_0x2d2775[_0x597dfe(0x287)][_0x597dfe(0x234)](0x0,0x32)+_0x597dfe(0x13f):_0x2d2775[_0x597dfe(0x287)];_0xc5ef26+=_0x597dfe(0x135)+_0x197a58+'`\x0a';}}_0x2d3ca2===_0x597dfe(0x1f2)&&_0x2d2775[_0x597dfe(0xf5)]&&(_0xc5ef26+=_0x597dfe(0x289)+_0x2d2775['chargebackAmount']+'\x20USDT*\x0a'),_0x2d3ca2===_0x597dfe(0x161)&&(_0xc5ef26+=_0x597dfe(0x123)),_0x2d2775[_0x597dfe(0x16a)]&&(_0xc5ef26+='ðŸ“\x20Notes:\x20'+_0x2d2775[_0x597dfe(0x16a)]+'\x0a'),await this[_0x597dfe(0x12e)](_0x401495,_0xc5ef26,{'parse_mode':_0x597dfe(0x110)});}async[a87_0x60daa8(0x17e)](_0x314307,_0x381d1c){const _0x42e466=a87_0x60daa8,_0x55ff31=new Date(_0x381d1c[_0x42e466(0x1a1)])[_0x42e466(0x136)]('en-US',{'year':'numeric','month':_0x42e466(0x150),'day':_0x42e466(0x150),'hour':_0x42e466(0x150),'minute':_0x42e466(0x150),'second':_0x42e466(0x150)}),_0x401970='ðŸ’¸\x20*New\x20Payout*\x0a\x0a'+(_0x42e466(0x23a)+_0x55ff31+'\x0a')+(_0x42e466(0x112)+_0x381d1c[_0x42e466(0x281)]+_0x42e466(0x16d))+(_0x42e466(0x191)+(_0x381d1c[_0x42e466(0x263)]||_0x42e466(0x1fd))+'\x0a')+('ðŸŒ\x20*Network:*\x20'+(_0x381d1c['network']||_0x42e466(0x1fd))+'\x0a')+(_0x42e466(0x1ed)+(_0x381d1c[_0x42e466(0x14c)]||_0x42e466(0x1fd))+'`\x0a')+(_0x381d1c[_0x42e466(0x1c6)]?_0x42e466(0x15e)+_0x381d1c[_0x42e466(0x1c6)]+'`':_0x42e466(0x27e));await this[_0x42e466(0x12e)](_0x314307,_0x401970,{'parse_mode':_0x42e466(0x110)});}async[a87_0x60daa8(0x256)](_0x4d3f16,_0x155e93){const _0x5ceb6b=a87_0x60daa8;try{const _0x1f3bfa=await database_1[_0x5ceb6b(0x26e)][_0x5ceb6b(0x196)][_0x5ceb6b(0x1c5)]({'where':{'shopId':_0x4d3f16},'select':{'notificationLogin':!![]}});if(!_0x1f3bfa?.[_0x5ceb6b(0x12b)]){console[_0x5ceb6b(0x105)]('ðŸ“±\x20Login\x20notifications\x20disabled\x20for\x20shop\x20'+_0x4d3f16);return;}const _0x275794=_0x155e93[_0x5ceb6b(0x14f)]?'ðŸ”':'ðŸš¨',_0x1f20c9=_0x155e93[_0x5ceb6b(0x14f)]?_0x5ceb6b(0x232):'Failed\x20login\x20attempt';let _0x16da6c=_0x275794+'\x20*'+_0x1f20c9+_0x5ceb6b(0xe7)+(_0x5ceb6b(0x26a)+_0x155e93['username']+'`\x0a')+(_0x5ceb6b(0x138)+_0x155e93['timestamp']['toLocaleString'](_0x5ceb6b(0x226))+'\x0a');_0x155e93[_0x5ceb6b(0x100)]&&(_0x16da6c+='ðŸŒ\x20IP\x20address:\x20`'+_0x155e93[_0x5ceb6b(0x100)]+'`\x0a');_0x155e93['geo']&&(_0x16da6c+='ðŸŒ\x20Country:\x20'+_0x155e93[_0x5ceb6b(0x111)]+'\x0a');if(_0x155e93[_0x5ceb6b(0x21f)]){const _0x3484bf=_0x155e93[_0x5ceb6b(0x21f)][_0x5ceb6b(0x20e)]>0x32?_0x155e93[_0x5ceb6b(0x21f)][_0x5ceb6b(0x234)](0x0,0x32)+_0x5ceb6b(0x13f):_0x155e93[_0x5ceb6b(0x21f)];_0x16da6c+='ðŸ’»\x20Browser:\x20`'+_0x3484bf+'`\x0a';}!_0x155e93[_0x5ceb6b(0x14f)]&&(_0x16da6c+=_0x5ceb6b(0x10b)),await this['sendShopNotification'](_0x4d3f16,_0x16da6c,{'parse_mode':'Markdown'}),console['log']('âœ…\x20Login\x20notification\x20sent\x20for\x20shop\x20'+_0x4d3f16+':\x20'+(_0x155e93[_0x5ceb6b(0x14f)]?_0x5ceb6b(0x14f):'failed'));}catch(_0x524330){console['error'](_0x5ceb6b(0xf3),_0x524330);}}async[a87_0x60daa8(0x235)](_0x483107,_0x6d583a){const _0x2527aa=a87_0x60daa8;try{const _0x456476=await database_1[_0x2527aa(0x26e)][_0x2527aa(0x196)][_0x2527aa(0x1c5)]({'where':{'shopId':_0x483107},'select':{'notificationApiError':!![]}});if(!_0x456476?.[_0x2527aa(0x272)]){console[_0x2527aa(0x105)](_0x2527aa(0xe4)+_0x483107);return;}let _0x182fc8=_0x2527aa(0x117)+('ðŸ”—\x20Endpoint:\x20`'+_0x6d583a['method']+'\x20'+_0x6d583a[_0x2527aa(0x12d)]+'`\x0a')+(_0x2527aa(0x138)+_0x6d583a[_0x2527aa(0x271)][_0x2527aa(0x136)]('en-US')+'\x0a');_0x6d583a[_0x2527aa(0x132)]&&(_0x182fc8+=_0x2527aa(0x115)+_0x6d583a[_0x2527aa(0x132)]+'`\x0a'),_0x182fc8+='âŒ\x20Error:\x20`'+_0x6d583a['errorMessage']+'`\x0a',_0x6d583a[_0x2527aa(0x177)]&&(_0x182fc8+='ðŸ†”\x20Request\x20ID:\x20`'+_0x6d583a[_0x2527aa(0x177)]+'`\x0a'),_0x182fc8+='\x0aðŸ’¡\x20Check\x20your\x20request\x20or\x20contact\x20support.',await this[_0x2527aa(0x12e)](_0x483107,_0x182fc8,{'parse_mode':_0x2527aa(0x110)}),console[_0x2527aa(0x105)]('âœ…\x20API\x20error\x20notification\x20sent\x20for\x20shop\x20'+_0x483107+':\x20'+_0x6d583a[_0x2527aa(0x12d)]);}catch(_0x527751){console[_0x2527aa(0x238)]('Failed\x20to\x20send\x20API\x20error\x20notification:',_0x527751);}}async['sendCustomNotification'](_0x5d990a,_0xb4d1f1,_0x5e721e){const _0x3ca369=a87_0x60daa8;let _0x470241=_0x3ca369(0xe8)+_0xb4d1f1+'*\x0a\x0a';for(const [_0x443c5f,_0x2d8d7e]of Object[_0x3ca369(0x146)](_0x5e721e)){_0x2d8d7e!==null&&_0x2d8d7e!==undefined&&(_0x470241+=_0x443c5f+_0x3ca369(0x27f)+_0x2d8d7e+'`\x0a');}await this[_0x3ca369(0x12e)](_0x5d990a,_0x470241,{'parse_mode':_0x3ca369(0x110)});}async['sendNotificationToAll'](_0xa6824d){const _0x438dec=a87_0x60daa8;try{console[_0x438dec(0x105)](_0x438dec(0x1ef)+_0xa6824d[_0x438dec(0x234)](0x0,0x32)+_0x438dec(0x13f));const _0x2da6c2=await database_1['default']['telegramUser']['findMany']({'select':{'telegramId':!![]}});if(_0x2da6c2[_0x438dec(0x20e)]===0x0){console[_0x438dec(0x105)](_0x438dec(0x193));return;}for(const _0x365c0d of _0x2da6c2){try{await this['bot']?.[_0x438dec(0x266)](_0x365c0d[_0x438dec(0x202)],_0xa6824d,{'parse_mode':_0x438dec(0x110)});}catch(_0x326aea){console[_0x438dec(0x238)](_0x438dec(0x22c)+_0x365c0d[_0x438dec(0x202)]+':',_0x326aea);}}console['log'](_0x438dec(0x1dc)+_0x2da6c2[_0x438dec(0x20e)]+_0x438dec(0x1fc));}catch(_0xcaae56){console[_0x438dec(0x238)]('âŒ\x20Failed\x20to\x20send\x20notification\x20to\x20all\x20users:',_0xcaae56);}}[a87_0x60daa8(0x1ea)](){const _0x24af3d=a87_0x60daa8;return{'isActive':!!this[_0x24af3d(0x1ac)],'username':this[_0x24af3d(0x1c7)]};}async[a87_0x60daa8(0x11a)](_0x3da799,_0xa5d0bb,_0x157876,_0x14dfe7){const _0xef1d6c=a87_0x60daa8;try{if(!this[_0xef1d6c(0x1ac)])return console['error'](_0xef1d6c(0x1d3)),![];const _0x537b31=await database_1[_0xef1d6c(0x26e)][_0xef1d6c(0xe3)][_0xef1d6c(0x217)]({'where':{'shopId':_0x3da799,'isVerified':!![]},'select':{'telegramId':!![]}});if(_0x537b31[_0xef1d6c(0x20e)]===0x0)return console[_0xef1d6c(0x238)](_0xef1d6c(0x137)+_0x3da799),![];let _0x464639=0x0;for(const _0x4bd822 of _0x537b31){try{await this[_0xef1d6c(0x1ac)][_0xef1d6c(0x1e6)](_0x4bd822[_0xef1d6c(0x202)],_0xa5d0bb,{},{'filename':_0x157876,'contentType':_0x157876[_0xef1d6c(0x176)](_0xef1d6c(0x244))?'image/png':_0x157876[_0xef1d6c(0x176)](_0xef1d6c(0x242))||_0x157876['endsWith'](_0xef1d6c(0x156))?_0xef1d6c(0xf7):_0x157876[_0xef1d6c(0x176)]('.pdf')?_0xef1d6c(0x1a6):_0xef1d6c(0x157)}),_0x14dfe7&&await this[_0xef1d6c(0x1ac)][_0xef1d6c(0x266)](_0x4bd822[_0xef1d6c(0x202)],_0x14dfe7),_0x464639++;}catch(_0x1027e5){console[_0xef1d6c(0x238)](_0xef1d6c(0x164)+_0x4bd822[_0xef1d6c(0x202)]+':',_0x1027e5);}}return console['log'](_0xef1d6c(0x1cd)+_0x464639+'/'+_0x537b31[_0xef1d6c(0x20e)]+_0xef1d6c(0x28c)+_0x3da799+':\x20'+_0x157876),_0x464639>0x0;}catch(_0x5b3b21){return console[_0xef1d6c(0x238)](_0xef1d6c(0x121),_0x5b3b21),![];}}async['sendDirectMessage'](_0x30b565,_0x15f7e7){const _0x9dbdd5=a87_0x60daa8;try{if(!this[_0x9dbdd5(0x1ac)])return console['error']('âŒ\x20Telegram\x20bot\x20not\x20initialized'),![];return await this[_0x9dbdd5(0x1ac)]['sendMessage'](_0x30b565,_0x15f7e7),console[_0x9dbdd5(0x105)](_0x9dbdd5(0x1d8)+_0x30b565),!![];}catch(_0x29e525){return console[_0x9dbdd5(0x238)]('âŒ\x20Error\x20sending\x20direct\x20message:',_0x29e525),![];}}async[a87_0x60daa8(0x203)](_0x3a877f,_0x25e692,_0x33e69a,_0x4178ba){const _0x1b1ca3=a87_0x60daa8;try{if(!this[_0x1b1ca3(0x1ac)])return console[_0x1b1ca3(0x238)](_0x1b1ca3(0x1d3)),![];return await this['bot'][_0x1b1ca3(0x1e6)](_0x3a877f,_0x25e692,{},{'filename':_0x33e69a,'contentType':_0x33e69a['endsWith'](_0x1b1ca3(0x244))?_0x1b1ca3(0x19b):_0x33e69a['endsWith'](_0x1b1ca3(0x242))||_0x33e69a[_0x1b1ca3(0x176)]('.jpeg')?'image/jpeg':_0x33e69a['endsWith'](_0x1b1ca3(0x1eb))?'application/pdf':_0x1b1ca3(0x157)}),_0x4178ba&&await this[_0x1b1ca3(0x1ac)][_0x1b1ca3(0x266)](_0x3a877f,_0x4178ba),console['log'](_0x1b1ca3(0x1de)+_0x3a877f+':\x20'+_0x33e69a),!![];}catch(_0xcdfe6){return console[_0x1b1ca3(0x238)](_0x1b1ca3(0x120),_0xcdfe6),![];}}async[a87_0x60daa8(0x274)](_0x551555,_0xfb7c2a,_0x5ae4fd,_0x361ed5){const _0x13c223=a87_0x60daa8,_0xfcd590=this[_0x13c223(0xf0)][_0x13c223(0x253)](_0xfb7c2a)||{};try{if(_0x5ae4fd===_0x13c223(0x134)){this['paymentLinkSessions'][_0x13c223(0x1e5)](_0xfb7c2a),await this['bot']?.[_0x13c223(0x277)](_0x13c223(0x167),{'chat_id':_0x551555,'message_id':_0x361ed5});return;}if(_0x5ae4fd==='pl_view_list'){await this[_0x13c223(0x108)](_0x551555,_0xfb7c2a,_0x361ed5,0x1);return;}if(_0x5ae4fd[_0x13c223(0x11c)](_0x13c223(0x229))){const _0x11cd12=parseInt(_0x5ae4fd['replace'](_0x13c223(0x229),''));await this['showPaymentLinksList'](_0x551555,_0xfb7c2a,_0x361ed5,_0x11cd12);return;}if(_0x5ae4fd==='pl_create_new'){const _0x157fab=await database_1[_0x13c223(0x26e)]['telegramUser']['findUnique']({'where':{'telegramId':_0xfb7c2a},'include':{'shop':!![]}});if(!_0x157fab?.['shop']?.[_0x13c223(0x1ee)]){await this[_0x13c223(0x1ac)]?.[_0x13c223(0x277)](_0x13c223(0x1ff),{'chat_id':_0x551555,'message_id':_0x361ed5});return;}let _0x2afd32;try{_0x2afd32=JSON[_0x13c223(0x1c9)](_0x157fab[_0x13c223(0x170)][_0x13c223(0x1ee)]);}catch{_0x2afd32=_0x157fab[_0x13c223(0x170)]['paymentGateways'][_0x13c223(0x11f)](',')[_0x13c223(0x209)](_0x250ebe=>_0x250ebe['trim']());}if(_0x2afd32[_0x13c223(0x20e)]===0x0){await this[_0x13c223(0x1ac)]?.[_0x13c223(0x277)](_0x13c223(0x23b),{'chat_id':_0x551555,'message_id':_0x361ed5});return;}this['paymentLinkSessions'][_0x13c223(0x143)](_0xfb7c2a,{'step':_0x13c223(0x178)});const _0x175d66=_0x2afd32['map'](_0x2e0d42=>{const _0x3e6401=_0x13c223,_0x48883d=Object[_0x3e6401(0x104)](gateway_1[_0x3e6401(0x17c)])['find'](_0x1ffa26=>gateway_1[_0x3e6401(0x17c)][_0x1ffa26]===_0x2e0d42)||_0x2e0d42;return[{'text':_0x3e6401(0x28f)+_0x48883d,'callback_data':_0x3e6401(0x26d)+_0x48883d}];});await this['bot']?.['editMessageText'](_0x13c223(0x114),{'chat_id':_0x551555,'message_id':_0x361ed5,'parse_mode':_0x13c223(0x110),'reply_markup':{'inline_keyboard':[..._0x175d66,[{'text':_0x13c223(0x182),'callback_data':_0x13c223(0x134)}]]}});return;}if(_0x5ae4fd['startsWith']('pl_gw_')){const _0x1c4028=_0x5ae4fd[_0x13c223(0x246)](_0x13c223(0x26d),'');_0xfcd590[_0x13c223(0x178)]=_0x1c4028,_0xfcd590[_0x13c223(0x1e2)]=_0x13c223(0x1cf),this[_0x13c223(0xf0)]['set'](_0xfb7c2a,_0xfcd590),await this['bot']?.[_0x13c223(0x277)](_0x13c223(0xe2)+'Step\x202/4:\x20Select\x20link\x20type',{'chat_id':_0x551555,'message_id':_0x361ed5,'parse_mode':_0x13c223(0x110),'reply_markup':{'inline_keyboard':[[{'text':_0x13c223(0x27b),'callback_data':_0x13c223(0x15c)}],[{'text':_0x13c223(0x258),'callback_data':_0x13c223(0x213)}],[{'text':'âŒ\x20Cancel','callback_data':'pl_cancel'}]]}});return;}if(_0x5ae4fd['startsWith'](_0x13c223(0xe1))){const _0x845008=_0x5ae4fd[_0x13c223(0x246)](_0x13c223(0xe1),'')[_0x13c223(0x1a0)]();_0xfcd590[_0x13c223(0x1cf)]=_0x845008,_0xfcd590['step']=_0x13c223(0x16b),this['paymentLinkSessions'][_0x13c223(0x143)](_0xfb7c2a,_0xfcd590);const _0x521e88=this['getGatewayCurrencies'](_0xfcd590['gateway']),_0x5516ac=_0x521e88['slice'](0x0,0x14)[_0x13c223(0x198)](_0x4af4de=>[{'text':_0x4af4de,'callback_data':_0x13c223(0x288)+_0x4af4de}]);await this['bot']?.[_0x13c223(0x277)](_0x13c223(0xe2)+_0x13c223(0x278),{'chat_id':_0x551555,'message_id':_0x361ed5,'parse_mode':_0x13c223(0x110),'reply_markup':{'inline_keyboard':[..._0x5516ac,[{'text':_0x13c223(0x182),'callback_data':'pl_cancel'}]]}});return;}if(_0x5ae4fd[_0x13c223(0x11c)](_0x13c223(0x288))){const _0x3d4d44=_0x5ae4fd[_0x13c223(0x246)](_0x13c223(0x288),'');_0xfcd590[_0x13c223(0x16b)]=_0x3d4d44,_0xfcd590[_0x13c223(0x1e2)]='amount',this[_0x13c223(0xf0)][_0x13c223(0x143)](_0xfb7c2a,_0xfcd590),await this['bot']?.[_0x13c223(0x277)](_0x13c223(0xe2)+'Step\x204/4:\x20Enter\x20amount\x0a\x0a'+(_0x13c223(0x225)+_0x3d4d44+_0x13c223(0x169)),{'chat_id':_0x551555,'message_id':_0x361ed5,'parse_mode':_0x13c223(0x110)});return;}}catch(_0x1686d4){console[_0x13c223(0x238)](_0x13c223(0x1d6),_0x1686d4),await this[_0x13c223(0x1ac)]?.[_0x13c223(0x266)](_0x551555,_0x13c223(0x101)),this[_0x13c223(0xf0)]['delete'](_0xfb7c2a);}}async[a87_0x60daa8(0x108)](_0xb2cb46,_0x5b3704,_0x3c0aae,_0x4224dc=0x1){const _0x1f2e40=a87_0x60daa8;try{const _0x5a38f8=await database_1[_0x1f2e40(0x26e)][_0x1f2e40(0xe3)][_0x1f2e40(0x1c5)]({'where':{'telegramId':_0x5b3704},'include':{'shop':!![]}});if(!_0x5a38f8?.['shopId']){await this['bot']?.[_0x1f2e40(0x266)](_0xb2cb46,'âŒ\x20Shop\x20not\x20found.');return;}const _0x18e989=0x5,_0x383877=(_0x4224dc-0x1)*_0x18e989,[_0x156718,_0x220d5f]=await Promise[_0x1f2e40(0x211)]([database_1[_0x1f2e40(0x26e)][_0x1f2e40(0x1c0)][_0x1f2e40(0x217)]({'where':{'shopId':_0x5a38f8[_0x1f2e40(0x18c)]},'orderBy':{'createdAt':'desc'},'take':_0x18e989,'skip':_0x383877}),database_1[_0x1f2e40(0x26e)][_0x1f2e40(0x1c0)]['count']({'where':{'shopId':_0x5a38f8[_0x1f2e40(0x18c)]}})]),_0x516dc5=Math[_0x1f2e40(0x175)](_0x220d5f/_0x18e989);if(_0x156718['length']===0x0){const _0x152cb8=_0x1f2e40(0x1d4);_0x3c0aae?await this[_0x1f2e40(0x1ac)]?.[_0x1f2e40(0x277)](_0x152cb8,{'chat_id':_0xb2cb46,'message_id':_0x3c0aae,'parse_mode':'MarkdownV2','reply_markup':{'inline_keyboard':[[{'text':_0x1f2e40(0x160),'callback_data':_0x1f2e40(0x188)}]]}}):await this[_0x1f2e40(0x1ac)]?.['sendMessage'](_0xb2cb46,_0x152cb8,{'parse_mode':_0x1f2e40(0x1ba),'reply_markup':{'inline_keyboard':[[{'text':'âž•\x20Create\x20New\x20Link','callback_data':_0x1f2e40(0x188)}]]}});return;}let _0x4122f3=_0x1f2e40(0x163)+_0x4224dc+'/'+_0x516dc5+_0x1f2e40(0x1ab);_0x156718['forEach']((_0x143c4c,_0xfea82b)=>{const _0x203a23=_0x1f2e40,_0x3ae630=_0x383877+_0xfea82b+0x1,_0x3dc2e=_0x143c4c[_0x203a23(0x281)]?_0x143c4c['amount']+'\x20'+_0x143c4c[_0x203a23(0x16b)]:_0x203a23(0x190),_0x21a3a8=_0x143c4c[_0x203a23(0x18b)]===_0x203a23(0x148)?'âœ…':'âŒ',_0x49ede9=(process.env.FRONTEND_URL||'https://app.trapay.uk')+_0x203a23(0x173)+_0x143c4c['id'],_0xb31ece=_0x49ede9[_0x203a23(0x246)](/\./g,'\x5c.')['replace'](/-/g,'\x5c-')[_0x203a23(0x246)](/\//g,'\x5c/');_0x4122f3+=_0x3ae630+'\x5c.\x20'+_0x21a3a8+'\x20*'+_0x3dc2e+'*\x0a',_0x4122f3+=_0x203a23(0x231)+_0x143c4c['gateway']+_0x203a23(0x1d0)+_0x143c4c[_0x203a23(0x1cf)]+'\x0a',_0x4122f3+=_0x203a23(0x223)+_0xb31ece+')\x0a\x0a';});const _0x1519b0=[];_0x4224dc>0x1&&_0x1519b0[_0x1f2e40(0x1ec)]({'text':_0x1f2e40(0x212),'callback_data':_0x1f2e40(0x229)+(_0x4224dc-0x1)});_0x4224dc<_0x516dc5&&_0x1519b0[_0x1f2e40(0x1ec)]({'text':_0x1f2e40(0x26f),'callback_data':_0x1f2e40(0x229)+(_0x4224dc+0x1)});const _0x144172=[];_0x1519b0[_0x1f2e40(0x20e)]>0x0&&_0x144172[_0x1f2e40(0x1ec)](_0x1519b0),_0x144172[_0x1f2e40(0x1ec)]([{'text':_0x1f2e40(0x160),'callback_data':'pl_create_new'}]),_0x144172[_0x1f2e40(0x1ec)]([{'text':_0x1f2e40(0x270),'callback_data':'pl_cancel'}]),_0x3c0aae?await this[_0x1f2e40(0x1ac)]?.[_0x1f2e40(0x277)](_0x4122f3,{'chat_id':_0xb2cb46,'message_id':_0x3c0aae,'parse_mode':_0x1f2e40(0x1ba),'reply_markup':{'inline_keyboard':_0x144172}}):await this[_0x1f2e40(0x1ac)]?.[_0x1f2e40(0x266)](_0xb2cb46,_0x4122f3,{'parse_mode':'MarkdownV2','reply_markup':{'inline_keyboard':_0x144172}});}catch(_0x299cfb){console[_0x1f2e40(0x238)](_0x1f2e40(0x152),_0x299cfb),await this[_0x1f2e40(0x1ac)]?.[_0x1f2e40(0x266)](_0xb2cb46,_0x1f2e40(0x25f));}}[a87_0x60daa8(0x283)](_0x592d1f){const _0x3a5721=a87_0x60daa8,_0xbde75b={'1000':[_0x3a5721(0x245),'GBP',_0x3a5721(0x13b)],'0001':['USD','EUR',_0x3a5721(0x20d),_0x3a5721(0x106),_0x3a5721(0x292)],'0010':['USD','EUR','GBP',_0x3a5721(0x106),_0x3a5721(0x292)],'1111':[_0x3a5721(0x245)],'0000':[_0x3a5721(0x245),_0x3a5721(0x13b),_0x3a5721(0x292),_0x3a5721(0x106),'GBP',_0x3a5721(0xf8),'JPY'],'1110':[_0x3a5721(0x245),_0x3a5721(0x13b),_0x3a5721(0x20d)],'2000':['EUR'],'2001':[_0x3a5721(0x245)],'2010':[_0x3a5721(0x245)],'2011':[_0x3a5721(0x106)],'2002':['TRY'],'3000':[_0x3a5721(0x24c),'AED',_0x3a5721(0x245),_0x3a5721(0x13b),_0x3a5721(0x292),_0x3a5721(0x1b3),_0x3a5721(0x15a),'CAD','GBP',_0x3a5721(0x1b7),'INR'],'3001':['USD',_0x3a5721(0x245)],'3002':[_0x3a5721(0x245),_0x3a5721(0x13b),_0x3a5721(0x19a),_0x3a5721(0x20d),_0x3a5721(0x292),'CAD',_0x3a5721(0x243),'JPY'],'3004':[_0x3a5721(0xfa),_0x3a5721(0x151),_0x3a5721(0x276),'USDC',_0x3a5721(0x189),_0x3a5721(0x187),_0x3a5721(0xec),_0x3a5721(0x1f4),_0x3a5721(0x273),'TRX']};return _0xbde75b[_0x592d1f]||['USD'];}async['handleMerchantStatistics'](_0x4b2e62,_0xdcf721,_0x27cb51,_0x472cb4){const _0x373abf=a87_0x60daa8;try{const _0x8bbf22=new Date();let _0x416093,_0x58254b,_0x3a2f8d;switch(_0x27cb51){case _0x373abf(0x1f5):{const _0x8f8da2=new Date(Date[_0x373abf(0x233)](_0x8bbf22[_0x373abf(0x1cc)](),_0x8bbf22[_0x373abf(0x192)](),_0x8bbf22[_0x373abf(0x1ae)]()));_0x416093=_0x8f8da2,_0x58254b=new Date(Date[_0x373abf(0x233)](_0x8bbf22[_0x373abf(0x1cc)](),_0x8bbf22[_0x373abf(0x192)](),_0x8bbf22[_0x373abf(0x1ae)](),0x17,0x3b,0x3b,0x3e7)),_0x3a2f8d=_0x8f8da2[_0x373abf(0x1ae)]()['toString']()['padStart'](0x2,'0')+'.'+(_0x8f8da2[_0x373abf(0x192)]()+0x1)[_0x373abf(0x11e)]()[_0x373abf(0x20f)](0x2,'0')+'.'+_0x8f8da2[_0x373abf(0x1cc)]();break;}case _0x373abf(0x1d2):{const _0x30e71e=new Date(Date[_0x373abf(0x233)](_0x8bbf22[_0x373abf(0x1cc)](),_0x8bbf22[_0x373abf(0x192)](),_0x8bbf22[_0x373abf(0x1ae)]()-0x1));_0x416093=_0x30e71e,_0x58254b=new Date(Date[_0x373abf(0x233)](_0x8bbf22[_0x373abf(0x1cc)](),_0x8bbf22[_0x373abf(0x192)](),_0x8bbf22['getUTCDate']()-0x1,0x17,0x3b,0x3b,0x3e7)),_0x3a2f8d=_0x30e71e[_0x373abf(0x1ae)]()[_0x373abf(0x11e)]()[_0x373abf(0x20f)](0x2,'0')+'.'+(_0x30e71e['getUTCMonth']()+0x1)['toString']()[_0x373abf(0x20f)](0x2,'0')+'.'+_0x30e71e[_0x373abf(0x1cc)]();break;}case _0x373abf(0x247):{const _0x423e99=new Date(Date[_0x373abf(0x233)](_0x8bbf22[_0x373abf(0x1cc)](),_0x8bbf22[_0x373abf(0x192)](),0x1));_0x416093=_0x423e99,_0x58254b=new Date(Date['UTC'](_0x8bbf22['getUTCFullYear'](),_0x8bbf22['getUTCMonth']()+0x1,0x0,0x17,0x3b,0x3b,0x3e7));const _0x2fd9d4=new Date(Date[_0x373abf(0x233)](_0x8bbf22[_0x373abf(0x1cc)](),_0x8bbf22['getUTCMonth']()+0x1,0x0));_0x3a2f8d=_0x423e99['getUTCDate']()[_0x373abf(0x11e)]()[_0x373abf(0x20f)](0x2,'0')+'.'+(_0x423e99['getUTCMonth']()+0x1)[_0x373abf(0x11e)]()[_0x373abf(0x20f)](0x2,'0')+'.'+_0x423e99['getUTCFullYear']()+_0x373abf(0x118)+_0x2fd9d4['getUTCDate']()[_0x373abf(0x11e)]()[_0x373abf(0x20f)](0x2,'0')+'.'+(_0x2fd9d4[_0x373abf(0x192)]()+0x1)[_0x373abf(0x11e)]()[_0x373abf(0x20f)](0x2,'0')+'.'+_0x2fd9d4[_0x373abf(0x1cc)]();break;}case _0x373abf(0x230):{const _0xaf911a=new Date(Date[_0x373abf(0x233)](_0x8bbf22['getUTCFullYear'](),_0x8bbf22[_0x373abf(0x192)]()-0x1,0x1));_0x416093=_0xaf911a,_0x58254b=new Date(Date[_0x373abf(0x233)](_0x8bbf22[_0x373abf(0x1cc)](),_0x8bbf22[_0x373abf(0x192)](),0x0,0x17,0x3b,0x3b,0x3e7));const _0x640939=new Date(Date[_0x373abf(0x233)](_0x8bbf22[_0x373abf(0x1cc)](),_0x8bbf22[_0x373abf(0x192)](),0x0));_0x3a2f8d=_0xaf911a[_0x373abf(0x1ae)]()[_0x373abf(0x11e)]()[_0x373abf(0x20f)](0x2,'0')+'.'+(_0xaf911a[_0x373abf(0x192)]()+0x1)[_0x373abf(0x11e)]()[_0x373abf(0x20f)](0x2,'0')+'.'+_0xaf911a[_0x373abf(0x1cc)]()+_0x373abf(0x118)+_0x640939[_0x373abf(0x1ae)]()['toString']()[_0x373abf(0x20f)](0x2,'0')+'.'+(_0x640939['getUTCMonth']()+0x1)[_0x373abf(0x11e)]()[_0x373abf(0x20f)](0x2,'0')+'.'+_0x640939[_0x373abf(0x1cc)]();break;}case'stats_all_time':{_0x416093=new Date(0x0),_0x58254b=_0x8bbf22,_0x3a2f8d='All\x20Time';break;}default:return;}const _0x22e5f1=await database_1['default'][_0x373abf(0x214)][_0x373abf(0x217)]({'where':{'shopId':_0xdcf721,'createdAt':{'gte':_0x416093,'lte':_0x58254b}},'select':{'status':!![],'amountUSDT':!![],'amountAfterGatewayCommissionUSDT':!![]}});let _0x16fa92=0x0,_0x48bbc2=0x0,_0x53fde5=0x0,_0x1bb473=0x0,_0x107758=0x0,_0xa10e65=0x0;_0x22e5f1[_0x373abf(0x1b9)](_0x1fcf7e=>{const _0x18f40e=_0x373abf,_0x1b2e9c=_0x1fcf7e[_0x18f40e(0x28b)]||0x0,_0x514b4d=_0x1fcf7e['amountAfterGatewayCommissionUSDT']||0x0;if(_0x1fcf7e[_0x18f40e(0x18b)]===_0x18f40e(0xfc))_0x16fa92+=_0x1b2e9c,_0x48bbc2+=_0x1b2e9c-_0x514b4d,_0x53fde5++;else{if(_0x1fcf7e[_0x18f40e(0x18b)]===_0x18f40e(0xfe)||_0x1fcf7e['status']===_0x18f40e(0x216))_0x1bb473++;else{if(_0x1fcf7e['status']===_0x18f40e(0x265))_0x107758++,_0x16fa92+=_0x1b2e9c;else _0x1fcf7e[_0x18f40e(0x18b)]===_0x18f40e(0x162)&&(_0xa10e65++,_0x16fa92+=_0x1b2e9c);}}});const _0x1c3ff5=_0x53fde5+_0x1bb473,_0x34186c=_0x1c3ff5>0x0?(_0x53fde5/_0x1c3ff5*0x64)[_0x373abf(0x149)](0x1):_0x373abf(0x199),_0xc629e3=_0x3a2f8d[_0x373abf(0x246)](/\./g,'\x5c.')[_0x373abf(0x246)](/\-/g,'\x5c-'),_0x4dbb2e=_0x16fa92[_0x373abf(0x149)](0x2)['replace'](/\./g,'\x5c.'),_0x4e7173=_0x48bbc2['toFixed'](0x2)[_0x373abf(0x246)](/\./g,'\x5c.'),_0xb03b6b=_0x34186c[_0x373abf(0x246)](/\./g,'\x5c.'),_0x2654cd=_0x373abf(0x130)+_0xc629e3+'*\x0a\x0a'+('ðŸ’°\x20Turnover\x20\x5c-\x20'+_0x4dbb2e+'\x20USDT\x0a')+(_0x373abf(0x1b1)+_0x4e7173+_0x373abf(0x285))+(_0x373abf(0x1d9)+_0x53fde5+'\x0a')+('âŒ\x20Failed\x20Payments\x20\x5c-\x20'+_0x1bb473+'\x0a')+('ðŸ“ˆ\x20Conversion\x20\x5c-\x20'+_0xb03b6b+'%\x0a')+(_0x373abf(0x18f)+_0x107758+'\x0a')+(_0x373abf(0x14a)+_0xa10e65),_0x4df6a2={'inline_keyboard':[[{'text':_0x373abf(0x16e),'callback_data':'back_to_stats_menu'}]]};_0x472cb4?await this[_0x373abf(0x1ac)]?.[_0x373abf(0x277)](_0x2654cd,{'chat_id':_0x4b2e62,'message_id':_0x472cb4,'parse_mode':_0x373abf(0x1ba),'reply_markup':_0x4df6a2}):await this[_0x373abf(0x1ac)]?.[_0x373abf(0x266)](_0x4b2e62,_0x2654cd,{'parse_mode':_0x373abf(0x1ba),'reply_markup':_0x4df6a2});}catch(_0x18fede){console[_0x373abf(0x238)](_0x373abf(0x1c1),_0x18fede),await this['bot']?.[_0x373abf(0x266)](_0x4b2e62,_0x373abf(0x24d));}}[a87_0x60daa8(0x279)](){const _0x3082c0=a87_0x60daa8;this[_0x3082c0(0x1ac)]&&(this[_0x3082c0(0x1ac)]['stopPolling'](),this['bot']=null,console[_0x3082c0(0x105)](_0x3082c0(0x22f)));}}function a87_0x2625(_0x5550d4,_0x3c083f){_0x5550d4=_0x5550d4-0xe0;const _0x88bbd0=a87_0x88bb();let _0x262514=_0x88bbd0[_0x5550d4];return _0x262514;}exports[a87_0x60daa8(0x18d)]=TelegramBotService,exports[a87_0x60daa8(0xee)]=new TelegramBotService();