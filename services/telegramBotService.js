'use strict';const a59_0x3b31fe=a59_0x133c;function a59_0x133c(_0x1e213d,_0x46d340){const _0x13cb67=a59_0x13cb();return a59_0x133c=function(_0x133cb5,_0x2dd83e){_0x133cb5=_0x133cb5-0x19a;let _0x2e51eb=_0x13cb67[_0x133cb5];return _0x2e51eb;},a59_0x133c(_0x1e213d,_0x46d340);}(function(_0x2410e9,_0x27c835){const _0x1c60ac=a59_0x133c,_0x4ef9dd=_0x2410e9();while(!![]){try{const _0x143d9c=-parseInt(_0x1c60ac(0x1ca))/0x1+-parseInt(_0x1c60ac(0x24b))/0x2*(-parseInt(_0x1c60ac(0x25a))/0x3)+-parseInt(_0x1c60ac(0x233))/0x4*(parseInt(_0x1c60ac(0x223))/0x5)+parseInt(_0x1c60ac(0x1c6))/0x6*(parseInt(_0x1c60ac(0x1b3))/0x7)+parseInt(_0x1c60ac(0x1f3))/0x8*(-parseInt(_0x1c60ac(0x1c0))/0x9)+-parseInt(_0x1c60ac(0x1c9))/0xa+parseInt(_0x1c60ac(0x275))/0xb;if(_0x143d9c===_0x27c835)break;else _0x4ef9dd['push'](_0x4ef9dd['shift']());}catch(_0x921cf7){_0x4ef9dd['push'](_0x4ef9dd['shift']());}}}(a59_0x13cb,0x6ca21));var __importDefault=this&&this[a59_0x3b31fe(0x234)]||function(_0x1e9353){const _0x2970c9=a59_0x3b31fe;return _0x1e9353&&_0x1e9353[_0x2970c9(0x1b6)]?_0x1e9353:{'default':_0x1e9353};};Object[a59_0x3b31fe(0x220)](exports,a59_0x3b31fe(0x1b6),{'value':!![]}),exports[a59_0x3b31fe(0x1b0)]=exports[a59_0x3b31fe(0x1ff)]=void 0x0;const node_telegram_bot_api_1=__importDefault(require(a59_0x3b31fe(0x25b))),database_1=__importDefault(require(a59_0x3b31fe(0x20d))),gateway_1=require(a59_0x3b31fe(0x219));function a59_0x13cb(){const _0x522796=['\x20initialized\x20successfully','\x22\x20->\x20display\x20\x22','Check\x20the\x20key\x20and\x20try\x20again.\x0a\x0a','length','substring','getBotInfo','TELEGRAM_BOT_TOKEN','Contact\x20administrator.','error','processing','requestId','Payment\x20failed','2632YrYLtx','__importDefault','stopBot','✅\x20Login\x20notification\x20sent\x20for\x20shop\x20','✅\x20Telegram\x20bot\x20@','🔗\x20TXID:\x20`','❌\x20Invalid\x20format.\x20Please\x20send\x20exactly\x202\x20parts\x20separated\x20by\x20space:\x0a\x0a','...','toLocaleString','message','📊\x20*Connection\x20Status*\x0a\x0a','\x20\x20\x20Username:\x20`','Error\x20in\x20handleSingleLineVerification:','entries','txid','bot','endpoint','❌\x20Error\x20getting\x20debug\x20information.','isVerified','Commands:\x0a','✅\x20Welcome\x20back!\x0a\x0a','env','🚨\x20*API\x20Error*\x0a\x0a','success','104492hRMAIR','❌\x20An\x20error\x20occurred.\x20Please\x20try\x20again\x20later.','publicKey','method','Telegram\x20bot\x20not\x20initialized,\x20cannot\x20send\x20notification','Disconnect\x20the\x20previous\x20account\x20first\x20or\x20contact\x20administrator.','🌐\x20IP\x20address:\x20`','`\x20(','📱\x20Login\x20notifications\x20disabled\x20for\x20shop\x20','findUnique','from','Use\x20/status\x20to\x20check\x20status\x20or\x20/disconnect\x20to\x20disconnect.','/disconnect\x20-\x20disconnect\x20from\x20notifications','📛\x20Name:\x20`','remitterIban','3UtTAKG','node-telegram-bot-api','💸\x20Penalty\x20amount:\x20*','chat\x20not\x20found','❗️\x20Make\x20sure\x20to\x20separate\x20username\x20and\x20API\x20key\x20with\x20a\x20space!','orderId','customerName','Available\x20usernames:\x0a','customerIp','\x20(@','last_name','secretKey','*\x0a\x0a','timestamp','🏦\x20IBAN:\x20`','ipAddress','statusCode','✅\x20Connected\x20to\x20shop:\x20*','adminNotes','✅\x20Notification\x20sent\x20to\x20Telegram\x20user\x20','telegramUser','\x0a👤\x20*Customer\x20Information:*\x0a','Expected\x20key\x20format:\x20`pk_...`\x20or\x20`sk_...`','map','•\x20`','notificationApiError','\x20USDT*\x0a','20327054oXeIuB','includes','\x0a💡\x20Check\x20your\x20request\x20or\x20contact\x20support.','username','Payment\x20successfully\x20paid','•\x20Important\x20events\x0a\x0a','Telegram\x20bot\x20polling\x20error:','name','notificationLogin','No\x20verified\x20Telegram\x20users\x20found\x20for\x20shop\x20','customerUa','📱\x20Created\x20new\x20Telegram\x20user:\x20','startsWith','📊\x20Error\x20code:\x20`','Payment\x20chargeback','update','amount','botUsername','user\x20is\x20deactivated','•\x20New\x20payments\x0a','New\x20payout\x20created','💸\x20Amount:\x20*','📱\x20Shop:\x20*','🤖\x20Welcome\x20to\x20TRAPAY\x20notification\x20system!\x0a\x0a','User\x20','chargebackAmount','❌\x20Invalid\x20username\x20format:\x20`','telegramBotService','onText','❌\x20Failed\x20to\x20send\x20notification\x20to\x20Telegram\x20user\x20','1844206idRGqc','Error\x20handling\x20message:','You\x20are\x20already\x20connected\x20to\x20shop:\x20*','__esModule','❌\x20Another\x20Telegram\x20account\x20is\x20already\x20connected\x20to\x20shop\x20`','✅\x20You\x20have\x20been\x20successfully\x20connected\x20to\x20the\x20notification\x20system!\x0a\x0a','errorMessage','shop','ACTIVE','sendApiErrorNotification','🔔\x20*','❌\x20You\x20are\x20not\x20connected\x20to\x20the\x20notification\x20system.','...\x22','567uNSfqB',':\x20username=\x22','🎉\x20*Congratulations!*\x0a\x0a','\x20\x20\x20Status:\x20','📅\x20Connection\x20date:\x20','setupBotHandlers','18SgRBbU','🆔\x20Request\x20ID:\x20`','telegramId','1508270MxpWKb','881653QLZgLG','updatedAt','💻\x20Browser:\x20`','shopSettings','•\x20Payment\x20status\x20changes\x0a','❌\x20Error:\x20`','toString','`\x0a\x0a','shopId','chat','Use\x20/start\x20to\x20connect.','log','botToken','sendShopNotification','✅\x20You\x20are\x20already\x20connected\x20to\x20shop\x20*','You\x20sent\x20','Example:\x0a','Payment\x20expired','📝\x20Format:\x20`username\x20api_key`\x0a\x0a','💰\x20Amount:\x20*','findFirst','create','❌\x20You\x20are\x20not\x20registered\x20in\x20the\x20system.\x0a\x0a','❌\x20Shop\x20`','handleSingleLineVerification','🔄\x20Reset\x20incomplete\x20verification\x20for\x20user\x20','currency','🏦\x20Method:\x20`','`\x20is\x20inactive.\x0a\x0a','TELEGRAM_BOT_USERNAME','pk_','initializeBot','🏪\x20Available\x20shops\x20in\x20system:\x0a','createdAt','\x20\x20\x20Public\x20Key:\x20`','📝\x20Notes:\x20','❌\x20Invalid\x20API\x20key\x20format.\x0a\x0a','🆔\x20Payout\x20ID:\x20`','allSettled','\x20verified\x20for\x20shop\x20','Error\x20handling\x20/disconnect\x20command:','105832lgvHQu','\x20via\x20single-line\x20input','API\x20key\x20must\x20start\x20with\x20`pk\x5c_`\x20or\x20`sk\x5c_`.','❌\x20Please\x20use\x20/start\x20command\x20first','🔄\x20Processing\x20single-line\x20verification\x20for\x20user\x20','Error\x20handling\x20/debug\x20command:','To\x20receive\x20payment\x20notifications,\x20send\x20your\x20credentials\x20in\x20one\x20line:\x0a\x0a','\x20disconnected\x20from\x20shop\x20','🔌\x20User\x20','en-US','To\x20reconnect,\x20use\x20the\x20/start\x20command','text','TelegramBotService','/status\x20-\x20check\x20connection\x20status\x0a','sendPaymentNotification','join','Markdown','`.\x0a\x0a','sendMessage','Username:\x20`','📱\x20Your\x20Telegram\x20ID:\x20`','*.\x0a\x0a','📧\x20Email:\x20`','❌\x20You\x20are\x20not\x20connected\x20to\x20a\x20shop.\x0a\x0a','Failed\x20login\x20attempt','❌\x20Shop\x20with\x20username\x20`','../config/database','🔗\x20Endpoint:\x20`','TELEGRAM_BOT_TOKEN\x20not\x20found\x20in\x20environment\x20variables','forEach','customerEmail','\x20parts:\x20','sendLoginNotification','Payout\x20completed','Use\x20/start\x20to\x20begin.','\x22,\x20apiKey=\x22','failed','Payout\x20rejected','../types/gateway','test','chargeback','gateway','`appple\x20pk_aa6450d3f57afbefbb0f3f5be5ce6cca13037536afc5ccf14c81a6cbc7a07de5`\x0a\x0a','sk_','default','defineProperty','userAgent','...`\x0a\x0a','2885OPpzTI','findMany','Username\x20must\x20contain\x20only\x20letters,\x20numbers\x20and\x20underscore\x20(3-50\x20characters).','👤\x20Username:\x20`'];a59_0x13cb=function(){return _0x522796;};return a59_0x13cb();}class TelegramBotService{constructor(){const _0x15d341=a59_0x3b31fe;this['bot']=null,this[_0x15d341(0x1d6)]=process[_0x15d341(0x248)][_0x15d341(0x22d)]||'',this[_0x15d341(0x1a6)]=process[_0x15d341(0x248)][_0x15d341(0x1e7)]||'trapay_bot',this[_0x15d341(0x1d6)]?this[_0x15d341(0x1e9)]():console['warn'](_0x15d341(0x20f));}[a59_0x3b31fe(0x1e9)](){const _0x74ba77=a59_0x3b31fe;try{this[_0x74ba77(0x242)]=new node_telegram_bot_api_1['default'](this['botToken'],{'polling':!![]}),this[_0x74ba77(0x1c5)](),console[_0x74ba77(0x1d5)](_0x74ba77(0x237)+this[_0x74ba77(0x1a6)]+_0x74ba77(0x227));}catch(_0x587b27){console[_0x74ba77(0x22f)]('❌\x20Failed\x20to\x20initialize\x20Telegram\x20bot:',_0x587b27);}}['setupBotHandlers'](){const _0x5b0b35=a59_0x3b31fe;if(!this[_0x5b0b35(0x242)])return;this['bot'][_0x5b0b35(0x1b1)](/\/start/,async _0x5301de=>{const _0x3db541=_0x5b0b35,_0x18399b=_0x5301de['chat']['id'],_0x388904=_0x5301de[_0x3db541(0x255)]?.['id'][_0x3db541(0x1d0)](),_0x1cc434=_0x5301de[_0x3db541(0x255)]?.[_0x3db541(0x278)],_0x1b4e97=_0x5301de[_0x3db541(0x255)]?.['first_name'],_0x39a8df=_0x5301de[_0x3db541(0x255)]?.[_0x3db541(0x264)];if(!_0x388904)return;try{let _0x4b476a=await database_1[_0x3db541(0x21f)][_0x3db541(0x26e)]['findUnique']({'where':{'telegramId':_0x388904},'include':{'shop':!![]}});!_0x4b476a?(_0x4b476a=await database_1[_0x3db541(0x21f)][_0x3db541(0x26e)][_0x3db541(0x1df)]({'data':{'telegramId':_0x388904,'username':_0x1cc434,'firstName':_0x1b4e97,'lastName':_0x39a8df,'isVerified':![],'shopId':null},'include':{'shop':!![]}}),console[_0x3db541(0x1d5)](_0x3db541(0x1a0)+_0x388904+_0x3db541(0x263)+_0x1cc434+')')):_0x4b476a=await database_1['default']['telegramUser'][_0x3db541(0x1a4)]({'where':{'telegramId':_0x388904},'data':{'username':_0x1cc434,'firstName':_0x1b4e97,'lastName':_0x39a8df},'include':{'shop':!![]}}),_0x4b476a['isVerified']&&_0x4b476a['shopId']&&_0x4b476a[_0x3db541(0x1ba)]?await this[_0x3db541(0x242)]?.[_0x3db541(0x205)](_0x18399b,_0x3db541(0x247)+(_0x3db541(0x1b5)+_0x4b476a[_0x3db541(0x1ba)][_0x3db541(0x19c)]+'*\x0a')+(_0x3db541(0x206)+_0x4b476a[_0x3db541(0x1ba)][_0x3db541(0x278)]+_0x3db541(0x1d1))+'🔔\x20You\x20receive\x20notifications\x20about:\x0a'+_0x3db541(0x1a8)+_0x3db541(0x1ce)+'•\x20Payouts\x0a\x0a'+'Commands:\x0a'+'/status\x20-\x20check\x20connection\x20status\x0a'+_0x3db541(0x257),{'parse_mode':_0x3db541(0x203)}):(_0x4b476a[_0x3db541(0x1d2)]&&!_0x4b476a[_0x3db541(0x245)]&&(await database_1[_0x3db541(0x21f)][_0x3db541(0x26e)][_0x3db541(0x1a4)]({'where':{'telegramId':_0x388904},'data':{'shopId':null,'isVerified':![]}}),console[_0x3db541(0x1d5)](_0x3db541(0x1e3)+_0x388904)),await this[_0x3db541(0x242)]?.[_0x3db541(0x205)](_0x18399b,_0x3db541(0x1ac)+_0x3db541(0x1f9)+_0x3db541(0x1dc)+_0x3db541(0x1da)+_0x3db541(0x21d)+_0x3db541(0x25e),{'parse_mode':_0x3db541(0x203)}));}catch(_0x1dc3fc){console[_0x3db541(0x22f)]('Error\x20handling\x20/start\x20command:',_0x1dc3fc),await this[_0x3db541(0x242)]?.[_0x3db541(0x205)](_0x18399b,_0x3db541(0x24c));}}),this['bot']['onText'](/\/disconnect/,async _0x210abe=>{const _0x353b0b=_0x5b0b35,_0x20c4aa=_0x210abe[_0x353b0b(0x1d3)]['id'],_0x30dafc=_0x210abe[_0x353b0b(0x255)]?.['id']['toString']();if(!_0x30dafc)return;try{const _0x478f29=await database_1['default'][_0x353b0b(0x26e)][_0x353b0b(0x254)]({'where':{'telegramId':_0x30dafc},'include':{'shop':!![]}});if(!_0x478f29||!_0x478f29['isVerified']||!_0x478f29[_0x353b0b(0x1d2)]){await this[_0x353b0b(0x242)]?.[_0x353b0b(0x205)](_0x20c4aa,_0x353b0b(0x1be));return;}const _0x52f0c8=_0x478f29[_0x353b0b(0x1ba)]?.[_0x353b0b(0x19c)]||'unknown\x20shop';await database_1['default'][_0x353b0b(0x26e)][_0x353b0b(0x1a4)]({'where':{'telegramId':_0x30dafc},'data':{'shopId':null,'isVerified':![]}}),console[_0x353b0b(0x1d5)](_0x353b0b(0x1fb)+_0x30dafc+_0x353b0b(0x1fa)+_0x478f29[_0x353b0b(0x1d2)]),await this[_0x353b0b(0x242)]?.['sendMessage'](_0x20c4aa,'✅\x20You\x20have\x20been\x20successfully\x20disconnected\x20from\x20shop\x20*'+_0x52f0c8+_0x353b0b(0x208)+_0x353b0b(0x1fd),{'parse_mode':_0x353b0b(0x203)});}catch(_0xc2054e){console[_0x353b0b(0x22f)](_0x353b0b(0x1f2),_0xc2054e),await this[_0x353b0b(0x242)]?.[_0x353b0b(0x205)](_0x20c4aa,'❌\x20An\x20error\x20occurred.\x20Please\x20try\x20again\x20later.');}}),this['bot']['onText'](/\/status/,async _0xba826e=>{const _0x38c7b6=_0x5b0b35,_0x515abc=_0xba826e[_0x38c7b6(0x1d3)]['id'],_0x47c05d=_0xba826e[_0x38c7b6(0x255)]?.['id'][_0x38c7b6(0x1d0)]();if(!_0x47c05d)return;try{const _0x5afe6d=await database_1[_0x38c7b6(0x21f)][_0x38c7b6(0x26e)][_0x38c7b6(0x254)]({'where':{'telegramId':_0x47c05d},'include':{'shop':!![]}});if(!_0x5afe6d){await this['bot']?.[_0x38c7b6(0x205)](_0x515abc,_0x38c7b6(0x1e0)+_0x38c7b6(0x215));return;}if(!_0x5afe6d[_0x38c7b6(0x245)]||!_0x5afe6d[_0x38c7b6(0x1d2)]||!_0x5afe6d['shop']){await this[_0x38c7b6(0x242)]?.[_0x38c7b6(0x205)](_0x515abc,_0x38c7b6(0x20a)+_0x38c7b6(0x1d4));return;}await this[_0x38c7b6(0x242)]?.[_0x38c7b6(0x205)](_0x515abc,_0x38c7b6(0x23d)+(_0x38c7b6(0x26b)+_0x5afe6d['shop'][_0x38c7b6(0x19c)]+'*\x0a')+(_0x38c7b6(0x226)+_0x5afe6d[_0x38c7b6(0x1ba)][_0x38c7b6(0x278)]+'`\x0a')+(_0x38c7b6(0x1c4)+_0x5afe6d[_0x38c7b6(0x1cb)]['toLocaleDateString'](_0x38c7b6(0x1fc))+'\x0a\x0a')+'🔔\x20Notifications\x20are\x20active\x0a\x0a'+'Commands:\x0a'+_0x38c7b6(0x257),{'parse_mode':_0x38c7b6(0x203)});}catch(_0x8cffe4){console[_0x38c7b6(0x22f)]('Error\x20handling\x20/status\x20command:',_0x8cffe4),await this['bot']?.[_0x38c7b6(0x205)](_0x515abc,_0x38c7b6(0x24c));}}),this[_0x5b0b35(0x242)][_0x5b0b35(0x1b1)](/\/debug/,async _0x4645bb=>{const _0xf1ae8d=_0x5b0b35,_0x491cba=_0x4645bb['chat']['id'],_0x2e0604=_0x4645bb['from']?.['id'][_0xf1ae8d(0x1d0)]();if(!_0x2e0604)return;try{const _0x16ff17=await database_1['default'][_0xf1ae8d(0x1ba)]['findMany']({'select':{'id':!![],'name':!![],'username':!![],'status':!![],'publicKey':!![]},'take':0xa});let _0x52ffc5='🔍\x20*Debug\x20Information*\x0a\x0a';_0x52ffc5+=_0xf1ae8d(0x207)+_0x2e0604+_0xf1ae8d(0x1d1),_0x52ffc5+=_0xf1ae8d(0x1ea),_0x16ff17['forEach']((_0x4c5a98,_0x1cd881)=>{const _0x195e70=_0xf1ae8d;_0x52ffc5+=_0x1cd881+0x1+'.\x20*'+_0x4c5a98[_0x195e70(0x19c)]+'*\x0a',_0x52ffc5+=_0x195e70(0x23e)+_0x4c5a98['username']+'`\x0a',_0x52ffc5+=_0x195e70(0x1c3)+_0x4c5a98['status']+'\x0a',_0x52ffc5+=_0x195e70(0x1ec)+_0x4c5a98[_0x195e70(0x24d)]['substring'](0x0,0xf)+_0x195e70(0x222);}),await this[_0xf1ae8d(0x242)]?.[_0xf1ae8d(0x205)](_0x491cba,_0x52ffc5,{'parse_mode':_0xf1ae8d(0x203)});}catch(_0x4f9d5d){console[_0xf1ae8d(0x22f)](_0xf1ae8d(0x1f8),_0x4f9d5d),await this[_0xf1ae8d(0x242)]?.['sendMessage'](_0x491cba,_0xf1ae8d(0x244));}}),this['bot']['on']('message',async _0x1badf6=>{const _0x4cb4a7=_0x5b0b35;if(_0x1badf6[_0x4cb4a7(0x1fe)]?.[_0x4cb4a7(0x1a1)]('/'))return;const _0x2e0801=_0x1badf6[_0x4cb4a7(0x1d3)]['id'],_0x39d2b2=_0x1badf6[_0x4cb4a7(0x255)]?.['id'][_0x4cb4a7(0x1d0)](),_0x582e4f=_0x1badf6[_0x4cb4a7(0x1fe)]?.['trim']();if(!_0x39d2b2||!_0x582e4f)return;try{const _0x206713=await database_1[_0x4cb4a7(0x21f)][_0x4cb4a7(0x26e)][_0x4cb4a7(0x254)]({'where':{'telegramId':_0x39d2b2},'include':{'shop':!![]}});if(!_0x206713){await this[_0x4cb4a7(0x242)]?.[_0x4cb4a7(0x205)](_0x2e0801,_0x4cb4a7(0x1f6));return;}if(_0x206713['isVerified']&&_0x206713['shopId']&&_0x206713[_0x4cb4a7(0x1ba)]){await this['bot']?.[_0x4cb4a7(0x205)](_0x2e0801,_0x4cb4a7(0x1d8)+_0x206713[_0x4cb4a7(0x1ba)][_0x4cb4a7(0x19c)]+'*.\x0a\x0a'+_0x4cb4a7(0x256),{'parse_mode':_0x4cb4a7(0x203)});return;}const _0x1a94c8=_0x582e4f['split'](/\s+/);if(_0x1a94c8[_0x4cb4a7(0x22a)]!==0x2){await this[_0x4cb4a7(0x242)]?.[_0x4cb4a7(0x205)](_0x2e0801,_0x4cb4a7(0x239)+'📝\x20Format:\x20`username\x20api_key`\x0a\x0a'+'Example:\x0a'+_0x4cb4a7(0x21d)+(_0x4cb4a7(0x1d9)+_0x1a94c8[_0x4cb4a7(0x22a)]+_0x4cb4a7(0x212)+_0x1a94c8[_0x4cb4a7(0x271)](_0x510fe9=>'`'+_0x510fe9+'`')[_0x4cb4a7(0x202)](',\x20')),{'parse_mode':_0x4cb4a7(0x203)});return;}const [_0x23a9ad,_0x4ec3d1]=_0x1a94c8;console[_0x4cb4a7(0x1d5)](_0x4cb4a7(0x1f7)+_0x39d2b2+':\x20username=\x22'+_0x23a9ad+_0x4cb4a7(0x216)+_0x4ec3d1['substring'](0x0,0xa)+'...\x22'),await this[_0x4cb4a7(0x1e2)](_0x2e0801,_0x39d2b2,_0x23a9ad,_0x4ec3d1);}catch(_0x16d63f){console[_0x4cb4a7(0x22f)](_0x4cb4a7(0x1b4),_0x16d63f),await this[_0x4cb4a7(0x242)]?.[_0x4cb4a7(0x205)](_0x2e0801,'❌\x20An\x20error\x20occurred.\x20Please\x20try\x20again\x20later.');}}),this[_0x5b0b35(0x242)]['on'](_0x5b0b35(0x22f),_0xe5f7f2=>{const _0x4799c0=_0x5b0b35;console[_0x4799c0(0x22f)]('Telegram\x20bot\x20error:',_0xe5f7f2);}),this[_0x5b0b35(0x242)]['on']('polling_error',_0x2ccbab=>{const _0x54207f=_0x5b0b35;console[_0x54207f(0x22f)](_0x54207f(0x19b),_0x2ccbab);});}async[a59_0x3b31fe(0x1e2)](_0xa53ec6,_0x2cb733,_0x1ec8ee,_0x10fe7e){const _0x11cb64=a59_0x3b31fe;try{console['log'](_0x11cb64(0x1f7)+_0x2cb733+_0x11cb64(0x1c1)+_0x1ec8ee+_0x11cb64(0x216)+_0x10fe7e['substring'](0x0,0xa)+_0x11cb64(0x1bf));if(!_0x1ec8ee||_0x1ec8ee[_0x11cb64(0x22a)]<0x3||_0x1ec8ee[_0x11cb64(0x22a)]>0x32||!/^[a-zA-Z0-9_]+$/[_0x11cb64(0x21a)](_0x1ec8ee)){await this['bot']?.['sendMessage'](_0xa53ec6,_0x11cb64(0x1af)+_0x1ec8ee+_0x11cb64(0x1d1)+_0x11cb64(0x225),{'parse_mode':_0x11cb64(0x203)});return;}if(!_0x10fe7e||!_0x10fe7e['startsWith'](_0x11cb64(0x1e8))&&!_0x10fe7e[_0x11cb64(0x1a1)](_0x11cb64(0x21e))){await this[_0x11cb64(0x242)]?.[_0x11cb64(0x205)](_0xa53ec6,_0x11cb64(0x1ee)+_0x11cb64(0x1f5),{'parse_mode':_0x11cb64(0x203)});return;}const _0x52fbaa=await database_1[_0x11cb64(0x21f)]['shop']['findUnique']({'where':{'username':_0x1ec8ee},'select':{'id':!![],'name':!![],'username':!![],'status':!![],'publicKey':!![],'secretKey':!![]}});if(!_0x52fbaa){const _0x129b5c=await database_1['default'][_0x11cb64(0x1ba)][_0x11cb64(0x224)]({'select':{'username':!![],'name':!![]},'take':0x5});let _0x12a9ac=_0x11cb64(0x20c)+_0x1ec8ee+'`\x20not\x20found.\x0a\x0a';_0x129b5c[_0x11cb64(0x22a)]>0x0?(_0x12a9ac+=_0x11cb64(0x261),_0x129b5c[_0x11cb64(0x210)](_0xc9036c=>{const _0x2977dd=_0x11cb64;_0x12a9ac+=_0x2977dd(0x272)+_0xc9036c[_0x2977dd(0x278)]+_0x2977dd(0x252)+_0xc9036c[_0x2977dd(0x19c)]+')\x0a';}),_0x12a9ac+='\x0aCheck\x20spelling\x20and\x20try\x20again.'):_0x12a9ac+='Check\x20spelling\x20and\x20try\x20again.';await this[_0x11cb64(0x242)]?.[_0x11cb64(0x205)](_0xa53ec6,_0x12a9ac,{'parse_mode':_0x11cb64(0x203)});return;}if(_0x52fbaa['status']!==_0x11cb64(0x1bb)){await this[_0x11cb64(0x242)]?.['sendMessage'](_0xa53ec6,_0x11cb64(0x1e1)+_0x1ec8ee+_0x11cb64(0x1e6)+_0x11cb64(0x22e),{'parse_mode':_0x11cb64(0x203)});return;}if(_0x52fbaa[_0x11cb64(0x24d)]!==_0x10fe7e&&_0x52fbaa[_0x11cb64(0x265)]!==_0x10fe7e){await this[_0x11cb64(0x242)]?.['sendMessage'](_0xa53ec6,'❌\x20API\x20key\x20does\x20not\x20match\x20shop\x20`'+_0x1ec8ee+_0x11cb64(0x204)+_0x11cb64(0x229)+_0x11cb64(0x270),{'parse_mode':'Markdown'});return;}const _0xc3ead3=await database_1[_0x11cb64(0x21f)]['telegramUser'][_0x11cb64(0x1de)]({'where':{'shopId':_0x52fbaa['id'],'isVerified':!![],'telegramId':{'not':_0x2cb733}}});if(_0xc3ead3){await this['bot']?.[_0x11cb64(0x205)](_0xa53ec6,_0x11cb64(0x1b7)+_0x1ec8ee+_0x11cb64(0x204)+_0x11cb64(0x250),{'parse_mode':_0x11cb64(0x203)});return;}await database_1[_0x11cb64(0x21f)][_0x11cb64(0x26e)][_0x11cb64(0x1a4)]({'where':{'telegramId':_0x2cb733},'data':{'shopId':_0x52fbaa['id'],'isVerified':!![]}}),await this[_0x11cb64(0x242)]?.['sendMessage'](_0xa53ec6,_0x11cb64(0x1c2)+_0x11cb64(0x1b8)+(_0x11cb64(0x1ab)+_0x52fbaa[_0x11cb64(0x19c)]+'*\x0a')+(_0x11cb64(0x226)+_0x52fbaa[_0x11cb64(0x278)]+'`\x0a\x0a')+'🔔\x20You\x20will\x20now\x20receive\x20notifications\x20about:\x0a'+_0x11cb64(0x1a8)+_0x11cb64(0x1ce)+'•\x20Payouts\x0a'+_0x11cb64(0x19a)+_0x11cb64(0x246)+_0x11cb64(0x200)+_0x11cb64(0x257),{'parse_mode':_0x11cb64(0x203)}),console[_0x11cb64(0x1d5)]('✅\x20Telegram\x20user\x20'+_0x2cb733+_0x11cb64(0x1f1)+_0x52fbaa[_0x11cb64(0x278)]+_0x11cb64(0x1f4));}catch(_0x52e8c3){console[_0x11cb64(0x22f)](_0x11cb64(0x23f),_0x52e8c3),await this[_0x11cb64(0x242)]?.[_0x11cb64(0x205)](_0xa53ec6,'❌\x20An\x20error\x20occurred\x20while\x20verifying\x20data.');}}async[a59_0x3b31fe(0x1d7)](_0x2c60b9,_0x45934b,_0x5ed3e5){const _0x1dea9e=a59_0x3b31fe;if(!this[_0x1dea9e(0x242)]){console['warn'](_0x1dea9e(0x24f));return;}try{const _0x9d2cea=await database_1[_0x1dea9e(0x21f)][_0x1dea9e(0x26e)]['findMany']({'where':{'shopId':_0x2c60b9,'isVerified':!![]}});if(_0x9d2cea[_0x1dea9e(0x22a)]===0x0){console[_0x1dea9e(0x1d5)](_0x1dea9e(0x19e)+_0x2c60b9);return;}const _0x5c28c1=_0x9d2cea[_0x1dea9e(0x271)](async _0x4cf8f8=>{const _0x4c99f7=_0x1dea9e;try{await this[_0x4c99f7(0x242)]?.[_0x4c99f7(0x205)](_0x4cf8f8[_0x4c99f7(0x1c8)],_0x45934b,_0x5ed3e5),console[_0x4c99f7(0x1d5)](_0x4c99f7(0x26d)+_0x4cf8f8[_0x4c99f7(0x1c8)]);}catch(_0x2914fa){console[_0x4c99f7(0x22f)](_0x4c99f7(0x1b2)+_0x4cf8f8[_0x4c99f7(0x1c8)]+':',_0x2914fa),_0x2914fa instanceof Error&&(_0x2914fa[_0x4c99f7(0x23c)][_0x4c99f7(0x276)]('blocked')||_0x2914fa['message'][_0x4c99f7(0x276)](_0x4c99f7(0x25d))||_0x2914fa[_0x4c99f7(0x23c)][_0x4c99f7(0x276)](_0x4c99f7(0x1a7)))&&(await database_1[_0x4c99f7(0x21f)]['telegramUser'][_0x4c99f7(0x1a4)]({'where':{'id':_0x4cf8f8['id']},'data':{'isVerified':![]}}),console[_0x4c99f7(0x1d5)](_0x4c99f7(0x1ad)+_0x4cf8f8['telegramId']+'\x20marked\x20as\x20unverified\x20due\x20to\x20delivery\x20failure'));}});await Promise[_0x1dea9e(0x1f0)](_0x5c28c1);}catch(_0x4d8fe8){console['error']('Error\x20sending\x20shop\x20notification:',_0x4d8fe8);}}async[a59_0x3b31fe(0x201)](_0x2159c2,_0x4a10f4,_0x5eb79d){const _0x3bb6a2=a59_0x3b31fe,_0x318ebb={'created':'🆕','paid':'✅','failed':'❌','expired':'⏰','refund':'🔄','chargeback':'⚠️','processing':'⚙️'},_0x4ac0e0={'created':'New\x20payment\x20created','paid':_0x3bb6a2(0x279),'failed':_0x3bb6a2(0x232),'expired':_0x3bb6a2(0x1db),'refund':'Payment\x20refund','chargeback':_0x3bb6a2(0x1a3),'processing':'Payment\x20is\x20being\x20processed'},_0x55180f=_0x318ebb[_0x5eb79d],_0x354800=_0x4ac0e0[_0x5eb79d],_0x422dd5=(0x0,gateway_1['getGatewayDisplayNameForTelegram'])(_0x4a10f4['gateway']);console[_0x3bb6a2(0x1d5)]('📱\x20Telegram\x20notification:\x20gateway\x20\x22'+_0x4a10f4[_0x3bb6a2(0x21c)]+_0x3bb6a2(0x228)+_0x422dd5+'\x22');let _0xcf94cd=_0x55180f+'\x20*'+_0x354800+_0x3bb6a2(0x266)+(_0x3bb6a2(0x1dd)+_0x4a10f4[_0x3bb6a2(0x1a5)]+'\x20'+_0x4a10f4[_0x3bb6a2(0x1e4)]+'*\x0a')+('📝\x20Order\x20ID:\x20`'+(_0x4a10f4[_0x3bb6a2(0x25f)]||_0x4a10f4['id'])+'`\x0a')+('🆔\x20Payment\x20ID:\x20`'+_0x4a10f4['id']+'`\x0a')+('🏪\x20Gateway:\x20`'+_0x422dd5+'`\x0a')+('📅\x20Date:\x20'+new Date(_0x4a10f4[_0x3bb6a2(0x1eb)])['toLocaleString'](_0x3bb6a2(0x1fc))+'\x0a');if(_0x4a10f4['customerName']||_0x4a10f4[_0x3bb6a2(0x211)]||_0x4a10f4[_0x3bb6a2(0x259)]||_0x4a10f4[_0x3bb6a2(0x262)]||_0x4a10f4[_0x3bb6a2(0x19f)]){_0xcf94cd+=_0x3bb6a2(0x26f);_0x4a10f4['customerName']&&(_0xcf94cd+=_0x3bb6a2(0x258)+_0x4a10f4[_0x3bb6a2(0x260)]+'`\x0a');_0x4a10f4[_0x3bb6a2(0x211)]&&(_0xcf94cd+=_0x3bb6a2(0x209)+_0x4a10f4[_0x3bb6a2(0x211)]+'`\x0a');_0x4a10f4['remitterIban']&&(_0xcf94cd+=_0x3bb6a2(0x268)+_0x4a10f4[_0x3bb6a2(0x259)]+'`\x0a');_0x4a10f4['customerIp']&&(_0xcf94cd+='🌐\x20IP:\x20`'+_0x4a10f4[_0x3bb6a2(0x262)]+'`\x0a');if(_0x4a10f4['customerUa']){const _0x49d82b=_0x4a10f4[_0x3bb6a2(0x19f)]['length']>0x32?_0x4a10f4[_0x3bb6a2(0x19f)][_0x3bb6a2(0x22b)](0x0,0x32)+'...':_0x4a10f4[_0x3bb6a2(0x19f)];_0xcf94cd+=_0x3bb6a2(0x1cc)+_0x49d82b+'`\x0a';}}_0x5eb79d===_0x3bb6a2(0x21b)&&_0x4a10f4['chargebackAmount']&&(_0xcf94cd+=_0x3bb6a2(0x25c)+_0x4a10f4[_0x3bb6a2(0x1ae)]+_0x3bb6a2(0x274)),_0x5eb79d===_0x3bb6a2(0x230)&&(_0xcf94cd+='⏳\x20The\x20payment\x20is\x20currently\x20being\x20processed\x20by\x20the\x20gateway.\x0a'),_0x4a10f4[_0x3bb6a2(0x26c)]&&(_0xcf94cd+=_0x3bb6a2(0x1ed)+_0x4a10f4[_0x3bb6a2(0x26c)]+'\x0a'),await this[_0x3bb6a2(0x1d7)](_0x2159c2,_0xcf94cd,{'parse_mode':_0x3bb6a2(0x203)});}async['sendPayoutNotification'](_0x2b4cb3,_0x2d0994,_0x4dc1a4){const _0x594546=a59_0x3b31fe,_0x44e628={'created':'📤','completed':'✅','rejected':'❌'},_0x8060c4={'created':_0x594546(0x1a9),'completed':_0x594546(0x214),'rejected':_0x594546(0x218)},_0x2a3037=_0x44e628[_0x4dc1a4],_0x37e7cf=_0x8060c4[_0x4dc1a4],_0x2b222d=_0x2a3037+'\x20*'+_0x37e7cf+'*\x0a\x0a'+(_0x594546(0x1aa)+_0x2d0994['amount']+'\x20USD*\x0a')+(_0x594546(0x1e5)+_0x2d0994[_0x594546(0x24e)]+'`\x0a')+(_0x594546(0x1ef)+_0x2d0994['id']+'`\x0a')+('📅\x20Date:\x20'+new Date(_0x2d0994[_0x594546(0x1eb)])[_0x594546(0x23b)]('en-US')+'\x0a')+(_0x2d0994[_0x594546(0x241)]?_0x594546(0x238)+_0x2d0994[_0x594546(0x241)]+'`':'');await this[_0x594546(0x1d7)](_0x2b4cb3,_0x2b222d,{'parse_mode':_0x594546(0x203)});}async[a59_0x3b31fe(0x213)](_0x215da8,_0x578a3c){const _0x139942=a59_0x3b31fe;try{const _0x2f3b99=await database_1[_0x139942(0x21f)]['shopSettings'][_0x139942(0x254)]({'where':{'shopId':_0x215da8},'select':{'notificationLogin':!![]}});if(!_0x2f3b99?.[_0x139942(0x19d)]){console[_0x139942(0x1d5)](_0x139942(0x253)+_0x215da8);return;}const _0x15da5d=_0x578a3c[_0x139942(0x24a)]?'🔐':'🚨',_0x4ae950=_0x578a3c['success']?'Successful\x20login':_0x139942(0x20b);let _0x511372=_0x15da5d+'\x20*'+_0x4ae950+'*\x0a\x0a'+(_0x139942(0x226)+_0x578a3c['username']+'`\x0a')+('📅\x20Time:\x20'+_0x578a3c['timestamp'][_0x139942(0x23b)](_0x139942(0x1fc))+'\x0a');_0x578a3c[_0x139942(0x269)]&&(_0x511372+=_0x139942(0x251)+_0x578a3c[_0x139942(0x269)]+'`\x0a');if(_0x578a3c[_0x139942(0x221)]){const _0x5895ea=_0x578a3c[_0x139942(0x221)]['length']>0x32?_0x578a3c['userAgent'][_0x139942(0x22b)](0x0,0x32)+_0x139942(0x23a):_0x578a3c[_0x139942(0x221)];_0x511372+=_0x139942(0x1cc)+_0x5895ea+'`\x0a';}!_0x578a3c[_0x139942(0x24a)]&&(_0x511372+='\x0a⚠️\x20If\x20this\x20wasn\x27t\x20you,\x20change\x20your\x20password\x20immediately!'),await this[_0x139942(0x1d7)](_0x215da8,_0x511372,{'parse_mode':'Markdown'}),console[_0x139942(0x1d5)](_0x139942(0x236)+_0x215da8+':\x20'+(_0x578a3c['success']?'success':_0x139942(0x217)));}catch(_0x3f2eee){console[_0x139942(0x22f)]('Failed\x20to\x20send\x20login\x20notification:',_0x3f2eee);}}async[a59_0x3b31fe(0x1bc)](_0x2e650c,_0x4e5b51){const _0x453aa7=a59_0x3b31fe;try{const _0x2d4088=await database_1[_0x453aa7(0x21f)][_0x453aa7(0x1cd)]['findUnique']({'where':{'shopId':_0x2e650c},'select':{'notificationApiError':!![]}});if(!_0x2d4088?.[_0x453aa7(0x273)]){console[_0x453aa7(0x1d5)]('📱\x20API\x20error\x20notifications\x20disabled\x20for\x20shop\x20'+_0x2e650c);return;}let _0x426af8=_0x453aa7(0x249)+(_0x453aa7(0x20e)+_0x4e5b51[_0x453aa7(0x24e)]+'\x20'+_0x4e5b51[_0x453aa7(0x243)]+'`\x0a')+('📅\x20Time:\x20'+_0x4e5b51[_0x453aa7(0x267)][_0x453aa7(0x23b)](_0x453aa7(0x1fc))+'\x0a');_0x4e5b51[_0x453aa7(0x26a)]&&(_0x426af8+=_0x453aa7(0x1a2)+_0x4e5b51[_0x453aa7(0x26a)]+'`\x0a'),_0x426af8+=_0x453aa7(0x1cf)+_0x4e5b51[_0x453aa7(0x1b9)]+'`\x0a',_0x4e5b51['requestId']&&(_0x426af8+=_0x453aa7(0x1c7)+_0x4e5b51[_0x453aa7(0x231)]+'`\x0a'),_0x426af8+=_0x453aa7(0x277),await this['sendShopNotification'](_0x2e650c,_0x426af8,{'parse_mode':_0x453aa7(0x203)}),console['log']('✅\x20API\x20error\x20notification\x20sent\x20for\x20shop\x20'+_0x2e650c+':\x20'+_0x4e5b51[_0x453aa7(0x243)]);}catch(_0x24d0fb){console[_0x453aa7(0x22f)]('Failed\x20to\x20send\x20API\x20error\x20notification:',_0x24d0fb);}}async['sendCustomNotification'](_0x4fcc04,_0x6e9cb3,_0x5a1050){const _0x1af47b=a59_0x3b31fe;let _0x39e81a=_0x1af47b(0x1bd)+_0x6e9cb3+_0x1af47b(0x266);for(const [_0x3ef911,_0xca4d23]of Object[_0x1af47b(0x240)](_0x5a1050)){_0xca4d23!==null&&_0xca4d23!==undefined&&(_0x39e81a+=_0x3ef911+':\x20`'+_0xca4d23+'`\x0a');}await this['sendShopNotification'](_0x4fcc04,_0x39e81a,{'parse_mode':_0x1af47b(0x203)});}[a59_0x3b31fe(0x22c)](){const _0x4da78d=a59_0x3b31fe;return{'isActive':!!this[_0x4da78d(0x242)],'username':this[_0x4da78d(0x1a6)]};}[a59_0x3b31fe(0x235)](){const _0x1cb203=a59_0x3b31fe;this['bot']&&(this['bot']['stopPolling'](),this[_0x1cb203(0x242)]=null,console[_0x1cb203(0x1d5)]('🛑\x20Telegram\x20bot\x20stopped'));}}exports[a59_0x3b31fe(0x1ff)]=TelegramBotService,exports[a59_0x3b31fe(0x1b0)]=new TelegramBotService();