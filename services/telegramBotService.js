'use strict';const a54_0xe1cca7=a54_0x2aa9;(function(_0x51a3fb,_0x2e6e04){const _0x4f328b=a54_0x2aa9,_0x251cfd=_0x51a3fb();while(!![]){try{const _0x1d177d=parseInt(_0x4f328b(0x1bf))/0x1*(parseInt(_0x4f328b(0x1ab))/0x2)+-parseInt(_0x4f328b(0x1e0))/0x3+parseInt(_0x4f328b(0x1aa))/0x4*(parseInt(_0x4f328b(0x203))/0x5)+parseInt(_0x4f328b(0x152))/0x6+parseInt(_0x4f328b(0x1d1))/0x7*(-parseInt(_0x4f328b(0x20c))/0x8)+-parseInt(_0x4f328b(0x151))/0x9*(-parseInt(_0x4f328b(0x1a4))/0xa)+parseInt(_0x4f328b(0x148))/0xb;if(_0x1d177d===_0x2e6e04)break;else _0x251cfd['push'](_0x251cfd['shift']());}catch(_0x29415a){_0x251cfd['push'](_0x251cfd['shift']());}}}(a54_0xc1fa,0x28012));var __importDefault=this&&this[a54_0xe1cca7(0x17d)]||function(_0x4638da){const _0x3c0594=a54_0xe1cca7;return _0x4638da&&_0x4638da[_0x3c0594(0x15d)]?_0x4638da:{'default':_0x4638da};};function a54_0xc1fa(){const _0x49a7cb=['❌\x20Invalid\x20API\x20key\x20format.\x0a\x0a',':\x20`','findMany','botUsername','default','sendMessage','Contact\x20administrator.','💸\x20Amount:\x20*','shopId','\x20via\x20single-line\x20input','✅\x20Welcome\x20back!\x0a\x0a','15FQCRpU','🔔\x20You\x20will\x20now\x20receive\x20notifications\x20about:\x0a','notificationApiError','🏪\x20Gateway:\x20`','publicKey','❌\x20Error\x20getting\x20debug\x20information.','status','chargeback','bankId','982768kIelgg','startsWith','last_name','🚨\x20*API\x20Error*\x0a\x0a','Telegram\x20bot\x20polling\x20error:','🆔\x20Request\x20ID:\x20`','split','Username\x20must\x20contain\x20only\x20letters,\x20numbers\x20and\x20underscore\x20(3-50\x20characters).','Check\x20spelling\x20and\x20try\x20again.','getGatewayDisplayNameForTelegram','📱\x20API\x20error\x20notifications\x20disabled\x20for\x20shop\x20','sendShopNotification','🗺️\x20Country:\x20`','`\x20is\x20inactive.\x0a\x0a','✅\x20You\x20have\x20been\x20successfully\x20connected\x20to\x20the\x20notification\x20system!\x0a\x0a','error','...`\x0a\x0a','createdAt','name','\x20disconnected\x20from\x20shop\x20','allSettled','\x20\x20\x20Status:\x20','customerCountry','❌\x20Error:\x20`','blocked','Payout\x20rejected','🔔\x20Notifications\x20are\x20active\x0a\x0a','customerEmail','Error\x20in\x20handleSingleLineVerification:','•\x20`','entries','Commands:\x0a','\x22\x20->\x20display\x20\x22','🔍\x20*Debug\x20Information*\x0a\x0a','TelegramBotService','Failed\x20to\x20send\x20login\x20notification:','📅\x20Connection\x20date:\x20','❌\x20An\x20error\x20occurred.\x20Please\x20try\x20again\x20later.','processing','shop','statusCode','toLocaleString','`\x20(','text','❗️\x20Make\x20sure\x20to\x20separate\x20username\x20and\x20API\x20key\x20with\x20a\x20space!','🆔\x20Payment\x20ID:\x20`','❌\x20Shop\x20with\x20username\x20`','\x20\x20\x20Public\x20Key:\x20`','152592ymbLfQ','🔗\x20Endpoint:\x20`','success','Use\x20/start\x20to\x20connect.','en-US','adminNotes','ipAddress','📝\x20Notes:\x20','chargebackAmount','729XVfvoN','1058118PslKUd','To\x20reconnect,\x20use\x20the\x20/start\x20command','`appple\x20pk_aa6450d3f57afbefbb0f3f5be5ce6cca13037536afc5ccf14c81a6cbc7a07de5`\x0a\x0a','paymentMethod','✅\x20API\x20error\x20notification\x20sent\x20for\x20shop\x20','🔄\x20Processing\x20single-line\x20verification\x20for\x20user\x20',':\x20username=\x22','`\x0a\x0a','test','create','timestamp','__esModule','../config/database','Payment\x20failed','stopBot','username','✅\x20Telegram\x20user\x20','updatedAt','shopSettings','getBotInfo','✅\x20You\x20are\x20already\x20connected\x20to\x20shop\x20*','gateway','\x0a💡\x20Check\x20your\x20request\x20or\x20contact\x20support.','Failed\x20login\x20attempt','🎉\x20*Congratulations!*\x0a\x0a','userAgent','sk_','ACTIVE','\x20parts:\x20','txid','TELEGRAM_BOT_TOKEN','•\x20Payouts\x0a\x0a','findUnique','👤\x20Username:\x20`','initializeBot','•\x20Important\x20events\x0a\x0a','🏦\x20Method:\x20`','telegramUser','\x20USD*\x0a','🔔\x20*','substring','•\x20Payment\x20status\x20changes\x0a','❌\x20Shop\x20`','__importDefault','isVerified','❌\x20Failed\x20to\x20send\x20notification\x20to\x20Telegram\x20user\x20','🔔\x20You\x20receive\x20notifications\x20about:\x0a','remitterName','You\x20sent\x20','📱\x20Login\x20notifications\x20disabled\x20for\x20shop\x20','❌\x20API\x20key\x20does\x20not\x20match\x20shop\x20`','endpoint','✅\x20Login\x20notification\x20sent\x20for\x20shop\x20','customerIp','Use\x20/status\x20to\x20check\x20status\x20or\x20/disconnect\x20to\x20disconnect.','telegramId','message','✅\x20You\x20have\x20been\x20successfully\x20disconnected\x20from\x20shop\x20*','📊\x20Error\x20code:\x20`','\x20initialized\x20successfully','\x20USDT*\x0a','\x0aCheck\x20spelling\x20and\x20try\x20again.','📱\x20Telegram\x20notification:\x20gateway\x20\x22','failed','\x0a💳\x20*Payment\x20Details:*\x0a','Error\x20sending\x20shop\x20notification:','User\x20','Successful\x20login','📅\x20Time:\x20','errorMessage','🌐\x20IP:\x20`','Error\x20handling\x20/start\x20command:','Example:\x0a','⏳\x20The\x20payment\x20is\x20currently\x20being\x20processed\x20by\x20the\x20gateway.\x0a','💰\x20Amount:\x20*','onText','❌\x20You\x20are\x20not\x20connected\x20to\x20a\x20shop.\x0a\x0a','Payment\x20expired','\x20verified\x20for\x20shop\x20','Markdown','update','/disconnect\x20-\x20disconnect\x20from\x20notifications','2020sKWDEH','botToken','/status\x20-\x20check\x20connection\x20status\x0a','sendPayoutNotification','📝\x20Format:\x20`username\x20api_key`\x0a\x0a','API\x20key\x20must\x20start\x20with\x20`pk\x5c_`\x20or\x20`sk\x5c_`.','260860QPyVKp','2nLmaiR','toLocaleDateString','Error\x20handling\x20/status\x20command:','🤖\x20Welcome\x20to\x20TRAPAY\x20notification\x20system!\x0a\x0a','📅\x20Date:\x20','*.\x0a\x0a','orderId','sendApiErrorNotification','...','Username:\x20`','\x0a⚠️\x20If\x20this\x20wasn\x27t\x20you,\x20change\x20your\x20password\x20immediately!','🔌\x20User\x20','\x20\x20\x20Username:\x20`','includes','Telegram\x20bot\x20not\x20initialized,\x20cannot\x20send\x20notification','❌\x20You\x20are\x20not\x20registered\x20in\x20the\x20system.\x0a\x0a','telegramBotService','requestId','📊\x20*Connection\x20Status*\x0a\x0a','currency','125082sIqXOe','setupBotHandlers','chat','❌\x20Invalid\x20format.\x20Please\x20send\x20exactly\x202\x20parts\x20separated\x20by\x20space:\x0a\x0a','📱\x20Shop:\x20*','log','toString','trapay_bot','polling_error','`.\x0a\x0a','🆔\x20Payout\x20ID:\x20`','Available\x20usernames:\x0a','TELEGRAM_BOT_TOKEN\x20not\x20found\x20in\x20environment\x20variables','🔄\x20Reset\x20incomplete\x20verification\x20for\x20user\x20','❌\x20You\x20are\x20not\x20connected\x20to\x20the\x20notification\x20system.','💻\x20Browser:\x20`','amount','🔗\x20TXID:\x20`','7pagNAA','❌\x20Another\x20Telegram\x20account\x20is\x20already\x20connected\x20to\x20shop\x20`','from','Payment\x20is\x20being\x20processed','Check\x20the\x20key\x20and\x20try\x20again.\x0a\x0a','env','Use\x20/start\x20to\x20begin.','handleSingleLineVerification','🌐\x20IP\x20address:\x20`','customerName','remitterIban','*\x0a\x0a','Error\x20handling\x20message:','🏦\x20IBAN:\x20`','cardLast4','721830AbQtOx','sendPaymentNotification','bot','node-telegram-bot-api','join','.\x20*','Error\x20handling\x20/debug\x20command:','defineProperty','length','✅\x20Connected\x20to\x20shop:\x20*','method','No\x20verified\x20Telegram\x20users\x20found\x20for\x20shop\x20','warn','map','chat\x20not\x20found','TELEGRAM_BOT_USERNAME','💸\x20Penalty\x20amount:\x20*','trim','🏪\x20Available\x20shops\x20in\x20system:\x0a','❌\x20Please\x20use\x20/start\x20command\x20first','Payout\x20completed','user\x20is\x20deactivated','✅\x20Notification\x20sent\x20to\x20Telegram\x20user\x20','❌\x20Failed\x20to\x20initialize\x20Telegram\x20bot:'];a54_0xc1fa=function(){return _0x49a7cb;};return a54_0xc1fa();}Object[a54_0xe1cca7(0x1e7)](exports,a54_0xe1cca7(0x15d),{'value':!![]}),exports[a54_0xe1cca7(0x1bb)]=exports[a54_0xe1cca7(0x13a)]=void 0x0;const node_telegram_bot_api_1=__importDefault(require(a54_0xe1cca7(0x1e3))),database_1=__importDefault(require(a54_0xe1cca7(0x15e))),gateway_1=require('../types/gateway');function a54_0x2aa9(_0x469b06,_0x117466){const _0xc1fa7=a54_0xc1fa();return a54_0x2aa9=function(_0x2aa9d3,_0x26776d){_0x2aa9d3=_0x2aa9d3-0x13a;let _0x3b4037=_0xc1fa7[_0x2aa9d3];return _0x3b4037;},a54_0x2aa9(_0x469b06,_0x117466);}class TelegramBotService{constructor(){const _0x2edc98=a54_0xe1cca7;this[_0x2edc98(0x1e2)]=null,this['botToken']=process[_0x2edc98(0x1d6)][_0x2edc98(0x170)]||'',this[_0x2edc98(0x1fb)]=process[_0x2edc98(0x1d6)][_0x2edc98(0x1ef)]||_0x2edc98(0x1c6),this[_0x2edc98(0x1a5)]?this['initializeBot']():console[_0x2edc98(0x1ec)](_0x2edc98(0x1cb));}[a54_0xe1cca7(0x174)](){const _0x32589e=a54_0xe1cca7;try{this['bot']=new node_telegram_bot_api_1[(_0x32589e(0x1fc))](this[_0x32589e(0x1a5)],{'polling':!![]}),this[_0x32589e(0x1c0)](),console[_0x32589e(0x1c4)]('✅\x20Telegram\x20bot\x20@'+this[_0x32589e(0x1fb)]+_0x32589e(0x18d));}catch(_0x3c3bde){console['error'](_0x32589e(0x1f7),_0x3c3bde);}}[a54_0xe1cca7(0x1c0)](){const _0x2e4851=a54_0xe1cca7;if(!this[_0x2e4851(0x1e2)])return;this[_0x2e4851(0x1e2)][_0x2e4851(0x19d)](/\/start/,async _0x391a4c=>{const _0x1deb7d=_0x2e4851,_0x44e3d9=_0x391a4c[_0x1deb7d(0x1c1)]['id'],_0x5a2fbe=_0x391a4c[_0x1deb7d(0x1d3)]?.['id'][_0x1deb7d(0x1c5)](),_0x1152e3=_0x391a4c['from']?.[_0x1deb7d(0x161)],_0x252796=_0x391a4c[_0x1deb7d(0x1d3)]?.['first_name'],_0x4117aa=_0x391a4c['from']?.[_0x1deb7d(0x20e)];if(!_0x5a2fbe)return;try{let _0x64ee76=await database_1['default']['telegramUser'][_0x1deb7d(0x172)]({'where':{'telegramId':_0x5a2fbe},'include':{'shop':!![]}});!_0x64ee76?(_0x64ee76=await database_1[_0x1deb7d(0x1fc)][_0x1deb7d(0x177)][_0x1deb7d(0x15b)]({'data':{'telegramId':_0x5a2fbe,'username':_0x1152e3,'firstName':_0x252796,'lastName':_0x4117aa,'isVerified':![],'shopId':null},'include':{'shop':!![]}}),console['log']('📱\x20Created\x20new\x20Telegram\x20user:\x20'+_0x5a2fbe+'\x20(@'+_0x1152e3+')')):_0x64ee76=await database_1[_0x1deb7d(0x1fc)][_0x1deb7d(0x177)][_0x1deb7d(0x1a2)]({'where':{'telegramId':_0x5a2fbe},'data':{'username':_0x1152e3,'firstName':_0x252796,'lastName':_0x4117aa},'include':{'shop':!![]}}),_0x64ee76['isVerified']&&_0x64ee76[_0x1deb7d(0x200)]&&_0x64ee76[_0x1deb7d(0x13f)]?await this[_0x1deb7d(0x1e2)]?.['sendMessage'](_0x44e3d9,_0x1deb7d(0x202)+('You\x20are\x20already\x20connected\x20to\x20shop:\x20*'+_0x64ee76['shop'][_0x1deb7d(0x21e)]+'*\x0a')+(_0x1deb7d(0x1b4)+_0x64ee76[_0x1deb7d(0x13f)][_0x1deb7d(0x161)]+_0x1deb7d(0x159))+_0x1deb7d(0x180)+'•\x20New\x20payments\x0a'+_0x1deb7d(0x17b)+_0x1deb7d(0x171)+'Commands:\x0a'+_0x1deb7d(0x1a6)+_0x1deb7d(0x1a3),{'parse_mode':_0x1deb7d(0x1a1)}):(_0x64ee76[_0x1deb7d(0x200)]&&!_0x64ee76[_0x1deb7d(0x17e)]&&(await database_1['default']['telegramUser'][_0x1deb7d(0x1a2)]({'where':{'telegramId':_0x5a2fbe},'data':{'shopId':null,'isVerified':![]}}),console['log'](_0x1deb7d(0x1cc)+_0x5a2fbe)),await this[_0x1deb7d(0x1e2)]?.[_0x1deb7d(0x1fd)](_0x44e3d9,_0x1deb7d(0x1ae)+'To\x20receive\x20payment\x20notifications,\x20send\x20your\x20credentials\x20in\x20one\x20line:\x0a\x0a'+_0x1deb7d(0x1a8)+_0x1deb7d(0x19a)+'`appple\x20pk_aa6450d3f57afbefbb0f3f5be5ce6cca13037536afc5ccf14c81a6cbc7a07de5`\x0a\x0a'+_0x1deb7d(0x144),{'parse_mode':_0x1deb7d(0x1a1)}));}catch(_0x10325c){console[_0x1deb7d(0x21b)](_0x1deb7d(0x199),_0x10325c),await this[_0x1deb7d(0x1e2)]?.[_0x1deb7d(0x1fd)](_0x44e3d9,_0x1deb7d(0x13d));}}),this[_0x2e4851(0x1e2)][_0x2e4851(0x19d)](/\/disconnect/,async _0x54dedd=>{const _0x113e29=_0x2e4851,_0x5eabbf=_0x54dedd[_0x113e29(0x1c1)]['id'],_0x1301d2=_0x54dedd[_0x113e29(0x1d3)]?.['id'][_0x113e29(0x1c5)]();if(!_0x1301d2)return;try{const _0x1d6466=await database_1[_0x113e29(0x1fc)]['telegramUser'][_0x113e29(0x172)]({'where':{'telegramId':_0x1301d2},'include':{'shop':!![]}});if(!_0x1d6466||!_0x1d6466[_0x113e29(0x17e)]||!_0x1d6466[_0x113e29(0x200)]){await this[_0x113e29(0x1e2)]?.['sendMessage'](_0x5eabbf,_0x113e29(0x1cd));return;}const _0x5b75fb=_0x1d6466[_0x113e29(0x13f)]?.[_0x113e29(0x21e)]||'unknown\x20shop';await database_1['default'][_0x113e29(0x177)][_0x113e29(0x1a2)]({'where':{'telegramId':_0x1301d2},'data':{'shopId':null,'isVerified':![]}}),console[_0x113e29(0x1c4)](_0x113e29(0x1b6)+_0x1301d2+_0x113e29(0x21f)+_0x1d6466[_0x113e29(0x200)]),await this[_0x113e29(0x1e2)]?.[_0x113e29(0x1fd)](_0x5eabbf,_0x113e29(0x18b)+_0x5b75fb+_0x113e29(0x1b0)+_0x113e29(0x153),{'parse_mode':_0x113e29(0x1a1)});}catch(_0x8d945e){console[_0x113e29(0x21b)]('Error\x20handling\x20/disconnect\x20command:',_0x8d945e),await this[_0x113e29(0x1e2)]?.[_0x113e29(0x1fd)](_0x5eabbf,_0x113e29(0x13d));}}),this[_0x2e4851(0x1e2)]['onText'](/\/status/,async _0x563fd0=>{const _0xda4ba6=_0x2e4851,_0x5cd036=_0x563fd0[_0xda4ba6(0x1c1)]['id'],_0x1abae8=_0x563fd0['from']?.['id']['toString']();if(!_0x1abae8)return;try{const _0x5e83e8=await database_1[_0xda4ba6(0x1fc)]['telegramUser'][_0xda4ba6(0x172)]({'where':{'telegramId':_0x1abae8},'include':{'shop':!![]}});if(!_0x5e83e8){await this[_0xda4ba6(0x1e2)]?.[_0xda4ba6(0x1fd)](_0x5cd036,_0xda4ba6(0x1ba)+_0xda4ba6(0x1d7));return;}if(!_0x5e83e8[_0xda4ba6(0x17e)]||!_0x5e83e8[_0xda4ba6(0x200)]||!_0x5e83e8[_0xda4ba6(0x13f)]){await this[_0xda4ba6(0x1e2)]?.[_0xda4ba6(0x1fd)](_0x5cd036,_0xda4ba6(0x19e)+_0xda4ba6(0x14b));return;}await this[_0xda4ba6(0x1e2)]?.['sendMessage'](_0x5cd036,_0xda4ba6(0x1bd)+(_0xda4ba6(0x1e9)+_0x5e83e8[_0xda4ba6(0x13f)][_0xda4ba6(0x21e)]+'*\x0a')+('👤\x20Username:\x20`'+_0x5e83e8[_0xda4ba6(0x13f)][_0xda4ba6(0x161)]+'`\x0a')+(_0xda4ba6(0x13c)+_0x5e83e8[_0xda4ba6(0x163)][_0xda4ba6(0x1ac)](_0xda4ba6(0x14c))+'\x0a\x0a')+_0xda4ba6(0x226)+_0xda4ba6(0x22b)+_0xda4ba6(0x1a3),{'parse_mode':_0xda4ba6(0x1a1)});}catch(_0x226147){console['error'](_0xda4ba6(0x1ad),_0x226147),await this['bot']?.[_0xda4ba6(0x1fd)](_0x5cd036,_0xda4ba6(0x13d));}}),this[_0x2e4851(0x1e2)]['onText'](/\/debug/,async _0x1d8e98=>{const _0xe67d7a=_0x2e4851,_0x3f95a8=_0x1d8e98['chat']['id'],_0x2608ef=_0x1d8e98[_0xe67d7a(0x1d3)]?.['id']['toString']();if(!_0x2608ef)return;try{const _0x5b8b1f=await database_1['default']['shop'][_0xe67d7a(0x1fa)]({'select':{'id':!![],'name':!![],'username':!![],'status':!![],'publicKey':!![]},'take':0xa});let _0x1d6122=_0xe67d7a(0x22d);_0x1d6122+='📱\x20Your\x20Telegram\x20ID:\x20`'+_0x2608ef+'`\x0a\x0a',_0x1d6122+=_0xe67d7a(0x1f2),_0x5b8b1f['forEach']((_0x52fc35,_0x5522f1)=>{const _0x1a94e5=_0xe67d7a;_0x1d6122+=_0x5522f1+0x1+_0x1a94e5(0x1e5)+_0x52fc35[_0x1a94e5(0x21e)]+'*\x0a',_0x1d6122+=_0x1a94e5(0x1b7)+_0x52fc35[_0x1a94e5(0x161)]+'`\x0a',_0x1d6122+=_0x1a94e5(0x221)+_0x52fc35[_0x1a94e5(0x209)]+'\x0a',_0x1d6122+=_0x1a94e5(0x147)+_0x52fc35[_0x1a94e5(0x207)][_0x1a94e5(0x17a)](0x0,0xf)+_0x1a94e5(0x21c);}),await this['bot']?.[_0xe67d7a(0x1fd)](_0x3f95a8,_0x1d6122,{'parse_mode':_0xe67d7a(0x1a1)});}catch(_0x59d7d6){console['error'](_0xe67d7a(0x1e6),_0x59d7d6),await this[_0xe67d7a(0x1e2)]?.['sendMessage'](_0x3f95a8,_0xe67d7a(0x208));}}),this[_0x2e4851(0x1e2)]['on']('message',async _0x4dfddb=>{const _0x257b06=_0x2e4851;if(_0x4dfddb[_0x257b06(0x143)]?.['startsWith']('/'))return;const _0x1db7dc=_0x4dfddb[_0x257b06(0x1c1)]['id'],_0x2479d7=_0x4dfddb[_0x257b06(0x1d3)]?.['id'][_0x257b06(0x1c5)](),_0x2ed5ec=_0x4dfddb[_0x257b06(0x143)]?.[_0x257b06(0x1f1)]();if(!_0x2479d7||!_0x2ed5ec)return;try{const _0x441120=await database_1[_0x257b06(0x1fc)]['telegramUser'][_0x257b06(0x172)]({'where':{'telegramId':_0x2479d7},'include':{'shop':!![]}});if(!_0x441120){await this[_0x257b06(0x1e2)]?.[_0x257b06(0x1fd)](_0x1db7dc,_0x257b06(0x1f3));return;}if(_0x441120['isVerified']&&_0x441120[_0x257b06(0x200)]&&_0x441120[_0x257b06(0x13f)]){await this[_0x257b06(0x1e2)]?.[_0x257b06(0x1fd)](_0x1db7dc,_0x257b06(0x166)+_0x441120[_0x257b06(0x13f)][_0x257b06(0x21e)]+_0x257b06(0x1b0)+_0x257b06(0x188),{'parse_mode':_0x257b06(0x1a1)});return;}const _0x4b5114=_0x2ed5ec[_0x257b06(0x212)](/\s+/);if(_0x4b5114[_0x257b06(0x1e8)]!==0x2){await this[_0x257b06(0x1e2)]?.['sendMessage'](_0x1db7dc,_0x257b06(0x1c2)+'📝\x20Format:\x20`username\x20api_key`\x0a\x0a'+'Example:\x0a'+_0x257b06(0x154)+(_0x257b06(0x182)+_0x4b5114[_0x257b06(0x1e8)]+_0x257b06(0x16e)+_0x4b5114['map'](_0x53a65c=>'`'+_0x53a65c+'`')[_0x257b06(0x1e4)](',\x20')),{'parse_mode':_0x257b06(0x1a1)});return;}const [_0x119fc8,_0x2d6c1f]=_0x4b5114;console[_0x257b06(0x1c4)](_0x257b06(0x157)+_0x2479d7+_0x257b06(0x158)+_0x119fc8+'\x22,\x20apiKey=\x22'+_0x2d6c1f[_0x257b06(0x17a)](0x0,0xa)+'...\x22'),await this[_0x257b06(0x1d8)](_0x1db7dc,_0x2479d7,_0x119fc8,_0x2d6c1f);}catch(_0x14a734){console['error'](_0x257b06(0x1dd),_0x14a734),await this['bot']?.[_0x257b06(0x1fd)](_0x1db7dc,_0x257b06(0x13d));}}),this[_0x2e4851(0x1e2)]['on'](_0x2e4851(0x21b),_0x5ce8ed=>{const _0x5aa78a=_0x2e4851;console[_0x5aa78a(0x21b)]('Telegram\x20bot\x20error:',_0x5ce8ed);}),this[_0x2e4851(0x1e2)]['on'](_0x2e4851(0x1c7),_0x1338aa=>{const _0x15a438=_0x2e4851;console[_0x15a438(0x21b)](_0x15a438(0x210),_0x1338aa);});}async[a54_0xe1cca7(0x1d8)](_0x516bef,_0x24016a,_0x2db917,_0x1c2886){const _0x2061dd=a54_0xe1cca7;try{console[_0x2061dd(0x1c4)](_0x2061dd(0x157)+_0x24016a+_0x2061dd(0x158)+_0x2db917+'\x22,\x20apiKey=\x22'+_0x1c2886[_0x2061dd(0x17a)](0x0,0xa)+'...\x22');if(!_0x2db917||_0x2db917[_0x2061dd(0x1e8)]<0x3||_0x2db917[_0x2061dd(0x1e8)]>0x32||!/^[a-zA-Z0-9_]+$/[_0x2061dd(0x15a)](_0x2db917)){await this[_0x2061dd(0x1e2)]?.['sendMessage'](_0x516bef,'❌\x20Invalid\x20username\x20format:\x20`'+_0x2db917+_0x2061dd(0x159)+_0x2061dd(0x213),{'parse_mode':_0x2061dd(0x1a1)});return;}if(!_0x1c2886||!_0x1c2886[_0x2061dd(0x20d)]('pk_')&&!_0x1c2886['startsWith'](_0x2061dd(0x16c))){await this[_0x2061dd(0x1e2)]?.['sendMessage'](_0x516bef,_0x2061dd(0x1f8)+_0x2061dd(0x1a9),{'parse_mode':_0x2061dd(0x1a1)});return;}const _0x94130e=await database_1[_0x2061dd(0x1fc)][_0x2061dd(0x13f)][_0x2061dd(0x172)]({'where':{'username':_0x2db917},'select':{'id':!![],'name':!![],'username':!![],'status':!![],'publicKey':!![],'secretKey':!![]}});if(!_0x94130e){const _0x4a08bb=await database_1[_0x2061dd(0x1fc)][_0x2061dd(0x13f)][_0x2061dd(0x1fa)]({'select':{'username':!![],'name':!![]},'take':0x5});let _0x138d6b=_0x2061dd(0x146)+_0x2db917+'`\x20not\x20found.\x0a\x0a';_0x4a08bb[_0x2061dd(0x1e8)]>0x0?(_0x138d6b+=_0x2061dd(0x1ca),_0x4a08bb['forEach'](_0x2ed9ff=>{const _0x58635e=_0x2061dd;_0x138d6b+=_0x58635e(0x229)+_0x2ed9ff[_0x58635e(0x161)]+_0x58635e(0x142)+_0x2ed9ff[_0x58635e(0x21e)]+')\x0a';}),_0x138d6b+=_0x2061dd(0x18f)):_0x138d6b+=_0x2061dd(0x214);await this[_0x2061dd(0x1e2)]?.[_0x2061dd(0x1fd)](_0x516bef,_0x138d6b,{'parse_mode':_0x2061dd(0x1a1)});return;}if(_0x94130e[_0x2061dd(0x209)]!==_0x2061dd(0x16d)){await this[_0x2061dd(0x1e2)]?.[_0x2061dd(0x1fd)](_0x516bef,_0x2061dd(0x17c)+_0x2db917+_0x2061dd(0x219)+_0x2061dd(0x1fe),{'parse_mode':_0x2061dd(0x1a1)});return;}if(_0x94130e[_0x2061dd(0x207)]!==_0x1c2886&&_0x94130e['secretKey']!==_0x1c2886){await this[_0x2061dd(0x1e2)]?.['sendMessage'](_0x516bef,_0x2061dd(0x184)+_0x2db917+_0x2061dd(0x1c8)+_0x2061dd(0x1d5)+'Expected\x20key\x20format:\x20`pk_...`\x20or\x20`sk_...`',{'parse_mode':'Markdown'});return;}const _0xe273ec=await database_1['default'][_0x2061dd(0x177)]['findFirst']({'where':{'shopId':_0x94130e['id'],'isVerified':!![],'telegramId':{'not':_0x24016a}}});if(_0xe273ec){await this[_0x2061dd(0x1e2)]?.[_0x2061dd(0x1fd)](_0x516bef,_0x2061dd(0x1d2)+_0x2db917+'`.\x0a\x0a'+'Disconnect\x20the\x20previous\x20account\x20first\x20or\x20contact\x20administrator.',{'parse_mode':_0x2061dd(0x1a1)});return;}await database_1[_0x2061dd(0x1fc)][_0x2061dd(0x177)]['update']({'where':{'telegramId':_0x24016a},'data':{'shopId':_0x94130e['id'],'isVerified':!![]}}),await this[_0x2061dd(0x1e2)]?.[_0x2061dd(0x1fd)](_0x516bef,_0x2061dd(0x16a)+_0x2061dd(0x21a)+(_0x2061dd(0x1c3)+_0x94130e[_0x2061dd(0x21e)]+'*\x0a')+(_0x2061dd(0x173)+_0x94130e['username']+_0x2061dd(0x159))+_0x2061dd(0x204)+'•\x20New\x20payments\x0a'+_0x2061dd(0x17b)+'•\x20Payouts\x0a'+_0x2061dd(0x175)+_0x2061dd(0x22b)+_0x2061dd(0x1a6)+_0x2061dd(0x1a3),{'parse_mode':'Markdown'}),console[_0x2061dd(0x1c4)](_0x2061dd(0x162)+_0x24016a+_0x2061dd(0x1a0)+_0x94130e[_0x2061dd(0x161)]+_0x2061dd(0x201));}catch(_0x58157b){console['error'](_0x2061dd(0x228),_0x58157b),await this[_0x2061dd(0x1e2)]?.[_0x2061dd(0x1fd)](_0x516bef,'❌\x20An\x20error\x20occurred\x20while\x20verifying\x20data.');}}async[a54_0xe1cca7(0x217)](_0x4127db,_0x38fb1b,_0xe75ba0){const _0xcf5c60=a54_0xe1cca7;if(!this[_0xcf5c60(0x1e2)]){console['warn'](_0xcf5c60(0x1b9));return;}try{const _0x2d3121=await database_1[_0xcf5c60(0x1fc)][_0xcf5c60(0x177)][_0xcf5c60(0x1fa)]({'where':{'shopId':_0x4127db,'isVerified':!![]}});if(_0x2d3121[_0xcf5c60(0x1e8)]===0x0){console[_0xcf5c60(0x1c4)](_0xcf5c60(0x1eb)+_0x4127db);return;}const _0x494980=_0x2d3121[_0xcf5c60(0x1ed)](async _0x2c65aa=>{const _0x172023=_0xcf5c60;try{await this['bot']?.[_0x172023(0x1fd)](_0x2c65aa[_0x172023(0x189)],_0x38fb1b,_0xe75ba0),console[_0x172023(0x1c4)](_0x172023(0x1f6)+_0x2c65aa[_0x172023(0x189)]);}catch(_0x2c8aa9){console[_0x172023(0x21b)](_0x172023(0x17f)+_0x2c65aa['telegramId']+':',_0x2c8aa9),_0x2c8aa9 instanceof Error&&(_0x2c8aa9['message']['includes'](_0x172023(0x224))||_0x2c8aa9[_0x172023(0x18a)][_0x172023(0x1b8)](_0x172023(0x1ee))||_0x2c8aa9[_0x172023(0x18a)]['includes'](_0x172023(0x1f5)))&&(await database_1[_0x172023(0x1fc)]['telegramUser'][_0x172023(0x1a2)]({'where':{'id':_0x2c65aa['id']},'data':{'isVerified':![]}}),console[_0x172023(0x1c4)](_0x172023(0x194)+_0x2c65aa[_0x172023(0x189)]+'\x20marked\x20as\x20unverified\x20due\x20to\x20delivery\x20failure'));}});await Promise[_0xcf5c60(0x220)](_0x494980);}catch(_0x38af48){console['error'](_0xcf5c60(0x193),_0x38af48);}}async[a54_0xe1cca7(0x1e1)](_0x3c499f,_0x2550d5,_0x458f60){const _0x47f3af=a54_0xe1cca7,_0x11cf16={'created':'🆕','paid':'✅','failed':'❌','expired':'⏰','refund':'🔄','chargeback':'⚠️','processing':'⚙️'},_0x5d42cf={'created':'New\x20payment\x20created','paid':'Payment\x20successfully\x20paid','failed':_0x47f3af(0x15f),'expired':_0x47f3af(0x19f),'refund':'Payment\x20refund','chargeback':'Payment\x20chargeback','processing':_0x47f3af(0x1d4)},_0x22c576=_0x11cf16[_0x458f60],_0x23aeeb=_0x5d42cf[_0x458f60],_0x33d4b2=(0x0,gateway_1[_0x47f3af(0x215)])(_0x2550d5[_0x47f3af(0x167)]);console[_0x47f3af(0x1c4)](_0x47f3af(0x190)+_0x2550d5[_0x47f3af(0x167)]+_0x47f3af(0x22c)+_0x33d4b2+'\x22');let _0x31b434=_0x22c576+'\x20*'+_0x23aeeb+'*\x0a\x0a'+(_0x47f3af(0x19c)+_0x2550d5['amount']+'\x20'+_0x2550d5[_0x47f3af(0x1be)]+'*\x0a')+('📝\x20Order\x20ID:\x20`'+(_0x2550d5[_0x47f3af(0x1b1)]||_0x2550d5['id'])+'`\x0a')+(_0x47f3af(0x145)+_0x2550d5['id']+'`\x0a')+(_0x47f3af(0x206)+_0x33d4b2+'`\x0a')+(_0x47f3af(0x1af)+new Date(_0x2550d5[_0x47f3af(0x21d)])['toLocaleString'](_0x47f3af(0x14c))+'\x0a');(_0x2550d5[_0x47f3af(0x1da)]||_0x2550d5['customerEmail']||_0x2550d5['customerIp']||_0x2550d5['customerCountry'])&&(_0x31b434+='\x0a👤\x20*Customer\x20Information:*\x0a',_0x2550d5[_0x47f3af(0x1da)]&&(_0x31b434+='📛\x20Name:\x20`'+_0x2550d5[_0x47f3af(0x1da)]+'`\x0a'),_0x2550d5[_0x47f3af(0x227)]&&(_0x31b434+='📧\x20Email:\x20`'+_0x2550d5['customerEmail']+'`\x0a'),_0x2550d5['customerIp']&&(_0x31b434+=_0x47f3af(0x198)+_0x2550d5[_0x47f3af(0x187)]+'`\x0a'),_0x2550d5[_0x47f3af(0x222)]&&(_0x31b434+=_0x47f3af(0x218)+_0x2550d5[_0x47f3af(0x222)]+'`\x0a')),(_0x2550d5[_0x47f3af(0x155)]||_0x2550d5[_0x47f3af(0x1df)]||_0x2550d5['bankId']||_0x2550d5[_0x47f3af(0x1db)])&&(_0x31b434+=_0x47f3af(0x192),_0x2550d5[_0x47f3af(0x155)]&&(_0x31b434+='💰\x20Method:\x20`'+_0x2550d5[_0x47f3af(0x155)]+'`\x0a'),_0x2550d5[_0x47f3af(0x1df)]&&(_0x31b434+='💳\x20Card:\x20`****'+_0x2550d5[_0x47f3af(0x1df)]+'`\x0a'),_0x2550d5['bankId']&&(_0x31b434+='🏦\x20Bank\x20ID:\x20`'+_0x2550d5[_0x47f3af(0x20b)]+'`\x0a'),_0x2550d5[_0x47f3af(0x1db)]&&(_0x31b434+=_0x47f3af(0x1de)+_0x2550d5[_0x47f3af(0x1db)]+'`\x0a'),_0x2550d5[_0x47f3af(0x181)]&&(_0x31b434+='👤\x20Remitter:\x20`'+_0x2550d5[_0x47f3af(0x181)]+'`\x0a')),_0x458f60===_0x47f3af(0x20a)&&_0x2550d5['chargebackAmount']&&(_0x31b434+=_0x47f3af(0x1f0)+_0x2550d5[_0x47f3af(0x150)]+_0x47f3af(0x18e)),_0x458f60===_0x47f3af(0x13e)&&(_0x31b434+=_0x47f3af(0x19b)),_0x2550d5[_0x47f3af(0x14d)]&&(_0x31b434+=_0x47f3af(0x14f)+_0x2550d5[_0x47f3af(0x14d)]+'\x0a'),await this[_0x47f3af(0x217)](_0x3c499f,_0x31b434,{'parse_mode':'Markdown'});}async[a54_0xe1cca7(0x1a7)](_0x53be00,_0x144257,_0x235b41){const _0x19453a=a54_0xe1cca7,_0x28decf={'created':'📤','completed':'✅','rejected':'❌'},_0x3e589d={'created':'New\x20payout\x20created','completed':_0x19453a(0x1f4),'rejected':_0x19453a(0x225)},_0x3c40c1=_0x28decf[_0x235b41],_0x378603=_0x3e589d[_0x235b41],_0x2c6148=_0x3c40c1+'\x20*'+_0x378603+_0x19453a(0x1dc)+(_0x19453a(0x1ff)+_0x144257[_0x19453a(0x1cf)]+_0x19453a(0x178))+(_0x19453a(0x176)+_0x144257[_0x19453a(0x1ea)]+'`\x0a')+(_0x19453a(0x1c9)+_0x144257['id']+'`\x0a')+(_0x19453a(0x1af)+new Date(_0x144257['createdAt'])[_0x19453a(0x141)]('en-US')+'\x0a')+(_0x144257['txid']?_0x19453a(0x1d0)+_0x144257[_0x19453a(0x16f)]+'`':'');await this[_0x19453a(0x217)](_0x53be00,_0x2c6148,{'parse_mode':_0x19453a(0x1a1)});}async['sendLoginNotification'](_0x3286da,_0x56b17f){const _0x3afb65=a54_0xe1cca7;try{const _0x2f8153=await database_1[_0x3afb65(0x1fc)][_0x3afb65(0x164)][_0x3afb65(0x172)]({'where':{'shopId':_0x3286da},'select':{'notificationLogin':!![]}});if(!_0x2f8153?.['notificationLogin']){console['log'](_0x3afb65(0x183)+_0x3286da);return;}const _0x1a7cbb=_0x56b17f[_0x3afb65(0x14a)]?'🔐':'🚨',_0x440b9d=_0x56b17f['success']?_0x3afb65(0x195):_0x3afb65(0x169);let _0x47dc6f=_0x1a7cbb+'\x20*'+_0x440b9d+_0x3afb65(0x1dc)+(_0x3afb65(0x173)+_0x56b17f[_0x3afb65(0x161)]+'`\x0a')+(_0x3afb65(0x196)+_0x56b17f['timestamp'][_0x3afb65(0x141)](_0x3afb65(0x14c))+'\x0a');_0x56b17f['ipAddress']&&(_0x47dc6f+=_0x3afb65(0x1d9)+_0x56b17f[_0x3afb65(0x14e)]+'`\x0a');if(_0x56b17f[_0x3afb65(0x16b)]){const _0xd0f67f=_0x56b17f[_0x3afb65(0x16b)]['length']>0x32?_0x56b17f[_0x3afb65(0x16b)]['substring'](0x0,0x32)+_0x3afb65(0x1b3):_0x56b17f[_0x3afb65(0x16b)];_0x47dc6f+=_0x3afb65(0x1ce)+_0xd0f67f+'`\x0a';}!_0x56b17f[_0x3afb65(0x14a)]&&(_0x47dc6f+=_0x3afb65(0x1b5)),await this[_0x3afb65(0x217)](_0x3286da,_0x47dc6f,{'parse_mode':_0x3afb65(0x1a1)}),console[_0x3afb65(0x1c4)](_0x3afb65(0x186)+_0x3286da+':\x20'+(_0x56b17f['success']?_0x3afb65(0x14a):_0x3afb65(0x191)));}catch(_0x4eee2e){console['error'](_0x3afb65(0x13b),_0x4eee2e);}}async[a54_0xe1cca7(0x1b2)](_0x25068f,_0x3ce876){const _0x407ba4=a54_0xe1cca7;try{const _0x59d94f=await database_1['default'][_0x407ba4(0x164)]['findUnique']({'where':{'shopId':_0x25068f},'select':{'notificationApiError':!![]}});if(!_0x59d94f?.[_0x407ba4(0x205)]){console[_0x407ba4(0x1c4)](_0x407ba4(0x216)+_0x25068f);return;}let _0x4511b9=_0x407ba4(0x20f)+(_0x407ba4(0x149)+_0x3ce876[_0x407ba4(0x1ea)]+'\x20'+_0x3ce876[_0x407ba4(0x185)]+'`\x0a')+(_0x407ba4(0x196)+_0x3ce876[_0x407ba4(0x15c)][_0x407ba4(0x141)](_0x407ba4(0x14c))+'\x0a');_0x3ce876[_0x407ba4(0x140)]&&(_0x4511b9+=_0x407ba4(0x18c)+_0x3ce876[_0x407ba4(0x140)]+'`\x0a'),_0x4511b9+=_0x407ba4(0x223)+_0x3ce876[_0x407ba4(0x197)]+'`\x0a',_0x3ce876[_0x407ba4(0x1bc)]&&(_0x4511b9+=_0x407ba4(0x211)+_0x3ce876['requestId']+'`\x0a'),_0x4511b9+=_0x407ba4(0x168),await this[_0x407ba4(0x217)](_0x25068f,_0x4511b9,{'parse_mode':_0x407ba4(0x1a1)}),console[_0x407ba4(0x1c4)](_0x407ba4(0x156)+_0x25068f+':\x20'+_0x3ce876[_0x407ba4(0x185)]);}catch(_0x2b0cbd){console[_0x407ba4(0x21b)]('Failed\x20to\x20send\x20API\x20error\x20notification:',_0x2b0cbd);}}async['sendCustomNotification'](_0x60d59a,_0xde6597,_0x4f1262){const _0x2857c9=a54_0xe1cca7;let _0x2569cb=_0x2857c9(0x179)+_0xde6597+'*\x0a\x0a';for(const [_0x3b19e2,_0x1d00a1]of Object[_0x2857c9(0x22a)](_0x4f1262)){_0x1d00a1!==null&&_0x1d00a1!==undefined&&(_0x2569cb+=_0x3b19e2+_0x2857c9(0x1f9)+_0x1d00a1+'`\x0a');}await this[_0x2857c9(0x217)](_0x60d59a,_0x2569cb,{'parse_mode':_0x2857c9(0x1a1)});}[a54_0xe1cca7(0x165)](){const _0x36da91=a54_0xe1cca7;return{'isActive':!!this[_0x36da91(0x1e2)],'username':this[_0x36da91(0x1fb)]};}[a54_0xe1cca7(0x160)](){const _0x29b646=a54_0xe1cca7;this['bot']&&(this['bot']['stopPolling'](),this[_0x29b646(0x1e2)]=null,console[_0x29b646(0x1c4)]('🛑\x20Telegram\x20bot\x20stopped'));}}exports['TelegramBotService']=TelegramBotService,exports['telegramBotService']=new TelegramBotService();