'use strict';const a54_0x29f7bc=a54_0x3c96;(function(_0x2defd7,_0x27dbae){const _0x5baa14=a54_0x3c96,_0x48e845=_0x2defd7();while(!![]){try{const _0x2d6c4a=parseInt(_0x5baa14(0x123))/0x1+parseInt(_0x5baa14(0xf5))/0x2*(-parseInt(_0x5baa14(0x12f))/0x3)+-parseInt(_0x5baa14(0x13e))/0x4*(-parseInt(_0x5baa14(0x121))/0x5)+-parseInt(_0x5baa14(0x9b))/0x6+-parseInt(_0x5baa14(0x12b))/0x7*(parseInt(_0x5baa14(0x16d))/0x8)+parseInt(_0x5baa14(0x13a))/0x9+-parseInt(_0x5baa14(0xd5))/0xa*(-parseInt(_0x5baa14(0x13b))/0xb);if(_0x2d6c4a===_0x27dbae)break;else _0x48e845['push'](_0x48e845['shift']());}catch(_0x4ceb44){_0x48e845['push'](_0x48e845['shift']());}}}(a54_0x39e1,0x8cee0));function a54_0x3c96(_0x46c733,_0x26039d){const _0x39e106=a54_0x39e1();return a54_0x3c96=function(_0x3c9657,_0x3e6e54){_0x3c9657=_0x3c9657-0x91;let _0x1ae596=_0x39e106[_0x3c9657];return _0x1ae596;},a54_0x3c96(_0x46c733,_0x26039d);}var __importDefault=this&&this[a54_0x29f7bc(0x98)]||function(_0x713f7){const _0x5444fe=a54_0x29f7bc;return _0x713f7&&_0x713f7[_0x5444fe(0xbd)]?_0x713f7:{'default':_0x713f7};};Object['defineProperty'](exports,a54_0x29f7bc(0xbd),{'value':!![]}),exports['telegramBotService']=exports[a54_0x29f7bc(0x150)]=void 0x0;const node_telegram_bot_api_1=__importDefault(require('node-telegram-bot-api')),database_1=__importDefault(require(a54_0x29f7bc(0xe6))),gateway_1=require(a54_0x29f7bc(0x163));class TelegramBotService{constructor(){const _0x21b1cb=a54_0x29f7bc;this['bot']=null,this[_0x21b1cb(0xf1)]=process[_0x21b1cb(0x14e)][_0x21b1cb(0xb0)]||'',this[_0x21b1cb(0x129)]=process[_0x21b1cb(0x14e)][_0x21b1cb(0x145)]||_0x21b1cb(0x146),this[_0x21b1cb(0xf1)]?this[_0x21b1cb(0xd4)]():console[_0x21b1cb(0xc5)]('TELEGRAM_BOT_TOKEN\x20not\x20found\x20in\x20environment\x20variables');}['initializeBot'](){const _0x3eec24=a54_0x29f7bc;try{this[_0x3eec24(0x153)]=new node_telegram_bot_api_1[(_0x3eec24(0x10c))](this['botToken'],{'polling':!![]}),this[_0x3eec24(0xfa)](),console['log'](_0x3eec24(0xac)+this['botUsername']+_0x3eec24(0xf3));}catch(_0x257f51){console[_0x3eec24(0x93)](_0x3eec24(0x165),_0x257f51);}}[a54_0x29f7bc(0xfa)](){const _0x3c155b=a54_0x29f7bc;if(!this[_0x3c155b(0x153)])return;this[_0x3c155b(0x153)][_0x3c155b(0x13f)](/\/start/,async _0x315d08=>{const _0x386551=_0x3c155b,_0x4b7f00=_0x315d08[_0x386551(0x11d)]['id'],_0x4288b1=_0x315d08[_0x386551(0x156)]?.['id'][_0x386551(0xcd)](),_0x4b85c5=_0x315d08[_0x386551(0x156)]?.['username'],_0x6e84c8=_0x315d08[_0x386551(0x156)]?.[_0x386551(0x11f)],_0x525888=_0x315d08[_0x386551(0x156)]?.[_0x386551(0xc7)];if(!_0x4288b1)return;try{let _0x26ca0a=await database_1['default'][_0x386551(0x9a)][_0x386551(0xfe)]({'where':{'telegramId':_0x4288b1},'include':{'shop':!![]}});!_0x26ca0a?(_0x26ca0a=await database_1['default']['telegramUser']['create']({'data':{'telegramId':_0x4288b1,'username':_0x4b85c5,'firstName':_0x6e84c8,'lastName':_0x525888,'isVerified':![],'shopId':null},'include':{'shop':!![]}}),console[_0x386551(0x148)](_0x386551(0x15e)+_0x4288b1+_0x386551(0x124)+_0x4b85c5+')')):_0x26ca0a=await database_1[_0x386551(0x10c)]['telegramUser'][_0x386551(0x149)]({'where':{'telegramId':_0x4288b1},'data':{'username':_0x4b85c5,'firstName':_0x6e84c8,'lastName':_0x525888},'include':{'shop':!![]}}),_0x26ca0a['isVerified']&&_0x26ca0a[_0x386551(0x134)]&&_0x26ca0a[_0x386551(0x162)]?await this[_0x386551(0x153)]?.[_0x386551(0x137)](_0x4b7f00,_0x386551(0x101)+('You\x20are\x20already\x20connected\x20to\x20shop:\x20*'+_0x26ca0a[_0x386551(0x162)]['name']+'*\x0a')+(_0x386551(0x97)+_0x26ca0a['shop'][_0x386551(0xbf)]+_0x386551(0xdb))+_0x386551(0x140)+_0x386551(0xc9)+_0x386551(0xad)+'•\x20Payouts\x0a\x0a'+_0x386551(0xd0)+_0x386551(0xb7)+'/disconnect\x20-\x20disconnect\x20from\x20notifications',{'parse_mode':_0x386551(0xab)}):(_0x26ca0a['shopId']&&!_0x26ca0a['isVerified']&&(await database_1['default']['telegramUser']['update']({'where':{'telegramId':_0x4288b1},'data':{'shopId':null,'isVerified':![]}}),console['log'](_0x386551(0x144)+_0x4288b1)),await this['bot']?.['sendMessage'](_0x4b7f00,'🤖\x20Welcome\x20to\x20TRAPAY\x20notification\x20system!\x0a\x0a'+_0x386551(0x11a)+_0x386551(0x139)+'Example:\x0a'+_0x386551(0x109)+_0x386551(0xb1),{'parse_mode':'Markdown'}));}catch(_0x170d98){console['error']('Error\x20handling\x20/start\x20command:',_0x170d98),await this[_0x386551(0x153)]?.[_0x386551(0x137)](_0x4b7f00,_0x386551(0x126));}}),this[_0x3c155b(0x153)]['onText'](/\/disconnect/,async _0x42a38f=>{const _0x1daac5=_0x3c155b,_0x24c3ee=_0x42a38f[_0x1daac5(0x11d)]['id'],_0x49abdf=_0x42a38f[_0x1daac5(0x156)]?.['id'][_0x1daac5(0xcd)]();if(!_0x49abdf)return;try{const _0x2de522=await database_1[_0x1daac5(0x10c)][_0x1daac5(0x9a)][_0x1daac5(0xfe)]({'where':{'telegramId':_0x49abdf},'include':{'shop':!![]}});if(!_0x2de522||!_0x2de522[_0x1daac5(0xeb)]||!_0x2de522[_0x1daac5(0x134)]){await this[_0x1daac5(0x153)]?.[_0x1daac5(0x137)](_0x24c3ee,_0x1daac5(0xa8));return;}const _0xb164f9=_0x2de522[_0x1daac5(0x162)]?.[_0x1daac5(0xbe)]||_0x1daac5(0x10d);await database_1[_0x1daac5(0x10c)]['telegramUser'][_0x1daac5(0x149)]({'where':{'telegramId':_0x49abdf},'data':{'shopId':null,'isVerified':![]}}),console[_0x1daac5(0x148)](_0x1daac5(0x16c)+_0x49abdf+_0x1daac5(0x118)+_0x2de522[_0x1daac5(0x134)]),await this['bot']?.['sendMessage'](_0x24c3ee,_0x1daac5(0xfd)+_0xb164f9+_0x1daac5(0xa1)+'To\x20reconnect,\x20use\x20the\x20/start\x20command',{'parse_mode':'Markdown'});}catch(_0x2cbb2b){console['error']('Error\x20handling\x20/disconnect\x20command:',_0x2cbb2b),await this['bot']?.[_0x1daac5(0x137)](_0x24c3ee,_0x1daac5(0x126));}}),this[_0x3c155b(0x153)]['onText'](/\/status/,async _0x2af642=>{const _0x360d1b=_0x3c155b,_0x321cd6=_0x2af642[_0x360d1b(0x11d)]['id'],_0x293840=_0x2af642['from']?.['id'][_0x360d1b(0xcd)]();if(!_0x293840)return;try{const _0x24d7e3=await database_1['default'][_0x360d1b(0x9a)][_0x360d1b(0xfe)]({'where':{'telegramId':_0x293840},'include':{'shop':!![]}});if(!_0x24d7e3){await this['bot']?.[_0x360d1b(0x137)](_0x321cd6,'❌\x20You\x20are\x20not\x20registered\x20in\x20the\x20system.\x0a\x0a'+_0x360d1b(0xae));return;}if(!_0x24d7e3[_0x360d1b(0xeb)]||!_0x24d7e3[_0x360d1b(0x134)]||!_0x24d7e3[_0x360d1b(0x162)]){await this[_0x360d1b(0x153)]?.['sendMessage'](_0x321cd6,'❌\x20You\x20are\x20not\x20connected\x20to\x20a\x20shop.\x0a\x0a'+_0x360d1b(0xaf));return;}await this[_0x360d1b(0x153)]?.[_0x360d1b(0x137)](_0x321cd6,'📊\x20*Connection\x20Status*\x0a\x0a'+('✅\x20Connected\x20to\x20shop:\x20*'+_0x24d7e3[_0x360d1b(0x162)][_0x360d1b(0xbe)]+'*\x0a')+('👤\x20Username:\x20`'+_0x24d7e3[_0x360d1b(0x162)][_0x360d1b(0xbf)]+'`\x0a')+(_0x360d1b(0x95)+_0x24d7e3[_0x360d1b(0xbc)][_0x360d1b(0xf9)](_0x360d1b(0x108))+'\x0a\x0a')+'🔔\x20Notifications\x20are\x20active\x0a\x0a'+_0x360d1b(0xd0)+_0x360d1b(0x125),{'parse_mode':_0x360d1b(0xab)});}catch(_0x561ca4){console[_0x360d1b(0x93)](_0x360d1b(0x168),_0x561ca4),await this['bot']?.[_0x360d1b(0x137)](_0x321cd6,_0x360d1b(0x126));}}),this['bot'][_0x3c155b(0x13f)](/\/debug/,async _0x672d97=>{const _0x24bf05=_0x3c155b,_0x470dd8=_0x672d97[_0x24bf05(0x11d)]['id'],_0x3a4fa8=_0x672d97[_0x24bf05(0x156)]?.['id']['toString']();if(!_0x3a4fa8)return;try{const _0x223ff6=await database_1['default'][_0x24bf05(0x162)][_0x24bf05(0x106)]({'select':{'id':!![],'name':!![],'username':!![],'status':!![],'publicKey':!![]},'take':0xa});let _0x3deb9f=_0x24bf05(0xc4);_0x3deb9f+='📱\x20Your\x20Telegram\x20ID:\x20`'+_0x3a4fa8+'`\x0a\x0a',_0x3deb9f+=_0x24bf05(0x9e),_0x223ff6[_0x24bf05(0xc3)]((_0x2dcf1e,_0x59402f)=>{const _0x25dc5f=_0x24bf05;_0x3deb9f+=_0x59402f+0x1+_0x25dc5f(0xb3)+_0x2dcf1e[_0x25dc5f(0xbe)]+'*\x0a',_0x3deb9f+=_0x25dc5f(0x15f)+_0x2dcf1e[_0x25dc5f(0xbf)]+'`\x0a',_0x3deb9f+=_0x25dc5f(0x122)+_0x2dcf1e[_0x25dc5f(0x119)]+'\x0a',_0x3deb9f+=_0x25dc5f(0xf8)+_0x2dcf1e['publicKey'][_0x25dc5f(0xe3)](0x0,0xf)+'...`\x0a\x0a';}),await this['bot']?.[_0x24bf05(0x137)](_0x470dd8,_0x3deb9f,{'parse_mode':'Markdown'});}catch(_0x272609){console[_0x24bf05(0x93)](_0x24bf05(0xe2),_0x272609),await this[_0x24bf05(0x153)]?.[_0x24bf05(0x137)](_0x470dd8,_0x24bf05(0x132));}}),this[_0x3c155b(0x153)]['on'](_0x3c155b(0x10e),async _0x1bd360=>{const _0x28b8df=_0x3c155b;if(_0x1bd360[_0x28b8df(0xbb)]?.['startsWith']('/'))return;const _0x225ef2=_0x1bd360[_0x28b8df(0x11d)]['id'],_0x182531=_0x1bd360[_0x28b8df(0x156)]?.['id']['toString'](),_0x5efd2d=_0x1bd360['text']?.[_0x28b8df(0xf7)]();if(!_0x182531||!_0x5efd2d)return;try{const _0x5917cb=await database_1[_0x28b8df(0x10c)][_0x28b8df(0x9a)]['findUnique']({'where':{'telegramId':_0x182531},'include':{'shop':!![]}});if(!_0x5917cb){await this['bot']?.[_0x28b8df(0x137)](_0x225ef2,_0x28b8df(0x151));return;}if(_0x5917cb[_0x28b8df(0xeb)]&&_0x5917cb[_0x28b8df(0x134)]&&_0x5917cb[_0x28b8df(0x162)]){await this[_0x28b8df(0x153)]?.[_0x28b8df(0x137)](_0x225ef2,'✅\x20You\x20are\x20already\x20connected\x20to\x20shop\x20*'+_0x5917cb[_0x28b8df(0x162)]['name']+_0x28b8df(0xa1)+_0x28b8df(0xe9),{'parse_mode':'Markdown'});return;}const _0x269686=_0x5efd2d['split'](/\s+/);if(_0x269686[_0x28b8df(0x14d)]!==0x2){await this[_0x28b8df(0x153)]?.[_0x28b8df(0x137)](_0x225ef2,'❌\x20Invalid\x20format.\x20Please\x20send\x20exactly\x202\x20parts\x20separated\x20by\x20space:\x0a\x0a'+_0x28b8df(0x139)+'Example:\x0a'+'`appple\x20pk_aa6450d3f57afbefbb0f3f5be5ce6cca13037536afc5ccf14c81a6cbc7a07de5`\x0a\x0a'+(_0x28b8df(0xdf)+_0x269686[_0x28b8df(0x14d)]+_0x28b8df(0x103)+_0x269686[_0x28b8df(0x15c)](_0x56be68=>'`'+_0x56be68+'`')[_0x28b8df(0xb9)](',\x20')),{'parse_mode':'Markdown'});return;}const [_0x445a45,_0xc9403e]=_0x269686;console[_0x28b8df(0x148)](_0x28b8df(0x155)+_0x182531+_0x28b8df(0x100)+_0x445a45+_0x28b8df(0x91)+_0xc9403e['substring'](0x0,0xa)+_0x28b8df(0xb6)),await this[_0x28b8df(0xe4)](_0x225ef2,_0x182531,_0x445a45,_0xc9403e);}catch(_0x5bdda2){console[_0x28b8df(0x93)](_0x28b8df(0xfb),_0x5bdda2),await this[_0x28b8df(0x153)]?.['sendMessage'](_0x225ef2,_0x28b8df(0x126));}}),this['bot']['on'](_0x3c155b(0x93),_0x1a0760=>{const _0xcb79c9=_0x3c155b;console[_0xcb79c9(0x93)](_0xcb79c9(0x131),_0x1a0760);}),this[_0x3c155b(0x153)]['on'](_0x3c155b(0xa4),_0x5b1663=>{const _0x555bcd=_0x3c155b;console[_0x555bcd(0x93)](_0x555bcd(0xd8),_0x5b1663);});}async[a54_0x29f7bc(0xe4)](_0x129c9f,_0x810d46,_0x4296b4,_0x4a39df){const _0x10491a=a54_0x29f7bc;try{console['log'](_0x10491a(0x155)+_0x810d46+':\x20username=\x22'+_0x4296b4+_0x10491a(0x91)+_0x4a39df[_0x10491a(0xe3)](0x0,0xa)+_0x10491a(0xb6));if(!_0x4296b4||_0x4296b4[_0x10491a(0x14d)]<0x3||_0x4296b4[_0x10491a(0x14d)]>0x32||!/^[a-zA-Z0-9_]+$/['test'](_0x4296b4)){await this['bot']?.[_0x10491a(0x137)](_0x129c9f,_0x10491a(0xdc)+_0x4296b4+_0x10491a(0xdb)+_0x10491a(0x161),{'parse_mode':_0x10491a(0xab)});return;}if(!_0x4a39df||!_0x4a39df[_0x10491a(0x14f)](_0x10491a(0x12c))&&!_0x4a39df[_0x10491a(0x14f)]('sk_')){await this['bot']?.[_0x10491a(0x137)](_0x129c9f,'❌\x20Invalid\x20API\x20key\x20format.\x0a\x0a'+_0x10491a(0x142),{'parse_mode':_0x10491a(0xab)});return;}const _0x3c61c3=await database_1[_0x10491a(0x10c)][_0x10491a(0x162)][_0x10491a(0xfe)]({'where':{'username':_0x4296b4},'select':{'id':!![],'name':!![],'username':!![],'status':!![],'publicKey':!![],'secretKey':!![]}});if(!_0x3c61c3){const _0x3f5fbe=await database_1[_0x10491a(0x10c)][_0x10491a(0x162)][_0x10491a(0x106)]({'select':{'username':!![],'name':!![]},'take':0x5});let _0x4f9de6=_0x10491a(0x14a)+_0x4296b4+_0x10491a(0x92);_0x3f5fbe[_0x10491a(0x14d)]>0x0?(_0x4f9de6+=_0x10491a(0xaa),_0x3f5fbe[_0x10491a(0xc3)](_0x55abbe=>{const _0x2017e4=_0x10491a;_0x4f9de6+=_0x2017e4(0xb4)+_0x55abbe[_0x2017e4(0xbf)]+_0x2017e4(0x10a)+_0x55abbe['name']+')\x0a';}),_0x4f9de6+=_0x10491a(0xc6)):_0x4f9de6+=_0x10491a(0xcf);await this['bot']?.['sendMessage'](_0x129c9f,_0x4f9de6,{'parse_mode':_0x10491a(0xab)});return;}if(_0x3c61c3['status']!==_0x10491a(0xe8)){await this[_0x10491a(0x153)]?.[_0x10491a(0x137)](_0x129c9f,_0x10491a(0xda)+_0x4296b4+_0x10491a(0xc2)+_0x10491a(0x12e),{'parse_mode':'Markdown'});return;}if(_0x3c61c3[_0x10491a(0x133)]!==_0x4a39df&&_0x3c61c3[_0x10491a(0xce)]!==_0x4a39df){await this[_0x10491a(0x153)]?.['sendMessage'](_0x129c9f,_0x10491a(0x15a)+_0x4296b4+'`.\x0a\x0a'+'Check\x20the\x20key\x20and\x20try\x20again.\x0a\x0a'+_0x10491a(0x107),{'parse_mode':_0x10491a(0xab)});return;}const _0x84a7d6=await database_1[_0x10491a(0x10c)][_0x10491a(0x9a)][_0x10491a(0xcb)]({'where':{'shopId':_0x3c61c3['id'],'isVerified':!![],'telegramId':{'not':_0x810d46}}});if(_0x84a7d6){await this['bot']?.['sendMessage'](_0x129c9f,'❌\x20Another\x20Telegram\x20account\x20is\x20already\x20connected\x20to\x20shop\x20`'+_0x4296b4+_0x10491a(0x11e)+_0x10491a(0x154),{'parse_mode':_0x10491a(0xab)});return;}await database_1[_0x10491a(0x10c)][_0x10491a(0x9a)][_0x10491a(0x149)]({'where':{'telegramId':_0x810d46},'data':{'shopId':_0x3c61c3['id'],'isVerified':!![]}}),await this[_0x10491a(0x153)]?.[_0x10491a(0x137)](_0x129c9f,_0x10491a(0x143)+_0x10491a(0x12d)+('📱\x20Shop:\x20*'+_0x3c61c3[_0x10491a(0xbe)]+'*\x0a')+(_0x10491a(0x117)+_0x3c61c3['username']+_0x10491a(0xdb))+_0x10491a(0xd6)+_0x10491a(0xc9)+'•\x20Payment\x20status\x20changes\x0a'+_0x10491a(0x114)+'•\x20Important\x20events\x0a\x0a'+_0x10491a(0xd0)+_0x10491a(0xb7)+'/disconnect\x20-\x20disconnect\x20from\x20notifications',{'parse_mode':_0x10491a(0xab)}),console[_0x10491a(0x148)](_0x10491a(0x16f)+_0x810d46+_0x10491a(0xe7)+_0x3c61c3[_0x10491a(0xbf)]+_0x10491a(0x110));}catch(_0x4a420e){console['error'](_0x10491a(0x11b),_0x4a420e),await this[_0x10491a(0x153)]?.[_0x10491a(0x137)](_0x129c9f,_0x10491a(0x115));}}async['sendShopNotification'](_0x382e73,_0x53c59e,_0x286d2f){const _0x9ca5e5=a54_0x29f7bc;if(!this[_0x9ca5e5(0x153)]){console[_0x9ca5e5(0xc5)](_0x9ca5e5(0x99));return;}try{const _0x3b79bf=await database_1[_0x9ca5e5(0x10c)][_0x9ca5e5(0x9a)][_0x9ca5e5(0x106)]({'where':{'shopId':_0x382e73,'isVerified':!![]}});if(_0x3b79bf[_0x9ca5e5(0x14d)]===0x0){console[_0x9ca5e5(0x148)](_0x9ca5e5(0x105)+_0x382e73);return;}const _0x3c1745=_0x3b79bf['map'](async _0x4f7073=>{const _0x1b55ed=_0x9ca5e5;try{await this[_0x1b55ed(0x153)]?.['sendMessage'](_0x4f7073[_0x1b55ed(0x9f)],_0x53c59e,_0x286d2f),console['log'](_0x1b55ed(0x14c)+_0x4f7073[_0x1b55ed(0x9f)]);}catch(_0x426085){console[_0x1b55ed(0x93)]('❌\x20Failed\x20to\x20send\x20notification\x20to\x20Telegram\x20user\x20'+_0x4f7073[_0x1b55ed(0x9f)]+':',_0x426085),_0x426085 instanceof Error&&(_0x426085[_0x1b55ed(0x10e)]['includes']('blocked')||_0x426085[_0x1b55ed(0x10e)][_0x1b55ed(0xef)](_0x1b55ed(0xf4))||_0x426085[_0x1b55ed(0x10e)][_0x1b55ed(0xef)](_0x1b55ed(0xf0)))&&(await database_1[_0x1b55ed(0x10c)][_0x1b55ed(0x9a)][_0x1b55ed(0x149)]({'where':{'id':_0x4f7073['id']},'data':{'isVerified':![]}}),console[_0x1b55ed(0x148)]('User\x20'+_0x4f7073[_0x1b55ed(0x9f)]+_0x1b55ed(0xb5)));}});await Promise['allSettled'](_0x3c1745);}catch(_0x5b855a){console['error'](_0x9ca5e5(0x157),_0x5b855a);}}async[a54_0x29f7bc(0xf6)](_0x1522f3,_0x4c27c0,_0x1b65d4){const _0x28c801=a54_0x29f7bc,_0x59d247={'created':'🆕','paid':'✅','failed':'❌','expired':'⏰','refund':'🔄','chargeback':'⚠️','processing':'⚙️'},_0x5dd0b8={'created':'New\x20payment\x20created','paid':_0x28c801(0x120),'failed':'Payment\x20failed','expired':_0x28c801(0x136),'refund':_0x28c801(0xc8),'chargeback':_0x28c801(0x135),'processing':_0x28c801(0xa6)},_0x552b44=_0x59d247[_0x1b65d4],_0x28f2e8=_0x5dd0b8[_0x1b65d4],_0x884084=(0x0,gateway_1[_0x28c801(0xb8)])(_0x4c27c0[_0x28c801(0xc1)]);console[_0x28c801(0x148)](_0x28c801(0xb2)+_0x4c27c0[_0x28c801(0xc1)]+_0x28c801(0x152)+_0x884084+'\x22');let _0x5623bc=_0x552b44+'\x20*'+_0x28f2e8+_0x28c801(0x16e)+('💰\x20Amount:\x20*'+_0x4c27c0[_0x28c801(0xa0)]+'\x20'+_0x4c27c0['currency']+'*\x0a')+(_0x28c801(0xdd)+(_0x4c27c0['orderId']||_0x4c27c0['id'])+'`\x0a')+(_0x28c801(0x12a)+_0x4c27c0['id']+'`\x0a')+(_0x28c801(0xcc)+_0x884084+'`\x0a')+('📅\x20Date:\x20'+new Date(_0x4c27c0[_0x28c801(0x14b)])[_0x28c801(0xd7)](_0x28c801(0x108))+'\x0a');if(_0x4c27c0[_0x28c801(0xff)]||_0x4c27c0[_0x28c801(0x13d)]||_0x4c27c0[_0x28c801(0x10f)]||_0x4c27c0[_0x28c801(0x16b)]||_0x4c27c0[_0x28c801(0x15d)]){_0x5623bc+='\x0a👤\x20*Customer\x20Information:*\x0a';_0x4c27c0[_0x28c801(0xff)]&&(_0x5623bc+=_0x28c801(0x113)+_0x4c27c0[_0x28c801(0xff)]+'`\x0a');_0x4c27c0[_0x28c801(0x13d)]&&(_0x5623bc+=_0x28c801(0x13c)+_0x4c27c0['customerEmail']+'`\x0a');_0x4c27c0[_0x28c801(0x10f)]&&(_0x5623bc+=_0x28c801(0xba)+_0x4c27c0[_0x28c801(0x10f)]+'`\x0a');_0x4c27c0[_0x28c801(0x16b)]&&(_0x5623bc+='🌐\x20IP:\x20`'+_0x4c27c0[_0x28c801(0x16b)]+'`\x0a');if(_0x4c27c0[_0x28c801(0x15d)]){const _0x531971=_0x4c27c0[_0x28c801(0x15d)][_0x28c801(0x14d)]>0x32?_0x4c27c0['customerUa'][_0x28c801(0xe3)](0x0,0x32)+_0x28c801(0x160):_0x4c27c0[_0x28c801(0x15d)];_0x5623bc+='💻\x20Browser:\x20`'+_0x531971+'`\x0a';}}_0x1b65d4===_0x28c801(0x11c)&&_0x4c27c0[_0x28c801(0xea)]&&(_0x5623bc+='💸\x20Penalty\x20amount:\x20*'+_0x4c27c0[_0x28c801(0xea)]+_0x28c801(0xfc)),_0x1b65d4===_0x28c801(0x159)&&(_0x5623bc+=_0x28c801(0x112)),_0x4c27c0[_0x28c801(0x96)]&&(_0x5623bc+=_0x28c801(0xc0)+_0x4c27c0[_0x28c801(0x96)]+'\x0a'),await this[_0x28c801(0x102)](_0x1522f3,_0x5623bc,{'parse_mode':'Markdown'});}async[a54_0x29f7bc(0x130)](_0x100669,_0x45c031,_0x15172d){const _0x2f7c7e=a54_0x29f7bc,_0x55924a={'created':'📤','completed':'✅','rejected':'❌'},_0x2348aa={'created':'New\x20payout\x20created','completed':_0x2f7c7e(0x147),'rejected':_0x2f7c7e(0x127)},_0x596d2f=_0x55924a[_0x15172d],_0xba652e=_0x2348aa[_0x15172d],_0xd83311=_0x596d2f+'\x20*'+_0xba652e+'*\x0a\x0a'+(_0x2f7c7e(0xd2)+_0x45c031[_0x2f7c7e(0xa0)]+_0x2f7c7e(0x111))+(_0x2f7c7e(0xa5)+_0x45c031[_0x2f7c7e(0xf2)]+'`\x0a')+(_0x2f7c7e(0xa2)+_0x45c031['id']+'`\x0a')+('📅\x20Date:\x20'+new Date(_0x45c031[_0x2f7c7e(0x14b)])[_0x2f7c7e(0xd7)]('en-US')+'\x0a')+(_0x45c031[_0x2f7c7e(0x138)]?'🔗\x20TXID:\x20`'+_0x45c031['txid']+'`':'');await this[_0x2f7c7e(0x102)](_0x100669,_0xd83311,{'parse_mode':_0x2f7c7e(0xab)});}async['sendLoginNotification'](_0xe332c9,_0x471334){const _0x1335ff=a54_0x29f7bc;try{const _0x2d2831=await database_1[_0x1335ff(0x10c)][_0x1335ff(0x164)][_0x1335ff(0xfe)]({'where':{'shopId':_0xe332c9},'select':{'notificationLogin':!![]}});if(!_0x2d2831?.['notificationLogin']){console[_0x1335ff(0x148)](_0x1335ff(0x16a)+_0xe332c9);return;}const _0x1e15e2=_0x471334[_0x1335ff(0x15b)]?'🔐':'🚨',_0xec6064=_0x471334[_0x1335ff(0x15b)]?_0x1335ff(0xa7):'Failed\x20login\x20attempt';let _0x40a600=_0x1e15e2+'\x20*'+_0xec6064+_0x1335ff(0x16e)+(_0x1335ff(0x117)+_0x471334[_0x1335ff(0xbf)]+'`\x0a')+(_0x1335ff(0xd9)+_0x471334[_0x1335ff(0xa9)][_0x1335ff(0xd7)](_0x1335ff(0x108))+'\x0a');_0x471334[_0x1335ff(0xde)]&&(_0x40a600+=_0x1335ff(0x141)+_0x471334[_0x1335ff(0xde)]+'`\x0a');if(_0x471334[_0x1335ff(0x94)]){const _0x50ddee=_0x471334[_0x1335ff(0x94)][_0x1335ff(0x14d)]>0x32?_0x471334[_0x1335ff(0x94)][_0x1335ff(0xe3)](0x0,0x32)+_0x1335ff(0x160):_0x471334[_0x1335ff(0x94)];_0x40a600+='💻\x20Browser:\x20`'+_0x50ddee+'`\x0a';}!_0x471334[_0x1335ff(0x15b)]&&(_0x40a600+=_0x1335ff(0xd3)),await this[_0x1335ff(0x102)](_0xe332c9,_0x40a600,{'parse_mode':_0x1335ff(0xab)}),console[_0x1335ff(0x148)](_0x1335ff(0x104)+_0xe332c9+':\x20'+(_0x471334[_0x1335ff(0x15b)]?'success':_0x1335ff(0x9d)));}catch(_0x125e03){console[_0x1335ff(0x93)](_0x1335ff(0xe5),_0x125e03);}}async['sendApiErrorNotification'](_0x1f696e,_0x3a2762){const _0x4f127d=a54_0x29f7bc;try{const _0x2a9d9b=await database_1['default'][_0x4f127d(0x164)][_0x4f127d(0xfe)]({'where':{'shopId':_0x1f696e},'select':{'notificationApiError':!![]}});if(!_0x2a9d9b?.[_0x4f127d(0xd1)]){console[_0x4f127d(0x148)](_0x4f127d(0xca)+_0x1f696e);return;}let _0x12b172='🚨\x20*API\x20Error*\x0a\x0a'+(_0x4f127d(0xee)+_0x3a2762[_0x4f127d(0xf2)]+'\x20'+_0x3a2762['endpoint']+'`\x0a')+('📅\x20Time:\x20'+_0x3a2762[_0x4f127d(0xa9)][_0x4f127d(0xd7)](_0x4f127d(0x108))+'\x0a');_0x3a2762[_0x4f127d(0xec)]&&(_0x12b172+=_0x4f127d(0x166)+_0x3a2762[_0x4f127d(0xec)]+'`\x0a'),_0x12b172+=_0x4f127d(0xe0)+_0x3a2762[_0x4f127d(0x9c)]+'`\x0a',_0x3a2762[_0x4f127d(0xe1)]&&(_0x12b172+='🆔\x20Request\x20ID:\x20`'+_0x3a2762[_0x4f127d(0xe1)]+'`\x0a'),_0x12b172+='\x0a💡\x20Check\x20your\x20request\x20or\x20contact\x20support.',await this[_0x4f127d(0x102)](_0x1f696e,_0x12b172,{'parse_mode':_0x4f127d(0xab)}),console[_0x4f127d(0x148)](_0x4f127d(0x169)+_0x1f696e+':\x20'+_0x3a2762['endpoint']);}catch(_0x38bf76){console[_0x4f127d(0x93)](_0x4f127d(0x116),_0x38bf76);}}async[a54_0x29f7bc(0x167)](_0x39ac79,_0x24d4ee,_0x18e5c6){const _0x40be97=a54_0x29f7bc;let _0xbd9a4f=_0x40be97(0x158)+_0x24d4ee+_0x40be97(0x16e);for(const [_0x1ba742,_0x1bb1be]of Object['entries'](_0x18e5c6)){_0x1bb1be!==null&&_0x1bb1be!==undefined&&(_0xbd9a4f+=_0x1ba742+_0x40be97(0xa3)+_0x1bb1be+'`\x0a');}await this[_0x40be97(0x102)](_0x39ac79,_0xbd9a4f,{'parse_mode':_0x40be97(0xab)});}['getBotInfo'](){const _0x551c2c=a54_0x29f7bc;return{'isActive':!!this[_0x551c2c(0x153)],'username':this[_0x551c2c(0x129)]};}[a54_0x29f7bc(0xed)](){const _0x5ecf8c=a54_0x29f7bc;this[_0x5ecf8c(0x153)]&&(this[_0x5ecf8c(0x153)][_0x5ecf8c(0x10b)](),this[_0x5ecf8c(0x153)]=null,console[_0x5ecf8c(0x148)](_0x5ecf8c(0x128)));}}exports[a54_0x29f7bc(0x150)]=TelegramBotService,exports['telegramBotService']=new TelegramBotService();function a54_0x39e1(){const _0x16ac10=['Telegram\x20bot\x20polling\x20error:','📅\x20Time:\x20','❌\x20Shop\x20`','`\x0a\x0a','❌\x20Invalid\x20username\x20format:\x20`','📝\x20Order\x20ID:\x20`','ipAddress','You\x20sent\x20','❌\x20Error:\x20`','requestId','Error\x20handling\x20/debug\x20command:','substring','handleSingleLineVerification','Failed\x20to\x20send\x20login\x20notification:','../config/database','\x20verified\x20for\x20shop\x20','ACTIVE','Use\x20/status\x20to\x20check\x20status\x20or\x20/disconnect\x20to\x20disconnect.','chargebackAmount','isVerified','statusCode','stopBot','🔗\x20Endpoint:\x20`','includes','user\x20is\x20deactivated','botToken','method','\x20initialized\x20successfully','chat\x20not\x20found','71814XGexXr','sendPaymentNotification','trim','\x20\x20\x20Public\x20Key:\x20`','toLocaleDateString','setupBotHandlers','Error\x20handling\x20message:','\x20USDT*\x0a','✅\x20You\x20have\x20been\x20successfully\x20disconnected\x20from\x20shop\x20*','findUnique','customerName',':\x20username=\x22','✅\x20Welcome\x20back!\x0a\x0a','sendShopNotification','\x20parts:\x20','✅\x20Login\x20notification\x20sent\x20for\x20shop\x20','No\x20verified\x20Telegram\x20users\x20found\x20for\x20shop\x20','findMany','Expected\x20key\x20format:\x20`pk_...`\x20or\x20`sk_...`','en-US','`appple\x20pk_aa6450d3f57afbefbb0f3f5be5ce6cca13037536afc5ccf14c81a6cbc7a07de5`\x0a\x0a','`\x20(','stopPolling','default','unknown\x20shop','message','remitterIban','\x20via\x20single-line\x20input','\x20USD*\x0a','⏳\x20The\x20payment\x20is\x20currently\x20being\x20processed\x20by\x20the\x20gateway.\x0a','📛\x20Name:\x20`','•\x20Payouts\x0a','❌\x20An\x20error\x20occurred\x20while\x20verifying\x20data.','Failed\x20to\x20send\x20API\x20error\x20notification:','👤\x20Username:\x20`','\x20disconnected\x20from\x20shop\x20','status','To\x20receive\x20payment\x20notifications,\x20send\x20your\x20credentials\x20in\x20one\x20line:\x0a\x0a','Error\x20in\x20handleSingleLineVerification:','chargeback','chat','`.\x0a\x0a','first_name','Payment\x20successfully\x20paid','40605ErUyVX','\x20\x20\x20Status:\x20','517732BlvAru','\x20(@','/disconnect\x20-\x20disconnect\x20from\x20notifications','❌\x20An\x20error\x20occurred.\x20Please\x20try\x20again\x20later.','Payout\x20rejected','🛑\x20Telegram\x20bot\x20stopped','botUsername','🆔\x20Payment\x20ID:\x20`','294leBill','pk_','✅\x20You\x20have\x20been\x20successfully\x20connected\x20to\x20the\x20notification\x20system!\x0a\x0a','Contact\x20administrator.','15ZltfPK','sendPayoutNotification','Telegram\x20bot\x20error:','❌\x20Error\x20getting\x20debug\x20information.','publicKey','shopId','Payment\x20chargeback','Payment\x20expired','sendMessage','txid','📝\x20Format:\x20`username\x20api_key`\x0a\x0a','5047533bVePIW','119405KczDXx','📧\x20Email:\x20`','customerEmail','424ilMWbS','onText','🔔\x20You\x20receive\x20notifications\x20about:\x0a','🌐\x20IP\x20address:\x20`','API\x20key\x20must\x20start\x20with\x20`pk\x5c_`\x20or\x20`sk\x5c_`.','🎉\x20*Congratulations!*\x0a\x0a','🔄\x20Reset\x20incomplete\x20verification\x20for\x20user\x20','TELEGRAM_BOT_USERNAME','trapay_bot','Payout\x20completed','log','update','❌\x20Shop\x20with\x20username\x20`','createdAt','✅\x20Notification\x20sent\x20to\x20Telegram\x20user\x20','length','env','startsWith','TelegramBotService','❌\x20Please\x20use\x20/start\x20command\x20first','\x22\x20->\x20display\x20\x22','bot','Disconnect\x20the\x20previous\x20account\x20first\x20or\x20contact\x20administrator.','🔄\x20Processing\x20single-line\x20verification\x20for\x20user\x20','from','Error\x20sending\x20shop\x20notification:','🔔\x20*','processing','❌\x20API\x20key\x20does\x20not\x20match\x20shop\x20`','success','map','customerUa','📱\x20Created\x20new\x20Telegram\x20user:\x20','\x20\x20\x20Username:\x20`','...','Username\x20must\x20contain\x20only\x20letters,\x20numbers\x20and\x20underscore\x20(3-50\x20characters).','shop','../types/gateway','shopSettings','❌\x20Failed\x20to\x20initialize\x20Telegram\x20bot:','📊\x20Error\x20code:\x20`','sendCustomNotification','Error\x20handling\x20/status\x20command:','✅\x20API\x20error\x20notification\x20sent\x20for\x20shop\x20','📱\x20Login\x20notifications\x20disabled\x20for\x20shop\x20','customerIp','🔌\x20User\x20','36184pmhLYF','*\x0a\x0a','✅\x20Telegram\x20user\x20','\x22,\x20apiKey=\x22','`\x20not\x20found.\x0a\x0a','error','userAgent','📅\x20Connection\x20date:\x20','adminNotes','Username:\x20`','__importDefault','Telegram\x20bot\x20not\x20initialized,\x20cannot\x20send\x20notification','telegramUser','6281526JFrcVj','errorMessage','failed','🏪\x20Available\x20shops\x20in\x20system:\x0a','telegramId','amount','*.\x0a\x0a','🆔\x20Payout\x20ID:\x20`',':\x20`','polling_error','🏦\x20Method:\x20`','Payment\x20is\x20being\x20processed','Successful\x20login','❌\x20You\x20are\x20not\x20connected\x20to\x20the\x20notification\x20system.','timestamp','Available\x20usernames:\x0a','Markdown','✅\x20Telegram\x20bot\x20@','•\x20Payment\x20status\x20changes\x0a','Use\x20/start\x20to\x20begin.','Use\x20/start\x20to\x20connect.','TELEGRAM_BOT_TOKEN','❗️\x20Make\x20sure\x20to\x20separate\x20username\x20and\x20API\x20key\x20with\x20a\x20space!','📱\x20Telegram\x20notification:\x20gateway\x20\x22','.\x20*','•\x20`','\x20marked\x20as\x20unverified\x20due\x20to\x20delivery\x20failure','...\x22','/status\x20-\x20check\x20connection\x20status\x0a','getGatewayDisplayNameForTelegram','join','🏦\x20IBAN:\x20`','text','updatedAt','__esModule','name','username','📝\x20Notes:\x20','gateway','`\x20is\x20inactive.\x0a\x0a','forEach','🔍\x20*Debug\x20Information*\x0a\x0a','warn','\x0aCheck\x20spelling\x20and\x20try\x20again.','last_name','Payment\x20refund','•\x20New\x20payments\x0a','📱\x20API\x20error\x20notifications\x20disabled\x20for\x20shop\x20','findFirst','🏪\x20Gateway:\x20`','toString','secretKey','Check\x20spelling\x20and\x20try\x20again.','Commands:\x0a','notificationApiError','💸\x20Amount:\x20*','\x0a⚠️\x20If\x20this\x20wasn\x27t\x20you,\x20change\x20your\x20password\x20immediately!','initializeBot','50tqbrXp','🔔\x20You\x20will\x20now\x20receive\x20notifications\x20about:\x0a','toLocaleString'];a54_0x39e1=function(){return _0x16ac10;};return a54_0x39e1();}