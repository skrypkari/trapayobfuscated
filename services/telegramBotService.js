'use strict';const a59_0x33ec31=a59_0x876c;(function(_0x1388e6,_0x135bf5){const _0x11b692=a59_0x876c,_0x52f444=_0x1388e6();while(!![]){try{const _0x3ca508=-parseInt(_0x11b692(0x1df))/0x1+parseInt(_0x11b692(0x185))/0x2+parseInt(_0x11b692(0x19a))/0x3*(-parseInt(_0x11b692(0x211))/0x4)+-parseInt(_0x11b692(0x255))/0x5+parseInt(_0x11b692(0x1a0))/0x6*(parseInt(_0x11b692(0x25c))/0x7)+-parseInt(_0x11b692(0x1f3))/0x8+-parseInt(_0x11b692(0x1ff))/0x9*(-parseInt(_0x11b692(0x1d5))/0xa);if(_0x3ca508===_0x135bf5)break;else _0x52f444['push'](_0x52f444['shift']());}catch(_0x4ce54a){_0x52f444['push'](_0x52f444['shift']());}}}(a59_0x4ea7,0x34168));var __importDefault=this&&this[a59_0x33ec31(0x250)]||function(_0x41dff7){const _0x40fe08=a59_0x33ec31;return _0x41dff7&&_0x41dff7[_0x40fe08(0x1c8)]?_0x41dff7:{'default':_0x41dff7};};function a59_0x4ea7(){const _0x26a396=['❌\x20An\x20error\x20occurred.\x20Please\x20try\x20again\x20later.','Username\x20must\x20contain\x20only\x20letters,\x20numbers\x20and\x20underscore\x20(3-50\x20characters).','👤\x20Username:\x20`','update','1471776yuemZj','🏦\x20Method:\x20`','\x20USD*\x0a','\x20disconnected\x20from\x20shop\x20','/disconnect\x20-\x20disconnect\x20from\x20notifications','setupBotHandlers','📝\x20Order\x20ID:\x20`','Markdown','Error\x20handling\x20/start\x20command:','Telegram\x20bot\x20not\x20initialized,\x20cannot\x20send\x20notification','Example:\x0a','status','1224243tJVzew','chargebackAmount','warn','\x20parts:\x20','🤖\x20Welcome\x20to\x20TRAPAY\x20notification\x20system!\x0a\x0a','error','`\x20not\x20found.\x0a\x0a','Error\x20handling\x20/status\x20command:','toLocaleString','telegramId','🔔\x20*','toString','📱\x20Telegram\x20notification:\x20gateway\x20\x22','📱\x20Created\x20new\x20Telegram\x20user:\x20','🔄\x20Reset\x20incomplete\x20verification\x20for\x20user\x20','errorMessage','📝\x20Format:\x20`username\x20api_key`\x0a\x0a','🔄\x20Processing\x20single-line\x20verification\x20for\x20user\x20','15252ozkygY','ipAddress','node-telegram-bot-api','txid','⏳\x20The\x20payment\x20is\x20currently\x20being\x20processed\x20by\x20the\x20gateway.\x0a','notificationApiError','✅\x20Welcome\x20back!\x0a\x0a','To\x20reconnect,\x20use\x20the\x20/start\x20command','\x22,\x20apiKey=\x22','failed','🎉\x20*Congratulations!*\x0a\x0a','...','getBotInfo','📅\x20Time:\x20','Use\x20/start\x20to\x20connect.','🚨\x20*API\x20Error*\x0a\x0a','✅\x20You\x20have\x20been\x20successfully\x20disconnected\x20from\x20shop\x20*','Payment\x20is\x20being\x20processed','default','Commands:\x0a','trapay_bot','Error\x20sending\x20shop\x20notification:','Payment\x20failed','\x20initialized\x20successfully','📱\x20Shop:\x20*','timestamp','You\x20are\x20already\x20connected\x20to\x20shop:\x20*','user\x20is\x20deactivated','Payout\x20rejected','statusCode','New\x20payout\x20created','bot','*.\x0a\x0a','📧\x20Email:\x20`','botUsername','Check\x20spelling\x20and\x20try\x20again.','chargeback','\x20(@','customerEmail','API\x20key\x20must\x20start\x20with\x20`pk\x5c_`\x20or\x20`sk\x5c_`.','stopPolling','/status\x20-\x20check\x20connection\x20status\x0a','updatedAt','.\x20*','•\x20Payment\x20status\x20changes\x0a','unknown\x20shop','📊\x20*Connection\x20Status*\x0a\x0a','🌐\x20IP\x20address:\x20`','name','chat\x20not\x20found','sendShopNotification','sendMessage','shopSettings','Contact\x20administrator.','amount','includes','userAgent','❌\x20API\x20key\x20does\x20not\x20match\x20shop\x20`','chat','💻\x20Browser:\x20`','❌\x20Shop\x20with\x20username\x20`','❌\x20Shop\x20`','handleSingleLineVerification','__importDefault','🆔\x20Request\x20ID:\x20`','`appple\x20pk_aa6450d3f57afbefbb0f3f5be5ce6cca13037536afc5ccf14c81a6cbc7a07de5`\x0a\x0a','success','\x20via\x20single-line\x20input','1383370ZKCNLb','TELEGRAM_BOT_USERNAME','\x20\x20\x20Status:\x20','`\x20(','createdAt','...\x22','🔔\x20You\x20receive\x20notifications\x20about:\x0a','49HBtTwJ','findUnique','❌\x20Error\x20getting\x20debug\x20information.','log','🏪\x20Available\x20shops\x20in\x20system:\x0a','🛑\x20Telegram\x20bot\x20stopped','Disconnect\x20the\x20previous\x20account\x20first\x20or\x20contact\x20administrator.','To\x20receive\x20payment\x20notifications,\x20send\x20your\x20credentials\x20in\x20one\x20line:\x0a\x0a','382002MQBvOV','sendPaymentNotification','Use\x20/status\x20to\x20check\x20status\x20or\x20/disconnect\x20to\x20disconnect.','•\x20Payouts\x0a\x0a','❌\x20An\x20error\x20occurred\x20while\x20verifying\x20data.','username','getGatewayDisplayNameForTelegram','gateway','✅\x20Telegram\x20bot\x20@','Telegram\x20bot\x20error:','❌\x20Invalid\x20API\x20key\x20format.\x0a\x0a','✅\x20Login\x20notification\x20sent\x20for\x20shop\x20','\x20marked\x20as\x20unverified\x20due\x20to\x20delivery\x20failure','findMany','📛\x20Name:\x20`','test','📝\x20Notes:\x20','TELEGRAM_BOT_TOKEN\x20not\x20found\x20in\x20environment\x20variables','💸\x20Amount:\x20*','customerIp','`\x0a\x0a','15hWJEOa','join','🔔\x20You\x20will\x20now\x20receive\x20notifications\x20about:\x0a','initializeBot','✅\x20Notification\x20sent\x20to\x20Telegram\x20user\x20','last_name','263046GQxvVH','You\x20sent\x20','🔌\x20User\x20','isVerified','sendPayoutNotification','Use\x20/start\x20to\x20begin.','en-US','❌\x20Invalid\x20username\x20format:\x20`','Failed\x20to\x20send\x20API\x20error\x20notification:','Telegram\x20bot\x20polling\x20error:','•\x20New\x20payments\x0a','publicKey','customerUa','length','Successful\x20login','\x0aCheck\x20spelling\x20and\x20try\x20again.',':\x20username=\x22','notificationLogin','startsWith','from','text','Payment\x20expired','*\x0a\x0a','defineProperty','User\x20','📅\x20Date:\x20','Payment\x20successfully\x20paid','✅\x20You\x20are\x20already\x20connected\x20to\x20shop\x20*','env','Payout\x20completed','split','🔍\x20*Debug\x20Information*\x0a\x0a','\x0a👤\x20*Customer\x20Information:*\x0a','🔗\x20Endpoint:\x20`','Payment\x20chargeback','sendApiErrorNotification','🏦\x20IBAN:\x20`','pk_','❌\x20Another\x20Telegram\x20account\x20is\x20already\x20connected\x20to\x20shop\x20`','remitterIban','__esModule','substring','No\x20verified\x20Telegram\x20users\x20found\x20for\x20shop\x20','allSettled','Error\x20handling\x20message:','Failed\x20to\x20send\x20login\x20notification:','../config/database','`.\x0a\x0a','customerName','message','❗️\x20Make\x20sure\x20to\x20separate\x20username\x20and\x20API\x20key\x20with\x20a\x20space!','shopId','secretKey','20bLUeqx','TELEGRAM_BOT_TOKEN','adminNotes','../types/gateway','onText','\x20\x20\x20Public\x20Key:\x20`','📊\x20Error\x20code:\x20`','processing','...`\x0a\x0a','📱\x20Login\x20notifications\x20disabled\x20for\x20shop\x20','76879NUuRMR','telegramUser','✅\x20You\x20have\x20been\x20successfully\x20connected\x20to\x20the\x20notification\x20system!\x0a\x0a','endpoint','Check\x20the\x20key\x20and\x20try\x20again.\x0a\x0a','shop','orderId','requestId','map','✅\x20Telegram\x20user\x20','🔔\x20Notifications\x20are\x20active\x0a\x0a','\x0a⚠️\x20If\x20this\x20wasn\x27t\x20you,\x20change\x20your\x20password\x20immediately!','method',':\x20`','TelegramBotService','•\x20Payouts\x0a'];a59_0x4ea7=function(){return _0x26a396;};return a59_0x4ea7();}function a59_0x876c(_0x401d62,_0x11de9b){const _0x4ea775=a59_0x4ea7();return a59_0x876c=function(_0x876c93,_0x5c44d7){_0x876c93=_0x876c93-0x17e;let _0x275708=_0x4ea775[_0x876c93];return _0x275708;},a59_0x876c(_0x401d62,_0x11de9b);}Object[a59_0x33ec31(0x1b7)](exports,a59_0x33ec31(0x1c8),{'value':!![]}),exports['telegramBotService']=exports[a59_0x33ec31(0x1ed)]=void 0x0;const node_telegram_bot_api_1=__importDefault(require(a59_0x33ec31(0x213))),database_1=__importDefault(require(a59_0x33ec31(0x1ce))),gateway_1=require(a59_0x33ec31(0x1d8));class TelegramBotService{constructor(){const _0x3b32f3=a59_0x33ec31;this[_0x3b32f3(0x230)]=null,this['botToken']=process[_0x3b32f3(0x1bc)][_0x3b32f3(0x1d6)]||'',this[_0x3b32f3(0x233)]=process['env'][_0x3b32f3(0x256)]||_0x3b32f3(0x225),this['botToken']?this[_0x3b32f3(0x19d)]():console['warn'](_0x3b32f3(0x196));}[a59_0x33ec31(0x19d)](){const _0x258b5b=a59_0x33ec31;try{this[_0x258b5b(0x230)]=new node_telegram_bot_api_1[(_0x258b5b(0x223))](this['botToken'],{'polling':!![]}),this[_0x258b5b(0x1f8)](),console[_0x258b5b(0x180)](_0x258b5b(0x18d)+this[_0x258b5b(0x233)]+_0x258b5b(0x228));}catch(_0x3db1d5){console[_0x258b5b(0x204)]('❌\x20Failed\x20to\x20initialize\x20Telegram\x20bot:',_0x3db1d5);}}[a59_0x33ec31(0x1f8)](){const _0x2eea0e=a59_0x33ec31;if(!this[_0x2eea0e(0x230)])return;this[_0x2eea0e(0x230)][_0x2eea0e(0x1d9)](/\/start/,async _0x496802=>{const _0x3d49cf=_0x2eea0e,_0x21824d=_0x496802['chat']['id'],_0x4908ba=_0x496802[_0x3d49cf(0x1b3)]?.['id'][_0x3d49cf(0x20a)](),_0x599ca7=_0x496802['from']?.[_0x3d49cf(0x18a)],_0x22fad1=_0x496802['from']?.['first_name'],_0x20ce9b=_0x496802[_0x3d49cf(0x1b3)]?.[_0x3d49cf(0x19f)];if(!_0x4908ba)return;try{let _0x20f1e5=await database_1['default'][_0x3d49cf(0x1e0)][_0x3d49cf(0x17e)]({'where':{'telegramId':_0x4908ba},'include':{'shop':!![]}});!_0x20f1e5?(_0x20f1e5=await database_1[_0x3d49cf(0x223)][_0x3d49cf(0x1e0)]['create']({'data':{'telegramId':_0x4908ba,'username':_0x599ca7,'firstName':_0x22fad1,'lastName':_0x20ce9b,'isVerified':![],'shopId':null},'include':{'shop':!![]}}),console[_0x3d49cf(0x180)](_0x3d49cf(0x20c)+_0x4908ba+_0x3d49cf(0x236)+_0x599ca7+')')):_0x20f1e5=await database_1[_0x3d49cf(0x223)][_0x3d49cf(0x1e0)]['update']({'where':{'telegramId':_0x4908ba},'data':{'username':_0x599ca7,'firstName':_0x22fad1,'lastName':_0x20ce9b},'include':{'shop':!![]}}),_0x20f1e5[_0x3d49cf(0x1a3)]&&_0x20f1e5[_0x3d49cf(0x1d3)]&&_0x20f1e5['shop']?await this[_0x3d49cf(0x230)]?.['sendMessage'](_0x21824d,_0x3d49cf(0x217)+(_0x3d49cf(0x22b)+_0x20f1e5[_0x3d49cf(0x1e4)][_0x3d49cf(0x241)]+'*\x0a')+('Username:\x20`'+_0x20f1e5['shop'][_0x3d49cf(0x18a)]+_0x3d49cf(0x199))+_0x3d49cf(0x25b)+'•\x20New\x20payments\x0a'+_0x3d49cf(0x23d)+_0x3d49cf(0x188)+_0x3d49cf(0x224)+_0x3d49cf(0x23a)+_0x3d49cf(0x1f7),{'parse_mode':_0x3d49cf(0x1fa)}):(_0x20f1e5[_0x3d49cf(0x1d3)]&&!_0x20f1e5[_0x3d49cf(0x1a3)]&&(await database_1[_0x3d49cf(0x223)][_0x3d49cf(0x1e0)][_0x3d49cf(0x1f2)]({'where':{'telegramId':_0x4908ba},'data':{'shopId':null,'isVerified':![]}}),console[_0x3d49cf(0x180)](_0x3d49cf(0x20d)+_0x4908ba)),await this[_0x3d49cf(0x230)]?.['sendMessage'](_0x21824d,_0x3d49cf(0x203)+_0x3d49cf(0x184)+_0x3d49cf(0x20f)+_0x3d49cf(0x1fd)+_0x3d49cf(0x252)+_0x3d49cf(0x1d2),{'parse_mode':_0x3d49cf(0x1fa)}));}catch(_0x4ca241){console[_0x3d49cf(0x204)](_0x3d49cf(0x1fb),_0x4ca241),await this[_0x3d49cf(0x230)]?.[_0x3d49cf(0x244)](_0x21824d,_0x3d49cf(0x1ef));}}),this['bot']['onText'](/\/disconnect/,async _0x57f521=>{const _0x51700d=_0x2eea0e,_0x310637=_0x57f521[_0x51700d(0x24b)]['id'],_0x25e05f=_0x57f521[_0x51700d(0x1b3)]?.['id'][_0x51700d(0x20a)]();if(!_0x25e05f)return;try{const _0x218527=await database_1[_0x51700d(0x223)][_0x51700d(0x1e0)][_0x51700d(0x17e)]({'where':{'telegramId':_0x25e05f},'include':{'shop':!![]}});if(!_0x218527||!_0x218527[_0x51700d(0x1a3)]||!_0x218527[_0x51700d(0x1d3)]){await this[_0x51700d(0x230)]?.[_0x51700d(0x244)](_0x310637,'❌\x20You\x20are\x20not\x20connected\x20to\x20the\x20notification\x20system.');return;}const _0xea3fa0=_0x218527['shop']?.[_0x51700d(0x241)]||_0x51700d(0x23e);await database_1[_0x51700d(0x223)][_0x51700d(0x1e0)][_0x51700d(0x1f2)]({'where':{'telegramId':_0x25e05f},'data':{'shopId':null,'isVerified':![]}}),console[_0x51700d(0x180)](_0x51700d(0x1a2)+_0x25e05f+_0x51700d(0x1f6)+_0x218527[_0x51700d(0x1d3)]),await this[_0x51700d(0x230)]?.[_0x51700d(0x244)](_0x310637,_0x51700d(0x221)+_0xea3fa0+'*.\x0a\x0a'+_0x51700d(0x218),{'parse_mode':'Markdown'});}catch(_0x2d4d8b){console['error']('Error\x20handling\x20/disconnect\x20command:',_0x2d4d8b),await this[_0x51700d(0x230)]?.['sendMessage'](_0x310637,_0x51700d(0x1ef));}}),this[_0x2eea0e(0x230)][_0x2eea0e(0x1d9)](/\/status/,async _0x32a5fd=>{const _0x102dd6=_0x2eea0e,_0x3dfbad=_0x32a5fd[_0x102dd6(0x24b)]['id'],_0x5cbe9c=_0x32a5fd[_0x102dd6(0x1b3)]?.['id'][_0x102dd6(0x20a)]();if(!_0x5cbe9c)return;try{const _0x3a42a9=await database_1[_0x102dd6(0x223)][_0x102dd6(0x1e0)]['findUnique']({'where':{'telegramId':_0x5cbe9c},'include':{'shop':!![]}});if(!_0x3a42a9){await this[_0x102dd6(0x230)]?.['sendMessage'](_0x3dfbad,'❌\x20You\x20are\x20not\x20registered\x20in\x20the\x20system.\x0a\x0a'+_0x102dd6(0x1a5));return;}if(!_0x3a42a9['isVerified']||!_0x3a42a9[_0x102dd6(0x1d3)]||!_0x3a42a9['shop']){await this['bot']?.['sendMessage'](_0x3dfbad,'❌\x20You\x20are\x20not\x20connected\x20to\x20a\x20shop.\x0a\x0a'+_0x102dd6(0x21f));return;}await this['bot']?.['sendMessage'](_0x3dfbad,_0x102dd6(0x23f)+('✅\x20Connected\x20to\x20shop:\x20*'+_0x3a42a9[_0x102dd6(0x1e4)]['name']+'*\x0a')+(_0x102dd6(0x1f1)+_0x3a42a9['shop'][_0x102dd6(0x18a)]+'`\x0a')+('📅\x20Connection\x20date:\x20'+_0x3a42a9[_0x102dd6(0x23b)]['toLocaleDateString'](_0x102dd6(0x1a6))+'\x0a\x0a')+_0x102dd6(0x1e9)+_0x102dd6(0x224)+_0x102dd6(0x1f7),{'parse_mode':'Markdown'});}catch(_0x108f06){console[_0x102dd6(0x204)](_0x102dd6(0x206),_0x108f06),await this['bot']?.[_0x102dd6(0x244)](_0x3dfbad,'❌\x20An\x20error\x20occurred.\x20Please\x20try\x20again\x20later.');}}),this['bot'][_0x2eea0e(0x1d9)](/\/debug/,async _0x4bcfbb=>{const _0x214f1e=_0x2eea0e,_0xb1e6f6=_0x4bcfbb[_0x214f1e(0x24b)]['id'],_0x2d9a89=_0x4bcfbb[_0x214f1e(0x1b3)]?.['id'][_0x214f1e(0x20a)]();if(!_0x2d9a89)return;try{const _0x4b366e=await database_1[_0x214f1e(0x223)][_0x214f1e(0x1e4)][_0x214f1e(0x192)]({'select':{'id':!![],'name':!![],'username':!![],'status':!![],'publicKey':!![]},'take':0xa});let _0x16e52d=_0x214f1e(0x1bf);_0x16e52d+='📱\x20Your\x20Telegram\x20ID:\x20`'+_0x2d9a89+'`\x0a\x0a',_0x16e52d+=_0x214f1e(0x181),_0x4b366e['forEach']((_0x132753,_0x2c3f97)=>{const _0x28f8c0=_0x214f1e;_0x16e52d+=_0x2c3f97+0x1+_0x28f8c0(0x23c)+_0x132753['name']+'*\x0a',_0x16e52d+='\x20\x20\x20Username:\x20`'+_0x132753['username']+'`\x0a',_0x16e52d+=_0x28f8c0(0x257)+_0x132753[_0x28f8c0(0x1fe)]+'\x0a',_0x16e52d+=_0x28f8c0(0x1da)+_0x132753[_0x28f8c0(0x1ab)]['substring'](0x0,0xf)+_0x28f8c0(0x1dd);}),await this[_0x214f1e(0x230)]?.['sendMessage'](_0xb1e6f6,_0x16e52d,{'parse_mode':_0x214f1e(0x1fa)});}catch(_0x324746){console[_0x214f1e(0x204)]('Error\x20handling\x20/debug\x20command:',_0x324746),await this[_0x214f1e(0x230)]?.[_0x214f1e(0x244)](_0xb1e6f6,_0x214f1e(0x17f));}}),this[_0x2eea0e(0x230)]['on'](_0x2eea0e(0x1d1),async _0x1b2769=>{const _0xf2b645=_0x2eea0e;if(_0x1b2769[_0xf2b645(0x1b4)]?.[_0xf2b645(0x1b2)]('/'))return;const _0x64b36=_0x1b2769[_0xf2b645(0x24b)]['id'],_0x2a9b68=_0x1b2769[_0xf2b645(0x1b3)]?.['id']['toString'](),_0x4c77d2=_0x1b2769['text']?.['trim']();if(!_0x2a9b68||!_0x4c77d2)return;try{const _0x22f5ae=await database_1[_0xf2b645(0x223)][_0xf2b645(0x1e0)][_0xf2b645(0x17e)]({'where':{'telegramId':_0x2a9b68},'include':{'shop':!![]}});if(!_0x22f5ae){await this[_0xf2b645(0x230)]?.[_0xf2b645(0x244)](_0x64b36,'❌\x20Please\x20use\x20/start\x20command\x20first');return;}if(_0x22f5ae[_0xf2b645(0x1a3)]&&_0x22f5ae['shopId']&&_0x22f5ae['shop']){await this[_0xf2b645(0x230)]?.[_0xf2b645(0x244)](_0x64b36,_0xf2b645(0x1bb)+_0x22f5ae[_0xf2b645(0x1e4)][_0xf2b645(0x241)]+_0xf2b645(0x231)+_0xf2b645(0x187),{'parse_mode':_0xf2b645(0x1fa)});return;}const _0x3bd62d=_0x4c77d2[_0xf2b645(0x1be)](/\s+/);if(_0x3bd62d[_0xf2b645(0x1ad)]!==0x2){await this['bot']?.['sendMessage'](_0x64b36,'❌\x20Invalid\x20format.\x20Please\x20send\x20exactly\x202\x20parts\x20separated\x20by\x20space:\x0a\x0a'+_0xf2b645(0x20f)+'Example:\x0a'+_0xf2b645(0x252)+(_0xf2b645(0x1a1)+_0x3bd62d[_0xf2b645(0x1ad)]+_0xf2b645(0x202)+_0x3bd62d[_0xf2b645(0x1e7)](_0x515b9f=>'`'+_0x515b9f+'`')[_0xf2b645(0x19b)](',\x20')),{'parse_mode':_0xf2b645(0x1fa)});return;}const [_0x5ee938,_0x93b97]=_0x3bd62d;console[_0xf2b645(0x180)](_0xf2b645(0x210)+_0x2a9b68+_0xf2b645(0x1b0)+_0x5ee938+_0xf2b645(0x219)+_0x93b97['substring'](0x0,0xa)+_0xf2b645(0x25a)),await this['handleSingleLineVerification'](_0x64b36,_0x2a9b68,_0x5ee938,_0x93b97);}catch(_0x17f8e1){console['error'](_0xf2b645(0x1cc),_0x17f8e1),await this['bot']?.[_0xf2b645(0x244)](_0x64b36,'❌\x20An\x20error\x20occurred.\x20Please\x20try\x20again\x20later.');}}),this[_0x2eea0e(0x230)]['on'](_0x2eea0e(0x204),_0x273eb1=>{const _0x5d9fd0=_0x2eea0e;console[_0x5d9fd0(0x204)](_0x5d9fd0(0x18e),_0x273eb1);}),this[_0x2eea0e(0x230)]['on']('polling_error',_0x18cbb1=>{const _0x143a6d=_0x2eea0e;console[_0x143a6d(0x204)](_0x143a6d(0x1a9),_0x18cbb1);});}async[a59_0x33ec31(0x24f)](_0x3ae591,_0x41e8fe,_0x8c1b85,_0x205bfb){const _0x3fae38=a59_0x33ec31;try{console[_0x3fae38(0x180)](_0x3fae38(0x210)+_0x41e8fe+':\x20username=\x22'+_0x8c1b85+_0x3fae38(0x219)+_0x205bfb[_0x3fae38(0x1c9)](0x0,0xa)+_0x3fae38(0x25a));if(!_0x8c1b85||_0x8c1b85['length']<0x3||_0x8c1b85[_0x3fae38(0x1ad)]>0x32||!/^[a-zA-Z0-9_]+$/[_0x3fae38(0x194)](_0x8c1b85)){await this[_0x3fae38(0x230)]?.[_0x3fae38(0x244)](_0x3ae591,_0x3fae38(0x1a7)+_0x8c1b85+_0x3fae38(0x199)+_0x3fae38(0x1f0),{'parse_mode':_0x3fae38(0x1fa)});return;}if(!_0x205bfb||!_0x205bfb['startsWith'](_0x3fae38(0x1c5))&&!_0x205bfb['startsWith']('sk_')){await this[_0x3fae38(0x230)]?.[_0x3fae38(0x244)](_0x3ae591,_0x3fae38(0x18f)+_0x3fae38(0x238),{'parse_mode':_0x3fae38(0x1fa)});return;}const _0xf55a5a=await database_1[_0x3fae38(0x223)][_0x3fae38(0x1e4)]['findUnique']({'where':{'username':_0x8c1b85},'select':{'id':!![],'name':!![],'username':!![],'status':!![],'publicKey':!![],'secretKey':!![]}});if(!_0xf55a5a){const _0x4406e=await database_1[_0x3fae38(0x223)][_0x3fae38(0x1e4)][_0x3fae38(0x192)]({'select':{'username':!![],'name':!![]},'take':0x5});let _0x1081bb=_0x3fae38(0x24d)+_0x8c1b85+_0x3fae38(0x205);_0x4406e[_0x3fae38(0x1ad)]>0x0?(_0x1081bb+='Available\x20usernames:\x0a',_0x4406e['forEach'](_0xe25b18=>{const _0x270e75=_0x3fae38;_0x1081bb+='•\x20`'+_0xe25b18['username']+_0x270e75(0x258)+_0xe25b18[_0x270e75(0x241)]+')\x0a';}),_0x1081bb+=_0x3fae38(0x1af)):_0x1081bb+=_0x3fae38(0x234);await this[_0x3fae38(0x230)]?.[_0x3fae38(0x244)](_0x3ae591,_0x1081bb,{'parse_mode':_0x3fae38(0x1fa)});return;}if(_0xf55a5a[_0x3fae38(0x1fe)]!=='ACTIVE'){await this['bot']?.[_0x3fae38(0x244)](_0x3ae591,_0x3fae38(0x24e)+_0x8c1b85+'`\x20is\x20inactive.\x0a\x0a'+_0x3fae38(0x246),{'parse_mode':_0x3fae38(0x1fa)});return;}if(_0xf55a5a[_0x3fae38(0x1ab)]!==_0x205bfb&&_0xf55a5a[_0x3fae38(0x1d4)]!==_0x205bfb){await this[_0x3fae38(0x230)]?.['sendMessage'](_0x3ae591,_0x3fae38(0x24a)+_0x8c1b85+'`.\x0a\x0a'+_0x3fae38(0x1e3)+'Expected\x20key\x20format:\x20`pk_...`\x20or\x20`sk_...`',{'parse_mode':_0x3fae38(0x1fa)});return;}const _0x43e790=await database_1[_0x3fae38(0x223)][_0x3fae38(0x1e0)]['findFirst']({'where':{'shopId':_0xf55a5a['id'],'isVerified':!![],'telegramId':{'not':_0x41e8fe}}});if(_0x43e790){await this['bot']?.[_0x3fae38(0x244)](_0x3ae591,_0x3fae38(0x1c6)+_0x8c1b85+_0x3fae38(0x1cf)+_0x3fae38(0x183),{'parse_mode':_0x3fae38(0x1fa)});return;}await database_1[_0x3fae38(0x223)]['telegramUser'][_0x3fae38(0x1f2)]({'where':{'telegramId':_0x41e8fe},'data':{'shopId':_0xf55a5a['id'],'isVerified':!![]}}),await this[_0x3fae38(0x230)]?.[_0x3fae38(0x244)](_0x3ae591,_0x3fae38(0x21b)+_0x3fae38(0x1e1)+(_0x3fae38(0x229)+_0xf55a5a['name']+'*\x0a')+('👤\x20Username:\x20`'+_0xf55a5a['username']+'`\x0a\x0a')+_0x3fae38(0x19c)+_0x3fae38(0x1aa)+_0x3fae38(0x23d)+_0x3fae38(0x1ee)+'•\x20Important\x20events\x0a\x0a'+_0x3fae38(0x224)+_0x3fae38(0x23a)+_0x3fae38(0x1f7),{'parse_mode':'Markdown'}),console['log'](_0x3fae38(0x1e8)+_0x41e8fe+'\x20verified\x20for\x20shop\x20'+_0xf55a5a[_0x3fae38(0x18a)]+_0x3fae38(0x254));}catch(_0x14b9a8){console[_0x3fae38(0x204)]('Error\x20in\x20handleSingleLineVerification:',_0x14b9a8),await this[_0x3fae38(0x230)]?.['sendMessage'](_0x3ae591,_0x3fae38(0x189));}}async['sendShopNotification'](_0x3c5b25,_0x474c0f,_0x15e844){const _0x15908d=a59_0x33ec31;if(!this[_0x15908d(0x230)]){console[_0x15908d(0x201)](_0x15908d(0x1fc));return;}try{const _0x46e77b=await database_1['default'][_0x15908d(0x1e0)][_0x15908d(0x192)]({'where':{'shopId':_0x3c5b25,'isVerified':!![]}});if(_0x46e77b[_0x15908d(0x1ad)]===0x0){console[_0x15908d(0x180)](_0x15908d(0x1ca)+_0x3c5b25);return;}const _0x23e318=_0x46e77b[_0x15908d(0x1e7)](async _0x36a503=>{const _0x382fb3=_0x15908d;try{await this[_0x382fb3(0x230)]?.[_0x382fb3(0x244)](_0x36a503['telegramId'],_0x474c0f,_0x15e844),console[_0x382fb3(0x180)](_0x382fb3(0x19e)+_0x36a503[_0x382fb3(0x208)]);}catch(_0x45c4c1){console[_0x382fb3(0x204)]('❌\x20Failed\x20to\x20send\x20notification\x20to\x20Telegram\x20user\x20'+_0x36a503['telegramId']+':',_0x45c4c1),_0x45c4c1 instanceof Error&&(_0x45c4c1[_0x382fb3(0x1d1)][_0x382fb3(0x248)]('blocked')||_0x45c4c1[_0x382fb3(0x1d1)][_0x382fb3(0x248)](_0x382fb3(0x242))||_0x45c4c1['message']['includes'](_0x382fb3(0x22c)))&&(await database_1[_0x382fb3(0x223)][_0x382fb3(0x1e0)][_0x382fb3(0x1f2)]({'where':{'id':_0x36a503['id']},'data':{'isVerified':![]}}),console['log'](_0x382fb3(0x1b8)+_0x36a503[_0x382fb3(0x208)]+_0x382fb3(0x191)));}});await Promise[_0x15908d(0x1cb)](_0x23e318);}catch(_0x58e3ac){console[_0x15908d(0x204)](_0x15908d(0x226),_0x58e3ac);}}async[a59_0x33ec31(0x186)](_0x175dcb,_0x441b4d,_0x3471d4){const _0xc153c3=a59_0x33ec31,_0x325009={'created':'🆕','paid':'✅','failed':'❌','expired':'⏰','refund':'🔄','chargeback':'⚠️','processing':'⚙️'},_0xfc5a3f={'created':'New\x20payment\x20created','paid':_0xc153c3(0x1ba),'failed':_0xc153c3(0x227),'expired':_0xc153c3(0x1b5),'refund':'Payment\x20refund','chargeback':_0xc153c3(0x1c2),'processing':_0xc153c3(0x222)},_0x3208b1=_0x325009[_0x3471d4],_0x401378=_0xfc5a3f[_0x3471d4],_0x4bed11=(0x0,gateway_1[_0xc153c3(0x18b)])(_0x441b4d['gateway']);console[_0xc153c3(0x180)](_0xc153c3(0x20b)+_0x441b4d[_0xc153c3(0x18c)]+'\x22\x20->\x20display\x20\x22'+_0x4bed11+'\x22');let _0x21f997=_0x3208b1+'\x20*'+_0x401378+_0xc153c3(0x1b6)+('💰\x20Amount:\x20*'+_0x441b4d[_0xc153c3(0x247)]+'\x20'+_0x441b4d['currency']+'*\x0a')+(_0xc153c3(0x1f9)+(_0x441b4d[_0xc153c3(0x1e5)]||_0x441b4d['id'])+'`\x0a')+('🆔\x20Payment\x20ID:\x20`'+_0x441b4d['id']+'`\x0a')+('🏪\x20Gateway:\x20`'+_0x4bed11+'`\x0a')+(_0xc153c3(0x1b9)+new Date(_0x441b4d[_0xc153c3(0x259)])[_0xc153c3(0x207)](_0xc153c3(0x1a6))+'\x0a');if(_0x441b4d[_0xc153c3(0x1d0)]||_0x441b4d[_0xc153c3(0x237)]||_0x441b4d[_0xc153c3(0x1c7)]||_0x441b4d['customerIp']||_0x441b4d['customerUa']){_0x21f997+=_0xc153c3(0x1c0);_0x441b4d[_0xc153c3(0x1d0)]&&(_0x21f997+=_0xc153c3(0x193)+_0x441b4d['customerName']+'`\x0a');_0x441b4d['customerEmail']&&(_0x21f997+=_0xc153c3(0x232)+_0x441b4d[_0xc153c3(0x237)]+'`\x0a');_0x441b4d[_0xc153c3(0x1c7)]&&(_0x21f997+=_0xc153c3(0x1c4)+_0x441b4d['remitterIban']+'`\x0a');_0x441b4d['customerIp']&&(_0x21f997+='🌐\x20IP:\x20`'+_0x441b4d[_0xc153c3(0x198)]+'`\x0a');if(_0x441b4d[_0xc153c3(0x1ac)]){const _0x2745ed=_0x441b4d[_0xc153c3(0x1ac)][_0xc153c3(0x1ad)]>0x32?_0x441b4d[_0xc153c3(0x1ac)][_0xc153c3(0x1c9)](0x0,0x32)+_0xc153c3(0x21c):_0x441b4d[_0xc153c3(0x1ac)];_0x21f997+=_0xc153c3(0x24c)+_0x2745ed+'`\x0a';}}_0x3471d4===_0xc153c3(0x235)&&_0x441b4d[_0xc153c3(0x200)]&&(_0x21f997+='💸\x20Penalty\x20amount:\x20*'+_0x441b4d[_0xc153c3(0x200)]+'\x20USDT*\x0a'),_0x3471d4===_0xc153c3(0x1dc)&&(_0x21f997+=_0xc153c3(0x215)),_0x441b4d[_0xc153c3(0x1d7)]&&(_0x21f997+=_0xc153c3(0x195)+_0x441b4d['adminNotes']+'\x0a'),await this['sendShopNotification'](_0x175dcb,_0x21f997,{'parse_mode':'Markdown'});}async[a59_0x33ec31(0x1a4)](_0x26cacd,_0x5b923f,_0x13ea39){const _0x4e2eea=a59_0x33ec31,_0x233ad9={'created':'📤','completed':'✅','rejected':'❌'},_0x476b00={'created':_0x4e2eea(0x22f),'completed':_0x4e2eea(0x1bd),'rejected':_0x4e2eea(0x22d)},_0x50a9da=_0x233ad9[_0x13ea39],_0x9b408c=_0x476b00[_0x13ea39],_0x546d5b=_0x50a9da+'\x20*'+_0x9b408c+_0x4e2eea(0x1b6)+(_0x4e2eea(0x197)+_0x5b923f[_0x4e2eea(0x247)]+_0x4e2eea(0x1f5))+(_0x4e2eea(0x1f4)+_0x5b923f[_0x4e2eea(0x1eb)]+'`\x0a')+('🆔\x20Payout\x20ID:\x20`'+_0x5b923f['id']+'`\x0a')+(_0x4e2eea(0x1b9)+new Date(_0x5b923f[_0x4e2eea(0x259)])[_0x4e2eea(0x207)](_0x4e2eea(0x1a6))+'\x0a')+(_0x5b923f[_0x4e2eea(0x214)]?'🔗\x20TXID:\x20`'+_0x5b923f[_0x4e2eea(0x214)]+'`':'');await this['sendShopNotification'](_0x26cacd,_0x546d5b,{'parse_mode':_0x4e2eea(0x1fa)});}async['sendLoginNotification'](_0x4dc6be,_0x371d6c){const _0x5a72a5=a59_0x33ec31;try{const _0x5d2441=await database_1[_0x5a72a5(0x223)]['shopSettings'][_0x5a72a5(0x17e)]({'where':{'shopId':_0x4dc6be},'select':{'notificationLogin':!![]}});if(!_0x5d2441?.[_0x5a72a5(0x1b1)]){console[_0x5a72a5(0x180)](_0x5a72a5(0x1de)+_0x4dc6be);return;}const _0x36e185=_0x371d6c[_0x5a72a5(0x253)]?'🔐':'🚨',_0x363a7c=_0x371d6c['success']?_0x5a72a5(0x1ae):'Failed\x20login\x20attempt';let _0x75101b=_0x36e185+'\x20*'+_0x363a7c+_0x5a72a5(0x1b6)+(_0x5a72a5(0x1f1)+_0x371d6c[_0x5a72a5(0x18a)]+'`\x0a')+(_0x5a72a5(0x21e)+_0x371d6c[_0x5a72a5(0x22a)]['toLocaleString']('en-US')+'\x0a');_0x371d6c['ipAddress']&&(_0x75101b+=_0x5a72a5(0x240)+_0x371d6c[_0x5a72a5(0x212)]+'`\x0a');if(_0x371d6c[_0x5a72a5(0x249)]){const _0x45754b=_0x371d6c['userAgent'][_0x5a72a5(0x1ad)]>0x32?_0x371d6c[_0x5a72a5(0x249)]['substring'](0x0,0x32)+_0x5a72a5(0x21c):_0x371d6c['userAgent'];_0x75101b+=_0x5a72a5(0x24c)+_0x45754b+'`\x0a';}!_0x371d6c[_0x5a72a5(0x253)]&&(_0x75101b+=_0x5a72a5(0x1ea)),await this[_0x5a72a5(0x243)](_0x4dc6be,_0x75101b,{'parse_mode':_0x5a72a5(0x1fa)}),console['log'](_0x5a72a5(0x190)+_0x4dc6be+':\x20'+(_0x371d6c[_0x5a72a5(0x253)]?'success':_0x5a72a5(0x21a)));}catch(_0xbbc0ec){console[_0x5a72a5(0x204)](_0x5a72a5(0x1cd),_0xbbc0ec);}}async[a59_0x33ec31(0x1c3)](_0x2b6141,_0x1359dc){const _0x129c92=a59_0x33ec31;try{const _0xab14af=await database_1[_0x129c92(0x223)][_0x129c92(0x245)]['findUnique']({'where':{'shopId':_0x2b6141},'select':{'notificationApiError':!![]}});if(!_0xab14af?.[_0x129c92(0x216)]){console[_0x129c92(0x180)]('📱\x20API\x20error\x20notifications\x20disabled\x20for\x20shop\x20'+_0x2b6141);return;}let _0x2f8b62=_0x129c92(0x220)+(_0x129c92(0x1c1)+_0x1359dc[_0x129c92(0x1eb)]+'\x20'+_0x1359dc[_0x129c92(0x1e2)]+'`\x0a')+(_0x129c92(0x21e)+_0x1359dc[_0x129c92(0x22a)][_0x129c92(0x207)](_0x129c92(0x1a6))+'\x0a');_0x1359dc['statusCode']&&(_0x2f8b62+=_0x129c92(0x1db)+_0x1359dc[_0x129c92(0x22e)]+'`\x0a'),_0x2f8b62+='❌\x20Error:\x20`'+_0x1359dc[_0x129c92(0x20e)]+'`\x0a',_0x1359dc[_0x129c92(0x1e6)]&&(_0x2f8b62+=_0x129c92(0x251)+_0x1359dc[_0x129c92(0x1e6)]+'`\x0a'),_0x2f8b62+='\x0a💡\x20Check\x20your\x20request\x20or\x20contact\x20support.',await this[_0x129c92(0x243)](_0x2b6141,_0x2f8b62,{'parse_mode':_0x129c92(0x1fa)}),console[_0x129c92(0x180)]('✅\x20API\x20error\x20notification\x20sent\x20for\x20shop\x20'+_0x2b6141+':\x20'+_0x1359dc[_0x129c92(0x1e2)]);}catch(_0x411445){console[_0x129c92(0x204)](_0x129c92(0x1a8),_0x411445);}}async['sendCustomNotification'](_0x37b6b2,_0x259e6b,_0x2f2e01){const _0x2c6602=a59_0x33ec31;let _0x3478ba=_0x2c6602(0x209)+_0x259e6b+'*\x0a\x0a';for(const [_0x38c386,_0x4af889]of Object['entries'](_0x2f2e01)){_0x4af889!==null&&_0x4af889!==undefined&&(_0x3478ba+=_0x38c386+_0x2c6602(0x1ec)+_0x4af889+'`\x0a');}await this[_0x2c6602(0x243)](_0x37b6b2,_0x3478ba,{'parse_mode':_0x2c6602(0x1fa)});}[a59_0x33ec31(0x21d)](){const _0x462566=a59_0x33ec31;return{'isActive':!!this[_0x462566(0x230)],'username':this[_0x462566(0x233)]};}['stopBot'](){const _0x231eed=a59_0x33ec31;this[_0x231eed(0x230)]&&(this['bot'][_0x231eed(0x239)](),this[_0x231eed(0x230)]=null,console[_0x231eed(0x180)](_0x231eed(0x182)));}}exports[a59_0x33ec31(0x1ed)]=TelegramBotService,exports['telegramBotService']=new TelegramBotService();