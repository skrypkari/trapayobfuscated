'use strict';function a87_0xbf8d(){const _0xd7d0df=['processing','Step\x203/4:\x20Select\x20currency\x0a','No\x20verified\x20Telegram\x20users\x20found\x20for\x20shop\x20','\x20users\x20of\x20shop\x20','chargeback','üìù\x20Order\x20ID:\x20`','‚ùå\x20An\x20error\x20occurred\x20while\x20loading\x20payment\x20links.','geo','from','Error\x20getting\x20merchant\x20statistics:','network','cmd_back_to_menu','‚Ä¢\x20Usage\x20statistics\x0a','back_to_stats_menu','success','payment','1956385ewcvgn','INR','3EeLmcE',':\x20username=\x22','Gateway\x20-\x20','üì±\x20No\x20active\x20Telegram\x20users\x20found','‚ùå\x20Maximum\x20number\x20of\x20connected\x20accounts\x20(5)\x20reached\x20for\x20shop\x20`','.png','Error\x20handling\x20callback\x20query:','timestamp','sendDocument','ARS','adminNotes','EXPIRED','üìÖ\x20Connection\x20date:\x20','üìã\x20View\x20Payment\x20Links','log','answerCallbackQuery','Payment\x20failed','231QQhxjX','üì±\x20Your\x20Telegram\x20ID:\x20`','‚ùå\x20Failed\x20to\x20send\x20notification\x20to\x20Telegram\x20user\x20','Payment\x20expired','parse','üìÖ\x20Today','USD','RUB','ILS','‚ùå\x20Failed\x20to\x20initialize\x20Telegram\x20bot:','cmd_disconnect','chat\x20not\x20found','BYN','...','‚ùå\x20Invalid\x20username\x20format:\x20`','*\x0a\x0a','telegramUser','9SuMPRH','JPY','toString','Please\x20send\x20the\x20amount\x20in\x20','‚ùå\x20No\x20verified\x20Telegram\x20users\x20found\x20for\x20shop\x20ID:\x20','‚Ä¢\x20Dates\x20and\x20TX\x20IDs','‚ùå\x20Error\x20sending\x20file\x20to\x20shop:','shopId','https://trapay.uk/','üíª\x20Browser:\x20`','üí≥\x20*Wallet:*\x20`','toFixed','‚ùå\x20Shop\x20`','üí∞\x20Amount:\x20*','getGatewayCurrencies','txid','toLocaleDateString','\x5c)\x0a\x0a','API\x20key\x20must\x20start\x20with\x20`pk\x5c_`\x20or\x20`sk\x5c_`.','BTN','message_id','sk_','getBotInfo','BHD','‚úÖ\x20Login\x20notification\x20sent\x20for\x20shop\x20','stats_yesterday','getUTCFullYear','stopBot','üìõ\x20Name:\x20`','\x20\x20\x20Name:\x20*','Error\x20showing\x20payment\x20links\x20list:','‚ùå\x20No\x20gateways\x20configured.\x20Please\x20configure\x20gateways\x20in\x20the\x20admin\x20panel\x20first.','\x20parts:\x20','üìû\x20*Contacts*','amount','Payment\x20successfully\x20paid','KGS','üö®\x20*API\x20Error*\x0a\x0a','Example:\x0a','\x20USDC','üì±\x20Login\x20notifications\x20disabled\x20for\x20shop\x20','createdAt','108502gPanxM','üìÖ\x20Last\x20Month','TelegramBotService','‚ùå\x20Error\x20getting\x20statistics','IDR','initializeBot','image/jpeg','‚ùå\x20Error\x20sending\x20direct\x20message:','\x20verified\x20for\x20shop\x20','botToken','BAM','.jpeg','status','handleSingleLineVerification','üìä\x20Status','pl_cancel','sendDirectFile','‚ùå\x20Invalid\x20format.\x20Please\x20send\x20exactly\x202\x20parts\x20separated\x20by\x20space:\x0a\x0a','üí∞\x20Turnover\x20\x5c-\x20','‚ùóÔ∏è\x20Make\x20sure\x20to\x20separate\x20username\x20and\x20API\x20key\x20with\x20a\x20space!','map','‚ùå\x20Shop\x20not\x20found.\x20Please\x20start\x20over\x20with\x20/start','\x20via\x20single-line\x20input','üìä\x20*Statistics:\x20','To\x20reconnect,\x20use\x20the\x20/start\x20command','polling_error','BND','HKD','image/png','gateway','../types/gateway','sendDirectMessage','TWD','‚ùå\x20You\x20are\x20not\x20registered\x20in\x20the\x20system.\x0a\x0a','https://t.me/trapay_news','`\x20is\x20inactive.\x0a\x0a','‚Ä¢\x20Last\x205\x20payouts\x0a','bot','stats_last_month','editMessageText','VND','ceil','slice','AFN','‚ùå\x20An\x20error\x20occurred.\x20Please\x20try\x20again.','MYR','Username:\x20`','Check\x20the\x20key\x20and\x20try\x20again.\x0a\x0a','Not\x20specified','...\x22','NZD','`appple\x20pk_aa6450d3f57afbefbb0f3f5be5ce6cca13037536afc5ccf14c81a6cbc7a07de5`\x0a\x0a','set','customerUa','chat','padStart','onText','FJD','UAH','IQD','Error\x20handling\x20message:','‚¨ÖÔ∏è\x20Previous','Failed\x20to\x20send\x20API\x20error\x20notification:','handlePaymentLinkFlow','VUV','handleMerchantStatistics','\x0aüí°\x20Check\x20your\x20request\x20or\x20contact\x20support.','üîó\x20*Transaction\x20Link:*\x20Pending','üîÑ\x20Refunds\x20\x5c-\x20','showCurrencyPage','create','All\x20Time','üîî\x20You\x20receive\x20notifications\x20about:\x0a','step','paymentGateways','requestId','pl_page_','üìà\x20Conversion\x20\x5c-\x20','SAR','Error\x20handling\x20/statistics\x20command:','‚ùå\x20Please\x20use\x20/start\x20command\x20first','Error\x20handling\x20/debug\x20command:','LAK','payout','amountUSDT','üõë\x20Telegram\x20bot\x20stopped','BDT','updatedAt','cmd_payment_links','MVR','‚ûï\x20Create\x20New\x20Link','replace','üìû\x20Contacts','__esModule','showPaymentLinksList','Coming\x20soon...\x0a\x0a','Payment\x20is\x20being\x20processed','AED','trapay_bot','Step\x204/4:\x20Enter\x20amount\x0a\x0a','split','Use\x20/start\x20to\x20begin.','\x20marked\x20as\x20unverified\x20due\x20to\x20delivery\x20failure','‚Ä¢\x20Important\x20events','sendPayoutNotification','numeric','Payment\x20refund','SGD','CLP','Telegram\x20bot\x20polling\x20error:','update','sendNotificationToAll','substring','.pdf','UYU','üì¢\x20Telegram\x20channel','COP','Unknown','setupBotHandlers','‚ùå\x20Error\x20sending\x20file\x20to\x20user\x20','üåê\x20*Network:*\x20','üì±\x20Telegram\x20notification:\x20gateway\x20\x22','\x20\x20\x20Status:\x20','‚Ä¢\x20Payment\x20status\x20changes\x0a','application/octet-stream','isVerified','‚ôæÔ∏è\x20Multi\x20Use','üí∏\x20*Recent\x20Payouts*\x0a\x0a','REFUND','‚ùå\x20Telegram\x20bot\x20not\x20initialized','üë§\x20Username:\x20`','üìù\x20Format:\x20`username\x20api_key`\x0a\x0a','TELEGRAM_BOT_TOKEN\x20not\x20found\x20in\x20environment\x20variables','pk_','üåç\x20Country:\x20','‚¨ÖÔ∏è\x20Back','\x22\x20->\x20display\x20\x22','GATEWAY_ID_MAP','THB','Please\x20check\x20the\x20spelling\x20and\x20try\x20again.\x0a\x0a','üè¶\x20Gateway:\x20','shop','delete','endpoint','üîç\x20*Debug\x20Information*\x0a\x0a','‚úÖ\x20Connected\x20to\x20shop:\x20*','warn','BGN','‚ùå\x20Shop\x20not\x20found.','‚ùå\x20API\x20key\x20does\x20not\x20match\x20shop\x20`','UTC','pl_curr_page_','UZS','13KaPSZp','‚Ä¢\x20New\x20payments\x0a','‚ùå\x20You\x20are\x20not\x20connected\x20to\x20the\x20notification\x20system.','data','AZN','stats_this_month','findMany','137298XmUimx','MarkdownV2','error','PAID','üîó\x20*Create\x20Payment\x20Link*\x0a\x0a','üìÖ\x20This\x20Month','‚ùå\x20You\x20are\x20not\x20connected\x20to\x20any\x20shop.\x0a\x0a','MMK','üîî\x20*','TJS','/contacts\x20-\x20support\x20contacts\x0a','join','SBD','currency','üë§\x20Account','üíµ\x20Earned\x20\x5c-\x20','‚Ä¢\x20Transaction\x20status\x0a','Error\x20handling\x20/payment_links\x20command:','Use\x20/start\x20to\x20connect.','customerEmail','forEach','üìä\x20*Connection\x20Status*\x0a\x0a','username','Username\x20must\x20contain\x20only\x20letters,\x20numbers\x20and\x20underscore\x20(3-50\x20characters).','CZK','\x20(e.g.,\x20100)','‚è≥\x20Pending\x20payouts:\x20','HRK','LKR','pl_','balance','Error\x20in\x20handleSingleLineVerification:','paymentLinkSessions','üîó\x20*Payment\x20Links*\x0a\x0aChoose\x20an\x20action:','orderId','GBP','üìÖ\x20All\x20Time','getUTCDate','KES','Markdown','üÜî\x20Payment\x20ID:\x20`','PHP','ü§ñ\x20Welcome\x20to\x20TRAPAY\x20notification\x20system!\x0a\x0a','\x20\x20\x20[LINK](','SEK','Use\x20/status\x20to\x20check\x20status\x20or\x20/disconnect\x20to\x20disconnect.','get','üîå\x20Disconnect','COMPLETED','\x20\x20\x20Gateway:\x20','customerName','üìä\x20Error\x20code:\x20`','count','unknown\x20shop','message','\x0a‚ö†Ô∏è\x20If\x20this\x20wasn\x27t\x20you,\x20change\x20your\x20password\x20immediately!','\x22,\x20apiKey=\x22','type','2-digit','Error\x20handling\x20/status\x20command:','includes','‚Ä¢\x20Active\x20payment\x20links\x0a','‚ùå\x20Cancel','‚úÖ\x20Telegram\x20user\x20','\x20USDT*\x0a','üéâ\x20*Congratulations!*\x0a\x0a','üìÖ\x20Yesterday','üìã\x20*Payment\x20Links*\x0a\x0aNo\x20payment\x20links\x20found\x5c.\x0a\x0aCreate\x20your\x20first\x20payment\x20link\x5c!','cmd_status','pl_type_multi','*.\x0a\x0a','pl_curr_','findUnique','isValidGatewayId','üìù\x20Notes:\x20','GEL','KHR','üìÖ\x20Time:\x20','https://t.me/trapay_sales','‚Ä¢\x20Payouts\x0a','startsWith','üí∏\x20Payouts','Use\x20/start\x20to\x20connect\x20to\x20a\x20shop.','ZAR','‚ùå\x20Cancelled.','__importDefault','sendShopFile','getUTCMonth','Step\x202/4:\x20Select\x20link\x20type','Single\x20Use','toUpperCase','PEN','üí∏\x20*New\x20Payout*\x0a\x0a','default','pl_gw_','JOD','desc','getGatewayDisplayNameForTelegram','‚úÖ\x20Notification\x20sent\x20to\x20Telegram\x20user\x20','MXN','Error\x20handling\x20/disconnect\x20command:','currencyPage','customerIp','paymentLink','notificationLogin','endsWith','MAD','üåê\x20Website','name','‚úÖ\x20You\x20are\x20already\x20connected\x20to\x20shop\x20*','üì±\x20API\x20error\x20notifications\x20disabled\x20for\x20shop\x20','üîÑ\x20Processing\x20single-line\x20verification\x20for\x20user\x20','Error\x20handling\x20/start\x20command:','üåê\x20IP:\x20`','failed','1576528ESuJwW','botUsername','pl_create_new','üí∏\x20*Payouts*\x0a\x0a','trim','TND','`.\x0a\x0a','MNT','CHF','NGN','/payment\x5c_links\x20-\x20manage\x20payment\x20links\x0a','Telegram\x20bot\x20error:','stats_today','first_name','/statistics\x20-\x20view\x20your\x20statistics\x0a','üîó\x20*Create\x20Payment\x20Link*\x0a\x0aStep\x201/4:\x20Select\x20gateway','CNY','22700898fcDORm','`\x0a\x0a','You\x20sent\x20','cmd_contacts','12ZltOxw','stats_all_time','QAR','\x20(@','‚úÖ\x20*Payment\x20Link\x20Created\x20Successfully\x5c!*\x0a\x0a','AUD','Failed\x20to\x20send\x20login\x20notification:','text','PKR','push','üí∏\x20Penalty\x20amount:\x20*','\x20users','EUR','‚Ä¢\x20Amount\x20and\x20network\x0a','remitterIban','DKK','Make\x20sure\x20you\x20have\x20the\x20correct\x20username\x20from\x20your\x20account.','EGP','cmd_payouts','\x0aüë§\x20*Customer\x20Information:*\x0a','‚ùå\x20An\x20error\x20occurred\x20while\x20verifying\x20data.','LBP','Error\x20handling\x20/contacts\x20command:','telegramId','test','pl_type_single','‚ùå\x20Invalid\x20amount.\x20Please\x20enter\x20a\x20valid\x20number\x20greater\x20than\x200.','‚ùå\x20An\x20error\x20occurred.\x20Please\x20try\x20again\x20later.','PENDING','\x20\x5c|\x20Type:\x20','TOP','https://app.trapay.uk','/link/','‚Ä¢\x20Quick\x20create\x20new\x20link\x0a','‚Ä¢\x20Payouts','pl_view_list','This\x20feature\x20will\x20show:\x0a','RON','PGK','PLN','allSettled','chargebackAmount','üÜî\x20Request\x20ID:\x20`','totalPaidOut','\x20disconnected\x20from\x20shop\x20','CAD','KZT','üîó\x20*Transaction\x20Link:*\x20`','‚è≥\x20The\x20payment\x20is\x20currently\x20being\x20processed\x20by\x20the\x20gateway.\x0a','\x20\x20\x20Username:\x20`','RSD','SINGLE','Next\x20‚û°Ô∏è','KRW','2152972PsTbpR','pl_type_','HUF','1678460JhETMZ','üîå\x20User\x20','filter','MDL','‚úÖ\x20Telegram\x20bot\x20@','üîÑ\x20Reset\x20incomplete\x20verification\x20for\x20user\x20','NPR','en-US','\x20initialized\x20successfully','‚ùå\x20You\x20are\x20not\x20connected\x20to\x20a\x20shop.\x0a\x0a','all','NOK','telegramBotService','üîó\x20Payment\x20Links','TRY','ACTIVE','cmd_statistics','\x20-\x20','üì±\x20Available\x20Commands:\x0a','‚úÖ\x20Welcome\x20back!\x0a\x0a','Payment\x20chargeback','BRL','secretKey','sendLoginNotification','\x20USDC\x0a','sendShopNotification','.jpg','publicKey','‚ùå\x20Error\x20sending\x20file\x20to\x20chat:','stopPolling','shopSettings','üì±\x20Shop:\x20*','Error\x20handling\x20/payouts\x20command:','Disconnect\x20one\x20of\x20the\x20existing\x20accounts\x20first.','ipAddress','userAgent','callback_query','keys','`\x20not\x20found.\x0a\x0a','‚úÖ\x20You\x20have\x20been\x20successfully\x20connected\x20to\x20the\x20notification\x20system!\x0a\x0a','application/pdf','sendMessage','sendApiErrorNotification','‚ùå\x20Error\x20getting\x20debug\x20information.','‚ùå\x20Failed\x20to\x20send\x20notification\x20to\x20all\x20users:','üí¨\x20Support','üìä\x20Statistics','length','üîó\x20Link:\x20','üìä\x20*Statistics*\x0a\x0aSelect\x20period:','Multi\x20Use','CHARGEBACK'];a87_0xbf8d=function(){return _0xd7d0df;};return a87_0xbf8d();}const a87_0x4adc9b=a87_0x2455;(function(_0x3bf99d,_0x5b9f49){const _0x22aa75=a87_0x2455,_0x5c84a2=_0x3bf99d();while(!![]){try{const _0x7ce0b=-parseInt(_0x22aa75(0x1fe))/0x1*(parseInt(_0x22aa75(0x358))/0x2)+-parseInt(_0x22aa75(0x30c))/0x3*(parseInt(_0x22aa75(0x2c3))/0x4)+parseInt(_0x22aa75(0x30a))/0x5+parseInt(_0x22aa75(0x205))/0x6*(-parseInt(_0x22aa75(0x31d))/0x7)+-parseInt(_0x22aa75(0x278))/0x8*(parseInt(_0x22aa75(0x32e))/0x9)+parseInt(_0x22aa75(0x2c6))/0xa+parseInt(_0x22aa75(0x289))/0xb*(parseInt(_0x22aa75(0x28d))/0xc);if(_0x7ce0b===_0x5b9f49)break;else _0x5c84a2['push'](_0x5c84a2['shift']());}catch(_0x37cfb2){_0x5c84a2['push'](_0x5c84a2['shift']());}}}(a87_0xbf8d,0x6847a));function a87_0x2455(_0x6349bf,_0xe1d699){_0x6349bf=_0x6349bf-0x1bb;const _0xbf8db4=a87_0xbf8d();let _0x245536=_0xbf8db4[_0x6349bf];return _0x245536;}var __importDefault=this&&this[a87_0x4adc9b(0x25a)]||function(_0x1948b3){const _0x414cdb=a87_0x4adc9b;return _0x1948b3&&_0x1948b3[_0x414cdb(0x1c2)]?_0x1948b3:{'default':_0x1948b3};};Object['defineProperty'](exports,a87_0x4adc9b(0x1c2),{'value':!![]}),exports[a87_0x4adc9b(0x2d2)]=exports[a87_0x4adc9b(0x35a)]=void 0x0;const node_telegram_bot_api_1=__importDefault(require('node-telegram-bot-api')),database_1=__importDefault(require('../config/database')),gateway_1=require(a87_0x4adc9b(0x376));class TelegramBotService{constructor(){const _0x35892e=a87_0x4adc9b;this[_0x35892e(0x37d)]=null,this[_0x35892e(0x225)]=new Map(),this[_0x35892e(0x361)]=process.env.TELEGRAM_BOT_TOKEN||'',this[_0x35892e(0x279)]=process.env.TELEGRAM_BOT_USERNAME||_0x35892e(0x1c7),this['botToken']?this[_0x35892e(0x35d)]():console[_0x35892e(0x1f7)](_0x35892e(0x1e9));}[a87_0x4adc9b(0x35d)](){const _0x1b61ad=a87_0x4adc9b;try{this[_0x1b61ad(0x37d)]=new node_telegram_bot_api_1['default'](this[_0x1b61ad(0x361)],{'polling':!![]}),this[_0x1b61ad(0x1db)](),console[_0x1b61ad(0x31a)](_0x1b61ad(0x2ca)+this[_0x1b61ad(0x279)]+_0x1b61ad(0x2ce));}catch(_0x57ec2d){console[_0x1b61ad(0x207)](_0x1b61ad(0x326),_0x57ec2d);}}[a87_0x4adc9b(0x1db)](){const _0x45336b=a87_0x4adc9b;if(!this[_0x45336b(0x37d)])return;this[_0x45336b(0x37d)]['onText'](/\/start/,async _0x7f1ce=>{const _0x4336c5=_0x45336b,_0x2e10bc=_0x7f1ce[_0x4336c5(0x38e)]['id'],_0x40c9b2=_0x7f1ce['from']?.['id'][_0x4336c5(0x330)](),_0x1f9395=_0x7f1ce[_0x4336c5(0x302)]?.[_0x4336c5(0x21b)],_0x23e745=_0x7f1ce[_0x4336c5(0x302)]?.[_0x4336c5(0x285)],_0x57e91d=_0x7f1ce['from']?.['last_name'];if(!_0x40c9b2)return;try{let _0x5f3fdd=await database_1['default']['telegramUser'][_0x4336c5(0x24d)]({'where':{'telegramId':_0x40c9b2},'include':{'shop':!![]}});!_0x5f3fdd?(_0x5f3fdd=await database_1['default'][_0x4336c5(0x32d)][_0x4336c5(0x39e)]({'data':{'telegramId':_0x40c9b2,'username':_0x1f9395,'firstName':_0x23e745,'lastName':_0x57e91d,'isVerified':![],'shopId':null},'include':{'shop':!![]}}),console[_0x4336c5(0x31a)]('üì±\x20Created\x20new\x20Telegram\x20user:\x20'+_0x40c9b2+_0x4336c5(0x290)+_0x1f9395+')')):_0x5f3fdd=await database_1[_0x4336c5(0x262)][_0x4336c5(0x32d)][_0x4336c5(0x1d3)]({'where':{'telegramId':_0x40c9b2},'data':{'username':_0x1f9395,'firstName':_0x23e745,'lastName':_0x57e91d},'include':{'shop':!![]}}),_0x5f3fdd[_0x4336c5(0x1e2)]&&_0x5f3fdd[_0x4336c5(0x335)]&&_0x5f3fdd[_0x4336c5(0x1f2)]?await this['bot']?.[_0x4336c5(0x2ef)](_0x2e10bc,'‚úÖ\x20Welcome\x20back!\x0a\x0a'+('You\x20are\x20already\x20connected\x20to\x20shop:\x20*'+_0x5f3fdd[_0x4336c5(0x1f2)][_0x4336c5(0x271)]+'*\x0a')+(_0x4336c5(0x386)+_0x5f3fdd[_0x4336c5(0x1f2)][_0x4336c5(0x21b)]+_0x4336c5(0x28a))+_0x4336c5(0x3a0)+_0x4336c5(0x1ff)+_0x4336c5(0x1e0)+_0x4336c5(0x2af),{'parse_mode':_0x4336c5(0x22c),'reply_markup':{'inline_keyboard':[[{'text':'üìä\x20Statistics','callback_data':_0x4336c5(0x2d6)},{'text':_0x4336c5(0x256),'callback_data':_0x4336c5(0x29f)}],[{'text':'üîó\x20Payment\x20Links','callback_data':_0x4336c5(0x1bd)},{'text':_0x4336c5(0x366),'callback_data':_0x4336c5(0x249)}],[{'text':_0x4336c5(0x1c1),'callback_data':'cmd_contacts'},{'text':'üîå\x20Disconnect','callback_data':_0x4336c5(0x327)}]]}}):(_0x5f3fdd[_0x4336c5(0x335)]&&!_0x5f3fdd[_0x4336c5(0x1e2)]&&(await database_1[_0x4336c5(0x262)][_0x4336c5(0x32d)]['update']({'where':{'telegramId':_0x40c9b2},'data':{'shopId':null,'isVerified':![]}}),console[_0x4336c5(0x31a)](_0x4336c5(0x2cb)+_0x40c9b2)),await this[_0x4336c5(0x37d)]?.[_0x4336c5(0x2ef)](_0x2e10bc,_0x4336c5(0x22f)+'To\x20receive\x20payment\x20notifications,\x20send\x20your\x20credentials\x20in\x20one\x20line:\x0a\x0a'+_0x4336c5(0x1e8)+_0x4336c5(0x354)+'`appple\x20pk_aa6450d3f57afbefbb0f3f5be5ce6cca13037536afc5ccf14c81a6cbc7a07de5`\x0a\x0a'+_0x4336c5(0x36b),{'parse_mode':_0x4336c5(0x22c)}));}catch(_0x4f0293){console[_0x4336c5(0x207)](_0x4336c5(0x275),_0x4f0293),await this[_0x4336c5(0x37d)]?.[_0x4336c5(0x2ef)](_0x2e10bc,_0x4336c5(0x2a8));}}),this[_0x45336b(0x37d)][_0x45336b(0x390)](/\/disconnect/,async _0x520ef8=>{const _0x54977f=_0x45336b,_0x3c4ecf=_0x520ef8['chat']['id'],_0x27bfb8=_0x520ef8[_0x54977f(0x302)]?.['id'][_0x54977f(0x330)]();if(!_0x27bfb8)return;try{const _0x586af7=await database_1[_0x54977f(0x262)][_0x54977f(0x32d)]['findUnique']({'where':{'telegramId':_0x27bfb8},'include':{'shop':!![]}});if(!_0x586af7||!_0x586af7[_0x54977f(0x1e2)]||!_0x586af7[_0x54977f(0x335)]){await this[_0x54977f(0x37d)]?.[_0x54977f(0x2ef)](_0x3c4ecf,_0x54977f(0x200));return;}const _0x28b4f2=_0x586af7[_0x54977f(0x1f2)]?.[_0x54977f(0x271)]||_0x54977f(0x23a);await database_1[_0x54977f(0x262)][_0x54977f(0x32d)][_0x54977f(0x1d3)]({'where':{'telegramId':_0x27bfb8},'data':{'shopId':null,'isVerified':![]}}),console[_0x54977f(0x31a)](_0x54977f(0x2c7)+_0x27bfb8+_0x54977f(0x2b9)+_0x586af7[_0x54977f(0x335)]),await this[_0x54977f(0x37d)]?.[_0x54977f(0x2ef)](_0x3c4ecf,'‚úÖ\x20You\x20have\x20been\x20successfully\x20disconnected\x20from\x20shop\x20*'+_0x28b4f2+_0x54977f(0x24b)+'To\x20reconnect,\x20use\x20the\x20/start\x20command',{'parse_mode':_0x54977f(0x22c)});}catch(_0x109991){console['error'](_0x54977f(0x269),_0x109991),await this[_0x54977f(0x37d)]?.['sendMessage'](_0x3c4ecf,'‚ùå\x20An\x20error\x20occurred.\x20Please\x20try\x20again\x20later.');}}),this[_0x45336b(0x37d)][_0x45336b(0x390)](/\/status/,async _0x51ab1f=>{const _0x228176=_0x45336b,_0x2c86e5=_0x51ab1f[_0x228176(0x38e)]['id'],_0x1f250e=_0x51ab1f[_0x228176(0x302)]?.['id']['toString']();if(!_0x1f250e)return;try{const _0xe31612=await database_1[_0x228176(0x262)]['telegramUser']['findUnique']({'where':{'telegramId':_0x1f250e},'include':{'shop':!![]}});if(!_0xe31612){await this[_0x228176(0x37d)]?.[_0x228176(0x2ef)](_0x2c86e5,_0x228176(0x379)+_0x228176(0x1ca));return;}if(!_0xe31612[_0x228176(0x1e2)]||!_0xe31612['shopId']||!_0xe31612[_0x228176(0x1f2)]){await this[_0x228176(0x37d)]?.[_0x228176(0x2ef)](_0x2c86e5,_0x228176(0x2cf)+_0x228176(0x217));return;}await this[_0x228176(0x37d)]?.[_0x228176(0x2ef)](_0x2c86e5,_0x228176(0x21a)+(_0x228176(0x1f6)+_0xe31612[_0x228176(0x1f2)][_0x228176(0x271)]+'*\x0a')+('üë§\x20Username:\x20`'+_0xe31612[_0x228176(0x1f2)]['username']+'`\x0a')+('üìÖ\x20Connection\x20date:\x20'+_0xe31612['updatedAt']['toLocaleDateString']('en-US')+'\x0a\x0a')+'üîî\x20Notifications\x20are\x20active\x0a\x0a'+_0x228176(0x2d8)+_0x228176(0x286)+'/payouts\x20-\x20view\x20recent\x20payouts\x0a'+_0x228176(0x282)+_0x228176(0x20f)+'/disconnect\x20-\x20disconnect\x20from\x20notifications',{'parse_mode':_0x228176(0x22c)});}catch(_0x211e80){console[_0x228176(0x207)](_0x228176(0x240),_0x211e80),await this[_0x228176(0x37d)]?.['sendMessage'](_0x2c86e5,_0x228176(0x2a8));}}),this['bot'][_0x45336b(0x390)](/\/statistics/,async _0x29f5aa=>{const _0x4f591a=_0x45336b,_0x37c8a1=_0x29f5aa[_0x4f591a(0x38e)]['id'],_0x955764=_0x29f5aa[_0x4f591a(0x302)]?.['id'][_0x4f591a(0x330)]();if(!_0x955764)return;try{const _0x510a31=await database_1[_0x4f591a(0x262)][_0x4f591a(0x32d)][_0x4f591a(0x24d)]({'where':{'telegramId':_0x955764},'include':{'shop':!![]}});if(!_0x510a31?.[_0x4f591a(0x1e2)]||!_0x510a31[_0x4f591a(0x335)]){await this[_0x4f591a(0x37d)]?.[_0x4f591a(0x2ef)](_0x37c8a1,'‚ùå\x20You\x20are\x20not\x20connected\x20to\x20a\x20shop.\x0a\x0a'+_0x4f591a(0x217));return;}const _0x45bbc5={'inline_keyboard':[[{'text':_0x4f591a(0x322),'callback_data':_0x4f591a(0x284)}],[{'text':_0x4f591a(0x247),'callback_data':'stats_yesterday'}],[{'text':'üìÖ\x20This\x20Month','callback_data':'stats_this_month'}],[{'text':_0x4f591a(0x359),'callback_data':_0x4f591a(0x37e)}],[{'text':_0x4f591a(0x229),'callback_data':'stats_all_time'}],[{'text':_0x4f591a(0x1ec),'callback_data':_0x4f591a(0x305)}]]};await this[_0x4f591a(0x37d)]?.[_0x4f591a(0x2ef)](_0x37c8a1,_0x4f591a(0x2f7),{'parse_mode':_0x4f591a(0x22c),'reply_markup':_0x45bbc5});}catch(_0x153862){console[_0x4f591a(0x207)](_0x4f591a(0x3a7),_0x153862),await this[_0x4f591a(0x37d)]?.[_0x4f591a(0x2ef)](_0x37c8a1,'‚ùå\x20An\x20error\x20occurred.\x20Please\x20try\x20again\x20later.');}}),this[_0x45336b(0x37d)][_0x45336b(0x390)](/\/payouts/,async _0x5cbfb8=>{const _0x135cb1=_0x45336b,_0x6430f8=_0x5cbfb8[_0x135cb1(0x38e)]['id'],_0x2c883d=_0x5cbfb8[_0x135cb1(0x302)]?.['id']['toString']();if(!_0x2c883d)return;try{const _0x4f80c6=await database_1[_0x135cb1(0x262)][_0x135cb1(0x32d)][_0x135cb1(0x24d)]({'where':{'telegramId':_0x2c883d},'include':{'shop':!![]}});if(!_0x4f80c6?.[_0x135cb1(0x1e2)]||!_0x4f80c6[_0x135cb1(0x335)]){await this['bot']?.[_0x135cb1(0x2ef)](_0x6430f8,_0x135cb1(0x2cf)+'Use\x20/start\x20to\x20connect.');return;}await this[_0x135cb1(0x37d)]?.['sendMessage'](_0x6430f8,_0x135cb1(0x1e4)+_0x135cb1(0x1c4)+_0x135cb1(0x2b1)+_0x135cb1(0x37c)+_0x135cb1(0x29a)+_0x135cb1(0x215)+_0x135cb1(0x333),{'parse_mode':_0x135cb1(0x22c)});}catch(_0x9958ba){console['error'](_0x135cb1(0x2e6),_0x9958ba),await this[_0x135cb1(0x37d)]?.[_0x135cb1(0x2ef)](_0x6430f8,'‚ùå\x20An\x20error\x20occurred.\x20Please\x20try\x20again\x20later.');}}),this[_0x45336b(0x37d)][_0x45336b(0x390)](/\/payment_links/,async _0x159b6e=>{const _0x2c4df6=_0x45336b,_0x19610c=_0x159b6e[_0x2c4df6(0x38e)]['id'],_0x2487b9=_0x159b6e[_0x2c4df6(0x302)]?.['id'][_0x2c4df6(0x330)]();if(!_0x2487b9)return;try{const _0x5ab937=await database_1[_0x2c4df6(0x262)][_0x2c4df6(0x32d)][_0x2c4df6(0x24d)]({'where':{'telegramId':_0x2487b9},'include':{'shop':!![]}});if(!_0x5ab937?.[_0x2c4df6(0x1e2)]||!_0x5ab937[_0x2c4df6(0x335)]){await this[_0x2c4df6(0x37d)]?.[_0x2c4df6(0x2ef)](_0x19610c,_0x2c4df6(0x2cf)+_0x2c4df6(0x217));return;}await this['bot']?.[_0x2c4df6(0x2ef)](_0x19610c,'üîó\x20*Payment\x20Links*\x0a\x0a'+_0x2c4df6(0x1c4)+_0x2c4df6(0x2b1)+_0x2c4df6(0x242)+_0x2c4df6(0x306)+_0x2c4df6(0x2ae)+'‚Ä¢\x20Share\x20link\x20directly',{'parse_mode':'Markdown'});}catch(_0x3b6668){console[_0x2c4df6(0x207)](_0x2c4df6(0x216),_0x3b6668),await this['bot']?.[_0x2c4df6(0x2ef)](_0x19610c,'‚ùå\x20An\x20error\x20occurred.\x20Please\x20try\x20again\x20later.');}}),this[_0x45336b(0x37d)][_0x45336b(0x390)](/\/contacts/,async _0x59a129=>{const _0x52647a=_0x45336b,_0x254273=_0x59a129[_0x52647a(0x38e)]['id'];try{await this['bot']?.[_0x52647a(0x2ef)](_0x254273,'üìû\x20*Contacts*',{'parse_mode':_0x52647a(0x22c),'reply_markup':{'inline_keyboard':[[{'text':_0x52647a(0x270),'url':_0x52647a(0x336)}],[{'text':_0x52647a(0x213),'url':'https://app.trapay.uk/login'}],[{'text':_0x52647a(0x1d8),'url':_0x52647a(0x37a)}],[{'text':_0x52647a(0x2f3),'url':_0x52647a(0x253)}]]}});}catch(_0x4c081d){console[_0x52647a(0x207)](_0x52647a(0x2a3),_0x4c081d),await this[_0x52647a(0x37d)]?.['sendMessage'](_0x254273,_0x52647a(0x2a8));}}),this['bot']['on'](_0x45336b(0x2ea),async _0x159f9e=>{const _0x12b67f=_0x45336b,_0x332fcb=_0x159f9e[_0x12b67f(0x23b)],_0x332bf4=_0x332fcb?.[_0x12b67f(0x38e)]['id'],_0x39e827=_0x159f9e[_0x12b67f(0x302)]['id'][_0x12b67f(0x330)](),_0x40b5f6=_0x159f9e[_0x12b67f(0x201)];if(!_0x332bf4||!_0x40b5f6)return;try{await this[_0x12b67f(0x37d)]?.[_0x12b67f(0x31b)](_0x159f9e['id']);const _0x543f4b=await database_1[_0x12b67f(0x262)][_0x12b67f(0x32d)][_0x12b67f(0x24d)]({'where':{'telegramId':_0x39e827},'include':{'shop':!![]}});if(!_0x543f4b?.[_0x12b67f(0x1e2)]||!_0x543f4b[_0x12b67f(0x335)]){await this[_0x12b67f(0x37d)]?.[_0x12b67f(0x2ef)](_0x332bf4,'‚ùå\x20You\x20are\x20not\x20connected\x20to\x20a\x20shop.\x0a\x0aUse\x20/start\x20to\x20connect.');return;}switch(_0x40b5f6){case'cmd_statistics':const _0x32fd9e={'inline_keyboard':[[{'text':'üìÖ\x20Today','callback_data':_0x12b67f(0x284)}],[{'text':_0x12b67f(0x247),'callback_data':_0x12b67f(0x347)}],[{'text':_0x12b67f(0x20a),'callback_data':_0x12b67f(0x203)}],[{'text':_0x12b67f(0x359),'callback_data':_0x12b67f(0x37e)}],[{'text':_0x12b67f(0x229),'callback_data':_0x12b67f(0x28e)}],[{'text':_0x12b67f(0x1ec),'callback_data':_0x12b67f(0x305)}]]};await this[_0x12b67f(0x37d)]?.[_0x12b67f(0x2ef)](_0x332bf4,_0x12b67f(0x2f7),{'parse_mode':_0x12b67f(0x22c),'reply_markup':_0x32fd9e});break;case'stats_today':case _0x12b67f(0x347):case _0x12b67f(0x203):case _0x12b67f(0x37e):case _0x12b67f(0x28e):await this[_0x12b67f(0x399)](_0x332bf4,_0x543f4b[_0x12b67f(0x335)],_0x40b5f6,_0x332fcb?.[_0x12b67f(0x342)]);break;case _0x12b67f(0x307):const _0x1c07a5={'inline_keyboard':[[{'text':_0x12b67f(0x322),'callback_data':'stats_today'}],[{'text':'üìÖ\x20Yesterday','callback_data':_0x12b67f(0x347)}],[{'text':_0x12b67f(0x20a),'callback_data':_0x12b67f(0x203)}],[{'text':_0x12b67f(0x359),'callback_data':'stats_last_month'}],[{'text':'üìÖ\x20All\x20Time','callback_data':'stats_all_time'}],[{'text':_0x12b67f(0x1ec),'callback_data':'cmd_back_to_menu'}]]};_0x332fcb?.[_0x12b67f(0x342)]?await this[_0x12b67f(0x37d)]?.['editMessageText']('üìä\x20*Statistics*\x0a\x0aSelect\x20period:',{'chat_id':_0x332bf4,'message_id':_0x332fcb[_0x12b67f(0x342)],'parse_mode':_0x12b67f(0x22c),'reply_markup':_0x1c07a5}):await this[_0x12b67f(0x37d)]?.[_0x12b67f(0x2ef)](_0x332bf4,_0x12b67f(0x2f7),{'parse_mode':_0x12b67f(0x22c),'reply_markup':_0x1c07a5});break;case _0x12b67f(0x29f):const _0x4d906c=await database_1[_0x12b67f(0x262)][_0x12b67f(0x3ab)][_0x12b67f(0x204)]({'where':{'shopId':_0x543f4b[_0x12b67f(0x335)]},'orderBy':{'createdAt':_0x12b67f(0x265)}}),_0x2ad38a=_0x4d906c[_0x12b67f(0x2c8)](_0x14daae=>_0x14daae[_0x12b67f(0x364)]===_0x12b67f(0x2a9))['reduce']((_0x58f69e,_0x38716a)=>_0x58f69e+_0x38716a[_0x12b67f(0x350)],0x0),_0x319f7b=_0x4d906c['filter'](_0x114887=>_0x114887['status']===_0x12b67f(0x235))['reduce']((_0x13d882,_0x39323c)=>_0x13d882+_0x39323c[_0x12b67f(0x350)],0x0),_0x3acaba=(_0x543f4b['shop']?.[_0x12b67f(0x223)]||0x0)+(_0x543f4b[_0x12b67f(0x1f2)]?.[_0x12b67f(0x2b8)]||0x0);await this[_0x12b67f(0x37d)]?.[_0x12b67f(0x2ef)](_0x332bf4,_0x12b67f(0x27b)+(_0x12b67f(0x21f)+_0x2ad38a[_0x12b67f(0x339)](0x2)+_0x12b67f(0x2de))+('‚úÖ\x20Paid\x20out:\x20'+_0x319f7b[_0x12b67f(0x339)](0x2)+_0x12b67f(0x2de))+('üí∞\x20Total\x20earned:\x20'+_0x3acaba['toFixed'](0x2)+_0x12b67f(0x355)),{'parse_mode':_0x12b67f(0x22c),'reply_markup':{'inline_keyboard':[[{'text':_0x12b67f(0x1ec),'callback_data':'cmd_back_to_menu'}]]}});break;case _0x12b67f(0x1bd):await this[_0x12b67f(0x37d)]?.[_0x12b67f(0x2ef)](_0x332bf4,_0x12b67f(0x226),{'parse_mode':_0x12b67f(0x22c),'reply_markup':{'inline_keyboard':[[{'text':_0x12b67f(0x319),'callback_data':_0x12b67f(0x2b0)}],[{'text':_0x12b67f(0x1bf),'callback_data':_0x12b67f(0x27a)}],[{'text':_0x12b67f(0x1ec),'callback_data':_0x12b67f(0x305)}]]}});break;case _0x12b67f(0x249):await this['bot']?.[_0x12b67f(0x2ef)](_0x332bf4,_0x12b67f(0x21a)+(_0x12b67f(0x1f6)+(_0x543f4b[_0x12b67f(0x1f2)]?.[_0x12b67f(0x271)]||_0x12b67f(0x1da))+'*\x0a')+('üë§\x20Username:\x20`'+(_0x543f4b[_0x12b67f(0x1f2)]?.[_0x12b67f(0x21b)]||'Unknown')+'`\x0a')+(_0x12b67f(0x318)+_0x543f4b[_0x12b67f(0x1bc)][_0x12b67f(0x33e)](_0x12b67f(0x2cd))+'\x0a\x0a')+'üîî\x20Notifications\x20are\x20active',{'parse_mode':_0x12b67f(0x22c),'reply_markup':{'inline_keyboard':[[{'text':_0x12b67f(0x1ec),'callback_data':_0x12b67f(0x305)}]]}});break;case'cmd_contacts':await this['bot']?.[_0x12b67f(0x2ef)](_0x332bf4,_0x12b67f(0x34f),{'parse_mode':_0x12b67f(0x22c),'reply_markup':{'inline_keyboard':[[{'text':_0x12b67f(0x270),'url':_0x12b67f(0x336)}],[{'text':_0x12b67f(0x213),'url':'https://app.trapay.uk/login'}],[{'text':'üì¢\x20Telegram\x20channel','url':'https://t.me/trapay_news'}],[{'text':_0x12b67f(0x2f3),'url':_0x12b67f(0x253)}],[{'text':'‚¨ÖÔ∏è\x20Back','callback_data':_0x12b67f(0x305)}]]}});break;case _0x12b67f(0x305):await this[_0x12b67f(0x37d)]?.['sendMessage'](_0x332bf4,_0x12b67f(0x2d9)+('You\x20are\x20connected\x20to\x20shop:\x20*'+(_0x543f4b[_0x12b67f(0x1f2)]?.[_0x12b67f(0x271)]||_0x12b67f(0x1da))+'*\x0a')+(_0x12b67f(0x386)+(_0x543f4b['shop']?.[_0x12b67f(0x21b)]||'Unknown')+_0x12b67f(0x28a))+'üîî\x20You\x20receive\x20notifications\x20about:\x0a'+_0x12b67f(0x1ff)+_0x12b67f(0x1e0)+_0x12b67f(0x2af),{'parse_mode':_0x12b67f(0x22c),'reply_markup':{'inline_keyboard':[[{'text':_0x12b67f(0x2f4),'callback_data':_0x12b67f(0x2d6)},{'text':_0x12b67f(0x256),'callback_data':_0x12b67f(0x29f)}],[{'text':_0x12b67f(0x2d3),'callback_data':_0x12b67f(0x1bd)},{'text':_0x12b67f(0x366),'callback_data':'cmd_status'}],[{'text':_0x12b67f(0x1c1),'callback_data':_0x12b67f(0x28c)},{'text':_0x12b67f(0x234),'callback_data':_0x12b67f(0x327)}]]}});break;case _0x12b67f(0x327):await database_1[_0x12b67f(0x262)][_0x12b67f(0x32d)][_0x12b67f(0x1d3)]({'where':{'telegramId':_0x39e827},'data':{'shopId':null,'isVerified':![]}}),await this[_0x12b67f(0x37d)]?.['sendMessage'](_0x332bf4,'‚úÖ\x20You\x20have\x20been\x20successfully\x20disconnected\x20from\x20shop\x20*'+(_0x543f4b[_0x12b67f(0x1f2)]?.[_0x12b67f(0x271)]||_0x12b67f(0x1da))+_0x12b67f(0x24b)+_0x12b67f(0x370),{'parse_mode':_0x12b67f(0x22c)});break;default:_0x40b5f6[_0x12b67f(0x255)](_0x12b67f(0x222))?await this[_0x12b67f(0x397)](_0x332bf4,_0x39e827,_0x40b5f6,_0x159f9e[_0x12b67f(0x23b)]?.[_0x12b67f(0x342)]):await this[_0x12b67f(0x37d)]?.[_0x12b67f(0x2ef)](_0x332bf4,'‚ùå\x20Unknown\x20command');}}catch(_0x361b34){console[_0x12b67f(0x207)](_0x12b67f(0x312),_0x361b34),await this[_0x12b67f(0x37d)]?.[_0x12b67f(0x2ef)](_0x332bf4,'‚ùå\x20An\x20error\x20occurred.\x20Please\x20try\x20again\x20later.');}}),this[_0x45336b(0x37d)]['onText'](/\/debug/,async _0x23f591=>{const _0x1695ec=_0x45336b,_0x49e5c6=_0x23f591[_0x1695ec(0x38e)]['id'],_0x279f6e=_0x23f591[_0x1695ec(0x302)]?.['id'][_0x1695ec(0x330)]();if(!_0x279f6e)return;try{const _0x3c3934=await database_1[_0x1695ec(0x262)][_0x1695ec(0x32d)][_0x1695ec(0x24d)]({'where':{'telegramId':_0x279f6e},'include':{'shop':!![]}});let _0x4cf372=_0x1695ec(0x1f5);_0x4cf372+=_0x1695ec(0x31e)+_0x279f6e+'`\x0a\x0a',_0x3c3934?.['isVerified']&&_0x3c3934[_0x1695ec(0x1f2)]?(_0x4cf372+='üè™\x20Your\x20connected\x20shop:\x0a',_0x4cf372+=_0x1695ec(0x34b)+_0x3c3934[_0x1695ec(0x1f2)][_0x1695ec(0x271)]+'*\x0a',_0x4cf372+=_0x1695ec(0x2be)+_0x3c3934[_0x1695ec(0x1f2)][_0x1695ec(0x21b)]+'`\x0a',_0x4cf372+=_0x1695ec(0x1df)+_0x3c3934['shop']['status']+'\x0a\x0a'):_0x4cf372+=_0x1695ec(0x20b),_0x4cf372+=_0x1695ec(0x257),await this[_0x1695ec(0x37d)]?.['sendMessage'](_0x49e5c6,_0x4cf372,{'parse_mode':_0x1695ec(0x22c)});}catch(_0x12473e){console[_0x1695ec(0x207)](_0x1695ec(0x3a9),_0x12473e),await this[_0x1695ec(0x37d)]?.[_0x1695ec(0x2ef)](_0x49e5c6,_0x1695ec(0x2f1));}}),this[_0x45336b(0x37d)]['on'](_0x45336b(0x23b),async _0x547ff8=>{const _0x18f31c=_0x45336b;if(_0x547ff8[_0x18f31c(0x294)]?.[_0x18f31c(0x255)]('/'))return;const _0x24af39=_0x547ff8['chat']['id'],_0x535802=_0x547ff8[_0x18f31c(0x302)]?.['id']['toString'](),_0x268e93=_0x547ff8[_0x18f31c(0x294)]?.[_0x18f31c(0x27c)]();if(!_0x535802||!_0x268e93)return;try{const _0x5a5d71=this[_0x18f31c(0x225)][_0x18f31c(0x233)](_0x535802);if(_0x5a5d71&&_0x5a5d71['step']===_0x18f31c(0x350)){const _0x14d0f5=parseFloat(_0x268e93);if(isNaN(_0x14d0f5)||_0x14d0f5<=0x0){await this[_0x18f31c(0x37d)]?.[_0x18f31c(0x2ef)](_0x24af39,_0x18f31c(0x2a7));return;}const _0x1234c0=await database_1[_0x18f31c(0x262)][_0x18f31c(0x32d)]['findUnique']({'where':{'telegramId':_0x535802},'include':{'shop':!![]}});if(!_0x1234c0?.[_0x18f31c(0x335)]){await this['bot']?.[_0x18f31c(0x2ef)](_0x24af39,_0x18f31c(0x36d)),this[_0x18f31c(0x225)]['delete'](_0x535802);return;}const _0x18c992=(0x0,gateway_1[_0x18f31c(0x24e)])(_0x5a5d71[_0x18f31c(0x375)])?(0x0,gateway_1['getGatewayNameById'])(_0x5a5d71[_0x18f31c(0x375)]):_0x5a5d71['gateway'],_0x15cc39={'shopId':_0x1234c0[_0x18f31c(0x335)],'gateway':_0x18c992,'amount':_0x14d0f5,'currency':_0x5a5d71[_0x18f31c(0x212)],'type':_0x5a5d71[_0x18f31c(0x23e)],'status':_0x18f31c(0x2d5)},_0x18edbb=await database_1[_0x18f31c(0x262)][_0x18f31c(0x26c)][_0x18f31c(0x39e)]({'data':_0x15cc39});this['paymentLinkSessions'][_0x18f31c(0x1f3)](_0x535802);const _0x1874e4=(process.env.FRONTEND_URL||_0x18f31c(0x2ac))+_0x18f31c(0x2ad)+_0x18edbb['id'],_0x54c9de=_0x1874e4[_0x18f31c(0x1c0)](/\./g,'\x5c.')[_0x18f31c(0x1c0)](/-/g,'\x5c-')[_0x18f31c(0x1c0)](/\//g,'\x5c/');await this[_0x18f31c(0x37d)]?.[_0x18f31c(0x2ef)](_0x24af39,_0x18f31c(0x291)+(_0x18f31c(0x2f6)+_0x54c9de+'\x0a')+('üí∞\x20Amount:\x20'+_0x14d0f5+'\x20'+_0x5a5d71[_0x18f31c(0x212)]+'\x0a')+(_0x18f31c(0x1f1)+_0x5a5d71[_0x18f31c(0x375)]+'\x0a')+('üîÑ\x20Type:\x20'+(_0x5a5d71[_0x18f31c(0x23e)]===_0x18f31c(0x2c0)?_0x18f31c(0x25e):_0x18f31c(0x2f8))+'\x0a\x0a')+'Copy\x20and\x20share\x20this\x20link\x20with\x20your\x20customers\x5c!',{'parse_mode':_0x18f31c(0x206)});return;}const _0x424e71=await database_1[_0x18f31c(0x262)]['telegramUser'][_0x18f31c(0x24d)]({'where':{'telegramId':_0x535802},'include':{'shop':!![]}});if(!_0x424e71){await this[_0x18f31c(0x37d)]?.[_0x18f31c(0x2ef)](_0x24af39,_0x18f31c(0x3a8));return;}if(_0x424e71[_0x18f31c(0x1e2)]&&_0x424e71['shopId']&&_0x424e71[_0x18f31c(0x1f2)]){await this[_0x18f31c(0x37d)]?.[_0x18f31c(0x2ef)](_0x24af39,_0x18f31c(0x272)+_0x424e71[_0x18f31c(0x1f2)][_0x18f31c(0x271)]+_0x18f31c(0x24b)+_0x18f31c(0x232),{'parse_mode':_0x18f31c(0x22c)});return;}const _0x2866e4=_0x268e93['split'](/\s+/);if(_0x2866e4[_0x18f31c(0x2f5)]!==0x2){await this[_0x18f31c(0x37d)]?.[_0x18f31c(0x2ef)](_0x24af39,_0x18f31c(0x369)+_0x18f31c(0x1e8)+_0x18f31c(0x354)+_0x18f31c(0x38b)+(_0x18f31c(0x28b)+_0x2866e4[_0x18f31c(0x2f5)]+_0x18f31c(0x34e)+_0x2866e4['map'](_0x1b3947=>'`'+_0x1b3947+'`')[_0x18f31c(0x210)](',\x20')),{'parse_mode':_0x18f31c(0x22c)});return;}const [_0x37ae6b,_0x2c93af]=_0x2866e4;console[_0x18f31c(0x31a)]('üîÑ\x20Processing\x20single-line\x20verification\x20for\x20user\x20'+_0x535802+_0x18f31c(0x30d)+_0x37ae6b+'\x22,\x20apiKey=\x22'+_0x2c93af[_0x18f31c(0x1d5)](0x0,0xa)+'...\x22'),await this[_0x18f31c(0x365)](_0x24af39,_0x535802,_0x37ae6b,_0x2c93af);}catch(_0x3ac914){console[_0x18f31c(0x207)](_0x18f31c(0x394),_0x3ac914),await this[_0x18f31c(0x37d)]?.[_0x18f31c(0x2ef)](_0x24af39,'‚ùå\x20An\x20error\x20occurred.\x20Please\x20try\x20again\x20later.');}}),this['bot']['on']('error',_0x539f63=>{const _0x18271a=_0x45336b;console['error'](_0x18271a(0x283),_0x539f63);}),this['bot']['on'](_0x45336b(0x371),_0x429b58=>{const _0x46bd21=_0x45336b;console[_0x46bd21(0x207)](_0x46bd21(0x1d2),_0x429b58);});}async[a87_0x4adc9b(0x365)](_0x1fe6d6,_0x2617e6,_0x3e5bb8,_0x5102ba){const _0x2acd6a=a87_0x4adc9b;try{console[_0x2acd6a(0x31a)](_0x2acd6a(0x274)+_0x2617e6+_0x2acd6a(0x30d)+_0x3e5bb8+_0x2acd6a(0x23d)+_0x5102ba[_0x2acd6a(0x1d5)](0x0,0xa)+_0x2acd6a(0x389));if(!_0x3e5bb8||_0x3e5bb8[_0x2acd6a(0x2f5)]<0x3||_0x3e5bb8[_0x2acd6a(0x2f5)]>0x32||!/^[a-zA-Z0-9_]+$/[_0x2acd6a(0x2a5)](_0x3e5bb8)){await this['bot']?.[_0x2acd6a(0x2ef)](_0x1fe6d6,_0x2acd6a(0x32b)+_0x3e5bb8+_0x2acd6a(0x28a)+_0x2acd6a(0x21c),{'parse_mode':_0x2acd6a(0x22c)});return;}if(!_0x5102ba||!_0x5102ba[_0x2acd6a(0x255)](_0x2acd6a(0x1ea))&&!_0x5102ba[_0x2acd6a(0x255)](_0x2acd6a(0x343))){await this[_0x2acd6a(0x37d)]?.[_0x2acd6a(0x2ef)](_0x1fe6d6,'‚ùå\x20Invalid\x20API\x20key\x20format.\x0a\x0a'+_0x2acd6a(0x340),{'parse_mode':_0x2acd6a(0x22c)});return;}const _0xb8e5f4=await database_1[_0x2acd6a(0x262)][_0x2acd6a(0x1f2)][_0x2acd6a(0x24d)]({'where':{'username':_0x3e5bb8},'select':{'id':!![],'name':!![],'username':!![],'status':!![],'publicKey':!![],'secretKey':!![]}});if(!_0xb8e5f4){const _0x4a6720='‚ùå\x20Shop\x20with\x20username\x20`'+_0x3e5bb8+_0x2acd6a(0x2ec)+_0x2acd6a(0x1f0)+_0x2acd6a(0x29d);await this[_0x2acd6a(0x37d)]?.[_0x2acd6a(0x2ef)](_0x1fe6d6,_0x4a6720,{'parse_mode':'Markdown'});return;}if(_0xb8e5f4[_0x2acd6a(0x364)]!==_0x2acd6a(0x2d5)){await this[_0x2acd6a(0x37d)]?.['sendMessage'](_0x1fe6d6,_0x2acd6a(0x33a)+_0x3e5bb8+_0x2acd6a(0x37b)+'Contact\x20administrator.',{'parse_mode':'Markdown'});return;}if(_0xb8e5f4[_0x2acd6a(0x2e1)]!==_0x5102ba&&_0xb8e5f4[_0x2acd6a(0x2dc)]!==_0x5102ba){await this[_0x2acd6a(0x37d)]?.['sendMessage'](_0x1fe6d6,_0x2acd6a(0x1fa)+_0x3e5bb8+_0x2acd6a(0x27e)+_0x2acd6a(0x387)+'Expected\x20key\x20format:\x20`pk_...`\x20or\x20`sk_...`',{'parse_mode':'Markdown'});return;}const _0x57fcf8=await database_1[_0x2acd6a(0x262)][_0x2acd6a(0x32d)][_0x2acd6a(0x239)]({'where':{'shopId':_0xb8e5f4['id'],'isVerified':!![]}});if(_0x57fcf8>=0x5){await this['bot']?.[_0x2acd6a(0x2ef)](_0x1fe6d6,_0x2acd6a(0x310)+_0x3e5bb8+_0x2acd6a(0x27e)+_0x2acd6a(0x2e7),{'parse_mode':_0x2acd6a(0x22c)});return;}await database_1[_0x2acd6a(0x262)][_0x2acd6a(0x32d)]['update']({'where':{'telegramId':_0x2617e6},'data':{'shopId':_0xb8e5f4['id'],'isVerified':!![]}}),await this[_0x2acd6a(0x37d)]?.[_0x2acd6a(0x2ef)](_0x1fe6d6,_0x2acd6a(0x246)+_0x2acd6a(0x2ed)+(_0x2acd6a(0x2e5)+_0xb8e5f4[_0x2acd6a(0x271)]+'*\x0a')+('üë§\x20Username:\x20`'+_0xb8e5f4['username']+_0x2acd6a(0x28a))+'üîî\x20You\x20will\x20now\x20receive\x20notifications\x20about:\x0a'+'‚Ä¢\x20New\x20payments\x0a'+'‚Ä¢\x20Payment\x20status\x20changes\x0a'+_0x2acd6a(0x254)+_0x2acd6a(0x1cc),{'parse_mode':_0x2acd6a(0x22c),'reply_markup':{'inline_keyboard':[[{'text':_0x2acd6a(0x2f4),'callback_data':_0x2acd6a(0x2d6)},{'text':_0x2acd6a(0x256),'callback_data':'cmd_payouts'}],[{'text':_0x2acd6a(0x2d3),'callback_data':'cmd_payment_links'},{'text':_0x2acd6a(0x366),'callback_data':_0x2acd6a(0x249)}],[{'text':_0x2acd6a(0x1c1),'callback_data':_0x2acd6a(0x28c)},{'text':_0x2acd6a(0x234),'callback_data':_0x2acd6a(0x327)}]]}}),console['log'](_0x2acd6a(0x244)+_0x2617e6+_0x2acd6a(0x360)+_0xb8e5f4[_0x2acd6a(0x21b)]+_0x2acd6a(0x36e));}catch(_0x2c4ba4){console['error'](_0x2acd6a(0x224),_0x2c4ba4),await this[_0x2acd6a(0x37d)]?.[_0x2acd6a(0x2ef)](_0x1fe6d6,_0x2acd6a(0x2a1));}}async[a87_0x4adc9b(0x2df)](_0x5104a7,_0x4d1d09,_0x5faeae){const _0xb70e6e=a87_0x4adc9b;if(!this[_0xb70e6e(0x37d)]){console[_0xb70e6e(0x1f7)]('Telegram\x20bot\x20not\x20initialized,\x20cannot\x20send\x20notification');return;}try{const _0x460fcc=await database_1[_0xb70e6e(0x262)][_0xb70e6e(0x32d)][_0xb70e6e(0x204)]({'where':{'shopId':_0x5104a7,'isVerified':!![]}});if(_0x460fcc['length']===0x0){console[_0xb70e6e(0x31a)](_0xb70e6e(0x2fc)+_0x5104a7);return;}const _0x2199cf=_0x460fcc[_0xb70e6e(0x36c)](async _0xc389e6=>{const _0x47b2f3=_0xb70e6e;try{await this['bot']?.[_0x47b2f3(0x2ef)](_0xc389e6[_0x47b2f3(0x2a4)],_0x4d1d09,_0x5faeae),console[_0x47b2f3(0x31a)](_0x47b2f3(0x267)+_0xc389e6[_0x47b2f3(0x2a4)]);}catch(_0x190590){console['error'](_0x47b2f3(0x31f)+_0xc389e6[_0x47b2f3(0x2a4)]+':',_0x190590),_0x190590 instanceof Error&&(_0x190590['message'][_0x47b2f3(0x241)]('blocked')||_0x190590[_0x47b2f3(0x23b)][_0x47b2f3(0x241)](_0x47b2f3(0x328))||_0x190590['message'][_0x47b2f3(0x241)]('user\x20is\x20deactivated'))&&(await database_1['default'][_0x47b2f3(0x32d)][_0x47b2f3(0x1d3)]({'where':{'id':_0xc389e6['id']},'data':{'isVerified':![]}}),console[_0x47b2f3(0x31a)]('User\x20'+_0xc389e6[_0x47b2f3(0x2a4)]+_0x47b2f3(0x1cb)));}});await Promise[_0xb70e6e(0x2b5)](_0x2199cf);}catch(_0x4e6a28){console['error']('Error\x20sending\x20shop\x20notification:',_0x4e6a28);}}async['sendPaymentNotification'](_0x1dd6d0,_0x131f6f,_0x2a7415){const _0x8a99ca=a87_0x4adc9b,_0x1fc755={'created':'üÜï','paid':'‚úÖ','failed':'‚ùå','expired':'‚è∞','refund':'üîÑ','chargeback':'‚ö†Ô∏è','processing':'‚öôÔ∏è'},_0x2c7cec={'created':'New\x20payment\x20created','paid':_0x8a99ca(0x351),'failed':_0x8a99ca(0x31c),'expired':_0x8a99ca(0x320),'refund':_0x8a99ca(0x1cf),'chargeback':_0x8a99ca(0x2da),'processing':_0x8a99ca(0x1c5)},_0x4423a5=_0x1fc755[_0x2a7415],_0x26141d=_0x2c7cec[_0x2a7415],_0x1e94e7=(0x0,gateway_1[_0x8a99ca(0x266)])(_0x131f6f[_0x8a99ca(0x375)]);console[_0x8a99ca(0x31a)](_0x8a99ca(0x1de)+_0x131f6f[_0x8a99ca(0x375)]+_0x8a99ca(0x1ed)+_0x1e94e7+'\x22');let _0x5361a7=_0x4423a5+'\x20*'+_0x26141d+'*\x0a\x0a'+(_0x8a99ca(0x33b)+_0x131f6f['amount']+'\x20'+_0x131f6f[_0x8a99ca(0x212)]+'*\x0a')+(_0x8a99ca(0x2ff)+(_0x131f6f[_0x8a99ca(0x227)]||_0x131f6f['id'])+'`\x0a')+(_0x8a99ca(0x22d)+_0x131f6f['id']+'`\x0a')+('üè™\x20Gateway:\x20`'+_0x1e94e7+'`\x0a')+('üìÖ\x20Date:\x20'+new Date(_0x131f6f['createdAt'])['toLocaleString']('en-US')+'\x0a');if(_0x131f6f[_0x8a99ca(0x237)]||_0x131f6f['customerEmail']||_0x131f6f[_0x8a99ca(0x29b)]||_0x131f6f[_0x8a99ca(0x26b)]||_0x131f6f[_0x8a99ca(0x38d)]){_0x5361a7+=_0x8a99ca(0x2a0);_0x131f6f[_0x8a99ca(0x237)]&&(_0x5361a7+=_0x8a99ca(0x34a)+_0x131f6f[_0x8a99ca(0x237)]+'`\x0a');_0x131f6f[_0x8a99ca(0x218)]&&(_0x5361a7+='üìß\x20Email:\x20`'+_0x131f6f[_0x8a99ca(0x218)]+'`\x0a');_0x131f6f['remitterIban']&&(_0x5361a7+='üè¶\x20IBAN:\x20`'+_0x131f6f[_0x8a99ca(0x29b)]+'`\x0a');_0x131f6f[_0x8a99ca(0x26b)]&&(_0x5361a7+=_0x8a99ca(0x276)+_0x131f6f['customerIp']+'`\x0a');if(_0x131f6f[_0x8a99ca(0x38d)]){const _0x1ce203=_0x131f6f['customerUa']['length']>0x32?_0x131f6f['customerUa']['substring'](0x0,0x32)+'...':_0x131f6f[_0x8a99ca(0x38d)];_0x5361a7+='üíª\x20Browser:\x20`'+_0x1ce203+'`\x0a';}}_0x2a7415===_0x8a99ca(0x2fe)&&_0x131f6f[_0x8a99ca(0x2b6)]&&(_0x5361a7+=_0x8a99ca(0x297)+_0x131f6f[_0x8a99ca(0x2b6)]+_0x8a99ca(0x245)),_0x2a7415===_0x8a99ca(0x2fa)&&(_0x5361a7+=_0x8a99ca(0x2bd)),_0x131f6f['adminNotes']&&(_0x5361a7+=_0x8a99ca(0x24f)+_0x131f6f[_0x8a99ca(0x316)]+'\x0a'),await this['sendShopNotification'](_0x1dd6d0,_0x5361a7,{'parse_mode':_0x8a99ca(0x22c)});}async[a87_0x4adc9b(0x1cd)](_0x2f755a,_0x1562c9){const _0x165189=a87_0x4adc9b,_0x3af334=new Date(_0x1562c9[_0x165189(0x357)])['toLocaleString'](_0x165189(0x2cd),{'year':_0x165189(0x1ce),'month':_0x165189(0x23f),'day':_0x165189(0x23f),'hour':_0x165189(0x23f),'minute':'2-digit','second':_0x165189(0x23f)}),_0x49fb9e=_0x165189(0x261)+('üìÖ\x20*Payout\x20Date:*\x20'+_0x3af334+'\x0a')+('üí∞\x20*Amount:*\x20'+_0x1562c9[_0x165189(0x350)]+'\x20USD\x0a')+('‚è±Ô∏è\x20*Period:*\x20'+(_0x1562c9['period']||_0x165189(0x388))+'\x0a')+(_0x165189(0x1dd)+(_0x1562c9[_0x165189(0x304)]||'Not\x20specified')+'\x0a')+(_0x165189(0x338)+(_0x1562c9['wallet']||_0x165189(0x388))+'`\x0a')+(_0x1562c9[_0x165189(0x33d)]?_0x165189(0x2bc)+_0x1562c9[_0x165189(0x33d)]+'`':_0x165189(0x39b));await this['sendShopNotification'](_0x2f755a,_0x49fb9e,{'parse_mode':'Markdown'});}async[a87_0x4adc9b(0x2dd)](_0x22e69c,_0xf51850){const _0x2addd4=a87_0x4adc9b;try{const _0x58c4d8=await database_1['default'][_0x2addd4(0x2e4)]['findUnique']({'where':{'shopId':_0x22e69c},'select':{'notificationLogin':!![]}});if(!_0x58c4d8?.[_0x2addd4(0x26d)]){console[_0x2addd4(0x31a)](_0x2addd4(0x356)+_0x22e69c);return;}const _0x3a3f5d=_0xf51850[_0x2addd4(0x308)]?'üîê':'üö®',_0x4d6086=_0xf51850[_0x2addd4(0x308)]?'Successful\x20login':'Failed\x20login\x20attempt';let _0x391ae9=_0x3a3f5d+'\x20*'+_0x4d6086+_0x2addd4(0x32c)+(_0x2addd4(0x1e7)+_0xf51850[_0x2addd4(0x21b)]+'`\x0a')+('üìÖ\x20Time:\x20'+_0xf51850[_0x2addd4(0x313)]['toLocaleString'](_0x2addd4(0x2cd))+'\x0a');_0xf51850[_0x2addd4(0x2e8)]&&(_0x391ae9+='üåê\x20IP\x20address:\x20`'+_0xf51850[_0x2addd4(0x2e8)]+'`\x0a');_0xf51850[_0x2addd4(0x301)]&&(_0x391ae9+=_0x2addd4(0x1eb)+_0xf51850[_0x2addd4(0x301)]+'\x0a');if(_0xf51850['userAgent']){const _0x3b467e=_0xf51850[_0x2addd4(0x2e9)][_0x2addd4(0x2f5)]>0x32?_0xf51850['userAgent'][_0x2addd4(0x1d5)](0x0,0x32)+_0x2addd4(0x32a):_0xf51850[_0x2addd4(0x2e9)];_0x391ae9+=_0x2addd4(0x337)+_0x3b467e+'`\x0a';}!_0xf51850['success']&&(_0x391ae9+=_0x2addd4(0x23c)),await this['sendShopNotification'](_0x22e69c,_0x391ae9,{'parse_mode':_0x2addd4(0x22c)}),console[_0x2addd4(0x31a)](_0x2addd4(0x346)+_0x22e69c+':\x20'+(_0xf51850[_0x2addd4(0x308)]?'success':_0x2addd4(0x277)));}catch(_0x3f2bc2){console['error'](_0x2addd4(0x293),_0x3f2bc2);}}async[a87_0x4adc9b(0x2f0)](_0x4d44b7,_0x1c2617){const _0x41d676=a87_0x4adc9b;try{const _0x13675d=await database_1['default']['shopSettings'][_0x41d676(0x24d)]({'where':{'shopId':_0x4d44b7},'select':{'notificationApiError':!![]}});if(!_0x13675d?.['notificationApiError']){console[_0x41d676(0x31a)](_0x41d676(0x273)+_0x4d44b7);return;}let _0x1b3a9c=_0x41d676(0x353)+('üîó\x20Endpoint:\x20`'+_0x1c2617['method']+'\x20'+_0x1c2617[_0x41d676(0x1f4)]+'`\x0a')+(_0x41d676(0x252)+_0x1c2617['timestamp']['toLocaleString'](_0x41d676(0x2cd))+'\x0a');_0x1c2617['statusCode']&&(_0x1b3a9c+=_0x41d676(0x238)+_0x1c2617['statusCode']+'`\x0a'),_0x1b3a9c+='‚ùå\x20Error:\x20`'+_0x1c2617['errorMessage']+'`\x0a',_0x1c2617[_0x41d676(0x3a3)]&&(_0x1b3a9c+=_0x41d676(0x2b7)+_0x1c2617[_0x41d676(0x3a3)]+'`\x0a'),_0x1b3a9c+=_0x41d676(0x39a),await this['sendShopNotification'](_0x4d44b7,_0x1b3a9c,{'parse_mode':_0x41d676(0x22c)}),console[_0x41d676(0x31a)]('‚úÖ\x20API\x20error\x20notification\x20sent\x20for\x20shop\x20'+_0x4d44b7+':\x20'+_0x1c2617['endpoint']);}catch(_0x10e16a){console['error'](_0x41d676(0x396),_0x10e16a);}}async['sendCustomNotification'](_0xaabe0a,_0x76a1ce,_0x2aebde){const _0x29e43f=a87_0x4adc9b;let _0x27d121=_0x29e43f(0x20d)+_0x76a1ce+_0x29e43f(0x32c);for(const [_0xb411dc,_0x118188]of Object['entries'](_0x2aebde)){_0x118188!==null&&_0x118188!==undefined&&(_0x27d121+=_0xb411dc+':\x20`'+_0x118188+'`\x0a');}await this['sendShopNotification'](_0xaabe0a,_0x27d121,{'parse_mode':_0x29e43f(0x22c)});}async[a87_0x4adc9b(0x1d4)](_0x33e83d){const _0x429047=a87_0x4adc9b;try{console['log']('üì±\x20Sending\x20notification\x20to\x20all\x20connected\x20users:\x20'+_0x33e83d[_0x429047(0x1d5)](0x0,0x32)+_0x429047(0x32a));const _0x4a331e=await database_1[_0x429047(0x262)]['telegramUser'][_0x429047(0x204)]({'select':{'telegramId':!![]}});if(_0x4a331e[_0x429047(0x2f5)]===0x0){console[_0x429047(0x31a)](_0x429047(0x30f));return;}for(const _0x152f49 of _0x4a331e){try{await this[_0x429047(0x37d)]?.[_0x429047(0x2ef)](_0x152f49[_0x429047(0x2a4)],_0x33e83d,{'parse_mode':'Markdown'});}catch(_0x596344){console[_0x429047(0x207)]('‚ùå\x20Failed\x20to\x20send\x20message\x20to\x20user\x20'+_0x152f49[_0x429047(0x2a4)]+':',_0x596344);}}console[_0x429047(0x31a)]('üì±\x20Notification\x20sent\x20to\x20'+_0x4a331e[_0x429047(0x2f5)]+_0x429047(0x298));}catch(_0x10c2cb){console['error'](_0x429047(0x2f2),_0x10c2cb);}}[a87_0x4adc9b(0x344)](){const _0xc4411c=a87_0x4adc9b;return{'isActive':!!this[_0xc4411c(0x37d)],'username':this[_0xc4411c(0x279)]};}async[a87_0x4adc9b(0x25b)](_0x5e6e77,_0x11325f,_0x15d401,_0x57bb68){const _0x4cdc0a=a87_0x4adc9b;try{if(!this[_0x4cdc0a(0x37d)])return console[_0x4cdc0a(0x207)](_0x4cdc0a(0x1e6)),![];const _0x1a4a36=await database_1[_0x4cdc0a(0x262)][_0x4cdc0a(0x32d)][_0x4cdc0a(0x204)]({'where':{'shopId':_0x5e6e77,'isVerified':!![]},'select':{'telegramId':!![]}});if(_0x1a4a36[_0x4cdc0a(0x2f5)]===0x0)return console[_0x4cdc0a(0x207)](_0x4cdc0a(0x332)+_0x5e6e77),![];let _0x1fb83b=0x0;for(const _0x393f3d of _0x1a4a36){try{await this[_0x4cdc0a(0x37d)]['sendDocument'](_0x393f3d[_0x4cdc0a(0x2a4)],_0x11325f,{},{'filename':_0x15d401,'contentType':_0x15d401[_0x4cdc0a(0x26e)](_0x4cdc0a(0x311))?_0x4cdc0a(0x374):_0x15d401[_0x4cdc0a(0x26e)](_0x4cdc0a(0x2e0))||_0x15d401['endsWith'](_0x4cdc0a(0x363))?'image/jpeg':_0x15d401[_0x4cdc0a(0x26e)](_0x4cdc0a(0x1d6))?_0x4cdc0a(0x2ee):'application/octet-stream'}),_0x57bb68&&await this[_0x4cdc0a(0x37d)][_0x4cdc0a(0x2ef)](_0x393f3d[_0x4cdc0a(0x2a4)],_0x57bb68),_0x1fb83b++;}catch(_0x44a961){console[_0x4cdc0a(0x207)](_0x4cdc0a(0x1dc)+_0x393f3d[_0x4cdc0a(0x2a4)]+':',_0x44a961);}}return console[_0x4cdc0a(0x31a)]('‚úÖ\x20File\x20sent\x20to\x20'+_0x1fb83b+'/'+_0x1a4a36[_0x4cdc0a(0x2f5)]+_0x4cdc0a(0x2fd)+_0x5e6e77+':\x20'+_0x15d401),_0x1fb83b>0x0;}catch(_0x157d64){return console[_0x4cdc0a(0x207)](_0x4cdc0a(0x334),_0x157d64),![];}}async[a87_0x4adc9b(0x377)](_0x95eb69,_0xa815a8){const _0x4abad3=a87_0x4adc9b;try{if(!this[_0x4abad3(0x37d)])return console[_0x4abad3(0x207)]('‚ùå\x20Telegram\x20bot\x20not\x20initialized'),![];return await this[_0x4abad3(0x37d)][_0x4abad3(0x2ef)](_0x95eb69,_0xa815a8),console['log']('‚úÖ\x20Direct\x20message\x20sent\x20to\x20chat\x20'+_0x95eb69),!![];}catch(_0x5e2e79){return console[_0x4abad3(0x207)](_0x4abad3(0x35f),_0x5e2e79),![];}}async[a87_0x4adc9b(0x368)](_0x34b87b,_0x569afe,_0x5df76a,_0x54fdfe){const _0xe29cf5=a87_0x4adc9b;try{if(!this[_0xe29cf5(0x37d)])return console[_0xe29cf5(0x207)](_0xe29cf5(0x1e6)),![];return await this[_0xe29cf5(0x37d)][_0xe29cf5(0x314)](_0x34b87b,_0x569afe,{},{'filename':_0x5df76a,'contentType':_0x5df76a[_0xe29cf5(0x26e)](_0xe29cf5(0x311))?_0xe29cf5(0x374):_0x5df76a[_0xe29cf5(0x26e)](_0xe29cf5(0x2e0))||_0x5df76a['endsWith'](_0xe29cf5(0x363))?_0xe29cf5(0x35e):_0x5df76a[_0xe29cf5(0x26e)](_0xe29cf5(0x1d6))?_0xe29cf5(0x2ee):_0xe29cf5(0x1e1)}),_0x54fdfe&&await this['bot'][_0xe29cf5(0x2ef)](_0x34b87b,_0x54fdfe),console[_0xe29cf5(0x31a)]('‚úÖ\x20File\x20sent\x20to\x20chat\x20'+_0x34b87b+':\x20'+_0x5df76a),!![];}catch(_0x56bcf2){return console[_0xe29cf5(0x207)](_0xe29cf5(0x2e2),_0x56bcf2),![];}}async['handlePaymentLinkFlow'](_0x1e8399,_0x1cc2b6,_0x4af7bb,_0x2d4fdf){const _0x41c0d9=a87_0x4adc9b,_0x2c9aa2=this[_0x41c0d9(0x225)]['get'](_0x1cc2b6)||{};try{if(_0x4af7bb==='pl_cancel'){this['paymentLinkSessions']['delete'](_0x1cc2b6),await this[_0x41c0d9(0x37d)]?.[_0x41c0d9(0x37f)](_0x41c0d9(0x259),{'chat_id':_0x1e8399,'message_id':_0x2d4fdf});return;}if(_0x4af7bb===_0x41c0d9(0x2b0)){await this[_0x41c0d9(0x1c3)](_0x1e8399,_0x1cc2b6,_0x2d4fdf,0x1);return;}if(_0x4af7bb['startsWith'](_0x41c0d9(0x3a4))){const _0x157fd5=parseInt(_0x4af7bb['replace'](_0x41c0d9(0x3a4),''));await this[_0x41c0d9(0x1c3)](_0x1e8399,_0x1cc2b6,_0x2d4fdf,_0x157fd5);return;}if(_0x4af7bb===_0x41c0d9(0x27a)){const _0x258818=await database_1[_0x41c0d9(0x262)][_0x41c0d9(0x32d)][_0x41c0d9(0x24d)]({'where':{'telegramId':_0x1cc2b6},'include':{'shop':!![]}});if(!_0x258818?.['shop']?.['paymentGateways']){await this['bot']?.[_0x41c0d9(0x37f)](_0x41c0d9(0x34d),{'chat_id':_0x1e8399,'message_id':_0x2d4fdf});return;}let _0x47a0ed;try{_0x47a0ed=JSON[_0x41c0d9(0x321)](_0x258818[_0x41c0d9(0x1f2)][_0x41c0d9(0x3a2)]);}catch{_0x47a0ed=_0x258818['shop']['paymentGateways'][_0x41c0d9(0x1c9)](',')[_0x41c0d9(0x2c8)](_0x5537a4=>_0x5537a4['trim']());}if(_0x47a0ed[_0x41c0d9(0x2f5)]===0x0){await this[_0x41c0d9(0x37d)]?.[_0x41c0d9(0x37f)]('‚ùå\x20No\x20active\x20gateways\x20found.\x20Please\x20enable\x20at\x20least\x20one\x20gateway\x20in\x20the\x20admin\x20panel.',{'chat_id':_0x1e8399,'message_id':_0x2d4fdf});return;}this['paymentLinkSessions'][_0x41c0d9(0x38c)](_0x1cc2b6,{'step':_0x41c0d9(0x375)});const _0x4fceb2=_0x47a0ed[_0x41c0d9(0x36c)](_0x2b769a=>{const _0x5e554a=_0x41c0d9,_0x63a51=Object[_0x5e554a(0x2eb)](gateway_1[_0x5e554a(0x1ee)])['find'](_0x5715de=>gateway_1[_0x5e554a(0x1ee)][_0x5715de]===_0x2b769a)||_0x2b769a;return[{'text':_0x5e554a(0x30e)+_0x63a51,'callback_data':_0x5e554a(0x263)+_0x63a51}];});await this[_0x41c0d9(0x37d)]?.[_0x41c0d9(0x37f)](_0x41c0d9(0x287),{'chat_id':_0x1e8399,'message_id':_0x2d4fdf,'parse_mode':_0x41c0d9(0x22c),'reply_markup':{'inline_keyboard':[..._0x4fceb2,[{'text':_0x41c0d9(0x243),'callback_data':_0x41c0d9(0x367)}]]}});return;}if(_0x4af7bb[_0x41c0d9(0x255)]('pl_gw_')){const _0x2d157f=_0x4af7bb[_0x41c0d9(0x1c0)]('pl_gw_','');_0x2c9aa2[_0x41c0d9(0x375)]=_0x2d157f,_0x2c9aa2[_0x41c0d9(0x3a1)]=_0x41c0d9(0x23e),this[_0x41c0d9(0x225)][_0x41c0d9(0x38c)](_0x1cc2b6,_0x2c9aa2),await this['bot']?.[_0x41c0d9(0x37f)]('üîó\x20*Create\x20Payment\x20Link*\x0a\x0a'+_0x41c0d9(0x25d),{'chat_id':_0x1e8399,'message_id':_0x2d4fdf,'parse_mode':'Markdown','reply_markup':{'inline_keyboard':[[{'text':'üîÇ\x20Single\x20Use','callback_data':_0x41c0d9(0x2a6)}],[{'text':_0x41c0d9(0x1e3),'callback_data':_0x41c0d9(0x24a)}],[{'text':_0x41c0d9(0x243),'callback_data':'pl_cancel'}]]}});return;}if(_0x4af7bb[_0x41c0d9(0x255)](_0x41c0d9(0x2c4))){const _0x26f612=_0x4af7bb[_0x41c0d9(0x1c0)](_0x41c0d9(0x2c4),'')[_0x41c0d9(0x25f)]();_0x2c9aa2['type']=_0x26f612,_0x2c9aa2['step']='currency',_0x2c9aa2[_0x41c0d9(0x26a)]=0x0,this[_0x41c0d9(0x225)][_0x41c0d9(0x38c)](_0x1cc2b6,_0x2c9aa2),await this[_0x41c0d9(0x39d)](_0x1e8399,_0x2d4fdf,_0x2c9aa2,0x0);return;}if(_0x4af7bb['startsWith']('pl_curr_page_')){const _0x211455=parseInt(_0x4af7bb[_0x41c0d9(0x1c0)](_0x41c0d9(0x1fc),''));await this[_0x41c0d9(0x39d)](_0x1e8399,_0x2d4fdf,_0x2c9aa2,_0x211455);return;}if(_0x4af7bb[_0x41c0d9(0x255)]('pl_curr_')){const _0x45f8d0=_0x4af7bb[_0x41c0d9(0x1c0)](_0x41c0d9(0x24c),'');_0x2c9aa2[_0x41c0d9(0x212)]=_0x45f8d0,_0x2c9aa2[_0x41c0d9(0x3a1)]='amount',this[_0x41c0d9(0x225)][_0x41c0d9(0x38c)](_0x1cc2b6,_0x2c9aa2),await this[_0x41c0d9(0x37d)]?.['editMessageText']('üîó\x20*Create\x20Payment\x20Link*\x0a\x0a'+_0x41c0d9(0x1c8)+(_0x41c0d9(0x331)+_0x45f8d0+_0x41c0d9(0x21e)),{'chat_id':_0x1e8399,'message_id':_0x2d4fdf,'parse_mode':_0x41c0d9(0x22c)});return;}}catch(_0x370f84){console['error']('Error\x20in\x20payment\x20link\x20flow:',_0x370f84),await this[_0x41c0d9(0x37d)]?.[_0x41c0d9(0x2ef)](_0x1e8399,_0x41c0d9(0x384)),this[_0x41c0d9(0x225)][_0x41c0d9(0x1f3)](_0x1cc2b6);}}async[a87_0x4adc9b(0x1c3)](_0x17a323,_0x1607da,_0x117a22,_0x404445=0x1){const _0x532991=a87_0x4adc9b;try{const _0x29d094=await database_1[_0x532991(0x262)][_0x532991(0x32d)][_0x532991(0x24d)]({'where':{'telegramId':_0x1607da},'include':{'shop':!![]}});if(!_0x29d094?.[_0x532991(0x335)]){await this[_0x532991(0x37d)]?.[_0x532991(0x2ef)](_0x17a323,_0x532991(0x1f9));return;}const _0x4fd7f9=0x5,_0x422270=(_0x404445-0x1)*_0x4fd7f9,[_0x311ad8,_0x1078ab]=await Promise[_0x532991(0x2d0)]([database_1[_0x532991(0x262)][_0x532991(0x26c)][_0x532991(0x204)]({'where':{'shopId':_0x29d094[_0x532991(0x335)]},'orderBy':{'createdAt':_0x532991(0x265)},'take':_0x4fd7f9,'skip':_0x422270}),database_1[_0x532991(0x262)][_0x532991(0x26c)]['count']({'where':{'shopId':_0x29d094[_0x532991(0x335)]}})]),_0x9c99dd=Math[_0x532991(0x381)](_0x1078ab/_0x4fd7f9);if(_0x311ad8['length']===0x0){const _0x4330d0=_0x532991(0x248);_0x117a22?await this[_0x532991(0x37d)]?.['editMessageText'](_0x4330d0,{'chat_id':_0x17a323,'message_id':_0x117a22,'parse_mode':'MarkdownV2','reply_markup':{'inline_keyboard':[[{'text':'‚ûï\x20Create\x20New\x20Link','callback_data':_0x532991(0x27a)}]]}}):await this['bot']?.[_0x532991(0x2ef)](_0x17a323,_0x4330d0,{'parse_mode':'MarkdownV2','reply_markup':{'inline_keyboard':[[{'text':_0x532991(0x1bf),'callback_data':_0x532991(0x27a)}]]}});return;}let _0x4c2fe0='üìã\x20*Payment\x20Links*\x20\x5c(Page\x20'+_0x404445+'/'+_0x9c99dd+_0x532991(0x33f);_0x311ad8['forEach']((_0x5338a2,_0x59992b)=>{const _0x147669=_0x532991,_0x86df18=_0x422270+_0x59992b+0x1,_0x1407af=_0x5338a2[_0x147669(0x350)]?_0x5338a2[_0x147669(0x350)]+'\x20'+_0x5338a2[_0x147669(0x212)]:'N/A',_0x4ace16=_0x5338a2[_0x147669(0x364)]==='ACTIVE'?'‚úÖ':'‚ùå',_0x54c7ba=(process.env.FRONTEND_URL||'https://app.trapay.uk')+_0x147669(0x2ad)+_0x5338a2['id'],_0x28eb40=_0x54c7ba['replace'](/\./g,'\x5c.')[_0x147669(0x1c0)](/-/g,'\x5c-')[_0x147669(0x1c0)](/\//g,'\x5c/');_0x4c2fe0+=_0x86df18+'\x5c.\x20'+_0x4ace16+'\x20*'+_0x1407af+'*\x0a',_0x4c2fe0+=_0x147669(0x236)+_0x5338a2[_0x147669(0x375)]+_0x147669(0x2aa)+_0x5338a2[_0x147669(0x23e)]+'\x0a',_0x4c2fe0+=_0x147669(0x230)+_0x28eb40+')\x0a\x0a';});const _0x4cd57a=[];_0x404445>0x1&&_0x4cd57a[_0x532991(0x296)]({'text':'‚¨ÖÔ∏è\x20Previous','callback_data':_0x532991(0x3a4)+(_0x404445-0x1)});_0x404445<_0x9c99dd&&_0x4cd57a[_0x532991(0x296)]({'text':'Next\x20‚û°Ô∏è','callback_data':_0x532991(0x3a4)+(_0x404445+0x1)});const _0x4f4e30=[];_0x4cd57a['length']>0x0&&_0x4f4e30[_0x532991(0x296)](_0x4cd57a),_0x4f4e30[_0x532991(0x296)]([{'text':_0x532991(0x1bf),'callback_data':_0x532991(0x27a)}]),_0x4f4e30['push']([{'text':'‚ùå\x20Close','callback_data':'pl_cancel'}]),_0x117a22?await this[_0x532991(0x37d)]?.[_0x532991(0x37f)](_0x4c2fe0,{'chat_id':_0x17a323,'message_id':_0x117a22,'parse_mode':_0x532991(0x206),'reply_markup':{'inline_keyboard':_0x4f4e30}}):await this['bot']?.['sendMessage'](_0x17a323,_0x4c2fe0,{'parse_mode':'MarkdownV2','reply_markup':{'inline_keyboard':_0x4f4e30}});}catch(_0x4768f9){console[_0x532991(0x207)](_0x532991(0x34c),_0x4768f9),await this['bot']?.['sendMessage'](_0x17a323,_0x532991(0x300));}}async[a87_0x4adc9b(0x39d)](_0x112f56,_0x1cf4f6,_0x5463cd,_0x291301){const _0x55f45b=a87_0x4adc9b,_0x52ab76=this[_0x55f45b(0x33c)](_0x5463cd['gateway']),_0x22196a=0xf,_0x18332a=Math[_0x55f45b(0x381)](_0x52ab76[_0x55f45b(0x2f5)]/_0x22196a),_0x3edc33=_0x291301*_0x22196a,_0x1f923c=_0x3edc33+_0x22196a,_0x4311bd=_0x52ab76[_0x55f45b(0x382)](_0x3edc33,_0x1f923c),_0x462866=[];for(let _0x28cd4f=0x0;_0x28cd4f<_0x4311bd[_0x55f45b(0x2f5)];_0x28cd4f+=0x3){const _0x39df01=_0x4311bd[_0x55f45b(0x382)](_0x28cd4f,_0x28cd4f+0x3)[_0x55f45b(0x36c)](_0x2273bc=>({'text':_0x2273bc,'callback_data':_0x55f45b(0x24c)+_0x2273bc}));_0x462866[_0x55f45b(0x296)](_0x39df01);}const _0x56273b=[];_0x291301>0x0&&_0x56273b['push']({'text':_0x55f45b(0x395),'callback_data':_0x55f45b(0x1fc)+(_0x291301-0x1)});_0x291301<_0x18332a-0x1&&_0x56273b[_0x55f45b(0x296)]({'text':_0x55f45b(0x2c1),'callback_data':_0x55f45b(0x1fc)+(_0x291301+0x1)});const _0x450ec0=[..._0x462866,..._0x56273b[_0x55f45b(0x2f5)]>0x0?[_0x56273b]:[],[{'text':_0x55f45b(0x243),'callback_data':'pl_cancel'}]];await this[_0x55f45b(0x37d)]?.[_0x55f45b(0x37f)](_0x55f45b(0x209)+_0x55f45b(0x2fb)+('Page\x20'+(_0x291301+0x1)+'/'+_0x18332a),{'chat_id':_0x112f56,'message_id':_0x1cf4f6,'parse_mode':_0x55f45b(0x22c),'reply_markup':{'inline_keyboard':_0x450ec0}});}['getGatewayCurrencies'](_0x36dfbb){const _0x1fff88=a87_0x4adc9b,_0x3c7c57={'1000':[_0x1fff88(0x299),'GBP',_0x1fff88(0x1f8),_0x1fff88(0x2db),'CAD','JPY',_0x1fff88(0x288),_0x1fff88(0x231),_0x1fff88(0x2d1),_0x1fff88(0x29c),_0x1fff88(0x2b4),'CZK','HUF',_0x1fff88(0x2b2),_0x1fff88(0x220),'TRY',_0x1fff88(0x268),'ARS',_0x1fff88(0x1d1),_0x1fff88(0x1d9),_0x1fff88(0x260),_0x1fff88(0x1d7),_0x1fff88(0x258),_0x1fff88(0x29e),'MAD','TND',_0x1fff88(0x22b),_0x1fff88(0x281),'GHS','INR',_0x1fff88(0x295),_0x1fff88(0x1bb),_0x1fff88(0x221),'NPR','THB',_0x1fff88(0x380),_0x1fff88(0x35c),_0x1fff88(0x385),_0x1fff88(0x22e),_0x1fff88(0x1d0),_0x1fff88(0x373),'TWD','KRW',_0x1fff88(0x38a)],'0001':['USD',_0x1fff88(0x299),_0x1fff88(0x228),_0x1fff88(0x2ba),_0x1fff88(0x292),_0x1fff88(0x280),_0x1fff88(0x32f),_0x1fff88(0x288),_0x1fff88(0x324),_0x1fff88(0x231),'NOK',_0x1fff88(0x29c),'PLN','CZK','HUF',_0x1fff88(0x1f8),'RON',_0x1fff88(0x220),_0x1fff88(0x2d4),_0x1fff88(0x392),_0x1fff88(0x2db),_0x1fff88(0x268),_0x1fff88(0x315),_0x1fff88(0x30b),_0x1fff88(0x2c2),_0x1fff88(0x1d0),_0x1fff88(0x373),_0x1fff88(0x1ef),_0x1fff88(0x385),_0x1fff88(0x22e),_0x1fff88(0x35c),'VND',_0x1fff88(0x258),'EGP',_0x1fff88(0x1c6),_0x1fff88(0x3a6),_0x1fff88(0x28f),'KWD',_0x1fff88(0x345),'OMR',_0x1fff88(0x264),_0x1fff88(0x2a2),_0x1fff88(0x325),'IRR',_0x1fff88(0x393),_0x1fff88(0x383),_0x1fff88(0x295),_0x1fff88(0x1bb),_0x1fff88(0x221),_0x1fff88(0x2cc),_0x1fff88(0x341),_0x1fff88(0x1be),_0x1fff88(0x2bb),_0x1fff88(0x1fd),_0x1fff88(0x352),_0x1fff88(0x20e),'TMT',_0x1fff88(0x202),_0x1fff88(0x250),'AMD',_0x1fff88(0x329),_0x1fff88(0x2c9),'ALL','MKD',_0x1fff88(0x2bf),_0x1fff88(0x362),_0x1fff88(0x27f),_0x1fff88(0x251),_0x1fff88(0x3aa),_0x1fff88(0x20c),_0x1fff88(0x372),_0x1fff88(0x391),_0x1fff88(0x2b3),_0x1fff88(0x398),'WST',_0x1fff88(0x2ab),_0x1fff88(0x211),_0x1fff88(0x38a)],'0010':[_0x1fff88(0x323),_0x1fff88(0x299),_0x1fff88(0x228),'CAD',_0x1fff88(0x292),_0x1fff88(0x280),_0x1fff88(0x32f),_0x1fff88(0x288),_0x1fff88(0x231),_0x1fff88(0x2d1),_0x1fff88(0x29c),_0x1fff88(0x2b4),_0x1fff88(0x21d),'HUF',_0x1fff88(0x1f8),_0x1fff88(0x2b2),_0x1fff88(0x220),_0x1fff88(0x2d4),_0x1fff88(0x2db),'MXN',_0x1fff88(0x315),_0x1fff88(0x1d1),_0x1fff88(0x1d9),_0x1fff88(0x260),_0x1fff88(0x1d7),_0x1fff88(0x258),_0x1fff88(0x29e),_0x1fff88(0x26f),_0x1fff88(0x27d),_0x1fff88(0x22b),_0x1fff88(0x281),'GHS',_0x1fff88(0x30b),_0x1fff88(0x295),_0x1fff88(0x1bb),_0x1fff88(0x221),'NPR',_0x1fff88(0x1ef),_0x1fff88(0x380),_0x1fff88(0x35c),_0x1fff88(0x385),_0x1fff88(0x22e),'SGD',_0x1fff88(0x373),_0x1fff88(0x378),_0x1fff88(0x2c2),_0x1fff88(0x38a)],'0100':[_0x1fff88(0x299)],'0101':[_0x1fff88(0x299)],'1001':[_0x1fff88(0x299)],'1010':[_0x1fff88(0x228)],'1100':['EUR',_0x1fff88(0x323),'AUD',_0x1fff88(0x2ba),_0x1fff88(0x228),_0x1fff88(0x2d1),'JPY'],'1111':[_0x1fff88(0x299)],'0000':[_0x1fff88(0x299),_0x1fff88(0x323),_0x1fff88(0x292),'CAD',_0x1fff88(0x228),_0x1fff88(0x2d1),'JPY'],'1110':[_0x1fff88(0x299),'USD','GBP'],'2000':[_0x1fff88(0x299)],'2001':[_0x1fff88(0x299)],'2010':[_0x1fff88(0x299)],'2011':[_0x1fff88(0x2ba)],'2002':[_0x1fff88(0x2d4)],'3000':[_0x1fff88(0x2d4),'AED',_0x1fff88(0x299),'USD','AUD',_0x1fff88(0x2b4),_0x1fff88(0x38a),'CAD',_0x1fff88(0x228),_0x1fff88(0x315),_0x1fff88(0x30b)],'3001':['USD',_0x1fff88(0x299)],'3002':[_0x1fff88(0x2d4)],'3003':['EUR',_0x1fff88(0x323),'GBP',_0x1fff88(0x292),'CAD',_0x1fff88(0x280),_0x1fff88(0x2db),'SEK',_0x1fff88(0x2d1),'DKK','PLN',_0x1fff88(0x21d),_0x1fff88(0x2c5),_0x1fff88(0x2b2),_0x1fff88(0x220)],'3004':[_0x1fff88(0x323),'EUR',_0x1fff88(0x228),_0x1fff88(0x2ba),_0x1fff88(0x292)]};return _0x3c7c57[_0x36dfbb]||['USD'];}async[a87_0x4adc9b(0x399)](_0x93ea55,_0x4c1c8c,_0x4c508a,_0x3ee9b5){const _0x4782cb=a87_0x4adc9b;try{const _0x305100=new Date();let _0x40f366,_0x94508e,_0x2a9693;switch(_0x4c508a){case _0x4782cb(0x284):{const _0x96d3f0=new Date(Date['UTC'](_0x305100[_0x4782cb(0x348)](),_0x305100[_0x4782cb(0x25c)](),_0x305100[_0x4782cb(0x22a)]()));_0x40f366=_0x96d3f0,_0x94508e=new Date(Date[_0x4782cb(0x1fb)](_0x305100['getUTCFullYear'](),_0x305100[_0x4782cb(0x25c)](),_0x305100['getUTCDate'](),0x17,0x3b,0x3b,0x3e7)),_0x2a9693=_0x96d3f0['getUTCDate']()['toString']()[_0x4782cb(0x38f)](0x2,'0')+'.'+(_0x96d3f0[_0x4782cb(0x25c)]()+0x1)[_0x4782cb(0x330)]()[_0x4782cb(0x38f)](0x2,'0')+'.'+_0x96d3f0[_0x4782cb(0x348)]();break;}case _0x4782cb(0x347):{const _0x158965=new Date(Date[_0x4782cb(0x1fb)](_0x305100[_0x4782cb(0x348)](),_0x305100[_0x4782cb(0x25c)](),_0x305100[_0x4782cb(0x22a)]()-0x1));_0x40f366=_0x158965,_0x94508e=new Date(Date[_0x4782cb(0x1fb)](_0x305100['getUTCFullYear'](),_0x305100[_0x4782cb(0x25c)](),_0x305100[_0x4782cb(0x22a)]()-0x1,0x17,0x3b,0x3b,0x3e7)),_0x2a9693=_0x158965[_0x4782cb(0x22a)]()[_0x4782cb(0x330)]()[_0x4782cb(0x38f)](0x2,'0')+'.'+(_0x158965[_0x4782cb(0x25c)]()+0x1)[_0x4782cb(0x330)]()[_0x4782cb(0x38f)](0x2,'0')+'.'+_0x158965['getUTCFullYear']();break;}case'stats_this_month':{const _0x597a9f=new Date(Date[_0x4782cb(0x1fb)](_0x305100[_0x4782cb(0x348)](),_0x305100[_0x4782cb(0x25c)](),0x1));_0x40f366=_0x597a9f,_0x94508e=new Date(Date[_0x4782cb(0x1fb)](_0x305100['getUTCFullYear'](),_0x305100[_0x4782cb(0x25c)]()+0x1,0x0,0x17,0x3b,0x3b,0x3e7));const _0x39cc88=new Date(Date['UTC'](_0x305100['getUTCFullYear'](),_0x305100['getUTCMonth']()+0x1,0x0));_0x2a9693=_0x597a9f['getUTCDate']()[_0x4782cb(0x330)]()[_0x4782cb(0x38f)](0x2,'0')+'.'+(_0x597a9f[_0x4782cb(0x25c)]()+0x1)[_0x4782cb(0x330)]()['padStart'](0x2,'0')+'.'+_0x597a9f['getUTCFullYear']()+'\x20-\x20'+_0x39cc88[_0x4782cb(0x22a)]()[_0x4782cb(0x330)]()['padStart'](0x2,'0')+'.'+(_0x39cc88[_0x4782cb(0x25c)]()+0x1)[_0x4782cb(0x330)]()[_0x4782cb(0x38f)](0x2,'0')+'.'+_0x39cc88[_0x4782cb(0x348)]();break;}case _0x4782cb(0x37e):{const _0x452c19=new Date(Date['UTC'](_0x305100[_0x4782cb(0x348)](),_0x305100[_0x4782cb(0x25c)]()-0x1,0x1));_0x40f366=_0x452c19,_0x94508e=new Date(Date[_0x4782cb(0x1fb)](_0x305100[_0x4782cb(0x348)](),_0x305100[_0x4782cb(0x25c)](),0x0,0x17,0x3b,0x3b,0x3e7));const _0x1f8422=new Date(Date[_0x4782cb(0x1fb)](_0x305100[_0x4782cb(0x348)](),_0x305100['getUTCMonth'](),0x0));_0x2a9693=_0x452c19[_0x4782cb(0x22a)]()[_0x4782cb(0x330)]()[_0x4782cb(0x38f)](0x2,'0')+'.'+(_0x452c19['getUTCMonth']()+0x1)['toString']()['padStart'](0x2,'0')+'.'+_0x452c19['getUTCFullYear']()+_0x4782cb(0x2d7)+_0x1f8422[_0x4782cb(0x22a)]()[_0x4782cb(0x330)]()[_0x4782cb(0x38f)](0x2,'0')+'.'+(_0x1f8422[_0x4782cb(0x25c)]()+0x1)[_0x4782cb(0x330)]()[_0x4782cb(0x38f)](0x2,'0')+'.'+_0x1f8422[_0x4782cb(0x348)]();break;}case'stats_all_time':{_0x40f366=new Date(0x0),_0x94508e=_0x305100,_0x2a9693=_0x4782cb(0x39f);break;}default:return;}const _0x2f0348=await database_1[_0x4782cb(0x262)][_0x4782cb(0x309)][_0x4782cb(0x204)]({'where':{'shopId':_0x4c1c8c,'createdAt':{'gte':_0x40f366,'lte':_0x94508e}},'select':{'status':!![],'amountUSDT':!![],'amountAfterGatewayCommissionUSDT':!![]}});let _0x83e667=0x0,_0x25278f=0x0,_0x463fbe=0x0,_0x3d346f=0x0,_0x3a269a=0x0,_0x3dcd41=0x0;_0x2f0348[_0x4782cb(0x219)](_0x3c7fba=>{const _0x34a7aa=_0x4782cb,_0x1708b3=_0x3c7fba[_0x34a7aa(0x3ac)]||0x0,_0xe4659d=_0x3c7fba['amountAfterGatewayCommissionUSDT']||0x0;if(_0x3c7fba[_0x34a7aa(0x364)]===_0x34a7aa(0x208))_0x83e667+=_0x1708b3,_0x25278f+=_0x1708b3-_0xe4659d,_0x463fbe++;else{if(_0x3c7fba[_0x34a7aa(0x364)]==='FAILED'||_0x3c7fba['status']===_0x34a7aa(0x317))_0x3d346f++;else{if(_0x3c7fba['status']===_0x34a7aa(0x2f9))_0x3a269a++,_0x83e667+=_0x1708b3;else _0x3c7fba[_0x34a7aa(0x364)]===_0x34a7aa(0x1e5)&&(_0x3dcd41++,_0x83e667+=_0x1708b3);}}});const _0x904610=_0x463fbe+_0x3d346f,_0x1fd9b7=_0x904610>0x0?(_0x463fbe/_0x904610*0x64)[_0x4782cb(0x339)](0x1):'0.0',_0x4dc6a8=_0x2a9693[_0x4782cb(0x1c0)](/\./g,'\x5c.')[_0x4782cb(0x1c0)](/\-/g,'\x5c-'),_0x25f9f4=_0x83e667[_0x4782cb(0x339)](0x2)[_0x4782cb(0x1c0)](/\./g,'\x5c.'),_0xc09e79=_0x25278f['toFixed'](0x2)['replace'](/\./g,'\x5c.'),_0x40e789=_0x1fd9b7[_0x4782cb(0x1c0)](/\./g,'\x5c.'),_0x336bfa=_0x4782cb(0x36f)+_0x4dc6a8+_0x4782cb(0x32c)+(_0x4782cb(0x36a)+_0x25f9f4+'\x20USDT\x0a')+(_0x4782cb(0x214)+_0xc09e79+'\x20USDT\x0a')+('‚úÖ\x20Successful\x20Payments\x20\x5c-\x20'+_0x463fbe+'\x0a')+('‚ùå\x20Failed\x20Payments\x20\x5c-\x20'+_0x3d346f+'\x0a')+(_0x4782cb(0x3a5)+_0x40e789+'%\x0a')+('‚ö†Ô∏è\x20Chargebacks\x20\x5c-\x20'+_0x3a269a+'\x0a')+(_0x4782cb(0x39c)+_0x3dcd41),_0xc5916c={'inline_keyboard':[[{'text':_0x4782cb(0x1ec),'callback_data':_0x4782cb(0x307)}]]};_0x3ee9b5?await this[_0x4782cb(0x37d)]?.['editMessageText'](_0x336bfa,{'chat_id':_0x93ea55,'message_id':_0x3ee9b5,'parse_mode':_0x4782cb(0x206),'reply_markup':_0xc5916c}):await this[_0x4782cb(0x37d)]?.[_0x4782cb(0x2ef)](_0x93ea55,_0x336bfa,{'parse_mode':_0x4782cb(0x206),'reply_markup':_0xc5916c});}catch(_0x76b1fa){console[_0x4782cb(0x207)](_0x4782cb(0x303),_0x76b1fa),await this['bot']?.[_0x4782cb(0x2ef)](_0x93ea55,_0x4782cb(0x35b));}}[a87_0x4adc9b(0x349)](){const _0x13b578=a87_0x4adc9b;this[_0x13b578(0x37d)]&&(this[_0x13b578(0x37d)][_0x13b578(0x2e3)](),this[_0x13b578(0x37d)]=null,console[_0x13b578(0x31a)](_0x13b578(0x3ad)));}}exports[a87_0x4adc9b(0x35a)]=TelegramBotService,exports[a87_0x4adc9b(0x2d2)]=new TelegramBotService();